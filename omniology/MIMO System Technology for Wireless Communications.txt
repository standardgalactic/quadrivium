
THE ELECTRICAL ENGINEERING
AND APPLIED SIGNAL PROCESSING SERIES
MIMO SYSTEM
TECHNOLOGY FOR
WIRELESS
COMMUNICATIONs

THE ELECTRICAL ENGINEERING
AND APPLIED SIGNAL PROCESSING SERIES
Edited by Alexander Poularikas
The Advanced Signal Processing Handbook:
Theory and Implementation for Radar, Sonar,
and Medical Imaging Real-Time Systems
Stergios Stergiopoulos
The Transform and Data Compression Handbook
K.R. Rao and P.C. Yip
Handbook of Multisensor Data Fusion
David Hall and James Llinas
Handbook of Neural Network Signal Processing
Yu Hen Hu and Jenq-Neng Hwang
Handbook of Antennas in Wireless Communications
Lal Chand Godara
Noise  Reduction in Speech Applications
Gillian M. Davis
Signal Processing Noise
Vyacheslav P. Tuzlukov
Digital Signal Processing with Examples in MATLAB®
Samuel Stearns
Applications in Time-Frequency Signal Processing
Antonia Papandreou-Suppappola
The Digital Color Imaging Handbook
Gaurav Sharma
Pattern Recognition in Speech and Language Processing
Wu Chou and Biing-Hwang Juang
Propagation Handbook for Wireless Communication System Design
Robert K. Crane
Nonlinear Signal and Image Processing: Theory, Methods, and Applications
Kenneth E. Barner and Gonzalo R. Arce
Smart Antennas
Lal Chand Godara
Mobile Internet: Enabling Technologies and Services
Apostolis K. Salkintzis and Alexander Poularikas
Soft Computing with MATLAB®
Ali Zilouchian
Wireless Internet: Technologies and Applications
Apostolis K. Salkintzis and Alexander Poularikas
Signal and Image Processing in Navigational Systems
Vyacheslav P. Tuzlukov
Medical Image Analysis Methods
Lena Costaridou
MIMO System Technology for Wireless Communications
George Tsoulos

Edited by
George Tsoulos
THE ELECTRICAL ENGINEERING
AND APPLIED SIGNAL PROCESSING SERIES
A CRC title, part of the Taylor & Francis imprint, a member of the
Taylor & Francis Group, the academic division of T&F Informa plc.
Boca Raton   London   New York
MIMO SYSTEM
TECHNOLOGY FOR
WIRELESS
COMMUNICATIONs

Published in 2006 by
CRC Press
Taylor & Francis Group 
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2006 by Taylor & Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group
No claim to original U.S. Government works
Printed in the United States of America on acid-free paper
10 9 8 7 6 5 4 3 2 1
International Standard Book Number-10: 0-8493-4190-6 (Hardcover) 
International Standard Book Number-13: 978-0-8493-4190-8 (Hardcover) 
Library of Congress Card Number 2005034989
This book contains information obtained from authentic and highly regarded sources. Reprinted material is
quoted with permission, and sources are indicated. A wide variety of references are listed. Reasonable efforts
have been made to publish reliable data and information, but the author and the publisher cannot assume
responsibility for the validity of all materials or for the consequences of their use.
No part of this book may be reprinted, reproduced, transmitted, or utilized in any form by any electronic,
mechanical, or other means, now known or hereafter invented, including photocopying, microfilming, and
recording, or in any information storage or retrieval system, without written permission from the publishers. 
For permission to photocopy or use material electronically from this work, please access www.copyright.com
(http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC) 222 Rosewood Drive,
Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and registration
for a variety of users. For organizations that have been granted a photocopy license by the CCC, a separate
system of payment has been arranged. 
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used only
for identification and explanation without intent to infringe.
Library of Congress Cataloging-in-Publication Data
MIMO system technology for wireless communications / edited by George Tsoulos.
p. cm.
Includes bibliographical references and index.
ISBN-13: 978-0-8493-4190-8 (0-8493-4190-6 : alk. paper)
1.  MIMO systems.  I. Tsoulos, George V., 1968-
TK5103.2.M565 2006
621.384--dc22
2005034989
Visit the Taylor & Francis Web site at 
http://www.taylorandfrancis.com
and the CRC Press Web site at 
http://www.crcpress.com
Taylor & Francis Group 
is the Academic Division of Informa plc.

(from the back cover)
Pyrsia: Optical Telegraph of 
Kleoxenos and Dimoklitos
According to the Greek historian Polyvios, Pyrsia (communication via optical signals using
torches  — Greek: pyrsos) was invented by Alexandrine engineers Kleoxenos and Dimoklitos
(4th century B.C.) and was further improved by Polyvios. The operation was based on the
following concept:
1. Separate the Greek alphabet into groups of letters, generating an appropriate matrix.
2. Combine two groups of big torches, visible from a considerable distance with the
help of diopters, in order to depict the appropriate letter (e.g., left/right torches
represented lines/columns, respectively).
In order to start transmission of a message, two torches were used from one end, and the
other end acknowledged that it was ready to receive the message, using two torches as well.
Then assuming, for example, a 5 × 5 grouping of the Greek alphabet, and that lines/columns
were represented by the left/right torches, if the letter “6” were to be transmitted, it would be
represented by two torches on the left and three on the right (see photo below). Obviously,
transmission of long messages was achieved by repeating the above method [e.g., the word
“5:78.&“ is (4,1), (4,5), (4,2), (4,3), (2,4), (1,1)].
Furthermore, different groupings of the alphabet (e.g., 8 × 3) could also be used along with
other methods of encryption (e.g., letters from right to left), for additional security.
Several elements of modern communications (some discussed in this book) are evidenced in
this ancient Greek telecommunication system.
Pyrsia: Optical Telegraph of Kleoxenos and Dimoklitos.
(Photograph from the Museum of Telecommunications of the Greek Organization of 
Telecommunications.)
Lines
Columns
\ ] ^ 1
I J K 6 L
M N O P Q
R S T U V
W X Y Z [


Preface
Use of multiple antennas at both ends of wireless links is the result of the
natural progression of more than four decades of evolution of adaptive
antenna technology. Recent advances have demonstrated that multiple-
input-multiple-output (MIMO) wireless systems can achieve impressive
increases in overall system performance. The potential to provide the next
major leap forward for wireless communications has led this technology to
becoming the next frontier of wireless communications. As a result, it has
received the attention not only of the international R&D community, but also
of the wireless communications industry. This is evidenced from the inter-
national standardization efforts in the context of UMTS (e.g., 3GPP) and IEEE
802.11 (for wireless LANs) and also in the context of proposals for next
generation (4G and beyond) wireless systems.
This book, MIMO System Technology for Wireless Communications, is a com-
pilation of the work of several authors. The goal is not only to provide a
complete reference source for readers interested in MIMO systems, but also
to provide up-to-date information on several key issues related to the tech-
nology. For this reason, considerable effort was made to cover most of the
elements of the technology and the related issues, some of which are not
currently treated in the available textbooks. Following this direction, the
following chapters are included in the book:
Chapter 1
Spatio-Temporal Propagation Modeling
Chapter 2
Theory and Practice of MIMO Wireless Communication Systems
Chapter 3
Information Theory and Electromagnetism: Are They Related?
Chapter 4
Introduction to Space–Time Coding
Chapter 5
Feedback Techniques for MIMO Channels
Chapter 6
Antenna Selection in MIMO Systems
Chapter 7
Performance of Multi-User Spatial Multiplexing with Meas-
ured Channel Data
Chapter 8
Multiuser MIMO for UTRA FDD
Chapter 9
Multifunctional Reconﬁgurable Microelectromechanical Sys-
tems Integrated Antennas for MIMO Systems
Chapter 10 Multi-Antenna Testbeds for Wireless Communications
Chapter 11 Gigabit Mobile Communications Using Real-Time MIMO-
OFDM Signal Processing
Chapter 12 Network Planning and Deployment Issues for MIMO Systems

The chapters are organized so the reader builds upon the information pro-
vided and gradually reaches a point where more complex (system) issues
are discussed. In this process, the reader is introduced to propagation mod-
eling, theoretical and realistic performance analyses, space–time codes, dif-
ferent systems, implementation options and limitations (antenna arrays,
channel knowledge, etc.), practical system development considerations, ﬁeld
trials, and network planning issues. Also, readers wishing to study further
speciﬁc aspects of MIMO technology will ﬁnd the references cited in each
chapter particularly useful.*
George V. Tsoulos
* Another useful source of information on MIMO technology is a recent two-part special issue
from the IEEE Communications Magazine:
“Adaptive antennas and MIMO systems for wireless communications — Part I,” IEEE Com-
munications Magazine, special issue, October 2004, G.V. Tsoulos (Guest Editor).
“Adaptive antennas and MIMO systems for wireless communications — Part II,” IEEE Com-
munications Magazine, special issue, December 2004, G.V. Tsoulos (Guest Editor).

Acknowledgments
I would like to express my gratitude to all the authors who contributed to
this book; to Prof. Alex Poularikas, the editor of the Electrical Engineering
and Applied Signal Processing Series of Taylor & Francis; and to the Taylor &
Francis publishing staff for their support during this publication project.


The Editor
George Tsoulos graduated from the National Technical University of Athens,
Department of Electrical and Computer Engineering, Greece, in 1992 and
earned his Ph.D. from the University of Bristol, U.K., in 1997.
From 1994 until 1999 Dr. Tsoulos was a research associate and then a
research fellow at the University of Bristol, working in the area of smart
antennas for wireless communications. From 1999 until 2002 he was with
the Global Technology Group of the PA Consulting Group, in Cambridge,
U.K., where he worked for a range of leading companies across the world
in the design and analysis of advanced wireless communication systems. In
2003 he joined the Institute of Communication and Computer Systems of
the National Technical University of Athens (NTUA), in the context of the
EC-funded research program, ENTER.
Dr. Tsoulos currently teaches at the University of Peloponnese, Department
of Telecommunication Sciences and Technology, and the Greek Open Uni-
versity. He is also involved in smart antenna and MIMO research activities
with the Department of Information Transmission Systems and Materials
Technology at NTUA, and the Department of Informatics & Telecommuni-
cations, National & Kapodistrian University of Athens.


Contributors
G.E. Athanasiadou
Department of Telecommunication Sciences and 
Technology, University of Peloponnese, Greece
Ernst Bonek
Technische Universität Wien, Vienna, Austria
David Browne
University of California, Los Angeles, California
Bedri Artug Cetiner
Morehead State University, Space Science Center, 
Morehead, Kentucky
Babak Daneshrad
University of California, Los Angeles, California
Mike Fitz
University of California, Los Angeles, California
Andreas Forck
Fraunhofer Institut for Telecommunications, Heinrich-
Hertz-Institute, Berlin, Germany
Ajay Gumalla
San Diego Research Center, San Diego, California
Jyri Hämäläinen
Nokia Networks, Oulu, Finland
Thomas Haustein
Fraunhofer Institute for Telecommunications, Heinrich-
Hertz-Institute, Berlin, Germany
Robert W. Heath, Jr.
The University of Texas at Austin, Austin, Texas
Christoph Juchems
Institut für Angewandte Funksystemtechnik GmbH, 
Braunschweig, Germany 
Volker Jungnickel
Fraunhofer Institute for Telecommunications, Heinrich-
Hertz-Institute, Berlin, Germany
Dimitra Kaklamani
School of Electrical and Computer Engineering, 
National Technical University of Athens, Athens, Greece
Markku Kuusela
Nokia Research Center, Nokia Group, Finland
Stephan Lang
University of California, Los Angeles, California
Harry Lee
San Diego Research Center, San Diego, California
David J. Love
School of Electrical and Computer Engineering, Purdue 
University, West Lafayette, Indiana

Sergey Loyka
School of Information Technology and Engineering (SITE), 
University of Ottawa, Ottawa, Canada
Christoph Mecklenbräuker
ftw. Forschungszentrum Telekommunikation 
Wien, Vienna, Austria
Neelesh B. Mehta
Mitsubishi Electric Research Labs, Cambridge, 
Massachusetts
Andreas F. Molisch
Mitsubishi Electric Research Labs, Cambridge, 
Massachusetts and Department of Electroscience, Lund University, 
Lund, Sweden
Juan Mosig
Swiss Federal Institute of Technology, Lausanne, Switzerland
Thomas Neubauer
Symena, Vienna, Austria
Christian Oberli
Department of Electrical Engineering, Pontiﬁcia 
Universidad Católica de Chile, Santiago, Chile
Kari Pajukoski
Nokia Networks, Oulu, Finland
Christian B. Peel
Brigham Young University, Provo, Utah
Alexander D. Poularikas
University of Alabama, Huntsville, Alabama
Raghu Rao
Xilinx Inc., San Jose, California
Quentin H. Spencer
Distribution Control Systems, Inc., Hazelwood, 
Missouri
Thomas Svantesson
ArrayComm, Inc., San Jose, California
A. Lee Swindlehurst
Brigham Young University, Provo, Utah
Esa Tiirola
Nokia Networks, Oulu, Finland
George Tsoulos
Department of Telecommunication Sciences and 
Technology, University of Peloponnese, Greece
Jon W. Wallace
Brigham Young University, Provo, Utah
Antonis D. Valkanas
Intracom S.A., Athens, Greece
Risto Wichman
Helsinki University of Technology, Finland
Dimitra Zarbouti
School of Electrical and Computer Engineering, 
National Technical University of Athens, Athens, Georgia
Weijun Zhu
University of California, Los Angeles, California
Wolfgang Zirwas
Siemens AG, Munich, Germany

Contents
1
Spatio-Temporal Propagation Modeling ...................................... 1
G.E. Athanasiadou
2
Theory and Practice of MIMO Wireless Communication 
Systems........................................................................................... 29
Dimitra Zarbouti, George Tsoulos, and Dimitra Kaklamani
3
Information Theory and Electromagnetism: 
Are They Related? ........................................................................ 57
Sergey Loyka and Juan Mosig
4
Introduction to Space–Time Coding........................................... 89
Antonis D. Valkanas and Alexander D. Poularikas
5
Feedback Techniques for MIMO Channels ............................. 113
David J. Love and Robert W. Heath, Jr.
6
Antenna Selection in MIMO Systems...................................... 147
Neelesh B. Mehta and Andreas F. Molisch
7
Performance of Multi-User Spatial Multiplexing with 
Measured Channel Data............................................................. 175
Quentin H. Spencer, Jon W. Wallace, Christian B. Peel, Thomas 
Svantesson, A. Lee Swindlehurst, Harry Lee, and Ajay Gumalla
8
Multiuser MIMO for UTRA FDD............................................. 207
Jyri Hämäläinen, Risto Wichman, Markku Kuusela, Esa Tiirola, 
and Kari Pajukoski
9
Multifunctional Reconﬁgurable Microelectromechanical 
Systems Integrated Antennas for Multiple Input Multiple 
Output Systems........................................................................... 249
Bedri Artug Cetiner
10
Multi-Antenna Testbeds for Wireless Communications ........ 273
Raghu Rao, Christian Oberli, Stephan Lang, David Browne, 
Weijun Zhu, Mike Fitz, and Babak Daneshrad

11
Gigabit Mobile Communications Using Real-Time 
MIMO-OFDM Signal Processing.............................................. 315
Volker Jungnickel, Andreas Forck, Thomas Haustein, 
Christoph Juchems, and Wolfgang Zirwas
12
Network Planning and Deployment Issues 
for MIMO Systems ..................................................................... 353
Thomas Neubauer, Ernst Bonek, and Christoph Mecklenbräuker
Index ..................................................................................................... 371

1
1
Spatio-Temporal Propagation Modeling
G.E. Athanasiadou
CONTENTS
1.1
Introduction ....................................................................................................2
1.2
Directional Channel Modeling ....................................................................2
1.2.1
Ring of Scatterers ..............................................................................4
1.2.2
Discrete Uniform Distribution Model ...........................................4
1.2.3
Geometrically Based Single-Bounce (GBSB) Statistical 
Channel Models.................................................................................5
1.2.3.1
Geometrically Based Circular Model 
(Macrocell Model)...............................................................5
1.2.3.2
Geometrically Based Elliptical Model 
(Microcell Model)................................................................6
1.2.3.3
Elliptical Subregions Model..............................................7
1.2.3.4
Elliptical Model with Dense Discrete Scatterers ...........7
1.2.4
Gaussian Wide Sense Stationary Uncorrelated Scattering 
(GWSSUS)...........................................................................................7
1.2.5
A Stochastic Spatio-Temporal Propagation Model (SSTPM).....8
1.2.6
Extended Saleh-Valenzuela Model...............................................10
1.2.7
Gaussian Scatter Density Model...................................................10
1.2.8
Gaussian AoA — Laplacian Power Azimuth Spectrum........... 11
1.2.9
Semi-Elliptical Geometrical Model............................................... 11
1.2.10 Lognormal Distribution of Local Angular Spread (AS), 
Delay Spread (DS), and Shadow Fading (Macrocells).............. 11
1.3
MIMO Propagation Modeling...................................................................12
1.3.1
Deterministic Propagation Modeling with Ray Tracing...........13
1.3.2
Stochastic Propagation Modeling.................................................17
1.3.2.1
The 3GPP MIMO Channel Model..................................18
References...............................................................................................................23

2
MIMO System Technology for Wireless Communications
1.1
Introduction
The evolution of wireless communications from analog to digital led to the
enhancement of early propagation models, which provided information
about power, in order to also consider time delay information. Further con-
sideration of the space domain either with space diversity or smart antennas
or, nowadays, MIMO systems has also pushed the evolution of propagation
modeling toward more complex spatio-temporal considerations.
In this context, there is a plethora of radiowave propagation models, each
developed and used for different applications. The right choice is critical for
speciﬁc analyzes and depends on system and operational parameters such
as the environment, speed, accuracy, cost and ease of use. Generally, expe-
rience has shown that for scenarios and parameters that are not very site
speciﬁc, sufﬁcient accuracy can be achieved at reasonable simulation speeds,
with stochastic models. On the other hand, for more site-speciﬁc scenarios,
more complex ray-tracing models that employ geographical databases are
required to provide reasonable accuracy, but at the cost of increased run
times.
This chapter starts with models that were developed in an attempt to
describe propagation characteristics for space diversity and smart antenna
applications. Then models developed to provide the necessary channel infor-
mation for MIMO applications are discussed. Obviously, measurement
campaigns played a key role in the development of these models, and hence,
important results from such activities are reported for both cases.
Several references are cited throughout this chapter, but there are some
good sources of information that the reader will ﬁnd particularly useful,
such as [1–5].
1.2
Directional Channel Modeling
Figure 1.1 shows that there are three different sources of scattering that affect
signal propagation between the base station and the mobile:
1. Scatterers around the mobile station (MS): Similar height or higher
than the mobile, hence, the received signal at the mobile usually
arrives with wide angular spread.
2. Scatterers around the base station (BS): Generally, the energy arrives
at the BS from identiﬁable clusters, which correspond to different
propagation mechanisms (e.g., single reﬂections from high objects or
from rooftop diffractions or street-guided propagation with multiple
reﬂections from the building walls, etc.). For different operational

Spatio-Temporal Propagation Modeling
3
scenarios there are different characteristics, e.g., in macrocells (BS at
the same level or above the surrounding scatterers), multipath is
contained within a relatively small angular spread with relatively
low delay spread. In microcells (BS below rooftops), the angular
spread is larger than in the macrocell case.
3. Multipath from remote scatterers is another possibility, e.g., in rural
operational scenarios. It is usually contained within a very small
angular spread but contributes large delay spread.
From Figure 1.1 we can see that each signal from the kth user experiences
a different multipath environment, described by the amplitude (Fi,k), phase
(^i,k), time delay (Yi,k), Doppler shift, and Angle-of-Arrival (AoA) components
(time varying). A convenient way to characterize the radio channel is through
its channel impulse response, which when modiﬁed to consider the AoA of
the multipath components for an antenna array, produces the vector channel
impulse response:
where a(Oi,k, Vi,k ) is the complex array response vector of the receive antenna
elements (xm, ym, zm) for the ith multipath direction (Oi,k, Vi,k) and operating
frequency f:
FIGURE 1.1
Scattering sources for radiowave propagation modeling.
h
a
( , )
exp
,
,
,
,
,
,
t
j
t
i k
i k
i k
i k
i k
Y
F
^
O
V
I
Y
=
(
) (
)

(
)
i
K
=¨
1
a O
V
U
Q
i k
i k
m
m
x
,
,
,
(
)
cos
(
) =

1
2
1
exp(j

O
V
O
V
V
i k
i k
m
i k
i k
m
i k
y
z
,
,
,
,
,
sin
sin
sin
cos
+
+
(
)
¬
®­
¼
¾½

4
MIMO System Technology for Wireless Communications
1.2.1
Ring of Scatterers [6]
In this model, the effective scatterers (each effective scatterer comprises a
cluster of scatterers) are uniformly spaced on a circular ring around the
mobile (Figure 1.2). In the one-ring-of-scatterers models, the BS is assumed
to be elevated and therefore not obstructed by local scattering, while the MS
is surrounded by scatterers and no Line-of-Sight (LOS) is assumed between
BS and MS.
Based on Figure 1.2 and assuming that N scatterers are uniformly placed
on a circle with radius R around the mobile at distance D from the base
station, the discrete angle of arrivals is [7]:
The model was originally used to predict signal correlation as a function
of antenna element spacing. Although correlation measurements at the BS
and MS are consistent with a narrow/wide angular spread at the BS/MS,
respectively, the power delay proﬁle predicted by this model is not generally
consistent with measurements. As a result there have been proposals (e.g.,
[8]) where additional rings of scatterers are added in an attempt to rectify
this problem. Furthermore, because small scale fading requires consideration
of Doppler shift, [8, 9] have proposed extensions that take into account this
effect.
1.2.2
Discrete Uniform Distribution Model [10]
This is a model similar to Lee’s ring of scatterers model [6]. Figure 1.3 shows
that it considers scatterers evenly located within a narrow beamwidth cen-
tered around the direction of the mobile.
FIGURE 1.2
One-ring-of-scatterers model.
MS
R
BS
DD
V
U
i
R
D
N i
i
N
=
©
«ª
¹
»º
=
sin
,
,
,
2
1 

Spatio-Temporal Propagation Modeling
5
Analysis performed by the same author suggests that, due to the fact that
in practice the AoA is discrete, a continuous AoA distribution (reported as
Gaussian for rural-suburban environments) will underestimate the correla-
tion that exists between the antenna array elements.
1.2.3
Geometrically Based Single-Bounce (GBSB) Statistical 
Channel Models
This kind of model assumes that scatterers are placed in a region according
to a spatial scatterer density function. From the location of each scatterer,
the AoA, Time-of-Arrival (ToA), and signal amplitude can be determined
along with the relevant probability density functions. In order to make the
calculations easier, two important assumptions are usually made.
First, the signal undergoes only one reﬂection when it travels from the MS
to the BS. Then, all scatterers conﬁned within the scattering area are isotropic
re-radiating elements, with random complex scattering coefﬁcients (yet, in
practice it is rather difﬁcult to assign realistic scattering coefﬁcients).
1.2.3.1
Geometrically Based Circular Model (Macrocell Model)
The idea behind this model [11–13] is shown in Figure 1.4. It assumes that
the scatterers lie within radius Rm about the mobile. The joint ToA and AoA
pdfs are reported in [2], where it is also shown that the circular model
predicts a relatively high probability of multipath components with small
excess delay along the line of sight, i.e., the model is more suitable for large
cell environments, where all the multipath components lie within a small
angular spread. The appropriate values for the radius of the scattering
depend on the macrocellular type of environment (urban, dense urban, etc.)
and the model can be “tuned” based on results from measurements.
FIGURE 1.3
Discrete uniform distribution of scatterers.
BS
d
D

6
MIMO System Technology for Wireless Communications
1.2.3.2
Geometrically Based Elliptical Model (Microcell Model)
Figure 1.5 shows that this model places the base station and the mobile at
the foci of an ellipse and distributes the scatterers uniformly within the ellipse.
It was proposed in [14] for applications in microcellular environments, since
in such environments antenna heights are relatively low, and hence, multi-
path scattering near the base station and the mobile is just as likely. The
semi-major and semi-minor axes are calculated as a function of the maximum
ToA to be considered, and this determines both the delay spread and angular
spread of the channel.
According to [15], this model produces a high probability of scatterers with
minimum excess delay along the LOS.
FIGURE 1.4
Geometrically based circular model.
FIGURE 1.5
Geometrically based elliptical model.
BS
MS
R
D
D
BS
MS
2a
2b
D

Spatio-Temporal Propagation Modeling
7
1.2.3.3
Elliptical Subregions Model [16]
If the distribution of scatterers in elliptical subregions (corresponding to
different ranges of excess delay) is considered, then we get the model shown
in Figure 1.6.
This approach is similar to the Geometrical Based Elliptical Model pro-
posed by [14], where the scatterers are uniformly distributed within the
entire ellipse, while here the ellipse is subdivided into a number of elliptical
subregions. A number of scatterers is then selected within each subregion
employing a Poisson random variable, with its mean chosen to match the
measured time characteristics. Furthermore, due to multiple reﬂection points
of the scatterers, the multipath components arrive in clusters.
1.2.3.4
Elliptical Model with Dense Discrete Scatterers [17]
This is a wide-band spatial model, where diffuse scattering is modeled using
dense discrete scatterers. The transmitter and receiver deﬁne the focal points
of ellipses with constant propagation delay. The scatterers are distributed on
ellipsoids. To simplify the model, only the intersection of the ellipsoid and
the ground is used. A uniform distribution of scatterers is assumed, although
the calculated distribution function for the scatterers around the mobile is
not uniform (it has two spikes). Two channel models are deﬁned — a rural
macrocell model and an urban microcell model.
1.2.4
Gaussian Wide Sense Stationary Uncorrelated 
Scattering (GWSSUS)
This is a statistical model that makes assumptions about the received signal
vector [18–20] (Figure 1.7). Although scatterers are grouped in clusters, spatio-
temporal multipath is not resolvable within a cluster, i.e., the narrowband
channel assumption is satisﬁed. Nevertheless, frequency-selective fading
channels can be modeled by including multiple clusters.
FIGURE 1.6
Elliptical subregions model.
B S 
M S 
BS
MS
D

8
MIMO System Technology for Wireless Communications
The steering vector(s), due to multipaths from the kth cluster, can be
expressed in this case as the sum of all the contributions (K) from the scat-
terers within the kth cluster:
where Fi,k is the amplitude, ^i,k the phase and Oi,k the relative AoA of the ith
multipath in the kth cluster, and a(O) is the complex array response vector of
the receive antenna elements for direction and operating frequency f.
If the number of scatterers in each O cluster is sufﬁciently large, (v10 from
[18]), then this sum is Gaussian distributed (central limit theorem). Also,
wide sense stationarity is assumed, which leads to the steering vector being
multi-variate Gaussian distributed and, hence, described by its mean and
covariance matrix, presented in [19].
A special case of the GWSSUS model is the Gaussian AoA model [21],
where only one cluster is considered and the AoA statistics are assumed to
be Gaussian distributed about the direction of the cluster (narrowband ﬂat
fading model).
1.2.5
A Stochastic Spatio-Temporal Propagation Model (SSTPM)
The GWSSUS channel model does not impose any conditions on the spatial
distribution of the received power, hence, requiring additional information
in order to be used in space–time studies. The GBSB channel models, on the
other hand, do not provide information about the temporal evolution of the
generated channel characteristics, resulting in consecutive snapshots being
un-correlated, an un-realistic assumption.
In order to avoid these problems, [22] and [23] proposed a hybrid
approach, which combined these two classes of channel models (the GBSB
FIGURE 1.7
The GWSSUS model.
BS
MS
Scatterer clusters 
s
a
k
i k
i k
i k
i
K
j
=
(
) (
)
=¨F
^
O
,
,
,
exp
1

Spatio-Temporal Propagation Modeling
9
and GWSSUS) and further considered time variations associated with the
movement of the mobile (non-stationary scenarios), as shown in Figure 1.8.
The scattering area in the presented model has a circular shape (although
the general elliptical case can also be considered), and a uniform distribution
of scatterers is assumed (given area density of scatterers, which depends on
the type of environment, i.e., urban, suburban, rural). As shown in Figure 1.8,
the mobile is located at the center of the circular scattering area, which moves
together with the mobile. The scatterers are positioned at ﬁxed locations
throughout a large area (e.g., the cell), but active scatterers are only those
within the circular scattering area. As a result, the number of multipaths is
not ﬁxed as the mobile moves but follows a random process (Poisson dis-
tributed). The expected number of scatterers depends on the scatterers’ area
density and the scattering area size, and hence, it depends on the type of
the operational environment. The pdf of the “scatterers’ lifetime” is also
calculated from the authors, and is shown to depend on the size of the
scattering area and the mobile speed.
The angular spread of the channel is described by the probability density
function (pdf) of the angle of arrival and was derived in [24]:
where F =R/lBM, i.e., the cluster radius over the distance between the MS and
the BS. The above expression is a special case of the formula derived in [24]
for the elliptical case:
FIGURE 1.8
Stochastic spatio-temporal propagation model concept.
BS
R
MS’
MS
R
f
F
k
k
k
k
k
O O
U
O
O
O
O
O
(
) =
(
)
(
)+


<
<
2
1
2
2
cos
cos
max
for
kmax
0
elsewhere
¯
°
²²
±
²
²

10
MIMO System Technology for Wireless Communications
where a, b, d are the major and minor axes of the ellipse and the distance
from the BS, respectively, F = a/d and E = b/a, and < can be calculated from
As mentioned above, the consecutive channel characteristics have corre-
lated temporal characteristics, hence allowing for the direct calculation of
the correlation functions.
1.2.6
Extended Saleh-Valenzuela Model
In [25] extensive indoor measurements using a system that collects simulta-
neous time and angle of arrival data at 7 GHz have shown a clustering
pattern in the time-angle multipath data. The model proposed for indoor
environments employs the clustered “double Poisson” time-of-arrival model
proposed by Saleh and Valenzuela [26], with statistical independence
between time and angle. The mean angles of each cluster are distributed
uniformly over all angles. The distribution of arrivals within clusters is
approximately Laplacian, with standard deviations ranging from 22° to 26°.
1.2.7
Gaussian Scatter Density Model
The spatial characteristics of the radio channel are studied in [27], based on
work presented in [28], with the Gaussian Scatter Density Model (GSDM).
Starting from a Gaussian distribution of scatterers around a mobile station,
expressions are provided for the pdfs of AoA, the power azimuth spectrum,
the ToA, and the time delay spread, all as seen from a BS. Expressions are
also provided for the rms delay spread, the rms angular spread and the
spatial cross correlation function.
Also, with an appropriate choice of the standard deviation of the scattering
region, the Gaussian density model is suitable for environments with small
angular spreads (macrocells) or with large angular spreads (picocells). When
f
E
O O
O
O
O
O
( ) =
( )
( )
( )+

cos
cos
cos
sin
1
2
2
2
2
<
( )
(
)

(
)
( )+
( )
(
)

<
<
1
2
2
2
2
2
F
E cos
sin
max
O
O
O
O
O
for
max
0
elsewhere
¯
°
²
²²
±
²
²
²
f
d
O
O
O
O
O
( )
=
µ
1
max
max

Spatio-Temporal Propagation Modeling
11
the scattering width is small compared with the distance between the BS
and the MS, it is shown that the pdf in the AoA reduces to the Gaussian
function.
1.2.8
Gaussian AoA — Laplacian Power Azimuth Spectrum
A statistical model of azimuthal and temporal dispersion in mobile radio
channels is presented in [29]. Based on ﬁeld trial results, it is proposed that
for typical urban environments, the power azimuth spectrum (PAS) can be
modeled by a Laplacian function, while the power delay spectrum (PDS)
can be modeled by a one-sided exponential decaying function.
Positive correlation between azimuth and delay spread also was observed
from the measurements. Hence, propagation environments with high angu-
lar spread also have high delay spread, and vice versa. A signiﬁcant increase
in both angular and delay spread was also observed with the lowering of
the BS antenna below rooftop height.
The pdf of the azimuth of the multipath rays was found to match a
Gaussian function, while the pdf of their delays matched a one-sided expo-
nential decay function.
For bad urban environments, a two-cluster model was proposed, with the
PAS described by the sum of two Laplacian functions and the PDS by the
sum of two exponentially decaying functions. The power azimuth-delay
spectrum could not be expressed as a product of the PDS and PAS in this
case, contrary to the typical urban scenario.
1.2.9
Semi-Elliptical Geometrical Model
In [30, 31] a geometric-based channel model with a semi-elliptical coverage
area is applied in order to determine a new PAS model (called the secant
square PAS model). This model is appropriate for environments where the
BS is on a building with height close to that of the surrounding building
scatterers, and the authors show that it is a better ﬁt to the employed exper-
imental results (from the European project TSUNAMI II) than the previously
proposed Laplacian model for these scenarios.
1.2.10
Lognormal Distribution of Local Angular Spread (AS), 
Delay Spread (DS), and Shadow Fading (Macrocells)
In [32] the joint statistical behavior of the random variables describing the
local AS, the local DS, and the shadow fading component is studied using
measurements in macrocellular (including NLOS) scenarios. It is found that
a log-normal distribution provides an accurate ﬁt of the measured pdfs for
all three parameters. Their spatial autocorrelation functions follow an expo-
nential decay for typical and bad urban environments, and a double exponen-
tial decay in suburban environments. The decorrelation distance of the AS,

12
MIMO System Technology for Wireless Communications
DS, and shadow fading is observed to be nearly identical within each envi-
ronment class. The fact that the pdf and the spatial autocorrelation function
of the three parameters are identical indicates that the propagation mecha-
nisms leading to these effects are strongly related.
1.3
MIMO Propagation Modeling
The discussion up to now has considered single-input-multiple-output
(SIMO) propagation models. This section focuses more on the multiple-
input-multiple-output (MIMO) propagation models. Figure 1.9 shows a
MIMO system with M transmit and N receive antenna elements. The general
expression for the baseband signal in this case can be expressed as:
where y(t) is the received, s(t) the transmitted, n(t) the noise signal, * denotes
convolution, and H(t) is the M × N channel matrix. If the signal bandwidth
is narrow enough so that the channel can be considered approximately
constant over frequency, then we get the narrowband MIMO channel matrix.
Otherwise, we get the wideband MIMO channel matrix.
Based on a similar approach to that presented in the previous section, this
section addresses two major categories of models:
•
Deterministic
•
Stochastic (parametric, geometric, correlation)
Some of the models presented in the following sections are based on
propagation measurements ([1] and [5] include good surveys on space–time
measurement campaigns).
FIGURE 1.9
MIMO system concept.
y
H
s
n
( )
( )
( )
( )
t
t
t
t
=

+
M
N
H(t)

Spatio-Temporal Propagation Modeling
13
1.3.1
Deterministic Propagation Modeling with Ray Tracing
This modeling approach has evolved from SISO to SIMO and, more recently,
MIMO scenarios, and hence, it is discussed here, in the MIMO propagation
modeling section, since the last represents the more general approach.
Ray tracing is a technique based on Geometrical Optics (GO), an easily
applied approximate method for estimating a high-frequency electromagnetic
ﬁeld [33]. The dissipating energy is considered to be radiating in inﬁnitesimally
small tubes, often called rays. These rays are normal to the surface of equal
signal power, lie in the direction of propagation, and travel in straight lines,
provided that the refractive index is constant. Their amplitude is governed
by the conservation of energy ﬂux in the ray tube. In GO, only direct, reﬂected
and refracted rays are considered, and consequently abrupt transition areas
occur, corresponding to the boundaries of the regions where these rays exist.
The Geometrical Theory of Diffraction (GTD) [34] and its uniform extension,
the Uniform GTD (UTD) [35, 36], complement the GO theory by introducing
a new type of rays, known as the diffracted rays. The purpose of these rays
is to remove the ﬁeld discontinuities and to introduce proper ﬁeld correc-
tions, especially in the zero ﬁeld areas predicted by GO.
The extended Fermat principle and the principle of local ﬁeld are two basic
concepts extensively used by the ray models [37]. While the original Fermat
principle states that a GO ray follows the shortest path from a source point
to a ﬁeld point, the extended Fermat principle also includes the diffracted
rays and states that these rays follow the shortest path as well. The principle
of the local ﬁeld states that the high frequency boundary processes, such as
reﬂection, refraction and diffraction, depend only on the electrical and geo-
metrical properties of the scatterer in the immediate neighborhood of the
point of interaction. The corresponding amplitude, phase and direction of a
ray following reﬂections, refractions and diffractions can be calculated using
a combination of Snell’s laws, UTD and Maxwell’s equations [33].
In a wireless communication system, the signal arriving at the receiving
antenna consists of several multipath components, each of which is the result
of the interaction of the transmitted waves with the surrounding environ-
ment. The application of GO and UTD to a given propagation problem
requires that the given conﬁguration is decomposed into simple geometrical
conﬁgurations for which the reﬂection, transmission and diffraction coefﬁ-
cients can be calculated. All rays contributing signiﬁcantly to the channel
characterization at the examined position must be traced, and the complex
impulse response h(t) of the radio channel is then found as the sum of these
contributions [38]. Here, the received signal is formed by N time delayed
impulses (rays), each represented by an attenuated and phase-shifted version
of the original transmitted impulse. For each ray, the model computes the
amplitude An, the arrival time Yn and phase /n. According to the objects encoun-
tered by the ith ray, its complex received ﬁeld amplitude Ei (V/m) is given by:
E
E
R
T
A s s D
e
d
i
ti
ri
j
j
k
l
l
l
k
jkd
f f
=

e


{
}

0
( , )

14
MIMO System Technology for Wireless Communications
where E0 represents the reference ﬁeld, fti and fri the transmitting and receiv-
ing antenna ﬁeld radiation patterns in the direction of the ray, Rj the reﬂection
coefﬁcient for the jth reﬂector, Tk the wall transmission coefﬁcient for the kth
transmission, Dl the diffraction coefﬁcient for the lth diffracting wedge and
e–jkd the propagation phase factor due to the path length d (k = 2U/Q, with Q
the wavelength). The diffraction coefﬁcients are also multiplied by a factor
Al(se,s) which ﬁnds the correct spatial attenuation of the diffracted rays, given
the 1/d dependence in the last term. An advantage of ray-tracing models
over other propagation models is the ability to incorporate antenna radiation
patterns and particularly to consider the effect of the radiation pattern on
each ray individually.
In order to trace rays that are generated and launched from the transmit-
ting antenna, two methods have been developed: the imaging technique and
the ray launching technique. The imaging technique (e.g., [39, 40]) is based on
the electromagnetic theory of images and works by generating an image
table for each BS location, considering all the various wall reﬂection, trans-
mission and diffraction permutations that are possible in a given area. The
image information is then stored and used to compute the channel charac-
teristics at each mobile location. In the ray launching approach (e.g., [41, 42]),
rays are sent out at various angles and their paths are traced until a certain
power threshold is reached. The number of rays considered and the distance
from the transmitter to the receiver location determined the available spatial
resolution and the accuracy of the model.
In the image-based models presented in [40] (for microcells), [43] (for
indoor) and [44, 45] (for macrocells), the geometry of each ray is examined
in three-dimensional (3D) space, and hence, both the azimuth and the ele-
vation angles of arrival at the antennas are available. Moreover, the 3D
antenna radiation patterns can be used and steered in any direction in space
so that the channel can be examined for any antenna orientation. Note that
the model works with the electromagnetic ﬁeld of the rays and, hence, uses the
radiation patterns of the ﬁeld components. This feature, in conjunction with
the fact that all reﬂections, transmissions and diffractions are computed
using 3D vector mathematics, makes the models very useful in the study of
different antenna polarizations and the examination of depolarization effects.
Since the ﬁeld components can be calculated for each antenna element
separately, as explained above, the MIMO channel matrix can be generated,
as shown in Figure 1.10 and Figure 1.11. Figure 1.10 shows the geographical
database of the area and examples of 2D-3D multipath visualization. It can
be seen that ray tracing offers site-speciﬁc information for the radio channel
characteristics and, hence, provides more accurate predictions. Figure 1.11
shows an example of the 3D impulse responses (amplitude-delay-AoA) for
a MIMO scenario (between Tx element m and Rx element n). It shows polar
plots for the AoA (azimuth) vs. power at the BS (a) and MS (b), the AoA
(elevation) vs. power at the BS (c) and MS (d) and, ﬁnally, the ToA vs. power (e).
The application of ray-tracing models to study several aspects of propa-
gation modeling has proven to be a popular method.

Spatio-Temporal Propagation Modeling
15
In [46, 47] the spatial characteristics of microcellular environments are stud-
ied. Results showed that the signal is not uniformly distributed in the spatial
domain, but instead is contained in a few narrow clusters. Although the number
of clusters increases under NLOS conditions, for both LOS and NLOS positions,
90% of the power is contained within two clusters. Also, although the angular
FIGURE 1.10
Map of the environment under investigation with 2D (a) and 3D (b) multipath examples.
5000
4500
4000
3500
3000
2500
500
1000
1500
2000
(a)
(b)
2500
3000

16
MIMO System Technology for Wireless Communications
FIGURE 1.11
Example of ray-tracing 3D impulse responses for a MIMO scenario: AoA (azimuth) vs. power
at the BS (a) and MS (b). AoA (elevation) vs. power at the BS (c) and MS (d). (e) ToA vs. power.
90
−100
−150
120
150
180
210
240
270
(a)
(b)
(c)
300
330
0
30
60
90
−100
−150
120
150
180
210
240
270
300
330
0
30
60
90
−100
−150
120
150
180
210
240
270
300
330
0
30
60
Power(dBm)
Power(dBm)
Power(dBm)
90
−100
−150
120
150
180
210
240
270
(d)
300
330
0
30
60
Power(dBm)
(e)
−100
−110
−120
−130
−140
−150
−160
Received power (dBm)
5000
6000
7000
8000
Time (nsec)
9000 10000 11000

Spatio-Temporal Propagation Modeling
17
spread and the number of multipath rays almost doubles under NLOS condi-
tions, there are still only two important clusters that contain most of the power
with angular spread less than the beamwidth of an eight element array.
In [48] the spatial and temporal characteristics of 60GHz indoor channels
were analyzed. Multipath components were resolved in time by using a
sliding correlator with 10 ns resolution and in space by sweeping a direc-
tional antenna with 7° half power beamwidth in the azimuthal direction.
Power delay proﬁles (PDPs) and power angle proﬁles (PAPs) were measured
in various indoor and short-range outdoor environments. The measurement
results conﬁrm that the majority of the multipath components can be deter-
mined from image-based, ray-tracing techniques for LOS applications. For
non-LOS propagation through walls, the metallic structure of composite
walls must be considered. Also, statistical parameters of received power,
AoA and ToA, were calculated from the measurements, which agreed well
with the theoretical expectations.
Furthermore, ray-tracing models have also been used to produce the data
sets required for the statistical evaluation of the parameters of stochastic mod-
els, as in [49]. The advantage of using deterministic predictions instead of ﬁeld
trial measurements is mainly that large data sets can be easily produced for
many different test environments. Also, when using ﬁeld trial results in order
to produce a statistical model, the inﬂuence of the measurement antennas is
included in the results and cannot be eliminated afterward. In [49], a stochastic
model for the indoor mobile propagation channel is presented. The channel
is described by multipath components, including 3D angles of arrival at the
antennas. By relating the angle of arrival to the direct line between transmitter
and receiver, a universal modeling approach, which is independent of the
actual geometry, becomes possible. In each modeling step, path properties
change according to the movement of the radio stations. The appearance and
disappearance of multipath components are modeled by a genetic process.
1.3.2
Stochastic Propagation Modeling
There have been several such models proposed, analyzed and discussed the
last few years; some of the most representative are brieﬂy mentioned here:
•
Wideband Directional Channel Model (WDCM), [50]. Geometrically
based, parameterized for macro, microcells, circular-elliptical scat-
tering area, single bounce.
•
Geometrical MIMO channel model based on SISO parameters [51, 52].
Macrocellular broadband ﬁxed wireless, multiple delay ellipses, circle
of local scatterers around the MS, double bounces. To better repre-
sent such environments, two local rings are introduced in this model:
a disc of exclusion, representing a scatterer-free area around the BS,
and a smaller circular ring surrounding the CPE including a subset
of the scatterers in the ﬁrst ellipse (see Figure 1.12). The channel
matrix is then calculated using a ray-based approach.

18
MIMO System Technology for Wireless Communications
•
Generic MIMO model [53]. Double scattering, far clusters, wave-
guiding, guidelines to select the proper distribution of scatterers.
•
Double Directional Channel Model (DDCM) [54, 55]. Parametric
stochastic model, parameters through spatial scatterer distribution
[1]. Tapped delay line with each multipath having complex charac-
teristics (amplitude, delay, AoA).
•
Indoor MIMO models:
–
EU IST METRA (Multi-Element Transmit Receive Antennas)
project: A stochastic MIMO radio channel model for non-line-of-
sight (NLOS) scenarios was proposed on the basis of the power
correlation matrix of the MIMO radio channel [56].
–
EU IST SATURN (Smart Antenna Technology in Universal Broad-
band Wireless Networks) project: Based on the statistical charac-
teristics of the measured data, both narrowband [57] and wideband
[58] statistical models for NLOS MIMO propagation channels
were developed.
•
One (two) ring(s) MIMO channel models [59, 60]. Extension of [6]
for MIMO channel modeling.
•
One ring MIMO model with Von Mises angular distribution [61].
Von Mises angular pdf at the MS.
•
Distributed scattering MIMO model [62]. Outdoor, narrowband, one
group of scatterers near the BS and one near the MS.
1.3.2.1
The 3GPP MIMO Channel Model [63]*
A serious attempt to unify the propagation modeling approach for space–
time models started a few years ago with the European Scientiﬁc Action
COST259 [1]. This work received even more attention when adopted as the
basis for spatial channel modeling in the context of the international stan-
dardization body of 3GPP. Naturally, it was inﬂuenced by many different
FIGURE 1.12
Physical combined model for macrocellular scenarios.
* 3GPP TSs and TRs are the property of ARIB, ATIS, ETSI, CCSA, TTA, and TTC who jointly own
the copyright in them. They are subject to further modiﬁcations and are therefore provided to
you "as is" for information purposes only. Further use is strictly prohibited.
BTS
CPE
Scatterer
free area 

Spatio-Temporal Propagation Modeling
19
proposals discussed in 3GPP (see technical documents for spatial channel
model). This section describes in greater detail the parametric stochastic
model that has been adopted recently by the 3GPP.
The combined 3GPP-3GPP2 spatial channel model ad-hoc group has spec-
iﬁed parameters and methods for spatial channel modeling. The scope is the
development of speciﬁcations for system-level evaluation with emphasis on
the physical parameters, and link-level evaluation, deﬁned only for calibra-
tion purposes (not for evaluation or comparisons).
As such, the following section presents the key characteristics of the spatial
channel model that has been adopted for system-level simulation studies.
(A detailed description is available in [63].)
1.3.2.1.1
Spatial Channel Model for Simulations
For an S element BS array and a U element MS array, the channel coefﬁcients
for one of N multipath components (note that these components are not
necessarily resolvable in the time domain, since the time difference between
successive paths may be less than a chip period) are given by an S-by-U
matrix of complex amplitudes. The channel matrix for the nth multipath
component (n = 1, …, N), Hn(t), is a function of time, because the complex
amplitude undergoes fast fading due to the movement of the MS.
The overall procedure for generating the channel matrices consists of three
basic steps:
1. Specify an environment (either macro urban or macro suburban, or
micro).
2. Obtain the simulation parameters associated with each environment.
3. Generate the channel coefﬁcients based on these parameters.
Figure 1.13 shows the angular parameters used in the model. The following
deﬁnitions are used:
<BS
BS antenna array orientation, deﬁned as the difference between the broadside of the 
BS array and the absolute North (N) reference direction
VBS
LOS AoD direction between the BS and MS, with respect to the broadside of the BS 
array
In,AoD
AoD for the nth path (n = 1 … N) with respect to the LOS AoD VBS
)n,m,AoD
Offset for the mth sub-path (m = 1 … M) of the nth path with respect to In,AoD
Vn,m,AoD
Absolute AoD for the mth sub-path of the nth path at the BS with respect to the BS 
broadside
<MS
MS antenna array orientation, deﬁned as the difference between the broadside of 
the MS array and the absolute North reference direction
VMS
Angle between the BS-MS LOS and the MS broadside
In,AoA
AoA for the nth path with respect to the LOS AoA VMS
)n,m,AoA
Offset for the mth sub-path of the nth path with respect to In,AoA
Vn,m,AoA
Absolute AoA for the mth sub-path of the nth path at the MS with respect to the MS 
broadside
v
MS velocity vector
Vv
Angle of velocity vector with respect to the MS broadside: Vv = arg(v)

20
MIMO System Technology for Wireless Communications
For the simulations some general assumptions are made (Table 1.1):
a. Uplink-downlink reciprocity, i.e., the AoD/AoA values are identical
between the uplink and downlink.
b. For FDD systems, random sub-path phases between uplink and
downlink are uncorrelated. For TDD systems, the phases are fully
correlated.
c. Shadowing among different mobiles is uncorrelated.
d. The spatial channel model allows any type of antenna conﬁguration
(e.g., with size smaller than the shadowing coherence distance). In
order to compare algorithms, reference antenna conﬁgurations
based on uniform linear array with 0.5, 4 and 10 wavelength inter-
element spacing are used.
e. The composite AS (angle spread), DS (delay spread) and SF(shadow
fading) may be correlated parameters depending on the channel
scenario, and are applied to all the sectors or antennas of a given
base. The AS is composed of 6 × 20 sub-paths, and each has a precise
angle of departure, which corresponds to an antenna gain from each
BS antenna. The SF is a bulk parameter and is common among all
the BS antennas or sectors.
f. The elevation spread is not modeled.
g. To allow comparisons of different antenna scenarios, the transmit
power of a single antenna case is the same as the total transmit power
of a multiple antenna case.
h. The generation of the channel coefﬁcients assumes linear arrays
(although the procedure can be generalized for other array conﬁg-
urations).
FIGURE 1.13
BS and MS angle parameters for the 3GPP model [63].
θBS
δn,AoD
δn,AoA
ΩBS
N
N
Cluster n
ΩMS
θMS
θv
BS array broadside 
MS array broadside 
BS array 
MS direction of travel
MS array 
Subpath m
v
∆n,m,AoD
∆n,m,AoA
θn,m,AoA
θn,m,AoD

Spatio-Temporal Propagation Modeling
21
The following are assumptions for the macrocell suburban and urban
environments:
a. The macrocell pathloss is based on the modiﬁed COST231 Hata
urban propagation model:
TABLE 1.1
Environment Parameters [63]
Channel Scenario
Suburban
Macro
Urban Macro
Urban Micro
Number of paths (N)
6
6
6
Number of sub-paths (M) per 
path
20
20
20
Mean AS at BS
E(XAS) = 5°
E(XAS) = 8°, 15°
NLOS: E(XAS) = 19°
AS at BS as a lognormal random 
variable 
XAS = 10°(JASx + µAS), x ~ M(0, 1)
µAS = 0.69
JAS = 0.13
8° µAS = 0.810
15° µAS = 1.18
N/A
JAS = 0.34
JAS = 0.210
rAS = XAoD/XAS
1.2
1.3
N/A
Per path AS at BS (ﬁxed)
2°
2°
5° (LOS and NLOS)
BS per path AoD Distribution 
standard distribution 
M(0, X 2
AoD) 
where
XAoD = rASXAS
M(0, X2
AoD) 
where
XAoD = rASXAS
U(–40°, 40°)
Mean AS at MS
E(XAS, MS) = 68°
E(XAS, MS) = 68°
E(XAS, MS) = 68°
Per path AS at MS (ﬁxed)
35°
35°
35°
MS Per path AoA Distribution
M(0, X2
AoA(Pr))
M(0, X2
AoA(Pr))
M(0, X2
AoA(Pr))
Delay spread as a lognormal 
random variable
XDS = 10°(JDSx + µDS), x ~ M(0, 1) 
µDS = –6.80
JDS = 0.288
µDS = –6.18
JDS = 0.18
N/A
Mean total RMS delay spread
E(XDS ) = 0.17 µs
E(XDS ) = 0.65 µs
E(XDS ) = 0.251 µs 
(output)
rDS = Xdelays/XDS
1.4
1.7 
N/A
Distribution for path delays
U(0, 1.2 µs)
Lognormal shadowing 
standard deviation, XSF
8dB
8dB
NLOS: 10 dB
LOS: 4 dB 
Pathloss model (dB), d is in 
meters
31.5 + 35log10(d) 
34.5 + 35log10(d) 
NLOS:
34.53 + 38log10(d)
LOS:
30.18 + 6log10(d) 
PL dB
h
d
BS
[
]
.
.
log
log
=

(
)
(
)
©
«ª
¹
»
44 9
6 55
1000
10
10
º +
+

(
)
( )

45 5
35 46
1 1
13 82
10
1
.
.
.
log
.
log
h
f
MS
c
0
0 7
h
h
C
BS
MS
(
)+
+
.

22
MIMO System Technology for Wireless Communications
where hBS and hMS are the BS and MS antenna height (in meters), fC
is carrier frequency (in MHz), d is the distance between MS and BS
(in meters) and C is a constant factor (C = 0 dB for suburban macro
and C = 3 dB for urban micro).
b. Site-to-site SF corelation is 0.5.
The following are assumptions for the microcell environment:
a. The microcell NLOS pathloss is based on the COST 231 Walﬁsh-
Ikegami NLOS model with the following parameters: BS antenna
height 12.5 m, building height 12 m, building to building distance
50 m, street width 25 m, MS antenna height 1.5 m, orientation 30 deg
for all paths, and selection of metropolitan center. With these param-
eters, the equation simpliﬁes to: 
PL(dB) = –55.9 + 38*log10(d) + (24.5 + 1.5*fc/925)*log10(fc)
The resulting pathloss at 1900 MHz is: PL(dB) = 34.53 + 38*log10(d),
where d is in meters. The distance d is at least 20 m. A bulk log
normal shadowing applying to all sub-paths has a standard devia-
tion of 10 dB.
The microcell LOS pathloss is based on the COST 231 Walﬁsh-Ikeg-
ami street canyon model with the same parameters as in the NLOS
case. The pathloss is
PL(dB) = –35.4 + 26*log10(d) + 20*log10(fc)
The resulting pathloss at 1900 MHz is PL(dB) = 30.18 + 26*log10(d),
where d is in meters. The distance d is at least 20 m. A bulk log
normal shadowing applying to all sub-paths has a standard devia-
tion of 4 dB.
b. Site-to-site correlation is _ = 0.5.
In [63], the algorithm that generates the model parameters is
explained step by step for the different operational environments.
These parameters are then used to generate the channel coefﬁcients.
For an S element linear BS array and a U element linear MS array,
the channel coefﬁcients for one of N multipath components are given
by a U-by-S matrix of complex amplitudes. The channel matrix for
the nth multipath component (n = 1,…,N) is denoted as Hn(t). The
(u,s)th component (s = 1,…,S; u = 1,…,U) of Hn(t) is given by
h
t
P
M
G
j kd
u s n
n
SF
BS
n m AoD
s
n m
, ,
,
,
,
( )
exp
sin
=
(
)
X
V
V
,
,
,
,
exp
sin
AoD
n m
MS
n m AoA
u
G
jkd
(
) +
¬®
¼¾
(
) ×
(
)
+
V
Vn m AoA
n m AoA
v
jk
t
,
,
,
,
exp
cos
(
)
(
) ×

(
)
(
)
©
«
ª
ª
ª
v
V
V
ª
ª
ª
¹
»
º
º
º
º
º
º
=¨
m
M
1

Spatio-Temporal Propagation Modeling
23
where
Pn
is the power of the nth path.
XSF
is the lognormal shadow fading, applied as a bulk
parameter to the n paths for a given drop.
M
is the number of sub-paths per path.
Vn,m,AoD
is the AoD for the mth sub-path of the nth path.
Vn,m,AoA
is the AoA for the mth sub-path of the nth path.
GBS(Vn,m,AoD) is the BS antenna gain of each array element.
GMS(Vn,m,AoA) is the MS antenna gain of each array element.
k
is the wave number 2U/Q where Q is the carrier wave-
length in meters.
dS
is the distance in meters from BS antenna element s
from the reference (s = 1) antenna. For the reference
antenna s = 1, d1 =0.
du
is the distance in meters from MS antenna element u
from the reference (u = 1) antenna. For the reference
antenna u = 1, d1 =0.
+n,m
is the phase of the mth sub-path of the nth path.
v
is the magnitude of the MS velocity vector.
Vv
is the angle of the MS velocity vector.
The pathloss and the log normal shadowing is applied as bulk parameters
to each of the sub-path components of the n path components of the channel.
Also in [63], a method of using polarized antennas in the above model is
presented and the resulting channel characterization is given. Finally, the
model includes options for far scatterer clusters, line of sight and urban
canyon.
References
1. L.M. Correia, Ed. 2001. Wireless Flexible Personalized Communications, COST 259:
European Cooperation in Mobile Radio Research, Chichester: John Wiley &
Sons.
2. R.B. Ertel, P. Cardieri, K.W. Sowerby, T.S. Rappaport, and J.H. Reed. 1998.
“Overview of spatial channel models for antenna array communication
systems,” IEEE Personal Communications Magazine, Vol. 5, No. 1, Feb., pp. 10–22.
3. K. Yu and B. Ottersten. 2002. “Models for MIMO propagation channels: a
review,” Wireless Communications and Mobile Computing, Vol. 2: pp. 653–666.
4. J.C. Liberti and T.S. Rappaport. 1999. Smart Antennas for Wireless Communica-
tions, Upper Saddle River, NJ: Prentice Hall.

24
MIMO System Technology for Wireless Communications
5. L. Schumacher, L.T. Berger, J. Ramiro-Moreno, and T.B. Sorensen. 2004. “Prop-
agation characterization and MIMO channel modeling for 3G,” in Adaptive
Antenna Arrays, S. Chandran, ed., Heidelberg: Springer-Verlag, pp. 377–393.
6. W.C.Y. Lee. 1973. “Effects on correlation between two mobile radio basestation
antennas,” IEEE Transactions on Communications, Vol. 21, No. 11, 1214–1224.
7. S.C. Swales, “Spectrum efﬁcient cellular base station antenna architectures,”
Ph.D. Thesis, University of Bristol, U.K., 1990.
8. S.P. Stapleton, X. Carbo, and T. McKeen. 1994. “Tracking and diversity for a
mobile communications base station array antenna,” Proc. IEEE VTC,
pp. 1695–1699.
9. S.P. Stapleton, X. Carbo, and T.McKeen, 1994. “Spatial channel simulator for
phased arrays,” Proc. IEEE VTC, pp. 1789–1792.
10. D. Asztely. 1996. ”On antenna arrays in mobile communication systems: fast
fading and GSM base station receiver algorithm,” Ph.D. Dissertation, Royal
Institute of Technology, Stockholm, Sweden, March.
11. P. Petrus, J.H. Reed, and T.S. Rappaport. 1997. “Effects of directional antennas
at the base station on the Doppler spectrum,” IEEE Communications Letters,
Vol. 1, No. 2, March.
12. P. Petrus, J.H. Reed, and T.S. Rappaport. 1996. “Geometrically based statistical
channel model for macrocellular mobile environment,” IEEE GLOBECOM,
pp. 1197–1201.
13. J. Fuhl, A. Molisch, and E. Bonek. 1998. “Uniﬁed channel model for mobile
radio systems with smart antennas,” IEE Proc. — Radar, Sonar. Navig. Vol. 145,
No. 1, Feb., pp. 32–41.
14. J. Liberty and T. Rappaport. 1996. “A geometrically based model for line-of-
sight multipath radio channels,” IEEE VTC, pp. 844–848.
15. R.B. Ertel and J.H. Reed. 1999. “Angle and time of arrival statistics for circular
and elliptical scattering models,” IEEE Journal on Selected Areas in Communica-
tions, Vol. 17, Nov., pp. 1829–1840.
16. M. Lu, T. Lo, and J. Litva. 1997. “A physical spatio-temporal model of multipath
propagation channels,” IEEE VTC, pp. 180–184.
17. O. Norklit and J.B. Andersen. 1998. “Diffuse channel model and experimental
results for array antennas in mobile environments,” IEEE Transactions on An-
tennas and Propagation, Vol. 46, No. 6, June, pp. 834–840.
18. P. Zetterberg and B. Ottersten. 1994. “The spectrum efﬁciency of a basestation
antenna array system for spatially selective transmission,” IEEE VTC.
19. P. Zetterberg and P.L. Espensen. 1996. “A downlink beam steering technique
for GSM/DCS1800/PCS1900,” IEEE PIMRC, Taipei, Taiwan, October.
20. P. Mogensen, P. Zetterberg, H. Dam, P.L. Espensen, and F. Fredekirsen. 1997.
“Algorithms and antenna array recommendations — part 1,” ACTS TSUNAMI
deliverable, January.
21. B. Ottersten. 1995. “Spatial Division Multiple Access (SDMA) in wireless Com-
munications,” Proc. Nordic Radio Symp.
22. R.J. Piechocki and G.V. Tsoulos. 1999. “Combined GWSSUS and GBSR channel
model with temporal variations,” Joint COST259/260 Workshop, April, Vienna,
Austria.
23. R.J. Piechocki, J.P. McGeehan, and G.V. Tsoulos. 2001. “A new stochastic spatio-
temporal propagation model (SSTPM) for mobile communications with antenna
arrays,” IEEE Transactions on Communications, Vol. 49, No. 5, May, pp. 855–862.

Spatio-Temporal Propagation Modeling
25
24. R.J. Piechocki, G.V. Tsoulos, and J.P. McGeehan. 1998. “Simple general formula
for PDF of angle of arrival in large cell operational environment,” IEE Electronics
Letters, Vol. 34, September 3, pp. 1784–1785.
25. Q.H. Spencer, B.D. Jeffs, M.A. Jensen, and A.L. Swindlehurst. 2000. “Modeling
the statistical time and angle of arrival characteristics of an indoor multipath
channel,” IEEE Journal on Selected Areas in Communications, Vol. 18, No. 3, March,
pp. 347–360.
26. A.A. Saleh and R.A. Valenzuela. 1987.  “A statistical model for indoor multipath
propagation,” IEEE Journal on Selected Areas in Communications, Vol. SAC-5,
No. 2, Feb.
27. R. Janaswamy. 2002. “Angle and time of arrival statistics for the Gaussian
scatter density model,” IEEE Transactions on Wireless Communications, Vol. 1,
July, pp. 488–497.
28. M.P. Lotter and P. van Rooyen. 1999. “Modeling spatial aspects of cellular CDMA/
SDMA systems,” IEEE Communications Letters, Vol. 3, May, pp. 128–131.
29. K.I. Pedersen, P.E. Mogensen, and B.H. Fleury. 2000. “A stochastic model of
the temporal and azimuthal dispersion seen at the base station in outdoor
propagation environments,” IEEE Transactions on Vehicular Technology, Vol. 49,
No. 2, March, pp. 437–447.
30. S.A. Zekavat and C.R. Nassar. 2003. ”Power-azimuth-spectrum modeling for
antenna array systems: a geometric-based approach,” IEEE Transactions on An-
tennas and Propagation, Vol. 51, No. 12, Dec., pp. 3292–3294.
31. S.A. Zekavat and C.R. Nassar. 2002. “Smart antenna arrays with oscillating
beam patterns: characterization of transmit diversity using semi-elliptic-cover-
age geometric-based stochastic channel model,” IEEE Transactions on Commu-
nications, Vol. 50, Oct., pp. 1549–1556.
32. A. Algans, K.I. Pedersen, and P.E. Mogensen. 2002. “Experimental analysis of the
joint statistical properties of azimuth spread, delay spread, and shadow fading,”
IEEE Journal on Selected Areas in Communications, Vol. 20, No. 3, April, pp. 523–531.
33. C.A. Balanis. 1989. Advanced Engineering Electromagnetics, New York: John
Wiley & Sons.
34. J.B. Keller. 1962. “Geometrical Theory of Diffraction,” Journal of the Optical
Society of America, Vol. 52, Feb., pp. 116–130.
35. R.G. Kouyoumjian and P.H. Pathak. 1974. “A uniform geometric theory of
diffraction for an edge on a perfectly conducting surface,” IEEE Proceedings,
Vol. 62, No. 11, Nov., pp. 1448–1461.
36. R.J. Luebbers. 1984. “Finite conductivity uniform GTD versus knife edge dif-
fraction in prediction of propagation path loss,” IEEE Trans. on Antennas &
Propagation, Vol. AP-32, No. 1, Jan., pp. 70–76.
37. H. Bach. 1977. Modern Topics in Electromagnetics and Antennas, London: Peter
Peregrinus Ltd., Chap. 5.
38. G.L. Turin, et al. 1972. “A statistical model for urban multipath propagation,”
IEEE Transactions on Vehicular Technology, Vol. VT-21, Feb., pp. 1–9.
39. R.A. Valenzuela. 1993. “A ray tracing approach to predicting indoor wireless
transmission,” IEEE VTC ’93, New Jersey, May 18–20, pp. 214–218.
40. G.E. Athanasiadou, A.R. Nix, and J.P. McGeehan. 2000. ”A microcellular ray-
tracing propagation model and evaluation of its narrowband and wideband
predictions,” IEEE Journal on Selected Areas in Communications, Wireless Commu-
nications Series, Vol. 18, No. 3, March, pp. 322–335.

26
MIMO System Technology for Wireless Communications
41. S.Y. Seidel and T.S. Rappaport. 1994. “Site-speciﬁc propagation prediction for
wireless in-building personal communications system design,” IEEE Transac-
tions on Vehicular Technology, Vol. 43, No. 4, Nov., pp. 1058–1066.
42. K.R. Schaubach and N.J. Davis IV. 1994. “Microcellular radio-channel propa-
gation prediction,” IEEE Antennas and Propagation Magazine, Aug., pp. 25–34.
43. G.E. Athanasiadou and A.R. Nix. 2000. “A novel 3D indoor ray-tracing prop-
agation model: the path generator and evaluation of narrowband and wide-
band predictions,” IEEE Transactions on Vehicular Technology, Vol. 49, No. 4, July,
pp. 1152–1168.
44. G.E. Athanasiadou, I.J. Wassell, and C.L. Hong. 2004. “Deterministic propaga-
tion modeling and measurements for the broadband ﬁxed wireless access chan-
nel,” IEEE VTCF 2004, Los Angeles, Sept 26–29.
45. G.E. Athanasiadou and I.J. Wassell. 2005. “Comparisons of ray tracing predic-
tions and ﬁeld trial results for broadband ﬁxed wireless access scenarios,”
WSEAS Transactions on Communications, Issue 8, Vol. 4, Aug., pp. 717–721.
46. G.V. Tsoulos, G.E. Athanasiadou, and M.A. Beach. 1998. “Adaptive antennas
for microcellular and mixed cell environments with DS-CDMA.” Wireless Per-
sonal Communications Journal, Special Issue on CDMA for Universal Personal
Communications Systems, Kluwer Academic Publishers, Vol. 7, No. 2/3, Aug.,
pp. 147–169. 
47. G.V. Tsoulos and G.E. Athanasiadou. 2002. “On the application of adaptive
antennas to microcellular environments: radio channel characteristics and sys-
tem performance,” IEEE Transactions on Vehicular Technology, Vol. 51, No. 1, Jan.,
pp. 1–16.
48. H. Xu, V. Kukshya, and T.S. Rappaport. 2002. “Spatial and temporal character-
istics of 60GHz indoor channels,” IEEE Journal on Selected Areas in Communica-
tions, Vol. 20, No. 3, April, pp. 620–630.
49. T. Zwick, C. Fischer, D. Didascalou, and W. Wiesbeck. 2000. “A stochastic
spatial channel model based on wave-propagation modeling,” IEEE Journal on
Selected Areas in Communications, Vol. 18, No. 1, Jan., pp. 6–15.
50. M. Marques and L. Correia. 2001. “A wideband directional channel model for
UMTS microcells,” IEEE PIMRC, pp. B-122–B-126.
51. C. Oestges, V. Erceg, and A. Paulraj. 2003. “A physical scattering model for
MIMO macrocellular broadband wireless channels,” IEEE Journal on Selected
Areas in Communications, Vol. 21, No. 5, June, pp. 721–729.
52. C. Oestges, V. Erceg, and A. Paulraj. 2004. “Propagation modeling of MIMO
multipolarized ﬁxed wireless channels,” IEEE Transactions on Vehicular Technol-
ogy, Vol. 53, No. 3, May, pp. 644–654.
53. A. Molisch. 2002. “A generic model for MIMO wireless propagation channels,”
IEEE ICC, pp. 277–282.
54. M. Steinbauer, A. Molisch, and E. Bonek. 2001. “The double-directional channel
model,” IEEE Antennas and Propagation Magazine, Vol. 43, No. 4, pp. 51–63.
55. K. Kalliola, H. Laitinen, P. Vainikainen, M. Toeltsch, J. Laurila, and E. Bonek.
2003. “3-D double-directional radio channel characterization for urban macro-
cellular applications,” IEEE Transactions on Antennas and Propagation, Vol. 51,
No. 11, Nov., pp. 3122–3133.
56. K.I. Pedersen, J.B. Andersen, J.P. Kermoal, and P. Mogensen. 2000. “A stochastic
multiple-input-multiple-output radio channel model for evaluation of space-
time coding algorithms,” IEEE VTC, Fall, pp. 893–897.

Spatio-Temporal Propagation Modeling
27
57. K. Yu, M. Bengtsson, B. Ottersten, D. McNamara, P. Karlsson, and M. Beach.
2001. “Second order statistics of NLOS indoor MIMO channels based on
5.2GHz measurements,” IEEE Globecom 2001, Vol. 1, Nov., pp. 156–160.
58. K. Yu, M. Bengtsson, B. Ottersten, D. McNamara, P. Karlsson, and M. Beach.
2002. “A wideband statistical model for NLOS indoor MIMO channels,” IEEE
VTC, Spring, Vol. 1, pp. 370–374.
59. D.-S. Shiu, G.J. Foschini, M.J. Gans, and J.M. Kahn. 2000. “Fading correlation
and its effect on the capacity of multielement antenna systems,” IEEE Transac-
tions on Communications, Vol. 48, No. 3, pp. 502–513.
60. D.-S. Shiu. 2000. Wireless Communications Using Dual Antenna Arrays, Norwell,
MA: Kluwer Academic Publishers.
61. A. Abdi and M. Kaveh. 2002. “A space-time correlation model for multielement
antenna systems in mobile fading channels,” IEEE Journal on Selected Areas in
Communications, Vol. 20, No. 3, pp. 550–560.
62. D. Gesbert, H. Bolcskei, D. Gore, and A. Paulraj. 2000. “MIMO wireless chan-
nels: capacity and performance,” Global Telecommunications Conference, Vol. 2,
Nov., pp. 1083–1088.
63. 3rd Generation Partnership Project, Technical Speciﬁcation Group Radio Access
Network. Spatial channel model for Multiple Input Multiple Output (MIMO) sim-
ulations, 3GPP TR 25.996 V6.1.0 (2003-09) Technical Report.


29
2
Theory and Practice of MIMO Wireless 
Communication Systems
Dimitra Zarbouti, George Tsoulos, and Dimitra Kaklamani
CONTENTS
Summary ................................................................................................................30
2.1
Shannon’s Capacity Formula.....................................................................30
2.2
Extended Capacity Formula for MIMO Channels.................................31
2.2.1
General Capacity Formula.............................................................31
2.2.2
Transformation of the MIMO Channel into n SISO 
Subchannels......................................................................................32
2.2.3
No CSI at the Transmitter..............................................................34
2.2.4
CSI at the Transmitter.....................................................................35
2.2.5
Channel Estimation at the Transmitter........................................35
2.3
Remarks on the Extended Shannon Capacity Formula........................36
2.3.1
Bounds on MIMO Capacity ..........................................................36
2.3.2
Capacity of Orthogonal Channels................................................38
2.3.3
Effective Degrees of Freedom .......................................................38
2.4
Capacity of SIMO — MISO Channels......................................................39
2.5
Stochastic Channels.....................................................................................40
2.5.1
Ergodic Capacity .............................................................................40
2.5.2
Outage Capacity..............................................................................41
2.6
MIMO Capacity with Rice and Rayleigh Channels ..............................41
2.6.1
MIMO Channel Matrix for Rayleigh Propagation 
Conditions ........................................................................................42
2.6.2
MIMO Channel Matrix for Ricean Propagation Conditions ...43
2.6.3
Channel Matrix with Spatial Fading Correlation......................45
2.7
Simulations ...................................................................................................47
2.7.1
MIMO Capacity for a Rayleigh Channel without Spatial 
Fading Correlation ..........................................................................48
2.7.2
MIMO Capacity for a Rayleigh Channel with Spatial 
Fading Correlation ..........................................................................49
2.7.3
MIMO Capacity for a Ricean Channel........................................50

30
MIMO System Technology for Wireless Communications
Appendix 2A .........................................................................................................51
Appendix 2B..........................................................................................................52
Appendix 2C..........................................................................................................53
References...............................................................................................................54
Summary
This chapter introduces the principles of MIMO systems employing the
necessary mathematical analysis to consider the achieved capacity perfor-
mance. In this context, ﬂat fading across time and frequency is considered,
and the Rayleigh model is employed for describing the wireless channel.
Furthermore, the case of spatial selective fading is examined by considering
LOS propagation, with the Ricean model.
The mathematical representation of the MIMO system is performed
through a complex matrix, which depends on the scenario considered each
time (i.e., ﬂat or selective spatial fading). The capacity achieved by the MIMO
channel in all the above cases is studied with the use of the Shannon extended
capacity formula. The capacity performance results, developed from the
simulations performed, are related to the number of the multiple antenna
elements that the Rx and the Tx are equipped with, the distance between
them and the degree of correlation evidenced.
2.1
Shannon’s Capacity Formula
Shannon’s capacity formula approximated theoretically the maximum
achievable transmission rate for a given channel with bandwidth B, trans-
mitted signal power P and single side noise spectrum No, based on the
assumption that the channel is white Gaussian (i.e., fading and interference
effects are not considered explicitly).
(2.1)
In practice, this is considered to be a SISO scenario (single input, single
output) and Equation 2.1 gives an upper limit for the achieved error-free
SISO transmission rate. If the transmission rate is less than C bits/sec (bps),
then an appropriate coding scheme exists that could lead to reliable and
error-free transmission. On the contrary, if the transmission rate is more than
C bps, then the received signal, regardless of the robustness of the employed
code, will involve bit errors.
C
B
P
N B
o
=

+
©
«ª
¹
»º
log2 1

Theory and Practice of MIMO Wireless Communication Systems
31
2.2
Extended Capacity Formula for MIMO Channels
For the case of multiple antennas at both the receiver and the transmitter
ends (Figure 2.1), the channel exhibits multiple inputs and multiple outputs
and its capacity can be estimated by the extended Shannon’s capacity for-
mula, as described below.
2.2.1
General Capacity Formula
We consider an antenna array with nt elements at the transmitter and an
antenna array with nr elements at the receiver. The impulse response of the
channel between the jth transmitter element and the ith receiver element is
denoted as hi,j(Y,t). The MIMO channel can then be described by the nr × nt
H(Y,t) matrix:
(2.2)
The matrix elements are complex numbers that correspond to the attenu-
ation and phase shift that the wireless channel introduces to the signal
reaching the receiver with delay Y. The input-output notation of the MIMO
system can now be expressed by the following equation:
(2.3)
where
denotes convolution, s(t) is a nt × 1 vector corresponding to the nt
transmitted signals, y(t) is a nr × 1 vector corresponding to the nr received
signals and u(t) is the additive white noise.
FIGURE 2.1
The MIMO channel.
Channel 
H
Tx
nt
nr
Rx
H( , )
( , )
( , )
( , )
( ,
,
,
,
,
Y
Y
Y
Y
Y
t
h
t
h
t
h
t
h
nt
=
1 1
1 2
1
2 1

t
h
t
h
t
h
t
h
n
n
n
t
r
r
)
( , )
( , )
( , )
(
,
,
,
,
2 2
2
1
2
Y
Y
Y





Y
Y
, )
( , )
,
t
h
t
M
n
R
t

¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
y
H
s
u
( )
( , )
( )
( )
t
t
t
t
=

+
Y


32
MIMO System Technology for Wireless Communications
If we assume that the transmitted signal bandwidth is narrow enough that
the channel response can be treated as ﬂat across frequency, then the discrete-
time description corresponding to Equation 2.3 is
(2.4)
The capacity of a MIMO channel was proved in [1, 4] that can be estimated
by the following equation:
(2.5)
where H is the nr × nt channel matrix,
is the covariance matrix of the
transmitted vector s, HH is the transpose conjugate of the H matrix and p is
the maximum normalized transmit power. Equation 2.5 is the result of
extended theoretical calculations, and its practical use is not obvious. Never-
theless, we can perform linear transformations at both the transmitter and
receiver converting the MIMO channel to
SISO subchannels
(given that the channel is linear) and, hence, reach more insightful results.
These transformations can be found in [1] and are brieﬂy described in the
following section.
2.2.2
Transformation of the MIMO Channel into n SISO Subchannels
Every matrix
can be decomposed accordingly to its singular val-
ues. Suppose that for the aforementioned channel matrix this transformation
is given by Equation 2.6.
(2.6)
where the matrices U, V are unitaries of dimensions nr × nr and nt × nt
accordingly, while D is a non-negative diagonal matrix of dimensions nr × nt.
The diagonal elements of matrix D are the singular values of the channel
matrix H. The algorithm of singular value decomposition that provides the
above transformation can be found in [2].
The operations that lead to the linear transformation of the channel into
n = min(nr, nt) SISO subchannels are described as follows: First, the trans-
mitter multiplies the signal to be transmitted xY with the matrix V, the receiver
multiplies the received signal rY and noise with the conjugate transpose of
the matrix U. The above are presented in Equation 2.7 through Equation 2.9.
(2.7)
r
Hs
u
Y
Y
Y
=
+
C
tr
p
ss
H
ss
=
+
(
)
¬
®
¼
¾
f
max log
det
(
)
R
I
HR H
2
Rss
n
n
n
r
t
= min(
,
)
H 
×
n
n
r
t
H
UDV
=
H
s
V x
Y
Y
=


Theory and Practice of MIMO Wireless Communication Systems
33
(2.8)
(2.9)
Substituting Equation 2.4 into Equation 2.8 gives:
Since U and V are unitary matrices, they satisfy
,
and
hence:
(2.10)
Each component of the received vector yY can be written as:
(2.11)
where Jk are the singular values of matrix H according to the transformation
that took place above. Equation 2.11 implies that the initial (nr, nt) MIMO
system has been transformed into n = min(nr, nt) SISO subchannels, as illus-
trated in Figure 2.2.
The above analysis of a Multiple Antenna Element (MEA) system capacity
is presented in [1]. It was proven in [1] that the total capacity of n SISO
FIGURE 2.2
Conversion of the MIMO channel into n SISO subchannels.
y
U
r
Y
Y
=

H
n
U
u
Y
Y
=

H
y
U
r
y
U Hs
U u
y
U HVx
Y
Y
Y
Y
Y
Y
Y
=

¡
=
+
¡
=
H
H
H
H
( . ),( . )
2 7
2 9
+
¡
=
+
n
y
U UDV Vx
n
Y
Y
Y
Y
( . )
2 6
H
H
U U
I
H
nr
=
V V
I
H
nt
=
y
Dx
n
Y
Y
Y
=
+
y
x
n
Y
Y
Y
J
k
k
k
k
=
+
Tx
1
2
n = min(nr,nt)
nt
Rx
nr

34
MIMO System Technology for Wireless Communications
subchannels is the sum of the individual capacities and as a result the total
MIMO capacity is:
(2.12)
where pk is the power allocated to the kth subchannel and
is its power
gain. We notice that according to the singular value decomposition algorithm
J2
k, k = 1, 2, …, n are the eigenvalues of the HHH matrix, which are always
non-negative. Furthermore, regardless of the power allocation algorithm
used, pk must satisfy
because of the wanted power constraint.
At this point, there are two cases of particular interest that need further
consideration: the knowledge (or not) by the transmitter of the Channel State
Information (CSI). These are described in the following sections.
2.2.3
No CSI at the Transmitter
Considering Equation 2.12, we notice that the achieved capacity depends on
the algorithm used for allocating power to each subchannel. The theoretical
analysis assumes the channel state known at the receiver. This assumption
stands correct since the receiver usually performs tracking methods in order
to obtain CSI, however the same consideration does not apply to the transmitter.
When the channel is not known at the transmitter, the transmitting signal
s is chosen to be statistically non-preferential, which implies that the nt
components of the transmitted signal are independent and equi-powered at
the transmit antennas. Hence, the power allocated to each of the nt subchan-
nels is pk = p/nt. Applying the last expression to Equation 2.5 gives:
(2.13)
or
(2.14)
Equation 2.14 can be produced from Equation 2.13 as described in greater
detail in Appendix 2A.
C
pk
k
k
n
=
+
(
)
=¨log2
2
1
1
J
Jk
2
p
p
k
k
n
=¨
f
1
C
p
nt
H
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½
log
det
2
I
HH
C
p
nt
k
k
n
=
+
©
«ª
¹
»º
=¨log2
2
1
1
J

Theory and Practice of MIMO Wireless Communication Systems
35
2.2.4
CSI at the Transmitter
In cases in which the transmitter has knowledge of the channel, it can
perform optimum combining methods during the power allocation process.
In that way, the SISO subchannel that contributes to the information transfer
the most is supplied with more power.
One method to calculate the optimum power allocation to the n subchan-
nels is to employ the waterpouring algorithm (a detailed discussion of this
algorithm can be found in [3]).
Considering the assumption of CSI at the transmitter, we can proceed to
the following capacity formula.
(2.15)
The difference between Equation 2.14 and Equation 2.15 is the coefﬁcient
Lk that corresponds to the amount of power that is assigned to the kth
subchannel. This coefﬁcient is given by:
(2.16)
and satisﬁes the constraint
.
The goal with the waterpouring algorithm is to ﬁnd the optimum Lk that
maximizes the capacity given in Equation 2.15.
2.2.5
Channel Estimation at the Transmitter 
As mentioned earlier, the CSI is not usually available at the transmitter. In
order for the transmitter to obtain the CSI, two basic methods are used: the
ﬁrst is based on feedback and the second on the reciprocity principle.
In the ﬁrst method the forward channel is calculated by the receiver and
information is sent back to the transmitter through the reverse channel. This
method does not function properly if the channel is changing fast. In that
case, in order for the transmitter to get the right CSI, more frequent estima-
tion and feedback are needed. As a result, the overhead for the reverse
channel becomes prohibitive. According to the reciprocity principle, the
forward and reverse channels are identical when the time, frequency and
antenna locations are the same. Based on this principle the transmitter may
use the CSI obtained by the reverse link for the forward link. The main
C
p
n
k
t
k
k
n
=
+

©
«ª
¹
»º
=¨log2
2
1
1
L
J
L k
k
E s
= {
}
2
L k
k
n
tn
=
¨
=
1

36
MIMO System Technology for Wireless Communications
problem with this method emerges when frequency duplex schemes are
employed.
2.3
Remarks on the Extended Shannon Capacity Formula
In this section we will use mathematical tools in order to derive the theoretical
upper and lower bounds of MIMO capacity. The algebraic expressions used,
as well as the assumptions considered here, are summarized in Section 2.3.1.
In Section 2.3.3 we introduce the Effective Degrees of Freedom (EDoF),
which we will use for the simulation justiﬁcation in Section 2.7.
2.3.1
Bounds on MIMO Capacity
The lower and upper bounds of MIMO capacity were ﬁrst derived in [1].
We proceed with a short description of those bounds. Four basic assumptions
are considered in the following, summarized here for simplicity.
•
The transmitter has no previous knowledge of the channel.
•
The parallel subchannels produced by the decomposition of the
MIMO channel are independent.
•
The wireless channel is submitted to Rayleigh fading.
•
The transmitter antenna array elements are less than the receiver’s
antenna elements (nt < nr).
In addition, we cite four mathematical expressions that will be used for
deriving the wanted capacity bounds.
(2.17)
where matrices D and R are diagonal and upper-triangular, respectively.
(2.18)
(2.19)
where A, B are square matrices and Q is a unitary matrix.
det
,
,
DD
RR
D
R
H
H
+
(
) v
+
(
)

ℓℓ
ℓℓ
ℓ
2
2
det
det
I
AB
I
BA
+
(
) =
+
(
)
det
det
I
QAQ
I
A
+
(
) =
+
(
)
H

Theory and Practice of MIMO Wireless Communication Systems
37
(2.20)
where X is a non-negative deﬁnite matrix.
Since the channel is submitted to Rayleigh fading, the channel matrix H
is given by HW, which is referred to as spatially white matrix. The elements
of HW can be modeled as zero mean circularly symmetric complex Gaussian
(ZMCSCG) random variables. The HW has particular statistical properties
that can be found in [3, 12].
We consider the transformation HW = QR, where Q is a unitary and R is
an upper-triangular matrix. This tranformation is referred to as Householder
Transformation [5]. According to this transformation the elements of R above
the main diagonal are statistically independent, while the magnitude of the
main diagonal entries are chi-squared distributed with 2nr, 2(nr – 2 + 1), …,
2(nr – nt + 1) degrees of freedom.
Using Equation 2.13:
(2.21)
Equation 2.21 corresponds to the lower capacity bound and practically
shows that this bound is deﬁned by the sum of the capacities of nt indepen-
dent subchannels with power gains that follow the chi-square distribution
with 2nr, 2nr – 2, …, 2(nr – nt + 1) degrees of freedom.
In order to ﬁnd the upper bound of the capacity, Equation 2.13 is used
again:
(2.22)
The upper bound of the capacity is the sum of the capacities of nt inde-
pendent subchannels, with power gains chi-squared distributed and with
degrees of freedom 2(nr + nt – 1), 2(nr + nt – 3), …, 2(nr – nt + 1). The difference
of the mean values of the upper and lower bounds is less than 1b/s/Hz.
det
,
X
X
( ) f
ℓℓ
ℓ
C
p
n
p
n
t
H
t
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½ =
+
log
det
log
det
2
2
I
HH
I
QRR Q
I
RR
H
H
t
H
C
p
n
©
«ª
¹
»º
¬
®
­
¼
¾
½ ¡
=
+
©
( .
)
log
det
2 19
2
«ª
¹
»º
¬
®
­
¼
¾
½ v
+
©
«ª
¹
»º
¬
®
( .
)
,
log
2 17
2
2
1
p
n R
t
ℓℓ
ℓ
­
­
¼
¾
½
½
¡
C
p
n R
t
nt
v
+
©
«ª
¹
»º
=¨log
,
2
2
1
1
ℓℓ
ℓ
C
p
n
R
R
t
m
m
nt
f
+
+
©
«
ªª
¹
»
ºº
©
«
ª
ª
¹
= +¨
log
,
,
2
2
2
1
1
ℓℓ
ℓ
ℓ
»
º
º
=¨
ℓ1
nt

38
MIMO System Technology for Wireless Communications
2.3.2
Capacity of Orthogonal Channels
It is interesting to study the case where the capacity of the MIMO channel
is maximized. We consider the simple case of nr = nt = n, along with a ﬁxed
total power transfer through the SISO subchannels (i.e.,
, where a
is a constant). The capacity in Equation 2.14 is concave in the variables J2
k (k
= 1, 2, …, n) and, as a result, it is maximized when J2
k = J2
i = a/n, (k, i = 1, 2,
…, n). The last equation reveals that the HHH matrix has n equal eigenvalues.
Hence, H must be an orthogoal matrix, i.e.,
. Substitut-
ing
into Equation 2.13:
(2.23)
If
, the matrix H satisﬁes
, hence, Equation 2.13 becomes:
(2.24)
The last equation indicates that the capacity of an orthogonal MIMO channel
is n times the capacity of the SISO channel.
2.3.3
Effective Degrees of Freedom
Based on Equation 2.14, we can assume that in high SNR regime, capacity
can increase linearly with n. Speciﬁcally, for high SNR regime
Equation 2.14 becomes:
(2.25)
However, this assumption is not always conﬁrmed. For some subchannels
is much smaller than one, and as a result the information transferred
by these channels is nearly zero. This phenomenon is present in at least three
cases:
•
when the transmission is serviced through a low-powered device
•
when there is a long-range communication application
•
when there is strong fading correlation between subchannels
In the last case, the fading induced to a certain subchannel may cause the
minimization of its corresponding J2
k.
¨ =
=
k
n
k
a
1
2J
HH
H H
I
H
H
n
a n
=
= (
)
/
HH
I
H
n
a n
= (
)
/
C
pa
n
C
n
pa
n
n
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½ ¡
=

+
log
det
log
2
2
2 1
I
I
2
©
«ª
¹
»º
Hi j,
2
1
=
HH
I
H
n
n
=
C
p
n n
C
n
p
n
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½ ¡
=

+
(
)
log
det
log
2
2 1
I
I
(
)
Jkp n
2
1
/
≫
C
p
n
k
k
n
~
©
«ª
¹
»º
=¨log2
2
1
J
(
)
Jkp n
2 /

Theory and Practice of MIMO Wireless Communication Systems
39
In practice, the aforementioned cases are very likely to happen, therefore,
the concept of EDoF is introduced. Intuitively, the EDoF value corresponds
to the number of subchannels that actually contribute to the information
transfer. In a more mathematical approach, the EDoF value indicates the
non-zero singular values of the channel matrix H. A more detailed descrip-
tion of the EDoF can be found in [1].
2.4
Capacity of SIMO — MISO Channels
Single input, multiple output (SIMO) and multiple input, single output
(MISO) channels are special cases of MIMO channels. In this paragraph we
discuss the capacity formulas for the case of SIMO and MISO channels.
For a SIMO channel nt = 1, so
; hence, the CSI at the
transmitter does not affect the SIMO channel capacity:
(2.26)
If we consider
then
 (the proof can be found in Appendix 2B).
Hence Equation 2.26 becomes:
(2.27)
For a MISO channel nr = 1 and
. With no CSI at the
transmitter, the capacity formula can be expressed as:
(2.28)
If we make the same assumption as earlier and consider that
then
 (the proof is cited in Appendix 2B); hence, Equation 2.28 becomes:
(2.29)
Comparing Equation 2.29 and Equation 2.27 we can see that CSIMO > CMISO.
This is because the transmitter, as opposed to the receiver, cannot exploit
the antenna array gain since it has no CSI and, as a result, cannot retrieve the
receiver’s direction.
n
n
n
r
t
=
=
min(
,
)
1
C
p
SIMO =
+

(
)
log2
1
2
1
J
hi
2
1
=
J1
2 = nr
C
p n
SIMO
r
=
+

(
)
log2 1
n
n
n
r
t
=
=
min(
,
)
1
C
p
n
MISO
t
=
+

©
«ª
¹
»º
log2
1
2
1
J
hi
2
1
=
J1
2 = nt
C
p
MISO =
+
(
)
log2 1

40
MIMO System Technology for Wireless Communications
2.5
Stochastic Channels
In order to use the aforementioned capacity formulas, it is necessary to obtain
the channel matrix expression. There are many spatial channel models that
are used for this purpose ([6–11]). 
The simulations that take place in Section 2.7 consider a stochastic channel
approach. Speciﬁcally, the Rayleigh and the Rice models are used. The
description of these models is cited below. Consequently, under the stochas-
tic channel consideration, the capacity achieved becomes a random variable,
and in order to study its behavior, we use stochastic quantities, as described
below.
2.5.1
Ergodic Capacity
The ergodic capacity of a MIMO channel is the ensemble average of the
information rate over the distribution of the elements of the channel matrix
H [3], and it is given by:
(2.30)
When there is no CSI at the transmitter, we can substitute Equation 2.13
into Equation 2.30, so the ergodic capacity is given by
(2.31)
Whereas with CSI at the transmitter we use Equation 2.15, and the ergodic
capacity is given by:
(2.32)
Figure 2.3 illustrates the ergodic capacity for different antenna conﬁgurations
as a function of the SNR, when the channel is unknown at the transmitter.
As expected, the ergodic capacity increases with SNR. In addition, the
ergodic capacity of a SIMO channel appears to be greater than the ergodic
capacity of a MISO channel. The reason for this behavior, as previously
explained, lies in the fact that the transmitter cannot exploit the antenna
array gain since it has no CSI.
C
E I
= { }
C
E
p
nt
H
=
+
©
«ª
¹
»º
©
«ª
¹
»º
¯
°²
±²
¿
À²
Á²
log
det
2
I
HH
C
E
p
nt
k
k
k
n
=
+
©
«ª
¹
»º
¯
°²
±²
¿
À²
Á²
=¨log2
2
1
I
L J

Theory and Practice of MIMO Wireless Communication Systems
41
2.5.2
Outage Capacity
The outage capacity quantiﬁes the level of capacity performance guaranteed
with a certain level of reliability [3, 12]. For q% outage capacity Cout,q, indicates
the maximum capacity level the system can achieve with probability
(100 – q)%. For stochastic channels we can observe that there is always a
possibility of outage for a given MIMO system realization, regardless of the
wanted rate. Hence, there is a tradeoff between the system’s outage capacity
and the achieved information rate.
2.6
MIMO Capacity with Rice and Rayleigh Channels
In this section we discuss the capacity expressions for the cases of Rayleigh
and Ricean channels, as well as when spatial fading correlation is induced
to the signal due to the limited distance between the array elements (the trans-
mitter is considered blind for the discussion below, i.e., does not have CSI).
When the wireless environment is characterized by strong multipath activ-
ity, then the number of paths between the transmitter and receiver allows
the use of the central limit theorem [13] and the envelope of the received
signal follows the Rayleigh distribution. However, in cases that the location
FIGURE 2.3
Ergodic capacity as a function of SNR and number of elements.
50
45
40
35
30
25
20
15
Ergodic capacity 
10
5
05 
10 
15 
SNR(dB)
20 
25 
(4, 4)
Rayleigh channel, ergobic capacity as function of  SNR
(2, 2) 
(1, 4) 
(2, 4)
(4, 4) 
(1, 1) 

42
MIMO System Technology for Wireless Communications
of buildings leads to the street waveguide propagation phenomenon, and
in areas near the base station where a line of sight (LOS) component may
dominate, the Ricean distribution is more suitable. The receiver in that sce-
nario “sees” a dominant signal component along with lower power compo-
nents caused by multipath. The dominant component that reaches the
receiver may not be the result of LOS propagation, e.g., the dominant com-
ponent may be the mean value of strong multipaths caused by large scatter-
ers. The Ricean K-factor of the channel is deﬁned as the ratio of the powers
of the dominant and the fading components [13].
(2.33)
Obviously, K = 0 indicates a Rayleigh fading channel while K q h indicates
a non-fading one.
2.6.1
MIMO Channel Matrix for Rayleigh Propagation Conditions
The channel matrix H in Equation 2.31 depends on the channel model.
Speciﬁcally, in cases where the wireless channel is submitted to Rayleigh
fading and the array antennas do not introduce additional correlation to the
transmitted/received signal, the channel matrix becomes spatially white.
The ergodic capacity formula under the assumption of Rayleigh channels
and equal power allocation is (following the analysis in Section 2.5.1):
(2.34)
Equation 2.34 is used for the simulations concerning the Rayleigh channel
that will be shown in the next section.
Under the assumption of
, it would be interesting to study the
case of n q h [3]. Using the strong law of large numbers [14] we get:
(2.35)
Therefore, the Rayleigh channel capacity bound is given by:
 when n q h
(2.36)
K
A
=
2
2
2X
C
E
p
nt
H
=
+
©
«ª
¹
»º
©
«ª
¹
»º
¯
°²
±²
¿
À²
Á²
log
det
2
I
H H
W
W
n
n
n
r
t
=
=
1
n
as n
H
n
H
H
I
W
W
(
)
q
q h
C
p
p
n
n
n
n
n
q
+
(
)
¬®
¼¾ =
+
(
)
¬
®­
¼
¾½ =
qh
log
det
log
2
2
1
I
I

+
(
) ¡
log2 1
p
C
n
p
q

+
(
)
log2 1

Theory and Practice of MIMO Wireless Communication Systems
43
Considering the last expression, two things can be noticed:
•
Capacity does not depend on the nature of the channel matrix, as it
increases linearly with n for a ﬁxed SNR.
•
Every 3 dB increase of SNR corresponds to an n bits/sec/Hz increase
in capacity.
2.6.2
MIMO Channel Matrix for Ricean Propagation Conditions
In the presence of a dominant component between the transmitter and the
receiver, the wireless channel can be modeled as the sum of a constant and
a variable component caused by scattering [3, 15].
(2.37)
In Equation 2.37 HRice is the MIMO channel matrix, HRayleigh is the MIMO
matrix corresponding to the variable component, HLOS is the MIMO matrix
corresponding to the constant signal component, K is the Ricean–K factor
and K0 is the phase shift of the signal when propagating from a transmitting
antenna element to the corresponding receiving antenna element.
The HRayleigh matrix is spatially white, and its structure was described
earlier in this chapter. HLOS can be derived by the procedure described in
the following (for more details see [15]).
The general conﬁguration of a multiple transmitting and receiving antenna
array is illustrated in Figure 2.4.
In Figure 2.4, R is the distance between the transmitter and the receiver
and d is the interelement distance. The matrix HLOS is given by:
(2.38)
FIGURE 2.4
Geometry of a Tx and an Rx linear antenna array.
Tx 
Rx 
R
R’
d
d
H
H
H
Rice
LOS
Rayleigh
=
+
+
+
K
K
e
K
j
1
1
1
0
K
HLOS =




1
1
1
1
e
e
e
e
e
e
j
j n
j
j
j n
t
r
V
V
V
V
V






(
)
(
)


¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
j nr
(
)
2
1
V


44
MIMO System Technology for Wireless Communications
where V is the angle corresponding to phase shift between the neighbor array
elements.
In order to simplify the analysis, the distance between the receiving and
the transmitting antennas is assumed substantially larger than the distance
between the antenna elements. So, under the assumption of
, V is
minimized to the point that it can be omitted from the matrix in Equation
2.38 (see Appendix 2C for the proof). In that case HLOS is given by an nr × nt
matrix, with ones as elements (we refer to this matrix as H(1)).
Also, it is obvious that K0 affects the contribution of HLOS to HRice. For reasons
of simplicity it is assumed that
K0 = U/4, so ejK0 =
As a result, the real and the imaginary parts of the HRice elements are inﬂu-
enced in the same manner. After some manipulation, Equation 2.37 becomes:
(2.39)
Equation 2.39 is used to produce the simulation results shown in the next
section.
The assumptions made regarding the Ricean channel analysis can be sum-
marized as follows:
•
The dominant component is considered to be caused by LOS prop-
agation.
•
The distance between the transmitter and the receiver is considered
substantially larger than the interelement distance.
Although these assumptions might not always be valid, the results indicate
the effect of the dominant component on the MIMO system capacity, gener-
ally. In cases that the dominant signal component is caused by directional
multipath propagation, this component is time varying, and hence, the above
analysis cannot be applied.
However, the case
can be found in multibase operations [3]. In these
scenarios the transmit/receive antenna elements are cited in different base
stations. The matrix that describes the constant component of the Ricean
channel, in that case, is orthogonal. In Figure 2.5 is illustrated the ergodic
capacity of a Ricean channel when the HLOS is orthogonal and when HLOS =
H(1).
Apparently, Figure 2.5 shows that the form of the HLOS matrix, which
represents the ﬁxed channel component, inﬂuences the capacity for large
values of K-factor. Speciﬁcally, the channel with the orthogonal HLOS outper-
forms the channel with the degenerate HLOS for increasing K.
R
d
≫
1
2
1
2
+ j
H
H
H
Rice
1
2
+j 1
2
1
=
+
©
«ª
¹
»º
( )+
+
K
K
K
w
1
1
1
R
d
≪

Theory and Practice of MIMO Wireless Communication Systems
45
2.6.3
Channel Matrix with Spatial Fading Correlation
The Rayleigh channel assumes ﬂat fading in the space, time, and frequency
domains. However, the signal’s components arriving at the receiver may
experience correlation due to the limited distance of the antenna elements.
As a result, the use of HW as the channel matrix is inappropriate. In order
to include the correlation effect the following equation is used [1, 3]:
(2.40)
where vec(H), denotes a vector* made by the columns of H, and R is the
covariance matrix of the channel of dimension nrnt × nrnt.
(2.41)
The analysis can be simpliﬁed with the use of the channel matrix of Equation
2.42.
(2.42)
FIGURE 2.5
Ergodic capacity of a 2 × 2 Ricean channel when the HLOS is orthogonal, and HLOS = H(1).
* If H = [h1 h2 … hnt] is nr × nt then vec(H) = [h1
T h2
T…hT
nt] is nr nt × 1.
7.5
HLOS orthogonal-HLOS degenarated as a function of K
7
6.5
6
5.5
Ergodic capacity(bits/sec/Herz)
5
4.50 
2 
4 
6 
8 
10 
12 
K
16 
18 
14 
20 
Ones 
Orth 
vec
R
vec
H
H
( ) =
(
)
1
2
W
R
H
H
=
( )
( )
{
}
E vec
vec
H
H
R
H R
=
R
W
T
1
2
1
2

46
MIMO System Technology for Wireless Communications
where RR is the reception correlation matrix and RT is the transmission
correlation matrix. Equation 2.42 is derived by 2.40 under the assumption
that matrix RR and RT remain unchanged, regardless of the transmitting and
receiving elements, respectively.
The correlation matrices RT and RR are calculated using two different mod-
els. The ﬁrst (used for the simulations), calculates these matrices as a function
of the distance between the receiving and transmitting elements [16]. A short
description follows assuming that the RT, RR matrices have the form:
(2.43)
where r is the fading correlation between two adjacent antenna elements
and it is approximated by:
(2.44)
) is the angular spread and d is the distance in wavelengths between the
antenna elements (Figure 2.6). In order to simplify the procedure we can
make the following assumptions concerning the model:
FIGURE 2.6
The mean angle of arrival (O) and the angle spread ()) of an incoming multipath signal.
RT
T
T
T
n
t
T
T
T
T
T
r
r
r
r
r
r
r
r
r
r
t
=

1
1
1
4
1
4
4
2








(
)
T
n
T
T
R
R
R
t
r
r
r
r
(
)

¬
®
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
=
1
4
4
2
1
1

R








r
r
r
r
r
r
r
r
R
n
R
R
R
R
R
R
R
n
r
r
(
)
(
)


1
4
4
1
2
2
1
1

r
r
R
R
4
1
¬
®
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
r d
d
( ) ~



(
)
exp
23
2
2
)
d
2∆ 
ϕ 

Theory and Practice of MIMO Wireless Communication Systems
47
•
For very small r(d) the higher order terms of the above matrices can
be omitted. Hence, the correlation matrices take the form of triagonal
matrices.
•
Moreover, if the same interelement distance for both the transmitter
and the receiver is considered (dr = dr and rT = rR = r), we can use a
single parameter model that simpliﬁes the capacity calculations.
The ﬁnal form of the matrices used in simulations are:
(2.45)
The second model is described in [17], where the analysis from [18] is
adopted and calculates the correlation matrices via the following formula:
(2.46)
where J0 is the zero-order Bessel function of the ﬁrst kind,
, and Rik
is the signal correlation coefﬁcient between the ith and the kth antenna array
element.
For very small ) and O = 0 Equation 2.46 can be approximated by:
(2.47)
The largest value of ) that maintains the validity of Equation 2.47 is U/4.
2.7
Simulations
In this section we present simulation results for the three capacity cases
presented in Section 2.6. The Cumulative Distribution Function (CDF) of the
capacity is produced for the following scenarios:
•
Rayleigh channel without spatial fading correlation
•
Rice channel with the dominant component caused by LOS propa-
gation
RT
r
r
r
r
r
r
=
¬
®
­
­
­
­
­
­
¼
¾
½
½
½
½
½
1
0
0
1
0
1
0
0
0
1









½
=
¬
®
­
­
­
­
­
­
¼
¾
½
½
½
RR
r
r
r
r
r
r
1
0
0
1
0
1
0
0
0
1









½
½
½
R
J
z i
k
ik =

0[ (
)]
z
d
= 2U
Q
R
z i
k
z i
k
ik ~


sin( (
) )
(
)
)
)

48
MIMO System Technology for Wireless Communications
•
Rice channel with the dominant component caused by weak multipath
•
Rayleigh channel with spatial fading correlation
2.7.1
MIMO Capacity for a Rayleigh Channel without Spatial 
Fading Correlation
The capacity formula used for the simulations of this section is presented in
Equation 2.13. The channel matrix that it is used for capacity calculations is
HW. This matrix is full rank and its elements are independent variables that
follow a Gaussian distribution. As a result, the MIMO channel is transformed
into exactly
SISO subchannels.
Figure 2.7 indicates that increasing the number of antenna elements leads
to a capacity increase. Especially, we notice that the large capacity increase
involves array antennas at both the transmitter and the receiver. For example,
the (8,1) MIMO channel supports lower capacity gain than the (2,2) MIMO
channel. This is justiﬁed by the MIMO system transformation concept men-
tioned earlier. Speciﬁcally, the (8,1) channel gives n = 1 while (2,2) gives n = 2.
The result can be justiﬁed considering the fact that the independent SISO
subchannels that resulted from the MIMO system transformation are respon-
sible for the information transfer.
Also, Figure 2.7 indicates that the presence of an antenna array at the
receiver is more important than the presence of the same antenna array at
the transmitter. For example, we notice again that the channel (4,1) presents
FIGURE 2.7
MIMO capacity for a Rayleigh channel with different antenna array elements (SNR=10 dB).
n
rank
n
n
r
t
=
=
(
)
min(
,
)
HW
1
CDF-Rayleigh-SNR = 10
0.9
0.8
0.7
0.6
0.5
0.4
0.3
(1, 1) 
(1, 4) 
(4, 1) 
(1, 8) 
(8, 1) 
(2, 2) 
Prob(capacity < c)
0.2
0.1
00 
5 
10 
15 
c bits/sec/Hz 
20 
25 

Theory and Practice of MIMO Wireless Communication Systems
49
better capacity behavior than the channel (1,4). The explanation for this lies
in the assumption that the transmitter does not have CSI, and as a result it
“equi-powers” the elements regardless of the channel. On the contrary, the
receiver is considered to possess this information, and as a result it may use
its antenna array for optimum combining based on CSI.
2.7.2
MIMO Capacity for a Rayleigh Channel with Spatial 
Fading Correlation
In this case the channel matrix is given by Equation 2.42. Figure 2.8 illustrates
the capacity for different antenna conﬁgurations and interelement spacing
distances, d in wavelengths.
Figure 2.8 proves the great effect of correlation to the MIMO channel
capacity. We can easily notice that the uncorrelated channel* (d = 0.5 Q) offers
high capacity performance in comparison to rest cases. Speciﬁcally, the
ergodic capacity of the (4,4) uncorrelated channel is about 13 bits/sec/Hz
greater than the fully correlated one. So as the distance between the antenna
elements decreases, the capacity decreases too. The reason lies in the
correlation increase with the decrease of the interelement distance.
Correlation between the transmitted and received signals decreases the
FIGURE 2.8
CDFs of capacity for the Rayleigh MIMO channel with spatial fading correlation.
* We consider the scenario where half wavelength interelement distance introduces low enough
correlation that the fades can be considered independent [1].
1
0.9
0.8
0.7
(2, 2) 
CDF-correlated channel-SNR = 10 
(4, 4) 
0.6
0.5
0.4
0.3
Prob(capacity < c)
0.2
0.1
00 
5 
10 
15 
20 
25 
30 
c bits/sec/Hz 
35
d = 0.01 
d = 0.1 
d = 0.2 
d = 0.5 

50
MIMO System Technology for Wireless Communications
independent propagation paths and, as a result, decreases the information
transferred.
Also, we notice that the (4,4) MIMO channel achieves higher capacity
compared to the (2,2) channel, under any correlation conditions.
2.7.3
MIMO Capacity for a Ricean Channel
The channel matrix that it is used for capacity calculations is given by
Equation 2.39. Figure 2.9 illustrates the CDFs of capacity for different antenna
conﬁgurations and for a constant Ricean factor equal to K = 4. Figure 2.10
illustrates the CDFs of capacity for a (2,2) MIMO channel for different Ricean
factors. The CDF for K = 0 represents the case of Rayleigh fading channel.
Apparently, Figure 2.9 indicates that the use of array antennas at both the
transmitter and receiver improves substantially the capacity. The same result
arose in the case of the simple Rayleigh channel studied in the previous section.
Figure 2.10 proves that the presence of a ﬁxed component can cause great
damage to the MIMO channel capacity performance. We easily see that the
channel capacity decreases when the Ricean factor increases. The value of K
corresponds to the strength of the dominant component. As K increases, the
dominant component appears stronger and the correlation coefﬁcient
increases too. As mentioned before, correlation leads to the limitation of the
independent paths that transfer information and, hence, to lower capacity
gains.
FIGURE 2.9
CDFs of capacity for the Ricean MIMO channel with K = 4.
1
0.9
0.8
0.7
(2, 2) 
(2, 4) 
(4, 2) 
(4,4)
CDF-rank(HRice) = 1, SNR = 10, K = 4 
0.6
0.5
0.4
0.3
Prob(capacity < c)
0.2
0.1
02 
4 
6 
8 
10 
12 
c bits/sec/Hz 
14

Theory and Practice of MIMO Wireless Communication Systems
51
Finally, Figure 2.10 shows that the capacity decrease, due to the ﬁxed
component reaching the receiver, can be easily compensated by the use of
more elements. Speciﬁcally, we notice that the (4,4) channel with K = 12
outperforms the (2,2) Rayleigh fading channel (K = 0).
Appendix 2A
Capacity of a MIMO Channel Using the Singular Values 
of the Channel Matrix H
In Equation 2.13 we presented the MIMO channel capacity with no CSI at
the transmitter. Equation 2.13 can be transformed into Equation 2.14 as
follows:
According to singular value decomposition
(2A.1)
D is a diagonal matrix with elements the singular values of H. The singular
values of a complex matrix are always non-negative and equal to the square
FIGURE 2.10
CDFs of capacity for a (2,2) channel for different K-factors.
1
0.9
0.8
0.7
CDF-SNR = 10
0.6
0.5
0.4
0.3
Prob(capacity < c)
0.2
0.1
02 
3 
4 
5 
6 
8 
9 
10 
11 
7
c bits/sec/Hz
12
(2, 2) 
(4, 4) 
K = 8 
K = 10 
K = 12 
K = 0 
H
UDV
=
H

52
MIMO System Technology for Wireless Communications
root of the eigenvalues of the positive semi-hermitian matrix
. Let Jk be
the kth singular value of H, hence,
will be the kth eigenvalue of
. 
Using transformation Equation 2A.1 for the
matrix we get:
(2A.2)
We replace Equation 2A.2 in Equation 2.13:
(2A.3)
Appendix 2B
Proof That J2
1 = nr When nt = 1 and J2
1 = nt When nr = 1, 
When hi,j = 1
We use the known algebraic equality
:
(2B.1)
HHH
Jk
2
HHH
HHH
HH
UDV
UDV
UDV VD U
UDD U
HH
UD U
H
H
H
H
H
H
H
H
H
H
H
=
(
)
=
=
¡
=
2
= UD U
2
H
C
p
n
H
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½
log
det
2
2
I
UD U
,
we use the equality det
det
I
AB
I
B
+
¬®
¼¾ =
+
A
I
D
¬®
¼¾
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½ =
+
C
p
n
p
n
log
det
log
(
2
2
2
1
J
J
J
1
2
2
2
2
2
1
1
1
)(
)
(
)
log
+

+
¬
®­
¼
¾½ ¡
=
+
p
n
p
n
C
p
n
n
Jk
k
n
2
1
©
«ª
¹
»º
=¨
Jk
k
nr
Tr
2
1
=¨
=
(
)
HHH
Jk
k
n
H
i j
i j
j
n
i
n
i
r
t
r
Tr
h
h
h
2
1
1
1
=
=
=
¨
¨
¨
=
(
) =

=
HH
,
,
,j
j
n
i
n
k
k
n
i j
j
n
i
n
t
r
r
t
r
h
2
1
1
2
1
2
1
1
=
=
=
=
=
¨
¨
¨
¨
¨
¡
=
J
,

Theory and Practice of MIMO Wireless Communication Systems
53
When nt = 1, Equation 2B.1 gives:
(2B.2)
However, since nt = 1,
and as a result there is only one
.
Hence, Equation 2B.2 takes the form:
(2B.3)
When nr = 1, Equation 2B.1 gives:
(2B.4)
Appendix 2C
Minimization of Angular Shift When R ≫ d
In accordance with Figure 2.4, we denote V the angular shift between the
neighbor elements; this angle is given by the equation:
(2C.1)
where Q is the wavelength of the transmitted signal.
From the ﬁgure above we have:
(2C.2)
substituting Equation 2C.2 into Equation 2C.1:
J
J
J
J
k
k
n
i j
j
i
n
n
r
r
r
h
2
1
2
1
1
1
1
2
2
2
2
=
=
=
¨
¨
¨
=
¡
+
+
+
,
...
= nr
rank
H
(
)
HH
= 1
Jk
2
0
|
J1
2 = nr
J
J
k
k
n
i j
j
n
i
t
r
t
h
n
2
1
2
1
1
1
1
2
=
=
=
¨
¨
¨
=
¡
=
,
V
U
U
Q
=

e
=

e
2
2
R
R
c
f
R
R
R
R
R
d
R
d
R
d
=
e
e =
¿
À²
Á²
¡
=
e =
cos
sin
cos
sin
sin
I
I
I
I
I

54
MIMO System Technology for Wireless Communications
Assuming that
or
then I approaches zero and we can use the
approximation:
(2C.4)
Finally, Equation 2C.3 is given by:
(2C.5)
Equation 2C.5 proves that under the aforementioned assumptions V may be
omitted from the matrix (Equation 2.38).
References
1. D.S. Shiu, J. Foschini, J. Gans, and J.M Kahn. 2000. “Fading correlation
and its effect on the capacity of multielement antenna system,” IEEE
Transactions on Communications, 48, 502, 2000.
2. http://www.cs.ut.ee/~toomas_1/linalg/lin2/node14.html
3. A. Paulraj, R. Nabar, and D. Gore. 2003. Introduction to Space-Time Wireless
Communications, Cambridge: Cambridge University Press, Chap. 4.
4. I.E. Telatar, “Capacity of multi-antenna Gaussian channels,” Eur. Trans. Telecom.,
Vol. 10, No. 6, Dec. 1999.
5. http://rkb.home.cern.ch/rkb/AN16pp/node123.html
6. B.R. Ertel and P. Cardieri. 1998. “Overview of spatial channel models for an-
tenna array communication systems,” IEEE Personal Communication Magazine,
Vol. 5, Feb. 1998, pp. 10–22.
7. G.V. Tsoulos and G.E. Athanasiadou. 2002. “On the application of adaptive
antennas to microcellular environments: radio channel characteristics and
system performance,” IEEE Trans. Veh. Technol., Vol. 51, No. 1, Jan. 2002, pp.
1–16.
8. G.E. Athanasiadou, A.R. Nix, and J.P. McGeehan. 2000. “A microcellular ray-
tracing propagation model and evaluation of its narrowband and wideband
predictions,” IEEE J. Select. Areas Commun., Vol. 18, Mar. 2000, pp. 322–335.
V
U
Q
U
Q
I
I
I
U
Q
=

e = 


©
«ª
¹
»º = 

2
2
2
R
R
d
d
d
sin
cos
sin
1
2
2
2
4
2

= 

(
) ¡
= 

cos
sin
sin
sin
sin
I
I
U
Q
I
I
V
U
Q
d
d
2
2
I
I
(
)
sin
(2C.3)
R
d
≫
d R ≪1
sinI
I
=
e ~
d
R
V
U
Q
I
I
U I
Q
U
Q
= 

= 
~
e
4
4
1
2
2
d
d
d
R ≪

Theory and Practice of MIMO Wireless Communication Systems
55
9. G.E. Athanasiadou and A.R. Nix. 2000. “A novel 3D indoor ray-tracing prop-
agation model: the path generator and evaluation of narrowband and wide-
band predictions,” IEEE Trans. Veh. Technol., Vol. 49, July 2000, pp. 1152–1168.
10. 3GPP TR 25.996 V6.1.0 (www.3gpp.org).
11. L. Correia, ed. 2001. Wireless Flexible Personalised Communications, New York:
Wiley.
12. G.J. Foschini. 1996. “Layered space-time architecture for wireless communica-
tions in a fading environment when using multi-element antennas,” Bell Labs
Tech. J., Autumn 1996, pp. 41–59.
13. J.G. Proakis. 1983. Digital Communications, 4th ed., New York: McGraw-Hill,
Chap. 2.
14. A. Papoulis. 1984. Probability, Random Variables, and Stochastic Processes, New
York: McGraw-Hill.
15. M.A. Khalighi, J.-M. Brossier, G. Jourdain, and K. Raoof. 2001. “On capacity of
Ricean MIMO channels,” in Proc. 12th IEEE Int. Symp. Personal, Indoor and Mobile
Radio Communications, A-150 to A-154, Vol. 1, 2001.
16. A. Zelst and J.S. Hammerschmidt. 2002. “A single coefﬁcient spatial correlation
models for multiple-input multiple output (MIMO) radio channels,” in Proc.
URSI XXVIIth General Assembly, 2002.
17. S. Loyka and G.V. Tsoulos. 2002. “Estimating MIMO system performance using
the Correlation matrix approach,” IEEE Commun. Letters, 6, 19, 2002.
18. J. Salz and J.H. Winters. 1994. “Effect of fading correlation on adaptive arrays in
digital mobile radio,” IEEE Trans. Veh. Technol., Vol. 43, Nov. 1994, pp. 1049–1057.


57
3
Information Theory and Electromagnetism: 
Are They Related?
Sergey Loyka and Juan Mosig
CONTENTS
3.1
Introduction ..................................................................................................57
3.2
MIMO Channel Capacity ...........................................................................58
3.3
The Laws of Electromagnetism.................................................................59
3.4
Spatial Capacity and Correlation..............................................................61
3.5
Spatial Sampling and MIMO Capacity....................................................66
3.5.1
Bounds on Truncation Error in Sampling Series .......................69
3.5.2
Impact of Truncation Error on the Capacity ..............................71
3.6
MIMO Capacity of Waveguide Channels................................................75
3.6.1
Rectangular Waveguide Capacity ................................................77
3.6.2
Rectangular Cavity Capacity.........................................................82
3.7
Spatial Capacity of Waveguide Channels ...............................................84
3.8
Acknowledgments.......................................................................................85
References...............................................................................................................86
3.1
Introduction
Multi-antenna systems have recently emerged as a highly efﬁcient strategy
for wireless communications in rich multipath channels [1–4]. However, it
is also well recognized that the wireless propagation channel has a profound
impact on MIMO system performance [3–8]. In ideal conditions (uncorre-
lated high rank channel) the MIMO capacity scales roughly linearly as the
number of Tx/Rx antennas. The effect of channel correlation is to decrease
the capacity and, at some point, this is the dominant effect. This effect is
highly dependent on the scenario considered. Many practically important

58
MIMO System Technology for Wireless Communications
scenarios have been studied and some design guidelines have been proposed
as well.
Here we analyze the effect of propagation channel from a completely
different perspective [9–14]. Electromagnetic waves are used as the primary
carrier of information. The basic electromagnetism laws, which control the
electromagnetic ﬁeld behavior, are expressed as Maxwell equations [15,16].
Hence, we ask the question: What is the impact, if any, of Maxwell equations
on the notion of information in general and on channel capacity in particular?
In other words, do the laws of electromagnetism impose any limitations on
the achievable channel capacity? Below, we concentrate on this last question
and try to answer it. We are not targeting particular scenarios; rather, we are
going to look at fundamental limits that hold in any scenario. Analyzing
MIMO channel capacity allows one, in our opinion, to come very close to
answering this question.
Our approach is a three-fold one [13]. First, we employ the channel corre-
lation argument and introduce the concept of an ideal scattering to demon-
strate that the minimum antenna spacing is limited to about half a wave
length for any channel (i.e., locating antennas closer to each other will result
in a capacity decrease because of correlation). 
Second, we use the plane wave spectrum expansion of a generic electro-
magnetic wave and the Nyquist sampling theorem in the spatial domain to
show that the laws of electromagnetism in its general form (Maxwell equations)
limit the antenna spacing to half a wavelength, dmin = Q/2, for linear antenna
arrays but only asymptotically when the number of antennas n q h. For a
ﬁnite number of antennas, this limit is slightly less than Q/2 because a slight
oversampling is required to reduce the truncation error when using the
sampling series. In any case, the existence of the minimum spacing limits
the number of antennas and the MIMO capacity for a given aperture size.
It should be emphasized that this limitation is scenario-independent. It fol-
lows directly from Maxwell equations and is valid in any situation. 
Third, we consider the MIMO capacity of waveguide and cavity channels
and demonstrate that there is a ﬁnal number of degrees of freedom in that
environment also, which is dictated directly by Maxwell equations that can
be exploited for MIMO communications. Electromagnetics and information
theory can be nicely united in this case to produce insight that is not available
by using either of these disciplines separately. In particular, it turns out that
the traditional single-mode transmission, which is so popular in the electro-
magnetics community, is optimal only at a small signal-to-noise ratio (SNR).
3.2
MIMO Channel Capacity
We employ the celebrated Foschini-Telatar formula for the MIMO channel
capacity [1,2], which is valid for a ﬁxed linear n × n matrix channel with

Information Theory and Electromagnetism: Are They Related?
59
additive white Gaussian noise and when the transmitted signal vector is
composed of statistically independent equal power components, each with
a Gaussian distribution, and the receiver knows the channel,
[bits/s/Hz].
(3.1)
Here, n is the number of transmit/receive antennas, W is the average SNR,
I is a n × n identity matrix, G is the normalized channel matrix (the entries
are complex channel gains from each Tx to each Rx antenna),
,
which is considered to be frequency independent over the signal bandwidth,
and + denotes transpose conjugate. For simplicity, we consider a n × n chan-
nel, but the results also hold true, sometimes with minor modiﬁcations, for
a nR × nT channel, where nR and nT are the number of Tx and Rx antennas,
respectively, nR | nT.
In an ideal case of orthogonal full-rank channel Equation 3.1 reduces to
,
(3.2)
i.e., the capacity is maximum and scales roughly linearly with the number
of antennas.
3.3
The Laws of Electromagnetism
It follows from Equation 3.1 that the MIMO channel capacity crucially
depends on the propagation channel G. Since electromagnetic (EM) waves
are used as the carrier of information, the laws of electromagnetism must
have an impact on the MIMO capacity. They ultimately determine the behav-
ior of G in different scenarios. Hence, we outline the laws of electromagne-
tism from a MIMO system perspective. In their most general form, they are
expressed as Maxwell equations with charge and current densities as the
ﬁeld sources [15,16]. Appropriate boundary conditions must be applied in
order to solve them. We are interested in the application of Maxwell equa-
tions to ﬁnd the channel matrix G in Equation 3.1. Since the Rx antennas are
physically separated from the Tx ones, we assume that the physical support
of our channel is a source-free space, which includes scatterers, where EM
waves do propagate. In this case, Maxwell equations simplify to the system
of two decoupled wave equations [15]:
,
(3.3)
where
and
are electric and magnetic ﬁeld vectors, and c is the speed of
light. There are six independent ﬁeld components (or “polarizational degrees
tr[GG+ =
]
n
C
n
n
=
+
(
)
log
/
2 1
W


y
y
=


y
y
=
2
2
2
2
2
2
2
2
1
0
1
0
E
E
H
H
c
t
c
t
,
E
H

60
MIMO System Technology for Wireless Communications
of freedom”) associated with Equation 3.3 (three for electric and three for
magnetic ﬁelds), which can be used for communication in rich-scattering
environments. Only two of them survive in free space at the far-ﬁeld region
(“poor scattering”). Hence, in a generic scattering case the number of polar-
izational degrees of freedom varies between two and six, and each of them
can be used for communication. Using the Fourier transform in time domain,
.
(3.4)
Equation 3.3 can be expressed as [15]
,
(3.5)
where K denotes any of the components of E and H, r is a position vector
and \ is the frequency. For a given frequency \ (i.e., narrowband assump-
tion), Equation 3.5 is a second-order partial differential equation in r. It
determines K (for given boundary conditions, i.e., a Tx antenna conﬁguration
and scattering environment) and, ultimately, the channel matrix and the
channel capacity. Note that Equation 3.5 is general as it does not require any
signiﬁcantly restrictive assumptions. The source-free region assumption
seems to be quite natural (i.e., Tx and Rx antennas are physically separated),
and the narrowband assumption is simplifying but not restrictive since Equa-
tion 3.5 can be solved for any frequency and, further, the capacity of a
frequency-selective channel can be evaluated using well-known techniques.
Unfortunately, the link between Equation 3.5 and the channel matrix G is
not explicit at all. A convenient way to study this link is to use the spatial
domain Fourier transform, i.e., the plane-wave spectrum expansion,
(3.6)
where k is the wave vector. Using Equation 3.6, Equation 3.5 can be reduced
to [15]
.
(3.7)
Hence,
, and the electromagnetic ﬁeld is represented in terms of
its plane-wave spectrum
, which in turn is determined through given
boundary conditions, i.e., scattering environment and Tx antenna conﬁgu-
ration. In the next sections, we discuss limitations imposed by Equation 3.5
through Equation 3.7 on the MIMO channel capacity.
K
\
K
\
( ,
)
( , )
r
r
=

µ
t e
dt
j t

+(
)
=
2
2
0
K
\
\
K
\
( ,
)
/
( ,
)
r
r
c
K
\
K
\
K
U
K
\
( ,
)
( ,
)
( , )
(
)
( ,
)
k
r
r
r
k
k r
=
=

µ
µµ
e
d
t
e
j
1
2
4
j
t
d d
(
)
,
\
\
 
k r k
k
k
2
2
0

(
)
=
(
)
( ,
)
\
K
\
/c
k = \/c
K
\
( ,
)
k

Information Theory and Electromagnetism: Are They Related?
61
3.4
Spatial Capacity and Correlation
The channel capacity is deﬁned as the maximum mutual information [17],
,
(3.8)
where
are Tx and Rx vectors, and the maximum is taken over all possible
transmitted vectors subject to the total power constraint,
.
Under some conditions (quasi-static frequency-ﬂat channel with additive
white Gaussian noise (AWGN), with perfect channel state information (CSI)
at the receiver), this results in Equation 3.1. In order to study the impact of
the electromagnetics laws on the channel capacity and, following the
approach of [1,2], we deﬁne the spatial capacity S as the maximum mutual
information between the Tx vector on one side and the pair of the Rx vector
y and the channel
(assuming perfect CSI at the Rx end) on the other, the
maximum being taken over both the Tx vector and EM ﬁeld distributions,
(3.9)
where, to be speciﬁc, we assume that the electric ﬁeld E is used to transmit
data (H ﬁeld can be used in the same way), and the last constraint is due to
the boundary condition B associated with the scattering environment. The
ﬁrst constraint is the classical power constraint and the second one is due
to the wave equation. The channel matrix G is a function of E since the
electric ﬁeld is used to send data. The spatial capacity S is difﬁcult to ﬁnd
in general, since the constraints include a partial differential equation with
arbitrary boundary conditions.
One may consider a reduced version of this problem by deﬁning a spatial
MIMO capacity as a maximum of the conventional MIMO channel capacity
(per unit bandwidth, i.e., in bits/s/Hz) over possible propagation channels
(including Tx and Rx antenna locations and scatterers’ distribution), subject
to some possible constraints. In this case, we replace Equation 3.9 by
,
(3.10)
where the constraint
is due to the Maxwell (wave) equations
and the capacity is maximized by changing G (within some limits), for
example, by appropriate positioning of antennas. Unfortunately, the explicit
C
I
p
=
(
)
{
}
max
,
( )
x
x y
x, y
P
P
x
t
=
f
+
xx
G
S
I
P
p
T
=
{
}
(
)
{
}
f
+
max
,
,
( )
,
( ),
x
E
x
y G E
x x
const.:
,
,
,
,
=
0


y
y
=
{
} 
2
2
2
2
1
0
E
E
E E
r
c
t
t
B
S
C
=
( )
{
}

(
)
max
,
G
G
G
const.:
Maxwell
M
M Maxwell
(
)

62
MIMO System Technology for Wireless Communications
form of the constraint
is not known. Additional constraints (due to a
limited aperture, for example) may be also included. The aperture constraint
was discussed in [25] by introducing the concept of intrinsic capacity, which
is somewhat similar to our concept of spatial capacity. Note that the second
deﬁnition (Equation 3.10) will give a spatial capacity, which is, in general,
less than or equal to that in the ﬁrst deﬁnition (Equation 3.9).
We have termed the maxima in Equation 3.9 and Equation 3.10 “spatial
capacity” or “capacity of a given space.” Since we have to vary the channel
during this maximization, the name “channel capacity” seems to be inap-
propriate simply because the channel is not ﬁxed. On the other hand, we
vary the channel within some limits, i.e., within given space. Thus, the term
“capacity of a given space,” or “spatial capacity,” seems to be appropriate.
The question arises: What is this maximum and what are the main factors
that have an impact on the maximum? Using the ray-tracing (geometrical
optics) arguments and the recent result on the MIMO capacity, we further
demonstrate that there exists an optimal distribution of scatterers and of Tx/Rx
antennas that provides the maximum possible capacity in a given region of
space. Hence, the MIMO capacity per unit spatial volume can be deﬁned in a
fashion similar to the traditional deﬁnition of the channel capacity per unit
bandwidth. This allows the temporal and spatial domains to enter into the
analysis on equal footing and, hence, demonstrates explicitly the space–time
symmetry of the capacity problem in the spirit of special relativity in physics.
In order to proceed further, we need some additional assumptions. Con-
sidering a speciﬁc scenario would not allow us to ﬁnd a fundamental limit
simply because the channel capacity would depend on too many speciﬁc
parameters. For example, in outdoor environments the Tx and Rx ends of
the system are usually located far away from each other. Hence, any MIMO
capacity analysis (and optimization) must be carried out under the constraint
that the Tx and Rx antennas cannot be located close to each other. However,
there exists no fundamental limitation on the minimum distance between
the Tx and Rx ends. Thus, this maximum capacity would not be a funda-
mental limit. In a similar way, a particular antenna design may limit the
minimum distance between the antenna elements, but it is just a design
constraint rather than a fundamental limit. Similarly, the antenna design has
an effect on the signal correlation (due to the coupling effect, for example),
but this effect is very design-speciﬁc and, hence, is not of a fundamental
nature. In other words, the link between the wave equations, Equation 3.3
or Equation 3.7 and the channel matrix G is far from explicit, since too many
facts depend on Tx and Rx antenna designs and on many other details.
We will instead consider a reduced version of this problem. In particular,
we investigate the case when the Tx and Rx antenna elements are constrained
to be located within given Tx and Rx antenna apertures. We are looking for
such location of antenna elements (within the given apertures) and such
distribution of scatterers that the MIMO capacity (“spatial capacity”) is max-
imum. While this maximum may not be achievable in practice, it gives a
good indication as to what the potential limits of MIMO technology are.
M

Information Theory and Electromagnetism: Are They Related?
63
In order to avoid the effect of design-speciﬁc details, we adopt the follow-
ing assumptions. First, we consider a limited antenna aperture size (1D, 2D
or 3D) for both the Tx and Rx antennas. All the Tx (Rx) antenna elements
must be located within the Tx (Rx) aperture. As it is well known, a rich
scattering environment is required in order to achieve high MIMO capacity.
Thus, second, the rich (“ideal”) scattering assumption is adopted in its most
abstract form. Speciﬁcally, it is assumed that there is an inﬁnite number of
randomly and uniformly located ideal scatterers (the scattering coefﬁcient
equals to unity), which form a uniform scattering medium in the entire space
(including the space region considered) and which do not absorb EM ﬁeld.
This is the concept of “ideal scattering” (which cannot be better than that).
Third, antenna array elements are considered to be ideal ﬁeld sensors with
no size and no coupling between the elements in the Rx (Tx) antenna array.
Our goal is to ﬁnd the maximum MIMO channel capacity in such a scenario
(which posses no design-speciﬁc details) and the limits imposed by the
electromagnetism laws. It should be emphasized that the effect of electro-
magnetism laws is already implicitly included in some of the assumptions
above. In order to simplify analysis further, we use the ray (geometrical)
optics approximation, which justiﬁes the ideal scattering assumption above.
Knowing that the capacity increases with the number of antennas, we try
to use as many antennas as possible. Is there any limit to it? Since antennas
have no size (by the assumption above), the given apertures can accommo-
date the inﬁnite number of antennas. However, if antennas are located close
to each other the channel correlation increases and, consequently, the capac-
ity decreases. A certain minimum distance between antennas must be
respected in order to avoid capacity decrease, even in ideal rich scattering.
Figure 3.2 demonstrates this effect for uniformly spaced linear array anten-
nas for the scattering scenario depicted in Figure 3.1: if d < dmin, the effect of
correlation is signiﬁcant and the capacity is less than the maximum one [8].
While dmin depends on the scattering environment, i.e., the angular spread
) of incoming multipath,
,
even in rich scattering (i.e., ) = 360°) dmin ~ Q/2, which is consistent with the
Jakes model [22]. While the model above is a two-dimensional (2D) one, it
can be extended to 3D applying it to both orthogonal planes and, due to the
symmetry of the problem (no preferred direction), similar results should
hold in 3D as well. Rigorous analysis shows that the correlation between
adjacent elements in that case is sin(2Ud/Q)/(2Ud/Q) (with the ﬁrst zero at
d0 = Q/2) and the same minimum spacing requirement holds true, dmin = Q/2.
We summarize the effect of dmin as follows. When we increase the number
of antenna elements over a ﬁxed aperture, the capacity at ﬁrst increases. But
at some point, due to aperture limitation, we have to decrease the distance
dmin
max
, .
Q
~
¯
°
±
¿
À
Á
1
2
0 5
)

64
MIMO System Technology for Wireless Communications
between adjacent elements to accommodate new ones within the ﬁxed aper-
ture. When the element spacing decreases, the capacity increase slows down,
and ﬁnally, when the element spacing is less than the minimum distance,
dmin ~ Q/2, the capacity saturates. Hence, there is an optimal number of
antennas, for which the full capacity is achieved with the minimum number
of antenna elements (i.e., the minimum complexity). Figure 3.3 demonstrates
this capacity saturation effect for a ﬁxed-aperture antenna array using the
model in [8]. Note the dual nature of capacity saturation: the capacity satu-
rates with increasing the element spacing over dmin for a given number of
elements n (1st type saturation — Figure 3.2) and also with increasing n over
number Nopt for given aperture length L (2nd type saturation — Figure 3.3).
A similar capacity saturation argument has already been presented earlier
in [9]. However, no appropriate model has been developed, and also the
FIGURE 3.1
Incoming multipath signals arrive to a uniform linear antenna array of isotropic elements within
±)/2 of the broadside direction.
FIGURE 3.2
The average capacity vs. antenna spacing for the uniform linear array and the single-cluster
multipath channel of Figure 3.1 with angular spread ) at the Rx end (the Tx end is assumed
to be uncorrelated); n = 10, SNR = 30 dB. When ) = 360°, dmin ~ Q/2.
d 
∆ 
0 
6 
5 
4 
3 
2 
1 
0 
20 
30 
40 
50 
60 Cmax 
dmin 
∆ = 10° 
∆ = 360° 
Capacity, bit/s/Hz 
d/λ 
1 
max 
, 0.5 
2∆ 
dmin 
λ ≈ 

Information Theory and Electromagnetism: Are They Related?
65
optimal number of antennas has not been evaluated. Using the model in [8]
or the equivalent 3D model results in dmin ~ Q/2 for ) = 360° (uniform
scattering), and the optimal number Nopt of antennas for a given aperture
size L is straightforward to evaluate (1D aperture, i.e., linear antenna array):
.
(3.11)
For an angular spread smaller than 360°, the optimal number of antennas
decreases correspondingly,
.
This result is a spatial domain equivalent of the 2WT dimension theorem
[36].
It should be emphasized that the 2nd type capacity saturation has been
observed under the assumption of ﬁxed average SNR at the receiver, which
is equivalent to
, where nT is the number of Tx antennas, which
is ﬁxed. Since increasing n results in more power collected by the Rx antenna
elements, which is equivalent to increasing the average SNR, it was specu-
lated that the 2nd type saturation may not exist if the SNR increase is taken
into account.* As we show later, this is not so (since the total power collected
by the Rx array is limited for ﬁxed L).
FIGURE 3.3
The average capacity vs. the number of elements n of a uniform linear array and a single-cluster
multipath channel with the angular spread ) at the Rx end. The Tx end is assumed to be
uncorrelated, the number of Tx antenna elements is nT = 10; the aperture length L = 5Q, SNR =
30 dB.
* A. Molisch, private communication.
10 
5 
0 
15 
20 
0 
20 
30 
40 
50 
60 
L = 5λ 
∆ = 360° 
Nopt 
∆ = 10° 
Capacity , bit/s/Hz 
n 
N
L
opt ~
+
2
1
/Q
N
L
opt ~
{
} +
2
1
1
Q min
,
)
tr
nT
GG+
{
} =

66
MIMO System Technology for Wireless Communications
While our analysis above was based on 1D antenna arrays, the similar
saturation effects can be observed for 2D and 3D arrays as well. Additionally,
the capacity saturation effect has been also noted for circular arrays [24].
Hence, this effect is not a consequence of a speciﬁc array geometry but rather
a generic property of any array: capacity saturates as long as adjacent ele-
ment spacing is about Q/2, regardless of the geometry.* Finally, we note that
the results above are consistent with the diversity combining analysis, where
the minimum spacing is about half a wavelength (for ) = 360°) as well [22],
and with the earlier speculation in [1].
3.5
Spatial Sampling and MIMO Capacity
In the previous section, we argued that the channel correlation limits the
minimum antenna spacing to half a wavelength (even in the case of “ideal”
scattering). In this section, we demonstrate that the same limit can be
obtained directly from the wave equations, Equation 3.3 or Equation 3.5,
without reference to the channel correlation.
Let us start with the wave equation, Equation 3.5. The ﬁeld spectrum
K(k, \) can be computed in a general case provided there is a sufﬁcient
knowledge of the propagation channel and of the Tx antennas (note that we
have not made, so far, any simplifying assumptions regarding the propaga-
tion channel). Knowing the ﬁeld, which is given by the inverse Fourier
transform in Equation 3.6, and Rx antenna properties, one may further
compute the signal at the antenna output and, hence, the channel matrix G.
The result will, of course, depend on the Rx antenna design details. In order
to ﬁnd a fundamental limit, imposed by the wave equations (Equation 3.5)
on the channel capacity (Equation 3.1), we have to avoid any design-speciﬁc
details. Thus, as we did earlier, we assume that the Rx antennas are ideal
ﬁeld sensors (with no size, no coupling between them, etc.), and conse-
quently, the signal at the antenna output is proportional to the ﬁeld (any of
the six ﬁeld components may be used). Hence, the channel matrix entries gij
must satisfy the same wave equation as the ﬁeld itself. In general, different
Tx antennas will produce different plane-wave spectra around the Rx anten-
nas, and hence, the wave equation is
,
(3.12)
* We should note that mutual coupling between antenna elements is not taken into account in
the present study. Based on the results in [30,31], if this effect is accounted for, the capacity may
actually decrease for n > Nopt since d < Q/2 in that region.
k
g k
2
2
0

(
)
=
(
)
( ,
)
\
\
/c
j

Information Theory and Electromagnetism: Are They Related?
67
where
is the plane-wave spectrum produced by jth Tx antenna. To
simplify things further, we employ the narrowband assumption: \ = const,
and hence, k = \/c is constant (the case of a frequency-selective channel
can be analyzed in a similar way — see below). The channel matrix entries
for given locations of the Rx antennas can be found using the inverse Fourier
transform in the wave vector domain:
,
(3.13)
where
is the position vector of ith Rx antenna, and
is the channel
“vector,” i.e., propagation factor from jth Tx antenna to an Rx antenna located
at position r. The integration in Equation 3.13 is performed on a hypersurface
k = \/c. As we show below, this results in a very important consequence.
Consider, for simplicity, the 2D case (the 3D case can be considered in a
similar way). In this case, the integration in Equation 3.13 is performed along
the line given by
.
(3.14)
Assume that the Rx antenna is a linear array of elements located on the
OX axis, i.e., ry = 0. In this case, Equation 3.13 reduces to
(3.15)
where kmax = \/c due to Equation 3.14. At this point, we ignored the eva-
nescent waves with k > kmax because they decay exponentially with distance
and can be ignored at distances more than a few Q from the source [15,16].
Note that computing gij corresponds to sampling
with sampling
points being xi . Let us now apply the Nyquist sampling theorem to Equation
3.15. According to it, a band-limited signal,
in our case (it is band-
limited in kx-domain), can be exactly recovered from its samples taken at a
rate equal at least to twice the maximum signal frequency (Nyquist rate). In
our case, the Nyquist rate is
and the sampling interval is
,
(3.16)
where Q = 2Uc/\ is the wavelength. There is no loss of information associated
with the sampling since the original channel “vector”
(as well as the
g k
j( ,
)
\
g r
g k
k
g r
k r
j
j
j
ij
j
i
e
d
g
( ,
)
(
)
( ,
)
,
( ,
\
U
\
\
=
=
µ


1
2
3
)
ri
g r
j( ,
)
\
k
k
c
k
c
k
x
y
x
y
2
2
2
2
2
+
= (
) q
= ± (
) 
\
\
/
/
g
g
j
j
x
k
k
jk r
x
x
k
e
dk
x x
( ,
)
(
)
(
,
)
max
max
\
U
\
=



µ
1
2
2
,
(
,
),
g
x
ij
j
i
= g
\
gj x
( ,
)
\
gj
x
k
(
,
)
\
2kmax
)x
k
min
max
(
)
=
=
2
2
2
U
Q
/
/
g r
j( ,
)
\

68
MIMO System Technology for Wireless Communications
ﬁeld itself) can be recovered exactly from its samples at x = 0, ±)xmin, ±2)xmin,
…. This means that by locating the ﬁeld sensors at sampling points, which
are separated by )xmin, we are able to recover all the information transmitted
by electromagnetic waves to the receiver. Hence, the channel capacity is not
reduced. This implies, in turn, that the minimum spacing between antennas
is half a wavelength:
.
(3.17)
Locating antennas closer to each other does not provide any additional
information and, hence, does not increase the channel capacity. It should be
noted that the same half-wavelength limit was established in Section 3.4
using the channel correlation argument, i.e., locating antennas closer will
increase correlation and, hence, the capacity will not increase. However,
while the channel correlation argument may produce some doubts as to
whether the limit is of fundamental nature or not (correlation depends on a
scenario considered), the spatial sampling argument demonstrates explicitly
that the limit is of fundamental nature because it follows directly from
Maxwell equations (i.e., the wave equation), without any simplifying
assumptions as, for example, the geometrical optics approximation [18]
(when evaluating correlation, we have to use it to make the ray tracing valid).
Note that the spatial sampling arguments hold also for a broadband channel
(the smallest wavelength, corresponding to the highest frequency, should be
used in this case to ﬁnd )xmin) and for the case of 2D and 3D antenna
apertures. However, in the latter two cases, the minimum distance (i.e., the
sampling interval) is different [21]. If one uses a 2D antenna aperture (i.e.,
2D sampling), the sampling interval is
(3.18)
and in the case of 3D aperture,
(3.19)
While the minimum distance in these two cases is different from the 2D
case, )xmin < )xmin,2 < )xmin,3 (i.e., each additional dimension possesses fewer
degrees of freedom than the previous one), the numerical values are quite
close to each other.
Another interpretation of the minimum distance effect can be made
through a concept of the number of degrees of freedom. As the sampling
argument shows, for any limited region of space (1D, 2D or 3D), there is a
limited number of degrees of freedom possessed by the EM ﬁeld itself. No
antenna design or its speciﬁc location can provide more. This is a fundamental
d
x
min
min
=
=
)
Q/2
)xmin,
,
2
3
= Q/
)xmin,
.
3
2
= Q/

Information Theory and Electromagnetism: Are They Related?
69
limitation imposed by the laws of electromagnetism (Maxwell equations) on
the MIMO channel capacity.
An important remark, often overlooked, on using the sampling theorem
to ﬁnd the minimum antenna spacing is worth mentioning. The sampling
theorem guarantees that the original band-limited signal can be recovered
from its samples, provided that the inﬁnite number of samples are used
(band-limited signal cannot be time limited!). Hence, the half-wavelength
limit, as derived using the sampling theorem, holds true only asymptotically,
when n q h. For ﬁnite n, the sampling series does not represent exactly
anymore the continuous signal (ﬁeld) due to the truncation error [19]. This
is often overlooked in the array processing area [27] when the minimum
antenna (sensor) spacing is derived for n = h, while the number of antennas
is actually ﬁnite. In the latter case, the optimal number of antennas may be
larger than that given by Equation 3.11, i.e., the minimum spacing may be less
than Q/2 because a slight oversampling is required to reduce the truncation
error. The maximum truncation error of the sampling series for a given
limited space region (i.e., the antenna aperture in our case) decreases to zero
as the number of terms in the sampling series (i.e., the number of antennas
in our case) increases and provided that there is a small oversampling [20].
Below we present some truncation error bounds and discuss them in the
context of spatial sampling for the MIMO system.
3.5.1
Bounds on Truncation Error in Sampling Series
Consider reconstruction of a band-limited signal x(t) from its samples x(n)):
,
(3.20)
where sin c(t) = sin(Ut)/(Ut), ) = 1/fs and fs v 2 fmax are the sampling interval
and frequency, respectively, fmax is the maximum frequency in the spectrum
of x(t),
,
(3.21)
where Sx( f ) is the spectrum of x(t). When the series in Equation 3.20 is
truncated to
,
,
(3.22)
x t
x n
f t
n
s
n
( )
(
)sin
=

(
)
=h
h
¨
)
c
x t
S
f e
df
x
j
ft
f
f
( )
( )
=
µ
2U
max
max
n
N
f
x
t
x n
f t
n
N
s
n
N
N
( )
(
)sin
=

(
)
=¨
)
c

70
MIMO System Technology for Wireless Communications
the truncation error is 
.
(3.23)
Several bounds to J(t) are known [19,20], depending on the nature of the
signal and the interval of interest. When the recovered signal xN(t) is con-
sidered over a ﬁnite interval only (i.e., limited antenna aperture), t f T =
N), J(t) can be bounded as [20]:
(3.24)
where E is the signal’s energy,
.
(3.25)
As Equation 3.24 indicates, when ) q 0 (i.e., increasing oversampling) for
ﬁxed T (i.e., more antennas for ﬁxed antenna aperture), or when T q h for
ﬁxed ), we obtain J(t) q 0. In practical terms, as the mean squared error
(MSE),
,
becomes smaller than the noise power,
, its impact on the capacity is
small, and hence, it can be neglected. A tighter bound can be obtained from
Equation 3.24 by using the energy carried out by the truncated samples
instead of the total energy E [20]. We also note that Equation 3.24 does not
necessarily require oversampling.
Another bound to J(t), which does involve oversampling, is of the follow-
ing form [19]:
(3.26)
where F = fmax/fs is the oversampling ratio. Note that this bound limits the
error over the entire range of t. Clearly, as N q h, the truncation error J(t) q 0
J( )
( )
( )
(
)sin
t
x t
x
t
x n
f t
n
N
s
n
N
=

=

(
)
>¨
)
c
J
U
U
( )
sin
,
,
t
E
t
T
T
t
t
T
f

f
2
2
2
)
)
E
S
f
df
x
f
f
=
µ
( )
max
max
2
J
J
2
1
0
2
=
 µ
T
t
dt
T
( )
J
X
2
0
2
<
J
U
F
( )
max
( )
(
) ,
,
t
x t
N
t
{
}
f

h < < h
4
1
2

Information Theory and Electromagnetism: Are They Related?
71
for any F < 1. We note that Equation 3.24 and Equation 3.26 also justify the
use of truncated series in the time-domain as any transmission spans a ﬁnite
number of symbols. The difference between time-domain and spatial domain
cases is that in the former case, the number of samples is much larger, and
hence, the truncation error is much smaller. On the contrary, since the num-
ber of antennas in many practical systems is small, the truncation error may
be, generally speaking, signiﬁcant. The smaller the F (i.e., larger oversam-
pling), the smaller the N is required for the same bound. While the conver-
gence of J(t) to 0 in Equation 3.24 and Equation 3.26 is slow in N, these
bounds, in many cases, overestimate the error, which converges to 0 much
faster with N. Additionally, it should be noted that the bound in Equation
3.26 applies to the entire range, –h < t < h, while the function is recovered
from the samples in –T < t < T, and hence, signiﬁcant contribution to the
error may come from the interval t > T, i.e., outside of the antenna aperture.
This interval does not contribute anything to the capacity for aperture-
limited system, and hence, this part of the error is irrelevant. Needless to
say, more accurate bounds can be obtained if more details are known about
the signal [35].
Figure 3.4 illustrates the normalized MSE
using the bounds in Equa-
tion 3.24 and Equation 3.26, where c = E and c = maxx(t)2, respectively, vs.
the number of samples. Clearly, for more than ten samples the error is already
small.
3.5.2
Impact of Truncation Error on the Capacity
As the discussion above demonstrates, even for small oversampling, the
truncation error goes to zero as the number of antennas (samples) increases.
FIGURE 3.4
Normalized mean square truncation error bounds vs. the number of samples; F = 0.8.
100 
0 
20 
40 
60 
80 
1.10−3
0.01 
0.1 
1 
eq. 3.24
eq. 3.26
0.01 
N
SNR = 20 dB
J2/c

72
MIMO System Technology for Wireless Communications
While the truncation error expressions above are useful on their own (in
particular, because they provide conﬁdence that indeed a truncated sampling
series can be good enough), they not only overestimate the error in many
cases, but also do not indicate explicitly the effect of the truncation on the
capacity.
A way to overcome this difﬁculty is to consider the true mean squared
error and to compare it with the noise power. When the squared truncation
error averaged over the antenna aperture is less than the noise power, MSE <
1/SNR, it is negligible as one is able to recover almost all the information
conveyed by the EM ﬁeld to the antenna aperture (but, possibly, not outside
of the aperture) in given noise. For example, using Figure 3.4, SNR = 20 dB
corresponds to MSE < 0.01 and N > 20 or N > 35 using Equation 3.24 or
Equation 3.26, respectively. It should not be surprising that these bounds are
different because different normalizations are used in Equation 3.24 and
Equation 3.26; also the nature of the bounds themselves is different, i.e.,
Equation 3.26 implies oversampling but Equation 3.24 does not (it is clear
from Figure 3.4 that oversampling results in much smaller truncation error
when N is not too small). Note also that larger SNR requires a larger number
of samples to make the truncation error small (less than the noise). Using
Equation 3.26, the required number of samples, which provides negligible
truncation error for given SNR W, can be estimated as
.
Since the truncation error is zero for an inﬁnite number of samples and
the required spacing is dmin = Q/2 in this case, one may expect that the actual
minimum antenna spacing is quite close to half a wavelength for a ﬁnite but
large number of antennas. The channel correlation argument, which roughly
does not depend on n, also conﬁrms this. Detailed analysis shows that the
truncation error effect can be eliminated by approximately a 10% increase
in the number of antennas for many practical cases. Figure 3.5 illustrates the
effect of oversampling by considering the MIMO capacity vs. the number of
antennas for given (ﬁxed) aperture length (linear antenna) L = 5Q for different
realizations of an independent identically distributed (i.i.d.) Rayleigh fading
channel. Clearly, there exists an optimum number of antennas nmax; using
more antennas does not result in higher capacity for any channel realization.
Remarkably, this maximum is only slightly larger than that in Equation 3.11,
i.e., spatial sampling and correlation arguments agree well. There is, how-
ever, one signiﬁcant difference between these two arguments: while the latter
is valid “on average” (i.e., for the mean capacity), the former is valid for
each channel realization (i.e., for the instantaneous capacity) and not only
on average. Clearly, the sampling argument is more powerful in this respect.
N >

4
1
2
W
U
F
(
)

Information Theory and Electromagnetism: Are They Related?
73
Keeping this in mind, one may say, based on the sampling theorem, that
the optimal number of antennas for a given aperture size is given approxi-
mately by Equation 3.11. Due to the reciprocity of Equation 3.1, the same
argument holds true for the transmit antennas as well. Hence, using Equation
3.2 and Equation 3.11, the maximum MIMO capacity can be found for a
given aperture size.
It should be noted that, as it was indicated above, in some practical cases
increasing n over Nopt in Equation 3.11 may result in higher SNR due to
antenna gain increase (i.e., more power collected by the Rx antenna elements)
and, consequently, in logarithmic increase in capacity. However, if this
increase does take place, it is very slow (logarithmic) and it does not occur
if the SNR is ﬁxed, i.e., when one factors out the effect of the antenna gain.
From a physical perspective, the total power collected by the antenna array
cannot exceed the power collected by the ideal continuous aperture of the
same size, which equals the total power delivered by the electromagnetic
wave to the given space region. Consequently, the array antenna gain vs.
the number of elements for a ﬁxed aperture is limited by the gain of a
continuous antenna (with the same aperture). As an example, Figure 3.6
shows the gain of a uniform linear array of isotropic elements vs. the number
of elements, computed using the well-known model [26], and compares it
to the gain of continuous linear antenna (aperture) of the same size L = 5Q.
Clearly, the array gain saturates at about the same point as the capacity, n ~
2L/Q, which corresponds to d ~ Q/2, and equals that of the continuous
aperture at that point (this is explained, of course, by the convergence of the
array antenna pattern to that of the linear aperture as the number of array
FIGURE 3.5
MIMO channel capacity vs. the number of Rx antennas for L = 5Q, nT = 10. Capacities of ﬁve
different realizations of a Rayleigh fading channel are shown. Capacity saturation for each of
them is clear.
15 
5 
10 
20 
30 
40 
50 
60 
20 
. 
nR
nmax ≈2L/λ + 2 
Capacity, bit/s/Hz  

74
MIMO System Technology for Wireless Communications
elements increases within the ﬁxed aperture). Hence, there is no increase in
SNR beyond that point and, consequently, no increase in capacity can be
expected due to higher SNR. As a side remark, we note that the similar gain
saturation effect can be observed for an array of collinear short dipoles and
other elements.
As it was indicated above, in many practical cases the minimum spacing
can be substantially larger than Q/2. For example, when all the multipath
components arrive within a narrow angle spread ) ≪ 1, dmin ~ Q/(2)) ≫ Q/2
[8] (remarkably, the same limit follows from the spatial sampling argument).
Hence, fewer antennas can be accommodated within a given aperture, Nopt
~ 2L)/Q + 1, and, consequently, the MIMO capacity is smaller for a given
aperture size.
A note is in order on practical value of the minimum spacing results above.
Since these results were derived under the assumption of ideal antennas
(isotropic ﬁeld sensors with no mutual coupling), it is expected that practical
implementation of real antenna arrays operating in real scattering environ-
ments may result in some deviations from the results above. For example,
it was observed in the literature that mutual coupling (neglected in the
present study) may have a signiﬁcant effect on the capacity [28–31]. Since
both positive (i.e., higher capacity) [28,29] and negative [30,31] effects of the
mutual coupling have been reported, one has to conclude that this effect
depends signiﬁcantly on the environment, antenna design and also on the
assumptions, i.e., whether the SNR is assumed to be ﬁxed or affected by the
coupling, whether the matching network takes the coupling into account,
etc. [32]. This demonstrates once more that numerous details tend to hide
the fundamental principles behind them. A side remark is that when this
FIGURE 3.6
Linear uniform array gain vs. the number of (isotropic) elements for L = 5Q. Continuous aperture
(1D) gain is also indicated.
10 
8 
6 
4 
2 
12 
n = 2L/λ = 10 
d = λ/2 
14 
2 
4 
6 
8 
10 
12 
SNR does not 
increase here 
Gain 
N
Array 
Cont. aperture 

Information Theory and Electromagnetism: Are They Related?
75
effect is positive, smaller element spacing becomes feasible without signiﬁ-
cant capacity loss [29]. This clearly shows that practical implementation may
somewhat deviate from our idealistic theoretical analysis.* There exists, how-
ever, a ﬁnal number of degrees of freedom possessed by the electromagnetic
ﬁeld itself, which ultimately limits any practical system (with or without
mutual coupling, etc.). The way these degrees of freedom are used in practice
by realistic antennas may of course differ from what the idealistic theory
above suggests.
We should also note that applications of the sampling theorem to electro-
magnetic problems have a long history. Among others, these applications
include spatial sampling techniques in optics [33], which is electromagnetics
at very high, i.e., optical, frequencies, and also in near-ﬁeld measurements
and numerical analysis of electromagnetic ﬁelds [34]. A signiﬁcant difference,
however, with the present analysis is that, while the former deals mostly
with free-space propagation, the latter considers a (rich) scattering environ-
ment, where the advantages of MIMO systems are most pronounced (as free-
space propagation results in rank-deﬁcient channel and, hence, low capacity,
unless the Tx-Rx antenna spacing is very small). Additionally, while the
earlier applications have used the sampling theorem only as a convenient
analysis tool, when the sampling theorem is considered in the context of
MIMO systems a fundamental link with information theory becomes clear.
With respect to the minimum antenna spacing, it is interesting to note that
the MIMO capacity analysis of waveguide channels, which is based on a
rigorous electromagnetic approach and does not involve the usage of the
sampling theorem, indicates that the minimum antenna spacing is about Q/2
as well [12,14]. This is discussed in detail in the next section.
3.6
MIMO Capacity of Waveguide Channels**
The case of an ideal waveguide MIMO channel (i.e., lossless uniform
waveguide) is especially interesting because the relationship between infor-
mation theory and electromagnetics manifests itself in the clearest form in this
scenario. We further consider such a waveguide unless otherwise indicated.
Arbitrary electromagnetic ﬁelds inside of a waveguide can be presented
as a linear combination of the modes [15,16],
* While mutual coupling can have a signiﬁcant effect on antenna array pattern (especially in the
sidelobe region) even for d > Q/2, the MIMO capacity is not signiﬁcantly affected by it in that
case [28,30,31]. A possible explanation for this is that the channel matrix, which includes the
effect of mutual coupling, is known to the receiver and taken into account in the processing, and,
hence, the mutual coupling is implicitly compensated for. Consequently, most of our results for
d > Q/2 will hold true even if the effect of mutual coupling is taken into account.
** This section is based on [12,14].

76
MIMO System Technology for Wireless Communications
 
(3.27)
where En(x, y) and Hn(x, y) are the normalized modal functions of the electric
and magnetic ﬁelds, Fn and Gn are the expansion coefﬁcients (mode ampli-
tudes), kzn is the axial component of the wave vector and n is the (composite)
mode index. The modal functions En(x, y) and Hn(x, y) give the ﬁeld variation
in the transverse directions (x,y) and the variation along the axial direction
(z) is given by
. While the particular form of the modal functions
depends on the guide cross-section and may be difﬁcult to ﬁnd in explicit
form (unless some symmetry is present), an important general property of
the modal functions of a lossless cylindrical waveguide is their orthogonality
in the following sense [16],
 
(3.28)
where the integrals are over the guide cross-sectional area S, Imn = 1 if m = n
and 0 otherwise. For a given frequency, there exist a ﬁnite number of prop-
agating modes and all the other modes are evanescent, i.e., they decay
exponentially with z.
Equation 3.27 and Equation 3.28 immediately suggest the transmission
strategy for a waveguide channel, which is to use all the eigenmodes (or
simply modes) as independent subchannels since they are orthogonal, and
it is well known that the MIMO capacity is maximum for independent
subchannels. In this case, the maximum number of independent subchannels
equals the number of modes and there is no loss in capacity if all the modes
are used. For lossy and/or non-uniform waveguides, there exist some cou-
pling between the modes [16], and hence, the capacity is smaller (due to the
power loss as well as to the mode coupling). Thus, the capacity of a lossless
waveguide will provide an upper bound for a true capacity since some loss
and non-uniformity is always inevitable. It should be noted that if the cou-
pling results in the normalized mode correlation being less than approxi-
mately 0.5, the capacity decrease is not signiﬁcant [23]. We further assume
that the waveguide is lossless and is matched at both ends. Figure 3.7 shows
the system block diagram. At the Tx end, all the possible modes are excited
e
E
h
H
( , , )
( , )
( , , )
( ,
x y z
x y e
x y z
x
n
n
jk
z
n
n
n
zn
=
=

¨ F
G
y e jk
z
n
zn
)
,

¨
e jk
z
zn

E E
H H
E H
n
S
m
mn
n
m
S
mn
n
S
m
dxdy
dxdy
dxdy
µµ
µµ
µµ
=
=
=
I
I
0,,

Information Theory and Electromagnetism: Are They Related?
77
using any of the well-known techniques (i.e., eigenmode modulator) and at
the Rx end the transverse electric ﬁeld is measured on the waveguide cross-
sectional area (proper spatial sampling may be used to reduce the number
of ﬁeld sensors) and is further correlated with the distribution functions of
each mode (i.e., spatial correlation receiver). The signals at the correlator
outputs are proportional to the corresponding transmitted signals since the
modes are orthogonal, and, hence, there is no cross-coupling between differ-
ent Tx signals. Thus, the channel matrix (i.e., Tx end-Rx end-correlator out-
puts) for this system can be expressed using the modal functions (for
simplicity, we use only the E-ﬁeld — the H-ﬁeld can be used in the same
way) as follows [14]:
,
(3.29)
and, for a uniform lossless waveguide,
, where
is a N × N identity
matrix, and N is the number of modes. Clearly, the capacity achieves its
maximum (Equation 3.2) in this case. Knowing the number of modes N, the
maximum MIMO capacity can easily be evaluated. The maximum capacity
(we call it further simply “capacity”) of the present MIMO architecture
described above does not vary along the waveguide length and it increases
with the number of modes, as one would intuitively expect. If not all the
available modes are used, the capacity decreases accordingly. The capacity
may also decrease if the Rx antennas measure the ﬁeld at some speciﬁc points
rather than the ﬁeld distribution along the cross-sectional area (since the
mode orthogonality cannot be efﬁciently used in this case). In order to
evaluate the maximum capacity, we further evaluate the number of modes.
3.6.1
Rectangular Waveguide Capacity
Let us consider ﬁrst a rectangular waveguide located along the OZ axis (see
Figure 3.8). The ﬁeld distribution at the XY plane (cross-section of the
waveguide) for E and H modes is given by well-known expressions [16] and
the variation along the OZ axis is given by
, where j is an imaginary
unit, and kz is the longitudinal component of the wavenumber:
FIGURE 3.7
MIMO system architecture for a wavelength channel. (© 2005 IEEE.)
Eigenmode 
modulator 
(Tx) 
Waveguide 
Eigenmode 
demodulator 
(cor. Rx)  
... 
... 
Modes 
α2α1
α2α1
 
 
G
x y
x y dxdy
ij
i
S
j
= µµ E
E
( , ) ( , )
G
I
=
N
IN
e jk z
z


78
MIMO System Technology for Wireless Communications
(3.30)
where \ is the radial frequency, c0 is the speed of light, and m and n designate
the mode (note that E and H modes with the same (m,n) pair have the same
Lmn). The sign of kz is chosen in such a way that the ﬁeld propagates along
the OZ axis (i.e., from the Tx end to the Rx end). The case of Lmn > \/c
corresponds to the evanescent ﬁeld, which decays exponentially with z and
is negligible at a few wavelengths from the source [16]. Assuming that the
Rx end is located far enough from the Tx end (i.e., at least a few wavelengths),
we neglect the evanescent ﬁeld. Hence, the maximum value of Lmn is Lmn,max =
\/c. This limits the number of modes that exist in the waveguide at a given
frequency \. All the modes must satisfy the following inequality, which
follows from Equation 3.30:
,
(3.31)
where ae = a/Q, be = b/Q and Q is the free-space wavelength; and m n = 1, 2, …
for E mode and m, n = 0, 1, …, m + n | 0 for H mode. Using a numerical
procedure and Equation 3.31, the number of modes N can be easily evalu-
ated. A closed-form approximate expression can be obtained for large ae and
be by observing that Equation 3.31 is, in fact, an equation of ellipse in terms
of (m,n) and all the allowed (m,n) pairs are located within the ellipse. Hence,
the number of modes is given approximately by the ratio of areas:
(3.32)
where Sc = 4Uaebe is the ellipse area, S0 = 1 is the area around each (m,n) pair,
Sw = ab is the waveguide cross-sectional area, the factor 1/4 is due to the
FIGURE 3.8
Rectangular waveguide geometry. (© 2005 IEEE.)
O 
y 
z 
x 
a 
b 
Tx end 
Rx end  
k
c
m
a
n
b
z
mn
mn
=
©
«ª
¹
»º 
= ©
«ª
¹
»º + ©
\
L
L
U
U
0
2
2
2
2
,
«ª
¹
»º
2
,
m
a
n
b
e
©
«ª
¹
»º +
e
©
«ª
¹
»º
f
2
2
4
N
S
S
ab
S
e
w
~
=
=
2
4
2
2
0
2
2
/
U
Q
U
Q
,

Information Theory and Electromagnetism: Are They Related?
79
fact that only non-negative m and n are considered, and the factor 2 is due
to the contributions of both E and H modes. As Equation 3.32 demonstrates,
the number of modes is determined by the ratio of the waveguide cross-
section area ab to the wavelength squared. As we will see later on, this is
true for a circular waveguide as well. Hence, one may conjecture that this
is true for a waveguide of arbitrary cross-section as well. This conjecture
seems to be consistent with the spatial sampling argument (2D sampling
must be considered in this case). In fact, Equation 3.32 gives the number of
degrees of freedom the rectangular waveguide is able to support and which
can be used for MIMO communication. Figure 3.9 compares the exact num-
ber of modes computed numerically using Equation 3.31 and the approxi-
mate number (Equation 3.32). As one may see, Equation 3.32 is quite accurate
when a and b are greater than approximately a wavelength. Note that the
number of modes has a step-like behavior with a/Q, which is consistent with
Equation 3.31. Using Equation 3.2 and Equation 3.32, the maximum capacity
of the rectangular waveguide channel can be easily evaluated.
The analysis above assumes that the vector E-ﬁeld (including both Ex and
Ey components) is measured on the entire cross-sectional area (or at a sufﬁ-
cient number of points to recover it using the sampling expansion). However,
it may happen in practice that only one of the components is measured, or
that the ﬁeld is measured only along the OX (or OY) axis. Apparently, it
should lead to the decrease of the available modes.
To analyze this in detail, let us assume that the E-ﬁeld (both components)
is measured along the OX axis only, which corresponds to a 1D antenna
array located along the OX axis. Due to this limitation, one can compute the
correlations at the Rx using the integration over the OX axis only, since the ﬁeld
distribution along the OY axis is not known. Hence, we need to ﬁnd the
modes that are orthogonal in the following sense:
FIGURE 3.9
Number of modes in a rectangular waveguide for a=b. (© 2005 IEEE.)
10 
8 
7 
9 
6 
5 
4 
3 
2 
1 
10 
1 
100 
1000 
1D array (OX)
2D array
Exact 
Approximate 
Number of modes 
a/λ

80
MIMO System Technology for Wireless Communications
,
(3.33)
where µ and S are composite mode indices. In this case, one ﬁnds that two
different E-modes,
and
, are orthogonal provided that
; if
these modes have the same m index, they are not orthogonal. The same is true
about two H-modes and about one E-mode and one H-mode. This results
in a substantial reduction of the number of orthogonal modes since, in the
general case, two E-modes are orthogonal if at least one of the indices is
different, i.e., if
or
. Surprisingly, if one measures only Ex
component in this case, the modes are still orthogonal provided that
.
Hence, if the receive antenna array is located along the OX axis, there is no
need to measure the Ey component — it does not provide any additional
degrees of freedom that can be used for MIMO communications (recall that
only orthogonal modes can be used). The number of orthogonal modes can
be evaluated using Equation 3.31:
(3.34)
This corresponds to 2a/Q degrees of freedom for each (E and H) ﬁeld. Note
that this result is similar to that obtained using the spatial sampling argu-
ment, i.e., independent ﬁeld samples (which are, in fact, the degrees of
freedom) are located at Q/2.
A similar argument holds true when the receive array is located along the
OY axis. In this case two modes are orthogonal provided that
, and
there is also no need to measure the Ex component. The number of orthogonal
modes is approximately
(3.35)
Figure 3.10 shows the MIMO capacity of a rectangular waveguide of the
same geometry as in Figure 3.8 for SNRW = 20 dB. Note that the capacity
saturates as a/Q increases. This is because Equation 3.2 saturates as well as
N increases:
.
(3.36)
C in Equation 3.2 can be expanded as
.
(3.37)
I
dx
c
a
=
=
µ E E
µ
S
µS
I
0
Em n
1 1
Em n
2 2
m
m
1
2
|
m
m
1
2
|
n
n
1
2
|
m
m
1
2
|
N
a
x ~ 4 /Q.
n
n
1
2
|
N
b
y ~ 4 /Q.
lim
ln
N
C
qh
= W/
2
C
i
N
i
i
i
=

+
©
«ª
¹
»º
=
h
¨
W
W
ln
(
)
2
1
1
0

Information Theory and Electromagnetism: Are They Related?
81
For large N, i.e., for small W/N, this series converges very fast, and it can
be approximated by the ﬁrst two terms:
.
(3.38)
The capacity does not change substantially when the contribution of the
second term is small:
.
(3.39)
Nmax is the maximum “reasonable” number of antennas (modes) for given
SNR (or vice versa): if N increases above this number, the capacity does not
increase signiﬁcantly. It may be considered as a practical limit (since further
increase in capacity is very small and it requires for very large increase in
complexity). Using Equation 3.32 and Equation 3.34, one ﬁnds the maximum
“reasonable” size of the waveguide for the case of 2D and 1D arrays corre-
spondingly:
 
(3.40)
Note that Figure 3.10 shows, in fact, the fundamental limit of the
waveguide capacity, which is imposed jointly by the laws of information
theory and electromagnetics.
FIGURE 3.10
MIMO capacity in a rectangular waveguide for a=b and SNR=20 dB. (© 2005 IEEE.)
10 
9 
8 
7 
6 
5 
4 
3 
2 
1 
20 
40 
60 
80 
100 
120 
140 
1D array(OX)
2D array
Exact 
Approximate 
Limit(36) 
Capacity, bit/s/Hz 
a/λ
C
N
~

©
«ª
¹
»º
W
W
ln 2 1
2
W
W
2
1
N
N
N
<<
¡
>
~
max
a
a
max
max
Q
W
U
Q
W
~
~
2
4
(2D array),
(1D OX arrayy).

82
MIMO System Technology for Wireless Communications
3.6.2
Rectangular Cavity Capacity
The analysis of MIMO capacity in cavities is different from that in
waveguides in one important aspect. Namely, the modes of a cavity exist
only for some ﬁnite discrete set of frequencies (recall that, as in the case of
waveguide, we consider a lossless cavity). Hence, there may be no modes
for an arbitrary frequency. To avoid this problem, we evaluate the number
of modes for a given bandwidth,
, starting at f0. For a rectan-
gular cavity, the wave vector must satisfy [16]:
(3.41)
where c is the waveguide length (along the OZ axis in Figure 3.8), and p is
a non-negative integer; m, n = 1, 2, 3, …, p = 0, 1, 2, … for E-modes, and m,
n = 0, 2, 3, …, p = 1, 2, … for H-modes (m = n = 0 is not allowed). Noting
that Equation 3.41 is a equation of a sphere in terms of (Um/a, Un/b, Up/c),
the number of modes with
can be found as the number of
(m,n,p) points between two spheres with radii of k0 and k0 + )k, correspond-
ingly. Using the ratio of areas approach described above, the number of
modes is approximately:
(3.42)
where
is the volume between the two spheres, V0 = U3/Vc is the
volume around each (m,n,p) point, Vc = abc is the cavity volume; factor 2 is
due to two types of modes, and factor 1/8 is due to the fact that only non-
negative values of (m,n,p) are allowed. An important conclusion from Equa-
tion 3.42 is that the number of modes is determined by the cavity volume
expressed in terms of wavelength and by the normalized bandwidth.
Detailed analysis shows that Equation 3.42 is accurate for large a, b, and c,
and if c/Q < f0/4)f.
It should be noted that the mode orthogonality for cavities is expressed
through the volume integral (over the entire waveguide volume),
,
(3.43)
and, hence, all the modes are orthogonal provided that the ﬁeld is measured
along all three dimensions, which, in turn, means that 3D arrays must be
used, which may not be feasible in practice. If only 2D arrays are used, then
the mode orthogonality is expressed as for a waveguide, i.e., Equation 3.28,
and, consequently, only those modes are orthogonal that have different (m,n)
f
f
f
f
¬®
¼¾
0
0
,
+ )
k
m
a
n
b
p
c
c
2
2
2
2
0
= ©
«ª
¹
»º + ©
«ª
¹
»º + ©
«ª
¹
»º = ©
«ª
¹
U
U
U
\
»º
2
,
k
k
k
k
¬®
¼¾
0
0
,
+ )
N
V
V
V
f
f
c
e
c
~
=
2
8
8
0
3
0
/
U
Q
) ,
V
k
k
e = 4
2
U
)
E E
µ
S
µS
I
Vc
dV
c
µµµ
=

Information Theory and Electromagnetism: Are They Related?
83
indices. The use of a 2D array results in signiﬁcant reductions of the number
of modes for large c, as Figure 3.11 demonstrates. Note that for small c, there
is no loss in the number of orthogonal modes. This is because different p
corresponds in this case to different (m,n) pairs (this can also be seen from
Equation 3.41). However, as c increases, different p may include the same
(m,n) pairs, which results in the number loss if a 2D array is used. In fact,
the 2D case with large c is the same as the waveguide case (with the same
cross-sectional area), as it should be. The value of c for which the cavity has
the same number of orthogonal modes as the corresponding waveguide can
be found from the following equality:
.
(3.44)
Hence, if 2D antenna arrays are used and c v ct, the waveguide model
provides approximately the same results as the cavity model does, i.e., the
cross-section has the major impact on the capacity, while the effect of cavity
length is negligible. The waveguide model should be used to evaluate the
number of orthogonal modes (and capacity) in this case because it is simpler
to deal with. For example, a long corridor can be modeled as a waveguide
rather than a cavity (despite the fact that it is closed and looks like a cavity).
Figure 3.12 shows the MIMO capacity in the cavity. While the capacity of a
2D array system saturates like the waveguide capacity, which is limited by a
and b, the capacity of a 3D system is larger and saturates at the value given
by Equation 3.36. It should be noted that Equation 3.36 is the capacity limit
due to the information theory laws, and Equation 3.32, Equation 3.34, Equation
3.35 and Equation 3.44 are the capacity limits due to the laws of electromag-
netism (i.e., limited due to the number of degrees of freedom of the EM ﬁeld).
FIGURE 3.11
Number of orthogonal modes in a rectangular cavity for a = 4Q, b = 2Q and )f/f0 = 0.2.
10 
9 
8 
7 
6 
5 
4 
3 
2 
1 
10 
20 
40 
60 
80 
100 
200 
400 
2D
3D
Exact(3D)
Approximate(3D)
Exact(2D)
Waveguide(2D)
Number of modes 
c/λ
N
N
c
f
f
c
w
t
~
¡
=
Q
0
4)

84
MIMO System Technology for Wireless Communications
3.7
Spatial Capacity of Waveguide Channels
While the maximum in Equation 3.9 is difﬁcult to ﬁnd in general since one
of the constraints is a partial differential equation with an arbitrary boundary
condition, it can be found in an explicit closed form for some waveguide
channels. Consider, for example, a lossless uniform waveguide. Using Equa-
tion 3.27, we conclude that (i) the optimizations over
and
can be car-
ried out separately (since they are independent of each other) and (ii) the
optimization over
is equivalent to optimization over
(since the expan-
sion coefﬁcients determine the ﬁeld uniquely). When the Tx does not know
the channel,
is i.i.d. complex Gaussian because (i) the channel is AWGN
and Gaussian distribution maximizes the entropy, and (ii) the lack of the
channel knowledge at the Tx forces the covariance of
to be the identity
matrix, i.e., no “preferred direction” in the eigenspace (see [2] for more
details),
and the capacity is given by Equation 3.1 [2].
Further optimization of Equation 3.9 over
subject to
results
in
and the channel correlation matrix
, i.e., all the modes
are independent and carry the same power. Hence, all the capacity results
above give, in fact, the spatial capacity, i.e., the maximum capacity limited
by the laws of electromagnetics. One may say that the spatial capacity con-
cept encompasses the limits in information transmission due to both the
information theory and electromagnetics.
When there is mode coupling and, additionally, different modes experience
different attenuation (e.g., lossy waveguide with different Li), one has to
FIGURE 3.12
Capacity in a rectangular cavity for a = 4Q, b = 2Q and )f/f0 = 0.2.
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
20 
40 
60 
80 
100 
120 
140 
2D array
3D array
Exact 
Approximate 
Limit(36) 
Capacity, bit/s/Hz 
c/λ
p( )
x
E
E
Fn
x
x
p
CN
P
n
T
T
( )
( ,
/
)
x
0
I
=
Fn
tr
nT
(
)
GG+ =
Fn = 1
R
GG
I
=
=
+

Information Theory and Electromagnetism: Are They Related?
85
consider generic correlation matrix
. The optimum power allocation in
the mode eigenspace can be found by applying the water-ﬁlling solution
[14] to the eigenvalues Qi of R,
,
(3.45)
where
and 0 otherwise, and
is chosen to satisfy the power
constraint,
.
(3.46)
Fi is large for large eigenvalues, and small or even zero (i.e., no transmis-
sion on the eigenmode) for small Qi. Without loss of generality, we further
assume that Q1 v Q2 v … v QnT. Two important conclusions follow from
Equation 3.45 and Equation 3.46 [14]. In the large SNR mode,
,
all the eigenmodes carry approximately the same power (Fi ~ 1). We also
note that the same solution applies when all the eigenvalues are equal, Qi =
, regardless of the SNR. In the small SNR regime, W f 1/Q2 –
1/Q1, all the power is allocated to the largest eigenmode, F1 = nT, 
.
From this, we conclude that the traditional transmission strategy (i.e., using
a single dominant mode only) is optimum in the small SNR regime only.
For large SNR, the best strategy is to use all the modes. In all the other cases,
between these two extremes, several dominant modes should be used, the
exact number being determined by the available SNR and by the eigenvalues
Qi.
Remarkably, this insight requires a joint application of electromagnetic and
information-theoretic techniques. It is expected that an efﬁcient design of
eigenmode modulators and demodulators (see Figure 3.7) will also call for
signiﬁcant uniﬁcation of these two presently unrelated areas of research.
3.8
Acknowledgments
The authors would like to acknowledge numerous insightful discussions
with C. Charalambous, A. Kouki, A. Molisch, I.E. Telatar, D. McNamara and
also the colleagues within the European projects COST 273 and 284.
R
I
|
F
S
Q
W
i
i
T
n
=

¬
®
­
¼
¾
½

+
1
( )
x
x
x
+ =
v
if
0
S
S
Q
W

¬
®
­
¼
¾
½ =

+
¨
i
T
i
T
n
n
1
W
Q
>> nT
nT
/
Q
F
q
= 
i
i
1
Fi
i
=  |
0
1

86
MIMO System Technology for Wireless Communications
References
1. G.J. Foschini and M.J Gans. 1998. “On limits of wireless communications in a
fading environment when using multiple antennas,” Wireless Personal Commu-
nications, Vol. 6, No. 3, March 1998, pp. 311–335.
2. I.E. Telatar. 1995. “Capacity of multi-antenna Gaussian channels,” AT&T Bell
Lab. Internal Tech. Memo., June 1995 (European Trans. Telecom., Vol. 10, No. 6,
Dec. 1999).
3. D. Gesbert et al. 2003. “From theory to practice: an overview of MIMO space-
time coded wireless systems,” IEEE Journal on Selected Areas in Communications,
Vol. 21, No. 3, April 2003, pp. 281–302.
4. A. Paulraj, R. Nabar, and D. Gore. 2003. Introduction to Space-Time Wireless
Communications, Cambridge: Cambridge University Press.
5. A.M. Sayeed. 2002. “Deconstructing multiantenna fading channels,” IEEE
Trans. Signal Processing, Vol. 50, No. 10, Oct. 2002, pp. 2563–2579.
6. H. Bolcskei et al. 2002. “On the capacity of OFDM-based spatial multiplexing
systems,” IEEE Trans. Communications, Vol. 50, No. 2, Feb. 2002, pp. 225–234.
7. D. Chizhik, G.J. Foschini, and R.A. Valenzuela. 2000. “Capacities of multi-
element transmit and receive antennas: correlations and keyholes,” Electronics
Letters, Vol. 36, No. 13, June 22, 2000, pp. 1099–1100.
8. S. Loyka and G. Tsoulos, “Estimating MIMO system performance using the
correlation matrix approach,” IEEE Communication Letters, Vol. 6, No. 1, Jan.
2002, pp. 19–21.
9. S.L. Loyka and J.R. Mosig. 2000. Spatial Channel Properties and Spectral Efﬁ-
ciency of BLAST Architecture, AP2000 Millennium Conference on Antennas &
Propagation, Davos, Switzerland, April 9–14, 2000.
10. S. Loyka. 2002. MIMO Channel Capacity: Electromagnetic Wave Perspective,
27th General Assembly of the International Union of Radio Science, Maastricht,
the Netherlands, Aug. 17–24, 2002.
11. S.L. Loyka. 2003. On MIMO Channel Capacity, Spatial Sampling and the Laws
of Electromagnetism, the 3rd IASTED International Conference on Wireless
and Optical Communications (WOC 2003), Banff, Alberta, Canada, July 14–16,
2003, pp. 132–137.
12. S.L. Loyka. 2003. “Multi-antenna capacities of waveguide and cavity channels,”
IEEE CCECE’03, Montreal, May 2003.
13. S. Loyka. 2004. Information Theory and Electromagnetism: Are They Related?
(Invited paper), the Joint COST 273/284 Workshop on Antennas and Related
System Aspects in Wireless Communications, Chalmers University of Technol-
ogy, Gothenburg, Sweden, June 2004.
14. S.L. Loyka. 2005. “Multi-antenna capacities of waveguide and cavity channels,”
IEEE Trans. Vehicular Technology, Vol. 54, No. 3, May 2005, pp. 863–872.
15. E.D. Rothwell and M.J. Cloud. 2001. Electromagnetics, Boca Raton, FL: CRC
Press.
16. R.E. Collin. 1991. Field Theory of Guided Waves, New York: IEEE Press.
17. J.D. Gibson, ed. 2002. The Communications Handbook, Boca Raton, FL: CRC Press.
18. S.R. Saunders. 1999. Antennas and Propagation for Wireless Communication Sys-
tems, Chichester, U.K.: Wiley.

Information Theory and Electromagnetism: Are They Related?
87
19. A.J. Jerry. 1977. The Shannon sampling theorem — its various extensions and
applications: a tutorial review, Proc. IEEE, Vol. 65, No. 11, Nov. 1977,
pp. 1565–1596.
20. Y.I. Khurgin and V.P. Yakovlev. 1977. “Progress in the Soviet Union on the
theory and applications of bandlimited functions,” Proc. IEEE, Vol. 65, No. 7,
July 1977, pp. 1005–1029.
21. D.P. Petersen and D. Middleton. 1962. “Sampling and reconstruction of wave-
number-limited functions in N-dimensional Euclidean spaces,” Information and
Control, Vol. 5, 1962, pp. 279–323.
22. W.C. Jakes, Jr. 1974. Microwave Mobile Communications, New York: John Wiley &
Sons.
23. S.L. Loyka. 2001. “Channel capacity of MIMO architecture using the exponen-
tial correlation matrix,” IEEE Communication Letters, Vol. 5, No. 9, Sep 2001,
pp. 369–371.
24. T.S. Pollock et al. 2003. “Antenna saturation effects on dense array MIMO
capacity,” IEEE ICASSP 2003.
25. J.W. Wallace and M.A. Jensen. 2002. “Intrinsic capacity of the MIMO wireless
channel,” IEEE VTC (Fall), Sept. 24–28, 2002.
26. R.C. Johnson. 1993. Antenna Engineering Handbook, New York: McGraw Hill.
27. D.H. Johnson and D.E. Dudgeon. 1993. Array Signal Processing, Upper Saddle
River, NJ: Prentice Hall.
28. J.W. Wallace and M.A. Jensen. 2004. “Mutual coupling in MIMO wireless sys-
tems: a rigorous network theory analysis,” IEEE Trans. Wireless Commun., Vol. 3,
No. 4, July 2004, pp. 1317–1325.
29. V. Jungnickel, V. Pohl, and C. von Helmolt. 2003. “Capacity of MIMO systems
with closely spaced antennas,” IEEE Communications Letters, Vol. 7, No. 8, Aug.
2003, pp. 361–363.
30. R. Janaswamy. 2002. “Effect of element mutual coupling on the capacity of
ﬁxed length linear arrays,” IEEE Antennas and Wireless Propagation Letters, Vol. 1,
2002, pp. 157–160.
31. P.S. Kildal and K. Rosengren. 2004. “Correlation and capacity of MIMO systems
and mutual coupling, radiation efﬁciency, and diversity gain of their antennas:
simulations and measurements in a reverberation chamber,” IEEE Communica-
tions Magazine, Vol. 42, No. 12, Dec. 2004, pp. 104–112.
32. M.K. Ozdemir, H. Arslan and E. Arvas. 2003. “Mutual coupling effect in multi-
antenna wireless communication systems,” IEEE Globecom., pp. 829–833.
33. F. Gori. 1993. “Sampling in optics,” in Advanced Topics in Shannon Sampling and
Interpolation Theory, R.J. Marks II, ed., New York: Springer-Verlag.
34. T.B. Hansen and A.D. Yaghjian. 1999. Plane-Wave Theory of Time-Domain Fields,
New York: IEEE Press.
35. A.I. Zayed. 1993. Advances in Shannon’s Sampling Theory, Boca Raton, FL: CRC
Press.
36. D. Slepian. 1976. “On bandwidth,” Proc. IEEE, Vol. 64, No. 3, pp. 292–300.


89
4
Introduction to Space–Time Coding
Antonis D. Valkanas and Alexander D. Poularikas
CONTENTS
4.1
Introduction ..................................................................................................89
4.2
MIMO System and Space–Time Coding..................................................90
4.2.1
MIMO System and Capacity.........................................................90
4.2.2
Methodologies and Diversity........................................................92
4.3
Space–Time Block Codes............................................................................94
4.3.1
Alamouti’s Transmit Technique....................................................94
4.3.2
Orthogonal Space–Time Block Codes..........................................96
4.4
Space–Time Trellis Codes...........................................................................98
4.4.1
Encoding and Decoding.................................................................98
4.4.2
Performance Analysis and Code Design...................................101
4.5
Spatial Multiplexing..................................................................................103
4.5.1
V-BLAST Algorithm......................................................................105
4.6
Space–Time Coding with CSI Knowledge at the Transmitter ...........107
4.7
Other Space–Time Coding Schemes....................................................... 110
References............................................................................................................. 110
Acronyms ............................................................................................................. 111
4.1
Introduction
The explosion of wired and wireless telecommunication systems marked the
end of the second millennium. The number of subscribers to the Internet or
to a second-generation mobile network has increased exponentially. Hence,
the users of both systems have augmented expectations in services and
capacity. For wireless communication systems, a novel direction proposed
to resolve capacity requirements in the challenging radio environment is the
exploitation of Multiple Element Array (MEA) at both transmitter and

90
MIMO System Technology for Wireless Communications
receiver sides. Wireless systems with antenna elements at both edges are
referred to in the literature as Multiple Input Multiple Output (MIMO)
systems in contrast to Single Input Single Output (SISO) antenna systems
that have one transmit and one receive antenna. Following this classiﬁcation,
a system with one transmit antenna and several receive antennas is denoted
as Single Input Multiple Output (SIMO) system while several transmit anten-
nas and one receive antennas designate a Multiple Input Single Output
(MISO) system. In order to include the case where the transmitter and/or
receiver antenna elements are not located in the same devices, MIMO sys-
tems are referred to as Multiple Transmitters Multiple Receivers (MTMR).
In this chapter, we introduce some general concepts about the signal pro-
cessing used in MIMO systems, which is commonly called Space–Time Coding
(STC) or Space–Time Processing (STP). In the ﬁrst part of this chapter, we
describe the MIMO system model and formulate the general expression of
the capacity of a MIMO system. We also present exploitation methodologies
of this capacity and a classiﬁcation of STCs. The next subsection describes
the simplest class of STCs, i.e., Space–Time Block Codes (STBCs). Space–Time
Trellis Codes (STTCs) that provide diversity and coding gain at the same
time are analyzed next. Then, spatial multiplexing methods are tackled
through the description of the Vertical Bell Laboratories Architecture
Space–Time (V-BLAST) algorithm. Exploitation of the channel capacity in
the case where channel state information is available at the transmitter side
is brieﬂy introduced in the following subsection. We conclude this chapter
by mentioning different interesting space–time coding schemes that appear
in the literature but which detailed description surpasses the scope of this
chapter.
4.2
MIMO System and Space–Time Coding
4.2.1
MIMO System and Capacity
A MIMO system with MT transmit antennas and MR receive antenna is
shown in Figure 4.1. From the ﬁgure, it seems that space–time coding is
charged to perform serial-to-parallel and parallel-to-serial conversion of the
transmitted information data. The block responsible for the serial-to-parallel
transformation at the transmitter is the Space–Time Encoder. The opposite
operation, i.e., the parallel-to-serial conversion, is performed in the Space–
Time Decoder at the receiver side. However, space–time coding is more than
these transformations, since these codes can realize at the same time several
communication processes such as channel encoding/decoding, modulation/
demodulation, multiplexing/demultiplexing or equalization.
The transmitted symbols are noted by xi, with the subscript index i taking
integers with non-zero values up to MT. Similarly, the received signals are

Introduction to Space–Time Coding
91
marked by rj with j taking values from 1 to MR. Based on this notation, the
channel transfer function from the ith transmit antenna to the jth receive
antenna are denoted by hj,i. In order to have a MIMO system comparable to
a SISO system, the sum of the transmitted powers of all antennas MT must
be equal to the transmitted power of a SISO system denoted P. Hence, the
transmitted power from each antenna is P/MT. Additionally, the normaliza-
tion of the channel coefﬁcient must be such that at each receive antenna j
the sum of channel gains of all transmit antennas to receive antenna j is
equal to the number of transmit antennas, i.e., MT. The Additive White
Gaussian Noise (AWGN) components are added to each receive antenna and
are designated by nj, with j being an index taking values from 1 to MR. The
AWGN components are assumed identically and independently distributed.
The MIMO system can be described in a matrix form, using the previous
notations, as follows:
(4.1)
FIGURE 4.1
Block diagram of a MIMO system.
n1
n2
nMT
h1,1
h2,1
hMR,1
h2,1
h2,2
hMR,2
h1,MT
h2,MT
hMR,MT
Space-time
encoder
Space-time
decoder
r
h
x
n
r
h
x
n
r
i
i
i
M
i
i
i
M
M
T
T
R
1
1
1
1
2
2
1
2
=

+
=

+
=
=
=
¨
¨
,
,

h
x
n
R
H X
N
r
M
i
i
i
M
M
R
T
R
, 
+
¿
À
²
²
²
²
²
Á
²
²
²
²
²
¡
=

+
¡
=¨
1
1
r
r
h
h
h
h
h
M
M
R
T
2
1 1
1 2
1
2 1
2


¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
=
,
,
,
,
,22
2
1
2






h
h
h
h
M
M
M
M
M
T
R
R
R
T
,
,
,
,
¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½

¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
+
¬
®
­
­
­
­
­
¼
¾
½
x
x
x
n
n
n
M
M
T
R
1
2
1
2


½
½
½
½
.

92
MIMO System Technology for Wireless Communications
In Equation 4.1, R is a column vector MR × 1 composed of the received
signals rj, X is a column vector MT × 1 composed of the transmit constellation
points xi, N is a column vector MR × 1 composed of the noise components
nj, and H is a MR × MT matrix with jith component being the channel coef-
ﬁcient hj,i.
It has been demonstrated in [1] that MIMO systems provide tremendous
capacity. When Channel State Information (CSI) is not available at the trans-
mitter, the capacity of a MIMO system expressed in bits per second per hertz
(bps/Hz) can be written as:
(4.2)
In Equation 4.2, IMR is the identity matrix of size MR×MR, H is the channel
matrix of size MR × MT with HT being its transpose conjugate, and W gives
the average Signal-to-Noise Ratio (SNR) per receiver branch independent of
the number of transmitting antennas MT.
4.2.2
Methodologies and Diversity
Two methodologies have been developed to exploit the capacity offered by
the presence of several transmit and receive antennas in a telecommunication
system.
The ﬁrst method exploits the additional diversity of multiple antennas,
namely spatial diversity, to combat channel fading. This method is perfor-
mance oriented. It targets improving the reliability of the link, which can be
achieved by the transmission and reception of several replicas of the same
information through independent fading paths and, hence, reduces the prob-
ability of simultaneous signal fades. The provision of replicas of the same
information at the receiver is referred to as diversity. The number of inde-
pendent receptions of the same information at the receiver is deﬁned as the
“diversity order” or the “diversity gain” of the system. In a MIMO system,
the transmit and receiver antennas form MT×MR independent radio links
and, hence, can provide a maximum or full diversity gain equal to this
product. Diversity techniques are particularly interesting in the case of a
severely rich fading environment, but the targeted transmitted rate is equiv-
alent to that of a SISO system. In other words, the additional antennas of
the MIMO system are used to support the transmission of a SISO system.
Diversity methods are traditionally used in Base Stations (BS). In the down-
link, the BS transmits from two or more antennas, while in the uplink the
BS receives information via several receive antennas. The diversity approach
is particularly important for systems having a relatively small number of
transmit antennas that operate at low SNR values. A major drawback of a
C
I
M
H H
M
T
T
R
=
+


©
«ª
¹
»º
¬
®
­
¼
¾
½
log
det
bps
.
2
W
/Hz

Introduction to Space–Time Coding
93
MIMO system is that the transmitted signals from distinct antennas must be
decorellated, and hence, the antenna elements must be sufﬁciently separated.
It has been shown in the literature that the spacing between antenna elements
must exceed half the wavelength of the transmitted signals. In practice, the
spading exceeds by three and even ten times the signal’s wavelength. There-
fore, the diversity schemes are popular to mobile/portable devices that have
size limitations.
In MIMO systems that target maximizing the transmission and reception
diversity, the channel coding is named according to the domains where
diversity is applied. Usually, diversity is applied to two or more domains.
Hence, we have Space–Time (ST) coding, Space–Frequency (SF) coding and
Space–Time–Frequency (STF) coding. Those coding techniques can be visu-
alized in the three-dimensional plane as shown in Figure 4.2.
The methodology described previously is suboptimal for MIMO systems
with a large number of transmit antennas when operating at high SNR
regimes. Since the capacity of a MIMO system increases according to the
number of antennas, this capacity augmentation can be exploited differently
for MIMO systems that have no limitations on the number of antennas. There
are other methods to exploit the capacity of a MIMO system, which are
throughput oriented. In this case, the target of the system is to transfer the
maximum possible information data. These techniques are particularly inter-
esting for the case of a Line of Sight (LOS) environment, where the channels
have practically no fading. This approach is known as Spatial Multiplexing
(SM) or Layer Space–Time (LST). The number of extra degrees of freedom
available for communication in a MIMO system is then equal to the mini-
mum between the number of transmit antennas and the number of receive
antennas.
Several efforts have been made recently in the literature to combine the
two methods described in this section. Some hybrid encoding schemes have
been suggested. A tradeoff between diversity and multiplexing has been
presented in [2].
FIGURE 4.2
Diversity exploitation in MIMO systems in three domains.
Time
Frequency
Spatial
Time
Frequency
Spatial
Time
Frequency
Spatial

94
MIMO System Technology for Wireless Communications
4.3
Space–Time Block Codes
Space–Time Block Codes (STBCs) are the simplest type of spatial temporal
codes that exploit the diversity offered in systems with several transmit
antennas. In 1998, Alamouti designed a simple transmission diversity tech-
nique for systems having two transmit antennas [3]. This method provides
full diversity and requires simple linear operations at both transmission and
reception side. The encoding and decoding processes are performed with
blocks of transmission symbols. Alamouti’s simple transmit diversity scheme
was extended in [4] and [5] thanks to the theory of orthogonal designs for
larger numbers of transmit antennas. These codes are referred to in the
literature as Orthogonal Space–Time Block Codes (OSTBCs). In this section,
we initially describe the simple Alamouti’s scheme. A brief overview of STBC
based on orthogonal design is given next.
4.3.1
Alamouti’s Transmit Technique
Historically, the transmit diversity technique proposed by Alamouti was the
ﬁrst STBC. The encoding and decoding operation is carried out in sets of
two modulated symbols. Hence, the information data bits are ﬁrst modulated
and mapped into their corresponding constellation points. Therefore, let us
denote by x1 and x2 the two modulated symbols that enter the space–time
encoder. Usually, in systems with only one transmit antenna, these two
symbols are transmitted at two consecutive time instances t1 and t2. The
times t1 and t2 are separated by a constant time duration T. In the Alamouti
scheme, during the ﬁrst time instance, the symbol x1 and x2 are transmitted
by the ﬁrst and the second antenna element, respectively. During the second
time instance t2, the negative of the conjugate of the second symbol, i.e., –x2
*,
is sent to the ﬁrst antenna while the conjugate of the ﬁrst constellation point,
i.e., x1
*, is transmitted from the second antenna. The encoding operation is
described in the Table 4.1. The transmission rate is equal to the transmission
rate of a SISO system.
The space–time encoding mapping of Alamouti’s two-branch transmit
diversity technique can be represented by the coding matrix:
(4.3)
In the coding matrix X1, the subscript index gives the transmit rate com-
pared to a SISO system. For Alamouti’s scheme, the transmission rate is 1.
The rows of the coding matrix represent the transmit antennas while its
columns correspond to different time instances.
X
x
x
x
x
1
1
2
2
1
=

¬
®
­
¼
¾
½
*
* .

Introduction to Space–Time Coding
95
An example of the space–time encoding process is schematically shown
in Figure 4.3. The two modulated symbols are selected from a Quadrature
Phase Shift Keying (QPSK) constellation. Their representation in the complex
plane is depicted in the ﬁgure. The transmitted symbols from the two anten-
nas are sketched to the right side of the ﬁgure.
The decoding operation assumes that the fading channel coefﬁcients dur-
ing the two consecutive transmission time periods, t1 and t2, are to remain
constant. In other words, the channel coefﬁcients from the ﬁrst antenna to
the jth receiver antenna hj,1 and those from the second antenna to the jth
receiver antenna hj,2 must satisfy the following set of equations:
(4.4)
The received signals at receiver antenna j during the two time instances
are rj
1 and rj
2. The received signals satisfy the equations:
(4.5)
TABLE 4.1
Encoding of the Alamouti’s 
Transmit Diversity Scheme.
Antenna 1
Antenna 2
Time t1
x1
x2
Time t2
–x2
*
x1
*
FIGURE 4.3
An example of the Alamouti’s encoding process for QPSK.
00
01
11 
10 
00
01
11 
10 
x2
x1
0100
Antenna 1 
Antenna 2 
x1
x2
x1∗ 
−x2∗
t1
t2
t1
t2
h
h
t
h
t
T
h
t
h
t
h
j
j
j
j
j
j
,
,
,
,
,
,
1
1
1
1
1
1
2
=
( ) =
+
(
) =
( ) =
( )
2
2
2
2
1
2
2
=
( ) =
+
(
) =
( ) =
( )
h
t
h
t
T
h
t
h
t
j
j
j
j
,
,
,
,
.
r
h
x
h
x
n
r
h
x
h
x
j
j
j
j
j
j
j
1
1
1
2
2
1
2
1
2
2
=

+

+
= 

+

,
,
,
*
,
11
2
*
.
+ nj

96
MIMO System Technology for Wireless Communications
In Equation 4.5, the Additive White Gaussian Noise (AWGN) components
added at each receiver antenna element j during the transmission time
instances t1 and t2, are denoted nj
1 and nj
2, respectively.
The decoding process is simple and requires signal combining and a max-
imum likelihood decoding. The combiner block performs elementary linear
operations such as additions, multiplications and conjugate transformations
of the received signals. However, the fading channel coefﬁcients are consid-
ered perfectly known at the receiver. The fading components can be recovered
at the receiver side through commonly known procedures, such as pilot
training sequences. The processing of the linear combiner and the signals
fed to the maximum likelihood decoder are given in the following equations:
(4.6)
We notice that the decision statistics are composed by an ampliﬁcation of
the transmitted signals and a noise component. The signal ampliﬁcation is
equal to the sum of the amplitudes of all channel coefﬁcients. The noise
component is a sum of the receiver antenna noises multiplied by channel
fading components.
4.3.2
Orthogonal Space–Time Block Codes
The transmit diversity scheme designed by Alamouti can be used only in a
system with two transmit antennas. It turns out that this technique belongs
to a general class of codes named Space–Time Block Codes or, more precisely,
Orthogonal STBCs, since they are based on the theory of orthogonal designs.
The authors of [4] introduced the theory of generalized orthogonal designs
in order to create codes for an arbitrary number of transmit antennas.
The general idea behind STBCs construction is based on ﬁnding coding
matrices X that can satisfy the following condition:
(4.7)
In this equation, XH is the Hermitian of X, p is a constant, IMT is the identity
matrix of size MT × MT, MT represents the number of transmit antennas, and
n is the number of symbols xi transmitted per transmission block in X. The
x
h
r
h
r
h
x
j
j
j
j
j
M
j i
j
R
1
1
1
2
2
1
2
1
=

+
( )
{
} =

=¨
,
*
,
*
,
=
=
=
¨
¨
¨
+

+
( )
{
}
1
1
2
1
1
2
2
1
M
i
j
j
j
j
j
M
R
R
h
n
h
n
x
,
*
,
*
2
2
1
1
2
1
2
2
=


( )
{
} =

=
=
¨ h
r
h
r
h
x
j
j
j
j
j
M
j i
j
R
,
*
,
*
,
1
1
2
2
1
1
2
1
M
i
j
j
j
j
j
M
R
R
h
n
h
n
¨
¨
¨
=
=
+


( )
{
}
,
*
,
*
.
X X
p
x
I
H
i
i
n
MT

=

©
«
ªª
¹
»
ºº 
=¨
2
1
.

Introduction to Space–Time Coding
97
generalized theory of orthogonal design is exploited to provide codes that
satisfy Equation 4.7.
The orthgonality property of STBCs is reﬂected in the fact that all rows of
X are orthogonal to each other. In other words, the sequences transmitted
from two different antenna elements are orthogonal to each other for each
transmission block.
For real signal, it is possible to reach full rate. However, it has been proven
in [4] that this statement is false for two-dimensional constellations, i.e.,
complex signals. The encoding and decoding approaches follow the pattern
described in Alamouti’s scheme.
For complex signals, the theory of orthogonal designs can be used to
generate coding matrices that achieve a transmission rate of 1/2 for the cases
of 3 and 4 transmission antennas:
(4.8)
(4.9)
Using the theory of orthogonal design to construct STBCs is not necessarily
the optimal approach. There exist some sporadic STBCs mentioned in the
literature, [6–8], that can provide a transmission rate of 3/4 for schemes of
either 3 or 4 transmit antennas.
(4.10)
(4.11)
It is important to notice that the channel coefﬁcients must remain constant
during the transmission of a block of coded symbols X.
X
x
x
x
x
x
x
x
x
x
x
x
x
x
x
1 2
1
2
3
4
1
2
3
4
2
1
4
3
2
=







*
*
*
*
*
1
4
3
3
4
1
2
3
4
1
2
*
*
*
*
*
*
*
,
x
x
x
x
x
x
x
x
x
x



¬
®
­
­
­
¼
¾
½
½
½
X
x
x
x
x
x
x
x
x
x
x
x
x
x
x
1 2
1
2
3
4
1
2
3
4
2
1
4
3
2
=







*
*
*
*
*
1
4
3
3
4
1
2
3
4
1
2
4
3
2
1
4
*
*
*
*
*
*
*
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x




*
*
*
*
.
x
x
x
3
2
1

¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
X
x
x
x
x
x
x
x
x
x
3 4
1
2
3
2
1
3
3
1
2
0
0
0
=



¬
®
­
­
­
¼
¾
½
½
*
*
*
*
*
* ½
,
X
x
x
x
x
x
x
x
x
x
x
x
x
3 4
1
2
3
1
3
2
2
3
1
3
2
1
0
0
0
0
=




¬
*
*
*
*
*
*
®
­
­
­
­
­
¼
¾
½
½
½
½
½
.

98
MIMO System Technology for Wireless Communications
The decoding of the STBCs described above can be easily deduced from
the encoding matrix. Let us assume that we wish to estimate symbols xp and
that we have deﬁned by rj
k the received signal from antenna j at time instance
k. The values to be added at the linear combiner are: 
•
+(hj,i)* rj
k if we have xp at column k and line (transmit antenna) i of X
•
(hj,i)* rj
k if we have xp at column k and line (transmit antenna) i of X
•
+hj,i (rj
k)* if we have (xp)* at column k and line (transmit antenna) i
of X
•
hj,i (rj
k)* if we have (xp)* at column k and line (transmit antenna)
i of X
The linear combiner sum is realized for all receive antennas j.
It is important to remember that STBCs based on orthogonal design do
not achieve a rate of 1 for complex signal constellations. In [8], it has been
shown for 3 and 4 transmit antennas the maximum possible rate is 3/4 with
4 delays. For 5 to 8 transmit antennas, the achievable rate is 1/2 with 8
delays, and for the 9 to 16 case, the rate becomes 5/16 in 16 time instances.
In order to achieve the rate of a SISO system, the orthogonal property of
STBCs must be broken as described in [9].
4.4
Space–Time Trellis Codes
As mentioned in the previous section, STBCs cannot achieve the transmission
rate of a SISO system when complex signals and more than two transmit
antennas are available. Furthermore, even though STBCs provide diversity,
the capacity of the MIMO system is not fully exploited. It is possible to design
codes that provide not only diversity but also some coding gain. The side
effect of this additional provision is a serious increase in complexity. More
precisely, the code’s complexity also increases according to the number of
transmission bits of the modulation used. The codes proposed are denoted
in the literature as STTCs. These codes are based on the well-known convo-
lutional encoding technique. Initial STTCs were presented in [10].
4.4.1
Encoding and Decoding
The STTC encoder is composed of a convolutional encoder as described in
[11]. The data bits are inserted into the convolutional encoder composed by
a ﬁxed number of feed forward shift registers. The values of these registers
at any instance represent the current state of the encoder. The complexity of

Introduction to Space–Time Coding
99
the codes but also their coding gains augment with the number of shift
registers. A block diagram of an encoder is shown in Figure 4.4.
The shift registers are connected to multipliers and adders. All multipli-
cations and additions are performed with a modulo equal to the constellation
size. The coefﬁcients of the multipliers give the coefﬁcients of the generator
polynomial that describes the convolutional encoder.
The encoding process is described by Equation 4.12 where a set {b} com-
posed of r input bits and q bits describing the shift registers, i.e., the state of
the encoder, is multiplied by the generator polynomial. All operations and
values are performed with a modulo equal to the constellation size.
(4.12)
The encoder state of the shift registers is initialized with zeros at the
beginning of transmission and is required to reach the zero state at the end
of transmission.
Convolutional codes can be represented with a trellis diagram. The trellis
code is a tree graph giving the transitions between the states of the registers
according to the input bits. The trellis of a STTC composed of four states,
designed for QPSK modulation, and applied to a system with two transmit
antennas is given as an example in Figure 4.5.
FIGURE 4.4
Space–Time Trellis encoder diagram.
r bits 
b1
b2
bb
gb,1 
g2,1 
g1,1 
x1
r
br
br + 1
q
g2,MT
xMT
gb,MT
g1,MT
x
x
x
b
b
b
g
M
r
b
T
1
2
1
1,



¬®
¼¾ = ¬®
¼¾
1
1 2
1
2 1
2 2
2
1
2
g
g
g
g
g
g
g
g
M
M
b
b
b M
T
T
,
,
,
,
,
,
,
,







T
¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
.

100
MIMO System Technology for Wireless Communications
In this ﬁgure, the branches emerging from each state from top to bottom
are labeled by x1,x2, which are the symbols transmitted from the ﬁrst and
second antenna, respectively. An example is marked in bold in the ﬁgure.
We assume that we are already at state 1 and that the inputs bits are 1 and
0, which correspond to the QPSK symbol labeled by 2 in the right side of
the ﬁgure. The next state is then 2, and the symbols transmitted from the
two antennas are the QPSK symbols labeled by the numbers 1 and 2.
During the decoding of the STC code, each branch connecting two different
states can be assigned with a branch metric as a function of the received
signals rj of the MR receive antennas, the channel coefﬁcients hj,i and the
constellation points marked by the labels of the transitions x1 … xMT. This
branch metric BM(aqb), identifying the transition from state a to state b, is
given by:
(4.13)
The Viterbi algorithm can be used to compute the path metric with the
lowest accumulated metric. The path metric calculation can be simpliﬁed by
selecting the minimum branch metric arriving at each node or state. The
selected branch metric is called the survivor. In Figure 4.5, the bold branch
is the survivor for state 2 when BM(1q2) is inferior to BM(0q2), BM(2q2)
and BM(3q2). The Viterbi algorithm is composed of a forward and a back-
ward phase. During the forward phase, the Viterbi algorithm saves at each
stage, the sum of the branch metric of the survivor and the previously saved
path metric of the state from which the survivor emerges. In other words
and following the previous example, the path metric saved at state 2 in
FIGURE 4.5
Trellis of a four-state, STTC-coded QPSK with two transmit antennas.
0,0 0,1
0,3
0,2
1,0 1,1
1,3
1,2
2,0 2,1
2,3
2,2
3,0 3,1
3,3
3,2
0
1
2
3
0
1
2
3
0/00
1/01
3/11
2/10
QPSK
BM a
b
r
h
x
j
j i
i
i
M
j
M
T
R
q
(
) =


=
=
¨
¨
,
.
1
2
1

Introduction to Space–Time Coding
101
Figure 4.5 is equal to BM(1q2) plus the previously calculated metric of state
1. After the end of this forward phase, a back trace operation starts by
selecting the minimum of the path metrics and tracing back the states of the
path selected and, hence, the transmitted sequence.
In Figure 4.6, an example is drawn based on the trellis described in Figure
4.5. The selected path shown in bold format follows the state transitions 0,
1, 3, 2, 0, 1, 1, 0. Based on the four-state STTC of Figure 4.5, the labels of the
symbols transmitted are 0, 1, 3, 2, 0, 1, 1 from antenna 1 and 1, 3, 1, 0, 1, 1,
0 from antenna 2.
4.4.2
Performance Analysis and Code Design
In order to conduct a performance analysis of space–time trellis codes, we
assume that a sequence of L consecutive symbols is transmitted from each
transmit antennas during L consecutive time instances. We can then deﬁne
the space–time codeword matrix X as:
(4.14)
The superscript indexes of xt
i represent the antenna element while the
subscript indexes gives the time instance. We will refer by xi the ith row of
X and by xt the tth column of X.
The pairwise error probability is deﬁned as the probability that the decoder
estimates erroneously the transmitted sequence. This case occurs during the
maximum likelihood (ML) decoding process of the Viterbi algorithm when:
(4.15)
FIGURE 4.6
Example of a trellis path Viterbi selection for a four-state, STTC-coded QPSK with two transmit
antennas.
0
1
2
3
0
1
2
3
X
x
x
x
x
L
M
L
M
T
T
=
¬
®
­
­
­
¼
¾
½
½
½
1
1
1
1





.
r
h
x
r
h
x
t
j
j i
t
t
i
i
M
j
M
t
L
t
j
j i
t
T
R


v


=
=
=
¨
¨
¨
,
,
ˆ
1
1
1
t
i
i
M
j
M
t
L
T
R
=
=
=
¨
¨
¨
1
1
1
.

102
MIMO System Technology for Wireless Communications
The modiﬁed Euclidian distance between two space–time codeword matrices
is identiﬁed as:
(4.16)
The pairwise error probability conditioned by the matrix H of channel
fading coefﬁcients is given by the following equation where erfc(.) is the
complementary error function:
(4.17)
The upper bound of this conditional pairwise error probability is given by
the following equation:
(4.18)
Tarok et al. in [10] conducted a performance analysis for both Rician and
Rayleigh types of channels. The Rayleigh distribution is more representative
of the Non-Line-of-Sight (NLOS) environment and is considered in this
chapter. Nevertheless, in both channel situations, two different cases must
be dissociated. The ﬁrst case involves slow fading channels, which implies
that the channel coefﬁcients remain constant for the time durations equal to
L symbols. In the second case, which involves fast or rapid fading channels,
the channel coefﬁcients change at each time instance.
In the case of slow Rayleigh fading channels, Tarok et al. in [10] deﬁne
the codeword difference matrix B between the codeword transmitted and the
erroneous codeword as:
(4.19)
Then, the codeword distance matrix A is deﬁned to be the product of
matrix B with its Hermitian transpose, i.e., its transpose conjugate. The
modiﬁed Euclidian distance necessary to deﬁne the pairwise error probabil-
ity of Equation 4.17 becomes:
(4.20)
d
X X
H
X
X
h
x
x
h
j i
t
t
i
t
i
i
MT
2
2
1
2
, ˆ
ˆ
ˆ
,
(
) =


(
)
=


(
)
=¨
j
M
t
L
R
=
= ¨
¨
1
1
.
P X X H
erfc
E
N
d
X X
s
h
, ˆ
, ˆ
.
(
) =


(
)
©
«ª
¹
»º
2
0
2
P X X H
e
d
X X
E
N
h
s
, ˆ
.
, ˆ
(
) f


(
) 
1
2
2
0
4
B
X
X
x
x
x
x
x
M
M
L
T
T
=

=


ˆ
ˆ
ˆ
1
1
1
1
1
1




1
1


¬
®
­
­
­
¼
¾
½
½
½
ˆ
ˆ
.
x
x
x
L
L
M
L
M
T
T

d
X X
h v
h
i
j
i
j
M
j
M
R
T
2
1
1
, ˆ
.
(
) =


=
= ¨
¨
Q

Introduction to Space–Time Coding
103
In the previous equation, Qi are the eigenvalues of A, hj are the jth rows of
H and vi represent the ith eigenvector of A.
The case of fast fading channels is more complex, and we invite the reader
to refer to Tarok et al. in [10] for the complete performance analysis. Distinc-
tive treatment is conducted according to the value of the space–time symbol-
wise Hamming distance. This distance represents the number of differences
in the space–time symbol difference vector F at a speciﬁc time t:
(4.21)
Tarok et al. deﬁned design criteria for both slow and fast fading Rayleigh
channel conditions. The space–time code design rules for slow fading Ray-
leigh channels are known as the rank and the determinant criteria. The
optimum designed code must:
•
Maximize the minimum rank of matrix A over all possible pairs of
distinct transmission codewords
•
Maximize the minimum product of all non-zero eigenvalues of
matrix row along the pairs of distinct codewords with the minimum
rank
Similarly, for the case of rapid fading Rayleigh channel coefﬁcients design
criteria are deﬁned. They are named distance and product criteria. In this
case, the optimum codes must:
•
Maximize the minimum space–time symbol-wise Hamming dis-
tance between all pairs of distinct codewords
•
Maximize the minimum product distance along the path with the
minimum symbol-wise Hamming distance
The design criteria presented in this section were the ﬁrst to be presented.
Several investigations have been conducted in this area and other more
reﬁned criteria have been deﬁned, [11] and [12].
4.5
Spatial Multiplexing
Spatial Multiplexing (SM) techniques have a different orientation than the
coding methods presented in the previous sections. The general operation
behind SM processing is to break the sequence of information bits into a
F
x
x
x
x
t
t
t
M
t
M
T
T
=


¬
®
­
­
­
¼
¾
½
½
½
1
1ˆ
ˆ
.


104
MIMO System Technology for Wireless Communications
certain set of sub-streams that will be treated differently. In SM, MT inde-
pendent symbols are transmitted from MT transmitting antennas. Therefore,
there are two main advantages of SM techniques. First, these techniques can
reach a closer bound to the available capacity of MIMO systems, since the
spatial rate is equal to the number of transmit antennas MT. On the other
hand, the complexity requirement, while heavy, remains constant and inde-
pendent of the modulation in use, which is not the case of STTCs. In general,
in order to perform SM, the number of receive antennas must be equal to
or greater than the number of transmit antennas.
The main idea behind SM encoding techniques relies on the use of pow-
erful decoding techniques on the receiver side. At the transmitter side, the
information sequence is subdivided into several sub-streams through a
demultiplexer. The sub-stream where the signal processing is conducted is
identiﬁed as “Layer.” Hence, SM is also called the Layer Space–Time (LST).
The demultiplexing operation can be applied to bits or symbols. Conse-
quently, the demultiplexing of the data information stream can be realized
in three different ways according to the demultiplexer position in the trans-
mitter chain and the directions of the layers. The encoding processes are
known as horizontal, vertical and diagonal SM and are schematically drawn
from top to bottom in Figure 4.7.
In the horizontal encoding case, the data bits are demultiplexed into MT
sub-streams that are independently encoded, interleaved and modulated. In
vertical encoding SM, the data stream is at ﬁrst coded, interleaved and
FIGURE 4.7
Spatial Multiplexing Encoding Schemes.
Symbols
Demultiplexer
Bits
Encoder
interleaver
modulator
Bits
Bits
Encoder
interleaver
modulator
Encoder
interleaver
modulator
Demultiplexer 
Stream
interleaver
Symbols
Bits
Bits
Encoder
interleaver
modulator
Encoder
interleaver
modulator
Demultiplexer

Introduction to Space–Time Coding
105
modulated and the resulting symbols are then demultiplexed into MT sub-
streams. Diagonal SM encoding is similar to horizontal encoding with the
only difference that, after the ﬁnal stage, the frames of symbols undergo a
stream interleaver, which rotates the transmitted frames by padding with
zero some antennas. The forms of the layers for each case are shown in the
right side of Figure 4.7.
4.5.1
V-BLAST Algorithm
The vertical SM encoding is referred in [13] as V-BLAST. The detection in
vertical architecture is simpler than the detection in diagonal architecture
and is preferable to the sub-optimal horizontal case. The information data
are at ﬁrst coded, interleaved and mapped into their corresponding symbols.
Then, the symbols are demultiplexed to the MT transmit antennas. Hence,
the symbols transmitted are independent of each other. Each set of MT
symbols composes a transmission vector as shown in the second scheme of
Figure 4.7.
Assuming that the receiver is aware of the modulation used, the decoding
at the receiver becomes possible through the V-BLAST algorithm. In vertical
SM, detection and estimation of the transmitted symbols is performed in a
vector-by-vector basis, since each vector represents the layer of the SM coding.
The algorithm is initialized and operates on each vector in a symbol-per-
symbol basis by iteratively detecting and estimating the transmitted sym-
bols. We assume that the inter-symbol interference is negligible and that the
system is quasi-stationary, which implies that the matrix of the channel
coefﬁcients remains constant. We also assume that the channel matrix is
perfectly known at the receiver side.
The algorithm is based on linear interference suppression in combination
with interference cancellation, methods commonly used in multi-user environ-
ments. The algorithm also performs a rearrangement of the symbol detection
in an optimal sense. In general, V-BLAST is characterized as an interference
avoidance technique. The received signals are perceived as a set of signals
issued from different users. Each signal is an interferer to the rest of the
signals. The best signal stream in terms of SNR is selected for detection and
is also removed from the remaining signals. This way, the remaining signals
have one interferer less. Optimal combining is repeated until all signals are
detected.
Three consecutive phases take place:
•
Linear interference suppression through Minimum Mean Square
Estimation (MMSE) or Zero Forcing (ZF)
•
Interference cancellation of the symbols detected
•
Reordering of the detection process through SNR post-detection

106
MIMO System Technology for Wireless Communications
The initial form of V-BLAST described in the literature uses ZF for the
suppression of the linear interference. This operation is realized in three
steps:
(4.22)
The ﬁrst step consist on ﬁnding the zero-forcing vector wki that satisﬁes:
(4.23)
In Equation 4.23, (H)j represents the jth column of H which is a vector
composed of all the channel coefﬁcients produced from transmit antenna j.
It turns out that the condition of Equation 4.23 is realized by taking wi to be
the equivalent jth column from the Moore-Penrose pseudo-inverse. Hence,
the algorithm ﬁnds the zero-forcing vector wki through consecutively calcu-
lating the Moore-Penrose pseudo-inverse. In the ﬁrst line of Equation 4.22,
i is the iteration number, ki is the index of the transmit antenna which symbol
is detected during iteration i and Gi is the Moore-Penrose pseudo-inverse at
iteration stage i. With wki, the statistic decision yki is obtained from the
received vector Ri at stage i, and is quantized (represented by the operator
Q()) in order to obtain the kith detected symbol.
The interference of the detected symbol is cancelled in the second step of
the algorithm by removing its interference from the received signal:
(4.24)
A new received vector Ri+1 is formed by removing from Ri the estimated
transmit signal of the detected symbol. The Moore-Penrose pseudo-inverse
(represented by the + sign as superscript) is recalculated from the previous
stage transfer matrix after annulling its kith row. The operations realized in
Equation 4.24 can be seen as redeﬁning a new system where the antenna
that used to transmit the previous detected symbol is extinguished. This is
achieved by removing the signal produced by the detected symbol and by
annulling the channel coefﬁcients related to the estimated symbol’s antenna.
The last step of the process is charged to select the optimum order for
decoding. In other words, the layers are rearranged in the process in order
to minimize the probability of error. This means ﬁnding an index ki of stage
w
G
y
w
R
x
Q y
k
i k
k
k
T
i
k
k
i
i
i
i
i
i
= ( )
=

= (
)
ˆ
.
w
H
j
i
j
i
i
T
j
.
.
( ) =
>
=
¯
°
±²
0
1
R
R
x
H
G
H
i
i
k
k
i
k
i
i
i
+
+
+
=

( )
=
1
1
ˆ
.

Introduction to Space–Time Coding
107
i. The method proposed in the algorithm is to select the antenna with the
best post-detection SNR. The post-detection SNR of each transmit antenna
j is the absolute value of the jth column of the Moore-Penrose pseudo-inverse
Gi at stage i. If S is the optimum ordering and S = {k1, k2, … kMT}, the search
for the best SNR post-detection at stage i is performed for the set {ki, …, kMT},
since the symbols transmitted from antennas k1 to ki already have been
detected in previous stages. The best post-detection SNR is the minimum
absolute value calculated:
.
(4.25)
The generalized algorithm is composed of two phases, an initialization
and a recursive phase. The initialization phase consists of calculating the
Moore-Penrose pseudo-inverse:
(4.26)
The recursive phase is composed of the previously described steps:
(4.27)
4.6
Space–Time Coding with CSI Knowledge 
at the Transmitter
The coding schemes described in the previous sections involve space–time
processing when no channel state information (CSI) is available at the trans-
mitter side. However, in a duplex system, it is sometimes possible to provide
k
G
i
j S j
k
k
i j
i
=
( )

{
}

,
...
1
1
2
argmin
G
H
i
1
1
=
=
+
.
k
G
w
G
y
i
j S j
k
k
i j
k
i k
i
i
i
=
( )
= ( )

{
}

,
...
1
1
2
argmin
k
k
T
i
k
k
i
i
k
k
i
i
i
i
i
i
i
w
r
x
Q y
R
R
x
H
G
=

= (
)
=

( )
+
+
ˆ
ˆ
1
1
1
=
= +
+
H
i
i
ki
.

108
MIMO System Technology for Wireless Communications
CSI at the transmitter. The optimum exploitation of the CSI at the transmitter
is linear pre-ﬁlter or pre-equalization realized with the Singular Value
Decomposition (SVD) theorem, [14]. The channel matrix can be written as:
.
(4.28)
In this equation, matrix U and V are composed of the eigenvectors of the
channel and D is a diagonal matrix composed of the eigenvalues of H. It
becomes possible to left multiply the transmit matrix X with V and to left
multiply the received matrix R with UH. In this case, the received signals
become:
(4.29)
The MIMO system becomes equivalent to a set of parallel SISO systems
as shown in Figure 4.8. Each SISO is ampliﬁed by an eigenvalue of D. The
capacity of the MIMO system is then the sum of distinct parallel SISO channel
capacities. The number of parallel connections is equal to the number of non-
zero eigenvalues or, in other words to the rank of H. Each SISO sub-channel
forms an eigenmode and optimal energy allocation can be applied through
the water-pouring algorithm.
FIGURE 4.8
Exploitation of CSI knowledge at the transmitter.
H
U D V H
=


U
R
U
H
V X
N
U
U D V
V X
N
D
H
H
H
H

=



(
)+
(
)
=



(
)

(
)+
(
)
=

+

X
U
N
H
.
Receiver
Transmitter
UH · R
X
V · X
R
N
H
STC
V
STC
UH
Channel
λ1
λ2
λrank(H)

Introduction to Space–Time Coding
109
The SVD method requires at least the transfer of the matrix V back to the
transmitter, and complex calculation tasks, such as diagonalization, must be
performed. There are several other methods that can sub-optimally use CSI
at the transmitter [15]. Such a method is the antenna selection method
described more analytically in [16].
Antenna selection is a simple and efﬁcient technique to exploit CSI at the
transmitter. The technique is referred to as Transmit Selection Diversity (TSD)
in [17]. The purpose of the TSD algorithm is to select the “best” subset of
transmit antennas that optimizes reception according to some sort of criteria.
Performance results of different schemes including TSD for Orthogonal
Frequency Division Multiplexing (OFDM) systems are provided in Figure
4.9. In OFDM, diversity is generally applied in the spatial and frequency
domain. In the ﬁgure, Symbol Error Rate (SER) is shown in terms of SNR
when Quadrature Amplitude Modulation with 16 constellation points
(QAM-16) is used. The lines marked with stars are Space–Frequency Block
Codes while the circles are used for the performances of Space–Frequency
Trellis Coding schemes. Plain lines represent performances when CSI is
unknown at the transmitter side for a MIMO system of 2 transmit and 2
receive antennas, i.e., (2, 2). The dotted curves shows the SER when TSD is
used and 2 transmit antennas are selected out of 3 transmit antennas. Sim-
ilarly, the dashed lines are representing the case where 2 transmit antennas
are selected out of 4 transmit antennas.
FIGURE 4.9
Performance results for different SF schemes in an OFDM system for QAM-16.
100
10−1
10−2
Symbol error rate (SER) 
10−3
10−4
0 
5 
10 
SNR(dB)
15 
20 
25 
Space-frequency block code(2, 2) 
Space-frequency trellis code(2, 2) 
No transmit selection diversity(TSD) 
TSD: (2, 2) out of (3, 2)
TSD: (2, 2) out of (4, 2)

110
MIMO System Technology for Wireless Communications
4.7
Other Space–Time Coding Schemes
The space–time coding schemes presented in the previous sections are just
some of the best-known schemes for MIMO systems. It is obvious that there
are several other possible schemes. The description of all these STC tech-
niques goes beyond the scope of this chapter. In this section, we provide
some general but not exhaustive directions of STC found in the literature.
A major open research direction is the design of STC in the case where the
channel matrix cannot be determined at the receiver. In this case, differential
schemes and techniques can be used in combination with classic ST coding
methods such as STBCs.
Another class of STCs not mentioned in the previous subsections is the
extension of STTCs with serial or parallel concatenate convolutional schemes.
In particular, recursive codes that perform iterative decoding, such as turbo
codes, can be applied to MIMO systems forming a new category of STC.
Some research has also been carried out for Low Density Parity Check
(LDPC) codes.
The most common form of STC is the combination of two distinct codes,
namely an inner and an outer code. The outer codes are usually well-known
bit-encoding schemes, such as reed-solomon or bit interleaved convolutional
codes, and they are placed before the modulator in the transmission chain.
Their task is to provide coding gain to the system. The inner codes are
positioned after the modulator and operate on a symbol basis. The inner
codes such as STBCs are mainly charged to provide diversity to the system
and to perform the serial-to-parallel signal conversion. It is evident that the
names “inner” and “outer” comes from the position of the codes in the
transmission chain. This combined scheme is considered in several emerging
standards and technologies such as the IEEE 802.16 standard, which is
known to the general public by the certiﬁcation mark WiMAX.
References
1. G.J. Foschini and M.J. Gans. 1998.“On limits of wireless communications in a
fading environment when using multiple antennas,” IEEE Wireless Personal
Communications, Vol. 6, March 1998, pp. 311–335.
2. L. Zheng and D.N.C. Tse. 2003. “Diversity and multiplexing: a fundamental
tradeoff in mulitple antenna channels,” IEEE Transactions on Information Theory,
Vol. 49, No. 5, May 2003, pp. 1073–1096.
3. S.M. Alamouti. 1998. “A simple transmit diversity technique for wireless com-
munications,” IEEE Journal on Selected Areas in Communications, Vol. 16, No. 8,
October 1998, pp. 1451–1458.
4. V. Tarok, H. Jafarkhami, and A.R. Calderbank. 1999. “Space-time block codes
from orthogonal designs,” IEEE Transactions on Information Theory, Vol. 45,
No. 5, July 1999, pp. 1456–1467.

Introduction to Space–Time Coding
111
5. V. Tarok, H. Jafarkhami, and A.R. Calderbank. 1999. “Space-time block codes
for wireless communications: performance results,” IEEE Journal on Selected
Areas in Communications, Vol. 17, No. 3, March 1999, pp. 451–460.
6. G. Ganesan and P. Stoica. 2001. “Space-time block codes: a maximum SNR
approach,” IEEE Transactions on Information Theory, Vol. 47, No. 4, May 2001,
pp. 1650–1656.
7. X.B. Liang. 2003. “Orthogonal designs with maximal rates,” IEEE Transactions
on Information Theory, Vol. 49, No. 10, October 2003, pp. 2468–2503.
8. O. Tirkkonen and A. Hottinen. 2002. “Square-matrix embeddable space-time
block codes for complex signal constellations,” IEEE Transactions on Information
Theory, Vol. 48, No. 2, February 2002, pp. 384–395.
9. A. Boariu and D.M. Ionescu. 2003. “A class of nonorthogonal rate-one space-
time block codes with controlled interference,” IEEE Transactions on Wireless
Communications, Vol. 2, No. 2, March 2003, pp. 270–395.
10. V. Tarok, N. Seshadri, and A.R. Calderbank. 1998. “Space-time codes for high
data rate wireless communication: performance criterion and code construc-
tion,” IEEE Transaction on Information Theory, Vol. 44, No. 2, March 1998,
pp. 744–765.
11. R.S. Blum. 2002. “Some analytical tools for the design of space-time convolu-
tional codes,” IEEE Transactions on Communications, Vol. 50, No. 10, October
2002, pp. 1593–1599.
12. Y. Liu, M.P. Fitz, and O.Y. Takeshita. 2002. “A rank criterion for QAM space-
time codes,” IEEE Transaction on Information Theory, Vol. 48, No. 12, December
2002, pp. 3062–3079.
13. G.D. Golden, G.J. Foschini, R.A. Valenzuela, and P.W. Wolniansky. 1999.
“Detection algorithm and initial laboratory results using the V-BLAST space-
time communication architecture,” Electronics Letters, Vol. 35, No. 1, January 7,
1999, pp. 14–15.
14. R. Horn and C. Johnson. 1985. Matrix Analysis, Cambridge, U.K.: Cambridge
University Press.
15. A.D. Valkanas and P.I. Dallas. 2003. “Adaptive modulation and coding in space-
time-frequency block and trellis for (2, 2) MIMO OFDM systems,” International
OFDM Workshop (InOWo), 2003.
16. I. Bahceci, T.M. Duman, and Y. Altunbasak. 2003. “Antenna selection for
multiple-antenna transmission systems: performance analysis and code con-
struction,” IEEE Transaction on Information Theory, Vol. 49, No. 10, October 2003,
pp. 2669–2681.
17. A.D. Valkanas. 2004. “Adaptive Space-Frequency Coding for Multiple-Input
Multiple-Output Orthogonal Frequency Division Multiplexing Systems,” Ph.D.
Dissertation, University of Alabama in Huntsville.
Acronyms
AWGN
Additive White Gaussian Noise
BS
Base Station
CSI
Channel State Information

112
MIMO System Technology for Wireless Communications
LDPC
Low Density Parity Check
LOS
Line of Sight
LST
Layer Space Time
MEA
Multiple Element Array
MIMO
Multiple Input Multiple Output
MISO
Multiple Input Single Output
ML
Maximum Likelihood
MMSE
Minimum Mean Square Estimation
MTMR
Multiple Transmitter Multiple Receiver
NLOS
Non Line of Sight
OFDM
Orthogonal Frequency Division Multiplexing
OSTBC
Orthogonal Space–Time Block Code
QAM
Quadrature Amplitude Modulation
QPSK
Quadrature Phase Shift Keying
SER
Symbol Error Rate
SF
Space–Frequency
SIMO
Single Input Multiple Output
SISO
Single Input Single Output
SM
Spatial Multiplexing
SNR
Signal to Noise Ratio
ST
Space–Time
STBC
Space–Time Block Code
STC
Space–Time Code/Coding
STF
Space–Time-Frequency
STP
Space–Time Process/Processing
STTC
Space–Time Trellis Code
SVD
Singular Value Decomposition
TSD
Transmit Selection Diversity
V-BLAST
Vertical Bell Laboratories Architecture Space Time
WiMAX
Worldwide Interoperability for Microwave Access
ZF
Zero Forcing

113
5
Feedback Techniques for MIMO Channels
David J. Love and Robert W. Heath, Jr.
CONTENTS
5.1
Introduction ................................................................................................ 113
5.2
Prior Work and Motivation...................................................................... 115
5.3
Limited Feedback MIMO ......................................................................... 119
5.3.1
System Description ....................................................................... 119
5.3.2
Channel Quantization .................................................................. 119
5.3.3
Quantized Signal Adaptation......................................................120
5.4
Quantized Signal Adaptation Algorithms.............................................121
5.4.1
Beamforming Example and Summary of Approach .................121
5.4.2
Precoded Orthogonal Space–Time Block Codes......................123
5.4.3
Precoded Spatial Multiplexing....................................................127
5.5
Effect of Spatial Correlation.....................................................................133
5.6
Feedback in Broadband Channels with MIMO-OFDM......................135
5.6.1
MIMO-OFDM System Model and Limited Feedback ............135
5.6.2
Interpolated Beamforming in MIMO-OFDM...........................136
5.6.3
Interpolated Precoding in MIMO-OFDM .................................138
5.6.4
Performance Example...................................................................139
5.7
Conclusions.................................................................................................139
References.............................................................................................................140
5.1
Introduction
Recent wireless innovations are improving bandwidth efﬁciency and reducing
the deleterious effects of fading in wireless communication channels. Mul-
tiple antennas offer high capacity, enhanced resistance to interference, and
reductions in fading thanks to diversity when arrays are used at both trans-
mitter and receiver in a MIMO (multiple-input multiple-output) conﬁguration.
Broadband signaling, such as orthogonal frequency division multiplexing

114
MIMO System Technology for Wireless Communications
(OFDM), simpliﬁes equalization in channels with signiﬁcant multipath inter-
ference thus enabling larger bandwidth channels. Multiuser processing
allows space, time, and frequency resources to be distributed among multiple
users to improve network performance and system capacity.
The capacity, quality, and complexity obtained from these new technolo-
gies are substantially improved when information about the channel state is
available at the transmitter. For example, equipped with channel state infor-
mation, the transmitter can customize the transmitted waveforms to provide
higher link capacity and throughput, improve system capacity by more
efﬁciently sharing the channel with multiple users, increase range by exploit-
ing diversity due to spatial and frequency selectivity, and simplify multiuser
receivers through known interference cancellation.
Research often assumes that channel state information is known perfectly
at the transmitter. In most systems, however, the only opportunity for the
transmitter to learn about the channel is through a low rate feedback control
channel. This is difﬁcult because
1. the feedback rate is ﬁxed and is generally small to reduce system
overhead,
2. there are several channel parameters (proportional to the product of
the number of channel taps, number of antennas, and number of
users) to send each feedback interval, and
3. frequent feedback is needed since the wireless channel is changing
over time due to mobility of the transmitter, receiver, or scatterers
(characterized by the coherence time).
The implication of these three points is that channel state information must
be highly compressed. This motivates the study of feedback techniques as
a means for practically informing the transmitter about the channel state.
This chapter provides an overview of feedback techniques for MIMO com-
munication channels. We emphasize instantaneous feedback, i.e., those meth-
ods that attempt to inform the transmitter about the instantaneous channel
state. Our approach and presentation are based on the framework illustrated
in Figure 5.1. The key idea is to treat the (estimated) channel coefﬁcients as
a source and then to apply specially developed source coding algorithms to
quantize and compress the channel coefﬁcients. This is not traditional source
coding, wherein the object is to reconstruct the source, because the perfor-
mance metrics in a communication system are system parameters such as
SNR, bit-error-rate, throughput, and capacity. The objective of the quantizer
in Figure 5.1 is to compress (typically with a lossy algorithm) channel state
information such that performance is maximized under some assumptions
about the spatial formatting, e.g., space–time block coding or spatial multi-
plexing. We will present a vector quantization framework for quantizing
wireless channels that includes identifying the characteristics of the channel
that must be quantized and deriving source codes based on communication-
theoretic measures of distortion.

Feedback Techniques for MIMO Channels
115
This chapter is organized as follows. First we motivate the problem of
channel quantization and then review related work in Section 5.2. We intro-
duce the notion of limited feedback MIMO communication in Section 5.3.
We discuss two approaches to limiting feedback: direct channel quantization
and quantized signal adaptation. The latter only quantizes features of the
channel that are necessary to adjust the transmitted signal. In Section 5.4 we
describe various algorithms for quantized signal adaptation for narrowband
channels. Under some assumptions about the channel statistics we develop
designs for codebooks suitable for beamforming and precoding in MIMO
systems. We examine their performance in some practical correlated channels
in Section 5.5. In Section 5.6 we study the extension to broadband MIMO-
OFDM channels. We discuss per-tone quantization and interpolation for
exploiting the correlation of adjacent subcarriers. The emphasis is on beam-
forming, though we discuss extensions to more general precoding. A detailed
bibliography is included in the References section.
We use the following notation throughout this chapter. We use Ik to denote
the k × k identity matrix, Ey[·] to denote expectation with respect to y, * to denote
matrix conjugate transposition, argmax to denote a function that returns a
single global maximizer, Qj{A} to denote the jth largest singular value of A,
to denote the matrix two-norm,
to denote the matrix Frobenius norm,
(A)k to denote the kth column of A, 0 to denote a matrix of all zeros, L(Mt, M)
to denote the set of Mt × M matrices with maximum singular value less than
or equal to one (i.e., L(Mt, M) =
and
to denote
the set of Mt × M matrices with orthonormal columns.
5.2
Prior Work and Motivation
Single-user wireless links can be classiﬁed as narrowband or broadband
channels on the basis of channel memory [88]. In this section, we review
FIGURE 5.1
This ﬁgure illustrates a communication link with a feedback control channel. The receiver uses
an estimate of the channel both to demodulate the data and to generate quantized channel state
information. This information is sent to the transmitter using the feedback control channel. The
transmitter, in turn, uses this information to customize the transmitted signal for the channel.
The rate of the feedback channel R is typically much smaller than the rate of the data pipe C
since a large control channel penalizes the overall efﬁciency of the system.
Spatial
formatter
Bits
Demodulate
Estimate channel 
Channel state
Information quantizer
   Data pipe 
Control pipe 
Bits
R
C

2

F
{
{ }
})
F
F

f
,
×
M
M
t
Q1
1
U(
)
M M
t,

116
MIMO System Technology for Wireless Communications
relevant literature in both these areas, with an emphasis on MIMO systems.
Feedback issues have been considered in IEEE 802.16 ﬁxed wireless systems
[1], third generation cellular [33], and the next generation wireless local area
network standard IEEE 802.11n [84].
To motivate the problem we consider a narrowband Mt transmit and Mr
receive antenna MIMO system (we consider broadband extensions in Section
5.6). At baseband the channel can be represented by an
random
matrix H. This yields a channel input/output relationship at the kth trans-
mission of
(5.1)
where
is an
transmit matrix,
is an
receive matrix, and
Nk is an
additive white Gaussian noise matrix. The variable T simply
denotes the number of temporal transmissions in the space–time signal.
Space–time signal design can be partitioned into two cases: open-loop and
closed-loop MIMO. In an open-loop MIMO system,
is designed indepen-
dently of the channel conditions. Open-loop MIMO includes the popular
spatial multiplexing or Bell Labs Space–Time (BLAST) system [20], orthog-
onal space–time block codes [4,90], space–time trellis codes [36,45,50,91],
more recent space–time codes [11,14,15,35], as well as codes proposed by
one of the authors [24,27,28]. Alternatively, closed-loop MIMO signals are
designed as a function of the channel conditions. Closed-loop algorithms
beneﬁt from their channel adaptive nature by providing improved error rate,
better spectral efﬁciency, and simpliﬁed decoding [6,70].
A transmit technique of interest in closed-loop MIMO is linear precoding
of an open-loop signal. Linear precoding works by constructing Xk = FSk
where Sk is formed from one of the aforementioned open-loop algorithms
and F is a linear precoding matrix determined based on H. A common
application of precoding for MIMO systems is to reduce the error rate,
improve the throughput, or decrease the complexity of a space–time code
designed without channel information. Initial work on precoding for spatial
multiplexing was done by Scaglione et al. [81], Sampath et al. [77], Zhou
et al. [106], and Heath et al. [29]. Jöngren et al. pioneered precoding for
space–time block codes in [40] before more recent work on this subject
[3,23,46,101,103,106,107]. The precoding matrix can be derived from the chan-
nel (see, e.g., [39,75,81]) or the channel statistics (see, e.g., [2,21,34,68,77,97,
104,106,107]). In general the precoding method depends on the type of
receiver used. A special case of linear precoding is transmit beamforming,
where
is an Mt dimensional beamforming vector, and
is a com-
plex number taken from a digital constellation. Various forms of f have been
explored over the years, beginning with antenna selection in [86,100] to more
general forms in [13,14,51,95], where f is restricted to be a unit vector and
our work in [53], where f is restricted to have unit gain entries.
One problem with most of the current work in closed-loop MIMO com-
munications is the assumption that complete channel state information is
M
M
r
t
×
Y
HX
N
k
k
k
=
+
Xk
M
T
t ×
Yk
M
T
r ×
M
T
r ×
Xk
F
f
=
Sk
ks
=

Feedback Techniques for MIMO Channels
117
available at the transmitter. Sometimes this can be inferred from channel
reciprocity (in time division duplexing (TDD) systems), but in frequency
division duplexing (FDD) systems reciprocity will not be present. Besides,
TDD systems require careful calibration of the RF devices for exploiting
channel reciprocity; this calibration may require additional RF units and
typically must be repeated frequently during operation. Thus closed-loop
communication in FDD systems, and sometimes in TDD systems as well,
requires investigating channel quantization and limited feedback.
The challenge of direct channel quantization [37–39, 46] is the large number
of parameters. To illustrate, Table 5.1 provides the number of parameters for
different kinds of transmit processing. Notice that more sophisticated forms
of precoding require more feedback. Quantization of instantaneous channel
state information is the alternative to direct channel quantization. Initial work
in this area stems from the channel quantization work of Narula et al. [69]
and the work by Heath and Paulraj on beamforming phase quantization [26]
and antenna selection [22,29]. This kind of technique was then extended by
Love et al. [53,63], Mukkavilli et al. [66,67] Santipach et al. [79,80], and Zhou
et al. in [108]. Love et al. and Mukkavilli et al. independently found that the
problem of feedback design for beamforming relates to the applied mathe-
matics problem of Grassmannian line packing [10,87]. The codebook vectors
are thought of as lines and are designed using subspace coding techniques.
An overview of work in limited feedback MIMO can be found in [63b].
In broadband wireless links the feedback problem becomes more acute
because of the additional channel parameters. The baseband input-output
relationship of a broadband MIMO wireless link can be written as
(5.2)
where
is the received vector at time n,
is the transmitted signal
vector at time n,
is noise, and
is a multitap channel impulse. In
TABLE 5.1
Example of the Gross Feedback Requirements per User with Mt Transmit 
Antennas, Mr Receive Antennas, for a Narrowband and N Tone MIMO System
Scheme
Feedback
# Params
# Params for OFDM
Simple power control
Total received power
1
N
Beamforming
Beamforming vector
2Mt
2NMt
Eigenmode
Eigenvectors & values
2MtMr
2N MtMr
Precoding
Precoding matrix
2MtMr
2N MtMr
Full channel
Channel matrix
2MtMr
2N MtMr
Note:
Feedback requirements for precoding are reduced when there is a special struc-
ture such as orthogonal columns.
y
H
s
v
( )
( ) (
)
( )
n
l
n
l
n
l
L
=

+
=¨
0
y( )
n
s( )
n
v( )
n
{
( )}
H l
l
L
=0

118
MIMO System Technology for Wireless Communications
general the impulse response is time-varying though often assumed time-
invariant over a transmission burst. The convolution in Equation 5.2 implies
that successive symbols interfere with one another creating intersymbol
interference. To mitigate this self-interference, two different approaches are
to use receive/transmit equalization or orthogonal frequency division multi-
plexing (OFDM).
Receive equalization techniques are well known in the communications
literature [71] and are used in some form in most wireless systems. The
transmit counterpart of receive equalization is conventionally known as
Tomlinson-Harashima (TH) precoding [64,92] (see also [16] and the refer-
ences therein). TH precoding has received less attention in wireless applica-
tions due to the requirement of precise knowledge of the impulse response
at the transmitter. Fischer et al. have examined TH precoding for MIMO
systems with low rate feedback channels [17] using the statistics of the
channel. A general investigation, however, has not been made of the effect
of feedback on TH precoding.
OFDM is a digital modulation technique where a wideband channel is
divided into multiple narrowband channels [31]. Due to interest in OFDM
for IEEE 802.11n [84], IEEE 802.16 [1], and fourth generation applications
[78], we will address only limited feedback communication in broadband
channels with OFDM equalization.
MIMO-OFDM systems make use of the beneﬁts of OFDM modulation to
simplify equalization in frequency selective channels. Thanks to OFDM, the
equivalent system model is converted from the convolution in Equation 5.2
to a set of N (the number of subcarriers) ﬂat fading channels. We comment
more about the system model in Section 5.6. In MIMO-OFDM systems, which
combine the capacity beneﬁts of MIMO communication with the simple
equalization of OFDM, feedback can be used to improve capacity, as dem-
onstrated by Raleigh and Ciofﬁ in early work on the subject [72]. Perfor-
mance can also be improved with partial channel information, e.g., the work
by Xia et al. who derived an adaptive beamformer for MIMO-OFDM based
on imperfect channel state estimates [102]. Since MIMO-OFDM results in a
set of narrowband matrix channels, our quantized beamforming and pre-
coding strategies show great promise for MIMO-OFDM.
A simple application of narrowband quantized precoding to MIMO-
OFDM can result in substantial feedback, in proportion to the number of
subcarriers. Recently Choi and Heath recognized that the correlation
between adjacent subcarriers can be used to reduce the amount of feedback
[8,9]. Speciﬁcally, they proposed a technique where the precoders for only a
fraction of the subcarriers were quantized and a special subspace interpola-
tor was used for the other subcarriers. Work by Mondal and Heath bypassed
the interpolation stage and instead used a clustering approach to ﬁnd the
best precoder for a cluster of subcarriers [65]. Quantized precoding for
MIMO-OFDM has recently been adopted in the IEEE 802.16 standard; further
developments are ongoing.

Feedback Techniques for MIMO Channels
119
5.3
Limited Feedback MIMO
Due to the substantial performance gains that can be obtained when a MIMO
signal is adapted to the channel, the design of limited feedback MIMO systems
is an important theoretical and practical problem. The following subsections
give an overview of the general ideas behind limited feedback MIMO systems.
5.3.1
System Description
A limited feedback system leverages cooperation between the transmitter
and receiver. Consider for illustration purposes the narrowband MIMO com-
munication system in Equation 5.1. In a coherent MIMO system, the receiver
has an estimate of the forwardlink channel matrix H that is used for decod-
ing. The receiver uses its knowledge of H to design feedback information to
send to the transmitter. The transmitter then uses this feedback to adapt the
transmitted signal to the channel.
The design of feedback can be partitioned into two main techniques: direct
quantization of the channel and indirect quantization of the channel through
signal adaptation. In general, either method can be successfully employed.
We will show, however, that direct channel quantization lacks the perfor-
mance of more specialized feedback methods. The reason is that it is often
better to design limited feedback adaptation algorithms than to adapt to the
quantized channel.
5.3.2
Channel Quantization
Motivated by the large body of VQ work over the last forty years, one
approach to limited feedback is to employ channel quantization. The matrix
channel quantization problem is reformulated as a VQ problem by stacking
the columns of the channel matrix H into an Mr × Mt dimensional complex
vector. The problem is then to quantize this high dimensional vector, which
can be successfully done using a VQ algorithm.
In a vector quantizer, a real or complex valued vector is mapped into one
of a ﬁnite number of vector realizations, known as a codebook. The codebook
is chosen to minimize the average distortion with respect to the source
distribution. The Lloyd algorithm or other numerical techniques are typically
used to solve for the codebook. The mapping function is a measure of
distortion between the unquantized input and the quantized output. The
most common example is the mean squared error (MSE), i.e., choose Q(x)
such that the expected value of
is minimized. There is, however,
one key difference between VQ discussed in the compression literature and
channel VQ. In the channel VQ case, the distortion function (or mapping) is
typically a non-Euclidean distance measure. With VQ, the distortion is typically
x
x
 Q( )
2

120
MIMO System Technology for Wireless Communications
a 2-norm like the aforementioned MSE. In channel VQ, however, other
distortion functions might be used, such as 2 – 2 ¤x, Q(x)´. The reason is
that communication systems are often invariant to certain aspects of the
channel — a property that can be used to reduce the number of degrees of
freedom and, thus, the amount of feedback required. One simple example
of invariance is closed-loop beamforming. The performance of beamforming
is invariant to the channel being multiplied by ej/ for any phase offset /.
Narula et al. ﬁrst used this invariance in [69] for application to closed-loop
beamforming. Note that the MSE is not invariant to phase distortion while
the second distance mentioned above is, in fact, phase invariant. This invari-
ance was used to reduce the number of feedback parameters.
Direct channel quantization technique does not bind the transmitter to any
speciﬁc space–time signaling technique. In theory, this gives the transmitter
ﬂexibility to choose among different space–time signaling techniques such
as beamforming, spatial multiplexing, or space–time coding. Previous work
has shown that channel quantization can be employed for multiple-input
single-output (MISO) beamforming [12,69] and MIMO precoded orthogonal
space–time block coding [39].
5.3.3
Quantized Signal Adaptation
Narula et al.’s work motivated a new approach to limited feedback design.
The algorithm in [69] was technically not only quantizing a MISO vector
channel, but also quantizing the optimal beamforming vector. This different way
of looking at the problem motivates a different approach to limited feedback.
The receiver only needs to send back the portion of the channel structure needed for
signal design.
For a ﬁxed transmission technique, performance gains can be achieved by
concentrating on improving the transmitter’s knowledge of the quantized
information needed to adapt the transmitted signal to current channel con-
ditions. In particular, research has concentrated on modifying the precoded
space–time block coding model described by Equation 5.1 to allow for quan-
tized signal adaptation. The general approach is to use the fact that precoders
are only a function of the channel’s right singular vectors, thus yielding a
dramatic reduction in the dimensionality of the quantization problem.
Recall that a precoded system transmits
where F adapts the
space–time block code matrix
to the current channel conditions. Thus, the
transmitter does not need to know the complete channel matrix H but only
F. The lack of transmit channel knowledge can then be overcome by design-
ing F at the receiver and sending F back to the transmitter using a small
number of feedback bits (denoted by B). Practically, the receiver will use a
selection function f (where
mapping to a codebook
(5.3)
X
FS
k
k
=
Sk
F
H
= f(
))
F =
,
, …,
{
}
F F
F
1
2
N

Feedback Techniques for MIMO Channels
121
of possible precoding matrices where
Because the codebook has 2B
elements, the chosen matrix F can be conveyed from the receiver to trans-
mitter using a B bit pattern. This codebook-based approach has been used
to study limited feedback beamforming [48,63,67], precoded orthogonal
space–time block codes [46,47,57], precoded spatial multiplexing
[58,62,73,74,76], and transmit covariance optimization [7,49].
The problem of quantized signal adaptation is similar to channel VQ.
Solving the problem requires identifying an objective function and a code-
book. The major difference is that the channel is not quantized directly, rather
some function of the channel is quantized. Second, the objective is typically
not to minimize distortion, rather it is to maximize performance. For exam-
ple, we may choose the F such that the SNR (as a function of the channel)
is maximized, rather than choosing F to best approximate the unquantized
solution. This is possible since system performance is a function of the chosen
precoder; the distortion does not directly play a role but indirectly affects
system performance.
5.4
Quantized Signal Adaptation Algorithms
The analysis and design of limited feedback precoders is highly dependent
on the type of underlying open-loop system. We will address the design for
beamforming, precoded orthogonal space–time block coding, and precoded
spatial multiplexing.
5.4.1
Beamforming Example and Summary of Approach
To illustrate the use of quantized signal adaptation consider an Mt transmit
antenna by Mr receive antenna narrowband MIMO wireless system perform-
ing transmit beamforming with an optimal maximum likelihood (ML)
receiver. With beamforming a single transmit stream is weighted by a beam-
forming vector determined by the channel H. The baseband input-output
relationship for this system after combining can be written as
(5.4)
where
is the
narrowband channel response, f is an Mt dimen-
sional beamforming vector, s is a complex number taken from a transmit
constellation, n is a noise term, and ·2 is the vector two-norm. Note that the
temporal dependence of the symbol has been abstracted out. Transmit beam-
forming achieves a strong resilience to fading by adapting the vector f to
the current channel conditions. Given a symbol s to be transmitted, the ith
N
B
=
.
2
y
s
n
=
+
Hf
2
H
M
M
r
t
×

122
MIMO System Technology for Wireless Communications
entry of the vector
is then transmitted on the ith transmit antenna. We
will assume that E[s2] = Js and that n is distributed according to CN(0, N0).
Note that the average transmit power conditioned on a beamformer is given
by
Therefore, we will restrict
to have unit norm.
Because the vector
is a function of current channel conditions, some
knowledge of
is necessary at the transmitter. We propose to take a code-
book-based approach to use a limited number of feedback bits to convey
channel state information. The solution proposed in [61,63] is to restrict f to
be a member of a codebook F = {f1, f2, …, fN}. This codebook is designed
off-line, known to both the transmitter and receiver, and ﬁxed for all time.
There are two main challenges, given this kind of feedback architecture. First,
a method must be determined for choosing a beamforming vector from the
codebook F to send back. The chosen vector is conveyed to the transmitter
using
bits of feedback. Second, we must determine how to con-
struct the codebook F.
In a beamforming system, maximizing the average receive SNR corre-
sponds to simultaneously minimizing the probability of error and maximiz-
ing the channel capacity. Therefore, the receiver, which has knowledge of H
from training, chooses one of the vectors in F to maximize the receive SNR.
Assuming optimal maximum ratio combining, the post-combining average
SNR is given by
Therefore, the receiver can choose the transmit beamforming vector by
performing a brute force search over the N vectors in the codebook F to solve
We can address the codebook design issue by deﬁning a distortion and
solving for a codebook that minimizes the distortion. Consider the distortion
(5.5)
deﬁned by taking an expectation of the beamforming gain loss (i.e., the
difference between the beamforming gain obtained by using the optimal
unquantized vector
and the beamforming gain obtained using the code-
book F ) with respect to the channel. This distortion can be bounded as [63]
(5.6)
fs
2
2
f Js.
f
f
H
log2 N
¬­
¼½
out
s
N
SNR
= Hf
2
2
0
J
f
Hf
f
=

argmax


F
2
2
D
E
opt
(
)
max
F
F
=


¬
®
­
­
¼
¾
½
½
Hf
Hf
f
2
2
2
fopt
D
E
E
(
)
max
F
F
f

©
«ª
¹
»º
¬
®­
¼
¾½
¬
®
­
­
¼
¾
½
½


H
v f
f
2
2
2
1

Feedback Techniques for MIMO Channels
123
(5.7)
where v is the dominant right singular vector of H and
(5.8)
Differentiating the bound in Equation 5.7 shows that I should be maxi-
mized. Note that
is a subspace distance. Thus we should think of the codebook as a ﬁnite set
of subspaces rather than a ﬁnite set of vectors. The set of M-dimensional
subspaces in
is known as the Grassmann manifold
From the theory of Grassmannian manifolds [5], the design of the code-
book F was found to relate to Grassmannian line packing. Grassmannian line
packing is an exciting area of coding theory where ﬁnite sets of subspaces
are designed such that the minimum distance between any pair of subspaces
is as large as possible. These kinds of codes can be designed using techniques
from the theory of non-coherent code design [32], numerical techniques [10],
alternating projection algorithms [93], and algebraic techniques [87].
Figure 5.2 shows the symbol error rate performance of a four transmit and
ﬁve receive antenna beamforming system transmitting 16-QAM. Optimal
maximum ratio combining is used at the receiver. Signal adaptive beam-
forming using a 6-bit codebook designed with the criterion in [63] outper-
forms 40-bit (2 bits per complex entry) channel quantization by
approximately 1 dB. Limited feedback signal adaptive beamforming also
performs within 0.7 dB of full transmit channel knowledge, unquantized
beamforming.
The reason for the dramatic performance gains with the limited feedback
signal adaptive approach over channel quantization is because the quanti-
zation problem focuses strictly on the singular vector structure of the channel.
The 40-bit channel quantization has such large quantization error that the
fragile eigen-structure of the channel is often mangled at the transmitter. The
lack of reliable eigen-structure information at the transmitter causes a loss
in performance for the beamformer.
5.4.2
Precoded Orthogonal Space–Time Block Codes
As other chapters have shown, orthogonal space–time block coding (OST-
BCing) is an effective technique to combat the effects of fading with multiple
f
©
«ª
¹
»º
+

¬
®
­
­
¼
¾
½
½


E
N
N
M
M
t
t
H
2
2
2
2
1
2
1
4
2
1
I
I
(
)
(
)
I
2
©
«ª
¹
»º
©
«
ªª
¹
»
ºº
©
«
ª
ª
¹
»
º
º
I =

f < f
min
*
1
1
2
1
k
N
k l
f f
d(
)
f f
f f
1
2
1 2
2
1
,
=


Mt
G(
)
M M
t,
.

124
MIMO System Technology for Wireless Communications
transmit antennas. The performance of OSTBCs, however, can be improved
by leveraging channel knowledge at the transmitter [47].
At the kth transmission, an OSTBC encoder maps a block of ns symbols s1,
s2, …, sns taken from a constellation S to an
(with
space–time
code matrix
The power is constrained so that [40]
(5.9)
for all
In addition, we will assume that the constellation has been normal-
ized so that
The space–time block codeword
is precoded by an
matrix F.
As in the limited feedback beamforming case, this matrix will be restricted
to lie in a codebook F = {F1, F2, …, FN}. The matrix
is restricted according
to a peak power constraint for all
such that
The matrix
will
be further restricted, but this restriction will be developed later.
We will assume a narrowband MIMO system with a spatially uncorrelated,
memoryless linear channel that is constant over several codeword transmis-
sions before independently changing. These assumptions allow the system
input-output expression to be written as
(5.10)
FIGURE 5.2
Performance of limited feedback beamformer for a four-transmit and ﬁve-receive antenna
system using 16-QAM. This plot demonstrates the beneﬁts of using quantized signal adaptation
rather than direct channel quantization.
−8
−6
−4
−2
0
2
4
10−4
10−3
10−2
10−1
100
Eb/N0 (dB) 
Probability of symbol error 
Optimal beamforming 
Quantized channel(40 bit) 
Grassmannian BF(6 bit) 
M
T
×
M
Mt
<
)
C
c
c
c
( )
[ ( )
( )
( )]
k
k
k
k
T
=
…
.
1
2
C
C
I
( ) ( )
k
k
s
l
n
l
M
s

=
©
«
ª
ª
ª
ª
¹
»
º
º
º
º
= ¨
1
2
k.
E
s
s
l
l | |2
1
¬
®­
¼
¾½ = .
C( )
k
M
M
t ×
F
F F
Q1
1
{ }
F f .
F
Y
HFC
N
=
+
W
M

Feedback Techniques for MIMO Channels
125
where
is the
channel matrix with independent entries distributed
as CN(0,1), W is the signal-to-noise ratio (SNR), and
is an Mr × T noise
matrix with independent entries distributed according to CN(0,1). The
receiver has perfect knowledge of
and
and it decodes
using optimal
ML decoding.
To implement a limited feedback precoded OSTBCing system, two main
problems must be addressed. First, we must develop a selection criterion to
choose
from F. Second, we must determine how to design the codebook
F to maximize some performance criterion.
We will deﬁne performance with respect to the symbol error rate (SER)
given
denoted by Pr(ERRORH). Using the orthogonality properties of
OSTBCs, it can be shown that
(5.11)
where L is a function that depends on W, M, and S [46,47]. Because the SNR,
constellation, and signaling architectures are ﬁxed during transmission, max-
imizing
corresponds to minimizing the SER bound. This yields a nat-
ural precoder selection criterion. The receiver chooses the linear precoder F
according to
(5.12)
Consider the optimal precoder
chosen to maximize
over the set
of maximum singular value constrained matrices L(Mt, M). This matrix Fopt
will not be unique over L(Mt, M) because for arbitrary U  U(M,M), HFoptF =
HFoptUF. Denote singular value decomposition (SVD) of
by
(5.13)
where
and 8 is an Mr × Mt diagonal matrix
with Qj{H} at entry
Let
denote the matrix taken by selecting the ﬁrst
M columns of
The following lemma summarizes
LEMMA 5.1
[57] The precoder matrix
maximizes
over L(Mt, M).
Lemma 5.1 tells us that not only should
but Qj{Fopt} = 1 for 1 f
j f M. Intuitively, this means that we should perform waterﬁlling to maxi-
mize
compound channel when transmitting with a peak power con-
straint. When the transmitter has no a priori knowledge of
the transmitter
will have no knowledge of
Therefore, we will use a limited feedback
path to convey a suboptimal precoder. The following lemma shows that any
H
M
M
r
t
×
N
H
F,
Y
F
H
Pr ERROR
exp
F
H
HF
(
) f

©
«
ª
ª
¹
»
º
º
L
2
HF
F
F
HF
F
=

argmax


F
F
Fopt
HFopt F
2
H
H
V
V
=

L
R
8
V
V
R
t
t
L
r
r
M M
M M

,

,
U
U
(
),
(
),
(
)
j j, .
VR
VR.
Fopt.
F
V
opt
R
=
HFopt F
Q1
1
{
}
Fopt =
HF
F
2
H,
VR.

126
MIMO System Technology for Wireless Communications
suboptimal linear precoder should always have unit singular values under
a maximum singular value constraint in order to minimize the SER.
LEMMA 5.2
[57] Let FeL(Mt, M) have a singular value decomposition
such that
Given this,
when
Proof: Let
be deﬁned as in the lemma. Using (i) the invariance of the
Frobenius norm to unitary transformation, (ii) the singular value bound for
Fe, and (iii) the lemma’s deﬁnition of
Lemma 5.2 is important because it tells us that the precoder should always
be designed to have singular values that are as large as possible. Because of
the maximum singular value restriction, this singular value maximization
result corresponds to designing precoders in the set U(Mt, M) rather than
L(Mt, M). For this reason, we will restrict our codebook precoders to lie in
U(Mt, M) (i.e.,
We would like the quantized equivalent channel
to provide SER per-
formance close to that provided by the optimal precoded equivalent channel
HFopt when F is restricted to F. One method for doing this was proposed in
[57] by using the average of the loss in received channel power as a measure
of distortion. Using this deﬁnition of performance loss, the average distortion
of the codebook is given by
(5.14)
It was shown in [54,55,57] that the average distortion can be bounded as
(5.15)
This bound on the average distortion can be thought of as the product of
two different terms. The ﬁrst term relates to the distribution of the maximum
channel singular value, which is not under the control of the system designer.
The second term represents the “quality” of the codebook F and can there-
fore be optimized.
Before dealing further with the codebook design, we must review some
properties and notations dealing with ﬁnite subsets of U(Mt, M). The column
space of each matrix in U(Mt, M) corresponds to an M-dimensional subspace
of
The set of all subspaces in
is known as the complex Grassmann
e =

F
U
U
L
R
,
Q M{
}e < .
F
1
HF
HF
e
f
F
F

F
U
I
=
.
L
M
T
[
]
0
e
F
F,
HF
HU
HU
I
HF
e
=
f
=
F
L
F
L
M
T
F
F
,
[
]
0

F F
I

=
.
M)
HF
E
opt F
F
H
F
HF
HF
min

©
«
ª
ª
¹
»
º
º
¬
®
­
­
­
¼
¾
½
½
½

F
2
2
E
E
opt F
F
H
F
H
HF
HF
min

©
«
ª
ª
¹
»
º
º
¬
®
­
­
­
¼
¾
½
½
½

f
F
2
2
1
Q2
2
1
2
{
}
min
*
H
V V
FF
H
F
¬®
¼¾



¬
®
­
­
­
¼
¾
½
½
½
E
F
R
R
F
Mt.
Mt

Feedback Techniques for MIMO Channels
127
manifold
[105]. Just as in the traditional Euclidean space, the Grass-
mann manifold can have distances deﬁned on it. The chordal distance between
subspaces
and
where
denotes the subspace generated by F, is
given by
(5.16)
Consider the set of subspaces
generated by the code-
book matrices
This ﬁnite set of subspaces can be thought
of as a subspace code or subspace packing in
Just as in binary
coding theory, we can deﬁne the minimum distance of a packing:
(5.17)
In applied mathematics, the Grassmannian subspace packing problem is
the problem of choosing N subspaces (i.e., designing an N element subspace
code) in order to maximize the minimum distance I.
Using a metric ball approach, the “codebook quality” term in Equation
5.15 can be approximately bounded as [57]
(5.18)
This bound is a decreasing function of I when
which
can be easily proven by differentiating the bound and noting that
Thus maximizing I approximately minimizes Equation 5.18. This establishes
that a low-distortion, high-performance codebook can be designed by pack-
ing subspaces in the Grassmann manifold using the chordal distance metric.
Note that when M = 1, this bound corresponds to the beamforming scenario
discussed in the previous section.
The experiment shown in Figure 5.3 compares the performance of antenna
subset selection [23] with 8-bit chordal distance precoding on an 8 × 1
wireless system transmitting an
Alamouti code constructed from
16-quadrature amplitude modulation (QAM). For comparison, the SER per-
formance for an Alamouti code transmitted on a
system is also shown.
For example, at an error rate of 10–3, antenna subset selection gives an 8 dB
gain over the two antenna open-loop system. An additional gain of approxi-
mately 1.4 dB results from using 8-bit feedback chordal distance precoding.
5.4.3
Precoded Spatial Multiplexing
In spatial multiplexing, a bit stream is demultiplexed into
different bit
streams that are independently modulated using the same constellation S.
G(
)
M M
t,
PF1
PF2 ,
PF
d
F
(
)
F F
F F
F F
1
2
1 1
2
2
1
2
,
=



V
P
P
P
=
,
, …,
{
}
F
F
F
1
2
N
F
N
=
,
, …,
.
{
}
F F
F
1
2
G(
)
M M
t,
.
I =
,
f < f
min
(
)
1 k l N
k
l
d F F
E
M
N
F
R
R
M M o
t
H
F
V V
FF
min
*
(


¬
®
­
­
­
¼
¾
½
½
½
+

<
+
~
F
1
2
2
2
M
Mt
M
M
)
I
I
2
1
4
2
©
«ª
¹
»º

©
«ª
¹
»º
2
2 3
M M
o M
t
t
+
>
/ ,
(
)
I <
.
M
M = 2
2
1
×
M

128
MIMO System Technology for Wireless Communications
At time instance K, the M symbols can be written as a vector sk =
[sk,1 sk,2 … sk,M]T with Esk [sksk*] = IM. In precoded spatial multiplexing, the sym-
bol vector
is multiplied by an
matrix F before transmission pro-
ducing a length Mt dimensional vector
where
is the total transmit energy,
is the number of transmit antennas,
and
This formulation allows the baseband, discrete-time input-output relation-
ship to be written as
(5.19)
where
is an
channel matrix and
is a length
noise vector.
The receiver, which is assumed to have perfect knowledge of H and F,
decodes the received vector
using a vector decoder to produce a hard
decoded symbol vector ˆsk. We assume the channel matrix H to have inde-
pendent CN(0,1) entries, and the noise vector
to have independent
CN(0, N0) entries.
FIGURE 5.3
Symbol error rate comparison of two-antenna open-loop Alamouti space–time coding, eight
transmit antenna subset selection combined with an Alamouti code, and eight antenna 8-bit
feedback precoding combined with an Alamouti code. The constellation was assumed to be
16-QAM, and the receiver was assumed to have a single antenna.
4
6
8
10
12
14
16
18
20
22
24
26
Probability of symbol error 
No precoding(2 × 1)
Ant select 
Grass 8 Bit
10−3
10−2
10−1
100
Es/N0 (dB) 
sk
M
M
t ×
x
Fs
k
s
k
M
=
J
Js
Mt
M
M
t v
.
y
HFs
n
k
s
k
k
M
=
+
J
H
M
M
t
r
×
nk
Mr
y k
nk

Feedback Techniques for MIMO Channels
129
The precoding matrix
is chosen at the receiver from a ﬁnite set of possible
precoding matrices F = {F1, F2, …, FN} known to both the transmitter and
receiver. The receiver sends the binary index of the chosen precoding matrix
back to the transmitter over a limited capacity, zero-delay feedback link. As
in the precoded OSTBC scenario, each
has unit column vectors that
are orthogonal. This orthogonality assumption is not especially restrictive
since it follows from the form of the optimal spatial multiplexing precoders
derived in [81] that consist of a matrix with orthogonal columns pre-multi-
plied by a diagonal matrix.
As with beamforming and precoded OSTBCing, we need to (i) determine
how to choose the precoded F given a codebook F and (ii) design the
codebook F. Unlike the other algorithms, spatial multiplexing is often imple-
mented with a variety of different decoder algorithms. We will brieﬂy discuss
the different decoders and their accompanying precoder selection criterion.
5.4.3.1
Precoder Selection for Spatial Multiplexing
Maximum Likelihood Receiver Inspired Selection
The ML receiver decodes to ˆsk by solving
(5.20)
To improve probability of error performance, it is of interest to ﬁnd a
closed-form expression for the probability of symbol vector error. Unfortu-
nately, a closed-form expression for the probability of symbol vector error
has yet to be derived in the literature. One solution is to upper bound the
probability of symbol vector error for high signal-to-noise ratios (SNR) using
the vector Union Bound [30]. Since we assume that the SNR Js/N0 is held
constant, the Union Bound is solely a function of the receive minimum
distance of the multidimensional constellation SM [30]. This motivates the
following criterion for ML receivers.
SC-ML: Pick
such that
(5.21)
Linear Receiver Inspired Selection
Unlike ML decoding, linear receivers can be designed in different ways
depending on the desired decoding matrix
A linear decoder decodes to
the vector ˆsk = Q(Gyk) where G is an
matrix and
is a function
that performs single-dimension maximum likelihood decoding for each
entry of a vector.
F
F F
k
k
s
M
M
ˆs
y
HFs
s
=


argmin
S
2
2
J
F
F
HF s
s
F
s s
s
s
=


,

:
|
©
«ª
argmax


F
Smin
1
2
1
2
1
2
M
s
M
J
¹
»º
2
G.
M
Mr
×
Q( )

130
MIMO System Technology for Wireless Communications
Minimum Singular Value
It was shown in [29] that the performance of a spatial multiplexing system
using a linear receiver is characterized by the minimum substream SNR.
Maximizing the minimum singular value provides a close approximation
to maximizing the minimum substream SNR [29]. The reason for this is that
as card(W) grows large, the probability of an error vector lying collinear to
the minimum singular value direction goes to one. This motivates the fol-
lowing criterion
SC-MSV: Pick
such that
(5.22)
Minimum Mean Squared Error Receiver: Minimizing some function of the
mean squared error matrix has been studied in [81] to improve the overall
system performance. The average mean squared error when decoding with
a minimum mean squared error (MMSE) linear decoder is
(5.23)
We can use Equation 5.23 to derive a selection criterion for choosing F
from F.
SC-MSE: Choose
such that
(5.24)
where
is either
(the trace of a matrix) or
(the determinant of a
matrix).
Capacity Selection
The ﬁnal criterion can be used for both ML and linear receivers. When the
transmitter precodes with
before transmission, we can view the system as
experiencing an effective channel of
Thus the mutual information
assuming independent and identically distributed Gaussian signaling for a
ﬁxed realization of
and a ﬁxed
is given by
(5.25)
Therefore, a capacity selection can be derived from Equation 5.25.
F
F
HF
F
=

argmax


F
Qmin{
}
MSE( )
F
I
F H HF
=
+
©
«ª
¹
»º



J
J
s
M
s
M
MN
1
0
F
F
F
F
=
(
)

argmin
MSE


F
m
( )
m( )
tr( )
det( )
F
HF.
H
F
I
det
MN
M
s
( )
log
F
I
F H HF
=
+
©
«ª
¹
»º


2
0
J

Feedback Techniques for MIMO Channels
131
SC-Capacity: Choose
such that
(5.26)
5.4.3.2
Codebook Design for Spatial Multiplexing
As with precoding for OSTBCing we will think of the codebook as a set of
subspaces in
Thus, the limited feedback precoded spatial multiplexing
codebook F represents a set, or packing, of subspaces in the Grassmann
manifold. We will use the subspace coding interpretation to simplify notation
and analysis.
The measure on
induces a normalized invariant measure µ on
G(Mt, M). Volumes can be computed within G(Mt, M) using this induced
measure. In addition to the chordal distance, a number of other distances
can be deﬁned on G(Mt, M) [5]. The projection two-norm, and Fubini-Study
distances between the two subspaces
and
are given by
Let
denote the set of subspaces obtained from the col-
umn space of the matrices in
The minimum distance of this packing is
(5.27)
where
is a distance function on
Understanding the optimal unquantized matrix will allow us to under-
stand how to design F. The ﬁrst important point to notice is contained in
the following lemma.
LEMMA 5.3
[54,55] Let
where
and 8 has diagonal entries
The optimal unquantized precoding matrix (i.e., F  U(Mt,
M)) for each of the criteria in Section 5.4 is
the ﬁrst M columns of
For SC-ML it was shown in [30] that the receive minimum distance is
approximately maximized by maximizing the minimum singular value of
HF. SC-MSE using the trace cost function chooses
that minimizes
Equation 5.23. For high SNR with
scaled to unity, the trace of Equation
5.23 can be approximated by tr [(FHHF)–1]. However,
F
F
F
F
=

arg max ( )


F
I
Mt.
U(
)
M M
t,
PF1
PF2
d
d
d
proj
FS
(
)
(
)
arccos
F F
F F
F F
F F
1
2
1 1
2
2 2
1
2
,
=

,
=


et F F
1
2

©
«ª
¹
»º
S
P
P
P
=
,
, …,
{
}
F
F
F
1
2
N
F.
I =
,
f < f
min
(
)
1 i j N
i
j
d F F
d( )
,
G(
)
M M
t,
.
H H
V
V


=
R
R
8
VR
t
t
M M
U(
,
)
Q
Q
Q
1
2
2
2
2
0
v
v…v
v .
Mt
VR,
VR.
F F
N0

132
MIMO System Technology for Wireless Communications
(5.28)
Therefore this bound requires the maximization of
Thus the SC-MSV and the bounds on SC-ML and SC-MSE using the trace
cost function all lead to maximizing
We will therefore use our
codebook to minimize
(5.29)
for SC-ML, SC-MSE using the trace cost function, and SC-MSV where once
again
is the Mth largest singular value of
Using the subspace pack-
ing properties of F, we will show that Equation 5.29 can be bounded by a
decreasing function of the minimum projection two-norm distance of F,
denoted by
Codebook Design Criterion 1 [58]: Codebooks for systems using SC-ML,
SC-MSV, and SC-MSE using the trace cost function to select F from F,
should be designed by using an N subspace packing in the Grassmann
manifold that maximizes the minimum projection two-norm distance.
It was shown in [54,55] that selecting F F using SC-MSE with the deter-
minant cost function is equivalent to maximizing
~I(F) where
Thus the codebook design criterion for SC-Capacity and SC-MSE with the
determinant cost function must be identical.
Note that
(5.30)
Using the above analysis and observing that
we will use the cost function
min
min
{
}
min
F
F
F H HF
HF





(
)
©
«ª
¹
»º f
F
F
tr
M
1
2
Q
Qmin{
}
HF .
Qmin{
}
HF .
E
E
opt
M
H
F
H
HF
HF
Q
Q
Q
min
min
{
}
max
{
}
{
2
2
2

¬
®­
¼
¾½ =
F
H
HF
F
}
max
{
}
min

¬
®­
¼
¾½
F Q2
Q M{
}
H
H.
Iproj.
I
det
MN
M
s
( )
F
I
F H HF
=
+
©
«ª
¹
»º


J
0
I
det
det
MN
R
M
s
T
( )
*
F
V F
I
v
(
)
+
©
«ª
¹
»º
2
0
J
8 8
I
det
MN
opt
M
s
T
(
)
F
I
=
+
©
«ª
¹
»º
J
0
8 8

Feedback Techniques for MIMO Channels
133
(5.31)
where Equation 5.31 follows from the independence of
and
Using the subspace packing interpretation of F, this distortion cost func-
tion can be bounded by a decreasing function of the minimum Fubini-Study
distance of F, denoted by
This yields the following design criterion.
Codebook Design Criterion 2 [58]: Codebooks for systems using SC-
MSE with the determinant cost function or SC-Capacity to select
from
F should be designed by using an N subspace packing in the Grassmann
manifold that maximizes the minimum Fubini-Study distance.
Finding good Grassmannian packings for arbitrary
and
is actu-
ally quite difﬁcult [10]. The codebook design difﬁculty is only increased for
the non-standard projective two-norm and Fubini-Study distances [5]. One
practical technique for designing good packings is to use the non-coherent
constellation designs from [32]. This design algorithm usually yields code-
books with large minimum distances and can be easily modiﬁed to work
with any distance function on the Grassmann manifold.
Figure 5.4 demonstrates the problems associated with directly quantizing
the matrix channel
and the beneﬁts of using a precoder codebook. A 4 × 2
wireless system using M = 2 and 16QAM was simulated. For a probability
of symbol vector error of 10–2, directly quantizing the channel with 16 bits
of feedback performs approximately 4.7 dB worse than a 6-bit limited feed-
back precoder. With only 6 feedback bits, the limited feedback precoder
obtains performance almost identical to the unquantized MMSE precoder with
the maximum singular value power constraint.
5.5
Effect of Spatial Correlation
In the previous sections, the channel was modeled as a spatially uncorrelated
Rayleigh fading channel. This assumption was used to derive codebook
design criteria. Real channels will experience spatial correlation. In this sec-
tion, we will present some results that show that diversity performance is
not compromised for our codebook designs.
There are several models for spatial correlation. One of the most popular
models was studied in the Information Society Technologies (IST) Multi-
Element Transmit and Receive Antennas (METRA) Project [18] funded by
E
det
MN
det
det
M
s
T
R
H
F
I
V F
I
+
©
«ª
¹
»º 
(
)

J
0
2
8 8
max
*
F
M
M
s
T
M
s
T
MN
E
det
MN
+
©
«ª
¹
»º
¬
®
­
¼
¾
½
=
+
J
J
0
0
8 8
8
H
I
8
©
«ª
¹
»º
¬
®
­
¼
¾
½

(
)
¬
®­
¼
¾½
©
«ª

1
2
E
det
R
H
F
V F
max
*
F
¹
»º
8
VR.
IFS.
F
M
M
t,
,
N
H

134
MIMO System Technology for Wireless Communications
the European Union. The IST METRA model generates the channel H accord-
ing to [96]
(5.32)
where
is a random matrix with i.i.d. CN(0,1) entries,
is the receive
antenna correlation matrix, and
is the transmit antenna correlation
matrix. The correlation matrices
and
can be measured or computed.
Measured correlation matrices were discussed in [44], while computational
methods for obtaining the correlations were studied in [19,83,96].
Note that the IST METRA model is not a fully correlated model [47] and
can be thought of as a transmit-receive correlated model. The correlation is
isolated to only transmit and receive correlation. This kind of correlation
simpliﬁcation was experimentally veriﬁed in [42–44,82,89,98]. Recently, this
model has been adopted by the IEEE 802.11n wireless local area network
working group as a MIMO channel model [96] and has been studied for use
in IEEE 802.20 working group on mobile broadband wireless access [85].
Because of its wide use, this model is one of the cornerstones by which most
MIMO algorithms are tested before implementation.
System performance on transmit-receive correlated models is highly
dependent on the correlation matrices. It is therefore imperative to under-
stand the requirements that
and
must maintain to guarantee full
diversity order. We will characterize the diversity order of beamforming and
precoded OSTBCing in transmit-receive correlated fading assuming optimal
combining.
FIGURE 5.4
Comparison of the probability of symbol vector errors for 16-bit direct channel quantization,
unquantized MMSE, and 6-bit limited feedback precoding on a 2 substream 4 × 2 system using
16QAM.
−2
0
2
4
6
8
10
12
14
16
Prob. of symbol vector error 
10−3
10−2
10−1
100
Eb/N0 (dB) 
MMSE(max SV)
Quant. chann. 16 bit MMSE
Grass 6 bit(MSE det)
H
R
GR
=
/
/
R
T
1 2
1 2
G
RR
RT
RR
RT
RR
RT

Feedback Techniques for MIMO Channels
135
THEOREM 5.1
[60] Beamforming and combining over memoryless, correlated Rayleigh fading chan-
nels provide a diversity order of
if and only if (i) the vectors in the beamformer
codebook F span
(ii) the rank of
is Mt, and (iii) the rank of RR is
Theorem 5.1 provides the intuition that the limited feedback codebook
must always form a basis for the vector space of possible dominant singular
value directions. Thus, it is impossible for the optimal direction to be orthog-
onal to all of the codebook vectors. The correlation matrices change the
distributions of left and right singular vectors. It is important, however, that
the correlations allow for the full number of degrees-of-freedom.
THEOREM 5.2
[52] Precoded OSTBCing provides a diversity of order
if and only if (i) the
matrix
has a rank of Mt, (ii) the rank of
is Mt, and (iii) the rank
of
is
If given a sufﬁcient rate of feedback, limited feedback algorithms can
obtain identical diversity orders to the diversity order from perfect channel
knowledge closed-loop schemes. To obtain full diversity order, Theorem 5.2
tells us that precoded OSTBCing requires log2(Mt/M) bits of feedback
because the dimension of
for all i is
This differs from the result
in Theorem 5.1, which says that limited feedback beamforming requires
log2 (Mt) bits of feedback. Thus, precoded OSTBCing can provide full diver-
sity order with lower rate feedback. This beneﬁt, however, comes at the
expense of a performance loss for higher feedback amounts.
5.6
Feedback in Broadband Channels with MIMO-OFDM
Previous sections addressed the theory of limited feedback MIMO commu-
nication based on precoder quantization and studied their practical perfor-
mance in narrowband channels. Most developing wireless standards though
are broadband, typically employing some form of OFDM modulation. In
this section we describe how the aforementioned concept of limited feedback
can be extended to the MIMO-OFDM setting. The key idea is to reduce feed-
back by exploiting the correlation of adjacent subcarriers. We describe the
application to beamforming in detail. Extensions to precoding are more
brieﬂy described. Limited feedback for MIMO-OFDM has recently been
adopted as an option in the IEEE 802.16 standard.
5.6.1
MIMO-OFDM System Model and Limited Feedback
OFDM modulation uses a cyclic preﬁx and discrete Fourier transform (DFT)
operations to convert the linear convolution in Equation 5.2 to a multiplication.
M M
t
r
Mt ,
RT
Mr.
M M
t
r
E
F F
F
= [
]
1
2 
N
RT
RR
Mr.
Fi
M
M
t ×
.

136
MIMO System Technology for Wireless Communications
By sending information in the frequency domain, OFDM converts a linear
convolution into a set of parallel narrowband channels. Precoding can thus
be applied independently per subcarrier.
Consider a MIMO-OFDM system with an M-point DFT, and cyclic preﬁx
that is longer than L, the memory of the discrete-time channel. For illustration
in this section we will discuss precoded spatial multiplexing systems. Exten-
sions to other forms of space–time coding follow in a similar fashion. Let
be the multivariate response of the channel in the frequency domain. Math-
ematically the input-output relationship of a MIMO-OFDM system with
precoding is
(5.33)
where
is the precoding matrix for subcarrier k and k = 0, 1, …, M – 1.
A straightforward application of precoded spatial multiplexing entails that
the precoder for each subcarrier
is quantized and the appropriate index
is sent back to the transmitter. For a codebook F of cardinality N = 2b, this
requires feedback of Mb bits to relay the precoders for the whole OFDM
symbol. The feedback requirements grow in proportion to M, the number
of subcarriers. The channels for adjacent subcarriers, however, are correlated.
Based on this, it can also be shown that the adjacent precoders, in some
sense, are also correlated [9]. Feedback can thus be reduced by exploiting
the correlation and sending back less information per subcarrier.
5.6.2
Interpolated Beamforming in MIMO-OFDM
First we consider the special case of transmit beamforming. This allows us
to present the essence of the extension to MIMO-OFDM before getting into
the full complexity of precoding. With transmit beamforming, the receiver
processing consists of matched ﬁltering and scalar detection for each sub-
carrier. The combined signal at subcarrier k can be expressed as
(5.34)
where
is the receive combining vector, chosen to be H(k)f(k), which in
this case corresponds to maximum ratio combining at the receiver.
A simple beamforming method for using the correlation of the beamforming
vectors is to combine the neighboring subcarriers into a cluster. The idea is to
choose the cluster size to be less than the coherence bandwidth of the chan-
nel, thus all subcarriers see the same effective channel. Then a representative
H( )
( )
k
l e
l
L
j
kl M
=
=
¨
0
2
H
U
y
F
s
n
( )
( ) ( ) ( )
( )
k
k
k
k
k
=
+
H
F( )
k
F( )
k
r k
k
k
k s k
k
k
N
H
( )
( ){
( ) ( ) ( )
( )}
=
+
,
f
f
z
f
n
H
1
z( )
k

Feedback Techniques for MIMO Channels
137
beamforming vector is chosen for the whole cluster. A simple approach,
which we call clustering, is to use the beamforming vector for the middle
subcarrier of the cluster for all the subcarriers in the cluster [8]. A better
approach, which we call modiﬁed clustering, chooses the best vector accord-
ing to some criteria [65] motivated by error rate or squared error.
An alternative to clustering is to use interpolation to reconstruct the trans-
mit beamforming vectors given a fraction of the beamformers f(lK + 1) where
K is the cluster size (which divides N) and
Conventional
interpolation, however, does not preserve the structure in the beamforming
problem. First, all beamforming vectors are unit norm due to the transmit
power constraint. This means that the optimal beamforming vector is a point
on a sphere. The interpolator should give outputs that are also on the sphere.
Second the optimal beamforming vector is not unique. The reason is that if
one examines the effective channel gain
both f(k) and ejO f(k)
have exactly the same value. Thus the best beamforming vector is not unique.
To solve this problem, we proposed a modiﬁcation of the spherical inter-
polator in [99] that includes a phase rotation parameter [8]. This interpolator
performs a weighted average of the beamforming vectors and renormalizes
the result to place it on the unit sphere. Given {f(lK + 1), 0 f l f N/K – 1},
the proposed interpolator is expressed as
(5.35)
where ck = (k – 1)/K is the linear weight value,
are the quan-
tized transmit beamforming vectors, 1 f k f K, and
is a parameter for
phase rotation with 0 f l f N/K – 1. The role of
is to remove the distortion
caused by the arbitrary phase rotation of the optimal beamforming vectors.
To maximize the performance of the interpolator, the receiver evaluates
the optimal phase {/Q, 0 f l f N/K – 1} and sends this information back to
the transmitter along with the quantized beamforming vectors. In practice,
the set of possible phase values is quantized to
and
P is a desired number of quantization levels (we have found that P = 4 is
sufﬁcient). The feedback of
slightly increases the amount of feedback
information compared to clustering but results in better performance than
the simple clustering approach.
The phase can be optimized in different ways. We ﬁnd that maximizing
the minimum effective channel gain where 0 f l f N/K – 1 and
(5.36)
works well.
l
N K
= , , …,

0 1
1.
,( )
( ) ( ) ,
k
k
k
= H
f
2
ˆ(
)
(
)
(
)
{
((
)
f
f
f
lK
k
c
lK
c e
l
K
l
k
Q
k
j
Q
l
+ ;
=

+
+
+
/
1
1
1
/
+

+
+
+
+
1
1
1
1
1
)}
(
)
(
)
{
((
)
)}
c
lK
c e
l
K
k
Q
k
j
Q
l
f
f
/
f
f
(
)
( )
N +
=
1
1
/l
/l
6 =
,
,
,
,
{
}

0 2
4
2
1
U
U
U
P
P
P
P

(
)
,
{
}
/l
/
/
/
l
lK
k
lK
k
k
K
=
+
+ ;
, f
f

argmaxmin{
(
) (
)
}
6
H
f
2 1

138
MIMO System Technology for Wireless Communications
5.6.3
Interpolated Precoding in MIMO-OFDM
As with beamforming, a variety of methods can also be used for the more
general case of precoding in MIMO-OFDM including clustering, modiﬁed
clustering, and interpolation. Because the extension of the interpolator is not
trivial, we discuss it here.
The challenge with precoder interpolation is that the unitary property
and the invariance to right multiplication by a unitary
matrix, i.e.,
and
where
is a square unitary matrix give the same
performance, must be respected. The latter property implies that the optimal
precoder is not unique. The matrix Q, however, has a substantial inﬂuence
on the performance of an interpolator. Based on this observation, we propose
the following interpolation algorithm, which utilizes a unitary matrix Ql
and the quantized precoders
for l = 0, 1, …, N/K – 1
(5.37)
(5.38)
The proposed algorithm in Equation 5.37 and Equation 5.38 is a non-
obvious extension of the beamformer interpolator in Equation 5.35. Note
that
is the projection of
into
with respect to the Frobe-
nius norm (see Section III-F of [94]). Notice that
of Equation 5.35 is
replaced by
in Equation 5.37. In beamformer interpolation,
removes
the distortion caused by the arbitrary phase rotation of beamforming vectors.
Similarly, the role of
is to get rid of the distortion caused by the non-
uniqueness of the precoding matrices.
Given the subsampling rate
and the codebook F, the quantized precod-
ers {F(lK + 1), 0 f l f N/K – 1} are obtained by using the same criterion as
precoding design, e.g., SC-MSE or SC-Capacity. Since we are quantizing Ql
for limited feedback, we can numerically ﬁnd the best Q by selecting a matrix
from a codebook Q of unitary matrices. Given a codebook Q, we can ﬁnd
the best
in a similar way as before by optimizing
(5.39)
The performance and complexity are dependent on Q, the cardinality of Q.
A reasonable way to design Q is to employ the Frobenius matrix norm
and maximize the minimum norm between the entries of Q. A variety of
other approaches for codebook design are also possible; optimal quantization
of Q is still under investigation.
F
F
I
H
M
M
k
k
( ) ( ) =
1
F( )
k
F
Q
( )
k
Q
FQ lK
(
)
+ 1
Z
F
Q F
(
)
(
)
(
)
(
)
lK
m
c
lK
c
l
K
m
Q
m
l Q
+
=

+
+
+
+
(
)
1
1
1
1
ˆ(
)
(
)
(
) (
)
F
Q
Z
Z
Z
lK
m
lK
m
lK
m
lK
m
l
H
+
;
=
+
+
+
{
}
 1
2
ˆ(
)
F k;/
Z( )
k
U(
)
M M
t
s
,
ej/
Ql
ej/
Ql
K
Q
Q
F
Q
Q
l
MSE
lK
m
=
+
;
.

argmin max
(ˆ(
))
Q

Feedback Techniques for MIMO Channels
139
5.6.4
Performance Example
To illustrate the potential performance of limited feedback precoding for
MIMO-OFDM we provide a performance example in this section. In the
simulation, we consider a MIMO-OFDM system with parameters Mt = 4,
Mr = 2, Ms = 2, N = 64, and K = 8. We assumed that the discrete-time channel
impulse responses had 6 taps with uniform proﬁle and i.i.d. complex Gaussian
distribution; the channels between different transmit and receive antenna pairs
were independent;
was i.i.d. zero mean complex Gaussian; the feedback
channel had no delay and no transmission error; quadrature phase shift
keying (QPSK) modulation and MMSE detection were used for BER simu-
lations; and the transmit power was identically distributed to all subcarriers.
We compared antenna subset selection [29] where the best set of 2 out of
4 antennas is chosen for each subcarrier, simple clustering, the proposed
interpolator, and MMSE detection with the optimal precoder (with and with-
out quantization). To quantize the precoding matrices, we used the codebook
with F  = 64 requiring 6 bits of feedback for each precoding matrix which
was designed according to [54]. Also, we considered the codebook given in
[9]. Consequently, we used 64 feedback bits for the proposed method. In
antenna subset selection, the transmit antenna was selected independently
for each subcarrier, so 166 feedback bits were used. We used 48 feedback bits
for clustering and 384 bits for the optimal precoder with feedback for all
subcarriers. For comparison, we also considered the optimal precoder with-
out quantization.
Figure 5.5 shows the coded BER performance of the proposed and existing
precoding methods. The maximum minimum singular value criterion [29]
was used for antenna subset selection and
for the proposed scheme was
determined by Equation 5.39. For channel coding, we used a convolutional
code with generator polynomials g0 = 1338 and g1 = 1718 with coding rate
1/2, the interleaver deﬁned in the IEEE 802.11a standard extended for
64 subcarriers, and soft Viterbi decoding. The frame length was 30 OFDM
symbols and each OFDM symbol transmitted 128 bits. The proposed pre-
coder outperformed clustering and antenna subset selection, and had only
0.1 dB loss compared to the optimal MMSE with quantization. The quanti-
zation loss was about 1 dB even with per-subcarrier quantization. Clustering
obtains nearly as good performance with less feedback required.
5.7
Conclusions
In this chapter we presented an overview of closed-loop MIMO communi-
cation systems. We discussed both direct channel quantization and quantized
signal design, choosing to focus on the latter because it typically requires
less feedback. As concrete examples we discussed strategies for quantized
n( )
k
Ql

140
MIMO System Technology for Wireless Communications
beamforming and precoding for both spatial multiplexing and space–time
coding. We also summarized some extensions of quantized beamforming
and precoding for spatial multiplexing with MIMO-OFDM.
Other important aspects of limited feedback MIMO communication were
not considered in this chapter due to a lack of space. Perhaps the most
important omission is multi-mode precoding, where the number of spatial
streams M is also varied in the channel. Results along these lines are available
in [25,56,59]. We also overlooked the combination of adaptive modulation
and limited feedback, though naturally the two will be combined in a real
system. The effect of channel estimation error, delay in the feedback channel,
and, more generally, the effect of time variation of feedback performance
remain to be studied.
References
1. IEEE-SA Standards Board. 2001. “IEEE Standard for local and metropolitan
area networks part 16: air interface for ﬁxed broadband wireless access sys-
tems,” IEEE Std 802.16-2001, Dec. 2001, 16.-2001.
2. J. Akhtar and D. Gesbert. 2003. “A closed-form precoder for spatial multiplex-
ing over correlated MIMO channels.” Proc. IEEE Glob. Telecom. Conf., 4, Dec.
2003, pp. 1847–1851.
3. J. Akhtar and D. Gesbert. 2004. “Extending orthogonal block codes with partial
feedback.” IEEE Trans. Wireless Comm., 3, Nov. 2004, pp.1959–1962.
FIGURE 5.5
A bit error rate comparison of different limited feedback precoding schemes for MIMO-OFDM
with Mt = 4, M = 2, and Mr = 2. MMSE precoding with the trace constraint is considered and
compared with antenna subset selection per tone, simple clustering and optimal approaches
with and without quantization.
−3
−2
−1
0
1
Eb/No(dB)
2
3
4
5
6
Probability of bit error 
10−5
10−4
10−3
10−2
10−1
Antenna subset selection 
Clustering w/quant. 
Proposed w/quant. 
Optimal MMSE w/quant. 
Optimal MMSE w/o quant. 

Feedback Techniques for MIMO Channels
141
4. S.M. Alamouti. 1998. “A simple transmit diversity technique for wireless com-
munications.” IEEE Jour. Select. Areas in Commun. 16, Oct. 1998, pp. 1451–1458.
5. A. Barg and D. Yu. Nogin. 2002. “Bounds on packings of spheres in the Grass-
mann manifold.” IEEE Trans. Info. Th., 48, Sept. 2002, 2450–2454.
6. G. Bauch and J. Hagenauer. 2002. “Smart versus dumb antennas-capacities and
FEC performance.” IEEE Commun. Lett., 6, Feb. 2002, 55–57.
7. R.S. Blum. 2003. “MIMO with limited feedback of channel state information.”
Proc. IEEE Int. Conf. Acoust., Speech and Sig. Proc., 4, April 2003, 89–92.
8. J. Choi and R.W. Heath, Jr. 2004. “Interpolation based transmit beamforming
for MIMO-OFDM with limited feedback.” Proc. Int. Conf. on Commun., Paris,
France, 1, June 2004, 249–253.
9. J. Choi and R.W. Heath, Jr. 2004. “Interpolation based transmit precoding for
MIMO-OFDM with limited feedback.” Proc. Glob. Telecom. Conf., Dallas, Texas,
1, Nov.-Dec. 2004, 214–218.
10. J.H. Conway, R.H. Hardin, and N.J.A. Sloane. 1996. “Packing lines, planes, etc.:
packings in Grassmannian spaces.” Experimental Mathematics, 5, 139–159.
11. M.O. Damen, K. Abed-Meraim, and J.C. Belﬁore. 2002. “Diagonal algebraic
space-time block codes.” IEEE Trans. Inf. Th., 48, March 2002, 628–636.
12. R.T. Derryberry, S.D. Gray, D.M. Ionescu, G. Mandyam, and B. Raghothaman.
“Transmit diversity in 3G CDMA systems.” IEEE Comm. Mag., 40, April 2002,
68–75.
13. P.A. Dighe, R.K. Mallik, and S.S. Jamuar. 2003. “Analysis of transmit-receive
diversity in Rayleigh fading.” IEEE Trans. Commun., 51, April 2003, 694–703.
14. H. El Gamal and M.O. Damen. 2003. “Universal space-time coding.” IEEE Trans.
Inf. Th., 49, May 2003, 1097–1119.
15. H. El Gamal and A.R. Hammons, Jr. 2003. “On the design of algebraic space-
time codes for MIMO block-fading channels.” IEEE Trans. Inf. Th., 49, Jan. 2003,
151–163.
16. R.F.H. Fischer. 2002. Precoding and Signal Shaping for Digital Transmission, IEEE,
New York: Wiley-Interscience.
17. R.F.H. Fischer, C. Windpassinger, A. Lampe, and J.B. Huber. 2002. “Tomlinson-
Harashima precoding in space-time transmission for low-rate backward chan-
nel.” Proc. of Int. Zur. Sem. on Broadband Commun., pp. 7–1 to 7–6, Feb. 2002.
18. J.R. Fonollosa, R. Gaspa, X. Mestre, A. Pages, M. Heikkila, J.P. Kermoal, L.
Schumacher, A. Pollard, and J. Ylitalo. 2002. “The IST METRA project.” IEEE
Comm. Mag., 40, July 2002, 78–86.
19. A. Forenza, D.J. Love, and R.W. Heath, Jr. 2004. “A low complexity algorithm
to simulate the spatial covariance matrix for clustered MIMO channel models.”
Proc. IEEE Veh. Technol. Conf., May 2004.
20. G.J. Foschini. 1996. “Layered space-time architecture for wireless communica-
tion in a fading environment when using multiple antennas.” The Bell Sys. Tech.
Jour., 1, 41–59.
21. A. Goldsmith, S.A. Jafar, N. Jindal, and S. Vishwanath. 2003. “Capacity limits
of MIMO channels.” IEEE Jour. Select. Areas in Commun., 21, June 2003, 684–702.
22. D. Gore, R.W. Heath, Jr., and A. Paulraj. 2002. “Transmit selection in spatial
multiplexing systems.” IEEE Comm. Letters, 6, Nov. 2002, 491–493.
23. D.A. Gore and A.J. Paulraj. 2002. “MIMO antenna subset selection with space-
time coding.” IEEE Trans. Sig. Proc., 50, Oct. 2002, 2580–2588.
24. R.W. Heath, Jr. 2001. Space-time Signaling in Multi-Antenna Systems, Ph.D.
thesis, Stanford University, Nov. 2001.

142
MIMO System Technology for Wireless Communications
25. R.W. Heath, Jr. and D.J. Love. 2003. “Multi-mode antenna selection for spatial
multiplexing with linear receivers.” Proc. of Allerton Conf. on Comm. Cont. and
Comp., Oct. 2003.
26. R.W. Heath, Jr. and A. Paulraj. 1998. “A simple scheme for transmit diversity
using partial channel feedback.” Proc. of the Asil. Conf. on Sig. Sys. and Comp.,
2, Nov. 1998, 1073–1078.
27. R.W. Heath, Jr. and A. Paulraj. 1999. “Transmit diversity using decision-directed
antenna hopping.” ICC Comm. Theory Mini-Conf., June 1999, 141–145.
28. R.W. Heath, Jr. and A. Paulraj. 2002. “Linear dispersion codes for MIMO sys-
tems based on frame theory.” IEEE Trans. on Sig. Proc., 50, Oct. 2002, 2429–2441.
29. R.W. Heath, Jr., S. Sandhu, and A. Paulraj. 2001. “Antenna selection for spatial
multiplexing with linear receivers.” IEEE Comm. Letters, 5, April 2001, 142–144.
30. R.W. Heath, Jr. and A. Paulraj. 2001. “Antenna selection for spatial multiplexing
systems based on minimum error rate.” Proc. IEEE Int. Conf. on Commun., Vol. 7,
June 2001, 2276–2280.
31. J. Heiskala and J. Terry. 2002. OFDM Wireless LANs: A Theoretical and Practical
Guide, Indianapolis: SAMS.
32. B.M. Hochwald, T.L. Marzetta, T.J. Richardson, W. Sweldens, and R. Urbanke.
2000. “Systematic design of unitary space-time constellations.” IEEE Trans. Info.
Th., 46, Sept. 2000, 1962–1973.
33. H. Holma and A. Toskala, eds. 2001. WCDMA for UMTS: Radio Access for Third
Generation Mobile Communications, Revised Edition, New York: John Wiley &
Sons.
34. Z. Hong, K. Liu, R.W. Heath, Jr., and A.M. Sayeed. 2003. “Spatial multiplexing
in correlated fading via the virtual channel representation.” IEEE Jour. Select.
Areas in Commun., 21, June 2003, 856–866.
35. H. Jafarkhani. 2001. “A quasi-orthogonal space-time block code.” IEEE Trans.
Commun., 49, Jan. 2001, 1–4.
36. H. Jafarkhani and N. Seshardi. 2003. “Super-orthogonal space-time trellis
codes.” IEEE Trans. Inf. Th., 49, April 2003, 937–950.
37. G. Jöngren and M. Skoglund. 2000. “Utilizing quantized feedback in orthogonal
space-time block coding.” Proc. Glob. Telecom. Conf., 2, Nov. 2000, 995–999.
38. G. Jöngren and M. Skoglund. 2001. “Improving orthogonal space-time block
codes by utilizing quantized feedback information.” Proc. Int. Symp. on Info.
Theo., June 2001, 220.
39. G. Jöngren and M. Skoglund. 2004. “Quantized feedback information in orthog-
onal space-time block coding.” IEEE Trans. Info. Th., 50, Oct. 2004, 2473–2486.
40. G. Jöngren, M. Skoglund, and B. Ottersten. 2002. “Combining beamforming
and orthogonal space-time block coding.” IEEE Trans. Info. Th., 48, March 2002,
611–627.
41. M. Kang and M.-S. Alouini. 2003. “Largest eigenvalue of complex wishart
matrices and performance analysis of MIMO MRC systems.” IEEE Jour. Select.
Areas in Commun., 21, April 2003, 418–426.
42. J.P. Kermoal, L. Schumacher, F. Frederiksen, and P.E. Mogensen. 2001. “Polar-
ization diversity in MIMO radio channels: experimental validation of a
stochastic model and performance assessment.” Proc. IEEE Veh. Technol. Conf.,
 1, Fall 2001, 22–26.
43. J.P. Kermoal, L. Schumacher, P.E. Mogensen, and K.I. Pedersen. 2001. “Exper-
imental investigation of correlation properties of MIMO radio channels for
indoor picocell scenarios.” Proc. IEEE Veh. Technol. Conf., 1, Sept. 2000, 14–21.

Feedback Techniques for MIMO Channels
143
44. J.P. Kermoal, L. Schumacher, K.I. Pedersen, P.E. Mogensen, and F. Frederiksen.
2002. “A stochastic MIMO radio channel model with experimental validation.”
IEEE Jour. Select. Areas in Commun., 20, Aug. 2002, 1211–1226.
45. C. Kose and R.D. Wesel. 2002. “Universal space-time trellis codes.” Proc. Glob.
Telecom. Conf., Nov. 2002, 1108–1112.
46. E.G. Larsson, G. Ganesan, P. Stoica, and W.-H. Wong. 2002. “On the perfor-
mance of orthogonal space-time block coding with quantized feedback.” IEEE
Commun. Lett., 6, Nov. 2002, 487–489.
47. E.G. Larsson and P. Stoica. 2003. Space-Time Block Coding for Wireless Communi-
cations, New York: Cambridge University Press.
48. K.N. Lau, Y. Liu, and T.-A. Chen. 2003. “Optimal partial feedback design for
MIMO block fading channels with causal noiseless feedback.” Proc. IEEE Int.
Conf. on Commun., 4, May 2003, 1663–2667.
49. V. Lau, Y. Liu, and T.-A. Chen. 2004. “On the design of MIMO block-fading
channels with feedback-link capacity constraint.” IEEE Trans. Commun., 52, Jan.
2004, 62–70.
49b. V.K.N. Lau, Y. Liu, and T.-A. Chen. 2004. “Capacity of memoryless channels
and block-fading channels with designable cardinality-constrained channel
state feedback.” IEEE Trans. Info. Th., 50(9), Sept. 2004, 2038–2049.
50. X. Lin and R.S. Blum. 2002. “Systematic design of space-time codes employing
multiple trellis coded modulation.” IEEE Trans. Commun., 50, April 2002, 608–615.
51. T.K.Y. Lo. 1999. Maximum ratio transmission. IEEE Trans. Commun., 47, Oct.
1999, 1458–1461.
51b. D.J. Love. 2004. Feedback Methods for Multiple-Input Multiple-Output Wire-
less Systems, Ph.D. thesis, The University of Texas at Austin, May 2004.
52. D.J. Love and R.W. Heath, Jr. “Diversity performance of precoded orthogonal
space-time block codes using limited feedback.” IEEE Commun. Lett., 8, May
2004, 305–307.
53. D.J. Love and R.W. Heath, Jr. 2003. “Equal gain transmission in multiple-input
multiple-output wireless systems.” IEEE Trans. Commun., 51, July 2003, 1102–1110.
54. D.J. Love and R.W. Heath, Jr. 2003. “Limited feedback precoding for spatial
multiplexing systems.” Proc. IEEE Glob. Telecom. Conf., 4, Dec. 2003, 1857–1861.
55. D.J. Love and R.W. Heath, Jr. 2003. “Limited feedback precoding for spatial
multiplexing systems using linear receivers.” Proc. IEEE Mil. Comm. Conf., 1,
Oct. 2003, 627–632.
56. D.J. Love and R.W. Heath, Jr. 2004. “Multi-mode precoding using linear receiv-
ers for limited feedback MIMO systems.” Proc. IEEE Int. Conf. on Commun., 1,
June 2004, 448–452.
57. D.J. Love and R.W. Heath, Jr. 2005. “Limited feedback unitary precoding for
orthogonal space-time block codes.” IEEE Trans. Sig. Proc., 53, Jan. 2005, 64–73.
58. D.J. Love and R.W. Heath, Jr. 2005. “Limited feedback unitary precoding for
spatial multiplexing systems.” IEEE Trans. Info. Th., 51, Aug. 2005, 2967–2976.
59. D.J. Love and R.W. Heath, Jr. 2005. “Multi-mode precoding for MIMO wireless
systems.” IEEE Trans. Sig. Proc., 53, Oct. 2005, 3674–3687.
60. D.J. Love and R.W. Heath, Jr. 2005. “Necessary and sufﬁcient conditions for
full diversity order in correlated Rayleigh fading beamforming and combining
systems.” IEEE Trans. Wireless Comm., 4(1), Jan. 2005, 20–23.
61. D.J. Love, R.W. Heath, Jr., and T. Strohmer. 2003. “Grassmannian beam-forming
for multiple-input multiple-output wireless systems.” Proc. Int. Conf. on Com-
mun., 4, May 2003, 2618–2622.

144
MIMO System Technology for Wireless Communications
62. D.J. Love and R.W. Heath, Jr. 2003. “Grassmannian precoding for spatial mul-
tiplexing systems.” Proc. of Allerton Conf. on Comm. Cont. and Comp., Oct. 2003.
63. D.J. Love, R.W. Heath, Jr., and T. Strohmer. 2003. “Grassmannian beam-forming
for multiple-input multiple-output wireless systems.” IEEE Trans. Info. Th., 49,
Oct. 2003, 2735–2747.
63b. D.J. Love, R.W. Heath, Jr., W. Santipach, and M.L. Honig. 2004. “What is the
value of limited feedback for MIMO channels?” IEEE Commun. Mag., 42, Oct.
2004, 54–59.
64. H. Miyakawa and H. Harashima. 1969. “A method of code conversion for
digital communication channels with intersymbol interference.” Transactions of
the Institute of Electronic Communication Engineering, Japan, 52-A, June 1969,
272–273.
65. B. Mondal and R.W. Heath, Jr. 2005. “Algorithms for quantized precoding for
mimo ofdm.” Proc. of Third SPIE Int. Symp. on Fluctuations and Noise, Austin,
TX, May 2005.
66. K.K. Mukkavilli, A. Sabharwal, and B. Aazhang. 2001. “Design of multiple
antenna coding schemes with channel feedback.” Proc. of the 35th Annual Asil.
Conf. on Sig. Sys. and Comp., Nov. 2001, 1009–1013.
67. K.K. Mukkavilli, A. Sabharwal, E. Erkip, and B. Aazhang. 2003. “On beam-
forming with ﬁnite rate feedback in multiple antenna systems.” IEEE Trans.
Info. Th., 49, Oct. 2003, 2562–2579.
68. R.U. Nabar, H. Bolcskei, V. Erceg, D. Gesbert, and A.J. Paulraj. 2002. “Perfor-
mance of multiantenna signaling techniques in the presence of polarization
diversity.” IEEE Trans. on Sig. Proc., 50, Oct. 2002, 2553–2562.
69. A. Narula, M.J. Lopez, M.D. Trott, and G.W. Wornell. 1998. “Efﬁcient use of
side information in multiple-antenna data transmission over fading channels.”
IEEE Jour. Select. Areas in Commun., 16, Oct. 1998, 1423–1436.
70. A. Paulraj, R. Nabar, and D. Gore. 2003. Introduction to Space-Time Wireless
Communications, New York: Cambridge University Press.
71. J.G. Proakis. 2001. Digital Communications, 4th edition, Boston: McGraw Hill.
72. G.G. Raleigh and J.M. Ciofﬁ.1998. “Spatio-temporal coding for wireless com-
munication.” IEEE Jour. Select. Areas in Commun., 46, March 1998, 357–366.
73. J.C. Roh and B.D. Rao. 2004. “Channel feedback quantization methods for
MISO and MIMO systems.” Proc. IEEE Int. Symp. Personal, Indoor, and Mobile
Radio Commun., 2, Sept. 2004, 805–809
74. J.C. Roh and B.D. Rao. 2004. “An efﬁcient feedback method for MIMO systems
with slowly time-varying channels.” Proc. IEEE Wireless Comm. and Net. Conf.,
2, March 2004, 760–764.
75. J.C. Roh and B.D. Rao. 2004. “Multiple antenna channels with partial channel
state information at the transmitter.” IEEE Trans. Wireless Comm., 3, March 2004,
677–688.
76. M.A. Sadrabadi, A.K. Khandani, and F. Lahouti. 2004. A new method of channel
feedback quantization for high data rate MIMO systems.” Proc. IEEE Glob.
Telecom. Conf., 1, Nov.–Dec. 2004, 91–95.
77. H. Sampath and A. Paulraj. 2002. “Linear precoding for space-time coded
systems with known fading correlations.” IEEE Commun. Lett., 6, June 2002,
239–241.
78. H. Sampath, S. Talwar, J. Tellado, V. Erceg, and A. Paulraj. 2002. “A fourth-
generation MIMO-OFDM broadband wireless system: design, performance,
and ﬁeld trial results.” IEEE Comm. Mag., 40, Sept. 2002, 143–149.

Feedback Techniques for MIMO Channels
145
79. W. Santipach and M.L. Honig. 2003. “Asymptotic performance of MIMO wire-
less channels with limited feedback.” Proc. IEEE Mil. Comm. Conf., 1, Oct. 2003,
141–146.
80. W. Santipach, Y. Sun, and M.L. Honig. 2003. “Beneﬁts of limited feedback for
wireless channels.” Proc. of Allerton Conf. on Comm. Cont. and Comp., Oct. 2003.
81. A. Scaglione, P. Stoica, S. Barbarossa, G.B. Giannakis, and H. Sampath. 2002.
“Optimal designs for space-time linear precoders and decoders.” IEEE Trans.
Sig. Proc., 50, May 2002, 1051–1064.
82. L. Schumacher, J.P. Kermoal, F. Frederiksen, K.I. Pedersen, A. Algans, and P.
E. Mogensen. 2001. MIMO channel characterisation. Technical report, European
IST-1999-11729 Project METRA, Feb. 2001.
83. L. Schumacher, K.I. Pedersen, and P.E. Mogensen. 2002. “From antenna spacings
to theoretical capacities — guidelines for simulating MIMO systems.” Proc. IEEE
Int. Symp. Personal, Indoor, and Mobile Radio Commun., 2, Sept. 2002, 587–592.
84. M.B. Shoemake. 2004. Status of project IEEE 802.11n. http://grouper.ieee.org/
groups/802/11/Reports/tgn update.htm. Accessed on March 3, 2004.
85. I. Sohn, G.D. Golden, H. Lee, and J.W. Ahn. 2003. “Overview of METRA model
for MBWA MIMO channel.” IEEE C802.20-03-50, May 2003.
86. N.R. Sollenberger. 1993. “Diversity and automatic link transfer for a TDMA
wireless access link.” Proc. Glob. Telecom. Conf., 1, Nov.–Dec. 1993, 532–536.
87. T. Strohmer and R.W. Heath, Jr. 2003. “Grassmannian frames with applications
to coding and communications.” Applied and Computational Harmonic Analysis,
14, May 2003, 257–275.
88. G.L. Stuber, ed. 1996. Principles of Mobile Communications, Norwell, MA: Kluwer.
89. Y. Tan, M. Pereira, M. Mewburn, and M. Faulkner. Investigation of singular
value distributions of MIMO channels in indoor environment. Available at
http://www.telecommunications.crc.org.au/content/ConfPapers/Tan.pdf.
90. V. Tarokh, H. Jafarkhani, and A.R. Calderbank. 1999. “Space-time block codes
from orthogonal designs.” IEEE Trans. Inf. Th., 45, Jul. 1999, 1456–1467.
91. V. Tarokh, N. Seshadri, and A.R. Calderbank. 1998. “Space-time codes for high
data rate wireless communication: performance criterion and code construc-
tion.” IEEE Trans. Inf. Th., 44, March 1998, 744–765.
92. M. Tomlinson. 1971. “New automatic equalizer employing modulo arithmetic.”
Electronics Letters, 7, March 1971, 138–139.
93. J.A. Tropp, I. Dhillon, R.W. Heath, Jr., and T. Strohmer. 2005. “Designing struc-
tured tight frames via an alternating projection method.” IEEE Trans. Inf. Th.,
51, Jan. 2005, 188–209.
94. J.A. Tropp, R.W. Heath, Jr., and T. Strohmer. 2003. “An alternating projection
algorithm for constructing quasi-orthogonal CDMA signature sequences.”
Proc. Int. Symp. on Info. Theo., 407.
95. C.-H. Tse, K.-W. Yip, and T.-S. Ng. 2000. “Performance tradeoffs between max-
imum ratio transmission and switched-transmit diversity.” Proc. Int. Symp. on
Pers., Ind. and Mobile Radio Comm., 2, Sept. 2000, 1485–1489.
96. V. Erceg et al. 2003. “Indoor MIMO WLAN channel models.” IEEE 802.11-03/
161r2, Sept. 2003.
97. E. Visotsky and U. Madhow. 2001. “Space-time transmit precoding with im-
perfect feedback.” IEEE Trans. Info. Th., 47, Sept. 2001, 2632–2639.
98. J.W. Wallace and M.A. Jensen. 2002. “Modeling the indoor MIMO wireless
channel.” IEEE Trans. Antennas Propagat., 50, May 2002, 591–599.
99. G.S. Watson. 1983. Statistics on Spheres, New York: Wiley.

146
MIMO System Technology for Wireless Communications
100. A. Wittneben. 1995. “Analysis and comparison of optimal predictive transmit-
ter selection and combining diversity for DECT.” Proc. IEEE Glob. Telecom. Conf.,
2, Nov. 1995, 1527–1531.
101. W.-H. Wong and E.G. Larsson. 2003. “Orthogonal space-time block coding with
antenna selection and power allocation.” Elect. Lett., 39, Feb. 2003, 379–381.
102. P. Xia, S. Zhou, and G.B. Giannakis. 2004. “Adaptive MIMO-OFDM based on
partial channel state information.” IEEE Trans. on Sig. Proc., 52, Jan. 2004,
202–213.
103. T. Xiaofeng, H. Harald, Y. Zhuizhuan, Q. Haiyan, and Z. Ping. 2001. “Closed
loop space-time block code.” Proc. Veh. Technol. Conf., 2, Oct. 2001, 1093–1096.
104. Y. Zhao, R.S. Adve, and T.J. Lim. 2004. “Optimal STBC precoding with channel
covariance feedback for minimum error probability.” EURASIP J. Applied Signal
Processing, Sept. 2004, 1257–1265.
105. L. Zheng and D.N.C. Tse. 2002. “Communication on the Grassmann manifold:
a geometric approach to the noncoherent multiple-antenna channel.” IEEE
Trans. Info. Th., 48, Feb. 2002, 359–383.
106. S. Zhou and G.B. Giannakis. 2002. “Optimal transmitter eigen-beamforming
and space-time block coding based on channel mean feedback.” IEEE Trans. on
Sig. Proc., 50, Oct. 2002, 2599–2613.
107. S. Zhou and G.B. Giannakis. 2003. “Optimal transmitter eigen-beamforming
and space-time block coding based on channel correlations.” IEEE Trans. Inf.
Th., 49, Jul. 2003, 1673–1690.
108. S. Zhou, Z. Wang, and G.B. Giannakis. 2004. “Performance analysis of transmit-
beamforming with ﬁnite-rate feedback.” Proc. of 38th Conf. on Info. Sciences and
Systems, Princeton University, March 2004.

147
6
Antenna Selection in MIMO Systems
Neelesh B. Mehta and Andreas F. Molisch
CONTENTS
6.1
Introduction ................................................................................................147
6.2
MIMO System Model................................................................................149
6.2.1
General Notation...........................................................................150
6.3
Spatial Multiplexing..................................................................................151
6.3.1
Optimum Signaling with Transmit Antenna Selection...........151
6.3.2
Performance of Antenna Selection.............................................152
6.3.3
Antenna Selection in Presence of Interference.........................154
6.4
Space–Time Codes.....................................................................................155
6.4.1
Space–Time Trellis Codes.............................................................155
6.4.2
Orthogonal Space–Time Block Codes........................................157
6.5
SIMO Systems ............................................................................................159
6.6
Implementing Antenna Selection: Criteria and Algorithms...............161
6.6.1
Capacity-Achieving Spatial Multiplexing.................................162
6.6.1.1
When Transmitter Has CSI ...........................................164
6.6.1.2
With Linear Receivers ....................................................164
6.6.2
Space–Time Codes.........................................................................165
6.7
Performance with Non-Idealities............................................................166
6.8
Antenna Selection with Spatial Correlation..........................................167
6.8.1
Alternate Antenna Selection Structures.....................................168
6.9
Summary.....................................................................................................170
References.............................................................................................................171
6.1
Introduction
MIMO systems, which employ multiple transmit and receive antenna ele-
ments, substantially improve the data rates that can be transmitted over the
channel and the reliability with which they can be received without any

148
MIMO System Technology for Wireless Communications
additional bandwidth. Higher data rates are achieved by transmitting mul-
tiple data streams simultaneously using spatial multiplexing techniques. For
spatially uncorrelated channels, the data rates even increase linearly with
the minimum of the number of transmit and receive antenna elements [1].
Increased reliability is achieved by exploiting spatial diversity to signiﬁ-
cantly reduce the probability that the channel is in a deep fade. Orthogonal
space–time block codes and space–time trellis codes are examples of diver-
sity techniques tailored to MIMO systems. A single input multiple output
(SIMO) system, which combines the many received copies of the transmitted
signal to improve reliability, is another example of a spatial diversity system.
While MIMO systems perform impressively, they also increase the hard-
ware and signal processing complexity, power consumption, and component
size in the transmitter and the receiver [2]. One of the main culprits behind
this increase in complexity is that each receive antenna element requires a
dedicated radio frequency (RF) chain that comprises a low noise ampliﬁer,
a frequency down-converter, and an analog-to-digital converter, and each
transmit antenna element requires an RF chain that comprises a digital-to-
analog converter, a frequency up-converter, and a power ampliﬁer. More-
over, processing the signals received in spatial multiplexing schemes or with
STTCs calls for sophisticated receivers whose complexity increases, sometimes
exponentially, with the number of transmit and receive antenna elements.
This increase in complexity has inhibited the widespread adoption of
MIMO systems. For example, the third-generation cellular system speciﬁca-
tion (3GPP) currently supports only an optional two antenna space–time
transmit diversity scheme and does not require the handsets to have more
than one antenna element [3]. Sophisticated techniques that employ spatial
multiplexing or support more antenna elements have met with considerable
opposition in 3GPP. While the adoption of MIMO has made headway in the
next-generation wireless local area network (WLAN) standard IEEE 802.11n,
which aims to transfer raw information at rates greater than 100 Mbps over
a 20-MHz bandwidth, complexity considerations are likely to make the
adopted MIMO scheme an elementary one that supports a small number of
antenna elements.
Antenna selection is a solution that addresses some of the complexity
drawbacks associated with MIMO systems. It reduces the hardware com-
plexity of transmitters and receivers by using fewer RF chains than the
number of antenna elements. While the antenna elements are typically cheap,
and in some cases are just a patch of copper, the RF chains are considerably
more expensive. In antenna selection, a subset of the available antenna
elements is adaptively chosen by a switch, and only signals from the chosen
subset are processed further by the available RF chains.
Given its promise as a low-complexity solution, antenna selection has
received considerable attention recently. It has been considered at the trans-
mitter (transmit antenna selection [TAS]), at the receiver (receive antenna
selection [RAS]), and at both the transmitter and the receiver (transmit and
receive antenna selection [T-RAS]). Its performance has been explored from

Antenna Selection in MIMO Systems
149
various angles such as capacity and outage for spatial multiplexing systems,
and diversity order and array gain for space–time coded systems. The diver-
sity order quantiﬁes the effectiveness in avoiding deep fades and is deﬁned
as the slope of average symbol error probability vs. input signal to noise
ratio (SNR) curve for high SNRs. The array gain quantiﬁes the improvement
in average SNR seen at the combiner output when signals received by the
multiple antenna elements are combined.
As we shall see, antenna selection — for a variety of MIMO techniques —
achieves the full diversity inherent in the system at the expense of a small
loss in array gain compared to a full complexity system, i.e., a system that
can always allocate RF chains to each and every antenna element. Another
way of stating this is that for the same number of RF chains, using additional
antenna elements with antenna selection outperforms a system that lacks
additional antenna elements. Antenna selection has been found to modify,
on a fundamental level, the optimum Gaussian signaling required to transmit
information at the maximum possible rate. Considerable effort has also been
spent to develop various criteria, both optimal (but complicated) and sub-
optimal (but simple), to implement antenna selection algorithms.
This chapter studies various aspects of antenna selection in some depth,
and assumes basic knowledge about the operation of MIMO systems. The
reader is referred to the tutorial papers in [2,4] for a more basic introduction.
We ﬁrst analyze the performance of antenna selection for different MIMO
systems. We then consider the algorithms and criteria to implement antenna
selection. We also consider antenna selection performance in the presence
of non-idealities, such as imperfect channel estimates, multipath dispersion,
fast fading, etc. Finally, we discuss a class of antenna selection algorithms
that are based on knowledge of the statistical variations of the channel. Using
statistical information instead of the instantaneous channel state information
often signiﬁcantly reduces the demands on the transmitter and receiver. We
show that even a moderate spatial correlation, when properly exploited by
antenna selection, helps recover, to a great extent, the array gain loss that is
incurred by antenna selection.
In this chapter, we will focus most of our attention on the simplest setup
in which the receiver has full channel state information (CSI) while the
transmitter has no CSI, and knows only which antenna elements to use in
case of TAS and T-RAS. However, we do brieﬂy discuss how other scenarios,
such as the availability of CSI at the transmitter and the presence of co-
channel interference in addition to noise, can be handled.
6.2
MIMO System Model
Let
and
denote the number of antenna elements that are available (but
not necessarily used every time) at the transmitter and receiver, respectively.
Nt
Nr

150
MIMO System Technology for Wireless Communications
Let
and
denote the number of RF chains at the transmitter and receiver,
respectively. We always have 1 f Lt f Nt and 1 f Lr f Nr. A block diagram
representation of antenna selection at the transmitter and the receiver is
given in Figure 6.1.
The transmitted signal, of size Nr × 1, is denoted by x. The signal, y, of size
Nr × 1, received by the
antenna elements is given by
(6.1)
where n represents noise and the matrix H, of size Nr × Nt, denotes the
instantaneous channel state. Unless otherwise mentioned, the elements of H
are assumed to be independent of each other. In case of TAS, NtLt elements
of x, which correspond to the transmit antenna elements not chosen, will be
0. The noise vector, n, of size Nr × 1, is a zero-mean complex white Gaussian
random vector. To simplify notation, we shall use x to also denote the Lt × 1
transmit vector and y to denote the Lr × 1 receive vector that correspond to
only the selected transmit and receive elements, respectively. The notation
shall be obvious from the context. The total power transmitted from all the
antennas is denoted by W. Without loss of generality, we shall assume that
each element of n and H has unit variance. Therefore, the average SNR of
the signal input to any receive antenna element equals W/Lt when the power
is equally allocated among the Lt transmit elements.
We shall assume that the receiver has perfect channel state information.
The receiver can estimate the channel from the training sequences or by
using blind estimation techniques. A frequency-ﬂat channel is assumed. The
channel is assumed to be block-fading, in that it does not change during
the transmission of the space–time codeword and decorrelates thereafter. We
shall comment on the impact of the breakdown of these assumptions toward
the end of the chapter.
6.2.1
General Notation
For a matrix A, the symbol A† denotes the Hermitian transpose of A, AT the
transpose, A–1 the matrix inverse,
the Frobenius norm,
the determinant,
FIGURE 6.1
Block diagram of antenna selection with Lt out of Nt transmit antenna elements selected and
Lr out of Nr receive antenna elements selected [4]. (© 2004 IEEE.)
1
2
Lt
Data
source
Data
sink
Space/time
decoder
Lt out
of Nt
switch
1
2
Mobile
radio
channel
H
1
2
Lr
Lr out 
of Nr
switch
1
2
Space/time
coder
Nt
Nr
Nt − 1
Nr − 1
Lt
Lr
Nr
y
Hx
n
=
+
,
A
F
A

Antenna Selection in MIMO Systems
151
and
the trace. The identity matrix of size
shall be denoted by
In. The symbol
denotes the expectation with respect to the random
variable X.
As we shall see, order statistics, which deals with the statistics of ordered
random variables, is often used in the analysis of antenna selection. We shall
resort to the following commonly used order statistics notation. When n
numbers, x1, …, xn, are rearranged in descending order, they shall be denoted
by
, where [i] denotes the index of the ith largest number.
6.3
Spatial Multiplexing
As mentioned, we shall ﬁrst focus on the case where the transmitter has no
knowledge of the channel state H. (In the case of TAS, the transmitter knows,
in addition, which antenna elements to use.) This is typically achieved by
means of feedback from the receiver in frequency division duplex systems.
In time division duplex systems with slowly varying channels, the transmit-
ter can monitor the transmissions from the receiver to determine the channel
state without any help from the receiver.
The maximum data transmission rate of any communication system is
given by the Shannon capacity [5]. For MIMO systems, the Shannon capacity
given the channel state H takes the form [1]
(6.2)
where
is the covariance matrix (of size Nt × Nt) of the transmitted signal.
The ergodic capacity is deﬁned as the average of
over all the channel
realizations. We ﬁrst discuss the optimal form of
for antenna selection.
6.3.1
Optimum Signaling with Transmit Antenna Selection
When no CSI is available at the transmitter, it is well known that in a full
complexity system it is optimal to allocate the transmit powers uniformly
across all the antenna elements and to keep the signals transmitted from
different antenna elements uncorrelated, i.e.,
[6]. In antenna
selection, however, this is no longer optimal. This was ﬁrst highlighted by
an example in [7], which showed that at low SNR, a covariance matrix of
the form
can outperform
. Here, 1 is a vector of size
Lt × 1 and is given by 1 = [11…1]T. . Notice that a covariance of the form 11†
also treats all the transmit antenna elements equally and requires no CSI at
the transmitter. That
is not optimal is because the channel is no
longer circularly symmetric Gaussian in the presence of antenna selection,
Tr A
{ }
n
n
×
EX .¬® ¼¾
x
x
x n
[ ]
[ ]
[ ]
1
2
v
v
v

C
Nr
X
(
)
log
,
†
H
I
HQ H
=
+
2
Q X
C(
)
H
Q X
Q
I
X
t
t
N
N
=
W
Q X
t
L
=
W 11†
Q
I
X
t
t
L
L
=
W
Q
I
X
t
t
L
L
=
W

152
MIMO System Technology for Wireless Communications
which, depending on the channel realization, changes which transmit
antenna elements are chosen.
In fact, the optimum signaling takes the following simple form for all SNR
[8]:
(6.3)
where F is a real number that lies between 0 and Lt/(Lt – 1). However, closed-
form expressions are not available for F, and a one-dimensional numerical
search is required to determine its optimal value.
A large number of papers in the literature do not take the above optimal
signaling into account and assume that
. This is equivalent to
setting F = 1 in the above equation. We shall also make this assumption
henceforth.
6.3.2
Performance of Antenna Selection
When antenna selection is employed at the transmitter or the receiver or
both, a subset of the transmit and/or receive antenna elements is chosen.
The channel seen by the subset is the sub-matrix,
, that is obtained by
selecting only the rows and columns of H that correspond to the selected
receive and transmit antenna elements. The optimal subset is one that leads
to the largest mutual information between the antenna elements used for
transmission and reception. The capacity with antenna selection is given by
(6.4)
where
is an Lr × Lt matrix obtained by removing
columns and Nt –
Lt rows from H and
denotes the set of all possible
sub-matrices
of H. The optimal channel subset,
~Hopt, is given by
(6.5)
An exact analytical solution for
is quite difﬁcult. However, lower and
upper bounds are available for
for RAS. An upper bound was derived
for
in [9] by assuming that the signal components are received without
any interference from the other components. The receive antenna elements
that receive the
largest signal components are then selected. Clearly,
neglecting the interference from other components is an unrealistic assump-
tion, which is why the formula below is an upper bound:
Q
I
X
t
Lt
L
=
+

©
«ª
¹
»º
W F
F
(
)
,
†
1
11
Q
I
X
t
t
L
L
=
W
H
C
L
S
L
t
r
sel =
+
maxlog
,
(
)
†
H
I
HH
2
W  
H
N
L
r
r

S(
)
H
L
L
r
t
×

 
H
I
HH
H
opt =
+
.
argmaxlog
(
)
†
S
L
t
r
N
2
W
Csel
Csel
Csel
Lr

Antenna Selection in MIMO Systems
153
(6.6)
where
are ordered chi-square random variables with 2Nt degrees of
freedom such that
. The bound is tight for Lr f Nt, but is
rather loose for
. For the latter case, the following bound is better:
(6.7)
where
and, for each j,
are Nr ordered chi-square random variables (ordered with respect to index
i) with 2 degrees of freedom.
Using matrix analysis, the following lower bound for the case Lt = Nt = Nr
was derived in [10]:
(6.8)
where
is the
orthonormal basis for the column space of
and
is the
block of
corresponding to receive antenna elements chosen.
As
is a sub-matrix of the unitary matrix U, we always have
.
The capacity loss term
has been characterized in detail in [10].
The performance of RAS as a function of Lr for Nt = 3 and Nr = 8 for W =
20 dB is shown in Figure 6.2. The ﬁgure plots the cumulative distribution
function (CDF) of the capacity (in bits/sec/Hz). The CDF is a useful repre-
sentation because it contains information about not just the ﬁrst moment
(expected value), but also its higher moments. It can be seen that the capacity
increases as the number of RF chains, Lr, increases. However, the gains
diminish as Lr increases. For Lr = 5, the capacity CDF is already very close
to that of a full complexity receiver.
C
N
i
L
t
i
r
sel f
+
=
©
«
ª
ªª
¹
»
º
ºº
¨
1
2 1
log
,
[ ]
W L
i
N
i
r
=
{
}
1
L [ ]
L
L
L
[ ]
[ ]
[
]
1
2
>
>
>
…
Nr
L
N
r
t
>
C
j
j
Nt
sel f
=¨] ,
1
]
W
L
j
z
t
i
j
i
L
L
r
=
+
©
«ª
¹
»º
=
¨
log
[ ]
( )
1
1 
L [ ]
( )
i
j
i
Nr
{
} =1
C
N
N
t
r
r
t
sel v
+
+
log
log
,
†
†
2
2
I
H H
U U
W
U
N
N
r
t
×
H
Ur
N
N
t
t
×
U
Ur
log
†
2
0
U U
r
r f
log |
|
†
2 U U
r
r

154
MIMO System Technology for Wireless Communications
TAS can even lead to “increased capacity” for low rank channels [11],
which arise due to keyhole effects [12] or due to spatial correlation between
the transmit and receive antenna elements [13]. This increase is a manifes-
tation of the additional CSI available at the transmitter about which antennas
to use; a transmitter without this additional information would have allo-
cated equal powers to all the Nt elements.
6.3.3
Antenna Selection in Presence of Interference
So far, we have assumed that the noise is complex white circular Gaussian.
In cellular systems, the transmissions from other cells or from within the cell
give rise to co-channel interference, i. The received signal now takes the form
(6.9)
Let
denote the covariance of the interference plus noise component.
The capacity formula for antenna selection changes to
(6.10)
It turns out that this case can be easily mapped to the white Gaussian noise
case that we have considered so far. By rearranging the terms in the deter-
minant above, it can be shown that that the scenario above is equivalent to
a system with an interference-free MIMO channel [14]. The equivalent chan-
nel takes the form
where UI is the eigenspace of QI and 1I is
a diagonal matrix of the eigenvalues of QI. When the interference is not
Gaussian, the above formula provides a lower bound on the achievable
capacity as Gaussian interference is the worst form of interference [5].
We shall not delve into the case where the signaling of the interferers can
also be adjusted to maximize global system capacity [15].
FIGURE 6.2
Capacity of a spatial multiplexing MIMO system with receive antenna selection for different
Lr (Nt = 3, Nr = 8, and W = 20 dB) [4]. (© 2004 IEEE.)
Lr = 2 
Lr = 3 
Lr = 8 
cdf(C)
10
20
30
Capacity C(bits/s/Hz) 
0
0.5
1
y
Hx
n
i
=
+
+ .
Q I
C
S
Nr
X
I
sel =
+
.

maxlog
(
)
†
H
I
HQ H Q
2
1


H
U H
eq =

1
I
I
1
2
†
,

Antenna Selection in MIMO Systems
155
6.4
Space–Time Codes
Space–time codes were presented in a series of seminal papers by Tarokh
et al. [16,17]. They provide a practical means of exploiting spatial diversity
when multiple transmit and receive antenna elements are used. We shall
study antenna selection for two different kinds of space–time codes: space–
time trellis codes and orthogonal space–time block codes, which offer differ-
ent trade-offs between performance and complexity. The reader is referred
to Chapter 4 for a review of space–time codes.
6.4.1
Space–Time Trellis Codes
Space–time trellis codes (STTC) [16,18] are designed to exploit the spatial
diversity present in MIMO systems. Compared to orthogonal space–time
block codes, which we discuss in the following section, STTCs also deliver
a coding gain. However, the receiver for STTCs is more complicated, with
the complexity increasing exponentially with the number of transmit
antenna elements.
The performance of STTCs with RAS and a maximum likelihood detector
(MLD) was studied in [19]. For STTCs, the expression for the pair-wise error
probability of codewords of a given length provides considerable insight
into the performance of antenna selection. Performance measures such as
the overall error probability of the STTC may then be obtained from the pair-
wise error probabilities using classical approaches for trellis codes [20].
Let the ith antenna element transmit a codeword of length
denoted by
. In this notation, the vector
(of size l × 1) is transmitted
from the ith antenna element. Given that the receiver knows the channel H
perfectly, the probability that a full complexity receiver erroneously decodes
C to the codeword
depends on the Euclidean distance
between the codewords. It is upper bounded by [16]
(6.11)
where
is the jth row of H and corresponds to the jth receive antenna
element. The matrix B (of size Nt × Nt) depends on the codewords, with its
(p, q)th element given by
. Note that the non-negative
term
l
C
c
c
=
,
,
[
]
1 …
Nt
ci
E
e
e
=
,
,
[
]
1 …
Nt
P
Nt
j
N
j
j
r
(
)
exp
,
†
H
h Bh
f

=
©
«
ª
ª
ª
ª
¹
»
º
º
º
º
¨
W
4
1
hj
B
c
e
c
e
pq
p
p
q
q
=


(
) (
)
†
j
N
j
j
r
=
¨
1 h Bh†

156
MIMO System Technology for Wireless Communications
corresponds to the distance between the codewords.
Ideally, the optimal antenna selection algorithm would choose the Lr
receive antenna elements with indices i1, …, iLr that maximize the sum
However, the indices need not be the same for different pairs of codewords.
However, at high SNR, it is sufﬁcient to only consider codewords that are
separated by the minimum distance of the code because they largely deter-
mine the probability of decoding error. For such pairs, it can be argued that
the norm-based selection criterion that chooses the antenna elements based
on the received signal strength effectively achieves this selection [19]. We
shall discuss this further in Section 6.6.2.
Therefore, the pair-wise error probability with RAS can be written as
(6.12)
(6.13)
The second step follows from the following simple inequality that holds for
any sequence of n numbers x1, x2, …, xn:
(6.14)
By averaging all the realizations of the channel, H, it can be shown that,
for large W, the average pair-wise error probability for a full rank STTC takes
the form
(6.15)
Notice that the exponent of W is NrNt and is independent of Lr. This shows
that RAS retains the full diversity order NtNr. However, compared to a full
complexity system (with Nr receive antenna elements and Nr RF chains) this
is accompanied by an array gain loss of 10 log10 (Nr/Lr). Tighter bounds on
the array gain loss are also derived in [19] for the case when only one receive
antenna element is selected (Lr = 1).
j
L
i
i
r
j
j
=
¨
1 h Bh†.
P
Nt
j
L
i
i
r
j
j
sel(
)
exp
,
†
H
h Bh
f

=
©
«
ª
ª
ª
ª
¹
»
º
º
º
º
¨
W
4
1
f

.
=
©
«
ª
ª
ª
ª
¹
»
º
º
º
º
¨
exp
†
L
N
N
r
r
t
j
N
j
j
r
W
4
1
h Bh
m
n
x
x
x
m
n
i
n
i
i
m
i
i
n
i
=
=
=
¨
¨
¨
f
f
f
f
.
1
1
1
1
[ ]
,
(
)
E
H
B
H P
L
N
N
L
N N
r
r
t
r
t
r
sel(
)
¬®
¼¾ f
©
«ª
¹
»º
.


W
4

Antenna Selection in MIMO Systems
157
Figure 6.3 plots the pair-wise error probability as a function of SNR, W, for
2 transmit antennas for different numbers of receive antennas and RF chains.
It can be seen that when Nr = 3, Lr = 1, 2, and 3 cases have the same diversity
order, which is the slope at high SNR. Moreover, compared to the Lr = Nr =
3 case, the array gain losses equal 0.9 dB for Lr = 2 and 3.4 dB for Lr = 1.
Both the losses are considerably less than the respective upper bound values
of 1.76 dB and 4.77 dB.
TAS for STTCs was studied in [21]. The analysis turns out to be very similar
to the one given above for RAS. TAS also achieves the full diversity order
of the system, NrNt, and incurs an array gain loss that is upper bounded by
10 log10 (Nt/Lt). That TAS achieves the full diversity order while transmitting
from only Lt antenna elements is noteworthy. This implies that smaller STTCs
can be used in conjunction with antenna selection to achieve the full diversity
order. This circumvents the exponential increase in the number of trellis
states in STTCs that are designed for larger Nt.
6.4.2
Orthogonal Space–Time Block Codes
Orthogonal space–time block codes (OSTBC), introduced in [17], achieve full
diversity and yet require only a simple linear receiver. They can be optimally
decoded by a low-complexity linear receiver.*
FIGURE 6.3
Pair-wise error probability of STTC with Nt = 2 for different Lr and Nr as a function of SNR, W
[19]. (© 2003 IEEE.)
*  Strictly speaking, the receiver should be called a widely linear receiver as it involves a conju-
gation operation [22].
(dB)
Lr = 3, Nr = 3
Lr = 2, Nr = 3
Lr = 1, Nr = 3
Lr = 2, Nr = 2
Lr = 1, Nr = 1
4
Frame error rate 
10−3
10−2
10−1
100
6 
8 
10 
12 
14 
16 
18 

158
MIMO System Technology for Wireless Communications
Therefore, antenna selection with OSTBCs has received considerable atten-
tion in the literature. In OSTBCs, the receive SNR after linear processing can
be expressed in terms of the Frobenius norm of the matrix, which is simply
the square root of the sum of the squares of the amplitudes of all the elements
of the matrix. This simple form for the SNR greatly facilitates analysis. The
probability of bit error or codeword error can then be easily written in terms
of the SNR depending on the modulation and channel coding scheme under
consideration. TAS and RAS have been studied in [23]. The analysis for RAS
was generalized to cover several cases in [24]. We illustrate the analysis for
RAS below.
Given that the channel subset
is selected, the SNR, Lsel, of the received
data stream can be directly written in terms of the Frobenius norm,
, of
[23] as follows:
(6.16)
where n1, …, nLr and m1, …, mLt denote the indices of the chosen receive and
transmit antenna elements, respectively.
Maximizing the instantaneous SNR is equivalent to maximizing the
mutual information or minimizing the BER. The optimal selection criterion
for all of these is therefore:
(6.17)
The above simple criterion is often referred to as the norm-based criterion.
In other words, in the case of TAS, the transmitter chooses the antenna
elements that correspond to the Lt columns with the largest column-norms.
In the case of RAS, the receiver chooses antenna elements that correspond
to the Lr rows with the largest row-norms. However, in the case of T-RAS,
transmit and receive antenna selection cannot be done independently.
As was the case for STTCs, the analyses for RAS and TAS are very similar.
We illustrate the performance of RAS below assuming that uncoded BPSK
is used [24]. The bit error probability is given in terms of the Q-function as
(6.18)
(6.19)
H
H
F
H
L
W
W
sel =
=
=
=
¨¨
L
L
h
t
t
i
L
j
L
nimj
F
r
t
H
2
1
1
2
,


H
H
opt =
.
argmax
(
)
S H
F
2
P
Q
N
h
t
i
L
j
N
i j
r
t
sel(
)
[ ]
H =
=
=
©
«
ª
ª
ª
ª
ª
¹
»
º
º
º
¨¨
2
1
1
2
W
º
º
,
f
.
=
=
©
«
ª
ª
ª
ª
ª
¹
»
º
º
º
º
º
¨¨
Q
L
N N
h
r
r
t
i
N
j
N
ij
r
t
2
1
1
2
W

Antenna Selection in MIMO Systems
159
For large W, the average bit error probability simpliﬁes to
(6.20)
Therefore, receive antenna selection maintains the diversity order of NtNr
with an array gain loss that is upper bounded by 10 log10 (Nr/Lr).
As was the case with STTCs, tighter bounds on the array gain loss exist
for the case where Lr = 1 [24]. When the Alamouti code (Lt = 2) is used, exact
closed-form expressions for the average SNR and the outage probability have
also been derived [23].
6.5
SIMO Systems
In SIMO systems, which have only one transmit antenna, only one data
stream can be transmitted. Multiple copies of the transmitted signal arrive
at the receiver, but with different amplitudes and phases that depend on the
channel. The receiver uses maximum ratio combining (MRC) to combine the
multiple received signals and achieve the maximum possible SNR. In MRC,
each received signal is weighted with a complex conjugate of the correspond-
ing channel coefﬁcient.
With antenna selection, Lr out of the Nr received signals are selected and
maximum ratio combined. Such a receiver is commonly referred to as the
hybrid-selection MRC (H-S/MRC) receiver. The SNR at the output of the
H-S/MRC receiver is given by
.
(6.21)
Setting Lr = 1 corresponds to the special case of a selection combining (SC)
receiver that uses only the best receive antenna element.
Closed-form expressions and tight bounds are available for both the SNR
and the BER for this case. At ﬁrst glance, the analysis of HS-MRC receivers
seems complicated because the ordered random variables L[1], …, L[Lr] are
correlated even though the underlying variables L1, …, LNr are independent of
each other. However, the minimum value L[Nr] and the differences L[1] – L[2], …,
are unconstrained, i.e., they can take any value between 0 and h.
This motivates the following linear mapping, called virtual branch analysis
[25], between L[i]s and the virtual variables Vjs:
E
H
H P
N N
N N
L
N
t
r
t
r
N N
r
t
r
sel(
)
¬®
¼¾ f

©
«
ª
ª
ª
¹
»
º
º
º

2
1
r
t
N
4W
©
«ª
¹
»º
.
L
L
H S MRC
 /
=
=¨
[ ]i
i
Lr
1
L
L
[
]
[
]
N
N
r
r


1

160
MIMO System Technology for Wireless Communications
(6.22)
where the Vis are just conveniently scaled versions of the differences. In case
of Rayleigh fading, the Vis turn out to be independent and identically dis-
tributed exponential random variables with unit mean.
The mean SNR at the output of the H-S/MRC receiver can then be easily
shown to be [25,26]
(6.23)
(6.24)
(6.25)
And the average symbol error probability (SEP) for MPSK can be shown
to be [27]
(6.26)
where 6 = U(M – 1)/M and c = (sin(U/M))2. For the large SNR case, the
formula reduces to:
(6.27)
L
L
W
W
W
W
W
[ ]
[
]
1
1
2
0
2



N
r
r
N
N
¬
®
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
=
r
r
N
N
V
V
r



0
0
1
W
¬
®
­
­
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
½
½
¬
®
­
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
½
,
E
E
H
H
L
L
H S MRC
 /
¬
®
­
­
¼
¾
½
½ =
=
¬
®­
¼
¾½
¨
i
L
i
r
1
[ ]
=
+
=
¬
®­
¼
¾½
=
+
¬
®­
¼
¨
¨
W
W
I
I
i
L
i
r
i L
N
i
r
i
r
r
i
V
L
i
V
1
1
1
E
E
¾½
=
+
©
«
ªª
¹
»
ºº .
=
+¨
L
i
r
i L
N
r
r
W 1
1
1
E
H
H P
c
L
i
r
(
)
(sin )
(sin )
¬®
¼¾ =
+
¬
®
­
¼
¾
½
µ
=
1
0
2
2
U
V
W
V
6
L
N
L
i
r
r
r c
d
+
+
¬
®
­
­
¼
¾
½
½
1
2
2
(sin )
(sin )
,
V
W
V
V
E
H
H P
N
L L
c
N
r
r
r
N
L
N
r
r
r
r
(
)
(sin )
¬®
¼¾ =
!
!



µ
W
U
V
1
0
6
2Nr dV.

Antenna Selection in MIMO Systems
161
Therefore, H-S/MRC achieves a diversity order of Nr, and compared to a
full complexity receiver with Nr RF chains, incurs an array gain loss equal to
Upper and lower bounds for the array gain loss for HS-MRC are derived in
[28]. Figure 6.4 plots the SEP for Nr = 8 as a function of the SNR, W, for
different values of Lr. We again see that the SEP decreases as Lr increases.
The gains diminish for larger Lr.
The hybrid selection combining that we considered above can also be done
at the transmitter in a closed-loop MIMO diversity system, in which signals
input to the transmit antenna elements are weighted replicas of the same
data stream. The received streams are combined to maximize the instanta-
neous SNR at the output of the combiner. This is analyzed for the Lt = 1 case
in [29] and for the general
case in [30].
6.6
Implementing Antenna Selection: 
Criteria and Algorithms
In TAS, the transmitter needs to examine
possibilities to choose the best
subset of Lt antenna elements out of the Nt available. Similarly, in RAS, the
receiver needs to examine
possibilities. In the case of T-RAS, the number
FIGURE 6.4
Symbol error probability as a function of SNR for different Lr (Nr = 8) [27]. (© 2001 IEEE.)
100
10−1
10−2
10−3
10−4
10−5
10−6
−2
0 
2 
4 
6 
8 
ρ (SNR per branch, cB)
Symbol error probabiliy (SEP)
10 
12 
14 
16 
18 
20 
Lr = 1
Lr = 2,.....7
Lr = Nr = 8
10
10
N
N
L L
r
r
r
r
N
L
r
r
log
!
!
.

©
«ª
¹
»º
Lt v 1
( )
L
N
t
t
( )
L
N
r
r

162
MIMO System Technology for Wireless Communications
of possibilities balloons to
, and coordination between the transmitter
and receiver is required to choose the optimal transmit and receive antenna
subsets. The combinatorial increase in the number of possibilities makes an
exhaustive search impractical even for moderate values of Nt and Nr.
Therefore, a large number of sub-optimal selection algorithms and heuris-
tics with varying levels of complexity have been proposed in the literature.
The criteria depend on whether OSTBCs, STTCs, or ideal capacity-achieving
space–time codes are assumed, and can also depend on the receiver archi-
tecture. We illustrate and compare a few of the proposed approaches for the
following cases:
•
Capacity-achieving spatial multiplexing with an optimal receiver,
•
Spatial multiplexing with linear receivers, and
•
Space–time codes with an MLD receiver.
6.6.1
Capacity-Achieving Spatial Multiplexing
In Equation 6.4, the optimal choice of the selection subset is given by a non-
linear equation. However, for low SNR, the optimal selection criterion sim-
pliﬁes as follows:
(6.28)
Therefore, at low SNR, norm-based selection is optimal [2,31]. Moreover, this
is the same as the criterion in Equation 6.17 for antenna selection with
OSTBCs.
However, the situation is not as simple for high SNR because of the
form of the capacity formula in Equation 6.4. Therefore, several iterative and
computationally simpler criteria have been proposed that exploit basic
results from matrix theory [32].
The effect of adding an additional receive antenna element to the capacity
formula was considered in [10,31]. A greedy criterion for selecting the next
receive antenna element was proposed based on the observation that the
capacity with n + 1 antenna elements can be written in terms of the capacity
with n antenna elements as follows:
(6.29)
where the matrix
depends on the channel subset chosen so far, and equals 
( )( )
L
N
L
N
t
t
r
r
C
N
S
t
F
sel ~
+
.
©
«
ª
ªª
¹
»
º
ºº
maxlog
(
)
H
H
2
2
1
W

log2 .
C
C
N
n
n
t
j
n
j
(
)
(
)
log
,
†


H
H
h B h
+
©
«
ª
ªª
¹
»
º
ºº
=
+
+
1
2 1
W
Bn
B
I
H H
n
N
N
n
n
t
t
=
+
(
)
1
W 
 †
.

Antenna Selection in MIMO Systems
163
The criterion for choosing the next antenna element then becomes: choose
the receive antenna element j corresponding to the row hj of the channel
matrix, H, that maximizes the following quadratic form:
(6.30)
Calculating the matrix inverse
is simpliﬁed by
using the following iteration:
(6.31)
The overall complexity of the algorithm is
.
A decremental iterative search algorithm that successively removes
antenna elements has also been proposed [10]. The recursion formulae are
similar to the ones above, though with the + and – signs reversed. The
decremental approach is efﬁcient when Lr is close to Nr, while the incremental
approach is efﬁcient for large antenna arrays from which a small subset of
antenna elements needs to be chosen (Lr ≪Nr). Both approaches achieve
performance very close to the optimal selection criterion.
A faster decremental algorithm that avoids matrix inversion and determi-
nants was proposed in [33]. For RAS, it is based on the intuition that a row
(receive antenna element) of the channel matrix that is highly correlated with
another row adds little additional information about the channel and may
be removed. The algorithm calculates the correlation between all the rows
of the channel matrix and selects the two rows with the highest correlation.
Between the two, it eliminates the row with the lower power. Given that the
MIMO transmission rate is better measured by mutual information, an alter-
nate approach is to calculate the mutual information between two rows
instead of their correlation. Of the two rows that result in the highest pair-
wise mutual information, the one with a lower power is eliminated.
Transmit antenna selection criteria have also been motivated by the water-
ﬁlling principle [6], which optimally allocates more power to the channel
modes with better channel quality. For example, [34] proposed ﬁnding the
subset, represented by the transmit covariance Ksel, that is close (in mean
square error sense) to the ideal water-ﬁlling transmit covariance Kw.
(6.32)
Here,
is a diagonal matrix (of size Nt × Nt) in which the diagonal entries
that correspond to the selected antenna elements are set as
, while the
remaining elements are all set to 0.
Jn
j
j
n
j
=
.
arg max
†
h B h
B
I
H
H
n
N
N
n
n
t
t
+

+
+
=
+
(
)
1
1
1
1
W 
 †
B
B
h B h
B h h B
n
n
N
J
n
J
n
J
J
n
t
n
n
n
n
+ =

+
.
1
1
W
†
†
O
N N
N L
t
r
t
r
(max{
}
)
,
H
K
K
H
=

.
argmin
(
)
S
w
2
sel
Ksel
W
Lt

164
MIMO System Technology for Wireless Communications
Given its simplicity, the norm-based criterion has often been used for
selecting antenna subsets even though it is sub-optimal for spatial multi-
plexing, especially in the presence of spatial correlation [31,33]. Figure 6.5
compares performance of the incremental and decremental algorithms with
the norm-based selection criterion. It plots the 10% outage capacity, i.e., the
value below which the capacity falls only 10% of the time, as a function of
Lr. It can be seen that both the incremental and decremental algorithms
perform as well as the optimal selection criterion, while the norm-based
selection criterion leads to a lower outage capacity. The differences are even
more pronounced in the presence of spatial correlation.
6.6.1.1
When Transmitter Has CSI
So far we have assumed that no CSI is available at the transmitter (except
for which antenna elements to use for transmission in the case of TAS). For
the case in which CSI is allowed at the transmitter, incremental selection
criteria based on heuristic criteria that depend on the signal power and the
mutual information between the transmitted (received) signals for TAS
(RAS) were proposed in [35], and have been shown to perform well.
6.6.1.2
With Linear Receivers
Linear receivers such as the Zero-forcing (ZF) receiver and the Minimum
mean square error (MMSE) receiver, while sub-optimal compared to the
FIGURE 6.5
Outage capacity with a 10% outage probability as a function of Lr for Nt = 4, Nr = 16, and W =
6 dB [31]. (© 2004 IEEE.)
Optimal selection 
Incremental algorithm 
Decremental algorithm 
Norm-based algorithm 
No selection strategy 
15
10% outage capacity (bit/s/Hz)
10
5
00 
2 
4 
6 
8 
10 
12 
14 
16 
Lr

Antenna Selection in MIMO Systems
165
MLD receiver, are popular because they offer a signiﬁcant reduction in
complexity. The ordered successive interference cancellation ZF (OSIC-ZF)
receiver, which reorders the streams in terms of their output SNR and
decodes the stream with the highest SNR ﬁrst [1], is also popular. To improve
the SNR, the OSIC-ZF receiver cancels the contribution from the streams that
have been decoded already.
Antenna selection at the transmitter and/or receiver for linear receivers is
discussed in [36–38]. The selection criteria turn out to be different for linear
receivers. In a linear receiver, the received signal, y, is passed through a linear
spatial ﬁlter (equalizer), W. The ﬁlter outputs a vector, ˆx, that is used to
estimate the original data, x:
(6.33)
The SNR of the
multiplexed streams is not equal due to interference from
the other streams. The stream with the lowest SNR is often the performance
bottleneck. It is therefore worthwhile to focus on improving this bottleneck.
It can be shown that for ZF, MMSE, and OSIC-ZF receivers, the lowest SNR
among all the streams is lower bounded by [37]
(6.34)
where
is the smallest eigenvalue of the square matrix
. This
motivates the following selection criterion that maximizes the minimum
eigenvalue:
(6.35)
However, this criterion does not motivate a low-complexity iterative tech-
nique to choose the optimal antenna selection subset. A decremental iterative
approach has been suggested in [10] to maximize the throughput of linear
receivers such as MMSE and OSIC-ZF. Criteria for joint adaptive modulation
and coding and transmit antenna selection are considered in [37].
6.6.2
Space–Time Codes
While the simple norm-based criterion is clearly optimal for OSTBCs, this
is not obvious for STTCs. A weak justiﬁcation for using it for STTCs is
presented below. It shows that the norm-based criterion maximizes a lower
bound on the pair-wise distance between codewords of the STTC [21]. Other
justiﬁcations for using the norm-based criterion for STTCs are presented in
[19].
ˆx
Wy
WHx
Wn
=
=
+
.
Nt
SNRmin
min
†
(
),
v W Q
Nt
H H
Qmin
†
(
)
H H
H H
†



H
H H
H
=
.
arg max
(
)
(
)
min
†
S
Q

166
MIMO System Technology for Wireless Communications
In Section 6.4.1, which studied STTCs, the minimum distance between
codewords, d, when the transmit antennas with indices
are chosen,
was written as
A lower bound on d2 can be shown to be
(6.36)
where
is the smallest eigenvalue of B, which depends entirely on the
codewords and, therefore, the STTC structure. The same logic applies to TAS,
as well.
6.7
Performance with Non-Idealities
When we considered space–time codes — ideal capacity-achieving codes or
practical realizations such as STTCs and OSTBCs — we made the following
assumptions:
•
Flat-fading assumption: We assumed that multipath dispersion is not
present.
•
Perfect channel knowledge assumption: We assumed that the receiver
can estimate the channel perfectly.
•
Block-fading channel assumption: We assumed that the channel does
not vary during the transmission of the space–time code.
In a practical system, non-idealities can invalidate these assumptions to
varying degrees. We now examine the impact of various non-idealities.
When multipath dispersion is present, antenna selection, while beneﬁcial,
is not as effective as in the ﬂat-fading case. In case of Rake receivers for
CDMA systems [20,39], which weigh and combine the signals received from
the multipaths, different sets of antenna elements may be optimum for
receiving different multipaths. In a MIMO-OFDM system, different antenna
element subsets may be optimum for different sub-carriers [40]. The perfor-
mance of various antenna selection criteria in the presence of multipath
dispersion is compared in [41]. A genetic-algorithm-based approach for
selecting the antenna elements was also proposed.
When the channel state is not estimated perfectly by the receiver, it leads
to the selection of sub-optimal subsets of antenna elements at the receiver
k
L
k
r
i
=
{ }
1
d
k
L
i
i
r
k
k
2
1
=
=
¨
h Bh† .
d
h
k
L
j
N
ikj
r
t
F
2
1
1
2
2
v
=
=
=
¨¨
Q
Q
min
min
( )
( )
,
B
B H
Qmin( )
B

Antenna Selection in MIMO Systems
167
and at the transmitter, which relies on feedback from the receiver.* Imperfect
CSI can also lead to errors in the receive weights in H-S/MRC receivers.
Assuming that the receiver always knows which transmit antenna elements
are used, the case when the lth best transmit antenna element is selected was
investigated in [42]. The analysis showed that the diversity order decreases
to lNr compared to NrNt, which is achieved when the best antenna element
is chosen. This result shows that selection errors can reduce the diversity
order of TAS. The impact of transmit antenna selection errors due to imper-
fect feedback on the performance of the Alamouti code was considered in
[43]. The impact of estimation errors in a diversity system with transmit
antenna selection was investigated in [44]. The loss in capacity was found
to be tolerable so long as the SNR of the pilot was greater than a threshold
value. The capacity degraded signiﬁcantly for pilot SNRs below the threshold.
In fast fading with STTCs, simulations have shown that the diversity order
achieved by receive antenna selection decreases and becomes a function of
the number of selected antenna elements [45].
6.8
Antenna Selection with Spatial Correlation
So far, we have assumed that the links between transmit and receive antenna
pairs are independent of each other. Moreover, the antenna selection tech-
niques that we considered were based on the instantaneous channel state.
In such a set up, a new subset has to be reselected every time the short-term
fading variations decorrelate, which happens when the transmitter or the
receiver moves over distances as small as half a wavelength. In some cases,
such as low pilot power, it might be very difﬁcult to estimate the instanta-
neous state in a short amount of time. However, it might still be possible to
reliably acquire statistical knowledge about the channel, such as spatial
correlation, which decorrelates only over distances of tens of meters.
We now consider antenna selection that uses spatial correlation informa-
tion. The Kronecker model captures the transmit and receive antenna ele-
ment correlations for many typical channels [46]. The channel matrix takes
the form
(6.37)
where
and
are the transmit and receive correlation matrices, respec-
tively, and
is a spatially white matrix in which all the elements are
mutually independent complex Gaussian random variables. The transmit
(receive) covariance depends on the distance between the transmit (receive)
* Despite imperfect feedback, it is assumed in [42–44] that the receiver always knows which
transmit antenna elements are used.
H
R
H R
=
r
w
t
1 2
1 2
/
/ ,
Rt
Rr
Hw

168
MIMO System Technology for Wireless Communications
antenna elements, the mean angle of departure (arrival) of the signal, and
the angular dispersion at the transmitter (receiver).
We now analyze the performance of antenna selection when it is based
only on the statistical information and not the short-term fading of the
channel. Antenna selection based on statistics has been considered in
[23,47,48]. Let
~Rt and
~Rr denote the principal sub-matrices of Rt and Rr,
respectively, that correspond to the antenna elements selected, and have
ranks rt and rr, respectively. The size of
~Rt is Lt × Lt while that of
~Rr is Lr ×
Lr. Assuming that
~Rt and
~Rr are full rank, the fading-averaged pair-wise error
probability of a space–time code at high SNR can be upper bounded by [23]
(6.38)
where B depends on the space–time code. For example, it is deﬁned for
STTCs in Section 6.4.1. Therefore, the diversity order equals NrNt. In case
~Rt
and
~Rr are not full-rank, the diversity order scales linearly with the product
of the ranks of
~Rt and
~Rr.
For TAS, the optimal criterion is to select the transmit antenna elements
that maximize 
~Rt, while the optimal criterion for RAS is to select the receive
antenna elements that maximize 
~Rr. Moreover, the transmit and receive
selection processes can occur independently of each other. Note that this is
a consequence of assuming a Kronecker structure of the channel.
6.8.1
Alternate Antenna Selection Structures
We have seen that, while antenna selection achieves full diversity, it does
suffer from a loss in array gain. Novel antenna selection structures have been
recently proposed that involve a joint design of the RF and baseband [47–49].
The joint design introduces an RF pre-processing matrix that processes the
signals from the different antennas, and is followed by selection (if neces-
sary), down-conversion, and further processing in the baseband. The scheme
is similar to conventional antenna selection because it uses fewer RF chains
than the available antenna elements. However, it achieves superior perfor-
mance by exploiting the spatial correlation of the received signals. For both
spatial diversity and spatial multiplexing solutions, the joint-design, unlike
conventional antenna selection, does not incur an array gain loss. RF pre-
processing is familiar to the microwave community and has been used for
applications such as analog beamforming [50]. It is important to understand
that while adding a full-rank linear pre-processing block in the receiver
cannot increase the capacity in a full complexity system, it does make a
substantial difference in the presence of antenna selection, because selection
is an inherently lossy operation.
Two designs have been considered. The ﬁrst design uses an L × Nr RF pre-
processing matrix that outputs only L streams followed by baseband signal
P
L
r
N
t
N
N N
t
t
r
t
r
f
©
«ª
¹
»º

1


R
R
B
W
,

Antenna Selection in MIMO Systems
169
processing — it thus eliminates the need for a selection switch. The second
one uses an Nr × Nr RF pre-processing matrix that outputs Nr streams and
is followed by a switch that selects L streams for baseband signal processing.
A block diagram of this scheme is shown for a receiver in Figure 6.6.
The optimum RF pre-processing solutions can be tailored to the CSI avail-
able for RF pre-processing. The simplest architecture is one in which the RF
pre-processing matrix is always ﬁxed. The use of an
Butler matrix,
followed by a selection switch, was proposed in [49], and shown to signiﬁ-
cantly outperform conventional antenna selection. The other extreme (most
complicated, but best) is one in which the RF pre-processing matrix is tuned
to the instantaneous channel state [51]. The third and intermediate case is
one in which the RF pre-processing solution depends only the slowly varying
large-scale statistics of the channel.
We now analyze the case of statistics-based RF pre-processing for spatial
multiplexing. The pre-processing matrix, MLr, is of size Lr × Nr. In baseband
notation, the vector,
, of size Lr × 1, at the output of MLr now takes the form
(6.39)
The ergodic capacity of such a system is given by
(6.40)
It can be shown that the optimal RF pre-processing matrix that maximizes
ergodic capacity is of the form
where
is the ith larg-
est eigenvector of the receive covariance matrix Rr, and D is an arbitrary
Lr × Lr full-rank matrix. When M is of size Nr × Nr, and is followed by an
antenna selection switch, the optimal M then takes the form MLr = [r1, r2, …, rNr].
Figure 6.7 compares the performance of various RF pre-processing schemes
with conventional antenna selection for different spatial correlations. The
FIGURE 6.6
Block diagram for RF pre-processing and antenna selection at the receiver for spatial multiplex-
ing [48]. (© 2004 IEEE.)
RF
Baseband
1
L
L
1
2
Selection(optional) 
M
Down-conversion
Channel
1
Nr
H
Tx
1
2
Nt
Signal
Proc
N
N
r
r
×
y
y
M Hx
M n
=
+
.
L
L
r
r
E
H
E
I
H M
M M
H
M
H
C
N
Lr
t
r
r
r
N
t
L
L
L
(
)
max
log
(
†
†
¬®
¼¾ =
+
2
W
† )
¬
®
­
¼
¾
½.
1M H
Lr
M
D r r
r
L
L
r
r
…
=
,
,
,
[
] ,
†
1
2
ri

170
MIMO System Technology for Wireless Communications
CDFs of the capacity are plotted for all the solutions. The case in which the
RF pre-processing block is of size Lr × Nr and depends only on the transmit
and receive covariances is denoted by TI (time-invariant); the case in which
it is of size Nr × Nr and depends only on the transmit and receive covariances
is denoted by TI-S (time-invariant with selection); and the Butler matrix
solution is denoted by FFT-sel (fast Fourier transform with selection). Sta-
tistics-based and Butler-matrix-based solutions outperform conventional
antenna selection even for large angular spreads.*
The optimum RF pre-processing matrices (of sizes Lr × Nr and Nr × Nr
depending on the design) for a spatial diversity system are derived in [47].
While the elements of the RF pre-processing block can have an arbitrary
amplitude, hardware considerations make the implementation of the RF pre-
processing matrix using only variable-phase shifters an attractive option. An
algorithm for implementing using phase-shifters is proposed in [47]. It has
been shown in [52] that the structures are robust to phase quantization and
to channel estimation errors.
6.9
Summary
Antenna selection is a promising low-complexity solution that solves the
pressing problem of the increased hardware and signal processing complexity
FIGURE 6.7
Performance comparison of RF pre-processing techniques and conventional antenna selection
for spatial multiplexing (Nr = 4, Lr = 1, mean angle of arrival = 60°) [48]. (© 2004 IEEE.)
*  The larger the angular spread, the less the correlation between the antenna elements.
0
2
4
6
8
10
12
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Capacity (bits/s/Hz) 
CDF
Ant Sel (σr = 6°)
Ant sel (σr = 15°)
FFT-sel, TI, TI − S (σr = 15°)
FFT-sel, TI, TI − S (σr = 6°)
FC (σr = 15°)
FC (σr = 6°)

Antenna Selection in MIMO Systems
171
of MIMO systems. This chapter provides an overview of the extensive work
that has been done on antenna selection at the transmitter, or at the receiver,
or both. We considered antenna selection for SIMO systems and several
different MIMO techniques such as capacity-achieving spatial multiplexing,
space–time trellis codes, and orthogonal space–time block codes. We saw in
several of these cases that antenna selection achieves full diversity order.
However, it incurs an array gain loss, which increases as the number of
selected antennas decreases. We also developed several criteria for imple-
menting antenna selection that trade off between complexity and performance.
The criteria were tailored to the speciﬁc system under consideration. We also
considered novel structures that use a RF pre-processing block along with
the selection switch and, in the presence of spatial correlation, recover the
array gain loss of antenna selection to a great extent.
References
1. G.J. Foschini and M.J. Gans. 1998. “On the limits of wireless communications
in a fading environment when using multiple antennas,” Wireless Pers. Com-
mun., Vol. 6, pp. 311–335.
2. S. Sanayei and A. Nosratinia. 2004. “Antenna selection in MIMO systems,”
IEEE Commun. Mag., Oct. 2004, pp. 68–73.
3. H. Holma and A. Toskala. 2000. WCDMA for UMTS, New York: John Wiley & Sons.
4. A.F. Molisch and M.Z. Win. 2004. “MIMO systems with antenna selection,”
IEEE Microwave Mag., Vol. 5, March 2004, pp. 46–56.
5. T.M. Cover and J.A. Thomas. 1991. Elements of Information Theory, Wiley Series
in Telecommunications, New York: John Wiley & Sons.
6. E. Telatar. 1999. “Capacity of multi-antenna Gaussian channels,” European
Trans. Telecommun., Vol. 10, pp. 585–595.
7. R.S. Blum and J.H. Winters. 2002. “On optimum MIMO with antenna selection,”
IEEE Commun. Lett., Vol. 6, Aug. 2002, pp. 322–324.
8. P.J. Voltz. 2003. “Characterization of the optimum transmitter correlation matrix
for MIMO with antenna subset selection,” IEEE Trans. Commun., Vol. 51, Nov.
2003, pp. 1779–1782.
9. A.F. Molisch, M.Z. Win, and J.H. Winters. 2001. “Capacity of MIMO systems
with antenna selection,” Proc. ICC, pp. 570–574; see also A.F. Molisch, M.Z.
Win, Y.S. Choi, and J.H. Winters. 2005. “Capacity of MIMO systems with
antenna selection,” IEEE Trans. Wireless Commun., 4, 142–154.
10. A. Gorokhov, D. Gore, and A. Paulraj. 2003. “Receive antenna selection for
MIMO ﬂat-fading channels: theory and algorithms,” IEEE Trans. Inform. Theory,
Vol. 49, pp. 2687–2696.
11. D.A. Gore, R.U. Nabar, and A. Paulraj. 2000. “Selecting an optimal set of
transmit antennas for a low rank matrix channel,” Proc. ICASSP, May 2000,
pp. 2785–2788.
12. D. Chizhik, G.J. Foschini, and R.A. Valenzuela. 2000. “Capacities of multi-
element transmit and receive antennas: correlations and keyholes,” Electron.
Lett., Vol. 36, pp. 1099–1100.

172
MIMO System Technology for Wireless Communications
13. M.K. Ozdemir, E. Arvas, and H. Arslan. 2004. “Dynamics of spatial correlation
and implications on MIMO systems,” IEEE Radio Commun., June 2004,
pp. S14–S19.
14. T. Shu and Z. Niu. 2003. “A near-optimal antenna selection in MIMO system
by using maximum total eigenmode gains,” Proc. Globecom, pp. 297–301.
15. R.S. Blum. 2003. “MIMO capacity with antenna selection and interference,”
Proc. ICASSP, 2003, pp. IV–824–IV–827.
16. V. Tarokh, N. Seshadri, and A.R. Calderbank. 1998. “Space-time codes for high
data rate wireless communication: performance criterion and code construc-
tion,” IEEE Trans. Inform. Theory, Vol. 44, pp. 744–765.
17. V. Tarokh, H. Jafarkhani, and A.R. Calderbank. 1999. “Space-time block codes
from orthogonal designs,” IEEE Trans. Inform. Theory, Vol. 45, July 1999,
pp. 1456–1467.
18. A.R. Hammons and H.E. Gamal. 2000. “On the theory of space-time codes for
PSK modulation,” IEEE Trans. Inform. Theory, Vol. 46, pp. 524–542.
19. A. Ghrayeb and T.M. Duman. 2003. “Performance analysis of MIMO systems
with antenna selection over quasi-static fading channels,” IEEE Trans. Veh.
Technol., Vol. 52, March 2003, pp. 281–288.
20. J.G. Proakis. 1989. Digital Communications. 2nd ed., New York: McGraw-Hill.
21. Z. Chen, B. Vucetic, J. Yuan, and Z. Zhou. 2004. “Performance analysis of space-
time trellis codes with transmit antenna selection in Rayleigh fading channels,”
Proc. WCNC, March 2004, pp. 2456–2462.
22. B. Picinbono and P. Chevalier. 1995. “Widely linear estimation with complex
data,” IEEE Trans. Sig. Proc., Vol. 43, pp. 2030–2033.
23. D.A. Gore and A. Paulraj. 2002. “MIMO antenna subset selection with space-
time coding,” IEEE Trans. Sig. Proc., Vol. 50, Oct. 2002, pp. 2580–2588.
24. X.N. Zeng and A. Ghrayeb. 2004. “Performance bounds for space-time block
codes with receive antenna selection,” IEEE Trans. Inform. Theory, Vol. 50,
pp. 2130–2137.
25. M.Z. Win and J.H. Winters. 1999. “Analysis of hybrid selection/maximal-ratio
combining in Rayleigh fading,” IEEE Trans. Commun., Vol. 47, pp. 1773–1776.
26. M.S. Alouini and M.K. Simon. 1999. “Performance of coherent receivers with
hybrid SC/MRC over nakagami-m fading channels,” IEEE Trans. Veh. Technol.,
Vol. 48, July 1999, pp. 1155–1165.
27. M.Z. Win and J.H. Winters. 2001. “Virtual branch analysis of symbol error
probability for hybrid selection/maximal-ratio combining in Rayleigh fading,”
IEEE Trans. Commun., Vol. 49, Nov. 2001, pp. 1926–1934.
28. M.Z. Win, N.C. Beaulieu, L.A. Shepp, J. Benjamin F. Logan, and J.H. Winters.
2003. “On the SNR penalty of MPSK with hybrid selection/maximal ratio
combining over i.i.d. Rayleigh fading channels,” IEEE Trans. Commun., Vol. 51,
pp. 1012–1023.
29. S. Thoen, L. Van der Perre, B. Gyselinckx, and M. Engels. 2001. “Performance
analysis of combined transmit-SC/receive-MRC,” IEEE Trans. Commun.,
Vol. 49, Jan. 2001, pp. 5–8.
30. A.F. Molisch, M.Z. Win, and J.H. Winters. 2003. “Reduced-complexity transmit/
receive-diversity systems,” IEEE Trans. Sig. Proc., Vol. 51, Nov. 2003, pp. 2729–2738.
31. M. Gharavi-Alkhansari and A. Gershman. 2004. “Fast antenna subset selection
in MIMO systems,” IEEE Trans. Sig. Proc., Vol. 52, pp. 339–347.
32. R.A. Horn and C.R. Johnson. 1996. Matrix Analysis, Cambridge, U.K.: Cam-
bridge University Press.

Antenna Selection in MIMO Systems
173
33. Y.-S. Choi, A.F. Molisch, M.Z. Win, and J.H. Winters. 2003. “Fast algorithms for
antenna selection in MIMO systems,” Proc. VTC, Fall, pp. 1733–1737.
34. S. Sandhu, R.U. Nabar, D.A. Gore, and A. Paulraj. 2000. “Near-optimal selection
of transmit antennas for a MIMO channel based on shannon capacity,” Proc.
Asilomar, pp. 567–571.
35. M. Jensen and M. Morris. 2005. “Efﬁcient capacity-based antenna selection for
MIMO systems,” IEEE Trans. Veh. Technol., Vol. 54, pp. 110–116.
36. R.W. Heath, S. Sandhu, and A. Paulraj. 2001. “Antenna selection for spatial
multiplexing systems with linear receivers,” IEEE Commun. Lett., Vol. 5, April
2001, pp. 142–144.
37. R. Narasimhan. 2003. “Spatial multiplexing with transmit antenna and constel-
lation selection for correlated MIMO fading channels,” IEEE Trans. Sig. Proc.,
Vol. 51, Nov. 2003, pp. 2829–2838.
38. H. Zhang and H. Dai. 2004. “Fast transmit antenna selection algorithms for
MIMO systems with fading correlation,” Proc. VTC, pp. 1638–1642.
39. G. Bottomley, T. Ottosson, and Y.-P. Wang. 2000. “A generalized RAKE receiver
for interference suppression,” IEEE J. Select. Areas Commun., Vol. 8, pp. 1536–1545.
40. G. Stuber, J. Barry, S. McLaughlin, Y. Li, M. Ingram, and T. Pratt. 2004. “Broad-
band MIMO-OFDM wireless communications,” Proc. IEEE, Vol. 92, pp. 271–294.
41. P. Karamalis, N. Skentos, and A. Kanatas. 2004. “Selecting array conﬁgurations
for MIMO systems: an evolutionary computation approach,” IEEE Trans. Wire-
less Commun., Vol. 3, pp. 1994–1998.
42. Z. Chen. 2004. “Asymptotic performance of transmit antenna selection with
maximal-ratio combining for generalized selection criterion,” IEEE Commun.
Lett., Vol. 8, April 2004, pp. 247–249.
43. W.H. Wong and E.G. Larsson. 2003. “Orthogonal space-time block coding with
antenna selection and power allocation,” Electron. Lett., Vol. 39, pp. 379–381.
44. A.F. Molisch, M.Z. Win, and J.H. Winters. 2002. “Performance of reduced-
complexity transmit/receive-diversity systems,” Proc. WPMC, Oct. 2002,
pp. 739–742.
45. A. Ghrayeb, A. Sanei, and Y. Shayan. 2004. “Space-time trellis codes with
receive antenna selection in fast fading,” Electron. Lett., Vol. 40.
46. J.P. Kermoal et al. 2002. “A stochastic MIMO radio channel model with exper-
imental validation,” IEEE J. Select. Areas Commun., Vol. 20, Aug. 2002,
pp. 1211–1226.
47. P. Sudarshan, N.B. Mehta, A.F. Molisch, and J. Zhang. 2004. “Spatial diversity
and channel statistics-based RF-baseband co-design for antenna selection,”
Proc. 60th IEEE Vehicular Techn. Conf., invited paper, pp. 1658–1662.
48. P. Sudarshan, N.B. Mehta, A.F. Molisch, and J. Zhang. 2004. “Channel statistics-
based joint RF-baseband design for antenna selection for spatial multiplexing,”
Proc. Globecom, Dec. 2004, pp. 3947–3951.
49. A. Molisch and X. Zhang. 2004. “FFT-based hybrid antenna selection schemes
for spatially correlated mimo channels,” IEEE Commun. Lett., Vol. 8, pp. 36–38.
50. T. Ohira. 2002. “Analog smart antennas: An overview,” Proc. PIMRC,
pp. 1502–1506.
51. A.F. Molisch, X. Zhang, S.Y. Kung, and J. Zhang. 2003. “Antenna selection
schemes for spatially correlated MIMO channels,” Proc. PIMRC, pp. 1119–1123.
52. P. Sudarshan, N.B. Mehta, A.F. Molisch, and J. Zhang. 2004. “Antenna selection
with RF pre-processing: robustness to RF and selection non-idealities,” Proc.
IEEE Radio & Wireless Conference (RAWCON), invited paper, pp. 391–394.


175
7
Performance of Multi-User Spatial 
Multiplexing with Measured Channel Data
Quentin H. Spencer, Jon W. Wallace, Christian B. Peel, Thomas Svantesson, 
A. Lee Swindlehurst, Harry Lee, and Ajay Gumalla
CONTENTS
Abstract.................................................................................................................176
7.1
Introduction ................................................................................................176
7.2
The Multiple-User MIMO Channel........................................................178
7.2.1
Capacity ..........................................................................................181
7.3
Multi-User MIMO Transmission Schemes ............................................183
7.3.1
Linear Processing, Single-Antenna Receivers ..........................183
7.3.1.1
Channel Inversion...........................................................183
7.3.1.2
Regularized Channel Inversion....................................184
7.3.1.3
Optimal Linear Precoders .............................................184
7.3.2
Linear Processing, Multi-Antenna Receivers ...........................187
7.3.2.1
Coordinated Zero-Forcing.............................................189
7.3.2.2
General Coordinated Beamforming.............................190
7.3.3
Non-Linear Processing Methods ................................................191
7.4
Channel Measurements ............................................................................191
7.5
Performance Results..................................................................................194
7.5.1
Multi-User Performance in Randomly Generated 
Channels .........................................................................................195
7.5.2
Multi-User Performance in Channels Derived from 
Measurements................................................................................197
7.5.2.1
Effects of Inter-User Separation....................................198
7.5.2.2
Effects of User Motion ...................................................200
7.6
Summary.....................................................................................................201
7.7
Acknowledgments.....................................................................................202
References.............................................................................................................203

176
MIMO System Technology for Wireless Communications
Abstract
The application of MIMO processing techniques in channels that are shared
among multiple users is a relatively new problem that is increasingly impor-
tant as MIMO transmission is put into practical use. In this chapter we
speciﬁcally consider the multi-user downlink, where a base station with
multiple antennas transmits simultaneously to more than one user. We begin
with an overview of some of the multi-user MIMO transmission schemes
that have been proposed up to this point, then demonstrate how they might
be expected to perform by applying the algorithms to measurement data
from indoor and outdoor propagation environments. Speciﬁcally, we com-
pare the number of simultaneous users the channel will support for the two
different environments, the amount of separation of the users necessary to
achieve maximum throughput, and the quality of channel information avail-
able to the base station when the users are mobile. In both environments,
full multi-user diversity is achieved at relatively short distances on the order
of one meter. The total number of simultaneous users in outdoor environ-
ments is limited compared to uncorrelated channels due to the relatively
sparse multipath structure of the channel. The distances at which channel
information becomes too old to be useful to the transmitter appears to be
similar for both types of channels.
7.1
Introduction
One of the most important emerging problems for communications system
designers is applying multiple-input multiple-output (MIMO) concepts to
multi-user environments. The most ubiquitous wireless applications of our time
are cellular telephony and wireless LANs — inherently multi-user systems —
in which the increasing demand for higher capacity makes them obvious
candidates for the capacity improvements promised by MIMO processing.
In order to share a limited amount of frequency spectrum, all multi-user
communication systems use one or more of the traditional forms of multi-
plexing: time-division, frequency-division, and code-division. The best
multiplexing scheme for a given application is dependent on the character-
istics of the particular channel of interest. The use of antenna arrays in a multi-
user channel enables one further type of multiplexing often referred to as
spatial multiplexing. Spatial multiplexing is particularly appealing because
it can easily be used in conjunction with other forms of multiplexing to
dramatically improve the number of users that can share a given channel.
In addition to the promise of improved capacity for future communication

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
177
networks, in some cases these methods can be applied to existing commu-
nication protocols, thus extending their usefulness.
The problem of MIMO communications in multi-user environments can
be further divided into two distinct problems, each with unique challenges:
the “uplink” channel and “downlink” channel, as illustrated in Figure 7.1.
The uplink refers to the case where a group of users sharing the same channel
(representing a unique time slot, frequency, or code sequence) transmit
simultaneously. Among information theorists this is commonly labeled the
multiple access channel. This scenario requires the multi-antenna base station
to successfully separate all of the interfering signals, which can be achieved
if the users are transmitting from different locations by exploiting the dif-
fering spatial characteristics of the respective channels at the receiver.
The downlink channel (the broadcast channel among information theorists)
refers to the case where the base station transmits simultaneously to more
than one user over a shared channel. This poses challenges that are somewhat
different from the uplink channel, because the receivers are unable to coop-
erate, so the signals at the different receivers cannot be processed jointly.
Since the receivers pictured in Figure 7.1 have multiple antennas, they could,
in theory, use multiple-user detection (MUD) techniques to avoid the inter-
fering signals. This is typically computationally costly, and in cases where
users have only a single antenna, it is not possible without relying on other
forms of multiplexing such as CDMA. Ideally, then, we would like to miti-
gate the multiple-access interference (MAI) at the transmitter by intelligently
designing the transmitted signal.
In this chapter, we begin by reviewing the problem of the multi-user MIMO
downlink and discuss in general terms several different transmission
FIGURE 7.1
An illustration of a multiple-user MIMO channel with uplink and downlink. In the uplink, the
base station receives multiple interfering signals and uses their spatial properties to separate
them. In the downlink, each user often receives data intended for other users, and is not able
to coordinate with them.
Base 
station 
Uplink signal from user 2 
Downlink signal intended for user 1
Downlink signal intended for user 2 
Uplink signal from user 1 
User 1 
User 2 

178
MIMO System Technology for Wireless Communications
approaches that have been proposed. We compare the performance of some
of the schemes in randomly generated channels under ideal conditions. We
then show how the algorithms would perform under real-world conditions
using measurement data from an indoor propagation environment and two
different outdoor environments. We focus in particular on the achievable
capacity, the ability of the channels to support multiple sub-channels per
user, the required separation distance between users to maximize available
capacity, and the effects of channel estimation error due to user mobility. We
begin with a mathematical model used for characterizing multi-user MIMO
channels.
7.2
The Multiple-User MIMO Channel
A MIMO channel with
transmitters and
receivers is commonly repre-
sented as a matrix
of dimension
, where each of the coefﬁcients
[H]i,j represents the complex transfer function from the jth transmitter to the
ith receiver. We denote the signal transmitted from the jth transmitter at time
t as xj(t), and represent the total transmitted signal with the vector x(t) of
dimension nT. Likewise, we represent the received signal with the nR-dimen-
sional vector y(t), which can be expressed as a function of the transmitted
signal, the channel matrix, and an nR-dimensional additive noise vector n(t):
(7.1)
For simplicity, we will omit the dependence on time, referring to the
transmitted and received signals instead as x and y. In a single-user point-
to-point MIMO link, all outputs are available to the receiver for processing.
In the multiple-user case, the nR receivers are distributed among different
users, so we extend the model to reﬂect this. Let K represent the number of
users sharing a channel, and let nRj represent the number of antennas for
user j, so that the total number of receive antennas
The channel between the base and user j is now the
matrix Hj, whose
rows we denote by
as follows:
nT
nR
H
n
n
R
T
×
y
Hx
n
( )
( )
( )
t
t
t
=
+
.
n
n
R
j
K
j
R
=
=
¨
1
.
j
R
T
n
n
×
hij

H
h
h
j
j
n
jj
R
=
…

¬
®
­
­
¼
¾
½
½
1
,

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
179
where
is used to denote the complex conjugate (Hermitian) transpose.
Note that this model is based on the assumption of a ﬂat-fading or nar-
rowband channel, which is not true in many current and next-generation
wireless communications applications. This matrix channel model can still
be applied to many broadband channels. For example, many modern broad-
band communication protocols are based on orthogonal frequency division
multiplexing (OFDM). Typically, the bandwidth of one OFDM subcarrier is
narrow enough that the narrowband model applies, so MIMO processing
algorithms could be applied independently for each subcarrier. While we
assume a narrowband channel throughout this chapter, the methods dis-
cussed here can also be applied to broadband channels using OFDM or
similar techniques.
Using this model, consider the signal received by user j. User j not only
receives its own signal through the channel Hj, but also contributions from
the signals intended for other users:
(7.2)
where nj is assumed to be spatially white noise. The transmitted signal
 is
then the sum of the transmitted signals for each user:
We assume that the transmitted signal xj is formed from a vector dj of mj
symbols to be transmitted to user j. In a single-user channel, the number of
symbols transmitted in parallel is limited by the rank of the channel matrix.
Likewise, in a multi-user channel, mj is limited by the rank of Hj. We use the
vector d to denote the data symbols transmitted to all users:
where the dimension of d is
It is possible to transmit at different rates to each of the K users by the choice
of symbol constellation and channel coding for each user, and by the number
of data streams mj transmitted to each user. Suitable values for m1, …, mK
( ) 
y
H x
n
j
k
K
j
k
j
=
+
=¨
1
,
x
x
x
=
=
¨j
K
j
1
.
d
d
d
d
=
…
¬
®­
¼
¾½
T
T
T
K
T
1
2
,
m
m
j
K
j
=
=
¨
1
.

180
MIMO System Technology for Wireless Communications
will not only depend on the desired data rate for user j, but also on the
available transmit power, the achievable SINR, and the number of transmit
and receive antennas. Without additional coding or multiplexing, typically
mj f nRj, and 8mk f nT. The choice of mj to obtain optimal system performance
is itself an important problem that has recently been studied in [1].
The transmitted signal x is formed from d using some encoding function that
we denote by fe, so that x = fe (d). The receivers use a decoding function fd
to estimate the data vectors:
. This scheme is illustrated in
Figure 7.2. To describe the dimensions of a particular channel, we use the
notation {nR1, …, nRK} × nT. A system with K = 4 users having one antenna
each and nT = 4 transmit antennas could be written as a {1,1,1,1} × 4 system.
Likewise, a {1,1,2,2} × 4 describes a similar case where two of the users have
two antennas. The challenge of the multi-user MIMO downlink is to choose
encoding and decoding functions fe and fd that optimize the use of channel
resources. Speciﬁc optimization goals may include maximizing total
throughput, ensuring a certain quality of service (QoS) for each user, or
minimizing transmit power, among others.
Achieving any of these goals requires that the transmitter have some
information about the channel. From an information-theoretic point of view,
a MIMO channel where the transmitter has channel state information (CSI)
has a different channel capacity than the same channel without CSI. Single-
user MIMO systems beneﬁt from having CSI at the transmitter mainly when
nT v nR or at low SNR. On the other hand, CSI in a multi-user MIMO
downlink is critical to minimizing inter-user interference under all channel
conditions. Obtaining CSI is itself a challenging problem [2]. It can generally
be obtained in a two-way communications system by either sending the infor-
mation over the reverse link, or estimating channel parameters of the reverse
link and applying them to the forward link. In this chapter, we assume that
CSI is available, and we will later investigate the effects of corrupted channel
information on multi-user performance.
Another property of radio channels to consider is how they vary over time.
The assumption that CSI is available at the transmitter usually implies that
FIGURE 7.2
An illustration of downlink multi-user processing, where each user has multiple antennas and
receives parallel data symbols.
Precoder 
Channel K  
Channel 1  
Receiver K  
Receiver 1  
H1 
y1 
d 
HK 
yK 
x 
fd(yK) 
fd(y1) 
dK 
d1 
fe(d) 
n1 
nK 
j
d
j
ˆ
(
)
d
f y
=

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
181
the channel is quasi-static, which has been assumed in much of the research
to date on multi-user MIMO channels. This is a reasonable assumption for
channel environments such as wireless local area networks (LANs), where
users are mobile but do not move rapidly. Cellular telephone applications
are more challenging because speeds are much higher. Downlink processing
methods for channels that are quickly time-varying with limited CSI is an
important problem for future research. However, the results included in
Section 7.4 suggest that the prediction horizons for MIMO systems may be
much longer than in the SISO case (which has usually proven to be too short
to be useful), since multiple antennas reveal more information about the
physical structure of the channel [3].
7.2.1
Capacity
Capacity is an important tool for analysis of communication channels. In
single-user MIMO channels it is common to assume a constraint on total
power broadcast by all transmit antennas. For a multi-user MIMO channel,
the problem is more complex. Given a constraint on the total transmitted
power, it is possible to allocate varying fractions of that power to different
users in the network, so a single power constraint can yield many different
information rates. The result is a “capacity region” like that illustrated in
Figure 7.3 for a two-user channel. The “corners” of the region represent
allocation of 100% of the power to either one of the users. For every possible
power distribution in between, there is an achievable information rate, which
results in the outer boundary of the region. In Figure 7.3, two regions are
FIGURE 7.3
An illustration of a multi-user capacity region. The sum capacity may penalize certain users,
depending on the shape of the capacity region.
Equal 
capacity 
Maximum sum 
capacity 
Capacity 
region 
Rate for user 2 
Rate for user 1 
“Near-Far” 
capacity 
region 

182
MIMO System Technology for Wireless Communications
shown: one for the case where both users have similar maximum capacity,
and one for the case where they are different (due, for example, to user 2’s
channel being attenuated relative to user 1, sometimes referred to as the
“near-far” problem). For K users, the capacity region is characterized by a
K-dimensional volume.
In Figure 7.3, two points are indicated on the boundary of each of the two
regions. One point represents the maximum achievable throughput of the
entire system, or the point on the curve that maximizes the sum of all users’
information rates. It is clear that this sum capacity point does not always
represent a fair distribution of resources among the users. The second point
on the two curves is located where the curves intersect with the line C2 =
C1, and represents the maximum achievable rate such that both users have
equal rates. The problem in this case is that the total throughput is substan-
tially reduced in the “near-far” case. While the sum capacity point clearly
does not convey all the relevant information about a multi-user MIMO
channel, it is nevertheless a useful tool for understanding the relative capa-
bilities of a particular transmission algorithm or channel, and will be used
extensively in this chapter for that purpose.
The capacity of the multi-user MIMO channel is achieved by applying a
concept that originates from a paper by M. Costa [4] known as “writing on
dirty paper.” Costa studied communication channels with interference and
proved the somewhat surprising result that if a received signal y is deﬁned as
(7.3)
where s is the transmitted signal, i is interference known deterministically
to the transmitter, and w is additive white Gaussian noise, the capacity of the
system is the same as if there were no interference present, regardless of
how strong the interference is and whether or not it is known to the receiver.
Using the dirty paper analogy, the capacity of a dirty sheet of paper is the
same as that of a clean sheet if the location of the dirt is known.
The implications of this result for multi-user MIMO channels with CSI
available at the transmitter are clear: since the channel and the transmitted
signals are all known, the transmitter knows how a signal designed for one
user interferes with other users and can design the signals for the other users
to compensate. This is the basis for many of the results on capacity of the
MIMO broadcast channel [5–9]. While the initial capacity results characterize
the achievable rate, they only prove achievability, but do not describe how
this rate is achieved. More recently, some practical transmission schemes
[10–12] have been proposed that use dirty paper codes to approach the
capacity of the scalar interference channel. To date, no practical application
of dirty-paper codes to the downlink problem has appeared, though the
techniques of [13] are related to dirty-paper coding (DPC).
A simpliﬁed approach to transmission in multi-user channels is to treat
all interference as noise. Clearly, this is suboptimal, but it also results in much
y
s
i
w
=
+ +
,

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
183
simpler implementations. The result is that the encoder fe and decoder fd are
linear functions of the data to be transmitted and the received signals, respec-
tively. The linear class of transmission schemes can generally be viewed as
a type of beamforming. Linear transmission schemes exist for a wide variety
of channel conﬁgurations, while so far, dirty-paper schemes have only been
proposed for the special case where all receivers have one antenna nRj = 1.
However, the existing dirty-paper schemes can be applied to the more gen-
eral case where nRj > 1 by combining them with linear processing methods.
In the next section we review some of these schemes.
7.3
Multi-User MIMO Transmission Schemes
As noted above, the existing schemes for transmitting from an antenna array
to a group of users can be put in two broad categories: linear and non-linear.
They can also be categorized as algorithms for single-antenna receivers and
multi-antenna receivers. In this section we review some of the linear methods
that have been proposed, and brieﬂy discuss non-linear methods.
7.3.1
Linear Processing, Single-Antenna Receivers
We begin with linear transmission schemes for the case where each user has
only one receive antenna: nRj = 1. With only one antenna, the receiver is unable
to perform any spatial interference suppression of its own, so the transmitter
is responsible for precoding the data in such a way that the interference seen
by each user is tolerable. We consider three techniques for solving this
problem: channel inversion, regularized channel inversion, and optimal
beamforming.
7.3.1.1
Channel Inversion
Perhaps the simplest way of managing the inter-user interference in a multi-
user downlink is using the (pseudo-) inverse of the channel matrix H [14–16].
For non-square channels where nT v K = nR, the transmitted signal s is
(7.4)
The matrix , is a diagonal matrix used to scale the power transmitted to
each user. The channel inversion nulls out all inter-user interference, reduc-
ing the problem to K independent scalar channels, so the amount of power
allocated to one user does not affect the others. Given a constraint on the
total transmitted power W, , can be chosen in different ways to achieve
s
H HH
d
=
.



©
«ª
¹
»º
1
,

184
MIMO System Technology for Wireless Communications
different goals: allocate equal power to all users, allocate equal capacity to
all users, or maximize sum capacity. Sum capacity can be maximized by
computing the gain of each of the independent channels and using the water-
ﬁlling algorithm to distribute the available power.
A very simple way of allocating the power is to set , = LI, where L = 1/W.
One problem with channel inversion arises when H is ill-conditioned. In
such cases, at least one of the singular values of
is very large, L will
be large, and the SNR at the receivers will be low. It is interesting to note
the similarity between channel inversion and least-squares or “zero-forcing”
(ZF) receive beamforming, which applies a dual of the transformation in
Equation 7.4 to the receive data. Such beamformers are known to cause noise
ampliﬁcation when the channel is nearly rank deﬁcient. On the transmit side,
ZF produces signal attenuation instead. In fact, it has been shown that in
the ideal case where the elements of H are independent complex Gaussian
random variables, the probability density of L has an inﬁnite mean [17]. It
is also shown in [17] and the simulation results section of this chapter that
the capacity of channel inversion does not grow linearly with K.
7.3.1.2
Regularized Channel Inversion
When rank-deﬁcient channels are encountered in ZF receive beamforming,
one technique to reduce the effects of noise ampliﬁcation is to regularize the
inverse in the ZF ﬁlter. If the noise is spatially white and an appropriate
regularization value is chosen, this approach is equivalent to using a mini-
mum mean-squared error (MMSE) criterion to design the beamformer
weights. Applying this principle to the transmit side suggests the following
solution:
(7.5)
where _ is the regularization parameter. When _ | 0, the transmitter does
not perfectly cancel out all interference. The key is to deﬁne a value for _
that optimally trades off the numerical condition of the matrix inverse
against the amount of interference that is produced. It has been shown that
choosing _ = K/W approximately maximizes the SINR at each receiver, and
leads to linear capacity growth with K [17]. Because each user sees some
interference from other users, this scheme does not allow the same ﬂexibility
as exact channel inversion in adjusting the power transmitted to each user,
because a change to the power weighting for one user changes the interfer-
ence seen by all other users.
7.3.1.3
Optimal Linear Precoders
Regularized channel inversion demonstrates that perfectly canceling out all
inter-user interference is not optimal, and provides a good solution in closed
(
)
HH 1
s
H HH
I
d
=
+
(
)



1
1
L
_
,

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
185
form at low computational cost. However, it is still not necessarily the optimal
linear beamformer. Attempting to design a set of transmit beamformers with-
out any constraints on inter-user interference is a very challenging problem
because they are all interdependent. If an optimal beamformer is designed
for one user, it will produce some interference for the other users. If the
interference is taken into account in designing an optimal beamformer for a
second user, it will emit interference that makes the ﬁrst user’s beamformer
suboptimal. This suggests that the optimal solution can not be computed in
closed form but requires an iterative approach.
With a zero-forcing solution, a set of independent channels is created, so
the power transmitted to each user can readily be adjusted to achieve a
variety of different goals, such as maximizing sum capacity or insuring equal
capacity for all users given a power constraint, or minimizing power given
a capacity constraint for each user. In the case where inter-user interference
is allowed, the solution to each of these problems will be different. Optimal
transmit beamformers have been found for a variety of different optimization
criteria [18–23]. We give as an example the linear precoder that optimizes
sum capacity [18], which takes the form
(7.6)
This is similar to regularized channel inversion, but we have introduced
two diagonal matrices, D and ), which are used respectively to weight the
rows of H inside the inverse and weight the columns of the resulting beam-
former. The optimal values for these matrices, and the scale constant _, can
be computed using the iterative algorithm given in Table 7.1.
The sum capacity as a function of the channel matrix size for the linear
precoders we have discussed so far is compared with the sum capacity of
the channel and capacity of an equivalent single-user channel in Figure 7.4.
TABLE 7.1
Linear Precoding for Maximum Sum Capacity
1. Initialize Wj(1) = 1 for j = 1…K, D = I, ) = I
2. Repeat until convergence
a.
b.
c.
d.
e.
f.
s
H DH
I
H
d
=
+
) .



©
«
ªª
¹
»
ºº
1
_ nT
M
H DH
D
I H
=
+
(
)
)


tr(
)/W
W
HM
M M
=

W/tr(
)
nj
j j
=
,
[
]
W
2
dj
i
i j
K
i j
=
+
= , |
,
¨
1
1
2
[
]
W
[
]
(
)
D j j
j
j
j
j
n
d d
n
, =
+
[ ]
[
]
)
=
,
,
j j
j j
jd
W
/

186
MIMO System Technology for Wireless Communications
Of all the precoders, only channel inversion fails to achieve a sum capacity
that increases linearly with K and nT. Regularized channel inversion offers
a substantial improvement in performance, and the optimal linear precoder
(labeled capacity-optimal RCI) is even better, achieving most of the sum-
capacity of the channel that is achievable using DPC.
As we noted earlier, there are many situations in which optimizing sum
capacity is problematic because it does not guarantee a minimum level of
signal to any user. There are many other optimizations that have appeared
recently in the literature that may be of greater practical interest. The “power
control” problem was the ﬁrst of these [19,20], and can be stated as follows:
given a set of SINR requirements for each user, compute the set of beam-
formers b1, …, bk such that the SINR requirements are met and total trans-
mitted power is minimized. We deﬁne Lj as the SINR for user j, which can
be expressed as:
(7.7)
where we have assumed that the noise has unit variance. The power mini-
mization problem can be stated mathematically as
(7.8)
FIGURE 7.4
Mean sum-capacity of various precoders for uncorrelated Gaussian channels with K users and
nT = K transmitters at a SNR of 10 dB.
0 
5 
10 
15 
20 
25 
30 
10 
9 
8 
7 
6 
5 
4 
3 
2 
Capacity(bits/usr) 
K 
Channel inversion 
Regularized channel inversion 
Capacity-optimal RCI 
Sum capacity 
Single user 
L j
j
j
j
j
k j
k
j
j
k
=
+


|


¨
b H H b
b H H b
1
,
min
b
b
b b
1
1
,
,
=

¨
. .

K k
K
k
k
s t
b H H b
b H H b
j
j
j
j
k j
k
j
j
k
j
j
K


|


¨
+
v
=
,
.
1
1
L ,
, 

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
187
Solutions to this problem have been proposed in [19–21]. Other optimizations
for which solutions have recently been proposed include the maximization of
the SINR margin for all users given a minimum SINR requirement for each
user and a total power constraint [22,23]. In addition to the sum-capacity solu-
tion, [18] also proposes a solution for maximizing the minimum capacity for
each of the individual users. This whole class of solutions requires more
computation than plain or regularized inversion, but since beamformers are
typically computed once for an entire block of transmitted symbols, this is
still a practical solution.
7.3.2
Linear Processing, Multi-Antenna Receivers
With only a single antenna, the receivers are not able to perform spatial
interference suppression of their own, so they can only receive data over a
single spatial channel. With multiple antennas, these restrictions are
removed, provided that the transmitter and receiver can coordinate their
spatial processing, and appropriately allocate the available spatial resources.
A simple approach to this would be to apply the single-antenna techniques
just described, provided that nR f nT, where nR is the total number of receive
antennas summed over all users. This effectively treats each receive antenna
as if it were a separate user, so no joint processing among the receive antennas
is required, but performance is limited because the problem is overly con-
strained, and the number of users is limited more than necessary.
Both channel inversion and regularized channel inversion limit the num-
ber of users to K f nT. For optimal beamforming, it is technically possible to
support cases where K > nT, but realistically this can occur only when the SINR
requirements are very low. So, it is reasonable to consider nT to be the
practical upper bound on the number of users. If the receivers have multiple
antennas, it is still possible to support up to K = nT users by using the concept
of coordinated beamforming. To illustrate this, consider the block diagram
of Figure 7.2. Assume that the decoding function
for user j is a linear
operator wj, so that ˆdj =
. If the beamformers were known to the trans-
mitter in advance, then the virtual channel, which represents the transfer
function from the transmitter to the output of the beamformer of user j, is
If we collect the virtual channels for each user, we can deﬁne a virtual
channel for the entire system:
As long as K f nT, it possible to apply any of the single-antenna algorithms
described earlier to the virtual channel
. The remaining problem is deter-
mining the receive beamformers wj. This information could be obtained if
f y
d
j
(
)
w y
j
j

h
w H
j
j
j


=
.
H= h
h
…
h
1
2
K
*
¬®
¼¾
H

188
MIMO System Technology for Wireless Communications
the transmitter were to assume a speciﬁc approach to designing the beam-
formers. For example, both MMSE and MRC designs for wj are functions of
only the channel and the transmit beamformers, so wj could be computed
from information available to the transmitter. However, this results in a
situation where the solutions to the transmit and receive beamformers are
dependent on each other. This suggests the following iterative approach:
1. Assume an initial set of wj values.
2. Compute the virtual channel
and the transmit beamformers.
3. Update the receive beamformers wj.
4. Repeat steps 2 and 3 until convergence.
The convergence properties of this approach will depend, in general, on
what algorithms are used on both the transmitter and receiver side to determine
the beamforming weights. The concept of beamforming that is coordinated
between the transmitter and receiver is the basis for several recent multi-
user transmission schemes [1,24–29].
In single-user MIMO channels with CSI available to the transmitter, capacity
is achieved by spatial multiplexing, where a number of independent sub-
channels are created that carry independent streams of data. In a multi-user
MIMO downlink where the receivers have multiple antennas, it is also pos-
sible to transmit multiple data streams to each user. We deﬁne mj to be the
number of sub-channels allocated to user j, and
to be the total number of sub-channels. The restrictions on these values are
that mj f
~Lj, where
~Lj is the rank of
 and m f nT.
This means that allocating multiple sub-channels to individual users limits
the total number of users that can be served. The problem of choosing a
good value of mj has not yet been studied extensively, but the simulation
results presented later in this chapter illustrate the trade-offs involved. In
the case where mj > 1, deﬁne the receiver for user j as the mj × nRj matrix Wj,
and the linear precoder as the nT × m matrix,
where Bj is the nT × mj precoder for user j. As in the single sub-channel case,
the transmit precoders Bj can be derived by selecting an initial set of receivers
Wj, and alternately updating Bj and Wj until convergence is reached.
In this section, we discuss two general approaches to this problem. The
ﬁrst is a coordinated zero-forcing approach that is a generalization of channel
H
m
m
j
K
j
=
=
¨
1

…
…
H
H
H
H
H
j
T
j
T
j
T
k
T
T
= ¬®
¼¾

+
1
1
1
,
B = ¬®
¼¾
B
B
B
1
2
…
k ,

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
189
inversion. The second is a framework for applying other methods like reg-
ularized channel inversion or optimal beamforming in a context where users
have multiple antennas.
7.3.2.1
Coordinated Zero-Forcing
As noted previously, in cases where the receivers have multiple antennas, it
is possible to use channel inversion at the transmitter if nr f nT, but this over-
constrains the problem, by forcing HB to be completely diagonal. In fact, all
inter-user interference can be eliminated by constraining HB to be block-
diagonal (i.e., HiBj = 0, for i | j). A procedure for computing the optimal B
given this constraint has been proposed [24,30–34], but it imposes restrictions
on the channel conﬁgurations that can be accommodated. In order to accom-
modate all possible receiver sizes, those restrictions can be eliminated using
the coordinated beamforming approach: estimate the receivers Wj and force
to be zero. A method for computing this iteratively, referred to as
the “coordinated zero-forcing” algorithm, is listed in Table 7.2.
TABLE 7.2
Coordinated Zero-Forcing Algorithm
1. For each user, initialize Wj as the mj dominant left singular vectors of Hj, and deﬁne Hj
–
= 
Wj*Hj.
2. For each user, deﬁne
let
represent an orthogonal basis for the right null space of
and compute the SVD
where
and
represent the ﬁrst mj left and right singular vectors. Update the 
transmitter and receiver beamformers:
and
and deﬁne
3. Repeat step 2 until
for some value of J.
4. Use water-ﬁlling to determine power allocation given the diagonal values of the 8j 
matrices as the channel gains.
W H B
i
i
j

H
H
H
H
H
j
T
T
j
T
j
T
K
T
=
…
…
¬®
¼¾

+
1
1
1
,
Vj
( )
0
Hj,
H V
U
U
V
V
j
j
j
j
j
H
j
j
( )
( )
( )
( )
( )
0
1
0
1
0

=
¬
®­
¼
¾½
¬
®­
¼
¾
8
½ ,
Uj
( )
1
Vj
( )
1
W
U
j
j
=
( )
1
B
V
j
j
=
( ),
1
S
W H
W H
B
B
=


¬
®
­
­
­
­
­
­
­
¼
¾
½
½
½
½
½
½
½
¬
®­
¼
¾½
1
1
1

K
K
K .
min
[ ]
[ ]
i
K
i i
j i
i j
= ,,
,
|
,
¨
<
1
S
S
J

190
MIMO System Technology for Wireless Communications
The result of the coordinated zero-forcing algorithm is a set of non-inter-
fering virtual channels. One advantage of this approach is that, since the
channels do not interfere, the solution is independent of the power allocation
to each channel, and therefore the power allocation can be performed inde-
pendently from the computation of the beamformers.
There are a few special cases of the coordinated zero-forcing algorithm
worth noting. First, if nRj = 1 for all users, the solution is equivalent to channel
inversion with optimal power allocation. Second, if nT > max{rank(H1,
~
…,
rank(HK)},
~
the convergence criterion is reached at the ﬁrst step, and the solution
is equivalent to the block-diagonalization solution of [24]. Third, if mj = 1 for
all users, the receiver beamformers Wj are equivalent to maximal ratio combin-
ers, and the solution for B is equivalent to channel inversion of H– (this allows
for some computational savings over the generalized implementation).
7.3.2.2
General Coordinated Beamforming
As noted in the discussion of channel inversion, the use of zero-forcing at
the transmitter has some disadvantages, so there are good reasons to use
other beamforming methods at the transmitter. This can be done in channels
where the receivers have multiple antennas by applying the same general
approach as in coordinated zero-forcing. A general algorithm for doing this
is listed in Table 7.3.
There are two reasons that computing the zero-forcing solution makes a good
initialization point for the algorithm in step 1. The ﬁrst is that as SNR increases,
the difference between the zero-forcing solution and other beamforming algo-
rithms will become increasingly small, so starting with the zero-forcing
solution can signiﬁcantly reduce the number of iterations to convergence
[29]. The second reason is that zero-forcing is the only way the beamforming
weights and power allocation can be decided independently, so initializing
with zero-forcing is a means of intelligently estimating how many bits should
be allocated to each sub-channel before proceeding with beamformer opti-
mization. In [29] this approach was used with MMSE receivers and optimal
beamforming for minimum power at the transmitter.
TABLE 7.3
Coordinated Transmitter/Receiver Beamforming Algorithm
1. Assume an initial set of receiver weights W1, …, WK. Two good candidates for this are 
to use the dominant left singular vectors of the respective channel matrices Hj, or to 
compute the full coordinated zero-forcing solution and use the resulting values of Wj.
2. Given W1, …, WK, calculate –H and ﬁnd B using any of the algorithms discussed earlier 
(regularized channel inversion, optimal beamforming).
3. Given B, recalculate the receiver beamformers W1, …, WK according to some assumed 
receiver design (MMSE, MRC, etc).
4. If the SNR or sum rate achieved by B and wj has changed from the last iteration, go to 
step 2; otherwise, stop.

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
191
7.3.3
Non-Linear Processing Methods
All of the transmission schemes discussed so far use linear processing at the
transmitter and receiver. However, as noted previously, channel capacity in
a multi-user environment depends on the use of DPC techniques, which are
inherently non-linear in nature. DPC techniques have been demonstrated to
outperform linear methods [13], but implementation is more expensive.
Some efﬁcient DPC precoders have computational complexity similar to that
of linear precoders, but the computation must be performed separately for
each transmitted symbol, while linear precoders can be computed once for an
entire block of transmitted symbols.
Another limitation of DPC it that none yet exists that is designed for
multiple-antenna receivers. However, there are straightforward ways of
combining DPC with linear processing methods to make them usable for
multi-antenna receivers. One simple example is using coordinated zero-
forcing to compute a set of transmit and receive vectors that allow one sub-
channel per user (mj = 1). After this is computed, the linear beamformers
could be replaced by a DPC encoder that uses the channel matrix
.
It is reasonable to assume that in a real multi-user environment it will be
common to have a mixture of users with single and multiple antennas. In
this type of environment, one proposal for obtaining the beneﬁts of non-
linear precoding is to use block-diagonalization for the users with multiple
antennas and non-linear DPC methods for the users with only one antenna
[35]. In this approach, the beamformers for the multiple-antenna users are
chosen to lie in the null space of the channel matrices of the other users
including those with single antennas. The equivalent channel for the single-
antenna users looks as if there are no multiple-antenna users present, which
improves diversity for those users. The data transmitted to the multiple-
antenna users are also precoded using a linear precoder in order to eliminate
the multi-user interference, which in this case only originates from the single-
antenna users. This approach signiﬁcantly improves the performance of the
single-antenna users and, hence, also that of the overall system.
7.4
Channel Measurements
In the results that follow, we examine the performance of linear precoding
schemes in realistic environments using channel measurements from both
indoor and outdoor propagation environments. The measurements were
taken from a narrowband channel sounding system designed and built at
Brigham Young University (BYU). The transmitter of the system modulates
the chosen carrier frequency using BPSK modulation with a unique pseudo-
random binary sequence for each of the antennas in the transmit array. In
the receiver, the signals from each of the elements of the receive array are
H

192
MIMO System Technology for Wireless Communications
down-converted to an intermediate frequency and sampled using a high
frequency, multi-channel, analog-to-digital converter. The sampled signals
are stored and processed off-line to extract the complex gain from each of
the transmit antennas to each of the receive antennas. The frequency with
which the channel can be sampled is a function of the length of binary
sequence used for modulation. For a more detailed description of the channel
sounder and the post-processing, see [36].
All of the results included here were collected at a carrier frequency of
2.43 GHz, with a bandwidth of 25 KHz. This frequency is used by some of
the popular wireless LAN standards and is close to the 1.9 GHz frequency
used in some mobile telephone networks. In the measurement results pre-
sented here, the transmitter was kept at a ﬁxed location and the receiver
moved while sampling the channel every 2.5 ms. Multi-user channels are
created by selecting samples from multiple points along the measurement
path. Because the average number of samples per wavelength is as high as
30 for most of the cases considered here, relatively small separations between
users can be simulated.
The measurements used here come from three different sets. The ﬁrst is a
set of indoor measurements taken inside a typical university building.* The
measurements were taken with the transmitter in a ﬁxed location and the
receiver moving in a straight path with an approximate length of about
40 meters along a long corridor at constant speed. The measurement path is
illustrated in Figure 7.5. All channels were non-line-of-sight (NLOS), which
would typically lead to reduced power but enhanced multipath diversity
relative to line-of-sight (LOS) channels. Both the transmitter and receiver
used 10 monopole antennas arranged in a circular pattern with a radius of
0.86 wavelengths, equivalent to a spacing of approximately 0.5 wavelengths
between adjacent elements.
* The building was the Clyde Engineering Building on the BYU campus, which has steel-rein-
forced concrete structural walls and cinder-block partition walls.
FIGURE 7.5
Illustration of the measurement path and part of the building used for the indoor channel
measurements.
Transmitter 
Receiver 

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
193
Two outdoor data sets are also considered here. The ﬁrst, referred to as
outdoor channel A, placed the transmitter between two buildings on the
BYU campus, and the receiver behind a neighboring building, creating a
NLOS channel similar to that often seen in urban environments. These meas-
urements were collected with 8-element uniform linear arrays of monopole
antennas at both transmitter and receiver, with a spacing of 0.3 wavelengths.
The receiver was placed at three different locations and moved along a
straight path with a length of about 10 meters. The measurement paths and
neighboring buildings for outdoor channel A are illustrated in Figure 7.6.
The results in the next section derived from these measurements are aver-
aged over the three different locations.
The second outdoor environment, referred to in the next section as outdoor
channel B, contained mostly LOS channels. The transmitter was placed in
two locations a few meters from the wall of a building. The receiver was
placed at four different locations near the same building, and moved dis-
tances of 10–12 meters. These measurements were collected using uniform
linear arrays of seven antennas at both transmitter and receiver with a
spacing of 0.39 wavelengths. The building and the measurement paths for
this channel are illustrated in Figure 7.7. The composite results for outdoor
channel B also are averaged over the four measurement locations.
Most of the test cases considered scenarios with fewer antennas than the
original data set. Appropriate antenna subsets were selected as follows. On the
transmit side, antennas with maximal separation were chosen to mimic a base
station that uses the entire array aperture. For example, the 4-element trans-
mitter that is used in many of the results is taken from the 7-element linear
array by choosing 4 elements with uniform separation of 0.78 wavelengths.
A mobile receiver, on the other hand, would be expected to have limited
FIGURE 7.6
Illustration of the measurement paths and neighboring buildings for outdoor channel A. These
channels are almost all non-line-of-sight (NLOS).
Location 1 
Receiver 
Location 2 
Location 3 
Transmitter 
10 m 

194
MIMO System Technology for Wireless Communications
size, and thus only adjacent antennas were used when simulating end users
with multiple antennas.
An important issue that arises in MIMO channel data sets is how the
various channels are normalized prior to processing. There are two common
approaches. One approach is to scale each individual channel sample to have
the same received power (measured using the Frobenius norm). This
approach ignores power ﬂuctuations due to multipath fading or shadowing
and does not allow channels with “near-far” effects, but it allows for more
consistent comparisons with simulated propagation environments and
makes the results less dependent on the speciﬁc physical environment. This
type of normalization was used in all of the results measuring capacity of
various precoding algorithms. A second approach is to preserve the power
relationships, normalizing so that the average Frobenius norm has a ﬁxed
value. This approach can be subject to large power ﬂuctuations. We used this
type of global channel normalization when measuring the effects of channel
estimation error.
7.5
Performance Results
In this section, we compare the performance of some of the various downlink
multiplexing schemes we have described. We begin with results derived
from simulation of random channels, and then show how the algorithms
perform with measurement data. We focus in particular on three processing
schemes whose capacity can be computed easily. Note that capacity here
refers to the maximum achievable rate for the given transmission scheme,
which is different from the true channel capacity. The ﬁrst is coordinated
zero-forcing, referred to in many of the plots as zero-forcing or ZF. The
FIGURE 7.7
Illustration of the measurement paths and neighboring building for outdoor channel B. These
channels are almost all line-of-sight (LOS).
Transmitter 
Location 1–3 
Receiver 
Location 1, 4 
Location 2, 3 
Receiver 
Transmitter 
Location 4 
20 m 

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
195
second is coordinated beamforming using regularized channel inversion on
the transmit side and MMSE beamformers at the receivers when multiple
antennas are present. This is labeled in many of the plots as regularized
channel inversion or RCI. The third scheme is coordinated beamforming
using MMSE receivers and the iterative RCI algorithm for achieving maximum
capacity given in Table 7.1, referred to in the plots as capacity-optimal RCI.
7.5.1
Multi-User Performance in Randomly Generated Channels
We begin by illustrating the performance of different multiplexing methods
in uncorrelated Gaussian channels, which is usually the best-case scenario.
Figure 7.8 shows complementary cumulative density functions (CCDF) of
sum capacity for coordinated zero-forcing, coordinated beamforming using
regularized channel inversion at the transmitter and MMSE receivers, and
coordinated beamforming using capacity-optimal RCI at the transmitter with
MMSE receivers. Note that for mj = 1, and in about 40% of cases where mj = 2,
zero-forcing has slightly better performance than RCI. The reason for this is
that with the ZF solution the power for each user was adjusted to maximize
sum capacity, while this is not possible with RCI without using the iterative
algorithm. The capacity is quite similar for all algorithms for mj = 1, but for
mj = 2, it is clear that the capacity-optimal RCI method makes far better use
of the second spatial sub-channel than either of the others. In some cases, as
will be seen with the data-derived results, adding the second sub-channel
does not provide any additional beneﬁt because of the channel characteris-
tics. Another reason it may be preferable to use less than all available sub-
channels is that this allows additional degrees of freedom in optimizing the
transmission to other users.
FIGURE 7.8
CCDFs of capacity for zero-forcing and regularized channel inversion in uncorrelated Gaussian
channels at a SNR of 10 dB.
0
0.2
0.4
0.6
0.8
1
10
9
8
7
6
5
11
12
13
Probability capacity > abscissa
Capacity (bits/sec/Hz)
(1,  1) × 4, mj = 1
Zero forcing
RCI
Capacity-optimal RCI
(2, 2) × 4, mj = 2
(2, 2) × 4, mj = 1

196
MIMO System Technology for Wireless Communications
In Figure 7.4 (see also [17,37]) is a comparison of capacity for channel inver-
sion and regularized channel inversion for channels where
revealed
that RCI and capacity-optimal RCI achieve linear growth in capacity as a
function of K, while channel inversion does not. In Figure 7.9, we assume
that nT is ﬁxed at ten antennas, and we compare the sum capacity of channel
inversion and RCI with the theoretical limits as a function of K. In this case,
the theoretical limits increase with the number of users, but the linear pro-
cessing schemes achieve maximum capacity at six users, and channel inver-
sion actually loses a substantial amount of capacity as K q nT. This is due
to the fact that the power scaling in Equation 7.4 is limited by singular values
of
, which, for random complex Gaussian matrices, are not well
conditioned when H is square [17].
Figure 7.10 compares the same three linear precoders in the context of
multi-antenna receivers, with the number of data streams per user mj ﬁxed
at 1. While there is a sizable gap between zero-forcing and the RCI regular-
ized channel inversion when the receivers have only one antenna, the dif-
ference becomes much smaller as a function of the number of receive
antennas, to the point that it becomes almost negligible for nRj = 3.
In multi-user MIMO channels, optimal transmission schemes depend
heavily on the availability of CSI at the transmitter. In practice, CSI will likely
be corrupted by noise. Figure 7.11 shows the effects of channel estimation
error on performance. In this case, the error is modeled as an additive error
matrix N such that the estimated channel
. The error is quantiﬁed
by the ratio of the total power in H to the total power in N:
. It is
apparent from the curves in Figure 7.11 that receivers with additional anten-
nas reach their maximum capacity with more error in their channel estimates
than those with only one antenna. With one antenna per user, not only do
FIGURE 7.9
Comparison of capacity for channel inversion and regularized channel inversion with the sum
capacity of the channel and capacity of the equivalent single-user channel for K users and nT =
10 at a SNR of 10 dB.
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
10 
9 
8 
7 
6 
5 
4 
3 
2 
Capacity(bits/usr) 
K 
Channel inversion 
Regularized channel inversion 
Optimal RCI 
Sum capacity 
Single user capacity 
K
nT
=
(
)
HH 1
ˆH
H
N
=
+
H
N
F
F
2
2
/

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
197
the RCI precoders signiﬁcantly outperform zero-forcing, they are much more
robust in the presence of channel estimation error.
7.5.2
Multi-User Performance in Channels Derived from Measurements
While uncorrelated Gaussian channels are useful as an analysis tool, this
assumption is a best-case scenario, and it is important to also consider the
speciﬁc channel conditions in which these algorithms are likely to be used.
For example, if two users are located close together, their channels will likely
be highly correlated, which will affect the transmitter’s ability to achieve
signal separation with precoding. An important question then is what phys-
ical spacing is required to achieve the capacity levels of uncorrelated users.
FIGURE 7.10
Capacity comparison of coordinated zero-forcing and regularized channel inversion for mj = 1
and varying values of nRj for K users at a SNR of 10 dB.
FIGURE 7.11
Capacity comparison as a function of channel estimation error.
0 
5 
10 
15 
20 
25 
30 
35 
2 
3 
4 
5 
6 
7 
8 
9 
10
Capacity(bits/sec/Hz) 
K 
nRj = 1 
nRj = 3 
Zero forcing 
Regularized channel inversion 
Capacity-optimal RCI 
nRj = 2 
0 
2 
4 
6 
8 
10 
12 
14 
16 
10 
8 
6 
4 
2 
0 
12 
14 
16 
Capacity(bits/sec/Hz) 
Channel estimation error(dB) 
nRj = 1 
nRj = 2 
nRj = 3 
Zero forcing 
Regularized channel inversion 
Capacity-optimal RCI 

198
MIMO System Technology for Wireless Communications
For indoor environments, this problem was recently studied using both
channel measurements and statistical models [38,39]. In this section, we
compare performance derived from the indoor measurements with outdoor
measurements and random Gaussian channels. The transmission scheme in
all cases is coordinated beamforming with MMSE receivers and capacity-
optimal RCI at the transmitter, so the capacity referred to here is the maximum
achievable throughput given linear precoding and decoding. We consider
three important questions. First, we test how closely two users can be located
in space before a signiﬁcant reduction in spatial multiplexing performance
is observed. Second, we test channels with many users to see how much
multipath is present in the channel and how many users can be supported,
and third, we test how far a receiver terminal can move before updated CSI
is required.
7.5.2.1
Effects of Inter-User Separation
We begin by examining the performance of two-user channels. Figure 7.12
shows the capacity as a function of separation distance for coordinated beam-
forming using regularized channel inversion for indoor channels. The cases
shown are for nRj = 1, and nRj = 2 with mj = 1 and 2. As a reference, the mean
capacity was computed for uncorrelated Gaussian channels and for meas-
ured channels where the users’ locations were chosen randomly from any-
where in the data set, and those values are shown along the left and right
sides of the plot, respectively. While random spacing allows slightly higher
capacity than ﬁxed spacing, capacity for ﬁxed spacing in all three cases
appears to reach its maximum at a separation of 5 wavelengths. For the
FIGURE 7.12
Mean system capacity as a function of separation distance for a two-user MIMO channel derived
from indoor measurement data. Markers on the right side are capacity for random separation,
and along the left side are for uncorrelated Gaussian channels.
6 
7 
8 
9 
10 
11 
10 
8 
6 
4 
2 
0 
Capacity(bits/sec/Hz) 
Separation(wavelengths) 
nRj = 1, mj = 1 
nRj = 2, mj = 1 
nRj = 2, mj = 2 

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
199
2.43 GHz channel we are considering, this is equivalent to about 60 cm. For
both cases where mj = 1, the capacity from measured data is very close to
that of uncorrelated Gaussian channels, but there is a gap for mj = 2. This is
an indication that there is likely a greater spread in the singular values of
the channel matrices for the measured data than for simulated random
channels. Causes of this include correlation between antenna elements and
a dominant path in the multipath environment.
Figure 7.13 shows the mean capacity as a function of user separation for
the two outdoor channels. Outdoor channel A, which is almost entirely
NLOS with multiple buildings in the vicinity, achieves higher overall capac-
ity and the maximum capacity appears to be reached at 5 wavelengths, as
in the indoor case. Channel B, on the other hand, which consists of LOS
channels, requires about 10 wavelengths to reach maximum capacity and
has lower overall capacity. Even a distance of 10 wavelengths is relatively
small, considering it is equivalent to about 1.2 meters at our measurement
frequency. Since the channels have all been normalized, relative attenuation
between the different propagation environments is not considered here. It
is also interesting to note that when nRj = 2, outdoor channel A achieves a
small increase in capacity when mj is increased from 1 to 2 (but a smaller
increase than the indoor environment), but channel B does not. This is an
indicator that channel B has virtually no multipath diversity — the channel
is almost always dominated by a single multipath component — and Chan-
nel A has less multipath diversity than the indoor channel.
In Figure 7.14, we consider the performance of a system with a larger
number of transmit antennas as a function of the number of users sharing
the channel. We compare the performance of uncorrelated Gaussian channels
with locations randomly selected from the data sets as a function of the
number of users for nRj = 1 and 3, with mj = 1. The random Gaussian channel
FIGURE 7.13
Mean system capacity as a function of separation distance for a two-user MIMO channel derived
from outdoor measurement data.
3 
4 
5 
6 
7 
8 
9 
10 
10 
5 
0 
15 
20 
Capacity(bits/sec/Hz) 
Separation(wavelengths) 
nRj = 1, mj = 1 
nRj = 2, mj = 1 
nRj  = 2, mj = 2 
Outdoor A 
Outdoor B 

200
MIMO System Technology for Wireless Communications
outperforms the measured channels by a larger margin for multi-antenna
receivers than for single-antenna receivers. For multi-antenna receivers, the
indoor channel achieves performance close to that of random channels
except for six and seven users. For both outdoor channels, there is signiﬁ-
cantly less capacity than random channels for as few as four users. This
illustrates that regardless of the number of transmitters and users, the system
capacity in real propagation environments may be limited by the multipath
structure. Beyond a certain limit (deﬁned by the multipath diversity of the
channel) the addition of transmit and receive antennas results mainly in
beamforming gain rather than diversity or multiplexing gain.
7.5.2.2
Effects of User Motion
In Figure 7.11, we demonstrated that noise in the CSI does not measurably
degrade performance if the energy in H is greater than the noise in the
channel estimate by about 12 dB. In this section, we assume that the noise
effects are negligible and measure the effects of errors in the CSI due to user
motion. We assume that CSI is made available to the transmitter via a
feedback channel, but the receiver may have moved by the time the trans-
mitter has processed the channel estimate. A similar case was considered in
[40]. In [39], this scenario was studied for a {2,2} × 4 channel with mj = 2 in
an indoor environment. Because we observe better overall performance with
mj = 1, we consider here the case of {1,1} × 4 channels and {2,2} × 4 channels
with errors in CSI.
The sum capacity at 10 dB SNR as a function of separation distance from
CSI measurement to CSI usage is shown for the indoor and both outdoor
channels in Figure 7.15. In the ﬁrst 0.25 wavelengths, the degradation is
FIGURE 7.14
Sum capacity of coordinated beamforming with optimal RCI for multi-user channels with
7 transmit antennas and users placed at random locations.
10 
12 
14 
16 
18 
20 
22 
24 
26 
3 
4 
5 
6 
7 
Capacity(bits/sec/Hz) 
Number of users 
IID channel 
Indoor channel 
Outdoor channel A 
Outdoor channel B 
nRj = 1 
nRj = 3 

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
201
steeper for outdoor channels than for indoor channels, while the rate is similar
for all of the channels from 0.25 to 1 wavelength. The slope of the curves for
larger separations appears to be less steep for nRj = 2. This can be attributed
to the fact that the dominant eigenvector of each user’s channel is closely
related to the angle of strongest propagation path, which will tend to change
more slowly than the individual channel coefﬁcients. This is another advan-
tage of adding additional antennas at the receivers.
In general the effects of CSI error appear to be similar for both the indoor
and outdoor environments studied here. It is possible to compensate for
these errors up to a certain point by adding additional SINR margin to the
design requirements for transmit beamformers. This type of CSI error is a
limited problem in indoor environments because mobility speeds are quite
low. The slightly higher sensitivity to CSI error in outdoor environments
combined with higher speeds imply that CSI will not be useful for long
periods of time, making the problem of obtaining relevant CSI at the trans-
mitter a more signiﬁcant challenge for outdoor channels than indoor.
7.6
Summary
Spatial multiplexing algorithms in multi-user MIMO systems can substan-
tially increase the capacity of a wireless network, assuming that accurate CSI
is available and that the channels for different users are uncorrelated. In this
chapter, we have reviewed some of the available algorithms for the down-
link, and demonstrated the expected performance in both ideal uncorrelated
FIGURE 7.15
Mean capacity as a function of distance between a user’s actual location and the location of the
available channel estimate.
2 
3 
4 
5 
6 
7 
8 
9 
0 
0.2 
0.4 
0.6 
0.8 
1
Capacity(bits/sec/Hz) 
Separation(wavelengths) 
Indoor 
Outdoor A 
Outdoor B 
nRj = 2 
nRj = 1 

202
MIMO System Technology for Wireless Communications
Gaussian channels and channels derived from measurements of both indoor
and outdoor propagation environments. While many of the multiplexing
algorithms proposed so far are designed for the case where each user has
only one antenna, they can be readily adapted to cases where the users have
more than one antenna by using linear processing at the receiver to reduce
the dimension of the channel. The results demonstrate a clear beneﬁt from
adding a second or third antenna to each user and using simple processing
schemes at the receiver, such as MMSE beamforming. When users have more
than one antenna and coordinated beamforming is used, the performance
gaps between transmission approaches such as channel inversion and reg-
ularized channel inversion become much smaller.
In practice, achieving spatial multiplexing requires that users’ channels be
sufﬁciently uncorrelated, which implies a certain minimum separation
between them. For indoor propagation measurements tested here, a spacing
of about 5 wavelengths (approximately 60 cm at the measurement frequency)
appears to be sufﬁcient, regardless of the number of users, while in outdoor
environments with signiﬁcant multipath, a spacing of 5–10 wavelengths
(0.6–1.2 m) is sufﬁcient, depending on the environment.
While in uncorrelated Gaussian channels, system capacity can grow linearly
with the number of transmit antennas and number of users, the multipath
structure encountered in measured channels imposes limits on how many
users can be multiplexed spatially. In the particular indoor environment
measured here, with a base station array of 7 elements, most of the available
capacity is reached at around ﬁve to six users, while the number is three to
four for the outdoor environments that were studied here. This limit is a
function of the number of signiﬁcant multipath components for each user
and the difference in multipath structures for users located near each other.
All of the measurement results were taken over limited paths, so it is possible
that more users can be supported if they are scattered over a wider area.
The use of CSI at the transmitter in multi-user MIMO downlinks appears
to be particularly challenging in outdoor propagation environments because
performance quickly becomes degraded when the channel has changed rel-
ative to the available CSI. Protocols that use spatial multiplexing in outdoor
MIMO downlinks will, therefore, use CSI for very short time horizons.
7.7
Acknowledgments
This work was supported by the U.S. Army Research Ofﬁce under the Multi-
University Research Initiative (MURI) grant W911NF-04-1-0224, by the DARPA
Advanced Technology Ofﬁce, and by San Diego Research Center, Inc.

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
203
References
1. R.L.-U. Choi, M.T. Ivrlaˇc, R.D. Murch, and J.A. Nossek. 2003. “Joint transmit
and receive multi-user MIMO decomposition approach for the downlink of
multi-user MIMO systems,” in Proceedings of the IEEE 58th Vehicular Technology
Conference, Orlando, FL: IEEE, Oct. 6–9, 2003.
2. D.J. Love, R.W. Heath, Jr., W. Santipach, and M.L. Honig. 2004. “What is the
value of limited feedback for MIMO channels?” IEEE Communications Magazine,
Vol. 42, No. 10, Oct. 2004, pp. 54–59.
3. T. Svantesson and A.L. Swindlehurst. 2003. “A performance bound for predic-
tion of a multipath MIMO channel,” in Proc. 37th Asilomar Conference on Signals,
Systems, and Computers, Session: Array Processing for Wireless Communications,
Paciﬁc Grove, CA, November 2003.
4. M. Costa. 1983. “Writing on dirty paper,” IEEE Transactions on Information
Theory, Vol. 29, May 1983, pp. 439–441.
5. G. Caire and S. Shamai. 2003. “On the achievable throughput of a multi-antenna
Gaussian broadcast channel,” IEEE Transactions on Information Theory, Vol. 43,
July 2003, pp. 1691–1706.
6. W. Yu and J. Ciofﬁ. 2002. “Sum capacity of a Gaussian vector broadcast chan-
nel,” in Proceedings IEEE International Symposium on Information Theory, July
2002, p. 498.
7. P. Viswanath and D. Tse. 2003. “Sum capacity of the vector Gaussian broadcast
channel and uplink-downlink duality,” IEEE Transactions on Information Theory,
Vol. 49, No. 8, Aug. 2003, pp. 1912–1921.
8. S. Vishwanath, N. Jindal, and A. Goldsmith. 2003. “Duality, achievable rates
and sum capacity of Gaussian MIMO broadcast channels,” IEEE Transactions
on Information Theory, Vol. 49, No. 10, Aug. 2003, pp. 2658–2668.
9. H. Weingarten, Y. Steinberg, and S. Shamai. 2004. “The capacity region of the
Gaussian MIMO broadcast channel,” in Proceedings Conf. on Information Sciences
and Systems (CISS), Princeton, NJ, March 2004.
10. G. Caire and S. Shamai. 2002. “LDPC coding for interference mitigation at the
transmitter,” in Proc. 40th Annual Allerton Conference on Communication, Control,
and Computing, October 2002.
11. G. Caire and S. Shamai. 2002. “Writing on dirty tape with LDPC codes,” in
Multiantenna Channels: Capacity, Coding and Signal Processing, DIMACS Series
in Discrete Mathematics and Theoretical Computer Science, Vol. 62,
pp. 123–140.
12. T. Philosof, U. Erez, and R. Zamir. 2002. “Precoding for interference cancellation
at low SNR,” in 22nd Convention of IEEE Israel Section, Tel-Aviv University,
December 2002.
13. B.M. Hochwald, C.B. Peel, and A.L. Swindlehurst. 2005. “A vector-perturbation
technique for near-capacity multi-antenna multi-user communication — part II:
perturbation,” IEEE Transactions on Communications, Vol. 53, No. 3, March 2005,
pp. 537–544.
14. J.H. Winters, J. Salz, and R.D. Gitlin. 1994. “The impact of antenna diversity
on the capacity of wireless communication systems,” IEEE Transactions on Com-
munications, Vol. 42, No. 2, Feb./Mar./Apr. 1994, pp. 1740–1751.

204
MIMO System Technology for Wireless Communications
15. D. Gerlach and A. Paulraj, “Adaptive transmitting antenna arrays with feed-
back,” IEEE Signal Processing Letters, Vol. 1, No. 10, October 1994, pp. 150–152.
16. T. Haustein, C. von Helmolt, E. Jorwieck, V. Jungnickel, and V. Pohl. 2002.
“Performance of MIMO systems with channel inversion,” in Proceedings of the
IEEE 55th Vehicular Technology Conference, Vol. 1, Birmingham, AL, May 2002,
pp. 35–39.
17. C.B. Peel, B.M. Hochwald, and A.L. Swindlehurst. 2005. “A vector-perturbation
technique for near-capacity multiantenna multiuser communication-part I:
channel inversion and regularization,” IEEE Transactions on Communications,
Vol. 53, No. 1, January 2005, pp. 195–202.
18. M. Stojnic, H. Vikalo, and B. Hassibi. 2004. “Rate maximization in multi-anten-
na broadcast channels with linear preprocessing,” in Proceedings of IEEE Globe-
com, November 2004, pp. 3957–3961.
19. F. Rashid-Farrokhi, K.R. Liu, and L. Tassiulas. 1998. “Transmit beamforming
and power control for cellular wireless systems,” IEEE Journal on Selected Areas
in Communications, Vol. 16, No. 8, October 1998, pp. 1437–1450.
20. E. Visotsky and U. Madhow. 1999. “Optimum beamforming using transmit
antenna arrays,” in Proceedings of the IEEE Vehicular Technology Conference, Vol. 1.
Houston, TX: IEEE, May 16–20, 1999, pp. 851–856.
21. M. Bengtsson and B. Ottersten. 2001. “Optimal and suboptimal beamforming,”
in Handbook of Antennas in Wireless Communications, L. Godara, ed., Boca Raton,
FL: CRC Press.
22. H. Boche and M. Schubert. 2002. “Multi-antenna downlink transmission with
individual SINR receiver constraints for cellular wireless systems,” in Proceed-
ings of the 4th International ITG Conference on Source and Channel Coding, Infor-
mationstechnische Gesellschaft im VDE (ITG). Berlin: VDE Verlag GmbH,
January 2002, pp. 159–166.
23. M. Schubert and H. Boche. 2004. “Solution of the multiuser downlink beam-
forming problem with individual SINR constraints,” IEEE Transactions on
Vehicular Technology, Vol. 53, No. 1, January 2004, pp. 18–28.
24. Q.H. Spencer, A.L. Swindlehurst, and M. Haardt. 2004. “Zero-forcing methods
for downlink spatial multiplexing in multi-user MIMO channels,” IEEE Trans-
actions on Signal Processing, Vol. 52, No. 2, February 2004.
25. J.-H. Chang, L. Tassiulas, and F. Rashid-Farrokhi. 2002. “Joint transmitter re-
ceiver diversity for efﬁcient space division multiaccess,” IEEE Transactions on
Wireless Communications, Vol. 1, No. 1, January 2002, pp. 16–27.
26. Z. Pan, K.-K. Wong, and T. Ng. 2003. “MIMO antenna system for multi-user
multi-stream orthogonal space division multiplexing,” in Proceedings of the IEEE
International Conference on Communications, Vol. 5, Anchorage, AK: IEEE, May
2003, pp. 3220–3224.
27. K.-K. Wong, R. Murch, and K.B. Letaief. 2003. “A joint-channel diagonalization
for multiuser MIMO antenna systems,” IEEE Transactions on Wireless Commu-
nications, Vol. 2, No. 4, July 2003, pp. 773–786.
28. Q.H. Spencer, A.L. Swindlehurst, and M. Haardt. 2003. “Fast power minimi-
zation with QoS constraints in multi-user MIMO downlinks,” in Proceedings of
the IEEE International Conference on Acoustics, Speech, and Signal Processing, IEEE,
April 2003.

Performance of Multi-User Spatial Multiplexing with Measured Channel Data
205
29. Q.H. Spencer and A.L. Swindlehurst. 2004. “A hybrid approach to spatial
multiplexing in multi-user MIMO downlinks,” EURASIP Journal on Wireless
Communications and Networking, Vol. 2004, No. 2, December 15, 2004, pp.
236–247. Available: http://wcn.hindawi.com/volume-2004/issue-2.html.
30. R.L.-U. Choi and R.D. Murch. 2002. “A downlink decomposition transmit pre-
processing technique for multi-user MIMO systems,” in Proceedings of IST
Mobile & Wireless Telecommunications Summit, June 2002.
31. A. Bourdoux and N. Khaled. 2002. “Joint Tx-Rx optimization for MIMO-SDMA
based on a null-space constraint,” in Proceedings of the IEEE Vehicular Technology
Conference, September 2002, pp. 171–174.
32. Q.H. Spencer and M. Haardt. 2002. “Capacity and downlink transmission
algorithms for a multi-user MIMO channel,” in Conference Record of the 36th
Asilomar Conference on Signals, Systems and Computers. IEEE, November 2002.
33. M. Rim. 2002. “Multi-user downlink beamforming with multiple transmit and
receive antennas,” Electronics Letters, Vol. 38, No. 25, December 5, 2002,
pp. 1725–1726.
34. R. Choi and R. Murch, “A transmit preprocessing technique for multiuser
MIMO systems using a decomposition approach,” IEEE Transactions on Wireless
Communications, Vol. 3, No. 1, January 2004, pp. 20–24.
35. V. Stankovic, M. Haardt, and M. Fuchs. 2004. “Combination of block diagonal-
ization and THP transmit ﬁltering for downlink beamforming in multi-user
MIMO systems,” in Proc. European Conference on Wireless Technology (ECWT
2004), Amsterdam, the Netherlands, Oct. 2004, pp. 145–148.
36. J.W. Wallace, M.A. Jensen, A.L. Swindlehurst, and B.D. Jeffs. 2003. “Experimen-
tal characterization of the MIMO wireless channel: data acquisition and anal-
ysis,” IEEE Transactions on Wireless Communications, Vol. 2, No. 2, March 2003,
pp. 335–343.
37. Q.H. Spencer, C.B. Peel, A.L. Swindlehurst, and M. Haardt. 2004. “An intro-
duction to the multi-user MIMO downlink,” IEEE Communications Magazine,
Vol. 42, No. 10, October 2004, pp. 60–67.
38. Q. Spencer and T. Svantesson. 2003. “MIMO downlink spatial multiplexing
algorithms applied to channel measurements,” in Proceedings of the IEEE 58th
Vehicular Technology Conference, Orlando, FL: IEEE, October 6–9 2003.
39. Q.H. Spencer, T. Svantesson, and A.L. Swindlehurst. 2004. “Performance of
MIMO spatial multiplexing algorithms using indoor channel measurements
and models,” Wireless Communications and Mobile Computing, Vol. 4, No. 7,
November 2004, pp. 739–754, 
40. P. Zetterberg, M. Bengtsson, D. McNamara, P. Karlsson, and M.A. Beach. 2002.
“Performance of multiple-receive multiple-transmit beamforming in WLAN-
type systems under power or EIRP constraints with delayed channel esti-
mates,” in Proceedings of the 55th Vehicular Technology Conference, Vol. 4, IEEE,
pp. 1906–1910.


207
8
Multiuser MIMO for UTRA FDD
Jyri Hämäläinen, Risto Wichman, Markku Kuusela, Esa Tiirola, 
and Kari Pajukoski
CONTENTS
Abstract.................................................................................................................208
8.1
Introduction ................................................................................................208
8.2
UTRA Framework .....................................................................................210
8.2.1
UTRA FDD Downlink.................................................................. 211
8.2.1.1
High-Speed Downlink Packet Access .........................212
8.2.2
UTRA FDD Uplink .......................................................................214
8.3
Current Multiantenna Methods in UTRA FDD....................................214
8.3.1
Beamforming..................................................................................215
8.3.2
Transmit Diversity.........................................................................216
8.4
MIMO in UTRA FDD Uplink..................................................................217
8.4.1
MIMO Algorithms ........................................................................218
8.4.1.1
Diversity MIMO..............................................................218
8.4.1.2
Information MIMO.........................................................219
8.4.1.3
Advanced Receiver Techniques....................................220
8.4.2
Uplink Load Equations ................................................................221
8.4.2.1
Basic Load Equations.....................................................221
8.4.2.2
Load Equations for MIMO............................................223
8.4.3
Performance Comparisons...........................................................225
8.5
MIMO in UTRA FDD Downlink ............................................................229
8.5.1
Theoretical Background ...............................................................230
8.5.1.1
Single-User MIMO..........................................................230
8.5.1.2
Multiuser MIMO.............................................................233
8.5.2
Proposed MIMO Algorithms within 3GPP Standardization ...234
8.5.3
Practical Considerations...............................................................237
8.5.4
Multiuser Beamforming...............................................................239
8.6
Conclusions and Discussion ....................................................................244
References.............................................................................................................245

208
MIMO System Technology for Wireless Communications
Abstract
Link capacity of cellular networks has become an issue with forecasted
growing public demand for high data rate services. Recently, multiple-input
multiple-output (MIMO) antenna techniques have been received enthusias-
tically within wireless communications due to their potential to increase link
capacities in a spectrally efﬁcient manner. Despite their great theoretical
promise, the introduction of MIMO transceivers to commercial wireless com-
munication systems faces several challenges.
In this chapter, we introduce recent developments of MIMO techniques
within a third generation cellular system known as universal terrestrial radio
access (UTRA), which is standardized by the third generation partnership
project (3GPP). Rather than discussing general MIMO algorithms, we will
concentrate on MIMO techniques that can be implemented without major
revisions to the current UTRA air interface, wideband code division multiple
access (WCDMA). The ﬁrst full speciﬁcation of WCDMA was already com-
pleted at the end of 1999, and backward compatibility to the legacy system
is one of the most important design issues when considering future enhance-
ments to WCDMA. Thus, small modiﬁcations to air interface can be accepted
more easily in standardization than schemes that would require large rede-
sign efforts. We will concentrate on UTRA frequency division duplex (FDD)
mode, because it is a more widely deployed system than UTRA time division
duplex mode.
8.1
Introduction
Multiple-input multiple-output (MIMO) transceivers have great potential to
improve the performance of wireless systems. Compared to wireline systems,
the inferior capacity of wireless cellular systems is caused by several different
physical constraints like co-channel and adjacent channel interference, chan-
nel propagation loss, and ﬂat or multipath fading channels. Multiantenna
transmission and reception techniques are currently regarded as one of the
most promising approaches for signiﬁcantly increasing the coverage, capac-
ity, and spectral efﬁciency of wireless systems.
The multiple degrees of freedom offered by multiple transmit and receive
antennas can be used for diversity or for spatial multiplexing. In the former
case, a single data stream is transmitted and multiple antennas are used to
decrease the variance of the received signal and thereby improve the quality
of the radio link. In the latter case, multiple transceiver antennas are used
for parallel multiplexing, i.e., to transmit several data streams simultaneously

Multiuser MIMO for UTRA FDD
209
to a user to increase peak data rates. In this study, these two approaches will
be referred to as diversity MIMO and information MIMO, respectively.
In terms of channel capacity, information MIMO is a much more impres-
sive concept than diversity MIMO. With parallel multiplexing, the capacity
increases linearly with the number of transmit and receive antennas [1,2]
when the number of transmit antennas equals the number of receive anten-
nas and when the channels between the antennas are independent and
identically distributed. This observation has stimulated great interest in
MIMO transceivers, and in addition to academic research, MIMO is actively
being studied in standardization for different wireless systems, such as
UTRA, IEEE 802.11n and IEEE 802.16e.
Multiple antenna transceivers promise high spectral efﬁciencies to wireless
systems, and spectral efﬁciencies as large as 20 to 40 bps/Hz have been
reported in laboratory environments [3]. This would present a signiﬁcant
improvement to current cellular systems that typically operate with 0.05 to
2 bps/Hz range. However, the introduction of MIMO to commercial systems
still faces several challenges, especially when a system has not been designed
for MIMO from the beginning. For example, channel estimation in GSM
relies on seven different midamble sequences that have been carefully
selected to possess optimal autocorrelation properties. If one base station
(BS) uses multiple midamble sequences, the seven sequences quickly run
out, because frequency reuse limits the usage of the same sequences in
nearby base stations. Furthermore, cross-correlation properties of the GSM
training sequences are poor, making their use in the same base station sub-
optimal. Thus, the introduction of coherent information MIMO techniques
would require the redesign of the entire GSM channel estimation scheme.
At the same time hundreds of millions of legacy GSM handsets should be
compatible with the redesigned system. In principle, differential modulation
or blind detection and estimation could be applied to relax the requirement
of multiple training sequences in the case of MIMO. However, blind algo-
rithms are not considered viable in commercial cellular systems due to their
complexity of implementation. Differential modulation suffers from 3 dB
SNR penalty when compared to coherent signaling, and the use of differen-
tial modulation and increased power levels would increase the interference
in wireless networks.
The ﬁrst release of universal terrestrial radio access (UTRA) frequency
division duplex (FDD) air interface, referred to as wideband code division
multiple access (WCDMA), was completed in 1999 by the third generation
partnership project (3GPP). At that time, research on information MIMO
techniques was in the initial stage, but the release already speciﬁed two-
antenna open-loop and closed-loop transmit diversity modes that are part
of the most recent Release 6 [4] as well. Still, the introduction of more
advanced MIMO techniques to WCDMA has not been straightforward. A
great deal of standardization effort has been dedicated to extend the speci-
ﬁcation of diversity MIMO to more than two transmit antennas [5], and

210
MIMO System Technology for Wireless Communications
information MIMO techniques to WCDMA high-speed downlink packet
access (HSDPA) [6] have been extensively studied as well [7]. However, these
techniques were not accepted before Release 6 and the standardization for
Release 7 is still ongoing.
In this chapter, we concentrate on MIMO transceiver techniques that do
not require major modiﬁcations to the current UTRA FDD speciﬁcations.
Instead of assessing the performance of single user MIMO systems we dis-
cuss MIMO transceivers in system level within UTRA FDD. This is because
the gains of a single link do not necessarily translate into gains in a cellular
system where users are subject to intracell and intercell interference. To this
end, it is ﬁrst necessary to understand the limitations and characteristics of
UTRA FDD air interface. Section 8.2 highlights the important features in
WCDMA uplink and downlink, and Section 8.3 presents multiantenna trans-
ceiver techniques that can be applied within the current WCDMA framework.
The salient difference between the uplink and downlink in UTRA FDD is
that the uplink is interference limited while the downlink is code limited.
Thus, code reuse and spectrally efﬁcient MIMO techniques are in great
demand in downlink, while in uplink each user can employ the entire chan-
nelization code set and MIMO schemes relying on well-known multiuser
detection algorithms [8,9]. MIMO in UTRA FDD uplink is discussed in
Section 8.4.
Section 8.5 presents various information MIMO algorithms [10] that have
been proposed for WCDMA HSDPA mode. Requirements for MIMO per-
formance according to [10] are discussed and their meaning to the develop-
ment of MIMO algorithms is outlined. It is interesting to note that while the
discussion on MIMO transceivers usually focuses on high data rates, increas-
ing peak data rates are only considered of secondary importance in 3GPP,
the most important factors being coverage and cell throughput. At the end
of this section we present a multiuser MIMO scheme for WCDMA downlink
that increases cell throughput without requiring any modiﬁcations to the
present UTRA FDD speciﬁcation. Finally, discussion and visions on future
developments of MIMO transceiver techniques within UTRA FDD frame-
work are presented in Section 8.6.
8.2
UTRA Framework
In WCDMA, narrowband user information is spread over a wide bandwidth
by modulating a low-rate user data sequence with a high-rate spreading
code (channelization code). The length of the spreading codes varies from
4 to 512 chips (in the uplink the maximum code length is 256 chips) and the
chip rate is 3.84 Mcps (Mega chips per second), which together with transmit
pulse shape ﬁlter leads to the carrier bandwidth of approximately 5 MHz.

Multiuser MIMO for UTRA FDD
211
Variable spreading factors and multicode transmission are used in order to
support a wide scale of different data rates.
Scrambling codes of length 38400 chips are employed on top of channel-
ization codes. While channelization codes are used in the downlink to sep-
arate different intracell users and separation of intercell users is based on
different scrambling codes, in the uplink the scrambling codes separate
different users and channelization codes separate different physical data and
control channels of a user. This difference between the code usage in the
downlink and uplink is essential: The limited number of orthogonal chan-
nelization codes imposes a strict upper bound to the achievable downlink
capacity unless information MIMO techniques reusing the channelization
codes are used. The limitation is not strict in the uplink, because one user
may use all channelization codes and the set of long scrambling codes
contains several million codes.
The basic UTRA FDD mode supports user data rates up to 2.3 Mbps both
in uplink and downlink. In downlink, transmission on the peak data rate
requires the use of three parallel channelization codes with spreading factor
4, which allocates 75% of code resources to a single user. In uplink, terminal
transmitting with the peak data rate is seen as a large interference source in
the network but available code resources of other intracell users are not
affected. High peak-to-average ratio of multicode signals sets stringent
requirements to transmitters, which are particularly critical to mobile stations.
8.2.1
UTRA FDD Downlink
Figure 8.1 presents a simpliﬁed downlink channel and frame structure. Each
frame is divided into 15 time slots, with the frame length being 10 ms. The
radio frame carries a dedicated physical channel (DPCH) that further divides
into dedicated physical data channel (DPDCH) and dedicated physical con-
trol channel (DPCCH). The control channel contains transmit power control
(TPC) bits for fast power control, transport format combination indicator
FIGURE 8.1
Downlink frame structure for dedicated physical channel.
DPDCH 
Data bits 
Power 
1 Radio frame = 15 time slots: 10 ms 
Other control channels 
S-CPICH(0−15)
P-CPICH(1−2) 
Data bits 
Pilot bits 
TPC 
TFCI 
DPCCH 
DPDCH 
DPCCH 

212
MIMO System Technology for Wireless Communications
(TFCI) bits that inform the receiver which transport channels are active and
the pilot bits enabling the channel and signal to interference and noise ratio
(SINR) estimation from DPCH.
Figure 8.1 further shows the primary common pilot channel (P-CPICH)
and the secondary common pilot channel (S-CPICH). The numbers in paren-
theses indicate that one sector in downlink may contain 1–2 parallel
P-CPICHs and 0–15 parallel S-CPICHs. The downlink pilot structure is intro-
duced here, because it is needed to understand system speciﬁc problems of
different multiantenna processing methods. While the receiver may estimate
the channel from the dedicated channel, a better result is usually obtained
when employing P-CPICH or S-CPICH, because these common pilot chan-
nels, especially P-CPICH, have higher transmit power. In practice, P-CPICH
usually takes 10% of transmit power resources of the base station, while
power on S-CPICHs is lower. This high transmit power on P-CPICH is due
to the fact that P-CPICH is always transmitted to the whole cell enabling
handover and cell selection/reselection measurements. By adjusting power
differences between P-CPICHs of adjacent cells, the network load can be
balanced. The power of S-CPICH can be lower because it has to cover only
part of the cell. Usually S-CPICH is applied in connection with beamforming.
According to present UTRA FDD speciﬁcation only two P-CPICHs are
available at maximum while multiple S-CPICHs can be introduced, for exam-
ple, for beamforming purposes. This introduces a serious backward compat-
ibility problem for the design of MIMO algorithms. If the power in P-CPICH
is kept ﬁxed but the power is divided to more than two transmit antennas,
the channel estimation in legacy mobile terminals is deteriorated. If the
power of P-CPICH is increased, interference to network increases as well.
8.2.1.1
High-Speed Downlink Packet Access
Starting from Release 5, WCDMA contains a highly optimized downlink
data transmission concept referred to as high speed downlink packet access
(HSDPA). The HSDPA concept introduces a new type of transport channel,
referred to as the high speed downlink shared channel (HS-DSCH), with a
ﬁxed spreading factor of length 16. HSDPA applies several advanced phys-
ical layer solutions to enable high throughput and reduced service delays.
The new physical layer techniques in HSDPA are outlined below.
•
Adaptive modulation and coding (link adaptation)
•
High order modulation
•
Hybrid automatic repeat request (ARQ) solution
•
Reduced length (2 ms) transport time interval (TTI)
•
Fast cell selection (FCS)
•
Physical layer scheduler located in base station

Multiuser MIMO for UTRA FDD
213
The control of HS-DSCH is terminated in the base station to adapt rapidly
to changing channel conditions. Adaptation rate is increased by shortening
transport time interval TTI from 10 ms in Release ’99 and Release 4 to 2 ms.
The same TTI can be used to transmit with multiple channelization codes
to the same user equipment (UE), depending on terminal capability. In
addition, it is possible to multiplex multiple UEs in the code domain within
one HS-DSCH TTI.
Link adaptation is implemented with a large set of possible transport
format combinations, each associated with a unique combination of modu-
lation, coding, and block size parameters. Release ’99 and Release 4 support
only QPSK modulation, but an HSDPA terminal also supports 16-QAM. This
increases the peak date rates in good channel conditions. Fast power control,
which aims to keep the received SINR constant, is not applied. This is because
with non-real time data transmission it is more efﬁcient to allow the received
SINR to vary and change modulation and coding according to the channel
state. Furthermore, fast power control used together with a high date rate
and high power transport channel would generate large interference peaks
to neighboring cells.
Data rates are assigned to a UE based on channel state information. Chan-
nel state information is measured at the UE and signaled to the base station
in the form of a channel quality indicator (CQI). Thus, CQI feedback provides
the necessary information for efﬁcient real-time link adaptation, and this
enables a form of multiuser diversity when applied together with physical
layer scheduling. In a single-input single-output (SISO) scenario, throughput
is maximized by maximum SNR scheduler transmitting to the user that
reports the best SNR to the base station [11]. When the distances of the users
from the serving base station are different, the scheduler is not fair, because
the users on cell edge rarely get any transmission. Therefore, different fair
schedulers have been developed, which aim to equalize transmission periods
among the users. This kind of physical layer scheduling mechanism is part
of the 3GPP WCDMA HSDPA speciﬁcation, but its implementation is a
vendor-speciﬁc option. Instead of SNR, it is also possible to signal data rates
or capacities by mapping the SNR values appropriately.
Fast cell selection is used to select the transmitting base station from the
set of active base stations. Hybrid ARQ (HARQ) combines retransmission
with the previous transmissions to improve reliability, while ARQ ignores
erroneously received packets. HARQ provides implicit rate matching, while
adaptive modulation and coding (AMC) is used to maximize instantaneous
throughput given the instantaneous CQI.
A number of contributions have emerged within 3GPP that propose dif-
ferent MIMO and MISO transceivers to further increase instantaneous data
rates or spectral efﬁciency of HSDPA. These proposals are presented in more
detail in Section 8.2. In addition, the enhancements to the physical layer
techniques already presented are considered as well [13].

214
MIMO System Technology for Wireless Communications
8.2.2
UTRA FDD Uplink
Figure 8.2 presents uplink frame and time slot structures for DPDCH and
DPCCH. In uplink, user and control data are I/Q code multiplexed and several
DPDCHs can be associated to a single DPCCH. In addition to pilot bits, the
TFCI and TPC uplink DPCCH slot contains feedback information bits (FBI)
used to convey partial channel state information when UTRA two-antenna
closed-loop transmit diversity modes are applied. Only user-speciﬁc dedi-
cated pilot channels are available in uplink.
Uplink users are not synchronized, and due to the non-orthogonality of
users’ channelization codes, multiuser interference cannot be avoided. Accu-
rate and fast TPC is indispensable to uplink performance, because otherwise
users in the vicinity of the base station would completely mask intracell
users on cell edges. Fast power control is an inherent characteristic of CDMA
systems, and it is applied in most of the downlink and uplink data channels
in UTRA FDD.
8.3
Current Multiantenna Methods in UTRA FDD
Conventionally, multiantenna techniques have mainly been considered
within base stations, because deploying multiple antennas in the user equip-
ment is not straightforward due to cost, complexity of signal processing, and
power consumption. This is still true in the present terminals that may
support several radios like WCDMA, GSM, GPS, Bluetooth, WLAN. Thus,
handsets that support only SISO processing may still require several anten-
nas for different frequency bands, although the current trend is to handle
the different frequencies with a single multifrequency antenna.
Multiantenna signal processing is useful in base station receivers, but the
use of multiple antennas for transmission requires careful study. All precod-
ing methods that modify the transmitted signal constellation must be stan-
dardized to ensure that all mobile receivers are able to estimate and detect
the signals from different antennas. An extensive standardization process
has been required even in the case of transmit beamforming.
FIGURE 8.2
Uplink frame structure for DPDCH/DPCCH.
DPDCH 
1 Radio frame = 15 time slots: 10 ms 
Data bits 
Pilot bits 
TPC 
TFCI 
FBI 
DPCCH 

Multiuser MIMO for UTRA FDD
215
Present UTRA FDD speciﬁcation supports two-antenna transmit diversity
and transmit beamforming. Such MISO systems for downlink have been
intensively studied, because at the time when the 3GPP standardization was
initiated, most scenarios predicted that the capacity of wireless networks
would be limited by the downlink connection. Although diversity MISO
does not promise such high peak data rates as information MIMO, transmit
diversity improves fading resistance and beamforming increases the system
capacity while its impact to individual user data rates is small. Information
MIMO techniques are not included in the UTRA FDD speciﬁcation, mostly
because the initial standardization work was carried out during the 1990s
when the development of practical information MIMO algorithms was still
only beginning.
8.3.1
Beamforming
Conventional transmit beamforming provides the simplest approach to
increase system capacity and coverage in downlink. The current 3GPP
speciﬁcation supports both ﬁxed beamforming (FBF) and user speciﬁc beam-
forming (USBF) modes in downlink. Fixed beamforming introduces addi-
tional sectors to the cell, because the short term variation of the beams is
small and a handover between the beams is required for mobile users. Each
beam is associated with a unique S-CPICH while P-CPICH is transmitted to
the whole cell.
Fixed beamforming is able to relax the code limitation in downlink, because
orthogonal spreading codes can be reused within the same cell due to spatial
ﬁltering. It is also possible to use different scrambling codes in different beams.
In the presence of ﬂat fading, the channelization codes of different users
within the same beam remain orthogonal because they are scrambled with
the same code. Different beams interfere with one another and increase
intracell interference, but when angular spread (AS) is reasonably small as
in macrocells, this interference remains acceptable. In addition to larger
interference levels, control signaling overhead increases due to inter-beam
handovers, because logically the ﬁxed beams behave in the same way as
different sectors in base stations. The overall effect on system capacity is
positive, though, and according to [14], a 2.4-fold system capacity gain can
be achieved with a four-element antenna array when compared to a single
antenna BS.
Instead of ﬁxed transmit beams, USBF generates individual beams to each
user. More sophisticated signal processing algorithms can be used, and con-
sequently, USBF is able to provide higher individual data rates than FBF. In
practice, USBF cannot be utilized in most cases within UTRA FDD downlink,
because it prevents the user from employing the P-CPICH as a phase refer-
ence, and according to the current speciﬁcation, S-CPICH cannot be
employed in individual beams. Thus, channel estimation must be based on
dedicated pilot channels whose transmit power is low, which may seriously

216
MIMO System Technology for Wireless Communications
corrupt channel estimation in UE. Then only high data rate users near the
base station may take full advantage from USBF. User-speciﬁc beamforming
is optional for UE in HS-DSCH and, therefore, the network cannot assume
that all UE users are able to support it.
Downlink beamforming changes the statistics of the fading signal, and in
environments with small angular spread, array gain dominates diversity
gain. Therefore, the estimation of downlink beamforming gain over single
antenna transmission is rather straightforward: The gain is approximately
the same as the array gain. This is not as simple, though, in uplink.
In uplink, both UTRA FDD beamforming techniques can be implemented
in a straightforward manner in the receiver. The simplest approach is to com-
bine the selected signal paths using maximal ratio combining (MRC) in the
beam space. This leads to a standard Rake-receiver concept. The most chal-
lenging practical problems are related to beam selection (direction of arrival
(DoA) estimation in USBF) and cost-efﬁcient receiver structures. The former
problem is related to the large variety of physical environments with different
channel proﬁles. Furthermore, mobile’s transmit power is typically low for
low data rate connections, making the channel estimation difﬁcult. The latter
problem arises from the fact that baseband complexity increases rapidly when
spatio-temporal estimation processes are introduced. For example, preambles
of random access channel (RACH) need to be monitored simultaneously for
each beam in order to avoid additional delays in connection setup time.
Transmit beamforming improves the downlink capacity in UTRA FDD,
but it is important to note that receive beamforming is not necessarily the
best solution in uplink due to the lack of diversity gain [15]. This gives rise
to a tradeoff between uplink and downlink design targets. If downlink
capacity is the bottleneck, FBF provides a good solution in macrocells. On
the other hand, if good uplink coverage is the primary target, uncorrelated
antennas with suitable receiver algorithms provide a better solution.
8.3.2
Transmit Diversity
According to [15], basic receive diversity solution outperforms receive beam-
forming performance even when angular spread is small. Moreover, transmit
beamforming in downlink loses its good performance in terms of capacity
and coverage when AS becomes large, so that beams cannot be accurately
pointed to users anymore. Hence, there is a need for a multiantenna trans-
mission method in downlink that performs well when correlation between
the transmit antennas is low. In general, low correlation can be achieved
when the distance between antenna elements in the base station is several
wavelengths. Conventional beamforming algorithms do not apply anymore,
and to this end, several open-loop transmit diversity techniques have been
developed in recent years. The simplest space–time block code [16] has
been adopted into 3GPP speciﬁcation as a two-antenna open-loop transmit
diversity method. In UTRA FDD parlance, the scheme is referred to as
space–time transmit diversity (STTD).

Multiuser MIMO for UTRA FDD
217
Space–time codes provide diversity reducing the variance of the received
signal, which further translates into reduced transmit power in downlink.
However, space–time codes do not increase the received SNR when com-
pared to single antenna transmission. With uncorrelated transmit antennas,
received SNR can be improved when short-term channel state information
(CSI) is made available in the transmitter. Such transmit diversity algorithms
are referred to as closed-loop transmit-diversity methods. The current UTRA
FDD speciﬁcation contains two closed-loop modes [4], where the relative
phase and power between the two transmit antennas is adjusted according
to feedback information bits signaled from mobile to a base station through
a dedicated control channel. (See Figure 8.2.)
UTRA FDD supports two P-CPICHs in order to enable efﬁcient channel
estimation of the two channels when transmit diversity is in use. In case of
closed-loop modes, feedback commands are determined from the P-CPICHs
and transmit weights are applied on dedicated trafﬁc channels. Common
pilots are transmitted with higher power than dedicated pilots, and there-
fore, common pilots should be used for channel estimation whenever pos-
sible. With closed-loop modes, dedicated pilots are used for the veriﬁcation
of the transmit weights (feedback commands may be erroneously decoded
in the base station, and the mobile cannot automatically assume that the
transmitter uses the weights that the mobile has instructed), and channel
estimates can still be calculated from P-CPICHs.
Closed-loop techniques outperform open-loop ones, particularly within
low-mobility environments, when the delay of the feedback signaling does
not exceed channel coherence time. Moreover, contrary to conventional
beamforming techniques, closed-loop algorithms do not require accurate
calibration of the transmit antennas due to feedback information. Only
coarse calibration of antenna elements is necessary in order to avoid spurious
antenna gain patterns and unexpected interference to the network.
The discussion on transmit diversity extensions to more than two transmit
antenna systems is ongoing within 3GPP [5,7]. The main concern is that the
beneﬁts from additional transmit antennas may not justify the additional
complexity of transceiver and system design. Firstly, transmit diversity
increases the robustness of the link, but it does not increase data rate. Secondly,
a difﬁcult backward compatibility with former releases is encountered if
transmit power of common pilot channels is divided between, say, four trans-
mit antennas to support channel estimation in UEs. Then legacy UEs that
are able to receive only two pilot channels lose performance, because they
lose half of the available power of the common pilot signals.
8.4
MIMO in UTRA FDD Uplink
MIMO discussion in 3GPP has focused downlink, but the introduction of
new services such as videophones will make it extremely important to reach

218
MIMO System Technology for Wireless Communications
high spectral efﬁciency also in the uplink direction. Besides this service-based
demand, there are also two apparent reasons why MIMO in UTRA FDD
uplink is attractive and, thus, worthy of a closer study. First, base stations
will have two or more antennas in the near future, and at the same time, two-
antenna mobiles, which are at least capable of interference cancellation, will
become more common. Second, in contrast to UTRA FDD downlink, only
minor changes to the UTRA FDD speciﬁcations are needed to enable simple
uplink MIMO approaches.
8.4.1
MIMO Algorithms
We divide MIMO techniques into two main classes — diversity and infor-
mation MIMO. UTRA FDD uplink provides a good means to implement
diversity and information MIMO techniques, because uplink users are sep-
arated by different scrambling codes and, therefore, the whole channelization
code space is available for any one user.
8.4.1.1
Diversity MIMO
In diversity MIMO, Mt replicas of the same data stream are transmitted by
using different orthogonal channelization codes but the same scrambling
code. This is depicted in Figure 8.3, which shows the system model of
diversity MIMO for two transmit antennas. The received signal in kth base
station antenna becomes
(8.1)
FIGURE 8.3
System model for diversity MIMO.
y t
h
t
P
M
S
t
j S
k
i
m
M
m k
t
d m
c
t
( )
( )
( )
=

+ 
=h
h
=
,
,
¨¨
1
tx
,
,
,
{
}
=





m
x m
x
x
x m
x
t
S
t
b i
c
t
iT
s
( ) ,
( )
[ ]
(
)
G
I
dpcch(
),
t
iTs

 I
Spreading 
1 
2 
cd,1
sdpch
sdpch
I
Q
Q
I
j
j
βd
βc
Σ
Σ
βd
βc
cc,1
cd,2
cc,2
DPDCH 
DPCCH 
Scaling 
Scrambling 
1 
2 

Multiuser MIMO for UTRA FDD
219
where the subscript x {d, c},
refers to convolution with multipath channel
hm,k, and
refers to chip-by-chip multiplication of user’s scrambling code
sdpch and channelization codes cd,m and cc,m of dedicated physical data channel
(DPDCH) and dedicated physical control channel (DPCCH), respectively.
Total transmit power is given by Ptx, and power ratio between DPDCH and
DPCCH is adjusted by scaling factors Gd and Gc, and user’s transmitted bits
in DPDCH and DPCCH are denoted by bd and bc. Users are not synchronized
in uplink, and the delay is denoted by I. Finally Td, Tc, and Ts refer to the
lengths of the two channelization codes and the scrambling code.
Each transmit antenna uses different channelization codes cd,m and cc,m so
that the base stations can separate the signals from different antennas and
later combine them using maximal ratio combining. Thus, the scheme dou-
bles the usage of uplink channelization codes when compared to single
antenna transmission. The achievable bit rate with diversity MIMO is at
maximum 2 Mbps/Mt. This reduction of maximum bit rate could be partly
avoided by puncturing the applied error correcting codes, but information
MIMO provides a more attractive choice since the reduced code rate quite
rapidly destroys system performance. However, for low and medium bit
rate services, this does not present a problem.
We note that in the case of ﬂat fading and perfect channel state information
in the receiver, the link performance of the proposed two-antenna diversity
MIMO algorithm is the same as with STTD, because the diversity order of
both schemes is two. However, the system utilizing orthogonal channeliza-
tion codes is more robust, because orthogonality of the received signals does
not depend on the channel estimation, as in the case of space–time coding.
8.4.1.2
Information MIMO
In the case of information MIMO of Figure 8.4, a composite data stream is
multiplexed into two or more independent substreams that are transmitted
from separate antennas by employing different scrambling codes. All streams
contain DPDCH and DPCCH so that in the base station they can be inter-
preted as signals from different independent users. The received wideband
signal in kth antenna is given by
(8.2)
where again x {d,c}. We note that now information bits as well as scrambling
code chips vary between antennas. In contrast, the channelization code can
be the same in all antenna branches.
The present UTRA FDD speciﬁcation allows the mobile to use only a single
scrambling code as well as a single DPCCH and DPDCH. For the proposed


y t
h
t
P
M
S
t
j S
k
i
m
M
m k
t
d m
c
t
( )
( )
( )
=

+ 
=h
h
=
,
,
¨¨
1
tx
,
,
,
{
}
=





m
x m
x m
x
x
x
t
S
t
b
i
c t
iT
s
( ) ,
( )
[ ]
(
)
G
I
dpcch,


m
s
t
iT
(
),
I

220
MIMO System Technology for Wireless Communications
information MIMO, the speciﬁcation should be changed such that the use
of multiple scrambling codes is allowed in the mobile end. Then, it would
be possible to independently apply DPCCH and DPDCH to each scrambling
code. This does not represent a big change to radio interface, because it only
requires that a single user can set up Mt different links. For the effective use
of several simultaneous links, some new code puncturing sets would also
be needed.
8.4.1.3
Advanced Receiver Techniques
As mentioned before, UTRA FDD uplink is interference limited. The inter-
ference-limited nature of CDMA systems results from the receiver design:
the reception is typically based on a matched ﬁlter that does not take into
account multiple access interference (MAI). However, MAI arises in multi-
path channels or with asynchronous communications when spreading codes
do not usually stay completely orthogonal anymore. This limitation can be
relaxed by employing advanced multiuser receiver algorithms, which aim
to reduce MAI. Information MIMO increases MAI in the base station, and
therefore advanced receivers become important to the system performance
when implementing information MIMO techniques.
In order to avoid the overwhelming complexity of multiuser detection,
various suboptimal multiuser receivers have been developed to cope with
MAI. The multiuser receivers can be categorized in several ways. One pos-
sibility is to classify the receivers to linear (decorrelating detector, minimum
mean square error (MMSE) detector) and non-linear receivers. Subtractive
interference cancellation (IC) is one example of the latter category, which
ﬁrst estimates the MAI component and then subtracts it from the received
signal to improve the reliability of the symbol decisions.
FIGURE 8.4
System model for information MIMO.
sdpch,1
sdpch,2
I
Q
I
Q
j
j
βd
βc
βd
βc
Σ
Σ
cd
cc
cd
cc
DPDCH1 
DPCCH1 
DPDCH2 
DPCCH2 
Spreading 
Scaling 
Scrambling 
1 
2 
1 
2 
1 
2 
1 
2 

Multiuser MIMO for UTRA FDD
221
Cancellation of MAI can be carried out in parallel to all users, i.e., with
parallel interference cancellation (PIC) receivers, or in a serial fashion, i.e.,
using serial interference cancellation (SIC) receivers. In un-decoded (conven-
tional) PIC receivers, IC is based on tentative symbol decisions. The quality
of the tentative decisions is essential, because incorrect decisions increase
interference instead of decreasing it. In practice, the error rate of un-decoded
bits varies between 5 and 20% in UTRA FDD uplink. The error rate depends
mainly on the effective coding rate (i.e., rate of the channel encoder taking
into account possible repetition and puncturing), the radio environment, and
the quality of service requirements.
Unreliable tentative bit decisions compromise the performance of un-
decoded PIC. One possibility to improve the reliability of the decisions is to
ﬁrst decode the received symbols, re-encode the decoded symbols again,
and ﬁnally subtract the contribution of the re-encoded symbols from the
received signal. For more details we refer to [17], where this kind of decoded
PIC is applied to the convolutionally coded CDMA system. In [18], this idea
is extended to the Turbo-coded CDMA system.
8.4.2
Uplink Load Equations
Load equations provide a useful tool in both initial planning and perfor-
mance analysis of the network. Here we brieﬂy recall the load equations
[19,20] that will serve as a basis for further studies.
8.4.2.1
 Basic Load Equations
In the following Nown and Nother refer to the number of own cell and other
cell users, respectively. The received wideband signal in baseband at time
instant t can be expressed in the form
(8.3)
where n(t) is complex zero-mean Gaussian, yn(t) is the interference from nth
own cell user, and zn(t) is the interference from nth other cell user. The system
load can be estimated from the sum of received wideband powers of different
users. Signals from different users are mutually independent and from Equa-
tion 8.3 the received wideband power is given by
where E refers to expectation, PN is the noise power, and
r t
y
t
z
t
n t
n
n
N
n
n
N
( )
( )
( )
( ),
=
+
+
=
=
¨
¨
1
1
own
other
E
total
own
other
r t
I
I
I
PN
( )
,
2
{
} =
=
+
+

222
MIMO System Technology for Wireless Communications
Received energy per data bit divided by the noise spectral density is an
important variable in the analysis of UTRA FDD uplink. For user n it is given
by
(8.4)
where
refers to the received power and
is the ratio between bit rate
and chip rate of user n. In UTRA FDD uplink, fast power control tries to
keep En at a target level. Therefore, changes in the interference do not reﬂect
to En, as long as power control is able to compensate the increased interfer-
ence through Prx,n. From Equation 8.4 we easily ﬁnd that
where
is the load from the nth user. For the received wideband power in
the own cell there holds
(8.5)
Furthermore, the total wideband power can be written in the form
(8.6)
where S = Iother/Iown is the intercell to intracell interference ratio seen by the
base station receiver. After combining Equation 8.5 and Equation 8.6 and
solving Itotal from the resulting formula, we obtain the following expression
for the noise rise
(8.7)
where the sum term deﬁnes the own cell load M. In UTRA FDD uplink, load
control drives noise rise to a target level. The more loading is allowed in the
I
y t
I
z
n
N
n
n
N
n
own
other
own
other
E
E
=
{
}
=
=
=
¨
¨
1
2
1
( )
,
( )t
2
{
}.
E
P
I
P
n
n
n
n
=


,
,
1
P
rx
total
rx
,
P
n
rx,
Pn
P
E
E
I
I
n
n
n
n
n
n
rx,
total
total
=
+

= :

P
P
M
1
,
Mn
I
P
I
n
n
N
n
n
N
own
rx,
total
own
own
=
=
=
=
¨
¨
1
1
M ·
.
I
I
I
P
I
P
N
N
total
own
other
own
=
+
+
=
+
+
(
)
,
1
S
µ
S
M
=
=

+
(
)¨

I
PN
n
N
total
n=1
own
1
1
1
(
) ,

Multiuser MIMO for UTRA FDD
223
system, the larger is the required interference margin max{µ} and the smaller
is the coverage area. Interference margin deﬁnes the maximum allowed noise
rise, and typically values 1.0 to 3.0 dB are used for coverage-limited cases
with 20 to 50% load, and in capacity-limited cases, higher interference mar-
gins up to 6 dB can be used [19].
8.4.2.2
Load Equations for MIMO
In diversity MIMO with Rake receiver, the load from the nth user is of the
form
where the superscript D refers to the diversity MIMO. Diversity MIMO
reduces the required energy per data bit and there holds
(8.8)
where the received energy per data bit in single antenna system En is divided
by the number of receiver antennas, because Rake collects energy from Mr
independent antenna branches. Factor
depends on the channel diversity
and system-related issues such as the accuracy of channel estimation. Only
in simple channels, such as single path and ITU Pedestrian A channels, may
the effect of
be noticeable, while in more realistic channels, such as
ITU Vehicular A and ITU Pedestrian B,
is round 0 dB. The ITU channel
proﬁles [21,22] are listed in Table 8.1.
In information MIMO with Rake, the uplink load of a single user is of the
form
(8.9)
where
is the ratio between bit rate and chip rate of the mth data stream
and 
is the received energy per data bit divided by the noise spectral
TABLE 8.1
ITU Multipath Channel Proﬁles
Model 
Delay Proﬁle [ns] 
Power Proﬁle [dB]
Pedestrian A
0 110 190 410 
0,9.7, 19.2, 22.8
Pedestrian B
0 200 800 1200 2300 3700
0, 0.9, 4.9, 8.0, 7.8, 23.9
Vehicular A
0 310 710 1090 1730 2510
0, 1, 9, 10, 15, 20
M
P
P
n
D
n
n
D
n
n
D
E
E
=
+
1
,
E
E
M
n
D
M M
n
r
t
r
=
,
I
/
,
IM M
t
r
,
IM M
t
r
,
IM M
t
r
,
M
P
P
n
I
m
M
n m
n m
I
n m
n m
I
t
E
E
=
+
=
,
,
,
,
¨
1 1
,
Pn m
,
En m
I
,

224
MIMO System Technology for Wireless Communications
density for the mth data stream. We note that with
receive antennas and
the Rake receiver there it holds that
(8.10)
where
depends on the diversity gain and is around 0 dB in case of
multipath diversity. In contrast to diversity MIMO,
depends only on the
number of receive antennas because each transmit antenna applies a different
scrambling code. Without CSI in the transmitter data, rates in different trans-
mit antenna branches are equal, and Equation 8.9 becomes
(8.11)
Equation 8.11 indicates that the base station receiver sees the usage of
information MIMO as an increased number of SISO users. This additional
load can be effectively reduced by applying PIC, which removes part of the
own cell interference in the detection process. Let us denote the PIC efﬁciency
by G, 0 f G f 1. Then the load of a single user can be written as
Since PIC is not able to remove the intercell interference, the total wideband
power seen by the base station receiver is of the form
(8.12)
and the corresponding cell load is given by
(8.13)
In case of PIC diversity, MIMO operates in a similar manner as in case of
SISO. For a single user load we have
(8.14)
Furthermore, for information MIMO the single user load is given by
Mr
E
E
M
n
I
M
n
r
r
= I
/
,
IMr
IMr
M
P
P
n
I
t
n
n
I
n
n
I
M
E
E
=

+
.
1
M
G
P
P
n
n
n
n
n
E
E
=

+
.
(
)
1
1
I
I
I
P
I
P
N
N
total
own
other
own
=

+
+
=

+
+
(
)
(
)
1
1
G
G
S
M
G
S
M
=

+
=¨
(
)
.
1
1
n
N
n
own
M
G
P
P
n
D
n
n
D
n
n
D
E
E
=

+
.
(
)
1
1

Multiuser MIMO for UTRA FDD
225
(8.15)
8.4.3
Performance Comparisons
In the following, we show performance results for UTRA FDD uplink and
discuss the connection between the results and the load equations. Simula-
tions use full 3GPP link level modeling with inner and outer loop power
control and realistic channel and interference estimation algorithms. The
radio channel is modeled according to ITU models in Table 8.1. Our system
model follows accurately the present UTRA FDD speciﬁcations and simula-
tions are done following strictly the recommendations given in [21].
Let us consider two systems where the number of users is the same and
all users employ the same service. Assume that the number of receive anten-
nas is the same in both systems, but the ﬁrst system applies the diversity
MIMO while the second one employs SIMO. In both systems, the base station
applies the Rake receiver. Then, according to Equation 8.8, the ratio between
cell loads is given by
(8.16)
where E refers to the received energy per bit in SISO system, and S1 and S2
denote intercell interference ratios in systems 1 and 2. Since
and
are around 0 dB, we can approximate
(8.17)
Thus, there is no noticeable capacity gain from additional transmit anten-
nas in an isolated cell where S1 = S2 = 0. Assume that we know the intercell
to intracell interference ratio S1 and the original load
. Then we can
compute the capacity gain, provided that the ratio S2/S1 can be deduced. We
have
(8.18)
where the latter equality holds because the number of own cell users is the
same in both systems and power control drives SIR (Equation 8.4) to the
same target value. Hence, S2/S1 depends only on the ratio between other
cell interferences that are proportional to the average mobile transmission
M
G
P
P
n
I
m
M
n m
n m
I
n m
n m
I
t
E
E
=

+
.
=
,
,
,
,
¨
(
)
1
1
1
M
M
I
P I
I
sys
sys
/
/
2
1
1
1
=
+

,
,
,
M
r
M M
r
M M
r
t
r
t
r
E M
E M
E
(
)
/
/
M
E M
r
M
r
r
(
)
,
1
1
1
1
2
1
+


+
+
,
P I
S
S
IM M
t
r
,
I1,Mr
M
S
S
M
sys
sys
2
1
1
1
2
1
~
+
+

.
Msys1
S
S
2
1
1
2
2
1
2
=

=
,
,
,
,
,
I
I
I
I
I
own
own
other
other
other
Iother,1
,

226
MIMO System Technology for Wireless Communications
power. After computing the mean transmit powers in diversity MIMO and
SIMO systems it is found that [23–25]
(8.19)
This equality holds in ﬂat fading. Table 8.2 shows the relative reduction
of the cell load for diversity MIMO when the reference
system applies SIMO. The results show that the gain from diversity MIMO
can be noticeable especially when the initial intercell interference ratio S1 is
large.
While the gain of diversity MIMO strongly depends on the intercell inter-
ference level, the gain from additional receive antennas is remarkable also in
isolated cells. Applying Equation 8.8, the required energy per data bit and
noise spectral density is approximately inversely proportional to the number
of receive antennas Mr. Another measure for the cell coverage is the power
per data bit that is required to compensate the path loss and multiuser
interference. Assume that all users apply the same service. Then by Equation
8.4, Equation 8.5, and Equation 8.10 we have in isolated cells
(8.20)
where E is the energy per data bit and noise spectral density for SISO. We
note that although Equation 8.10 is given for MIMO system, it is applicable
also in the case of SIMO. Equation 8.20 shows that required transmit power,
which is directly proportional to the received power, does not depend only
on the number of receive antennas, but it also depends on the number of
users. It is found that the range gain from additional receive antennas
increases with the load while the absolute cell radius is decreasing when the
load is growing.
In the following, we study the system performance also by simulations.
The main simulation parameters and assumptions are shown in Table 8.3.
TABLE 8.2
Gain of Diversity MIMO Relative 
to SIMO in Terms of Reduced 
Cell Load
MMMM = 0.75
Mr = 2
Mr = 4
S1=0.5, Mt=2
11.1%
4.8%
S1=0.5, Mt=4
14.3%
6.7%
S1=2.0, Mt=2
22.2%
9.5%
S1=2.0, Mt=4
28.6%
13.3%
S
S
2
1
1
1
1
=



> .
M M
M M
M
t
r
t
r
r
(
)
,
(
)
M
M
M
sys
sys
sys
1
2
1

/
P
P
E
M
N
E
N
M
r
M
r
r
rx
own
=







I
P
I
P
(
)
,
1

Multiuser MIMO for UTRA FDD
227
Full 3GPP link level modeling was used with inner and outer loop power
control and realistic channel and interference estimation algorithms. For
more details, see [26].
Figure 8.5 depicts the received power per bit and antenna for SIMO in
terms of the number of 0.96 Mbps users assuming isolated cell and Pedes-
trian B channel with 3 km/h mobile speed. The results in Figure 8.5 were
obtained through multiuser simulations, but they are well in line with Equa-
tion 8.20. It is found that the range gain from two additional receive antennas
is of the order of 3 dB in the single user case, but the gain grows rapidly
with additional users. If, however, noise rise is ﬁxed, the range gain from
additional antennas is inversely proportional to Mr. This is seen by studying
the intersection points between power and noise rise curves.
TABLE 8.3
Simulation Parameters
Carrier frequency
1940 MHz
Chip rate
3.840 Mchips
Sampling rate
1 sample/chip
Power control
ON, both inner and outer loops
BLER target (QoS)
10%
Rake ﬁnger allocation
Known delays
Maximum number of allocated Rake ﬁngers
Five per receive antenna
Channel estimation
Estimated (DPCCH)
Signal-to-interference estimation
Estimated (DPCCH)
FIGURE 8.5
Received power per bit and antenna as a function of 0.96 Mbps users assuming two (solid
curves) and four (dashed curves) receive antennas in Pedestrian B channel with 3 km/h mobile
speed. Receivers are Rake (x), conventional PIC (o), coded turbo PIC with one iteration (*), and
coded turbo PIC with three iterations (+). Dotted curves show the 3 dB and 6 dB noise rise levels.
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
−4
−3
−2
−1
0 
1 
2 
3 
4 
5 
6 
Number of 0.96 Mbps user 
Received power per bit and antenna (dB) 

228
MIMO System Technology for Wireless Communications
Cell capacity also can be estimated from the results in Figure 8.5. We recall
that the load control of the network drives the noise rise to a predeﬁned
target value that is usually between 3 dB and 6 dB, depending on the network
conﬁguration. Intersection with 6 dB level curve shows that two-antenna
and four-antenna Rake receivers reap around 3.3 Mbps and 6.5 Mbps cell
capacities, respectively. In addition to Rake curves, Figure 8.5 shows perfor-
mance results for conventional PIC and coded turbo PIC. Although the
largest gains are obtained by increasing the number of receive antennas, PIC
provides an efﬁcient way to improve cell coverage and capacity when the
number of receive antennas is ﬁxed. In two-antenna case coded turbo PIC
with three iterations results in cell throughput up to 5.8 Mbps and the range
gain against Rake is around 2.5 dB for 6 dB noise rise. Assuming four receive
antennas and coded PIC with single iteration allows almost 10 Mbps
throughputs for 6 dB noise rise.
We recall from Equation 8.14 and Equation 8.15 that the effect of PIC can
be modeled through the efﬁciency G. This parameter is not constant but
depends on cell conditions such as the number of users and channel model.
According to simulations the efﬁciency for uncoded PIC is around 0.4 at
maximum while coded PIC with turbo receiver can provide maximum efﬁ-
ciency of around 0.7.
Figure 8.5 shows the performance for SIMO conﬁguration. However, the
performance for information MIMO can be deduced from the same ﬁgure
by setting the data rate to Mt × 0.96 Mbps and scaling the number of users
accordingly. In the analysis, this equivalence is seen in Equation 8.11. Thus,
there is no throughput gain at the cell level from information MIMO for low
user data rates. Instead, the performance may suffer, because the user’s pilot
power is divided between multiple transmit antennas, which deteriorates
channel estimation in the receiver.
The beneﬁts of information MIMO become visible with high user data
rates. The main reason for the superiority of information MIMO to SIMO
and diversity MIMO is that in information MIMO high data rates can be
obtained without heavy code puncturing because independent data streams
are transmitted from separate antennas. Both SIMO and diversity MIMO
face serious performance degradation when effective code rate increases due
to puncturing. We note that adaptive modulation and coding in uplink is
not supported in UTRA FDD speciﬁcation, and therefore code puncturing
cannot be avoided when SIMO and diversity MIMO are used on high data
rates.
Figure 8.6 shows the received power per bit and antenna in Vehicular A
channel with 30 km/h mobile speed assuming information MIMO and Rake
receiver. Six multicodes of spreading factor 4 were applied for data rates
higher than 2 Mbps. Data rates higher than Mt × 2 Mbps were generated by
using the code puncturing. It is found that additional transmit antennas
provide a remarkable performance gain when the base station has four or
eight receive antennas. Especially in the case of eight receive antennas, the
gain from the second and the third data stream is large, and data rates up

Multiuser MIMO for UTRA FDD
229
to 7.5 Mbps are obtained with 3 dB noise rise. On the other hand, with two
receive antennas, channel estimation errors slightly degrade the system per-
formance when the second data stream is added. For low data rates, this
phenomenon is also visible when Mr > 2. Besides the channel estimation
errors, the poor orthogonality properties of different scrambling codes also
have a negative impact to the system performance. Figure 8.6 also shows the
negative effect of code puncturing. Especially in SIMO curves, rapid degra-
dation in performance is clearly noticeable when the data rate exceeds 2 Mbps.
8.5
MIMO in UTRA FDD Downlink
In the previous section, we showed that in UTRA FDD uplink, spectral
efﬁciency is not the main issue because the uplink is not code limited but
interference limited. However, UTRA FDD downlink is code limited, and
therefore it is necessary to pursue spectrally efﬁcient MIMO transceiver
solutions.
In this section, we ﬁrst review basic MIMO algorithms whose derivatives
have been presented within 3GPP standardization [10]. Many good research
papers and tutorials on MIMO exist (see, e.g., [27]), and we only recall the
fundamental results in order to illustrate potential beneﬁts of MIMO. Then
we will discuss the 3GPP requirements for MIMO performance [10] and
FIGURE 8.6
Received power per bit and antenna as a function of data rate assuming Rake with two (solid
curves), four (dashed curves), and eight (dashed and dotted curves) receive antennas in Vehic-
ular A channel with 30 km/h mobile speed. Numbers of transmit antennas are one (x), two (o),
and three (*). Dotted curve shows the 3 dB noise rise level.
0 
1 
2 
3 
4 
5 
6 
7 
8 
−7 
−6 
−5 
−4 
−3 
−2 
−1 
0 
1 
2 
3 
4 
Data rate (Mbps) 
Received power per bit and antenna (dB) 

230
MIMO System Technology for Wireless Communications
explain their impact to algorithm design. At the end of the section we present
an alternative scheme that increases cell throughput by utilizing the existing
CSI signaling structure without additional complexity in UE.
8.5.1
Theoretical Background
8.5.1.1
Single-User MIMO
For simplicity, we present the capacity expressions in single path channels
to avoid the notational complexity of capacities in multipath channels.
Capacities in multipath (wideband) channels can be expressed by dividing
the channel into several narrowband channels and integrating over the fre-
quency band to obtain the sum capacity.
Let H be a Mr × Mt matrix that consists of normalized complex channel
coefﬁcients hm,n. The bound for the information rate of a memoryless diver-
sity MIMO system in additive white Gaussian noise (AWGN) channel is
given by
(8.21)
where W is the average SNR, which is divided by Mt because the total transmit
power is equally divided between the Mt transmit antennas. Ergodic capacity
in fading channels is then obtained by averaging the capacity (Equation 8.21)
over all possible channel states.
For the information MIMO the bound for the information rate is of the form
(8.22)
where
is an eigenvalue of
. We note that Equation 8.21 and Equation
8.22 apply when the transmitter has no CSI and the total transmit power is
ﬁxed. Ergodic capacities in fading channels are obtained from Equation 8.21
and Equation 8.22 by averaging over channel states.
Wireless channels are often slow fading and coding over all channel states
is not possible within the transmission of a data packet. Thus, it is important
to evaluate the performance of suboptimal transceivers that can be imple-
mented in practice. In vertical encoding (also referred to as V-BLAST [1]),
the input data stream is demultiplexed into as many streams as there are
transmit antennas. Each substream undergoes independent encoding, inter-
leaving, and symbol mapping before it is transmitted from its designated
antenna. This simpliﬁes the receiver design, because the substreams can be
decoded independently. However, when the substreams make up a composite
data packet, the capacity is limited by C = 
, where
C
M
h
t m
M
n
M
m n
r
t
=
+
©
«
ªª
¹
»
ºº
=
=
,
¨¨
log2
1
1
2
1
W
bits/s/H
Hz,
C
M
L
M M
l
L
t
l
r
t
=
+
©
«ª
¹
»º
=
,
=¨
1
2 1
log
;
min{
},
W Q
Ql
HH†
Mt
Mt
log
min(
)
2
1
1+
,
,
(
)
M
M


Multiuser MIMO for UTRA FDD
231
Mi refers to the received SINR in independently coded stream i, because the
composite packet is decoded correctly only if the stream with the worst SINR
is decoded correctly.
The performance of V-BLAST can be improved if CQI feedback for each
substream is made available in the transmitter. Then the ergodic open-loop
capacity can be obtained by transmitting independent data streams from
different antennas with equal power but with different rates [28,29] and
using the MMSE receiver and SIC. This is useful, because the complexity of
the MMSE-SIC receiver is smaller than that of maximum-likelihood decod-
ing. The capacity becomes
where the channel matrix H(i) is obtained by removing data streams 1, …,
i – 1. Thus, the receiver ﬁrst demodulates and deinterleaves the substream
from transmit antenna 1, decodes the data, subtracts its contribution from
the received signal, and proceeds to substream 2, etc. The rates that each
substream can support are different, and therefore, these rates must be sig-
naled to the transmitter. In practice, the MMSE-SIC suffers from error prop-
agation, because if one substream is incorrectly decoded, all subsequent
substreams are affected. Therefore, decoding should start from the stream
with the largest received SINR.
Instead of using CQI feedback, the open-loop capacity with MMSE-SIC
receiver can be achieved by coding across transmit antennas referred to as
diagonal encoding or D-BLAST [1]. In diagonal encoding, the composite data
packet undergoes horizontal encoding after which the codewords are split
into blocks. The blocks of any one codeword pass through a stream rotator,
which rotates the blocks in a round-robin fashion so the mapping from the
substreams to the antennas is periodically altered. Thus, each codeword
spans multiple antennas, but the symbols sent simultaneously from different
transmit antennas belong to different codewords and substreams. Demodu-
lation and decoding are similar to those of V-BLAST and MMSE-SIC. With
V-BLAST the decoding is performed for codewords that are transmitted from
one antenna only, but now decoding is performed over a codeword consist-
ing of Mt blocks, where each block is transmitted from a different antenna.
The capacity of any one substream in D-BLAST is the mean of the capacities
of the blocks transmitted from different antennas,
C
M
M
M
t
i
M
t
i
t
t
=
+
©
«ª
¹
»º
=
+
=¨
log det
log
†
2
1
2 1
I
H H
h
W
W
†
( )
†

©
«
ª
ªª
¹
»
º
ºº
©
«
ª
ª
ª
ª
¹
»
º
º
º
+
1
I
H H
h
M
t
i
i
t
M
W
(i)
º
=
=¨
i
M
i
t
C
1

232
MIMO System Technology for Wireless Communications
and when there are Mt such streams in parallel the total channel capacity in
Equation 8.22 follows.
D-BLAST requires a more complicated transceiver algorithm than V-
BLAST because of the diagonal encoding and decoding. It also suffers from
a rate loss, because in the initial phase, transmission from some of the
antennas has to be suspended in order to facilitate the initialization of the
MMSE-SIC receiver. On the other hand, D-BLAST does not use any CSI in
the transmitter, and in theory, system design is simple, because no feedback
channel is required.
The capacity can be further improved if the transmitter knows the eigen-
modes of the channel. This does not increase the degrees of freedom of the
channel, but the power efﬁciency is improved because the transmitter may
pour power to different eigenmodes instead of allocating power to different
transmit antennas. This is the celebrated waterﬁlling principle. Moreover,
receiver design is highly simpliﬁed, because SIC is not needed. Instead, a
matched ﬁlter, matched to the singular vectors of the MIMO channel, is able
to orthogonalize received substreams. When the number of transmit and
receive antennas is equal, the gap between the capacities with and without
CSI shrinks as a function of SNR [30], but when the number of transmit
antennas exceeds the number of receive antennas, the differences may be
large. Unfortunately, waterﬁlling requires full CSI in the transmitter, which
is not realistic in FDD systems. Therefore, suboptimal solutions, which com-
municate only partial CSI to the transmitter, have been extensively studied.
Antenna selection requires relatively small amount of CSI and different
selection algorithms for MIMO have been developed (see, e.g., [31]). When
the number of available transmit antennas is larger than the number of
substreams to be transmitted, the transmitter may choose a subset of anten-
nas for transmission according to CSI feedback. Thus, the signaling of eigen-
vectors is avoided by using a ﬁxed set of basis vectors, e.g., the transmit
antennas, and CSI feedback consists of the indices of the basis vectors.
Antenna selection improves the quality of the received signal but requires
CSI in the transmitter, although signaling overhead is much less than the
overhead required to signal the singular vectors of MIMO channel. Another
way to improve the robustness of the link is to add spatial redundancy to the
transmitted substreams. Diversity MIMO (Equation 8.21) uses all degrees of
freedom in the MIMO channel for this redundancy. Information MIMO
achieves higher data rates (Equation 8.22) and has no spatial redundancy
between the substreams, but with practical receivers pure information
MIMO approach leads to poor link-level performance at low SNR. This
motivates the search for schemes that achieve a tradeoff between data rate
and diversity [32]. One such 2 × 2 MIMO scheme is presented in [33], which
C
M
C
stream
t
i
M
i
t
=
=
¨
1
1
,

Multiuser MIMO for UTRA FDD
233
transmits two STTD-coded substreams and rotates the other substream to
avoid pathological error events for some combinations of transmitted sym-
bols. In [34] two STTD-coded substreams are transmitted within a 4 × 2 setup,
which is referred to as double STTD within 3GPP standardization [35].
8.5.1.2
Multiuser MIMO
The capacity expressions above assume a point-to-point MIMO link where
the interference consists of AWGN. However, cellular systems supporting
high data rates are subject to non-Gaussian MAI, which should be taken into
account in the design of MIMO transceivers. The downlink channel is a
point-to-multipoint channel, which is referred to as broadcast channel in
information theory. Characteristic of the problem is that the transmitter is
able to coordinate its transmissions to different users, but receivers are not
able to cooperate. Moreover, transmit power resources are shared among the
users.
The capacity region for MIMO broadcast channels has been studied in
[36,37,38], and it has been shown that the sum-rate capacity is achieved by
dirty-paper coding (DPC) [39]. DPC allows the base station to efﬁciently
transmit data to multiple users simultaneously and avoid the impact of MAI
by jointly encoding the transmitted signals. This is possible when the base
station knows the MIMO channels of the users so that it is able to control
the multiuser interference caused by the simultaneous transmissions. Even
though the DPC achievable region is the largest known achievable region
for the multiple-antenna broadcast channel, it is difﬁcult to implement in
practical systems. Different techniques have been investigated to achieve the
gains promised by DPC [40,41], but these techniques are still in the develop-
ment stage. Another nonlinear technique is to use decision feedback equal-
ization in the transmitter, i.e., Tomlinson-Harashima precoding for MIMO
channels [42].
Instead of non-linear precoding, multiuser beamforming (MUB) tech-
niques can serve multiple users simultaneously with reduced complexity.
With multiuser beamforming, each user stream is coded independently and
multiplied by a beamforming weight vector for transmission through mul-
tiple antennas. In block diagonalization [43], the multiuser MIMO channel
is effectively converted into multiple point-to-point MIMO channels.
Allowing the scheduler to select the served user among a pool of users
brings another dimension to the problem. When the number of users is large,
the base station can schedule its transmission to those users with good
channel conditions to achieve higher date rates. This form of selection diver-
sity is referred to as multiuser diversity, and it can be exploited to increase
the system throughput in delay tolerant data applications [44,45]. The authors
of [46] indirectly show that the combination of beamforming and multiuser
diversity asymptotically achieves the optimal sum-rate of DPC when the
number of users is large. However, ﬁnding the optimal beamforming weight

234
MIMO System Technology for Wireless Communications
vector is a difﬁcult non-convex optimization problem. All these multiuser
MIMO schemes assume perfect CSI at the transmitter. Under partial CSI as
in UTRA FDD, the performance of multiuser MIMO is still an open problem.
8.5.2
Proposed MIMO Algorithms within 3GPP Standardization
The standardization of MIMO for HSDPA is still ongoing, and many algo-
rithms have been proposed by different standardization bodies within 3GPP.
In the following, we brieﬂy summarize the algorithms proposed so far; their
acronyms are presented in Table 8.4. All concepts adjust the modulation and
coding of independent substreams using CQI feedback, and D-BLAST-type
processing is not applied. In addition, some schemes employ space–time
coding and four transmit and two receive antennas to gain diversity and
improve link-level performance (DSTTD-SGRC and RC-MPD). Alternatively,
link performance is improved by linear precoding in the transmitter (SS CL
MIMO, PU2RC, S-PARC, D-TxAA).
The ﬁrst two proposals, PARC and DSTTD-SGRC, are well documented,
but documentation on the other six algorithms is sparse. Therefore, we will
introduce them only brieﬂy. A more detailed description and performance
analysis can be found in [10] and numerous standardization contributions
showing performance results for the algorithms of Table 8.4. However, there
is no widespread agreement concerning the ranking of the candidate algo-
rithms, and therefore, we refrain from comparing them here.
All proposals invariably increase the overhead of CSI feedback when com-
pared to HSDPA in Release 5. Multiple data streams require multiple CQIs,
and additional transmit antennas require additional CSI when compared to
2 × 1 MISO conﬁguration supported in UTRA FDD Release 5. However,
reducing the overhead due to feedback signaling has been identiﬁed as one
of the goals in enhanced HSDPA [13]. Uplink interference due to feedback
signaling may cause problems, especially when the mobile is located on the
cell edge.
TABLE 8.4
Proposed MIMO Algorithms within 
3GPP Standardization
MIMO Scheme
Space–Time 
Coding
Linear
Precoding
PARC
DSTTD-SGRC

SS CL MIMO

RC-MPD

PU2 RC

TPRC for CD-SIG
S-PARC

D-TxAA


Multiuser MIMO for UTRA FDD
235
Per-Antenna Rate Control (PARC). Figure 8.7 shows a block diagram of
PARC architecture for two transmit antennas. The HS-DSCH data packet is
demultiplexed into two low-rate substreams. Both substreams are turbo
encoded, interleaved, and mapped to either QPSK or 16 QAM symbols. Code
rates and symbol mappings between the substreams may vary, and therefore
the number of information bits assigned to the streams can be different.
Furthermore, symbols in each spatial substream are divided into K subchan-
nels, where K is the maximum number of HS-PDSCHs deﬁned by the UE
capability. After spreading these subchannels by different orthogonal spread-
ing codes (denoted by OSC 1-OSC K in Figure 8.7), the subchannels are
summed up and modulated by a scrambling code and are ﬁnally transmitted
from their designated antennas. Thus, PARC includes multiplexing in spatial
and code domains.
The base station selects data rates and corresponding modulation, coding,
and channelization codes for different antennas based on antenna-speciﬁc
CQI feedback. For this purpose, UE estimates SINR for all antennas, maps
SINR values to CQI values, and sends this information to the base station
through a feedback channel. The number of possible transport combinations
is large, and CQI must be quantized to avoid excessive feedback overhead.
In order to guarantee the performance of PARC at poor channel conditions,
the lower end of the CQI values should correspond to selective transmit
diversity (STD) transmission.
To emphasize the importance of STD feature for the PARC performance,
probabilities for dual stream and STD transmission for 2 × 2 PARC in a
macrocell environment are presented in Figure 8.8. Probabilities are pre-
sented both in ITU Pedestrian and Vehicular A channels. It should be noted
that the probability for the single stream transmission is as high as 75 to
80%. Moreover, Vehicular A has higher dual stream transmission probability
as it provides more multipath diversity than Pedestrian A.
Double STTD with Subgroup Rate Control (DSTTD-SGRC). This scheme
assumes that Mt = 2Mr. Transmit antennas are divided into Mr two-antenna
subgroups that apply STTD and AMC. Both antennas within the subgroup
FIGURE 8.7
Transmitter structure for PARC.
Coding 
interleaving 
mapping 
MCS 1 
HS-DSCH 
data stream 
MCS 2 
OSC K 
OSC 2 
SC 
SC 
OSC 1 
Demux 
Coding 
interleaving 
mapping 

236
MIMO System Technology for Wireless Communications
use the same modulation and coding scheme (MCS), but the data rates of
different groups can be adjusted independently or jointly by selecting a
suitable MCS. In WCDMA, the maximum number of transmit antennas is
expected to be four, and thus, at maximum, two independent data streams
can be transmitted.
DSTTD-SGRC is a natural extension to the conventional STTD supported
by UTRA FDD Release’99. While conventional STTD employs two transmit
antennas and a single data stream, DSTTD-SGRC doubles the number of
transmit antenna and data streams, provided that UE is equipped with at
least two antennas. Figure 8.9 shows the structure of the DSTTD-SGRC with
four transmit antennas. The incoming HS-DSCH data are divided into two
substreams. Selected MCS and the number of orthogonal spreading codes
(OSC 1-OSC K) deﬁne the number of information bits allocated to each
substream. For both substreams, information bits are coded, interleaved, and
modulated according to the MCS scheme. After STTD encoding, the two
substreams are split into K parallel streams corresponding to K spreading
codes. In the last stage, streams are combined, scrambled, and transmitted.
Rate-Control Multipaths Diversity (RC-MPD). Here each data stream is trans-
mitted from at least two antennas, and the number of data streams is equal
to the number of transmit antennas. A pair of data streams that share the
same two antennas apply the same MCS. The basic idea is to transmit a
second copy of the signal after one chip delay by using the STTD encoding.
Hence, in the case of two transmit antennas, two data streams and corre-
sponding symbols s1 and s2, the transmitted signal consists of symbols s1 and
FIGURE 8.8
Stream distribution for 2–2 PARC in ITU Pedestrian A and Vehicular A channels. Round robin
scheduler is used and 70% of the total transmit power in the base station is allocated to
HS-DSCH.
1 & 2 
1
2
0
5
10
15
20
25
30
35
40
45
VehA at 30 km/h
1 & 2 
1
2
0
5
10
15
20
25
30
35
40
45
PedA at 3 km/h

Multiuser MIMO for UTRA FDD
237
s2 at time T and symbols
and
at time T + Tc, where Tc is the chip interval.
The aim of the method is to achieve multipath diversity that is orthogonal-
ized through STTD encoding.
Single Stream Closed-Loop MIMO (SS CL MIMO). This is a four-antenna
extension of the two-antenna closed-loop Mode 1 that is supported by UTRA
FDD Release’99. The scheme supports only a single data stream but requires
more CSI than Mode 1 due to additional transmit antennas.
Per-User Unitary Rate Control (PU2RC). This algorithm is based on the
singular value decomposition of the MIMO channels. Precoding in the trans-
mitter is based on the unitary matrix that is a combination of the selected
unitary basis vector from all UEs. The aim is to utilize multiuser diversity
on top of MIMO transmission.
Tx Power Ratio Control for Code Domain Successive Interference Cancellation
(TPRC for CD-SIC). Here the receiver applies code-domain SIC to suppress
the impact of code domain interference in addition to space–time interfer-
ence. System performance is further boosted by employing a code-domain
transmit power ratio control that requires additional feedback signaling.
Power control allocates different powers to different spreading codes accord-
ing to the order of successive interference cancellation in code domain.
Selective Per-Antenna Rate Control (S-PARC). The aim is to improve the per-
formance of conventional PARC by combining PARC with antenna selection.
Double Transmit Antenna Array (D-TxAA). Composite data stream is split
into two substreams and each substream is transmitted from two antennas
by applying either of the closed-loop methods in UTRA FDD Release’99.
Hence, the total number of transmit antennas is four.
8.5.3
Practical Considerations
The high speed downlink packet access in Release 5 contains several enhance-
ments to UTRA FDD downlink compared to earlier releases as discussed in
Section 8.1. MIMO concepts presented above show one possibility to further
FIGURE 8.9
Transmitter structure for DSTTD-SGRC.
Coding 
interleaving 
mapping 
STTD 
STTD 
Demux 
Demux
Demux
Demux
OSC 1
OSC K
SC
OSC 1
OSC K SC
MCS 1 
HS-DSCH 
data stream 
MCS 2 
Demux 
Coding 
interleaving 
mapping 
 s2
s1


238
MIMO System Technology for Wireless Communications
improve the performance of HSDPA. Naturally, the improvement due to
MIMO has to be substantial when compared to the complexity of the imple-
mentation. We recall the most important requirements that should be taken
into account when evaluating different candidate MIMO techniques. In the
following, each paragraph starts with a direct quotation from [10].
MIMO proposals shall be comprehensive to include techniques for one, two, and
four antennas at both the base station and UE. Deploying multiple antennas in
the user equipment or base stations to support MIMO techniques is not
straightforward due to concerns of cost, implementation complexity, and
visual impact. This is especially true in the present mobile terminals, where
basic products with large production volumes may have, at most, two antennas.
Present macro base stations typically employ two or four antennas, and it is
expected that two-antenna base stations will dominate in number in the near
future.
For each proposal, the transmission techniques for the range of data rates from
low to high SIR shall be evaluated. This requirement is due to the fact that the
gain from information MIMO greatly depends on the SINR. For example, in
macrocell environments the operating SINR in HSDPA is less than 10 dB
most of the time. Therefore, practical performance differences between var-
ious diversity and information MIMO techniques are not great because the
differences become only signiﬁcant at high SNR region.
Operation of the MIMO technique should be speciﬁed under a range of realistic
conditions. The requirement sparked the development of a new MIMO chan-
nel model for standardization purposes [47]. The model is a geometry-based
stochastic model, which replaced the earlier stochastic channel model [48,49].
Link-level simulations with the spatial channel model are only used for
calibration purposes, and system-level simulations are required to verify the
performance of MIMO proposals. Moreover, implementation un-idealities
should be taken into account when modeling realistic operation environments.
The MIMO technique shall have no signiﬁcant negative impact on features avail-
able in earlier releases. This requirement makes the design of competitive four-
antenna MIMO algorithms difﬁcult, because the present speciﬁcation con-
tains only two primary common pilot channels. To support four-antenna
MIMO, a straightforward solution would be to deﬁne two additional primary
common pilot channels. However, since the total transmit power in the base
station cannot increase — otherwise the base station would generate more
interference to the network — the transmit power per antenna should be
halved. Legacy UEs can receive only two common pilot channels so that, in
case of a four-antenna cell, they would be able to gather only half of the
pilot power when compared to a two-antenna cell. This would seriously
limit the coverage and service availability within the four-antenna cell.
MIMO techniques should demonstrate signiﬁcant incremental gain over the best
performing systems supported in the current release with reasonable complexity.
Theoretical capacity curves suggest that information MIMO may give
remarkable gains when compared to diversity MIMO. It has been observed,

Multiuser MIMO for UTRA FDD
239
however, that with two transmit and receive antennas, practical gains from
information MIMO can be small [50]. Increasing the number of antennas
increases the gain of information MIMO, but at the same time, the imple-
mentation complexity grows rapidly, and backward compatibility, such as
the pilot design problem, becomes an issue.
The focus shall be on strengthening the UTRA system as a reliable and cost-
effective access technique in urban and suburban areas. This means that the goal
is to increase the number of users, and/or to increase their coverage com-
pared to earlier releases. In other words, the improvement of the service
availability as compared to earlier releases shall be used as a primary evaluation
criterion. The increase in maximum data rate per cell is also of interest. In
WCDMA downlink, capacity and coverage are highly interdependent. Mul-
tiple intracell users, which share the same transmit power resource, interfere
with each other. In general, the system can support more users at low power
than at high power, and the availability of services in a cell depends on
required transmit powers. This requirement suggests that instead of increas-
ing data rates with parallel multiplexing, multiple transceiver antennas
should be used for diversity or beamforming to improve the quality of the
received signal.
8.5.4
Multiuser Beamforming
In this section we present a concept that fulﬁlls the requirements cited in the
previous section without additional feedback overhead or receiver complex-
ity when compared to WCDMA Release 5. This can be accomplished by
utilizing the existing closed-loop modes and CQI feedback in UTRA FDD
together with physical layer scheduling.
UTRA FDD two-antenna closed-loop modes [51] aim to maximize the
received SNR by signaling transmit weights from UE to BS. Due to the
limited overhead of the feedback channel, the transmit weights must be
quantized. Mathematical formulation of the problem for ﬁnding the optimal
transmit weight w0 is given by
where
and in the presence of ﬂat
fading
consists of complex impulse responses corresponding to
the ﬁrst and the second channel. It can be assumed without loss of generality
that w1 is real. Therefore, the solution can be characterized by a single
complex coefﬁcient
and
Find w
W
hw
hw
w W
0
0

:
=

max
,
W
w
w
=
=
:||
||=

{
(
,
)
,
},
w w
w w
C
T
1
2
1
2
1 and
h =
,
(
)
h h
1
2
w
zej
2 =
K
( , )
argmax
[
]
[
)
z
z h
ze h
z
j
K
K
U
K
=

+
:  , ,  ,
1
0 1
0 2
2
1
2
2
¯
°
±²
¿
À
Á²
.

240
MIMO System Technology for Wireless Communications
With UTRA FDD closed-loop Mode 1 and Mode 2, the feedback weights
are quantized to follow a time-varying QPSK and 16-QAM signal constella-
tion, respectively.
Assume now that the base station transmits to two users simultaneously
employing either of the present closed-loop modes, and let the channeliza-
tion and scrambling codes be the same for both users. Such assumptions are
reasonable in HSDPA, where the shortage of channelization codes puts strict
limits on the cell throughput. After despreading, the received signals of the
two users become
where ri is the received signal of user i and
is the impulse
response vector between the transmitter and the user i, wi is the transmit
weight vector requested by user i, si is the transmitted symbol, and ni is the
noise term.
Mutual interference between simultaneously scheduled users that use the
same channelization code can be suppressed by selecting users i and j in
such a way that their transmit weights are orthogonal, i.e.,
. Now
the expectation Li,i for the desired power of user i, (i {1,2}) is given by
(8.23)
and the expected undesired interference powers between the users are
Moreover, assuming that the channels corresponding to separate users are
uncorrelated, we ﬁnd that
(8.24)
When the base station transmits with a ﬁxed power, as in HSDPA, the
expectation of Equation 8.25 vanishes due to orthogonal transmit weights.
Computation of SIR can be carried out provided that the expectations of
Equation 8.23 and Equation 8.24 can be evaluated. This can be done by
r
s
s
n
r
s
s
n
1
1
1 1
1
2 2
1
2
2
1 1
2
2 2
2
=
+
+
=
+
+
h w
h w
h w
h w
,
,
hi
i
i
h
h
=
,
,
,
(
)
1
2
w w
i
j
†
= 0
L i i
i
i
i
,
¯
°²
±²
¿
À²
Á²
=
=
:

{
}
{
}
E
E
h w
h w
w
W
2
2
max
L
L
1 2
1
2
2
1
2
2 1
,
¯
°²
±²
¿
À²
Á²
,
=
=
:

{
}
{
}
E
E
h w
h w
w
W
min
,
=
=
:

{
}
{
}.
¯
°²
±²
¿
À²
Á²
E
E
h w
h w
w
W
2
1
2
2
2
min
E
E
(
)†
h w
h w
1
1
1
2
1 1
2 1
1 1
2
¯
°
±
¿
À
Á
,

,
,
¯
°²
±²
¿
À²
Á
= w
w
h
²
,

,
,
¯
°²
±²
¿
À²
Á²
+
.
w
w
h
1 2
2 2
2 1
2
E

Multiuser MIMO for UTRA FDD
241
following the method of [52], and in the case of Rayleigh fading, the resulting
SIR values corresponding to Mode 1 and Mode 2 are given by
Performance of the proposed multiuser beamforming (MUB) technique is
simulated with a quasi-static system level simulator assuming UTRA FDD
closed-loop Mode 1. Average throughput per sector is used as a performance
measure and 2 × 2 PARC provides a reference case. The simulation param-
eters are listed in Table 8.5. The primary user is chosen by using a round
robin (RR) scheduler, which does not take into account CSI. The secondary
user with the same spreading code and orthogonal transmit weight vector
is chosen by either RR or max SINR scheduler. If there is no user having
orthogonal transmit weights with the primary user, full HS-DSCH power is
allocated to the primary user. Otherwise, HS-DSCH power is evenly divided
between the primary and the secondary user. Thus, the proposed scheduling
is a simple extension of the conventional RR providing a fair share of trans-
mission resources to primary users in a RR fashion while additional
resources are given to secondary users depending on the orthogonality of
transmit weights.
The average sector throughput values in Pedestrian A channel are pre-
sented in Figure 8.10. When the secondary user is scheduled by using RR
scheduler (legend “MUB, RR”), the gain in throughput over single-user
transmission is approximately 40%, whereas for max SINR scheduling (leg-
end “MUB, max SINR”) the gain is 70%. Multiuser beamforming with RR
scheduler provides almost the same average sector throughput as 2 × 2
PARC, whereas with max SINR scheduler MUB provides 15% better average
sector throughput than PARC. We emphasize that the MUB schemes employ
only one receive antenna in UE. It has been shown that the performance of
the MUB can be further improved by slightly modifying the calculation
of CQI in user equipment [53]. However, here the simulations assume that
TABLE 8.5
Simulation Assumptions
Site-to-site distance
2.8 km
Pathloss model
3GPP UMTS
Number of sectors
Three/cell
Power delay proﬁle
ITU Pedestrian A, ITU Vehicular A
Number of HS-DSCH codes
10
MCS set
{QPSK (1/2), QPSK (3/4), 16QAM (1/2),16QAM (3/4)}
Receiver
Time-domain LMMSE equalizer
Power of HS-DSCH
70% of the total BS power
Power of overhead channels
30% of the total BS power
Feedback delay
1 slot
Feedback error rate
4%
SIR
dB
for Mode
d
=
=
=
.
.
,
,
,
,
L
L
L
L
1 1
1 2
2 2
2 1
7 65
1
13 5 BB
for Mode 2
¯
°
±²

242
MIMO System Technology for Wireless Communications
UEs are perfectly backward compatible to earlier UTRA FDD releases and
CQI calculation is not altered.
Cumulative distribution functions (CDF) for user throughputs are pre-
sented in Figure 8.11. For MUB with RR scheduler, the shape of the distri-
bution is maintained but the distribution is shifted to the right when
compared to the single-user distribution. The shape of the distribution of
MUB with max SINR scheduling is less steep than the CDF of MUB with
FIGURE 8.10
Average sector throughputs in ITU Pedestrian A channel with 3 km/h mobile speed.
FIGURE 8.11
User throughput CDFs, ITU Pedestrian A channel with 3 km/h mobile speed.
0 
1000 
2000 
3000 
4000 
5000 
6000 
Scheme 
Throughput (kbps/sector) 
Avg sector throughput in ITU PedA at 3 km/h 
CL Mode 1  
MUB, RR 
MUB, max SINR 
2 × 2 PARC
0 
100 200 300 400 500 600 700 800 900 1000 
0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
Throughput(kbps) 
Cumulative probability 
CDF for throughput in ITU pedA at 3 km/h
CL Mode 1  
MUB, RR 
MUB, max SINR 
2 × 2 PARC

Multiuser MIMO for UTRA FDD
243
RR scheduling. Multiuser beamforming with max SINR scheduling increases
the probability of serving good users when compared to MUB with RR,
which explains the higher rates. On the other hand, users with a low SINR
are only scheduled as primary users in MUB with max SNR scheduling,
whereas MUB with RR schedules weak users as primary and secondary
users alike. This explains the shape of the CDF at low data rates. When
comparing the average user throughput CDFs of MUB against the PARC,
we note that MUB with RR provides best average user bit rates for users in
poor channel conditions, whereas PARC provides better average bit rates for
users in good channel conditions than MUB with RR scheduler. The max
SINR scheduler provides clearly the best average bit rates, but on the other
hand, it also provides the smallest average bit rates for the users in poor
channel conditions.
Average sector throughputs in ITU Vehicular A channel at 30 km/h are
presented in Figure 8.12, and the corresponding CDFs for average user
throughputs are shown in Figure 8.13. Comparing the results in Pedestrian
A and in Vehicular A channels reveals the following differences: First, the
average sector throughputs in Vehicular A channel are smaller than in Pedes-
trian A channel for all simulated schemes. For the closed-loop Mode 1 and
the MUB schemes the reduced throughputs are explained by reduced beam-
forming gains. For PARC the performance reduction is due to the interference
between the streams, which increases in multipath channels. Second, in Vehic-
ular A channel MUB with RR scheduler outperforms PARC, while the oppo-
site is true in Pedestrian A channel. This is due to the increase in interference
between users and substreams, the increment being larger for PARC than for
MUB. This is based on the fact that MUB minimizes the interference between
FIGURE 8.12
Average sector throughputs in ITU Vehicular A channel with 30 km/h mobile speed.
0 
1000 
2000 
3000 
4000 
5000 
6000 
Scheme
Throughput (kbps/sector)
Avg sector throughput in ITU VehA at 30 km/h 
CL Mode 1  
MUB, RR 
MUB, max SINR 
2 × 2 PARC

244
MIMO System Technology for Wireless Communications
the simultaneously scheduled users given the CSI feedback, whereas for
PARC there is no protection between the streams. Third, due to the reduced
variance of received SINR, gains from max SINR scheduling are smaller in
Vehicular A than in Pedestrian A channel. The smaller variance in SINR can
also be seen from the CDF curves of average user bit rates, the slopes being
steeper in Vehicular A channel.
8.6
Conclusions and Discussion
We studied different options for introducing multiple-input multiple-output
(MIMO) transceivers to 3G WCDMA uplink and downlink. Basic universal
terrestrial radio access (UTRA) frequency-division duplex (FDD) parameters
were discussed in order to illustrate the boundary conditions in UTRA FDD
that need to be taken into account when designing MIMO transceivers. We
also presented the various MISO techniques supported by the present UTRA
FDD speciﬁcation, Release 6.
It was shown that the uplink coverage and capacity of UTRA FDD mode
can be greatly improved by SIMO and MIMO. While the gain from transmit
diversity is noticeable only in the presence of heavy intercell interference,
the gain from additional receive antennas is remarkable also in isolated cells.
Information MIMO introducing additional scrambling codes should be used
with high data rates instead of diversity MIMO. This is mostly due to the fact
that heavy code puncturing can be avoided by using the information MIMO.
UTRA FDD uplink is not code limited and therefore diversity and information
FIGURE 8.13
User throughput CDFs, ITU Vehicular A channel with 30 km/h mobile speed.
0 
100 
200 
300 
400 
500 
600 
0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
Throughput(kbps) 
Cumulative probability 
CDF for Throughput in ITU VehA at 30 km/h 
CL Mode 1  
MUB, RR 
MUB, max SINR 
2 × 2 PARC

Multiuser MIMO for UTRA FDD
245
MIMO can be implemented by allocating additional channelization or scram-
bling codes to different transmit antennas. Thus, the receiver in the base
station can separate the signals from different antennas in code domain, and
it is not necessary to rely on spatial signatures and space–time code design.
This makes the system more robust and receivers can utilize well-known
multiuser and interference cancellation receivers developed for CDMA sys-
tems. Furthermore, these MIMO schemes can be implemented with only
minor changes to the present speciﬁcation.
In contrast to uplink, UTRA FDD downlink is code limited and it is
necessary to search for spectrally efﬁcient MIMO techniques that are able to
reuse channelization codes. Therefore, similar MIMO techniques as in UTRA
FDD uplink cannot be employed. The work item on MIMO transceivers in
downlink has been active for several years within the third generation part-
nership project (3GPP), and the current target is set to Release 7. Several
concept proposals have been presented in standardization meetings and
added into the technical report [10]. At the time of writing, the gains of
different MIMO proposals are being evaluated against two-antenna receive
diversity. Based on the performance evaluation, Work Group 1 will select a
single MIMO scheme (two transmit antennas) in meeting No. 44 in February
2006 for further analysis. The decision whether to include the MIMO feature
in Release 7 speciﬁcations will be made in June 2006, being based on system
performance and overall complexity evaluation of the selected scheme.
Introduction of MIMO techniques to UTRA FDD downlink has not pro-
ceeded smoothly. First, adding multiple antennas and radio transceiver
chains to user equipments is not straightforward due to cost and complexity
of implementation. Second, new MIMO techniques need to be backward
compatible with earlier releases. In particular, the performance of legacy user
equipment, which is able to receive signals from two transmit antennas,
should not suffer when new base stations use, say, four antennas for trans-
mission. In addition, 3GPP has outlined several other requirements for
MIMO performance. Increasing peak data rates is not considered as the
primary target, which does not favor information MIMO (spatial multiplexing)
techniques. Instead, the goal is to increase the number of users and coverage
of the services. To this end, we introduced a multiuser beamforming tech-
nique that improves system throughput without any modiﬁcations to user
equipments and feedback channels in the current UTRA FDD speciﬁcation.
References
1. G. Foschini. 1996. Layered space–time architecture for wireless communication
in a fading environment when using multi-element antennas, Bell Labs. Tech.
Journal, pp. 41–59.
2. E. Telatar. 1995. “Capacity of multi-antenna Gaussian channels,” European
Trans. Telecomm., Vol. 10, No. 6, Nov./Dec. 1999, pp. 585–595, based on AT&T
Bell Laboratories, Internal Tech. Memo, June 1995.

246
MIMO System Technology for Wireless Communications
3. G. Golden, C. Foschini, R. Valenzuela, and P. Wolniansky. 1999. “Detection
algorithm and initial laboratory results using V-BLAST space–time communi-
cation architecture,” Electronics Letters, Vol. 35, No. 1, pp. 14–16.
4. 3GPP. 2004. “Physical layer procedures (FDD),” 3GPP technical speciﬁcation,
TS 25.214, Ver. 6.4.0, December 2004, Available http://www.3gpp.org.
5. ——. 2003. “Tx diversity solutions for multiple antennas (Release 6),” 3GPP
TSG-RAN technical report, TR 25.869, Ver. 1.2.0, August 2003.
6. ——. 2001. “Physical layer aspects of UTRA high speed downlink packet ac-
cess,” 3GPP TSG-RAN technical report, TR 25.848, Ver. 4.0.0.
7. ——. 2004. “Multiple-input multiple-output in UTRA,” 3GPP TSG-RAN tech-
nical report, TR 25.876, Ver. 1.3.0, February 2004.
8. S. Verdú. 1998. Multiuser Detection, New York: Cambridge University Press,
1998.
9. X. Wang and H. Poor. 2004. Wireless Communication Systems. Advanced Techniques
for Signal Reception, Prentice Hall Communications Engineering and Emerging
Technologies Series, T. Rappaport, ed., Upper Saddle River, NJ: Prentice Hall,
2004.
10. 3GPP. 2004. “Multiple-input multiple-output in UTRA,” 3GPP TSG-RAN tech-
nical report, TR 25.876, Ver. 1.5.1, May 2004.
11. R. Knopp. 1997. “Coding and multiple-access over fading channels,” Ph.D.
dissertation, Ecole Poly-technique Fédérale de Lausanne.
12. D. Chase. 1973. “A combined coding and modulation approach for communi-
cation over dispersive channels,” IEEE Trans. Commun., Vol. 21, No. 3,
pp. 159–174.
13. 3GPP. 2003. “HSDPA enhancements,” 3GPP TSG-RAN technical report, TR
25.899 V0.1.0, 2003.
14. K. Pedersen, P. Mogensen, and J. Ramiro-Moreno. 2003. “Application and per-
formance of downlink beamforming techniques in UMTS,” IEEE Commun.
Mag., Vol. 41, No. 10, pp. 134–143, 2003.
15. E. Tiirola and J. Ylitalo. 2004. “Comparison of beamforming and diversity
techniques in terms of UTRA FDD uplink capacity,” in Nordic Radio Symposium,
Aug. 2004.
16. S. Alamouti. 1998. “A simple transmitter diversity technique for wireless commu-
nications,” IEEE J. Select. Areas Commun., Vol. 16, No. 8, Oct. 1998, pp. 1451–1458.
17. Y. Sanada and Q. Wang. 1996. “A co-channel interference cancellation technique
using orthogonal convolutional codes,” IEEE Trans. Commun., Vol. 44, No. 5.
18. H.C. Kwon, K.J. Kim, B.H. Park, and K.C. Whang. 1998. “Turbo coded CDMA
system with an interference cancellation technique,” IEICE Trans. Commun.,
Vol. E81-B, No. 12.
19. H. Holma and A. Toskala, eds. 2001. WCDMA for UMTS, revised ed., Chich-
ester, U.K.: John Wiley & Sons.
20. J. Laiho, A. Wacker, and T. Novosad. 2002. Radio Network Planning and Optimi-
zation for UMTS. Chichester, U.K.: John Wiley & Sons.
21. ITU. 1997. “Guidelines for evaluation of radio transmission technologies for
IMT — 2000,” Recommendation ITU-R.M.1225.
22. 3GPP. 2003. “Feasibility study for enhanced uplink for UTRA FDD,” 3GPP
TSG-RAN technical report, TR 25.896, Ver. 1.0.2, Nov. 2003.
23. S. Ariyavisitakul and L. Chang. 1993. “Signal and interference statistics of a
CDMA system with feedback power control,” IEEE Trans. Commun., Vol. 41,
No. 11, pp. 1626–1634.

Multiuser MIMO for UTRA FDD
247
24. A. Viterbi. 1995. CDMA — Principles of Spread Spectrum Communications, New
York: Addison-Wesley.
25. J. Hämäläinen, K. Pajukoski, E. Tiirola, R. Wichman, and J. Ylitalo. 2004. “On
the performance of multiuser MIMO in UTRA FDD uplink,” EURASIP Journal
on Wireless Communications and Networking, Dec. 2004, pp. 297–308.
26. GPP. 2003. “BS radio transmission and reception (FDD),” 3GPP TSG-RAN
technical speciﬁcation, TS 25.869, Ver. 6.3.0, Sept. 2003.
27. D. Gesbert, M. Shaﬁ, D. Shiu, P. Smith, and A.A. Naguib. 2003. “From theory
to practice: an overview of MIMO space-time coded wireless systems,” IEEE
J. Select. Areas Commun., Vol. 21, No. 3, April 2003, pp. 281–302.
28. M. Varanasi and T. Guess. 1997. “Optimum decision feedback multiuser equal-
ization with successive decoding achieves the total capacity of the Gaussian
multiple-access channel,” in Asilomar Conference on Signals, Systems and Com-
puters, Vol. 2, pp. 1405–1409.
29. S. Chung, A. Lozano, and H. Huang. 2001. “Approaching eigenmode BLAST
channel capacity using V-BLAST with rate and power feedback,” in IEEE Veh.
Tech. Conf., Fall 2001, Vol. 2, pp. 915–919.
30. C.-N. Chuah, D. Tse, J. Kahn, and R. Valenzuela. 2002. “Capacity scaling in
MIMO wireless systems under correlated fading,” IEEE Trans. Inform. Theory,
Vol. 48, No. 3, pp. 637–650.
31. R. Blum and J. Winters. 2002. “On optimum MIMO with antenna selection,”
IEEE Comm. Lett., Vol. 6, No. 8, pp. 322–324.
32. L. Zheng and D. Tse. 2003. “Diversity and multiplexing: a fundamental tradeoff
in multiple-antenna channels,” IEEE Trans. Inform. Theory, Vol. 49, No. 5,
pp. 1073–1096.
33. O. Tirkkonen and A. Hottinen. 2001. “Improved MIMO performance with non-
orthogonal space–time block codes,” in Proc. IEEE GLOBECOM, Vol. 2, Nov.
2001, pp. 1122–1126.
34. S. Bäro, G. Bauch, A. Pavlic, and A. Semmler. 2000. “Improving BLAST perfor-
mance using space–time block codes and turbo decoding,” in Proc. IEEE
GLOBECOM, Vol. 2, Nov. 2000, pp. 1067–1071.
35. Texas Instruments. 2001. “Double-STTD scheme for HSDPA systems with four
transmit antennas: link level simulation results,” 3GPP TSG RAN WG1, 21(01)-
0701, Release 5 Ad hoc, June 2001.
36. G. Caire and S. Shamai. 2003. “On the achievable throughput of a multiantenna
Gaussian broadcast channel,” IEEE Trans. Inform. Theory, Vol. 49, No. 7, July
2003, pp. 1691–1706.
37. S. Vishwanath, N. Jindal, and A. Goldsmith. 2003. “Duality, achievable rates,
and sum-rate capacity of Gaussian MIMO broadcast channels,” IEEE Trans.
Inform. Theory, Vol. 49, No. 10, Oct. 2003, pp. 2658–2668.
38. P. Viswanath and D. Tse. 2003. “Sum capacity of the vector Gaussian broadcast
channel and uplink-downlink duality,” IEEE Trans. Inform. Theory, Vol. 49, No. 8,
Aug. 2003, pp. 1912–1921.
39. M. Costa. 1983. “Writing on dirty paper,” IEEE Trans. Inform. Theory, Vol. 29,
No. 3, pp. 439–441.
40. Y. Wei and J. Cio. 2001.Trellis precoding for the broadcast channel,” in Proc.
IEEE GLOBECOM, Vol. 2, pp. 1344–1348.
41. R. Zamir, S. Shamai, and U. Erez. 2002. “Nested linear/lattice codes for struc-
tured multiterminal bin-ning,” IEEE Trans. Inform. Theory, Vol. 48, No. 6,
pp. 1250–1276.

248
MIMO System Technology for Wireless Communications
42. J. Jing, R. Buehrer, and W. Tranter. 2003. “Spatial T-H precoding for packet data
systems with scheduling,” in IEEE Veh. Tech. Conf., Fall 2003, Vol. 1, pp. 537–541.
43. Q. Spencer, A. Swindlehurst, and M. Haardt. 2004. “Zero-forcing methods for
downlink spatial multiplexing in multiuser MIMO channels,” IEEE Trans.
Acoust., Speech, Signal Processing, Vol. 52, No. 2, pp. 461–471.
44. R. Knopp and P. Humblet. 1995. “Information capacity and power control in
single cell multiuser communications,” in IEEE Int. Conf. on Comm.
45. P. Viswanath, D. Tse, and R. Laroia. 2002. “Opportunistic beamforming using
dumb antennas,” IEEE Trans. Inform. Theory, Vol. 48, No. 6, June 2002,
pp. 1277–1294.
46. M. Sharif and B. Hassibi. 2005. “On the capacity of MIMO broadcast channels
with partial side information,” IEEE Trans. Inform. Theory, Vol. 51, No. 2,
pp. 506–522.
47. 3GPP. 2003. “Spatial channel model for multiple input multiple output (MIMO)
simulations (Release 6),” 3GPP TSG-RAN technical report, TR 25.996, Ver. 6.1.0,
Sept. 2003.
48. L. Schumacher, J. Kermoal, K.P.F. Frederiksen, A. Algans, and P. Mogensen.
2002. “MIMO channel characterization,” IST, Tech. Rep. IST–1999–11729 ME-
TRA, Feb. 2002, Available at http://www.ist-imetra.org/.
49. Lucent, Nokia, Siemens, and Ericsson. 2001. “A standardized set of MIMO
radio propagation channels,” 3GPP TSG RAN WG1 temporary document,
R1–01–1179, Nov. 2001.
50. J. Fonollosa, R. Gaspa, X. Mestre, A. Pages, M. Heikkila, J. Kermoal, L. Schu-
macher, A. Pollard, and J. Ylitalo. 2002. “The IST METRA project,” IEEE Com-
mun. Mag., Vol. 40, No. 7, pp. 78–86.
51. 3GPP. 2001. “Physical layer procedures (FDD),” 3GPP technical speciﬁcation,
TS 25.214, Ver. 4.0.0.
52. J. Hämäläinen and R. Wichman. 2000. “Closed-loop transmit diversity for FDD
WCDMA systems,” in Asilomar Conference on Signals, Systems and Computers,
Oct. 2000.
53. G. Corral Briones, A. Dowhuszko, J. Hämäläinen, and R. Wichman. 2005.
“Achievable data rates for multiple transmit antenna broadcast channels with
closed-loop transmit diversity modes,” in IEEE Int. Conf. on Comm., Seoul,
Korea, May 2005.

249
9
Multifunctional Reconﬁgurable Microelectro-
mechanical Systems Integrated Antennas for 
Multiple Input Multiple Output Systems
Bedri Artug Cetiner 
CONTENTS
9.1
Introduction ................................................................................................249
9.2
MRA Concept and Its Links with MIMO Systems..............................252
9.2.1
Multifunctional Reconﬁgurable Antenna..................................252
9.2.2
Links among Transmission Algorithms, Antenna 
Properties, and Propagation Environment ...............................254
9.3
RF MEMS Technology Compatible with Microwave Laminates for 
Fabricating MRAs......................................................................................257
9.4
RF MEMS Integrated Antennas ..............................................................258
9.4.1
Three-Element Selection Diversity Antenna.............................258
9.4.2
Multifunctional Reconﬁgurable Spiral Antenna......................263
9.4.2.1
Antenna Structure and Operational Mechanism ......263
9.4.2.2
Microfabrication and Results........................................266
9.5
Concluding Remarks.................................................................................268
References.............................................................................................................270
9.1
Introduction
A wireless communications system that is capable of performing multiple
functions utilizing a single architecture is deﬁned as a multifunctional sys-
tem. A system consisting of multiple subsystems, each of which performs a
separate function, does not fall within this deﬁnition. In this context, a true
multifunctional system must also be reconﬁgurable so that a single architecture

250
MIMO System Technology for Wireless Communications
can reconﬁgure itself for performing each function. A good example of a
multifunctional wireless communications system is a software deﬁned radio
that enables a single device to operate over different communications and
networking standards. A number of articles on multifunctional radio fre-
quency (RF) systems can be found in the recent special issue in IEEE Trans-
action on Microwave Theory and Techniques [1].
This chapter focuses on a new class of antenna, henceforth referred to as
microelectromechanical systems (MEMS) integrated multifunctional recon-
ﬁgurable antenna (MRA), which can be employed in many wireless systems
applications. In accordance with the deﬁnition of a multifunction system
given above, an MRA is a single antenna that is capable of performing
multiple functions by dynamically reconﬁguring its architecture. Dynamic
reconﬁguration in the antenna architecture is accomplished by MEMS.
Progress continues on many existing applications of MEMS technology, such
as RF/wireless, biomedical, optical, and microﬂuidics, while new application
areas such as fuel cells and power generators are also opening up. Estab-
lishment of MRAs requires a new RF MEMS technology, which has recently
been developed by the author and others [2,3]. This technology will be
introduced in the next sections. The implementation of MRAs in MIMO
systems promises to further improve the system performance and is the topic
of this chapter.
The research efforts on MIMO systems with associated transmission algo-
rithms such as space–time codes (STCs) and spatial multiplexing (SM) aim
at making the best use of limited and costly wireless bandwidth by exploiting
the high spectral efﬁciencies offered by multiple antennas. The signal pro-
cessing and space–time coding aspects of MIMO systems are discussed in
Chapters 4 and 5. The motivation behind the topic of this chapter is the fact
that there is additional room for further exploitation of the theoretical gains
of MIMO systems when the antenna/electromagnetic aspects and the asso-
ciated signal processing and coding aspects are integrated together in a
multidisciplinary approach [4]. The performance of MIMO systems depends
on several parameters such as the following:
•
The physical structure of the channel: scattering density and dispo-
sition of the scatterers
•
The space–time processing algorithms for MIMO channels: spatial
multiplexing (SM), space–time coding (STC), and beamforming
•
The antenna array conﬁguration and element properties: radiation
pattern, polarization, operation frequency, and input impedance
Due to the time varying nature of the wireless channel, the true beneﬁts
of MIMO can be exploited only through a smart design that is able to respond
to the channel dynamics. The ability of the network to respond to the channel
may be expressed in the following terms. 

Multifunctional Reconﬁgurable Microelectromechanical Systems
251
•
Shaping the Channel Statistics: The ability to shape the channel
statistics in a way that the spatial dimensions can be resolved. This
allows multiple data pipes to simultaneously carry information across
spatial dimensions and between various users while facing the min-
imum interference. Key to resolvability is the ability to reconﬁgure
the antenna radiation pattern, polarization, operation frequency.
•
Adaptability: The ability to adapt to the channel in an opportunistic
way where the spatial dimensions associated with good channel
conditions are utilized more than the spatial dimensions affected by
poor fading conditions. Key to adaptability is the scheduling algo-
rithm as well as the adaptive algorithm that chooses beamforming,
or the best space–time coding strategy for the channel condition [5].
While adaptability is important to MIMO systems in general, resolvability
is especially important for multiuser MIMO systems where the interference
presented by simultaneous communications is the primary bottleneck. It is
therefore crucial in a wireless network to ﬁrst shape the channel statistics
and then to use link adaptation algorithms that jointly optimize the modu-
lation level, coding rate, and the transmission signaling schemes such as SM,
STC, and beamforming [5]. However, MIMO systems are constrained to
employ ﬁxed antenna parameters, which are determined by the initial
antenna design, over the varying channel condition. Thus, non-reconﬁgurable
antenna designs are unable to shape the channel statistics to minimize interference. 
By treating the antenna element properties and array conﬁguration as an
additional component in the joint optimization of the adaptive system
parameters, an additional degree of freedom is achieved. The goal of joint
optimization of antenna array properties and the associated transmission
algorithm can only be achieved if the structural geometry of each individual
element of the array can be dynamically reconﬁgured. MRAs can dynami-
cally reconﬁgure their structural geometry and thus are capable of altering
radiation, polarization, and frequency characteristics to adapt to the changes
in their operating environments. Therefore, an adaptive MIMO system
equipped with MRAs will not be constrained to employ a ﬁxed antenna
design over varying channel conditions. This feature will permit the selection
of the best antenna properties and conﬁguration in conjunction with the
adapted transmission scheme with respect to the channel condition. Thus
the gap between theoretical MIMO performance and practice is minimized.
Figure 9.1 highlights the performance improvement offered by an adaptive
MIMO system equipped with MRAs.
In the next section, ﬁrst the MRA concept is discussed. Then the interre-
lationships among transmission signaling schemes, physical channel condi-
tions, and antenna radiation/polarization properties are identiﬁed so that
the best antenna design for a given transmission-scheme and channel con-
dition is always selected. The following section discusses the RF MEMS

252
MIMO System Technology for Wireless Communications
technology compatible with microwave laminates for constructing MRA
systems. Finally, a discussion of two different MEMS integrated antennas is
given.
9.2
MRA Concept and Its Links with MIMO Systems
9.2.1
Multifunctional Reconﬁgurable Antenna
In the literature, a smart, intelligent, or adaptive antenna refers to an antenna
array of elements that are typically standard monopoles, dipoles, or patches.
The antenna elements themselves do not possess any intelligence. Intelli-
gence is associated with the signal-processing domain where the time domain
signals from or to the individual antenna elements are weighted and com-
bined such that the resulting radiation pattern (i.e., the spatial response of
the array) satisﬁes some conditions. This is the key concept of beamforming
through which the electromagnetic energy is focused in the direction of the
desired signal, with a null placed in the direction of noise or interference
sources. On the other hand, an MRA array consists of antenna elements,
each of which has some intelligence. This intelligence stems from the ability
to reconﬁgure the physical structure of individual elements through which
polarization/radiation and frequency properties of the array are changed.
The elements in the MRA array have the ability to intelligently process the
signals in spectral and angular domains, adding to the already present time
domain processing of the system. In the language of phased-array antennas,
an MRA array alters not only the array factor but also the element factor. In
FIGURE 9.1
Potential beneﬁt of adaptive MIMO systems employing MRA arrays.
Theoretical MIMO gains 
Adaptive MIMO with 
reconﬁgurabgle antenna 
Adaptive MIMO 
Beamforming 
Space–time
coding

Multifunctional Reconﬁgurable Microelectromechanical Systems
253
current phased-array technology, the element factor cannot be modiﬁed once
individual elements are laid out. The total electric ﬁeld of a linear array of
N identical antenna elements with equal spacing can be given as the sum of
the ﬁelds due to the N elements at the observation point P (R0, V, K):
(9.1)
where R0 is the distance between the center of the array and the observation
point, Ri is the distance between ith antenna element and the observation point,
j denotes the square root of –1, ai and ^i represent the amplitude and phase
of the excitation, respectively, giving rise to Ei relative to a reference excita-
tion, and fe(V,K) represents the element factor. Since the elements are identical,
the element factor fe(V,K) is the same for all the elements and, hence, this
term can be factored out from the summation resulting in the simple expres-
sion given in Equation 9.1. As is seen from Equation 9.1, the radiation pattern
of a classical phased array antenna is changed only by variation of the
amplitude and/or phase of the excitation (ai and ^i). In an MRA array,
however, elements are not necessarily the same and do not exhibit the iden-
tical directional patterns that result in variable element factor. For example,
an MRA array may be reconﬁgured into a polarization diversity scenario in
which the elements would radiate different senses of polarization, such as
linear, right-hand circular, and left-hand circular. An MRA that can change
its polarization between right-hand and left-hand circular polarization will
be introduced in Section 9.4. Block diagrams of a conventional smart antenna
array and a reconﬁgurable antenna array are provided in Figure 9.2a and
Figure 9.2b, respectively.
In a reconﬁgurable array, the antenna element spacing can also be changed
allowing efﬁcient selection and application of beamforming and space–time
coding schemes. While beamforming requires antennas to be closely spaced
(antennas are correlated) to avoid the negative effects of side lobes, space–
time coding will perform well if the spacing between antennas is large
enough to ensure low correlation. As a result, a MIMO system with recon-
ﬁgurability in the geometrical domain of antenna will not be constrained to
use the same antenna design over varying channel conditions, resulting in
better utilization of the available channel capacity.
Finally, a reconﬁgurable antenna is also advantageous in terms of the
physical scale of the antenna systems. In today’s miniature, compact, and
highly integrated telecommunication devices, the area devoted to antenna
elements is typically very limited. This has prompted the antenna commu-
nity to actively research small efﬁcient antenna design [6,7]. An antenna is
said to be an electrically small antenna if it can ﬁt inside a sphere of radius
a = 1/k, where k is the wave number (k = 2U/Q, Q is the wavelength) associated
with the radiated electromagnetic ﬁeld. A rule-of-thumb formula that relates
E R
E R
f
e
i
i
i
N
e
jk
(
,
)
(
,
)
( , )
0
0
1
,
,
V K
V K
V K
=
=
=


¨
R
i
j
jikd
i
N
R
a e
e
i
0
0
0
1
©
«ª
¹
»º ×
¬
®
­
­
¼
¾
½
½
=

¨
^
V
cos

254
MIMO System Technology for Wireless Communications
the bandwidth (BW), efﬁciency (M), and the volume of small size antennas
is given by 
(9.2)
where Q is the minimum radiation quality factor of the antenna, which
increases by the reduction in antenna volume. From this formula, one can
conclude that there is a compromise between the maximum realizable per-
formances, i.e., bandwidth and efﬁciency, and the given electrical dimensions
of small size antenna. The concept of RF MEMS integrated MRA is a revo-
lutionary approach to circumventing the performance limitations of small
size antennas by taking advantage of combined multiple functions in one
single antenna. An MRA combines multiple functions in one single antenna
architecture with the capability of altering its radiation, polarization, and
frequency characteristics. Thus, for given antenna performance characteris-
tics an MRA will occupy only a small fraction of the space required by single-
function multiple antenna elements.
9.2.2
Links among Transmission Algorithms, Antenna Properties, 
and Propagation Environment
In this section, we identify relationships among the transmission algorithms,
the radiation/polarization characteristics, and the conﬁguration of the recon-
ﬁgurable antenna, and the propagation environment. These relationships
FIGURE 9.2
Block diagrams of (a) conventional and (b) MRA arrays.
Σ 
Antenna 1 
Antenna 2 
Antenna M 
Output 
signal 
(a) 
(b)
Σ 
Reconﬁgurable 
antenna 1 
Reconﬁgurable 
antenna 2 
Reconﬁgurable 
antenna M 
Processing 
unit 
BW
k
a
Q
×
%
×
(
) %
M
3
1

Multifunctional Reconﬁgurable Microelectromechanical Systems
255
enable the joint adjustment of the characteristics of the reconﬁgurable
antenna array and the coding schemes over varying channel conditions to
optimize performances at all times.
1. Number of antenna elements: The most basic relationship, which does
not require reconﬁgurability in the geometrical domain of the mul-
tiple antennas, relates the number of antenna elements to a speciﬁc
transmission algorithm. For multiple antennas, if the number of
transmit antennas is larger than two, then it is not possible to design
orthogonal space–time block codes (STBCs) [7]. In case of more than
two antennas, recently developed quasi-orthogonal STBCs are used
to achieve full rate and full diversity at the expense of slight increase
in decoding complexity [8]. For high SNRs and very large number
of antennas SM is favorable over STBCs, since the data rate of SM
increases linearly with an increasing number of antennas, while the
diversity gain of STBC will saturate.
2. Array conﬁguration and polarization: Besides the number of antenna
elements, the subset of the elements selected in an array conﬁgura-
tion is an important factor to achieve the majority of the capacity
available in the channel [9]. This does not only improve performance
but also results in a less complex MIMO system as the number of
the transmit and receive RF chains are reduced. The performance
can be further enhanced if the polarizations of the elements are also
taken into account as the propagation of the electric ﬁeld for different
polarizations differs depending on the environment. It has been
shown experimentally that for a line-of-sight (LOS) indoor environ-
ment, vertically polarized systems achieve higher capacity than hor-
izontally polarized ones [10]. Moreover, an antenna array with
hybrid polarization (i.e., some elements are vertically polarized
while others are horizontally polarized) performs better than single
polarization systems for both LOS and non-LOS (NLOS) conditions.
In practical communication scenarios, degenerate channel phenomena
called the keyhole channel effect may arise where the antenna elements both
at the receiver and the transmitter have very low correlation due to rich
scattering, but the channel matrix has a very low rank, resulting in a single
mode of communication [11]. This shows that low correlation itself is not a
guarantee for achieving high capacity. It is shown in [11] that in an outdoor
propagation scenario, the keyhole problem may be avoided by using a hor-
izontally oriented transmitter array instead of a vertically oriented array. As
a consequence, both the array conﬁguration and the polarization of each
individual element need to be adaptive in order to maintain the channel
performance over varying characteristics of the propagation environment.
A reconﬁgurable antenna array that can change its conﬁguration and polar-
ization has the characteristics necessary to adapt variable transmission/
receiving environments.

256
MIMO System Technology for Wireless Communications
1. Spatial and polarization antenna diversity: A compromise between data
rate maximization and diversity maximization (i.e., choosing
between SM and STC) is critical in realizing MIMO gains, since the
performance of these signaling strategies is strongly dependent on
time-varying channel characteristics. As is known, SM performs par-
ticularly well in high SNR regions, while STBC has better perfor-
mance in a low SNR region. It is shown in [12] that, while having
multiple linear polarization diversity antennas at both ends of the
link degrades the performance of STBC from that of spatial diversity,
signiﬁcant improvements in the symbol error rate for a SM scheme
are achieved in certain channel conditions such as in environments
with high scattering density and with a high K-factor. This leads to
an important conclusion: A reconﬁgurable antenna array that can
readily switch between polarization and spatial diversity schemes
is needed to optimize an antenna performance for a given coding
scheme (i.e., SM or STBC) in a given channel environment.
2. Beamforming, MIMO with STC: When only the receiver knows the
channel, STC achieves the maximum diversity in a system with
multiple transmit antennas. On the other hand, if the transmitter
knows the channel perfectly, beamforming is the optimal solution.
In some practical cases, the transmitter has some information about
the channel (e.g., the mean or variance) instead of a perfect knowl-
edge. When side information is available at the transmitter, it can
be exploited to enhance the performance. Even when the channel
information is based on poor channel estimation, its use improves
the performance of the system in combating fading. The improve-
ment can be achieved by combining STC and beamforming. Typi-
cally, when the quality of the channel feedback is high, the diversity
rank is less critical and the transmitter should lay most energy on
the “good” beam. On the other hand, when the feedback is unreli-
able, we should rely more on diversity and distribute energy evenly
among different beams. In the extreme case when the channel feed-
back quality is so poor it is entirely independent of the actual situa-
tion, the system becomes an open loop system and the beamforming
scheme should gradually fall back to nonbeamformed traditional
space–time coding. Therefore, the performance of the scheme should
be similar to that of the original space–time code. This requires the
design of an adaptive system that can utilize the partial available
channel information to change its behavior and provide the optimal
performance in all cases [13,14]. Such an adaptive system should
converge to space–time coding when the transmitter does not know
the channel at all and to beamforming when the transmitter knows the
channel perfectly. Performance can be improved further if the opti-
mal array design is employed simultaneously. While antenna elements
are closely spaced and correlated in beamforming arrays, MIMO

Multifunctional Reconﬁgurable Microelectromechanical Systems
257
systems employing STCs require large antenna spacing for uncorre-
lated antennas. It is also important to note that beamforming is more
effective if the propagation environment has low scattering density
(i.e., LOS or near LOS) resulting in fewer multipaths. Weight selec-
tion algorithms can be more easily optimized for a few multipaths
than for many. In contrast, STCs take advantage of the multipath
richness by maximizing data rate or diversity. Variation in antenna
element separation is achieved by employing MRA instead of anten-
nas with ﬁxed properties.
9.3
RF MEMS Technology Compatible with Microwave 
Laminates for Fabricating MRAs
As indicated earlier, MEMS technology is gaining a greater foothold in many
existing applications, such as RF wireless communications, biomedical, and
optical, to name a few; at the same time, it is ﬁnding new applications such
as fuel cells and power generators. In particular, RF MEMS have had a
signiﬁcant impact due to their potential to revolutionize RF and microwave
system implementation for the next generation of communication applica-
tions. One of the ﬁrst impacts of RF MEMS was single MEMS switches [15]
with their excellent switching characteristics — very low insertion loss, very
low power requirements, and high isolation —which cannot be attained by
semiconductor switches. The true potential of RF MEMS goes beyond a
single switch. The key advantage of RF MEMS can be realized by system-
level implementation through monolithic integration capability with other
circuit components. This capability is key, in particular, for creating multi-
functional reconﬁgurable antenna systems employing a large number of RF
MEMS components and/or operating at high frequencies. Although RF MEMS
devices on semiconductor substrates (tunable RF matching circuits/ﬁlters,
variable capacitors, phase shifters, switches) have been demonstrated
[16–19], realization of monolithically integrated RF MEMS antenna systems
requires common substrate housing of both MEMS and antennas. Microwave
laminate printed circuit boards (PCBs) are commonly used for the design of
RF circuits and antennas and represent an ideal substrate for RF MEMS
device integration. However, PCB processing has been historically difﬁcult
due to the process limitations imposed by PCBs, such as low temperatures
and non-planar surfaces. In order to overcome these problems, we recently
developed an RF MEMS technology compatible with microwave laminate
PCBs that overcomes the drawbacks of the silicon-based MEMS technology
in establishing reconﬁgurable antennas with low cost and high performance.
The details of PCB compatible RF MEMS technology and associated fabri-
cation processes are beyond the scope of this chapter and can be found in

258
MIMO System Technology for Wireless Communications
references [2,3,20]. The main advantage of this technology lies in allowing
the monolithic integration of the antenna and the switches on the same
substrate as part of the same lithographic process. This approach eliminates
the need for wire bonds to be interconnected to the RF MEMS switches, thus
simplifying the matching circuit as well, while reducing the switch parasitics.
Figures 9.3 and 9.4 compare two MRA systems realized by silicon-based and
microwave laminate compatible RF MEMS technologies in terms of com-
plexity, cost, and performance. It is obvious from these ﬁgures that the latter
technology provides higher performance, less complexity, and low cost com-
pared to the former technology.
9.4
RF MEMS Integrated Antennas
In this section, the design, microfabrication, and results of two different RF
MEMS integrated antennas will be presented. The ﬁrst design is a multi-
element selection diversity antenna (i.e., cactus antenna) in which RF MEMS
actuators are monolithically integrated with antenna feed lines to selectively
route the RF feed signal. In the second design, RF MEMS actuators are
integrated within the geometrical structure of the antenna to construct a
multifunctional reconﬁgurable spiral antenna capable of dynamically chang-
ing its polarization between right-hand and left-hand circular polarizations.
9.4.1
Three-Element Selection Diversity Antenna
We ﬁrst designed a single antenna, which will henceforth be referred to as
the cactus antenna. The geometry of the cactus is depicted in Figure 9.5. It
consists of two half-wavelength inductively coupled coplanar waveguide
(CPW) slots combined with the half-wavelength capacitively coupled slot
antenna, which is fed through a triangular-shaped half-wavelength CPW strip.
The inductively coupled slots are bent upward for compactness, necessary
in multi-element antenna systems. This structure produces three different
resonant frequencies, fr1, fr2, and fr3, deﬁned by the lengths of the two slots
(L1, L2) and the triangular-shaped CPW line (L3), respectively (see Figure 9.5).
These lengths are determined based on the half-wavelength resonance cri-
terion and are approximately calculated using Equation 9.3. By optimizing
L1, L2, and L3 in conjunction with other design parameters (see Figure 9.5),
resonant frequencies of fr1, fr2, and fr3 are located such that the cactus antenna
possesses 42% impedance bandwidth for a voltage standing wave ratio
(VSWR) of 2.
; 0.8 f Pi f 1, i = 1, 2, 3 
(9.3)
L
c
f
i
i
reff
ri
=
P
J
2

Multifunctional Reconﬁgurable Microelectromechanical Systems
259
FIGURE 9.3
Process ﬂows for silicon-based RF MEMS technology for realizing MRA systems, (a) Fabrication
of MEMS switches on a semiconductor, (b) Packaging individual MEMS switches, (c) Dicing,
(d) Assembling MEMS and antenna elements through wire bonding (or ﬂip-chip) on PCB to
construct the MRA.
Semiconductor
substrate (Si, GaAs, etc.)
(a) 
(b) 
(c) 
(d) 
PCB substrate 

260
MIMO System Technology for Wireless Communications
In Equation 9.3, c is the speed of light in free space and Jreff represents the
effective dielectric constant of the dielectric supporting material. Pi is a coef-
ﬁcient and ranges from 0.8 to 1 [21].
Next, a three-element selection diversity cactus antenna with RF MEMS
switches monolithically integrated on CPW feed network is fabricated on
RT/Duroid 5870 (see Figure 9.6). This material is particularly suitable for
antenna applications due to its low dielectric constant and low loss property
in the desired frequency range (Jr = 2.33, tanI = 0.0005 @ 5 GHz) [22]. The
switches used are capacitive and have a structure similar to those previously
published [15].
Three RF MEMS switches located on the CPW feed, single-pole three-
throw switch (SP3T), route the input to one of the branches in order to
maximize the signal-to-noise-ratio (SNR) of the diversity signal at the receiver
FIGURE 9.4
Process ﬂows for microwave laminate compatible RF MEMS technology for realizing MRA
systems, (a) Fabrication of monolithically integrated MEMS antenna on PCB, (b) System level
packaging.
(b) 
(a) 
PCB substrate 

Multifunctional Reconﬁgurable Microelectromechanical Systems
261
(see Figure 9.6b). The distances from the centers of switches to the cross-
junction are designed to be quarter-wavelength in the substrate at the center
design frequency of 5 GHz. Thus, at the center frequency, the diversity
branch with switch in the down position is transformed into an open circuit
at the cross-junction due to the quarter-wave transmission line. This mechanism
slightly narrows the impedance bandwidth of the antenna since the signal
propagating on the selected diversity branch sees two quarter-wavelength
open transmission lines of the two disconnected diversity branches at the
junction. High impedance quarter-wavelength lines using the same concept
are utilized to actuate the switches. In this case, the bandwidth degradation
is very small due to the combined effect of the quarter-wave line and high
impedance of the line. In the current design, a bias voltage of 40V is required
to actuate the switch. Three metal-insulator-metal (MIM) capacitors located
on the CPW line are employed to decouple the RF signal path from the bias
voltage. Air bridges are used to ensure the continuity in the CPW ground
planes and to suppress possible slotline modes excited at the junctions. The
fabrication of air bridges, as well as MIM capacitors, is compatible with the
monolithic process.
The fabrication procedures of the cactus antenna integrated with RF MEMS
switches and that of the MRA that will be presented in the next section are
very similar. Therefore, only a brief summary of the fabrication process is
FIGURE 9.5
Top view of the CPW-fed antenna geometry and dimensions in mm. L2 = 25, W2 = 3.5, L1 =
28.6, W1 = 4.8, L3 = 18, L = 12, S = 0.15, G = 0.25, W = 2.6, D = 15, h = 1.52, F: orientation angle.
h 
εr 
W2 
L2 
W1 
S 
L3 
L1 
G 
W 
L 

262
MIMO System Technology for Wireless Communications
given here. The process starts with standard via hole formation for switch
biasing. Ease of via layout is an advantage of this process over existing
technologies, where deep vertical vias are normally difﬁcult to form. Via
holes through the substrate connect the central electrode of each switch to
the bias line placed on the backside of the antenna. This separation does not
only create a space for multiple antennas but also helps increase the isolation
FIGURE 9.6
(a) Photograph of the selection diversity cactus antenna integrated with RF MEMS switches;
S1, S2, S3 are RF MEMS switches; A1, A2, A3 are cactus antennas; (b) Schematic of the feeding
structure, single-pole-three-throw switch (SP3T).
S1
S3
MIM capacitor 
Air bridge 
Bias via hole 
MIM capacitor 
Bias line 
S2
(b)
(a)
Bias line 
S2 
A2 
A1 
A3 
S1 
S3 
Bias via hole 

Multifunctional Reconﬁgurable Microelectromechanical Systems
263
between antenna elements and biasing circuit. This, in particular, is an impor-
tant advantage as the circuit complexity and the number of switches increase.
Next, antennas and all feed lines are formed by a simple wet etch process.
Finally, MEMS switches, MIM capacitors, and air bridges are monolithically
fabricated.
Results are presented in the following ﬁgures. Figure 9.7 shows the return
losses of each switched antenna. As mentioned earlier, the two quarter-
wavelength lines narrow the input impedance bandwidth of the cactus
antenna from its original 42% to 30%. However, the covered bandwidth is
still very large for most wireless local area network (WLAN) applications.
Figure 9.8 illustrates the measured x-y plane co-polar radiation patterns at
the center design frequency of 5 GHz, normalized with respect to the same
reference, corresponding to the sequential and individual activation of each
antenna. As a result of the inter-element 45° rotation angle, radiation patterns
with 45° rotation are clearly distinguished in the ﬁgure. Appropriate activa-
tion leads to angular or polarization discrimination of the signal of interest
in multipath scenarios. For example, the axis of the active element can be
oriented to the direction of strong interference.
9.4.2
Multifunctional Reconﬁgurable Spiral Antenna
9.4.2.1
Antenna Structure and Operational Mechanism
In the three-element cactus antenna design the role of RF MEMS switches,
which are located on antenna feed lines, are limited to selectively routing
the RF feed signal. In this design, a number of RF MEMS actuators are
monolithically integrated within the geometrical structure of the antenna to
construct a multifunctional reconﬁgurable spiral antenna (MRSA). In other
FIGURE 9.7
Measured return loss of individual selected cactus antenna.
0 
3.5 
4 
4.5 
5 
Frequency(GHz) 
5.5 
6 
Antenna 1 
Antenna 2 
Return loss(dB) 
Antenna 3 
6.5 
7 
−5 
−10 
−15 
−20 
−25 
−35 

264
MIMO System Technology for Wireless Communications
words, RF MEMS actuators are used as part of the physical structure of the
antenna, owing to the monolithic integration capability of the processing
technique, providing a large degree of structural reconﬁgurability.
MRSA architecture is built on a number of printed rectangular-shaped
metal strips interconnected by RF MEMS actuators on a microwave laminate
PCB substrate, RO4003-FR4 (Jr = 3.38, tanI = 0.002). Shown in Figure 9.9a
are two adjacent strips interconnected by a RF-MEMS actuator, which is
made of a metallic movable membrane, suspended over a metal stub pro-
truding from an adjacent strip, ﬁxed to both ends of the strip through metallic
posts. The optimized height of these posts was found to be 8 µm for a good
tradeoff between up position switch coupling and actuation voltage. Metal
stubs are covered by silicon-nitride (SiNx) ﬁlm to prevent metallic membrane
from sticking onto the stub upon contact. This ﬁlm also provides a capacitive
contact for the actuator down state isolating RF signal from DC. A DC bias
FIGURE 9.8
Measured co-pol radiation patterns at 5GHz of each antenna element in the x-y plane when
the three switches are sequentially activated.
180 
90 
270 
0 
−10 
−20 
−20 
−10 
(a)
(b)
180
90
270
0
−10
−20
−30 
−30
−10
A3
(c)
180
90
270
0
−10
−20
−20
−10
−30

Multifunctional Reconﬁgurable Microelectromechanical Systems
265
voltage of approximately 40 V applied between the membrane and the stub
causes an electrostatic force that pulls the suspended membrane on top of
the stub (actuator down state or actuator on, see Figure 9.9c), and the actuator
connects the strips; otherwise the strips are disconnected (actuator up state
or actuator off; see Figure 9.9b). Judicious activation of interconnecting actu-
ators, i.e., by keeping some of the actuators in the up position (zero bias)
while activating the rest of them by applying DC bias voltages, allows the
reconﬁgurable spiral to conﬁgure its architecture into single arm rectangular
spirals with opposite winding sense of the spiral, left or right senses (see
Figures 9.10a and b). Accordingly, right- and left-hand circularly polarized
(RHCP and LHCP) radiation is achieved. In Figures 9.10a and b, for the
clarity of illustration, each conﬁgured geometry is depicted separately and
actuators in the up state are shown without metallic membrane. The antenna
is fed by a single coaxial probe, as shown in Figure 9.10c. The supply voltage
is connected to the proper locations on the antenna segments through resistive
FIGURE 9.9
RF MEMS actuator interconnecting two adjacent metallic strips (a) top view; width of metal
strip, w1 = 800 µm; width of stub, w2 = 100 µm; width of membrane, w3 = 150 µm; (b) side view
(up position); thickness of nitride, t1 = 0.2 µm; thickness of membrane, t2 = 0.5 µm; air gap, g =
7.8 µm; (c) side view (down position); thickness of electroplated copper, h1 = 8 µm; thickness
of PCB copper, h2 = 16 µm.
A 
A‘ 
W2 
W3 
W2 
W1 
A
A‘
t2
g
t1
PCB
h1
h2
(a) 
(b)
(c)
Aluminum
Electroplated copper
PCB copper
Substrate
SiNx

266
MIMO System Technology for Wireless Communications
bias lines so as to prevent the RF signal from being shorted by the DC power
supply.
MSRA is designed to radiate an axial beam of RHCP and LHCP ﬁelds. It
is known that a single-arm rectangular spiral antenna with outermost arm
peripheral length (circumference) of C,
(9.4)
excites only the ﬁrst radiation mode, giving rise to an axial beam of circular
polarization [23], where Qeff = Q0/[(Jr + 1)/2]1/2 is the effective wavelength of
the current traveling on the spiral. The number and size of the strips are
optimized so that circumference of the antenna, C = 42 mm = 1.04 Qeff, satisﬁes
Equation 9.4 and a minimum number of actuators with associated bias
circuitries are needed.
9.4.2.2
Microfabrication and Results
The MRSA is microfabricated on a microwave laminate substrate RO4003-
FR4, which is conductor backed to ensure that the antenna radiates broadside
FIGURE 9.10
Schematics of the single arm rectangular spiral antennas, which are reconﬁgured from the
MRSA architecture by judicious activation of the interconnecting RF MEMS actuators, for
(a) left-hand circular polarization, (b) right-hand circular polarization, (c) side view of the
antenna. The outermost dimensions of the antenna are 9 h 12 (mm), the spiral line width is
0.8 mm.
50 V 
50 V 
50 V 
0 V 
0 V 
0 V 
50 V 
50 V 
0 V 
0 V 
0 V 
50 V 
Coax 
feeding 
point 
Actuator  
in the up 
state 
Actuator  
in the 
down state 
z (coax-feed) 
(a) 
(b) 
H 
εr = 3.38 
Coaxial cable 
(c) 
1
2
Q
Q
eff
eff
C
<
<

Multifunctional Reconﬁgurable Microelectromechanical Systems
267
to the printed spiral surface. Substrate thickness is chosen to be 7.6 mm,
which is one of the standard thicknesses for PCB family substrates, the closest
one to the quarter-wavelength at a center design frequency of 5 GHz. The-
oretical characterization of the antenna structure is conducted by a full-wave
analysis tool based on a ﬁnite element method, which takes into account the
edge effects due to ﬁnite size dielectric and conducting plane of the antenna.
A brief fabrication sequence for monolithic integration of RF MEMS actuators
with rectangular-shaped strip segments of the MRSA is given in Figure 9.11.
Details of the fabrication process can be found in references [2,3,20]. The
fabrication begins with RO4003 laminate with copper layers of 16 µm on
both sides. First, the segments of the antenna and planar part of the bias
circuitry are formed by wet etching copper layer. Vertical vias for bias cir-
cuitry and coax feed are created by standard PCB processes. After this step,
a thin layer of high-density inductively coupled chemical vapor deposition
(HDICP CVD) SiNx [20] is deposited and etched by reactive ion etching such
that the SiNx covers only the tips of the metal stubs protruding from the
antenna segments (see Figure 9.9a). We continue fabricating RF MEMS actua-
tors following the process ﬂow shown in Figures 9.11b–d without affecting
the antenna structure.
Figure 9.12 shows the return loss of the MRSA with counterclockwise sense
of winding corresponding to the RHCP radiation. The simulated result is
FIGURE 9.11
Fabrication sequence for monolithic integration of RF MEMS actuators with rectangular-shaped
strip segments in constructing MRSA (a) Antenna pattern, DC bias path and via formation (b)
Dielectric layer deposition and sacriﬁcial layer planarization, (c) Aluminum membrane depo-
sition, (d) Final release.
Spiral segments
DC bias path 
(a) 
(b) 
(c) 
(d) 
Coax inner 
conductor 
RF MEMS 
actuator 

268
MIMO System Technology for Wireless Communications
also validated by comparison with experimental data in this ﬁgure. Due to
the symmetry between two antenna conﬁgurations, the RHCP and LHCP
spirals exhibited almost identical return loss with a VSWR of less than two
covering the frequency band of 4.3–5.4 GHz. Measured and calculated radi-
ation patterns at 5 GHz in two different planes of K = 0° and 90° are shown
in Figures 9.13a–d for RHCP and LHCP conﬁgurations. As seen from these
ﬁgures, the MRSA radiates circularly polarized wave slightly off broadside
to the plane of spiral, forming an almost axial beam pattern. This slight tilt
from the z-axis is due to the asymmetry of the antenna structure with respect
to the z-axis. The measured average half-power beamwidth (HPBW) is
approximately 105°. The antenna radiates almost entirely circular wave in
the z-axis with an axial ratio value of 0.9 dB. The gain at this direction is 5.3
dB. Variations of axial ratio and gain in the z-direction with respect to
frequency are shown in Figure 9.14. The circular polarization bandwidth
over which the axial ratio is less than 3 dB is approximately 11%. Gain of
the antenna with average value of 4.9 dB shows small variation over this
bandwidth. The difference in performance characteristics between the RF
MEMS integrated spiral antenna and conventional single-arm rectangular
spiral antenna was observed to be negligible.
9.5
Concluding Remarks
Wireless applications that are increasingly bandwidth- and mobility-inten-
sive have driven MIMO research to challenge the physical limits of coding
and signaling. The multifunctional reconﬁgurable antenna technology pre-
sented in this chapter greatly impacts adaptive MIMO performance through
FIGURE 9.12
Return loss of the MRSA for RHCP radiation.
0 
3
3.5 
4 
4.5 
Frequency(GHz) 
5 
Calculated 
Measured 
Return loss(dB) 
5.5 
6 
−5 
−10 
−15 
−20 
−25 
−30 

Multifunctional Reconﬁgurable Microelectromechanical Systems
269
the capability to change its performance properties (i.e., radiation and
impedance characteristics). The reconﬁgurable antenna properties integrated
with signaling schemes (i.e., spatial multiplexing, space–time coding, beam-
forming) to the propagation environment provides an additional degree of
freedom in adaptive optimization; thus the gap between theoretical MIMO
performance and practice is closed. RF MEMS technology compatible with
microwave laminates enables very large-scale monolithic integration of
antenna and circuit components on a substrate that best meets the antenna
performance characteristics. MEMS integrated antennas; a diversity antenna
(three-element cactus) suitable for selection diversity; and a multifunction
reconﬁgurable spiral antenna have been fabricated by using this technology.
FIGURE 9.13
Radiation patterns for the RHCP conﬁguration in (a) K = 0 plane and (b) K = 90 plane; radiation
patterns for the LHCP conﬁguration (c) K = 0 plane and (d) K = 90 plane at 5 GHz.
(d) 
(c) 
270 
315 
180 
225 
0 
45 
90 
135 
270 
315 
180 
225 
0 
45 
90 
135 
−10 
−20 
−20 
−30 
−10 
−10 
−20 
−20 
−30 
−10 
270 
(a) 
(b) 
315 
180 
225 
0 
45 
90 
135 
270 
315 
180 
225 
0 
45 
90 
135 
−10 
−20 
−20 
−30 
−10 
−10 
−20 
−20 
−30 
−10 
Calculated
Measured
ER
EL
EL
ER

270
MIMO System Technology for Wireless Communications
A long-awaited design space where an interplay between reconﬁgurable
antenna and adaptive signaling feed back to each other is likely to revolu-
tionize broadband MIMO system design methodology.
References
1. Special Issue on Multifunctional RF Systems. 2005. IEEE Trans. Microwave The-
ory and Techniques, Vol. 53, No. 3.
2. H.P. Chang et al. 2003. “Low cost RF MEMS switches fabricated on microwave
laminate PCBs,” IEEE Electron Device Lett., Vol. 24, No. 4, pp. 227–229.
3. B.A. Cetiner et al. 2003. “Monolithic integration of RF MEMS switches with a
diversity antenna on PCB substrate.” IEEE Trans. Microwave Theory and Tech-
niques, Vol. 51, No.1, pp. 332–335.
4. B.A. Cetiner et al. 2004. “Multifunctional reconﬁgurable MEMS integrated
antennas for adaptive MIMO systems,” IEEE Communications Magazine, Vol. 42,
No. 12, pp. 62–70.
5. S. Catreux et al. 2002. “Adaptive modulation and MIMO coding for broadband
wireless data networks,” IEEE Communications Magazine, Vol. 40, No. 6,
pp. 108–115.
6. L. Jofre, B.A. Cetiner, and F. De Flaviis. 2002. “Miniature multi-element antenna
for wireless communications,” IEEE Trans. on Antennas and Propagat., Vol. 50,
No. 5, pp. 658–669.
7. V. Tarokh, H. Jafarkhani, and A.R. Calderbank. 0999. “Space-time block coding
from orthogonal design,” IEEE Trans. on Inform. Theory, Vol. 48, pp. 611–627.
8. H. Jafarkhani. 2001. “A quasi-orthogonal space-time block code,” IEEE Trans.
Commun., Vol. 49, pp. 1–4.
9. M.A. Jensen and J.W. Wallace. 2003. “Antenna selection for MIMO systems
based on information theoretic considerations,” 2003 IEEE AP-S International
Symposium Digest, Vol. 2, pp. 515–518.
FIGURE 9.14
Frequency responses of axial ratio and gain in the z-direction for MRSA.
12 
Axial ratio and gain(dB) 
9 
6 
3 
0 4.6 
4.8 
5 
Frequency(GHz) 
5.2 
5.4 
Calculated axial ratio
Calculated gain
Measured axial ratio 
Measured gain 
5.6 

Multifunctional Reconﬁgurable Microelectromechanical Systems
271
10. P. Kyritsi et al. 2003. “Effect of antenna polarization on the capacity of a multiple
element system in an indoor environment,” IEEE JSAC, Vol. 20, No. 6,
pp. 1227–1239.
11. D. Chizhik, et al. 2002. “Keyhole, correlations, and capacities of multielement
transmit and receive antennas,” IEEE Trans. on Wireless Comm., Vol. 1, No. 2,
pp. 361–368.
12. R.U. Nabar et al. 2002. “Performance of multiantenna signaling techniques in
the presence of polarization diversity,” IEEE Trans. on Signal Processing, Vol. 50,
No. 10, pp. 2553–2562.
13. L. Liu and H. Jafarkhani. 2005. “Application of quasi-orthogonal space-time
block codes in beamforming,” IEEE Trans. on Signal Processing, Vol. 53, No. 1,
pp. 54–63.
14. G. Jongren, M. Skoglund, and B. Ottersten. 2002. “Combining beamforming
and orthogonal space-time block coding,” IEEE Trans. on Inform. Theory, Vol. 48,
pp. 611–627.
15. Z.J. Yao et al. 1999. “Micromachined low-loss microwave switches,” J. Micro-
electromech. Syst., Vol. 8, No. 2, pp. 129–134.
16. J. Papapolymerou et al. 2003. ”Reconﬁgurable double-stub tuners using MEMS
switches for intelligent RF front-ends,” IEEE Trans. Microwave Theory and Tech-
niques, Vol. 51, No. 1, pp. 271–278.
17. N.S. Barker and G.M. Rebeiz. 1998. “Distributed MEMS true-time delay phase
shifters and wide-band switches,” IEEE Trans. Microwave Theory and Techniques,
Vol. MTT-46, No. 11, pp. 1881–1890.
18. C.L. Goldsmith et al. 1999. “RF MEMS variable capacitors for tunable ﬁlters,”
Int. J. of RF and Microwave Computer-Aided Eng., Vol. 9, No. 4, pp. 362–374.
19. E.R. Brown. 1998. “RF-MEMS switches for reconﬁgurable integrated circuits,”
IEEE Trans. Microwave Theory and Techniques, Vol. MTT-46, No. 11, pp. 1868–1880.
20. C.H. Chang et al. 2002. “RF MEMS capacitive switches fabricated with HDICP
CVD SiNx,” IEEE MTT-S Dig., pp. 231–234.
21. R. Garg et al. 2001. Microstrip Antenna Design Handbook, Norwood, MA: Artech
House, chap. 7.
22. Rogers Inc., Chandler, AZ, Microwave Products Tech. Information, 2001.
23. H. Nakano et al. 2002. “Tilted- and axial-beam formation by a single-arm
rectangular spiral antenna with compact dielectric substrate and conducting
plane,” IEEE Trans. Antennas and Propagation, Vol. 50, No. 1, pp. 17–23.


273
10
Multi-Antenna Testbeds for 
Wireless Communications
Raghu Rao, Christian Oberli, Stephan Lang, David Browne, Weijun Zhu, 
Mike Fitz, and Babak Daneshrad
CONTENTS
10.1 Introduction ................................................................................................274
10.2 Testbed Classiﬁcation................................................................................276
10.3 Elements of a Successful Testbed............................................................278
10.4 Hardware Calibration ...............................................................................280
10.4.1 Design Tradeoffs............................................................................281
10.4.2 I/Q Mismatch ................................................................................282
10.4.2.1 A Simulation Model for I/Q Mismatch......................284
10.4.3 Phase Noise....................................................................................285
10.4.3.1 Design of Low Phase Noise Local Oscillators...........286
10.4.3.2 Phase Noise Cancellation in the Demodulator 
by Signal Processing.......................................................288
10.4.3.3 A Discrete-Time Simulation Model for Phase Noise...289
10.4.4 Benchtop Calibration of the 5.25 GHz 2 × 2 MIMO Testbed....290
10.4.5 Radio Receiver Distortion............................................................293
10.4.6 Frequency Offset Calibration ......................................................295
10.4.7 Frequency Response Calibration ................................................297
10.4.7.1 Calibration of Transmitters ...........................................298
10.4.7.2 Calibration of Receivers.................................................299
10.5 Field Test Administration.........................................................................299
10.5.1 Automated Field Measurements ................................................300
10.5.2 Graphical User Interface Design ................................................303
10.6 Field Test Results .......................................................................................304
10.6.1 Measuring the Quality of the MIMO Channel ........................304
10.6.2 Effective Degrees of Freedom (EDOF) ......................................306
10.6.3 Analysis of Field Test Measurements ........................................306
10.6.4 Channel Impact on Space–Time Coding...................................308
References.............................................................................................................312

274
MIMO System Technology for Wireless Communications
10.1
Introduction
For some time researchers around the world have developed testbeds to
further experimental wireless communications research. The work on multi-
antenna systems was initiated at UCLA in 1998 with the high-speed QAM
testbed, which incorporated smart antenna processing to deliver 30 Mbps
in a 5 MHz band [1]. The MIMO narrowband testbed described in [2] was
the ﬁrst MIMO testbed reported in the literature. This was followed by a
fast frequency hopping spread spectrum testbed in 2001 [3] and, ﬁnally, two
broadband MIMO-OFDM testbeds were recently completed [4,32].
The investment of time, money, and resources required to see a testbed
development through is enormous, and it often confronts research teams
with the following questions:
•
Why is a testbed needed and how can the associated expenditure of
time, money, and resources be justiﬁed?
•
Should it support real-time or non-real-time operation?
•
What elements and components are needed to make the testbed and
the ensuing research successful?
Perhaps the ﬁrst question is the most important one to answer. Invariably,
in any organization, one ﬁnds the “simulation-only” camp that advocates a
simulation-only approach to system development. In the past, many semi-
conductor vendors have gone straight to silicon after exhaustive simulations
and have had successful products. So is a testbed really necessary? The answer
resides in the maturity of the technology, market, and communication par-
adigms that one faces. If the characteristics of a medium are well understood,
or the worst-case channel conditions are speciﬁed in a standard, and the
imperfections of the analog circuits have been thoroughly documented, then
a simulation-only approach will sufﬁce. This might be the case for traditional
wireline communications or even narrowband cellular communications.
However, it is most certainly not the case with MIMO systems, which are
ushering in a paradigm shift in wireless data communications, namely the
exploitation of the spatial dimension in addition to time and frequency for
the transmission of signals.
More generally, our experience has shown that a testbed is justiﬁed if one
or more of the following conditions are met:
•
There is no accurate model of the channel.
•
The RF impairments are not known, or if they are known, their
impact on the performance of the wireless link is ambiguous.
•
Long-term behavior (continuous operation over many hours) of the
algorithms and/or hardware are not known.
•
Accurate modeling of the interference seen by the unit due to net-
worked operation is unknown.

Multi-Antenna Testbeds for Wireless Communications
275
Given the current state of research and commercial activity in the area of
MIMO communication systems, it is safely stated that all of the above four
conditions are met, either in part or in full. Channel models exist, but are
rudimentary and do not properly model the angle of arrival of the rays and
the correlation between signals coming into each receive antenna. The RF
impairments are not new for MIMO systems; however, the magnitude of
their impact on the underlying performance of the system is not known. For
example, the impact of an imbalance between the in-phase and quadrature
rails (I/Q Imbalance) in RF architectures with zero-IF is substantially more
detrimental in MIMO than in traditional SISO systems. Similarly, the effect
of any coupling of signals from different RF chains on the resulting perfor-
mance is unknown. The decoding algorithms needed for MIMO systems are
also new and untested for long-term operation. Drifts of adaptive algorithms
due to ﬁxed precision implementation and/or bounds on performance for
long-lasting links are all unknown. Finally, the performance of MIMO-
enabled nodes in the presence of random network interference is unknown.
All of this helps motivate and justify testbed development and experimental
research in the area of multi-antenna systems.
This chapter provides insight into the development process of wireless
communications testbeds, starting with the classiﬁcation of testbeds to
deployment and ﬁeld measurements with them. To serve as examples, three
particular testbeds, all MIMO, will often be referred to. The ﬁrst one is a
mature, narrowband, DSP-based system. It operates in real-time with 4 kHz
of bandwidth in the 220 MHz frequency band. A few interesting test setups
include 3 × 4 MIMO system, infrastructure-based networking with multi-
antenna support at the base station, and ad-hoc networking with multiple
mobile radios. The other two testbeds are both broadband MIMO-OFDM
systems, built by two different research groups with entirely different
research goals. For this reason, the testbed’s architectures are also funda-
mentally different. One team focuses on the design of high-performance
digital VLSI circuits for broadband wireless communications. Accordingly,
their testbed’s RF section was implemented with a zero-IF architecture for
a carrier frequency at 5.25 GHz and a bandwidth of 25 MHz. That choice
revealed the problem of I/Q imbalance in MIMO systems, opening up a rich
ﬁeld for applied research that produced valuable new knowledge. The
results from that testbed shown here correspond to measurements taken
when the testbed had 2 × 2 capabilities with non-real-time baseband pro-
cessing. The other group’s research is motivated by the goal of furthering
fundamental understanding of MIMO communications. Their testbed is,
therefore, an instrument for closing the loop of the scientiﬁc method through
actual ﬁeld experiments and channel sounding. It operates with a bandwidth
of 20 MHz at a carrier frequency of 2.4 GHz. The baseband signals are
digitally up and down-converted from to an IF at 70 MHz.
This chapter is organized as follows. Section 10.2 provides a discussion of
testbed classiﬁcations, followed by the identiﬁcation of the necessary ele-
ments for developing a successful testbed in Section 10.3. Section 10.4 is

276
MIMO System Technology for Wireless Communications
devoted to lessons learned in the course of developing and calibrating the
aforementioned multi-antenna testbeds. Automation of ﬁeld measurement
procedures is treated in Section 10.5, and Section 10.6 provides a summary
of the results obtained using three different MIMO testbeds.
10.2
Testbed Classiﬁcation
The design and development of a testbed is guided by a number of param-
eters derived from the speciﬁc research goal and available funding. While
the research goal itself may range from plain Bit Error Rate (BER) measure-
ments to entire networking experiments, other parameters such as desired
throughput, form factor, conﬁgurability, testbed mobility, development time,
and cost are equally relevant. As a whole, all these aspects are tightly coupled
with two fundamental properties of a testbed, namely:
1. The technology of choice for implementing the testbed’s baseband
processing engine
2. Whether the testbed can operate in real-time or not, i.e., whether the
processing power at baseband is required to match the throughput
of the testbed’s RF section or not
The above two qualities are, of course, not independent of each other: they
are coupled through the bandwidth (or throughput) of the system. The
situation is shown in Figure 10.1.
Considering the above two categories, perhaps the simplest type of testbed
is a software-based, non-real-time system. This approach is often used as a
FIGURE 10.1
Real-time operation of a testbed as a function of system bandwidth and baseband processing
technology. The boundary between real-time and non-real-time operation moves right as the
technology of integrated circuits progresses.
ASIC 
FPGA 
DSP 
SW 
Real-time 
Bandwidth 
Non-real-time 

Multi-Antenna Testbeds for Wireless Communications
277
starting point in the implementation of more hardware intensive and/or
real-time testbeds, although it may serve as a ﬁnal goal as well. It typically
involves designing and fabricating (or purchasing) the RF front-end mod-
ules, plus buffering interfaces and a software-based, PC-hosted baseband
processing engine wrapped around them. Overall, such a system has a short
development time and low cost.
Although unable to provide real-time functionality, a software-based for-
mulation is very valuable during the initial phase of development because
it provides great ﬂexibility for conﬁguring and blueprinting a more complex
platform. For instance, it allows for developing the transmission format (e.g.,
a packet structure) that best ﬁts the research goals, and for testing algorithms
for synchronization, channel estimation, equalization, etc. These software
tools also serve as an important reference point for calibrating ﬁxed-precision
implementations in a later stage of development.
This kind of testbed is not a “one-box” solution; they are difﬁcult to
transport for demonstration purposes and do not lend themselves well to
experiments with mobility, although it is possible to use them for collecting
BER statistics in stationary conditions, while measuring packet or network-
level performance would be cumbersome and slow.
When real-time operation is necessary (e.g., for communications with feed-
back), several options are available depending on the targeted bandwidth
and desired throughput of the system. If it is relatively low, then real-time
implementations are feasible at low cost with commercially available pro-
grammable Digital Signal Processors (DSPs), which replace the PCs and
memory boards of the software-based testbed described earlier. On the other
hand, when sustained high throughput is required, dedicated Field Program-
mable Gate Array (FPGA)-based solutions, and even developing Applica-
tion-Speciﬁc Integrated Circuits (ASICs) become appropriate — the latter at
much increased cost (Table 10.1).
A DSP-based, real-time system requires signiﬁcantly less development
time than an FPGA or ASIC-based solution (Table 10.1). Its capability enables
one to collect performance statistics at a packet level and over extended
periods of time, making it well suited for networking experiments. In addi-
tion, the real-time nature of this kind of testbed allows for the system to be
used as a simulation accelerator.
Dedicated ASICs take time to design and are not reconﬁgurable, and even
though FPGAs provide the ﬂexibility, the hardware design process itself can
be time-consuming. Nevertheless, these alternatives have a small form factor
TABLE 10.1
Cost and Development Time for Various Baseband 
Processing Technologies
SW
DSP
FPGA
ASIC
Hardware Cost
Low
Low-Medium
Low-Medium
High
Development Time
Short
Medium
Medium-Long
Long

278
MIMO System Technology for Wireless Communications
and are ideal for ﬁeld trials that involve mobility and networking experi-
ments. ASICs for communication applications also provide graduate level
research opportunities in a variety of topics involving efﬁcient signal pro-
cessing architectures for VLSI implementation.
10.3
Elements of a Successful Testbed
A testbed has a progressively greater chance for success as it increasingly
captures the following ﬁve characteristics:
1. The testbed is thoroughly calibrated,
2. The testbed interfaces easily to a realistic simulation or emulation
platform,
3. The testbed is easily and quickly conﬁgurable,
4. The testbed has mechanisms to highly automate ﬁeld testing,
5. The testbed reﬂects design tradeoffs that will be present in the ﬁnal
system implementation.
These ﬁve characteristics ensure that the testbed experience is fruitful and
efﬁcient. Much of the work in a testbed development is spent explaining
experimental data that behave in unexpected ways. Most often (in the
authors’ experience) the unusual behavior is a function of the experimental
hardware used in the testbed, while less often the unusual behavior is due
to interesting characteristics of wireless propagation and communication
algorithms. The above ﬁve characteristics allow the engineering team to
quickly isolate the source of the unusual behavior and quickly address the
issue by (1) attempting to change the experimental hardware or (2) collecting
enough data to write a paper of archival quality on the unusual characteristic.
The remainder of this section will highlight the important aspects of the ﬁve
elements of a successful testbed.
Calibration: Thorough quantiﬁcation of the testbed’s performance is essen-
tial for understanding the experimental results. Testbed development should
only be attempted by teams that are willing to engage in a slow, methodical
development effort. The best approach is to have integration of the testbed
take place by slowly adding in components of the testbed and completely
calibrating the performance. As a minimum, it is important to integrate a
communication system (1) at the baseband algorithm level, (2) at the base-
band plus radios in a cabled environment, (3) with a full system using
channel emulation, and ﬁnally (4) a full over the air system. The testbed
must be calibrated at each step of the way and compared to any theoretical
performance bounds that might be available. In a testbed development there
will be performance anomalies, hardware issues, and component failures.

Multi-Antenna Testbeds for Wireless Communications
279
These issues will be much easier to debug if calibration has been completed
and documented in a variety of conﬁgurations. In addition, the calibration
often makes it apparent that hardware imperfections need to be compensated
to achieve the desired performance. The sequel will discuss several of these
hardware imperfections, e.g., I/Q imbalances and phase noise, and how
compensation was implemented to get better performance in the testbed.
Interfacing easily to a realistic simulation or emulation platform: Having an
associated emulation and simulation facility for the testbed allows one to
hypothesize about performance characteristics and troubleshoot system
issues. A critical aspect of a testbed development is the ability to model
performance anomalies in a controlled simulation environment. A testbed
radio system is an imperfect system, and some of these imperfections can
cause noticeable degradations. Having a simulation and emulation system
enables the development team to discern which characteristics are important
and which are not.
Conﬁgurability: Being able to rapidly and reliably conﬁgure the testbed
produces a system that is more useful in experimental research. The primary
(and perhaps only) users of a testbed are its developers. They spend time
developing applications, troubleshooting, running calibration tests, running
ﬁeld tests, and doing demonstrations. Similarly, all of the work to be done
on the testbed for both development and testing will require compiling and
running software (C or DSP code) or ﬁrmware (embedded software or FPGA
code) on the target system on a frequent basis. Each of these uses of the
testbed is greatly facilitated by having the testbed conﬁguration automated,
remotely controlled and by having initialization scripts centralizing the def-
inition of all the important parameters in one conﬁguration ﬁle.
A major use of the testbed is also in marketing the research. People tend
to understand and appreciate work to a much greater degree when it can
be seen in action, so being able to quickly and efﬁciently prepare a demon-
stration of a testbed is a very important aspect of making it successful.
Automated test mechanics: Automated ﬁeld testing improves the efﬁciency
of use of engineering resources. While members of the testbed development
team enjoy getting out to ﬁeld test their algorithms and systems and seeing
the fruits of their labor, their joy is short-lived when an engineer begins to
realize that statistically signiﬁcant data collection will be time-consuming.
The manager also does not enjoy seeing high-priced talent reduced to manual
labor (moving antennas and pushing buttons to start tests). Consequently,
ﬁeld tests should be automated to as high a degree as possible.
A wireless modem’s performance is strongly dependent on the channels
over which the transmission takes place. Therefore, to get a good under-
standing of a modem performance, a statistically signiﬁcant number of chan-
nel realizations are needed. These channel realizations can be obtained by
moving either the transmit or the receive antennas to different positions. In
this respect, there are two types of performance averages that are of interest:
(1) local averaging and (2) macroscopic averaging. In a local average the
antenna deployment will be moved around in an area with dimensions on

280
MIMO System Technology for Wireless Communications
the order of tens of wavelengths. This motion of the antennas will give
statistical averages corresponding to the local fading caused by the multi-
path. Section 10.5.1 discusses an automated testing technique that gives local
averaging for wireless local area networking applications. Macroscopic aver-
aging, on the other hand, is also necessary to understand the performance
of a wireless modem in a wide variety of link geometries, e.g., indoor vs.
outdoor or line-of-sight vs. rich scattering conditions. Macroscopic automa-
tion is a bit harder to achieve, but it can be attained in certain situations (e.g.,
by deploying on buses or taxis). The automation of these testing environments
to as large a degree as possible is very important to gathering statistically
signiﬁcant amounts of data while efﬁciently using engineering resources.
Representation of design tradeoffs: In general, there are two purposes for a
testbed: (1) being a research platform for understanding wireless channels and
modulations, and (2) being a technology prototype for understanding the issues
of building a particular wireless application. The testbed’s architecture
should match the goal. A research platform should have high performance
components so that the resulting performance is a function of the channel
and of the proposed algorithms and not a function of the hardware imple-
mentation. For instance, the authors’ experience recommends that a research
testbed should use a digital IF, Nyquist sampling, and a digital down-
converter chip. While this architecture uses signiﬁcant power, it does not
have I/Q mismatch as in a direct down-conversion receiver (as explained
later in Section 10.4). Alternatively a technology prototype for a low cost
commercial application should have a much less capable radio system, so that
the algorithm development and testing can be done with realistic impairments.
In summary, testbed development should be carefully planned. To achieve
the goals of a testbed, the architecture must match the application. The most
efﬁcient use of engineering time is achieved with automated conﬁguration and
testing. The productivity and output of the testbed will be maximized by a
careful calibration and by having a companion software simulation and emu-
lation environment. While each of these issues might seem to be over-engineer-
ing for some applications, experience has shown that all signiﬁcant testbed
applications beneﬁt from a design ﬂow that uses all of these characteristics.
10.4
Hardware Calibration
Calibration is about quantifying the performance of a testbed under all the
operating conditions that will be found during the ﬁeld measurement cam-
paign, and about satisfactorily explaining any performance loss with respect
to an ideal system. The performance loss, often called implementation loss, is
usually a result of hardware imperfections, but can also be related to imple-
mentation issues such as ﬁxed-point processing at baseband. Thus, before
the testbed is ready for ﬁeld deployment, it must be calibrated (1) under

Multi-Antenna Testbeds for Wireless Communications
281
controlled conditions in the laboratory (“benchtop calibration”) and (2)
under ﬁeld conditions (“ﬁeld calibration”), in that order. While benchtop
calibration usually includes adjustable attenuated, wired links between
transmitter and receiver branches recreating an additive white Gaussian
noise channel (AWGN), ﬁeld calibration may be attained in the lab by emu-
lating the channel properties that will be found in the ﬁeld, and by comparing
the observed performance with simulations.
10.4.1
Design Tradeoffs
The main calibration issues arise from three speciﬁc design tradeoffs. Each
one is described next.
Zero-IF or digital-IF architecture: Two main approaches may be taken for
up- and down-converting the baseband signals to and from RF. The ﬁrst one
(“digital-IF”) considers a digital up-conversion to an intermediate frequency
(IF), followed by a D/A conversion and ﬁnally the up-conversion to the
carrier frequency (and vice versa for the down-conversion process). The
2.4 GHz MIMO-OFDM testbed uses this approach. The second option (“zero-
IF”) considers the direct D/A conversion of the baseband in-phase (I) and
quadrature (Q) rails separately, and then up-converting them to the carrier
frequency. The 5.25 GHz MIMO-OFDM testbed uses this architecture. The
main disadvantage of a zero-IF approach is I/Q mismatch, i.e., an imbalance
of gain, phase and/or delay between the I and Q rails that occurs due to
independent analog circuitry at baseband [8]. The problem can be entirely
avoided by using digital-IF architectures. However, this solution requires
higher sampling rates and higher power consumption. Most of the popular
transceiver ICs, especially in the 2.4GHz and 5GHz bands, are zero-IF sys-
tems and, hence, these architectures are common in commercial wireless
devices. Therefore, when building prototype testbeds, I/Q mismatch will
typically be an issue that needs to be addressed.
Signal distribution: A major issue in multiple antenna testbeds is the distri-
bution of signals such as clock, Local Oscillator (LO), and control signals
[22]. The problem is two-fold: ﬁrst, the cabling between the many circuit
boards in a MIMO system can be confusing and often leads to a much larger,
complex setup. Second, the performance of the MIMO system is degraded
when these signals are distributed over long cables.
The three main approaches for the distribution of signals in MIMO systems
are discussed next, each one with its own strengths and weaknesses. The
ﬁrst approach is to centralize the distribution of the clock, control, and LO
signals on a single board. A single clock source, based on a crystal oscillator,
generates the basic timing signal. It could be the sample rate of the D/A
converter at the transmitter side or the sampling time of the A/D converter
at the receiver. This clock signal is also used on the centralized circuit board
to generate the LO signals by means of PLLs. The clock, control, and LO
signals are then distributed to all branches with appropriate cables and cable
drivers. One caveat is that cable drivers for the distribution of the clock signal

282
MIMO System Technology for Wireless Communications
add jitter to the clock and can affect the performance of A/D and D/A
converters. On the other hand, the advantage is that all the branches run
synchronized off a common clock signal, which eases frequency offset com-
pensation at the receiver. A power splitter is needed for the distribution of
the LO signals to all the braches. Because of the inherent loss of power
splitters, the LO signal needs to be generated with a higher power, which
in turn increases its phase noise. Nevertheless, the phase noise properties of
all the branches are correlated, and therefore, its effect can be cancelled easily.
The cabling effort in this ﬁrst approach is the most involved, as all the signals
are centralized.
In the second approach, the clock and the LO generation are implemented
on each of the transmitter and receiver branches’ circuit boards, whereas the
control signals are centralized. This architecture reduces jitter on the clock
and lowers phase noise of the LO signals, but the drawback is that all the
transmitters and receivers run off different clock sources and are therefore
not synchronized. This issue must be addressed with baseband signal pro-
cessing. In addition, with this alternative, the LO signals in each branch have
uncorrelated phase noise properties. The cabling effort in the second approach
is the least complex, as most of the signals are generated in a distributed fashion.
The third approach is a mix of the ﬁrst two. The clock and control signals
are centralized, but the LO signals are generated on each of the transmitter
and receiver circuit boards. This guarantees frequency lock among all the
branches, but the LO signals have uncorrelated phase noise properties. The
cabling effort in this approach is similar to the second approach.
Build or buy: A third important design tradeoff in testbed development is
whether to develop the testbed’s circuit boards in-house or to outsource
them or use commercially available products. The question includes both
RF as well as baseband circuitry. Developing circuits in-house requires time
and know-how but is the most ﬂexible solution as it is custom made. Out-
sourcing the design of radios or baseband processing boards (to name a few)
helps overcome time and know-how limitations but tends to make it harder
to isolate problems and to correct them with a better design. Finally, off-the-
shelf solutions may provide the quickest way to set up some modules of a
testbed, but are more often than not immature, poorly documented, and
weakly supported products due to their recent entry into the marketplace.
This is also the least ﬂexible solution.
The sequel illustrates and exempliﬁes the authors’ experience with the
above tradeoffs during the calibration process of the three MIMO testbeds
introduced in Section 10.1.
10.4.2
I/Q Mismatch
During the calibration of the 5.25GHz MIMO-OFDM testbed, an error ﬂoor
was encountered at 22 dB of SNR. This was identiﬁed to be caused by I/Q

Multi-Antenna Testbeds for Wireless Communications
283
mismatch. It was corrected on the testbed at the receiver using baseband
signal processing techniques that removed the error ﬂoor [8,9].
I/Q mismatch is associated with a link (from transmitter to receiver), i.e.,
I/Q mismatch at the transmitter can combine either constructively or
destructively with the I/Q mismatch at the receiver, causing a certain amount
of performance degradation. For SISO systems, I/Q mismatch is usually
modeled as being lumped at the receiver, where baseband correction algo-
rithms are employed to remove the mismatch. In MIMO systems, however,
there are M × N links and I/Q mismatch of each of the M transmitters
combines differently with the I/Q mismatch of each of the N receivers.
Therefore, it cannot be modeled by lumping at the receiver.
I/Q mismatch is an issue in both single-carrier and multi-carrier commu-
nication systems. In single-carrier systems, I/Q mismatch causes a distortion
of the signal constellation. In SISO-OFDM systems, I/Q mismatch causes
interference from the data transmitted on the frequency mirror subcarrier
(Figure 10.2). In MIMO-OFDM systems, the interference is more severe
because data transmitted on the frequency mirror subcarriers of all trans-
mitter branches contribute to the interference. This is illustrated in the con-
stellation plots of Figure 10.3. Notice in Figure 10.3b that the receive diversity
of 1 × 2 SIMO mitigates the impact of I/Q mismatch completely. This, how-
ever, is a suboptimal solution [9].
There are many baseband signal processing techniques for mitigating I/Q
mismatch in both single-carrier and multi-carrier SISO systems [5–9]. These
techniques involve estimating the I/Q mismatch using training sequences
and applying a correction to the I and Q rails at the receiver. Pun et al. [5]
use an adaptive ﬁlter on the baseband I and Q rails to correct frequency
dependent I/Q mismatch. Schuchert and Hasholzner [6] describe an LMS-
based adaptive algorithm to cancel I/Q mismatch in the frequency domain.
In the research related to the development of the 5.25 GHz MIMO-OFDM
testbed, [6] was extended for MIMO-OFDM systems and the new solution was
shown to be the optimal joint MIMO decoder-I/Q mismatch canceller [9,31].
The performance of the optimal I/Q mismatch cancellation algorithm was
tested in real environments. Figure 10.4 plots the Cumulative Distribution
Functions (CDFs) of indoor wireless measurements conducted at UCLA,
FIGURE 10.2
Illustrating the effect of I/Q mismatch on OFDM systems.
Ns
2
N −1
1 
DC 
Frequency subcarriers
Ns–1
1

284
MIMO System Technology for Wireless Communications
with and without I/Q mismatch cancellation for MIMO2×2, SIMO1×2, and
SISO systems. These ﬁgures show that there is a 5dB improvement due to
I/Q mismatch cancellation in a 2 × 2 system, and about 2.5dB in the SISO
and SIMO1×2 cases. This highlights the importance and efﬁcacy of I/Q
mismatch cancellation in MIMO-OFDM systems. It can also be observed
from Figure 10.3(b) and Figure 10.4 that receive diversity (N v 2M) cancels
I/Q mismatch, albeit being a suboptimal solution [9].
10.4.2.1
A Simulation Model for I/Q Mismatch
The models for frequency-dependent I/Q mismatch reported in the literature
are simplistic and consider a linearly varying gain and phase on each of the
subcarriers [5]. I/Q mismatch can be modeled much more realistically (sim-
ilar to what is observed on the testbed) by controlling the gain, phase, and
delay mismatches. The measure of I/Q mismatch used is the average image
suppression (or a plot of the per subcarrier image suppression). On the 2 ×
2 MIMO testbed the average I/Q mismatch is approximately –20dB. This
can be modeled in the simulator by choosing an I/Q gain mismatch of 0.91
dB, delay mismatch of 5% of Ts, and a phase mismatch of 2.8°. This is
illustrated in Figure 10.5.
FIGURE 10.3
4QAM at 40dB SNR in the presence of I/Q mismatch in (a) SISO, (b) SIMO1×2, (c) MIMO 2x2,
(d) MIMO4 × 4.
0.5 
0 
−0.5
−1
−0.5
0 
(a) 
(c) 
(d) 
(b) 
0.5 
1 
−1
−0.5
0 
0.5 
1 
−1
−0.5
0 
0.5 
1 
−1
−0.5
0 
0.5 
1 
1 
0.5 
0 
−0.5
−1
1 
0.5 
0 
−0.5
−1
−1
1 
0.5 
0 
−0.5
−1
1 
SISO
SIMO1×2
MIMO2×2
MIMO4×4

Multi-Antenna Testbeds for Wireless Communications
285
10.4.3
Phase Noise
An important analog impairment in any wireless transceiver is phase noise.
It degrades the performance of the transceiver in the up- and down-conversion
process of the RF chain. The Local Oscillator (LO) signals are not perfectly
sinusoidal, but rather show random ﬂuctuations of the phase/frequency
around the desired LO frequency, which results in skirts in the power spectral
density of the LO signal. The wider the power spectrum skirt, the poorer
FIGURE 10.4
CDF of slicer SNR with and without I/Q mismatch cancellation on the testbed.
FIGURE 10.5
Image suppression (a) on the testbed and (b) in the simulator.
0 
1 
0.9 
0.8 
0.7 
0.6 
0.5 
Probability(slicer SNR ≤ abscissa) 
0.4 
0.3 
0.2 
0.1 
0 
5 
10 
15 
20 
Slicer SNR 
25 
30
SISO, no IQ mismatch 
cancellation 
MIMO, with IQ mismatch 
cancellation 
MIMO, no IQ mismatch 
cancellation 
SIMO, with IQ 
mismatch 
cancellation 
SIMO, no IQ 
mismatch 
cancellation 
SISO, with IQ mismatch 
cancellation 
0 
Power in dB 
−10
−20
−30
−40
0 
Power in dB 
−10
−20
−30
−40
−100
−50
0 
(a) 
(b) 
Subcarriers
50 
100 
−100
−50
0 
Subcarriers
50 
100 
−20.17 dB
−20.40 dB

286
MIMO System Technology for Wireless Communications
the quality of the LO. A simple model for phase noise in a multi-carrier
system is illustrated in Figure 10.6.
This model [10] represents the three components of the power spectrum
skirt: (a) the ideal and desired pulse, (b) close-in phase noise and (c) sideband
phase noise. The close-in phase noise has a relatively high power and is
band-limited by the loop bandwidth of the Phase Locked Loop (PLL) gen-
erating the LO signal. The PLL magniﬁes the close-in phase noise, which
mainly determines the noise performance of the receiver. It can be mitigated
with a proper design of the PLL circuit, as described later. The amount of
the sideband phase noise is mainly given by the phase noise characteristic
of the Voltage Controlled Oscillator (VCO) used in the PLL circuit. In a multi-
carrier system (as shown in Figure 10.6), the close-in phase noise is common
to all the carriers after an up- or down-conversion and can be cancelled in
software. The sideband phase noise overlaps and causes Inter-Carrier Inter-
ference (ICI). The interference due to the superposition of the skirts from all
the other subcarriers is random in nature.
The effects of the phase noise can be reduced by a proper hardware design
or can be cancelled in the demodulator. Both approaches are discussed in
the following sections.
10.4.3.1
Design of Low Phase Noise Local Oscillators
Figure 10.7 shows a block diagram of the PLL circuit that was used to
generate the low phase noise LOs in the 5.25 GHz MIMO-OFDM testbed.
The basic PLL consists of a phase frequency detector (PFD), a charge pump
(CP), a loop lowpass ﬁlter (LPF) and a voltage-controlled oscillator (VCO)
[9,11]. In the feedback loop is a divide-by-N block to generate the high
frequency LOs from the crystal (Temperature Compensated Crystal Oscilla-
tor, TCXO). At the input there is also an input reference divider R. Each block
contributes to the total phase noise at the output [12]. Analysis of the PLL
FIGURE 10.6
Phase noise in multi-carrier transceivers.
Subcarriers
Frequency
(a) Ideal
impulse
(b) Close-
in PN
LO
(c) Sideband PN
Frequency
Power
Frequency

Multi-Antenna Testbeds for Wireless Communications
287
shows that the close-in phase noise can be reduced by minimizing the con-
tributions from the reference and feedback dividers as well as the phase
noise of the TCXO. In addition, choosing the feedback divider N small and
the reference divider R large reduces the close-in phase noise further. For
frequency offsets outside the loop bandwidth, the phase noise is dominated
by the VCO. Figure 10.8 shows the frequency spectrum of the TCXO and
the VCO used to generate the 1.75GHz LO at the transmitter in the 5.25GHz
MIMO OFDM testbed. It can be seen that within the loop bandwidth, the
PLL magniﬁes the phase noise (close-in part). Outside of the loop bandwidth
(sideband part), the phase noise of the PLL converges with the VCO, as
predicted by theory.
For reference, the phase noise measured at 100kHz frequency offset of the
LO frequencies was in the range of –120 dBc/Hz to –105 dBc/Hz for the
5.25 GHz MIMO-OFDM testbed.
FIGURE 10.7
Basic PLL block diagram
FIGURE 10.8
Phase noise power spectral density.
PF D 
÷ N 
÷ R 
TCXO 
CP 
LPF 
VCO 
LO 
− 
+ 
0 
Transmitter LO1(1.75 GHz) 
VCO 
TCXO 
Transmitter LO1(1.75 GHz) 
Phase noise(dBc/Hz) 
−20 
−40 
−60 
−80 
−100 
−120 
−140 
−160 
100 
101 
102 
103 
Frequency oﬀset(Hz) 
104 
105 
106 
107 
108
Close-in PN Sideband PN 

288
MIMO System Technology for Wireless Communications
10.4.3.2
Phase Noise Cancellation in the Demodulator 
by Signal Processing
The effects of phase noise in SISO-OFDM systems has been extensively
analyzed and reported in the literature [13–15]. The results can be extended
to MIMO-OFDM systems. The per-subcarrier received signal after the FFT
can be represented as
(10.1)
where X(ke), Y(ke), and H(ke) represent the transmit data vector, receive data
vector, and the channel matrix, respectively. Ns is the number of subcarriers
and k is the index of the subcarrier under consideration. MIMO decoding
involves reversing the effect of the channel and estimating each of the trans-
mitted data streams by left multiplying Y(ke) in Equation 10.1 with the weight
matrix W(ke), which is an estimate of the pseudo-inverse of the channel
matrix H(ke). The result is
(10.2)
The ﬁrst term represents the estimated data vector. The second and third
terms represent the interference due to phase noise. The second term repre-
sents the “common phase error” (CPE) and is called this because its effect
is an identical phase rotation on all the subcarriers and all the transmit data
streams. This term can be estimated and corrected for every MIMO-OFDM
symbol. The CPE term is also scaled by the transmit signal on each subcarrier.
Therefore, in a MIMO system, as the number of transmit branches increases,
the CPE term decreases. The third term is the sum of the projection of the
phase noise skirts on all the other subcarriers and is commonly called the
inter carrier interference (ICI) due to phase noise. This is random in nature
and needs to be minimized by proper choice of the VCO.
The impact of canceling the CPE part of phase noise was evaluated on the
5.25 GHz 2 × 2 MIMO-OFDM testbed. The results are shown in Figure 10.9.
It can be observed that canceling CPE has a much bigger impact on SISO
systems (approximately 4–4.5dB SNR gain) than on the 2 × 2 MIMO system
(1.5–2 dB SNR gain). This is because the testbed is a power constrained
Y k
H k X k
j
N
l
H k X k
S
l
Ns
( )
( ) ( )
( )
( ) ( )
e =
e
e +
e
e
¬®
¼¾
=
K
0

=

 e
¨
¨
+
1
0
1
2
( )
( ) ( )
(
)
j
N
l
H k X k e
S
l
N
j
l k k
N
s
K
U
S
s
k
k k
N
V k
=
| e

¨
+
0
1
,
( )
ˆ
( )
( ) ( )
ˆ ( )
( ) ˆ ( )
X
k
W k Y k
X k
j
N
l
X k
PN
s
e =
e
e =
e +
e
¬
®
¼
K
¾
=

=

=
¨
¨
+
e
l
Ns
s
l
Ns
k
j W k
N
l
H k X k
0
1
0
1
0
( )
( )
( ) ( )
,
K
k k
Ns
j
l k k
Ns
e
V k
| e

 e
¨
+
e
1
2U (
)
( )


Multi-Antenna Testbeds for Wireless Communications
289
system (the total transmit power is divided equally among the two trans-
mitters), and the CPE term is scaled by the data transmitted on each sub-
carrier of an OFDM system. Therefore CPE cancellation yields a smaller
improvement in the MIMO system. On the testbed, phase noise caused a
performance ceiling at 27dB SNR during the benchtop calibration process,
and it was removed after adding the CPE cancellation algorithm to the
demodulator.
10.4.3.3
A Discrete-Time Simulation Model for Phase Noise
Although analytical results show that the phase noise process has a Power
Spectral Density (PSD) that falls off at 1/f2 [16], in reality (on hardware) the
phase noise PSD ﬂattens out for large frequency offsets [17]. In [18] Salz
mentions (although in the context of laser phase noise) that the spectral
density of this phase noise has a 1/f to 1/f 2 characteristic up to around 1 MHz
offset and is ﬂat for higher frequencies. Also, at very low frequency offsets,
it has a 1/f 3 characteristic [17]. In discrete time simulations, it is difﬁcult to
model phase noise to exactly match with what is measured on the testbed.
Approximate models with a 1/f characteristic are used. Generally, the phase
noise process is modeled with an FIR ﬁlter that is generated with a user-
deﬁned mask as in [15,21]. The user-deﬁned mask is a rough approximation
of the PSD measured using a spectrum analyzer or a phase noise meter.
Although this method can model the phase noise behavior to be close to
what is observed on the hardware, the FIR ﬁlter can be fairly large, and
simulations are slow. An alternative method proposed by Kasdin [19,20] in
FIGURE 10.9
CDF of slicer SNR for indoor wireless measurements with SISO, SIMO1×2, and MIMO2×2 with
and without CPE cancellation.
Impact of phase noise cancellation on the testbed(EE54–114)
Probability(slicer SNR ≤ abscissa) 
1 
0.9 
0.8 
0.7 
0.6 
0.5 
0.4 
0.3 
0.2 
0.1 
0 0 
5 
10 
15 
Slicer SNR 
20 
25 
30 
35 
40 
MIMO, no CPE 
cancellation 
MIMO, with CPE 
cancellation 
SISO, with CPE 
cancellation 
SISO, no CPE 
cancellation 
SIMO, with CPE 
cancellation 
SIMO, no CPE 
cancellation 

290
MIMO System Technology for Wireless Communications
the early 1990s models phase noise using an ARMA process with an IIR
ﬁlter. This is an elegant method that can model any kind of power law noise
(ex. 1/f, 1/f 2, etc.). Although not widely discussed and used in the wireless
communication literature in the context of phase noise, it is a popular method
in industry (an example: MATLAB Simulink). This method was used to
model phase noise in the simulator that was used to analyze and compare
the performance of the 5.25 GHz MIMO-OFDM testbed.
10.4.4
Benchtop Calibration of the 5.25 GHz 2 ×××× 2 MIMO Testbed
This section brieﬂy discusses the results of the entire benchtop calibration
process of the 5.25 GHz 2 × 2 MIMO broadband testbed. The discussion that
follows considers uncoded SISO links, i.e., the wireless channel was replaced
with RF cables and variable attenuators between individual (paired) radio
units, resembling SISO AWGN channels.
The combined effect of CPE phase noise removal and I/Q mismatch can-
cellation is illustrated in Figure 10.10 for the case with 64-QAM modulation
and approximately 20 dB SNR.
Figure 10.11 plots the symbol error rate curves for various signal constel-
lations and compares the testbed with theory and simulation when the
testbed is in perfect-timing mode. This means that the clock signal, which
also drives the LOs, is common to both the transmitter and the receiver units.
The results lie within 1–2 dB of the theoretical curves. The simulator, with
all the analog impairments modeled to match the testbed’s, is within 1 dB
of the testbed’s performance. The slight difference between the simulations
and the testbed is mainly due to the non-white nature of the noise on the
testbed, caused by non-linearities in the RF sections. These were not modeled
in the simulator.
An important metric to measure testbed performance is the implementa-
tion loss, which compares the average SNR at the input of the decision device
FIGURE 10.10
A 64 QAM constellation measured on the testbed at an input SNR of 20dB (a) without I/Q
mismatch cancellation and phase noise (CPE) cancellation, (b) with I/Q mismatch cancellation
but no phase noise (CPE) cancellation, (c) with I/Q mismatch cancellation and phase noise
(CPE) cancellation.
2 
1 
0 
0 
(a) 
2 
−1 
−2 
−2 
2 
1 
0 
0 
(b) 
2 
−1 
−2 
−2 
2 
1 
0 
0 
(c) 
2 
−1 
−2 
−2 

Multi-Antenna Testbeds for Wireless Communications
291
of the receiver (“slicer SNR”) vs. the SNR at the input of the receiver. The
difference in dB between the input SNR and the slicer SNR is the implemen-
tation loss. Figure 10.12 plots the implementation loss of the testbed in perfect
and non-perfect timing modes and compares the results with the simulator.
Also plotted is the implementation loss when the carrier frequency synchro-
nization algorithm is turned on and the testbed is in perfect timing mode.
This quantiﬁes the impact of the frequency offset estimation errors and
allows for incorporating it into the system’s performance data sheet. In
perfect timing mode, when the I/Q mismatch canceller and phase noise
canceller are turned on, the implementation loss is within 2 dB in the entire
SNR range up to 30 dB. However, the loss is higher in the non-perfect timing
mode due to estimation errors in the synchronization algorithms. In this
case, it increases to about 3 dB at an input SNR of 25 dB. It can also be
observed that the carrier frequency offset estimation errors start having an
impact on the implementation loss at about 25 dB, increasing to about 3 dB
at 30 dB. In all these cases, it can be observed that with all the analog
impairments modeled, the simulator matches the testbed very closely. Other
key parameters of the RF and analog frontend (AFE) were measured as well
and are listed in Table 10.2.
FIGURE 10.11
SER calibration curves for the 5.25 GHz testbed over AWGN channel and in perfect timing
mode.
100 
SER for 4QAM, 16QAM and 64QAM 
Theoretical AWGN curves 
Simulation curves 
Testbed 
10−1
16QAM
SER 
10−2
10−3
10−4
10−5
0 
5 
10 
15 
Input SNR (dB)
20 
25 
30 
64QAM 
4QAM 

292
MIMO System Technology for Wireless Communications
FIGURE 10.12
Implementation loss vs. input SNR curves for the 5.25 GHz 2 × 2 MIMO testbed in perfect
timing and non-perfect timing modes.
TABLE 10.2
System Parameters of the 5.25 GHz 2 × 2 MIMO Testbed
Radio architecture
Heterodyne
System setup
2 × 2 (extendible to 4 × 4 antennas)
Carrier frequency
5.25 GHz
Signal bandwidth
25 MHz
Effective bandwidth
21.5 MHz
TCXO temperature stability
<1 ppm (–10°C to +60°C)
Transmitter power
–13 dBm to +18 dBm
Transmitter D/A converter
16 Bits/100 MHz
Receiver noise ﬁgure
7.93 dB
Receiver sensitivity
–99 dBm
Receiver dynamic range
70 dB
Receiver IIP3
–25.4 dBm
Receiver A/D converter
14 Bits/25 MHz or 50 MHz
Image suppression
Approx –20 dB
Local oscillator phase noise
@100 KHz offset
–120 dBc/Hz to –105 dBc/Hz
10 
Comparing perfect and non-perfect timing modes 
9 
8 
7 
6 
5 
4 
3 
2 
1 
0 
16 
18 
20 
22 
24 
SNR 
SNR 
26 
28 
30 
32 
Simulation—non-perfect timing
Simulation—perfect timing, tracking ON
Simulation—perfect timing, no tracking
Testbed—non-perfect timing
Testbed—perfect timing, tracking ON
Testbed—perfect timing, no tracking

Multi-Antenna Testbeds for Wireless Communications
293
10.4.5
Radio Receiver Distortion
An example from the development of the narrowband, DSP-based MIMO
testbed might be illustrative of both the impact of radio distortion and for
the need of emulation and simulation. The narrowband wireless modem was
built and tested in 2002 using the powerful concept of a super-orthogonal
trellis code [39,40]. Simulations of the whole baseband system were com-
pleted and performance looked quite promising (see lower curves on Figure
10.13a). During the calibration stage the system was subject to a real radio
and no fading (benchtop and cabled) and the system had some implemen-
tation loss but otherwise performed well. The next stage of calibration intro-
duced rapid time varying fading with a channel emulator and surprisingly
a signiﬁcant error ﬂoor was produced (see upper curves on Figure 10.13a).
The cause of this degradation was not at ﬁrst apparent.
The source of the degradation was a non-linearity in the radio receiver for
the testbed. The radio was implemented using a single chip radio frequency
transceiver that was designed for GSM applications (Analog Devices
AD607). This radio system caused some signiﬁcant distortions to the received
linear modulated signal because of a signiﬁcant non-linearity in the IF ampli-
ﬁer. This distortion destroyed the Nyquist characteristics of the pulses in the
linear modulation and resulted in signiﬁcant inter-symbol interference (ISI)
(see the scatter diagram in Figure 10.13b). These distortions in a time ﬂat
fading environment did not cause signiﬁcant degradation as the benchtop
calibration tests demonstrated, but for reasons that were not clear at ﬁrst,
these distortions caused signiﬁcant degradations in time varying fading.
After signiﬁcant effort [43] that iterated back and forth between the sim-
ulation environment and the channel emulator, the cause of the error ﬂoor
was identiﬁed. An error ﬂoor is caused by a situation where the distortion
in the radio causes an error in the absence of thermal noise. It is pretty clear
from the scatter plot that in the static channel an error would not be caused
by this ISI. In a rapidly varying channel the situation is signiﬁcantly different.
Two issues impact time varying fading: ISI being relatively larger due to
deep fades and ISI causing biases in pilot symbol-based channel estimation
during a deep fade.
ISI has a bigger impact during a deep fade. In rapid fading the number of
symbols that are impacted by a deep fade is often a very small number.
Consequently, the channel gain for the symbol being detected during a deep
fading can be small, but the ISI, due to the other interfering symbols, can be
large since the channel gain for these symbols is also large. Consequently,
the scatter plot does not directly scale but has a form as seen on the right
side of Figure 10.14. Simulation showed that the error ﬂoor was partially
due to this interaction with fading and ISI.
ISI causes biases in the channel estimation, and this bias is another source
of errors in the absence of noise. This idea can best be explained by examining
the vector diagram on the left side of Figure 10.14. A deep fade occurs when

294
MIMO System Technology for Wireless Communications
a channel makes a trajectory in the complex plane that goes near the origin.
If the pilot symbols are distorted by ISI, the reconstructed channel trajectory
will be in error. When the channel gain is relatively large, a small bias in
channel estimates will not have a big impact. When channel gain is near
zero in amplitude, a small bias in the channel value can actually result in a
deterministic error. This is observed on the left side of Figure 10.14 where
FIGURE 10.13
An example of an error ﬂoor in a space–time modem. (a) Frame error rate, (b) Scatter plot.
100 
10−1 
10−2 
10−3 
0 
5 
10 
Eb/NO dB 
15 
20 
25 
8000 
6000 
4000 
2000 
0 
−2000 
−4000 
−6000 
−8000 
−8000 −6000 −4000 −2000 
2000 4000 
6000 8000 
0 
(b) 
(a) 
Benchtest  fD = 20 Hz
Benchtest  fD = 32 Hz
Simulation  fD = 20 Hz
Simulation  fD = 32 Hz
FER 

Multi-Antenna Testbeds for Wireless Communications
295
the actual channel estimation error is relatively small in magnitude but will
cause a very high error rate since the phase channel estimate is roughly 180°
out of phase with the true channel estimate. Simulation showed that this
bias in channel estimation leads to an error ﬂoor. Without companion sim-
ulation and emulation systems, this error ﬂoor would have been tough to
diagnose.
10.4.6
Frequency Offset Calibration
Accurate frequency offset calibration (i.e., compensation) is fundamental in
channel sounding applications of testbeds. In these cases, the transmissions
rarely have provisions for running synchronization algorithms at the receiver.
Therefore, the frequency offset must be measured between all transmitter-
receiver branch pairs prior to the ﬁeld measurement campaign. This section
describes the corresponding procedure.
The sequel derives the mathematical model for the effect of frequency
offset among transceiver branches in the most general case, which corre-
sponds to the second approach discussed in Section 10.4.1 on distribution
of signals in MIMO systems. The ﬁrst and third approaches are special cases
of the results that follow.
The baseband signal at the mth transmitter branch is modeled as:
(10.3)
where
is the relative frequency and relative initial phase
modulation introduced by the transmitter branch m with respect to the ideal
carrier frequency and phase. xm(t) is the nominal transmit signal. Similarly,
the baseband signal at each receiver branch is modeled as:
FIGURE 10.14
Causes of performance degradation in rapid fading.
Ci(t) 
True channel 
Channel due to ISI 
Pilot position 
Channel estimate 
Cq(t) 
t 
C(t) 
ˆx
k
t x
t
m
m
m
	
( )
( )
k
t
e
m
j
m t
m
( ) =
+
2U^
V

296
MIMO System Technology for Wireless Communications
(10.4)
where
is the relative frequency and relative initial phase mod-
ulation introduced by the receiver branch n and yn(t) is the nominal received
signal. The frequency offsets and phase offsets are represented by the vari-
ables {^m, ^n} and {Vm, Vn}. The time index, t, is implied in the variables {km, gn}
for notational simplicity.
The frequency and initial phase offset are incorporated in the MIMO signal
models according to:
(10.5)
where
the distorted channel matrix is given by:
(10.6)
which assumes the channel matrix H to be static during the observation time,
and with K and G corresponding to the unitary (time-dependent) distortion
matrices due to the frequency offsets at transmitter and receiver branches,
respectively. K and G are given by:
(10.7)
The model of Equation 10.6 shows that all the frequency offset distortion
can be removed at the receiver. This requires estimating all the )^ (m, n) =
^m – ^n and all the )V (m, n) = Vm – Vn. For channel capacity calculations, the
initial phase offset between the mth transmit branch and nth receiver branch,
)V (m, n) = Vm – Vn, can be neglected. Note that for an M × N MIMO system,
there are MN frequency offsets between the transmitter and receiver radios
that must be determined.
ˆy
g
t y
t
n
n
n
	
( )
( )
g t
e
n
j
nt
n
( ) =
+
2U^
V
Y
Y t
H t X t
N t
HX
N
	

	 
( )
=
( ) ( ) +
( )
+
H
 	 

H
H t
KHG
k h g
k h g
k h
g
k h g
k
N
N
( )
=
=
1
11
1
1
12
2
1
1
2
21
1
22
22
2
11
1
h g
k h g
k h
g
M
M
MN
N


¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
K
k
k
k
G
g
g
g
M
N
=
¬
®
­
­
­
­
­
¼
¾
½
½
½
½
½
=
¬
®
­
­
­
1
2
1
2
0
0
0
0


,
­
­
¼
¾
½
½
½
½
½

Multi-Antenna Testbeds for Wireless Communications
297
A method for estimating all )^ (m, n) and )V (m, n) in MIMO-OFDM sys-
tems by measuring Inter-Carrier Interference (ICI) is described next. The
effect of a frequency offset in OFDM systems is to cause ICI at the receiver’s
FFT output. The sensitivity of the ICI to frequency offset is illustrated in
Figure 10.15, where the ICI power is plotted for a single subcarrier as a
function of a parameter called the tuning offset, )T (m, n). The tuning offset
sweeps all the possible compensation values for )^ (m, n). When it takes the
value )T (m, n) = –)^ (m, n), it eliminates ICI, revealing )^ (m, n).
With this idea, benchtop calibration of the MN frequency offsets in a
MIMO-OFDM system is attained using a pilot signaling scheme similar to
that described in [33]. This scheme uses pilot tones distributed orthogonally
in space and time. The transmitter branches broadcast these pilot signals
over the air, and the received signal in the nth receiver is tuned across a range
of frequencies as shown in Figure 10.15. The ISI due to the mth transmitter
will be minimized when )T (m, n) = –)^ (m, n). Repeating this tuning proce-
dure for each of the MN transmitter/receiver pairs will then fully character-
ize the frequency offset between all radios. Finally, the frequency offset may
vary slowly as a function of time due to changes in temperature in the radio
hardware. In this case, the characterization must be repeated regularly.
10.4.7
Frequency Response Calibration
Wideband transceivers almost never have ﬂat frequency responses in their
passband. Figure 10.16 shows the measured frequency response for one of
the upconverter radios used in the 2.4 GHz MIMO-OFDM testbed. There is
FIGURE 10.15
Power as a function of tuning frequency for a single subcarrier in an OFDM system ()f (1,1) =
12.5 kHz).
−50 −40 −30 −20 −10 
0 
10 
20 
30 
40 
50 
−80 
−75 
−70 
−65 
−60 
−55 
−50 
−45 
Tuning oﬀset (kHz) 
ISI power(dB)

298
MIMO System Technology for Wireless Communications
a notable 2-dB slope and ripples across the passband. More severe cases with
a 5-dB change across the passband were measured for other radio units. The
ripple and slope in the transceiver’s power spectrum is not usually an
important issue for tests involving error rate measurements in data commu-
nications because these non-idealities are considered part of the channel
response. However, uncharacterized non-ideal power spectra are problem-
atic when the testbed is used for MIMO channel sounding. For such appli-
cations, each radio’s frequency response must be characterized as part of the
calibration procedure. The basic procedure to calibrating a M × N MIMO
transceiver is outlined next.
10.4.7.1
Calibration of Transmitters
The strategy is to generate a known signal that can be used to probe the
transceiver’s spectrum across the entire transmission band. Two approaches
are feasible for generating such a signal: a sweep-frequency tone generator
or a wideband signal generator together with a spectrum analyzer.
The swept-frequency tone generator approach is simplest and involves
exciting the transmitter with a single tone whose frequency is stepped at
regular frequency intervals across the input band. An attenuator is placed
between the transmitter and spectrum analyzer to reduce the signal power
to a level that is safe for the analyzer. The spectrum analyzer then records
the (attenuated) transmitter output signal in peak-hold mode. Figure 10.16
is an example of the resulting spectrum using this technique. The disadvan-
tage of this method is that the peak-hold function records the larger peak
noise, instead of an average noise.
The second approach is to excite the transmitter with a set of evenly spaced
tones across its input band. This approach requires a wideband signal gen-
erator that can synthesize a user-deﬁned signal. A suitable signal design is
proposed in [33]. The spectrum analyzer then records the transmitter’s out-
put in averaging mode. The beneﬁt of this method is that zero mean AWGN
is cancelled out by averaging. The drawback is that the equipment required
to generate the wideband excitation signal can be more sophisticated and,
FIGURE 10.16
The measured frequency response spectrum of a transceiver radio in (a) transmit mode and
(b) receive mode.
−12 dBm 
−27 dBm 
2.43 GHz 
2.45 GHz 
(a) 
(b) 
8 dBm 
−12 dBm 
60 MHz 
80 MHz

Multi-Antenna Testbeds for Wireless Communications
299
hence, more expensive than the signal generator used to generate a swept-
frequency tone. Another beneﬁt of using the wideband signal generator in
[33] is that the multiple transmitters in a MIMO system can be calibrated
simultaneously using a M-to-1 RF combiner and a single spectrum analyzer.
This is possible because spatial orthogonality in the excitation signal allows
the combined TX spectra to be separated in post-processing. An example of
the spectrum generated by this approach for a case with four radios is shown
in Figure 10.17. The four transmitter radios used are the same design as the
one shown in Figure 10.16a.
10.4.7.2
Calibration of Receivers
The procedure for calibrating the receivers is the same as that for calibrating
the transmitters except that connections to the inputs and outputs are
swapped. In the case that the signal generator cannot generate an excitation
signal at the radio frequency required by the receiver radio’s input, a calibrated
transmitter radio can be used to up-convert the excitation signal. The trans-
mitter’s output can then be connected through an attenuator to the receiver’s
input.
Once the frequency responses of all transmitter and all receiver branches
have been quantiﬁed, precise channel sounding measurements can be con-
ducted by pre-compensating the signal transmitted on each transmitter
branch, and by post-compensating the received signal of each receiver branch.
10.5
Field Test Administration
Once a testbed is fully calibrated in the laboratory and for its intended
environment, it is ready to be deployed for ﬁeld tests and measurements.
FIGURE 10.17
(a) Measured power spectrum at the transmitter antenna port before pre-equalization by the
transmit DSP and (b) after pre-equalization.
−21
TX1
TX2
TX1
TX2
−22
−23
−24
Power spectrum(dBm)
−25
−26
−21
−22
−23
−24
Power spectrum(dBm)
−25
−26
2.43
2.45
(a)
(b)
Frequency(GHz)
2.43
2.45
Frequency(GHz)

300
MIMO System Technology for Wireless Communications
At this point, the logistics of testbed deployment and data collection become
an important issue. A well-designed Graphical User Interface (GUI) greatly
facilitates setting up the testbed in the ﬁeld and monitoring its operation.
Similarly, the collection of data tends to be cumbersome and labor-intensive
when performed manually, while automating the process allows for exten-
sive data collection in a variety of environments in an efﬁcient and reliable
way. Both topics are addressed in the following sections.
10.5.1
Automated Field Measurements
The following example illustrates the value of automating measurements in
an experiment that tested space–time codec performance. Consider the chan-
nel experienced by a receiver as its antenna array moves within a square
area of 10 wavelengths on a side. The channel variation in such a small area
is due mainly to multipath interference. A typical spatial sampling pattern
used for testing the aforementioned space–time codec is speciﬁed below in
Table 10.3. For comparison, equivalent requirements for testing a SISO codec
are provided. For each spatial sample within the area, a full range of SNRs
is required to stress the codec in both the low and high capacity regions of
the channel realization associated with that spatial sample. This sampling
strategy ensures that the codec is subjected to a sufﬁcient range of channels
and noise realizations to give a good approximation of its performance at
the microscopic (local) level. Several areas have to be measured in this way
to subject the codec to a range of macroscopic channel characteristics in the
larger environment.
A measurement proceeds according to the pseudo code given below. Lines
2–10 in the Measurement Pseudo Code can be executed automatically by a
single component in a MIMO testbed provided that (1) all components of
the testbed are able to communicate and (2) the spatial sampling can be
performed robotically. The 5 seconds allocated to each measurement (cf.
Table 10.3) include the time to execute lines 3–6 in the pseudo code. It is
clear from this example that acquiring a large data set requires a signiﬁcant
TABLE 10.3
Measurement Budget
SISO Case
MIMO Case
Sampling grid size
10Q x 10Q square
10Q x 10Q square
Spacing between grid points
0.5Q
0.5Q
Antenna array geometry
Not applicable
Linear
Antenna spacings
Not applicable
0.5Q, 1Q, 1.5Q, 2Q
Total number of spatial samples
21*21 = 441
21*21*4 = 1764
Measurement interval
5 seconds
5 seconds
Measurement time per grid
441*5 = 38 minutes
1764*5 = 2.4 hours
Number of locations in environment
10
10
Total Experiment Time
38*10 = 6 hours
2.4*10 = 24 hours

Multi-Antenna Testbeds for Wireless Communications
301
time investment. It would be impossible to manually place the antenna array
and to trigger the radio hardware with the allotted time per measurement
(and, at any rate, it would be a very inefﬁcient use of qualiﬁed personnel).
Measurement repeatability and system reliability are other essential charac-
teristics that would be challenging for the test engineer to achieve but are
easily achieved with automation.
A testbed conﬁguration with the above capabilities is illustrated in Figure
10.18. Robotic antenna arrays are responsible for spatial sampling by moving
the transmitter and receiver antenna arrays according to the spatial pattern
deﬁned in Table 10.3. TCP/IP connectivity allows any terminal on the Inter-
net to control both radios and robots remotely.
An effective and affordable solution to automating spatial sampling can
be realized from LEGOTM Mindstorms components and open source software
[32]. Two such robots are shown in Figure 10.19 and Figure 10.20. These
robots have a 1.59 mm positioning resolution and a 70 × 70 cm positioning
range. These dimensions are well suited to communications within the
1–10 GHz band where wavelengths (30–3 cm) are on the same order of
magnitude that can be achieved by Lego structures. The Lego system allows
the robots to be conﬁgured modularly so that as many as four antennas can
be move independently in azimuth. The software that controls the robots is
comprised entirely of Java-based code and allows the end user to control
the robot with high level commands (move, reset, calibrate, etc.). These
commands can be issued via TCP/IP as text strings, thereby enabling control
from any application that supports TCP socket communications (C++,
MATLAB, web browser, etc.).
Remote control of the robots is enhanced by using a web camera to stream
live video of the robot’s activity over the Internet. In the case of a mechanical
failure, the robots can alert the remote user of the problem by e-mail. This
affords the user the option of checking the experiment’s progress intermittently,
Measurement Pseudo Code
1
For each location in the environment
2
For each antenna separation
3
For each point in the sample grid
4
Encode data and transmit signal
5
Receive signal decode data
6
Tabulate information error rate
7
Move to the next point in sample grid
8
end
9
Change array geometry
10
end
11 move to the next location in the environment

302
MIMO System Technology for Wireless Communications
instead of requiring constant vigil over long and tedious experiments.
Another great convenience of the automation system is that it allows a single
user to simultaneously control and monitor both the transmitter and receiver
FIGURE 10.18
A highly automated MIMO testbed.
FIGURE 10.19
Four-antenna transmitter and robotic antenna array.
Space–time
digital radio
Transmitter node 
Receiver node 
Space–time
digital radio
Video 
camera 
Video 
camera 
Control 
terminal 
Control 
terminal 
Robotic
antenna array
Robotic
antenna array
Radio 
channel 
TCP/IP internet 
Remote 
control 
terminal 
Operator
(anywhere)

Multi-Antenna Testbeds for Wireless Communications
303
units even though they may be located in different parts of a building or
neighborhood. This would otherwise require a minimum of two users.
10.5.2
Graphical User Interface Design
One vital feature of a testbed is to have well-designed Graphical User Inter-
face (GUI) for controlling its operation. In the authors’ experience, the test-
bed’s capabilities can be exploited at a maximum if the GUI provides the
following features:
1. Immediate (quasi real-time) feedback of test results and environ-
mental conditions
2. High ﬂexibility for conﬁguring and controlling system parameters
“on the ﬂy”
3. A clear and easy-to-understand interface for demonstrating the test-
bed’s capabilities and features to third parties
Each of these three points is described in detail next.
Quasi real-time feedback: A GUI’s capability for reporting transmission
results and testbed status in real-time or immediately following transmission
simpliﬁes the data collection and speeds up the measurement process. It
maximizes the efﬁciency of ﬁeld measurement campaigns by allowing for
early detection of system failure, quick troubleshooting, and on-site assess-
ment of the environment’s validity for the desired test (e.g., channel condi-
tion, SNR, etc.). Useful information to display includes error statistics, signal
and noise power, scatter plots, instantaneous channel state information,
channel capacity, etc.
FIGURE 10.20
Four-antenna receiver radio and robotic antenna array.

304
MIMO System Technology for Wireless Communications
On-site conﬁgurability: A testbed is often very ﬂexible in terms of system
parameters and algorithm components. However, this ﬂexibility is of limited
use if it cannot be exercised quickly and with little effort through a GUI that
centralizes the conﬁguration of system parameters. Similarly, in some cases
a transmission may require handling the data ﬂow in sequential steps, and
more often than not, it is useful and even necessary to repeat measurements
in a same setting with different parameters. A GUI can greatly facilitate all these
tasks by providing dialog boxes for manual parameter input as well as push
buttons for automated script execution of commonly repeated transmission
and/or conﬁguration sequences.
Adequate display for demonstration purposes: Exhibiting the testbed to spon-
sors and visitors is very important for the continuous development of the
testbed. Unfortunately, people who see a demonstration of the testbed often
do not have a strong background in theory or implementation of wireless
communication systems. This suggests that a GUI designed solely for mon-
itoring and controlling the testbed at a technical level may not be adequate
for demonstration purposes. Therefore, the GUI should have a mode in
which transmissions can be controlled and results can be observed at a
reduced technical level. A good GUI design and development takes signiﬁ-
cant time; however, it pays off in the long run.
Figure 10.21 illustrates the GUI developed for the narrowband MIMO
testbed. The GUI displays a variety of information at different technical
depths, and it is used for both demonstration and ﬁeld test monitoring. Some
of the components in the GUI are very helpful for troubleshooting. For
instance, the bar plots of the channel powers can help identify which part
of the hardware chain has failed when something is not working as expected.
Tabbed windows are used to extend the display size, and it is especially
useful to switch between information at different technical levels.
10.6
Field Test Results
A variety of tests and measurements can be performed with the testbed
based on its capabilities. This section has a discussion on the metrics used
to measure MIMO system performance followed by some ﬁeld test results
using two different testbeds. Some of these metrics measure the quality of the
wireless channel to sustain MIMO communications, and others measure
the performance of the communication system.
10.6.1
Measuring the Quality of the MIMO Channel
The information theoretic capacity of a MIMO communications scheme is a
function of the average received SNR and the channel matrix. For a given

Multi-Antenna Testbeds for Wireless Communications
305
SNR, the “quality” of the channel matrix determines the achievable capacity.
This can be analyzed by decomposing the channel matrix using the singular
value decomposition (SVD) [23–27].
(10.8)
U and V are unitary matrices and UUH = VVH = I. This can be simpliﬁed to
(10.9)
Xi represents the singular values of channel matrix H. k f min(M, N) is the
rank of the channel matrix H. From Equation 10.9 it can observed that the
total capacity of a MIMO channel is the sum of parallel AWGN SISO sub-
channels, each of which has a gain given by their corresponding singular
values (or power given by their corresponding eigenvalues). When the SNR
FIGURE 10.21
The graphical user interface of the narrowband testbed.
H
U V
C
E
I
M V
V
H
H
M
H
H
=
=
+
©
«ª
¹
»º
¬
®
­
¼
¾
½
¬
®
­
8
8 8
log
det
2
W
­
¼
¾
½
½
bits/sec/Hz
C
E
M
H
i
i
k
=
+
©
«ª
¹
»º
¬
®
­
­
¼
¾
½
½
=¨log2
2
1
1
W X
bits/sec/H
Hz

306
MIMO System Technology for Wireless Communications
is very low, the roughly linear increase in capacity expected with MIMO
systems may not be achieved. Similarly, when there is severe fading corre-
lation, the minimum singular value could be very small thereby signiﬁcantly
reducing the achievable capacity [28,29]. Since the capacity of a given channel
can be expressed in terms of its singular values, these can in turn be used
to measure the “quality” of the channel matrix. One popular metric is the
effective degrees of freedom (EDOF) [28–30].
10.6.2
Effective Degrees of Freedom (EDOF)
Effective degrees of freedom (EDOF), introduced in [28], is a metric that
represents the number of MIMO subchannels actively participating in con-
veying information under a given set of operating conditions. EDOF gives
an indication of the capacity gain achievable in a MIMO channel. For a SISO
channel, a G-fold increase in the transmitter power results in an increase in
the channel capacity of log2 G bits/sec/Hz. If a MIMO channel is equal to
EDOF SISO channels in parallel, a G times increase in the transmit power
should increase the capacity of the system by (EDOF*log2 G) bits/sec/Hz.
EDOF is deﬁned at a given transmit power and outage probability.
(10.10)
The capacity at outage q is evaluated for a I increase in SNR. EDOF is a
real number in [0, k] where k is the rank of the channel matrix H. Equation
10.10 was analytically solved to get another convenient means to compute
EDOF in [30]. This is given in Equation 10.11.
(10.11)
Although EDOF was deﬁned at an outage probability, it can also be deﬁned
as the average EDOF (EDOF averaged over all the channel realizations) to
indicate the average capacity gain achievable in the MIMO system [31]. The
EDOF decreases as fading correlation increases. Similarly EDOF decreases
in a LOS channel compared to a rich scattering NLOS channel. In fact, in a
LOS channel with a dominant propagation path with very few scatterers it
could be close to 1.
10.6.3
Analysis of Field Test Measurements
The 5.25 GHz 2 × 2 MIMO system was deployed in an indoor quasi-static
environment, and the performance gain of the communication system as a
EDOF
d
d Cq
=
=
I
W
I
I
(
)
2
0
EDOF
M
i
i
k
=
+
¬
®
­
­
­
¼
¾
½
½
½
=¨
1
1
2
1
WX

Multi-Antenna Testbeds for Wireless Communications
307
function of the number of antennas was measured. The same set of meas-
urements was used to measure the capacity gain with the 2 × 2 MIMO system
compared to the SISO system and the EDOF of the environment. The wireless
measurements were carried out in a laboratory environment. The transmitter
and receiver were located in the same room of the ICSL and, thus, a line of
sight existed between them. The distance between them was kept constant
at about 6–7 m. The total transmit power was ﬁxed at –3 dBm (0.5 mW) for
all the experiments. 3dB attenuators were placed before the antennas for
MIMO 2 × 2 to keep the total transmit power constant at –3 dBm. A second
set of measurements was conducted with the total transmit power ﬁxed at
–10 dBm. The transmitter was moved in steps larger than the wavelength in
order to get independent channel realizations. 200 distinct measurements for
each of SISO, 1 × 2 and 2 × 2 setups were conducted.
Figure 10.22 plots the CDF of slicer SNR comparing 1 × 1, 1 × 2, and 2 × 2
systems. The same plot also has simulation results with identical amounts
of Carrier frequency offset, I/Q mismatch, and phase noise added to mimic
the real system. It can be observed that the simulation results closely match
with the real measurements. The Slicer SNR for a 2 × 2 system is 3dB worse
than a SISO system, since the transmit power is uniformly distributed among
both the transmit antennas. Figure 10.23 plots the theoretical capacity using
the estimated channels along with the capacity using the post-processing
SNR (slicer SNR), which indicates the capacity that can be achieved with
this communication system. The difference between the two indicates the
capacity loss due to the implementation loss of the system.
FIGURE 10.22
CDF of slicer SNR for LOS channels with excess I/Q mismatch at Tx 1 ﬁxed.
CDF of slicer SNR for LOS paths(ee54116)
for SISO, SIMO 1 × 2, and MIMO 2 × 2
SISO
1 
0.9 
0.8 
0.7 
0.6 
0.5 
Probability(slicer SNR ≤ abscissa) 
0.4 
0.3 
0.2 
0.1 
0 
0 
5 
10 
15 
20 
Slicer SNR 
25 
30 
35 
40 
45 
Simulation 
Measurements 
MIMO 
SIMO 

308
MIMO System Technology for Wireless Communications
The average capacity gain observed with the communication system is
plotted in Figure 10.24. The capacity computed using the estimated normal-
ized channels is plotted along with the average achievable capacity (capacity
computed using slicer SNR). This shows that there is a capacity loss of about
2.5 bps/Hz in this communication system using the measurements made at
a received SNR of about 22 dB (when the transmit power was ﬁxed at
–10 dBm), and the capacity loss grew to 4 bps/Hz when the received SNR
increased to approx 28 dB (when the transmit power was ﬁxed at –3 dBm).
This was mainly due to the non-linearities in the RF frontend at the higher
power. The capacity loss in a SISO system is much less than the MIMO
system because the impact of analog impairments such as I/Q mismatch is
much less in a SISO system than in a MIMO system. We also observe a linear
increase in achievable capacity with the MIMO system.
Table 10.4 lists the capacity and capacity gain observed along with the
computed EDOF in the LOS channels. The theoretical MMSE capacity gain
was also computed to be 1.73. The average EDOF using the estimated chan-
nels was measured to be 1.9, and the observed capacity gain was 1.67.
10.6.4
Channel Impact on Space–Time Coding
The pioneering work by Foschini and Gans [23] and Telatar [24] showed that
multiple antennas in a wireless communication system could greatly
FIGURE 10.23
CCDFs of capacity for MIMO, SIMO, and SISO in LOS channels.
MIMO 2 × 2
Capacity CCDFs  using estimated channels
and slicer SNR in LOS channels
SIMO 1 × 2
SISO 
SISO 
1 
0.9 
0.8 
0.7 
0.6 
0.5 
0.4 
0.3 
0.2 
0.1 
0 0 
5 
10 
Capacity b/s/Hz 
15 
20 
25 
Capacity loss due to 
implementation loss 
Probability(capacity ≥ abscissa)
Theoretical capacity 
Slicer capacity 
MIMO 2 × 2
SIMO 1 × 2

Multi-Antenna Testbeds for Wireless Communications
309
improve performance. For M transmit antennas and N receive antennas in
Rayleigh fading, it was shown that with spatial independence, there are
essentially M*N levels of diversity available and there are min(M, N) inde-
pendent parallel channels that could be established. These information
theoretic results spawned two lines of work: one to increase throughput by
exploiting spatial multiplexing [34] and one to improve error performance
by exploiting spatial diversity [35,36]. The code design and performance
analysis paradigm in the area typically assume a spatially white Rayleigh
fading channel. However, a real channel could neither be Rayleigh nor be
spatially white.
Hence, it is of great interest to test and compare the performance of the
space–time codes in a realistic environment. This section reports on a series
FIGURE 10.24
Capacity vs. SNR curves overlaid with measured average capacity values for LOS measurements.
TABLE 10.4
Capacity Gain in LOS Channels at 20 dB SNR
Average capacity
11.30 bps/Hz
Capacity at 10% outage
8.64 bps/Hz
Average EDOF
1.9
EDOF at 10% outage
1.77
Observed capacity gain
1.67
Observed capacity gain at 10% outage
1.57
Theoretical slicer capacity gain for MMSE MIMO decoder at 20 dB SNR
1.73
25 
20 
15 
Capacity bits/sec/Hz 
10 
5 
0 
0 
5 
10 
15 
Received SNR 
20 
25 
30 
35 
1 × 1
1 × 2
2 × 2
2 × 2
1 × 1
1 × 2
MMSE post 
processing 
capacity 
Theoretical 
capacity 
Second set of 
measurements 
First set of 
measurements 
1 × 2 Theoretical
1 × 1 Theoretical
2 × 2 Slicer capacity
1 × 2 Slicer capacity
1 × 1 Slicer capacity
2 × 2 Theoretical

310
MIMO System Technology for Wireless Communications
of experiments whose goal is to evaluate the impact of antenna separation
on code performance for each of these lines of work. Two types of signaling
are considered in this section: (1) multiplexing type schemes (space–time
constellations and precoding) and (2) space–time codes designed to harvest
diversity or performance.
The experimentation was done on the UCLA campus and the surrounding
West Los Angeles area using the UCLA Narrowband real-time multi-antenna
DSP testbed. The testing reported in this section was limited to the scenario
where the transmitter was deployed on the top of a ﬁve-story building and
the receiver on a vehicle (a van). The test consisted of the receiver radio
being driven around the campus area. The speed of the driving was main-
tained at a rate of less than 5 miles per hour as the space–time trellis codes
that were tested were all designed for quasi-static fading. The UCLA campus
area is heavily urbanized, and a line of sight was not achieved in any
signiﬁcant portion of the testing. An example of the testbed deployment is
shown in Figure 10.25.
Three antenna conﬁgurations are considered: (1) 2 Q spacing at the trans-
mitter with 0.5 Q spacing at the receiver, (2) 2 Q spacing at the transmitter
with 0.25 Q spacing at the receiver, and (3) 1 Q spacing at the transmitter
with 0.25 Q spacing at the receiver. For the case of precoding and space–time
constellations the Alamouti [37] coding scheme has the most robustness to
different antenna geometries. All constellations considered here use R = 4 bits
per symbol and the comparison for frame error rate is in Figure 10.26 for
M = 2 and N = 2. The Alamouti code must use a 16 QAM constellation to
achieve this rate while spatial multiplexing and the threaded architectures
can use QPSK constellations. When the spacing of the array is larger (closer
FIGURE 10.25
Test deployment.
TX deployment
(a) 
(b) 
RX deployment

Multi-Antenna Testbeds for Wireless Communications
311
to spatial independence) the Golden Code [38] has the advantage due to the
smaller constellation point differences. As the spacing become closer and the
channels become correlated, the Alamouti code has the advantage. Direct
spatial multiplexing with a BLAST-like architecture has clearly lower per-
formance than either of the two considered architectures and does not
achieve full diversity. For the case of trellis codes, the universal code has the
most robustness to different antenna geometries. All constellations consid-
ered here use a R = 2 bits per symbol, and the comparison for frame error
rate is in Figure 10.27 for M = 2 and N = 2. The universal code has good
performance in most cases with moderate degradation due to spatial corre-
lation. The super-orthogonal space–time trellis codes [39,40] and CYV [41]
codes show more signiﬁcant degradation due to spatial correlation. For more
detailed results, refer to [42].
FIGURE 10.26
FER of 2 × 2 spatial multiplexing and Alamouti schemes.
100 
10−1
10−2
10−3
10−4
0 
5 
10 
15 
20 
25 
30 
Blast, QPSK, antenna separation 1
Blast, QPSK, antenna separation 2
Blast, QPSK, antenna separation 3
Golden, QPSK,  antenna separation 1
Golden, QPSK,  antenna separation 2
Golden, QPSK, antenna separation 3
Alamouli, 16 QAM,  antenna separation 1
Alamouli, 16 QAM,  antenna separation 2
Alamouli, 16 QAM,  antenna separation 3

312
MIMO System Technology for Wireless Communications
References
1. J.F. Frigon and B. Daneshrad. 2002. “Field measurements of an indoor high-
speed QAM wireless system using decision feedback equalization and smart
antenna array,” IEEE Transactions on Wireless Communications, Vol. 1, No. 1, Jan.
2002, pp. 134–144.
2. M.P. Fitz et al. 1997. “ITS wireless narrowband land mobile data communica-
tions,” Vehicular Technology Conference, IEEE 47th, Vol. 2, pp. 909–913.
3. H. Zou, S. Mohan, D. Cabric, and B. Daneshrad. 2001. ”Implementation and
ﬁeld trial results of a fast frequency hopped FSK testbed for wireless commu-
nications,” ICC 2001.
4. S. Lang, R.M. Rao, and B. Daneshrad. 2004. “Development of a software con-
ﬁgurable broadband wireless communication platform,” IST Mobile Commu-
nication Summit, June 27–30, Lyon, France.
5. K.P. Pun et al. 2001. “Correction of frequency dependent I/Q mismatches in
quadrature receivers,” Electronics Letters, Nov. 8, 2001.
6. A. Schuchert and R. Hasholzner. 2001. “A novel I/Q imbalance compensation
scheme for the reception of OFDM signals,” IEEE Trans. On Consumer Elect.,
Aug. 2001.
7. T. Ylamurto. 2003. “Frequency domain I/Q imbalance correction scheme for
OFDM systems,” WCNC 2003.
FIGURE 10.27
PER of 2 × 2 space–time trellis codes.
100 
10−1 
10−2 
10−3 
0 
2 
4 
6 
8 
10 
12 
14
CYV–TCM, antenna separation 1 
CYV–TCM, antenna separation 2 
CYV–TCM, antenna separation 3 
SOMTCM,  antenna separation 1 
SOMTCM,  antenna separation 2 
SOMTCM,  antenna separation 3 
Universal–TCM,  antenna separation 1 
Universal–TCM,  antenna separation 2 
Universal–TCM,  antenna separation 3 

Multi-Antenna Testbeds for Wireless Communications
313
8. R. Rao and B. Daneshrad. 2004. “Analysis of I/Q mismatch and a cancellation
scheme for OFDM systems,” IST Mobile Communication Summit, June 27–30,
Lyon, France. 
9. R. Rao and B. Daneshrad. 2004. “I/Q mismatch cancellation for MIMO-OFDM
systems,” Personal Indoor Mobile Radio Communications Conf. (PIMRC), Bar-
celona, Spain, Sept. 5–8, 2004.
10. D.B Leeson. 1996. “A simple model of feedback oscillator noise spectrum,”
Proceedings of the IEEE, Vol. 54, Feb. 1996, pp. 329–330.
11. F.M. Gardener. 1980. “Charge-pump phase-lock loops,” IEEE Transactions on
Communications, Vol. COM-28, Num. 6, Nov. 1980, pp. 1849–1858.
12. M. Curtin and P. O’Brien. 1999. “Phase-locked loops for high-frequency receiv-
ers and transmitters — part 1–part 3,” Analog Dialogue 33-3, 33-5, 33-7, 1999.
13. E. Costa and S. Pupolin. 2002. “M-QAM-OFDM system performance in the
presence of a nonlinear ampliﬁer and phase noise,” IEEE Transactions on Com-
munications, Vol. 50, No. 3, March 2002.
14. A. Armada and M. Calvo. 1998. “Phase noise and subcarrier spacing effects on
the performance of an OFDM communication system,” IEEE Communication
Letters, Vol. 2, No. 1, Jan. 1998.
15. M. El-Tanany, Y. Wu, and L. Hazy. 2001. “Analytical modeling and simulation
of phase noise interference in OFDM-based digital television terrestrial broad-
casting systems,” IEEE Transactions on Broadcasting, Vol. 47, No. 1, March 2001.
16. A. Papoulis. 1984. Probability, Random Variables, and Stochastic Processes, New
York: McGraw-Hill.
17. T.H. Lee and A. Hajimiri. 2000. “Oscillator phase noise: a tutorial,” IEEE Journal
of Solid-State Circuits, Vol. 35, No. 3, March 2000.
18. J. Salz. 1986. “Modulation and detection for coherent lightwave communica-
tions,” IEEE Communications Magazine, Vol. 24, No. 6, June 1986, pp. 38–49.
19. N.J. Kasdin. 1995. “Discrete simulation of colored noise and stochastic process-
es and 1/fF power law noise generation,” Proceedings of the IEEE, Vol. 83, No. 5,
pp. 802–827, May 1995.
20. N.J. Kasdin and T. Walter. 1992. “Discrete simulation of power law noise,” Proc.
1992 IEEE Frequency Control Symposium, Hershey, PA, May 1992, pp. 274–283.
21. P. Robertson and S. Kaiser. 1995. “Analysis of the effects of phase noise in
Orthogonal Frequency Division Multiplex (OFDM) systems,” ICC 1995, Seattle,
Vol. 3, June 1995, pp. 1652–1657.
22. S. Lang and B. Daneshrad. 2005. “From architecture to implementation of a
wireless, multiple antenna testbed,” 2005 IEEE International Symposium on Cir-
cuits and Systems, ISCAS, Kobe, Japan, May 23–25, 2005.
23. G.J. Foschini and M.J. Gans. 1998. “On limits of wireless communications in a
fading environment when using multiple antennas,” Wireless Pers. Commun.,
Vol. 6, March 1998, pp. 311–335.
24. E. Telatar. 1995. “Capacity of multiantenna Gaussian channels,” AT&T Bell
Laboratories, Tech. Memo., June 1995.
25. D. Gesbert, M. Shaﬁ, D. Shiu, P.J. Smith, and A. Naquib. 2003. “From theory
to practice: an overview of MIMO space-time coded wireless systems,” IEEE
Journal on Selec. Areas in Comm, Vol. 21, No. 3, April 2003, pp. 281–302.
26. A.J. Paulraj, D.A. Gore, R.U. Nabar, and H. Bolcskei. 2004. “An overview of
MIMO communications — a key to gigabit wireless,” Proc. of the IEEE, Vol. 92,
No. 2, Feb. 2004, pp. 198–218.

314
MIMO System Technology for Wireless Communications
27. A. Paulraj, R. Nabar, and D. Gore. 2003. Introduction to Space-Time Wireless
Communications, Cambridge, U.K.: Cambridge University Press.
28. D. Shiu, G.J. Foschini, M.J. Gans, and J.M. Kahn. 2000. “Fading correlation and
its effects on the capacity of multielement antenna systems, ” IEEE Trans. on
Commun., Vol. 48, No. 3, March 2000, pp. 502–513.
29. C.-N. Chuah, G.J. Foschini, R.A. Valenzuela, D. Chizhik, J. Ling, and J.M. Kahn,
“Capacity growth of multi-element arrays in indoor and outdoor wireless
channels,” IEEE WCNC 2000, Chicago, Sept. 23–28, 2000, Vol. 3, pp. 1340–1344.
30. T. Svantesson and J. Wallace. 2003. “On signal strength and multipath richness
in multi-input multi-output systems,” ICC 2003, Vol. 4, May 11–15, 2003,
pp. 2683–2687.
31. R. Rao. 2004. “Performance Analysis of MIMO-OFDM systems,” Ph.D. Thesis,
University of California, Los Angeles, Oct. 1, 2004.
32. W. Zhu, D.W. Browne, and M.P. Fitz. 2005. “An open access wideband multi-
antenna wireless testbed with remote control capability,” IEEE TridentCom,
Feb. 2005.
33. D. Browne, W. Zhu, and M.P. Fitz. 2005. “A signaling scheme and estimation
algorithm for characterizing frequency selective MIMO channels,” IEEE VTC,
May 2005.
34. G.J. Foschini. 1996. “Layered space-time architecture for wireless communica-
tions in a fading environment when using multiple antennas,” Bell Labs Tech-
nical Journal, Autumn 1996, pp. 41–59.
35. V. Tarokh, N. Seshadri, and A.R. Calderbank. 1998. “Space-time codes for high
data rate wireless communication: Performance criterion and code construc-
tion,” IEEE Info. Theory, Vol. 44, March 1998, pp. 744–765.
36. J.-C. Guey, M.P. Fitz, M.R. Bell, and W.-Y. Kuo. 1996. “Signal design for trans-
mitter diversity wireless communication systems over Rayleigh fading chan-
nels,” 1996 IEEE Vehicular Technology Conference, Atlanta, GA, pp. 136–140.
37. S.M. Alamouti. 1998. “A simple transmit diversity technique for wireless com-
munications,” IEEE J. Select Areas Commun., Vol. 16, Oct. 1998, pp. 1451–1458.
38. J.-C. Belﬁore, G. Rekaya, and E. Viterbo. 2004. “The golden code: A2 × 2 full-
rate space-time code with non-vanishing determinants,” IEEE International
Symposium on Information Theory, Chicago, IL, June 2004, p. 308.
39. S. Siwamogsatam and M.P. Fitz, ”Improved high rate space–time TCM via
orthogonality and set partitioning,” International Symposium on Wireless Personal
Multimedia Communications, Alborg, Denmark, September 2001.
40. S. Siwamogsatam and M.P. Fitz. 2002. “Improved high rate space–time TCM
via concatenation of expanded orthogonal block codes and MTCM,” IEEE
International Conference on Communication, New York, April 2002.
41. Z. Chen, J. Yuan, and B. Vucetic. 2001. “Improved space-time trellis coded
modulation scheme on slow Rayleigh fading channels,” Electronics Letters,
Vol. 37, March 2001, pp. 440–441.
42. W. Zhu, H. Lee, D.N. Liu, and M.P. Fitz. “Antenna array geometry and coding
performance,” submitted to IEEE International Symposium on Information
Theory, 2005.
43. L. Wei, O.Y. Takeshita, P. Gupta, W. Zhu, and M.P. Fitz. 2003. “Implementation
and testing of super-orthogonal space time trellis codes,” IEEE Vehicular Tech-
nology Conference, Volume 3, Fall 2003, pp. 1748–1752.

315
11
Gigabit Mobile Communications Using Real-
Time MIMO-OFDM Signal Processing
Volker Jungnickel, Andreas Forck, Thomas Haustein, Christoph Juchems, 
and Wolfgang Zirwas
CONTENTS
11.1
Introduction ..............................................................................................315
11.2
Implementation Concept ........................................................................318
11.3
A Code-Multiplexed Preamble ..............................................................322
11.4
Channel Estimation .................................................................................324
11.5
Adaptation to the Time-Variant Channel ............................................330
11.6
Data Reconstruction ................................................................................332
11.7
Framing, Mapping, Channel Coding, and Real-Time 
Data Interface............................................................................................335
11.8
Implementation, Complexity, and System Integration......................337
11.9
Transmission Experiments......................................................................340
11.10 Conclusions...............................................................................................345
11.11 Summary ...................................................................................................347
11.12 Acknowledgments ...................................................................................348
Appendix 11A......................................................................................................348
Appendix 11B ......................................................................................................349
References.............................................................................................................351
11.1
 Introduction
There is an ever-increasing demand for higher bandwidths in mobile com-
munication systems. While the target of the ﬁrst generations was mobile
telephony, currently deployed systems aim to enhance people’s lives by
enabling high-speed mobile access to the Internet anywhere and at any time.
While the integration of heterogeneous mobile and wireless access tech-
niques may be one important aspect of the next generation (4G), a second

316
MIMO System Technology for Wireless Communications
goal is the support of even higher data rates, similar to ﬁxed networks, as
well as to provide high-quality multimedia applications at reasonable costs
for multiple mobile users. These applications need a dramatically increased
sum capacity to be realized in parallel to the existing mobile services. Services
are expected to become available between 2012 and 2015, most likely in an
extended, but deﬁnitely limited spectrum with a scalable bandwidth
between 5 and 100 MHz [1].
Recent work on wireless data transmission for indoor applications at
Gbit/s data rates is merely based on classical microwave [2–4] or infrared
[5] techniques. There are commercial products combining both approaches,
which replace, in principle, an optical ﬁber for wireless bridge applications.
But these systems generally use directional transceivers to extend the range
and to suppress unwanted multipath components: By tracking the direction
of a principal path with a narrow-beam antenna, the multipath fading
becomes negligible. Since the power of the other paths is so reduced, the
link becomes almost “transparent,” i.e., the coherence bandwidth is no
longer limited by the multipath propagation. Simple single-carrier modula-
tion and demodulation techniques can then be used with no equalization.
On the other hand, this concept limits the mobility of the users, since trans-
mitter (Tx) and/or receiver (Rx) must be aligned to each other and a free
line-of-sight (LOS) or a strong reﬂection is required as the principal path.
In a mobile communications environment, the base station often has sector
antennas and knows the direction of the terminal equipped with omni-
directional antennas only coarsely. True mobility requires such widely opened
antenna apertures, and with them it is difﬁcult to select and track the direction
of a principal path out of the potentially large number of received signals
coming from many different directions. As a consequence, the data signals
are corrupted by the statistical fading in time, frequency, and space. Very
robust signaling schemes need to be used for reliable communications.
A modern approach for wireless fading channels is to use multiple anten-
nas both at the Tx and Rx in combination with sophisticated space–time (ST)
signal processing techniques, as space–division multiple access (SDMA) and
multiple-input multiple-output (MIMO). The implementation of advanced
signal processing becomes more and more attractive even at mobile termi-
nals. But the complexity of the ST algorithms is considerable, in particular
when they are combined with the WCDMA technology used in the third
generation of mobile communication systems [6,7]. To reduce this complex-
ity, one may want to simplify the transmission, detection, and coding tech-
niques in future air interfaces.
Almost a decade ago it was noticed [8] that the complexity of the ST
processing for multipath MIMO channels can be substantially reduced with
the discrete matrix multitone technique operating in the space–frequency
domain, which became popular under the term MIMO-OFDM. By perform-
ing an inverse fast Fourier transform (IFFT) and inserting a cyclic preﬁx (CP)
between consecutive OFDM symbols at each transmitter, and by removing
the CP and performing a fast Fourier transform (FFT) at each receiver, the

Gigabit Mobile Communications Using Real-Time Signal Processing
317
equivalent space–frequency channel matrix becomes block-diagonal. The
well-known SDMA and MIMO algorithms for frequency-ﬂat fading channels
can therefore be used also in frequency-selective channels, by applying them
individually on each OFDM subcarrier. The complexity for the adaptation
of the signal processing to the time-variant channel scales then linearly with
N, which is the length of the OFDM symbol without CP (and equal to the
number of subcarriers), rather than cubic with N for the space–time
approach. Also the complexity of the data reconstruction scales linearly with
N rather than quadratic. Using a joint water-ﬁlling across the spatial eigen-
modes and subcarriers (see Section 11.2), the channel capacity is asymptot-
ically achieved for inﬁnite symbol length with this approach.
But despite this fundamental complexity reduction, it is still challenging
to implement MIMO-OFDM in real-time with current digital signal proces-
sors (DSPs). Most MIMO-OFDM prototypes in the recent literature transmit
the signals over the air and perform the processing off-line, as in [9,10]. But
the joint water-ﬁlling requires real-time adaptation to the time-variant chan-
nel along the entire transmission chain, and the real-time implementation of
the signal processing is an essential step toward the application of these new
techniques.
The algorithmic part of new signal processing schemes is highly developed
in the literature on wireless communications. But there are surprisingly few
detailed reports about hardware implementations, and how state-of-the-art
real-time signal processing components, such as digital signal processors
(DSPs), ﬁeld-programmable gate arrays (FPGAs), and application-speciﬁc
integrated circuits (ASICs) can be used to implement new algorithms in order
to bring them closer to application.
It is well known that the step from the algorithmic to the register-transfer
level is a highly critical process in any implementation where teamwork
between algorithm and hardware specialists and a good portion of creative
intelligence are needed to get an efﬁcient and reliable system at the end. So
it might be helpful to describe such a hardware implementation by using
MIMO-OFDM as a timely example.
The ﬁrst real-time MIMO-OFDM prototype was implemented using a DSP
farm [11]. It was intended for the evolution of existing 3G systems and
allowed a peak data rate of 37 Mbit/s with two transmit and up to four
receive antennas in a bandwidth of 5 MHz. However, one would have to
increase the DSP processing power by more than an order of magnitude to
cover the projected 4G cell capacity. The ITU-R Recommendation M.1645
states that “potential new radio interface(s) will need to support data rates
of up to approximately 100 Mbit/s for high mobility such as mobile access
and up to approximately 1 Gbit/s for low mobility such as nomadic/local
wireless access.”
In order to meet this challenge, we develop a dedicated implementation
concept for MIMO-OFDM. As a proof-of-concept, the system is implemented
on a reconﬁgurable experimental prototype realizing the projected 1 Gbit/s
data rate in real-time in a bandwidth of 100 MHz. For this, we needed to

318
MIMO System Technology for Wireless Communications
•
Perform a basic complexity study of the MIMO-OFDM algorithm
concerning real-time implementation
•
Find a suitable partitioning of the signal processing using state-of-
the-art reconﬁgurable signal processing components (DSP, FPGA)
•
Deﬁne an efﬁcient preamble for the channel estimation and to realize
the corresponding channel estimator
•
Analyze the complexity for the adaptation of the MIMO-OFDM
signal processing to the time variation of the channel
•
Develop an efﬁcient MIMO-OFDM detector that is capable of pro-
cessing the received data continuously
•
Integrate the MIMO-OFDM signal processing with forward error
correction and data source and sink
•
Perform transmission experiments and measure the performance
This chapter is organized as follows: Section 11.2 describes the implemen-
tation concept. Section 11.3 develops the structure of a new preamble for
the channel estimation. Section 11.4 introduces the channel estimator and the
implementation using a wrapped pipeline structure. Section 11.5 considers
methods to speed up the adaptation to the time-variant channel and reports
benchmark results concerning the achieved adaptation rate in the experi-
mental system. The data reconstruction unit is described in Section 11.6.
Section 11.7 sketches the simpliﬁed channel coding, data mapping, and inte-
gration of the data source and sink. Section 11.8 gives insights into the signal
processing platform and the integration of the system. Section 11.9 describes
the measurement set-up and reports results from over-the-air transmission
experiments.
11.2
Implementation Concept
Basic algorithm: The implementation concept is derived from the optimal
information-theoretic structure of the MIMO-OFDM system [8], which is ﬁrst
brieﬂy reviewed. The transmission is conveniently formulated in the fre-
quency domain as
(11.1)
where the (nTx × 1) vector xn contains the signals transmitted from all Tx
antennas at the OFDM subcarrier with index n = 1…N where N denotes the
number of OFDM subcarriers. The (nRx × 1) vectors yn and SSSSn contain the
received signals and the noise, respectively, at all Rx antennas. The integers
nTx and nRx denote the numbers of antennas at the transmitter and receiver,
y
H x
n
n
n
n
=
+ S

Gigabit Mobile Communications Using Real-Time Signal Processing
319
respectively. The (nRx × nTx) matrix Hn denotes the channel matrix for sub-
carrier n with the complex-valued channel coefﬁcient between each transmit
and each receive antenna, and it can be obtained from the time-domain
channel impulse response matrices Hl as
(11.2)
where L denotes the number of resolved multipath components. In the
optimal way, based on full channel state information (CSI) both at the Tx
and Rx, the channel capacity is approached asymptotically by performing a
singular value decomposition (SVD) of Hn on each subcarrier,
(11.3)
which gives the matrices Vn and Un containing the eigenvectors of the chan-
nel matrix in the Tx and Rx spaces, respectively, and the diagonal matrix Dn,
which contains i = 1…min(nTx, nRx) singular values
, referred to as the
amplitude gains of the spatial eigenmodes. The superscript H denotes the
conjugate transpose of a matrix. The capacity is asymptotically approached
for inﬁnite N by a joint water-ﬁlling across all spatial eigenmodes i and all
subcarriers n [8].
Realization: In a practical system, the Tx signal xn = Vndn is obtained from
the transmitted data vector dn and the spatially multiplexed data signals are
reconstructed at the Rx as
. The noise in each stream is then
boosted differently, according to the actual singular values at the given
subcarrier index. Unlike in the information theory, in practice we employ
discrete instead of continuous modulation alphabets. A joint bit-loading and
power allocation algorithm is used with individual modulation on each
eigenmode and each subcarrier, according to the current channel state, so
that important optimization criteria (throughput, fairness, stability of
queues) can be fulﬁlled.
Depending on the availability of the CSI, there are modiﬁcations. When
CSI is available at the receiver only, no pre-processing can be applied.
Assuming additionally linear detection, which requires a simple matrix-
vector multiplication, the transmitted signals on each subcarrier may be
reconstructed using the minimum mean-square error detector given by the
formula
(11.4)
where I and X2 are the (nTx × nTx) identity matrix and the noise variance at
one Rx antenna, respectively.
H
H
n
l
l
L
exp
j
nl
N
=

©
«ª
¹
»º
=

¨
2
0
1
U
H
U D V
n
n
n
n
H
=
Qi
n
ˆd
D
U y
n
n
H
n
=

1
ˆx
H H
I
H y
n
n
n
H
n
H
n
=
+
(
)

X2
1

320
MIMO System Technology for Wireless Communications
The two proposed concepts are jointly shown in Figure 11.1. The ﬁrst
concept based on the eigenmode signaling requires all components, while
the second concept based on the linear MMSE needs only the shaded ones.
In what follows, we describe the ﬁrst concept. The input data are jointly
interleaved and encoded across the spatial channels and subcarriers before
passing them to the adaptive ﬂow control unit. The consecutive link adap-
tation uses an individual modulation for each stream and each subcarrier.1
The next step is a joint pre-processing of the data signals on all streams,
which is performed individually for each subcarrier. The resulting signals
are then passed through the IFFT, the CP is inserted, and the signals are
transmitted over the air. The CSI for the spatio-temporal pre-processing can
be obtained by exploiting the reciprocity of the radio channel (i.e., transmit
pilot signals in the reverse link and reuse CSI for the forward link), which
is possible in the time-division duplex mode or by a suitable feedback tech-
nique in frequency-division duplex mode. Additional information on the
interference is needed for proper pre-processing and link adaptation. It can
be provided via feedback from the Rx over the reverse link.
At the receiver, the CP is removed and the signals are passed through the
FFT. The channel estimation is performed in the frequency domain during
a dedicated time slot in each frame. Based on the estimates for each subcar-
rier, for each frame a new set of SVD or MMSE matrices is calculated. The
data signals are then reconstructed using spatial post-processing individu-
ally for each subcarrier. Thereafter, the signals are demodulated and decoded
so the binary data stream can be reconstructed.
FIGURE 11.1
Implementation concept for the experimental MIMO-OFDM system.
FFT 
FFT 
FFT 
FFT 
FFT 
IFFT 
IFFT 
IFFT 
Channel 
estimation 
Channel 
coder 
Space-
frequency
post-
processing
Space- 
frequency 
pre- 
processing 
Demod 1 
Demod 2 
Demod 3 
Adaptive 
ﬂow 
control 
Adaptive 
ﬂow 
control 
Channel 
decoder 
Link adaptation, scheduling 
Link adaptation, scheduling 
Channel 
tracking 
Channel 
tracking 
Mod 1 
Mod 1 
Mod 1 
Data 
in 
Data 
out 
CSI based on channel reciprocity
and feedback on interference

Gigabit Mobile Communications Using Real-Time Signal Processing
321
The second concept based on the MMSE detector is actually implemented,
since the experimental link is unidirectional, due to effort limitations. Due
to the lack of CSI at the transmitter, pre-processing and link adaptation
cannot be used. Also, the adaptive ﬂow control unit in Figure 11.1 is not yet
implemented. Note that the linear MMSE exploits a fraction of the available
spatial diversity only. An asymmetric antenna conﬁguration with 3 Tx and
5 Rx is therefore used to add more diversity and to stabilize the link.
Structural analysis and functional mapping: At ﬁrst, Figure 11.1 reveals that
two basic groups of tasks must be realized in real time: In the ﬁrst group
(sample rate processing), we have the IFFTs and FFTs with their complex-
valued serial inputs and outputs and a number of tasks that must be per-
formed consecutively and individually for each subcarrier, as modulation,
demodulation, channel estimation, and space–frequency pre- and post-
processing. This kind of processing includes elementary operations that must
be performed at a very high processing clock, which is 100 MHz in the
experimental system. The ﬂow of data signals is naturally arranged in a
chain. It can be realized so that the input of one operation is the output of
the previous operation. Signals are then fed through different steps in the
processing chain and signals for consecutive subcarriers are processed simul-
taneously while being in a different pass. Effectively, each signal needs then
a single clock cycle to be processed, which is called “pipelining” in the
literature. Pipelining is the ﬁrst basic principle of how complex computations
can be broken down into elementary operations which can be executed in
real time so that the effective number of operations performed in each clock
cycle is much larger than unity. The second basic principle is parallel com-
puting, which is heavily used in the MMSE MIMO-OFDM detector described
below.
The algorithm assessment shows that the sample rate processing for
MIMO-OFDM can be organized so that only primitive look-up, multiply,
add, or combined multiply-and-accumulate operations are needed with a
high potential of parallel processing. This workload is ideally suited for
implementation in FPGA.
This is in great contrast to the second group of operations called channel
rate processing, which is shown in parallel below the signal path in
Figure 11.1. This group includes the adaptation of the entire signal processing
chain to the time-variant channel, i.e., the renewal of pre- and post-process-
ing matrices, the link adaptation and the scheduling units. These algorithms
operate on a totally different time scale, which must not be confused with
the requirements for the sample rate processing. Besides other factors, the
required update interval scales with the coherence time of the time-variant
wireless channel, which is on the order of 10 ms for 1 m/s velocity in an
indoor scenario at 5 GHz carrier frequency.
Some of these channel rate algorithms operate on matrices that sometimes
become singular. The results may then have a high dynamic, which is most
easily handled in ﬂoating point arithmetic. Furthermore, these algorithms
depend on the available type of the CSI, and we want to maintain and

322
MIMO System Technology for Wireless Communications
exchange them easily. For testbed purposes, the channel rate processing is
best implemented in a ﬂoating point DSP operating in a loop, which renews
all settings in a fraction of the channel coherence time.
11.3
A Code-Multiplexed Preamble
For MIMO and SDMA, a precise CSI must be available. In [9], the simplest
time-multiplex approach is used for the training signals, i.e., the same pre-
amble is transmitted consecutively by all antennas. But the experimental
results in Figure 11.12 in [9] indicate that there is a signiﬁcant penalty when
this kind of channel estimation is used. An obvious drawback of the time-
multiplexed preamble is that only one out of nTx antennas is active at once,
and so the potentially valuable contribution of the other antennas to the
signal-to-noise ratio is lost. 
Here we use a code-multiplexed preamble being orthogonal over multiple
OFDM symbols. All antennas and subcarriers are active during the whole
training phase, i.e., each antenna transmits at the maximal energy. The use
of all subcarriers enables a rapid carrier-wise raw estimation, which may be of
advantage in space–frequency scheduled multi-user systems where it
enables the ultimate granularity of the resource allocation — on each spatial
mode and on each carrier.* In real time and at very high data rates, there are
additional constraints. Normally it takes some time until the weight matrices
are obtained from the channel estimates. Moreover, there is no buffer memory
in the experimental system to delay the sampled and Fourier-transformed
signals for one or more frames.** Only in this way can they be processed/time
aligned with the corresponding weight matrices. Hence the weights are
applied with some delay in our system, which is minimized when the channel
estimates on all subcarriers and for all antennas are available instantly after
the last training symbol.
The preamble structure is most easily explained in the frequency-time grid:
On the time axis (i.e., OFDM symbol by OFDM symbol), the pilots for
different antennas shall be mutually orthogonal. This is achieved by assign-
ing a characteristic code Hj(k) to the j-th Tx antenna out of the well-known
Hadamard sequence set. To reduce the hardware effort at the receiver, it is
essential to reuse the same sequence Hj(k) for all subcarriers. But this would
yield an undesired sharp pulse after the IFFT. So the subcarrier signals are
scrambled in the frequency domain using the same binary sequence Sn on
all Tx antennas. This way the binary signal structure in the frequency-time
grid is maintained, and we can use a simpler correlation circuit for the
* In particular, we need no multiplication in the estimator.
** For future implementations, it is highly recommended to foresee such ﬁrst-in ﬁrst-out (FIFO)
buffer memory with an interface of considerable bandwidth to transfer the 12 bit I and Q signals
for multiple antennas from and to the FPGA.

Gigabit Mobile Communications Using Real-Time Signal Processing
323
channel estimator.* In the experimental system, we have used the well-
known scrambling sequence S-26…26 from the 802.11a standard. For other
numbers of subcarriers, a suitable scrambling sequence may be found by
extensive computer search among random sequences having a small peak-
to-average power ratio of the Tx signal after the IFFT. The elementary form
of the preamble is given as
(11.5)
where j = 1…nTx. Note that this form of the preamble is also suggested by
others [12,13]. In Figure 11.2, the training signals at the ﬁrst and third antenna
according to Equation 11.1 are shown in the subcarrier-index vs. OFDM
training-symbol-index grid.
In Figure 11.2, one can observe that the same scrambling is used for all
antennas along the frequency axis. The ﬁrst antenna is marked by the all-
ones Hadamard sequence, while the third Hadamard sequence used for the
third antenna alters the sign after each second symbol.
Some modiﬁcations have been added to this elementary preamble form
for practical reasons.
•
We have observed that it is good to avoid the all-ones sequence since
it regularly causes slightly biased estimates not present for other
sequences, most likely due to an imperfect DC offset compensation
in our analogue IQ demodulators. So the original Hadamard matrix
(which is taken over from MATLAB) is ﬂipped, i.e., the last sequence
is now assigned ﬁrst, and so the critical sequence is not used.
•
We have assigned different sequences to the I and Q branches of the
complex-valued Tx signal, similar to our recent ﬂat fading real-time
FIGURE 11.2
Graphical representation of the preamble according to Equation 11.1: red: 1, blue: –1, green: 0.
* A time-domain estimation would need a larger bandwidth to predict the channel on a single
subcarrier.
First antenna 
Third antenna
Sub-carrier index:
scrambling
10 
20 
30 
40 
50 
60 
10
20
30
40
50
60
1.5
1
0.5
0
0.5
−1
−1.5
1.5
1
0.5
0
0.5
−1
−1.5
10 20 30 40 50 60 
10 20 30 40 50 60
OFDM symbol index: identify antennas 
p
k
S
H k
n
j
n
j
( )
( )
= 


324
MIMO System Technology for Wireless Communications
MIMO implementation [14], to estimate I and Q branches indepen-
dently. This doubles the number of correlation circuits, but it ﬁts
better to the real-valued signal processing used in the experimental
system.
•
OFDM systems are often subject to a residual IQ imbalance in the
RF units. The resulting cross-talk between equally indexed image
carriers in the upper and lower side-band depends, in addition to
the strength of the imbalance, also on the channel coefﬁcient of the
image carrier [15]. When we use the same sequence Hj(k) in both
sidebands, the image carrier may leak signal energy into the desired
carrier, which is likely to cause a certain channel estimation error.
We have occasionally observed ill-reconstructed signal constella-
tions, accordingly, if the channel of the desired subcarrier is faded.
Visibly, the constellations on respective subcarriers become more
stable when the upper and lower side-bands are marked with a
different sequence, allowing also a base-band correction of the
imbalance in the future when the increased complexity becomes
affordable.
Note that these modiﬁcations increase the preamble length. The minimal
length is P = nTx OFDM symbols without and P= 4* nTx training symbols
including all modiﬁcations.
11.4
Channel Estimation
The number of channel coefﬁcients to be estimated for MIMO-OFDM is
enormous. In the experimental system, we have explicitly estimated all coef-
ﬁcients between each I and Q input and output with 3 Tx and 5 Rx antennas
and 48 subcarriers, which results in a number of 4 · nTx · nRx · N = 2880 coefﬁ-
cients. The above-described preamble has the inherent advantage that we
can get a raw estimate for the coefﬁcients on all subcarriers almost instan-
taneously after the end of the last training symbol. In principle, additional
interpolation between adjacent carriers (see below) is not required.
Raw estimation: Channel estimation is performed in the frequency domain
using a correlation over multiple OFDM training symbols. Using a separate
correlation circuit (CC) for each of the 2880 coefﬁcients would be prohibi-
tively complex. But since the frequency-domain scrambling is the same for
all Tx antennas, it can be reversed prior to the channel estimation. Then we
have effectively the same sequence on all subcarriers for a given channel
input, and the same CC can be reused for all carriers. This allows an efﬁcient
implementation of the channel estimator, as explained in the following.
Figure 11.3 shows a frequency-time grid where each column corresponds
to one OFDM training symbol and each row to one subcarrier. After the

Gigabit Mobile Communications Using Real-Time Signal Processing
325
pipelined FFT for each Rx antenna in the FPGA realization, the grid is
scanned column-by-column, as indicated by the zig-zag line. A separate
correlation must now be performed for each subcarrier from OFDM symbol
to OFDM symbol as indicated by the horizontal arrow.
Let us assume that we have a separate memory for each subcarrier and
each pair of inputs and outputs where intermediate results can be stored.
Now the desired correlation is performed in a piecewise manner: If we arrive
at a particular carrier index n and at OFDM symbol index k, we recall the last
intermediate result from the memory, then we add or subtract the received
signal, according to the current sign of the Hadamard sequence, and ﬁnally
we store the new intermediate result in the memory. Then we go to the next
subcarrier. In this way, one correlation circuit can be reused for all subcar-
riers, for one pair of inputs and outputs, which reduces the complexity by
the factor N.
However, these three steps (read, add/subtract, write) must be performed
consecutively, which needs a higher clock in the channel estimator than for
other sample rate operations. To avoid this higher clock, the circuit is actually
implemented as a wrapped pipeline using a dual-port RAM and an adder
as shown in Figure 11.4. At ﬁrst, the scrambling is reversed and the signal
FIGURE 11.3
Frequency-time grid to explain the principle of the channel estimation (see text).
Carrier index 
Time index 

326
MIMO System Technology for Wireless Communications
is either added to or subtracted from the last intermediate result. The latter
is recalled from port 1 of a dual-port RAM, and the result is stored in port 2.
The idea is then to exchange the two-port address spaces for read and write
operations from training symbol to training symbol, where the address of
each subcarrier is used once in each address space and counted through by
the carrier index n. All processes are organized in this wrapped pipeline so
that the read, add or subtract and write tasks are effectively performed in a
single cycle. We have operated 4 · nTx· nRx = 60 of these circuits in parallel at
100 MHz in the experimental system. This highly parallel channel estimator
operates very reliably, even in complex FPGA designs. We like to point out
that the realization of the channel estimator using the wrapped pipeline was
one of the key ideas for stable operation of the entire MIMO-OFDM signal
processing core at 100 MHz clock.
Raw estimation error: The received signal at the ith Rx antenna and nth
subcarrier is given as
(11.6)
where
is the channel coefﬁcient to be estimated and
the noise at
the receiver. The pilot sequence
identiﬁes the jth Tx antenna and all
sequences together are normalized as 
FIGURE 11.4
Wrapped pipeline structure used to operate the channel estimation at sample clock rate.
Address 1 
Dual 
port 
RAM 
Port 2 
Port 1 
Addresses 1 and 2 
are exchanged 
from symbol index to 
symbol index  
Hadamard 
sequence at 
symbol index t 
Scrambling 
sequence 
at tone n 
Received 
signal 
on 
tone n 
Change 
sign 
Adder 
Add or 
subtract? 
Address 2 
y
k
H
p
k
n
k
n
i
n
ij
n
j
j
n
n
i
Tx
( )
( )
( )
=

+
=¨
1
Hn
ij
n
k
n
i ( )
p
k
n
j ( )

Gigabit Mobile Communications Using Real-Time Signal Processing
327
(11.7)
Now the channel estimation is performed as a correlation over all consec-
utive OFDM training symbols at the nth subcarrier of interest as
(11.8)
Provided that the sequences are orthogonal
(11.9)
where Ilj is the Kronecker symbol (Ilj =1 for l=i and Ilj =0 elsewhere), one
obtains
(11.10)
Since the pilot tones have just positive or negative sign, the statistics of
the Gaussian noise are not modiﬁed by the multiplication in Equation 11.10.
Now the noise is modeled as a random process as
(11.11)
where SNR is the signal-to-noise ratio at one Rx antenna and r a complex
Gaussian number with zero mean and unit variance, then the sum in Equa-
tion 11.5 reduces to
(11.12)
where G is called the estimator gain and
is a complex Gaussian random
number with zero mean and unit variance.
p k
p
n
n
j
n
N
j
n
n
j
Tx
Tx
( )
2
1
1
1
1
=
= ¨
¨
=
=
N  ±
{
}
1
ˆ
( )
( )
*
H
n
N
P
p
k y
k
n
N
P
H
n
il
Tx
n
l
k
P
n
i
Tx
n
ij
=


=


=¨
1
p
k p
k
n
N
P
p
k
l
n
k
P
n
j
j
n
Tx
l
n
k
Tx
*
*
( )
( )
( )

+


=
=
¨
¨
1
1
=¨
1
P
n
in
k
( )
p
k p
k
P
n
N
l
n
k
P
n
j
Tx
lj
* ( )
( )

=


=¨
1
I
ˆ
( )
( )
*
H
H
n
N
P
p
k
n
k
n
il
n
il
Tx
l
n
n
i
k
P
=
+


=¨
1
n
t
N SNR r t
n
i
k
n
i
k
( )
( )
=

1
ˆH
H
G SNR N
G
P
n
n
il
n
il
n
il
Tx
=
+

=
1
Nn
il

328
MIMO System Technology for Wireless Communications
With the above described preamble, the minimum number Pmin of OFDM
training symbols to identify the Tx antennas is nTx. In addition, Pmin must be
a power of 2. By doubling the length of the preamble, one can double G and
correspondingly reduce the raw estimation error.
Interpolation: Actually, Equation 11.12 is the same result as for ﬂat fading
MIMO channel estimation, when each antenna is marked with a sequence
out of an orthogonal set. In OFDM systems, however, there is inherent
redundancy in the channel estimates, which can be used to reduce the chan-
nel estimation error. This method is called interpolation in the following.
The mathematical formulation is based on the elementary observation that
Equation 11.2 states an over-determined set of N equations for the frequency-
domain estimates, with only L variables being the time-domain channel
coefﬁcients. The redundancy can be exploited by ﬁrst solving this set for the
time-domain coefﬁcients, from which a ﬁltered version of the frequency-
domain estimates is obtained in a second step by discrete or fast Fourier
transform. The algorithm is described in Appendix 11A. For MIMO-OFDM,
it is applied separately for each pair of Tx and Rx antennas.
Figure 11.5 shows a simulation result for N = 48 and L = 16, according to
the IEEE 802.11a standard where L is set equal to the cyclic preﬁx length.
The dashed line corresponds to the true channel, from which we get noisy
estimates on only 48 out of the total number of 64 subcarriers (red dots) after
the raw channel estimation. After application of the interpolation, the esti-
mation error is reduced and the true channel is almost perfectly recon-
structed (solid line).
As shown in Figure 11.6, the variance of the channel estimation (CE) error
can be described by an enhanced estimator gain 
FIGURE 11.5
The OFDM channel estimation can be enhanced by interpolation of raw estimates.
abs(H) true channel 
abs(H) noisy channel estimation 
abs(H) interpolated H 
Frequency response abs (Hf)(dB) 
2 
0 
0 
10 
20 
30 
40 
50 
60 
−2
−4
−6
−8
−10
−12
−14
OFDM subcarrier number

Gigabit Mobile Communications Using Real-Time Signal Processing
329
(11.13)
where N is the number of active subcarriers and L the number of multipath
components in the channel. It is obvious from Equation 11.13 that there is a
well-deﬁned tradeoff between the parameters of the channel estimation.
Within these limits, the improved estimator gain can be used to
•
Reduce the length of the preamble P 
•
Reduce the number of subcarriers N on which pilots are transmitted
•
Reduce the channel estimation error by using a priori knowledge
about the multipath channel. When L is known in advance, for
instance by exploiting channel data from the most recent frames, L
could be much smaller than the length of the cyclic preﬁx. So the
estimator gain can be boosted. 
The interpolation must be performed once for each pair of Tx and Rx
antennas. In the experimental system, we have not had sufﬁcient resources
for performing the interpolation. The implementation on the current DSP
consumed a signiﬁcant part of the processing power, due to the large number
of 15 complex-valued channel frequency responses to be interpolated. So we
have skipped the interpolation routine in favor of a faster adaptation to the
time-variant channel. Equivalently, we have used a longer preamble as
described above to improve the raw estimates. According to Equation 11.12,
the estimator gain in the experimental system is G = 64/3 = 13.3 dB. Further
FIGURE 11.6
Simulation for the variance of the channel estimation error in Gaussian noise.
SNR (dB)
Variance of CE error σ2
ΔH
−10
10−6
10−4
10−2
100
102
10 
20 
30 
40 
64 
16 
4 
2 
1 
0 
G = 1
G = 64
ˆH
H
N
H
G SNR N
n
il
n
il
H
n
il
n
il
n
il
=
+

=
+


X)
1
G
P N
n
L
Tx
=



330
MIMO System Technology for Wireless Communications
research is concerned with extending this algorithm to a bunch of subcarriers
(chunk). Chunkwise interpolation is a key component in future MIMO-
OFDM signal processing chains. It is needed for systems with large numbers
of subcarriers to distribute the calculation of weights onto multiple DSPs,
as explained in the next section, and to reduce the computational complexity
accordingly.
11.5
Adaptation to the Time-Variant Channel
Adaptation to the time-variation of the fading channel is challenging with
the limited DSP processing power in the experimental system. First results
with a single-carrier MIMO system [14] already indicated that substantial
effort is needed here to fulﬁll the mobility requirements even for indoor
environments.
For the MMSE detector, an update of the N weights matrices for the space–
frequency post-processing is needed in a fraction of the channel coherence
time. To get a rough idea of the required processing power, we have imple-
mented the calculation of the pseudo-inverse matrix in MATLAB 5.3 and
counted the required number of ﬂoating point operations (FLOPs). For a
MIMO system with 2 Tx and 2 Rx or 4 Tx and 4 Rx, one needs 419 or 4.800
FLOPs, respectively, to get the matrix (HHH)-1HH for a single carrier needed
in Equation 11.4 for X2 = 0.* Using these values, the required processing
power PDSP is lower bounded by
(11.8)
which gives 10 and 115 MFLOPs/s in the two examples above when the
number of subcarriers and the frame length are 48 and 2 ms, respectively.
So the adaptation to the time variation is, in principle, feasible for moderate
numbers of subcarriers and antennas with current DSPs claiming peak pro-
cessing powers of more than 1 GFLOPs/s.
But DSPs are a special kind of processor. In principle, they may perform
multiple add- and multiply-operations as well as memory accesses in a single
cycle, which makes them favorable for operations with large matrices and
vectors. Only in such applications and with highly optimized code does a
DSP approach the performance limit claimed in the data sheet. Our dedicated
optimization of the MIMO algorithms on the DSP is described in detail in
[17]. Here we report some quantitative results as a benchmark of what is
* Note that MATLAB is based on the highly optimized LAPACK matrix-vector routines. The
results obtained in this way may be optimistic for a DSP implementation, where, to our knowl-
edge, routines with a truly comparable performance are not yet commercially available.
P
N FLOPs
T
DSP
frame
>


Gigabit Mobile Communications Using Real-Time Signal Processing
331
feasible with the experimental system. The performance bounds in the two
bottom lines in Figure 11.7 have been derived from an analysis of the MMSE
and zero forcing algorithms. The data on the time axis have been measured
with the ﬂoating-point DSP TI 6713 clocked at 225 MHz. We roughly need
150 or 400 µs for the 2 Tx and 2 Rx or 4 Tx and 4 Rx conﬁgurations,
respectively, to renew the MMSE weight matrices for all 48 subcarriers, which
is shorter than the channel coherence time in indoor scenarios, as required.
Note that additional time (384 µs) is needed twice in the experimental sys-
tem: to transfer the channel estimates and MMSE ﬁlter weights from and to
the FPGA, respectively. The transfer time is due to the slow external memory
interface between the DSP and the FPGA. An attempt with the Greville
algorithm [18] in assembly language has reduced the value for the 2 Tx and
2 Rx system down to 50 µs, but for this case the numbers of antennas is not
variable. Note the increasing gap to the performance bound toward smaller
matrix dimensions where the pipelined multiply-and-accumulate operations
in the DSP are less effective than for larger matrices. Pipelining is, in general,
more effective when large numbers of identical operations can be performed
consecutively.
Future mobile systems may have a larger number of subcarriers, and they
may need faster adaptation to the channel variation than our experimental
system. According to Equation 11.8, the required processing power scales
with the ratio of the number of subcarriers and the frame length, which is
a favorable characteristic of OFDM. More processing power will conse-
quently be needed.
It is therefore proposed to use multiple DSPs connected to the FPGA or
ASIC in a star conﬁguration as sketched in Figure 11.8. Each DSP is respon-
sible for a certain subset of subcarriers, and it has an individual connection
to the respective channel and weight matrices, so that the transfer time and
FIGURE 11.7
Measured times needed to track the multipath channel using the TI 6713 DSP at 225 MHz.
Total time for 48 carriers(ms) 
Number of transmit antennas 
Assembler 
program 
TI 6713/225 DSP 
ZF theory 
ZF assembler
MMSE theory 
MMSE measured 
ZF measured 
2 
3 
4 
5 
6 
1 
0.1 
0.01 
C program 

332
MIMO System Technology for Wireless Communications
computational effort can be shared among the DSPs. With this star conﬁg-
uration, the engineer can trade off hardware costs against mobility.
Intuitively, interpolation of the weight matrices between adjacent subcar-
riers might be a promising option to speed up the adaptation to the time-
variant channel [19]. However, the gain of currently known interpolation
techniques becomes noticeable only when the delay spread of the wireless
channel is rather small, relative to the CP duration. The ﬁxed base-point
interpolation in [19] causes an error ﬂoor, which can be steered using an
adaptive step width between base points [20] or even avoided by using
perfect interpolation as shown in [21,22]. A detailed complexity analysis [23]
conﬁrmed that there are few scenarios where the algorithms proposed in
[21,22] actually realize a reduced computational complexity. As observed in
[20], this is true only when the delay spread is very small. A mathematical
analysis of the reasons, therefore, is given in [21]: The interpolation of the
channel matrix needs L base points but it takes nTx · L base points for the
channel inverse matrix, which is equal to the total number of 48 subcarriers
used for 3 Tx antennas in the 802.11a standard when L is set equal to the
cyclic preﬁx length of 16. Based on what is currently known about the inverse
matrix interpolation, we feel that the pragmatic approach used in our exper-
imental system, to optimize the calculation of the MMSE weight matrix for
the DSP processor architecture and applying this routine independently for
all subcarriers, is an efﬁcient solution for most cases.
11.6
Data Reconstruction
In the optimal approach described in Section 11.2, the pre- and post-process-
ing requires linear matrix-vector multiplications to be performed individu-
ally for each subcarrier. Also the linear MMSE detector requires this
FIGURE 11.8
A star of DSPs can be used around an FPGA to speed up the channel tracking.
DSP 
DSP 
DSP 
DSP 
FPGA 
RF 
RF 
RF 
User 
Data 
A/D 
A/D 
A/D 
A/D 
A/D 
A/D 

Gigabit Mobile Communications Using Real-Time Signal Processing
333
operation. So it is straightforward to equip the detection unit with this
elementary operation. For each data stream, a scalar product with an indi-
vidual weight vector must be realized after the FFTs for each received signal
vector. To realize an instantaneous reconstruction of the streams, a pipelined
matrix-vector multiplication unit is implemented as sketched for a 2 Tx and
2 Rx MIMO-OFDM conﬁguration in Figure 11.9. The signals Yn
i incoming
from the left are the received signals for subcarrier index n leaving the
pipelined FFT unit subcarrier by subcarrier. Odd indices i = 2 · k – 1 denote
the real part of the complex-valued signal from the kth receive antenna, and
even indices i = 2 · k the imaginary part from that antenna, where k is a
FIGURE 11.9
The MIMO-OFDM data reconstruction uses a pipelined matrix-vector multiplication unit. In-
puts are the I and Q signals from each Rx antenna (Y, left), outputs are the reconstructed data
signals (X,ˆ bottom).
Xn
2
Xn
3
Xn
4
Yn
2 
Wn
12 
Yn
3 
Yn
4 
Wn
14 
Xn
1
Yn
1 
Wn
13 
Wn
11 
Wn
22 
Wn
24 
Wn
23 
Wn
21 
DSP
W6
W5
W4
W3
W2
W1
W7
Wn
32 
Wn
34 
Wn
33 
Wn
31 
Wn
42 
Wn
44 
Wn
43 
Wn
41 





334
MIMO System Technology for Wireless Communications
natural number. In the example shown in Figure 11.9, each signal branch is
distributed to four multipliers for which dedicated hardware building blocks
in the FPGA have been used. All multiplications are performed simulta-
neously (i.e., in one 10 ns cycle), and the results are added pairwise in a
subsequent pipeline until a stream is reconstructed. Due to the pipelining,
the ﬁnal result is obtained after a short delay depending on the number of
antennas. The entire data reconstruction with 3 Tx and 5 Rx requires 60
simultaneous multiplications (in one cycle) for 10 received and 6 transmitted
I and Q signals and four cycles for pairwise executed additions, resulting in
only 50 ns delay after the corresponding subcarrier signals leave the pipe-
lined FFT units, which is negligible compared to the OFDM symbol duration
of 0.8 µs.* So the data reconstruction unit performs the required 100 million
matrix-vector multiplications per second continuously in real time.
The major challenge is that the weight matrices differ from carrier to carrier
and need to be exchanged rapidly. This is shown exemplary for the weight
Wn
21 in Figure 11.9. Approximately once per frame, the frequency response
of each weight is written as a vector by the DSP into a dual-port RAM
assembled from the dedicated hardware memory blocks in the FPGA. The
second port of the dual-port RAM is connected to the dedicated multiplier
used. Now the address of the weight in the vector is counted through at 100
MHz clock synchronous with the increasing subcarrier index n of the incom-
ing signals (leaving the FFT unit subcarrier by subcarrier). In this way, the
matrix vector multiplication pipeline is reused for all subcarriers. The num-
ber of multipliers needed is related only to the numbers of antennas used
while the memory effort scales in addition with the number of subcarriers.
The rapid exchange of weights is a key idea enabling the implementation
of MIMO-OFDM with current FPGAs at 100 MHz bandwidth as shown in
the experimental system. Even higher bandwidths may be possible using
the same technique in an ASIC clocked at higher speed, accordingly. The
spatially multiplexed data streams appear separated from each other after
the matrix-vector multiplication unit. The subsequent signal processing can
be organized in parallel using conventional pipelined OFDM receiver pro-
cessing chains. System integration is straightforward (see Figure 11.11).
Therefore, we have organized the weight matrices for all carriers in register
pages assembled of 60 dual-port RAM blocks, where each RAM block con-
tains the weights for all subcarriers for one input-output pair and is located
next to the corresponding multiplier. The weights are written once per 2 ms
frame into the RAM blocks by the DSP using the outer port. Via the inner
port, the matrix-vector pipeline reads out the corresponding weight for the
current subcarrier and pair of input and output once per sample clock cycle.
In the next cycle, it switches to the next weight for the next subcarrier by
incrementing the weight address. This switching is performed simulta-
neously for all 60 weights. Once per OFDM symbol, hence, all weight matrices
* The FFT and IFFT units are implemented in parallel for all antennas using an FPGA core mod-
ule from XILINX. The pipelined units need about 1.5 OFDM symbol durations (1.2 µs) to provide
the output.

Gigabit Mobile Communications Using Real-Time Signal Processing
335
are consecutively used in the right order. The number of subcarriers that can
be handled so is limited by the number of the Block-RAM units in the FPGA.
The current FPGA design can handle up to 256 subcarriers without using
more Block-RAM units. For more subcarriers, the weight memory blocks
must be assembled from the available units in the FPGA.
11.7
Framing, Mapping, Channel Coding, and Real-Time 
Data Interface
The experimental system uses 48 data subcarriers out of a total number of
64. The sampling clock of the complex base-band signals is 200 MSPS both
in the I and Q branches and the processing clock after the digital ﬁltering is
100 MHz (which is called the sample clock). The CP covers 160 ns, which is
sufﬁcient for small rooms. The OFDM symbol duration is 0.8 µs.
Data are continuously transmitted and received in frames with a ﬁxed
length of 2 ms with no additional pauses between the frames. The structure
of the 1 Gbit/s frame is shown in Figure 11.10. It consists of 64 training
symbols for the channel estimation, an idle gap of 16 symbols, a data block
with 2400 symbols, and another idle gap of 20 symbols. With 64-QAM
modulation and three antennas, we transmit 864 bits per symbol (4818). The
2400 data symbols per 2 ms block, hence, correspond to a payload data rate
of 1036.8 Mbit/s.
The channel coding concept is shown in Figure 11.11. The payload is taken
over from the data source, scrambled and multiplexed with pseudo-random
data. Then the stream is split into four parallel streams individually encoded
using a convolutional code with a constraint length of 7 as in the IEEE 802.11a
standard. In the experiments, channel coding with rate ½ is used. The
encoded data are fed into a pseudo-random interleaver with a block length
of 288 bytes of encoded data. With 64-QAM modulation (48 · 6 bits/symbol),
the blocks are mapped onto eight consecutive OFDM symbols. The inter-
leaving covers more symbols when the number of bits per symbol is reduced,
FIGURE 11.10
Structure of the 1 Gbit/s frame. The structure is the same for all antennas.
Structure of 1.0368 Gbps-frame 
259200 byte payload
2400 OFDM symbols 64 QAM
2 ms = duration of 2500 OFDM symbols
32 C -
preambles
64 OFDM
symbols
Idle gap
16 OFDM
symbols
Idle gap
20 OFDM
symbols

336
MIMO System Technology for Wireless Communications
as for 16-QAM and QPSK modulation. The encoded stream is passed through
the modulator and then used at the ﬁrst antenna only. The other two anten-
nas are loaded with pseudo-random data. At the receiver, the reconstructed
stream of the ﬁrst antenna is at ﬁrst de-mapped and de-interleaved. Then
the original coded stream is reconstructed, de-multiplexed, and fed into four
parallel Viterbi decoders (realized in the second FPGA with an FPGA soft-
ware core module provided by XILINX) with a trace-back length of 96,
according to the multiplexing at the transmitter. The parallel coding concept
is required to overcome the speed limitations of the Viterbi decoder core in
the FPGA, which can handle up to 100 Mbit/s, depending on the code rate.
The parallel decoding concept is obviously scalable to 1 Gbit/s, but the
hardware effort scales linearly with the data rate. A third FPGA would be
required to fully decode all streams. We feel that encoding the ﬁrst stream
is sufﬁcient to proof feasibility. With the full concept, it would, of course, be
helpful to interleave over all antennas, which better exploits the transmit
diversity.
The MIMO-OFDM detector has knowledge about the post-detection SINR
on each subcarrier and each stream. Once per frame, this information is
quantized and delivered from the DSP to the Viterbi decoder to enable soft-
decision decoding (one hard plus two soft bits). The soft decoding has an
obvious effect on the performance: besides the higher coding gain, it better
exploits the multipath diversity. Finally, the decoded payload is de-scrambled
and fed into the data sink.
Data source and sink are added to the system for public demonstrations
and realized with two Real-time Linux-based PCs running a simpliﬁed
medium access control (MAC) protocol stack up to the Internet protocol (IP)
layer where the payload is bridged to an Ethernet interface. Measurements
FIGURE 11.11
Parallel decoding is used to overcome the speed limitations in the FPGA.
enc 1 
enc 2 
enc 3 
enc 4 
Demux 
Mux 
Payload 
PRBS 
Payload 
PRBS 
PRBS 
PRBS 
Antenna 1 
Antenna 2 
Antenna 3 
Pseudo- 
random 
interleaver 
mod 
mod 
mod 
De- 
interleave 
MIMO- 
OFDM 
signal 
processing 
Stream 1 
Stream 2 
Stream 3 Demod 
Demod 
Demod 
PRBS 
PRBS 
BER 2 
BER 1 
BER 3
dec 1 
dec 2 
dec 3 
dec 4
Mux 
Demux 

Gigabit Mobile Communications Using Real-Time Signal Processing
337
showed stable operation up to 80 Mbit/s, indicating that the current MAC
concept must of course be revised and simpliﬁed in the future to enable the
envisaged Gbit/s data rates on top of the MAC protocol stack. Two notebook
computers are coupled to the data source and sink PCs via Ethernet, respec-
tively, and a conventional IP network is operated, with the unidirectional radio
link in between. The reverse link is replaced by an Ethernet cable. In this way,
MPEG-encoded HDTV video transmission and data transfer are enabled.
11.8
Implementation, Complexity, and System Integration
The payload data from the source PC are coupled into the base-band pro-
cessing FPGA via ﬂat ribbon cable connected to a dedicated 64-bit PCI
interface card. The Tx signal processing is distributed over two Virtex2-6000
FPGAs placed on the Chip-it Gold platform [24]. While the ﬁrst FPGA con-
tains the data mapping and forward error correcton encoder, the second one
contains the three OFDM transmit chains. Each complex base-band signal is
connected to two 12-bit AD9753 digital-to-analogue (DA) converters operat-
ing at 200 MSPS on a small printed circuit board (see Figure 11.12) having a
large number of short parallel connections to the input-output ports at the
FPGA. Three such boards are used to realize the three Tx chains.
The operation of OFDM links requires radio front-ends with negligible IQ
imbalance. The base-band signals are up-converted to a 900 MHz intermedi-
ate frequency (IF) using three AD8349 IQ modulators, which have been care-
fully adapted to each DA converter, so that the phase error is below 0.1° and
base-band responses in I and Q branches are quasi-identical. The IF signal is
up-converted in a second stage to the 5.26 GHz radio frequency. The received
signals are down-converted to the same IF as used at the transmitter. AD8347
FIGURE 11.12
Commercially available components are used for the reconﬁgurable signal processing platform.
FFP basic 
FPGA board 
Four-channel 
ADC board 
Two-channel 
DAC, two-channel
ADC board 
PCI interface board 

338
MIMO System Technology for Wireless Communications
IQ demodulators are used to down-convert the IF signals to the complex
base-band, and the IQ mismatch in each demodulator is carefully adapted to
each analogue-to-digital (AD) converter, so that the cross-talk between image
carriers is negligible in the entire OFDM transmission chain. For the matching
procedure, see [25]. For lower bandwidth designs, one may consider digital
IQ modulation, which is not yet available for 100 MHz bandwidth.
At each Rx antenna, the base-band signals are sampled at 200 MSPS with
two AD9430 AD converters placed on a small printed circuit board having
a large number of connections in parallel to the input-output ports at the
FPGA. The ADC board already hosts four converters (see Figure 11.12), and
three such boards are used in the experimental system for the 5 Rx chains.
For the receiver base-band processing, a dedicated rapid prototyping
platform is used (FFPbasic, see Figure 11.12 and [25]) carrying two Virtex-
2/PRO-100 FPGAs (speed grade 6). The whole MIMO-OFDM base-band pro-
cessing, except the adaptation to the time-variant channel, is implemented in
the ﬁrst FPGA, while the other realizes the de-interleaving, decoding, and
de-mapping, as well as the interface to the host PC.
The adaptation to the time-variant channel is implemented in a ﬂoating-
point DSP TI 6713 placed on a standard TI development board clocked at
225 MHz clock and coupled to the FPGA using the external memory interface
(EMIF). The DSP is asynchronously coupled, and it can read from and write
to dedicated memory blocks in the FPGA (see [14]).
In the table below, the resources used in the FPGA are reported after
compiling our MIMO-OFDM software core with Version 6.3 of the XILINX
ISE development tool (from the FFT inputs to the separated data streams),
for the 3 Tx, 5 Rx conﬁguration. The 1 Tx, 1 Rx conﬁguration is given in
brackets as a reference. It can be observed in Table 11.1 that the FPGA is not
fully occupied, which allows efﬁcient routing of the design and reliable
operation at the 100 MHz sample clock. In the trial implementation described
in this chapter, the focus is to demonstrate that the MIMO-OFDM signal
processing (being the heart of the new system) is feasible in real time. Syn-
chronization is initially realized by cables. Over-the-air synchronization for
MIMO-OFDM is very similar to conventional OFDM, except that the per-
formance can be enhanced by exploiting spatial diversity. It has been added
later in the experimental system together with an enhanced number of sub-
carriers and the hardware effort required for this will be reported elsewhere.
TABLE 11.1
FPGA Resources Used for the Implementation of the 3 Tx, 5 Rx (1 Tx, 1 Rx) 
Signal Processing
FFT
Channel
Estimation
Data
Reconstruction
Total
(Integrated)
BlockRAMs
95 (19)
60 (4)
60 (4)
215 (27) of 444
Multipliers
45 (9)
—
60 (4)
105 (13) of 444
Slices
9878 (2401)
1272 (48)
2904 (24)
15.235 (2.473) of 44.036

Gigabit Mobile Communications Using Real-Time Signal Processing
339
In lower bandwidth designs, parts of the components can be reused, such
as for the FFTs, which can be consecutively used for all antennas at a corre-
spondingly higher clock. Also, the logic in the channel estimator can be
reused, when the correlation circuit is implemented once for each Tx antenna
and used consecutively for all Rx antennas with correspondingly increased
clock speed. In the matrix-vector multiplication engine, one may reconstruct
the parallel streams consecutively at a correspondingly higher clock. How-
ever, the memory effort does not reduce in this way for both the channel
estimator and the data reconstruction unit, since it depends on the number of
subcarriers and on the antenna conﬁguration. No components are reused in
the experimental system. The maximal clock of the integrated MIMO-OFDM
processing core is predicted by the XILINX ISE synthesis tool as 147 MHz.
As already mentioned, the sample rate processing is fully pipelined, in
order to allow a continuous signal ﬂow. So one cannot assign a time con-
sumption to a required operation, as this is familiar for block-wise signal
processing preferred in DSP-based implementations. In a pipelined FPGA
implementation, there is just latency for each operation since the output of
one operation is the input of the next operation in the chain, and operations
are performed simultaneously on consecutive signals. For the sake of com-
pleteness, we report the latency of important system functions in Table 11.2.
The latency for the de-interleaving and decoding is measured as the time
between the ﬁrst bit input of a data block at the de-interleaver and the ﬁrst
bit output at the Viterbi decoder for 16-QAM modulation, and it is larger
for QPSK and smaller for 64-QAM.* The given value is intended here as a
rule-of-thumb for estimating the total latency which varies, accordingly.
TABLE 11.2
Computation Times and Latencies of Different Processing Steps in the 3 Tx, 5 Rx 
Signal Processing
Function
Computation
Time
Latency
Comment
IFFT/FFT
No
1.2 µs each
Symbol-wise pipelined
XILINX FFT core, Ver. 2.1
QAM mapping/demapping
No
10 ns
Carrier-wise pipelined
uses look-up tables 
Synchronization
—
—
Not yet implemented
MIMO channel estimation
51.2 µs equal to 
preamble length 
No 
Wrapped pipeline
Calculation of MMSE 
weight matrices 
0.5 ms in DSP
No
Application of weights is 
delayed by one frame
Data reconstruction
Carrier-wise 
pipelined 
50 ns
See text
De-interleaver and decoder
Pipelined
3.4 µs 
16-QAM, see text
* De-interleaving and decoding operate on large bit sequences and input registers must ﬁrst be
ﬁlled before output can be generated. This is faster at higher data rates.

340
MIMO System Technology for Wireless Communications
Elementary system functions are supervised using the USB 2.0 interface
on the Rx FPGA board, which is frequently read out with a local monitoring
terminal (LMT) running on a notebook computer. The LMT makes available
samples from the reconstructed signal constellations on each stream, the
mean powers between each Tx and Rx antenna, the singular values of the
channel matrices, as well the good-put, which is the number of correctly
transmitted bits per second, as well as the un-coded and coded bit error
rates. Long-term statistics for these quantities are recorded in a log-ﬁle, for
off-line evaluation purposes.
The integrated transmitter and receiver racks are shown in Figure 11.13,
as well as a received signal spectrum and an LMT screenshot in the 64-QAM
mode. Each rack contains an integrated RF unit (bottom) and a base-band
unit (top). The base-band unit contains the PC (left), the FPGA board, and
(at the Rx only) the DSP (right). The received signal spectrum and the
separated 64-QAM signal constellations have been measured after transmit-
ting the signals over the air. The actual good-put is 1035.8 Mbit/s, and the
un-coded bit error rate is 10–4. The experimental system was presented at
the 3GSM World Congress, February 14–17, 2005 in Cannes, France.
11.9
Transmission Experiments
Next, we report on over-the-air measurements with the experimental system
in a mobile communications scenario. Measurements are conducted in a
FIGURE 11.13
Top left: 3-antenna transmitter. Top right: 5-antenna receiver. Bottom left: Received signal
spectrum in a 100-MHz frequency span. Bottom right: Local monitoring terminal (LMT) show-
ing the received 64-QAM signal constellations of the three data streams, for all subcarriers. The
ﬁrst stream is zoomed.

Gigabit Mobile Communications Using Real-Time Signal Processing
341
15 × 7 × 2.8 m3 ofﬁce room in a SIEMENS building at Werinher-Strasse in
Munich, Germany. At the Tx, three antennas are used addressing different
ﬁeld directions (see Figure 11.14, top left). The omni-directional Tx antennas
(360°h, 25°v, 20° down tilt) are placed at 2-m height on a wheeled photo
stand. The stand is moved like a cable car using a DC motor and guided by
a rail on a 4-m track through the room at 1-m distance from the short front
of the room (see Figure 11.14, right). The movement over 70 wavelengths at
the 5.26 GHz carrier frequency forms well-reproducible channel statistics.
The Rx sector antennas (65°h, 35°v) were ﬁxed at irregular positions approx-
imately looking toward the Tx in a line forming a distributed antenna sce-
nario (Figure 11.14, bottom, left). The distance between the Tx track and the
Rx line was about 4 m.
We ﬁrst used the built-in channel estimator to obtain information about
the broadband MIMO channel. The channel is recorded along the whole
measurement track. In Figure 11.15, the average power delay proﬁle is
shown. The time axis is scaled in samples and one sample corresponds to
10 ns.
It is observed that the peak is much wider than a sample. The 100 MHz
bandwidth obviously resolves multiple paths, mostly due to the multipath
propagation in the room. When the paths are independently faded, the larger
bandwidth is a valuable source of multipath (or frequency-) diversity, which
is a new feature of broadband compared to narrow-band MIMO systems.
Not only is the capacity a ﬁgure of merit in these systems but also the
multipath diversity can be exploited to improve the system performance.
Diversity effects are traditionally observed in the bit error rate curves at high
SNR. But one may observe them also in the cumulative distribution of the
channel capacity.
FIGURE 11.14
Measurement scenario. Top left: Tx antenna conﬁguration. Bottom left: Rx antenna conﬁgura-
tion. Right: The Tx is moved along a line through the room.

342
MIMO System Technology for Wireless Communications
The capacity distribution is obtained from the measured channel data as
follows. The data are at ﬁrst corrected for the frequency response of the
transmitter and receiver chains, which exhibit some ripple due to the ana-
logue and digital base-band ﬁlters. Since we have not observed signiﬁcant
slow fading on the relatively short track, the mean received power is aver-
aged over both all carriers and all snapshots, which gives the normalization
factor M in Equation 11.9. Finally, the broadband capacity is obtained using
the formula
(11.9)
The narrowband capacity immediately follows from Equation 11.9 for
N = 1, i.e., for a single carrier.* Results are shown in Figure 11.16. The statis-
tics for the broadband capacity are based on calculating Equation 11.9 with
N = 48 for 296 snapshots along the track. For the narrowband case, the
capacity of all 48 channels for each subcarrier is individually calculated for
all 296 snapshots, which forms a smoother statistic, due to the larger ensemble.
As expected, the cumulative distribution is shifted right when the numbers
of antennas are increased. The slope is slightly steeper, and the curve is
shifted right with additional Rx antennas (compare the 3 Tx, 3 Rx and the
3 Tx, 5 Rx conﬁgurations). The beneﬁt of the multipath diversity becomes
obvious since the broadband distributions (solid lines) are signiﬁcantly
steeper than in the narrow-band case (dashed lines). For the 3 Tx, 5 Rx
FIGURE 11.15
Average power delay proﬁle along the measurement track.
* Actually, we have used the real-valued representation of Equation 11.9, according to our meas-
ured channel data, which means that the real-valued channel matrices have the dimensions
(2nr × 2nt) so that the normalization factor M and the capacity are multiplied by two and divided
by two, respectively.
Averaged received power (a.u.) 
10 
10 
8 
8 
6 
6 
4 
4 
2 
2 
12 
14 
16 
0 0 
Path index 
×105
C
N
SNR
n
broadband
n
N
t
n
n
H
=
+

©
«
=

¨
1
2
0
1
log det 1
H H
M
ª
¹
»º

Gigabit Mobile Communications Using Real-Time Signal Processing
343
conﬁguration, we have also plotted a simulation result for the Rayleigh
fading channel with four paths (dotted line). Note that the measured capac-
ities are slightly smaller than the numerical results, most likely due to the
presence of the LOS signal.
The steeper capacity distribution in multipath fading is well known from
simulations [26]. It can quantitatively be described using the standard devi-
ation of the distribution. In Figure 11.17, simulation results are plotted vs.
the number of paths L, for the 3 Tx, 3 Rx and 3 Tx, 5 Rx conﬁgurations. There
is a certain offset between the curves, depending on the number of excess
antennas at the Rx. But in general, the width of the capacity distribution is
approximately inversely proportional to L, which is not so obvious in
FIGURE 11.16
Statistics of the narrow- (dashed lines) and broad-band capacities (solid lines) in the measured
scenario for various antenna conﬁgurations at SNR = 20 dB. A simulation curve (dotted line)
for the 3 × 5 conﬁguration for the Rayleigh fading channel with four independently and iden-
tically distributed paths is given as well.
FIGURE 11.17
Standard deviation of the capacity distribution for different numbers of resolved paths.
Capacity (bits/s/Hz) 
Cumulative probability 
0 
5 
10 
15 
20 
25
1 Tx, 
1 Rx 
2 Tx,  
2 Rx 
3 Tx,  
3 Rx 
3 Tx, 
 5 RX 
0 
0.2 
0.4 
0.6 
0.8 
1 
Simulation 
3 Tx, 5 Rx 
Standard deviation of the
capacity(bps/Hz)
1
1
10
Simulation 3 × 3
Simulation 3 × 5
Multipath MIMO
SNR = 20 dB
Number of resolved paths L

344
MIMO System Technology for Wireless Communications
Equation 11.9, where the capacity is averaged over the number of subcarriers.
Effectively, the capacity is averaged over the number of independent paths
in the channel, which is intuitive. Large numbers of paths with signiﬁcant
separation in the delay domain are typical for urban outdoor scenarios where
the line of sight between the base station on a rooftop of a higher building
and the mobile terminal in a street canyon may be frequently blocked or
shaded so that the received signal is mostly due to multipath propagation.
The more independently faded paths are resolved, the more such a broad-
band MIMO system performs as a wired link, despite the fading in the radio
channel.
In Figure 11.18 (top), the measured bit error rates (BERs), spatially resolved
along the measurement track, are individually plotted for the three spatially
multiplexed streams using 64-QAM modulation, which is the 1 Gbit/s mode.
At the bottom of Figure 11.18, the coded error rate for the ﬁrst data stream
is plotted for the same measurement. Due to the fading, the un-coded error
rates vary along the track between 10–3 and 3 · 10–2. The regions with lower
and higher error probability are reproducible also for the 16-QAM and QPSK
modes, of course at substantially reduced error numbers. Approximately at
10–2, the coded 64-QAM data are error free. Only at three positions, a minor
outage occurs in the ﬁrst stream, but the coded error rate always remains
below 10–6. Note that there are substantial regions along the track where all
three data streams have an un-coded error rate below 10–2. In these regions,
the good-put (i.e., the number of correctly detected bits per second) is larger
than 1 Gbit/s, and all three encoded streams may simultaneously show no
outage, if the channel coding is fully implemented.
In Figure 11.19 (top), we have plotted the average un-coded bit error rates
for BPSK, 16-QAM, and 64-QAM modulation vs. attenuation at the trans-
mitter. The Tx power at all antennas is set equal (±1 dB) to 0 dBm at ﬁrst.
The automatic gain control (AGC) is then regulated at a central position on
the track and then held ﬁxed for all measurements.* The Tx is moved along
the whole track for each attenuation at the transmitter. 
At no attenuation, the average bit error rate in the 64-QAM mode is about
10–2, and the coded data of the ﬁrst stream have an average error rate of
1.2  10–8, indicating the low outage probability despite the statistical fading
in the channel. For the 3 Tx and 5 Rx antenna conﬁguration, with the MMSE
detector, one would expect a spatial diversity order of 3 in the Rayleigh
fading channel, which is comparable with the slope of the un-coded bit error
rate curve for QPSK in the high SNR region, as expected. The coded bit error
rate curves are, of course, much steeper, which is partly attributed to the
additional multipath diversity.
* The AGC is set jointly for all antennas such that the antenna signal with the largest received
power is below a threshold empirical determined by minimizing the bit error rate in all streams
due to clipping of peak amplitudes at the AD converters.

Gigabit Mobile Communications Using Real-Time Signal Processing
345
11.10
Conclusions
We have presented a real-time concept for mobile communications that is
suitable for data rates of 1 Gbit/s, based on MIMO-OFDM. Perhaps the most
striking feature of MIMO-OFDM is that it is easily scaled to higher bandwidth,
as demonstrated in this chapter, whereby the required signal processing
complexity increases just linearly with the bandwidth (in the same channel).
FIGURE 11.18
(a) Un-coded bit error rates of the three data streams along the measurement track in 64-QAM
mode. (b) Coded error rate for stream 1 in the same measurement.
10−1
10−2
10−3
(a) 
(b)
10−4
un-coded bit error rate 
Stream 1 
Stream 2
Stream 3
Coded bit error rate 
10−6
10−7
10−8
0 
Distance(m) 

346
MIMO System Technology for Wireless Communications
For this reason, the complexity of the spatio-temporal coding can be handled
with currently available signal processing components. Additionally, the
same fundamental approach as used for narrow-band can be applied for
broad-band applications as well. The concept may, therefore, be a good
starting point for the next generation of mobile systems, when it is further
equipped with the required multi-user functionality.
We have shown how the elementary base-band signal processing for
MIMO-OFDM can be implemented efﬁciently on a reconﬁgurable real-time
signal processing platform and integrated with the MIMO-OFDM core in a
fully functional radio system.
Mobile transmission experiments have been conducted in an indoor envi-
ronment, and the system allowed reliable transmission of data at a gross
FIGURE 11.19
Measured un-coded and coded bit error rates vs. the attenuation at all Tx antennas.
Measured uncoded BER
Measured BER after error correction
10–2
10–3
10–4
10–1
10–5
10–2
10–3
10–4
10–1
10–5
10–2
10–3
10–4
10–1
10–5
10–2
10–3
10–4
10–1
10–5
QPSK
16-QAM
64-QAM
Attenuation at all Tx antennas(dB)
24
21
18
15
12
9
6
3
0
24
21
18
15
12
9
6
3
0

Gigabit Mobile Communications Using Real-Time Signal Processing
347
data rate of up to 1 Gbit/s. After error correction coding, the link is free of
error at almost all locations along the measurement track. Mobile data and
video transmission was also demonstrated with the experimental system.
The excellent performance of the experimental system may be attributed
to three major reasons. The indoor channel offers sufﬁciently rich scattering.
The inﬂuence of channel estimation errors is negligible due to the high
estimator gain, and the two excess antennas at the receiver enable a perfor-
mance similar to a 3 Tx, 3 Rx MIMO system using the optimal maximum-
likelihood detection instead of the linear MMSE.
But there are some points noteworthy for future research. The overall
MIMO-OFDM physical layer is currently feasible in real time for low mobility
with a moderate number of subcarriers. The limiting factor here is the large
number of matrix inversions or singular value decompositions to be per-
formed in the DSP in a fraction of the channel coherence time. With the same
number of antennas but 20 times the number of subcarriers (as recently
discussed in the 3GPP Long Term Evolution study item), about 20 times the
DSP power would be needed for the adaptation to the time-variant channel
compared to our experimental system. In the FPGA, just the memory effort
would be increased by factor 20. Fortunately, a single user is assigned to
only a fraction of the bandwidth and so the computational effort at the
terminal may still be in a realistic region for the down-link. For the up-link
at the base station, however, the full processing power must be available. A
practical way out is to perform those matrix computations in a chunkwise
manner, i.e., for subgroups of subcarriers, with multiple DSPs operating in
parallel in order to meet these challenging requirements. In this way, the
transfer times of channel estimates and weights can be reduced as well.
Also the MAC functions must be further simpliﬁed and partly imple-
mented in hardware, similar to the sample rate processing for MIMO-OFDM,
to allow such high data rates at the interface of the application in the future.
11.11
Summary
We develop a concept and describe the realization of an experimental mobile
communication system that can transmit data continuously up to 1 Gbit/s
in mobile scenarios by means of real-time base-band signal processing.
To allow for mobility, omni-directional antennas are used. This is in con-
trast to ﬁxed wireless links, which normally use directional antennas and
line-of-sight connections. A coded OFDM scheme is used to overcome the
resulting multipath fading effects. The spectral efﬁciency is boosted with
multiple transmit and multiple receive antennas. In order to identify at the
receiver the signals from multiple transmit antennas, we apply a novel
preamble enabling precise channel estimates on each OFDM subcarrier by

348
MIMO System Technology for Wireless Communications
means of a highly parallel correlation circuit. Spatial multiplexing is indi-
vidually applied on each OFDM subcarrier. Techniques to speed up the
adaptation of the base-band processing to the time-variant channel are
described, and it is shown how the spatially multiplexed streams can be
instantaneously reconstructed.
Key functions of the concept have been realized and tested in an experi-
mental system. The real-time base-band processing is implemented on a
hybrid FPGA/DSP platform. Using a few elementary processing compo-
nents, the implementation is easily scalable with respect to the numbers of
subcarriers and antennas. For the gross data rate of 1 Gbit/s, the experimen-
tal system is conﬁgured with three transmit and ﬁve receive antennas, and
it uses 48 out of 64 OFDM subcarriers. All carriers cover a bandwidth of
100 MHz at an RF carrier frequency of 5.26 GHz. 
Finally, the system is used for mobile transmission experiments. Using the
built-in channel estimator, we investigate the channel properties of an exem-
plary mobile indoor scenario. Then we report on over-the-air bit error rate
measurements with the experimental system for various modulation formats.
11.12
Acknowledgments
The authors wish to thank Stefan Schiffermueller and Clemens von Helmolt
(both from Fraunhofer HHI); Frank Luhn, Marian Pollock (from IAF GmbH);
and Matthias Lampe, Joseph Eichinger, and Egon Schulz (from SIEMENS) for
their valuable contributions in completing this project. We are grateful to the
Bundesministerium für Bildung und Forschung (BMBF) and SIEMENS for
ﬁnancial support in research projects Coverage, HyEff, 3GeT, and WIGWAM.
Appendix 11A
Here we describe an elementary interpolation scheme to improve the fre-
quency-domain channel estimates. It is based on the elementary relation
(Equation 11.2) between frequency- and time-domain channel coefﬁcients
(Hn and hl, respectively) in OFDM systems. Equation 11.2 is a set of N
equations with L variables, where L is the number of resolved multipaths.
To solve for hl, the values Hn are stacked in a (1 × N) vector H where N is
the total number of subcarriers. Similar to the discrete Fourier transform,
Equation 11.2 is rewritten as a multiplication of a (N × L) matrix W with a
vector containing the time-domain channel coefﬁcients stacked in the (1 × L)
vector h
(11A.1)
H
W h
=


Gigabit Mobile Communications Using Real-Time Signal Processing
349
where the elements of the matrix W are given as
(11A.2)
In practice, some values in H are not available, due to a spectrum mask
or the presence of pilot carriers. The available estimates are, hence, described
by a reduced form of Equation 11.2 as
(11A.3)
where the index red means that the rows corresponding to the missing
estimates in H and W are ﬁlled with zeros. Also, there is a vector Nred in
Equation 11.A.3 describing the estimation error. In a ﬁrst step, the time-
domain estimates are obtained by using the pseudo-inverse W+
red as
(11A.4)
when Wred is well conditioned. This is true if Nred v L (interpolation rule),
where Nred is the number of subcarriers on which channel estimates are
available. In a second step, Equation 11.2 is used to interpolate the channel
coefﬁcients.
This way we also get useful results for channel coefﬁcients on those sub-
carriers where estimates are not available. Note that the product W  W+
red has
dimension (Nc × Nc) but rank L, which explains the ﬁltering effect observed
in Figure 11.5 and Figure 11.6.
Appendix 11B
Here we like to mention a particular phenomenon when the signal processing
and the radio frequency (RF) front ends are combined to operate the OFDM
link over the air. Beside the IQ imbalance problems already mentioned in
the text, in addition the subcarrier assignment is mixed up at ﬁrst sight.
The proper assignment for a given RF transmitter can be tested in the lab.
Use an arbitrary waveform generator (like the SMIQ- or SMU-ARB from
R&S or a ﬂexible transmitter signal processing platform) to create time-
domain OFDM test signals from MATLAB, for instance. Load the test signal
into the generator, feed the signal into the complex-valued base-band IQ
inputs of the transmitter front end, and observe the spectrum of the trans-
mitted signal with a spectrum analyzer (as the FSQ form R&S). With our RF
front ends, we have observed the following:
W
j
nl
N
nl =

©
«ª
¹
»º
exp
2U
H
W
h
N
red
red
red
=

+
ˆh
W
H
=

+
red
red

350
MIMO System Technology for Wireless Communications
•
Starting from MATLAB, the subcarrier index n varies from 1 to N.
•
The subcarrier with index 1 is centered at the RF carrier frequency.
Due to the instable DC offset at the receiver* it is normally not used
for communication.
•
The subcarriers with indices 2 f n f N/2 are mapped “en block” to
frequencies larger than the RF carrier.
•
The subcarriers with indices N/2+1 f n f N are mapped “en block”
to frequencies smaller than the RF carrier such that the ﬁrst subcar-
rier in this group with index N/2+1 has the smallest RF frequency
and the last subcarrier with index N is close to the RF carrier. Intu-
itively this assignment is clear from the periodicity of the discrete
Fourier transform: if y(n) is the FFT of Y(k), then y(n) = y(n + N).
Starting from the natural placement of the subcarrier with n = 1 at
the RF carrier frequency, the observed carrier placement is explained
by continuing the FFT spectrum periodically to low RF frequencies. 
•
If base-band I and Q inputs are exchanged, the carrier assignment
is reversed.
•
Once subcarriers are properly addressed at the transmitter such that
the rectangular spectrum of OFDM signals is realized, the order of
signals at the receiver can be checked accordingly. If the order is not
correct, changing the sign of the Q branch in time domain may be
helpful.
We have matched the OFDM signal processing according to our RF front
ends such that subcarriers are placed properly both in the RF domain at the
transmitter and in the base-band domain at the receiver. In general, take care
at the base-band-to-RF interface; design the OFDM signals accordingly. Do
not confuse base-band I and Q inputs or outputs.
* It is related to the “carrier-feedthrough” signal from the IQ modulator at the transmitter, which
is more or less faded in the radio channel and then down-converted to a very unstable DC signal
at the receiver.

Gigabit Mobile Communications Using Real-Time Signal Processing
351
References
1. 3GPP TSG RAN Future Evolution Workshop, November 2–3, Toronto, CA,
ftp://ftp.3gpp.org/workshop/2004_11_RAN_Future_Evo/.
2. P.F. Driessen and L.J. Greenstein. 1995. “Modulation techniques for high-speed
wireless indoor systems using narrowbeam antennas,” IEEE Transactions on
Communications, Vol. 43, No. 10, Oct. 1995.
3. C. Evci, A. de Hoz, R. Rheinschmitt, M. Araki, M. Umehira, M.A. Beach,
P. Hafezi, A. Nix, Y. Sun, S. Barberis, E. Gaiani, B. Melis, G. Romano, V. Palestini,
and M. Tolonen. 1999. “AWACS: system description and main project achieve-
ments,” Proceedings ACTS Mobile Communications Summit, Sorrento, Italy,
June 8–11, 1999.
4. G. Grosskopf, A. Norrdine, D. Rohde, and M. Schlosser. 2004. “Gigabit Ethernet
Transmission Experiments at 60 GHz,“ Proceedings 13th International Plastic
Optical Fibres Conference, Nürnberg, Germany, Sept. 2004 (on CD-ROM).
5. D.R. Wisely. 1996. “A 1 Gbit/s optical wireless tracked architecture for ATM
delivery,” Proceedings IEE Colloquium on Optical Free Space Communication Links,
London, pp. 14/1–7.
6. C.B. Papadias and H. Huang. 2001. “Linear space-time multiuser detection for
multipath CDMA channels,” IEEE Journal of Selected Areas in Communications,
Vol. 19, No. 2, pp. 254–265.
7. V. Jungnickel, H. Chen, and V. Pohl. 2005. “A MIMO RAKE receiver with
enhanced interference cancellation,” Proceedings Vehicular Technology Conference
(VTC Spring), Stockholm, Sweden, May 30–June 2, 2005 (on CD-ROM).
8. G.G. Raleigh and J.M. Ciofﬁ. 1998. “Spatio-temporal coding for wireless com-
munications,” IEEE Transactions on Communications, Vol. 46, No. 3, March 1998.
9. A. van Zelst and T. C.W. Schenk. 2004. “Implementation of a MIMO OFDM-
based wireless LAN system,” IEEE Transactions on Signal Processing, Vol. 52,
No. 2, Feb. 2004, pp. 483–494.
10. W. Xiang, D. Waters, T.G. Pratt, J. Barry, and B. Walkenhorst. 2004. “Implemen-
tation and experimental results of a three-transmitter three-receiver
OFDM/BLAST testbed,” IEEE Communications Magazine, Vol. 42, No. 12, Dec.
2004, pp. 88–95.
11. C. Dubuc, D. Starks, T. Creasy, and Y. Hou. 2004. “A MIMO-OFDM prototype
for next generation wireless WANs,” IEEE Communications Magazine, Vol. 42,
No. 12, Dec. 2004, pp. 82–87.
12. K. Mizutani, K. Sakaguchi, J. Takada, and K. Araki. 2004. “Development of
4 × 4 MIMO-OFDM system and test measurements,” Proceedings 12th European
Signal Processing Conference (EUSIPCO), Vienna, Austria, Sept. 6–10, 2004 (on
CD-ROM).
13. S. Häne, D. Perels, D.S. Baum, M. Borgmann, A. Burg, N. Felber, W. Fichtner,
and H. Bölcskei. 2004. “Implementation aspects of a real-time multi-terminal
MIMO-OFDM testbed,” Proceedings IEEE Radio and Wireless Conference
(RAWCON), Atlanta, GA, Sept. 2004 (on CD-ROM).
14. V. Jungnickel, T. Haustein, A. Forck, U. Krueger, V. Pohl, and C. von Helmolt.
2004. “Over-the-air demonstration of spatial multiplexing at high data rates using
real-time base-band processing,” Advances in Radio Science, Vol. 2, pp. 135–140,
available: http://www.copernicus.org/URSI/ars/ARS_2_1/135.pdf.

352
MIMO System Technology for Wireless Communications
15. T. Ylämurto. 2003. “Frequency domain IQ imbalance correction scheme for
OFDM Systems,” Proceedings IEEE Wireless Communications and Networking Con-
ference (WCNC), New Orleans, LA, March 16–20, 2003 (on CD-ROM).
16. G.L. Stuber, J.R. Barry, S.W. Mclaughlin, Y.G. Li, M.A. Ingram, and T.G. Pratt.
2004. “Broadband MIMO-OFDM wireless communications,” Proceedings of the
IEEE, Vol. 92, Feb. 2004, pp. 271–294.
17. T. Haustein, A. Forck, H. Gäbler, V. Jungnickel, and S. Schiffermüller. “Real
time signal processing for multi-antenna systems: algorithms, optimization and
implementation on an experimental test-bed,” accepted for EURASIP Special
Issue on MIMO Implementation Aspects, 2005.
18. F. Gantmacher. 1986. Matrizentheorie, Berlin: Springer-Verlag.
19. J. Wang and B. Daneshrad. “Performance of linear interpolation-based MIMO
detection for MIMO-OFDM systems,” Proceedings IEEE Wireless Communications
and Networking Conference, Atlanta, GA, March 21–25, 2004 (on CD-ROM).
20. V. Jungnickel, T. Haustein, A. Forck, S. Schiffermueller, H. Gaebler, C. von
Helmolt, W. Zirwas, J. Eichinger, and E. Schulz. 2004. “Real-time concepts for
MIMO-OFDM,” Proceedings CIC/IEEE Global Mobile Congress, Shanghai, China,
October 11–13, 2004.
21. M. Borgmann and H. Bölcskei. 2004. “Interpolation-based efﬁcient matrix in-
version for MIMO-OFDM receivers,” Proceedings 38th Asilomar Conf. Signals,
Systems, Computers, Paciﬁc Grove, CA, Nov. 2004 (invited).
22. D. Cescato, M. Borgmann, H. Bölcskei, J. Hansen, and A. Burg. 2005. “Interpo-
lation-based QR decomposition in MIMO-OFDM systems,” Proceedings 6th
IEEE Workshop on Signal Processing Advances in Wireless Communications
(SPAWC), New York, June 2005 (invited).
23. T. Haustein, S. Schiffermueller, V. Jungnickel, M. Schellmann, T. Michel, and
G. Wunder. 2005. “Interpolation and noise reduction in MIMO-OFDM — a
complexity driven perspective,” Proceedings ISSPA, Sydney, Australia, Aug.
28–Sept. 1, 2005.
24. http://www.prodesign-europe.com/ce/CHIPitGoldEdition.htm
25. http://www.iaf-bs.de/products/add-on-boards/
26. A.J. Paulraj, D.A. Gore, R.U. Nabar, and H. Bölcskei. 2004. “An overview of
MIMO communications — a key to Gigabit wireless,” Proceedings IEEE, Vol. 92,
No. 2, Feb. 2004, pp. 198–218.

353
12
Network Planning and Deployment Issues 
for MIMO Systems
Thomas Neubauer, Ernst Bonek, and Christoph Mecklenbräuker
CONTENTS
12.1 Network Planning .....................................................................................353
12.1.1 Introduction to Network Planning.............................................357
12.1.1.1 Planning and Optimizing for Advanced 3G 
Technologies ...................................................................358
12.1.1.2 Advanced Planning and Optimization Methods.....359
12.1.2 Coverage and Capacity Enhancement Methods......................360
12.1.2.1 Fewer Base Stations.......................................................360
12.1.2.2 Savings in CapEx and OpEx .......................................360
12.1.2.3 Best Deployment of Budget.........................................361
12.1.2.4 Most Cost-Effective Technology Deployment ..........362
12.1.3 Base Stations with Downlink Transmit Diversity and 
Beamforming..................................................................................362
12.2 Deployment ................................................................................................364
12.3 Smart Antenna Planning Example .........................................................364
References.............................................................................................................368
12.1
Network Planning
Network planning for MIMO systems is still in its infancy while the planning
of radio networks with beamforming enhancements is more mature. The
possible gain obtained from MIMO transmission and reception is currently
being intensely investigated by information theorists and baseband signal
processing experts. From a purely physical layer perspective, MIMO systems
provide three different types of gain that can be traded off against each other:

354
MIMO System Technology for Wireless Communications
spatial diversity gain [2], spatial multiplexing gain [3], and beamforming
gain. These tradeoffs are illustrated in the triangle in Figure 12.1. In his
doctoral thesis, Weichselberger has shown that this “magic triangle” can be
broken up into three dichotomies, depending on whether the channel is
directive or diverse at either link end [1]. The chart in Figure 12.2 illustrates
the possible dichotomies depending on the available diversities or directiv-
ities of the MIMO channel. The diversity gain decreases outage probabilities,
while the multiplexing gain increases physical layer symbol rate. Decreased
outage probabilities translate into increased coverage without increasing
transmit power. 
FIGURE 12.1
The magic triangle of Array Gain, Diversity, and Spatial Multiplexing [1].
FIGURE 12.2
Diversity vs. directivity dichotomies.
•  Increase power  
•  Beamforming  
• Multiply data rates  
• Spatially orthogonal channels  
Spatial 
Multiplexing 
• Mitigate fading  
• Reduce outage  
• Space-time coding  
Diversity 
Array gain 
Diverse
Rx side 
Rx-diversity 
Spatial 
multiplexing 
(Rx-Tx-diversity) 
Beam-forming
Directive 
Diverse 
Tx side
Tx-diversity 

Network Planning and Deployment Issues for MIMO Systems
355
Diversity gains have been exploited on the receiver side in mobile commu-
nications for several decades. Relatively recent is the introduction of transmit
diversity through space–time coding in third generation cellular networks.
According to the 3GPP air interface speciﬁcation, transmit diversity must be
supported by the terminals. This means that network operators have the
choice of whether or not to provision for transmit diversity in their radio
networks. A signiﬁcant challenge associated with specifying the performance
of downlink transmit diversity in cellular networks is the identiﬁcation of a
representative mobile terminal performance. The mobile terminal implemen-
tation inﬂuences the performance of transmit diversity schemes. For packet
services with automatic repeat request (ARQ), diversity gains at the physical
layer translate into a reduced number of required retransmissions. Thus,
transmit diversity gains result in increased MAC-layer throughput for packet
services by reducing the average retransmission count. Spatial transmit
diversity schemes are particularly suited for microcells where the capacity
gains are large and beamforming is less appropriate due to large angular
spread [4].*
Spatial multiplexing gains increase the symbol rate on the transmitter side
and translate into higher peak data rates. Currently, spatial multiplexing is
not speciﬁed as a mandatory feature in any type of commercial radio access
network, although proprietary MIMO systems with spatial multiplexing
gains are commercially available. Spatial multiplexing is anticipated as a
future enhancement for third generation cellular systems, wireless LANs,
and wireless metropolitan networks (MANs). For spatial multiplexing, the
identiﬁcation of a representative mobile terminal performance is even more
troublesome than for the case of transmit diversity. 
A summary of the information-theoretical limits on the available gains
from multiple transmit and receive antennas is given in Table 12.1. The SIMO
conﬁguration refers to a single transmit antenna and MR receiver antennas,
TABLE 12.1
Information-Theoretic Limits on Gains in SIMO, MISO, and MIMO 
Systems [3]
Conﬁguration
Channel State at Tx
Expected Array Gain
(Beamforming Gain)
Diversity Order
SIMO
Unknown
MR
MR
SIMO
Known
MR
MR
MISO
Unknown
1
MT
MISO
Known
MT
MT
MIMO
Unknown
MR
MRMT
MIMO
Known
E{Qmax}
MRMT
* Actually, the use of angular spread as a means for characterizing a MIMO radio channel is
rather coarse. It is more appropriate to evaluate angular spreads after clustering the propagation
paths of the MIMO channel [5].

356
MIMO System Technology for Wireless Communications
which correspond to receiver antenna diversity. We note that the diversity
gain becomes MR and the expected array gain is also MR. For the MISO
conﬁguration, multiple transmit antennas are deployed with a single receive
antenna. This corresponds to transmit diversity when the transmitter is
ignorant of the channel and to transmit beamforming if the transmitter
knows the channel, respectively. The limits in this table assume that the
receiver always knows the channel. We note that the gains are not just limited
by the numbers of antennas in a cellular network conﬁguration, but also by
the availability of channel state information at the transmit side. For further
details, we refer to [3].
A key problem of network planning for MIMO systems is a lack of avail-
able MIMO propagation models, which can be used for predicting the signal
ﬁeld strength jointly with the number of available dimensions in the signal
space for speciﬁc sites. In contrast, propagation models for single antenna
transmission and reception can be considered mature. In modern radio net-
work planning tools, the propagation model consists of a basic pathloss
model, line-of-sight checking, and corrections for topography, morphogra-
phy, and street orientation [4, chap. 3]. Propagation models for MIMO trans-
mission are much less understood, but the recently developed model within
COST 273 carries great promise [6].
For MIMO systems in which the transmitter does not have channel state
knowledge, the instantaneous capacity can be calculated from
where IMR denotes the identity matrix of order MR and H is the MIMO channel
matrix, W is the mean receive SNR, and XH is the Hermitian transpose of X.
If the distribution of H were known, the distribution of C could be deter-
mined. Sadly, the distribution of H parameterized by receiver location, base
station antenna array height, and conﬁguration in real environments is little
understood. Most current MIMO literature treats the matrix elements of H
as (more or less) independent identically distributed, which leads to opti-
mistic values of capacity. It would mean that adjacent receive antenna ele-
ments carry fully decorrelated signals, e.g., as a consequence of random
multipath from all directions in a non-line-of-sight (NLOS) environment. In
[7], it was shown that MIMO capacity can have a large local variation in an
indoor scenario, depending on the position of the antenna arrays and on the
environment. The only solution currently at hand is to carry out detailed
MIMO channel measurements to link topology and morphography with
MIMO channel statistics.
Finally, we point out that the gains summarized in Table 12.1 affect the
signal to interference plus noise ratio (SINR) of individual links. These gains
affect the link quality statistics directly. In interference-limited situations,
C
M
M
T
R
=
+
©
«ª
¹
»º
logdet
H
I
W HH

Network Planning and Deployment Issues for MIMO Systems
357
these gains translate into throughput gains. If the situation is operating near
the hard-blocking limit, no such throughput gains can be achieved.
12.1.1
Introduction to Network Planning
In order to understand why effective radio network planning is essential for
every operator, we will present some numbers from an investor’s perspective
[8]: Governments in Europe raised about 120 billion Euro in fees for UMTS
licenses. As an example, the government in the U.K. raised 39.3 billion Euro
in fees from ﬁve Mobile Network Operators (MNOs), which is about 31.2
Euro per head of the population per year, for the duration of the license
validity (20 years).
All of a sudden, many national governments realized that UMTS fees could
be extremely valuable, and this set the scene for a feeding frenzy among
governments trying to maximize the proceeds of access rights to UMTS
frequency bands. The German auction resulted in a per capita fee (30.9 Euro
per head of the population per year — for 20 years) that was similar to the per
capita fee in the U.K. market. This enormous amount of money, which is
just an investment for the “admission to further invest money,” has to be
earned by the operators during the license validity period of typically
15–20 years. For many other governments the outcome of further auctions
was disappointing, or in other words, operators had a more realistic view
of business cases and license fees. 
3G operators are currently making heavy investments in UMTS infrastruc-
ture. The analysis in [8] shows that the costs of building 3G networks in
Europe will be in excess of 140 billion Euro.
In order to launch these networks, strategies for the deployment must be
coupled with realistic business cases in order to determine the demand for
future services and applications, as well as investments required for network
infrastructure.
The evaluation of network infrastructure requirements can be achieved by
system dimensioning, i.e., radio network planning. The network planning
must be able to model the system behavior for individual business cases,
service proﬁles, and network loadings. Since radio network planning and
optimization are ongoing processes, the network efﬁciency, and hence the
required investments, will heavily depend on them.
The capacity and coverage analyses in 3G CDMA networks can no longer
be separated from the actual trafﬁc demand in the system. However, the
future 3G trafﬁc demand can be divided into two individual aspects.
•
Increased data rates: In GSM the average data rate is on the order
of 10 kbit/s. In UMTS we expect an increase in the service data rate
of up to 384 kbit/s or even higher.
•
Increased number of subscribers: The number of users in UMTS
networks is expected to grow substantially over the next few years.

358
MIMO System Technology for Wireless Communications
Figure 12.3, as an example from the world’s most experienced UMTS
network FOMA, shows the increase in the number of users in the
W-CDMA network of NTT-DoCoMo in Japan, reaching more than
12 million by April 2005.
Since 3G CDMA networks are interference-limited, higher trafﬁc means
higher interference, and hence, a permanent network improvement and
optimization based on future trafﬁc and service expectations will be essen-
tial. A direct consequence of this is the development of enhanced radio
network planning and optimization tools, with the aim of adjusting the
UMTS radio network conﬁguration depending on the actual requirements.
12.1.1.1
Planning and Optimizing for Advanced 3G Technologies
While the initial planning and deployment of 3G networks is going on, a
number of enhanced and advanced features are expected to be deployed
and used over the next few years. In order to maximize the return on
investment of these advanced technologies, their usage needs to be compre-
hensively planned and optimized. 
FIGURE 12.3
Subscriber growth from the world’s ﬁrst commercial W-CDMA network, FOMA (NTT DoCoMo,
Japan). Source: NTT DoCoMo.
A
M
M
J
J
J
D
F
A
M
J
S O N
A M
J
J A S O N
D
F
2004
2005
16,000
15,000
14,000
19,000
18,000
17,000
13,000
12,000
11,000
10,000
9,000
8,000
7,000
6,000
5,000
4,000
3,000
2,000
1,000
11,501
7,569
5,272
3,045
14,907
18,588
(Thousand)

Network Planning and Deployment Issues for MIMO Systems
359
Examples for such technologies are Remote Electrical Tilt (RET) antennas
(3GPP [9]), Tower Mounted Ampliﬁers (TMA), Tower Mounted Boosters
(TMB), micro- and picocells, higher sectorization, additional carriers, Multi
User Detection (MUD), higher order receive/transmit diversity, smart anten-
nas* and, most recently, MIMO transceivers.
With the introduction of HSDPA (high speed downlink packet access),
UMTS will provide data rates of up to 14 Mbit/s.** HSDPA will use a higher-
order modulation scheme (namely 16-QAM) which will bring new challenges
for the planning and optimization process in UMTS. 
12.1.1.2
Advanced Planning and Optimization Methods
While automatic frequency planning was of little interest during the early
days of GSM, it is highly important for all GSM networks these days. Basi-
cally every single GSM planning tool has an automatic frequency planning
functionality included.
In 3G-CDMA networks the use of advanced methods is even more impor-
tant due to the more complicated nature of CDMA networks. The equivalent
to automatic frequency planning tools in GSM are automatic design and
optimization tools that support the planning and optimization process, as
well as the introduction of advanced radio technologies in 3G and beyond.
The basis for decisions on the network quality, key design, and optimization
performance indicators for UMTS networks include:
•
Clear Pilot dominance: Distinct cell boundaries with limited over-
lapping areas are in high demand.
•
Pilot Ec/Io: Pilot Ec/Io planning and optimization is the most impor-
tant step in any CDMA design.
•
Pilot Pollution: A polluter is a received pilot sequence in the down-
link that meets all criteria to enter a given mobile’s active set but is
not admitted due to the active set’s size limit or restrictions by the
implemented RAKE receiver.
•
Handover Areas: Desired handover percentages are in the range of
20 and 35%.
•
System load: Using trafﬁc forecasts, service types, and trafﬁc distri-
bution maps, Monte Carlo simulations can be carried out to identify
cell loading and throughput of the network.
* Smart antennas become ﬁnally available for 3G radio network technologies. In the North
American CDMA2000 networks vendors such as Nortel, Lucent, and Samsung have already
introduced smart antenna base stations. In the Chinese 3G standard TD-SCDMA smart antennas
are used at every single base station. Smart antenna base stations are commercially available,
such as the Siemens NB430TS and the NB450TS. Even though they are not mandatory, smart
antennas are becoming an industry standard for TD-SCDMA.
** NTT DoCoMo committed to HSDPA and introduced this technology before the end of 2005.

360
MIMO System Technology for Wireless Communications
Automated design and optimization tools are currently attracting great
interest from 3G operators and vendors. They will be highly important to
maximize the coverage, quality, and capacity tradeoff in 3G networks, and at
the same time, to maintain a high ﬂexibility for future CDMA needs and
requirements.
12.1.2
Coverage and Capacity Enhancement Methods
The key reason for operators to introduce advanced coverage and capacity
enhancement methods is to achieve a better return on investment. The return
on investment in wireless network infrastructure is given by the income
enabled due to the usage of the infrastructure equipment. However, since the
availability of the infrastructure is a requirement, rather than a driver for higher
revenues, it is more and more considered as bit pipe for wireless services.
Therefore, a general business strategy for wireless service providers is to
reduce the infrastructure cost as much as possible, while providing sufﬁcient
coverage, quality, and capacity for the network.
12.1.2.1
Fewer Base Stations
Automated design optimization tools in combination with advanced radio
technologies are currently developed and used for 3G radio network plan-
ning and design. These tools compute the minimum resources required to
satisfy coverage/quality/capacity requirements. Simultaneously, design
optimization ﬁnds the best radio conﬁguration for each site/sector as well
as the best strategy to introduce advanced radio technologies. By doing so,
such tools boost the overall network performance. The more efﬁcient use of
the infrastructure results in fewer base stations for the same performance,
compared to a manual design.
12.1.2.2
Savings in CapEx and OpEx
The design and deployment of a radio network is an ongoing process. The
requirements for the network change during the network lifecycle. While
the provision of sufﬁcient coverage is of highest priority at rollout, service
quality and capacity requirements dominate in the longer term.
To reduce the costs of the initial network, staged deployment plans are
developed. Again, automated design optimization tools and advanced radio
technologies deliver these staged network plans. They can provide sufﬁcient
coverage at low cost within the rollout stage.
Operator costs for the network are often expressed as capital expenditure
(CapEx) and operating expenditure (OpEx) [10]. Later on, when the network
is more mature, the design objectives will change to sufﬁcient system capacity.
The staged network deployment features of design optimization tools ensure
that the infrastructure investment is put in the right place at the right time.
This results in signiﬁcant savings in both CapEx and OpEx; see Figure 12.4.

Network Planning and Deployment Issues for MIMO Systems
361
It also helps reduce the risk of overbuilding networks. This means, for
example, that a radio network is deployed to deliver high service capacity.
However, with the lack of available handsets on the market, high capacity
is not a top priority. It would be sufﬁcient to provide high capacity at a later
stage.
By applying staged deployment methods for radio networks, large por-
tions of budget can be saved on the present value of the required CapEx
and OpEx to realize these networks; see Figure 12.4.
Examples of UMTS deployments have shown that up to 12% of the present
value of both CapEx and OpEx can be saved.
12.1.2.3
Best Deployment of Budget
Another important aspect for a good radio network plan is the efﬁcient use
of corporate budgets. This means that a radio network planner should make
the most efﬁcient use of an available budget.
At a corporate level, different budgets are applied to different markets or
deployment areas. With cost and efﬁciency analysis available in automated
planning, design, and optimization functionalities corporate budgets can be
spent in the most efﬁcient way. An example of this is shown in Figure 12.5.
The planning target here is network coverage in both Market A and Market
B. Based on the “coverage per cost” analysis, the radio engineer can make
the decision to move the available budget to the area where the most positive
effect on coverage can be achieved.
FIGURE 12.4
Savings in the present value of both CapEx and OpEx with optimization techniques.
Savings in present value of both
CapEx and OpEx
Number of node Bs 
Required 
performance 
Time/costs 
Required 
performance 
Initial coverage
requirements
Additional coverage 
and capacity 
requirements 
With 
optimization 
Without 
optimization 

362
MIMO System Technology for Wireless Communications
12.1.2.4
Most Cost-Effective Technology Deployment
3G radio networks are expected to include a mix of various advanced tech-
nologies such as Remote Electrical Tilt (RET) antennas, cf. [9], Tower
Mounted Ampliﬁers (TMA), microcells, transmit diversity, smart antennas,
etc. This leads to the question of the best utilization, penetration, and deploy-
ment of the more advanced (but also more expensive) technologies. From
these deployments, a number of questions arise, such as:
•
Which technologies should be considered when?
•
How many smart antennas should be deployed based on the costs?
•
Where should advanced techniques be deployed in the most effec-
tive manner?
•
How should advanced techniques be conﬁgured?
•
How should conventional antennas be conﬁgured?
These questions can be answered by using enhanced radio network plan-
ning and optimization tools in order to maximize the overall radio network
performance, constrained by investment and operational costs.
12.1.3
Base Stations with Downlink Transmit Diversity and Beamforming 
The gain in spectral efﬁciency for downlink beamforming in UMTS Time
Division Duplex (TDD) mode was evaluated in simulation studies [11].
System-level simulations were carried out to evaluate the network through-
put for the downlink by means of beamforming at the base station transmit-
ter and multiuser detection in the mobile station receiver. The system-level
model is based on the sectorized macro-environment speciﬁed in [12]. For
downlink speech trafﬁc at 8 kbit/s using transmit beamforming at the base
stations and multiuser-detection at the mobile stations, the gain in spectral
efﬁciency due to downlink beamforming is 55% higher than the gain resulting
FIGURE 12.5
Efﬁcient use of budget.
Implementation costs($) 
Step 1: Budget limitation market A
Implementation costs($) 
Step 3: Move corporate budget so that it
is used in the most eﬀective way
Step 2: Budget limitation market B
Coverage(km2) 
Coverage(km2) 

Network Planning and Deployment Issues for MIMO Systems
363
from power control and dynamic channel allocation combined. With down-
link beamforming and power control together, there is no additional gain
from employing dynamic channel allocation. It was found that there is a 2.6-
fold spectral efﬁciency gain if antenna arrays of eight elements are deployed
in a sectorized macrocellular environment. For further details on the simu-
lation scenario and additional results, we refer to [11]. Very similar results
apply for Time Division Synchronous Code Division Multiple Access (TD-
SCDMA), which is also known as the low chiprate TDD-mode of UMTS.
One way to enhance the coverage is the introduction of downlink diversity
methods. Downlink diversity will add 3 dB to received power. The UMTS
speciﬁcation supports transmit diversity in the downlink with two transmit
antennas since its earliest release. It supports the Alamouti space–time trans-
mit diversity scheme [13] for the downlink, which does not require channel
knowledge at the Node B transmitter. This is the “open loop” downlink
transmit diversity employing a space–time block coding based transmit
diversity (STTD). The STTD encoding is optional in the UMTS radio access
network. STTD support is mandatory at the mobile station. Channel coding,
interleaving, and spreading are done as without transmit diversity.
UMTS also supports closed-loop transmit diversity schemes [14]. These
are known as closed loop modes 1 and 2, respectively. The spread complex-
valued signal is fed to both TX antenna branches, and weighted with
antenna-speciﬁc complex-valued weight factors. The weight factors (actually
the corresponding phase adjustments in closed loop mode 1 and
phase/amplitude adjustments in closed loop mode 2) are determined by the
mobile station and signaled to the UMTS radio access network access point
(=cell transceiver) using the uplink Dedicated Physical Control Channel
(DPCCH).
For the closed loop mode 1, different orthogonal dedicated pilot symbols
in the DPCCH are sent on the two different antennas. For closed loop mode
2, the same dedicated pilot symbols in the DPCCH are sent on both antennas.
It is anticipated that Release 7 of 3GPP will specify MIMO transmission with
four transmit antennas at the base station.* A total of eight MIMO proposals
for UMTS are listed in [15]. Similarly, the IEEE 802.11n standard will incorpo-
rate MIMO transmission using OFDM with adaptive modulation based on
channel state information signaled through a feedback control channel.
A tricky problem is interference in MIMO systems with several concurrent
users. Each dominant interferer — each MIMO user to all the others in the
system or cell — will require (at least) one degree of freedom to eliminate.
This reduces the capacity gain of spatial multiplexing such that MIMO system
capacity will be only insigniﬁcantly larger than what can be obtained by
smart antennas alone [16,17]. Multi-user detection and cooperation of access
points (base stations) in a cellular environment will be necessary to restore
capacity to the theoretical limit [18].
* More precisely, MIMO is currently a study item within the Third Generation Partnership
Project (3GPP) for “Long Term Evolution” of UMTS.

364
MIMO System Technology for Wireless Communications
12.2
Deployment
MIMO capacity can show large local variations, depending on the position
of the antenna arrays and on the environment. How does one deploy MIMO
systems to maximize capacity practically? It is concluded from double-
directional MIMO channel measurements [19] that directions of arrival and
directions of departure may be discrete. Such environments lend themselves
for transmission into limited angles. Even if the directions of departure and
arrival are not discrete, it is likely that there are speciﬁc sectors from which
much power can be received. This favors systems with directional transmis-
sion. The measurements in ofﬁce environments [7,19] clearly demonstrate
that there exist at least large angular sectors, either from which no signiﬁcant
power was received or into which no power is transmitted, that would
eventually reach an intended receive antenna. How does the terminal or the
access point know which are the favored directions? The deployment pro-
cedure proposed in [20] relies on measurements in the actual propagation
environment.
Transmit diversity schemes are particularly appropriate for microcell sce-
narios [4] where capacity gains are large and beamforming enhancements are
less appropriate due to the large angular spread [21]. Transmit diversity
provides a relatively simple capacity upgrade solution in terms of conﬁgur-
ing additional hardware. For the Alamouti scheme, two transmit antennas are
required on the downlink — either a single cross-planar antenna or a pair
of vertically polarized antennas. In terms of power ampliﬁer modules, the
operator may be able to share existing power. This is possible when the site
is conﬁgured with multiple carriers and multi-carrier power ampliﬁers. This
is not possible for single-carrier scenarios, and supplementary power ampli-
ﬁers must be included.
12.3
Smart Antenna Planning Example
In this section, we discuss a speciﬁc planning problem through a simulation
study. We discuss the connectivity of users in a 3G cellular network with
conventional sectorization and compare it with the connectivity when the
network deploys 4-element uniform linear array antennas.
Speciﬁcally, we assume a UMTS radio access network conﬁguration
including approximately 100 sectors. In order to investigate the system per-
formance, system-level simulations were carried out using a state-of-the-art
Monte Carlo simulator. The system-level simulator models the network sim-
ilarly to most of the commercially available radio network planning tools.
Additionally, we included the modeling of smart antenna processing. In this

Network Planning and Deployment Issues for MIMO Systems
365
study, we consider two deployment scenarios: In the ﬁrst scenario, we con-
sider all base stations to be equipped with conventional sector antennas (three
sectors per site). In the second scenario, the base stations are equipped with
4-element uniform linear array antennas. In the second scenario, we assume
that the baseband signal processing at the base station implements optimum
combining.
The typical questions to be answered by the operator are:
•
How do smart antennas inﬂuence the system performance?
•
In which regions are (dis-)connected users concentrated?
•
Does the distribution of (dis-)connected users change in the case of
smart antenna deployment?
•
Does it make sense to deploy smart antennas throughout the entire
network or only in certain areas?
For simplicity we assume an idealized service mix with just two different
service types, i.e., we assume 40% of the users to be served at a data rate of
12.2 kbit/s and 60% of the users at 64 kbit/s. 
The results are shown in Figure 12.6 and Figure 12.7. Figure 12.6 shows
the distribution of the connected users for conventional sector antennas (a)
and 4-element-ULAs (b). Conversely, Figure 12.7 shows the distribution of
disconnected users in case of conventional sector antennas (a) and 4-element-
ULAs (b).
This comparison shows that smart antennas are capable of increasing the
number of served users. Hence, the network’s aggregated throughput can
be increased substantially by the use of smart antennas. In the studied
scenario, the deployment of 4-element-ULAs is capable of doubling the
network throughput. Only a very small number of users remain discon-
nected in areas of poor coverage.
We note that smart antennas provide a “cluster gain,” rather than just a
performance gain limited to the smart antenna serving cell. This means that
a single cell equipped with a smart antenna will not just improve the cov-
erage and capacity of the serving sector, but will also improve the perfor-
mance of the neighbouring cells, due to the highly reduced intercell
interference power.
Recently, a statistical analysis in live CDMA networks was carried out in
North America [22]. The analysis has shown that among all sites in which
the load exceeds the capacity threshold, around 51% have a single over-
loaded sector, while the other sectors operate below the capacity threshold.
Another 38% of the sites have two sectors exceeding the capacity threshold,
and only 11% of the sites have all three sectors exceeding the capacity
threshold. This means that, when deployed per sector, smart antennas allow
the operator to address capacity where additional resources are needed,
increasing the utilization of every deployed carrier.

366
MIMO System Technology for Wireless Communications
(a)
(b)
FIGURE 12.6
Distribution of connected users in the system area. Each base station is either equipped with a
single element sector antenna (a) or a 4-element uniform linear array (ULA, performing opti-
mum combining) (b), respectively. The “.” indicates users with a 12.2 kbit/s service, and the
“x” shows users with 64 kbit/s service.
Distance(km) 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 

Network Planning and Deployment Issues for MIMO Systems
367
(a)
(b)
FIGURE 12.7
Distribution of disconnected users in the system area. Each base station is either equipped with
a single element sector antenna (a), or a 4-element uniform linear array (ULA, performing
optimum combining) (b), respectively. The “.” indicates users with a 12.2 kbit/s service, and
the “x” shows users with 64 kbit/s service.
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
Distance(km) 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 

368
MIMO System Technology for Wireless Communications
Considering both the sector-based capacity limitations and the cluster gain
of smart antennas, future challenges for smart antenna and MIMO radio
network deployment will be to ﬁnd answers to the following questions:
•
How many smart antennas/MIMO systems should be deployed?
•
Where should they be deployed?
•
How should the mixed deployment of conventional sector antennas,
smart antennas, and MIMO systems be conﬁgured in order to pro-
vide the best system performance?
References
1. W. Weichselberger. 2003. “Spatial Structure of Multiple Antenna Radio Chan-
nels — A Signal Processor Viewpoint,” Doctoral Dissertation, Vienna Univer-
sity of Technology, Vienna, Austria. Available at: http://www.nt.tuwien.ac.at/
mobile/theses_ﬁnished.
2. S.N. Diggavi, N. Al-Dhahir, A. Stamoulis, and A.R. Calderbank. 2004. “Great
expectations: the value of spatial diversity in wireless networks,” Proceedings
of the IEEE, Vol. 92, No. 2, Feb. 2004, pp. 219–270.
3. A. Paulraj, R. Nabar, and D. Gore. Introduction to Space-Time Wireless Commu-
nications, Cambridge, U.K., Cambridge University Press.
4. J. Laiho, A. Wacker, and T. Novosad, eds. 2002. Radio Network Planning and
Optimization for UMTS, New York, John Wiley & Sons.
5. A. Kuchar. 1999. “Real Time Smart Antenna Processing for GSM1800”, Doctoral
Dissertation, Vienna University of Technology, Vienna, Austria, 1999. Available
at: http://www.nt.tuwien.ac.at/mobile/theses_ﬁnished.
6. Towards Mobile Broadband Multimedia Networks, Cooperation euroéenne
dans le domaine de la recherché Scientiﬁc et Technique Action 273. Available
at: http://www.lx.it.pt/cost273/.
7. H. Özcelik, M. Herdin, W. Weichselberger, J. Wallace, and E. Bonek. 2003.
“Deﬁciencies of ‘Kronecker’ MIMO radio channel model,” Electronics Letters,
Vol. 39, No. 16, pp. 1209–1210.
8. Durlacher Research Ltd. 2001. “UMTS-Report — An Investment Perspective,”
Press Release. Available at: http://www.dad.be/library/pdf/durlacher3.pdf.
9. 3GPP TS 32.642. 2005. Telecommunication management; Conﬁguration Man-
agement (CM); UTRAN network resources Integration Reference Point (IRP):
Network Resource Model (NRM), Release 6, Version 6.4.0, April 2005.
10. T. Giles, J. Markendahl, J. Zander, P. Zetterberg, P. Karlsson, J. Lind, and
G. Malmgren. 2004. “Cost drivers and deployment scenarios for future broad-
band wireless networks — key research problems and directions for research,”
Proc. IEEE Vehicular Technology Conference, Spring, May 2004.
11. M. Haardt, C.F. Mecklenbräuker, M. Vollmer, and P. Slanina. 2001. Smart An-
tennas for UTRA TDD, European Transactions on Telecommunications (ETT),
Special Issue on Smart Antennas, Vol. 12, Issue 5, pp. 393–406, Sept.–Oct. 2001.
12. ETSI TR 101 112. 1998. “Selection procedures for the choice of radio transmis-
sion technologies of the universal mobile telecommunications system UMTS
(UMTS 30.03), Version 3.2.0,” April 1998.

Network Planning and Deployment Issues for MIMO Systems
369
13. 3GPP TS 25.211. 2005. Technical Speciﬁcation Group Radio Access Network;
Physical channels and mapping of transport channels onto physical channels
(FDD) Release 6, Version 6.4.0, March 2005.
14. 3GPP TS 25.214. 2005. Technical Speciﬁcation Group Radio Access Network;
Physical layer procedures (FDD), Release 6, Version 6.5.0, March 2005.
15. 3GPP TR 25.876. 2005. Technical Speciﬁcation Group Radio Access Network;
Multiple-Input Multiple Output in UTRA, Release 7, Version 1.8.0, October
2005.
16. S. Catreux, P.F. Driessen, and L.J. Greenstein. 2000. “Simulation results for an
interference-limited multiple-input multiple-output cellular system,” IEEE
Comm. Lett., Vol. 4, No. 11, Nov. 2000, pp. 334–336.
17. S. Catreux, P.F. Driessen, and L. Greenstein. 2001. “Link-optimal space-time
processing with multiple transmit and receive antennas,” IEEE Comm. Lett.,
Vol. 5, pp. 334–336.
18. H. Dai, A.F. Molisch, and H.V. Poor. 2004. “Downlink capacity of interference-
limited MIMO systems with joint detection,“ IEEE Trans. Wireless Comm., Vol. 3,
pp. 442–453.
19. M. Steinbauer et al. 2001. “The double-directional radio propagation channel,”
IEEE Antennas & Propagation Magazine, Vol. 43, No. 4, August 2001, pp. 51–63.
20. E. Bonek. 2002. “Link-speciﬁc MIMO system deployment for ad-hoc networks,”
Proc. WWRF Meeting #7, Working Group 4, Eindhoven, the Netherlands, Decem-
ber 3–4, 2002.
21. S. Andersson et al. 1999. “Adaptive antennas for GSM and TDMA systems.”
IEEE Personal Communications, June 1999, pp. 74–86.
22. T. Crook. 2002. “Why smart antennas & subscriber device based enhancements
are important to wireless service providers,” Sprint. Available at: http://www.
cdg.org/news/events/CDMASeminar/cdg_tech_forum_02/1_sprint_cdg_
smart_antenna_rev.pdf.


371
Index
A
A/D converter, 280–281
Adaptive modulation and coding, 213
Additive white Gaussian noise, 61, 91, 96, 
116, 182, 230
Alamouti's transmit technique, 94–96
Algorithms
coordinated zero-forcing, 189–190
quantized signal adaptation, 121–133
V-BLAST, 90, 105–107, 230–231
Viterbi, 100–102
Analog beamforming, 168
Angle-of-arrival
description of, 3, 5
Gaussian, 11
Angular shift, 53–54
Angular spread, 11–12
Antenna selection
capacity-achieving spatial multiplexing, 
162–165
description of, 148–149
diversity, 149
implementing of, 161–166
interference and, 154
multifunctional reconﬁgurable antenna, 
See Multifunctional reconﬁgurable 
antenna
multifunctional reconﬁgurable spiral 
antenna, See Multifunctional 
reconﬁgurable spiral antenna
non-idealities, 166–167
with orthogonal space–time block codes, 
157–159
performance of, 152–154
receive, 148
smart antenna, 364–368
space–time codes, 165–166
with space–time trellis codes, 155–157
with spatial correlation, 167–170
summary of, 170–171
transmit
description of, 148
optimum signaling with, 151–152
transmit and receive, 148
Array gain, 149, 354
Automatic repeat request, 355
B
Base stations, 360, 362–363
Beamforming
base stations with, 362–363
description of, 121–122
ﬁxed, 215
general coordinated, 190
interpolated, in MIMO-OFDM systems, 
136–137
multiuser, 239–244
space–time coding and, 256
speciﬁc, 215
universal terrestrial radio access 
frequency division duplex, 215–216
Bit error rates, 344
Block-fading channel assumption, 166
Broadband signaling, 113–114
Butler matrix, 170
C
Capacity
MIMO, See MIMO capacity
of multiple-user MIMO channels, 181–183
Capacity-achieving spatial multiplexing, 
162–165
CapEx, 360
Channel estimation, for MIMO-OFDM, 
324–330, 348–349
Channel fading, 92
Channel inversion
description of, 183–184
regularized, 184, 186
Channel memory, 115–116
Channel quality indicator, 213
Channel quantization, 119–120

372
MIMO System Technology for Wireless Communications
Channel state information
description of, 92
space–time coding with, 107–109
at transmitter, 34–35, 180
Closed-loop MIMO systems, 116
Codebook
description of, 119
for spatial multiplexing, 131–133
Common pilot channels, 212
Coordinated zero-forcing, 189–190
Cumulative distribution function, 47, 153, 
242–243
D
Dedicated physical channel, 211
Dedicated physical control channel, 211, 219, 
363
Dedicated physical data channel, 211, 219
Degrees of freedom
description of, 38–39
effective, 306
Delay spread, 11–12
Digital signal processors, 277, 317, 330
Digital-intermediate frequency, 280
Direct channel quantization, 117
Directional channel modeling
angular spread, 11–12
delay spread, 11–12
extended Saleh-Valenzuela model, 10
Gaussian scatter density model, 10–11
Gaussian wide sense stationary 
uncorrelated scattering, 7–8
geometrically based single-bounce 
statistical channel models
description of, 5
elliptical model with dense discrete 
scatterers, 7
elliptical subregions model, 7
geometrically based circular model, 5
geometrically based elliptical model, 6
overview of, 2–3
scatterers, ring of, 4
semi-elliptical geometrical model, 11
shadow fading, 11–12
stochastic spatio-temporal propagation 
model, 8–10
Dirty-paper coding, 182, 191, 233
Discrete uniform distribution model, 4–5
Discrete-time simulation models, for phase 
noise, 289–290
Diversity gains, 354–355
Diversity MIMO, 218–219
Diversity order, 149
Doppler shift, 3
Double Poisson time-of-arrival model, 10
Double transmit antenna array, 237
Downlink channel, 177
DSTTD-SGRC, 235–236
E
Effective degrees of freedom, 306
Electromagnetism, 59–60
Elliptical subregions model, 7
Ergodic capacity, 40
Euclidean distance, 155
Extended Saleh-Valenzuela model, 10
F
Feedback
in broadband channels with 
MIMO-OFDM
description of, 135
limited feedback, 135–136
continuous quality improvement, 231
limited
description of, 119–121
MIMO-OFDM system and, 135–136
overview of, 113–114
quantized signal adaptation
algorithms, 121–133
description of, 120–121
spatial correlation effect, 133–135
Fermat principle, 13
5.25 GHz 2 × 2 MIMO testbed, 290–292
Fixed beamforming, 215
Flat-fading assumption, 166
Foschini-Telatar formula, 58–59
Frequency offset calibration, 295–297
Functional mapping, 321
G
Gaussian scatter density model, 10–11
Gaussian wide sense stationary uncorrelated 
scattering, 7–8
General capacity formula, 31–32

Index
373
General coordinated beamforming, 190
Geometrical theory of diffraction, 13
Geometrically based circular model, 5
Geometrically based single-bounce statistical 
channel models
description of, 5
elliptical model with dense discrete 
scatterers, 7
elliptical subregions model, 7
geometrically based circular model, 5
geometrically based elliptical model, 6
Grassmann manifold, 127
H
High speed downlink packet access, 212–214
Hybrid-selection maximum ratio combining, 
159
I
Ideal scattering, 58
Imaging technique, 14
Implementation loss, 280
Information MIMO, 209, 219–220
Intelligence, 252
Interference
antenna selection and, 154
inter-symbol, 293
multiple access, 220–221
as noise, 182–183
Interference cancellation, 220
Interpolated beamforming, in MIMO-OFDM 
systems, 136–137
Interpolated precoding, in MIMO-OFDM 
systems, 138
Inter-symbol interference, 293
I/Q mismatch
description of, 282–284
simulation model for, 284
at transmitter, 283
K
Keyhole channel effect, 255
K-factor, 256
Kronecker model, 167
Kronecker symbol, 327
L
Laplacian power azimuth spectrum, 11
Layer space–time, 93, 104
Limited feedback
description of, 119–121
MIMO-OFDM system and, 135–136
Linear precoders, 184–187
Linear processing, multi-antenna receivers, 
187–191
Linear processing, single-antenna receivers, 
183–187
Linear receiver inspired selection, of 
precoder, 129
Linear receivers, 164–165
Local ﬁeld principle, 13
Local oscillators
description of, 280
low phase noise, 286–288
Low phase noise local oscillators, 286–288
M
Macrocell model, 5
Maximal ratio combining, 216
Maximum likelihood detector, 155
Maximum likelihood receiver inspired 
selection, of precoder, 129
Maximum ratio combining, 159
Metal-insulator-metal capacitors, 261
Metropolitan networks, 355
Microcell model, 6
Microelectromechanical systems
description of, 250
radiofrequency
description of, 250
integrated antennas, 258–268
microwave laminates for MRA 
fabrication, 257–258
three-element selection diversity 
antenna, 258–263
MIMO capacity
deﬁnition of, 61
description of, 36–37, 58–59, 90–92
diversity, 92–93
extended capacity formula, 31–35
Foschini-Telatar formula for, 58–59
for Rayleigh channels
description of, 42–43
with spatial fading correlation, 49–50
without spatial fading correlation, 
48–49

374
MIMO System Technology for Wireless Communications
rectangular cavity, 82–84
rectangular waveguide, 77–82
with Rice channels, 41–45, 50–51
singular values of channel matrix H, 51–52
spatial, 61–66
spatial fading correlation, 45–47
spatial sampling and, 66–75
truncation error effects on, 71–75
of waveguide channels, 75–77
MIMO channels
capacity of, See MIMO capacity
extended capacity formula for, 31–35
measurements, 191–194
multi-user
capacity of, 181–183
in channels derived from 
measurements, 197–201
description of, 178–181
inter-user separation, 198–200
linear processing, multi-antenna 
receivers, 187–191
linear processing, single-antenna 
receivers, 183–187
non-linear processing methods, 191
in randomly generated channels, 
195–197
transmission schemes for, 183–191
user motion effects, 200–201
normalization of, 194
quality of, 304–306
transformation of, into n SISO 
subchannels, 32–34
waveguide
description of, 75–77
rectangular, 77–82
spatial capacity of, 84–85
MIMO propagation modeling
deterministic, with ray tracing, 13–17
overview of, 12
stochastic, 17–23
MIMO systems
adaptability of, 251
closed-loop, 116
decoding algorithms for, 275
deployment of
cost-effective, 362
description of, 364
description of, 147–148, 149–150, 176–178
diversity, 92–93, 218–219
drawbacks of, 92–93
information, 209, 219–220
load equations for, 223–225
multi-user
description of, 177
resolvability of, 251
network planning
advanced planning, 359–360
coverage and capacity enhancement, 
360–363
description of, 353–357
introduction to, 357–358
optimization methods, 359–360
notation associated with, 150–151
open-loop, 116
performance of, 250
resolvability of, 251
signal distribution, 280–281
SIMO systems vs., 148
smart antenna planning example for, 
364–368
with space–time coding, 256–257
in universal terrestrial radio access 
frequency division duplex downlink
algorithms with 3GPP 
standardization, 234–237
difﬁculties associated with, 245
enhancements to, 237–238
multiuser, 233–234
multiuser beamforming, 239–244
overview of, 229–230
practical considerations for, 237–239
single-user, 230–233
in universal terrestrial radio access 
frequency division duplex uplink
advanced receiver techniques, 
220–221
description of, 217–218
diversity, 218–219
information, 219–220
MIMO-OFDM
description of, 118
development of, 316–317
digital signal processors, 317
interpolated beamforming in, 136–137
interpolated precoding in, 138
limited feedback and, 135–136
phase noise in, 288–289
prototype for, 317
radiofrequency front ends, 349–350
real-time signal processing
adaptation to time-variant channel, 
330–332
channel coding, 335–337
channel estimation, 324–330, 348–349
code-multiplexed preamble, 322–324
complexity, 337–340
conclusion, 346–347
data reconstruction, 332–335
framing, 335–337
implementation, 318–322, 337–340

Index
375
mapping, 335–337
overview of, 315–318
real-time data interface, 335–337
summary of, 347–348
system integration, 337–340
transmission experiments, 340–345
Minimum mean square error receiver, 130, 
164–165
Minimum mean squared error, 184
Minimum singular value, 130
MISO channels, 39
Moore-Penrose pseudo-inverse, 106
Multi-Element Transmit and Receive 
Antennas Project, 133–134
Multifunctional reconﬁgurable antenna
advantages of, 253
array, 252, 255
description of, 250–254
fabrication of, 257–258
polarization antenna, 256
propagation environment, 254–257
properties of, 254–257
spatial diversity of, 256
transmission algorithms, 254–257
Multifunctional reconﬁgurable spiral 
antenna
architecture for, 264
microfabrication of, 266–269
operational mechanism of, 263–266
structure of, 263–266
Multiple access channel, 177
Multiple access interference, 220–221
Multiple antenna element, 33–34
Multiple-access interference, 177
Multiple-input-multiple-output propagation 
modeling, See MIMO propagation 
modeling
Multiple-user detection, 177
Multiuser beamforming, 239–244
Multi-user MIMO channels
capacity of, 181–183
in channels derived from measurements, 
197–201
description of, 178–181
inter-user separation, 198–200
linear processing, multi-antenna 
receivers, 187–191
linear processing, single-antenna 
receivers, 183–187
non-linear processing methods, 191
in randomly generated channels, 195–197
transmission schemes for, 183–191
user motion effects, 200–201
N
n SISO subchannels, MIMO channels 
transformed into, 32–34
Network planning
advanced planning, 359–360
coverage and capacity enhancement, 
360–363
description of, 353–357
introduction to, 357–358
optimization methods, 359–360
Non-line-of-sight environment, 102
Nyquist sampling theorem, 58
O
Open-loop MIMO systems, 116
OpEx, 360
Optimal beamforming vector, 120
Orthogonal channels, 38
Orthogonal frequency division multiplexing
bandwidth of, 179
description of, 109, 113–114, 118
Orthogonal space–time block codes
description of, 96–98, 157–159
precoded, 123–127
Outage capacity, 41
Oversampling, 70
P
Parallel interference cancellation receivers, 221
Per-antenna rate control, 235
Perfect channel knowledge assumption, 166
Per-user unitary rate control, 237
Phase locked loop, 286
Phase noise
cancellation of, in demodulator by signal 
processing, 288–289
discrete-time simulation model for, 289–290
local oscillators, 286–288
overview of, 285–286
Polarization antenna, 256
Power azimuth spectrum, 11
Power delay spectrum, 11
Precoded spatial multiplexing, 127–133
Precoding
interpolated, in MIMO-OFDM systems, 
138
Tomlinson-Harashima, 118
Primary common pilot channel, 212, 217
Printed circuit boards, 257

376
MIMO System Technology for Wireless Communications
Q
Quadrature amplitude modulation, 109
Quadrature phase shift keying, 95
Quantized signal adaptation
algorithms, 121–133
description of, 120–121
Quasi real-time feedback, 303
R
Radio receiver distortion, 293–295
Radiofrequency microelectromechanical 
systems
description of, 250
integrated antennas, 258–268
microwave laminates for MRA 
fabrication, 257–258
three-element selection diversity antenna, 
258–263
Random access channel, 216
Rate-control multipaths diversity, 236–237
Ray launching technique, 14
Ray tracing, 13–17
Rayleigh channels, MIMO capacity with
description of, 42–43
with spatial fading correlation, 49–50
without spatial fading correlation, 48–49
Real-time MIMO-OFDM signal processing
adaptation to time-variant channel, 
330–332
channel coding, 335–337
channel estimation, 324–330, 348–349
code-multiplexed preamble, 322–324
complexity, 337–340
conclusion, 346–347
data reconstruction, 332–335
framing, 335–337
implementation, 318–322, 337–340
mapping, 335–337
overview of, 315–318
real-time data interface, 335–337
summary of, 347–348
system integration, 337–340
transmission experiments, 340–345
Receive antenna selection, 148
Receivers
frequency response calibration of, 299
linear, 164–165
linear processing, multi-antenna, 187–191
linear processing, single-antenna, 183–187
minimum mean square error, 130, 164–165
serial interference cancellation, 221
zero-forcing, 164–165
Rectangular cavity capacity, 82–84
Rectangular waveguide capacity, 77–82
Regularized channel inversion, 184, 186
Ring of scatterers, 4
S
Saleh-Valenzuela model, 10
Scatterers
base station, 2
elliptical model with dense discrete, 7
mobile station, 2
ring of, 4
Scattering, 2–3
Secant square power azimuth spectrum 
model, 11
Secondary common pilot channel, 212
Selective per-antenna rate control, 237
Selective transmit diversity, 235
Semi-elliptical geometrical model, 11
Serial interference cancellation receivers, 221
Shadow fading, 11–12
Shannon's capacity formula
description of, 30
extended, 36–39
Signal-to-noise ratio, 327
SIMO systems
channels, 39
description of, 90, 148, 159
MIMO system vs., 148
performance of, 228
Single stream closed-loop MIMO, 237
Singular vale decomposition, 108
Smart antenna planning, 364–368
Space-division multiple access, 316
Space–frequency coding, 93
Space–time block codes
Alamouti's transmit technique, 94–96
antenna selection, 165–166
description of, 94
diversity provided by, 217
orthogonal, 96–98, 123–127, 157–159
Space–time block coding based transmit 
diversity, 363
Space–time coding
channel impact on, 308–312
with channel state information at the 
transmitter, 107–109
description of, 90, 93, 250
inner codes, 110
MIMO with, 256–257
outer codes, 110
schemes for, 110

Index
377
Space–time encoder, 90
Space–time transmit diversity, 216
Space–time trellis code encoder, 98–99
Space–time trellis codes
decoding, 98–101
description of, 98, 110, 155–157
design of, 101–103
encoding, 98–101
performance analysis, 101–103
purpose of, 155
Space–time–frequency coding, 93
Spatial capacity
correlation and, 61–66
deﬁnition of, 61
waveguide channels, 84–85
Spatial correlation
antenna selection with, 167–170
description of, 133–135
Spatial diversity, 92
Spatial multiplexing
advantages of, 104
capacity-achieving, 162–165
codebook design for, 131–133
deﬁnition of, 176
description of, 93, 103–105, 151
encoding techniques, 104
precoded, 127–133
V-BLAST algorithm, 105–107
Spatial sampling, 66–75
Speciﬁc beamforming, 215
Steering vector, 8
Stochastic channels, 40–41
Stochastic propagation modeling, 17–23
Stochastic spatio-temporal propagation 
model, 8–10
Sum capacity, 185
T
Testbeds
automated, 300–303
automated test mechanics, 279–280
calibration of
description of, 278–279
design tradeoffs that affect, 280–281
characteristics of, 278–280
classiﬁcation of, 276–278
conﬁgurability of, 279
digital-intermediate frequency, 280
ﬁeld testing of
administration, 299–304
channel impact on space–time coding, 
308–312
effective degrees of freedom, 306
measurements, 306–308
results, 304–312
5.25 GHz 2 x 2 MIMO, benchtop 
calibration of, 290–292
frequency offset calibration, 295–297
frequency response calibration
description of, 297–298
receivers, 299
transmitters, 298–299
graphical user interface design of, 
303–304
hardware calibration, 280–281
indications for, 274
interfacing with simulation or emulation 
platform, 279
I/Q mismatch
description of, 282–284
simulation model for, 284
at transmitter, 283
overview of, 274–276
phase noise
cancellation of, in demodulator by 
signal processing, 288–289
discrete-time simulation model for, 
289–290
local oscillators, 286–288
overview of, 285–286
properties of, 276
radio receiver distortion, 293–295
representation of design tradeoffs, 280
signal distribution, 280–281
software-based, non-real-time system, 
276–277
zero-intermediate frequency, 280
Three-element selection diversity antenna, 
258–263
3G CDMA networks, 357–359
3GPP MIMO algorithms, 234–237
3GPP MIMO channel model, 18–23
Time division duplexing, 117
Time-variant channel, 330–332
Tomlinson-Harashima precoding, 118
Transmit and receive antenna selection, 148
Transmit antenna selection
description of, 148
optimum signaling with, 151–152
Transmit diversity
description of, 355
downlink, 362–363
space–time block coding based, 363
Transmit format combination indicator, 
211–212
Transmit power control, 211
Transmit selection diversity, 109

378
MIMO System Technology for Wireless Communications
Transmitters
channel estimation at, 35–36
channel state information at, 34–35
frequency response calibration of, 
298–299
Truncation error
bounds of, in sampling series, 69–71
capacity affected by, 71–75
Tx power ratio control for code domain 
successive interference cancellation, 
237
U
Uniform geometrical theory of diffraction, 13
Universal terrestrial radio access
description of, 208
framework for, 210–214
Universal terrestrial radio access frequency 
division duplex
history of, 209
multiantenna methods in
beamforming, 215–216
description of, 214–215
signal processing, 214
transmit diversity, 216–217
primary common pilot channels, 217
user data rates, 211
Universal terrestrial radio access frequency 
division duplex downlink
description of, 211–212, 229–230
high speed packet access, 212–214
MIMO in
algorithms with 3GPP 
standardization, 234–237
enhancements to, 237–238
multiuser, 233–234
multiuser beamforming, 239–244
overview of, 229–230
practical considerations for, 237–239
single-user, 230–233
summary of, 245
Universal terrestrial radio access frequency 
division duplex uplink
beamforming in, 216
description of, 214
load equations
basic, 221–223
MIMO, 223–225
MIMO algorithms
advanced receiver techniques, 
220–221
description of, 217–218
diversity, 218–219
information, 219–220
performance comparisons for, 225–229
summary of, 244–245
V
V-BLAST algorithm, 90, 105–107, 230–231
Vertical encoding, 230
Virtual channel, 187
Viterbi algorithm, 100–102
W
Waveguide channels
description of, 75–77
rectangular, 77–82
spatial capacity of, 84–85
Wideband code division multiple access, 
208–210
Wideband directional channel model, 17
Z
Zero-forcing receiver, 164–165
Zero-intermediate frequency, 280

