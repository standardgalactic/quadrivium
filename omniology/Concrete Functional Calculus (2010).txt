
Springer Monographs  in Mathematics
For further volumes published in this series,
www.springer.com/series/3733

 

Concrete Functional Calculus
 R.M. Dudley    R. Norvaiša
 •

  
 
Printed on acid-free paper 
 
 
 
 
 
 
 
 
All rights reserved. This work may not be translated or copied in whole or in part without the written
10013, USA), except for brief excerpts in connection with reviews or scholarly analysis. Use in connection
with any form of information storage and retrieval, electronic adaptation, computer software, or by similar
or dissimilar methodology now known or hereafter developed is forbidden.
The use in this publication of trade names, trademarks, service marks, and similar terms, even if they are
not identiﬁed as such, is not to be taken as an expression of opinion as to whether or not they are subject
to proprietary rights.
 
   
          
 
 
 
  
 
 
Springer is part of Springer Science+Business Media (www.springer.com) 
          
 
 
ISSN 1439-7382
Springer New York Dordrecht Heidelberg London 
R.M. Dudley
Massachusetts Institute of Technology
Cambridge, MA 02139-4307
USA
rmd@math.mit.edu
R. Norvaiša
LT-08663 Vilnius
Lithuania
ISBN 978-1-4419-6949-1
DOI 10.1007/978-1-4419-6950-7
permission of the publisher (Springer Science+Business Media, LLC, 233 Spring Street, New York, NY
e-ISBN 978-1-4419-6950-7
© Springer Science+Business Media, LLC 2011
Mathematics Subject Classification (2010): 28Bxx, 45Gxx, 46Txx, 60Gxx
Institute of Mathematics and Informatics 
Department of Mathematics 
norvaisa@ktl.mii.lt

Preface
The reader of this book will need some background in real analysis, as
in the ﬁrst half of the ﬁrst author’s book Real Analysis and Probability. The
book should be accessible to graduate students with that background as well
as researchers. An interest in probability will also help with motivation.
Although on some topics we may have presented more or less ﬁnal results,
there are others that leave openings for research. The impetus for much of
the work came from others’ work in mathematical statistics, but we do not
include any applications to statistics.
The book is mainly about some aspects of nonlinear analysis, some not
much studied and some others previously studied but not in the same ways,
and their applications to probability, as in the ﬁnal Chapter 12. More speciﬁ-
cally (to explain the book’s title) we consider existence and smoothness ques-
tions for some concrete nonlinear operators acting on some concrete Banach
spaces of functions. The book has relatively small overlaps, of the order of one
or two chapters, with any previous book except for two lecture note volumes
by the authors.
Here is a ﬁrst example of what is done and distinctive in this book. If F
and G are two functions such that F is deﬁned on the range of G, one can
form the composition H(x) ≡F(G(x)) ≡(F ◦G)(x). When one mentions
diﬀerentiability and composition, mathematicians tend to think of the chain
rule, which is indeed an important fact, but we consider diﬀerentiability of
the two-function composition operator we call TC which takes the pair of
functions (F, G) into the function H. To take the derivative of this operator,
we will assume F and G take values in Banach spaces. The domain of G
need not not have a linear or topological structure (it may be a measure
space). What the diﬀerentiation will mean at some F, G is to take functions f
and g approaching 0 in corresponding spaces, and to represent the increment
(F + f) ◦(G + g) −F ◦G as A(f) + B(g) plus a remainder, where A and
B are linear operators and the remainder becomes small in norm relative to
f, g →0. The operator TC is linear in F for ﬁxed G, but the remainder
contains a term f ◦(G + g) −f ◦G which still depends on both f and g.

VI
It seems to us that TC is a very natural operator deserving attention. It is
treated in Chapter 8. Relatively more attention, e.g. Appell and Zabrejko [3],
has been given to the operator G 7→F ◦G for ﬁxed (nonlinear) F, and its
extension to the case where F is a function of two variables, say x and y, and
one forms a new function H(x) = F(x, G(x)). Such operators are treated in
Chapters 6 and 7.
Among the most familiar of all Banach spaces are the Lp spaces, of equiv-
alence classes of functions f such that |f|p is integrable for a given measure µ,
where 1 ≤p < ∞. A question is: for given p and s in [1, ∞), for what space(s)
F of functions from R into R do we have Fr´echet diﬀerentiability (deﬁned in
Chapter 5) of TC from F × Ls into Lp, say where the measure space is [0, 1]
with Lebesgue measure? It turns out that for 1 ≤s < p, we get degeneracy:
even for ﬁxed F, it must be constant (Corollary 7.36). For 1 ≤p < s < ∞,
consider the following. Let f be a real-valued function on R and 1 ≤p < ∞.
Let vp(f) be the supremum of Pn
j=1 |f(xj) −f(xj−1)|p over all partitions
x0 = a < x1 < · · · < xn = b and all n, called the p-variation of f. Finiteness
of this is ordinary bounded variation when p = 1. Let F = Wp(R) be the space
of all f such that vp(f) < ∞, with the norm ∥f∥[p] = vp(f)1/p +∥f∥sup where
∥f∥sup := supx |f(x)|. Theorem 8.9 shows that TC is Fr´echet diﬀerentiable
from Wp(R) × Ls into Lp of a ﬁnite measure space (Ω, S, µ) at suitable F
and G. Namely, F is diﬀerentiable, and its derivative F ′ satisﬁes a further
condition. The image measure µ ◦G−1 has a bounded density with respect to
Lebesgue measure. The theorem gives a bound on the remainder in the diﬀer-
entiation of a given order in terms of s and p. The two paragraphs preceding
Theorem 8.9 indicate how some of the conditions assumed are necessary or
best possible and in particular, optimality of the Wp norm on f for bounding
the remainder term f ◦(G + g) −f ◦G (Proposition 7.28).
Countably additive signed measures are familiar objects in real analysis.
For purposes of this book we need to consider Stieltjes-type integrals
R
fdg
where neither the integrator g nor the integrand f is of bounded variation.
We found it useful to consider as integrators interval functions deﬁned as fol-
lows. An interval function µ is a function such that µ(A) is deﬁned for all
intervals A, which may be restricted to subintervals of some given interval.
Then µ is called additive if µ(A ∪B) = µ(A) + µ(B) for any two disjoint
intervals A, B such that A ∪B is an interval, and µ is called upper continuous
if µ(An) →µ(A) whenever intervals An decrease down to A. These proper-
ties would follow from, but do not imply, existence of an extension of µ to
a countably additive signed measure. For example, if F is a right-continuous
function with left limits, not necessarily of bounded variation, one can deﬁne
µF ((c, d]) := F(d) −F(c) and deﬁne µF for other intervals by taking lim-
its, giving an additive, upper continuous interval function µF . For µ upper
continuous we deﬁne vp(µ), for µ which may be Banach-valued, as the supre-
mum of P
i ∥µ(Ai)∥p over all ﬁnite disjoint collections of intervals Ai. For
not necessarily additive interval functions, the p-variation needs to be deﬁned
diﬀerently.
Preface

VII
Beside composition, another natural operator is the product integral,
which takes the coeﬃcient functions (such as C(t) in (1.10) below) of a sys-
tem of linear ordinary diﬀerential equations into a solution, under suitable
conditions. Despite linearity of the system, the operator is nonlinear in the
coeﬃcients. Some entire books have been written on this operator. The prod-
uct integral will take values in Banach algebra, namely, a Banach space in
which a multiplication is deﬁned satisfying usual algebraic conditions and
∥xy∥≤∥x∥∥y∥. A precise deﬁnition and some of the theory of Banach alge-
bras are given in Chapter 4. An interval function µ with values in a Banach
algebra will be called multiplicative if µ(A∪B) = µ(B)µ(A) holds for any dis-
joint intervals A, B such that A∪B is an interval, with s < t for each s ∈A and
t ∈B. For 1 ≤p < 2, a product integral operator µ 7→
(1I + dµ) is deﬁned
from additive to multiplicative interval functions and is an entire analytic
function (as deﬁned in Chapter 5) with respect to p-variation norms (Theo-
rem 9.51) and serves to solve diﬀerential and integral equations. Whereas, for
p > 2, ﬁnite p-variation of an additive, upper continuous µ does not imply
that the product integral even exists (Theorem 9.11).
Since p-variation gives sharp results about two natural operators, let’s
return to point functions f and consider the space Wp(R) for 1 ≤p < ∞. If G
is any homeomorphism of R, in other words, a continuous, strictly monotone
(increasing or decreasing) function from R onto itself, the map f →f ◦G
preserves Wp and its norm. Invariance under this very large group holds for
the spaces of all bounded continuous functions or all bounded functions with
the norm ∥f∥sup. Other commonly considered spaces such as Sobolev spaces
are of course highly useful, but they are invariant under much more restricted
transformations. Whereas, the supremum norm gives no control of oscillations
of a function and the Wp norms do. We suppose the good properties of ∥· ∥[p]
will give other uses than those we have found.
We also treat integrals, although with relatively little attention to the
Lebesgue integral. Rather, let at ﬁrst f and g be real functions of a real
variable and consider Stieltjes-type integrals (f, g) 7→
R b
a fdg where neither f
nor g is necessarily of bounded variation. The given bilinear functional can
be deﬁned on various domains f ∈F, g ∈G as will be seen. If f and g have
suitable inﬁnite-dimensional ranges, the integral can also be extended.
If 1 ≤p < ∞, 1 ≤q < ∞, vp(f) < ∞, vq(g) < ∞, and p−1 + q−1 > 1,
then a Stieltjes-type integral
R
fdg can be deﬁned, as had been shown by E.
R. Love and L. C. Young in the late 1930’s, with a corresponding inequality
we call the Love–Young inequality (Corollary 3.91) and use often. Because of
bilinearity, the diﬀerentiability is then immediate and simple.
Chapter 12 on probability and p-variation includes results from several
research papers. Among others, Theorem 12.27 gives bounded p-variation of
the sample paths of Markov processes (with values in metric spaces) for 2 <
p < ∞under a mild condition on expected lengths of increments, shown
to be sharp. Corollary 12.43 extends the celebrated Koml´os–Major–Tusn´ady
theorem on convergence of the classical empirical process to a Brownian bridge
Preface

VIII
from the supremum norm to p-variation norms for 2 < p < ∞with slower,
but sharp, rates of convergence. Theorem 12.40 gives a sharp bound on the
growth of the p-variation of the classical empirical process for 1 ≤p < 2.
These facts were published in three papers in Annals of Probability (one co-
authored by one of us). Proposition 12.54 gives an example due to Terry Lyons,
showing that for some processes Xt and Yt which are each Brownian bridges,
but which have an unusual joint distribution, an integral
R 1
0 XtdYt cannot be
deﬁned by any of the usual methods. The full work of Lyons and co-workers
on “rough paths” is in progress and is beyond the scope of this book. In some
cases where compact or “Hadamard” diﬀerentiability had been proved in the
statistics literature, it might well be replaced by Fr´echet diﬀerentiability with
respect to p-variation norms, with a gain of remainder bounds. This and other
problems we here leave as opportunities for readers.
Some parts of the book appeared, in diﬀerent forms, in our earlier lecture
note volumes Dudley and Norvaiˇsa 1998 [55] and 1999 [54]. Improvements on
or corrections to earlier results of ours or others are incorporated. The book
also includes some new results published here for the ﬁrst time as far as we
know, as will be mentioned in the text or Notes for each.
Guide to the reader: Starred sections, speciﬁcally Sections *2.7 and *3.4,
are not referred to in later chapters. Chapters of the book depend on earlier
chapters as follows: Chapters 1 through 3 are basic in that Chapter 1 is a
rather short introduction, and all later chapters refer to Chapter 3 many
times each and directly or indirectly to Chapter 2. In the further sequence of
chapters 4 through 8, each chapter has many references to the preceding one
and directly or indirectly to intervening chapters. The Appendix relates only
to Chapter 7. Chapter 12 on stochastic processes refers to, beyond Chapter 3,
only two propositions in Chapter 9. Chapter 11, on Fourier series, refers only
to the basic Chapters 1-3. Chapter 10, on nonlinear diﬀerential and integral
equations, refers twice to Chapter 9, once to Chapter 7, once to Chapter 5,
and many times to Chapter 3. Chapter 9, on multiplicative interval functions,
the product integral, and linear diﬀerential and integral equations, refers to
Chapters 1 through 6.
Acknowledgments. We thank B. M. Garay, Richard Gill, and Timothy
Nguyen for advice and help with some points in the book.
MIT, Cambridge, Massachusetts
Richard M. Dudley1
Institute of Mathematics and Informatics, Vilnius
Rimas Norvaiˇsa2
February 2010
1 R. M. Dudley was partially supported by U. S. National Science Foundation
Grants.
2 R. Norvaiˇsa was partially supported by U. S. National Science Foundation Grants,
by Poduska Family Foundation grants and by Lithuanian State Science and Stud-
ies Foundation grants Nos. T-21/07, T-16/08, and T-68/09.
Preface

Contents
V
1
Introduction and Overview . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
How to Deﬁne ∫b
a f dg? . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.2
Some Integral and Diﬀerential Equations . . . . . . . . . . . .
7
1.3
Basic Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.4
Notation and Elementary Notions . . . . . . . . . . . . . . . . . . . 10
2
Deﬁnitions and Basic Properties of Extended
Riemann–Stieltjes Integrals . . . . . . . . . . . . . . . . . . . . . . . . . 17
Regulated and Interval Functions . . . . . . . . . . . . . . . . . . . 17
2.2
Riemann–Stieltjes Integrals . . . . . . . . . . . . . . . . . . . . . . . . 24
2.3
The Reﬁnement Young–Stieltjes and Kolmogorov
Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
2.4
Relations between RS, RRS, and RYS Integrals . . . . . . 46
2.5
The Central Young Integral . . . . . . . . . . . . . . . . . . . . . . . . 51
2.6
The Henstock–Kurzweil Integral . . . . . . . . . . . . . . . . . . . . 56
*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil Integrals 62
2.8
Properties of Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
2.9
Relations between Integrals . . . . . . . . . . . . . . . . . . . . . . . . 87
2.10 Banach-Valued Contour Integrals and Cauchy Formulas 90
2.11 Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
3
Φ-variation and p-variation; Inequalities for Integrals103
3.1
Φ-variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
3.2
Interval Functions, Φ-variation, and p-variation . . . . . . . 116
3.3
Elementary Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
*3.4 A Necessary and Suﬃcient Condition for Integral
Duality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
3.5
Suﬃcient Conditions for Integrability . . . . . . . . . . . . . . . . 168
3.6
Love–Young Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
2.1
Preface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

X
Contents
3.7
Existence of Extended Riemann–Stieltjes Integrals . . . . 191
3.8
Convolution and Related Integral Transforms. . . . . . . . . 196
3.9
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211
4
Banach Algebras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
4.1
Ideals and Normed Algebras . . . . . . . . . . . . . . . . . . . . . . . 216
4.2
The Spectral Radius . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219
4.3
Characters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 222
4.4
Holomorphic Functions of Banach Algebra Elements . . 225
4.5
Complexiﬁcation of Real Banach Algebras . . . . . . . . . . . 231
4.6
A Substitution Rule for the Kolmogorov Integral . . . . . 233
4.7
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234
5
Derivatives and Analyticity in Normed Spaces . . . . . . 237
5.1
Polynomials and Power Series . . . . . . . . . . . . . . . . . . . . . . 239
5.2
Higher Order Derivatives and Taylor Series . . . . . . . . . . 251
5.3
Taylor’s Formulas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 264
5.4
Tensor Products of Banach Spaces . . . . . . . . . . . . . . . . . . 269
5.5
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 270
6
Nemytskii Operators on Some Function Spaces . . . . . 273
6.1
Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273
6.2
Remainders in Diﬀerentiability . . . . . . . . . . . . . . . . . . . . . 274
6.3
Higher Order Diﬀerentiability and Analyticity . . . . . . . . 276
6.4
Autonomous Nemytskii Operators on Wp Spaces . . . . . . 293
6.5
Nemytskii Operators on Wp Spaces . . . . . . . . . . . . . . . . . 300
6.6
Higher Order Diﬀerentiability and Analyticity on Wp
Spaces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 323
6.7
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 333
7
Nemytskii Operators on Lp Spaces . . . . . . . . . . . . . . . . . . 335
7.1
Acting, Boundedness, and Continuity Conditions . . . . . 335
7.2
H¨older Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 347
7.3
Diﬀerentiability. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 354
7.4
Higher Order Diﬀerentiability and Finite Taylor Series. 368
7.5
Examples where NF Is Diﬀerentiable and F Is Not . . . . 378
7.6
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390
8
Two-Function Composition . . . . . . . . . . . . . . . . . . . . . . . . . 393
8.1
Overview; General Remarks . . . . . . . . . . . . . . . . . . . . . . . . 393
8.2
Diﬀerentiability of Two-Function Composition in
General. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 394
8.3
Measure Space Domains . . . . . . . . . . . . . . . . . . . . . . . . . . . 397
8.4
Spaces with Norms Stronger than Supremum Norms . . 401
8.5
Two-Function Composition on Wp Spaces . . . . . . . . . . . . 404

Contents
XI
8.6
Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 405
9
Product Integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 407
9.1
Multiplicative Interval Functions and Φ-Variation . . . . . 408
9.2
Product Integrals for Real-Valued Interval Functions . . 415
9.3
Nonexistence for p > 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 424
9.4
Inequalities for Finite Products . . . . . . . . . . . . . . . . . . . . . 425
9.5
The Product Integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
9.6
The Strict Product Integral
. . . . . . . . . . . . . . . . . . . . . . . 432
9.7
Commutative Banach Algebras . . . . . . . . . . . . . . . . . . . . . 438
9.8
Integrals with Two Integrands . . . . . . . . . . . . . . . . . . . . . . 442
9.9
Duhamel’s Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 451
9.10 Smoothness of the Product Integral Operator . . . . . . . . 457
9.11 Linear Integral Equations . . . . . . . . . . . . . . . . . . . . . . . . . . 474
9.12 Integral Equations for Banach-Space-Valued Functions 494
9.13 Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 499
10
Nonlinear Diﬀerential and Integral Equations . . . . . . . 505
10.1 Classical Picard Iteration . . . . . . . . . . . . . . . . . . . . . . . . . . 505
10.2 Picard’s Method in p-Variation Norm, 1 ≤p < 2 . . . . . . 506
10.3 Existence and Uniqueness . . . . . . . . . . . . . . . . . . . . . . . . . . 513
10.4 Boundedness and Convergence of Picard Iterates. . . . . . 527
10.5 Continuity of the Solution Mappings . . . . . . . . . . . . . . . . 536
10.6 Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 549
11
Fourier Series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 551
11.1 On the Order of Decrease of Fourier Coeﬃcients . . . . . . 551
11.2 Uniform Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 554
11.3 Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 568
12
Stochastic Processes and Φ-Variation . . . . . . . . . . . . . . . 571
12.1
Processes with Regulated Sample Functions . . . . . . . . . 571
12.2
Brownian Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 575
12.3
Martingales . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 576
12.4
Gaussian Stochastic Processes . . . . . . . . . . . . . . . . . . . . . 579
12.5
Markov Processes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 600
12.6
L´evy Processes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 611
12.7
Empirical Processes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 615
12.8
Diﬀerentiability of Operators on Processes . . . . . . . . . . 628
12.9
Integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 629
12.10 Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 640
Appendix Nonatomic Measure Spaces . . . . . . . . . . . . . . . . . . . . . . . . . 645
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649

XII
Contents
Subject Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 661
Author Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 665
Index of Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 669

1
Introduction and Overview
In this book we are mainly concerned with derivatives of certain speciﬁc non-
linear operators on functions. One operator is composition, TC : (f, g) 7→f◦g,
where (f◦g)(x) ≡f(g(x)). This operator is linear in f for ﬁxed g, but not in g
even for ﬁxed nonlinear f. We call this operator the two-function composition
operator, or TC for short, to distinguish it from the more-studied operator
g 7→f ◦g for ﬁxed f, which we call the (autonomous) Nemytskii operator
Nf. The chain rule, on diﬀerentiating x 7→f(g(x)), where x, f, and g may
all have values in Banach spaces, is a very important fact, but it is not di-
rectly about either TC or Nf. To diﬀerentiate TC will mean to approximate
(f + h) ◦(g + k) −f ◦g, asymptotically as h and k approach 0 in suitable
senses, by a sum of linear operators of the functions h and k. The operator
TC will be treated in Chapter 8 and the Nemytskii operator in Chapters 6
and 7.
We will also consider solutions of certain ordinary diﬀerential equations
and integral equations, for functions possibly having values in Banach spaces,
and representing such solutions by way of nonlinear operators. A ﬁrst intro-
duction is given in Section 1.2. A basic nonlinear operator giving solutions of
linear equations, the product integral, is developed in Chapter 9 and applied
to solving equations in Sections 9.11 and 9.12. Chapter 10 treats nonlinear
integral equations for possibly discontinuous functions.
A basic operator on functions on an interval [a, b] is the bilinear Riemann–
Stieltjes integral operator (f, g) 7→
R b
a f dg, to be treated in the following
section and then more fully in Chapters 2 and 3. Some general facts about
Banach algebras are reviewed in Chapter 4. Chapter 5 treats diﬀerentiability
in general Banach spaces.
only speciﬁc operators as mentioned but also speciﬁc function spaces, most
notably p-variation spaces, as will be mentioned in Theorem 1.4 and (1.20),
and frequently throughout most of the book.
1
©
The word “concrete” in the title is meant to convey that we consider not
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
in Mathematics, DOI 10.1007/978-1-4419-6950-7_1, 
  Springer Science+Business Media, LLC 2011

2
1 Introduction and Overview
1.1 How to Deﬁne ∫b
a f dg?
Two classical ways of deﬁning integrals ∫b
a f dg for real-valued functions f and
g on an interval [a, b] with −∞< a < b < +∞are the Riemann–Stieltjes
and Lebesgue–Stieltjes integrals. But, as will be seen later in this section and
in Chapter 2, there are multiple ways of deﬁning such integrals. Relations
between them are given in Section 2.9. Diﬀerent forms of integral can be
useful for diﬀerent purposes.
The Riemann–Stieltjes integral is deﬁned as follows. A ﬁnite sequence
κ = {ti}n
i=0 for a positive integer n is called a partition of [a, b] if a = t0 <
t1 < · · · < tn = b. If {ti}n
i=0 is a partition of [a, b] then an ordered pair
({ti}n
i=0, {si}n
i=1) is called a tagged partition of [a, b] if si ∈[ti−1, ti] for i =
1, . . . , n. For a tagged partition τ = ({ti}n
i=0, {si}n
i=1), |τ| := max1≤i≤n(ti −
ti−1) is called the mesh of τ. Let f and g be real-valued functions on [a, b].
For a tagged partition τ = ({ti}n
i=0, {si}n
i=1) of [a, b], the sum
SRS(f, dg; τ) :=
n
X
i=1
f(si)

g(ti) −g(ti−1)

is called the Riemann–Stieltjes sum based on τ. The Riemann–Stieltjes inte-
gral of f with respect to g is deﬁned and equals C ∈R if for each ǫ > 0 there
exists a δ > 0 such that |C −SRS(f, dg; τ)| < ǫ for each tagged partition τ of
[a, b] with mesh |τ| < δ. Then we let
(RS)
Z b
a
f dg := C = lim
|τ|→0 SRS(f, dg; τ).
Closely related to the Riemann–Stieltjes integral is the integral obtained by
replacing the limit as the mesh approaches 0 by the limit in the sense of
reﬁnements of partitions, as follows. A partition κ is a reﬁnement of a partition
λ if λ ⊂κ as sets. Similarly, a tagged partition τ = (κ, ξ) is a tagged reﬁnement
of a partition λ if κ is a reﬁnement of λ. Now for f and g as before, the
reﬁnement Riemann–Stieltjes integral of f with respect to g is deﬁned and
equals C ∈R if for each ǫ > 0 there exists a partition λ of [a, b] such that
|C−SRS(f, dg; τ)| < ǫ for each tagged partition τ which is a tagged reﬁnement
of λ. Then we let
(RRS)
Z b
a
f dg := lim
τ SRS(f, dg; τ) := C.
If the Riemann–Stieltjes integral exists then so does the reﬁnement Riemann–
Stieltjes integral with the same value, but not conversely (see Proposition 2.13
below and the example following it).
The following concept will be used to formulate suﬃcient conditions for
existence of integrals. Let f be any real-valued function on an interval [a, b]

1.1 How to Deﬁne ∫b
a f dg?
3
with −∞< a ≤b < +∞and let 0 < p < ∞. If a < b, for a partition
κ = {ti}n
i=0 of [a, b], the p-variation sum for f over κ will be deﬁned by
sp(f; κ) :=
n
X
i=1
f(ti) −f(ti−1)
p.
(1.1)
The p-variation of f on [a, b] is deﬁned as vp(f; [a, b]) := 0 if a = b and
vp(f) := vp(f; [a, b]) := sup
κ sp(f; κ)
(1.2)
if a < b, where the supremum is over all partitions κ of [a, b]. Then f is said to
be of bounded p-variation on [a, b], or f ∈Wp[a, b], if and only if vp(f) < +∞.
Let Vp(f) := Vp(f; [a, b]) := vp(f; [a, b])1/p. A function of bounded p-variation
is clearly bounded. For any bounded real-valued function f on a set S let
∥f∥sup := ∥f∥S,sup := supx∈S |f(x)|. For 1 ≤p < ∞let
∥f∥(p) := ∥f∥[a,b],(p) := Vp(f),
∥f∥[p] := ∥f∥(p) + ∥f∥sup.
(1.3)
It is easily seen that ∥·∥(p) is a seminorm, and so ∥·∥[p] is a norm on Wp[a, b],
using the H¨older and Minkowski inequalities. Recall the H¨older inequality for
ﬁnite sums: if p−1 + q−1 ≥1 and 1 ≤p, q < ∞, then for any nonnegative
numbers {ai, bi}n
i=1,
n
X
i=1
aibi ≤

n
X
i=1
ap
i
1/p
n
X
i=1
bq
i
1/q
.
(1.4)
This fact is well known for p−1 + q−1 = 1 and follows for p−1 + q−1 ≥1
since (Pn
i=1 ap
i )1/p is a nonincreasing function of p. Recall also the Minkowski
inequality for ﬁnite sums: for any 1 ≤r < ∞and any nonnegative numbers
{ai, bi}n
i=1,

n
X
i=1
(ai + bi)r1/r
≤

n
X
i=1
ar
i
1/r
+

n
X
i=1
br
i
1/r
.
(1.5)
The best known case of p-variation is for p = 1. A function is said to be
of bounded variation iﬀit is of bounded 1-variation, and its total variation is
its 1-variation.
Let f ∈W1[a, b] and let F(t) := v1(f; [a, t]) for a ≤t ≤b. Then as is well
known and easily checked, F and F −f are nondecreasing with f ≡F −(F −f).
Conversely, if G is any nondecreasing function on [a, b], then v1(G; [a, b]) =
G(b) −G(a). For any two functions g and h, v1(g + h) ≤v1(g) + v1(h). Thus,
f ∈W1[a, b] if and only if f = G −H for two nondecreasing real-valued
functions G and H on [a, b].
From basic measure and integration theory, e.g. [53, Theorem 3.2.6], recall
that there is a 1–1 correspondence between nondecreasing functions g on (a, b],

4
1 Introduction and Overview
right-continuous on (a, b), and ﬁnite countably additive measures µ on the
Borel sets of (a, b], given by µ((c, d]) = g(d) −g(c), a ≤c ≤d ≤b. The same
equations give a 1–1 correspondence between ﬁnite countably additive signed
measures µ on the Borel sets of (a, b] and functions g of bounded variation on
(a, b], right-continuous on (a, b). Let µ := µg for the µ corresponding to such
a g. Then the Lebesgue–Stieltjes integral is deﬁned for a ≤b by
(LS)
Z b
a
f dg :=
Z
(a,b]
f dµg
(1.6)
whenever the right side is deﬁned as a Lebesgue integral, for example, for any
bounded, Borel measurable function f. For a = b, the integral is evidently 0.
(Some other authors give deﬁnitions which diﬀer as to the point a.)
Let h(t) := 1[1,2](t) for 0 ≤t ≤2. Then the Riemann–Stieltjes integrals
(RS) ∫2
0 h dh and (RRS) ∫2
0 h dh are not deﬁned. Clearly (LS) ∫2
0 h dh is deﬁned
and equals 1. In this case the Riemann–Stieltjes integrals are remarkably weak.
On the other hand, recall that a real-valued function f on an interval [a, b]
is said to satisfy a H¨older condition of order α, where 0 < α ≤1, if for some
K < ∞, |f(t) −f(s)| ≤K|t −s|α for any s, t ∈[a, b]. It is easily seen that a
function f on [a, b], H¨older of order α, is of bounded 1/α-variation. Indeed,
this is a result of the bound
s1/α(f; κ) ≤K1/α
n
X
i=1

|ti −ti−1|α1/α
= K1/α(b −a),
(1.7)
valid for any partition κ = {ti}n
i=0 of [a, b]. We have the following:
Proposition 1.1. If f and g: [a, b] →R are H¨older of orders α and β re-
spectively with α + β > 1, then the Riemann–Stieltjes integral (RS) ∫b
a f dg
exists.
Proposition 1.1 is a special case of the following:
Proposition 1.2. If f and g: [a, b] →R are continuous, f ∈Wp[a, b] and
g ∈Wq[a, b] with 1 ≤p < ∞, 1 ≤q < ∞, and p−1 + q−1 > 1, then the
Riemann–Stieltjes integral (RS) ∫b
a f dg exists.
Proposition 1.2, in turn, is a special case of Corollary 3.91 in light of
Deﬁnition 2.41 below.
If g is not of bounded 1-variation then ∫b
a f dg is not a Lebesgue–Stieltjes
integral. If f is also not of bounded 1-variation, one cannot use integration by
parts to obtain a Lebesgue–Stieltjes integral. For any α with 0 < α < 1 there
exist functions g, H¨older of order α, which are not of bounded 1-variation.
Examples can be given by way of lacunary Fourier series, e.g. in the proof
of Theorem 3.75. So in deﬁning integrals ∫b
a f dg, neither the (reﬁnement)
Riemann–Stieltjes nor the Lebesgue–Stieltjes integral is adequate in general.
If f and g are regulated functions, then there is an integral (originating in the

1.1 How to Deﬁne ∫b
a f dg?
5
paper [254] of W. H. Young) which works in the cases we have mentioned. A
function g on [a, b] is called regulated if for each t ∈[a, b), the limit g(t+) :=
limu↓t g(u) exists, and for each s ∈(a, b], the limit g(s−) := limu↑t g(u) exists.
If g has bounded p-variation for some 0 < p < ∞then g is regulated (as
will be shown in Proposition 3.33). For any regulated function g on [a, b],
let ∆+g(t) := g(t+) −g(t) if a ≤t < b, and let ∆−g(s) := g(s) −g(s−)
if a < s ≤b. A tagged partition ({ti}n
i=0, {si}n
i=1) is called a Young tagged
partition if ti−1 < si < ti for each i = 1, . . . , n. Let f be any function on [a, b],
and let g be a regulated function on [a, b]. Given a Young tagged partition
τ = ({ti}n
i=0, {si}n
i=1), the sum
SYS(f, dg; τ)
:=
n
X
i=1
n
f(ti−1)∆+g(ti−1) + f(si)[g(ti−) −g(ti−1+)] + f(ti)∆−g(ti)
o
is called the Young–Stieltjes sum based on τ. The reﬁnement Young–Stieltjes
integral of f with respect to g is deﬁned and equals C ∈R if for each ǫ > 0
there exists a partition λ of [a, b] such that |C −SYS(f, dg; τ)| < ǫ for each
Young tagged partition τ which is a reﬁnement of λ. Then we let
(RYS)
Z b
a
f dg := lim
τ SYS(f, dg; τ) := C.
If the reﬁnement Riemann–Stieltjes integral exists then so does the reﬁne-
ment Young–Stieltjes integral with the same value, but not conversely (see
Proposition 2.18 below and the example following it). Let g be a nondecreas-
ing function on [a, b], right-continuous on [a, b), and let µg be the Lebesgue–
Stieltjes measure on [a, b]. Then for any µg-measurable function f on [a, b],
(RYS) ∫b
a f dg = (LS) ∫b
a f dg whenever both integrals exist (see Propositions
2.27 and 2.28 below). The next fact follows from Corollary 3.91:
Proposition 1.3. If f ∈Wp[a, b] and g ∈Wq[a, b] with 1 ≤p < ∞, 1 ≤
q < ∞, and p−1 + q−1 > 1, then the reﬁnement Young–Stieltjes integral
(RYS) ∫b
a f dg exists, and there is a constant Kp,q, depending only on p and
q, such that
(RYS)
Z b
a
f dg
 ≤Kp,q∥f∥[p]∥g∥(q).
The integrals (A) ∫b
a f dg have been deﬁned for A = RS, RRS, and RYS
so far only when a < b. If a = b then we let ∫a
a f dg := 0 for each of the three
integrals and call any function on a singleton regulated.
Interval functions
The Lebesgue–Stieltjes integral is essentially the Lebesgue integral with re-
spect to a countably additive (signed) measure. Similarly, we can consider

6
1 Introduction and Overview
extended Riemann–Stieltjes integrals with respect to a function µ deﬁned on
sets, namely subintervals of a nonempty interval J, and thus to be called an
interval function on J. An interval function µ on J with values in a vector
space will be called additive if µ(A ∪B) = µ(A) + µ(B) whenever A, B are
disjoint subintervals of J and their union A ∪B also is an interval.
The following is a concrete variant of a general integral introduced by A.
N. Kolmogorov in [120]. Let J be a nonempty interval, open or closed at
either end. An ordered collection {Ai}n
i=1 of disjoint nonempty subintervals
Ai of J is called an interval partition of J if their union is J and s < t for
all s ∈Ai and t ∈Aj whenever i < j. An interval partition which consists
only of open intervals and singletons is called a Young interval partition. If
{Ai}n
i=1 is an interval partition of J then an ordered pair ({Ai}n
i=1, {si}n
i=1) is
called a tagged interval partition of J and {si}n
i=1 a set of tags for {Ai}n
i=1 if
si ∈Ai for i = 1, . . . , n. An interval partition A is a reﬁnement of an interval
partition B, written A ⊐B, if each interval in A is a subinterval of an interval
in B.
Similarly, a tagged interval partition T = (A, ξ) is a tagged reﬁnement of
an interval partition B if A is a reﬁnement of B. Let f be a function on J
and let µ be an additive interval function on J, both real-valued. For a tagged
interval partition T = ({Ai}n
i=1, {si}n
i=1) of J, the sum
SK(f, dµ; T ) =
n
X
i=1
f(si)µ(Ai)
is called the Kolmogorov sum for f based on T . The Kolmogorov integral of
f with respect to µ is deﬁned and equals C ∈R if for each ǫ > 0 there exists
an interval partition A of J such that |C −SK(f, µ; T )| < ǫ for each tagged
interval partition T of J which is a tagged reﬁnement of A. Then we let
R
=
J
f dµ := lim
T SK(f, dµ; T ) := C.
The Kolmogorov integral can be related to the reﬁnement Young–Stieltjes
integral as follows. An interval function µ on [a, b] will be called upper con-
tinuous if µ(An) →µ(A) for any sequence of subintervals A1, A2, . . . of
[a, b] such that An ↓A. For any regulated function g on [a, b], there ex-
ists an additive upper continuous interval function µg on [a, b] such that
µg((s, t)) = g(t−) −g(s+) and µg({t}) = g(t+) −g(t−) for s < t in [a, b], set-
ting g(a−) := g(a) and g(b+) := g(b) in this case. For a = b let µg({a}) := 0.
Let g be a regulated function on [a, b], and let µg be the corresponding addi-
tive upper continuous interval function on [a, b]. There is a 1–1 correspondence
between tagged Young partitions τ of [a, b] and tagged Young interval par-
titions T of [a, b], with SYS(f, dg; τ) ≡SK(f, dµg; T ). The existence of the
Kolmogorov integral with respect to an upper continuous additive interval
function depends only on Kolmogorov sums which are based on tagged Young
interval partitions, as shown in Proposition 2.25 below. Therefore

1.2 Some Integral and Diﬀerential Equations
7
(RYS)
Z b
a
f dg =
R
=
[a,b]
f dµg
if either side is deﬁned. Note that in an integral (RYS) ∫b
a f dg, if for some
t ∈(a, b), g(t) has a value diﬀerent from g(t−) or g(t+), the value g(t) has no
inﬂuence on the value of the integral.
In this book we mainly use interval functions and the Kolmogorov integral.
The inequality of Proposition 1.3 extends to the Kolmogorov integral using
the p-variation for interval functions deﬁned as follows. Let µ be an additive
interval function on a nonempty interval J and let 0 < p < ∞. For an interval
partition A = {Ai}n
i=1 of J, let sp(µ; A) := Pn
i=1 |µ(Ai)|p. The p-variation of
µ on J is an interval function vp(µ) = vp(µ; ·) on J deﬁned by
vp(µ; A) := sup
A
sp(µ; A)
if A is a nonempty subinterval of J, where the supremum is over all interval
partitions A of A, or as 0 if A = ∅. We say that µ has bounded p-variation if
vp(µ; J) < ∞. For a subinterval A ⊂J, let Vp(µ; A) := vp(µ; A)1/p. The class
of all additive and upper continuous interval functions on J with bounded
p-variation is denoted by AIp(J). The following analogue of Proposition 1.3
for the Kolmogorov integral is a special case of Corollary 3.95.
Theorem 1.4. If µ ∈AIp[a, b] and f ∈Wq[a, b] with 1 ≤p < ∞, 1 ≤q < ∞,
and p−1 + q−1 > 1, then the Kolmogorov integral
R
=[a,b] f dµ exists, and there
is a constant Kp,q depending only on p and q such that

R
=
[a,b]
f dµ]
 ≤Kp,q∥f∥[a,b],[q]Vp(µ; [a, b]).
In Chapter 2, integrals will be deﬁned where integrands f (and for bilinear
integrals also g) and interval functions µ can all have values in Banach spaces.
1.2 Some Integral and Diﬀerential Equations
Consider a linear integral equation
f(t) = 1 + (RYS)
Z t
0
f dh,
0 ≤t ≤2,
with respect to a function h: [0, 2] →R, and/or a linear Kolmogorov integral
equation
f(t) = 1 +
R
=
[0,t]
f dµ,
0 ≤t ≤2,
(1.8)
where µ(A) := δ1(A) := 1A(1) for any interval A ⊂[0, 2] and h(t) := 1[1,∞)(t).
Either equation gives f(1) = 1 + f(1), a contradiction. If instead we take the
integral equation

8
1 Introduction and Overview
f(t) = 1 +
R
=
[0,t)
f dµ,
0 ≤t ≤2,
then it has the solution f(t) = 1 for 0 ≤t ≤1, f(t) = 2 for 1 < t ≤2.
Equations of the given form can be solved rather generally; see Section 9.11.
Product integration
Consider a linear kth order ordinary diﬀerential equation
dkx(t)
dtk
+ uk−1(t)dk−1x(t)
dtk−1
+ · · · + u0(t)x(t) = v(t),
a ≤t ≤b,
(1.9)
where for the present, x and the coeﬃcients uj and v are real-valued. As is
often done in diﬀerential equations, one can write an equivalent ﬁrst-order
linear vector and matrix diﬀerential equation
df(t)/dt = C(t) · f(t),
(1.10)
where f(·) is the (k + 1) × 1 column vector and C(·) is the (k + 1) × (k + 1)
matrix-valued function deﬁned respectively by
f(t) =






1
x(t)
x′(t)
. . .
x(k−1)(t)






and C(t) =








0
0
0
0
. . .
0
0
0
1
0
. . .
0
0
0
0
1
. . .
0
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
0
0
0
0
. . .
1
v
−u0
−u1
−u2
. . .
−uk−1








with x(j)(t) := djx(t)/dtj, v := v(t), and uj := uj(t) for j = 0, 1, . . ., k −1.
It is easy to check that for two 3 × 3 matrices A, B of the form of C, so that
k = 2, we have AB = BA if and only if A = B. The same is true for any k ≥2:
consider the next-to-last row of the products. Thus commuting matrices will
be obtained only for diﬀerential equations with constant coeﬃcients if k ≥2.
If (1.10) holds at a point t, then
f(t + s) −f(t) = sC(t) · f(t) + o(s)
as s ↓0,
or
f(t + s) =
 I + sC(t)

· f(t) + o(s)
as s ↓0,
(1.11)
where I is the (k+1)×(k+1) identity matrix. Suppose that C(·) is continuous
on an interval [a, b] and let h(t) := ∫t
a C(s) ds, so that h is a C1 function with
h(a) = 0. Let a = t0 < t1 < · · · < tn = t be a partition of [a, t] where
a < t ≤b. Then (1.11) implies that approximately
f(t) .= (I + h(tn) −h(tn−1)) · · · (I + h(t1) −h(t0))f(a)
(1.12)
for a ﬁne enough partition. Taking a limit of such products (without the f(a)
factor) as the mesh of the partition goes to 0, we get a matrix called
t
a(I+dh),

1.3 Basic Assumptions
9
the product integral of h from a to t. The product integral will give us the
value of the solution of the diﬀerential equation (1.9) in terms of the values
of x(·) and its derivatives through order k −1 at t = a, via
f(t) =
 t
a
(I + dh)

f(a).
If the increments of h commute then the product integral with respect to
h over an interval [a, t] is the exponential exp{h(t) −h(a)}, as follows from
Theorem 9.40 below and continuity of h. We will show in Section 9.12 that
f may have values in a Banach space X, and so h, as well as the product
integral with respect to h, will have values in the Banach algebra L(X, X) of
bounded operators from X into itself.
So far, h has been a C1 point function. In Chapter 9, we will see how
the product integral can be deﬁned for interval functions with values in any
Banach algebra, of bounded p-variation for 1 ≤p < 2. The product integral
will give, in Sections 9.11 and 9.12, solutions of integral equations, where the
integrals in the equations are Kolmogorov integrals, deﬁned brieﬂy in Section
1.1 and treated more fully in Section 2.3.
1.3 Basic Assumptions
Let K be either the ﬁeld R of real numbers or the ﬁeld C of complex numbers.
Let X, Y and Z be Banach spaces over K. The norm on each will be denoted
by ∥· ∥. For intuition, have in mind the case X = Y = Z = K with ∥x∥= |x|
for all x. Let B(·, ·) be a bounded bilinear operator from X ×Y into Z, where
“bounded” means that for some M < ∞,
∥B(x, y)∥≤M∥x∥∥y∥
(1.13)
for all x ∈X and y ∈Y . In the case X = Y = Z = K we will take
B(x, y) ≡xy. If (1.13) holds for a given M we will say that B is M-bounded.
If the three spaces X, Y, and Z are all diﬀerent then by changing the norm
to an equivalent one on any one of the spaces by a constant multiple, we can
assume M = 1. For a ﬁxed B we will write x·y := B(x, y). For later reference
we summarize some assumptions:

X, Y, Z are Banach spaces over K,
X×Y ∋(x, y) 7→x·y ∈Z
is 1-bounded and bilinear.
(1.14)
For example, let B be a Banach algebra over K with a norm ∥· ∥, as treated
in Chapter 4. Then we can take X = Y = Z = B and · as the multiplication
in B. By an equivalent renorming of B one can take the multiplication to be
1-bounded, as will be seen in Theorem 4.8.

10
1 Introduction and Overview
Reversing the order of integrand and integrator
Under the assumption (1.14), we will be giving various deﬁnitions of integrals
Z b
a
f·dg ≡
Z b
a
B(f, dg)
and
R
=
J
f·dµ ≡
R
=
J
B(f, dµ),
where −∞< a ≤b < +∞, f : [a, b] →X, g: [a, b] →Y , J is a subinterval of
[a, b] and µ is an interval function on [a, b] with values in Y . Then, for each
deﬁnition of integral ∫b
a f·dg, we will have the corresponding deﬁnition
Z b
a
df·g ≡
Z b
a
B(df, g) :=
Z b
a
˜B(g, df),
(1.15)
where ˜B(y, x) := B(x, y) is a bounded bilinear operator: Y ×X →Z and the
integrals on the left are deﬁned if and only if the integral on the right is.
The integrals ∫b
a f·dg with a < b will be deﬁned as limits of certain sums, but
the sums for f and g will in general not be symmetric in f and g, even if
X = Y and B(y, x) ≡B(x, y). Likewise, given a deﬁnition of
R
=[a,b] f·dµ and
an X-valued interval function ν on [a, b], we will write
R
=
J
dν·g ≡
R
=
J
B(dν, g) :=
R
=
J
˜B(g, dν).
(1.16)
1.4 Notation and Elementary Notions
Spaces of operators
Let X and Y be normed linear spaces. A linear function T from X into Y is
called a bounded linear operator iﬀ
∥T ∥:= sup{∥Tx∥: x ∈X, ∥x∥≤1} < ∞.
(1.17)
Then ∥T ∥is called the operator norm of T . The set of all bounded linear
operators from X into Y will be called L(X, Y ). It is easily seen to be a
normed linear space with the operator norm. If Y is a Banach space, then so
is L(X, Y ).
Spaces of bounded functions
For a function f from a nonempty set S into a normed space X, let
∥f∥sup := ∥f∥S,sup := sup{∥f(x)∥: x ∈S}.
Restricted to functions for which it is ﬁnite, i.e., bounded functions, ∥· ∥sup
is called the sup norm. The normed space of all bounded X-valued functions
on X is denoted by ℓ∞(S; X). Also, the oscillation of f on S is deﬁned by
OscS(f) := Osc (f; S) := sup

∥f(s) −f(t)∥: s, t ∈S
	
.

1.4 Notation and Elementary Notions
11
H¨older classes
Let X, Y be normed spaces, let U be a subset of X with more than one
element, and let 0 < α ≤1. A function f : U 7→Y is said to be H¨older of
order α, or simply α-H¨older, if
∥f∥(Hα) := ∥f∥U,(Hα)
:= sup

∥f(x) −f(y)∥/∥x −y∥α: x, y ∈U, x ̸= y
	
< ∞. (1.18)
An α-H¨older function on U is clearly continuous on U and will sometimes
be called α-H¨older continuous. The class of all α-H¨older functions from U
into Y is denoted by Hα(U; Y ). In the case U = X = Y = R we write
Hα = Hα(R; R).
Banach spaces of functions
Let S be a nonempty set, and let X be a Banach space over K. A set F of
X-valued functions on S is a vector space over K if it is a vector space with
respect to pointwise operations on S, that is, for f, g ∈F, a scalar r ∈K, and
any s ∈S,
(rf)(s) = rf(s)
and
(f + g)(s) = f(s) + g(s).
For example, the set XS of all X-valued functions on S is a vector space. If
F ⊂XS and ∥· ∥is a norm on F, then (F, ∥· ∥) will be called a Banach space
of X-valued functions on S iﬀF is a vector space and (F, ∥· ∥) is a Banach
space. If also X = K then (F, ∥· ∥) will be called a Banach space of functions.
Intervals
An interval in R is a set of any of the following four forms: for −∞≤u ≤v ≤
+∞,
(u, v) := {t ∈R: u < t < v},
[u, v) := {t ∈R: u ≤t < v},
with −∞< u,
(u, v] := {t ∈R: u < t ≤v},
with v < +∞, and
[u, v] := {t ∈R: u ≤t ≤v},
with −∞< u ≤v < +∞.
For each of the four cases, if the interval is nonempty, u is called its left
endpoint and v its right endpoint. For any u ∈R, [u, u] = {u} is a singleton
and (u, u] = [u, u) = (u, u) = ∅. An interval is called bounded if it is empty or
its left and right endpoints are ﬁnite. An interval will be called nondegenerate
if it contains more than one point. Let J be an interval in R. The class of
all subintervals of J will be denoted by I(J). The subclass of I(J) consisting
of nonempty open intervals and singletons will be denoted by Ios(J). If J =
[a, b] then we write I[a, b] and Ios[a, b]. For example, if a < b, Ios[a, b] =
{(u, v), {u}, {v}: a ≤u < v ≤b}.

12
1 Introduction and Overview
An interval A will be called right-open at v or in symbols A = [[·, v) if
A = [u, v) or (u, v) for some u < v. Similarly, A will be called right-closed at
v, or A = [[·, v], if J = [u, v] for some u ≤v or A = (u, v] for some u < v. An
interval A will be called left-open at u or A = (u, ·]] if A = (u, v) or (u, v] for
some u < v, and A will be called left-closed at u, or A = [u, ·]], if A = [u, v]
for some u ≤v or A = [u, v) for some u < v. For a ≤u < v ≤b, any of
the four intervals [u, v], (u, v], [u, v) or (u, v) will be denoted by [[u, v]]. Here
[[−∞, v]] or [[u, +∞]] will always mean (−∞, v]] or [[u, +∞), respectively. For
two disjoint nonempty intervals A and B, A ≺B will mean that s < t for all
s ∈A and t ∈B.
Point partitions
Let (S, <) be any linearly ordered set containing more than one point. Then
a point partition κ = {ti}n
i=0 of S is a ﬁnite sequence of elements of S such
that (i) t0 < t1 < · · · < tn, (ii) if S has a smallest element a, then t0 = a,
and (iii) if S has a largest element b, then tn = b. Let PP (S) denote the set
of all point partitions of S.
Thus for a nondegenerate interval J ⊂R, κ = {ti}n
i=0 ⊂J is a point
partition of J if t0 < t1 < · · · < tn, and if J = [a, b], a closed bounded interval,
then t0 = a and tn = b. At the beginning of Section 1.1 point partitions of
the closed interval J = [a, b] were deﬁned and called partitions. Most of the
further terminology related to point partitions was already given near the
beginning of Section 1.1 and is repeated here for the reader’s convenience.
For κ := {ti}n
i=0 ∈PP [a, b] with −∞< a < b < +∞, the mesh of κ is
|κ| := max1≤i≤n(ti −ti−1). A point partition κ is a reﬁnement of a point
partition λ if λ ⊂κ as a set. Let κ = {ti}n
i=0 be a partition of [a, b], and
let si ∈[ti−1, ti] for i = 1, . . . , n. Then τ = ({ti}n
i=0, {si}n
i=1) is called a
tagged partition of [a, b], and τ is a tagged reﬁnement of a point partition
λ if κ is a reﬁnement of λ. We will also say that the tagged partition τ
consists of the tagged intervals ([ti−1, ti], si), i = 1, . . . , n. If a tagged partition
τ = ({ti}n
i=0, {si}n
i=1) is such that si ∈(ti−1, ti) for i = 1, . . . , n, then τ is
called a Young tagged point partition. The mesh |τ| is deﬁned as |κ|.
Interval partitions
Let J be a nonempty interval in R. Recall the terminology deﬁned in the sub-
section “Interval functions” of Section 1.1. Let IP (J) be the set of all interval
partitions of J. If J is a bounded, nondegenerate interval [t0, tk] and A =
{Ai}n
i=1 is a Young interval partition {{t0}, (t0, t1), {t1}, . . . , (tk−1, tk), {tk}}
of J, then {(ti−1, ti)}k
i=1 sometimes will be written instead of A and we denote
by ({(ti−1, ti)}k
i=1, {ui}k
i=1) a corresponding tagged Young interval partition.
(The singletons {ti} with their uniquely determined tags ti are omitted from
the notation. Here n = 2k + 1.) Similarly, if J is left-open and/or right-open
the same notation will be used where now {t0} ̸∈A and/or {tk} ̸∈A.

1.4 Notation and Elementary Notions
13
Unconditional convergence
A sum P
j zj of elements zj of a normed space Z with norm ∥· ∥is said to
converge unconditionally in Z to S if and only if for every ǫ > 0 there is a ﬁnite
set E of values of j such that for every ﬁnite set A ⊃E, ∥S −P
j∈A zj∥< ǫ.
If Z is complete, then P
j zj converges unconditionally to some limit if and
only if for every ǫ > 0 there is a ﬁnite set E such that for every ﬁnite set B
of positive integers disjoint from E, ∥P
j∈B zj∥< ǫ.
p-variation
Let (S, <) be a linearly ordered set containing more than one point, (X, ∥· ∥)
a normed space over the ﬁeld K = R or C, and 0 < p < ∞. If f : S →X and
κ = {ti}n
i=0 is a point partition of S, let sp(f; κ) := Pn
i=1 ∥f(ti) −f(ti−1)∥p
be the p-variation sum for f over κ. Then the p-variation of f is deﬁned by
vp(f) := vp(f; S) := sup

sp(f; κ): κ ∈PP (S)
	
.
(1.19)
If S is a singleton then let the p-variation of f be vp(f; S) := 0.
Let Vp(f) := Vp(f; S) := vp(f; S)1/p, let Wp(S; X) be the set of all func-
tions f : S →X such that vp(f) < ∞, and let Wp(S) := Wp(S; R). In the
case S = [a, b] and X = R, we recover the notion already deﬁned by (1.2). If
1 ≤p < ∞we deﬁne
∥f∥(p) := ∥f∥S,(p) := Vp(f; S),
∥· ∥[p] := ∥· ∥(p) + ∥· ∥sup.
(1.20)
Just as for real-valued functions on a closed interval, ∥· ∥(p) is a seminorm
and ∥· ∥[p] is a norm on Wp(S; X).
Remark 1.5. It is easily seen that the supremum in the deﬁnition of vp(f)
is unchanged by restrictions (ii) and (iii) in the deﬁnition of a point partition
of S.
Let J be a nonempty interval. An interval function on J with values in X
is any function from subintervals of J to X. Let µ be an interval function on J
with values in X and let 0 < p < ∞. For an interval partition A = {Ai}n
i=1 ∈
IP (J), let
sp(µ; A) :=
n
X
i=1
µ

i[
j=1
Aj

−µ
 i−1
[
j=1
Aj

p
,
where a union over the empty set of indices is deﬁned as the empty set. The p-
variation of µ on J is an extended real-valued interval function vp(µ) = vp(µ; ·)
on J deﬁned by
vp(µ; A) := sup

sp(µ; A): A ∈IP (A)
	
≤+∞
if A is a nonempty subinterval of J, or as 0 if A = ∅. The class of all interval
functions on J with values in X such that sup{vp(µ; A): A ∈I(J)} < ∞is
denoted by Ip(J; X) and Ip(J) := Ip(J; R).

14
1 Introduction and Overview
Just before Theorem 1.4, deﬁnitions of sp and vp for an interval function
µ were given in case µ is additive. In that case, the deﬁnitions are easily seen
to agree. In general, however, they do not. The deﬁnitions just given will be
the ones used for general µ, e.g. multiplicative µ in Chapter 9.
If 1 ≤p < ∞let
∥µ∥J,(p) := sup{vp(µ; A)1/p : A ∈I(J)}.
(1.21)
By H¨older’s and Minkowski’s inequalities ((1.4) and (1.5), respectively), it is
easily seen that on Ip(J; R), ∥· ∥J,(p) is a seminorm.
Classes of measurable functions
Let (Ω, S, µ) be a measure space. A subset B of Ωis a µ-null set if there
is an A ∈S such that B ⊂A and µ(A) = 0. We say that a statement
holds µ-almost everywhere, or a.e. (µ), if it holds outside of a µ-null set. The
completion of µ is the extension of µ to a measure on the smallest σ-algebra
including S and containing all µ-null sets, e.g. [53, §3.3]. Let (X, ∥· ∥X) be
a Banach space. A function f : Ω→X is µ-measurable if for every Borel
set B ⊂X, f −1(B) is measurable for the completion of µ. For 1 ≤p < ∞,
Lp(Ω; X) := Lp(Ω, S, µ; X) denotes the set of all µ-measurable functions f
from Ωinto X such that
∥f∥p := ∥∥f∥X∥p :=
Z
Ω
∥f(ω)∥p
Xdµ(ω)
1/p
< ∞.
(1.22)
As usual, Lp(Ω; X) := Lp(Ω, S, µ; X) is the set of all µ-equivalence classes of
functions in Lp(Ω; X). A function f : Ω→X is called µ-essentially bounded
if
∥f∥∞:= inf
N sup

∥f(ω)∥X : ω ∈Ω\ N
	
< ∞,
(1.23)
where the inﬁmum is taken over all µ-null sets N. The set of all µ-essentially
bounded functions from Ωinto X is denoted by L∞(Ω; X) := L∞(Ω, S, µ; X),
and L∞(Ω; X) := L∞(Ω, S, µ; X) is the set of all µ-equivalence classes of
functions in L∞(Ω; X).
It is easy to check that since ∥·∥p is a norm on Lp(Ω, S, µ; R) (Minkowski’s
inequality for integrals, e.g. [53, Theorem 5.1.5]), it is also a norm on
Lp(Ω, S, µ; X) for 1 ≤p < ∞. Completeness also follows as for real-valued Lp
e.g. [53, Theorem 5.2.1], so (Lp(Ω, S, µ; X), ∥· ∥p) is a Banach space.
If Ωis the set of positive integers, µ is the counting measure, and X = R,
then Lp can be identiﬁed with Lp and is called ℓp. That is, ℓp for 1 ≤p ≤∞
is the Banach space of sequences x = {xj}j≥1 of real numbers with the norm
∥x∥p =
 X
j≥1
|xj|p1/p
if p < ∞and
∥x∥∞= sup
j≥1
|xj|.
A useful generalization of the spaces Lp(Ω; X) is the class of Orlicz spaces
deﬁned as follows. Recall that a set C in a vector space is called convex iﬀ

1.4 Notation and Elementary Notions
15
whenever u, v ∈C and 0 ≤α ≤1, we have αu + (1 −α)v ∈C. Then a real-
valued function f on C is called convex if f(αu+(1−α)v) ≤αf(u)+(1−α)f(v)
for all u, v ∈C and 0 ≤α ≤1, and g: C →R is called concave iﬀ−g
is convex. The class of all functions Φ: [0, ∞) →[0, ∞) that are strictly
increasing, continuous, convex, unbounded and 0 at 0 will be denoted by CV.
Note that Φ(u) = up, u ≥0, is in CV if and only if p ≥1.
For Φ ∈CV, the space LΦ(Ω, S, µ; X) := LΦ(Ω; X) of all µ-measurable
functions f : Ω→X such that for some c > 0,
Z
Ω
Φ(∥f∥/c) dµ < ∞,
is called an Orlicz space. Then LΦ(Ω, S, µ; X) := LΦ(Ω; X) is the set of all
µ-equivalence classes of functions in LΦ(Ω; X). LΦ(Ω; X) is a Banach space
with the Luxemburg norm
∥f∥Φ := inf
n
c > 0:
Z
Ω
Φ(∥f∥/c) dµ ≤1
o
,
(1.24)
e.g. [52, Theorem H.5]. If Ω= N, S is the class of all subsets of Ω, and µ is
equal to 1 on each singleton, then the Orlicz space LΦ(Ω, S, µ; R) is called an
Orlicz sequence space and is denoted by ℓΦ.
Let the ﬁeld K be R or C. If (Ω, S, µ) is a ﬁnite measure space, then
L0(Ω; K) := L0(Ω, S, µ; K) denotes the linear space of all µ-equivalence classes
of µ-measurable functions from Ωto K, metrized by the metric
d0(f, g) :=
Z
Ω
|f −g|/(1 + |f −g|) dµ.
It is well known that L0 under d0 is a topological vector space, and that for µ
nonatomic it is not locally convex. A sequence {fn} of µ-measurable functions
converges to a µ-measurable function f in µ-measure if for each ǫ > 0,
lim
n→∞µ
 
ω ∈Ω: |fn(ω) −f(ω)| > ǫ
	
= 0.
Convergence in L0(Ω; K) with respect to the metric d0 is equivalent to con-
vergence in µ-measure.


2
Deﬁnitions and Basic Properties of Extended
Riemann–Stieltjes Integrals
2.1 Regulated and Interval Functions
Regulated functions
Let X be a Banach space, and let J be a nonempty interval in R, which may
be bounded or unbounded, and open or closed at either end. Recall that an
interval is called nondegenerate if it has nonempty interior or equivalently
contains more than one point. Let ¯J be the closure of J in the extended real
line [−∞, ∞]. A function f on J with values in X is called regulated on J, just
as for real-valued functions in Chapter 1, if the right limit f(t+) := lims↓t f(s)
exists in X for t ∈¯J not equal to the right endpoint of J, and if the left limit
f(t−) := lims↑t f(s) exists in X for t ∈¯J not equal to the left endpoint of J.
If J = {a} = [a, a] is a singleton these conditions hold vacuously and we say
that f is regulated. The class of all regulated functions on J with values in X
will be denoted by R(J; X).
Let a < b throughout this paragraph (deﬁning quantities f−, f+, and ∆).
For a regulated function f on J = [[a, b]], deﬁne a function f (a)
−(t) := f(t−) for
t ∈(a, b]] or f(a) if t = a ∈J. Similarly deﬁne f (b)
+ (t) := f(t+) for t ∈[[a, b)
or f(b) if t = b ∈J. Deﬁne ∆+f on J by (∆+f)(t) := f(t+) −f(t), called the
right jump of f at t, for all t ∈J except the right endpoint. Similarly, deﬁne
a function ∆−f on J by (∆−f)(t) := f(t) −f(t−), called the left jump of f
at t, for all t ∈J except the left endpoint. Also, let ∆±f := ∆+f + ∆−f,
called the two-sided jump, on the interior of J. For a regulated function f on
J = [[a, b]], let ∆+
J f(t) := ∆+f(t) if t ∈[[a, b), or 0 if t = a /∈J or t = b;
∆−
J f(t) := ∆−f(t) if t ∈(a, b]], or 0 if t = b /∈J or t = a; and
∆±
J f(t) := ∆−
J f(t) + ∆+
J f(t)
(2.1)
=



∆+f(a) if t = a ∈J, or 0 if t = a /∈J;
∆±f(t) if t ∈(a, b);
∆−f(b) if t = b ∈J, or 0 if t = b /∈J.
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
17
in Mathematics, DOI 10.1007/978-1-4419-6950-7_2, 

18
2 Extended Riemann–Stieltjes Integrals
The deﬁnition of ∆±
J is made so that some later formulas will not need to
have special endpoint terms.
A step function from an interval J into a Banach space X is a ﬁnite sum
Pm
j=1 1A(j)xj, where xj ∈X and A(j) are intervals, some of which may be
singletons. Clearly a step function is regulated. The next fact shows that a
function is regulated if and only if it can be approximated uniformly by step
functions.
Theorem 2.1. Let X be a Banach space and −∞< a < b < +∞. The
following properties are equivalent for a function f : J := [[a, b]] →X:
(a) f ∈R([[a, b]]; X);
(b) for each ǫ > 0, there exists a Young interval partition {(ti−1, ti)}n
i=1 of
[[a, b]] such that Osc (f; (ti−1, ti)) < ǫ for each i ∈{1, . . . , n};
(c) f is a uniform limit of step functions.
Proof. (a) ⇒(b). Let ǫ > 0. By deﬁnition of R(J; X), if J = (a, b]], f(a+)
exists, and if J = [[a, b), f(b−) exists. Thus there exist a1 > a and b1 < b such
that Osc(f; (a, a1)) < ǫ and Osc(f; (b1, b)) < ǫ. So it suﬃces to consider the
case that [[a, b]] is a closed, bounded interval [a, b] (speciﬁcally, [a1, b1]). For
each s ∈(a, b), choose δs > 0 such that As := (s −δs, s + δs) ⊂[a, b] and the
oscillation of f over the open intervals (s −δs, s) and (s, s + δs) is less than ǫ.
For the endpoints, choose δa and δb ∈(0, b−a) such that Osc (f; (a, a+δa)) < ǫ
and Osc (f; (b −δb, b)) < ǫ. Letting Aa := [a, a + δa) and Ab := (b −δb, b], the
sets {As : s ∈[a, b]} form a cover of the compact interval [a, b] by relatively
open sets. Therefore there is a ﬁnite subcover As0, As1, . . . , Asm of [a, b] with
a = s0 < s1 < · · · < sm = b. Take t0 := s0, t1 ∈As0 ∩As1 ∩(s0, s1), t2 :=
s1, . . . , t2m−2 := sm−1, t2m−1 ∈Asm−1 ∩Asm ∩(sm−1, sm), and t2m := sm.
Thus (b) holds with n = 2m + 1.
(b) ⇒(c). Given ǫ > 0, choose a Young interval partition {(ti−1, ti)}n
i=1 of
J as in (b). Deﬁne a step function fǫ on J by fǫ(t) := f(si) with si ∈(ti−1, ti)
if t ∈(ti−1, ti) for some i ∈{1, . . . , n} and fǫ(ti) := f(ti) for i ∈{0, . . ., n} if
ti ∈J. Then ∥fǫ(t) −f(t)∥< ǫ for each t ∈J. Since ǫ is arbitrary, (c) follows.
(c) ⇒(a). Given ǫ > 0, choose a step function fǫ such that ∥fǫ(t)−f(t)∥<
ǫ for each t ∈J. Then for any s, t ∈J, ∥f(t) −f(s)∥< 2ǫ + ∥fǫ(t) −fǫ(s)∥.
Since fǫ is regulated, the right side can be made arbitrarily small for all s, t
close enough from the left or right to any given point of J, proving (a). The
proof of Theorem 2.1 is complete.
2
The following is an easy consequence of the preceding theorem.
Corollary 2.2. If f is regulated on [[a, b]] then f is bounded, Borel measurable,
and for each ǫ > 0,
card
n
u ∈[[a, b]]: either
∆+
[[a,b]]f(u)
 > ǫ or
∆−
[[a,b]]f(u)
 > ǫ
o
< ∞.

2.1 Regulated and Interval Functions
19
Proof. By implication (a) ⇒(b) of Theorem 2.1, there is a Young interval
partition {(ti−1, ti)}n
i=1 of [[a, b]] such that Osc(f; (ti−1, ti)) ≤1 for each i =
1, . . . , n. Let t ∈[[a, b]] and let i be such that t = ti or t ∈(ti−1, ti). Then
∥f(t)∥≤1 + max1≤i≤n ∥f(ti−1+)∥+ max0≤i≤n ∥f(ti)∥, proving the ﬁrst part
of the conclusion. The third part also follows from Theorem 2.1(b) since each
jump can be approximated arbitrarily closely by increments of f. It then
follows that f is continuous except on a countable set, and so it is Borel
measurable, completing the proof.
2
Interval functions
Let X be a Banach space with norm ∥· ∥, let J be a nonempty interval in R,
possibly unbounded, and let I(J) be the class of all subintervals of J. Any
function µ: I(J) →X will be called an interval function on J. The class of
all X-valued interval functions on J is denoted by I(J; X), and it is denoted
by I(J) if X = R. An interval function µ on J will be called additive if
µ(A∪B) = µ(A)+µ(B) whenever A, B ∈I(J) are disjoint and A∪B ∈I(J).
If µ is an additive interval function then clearly µ(∅) = 0. An additive interval
function µ on J is uniquely determined by its restriction to the class Ios(J),
i.e. the class of all open subintervals and singletons of J.
For intervals as for other sets, An ↑A will mean A1 ⊂A2 ⊂· · · and
∪∞
n=1An = A, while An ↓A will mean A1 ⊃A2 ⊃· · · and ∩∞
n=1An = A, and
An →A will mean 1An(t) →1A(t) as n →∞for all t ∈R.
Deﬁnition 2.3. 1. An interval function µ on J will be called upper continu-
ous if µ(An) →µ(A) for any A, A1, A2, . . . ∈I(J) such that An ↓A.
2. An interval function µ on J will be called upper continuous at ∅if
µ(An) →µ(∅) for any A1, A2, . . . ∈I(J) such that An ↓∅.
If J is a singleton then the conditions of Deﬁnition 2.3 hold vacuously and
each interval function on J is upper continuous as well as upper continuous
at ∅.
In this section we establish relations between the class of additive upper
continuous interval functions on J and classes of regulated functions on J. But
ﬁrst, here is an example of an interval function which is not upper continuous.
Example 2.4. Let J be a nondegenerate interval. The Banach space of all
real-valued and bounded functions on J with the supremum norm is denoted
by ℓ∞(J). Recall that for Lebesgue measure λ on J, L∞(J, λ) is the Banach
space of λ-equivalence classes of λ-essentially bounded functions with the es-
sential supremum norm. For an interval A ⊂J, let µ(A) := 1A. Then for 1A
as a member of ℓ∞(J) or of L∞(J, λ), µ is an additive interval function on J,
but not upper continuous at ∅.
For a regulated function h on [[a, b]] with values in X there is a correspond-
ing additive interval function µh := µh,[[a,b]] on [[a, b]] deﬁned by

20
2 Extended Riemann–Stieltjes Integrals
µh,[[a,b]]((u, v)) := h(v−) −h(u+) for a ≤u < v ≤b,
µh,[[a,b]]({u}) := ∆±
[[a,b]]h(u) for u ∈[[a, b]],
(2.2)
if a < b, and µh,[a,a]({a}) := µh,[a,a](∅) := 0 if a = b. For a < b we have
µh,(a,b]({b}) = ∆±
(a,b]h(b) = ∆−h(b). It follows that if h on (a, b] is right-
continuous on (a, b) then for a ≤c < d ≤b we have µh((c, d]) = h(d) −h(c).
Thus the deﬁnition (2.2) of µh just given extends the one given earlier for the
deﬁnition (1.6) of the Lebesgue–Stieltjes integral.
Notice that µh does not depend on the values of h at its jump points
(points where it has a non-zero left or right jump) in (a, b). In the converse
direction, for any interval function µ on [[a, b]], deﬁne two functions Rµ,a and
Lµ,a on [[a, b]] by
Rµ,a(t) :=
 µ(∅)
if t = a ∈[[a, b]]
µ([[a, t]) if t ∈(a, b]],
Lµ,a(t) :=

µ([[a, t)) if t ∈[[a, b)
µ([[a, b]) if t = b ∈[[a, b]].
(2.3)
(Recall that if µ is additive, µ(∅) = 0.) If µ is upper continuous then Rµ,a
and Lµ,a are both regulated point functions on [[a, b]], as will be shown in
Proposition 2.6 when a < b. The converse is not true as the following shows:
Example 2.5. Let a < b, µ([u, v)) := µ((u, v]) := 0 and µ([u, v]) := 1 for
a ≤u ≤v ≤b, and µ((u, v)) := −1 if also u < v. Then µ is an additive
interval function on [a, b], Rµ,a = 1(a,b] and Lµ,a = 1{b} are regulated, but µ
is not upper continuous at ∅. For h = Rµ,a or Lµ,a, µ ̸= µh.
For x ∈J, we will say that the singleton {x} is an atom of µ if µ({x}) ̸= 0.
The following gives a characterization of additive upper continuous interval
functions on J. In particular, such interval functions cannot have more than
countably many atoms.
Proposition 2.6. Let J be a nondegenerate interval and let µ ∈I(J; X) be
additive. The following ﬁve statements are equivalent:
(a) µ is upper continuous;
(b) µ is upper continuous at ∅;
(c) µ(An) →0 whenever open intervals An ↓∅, and
card{u ∈J : ∥µ({u})∥> ǫ} < ∞
for all ǫ > 0;
(2.4)
(d) µ(An) →µ(A) whenever intervals An ↑A;
(e) µ(An) →µ(A) whenever intervals An →A ̸= ∅.
If J = [[a, b]] then the above statements are equivalent to each of the following
two statements:
(f)Rµ,a is regulated, Rµ,a(x−) = µ([[a, x)) for x ∈(a, b]], and Rµ,a(x+) =
µ([[a, x]) for x ∈[[a, b);

2.1 Regulated and Interval Functions
21
(g) Lµ,a is regulated, Lµ,a(x−) = µ([[a, x)) for x ∈(a, b]], and Lµ,a(x+) =
µ([[a, x]) for x ∈[[a, b).
Proof. (a) ⇔(b). Clearly, (a) implies (b). For (b) ⇒(a), let intervals An ↓A.
Then An = Bn ∪A∪Cn for intervals Bn ≺A ≺Cn, with Bn ↓∅and Cn ↓∅.
So µ(An) →µ(A) by additivity.
(b) ⇒(c). The ﬁrst part of (c) is clear. For the second part, suppose there
exist ǫ > 0 and an inﬁnite sequence {uj} of diﬀerent points of J such that
∥µ({uj})∥> ǫ for all j. Then there are a u ∈¯J and a subsequence {uj′}
such that either uj′ ↓u or uj′ ↑u as j′ →∞. In the ﬁrst case, by additivity,
µ({uj′}) = µ((u, uj′]) −µ((u, uj′)) →0 as j′ →∞, because both (u, uj′] ↓∅
and (u, uj′) ↓∅. This contradiction proves (2.4) in the case uj′ ↓u. The proof
in the case uj′ ↑u is symmetric.
For (c) ⇒(b), let intervals An ↓∅. Then for some u ∈¯J, for all suﬃciently
large n, either An is left-open at u, or An is right-open at u. Using additivity,
in each of the two cases µ(An) →0 follows by (c).
For (b) ⇒(e), let intervals An →A ̸= ∅. If A = (u, v) then {u} ≺
An ≺{v} for n large enough. For such n, there are intervals Cn and Dn with
{u} ≺Cn ≺An ≺Dn ≺{v} and Cn ∪An ∪Dn = A. Also for such n, we
have either Cn = ∅or Cn = (u, ·]], and either Dn = ∅or Dn = [[·, v). Clearly
Cn →∅. If N := {n:
Cn ̸= ∅} is inﬁnite, there is a function j 7→n(j) onto
N such that Cn(j) ↓∅. Thus µ(Cn) →0. Similarly µ(Dn) →0. Therefore
µ(An) = µ(A) −µ(Cn) −µ(Dn) →µ(A). Similar arguments apply to other
cases A = (u, v], [u, v), or [u, v].
Clearly, (e) implies (d). For (d) ⇒(b), let intervals An ↓∅. Then A1 = Bn∪
An ∪Cn for some intervals Bn, Cn with Bn ≺An ≺Cn, and Bn ↑B, Cn ↑C
for some intervals B, C with A1 = B ∪C. Since µ is additive, µ(An) →0.
(b) ⇔(f) ⇔(g). The implications (b) ⇒(f) and (b) ⇒(g) are clear. We
prove (f) ⇒(b) only, because the proof of (g) ⇒(b) is similar. Let intervals
An ↓∅. Then for some u and all suﬃciently large n, either An is left-open
at u ∈[[a, b), or An is right-open at u ∈(a, b]]. By assumption, in the ﬁrst
case we have limn µ(An) = Rµ,a(u+)−Rµ,a(u) = 0 and in the second case we
have limn µ(An) = Rµ,a(u−) −Rµ,a(u−) = 0. The proof of Proposition 2.6 is
complete.
2
The class of all additive and upper continuous functions in I(J; X) will be
denoted by AI(J; X). For the next two theorems, recall the deﬁnition (2.2)
of the interval function µh corresponding to a regulated function h.
Theorem 2.7. For any regulated function h on a nonempty interval [[a, b]],
the interval function µh is in AI([[a, b]]; X), and the map h 7→µh is linear.
Proof. We can assume that a < b. Additivity is immediate from the deﬁnition
of µh, as is linearity of h 7→µh. For upper continuity it is enough to prove
statement (c) of Proposition 2.6. Let open intervals An ↓∅. Thus there exist

22
2 Extended Riemann–Stieltjes Integrals
{u, vn : n ≥1} ⊂[[a, b]] such that for all large enough n, either An = (vn, u)
with vn ↑u or An = (u, vn) with vn ↓u. Then µh(An) = h(u−)−h(vn+) →0
as n →∞in the ﬁrst case and µh(An) = h(vn−) −h(u+) →0 as n →
∞in the second case. Since µ({t}) = ∆±
[[a,b]]h(t) for t ∈[[a, b]], card{t ∈
[[a, b]]: ∥µ({t})∥> ǫ} < ∞for all ǫ > 0 by Corollary 2.2. Thus µ is upper
continuous by Proposition 2.6, and Theorem 2.7 is proved.
2
Theorem 2.8. For an additive µ ∈I([[a, b]]; X) with a < b, the following
statements are equivalent:
(a) µ is upper continuous;
(b) µ = µh on I[[a, b]] for h = Rµ,a;
(b′)µ = µh on I[[a, b]] for h = Lµ,a;
(c) µ = µh on I[[a, b]] for some h ∈R([[a, b]]; X) with h(a) = 0 if a ∈[[a, b]] and
h(a+) = 0 otherwise.
Proof. (a) ⇒(b): suppose that an additive interval function µ on [[a, b]] is
upper continuous. Let h := Rµ,a. Then by (a) ⇔(f) of Proposition 2.6, and
by the deﬁnition of Rµ,a, h is regulated and right-continuous on (a, b), and
µh = µ on all intervals [[a, t] and [[a, t), t ∈[[a, b]]. Since µ and µh are additive,
µ = µh on I[[a, b]]. A proof that (a) ⇒(b′) is similar.
The implications (b) ⇒(c) and (b′) ⇒(c) are immediate. The implication
(c) ⇒(a) follows from Theorem 2.7, proving the theorem.
2
By the preceding theorem, for each µ ∈AI([[a, b]]; X) with a < b there is
a regulated function h on [[a, b]] such that µ = µh. The following will be used
to clarify diﬀerences between all such h.
Deﬁnition 2.9. For any intervals A ⊂J and Banach space (X, ∥·∥), c0(A) :=
c0(A, J) := c0(A, J; X) is the set of functions f : J →X such that for some
sequence {tn}∞
n=1 ⊂A, f(tn) →0 as n →∞and f(t) = 0 if t ̸= tn for all n.
Notice that if a < b and f ∈c0((a, b), [a, b]; X)) then f is regulated on
[a, b] with f (a)
−
≡f (b)
+ ≡0 on [a, b].
Proposition 2.10. Let g, h ∈R([a, b]; X). Then µg = µh on I[a, b] if and
only if for some constant c and ψ ∈c0((a, b)) = c0((a, b), [a, b]; X), g −h =
c + ψ on [a, b]. Moreover, if µg = µh on I[a, b] and g(a) = h(a) then c = 0.
Proof. We can assume that a < b. Since ψ(s+) = ψ(t−) = 0 for a ≤s < t ≤b,
the “if” part holds. For the converse implication suppose that µg = µh. Let Dg
be the set of all points t ∈(a, b) such that either ∆−g(t) ̸= 0 or ∆+g(t) ̸= 0.
Deﬁne Dh similarly. Let D := Dg ∪Dh and let c := g(a) −h(a). Deﬁne ψ on
[a, b] by ψ(t) := g(t) −h(t) −c for t ∈D and 0 elsewhere. Since µg = µh on
I[a, b], g(u−) = c + h(u−) and g(v+) = c + g(v+) for a ≤v < u ≤b. Thus

2.1 Regulated and Interval Functions
23
g −h = c on [a, b]\D and g −h = c+ψ on D. By Corollary 2.2, ψ ∈c0((a, b)),
completing the proof of the converse implication.
2
The regulated function h in Theorem 2.8(c) can be chosen uniquely if it
satisﬁes additional properties. For a < b, let D([[a, b]]; X) be the set of all
h ∈R([[a, b]]; X) such that h is right-continuous on (a, b) and either h(a) = 0
if a ∈[[a, b]] or h(a+) = 0 if a ̸∈[[a, b]]. Thus h ∈D([a, b]]; X) need not be right-
continuous at a, just as Rµ,a is not if {a} is an atom for µ ∈AI([a, b]]; X).
Corollary 2.11. Let a < b and let X be a Banach space. The mappings
D([[a, b]]; X) ∋h 7→µ := µh ∈AI([[a, b]]; X)
(2.5)
and
AI([[a, b]]; X) ∋µ 7→h := Rµ,a ∈D([[a, b]]; X)
(2.6)
are one-to-one linear operators between the vector spaces AI([[a, b]]; X) and
D([[a, b]]; X). Moreover, the two mappings are inverses of each other.
Proof. If h ∈D([[a, b]]; X) then µh ∈AI([[a, b]]; X) by Theorem 2.8(c) ⇒(a). If
µg = µh on I[[a, b]] for some g, h ∈D([[a, b]]; X) then h(x)−g(x) = µh([[a, x])−
µg([[a, x]) for each x ∈(a, b]], and so g ≡h on [[a, b]]. Thus the mapping (2.5)
is one-to-one. It clearly is linear.
If µ ∈AI([[a, b]]; X) then Rµ,a ∈D([[a, b]]; X) by Proposition 2.6(f). By
the same proposition, if Rµ,a = Rν,a on [[a, b]] for some µ, ν ∈AI([[a, b]]; X)
then µ = ν on I[[a, b]]. Thus the mapping (2.6) also is one-to-one and linear,
proving the ﬁrst part of the conclusion.
To prove the second part of the conclusion, ﬁrst let h ∈D([[a, b]]; X). By
(2.3), (2.2), and Proposition 2.6(f), if t ∈(a, b]] then we have Rµh,a(t) = h(t).
Also, if a ∈[[a, b]] then Rµh,a(a) = 0 = h(a). Thus the composition of (2.5)
with (2.6) maps h ∈D([[a, b]]; X) into itself. Since both maps are one-to-one
and (2.6) is onto, the proof of the corollary is complete.
2
Next is a property of an upper continuous additive interval function similar
to the property in Theorem 2.1(b) for regulated functions. For an interval
function µ on [[a, b]] and an interval J ⊂[[a, b]], let
Osc(µ; J) := sup

∥µ(A)∥: A ∈I[[a, b]], A ⊂J
	
.
(2.7)
In the case J = [a, b], we also write ∥µ∥sup := Osc(µ; [a, b]).
Corollary 2.12. Let X be a Banach space, µ ∈AI([[a, b]]; X) with a < b and
ǫ > 0. There exists a Young interval partition {(ti−1, ti)}n
i=1 of [[a, b]] such that
Osc(µ; (ti−1, ti)) ≤ǫ for each i = 1, . . . , n. In particular, µ is bounded.

24
2 Extended Riemann–Stieltjes Integrals
Proof. Let h := Rµ,a be the function from [[a, b]] to X deﬁned by (2.3). By
implication (a) ⇒(f) of Proposition 2.6, h is a regulated function on [[a, b]],
and so by implication (a) ⇒(b) of Theorem 2.1, there exists a Young in-
terval partition {(ti−1, ti)}n
i=1 of [[a, b]] such that Osc(h; (ti−1, ti)) < ǫ for
each i = 1, . . . , n. By implication (a) ⇒(b) of Theorem 2.8, for an inter-
val A ⊂(ti−1, ti), µ(A) = µh(A), and so ∥µ(A)∥≤ǫ, proving the ﬁrst part
of the conclusion. The second part follows similarly because h is bounded by
Corollary 2.2, completing the proof of the corollary.
2.2 Riemann–Stieltjes Integrals
Suppose that the basic assumption (1.14) holds. Let f, h be functions deﬁned
on an interval [a, b] with −∞< a ≤b < +∞and having values in X, Y ,
respectively. If a < b, given a tagged partition τ = ({ti}n
i=0, {si}n
i=1) of [a, b],
deﬁne the Riemann–Stieltjes sum SRS(τ) = SRS(f, dh; τ) based on τ by
SRS(f, dh; τ) :=
n
X
i=1
f(si)·

h(ti) −h(ti−1)

.
The Riemann–Stieltjes or RS integral (RS) ∫b
a f·dh is deﬁned to be 0 if a = b
and otherwise is deﬁned if the limit exists in (Z, ∥· ∥) as
(RS)
Z b
a
f·dh := lim
|τ|↓0 SRS(f, dh; τ).
(2.8)
The reﬁnement Riemann–Stieltjes or RRS integral (RRS) ∫b
a f·dh is deﬁned
to be 0 if a = b and otherwise is deﬁned as
(RRS)
Z b
a
f·dh := lim
τ SRS(f, dh; τ)
(2.9)
provided the limit exists in the reﬁnement sense, that is, (RRS) ∫b
a f·dh := A
if for every ǫ > 0 there is a point partition λ of [a, b] such that for every tagged
partition τ = (κ, ξ) such that κ is a reﬁnement of λ, ∥SRS(f, dh; τ) −A∥< ǫ.
Integrals ∫b
a dh·f for both the RS and RRS integrals are deﬁned sym-
metrically via (1.15). If a < b, the Riemann–Stieltjes sum based on a tagged
partition τ = ({ti}n
i=0, {si}n
i=1) of [a, b], with the integrand and integrator
interchanged, will be denoted by
SRS(dh, f; τ) :=
n
X
i=1

h(ti) −h(ti−1)

·f(si).
Then the integral ∫b
a dh·f is deﬁned in the sense of RS or RRS if and only
if the limit (2.8) or (2.9), respectively, exists with SRS(f, dh; τ) replaced by
SRS(dh, f; τ).

2.2 Riemann–Stieltjes Integrals
25
Proposition 2.13. The reﬁnement Riemann–Stieltjes integral extends the
Riemann–Stieltjes integral.
Proof. For a = b, both integrals are 0. For a < b, and a partition λ, a reﬁne-
ment κ of λ has mesh |κ| ≤|λ|, so the conclusion holds.
2
Example 2.14. Let f be a real-valued function on [a, b] and let ℓc := 1[c,b]
be the indicator function of [c, b] for some a < c < b. For any tagged partition
τ = ({ti}n
i=0, {si}n
i=1) of [a, b], we have SRS(f, dℓc; τ) = f(si) for ti−1 < c ≤ti
and si ∈[ti−1, ti]. The integral (RS) ∫b
a f dℓc exists and equals f(c) if and only
if f is continuous at c. Taking c to be a partition point, it follows that the
integral (RRS) ∫b
a f dℓc exists and equals f(c) if and only if f is left-continuous
at c. Therefore (RRS) ∫b
a 1[a,c] dℓc exists and equals 1, while the same integral
in the Riemann–Stieltjes sense does not exist. On the other hand, the integral
(RRS) ∫b
a ℓc dℓc also does not exist.
Two functions f, h on an interval [a, b] will be said not to have common
discontinuities if for each t ∈[a, b], at least one of f and h is continuous at
t. Also, f and h will be said to have no common one-sided discontinuities on
[a, b] if at least one of f and h is left-continuous at each t ∈(a, b] and at least
one is right-continuous at each t ∈[a, b).
Proposition 2.15. Assuming (1.14), for any functions f and h from [a, b]
into X and Y , respectively, we have:
(a) If (RS) ∫b
a f·dh exists then f and h have no common discontinuities;
(b) If (RRS) ∫b
a f·dh exists then f and h have no common one-sided discon-
tinuities.
Proof. For (a) suppose that the integral (RS) ∫b
a f·dh exists. For each t ∈[a, b]
and a partition κ = {xi}n
i=1 of [a, b], there is an index i such that t ∈[xi−1, xi],
where we can take i to be unique for partitions with arbitrarily small mesh.
Subtracting two Riemann–Stieltjes sums based on the partition κ with small
enough mesh |κ| and with all terms equal except for the ith term, one can
conclude that ∥[f(y′
i) −f(y′′
i )]·[h(xi) −h(xi−1)]∥is arbitrarily small for any
y′
i, y′′
i ∈[xi−1, xi]. Thus either f or h must be continuous at t.
The proof of (b) is similar except that one needs to restrict to partitions
containing a point t ∈[a, b].
2
When f or h is continuous, the RS and RRS integrals coincide if either
exists, as we will show in Theorem 2.42. Some classical suﬃcient conditions
for existence of the two integrals are expressed using the total variation or the
semivariation of the integrator. Let X, Y , and Z be Banach spaces related by
means of a bounded bilinear operator B from X × Y into Z as in assumption

26
2 Extended Riemann–Stieltjes Integrals
(1.14) and let h: [a, b] →Y with −∞< a < b < +∞. The semivariation of
h on [a, b] is deﬁned by
w(h; [a, b]) :=wB(h; [a, b]) := sup
n
n
X
i=1
xi·[h(ti) −h(ti−1)]
:
{ti}n
i=0 ∈PP [a, b], {xi}n
i=1 ⊂X, max
i
∥xi∥≤1
o
,
(2.10)
where PP [a, b] is the set of all point partitions of [a, b]. Then h is said to
be of bounded semivariation on [a, b] if wB(h; [a, b]) < +∞. As the notation
wB(h; [a, b]) indicates, the semivariation depends on the Banach spaces X,
Y , and Z and the bilinear operator B : (x, y) 7→x·y. Recall that the total
variation of h on [a, b] is the 1-variation of h on [a, b], that is,
v(h; [a, b]) := sup

s1(h; κ): κ ∈PP [a, b]
	
= sup
n
n
X
i=1
∥h(ti) −h(ti−1)∥: {ti}n
i=0 ∈PP [a, b]
o
.
The total variation v(h; [a, b]) does not depend on X, Z or B. It is clear that
wB(h; [a, b]) ≤v(h; [a, b]) ≤+∞. Also, if X = Y ′, Z = R and B(x, y) =
x(y), then wB(h; [a, b]) = v(h; [a, b]). However in general, it is possible that
wB(h; [a, b]) < ∞while v(h; [a, b]) = +∞, as the following example shows:
Example 2.16. For each t ∈[0, 1], let h(t) := 1[0,t]. Then h is a function from
[0, 1] into Y = Z = ℓ∞[0, 1], the Banach space of real-valued and bounded
functions on [0, 1] with the supremum norm. For a point partition {ti}n
i=0 of
[0, 1] and for any ﬁnite sequence {xi}n
i=1 ⊂X = R of real numbers in [−1, 1],
we have

n
X
i=1
xi[h(ti) −h(ti−1)]

sup =

n
X
i=1
xi1(ti−1,ti]

sup = max
i
|xi| ≤1.
Thus h has bounded semivariation on [0, 1], with w(h; [0, 1]) = 1. Also, h has
unbounded p-variation for any p < ∞. Indeed, if 0 < p < ∞and κ = {ti}n
i=0
is a point partition of [0, 1], then
sp(h; κ) =
n
X
i=1
∥1(ti−1,ti]∥p
sup = n.
Since n is arbitrary, vp(h; [0, 1]) = +∞. The function h is not regulated on
[0, 1] since it clearly does not satisfy condition (b) of Theorem 2.1. Moreover,
for a real-valued function f on [0, 1], the integral (RS) ∫1
0 f dh exists if and
only if f is continuous. Indeed, if f is continuous, then given ǫ > 0, there is
a δ > 0 such that |f(t) −f(s)| < ǫ whenever s, t ∈[0, 1] and |s −t| < δ.
Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition of [0, 1] with mesh |τ| < δ.

2.2 Riemann–Stieltjes Integrals
27
For each t ∈[0, 1] there is an i ∈{1, . . . , n} such that either t ∈(ti−1, ti], or
t ∈[0, t1]. In either case |SRS(f, dh; τ)(t) −f(t)| = |f(si) −f(t)| < ǫ, and so
(RS) ∫1
0 f dh exists and equals f. Now, if f is not continuous then for some
t ∈[0, 1], the diﬀerence |SRS(f, dh; τ)(t) −f(t)| cannot be arbitrarily small
for all tagged partitions with small enough mesh, proving the claim.
Now we are prepared to prove the following:
Theorem 2.17. Assuming (1.14), if f or h is of bounded semivariation and
the other is regulated, and they have no common one-sided discontinuities,
then (RRS) ∫b
a f·dh exists.
Proof. First suppose that h has bounded semivariation on [a, b] and f is reg-
ulated. Given ǫ > 0, by statement (b) of Theorem 2.1, there exists a partition
λ = {zl}k
l=0 of [a, b] such that
Osc(f; (zl−1, zl)) < ǫ
for l = 1, . . . , k.
(2.11)
Since f and h have no common one-sided discontinuities, there exists a se-
quence µ = {ul−1, vl : l = 1, . . . , k} ⊂(a, b) such that for each l = 1, . . . , k,
zl−1 < ul−1 < vl < zl,
min

Osc(f; [zl−1, ul−1]), Osc(h; [zl−1, ul−1])
	
< ǫ/k
(2.12)
and
min

Osc(f; [vl, zl]), Osc(h; [vl, zl])
	
< ǫ/k.
(2.13)
Let τ = ({tj}m
j=0, {sj}m
j=1) be a tagged reﬁnement of λ ∪µ. For each j =
1, . . . , m, let τj = ({tji}nj
i=0, {sji}nj
i=1) be any tagged partition of [tj−1, tj].
Then ∪jτj is an arbitrary tagged reﬁnement of τ. If tj−1 ∈{z0, . . . , zk−1}
then
f(sj)·[h(tj) −h(tj−1)] −SRS(τj) =

f(sj) −f(tj)

·[h(tj) −h(tj−1)

+
nj
X
i=1

f(tj) −f(sji)

·

h(tji) −h(tj,i−1)

.
The ﬁrst product on the right side, say Uj, and the i = 1 term, say Vj, by
(2.12), have the bound
∥Uj∥+ ∥Vj∥≤4(ǫ/k) max{∥f∥sup, ∥h∥sup}.
(2.14)
At most one of tj−1 and tj is a zi. If tj ∈{z1, . . . , zk} then
f(sj)·[h(tj) −h(tj−1)] −SRS(τj) =

f(sj) −f(tj−1)

·[h(tj) −h(tj−1)

+
nj
X
i=1

f(tj−1) −f(sji)

·

h(tji) −h(tj,i−1)

.

28
2 Extended Riemann–Stieltjes Integrals
The ﬁrst product on the right side and the i = nj term have the same
bound as in (2.14) by (2.13). We apply the preceding 2k representations with
the bounds (2.14). We bound the sum of the remaining terms for all j by
maxl=1,...,k Osc(f; (zl−1, zl))wB(h; [a, b]), and using (2.11) we get the bound
SRS(τ) −SRS(∪jτj)
 < ǫwB(h; [a, b]) + 8ǫ max{∥f∥sup, ∥h∥sup}.
Since ǫ > 0 is arbitrary, the integral (RRS) ∫b
a f·dh exists.
Now suppose that f has bounded semivariation and h is regulated. Given
ǫ > 0, choose a partition λ = {zl}k
l=0 of [a, b] such that (2.11) with h instead of
f holds. Then choose a sequence µ = {ul−1, vl : l = 1, . . . , k} such that (2.12)
and (2.13) hold. Again let τ = ({tj}m
j=0, {sj}m
j=1) be a tagged reﬁnement of
λ ∪µ, and for each j = 1, . . . , m, let τj = ({tji}nj
i=0, {sji}nj
i=1) be a tagged
partition of [tj−1, tj]. If tj ̸∈{z1, . . . , zk}, then summing by parts we have
f(sj)·[h(tj) −h(tj−1)] −SRS(τj) =

f(sj) −f(sj1)

·[h(tj) −h(tj−1)

+
nj−1
X
i=1

f(sj,i+1) −f(sji)

·

h(tji) −h(tj)

.
If also tj−1 ∈{z0, . . . , zk−1}, then for the ﬁrst product on the right side, say
Tj, by (2.12), we have the bound
∥Tj∥≤2(ǫ/k) max{∥f∥sup, ∥h∥sup}.
(2.15)
The norm of the sum of the terms Tj for which neither tj−1 nor tj is a zi has
the bound ǫwB(f; [a, b]) by (2.11) with h instead of f. If tj ∈{z1, . . . , zk},
then summing by parts we have
f(sj)·[h(tj) −h(tj−1)] −SRS(τj) =

f(sj) −f(sj,nj)

·[h(tj) −Ah(tj−1)

+
nj−1
X
i=1

f(sj,i+1) −f(sji)

·

h(tji) −h(tj−1)

.
The ﬁrst product on the right side has the same bound as in (2.15) by
(2.13). Applying the preceding representations for each j = 1, . . . , m, using
the bounds (2.15) and (2.11) with h instead of f, we get the bound
SRS(τ) −SRS(∪jτj)
 ≤4ǫ max{∥f∥sup, ∥h∥sup} + 2ǫwB(f; [a, b]).
As in the ﬁrst part of the proof the integral (RRS) ∫b
a f·dh exists, proving the
theorem.
2

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
29
2.3 The Reﬁnement Young–Stieltjes and Kolmogorov
Integrals
Let f : [a, b] →X and h ∈R([a, b]; Y ). Recall from Section 1.4 that for a point
partition {ti}n
i=0 of [a, b] with a < b, a tagged partition ({ti}n
i=0, {si}n
i=1) is
called a Young tagged point partition if ti−1 < si < ti for each i = 1, . . . , n.
Given a Young tagged point partition τ = ({ti}n
i=0, {si}n
i=1), deﬁne the
Young–Stieltjes sum SYS(f, dh; τ) based on τ by, recalling the deﬁnition (2.1),
SYS(f, dh; τ)
:=
n
X
i=0
 f·∆±
[a,b]h

(ti) +
n
X
i=1
f(si)·

h(ti−) −h(ti−1+)

(2.16)
=
n
X
i=1
n
[f·∆+h](ti−1) + f(si)·

h(ti−) −h(ti−1+)

+ [f·∆−h](ti)
o
.
The reﬁnement Young–Stieltjes or RYS integral (RYS) ∫b
a f·dh is deﬁned as
0 if a = b or as
(RYS)
Z b
a
f·dh := lim
τ SYS(f, dh; τ)
if a < b, provided the limit exists in the reﬁnement sense. The integral
(RYS)
R b
a df·h is deﬁned, if it exists, via (1.15).
Proposition 2.18. Let f : [a, b] →X and h ∈R([a, b]; Y ). If a < b, given
a Young tagged point partition τ = (κ, ξ) of [a, b], the Young–Stieltjes sum
SYS(f, dh; τ) can be approximated arbitrarily closely by Riemann–Stieltjes
sums SRS(f, dh; ˜τ) based on tagged reﬁnements ˜τ of κ such that all tags ξ
of τ are tags of ˜τ. Thus, if (RRS) ∫b
a f·dh exists then so does (RYS) ∫b
a f·dh,
and the two are equal.
Proof. The last conclusion holds if a = b with both integrals deﬁned as 0, so
let a < b. For a Young tagged point partition τ = (κ, ξ) = ({xi}n
i=0, {yi}n
i=1)
of [a, b], take a set µ = {ui−1, vi}n
i=1 ⊂(a, b) such that x0 < u0 < y1 <
v1 < x1 < · · · < xn−1 < un−1 < yn < vn < xn. Let ˜τ := (κ ∪µ, κ ∪ξ),
where each xi, i = 1, . . . , n, is the tag for both [vi, xi] and [xi, ui]. For i =
1, . . . , n, letting ui−1 ↓xi−1 and vi ↑xi, it follows that the Riemann–Stieltjes
sums SRS(f, dh; ˜τ) converge to the Young–Stieltjes sum SYS(f, dh; τ) and the
conclusions follow.
2
Example 2.19. As in Example 2.14, for a < c < b, let ℓc be the indica-
tor function of [c, b] and let f be a real-valued function, both on [a, b]. For
each Young tagged point partition τ = (κ, ξ) such that c ∈κ, we have
SYS(f, dℓc; τ) = f(c). Therefore the integral (RYS) ∫b
a f dℓc exists and has

30
2 Extended Riemann–Stieltjes Integrals
value f(c). In particular, (RYS) ∫b
a ℓc dℓc exists and has value 1, while the
RRS integral does not exist, as shown in Example 2.14. More generally, for
any real number r, let ℓr
c(x) := ℓc(x) for x ̸= c and ℓr
c(c) := r, so that ℓ1
c ≡ℓc.
Then (RYS) ∫b
a f dℓr
c exists and has value f(c) for any r.
In fact, the RYS integral ∫b
a f dh does not depend on the values of the
integrator h at its jump points in (a, b). This is because the value of the
Young–Stieltjes sum (2.16) does not depend on the values of h at jump points
in the open interval (a, b). The same is not true for the RRS integral. Indeed,
by changing the value of the integrator h at a jump point t of both f and
h one can make h discontinuous from the left or right at t and so destroy
the necessary condition of Proposition 2.15. The RS integral, like the RYS
integral, does not depend on values of the integrator at its discontinuity points.
This holds because the RS integral is deﬁned only under restrictive conditions.
Speciﬁcally, by Proposition 2.15, if (RS) ∫b
a f dh exists and h has a jump at
t ∈(a, b) then f must be continuous at t. For u ∈R, let hu := h on [a, t)∪(t, b]
and hu(t) := u. Then for two Riemann–Stieltjes sums we have
SRS(f, dh; (κ, ξ)) −SRS(f, dhu; (κ, ξ)) =
 [f(s′) −f(s′′)]·[h(t) −u] if t ∈κ,
0
if t ̸∈κ,
where s′ ∈[t −δ, t] and s′′ ∈[t, t + δ] for δ := |κ|. Due to continuity of f at t
the preceding diﬀerence can be made arbitrarily small if the mesh |κ| is small
enough.
Theorem 2.20. Assuming (1.14), if f or h is of bounded semivariation and
the other is regulated, then (RYS) ∫b
a f·dh exists.
Proof. We can assume a < b. First suppose that h has bounded semivariation
on [a, b]. Given ǫ > 0, by statement (b) of Theorem 2.1, there exists a partition
λ = {zl}k
l=0 of [a, b] such that
Osc(f; (zl−1, zl)) < ǫ
for l = 1, . . . , k.
(2.17)
Let τ = ({tj}m
j=0, {sj}m
j=1) be a Young tagged point partition which is a
reﬁnement of λ. For each j = 1, . . . , m, let τj = ({tji}nj
i=0, {sji}nj
i=1) be a Young
tagged point partition of [tj−1, tj]. Then ∪jτj is a Young tagged reﬁnement
of τ and
SYS(f, dh; τ) −SYS(f, dh; ∪jτj)
= Pm
j=1
n
nj
X
i=1
[f(sj) −f(sji)] · [h(tji−) −h(tj,i−1+)]
+
nj−1
X
i=1
[f(sj) −f(tji)] · [h(tji+) −h(tji−)]
o
.
Let tj,i−1 < vj,2i−1 < vj,2i < tji for i = 1, . . . , nj and j = 1, . . . , m. Consider
sums

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
31
2nj
X
r=2
xj,r · [h(vr) −h(vr−1)],
where xj,2i = f(sj) −f(sji) and xj,2i+1 = f(sj) −f(tji) for i = 1, . . . , nj
except that for i = nj, xj,2i+1 = 0. Letting vj,2i−1 ↓tj,i−1 and vj,2i ↑tji, by
(2.17), we get the bound
SYS(f, dh; τ) −SYS(f, dh; ∪jτj)
 < 2ǫwB(h; [a, b]).
Given any two Young tagged point partitions τ1 and τ2 of [a, b], there exists
a Young tagged reﬁnement τ3 of both and
∥SYS(τ1) −SYS(τ2)∥≤∥SYS(τ1) −SYS(τ3)∥+ ∥SYS(τ3) −SYS(τ2)∥.
Thus by the Cauchy test under reﬁnement, (RYS) ∫b
a f·dh exists.
Now suppose that f has bounded semivariation and h is regulated. With
the same notation for Young tagged point partitions τ and τj, j = 1, . . . , m,
we have
SYS(f, dh; τ) −SYS(f, dh; ∪jτj)
=
m
X
j=1
[f(sj) −f(sj1)] · [h(tj−) −h(tj−1+)] +
m
X
j=1
dj,
where for each j = 1, . . . , m,
dj := (f·∆+h)(tj−1) + f(sj1)·[h(tj−) −h(tj−1+)] + (f·∆−h)(tj)
−SYS(f, dh; τj)
= f(sj1)·[h(tj−) −h(tj−1+)] −f(sj,nj)·h(tj−) + f(sj1)·h(tj−1+)
+
nj−1
X
i=1
n
[f(tji) −f(sji)]·h(tji−) + [f(sj,i+1) −f(tji)]·h(tji+)
o
=
nj−1
X
i=1
n
[f(tji) −f(sji)]·[h(tji−) −h(tj−)]
+[f(sj,i+1) −f(tji)]·[h(tji+) −h(tj−)]
o
.
By Theorem 2.1(b), given ǫ > 0 one can choose a partition λ = {zl}k
l=1 of
[a, b] such that (2.17) with h instead of f holds. If the Young tagged point
partition τ is a reﬁnement of λ, then by approximations as in the ﬁrst half of
the proof, we get the bound
SYS(f, dh; τ) −SYS(f, dh; ∪jτj)
 < 3ǫwB(f; [a, b]).
As in the ﬁrst part of the proof the integral (RYS) ∫b
a f·dh exists by the Cauchy
test under reﬁnement, proving the theorem.
2

32
2 Extended Riemann–Stieltjes Integrals
The Kolmogorov integral
Let f be an X-valued function on a nonempty interval J, which may be
a singleton, and let µ be a Y -valued interval function on J. For a tagged
interval partition T = ({Ai}n
i=1, {si}n
i=1) of J, deﬁne the Kolmogorov sum
SK(J, T ) = SK(f, dµ; J, T ) based on T by
SK(f, dµ; J, T ) :=
n
X
i=1
f(si)·µ(Ai).
(2.18)
For an additive interval function µ on J and an interval A ⊂J, the Kolmogorov
integral
R
=A f·dµ is deﬁned as 0 if A = ∅, or if A is nonempty, as the limit
R
=
A
f·dµ := lim
T SK(f, dµ; A, T )
if it exists in the reﬁnement sense, that is,
R
=A f·dµ = z ∈Z if for every ǫ > 0
there is an interval partition B of A such that for every reﬁnement A of B
and every tagged interval partition T = (A, ξ), ∥SK(f, dµ; A, T ) −z∥< ǫ.
Integrals of the form
R
=A dν·h are deﬁned, if they exist, via (1.16).
If A = {a} = [a, a] is a singleton then ({a}, {a}) is the only tagged interval
partition of A, and so the Kolmogorov integral
R
=A f·dµ always exists and
equals f(a)·µ({a}). Note that the Kolmogorov integral over a singleton need
not be 0, whereas for the integrals with respect to point functions considered
in this chapter, such integrals are 0.
Theorem 2.21. Let f be an X-valued function on a nonempty interval J,
and let µ be a Y -valued additive interval function on J. For A, A1, A2 ∈I(J)
such that A = A1 ∪A2 and A1 ∩A2 = ∅,
R
=A f·dµ exists if and only if both
R
=A1 f·dµ and
R
=A2 f·dµ exist, and then
R
=
A
f·dµ =
R
=
A1
f·dµ +
R
=
A2
f·dµ.
(2.19)
In particular, if the integral
R
=J f·dµ is deﬁned, then I(J) ∋A 7→
R
=A f·dµ is
a Z-valued additive interval function on J.
Proof. We can assume that A1 and A2 are nonempty. Let
R
=A f·dµ be deﬁned
for a given A ∈I(J) and let B be a nonempty subinterval of A. To show that
R
=B f·dµ is deﬁned we use the Cauchy test. Given any two tagged interval
partitions T1, T2 of B, let T ′
1, T ′
2 be extensions of T1, T2, respectively, to
tagged interval partitions of A having the same subintervals of A\B and tags
for them. Then
SK(B, T1) −SK(B, T2) = SK(A, T ′
1) −SK(A, T ′
2).
By assumption, the norm of the right side is small if T ′
1 and T ′
2 are both
reﬁnements of a suitable partition B of A. Taking the trace BB of B on B,

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
33
it follows that the norm of the left side is small for tagged interval partitions
T1, T2 which are reﬁnements of BB. Thus the integral ∫=B f·dµ exists by the
Cauchy test.
Let A, A1, A2 ∈I(J) be such that A = A1∪A2 and A1∩A2 = ∅. Let T1 and
T2 be tagged interval partitions of A1 and A2, respectively. Then T := T1 ∪T2
is a tagged interval partition of A and
SK(A, T ) = SK(A1, T1) + SK(A2, T2).
Thus if the two integrals on the right side of (2.19) exist then the integral on
the left side exists, and the equality holds. The converse follows from the ﬁrst
part of the proof, proving the theorem.
2
The following shows that the interval function
R
=A f·dµ, A ∈I(J), is
upper continuous if f is bounded and µ is upper continuous in addition to the
assumptions of the preceding theorem.
Proposition 2.22. Let f be a bounded X-valued function on a nonempty
interval J, and let µ be a Y -valued upper continuous additive interval function
on J. If the integral R=J f·dµ is deﬁned, then I(J) ∋A 7→R=A f·dµ is a Z-
valued upper continuous additive interval function on J.
Proof. The interval function
R
=A f·dµ, A ∈I(J), is additive by Theorem 2.21.
Let A1, A2, . . . ∈I(J) be such that An ↓∅, and let sn ∈An for each n. Since
f is bounded and µ is upper continuous, it is enough to prove that
Dn :=
R
=
An
f·dµ −f(sn)·µ(An) →0
as n →∞.
(2.20)
Let J = [[a, b]]. For some u ∈J and all suﬃciently large n, either An is left-
open at u ∈[[a, b) or An is right-open at u ∈(a, b]]. By symmetry consider only
the ﬁrst case. Let ǫ > 0. There exists a tagged interval partition T0 of (u, b]]
such that any two Kolmogorov sums based on tagged reﬁnements of T0 diﬀer
by at most ǫ. Let n0 be such that An0 is a subset of the ﬁrst interval in T0, and
let n ≥n0. Choose a Kolmogorov sum based on a tagged interval partition
T ′
n of An within ǫ of
R
=An f·dµ. Let T1 and T2 be two tagged reﬁnements of T0
which coincide with T ′
n and (An, {sn}), respectively, when restricted to An,
and are equal outside of An. Then the norm of Dn does not exceed

R
=
An
f· dµ −SK(An, T ′
n)
 +
SK((u, b]], T1) −SK((u, b]], T2)
 ≤2ǫ.
Since this is true for each n ≥n0, (2.20) holds, proving the proposition.
2
The following is a consequence of Proposition 2.6 and the preceding propo-
sition.

34
2 Extended Riemann–Stieltjes Integrals
Corollary 2.23. Let f be a bounded X-valued function on an interval J :=
[[a, b]] with a < b, and let µ be a Y -valued upper continuous additive interval
function on J. If the integral
R
=J f·dµ is deﬁned, then for each u, v ∈J such
that u < v,
lim
t↑v
R
=
[[a,t]]
f·dµ =
R
=[[a,v) f·dµ,
limt↓u
R
=[[a,t]] f·dµ =
R
=
[[a,u]
f·dµ,
lim
t↓u
R
=
[[t,b]]
f·dµ =
R
=(u,b]] f·dµ,
limt↑v
R
=[[t,b]] f·dµ =
R
=
[v,b]]
f·dµ.
Next we show that in deﬁning the Kolmogorov integral ∫=J f·dµ with re-
spect to an upper continuous additive interval function µ it is enough to take
partitions consisting of intervals in Ios(J) (open intervals and singletons). We
can assume that J is nondegenerate. First consider a closed interval J = [a, b]
with a < b. For a point partition {ti}n
i=0 of [a, b], the collection
n
{t0}, (t0, t1), {t1}, (t1, t2), . . . , (tn−1, tn), {tn}
o
(2.21)
of subintervals of [a, b] is called the Young interval partition of [a, b] associated
to {ti}n
i=0. A tagged Young interval partition of [a, b] is a set (2.21) together
with the tags t0, s1, t1, s2, . . . , sn, tn, where ti−1 < si < ti for i = 1, . . . , n.
For notational simplicity the tagged Young interval partition will be denoted
by ({(ti−1, ti)}n
i=1, {si}n
i=1).
Now a Young interval partition of any nonempty interval J is any interval
partition consisting of singletons and open intervals. For a closed interval this
coincides with the previous deﬁnition. A tagged Young interval partition of any
interval J will be a Young interval partition together with a member (tag)
of each interval in the partition. A tagged Young interval partition of any
nondegenerate interval is given by specifying the open intervals in it and their
tags, just as when the interval is closed. Let {ti}n
i=0 be a partition of [u, v]
with u < v, so that u = t0 < t1 < · · · < tn = v. Then the associated Young
interval partition of [[u, v]] is the set (2.21) if [[u, v]] = [u, v], or is the set (2.21)
except for the left and/or right singletons {u} or {v} respectively if [[u, v]] is
a left and/or right open interval. Given a Young interval partition (2.21) of
[a, b] and any subinterval [[u, v]] of [a, b], the trace Young interval partition of
[[u, v]] is the one formed by nonempty intervals obtained by intersecting each
subinterval in (2.21) with (u, v) and adjoining the endpoints {u} and/or {v}
if [[u, v]] is a left and/or right closed interval.
Let J = [[a, b]] with a < b, let f be an X-valued function on J, and let µ
be a Y -valued additive interval function on J. For a tagged Young interval
partition T = ({(ti−1, ti)}n
i=1, {si}n
i=1) of J, let
SYS(f, dµ; J, T ) := SK(f, dµ; J, T )
(2.22)
=
n
X
i=1
f(si)·µ((ti−1, ti)) +
n
X
i=0
f(ti)·µ({ti} ∩J).

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
35
Assuming that µ is upper continuous, this sum can be approximated by
Riemann–Stieltjes sums as follows. Let h := Rµ,a be the function deﬁned
by (2.3) and let {ui−1, vi}n
i=1 ⊂(a, b) be such that t0 < u0 < s1 < v1 <
t1 < · · · < tn−1 < un−1 < sn < vn < tn. Letting κ := J ∩{ti}n
i=0,
τ := (κ ∪{ui−1, vi}n
i=1, κ ∪{si}n
i=1) is a tagged partition of [c, d] ⊂J, where
c = a if a ∈J, or c = u0 otherwise, and d = b if b ∈J, or d = vn other-
wise, and each ti for i = 1, . . . , n −1 is the tag both for [vi, ti] and for [ti, ui].
Next, as in the proof of Proposition 2.18, letting ui−1 ↓ti−1 and vi ↑ti
for each i = 1, . . . , n, the Riemann–Stieltjes sum SRS(f, dh; τ) converges to
SYS(f, dµ; J, T ). Thus we have proved the following:
Lemma 2.24. For f, µ, h, J and T as above, the sum SYS(f, dµ; J, T ) can be
approximated arbitrary closely by Riemann–Stieltjes sums SRS(f, dh; τ) based
on tagged partitions τ of subintervals of J such that all tags of T are tags
of τ.
Recall that the class of all Y -valued additive and upper continuous interval
functions on a nonempty interval J is denoted by AI(J; Y ). Now we can show
that in deﬁning the Kolmogorov integral with respect to an additive upper
continuous interval function it is enough to take Young interval partitions.
Proposition 2.25. Let J be a nondegenerate interval, let µ ∈AI(J; Y ),
and let f : J →X. The integral R=J f·dµ is deﬁned if and only if the limit
limT SYS(f, dµ; J, T ) exists in the reﬁnement sense, and then the integral
equals the limit.
Proof. It is enough to prove the “if” part. Let J = [a, b] and let ǫ > 0. Then
there are a z ∈Z and a Young interval partition B of [a, b] such that for
any Young interval partition Y which is a reﬁnement of B and any tagged
Young interval partition T = (Y, ξ), ∥z −SYS(f, dµ; J, T )∥< ǫ. Let A be a
reﬁnement of B consisting of arbitrary subintervals of [a, b]. Let {ui}n
i=0 and
{vj}m
j=0 be the sets of endpoints of intervals in A and B, respectively. For
each i ∈{0, . . ., n} deﬁne a sequence {tik}k≥1 as follows. If {ui} is a singleton
in A then let tik := ui for all k. If an interval [[·, ui] is in A let tik ↓ui,
or if some [ui, ·]] ∈A let tik ↑ui, where in either case tik are not atoms of
µ. This can be done by statement (c) of Proposition 2.6. For k large enough,
a = t0k < t1k < · · · < tnk = b. Then there is a unique Young interval partition
Yk of [a, b] associated to {tik}n
i=0. Since each singleton {vj} equals {ui} ∈A
for some i, Yk is a reﬁnement of B. The intervals in Yk converge to the intervals
in A as k →∞, except for singletons in Yk which are not atoms of µ, and
hence do not contribute to sums. Let η be a set of tags for A. Then each tag
s of η is eventually in the interval of Yk corresponding to the interval of A
containing s. For such k, to form a set ηk of tags for Yk, take η and adjoin to
it, for each i (if any exist) with {ui} /∈A, a tik with µ({tik}) = 0.
Thus there are Young–Stieltjes sums SYS(f, dµ; J, (Yk, ηk)) converging to
SK(f, dµ; J, (A, η)), proving the theorem in the case J = [a, b]. If J = (a, b]]

36
2 Extended Riemann–Stieltjes Integrals
and/or J = [[a, b) then the proof is the same except that in the ﬁrst case,
(u0, c]] ∈A for some c and we deﬁne t0k := u0 = a for all k, while in the
second case, [[d, un) ∈A for some d and we deﬁne tnk := un = b for all k. The
proof of Proposition 2.25 is complete.
2
For the next statement recall that Rµ,a is deﬁned by (2.3).
Corollary 2.26. Let J = [[a, b]] with a < b, let µ ∈AI(J; Y ), let h := Rµ,a,
and let f : J →X. Also for each t ∈[a, b], let
˜h(t) :=



h(t)
if t ∈J,
h(a+) if t = a ̸∈J,
h(b−) if t = b ̸∈J,
and
˜f(t) :=



f(t) if t ∈J,
0
if t = a ̸∈J,
0
if t = b ̸∈J.
(2.23)
Then
R
=J f·dµ = (RYS) ∫b
a ˜f·d˜h if either side is deﬁned.
Proof. By Proposition 2.6(f), h is regulated, and so ˜h is well deﬁned. By
Theorem 2.8(b), µ = µh deﬁned by (2.2). Since there is a one-to-one cor-
respondence between tagged Young partitions τ of [a, b] and tagged Young
interval partitions T of J with SYS( ˜f, d˜h; τ) = SYS(f, dµh; J, T ), the conclu-
sion follows by Proposition 2.25.
2
Given a regulated function h on [a, b], by Theorem 2.7 there is an additive,
upper continuous interval function µh := µh,[a,b] corresponding to h deﬁned
by (2.2) if a < b or as 0 if a = b. Let
bR
=
a
f·dh :=
R
=
[a,b]
f·dµh,[a,b],
(2.24)
provided the Kolmogorov integral is deﬁned.
Proposition 2.27. Let h be a Y -valued regulated function on [a, b], and let
f : [a, b] →X. Then
R
=b
a f·dh = (RYS) ∫b
a f·dh if either side is deﬁned.
Proof. We can assume that a < b. Since there is a one-to-one correspondence
between tagged Young partitions τ and tagged Young interval partitions T
with SYS(f, dh; τ) = SYS(f, dµh; [a, b], T ), the conclusion again follows by
Proposition 2.25.
2
In the special case that the interval function µ is a Borel measure on
[a, b], we will show that the Kolmogorov integral R=[a,b] f dµ agrees with the
Lebesgue integral ∫[a,b] f dµ whenever both are deﬁned.

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
37
Proposition 2.28. Let µ be a ﬁnite positive measure on the Borel sets
of [a, b], and let f be a real-valued µ-measurable function on [a, b]. Then
R
=[a,b] f dµ = ∫[a,b] f dµ whenever both integrals exist.
Proof. We can assume that a < b. Suppose that the two integrals exist and let
ǫ > 0. Since µ is an additive and upper continuous interval function on [a, b],
by Proposition 2.25, there is a Young interval partition λ of [a, b] such that if
({(ti−1, ti)}n
i=1, {si}n
i=1) is a tagged Young partition which is a reﬁnement of
λ, then

n
X
i=0
f(ti)µ(Ti) +
n
X
i=1
f(si)µ(Tn+i) −
R
=
[a,b]
f dµ
 < ǫ,
(2.25)
where Ti := {ti} for i = 0, . . . , n and Tn+i := (ti−1, ti) for i = 1, . . . , n. Then
{T0, . . . , T2n} is a decomposition of [a, b] into disjoint measurable sets. For
i = 1, . . . , n, let mi := inf{f(s): s ∈Tn+i} and Mi := sup{f(s): s ∈Tn+i}.
Letting f(si) ↓mi and f(si) ↑Mi in (2.25) for each i = 1, . . . , n, we get that
(2.25) holds with each f(si) replaced by mi, or each f(si) replaced by Mi.
Therefore, it follows that
−ǫ ≤
n
X
i=0
f(ti)µ(Ti) +
n
X
i=1
miµ(Tn+i) −
R
=
[a,b]
f dµ
≤
Z
[a,b]
f dµ −R=
[a,b]
f dµ
≤
n
X
i=0
f(ti)µ(Ti) +
n
X
i=1
Miµ(Tn+i) −R=
[a,b]
f dµ ≤ǫ.
Since ǫ is arbitrary, ∫b
a f dµ =
R
=[a,b] f dµ. The proof of Proposition 2.28 is
complete.
2
Corollary 2.29. For a regulated real-valued function f on [a, b] and a real-
valued function h on [a, b], right-continuous on [a, b), if (LS) ∫b
a f dh exists
then so does
R
=
b
a f dh and the two integrals are equal.
Proof. We can assume that a < b. Since (LS) ∫b
a f dh exists, h is of bounded
variation, and so h = h+ −h−, where h+ and h−are nondecreasing. By
Theorem 2.20, (RYS) ∫b
a f dh+ and (RYS) ∫b
a f dh−exist. Thus by Proposi-
tion 2.27, R=b
a f dh+ and R=b
a f dh−exist. Since h is right-continuous at a,
µh,[a,b]({a}) = 0. The conclusion then follows from (2.24), the obvious lin-
earity of h 7→µh (Theorem 2.7), and Proposition 2.28.
2
The following is a change of variables theorem for Kolmogorov integrals.

38
2 Extended Riemann–Stieltjes Integrals
Proposition 2.30. For an interval J, let θ be a strictly increasing or strictly
decreasing homeomorphism from an interval J onto θ(J). Let µ ∈I(θ(J); Y )
be additive and upper continuous, µθ(A) := µ(θ(A)) for A ∈I(J), and let
f : θ(J) →X. Then
R
=
θ(J)
f·dµ =
R
=
J
f◦θ·dµθ
if either side is deﬁned.
Proof. The statement follows from the one-to-one correspondence between
tagged interval partitions of J and θ(J), and equality of corresponding Kol-
mogorov sums.
2
The Bochner integral
Next we deﬁne the Bochner integral of a Banach-space-valued function with
respect to a measure and compare it to the Kolmogorov integral. Let S be a
nonempty set, A an algebra of subsets of S, and (X, ∥· ∥) a Banach space.
An A-simple function f : S →X will be a function f := Pn
i=1 xi1Ai for some
xi ∈X, Ai ∈A, and ﬁnite n. If µ is a subadditive function from A into [0, ∞],
f will be called µ-simple if µ(Ai) < ∞for each i.
To deﬁne the Bochner integral, for a µ-simple function f = Pn
i=1 xi1Ai
and A ∈S, let (Bo) ∫A f dµ := Pn
i=1 xiµ(Ai ∩A). It can be shown that
(Bo) ∫f dµ is well deﬁned for µ-simple functions, just as for real-valued func-
tions. If (X, d) is any metric space, then the function (x, y) 7→d(x, y) is jointly
continuous from X × X into [0, ∞). If (X, d) is separable, then d(·, ·) is also
jointly measurable for the Borel σ-algebra on each copy of X (e.g. [53, Propo-
sitions 2.1.4, 4.1.7]). If X is not separable, the joint measurability may fail
(e.g. [53, §4.1, problem 11]). If (S, S, µ) is a measure space and (X, ∥· ∥) is a
Banach space, then a µ-measurable function f from S into X will be called
µ-almost separably valued if there is a closed separable subspace Y of X such
that f −1(X \ Y ) is a µ-null set.
Deﬁnition 2.31. Let (S, S, µ) be a measure space and let X = (X, ∥· ∥) be
a Banach space. A function f : S →X will be called Bochner µ-integrable
if there exist a sequence of µ-simple functions {fk}k≥1 and a sequence of µ-
measurable real-valued functions gk ≥∥f −fk∥such that limk→∞
R
S gk dµ =
0.
Theorem 2.32. Let f : S →X be Bochner µ-integrable. Then
(a) f is µ-almost separably valued and measurable for the completion of µ;
(b) For each A ∈S the limit
lim
k→∞
Z
A
fk dµ
(2.26)
exists and does not depend on the choice of {fk} satisfying the deﬁnition.

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
39
Proof. (a): Let {fk}k≥1 and {gk}k≥1 be as in Deﬁnition 2.31. Taking a subse-
quence, we can assume that
R
gk dµ < 4−k for all k. Then there is a set B ∈S
with µ(B) = 0 such that for s /∈B, gk(s) →0, and so fk(s) →f(s). The set
of ﬁnite rational linear combinations of elements in the union of ranges of all
fk is countable, so its closure is a separable subspace of X, in which f(s) takes
values for s /∈B. Thus f is µ-almost separably valued and measurable for the
completion of µ, since each fk is µ-measurable, e.g. [53, Theorem 4.2.2]. Also,
lim
k→∞
Z
S
∥f −fk∥dµ = 0,
(2.27)
where the Lebesgue integrals are well deﬁned.
(b): For g and h µ-simple, and any measurable A ⊂S, ∥(Bo) ∫A[g−h] dµ∥≤
R
S ∥g −h∥dµ. It follows that that if the Bochner integral of f exists then the
limit (Bo)
R
A fk dµ exists and does not depend on the sequence of µ-simple
functions {fk} satisfying (2.27). So the theorem is proved.
2
If f is Bochner µ-integrable, the limit
(Bo)
Z
A
f dµ := lim
k→∞
Z
A
fk dµ
(2.28)
is called the Bochner integral with respect to µ of f over the set A ∈S.
Proposition 2.33. Let (S, S, µ) be a measure space and (X, ∥·∥) a separable
Banach space. Let f be a µ-measurable function from S into X. Then f is
Bochner µ-integrable if and only if ∫S ∥f∥dµ < ∞. Moreover, if f is Bochner
µ-integrable, then
(Bo)
Z
S
f dµ
 ≤
Z
S
f
 dµ.
(2.29)
Proof. Suppose that f is Bochner µ-integrable, and let {fk} be a sequence
of µ-simple functions satisfying Deﬁnition 2.31. By (2.27), for some k large
enough, we have ∫∥f −fk∥dµ < 1, and then ∫∥f∥dµ < 1 + ∫∥fk∥dµ < ∞.
Moreover, for each k, we have
(Bo)
Z
S
fdµ
 ≤
(Bo)
Z
S

f −fk

dµ
 +
Z
S
fk
 dµ.
Letting k →∞on the right side, the ﬁrst term tends to zero by (2.28) and
the second term tends to the right side of (2.29) by (2.27), proving (2.29).
For the converse implication, we can assume that ∫∥f∥dµ ≤1. Let {xj}∞
j=1
be a dense sequence in X. For k = 1, 2, . . ., let Ak := {s ∈S : ∥f(s)∥> 1/k}.
Then µ(Ak) ≤k < ∞. If s ̸∈Ak, set gk(s) := 0. If s ∈Ak, let gk(s) := xj
for the least j such that ∥xj −f(s)∥≤1/k. Then gk is measurable and
∥gk(s)∥≤2∥f(s)∥for all s ∈S, so ∫∥gk∥dµ ≤2. Also, ∥(gk −f)(s)∥≤1/k
for all s, so by dominated convergence, with

40
2 Extended Riemann–Stieltjes Integrals
∥(gk −f)(s)∥≤(1/k)1Ak(s) + 1Ac
k(s)∥f(s)∥≤∥f(s)∥
for all s, ∫∥gk −f∥dµ →0 as k →∞. Let hkr(s) := gk(s) if gk(s) = 0 or xj
for some j ≤r; otherwise let hkr(s) := 0. Then hkr is a µ-simple function and
∥hkr(s)∥≤∥gk(s)∥for all s, so by dominated convergence, ∫∥hkr−gk∥dµ →0
as r →∞. Let fk = hkr for r large enough so that ∫∥hkr −gk∥dµ < 1/k.
Then ∫∥fk −f∥dµ →0 as k →∞, so f is Bochner µ-integrable.
2
We show next that for a regulated function the Bochner and Kolmogorov
integrals both exist and are equal.
Proposition 2.34. Let X be a Banach space, f an X-valued regulated func-
tion on [a, b], and µ a ﬁnite positive measure on the Borel sets of [a, b]. Then
(Bo) ∫[a,b] f dµ and
R
=[a,b] f dµ both exist and are equal.
Proof. We can assume a < b. The range of f is separable, so we can assume
that X is separable. Since f is bounded by Corollary 2.2, the Bochner integral
(Bo) ∫b
a f dµ exists by Proposition 2.33. The Kolmogorov integral
R
=[a,b] f dµ
exists by Theorem 2.20, Corollaries 2.11 and 2.26, and Proposition 2.27 with
Y = Z = R and B(x, y) ≡yx, x ∈X, y ∈R. To show that the two integrals
are equal, let ǫk ↓0. By Theorem 2.1 and the deﬁnition of R=, there exists a
nested sequence {λk}k≥1 of Young interval partitions λk = {(tk
i−1, tk
i )}n(k)
i=1 of
[a, b] such that for each k ≥1, maxi Osc(f; (tk
i−1, tk
i )) < ǫk and for any tagged
Young partition τk = (λk, {si}n(k)
i=1 ),

R
=
[a,b]
f dµ −SYS(f, dµ; τk)
 < ǫk.
For each k ≥1, ﬁx a tagged partition τk and let
fk :=
n(k)
X
i=1
f(sk
i )1(tk
i−1,tk
i ) +
n(k)
X
i=0
f(tk
i )1{tk
i }.
(2.30)
Then for each k ≥1, fk is a µ-simple function, ∫[a,b] fk dµ = SYS(f, dµ; τk) and
∥f −fk∥sup < ǫk. Thus the two integrals are equal, proving the proposition.
2
We will need the following extension of Lebesgue’s diﬀerentiation theorem
to the indeﬁnite Bochner integral.
Theorem 2.35. Let λ be Lebesgue measure on [a, b] and let f : [a, b] →X be
Bochner λ-integrable. Then for λ-almost all t ∈(a, b),
lim
s→t
1
t −s
h
(Bo)
Z
[a,t]
f dλ −(Bo)
Z
[a,s]
f dλ
i
= f(t).

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
41
Proof. By (2.29), it is enough to prove that for λ-almost all t ∈(a, b),
lim
u↓0
1
u
Z
At
f −f(t)
 dλ = 0,
(2.31)
where At = [t −u, t] or At = [t, t + u]. By Theorem 2.32(a), f is λ-almost
separably valued. Let {xn} be a countable dense set in f([a, b] \ N) for some
λ-null set N ⊂[a, b]. By the Lebesgue diﬀerentiation theorem (e.g. Theorem
7.2.1 in Dudley [53]), we have
lim
u↓0
1
u
Z
At
f −xn
 dλ =
f(t) −xn

for almost all t ∈(a, b) and for all n. For any t /∈N such that this holds for
all n, it follows that
lim sup
u↓0
1
u
Z
At
f −f(t)
 dλ ≤lim sup
u↓0
1
u
Z
At
f −xn
 dλ + ∥xn −f(t)∥
= 2∥xn −f(t)∥
for all n. Given ǫ > 0, one can choose n such that ∥xn −f(t)∥< ǫ/2, proving
(2.31) for λ-almost all t ∈(a, b).
2
*The Bartle integral
Next we deﬁne the Bartle integral of a vector-valued function with respect to
an additive vector measure and compare it to the Kolmogorov integral. As
in the basic assumption (1.14), let X, Y , and Z be three Banach spaces and
B(·, ·): X × Y →Z, x·y = B(x, y), a bounded bilinear operator with norm
≤1. Let S be a nonempty set, let A be an algebra of subsets of S, and let µ
be a ﬁnitely additive function from A into Y . The semivariation of µ over a
set A ∈A is deﬁned by
w(µ; A) := wB(µ; A) := sup
n
X
i
xi·µ(Ai)

o
,
where the supremum is taken over all partitions {Ai} of A into ﬁnitely many
disjoint members of A and all ﬁnite sequences {xi} ⊂X satisfying ∥xi∥≤1.
As the notation wB(µ; A) indicates, the semivariation depends on the Banach
spaces X and Z and the bilinear operator B : (x, y) 7→x·y. We say that µ has
bounded semivariation if wB(µ) := wB(µ; S) < ∞. The variation of µ over a
set A ∈A is deﬁned by
v(µ; A) := sup
n X
i
∥µ(Ai)∥
o
,

42
2 Extended Riemann–Stieltjes Integrals
where the supremum is taken over all partitions {Ai} of A into ﬁnitely many
disjoint members of A. (The variation v(µ; A) does not depend on X, Z,
or B.) We say that µ has bounded variation if v(µ) := v(µ; S) < ∞. The
semivariation wB(µ; ·) is a monotone, subadditive function on A, while the
variation v(µ; ·) is a monotone, additive function on A. It is clear that if
A ∈A then 0 ≤wB(µ; A) ≤v(µ; A) ≤+∞. Also, if X = Y ′, Z = R, and
B(x, y) = x(y), then wB(µ) = v(µ). However, in general, it is possible that
wB(µ; ·) is not additive and that wB(µ; A) < ∞while v(µ; A) = +∞, as the
following examples show:
Example 2.36. (a) Let A be the algebra generated by subintervals of [0, 1],
and let λ be Lebesgue measure. Let µ be the extension to A of the additive
interval function of Example 2.4 having values in L∞([0, 1], λ), that is, for
A ∈A, µ(A) is the equivalence class containing 1A. Then µ is an additive
function from A to Z = Y = L∞. For a set A ∈A, a ﬁnite partition {Ai} of A
into ﬁnitely many disjoint sets in A and for any ﬁnite sequence {xi} ⊂X = R
of real numbers in [−1, 1], we have

X
i
xiµ(Ai)

∞=

X
i
xi1Ai

∞= max
i
|xi| ≤1.
Thus µ has bounded semivariation, with w(µ; A) = 1 for λ(A) > 0 and
w(µ; A) = 0 otherwise. Thus w(µ; ·) is not additive. Also, µ has unbounded
variation. Indeed, if A ∈A and λ(A) > 0, then one can take a countable par-
tition {Bi} of A into disjoint sets each with λ(Bi) > 0. Then for n > 1, the
sequence {Ai}n
i=1 deﬁned by A1 := B1, . . . , An−1 := Bn−1 and An := ∪k≥nBk
is a ﬁnite partition of A and
n
X
i=1
∥µ(Ai)∥∞=
n−1
X
i=1
∥1Bi∥∞+ ∥1∪k≥nBk∥∞= n.
Since n is arbitrary, v(µ; A) = +∞. It is easy to see that the extension to A
of the interval function µ of Example 2.4 with values in ℓ∞[0, 1] has the same
properties.
(b) Let H be a real Hilbert space, X = R, and Y = Z = L(H, H), the
Banach space of bounded linear operators from H into itself, with x·y := xy.
Let S be a set and A an algebra of subsets of S. Then a ﬁnitely additive
projection-valued measure will be a function from A into Y whose values are
orthogonal projections onto closed linear subspaces (which may be {0} or H)
such that if A and B in A are disjoint, then µ(A ∪B) = µ(A) + µ(B), where
µ(A) and µ(B) are projections onto orthogonal subspaces. It is easily seen that
w(µ; A) = 1 if µ(A) is a projection onto a non-zero subspace, since otherwise
w(µ; A) = 0. If ∥µ(Ai)∥= 1 for inﬁnitely many disjoint subsets Ai of a given
set A, then clearly v(µ; A) = +∞, so µ has unbounded variation.
Let µ be an additive Y -valued function on an algebra A of subsets of S. A
function will be called µ-simple if it is w(µ)-simple. It is convenient to deﬁne an

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
43
“outer” form of w(µ; ·) on all subsets of S as follows. If B ⊂S, then w⋆(µ; B)
is deﬁned to be the inﬁmum of w(µ; A) over all A ∈A such that B ⊂A. Then
w⋆(µ; ·) agrees with w(µ; ·) on A and w⋆(µ; ·) is a monotone and subadditive
function on the class of all subsets of S. We say that a subset B of S is a µ-null
set if w⋆(µ; B) = 0. Notice that this deﬁnition agrees with the one given in
the case when µ is a measure on a σ-algebra. The deﬁnition of a µ-essentially
bounded function (see Section 1.4) extends to the present case using the new
meaning of µ-null sets. A sequence of functions {fk}k≥1 from S to X will be
said to converge in outer µ-semivariation to a function f : S →X if for each
ǫ > 0, w⋆(µ; Bk) →0 as k →∞, where Bk := {x ∈S : ∥fk(x) −f(x)∥> ǫ}.
For a µ-simple function f = Pn
i=1 xi1Ai for some n < ∞, xi ∈X, and Ai ∈S,
the indeﬁnite integral I(f, dµ) is deﬁned by
I(f, dµ)(A) :=
Z
A
f·dµ :=
n
X
i=1
xi·µ(A ∩Ai)
for each A ∈S. The indeﬁnite integral of a µ-simple function is independent
of the representation in its deﬁnition.
The following deﬁnition is due to Bartle [11, Deﬁnition 1].
Deﬁnition 2.37. Assuming (1.14), let A be an algebra of subsets of S and
let µ: A →Y be an additive function. A function f : S →X is called Bartle
µ-integrable over S if there is a sequence {fk}k≥1 of µ-simple functions from
S to X satisfying the following conditions:
(a) the sequence {fk} converges in outer µ-semivariation to f;
(b) the sequence {I(fk, dµ)} of indeﬁnite integrals has the property that for
any ǫ > 0 there is a δ > 0 such that if A ∈A and w(µ; A) < δ, then
∥I(fk, dµ)(A)∥< ǫ for all k ≥1;
(c) given ǫ > 0 there is a set Aǫ ∈A with w(µ; Aǫ) < ∞and such that if
B ∈A and B ⊂S \ Aǫ then ∥I(fk, dµ)(B)∥< ǫ for all k ≥1.
We show next that uniformly for A ∈A, the sequence {I(fk, dµ)(A)}k≥1
converges to a well-deﬁned limit
(Ba)
Z
A
f·dµ := lim
k→∞I(fk, dµ)(A),
which will be called the Bartle integral of f over the set A.
Proposition 2.38. If f is Bartle µ-integrable then for each A ∈A the se-
quence of indeﬁnite integrals {I(fk, dµ)(A)}k≥1 in condition (b) converges in
the norm of Z uniformly for A ∈A and the limit does not depend on the
sequence of µ-simple functions {fk}k≥1 satisfying the conditions of Deﬁnition
2.37.
Proof. If w(µ, ·) ≡0, then I(fk, dµ) ≡0 and the conclusion holds. Assume
that w(µ, ·) ̸≡0. Let {fk} be a sequence of µ-simple functions satisfying the

44
2 Extended Riemann–Stieltjes Integrals
conditions of Deﬁnition 2.37 and let ǫ > 0. Take δ as in condition (b) and
Aǫ ∈A with w(µ; Aǫ) ̸= 0 as in (c). By condition (a) there is a positive
integer Kǫ such that w(µ; Un,m) < δ for each n, m ≥Kǫ, where Un,m ∈A
and Un,m ⊃{x ∈S : ∥fm(x) −fn(x)∥> (ǫ/w(µ; Aǫ))}. Let A ∈A and let
n, m ≥Kǫ. Then we have

R
A fn·dµ −
Z
A
fm·dµ

= ∥I(fn −fm, dµ)(A)∥
≤∥I(fn −fm, dµ)(A ∩Un,m)∥+ ∥I(fn −fm, dµ)(A ∩U c
n,m ∩Ac
ǫ)∥
+∥I(fn −fm, dµ)(A ∩U c
n,m ∩Aǫ)∥
≤2ǫ + 2ǫ + (ǫ/w(µ; Aǫ))w(µ; A ∩U c
n,m ∩Aǫ) ≤5ǫ.
This proves the existence and the uniformity of the limit.
To prove the second part of the conclusion, let {fk}, {gk} be two sequences
of µ-simple functions satisfying the conditions of Deﬁnition 2.37, and let ǫ > 0.
We can and do assume that for each k ≥1, fk and gk have constant values
on the same sets, that is for some partition {Ak
i } of S, fk = P
i xk
i 1Ak
i and
gk = P
i yk
i 1Ak
i . For the two sequences {fk}, {gk}, take the minimum of two
values of δ as in condition (b) and the union of two sets Aǫ with w(µ; Aǫ) ̸= 0 as
in (c). By condition (a), there is an integer Kǫ > 0 such that w(µ; Uk) < δ for
each k ≥Kǫ, where Uk ∈A and Uk ⊃{x ∈S : ∥fk(x)−gk(x)∥> ǫ/w(µ; Aǫ)}.
Let A ∈A. Then for each k ≥Kǫ,

R
A fk·dµ −
Z
A
gk·dµ

= ∥I(fk −gk, dµ)(A)∥
≤∥I(fk −gk, dµ)(A ∩Uk)∥+ ∥I(fk −gk, dµ)(A ∩U c
k ∩Ac
ǫ)∥
+∥I(fk −gk, dµ)(A ∩U c
k ∩Aǫ)∥
≤2ǫ + 2ǫ + (ǫ/w(µ; Aǫ))w(µ; A ∩U c
k ∩Aǫ) ≤5ǫ.
This proves the second part of the conclusion of Proposition 2.38.
2
For the vector measure µ of Example 2.36(a) with values in L∞([0, 1], λ),
a function f : [0, 1] →R is Bartle µ-integrable if and only if there exists a
sequence {fk}k≥1 of real-valued and µ-simple functions on [0, 1] such that
∥fk −f∥∞→0 as k →∞. Indeed, if fk are µ-simple functions satisfying
condition (a) of Deﬁnition 2.37, then for A ∈A, ∫A fk dµ = fk1A. Thus if f
is Bartle µ-integrable then by the preceding proposition, (Ba) ∫A f dµ = f1A
and ∥fk −f∥∞→0 as k →∞, since w(µ; A) = 0 implies λ(A) = 0. The
converse is clear by checking the conditions of Deﬁnition 2.37.
If µ is the vector measure A 7→1A as in Example 2.36(a) but with values
in ℓ∞[0, 1], then a function f : [0, 1] →R is Bartle µ-integrable if and only if

2.3 The Reﬁnement Young–Stieltjes and Kolmogorov Integrals
45
f is regulated on [0, 1] as follows. The argument of the preceding paragraph
gives that f : [0, 1] →R is Bartle µ-integrable if and only if there exists a
sequence {fk}k≥1 of real-valued and µ-simple functions on [0, 1] such that
∥fk −f∥sup →0 as k →∞, since in the present case w(µ; A) = 0 implies that
A is empty. Moreover, each µ-simple function is a step function, and so f is
regulated on [0, 1] by Theorem 2.1.
Proposition 2.39. Let A be an algebra of subsets of a set S, and let µ be a
Y -valued additive function on A with bounded semivariation. If f : S →X is
µ-essentially bounded and there is a sequence of µ-simple functions converging
to f in outer µ-measure, then f is Bartle µ-integrable and
(Ba)
Z
S
f·dµ
 ≤∥f∥∞w(µ; S).
(2.32)
Proof. Let {fk}k≥1 be a sequence of µ-simple functions which converge to f
in outer µ-measure. Let ǫ > 0, let M := ∥f∥∞+ 2ǫ, and let N be a µ-null set
such that {x ∈S : ∥f(x)∥> ∥f∥∞+ ǫ} ⊂N. Then for each k ≥1,
{x ∈S : ∥fk(x)∥> M} ⊂{x ∈S : ∥fk(x) −f(x)∥> ǫ} ∪N.
(2.33)
For each k ≥1, let f M
k
:= fk1Ak, where Ak := {x ∈S : ∥fk(x)∥≤M}. Then
{x ∈S : ∥f M
k (x) −f(x)∥> ǫ}
⊂{x ∈S : ∥fk(x) −f(x)∥> ǫ} ∪{x ∈S : ∥fk(x)∥> M}.
Since w⋆(µ; ·) is monotone and subadditive, by (2.33) it then follows that con-
dition (a) of Deﬁnition 2.37 holds for the sequence {f M
k }k≥1 of µ-simple func-
tions. Since the norm of each value of each µ-simple function f M
k
is bounded
by M, it follows that for each k ≥1 and any A ∈A,
∥I(fk, dµ)(A)∥≤Mw(µ; A),
(2.34)
proving condition (b). Condition (c) holds trivially because w(µ; S) < ∞.
Therefore the function f is Bartle µ-integrable. The bound (2.32) follows from
(2.34) and Proposition 2.38 because ǫ is arbitrary. The proof of the proposition
is complete.
2
Each additive interval function µ: I[a, b] →Y extends to an additive
function ˜µ on the algebra A[a, b] generated by subintervals of [a, b]. We show
next that if ˜µ has bounded semivariation, then any regulated function on [a, b]
is Bartle µ-integrable and the Bartle integral agrees with the Kolmogorov
integral in this case.
Proposition 2.40. Assuming (1.14), let µ be a Y -valued additive interval
function on [a, b] such that ˜µ is of bounded semivariation, and let f be an X-
valued regulated function on [a, b]. Then (Ba) ∫[a,b] f·d˜µ and R=[a,b] f·dµ both
exist and are equal.

46
2 Extended Riemann–Stieltjes Integrals
Proof. By Theorem 2.1, f is bounded and is a uniform limit of step functions,
and so it is Bartle µ-integrable by Proposition 2.39. Let ǫk ↓0. By Theorem 2.1
once again, there exists a nested sequence {λk}k≥1 of Young partitions λk =
{Aki := (tk
i−1, tk
i )}n(k)
i=1 of [a, b] such that for each k ≥1, maxi Osc(f; Aki) < ǫk.
As in the proof of Proposition 2.34, for each k ≥1, ﬁx a tagged partition
τk = ({Aki}n(k)
i=1 , {sk
i }n(k)
i=1 ) and let fk be deﬁned by (2.30). Then for each k ≥1,
fk is a step function, ∫[a,b] fk d˜µ = SYS(f, dµ; τk), and ∥f −fk∥sup < ǫk. By
Proposition 2.38, we have
(Ba)
Z
[a,b]
f·d˜µ = lim
k→∞
Z
[a,b]
fk·d˜µ = lim
k→∞SYS(f, dµ; τk).
(2.35)
For any k ≥1 and any tagged reﬁnement τ = ({Aj}, {xj}) of τk, we have
SYS(f, dµ; τ) −SYS(f, dµ; τk)

=

n(k)
X
i=1
X
xj∈Aki

f(xj) −f(sk
i )

·µ(Aj)
 ≤ǫkw(˜µ; [a, b]).
Thus the Kolmogorov integral
R
=[a,b] f· dµ exists and equals the Bartle integral
(2.35), completing the proof.
2
2.4 Relations between RS, RRS, and RYS Integrals
By Propositions 2.13 and 2.18, we have
(RS)
Z b
a
f·dh −→(RRS)
Z b
a
f·dh
h∈R
−→(RYS)
Z b
a
f·dh.
(2.36)
Here −→means that existence of the integral to the left of it implies that
of the integral to the right of it, with the same value, and
h∈R
−→means that
the implication holds for h regulated. In this section we consider the question
under what conditions on f and h the two arrows in (2.36) can be inverted.
By Proposition 2.15, if the Riemann–Stieltjes integral exists then the in-
tegrand and integrator cannot have common discontinuities. This condition
is also suﬃcient for the ﬁrst arrow in (2.36) to be inverted (Theorem 2.42).
A necessary condition for the existence of the reﬁnement Riemann–Stieltjes
integral is that the integrand and integrator cannot have common one-sided
discontinuities. This condition is also suﬃcient if the integrand and integrator
satisfy suitable p-variation conditions, as we will show in Corollary 3.91. Thus
it is tempting to guess that the second arrow in (2.36) is invertible provided
f and h have no common one-sided discontinuities. However, Example 2.44

2.4 Relations between RS, RRS, and RYS Integrals
47
below shows that this is not true in general. We end this section with a re-
sult giving a general suﬃcient condition for the second arrow in (2.36) to be
invertible (Proposition 2.46).
The following deﬁnition of full Stieltjes integral deﬁnes it as the (RYS)
integral provided condition (b) holds.
Deﬁnition 2.41. Let f and h be regulated functions on [a, b] with values
in X and Y , respectively. We say that the full Stieltjes integral (S) ∫b
a f·dh
exists, or f is full Stieltjes integrable with respect to h over [a, b], if (a) and
(b) hold, where
(a) (RYS) ∫b
a f·dh exists,
(b) if f and h have no common one-sided discontinuities, then (RRS) ∫b
a f·dh
exists.
Then let (S) ∫b
a f·dh := (RYS) ∫b
a f·dh.
By (2.36), whenever the two integrals in (a) and (b) exist, they have the
same value. Next we prove a relation stated above between RS and RRS
integrals.
Theorem 2.42. Let f and h be bounded functions from [a, b] into X and Y
respectively. The integral (RS) ∫b
a f·dh exists if and only if both (RRS) ∫b
a f·dh
exists and f, h have no common discontinuities. Moreover, if the two integrals
exist then they are equal.
Proof. Propositions 2.15 and 2.13 imply the “only if” part. For the converse
implication suppose that the integral (RRS) ∫b
a f dh exists and the two func-
tions f, h have no common discontinuities. Given ǫ > 0, there exists a partition
λ = {zj}m
j=0 of [a, b] such that
SRS(f, dh; (κ, ξ)) −(RRS)
Z b
a
f dh
 < ǫ/2
(2.37)
for each tagged partition (κ, ξ) such that κ is a reﬁnement of λ. Then choose a
δ > 0 such that for each interval ∆j := [zj −δ, zj +δ]∩[a, b], j = 1, . . . , m−1,
Osc (f; ∆j) Osc(h; ∆j) < ǫ/(2m).
Let d := min1≤j≤m(zj −zj−1) and let τ = ({xi}n
i=0, {yi}n
i=1) be a tagged
partition with mesh |τ| < d ∧δ. Then each interval [xi−1, xi] contains at most
one point of λ. For j = 1, . . . , m−1, let i(j) be the index in {1, . . ., n−1} such
that zj ∈(xi(j)−1, xi(j)]. Let (κ, ξ) be the tagged partition of [a, b] obtained
from τ by replacing each tagged interval ([xi(j)−1, xi(j)], yi(j)), j = 1, . . . , m−1,
by the pair of tagged intervals ([xi(j)−1, zj], zj), ([zj, xi(j)], zj) if zj < xi(j), or
by the tagged interval ([xi(j)−1, xi(j)], zj) otherwise. Then κ is a reﬁnement of
λ and

48
2 Extended Riemann–Stieltjes Integrals
SRS(f, dh; τ) −SRS(f, dh; (κ, ξ))

≤
m−1
X
j=1
f(yi(j)) −f(zj)
 h(xi(j)) −h(xi(j)−1)
 < ǫ/2.
This in conjunction with (2.37) implies that (RS) ∫b
a f·dh exists and equals
(RRS) ∫b
a f·dh. The proof of Theorem 2.42 is complete.
2
In view of the preceding theorem the notion of the full Stieltjes integral
can be extended as follows:
Corollary 2.43. Let f and h be regulated functions on [a, b] with values in
X and Y , respectively. The full Stieltjes integral (S) ∫b
a f·dh exists if and only
if (a), (b) of Deﬁnition 2.41 and (c) hold, where
(c) if f and h have no common discontinuities, then (RS) ∫b
a f·dh exists.
Moreover, whenever two or more of the integrals in (a), (b), and (c) exist,
they have the same value.
The following shows that there are regulated functions f, h: [0, 1] →R
having no common discontinuities such that the integral ∫1
0 f dh exists and
equals 0 as a reﬁnement Young–Stieltjes integral but it does not exist as a
reﬁnement Riemann–Stieltjes integral.
Example 2.44. The functions f and h will be deﬁned on [0, 1] and equal to
0 everywhere outside countable disjoint subsets A and B, respectively. Let B
be the union of the sets {i/p: i = 1, . . . , p−1} over the prime numbers p ≥5,
p ∈{5, 7, 11, . . .}. Deﬁne the set A recursively along prime numbers p ≥5
by choosing irrational points ap,i in each interval ((i −1)/p, i/p), i = 1, . . . , p,
diﬀerent from all such points previously deﬁned. For each prime p ≥5, let
f(ap,2j) := h(2j/p) := 0 and f(ap,2j−1) := h((2j −1)/p) := 1/√p for j =
1, 2, . . . and 2j < p. The functions f and h each converge to 0 along any
1–1 enumeration of the sets A, B, respectively. Thus f and h are regulated
and have no common discontinuities. The integral (RYS) ∫1
0 f dh exists and
equals 0; in fact, all its approximating Young–Stieltjes sums equal 0. For
any partition of [0, 1] there are Riemann–Stieltjes sums which are 0. For the
partition κp := {i/p}p
i=0 of [0, 1], for each prime p ≥5, consider the Riemann–
Stieltjes sum
Sp :=
[p/2]−1
X
j=1
n
f(ap,2j−1)
h
h
2j −1
p

−h
2j −2
p
i
+f(ap,2j)
h
h
2j
p

−h
2j −1
p
io
= [p/2] −1
p
.
Since Sp →1/2 as p →∞, the Riemann–Stieltjes integral does not exist. The
reﬁnement Riemann–Stieltjes integral also does not exist by Theorem 2.42.

2.4 Relations between RS, RRS, and RYS Integrals
49
Lemma 2.45. For regulated functions f and h on [a, b] the following two
statements hold:
(1) If at each point of [a, b) at least one of f and h is right-continuous, then
the integral (RRS) ∫b
a f·dh exists whenever in its deﬁnition the Riemann–
Stieltjes sums converge for tagged partitions ({xi}n
i=0, {yi}n
i=1) with tags
yi ∈(xi−1, xi], i = 1, . . . , n.
(2) If at each point of (a, b], at least one of f and h is left-continuous, then
the integral (RRS) ∫b
a f·dh exists whenever in its deﬁnition the Riemann–
Stieltjes sums converge for tagged partitions ({xi}n
i=0, {yi}n
i=1) with tags
yi ∈[xi−1, xi), i = 1, . . . , n.
Proof. We prove only (1) because a proof of (2) is symmetric. Thus we have
that there is an A ∈Z with the following property: given ǫ > 0 there exists a
partition λ = {zj}m
j=0 of [a, b] such that
SRS(f, dh; (κ, ξ′)) −A
 < ǫ
(2.38)
for each tagged partition (κ, ξ′) = ({xi}n
i=0, {yi}n
i=1) such that κ is a reﬁne-
ment of λ and yi ∈(xi−1, xi] for i = 1, . . . , n. Choose a set ζ = {uj}m
j=1 ⊂(a, b)
such that zj−1 < uj < zj for j = 1, . . . , m and
max
1≤j≤m Osc (f; [zj−1, uj]) Osc (h; [zj−1, uj]) < ǫ/m.
(2.39)
Suppose that (κ, ξ) = ({xi}n
i=0, {yi}n
i=1) is a tagged partition of [a, b] such
that κ is a reﬁnement of λ ∪ζ. Deﬁne ξe := {ti}n
i=1 by ti := yi for i odd,
ti := xi for i even. Deﬁne ξo := {si}n
i=1 by si := yi for i even, si := xi for i
odd. Also, let ξr := {xi}n
i=1. Then letting S(ξ) := SRS(f, dh; (κ, ξ)), we have
S(ξ) + S(ξr) = S(ξe) + S(ξo). Thus
S(ξ) −A
 ≤
S(ξr) −A
 +
S(ξe) −A
 +
S(ξo) −A
.
(2.40)
By (2.38) with ξ′ = ξr, the ﬁrst term on the right does not exceed ǫ. If
each ti in ξe is not xi−1 then the same bound holds for the second term on
the right. Otherwise, let Ie be the set of indices i ∈{1, . . . , n} such that
xi−1 = yi = ti ∈ξe. Thus for each i ∈Ie, i must be odd, so ti−1 = xi−1 = ti.
Let J ⊂{0, . . ., n} be the set of indices i such that xi ∈λ. For i ∈Ie, if
i−1 ̸∈J then we can and do replace the two tagged intervals ([xi−2, xi−1], ti−1)
and ([xi−1, xi], ti) by the tagged interval ([xi−2, xi], xi−1) without changing
the Riemann–Stieltjes sum and where now the tag is in the interior of the
interval and the partition is still a reﬁnement of κ. For i ∈Ie, if i −1 ∈J
then if we replace ti (= xi−1) by xi, we change the sum by at most ǫ/m for
each i by (2.39), and since there are at most m such values of i, we change the
total sum by at most ǫ. Therefore it follows by (2.38) that ∥S(ξe) −A∥≤2ǫ.
Similarly one can show that the last term in (2.40) does not exceed 2ǫ, so
∥S(ξ) −A∥< 5ǫ. Since ǫ is arbitrary, the integral (RRS) ∫b
a f·dh exists and
equals A, proving the lemma.
2

50
2 Extended Riemann–Stieltjes Integrals
Proposition 2.46. Let regulated functions f, h on [a, b] be such that f is
left-continuous on (a, b] and h is right-continuous on [a, b), or vice versa. If
(RYS) ∫b
a f·dh exists then so does (RRS) ∫b
a f·dh, and the two integrals have
the same value.
Proof. We can assume that neither f nor h is identically 0, since if one is, the
conclusion holds. We prove the proposition when f is left-continuous on (a, b]
and h is right-continuous on [a, b). A proof of the other case is symmetric.
In that case by (1) of Lemma 2.45 and since f is left-continuous on (a, b],
it is enough to prove the convergence of Riemann–Stieltjes sums based on
Young tagged partitions of [a, b]. To this aim we show that diﬀerences between
Riemann–Stieltjes and Young–Stieltjes sums based on the same Young tagged
partition can be made arbitrarily small by reﬁnement of partitions. Let ǫ > 0.
By deﬁnition of the reﬁnement Young–Stieltjes integral there exists a partition
λ = {zj}m
j=0 of [a, b] such that
SYS(f, dh; τ) −(RYS)
Z b
a
f·dh
 < ǫ
(2.41)
for any Young tagged partition τ = (κ, ξ) such that κ is a reﬁnement of
λ. Choose a set ζ = {vj−1, uj : j = 1, . . . , m} ⊂(a, b) such that for each
j = 1, . . . , m, zj−1 < vj−1 < uj < zj,
max(∥h∥supOsc (f; [uj, zj]), ∥f∥supOsc (h; [zj−1, vj−1])) < ǫ/(2m).
(2.42)
Let (κ, ξ) = ({xi}n
i=0, {yi}n
i=1) be a Young tagged partition of [a, b] such that
κ is a reﬁnement of λ∪ζ. Then SRS(f, dh; (κ, ξ))−SYS(f, dh; (κ, ξ)) = S1+S2,
where
S1 :=
n
X
i=1

f(yi) −f(xi)

·

h(xi) −h(xi−1)

,
S2 :=
n
X
i=1

f(xi) −f(yi)

·

h(xi−) −h(xi−1)

.
(2.43)
Let ξ′ = {y′
i}n
i=1 be another set of tags for κ such that xi−1 < y′
i < xi for
i = 1, . . . , n. By (2.41) with τ = (κ, ξ) and τ = (κ, ξ′), we get the bound

n
X
i=1

f(y′
i) −f(yi)

·

h(xi−) −h(xi−1)
 < 2ǫ.
Letting y′
i ↑xi for i = 1, . . . , n, it follows that in (2.43), ∥S2∥≤2ǫ. Let J ⊂
{0, . . . , n} be the set of indices i such that xi ∈λ, and let I := {0, . . ., n} \ J.
To bound ∥S1∥deﬁne a partition κ′ = {x′
i}n
i=0 of [a, b] by x′
i := xi if i ∈J
and take any x′
i ∈(xi, yi+1) if i ∈I. Then κ′ is a reﬁnement of λ and (κ′, ξ)
is a Young tagged partition. Let ξ′ = {y′
i}n
i=1 be another set of tags for κ′

2.5 The Central Young Integral
51
deﬁned by y′
i := yi if i ∈J and y′
i := xi if i ∈I. By (2.41) with τ = (κ′, ξ)
and τ = (κ′, ξ′), we get the bound

X
i∈I

f(yi) −f(xi)

·

h(x′
i−) −h(x′
i−1)
 < 2ǫ.
Letting x′
i ↓xi for i ∈I, it follows that the sum of all terms in S1 with i ∈I
does not exceed 2ǫ. By (2.42), the norm of each term of S1 with i ∈J does
not exceed ǫ/m, and the norm of the total sum of such terms does not exceed
ǫ. Therefore in (2.43), ∥S1∥≤3ǫ. The proof of Proposition 2.46 is complete.
2
2.5 The Central Young Integral
L. C. Young [244] deﬁned, up to endpoint terms given by Young [247], an
integral which we will call the central Young integral, or the CY integral.
The idea of the CY integral is to use the RRS integral, avoiding its lack of
deﬁnition when f and h have common one-sided discontinuities by taking a
right-continuous version of f and left-continuous version of h, or vice versa,
and adding sums of jump terms to restore the desired value of ∫f·dh. For
regulated functions the CY integral extends the RYS integral, as will be
shown in Theorem 2.51, and thus in turn the RRS integral by Proposition
2.46.
Deﬁne functions f (b)
+
and f (a)
−
on [a, b] with a < b by
f (b)
+ (x) :=

f+(x) := f(x+) := limz↓x f(z) if a ≤x < b,
f(b)
if x = b,
and
f (a)
−(x) :=
 f−(x) := f(x−) := limz↑x f(z) if a < x ≤b,
f(a)
if x = a.
Recalling the deﬁnitions of ∆+, ∆−, and ∆± in and before (2.1), the CY
integral has two equivalent forms, deﬁned next:
Deﬁnition 2.47. Assuming (1.14), let f and h be regulated functions on
[a, b] with values in the Banach spaces X, Y respectively. If a < b deﬁne the
Y1 integral
(Y1)
Z b
a
f·dh := (RRS)
Z b
a
f (b)
+ ·dh(a)
−−
X
[a,b]
∆+
[a,b]f·∆±
[a,b]h
= (RRS)
Z b
a
f (b)
+ ·dh(a)
−−[∆+f·∆+h](a)
(2.44)
+ [f·∆−h](b) −
X
(a,b)
∆+f·∆±h

52
2 Extended Riemann–Stieltjes Integrals
if the RRS integral exists and the sum converges unconditionally in Z as
deﬁned in Section 1.4. If a = b deﬁne the Y1 integral as 0. Similarly, if a < b
deﬁne the Y2 integral
(Y2)
Z b
a
f·dh := (RRS)
Z b
a
f (a)
−·dh(b)
+ +
X
[a,b]
∆−
[a,b]f·∆±
[a,b]h
= (RRS)
Z b
a
f (a)
−·dh(b)
+ + [f·∆+h](a)
(2.45)
+ [∆−f·∆−h](b) +
X
(a,b)
∆−f·∆±h
if the RRS integral exists and the sum converges unconditionally in Z. If
a = b deﬁne the Y2 integral as 0.
Integrals (Yj)
R b
a df·h, j = 1, 2, are deﬁned symmetrically, if they exist, as
in (1.15).
It will be shown that the Y1 integral exists if and only if the Y2 integral
does, and if so, the two integrals have the same value. This will be done
by giving an alternative representation of the two integrals in terms of the
reﬁnement Young–Stieltjes integral. To this aim, for a < b we deﬁne the
functions f (a,b)
−
and f (a,b)
+
on [a, b] respectively by
f (a,b)
−
(x) :=



f(a)
if x = a,
f(x−) if x ∈(a, b),
f(b)
if x = b,
and
f (a,b)
+
(x) :=



f(a)
if x = a,
f(x+) if x ∈(a, b),
f(b)
if x = b.
(2.46)
Proposition 2.48. Assuming (1.14) and a < b, for regulated functions f and
h on [a, b] with values in X and Y , respectively,
(Y1)
Z b
a
f·dh = (RYS)
Z b
a
f (a,b)
+
·dh −
X
(a,b)
∆+f·∆±h
(2.47)
and
(Y2)
Z b
a
f·dh = (RYS)
Z b
a
f (a,b)
−
·dh +
X
(a,b)
∆−f·∆±h
(2.48)
if either side is deﬁned, where the right side is deﬁned if the reﬁnement Young–
Stieltjes integral exists and the sum converges unconditionally in Z.
Proof. We prove only (2.47) because a proof of (2.48) is symmetric. By Propo-
sitions 2.18 and 2.46, the reﬁnement Riemann–Stieltjes integral in (2.44) exists
if and only if it exists as a reﬁnement Young–Stieltjes integral, and then both
have the same value. Let τ = ({xi}n
i=0, {yi}n
i=1) be a Young tagged partition
of [a, b]. Then

2.5 The Central Young Integral
53
SYS(f (b)
+ , dh(a)
−; τ) =
n
X
i=1
f(yi+)·

h(xi−) −h(xi−1+)

+

f+·∆+h

(a)
+
n−1
X
i=1

f+·∆±h

(xi)
= SYS(f (a,b)
+
, dh; τ) +

∆+f·∆+h

(a) −

f·∆−h

(b).
Therefore (RYS) ∫b
a f (b)
+ ·dh(a)
−
exists if and only if (RYS) ∫b
a f (a,b)
+
·dh does.
Also, (2.47) holds, proving the proposition.
2
The following statement relates the two reﬁnement Young–Stieltjes inte-
grals in (2.47) and (2.48) with the integral (RYS) ∫b
a f·dh.
Lemma 2.49. For regulated functions f and h on [a, b] with a < b, the fol-
lowing three statements are equivalent:
(a) (RYS) ∫b
a f·dh exists;
(b) (RYS) ∫b
a f (a,b)
+
·dh and (RYS) ∫b
a[f (a,b)
+
−f]·dh both exist;
(c) (RYS) ∫b
a f (a,b)
−
·dh and (RYS) ∫b
a[f −f (a,b)
−
]·dh both exist.
If any one of the three statements holds then
(RYS)
Z b
a
f·dh = (RYS)
Z b
a
f (a,b)
+
·dh −
X
(a,b)
∆+f·∆±h
= (RYS)
Z b
a
f (a,b)
−
·dh +
X
(a,b)
∆−f·∆±h,
(2.49)
where the two sums converge unconditionally.
Proof. We prove only the implication (a) ⇒(b) and (2.49) because the con-
verse implication follows by linearity of the RYS integral and a proof of the
rest is symmetric. Thus suppose that (a) holds. It is enough to show that
(RYS) ∫b
a[f (a,b)
+
−f]·dh exists and equals the sum in (2.49). First we show
that the sum in (2.49) converges unconditionally. Let ǫ > 0. By deﬁnition of
the reﬁnement Young–Stieltjes integral there exists a partition λ of [a, b] such
that
SYS(f, dh; τ) −(RYS)
Z b
a
f·dh
 < ǫ
(2.50)
for any Young tagged partition τ = (κ, ξ) of [a, b] such that κ is a reﬁnement
of λ. Let ζ = {uj}m
j=1 ⊂(a, b) be a set disjoint from λ. Choose a reﬁnement
κ = {ti}n
i=0 of λ such that each uj is in (ti(j)−1, ti(j)), j = 1, . . . , m, for some
ti(j)−1, ti(j) ∈κ \ λ, with i(j) < i(j + 1) −1 for j = 1, . . . , m −1. Deﬁne

54
2 Extended Riemann–Stieltjes Integrals
ξ′ = {s′
i}n
i=1 and ξ′′ = {s′′
i }n
i=1 by uj = s′
i(j) < s′′
i(j) < ti(j) for j = 1, . . . , m
and take any s′
i = s′′
i ∈(ti−1, ti) for the other indices i. By (2.50) with
τ = (κ, ξ′) and τ = (κ, ξ′′), we get that

m
X
j=1

f(uj) −f(s′′
i(j))

·

h(ti(j)−) −h(ti(j)−1+)

=
SYS(f, dh; (κ, ξ′)) −SYS(f, dh, (κ, ξ′′))
 < 2ǫ.
Letting s′′
i(j) ↓uj, ti(j) ↓uj and ti(j)−1 ↑uj for j = 1, . . . , m, as is possible,
it follows that ∥P
ζ ∆+f·∆±h∥≤2ǫ for any ﬁnite set ζ ⊂(a, b) disjoint from
λ. Thus the sum in (2.49) converges unconditionally in Z.
Now to prove the existence of (RYS) ∫b
a[f (a,b)
+
−f]·dh notice that for any
Young tagged partition τ = ({ti}n
i=0, {si}n
i=1) of [a, b],
SYS(f (a,b)
+
−f, dh; τ) −
X
(a,b)
∆+f·∆±h

≤

n
X
i=1
∆+f(si)·

h(ti−) −h(ti−1+)

+

X
(a,b)
∆+f·∆±h −
n−1
X
i=1
[∆+f·∆±h](ti)
.
Using (2.50) and the unconditional convergence just proved, one can make
the right side arbitrarily small by way of reﬁnements of partitions, proving
the lemma.
2
Now we are ready to prove the equality of Y1 and Y2 integrals.
Theorem 2.50. Let f ∈R([a, b]; X) and h ∈R([a, b]; Y ). Then (Y1) ∫b
a f·dh
= (Y2) ∫b
a f·dh if either side is deﬁned.
Proof. We can assume that a < b. Suppose that the Y2 integral exists. Hence
by Proposition 2.48, the reﬁnement Young–Stieltjes integral (RYS) ∫b
a f (a,b)
−
·dh
exists and (2.48) holds. Then by Lemma 2.49 applied to f = f (a,b)
−
, the integral
(RYS) ∫b
a f (a,b)
+
·dh exists and
(RYS)
Z b
a
f (a,b)
−
·dh = (RYS)
Z b
a
f (a,b)
+
·dh −
X
(a,b)
∆±f·∆±h,
where the sum converges unconditionally. Also, by linearity of unconditional
convergence, the sum
X
(a,b)
∆+f·∆±h =
X
(a,b)
∆±f·∆±h −
X
(a,b)
∆−f·∆±h

2.5 The Central Young Integral
55
converges unconditionally. Therefore the right side of (2.47) is deﬁned, proving
the existence of the Y1 integral and the relation, by (2.48),
(Y2)
Z b
a
f·dh = (RYS)
Z b
a
f (a,b)
−
·dh +
X
(a,b)
∆−f·∆±h
= (RYS)
Z b
a
f (a,b)
+
·dh −
X
(a,b)
∆+f·∆±h = (Y1)
Z b
a
f·dh.
A proof of the converse implication is symmetric and we omit it.
2
Since the Y1 and Y2 integrals have been shown to coincide for regulated
functions f and h, if either is deﬁned, we now deﬁne the central Young integral,
or CY integral, by
(CY )
Z b
a
f·dh := (Y1)
Z b
a
f·dh = (Y2)
Z b
a
f·dh.
(2.51)
The CY integral extends the RYS integral, as the following shows.
Theorem 2.51. Assuming (1.14), for f ∈R([a, b]; X) and h ∈R([a, b]; Y )
the following hold:
(a) if (RYS) ∫b
a f·dh exists then so does (CY ) ∫b
a f·dh, and the two are equal;
(b) letting ˆf := [f (a,b)
−
+ f (a,b)
+
]/2 (cf. (2.46)), if a < b and (CY )∫b
a f·dh exists
then so does (RYS)∫b
a ˆf·dh, the sum P
(a,b)[f −ˆf]·∆±h converges uncon-
ditionally in Z, and
(CY )
Z b
a
f·dh = (RYS)
Z b
a
ˆf·dh +
X
(a,b)

f −ˆf

·∆±h.
(2.52)
Proof. For (a), suppose that (RYS) ∫b
a f·dh exists. By the implication (a) ⇒
(b) and relation (2.49) of Lemma 2.49, the right side of (2.47) is deﬁned. Hence
the CY integral exists and equals the RYS integral, proving (a).
For (b), suppose that (CY ) ∫b
a f·dh exists. By Proposition 2.48, the right
sides of (2.47) and (2.48) are deﬁned. By linearity, (RYS) ∫b
a ˆf·dh exists and
the sum P
(a,b)[f−ˆf]·∆±h converges unconditionally in Z. Then (2.52) follows
by adding (2.47) and (2.48).
2
If a function f has values at its jump points in (a, b) which are normalized,
that is, f = ˆf = [f (a,b)
−
+f (a,b)
+
]/2, then by the preceding theorem (CY ) ∫b
a f·dh
and (RYS) ∫b
a f·dh both exist or both do not. In general the equivalence is not
true, as the following shows:

56
2 Extended Riemann–Stieltjes Integrals
Proposition 2.52. There exist functions f and h on [0, 1], where f
∈
c0((0, 1)) (cf. Deﬁnition 2.9) and h is continuous, for which (Y2) ∫1
0 f dh exists,
while (RYS) ∫1
0 [f −f (0,1)
−
] dh and hence (RYS) ∫1
0 f dh do not exist.
Proof. Let f(t) := k−1/2 if t = 1/(3k) for k = 1, 2, . . . , and f(t) := 0 other-
wise. Let h(1/(3k + 1)) := 0 and h(1/(3k −1)) := k−1/2 for k = 1, 2, . . .. Let
h(0) = h(1) := 0 and let h be “linear in between,” i.e., linear on each closed
interval where h is so far deﬁned only at the endpoints. Since h is continuous
and f (0)
−
≡0, (Y2) ∫1
0 f dh exists and is 0. Since f (0,1)
−
≡0, it is enough to
show the nonexistence of the integral (RYS) ∫1
0 f dh. Let λ = {uj}m
j=0 be any
partition of [0, 1]. Take the smallest m such that tm := 1/(3m + 1) ≤u1. If
κm := λ ∪{tm} then the contribution to any Young–Stieltjes sum based on
κm coming from [0, tm] is 0. For n > m, consider partitions
κn := κm ∪{1/(3k + 1), 1/(3k −1): k = m + 1, . . . , n}.
We form a Young–Stieltjes sum based on κn by letting it be the same as one
for κm on [tm, 1], and by evaluating f at 1/(3k) for k = m + 1, . . . , n. Then
the part of our Young–Stieltjes sum for κn coming from [0, tm] is
n
X
k=m+1
f
 1
3k
 
h

1
3k −1

−h

1
3k + 1

+ 0 ·

h

1
3k −2

−h

1
3k + 1

=
n
X
k=m+1
k−1/2k−1/2 →∞
as n →∞. Thus two Young–Stieltjes sums for (RYS) ∫1
0 f dh, both based on
reﬁnements of λ, diﬀer by an arbitrarily large amount. So (RYS) ∫1
0 f dh does
not exist.
2
2.6 The Henstock–Kurzweil Integral
A gauge function on [a, b] is any function deﬁned on [a, b] with strictly positive
values. Given a gauge function δ(·) on [a, b] with a < b, a tagged partition
({xi}n
i=0, {yi}n
i=1) of [a, b] is δ-ﬁne if yi −δ(yi) ≤xi−1 ≤yi ≤xi ≤yi + δ(yi)
for i = 1, . . . , n. Let TP(δ, [a, b]) be the set of all δ-ﬁne tagged partitions of
[a, b].
Lemma 2.53. Let δ(·) be a gauge function deﬁned on an interval [a, b] with
a < b. Then:

2.6 The Henstock–Kurzweil Integral
57
(a) TP(δ, [a, b]) is nonempty, i.e. there exists a tagged partition
ζ := ({xi}n
i=0, {yi}n
i=1) ∈TP(δ, [a, b]).
(b) For any ﬁnite set F ⊂[a, b], ζ can be chosen so that F ⊂{xi}n
i=0.
(c) In (b), ζ can instead be chosen so that F ⊂{yi}n
i=1.
Proof. (a): The system of open intervals {(y −δ(y), y + δ(y)): y ∈[a, b]}
is an open cover of [a, b]. Since [a, b] is compact, there is a ﬁnite subcover
{Ji := (yi −δ(yi), yi + δ(yi)): i = 1, . . . , n} of [a, b] such that any n −1 of
the Ji do not cover [a, b]. Since yi for i = 1, . . . , n are distinct, we can assume
that y1 < · · · < yn. Also, Ji ∩Ji+1 ̸= ∅for i = 1, . . . , n −1, Ji ∩Jj = ∅for
|i −j| > 1, i, j = 1, . . . , n, a ∈J1 and b ∈Jn. Hence one can ﬁnd numbers
a = x0 < x1 < · · · < xn = b such that xi ∈Ji ∩Ji+1 for i = 1, . . . , n −1 and
yi ∈[xi−1, xi] for i = 1, . . . , n. Thus ({xi}n
i=0, {yi}n
i=1) ∈TP(δ, [a, b]), proving
(a).
(b): We can assume that F ⊂(a, b). Let F = {ξj}k
j=1 where a < ξ1 <
· · · < ξk < b. Let ξ0 := a and ξk+1 := b. By part (a), each interval [ξj, ξj+1],
j = 0, 1, . . ., k, has a δ-ﬁne tagged partition. Combining these, we get one for
[a, b], proving (b).
(c): Given a ﬁnite set F ⊂[a, b], [a, b] \ S
y∈F(y −δ(y)/2, y + δ(y)/2) is a
ﬁnite union of closed subintervals [aj, bj] of [a, b]. Each of these subintervals
has a δ-ﬁne tagged partition. Also, [a, b]\S
j[aj, bj] is a ﬁnite union of disjoint
intervals (which may be open or closed at either end). Decomposing such
intervals into smaller ones, we obtain a set of such intervals each containing
exactly one y ∈F and included in (y −δ(y), y + δ(y)). Putting together the
tagged partitions of each [aj, bj] and the tagged intervals indexed by y ∈F,
we get a δ-ﬁne tagged partition of [a, b] in which each y ∈F is a tag, proving
(c).
2
Deﬁnition 2.54. Assuming (1.14), let f : [a, b] →X and h : [a, b] →Y .
If a < b, the Henstock–Kurzweil integral, or HK integral, (HK) ∫b
a f·dh is
deﬁned as an I ∈Z, if it exists, with the following property: given ǫ > 0 there
is a gauge function δ(·) on [a, b] such that ∥SRS(f, dh; τ) −I∥< ǫ for each
δ-ﬁne tagged partition τ of [a, b]. If a = b, let (HK) ∫a
a f·dh := 0. The integral
(HK)
R b
a df·h is deﬁned, if it exists, via (1.15).
Proposition 2.55 (Cauchy test). Let a < b, f : [a, b] →X, and h : [a, b] →
Y . The Henstock–Kurzweil integral (HK) ∫b
a f·dh is deﬁned if and only if given
ǫ > 0 there is a gauge function δ(·) on [a, b] such that
∥SRS(f, dh; τ1) −SRS(f, dh; τ2)∥< ǫ
(2.53)
for each τ1, τ2 ∈TP(δ, [a, b]).

58
2 Extended Riemann–Stieltjes Integrals
Proof. To prove the “if” part, for each n ≥1, choose a gauge function δn(·)
on [a, b] such that (2.53) holds with ǫ = 1/n for each τ1, τ2 ∈TP(δn, [a, b]).
Replacing δn by min{δ1, . . . , δn}, we can assume that δ1 ≥δ2 ≥· · · . For
n = 1, 2, . . . , let Sn := SRS(f, dh; τn) for some τn ∈TP(δn, [a, b]). Then
{Sn : n ≥1} is a Cauchy sequence in Z, and hence convergent to a limit I.
Given ǫ > 0 choose an n such that n > 2/ǫ and ∥I −Sn∥< ǫ/2. Let δ := δn.
Then for each τ ∈TP(δ, [a, b]),
I −SRS(f, dh; τ)
 ≤∥I −Sn∥+ ∥Sn −SRS(f, dh; τ)∥< ǫ/2 + 1/n < ǫ.
Thus (HK) ∫b
a f·dh is deﬁned. Since the converse implication is clear, the proof
is complete.
2
Proposition 2.56. Let f : [a, b] →X and h : [a, b] →Y . Let a < c < b.
Then (HK) ∫b
a f·dh exists if and only if (HK) ∫c
a f·dh and (HK) ∫b
c f·dh both
exist, and then we have
(HK)
Z b
a
f·dh = (HK)
Z c
a
f·dh + (HK)
Z b
c
f·dh.
(2.54)
The proof of this property is easy once we observe the following:
Lemma 2.57. For any gauge function δ(·) on [a, b] and c ∈[a, b], there is a
gauge function δ′(·) on [a, b] such that δ′ ≤δ and each δ′-ﬁne tagged partition
has c as a tag, in the interior of its interval in the relative topology of [a, b].
Proof. Suppose that a ≤c ≤b and δ(·) is a gauge function on [a, b]. Let
δ′(c) := δ(c), and let δ′(x) := min{δ(x), |c −x|/2} for x ∈[a, b] \ {c}. For
a δ′-ﬁne tagged partition ({xi}n
i=0, {yi}n
i=1) of [a, b], c = yi ∈(xi−1, xi) if
c ∈[xi−1, xi] ∩(a, b), c = y1 < x1 if c = a, or c = yn > xn−1 if c = b.
2
Proof of Proposition 2.56. Suppose that I1 := (HK) ∫c
a f·dh and I2 :=
(HK) ∫b
c f·dh both exist. Given ǫ > 0, take gauge functions δ1(·) on [a, c] for
I1 and ǫ/2, and δ2(·) on [c, b] for I2 and ǫ/2. By the preceding lemma, there
is a gauge function δ(·) on [a, b] such that δ ≤δ1 on [a, c), δ ≤δ2 on (c, b],
δ(c) ≤min{δ1(c), δ2(c)}, and c is a tag for each δ-ﬁne tagged partition of
[a, b]. Let τ = ({xi}n
i=0, {yi}n
i=1) be a δ-ﬁne tagged partition of [a, b] and let
c = yi for some i ∈{1, . . ., n}. Writing f(yi)·[h(xi)−h(xi−1)] = f(yi)·[h(yi)−
h(xi−1)] + f(yi)·[h(xi) −h(yi)], we have SRS(f, dh; τ) = SRS(f, dh; τ1) +
SRS(f, dh; τ2) for suitable τ1 ∈TP(δ1, [a, c]) and τ2 ∈TP(δ2, [c, b]). Thus
∥I1 + I2 −SRS(f, dh; τ)∥< ǫ, proving the existence of (HK) ∫b
a f·dh and
relation (2.54).
Now suppose that I := (HK) ∫b
a f·dh exists. Let δ(·) be a gauge function
on [a, b] for I and ǫ/2. By the preceding lemma we can and do assume that

2.6 The Henstock–Kurzweil Integral
59
c is a tag for each δ-ﬁne tagged partition of [a, b]. Let δ1(·) and δ2(·) be the
restrictions of δ(·) to [a, c] and [c, b], respectively. Let τ ′
1, τ′′
1 ∈TP(δ1, [a, c])
and let τ2 ∈TP(δ2, [c, b]). Then τ′ := τ′
1 ∪τ2 and τ ′′ := τ′′
2 ∪τ2 are two δ-ﬁne
tagged partitions of [a, b], and
SRS(f, dh; τ′
1) −SRS(f, dh; τ′′
1 )
 =
SRS(f, dh; τ′) −SRS(f, dh; τ′′)
 < ǫ.
Thus (HK) ∫c
a f·dh exists by the Cauchy test. Similarly it follows that
(HK) ∫b
c f·dh exists. Since τ1 ∪τ2 ∈TP(δ, [a, b]) for each τ1 ∈TP(δ1, [a, c])
and τ2 ∈TP(δ2, [c, b]), (2.54) holds.
2
The Henstock–Kurzweil integral shares some elementary properties with
other Stieltjes-type integrals considered above, as will be shown in Theorems
2.72 and 2.73. Essentially the next statement says that the HK integral exists
if and only if corresponding improper integrals exist. Proposition 2.76 will
show that this property is not shared by the RRS, RYS, or CY integral.
Proposition 2.58. Assuming (1.14), let f : [a, b] →X and h: [a, b] →Y
with a < b. The integral (HK) ∫b
a f· dh is deﬁned if and only if the integral
(HK) ∫b
x f· dh is deﬁned for each x ∈(a, b) and the limit
lim
x↓a
(
(HK)
Z b
x
f· dh + f(a)·[h(x) −h(a)]
)
(2.55)
exists. Also, the integral (HK) ∫b
a f· dh is deﬁned if and only if (HK) ∫x
a f· dh
is deﬁned for each x ∈(a, b) and the limit
lim
x↑b

(HK)
Z x
a
f· dh + f(b)·[h(b) −h(x)]

exists. In either case, the limit and the integral over [a, b] are equal.
Proof. We prove only the ﬁrst part of Proposition 2.58 because a proof of
the second part is symmetric. Suppose that I := (HK) ∫b
a f· dh is deﬁned.
Then I(x) := (HK) ∫b
x f· dh is deﬁned for each x ∈(a, b] by Proposition
2.56. Given ǫ > 0, let δ(·) be a gauge function on [a, b] such that any two
Riemann–Stieltjes sums based on δ-ﬁne tagged partitions diﬀer by at most ǫ.
For x ∈(a, a+δ(a)], by Proposition 2.56 and Lemma 2.53(a), there is a δ-ﬁne
tagged partition τx of [a, x] such that the Riemann–Stieltjes sum based on τx
is within ǫ of (HK) ∫x
a f· dh. Also, let τ x be any δ-ﬁne tagged partition of [x, b]
and σx := ({a, x}, a). Let τ1 and τ2 be two tagged partitions of [a, b] which
coincide with τx and σx, respectively, when restricted to [a, x], and which both
equal τx when restricted to [x, b]. Then τ1 and τ2 are δ-ﬁne and
I −I(x) −f(a)·[h(x) −h(a)]
 ≤
(HK)
Z x
a
f· dh −SRS(f, dh; τx)

+
SRS(f, dh; τ1) −SRS(f, dh; τ2)

< 2ǫ.

60
2 Extended Riemann–Stieltjes Integrals
Since x ∈(a, a + δ(a)] and ǫ > 0 are arbitrary, the limit (2.55) exists and
equals I. Thus the “only if” part of the proposition holds.
To prove the converse implication we need the following auxiliary state-
ment, sometimes called Henstock’s lemma.
Lemma 2.59. Suppose a < b and I := (HK) ∫b
a f· dh is deﬁned. Given ǫ > 0,
let δ(·) be a gauge function on [a, b] for I and ǫ, and let ({xi}n
i=0, {yi}n
i=1) be
a δ-ﬁne tagged partition of [a, b]. Then for any subset J ⊂{1, . . . , n},

X
i∈J
n
f(yi)·[h(xi) −h(xi−1)] −(HK)
Z xi
xi−1
f· dh
o ≤ǫ.
(2.56)
Proof. Let k :=cardJ′ for J′ := {1, . . ., n} \ J, and let ǫ′ be an arbitrary
positive number. By Proposition 2.56, for each i ∈J′, there is a δ-ﬁne tagged
partition τi of [xi−1, xi] such that
SRS(f, dh; τi) −(HK)
Z xi
xi−1
f· dh
 < ǫ′/k.
Let τ := S
i∈J′ τi ∪S
i∈J({xi−1, xi}, yi). Then τ is a δ-ﬁne tagged partition of
[a, b], and the left side of (2.56) is equal to
SRS(f, dh; τ) −(HK)
Z b
a
f· dh −
X
i∈J′
n
SRS(f, dh; τi) −(HK)
Z xi
xi−1
f· dh
o,
which is less than ǫ + ǫ′. Since ǫ′ is arbitrary, (2.56) holds.
2
Continuation of the proof of Proposition 2.58. Suppose that the limit
(2.55) exists. Let I be its value. Then I(x) := (HK) ∫b
x f· dh is deﬁned for
each x ∈(a, b).
Given ǫ > 0, we will construct a gauge function δ(·) on (a, b] such that
for each x ∈(a, b), a + δ(x) < x and ∥I(x) −SRS(f, dh; τx)∥≤ǫ for any
δ-ﬁne tagged partition τ x of [x, b]. Suppose we have such a gauge function
δ(·) on (a, b]. Deﬁne δ(a) so that ∥I −I(x) −f(a)·[h(x) −h(a)]∥< ǫ for any
x ∈(a, a+δ(a)]. Let τ = ({xi}n
i=0, {yi}n
i=1) be a δ-ﬁne tagged partition of [a, b].
Then by construction of δ(·), we have that y1 = a, τ x1 := ({xi}n
i=1, {yi}n
i=2)
is a δ-ﬁne tagged partition of [x1, b], and
I −SRS(f, dh; τ)
 ≤
I(x1) −SRS(f, dh; τx1)

+
I −I(x1) −f(a)·[h(x1) −h(a)]

< 2ǫ.
Thus the integral (HK) ∫b
a f· dh is deﬁned and equals I.

2.6 The Henstock–Kurzweil Integral
61
To construct the desired gauge function δ(·) on (a, b], let {un: n ≥0} be a
decreasing sequence of numbers such that u0 = b and limn→∞un = a. Given
ǫ > 0, let δ1(·) be a gauge function on [u1, u0] for (HK) ∫u0
u1 f· dh and ǫ/2. For
n ≥2, let δn(·) be a gauge function on [un, un−2] for (HK) ∫un−2
un
f· dh and
ǫ/2n. For z ∈(u1, u0] deﬁne δ(z) so that 0 < δ(z) ≤δ1(z) and u1 < z −δ(z).
For z ∈(un, un−1] with n > 1, deﬁne δ(z) so that 0 < δ(z) ≤δn(z) and
un < z −δ(z) < z + δ(z) < un−2. Thus δ(·) is deﬁned on (a, b]. Let x ∈(a, b)
and let τx = ({xi}m
i=0, {yi}m
i=1) be a δ-ﬁne tagged partition of [x, b]. For each
n ≥1, let In := {i: yi ∈(un, un−1]}, and let Jn := ∪i∈In[xi−1, xi]. By
construction, τx restricted to Jn is a δn-ﬁne tagged partition of Jn. Since
J1 ⊂(u1, u0] and Jn ⊂(un, un−2) for each n ≥2, by Lemma 2.59, for each
n ≥1,

X
i∈In
n
f(yi)·[h(xi) −h(xi−1)] −(HK)
Z xi
xi−1
f· dh
o ≤
ǫ
2n .
Thus
(HK)
Z b
x
f· dh −SRS(f, dh; τx)
 ≤
∞
X
n=1
ǫ/2n = ǫ.
As noted earlier, this completes the proof of Proposition 2.58.
2
Proposition 2.60. Let h be a real-valued function on [a, b]. If (HK) ∫b
a f dh
exists whenever f = 1J for an interval J, then h is regulated on [a, b].
Proof. Suppose not. Then we can assume that for some uk ↓c ∈[a, b), the
h(uk) do not converge. If h(uk) are unbounded let ǫ = 1. If they are bounded
let ǫ := 3−1[lim supk→∞h(uk) −lim infk→∞h(uk)]. Let fc := 1(c,b]. Take a
gauge function δ(·) on [a, b] for ǫ and (HK) ∫b
a fc dh. By Lemma 2.57, there
exist a gauge function δ′ ≤δ and a δ′-ﬁne tagged partition τ of [a, b] with c
as the tag for an interval [xi−1, xi] and c < xi. For all k large enough we have
uk < xi. Then take a δ′-ﬁne tagged reﬁnement τk of τ where c is the tag for
[xi−1, uk], by Lemma 2.53(a) for [uk, xi]. The corresponding Riemann–Stieltjes
sums
SRS(fc, dh; τk) = h(b) −h(uk)
vary by more than 2ǫ as k →∞, a contradiction.
2
Suppose a continuous function f : [a, b] 7→R is diﬀerentiable everywhere
on (a, b). It may be that f ′ is not Lebesgue integrable, e.g. if [a, b] = [0, 1],
f(x) = x2 sin(π/x2), 0 < x < 1, f(x) = 0 elsewhere. Between 1910 and
1920, Denjoy and Perron (see the Notes) deﬁned integrals such that for every
such f ′, ∫x
a f ′(t) dt = f(x) −f(a), a ≤x ≤b. The next fact shows that the
later-invented Henstock–Kurzweil integral has this property:

62
2 Extended Riemann–Stieltjes Integrals
Theorem 2.61. Let f be a continuous function from [a, b) to R having a
derivative f ′(x) for a < x < b except for at most countably many x. Then
(HK) ∫x
a f ′(t) dt exists and equals f(x) −f(a) for a ≤x < b.
Proof. The statement follows from Theorems 7.2 and 11.1 of Gordon [84]. 2
For another example, f(x) := x2 sin(e1/x), x ̸= 0, f(0) := 0, satisﬁes the
conditions of Theorem 2.61 although f ′ has very wild oscillations.
*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil
Integrals
Before deﬁning the Ward–Perron–Stieltjes integral we need to deﬁne what
are called major and minor functions. Given two real-valued functions f, h on
[a, b], we call M a major function of f with respect to h if M(a) = 0, M has
ﬁnite values on [a, b], and for each x ∈[a, b] there exists δ(x) > 0 such that
M(z) ≥M(x) + f(x)[h(z) −h(x)]
if
x ≤z ≤min{b, x + δ(x)},
M(z) ≤M(x) + f(x)[h(z) −h(x)]
if
max{a, x −δ(x)} ≤z ≤x.
(2.57)
Thus for a major function M there exists a positive function δM(·) = δ(·) on
[a, b] which satisﬁes (2.57). Let U(f, h) be the class of all major functions of
f with respect to h, and let
U(f, h) :=

inf{M(b): M ∈U(f, h)}
if U(f, h) ̸= ∅,
+∞
if U(f, h) = ∅.
A function m is a minor function of f with respect to h if −m ∈U(−f, h).
Let L(f, h) be the class of all minor functions of f with respect to h. Thus
m ∈L(f, h) provided m(a) = 0, m has ﬁnite values on [a, b], and there exists
a positive function δ(·) = δm(·) on [a, b] such that
m(z) ≤m(x) + f(x)[h(z) −h(x)]
if
x ≤z ≤min{b, x + δ(x)},
m(z) ≥m(x) + f(x)[h(z) −h(x)]
if
max{a, x −δ(x)} ≤z ≤x.
(2.58)
Let
L(f, h) :=
sup{m(b): m ∈L(f, h)}
if L(f, h) ̸= ∅,
−∞
if L(f, h) = ∅.
Then the following is true:
Lemma 2.62. L(f, h) ≤U(f, h).

*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil Integrals
63
Proof. The statement is true if either of the sets L(f, h) or U(f, h) is empty.
Suppose that L(f, h) and U(f, h) are nonempty. Let m ∈L(f, h) and M ∈
U(f, h). Also, let δ := δm ∧δM and w(x) := M(x) −m(x) for x ∈[a, b]. By
(2.57) and (2.58), for each x ∈(a, b], it follows that
w(z) ≥w(x)
if
x ≤z ≤min{b, x + δ(x)},
w(z) ≤w(x)
if
max{a, x −δ(x)} ≤z ≤x.
Therefore inf

M(x): M ∈U(f, h)
	
−sup

m(x): m ∈L(f, h)
	
is a non-
decreasing function of x. Then the statement of the lemma holds because
m(a) = M(a) = 0.
2
Now we are ready to deﬁne the Ward–Perron–Stieltjes integral.
Deﬁnition 2.63. If U(f, h) = L(f, h) is ﬁnite then the common value will
be denoted by (WPS) ∫b
a f dh and called the Ward–Perron–Stieltjes integral,
or the WPS integral.
Note that if a = b then U(f, h) = L(f, h) = 0, and so the integral
(WPS) ∫a
a f dh equals 0. First we show that the Ward–Perron–Stieltjes in-
tegral extends the reﬁnement Riemann–Stieltjes integral.
Theorem 2.64. If (RRS) ∫b
a f dh exists then so does (WPS) ∫b
a f dh, and the
two are equal.
Proof. We can assume that a < b. For a ≤u < v ≤b, let M(u, v) be
the supremum of all Riemann–Stieltjes sums SRS(f, dh; τ) based on tagged
partitions τ of [u, v], with M(u, u) ≡0. Then
M(u, y) ≥M(u, x) + f(x)[h(y) −h(x)]
if
u ≤x ≤y,
M(u, y) ≤M(u, x) + f(x)[h(y) −h(x)]
if
u ≤y ≤x.
(2.59)
Suppose (RRS) ∫b
a f dh exists and ǫ > 0. Then there exists λ = {zj : j =
0, . . . , m} ∈PP [a, b] such that
(RRS)
Z b
a
f dh −ǫ < SRS(f, dh; τ) < (RRS)
Z b
a
f dh + ǫ
(2.60)
for each tagged reﬁnement τ of λ. For each x ∈(a, b], let j(x) be the largest
integer such that zj(x) ≤x. Let M(a) := 0, and for each x ∈(a, b] let
M(x) :=
j(x)
X
j=1
M(zj−1, zj) + M(zj(x), x),
where the sum over the empty set is 0. Deﬁne a positive function δ(·) on [a, b]
by δ(x) := min{x −zj(x), zj(x)+1 −x} if x ∈(zj(x), zj(x)+1), δ(a) := z1 −a,

64
2 Extended Riemann–Stieltjes Integrals
δ(b) := b −zm−1, and δ(zj) := min{zj −zj−1, zj+1 −zj} for j = 1, . . . , m −1.
By (2.59), the functions M and δ so deﬁned satisfy (2.57). Hence M is a
major function of f with respect to h. By (2.60), it follows that M(b) ≤
(RRS) ∫b
a f dh + ǫ. Similarly one can deﬁne a minor function m such that
m(b) ≥(RRS) ∫b
a f dh−ǫ. Since ǫ is arbitrarily small, this proves the theorem.
2
Next is the main result of this section, which says that the Henstock–
Kurzweil and Ward–Perron–Stieltjes integrals coincide.
Theorem 2.65. The integral (WPS)∫b
a f dh exists if and only if (HK)∫b
a f dh
exists, and then their values are equal.
Proof. We can assume that a < b. Suppose (WPS) ∫b
a f dh is deﬁned. Then
given ǫ > 0, there exist a major function M ∈U(f, h) and a minor function
m ∈L(f, h) such that
M(b) −ǫ < (WPS)
Z b
a
f dh < m(b) + ǫ.
(2.61)
Let δ := δM ∧δm and let τ = ({ti}n
i=0, {si}n
i=1) be any δ-ﬁne tagged partition
of [a, b], which exists by Lemma 2.53(a). By (2.57), we have
M(ti) −M(si) ≥f(si)[h(ti) −h(si)],
M(si) −M(ti−1) ≥f(si)[h(si) −h(ti−1)]
(2.62)
for each i = 1, . . . , n. Adding up the 2n inequalities (2.62), we get the upper
bound M(b) ≥Sδ(τ) for the Riemann–Stieltjes sum Sδ(τ) := SRS(f, dh; τ).
Similarly, using (2.58), we get the lower bound Sδ(τ) ≥m(b). By (2.61), it
then follows that
(WPS)
Z b
a
f dh −ǫ < Sδ(τ) < (WPS)
Z b
a
f dh + ǫ.
Thus (HK) ∫b
a f dh exists and has the same value as the (WPS) integral.
Now suppose (HK) ∫b
a f dh is deﬁned. Given ǫ > 0 there exists a gauge
function δ(·) such that for each δ-ﬁne tagged partition τ, the Riemann–
Stieltjes sum Sδ(τ) := SRS(f, dh; τ) has bounds
(HK)
Z b
a
f dh −ǫ < Sδ(τ) < (HK)
Z b
a
f dh + ǫ.
(2.63)
For each x ∈(a, b], let δx(·) be the gauge function δ(·) restricted to the interval
[a, x], and m(x) := inf

Sδx(τ): τ ∈TP(δx, [a, x])
	
, M(x) := sup

Sδx(τ): τ ∈
TP(δx, [a, x])
	
. Let m(a) = M(a) := 0. Then m(x) and M(x) have ﬁ-
nite values for each x ∈(a, b]. Let x ∈(a, b) and z ∈(x, x + δ(x) ∧

*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil Integrals
65
b]. Then for each τ = ({a = t0, . . . , tm = x}, {si}m
i=0) ∈TP(δx, [a, x]),
({t0, . . . , tm, z}, {s1, . . . , sm, x}) ∈TP(δz, [a, z]). Thus
Sδx(τ) + f(x)[h(z) −h(x)] ≤M(z)
for any τ ∈TP(δx, [a, x]). Thus the ﬁrst inequality in (2.57) holds. Similarly
one can show that the second one and (2.58) also hold. Therefore m and M
are minor and major functions respectively. By Lemma 2.62, the deﬁnitions
of L(f, h) and U(f, h), and (2.63), it then follows that
(HK)
Z b
a
f dh −ǫ ≤m(b) ≤L(f, h) ≤U(f, h) ≤M(b) ≤(HK)
Z b
a
f dh + ǫ.
Since ǫ > 0 is arbitrary, L(f, h) = U(f, h) and equals the HK integral. The
proof of Theorem 2.65 is complete.
2
Next we show that for integrators in the class c0((a, b)) = c0((a, b), [a, b]; R)
with a < b (cf. Deﬁnition 2.9), the Henstock–Kurzweil and Ward–Perron–
Stieltjes integrals diﬀer from the reﬁnement Young–Stieltjes, central Young,
and Kolmogorov integrals.
Proposition 2.66. For f ∈R[a, b] and any h ∈c0((a, b)) if a < b or h ∈
R[a, a], i.e. h is any function {a} →R if a = b,
(RYS)
Z b
a
f dh = (CY )
Z b
a
f dh =
R
=
[a,b]
f dµh,[a,b] = 0.
Proof. This follows from the deﬁnitions of the integrals because h(a)
−≡h(b)
+ ≡
∆±
[a,b]h ≡µh,[a,b] ≡0 if a < b and µh,[a,a] ≡0.
2
We will show in Proposition 2.68 that the analogous statement for the
Henstock–Kurzweil integral does not hold.
Lemma 2.67. For each h ∈c0((a, b)) with a < b there exists a right-
continuous f ∈R[a, b] such that ∆−f ≡h on (a, b).
Proof. Let h = P
i ci1{ξi}. For each i ≥1, let fi(x) := 0 if x ∈[a, ξi)∪[ξi+δi, b]
for some δi > 0, let fi(ξi) := ci, and let fi be linear on [ξi, ξi + δi]. If δi →0
fast enough as i →∞so that each (ξi, ξi+δi) contains no ξj with |cj| > |ci|/2,
then f := P
i fi converges uniformly on [a, b] and f has the stated properties.
2
Proposition 2.68. There exist h ∈c0((0, 1)) and f ∈R[0, 1] such that
(HK) ∫1
0 f dh is undeﬁned.

66
2 Extended Riemann–Stieltjes Integrals
Proof. For k odd, k = 1, 3, . . ., 2n −1, n = 1, 2, . . ., let h(k/2n) := 1/2n/3
and h = 0 elsewhere. Then h ∈c0((0, 1)). By Lemma 2.67, take a right-
continuous f ∈R[0, 1] such that ∆−f(k/2n) = 1/2n/3 for k = 1, 3, . . . , 2n −1
and n = 1, 2, . . . .
Let δ(·) be any strictly positive function on [0, 1]. By the category theorem
(e.g. Theorem 2.5.2 in Dudley [53]), there is an interval J = [c, d] ⊂[0, 1] of
length ǫ for some ǫ > 0 such that δ(y) > ǫ for a dense set S of y in J, and the
endpoints of J are not dyadic rationals. So, all tagged partitions of J with
tags in S are δ-ﬁne.
For r = 1, 2, . . ., let M(r) be the set of all binary rationals k/2n in J for
integers n, 1 ≤n ≤r, and odd integers k ≥1. As n →+∞, the number of
such k/2n for a ﬁxed n is asymptotic to 2n−1ǫ. For a given r write M(r) =
{x2j−1}m
j=1 where x1 < x3 < · · · < x2m−1 for some m = m(r). For each j ∈
{1, . . . , m−1}, choose x2j ∈(x2j−1, x2j+1) which is not a dyadic rational, and
let x0 := c, x2m := d, recalling that J = [c, d]. For each j ∈{1, . . ., m}, choose
y2j−1 ∈S ∩(x2j−2, x2j−1) and y2j ∈S ∩(x2j−1, x2j) close enough to x2j−1 so
that |[f(y2j) −f(y2j−1) −∆−f(x2j−1)]h(x2j−1)| < 1/|M(r)|, where |M(r)| =
card (M(r)). Then ζr := ({xj}2m
j=0, {yj}2m
j=1) is a δ-ﬁne tagged partition of J
and
 −SRS(f, dh; ζr) −
m
X
j=1
∆−f(x2j−1)h(x2j−1)
 < 1.
Since the latter sums are unbounded as r increases, so are the former
Riemann–Stieltjes sums. Then combining ζr with a δ-ﬁne tagged partition
of [0, c] (if 0 < c) and a δ-ﬁne tagged partition of [d, 1] (if d < 1), which
exist by Lemma 2.53(a), we get unbounded Riemann–Stieltjes sums for δ-ﬁne
tagged partitions of [0, 1]. Since the gauge function δ(·) on [0, 1] is arbitrary,
(HK) ∫1
0 f dh does not exist.
2
Under some restrictions on the integrator, the Henstock–Kurzweil integral
will be shown to extend the reﬁnement Young–Stieltjes integral. Note that
in the following, h may be a function Rµ,a as in Proposition 2.6(f), right-
continuous on (a, b) but not necessarily at a, so the RYS integral can be
replaced by the Kolmogorov integral according to Corollary 2.26.
Theorem 2.69. Suppose f and h are regulated on [a, b], and if a < b, h
is right-continuous or left-continuous on (a, b). If (RYS) ∫b
a f dh exists then
(HK) ∫b
a f dh exists and has the same value.
Proof. We can assume that a < b and h is right-continuous on (a, b) by sym-
metry. Given ǫ > 0, let λ = {zj}m
j=0 be a partition of [a, b] such that for any
Young tagged reﬁnement τ of λ,
SYS(f, dh; τ) −(RYS)
Z b
a
f dh
 < ǫ.
(2.64)

*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil Integrals
67
Recall ∆+
(a,b)f deﬁned before (2.1) and f (a,b)
+
deﬁned in (2.46). Then ∆+
(a,b)f ≡
f (a,b)
+
−f on [a, b]. By Lemma 2.49 we can assume that (2.64) holds also for f
replaced by f (a,b)
+
or by ∆+
(a,b)f, taking λ as a common reﬁnement λ = λ′ ∪λ′′
of partitions λ′ for f (a,b)
+
and ǫ/2, and λ′′ for ∆+
(a,b)f and ǫ/2. So it suﬃces to
prove the theorem for f (a,b)
+
and for ∆+
(a,b)f.
Deﬁne a gauge function δ(·) on [a, b] as follows: if t ̸∈λ, let δ(t) := minj |t−
zj|/2. Then any δ(·)-ﬁne tagged partition must contain each zj as a tag. For
j = 0, . . . , m, deﬁne δ(zj) such that δ(zj) ≤mini̸=j |zi −zj|/3 and
∥f∥∞
m
X
j=1
n
Osc
 h; [zj −δ(zj), zj)

+ Osc
 h; (zj−1, zj−1 + 2δ(zj−1)]
o
< ǫ.
(2.65)
Let τ =
 {ti}n
i=0, {si}n
i=1

be any δ(·)-ﬁne tagged partition of [a, b] and let
Sδ(τ) := SRS(f, dh; τ) =
n
X
i=1
f(si)

h(ti) −h(ti−1)

(2.66)
be the Riemann–Stieltjes sum based on τ. We can assume that si = ti = si+1
never occurs, since if it did, the ith and (i+1)st term in Sδ(τ) could be replaced
by f(si)[h(ti+1) −h(ti−1)], and we would still have a Riemann–Stieltjes sum
based on a δ(·)-ﬁne tagged partition equal to Sδ(τ). Since the tags {si}n
i=1
must contain the points of λ, for each index j ∈{0, . . . , m} there is an index
i(j) ∈{1, . . . , n} such that zj = si(j). Let µ := {i(j): j = 0, . . . , m} ⊂
{1, . . . , n}. For j = 1, . . . , m −1, by deﬁnition of δ(·), we must have
ti(j)−1 < si(j) < ti(j).
(2.67)
We also have i(0) = 1, s1 = z0 = t0 = a and i(m) = n, sn = zm = tn = b.
Now consider the case that f is right-continuous on (a, b), which holds
when f = f (a,b)
+
. We will show that one can ﬁnd a Young–Stieltjes sum, based
on a reﬁnement of λ, which is arbitrarily close to the Riemann–Stieltjes sum
Sδ(τ). To this aim we will replace the values h(ti) in Sδ(τ), i = 1, . . . , n −1,
by values h(xi) at continuity points xi of h, close to ti. Then the Young–
Stieltjes sum terms f(xi)∆±h(xi) will be 0. Deﬁne a Riemann–Stieltjes sum
T by, for each i = 1, . . . , n −1 such that ti < si+1, replacing ti in Sδ(τ) by a
slightly larger xi > ti which is a continuity point of h with xi < si+1. Then
|T −Sδ(τ)| < ǫ. Deﬁne another Riemann–Stieltjes sum U equal to T except
that for each i such that si+1 = ti and 1 ≤i ≤n −1, we replace si+1 by
yi+1 and ti by xi with ti < xi < yi+1 < ti+1, where xi is a continuity point
of h and yi+1 −ti is as small as desired. Since f is right-continuous on (a, b),
we can make |U −T | < ǫ. In either case we can assume that si ≤ti < xi ≤
si + 2δ(si) for i = 1, . . . , n −1. Let x0 := a and xn := b. Let yi := si for each
i = 2, . . . , n −1 for which yi was not previously deﬁned. Thus yi(j) = si(j) for

68
2 Extended Riemann–Stieltjes Integrals
j = 1, . . . , m −1 by (2.67). Choose any y1 ∈(a, t1) and yn ∈(xn−1, b). Let
V := SYS(f, dh; ζ) be the Young–Stieltjes sum based on the Young tagged
point partition ζ := (ξ, η) := ({xi}n
i=0, {yi}n
i=1). Then
|V −U|
= |f(a)∆+h(a) + f(y1)[h(x1) −h(a+)] −f(a)[h(x1) −h(a)]
+ f(b)∆−h(b) + f(yn)[h(b−) −h(xn−1)] −f(b)[h(b) −h(xn−1)]|
= |[f(y1) −f(a)][h(x1) −h(a+)] + [f(yn) −f(b)][h(b−) −h(xn−1)]| < 2ǫ
by (2.65). Now let κ := λ∪ξ = {ul}k
l=0, a partition of [a, b] with k = m+n−1.
Each interval (xi−1, xi) for i = 2, . . . , n −1 contains zj if i = i(j) ∈µ,
and otherwise contains no zj and becomes an interval (ul−1, ul) for some
l. In the latter case let vl := yi. In the former case we have for some l,
ul−2 = xi−1 < zj = ul−1 < xi = ul. Choose any vl−1 := wj with ul−2 <
vl−1 < ul−1 and vl := rj with ul−1 < vl < ul. Let W := SYS(f, dh; (κ, σ))
be the Young–Stieltjes sum based on the Young tagged point partition (κ, σ),
where σ := {vl}k
l=1. Then
|W −V | =

m−1
X
j=1
n
f(wj)[h(zj−) −h(xi(j)−1)] + f(zj)∆−h(zj)
+ f(rj)[h(xi(j)−) −h(zj)] −f(zj)[h(xi(j)−) −h(xi(j)−1)]
o
≤
m−1
X
j=1
[f(wj) −f(zj)][h(zj−) −h(xi(j)−1)]

+
m−1
X
j=1
[f(rj) −f(zj)][h(xi(j)−) −h(zj)]
 < 2ǫ
by (2.65). Here W is a Young–Stieltjes sum based on the Young tagged reﬁne-
ment (κ, σ) of λ, so |W −(RYS) ∫b
a f dh| < ǫ. Thus |Sδ(τ) −(RYS) ∫b
a f dh| <
7ǫ. The conclusion follows when f is right-continuous on (a, b).
Next consider the case that f ∈c0((a, b)) (cf. Deﬁnition 2.9), which holds
when f = ∆+
(a,b)f. There is a set of tags {wj}m
j=1 for the partition λ = {zj}m
j=0
such that (λ, {wj}m
j=1) is a Young tagged point partition of [a, b] and f(wj) = 0
for all j. Thus by (2.64),

m−1
X
j=1
f(zj)∆−h(zj) −(RYS)
Z b
a
f dh
 < ǫ.
(2.68)
By (2.67), ti ∈λ only for i = 0 and n. For any set ν ⊂{1, . . . , n −1},
consider partitions κ = {ul}k
l=0, k = m + n −1, of [a, b] consisting of λ, ti
for i ∈ν, and for each i ∈{1, . . . , n −1} \ ν, a continuity point of h close to
ti. Let l(1) < · · · < l(n −1) be such that {ul(i)}n−1
i=1 are the ul not in λ. Let

*2.7 Ward–Perron–Stieltjes and Henstock–Kurzweil Integrals
69
σ = {vl}k
l=1 be a set of tags for κ such that (κ, σ) is a Young point partition
of [a, b] and f(vl) = 0 for all l. Then from (2.68) and (2.64) we obtain

X
i∈ν
f(ti)∆−h(ti)
 < 2ǫ.
(2.69)
Consider also partitions (κ, σ) deﬁned in the same way except that for
ξ ⊂{1, . . ., n −1}, if i ∈ξ \ µ and i is even, i /∈µ implies l(i −1) = l(i) −1.
We take ul = ul(i) to be a continuity point of h a little larger than ti, while
ul(i)−1 is a continuity point of h a little smaller than ti−1 and vl(i) = ti−1. For
each i = 1, . . . , n −1 such that ul(i) is not yet deﬁned, let it be a continuity
point of h near ti, which is then true for all i = 1, . . . , n −1. Let f(vl) = 0
for other l as before. For even i ∈ξ \ µ, letting ul(i) ↓ti and ul(i)−1 ↑ti−1, it
follows that

X 
f(ti−1)[h(ti) −h(ti−1−)]: i ∈ξ \ µ, i even
	 ≤2ǫ.
The same holds likewise for i odd. Thus

X
i∈ξ\µ
f(ti−1)[h(ti) −h(ti−1−)]
 ≤4ǫ.
With ν = {i −1: i ∈ξ \ µ} in (2.69) this gives

X
i∈ξ\µ
f(ti−1)[h(ti) −h(ti−1)]
 ≤6ǫ.
If si = ti−1 then i ̸∈µ by (2.67). Thus

X 
f(ti−1)[h(ti) −h(ti−1)]: ti−1 = si, i = 2, . . . , n −1
	 ≤6ǫ.
Here f(ti−1) could be replaced by f(ti−1) −f(yi), where ti−1 < yi < ti and
f(yi) = 0. So the Riemann–Stieltjes sum (2.66) diﬀers by at most 6ǫ from the
Riemann–Stieltjes sum
S′ :=
n
X
i=1
f(wi)[h(ti) −h(ti−1)],
where wi := yi if ti−1 = si and i = 2, . . . , n −1, wi := si otherwise. Then
ti−1 < wi ≤ti for i = 2, . . . , n −1. The rest of the proof follows as in the case
when f is right-continuous and ti < si+1 for all i = 1, ..., n −1, so that U = T
and yi = si for all i = 2, . . . , n −1. The proof of Theorem 2.69 is complete.
2

70
2 Extended Riemann–Stieltjes Integrals
The following gives a partial converse to the preceding theorem. We say
that the Young–Stieltjes sums for f and h are unbounded on any subinterval
of [a, b] with a < b if for all a ≤c < d ≤b, sup{|SYS(f, dh; τ)|} = +∞, where
the supremum is taken over all Young tagged partitions τ of [c, d]. Then the
sums based on partitions which are reﬁnements of any given partition of [c, d]
are also unbounded.
Proposition 2.70. Let a < b. Given f left- or right-continuous on (a, b) and
h ∈R[a, b], suppose that the Young–Stieltjes sums for f and h are unbounded
on any subinterval of [a, b]. Then (HK) ∫b
a f dh does not exist.
Proof. Suppose that (HK) ∫b
a f dh exists. Let δ(·) be a gauge function and I
a number such that for any δ-ﬁne tagged partition ({xi}n
i=0, {yi}n
i=1) of [a, b],

n
X
i=1
f(yi)[h(xi) −h(xi−1)] −I
 < 1.
(2.70)
By the category theorem (e.g. Theorem 2.5.2 in Dudley [53]), there are an
interval [c, d] and a positive integer m such that δ(x) > 1/m for all x in a dense
set S in [c, d]. Replacing [c, d] by a subinterval of itself, we can assume that 0 <
d −c < 1/m and that c, d ∈S. Thus every tagged partition ({ξi}k
i=0, {ηj}k
j=1)
of [c, d] with tags ηj ∈S for j = 1, . . . , k is δ-ﬁne. Take a δ-ﬁne tagged partition
as in (2.70), where we can take some yi = c < yℓ= d by Lemma 2.53(c). We
can also take xi = c and xℓ= d, as follows. If initially yi = c < xi, then let
x′
r := xr for r = 0, 1, . . . , i−1 and y′
r := yr for r = 1, . . . , i−1. Let x′
i := y′
i := c
and for r = i, . . . , n, let y′
r+1 := yr and x′
r+1 := xr. Then ({x′
i}n+1
i=0 , {y′
i}n+1
i=1 )
is a δ-ﬁne tagged partition of [a, b] giving the same sum as in (2.70). We can
take d as some xℓlikewise. Let κ be the resulting δ-ﬁne tagged partition of
[a, b]. We show next that the part of κ corresponding to [c, d] can be replaced
by a tagged partition of [c, d] such that the corresponding Riemann–Stieltjes
sum is arbitrarily large and the resulting tagged partition of [a, b] is δ-ﬁne.
For any M < ∞, by assumption, there is a Young tagged partition τ =
({tj}k
j=0, {sj}k
j=1) of [c, d] such that |SYS(f, dh; τ)| > M. Since h is regulated,
there exist vj < tj, j = 1, . . . , k, and uj > tj, j = 0, . . . , k −1, such that
tj−1 < uj−1 < sj < vj < tj for j = 1, . . . , k and
|f(c)[h(u0) −h(c)] +
k−1
X
j=1
f(tj)[h(uj) −h(vj)]
+
k
X
j=1
f(sj)[h(vj) −h(uj−1)] + f(d)[h(d) −h(vk)]| > M.
Now since f is right- or left-continuous, and S is dense, we can replace sj
by some s′
j ∈S as close to sj as desired, making a small change in the sum.
Likewise we can replace tj by some t′
j ∈S, where uj−1 < s′
j < vj < t′
j < uj for

2.8 Properties of Integrals
71
each j = 1, . . . , k−1. Recall that c, d ∈S; the endpoints t0, tk are not replaced.
We thus obtain a Riemann–Stieltjes sum Σ for a δ-ﬁne tagged partition ζ of
[c, d] with |Σ| > M. Then joining ζ with the δ-ﬁne tagged partitions of [a, c]
(if a < c) and [d, b] (if d < b) given by the ﬁxed tagged partition κ, we
get unbounded Riemann–Stieltjes sums for δ-ﬁne tagged partitions of [a, b],
contradicting (2.70).
2
Ward [238] stated and Saks [201, Theorem VI.8.1] gave a proof of the
fact that the integral (WPS) ∫b
a f dh is deﬁned provided the corresponding
Lebesgue–Stieltjes integral (LS) ∫b
a f dh is deﬁned, and then they are equal.
By Theorem 2.65, the Henstock–Kurzweil integral is in the same relation
with the LS integral. The following gives conditions under which the converse
holds.
Theorem 2.71. Let f be nonnegative on [a, b] and let h be nondecreasing on
[a, b] and right-continuous on [a, b). Then (HK) ∫b
a f dh exists if and only if
(LS) ∫b
a f dh does, and then the two are equal.
Proof. If a = b both integrals are 0, so we can assume a < b. The Mc-
Shane integral is deﬁned as the HK integral except that in a tagged parti-
tion ({ti}n
i=0, {si}n
i=1) the tags si need not be in the corresponding intervals
[ti−1, ti]. By Corollary 6.3.5 of Pfeﬀer [185, p. 113], under the present hypothe-
ses (HK) ∫b
a f dh exists if and only if the corresponding McShane integral ex-
ists, and then the two are equal. The equivalence between the McShane and
Lebesgue–Stieltjes integrals when f ≥0 and h is nondecreasing was proved
by McShane [167, pp. 552, 553]. Also, it follows from Theorem 4.4.7, Propo-
sition 3.6.14, and Theorem 2.3.4 of Pfeﬀer [185]. The proof of the theorem is
complete.
2
2.8 Properties of Integrals
In this section, by “
R
= integral” we will mean an integral
R
= f·dh as opposed to
an integral
R
= f·dµ for an interval function µ. Suppose that the basic assump-
tion (1.14) holds. For functions f : [a, b] →X and h: [a, b] →Y , consider the
following properties of an integral ∫b
a f·dh:
I.
For u1, u2 ∈K and f1, f2 : [a, b] →X,
Z b
a
(u1f1 + u2f2)·dh = u1
Z b
a
f1·dh + u2
Z b
a
f2·dh,
where the left side exists provided the right side does.

72
2 Extended Riemann–Stieltjes Integrals
II.
For v1, v2 ∈K and h1, h2 : [a, b] →Y ,
Z b
a
f·d(v1h1 + v2h2) = v1
Z b
a
f·dh1 + v2
Z b
a
f·dh2,
where again the left side exists provided the right side does.
III. For a < c < b, ∫b
a f·dh exists if and only if both ∫c
a f·dh and ∫b
c f·dh exist,
and then
Z b
a
f·dh =
Z c
a
f·dh +
Z b
c
f·dh.
(2.71)
IV. If a < b and ∫b
a f·dh exists then for each t ∈[a, b], taking a limit for
s ∈[a, b] if t = a or b, I(t) = I(f, dh)(t) := ∫t
a f·dh exists and
lim
s→t
n
I(t) −I(s) −f(t)·[h(t) −h(s)]
o
= 0.
(2.72)
Properties I and II imply that the operator V ×W ∋(f, h) 7→∫b
a f·dh ∈Z
is bilinear for any function spaces V, W on which it is deﬁned. If property
IV holds, the indeﬁnite integral I(f, dh)(t), t ∈[a, b], is a regulated function
whenever the integrator h is regulated, and then
∆−I(t) = f(t)·∆−h(t)
and
∆+I(s) = f(s)·∆+h(s)
for
a ≤s < t ≤b.
Theorem 2.72. The RS, RRS, RYS, S, CY , HK and
R
= integrals satisfy
properties I and II.
Proof. We prove only property I because the proof of property II is symmetric.
We can assume that a < b. Let u1, u2 ∈K, f1, f2 : [a, b] →X, and h: [a, b] →
Y . For the RS, RRS, and HK integrals, property I follows from bilinearity
of the mapping (f, h) 7→f·h from X × Y to Z, and from the equality
SRS(u1f1 + u2f2, dh; τ) = u1SRS(f1, dh; τ) + u2SRS(f2, dh; τ),
valid for any tagged partition τ of [a, b]. The same argument with Riemann–
Stieltjes sums replaced by Young–Stieltjes sums (2.16) implies property I for
the YS integral, and so it holds for the full Stieltjes S integral. Also, property
I holds for the
R
= integral by Proposition 2.27.
For the CY integral given by the Y1 integral (2.44), let f1, f2 be regulated
functions. On the interval [a, b), we have (u1f1 + u2f2)+ = u1(f1)+ + u2(f2)+
and ∆+(u1f1 + u2f2) = u1∆+f1 + u2∆+f2. Property I for the CY integral
follows, since it holds for the RRS integral and by the linearity of uncondi-
tionally convergent sums. The proof of Theorem 2.72 is complete.
2
Theorem 2.73. The RRS, RYS, S, CY , HK, and
R
= integrals satisfy prop-
erty III.

2.8 Properties of Integrals
73
Proof. Let a < c < b and let f : [a, b] →X and h: [a, b] →Y . Suppose
that (RRS) ∫c
a f·dh and (RRS) ∫b
c f·dh exist. For a tagged partition τ1 =
({xi}n
i=0, {ti}n
i=1) of [a, c] and a tagged partition τ2 = ({yj}m
j=0, {si}m
j=1) of
[c, b], let τ := ({xi}n
i=0 ∪{yj}m
j=1, {ti}n
i=1 ∪{sj}m
j=1), a tagged partition of
[a, b]. Then the equality
SRS(f, dh; τ) = SRS(f, dh; τ1) + SRS(f, dh; τ2)
(2.73)
yields that (RRS) ∫b
a f·dh exists and (2.71) holds for the RRS integral. For
the converse suppose that (RRS) ∫b
a f·dh exists. Applying the Cauchy test for
pairs of tagged partitions τ ′ and τ ′′ of [a, b] which are reﬁnements of {a, c, b}
and induce the same tagged partition of [c, b], it follows that (RRS) ∫c
a f·dh
exists. Likewise (RRS) ∫b
c f·dh exists. The proof of property III for the RRS
integral is complete.
The proof of property III for the RYS integral is the same except that the
equality
SYS(f, dh; τ) = SYS(f, dh; τ1) + SYS(f, dh; τ2)
for Young tagged partitions as in (2.16) is used instead of (2.73). Thus prop-
erty III also holds for the
R
= integral by Proposition 2.27. Since property III
holds for the RRS and RYS integrals it also holds for the full Stieltjes inte-
gral (S) ∫b
a f·dh by deﬁnition 2.41 of the (S) integral and since f and h have
a common one-sided discontinuity on [a, b] if and only if they also have one
on at least one of [a, c] or [c, b].
Since property III for the HK integral is proved by Proposition 2.56, it
is left to prove property III for the CY integral. To this aim suppose that
functions f, h are regulated and that the Y1 integral (Y1) ∫b
a f·dh exists. By
the same property for the RRS integral already proved, it follows that the
following three integrals exist and
(RRS)
Z b
a
f (b)
+ ·dh(a)
−= (RRS)
Z c
a
f+·dh(a)
−+ (RRS)
Z b
c
f (b)
+ ·dh−.
On the right side the integrand f+ over [a, c] depends on f(c+) and the integra-
tor h−over [c, b] depends on h(c−). For the two integrals (RRS) ∫c
a f+·dh(a)
−
and (RRS) ∫c
a f (c)
+ ·dh(a)
−, the diﬀerence between Riemann–Stieltjes sums for
each based on the same tagged partition τ = ({ti}n
i=0, {si}n
i=1) of [a, c] is
f(sn+)·[h(tn−) −h(tn−1−)] −f (c)
+ (sn)·[h(tn−) −h(tn−1−)]
= ∆+f(tn)·[h(tn−) −h(tn−1−)]
if sn = tn or is 0 if sn ∈[tn−1, tn). Taking a limit under reﬁnement of tagged
partitions of [a, c], we can get tn−1 ↑tn = c, and so h(tn−) −h(tn−1−) →0,
while f is bounded. Therefore the following two integrals both exist and are
equal:

74
2 Extended Riemann–Stieltjes Integrals
(RRS)
Z c
a
f+·dh(a)
−= (RRS)
Z c
a
f (c)
+ ·dh(a)
−.
Next, for the two integrals (RRS) ∫b
c f (b)
+ ·dh−and (RRS) ∫b
c f (b)
+ ·dh(c)
−, the
diﬀerence between Riemann–Stieltjes sums for each based on the same tagged
partition τ = ({ti}n
i=0, {si}n
i=1) of [c, b] is
f(s1+)·[h(t1−) −h(c−)] −f(s1+)·[h(t1−) −h(c)]
= f(s1+)·∆−h(c) →f(c+)∆−h(c)
as t1 ↓t0 = c, which one can obtain by taking a limit under reﬁnements of
tagged partitions of [c, b]. Therefore the following two integrals both exist and
the equation
(RRS)
Z b
c
f (b)
+ ·dh−= (RRS)
Z b
c
f (b)
+ ·dh(c)
−+ f(c+)∆−h(c)
holds. By the deﬁnition of the Y1 integral (2.44), it then follows that the Y1
integral exists over the subintervals [a, c] and [c, b], and we have
(Y1)
Z b
a
f·dh = (RRS)
Z c
a
f+·dh(a)
−+ (RRS)
Z b
c
f (b)
+ ·dh−
−[∆+f·∆+h](a) −
X
(a,c)
∆+f·∆±h −[∆+f·∆±h](c)
−
X
(c,b)
∆+f·∆±h + [f·∆−h](b)
= (RRS)
Z c
a
f (c)
+ ·dh(a)
−−[∆+f·∆+h](a) −
X
(a,c)
∆+f·∆±h + [f∆−h](c)
+(RRS)
Z b
c
f (b)
+ ·dh(c)
−−[∆+f·∆+h](c) −
X
(c,b)
∆+f·∆±h + [f∆−h](b)
= (Y1)
Z c
a
f·dh + (Y1)
Z b
c
f·dh.
The converse implication follows by applying the same arguments, and so
property III holds for the CY integral. The proof of Theorem 2.73 is complete.
2
The Riemann–Stieltjes integral does not satisfy property III. Indeed, for
the indicator functions f := 1[1,2] and h := 1(1,2] deﬁned on [0, 2], the RS
integral exists over the intervals [0, 1] and [1, 2], but not over the interval
[0, 2]. Notice that f and h for this example have a common discontinuity
at 1 ∈[0, 2]. This feature of the Riemann–Stieltjes integral was observed by
Pollard [187], who also showed that the reﬁnement Riemann–Stieltjes integral
does satisfy property III. A weaker form of this property can be stated as
follows:

2.8 Properties of Integrals
75
III′. For a < c < b, if ∫b
a f·dh exists then both ∫c
a f·dh and ∫b
c f·dh exist, and
(2.71) holds.
Then we have the following result:
Proposition 2.74. The RS integral satisﬁes property III′.
Proof. Suppose that (RS) ∫b
a f·dh exists and let a < c < b. Adjoining equal
tagged subintervals of [c, b] to any two given tagged partitions τ ′
1, τ ′
2 of [a, c],
one can form two tagged partitions τ1, τ2 of [a, b], without increasing |τ ′
1|∨|τ ′
2|,
and such that SRS(τ ′
1) −SRS(τ ′
2) = SRS(τ1) −SRS(τ2). Thus one can apply
the Cauchy test to prove the existence of (RS) ∫c
a f·dh. Similarly one can show
that (RS) ∫b
c f·dh also exists. The additivity relation (2.71) then follows from
the equality SRS((κ, ξ)) = SRS((κ′, ξ′)) + SRS((κ′′, ξ′′)), valid for any tagged
partitions such that κ = κ′ ∪κ′′, ξ = ξ′ ∪ξ′′, and κ′, κ′′ are partitions of [a, c]
and [c, b] respectively.
2
Theorem 2.75. The RS, RRS, RYS, and HK integrals satisfy property IV.
Proof. Suppose that (RS) ∫b
a f·dh exists. The indeﬁnite integral IRS(u) :=
(RS) ∫u
a f·dh is deﬁned for u ∈(a, b] by Proposition 2.74 and is 0 when u =
a by the deﬁnition of the RS integral. Also by Proposition 2.74, we have
IRS(u) −IRS(v) = sgn (u −v)(RS) ∫u∨v
u∧v f·dh. In light of symmetry of proofs,
we prove only that
lim
v↑u
n
(RS)
Z u
v
f·dh −SRS(f, dh; σv)
o
= 0
(2.74)
for any a < u ≤b, where for a < v < u, σv is the tagged partition ({v, u}, {u})
of [v, u]. Let u ∈(a, b]. Given ǫ > 0 there is a δ ∈(0, u −a] such that any
two Riemann–Stieltjes sums based on tagged partitions of [a, u] with mesh
less than δ diﬀer by at most ǫ. For u −δ ≤v < u, choose a Riemann–Stieltjes
sum SRS(τv) = SRS(f, dh; τv), based on a tagged partition τv of [v, u], within
ǫ of (RS) ∫u
v f·dh. Let τ ′ and τ ′′ be two tagged partitions of [a, u] with mesh
less than δ which are equal when restricted to [a, v] and which coincide with
τv and σv, respectively, when restricted to [v, u]. Then
(RS)
Z u
v
f·dh −SRS(f, dh; σv)

≤
(RS)
Z u
v
f·dh −SRS(τv)
 +
SRS(τ ′) −SRS(τ ′′)

(2.75)
< 2ǫ
for each v with u −δ ≤v < u. Since ǫ > 0 is arbitrary, (2.74) holds, proving
property IV for the RS integral.

76
2 Extended Riemann–Stieltjes Integrals
If (RRS) ∫b
a f·dh exists, we argue similarly. To prove (2.74) with RRS
instead of RS, let ǫ > 0. Then there is a partition λ = {tj}m
j=0 of [a, u]
such that any two Riemann–Stieltjes sums based on tagged reﬁnements of λ
diﬀer by at most ǫ. For v ∈[tm−1, u), choose a Riemann–Stieltjes sum, based
on a tagged partition τv of [v, u], within ǫ of (RRS) ∫u
v f·dh. Let τ ′ and τ ′′
be two tagged reﬁnements of λ which coincide with τv and σv, respectively,
when restricted to [v, u]. Then (2.75) with RRS instead of RS holds for each
v ∈[tm−1, u), proving property IV for the RRS integral.
Suppose now that (RYS) ∫b
a f·dh exists. Let u ∈(a, b], and for a < v < u,
let σv be a Young tagged partition of the form ({v, u}, {s}) of [v, u]. Since h
is regulated by deﬁnition of the RYS integral, we have
lim
v↑u
n
SYS(f, dh; σv) −f(u)·[h(u) −h(v)]
o
= lim
v↑u
n
[f(s) −f(u)]·[h(u−) −h(v+)] + [f(v) −f(u)]·∆+h(v)
o
= 0.
Therefore and by property III again, we have to show that
lim
v↑u
n
(RYS)
Z u
v
f·dh −SYS(f, dh; σv)
o
= 0.
The proof is the same as for the RRS integral except that Riemann–Stieltjes
sums are replaced by Young–Stieltjes sums. Since property IV for the HK
integral follows from Proposition 2.58, the proof of Theorem 2.75 is complete.
2
Property IV for the HK integral agrees with the “only if” part of Propo-
sition 2.58, which says that existence of the HK integral implies existence of
improper versions. The following shows that the “if” part of Proposition 2.58
does not hold for the RRS integral, for the RYS integral by Propositions 2.18
and 2.46, nor for the CY integral by its deﬁnition.
Proposition 2.76. There are continuous real-valued functions f, h on [0, 1]
such that limt↑1(RRS) ∫t
0 f dh exists, but (RRS) ∫1
0 f dh does not.
Proof. Let sm := 1 −1/m for m = 1, 2, . . . . For each m, let f(s4m−2) =
f(s4m) := 0, f(s4m−1) := m−1/2, f(0) = f(1) := 0, and let f be linear and
continuous on intervals between adjacent points where it has been deﬁned.
Let h(s4m−3) := 0, so h(0) = 0, h(s4m−2) = h(s4m) := m−1/2, h(1) := 0, and
let h also be linear between adjacent points where it has been deﬁned. Then
f and h are both continuous. Since h is constant on each interval where f is
non-zero, we have for 0 < t < 1 that (RRS) ∫t
0 f dh = 0, taking a partition
containing t and all points sm < t.
But for any partition κ = {ti}n
i=0 of [0, 1], there exist arbitrarily large
Riemann–Stieltjes sums for f, h based on reﬁnements of κ, as follows. Let m0

2.8 Properties of Integrals
77
be the smallest m such that s4m−3 > tn−1. Form a partition κN by adjoining
to κ all points s4m−3, s4m for m = m0, m0+1, . . . , m0+N, and form Riemann–
Stieltjes sums containing terms f(s4m−1)[h(s4m) −h(s4m−3)] = 1/m for all
such m, and 0 terms f(s4m)[h(s4m+1) −h(s4m)]. As N →∞these sums
become arbitrarily large, as claimed.
2
The following fact is a change of variables formula for the full Stieltjes
integral.
Proposition 2.77. Let φ: [a, b] →R be a strictly monotone continuous func-
tion with range [c, d] := ran (φ). Assuming (1.14), let f : [c, d] →X and
h: [c, d] →Y . Then (S) ∫b
a(f◦φ)·d(h◦φ) exists if and only if (S) ∫d
c f·dh does,
and
(S)
Z b
a
(f◦φ)·d(h◦φ) =
(
(S)
R d
c f·dh
if φ is increasing,
−(S)
R d
c f·dh if φ is decreasing.
Proof. We can assume that a < b. First suppose that φ is increasing. The
inverse function φ−1 of φ is also continuous and increasing from [c, d] onto
[a, b]. Therefore for the two integrals the limits under reﬁnement of partitions
both exist or not simultaneously, and if they do exist they are equal, proving
the ﬁrst part of the proposition.
Now suppose that φ is decreasing on [a, b]. Then letting θ(x) := −x for
x ∈[−b, −a], it follows that eφ := φ◦θ is an increasing continuous function
on [−b, −a]. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition of [a, b]. Then
eτ := ({−tn−i}n
i=0, {−sn−i}n−1
i=0 ) is a tagged partition of [−b, −a] and
SRS(f◦φ, dh◦φ; τ) = −SRS(f◦eφ, dh◦eφ; eτ).
Also, if σ is a tagged reﬁnement of τ then eσ is a tagged reﬁnement of eτ. Thus
(RRS)
Z b
a
f◦φ·dh◦φ = −(RRS)
Z −a
−b
f◦eφ·dh◦eφ,
where the two integrals exist or not simultaneously. Now applying the ﬁrst
part of the proposition to the integral on the right side, it follows that
(RRS)
Z −a
−b
f◦eφ·dh◦eφ = (RRS)
Z φ(a)
φ(b)
f·dh,
provided either integral is deﬁned. The same is true for reﬁnement Young–
Stieltjes integrals, proving the proposition.
2
Next is a fact which allows interchange of integration with a linear map
for a scalar-valued integrator.

78
2 Extended Riemann–Stieltjes Integrals
Proposition 2.78. Let K be either the ﬁeld R or the ﬁeld C, and let L be
a bounded linear mapping from a Banach space X to another Banach space
Z. For f : [a, b] →X and h: [a, b] →K, if (RS) ∫b
a f·dh exists then so does
(RS) ∫b
a(L◦f)·dh and
L

(RS)
Z b
a
f·dh

= (RS)
Z b
a
(L◦f)·dh.
(2.76)
Proof. We can assume that a < b. For any tagged partition τ of [a, b], we have
L
 SRS(f, dh; τ)

= SRS(L◦f, dh; τ).
Since L is continuous, if (RS) ∫b
a f·dh exists then the right side has a limit as
the mesh of τ tends to zero and (2.76) holds, proving the proposition.
2
Next it will be seen that the previous proposition does not extend to cases
where both the integrand and integrator have multidimensional values, for
any integral we consider.
Example 2.79. Let X = Y = R2, let Z = R, and let the bilinear form
from X × Y into Z be the usual inner product. Let g and h be any real-
valued functions on [0, 1] and ν any real-valued interval function on [0, 1]. Let
f(t) := (g(t), 0) ∈R2 and H(t) := (0, h(t)) ∈R2 for any t ∈[0, 1]. For any
interval J ⊂[0, 1] let µ(J) := (0, ν(J)) ∈R2. Let L(x, y) := (y, x) for each
(x, y) ∈R2. Then for each form of integration we have deﬁned, the integrals
∫f·dH and ∫f·dµ exist and are 0, where ∫= ∫1
0 or ∫[0,1], but the integrals
∫(L◦f)·dH and ∫(L◦f)·dµ may not exist, or may exist with any value.
For all the integrals ∫b
a f·dg deﬁned so far and properties proved for them,
we have the symmetrical properties of integrals ∫b
a df·g by (1.15).
Integration by parts
We start with the classical integration by parts formula for the Riemann–
Stieltjes and reﬁnement Riemann–Stieltjes integrals.
Theorem 2.80. Assuming (1.14), let f : [a, b] →X and g: [a, b] →Y . For
# = RS or # = RRS, if (#) ∫b
a f·dg exists then so does (#) ∫b
a df·g, and
(#)
Z b
a
f·dg + (#)
Z b
a
df·g = f(b)·g(b) −f(a)·g(a) =: f·g
b
a.
(2.77)
Proof. We can assume that a < b. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged
partition of [a, b], and let s0 := t0 = a, sn+1 := tn = b. Summing by parts, we
have

2.8 Properties of Integrals
79
n
X
i=1

f(ti) −f(ti−1)

·g(si) = f·g
tn
t0 −
n
X
i=0
f(ti)·

g(si+1) −g(si)

.
(2.78)
For # = RS, notice that if maxi(ti −ti−1) < δ for some δ > 0, then
maxi(si+1 −si) < 2δ. Therefore if (RS) ∫b
a f·dg exists then by (2.78) and
(1.15), (RS) ∫b
a df·g exists and (2.77) holds for # = RS.
For # = RRS, notice that the sum on the right side of (2.78) can be
written as the sum
n
X
i=0
n
f(ti)·

g(si+1) −g(ti)

+ f(ti)·

g(ti) −g(si)
o
=: S.
Thus if {ti}n
i=0 is a reﬁnement of a partition λ of [a, b] then S is a Riemann–
Stieltjes sum based on a tagged reﬁnement of λ. Hence if (RRS) ∫b
a f·dg exists
then by (2.78) and (1.15), (RRS) ∫b
a df·g exists and (2.77) holds for # = RRS.
The proof is complete.
2
Next is an integration by parts formula for the central Young integral as
deﬁned in Section 2.5.
Theorem 2.81. Assuming (1.14), let f ∈R([a, b]; X) and g ∈R([a, b]; Y ).
If a < b, suppose that at least one of the conditions (a) or (b) holds:
(a) the sums P
(a,b) ∆+f·∆+g and P
(a,b) ∆−f·∆−g converge unconditionally
in Z;
(b) on (a, b), f = [f−+ f+]/2 and g = [g−+ g+]/2.
If (CY ) ∫b
a f·dg exists then so does (CY ) ∫b
a df·g, and
(CY )
Z b
a
f·dg + (CY )
Z b
a
df·g = f·g
b
a + A,
(2.79)
where A = 0 if a = b and otherwise A = −

∆+f·∆+g

(a)+

∆−f·∆−g

(b)+B
with
B :=
 −P
(a,b) ∆+f·∆+g + P
(a,b) ∆−f·∆−g
if (a) holds
0
if (b) holds.
Proof. We can assume that a < b. By the deﬁnitions of the CY integral (2.51)
and the Y1 integral (2.44),
(CY )
Z b
a
f·dg = (RRS)
Z b
a
f (b)
+ ·dg(a)
−
−

∆+f·∆+g

(a) +

f·∆−g

(b) −
X
(a,b)
∆+f·∆±g,

80
2 Extended Riemann–Stieltjes Integrals
where the RRS integral exists and the sum converges unconditionally in Z. If
(a) holds, by linearity of unconditional convergence, the sum P
(a,b) ∆±f·∆−g
converges unconditionally in Z, and
X
(a,b)
∆±f·∆−g −
X
(a,b)
∆+f·∆±g =
X
(a,b)
∆−f·∆−g −
X
(a,b)
∆+f·∆+g.
(2.80)
If (b) holds, since “·” is bilinear,
∆+f·∆±g = ∆+f·(2∆−g) = (2∆+f)·∆−g = ∆±f·∆−g.
Thus again the sum P
(a,b) ∆±f·∆−g converges unconditionally in Z, and
X
(a,b)
∆±f·∆−g =
X
(a,b)
∆+f·∆±g.
(2.81)
Also, in case (a) or (b) the integration by parts theorem for the RRS integral
(Theorem 2.80 with # = RRS) yields that (RRS) ∫b
a df (b)
+ ·g(a)
−
exists and
(RRS)
Z b
a
f (b)
+ ·dg(a)
−+ (RRS)
Z b
a
df (b)
+ ·g(a)
−
= f (b)
+ ·g(a)
−
b
a
(2.82)
= f(b)·g(b−) −f(a+)·g(a).
Hence by deﬁnition of the Y2 integral (2.45), (CY ) ∫b
a df·g exists and
(CY )
Z b
a
df·g = (RRS)
Z b
a
df (b)
+ ·g(a)
−
+

∆+f·g

(a) +

∆−f·∆−g

(b) +
X
(a,b)
∆±f·∆−g.
Then by (2.80) in case (a) or (2.81) in case (b), it follows that
(CY )
Z b
a
f·dg + (CY )
Z b
a
df·g = (RRS)
Z b
a
f (b)
+ ·dg(a)
−+ (RRS)
Z b
a
df (b)
+ ·g(a)
−
+f·g
b
a −f(b)·g(b−) + f(a+)·g(a)
−

∆+f·∆+g

(a) +

∆−f·∆−g

(b) + A.
This together with (2.82) implies formula (2.79), proving the theorem.
2
For the reﬁnement Young–Stieltjes integral, an integration by parts theo-
rem analogous to the preceding one does not hold. Recall that by Proposition
2.52 there are real-valued functions f and h on [0, 1], where f is in c0((0, 1))
and h is continuous, for which (CY ) ∫1
0 f dh exists, while (RYS) ∫1
0 f dh does
not exist. For this pair of functions, (RYS) ∫1
0 h df exists and equals 0 because
f (0)
−
≡f (1)
+
≡0, and P ∆+f∆+h = P ∆−f∆−h = 0 since h is continuous.
However, by Theorem 2.51(a) and Theorem 2.81, we have the following corol-
lary:

2.8 Properties of Integrals
81
Corollary 2.82. Under the conditions of Theorem 2.81, if (RYS) ∫b
a f·dg and
(RYS) ∫b
a df·g both exist then (2.79) with CY replaced by RYS holds.
For a regulated function f on [a, b] with a < b and ˆf := [f (a,b)
−
+ f (a,b)
+
]/2,
we have
X
(a,b)

f −ˆf

·∆±g +
X
(a,b)
∆±f·

g −ˆg

= −
X
(a,b)
∆+f·∆+g +
X
(a,b)
∆−f·∆−g,
provided that the sums converge unconditionally. Therefore by Theorem
2.51(b) and Theorem 2.81, the following form of integration by parts for the
reﬁnement Young–Stieltjes integral holds:
Corollary 2.83. Assuming (1.14) and a < b, let f
∈R([a, b]; X) and
g ∈R([a, b]; Y ) be such that at least one of the two conditions (a) and (b)
of Theorem 2.81 holds. If either (CY ) ∫b
a f·dg or (CY ) ∫b
a df·g exists then
(RYS) ∫b
a ˆf·dg and (RYS) ∫b
a df·ˆg both exist, and
(RYS)
Z b
a
ˆf·dg + (RYS)
Z b
a
df·ˆg = f·g
b
a −

∆+f·∆+g

(a) +

∆−f·∆−g

(b),
(2.83)
where ˆf = f and ˆg = g if the condition (b) of Theorem 2.81 holds.
Bounds for integrals
Here we give bounds for integrals assuming that either the integrand or inte-
grator has bounded variation.
Theorem 2.84. Assuming (1.14), f : [a, b] →X, and h: [a, b] →Y , we have
(a) if f is regulated and h is of bounded variation then the full Stieltjes integral
(S) ∫b
a f·dh is deﬁned and for each t ∈[a, b],
(S)
Z b
a
f·dh −f(t)·[h(b) −h(a)]
 ≤Osc(f; [a, b])v1(h; [a, b]);
(2.84)
(b) if h is regulated and f is of bounded variation then the full Stieltjes integral
(S) ∫b
a f·dh is deﬁned and for each t ∈[a, b],
(S)
Z b
a
f·dh −f(t)·[h(b) −h(a)]
 ≤Osc(h; [a, b])v1(f; [a, b]).
(2.85)
Proof. We can assume that a < b. In both cases if f and h have no common
discontinuities then the integral ∫b
a f·dh exists in the Riemann–Stieltjes sense
by Theorems 2.42 and 2.17. If f and h have no common one-sided discontinu-
ities then the integral ∫b
a f·dh exists in the reﬁnement Riemann–Stieltjes sense
by Theorem 2.17. Under the assumptions of the present theorem the integral

82
2 Extended Riemann–Stieltjes Integrals
∫b
a f·dh always exists in the reﬁnement Young–Stieltjes sense by Theorem 2.20,
and so the full Stieltjes integral (S) ∫b
a f·dh is deﬁned.
To prove (a) it then suﬃces to prove it for the reﬁnement Young–Stieltjes
integral. Letting τ = ({ti}n
i=0, {si}n
i=1) be a Young tagged partition of [a, b]
and t ∈[a, b], we have the bound
SYS(f, dh; τ) −f(t)·[h(b) −h(a)]

≤

n
X
i=0
[f(ti) −f(t)]·(∆±
[a,b]h)(ti)
 +

n
X
i=1
[f(si) −f(t)]·[h(ti−) −h(ti−1+)]
.
For each i = 1, . . . , n, letting ui−1 ↓ti−1 and vi ↑ti, one can approximate
∆+h(a) by h(u0) −h(a), ∆−h(b) by h(b) −h(vn), ∆±h(ti) by h(ui) −h(vi)
for i = 1, . . . , n −1 and h(ti−) −h(ti−1+) by h(vi) −h(ui−1) for i = 1, . . . , n.
For an arbitrary ǫ > 0, this gives the further bound
≤ǫ+ max
0≤i≤n ∥f(ti)−f(t)∥

∥h(u0)−h(a)∥+∥h(b)−h(vn)∥+
n−1
X
i=1
∥h(ui)−h(vi)∥

+ max
1≤i≤n ∥f(si) −f(t)∥
n
X
i=1
∥h(vi) −h(ui−1)∥≤ǫ + Osc(f; [a, b])v1(h; [a, b]).
Since ǫ > 0 is arbitrary, the limit under reﬁnements of Young tagged partitions
gives the bound (2.84) for the reﬁnement Young–Stieltjes integral, proving (a).
As in (a), it will suﬃce to prove (b) only for the reﬁnement Young–
Stieltjes integral. Let τ = ({ti}n
i=0, {si}n
i=1) be a Young tagged partition
of [a, b]. For j = 1, . . . , 2n, let ∆jf := f(uj) −f(uj−1) with {uj}2n
j=0 =
{t0, s1, t1, . . . , sn, tn} and let {vj}2n
j=1 := {t0+, t1−, t1+, . . . , tn−}. Summation
by parts gives
SYS(f, dh; τ) = f(b)·h(b) −f(a)·h(a) −
2n
X
j=1
∆jf·h(vj−1).
Adding to and subtracting from the right side ﬁrst f(b)·h(a) and then
f(a)·h(b), we get two representations
SYS(f, dh; τ) = f(b)·[h(b) −h(a)] −
2n
X
j=1
∆jf·[h(vj−1) −h(a)]
= f(a)·[h(b) −h(a)] −
2n
X
j=1
∆jf·[h(vj−1) −h(b)].
(2.86)
Thus for t ∈{a, b}, we have the bound
SYS(f, dh; τ) −f(t)·[h(b) −h(a)]
 ≤Osc(h; [a, b])v1(f; [a, b]).
(2.87)

2.8 Properties of Integrals
83
Since τ is an arbitrary Young tagged partition of [a, b], (2.85) holds if t ∈{a, b}.
Suppose that t ∈(a, b) and let t = tν for some ν ∈{1, . . . , n −1}. Then
τ1 := ({ti}ν
i=0, {si}ν
i=1) and τ2 := ({ti}n
ν, {si}n
ν+1) are Young tagged partitions
of [a, t] and [t, b] respectively. Applying the ﬁrst representation in (2.86) to τ1
and the second representation to τ2, it follows that
SYS(f, dh; τ) = SYS(f, dh; τ1) + SYS(f, dh; τ2)
= f(t)·[h(b) −h(a)] −
ν
X
i=1
∆jf·[h(vj−1) −h(a)]
−
n
X
i=ν+1
∆jf·[h(vj−1) −h(b)],
and so (2.87) holds for any t ∈(a, b) and any τ containing t as a partition
point. Thus (2.85) holds for any t ∈[a, b]. The proof of Theorem 2.84 is
complete.
2
Corollary 2.85. Under the assumptions of the preceding theorem, the indef-
inite full Stieltjes integral IS(f, dh)(t) := (S) ∫t
a f·dh, t ∈[a, b], is deﬁned and
has bounded variation.
Proof. We can assume a < b. The indeﬁnite Riemann–Stieltjes integral exists
by the preceding theorem and property III′ (see Proposition 2.74). The indef-
inite reﬁnement Riemann–Stieltjes and Young–Stieltjes integrals exist by the
preceding theorem and property III (see Theorem 2.73). Let κ = {ti}n
i=0 be
a partition of [a, b]. Then using additivity of the three integrals proved as the
already mentioned properties III′ and III, we get the bound
s1(IS(f, dh); κ) ≤
n
X
i=1
(S)
Z ti
ti−1
f·dh −f(ti−1)·[h(ti) −h(ti−1)]

+
n
X
i=1
∥f(ti−1)∥∥h(ti) −h(ti−1)∥
≤

Osc(f; [a, b]) + ∥f∥sup

v1(h; [a, b]),
completing the proof of the corollary.
2
A substitution rule
Here is a substitution rule for the Riemann–Stieltjes integrals with integrators
having bounded variation.

84
2 Extended Riemann–Stieltjes Integrals
Proposition 2.86. For a Banach space X, let h ∈W1[a, b], g ∈R([a, b]; X),
and f ∈R[a, b] be such that the two pairs (h, g) and (h, f) have no common
discontinuities, and gf : [a, b] →X is the function deﬁned by pointwise mul-
tiplication. Then the following Riemann–Stieltjes integrals (including those in
integrands) are deﬁned and
(RS)
Z b
a
dIRS(g, dh)·f = (RS)
Z b
a
gf·dh = (RS)
Z b
a
g·dIRS(dh, f),
(2.88)
where IRS(g, dh)(t) := (RS)
R t
a g·dh ∈X and IRS(dh, f)(t) := (RS)
R t
a f dh
for t ∈[a, b], and · denotes the natural bilinear mapping X × R →X.
Proof. We can assume that a < b. Since the pairs (g, h) and (f, h) have
no common discontinuities, the indeﬁnite integrals IRS(g, dh) and IRS(dh, f)
exist and are in W1([a, b]; X) and W1[a, b], respectively, by Corollary 2.85.
Since the discontinuities of IRS(g, dh) and IRS(dh, f) are subsets of those
of h, and so the pairs (IRS(g, dh), f) and (g, IRS(dh, f) have no common
discontinuities, the leftmost and the rightmost integrals in (2.88) exist by the
same corollary. Since gf is a regulated function on [a, b] and the pair (gf, h)
have no common discontinuities, the middle integral in (2.88) exists by the
same corollary. We prove only the ﬁrst equality in (2.88), since the proof of
the second one is symmetric. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition
of [a, b]. Then
SRS(dIRS(g, dh), f; τ) −SRS(gf, dh; τ)∥≤∥f∥supR(τ),
where
R(τ) :=
n
X
i=1
(RS)
Z ti
ti−1
g·dh −g(si)·

h(ti) −h(ti−1)
.
It is enough to prove that
lim
|τ|↓0 R(τ) = 0.
(2.89)
Let ǫ > 0. By Theorem 2.1, there exists a point partition {zj}m
j=0 of [a, b] such
that
Osc(g; (zj−1, zj)) < ǫ
for j ∈{1, . . . , m}.
(2.90)
Let a ≤u ≤zj ≤v ≤b for some j. Splitting the interval [u, v] into the parts
[u, zj] and [zj, v] if zj is not an endpoint of [u, v], and then applying properties
III′ and IV for the Riemann–Stieltjes integral (see respectively Proposition
2.74 and Theorem 2.75), we have that
(RS)
Z v
u
g·dh −g(zj)·[h(v) −h(u)]

is small provided v −u is small enough. Therefore and since g and h have
no common discontinuities, there exists a δ > 0 such that if zj ∈[ti−1, ti] for
some j and mesh |τ| < δ, then

2.8 Properties of Integrals
85
(RS)
Z ti
ti−1
g·dh −g(si)·[h(ti) −h(ti−1)]

≤
(RS)
Z ti
ti−1
g·dh −g(zj)·[h(ti) −h(ti−1)]

+
[g(zj) −g(si)]·[h(ti) −h(ti−1)]
 < ǫ/(m + 1).
This together with (2.90) and the bound of Theorem 2.84 yields
R(τ) ≤ǫv1(h; [a, b]) + (m + 1)ǫ/(m + 1) = ǫ

v1(h; [a, b]) + 1

if the mesh of the tagged partition τ is less than δ. The proof of (2.89), and
hence of Theorem 2.86, is complete.
2
A chain rule formula
Here we give a representation of the full Stieltjes integral as deﬁned in Deﬁni-
tion 2.41, with respect to a composition F◦f, where f has bounded variation
and F is smooth.
Theorem 2.87. Let f : [a, b] →Rd be of bounded variation, let F be a real-
valued C1 function on Rd and let h ∈R[a, b]. Then the composition F◦f is
of bounded variation and
(S)
Z b
a
h d(F◦f) = (S)
Z b
a
h
 ∇F◦f

·df +
X
(a,b]
h
n
∆−(F◦f) −
 ∇F◦f

·∆−f
o
+
X
[a,b)
h
n
∆+(F◦f) −
 ∇F◦f

·∆+f
o
,
(2.91)
where the two sums converge absolutely if a < b and equal 0 if a = b.
Proof. We can assume that a < b. Since F is a Lipschitz function on any
bounded set (the range of f), F◦f is of bounded variation. Thus the two full
Stieltjes integrals in (2.91) exist by Theorems 2.20, 2.17, and 2.42. Again since
F is Lipschitz and ∇F is bounded on the range of f, the two sums in (2.91)
converge absolutely. By Propositions 2.13 and 2.18, it is enough to prove the
equality (2.91) for the RYS integrals. Let τ = ({ti}n
i=0, {si}n
i=1) be a Young
tagged partition of [a, b]. Also let
S−(τ) :=
X
{t1,...,tn}
h
n
∆− F◦f

−
 ∇F◦f

·∆−f
o
and
S+(τ) :=
X
{t0,...,tn−1}
h
n
∆+ F◦f

−
 ∇F◦f

·∆+f
o
.

86
2 Extended Riemann–Stieltjes Integrals
Then we have the identity
SYS(h, dF◦f; τ) = SYS(h
 ∇F◦f

, df; τ) + S−(τ) + S+(τ) + R(τ),
(2.92)
where R(τ) is the sum
n
X
i=1
h(si)
n
F(f(ti−)) −F(f(ti−1+))

−
 ∇F(f(si))

·

f(ti−) −f(ti−1+)
o
.
Let ǫ > 0 and let B be a ball in Rd containing the range of f. Since ∇F is
uniformly continuous on B, there is a δ > 0 such that ∥∇F(u) −∇F(v)∥< ǫ
whenever ∥u −v∥< δ and u, v ∈B. Moreover, since f is regulated, by
Theorem 2.1(b), there exists a partition λ = {zj}m
j=0 of [a, b] such that
Osc(f; (zj−1, zj)) < δ for j = 1, . . . , m. Let τ be a Young tagged reﬁne-
ment of λ. Then for each i = 1, . . . , n, by the mean value theorem for
λ 7→F(λf(ti−) + (1 −λ)f(ti−1+)), 0 ≤λ ≤1, and by the chain rule of
diﬀerentiation there is a λi ∈[0, 1] such that
F(f(ti−)) −F(f(ti−1+)) = ∇F(θi)·

f(ti−) −f(ti−1+)

,
where θi := λif(ti−) + (1 −λi)f(ti−1+). Thus
R(τ)
 ≤
n
X
i=1
|h(si)|
∇F(θi) −∇F(f(si))
 f(ti−) −f(ti−1+)

≤ǫ∥h∥sup
n
X
i=1
f(ti−) −f(ti−1+)
 ≤ǫ∥h∥supv1(f; [a, b]).
Since each of the four other sums in (2.92) converges under reﬁnements of
partitions to the respective four terms in (2.91), the stated equality (2.91)
holds, proving the theorem.
2
Taking the C1 function F deﬁned by F(u, v) := uv, u, v ∈R, we obtain
from the preceding theorem:
Corollary 2.88. Let f, g be two real-valued functions on [a, b] having bounded
variation, and let h ∈R[a, b]. Then the product function fg has bounded
variation, and
(S)
Z b
a
h d(fg) = (S)
Z b
a
hf dg + (S)
Z b
a
hg df
−
X
(a,b]
h∆−f∆−g +
X
[a,b)
h∆+f∆+g,
(2.93)
where the two sums converge absolutely if a < b and equal 0 if a = b.

2.9 Relations between Integrals
87
Proof. We can assume that a < b. The two full Stieltjes integrals on the right
side of (2.93) exist by Theorems 2.20, 2.17, and 2.42. By linearity, their sum
gives the integral (S) ∫b
a h(∇F◦(g, f))·d(g, f) with F(u, v) := uv for u, v ∈R.
Thus (2.93) follows from (2.91), proving the corollary.
2
Taking h ≡1 in the preceding corollary, we recover (for f, g of bounded
variation) the integration by parts formula for the RYS integral obtained in
Corollary 2.82.
2.9 Relations between Integrals
(RS) ∫b
a f dh
- (RRS) ∫b
a f dh
       
h ∈R
f ∈Wp, h ∈Wq, 1
p + 1
q > 1 =⇒
∫=b
a f dh := ∫[a,b] f dµh,[a,b]
@
@
R
(RYS) ∫b
a f dh
f ∈R, h ∈D
@
@@
R
(LS) ∫b
a f dh
PPPPPPPP
q
f ∈R, h ∈D
-

f ≥0, h ∈D, h ↑
(HK) ∫b
a f dh

*
f ∈R
(CY ) ∫b
a f dh


1
p + 1
q = 1
Fig. 2.1. Implications for integrals
In this section we explore whether, under some hypotheses, if one integral
exists, then so does another, with the same value. Figure 2.1 summarizes
some implications and Table 2.1 gives references for proofs. In Figure 2.1,
−→means that existence of the integral to the left of it implies that of the
integral to the right of it, with the same value. For “←−” left and right are
interchanged. The marking “f ∈R” or “h ∈R” means that the implication
holds for regulated f or h, respectively. The marking “h ∈D” means that the
implication holds for a regulated and right-continuous h. Finally, “=⇒” means
that the condition to the left of it implies existence of the integral to the right
of it. The condition 1
p + 1
q = 1 on the right has no arrows from (or to) it,

88
2 Extended Riemann–Stieltjes Integrals
Table 2.1. References to proofs of the implications shown in Figure 2.1:
(RS) ∫b
a f dh −→(RRS) ∫b
a f dh
Proposition 2.13
f ∈Wq, h ∈Wp, 1
p + 1
q > 1 =⇒∫=b
a f dh
Corollary 3.95
(RRS) ∫b
a f dh −→∫=b
a f dh,
h ∈R
Propositions 2.18 and 2.27
(LS) ∫b
a f dh −→∫=b
a f dh,
f ∈R, h ∈D
Corollary 2.29
(LS) ∫b
a f dh ←→(HK) ∫b
a f dh, f ≥0, h ∈D, h ↑Theorem 2.71
∫=b
a f dh −→(HK) ∫b
a f dh, f ∈R, h ∈D
Theorem 2.69
∫=b
a f dh −→(RYS) ∫b
a f dh
Proposition 2.27
(RYS) ∫b
a f dh −→(CY ) ∫b
a f dh
Theorem 2.51(a)
f ∈Wp, g ∈Wq, 1
p + 1
q = 1, 1 < p < ∞does
not imply that any of the above integrals exists
Proposition 3.104
signifying that there exist f ∈Wp and h ∈Wq with 1
p + 1
q = 1, 1 < p, q < ∞,
such that ∫b
a f dh does not exist for any of the deﬁnitions given. The ﬁgure is
for real-valued functions and for a < b, although the implications not about
LS or HK integrals hold for f and h X- and Y -valued respectively.
Proposition 2.89. Let µ be an upper continuous additive X-valued interval
function on [a, b], and let ν be a Y -valued interval function on [a, b] such that
ν(∅) = 0. Let h be the point function on [a, b] deﬁned by h(t) := µ([a, t])
for a ≤t ≤b, and let g be a Y -valued regulated function on [a, b] such that
ν([a, t)) = g(t−) for a < t ≤b. The Kolmogorov integral
R
=[a,b] ν([a, ·))·dµ
exists if and only if (RRS) ∫b
a g(a)
−·dh does, and if they exist then for each
a ≤t ≤b,
R
=
[a,t]
ν([a, ·))·dµ = (RRS)
Z t
a
g(a)
−·dh.
Also for a ≤c < b,
R
=(c,b] ν([a, ·))·dµ exists if and only if (RRS) ∫b
c g(c)
−·dh
does, and if they exist then for each t ∈(c, b],
R
=
(c,t]
ν([a, ·))·dµ = (RRS)
Z t
c
g(c)
−·dh.
Proof. We can assume that a < b. By Proposition 2.6(f), since µ is upper
continuous and additive, h is regulated and right-continuous on [a, b]. By
Propositions 2.18 and 2.46, since for any a ≤c ≤t ≤b, g(c)
−is left-continuous
on (c, t], the integral (RRS) ∫t
c g(c)
−·dh exists if and only if (RYS) ∫t
c g(c)
−·dh
does, and the two integrals have the same value if they exist. Since ν(∅) = 0
and ∆+h(a) = 0, we have that
SYS(ν([a, ·)), dµ; [a, t], τ) = SYS(g(a)
−, dh; [a, t], τ)
for any tagged Young interval partition τ of [a, t]. Therefore by Proposi-
tion 2.25 and the deﬁnition of the (RYS) integral, the Kolmogorov integral

2.9 Relations between Integrals
89
R
=[a,t] ν([a, ·))·dµ exists if and only if (RRS) ∫t
a g(a)
−·dh does, which follows from
existence of either integral for t = b, and the two integrals have the same value
for each t if they exist, proving the ﬁrst part of the lemma. To prove the second
part, again let a ≤c < t ≤b. Since ∆+h(c) = 0, we have that
SYS(ν([a, ·)), dµ; (c, t], τ) = SYS(g(c)
−, dh; [c, t], τ)
for any tagged Young interval partition τ of [[c, t]. Therefore by Proposition
2.25 again, the Kolmogorov integral
R
=(c,t] ν([a, ·))·dµ exists if and only if
(RYS) ∫t
c g(c)
−·dh does, which follows from existence of either integral for t = b,
and the two integrals have the same values for each t. The proof of the propo-
sition is complete.
2
The following relation between integrals of particular forms is used in
Chapter 9. It follows from the preceding proposition and from deﬁnitions
(1.15), (1.16) of the integrals with the reversed order.
Proposition 2.90. Let µ be an upper continuous additive X-valued interval
function on [a, b], and let ν be a Y -valued interval function on [a, b] such that
ν(∅) = 0. Let h be the point function on [a, b] deﬁned by h(t) := µ([a, t])
for a ≤t ≤b, and let g be a Y -valued regulated function on [a, b] such that
ν([a, t)) = g(t−) for a < t ≤b. The Kolmogorov integral
R
=[a,b] dµ·ν([a, ·))
exists if and only if (RRS) ∫b
a dh·g(a)
−
does, and if they exist then for each
a ≤t ≤b,
R
=
[a,t]
dµ·ν([a, ·)) = (RRS)
Z t
a
dh·g(a)
−.
Also for a ≤c < b,
R
=(c,b] dµ·ν([a, ·)) exists if and only if (RRS) ∫b
c dh·g(c)
−
does, and if they exist then for each t ∈(c, b],
R
=
(c,t]
dµ·ν([a, ·)) = (RRS)
Z t
c
dh·g(c)
−.
The additivity property of the Kolmogorov integral in conjunction with
the preceding proposition implies the following additivity property.
Corollary 2.91. Let h ∈R([a, b]; X) be right-continuous and g ∈R([a, b]; Y ).
For a < c < b, the integral (RRS) ∫b
a dh·g(a)
−
exists if and only if both
(RRS) ∫c
a dh·g(a)
−
and (RRS) ∫b
c dh·g(c)
−exist, and then
(RRS)
Z b
a
dh·g(a)
−= (RRS)
Z c
a
dh·g(a)
−+ (RRS)
Z b
c
dh·g(c)
−.

90
2 Extended Riemann–Stieltjes Integrals
Proof. Let µ := µh,[a,b] and ν := µg,[a,b] be the interval functions deﬁned by
(2.2), and let ˜h(t) := µ([a, t]) for a ≤t ≤b. Using Proposition 2.6 and the
deﬁnition (2.3) of Rµ,a, it then follows that ˜h = Rµ,a = h−h(a), µ is an upper
continuous additive interval function, ν(∅) = 0, and g(t−) = Rν,a(t−) =
ν([a, t)) for a < t ≤b. Therefore by additivity of the Kolmogorov integral
(Theorem 2.21 extended to the integral (1.16) with the reversed order) and
by Proposition 2.90, it follows that (RRS) ∫b
a dh·g(a)
−
exists if and only if both
(RRS) ∫c
a dh·g(a)
−
and (RRS) ∫b
c dh·g(c)
−exist, and then
(RRS)
Z b
a
dh·g(a)
−
= (RRS)
Z b
a
d˜h·g(a)
−=
R
=
[a,b]
dµ·ν([a, ·))
=
R
=
[a,c]
dµ·ν([a, ·)) +
R
=
(c,b]
dµ·ν([a, ·))
= (RRS)
Z c
a
dh·g(a)
−+ (RRS)
Z b
c
dh·g(c)
−.
The proof is complete.
2
2.10 Banach-Valued Contour Integrals and Cauchy
Formulas
Throughout this section we assume that a < b. For suitable curves ζ(·) in
the complex plane C and functions f, which may be Banach-valued, integrals
∫ζ(·) f(ζ) dζ will be deﬁned and treated. The curves will be just as in the
classical theory of holomorphic functions into C, as follows.
Deﬁnition 2.92. A curve is a continuous function ζ(·) from a nondegenerate
interval [a, b] into C. A C1 arc is a curve ζ(·) such that for ζ ≡ξ+iη with ξ and
η real-valued, the derivative ζ′(t) = ξ′(t) + iη′(t) exists and is continuous and
non-zero for a < t < b, and has limits ζ′(a+) = limt↓a ζ′(t) ̸= 0 ̸= ζ′(b−) =
limt↑b ζ′(t). A piecewise C1 curve is a curve ζ on [a, b] such that for some
partition a = t0 < t1 < · · · < tn = b, ζ(·) is a C1 arc on each [ti−1, ti], and
such that for each i = 1, . . . , n −1, the ratio ζ′(ti+)/ζ′(ti−) is not real and
negative, nor is ζ′(a+)/ζ′(b−). A closed curve is a curve ζ(·) from [a, b] into
C such that ζ(a) = ζ(b). The closed curve ζ(·) is simple if ζ(s) ̸= ζ(t) for
a ≤s < t < b.
If z0 is a point not in the range of a closed curve ζ(·), that is, z0 ̸∈ran(ζ),
then we can write ζ(t) −z0 = r(t)eiθ(t) for some real r(t) > 0 and θ(t) which
are continuous functions of t, with θ(b)−θ(a) = 2nπ for some integer n, called
the winding number w(ζ(·), z0) of ζ around z0.
For example, if [a, b] = [0, 1] and ζ(t) = e2πit, then w(ζ(·), z) = 1 if |z| < 1
and 0 if |z| > 1.

2.10 Banach-Valued Contour Integrals and Cauchy Formulas
91
Proposition 2.93. For a piecewise C1 curve ζ(·) on [a, b] (not necessarily
simple) and a point z ̸∈ran (ζ), we have
w(ζ(·), z) =
1
2πi(RS)
Z b
a
dζ(t)
ζ(t) −z .
Proof. In the representation ζ(t) = z+r(t)eiθ(t), r(·) > 0 and θ(·) are piecewise
C1 functions on [a, b]. Using elementary calculations, we get
1
2πi
Z b
a
dζ(t)
ζ(t) −z =
1
2πi
h Z b
a
dr(t)
r(t) +
Z b
a
deiθ(t)
eiθ(t)
i
=
1
2πi
h
log r(b)
r(a) + i(θ(b) −θ(a))
i
= w(ζ(·), z)
since r(b) = r(a), proving the proposition.
2
A topological space (S, T ) is connected if it is not the union of two disjoint
nonempty open sets. A subset C ⊂S is connected iﬀit is connected in its
relative topology. Holomorphic functions with values in a Banach space are
deﬁned as follows:
Deﬁnition 2.94. Let X be a complex Banach space and let U be an open
connected set in C. A function f : U →X has a Taylor expansion around a
point u ∈U if there are an r > 0 and a sequence {hk}k≥0 ⊂X such that for
all z with |z −u| < r, we have z ∈U and
f(z) =
∞
X
k=0
(z −u)khk,
(2.94)
where the series converges in X and is called the Taylor series of f around
u. A function f : U →X is holomorphic on U if it has a Taylor expansion
around each point of U.
We assume that holomorphic functions are deﬁned on connected open sets,
even if this assumption is not used until we deal with analytic continuation,
as in Theorems 5.33 and 5.34, for the following reasons.
Let U and V be disjoint nonempty open subsets of C. Let g and h be any
two holomorphic functions from U and V respectively into C. Let f(z) := g(z)
for z ∈U and f(z) := h(z) for z ∈V . Then f would be “holomorphic” on
U ∪V . But suppose g and h can each be extended to be entire functions,
holomorphic on all of C, and g ̸= h on C. When a function g has an entire
extension, such an extension is unique and it seems unnatural to deﬁne a
holomorphic function in a way that could contradict an entire extension.
More speciﬁcally, consider sums f(z) = P
k≥1 ak/(z −zk) with P
k |ak| <
∞, called Borel series. Suppose that |zk| ≥1 for all k and that the set of all

92
2 Extended Riemann–Stieltjes Integrals
limits of subsequences zkj with kj →∞as j →∞is the unit circle T 1 := {z :
|z| = 1}. Then the series converges on U ∪V where U := {z : |z| < 1} and
V := {z : |z| > 1} \ {zj}j≥1. The sum f(z) is holomorphic on U and on V .
Each of U and V is open and connected, and they are disjoint. It can happen
that f ≡0 on U but f ̸≡0 on V , e.g. [196, Theorem 4.2.5]. So again, analytic
continuation from U would conﬂict with the values on V .
Other holomorphic functions on open sets U ⊂C have no entire extension
and non-unique maximal holomorphic extensions in C. Let C = {z = x +
iy: x, y ∈R} and U := {z ∈C: x > 0}. Consider the function g(z) = √z for
z ∈U (which has a branch point at 0). It has a holomorphic extension to the
complement {z ∈C: y = 0, x ≤0}c and another to {z ∈C: x = 0, y ≤0}c.
Neither extension can be extended holomorphically to any further point. To
obtain natural domains for holomorphic functions with branch points one
takes Riemann surfaces (cf. [1, 2nd ed., 1966 §3.4.3]).
We show next that a Taylor expansion if it exists is unique and the series
converges absolutely and uniformly.
Lemma 2.95. Let X be a Banach space over K and let {hk}k≥0 ⊂X. If the
power series P
k≥0 tkhk converges absolutely and its sum is equal to zero for
each t ∈K such that |t| ≤δ for some δ > 0, then hk ≡0 for k = 0, 1, . . . .
Proof. Taking t = 0 we get h0 ≡0. Suppose there is a least integer k0 ≥1
such that hk0 ̸= 0. For each t with 0 < |t| < δ, we have P
k≥k0 tk−k0hk = 0,
and so
∥hk0∥≤
X
k>k0
∥hk∥|t|k−k0 =
1
δk0
X
k>k0
∥hk∥δk|t|
δ
k−k0
≤C
δk0
|t|
(δ −|t|),
where C := sup{∥kk∥δk : k ≥0} < ∞. Letting |t| →0 it follows that hk0 = 0,
a contradiction, proving that hk = 0 for all k = 1, 2, . . ..
Proposition 2.96. Let X be a complex Banach space, and let U be an open
connected set in C. If f : U →X has a Taylor expansion (2.94) around u ∈U
and the Taylor series converges on B(u, r) for some r > 0, then it converges
absolutely on B(u, r) and uniformly on ¯B(u, s) for any s < r. In particular,
f is continuous on B(u, r) and its Taylor expansion around u is unique.
Proof. If 0 < s < r then sk∥hk∥→0 as k →∞, and so lim supk→∞∥hk∥1/k ≤
1/s. Since s ∈(0, r) is arbitrary, lim supk→∞∥hk∥1/k ≤1/r. Thus the Taylor
series (2.94) converges absolutely by the root test for series of positive num-
bers. By Lemma 2.95, the Taylor expansion (2.94) is unique. It also follows
that the Taylor series converges uniformly on ¯B(u, s) for any s < r, and so f
is continuous on B(u, r), proving the proposition.
2
Let ζ(·) be a piecewise C1 curve from [a, b] into C. Let X be a Banach space
over C and let f be a continuous function into X from a set in C including
the range of ζ(·). Then the contour integral over ζ(·) is deﬁned by

2.10 Banach-Valued Contour Integrals and Cauchy Formulas
93
I
ζ(·)
f(ζ) dζ := (RS)
Z b
a
f(ζ(t))·dζ(t),
where · denotes the natural bilinear mapping X × C →X.
The Cauchy integral formula will ﬁrst be extended to Banach-valued func-
tions for curves which are circles.
Proposition 2.97. Let f be a holomorphic function from an open disk U :=
{z : |z −w| < r} ⊂C into a complex Banach space X. Let 0 < t < r and
ζ(θ) := w + teiθ for 0 ≤θ ≤2π. Then for any z ∈C with |z −w| < t,
f(z) =
1
2πi
I
ζ(·)
f(ζ) dζ
ζ −z .
(2.95)
Proof. Let L be any continuous C-valued linear functional on X (L ∈X′),
so that for some K < ∞, |L(x)| ≤K∥x∥for all x ∈X. For each conver-
gent series f(v) = P∞
k=0(v −w)khk, we have a convergent series L(f(v)) =
P∞
k=0 L(hk)(v −w)k, and so L◦f is holomorphic from U into C. Thus (2.95)
holds for L◦f in place of f by the classical Cauchy integral formula (e.g.
Ahlfors [1, 2nd ed., 1966 §4.2.2, Theorem 6]). Now L can be interchanged
with the integral by Proposition 2.78. If x, y ∈X and L(x) = L(y) for all
L ∈X′, then x = y by the Hahn–Banach theorem. The conclusion follows. 2
For a function f from an open set U ⊂C into a complex Banach space X
and z ∈U, the derivative f ′(z) is deﬁned, if it exists, as
lim
w→z
f(w) −f(z)
w −z
∈X.
Let f (1) := f ′ and n ≥1. If the nth derivative f (n) is deﬁned in a neighborhood
of z, then f (n+1)(z) is deﬁned as (f (n))′(z), if it exists.
The classical Cauchy integral formula for derivatives extends directly to
Banach spaces:
Theorem 2.98. Under the hypotheses of Proposition 2.97, f (n)(z) exists for
all n = 1, 2, . . . and
f (n)(z) = n!
2πi
I
ζ(·)
f(ζ) dζ
(ζ −z)n+1 .
The conclusion follows from Proposition 2.97 and the next lemma since a
holomorphic function is bounded on C by Proposition 2.96.
Lemma 2.99. Suppose that g is continuous on the range C of a piecewise
C1 curve ζ(·). Then for each n ≥1, the function

94
2 Extended Riemann–Stieltjes Integrals
In(z) = In(g; z) :=
I
ζ(·)
g(ζ) dζ
(ζ −z)n
has a derivative on the complement Cc of C, and I′
n(z) = nIn+1(z).
Proof. We prove ﬁrst that I1 is continuous on Cc. Let z0 ∈Cc and let δ > 0
be such that the open ball |z −z0| < δ does not intersect C. By restricting
z to the smaller ball |z −z0| < δ/2, we have that |ζ(t) −z| > δ/2 for each
t ∈[a, b]. By linearity of the RS integral, we have
I1(z) −I1(z0) = (z −z0)
I
ζ(·)
g(ζ) dζ
(ζ −z)(ζ −z0).
Using the bounds (2.84), it follows that
|I1(z) −I1(z0)| ≤|z −z0|(12/δ2)∥g◦ζ∥[a,b],supv1(ζ; [a, b]),
and so I1 = I1(g) is continuous at z0, and this is true for all continuous g on
C.
Applying the ﬁrst part of the proof to the function h(ζ) := g(ζ)/(ζ −z0),
we conclude that
I1(z) −I1(z0)
z −z0
=
I
ζ(·)
g(ζ) dζ
(ζ −z)(ζ −z0) = I1(h; z) →I1(h; z0) = I2(g; z0)
as z →z0. This proves the conclusion in the case n = 1.
The conclusion for an arbitrary n is proved by induction. Suppose that for
some n ≥2, I′
n−1(g; z) = (n −1)In(g; z) for z ∈Cc, for all continuous g on
C. Again let z0 ∈Cc. Using the identity
In(z) −In(z0)
=
h I
ζ(·)
g(ζ) dζ
(ζ −z)n−1(ζ −z0) −
I
ζ(·)
g(ζ) dζ
(ζ −z0)n
i
+(z −z0)
I
ζ(·)
g(ζ) dζ
(ζ −z)n(ζ −z0),
one can conclude that In is continuous at z0. Indeed, deﬁning h(ζ) := g(ζ)/(ζ−
z0), the ﬁrst term is equal to In−1(h; z) −In−1(h; z0) and tends to zero as
z →z0 by the induction hypothesis, while in the second term the integral is
bounded for z in a neighborhood of z0 as shown in the ﬁrst part of the proof.
Now dividing the identity by z −z0 and letting z →z0, the quotient in the
ﬁrst term tends to a derivative I′
n−1(h; z0), which by the induction hypothesis
equals (n −1)In(h; z0) = (n −1)In+1(g; z0). The remaining factor In(h; z) is
continuous as before, and so has the limit In(h; z0) = In+1(g; z0). Thus I′
n(z0)
exists and equals nIn+1(z0). The proof of the lemma is complete.
2

2.10 Banach-Valued Contour Integrals and Cauchy Formulas
95
Proposition 2.100. Let X be a complex Banach space, and let f be a holo-
morphic function on a disk B(u, r) ⊂C with values in X for some u ∈C and
r > 0. Then for each z ∈B(u, r),
f(z) = f(u) +
X
k≥1
(z −u)k
k!
f (k)(u)
is the Taylor expansion of f around u.
Proof. Let 0 < s < t < r, let ζ(θ) := u + teiθ for 0 ≤θ ≤2π, and let
z ∈B(u, t). Then by the Cauchy integral formula (Proposition 2.97),
f(z) =
1
2πi
I
ζ(·)
f(ζ) dζ
ζ −z .
For each ζ ∈ran (ζ), the series
1
ζ −z = (ζ −u)−1
∞
X
k=0
z −u
ζ −u
k
converges absolutely, and uniformly if |z −u| ≤s. Since f is continuous
on the range ran (ζ) by Proposition 2.96, it is bounded. Then term-by-term
integration yields
f(z) =
∞
X
k=0
(z −u)k
2πi
I
ζ(·)
f(ζ) dζ
(ζ −u)k+1 .
Using the bound (2.84) for the RS integral and the root test, it follows that
the series converges absolutely. Now the conclusion follows by the Cauchy
integral formula for derivatives (Theorem 2.98) and by the uniqueness of a
Taylor expansion (Proposition 2.96).
2
Proposition 2.101. If f is holomorphic from an open connected set U ⊂C
into a Banach space X and w ∈U, then for
g(z) :=
 f(z)−f(w)
z−w
, if z ̸= w,
f ′(w),
if z = w,
g is also holomorphic on U.
Proof. It is easily seen that g is holomorphic on U \ {w}, since z 7→1/(z −w)
is, so it suﬃces to ﬁnd a power series expansion for g around w. Let f(z) =
P∞
k=0(z −w)kxk for |z −w| < r, where r > 0 and xk := f (k)(w)/k! ∈X by
Proposition 2.100. Then g(z) = P∞
k=0(z −w)kxk+1, also for |z −w| < r, with
g(w) = x1 = f ′(w), ﬁnishing the proof.
2

96
2 Extended Riemann–Stieltjes Integrals
A topological space (S, T ) is locally connected iﬀT has a base consisting
of connected open sets. Clearly, any normed vector space with its usual topol-
ogy is connected and locally connected. In particular, R and C are locally
connected.
Theorem 2.102. For any topological space (S, T ) and any nonempty con-
nected set A ⊂S there is a unique connected set B ⊃A such that B is a
maximal connected set for inclusion. Such a set B is always closed.
Proof. The collection of connected sets including A is partially ordered by
inclusion. The union of any inclusion-chain of connected sets is easily seen to
be connected. Thus by Zorn’s lemma there is a connected set B1 ⊃A which
is a maximal connected set for inclusion. Suppose B2 is another such set. The
union of two non-disjoint connected sets is easily seen to be connected. This
gives a contradiction unless B1 = B2, so B is unique. Moreover, the closure of
any connected set is easily shown to be closed. So by maximality, B is closed
and the theorem is proved.
2
A maximal connected subset B of S is called a component. If A is a sin-
gleton {x}, it is always connected, and the B from the preceding theorem is
called the component of x.
Proposition 2.103. Let (S, T ) be a locally connected topological space. Then
any component F of S is open as well as closed. Thus S has a unique decom-
position as a union of disjoint open and closed components.
Proof. Let F be a component of S and x ∈F. Let V be a connected open
neighborhood of x by local connectedness. Then F ∪V is connected since F
and V are and F ∩V ⊃{x} ̸= ∅. So V ⊂F and F is open. The rest follows.
2
Clearly, an open set in a locally connected space is locally connected, so
it is in a unique way a union of disjoint nonempty connected open sets.
An open set U ⊂C will here, following Ahlfors [1, 2nd ed., §4.4.2], be
called simply connected if and only if U c has no bounded component. A more
general deﬁnition is based on the following.
Deﬁnition 2.104. A closed curve ζ(·) from [a, b] into a set U is null-
homotopic in U if there exists a jointly continuous function H from [a, b]×[0, 1]
into U such that H(·, 0) ≡ζ(·), for some w ∈U, H(·, 1) ≡w, and for
0 ≤u ≤1, H(a, u) = H(b, u), so that each H(·, u) is a closed curve.
Theorem 2.105. Let U ⊂C be a connected nonempty open set. Then the
following are equivalent:
(a) any closed curve ζ(·) with range in U is null-homotopic in U;

2.10 Banach-Valued Contour Integrals and Cauchy Formulas
97
(b) for every closed curve ζ(·) into U and z ∈U c, w(ζ(·), z) = 0;
(c) U c has no bounded component;
(d) U is homeomorphic to the open unit disk {z ∈C: |z| < 1}.
Proof. The implications (d) →(a) →(b) and (c) →(b) are easy. The other
implications are not as easy and are given in Newman [178, §§6.6 and 7.9].
Complex analysis texts also give proofs, of the stronger fact that in (d), un-
less U = C, the homeomorphisms can be taken to be holomorphic with holo-
morphic inverses (Riemann mapping theorem, see e.g. Beardon [12, Theorem
11.1.1 and §11.2]).
2
In Theorem 2.105, (a) is the deﬁnition of simply connected for general
topological spaces. It is not equivalent to (c) in R3, for example.
Here is a Cauchy integral theorem for Banach-valued functions.
Theorem 2.106. Let f be holomorphic from an open connected set U ⊂C
into a complex Banach space X and let ζ(·) be a piecewise C1 closed curve
whose range is included in U. If (i) the winding number w(ζ(·); z) = 0 for
each z ̸∈U, e.g. if (ii) U is simply connected, then
I
ζ(·)
f(ζ) dζ = 0.
(2.96)
Proof. Condition (ii) implies (i) by Theorem 2.105, (c) ⇒(b), or (a) ⇒
(b) for the general deﬁnition of simply connected. So we can assume (i). By
Proposition 2.96, f is continuous on U, and so the integral (2.96) is deﬁned.
For any continuous linear functional L ∈X′, z 7→L(f(z)) is holomorphic
from U into C. Thus by Proposition 2.78, we have
L
 I
ζ(·)
f(ζ) dζ

=
I
ζ(·)
L(f(ζ)) dζ.
The integral on the right is zero by the Cauchy theorem for multiply connected
sets (e.g., Ahlfors [1, 2nd ed., §4.4.4 Theorem 18]). Thus by the Hahn–Banach
theorem (e.g. [53, 6.1.5 Corollary]), it follows that (2.96) holds, proving the
theorem.
2
Here are Cauchy integral formulas with winding numbers.
Theorem 2.107. Let f be holomorphic from a connected and simply con-
nected open set U ⊂C into a complex Banach space X. Let ζ(·) be a piecewise
C1 closed curve whose range C is included in U and let z ∈U \ C. Then
w(ζ(·), z)f(z) =
1
2πi
I
ζ(·)
f(ζ) dζ
ζ −z ,
(2.97)

98
2 Extended Riemann–Stieltjes Integrals
and for n = 1, 2, 3, . . .,
w(ζ(·), z)f (n)(z) = n!
2πi
I
ζ(·)
f(ζ) dζ
(ζ −z)n+1 .
(2.98)
Proof. On the right side of (2.97) write f(ζ) = [f(ζ) −f(z)] + f(z). For the
f(ζ) −f(z) term, the integral is 0 by Proposition 2.101 and Theorem 2.106.
For the f(z) term, we get the left side of (2.97) by Proposition 2.93, proving
(2.97). We thus have (2.98) for n = 0. For a given ζ(·) and z ̸∈C, w(ζ(·), u)
is constant for u in a neighborhood of z, so the multiplication by w(ζ(·), u)
can be interchanged with dn/dun|u=z. On the right, we can use induction on
n and Lemma 2.99, so (2.98) is proved.
2
If w(ζ(·), z) = 1, we get the familiar form of the formula, now for rather
general closed curves ζ(·).
2.11 Notes
Notes on Section 2.1. More properties of a real-valued function equivalent to
being regulated are given by Theorem 2.1 in [54, Part III].
The correspondence between right-continuous regulated point functions
and additive upper continuous interval functions given by Corollary 2.11
is similar to the well-known correspondence between right-continuous point
functions of bounded variation and σ-additive set functions on the Borel σ-
algebra.
Notes on Section 2.2. In T. J. Stieltjes’s treatment of his integral ∫b
a f dh
in [227], the integrand f is continuous, while the integrator h is a mono-
tone increasing function. The Riemann–Stieltjes integral (RS) ∫b
a f dh, for
any f, h such that it exists, appeared in G. K¨onig [122], who apparently
had been using the RS integral in his lectures for some time, as stated in
[228, p. 247] and in [168, p. 314]. Sz´en´assy [228] has a chapter on K¨onig,
where on p. 247 of the English translation, K¨onig’s general deﬁnition of the
RS integral is quoted. Interest in Stieltjes-type integrals ﬂourished after F.
Riesz [193] showed that the Stieltjes integral provides a representation of
an arbitrary bounded linear functional on the space C[0, 1] of all contin-
uous functions on [0, 1]. Pollard [187] introduced the reﬁnement Riemann–
Stieltjes integral, showed that it extends the Riemann–Stieltjes integral, and
proved that for h nondecreasing and f bounded, the integral (RRS) ∫b
a f dh
exists if and only if the Darboux–Stieltjes integral does. The latter integral
is deﬁned as supκ L(f, h; κ) = infκ U(f, h; κ) if the equality holds, where
for a partition κ = {ti}n
i=0 of [a, b], m(f; A) := inf{f(t): t ∈A} and
M(f; A) := sup{f(t): t ∈A},
L(f, h; κ) := Pn
i=1 m(f; [ti−1, ti])[h(ti) −h(ti−1)],
U(f, h; κ) := Pn
i=1 M(f; [ti−1, ti])[h(ti) −h(ti−1)].
(2.99)

2.11 Notes
99
F. A. Medvedev [168] gives an extensive account of the early history of
Stieltjes-type integrals, and in particular gives some details about K¨onig’s
work on the RS integral.
S. Pollard [187] gave a detailed treatment of the reﬁnement Riemann–
Stieltjes integral. Earlier, a theory of limits based on reﬁnements was treated
by E. H. Moore [175]. Thus the RRS integral sometimes is called the Pollard–
Moore–Stieltjes integral (see e.g. [94, p. 269]). The books of Gochman [82]
and Hildebrandt [97, §§9–18] also contain detailed expositions of the RRS
integral.
For real-valued functions, Propositions 2.13 and 2.15 were proved in Pol-
lard [187, p. 90] and Smith [223], respectively.
Notes on Section 2.3. The reﬁnement Young–Stieltjes integral developed
in stages over a long period. This integral was rediscovered by several authors,
and hence it is known by diﬀerent names. According to T. H. Hildebrandt [94],
the RYS integral originated in the work of W. H. Young [254]. In this work
W. H. Young extended his approach to deﬁning the Lebesgue integral, and
the RYS integral appeared there as an auxiliary tool. At that time there was
considerable interest in enlarging the class of functions integrable with respect
to a monotone function h. Lebesgue [134], for example, showed that such a
class could be the class of all Lebesgue summable functions with respect to
dh when a Stieltjes-type integral is deﬁned by means of the Lebesgue integral
using a change of variables formula. Lebesgue suggested that it would be
diﬃcult to extend the Stieltjes integral to such general integrands by any
other means. Recall that Radon’s work which led to the Lebesgue–Stieltjes
integral appeared a little later [190]. However, W. H. Young [254] showed that
his method of monotonic sequences used in connection with the Lebesgue
integral extends to an integration with respect to any function h of bounded
variation almost without changes. The main change concerned the deﬁnition
of the integral ∫f dh for a step function f. In this case, W. H. Young set
Z b
a
f dh :=
X
i

[f∆+h](xi−1) + ci[h(xi−) −h(xi−1+)] + [f∆−h](xi)]
	
,
(2.100)
provided f(x) = ci for x ∈(xi−1, xi). The method of monotonic sequences
of W. H. Young was later extended by Daniell [37] to integrals of functions
deﬁned on abstract sets. A concise theory based on an integral of Stieltjes type
was provided by W. H. Young’s son L. C. Young in the form of a textbook
[243], ﬁrst published in 1927 (see also the presentation in Hildebrandt [97]).
The integral, deﬁned as a limit of Young–Stieltjes sums if it exists when the
mesh of tagged partitions tends to zero, was mentioned by R. C. Young [251].
Full use of the reﬁnement Young–Stieltjes integral, in the context of Fourier
series, is due to L. C. Young [247].
Motivated by the weakness of the Riemann–Stieltjes integral, Ross [195]
suggested an extension of the Darboux–Stieltjes integral, replacing (2.99) by
sums reminiscent of Young–Stieltjes sums. Namely, let f be a real-valued func-

100
2 Extended Riemann–Stieltjes Integrals
tion on [a, b], and let h be a nondecreasing function on [a, b]. For a partition
κ = {ti}n
i=0 of [a, b], let

L(f, dh; κ) := J(f, dh; κ) + Pn
i=1 m(f; (ti−1, ti))[h(ti−) −h(ti−1+)]
U(f, dh; κ) := J(f, dh; κ) + Pn
i=1 M(f; (ti−1, ti))[h(ti−) −h(ti−1+)],
where J(f, dh; κ) := Pn
i=1 f(ti)∆±
[a,b]h(ti), and m(f, A), M(f, A) are deﬁned
as in (2.99). We say that f is Ross–Darboux–Stieltjes, or RDS, integrable on
[a, b] with respect to h, if U(f, dh) := infκ U(f, dh; κ) = supκ L(f, dh; κ) =:
L(f, dh), and then let (RDS) ∫b
a f dh := U(f, dh) = L(f, dh). By Theorem
35.25 in [195], a bounded function f on [a, b] is RDS integrable with respect
to h if and only if there is C ∈R such that given ǫ > 0 there exists δ > 0
such that |SYS(f, dh; τ)−C| < ǫ for each tagged Young interval partition τ =
({ti}n
i=0, {si}n
i=1) of [a, b] such that max{h(ti−)−h(ti−1+): i = 1, . . . , n} < δ.
Then using Theorem 2.1(b), it is easy to see that if (RDS) ∫b
a f dh exists then
so does (RYS) ∫b
a f dh and the two are equal.
The Bartle integral given by Deﬁnition 2.37 is a general bilinear integral
of a vector function with respect to an additive vector measure. According to
Diestel and Uhl [41, p. 58], “Bartle [11] launched a theory of integration that
includes most of the known integration procedures that have any claim to
quality. His integral specializes to include the Bochner integral but does not
include the general Pettis integral. Possibly workers in the theory of vector
measures would be better oﬀif they attempted to use the Bartle integral rather
than inventing their own.” A survey of the history of vector integration can
be found in Hildebrandt [95] and Bartle [11].
There are several diﬀerent constructions of an integral of a Banach-space-
valued function with respect to a nonnegative ﬁnite scalar-valued measure
µ. The Bochner integral given by Deﬁnition 2.31 is one of the best known
among such integrals. S. Bochner [21] deﬁned his integral. The extension of
Lebesgue’s diﬀerentiation theorem to Banach-valued functions, Theorem 2.35,
is given e.g. by Diestel and Uhl [41, Theorem II.2.9, p. 49].
A function f taking values in a Banach space X is integrable with respect
to µ in the sense of Dunford [56] if there exists a sequence of µ-simple functions
{fk}k≥1 such that it converges to f µ-almost everywhere, and the sequence
{∫A fk dµ}k≥1 converges in X for each A ∈S. The integral (D) ∫A f dµ is
then deﬁned to be the limit limk→∞∫A fk dµ, and is called the second Dunford
integral. The integral does not depend on {fk} since it is a special case of the
Bartle integral by Theorem 9 in [11], which is well deﬁned by Proposition 2.38.
The second Dunford integral clearly extends the Bochner integral. Hildebrandt
[95, p. 123] showed that for µ-measurable functions f, the second Dunford
integral coincides with several other integrals. Example 7 of Birkhoﬀ[16, p.
377] gives a µ-measurable function f such that ∥f(·)∥is not summable but is
integrable in the sense of Dunford. For a scalar-valued measurable function f
and a vector-valued measure µ, an integral analogous to the second Dunford
integral is treated in Dunford and Schwartz [57, Deﬁnition IV.10.7].

2.11 Notes
101
Notes on Section 2.4. The “if” part of Theorem 2.42 was proved in Smith
[223, p. 495].
Notes on Section 2.5. L. C. Young [244, p. 263] deﬁned an extension of
the Riemann–Stieltjes integral for regulated complex-valued functions f and
h by
(Y0)
Z b
a
f dh := (RRS)
Z b
a
f+ dh−+
X
a≤t≤b

f(t) −f(t+)

h(t+) −h(t−)

if the RRS integral exists and the sum converges absolutely. However, the
value of the Y0 integral depends on h(a−), f(b+), and h(b+), which need not
be deﬁned. If in the Y0 integral we replace f(t+) by f (b)
+ (t), h(t+) by h(b)
+ (t),
and h(t−) by h(a)
−(t), then we get the Y1 integral deﬁned by (2.44). L. C.
Young in 1938 gave such a convention for values at the endpoints in footnote
6 on p. 583 of [247], so one may suppose that he had these deﬁnitions in mind
already in his 1936 paper.
The Y1 and Y2 integrals have been deﬁned and proved equal when both
exist in Dudley [49]. An extension of the Y1 and Y2 integrals to integrals of
the form
R
f·dh·g with two integrands f and g was given in [54, Part II]. In
Section 9.8 below such an extension is given for the RYS and Kolmogorov
integrals.
Theorem 2.50 for functions with values in a Banach algebra is a special
case of Theorem 3.7 in [54, Part II].
Notes on Sections 2.6 and *2.7. Saks [201] deﬁnes integrals due to Perron
and Denjoy and gives references to their work, published beginning in 1912–
1915. The Perron integral and one form of the Denjoy integral turned out
to be equivalent to the Henstock–Kurzweil integral for integrals ∫b
a g(x) dx:
Gordon [84, Chapter 11].
Ward [238] in 1936 deﬁned an integral called a Perron–Stieltjes integral
which includes both the Lebesgue–Stieltjes and reﬁnement Riemann–Stieltjes
integrals. Theorem 2.64 is Theorem 5 of Ward [238]. Kurzweil [129, Section 1.2]
in 1957 deﬁned the Henstock–Kurzweil integral and proved Theorem 2.65 on
the equivalence of the WPS and HK integrals [129, Theorem 1.2.1]. Kurzweil
([129], [130], [131]), Henstock ([90], [91], [92]), and McShane [166] consider
extended integrals for functions U(·, ·) of two variables, the second and third
authors also on general spaces X, where (HK) ∫b
a f dh is the special case
U(x, y) ≡f(y)h(x) and X = [a, b].
A discussion of Proposition 2.58 and its proof when h(x) = x can be found
in McLeod [165, Sections 1.5, 2.8, and 7.3].
While there has been relatively little literature about the reﬁnement
Young–Stieltjes and central Young integrals, there has been much more about
Henstock–Kurzweil (or gauge) integrals, e.g. Lee Peng-Yee [184]. A 1991 book
by Henstock [92] has a reference list of more than 1200 papers and books,
mainly on the theme of “non-absolute integration,” if not necessarily about

102
2 Extended Riemann–Stieltjes Integrals
the HK integral itself. In fact, Henstock [92] treats integration over general
spaces (“division spaces”).
Schwabik [211, Theorem 3.1] proved Theorem 2.69 when h is of bounded
variation and f is not necessarily regulated but either (a) f is bounded, or
(b) f is arbitrary and for any t if h(t−) = h(t+) then h(t) = h(t−).
Notes on Section 2.8. According to Hildebrandt [94, p. 276], the integra-
tion by parts formula (2.79) for the reﬁnement Young–Stieltjes integral was
proved by de Finetti and Jacob [66] assuming that f and g are of bounded
variation. Hewitt [93] proved an integration by parts formula similar to (2.83)
for the Lebesgue–Stieltjes integral. Corollary 2.83 contains the result of Love
[145], who calls the reﬁnement Young–Stieltjes integral the reﬁnement Ross-
Riemann–Stieltjes integral, or the R3S-integral.
Notes on Section 2.10. Ahlfors [1, 2nd ed., §4.4.4] wrote: “It was E. Artin
who discovered that the characterization of homology by vanishing winding
numbers ties in precisely with what is needed for Cauchy’s theorem. This idea
has led to a remarkable simpliﬁcation of earlier proofs.”
Proposition 2.93 is given e.g. in Ahlfors [1, 2nd ed., §4.2.1].

3
Φ-variation and p-variation; Inequalities for
Integrals
3.1 Φ-variation
Let V be the class of all functions Φ: [0, ∞) →[0, ∞) which are strictly
increasing, continuous, unbounded, and 0 at 0. Let CV be the subclass of
convex functions in V. Let X be a Banach space with norm ∥· ∥, let J be a
nonempty interval in R, let f be a function deﬁned on J with values in X,
and let Φ ∈V. Recall that an interval is called nondegenerate if it contains
more than one point. If J is nondegenerate, for each κ = {ti}n
i=0 ∈PP (J),
the class of all point partitions of J as deﬁned in Section 1.4, let sΦ(f; κ) :=
Pn
i=1 Φ(∥f(ti) −f(ti−1)∥) be the Φ-variation sum.
Deﬁnition 3.1. Let X be a Banach space, let J be a nonempty interval, and
let f : J →X. The Φ-variation of f on J is deﬁned by
vΦ(f) := vΦ(f; J) := sup

sΦ(f; κ): κ ∈PP (J)
	
(3.1)
if J is nondegenerate, or as 0 if J is a singleton. We say that f has bounded
Φ-variation if vΦ(f) < ∞. The class of all functions f : J →X with bounded
Φ-variation will be denoted by WΦ = WΦ(J; X). Let WΦ(J) := WΦ(J; R).
If Φ(u) ≡up, u ≥0, for some 0 < p < ∞, we write vp := vΦ, Wp := WΦ,
and Vp(f) = vp(f)1/p. So vp(f) is the p-variation of f as deﬁned by (1.2)
for X = R and in Section 1.4 for general X. Thus the p-variation of f on a
nonempty interval J is deﬁned as vp(f; J) := 0 if J is a singleton, and if J is
nondegenerate as
vp(f) = vp(f; J) = sup

sp(f; κ): κ ∈PP (J)
	
.
(3.2)
In the latter case, for κ = {ti}n
i=0 ∈PP (J), sp(f; κ) = Pn
i=1 ∥f(ti)−f(ti−1)∥p
is the p-variation sum as deﬁned by (1.1) for X = R and in Section 1.4 in
general.
A function Φ ∈V is said to satisfy the ∆2 condition if for some 1 ≤D < ∞,
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_3, 
103

104
3 Φ-variation and p-variation
Φ(2u) ≤DΦ(u)
for all u ≥0.
(3.3)
If Φ is convex, so that Φ ∈CV, then D ≥2. If Φ(u) ≡up, u ≥0, for some
0 < p < ∞(convex if and only if p ≥1) then the ∆2 condition holds with
D = 2p. We have the following:
Proposition 3.2. If Φ ∈V satisﬁes the ∆2 condition then for any nonempty
interval J and Banach space X, WΦ(J; X) is a vector space.
Proof. We can assume that J is nondegenerate. For s, t ∈J and h: J →X
let ∆h := h(t) −h(s). Then for any f, g ∈WΦ(J; X), by (3.3) and since Φ is
increasing, we have
Φ(∥∆(f + g)∥) ≤Φ(2 max{∥∆f∥, ∥∆g∥}) ≤DΦ(max{∥∆f∥, ∥∆g∥})
≤D(Φ(∥∆f∥) + Φ(∥∆g∥)).
Summing over nonoverlapping subintervals of J, it follows that vΦ(f + g) ≤
D(vΦ(f) + vΦ(g)), so f + g ∈WΦ(J; X). Thus, or directly, 2f, 4f, 8f, etc. are
in WΦ(J; X), and since Φ is increasing it follows that cf ∈WΦ(J; X) for any
constant c. The proof is complete.
2
Any convex function Φ on [0, ∞) with Φ(0) = 0 has the superadditivity
property: for any u, v ≥0,
Φ(u + v) ≥Φ(u) + Φ(v),
(3.4)
which is immediate if u = v = 0, and for u + v > 0 follows from Φ(u) ≤
uΦ(u + v)/(u + v) and Φ(v) ≤vΦ(u + v)/(u + v).
For a monotone function f, it is easy to evaluate vΦ(f) explicitly:
Example 3.3. Let Φ ∈CV. By (3.4), it follows that if f is real-valued and
monotone on an interval J = [a, b] with −∞< a ≤b < ∞, then
vΦ(f; [a, b]) = Φ(|f(b) −f(a)|).
(3.5)
Now let f be piecewise monotone on [a, b] with a < b, so that for a partition
{ti}n
i=0 of [a, b], f is nondecreasing on each interval [t2j, t2j+1] and nonincreas-
ing on each interval [t2j−1, t2j]. Assume also that there is a constant c such
that f(ti) < c and f(tk) > c for each even i ≤n and odd k ≤n. Then
vΦ(f; [a, b]) =
n
X
j=1
Φ(|f(tj) −f(tj−1)|).
(3.6)
To see this, note that for any point partition τ of [a, b], the reﬁnement κ
obtained by adjoining all ti has sΦ(f; κ) ≥sΦ(f; τ). Then, by (3.5), sΦ is not
decreased by deleting all points other than the tj.

3.1 Φ-variation
105
Finally, for a continuous, increasing function g on (0, 1] such that g(t) →0
as t ↓0, let f(t) := g(t) cos(π/t) for 0 < t ≤1 and f(0) := 0. Then
vΦ(f; [0, 1]) =
∞
X
i=1
Φ(g(1/i) + g(1/(i + 1))).
(3.7)
This can be veriﬁed as (3.6) was proved, starting with any partition {xi}n
i=0
of [0, 1], adjoining points 1/j for j = 2, . . . , m with 1/m < x1, then deleting
any xi ̸= 1/j for j = 1, . . . , m and letting m →∞.
In general, the class WΦ need not be a vector space, as the following shows.
Example 3.4. Here are examples where WΦ is not a vector space and Φ does
not satisfy the ∆2 condition. Let Φ(u) := e−1/u for 0 < u ≤1/4 and Φ(0) := 0.
Let d be the left derivative of Φ at 1/4. Then letting Φ(u) := Φ(1/4)+d(u−1/4)
for u > 1/4 we get that Φ is convex and in CV. Let Ψ(u) := Φ(u)+((u−1/4)+)2,
where v+ := max(v, 0). Then Ψ is strictly convex and also in CV.
Let g(t) := 1/[c log(1/t)] for 0 < t ≤1/4 and g(t) := 0 elsewhere on
[0, ∞), where c is a constant for which we will consider diﬀerent values. Let
f(t) := g(t) cos(π/t) for 0 < t ≤1 and f(0) := 0. Then, as in (3.7),
vΦ(f; [0, 1]) = Φ(g(1/4)) +
∞
X
j=4
Φ(g(1/j) + g(1/(j + 1))).
(3.8)
Now g(1/j) = 1/(c log j), so g(1/j) + g(1/(j + 1)) is asymptotic to 2/(c log j)
as j →∞. It follows that the series in (3.8) converges if c > 2 and diverges
if c < 2. Thus taking c = 3, f ∈WΦ[0, 1] but 3f /∈WΦ[0, 1]. The same
statements hold for Ψ in place of Φ.
We will show that the set deﬁned next is a vector space including WΦ.
Deﬁnition 3.5. Let J be a nonempty interval and let X be a Banach space.
For Φ ∈V, let f
WΦ = f
WΦ(J; X) be the set of all functions f from J to X such
that cf ∈WΦ(J; X) for some c > 0. For Φ ∈CV and f ∈f
WΦ(J; X), let
∥f∥(Φ) := ∥f∥J,(Φ) := inf{c > 0 : vΦ(f/c) ≤1}
and
∥f∥[Φ] := ∥f∥J,[Φ] := ∥f∥J,(Φ) + ∥f∥sup,
where ∥f∥sup = supt∈J ∥f(t)∥is the sup norm of f. In the special case where
Φ(u) ≡up, u ≥0, for some 1 ≤p < ∞, let Wp(J; X) := f
WΦ(J; X), ∥f∥(p) :=
∥f∥J,(p) := ∥f∥J,(Φ), and ∥f∥[p] := ∥f∥J,[p] := ∥f∥sup + ∥f∥J,(p). Also for
X = R, let f
WΦ(J) := f
WΦ(J; R) and Wp(J) := Wp(J; R).
We have WΦ ⊂f
WΦ, and the inclusion can be strict as in Example 3.4.

106
3 Φ-variation and p-variation
Remark 3.6. It is easy to verify that for 1 ≤p < ∞, the deﬁnition of ∥f∥J,(p)
agrees with the one given in (1.3) and (1.20). Thus, as noted there, by the
H¨older and Minkowski inequalities, ∥· ∥J,(p) is a seminorm and ∥· ∥J,[p] is a
norm on Wp(J). The same also holds on Wp(J; X).
We show next that ∥·∥[Φ] is a norm, for general Φ ∈CV, and that it makes
f
WΦ a Banach space. Throughout this chapter, Φ−1, or sometimes φ, denotes
the inverse function of Φ (not 1/Φ).
Theorem 3.7. Let J be a nondegenerate interval, X a Banach space, and
Φ ∈CV.
(a) For f ∈f
WΦ(J; X), ∥f∥(Φ) = 0 if and only if f is a constant.
(b) For any non-constant f ∈f
WΦ(J; X),
vΦ(f/∥f∥(Φ)) ≤1.
(3.9)
In particular, for any c, d ∈J, ∥f(d) −f(c)∥≤Φ−1(1)∥f∥(Φ).
(c) ∥· ∥(Φ) is a seminorm and ∥· ∥[Φ] a norm on f
WΦ(J; X).
(d) (f
WΦ(J; X), ∥· ∥[Φ]) is a Banach space.
Proof. (a) Clearly if f ≡x0 for some x0 ∈X then f ∈WΦ(J; X) and ∥f∥(Φ) =
0. If f is not constant, then for some s ̸= t in J, f(s) ̸= f(t), so if un ↓0, then
Φ(∥f(s) −f(t)∥/un) →∞, and ∥f∥(Φ) > 0. So (a) holds.
(b) Let u0 := ∥f∥(Φ) > 0. Then for some un ↓u0, vΦ(f/un) ≤1. Suppose
vΦ(f/u0) > 1. Then for some partition λ of J, sΦ(f/u0; λ) > 1. Since Φ
is continuous, for some n large enough, sΦ(f/un; λ) > 1, a contradiction.
So the ﬁrst part of (b) holds. The second part also holds since Φ(∥f(d) −
f(c)∥/∥f∥(Φ)) ≤vΦ(f/∥f∥(Φ)).
(c) For any f ∈f
WΦ(J; X) and c ∈R, it is easy to see that ∥cf∥(Φ) =
|c|∥f∥(Φ). If also g ∈f
WΦ(J; X), we want to show that
∥f + g∥(Φ) ≤∥f∥(Φ) + ∥g∥(Φ).
(3.10)
If f or g is constant then ∥f +g∥(Φ) = ∥f∥(Φ) +∥g∥(Φ), so assume that neither
is constant. For any u, v > 0 and 0 < α < 1, since Φ is convex,
vΦ(α(f/u) + (1 −α)(g/v)) ≤αvΦ(f/u) + (1 −α)vΦ(g/v).
(3.11)
Letting u = ∥f∥(Φ) and v = ∥g∥(Φ) and applying (3.9) gives vΦ(α(f/u) + (1 −
α)(g/v)) ≤1. Then for α := u/(u + v) we get vΦ((f + g)/(u + v)) ≤1, so
(3.10) is proved and ∥· ∥(Φ) is a seminorm. Since ∥· ∥sup is a norm it follows
that ∥· ∥[Φ] is a norm, proving (c).
(d) Let {fn}n≥1 be a Cauchy sequence for ∥· ∥[Φ]. Since the space of
bounded functions ℓ∞(J; X) is a Banach space, the fn converge uniformly on J
to a function f. Given ǫ > 0, take n0(ǫ) large enough so that for m, n ≥n0(ǫ),
∥fm −fn∥[Φ] < ǫ. Then ∥fn −f∥sup ≤ǫ and

3.1 Φ-variation
107
vΦ((fm −fn)/ǫ) ≤1.
(3.12)
For n ≥n0(ǫ) we have vΦ((fn −f)/ǫ) ≤1, since otherwise there is a partition
λ of J with sΦ((fn −f)/ǫ; λ) > 1 and then sΦ((fn −fm)/ǫ; λ) > 1 for m large
enough, contradicting (3.12). Thus ∥fn −f∥(Φ) ≤ǫ and ∥fn −f∥[Φ] ≤2ǫ. So
fn →f for ∥· ∥[Φ] and (d) is proved.
2
Let X1, . . . , Xk, Z be vector spaces. A map L: X1 × · · · × Xk →Z is
called k-linear if for each j = 1, . . . , k, (x1, . . . , xk) 7→L(x1, . . . , xk) is linear
in xj when xi for i ̸= j are ﬁxed. If X1, . . . , Xk, Z are all Banach spaces and
0 ≤M < ∞, L will be called M-bounded if
∥L(x1, . . . , xk)∥≤M∥x1∥· · · ∥xk∥
(3.13)
for all xj ∈Xj, j = 1, . . . , k.
Theorem 3.8. Let k = 1, 2, . . ., let X1, . . . , Xk, Z be Banach spaces, let
0 ≤M < ∞, and let L be k-linear and M-bounded from X1 × · · · × Xk into
Z. Let Φ ∈CV, let J be a nondegenerate interval, and let fj ∈f
WΦ(J; Xj)
for j = 1, . . . , k. Let h(s) := L(f1(s), . . . , fk(s)) ∈Z for each s ∈J. Then
h ∈f
WΦ(J; Z) and
∥h∥[Φ] ≤M∥f1∥[Φ]∥f2∥[Φ] · · · ∥fk∥[Φ].
(3.14)
Proof. For k = 1, since L is linear and Φ is increasing, ∥h∥(Φ) ≤∥Mf1∥(Φ) =
M∥f1∥(Φ). Thus h ∈f
WΦ(J; Z) and (3.14) holds with k = 1.
Suppose k ≥2. We can and do assume M = 1. For a proof by induction
on k, let k = 2, X = X1, Y = X2, and x·y = L(x, y) as in (1.14). Let
f := f1 and g := f2, so that h ≡f·g. If f or g is constant then (3.14) holds
since ∥f·g∥(Φ) ≤∥f∥sup∥g∥(Φ) or ≤∥f∥(Φ)∥g∥sup, respectively, and so we can
assume that f and g are both non-constant. For s < t in J, we have
∥h(t) −h(s)∥≤∥f(t)·(g(t) −g(s))∥+ ∥(f(t) −f(s))·g(s)∥
≤∥f∥sup∥g(t) −g(s)∥+ ∥g∥sup∥f(t) −f(s)∥.
Let κ = {ti}n
i=0 be a partition of J. For i = 1, . . . , n, let ∆if := f(ti)−f(ti−1)
and ∆ig := g(ti)−g(ti−1). Also, let α := ∥g∥sup∥f∥(Φ) and β := ∥f∥sup∥g∥(Φ).
Since Φ is convex, we then have
sΦ((f·g)/(α + β); κ) ≤
n
X
i=1
Φ
n
α∥∆if∥/∥f∥(Φ) + β∥∆ig∥/∥g∥(Φ)
o
/(α + β)

≤
n
αvΦ(f/∥f∥(Φ)) + βvΦ(g/∥g∥(Φ))
o
/(α + β) ≤1,
where the last inequality holds by (3.9). Thus

108
3 Φ-variation and p-variation
∥f·g∥(Φ) ≤α + β = ∥g∥sup∥f∥(Φ) + ∥f∥sup∥g∥(Φ).
Clearly ∥f·g∥sup ≤∥f∥sup∥g∥sup, and so (3.14) holds for k = 2.
Now let k ≥3, and assume that the theorem holds for k −1 in place of
k. The linear space of all k-linear and M-bounded maps from X1 × · · · × Xk
into Z for 0 ≤M < ∞is a normed space, with norm the inﬁmum of all
M for which (3.13) holds, and is evidently a Banach space. Call this space
and its norm (L(X1, . . . , Xk; Z), ∥· ∥). For any xj ∈Xj, j = 1, . . . , k, let
H(x2, . . . , xk)(x1) := L(x1, x2, . . . , xk). Then H is evidently a (k −1)-linear
map from X2 × · · · × Xk into the space L(X1; Z) of bounded linear operators
from X1 into Z. Since for each xj ∈Xj, j = 2, . . . , k,
∥H(x2, . . . , xk)∥=
sup
∥x1∥≤1
∥L(x1, . . . , xk)∥≤∥x2∥· · · ∥xk∥,
H is 1-bounded and so H ∈L(X2, . . . , Xk; L(X1; Z)) with ∥H∥≤∥L∥. Let
g(s) := H(f2(s), . . . , fk(s)) for each s ∈J. Then by the induction assumption,
g ∈f
WΦ(J; L(X1, Z)) and
∥g∥[Φ] ≤∥f2∥[Φ] · · · ∥fk∥[Φ].
(3.15)
Now (A, x1) 7→Ax1 =: A·x1 is a bilinear, 1-bounded mapping from L(X1; Z)×
X1 into Z, and h(s) = g(s)(f1(s)) = g(s)·f1(s) for each s ∈J. By the case
k = 2, we get
∥h∥[Φ] ≤∥g∥[Φ]∥f1∥[Φ].
This together with (3.15) proves (3.14) and the theorem by induction.
2
If X is the set of real numbers, then functions with values in X can be
multiplied pointwise. So, we have the following special case of Theorem 3.8:
Corollary 3.9. Let J be a nondegenerate interval and Φ ∈CV. If f, g ∈
f
WΦ(J) then fg ∈f
WΦ(J) and
∥fg∥[Φ] ≤∥f∥[Φ]∥g∥[Φ].
(3.16)
Proof. For x, y ∈R, (x, y) 7→xy is a bilinear and 1-bounded mapping from
R×R into R. Thus by Theorem 3.8, the pointwise product fg of two functions
f, g ∈f
WΦ(J) also is in f
WΦ(J) and (3.16) holds, proving the corollary.
2
As soon as Banach algebras are deﬁned, in Section 4.1, Corollary 3.9 will be
extended to the space f
WΦ(J; B) of functions with values in a Banach algebra
B, in Proposition 4.13.
Let χ := χ(·) be the identity function on [0, 1].
Proposition 3.10. For Φ ∈V, the following are equivalent:

3.1 Φ-variation
109
(a) Φ(u) = O(u) as u ↓0;
(b) χ ∈WΦ[0, 1];
(c) χ ∈f
WΦ[0, 1];
(d) f ∈WΦ[0, 1] for some non-constant continuous f.
Proof. Assuming (a), take δ > 0 and K < ∞such that Φ(u) ≤Ku for
0 ≤u ≤δ. Then it is straightforward to check that vΦ(χ/(1/δ)) ≤Kδ, so (c)
holds. The implication (c) ⇒(d) is immediate (as is (b) ⇒(c)). For (d) ⇒(c)
suppose f is continuous and f(0) < f(1). We can assume that f(0) = 0. By
the intermediate value theorem, ﬁnd tq = t(q) such that f(tq) = qf(1) for each
rational q ∈[0, 1], with tq < tr for q < r. Then for any partition κ = {si}n
i=0 of
[0, 1] with all si rational, sΦ(f(1)χ; κ) = sΦ(f; λ), where λ = {t(si)}n
i=0 ∪{1}
is a partition of [0, 1]. Since Φ is continuous, it follows that f(1)χ ∈f
WΦ.
For (c) ⇒(b) let cχ ∈WΦ for some c > 0. Take an integer m > 0
such that m−1 < c. Then for any partition κ = {ti}n
i=0 of [0, 1], we have
sΦ(χ; κ) ≤S1 + S2, where
S1 :=
m
X
j=1
X n
Φ(ti −ti−1): (j −1)/m ≤ti−1 < ti ≤j/m
o
≤mvΦ(cχ)
and
S2 :=
m
X
j=1
n
Φ(ti −ti−1): ti−1 < j/m < ti
o
≤mΦ(1),
where summands are replaced by 0 if terms satisfying their conditions do not
exist, so vΦ(χ) ≤m[vΦ(cχ) + Φ(1)] < ∞.
For (b) ⇒(a) suppose that Φ(un)/un →+∞for some un ↓0. Then letting
⌊x⌋be the largest integer ≤x,
⌊u−1
n ⌋
X
i=1
Φ(iun −(i −1)un) = ⌊u−1
n ⌋Φ(un) ≥(u−1
n −1)Φ(un) →+∞
as n →∞, a contradiction. The proof is complete.
2
Complementary functions
For a convex function Φ ∈V, let
Φ∗(v) := sup

uv −Φ(u): u ≥0
	
,
v ≥0.
(3.17)
The function Φ∗so deﬁned may be zero and may have inﬁnite values on (0, ∞).
Both occur, for example, if Φ is the identity function, for v ≤1 or v > 1
respectively. In any case, Φ∗is convex as a supremum of aﬃne functions.
Clearly Φ∗(0) = 0 and Φ∗is nondecreasing. Let v0 := infu>0 Φ(u)/u and

110
3 Φ-variation and p-variation
v1 := supu>0 Φ(u)/u. Since Φ is convex, u 7→Φ(u)/u is nondecreasing, with
Φ(u)/u ↑v1 ≤+∞as u ↑+∞. We have Φ∗(v) < +∞for all v ∈[0, v1), a
nondegenerate interval or half-line, and Φ∗(v) = +∞for all v > v1. At all
points v of the interval [0, v1), Φ∗has a ﬁnite right derivative D+Φ∗(v) and
for v ∈(0, v1) also a ﬁnite left derivative D−Φ∗(v) (e.g. [53, Corollary 6.3.3]).
In particular, Φ∗is continuous on the interval [0, v1). Also, we have Φ∗(v) = 0
for all v ∈[0, v0]. It will be shown that Φ∗∈V if we assume in addition that
v0 = 0 and v1 = +∞, that is,
u−1Φ(u) ↓0
as u ↓0
and
u−1Φ(u) ↑+∞
as u ↑∞.
(3.18)
The class of all functions Φ ∈CV satisfying (3.18) will be denoted by CV∗.
For example, the function Ψ in Example 3.4 is in CV∗.
For Φ ∈CV∗, the function Φ∗deﬁned by (3.17) will be called the comple-
mentary function to the function Φ. Just by the deﬁnition of the complemen-
tary function we get the W. H. Young inequality:
uv ≤Φ(u) + Φ∗(v)
for u, v ≥0.
(3.19)
For example, let Φ(u) := u1+α/(1 + α) for an α with 0 < α < ∞. Then it is
easy to check that Φ∗(v) = αv(1+α)/α/(1 + α) for all v ≥0, so (3.19) gives for
all u, v ≥0,
uv ≤
u1+α
1 + α + αv(1+α)/α
1 + α
.
(3.20)
This last inequality appears as a lemma in one proof of H¨older’s inequality,
e.g. [53, Lemma 5.1.3]. In another example, (3.19) holds for the functions given
by Φ(u) = eu −u −1, u ≥0 and Φ∗(v) = (1 + v) log(1 + v) −v, v ≥0.
Note that in (3.20), in the notation of (3.19), Φ ∈CV∗, Φ∗∈CV∗, and
(Φ∗)∗= Φ. The latter two facts hold generally if Φ ∈CV∗, as the following
shows:
Proposition 3.11. For any Φ ∈CV∗, its complementary function Φ∗is in
CV∗, and Φ∗∗:= (Φ∗)∗= Φ.
Proof. As was noted after (3.17), it is clear that Φ∗(0) = 0 and Φ∗is nonde-
creasing. If Φ∗(v) = 0 then v ≤Φ(u)/u for each u > 0, and hence v = 0 by the
ﬁrst relation in (3.18). For each v ≥0, let uv := sup{u > 0: v −Φ(u)/u ≥0}.
By the second relation in (3.18), uv is ﬁnite and Φ∗(v) = sup{uv −Φ(u): 0 ≤
u ≤uv} < ∞for each v ≥0. As also noted after (3.17), Φ∗is convex, and
it is continuous and strictly increasing, that is, Φ∗∈CV. To prove (3.18)
with Φ∗in place of Φ, if v →0 then uv →0, and then Φ∗(v)/v →0 since
Φ∗(v) ≤uvv. If v →∞then by (3.19) for any u, Φ∗(v)/v ≥u −Φ(u)/v, and
so Φ∗(v)/v →∞, proving the ﬁrst part of the proposition.
For the second part, for any V > 0, let V ∈[D−Φ(u), D+Φ(u)] for some
u > 0. Due to convexity of Φ,

3.1 Φ-variation
111
Φ(x) −Φ(u)
x −u
≥V
or
Φ(x) −Φ(u)
x −u
≤V
according as x > u or x < u. In either case Φ(x) −Φ(u) ≥V (x −u) for
each x ≥0, and so uV −Φ(u) ≥xV −Φ(x) for each x ≥0. Thus by (3.17),
uV −Φ(u) = Φ∗(V ), giving equality in (3.19) for V in place of v, and the
inequality Φ∗∗(u) ≥uV −Φ∗(V ) = Φ(u). Since u > 0 is arbitrary, we have
that Φ∗∗≥Φ. The reverse inequality follows from the W. H. Young inequality
(3.19), proving that Φ∗∗= Φ. The proof of the proposition is now complete.
2
Alternatively, the complementary function to Φ can be deﬁned using the
right derivative P := D+Φ of Φ, which exists since Φ is convex. Thus P is a
nondecreasing and right-continuous function on [0, ∞). The conditions (3.18)
are equivalent to P(0) = 0 and P(t) ↑+∞as t ↑∞. Consider the right
inverse Q of P deﬁned by Q(t) := sup{s ≥0: P(s) ≤t} for t ≥0. Then,
like P, Q has the properties that Q: [0, ∞) →[0, ∞) is right-continuous and
nondecreasing, Q(0) = 0, and Q(t) ↑+∞as t ↑∞. Let Ψ(v) := ∫v
0 Q(t) dt for
v ≥0. Let A := {(s, t) : 0 ≤s ≤u, 0 ≤t ≤P(s)} and B := {(s, t) : 0 ≤
t ≤v, 0 ≤s ≤Q(t)}. If P(s) ≤t, then s ≤Q(t) by deﬁnition of Q(t). Thus
A ∪B ⊃R := [0, u] × [0, v] and by comparison of areas,
uv ≤
Z u
0
P(s) ds +
Z v
0
Q(s) ds = Φ(u) + Ψ(v)
for u, v ≥0.
(3.21)
If Q(t) > s, then P(s) ≤t since P is nondecreasing. Thus A ∩B ⊂{(s, t) :
s = Q(t) or t = P(s)}, and the area of A ∩B is always zero.
Suppose v = P(u) for a given u. Then if t < v, we have Q(t) ≤u, so
A ∪B ⊂R ∪{(s, t) : t = v}. Or, suppose u = Q(v) for a given v. Then if
s < u, we have P(s) ≤v, so A ∪B ⊂R ∪{(s, t) : s = u}. So if v = P(u) or
u = Q(v), then (A ∪B) \ R also has area 0, and (3.21) becomes an equality,
that is,
uP(u) = Φ(u) + Ψ(P(u))
∀u ≥0,
and
vQ(v) = Φ(Q(v)) + Ψ(v)
∀v ≥0.
(3.22)
For the complementary function Φ∗deﬁned by (3.17), (3.21) implies that
Ψ ≥Φ∗. Conversely, the second equation in (3.22), setting u := Q(v), implies
that Ψ ≤Φ∗. Thus Ψ ≡Φ∗and so inequality (3.21) agrees with inequality
(3.19). As shown in the proof of Proposition 3.11, equality holds in (3.19) if
P(u−) ≤v ≤P(u) for a given u. Symmetrically, since Q(v) ≡D+Ψ(v), the
same holds when Q(v−) ≤u ≤Q(v) for a given v.
Let Φ ∈CV∗and let Φ∗be its complementary function. For an X-valued
function f deﬁned on a nondegenerate interval J, let

112
3 Φ-variation and p-variation
|||f|||J,(Φ) := sup
n
n
X
i=1
∥f(ti) −f(ti−1)∥βi :
{ti}n
i=0 ∈PP (J),
n
X
i=1
Φ∗(βi) ≤1, βi ≥0
o
,
(3.23)
where PP (J) is the class of all partitions of J. It is easy to check that |||·|||(Φ) :=
|||·|||J,(Φ) is 0 only on constants. It is a seminorm equivalent to ∥·∥(Φ) on f
WΦ(J)
by the next proposition.
Proposition 3.12. For Φ in CV∗and f ∈f
WΦ(J), f 7→|||f|||(Φ) is a seminorm
and we have
∥f∥(Φ) ≤|||f|||(Φ) ≤2∥f∥(Φ).
(3.24)
Proof. We can assume that f is non-constant, so 0 < ∥f∥(Φ) < +∞and
|||f|||(Φ) > 0. To prove the second inequality in (3.24), let ∥f∥(Φ) = 1. For
{ti}n
i=0 ∈PP (J), let ∆if := f(ti) −f(ti−1), i = 1, . . . , n. Then by the W. H.
Young inequality (3.19) and (3.9), we have
n
X
i=1
∥∆if∥βi ≤vΦ(f) +
n
X
i=1
Φ∗(βi) ≤2
for any {βi}n
i=1 such that βi ≥0 and Pn
i=1 Φ∗(βi) ≤1. Since the partition
{ti}n
i=0 is arbitrary, the second inequality in (3.24) holds. Thus |||f|||(Φ) < ∞
and since the other properties of a seminorm clearly hold by the deﬁnition
(3.23), ||| · |||(Φ) is a seminorm on f
WΦ(J).
To prove the ﬁrst inequality in (3.24), let |||f|||(Φ) = 1. Let {ti}n
i=0 ∈PP (J),
and let βi := P(∥∆if∥) for i = 1, . . . , n, where P = D+Φ is the right derivative
of Φ. Since f is non-constant, not all ∆if = 0. By the ﬁrst equality in (3.22),
for each i = 1, . . . , n,
∆if
βi = Φ
 ∆if

+ Φ∗(βi).
(3.25)
Also, sn := Pn
i=1 Φ∗(βi) ≤1. Suppose not. By convexity of Φ∗, and since
sn > 1, we have Pn
i=1 Φ∗(βi/sn) ≤Pn
i=1 Φ∗(βi)/sn ≤1. Thus 1 = |||f|||(Φ) ≥
Pn
i=1 ∥∆if∥(βi/sn), and so by (3.25),
sn ≥
n
X
i=1
∆if
βi =
n
X
i=1
Φ
 ∆if

+ sn,
a contradiction since ∥∆if∥> 0 for some i, proving the claim that sn ≤1.
Then by (3.25) again, we have
1 = |||f|||(Φ) ≥
n
X
i=1
∆if
βi ≥
n
X
i=1
Φ
 ∆if

.

3.1 Φ-variation
113
Since {ti}n
i=0 is an arbitrary partition of J, it follows that vΦ(f; J) ≤1, and
so ∥f∥(Φ) ≤1 = |||f|||(Φ), proving the proposition.
2
As mentioned between (3.19) and (3.20), if Φ(u) ≡up/p, 1 < p < ∞, where
p here equals α+1 there, Φ ∈CV∗and its complementary function is Φ∗(v) ≡
vq/q, where p−1 + q−1 = 1. For such Φ, we have ∥f∥(Φ) = (1/p)1/p∥f∥(p).
Moreover, considering βi = q1/q∥f(ti) −f(ti−1)∥p−1/∥f∥p−1
(p) , i = 1, . . . , n, for
{ti}n
i=0 ∈PP (J), it is easy to check that Pn
i=1 Φ∗(βi) ≤1. It follows that
|||f|||(Φ) ≥q1/q∥f∥(p). Conversely, for any βi ≥0 such that Pn
i=1 Φ∗(βi) ≤1,
we have by the H¨older inequality
n
X
i=1
∥f(ti) −f(ti−1)∥βi ≤

n
X
i=1
∥f(ti) −f(ti−1)∥p1/p
n
X
i=1
βq
i
1/q
= q1/q
n
X
i=1
∥f(ti) −f(ti−1)∥p1/p
n
X
i=1
Φ∗(βi)
1/q
≤q1/q∥f∥(p).
Thus |||f|||(Φ) ≤q1/q∥f∥(p) and |||f|||(Φ) = q1/q∥f∥(p).
If p = q = 2, then |||f|||(Φ) =
√
2∥f∥(2) = 2∥f∥(Φ). Furthermore, if p ↓1 then
both (1/p)1/p →1 and q1/q →1. These examples show that the inequalities
(3.24) are sharp.
The seminorm ∥· ∥(Φ) resembles the Luxemburg norm ∥· ∥Φ on an Orlicz
space deﬁned by (1.24). The seminorm ||| · |||(Φ) also has an analogue for Orlicz
spaces, deﬁned as follows. Let (Ω, S, µ) be a measure space. For Ψ ∈V, let
BΨ(Ω, S, µ; R) be the set of µ-measurable functions g: Ω→R such that
∫ΩΨ(|g|) dµ ≤1. Let Φ ∈CV∗and let Φ∗be its complementary function. For
a µ-measurable function f on Ωwith values in X, let
|||f|||Φ := sup
 Z
Ω
∥f∥g dµ: g ∈BΦ∗(Ω, S, µ; R), g ≥0

≤+∞.
(3.26)
It will be shown that this gives a norm equivalent to ∥·∥Φ on the Orlicz space
LΦ(Ω, S, µ; X).
Proposition 3.13. Let (Ω, S, µ) be a measure space and let Φ be in CV∗. For
f ∈LΦ(Ω; X), we have
∥f∥Φ ≤|||f|||Φ ≤2∥f∥Φ,
(3.27)
and ||| · |||Φ is a norm on LΦ(Ω, S, µ; X).
Proof. We will ﬁrst prove the second inequality in (3.27). For some c with
0 < c < ∞we have
R
Φ(∥f∥/c)dµ ≤1. Then by the W. H. Young inequality
(3.19), for any nonnegative g ∈BΦ∗(Ω, S, µ; R), we have

114
3 Φ-variation and p-variation
Z
Ω
c−1∥f∥g dµ ≤
Z
Ω
Φ(c−1∥f∥) dµ +
Z
Ω
Φ∗(g) dµ ≤2,
so R ∥f∥g dµ ≤2c. Letting c ↓∥f∥Φ, the second inequality in (3.27) holds.
Thus |||f|||Φ < +∞. It follows directly from the deﬁnition (3.26) that ||| · |||Φ is
a seminorm on LΦ(Ω, S, µ; X). Since it vanishes only for functions f = 0 a.e.
(µ), it is a norm.
It remains to prove the ﬁrst inequality in (3.27). Let |||f|||Φ = 1. If
∫Φ(∥f∥) dµ = 0 then ∥f∥Φ ≤1. Thus we can and do assume ∫Φ(∥f∥) dµ > 0.
Let g := P(∥f∥), where P = D+Φ is the right derivative of Φ. By the ﬁrst
equality in (3.22),
∥f∥g ≡Φ
 ∥f∥

+ Φ∗(g).
(3.28)
We claim that ρ := ∫ΩΦ∗(g) dµ ≤1. Suppose not. By convexity of Φ∗, and
since ρ > 1, ∫ΩΦ∗(g/ρ) dµ ≤∫ΩΦ∗(g) dµ/ρ = 1. Thus ∫Ω∥f∥(g/ρ) dµ ≤
|||f|||Φ = 1, and so by (3.28),
ρ ≥
Z
Ω
∥f∥g dµ =
Z
Ω
Φ(∥f∥) dµ + ρ.
This is a contradiction since ∫ΩΦ(∥f∥) dµ > 0, proving the claim g ∈
BΦ∗(Ω, S, µ; R). Then by (3.28) again, we have
1 = |||f|||Φ ≥
Z
Ω
∥f∥g dµ ≥
Z
Ω
Φ(∥f∥) dµ,
and so ∥f∥Φ ≤1, proving the proposition.
2
The inequalities (3.27) are sharp, as will be shown by the same examples
used for the p-variation norms with Φ(u) ≡up/p, 1 < p < ∞, Φ∗(v) ≡
vq/q, and p−1 + q−1 = 1. In the present case, for such Φ, we have ∥f∥Φ =
(1/p)1/p∥f∥p. Taking g := q1/q∥f∥p−1/∥f∥p−1
p
, it follows that ∥g∥Φ∗= 1,
and hence |||f|||Φ ≥q1/q∥f∥p. The converse inequality holds by the H¨older
inequality as before, and so |||f|||Φ = q1/q∥f∥p. Now taking p = q = 2 or p ↓1
shows that inequalities (3.27) are sharp.
For a real-valued function f, we have
|||f|||Φ = sup

Z
Ω
fg dµ
: g ∈BΦ∗(Ω, S, µ; R)

.
(3.29)
Indeed, for real-valued and µ-measurable f and g,

Z
Ω
fg dµ
 ≤
Z
Ω
|f||g| dµ =

Z
Ω
f˜g dµ
,
where ˜g := |g| sgnf. Then ∫Φ∗(|g|) dµ = ∫Φ∗(|˜g|) dµ and so (3.29) follows.
The right side of (3.29) is called an Orlicz norm, e.g. [128, Section II.9].

3.1 Φ-variation
115
Moduli of continuity
A modulus of continuity will be a continuous, nondecreasing function φ from
[0, ∞) onto itself which is subadditive, so that for all u, v ≥0,
φ(u + v) ≤φ(u) + φ(v).
(3.30)
If φ is a modulus of continuity then φ is zero only at zero. If not then φ(u) = 0
for some u > 0. Then by (3.30), φ(nu) = 0 for each positive integer n, and so
φ(u) = 0 for each u > 0, a contradiction. Next, for 0 < u < v, we have
φ(v)
v
≤2φ(u)
u
.
(3.31)
To prove this, let n be the least integer such that nu ≥v. Then nu ≤2v, and
by (3.30), it follows that
φ(v)/v ≤φ(nu)/v ≤nφ(u)/v ≤2φ(u)/u,
as stated. Moreover, if φ is a modulus of continuity then
lim
u↓0
φ(u)
u
=
sup
0<u<u∗
φ(u)
u
for any 0 < u∗< ∞.
(3.32)
To prove this, let 0 < u∗< ∞and let 0 < v < u∗. For any 0 < u ≤v, let n be
the least integer such that v = nu + δ(u) with 0 ≤δ(u) < u. Then by (3.30),
φ(v)
v
≤nu
v
φ(u)
u
+ φ(δ(u))
v
.
Letting u ↓0 it follows that nu/v →1 and φ(δ(u))/v →0. Thus φ(v)/v ≤
lim infu↓0 φ(u)/u. Since v ∈(0, u∗) is arbitrary, we have
S :=
sup
0<v<u∗
φ(v)
v
≤lim inf
u↓0
φ(u)
u
≤lim sup
u↓0
φ(u)
u
≤S,
proving (3.32).
Property (3.31) can be strengthened for concave functions as follows:
Proposition 3.14. Let φ be a continuous, nondecreasing, concave function
from [0, ∞) onto itself. Then φ is a modulus of continuity and φ(u)/u is
nonincreasing in u > 0.
Proof. Let 0 ≤α ≤1. By concavity, φ(λx) ≥λφ(x) for λ = α or 1 −α
and each x ≥0, so φ(x) ≤φ(αx) + φ((1 −α)x). Taking x := u + v and
α := u/(u+v), it follows that φ is subadditive and so a modulus of continuity.
Also, by concavity, we have φ(λu)/(λu) ≥φ(u)/u for any 0 < λ ≤1 and u > 0,
proving the proposition.
2

116
3 Φ-variation and p-variation
If Φ ∈V is convex, then its inverse φ = Φ−1 will be a continuous, non-
decreasing and concave function from [0, ∞) onto itself, and so a modulus of
continuity by Proposition 3.14. The class of all functions Φ ∈V such that Φ−1
is a modulus of continuity will be denoted by VM.
The following shows that moduli of continuity can be taken to be concave
up to a factor of 2.
Proposition 3.15. Let φ be any modulus of continuity. Then there is a real-
valued least concave function φ ≥φ with φ ≤2φ. Here φ is a modulus of
continuity and is strictly increasing.
Proof. For t ≥0 let
φ(t) := inf

a + bt : a + bu ≥φ(u) for all u ≥0
	
,
or +∞if the given set is empty (it will be shown to be always nonempty). Then
clearly φ(t) ≤φ(t) for all t ≥0. Since φ is subadditive we have for each t > 0
and positive integer m that φ(mt) ≤mφ(t). Thus φ(u) ≤mφ(t) for (m−1)t <
u ≤mt, or equivalently m −1 < u/t ≤m. Thus φ(u) ≤(ut−1 + 1)φ(t) for all
u ≥0. It follows that φ has ﬁnite values with φ(u) ≤(ut−1 + 1)φ(t) for all
u ≥0. Setting u = t we get φ(t) ≤2φ(t) as stated.
Since φ is the inﬁmum of a nonempty set of concave functions and is
nonnegative, it is a real-valued concave function. Let ˜φ be the inﬁmum of
all concave functions ≥φ, which is then the least concave function ≥φ.
So φ ≤˜φ ≤φ. Suppose ˜φ(t) < φ(t) for some t. Since ˜φ is concave, its
subgraph {(u, v) : u ≥0, v ≤˜φ(u)} is a convex set. It has a support line
v = a + bu passing through the point (u, v) = (t, ˜φ(t)) [53, Theorem 6.2.7].
Then a + bu ≥˜φ(u) ≥φ(u) for all u ≥0, so φ(t) ≤˜φ(t), a contradiction. So
˜φ ≡φ and φ is the least concave function ≥φ.
Any concave function on an interval is continuous, in fact has ﬁnite one-
sided derivatives, on the interior of the interval. The function φ is continuous
at 0 and goes to +∞at +∞by the inequalities φ ≤φ ≤2φ. It follows from
Proposition 3.14 that φ is a modulus of continuity. Then since it is concave,
it must be strictly increasing. This ﬁnishes the proof.
2
3.2 Interval Functions, Φ-variation, and p-variation
In Section 2.1, for interval functions, we considered the properties of additivity
and upper continuity, and proved several facts. In this section, Φ-variation
and p-variation are considered for such functions, which are not necessarily
additive. In Chapter 9 we will deal with multiplicative interval functions.
Let J be a nonempty interval in R, possibly unbounded, and let X be a
Banach space. Recall that the class of all interval functions deﬁned on the

3.2 Interval Functions, Φ-variation, and p-variation
117
set I(J) of subintervals of J with values in X is denoted by I(J; X) (as just
after Corollary 2.2). Recall (Section 1.4) that an interval partition of J is a
ﬁnite sequence {Ai}n
i=1 of disjoint nonempty intervals with J = ∪n
i=1Ai and
Ai ≺Aj whenever i < j, and IP (J) denotes the set of all interval partitions of
J. The Φ-variation for interval functions is deﬁned similarly to the Φ-variation
for point functions, as follows.
Recall that V is the class of all functions Φ: [0, ∞) →[0, ∞) which are
strictly increasing, continuous, unbounded, and 0 at 0. Let µ ∈I(J; X) and
Φ ∈V. For A = {Ai}n
i=1 ∈IP (J), let the Φ-variation sum be
sΦ(µ; A) :=
n
X
i=1
Φ
µ

i[
j=1
Aj

−µ
 i−1
[
j=1
Aj


,
(3.33)
where a union over the empty set of indices is deﬁned as the empty set. For
an additive interval function µ and A = {Ai}n
i=1 ∈IP (J), clearly
sΦ(µ; A) =
n
X
i=1
Φ
 µ(Ai)

.
(3.34)
Recall that in Chapter 2 we deﬁned interval functions taking values in a
Banach space, such as R. An extended real-valued interval function is deﬁned
as a function from I(J) for some J into [−∞, ∞], for example into [0, ∞] as
in the following deﬁnition.
Deﬁnition 3.16. Let Φ ∈V and let µ be an X-valued interval function on
a nonempty interval J. The Φ-variation of µ on J will be an extended real-
valued interval function vΦ(µ) := vΦ(µ; ·) on J deﬁned by
vΦ(µ; A) := sup

sΦ(µ; A): A ∈IP (A)
	
≤+∞
(3.35)
if A ∈I(J) is nonempty, or as 0 if A = ∅. We say that µ has bounded Φ-
variation on J if sup{vΦ(µ; A): A ∈I(J)} < ∞. The class of all interval
functions µ ∈I(J; X) with bounded Φ-variation on J will be denoted by
IΦ(J; X), and IΦ(J) will denote IΦ(J; R). In the special case where Φ(u) ≡up,
u ≥0, for some 0 < p < ∞, we write sp := sΦ, vp := vΦ, and Ip := IΦ. We
call vp(µ) the p-variation of µ. Thus the p-variation of µ on J is an extended
real-valued interval function vp(µ) = vp(µ; ·) on J deﬁned by
vp(µ; A) := vp(µ; A, X) := sup

sp(µ; A): A ∈IP (A)
	
(3.36)
if A ∈I(J) is nonempty or as 0 if A = ∅.
Recall that, as deﬁned just before Theorem 2.7, AI(J; X) is the vector
space of additive and upper continuous interval functions on J with values
in X. Let AIΦ(J; X) := IΦ(J; X) ∩AI(J; X) and AIp(J; X) := Ip(J; X) ∩
AI(J; X). Also, let AIΦ(J) := AIΦ(J; R) and AIp(J) := AIp(J; R).

118
3 Φ-variation and p-variation
Remark 3.17. If µ is additive then by (3.34), sp(µ; A) = Pn
i=1 ∥µ(Ai)∥p for
A = {Ai}n
i=1 ∈IP (J). In this case, vΦ(µ; J) = sup{vΦ(µ; A): A ∈I(J)}. Let
µ be an interval function on I(J) where J = [[a, b]] with a < b. Then all the
(unions of) intervals on which µ is evaluated in the deﬁnition (3.33) are either
empty or of the form [[a, ti]] and moreover are left-open if and only if J is.
Suppose that vΦ(µ; J) < +∞. Let ν be another interval function on J such
that ν([[a, t]]) = µ([[a, t]]) for a ≤t ≤b but ν is deﬁned arbitrarily on other
intervals. Then sΦ(ν; A) = sΦ(µ; A) for every interval partition A of J and
vΦ(ν; J) = vΦ(µ; J) < +∞. But even if vΦ(µ; A) < +∞for all A ∈I(J), for
example if µ is additive, the same need not hold for ν if J is nondegenerate.
Thus we see that the condition vΦ(µ; J) < +∞, by itself, is not restrictive
except for values on intervals having the same left endpoint (and open- or
closedness there) as J. Thus, for general (non-additive) interval functions, we
take suprema over A ∈I(J) in deﬁning “bounded Φ-variation,” IΦ(J; X),
∥µ∥J,(p), and some related notions later. The deﬁnitions with suprema over
all subintervals of J will be useful especially for multiplicative and related
interval functions in Chapter 9.
If vΦ(µ; [a, b]) < ∞, the point functions Lµ,a and Rµ,a deﬁned by (2.3) are
of bounded Φ-variation, and hence regulated. If µ is upper continuous and
either Lµ,a or Rµ,a has bounded Φ-variation, then vΦ(µ; J) < ∞. Without
upper continuity, even for µ additive, this implication can fail, as Example
2.14 shows. Note also that the mapping h 7→µh from point functions to
interval functions deﬁned by (2.2) always gives an additive interval function.
Corollary 2.11 gives a mutual relation between suitable point functions and
additive interval functions. For a non-additive interval function µ on J = [a, b]
with a < b, when we take supA∈I(J) vΦ(µ; A), we would need to consider not
only functions Lµ,a or Rµ,a, but also Lµ,c or Rµ,c for a < c < b.
Φ-variation seminorms and norms
The interval function µf deﬁned by (2.2) with f as deﬁned in Example 3.4
shows that, in general, IΦ need not be a vector space. As in Deﬁnition 3.5,
we will extend IΦ to a vector space. Recall that CV is the class of convex
functions Φ ∈V.
Deﬁnition 3.18. Let J be a nonempty interval and let X be a Banach space.
For Φ ∈V, let eIΦ(J; X) be the set of all interval functions µ ∈I(J; X) such
that cµ ∈IΦ(J; X) for some c > 0. For Φ ∈CV and µ ∈eIΦ(J; X), let
∥µ∥(Φ) := ∥µ∥J,(Φ) := sup{inf{c > 0: vΦ(µ/c; A) ≤1}: A ∈I(J)}
and
∥µ∥[Φ] := ∥µ∥J,[Φ] := ∥µ∥J,sup + ∥µ∥J,(Φ),
where ∥µ∥J,sup = sup{∥µ(A)∥: A ∈I(J)} is the sup norm of µ. In the special
case where Φ(u) ≡up, u ≥0, for some 1 ≤p < ∞, let ∥µ∥(p) := ∥µ∥J,(p) :=
∥µ∥J,(Φ) and ∥µ∥[p] := ∥µ∥J,[p] := ∥µ∥J,sup + ∥µ∥J,(p).

3.2 Interval Functions, Φ-variation, and p-variation
119
Remark 3.19. As for point functions in Remark 3.6, one can verify that for
1 ≤p < ∞the deﬁnition of ∥µ∥J,(p) just given agrees with (1.21), so that
∥µ∥J,(p) = sup{vp(µ; A)1/p : A ∈I(J)}.
As noted there, by the H¨older and Minkowski inequalities, ∥· ∥J,(p) is a semi-
norm and ∥· ∥J,[p] a norm on Ip(J; X).
By Theorem 2.8, an additive upper continuous interval function µ has the
representation µh deﬁned by (2.2) for some point function h, and the sup
norm of µ is the oscillation of h. We will show in Proposition 3.22 that ∥·∥(Φ)
is a seminorm and ∥· ∥[Φ] is a norm, both on eIΦ(J; X), for general Φ ∈CV.
The next fact shows that Theorem 3.7(a) for point functions extends to
general interval functions, whereas a constant additive interval function must
be 0.
Proposition 3.20. Let J be a nonempty interval and let Φ ∈CV. For any
µ ∈eIΦ(J; X), ∥µ∥(Φ) = 0 if and only if µ is constant. For µ ∈eIΦ(J; X)
additive, ∥µ∥(Φ) = 0 if and only if µ ≡0.
Proof. If µ is constant then clearly ∥µ∥(Φ) = 0. If ∥µ∥(Φ) = 0 and µ is not
constant, take A ∈I(J) with µ(A) ̸= µ(∅). Thus if cn ↓0 then
vΦ(µ/cn; A) ≥sΦ(µ/cn; {A}) = Φ(∥µ(A) −µ(∅)∥/cn) →∞,
a contradiction, completing the proof since if µ is additive then µ(∅) = 0. 2
The next fact extends statement (b) of Theorem 3.7 to interval func-
tions and makes further statements in the additive case. Let f
AIΦ(J; X) :=
eIΦ(J; X) ∩AI(J; X).
Proposition 3.21. Let J be a nonempty interval and let Φ ∈CV with inverse
φ. For any µ ∈eIΦ(J; X) with ∥µ∥(Φ) > 0,
vΦ(µ/∥µ∥(Φ); A) ≤1
(3.37)
for each A ∈I(J). In particular, if µ ∈f
AIΦ(J; X) then ∥µ∥sup ≤φ(1)∥µ∥(Φ)
and so
∥µ∥(Φ) ≤∥µ∥[Φ] ≤(1 + φ(1))∥µ∥(Φ).
In particular, for µ ∈AIp(J; X) we have ∥µ∥sup ≤∥µ∥(p) and
∥µ∥(p) ≤∥µ∥[p] ≤2∥µ∥(p).
Proof. Let ∥µ∥(Φ) > 0. Suppose that vΦ(µ/∥µ∥(Φ); A) > 1 for some A ∈I(J).
Then for some interval partition A of A, sΦ(µ/∥µ∥(Φ); A) > 1. Since Φ is
continuous, sΦ(µ/u; A) > 1 for some u > ∥µ∥(Φ). Since Φ is increasing,

120
3 Φ-variation and p-variation
vΦ(µ/v; A) > 1 for 0 < v ≤u, a contradiction, proving the ﬁrst part of
the proposition. For the second part let µ be additive. If ∥µ∥(Φ) = 0 then
∥µ∥sup = 0 by Proposition 3.20. If ∥µ∥(Φ) > 0 then for any A ∈I(J),
Φ(∥µ(A)∥/∥µ∥(Φ)) ≤vΦ(µ/∥µ∥(Φ); A) ≤1. The remaining statements follow,
so the proof of the proposition is complete.
2
Now we are ready to prove that the Φ-variation for interval functions
deﬁnes a seminorm and a norm.
Proposition 3.22. Let J be a nonempty interval and let Φ ∈CV. Then on
eIΦ(J; X), ∥·∥(Φ) is a seminorm and ∥·∥[Φ] is a norm. On f
AIΦ(J; X), ∥·∥(Φ)
is a norm. In particular, ∥· ∥(p) is a norm on AIp(J; X).
Proof. For any µ ∈eIΦ(J; X) and c ∈R it is easy to see that ∥cµ∥(Φ) =
|c| ∥µ∥(Φ). If also ν ∈eIΦ(J; X), we want to show that
∥µ + ν∥(Φ) ≤∥µ∥(Φ) + ∥ν∥(Φ).
(3.38)
If ∥µ∥(Φ) = 0 then µ is constant by Proposition 3.20, and ∥µ + ν∥(Φ) = ∥ν∥(Φ)
by deﬁnition (3.33) of Φ-variation sums. Thus (3.38) holds when one of the
two terms on the right side is 0, so assume that neither is 0. Let u := ∥µ∥(Φ)
and v := ∥ν∥(Φ). Since Φ is convex, by (3.37), for each A ∈I(J), we have
vΦ((µ + ν)/(u + v); A) ≤
u
u + v vΦ(µ/u; A) +
v
u + v vΦ(ν/v; A) ≤1.
Thus (3.38) is proved and ∥· ∥(Φ) is a seminorm. Since ∥· ∥sup is a norm it
follows that ∥· ∥[Φ] is a norm. The statements about the additive case follow
from those in Propositions 3.20 or 3.21, ﬁnishing the proof.
2
Again as for the Φ-variation for point functions, we have Banach spaces of
interval functions with bounded Φ-variation.
Proposition 3.23. Let J be a nonempty interval, let X be a Banach space,
and let Φ ∈CV. Then (eIΦ(J; X), ∥· ∥[Φ]) is a Banach space.
Proof. A ∥·∥[Φ]-Cauchy sequence {µk}k≥1, being Cauchy for ∥·∥sup, converges
uniformly to some interval function µ on J. Thus for any A ∈I(J), any
interval partition A of A and c > 0, sΦ(µj/c; A) →sΦ(µ/c; A) and sΦ((µk −
µj)/c; A) →sΦ((µk −µ)/c; A) for each k as j →∞, so µ ∈eIΦ(J; X) and
∥µk −µ∥(Φ) →0 as k →∞.
2
As in the proof of Proposition 3.2, it follows that eIΦ = IΦ if Φ ∈V
satisﬁes the ∆2 condition. In particular, (Ip(J; X), ∥· ∥[p]) is a Banach space
for 1 ≤p < ∞.

3.2 Interval Functions, Φ-variation, and p-variation
121
Corollary 3.24. Let Φ ∈CV and let µ ∈eIΦ(J; X) be additive. Then for any
nonempty intervals A ≺B such that A ∪B ∈I(J),
∥µ∥A∪B,(Φ) ≤∥µ∥A,(Φ) + ∥µ∥B,(Φ).
(3.39)
Proof. Writing µC(D) := µ(C ∩D) for intervals C and D, (3.39) follows from
subadditivity of ∥· ∥A∪B,(Φ) since µA∪B = µA + µB, ∥µA∥A∪B,(Φ) = ∥µ∥A,(Φ),
and ∥µB∥A∪B,(Φ) = ∥µ∥B,(Φ).
2
The p∗-variation
Let J be a nonempty interval and let µ be an additive and upper continuous
interval function on J with values in a Banach space X, that is, µ ∈AI(J; X).
Recall that for x ∈J, the singleton {x} is an atom of µ if µ({x}) ̸= 0. By
Proposition 2.6(c), the set of all atoms of µ is at most countable. Hence for
0 < p < ∞, and any set A ⊂J, the sum
σp(µ; A) :=
X
A
∥µ∥p :=
X
t∈A
∥µ({t})∥p
(3.40)
equals 0 if A is empty, is well deﬁned, and satisﬁes σp(µ; J) ≤vp(µ). Also, let
v∗
p(µ; A) :=
inf
B∈IP (A) sup
A⊐B
sp(µ; A)
(3.41)
if A ∈I(J) is nonempty, or 0 if A = ∅, and
σ∗
p(µ; A) :=
sup
B∈IP (A)
inf
B⊏A sp(µ; A)
(3.42)
if A ∈I(J) is nonempty, or 0 if A = ∅, where A ⊐B or equivalently B ⊏A
means that an interval partition A is a reﬁnement of an interval partition
B. Then σp(µ) = σp(µ; ·) restricted to I(J), v∗
p(µ) = v∗
p(µ; ·), and σ∗
p(µ) =
σ∗
p(µ; ·) are interval functions on J. In general we have the following relations:
Lemma 3.25. Let J be a nonempty interval, let µ ∈AI(J; X), and let 0 <
p < ∞. Then for each A ∈I(J),
σp(µ; A) ≤σ∗
p(µ; A) ≤v∗
p(µ; A) ≤vp(µ; A),
(3.43)
v∗
p(µ; A) =
inf
B∈YP (A) sup
A⊐B
sp(µ; A),
(3.44)
and
σ∗
p(µ; A) =
sup
B∈YP (A)
inf
B⊏A sp(µ; A),
(3.45)
where YP (A) is the class of all Young interval partitions of A.

122
3 Φ-variation and p-variation
Proof. We can assume that the interval A is nondegenerate. For (3.43), if
σp(µ; A) = +∞then for each positive integer N there is a point partition
B = {zj}m
j=0 of A such that P
B ∥µ∥p > N. Then for any interval partition
A which is a reﬁnement of the Young interval partition {(zj−1, zj)}m
j=1 of
A, sp(µ; A) ≥P
B ∥µ∥p, and so σ∗
p(µ; A) = +∞. Suppose that σp(µ; A) <
+∞. Given ǫ > 0 there exists a point partition B = {zj}m
j=0 of A such that
P
B ∥µ∥p ≥σp(µ; A) −ǫ. Then for any reﬁnement A of {(zj−1, zj)}m
j=1, we
have sp(µ; A) ≥P
B ∥µ∥p, and so the ﬁrst inequality in (3.43) holds. To
prove the second inequality one can assume that v∗
p(µ; A) < +∞. Suppose
that v∗
p(µ; A) < σ∗
p(µ; A). Then there exist interval partitions B1 and B2 of
A such that sup{sp(µ; A): A ⊐B1} < inf{sp(µ; A): A ⊐B2}. Let B3 be a
reﬁnement of B1 and B2. Then
sup
A⊐B3
sp(µ; A) ≤sup
A⊐B1
sp(µ; A) < inf
A⊐B2 sp(µ; A) ≤inf
A⊐B3 sp(µ; A),
a contradiction, proving the second inequality in (3.43). Since the third in-
equality is obvious, (3.43) holds.
For (3.44) and (3.45), let B ∈IP (J) and B ⊏C ∈YP (J). Then
sup{sp(µ; D): D ⊐C} ≤sup{sp(µ; D): D ⊐B} and inf{sp(µ; D): D ⊐C} ≥
inf{sp(µ; D): D ⊐B}. Thus “≥” in (3.44) and “≤” in (3.45) hold instead of
“=”. Since the reverse inequalities are obvious, the proof is complete.
2
The following fact shows that for 1 < p < ∞and µ real-valued the ﬁrst
inequality in Lemma 3.25 becomes an equation:
Proposition 3.26. Let µ ∈AI(J; R) and let 1 < p < ∞. Then σ∗
p(µ; A) =
σp(µ; A) for each A ∈I(J).
Proof. By Lemma 3.25, it is enough to prove that σ∗
p(µ; A) ≤σp(µ; A). We
can assume that the interval A is nondegenerate and σp(µ; A) < +∞. Let
ǫ > 0. We will prove that for each B ∈IP (A) there exists a reﬁnement A
of B such that sp(µ; A) ≤σp(µ; A) + ǫ. Choose a Young interval partition
{(zj−1, zj)}m
j=1 of A which is a reﬁnement of B such that
m
X
j=1
σp(µ; (zj−1, zj)) < ǫ/8.
This is possible because σp(µ) is an additive interval function on J, and
σp(µ; A) can be approximated arbitrarily closely by ﬁnite sums P
B |µ|p. Let
δj := σp(µ; (zj−1, zj)). Given j, it is enough ﬁnd a partition Aj of (zj−1, zj)
such that
sp(µ; Aj) ≤ǫj := 4δj + ǫ/(2m).
If µj := µ((zj−1, zj)) = 0 we can take Aj = {(zj−1, zj)}. Otherwise by
symmetry we can assume µj > 0. Choose M ≥1 large enough so that

3.2 Interval Functions, Φ-variation, and p-variation
123
2 max{M −p, µj/M p−1} ≤δj +ǫ/(2m). If µj ≤1/M, taking Aj := {(zj−1, zj)}
gives sp(µ; Aj) = µp
j ≤M −p ≤ǫj as desired, so we can assume µj > 1/M.
Let t0 := zj−1. Given t0, . . . , tk such that µ((zj−1, tk]) + 1/M < µj, let
tk+1 := inf{t: µ((tk, t]) > 1/M}. Then by upper continuity of µ and Propo-
sition 2.6(e), µ((tk, tk+1)) ≤1/M ≤µ((tk, tk+1]). Thus µ((zj−1, tk]) ≥k/M
for each k, so K, the largest k for which tk+1 is deﬁned by the recursion,
satisﬁes (K + 1)/M < µj. Then tK+1 < zj since there is some t < zj with
µ((tk, t]) > 1/M by Proposition 2.6(e). Set tK+2 := zj, and let Aj be the
Young interval partition {(ti−1, ti)}K+2
i=1 of (zj−1, zj). For each i = 1, . . . , K+1,
1/M −µ({ti}) ≤µ((ti−1, ti)) ≤1/M, so |µ((ti−1, ti))| ≤max{1/M, µ({ti})}.
We have µ((zj−1, tK+1]) ≤µ((zj−1, tK])+1/M +µ({tK+1}) < µj +µ({tK+1})
and µ((zj−1, tK+1]) ≥µj −1/M. Now µ((zj−1, tK+1)) < µj −(1/M)+1/M =
µj, so µ([tK+1, tK+2)) > 0 and −µ({tK+1}) < µ((tK+1, tK+2)) ≤1/M and
|µ((tK+1, tK+2))| ≤max{1/M, µ({tK+1})}. Thus
K+2
X
k=1
|µ((tk−1, tk))|p ≤(K + 2)/M p + 2δj
and
sp(µ; Aj) ≤(K + 2)/M p + 3δj < µj/M p−1 + (7/2)δj + ǫ/(4m)
< 4δj + ǫ/(2m) = ǫj.
The proof of Proposition 3.26 is complete.
2
Lemma 3.27. Let J be a nonempty interval, µ ∈AI(J; X), and 0 < p < ∞.
For A ∈I(J),
σ∗
p(µ; A) = v∗
p(µ; A) < +∞
(3.46)
if and only if the limit
lim
A sp(µ; A)
(3.47)
exists under reﬁnements of partitions A of A (and is ﬁnite). Moreover, for
A, B ∈I(J), if B ⊂A and (3.46) holds then (3.46) holds with B in place of
A.
Proof. We can assume that the interval A ∈I(J) is nondegenerate. Let (3.46)
hold and ǫ > 0. By deﬁnitions (3.41) and (3.42), there exist interval partitions
B1 and B2 of A such that
sup
A⊐B1
sp(µ; A) < v∗
p(µ; A) + ǫ
and
inf
A⊐B2 sp(µ; A) > σ∗
p(µ; A) −ǫ.
Taking a reﬁnement B3 of B1 and B2, we have for each reﬁnement A of B3,
σ∗
p(µ; A) −ǫ < sp(µ; A) < v∗
p(µ; A) + ǫ.

124
3 Φ-variation and p-variation
Since σ∗
p(µ; A) = v∗
p(µ; A), it then follows that the limit (3.47) exists. Con-
versely, suppose that the limit (3.47) exists but σ∗
p(µ; A) ̸= v∗
p(µ; A), and so
by Lemma 3.25,
σ∗
p(µ; A) < v∗
p(µ; A).
(3.48)
The existence of a ﬁnite limit implies that v∗
p(µ; A) < +∞. Let B be an interval
partition of A. Recursively, there are interval partitions B ⊏A1 ⊏A2 ⊏· · ·
such that sp(µ; Ak) > v∗
p(µ) −1/k for k odd, and sp(µ; Ak) < σ∗
p(µ) + 1/k
for k even. Thus by (3.48), the limit (3.47) cannot exist. This contradiction
completes the proof of the ﬁrst part.
To prove the second part, let A, B ∈I(J), B ⊂A and let (3.46) hold.
By the ﬁrst part, (3.47) holds and given ǫ > 0, there is an interval partition
A1 ∈IP (A) such that ∥sp(µ; A) −sp(µ; A1)∥< ǫ for each reﬁnement A of
A1. We can assume that there is a subfamily B1 of A1 which is an interval
partition of B. Let B be a reﬁnement of B1, and let A := B ∪(A1 \ B1). Then
A is a reﬁnement of A1 and
∥sp(µ; B) −sp(µ; B1)∥= ∥sp(µ; A) −sp(µ; A1)∥< ǫ.
Therefore the limit limB sp(µ; B) exists under reﬁnements of partitions B of
B and (3.46) holds with B in place of A by the ﬁrst part, proving the lemma.
2
Proposition 3.26 and Lemma 3.27 show that for 1 < p < ∞and X = R
the property deﬁned next is equivalent to existence of the limit (3.47) of p-
variation sums.
Deﬁnition 3.28. Let J be a nonempty interval, let µ ∈AI(J; X), and let
0 < p < ∞. We will say that µ has p∗-variation, and write µ ∈AI∗
p(J; X), if
σp(µ; J) = v∗
p(µ; J) < +∞. If X = R then we write µ ∈AI∗
p(J).
The following gives a useful characterization of p∗-variation.
Lemma 3.29. Let J be a nondegenerate interval, let µ ∈AI(J; X), and let
1 < p < ∞. Then µ has p∗-variation if and only if for every ǫ > 0, there
exists a Young interval partition {(zj−1, zj)}m
j=1 of J such that
m
X
j=1
vp(µ; (zj−1, zj)) < ǫ.
(3.49)
Proof. It is easy to see that for any interval partition A = {Ai}n
i=1 of J,
n
X
i=1
vp(µ; Ai) = sup

sp(µ; B): B ∈IP (J), B ⊐A
	
.
In (3.41), by (3.44), we can equivalently take B ∈YP (J). It then follows that

3.2 Interval Functions, Φ-variation, and p-variation
125
v∗
p(µ; J) = inf
n
n
X
i=1
vp(µ; Ai): {Ai}n
i=1 ∈YP (J)
o
.
(3.50)
Let µ have p∗-variation. Then given ǫ > 0, there exists a Young interval
partition {(zj−1, zj)}m
j=1 of J such that for B := {zj}m
j=0 ∩J,
m
X
j=1
vp(µ; (zj−1, zj)) +
X
B
∥µ∥p < v∗
p(µ; J) + ǫ/2
and P
B ∥µ∥p > σp(µ) −ǫ/2. Since v∗
p(µ) = σp(µ), (3.49) follows.
Conversely, suppose that for every ǫ > 0 there is a Young interval partition
{(zj−1, zj)}m
j=1 of J such that (3.49) holds. Then v∗
p(µ; J) < +∞. Suppose that
σp(µ; J) ̸= v∗
p(µ; J). Then by Lemma 3.25, v∗
p(µ; J) −σp(µ; J) ≥C for some
positive constant C. Let {(zj−1, zj)}m
j=1 be any Young interval partition of J,
and let B := {zj}m
j=0 ∩J. Then by (3.50),
m
X
j=1
vp(µ; (zj−1, zj)) ≥v∗
p(µ; J) −
X
B
∥µ∥p ≥v∗
p(µ; J) −σp(µ; J) ≥C > 0,
a contradiction for ǫ < C, proving that µ has p∗-variation.
2
Comparing the Φ-variation for interval and point functions
Recall the notations [[a, b) and [a, b]] and the like from Section 1.4. In Proposi-
tion 2.6 and Theorem 2.8 we characterized AI([[a, b]]; X), the class of all addi-
tive upper continuous interval functions deﬁned on a given interval J = [[a, b]]
with a < b, and having values in a Banach space X. With each such interval
function µ one can associate a class of regulated functions h on [a, b]] such
that h(a) = 0 and µ = µh on I(J), where µh is deﬁned by (2.2). In general for
a regulated function h, boundedness of the Φ-variation of the corresponding
interval function µh does not imply that the Φ-variation of h is also bounded.
For example, let a function h equal 0 everywhere except on a sequence {xn}
of points of (a, b) with h(xn) →0 slowly as n →∞(see Proposition 2.10).
Then the interval function µh is identically 0. However, vΦ(µh; J) = vΦ(h; J)
provided h(a) = 0 and h is either right-continuous or left-continuous at each
point. This is a consequence of the following fact about interval functions
which are not necessarily additive.
Proposition 3.30. Let Φ ∈V, let µ be an X-valued interval function on
J = [[a, b]] with a < b, and let f be a regulated function on J such that
f(a) = µ(∅) if J = [a, b]], f(b) = µ(J) if J = [[a, b], f(t−) = µ([[a, t)) for
t ∈(a, b]], and f(t+) = µ([[a, t]) for t ∈[[a, b). Then vΦ(µ; J) ≤vΦ(f; J). If in
addition for each t ∈(a, b), f is either right-continuous or left-continuous at
t, then vΦ(µ; J) = vΦ(f; J).

126
3 Φ-variation and p-variation
Proof. Suppose that vΦ(f; J) < ∞. Let A = {Ai}n
i=1 be an interval partition
of J. For i ∈{1, . . . , n −1}, let {ti,m}m≥1 ⊂J be such that ti,m ↓t for
the right endpoint t of Ai if Ai is right-closed, or ti,m ↑t otherwise, where
t is then the left endpoint of the left-closed interval Ai+1. For i ∈{0, n}, let
{ti,m}m≥1 ⊂J be such that t0,m ↓a if J = (a, b]], or t0,m = a for all m
otherwise, and let tn,m ↑b if J = [[a, b), or tn,m = b for all m otherwise. For m
large enough, t0,m < t1,m < · · · < tn,m, and for such m let κm := {ti,m}n
i=0 ∈
PP (J). Then sΦ(f; κm) →sΦ(µ; A) as m →∞. Since A ∈IP (J) is arbitrary,
vΦ(µ; J) ≤vΦ(f; J).
To prove the reverse inequality if for each t ∈(a, b), f is either left- or
right-continuous at t, we can assume that vΦ(µ; J) < ∞. Let κ = {ti}n
i=0 ∈
PP (J). For i = 1, . . . , n, let Ai be an interval with endpoints ti−1 and ti.
More speciﬁcally, for i = 1, . . . , n −1, take Ai to be right-closed and Ai+1 to
be left-open if f is right-continuous at ti, or otherwise take Ai to be right-open
and Ai+1 to be left-closed. Take the left endpoint of A1 to be a if J = [a, b]].
Otherwise take A0 = (a, t0) and A1 left-closed if f is left-continuous at t0 > a,
or A0 = (a, t0] and A1 left-open if f is right-continuous at t0. Finally, take the
right endpoint of An to be b if J = [[a, b]. Otherwise take An+1 = (tn, b) and
An right-closed if f is right-continuous at tn < b, or An+1 = [tn, b) and An
right-open if f is left-continuous at tn. Then A := {Ai} is an interval partition
of J and sΦ(f; κ) ≤sΦ(µ; A) ≤vΦ(µ; J). Since κ is arbitrary the conclusion
follows, and the proof is complete.
2
If in the preceding proposition the interval function µ on J = [[a, b]] is
additive and f = Rµ,a or f = Lµ,a, where Rµ,a and Lµ,a are both deﬁned by
(2.3), then µ must be upper continuous by Proposition 2.6. In this case the
following provides a relation between the Φ-variations of interval functions µ
and the point functions Rµ,a and Lµ,a over subintervals of J.
Proposition 3.31. Let Φ ∈V and µ ∈AI([[a, b]]; X). Let B ∈I[[a, b]] be
nonempty. Then the following hold:
(a) vΦ(Rµ,a; B) ≤vΦ(µ; B), and vΦ(Rµ,a; B) = vΦ(µ; B) except when B is an
atom of µ or when B is left-closed and its left endpoint is an atom of µ in
(a, b]];
(b) vΦ(Lµ,a; B) ≤vΦ(µ; B), and vΦ(Lµ,a; B) = vΦ(µ; B) except when B is an
atom of µ or when B is right-closed and its right endpoint is an atom of
µ in [[a, b).
Proof. If B is a singleton {x} ⊂[[a, b]] then vΦ(µ; {x}) = Φ(∥µ({x})∥) and
vΦ(Rµ,a; {x}) = vΦ(Lµ,a; {x}) = 0. Thus the equalities in (a) and (b) hold in
this case if and only if B = {x} is not an atom of µ. Now let B = [[u, v]] for
some u, v ∈[[a, b]], u < v, and let A = {Ai}n
i=1 be an interval partition of
B. Let {ui}n
i=1 ⊂[u, v] be such that ∪1≤j≤iAj = [[u, ui]], i = 1, . . . , n. Here
u1 = u if B is left-closed and A1 = {u}, and u1 > u otherwise. For each

3.3 Elementary Properties
127
i = 2, . . . , n and for i = 1 if u1 > u, let {ti,m}m≥1 be a sequence of points
in [ui−1, ui] such that ui−1 < ti,m ↑ui if Ai is right-open, and ti,m = ui for
each m otherwise. Also if u1 > u let {t0,m}m≥1 be a sequence of points in
[u, t1,1) such that t0,m ↓u if B is left-open and t0,m = u for each m ≥1 if B is
left-closed. If u1 = u then take a sequence {t1,m}m≥1 of points in (u, t2,1) such
that t1,m ↓u, and let t0,m = u for each m ≥1. By Proposition 2.6(f), ﬁrst
we have limm→∞[Rµ,a(ti,m) −Rµ,a(ti−1,m)] = µ(Ai) for each i = 2, . . . , n.
Let T := limm→∞

Rµ,a(t1,m) −Rµ,a(t0,m)

. Second, if u1 > u then we
have
T =
 µ(A1 \ {u}) if u > a and B = [u, v]],
µ(A1)
if u > a and B = (u, v]], or u = a ∈[[a, b]].
And third, if u1 = u, or equivalently A1 = {u}, then we have
T =
0
if u > a,
µ({a}) if u = a ∈[[a, b]].
Thus in any case (u1 > u or u1 = u), T = µ(A1) if B = (u, v]] with u > a or if
B = [[a, v]]. If B = [u, v]] with u > a then T = µ(A1) if and only if µ({u}) = 0.
Since Φ is continuous, whenever T = µ(A1) it follows that
sΦ(µ; A) = lim
m→∞
n
X
i=1
Φ
 ∥Rµ,a(ti,m) −Rµ,a(ti−1,m)∥

≤vΦ(Rµ,a; B).
Hence vΦ(µ; B) ≤vΦ(Rµ,a; B) for each B ∈I[[a, b]] such that B is not an atom
of µ and the left endpoint of B is not an atom of µ in (a, b]] if B is left-closed.
For the converse inequality, let B ∈I[[a, b]] and let κ = {ti}n
i=0 be a point
partition of B. Then Rµ,a(ti) −Rµ,a(ti−1) = µ((ti−1, ti]) for i = 2, . . . , n, and
Rµ,a(t1) −Rµ,a(t0) =
µ([t0, t1]) if t0 = a ∈[[a, b]],
µ((t0, t1]) if t0 > a.
Thus sΦ(Rµ,a; κ) ≤vΦ(µ; B) for any partition κ of B, and so vΦ(Rµ,a; B) ≤
vΦ(µ; B) for any B ∈I[[a, b]], proving (a). The proof of (b) is symmetric, and
is therefore omitted. The proof of the proposition is complete.
2
3.3 Elementary Properties
In this section we collect several properties of a point function f : J →X and
its Φ-variation deﬁned by (3.1), and of an interval function µ: I(J) →X and
its Φ-variation deﬁned by (3.35).

128
3 Φ-variation and p-variation
Point functions
It is easy to see that for any a < c < b,
vΦ(f; [[a, c]) + vΦ(f; [c, b]]) ≤vΦ(f; [[a, b]]).
(3.51)
Thus the function [[a, b]] ∋t 7→vΦ(f; [[a, t]) =: Gf,Φ(t) on a nonempty inter-
val [[a, b]] is nondecreasing, and bounded provided f has bounded Φ-variation
on [[a, b]]. One can use the function Gf,Φ to characterize boundedness of Φ-
variation of f as follows.
Let G be a nondecreasing function from a nonempty interval J into R,
and let φ be a function from [0, ∞) into itself. Then ∥∆f∥≤φ(∆G) on J
will mean that for any s, t ∈J, ∥f(s) −f(t)∥≤φ(|G(s) −G(t)|). Here is a
characterization of functions in WΦ:
Proposition 3.32. For any Φ ∈V, with inverse φ = Φ−1, and function f
from an interval [[a, b]] into a Banach space X, f ∈WΦ([[a, b]]; X) if and only
if there is a nondecreasing, bounded function G on [[a, b]] such that ∥∆f∥≤
φ(∆G) on [[a, b]], and then vΦ(f) ≤Osc(G; [[a, b]]). Speciﬁcally, we can take
G = Gf,Φ.
Proof. We can assume that a < b. Let f ∈WΦ. Then H := Gf,Φ is nonde-
creasing and bounded. It is easily seen that if s, t ∈[[a, b]] and s ≤t, then
H(s) + Φ(∥f(t) −f(s)∥) ≤H(t),
so Φ(∥f(t) −f(s)∥) ≤H(t) −H(s) and ∥∆f∥≤φ(∆H) on [[a, b]].
Conversely if ∥∆f∥≤φ(∆G) on [[a, b]] for some nondecreasing, bounded
G, then for any partition κ = {xi}n
i=0 of [[a, b]],
sΦ(f; κ) ≤
n
X
i=1
G(xi) −G(xi−1) ≤Osc(G; [[a, b]]) < ∞.
The proposition is proved.
2
By Proposition 3.32, for Φ ∈V with inverse φ = Φ−1 and a ≤b, a function
f has bounded Φ-variation on [[a, b]] if and only if there is a nondecreasing,
bounded function G on [[a, b]] such that ∥∆f∥≤φ(∆G) on [[a, b]]. Clearly f
can be discontinuous at each point of [[a, b]] where G is discontinuous. But we
show next that it cannot have discontinuities other than of the ﬁrst kind, that
is, f must be regulated (as deﬁned in Section 2.1).
Proposition 3.33. For any Φ ∈V, each function f with ﬁnite Φ-variation
is regulated.

3.3 Elementary Properties
129
Proof. Let vΦ(f; J) < ∞for some Φ ∈V and a nondegenerate interval J. It
will be shown that for each t ∈¯J which is not the right endpoint of J, f has
a right limit at t. Suppose infδ>0 Osc (f; (t, t+δ)) =: ǫ > 0, where for an open
interval (u, v) ⊂J,
Osc(f; (u, v)) = sup

∥f(t) −f(s)∥: u < s ≤t < v
	
.
Take t < u1 < v1 ∈J such that ∥f(u1) −f(v1)∥> ǫ/2. Given t < un <
vn < un−1 < · · · < u1 < v1, choose t < un+1 < vn+1 < un such that
∥f(un+1) −f(vn+1)∥> ǫ/2. This can be done for all n = 1, 2, . . . . Then
vΦ(f; J) ≥nΦ(ǫ/2) for all n, a contradiction. So f has a right limit at t.
Likewise f has a left limit at each s ∈¯J which is not the left endpoint for J,
so f is regulated.
2
Next we construct a continuous function g of bounded Φ-variation such
that f = g◦Gf,Φ. Let f ∈WΦ((a, b]]) with a < b. If f(a) is deﬁned, then clearly
also f ∈WΦ([a, b]]). If f(a) is not originally deﬁned, it can be deﬁned as a limit
f(a) := limx↓a f(x), and then vΦ(f; [a, b]]) = vΦ(f; (a, b]]). Symmetrically, we
can treat f(b) for f ∈WΦ([[a, b)) with a < b. Recall that VM is the set of all
Φ ∈V such that Φ−1 is a modulus of continuity.
Proposition 3.34. Let a < b and f ∈WΦ([a, b]; X) for some Φ ∈VM.
Then for each nondecreasing function χ: [a, b] →[0, ∞) such that χ(a) =
limx↓a χ(x) = 0 and
Gf,Φ(t) −Gf,Φ(s) ≤χ(t) −χ(s)
for s, t ∈[a, b], s ≤t,
there exists a continuous function g: [0, χ(b)] →X such that f = g◦χ on [a, b]
and
∥g(v) −g(u)∥≤5Φ−1(v −u)
for 0 ≤u ≤v ≤χ(b).
Proof. The range of χ is of the form [0, χ(b)]\∪jIj where each Ij is an interval
of the form [χ(t−), χ(t)), (χ(t−), χ(t)), (χ(t), χ(t+)), or (χ(t), χ(t+)]. Deﬁne
g(u) for u in the range of χ, that is, for u = χ(t), t ∈[a, b], by g(u) := f(t).
Then letting φ := Φ−1 and using the bounds (from Proposition 3.32) ∥∆f∥≤
φ(∆Gf,Φ) ≤φ(∆χ), we have
∥g(u) −g(v)∥≤φ(|u −v|)
(3.52)
for all u, v in the range of χ. If χ does not have a point χ(t−) or χ(t+) in
its range then we can extend g to each such point by continuity using (3.52).
Then g is deﬁned on [0, χ(b)] except on countably many disjoint open intervals
(uj, vj). Extend g to such intervals by
g(αuj + (1 −α)vj) := αg(uj) + (1 −α)g(vj),
0 ≤α ≤1.
Then for 0 ≤α ≤β ≤1, using (3.31), we have

130
3 Φ-variation and p-variation
g(αuj + (1 −α)vj) −g(βuj + (1 −β)vj)

=
(β −α)
 g(uj) −g(vj)
 = (β −α)
g(uj) −g(vj)

≤(β −α)φ(vj −uj) ≤2φ
 (β −α)(vj −uj)

= 2φ
 |αuj + (1 −α)vj −βuj −(1 −β)vj|

.
Suppose ui < w < vi ≤uj < z < vj. Then
|g(z) −g(w)| ≤|g(z) −g(uj)| + |g(uj) −g(vi)| + |g(vi) −g(w)|
≤2φ(z −uj) + φ(uj −vi) + 2φ(vi −w) ≤5φ(z −w)
since φ is nondecreasing. For other cases we get a similar bound with a factor
less than 5. So, for the extended g, the proposition is proved.
2
Reverse inequalities to (3.51) do not hold without additional assumptions
on the functions Φ or f or the point c. Indeed, let f be a function on [0, 2]
with values f(t) := 0 for t ∈[0, 1), f(1) := 1, and f(t) := 2 for t ∈(1, 2]. Then
for 1 < p < ∞, vp(f; [0, 1]) = vp(f; [1, 2]) = 1, while vp(f; [0, 2]) = 2p > 2. For
arbitrary f and c we have the following inequalities:
Proposition 3.35. For a function f ∈WΦ([[a, b]]; X) with Φ ∈V, and for
a < c < b, the following hold:
(a) if Φ is convex then
f

[[a,b]],(Φ) ≤
f

[[a,c],(Φ) +
f

[c,b]],(Φ);
(3.53)
(b) if Φ is convex and satisﬁes the ∆2 condition (3.3) then
vΦ(f; [[a, b]]) ≤(D/2)

vΦ(f; [[a, c]) + vΦ(f; [c, b]])
	
,
(3.54)
where D ≥2 is as in (3.3).
(c) Always
vΦ(f; [[a, b]]) ≤vΦ(f; [[a, c]) + vΦ(f; [c, b]]) + w,
where w := sup{w(u, v): u ∈[[a, c], v ∈[c, b]]} and
w(u, v) := Φ(∥f(v) −f(u)∥) −Φ(∥f(v) −f(c)∥) −Φ(∥f(c) −f(u)∥).
Proof. For part (a), replacing f by f −f(c) without changing any of the semi-
norms ∥f∥J,(Φ), we can assume f(c) = 0. Then ∥f1[[a,c]∥[[a,b]],(Φ) = ∥f∥[[a,c],(Φ),
∥f1[c,b]]∥[[a,b]],(Φ) = ∥f∥[c,b]],(Φ), and writing f = f1[[a,c] + f1[c,b]], (3.53) follows
from subadditivity of ∥· ∥[[a,b]],(Φ), proved in Theorem 3.7(c).
Next assume in addition that Φ satisﬁes the ∆2 condition. Then for s <
c ≤t, by convexity and (3.3), we have
Φ(∥f(t) −f(s)∥) ≤(1/2)

Φ(2∥f(t) −f(c)∥) + Φ(2∥f(c) −f(s)∥)

≤(D/2)

Φ(∥f(t) −f(c)∥) + Φ(∥f(c) −f(s)∥)

.
(3.55)

3.3 Elementary Properties
131
For a partition κ = {ti}n
i=0 of [[a, b]], we can assume that t0 ≤c ≤tn, and so
there is an index i0 such that ti0−1 < c ≤ti0. Then applying the preceding
bound to the i0th term in the sum sΦ(f; κ) and noting that D/2 ≥1 by
convexity gives the inequality (3.54).
Given a partition κ = {ti}n
i=0 of [[a, b]] and the index i0 as before, κ1 :=
{t0, . . . , ti0−1, c} and κ2 := {c, ti0, . . . , tn} (omitting c from κ2 if c = ti0) are
partitions of [[a, c] and [c, b]], respectively. Then (c) follows from the relation
sΦ(f; κ) = sΦ(f; κ1) + sΦ(f; κ2) + w(ti0−1, ti0).
The proof of the proposition is complete.
2
The following shows that bounded Φ-variation on adjoining subintervals
implies it on the closure of their union, although not providing as useful a
bound on the larger interval as we have from the preceding proposition.
Proposition 3.36. Let Φ ∈V, J := [a, b], and f : [a, b] →X. Suppose there
is a point partition κ = {ui}m
i=0 of J such that vΦ(f; (ui−1, ui)) < ∞for each
i = 1, . . . , m. Then vΦ(f; J) < +∞.
Proof. It is easily seen that f is bounded on J. Let τ = {tj}n
j=0 be any point
partition of J. In the Φ-variation sum sΦ(f; τ) there are terms such that for
some i, ui−1 < tj−1 < tj < ui, and at most 2m other terms. Thus we have
sΦ(f; τ) ≤2mΦ(2∥f∥sup,J) +
m
X
i=1
vΦ(f; (ui−1, ui)) < +∞,
and the conclusion follows.
2
Suppose a convex Φ ∈V does not satisfy the ∆2 condition. For n =
1, 2, . . . , take un > 0 such that Φ(2un) > nΦ(un). Let fn(t) := unt for
0 ≤t ≤2. Then by convexity, vΦ(fn; [0, 1]) = vΦ(fn; [1, 2]) = Φ(un) and
vΦ(fn; [0, 2]) = Φ(2un). Thus the ∆2 condition is necessary in order for (3.54)
to hold for some constant D < ∞, even for all linear functions f.
In Proposition 3.35(b), in the special case Φ(u) = up, u ≥0, with 1 ≤
p < ∞, we have D = 2p and D/2 = 2p−1. The following gives an extension to
more than two intervals provided the values of f at the common endpoints of
adjoining intervals are all equal. That assumption is vacuous if there are just
two intervals.
Proposition 3.37. Let f ∈Wp([[a, b]]; X) with 1 ≤p < ∞, let a = c0 < c1 <
· · · < cm = b with m ≥2, and let f(c1) = · · · = f(cm−1). Then
vp(f; [[a, b]]) ≤2p−1
m
X
j=1
vp(f; [cj−1, cj] ∩[[a, b]]).
(3.56)

132
3 Φ-variation and p-variation
Proof. Subtracting a constant which does not change vp(f) on any interval,
we can assume that f(cj) = 0 for j = 1, . . . , m −1. Let A := {cj}m−1
j=1
and
let κ = {xi}n
i=0 be a point partition of [[a, b]]. If (xi−1, xi) ∩A =: Ai ̸= ∅, let
ui := min Ai and vi := max Ai. Then each [xi−1, ui] and [vi, xi] is a subinterval
of some [cj−1, cj] ∩[[a, b]], with f(ui) = f(vi) = 0, and so by convexity of the
function [0, ∞) ∋u 7→up,
∥f(xi) −f(xi−1)∥p ≤2p−1
∥f(xi) −f(vi)∥p + ∥f(ui) −f(xi−1)∥p	
.
If (xi−1, xi) ∩A = ∅then [xi−1, xi] ⊂[cj−1, cj] ∩[[a, b]] for some j. Since
2p−1 ≥1, it then follows that for the p-variation sum sp as deﬁned after (3.2),
sp(f; κ) ≤2p−1
m
X
j=1
vp(f; [cj−1, cj] ∩[[a, b]]).
The proof of (3.56) is complete.
2
The following shows that boundedness of the Φ-variation depends only on
the behavior of Φ near zero.
Proposition 3.38. Let Φ, Ψ ∈V and suppose that for some c > 0, Φ(u) ≥
Ψ(u) for 0 ≤u ≤c. For a nonempty interval J and f : J →X, if vΦ(f; J) <
∞then vΨ(f; J) < ∞.
Proof. We can assume that J is a nondegenerate interval. Let f : J →X be
such that vΦ(f; J) < ∞and let κ = {ti}n
i=0 be a partition of J. Then
card{i: ∥f(ti) −f(ti−1)∥> c} ≤vΦ(f)/Φ(c) =: K.
(3.57)
By Proposition 3.33, f is regulated and so it is bounded by Corollary 2.2.
Letting N := Osc(f; J) it follows that sΨ(f; κ) ≤KΨ(N)+vΦ(f) < ∞. Since
κ is an arbitrary partition, the proof is complete.
2
Taking Ψ(u) = cu for 0 ≤u ≤c, for some c > 0, in the preceding proposi-
tion gives the following:
Corollary 3.39. Let Φ ∈V and suppose that lim infu↓0 Φ(u)/u > 0. For a
nonempty interval J and f : J →X, if vΦ(f; J) < ∞then v1(f; J) < ∞, that
is, f has bounded variation.
For a regulated function f on a nondegenerate interval J, given a constant
c > 0, there is a Young interval partition {(zj−1, zj)}m
j=1 of J such that the
oscillation Osc(f; (zj−1, zj)) ≤c for each 1 ≤j ≤m (Theorem 2.1). For
functions of bounded Φ-variation one can strengthen this property, replacing
the oscillation by the Φ-variation. We recall that by deﬁnition (3.1), the Φ-
variation over an open interval (u, v) is given by

3.3 Elementary Properties
133
vΦ(f; (u, v)) := sup
n
n
X
i=1
Φ
 f(ti) −f(ti−1)

: u < t0 < · · · < tn < v
o
.
Proposition 3.40. Let J be a nondegenerate interval, let f ∈WΦ(J; X) for
some Φ ∈V, and let c > 0. Then there exists a Young interval partition
{(zj−1, zj)}m
j=1 of J such that vΦ(f; (zj−1, zj)) ≤c for each 1 ≤j ≤m, and
m ≤1 + vΦ(f; J)/c.
Proof. Let J = [[a, b]] with a < b and let ρ(t) := vΦ(f; [[a, t]) for t ∈[[a, b]]. By
(3.51), it follows that
vΦ(f; (u, v)) =
lim
[t,s]↑(u,v) vΦ(f; [t, s])
≤lim
s↑v ρ(s) −lim
t↓u ρ(t) = ρ(v−) −ρ(u+)
(3.58)
for any a ≤u < v ≤b. Therefore the conclusion will follow from the next
lemma.
2
Lemma 3.41. Let ρ be a nondecreasing function on (a, b) with ρ(a+) ≥0,
and let c > 0. Then there exists a point partition {zj}m
j=0 of [a, b] such that
ρ(zj−) −ρ(zj−1+) ≤c for each 1 ≤j ≤m, and m ≤1 + ρ(b−)/c.
Proof. The lemma holds with m = 1 if c ≥ρ(b−) or ρ(a+) = ρ(b−). Suppose
max(ρ(a+), c) < ρ(b−). Let M be the smallest integer such that cM ≥ρ(b−)
and let z0 := a. For each n = 1, . . . , M, let zn
1 := inf{t ∈(z0, b): ρ(t) ≥
nc ∧ρ(b−)} and let n1 := min{n = 1, . . . , M −1: zn
1 > z0}, or n1 := M
if there is no such n. If n1 = M let z1 := b. Then ρ(a+) ≥(M −1)c and
ρ(b−) −ρ(a+) ≤Mc −(M −1)c = c. Thus the lemma holds with m = 1
in this case. If n1 < M let z1 := zn1
1 . It then follows that ρ(z1−) ≤n1c and
ρ(z0+) ≥(n1 −1)c.
Suppose zj < b and nj < M are chosen such that ρ(zj−) ≤njc and
ρ(zj−1+) ≥(nj −1)c. For each integer n with nj < n ≤M, let zn
j+1 := inf{t ∈
(zj, b): ρ(t) ≥nc ∧ρ(b−)} and let nj+1 := min{n: nj < n < M, zn
j+1 > zj},
or nj+1 := M if there is no such n. If nj+1 = M let zj+1 := b. Otherwise
let zj+1 := znj+1
j+1
and proceed further. The recursion stops after at most M
steps with a partition {zj}m
j=0 of [a, b]. Thus m ≤M ≤1 + ρ(b−)/c and
ρ(zj−) −ρ(zj−1+) ≤c for each j = 1, . . . , m, proving the lemma.
2
The four relations in the next lemma, with the Φ-variation replaced by the
oscillation and Φ on the right being the identity function, hold for a regulated
function. Boundedness of the Φ-variation again leads to stronger properties.
Proposition 3.42. Let f ∈WΦ([[a, b]]; X) for some Φ ∈V and a < b. If
u ∈[[a, b) then

134
3 Φ-variation and p-variation
lim
v↓u vΦ(f; (u, v]) = 0
and
lim
v↓u vΦ(f; [u, v]) = Φ(∥(∆+f)(u)∥).
(3.59)
If u ∈(a, b]] then
lim
v↑u vΦ(f; [v, u)) = 0
and
lim
v↑u vΦ(f; [v, u]) = Φ(∥(∆−f)(u)∥).
(3.60)
Proof. Let u ∈[[a, b). Suppose that limv↓u vΦ(f; (u, v]) =: δ > 0. Then there
is a v > u such that vΦ(f; (u, v]) < (3/2)δ. On the other hand, one can
choose partitions κ1 = {ti}n
i=0 of (u, v] and κ2 = {sj}m
j=0 of (u, t0) such
that sΦ(f; κ1) ≥(3/4)δ and sΦ(f; κ2) ≥(3/4)δ. Thus we have a partition
λ := κ1 ∪κ2 of (u, v] with sΦ(f; λ) ≥(3/2)δ. This contradiction proves the
ﬁrst relation in (3.59). The ﬁrst relation in (3.60) holds by a symmetric proof.
Also due to symmetry between the second relations in (3.59) and (3.60), we
prove only the former. Let u ∈[[a, b). Since f is regulated by Proposition 3.33,
the right side A := Φ(∥(∆+f)(u)∥) of (3.59) is deﬁned and A ≤vΦ(f; [u, v]),
which decreases to some ﬁnite limit as v ↓u. Suppose the limit is A + δ for
some δ > 0. Hence one can ﬁnd w ∈(u, b] such that vΦ(f; [u, w]) ≤A+(5/4)δ,
and for each v ∈(u, w],
Φ(∥f(v) −f(u)∥) −A
 < (1/8)δ.
(3.61)
On the other hand, there is a partition κ = {ti}n
i=0 of [u, w] such that
sΦ(f; κ) > A + (7/8)δ. Thus by (3.61) with v = t1, we have
n
X
i=2
Φ
 ∥f(ti) −f(ti−1)∥

= sΦ(f; κ) −Φ
 ∥f(t1) −f(u)∥

> (3/4)δ.
(3.62)
Doing the same for t1 in place of w we get a partition {sj}m
j=1 of (u, t1] such
that
m
X
j=2
Φ
 ∥f(sj) −f(sj−1)∥

> (3/4)δ.
(3.63)
Thus λ := {u, s1, . . . , sm = t1, . . . , tn} is a partition of [u, w] such that
sΦ(f; λ)
= Φ
 ∥f(s1) −f(u)∥

+
m
X
j=2
Φ
 ∥f(sj) −f(sj−1)∥

+
n
X
i=2
Φ
 ∥f(ti) −f(ti−1)∥

> A −(1/8)δ + (3/4)δ + (3/4)δ > A + (5/4)δ,
where the ﬁrst inequality follows by (3.61) with v = s1, (3.63), and (3.62).
This contradicts sΦ(f; λ) ≤vΦ(f; [u, w]) ≤A + (5/4)δ, proving the second
relation in (3.59). The proof of Proposition 3.42 is complete.
2

3.3 Elementary Properties
135
Corollary 3.43. For f ∈Wp([a, b]; X) with 1 ≤p < ∞and a < b, the
following four statements hold:
(a) limc↑b ∥f∥[a,c],(p) = ∥f∥[a,b),(p) and ∥f∥[a,b],(p) ≤∥f∥[a,b),(p) + ∥∆−f(b)∥;
(b) limc↓a ∥f∥[c,b],(p) = ∥f∥(a,b],(p) and ∥f∥[a,b],(p) ≤∥∆+f(a)∥+ ∥f∥(a,b],(p);
(c) limu↓a,v↑b ∥f∥[u,v],(p) = ∥f∥(a,b),(p).
(d) If ∆+f(a) = ∆−f(b) = 0, then ∥f∥[a,b],(p) = ∥f∥(a,b),(p).
Proof. We ﬁrst prove (c). Any point partition of (a, b) is a partition of some
[u, v] where a < u < v < b, and so ∥f∥[u,v],(p) ↑∥f∥(a,b),(p) as u ↓a and v ↑b.
Thus (c) holds. For (a), we have likewise ∥f∥[a,c],(p) ↑∥f∥[a,b),(p) as c ↑b. By
Proposition 3.35(a), we have for any c ∈(a, b),
0 ≤∥f∥[a,b],(p) −∥f∥[a,c],(p) ≤∥f∥[c,b],(p).
Now letting c ↑b, the second part of (a) follows from the ﬁrst part and the
second relation in (3.60). Then (b) follows by symmetry. Part (d) follows from
the proofs of (a) and (b), completing the proof.
2
If f has bounded Φ-variation on J = [[a, b]] and Gf,Φ(t) = vΦ(f; [[a, t]),
t ∈J, then by (3.51),
vΦ(f; [u, v]) ≤Gf,Φ(v) −Gf,Φ(u)
for any u, v ∈J, u ≤v.
(3.64)
Therefore if f on J is discontinuous at some point u, so that ∆+f(u) ̸= 0
for some u ∈[[a, b) or ∆−f(u) ̸= 0 for some u ∈(a, b]], then Gf,Φ is also
discontinuous at u by Proposition 3.42. The next proposition shows that the
converse implication holds.
Proposition 3.44. Let f ∈WΦ([[a, b]]; X) for some Φ ∈V and a < b. Then
for t ∈[[a, b) and s ∈(a, b]], ∆+Gf,Φ(t) = 0 or ∆−Gf,Φ(s) = 0 if and only if
respectively ∆+f(t) = 0 or ∆−f(s) = 0.
Proof. We will prove only the right-continuity equivalence because a proof of
the left-continuity equivalence is symmetric. If for some t ∈[[a, b), ∆+Gf,Φ(t) =
0, then ∆+f(t) = 0 by (3.64) and (3.59). Conversely, suppose that ∆+f(t) = 0
for some t ∈[[a, b). By Proposition 3.33, f is regulated, and hence c :=
Osc (f; [[a, b]]) < ∞. Since Φ is uniformly continuous on [0, c], given ǫ > 0 there
is a δ > 0 such that
Φ(v) −Φ(u)
 < ǫ for any u, v ∈[0, c] with |u −v| < δ.
Since f is right-continuous at t, by (3.59), there is a t0 ∈(t, b]] such that
∥f(r) −f(t)∥< δ and vΦ(f; [t, r]) < ǫ for each t < r ≤t0. Also, we have

f(s2) −f(s1)
 −
f(t) −f(s1)

 ≤
f(s2) −f(t)
 < δ
for any s1 ∈[[a, t] and s2 ∈(t, t0]. Therefore w < ǫ, where w is the supremum
of

136
3 Φ-variation and p-variation
Φ
 ∥f(s2) −f(s1)∥

−Φ
 ∥f(t) −f(s1)∥

−Φ
 ∥f(s2) −f(t)∥

over s1 ∈[[a, t] and s2 ∈[t, t0]. By inequality (c) of Proposition 3.35, it then
follows that Gf,Φ(r) −Gf,Φ(t) ≤vΦ(f; [t, r]) + w < 2ǫ for any r ∈(t, t0],
proving the proposition.
2
Lemma 3.45. ∥f∥(p) is a nonincreasing function of p > 0. Moreover, if 0 <
q < p < ∞then
∥f∥(p) ≤min
n
∥f∥(q), Osc(f)(p−q)/p∥f∥q/p
(q)
o
.
(3.65)
Proof. The ﬁrst part follows from the inequality (P
i ap
i )1/p ≤(P
i aq
i )1/q valid
for 0 < q < p < ∞and any ai ≥0, which clearly holds if all ai = 0. Otherwise,
letting r := p/q, bi := aq
i , and λi := bi/ P
j bj, we get P
i λr
i ≤1, which yields
the conclusion. To show the second part let κ be a partition of an interval J
where f is deﬁned. Writing p = q + (p −q), it follows that
sp(f; κ) ≤Osc(f; J)p−qvq(f; J),
and so (3.65) holds.
2
The class of functions considered in the next proposition will be used to
establish several properties of p-variation.
Proposition 3.46. Let 1 < p < ∞, let M > 1 be an even integer such that
M 1−(1/p) > 4, let {hk}k≥1 be a sequence of real numbers such that
∞
X
k=1
|hk|M −k/p < ∞,
(3.66)
and let
f(t) =
∞
X
k=1
hkM −k/p sin(2πM kt),
0 ≤t ≤1.
(3.67)
Then f ∈Wp[0, 1] if and only if supk≥1 |hk| < ∞.
The proposition will be proved using the following lemma, which is also
useful for other purposes. Recall that, as mentioned after the deﬁnition (1.18),
for 0 < α ≤1 we use “α-H¨older” and “α-H¨older continuous” synonymously.
Lemma 3.47. Let 1 < p < ∞, let M > 1 be an even integer, let {hk}k≥1 be
a sequence of real numbers such that (3.66) holds, and let f be the function
deﬁned by (3.67). If supk≥1 |hk| < ∞then f is a (1/p)-H¨older continuous
function on [0, 1]. Moreover, if M 1−(1/p) > 4, and if there is an integer n > 1
such that max1≤k<n |hk| ≤|hn|, then sp(f; κn) ≥(4/3p)|hn|p for the partition
κn = {i/(4M n)}4Mn
i=0
of [0, 1].

3.3 Elementary Properties
137
Proof. By (3.66), the series (3.67) converges uniformly for t ∈[0, 1]. To prove
(1/p)-H¨older continuity of f let ∥h∥:= supk≥1 |hk| < ∞and let 0 ≤s < t ≤1.
If t −s < 1/M let k0 = k0(t −s) ≥1 be the maximal integer in the set
{k: M k ≤1/(t −s)} and let k0 := 1 otherwise. Using | sin x −sin y| ≤|x −y|
and summing two geometric progressions, it follows that
|f(t) −f(s)| ≤2π(t −s)∥h∥
k0
X
k=1
M k(1−1/p) + 2∥h∥
X
k>k0
M −k/p ≤C(t −s)1/p
for a ﬁnite constant C depending only on p, M, and ∥h∥. Choosing M large
enough so that M 1/p > 2 and M 1−(1/p) > 2 we could take C = 4(π + 1)∥h∥.
To prove the second part of the conclusion, let M 1−(1/p) > 4 and let n > 1
be an integer such that max1≤k<n |hk| ≤|hn|. For k = 1, 2, . . . and 0 ≤t ≤1,
let fk(t) := hkM −k/p sin(2πM kt) and let ti := i/(4M n) for i = 0, . . . , 4M n.
For i = 1, . . . , 4M n, we have |fn(ti) −fn(ti−1)| = |hn|M −n/p. For k > n,
since M is an even integer, we have fk(ti) = 0 for each i. For 1 ≤k < n, since
| sin x−sin y| ≤|x−y|, we have |fk(ti)−fk(ti−1)| ≤(π/2)|hk|M (k−n)−k/p for
i = 1, . . . , 4M n. Thus for each i = 1, . . . , 4M n,
|f(ti) −f(ti−1)| ≥|fn(ti) −fn(ti−1)| −
n−1
X
k=1
|fk(ti) −fk(ti−1)|
≥

1 −(π/2)(M 1−1/p −1)−1
|hn|M −n/p > 3−1|hn|M −n/p
by the choice of M, and so the bound sp(f; κn) > (4/3p)|hn|p holds, proving
the lemma.
2
Proof of Proposition 3.46. If supk≥1 |hk| < ∞then f has bounded p-
variation by the ﬁrst part of the conclusion of Lemma 3.47. Conversely,
suppose that f ∈Wp[0, 1] but supk≥1 |hk| = ∞. Then for any ﬁnite con-
stant C > 0 there exists an integer n > 1 such that |hn| > C and
max1≤k<n |hk| ≤|hn|. By the second part of the conclusion of Lemma 3.47,
we have vp(f; [0, 1]) > 4(C/3)p, a contradiction since C can be arbitrarily
large. Thus supk≥1 |hk| < ∞, proving the proposition.
2
Let CWp[0, 1] denote the set of all continuous real-valued functions on
[0, 1] with bounded p-variation. A class of continuous functions of the form
(3.67) can be used to show that CWp[0, 1] is not separable with respect to the
p-variation norm.
Proposition 3.48. For 1 < p < ∞, (CWp[0, 1], ∥· ∥[p]) is nonseparable.
Proof. For each h := {hk}k≥1 with hk ∈{−1, 1}, let fh = P
k≥1 fh,k be the
function deﬁned by (3.67) with M = 2. By the ﬁrst part of the conclusion of

138
3 Φ-variation and p-variation
Lemma 3.47, fh ∈CWp[0, 1] for any such h. We will show that the p-variation
seminorm between any two diﬀerent such functions cannot be smaller than
a positive constant. Let h ̸= h′ = {h′
k}k≥1. Let n be the least k such that
hk ̸= h′
k, and let κn := {ti = i2−n−2}2n+2
i=0 . If n > 1 then fh,k ≡fh′,k for
each k = 1, . . . , n −1. If 1 ≤n < k then fh,k(ti) = fh′,k(ti) = 0 for each
i = 0, . . . , 2n+2. Thus for each i, we have
|(fh −fh′)(ti) −(fh −fh′)(ti−1)|
= |(fh,n −fh′,n)(ti) −(fh,n −fh′,n)(ti−1)| = 21−(n/p),
and so sp(fh −fh′; κn) = 22+p, proving the proposition.
2
It is easy to see that the H¨older space Hα[0, 1] with 0 < α ≤1 is non-
separable, as follows. Letting ft,α(x) := (x −t)α if 0 ≤t ≤x ≤1 and := 0
otherwise, for s ̸= t, we have ∥fs,α −ft,α∥(Hα) = 1. The natural injection
H1/p →CWp, 1 ≤p < ∞, is a bounded linear operator but not a homeomor-
phism onto its range. In fact, t 7→ft,1/p is continuous from [0, 1] into CWp but
not continuous into H1/p. So, these examples do not imply Proposition 3.48.
Interval functions
Analogously to (3.51), for an X-valued additive interval function µ on a
nonempty interval J, and for any subintervals A, B of J such that A ≺B and
A ∪B is an interval, we have
vΦ(µ; A) + vΦ(µ; B) ≤vΦ(µ; A ∪B).
(3.68)
As in the case of point functions, reverse inequalities do not hold without
additional assumptions on the functions Φ and µ or sets A, B. Indeed, let µ be
the additive interval function on [0, 1] equal to 1 on each singleton {1/3} and
{2/3}, and 0 on any interval containing neither point. Then for 1 < p < ∞,
vp(µ; [0, 1/2]) = vp(µ; (1/2, 1]) = 1, while vp(µ; [0, 1]) = 2p > 2.
Iterating (3.68), we have: for an additive interval function µ on J and for
any subintervals A, A1, . . . , An of J such that A1 ≺· · · ≺An and A1 ∪· · · ∪
An ⊂A,
n
X
i=1
vΦ(µ; Ai) ≤vΦ(µ; A).
(3.69)
In general, vΦ(µ) and vp(µ) are not additive interval functions. By contrast,
it is easily seen that if µ is additive and upper continuous, the interval function
σp(µ; ·) deﬁned by (3.40) is additive. We also have additivity for v∗
p deﬁned
by (3.41):
Proposition 3.49. Let µ be an additive upper continuous interval function
on a nonempty interval J having values in X. Then for 0 < p < ∞, v∗
p(µ; ·)
is also an additive interval function on J.

3.3 Elementary Properties
139
Proof. Let {A, B} be an interval partition of J. Then
v∗
p(µ; J) ≤
inf
B⊐{A,B} sup
A⊐B
sp(µ; A) ≤v∗
p(µ; A) + v∗
p(µ; B) =: C.
Suppose v∗
p(µ; J) < C. Then there is B ∈IP (J) such that supA⊐B sp(µ; A) <
C. Letting B ⊓A := {Dj ∩A}k
j=1 if B = {Dj}k
j=1 and similarly for B ⊓B, it
follows that
sup
A⊐B
sp(µ; A) ≥
sup
C⊐B⊓A
sp(µ; C) +
sup
D⊐B⊓B
sp(µ; D) ≥C,
where C ∈IP (A) and D ∈IP (B), a contradiction, proving v∗
p(µ; J) = C. 2
Proposition 3.50. Let µ ∈AIΦ(J; X) where Φ ∈V and J is a nonempty
interval. Then the interval function A 7→vΦ(µ; A), A ∈I(J), is upper con-
tinuous at ∅.
Proof. The conclusion can be obtained from Proposition 3.42 since for half-
open intervals A, vΦ(µ; A) = vΦ(h; A) for suitable h ∈WΦ(J; X) by Propo-
sition 3.31. Instead, we give a direct proof. Clearly vΦ(µ; B) ≤vΦ(µ; A) for
B ⊂A. Suppose that limn→∞vΦ(µ; Bn) = δ > 0 for some Bn ↓∅. There
exist {u, vn : n ≥1} in ¯J such that for all large enough n, either Bn = [[vn, u)
with vn ↑u or Bn = (u, vn]] with vn ↓u. By symmetry assume that the for-
mer holds. Then limn→∞supvn≤t<u ∥µ([[t, u))∥= 0. If not then there exists
a sequence {tk} such that tk ↑u and µ([[tk, u)) ̸→0, contradicting upper
continuity of µ and so proving the claim. Thus there is an integer n0 such
that
vΦ(µ; Bn0) < (5/4)δ
and
sup
vn0≤t<u
∥µ([[t, u))∥< Φ−1(δ/4).
(3.70)
On the other hand, there is an interval partition A′ = {Ai}m
i=1 of Bn0 such that
sΦ(µ; A′) > (3/4)δ. By the second relation in (3.70), Φ(∥µ(Am)∥) < δ/4. Thus
Pm−1
i=1 Φ(∥µ(Ai)∥) > δ/2. Since for large enough n, vΦ(µ; Am) ≥vΦ(µ; Bn) ≥
δ, there is an interval partition A′′ of Am such that sΦ(µ; A′′) > (3/4)δ. Then
A := A′′∪{Ai}m−1
i=1 is an interval partition of Bn0 such that sΦ(µ; A) > (5/4)δ,
contradicting the ﬁrst relation in (3.70) and proving the proposition.
2
An interval function need not be upper continuous even if it is additive
and has bounded p-variation for some p < ∞:
Example 3.51. On [0, 2], let µ be the interval function such that µ(A) = 0 for
any interval A included in [0, 1] or in [d, 2] for any d > 1, and µ([[s, t]]) = r ̸= 0
for s ≤1 < t ≤2, speciﬁcally µ((1, c)) = r for any 1 < c ≤2. Then µ is
additive and of bounded p-variation for any p, but not upper continuous at ∅.

140
3 Φ-variation and p-variation
The following fact for interval functions corresponds to Proposition 3.40
for point functions.
Proposition 3.52. For Φ ∈V, let µ ∈AIΦ(J; X) for a nondegenerate inter-
val J, and let c > 0. There exists a Young interval partition {(zj−1, zj)}m
j=1 of
J such that vΦ(µ; (zj−1, zj)) ≤c for each 1 ≤j ≤m, and m ≤1+vΦ(µ; J)/c.
Proof. Let J = [[a, b]], and let ρ(t) := vΦ(µ; [[a, t]) for t ∈J. By (3.68), ρ
is a nondecreasing function on J. If J is left-open then let ρ(a) := ρ(a+),
which is 0 since A 7→vΦ(µ; A), A ∈I[[a, b]], is upper continuous at ∅by
Proposition 3.50. If J is right-open then let ρ(b) := ρ(b−). Let s, t ∈[a, b],
and let s < sk < tk < t, k = 1, 2, . . . , be such that as k →∞, sk ↓s and
tk ↑t. Then
vΦ(µ; (s, t)) = lim
k→∞vΦ(µ; (sk, tk]).
(3.71)
Indeed, let A = {Ai}n
i=1 be an interval partition of (s, t) with A1 = (s, u1]]
and An = [[un, t). Since µ is upper continuous, by Proposition 2.6(d), we have
lim
k→∞Φ(∥µ(sk, u1]]∥) = Φ(∥µ(A1)∥)
and
lim
k→∞Φ(∥µ[[un, tk]∥) = Φ(∥µ(An)∥).
Letting Ak := {(sk, u1]], A2, . . . , An−1, [[un, tk]}, we then have sΦ(µ; Ak) →
sΦ(µ; A) as k →∞, and sΦ(µ; Ak) ≤vΦ(µ; (sk; tk]). Thus (3.71) holds with
“≤” instead of “=”. Since the reverse inequality is clear, (3.71) is proved. By
(3.68) and (3.71), it then follows that
vΦ(µ; (s, t)) ≤lim
k→∞

ρ(tk) −ρ(sk)

= ρ(t−) −ρ(s+).
Since s, t ∈[a, b] are arbitrary, the conclusion follows from Lemma 3.41.
2
It will next be shown that the Φ-variation of an additive and upper contin-
uous interval function can be calculated using only Young interval partitions.
Recall that the set of all Young interval partitions of a nonempty interval J
is denoted by YP (J).
Lemma 3.53. Let Φ ∈V and let J be a nondegenerate interval. For µ ∈
AI(J; X), vΦ(µ; J) = sup{sΦ(µ; A): A ∈YP (J)}.
Proof. It is enough to show that the Φ-variation sum sΦ(µ; A) for any interval
partition A of J can be approximated arbitrary closely by sΦ(µ, An) for Young
interval partitions An. For notational simplicity and by symmetry, this will be
done for J = (a, b) and A = {(a, u), [u, b)} with u ∈(a, b). Let a < un ↑u be
such that µ({un}) = 0, which is possible since by Proposition 2.6(c) µ can be
non-zero only for at most countably many singletons in J. Then letting An :=
{(a, un), {un}, (un, b)}, and using also statements (a) and (d) of Proposition
2.6, we get that sΦ(µ; An) →sΦ(µ; A) as n →∞, proving the lemma.
2

3.3 Elementary Properties
141
The proof of the following lemma is the same as the proof of Lemma 3.45
and is omitted. Recall also that the oscillation Osc for an interval function µ
on an interval J, deﬁned in (2.7), equals supA⊂J ∥µ(A)∥.
Lemma 3.54. For any additive interval function µ, ∥µ∥(p) is a nonincreasing
function of p > 0. Moreover, if 0 < q < p < ∞then
∥µ∥(p) ≤min
n
∥µ∥(q), Osc(µ)(p−q)/p∥µ∥q/p
(q)
o
.
(3.72)
Recall that the class of all additive upper continuous interval functions
from J to X having p∗-variation is denoted by AI∗
p(J; X) (Deﬁnition 3.28).
Lemma 3.55. If 1 ≤q < p < ∞then AIq(J; X) ⊂AI∗
p(J; X).
Proof. We can assume that J is a nondegenerate interval. Let µ ∈AIq(J; X)
and let ǫ > 0. By Corollary 2.12, there exists a Young interval partition
{(zj−1, zj)}m
j=1 of J such that Osc(µ; (zj−1, zj)) < ǫ for each j = 1, . . . , m.
Then by (3.72) and (3.69), we have
m
X
j=1
vp(µ; (zj−1, zj)) ≤max
1≤j≤m Osc(µ; (zj−1, zj))p−q
m
X
j=1
vq(µ; (zj−1, zj))
< ǫp−qvq(µ).
Since ǫ > 0 is arbitrary, µ has p∗-variation by Lemma 3.29.
2
The following is an adaptation of Proposition 3.37 to interval functions.
Proposition 3.56. Let 1 ≤p < ∞, let µ ∈I(J; X) be additive, and let
{Bj}m
j=1 be an interval partition of J such that µ(Bj) = 0 for each j =
2, . . . , m −1. Then
vp(µ; J) ≤2p−1
m
X
j=1
vp(µ; Bj).
(3.73)
Proof. We can assume that J is a nondegenerate interval. Let A = {Ai}n
i=1
be an interval partition of J. For each i, if Ai ̸⊂Bj for all j, then letting
j1 := min{j : Ai ∩Bj ̸= ∅} and j2 := max{j : Ai ∩Bj ̸= ∅}, we have j1 < j2.
Since µ is additive, µ(Bj) = 0 for j1 < j < j2, and the function up, u ≥0, is
convex, it then follows that
µ(Ai)
p ≤2p−1nµ(Ai ∩Bj1)
p +
µ(Ai ∩Bj2)
po
.
Otherwise Ai ⊂Bj for some j and Ai is in a partition {Bj ∩Ar}t
r=s of Bj,
where Bj ∩Ar ̸= ∅if and only if s ≤r ≤t. Since 2p−1 ≥1, it then follows
that

142
3 Φ-variation and p-variation
sp(µ; A) ≤2p−1
m
X
j=1
vp(µ; Bj),
proving (3.73).
2
Local p-variation
As before let X be a Banach space and let J be a nonempty interval. Also let
0 < p < ∞. For a function f : J →X, its local p-variation is deﬁned by
v∗
p(f) := v∗
p(f; J) :=
inf
λ∈PP (J) sup
κ⊃λ
sp(f; κ).
If f has bounded p-variation then it is regulated by Proposition 3.33. Thus
by Corollary 2.2, f has at most countably many jumps and we can deﬁne the
sum
σp(f) := σp(f; J) :=
X
J

∥∆−f∥p + ∥∆+f∥p	
:=
X
x∈(a,b]]
∥∆−f(x)∥p +
X
x∈[[a,b)
∥∆+f(x)∥p.
Note that if at some x, ∆−f(x) and ∆+f(x) are both non-zero, this diﬀers
from σp for the corresponding interval function µ deﬁned by (2.2) and (3.40).
The following always holds:
σp(f) ≤v∗
p(f) ≤vp(f).
(3.74)
Next is a deﬁnition of the class of functions whose local p-variation comes
only from jumps.
Deﬁnition 3.57. Let X be a Banach space, let J be a nonempty interval
and let 1 < p < ∞. We will say that a function f : J →X has p∗-variation
on J and write f ∈W∗
p(J; X) if σp(f) = v∗
p(f) < +∞.
We show ﬁrst that the p∗-variation of a right-continuous function f agrees
with the p∗-variation of the corresponding interval function µf deﬁned by
(2.2). For 1 ≤p < ∞and a < b, let DWp([[a, b]]; X) be the set of all f ∈
Wp([[a, b]]; X) such that f is right-continuous on (a, b) and f(a) = 0 if a ∈
[[a, b]], or f(a+) = 0 otherwise. Then DWp([[a, b]]; X) is the intersection of
Wp([[a, b]]; X) and D([[a, b]]; X) deﬁned before Corollary 2.11. That Corollary
gives a one-to-one correspondence f ↔µf between f ∈D([[a, b]]; X) and µf in
the set AI([[a, b]]; X) of all X-valued additive and upper continuous interval
functions on [[a, b]]. We will show that this correspondence preserves the p-
variation and the local p-variation between corresponding point functions and
interval functions.

3.3 Elementary Properties
143
Proposition 3.58. Let X be a Banach space, J = [[a, b]] with a < b, and 1 ≤
p < ∞. For f ∈DWp(J; X), we have vp(f) = vp(µf; J), v∗
p(f) = v∗
p(µf; J),
and σp(f) = σp(µf; J).
Proof. Let f ∈DWp(J; X). Since µf({x}) = ∆−f(x) for each x ∈(a, b]],
µf({a}) = ∆+f(a) if a ∈J, and ∆+f(x) = 0 for x ∈(a, b), we have
σp(f) = σp(µf; J). To show that vp(f) = vp(µf; J), let λ = {ti}n
i=0 be a
point partition of J. Let Bλ be an interval partition of J consisting of the
intervals (ti−1, ti] for i = 2, . . . , n if n ≥2; either [a,t1] if a ∈J, or (a, t0] and
(t0, t1] if a ̸∈J; and (tn, b) if b ̸∈J. Since µf((ti−1, ti]) = f(ti) −f(ti−1) for
each i, except if a = t0 ∈J when f(t1) −f(t0) = µf([a, t1]), it follows that
sp(f; λ) ≤sp(µf; Bλ), and so vp(f) ≤vp(µf; J). The converse inequality holds
since for any interval partition A of J, the p-variation sum sp(µf; A) can be
approximated arbitrarily closely by sp(f; κ) for some point partitions κ of J.
To prove the equality of local p-variations, let λ = {ti}n
i=0 be a point
partition of J, and let Bλ be the interval partition of J deﬁned above. If J =
[a, b] then sp(f; λ) = sp(µf; Bλ). Otherwise, since µf((a, t0]) = f(t0)−f(a+) if
a ̸∈J and µf((tn, b)) = f(b−)−f(tn) if b ̸∈J, the p-variation sum sp(µf; Bλ)
can be approximated arbitrarily closely by sp(f; κ) corresponding to point
partitions κ of J which are reﬁnements of λ. Therefore we have
sp(f; λ) ≤sp(µf; Bλ) ≤sup
κ⊃λ
sp(f; κ).
For an interval partition A which is a reﬁnement of Bλ, the p-variation sum
sp(µf; A) can be approximated arbitrarily closely by sp(f; κ) corresponding
to point partitions κ of J which are reﬁnements of λ, and so
sp(f; λ) ≤sup
A⊐Bλ
sp(µf; A) ≤sup
κ⊃λ
sp(f; κ).
If κ ⊃λ then Bκ ⊐Bλ. Therefore for any point partition λ of J,
sup
κ⊃λ
sp(f; κ) = sup
A⊐Bλ
sp(µf; A) ≥v∗
p(µf; J),
and so v∗
p(f) ≥v∗
p(µf; J).
To prove the converse inequality it is enough to show that for any interval
partition B of J = [[a, b]],
sup
A⊐B
sp(µf; A) ≥v∗
p(f).
(3.75)
Taking a reﬁnement of B if necessary, we can and do assume that B =
{(tj−1, tj)}m
j=1 is a Young interval partition of J. Let ǫ > 0. If J = [a, b]]
let sj ∈(tj−1, tj), j = 1, . . . , m, be close enough to tj so that S(J) := S1 =
S1({uj}m
j=1) < ǫ for any uj ∈[sj, tj), j = 1, . . . , m, where
S1 :=
X
j : tj∈(a,b]]
n
∥∆−f(tj)∥p −∥f(tj) −f(uj)∥po
+
m
X
j=1
∥f(tj−) −f(uj)∥p.

144
3 Φ-variation and p-variation
If J = (a, b]] let sj ∈(tj−1, tj), j = 1, . . . , m, be close enough to tj and s0 ∈
(t0, s1) close enough to t0 so that S(J) := S2 = S2({uj}m
j=0) < ǫ for any uj ∈
[sj, tj), j = 1, . . . , m, and u0 ∈(t0, s0], where S2 := S1 + ∥f(u0) −f(a+)∥p.
Then λ(J) := {t0, tj, sj}m
j=1 ∩J if J = [a, b]], or λ(J) := {s0, tj, sj}m
j=1 ∩J if
J = (a, b]], is a point partition of J. Let ζ = {xi}n
i=0 be a reﬁnement of λ(J)
such that sp(f; ζ) + ǫ ≥supκ⊃λ sp(f; κ). Let A be the interval partition of
J consisting of the intervals (xi−1, xi] such that xi ̸= tj for all j, (xi−1, xi)
such that xi = tj for some j, (a, x0) if t0 = a ̸∈J, (xn, b) if tm = b ̸∈J,
and of the singletons {tj} ∩J (if nonempty) for j = 0, 1, . . ., m. Then A is
a reﬁnement of B. Letting for j = 1, . . . , m −1, uj := xi−1 if xi = tj, either
um := xn if b ̸∈J or um := xn−1 if b ∈J, and u0 := x0 if a ̸∈J, it follows
that
sp(µf; A) −sp(f; ζ)
 ≤S(J) < ǫ, and so
sup
A⊐B
sp(µf; A) ≥sp(f; ζ) −ǫ ≥sup
κ⊃λ
sp(f; κ) −2ǫ.
Since ǫ > 0 is arbitrary, (3.75) holds, proving the proposition.
2
The next fact follows from the preceding proposition and complements
Corollary 2.11.
Corollary 3.59. Let X be a Banach space, J = [[a, b]] with a < b, and 1 <
p < ∞. Then f 7→µf gives a one-to-one linear mapping of DWp(J; X) onto
AIp(J; X), whose inverse is µ 7→Rµ,a.
Proof. The maps f 7→µf and µ 7→Rµ,a are one-to-one, linear, and inverses
of each other between D(J; X) and AI(J; X) by Corollary 2.11. For f ∈
DWp(J; X) we have µf ∈AIp(J; X) by Proposition 3.58. For µ ∈AIp(J; X)
take h = Rµ,a ∈D(J; X), so that µh = µ. As shown early in the proof of
Proposition 3.58, vp(h) ≤vp(µ; J), so h ∈DWp(J; X), completing the proof.
2
Now we continue characterizing functions having p∗-variation. The fol-
lowing proposition is analogous to Lemma 3.29 for interval functions. It also
shows that W∗
p is the closure in Wp of the class of step functions, which clearly
belong to W∗
p.
Proposition 3.60. Let J be a nondegenerate interval, f ∈R(J; X), and
1 < p < ∞. Then statements (a), (b), and (c) are equivalent, where
(a) f has p∗-variation on J;
(b) for every ǫ > 0, there exists a Young interval partition {(zj−1, zj)}m
j=1 of
J such that
m
X
j=1
vp(f; (zj−1, zj)) < ǫ;
(3.76)

3.3 Elementary Properties
145
(c) f is a limit in (Wp, ∥· ∥[p]) of step functions.
Proof. It is easy to see that for any point partition λ = {xi}n
i=0 of the closure
¯J, sup{sp(f; κ): κ ∈PP (J), κ ⊃λ ∩J} is equal to Pn
i=1 vp(f; [xi−1, xi] ∩J),
and so
v∗
p(f) = inf
n
n
X
i=1
vp(f; [xi−1, xi] ∩J): {xi}n
i=0 ∈PP ( ¯J)
o
.
(3.77)
(a) ⇒(b). Let f have p∗-variation on J. By (3.77), given ǫ > 0 there is a
partition {zj}m
j=0 of ¯J such that
m
X
j=1
vp(f; [zj−1, zj] ∩J) < v∗
p(f) + ǫ/2
and
X
j : zj−1,zj∈J
n
∥∆+f(zj−1)∥p + ∥∆−f(zj)∥po
> σp(f) −ǫ/2.
By (3.51), for any {uj−1, vj}m
j=1 ⊂(a, b) with [uj−1, vj] ⊂(zj−1, zj) for each
j, we have
vp(f; [uj−1, vj]) ≤vp(f; [zj−1, zj]∩J)−vp(f; [zj−1, uj−1]∩J)−vp(f; [vj, zj]∩J)
for j = 1, . . . , m. By Proposition 3.42 and Corollary 3.43(c), for each such j,
letting uj−1 ↓zj−1 and vj ↑zj, it follows that
m
X
j=1
vp(f; (zj−1, zj))
≤
m
X
j=1
n
vp(f; [zj−1, zj] ∩J) −∥∆+f(zj−1)∥p −∥∆−f(zj)∥po
< v∗
p(f) + ǫ/2 −σp(f) + ǫ/2 = ǫ
since f has p∗-variation.
(b) ⇒(c). Given δ > 0, take a Young interval partition {(zj−1, zj)}m
j=1 of
J satisfying (3.76) for ǫ = δp. To deﬁne a step function, let yj := (zj−1 +zj)/2
if 2 ≤j ≤m −1, or if j = 1 and a > −∞, or if j = m and b < +∞. If j = 1
and a = −∞, let y1 := z1 −1. If j = m and b = +∞, let ym := zm−1 + 1.
Let gj := f(zj−1+)1(zj−1,yj] + f(zj−)1(yj,zj) for j = 1, . . . , m. Then for each
j = 1, . . . , m, letting Aj := (zj−1, zj),
vp(f −gj; Aj) ≤2pvp(f; Aj)
by Theorem 3.7(c), since vp(gj; Aj) ≤vp(f; Aj). A step function now is deﬁned
by

146
3 Φ-variation and p-variation
g := gδ :=
X
j : zj∈J
f(zj)1{zj} +
m
X
j=1
gj.
Clearly ∥f −g∥sup < δ. At each zj ∈J, f −g is continuous (one-sidedly if
j = 0 or m) and equals 0. Thus by Proposition 3.37 and (3.76) with ǫ = δp,
vp(f −g; J) ≤2p−1
m
X
j=1
vp(f −g; [zj−1, zj] ∩J)
= 2p−1
m
X
j=1
vp(f −gj; (zj−1, zj)) ≤22p−1δp.
Hence ∥f −gδ∥[p] ≤5δ and gδ →f in Wp as δ ↓0, proving (c).
(c) ⇒(a). We have f ∈Wp. Suppose that f ̸∈W∗
p. Then there is a
constant C > 0 such that v∗
p(f) −σp(f) ≥C. Take 0 < ǫ < C. There is
a step function g with ∥f −g∥(p) < ǫ1/p. Take a Young interval partition
{(zj−1, zj)}m
j=1 of J such that g is constant on each (zj−1, zj). Then by (3.51),
m
X
j=1
vp(f; (zj−1, zj)) =
m
X
j=1
vp(f −g; (zj−1, zj)) ≤vp(f −g; J) < ǫ
(by the way proving (b)). Also, we have
m
X
j=1
n
∥∆+
J f(zj−1)∥p + vp(f; (zj−1, zj)) + ∥∆−
J f(zj)∥po
≥v∗
p(f).
(3.78)
To prove this, let t0j := zj−1 < t1j < t2j < t3j
:= zj for each j. Then by
(3.77),
v∗
p(f) ≤
m
X
j=1
3
X
i=1
vp(f; J ∩[ti−1,j, tij]).
Let t1j ↓t0j and t2j ↑t3j for each j. Then in the limit we get (3.78) by
Proposition 3.42 and Corollary 3.43(c), recalling that ∆+
J f(a) = 0 for J =
(a, b]] and ∆−
J f(b) = 0 for J = [[a, b) as deﬁned before (2.1). Thus, we get
m
X
j=1
vp(f; (zj−1, zj)) ≥v∗
p(f) −σp(f) ≥C > ǫ,
a contradiction, proving (a). The proof of Proposition 3.60 is complete.
2
Here is an analogue of Lemma 3.55 for point functions.
Lemma 3.61. If 1 ≤q < p < ∞then Wq(J; X) ⊂W∗
p(J; X).

3.3 Elementary Properties
147
Proof. Let f ∈Wq(J; X) and let ǫ > 0. By Proposition 3.33, f is regu-
lated on J. Thus by Theorem 2.1(b), there exists a Young interval partition
{(zj−1, zj)}m
j=1 of J such that Osc(f; (zj−1, zj)) < ǫ for each j = 1, . . . , m.
Then by (3.65) and (3.51), we have
m
X
j=1
vp(f; (zj−1, zj)) ≤max
1≤j≤m Osc(f; (zj−1, zj))p−q
m
X
j=1
vq(f; (zj−1, zj))
< ǫp−qvq(f).
Since ǫ > 0 is arbitrary, f has p∗-variation by Proposition 3.60.
2
Closely related to the local p-variation is a related quantity deﬁned
as follows. Let 0 < p < ∞and f : [a, b] 7→X. For each ǫ > 0, let
vp(f; ǫ) := sup{sp(f; κ): |κ| ≤ǫ}, where |κ| is the mesh of κ ∈PP [a, b],
and ¯vp(f) := ¯vp(f; [a, b]) := limǫ↓0 vp(f; ǫ). Since |λ| ≤|κ| for λ ⊃κ, we have
sup{sp(f; λ): λ ⊃κ} ≤vp(f; ǫ) for each κ ∈PP [a, b] such that |κ| ≤ǫ. This
implies the ﬁrst inequality in
v∗
p(f) ≤¯vp(f) ≤vp(f),
(3.79)
while the second one is clear. The strict inequality v∗
p(f) < ¯vp(f) may hold
if f has jumps on both sides of the same point and p > 1. For example, if
f(x) := 0 for x ∈[0, 1/2), f(1/2) := 1/2, and f(x) := 1 for x ∈(1/2, 1], then
v∗
p(f) = 21−p < 1 = ¯vp(f) for each p > 1. However, equality holds under the
following conditions.
Lemma 3.62. Let f : [a, b] →X and 0 < p < ∞. If for each x ∈(a, b),
either ∆−f(x) = 0 or ∆+f(x) = 0, then v∗
p(f) = ¯vp(f).
Proof. By (3.79), it is enough to prove that v∗
p(f) ≥¯vp(f). Suppose not.
Choose C such that v∗
p(f) < C < ¯vp(f). Then there exist a partition κ =
{xi}n
i=0 of [a, b] and a sequence {κm}m≥1 of partitions of [a, b] such that
|κm| ↓0 and
sup{sp(f; λ): λ ⊃κ} < C < sp(f; κm)
(3.80)
for m = 1, 2, . . . . Since f has only one-sided jumps, f(ym
i ) →f(xi) for each
i ∈{1, . . . , n −1} and some ym
i
∈κm chosen in such a way that no y ∈κm
is between ym
i
and xi. For each large enough m, let κ′
m be the same as κm
except that ym
i
is replaced by xi for each i = 1, . . . , n −1. Then |sp(f; κm) −
sp(f; κ′
m)| →0 as m →∞. Since κ′
m ⊃κ, this contradicts (3.80), proving the
lemma.
2
The following shows that the ﬁrst inequality in (3.74) can be strict.
Proposition 3.63. For 1 < p < ∞, there is a function of bounded p-
variation, in fact a (1/p)-H¨older continuous function, not having p∗-variation.

148
3 Φ-variation and p-variation
Proof. Let M > 1 be an even integer such that M 1−(1/p) > 4, and let f be
the function (3.67) with hk ≡1. Then f is (1/p)-H¨older by the ﬁrst part of
the conclusion of Lemma 3.47, and so f is in Wp[0, 1] with σp(f) = 0. By the
second part of the same conclusion, for each integer n > 1, sp(f; κn) > 4/3p
with κn = {i/(4M n)}4Mn
i=0 . By Lemma 3.62, since mesh |κn| →0 as n →∞,
v∗
p(f) = ¯vp(f) ≥4/3p, and so f ̸∈W∗
p[0, 1], proving the proposition.
2
It is easy to see that (W∗
p[0, 1], ∥· ∥[p]), 1 < p < ∞, is nonseparable: for
t, s ∈[0, 1] and t ̸= s, we have
1[t,1] −1[s,1]

[p] ≥
1[t,1] −1[s,1]

sup = 1.
*3.4 A Necessary and Suﬃcient Condition for Integral
Duality
In this section, for a pair of convex functions Φ and Ψ, necessary and suﬃ-
cient conditions are given such that the reﬁnement Young–Stieltjes integral
(RYS) ∫f·dh exists whenever f and h have bounded Φ- and Ψ-variations, re-
spectively (Theorem 3.75 below). Use of the (RYS) integral avoids the need
for hypotheses of no common (one-sided) discontinuities, but the more famil-
iar Riemann–Stieltjes and reﬁnement Riemann–Stieltjes integrals exist under
the same conditions on Φ and Ψ if there are no such discontinuities. In other
words, the full Stieltjes integral (S) ∫f·dh exists, and Theorem 3.75 is actually
formulated in terms of the (S) integral.
The conditions on Φ and Ψ may appear somewhat complex or unintu-
itive (cf. Deﬁnitions 3.67 and 3.70). Theorem 3.78 gives a simpler suﬃcient
condition, due to Beurling, but this condition is not necessary (Example 3.80).
Lacunary sequences
The necessary and suﬃcient integrability conditions are formulated in terms
of increasing sequences {nk} = {n1, n2, . . . } of positive integers which may be
ﬁnite or inﬁnite.
Let ξ be a modulus of continuity. Then ξ is a continuous, nondecreasing,
and subadditive function on [0, ∞) with ξ(0) = 0. By (3.32), the limit 0 <
S := limu↓0 u−1ξ(u) exists. It can be ﬁnite or inﬁnite, e.g. for ξ(u) = u1/p,
p = 1 or 2 respectively. Recall that functions in V are strictly increasing and
continuous from [0, ∞) onto itself, and so they have inverses with the same
properties. Recall also that VM is the class of all functions Ξ ∈V such that
the inverse Ξ−1 is a modulus of continuity. If Ξ ∈VM with inverse ξ then
v = o(ξ(v))
as v ↓0
(3.81)
if and only if
Ξ(u) = o(u)
as u ↓0.
(3.82)
We begin with the following class of lacunary sequences.

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
149
Deﬁnition 3.64. Let ξ be a modulus of continuity. A ﬁnite or inﬁnite in-
creasing sequence {nk} of positive integers is called ξ-lacunary if for some
C < ∞, the inequalities
m
X
k=1
nkξ(n−1
k ) ≤Cnmξ(n−1
m )
and
∞
X
k=m
ξ(n−1
k ) ≤Cξ(n−1
m )
(3.83)
hold for each m = 1, 2, . . . such that nm is deﬁned.
Every ﬁnite sequence {nk} is ξ-lacunary for any ξ.
Proposition 3.65. Let ξ be a modulus of continuity. There exists an inﬁnite
ξ-lacunary sequence {nk} if and only if ξ satisﬁes (3.81).
Proof. Suppose (3.81) holds. Let n1 := 1. Given increasing positive integers
n1 < · · · < nm, let δm := 1/ Pm
k=1 nkξ(1/nk). There is an nm+1 large enough
so that 1/nm+1 ≤δmξ(1/nm+1) by (3.81), and ξ(1/nm+1) ≤ξ(1/nm)/2 since
ξ(v) ↓0 as v ↓0. It follows inductively that the inequalities (3.83) both hold
with C = 2 in each.
Conversely, suppose (3.81) does not hold. Then the limit S > 0 is ﬁnite.
Suppose a ξ-lacunary sequence {nk} exists. Then in the left inequality in
(3.83), as m →∞, the left side is asymptotic to mS and the right side to CS,
a contradiction, completing the proof.
2
A sequence {nk} is called lacunary in the sense of Hadamard or Hadamard-
lacunary if for some θ > 1,
nk+1/nk ≥θ
for each k ≥1.
(3.84)
If for some 0 < α < 1, ξ(u) = uα, u ≥0, then each Hadamard-lacunary
sequence is also ξ-lacunary. To state a partial converse, the supremum of the
numbers θ for which the condition (3.84) holds will be called the degree of
lacunarity of the given sequence {nk}.
Lemma 3.66. For each µ > 1 and modulus of continuity ξ, any inﬁnite
ξ-lacunary sequence can be decomposed into a ﬁnite number of Hadamard-
lacunary sequences in each of which the degree of lacunarity is at least µ.
Proof. Let η = {nk} be an inﬁnite ξ-lacunary sequence. It is enough to prove
the lemma for some value of µ > 1. Indeed if µ is arbitrary and (3.84) holds
for some θ > 1, then let l be the least positive integer such that θl ≥µ. Divide
the sequence {nk} into l sequences ηi = {ni+kl}∞
k=0, i = 1, . . . , l. Then each
member of η belongs to one and only one of the sequences ηi, and for each
i = 1, . . . , l, ni+(k+1)l/ni+kl ≥θl ≥µ for k = 0, 1, . . ., proving the claim. Now
consider the sequence of intervals ∆(m) := [2m, 2m+1), m = 0, 1, . . . . There
exists a positive integer l such that each ∆(m) contains at most l members

150
3 Φ-variation and p-variation
of the sequence η. Suppose not, that is, there exists a subsequence mi ↑∞
such that each ∆(mi) contains li members of η and li ↑∞. Then letting
Mi := max{k: nk ∈∆(mi)}, we have
Mi
X
k=1
nkξ(n−1
k ) ≥
X
nk∈∆(mi)
nkξ(n−1
k ) ≥li
min
nk∈∆(mi) nkξ(M −1
i
)
≥2−1liMiξ(M −1
i
)
for each i. This contradiction shows that η can be decomposed into 2l
Hadamard-lacunary sequences each of which has degree of lacunarity at least
2, proving the lemma.
2
Deﬁnition 3.67. Let φ and ψ be moduli of continuity. We say that an in-
creasing inﬁnite sequence η = {nk} of positive integers is a W(φ, ψ)-sequence
if
W(φ, ψ; η) := inf

W(φ, ψ; k): k ≥1} > 0,
where for each k ≥1,
W(φ, ψ; k) := max
nφ(n−1
k+1)
φ(n−1
k ) , ψ(n−1
k+1)
ψ(n−1
k ) ,
nkφ(n−1
k )
nk+1φ(n−1
k+1),
nkψ(n−1
k )
nk+1ψ(n−1
k+1)
o
.
If (3.81) fails for ξ = φ or for ξ = ψ then W(φ, ψ; η) > 0 for any sequence
η = {nk} since in this case for some constants c > 0 and C < ∞, c ≤
u−1ξ(u) ≤C for all 0 < u ≤n−1
1
by (3.32). Next we deﬁne a class of sequences
with a slightly stronger property than that of W(φ, ψ)-sequences.
Deﬁnition 3.68. Let φ and ψ be moduli of continuity. For each k ≥1, let
Wo(φ, ψ; k) := max
nφ(n−1
k+1)
φ(n−1
k ) ,
nkψ(n−1
k )
nk+1ψ(n−1
k+1)
o
if k is odd
(3.85)
and
We(φ, ψ; k) := max
nψ(n−1
k+1)
ψ(n−1
k ) ,
nkφ(n−1
k )
nk+1φ(n−1
k+1)
o
if k is even.
(3.86)
We say that an increasing inﬁnite sequence η = {nk} of positive integers is a
W ′(φ, ψ)-sequence if n1 = 1 and for some ﬁnite constants co and ce,
Wo(φ, ψ; η) := inf

Wo(φ, ψ; k): k is odd
	
= 1/co
(3.87)
and
We(φ, ψ; η) := inf

We(φ, ψ; k): k is even
	
= 1/ce.
(3.88)

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
151
It is clear that each inﬁnite W ′(φ, ψ)-sequence η also is a W(φ, ψ)-sequence
and we have the bound W(φ, ψ; η) ≥1/ max{co, ce}.
Lemma 3.69. Let φ and ψ be moduli of continuity, and let η = {nk} be an
inﬁnite W(φ, ψ)-sequence with C := W(φ, ψ; η). Then for each k ≥1 and any
u ∈[n−1
k+1, n−1
k ],
u−1φ(u)ψ(u) ≤2C−1 max

nkφ(n−1
k )ψ(n−1
k ), nk+1φ(n−1
k+1)ψ(n−1
k+1)
	
. (3.89)
In particular, if limk→∞nkφ(n−1
k )ψ(n−1
k ) = 0 then φ(u)ψ(u) = o(u) as u ↓0.
Moreover, if in addition φ and ψ are concave then the factor 2 in (3.89) is
unnecessary.
Proof. Recall that for ξ = φ or ψ, ξ(u) ↑and by (3.31), v−1ξ(v) ≤2u−1ξ(u)
for 0 < u < v. Let n−1
k+1 ≤u ≤n−1
k
for some k ≥1. Then letting hj := n−1
j
for each j, we have ξ(u) ≤ξ(hk) and u−1ξ(u) ≤2nk+1ξ(hk+1). To bound
u−1φ(u)ψ(u), since W(φ, ψ; k) ≥C for each k, we have four cases:
u−1 φψ

(u) ≤2nk+1φ(hk)ψ(hk+1)
≤
 2C−1nk+1
 φψ

(hk+1) if φ(hk+1) ≥Cφ(hk),
2C−1nk
 φψ

(hk)
if nkψ(hk) ≥Cnk+1ψ(hk+1),
and
u−1 φψ

(u) ≤2nk+1φ(hk+1)ψ(hk)
≤
2C−1nk
 φψ

(hk)
if nkφ(hk) ≥Cnk+1φ(hk+1),
2C−1nk+1
 φψ

(hk+1) if ψ(hk+1) ≥Cψ(hk).
Therefore (3.89) holds, proving the ﬁrst part of the lemma. The last part of
the lemma follows by Proposition 3.14.
2
Next we deﬁne special sequences depending on moduli of continuity φ
and ψ. They will be shown to be φ- and ψ-lacunary for suitable φ and ψ in
Proposition 3.71.
Deﬁnition 3.70. Let φ and ψ be moduli of continuity. Deﬁne a sequence
η0 = η0(φ, ψ) = {nk}, ﬁnite or inﬁnite, recursively as follows. Let n1 := 4s for
some integer s ≥0. If nl has been deﬁned for 1 ≤l ≤k, where k is an odd
integer, then let
nk+1 := min

4r : r ∈N, 4φ(4−r) ≤φ(n−1
k ), 4rψ(4−r) ≥4nkψ(n−1
k )
	
(3.90)
provided the right side is deﬁned. If k is an even integer then let
nk+1 := min

4r : r ∈N, 4ψ(4−r) ≤ψ(n−1
k ), 4rφ(4−r) ≥4nkφ(n−1
k )
	
(3.91)
provided the right side is deﬁned. The recursive construction ends at a ﬁnite
nk whenever nk+1 is undeﬁned. Then we call {nk}k≥1 a D’yaˇckov sequence
for φ, ψ. If s = 0, so n1 = 1, we call it the D’yaˇckov sequence η0(φ, ψ).

152
3 Φ-variation and p-variation
A D’yaˇckov sequence {nk} is easily seen to be inﬁnite if (3.81) holds for
ξ = φ and ξ = ψ. Conversely, suppose that a D’yaˇckov sequence {nk} is
inﬁnite. Then by (3.31) and (3.90), if k ≥1 is odd then
nk+1ψ(n−1
k+1) ≥2nk−1ψ(n−1
k−1) ≥· · · ≥2(k+1)/2ψ(1),
and so (3.81) holds for ξ = ψ. If k ≥2 is even then nk+1φ(n−1
k+1) ≥2k/2φ(1)
by (3.31) and (3.91), showing that (3.81) holds for ξ = φ. Therefore (3.90)
and (3.91) are deﬁned for each k ≥1 if and only if (3.81) holds for ξ = φ and
ξ = ψ.
The following shows that η0(φ, ψ) is a φ- and ψ-lacunary sequence, and it
is a W(φ, ψ)-sequence with W(φ, ψ; η0) ≥1/16.
Proposition 3.71. Let {nk} be a D’yaˇckov sequence for some concave moduli
of continuity φ, ψ such that (3.81) holds for ξ = φ and ξ = ψ. Then for
m = 1, 2, . . ., and ξ = φ or ψ,
m
X
k=1
nkξ(n−1
k ) ≤8
3nmξ(n−1
m )
and
∞
X
k=m
ξ(n−1
k ) ≤8
3ξ(n−1
m ).
(3.92)
Also, the D’yaˇckov sequence η0 = {nk} is a W ′(φ, ψ)-sequence with co ≤16
and ce ≤16.
Proof. By the remark following Deﬁnition 3.70, the sequence η0(φ, ψ) = {nk}
is inﬁnite. From the deﬁnition of {nk}, for k odd, we have
φ(n−1
k+1) ≤4−1φ(n−1
k )
and
nkψ(n−1
k ) ≤4−1nk+1ψ(n−1
k+1).
Then by monotonicity of φ(u) and u−1ψ(u) (Proposition 3.14), the inequalities
φ(n−1
k+2) ≤4−1φ(n−1
k )
and
nkψ(n−1
k ) ≤4−1nk+2ψ(n−1
k+2)
hold for all k = 1, 2, . . . . The same inequalities hold with φ and ψ interchanged.
Thus for ξ = φ or ψ,
X
k≥m
ξ(n−1
k ) ≤

ξ(n−1
m ) + ξ(n−1
m+1)
 ∞
X
j=0
4−j ≤8
3ξ(n−1
m ),
proving the second inequality in (3.92). For the ﬁrst one, we have
X
k≤m
nkξ(n−1
k ) ≤

nmξ(n−1
m ) + nm−1ξ(n−1
m−1)
 ∞
X
j=0
4−j ≤8
3nmξ(nm),
proving (3.92).
To show that {nk} is a W ′(φ, ψ)-sequence, we have by deﬁnition of {nk},
if k is odd, that either φ(4n−1
k+1) > 4−1φ(n−1
k ), and then by concavity (Propo-
sition 3.14)

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
153
φ(n−1
k+1) ≥4−1φ(4n−1
k+1) > 16−1φ(n−1
k ),
or 4−1nk+1ψ(4n−1
k+1) < 4nkψ(n−1
k ), in which case since ψ is increasing,
nk+1ψ(n−1
k+1) < 16nkψ(n−1
k ).
For k even, we have the same alternative with φ and ψ interchanged. Thus
Proposition 3.71 is proved.
2
An inequality for Riemann–Stieltjes sums
An inequality to be given in Proposition 3.73 will be used to prove existence of
the full Stieltjes integral (Theorem 3.75). The proof is based on constructing a
special partition of a discrete triangle formed by indices: for an integer n ≥1,
let
Dn :=

(i, j) ∈N × N: 1 ≤i ≤n, 1 ≤j ≤i
	
.
(3.93)
Lemma 3.72. Let F and H be nondecreasing functions on an interval [a, b]
with a < b, such that F(a) = H(a) = 0 and 0 < χ(b) ≤1 for χ = F or
H. Let {ti}n
i=0 be a partition of [a, b] such that max{F(ti) −F(ti−1), H(ti) −
H(ti−1)} > 0 for i = 1, . . . , n, and let {nk}k≥1 be an increasing sequence of
positive integers with n1 = 1. Let k0
:=
max{k ≥1: min{F(b), H(b)} ≤
n−1
k }. Then there exists a doubly indexed sequence R = {Rk,m : k ≥0, m ≥
1} with the following properties: R contains exactly n nonempty sets. The
nonempty Rk,m have k ≥k0, are disjoint, and are of the form
Rk,m = R(r1, r2, r3) := {(i, j) ∈Dn : r1 ≤j ≤r2 ≤i ≤r3}
(3.94)
for some integers rl = rl(k, m), l = 1, 2, 3, with 1 ≤r1 ≤r2 ≤r3 ≤n. Also,
(a) Dn = ∪k≥k0 ∪m≥1 Rk,m;
(b) if k is odd and Rk,m is nonempty then
H(tr3) −H(tr2−1) ≥n−1
k+1
and
F(tr2) −F(tr1−1) ≤n−1
k ; (3.95)
(c) if k is even and Rk,m is nonempty then
F(tr2) −F(tr1−1) ≥n−1
k+1
and
H(tr3) −H(tr2−1) ≤n−1
k .
Proof. A sequence {Rk,m : k ≥k0, m ≥1} with the stated properties will be
constructed recursively. When the recursive construction ends, any Rk,m not
yet deﬁned are deﬁned to be empty. Let Rk,m := ∅for 0 ≤k ≤k0 −1 and
m ≥1. By deﬁnition of k0,
1/nk0+1 < min{F(b), H(b)} ≤1/nk0.
(3.96)
The sets Rk,m will be deﬁned recursively in k ≥k0 and for such k, recursively
in m ≥1 until the recursion ends for that k, then until the recursion in k ends.

154
3 Φ-variation and p-variation
Suppose that for some k ≥k0, Rl,m has been deﬁned for each 0 ≤l ≤k−1, as
is true for k = k0 with each Rl,m = ∅. Let Wk−1 := ∪k−1
l=0 ∪m≥1 Rl,m. If the set
{(i, i): 1 ≤i ≤n} \ Wk−1 is empty, the recursive construction ends. Assume
that this set is not empty. For χ = F or χ = H, let ∆iχ := χ(ti) −χ(ti−1),
i = 1, . . . , n. Then deﬁne Rk,m, m = 1, 2, . . . , depending on whether k is odd
or even as follows:
(1) Suppose that k is odd. Given ν = 1, . . . , n and k let
u(ν, k) := min{r : ν < r ≤n, (r, r) ∈Wk−1},
or u(ν, k) := n + 1 if the given set is empty. Then let νk,1 := n + 1, and for
m = 1, 2, . . ., recursively let
νk,m+1 := max
n
ν : 1 ≤ν ≤µ := min{u(ν, k), νk,m} −1, (ν, ν) ̸∈Wk−1
and n−1
k+1 ≤
µ
X
j=ν
∆jH
o
(3.97)
if the right side is deﬁned, and let νk,m+1 := 0 otherwise. For each m =
1, 2, . . . , if νk,m+1 ≥1 then let Rk,m be the set of points (i, j) ∈Dn \ Wk−1
such that
1 ≤j ≤νk,m+1 ≤i ≤νk,m −1.
(3.98)
If νk,m+1 = 0 then let Rk,m := ∅and the recursion in m for the given k ends.
(2) Suppose that k is even. Given ν = 1, . . . , n and k let
v(ν, k) := max{r : 1 ≤r < ν, (r, r) ∈Wk−1},
or v(ν, k) :=
0 if the given set is empty. Then let νk,1 := 0, and for m =
1, 2, . . . , recursively let
νk,m+1 := min
n
ν : µ := max{v(ν, k), νk,m} + 1 ≤ν ≤n, (ν, ν) ̸∈Wk−1,
and n−1
k+1 ≤
ν
X
i=µ
∆iF
o
(3.99)
if the right side is deﬁned, and let νk,m+1 := n + 1 otherwise. For each m =
1, 2, . . . , if νk,m+1 ≤n then let Rk,m be the set of points (i, j) ∈Dn \ Wk−1
such that
νk,m + 1 ≤j ≤νk,m+1 ≤i ≤n.
(3.100)
If νk,m+1 = n + 1 then let Rk,m := ∅and the recursion in m for the given k
ends.
If k = k0 is odd, then for all ν, u(ν, k) = n + 1, and νk,1 = n + 1. So in the
deﬁnition of νk,m+1 for m = 1, the condition on ν holds at least for ν = 1 by
(3.96), and Rk,1 ̸= ∅. Symmetrically, Rk,1 ̸= ∅for k = k0 even.
For k ≥k0, we claim and will prove by induction on k three statements
(i), (ii), and (iii) as follows:

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
155
(i) The set Dn \ Wk−1 is a union of sets {(i, j): q1 ≤j ≤i ≤q2}.
(ii) The nonempty sets Rk,m are rectangles of the form (3.94), with r2 =
νk,m+1,
r1 = r1(k, m) = 1 + max

s < r2 : (s, s) ∈R′
k,m−1 ∪Wk−1
	
,
(3.101)
or r1 = 1 if no such s exists, where R′
k,w = ∅for k odd or w = 0, and
otherwise equals Rk,w; and
r3 = r3(k, m) = min

s > r2 : (s, s) ∈R′′
k,m−1 ∪Wk−1
	
−1,
(3.102)
or r3 = n if no such s exists, where R′′
k,w = ∅for k even or w = 0, and
otherwise equals Rk,w.
(iii) For r = 1, . . . , n let Qr = {(i, j) : 1 ≤j ≤r ≤i ≤n}. There is a set
S(k) ⊂{1, . . . , n} such that Wk = S
r∈S(k) Qr.
To begin the induction, for k = k0, statements (i) and (ii) both simplify
because Wk0−1 = ∅. Thus (i) holds for one set with q1 = 1 and q2 = n. For
(ii), Rk0,m, if nonempty, as it is at least for m = 1, is either a set (3.98) for k0
odd, or a set (3.100) for k0 even. In either case it has the form of a discrete
rectangle R(r′
1, r′
2, r′
3) as in (3.94) for some integers 1 ≤r′
1 ≤r′
2 ≤r′
3 ≤n
depending on m with upper left corner (r′
2, r′
2) and r′
2 = νk,m+1 = r2 as stated
in (ii). These rectangles are disjoint for diﬀerent m. To verify that r′
1 = r1 as
in (3.101) and r′
3 = r3 as in (3.102), note that (s, s) ∈Rk,m−1 if and only if
m ≥2 and s = νk,m and apply the deﬁnitions of R′
k,m, R′′
k,m, and Rk,m for
k even and odd. So (ii) holds for k = k0. Now (iii) for k = k0 follows easily,
with S(k0) = {νk0,m}m≥2.
Next for the induction step, given k > k0 and assuming (i), (ii), and (iii)
hold with k −1 in place of k, they will be proved for k. We ﬁrst prove (i)
for k. Applying (iii) for k −1, we have S(k −1) = {nk−1,t}N(k−1)
t=1
for some
N(k −1) and nk−1,1 < nk−1,2 < · · · < nk−1,N(k−1). Let nk−1,0
:=
0 and
nk−1,N(k−1)+1 := n+1. If S(k−1) is all of {1, . . . , n}, the recursion has ended
and there is no problem. Otherwise, there exists some t = 1, . . . , N(k −1) + 1
such that nk−1,t −nk−1,t−1 ≥2. It is then easily seen that (i) holds for k
with, for each such t, (q1, q2) = (nk−1,t−1 + 1, nk−1,t −1). Thus we have (i)
for k. Suppose (i) holds for a given value of k > k0 and (iii) for k −1. We
want to prove (ii) for k. If Rk,1 = ∅then (ii) holds vacuously, so suppose
some Rk,m are nonempty. Let k be odd. If Rk,m is nonempty then r2 =
r2(k, m) = νk,m+1 ≥1 and there is a unique t ∈{1, . . . , N(k −1) + 1} such
that nk−1,t−1 < r2 < nk−1,t. In this case by the deﬁnition of Rk,m we will
have r1(k, m) as in (3.94) equal to nk−1,t−1 + 1, which conﬁrms (3.101) since
R′
k,m−1 = ∅. Also, r3(k, 1) = nk−1,t −1, agreeing with (3.102). For m ≥2 we
will have r3(k, m) = min(nk−1,t, νk,m)−1 which also agrees with (3.102). Thus
(ii) holds for k odd. A symmetric proof applies for k even, so the induction
step for (ii) is done.
Next, we want to complete the induction step by proving (iii) for a k > k0,
assuming (i) and (ii) for k and (iii) for k −1. Speciﬁcally, (iii) will be proved

156
3 Φ-variation and p-variation
for S(k) = S(k −1) ∪T (k) where T (k) := {r2(k, m)}m≥1. Let k be odd. If
νk,2 = 0, then S(k) = S(k−1) and there is no problem. Let S(k, 0) := S(k−1)
and recursively if νk,m+1 ≥1 let S(k, m) := S(k, m−1)∪{νk,m+1}; otherwise
the recursion ends with S(k, m) deﬁned for a largest m = m(k). We will prove
by induction on M = 0, 1, . . ., m(k) that
Uk,M := Wk−1 ∪
[
1≤m≤M
Rk,m = Vk,M :=
[
r∈S(k,M)
Qr.
(3.103)
For M = 0 this follows from (iii) for k −1 as assumed. For the induction
step, let r2 := r2(k, M) = νk,M+1. Clearly Rk,M ⊂Qr2, so Uk,M ⊂Vk,M. To
prove the converse inclusion, let (i, j) ∈Qr2, i.e. 1 ≤j ≤r2 ≤i ≤n. Recalling
that k is odd, if j < r1 = r1(k, M) then j ≤r1 −1 = nk−1,t−1 ≤i ≤n by
(3.101). Thus (i, j) ∈Wk−1 ⊂Uk,M by (iii) for k −1, so assume j ≥r1. By
(3.102), if i > r3 = r3(k, M) there are two possibilities. If r3 = nk−1,t −1 then
j ≤nk−1,t ≤i ≤n so again (i, j) ∈Uk,0 ⊂Uk,M. Or if r3 = νk,M −1, which
implies M ≥2, and i > r3, then j ≤νk,M ≤i ≤n so
(i, j) ∈Qνk,M = Qr2(k,M−1) ⊂Uk,M−1
by the induction hypothesis in M, and Uk,M−1 ⊂Uk,M. So we are left with
r1 ≤j ≤r2 ≤i ≤r3. Then by (ii) for k, (i, j) ∈Rk,M ⊂Uk,M, ﬁnishing the
inductive proof of (3.103) for k odd. There is a symmetric proof for k even.
For M = m(k) we then infer (iii) for k, completing the inductive proof of (i),
(ii), and (iii) up through the largest k for which Rk,1 is nonempty, as desired.
We claim that each (i, i) ∈Dn is in ∪l≥0 ∪m≥1 Rl,m. Suppose (r, r) ∈
Dn \ Wk−1 for some k ≥k0 and either ∆rF ≥n−1
k+1 with k even (Case 1) or
∆rH ≥n−1
k+1 with k odd (Case 2). In Case 1, νk,m is strictly increasing in m
and νk,m < r ≤n for m = 1, so there is a largest such m, with νk,m < r ≤
νk,m+1. In fact by deﬁnition of νk,m+1 it equals r, so (r, r) ∈Rk,m. There is
a symmetric proof in Case 2. Therefore each pair (i, i) ∈Dn is in some Rl,m,
because nk →∞and either ∆iF > 0 or ∆iH > 0, and the claim is proved. At
each stage of the construction, if (i0, i0) ∈Rk,m for some k and m, then each
point of the discrete rectangle {(i, j): 1 ≤j ≤i0 ≤i ≤n} is in Rk′,m′ for
some k′ ≤k and some m′, by (iii) as proved above. Therefore each (i, j) ∈Dn
is in some Rk,m, and (a) holds. Since each nonempty Rk,m contains exactly
one point of the diagonal {(r, r): r = 1, . . . , n}, there are exactly n nonempty
sets Rk,m.
For (b), let k be odd, and let Rk,m0 be a nonempty rectangle having the
form (3.94). Then the ﬁrst inequality in (3.95) holds by deﬁnition of Rk,m0,
because for m = m0, r3(k, m), as given by (3.102), equals min(u(r2, k), νk,m)−
1, which is the upper limit of the sum in (3.97), deﬁning νk,m+1 = r2(k, m).
The second inequality in (3.95), that is,
F(tr2) −F(tr1−1) ≤n−1
k ,
(3.104)

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
157
will be proved next. Indeed, if k = k0 then (3.104) holds because F(b) ≤n−1
k0
by deﬁnition of k0. Suppose that k > k0, so that k−1 is even and k−1 ≥k0. If
all Rk−1,m are empty then in (3.99) for k−1 in place of k and m = 1, the given
set of ν is empty. Consider ν = r2 = r2(k, m0). Then 1 ≤ν ≤n and (ν, ν) /∈
Wk−1. So the given inequality must fail for this ν, and the contrary inequality
must hold. Since νk−1,1 = 0, it then follows that F(tr2)−F(tv(r2,k−1)) < n−1
k .
By (3.101) with R′
k,m−1 = ∅, we have
r1(k, m0) −1 = max{s < r2 : (s, s) ∈Wk−1} ≥v(r2, k −1),
and so (3.104) holds if all Rk−1,m are empty. Thus suppose that not all Rk−1,m
are empty, e.g. Rk−1,1 is not empty. Let m be the largest integer such that
νk−1,m < r2. Then r1(k, m0) −1 ≥νk−1,m = max{v(νk−1,m, k −1), νk−1,m}.
Thus (3.104) holds by (3.99) for k −1 in place of k and ν = r2, since
r2 < νk−1,m+1. So part (b) of the lemma is proved. The proof of part (c)
is symmetric and we omit it. This completes the proof of the lemma.
2
For moduli of continuity φ, ψ and for an increasing sequence η = {nk} of
positive integers, let
Λ(φ, ψ; η) := φ(1)ψ(1) +
∞
X
k=1
nkφ(n−1
k )ψ(n−1
k ) ≤+∞.
(3.105)
For Ξ ∈CV and for a Banach-space-valued function g on an interval [a, b] with
bounded Ξ-variation on [a, b], let NΞ(g; [a, b]) := g/∥g∥[a,b];(Ξ) if ∥g∥[a,b];(Ξ) ̸=
0 and let NΞ(g; [a, b]) := 0 otherwise.
Proposition 3.73. Assume (1.14) and a < b. Let Φ, Ψ
∈CV be such
that (3.82) holds for Ξ = Φ and Ξ = Ψ, let f
∈WΦ([a, b]; X) with
ˇf := NΦ(f; [a, b]), and let h ∈WΨ([a, b]; Y ) with ˇh := NΨ(h; [a, b]). Let
η = {nk}k≥1 be an inﬁnite W ′(Φ−1, Ψ −1)-sequence such that (3.87) and (3.88)
hold. Then for any u, v with a ≤u < v ≤b, and any partition {ti}n
i=0 of [u, v],

n
X
i=1

f(ti) −f(t0)

·

h(ti) −h(ti−1)

(3.106)
≤θΛ(Φ−1, Ψ −1; η)∥f∥[a,b],(Φ)∥h∥[a,b],(Ψ)

cevΦ( ˇf; [u, v]) + covΨ(ˇh; [u, v])
	
,
where θ ≤1. Moreover, if Λ(Φ−1, Ψ −1; η) < ∞then for any ǫ > 0 there is a
δ > 0 such that θ < ǫ provided 0 < min{vΦ( ˇf; [u, v]), vΨ(ˇh; [u, v])} < δ.
Proof. It is enough to prove the proposition when Λ(Φ−1, Ψ −1; η) < ∞and
∥f∥(Φ) = ∥h∥(Ψ) = 1, in which case f = ˇf and h = ˇh, if we agree that (3.106)
holds when it becomes 0 ≤0 · (+∞). For t ∈[u, v], let F(t) := vΦ(f; [u, t])
and H(t) := vΨ(h; [u, t]). Then F(u) = H(u) = 0. Since the left side of

158
3 Φ-variation and p-variation
(3.106) is zero if f or h is constant on [u, v], we can assume that F(v) > 0
and H(v) > 0. By (b) of Theorem 3.7, we have F(v) ≤vΦ(f; [a, b]) ≤1 and
H(v) ≤vΨ(h; [a, b]) ≤1. For χ = f, h, F, or H, let ∆iχ := χ(ti) −χ(ti−1)
for i = 1, . . . , n. Suppose that for some 1 ≤i ≤n, f and h are constant
on [ti−1, ti], so ∆if, ∆ih, vΦ(f; [ti−1, ti]), and vΨ(h; [ti−1, ti]) are all zero.
Then, we can write f and h as f1 ◦G and h1 ◦G respectively where G is
a nondecreasing continuous function from [a, b] onto itself, strictly increasing
except on [ti−1, ti] where it is constant, and replace tk by uj with G(uj) = tk
where j = k for k = 0, . . . , i −1 and j = k −1 for k = i + 1, . . . , n, so
that j = 0, 1, . . . , n −1. Both sides of (3.106) are the same for f1, h1, and
{uj}n−1
j=0 as for f, h, and {tk}n
k=0. Iterating this step, either we arrive at a
degenerate interval, in which case the proposition holds, or at a case where
for each 1 ≤i ≤n, either ∆iF > 0 or ∆iH > 0. We have to bound the norm
of
U :=
n
X
i=1

f(ti) −f(t0)

·

h(ti) −h(ti−1)

=
X
(i,j)∈Dn
∆jf·∆ih,
with Dn deﬁned by (3.93). To this aim we apply Lemma 3.72 to F, H, {ti}n
i=0
and η = {nk} to obtain an integer k0 ≥1 and a sequence {Rk,m : k ≥k0, m ≥
1} of sets with the properties stated in Lemma 3.72. By Lemma 3.72(a), each
(i, j) ∈Dn is in some Rk,m, and so U = P∞
k=k0 Uk, where for rl = rl(k, m) as
in (3.94),
Uk :=
∞
X
m=1
X
(i,j)∈Rk,m
∆jf·∆ih =
∞
X
m=1

f(tr2) −f(tr1−1)

·

h(tr3) −h(tr2−1)

.
For any u ≤s < t ≤v, by (3.51), we have Φ(∥f(t) −f(s)∥) ≤F(t) −F(s),
and the analogous inequalities hold for the functions Ψ, h, and H. Then for
k ≥k0 such that not all Rk,m are empty, we have
∥Uk∥≤
∞
X
m=1
f(tr2) −f(tr1−1)
 h(tr3) −h(tr2−1)

≤
∞
X
m=1
φ
 F(tr2) −F(tr1−1)

ψ
 H(tr3) −H(tr2−1)

,
where φ and ψ are the inverses Φ−1, Ψ −1, respectively. To bound this series
ﬁrst suppose that k is odd. Since Φ, Ψ ∈CV, it follows that φ, ψ are concave
moduli of continuity, and so φ(u) ↓and u−1ψ(u) ↑as u ↓0 by Proposition
3.14. By Lemma 3.72(b) and since η is a W ′(Φ−1, Ψ −1)-sequence, it then
follows that
∥Uk∥≤φ(n−1
k )nk+1ψ(n−1
k+1)
∞
X
m=1

H(tr3) −H(tr2−1)

≤co

nkφ(n−1
k )ψ(n−1
k ) + nk+1φ(n−1
k+1)ψ(n−1
k+1)
	
H(v)
by (3.87)

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
159
since the intervals [tr2−1, tr3] are nonoverlapping for ﬁxed k. Second, the same
inequality with F(v) instead of H(v) and ce instead of co holds when k is even
by (3.88) and Lemma 3.72(c). Thus
∥U∥≤

coH(v) + ceF(v)
	
∞
X
k=k0
nkφ(n−1
k )ψ(n−1
k )
= θΛ(φ, ψ; η)

cevΦ(f; [u, v]) + covΨ(h; [u, v])
	
,
where
θ := Λ(φ, ψ; η)−1
∞
X
k=k0
nkφ(n−1
k )ψ(n−1
k ).
By the deﬁnition of k0 in Lemma 3.72, n−1
k0+1 < min{vΦ(f; [u, v]), vΨ(h; [u, v])}.
Since Λ(φ, ψ; η) < ∞, given ǫ > 0 there exists δ > 0 such that θ < ǫ provided
0 < min{vΦ(f; [u, v]), vΨ(h; [u, v]) < δ, since k0 + 1 and so k0 goes to +∞as
δ →0. The proposition is now proved.
2
Full Stieltjes integrability
Recall Deﬁnition 2.41 of the full Stieltjes integral. Now we are ready to prove
necessary and suﬃcient conditions for full Stieltjes integrability for all func-
tions f, h with bounded Φ- and Ψ-variation respectively when Φ and Ψ are
convex.
Deﬁnition 3.74. We say that a pair of functions Φ, Ψ ∈V form a Stieltjes
pair if, assuming (1.14), the full Stieltjes integral (S) ∫b
a f·dh exists for any
f ∈WΦ([a, b]; X) and h ∈WΨ([a, b]; Y ).
Due to bilinearity of the full Stieltjes integral (Theorem 2.72), if Φ, Ψ ∈V
form a Stieltjes pair, then the full Stieltjes integral (S) ∫b
a f·dh exists for all
f ∈f
WΦ([a, b]; X) and h ∈f
WΨ([a, b]; Y ).
When a = b, the integrals exist by deﬁnition and are 0, so in the deﬁnition
we could assume equivalently that a < b.
It will be shown in Corollary 3.77 that Φ, Ψ are a Stieltjes pair if and
only if Ψ, Φ are. For the RS and RRS integrals and continuous real-valued
functions, for example, this would follow from integration by parts, Theorem
2.80. For f and h with common one-sided discontinuities, however, as for the
RYS integral in Theorem 2.81, integration by parts is more complicated.
For a modulus of continuity φ, an interval J, and a Banach space X, let
H0
φ(J; X) be the set of all functions f : J →X such that
sup
t,t+u∈J
f(t + u) −f(t)
 = o(φ(u))
as u ↓0,
and let H0
φ(J) := H0
φ(J; R). If J = [a, b] let H0
φ[a, b] := H0
φ(J).

160
3 Φ-variation and p-variation
Theorem 3.75. The following conditions about Φ and Ψ in CV with inverses
φ and ψ, respectively, are equivalent:
(a) Φ and Ψ form a Stieltjes pair;
(b) the integral (RS) ∫2π
0
f dh exists for any f ∈H0
φ[0, 2π] and h ∈H0
ψ[0, 2π];
(c) Λ(φ, ψ; η) < ∞for any φ- and ψ-lacunary sequence η;
(d) Λ(φ, ψ; η) < ∞for some W(φ, ψ)-sequence η;
(e) Λ(φ, ψ; η0) < ∞for the D’yaˇckov sequence η0(φ, ψ).
Proof. We begin by showing that all ﬁve statements are true if (3.81) fails for
φ or ψ. Suppose that v ̸= o(ξ(v)) as v ↓0 for ξ = φ or ψ. Then ﬁrst, by the
remark following Deﬁnition 3.70, the D’yaˇckov sequence η0(φ, ψ) is ﬁnite, and
hence (e) holds.
Second, if as u ↓0, u ̸= o(φ(u)), then φ(u)/u remains bounded by the
remarks following Deﬁnition 3.67, and so u−1φ(u)ψ(u) →0 as u ↓0 since
ψ(u) ↓0. The same holds, interchanging φ and ψ, if u ̸= o(ψ(u)). Therefore
there exists a sequence η such that Λ(φ, ψ; η) < ∞. Also, again by the remarks
following Deﬁnition 3.67, each {nk} is a W(φ, ψ)-sequence, and hence (d)
holds.
Third, (c) holds because every φ- and ψ-lacunary sequence is ﬁnite by
Proposition 3.65. Finally, if f and h have bounded Φ- and Ψ-variations re-
spectively, then one of them is of bounded variation by Proposition 3.39, the
other is regulated by Proposition 3.33, and the full Stieltjes integral (S) ∫b
a f·dh
exists in this case by Theorems 2.20, 2.17, and 2.42. So (a) and (b) hold. There-
fore for the rest of the proof we can assume that (3.81) holds for ξ = φ and
for ξ = ψ.
(b) ⇒(c). Assuming that (c) fails to hold, we construct functions f ∈
H0
φ[0, 2π] and h ∈H0
ψ[0, 2π] such that the integral (RS) ∫2π
0
f dh does not
exist. Suppose that Λ(φ, ψ; η) = ∞for some sequence η = {nk} which
is φ- and ψ-lacunary. By Lemma 3.66, one can decompose η into ﬁnitely
many sequences η′ = {n′
k} lacunary in the sense of Hadamard such that
for each of them, 20n′
k ≤n′
k+1 for all k ≥1, and for at least one of them,
P
k≥1 n′
kφ(1/n′
k)ψ(1/n′
k) = ∞. Fix {n′
k} satisfying the latter condition. For
each k ≥1, let νk := min{4m: m ∈N, n′
k ≤4m}. Then 4−1νk < n′
k ≤νk.
We note for later reference that
νk+1 ≥n′
k+1 ≥20n′
k ≥5νk.
(3.107)
Taking χ = φ and ψ, since χ is concave, we have χ(1/νk) ≤χ(1/n′
k) ≤
4χ(1/νk) for each k ≥1.
It will be shown that {νk} is φ- and ψ-lacunary. By assumption η = {nk}
is φ-lacunary, and so (3.83) holds for some C = C(η). We have that η′ = {n′
k}
is a subsequence of η. Thus for any m ≥1 there is an l ≥1 such that nl = n′
m
and
m
X
j=1
n′
jφ(n′−1
j
) ≤
l
X
k=1
nkφ(n−1
k ) ≤Cnlφ(n−1
l
) = Cn′
mφ(n′−1
m ).

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
161
Therefore the ﬁrst inequality in (3.83) holds with η replaced by η′. Similarly
the second inequality in (3.83) holds with η replaced by η′, and so η′ is φ-
lacunary. Next using the inequalities between νk and n′
k stated before and
after (3.107), we have
m
X
k=1
νkφ(ν−1
k ) ≤4
m
X
k=1
n′
kφ(n′−1
k
) ≤4Cn′
mφ(n′−1
m ) ≤42Cνmφ(ν−1
m )
for each m ≥1. Similarly it follows that P∞
k=m φ(ν−1
k ) ≤4Cφ(ν−1
m ) for each
m ≥1. Thus {νk} is φ-lacunary. The same holds with φ replaced by ψ, so
{νk} is indeed φ- and ψ-lacunary.
We also have since χ(1/νk) ≥χ(1/n′
k)/4 for χ = φ or ψ and νk ≥n′
k for
each k that
X
k≥1
νkφ(1/νk)ψ(1/νk) = ∞.
Let ck ↓0 be a sequence of positive numbers such that
X
k≥1
c2
kνkφ(1/νk)ψ(1/νk) = ∞.
Then deﬁne two real-valued functions f and h on [0, 2π] by
f(t) :=
∞
X
k=1
ckφ(ν−1
k ) cos(νkt)
and
h(t) :=
∞
X
k=1
ckψ(ν−1
k ) sin(νkt)
for 0 ≤t ≤2π. Both series are uniformly convergent by the second inequality
in (3.83) for ξ = φ and ξ = ψ. We show next that the functions deﬁned by the
two series are in H0
φ[0, 2π] and H0
ψ[0, 2π], respectively. For any u ∈(0, 1/ν1],
let m be the integer such that 1/νm+1 < u ≤1/νm. Then
|f(t + u) −f(t)| ≤u
X
k≤m
ckνkφ(ν−1
k ) + 2
X
k>m
ckφ(ν−1
k ) =: T1 + T2
(3.108)
for each u ∈(0, 1/ν1] and t ∈[0, 2π −u]. Given ǫ > 0 choose an integer k0 ≥1
such that ck ≤ǫ for each k ≥k0. Then choose an integer k1 ≥k0 such that
νk0φ(ν−1
k0 ) ≤ǫνkφ(ν−1
k ) for each k ≥k1, which is possible due to (3.81) for
ξ = φ. Thus if u ∈(0, 1/νk1+1], then in (3.108), m > k1 ≥k0 and by the ﬁrst
inequality in (3.83) twice, once for m there equal to k0 here,
T1 ≤u

Cc1νk0φ(ν−1
k0 ) + ǫCνmφ(ν−1
m )

≤ǫ(c1 + 1)Cφ(u)
because νmφ(ν−1
m ) ≤φ(u)/u by Proposition 3.14. Using the second inequality
in (3.83), it follows that T2 ≤2ǫCφ(u). Therefore f ∈H0
φ[0, 2π]. Similarly it
follows that h ∈H0
ψ[0, 2π].
To show that the integral (RS) ∫2π
0
f dh does not exist, for each positive
integer n, consider the tagged partition τn = ({tj}4νn
j=0, {tj}4νn
j=1), where tj :=
πj/(2νn), j = 0, . . . , 4νn. Applying the identities

162
3 Φ-variation and p-variation
sin 2u −sin 2v = 2 sin(u −v) cos(u + v),
(3.109)
2 cosu cos v = cos(u −v) + cos(u + v),
where the ﬁrst follows from cos θ = (eiθ + e−iθ)/2, sin θ = (eiθ −e−iθ)/(2i), we
have
SRS(f, dh; τn)
=
4νn
X
j=1
∞
X
k,l=1
ckclφ(ν−1
k )ψ(ν−1
l
)2 cos πνkj
2νn
sin πνl
4νn
cos π(2j −1)νl
4νn
=
∞
X
k,l=1
ckclφ(ν−1
k )ψ(ν−1
l
) sin πνl
4νn
×
4νn
X
j=1
n
cos 2π(νk −νl)j + πνl
4νn
+ cos 2π(νk + νl)j −πνl
4νn
o
.
Since each νk is an integer power of 4 and νk+1 ≥5νk for every k ≥1 by
(3.107), each term with indices k or l > n equals zero. Computing the inner
sum by the formula, valid for 0 < t < 2π and any M = 1, 2, . . . ,
M
X
j=1
cos(jt + s) = sin((M + 1
2)t + s) −sin( 1
2t + s)
2 sin 1
2t
,
(3.110)
which again follows from cos θ = (eiθ + e−iθ)/2, sin θ = (eiθ −e−iθ)/(2i), and
then some geometric series, noting that Mt = 4νnt is an integer multiple of 2π,
we see that all terms vanish except those with νk −νl for k = l, where (3.110)
does not apply. Then applying the inequality (sin u)/u ≥2/π for 0 < u ≤π/2,
we get that
SRS(f, dh; τn) =
n
X
k=1
c2
kφ(ν−1
k )ψ(ν−1
k )2νn sin πνk
2νn
≥2
n
X
k=1
c2
kνkφ(ν−1
k )ψ(ν−1
k )
for each n ≥1. Since the last sum increases without bound as n →∞, the
Riemann–Stieltjes integral for the functions f and h does not exist, proving
the implication (b) ⇒(c).
(c) ⇒(d) holds since a D’yaˇckov sequence is both φ-, ψ-lacunary and a
W(φ, ψ)-sequence by Proposition 3.71.
(d) ⇒(e). Let η = {nk} be a W(φ, ψ)-sequence such that Λ(φ, ψ; η) < ∞
and let C := W(φ, ψ; η). We have to show that Λ(φ, ψ; η0) < ∞for the
D’yaˇckov sequence η0(φ, ψ) = {ml}∞
l=1. To this aim we use Lemma 3.69 for
the sequence η. Let I(k) := {l ∈N: nk ≤ml < nk+1} for each k ≥1. By
Deﬁnition 3.70, for ξ = φ or ψ, 4ξ(m−1
l+2) ≤ξ(m−1
l
) and ml+2ξ(m−1
l+2) ≥
4mlξ(m−1
l
) for each l ≥1. If M :=card I(k) ≥3, let l1 = l1(k) and l2 = l2(k)
be respectively the smallest and the largest integer in I(k). Then

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
163
ξ(n−1
k+1)
ξ(n−1
k ) ≤ξ(m−1
l2 )
ξ(m−1
l1 ) ≤
1
4
⌊(M−1)/2⌋
,
where ⌊x⌋is the largest integer ≤x, and
nkξ(n−1
k )
nk+1ξ(n−1
k+1) ≤ml1ξ(m−1
l1 )
ml2ξ(m−1
l2 ) ≤
1
4
⌊(M−1)/2⌋
.
Therefore card I(k) ≤2+log2(C−1) for each k ≥1. Since φ and ψ are concave,
this together with Lemma 3.69 gives the bound
X
l≥l1(1)
mlφ(m−1
l
)ψ(m−1
l
) ≤2C−1(2 + log2(C−1))Λ(φ, ψ; η) < ∞,
proving (e).
(e) ⇒(a). Assuming (1.14) and a < b, let f ∈WΦ([a, b]; X) and
h ∈WΨ([a, b]; Y ). Due to bilinearity of the full Stieltjes integral (Theorem
2.72) and since if f or h is constant the integral exists, we can and do as-
sume that ∥f∥(Φ) = ∥h∥(Ψ) = 1. Proposition 3.73 and the Cauchy test will
be used to show the existence of the reﬁnement Riemann–Stieltjes and reﬁne-
ment Young–Stieltjes integrals. Next we show that it is enough to consider
Riemann–Stieltjes and Young–Stieltjes sums based on tagged partitions with
suitable tags. Recall the deﬁnition (2.16) of Young–Stieltjes sums SYS.
Lemma 3.76. Let Φ, Ψ ∈V with inverses φ, ψ, respectively, be such that
φ(u)ψ(u) = o(u)
as u ↓0.
(3.111)
Let f ∈WΦ([a, b]; X) and h ∈WΨ([a, b]; Y ). Given ǫ > 0, there is a partition
λ of [a, b] such that (a), (b), and (c) hold, where:
(a) For any reﬁnement κ of λ and for tagged Young partitions τ ′ = (κ, ξ′) and
τ′′ = (κ, ξ′′),
R(κ, ξ′, ξ′′) :=
SYS(f, dh; τ′) −SYS(f, dh; τ′′)
 < ǫ.
(b) For any reﬁnement κ = {tj}m
j=0 of λ,
T (κ, {τ ′
j}, {τ′′
j }) :=
m
X
j=1
SRS(fj, dhj; τ′
j) −SRS(fj, dhj; τ′′
j )
 < ǫ,
where for j = 1, . . . , m, τ ′
j = (κj, ξ′
j), τ ′′
j = (κj, ξ′′
j ) are tagged partitions of
[tj−1, tj] and for χ = f or h, χj := χ on (tj−1, tj), χj(tj−1) := χ(tj−1+)
and χj(tj) := χ(tj−).
(c) If f and h have no common one-sided discontinuities then for any reﬁne-
ment κ of λ and for tagged partitions τ ′ = (κ, ξ′), τ ′′ = (κ, ξ′′),
Q(κ, ξ′, ξ′′) :=
SRS(f, dh; τ′) −SRS(f, dh; τ′′)
 < ǫ.
(3.112)

164
3 Φ-variation and p-variation
Proof. For u ∈[a, b], let F(u) := vΦ(f; [a, u]) and H(u) := vΨ(h; [a, u]). By
(3.51), for any a ≤u < s′ ≤s′′ < v ≤b, we have Φ(∥f(s′) −f(s′′)∥) ≤
F(v−) −F(u+). Thus ∥f(s′) −f(s′′)∥≤φ(F(v−) −F(u+)). Similarly, we
have ∥h(v−)−h(u+)∥≤ψ(H(v−)−H(u+)). Let V := F +H and let ǫ0 > 0.
Since V is nondecreasing and ﬁnite on [a, b], by Theorem 2.1(b), there exists
a partition λ = {zl}k
l=0 of [a, b] such that
V (zl−) −V (zl−1+) < ǫ0
for each l = 1, . . . , k.
(3.113)
For (a), let κ = {ti}n
i=0 be a reﬁnement of λ. Let ξ′ = {s′
i}n
i=1 and ξ′′ =
{s′′
i }n
i=1 be sets of tags with s′
i, s′′
i ∈(ti−1, ti) for i = 1, . . . , n. By (3.113), it
follows that
R(κ, ξ′, ξ′′) ≤
n
X
i=1
f(s′
i) −f(s′′
i )
 h(ti−) −h(ti−1+)

≤
n
X
i=1
φ
 V (ti−) −V (ti−1+)

ψ
 V (ti−) −V (ti−1+)

≤V (b)
sup
0<u≤ǫ0
u−1φ(u)ψ(u).
Therefore statement (a) holds by assumption (3.111).
For (b), let κ = {tj}m
j=0 be a reﬁnement of λ, and let κj = {tji}nj
i=0
be a partition of [tj−1, tj] for j = 1, . . . , m. Let ξ′
j = {s′
ji}nj
i=1 and ξ′′
j =
{s′′
ji}nj
i=1 be two sets of tags for κj, and let uji := min{V (tji), V (tj−)} −
max{V (tj,i−1), V (tj−1+)} for i = 1, . . . , nj and j = 1, . . . , m. Then each uji
is less than ǫ0 by (3.113) since κ is a reﬁnement of λ. As for f and h, by (3.51),
for i = 1, . . . , nj, we have that each ∥fj(s′
ji) −fj(s′′
ji)∥is bounded by φ(uji),
and each ∥hj(tji) −hj(tj,i−1)∥is bounded by ψ(uji). Then we have
T (κ, {τ′
j}, {τ′′
j }) ≤
m
X
j=1
nj
X
i=1
fj(s′
ji) −fj(s′′
ji)
 hj(tji) −hj(tj,i−1)

≤
m
X
j=1
nj
X
i=1
φ(uji)ψ(uji) ≤V (b)
sup
0<u≤ǫ0
u−1φ(u)ψ(u).
Now (b) also follows from the assumption (3.111).
To prove (c) suppose that f and h have no common one-sided discontinu-
ities. Then by Proposition 3.44, one can choose µ = {ul−1, vl : l = 1, . . . , k} ⊂
(a, b) such that for each l = 1, . . . , k, we have zl−1 < ul−1 < vl < zl,
min

φ
 F(ul−1) −F(zl−1)

, ψ
 H(ul−1) −H(zl−1)
	
< ǫ0/k,
and

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
165
min

φ
 F(zl) −F(vl)

, ψ
 H(zl) −H(vl)
	
< ǫ0/k.
Let λ′ := λ ∪µ. Then (c) will be proved, and (a) and (b) still hold, for λ′ in
place of λ. Let κ = {ti}n
i=0 be a reﬁnement of λ′, and let I be the set of indices
i ∈{1, . . . , n} such that either ti ∈{z1, . . . , zk} or ti−1 ∈{z0, . . . , zk−1}. For
G = F, H or V , let ∆iG := G(ti) −G(ti−1) for i = 1, . . . , n. Let ξ′ = {s′
i}n
i=1
and ξ′′ = {s′′
i }n
i=1 be two sets of tags for κ. Then we have
Q(κ, ξ′, ξ′′)
≤
n
X
i=1
f(s′
i) −f(s′′
i )
 h(ti) −h(ti−1)
 ≤
n
X
i=1
φ(∆iF)ψ(∆iH)
≤2k(ǫ0/k) max{φ(F(b)), ψ(H(b))} +
X
i̸∈I
φ(∆iV )ψ(∆iV )
≤2ǫ0 max{φ(F(b)), ψ(H(b))} + V (b)
sup
0<u≤ǫ0
u−1φ(u)ψ(u),
(3.114)
where the last inequality holds by (3.113). This together with assumption
(3.111) proves statement (c) of the lemma.
2
Now continuing the proof of Theorem 3.75, by Proposition 3.71, the
D’yaˇckov sequence η0(φ, ψ) is a W ′(φ, ψ)-sequence with co = ce = 16 (cf.
(3.87) and (3.88)). Since Λ(φ, ψ, η0) < ∞, by Lemma 3.69, it follows that
(3.111) holds. Suppose that f and h have no common one-sided discon-
tinuities. For a tagged partition τ of the form ({tj}m
j=0, {tj−1}m
j=1), con-
sider a tagged reﬁnement of the form τ′ = ({si}n
i=0, {si}n
i=1). Thus for each
j = 0, . . . , m, there is an i(j) ∈{0, . . ., n} such that si(j) = tj. Then recalling
that ∥f∥(Φ) = ∥h∥(Ψ) = 1 and using Proposition 3.73 with [u, v] = [tj−1, tj]
for each j, we have for some θj ∈(0, 1],
SRS(f, dh; τ′) −SRS(f, dh; τ)

≤
m
X
j=1

i(j)
X
i=i(j−1)+1

f(si) −f(si(j−1))

·

h(si) −h(si−1)

≤16Λ(φ, ψ; η0)
m
X
j=1
θj
n
vΦ(f; [tj−1, tj]) + vΨ(h; [tj−1, tj])
o
≤32Λ(φ, ψ; η0) max
1≤j≤m θj,
(3.115)
where the last inequality holds by iterating (3.51), and then (3.9). By the sec-
ond part of Proposition 3.73, the right side of (3.115) can be made arbitrarily
small provided given ǫ > 0 one can choose a partition {tj}m
j=0 of [a, b] such
that for each j = 1, . . . , m,

166
3 Φ-variation and p-variation
min

vΦ(f; [tj−1, tj]), vΨ(h; [tj−1, tj])
	
< ǫ.
(3.116)
So, let ǫ > 0 be given. By Proposition 3.40, there exists a partition {zl}k
l=0 of
[a, b] such that for each l = 1, . . . , k,
max

vΦ(f; (zl−1, zl)), vΨ(h; (zl−1, zl))} < ǫ.
(3.117)
Since f and h have no common one-sided discontinuities, by Proposition 3.42,
there exists µ = {ul−1, vl : l = 1, . . . , k} ⊂(a, b) such that for each l =
1, . . . , k, zl−1 < ul−1 < vl < zl, we have
min

vΦ(f; [zl−1, ul−1]), vΨ(h; [zl−1, ul−1])
	
< ǫ,
and
min

vΦ(f; [vl, zl]), vΨ(h; [vl, zl])
	
< ǫ.
Therefore if {tj}m
j=0 is a reﬁnement of λ ∪µ, then (3.116) holds for each
j = 1, . . . , m. Again using (3.115) and Lemma 3.76(c), we conclude that the
Riemann–Stieltjes sums for f and h satisfy the Cauchy test under reﬁnement,
and hence (RRS) ∫b
a f·dh exists provided f and h have no common one-sided
discontinuities.
Now let f and h be any functions in WΦ([a, b]; X) and WΨ([a, b]; Y ), respec-
tively, except that ∥f∥(Φ) = ∥h∥(Ψ) = 1 as before. Let τ = ({tj}m
j=0, {sj}m
j=1)
be a Young tagged partition of [a, b]. For each j = 1, . . . , m, let τj =
({tji}nj
i=0, {sji}nj
i=1) be a Young tagged partition of [tj−1, tj]. Then ∪m
j=1τj is a
Young tagged reﬁnement of τ. Also for each j = 1, . . . , m, let fj be a function
deﬁned on [tj−1, tj] so that it equals f on (tj−1, tj), fj(tj−1) := f(tj−1+), and
fj(tj) := f(tj−). Likewise for each j = 1, . . . , m, deﬁne hj on [tj−1, tj]. Then
SYS(f, dh; τ)−SYS(f, dh; ∪jτj) =
m
X
j=1

f(sj)−f(tj−1+)

·[h(tj−)−h(tj−1+)

+
m
X
j=1
n
fj(tj−1)·[hj(tj) −hj(tj−1)] −SYS(fj, dhj; τj)
o
=: R + T.
(3.118)
We will show that the norm of R+T is small for suitable partitions τ. At this
stage no assumptions have been made on the partitions τ or τj, j = 1, . . . , m.
A partition τ will be chosen near the end of the proof. The norm of R will
be made small using part (a) of Lemma 3.76. To bound the norm of T will
be less easy. To this aim Proposition 3.73 and part (b) of Lemma 3.76 will
be used after decomposing each term of T into three parts as follows. Let
j ∈{1, . . . , m}, and let κj = {uj,i−1, vji}nj
i=1 ⊂[tj−1, tj] be a partition of
[tj−1, tj] such that
tj−1 = uj0 < sj1 < vj1 < tj1, tj,nj−1 < uj,nj−1 < sj,nj < vj,nj = tj, (3.119)
and

*3.4 A Necessary and Suﬃcient Condition for Integral Duality
167
tj,i−1 < uj,i−1 < sji < vji < tji
for
i = 2, . . . , nj −1.
(3.120)
Let ξ′
j = {sji, tji}nj−1
i=1
∪{sj,nj} and ξ′′
j = {vji, uji}nj−1
i=1
∪{vj,nj}. Then τ′
j =
(κj, ξ′
j) and τ′′
j = (κj, ξ′′
j ) are tagged partitions of [tj−1, tj], and
fj(tj−1)·[hj(tj) −hj(tj−1)] −SYS(fj, dhj; τj)
=

fj(tj−1)·[hj(tj) −hj(tj−1)] −SRS(fj, dhj; τ′′
j )
	
+

SRS(fj, dhj; τ′′
j ) −SRS(fj, dhj; τ′
j)
	
+

SRS(fj, dhj; τ′
j) −SYS(fj, dhj; τj)
	
=: Tj1 + Tj2 + Tj3.
For Tj3 suppose that in (3.119) and (3.120) uji ↓tji and vji ↑tji for i =
1, . . . , nj −1. Then since ∆+hj(tj−1) = h(tj−1+) −h(tj−1+) = 0,
fj(sj1)·

hj(vj1) −hj(tj−1)

→fj(sj1)·

hj(tj1−) −hj(tj−1+)

.
For i = 2, . . . , nj −1, we have
fj(sji)·

hj(vji) −hj(uj,i−1)

→fj(sji)·

hj(tji−) −hj(tj,i−1+)

,
fj(tji)·

hj(uji) −hj(vji)

→fj(tji)·

hj(tji+) −hj(tji−)

.
Since ∆−hj(tj) = h(tj−) −h(tj−) = 0,
fj(sj,nj)·

hj(tj) −hj(uj,nj−1)

→fj(sj,nj)·

hj(tj−) −hj(tj,nj−1+)

.
Thus we have that each Tj3 →0 as uji ↓tji and vji ↑tji for i = 1, . . . , nj −1.
Now Proposition 3.73 with η = η0 can be applied m times, once to each
sum Tj1 formed by the functions fj and hj, with [u, v] = [tj−1, tj]. Since
vΦ(fj; [tj−1, tj]) = vΦ(f; (tj−1, tj)) and vΨ(hj; [tj−1, tj]) = vΨ(h; (tj−1, tj)),
we then have as in (3.115) for some θj ∈(0, 1],
m
X
j=1
∥Tj1∥≤16Λ(φ, ψ; η0)
m
X
j=1
θj
n
vΦ(f; (tj−1, tj)) + vΨ(h; (tj−1, tj))
o
≤32Λ(φ, ψ; η0) max
1≤j≤m θj.
(3.121)
Now we are ready to specify partitions τ for which the norm of R + T in
(3.118) is small. Let ǫ > 0. By the second part of Proposition 3.73, there exists
δ > 0 such that in (3.121), maxj θj < ǫ for any partition {tj}m
j=0 of [a, b] such
that
max
1≤j≤m vΨ(hj; [tj−1, tj]) = max
1≤j≤m vΨ(h; (tj−1, tj)) < δ.
(3.122)
By Proposition 3.40, there exists a partition λ of [a, b] such that (3.122) holds
for any reﬁnement {tj}m
j=0 of λ. We can and do assume that (a) and (b) of
Lemma 3.76 hold for λ. Let τ = ({tj}m
j=0, {sj}m
j=1) be a Young tagged partition
of [a, b] which is a reﬁnement of λ, and let τj = ({tji}nj
i=0, {sji}nj
i=1) be a Young

168
3 Φ-variation and p-variation
tagged partition of [tj−1, tj] for j = 1, . . . , m. For each j = 1, . . . , m and
i = 1, . . . , nj −1, letting uji ↑tji and vji ↓tji, it follows that Pm
j=1 ∥Tj3∥< ǫ
for some κj = {uj,i−1, vji}nj
i=1 satisfying (3.119) and (3.120). Then ∥R∥< ǫ for
R in (3.118) and Pm
j=1 ∥Tj2∥< ǫ by (a) and (b) of Lemma 3.76, respectively.
Summing the bounds, we have
SYS(f, dh; τ) −SYS(f, dh; ∪jτj)
 ≤∥R∥+
m
X
j=1

∥Tj1∥+ ∥Tj2∥+ ∥Tj3∥
	
≤ǫ + 32ǫΛ(φ, ψ; η0) + ǫ + ǫ.
Since ǫ is arbitrary, (RYS) ∫b
a f·dh exists by the Cauchy test under reﬁnement,
proving the implication (e) ⇒(a). Since H0
φ[a, b] ⊂WΦ[a, b] (by Proposition
3.32 with G the identity function), and likewise for ψ and Ψ, clearly (a) implies
(b), so the proof of Theorem 3.75 is complete.
2
Notice that in Theorem 3.75, condition (c) (or (d)) is symmetric in Φ and
Ψ. Thus we have the following:
Corollary 3.77. Φ and Ψ in CV are a Stieltjes pair if and only if Ψ and Φ
are.
3.5 Suﬃcient Conditions for Integrability
Let Φ, Ψ ∈V have inverses φ, ψ respectively which are moduli of continuity,
so that Φ, Ψ ∈VM. For t > 0, let
IB(t) := IB(φ, dψ; t) := (RS)
Z t
0+
φ(u)
u
dψ(u)
:= lim
ǫ↓0 (RS)
Z t
ǫ
φ(u)
u
dψ(u) ≤+∞.
(3.123)
Note that the integral clearly exists for each ǫ ∈(0, t) and increases as ǫ ↓0.
Finiteness of IB(1) (or equivalently, of IB(t) for any t > 0) will be called
Beurling’s condition, since Beurling [14] made use of it. Since φ(u) ≥0 and ψ
is increasing, IB(t) = (LS) ∫t
0 u−1φ(u) dψ(u) if either is ﬁnite. Speciﬁcally, the
integrals from ǫ to t are equal by Propositions 2.13, 2.18, 2.27 and Corollary
2.29, and as ǫ ↓0 we have monotone convergence for the LS integral.
Theorem 3.78. Let Φ, Ψ ∈CV with inverses φ, ψ respectively. If the Beur-
ling condition IB(φ, dψ; 1) < ∞holds then Φ and Ψ form a Stieltjes pair, and
φ(u)ψ(u) = o(u) as u ↓0.

3.5 Suﬃcient Conditions for Integrability
169
Proof. To prove the ﬁrst part of the conclusion we show that Theorem 3.75(d)
applies, that is, there is a W(φ, ψ)-sequence η such that Λ(φ, ψ; η) < ∞.
Recursively choose n1 := 1, and for each k ≥1 given nk, let nk+1 be the
smallest integer n such that n ≥nk and ψ(1/n) ≤(1/2)ψ(1/nk). Then η :=
{nk} is a W(φ, ψ)-sequence (Deﬁnition 3.67) since for each k ≥1, nk+1 ≤
2(nk+1 −1) and so by subadditivity of ψ,
ψ

1
nk+1

≥ψ

1
2(nk+1 −1)

≥1
2ψ

1
nk+1 −1

> 1
4ψ
 1
nk

.
Using (3.31), for each k ≥1, we have
Z n−1
k
n−1
k+1
φ(u)
u
dψ(u) ≥nk
2 φ
 1
nk
h
ψ
 1
nk

−ψ

1
nk+1
i
≥nk
4 φ
 1
nk

ψ
 1
nk

.
Summing over k it follows that Λ(φ, ψ; η) < ∞, proving the ﬁrst part of the
conclusion. Moreover, limk→∞nkφ(n−1
k )ψ(n−1
k ) = 0, and so the second part
follows from Lemma 3.69, proving the theorem.
2
Let c, β, γ ∈R with c > 0. The function g = gc,β,γ from (0, e−e] into R
deﬁned by
g(x) = c

log 1
x
β
log log 1
x
γ
(3.124)
will be called a simple logarithmic function. A ﬁnite linear combination of
simple logarithmic functions with real coeﬃcients will be called a logarithmic
function. The following considerations hold for more general functions, but
the given functions will suﬃce for present purposes.
Lemma 3.79. Let c, α, β, γ ∈R with c > 0 and α ≥0. Let g = gc,β,γ be the
simple logarithmic function (3.124) and let f(x) := xαg(x) for 0 < x ≤e−e
and f(0) := 0. Then there exists a δ = δ(α, β, γ) > 0 with δ ≤e−e such that
(a) f is convex on [0, δ] if either α > 1, or α = 1 and β < 0;
(b) f is convex on (0, δ] (unbounded near 0) if α = 0 and β > 0;
(c) f is concave on [0, δ] if 0 < α < 1, or α = 0 and β < 0, or α = 1 and
β > 0.
Moreover, if α > 1, β ≤0, and γ ≤0, then f is convex on the entire interval
[0, e−e].
Proof. Clearly f is continuous on (0, e−e]. It is continuous from the right at
0 unless α = 0 and either β > 0 or β = 0 and γ ≥0. There is a logarithmic
function g1 such that the derivative g′(x) = x−1g(x)g1(x) for 0 < x ≤e−e
and g1(x) = o(1) as x ↓0. It follows that if α > 0 and α ̸= 1, then for all
0 < x < e−e,
f ′′(x) = xα−2g(x)
h
α(α −1) + g2(x)
i
,

170
3 Φ-variation and p-variation
where g2 is a logarithmic function and g2(x) = o(1) as x ↓0. If α > 1, β ≤0,
and γ ≤0, then g2 is nonnegative on (0, e−e], and so the last conclusion
follows.
To prove (a), (b), and (c), if α > 0 and α ̸= 1, then f ′′(x) ∼α(α −
1)xα−2g(x) as x ↓0, and the conclusions follow if α > 1 or 0 < α < 1. If
α = 0, then f ≡g on (0, δ] and
g′′(x) = cβ
x2

log 1
x
β−1
log log 1
x
γ
1 + o(1)

as x ↓0. If β < 0, f is continuous at 0. The corresponding conclusions follow.
If α = 1, then
f ′′(x) = 2g′(x) + xg′′(x) = −cβ
x

log 1
x
β−1
log log 1
x
γ
1 + o(1)

as x ↓0. Conclusions (a), (b), and (c) are now proved.
2
A function f as deﬁned in the preceding lemma can be restricted to an
interval [0, δ] and then extended to [0, ∞) by letting
f(x) :=



0
if x = 0,
xαg(x)
if 0 < x ≤δ,
f(δ) + (x −δ)f ′(δ−) if x > δ.
(3.125)
Then f is convex or concave on [0, ∞) if it is on [0, δ], and likewise for (0, ∞)
and (0, δ] (if α = 0 and β > 0).
The converse to Theorem 3.78 does not hold by the following.
Example 3.80. Let β0 > 0 and β1 > 0. Applying Lemma 3.79, take numbers
δ(0, −β0, 0) and δ(1, β1, 0). Let x0 := min(e−β1, δ(0, −β0, 0), δ(1, β1, 0)) > 0.
For 0 < x ≤x0, let
φ(x) :=

log 1
x
−β0
and
ψ(x) := x

log 1
x
β1
.
Notice that ψ′(x) = | log x|β1 −β1| log x|β1−1 ∼| log x|β1 as x ↓0. Also,
ψ′(x) > 0 for 0 < x < e−β1. Extending φ and ψ to [0, ∞) by (3.125),
both functions are continuous, concave, and increasing. Thus Beurling’s con-
dition IB(φ, dψ; 1) < ∞holds if and only if β0 > β1 + 1. The condition
Λ(φ, ψ; η0) < ∞for the D’yaˇckov sequence (Deﬁnition 3.70) η0 = {nk} re-
duces to P∞
k=1[log nk]β1−β0 < ∞. The D’yaˇckov sequence is lacunary in the
sense of Hadamard with θ = 4 as in (3.84), and so nk ≥4k for all k ≥1. On
the other hand, by (3.90), log nk+2 ≥41/β0 log nk for all k ≥1, so the series
converges if and only if β0 > β1. Notice that the preceding condition holds if
and only if IB(ψ, dφ; 1) < ∞, that is, Beurling’s condition holds with φ and
ψ interchanged.

3.5 Suﬃcient Conditions for Integrability
171
Next, pairs (φ, ψ) such that Beurling’s condition holds both for (φ, ψ) and
for (ψ, φ) will be characterized. For functions φ and ψ from [0, ∞) into [0, ∞),
let
Θ(φ, ψ) :=
∞
X
k=1
φ(k−1)ψ(k−1) ≤+∞.
(3.126)
Proposition 3.81. Let φ and ψ be moduli of continuity.
(i) The following ﬁve conditions are equivalent:
(a) Θ(φ, ψ) < ∞;
(b) P∞
k=0 2kφ(1/2k)ψ(1/2k) < ∞;
(c) P∞
k=1 2kφ(1/2k)ψ(1/2k−1) < ∞;
(d) P∞
k=1 2kφ(1/2k−1)ψ(1/2k) < ∞;
(e) IB(φ, dψ; 1) < ∞and IB(ψ, dφ; 1) < ∞.
(ii) If for some δ > 0,
ψ(1/2k) ≤(1 −δ)ψ(1/2k−1)
(3.127)
for k = 1, 2, . . ., and IB(φ, dψ; 1) < ∞, then (a)–(e) hold.
(iii) There exist pairs φ, ψ for which IB(ψ, dφ; 1) < ∞but (a)–(e) do not
hold, speciﬁcally φ and ψ in Example 3.80 with β0 −1 ≤β1 < β0.
Proof. For (i), clearly (c) implies (b) since ψ is nondecreasing. The sum in (b)
equals
∞
X
j=1
2j−1φ(1/2j−1)ψ(1/2j−1),
whose convergence implies (c) since φ is nondecreasing. So (b) and (c) are
equivalent. Similarly, interchanging φ with ψ, it follows that (b) and (d) are
equivalent.
For the sum in (a) we have
Θ(φ, ψ) =
∞
X
k=0
2k+1−1
X
n=2k
φ(1/n)ψ(1/n),
from which it follows easily that
∞
X
j=1
2j−1φ(2−j)ψ(2−j) =
∞
X
k=0
2kφ(2−k−1)ψ(2−k−1)
≤Θ(φ, ψ) ≤
∞
X
k=0
2kφ(2−k)ψ(2−k),
so (a) is equivalent to (b).
For (b) ⇒(e), by monotonicity of φ, we have

172
3 Φ-variation and p-variation
IB(φ, dψ; 1) =
∞
X
k=1
Z 21−k
2−k
φ(u)
u
dψ(u) ≤2
∞
X
k=1
2k−1φ(1/2k−1)ψ(1/2k−1) < ∞.
Similarly, interchanging φ and ψ, it follows that IB(ψ, dφ; 1) < ∞.
For (e) ⇒(b), let 0 < ǫ < 1. Applying (2.91) with F(u) := u−1, and then
applying (2.93) twice, ﬁrst with h ≡1 (integration by parts) and second with
h(u) := u−1, we have
(RS)
Z 1
ǫ
φ(u)ψ(u)
u2
du = −(RS)
Z 1
ǫ
φ(u)ψ(u) d
 1
u

= −φ(u)ψ(u)
u

1
ǫ
+ (RS)
Z 1
ǫ
φ(u)
u
dψ(u) + (RS)
Z 1
ǫ
ψ(u)
u
dφ(u).
(3.128)
By Theorem 3.78, we also have (φψ)(u) = o(u) as u ↓0. Thus letting ǫ ↓0
on the right side of (3.128), we get that the limit of the left side exists and is
ﬁnite. Also, with deﬁnitions as in (3.123), we have
φ(1)ψ(1) + (RS)
Z 1
0+
φ(u)ψ(u)
u2
du
= (RS)
Z 1
0+
φ(u)
u
dψ(u) + (RS)
Z 1
0+
ψ(u)
u
dφ(u).
By monotonicity of φ and ψ, for each k ≥1, we have
(RS)
Z 21−k
2−k
φ(u)ψ(u)
u2
du ≥2k−2φ(1/2k)ψ(1/2k).
Summing over k, it follows that (b) holds, and hence all ﬁve conditions are
equivalent.
For (ii), if (3.127) holds and IB(φ, dψ; 1) < ∞, then
IB(φ, dψ; 1)
=
∞
X
k=1
(RS)
Z 21−k
2−k
1
uφ(u) dψ(u) ≥
∞
X
k=1
2k−1φ(2−k)[ψ(21−k) −ψ(2−k)]
≥δ
2
∞
X
k=1
2kφ(2−k)ψ(21−k),
implying (c) and thus (a)–(e).
For (iii), taking φ and ψ in Example 3.80, we have IB(ψ, dφ; 1) < ∞if
and only if β1 < β0, while IB(φ, dψ; 1) < ∞if and only if β1 < β0 −1. So
Proposition 3.81 is proved.
2

3.6 Love–Young Inequalities
173
Summing up: the equivalent conditions (a)–(e) of Proposition 3.81(i)
clearly imply Beurling’s condition IB(φ, dψ; 1) < ∞, which by Theorem 3.78
implies the equivalent conditions (a) through (e) of Theorem 3.75, but in
neither case do the converse implications hold in general. Also, we have the
following:
Corollary 3.82. Assume (1.14). Let Φ, Ψ ∈CV with inverses φ, ψ, respec-
tively, and let Θ(φ, ψ) < ∞. The full Stieltjes integral (S) ∫b
a f·dh exists if
f ∈WΦ([a, b]; X) and h ∈WΨ([a, b]; Y ).
3.6 Love–Young Inequalities
The Love–Young inequality gives a bound for an integral in terms of a suitable
p-variation norm of the integrand and q-variation seminorm of the integrator.
Namely by Corollary 3.91 below in this section, if f ∈Wp[a, b], h ∈Wq[a, b]
with 1 ≤p < ∞, 1 ≤q < ∞, and p−1+q−1 > 1, then the full Stieltjes integral
(S) ∫b
a f dh exists and we have the inequality
(S)
Z b
a
f dh
 ≤K∥f∥[p]∥h∥(q),
(3.129)
with the constant K = ζ(p−1 + q−1). Here ζ(r) := P∞
n=1 n−r, r > 1, is the
Riemann zeta function.
L. C. Young in 1936 [244] ﬁrst published an inequality of the form (3.129),
with the constant 1 + K in place of K. He acknowledged that E. R. Love had
contributed to ﬁnding a proof, hence the name “Love–Young inequality.” As
Young pointed out, inequality (3.129) formally resembles the H¨older inequality
(1.4). In contrast with the H¨older inequality, in the Love–Young inequality
(3.129) it is not possible to take p−1 + q−1 = 1, as Proposition 3.104 will
show. However, L. C. Young in 1938 [247] extended (3.129) to f ∈WΦ[a, b]
and h ∈WΨ[a, b] with Φ, Ψ ∈V having inverses φ, ψ, respectively, such that
Θ(φ, ψ), deﬁned by (3.126), is ﬁnite, for a suitable constant K. Theorem 3.89
below gives such an inequality when Φ and Ψ are convex.
A Love–Young inequality for sums
Recall that CV is the subclass of convex functions in V. We start with a
Love–Young inequality for Riemann–Stieltjes sums. Such sums are deﬁned for
functions over nondegenerate intervals [a, b], and so we assume that a < b.
Theorem 3.83. Assume (1.14). Let Φ, Ψ ∈CV with inverses φ, ψ, respec-
tively, and let f : [c, d] →X and h: [a, b] →Y . Then for any partition {ti}n
i=0
of [a, b], and for any s0 = c ≤s1 ≤· · · ≤sn = d and ν ∈{0, 1, . . ., n},

174
3 Φ-variation and p-variation

n
X
i=1
f(si)·

h(ti) −h(ti−1)

−f(sν)·

h(b) −h(a)

≤
∞
X
k=1
φ
vΦ(f; [c, d])
k

ψ
vΨ(h; [a, b])
k

.
(3.130)
Remark 3.84. The theorem will be applied when ti−1 ≤si ≤ti for i =
1, . . . , n and a = c < d ≤b, so that we have Riemann–Stieltjes sums, and
vΦ(f; [c, d]) ≤vΦ(f; [a, b]).
Proof. We can assume that c < d. Let κ := ({si}n
i=0, {ti}n
i=0). Let ∆if :=
f(si) −f(si−1) and ∆ih := h(ti) −h(ti−1) for i = 1, . . . , n. Also, let S(κ) :=
Pn
i=1 f(si)·∆ih. Then we have
S(κ) = f(c)·[h(b) −h(a)] +
X
1≤i≤j≤n
∆if·∆jh
(3.131)
because Pj
i=1 ∆if = f(sj) −f(c). On the other hand, since f(sj) = f(d) −
P
j<i≤n ∆if, we also have
S(κ) = f(d)·[h(b) −h(a)] −
X
1≤j<i≤n
∆if·∆jh.
(3.132)
Thus we have representations of the left side of (3.130) in the cases ν = 0 or
n. Now let ν ∈{1, . . . , n −1}. Then (3.131) for ({sj}n
j=ν, {tj}n
j=ν) gives
n
X
i=ν+1
f(si)·∆ih = f(sν)·[h(b) −h(tν)] +
X
ν<i≤j≤n
∆if·∆jh.
(3.133)
Also, (3.132) for ({si}ν
i=0, {ti}ν
i=0) gives
ν
X
i=1
f(si)·∆ih = f(sν)·[h(tν) −h(a)] −
X
1≤j<i≤ν
∆if·∆jh.
(3.134)
Adding (3.133) and (3.134) gives the representation
S(κ) −f(sν)·[h(b) −h(a)] = −
X
1≤j<i≤ν
∆if·∆jh +
X
ν<i≤j≤n
∆if·∆jh (3.135)
of the quantity we are aiming to bound. Therefore it is enough to bound the
norm of the right side of (3.135). To this aim we replace ∆if by an element
xi ∈X and ∆jh by an element yj ∈Y . Then, applying the following lemma,
the proof of the Love–Young inequality for sums will be complete.
2

3.6 Love–Young Inequalities
175
Let x = (x1, . . . , xn), xi ∈X, and y = (y1, . . . , yn), yi ∈Y . For Φ, Ψ ∈V,
let
vΦ(x) := max
n m
X
j=1
Φ

θ(j)
X
i=θ(j−1)+1
xi


: 1 ≤m ≤n
(3.136)
0 = θ(0) < θ(1) < · · · < θ(m) = n
o
,
and let vΨ(y) be deﬁned similarly. Then the following holds:
Lemma 3.85. As in Theorem 3.83, assume (1.14), and let Φ, Ψ ∈CV with
inverses φ, ψ, respectively. Then for any ﬁnite sequences x = (x1, . . . , xn),
xi ∈X, and y = (y1, . . . , yn), yi ∈Y , and for any integer ν ∈{0, . . ., n},
 −
X
1≤j<i≤ν
xi·yj +
X
ν<i≤j≤n
xi·yj
 ≤
∞
X
k=1
φ
vΦ(x)
k

ψ
vΨ(y)
k

.
(3.137)
Proof. Given two ordered m-tuples ξ = {ξ1, . . . , ξm} and η = {η1, . . . , ηm} of
elements of X and Y , respectively, and an integer r ∈{0, . . . , m}, let
SL(ξ, η; r) :=
X
0≤j<i≤r
ξi·ηj =
X
1≤j<i≤r
ξi·ηj,
SR(ξ, η; r, m) :=
X
r<i≤j≤m
ξi·ηj,
where η0 := 0, SL(ξ, η; 0) := 0 and SR(ξ, η; m, m) := 0. Also let
Um(ξ, η; r) := −SL(ξ, η; r) + SR(ξ, η; r, m).
We have to bound the norm of Un(x, y; ν). To this aim we replace a pair
(xl, xl+1) of elements in x by a single element xl + xl+1, and a pair (yl−1, yl)
of elements in y by a single element yl−1+yl, and show that for new sequences
x′, y′ both of length n −1, and a new ν′ equal to either ν or ν −1, the norm
of Un(x, y; ν) −Un−1(x′, y′; ν′) does not exceed the (n −1)st term of the right
side of (3.137) if ν ∈{1, . . . , n}, or the nth term if ν = 0. Repeating this
reduction recursively we will get the desired bound.
To begin, for any 1 ≤l ≤n, let y0 := xn+1 := 0 and let
x′
j := xj
for
1 ≤j ≤l −1,
x′
l := xl + xl+1, x′
j := xj+1
for
l < j < n,
y′
j := yj
for
0 ≤j < l −1, y′
l−1 := yl−1 + yl, y′
j := yj+1
for
l ≤j < n
(where xn+1 := 0 is used when l = n). Then x′ := (x′
1, . . . , x′
n−1) and
y′ := (y′
1, . . . , y′
n−1) are two sequences of elements of X and Y , respectively,
depending on l. If 1 ≤l < ν then SR(x′, y′; ν −1, n −1) = SR(x, y; ν, n) and

176
3 Φ-variation and p-variation
SL(x′, y′; ν −1)
=
X
0<i≤ν−1
x′
i·(y′
0 + · · · + y′
i−1) =
X
1<i<l
xi·(y1 + · · · + yi−1)
+ (xl + xl+1)·(y1 + · · · + yl) +
X
l<i≤ν−1
xi+1·(y1 + · · · + yi)
= xl·yl +
X
1<i≤ν
xi·(y1 + · · · + yi−1) = xl·yl + SL(x, y; ν).
If ν < l ≤n then SL(x′, y′; ν) = SL(x, y; ν) and
SR(x′, y′; ν, n −1)
=
X
ν<i≤n−1
x′
i·(y′
i + · · · + y′
n−1) =
X
ν<i<l
xi·(yi + · · · + yn)
+ (xl + xl+1)·(yl+1 + · · · + yn) +
X
l<i<n
xi+1·(yi+1 + · · · + yn)
= −xl·yl +
X
ν<i≤n
xi·(yi + · · · + yn) = −xl·yl + SR(x, y; ν, n).
Let ν′ := ν′(ν, l) := ν −1 if l < ν, and let ν′ := ν if l > ν. Then
Un(x, y; ν) −Un−1(x′, y′; ν′) = xl·yl
(3.138)
for l ∈{1, . . ., n} \ {ν} and ν ∈{0, . . . , n}. We choose a particular value of l
using the following fact:
Lemma 3.86. Let Φ, Ψ ∈CV with inverses φ, ψ, respectively. Given two or-
dered m-tuples u = {u1, . . . , um} and v = {v1, . . . , vm} of nonnegative real
numbers, there is an index r, 1 ≤r ≤m, such that
ur vr ≤φ
 1
m
m
X
j=1
Φ(uj)

ψ
 1
m
m
X
j=1
Ψ(vj)

.
(3.139)
Proof. Take the least r such that ur vr = min{uj vj : j = 1, . . . , m}. Using
the inequality between geometric and arithmetic means, we have
ur vr ≤
 m
Y
j=1
uj
1/m m
Y
j=1
vj
1/m
≤φ

Φ
 1
m
m
X
j=1
uj

ψ

Ψ
 1
m
m
X
j=1
vj

≤φ
 1
m
m
X
j=1
Φ(uj)

ψ
 1
m
m
X
j=1
Ψ(vj)

by convexity, proving the lemma.
2

3.6 Love–Young Inequalities
177
Now continuing the proof of Lemma 3.85, apply (3.139) to u = {∥xl∥: l ∈
{1, . . . , n} \ {ν}} and v = {∥yl∥: l ∈{1, . . . , n}\{ν}} with m = n−1 if ν ≥1
or to u = {∥xl∥}n
l=1 and v = {∥yl∥}n
l=1 with m = n if ν = 0. This gives an
index r ∈{1, . . . , n} \ {ν} such that ∥xr·yr∥≤Cn,ν(vΦ(x), vΨ(y)), where
Cm,ζ(s, t) :=

φ
 s/m

ψ
 t/m

if ζ = 0,
φ
 s/(m −1)

ψ
 t/(m −1)

if ζ ≥1,
(3.140)
for any s, t ≥0, m ∈{3, . . ., n}, and ζ ∈{0, . . . , n}. For l = r, let x(n−1) := x′,
y(n−1) := y′, and ν(n−1) := ν′. Then by (3.138)
Un(x, y; ν)
 ≤Cn,ν(vΦ(x), vΨ(y)) +
Un−1(x(n−1), y(n−1); ν(n−1))
.
Let ν(n)
:=
ν. Notice that ν(n−1) = 1 if ν = 1 and ν(n−1) = 0 if ν = 0.
Applying the same argument to x(n−1), y(n−1), and ν(n−1) instead of x, y,
and ν, one gets a similar inequality for the sum Un−1(x(n−1), y(n−1); ν(n−1))
in terms of a sum Un−2(x(n−2), y(n−2); ν(n−2)) of the same kind and a term
Cn−1,ν(n−1)(vΦ(x(n−1)), vΨ(y(n−1))). By the deﬁnitions, we have vΦ(x(n−1)) ≤
vΦ(x) and vΨ(y(n−1)) ≤vΨ(y). Proceeding in this way we obtain sums
Um(x(m), y(m); ν(m)) for m = n −1, . . . , 2 and the bound
Un(x, y; ν)
 ≤
n
X
j=3
Cj,ν(j)(vΦ(x), vΨ(y)) +
U2(x(2), y(2); ν(2))
.
(3.141)
To bound the last term consider two cases depending on whether ν = 0 or
ν ≥1. From the deﬁnition of ν′, we have ν(j) = 0 for all j if ν = 0, and
ν(j) ≥1 for all j ≥2 if ν ≥1. In the ﬁrst case, ν(2) = 0. Then applying the
preceding argument again we obtain for l ∈{1, 2},
U1((x(2))′, (y(2))′; (ν(2))′) = SR((x(2))′, (y(2))′; 0, 1) = (x(2))′
1·(y(2))′
1
and by (3.138),
U2(x(2), y(2); ν(2)) −U1((x(2))′, (y(2))′; (ν(2))′) = x(2)
l
·y(2)
l
.
Thus applying (3.139) for l = r ∈{1, 2}, we get the bound
U2(x(2), y(2); ν(2))
 ≤φ
vΦ(x)
2

ψ
vΨ(y)
2

+ φ
 vΦ(x)

ψ
 vΨ(y)

.
In the second case,
U2(x(2), y(2); ν(2)) =
(
−SL(x(2), y(2); 2) = −x(2)
2 ·y(2)
1
if ν(2) = 2,
SR(x(2), y(2); 1, 2) = x(2)
2 ·y(2)
2
if ν(2) = 1.
Then the bound

178
3 Φ-variation and p-variation
U2(x(2), y(2); ν(2))
 ≤φ
 vΦ(x)

ψ
 vΨ(y)

holds. Inserting these bounds and (3.140) into (3.141) we obtain the desired
inequality (3.137).
2
So, the proof of Theorem 3.83 (a Love–Young inequality for sums) is com-
pleted. The following corollary of it will be used later on.
Corollary 3.87. Assume (1.14). Let f ∈Wq([a, b]; X) and h ∈Wp([a, b]; Y )
with 1 ≤p, q < ∞, p−1 +q−1 > 1. For any tagged partition τ of [a, b] and any
s ∈[a, b], we have
SRS(f, dh; τ) −f(s)·[h(b) −h(a)]
 ≤Kp,q∥f∥(q)∥h∥(p),
(3.142)
where Kp,q = 1 + ζ(p−1 + q−1), and Kp,q = ζ(p−1 + q−1) if in addition, s is
a tag of τ. Moreover, we have
SRS(f, dh; τ)
 ≤ζ(p−1 + q−1)∥f∥[q]∥h∥(p).
(3.143)
Proof. Since (3.143) is a simple consequence of (3.142) we prove only (3.142).
We use Theorem 3.83 with Φ(u) ≡uq, Ψ(u) ≡up, u ≥0, 1 ≤p, q < ∞, and
p−1 + q−1 > 1. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition of [a, b], let
s ∈[a, b], and let s0 := a. Then by (3.130) with a = c < d = b and ν = 0, we
have
∥SRS(f, dh; τ) −f(s)·[h(b) −h(a)]∥
≤∥SRS(f, dh; τ) −f(s0)·[h(b) −h(a)]∥+ ∥f(s0) −f(s)∥∥h(b) −h(a)∥
≤ζ(p−1 + q−1)∥f∥(q)∥h∥(p) + ∥f∥(q)∥h∥(p)
and the ﬁrst conclusion holds. If s ∈{si}n
i=1 then (3.142) with Kp,q = ζ(p−1 +
q−1) follows from (3.130) alone, proving the corollary.
2
Next is a Love–Young inequality for Kolmogorov sums deﬁned by (2.22)
and approximating the Kolmogorov integral.
Proposition 3.88. Assume (1.14). Let Φ, Ψ ∈CV with inverses φ, ψ, re-
spectively. For a nonempty interval J, let f ∈WΦ(J; X) and µ ∈AIΨ(J; Y ).
Then for any tagged Young interval partition T of J and any tag s ∈J of T ,
SYS(f, dµ; J, T ) −f(s)·µ(J)
 ≤
∞
X
k=1
φ
vΦ(f; J)
k

ψ
vΨ(µ; J)
k

.
(3.144)
Proof. We can assume that J is nondegenerate. First suppose that J = [[a, b]]
for some −∞< a < b < ∞. Let T be a tagged Young interval partition
of J, let s be a tag of T , and let h := Rµ,a be the function deﬁned by

3.6 Love–Young Inequalities
179
(2.3) corresponding to the interval function µ. Given ǫ > 0, since µ is upper
continuous, by Lemma 2.24, one can ﬁnd an interval [c, d] ⊂J and a tagged
partition τ of [c, d] such that s is a tag of τ and the norm of the diﬀerence

SYS(f, dµ; J, T ) −f(s)·µ(J)

−

SRS(f, dh; τ) −f(s)·[h(d) −h(c)]

is less than ǫ. By Theorem 3.83, it then follows that
SYS(f, dµ; J, T ) −f(s)·µ(J)
 ≤ǫ +
∞
X
k=1
φ
vΦ(f; [c, d])
k

ψ
vΨ(h; [c, d])
k

.
By Proposition 3.31(a), vΨ(h; [c, d]) ≤vΨ(µ; [c, d]) ≤vΨ(µ). Since ǫ > 0 is
arbitrary, the conclusion follows if J is a ﬁnite interval.
Let J = R, let T = ({(ti−1, ti)}n
i=1, {si}n
i=1) be a tagged Young interval
partition of J, let s be a tag of T , and let ǫ > 0. If Osc(f) = 0 there is
no problem, so assume Osc(f) > 0. Since µ is upper continuous, there are
u, v ∈R such that
max

∥µ∥(−∞,u],sup, ∥µ∥[v,∞),sup
	
≤ǫ/Osc(f).
Let a := s1 −1 if s1 ≤u and a := u otherwise. Also let b := sn + 1 if sn ≥v
and b := v otherwise. Let T ′ be the tagged Young interval partition of (a, b)
obtained from T by replacing the interval (−∞, t1) with (a, t1) and replacing
the interval (tn−1, ∞) with (tn−1, b). Then s ∈(a, b), s is a tag of T ′, and
SYS(f, dµ; J, T ) −f(s)·µ(J)
= SYS(f, dµ; (a, b), T ′) −f(s)·µ((a, b))
+ [f(s1) −f(s)]·µ((−∞, a]) + [f(sn) −f(s)]·µ([b, ∞)).
The sum of the norms of the last two terms on the right is less than 2ǫ by
the choice of u and v. Applying the bound obtained in the ﬁrst part of the
proof to the ﬁrst diﬀerence on the right, the conclusion of the proposition
follows again since ǫ > 0 is arbitrary. The case when J is a half-line can be
treated similarly and therefore is omitted. The proof of the proposition is now
complete.
2
Love–Young inequalities for the full Stieltjes integral
Next is a Love–Young inequality, named for the special case (3.129), for the
full Stieltjes integral deﬁned by Deﬁnition 2.41. Recall the deﬁnition (3.126)
of Θ(φ, ψ).
Theorem 3.89. Assume (1.14). Let Φ, Ψ ∈CV with inverses φ, ψ, respec-
tively, and let f ∈WΦ([a, b]; X) and h ∈WΨ([a, b]; Y ). If Θ(φ, ψ) < ∞then
the full Stieltjes integral (S) ∫b
a f·dh exists and the inequality

180
3 Φ-variation and p-variation
(S)
Z b
a
[f −f(s)]·dh
 ≤
∞
X
k=1
φ
vΦ(f)
k

ψ
vΨ(h)
k

(3.145)
holds for any s ∈[a, b].
Proof. We can assume that a < b. The full Stieltjes integral (S) ∫b
a f·dh ex-
ists by Corollary 3.82. Let s ∈[a, b]. If (S) ∫b
a f·dh = (RRS) ∫b
a f·dh then
(3.145) follows from (3.130) with a = c < d ≤b, approximating the inte-
gral by Riemann–Stieltjes sums. Otherwise (S) ∫b
a f·dh = (RYS) ∫b
a f·dh and
(3.145) again follows from (3.130) because by Proposition 2.18, each Young–
Stieltjes sum including a tag s = sν can be approximated arbitrarily closely
by Riemann–Stieltjes sums also including a tag s. This completes the proof
of the theorem.
2
Corollary 3.90. Assume (1.14). Let Φ, Ψ ∈CV, and let f ∈f
WΦ([a, b]; X),
h ∈
f
WΨ([a, b]; Y ). If Θ(Φ−1, Ψ −1) < ∞then the full Stieltjes integral
(S) ∫b
a f·dh exists and the inequality
(S)
Z b
a
f·dh
 ≤K∥f∥[Φ]∥h∥(Ψ)
(3.146)
holds with the constant K := max{Ψ −1(1), Θ(Φ−1, Ψ −1)}.
Proof. The existence of (S) ∫b
a f·dh follows from Theorem 3.89. It is enough
to prove (3.146) for a < b. Due to bilinearity of the full Stieltjes integral
(Theorem 2.72), we can assume ∥f∥(Φ) = ∥h∥(Ψ) = 1. Then by (3.9) we have
vΦ(f) ≤1 and vΨ(h) ≤1. Thus ∥h(b) −h(a)∥≤Ψ −1(1) by the second part of
Theorem 3.7(b), and (3.146) follows from (3.145).
2
The following is the special case of Theorem 3.89 and Corollary 3.90 when
Ψ(v) ≡vp and Φ(u) ≡uq with p ≥1, q ≥1, and p−1 + q−1 > 1. Recall the
Riemann zeta function ζ(r) = P∞
n=1 n−r for r > 1.
Corollary 3.91. Assume (1.14). Let f ∈Wq([a, b]; X) and h ∈Wp([a, b]; Y )
for p ≥1, q ≥1, and p−1+q−1 > 1. Then the full Stieltjes integral (S)
R b
a f·dh
exists and we have the inequalities
(S)
Z b
a
[f −f(s)]·dh
 ≤Kp,q∥f∥(q)∥h∥(p)
(3.147)
for any s ∈[a, b], where Kp,q := ζ(p−1 + q−1), and
(S)
Z b
a
f·dh
 ≤Kp,q∥f∥[q]∥h∥(p).
(3.148)

3.6 Love–Young Inequalities
181
The next theorem extends Corollary 3.91 to the indeﬁnite integral IS(f, dh)
deﬁned by
IS(f, dh)(x) := (S)
Z x
a
f·dh,
x ∈[a, b].
Theorem 3.92. Assume (1.14). Let f ∈Wq([a, b]; X) and h ∈Wp([a, b]; Y )
for p ≥1, q ≥1, and p−1 + q−1 > 1. Then the indeﬁnite integral IS(f, dh)
exists, has bounded p-variation, and satisﬁes
IS(f, dh)

(p) ≤Kp,q∥f∥[q]∥h∥(p),
where Kp,q := ζ(p−1 + q−1).
Proof. We can assume that a < b. The indeﬁnite integral IS(f, dh) exists by
Corollary 3.91. Let κ = {ti}n
i=0 be a partition of [a, b] and K := Kp,q. Then
by additivity of the full Stieltjes integral (Theorem 2.73), by (3.148), and
iterating (3.51), we have
sp(IS(f, dh); κ) =
n
X
i=1
(S)
Z ti
ti−1
f·dh

p
≤Kp∥f∥p
[q]
n
X
i=1
vp(h; [ti−1, ti]) ≤Kp∥f∥p
[q]∥h∥p
(p).
Taking the supremum over κ and pth roots, the proof of the theorem is com-
plete.
2
Love–Young inequalities for the Kolmogorov integral
Recall that the Kolmogorov integral was deﬁned in Section 2.3, and that
AIΦ(J; Y ), Φ ∈V, is the set of all additive upper continuous interval functions
of bounded Φ-variation on a nonempty interval J having values in the Banach
space Y (Deﬁnition 3.16).
Theorem 3.93. Assume (1.14). Let Φ, Ψ ∈CV with inverses φ, ψ, respec-
tively, be such that Θ(φ, ψ) < ∞. For a nonempty interval J, let f ∈WΦ(J; X)
and µ ∈AIΨ(J; Y ). Then the Kolmogorov integral
R
=J f·dµ exists and the in-
equality

R
=
J
[f −f(s)]·dµ
 ≤
∞
X
k=1
φ
vΦ(f; J)
k

ψ
vΨ(µ; J)
k

(3.149)
holds for any s ∈J.
To prove the theorem we use the following:

182
3 Φ-variation and p-variation
Lemma 3.94. Let Φ, Ψ ∈CV with inverses φ, ψ, respectively, be such that
Θ(φ, ψ) < ∞. For any A, B ∈(0, 1/2], we have
∞
X
k=1
φ
A
k

ψ
B
k

≤4Θ(φ, ψ) max{A, B}.
Proof. We have
∞> Θ(φ, ψ) =
∞
X
i=1
2i−1
X
k=2i−1
φ
1
k

ψ
1
k

≥
∞
X
i=1
2i−1φ(2−i)ψ(2−i).
Take the integer m ≥1 such that 2−m−1 < max{A, B} ≤2−m. Then using
the preceding lower bound for Θ(φ, ψ), it follows that
∞
X
k=1
φ
A
k

ψ
B
k

=
∞
X
i=0
2i+1−1
X
k=2i
φ
A
k

ψ
B
k

≤
1
2m
∞
X
i=0
2i+mφ

1
2i+m

ψ

1
2i+m

≤4Θ(φ, ψ) max{A, B},
proving the lemma.
2
Proof of Theorem 3.93. We can assume that J is nondegenerate. First
suppose that J = [[a, b]] for some −∞< a < b < ∞. Let h := Rµ,a
be deﬁned by (2.3), and let ˜h, ˜f be deﬁned by (2.23). Then vΨ(˜h; [a, b]) =
vΨ(h; J) ≤vΨ(µ; J) < ∞by Proposition 3.31(a). Also, we have vΦ( ˜f; [a, b]) ≤
2Φ(∥f∥sup) + vΦ(f; J) < ∞. Then the integral (RYS) ∫b
a ˜f·d˜h exists by Corol-
lary 3.82, and so the Kolmogorov integral
R
=J f·dµ exists by Corollary 2.26.
Let s ∈J. Then (3.149) follows by the Love–Young inequality (3.144) because
one can approximate the Kolmogorov integral
R
=J f·dµ arbitrarily closely by
Kolmogorov sums SYS(f, dµ; J, T ) based on T having s as a tag.
Now let J = R and ǫ ∈(0, 2Θ(φ, ψ)]. Using Propositions 3.42 and 3.50,
choose a, b ∈R such that a < b and
4Θ(φ, ψ) max{vΦ(f; A), vΨ(µ; A)} ≤ǫ
holds when A = (−∞, a) or A = (b, ∞). By Lemma 3.94, we then have for
each such A,
∞
X
k=1
φ
vΦ(f; A)
k

ψ
vΨ(µ; A)
k

≤ǫ.
By the ﬁrst part of the proof, there is a tagged Young interval partition (A, ξ)
of [a, b] such that for any tagged reﬁnement B of A,

3.6 Love–Young Inequalities
183
∥SYS(f, dµ; [a, b], (A, ξ)) −SYS(f, dµ; [a, b], B)∥≤ǫ.
Let T0 be a tagged Young interval partition A0 := {(−∞, a), A, (b, ∞)} with
tags s ∈(−∞, a), ξ, and t ∈(b, ∞), and let T be a tagged Young interval
partition of J which is a reﬁnement of A0. Let Tk, k = 1, 2, 3, be the restriction
of T to (−∞, a), [a, b], and (b, ∞), respectively. Then by the Love–Young
inequality (3.144) for Kolmogorov sums over the intervals (−∞, a) and (b, ∞),
it follows that
∥SYS(f, dµ; J, T ) −SYS(f, dµ; J, T0)∥
≤∥SYS(f, dµ; (−∞, a), T1) −f(s)·µ((−∞, a))∥
+∥SYS(f, dµ; [a, b], T2) −SYS(f, dµ; [a, b], (A, ξ))∥
+∥SYS(f, dµ; (b, ∞), T3) −f(t)·µ((b, ∞))∥≤3ǫ.
Thus the Kolmogorov integral
R
=J f·dµ exists by the Cauchy test. Now (3.149)
for any s ∈J follows by the same Love–Young inequality (3.144) because
one can approximate the Kolmogorov integral
R
=J f·dµ arbitrarily closely by
Kolmogorov sums SYS(f, dµ; J, U) based on U having s as a tag. The case
when J is a half-line can be treated similarly and therefore is omitted. The
proof of Theorem 3.93 is complete.
2
The following is the special case of Theorem 3.93 when Ψ(v) ≡vp and
Φ(u) ≡uq with p ≥1, q ≥1 and p−1 + q−1 > 1.
Corollary 3.95. Assume (1.14). For p ≥1 and q ≥1 such that p−1+q−1 > 1
and for a nonempty interval J, let µ ∈AIp(J; Y ) and f ∈Wq(J; X). Then
the Kolmogorov integral
R
=J f·dµ exists. Moreover, for any nonempty interval
A ⊂J and any s ∈A,

R
=
A
[f −f(s)]·dµ
 ≤Kp,q∥f∥A,(q)∥µ∥A,(p),
(3.150)
where Kp,q := ζ(p−1 + q−1), and

R
=
A
f·dµ
 ≤Kp,q∥f∥A,[q]∥µ∥A,(p).
(3.151)
By Theorem 2.21, if the Kolmogorov integral R=J f·dµ exists on a nonempty
interval J, then
R
= f·dµ :=

A 7→
R
=
A
f·dµ: A ∈I(J)

(3.152)
is an additive interval function on J. Next we show that it is upper continuous
and has bounded p-variation under suitable conditions. For 1 ≤p < ∞, let
Qp := [1, p/(p−1)) if p > 1, and Q1 := {+∞}. To include the case q = ∞, we
write W∞(J; X) for the class of all regulated X-valued functions on J, and
∥· ∥A,[∞] := ∥· ∥A,sup for nonempty A ∈I(J).

184
3 Φ-variation and p-variation
Proposition 3.96. Assume (1.14). For a nonempty interval J, let µ ∈
AIp(J; Y ) for 1 ≤p < ∞, and f ∈Wq(J; X) for q ∈Qp. Then
R
= f·dµ
is an additive upper continuous interval function on J of bounded p-variation,
and for each nonempty A ∈I(J),
 R= f·dµ

A,(p) ≤Kp,q∥f∥A,[q]∥µ∥A,(p),
(3.153)
where Kp,q := ζ(p−1 + q−1) if p > 1, and Kp,q := 1 if p = 1.
Proof. We can assume that A ⊂J is a nondegenerate interval. The result
holds clearly if f ≡0, so we can assume that ∥f∥sup > 0. First let p = 1. If
J = [a, b] then the integral
R
=J f·dµ is deﬁned by Theorem 2.20 and Corollary
2.26. Let J = (a, b) and ǫ > 0. By Proposition 3.50, there are c, d ∈(a, b) such
that c < d and
v1(µ; (a, c]) + v1(µ; [d, b)) ≤ǫ/∥f∥sup.
Since the integral is deﬁned over [c, d] by the preceding references, there is an
interval partition A of (a, b) such that the norm of any diﬀerence between two
Kolmogorov sums based on tagged reﬁnements of A is less than 2ǫ. So the
integral
R
=J f·dµ is deﬁned by the Cauchy test. The case when J is half-open
can be treated similarly and therefore is omitted. Thus the interval function
(3.152) is deﬁned on J and is additive by the second part of Theorem 2.21.
By Proposition 2.22 it is upper continuous. Applying the triangle inequality
to Kolmogorov sums, we get
 R
=
A
f·dµ
 ≤∥f∥A,sup∥µ∥A,(1),
(3.154)
which also holds if A is a singleton {x} ⊂J. To prove (3.153), let A = {Ai}n
i=1
be a Young interval partition of A. Then by (3.154) and (3.69), we have
s1(
R
= f·dµ; A) ≤∥f∥A,sup
n
X
i=1
v1(µ; Ai) ≤∥f∥A,sup∥µ∥A,(1).
This together with Lemma 3.53 implies (3.153) with p = 1. If p > 1 the proof
is the same except that now the integral
R
=J f·dµ exists by the preceding
corollary, and (3.151) is used instead of (3.154). The proof of the proposition
is complete.
2
Optimality of Love–Young inequalities
Recall that CV is the class of all continuous increasing convex functions
Φ: [0, ∞) →[0, ∞) such that Φ(0) = 0 and Φ(u) > 0 for u > 0. In Sec-
tion *3.4, necessary and suﬃcient conditions were given for Φ and Ψ in CV to
be a Stieltjes pair. The conditions were rather complex. One may ask whether
in the special case Φ(u) ≡up, u ≥0, for 1 < p < ∞, simpler conditions could

3.6 Love–Young Inequalities
185
be found. If Ψ(u) ≡uq for u ≥0 and 1 < q < ∞also, then we know that
(Φ, Ψ) form a Stieltjes pair if p−1 + q−1 > 1. They do not if p−1 + q−1 = 1. In
fact, Proposition 3.104 will show that for any p, q > 1 with p−1+q−1 = 1 there
exist f ∈W∗
p[0, 1] ∩H1/p[0, 1] and g ∈W∗
q [0, 1] ∩H1/q[0, 1] such that
R 1
0 fdg
does not exist in any of the senses we have been considering. On the other
hand, there are some necessity results giving g ∈Wq under some conditions,
e.g. Corollary 3.109. Thus one might ask whether there is some Ψ ∈CV not of
the form uq, perhaps uq times some logarithmic factors, giving a Love–Young
inequality as in (3.149) provided that (RYS)
R
fdh exists for all f ∈Wp. The
next proposition shows that for some such h there is no such Ψ.
Also, we write ξ(u) ∼η(u) as u ↓0 or u ↑∞if ξ(u)/η(u) →1 as u ↓0 or
u ↑∞, respectively.
Proposition 3.97. Let 1 < p, q < ∞, p−1 + q−1 = 1. There is a right-
continuous function h ∈W∗
q [0, 1] such that h(0) = 0 and (RYS) ∫1
0 f dh exists
for each f ∈Wp[0, 1], but there is no function Ψ ∈CV such that
h ∈WΨ[0, 1]
and
∞
X
n=1
n−1/pΨ −1(1/n) < ∞.
(3.155)
Remark 3.98. With Φ(u) ≡up for u ≥0, P∞
n=1 n−1/pΨ −1(1/n) = Θ(Φ, Ψ).
By Proposition 3.81 and Theorem 3.78, Θ(Φ, Ψ) < ∞is a suﬃcient condition
for Φ, Ψ to be a Stieltjes pair. The condition is not necessary by Example 3.80.
Proof. Let ξq(u) := uq ln(1/u)3/2 for 0 < u ≤e−2 and ξq(0) := 0. Then
one can check that ξq has a derivative ξ′
q on (0, e−2) which extends to be
continuous and strictly positive on (0, e−2]. Deﬁne ξq for e−2 < u < +∞so
that it is linear there, and C1 and strictly increasing on (0, ∞), namely,
ξq(u) := ξq(e−2) + ξ′
q(e−2−)(u −e−2),
u > e−2.
Let ξ−1
q
be the inverse function of ξq. Then ξ−1
q (u) ∼(u/[ln(1/u)]3/2)1/q as
u ↓0. Let h be the function on [0, 1] with value ξ−1
q (1/k) on the interval
[1/(2k + 1), 1/(2k)), k = 1, 2, . . . , and 0 elsewhere. Then {ξ−1
q (1/k): k ≥
1} ∈ℓq and h ∈W∗
q [0, 1] by Proposition 3.60(c) since vq(h; [0, ǫ]) ≤
2 P
2k+1≥1/ǫ 1/[k(ln k)3/2] →0 as ǫ ↓0. Clearly, h is right-continuous. Also,
the following holds for the local q-variation:
v∗
q(h; [0, 1]) =
X
(0,1)
|∆−h|q =
∞
X
k=1
2

ξ−1
q (1/k)
q ≤C
∞
X
k=1
1/

k(ln k)3/2
< ∞
for some C < ∞. To prove the existence of (RYS) ∫b
a f dh, let f ∈Wp[0, 1]. For
m ≥1, let {xi}n
i=0 be a reﬁnement of the partition {0, {(2k+1)−1, (2k)−1 : k =
1, . . . , m}, 1} of [0, 1], and let i(m) ∈{1, . . . , n−2} be such that 0 = x0 < x1 <
· · · < xi(m) = (2m+1)−1. For a tagged Young partition τ = ({xi}n
i=0, {yi}n
i=1),

186
3 Φ-variation and p-variation
a sum of some of the terms of the Young–Stieltjes sum SYS(f, dh; τ) deﬁned
by (2.16) is
Um,τ :=
n−1
X
i=i(m)
n
[f∆±h](xi) + f(yi+1)[h(xi+1−) −h(xi+)]
o
.
For i ≥i(m), ∆±h(xi) = ∆−h(xi) = ξ−1
q (1/k) if xi = 1/(2k + 1), or
−ξ−1
q (1/k) if xi = 1/(2k), both for k = 1, . . . , m, and ∆±h(xi) = 0 other-
wise. We also have h(xi+1−) −h(xi+) ≡0 because h is constant on the open
interval (xi, xi+1), which is either included in some [(2k+1)−1, (2k)−1) or else
h ≡0 on the interval. Thus
Um,τ =
m
X
k=1
ξ−1
q (1/k)

f(1/(2k + 1)) −f(1/(2k))

.
Since [f∆+h](0) = [f∆−h](1) = 0, the sum of the remaining terms of
SYS(f, dh; τ) is
Vm,τ :=
i(m)
X
i=1
f(yi)

h(xi−) −h(xi−1+)

+
i(m)−1
X
i=1
f(xi)

h(xi+) −h(xi−)

.
We can assume that in Vm,τ, for each k > m, xi ∈((2k + 1)−1, (2k)−1) for
at most one value of i. Indeed, if xi−1 ≤(2k + 1)−1 < xi < · · · < xi+l <
(2k)−1 ≤xi+l+1 for some l ≥1, then ∆±h(xj) = 0 for j = i, . . . , i + l and
h(xj−) −h(xj−1+) = 0 for j = i + 1, . . . , i + l. Thus we can replace the
summands for j = i + 1, . . . , i + l by f(yi+l+1)[h(xi+l+1) −h(xi)], preserving
the value of the sum Vm,τ. Then we have, recalling that h is right-continuous,
Vm,τ =
i(m)−1
X
i=1
h(xi)

f(xi) −f(yi+1)

+
i(m)−1
X
i=1
h(xi−)

f(yi) −f(xi)

+ f(yi(m))

h(xi(m)−) −h(xi(m)−1)

,
(3.156)
and Vm,τ →0 as m →∞uniformly for all xi ≤(2m + 1)−1. Indeed, the last
single term tends to 0 as m →∞because f is bounded and h(x) →0 as
x ↓0. By deﬁnition of h, we have the bound
max
n X
i<i(m)
|h(xi)|q,
X
i<i(m)
|h(xi−)|qo
≤2
X
k>m

ξ−1
q (1/k)
q,
and for f we have
max
n X
i<i(m)
|f(xi) −f(yi+1)|p,
X
i<i(m)
|f(yi) −f(xi)|po
≤vp(f; [0, 1]) < ∞.

3.6 Love–Young Inequalities
187
Thus one can apply H¨older’s inequality (1.4) to show that the two sums in
(3.156) tend to 0 as m →∞uniformly for all xi ≤(2m + 1)−1. Therefore f
is RYS integrable with respect to h over [0, 1], and
(RYS)
Z 1
0
f dh =
∞
X
k=1
ξ−1
q (1/k)

f(1/(2k + 1)) −f(1/(2k))

,
where the sum converges absolutely.
Suppose that there is a Ψ ∈CV such that (3.155) holds. Since h ∈WΨ[0, 1],
we have
∞>
∞
X
k=1
Ψ◦ξ−1
q (1/k)
≥
∞
X
i=1
2−icard

k ≥1: 2−i ≤Ψ◦ξ−1
q (1/k) < 21−i	
.
(3.157)
For each i ≥0, let Ni := card{k ≥1: Ψ◦ξ−1
q (1/k) ≥2−i}. Then for i large
enough so that Ni ≥1, we have 1/(Ni + 1) < ξq◦Ψ −1(2−i) ≤1/Ni. Thus
letting Mi := 1/Ψ −1(2−i) for i = 1, 2, . . . , it follows that Ni is asymptotic to
1/ξq◦Ψ −1(2−i) = M q
i / ln(Mi)3/2 as i ↑∞. Moreover, by (3.157), we have
∞>
∞
X
i=1
2−i Ni −Ni−1) ≥−N0/2 +
∞
X
i=1
2−1−iNi.
Hence P∞
i=1 Ai < ∞with Ai := M q
i /[2i ln(Mi)3/2]. On the other hand, using
convergence of the series in (3.155) and Proposition 3.81(i)(b), we get that
P∞
i=1 Bi < ∞with Bi := 2i/q/Mi. There is a ﬁnite i0 such that Mi ≥e for
i ≥i0. Since q > 1, it follows that
M :=
∞
X
i=i0

ln(Mi)
−3/4 ≤
∞
X
i=i0

ln(Mi)
−3/[2(q+1)]
=
∞
X
i=i0
A1/(q+1)
i
Bq/(q+1)
i
< ∞
by H¨older’s inequality (1.4). Hence Mi ≥exp{((i −i0)/M)4/3} for i > i0.
Thus
lim sup
i→∞
2i ln(Mi)3/2/M q
i
≤lim sup
i→∞
2i/Mi = 0.
So Ai →∞as i →∞, and the series P
i Ai diverges, a contradiction.
2
Note: if right (or left) continuity is omitted from Proposition 3.97 then the
examples of Proposition 3.108 would apply, making the statement less inter-
esting.
Next is a formulation of Proposition 3.97 for interval function integrators
µ rather than point functions h.

188
3 Φ-variation and p-variation
Corollary 3.99. Let 1 < p, q < ∞, p−1 + q−1 = 1. There is an interval
function µ ∈AI∗
q[0, 1] such that
R
=[0,1] f dµ exists for each f ∈Wp[0, 1], but
there is no function Ψ ∈CV such that
µ ∈AIΨ[0, 1]
and
∞
X
n=1
n−1/pΨ −1(1/n) < ∞.
Proof. Let µ be the interval function µh on [0, 1] deﬁned by (2.2) with
h: [0, 1] →R from the conclusion of Proposition 3.97. Then µ is non-zero, ad-
ditive, and upper continuous by Theorem 2.8(c) with h ∈R[0, 1] and h(0) = 0.
Moreover, µ ∈AI∗
q[0, 1] by Lemma 3.29 and Propositions 3.60 and 3.30, us-
ing right-continuity of h. Thus by Corollary 2.26, R=[0,1] f dµ = (RYS) ∫1
0 f dh
exists for each f ∈Wp[0, 1]. By Proposition 3.30 once again, the Φ-variation
of µ is bounded or not depending on whether the Φ-variation of h is bounded
or not. The conclusion then follows from Proposition 3.97.
2
Substitution rules
An equality between integrals ∫f d(∫g dν) and ∫fg dν, if it holds under some
conditions, is often called a substitution rule. We start with one such rule for
the reﬁnement Riemann–Stieltjes integral.
Proposition 3.100. Let h ∈Wp[a, b] and f, g ∈Wq[a, b] for some p ≥1,
q ≥1 with p−1 + q−1 > 1. Suppose that the pairs (h, g) and (h, f) have no
common one-sided discontinuities on [a, b]. Then g and fg are RRS integrable
with respect to h, f is RRS integrable with respect to the indeﬁnite RRS
integral IRRS(g, dh)(y) := (RRS) ∫y
a g dh, y ∈[a, b], and
(RRS)
Z b
a
f dIRRS(g, dh) = (RRS)
Z b
a
fg dh .
(3.158)
Proof. We can assume that a < b. The RRS integrability of g and fg with
respect to h follows from Corollary 3.91 because fg ∈Wq by Corollary 3.9.
The indeﬁnite integral I(g, dh) := IRRS(g, dh) is in Wp by Theorem 3.92. The
functions f and I(g, dh) have no common discontinuities on the same side at
the same point by Theorem 2.75. Hence f is RRS integrable with respect to
I(g, dh) by Corollary 3.91. To prove (3.158) let τ = ({xi}n
i=0, {yi}n
i=1) be a
tagged partition of [a, b]. Let Ji := [xi−1, xi] for i = 1, . . . , n. Since the RRS
integral is additive for adjacent intervals by Theorem 2.73, we have
n
X
i=1
f(yi)

I(g, dh)(xi) −I(g, dh)(xi−1)

=
n
X
i=1
f(yi)g(yi)

h(xi) −h(xi−1)

+
n
X
i=1
f(yi)(RRS)
Z xi
xi−1
[g −g(yi)] dh.
(3.159)

3.6 Love–Young Inequalities
189
Let p1 > p and q1 > q be such that p−1
1
+ q−1
1
> 1. By Lemma 3.45, h ∈
Wp1[a, b] and g ∈Wq1[a, b]. Then by the Love–Young inequality (3.147) it
follows that for a ﬁnite constant K = Kp1,q1,
n
X
i=1
|f(yi)|
(RRS)
Z xi
xi−1
[g −g(yi)] dh
 ≤K∥f∥sup
n
X
i=1
∥h∥Ji,(p1)∥g∥Ji,(q1)
≤
max
1≤i≤n

(Osc(h; Ji))(p1−p)/p1 ∧(Osc(g; Ji))(q1−q)/q1
× K∥f∥sup

Osc(h)(p1−p)/p1 ∨Osc(g)(q1−q)/q1
∥h∥p/p1
(p) ∥g∥q/q1
(q) .
(3.160)
The last inequality follows by applying ﬁrst (3.65), then writing a product
AB as (A ∧B)(A ∨B), using H¨older’s inequality (1.4), and ﬁnally iterating
(3.51). By Theorem 2.1(b), given any ǫ > 0, there is a partition {uj}m
j=0
of [a, b] such that Osc(g; (uj−1, uj)) < ǫ and Osc(h; (uj−1, uj)) < ǫ for each
j = 1, . . . , m. For j = 1, . . . , m take any vj ∈(uj−1, uj). Let n = 2m and
{xi}n
i=0 = {uj}m
j=0 ∪{vj}m
j=1. Then for each i = 1, . . . , n,
min(Osc(g; [xi−1, xi]), Osc(h; [xi−1, xi])) < ǫ,
since one endpoint of [xi−1, xi] is in the interior of an interval (uj−1, uj),
and at the other, at least one of the two functions g and h is continuous
from the side within [xi−1, xi]. It follows that one can make the right side
of (3.160) arbitrarily small by choosing an appropriate τ, and the same will
hold for any reﬁnement of τ. Thus taking the limit on both sides of (3.159)
under reﬁnements of τ, the relation (3.158) follows. This concludes the proof
of Proposition 3.100.
2
The next substitution rule, for the Riemann–Stieltjes integral, extends
Proposition 2.86 (in which p = 1) to functions having bounded p-variation
with p > 1. Recall that Qp = [1, p/(p −1)) if p > 1, Q1 = {+∞} and
W∞(J; X) = R(J; X), the class of all X-valued regulated functions deﬁned
on J.
Proposition 3.101. For a Banach space X, 1 ≤p < ∞, and q ∈Qp let
h ∈Wp[a, b], g ∈Wq([a, b]; X), and f ∈Wq[a, b] be such that the two pairs
(h, g) and (h, f) have no common discontinuities, and gf : [a, b] →X is the
function deﬁned by pointwise multiplication. Then the following Riemann–
Stieltjes integrals (including those in integrands) are deﬁned and
(RS)
Z b
a
dIRS(g, dh)·f = (RS)
Z b
a
gf·dh = (RS)
Z b
a
g·dIRS(dh, f), (3.161)
where IRS(g, dh)(t) := (RS)
R t
a g·dh ∈X and IRS(dh, f)(t) := (RS)
R t
a f dh
for t ∈[a, b], and · denotes the natural bilinear mapping X × R →X.

190
3 Φ-variation and p-variation
Proof. We can assume that a < b and p > 1. Since the pairs (g, h) and
(f, h) have no common discontinuities, the indeﬁnite integrals IRS(g, dh) and
IRS(dh, f) exist and are in Wp([a, b]; X) and Wp[a, b], respectively, by The-
orems 3.92 and 2.42. The discontinuities of IRS(g, dh) and IRS(dh, f) are
subsets of those of h by Theorem 2.75, and so the pairs (IRS(g, dh), f) and
(g, IRS(dh, f)) have no common discontinuities. Thus the leftmost and right-
most deﬁnite integrals in (3.161) exist by Corollary 3.91 and again by Theorem
2.42. Since gf ∈Wq([a, b]; X) by Theorem 3.8 with k = 2 and the functions
gf and h have no common discontinuities, the middle integral in (3.161) ex-
ists for the same reasons as the other two integrals. We will prove only the
ﬁrst equality in (3.161) since a proof of the second one is symmetric. Let
τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition of [a, b]. Then
SRS(dIRS(g, dh), f; τ) −SRS(gf, dh; τ)∥≤∥f∥supR(τ),
where
R(τ) :=
n
X
i=1
(RS)
Z ti
ti−1
g·dh −g(si)·

h(ti) −h(ti−1)
.
As in the proof of Proposition 3.100, by the Love–Young inequality (3.147)
with p1 > p and q1 > q such that p−1
1
+ q−1
1
> 1, and with the ﬁnite constant
K = Kp1,q1, we have the bound
R(τ) ≤K
n
X
i=1
∥h∥Ji,(p1)∥g∥Ji,(q1)
≤K max
1≤i≤n
 Osc(h; Ji)
(p1−p)/p1 ∧
 Osc(g; Ji)
(q1−q)/q1
×

Osc(h; [a, b])(p1−p)/p1 ∨Osc(g; [a, b])(q1−q)/q1
∥h∥p/p1
(p) ∥g∥q/q1
(q) ,
where Ji = [ti−1, ti] for i = 1, . . . , n. By Theorem 2.1(b), given any ǫ > 0,
there is a partition {uj}m
j=0 of [a, b] such that Osc(g; (uj−1, uj)) < ǫ and
Osc(h; (uj−1, uj)) < ǫ for each j = 1, . . . , m. Let δ be the minimum of uj−uj−1
for j = 1, . . . , m and let {ti}n
i=1 be a partition of [a, b] with mesh less than δ.
Then for each i = 1, . . . , n,
min(Osc(g; [ti−1, ti]), Osc(h; [ti−1, ti])) < 2ǫ,
since each [ti−1, ti] contains at most one uj and either g or h is continuous at
uj. It follows that R(τ) →0 as mesh |τ| ↓0. The proof of Theorem 3.101 is
complete.
2
A substitution rule for the Kolmogorov integral of functions with values
in a Banach algebra will be given in Section 4.6 (Proposition 4.40).

3.7 Existence of Extended Riemann–Stieltjes Integrals
191
3.7 Existence of Extended Riemann–Stieltjes Integrals
The Love–Young inequality, Corollary 3.91, showed existence of integrals
(RYS)
R b
a f·dg for f ∈Wp([a, b]; X) and g ∈Wp([a, b]; Y ) if p, q ≥1 and
p−1 + q−1 > 1, and gave a bound (3.147) for such integrals. A main fact in
this section will be Proposition 3.104, showing that such integrals need not
exist if p−1 + q−1 = 1, for any of the several extended Stieltjes integrals we
have considered. In order to include the central Young integral among those
which do not exist, we will next prove a proposition and corollary about this
integral.
By Theorem 2.51(a), for regulated functions, if their reﬁnement Young–
Stieltjes integral exists then so does the central Young integral, and the two
are equal. Thus Theorem 3.89 gives suﬃcient conditions for existence of the
central Young integral. By Proposition 2.52, there is a pair of functions f, h
for which ∫f dh exists in the central Young sense but not in the reﬁnement
Young–Stieltjes sense. The next fact gives a suﬃcient condition for the two
integrals to agree.
For any interval A ⊂J, Banach space (X, ∥· ∥), and 1 ≤q < ∞, let
ℓq(A, J; X) :=
n
f =
X
i
fi1{ξi} ∈c0(A, J; X):
X
i
∥fi∥q < ∞
o
,
where c0(A, J; X) is deﬁned in Deﬁnition 2.9. Also, recall that W∞([a, b]; Y ) :=
R([a, b]; Y ).
Proposition 3.102. Assume (1.14) and a < b. Let 1 ≤p, q ≤∞with
q−1 + p−1 = 1, let h ∈Wp([a, b]; Y ), and let f ∈R([a, b]; X) be such that
∆−f ∈ℓq((a, b), [a, b]; X) if q < ∞. Then (RYS) ∫b
a f·dh exists if and only if
(CY ) ∫b
a f·dh does, and the two integrals are equal.
Proof. The proof is given only for the case 1 < q < ∞because proofs for
the cases q = 1 and q = ∞are similar. We can assume that ∥h∥(p) > 0. By
Theorem 2.51 it suﬃces to prove that the reﬁnement Young–Stieltjes integral
exists if the central Young integral does. Suppose that (CY ) ∫b
a f·dh exists.
Then by Proposition 2.48, (RYS) ∫b
a f (a,b)
−
·dh exists, where f (a,b)
−
is deﬁned by
(2.46). Thus by Lemma 2.49, it is enough to prove that (RYS) ∫b
a ∆−
(a,b)f·dh
exists, where ∆−
(a,b)f = f −f (a,b)
−
, using the deﬁnitions before (2.1) and in
(2.46). By H¨older’s inequality, the sum P
(a,b) ∆−f·∆±h converges absolutely
and so unconditionally in Z. Let ǫ > 0. Then there exists a ﬁnite set λ1 ⊂(a, b)
such that

X
x∈µ
[∆−f·∆±h](x) −
X
(a,b)
∆−f·∆±h
 < ǫ
for any set µ ⊂(a, b) including λ1. Since ∆−f ∈ℓq((a, b), [a, b]; X) and h ∈
Wp([a, b]; Y ), there exists a ﬁnite set λ2 ⊂(a, b) such that

192
3 Φ-variation and p-variation
X
y∈ν
∆−f(y)
q <

ǫ/∥h∥(p)
q
for any set ν ⊂(a, b) disjoint from λ2. Then λ := {a, b}∪λ1 ∪λ2 is a partition
of [a, b]. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged Young point partition of [a, b],
where {ti}n
i=0 is a reﬁnement of λ. Recalling the deﬁnition (2.16) of Young–
Stieltjes sum, by H¨older’s inequality, we then have
SYS(∆−
(a,b)f, h; τ) −
X
(a,b)
∆−f·∆±h

≤

n−1
X
i=1
[∆−f·∆±h](ti) −
X
(a,b)
∆−f·∆±h

+

n
X
i=1
∆−f(si)·[h(ti−) −h(ti−1+)]

≤ǫ +

n
X
i=1
∥∆−f(si)∥q1/q
∥h∥(p) < 2ǫ.
Therefore the integral (RYS) ∫b
a ∆−
(a,b)f·dh exists, and the proof is complete.
2
The next fact follows from Proposition 3.102.
Corollary 3.103. Let 1 ≤p, q ≤∞with p−1+q−1 = 1, let f ∈Wq([a, b]; X),
and let h ∈Wp([a, b]; Y ). Then (CY ) ∫b
a f·dh = (RYS) ∫b
a f·dh if either side is
deﬁned.
The following shows that integrals
R b
a f·dg need not exist in any of several
senses for f ∈Wp and g ∈Wq with p−1 + q−1 = 1. Here it will be shown that
f can have further regularity properties, the H¨older property f ∈H1/p and
f ∈W∗
p, and likewise for q, although of course f /∈Wr for any r < p. Here
the two integrals of most interest may be the RYS integral, since we have
used it the most, and the Henstock–Kurzweil HK integral, since it appears
to be a very general integral. The Lebesgue–Stieltjes integral is very general
as regards integrands f, but not integrators g, and so its nonexistence is not
surprising.
Proposition 3.104. If p−1 + q−1 = 1 and 1 < p, q < ∞, then there exist
continuous functions f ∈W∗
p[0, 1]∩H1/p[0, 1] and g ∈W∗
q [0, 1]∩H1/q[0, 1] such
that the integral (A) ∫1
0 f dg does not exist for A = RS, RRS, RYS, CY, HK,
or LS.
Proof. For j = 1, 2, . . . and t ∈[0, 1], let ξj(t) := 2−j/p sin(2j+1πt) and
ηj(t) := 2−j/q(1 −cos(2j+1πt)). Then ξj and ηj are both periodic of pe-
riod 1/2j. For i = 1, 2, . . . , let ai := 1 −2−i and Ji := [ai−1, ai], where

3.7 Existence of Extended Riemann–Stieltjes Integrals
193
a0 := 0. If j ≥i, then ξj and ηj are 0 at both endpoints of Ji, and Ji includes
2j−i complete periods of both functions. Also, if j ≥i and k ≥i, then the
Riemann–Stieltjes integral (RS) ∫ai
ai−1 ξj dηk = 0 for j ̸= k and
(RS)
Z ai
ai−1
ξjdηj = 2π
Z ai
ai−1
sin2(2j+1πt) dt = π/2i.
Let mi := 2i ≥i for all i, and on Ji, let fi := Pmi+1
j=mi+1 ξj and gi :=
Pmi+1
j=mi+1 ηj. Then (RS) ∫ai
ai−1 fi dgi = π for all i. Let f := fi and g := gi on Ji
for each i and f(1) := g(1) := 0. Then f and g are well deﬁned and continuous
at each ai for i ≥1 since ξj(ai) = ηj(ai) = 0 for j > min(2i+1, 2i) = 2i > i.
At a0 = 0, f = f1 and g = g1 are right-continuous.
Let α := 1/p. It will be shown that each fi is H¨older of order α. For
any s, t ∈[0, 1] with s ̸= t we have 2−k−1 < |s −t| ≤2−k for some unique
nonnegative integer k. Then using (3.109) and | sin x| ≤min{1, |x|} for each
real x,
|fi(s) −fi(t)| ≤
X
j≥1
|ξj(s) −ξj(t)| ≤2π|s −t|
X
j≤k
2(1−α)j + 2
X
j>k
2−jα
≤
h
4π
21−α −1 +
2
1 −2−α
i
2−kα ≤C(α)|s −t|α,
where for k = 0 the sum over the empty set of indices is zero, and C(α) <
+∞depends only on α. So fi is H¨older of order α = 1/p. Since fi = 0
at the endpoints of Ji for each i, it follows that f is also α-H¨older, with
|f(s) −f(t)| ≤2C(α)(t −s)α for 0 ≤s ≤t < 1, and since f(1) = 0, the same
holds for t = 1. Likewise, g is H¨older of order 1/q. Thus by (1.7), f ∈Wp[0, 1]
and g ∈Wq[0, 1]. To show that f ∈W∗
p[0, 1], let ǫ > 0. By Proposition
3.42, there is a u ∈(0, 1) such that vp(f; [u, 1]) < ǫ/2. Since f is smooth on
each interval Ji, and so is in W1[0, u], f ∈W∗
p[0, u] by Lemma 3.61. Thus
by implication (a) ⇒(b) of Proposition 3.60, there is a partition {zj}m−1
j=0 of
[0, u] such that Pm−1
j=1 vp(f; (zj−1, zj)) < ǫ/2. Letting zm := 1, it then follows
that Pm
j=1 vp(f; (zj−1, zj)) < ǫ, and so f ∈W∗
p[0, 1] by the reverse implication
(b) ⇒(a) of Proposition 3.60. Similarly it follows that g ∈W∗
q [0, 1].
We have that (RS) ∫u
0 f dg exists for each u ∈[0, 1). Suppose that
(A) ∫1
0 f dg exists for A = RS, RRS, RYS, or HK. By Theorem 2.75 and
property IV, deﬁned by (2.72), we have
lim
u↑1(A)
Z u
0
f dg = (A)
Z 1
0
f dg.
Also we have that (A) ∫ai
ai−1 f dg = π for each i by construction if A = RS, or
by Propositions 2.13 and 2.18 and Theorem 2.69 if A = RRS, RYS, or HK,
respectively, a contradiction. Thus (A) ∫1
0 f dg does not exist for A = RS,
RRS, RYS, or HK. Also this integral does not exist for A = CY by Corollary

194
3 Φ-variation and p-variation
3.103 and for A = LS since neither g nor f is of bounded 1-variation (if either
were, the RS integral would exist by Theorems 2.17 and 2.42). The proof of
Proposition 3.104 is complete.
2
The Henstock–Kurzweil integral
We begin with necessary conditions for existence of HK integrals.
Proposition 3.105. Let 1 < p, q < ∞with p−1 + q−1 = 1, and let h be a
real-valued function on [a, b], a < b, which is either right-continuous or left-
continuous at each point. If (HK) ∫b
a f dh exists for each f ∈W∗
p[a, b], then
h ∈Wq[a, b].
To prove this fact we ﬁrst prove two lemmas.
Lemma 3.106. If h ̸∈Wq[a, b] with a < b then:
(i) For at least one c ∈[a, b], vq(h; J) = +∞for all intervals J with c ∈J ⊂
[a, b] and J relatively open in [a, b].
(ii) If a < c < b then either for all intervals J = [c, d], c < d ≤b, or for all
intervals J = [d, c], a ≤d < c, we have vq(h; J) = +∞for all such J.
Proof. If (i) fails, then we have a covering of [a, b] by ﬁnitely many relatively
open intervals Ji on each of which vq(h; Ji) < +∞, a contradiction. Statement
(ii) then follows.
2
Lemma 3.107. If h ̸∈Wq[a, b] with a < b then there is a c ∈[a, b] and
a sequence {uj}j≥1 ⊂[a, b] with uj ↑c or uj ↓c such that P∞
j=1 |h(uj) −
h(uj−1)|q = +∞.
Proof. Let c be as in the preceding lemma, part (i). If c ∈[a, b) and
vq(h; [c, d]) = +∞for all c < d ≤b, then for a given such d and some
u, c < u < d, vq(h; [u, d]) > 1 and vq(h; [c, u]) = +∞, so we can iterate.
A similar iteration leads to the conclusion of the lemma if c ∈(a, b] and
vq(h; [d, c]) = +∞for all a < d < c.
2
Proof of Proposition 3.105. Suppose h ̸∈Wq[a, b]. Then by the preceding
lemma and by symmetry, we can assume that P∞
j=1 |h(uj)−h(uj−1)|q = +∞
for some uj ↓c ∈[a, b). Taking a subsequence, we can assume that bj
:=
h(uj−1) −h(uj) ̸= 0 for all j. Replacing uj by uj + δj for small enough δj > 0
if h is right-continuous at uj, or replacing uj by uj −δj for small enough δj > 0
if h is left-continuous at uj, we can assume that h is continuous at uj for all
j = 0, 1, . . .. There exists a sequence {aj : j ≥1} in ℓp such that ajbj > 0 for
all j ≥1 and

3.7 Existence of Extended Riemann–Stieltjes Integrals
195
∞
X
j=1
ajbj = +∞.
(3.162)
To see this, since b
:=
{bj}j≥1 /∈ℓq, it follows from well-known facts in
functional analysis that there is some {aj}j≥1 ∈ℓp such that P∞
j=1 ajbj does
not converge, e.g. [53, Theorems 6.4.1, 6.5.1]. The same will hold for some aj ̸=
0 for all j and then for aj having the same sign as bj, still with {aj}j≥1 ∈ℓp.
Let f be a function on [a, b] such that f = aj on (uj, uj−1) for each j = 1, 2, . . .
and f = 0 elsewhere. Given u ∈(uk, uk−1] for some k ≥1, let fu be the
function on [a, b] equal to f on [a, c] ∪(u, b] and zero on (c, u]. Then fu is a
step function and vp(f −fu) ≤2 P
j≥k |aj|p →0 as u ↓c, and so f ∈W∗
p[a, b]
by Proposition 3.60(c). For c < u < b such that c < uk+1 < u ≤uk < · · · <
u0 ≤b,
(HK)
Z b
u
f dh = ak+1[h(uk) −h(u)] +
k
X
j=1
aj[h(uj−1) −h(uj)].
(3.163)
Indeed, the integral on the left side exists by Proposition 2.56. By Lemma
2.57 applied recursively, given ǫ > 0 there is a gauge function δ(·) on [u, b]
such that for each δ-ﬁne tagged partition τ = ({xi}n
i=0, {yi}n
i=1) of [u, b], the
Riemann–Stieltjes sum SRS(f, dh; τ) diﬀers by at most ǫ from the integral
on the left side of (3.163), and each uj, j = 0, . . . , k, is a tag yi(j) for some
i(j) ∈{1, . . ., n}. Thus
SRS(f, dh; τ) = ak+1[h(xi(k)−1) −h(u)] +
k
X
j=1
aj[h(xi(j−1)−1) −h(xi(j))].
Since h is continuous at each uj and bounded by Proposition 2.60, the
Riemann–Stieltjes sum can be made arbitrarily close to the sum on the right
side of (3.163) by further reﬁning δ-ﬁne tagged partitions. Likewise, h(xi(k)−1)
can be made to approach h(uk). Therefore (3.163) holds. By Proposition 2.58
and (3.162), in (3.163) letting u ↓c, it follows that (HK) ∫b
c f dh = +∞. This
contradiction proves the proposition.
2
The following shows that the left- or right-continuity of the integrator in
Proposition 3.105 cannot simply be omitted.
Proposition 3.108. Let h be a real-valued function on [a, b] with a < b. If for
some uk ↓c ∈[a, b), u1 < b, h(uk) →0 (however slowly) and h(x) = 0 for all
other x ∈[a, b], then (RYS) ∫b
a f dh = (HK) ∫b
a f dh = 0 for any f : [a, b] 7→R.
Proof. Given ǫ > 0, deﬁne a gauge function δ(·) on [a, b] so that if x ̸∈F :=
{c} ∪{uk}k≥1 then [x−δ(x), x+δ(x)] does not intersect F. Deﬁne each δ(uk)
so that uk+1 < uk −δ(uk) for all k ≥1 and uk + δ(uk) < uk−1 for k ≥2.
Finally deﬁne δ(c) so that |f(c)h(x)| < ǫ for c ≤x ≤c + δ(c). Let τ(δ) =

196
3 Φ-variation and p-variation
({xi}n
i=0, {yi}n
i=1) be a δ-ﬁne tagged partition of [a, b]. By deﬁnition of δ(·),
if xi = yi = uk for some k, then yi+1 = uk. Without changing the Riemann–
Stieltjes sum SRS(f, dh; τ(δ)), we combine two adjoining intervals into one
whenever they have a common tag. Then h(xi)−h(xi−1) = 0 except possibly if
yi = c when |f(c)[h(xi)−h(xi−1)]| = |f(c)h(xi)| < ǫ. Thus |SRS(f, dh; τ)| < ǫ
for any δ-ﬁne tagged partition τ of [a, b] and the conclusion follows for the HK
integral. Since h(a)
−≡h(b)
+ ≡0 on [a, b] the Young–Stieltjes sums SYS(f, dh; τ)
are all 0 by (2.16), and so the conclusion holds for the RYS integrals.
2
Corollary 3.109. Let p, q, and h be as in Proposition 3.105. If (RYS) ∫b
a f dh
exists for each f ∈W∗
p[a, b], then h ∈Wq[a, b].
Proof. In the proof of Proposition 3.105, the integral on the left side of (3.163)
also exists as an RYS integral with the same value because h is a step function
over each interval [u, b] with c < u < b. By (3.162), limu↓c(RYS) ∫b
u f dh =
+∞. On the other hand, by property IV (Theorem 2.75), the indeﬁnite RYS
integral is a regulated function, and hence bounded. This contradiction proves
that h ∈Wq[a, b].
2
3.8 Convolution and Related Integral Transforms
Suppose that the basic assumption (1.14) holds. For an interval J = [[a, b]]
and y ∈R, let J −y := [[a −y, b −y]], with −∞−y := −∞and ∞−y := ∞.
Let µ and ν be upper continuous and additive interval functions on R with
values in X and Y , respectively. Letting fJ(y) := µ(J −y), y ∈R, deﬁne the
interval function µ∗ν on R by
µ∗ν(J) :=
R
=
R
µ(J −y)·dν(y) ≡
R
=
R
fJ·dν
provided the Kolmogorov integral is deﬁned for every interval J ⊂R. We
will say that µ∗ν is the convolution of µ and ν. The following relates the
p-variation properties of the three interval functions µ, ν, and µ∗ν.
Theorem 3.110. Let p, q ∈[1, ∞) and p−1 + q−1 > 1. Assuming (1.14), let
µ ∈AIp(R; X) and let ν ∈AIq(R; Y ). For r given by 1/r = 1/p + 1/q −1,
we have µ∗ν ∈AIr(R; Z) and
µ∗ν

(r) ≤C∥µ∥(p)∥ν∥(q),
for some ﬁnite constant C = C(p, q).
Thus (µ, ν) 7→µ∗ν is a bounded bilinear operator from AIp×AIq into AIr
if 1 ≤p, q, r < ∞and 1/p + 1/q −1/r = 1. The proof of the theorem is given

3.8 Convolution and Related Integral Transforms
197
below. It is a consequence of an analogous result for an integral transform
of a more general kind, but for ﬁnite intervals, deﬁned as follows. Let G be
a Y -valued regulated function deﬁned on [a, b], and let H be an X-valued
function on [c, d] × [a, b]. Deﬁne an integral transform F ≡F(H, dG) on [c, d]
with values in Z by
F(x) := (RYS)
Z b
a
H(x, y)·dG(y) ≡(RYS)
Z b
a
H(x, ·)·dG
(3.164)
provided the reﬁnement Young–Stieltjes integral exists for each x ∈[c, d].
An inequality bounding the γ-variation of the integral transform F is
proved in this section for a suitable γ ∈[1, ∞). Hypotheses on H for this
bound are expressed in the following terms. For 1 ≤β, p < ∞, a < b,
and c < d, let Wβ,p(X) = Wβ,p([c, d]×[a, b]; X) be the class of functions
H : [c, d]×[a, b] →X such that Aβ,sup(H) < ∞and Bsup,p(H) < ∞, where
Aβ,sup(H) := Aβ,sup(H; [c, d], [a, b]) := sup
y∈[a,b]
∥H(·, y)∥[c,d],(β),
(3.165)
Bsup,p(H) := Bsup,p(H; [c, d], [a, b]) := sup
x∈[c,d]
∥H(x, ·)∥[a,b],(p).
(3.166)
It is convenient ﬁrst to bound the γ-variation of the integral transform K :=
F(H −H(·, a), dG). Thus the function K is deﬁned by
K(x) = (RYS)
Z b
a

H(x, y) −H(x, a)

·dG(y),
c ≤x ≤d,
provided the reﬁnement Young–Stieltjes integral is deﬁned for each x.
Theorem 3.111. Let p, q, β ∈[1, ∞) and p−1 + q−1 > 1. Assuming (1.14),
a < b, and c < d, let G ∈Wq([a, b]; Y ) and let H ∈Wβ,p([c, d]×[a, b]; X).
Then the function K is deﬁned and for some ﬁnite constant C = C(p, q, β),
the bound
K

(γ) ≤CAβ,sup(H)β/γBsup,p(H)1−(β/γ)G

(q)
(3.167)
holds with γ given by
1/γ := (p/β)(1/p + 1/q −1).
(3.168)
Before starting to prove the theorem we give two corollaries. The ﬁrst is
a bound for the γ-variation seminorm of the function F deﬁned by (3.164)
under the assumptions of Theorem 3.111. By the deﬁnition of γ and since
q ≥1, we have β/γ = 1 + p(q−1 −1) ≤1, and so γ ≥β. By Lemma 3.45, we
have
∥H(·, a)∥(γ) ≤∥H(·, a)∥(β) ≤Aβ,sup(H).
Since F = K + H(·, a)·[G(b) −G(a)], and since ∥· ∥(γ) is a seminorm, the
following holds:

198
3 Φ-variation and p-variation
Corollary 3.112. Under the assumptions of Theorem 3.111 and with the
same constant C, we have the bound
F

(γ) ≤CAβ,sup(H)β/γBsup,p(H)1−(β/γ)G

(q)
+ Aβ,sup(H)∥G(b) −G(a)∥.
(3.169)
A second corollary is a bound for the r-variation seminorm of a convolution
H∗G deﬁned on R by (H∗G)(x) = (RYS) ∫b
a H(x −y)·dG(y) provided the
reﬁnement Young–Stieltjes integral exists for each x ∈R. Here we have in
mind the case that G is deﬁned on R, with G(y) ≡G(a) for y ≤a and
G(y) ≡G(b) for y ≥b. Then ∫∞
−∞H(x −y)·dG(y) is naturally deﬁned as
(RYS) ∫b
a H(x −y)·dG(y).
Corollary 3.113. Let p, q ∈[1, ∞) and p−1 + q−1 > 1. Assuming (1.14)
and a < b, let G ∈Wq([a, b]; Y ) and let H ∈Wp(R; X). For r given by
1/r = 1/p + 1/q −1, we have H∗G ∈Wr(R; Z) and
H∗G

R,(r) ≤(1 + C)∥H∥R,(p)∥G∥[a,b],(q),
(3.170)
where C = C(p, q, p) is the constant in (3.167).
Proof. Corollary 3.112 will be applied when β = p and γ = r. For −∞<
c < d < ∞, let ¯H(x, y) = H(x −y) for x ∈[c, d] and y ∈[a, b]. Then ¯H ∈
Wp,p([c, d] × [a, b]; X) with Ap,sup( ¯H) ≤∥H∥R,(p) and Bsup,p( ¯H) ≤∥H∥R,(p).
Given a point partition κ = {xi}n
i=0 of R, by (3.169) applied to F( ¯H, dG) on
[c, d] = [x0, xn], we have
sr(H∗G; κ)1/r ≤∥F∥[x0,xn],(r) ≤(1 + C)∥H∥R,(p)∥G∥[a,b],(q),
and the conclusion follows since κ is an arbitrary partition of R.
2
Convolution of interval functions
Before proving Theorem 3.110 we give conditions under which the convolution
of interval functions is well deﬁned and upper continuous. For this we need a
convergence theorem for Kolmogorov integrals.
Lemma 3.114. Let 1 ≤p, q < ∞and p−1 + q−1 > 1. Assuming (1.14), for a
nonempty interval J, let µ ∈AIq(J; Y ) and let {fk}k≥1 ⊂Wp(J; X) be such
that supk ∥fk∥(p) < ∞and fk →0 as k →∞on a dense set containing all
atoms of µ. Then
R
=J fk·dµ →0 as k →∞.
Proof. We can assume that J is nondegenerate. The Kolmogorov integral
R
=J fk·dµ exists for each k by Corollary 3.95. Let ǫ > 0 and let r > q be such
that p−1 + r−1 > 1. By Lemma 3.55, µ has r∗-variation, and so by Lemma
3.29, there is a Young interval partition {(zj−1, zj)}m
j=1 of J such that

3.8 Convolution and Related Integral Transforms
199
m
X
j=1
vr(µ; (zj−1, zj)) < ǫ.
(3.171)
For each j = 1, . . . , m, let tj ∈Aj := (zj−1, zj) be such that fk(tj) →0 as
k →∞. For each k ≥1, by additivity of the Kolmogorov integral (Theorem
2.21), we have
R
=
J
fk·dµ =
X
zj∈J
fk(zj)·µ({zj}) +
m
X
j=1
fk(tj)·µ(Aj) +
m
X
j=1
R
=
Aj
[fk −fk(tj)]·dµ.
The ﬁrst two sums on the right converge to zero as k →∞. For the last sum,
by a Love–Young inequality (3.147) and applying H¨older’s inequality (1.4), it
follows that
m
X
j=1

R
=
Aj

fk −fk(tj)

·dµ

≤Kp,r
m
X
j=1
∥fk∥Aj,(p)∥µ∥Aj,(r)
≤Kp,r
 m
X
j=1
vp(fk; Aj)
1/p m
X
j=1
vr(µ; Aj)
1/r
≤ǫ1/rKp,r sup
k
∥fk∥(p),
where the last inequality holds by (3.51) applied recursively, and (3.171). Since
ǫ > 0 is arbitrary, the conclusion follows.
2
The following gives conditions for the existence of the convolution of in-
terval functions.
Proposition 3.115. Let 1 ≤p, q < ∞and p−1 + q−1 > 1. If µ ∈AIp(R; X)
and ν ∈AIq(R; Y ) then the convolution µ∗ν is a well-deﬁned additive upper
continuous interval function on R with values in Z.
Proof. Let fx(y) := µ((−∞, x]−y) for x, y ∈R. For any partition κ = {ti}n
i=0
of R, we have
sp(fx; κ) =
n
X
i=1
µ((x −ti, x −ti−1])
p ≤vp(µ; R) < ∞.
Thus the bound vp(fx; R) ≤vp(µ; R) holds for any x ∈R. In particular, the
integral
R
=R fx·dν exists by Corollary 3.95. Similarly it follows that the func-
tion y 7→µ(J −y), y ∈R, has bounded p-variation uniformly in the interval

200
3 Φ-variation and p-variation
J ⊂R, and so the convolution µ∗ν is well deﬁned. To show its additivity
note that if A, B ∈I(R) are disjoint and A ∪B ∈I(R) then for each y ∈R,
A −y, B −y ∈I(R) are disjoint and A ∪B −y = (A −y) ∪(B −y) ∈I(R).
Then µ∗ν is additive since µ is additive and the Kolmogorov integral is linear
with respect to the integrand by Theorem 2.72 (Property I) and Corollary
2.26. To show upper continuity of µ∗ν, for x ∈R, let g := Rµ∗ν,−∞, that is,
g(x) = µ∗ν((−∞, x]) =
R
=
R
µ((−∞, x −y])·dν(y)
for x ∈R. For any x′ < x′′, we have
g(x′′) −g(x′) = R=
R
µ((x′, x′′] −y)·dν(y) →0
as x′, x′′ ↓x or x′, x′′ ↑x for any x ∈R by Lemma 3.114 since µ is upper
continuous and the set of all atoms of ν is at most countable by Proposition
2.6(c). Thus g is a regulated function on R with values in Z. Moreover, for
each x ∈R,
R
=
R
µ((−∞, x) −y)·dν(y) −g(x−) = lim
z↑x
R
=
R
µ([z, x) −y)·dν(y) = 0
by Lemma 3.114 again. Similarly g(x+) = g(x) for each x ∈R. It then follows
that the function Rµ∗ν,−∞= g on R satisﬁes statement (f) of Theorem 2.6,
and so µ∗ν is upper continuous. The proof of the proposition is complete. 2
Next, Theorem 3.110 will be proved assuming Theorem 3.111 and Corol-
lary 3.112.
Proof of Theorem 3.110. The convolution µ∗ν is well deﬁned by Proposi-
tion 3.115. To prove the stated bound let ǫ > 0. By Proposition 3.115 again,
the convolution interval function µ∗ν is upper continuous, and so there is
0 < M < ∞such that
max

∥µ∗ν∥(−∞,−M],sup, ∥µ∗ν∥[M,∞),sup
	
< ǫ.
Let A = {Ai}n
i=1 be an interval partition of R. In taking the supremum of
sr(µ∗ν; A) over all such partitions we can assume n ≥4 by upper continuity.
Let A1 = (−∞, u]] and An = [[v, ∞) for some u < v. Let a := min{−M, u}−1
and b := max{M, v} + 1. Then
sr(µ∗ν; A) ≤2rǫr + 2r−1vr(µ∗ν; (a, b)),
(3.172)
as can be seen for ρ := µ∗ν by writing
∥ρ(A1)∥r = ∥ρ((−∞, a]) + ρ((a, u]])∥r ≤2r−1(ǫr + ∥ρ((a, u]])∥r)
and similarly for An, while ∪n−1
j=2 Aj ⊂[[u, v]] ⊂(a, b).

3.8 Convolution and Related Integral Transforms
201
Let θ be an increasing homeomorphism from (a, b) onto R. For x ∈R, let
H(x, y) := µ((−∞, x] −θ(y)) if y ∈(a, b), H(x, a) := H(x, a+) = µ(R), and
H(x, b) := H(x, b−) = 0. For any y ∈[a, b] and partition {xi}n
i=0 of [a, b],
n
X
i=1
∥H(xi, y) −H(xi−1, y)∥p =
n
X
i=1
∥µ((xi−1, xi] −θ(y))∥p ≤vp(µ).
For each x ∈[a, b] and partition {yj}m
j=0 of [a, b],
m
X
j=1
∥H(x, yj) −H(x, yj−1)∥p =
m
X
j=1
∥µ((x −θ(yj), x −θ(yj−1)])∥p ≤vp(µ).
Thus H ∈Wp,p([a, b]×[a, b]; X), Ap,sup(H) ≤∥µ∥(p), and Bsup,p(H) ≤∥µ∥(p).
Let νθ(J) := ν(θ(J)) for intervals J ⊂(a, b) and let νθ({a}) := νθ({b}) := 0.
Then ∥νθ∥[a,b],(q) ≤∥ν∥(q), and so νθ ∈AIq([a, b]; Y ). Also, let G(y) :=
Rνθ,a(y) = νθ([a, y]) for y ∈[a, b]. Thus ∥G∥(q) ≤∥ν∥(q) by Proposition
3.31(a). By a change of variables in the Kolmogorov integral (Proposition
2.30), we then have
Rµ∗ν,−∞(x) =
R
=
(a,b)
µ((−∞, x] −θ(y))·dνθ(y)
= (RYS)
Z b
a
H(x, y)·dG(y) =: F(x)
for x ∈[a, b], where the next to last equality holds by Corollary 2.26 and
since νθ({a}) = νθ({b}) = 0. This together with Proposition 3.31(a) and
Corollary 3.43(d) give that ∥µ∗ν∥(a,b),(r) = ∥Rµ∗ν,−∞∥(a,b),(r) = ∥F∥[a,b],(r).
The conclusion now follows from Corollary 3.112 with β = p, γ = r, and the
bound (3.172), since the interval partition A of R and ǫ > 0 are arbitrary. 2
Integral transforms
To prepare for a proof of Theorem 3.111 we consider periodic functions. As-
sume that H : R →X and G: R →Y are periodic with period Λ > 0, and
thus so is the function z 7→H(z + u)·G(z + v): R →Z, for any u, v ∈R. Let
I := 1
Λ(RS)
Z Λ
0
H·dG
and
F(z) := 1
Λ(Bo)
Z
[0,Λ]
H(y −z)·G(y) dy
(3.173)
for each real number z, provided the Riemann–Stieltjes integral and the
Bochner integral with respect to Lebesgue measure (Deﬁnition 2.31) are de-
ﬁned.

202
3 Φ-variation and p-variation
Lemma 3.116. Assuming (1.14), let H : R →X and G: R →Y be periodic
with period Λ > 0. Let G be continuous, let H be bounded and λ-measurable
for Lebesgue measure λ, and let the integral I exist. Identifying L(R, Z) with
Z, I is the derivative of F at 0.
Proof. By the change of variables y 7→y/Λ, it is enough to prove the lemma
for Λ = 1. It is enough to prove that
lim
t↓0
F(t) −F(0) −tI
/t = 0 = lim
t↓0
F(0) −F(−t) −tI
/t.
(3.174)
We prove only the ﬁrst equality since the proof of the second one is similar.
Denoting by m := m(t) := ⌊t−1⌋the largest integer ≤t−1, for y ∈[0, 1] and
t ∈(0, 1), let
Ut(y) :=
m
X
i=1
H(y + (i −1)t)·[G(y + it) −G(y + (i −1)t)].
(3.175)
By periodicity, we have for each t ∈(0, 1),
F(t) −F(0) = (Bo)
Z
[0,1]
H(y)·[G(y + t) −G(y)] dy
= (Bo)
Z
[0,1]
m−1Ut(y) dy.
(3.176)
Next we compare Ut(y) with a Riemann–Stieltjes sum for the integral I. Let
y ∈[0, 1], let t ∈(0, 1), and let k = k(y, t) be the minimal integer such that
y + kt > 1. Then k ∈{1, . . . , m + 1}. First suppose that 1 < k < m. Deﬁne a
tagged partition τk(y, t) = ({tj}m
j=0, {sj}m
j=1) of [0, 1] by letting
sj :=

y + (j + k −1)t −1 for j = 1, . . . , m −k,
y + (j −m + k −1)t for j = m −k + 1, . . . , m,
tj := sj+1 for j = 1, . . . , m −1, t0 := 0, and tm := 1. Then tm−k = y, the
mesh of τk(y, t) is ≤2t, and by periodicity, we have
Ut(y) =
m−k
X
j=1
H(y+(j +k−1)t−1)·[G(y+(j +k)t−1)−G(y+(j +k−1)t−1)]
+
m
X
j=m−k+1
H(y+(j−m+k−1)t)·[G(y+(j−m+k)t)−G(y+(j−m+k−1)t)].
The jth term in the last display equals H(sj)·[G(tj) −G(tj−1)] except for
j = 1, m −k, and m. Thus
Ut(y) = SRS(H, dG; τk(y, t)) + H(y + kt)·[G(0) −G(y + kt)]
+H(y + (m −1)t)·[G(y + mt) −G(y)]
+H(y + (k −1)t)·[G(y + kt) −G(1)]

3.8 Convolution and Related Integral Transforms
203
for any y ∈[0, 1] and t ∈(0, 1) such that 1 < k < m. Let ǫ > 0. There exists
a δ > 0 with δ < ǫ/2 such that for each u ∈[0, 1], ∥G(u) −G(u + s)∥< ǫ if
−δ ≤s ≤δ and ∥I −SRS(H, dG; τ)∥< ǫ if the mesh of a tagged partition τ
is less than 2δ. Since the mesh of τk(y, t) is less than 2δ when 0 < t < δ, it
then follows that
Ut(y) −I∥< ǫ + 3ǫ∥H∥sup for any such t and y ∈[0, 1].
Using relation (3.176), we then have
∥F(t) −F(0) −tI∥
t
≤(Bo)
Z
[0,1]
∥Ut(y) −I∥
tm
dy +
I

1 −1
tm

≤2ǫ[1 + 3∥H∥sup] + ǫ∥I∥
(3.177)
for any 0 < t ≤min{δ, 1/2}.
Now let y ∈[0, 1] and t ∈(0, 1) be such that k = k(y, t) = 1. By periodicity,
we have
Ut(y) = H(y) · [G(y + t) −G(y)]
+
m−1
X
j=1
H(y + jt −1)·[G(y + (j + 1)t −1) −G(y + jt −1)]. (3.178)
Let tj−1 := sj := y + jt −1 if j = 2, . . . , m −1, s1 := y + t −1, sm :=
tm−1 := y, t0 := 0 and tm := 1. Then τ1(y, t) := ({tj}m
j=0, {sj}m
j=1) is a tagged
partition of [0, 1] with the mesh less than 2t. Each term of (3.178) equals
H(sj)·[G(tj) −G(tj−1)] except for the ﬁrst term and the terms for j = 1 and
m −1. Thus
Ut(y) = SRS(H, dG; τ1(y, t)) + H(y + t)·[G(0) −G(y + t)]
+H(y)·[G(y + t) −G(1)] + H(y + (m −1)t)·[G(y + mt) −G(y)].
Lastly let k = m or k = m+1. Let sj := y+(j−1)t if j = 1, . . . , m, t0 := 0,
tj := sj+1 if j = 1, . . . , m−1 and tm := 1. Then τm(y, t) := ({tj}m
j=0, {sj}m
j=1)
is a tagged partition of [0, 1]. Since y + (m −1)t ≤1, in this case we have
y ≤2t and the mesh of τm(y, y) is less than 3t. Each term of (3.175) equals
H(si)·[G(ti) −G(ti−1)] except for i = 1 or m. Thus
Ut(y) = SRS(H, dG; τm(y, t)) + H(y)·[G(0) −G(y)]
+H(y + (m −1)t)·[G(y + mt) −G(1)].
As in the case 1 < k < m, given ǫ > 0 there exists a δ > 0 such that (3.177)
holds for any 0 < t ≤min{δ, 1/2}. The ﬁrst equality in (3.174) is proved, and
so the lemma is proved.
2
Assuming H, G, and F to be as in (3.173), for each k = 0, 1, 2, . . ., let
Fk := 2k
Λ

F(2−kΛ) −F(0)

= 2k
Λ2 (Bo)
Z
[0,Λ]

H(y −2−kΛ) −H(y)

·G(y) dy,

204
3 Φ-variation and p-variation
provided the Bochner integrals are deﬁned. Notice that F0 ≡0 by periodicity.
The next lemma gives a relation between consecutive terms of the sequence
{Fk}k≥1.
Lemma 3.117. For each k ≥1, we have the equality
Fk −Fk−1 = 2k−1
Λ2 (Bo)
Z
[0,Λ]

H(y −2−kΛ) −H(y)

·[G(y) −G(y + 2−kΛ)

dy.
Proof. Let k ≥1. By periodicity, we have
Λ2
2k Fk = (Bo)
Z
[0,Λ]

H(y) −H(y + 2−kΛ)

·G(y + 2−kΛ) dy
(3.179)
and
Λ2
2k−1 Fk−1 = (Bo)
Z
[0,Λ]

H(y −2−kΛ) −H(y + 2−kΛ)

·G(y + 2−kΛ) dy.
(3.180)
In the representation Fk −Fk−1 = Fk/2 + Fk/2 −Fk−1, using (3.179) for the
ﬁrst Fk/2 and (3.180) for Fk−1, the desired equality follows, completing the
proof.
2
The next lemma will be used to bound each ∥Fk −Fk−1∥.
Lemma 3.118. Let 1 ≤p < ∞, let Λ > 0, and let H : R →X be λ-
measurable for Lebesgue measure λ. If the p-variation of H over any interval
of length Λ never exceeds K, then for each integer n ≥1,
1
Λ
Z
[0,Λ]
H(t + Λ/n) −H(t)
p dt ≤K/n.
(3.181)
Proof. Let h(t) := H(Λt) for each real number t. Then h: R →X is a λ-
measurable function with p-variation vp(h; [t, t+1]) = vp(H; [Λt, Λt+Λ]) ≤K
for each real number t. Thus using a change of variables in (3.181) we can
suppose that Λ = 1. Let n ≥1. Then by a change of variables again, we have
Z
[0,1]
H(t + 1/n) −H(t)
p dt =
n
X
i=1
Z
Ain
H(t + 1/n) −H(t)
p dt
=
Z
[0,1/n]
n
X
i=1
H(t + i/n) −H(t + (i −1)/n)
p dt
≤
Z
[0,1/n]
vp(H; [t, t + 1]) dt ≤K/n,
where Ain := [(i −1)/n, i/n] for i = 1, . . . , n. The proof of Lemma 3.118 is
complete.
2

3.8 Convolution and Related Integral Transforms
205
For H : [c, d] × [0, Λ] 7→X with Λ > 0, and G: R 7→Y let
I(x) := IΛ(x) := 1
Λ(RS)
Z Λ
0
H(x, y)·dG(y),
x ∈[c, d],
(3.182)
provided the Riemann–Stieltjes integral is deﬁned for each x.
Proposition 3.119. Let p, q, β ∈[1, ∞), p−1+q−1 > 1, α := 1/q, c < d, and
Λ > 0. Let H ∈Wβ,p([c, d]×[0, Λ]; X) be such that H(·, 0) ≡H(·, Λ) ≡0, and
let G: R 7→Y be periodic with period Λ and be α-H¨older continuous on [0, Λ].
Then the function I is deﬁned and there exists a ﬁnite constant C = C(p, q, β)
such that for γ ≥1 given by (3.168), we have
I

[c,d],(γ)
(3.183)
≤CAβ,sup(H; [c, d], [0, Λ])β/γBsup,p(H; [c, d], [0, Λ])1−(β/γ)∥G∥[0,Λ],(Hα).
Proof. It is straightforward to check that since β ≥1, we have 0 < 1/γ ≤1
in (3.168) and so 1 ≤γ < ∞.
Since G is continuous and p−1 + q−1 > 1, the function I(x), x ∈[c, d],
is well deﬁned by Corollary 3.91 and Theorem 2.42. We extend H(x, ·) from
[0, Λ] to R by periodicity. Let y be a real number and let m be the integer such
that y ≤mΛ < y+Λ. Then by periodicity and since the p-variation seminorm
is subadditive over intervals (Proposition 3.35(a)), for each x ∈[c, d],
∥H(x, ·)∥[y,y+Λ],(p) ≤∥H(x, ·)∥[(m−1)Λ,mΛ],(p) + ∥H(x, ·)∥[mΛ,(m+1)Λ],(p)
= 2∥H(x, ·)∥[0,Λ],(p) ≤2Bsup,p(H; [c, d], [0, Λ]).
Likewise, for each y, ∥G∥[y,y+Λ],(Hα) ≤2∥G∥[0,Λ],(Hα). If ∥G∥[0,Λ],(Hα) = 0
then (3.183) holds. Moreover, (3.183) also holds if Bsup,p(H; [c, d], [0, Λ]) = 0
because G(Λ) = G(0). Since the inequality (3.183) is homogeneous, we can
and do assume that
Bsup,p(H; [c, d], [0, Λ]) = 1
and
∥G∥[0,Λ],(Hα) = 1,
(3.184)
and so for each y,
Bsup,p(H; [c, d], [y, y + Λ]) ≤2
and
∥G∥[y,y+Λ],(Hα) ≤2.
(3.185)
In particular, G and H(x, ·), x ∈[c, d], are regulated, and so bounded mea-
surable functions. For each k = 0, 1, . . . and each x ∈[c, d], let
Fk(x) := 2k
Λ2 (Bo)
Z
[0,Λ]

H(x, y −2−kΛ) −H(x, y)

·G(y) dy
= 2k
Λ2 (Bo)
Z
[0,Λ]
H(x, y)·

G(y + 2−kΛ) −G(y)

dy.
(3.186)

206
3 Φ-variation and p-variation
By Lemma 3.116, I(x) = limk→∞Fk(x) for each x ∈[c, d]. By Lemma 3.117,
(3.185), H¨older’s inequality, and Lemma 3.118, respectively, for each k ≥1
and x ∈[c, d], the following inequalities hold:
Fk(x) −Fk−1(x)

≤2k−1
Λ2
Z
[0,Λ]
∥H(x, y −2−kΛ) −H(x, y)∥∥G(y) −G(y + 2−kΛ)∥dy
≤Λα−12k(1−α) 1
Λ
Z
[0,Λ]
∥H(x, y −2−kΛ) −H(x, y)∥p dy
1/p
≤Λα−121−(kβ)/(pγ),
because α + 1/p −1 = β/(pγ) by (3.168). Thus for each k ≥0 and x ∈[c, d],
we get the bound
∥I(x) −Fk(x)∥≤Λα−1
∞
X
i=k+1
21−(iβ)/(pγ) = C12−(kβ)/(pγ),
(3.187)
where C1 = 2Λα−1/(2β/(pγ) −1). Let k ≥1 and c ≤s < t ≤d. By (3.186),
(3.185) for G, and H¨older’s inequality, we get
∥Fk(t) −Fk(s)∥≤2k
Λ2
Z
[0,Λ]
∥H(t, y) −H(s, y)∥∥G(y + 2−kΛ) −G(y)∥dy
≤Λα−12k(1−α)+1∆β(s, t),
(3.188)
where
∆:= ∆β(s, t) :=
 1
Λ
Z
[0,Λ]
∥H(t, y) −H(s, y)∥β dy
1/β
.
By considering three cases, we will show that for any c ≤s < t ≤d,
∥I(t) −I(s)∥≤C2∆β/γ,
(3.189)
where C2 := 2Λα−1[21/p+2/(2β/(pγ)−1)]. Assuming this is true, and applying
it for a given partition κ = {ti}n
i=0 of [c, d], it follows that
sγ(I; κ)1/γ ≤C2
 1
Λ
Z
[0,Λ]
sβ(H(·, y); κ) dy
1/γ
≤C2Aβ,sup(H; [c, d], [0, Λ])β/γ.
Due to (3.184), the proof will be complete.
To prove (3.189), let c ≤s < t ≤d. First suppose that 1 < ∆< ∞. Then
(3.189) follows from (3.187) with k = 0 because 2C1 < C2. Second suppose
that 0 < ∆≤1 and choose k ≥1 so that 2−k/p < ∆≤2−(k−1)/p. By (3.187),
it then follows that
∥I(x) −Fk(x)∥≤C1∆β/γ
for all x ∈[c, d]. Also by (3.188) and (3.168), we have

3.8 Convolution and Related Integral Transforms
207
Fk(t) −Fk(s)∥≤Λα−122−α∆β/γ.
Then (3.189) is a consequence of the last two inequalities because C2 = 2C1 +
Λα−121+(1/p). Third suppose that ∆= 0. Since Fk →I pointwise, and by
(3.188),
I(t) −I(s)
 = lim
k→∞
Fk(t) −Fk(s)
 = 0.
Thus (3.189) holds in this case also, proving the proposition.
2
Next we show that one can remove the periodicity condition on G in the
preceding proposition by increasing the constant C in (3.183).
Proposition 3.120. Under the hypotheses of Proposition 3.119 except for
periodicity of G, the conclusion holds with a possibly larger constant C =
C(p, q, β, Λ) in (3.183).
Proof. Deﬁne ˜G on [0, Λ + 1] by
˜G(y) :=
G(y)
if y ∈[0, Λ],
G(Λ) + [G(0) −G(Λ)](y −Λ) if y ∈(Λ, Λ + 1].
Then for u ∈[0, Λ] and v ∈[Λ, Λ + 1], we have
∥˜G(v) −˜G(u)∥≤∥˜G(v) −G(Λ)∥+ ∥G(Λ) −G(u)∥
≤∥G(Λ) −G(0)∥|v −Λ| + ∥G∥(Hα)|Λ −u|α
≤∥G∥(Hα)Λα|v −Λ|α + ∥G∥(Hα)|Λ −u|α
≤∥G∥(Hα)|v −u|α(Λα + 1).
Thus ∥˜G∥(Hα) ≤(1 + Λα)∥G∥(Hα). Also deﬁne ˜H on [c, d] × [0, Λ + 1] by
˜H(x, y) :=
 H(x, y) if (x, y) ∈[c, d] × [0, Λ],
0
if (x, y) ∈[c, d] × (Λ, Λ + 1].
Then Aβ,sup( ˜H; [c, d], [0, Λ + 1]) = Aβ,sup(H; [c, d], [0, Λ]) and
Bsup,p( ˜H; [c, d], [0, Λ + 1]) = Bsup,p(H; [c, d], [0, Λ])
since H(x, Λ) = 0 for all x ∈[c, d]. For each x ∈[c, d], let
˜I(x) :=
1
Λ + 1(RS)
Z Λ+1
0
˜H(x, y)·d ˜G(y) =
Λ
Λ + 1I(x).
We can extend ˜G by periodicity outside the interval [0, Λ+1]. Since ˜H and ˜G
satisfy all the conditions of Proposition 3.119 except for constant factors (e.g.
Λ + 1 in place of Λ), we can apply it to ˜I. Then we get

208
3 Φ-variation and p-variation
∥I∥[c,d],(γ) = Λ + 1
Λ
∥˜I∥[c,d],(γ) ≤C(Λ + 1)(Λα + 1)
Λ
×
(3.190)
×Aβ,sup(H; [c, d], [0, Λ])β/γBsup,p(H; [c, d], [0, Λ])1−(β/γ)∥G∥[0,Λ],(Hα),
proving the proposition.
2
Secondly we show that one can also remove the assumption H(·, Λ) ≡0 in
Proposition 3.119, again by increasing the constant C in (3.183).
Proposition 3.121. Under the hypotheses of Proposition 3.119 except for
periodicity of G and H(·, Λ) ≡0, the conclusion holds with possibly a still
larger constant C in (3.183).
Proof. Let ˜H be the same as H except that H(·, Λ) is replaced by 0. The
value of the integral I does not change when H is replaced by ˜H since G
is continuous. Since Bsup,p( ˜H) ≤2Bsup,p(H) and Aβ,sup( ˜H) ≤Aβ,sup(H),
(3.183) with a further factor 21−(β/γ) times (Λ + 1)(Λα + 1)/Λ follows from
Proposition 3.120, speciﬁcally (3.190).
2
Thirdly we show that for a continuous function G, in the preceding state-
ment the α-H¨older seminorm can be replaced by the q-variation seminorm.
Proposition 3.122. Let p, q, β ∈[1, ∞), p−1 + q−1 > 1, c < d, and Λ >
0. Let H ∈Wβ,p([c, d] × [0, Λ]; X) be such that H(·, 0) ≡0, and let G ∈
Wq([0, Λ]; Y ) be continuous. Then the function I in (3.182) is deﬁned and there
exists a ﬁnite constant M = M(p, q, β, Λ) such that for γ given by (3.168), we
have
I

[c,d],(γ)
(3.191)
≤MAβ,sup(H; [c, d], [0, Λ])β/γBsup,p(H; [c, d], [0, Λ])1−(β/γ)∥G∥[0,Λ],(q).
Proof. Since G is continuous and p−1 + q−1 > 1, the function I(x), x ∈[c, d],
is well deﬁned by Corollary 3.91 and Theorem 2.42. If ∥G∥[0,Λ],(q) = 0 then
(3.191) holds. Thus we can assume that ∥G∥[0,Λ],(q) = (Λ/2)1/q. For each
y ∈[0, Λ], let
θ(y) := vq(G; [0, y]) + y/2.
Also because G is continuous, by Corollary 3.43, θ is a continuous increasing
function on [0, Λ], θ(0) = 0, and θ(Λ) = Λ. Let φ be the inverse of θ, and
for each y ∈[0, Λ], let ˜G(y) := G(φ(y)) and ˜H(·, y) := H(·, φ(y)). For any
0 ≤s < t ≤Λ, we have
 ˜G(t) −˜G(s)
q ≤vq(G; [0, φ(t)]) −vq(G; [0, φ(s)])
= t −s −(1/2)[φ(t) −φ(s)] ≤t −s.

3.8 Convolution and Related Integral Transforms
209
Thus for α := 1/q, ∥˜G∥[0,Λ],(Hα) ≤1 = (2/Λ)α∥G∥[0,Λ],(q). Also, we have
˜H(·, 0) ≡H(·, 0) ≡0, Aβ,sup( ˜H) ≤Aβ,sup(H), Bsup,p( ˜H) ≤Bsup,p(H), and
for each x ∈[c, d],
I(x) = 1
Λ(RS)
Z Λ
0
˜H(x, y)·d ˜G(y)
by a change of variables property for the RS integral (Proposition 2.77). Since
all the conditions of Proposition 3.121 hold for ˜G and ˜H, we get that (3.191)
holds with M = (2/Λ)1/qC for the C from Proposition 3.121.
2
For a ﬁnite sequence y = {yj}m
j=1 in a normed space Y and 1 ≤q < ∞,
let vq(y) := vΦ(y; {1, m}) as deﬁned by (3.136) with Φ(u) = uq, u ≥0.
Lemma 3.123. For a Banach space Y , let {c0, . . . , cm} ⊂Y , let λ = {zj}m
j=0
be a point partition of [a, b] with a < b, and let g: [a, b] →Y be the function
such that for t ∈[zj−1, zj] and j = 1, . . . , m,
g(t) = cj−1 + (cj −cj−1)(t −zj−1)/(zj −zj−1).
Then for any q ≥1,
vq(g; [a, b]) ≤3q−1vq({cj −cj−1}m
j=1).
(3.192)
For Y = R the factor 3q−1 in (3.192) is unnecessary.
Proof. Let q ≥1 and let κ = {ti}n
i=0 be a point partition of [a, b]. If κ is a
reﬁnement of λ then
sq(g; κ) =
m
X
j=1
∥cj −cj−1∥q
X
ti∈(zj−1,zj]
 ti −ti−1
zj −zj−1
q
≤
m
X
j=1
∥cj −cj−1∥q.
(3.193)
Otherwise, let A, B, and C be the sets of values of i such that (ti−1, ti) contains
no zj, just one zj, or more than one zj, respectively. Let ∆i := ∥g(ti)−g(ti−1)∥
for each i. For i ∈B and ti−1 < zj < ti,
∆i ≤∥g(ti) −g(zj)∥+ ∥g(zj) −g(ti−1)∥.
For i ∈C, let ji and Ji be the smallest and largest j respectively such that
ti−1 < zj < ti. Then
∆i ≤∥g(ti) −g(zJi)∥+ ∥g(zJi) −g(zji)∥+ ∥g(zji) −g(ti−1)∥.
Jensen’s inequality gives (a + b + c)q ≤3q−1(aq + bq + cq) for any a, b, c ≥0.
Thus sq(g; κ) ≤3q−1S, where S is obtained from Pm
j=1 ∥cj −cj−1∥q by, for

210
3 Φ-variation and p-variation
each i ∈C such that Ji ≥ji + 2, deleting all the terms with j = ji + 1, . . . , Ji
and inserting the one term ∥cJi −cji∥q. Thus S ≤vq({cj −cj−1}m
j=1) and the
inequality (3.192) follows.
Now suppose that Y = R. Again let κ = {ti}n
i=0 be a point partition of
[a, b]. Since uq + vq ≤(u + v)q for any u, v ≥0, we can assume that the
consecutive increments cj −cj−1, cj+1 −cj of g have opposite signs for j =
1, . . . , m−1. Then if g(ti−1) < g(ti) > g(ti+1), we can assume that g has a local
maximum at ti, since otherwise ti could be replaced by such a point, increasing
sq(g; κ). So g(ti) = cj for some j. Likewise if g(ti−1) > g(ti) < g(ti+1) then
g(ti) = cj for some j since we can take a relative minimum of g. It then follows
that sq(g; κ) = Pk
r=1 |cjr −cjr−1|q for some 0 = j0 < j1 < · · · < jk ≤m,
proving (3.192) with no factor 3q−1 in this case. The proof of the lemma is
complete.
2
Proof of Theorem 3.111. Since p−1+q−1 > 1, the function K(x), x ∈[c, d],
is well deﬁned by Corollary 3.91. By the change of variables y 7→(y−a)/(b−a),
y ∈[a, b], it is enough to prove the theorem for [a, b] = [0, 1] (Proposition
2.77). Since Aβ,sup(H −H(·, 0)) ≤2Aβ,sup(H) and Bsup,p(H −H(·, 0)) =
Bsup,p(H), we can and do assume that H(·, 0) ≡0. To prove the theorem we
will approximate each K(x) by a similar integral with a continuous integrator
and apply Proposition 3.122.
Let ǫ > 0 and let κ = {xj}m
j=0 be a point partition of [c, d]. For each
j = 1, . . . , m, there exists a point partition λj of [0, 1] such that
(RYS)
Z 1
0

H(xj, y) −H(xj−1, y)

·dG(y)

γ
≤
SYS
 H(xj, ·) −H(xj−1, ·), dG; τj
γ + ǫ/m
for each Young tagged point partition τj of [0, 1] which is a reﬁnement of
λj, where SYS is the Young–Stieltjes sum deﬁned by (2.16). Let {ti}n
i=0 be a
simultaneous reﬁnement of all m partitions λj and let si := (ti−1 + ti)/2 for
i = 1, . . . , n. Then τ = ({ti}n
i=0, {si}n
i=1) is a tagged Young point partition of
[0, 1] such that
sγ(K; κ) ≤ǫ +
m
X
j=1
K(xj; τ) −K(xj−1; τ)
γ,
(3.194)
where K(x; τ) := SYS(H(x, ·), dG; τ) for x ∈[c, d]. Let µ := {ui−1, vi}n
i=1
be such that ti−1 < ui−1 < si < vi < ti for i = 1, . . . , n, v0 := 0, and
un := 1. Also, let w0 := 0 = t0, w2i−1 := si, and w2i := ti for i = 1, . . . , n.
Then τ(µ) := ({vi, ui}n
i=0, {wi}2n
i=0) is a tagged partition of [0, 1]. Deﬁne the
function g on [0, 1] by
g(t) := G(u) + [G(v) −G(u)](t −u)/(v −u),
t ∈[u, v],

3.9 Notes
211
for each [u, v] = [ui−1, vi], i = 1, . . . , n, and each [u, v] := [vi, ui], i = 0, . . . , n.
Also deﬁne the function h on [c, d] × [0, 1] by letting for each x ∈[c, d],
h(x, y) :=

H(x, si) if y ∈[ui−1, vi) for some i = 1, . . . , n,
H(x, ti) if y ∈[vi, ui) for some i = 0, . . . , n,
and h(x, 1) := H(x, 1). Notice that h(·, 0) = H(·, 0) ≡0. It is easy to verify
that Aβ,sup(h) ≤Aβ,sup(H) and Bsup,p(h) ≤Bsup,p(H). Also for each x ∈
[c, d], we have
SRS(H(x, ·), dG; τ(µ)) = (RS)
Z 1
0
h(x, y)·dg(y) =: IRS(x; τ(µ)).
For each x ∈[c, d], letting ui−1 ↓ti−1 and vi ↑ti for each i = 1, . . . , n, it
follows that IRS(x; τ(µ)) →K(x; τ). Thus one can choose τ(µ) such that for
the given κ = {xj}m
j=0,
m
X
j=1
K(xj; τ) −K(xj−1; τ)
γ ≤ǫ +
m
X
j=1
IRS(xj; τ(µ)) −IRS(xj−1; τ(µ))
γ.
By Lemma 3.123, ∥g∥(q) ≤31−(1/q)∥G∥(q). Applying (3.194) and Proposition
3.122 with Λ = 1, H = h, and G = g to IRS(·; τ(µ)), it follows that
sγ(K; κ)1/γ ≤2ǫ1/γ + MAβ,sup(h)β/γBsup,p(h)1−(β/γ)∥g∥(q)
≤2ǫ1/γ + 31−(1/q)MAβ,sup(H)β/γBsup,p(H)1−(β/γ)∥G∥(q).
Since ǫ > 0 and κ are arbitrary, (3.167) holds. The proof of Theorem 3.111 is
complete.
2
3.9 Notes
Notes on Section 3.1. L. C. Young [246] suggested the notion of Φ-variation
and attributed the introduction of the power case Φ(u) ≡up to Norbert
Wiener. Wiener [241] actually deﬁned ¯vp(f) as in (3.79). We do not know of
a deﬁnition of vp, as opposed to ¯vp, before that of Marcinkiewicz [156].
Theorem 3.7 is due to Musielak and Orlicz [176, pp. 32–33]. It is analogous
to corresponding results for the Luxemburg norm on Orlicz spaces.
The case of Corollary 3.9 for p-variation, when Φ(u) ≡up for u ≥0 for
some p with p ≥1, was noted by G. Krabbe [124], [125].
The deﬁnition (3.17) of the complementary function and Proposition 3.11
are due to Birnbaum and Orlicz [18]. W. H. Young [253] discovered the in-
equality (3.21) and proved it under additional conditions on P and Q.
Proposition 3.13 is a special case of Theorem 3 of Luxemburg [148, Section
II.2], where a notion of complementary function allowing inﬁnite values was

212
3 Φ-variation and p-variation
used. The example following Proposition 3.12 and showing sharpness of the
inequalities (3.24) was suggested by a similar example in [148, Section II.2, p.
49] showing sharpness of (3.27).
Notes on Section 3.2. The Φ-variation of an additive set function was
deﬁned by I. Kluv´anek [118] as follows. A set function is any function from a
family Q of sets into a Banach space. It is called additive if whenever A and B
are disjoint sets in Q such that A∪B ∈Q, we have µ(A∪B) = µ(A)+µ(B). A
family Q of subsets of a set Ω, containing the empty set, is called a semiring
if for any A and B in Q, we have A ∩B ∈Q and A \ B = ∪1≤j≤nCj for
some ﬁnite n and disjoint Cj ∈Q. A family P of disjoint sets in Q is called a
partition if for every A ∈Q, the subfamily {B ∈P : B ∩A ̸= ∅} of P is ﬁnite.
The set of all partitions is denoted by Π = Π(Q). Let Φ ∈CV be such that
limt↓0 Φ(t)/t = 0 and limt→∞Φ(t)/t = ∞. Let (X, ∥· ∥) be a Banach space,
let Q be a semiring of subsets in a set Ω, and let µ: Q →X be an additive
set function. For A ∈Q and a partition P ∈Π, let
sΦ(µ, P; A) :=
X
B∈P
Φ
 ∥µ(A ∩B)∥

.
For a set of partitions ∆⊂Π and A ∈Q, let
vΦ(µ, ∆; A) := sup

sΦ(µ, P; A): P ∈∆
	
.
Then [118, p. 108] the Φ-variation of a set function µ with respect to the family
of partitions ∆is the set function A 7→vΦ(µ, ∆; A), A ∈Q. The deﬁnition
reduces to Deﬁnition 3.16 in case Q = ∆is the semiring of all subintervals of
a nonempty interval J and µ is an additive interval function on J.
Notes on Section 3.3. The quantity ¯vp(f) related to the local p-variation
was introduced by N. Wiener [241] and later used by many authors. The local
p-variation v∗
p(f) ﬁrst appeared in Love and Young [147, p. 29].
Notes on Section *3.4. Theorem 3.75 extends Theorem 2 of D’yaˇckov
[60], which proved equivalence of (b) through (e) and the part of (a) about
Riemann–Stieltjes integrability. The main ingredient in the proof, an inequal-
ity for Riemann–Stieltjes sums (Proposition 3.73), is also due to D’yaˇckov
[60].
Rubinˇste˘ın [197] introduced the class of ξ-lacunary sequences (as in Deﬁni-
tion 3.64) in connection with his work on Fourier series of functions in H¨older
classes.
Notes on Section 3.6. L. C. Young [244] proved (3.129) with a constant
K = 1 + ζ(p−1 + q−1) when the full Stieltjes integral is replaced by the Y0
integral deﬁned in the notes to Section 2.5 (see Section 2.11). He also noted
that the ﬁrst, unpublished, proof of an inequality for ﬁnite sums, Theorem 3.83
for Φ(u) = up, Ψ(u) = uq, u ≥0, for real-valued f and h on the same interval,
was due to E. R. Love. Given such an inequality for ﬁnite sums, it seems
that the main remaining diﬃculty in obtaining an inequality for integrals is
to deﬁne an extension of the Riemann–Stieltjes integral to functions possibly

3.9 Notes
213
having common (even one-sided) discontinuities, as Young did with the Y0
integral.
In fact Love (unpublished) and L. C. Young [244] proved somewhat more,
namely that a term ∥f∥(p)∥h∥(q) on the right side of an inequality such as
(3.142) can be replaced by a supremum supκ(sp(f; κ)1/psq(h; κ)1/q), where κ
ranges over partitions of the given interval.
Love [144, p. 290] wrote in 1993: “L. C. Young (1936), partly in conjunc-
tion with the present writer, showed that Riemann–Stieltjes integration could
reach out into areas inaccessible to Lebesgue–Stieltjes integration.” There
were previously known cases of such a phenomenon. For example, when f
is of bounded variation and h is continuous but of unbounded variation,
(RS)
R b
a f dh exists and can be evaluated by integration by parts, whereas the
Lebesgue–Stieltjes integral as it stands does not exist. But Love and Young
found a much broader class of cases.
A year after L. C. Young’s 1936 paper [244], a related joint paper by Love
and Young appeared [146]. More recently, Love in 1993 [144] modiﬁed L. C.
Young’s proof to give the constant in (3.129), namely K = ζ(p−1 + q−1) as
opposed to 1 + K.
L. C. Young in 1938 [247, Theorem 5.1] proved that if f ∈WΦ[a, b] and
h ∈WΨ[a, b] with Φ, Ψ ∈V having inverses φ, ψ, respectively, such that
Θ(φ, ψ) < ∞deﬁned by (3.126), then the integral (RYS) ∫b
a f dh exists and
for any s ∈[a, b], the inequality
(RYS)
Z b
a

f −f(s)

dh
 ≤20
∞
X
k=1
φ
vΦ(f)
k

ψ
vΨ(h)
k

(3.195)
holds. Our Theorem 3.89 gives a conclusion of the form (3.195) under the
additional hypothesis that Φ and Ψ are convex but without the constant 20.
A function Φ ∈V is log-convex if
Φ(uαvβ) ≤αΦ(u) + βΦ(v)
for u, v > 0 and α, β ≥0, α + β = 1.
Le´sniewicz [138] By the inequality uαvβ ≤αu + βv (Lemma 5.1.3 in [53]), if
Φ ∈V is convex then it is log-convex. A function Φ ∈V is log-convex if and
only if Φ(u) = χ(ln u) for u > 0, where χ is a convex function on R. Related to
Theorem 3.89 is Theorem 4.01 of Le´sniewicz and Orlicz [139]: for log-convex
functions Φ, Ψ ∈V with inverses φ, ψ, and real-valued functions f ∈WΦ[a, b],
h ∈WΨ[a, b], if their Riemann–Stieltjes integral is deﬁned then
(RS)
Z b
a
f dh
 ≤φ
 vΦ(f)

ψ
 vΨ(h)

+
∞
X
k=1
φ
vΦ(f)
k

ψ
vΨ(h)
k

.
Lemma 3.86 can easily be proved for log-convex functions Φ, Ψ ∈V. That
lemma is the only part of the proof of Theorem 3.83 where convexity is used, so
the theorem would follow for log-convex Φ and Ψ in V. Examples of log-convex

214
3 Φ-variation and p-variation
functions in V that are not convex are given by Ψ(u) = up for 0 < p < 1. For
such Ψ, however, a function in WΨ must have bounded variation (cf. Corollary
3.39), and so the existence of the full Stieltjes integral with suitable bounds
holds whenever the other function is regulated (cf. Theorem 2.84).
Notes on Section 3.7. L. C. Young [244] gave the counterexamples in
Proposition 3.104 (except that he did not consider the HK integral). Le´snie-
wicz and Orlicz [139] modiﬁed this example to show that the series condition
(3.126) is best possible for convex functions Φ and Ψ satisfying the ∆2 and ∇2
growth conditions: for some constants c, d > 1 and u0 > 0, Φ(2u) ≤cΦ(u) and
2Φ(u) ≤d−1Φ(du) for 0 ≤u ≤u0, respectively, and the same for Ψ instead of
Φ.
Notes on Section 3.8. L. C. Young [245, pp. 458–459] gave a proof of
an earlier version of Theorem 3.111 under certain periodicity and continuity
assumptions. His result when applied to the convolution F∗G yields (3.170)
with p−1 + q−1 −r−1 > 1. The conclusion fails for p−1 + q−1 −r−1 < 1.
Theorem 3.111 for real-valued and periodic functions is due to F. W. Gehring
[74, Theorem 3.2].
Corollary 3.113 is a slight extension of a statement of Gehring [74, Theorem
4.1.4]. L. C. Young [248, Theorem 7.8] generalized Corollary 3.113 to func-
tions with bounded Φ-variation using a diﬀerent extended Riemann–Stieltjes
integral. There is a corresponding theorem in A. Zygmund [258, (1.26) on p.
39] for a convolution (F∗G)(x) := (2π)−1 ∫2π
0
F(x −y) dG(y) deﬁned in the
Riemann–Stieltjes sense for each x such that the functions F(x −·) and G
have no discontinuities in common, when F(x + 2π) −F(x) is constant for
x ∈R, F has bounded variation on [0, 2π], and G satisﬁes similar conditions.
More general results than Lemma 3.118 for real-valued functions are due
to J. Marcinkiewicz [156, Theorem 4] and F. W. Gehring [74, Theorem 1.3.3].

4
Banach Algebras
Throughout this chapter K denotes either the ﬁeld R of real numbers or the
ﬁeld C of complex numbers.
Deﬁnition 4.1. A vector space A over K is called an algebra over K if it is
equipped with a binary operation, referred to as multiplication and denoted
by juxtaposition, from A × A to A such that for x, y, z ∈A and r ∈K,
(a) x(yz) = (xy)z;
(b) (x + y)z = xz + yz, x(y + z) = xy + xz;
(c) r(xy) = (rx)y = x(ry).
An algebra A is commutative if for all x, y ∈A,
(d) xy = yx.
An algebra A is unital if there exists an identity element 1I ∈A such that
1I ̸= 0 and for all x ∈A,
(e) 1Ix = x1I = x.
If K = R, A is called a real algebra, and if K = C, a complex algebra. A subset
of an algebra A is a subalgebra of A if it is an algebra with respect to the
operations of A.
It is clear that if A is a unital algebra, then the identity element 1I is
unique.
Deﬁnition 4.2. An element x of a unital algebra A is said to be invertible
with inverse y if yx = xy = 1I.
If y and z are two inverses of x, then y = yxz = z, so the inverse is unique.
Let x−1 := y.
Deﬁnition 4.3. Let S be a nonempty set and A a unital algebra over K. The
pointwise operations on S are deﬁned as follows. For A-valued functions f, g
on S, a scalar r ∈K, and any s ∈S, let
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_4, 
215

216
4 Banach Algebras
(rf)(s) = rf(s),
(fg)(s) = f(s)g(s),
(f + g)(s) = f(s) + g(s),
1I(s) := 1I.
The set AS of all A-valued functions on S with pointwise operations is an
algebra with identity 1I(·). An algebra of A-valued functions on S is a sub-
algebra of AS. An algebra of K-valued functions will be called an algebra of
functions.
For S and A as in the preceding deﬁnition, let ∅̸= E ⊂S with E ̸= S
and V := {f ∈AS : f = 0 on S \ E}. Then V is a unital algebra of A-valued
functions on S with identity 1E · 1I, but contains no constant functions (also
if A = K). If A is commutative, then so is any algebra of A-valued functions.
Although C is an algebra over R, for an algebra of C-valued functions (which
are not all R-valued) we always take K = C.
4.1 Ideals and Normed Algebras
Let A be a commutative algebra over K. Then an ideal in A is a subalgebra
I of A such that xy ∈I for all x ∈A and y ∈I. I is a proper ideal if I ̸= A.
A maximal ideal is a proper ideal which is not strictly included in any proper
ideal.
Theorem 4.4. Let A be a unital commutative algebra over K and I a proper
ideal in A. Then I is included in some maximal ideal.
Proof. Proper ideals are partially ordered by inclusion. The identity 1I belongs
to no proper ideal. The union of an inclusion-chain of proper ideals is an ideal
and does not contain 1I, so it is proper. The conclusion then follows from
Zorn’s lemma.
2
A mapping f from one algebra A over K to another D is called a homo-
morphism if f(cx + y) = cf(x) + f(y) and f(xy) = f(x)f(y) for all x, y ∈A
and c ∈K. For any commutative algebra A over K and ideal I in A, we can
deﬁne cosets x + I for x ∈A by x + I := {x + y: y ∈I}. Then u + I = v + I
if and only if u −v ∈I. Let A/I be the set of all cosets x + I for x ∈A. If we
deﬁne algebra operations on A/I by
(x+I)+(u+I) := x+u+I,
(x+I) (u+I) := xu+I,
c(x+I) := cx+I,
for x, u ∈A and c ∈K, then these operations are well deﬁned because I is an
ideal. Thus A/I is an algebra over K and x 7→x + I is a homomorphism from
A onto A/I.
Theorem 4.5. Let A be a unital commutative algebra over K and L a maxi-
mal ideal in A. Then A/L is a unital commutative algebra in which all nonzero
elements have inverses.

4.1 Ideals and Normed Algebras
217
Proof. Clearly 1I + L is the identity in A/L. The 0 element is L = 0 + L.
For any x ∈A, x + L is a nonzero element in A/L if and only if x ̸∈L.
Let x ∈A and x ̸∈L. We need to show that x + L has an inverse. Let
I := {xy + u: y ∈A, u ∈L}. Then I is an ideal strictly including L, so
I = A. Thus xy + u = 1I for some y ∈A and u ∈L, so xy ∈1I + L and y + L
is the desired inverse of x + L.
2
Deﬁnition 4.6. A normed vector space (B, ∥· ∥) over K will be called a
normed algebra over K if B is an algebra over K and (x, y) 7→xy is a bounded
bilinear operator B × B →B, so that for some M < ∞,
xy
 ≤M
x
 y

(4.1)
for all x, y ∈B.
If a normed algebra lacks an identity then one can be adjoined, as follows.
Proposition 4.7. Any normed algebra B is included in a unital one.
Proof. If B is not unital, let U := B × K with multiplication (x, z)(y, w) :=
(xy + zy + wx, zw) and norm ∥(x, z)∥:= ∥x∥+ |z|. Then U is a unital
normed algebra with identity 1I = (0, 1). B is isometric as a normed alge-
bra to {(x, 0): x ∈B} ⊂U.
2
As the following shows, it can be assumed that M in (4.1) equals 1 and
∥1I∥= 1.
Theorem 4.8. Let (B, |||·|||) be a unital normed algebra. Then there is a norm
∥· ∥on B equivalent to ||| · ||| such that (B, ∥· ∥) is a normed algebra,
xy
 ≤
x
 y

(4.2)
for all x, y ∈B, and
1I
 = 1.
(4.3)
Proof. Let (4.1) hold for ||| · ||| for some M < ∞. Deﬁne
x
 := sup
u̸=0
|||xu|||/|||u|||.
It is easily seen that ∥· ∥is a norm and that (4.2) and (4.3) hold for ∥· ∥. By
(4.1) we have ∥x∥≤M|||x||| for all x. Conversely, ∥x∥≥|||x|||/|||1I|||, so ∥· ∥and
||| · ||| are equivalent.
2

218
4 Banach Algebras
Deﬁnition 4.9. A Banach algebra is a normed algebra (B, ∥· ∥), complete
for ∥· ∥, such that (4.2) holds and if B is unital, (4.3) also holds. If B is an
algebra and ∥· ∥is a norm on it, then ∥· ∥is called a Banach algebra norm iﬀ
(B, ∥· ∥) is a Banach algebra.
Example 4.10. Let X be a Banach space over K. The linear space BX :=
L(X, X) of all bounded linear mappings from X into itself with pointwise ad-
dition and scalar multiplication, and with the product deﬁned by composition
(ST )x = S(Tx), x ∈X, and the operator norm (1.17), is a unital Banach
algebra over K.
Let S be a nonempty set and A a unital algebra. A subset E of AS separates
points of S if for each s, t ∈S with s ̸= t, there exists f ∈E with f(s) ̸= f(t),
and E strongly separates points of S if, further, for each s ∈S, there exists
f ∈E with f(s) ̸= 0. Note that, if E is an algebra of (K-valued) functions on
S which strongly separates points of S and if s, t ∈S with s ̸= t, then there
exists f ∈E with f(s) = 0 and f(t) = 1.
Deﬁnition 4.11. If S is a nonempty set, A is a unital algebra, B ⊂AS is an
algebra of A-valued functions on S, and ∥·∥is a norm on B, then (B, ∥·∥) will
be called a Banach algebra of A-valued functions on S iﬀB strongly separates
points of S and (B, ∥· ∥) is a Banach algebra. If A = K then (B, ∥· ∥) will be
called a Banach algebra of functions.
Remark 4.12. Because of the strong separation, a Banach algebra of A-
valued functions B is unital iﬀit contains as identity 1I the constant function
1I(·). Then, by Deﬁnition 4.9, the norm satisﬁes ∥1I(·)∥= 1. A Banach algebra
of (K-valued) functions is unital iﬀit contains all constant functions.
For example, Theorem 3.7 and Corollary 3.9 imply that the Banach space
f
WΦ(J) with the norm ∥· ∥[Φ] (Deﬁnition 3.5) of real-valued functions is a
Banach algebra of functions. The Banach algebra property holds when the
functions have values in any Banach algebra:
Proposition 4.13. Let Φ ∈CV, let J be a nondegenerate interval, and let
A be a real unital Banach algebra. Then (f
WΦ(J; A), ∥· ∥[Φ]) is a real unital
Banach algebra of A-valued functions.
Proof. By Theorem 3.7, f
WΦ(J; A) is a Banach space with the norm ∥· ∥[Φ].
By (4.2), for x, y ∈A, (x, y) 7→xy is a bilinear and 1-bounded mapping from
A×A into A. Thus by Theorem 3.8, the pointwise product fg of two functions
f, g ∈f
WΦ(J; A) also is in f
WΦ(J; A) and ∥fg∥[Φ] ≤∥f∥[Φ]∥g∥[Φ]. Since A is
unital, the constant function 1I(·) equal to 1I on J is the identity for f
WΦ(J; A)
and ∥1I(·)∥[Φ] = 1 by (4.3) and since ∥1I(·)∥(Φ) = 0, proving the corollary.
2

4.2 The Spectral Radius
219
Another example of a real Banach algebra of functions is the Banach space
of all bounded real-valued α-H¨older functions with 0 < α ≤1 and pointwise
operations on a nondegenerate interval. This will be a special case of the next
theorem. Let X, Y be normed spaces, let U be a subset of X with more
than one element, and let 0 < α ≤1. Recall that Hα(U; Y ) is the class of
all α-H¨older functions f : U →Y with the seminorm ∥f∥(Hα) = ∥f∥U,(Hα)
deﬁned by (1.18). Hα,∞(U; Y ) denotes the class of all bounded functions f in
Hα(U; Y ) with the norm
∥f∥Hα := ∥f∥U,Hα := ∥f∥U,sup + ∥f∥U,(Hα),
(4.4)
where ∥f∥sup = ∥f∥U,sup is the sup norm. By the next theorem, Hα,∞(U; Y )
with this norm also has the Banach algebra property if Y does.
Proposition 4.14. Let 0 < α ≤1, let U be a subset of a normed space X,
and let A be a real unital Banach algebra. Then (Hα,∞(U; A), ∥·∥Hα) is a real
unital Banach algebra of A-valued functions.
Proof. It is easy to check that Hα,∞(U; A) is a Banach space with the norm
∥· ∥Hα. Let f, g ∈Hα,∞(U; A). For any s, t ∈U we have
∥(fg)(s) −(fg)(t)∥≤∥f(s)∥∥g(s) −g(t)∥+ ∥g(t)∥∥f(s) −f(t)∥
≤∥f∥sup∥g(s) −g(t)∥+ ∥g∥sup∥f(s) −f(t)∥.
Then
∥fg∥(Hα) ≤∥f∥sup∥g∥(Hα) + ∥g∥sup∥f∥(Hα).
Since ∥fg∥sup ≤∥f∥sup∥g∥sup, we have that ∥fg∥Hα ≤∥f∥Hα∥g∥Hα. Since
A is unital, the constant function 1I(·) equal to 1I on U is the identity for
Hα(U; A) and ∥1I(·)∥Hα = 1 by (4.3) and since ∥1I(·)∥(Hα) = 0.
2
4.2 The Spectral Radius
Let B be a Banach algebra over K. For any x ∈B, the spectral radius is deﬁned
by
r(x) := inf
n≥1 ∥xn∥1/n,
(4.5)
where n ranges over positive integers, and xn := x1x2 · · · xn with xj = x for
j = 1, . . . , n is the nth power of x. Clearly for any c ∈K and x ∈B,
r(cx) = |c|r(x).
(4.6)
In general, r(·) is not necessarily a seminorm, e.g. if B is the algebra of 2 × 2
matrices, x =
  0 1
0 0

, and y =
  0 0
1 0

, then r(x) = r(y) = 0 but r(x + y) = 1.

220
4 Banach Algebras
Theorem 4.15. For any Banach algebra B and x ∈B,
r(x) = lim
n→∞∥xn∥1/n.
Proof. For each n ≥1, let an := ∥xn∥1/n. Then clearly lim infn→∞an ≥r(x).
Conversely, for any positive integers n and k,
ank ≤

∥xn∥k1/nk
= an,
and for r = 0, 1, . . . , n −1,
ank+r ≤

ank
n ∥x∥r1/(nk+r)
.
Letting k →+∞while n is ﬁxed, we get lim supm→∞am ≤an. Taking the
inﬁmum in n gives lim supm→∞am ≤r(x), and the conclusion follows.
2
Theorem 4.16. In any unital Banach algebra B,
(a) if x ∈B and r(x) < 1 (and so if ∥x∥< 1), then 1I + x has an inverse,
given by
(1I + x)−1 =
∞
X
k=0
(−1)kxk,
(4.7)
where x0 := 1I and the series converges absolutely. In particular, ∥y−1 −
1I∥≤ǫ/(1 −ǫ) whenever y ∈B and ∥y −1I∥≤ǫ < 1.
(b) the set U of all invertible elements is open. In particular, if x ∈U and
∥y∥< 1/∥x−1∥, then x + y ∈U and
(x + y)−1 =
∞
X
k=0
(−1)k(x−1y)kx−1.
(4.8)
Proof. By the deﬁnition of spectral radius, r(x) ≤∥x∥for all x, so suppose
r(x) < 1. Then the series (4.7) is absolutely convergent in B by the root test.
For any n = 1, 2, . . . ,
(1I + x)

n
X
k=0
(−1)kxk
= 1I −(−x)n+1 →1I
as n →∞, and the two factors on the left commute, proving (a).
For (b), let x ∈U and let y ∈B be such that ∥y∥< 1/∥x−1∥. By part (a),
1I + x−1y is invertible. Then z := x + y = x(1I + x−1y) has an inverse because
x−1 and (1I+x−1y)−1 exist, and z−1 = (1I+x−1y)−1x−1. Thus U is open and
(4.8) follows from (4.7).
2

4.2 The Spectral Radius
221
Deﬁnition 4.17. For any complex unital Banach algebra B and x ∈B, the
spectrum σ(x) of x is the set of all z ∈C such that z1I −x is not invertible.
If z ∈C \ σ(x) then (z1I −x)−1 exists and is called the resolvent of x at z.
For any z, w ∈C \ σ(x), the resolvent equation
(z1I −x)−1 −(w1I −x)−1 = −(z −w)(z1I −x)−1(w1I −x)−1
(4.9)
holds and is a consequence of
(z1I −x)−1 = (z1I −x)−1(w1I −x)(w1I −x)−1
= (z1I −x)−1
(w −z)1I + (z1I −x)

(w1I −x)−1
= (w −z)(z1I −x)−1(w1I −x)−1 + (w1I −x)−1.
To state some properties of the spectrum, recall that holomorphic functions
with values in a Banach space are deﬁned in Deﬁnition 2.94.
Theorem 4.18. For any complex unital Banach algebra B and x ∈B,
(a) the spectrum σ(x) is a compact subset of {z ∈C: |z| ≤r(x)};
(b) the function z 7→(z1I −x)−1 is holomorphic from C \ σ(x) into B;
(c) σ(x) is nonempty.
Proof. The set of invertible elements is open by Theorem 4.16(b), and z 7→
z1I −x is continuous from C into B, so σ(x) is closed. If |z| > r(x), then
r(x/z) < 1 by (4.6), so 1I −x/z is invertible by Theorem 4.16(a), and
(z1I −x)−1 = (1/z)(1I −x/z)−1.
(4.10)
So σ(x) ⊂{z ∈C: |z| ≤r(x)} and (a) is proved.
For (b) let w ∈C \ σ(x), xw := w1I −x, and let z ∈C be such that
|z −w| < 1/∥x−1
w ∥. By Theorem 4.16(b), z ∈C \ σ(x) and
 z1I −x
−1 = ((z −w)1I + xw)−1 =
∞
X
k=0
(z −w)k(−1)kx−k−1
w
,
where x−n := (x−1)n, n = 1, 2, . . .. Since |z −w| < 1/∥x−1
w ∥, the series
converges absolutely in B, so (b) is proved.
To prove (c), suppose σ(x) = ∅. So (for z = 0) x−1 exists. By the Hahn–
Banach theorem, let L be a continuous linear functional on the Banach space
(B, ∥· ∥) with L(x−1) = 1. For any z ∈C let g(z) := L((z1I −x)−1). By part
(b), g is an entire holomorphic function from C into C. By (4.7) and (4.10),
g(z) →0 as |z| →∞, so g is bounded and by Liouville’s theorem (see e.g. [42,
Theorem 9.11.1]), g is constant and so g ≡0, but g(0) = 1, a contradiction,
proving (c). The proof of Theorem 4.18 is complete.
2

222
4 Banach Algebras
Theorem 4.19 (Mazur–Gelfand). A unital Banach algebra B over C in which
every non-zero element is invertible is equal to {z1I: z ∈C}, and so B is iso-
morphic to the complex numbers.
Proof. Let x ∈B. If for each z ∈C, z1I −x is nonzero and so invertible, σ(x)
is empty, contrary to Theorem 4.18(c). The theorem is proved.
2
Theorem 4.20. For any unital complex Banach algebra B and x ∈B,
r(x) = sup{|z|: z ∈σ(x)}.
Proof. Since σ(x) ̸= ∅by Theorem 4.18(c), s(x) := sup{|z|: z ∈σ(x)} ≥0,
and s(x) ≤r(x) by Theorem 4.18(a). In proving r(x) ≤s(x), we can assume
r(x) > 0. For any z ∈C with |z| < 1/s(x), 1I −zx is invertible, since it clearly
is if z = 0, whereas for z ̸= 0, z−11I −x is invertible because |z−1| > s(x). The
function f with f(z) := (1I−zx)−1 is holomorphic from {z : |z| < 1/s(x)} into
B by Theorem 4.18(b). Thus by Propositions 2.100 and 2.96, the Taylor series
of f around 0 exists and converges absolutely on the whole disk |z| < 1/s(x)
(the whole plane, if s(x) = 0). For |z| small enough, say < 1/r(x), by Theorem
4.16(a), the Taylor series is P∞
k=0 zkxk, so hk = xk in (2.94). Thus for 0 <
t < 1/s(x), lim supk→∞tk∥xk∥= 0, so t lim supk→∞∥xk∥1/k = tr(x) ≤1. It
follows that r(x)/s(x) ≤1, so r(x) ≤s(x), ﬁnishing the proof.
2
Theorem 4.21. In any commutative unital Banach algebra A,
(a) the closure ¯I of any ideal I is an ideal;
(b) the closure of a proper ideal is a proper ideal;
(c) any maximal ideal is closed.
Proof. If xn, yn ∈I, xn →x ∈¯I, yn →y ∈¯I, c ∈K, and u ∈A, then
cxn →cx, uxn →ux, xnyn →xy, and xn + yn →x + y, so (a) holds.
A proper ideal contains no invertible elements. By Theorem 4.16(a), ele-
ments in an open neighborhood of 1I are all invertible and so belong neither
to I nor to ¯I, so (b) holds.
If M is a maximal ideal then M ⊂¯
M, a proper ideal by (b), so M = ¯
M
and (c) holds.
2
4.3 Characters
Deﬁnition 4.22. Let B be a Banach algebra over K = C. Then a function φ
from B into C is called a character if

4.3 Characters
223
(a) φ is an algebra homomorphism, that is, for all x, y ∈B and c ∈C,
φ(cx + y) = cφ(x) + φ(y)
and
φ(xy) = φ(x)φ(y);
(b) if B is unital, φ(1I) = 1.
Let M(B) denote the set of all characters of B.
Remark 4.23. In the deﬁnition of character, (b) is equivalent to the assump-
tion that if B is unital, φ is not identically 0.
Recall that for any normed space (X, ∥·∥) and any continuous linear func-
tional φ from X into K, the dual norm is deﬁned by ∥φ∥′ := sup{|φ(x)|: x ∈
X, ∥x∥= 1}.
Theorem 4.24. Any character φ on a unital complex Banach algebra B is
continuous and satisﬁes ∥φ∥′ = 1. Also, |φ(x)| ≤r(x) for each x.
Proof. Let L := φ−1(0). Then for any x ∈B having an inverse x−1, x ̸∈L.
Thus if y ∈B and r(y) < 1, 1I + y ̸∈L by Theorem 4.16(a). In other words,
φ(y) ̸= −1. Then |φ(y)| < 1, since if |φ(y)| ≥1 then φ(cy) = −1 for c =
−1/φ(y) with |c| ≤1, and so by (4.6), r(cy) < 1.
It follows that |φ(x)| ≤1 whenever r(x) ≤1, and so whenever ∥x∥≤1 by
the deﬁnition (4.5) of r(x). By homogeneity (4.6), |φ(x)| ≤r(x) for all x. 2
Let X be a vector space over K and M a linear subspace. Then the quotient
space X/M is deﬁned as the set of all cosets x + M := {x + u: u ∈M} for
all x ∈X, with x + M = y + M if and only if x −y ∈M. If x, y ∈X and
c ∈K let (x + M) + (y + M) := x + y + M and c(x + M) := cx + M. It is
easily checked that these cosets are well deﬁned, and with these operations,
X/M is a vector space over K.
If (X, ∥·∥) is a normed linear space, let ∥x+M∥:= inf{∥x+u∥: u ∈M}.
We then have the following.
Proposition 4.25. Let (X, ∥· ∥) be a normed linear space and M a closed
linear subspace. Then
(a) (X/M, ∥· ∥) is a normed linear space;
(b) if X is complete (a Banach space), so is X/M.
Proof. For any x, y ∈X and u, v ∈M we have ∥x+y+u+v∥≤∥x+u∥+∥y+v∥,
so ∥x + y + M∥≤∥x + M∥+ ∥y + M∥. For any c ∈K with c ̸= 0 we have
∥cx+cu∥= |c|∥x+u∥and ∥cx+v∥= |c|∥x+(v/c)∥, so ∥c(x+M)∥= |c|∥x+M∥.
For c = 0, we have ∥0 + M∥= 0. Thus ∥· ∥on X/M is a seminorm.
If x ̸∈M but ∥x + M∥= 0, then ∥x + un∥→0 for some un ∈M, so
−un →x, a contradiction since M is closed. Thus ∥· ∥on X/M is a norm,
proving (a).

224
4 Banach Algebras
Suppose X is complete and let {xn+M}n≥1 be a Cauchy sequence in X/M.
For each k = 1, 2, . . . , there is an nk such that ∥(xn + M) −(xm + M)∥< 2−k
for n ≥m ≥nk. We can assume n1 < n2 < · · · . Recursively, a sequence yn ∈
xn +M will be deﬁned. Let yn := xn for n = 1, . . . , n1. Given yn ∈xn +M for
n ≤nk for some k, let nk < m ≤nk+1. Since ∥(xm +M)−(ynk +M)∥< 2−k,
take ym := xm+u for some u ∈M such that ∥ym−ynk∥< 2−k. This completes
the recursive deﬁnition of yn. For each k, we have ∥yn −ynk∥< 21−k for all
n ≥nk. Thus {yn}n≥1 is a Cauchy sequence in X and yn →y for some y ∈X.
Then xn + M →y + M, proving (b) and completing the proof of Proposition
4.25.
2
Theorem 4.26. Let B be a commutative unital Banach algebra over C and
I a maximal ideal in B. Then for each x ∈B, x = z1I + u for some unique
z ∈C and u ∈I, and B/I with the multiplication (x + I)(y + I) := xy + I is
a Banach algebra isometric to C via the correspondence z1I + I ↔z.
Proof. Recall that a maximal ideal is closed (Theorem 4.21(c)) and the multi-
plication in B/I is well deﬁned (before Theorem 4.5). (B/I, ∥· ∥) is a Ba-
nach space by Proposition 4.25. For any x, y ∈B and u, v ∈I we have
(x+u)(y+v) = xy+w with w := xv+uy+uv ∈I, so ∥xy+I∥≤∥x+I∥∥y+I∥.
B/I is unital, with identity 1I + I. If ∥1I + u∥< 1 then −u is invertible by
Theorem 4.16(b), so u ̸∈I, recalling that a maximal ideal is proper. Thus
∥1I + I∥= 1, and B/I is a Banach algebra.
If x ̸∈I, suppose x + I is not invertible. Let L := {xy + u: y ∈B, u ∈I}.
Then L is an ideal. If xy + u = 1I then (x + I)(y + I) = 1I + I, a contradiction.
So L is a proper ideal, but it strictly includes I, again a contradiction. So
every nonzero element of B/I is invertible. The conclusions of the theorem
follow from Theorem 4.19.
2
Corollary 4.27. For any commutative unital Banach algebra B over C, there
is a 1-to-1 correspondence between maximal ideals I in B and characters φ of
B, given by I = φ−1(0), φ(z1I + u) = z for all u ∈I and z ∈C.
Deﬁnition 4.28. Let B be a commutative unital Banach algebra B over C.
For x ∈B and φ ∈M(B), let bx(φ) := φ(x). Then bx called the Gelfand
transform of x.
On the set of characters M(B) of a Banach algebra B, the Gelfand topology
τ is the weak-star topology of pointwise convergence on B, or equivalently,
pointwise convergence on the closed unit ball B1 := {x ∈B: ∥x∥≤1}. Since
a pointwise limit of characters is a character, and each character takes B1
into {z ∈C: |z| ≤1} by Theorem 4.24, the Gelfand topology is compact by
Tychonoﬀ’s theorem (e.g. [53, Theorem 2.2.8]). It is Hausdorﬀsince distinct
characters are unequal at some point.

4.4 Holomorphic Functions of Banach Algebra Elements
225
If B is a commutative unital Banach algebra B over C then we always
assume that M(B) is equipped with the Gelfand topology. Then bx is a con-
tinuous complex-valued function on M(B) for each x ∈B. Also, the mapping
x 7→bx is an algebra homomorphism of B into C(M(B); C), the Banach algebra
of continuous complex-valued functions on M(B).
Theorem 4.29. For any unital commutative complex Banach algebra B over
C and x ∈B, the range ran bx equals σ(x).
Proof. If z ∈ran bx, suppose z ̸∈σ(x). Then z1I −x has an inverse v. Thus
(z −bx)bv ≡1, but at φ such that bx(φ) = z, this gives a contradiction, so
ran bx ⊂σ(x).
Conversely let z ∈σ(x), so z1I −x is not invertible. Then L := {(z1I −
x)y: y ∈B} is a proper ideal in B. By Theorem 4.4, it is included in some
maximal ideal I. By Corollary 4.27, let φ be a character with I = φ−1(0).
Then for y = 1I we get bx(φ) = φ(x) = z, so z ∈ran bx, completing the proof.
2
Corollary 4.30. For any commutative unital Banach algebra B over C and
x ∈B, we have r(x) = ∥bx∥sup.
Proof. This follows from Theorems 4.29 and 4.20.
2
4.4 Holomorphic Functions of Banach Algebra Elements
Let f be a complex valued holomorphic function on a disk B(z0, r) ⊂C for
some z0 ∈C and r > 0 with a Taylor expansion around z0
f(z) =
∞
X
k=0
ak(z −z0)k
for each z ∈B(z0, r). Then r ≤1/ lim supk→∞|ak|1/k, and the series con-
verges absolutely by Proposition 2.96. We have ak = f (k)(z0)/k! for each k by
Proposition 2.100. Moreover, for any unital complex Banach algebra B, the
series
f(x) :=
∞
X
k=0
ak(x −z01I)k,
(4.11)
where (x−z01I)0 := 1I, converges absolutely in B whenever the spectral radius
r(x−z01I) is less than r. We will extend deﬁnition (4.11) using Cauchy formulas
for curves in the complex plane.
Recall that contour integrals of suitable Banach-valued functions were de-
ﬁned in Section 2.10. For a curve ζ(·): [a, b] →C with a < b, the reversed
curve will mean the curve η(t) := ζ(a + b −t) for t ∈[a, b]. We have

226
4 Banach Algebras
I
η(·)
f(η) dη = −
I
ζ(·)
f(ζ) dζ
by a change of variables for RS integrals (Proposition 2.77 and Theorem 2.42).
A chain will be a formal linear combination C = Pk
i=1 niζi, where ζi(·) are
curves and ni ∈Z. Let −ζ be the reversed curve of ζ for any ζ, and let
I
C
f(ζ) dζ :=
k
X
i=1
ni
I
ζi(·)
f(ζi) dζi,
where if ni < 0 and ηi(·) = −ζi(·), then ni
H
ζi(·) f(ζi) dζi = −ni
H
ηi(·) f(ηi) dηi.
So niζi = (−ni)(−ζi) and the notation is consistent. Also in Section 2.10, the
winding number w(ζ(·), z) of a closed curve ζ(·) around a point z not in the
range of ζ(·) is deﬁned just after Deﬁnition 2.92. The winding number w(C, z)
of a chain C = Pk
i=1 niζi, where ζi are piecewise C1 curves, with respect to
a point z ̸∈Pk
i=1 ran (ζi) is deﬁned as w(C, ζ) := Pk
i=1 niw(ζi(·), z). The
deﬁnition is the extension of the conclusion of Proposition 2.93 to chains. The
property “simply connected” is characterized in Theorem 2.105.
Theorem 4.31. Let B be a unital Banach algebra over C and x ∈B. Suppose
U is a connected and simply connected open set in C and K is a compact set
such that σ(x) ⊂K ⊂U. Let ζ(·) be a piecewise C1 closed curve with range
ran (ζ) ⊂U \K such that w(ζ(·), z) = 1 for all z ∈K. Let f be a holomorphic
function from U into C and let
f(x; ζ(·)) :=
1
2πi
I
ζ(·)
f(ζ)(ζ1I −x)−1 dζ.
(4.12)
Then
(a) the integral f(x; ζ(·)) is well deﬁned in B, and does not depend on ζ(·)
with the given properties;
(b) if U = B(z0, r) for some z0 ∈C and r > 0 then the deﬁnitions (4.11) and
(4.12) agree;
(c) if B is commutative, then for F(x) := f(x; ζ(·)), we have for the Gelfand
transforms that [
F(x) ≡f◦bx on M(B).
Proof. For (a), on U \ σ(x), which includes ran (ζ), both f and, by Theorem
4.18(b), z 7→(z1I −x)−1, are holomorphic, thus continuous by Proposition
2.96. So the integrand in (4.12) is bounded and continuous on ran (ζ) and the
integral f(x, ζ(·)) is deﬁned. Let ζ1(·) and ζ2(·) be two curves both satisfying
the hypotheses of Theorem 4.31. Take any continuous linear form L ∈B′.
Then ζ 7→L((ζ1I −x)−1) is holomorphic from C \ σ(x) into C. Consider the
chain C = ζ1 −ζ2, and let V := U \K. Then V is no longer simply connected,
but ζ1 and ζ2 both take values in V . We have w(C, z) = 1 −1 = 0 for each
z ∈K by hypothesis. For z ̸∈U we have w(ζi(·), z) = 0 for i = 1, 2 by

4.4 Holomorphic Functions of Banach Algebra Elements
227
Theorem 2.105. Thus w(C, z) = 0 for all z ̸∈V , and C is homologous to 0
in V as deﬁned in Ahlfors [1, 2d ed., §4.4.4, Deﬁnition 2]. So we can apply
the Cauchy integral theorem in the form given by Ahlfors [1, 2d ed., §4.4.4,
Theorem 18] to ζ 7→f(ζ)L((ζ1I −x)−1), which is holomorphic on V . Thus by
Proposition 2.78,
L(f(x; ζ1(·))) =
1
2πi
I
ζ1(·)
f(ζ)L((ζ1I −x)−1) dζ
=
1
2πi
I
ζ2(·)
f(ζ)L((ζ1I −x)−1) dζ = L(f(x; ζ2(·))).
(4.13)
By the Hahn–Banach theorem it follows that f(x; ζ1(·)) = f(x; ζ2(·)), proving
(a).
For (b), it is easily checked that for any x ∈B and z0 ∈C, σ(z −z01I) =
σ(x) −z0 := {z −z0 : z ∈σ(x)}. Since σ(x) ⊂U = B(z0, r), by Theorem
4.20 it then follows that r(x −z01I) < r. Let r(x −z01I) < t < r and let
ζ(θ) = z0 + teiθ, 0 ≤θ ≤2π. For each ζ = ζ(θ) ∈ran (ζ), by (4.6) and
Theorem 4.16(a), 1I −(ζ −z0)−1(x −z01I) is invertible and
(ζ1I −x)−1 =
1
ζ −z0

1I −x −z01I
ζ −z0
−1
=
∞
X
k=0
(x −z01I)k
(ζ −z0)k+1 ,
where the series converges absolutely in B and uniformly on ran (ζ). Integrat-
ing term by term and using the Cauchy formulas for f and its derivatives
(Proposition 2.97 and Theorem 2.98), it follows that
f(x; ζ(·)) =
1
2πi
I
ζ(·)
f(ζ)
∞
X
k=0
(x −z01I)k
(ζ −z0)k+1 dζ =
∞
X
k=0
f (k)(z0)
k!
(x −z01I)k,
which equals f(x) as deﬁned by (4.11).
For (c), let φ ∈M(B). For any z ̸∈σ(x), we ﬁnd that φ((z1I −x)−1) =
1/(z −φ(x)). Since the range of ζ is included in U \σ(x), interchanging φ with
H
ζ(·) as in (4.13), we have
[
F(x)(φ) = φ(F(x)) =
1
2πi
I
ζ(·)
f(ζ) dζ
ζ −φ(x) = f(φ(x)) = (f◦bx)(φ)
by the Cauchy integral formula (Theorem 2.107) since φ(x) ∈σ(x) by Theo-
rem 4.29, so w(ζ(·), φ(x)) = 1 by assumption. Thus (c) follows and the theorem
is proved.
2
Curves satisfying the hypotheses of Theorem 4.31 always exist:
Lemma 4.32. Let U be a connected, simply connected, nonempty open set
in C, and let K be a compact subset of U. Then there is a C∞simple closed
curve ζ(θ), 0 ≤θ ≤2π, with range ran (ζ) ⊂U \ K, ζ′(θ) ̸= 0 for all θ, and
winding number w(ζ(·), z) = 1 for all z ∈K.

228
4 Banach Algebras
Proof. If U = C then a circle with center at zero and suﬃciently large radius
will satisfy the conclusion. Therefore we can suppose that U ̸= C. By the
Riemann mapping theorem (e.g. Greene and Krantz [86, p. 344] or Ahlfors [1,
p. 222]), let T be a one-to-one, holomorphic function from U onto the unit
disk D := B(0, 1). Then T ′(z) ̸= 0 for all z ∈U and the inverse function
T −1 is holomorphic from D onto U (e.g. Stein and Shakarchi [224, p. 206]).
The image T (K) is compact in D, and so ρ := sup{|z|: z ∈T (K)} < 1. Let
r ∈(ρ, 1) and ζ(θ) := T −1(reiθ), 0 ≤θ ≤2π. Then ζ(·) is a C∞simple closed
curve in U, where ζ′(θ) ̸= 0 for all θ by the chain rule and since for each z ∈D,
(T −1)′(z) = 1/T ′(T −1(z)) ̸= 0, with range C := ran (ζ) and ζ′(0) = ζ′(2π).
We will show that ζ(·) satisﬁes the conclusion of the lemma.
Let D1 := B(0, r), D2 := {z ∈C: r < |z| < 1} and Ui := T −1(Di),
i = 1, 2. Then C is the disjoint union U1 ∪C ∪U2 ∪U c of nonempty sets.
The set U1 is connected, open, and simply connected because D1 has these
properties (e.g. by Theorem 2.105(d)). By the Jordan curve theorem, proved
for piecewise C1 simple closed curves in Stein and Shakarchi [224, Appendix
B, Theorem 2.2], the complement of the range C of ζ(·) consists of two disjoint
connected open sets V1 and V2, where V1 is bounded and simply connected
and V2 is neither. We will show that U1 = V1.
We have U c ⊂Cc = V1 ∪V2. We claim that V1 ⊂U. Suppose U c ∩V1 ̸= ∅
and choose p ∈U c ∩V1. Let Fp be the component of p in U c, given e.g.
by Theorem 2.102. Then Fp is closed in the relative topology of U c, and so
Fp ⊂V1 since V1 and V2 are open and disjoint. But then Fp is bounded,
contradicting the fact that U is simply connected, e.g. Theorem 2.105(c).
Thus the claim V1 ⊂U (= U1 ∪C ∪U2) holds. Since V1 ∩C = ∅, we have
V1 ⊂U1 ∪U2. Since V1 is connected and Ui, i = 1, 2, are disjoint and open,
V1 ⊂U1 or V1 ⊂U2. Likewise U1 ⊂V1 or U1 ⊂V2. If U1 ⊂V2 then U2 ⊂V1
and U2 = V1 since V1 ⊂U. Now U1 ∪C = T −1({z : |z| ≤r}) is compact
and V1 ∪C = V c
2 is closed and bounded, thus compact. It then follows that
U = (U1 ∪C) ∪(V1 ∪C) is compact, a contradiction. Thus U1 ⊂V1, and so
V1 ⊂U2 is impossible, proving V1 ⊂U1. Therefore we have U1 = V1.
Since K ⊂U1, by Theorem 2.2 in Appendix B of Stein and Shakarchi
[224, p. 351], w(ζ(·), z) = k for all z ∈K, where k = ±1. By reversing the
direction of ζ(·) if necessary, we can make k = +1, proving the lemma.
2
Note. There is actually never a need to reverse the direction of ζ(·) in the
preceding proof, as follows. Let TR be the transformation from an open set in
R2 into R2 deﬁned by T from the Riemann mapping theorem and z = x+iy ∈
U, (x, y) ∈R2. Then the Jacobian determinant of TR at (x, y) is easily shown
to equal |T ′(z)|2 > 0. It follows that T (or T −1) preserves the winding number
(+1 or −1) of a simple closed curve around points inside it, e.g. [178, Theorem
VII.11.2, p. 198]. (The statement there, for transformations whose domain is
the whole plane, extends to cover the present situation.)

4.4 Holomorphic Functions of Banach Algebra Elements
229
By Theorem 4.31(a) and Lemma 4.32, the following notation is well de-
ﬁned.
Deﬁnition 4.33. Let B be a unital Banach algebra over C, let x ∈B, and let
U be a connected and simply connected open set in C such that σ(x) ⊂U. For
any holomorphic function f : U →C deﬁne f(x) := f(x; ζ(·)) ∈B by (4.12),
where ζ(·) is a piecewise C1 simple closed curve with range ran (ζ) ⊂U \σ(x)
and winding number w(ζ(·), z) = 1 for all z ∈σ(x).
A mapping (f, x) 7→f(x) for f and x satisfying the conditions of Deﬁnition
4.33 is sometimes called a functional calculus, e.g. Dales [36, p. 212].
First we apply this mapping to show that a composition f◦g is in a unital
Banach algebra of functions B if g ∈B and f is a holomorphic function on a
suitable open set including the spectrum of g.
Proposition 4.34. Let B be a unital Banach algebra of C-valued functions
on a nonempty set S and g ∈B. For a connected, simply connected open set
U ⊂C including the spectrum σ(g), let f be holomorphic on U. Then f◦g ∈B
and f◦g = f(g) as deﬁned in Deﬁnition 4.33.
Proof. For each s ∈S, the evaluation es ∈M(B), and so g(s) = bg(es) ∈
σ(g) ⊂U by Theorem 4.29. Then by Theorem 4.31(c), for each s ∈S, we
have
f(g)(s) = d
f(g)(es) = f(bg(es)) = (f◦g)(s),
so f(g) = f◦g, proving the proposition.
2
Second we apply functional calculus to the exponential. Let B be a complex
unital Banach algebra B. Given x ∈B, let U be a disk B(0, R) in C such
that σ(x) ⊂U. The Taylor expansion around 0 of the exponential function
exp(·): U →C gives the Taylor series P∞
k=0 zk/k!, which converges absolutely
and uniformly. Let ζ(θ) := reiθ, 0 ≤θ ≤2π, for some r close enough to R.
Then by Theorem 4.31(b)
exp(x) = exp(x; ζ(·)) =
∞
X
k=0
xk/k!.
(4.14)
Here exp(x) is deﬁned for any x ∈B and the power series (4.14) converges
absolutely and uniformly on any bounded set in B.
Lemma 4.35. If B is a unital Banach algebra, and x and y are elements of
B which commute, then exp(x + y) = exp(x) exp(y).
Proof. Let x, y ∈B be such that xy = yx. For each positive integer n, let
Cn := {0 ≤i, j ≤n: i + j ≤n}. Using the binomial formula, we have

230
4 Banach Algebras
n
X
k=0
(x + y)k
k!
=
n
X
k=0
k
X
i=0
xiyk−i
i!(k −i)! =
X
i,j∈Cn
xiyj
i!j!
for each n. Therefore
n
X
i=0
xi
i!
n
X
j=0
yj
j! −
n
X
k=0
(x + y)k
k!
=
X
i,j∈Dn
xiyj
i!j! ,
where Dn := {0 ≤i, j ≤n: i + j > n}. The norm of the right side is not
greater than
X
i,j∈Dn
∥x∥i∥y∥j
i!j!
=
n
X
i=0
∥x∥i
i!
n
X
j=0
∥y∥j
j!
−
n
X
k=0
(∥x∥+ ∥y∥)k
k!
→e∥x∥e∥y∥−e∥x∥+∥y∥= 0,
as n →∞, proving the conclusion.
2
Next we will deﬁne the logarithm of a suitable Banach algebra element.
To make the logarithm operation inverse to the exponential we will use the
following result.
Proposition 4.36. Let B be a unital Banach algebra over C, let x ∈B, and
let U be a connected, simply connected, nonempty open set in C such that
σ(x) ⊂U. If f : U →C and g: C →C are holomorphic functions on their
domains then (g◦f)(x) = g(f(x)).
Proof. Since σ(x) is compact by Theorem 4.18(a), by Lemma 4.32 applied to
K = σ(x), there is a C∞simple closed curve η(·) such that ran (η) ⊂U \σ(x)
and w(η(·), z) = 1 for all z ∈σ(x). By the Jordan curve theorem (e.g. Theorem
2.2 in Stein and Shakarchi [224, p. 351]), the complement of the range of η(·)
consists of two disjoint connected open sets V1 and V2, where V1 is bounded,
simply connected and w(η(·), z) = 1 if z ∈V1 and = 0 if z ∈V2. Thus
K := V1 ∪ran (η) = V c
2 is compact and σ(x) ⊂V1 ⊂K. By Lemma 4.32 once
again, there is a C∞simple closed curve ζ(·) such that ran (ζ) ⊂U \ K and
w(ζ(·), z) = 1 for all z ∈σ(x). Let h be another complex-valued holomorphic
function on U. Then f(x), h(x) and (fh)(x) in B are deﬁned as in Deﬁnition
4.33. We claim that (fh)(x) = f(x)h(x) in B. To show this, by (4.12), we have
f(x)h(x) =
 1
2πi
2 I
ζ(·)
I
η(·)
f(ζ)h(η)(ζ1I −x)−1(η1I −x)−1 dζdη.
Using the resolvent equation (4.9), for each ζ, η ∈C \ σ(x), we have
(ζ1I −x)−1(η1I −x)−1 = (η −ζ)−1(ζ1I −x)−1 + (ζ −η)−1(η1I −x)−1.

4.5 Complexiﬁcation of Real Banach Algebras
231
By the Cauchy integral formula (Theorem 2.107),
H
η(·) h(η)(η−ζ)−1 dη = 0 for
each ζ ∈ran (ζ) since ran (ζ) ⊂V2, and so w(η(·), ζ) = 0 for each ζ ∈ran(ζ).
By the Cauchy integral formula once again, it then follows that
f(x)h(x) =
 1
2πi
2 I
η(·)
h(η)(η1I −x)−1h I
ζ(·)
f(ζ)(ζ −η)−1 dζ
i
dη
=
1
2πi
I
η(·)
h(η)f(η)(η1I −x)−1 dη = (fh)(x),
proving the claim. Using the claim and induction on k, it follows that for each
positive integer k, f k(x) = f(x)k, and so
f(x)k =
1
2πi
I
ζ(·)
f(ζ)k(ζ1I −x)−1dζ.
Since g is holomorphic on the whole plane, it has a Taylor expansion around
0, g(z) = P∞
k=0 akzk for each z ∈C, which converges absolutely. Since the
composition g◦f is holomorphic on U, applying (4.12) to (g◦f)(x), the Taylor
expansion of g at z = f(ζ), ζ ∈ran (ζ), and then integrating term by term,
we have
(g◦f)(x) =
∞
X
k=0
ak
2πi
I
ζ(·)
f(ζ)k(z1I −x)−1 dζ =
∞
X
k=0
akf(x)k = g(f(x)),
where the last equality holds by Theorem 4.31(b). The proof of the proposition
is complete.
2
Finally, we apply Deﬁnition 4.33 and Proposition 4.36 to deﬁne the log-
arithm. Let g(w) = ew = exp(w) from C into C and let f(z) := log z as a
holomorphic function on U := {z ∈C: |z −1| < 1} with f(1) := log 1 := 0.
Let x ∈B satisfy ∥x −1I∥< 1. To show that σ(x) ⊂U let |z −1| ≥1. Then
z1I −x = (z −1)(1I + (z −1)−1(1I −x)) is invertible by Theorem 4.16(a) since
∥(z−1)−1(1I−x)∥< 1, and so z ̸∈σ(x), proving σ(x) ⊂U. Thus we can deﬁne
f(x) = log x and we have exp(log(x)) = x for any such x by Proposition 4.36.
Moreover, by Theorem 4.31(b), it follows that
log x =
∞
X
k=1
f (k)(1)
k!
(x −1I)k = −
∞
X
k=1
(1I −x)k/k,
(4.15)
and the series converges absolutely.
4.5 Complexiﬁcation of Real Banach Algebras
We next see how a real Banach algebra can be embedded in a complex one.

232
4 Banach Algebras
Deﬁnition 4.37. Let A be an algebra over R. Then the complexiﬁcation AC
of A is the set A × A, with operations deﬁned as follows: for u, v, x, y ∈A and
a, b ∈R, let
(u, v) + (x, y) := (u + x, v + y),
(u, v)·(x, y) := (ux −vy, uy + vx),
(a + ib)(u, v) := (au −bv, av + bu).
The following is straightforward to check:
Proposition 4.38. For any algebra A over R, the complexiﬁcation AC as just
deﬁned is an algebra over C. The map u 7→(u, 0) is 1-to-1 from A into AC
and preserves real algebra operations. If A is unital with identity 1IA, then so
is AC with identity 1I := (1IA, 0).
Via x ↔(x, 0), we can view A as a real subalgebra of AC, just as we view
R as a subset of C. Then we can write for each (u, v) ∈AC, (u, v) = u+iv, and
each such (u, v) can be written in multiple ways as a ﬁnite sum Pn
j=1 zjxj for
zj ∈C and xj ∈A.
Theorem 4.39. Let (A, ∥· ∥) be a real Banach algebra. For each w in the
complexiﬁcation AC, let
|||w||| := inf
n
n
X
j=1
|zj|∥xj∥: w =
n
X
j=1
zjxj, zj ∈C, xj ∈A, n = 1, 2, . . .
o
.
Then
(a) ||| · ||| is a Banach algebra norm on AC;
(b) max{∥u∥, ∥v∥} ≤|||(u, v)||| ≤∥u∥+ ∥v∥for any (u, v) ∈AC;
(c) |||(u, 0)||| = ∥u∥for each u ∈A.
Proof. If A = {0} there is no problem, so suppose A ̸= {0}. From the deﬁnition
it is straightforward to check that ||| · ||| is a seminorm on the complex vector
space AC. Also, |||u + iv||| ≤∥u∥+ ∥v∥, proving the right side of (b).
If |||w||| < 1 for w = (u, v) ∈AC, then for some n = 1, 2, . . ., zj ∈C,
and xj ∈A we have w = Pn
j=1 zjxj with Pn
j=1 |zj|∥xj∥< 1. Let zj =
aj + ibj for aj, bj ∈R. Then u = Pn
j=1 ajxj and v = Pn
j=1 bjxj with
max{Pn
j=1 |aj|∥xj∥, Pn
j=1 |bj|∥xj∥} < 1, so ∥u∥< 1 and ∥v∥< 1. It fol-
lows that for any w = (u, v) ∈AC, max{∥u∥, ∥v∥} ≤|||w|||, proving the left
side of (b) and showing that |||·||| is a norm on AC. Clearly, (b) implies (c). Also,
if {wn}∞
n=1 = {(un, vn)}∞
n=1 is a Cauchy sequence for ||| · |||, it is convergent by
(b), so (AC, ||| · |||) is a Banach space.
Let w = Pm
i=1 cixi and z = Pn
j=1 djyj for some m, n; ci, dj ∈C; and
xi, yj ∈A. Then wz = Pm
i=1
Pn
j=1(cidj)(xiyj) where

4.6 A Substitution Rule for the Kolmogorov Integral
233
m
X
i=1
n
X
j=1
|cjdj|∥xiyj∥≤
 m
X
i=1
|ci|∥xi∥

n
X
j=1
|dj|∥yj∥

.
Thus |||wz||| ≤|||w||| |||z||| and ||| · ||| is submultiplicative (4.2).
Suppose AC is unital and let 1I = (u, v) ̸= (0, 0) be its identity. Then for
any x, y ∈A, xu −yv = ux −vy = x. Letting y = 0 gives that u is an identity
1IA of A. Then vy = yv = 0 for all y, speciﬁcally y = u, gives v = 0. Thus
1I = (1IA, 0) and |||1I||| = ∥1IA∥= 1, proving (a), and so the theorem.
2
The complex Banach algebra (AC, ||| · |||) given by Theorem 4.39 will be
called the Banach algebra complexiﬁcation of A.
Let (B, ∥· ∥) be a Banach algebra of real-valued functions as deﬁned
in Deﬁnition 4.11. Then its Banach algebra complexiﬁcation (BC, ||| · |||) can
naturally be viewed as a Banach algebra of complex-valued functions, with
BC = {f + ig: f, g ∈B}.
4.6 A Substitution Rule for the Kolmogorov Integral
The Banach algebra property of Wp spaces of functions with values in a Ba-
nach algebra (Proposition 4.13) will be used to prove a substitution rule for
the Kolmogorov integral, like those considered for Riemann–Stieltjes integrals
at the end of Section 3.6. Recall that for 1 ≤p < ∞, Qp := [1, p/(p −1)) if
p > 1, Q1 := {+∞}, and W∞= R is the class of regulated functions.
Proposition 4.40. Assume that B is a Banach algebra over K and (1.14)
holds with Y = Z = B. Let α ∈AIp([a, b]; X) for 1 ≤p < ∞and let
f, g ∈Wq([a, b]; B) for q ∈Qp. Then for µ(A) :=
R
=A dα·g, A ∈I[a, b],
µ is an interval function in AIp([a, b]; B), and the two integrals
R
=[a,b] dµ f,
R
=[a,b] dα·(gf) exist and are equal.
Proof. We can assume that a < b. By Proposition 3.96, we have that µ is
deﬁned and is in AIp([a, b]; B). By Proposition 4.13, fg ∈Wq([a, b]; B), and
so the two integrals are deﬁned. To prove that they are equal, let ǫ > 0.
Since g is regulated, by Theorem 2.1, there exists a point partition {zj}m
j=0
of [a, b] such that Osc(g; (zj−1, zj)) < ǫ for each j = 1, . . . , m. Let T
=
({(ti−1, ti)}n
i=1, {si}n
i=1) be a tagged Young interval partition of [a, b] which
is a tagged reﬁnement of the Young interval partition λ := {(zj−1, zj)}m
j=1.
Letting Ai := (ti−1, ti) for each i, we have
SYS(dµ, f; T ) −SYS(dα, gf; T )

=

n
X
i=1
µ(Ai)f(si) −α(Ai)·[g(si)f(si)]
 ≤∥f∥sup
n
X
i=1

R
=
Ai
dα·

g −g(si)
.

234
4 Banach Algebras
If p = 1, then using (3.69), it follows that
n
X
i=1

R=
Ai
dα·

g −g(si)
 ≤max
1≤i≤n Osc(g; Ai)
n
X
i=1
v1(α; Ai) < ǫv1(α).
If p > 1 then for q′ ∈(q, p/(p−1)), by the Love–Young inequality (3.150) and
Lemma 3.45, we have
n
X
i=1

R
=
Ai
dα·

g −g(si)
 ≤Kp,q′
n
X
i=1
∥g∥Ai,(q′)∥α∥Ai,(p)
≤ǫ1−(q/q′)Kp,q′
n
X
i=1
vq(g; Ai)1/q′vp(α; Ai)1/p ≤ǫ1−(q/q′)Kp,q′vq(g)1/q′∥α∥(p),
where the last inequality holds by H¨older’s inequality (1.4) and by (3.69). Since
T is an arbitrary tagged Young interval partition of [a, b] which is a reﬁnement
of λ, and since ǫ > 0 is arbitrary, we have that
R
=[a,b] dµ f =
R
=[a,b] dα·(gf),
proving the proposition.
2
4.7 Notes
Notes on Section 4.1. There are numerous books giving expositions of the basic
theory of Banach algebras. For example, the fact that a unit can be adjoined
if needed (Proposition 4.7) is given in Larsen [133, Theorem 1.1.5]. Often the
multiplication in a Banach algebra is taken to satisfy ∥xy∥≤∥x∥∥y∥for all
x, y by deﬁnition, e.g. [216, p. 209]. Theorem 4.8 showed that this inequality
can be obtained by renorming. The theorem holds also when (x, y) 7→xy need
only be continuous in x for each y and in y for each x, as I. M. Gelfand proved;
see e.g. Theorem 1.3.1 of Larsen [133].
Notes on Section 4.2. Belﬁand Doran [13] write: “commutative Banach
algebras enjoy a remarkably complete and beautiful structure theory due, in
large part, to the eﬀorts of a single man, I. M. Gelfand.” A basic paper was
Gelfand [76]. An earlier related announcement was Gelfand [75]. A book on the
theory of commutative Banach algebras is Gelfand, Raikov, and Shilov [77].
According to Belﬁand Doran [13], Theorem 4.19 was announced by Mazur
[162], with a ﬁrst published proof by Gelfand [76].
Notes on Section 4.3. Proposition 4.25 is a classical fact in functional
analysis. It was stated e.g. by Dunford and Schwartz [57, pp. 88–89]. They
say that it was ﬁrst discovered and published by Banach in the ﬁrst, 1931,
edition in Polish [7] of his classic book Th´eorie des op´erations lin´eaires [8]
published in French in 1932. Meanwhile, Hausdorﬀ[89] in 1932 independently
also discovered the quotient space by a closed linear subspace.

4.7 Notes
235
In Banach [8] we have not found quotient spaces very explicitly. In Chapitre
I, §2, Banach considers left and right cosets of subsets (not necessarily sub-
groups) of a not necessarily abelian group with a topology. In Chapitre IV,
§3, Lemme, he considers an element y0 in a normed linear space E at distance
d from a linear subspace G [or its closure ¯G]. [Here d = d(y0) =: d(y0 + G)
deﬁnes the quotient seminorm on E/G, but we did not ﬁnd this formulation
in [8].]
The other facts in Section 4.3 were found by Gelfand ([76], [77]).
Notes on Section 4.4. Theorem 4.31 is also due to Gelfand ([76] and [77,
I.§6, Theorem 1])
Notes on Section 4.5. Theorem 4.39 is essentially Proposition 3 in §13 of
Bonsall and Duncan [22]. The norm ||| · ||| is the same as in Theorem 1.3.5(ii)
in Ruston [200], where it is shown to be the largest among all admissible
norms, that is, those satisfying Theorem 4.39(b). Ruston [200, p. 221] and Kir-
wan [117] give references to earlier results on complexiﬁcation of real normed
spaces. On the norm ||| · ||| as a tensor product norm see also Section 5.4.
Notes on Section 4.6. Proposition 4.40 had many predecessors with interval
functions α, µ replaced by point functions (e.g. Propositions 2.86, 3.100, and
3.101). In its present form, the substitution rule is stated here for the ﬁrst
time as far as we know.


5
Derivatives and Analyticity in Normed Spaces
All of the vector spaces that we consider in this chapter will be deﬁned over
a ﬁeld K which will be either the ﬁeld R of real numbers or the ﬁeld C of
complex numbers.
Let X and Y be normed spaces with the norm on each denoted by ∥·∥, and
let U be an open subset of X. Let L(X, Y ) denote the space of all bounded
linear operators from X into Y . A function (nonlinear operator) F : U →Y
is called (Fr´echet) diﬀerentiable or has a (Fr´echet) derivative at u ∈U if there
exists an Lu ∈L(X, Y ) such that for each x ∈X with u + x ∈U,
(∆F)(x) := F(u + x) −F(u) = Lux + RemF (u, x),
(5.1)
where ∥RemF (u, x)∥= o(∥x∥) as ∥x∥→0. It follows that ∥(∆F)(x)∥=
O(∥x∥) as ∥x∥→0, and so F is continuous at u. The linear operator Lu is
easily seen to be unique, is called the derivative of F at u, and is denoted by
DF(u). If the function F is diﬀerentiable at each u ∈U then we say that F
is diﬀerentiable on U, and we call the map D1F := DF : U →L(X, Y ) the
ﬁrst derivative of F. The diﬀerence RemF (u, x) = (∆F)(x) −Lux is called
the remainder in the diﬀerentiation of F.
We will recall some basic facts about diﬀerentiation. The ﬁrst one concerns
diﬀerentiability of composition mappings.
Theorem 5.1 (Chain rule). Let X, Y, Z be three normed spaces, U an open
neighborhood of u ∈X, F a mapping of U into Y , v = F(u), V an open
neighborhood of v in Y , and G a mapping of V into Z. If F is diﬀerentiable
at u and G is diﬀerentiable at v, then the composition mapping G◦F deﬁned
by (G◦F)(u) := G(F(u)) is diﬀerentiable at u and
D(G◦F)(u) = DG(v)◦DF(u).
Proof. For each x ∈X with u + x ∈U, using the notation (5.1), we have
RG◦F (u, x) := (G◦F)(u + x) −(G◦F)(u) −(DG(v)◦DF(u))x
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_5, 
237

238
5 Derivatives and Analyticity in Normed Spaces
= [G(v + (∆F)(x)) −G(v) −DG(v)(∆F)(x)] + DG(v)RemF (u, x).
Since G is diﬀerentiable at v = F(u) and F is continuous at u, we have
∥G(v + (∆F)(x)) −G(v) −DG(v)(∆F)(x)∥= o(∥(∆F)(x)∥)
as ∥x∥→0. Since F is diﬀerentiable at u, we have ∥(∆F)(x)∥= O(∥x∥) and
∥RemF (u, x)∥= o(∥x∥) as ∥x∥→0. Thus ∥RG◦F (u, x)∥= o(∥x∥) as ∥x∥→0,
proving the theorem.
2
Remark 5.2. A bounded linear operator A from Y to Z, or B from X to
Y , is clearly Fr´echet diﬀerentiable everywhere and equal to its derivative.
Thus in Theorem 5.1 we have D(A◦F)(u) = (A◦DF)(u), and D(G◦B)(u) =
(DG◦B)(u) if B(u) ∈V .
The second fact is a variant of the mean value theorem, which gives a
bound for the remainder in a diﬀerentiation. For u, u+x ∈X, the line segment
joining u and u + x is the set [u, u + x] := {u + tx: 0 ≤t ≤1}.
Theorem 5.3 (Mean value theorem). Let X, Y be two normed spaces over
K, U an open subset of X, and F a diﬀerentiable mapping of U into Y . If the
segment [u, u + x] is included in U, then
F(u + x) −F(u)
 ≤∥x∥
sup
v∈[u,u+x]
DF(v)
,
(5.2)
F(u + x) −F(u) −DF(u)x
 ≤∥x∥
sup
v∈[u,u+x]
DF(v) −DF(u)
. (5.3)
Proof. To prove (5.2), let φ(t) := F(u + tx) for each t ∈R. By the chain rule,
the function φ is diﬀerentiable from an open neighborhood V of [0, 1] into Y
and Dφ(t) = DF(u + tx)x for each t ∈[0, 1]. By the Hahn–Banach theorem
(Corollary 6.1.5 in [53]), there is a continuous functional f ∈Y ′ (linear over
K) such that ∥f∥′ = 1 and
|f(φ(1) −φ(0))| = ∥φ(1) −φ(0)∥= ∥F(u + x) −F(u)∥.
The derivative of f is the constant mapping Df(y) = f for each y ∈Y .
Then by the chain rule again, the composition f◦φ is diﬀerentiable on V ⊂R
into K and D(f◦φ)(t) = (f◦DF(u + tx))x for each t ∈[0, 1]. Thus by the
ordinary mean value theorem there is a t ∈[0, 1] such that f(φ(1))−f(φ(0)) =
D(f◦φ)(t), and so
|f(φ(1)) −f(φ(0))| ≤sup
t∈[0,1]
|(f◦DF(u + tx))x| ≤∥x∥
sup
v∈[u,u+x]
∥DF(v)∥,
proving (5.2).
The proof of (5.3) is the same except that now we choose a continuous
linear functional f ∈Y ′ with unit norm so that

5.1 Polynomials and Power Series
239
|f(φ(1)−φ(0)−Dφ(0))| = ∥φ(1)−φ(0)−Dφ(0)∥= ∥F(u+x)−F(u)−DF(u)x∥.
Then again by the ordinary mean value theorem there is a t ∈[0, 1] such that
f(φ(1)) −f(φ(0)) −f(Dφ(0))
 =
f◦DF(u + tx)x −f◦DF(u)x

≤∥x∥
sup
v∈[u,u+x]
DF(v) −DF(u)
,
proving the theorem.
2
5.1 Polynomials and Power Series
Finite and inﬁnite Taylor series can be deﬁned for suitable functions from
one normed space to another. To treat such series we will ﬁrst need some
multilinear algebra.
A function A from a Cartesian product V1 × · · · × Vk of k vector spaces
into a vector space V0 is called k-linear if for each j = 1, . . . , k, A(v1, . . . , vk)
is linear in vj for any ﬁxed values of vi, i ̸= j. If Vj = (Vj, ∥· ∥j) are normed
spaces for j = 0, 1, . . . , k, k ≥1, then a k-linear map A: V1 × · · · × Vk →V0
is called bounded if
∥A∥:= sup

∥A(v1, . . . , vk)∥0 : ∥vj∥j ≤1, j = 1, . . . , k
	
< ∞.
(5.4)
This agrees with the usual deﬁnition of operator norm (1.17) if k = 1.
Let Mk(V1, . . . , Vk; V0) be the set of all bounded k-linear maps from
V1 × · · · × Vk into V0 with the norm deﬁned by (5.4). It is easily seen that
Mk(V1, . . . , Vk; V0) with this norm is a Banach space provided (V0, ∥· ∥0) is.
Theorem 5.4. Let (Vj, ∥· ∥j), j = 0, 1, . . . , k, be normed spaces over K and
let L be a k-linear map from V1 × · · · × Vk into V0. Then the following are
equivalent:
(a) L is jointly continuous everywhere;
(b) L is jointly continuous at (0, 0, . . . , 0);
(c) L is bounded.
Proof. (a) ⇒(b) is clear. Assume (b). Then for some δ > 0, ∥xj∥j ≤δ for
j = 1, . . . , k implies ∥L(x1, . . . , xk)∥0 ≤1. It follows by k-linearity that for
any yj ∈Vj, j = 1, . . . , k, ∥L(y1, . . . , yk)∥0 ≤δ−k∥y1∥· · · ∥yk∥, so ∥L∥≤δ−k
and (c) follows.
Assume (c) with ∥L∥= M < ∞. To prove (a), take any xj ∈Vj and
yj ∈Vj for j = 1, . . . , k. Then
L(y1, . . . , yk) −L(x1, . . . , xk) = L(y1 −x1, y2, . . . , yk)
+L(x1, y2 −x2, y3, . . . , yk) + · · · + L(x1, . . . , xk−1, yk −xk),

240
5 Derivatives and Analyticity in Normed Spaces
and so
∥L(y1, . . . , yk) −L(x1, . . . , xk)∥0 ≤M
k
X
j=1
∥xj −yj∥j
Y
i̸=j
max{∥xi∥i, ∥yi∥i}.
Thus for ﬁxed x1, . . . , xk, as yj →xj for each j, the right side tends to zero,
and so L(y1, . . . , yk) →L(x1, . . . , xk), proving (a) and the theorem.
2
Let A be a k-linear map from V1 × · · · × Vk into V0, and let 1 ≤m < k.
For any vj ∈Vj, j = 1, . . . , m, a mapping A(v1, . . . , vm) from Vm+1 × · · · × Vk
into V0 is deﬁned by
A(v1, . . . , vm)(vm+1, . . . , vk) := A(v1, . . . , vm, vm+1, . . . , vk).
(5.5)
Proposition 5.5. Let 1 ≤m < k, let Vj = (Vj, ∥· ∥j), j = 0, 1, . . . , k, be
normed spaces, and let Mk,(m) := Mm(V1, . . . , Vm; Mk−m(Vm+1, . . . , Vk; V0)).
For vj ∈Vj, j = 1, . . . , m, and A ∈Mk := Mk(V1, . . . , Vk; V0), deﬁne
Lm,k(A)(v1, . . . , vm) ∈Mk−m(Vm+1, . . . , Vk; V0) by
Lm,k(A)(v1, . . . , vm) := A(v1, . . . , vm).
Then Lm,k is a linear isometry from Mk onto Mk,(m).
Proof. For any A ∈Mk and vj ∈Vj, j = 1, . . . , m, Lm,k(A)(v1, . . . , vm) is
clearly a (k −m)-linear map of Vm+1 × · · · × Vk into V0 with
Lm,k(A)(v1, . . . , vm)
 ≤∥A∥
m
Y
j=1
∥vj∥j.
Thus Lm,k(A) ∈Mk,(m) and ∥Lm,k(A)∥≤∥A∥. The map Lm,k is clearly
linear.
Conversely, let B ∈Mk,(m) and for any vj ∈Vj, j = 1, . . . , k, let
A(B)(v1, . . . , vk) := B(v1, . . . , vm)(vm+1, . . . , vk). Then from the deﬁnitions,
clearly A(B) is k-linear from V1 × · · · × Vk into V0 with ∥A(B)∥≤∥B∥< ∞,
so A(B) ∈Mk. Evidently Lm,k(A(B)) = B, so Lm,k and B 7→A(B) are
inverses of one another and are linear isometries, completing the proof.
2
Let L be a k-linear function from a Cartesian product V1 × · · · × Vk of k
vector spaces into a vector space V0. If V1 = · · · = Vk = X, then L is deﬁned
on the k-fold product set Xk := V1 × · · · × Vk and is called symmetric if
L(xπ(1), . . . , xπ(k)) = L(x1, . . . , xk) for any permutation π of {1, . . . , k} and
any x1, . . . , xk ∈X. For normed spaces X, Y and an integer k ≥1, let
L(kX, Y ) := Mk(V1, . . . , Vk; Y ), where V1 = V2 = · · · = Vk = X. Thus
L(1X, Y ) = L(X, Y ), with the usual operator norm (1.17). Let Ls(kX, Y )

5.1 Polynomials and Power Series
241
denote the vector subspace of symmetric elements of L(kX, Y ). For k = 0 let
Ls(0X, Y ) := Y . Any L ∈L(kX, Y ) has a symmetrization given by L(s) = L
for k = 0 or 1 and for k ≥2,
L(s)(x1, . . . , xk) := 1
k!
X
π
L(xπ(1), . . . , xπ(k)),
where the sum is over all permutations π of {1, 2, . . ., k}. Clearly L(s) is sym-
metric and if L is symmetric, then L(s) = L. For any L ∈L(kX, Y ),
L(s) ≤∥L∥.
(5.6)
For L ∈L(kX, Y ), let
Lx⊗k1
1
⊗· · · ⊗x⊗km
m
:= L(x1, . . . , x1, x2, . . . , x2, x3, . . . , xm−1, xm, . . . , xm)
where xj appears kj times on the right for j = 1, . . . , m and kj are nonnegative
integers for j = 1, . . . , m such that k1 + · · · + km = k and m = 1, 2, . . . . For
each symmetric k-linear mapping L, k ≥2, and any integer m ≥1, we have
the following multinomial formula:
L(x1 + · · · + xm)⊗k =
X
k!
k1! · · · km!Lx⊗k1
1
⊗· · · ⊗x⊗km
m
,
(5.7)
where P denotes summation over all m-tuples (k1, . . . , km) of nonnegative
integers satisfying k1 + · · · + km = k. As a special case, when m = 2, we have
the binomial formula:
L(x + y)⊗k = Lx⊗k +
k−1
X
l=1
k
l

Lx⊗k−l ⊗y⊗l + Ly⊗k.
(5.8)
Let X and Y be vector spaces. For k = 1, 2, . . ., a mapping P : X →Y is
called a k-homogeneous polynomial if there exists a k-linear mapping L from
Xk into Y such that Px = L(x, . . . , x) for all x ∈X. Then let P = ˜L. If
M = L(s) then clearly
˜
M = ˜L. Thus, in the deﬁnition of k-homogeneous
polynomial, we can equivalently take L to be symmetric. To show that the
map L 7→˜L is one-to-one for L symmetric, and ﬁnd its inverse, one can use
the following polarization identity:
Theorem 5.6 (Polarization). Let L: Xk →Y be a symmetric k-linear map.
Then
L(x1, . . . , xk) =
1
k!2k
X′e1 · · · ekL(e1x1 + · · · + ekxk)⊗k,
(5.9)
where P′ denotes summation over all ei ∈{−1, 1}, i = 1, . . . , k. Thus, if
˜L ≡˜
M for two symmetric k-linear maps Xk →Y then L ≡M.

242
5 Derivatives and Analyticity in Normed Spaces
Proof. By the multinomial formula (5.7), we have
L(e1x1 + · · · + ekxk)⊗k =
X′′
k!
n1! · · · nk!L(e1x1)⊗n1 ⊗· · · ⊗(ekxk)⊗nk
=
X′′
k!
n1! · · · nk!en1
1 · · · enk
k Lx⊗n1
1
⊗· · · ⊗x⊗nk
k
,
where P′′ denotes summation over all k-tuples (n1, . . . , nk) of nonnegative
integers satisfying n1 +· · ·+nk = k. Denoting the right side of (5.9) by A, we
then have
A = 1
2k
X′′
1
n1! · · · nk!a(n1, . . . , nk)Lx⊗n1
1
⊗· · · ⊗x⊗nk
k
,
where a(n1, . . . , nk) = P′en1+1
1
· · · enk+1
k
. If some ni = 0 then a(n1, . . . , nk) =
0. Thus a(n1, . . . , nk) ̸= 0 if and only if n1 = · · · = nk = 1. Since a(1, . . . , 1) =
2k, A = L(x1, . . . , xk). The last conclusion follows easily, proving the theorem.
2
By the preceding polarization theorem, a symmetric k-linear map L from
Xk into Y is uniquely deﬁned by its values on the diagonal of Xk. The one-
to-one relation between L and the k-homogeneous polynomial P = ˜L will be
assumed and used frequently in what follows.
A function P from X into Y will be called a polynomial iﬀfor some ﬁnite
k, P = Pk
j=0 Pj where for j = 1, . . . , k, Pj is a j-homogeneous polynomial
from X into Y and P0(x) ≡y0 for some y0 ∈Y .
If X and Y are normed spaces and L is a continuous k-linear map from
X into Y , then clearly the k-homogeneous polynomial ˜L is continuous. Con-
versely, if ˜L is continuous, then by the polarization theorem 5.6, L is contin-
uous, and so bounded by Theorem 5.4.
Let P k(X, Y ) be the vector space of all continuous k-homogeneous poly-
nomials from X to Y . A norm on P k(X, Y ) is given by
∥P∥:= sup{∥Px∥: ∥x∥≤1} = inf{C ≥0: ∥Px∥≤C∥x∥k for all x ∈X}.
It is clear that if L ∈Ls(kX, Y ), then ˜L ∈P k(X, Y ) and ∥˜L∥≤∥L∥. A
converse bound follows from the next theorem:
Theorem 5.7. The mapping Ls(kX, Y ) ∋L 7→˜L ∈P k(X, Y ) is a vector
space isomorphism and a homeomorphism of the ﬁrst onto the second space.
Moreover,
∥˜L∥≤∥L∥≤kk
k! ∥˜L∥.
(5.10)
Proof. It is enough to prove the second inequality in (5.10) when k > 1. By
Theorem 5.6, we have

5.1 Polynomials and Power Series
243
L(x1, . . . , xk)
 ≤
1
k!2k
X′
∥˜L∥
 ∥e1x1∥+ · · · + ∥ekxk∥
k,
where P′ denotes summation over all ei ∈{−1, 1}, i = 1, . . . , k, and has 2k
terms. Thus if ∥xi∥≤1 for i = 1, . . . , k, we obtain the second inequality in
(5.10), completing the proof.
2
The constant kk/k! in (5.10) is best possible. Let X := L1 be the Banach
space of Lebesgue integrable functions over [0, 1], let Y := R, and let L ∈
Ls(kX, Y ) be deﬁned by
L(x1, . . . , xk) :=
X
π
Z
[0,1/k]
xπ(1)(t) dt · · ·
Z
[(k−1)/k,1]
xπ(k)(t) dt,
where the sum is over all permutations of π of {1, . . ., k}. Kope´c and Musielak
[123] proved for this case that ∥L∥= (kk/k!)∥˜L∥. It is well known that the
mapping Ls(kX, Y ) ∋L 7→˜L ∈P k(X, Y ) is an isometry if X = H is a real
Hilbert space and Y is a Banach space, as shown in Corollary 5.23(e) below.
Deﬁnition 5.8. Let X and Y be Banach spaces, and let P 0(X, Y ) be the
set of all constant functions from X into Y . A power series from X to Y
around u ∈X is a series of the form P
k≥0 P k
u (x −u), where P k
u ∈P k(X, Y )
for each k = 0, 1, . . . . The largest r ∈[0, ∞] such that the series converges
in Y for all x ∈X with ∥x −u∥< r is called the radius of convergence of
the power series. Let U be an open subset of X. A mapping F : U →Y has
a power series expansion around a point u ∈U if there exists a power series
P
k≥0 P k
u (x −u) from X to Y around u which converges to F(x) for x in a
ball B(u, r) ⊂U for some r > 0.
If P is any polynomial from X into Y and u is a ﬁxed element of X, then
the function x 7→P(x−u) is also a polynomial, by Theorem 5.6 (polarization)
and the binomial formula (5.8).
Power series with radius of convergence equal to 0 will not be of interest. If
two power series P
k≥0 P k
u (x−u) and P
k≥0 Qk
u(x−u) converge absolutely and
have the same sum on a neighborhood of u, then P k
u = Qk
u for k = 0, 1, . . . .
This is a consequence of the following theorem.
Theorem 5.9. If the power series P
k≥0 P k
u (x −u) from X to Y around u ∈
X converges absolutely and its sum is equal to zero for x in some neighborhood
of u, then P k
u ≡0 for k = 0, 1, . . ..
Proof. Taking x = u we get P 0
u ≡0. By the assumption, there is an r > 0
such that the power series P
k≥1 P k
u (x −u) from X to Y around u converges
absolutely to zero for all x ∈X such that ∥x−u∥≤r. Let y ∈X be arbitrary
and non-zero. For any t ∈K such that |t| ≤r/∥y∥, letting x := ty + u, we
have ∥x −u∥= |t| ∥y∥≤r, and so

244
5 Derivatives and Analyticity in Normed Spaces
0 =
X
k≥1
P k
u (x −u) =
X
k≥1
P k
u (y)tk.
By Lemma 2.95 applied to hk := P k
u (y) and δ := r/∥y∥, it follows that
P k
u (y) = 0 for k = 1, 2, . . . . Since y ∈X is arbitrary, the proof of the theorem
is complete.
2
For a given power series P
k≥0 P k
u (x −u) from X to Y around u ∈X, a
number ρ = ρu := ρu,U, 0 ≤ρ ≤+∞, is said to be the radius of uniform
convergence of the series if ρ is the supremum of all r, 0 ≤r < +∞, such that
the power series converges uniformly on the closed ball ¯B(u, r) with center at
u and radius r > 0. Here in the expanded notation ρu,U, u is the point around
which the expansion is taken, and “U” indicates “uniform.”
Theorem 5.10. For a normed space X and a Banach space Y , the radius of
uniform convergence ρu of the power series P
k≥0 P k
u (x −u) around u from
X to Y is given by the Cauchy–Hadamard formula:
1
ρu
= lim sup
k→∞
∥P k
u ∥1/k.
(5.11)
Moreover, if ρu > 0 then for each 0 < r < ρu, P
k≥0 ∥P k
u ∥rk < ∞.
Proof. Let α := lim supk→∞∥P k
u ∥1/k. First suppose that α = +∞. Let r > 0.
Since α > 1/r, there is a sequence k(j) →∞as j →∞such that for some
yj ∈X with ∥yj∥≤1, ∥P k(j)
u
(yj)∥> r−k(j) for all j. For each j ≥1, letting
xj := u + ryj, it follows that ∥P k(j)
u
(xj −u)∥> 1 and xj ∈¯B(u, r). Since
r > 0 is arbitrary, ρu = 0, that is, (5.11) holds in the ﬁrst case.
Second suppose that 0 < α < +∞. Let 0 < r < 1/α. Then
lim sup
k→∞
(∥P k
u ∥rk)1/k = αr < 1.
By the root test on series of nonnegative numbers, it follows that the series
P
k≥1 ∥P k
u ∥rk converges. Therefore the series P
k≥0 P k
u (x −u) converges uni-
formly for x ∈¯B(u, r), and so 1/α ≤ρu. If r > 1/α then one can show as in
the ﬁrst case that the power series does not converge uniformly on ¯B(u, r),
proving (5.11) in the second case.
Finally suppose that α = 0. Let 0 < r < ∞and let ǫ := 1/(2r). In this case
there is an integer k0 such that ∥P k
u ∥≤ǫk for each k ≥k0. If x ∈¯B(u, r) then
∥P k
u (x −u)∥≤(rǫ)k = 2−k for all k ≥k0. Thus the power series converges
uniformly on ¯B(u, r). Since r is arbitrary, ρu = +∞, completing the proof of
(5.11) in all cases.
2

5.1 Polynomials and Power Series
245
Corollary 5.11. Let X be a normed space and let Y be a Banach space. For
the power series P
k≥0 P k
u (x −u) from X to Y around u ∈X, the following
are equivalent:
(a) P
k≥0 P k
u (x −u) converges uniformly on some closed ball ¯B(u, r), r > 0;
(b) lim supk→∞∥P k
u ∥1/k < ∞;
(c) there exist C > 0 and c > 0 such that ∥P k
u ∥≤Cck for k = 0, 1, . . ..
Proof. By Theorem 5.10, (a) implies (b) because 0 < r ≤ρu. Since clearly
(c) follows from (b), it is enough to show that (c) implies (a). To this aim let
r > 0 be such that rc < 1. Then for x ∈¯B(u, r),
X
k≥0
∥P k
u (u −x)∥≤C
X
k≥0
(rc)k < ∞,
and so (a) holds, proving the corollary.
2
For a power series of complex numbers its radii of absolute convergence
and uniform convergence are the same. This is no longer true for power series
in an inﬁnite-dimensional space, as the following example shows. Recall that
ℓp spaces were deﬁned under the heading “Classes of measurable functions”
in Section 1.4.
Example 5.12. Let X = ℓ2 and Y = K = R. For x = {xj}j≥1 ∈ℓ2, let
P k
0 (x) := (xk)k for k = 1, 2, . . . . Then for each k ≥1, P k
0 ∈P k(ℓ2, R) and
∥P k
0 ∥= 1, and so ρ0 = 1 although the power series F(x) := P
k≥1 P k
0 (x)
converges absolutely for all x ∈ℓ2, so that its radius of convergence is +∞.
Let B be a Banach algebra and let h ∈B. For each k = 1, 2, . . . deﬁne the
k-linear map M k := M k[h] from B × · · · × B (k times) into B by
M k[h](x1, . . . , xk) := hx1x2 · · · xk
(5.12)
for x1, . . . , xk ∈B. Let Sk = Sk[h] be the symmetrization of M k[h], and let
P k = P k[h] be the k-homogeneous polynomial deﬁned by P k := (Sk)e. Then
P kx = hxk for x ∈B.
Lemma 5.13. Let B be a unital Banach algebra and h ∈B. For each k =
1, 2, . . . , we have ∥P k[h]∥= ∥Sk[h]∥= ∥M k[h]∥= ∥h∥.
Remark 5.14. In this case P k = (Sk)e but in (5.10), kk/k! can be replaced
by 1.
Proof. Clearly, since P k = (Sk)e, by the left inequality in (5.10) and by (5.6),
∥P k∥≤∥Sk∥≤∥M k∥≤∥h∥. Conversely, taking x1 = · · · = xk = x = 1I we
get ∥P k[h]∥= ∥Sk[h]∥= ∥M k[h]∥= ∥h∥.
2

246
5 Derivatives and Analyticity in Normed Spaces
Let B be a Banach algebra. Then a B-power series will mean a series
∞
X
k=0
hkxk
(5.13)
for x ∈B and hk ∈B for all k, where if B is unital, x0 := 1I, or if it is not, the
k = 0 term is omitted (h0 = 0). It is a power series from B into B of the form
P
k≥0 P k[hk]xk with P k[hk] ∈P k(B, B) as deﬁned before Lemma 5.13.
Remark 5.15. The notion of B-power series will usually be applied when
the coeﬃcients hk in (5.14) all belong to the center {h ∈B: hx = xh for all
x ∈B}, for example, if B is commutative or if all hk are constant multiples of
the identity 1I.
Theorem 5.16. For any Banach algebra B, sequence {hk}k≥0 ⊂B, and x ∈
B, if the spectral radius r(x) satisﬁes
r(x) < ρ := 1/ lim sup
k→∞
∥hk∥1/k,
then the B-power series (5.13) converges absolutely.
Proof. Let r(x) < σ < τ < ρ. Then by Theorem 4.15, for k large enough,
∥xk∥1/k < σ, while ∥hk∥1/k < 1/τ. Thus ∥hkxk∥1/k < σ/τ < 1 for k large
enough, and the theorem follows by the root test on series of nonnegative
numbers.
2
It will follow from Theorem 6.17 and Corollary 6.23 that if 1 ≤p < ∞and
J is a nonempty interval, then for any f in the Banach algebra Wp(J), the
spectral radius r(f) equals ∥f∥sup, and the same holds for Banach algebras of
H¨older functions.
As stated before Theorem 2.102, a topological space X is said to be con-
nected if the only subsets of X which are both open and closed are the empty
set ∅and the set X itself. A subset U of a topological space X is connected if
it is connected with its relative topology.
Deﬁnition 5.17. Let B be a Banach algebra and U a nonempty connected
open subset of B. A function F from U into B will be said to have a B-Taylor
expansion around u ∈U if there are an r > 0 and a sequence {hk} ⊂B such
that F is given by a B-power series, called the B-Taylor series of F around u,
F(x) =
∞
X
k=0
hk(x −u)k,
(5.14)
for each x ∈U with ∥x −u∥< r. A function F from U into B will be called
B-analytic on U if F has a B-Taylor expansion around each point of U.

5.1 Polynomials and Power Series
247
If F is B-analytic on U then its B-Taylor series around each point of U is
unique by Theorem 5.9, since convergence of a B-power series on a set B(0, r)
yields its absolute convergence there due to the next theorem.
Theorem 5.18. If B is a unital Banach algebra and {hk}∞
k=0 ⊂B, then the
following are equivalent:
(a) for some r ∈(0, +∞], the B-power series P∞
k=0 hkxk converges in B for
all x with ∥x∥< r;
(b) M := lim supk→∞∥hk∥1/k < ∞.
If (a) and (b) hold then the largest r for which (a) holds is ρ := 1/M, and
for any 0 < s < ρ, the series in (a) converges absolutely and uniformly for
∥x∥≤s.
Remark 5.19. The Hilbert space ℓ2 in Example 5.12 is a Banach algebra
under pointwise operations of sequences but does not have an identity. In it,
for hk = ek with (ek)j = δjk = 1j=k for k ≥1, h0 = 0, we have r = +∞in
(a) but M = 1 in (b) so ρ = 1.
Proof. Recall that the norm on a Banach algebra B with identity 1I can be
and has been chosen so that ∥1I∥= 1 (see Theorem 4.8 and Deﬁnition 4.9).
(a) ⇒(b): Let x = t1I for any t with 0 < t < r. Then the series P∞
k=0 tkhk
converges in B. Thus supk tk∥hk∥< ∞, and so taking kth roots implies M <
∞.
(b) ⇒(a): For each k, let P k : x 7→hkxk. By Lemma 5.13, ∥P k∥= ∥hk∥.
Thus (b) implies (a) with r = ρ by Theorem 5.10, and the absolute and
uniform convergence for ∥x∥≤s follows for s < ρ.
Let t > ρ and x = t1I, so ∥x∥= t. Then ∥hkxk∥= tk∥hk∥. Let ρ <
s < t. Then ∥hk∥1/k > 1/s for inﬁnitely many k, so tk∥hk∥> tk/sk, which
is unbounded. Thus P∞
k=0 hkxk does not converge and ρ is the largest r for
which (a) holds, proving the theorem.
2
Example 5.20. Let B be a Banach algebra containing an element y ̸= 0
which is nilpotent, meaning that yn = 0 for some n ≥2. Speciﬁcally, let
M(2, R) be the algebra of 2×2 real matrices with usual matrix multiplication
and y =
  0 1
0 0

. Then the power series P∞
k=0 hkyk converges for arbitrary
hk ∈B, but the spectral radius r(y) is 0. Since y can be multiplied by any
scalar in K, its norm can be taken arbitrarily large, e.g., larger than the radius
ρ0 of uniform convergence of the power series P∞
k=0 hkxk. Thus, unlike the
case of analytic functions of one real or complex variable, divergence of a
power series P akxk for some x = x0 does not imply its divergence for all x
with ∥x∥> ∥x0∥.
Next we show that if a power series around u ∈X has a positive radius of
uniform convergence then its sum has a locally uniformly convergent power

248
5 Derivatives and Analyticity in Normed Spaces
series expansion around each point v in some neighborhood of u. To deﬁne the
power series around v the following is used. Let L be a symmetric m-linear
mapping and let k be an integer such that 0 < k < m. For (x1, . . . , xm−k) ∈
Xm−k, the mapping L(x1, . . . , xm−k) deﬁned by (5.5) is a symmetric k-linear
mapping from Xk to Y . Thus the mapping
X ∋x 7→L(x1, . . . , xm−k)x⊗k ∈Y
is a k-homogeneous polynomial. If x1 = · · · = xm−k = x for some x, then we
write Lx⊗m−k := L(x1, . . . , xm−k) ∈Ls(kX, Y ).
Theorem 5.21. For a normed space X, a Banach space Y , and u ∈X, let
P
m≥0 P m
u (x −u) be a power series around u from X to Y whose radius of
uniform convergence is ρu > 0, and let
F(x) :=
X
m≥0
P m
u (x −u)
(5.15)
for each x ∈B(u, ρu). For each m ≥1, let Lm
u ∈Ls(mX, Y ) be such that
P m
u = (Lm
u )e, and let
ρ := ρ{Lm
u }m≥1 := 1/ lim sup
m→∞∥Lm
u ∥1/m.
(5.16)
Then ρ ≥e−1ρu, and for each v ∈B(u, ρ), (a), (b), and (c) hold, where
(a) for each k ≥1,
P k
v := P k
u +
X
m>k
m
k

Lm
u (v −u)⊗m−k ∈P k(X, Y );
(5.17)
(b) the power series P
k≥0 P k
v (x −v) with P 0
v ≡F(v) has radius of uniform
convergence ρv ≥ρ −∥v −u∥, and
∞
X
k=1
∥P k
v (x −v)∥≤
∞
X
m=1
∥Lm
u ∥rm < ∞
for all x such that ∥x −v∥≤r −∥v −u∥with r < ρ;
(c) for each x ∈X such that ∥x −v∥< ρ −∥v −u∥,
F(x) =
X
k≥0
P k
v (x −v).
(5.18)
Remark 5.22. Timothy Nguyen has proved that the bound ρ ≥e−1ρu can
be improved to ρ ≥e−1/2ρu: see the Notes. Although the bound in Theorem
5.7 is sharp as shown in references given after it, the sharpness pertains to
m distinct elements of X for each m, where in the present case one only
needs to consider two elements of X at a time, such as u and v in (5.17). The

5.1 Polynomials and Power Series
249
equality ρ = ρu holds for some inﬁnite-dimensional X and Y ; see Corollary
5.23. Indeed we do not know at this writing any example where it fails. If
ρu = +∞, the factor e−1 or e−1/2 makes no diﬀerence.
Cena [31] calls the quantity ρ the “radius of restricted convergence” of a
power series. We do not know whether it may have other names.
Proof. By Stirling’s formula, we have limm→∞m/(m!)1/m = e. Thus using
(5.10) and (5.11) it follows that
1
ρ = lim sup
m→∞∥Lm
u ∥1/m ≤lim sup
m→∞
mm
m! ∥P m
u ∥
1/m
= e
ρu
,
and so ρ ≥e−1ρu.
Let v ∈B(u, ρ) and let r be such that ρ > r > ∥v −u∥. By the root test
on series of nonnegative numbers, it follows that P
m≥1 ∥Lm
u ∥rm < ∞. Thus
for any x ∈X such that ∥x−v∥≤r −∥v −u∥, as in part (b) or, for a suitable
r, in part (c) of the statement, we have
∞
X
m=1
m
X
k=1
m
k

∥Lm
u ∥∥v −u∥m−k∥x −v∥k
≤
∞
X
m=1
∥Lm
u ∥(∥v −u∥+ r −∥v −u∥)m < ∞.
(5.19)
Interchanging the order of summation on the left side, it follows that
∞
X
k=1
 ∞
X
m=k
m
k

∥Lm
u ∥∥v −u∥m−k
!
∥x −v∥k < ∞.
(5.20)
Therefore for each k ≥1, taking x ̸= v, P∞
m=k
 m
k

Lm
u (v −u)⊗m−k converges
in Ls(kX, Y ) to some Qk
v. Thus the series deﬁning P k
v in (5.17) converges
absolutely and P k
v w = Qk
vw⊗k for all w ∈X and k ≥1, so (a) is proved.
It follows that
∞
X
k=1
∥P k
v (x −v)∥≤
∞
X
m=1
∥Lm
u ∥rm < ∞
for any x such that ∥x −v∥≤r −∥v −u∥with r < ρ. The power series
P
k≥0 P k
v (x −v) converges uniformly for ∥x −v∥≤r −∥v −u∥. Since r can
be taken arbitrarily close to ρ, the radius of uniform convergence is ρv ≥
ρ −∥v −u∥, proving (b).
For (c), let x ∈X be such that ∥x −v∥< ρ −∥v −u∥. By the binomial
formula (5.8), for each integer m ≥1, we have
Lm
u (x −u)⊗m = Lm
u (v −u + x −v)⊗m
= Lm
u (v −u)⊗m +
m−1
X
k=1
m
k

Lm
u (v −u)⊗m−k ⊗(x −v)⊗k + Lm
u (x −v)⊗m,

250
5 Derivatives and Analyticity in Normed Spaces
where the sum over the empty set of indices is zero. Since x ∈B(u, ρ) ⊂
B(u, ρu), F(x) is deﬁned and equals
F(x) = F(u) +
∞
X
m=1
n
P m
u (v −u)
+
m−1
X
k=1
m
k

Lm
u (v −u)⊗m−k ⊗(x −v)⊗k + P m
u (x −v)
o
.
The series, as a double series in m and k, converges absolutely by (5.19). Thus
the order of summation can be reversed. Also, (5.15) with x = v shows that
the sum of terms with k = 0 is F(v). So F(x) equals
F(v) +
∞
X
k=1
n
P k
u (x −v) +

∞
X
m=k+1
m
k

Lm
u (v −u)⊗m−k
(x −v)⊗ko
.
This and (5.17) imply (5.18) with P 0
v ≡F(v), proving (c) and the theorem.
2
Corollary 5.23. Under the hypotheses of Theorem 5.21, statements (a), (b),
and (c) hold for each v ∈B(u, ρ) with ρ = ρu in the following cases:
(d) If X = Y = B is a unital Banach algebra and (5.15) is a B-power series.
(e) If X is a Hilbert space over K and Y is a Banach space over K.
Proof. For (d), the power series (5.15) is given by a B-power series (5.13) for
some sequence {hm}m≥0. Using notation as deﬁned before Lemma 5.13, we
have for each m ≥1, Lm
u = M m[hm] and P m
u = P m[hm]. Thus for the ρ and
ρu deﬁned by (5.16) and (5.11), respectively, we have ρ = ρu by Lemma 5.13.
For (e), it is enough to prove that ∥L∥= ∥˜L∥for any mapping L ∈
Ls(kX, Y ) and k = 2, 3, . . .. First suppose that X is ﬁnite-dimensional. To
begin, let k = 2. By compactness take x, u ∈X with ∥x∥= ∥u∥= 1 and
∥L∥= ∥L(x, u)∥. Since L(x, u) = 1
4[˜L(x + u) −˜L(x −u)], we have
∥L∥= ∥L(x, u)∥≤1
4[∥˜L(x+u)∥+∥˜L(x−u)∥] ≤1
4∥˜L∥[∥x+u∥2+∥x−u∥2]
≤1
4∥L∥[∥x + u∥2 + ∥x −u∥2] = 1
2∥L∥(∥x∥2 + ∥u∥2) = ∥L∥
using the parallelogram law in Hilbert space, and all inequalities must be
equalities, in particular ∥˜L∥= ∥L∥as desired for k = 2. Also, in the three
expressions with coeﬃcient
1
4, since the inequalities hold between the ﬁrst
terms of each, and the second terms, the inequalities for the ﬁrst terms and
the second terms must each be equalities, and hence
∥˜L(x ± u)∥= ∥L∥∥x ± u∥2.
(5.21)

5.2 Higher Order Derivatives and Taylor Series
251
For k ≥3, let S := {x ∈X : ∥x∥≤1}. By compactness, take y1, . . . , yk ∈S
such that ∥L∥= ∥L(y1, . . . , yk)∥. For some a ∈S, none of the inner products
⟨a, yj⟩is 0 for j = 1, . . . , k since for each j, {a ∈S : ⟨a, yj⟩= 0} is nowhere
dense in S. Replacing yj by −yj as needed, we can assume that that ⟨a, yj⟩> 0
for each j. For some ǫ > 0, the compact set
A := {x = (x1, . . . , xk) ∈Sk : ⟨a, xj⟩≥ǫ, j = 1, . . . , k,
and
∥L(x1, . . . , xk)∥= ∥L∥}
is nonempty. Clearly, for each x ∈A, ∥xj∥= 1 for all j = 1, . . . , k. At some
(u1, . . . , uk) ∈A, Pk
j=1⟨a, xj⟩attains its maximum on A. It will be enough to
show that up = ±uq for all p, q = 1, . . . , k. Suppose that up ± uq ̸= 0 for some
p, q. Deﬁne vj := uj for j ̸= p, q and vj := (up +uq)/∥up +uq∥for j = p, q. We
have ∥L(v1, . . . , vk)∥= ∥L∥by (5.21) for the 2-linear map (xp, xq) 7→L(x)
where xj = uj for j ̸= p, q are ﬁxed. Then Pk
j=1⟨a, vj⟩> Pk
j=1⟨a, uj⟩because
∥up + uq∥< 2 (using the Hilbert space assumption). This contradicts the
choice of uj and ﬁnishes the proof when X is ﬁnite-dimensional.
Now let X be inﬁnite-dimensional. We want to show that for any a1, . . . , ak
in S, ∥L(a1, . . . , ak)∥≤∥˜L∥. Restricting to the ﬁnite-dimensional space
spanned by a1, . . . , ak, this reduces to the previous case. The corollary is
proved.
2
We ﬁnish this section with a special case of Theorem 3.8 applied to
L(kX, Y )-valued functions. It will be used in Section 6.6 in relation to higher
order derivatives of a Nemytskii operator acting between Wp spaces.
Corollary 5.24. Let k = 1, 2, . . ., let X, Y be Banach spaces, let J be
a nondegenerate interval and let Φ ∈CV. For F ∈f
WΦ(J; L(kX, Y )) and
g1, . . . , gk ∈f
WΦ(J; X), let h(s) := F(s)(g1(s), . . . , gk(s)), s ∈J. Then
h ∈f
WΦ(J; Y ) and
∥h∥[Φ] ≤∥F∥[Φ]∥g1∥[Φ] · · · ∥gk∥[Φ].
Proof. For A ∈L(kX, Y ) and x1, . . . , xk
∈X, let L(A, x1, . . . , xk) :=
A(x1, . . . , xk). Then L is a (k + 1)-linear and 1-bounded mapping from
L(kX, Y ) × Xk into Y as deﬁned before Theorem 3.8. The conclusion then
follows from Theorem 3.8 applied to L.
2
5.2 Higher Order Derivatives and Taylor Series
Throughout this section let X and Y be normed spaces and let U be a
nonempty open subset of X. Let L1(X, Y ) := L(X, Y ), the normed space

252
5 Derivatives and Analyticity in Normed Spaces
of bounded linear operators from X into Y , with the usual operator norm
(1.17). Recursively, for k = 1, 2, . . ., given a normed space Lk(X, Y ), let
Lk+1(X, Y ) := L(X, Lk(X, Y )) with the operator norm.
For k ≥2, we say that F : U →Y has a kth (Fr´echet) derivative or is
(Fr´echet) diﬀerentiable of order k at u if F has a (k−1)st derivative Dk−1F(x)
at each point x of some neighborhood of u, and the mapping Dk−1F with
values in Lk−1(X, Y ) is diﬀerentiable at u. Then DkF(u), the kth derivative
of F at u, is deﬁned as the derivative of Dk−1F at u. Thus DkF(u) is in
Lk(X, Y ). If F is diﬀerentiable of order k at u for each u ∈U then we say
that F is diﬀerentiable of order k on U.
The space Lk(X, Y ), which occurs naturally in the deﬁnition of DkF(u),
can be identiﬁed conveniently with the space L(kX, Y ) of k-linear mappings
deﬁned previously. Speciﬁcally, let Φ(k) : Lk(X, Y ) →L(kX, Y ) be the natural
isomorphism deﬁned by
Φ(k)(A)(x1, . . . , xk) := A(x1)(x2) · · · (xk)
:=

· · ·

A(x1)

(x2) · · ·

(xk)
(5.22)
for each A ∈Lk(X, Y ). It is easily seen by induction on k that Φ(k) is an
isometry for the norm on L(kX, Y ) deﬁned by (5.4) and the operator norm on
Lk(X, Y ). For k ≥2, let F be diﬀerentiable of order k at u ∈U. Then the kth
diﬀerential at u is deﬁned by dkF(u) := Φ(k)(DkF(u)). If F is diﬀerentiable of
order k on U then the kth diﬀerential dkF is a mapping from U into L(kX, Y ),
that is, for u ∈U, dkF(u) is a k-linear mapping such that
dkF(u)(x1, . . . , xk) = DkF(u)(x1) · · · (xk)
(5.23)
for any x1, . . . , xk ∈X. For k = 1 and u ∈U, we let dF(u) := d1F(u) :=
DF(u) whenever F is diﬀerentiable at u.
The following gives a condition for existence of the kth derivative in terms
of diﬀerentials.
Proposition 5.25. Let k ≥2, let F : U →Y be diﬀerentiable of order k −1
on U, let L ∈L(kX, Y ), and let u ∈U. Then the following two statements
are equivalent:
(a) F is diﬀerentiable of order k at u and dkF(u) = L;
(b) the function x 7→f(x) := dk−1F(x), x ∈U, is diﬀerentiable at u and
Df(u)(x) = L(x, . . . ) for each x ∈X.
Moreover, whenever (a) or (b) holds, we have ∥Ddk−1F(u)∥= ∥dkF(u)∥.
Proof. (a) ⇒(b). We have f(x) = (Φ(k−1)◦Dk−1F)(x), where Φ(k−1) is con-
tinuous and linear, and so its derivative DΦ(k−1) equals Φ(k−1). Thus by the
chain rule in the form of Theorem 5.1, f is diﬀerentiable at u and for each
x ∈X, we have

5.2 Higher Order Derivatives and Taylor Series
253
Df(u)(x) = Φ(k−1)

DkF(u)(x)

= DkF(u)(x)(·) · · · (·) = L(x, · · · ),
where the last equality holds by (5.23) and since dkF(u) = L, proving (b).
(b) ⇒(a). Let Φ−1
(k−1) be the inverse of Φ(k−1), and so Dk−1F(x) =

Φ−1
(k−1)◦dk−1F

(x) for x ∈U. Again since Φ−1
(k−1) is continuous and lin-
ear, by the chain rule (Theorem 5.1), DkF(u) is deﬁned and for each x ∈X,
we have
DkF(u)(x) = Φ−1
(k−1)

Df(u)(x)

= Φ−1
(k−1)(L(x, . . . )).
(5.24)
Thus for each x ∈X, we have
dkF(u)(x, . . .) = Φ(k)

DkF(u)

(x, . . .) = Φ(k−1)

DkF(u)(x)

= L(x, . . . ),
proving (a).
Finally, let (b) hold. Then using Proposition 5.5 with m = 1, V1 = · · · =
Vk = X, and V0 = Y , we have
∥Df(u)∥L(X,L(k−1X,Y )) =sup

∥L(x, . . . )∥L(k−1X,Y ) : ∥x∥≤1
	
=∥L∥L(kX,Y ).
The proof of the proposition is complete.
2
Corollary 5.26. Let k ≥2, let F : U →Y be diﬀerentiable of order k −1 on
U and for some x2, . . . , xk ∈X, let g(x) := dk−1F(x)(x2, . . . , xk), x ∈U. For
u ∈U, if F is diﬀerentiable of order k at u then g: U →Y is diﬀerentiable
at u with the derivative
dg(u)(x) = dkF(u)(x, x2, . . . , xk),
x ∈X.
Proof. Let f : U →L(k−1X, Y ) be the function deﬁned in Proposition 5.25(b).
Let T : L(k−1X, Y ) →Y be the evaluation operator deﬁned by T (A) :=
A(x2, . . . , xk) for A ∈L(k−1X, Y ). Then T is a bounded linear operator and
g = T ◦f. Thus using the chain rule (Remark 5.2) and (a) ⇒(b) of Proposition
5.25, it follows that g is diﬀerentiable at u and for each x ∈X, we have
(Dg)(u)(x) = T (Df(u)(x)) = dkF(u)(x, x2, . . . , xk),
proving the corollary.
2
Further, we will prove that the kth diﬀerential, whenever it exists, is a
symmetric k-linear mapping, that is, dkF(u) ∈Ls(kX, Y ). The following is
known as the Schwarz theorem.
Theorem 5.27. For each k ≥2, if F : U →Y is diﬀerentiable of order k at
u ∈U then the k-linear mapping dkF is symmetric.

254
5 Derivatives and Analyticity in Normed Spaces
Proof. The proof is by induction. First let k = 2. Since F is twice diﬀerentiable
at u, F is diﬀerentiable on an open ball B(u, r) ⊂U for some r > 0. For
x1, x2 ∈X such that ∥x1∥< r/2 and ∥x2∥< r/2, let
∆(x1, x2) := F(u + x1 + x2) −F(u + x1) −F(u + x2) + F(u).
Next we show that the diﬀerence between d2F(u)(x1, x2) and ∆(x1, x2) is
o((∥x1∥+∥x2∥)2) as ∥x1∥+∥x2∥→0. For x ∈X such that ∥x−u∥< r/2, let
Gx1(x) := F(x+x1)−F(x). Then Gx1 is a diﬀerentiable mapping of B(u, r/2)
into Y . By (5.3) in the mean value theorem, we have for any C ∈L(X, Y ),
Gx1(u + x2) −Gx1(u) −DGx1(u)x2

≤∥x2∥sup
0≤t≤1
DGx1(u + tx2) −DGx1(u)

≤∥x2∥sup
0≤t≤1
(DGx1(u + tx2) −C) −(DGx1(u) −C)

≤2∥x2∥sup
0≤t≤1
DGx1(u + tx2) −C
.
Take C = D2F(u)(x1). Recall that d2F(u)(x1, x2) = D2F(u)(x1)(x2) =
C(x2) by (5.23) with k = 2. Thus
∆(x1, x2) −d2F(u)(x1, x2)

≤
Gx1(u + x2) −Gx1(u) −DGx1(u)x2

+

DGx1(u) −D2F(u)(x1)

(x2)

≤3∥x2∥sup
0≤t≤1
DGx1(u + tx2) −D2F(u)(x1)
.
(5.25)
For each t ∈[0, 1], since D2F(u)(·): X →L(X, Y ) is linear, we have
DGx1(u + tx2) −D2F(u)(x1)
=

DF(u + x1 + tx2) −DF(u) −D2F(u)(x1 + tx2)

−

DF(u + tx2) −DF(u) −D2F(u)(tx2)

.
(5.26)
Let ǫ > 0. Since DF is diﬀerentiable at u there is a δ < r/4 such that
DF(u + x) −DF(u) −D2F(u)x∥< ǫ∥x∥
for each x ∈X with ∥x∥< δ. Thus by (5.25) and (5.26), we get the bound
∆(x1, x2) −d2F(u)(x1, x2)
 < 3ǫ∥x2∥
 ∥x1∥+ 2∥x2∥

whenever ∥x1∥+∥x2∥< δ. Since ∆(x1, x2) = ∆(x2, x1), interchanging x1 and
x2 in the preceding bound, it follows that
∆(x1, x2) −d2F(u)(x2, x1)
 < 3ǫ∥x1∥
 ∥x2∥+ 2∥x1∥


5.2 Higher Order Derivatives and Taylor Series
255
whenever ∥x1∥+ ∥x2∥< δ. The preceding two bounds yield the inequality
d2F(u)(x1, x2) −d2F(u)(x2, x1)
 < 6ǫ
 ∥x1∥+ ∥x2∥
2
(5.27)
for each x1, x2 ∈X such that ∥x1∥+ ∥x2∥< δ. Since d2F(u) is bilinear,
inequality (5.27) is homogeneous of order 2, and so it holds for arbitrary
x1, x2 ∈X. Thus letting ǫ ↓0, d2F(u)(x1, x2) = d2F(x2, x1) for any x1, x2 ∈
X, proving the conclusion for k = 2.
Now suppose that k > 2 and dk−1F(v) is symmetric for all v ∈B(u, r)
for some r > 0. Thus for x2, . . . , xk ∈X, we have for any permutation π of
{2, . . . , k},
dk−1F(v)(xπ(2), . . . , xπ(k)) = dk−1F(v)(x2, . . . , xk).
Then by Corollary 5.26, we have
dkF(u)(x1, xπ(2), . . . , xπ(k)) = dkF(u)(x1, x2, . . . , xk)
(5.28)
for any x1, x2, . . . , xk ∈X and any permutation π of {2, . . . , k}. Let G(x) :=
dk−2F(x)(x3, . . . , xk) for x ∈U and x3, . . . , xk ∈X. The ﬁrst derivative
DG: U →L(X, Y ) exists by Corollary 5.26 and is given by
(DG)(x)(w) = dk−1F(x)(w, x3, . . . , xk)
for any x ∈U and w ∈X. We claim that the second derivative D2G(u) exists
and satisﬁes, for any x1, x2 ∈X,
D2G(u)(x1)(x2) = d2G(u)(x1, x2) = dkF(u)(x1, x2, x3, . . . , xk).
Indeed, since F is diﬀerentiable of order k at u, letting M := Qk
j=3 ∥xj∥,
∥DG(x) −DG(u) −dkF(u)(x −u, ·, x3, . . . , xk)∥L(X,Y )
≤M∥dk−1F(x) −dk−1F(u) −dkF(u)(x −u, . . . )∥L(k−1X,Y ) = o(∥x −u∥)
as x →u by (a) ⇒(b) of Proposition 5.25, proving the claim.
By the ﬁrst part of the proof, we have
dkF(u)(x1, x2, x3, . . . , xk) = d2G(u)(x1, x2) = d2G(u)(x2, x1)
= dkF(u)(x2, x1, x3, . . . , xk).
(5.29)
Now the symmetry of dkF(u) follows from (5.28) and (5.29). The proof of the
theorem is complete.
2
A mapping F is called a Ck function on U ⊂X if the derivatives of F
through order k all exist on U and are continuous. A mapping F is called a
C∞function on U ⊂X if it is a Ck function for each k.

256
5 Derivatives and Analyticity in Normed Spaces
Theorem 5.28. For a normed space X, a Banach space Y , and u ∈X, let
P
m≥0 P m
u (x −u) be a power series around u from X to Y whose radius of
uniform convergence is ρu > 0, and let F(x) be its sum for x ∈B(u, ρu). For
each m ≥1, let Lm
u ∈Ls(mX, Y ) be such that P m
u = (Lm
u )e, and let ρ be deﬁned
by (5.16). Then F is a C∞function on B(u, ρ), and for each v ∈B(u, ρ) and
n ≥1,
dnF(v) = n!Ln
u +
X
m≥n+1
m(m −1) · · · (m −n + 1)Lm
u (v −u)⊗m−n.
(5.30)
In particular, Ln
u = dnF(u)/n!.
Proof. The proof is by induction. Let v ∈B(u, ρ). By Theorem 5.21, for each
x ∈B(v, ρ−∥v −u∥), we have F(x) = F(v)+P
k≥1 P k
v (x−v), where each P k
v
is given by (5.17) and the power series P
k≥0 P k
v (x −v) has radius of uniform
convergence ρv ≥ρ −∥v −u∥. If 0 < r < ρ −∥v −u∥then by Theorem 5.10,
the series P
k≥1 ∥P k
v ∥rk converges. Letting C1 := sup{∥P k
v ∥rk : k ≥2} < ∞,
if ∥x −v∥< r, we have
F(x) −F(v) −P 1
v (x −v)
 ≤
X
k≥2
∥P k
v ∥∥x −v∥k
≤
C1∥x −v∥2
r(r −∥x −v∥) = o(∥x −v∥)
as ∥x −v∥→0. Thus F is diﬀerentiable at v and its derivative D1F(v) is
given by (5.17) with k = 1. Since v ∈B(u, ρ) is arbitrary, F is diﬀerentiable
on B(u, ρ) and (5.30) holds with n = 1.
Suppose that for some n ≥1, F has an nth diﬀerential on B(u, ρ) and
(5.30) holds. Recalling the deﬁnition (5.5), for each integer m ≥1 and
(x1, . . . , xm) ∈Xm, let
Km,n
u
(x1, . . . , xm)
:= (m + n)(m + n −1) · · · (m + 1)Lm+n
u
(x1, . . . , xm) ∈L(nX, Y ). (5.31)
Let Km
u
:= Km,n
u
since n is ﬁxed for the present. It is clear that each
Km
u is a bounded symmetric m-linear mapping from Xm to L(nX, Y ). Let
˜Km
u := (Km
u )ebe the m-homogeneous polynomial corresponding to Km
u . By
the Cauchy–Hadamard formula (Theorem 5.10), we have
lim sup
m→∞
 ˜Km
u
1/m ≤lim sup
m→∞

(m + n) · · · (m + 1)∥P m+n
u
∥
	1/m = 1
ρu
.
Again by Theorem 5.10, it follows that the power series P
m≥1 ˜Km
u (x −u)
around u from X to L(nX, Y ) has radius of uniform convergence ≥ρu. By
(5.30) with x = u, dnF(u) = n!Ln
u, and so by a change of index of summation,

5.2 Higher Order Derivatives and Taylor Series
257
dnF(x) −dnF(u) =
X
m>n
m(m −1) · · · (m −n + 1)Lm
u (x −u)⊗m−n
=
X
m≥1
˜Km
u (x −u).
Let v ∈B(u, ρ). By Theorem 5.21 with dnF in place of F and L(nX, Y ) in
place of Y , for each x ∈B(v, ρ−∥v −u∥), we have dnF(x) = P
k≥0 Qk
v(x−v),
where Q0
v ≡dnF(v),
Qk
v = ˜Kk
u +
X
m>k
m
k

Km
u (v −u)⊗m−k ∈P k(X, L(nX, Y ))
for each k ≥1, and the power series P
k≥0 Qk
v(x −v) has radius of uniform
convergence ρv ≥ρ −∥v −u∥. In particular, for the term with k = 1 and for
each x ∈X, we have by (5.31)
Q1
v(x) = ˜K1
u(x) +
X
m>1
mKm
u (v −u)⊗m−1(x) = Ln+1
v
(x, · · · ) ∈L(nX, Y ),
where Ln+1
v
∈L(n+1X, Y ) is deﬁned by
(n + 1)!Ln+1
u
+
X
m≥2
m(m + 1) · · · (m + n)Lm+n
u
(v −u)⊗m−1
= (n + 1)!Ln+1
u
+
X
k≥n+2
k(k −1) · · · (k −n)Lk
u(v −u)⊗k−n−1.
As in the case n = 1, for 0 < r < ρ −∥v −u∥, letting Cn := sup{∥Qk
v∥rk : k ≥
2} < ∞, if ∥x −v∥< r, it follows that
dnF(x) −dnF(v) −Q1
v(x −v)
 ≤
X
k≥2
∥Qk
v∥∥x −v∥k ≤
Cn∥x −v∥2
r(r −∥x −v∥),
and the right side is o(∥x −v∥) as ∥x −v∥→0. Thus by Proposition 5.25, F
is diﬀerentiable of order n+1 at v and dn+1F(v) = Ln+1
v
. Since v ∈B(u, ρ) is
arbitrary, dnF is diﬀerentiable on B(u, ρ) and (5.30) holds with n replaced by
n + 1. Since diﬀerentiable functions are continuous, it then follows that each
dnF is continuous. By induction, F is a C∞function on B(u, ρ). The proof
of Theorem 5.28 is complete.
2
Let X and Y be Banach spaces and U a connected open subset of X. A
mapping F : U →Y has a Taylor expansion around a point u ∈U if there
exists a power series P
k≥0 P k
u (x −u) around u from X to Y which converges
to F uniformly on a ball B(u, r) ⊂U for some r > 0. By Theorem 5.10, the

258
5 Derivatives and Analyticity in Normed Spaces
power series converges absolutely on a neighborhood of u, and so it is unique
by Theorem 5.9. Moreover, by Theorem 5.28, for x ∈B(u, ρ), where ρ ≥e−1r,
F(x) = F(u) +
X
k≥1
1
k!dkF(u)(x −u)⊗k.
(5.32)
The right side will be called the Taylor series of F around u. We have P k
u =
(dkF(u))e/k!, and so the Taylor series has a form as in the one-dimensional
case. A mapping F : U →Y is analytic on U if F has a Taylor expansion
around each point of U.
A sum of a power series around u with ρu > 0 is analytic on B(u, ρ) for
some ρ > 0, as follows from Theorem 5.21:
Corollary 5.29. For a normed space X, a Banach space Y , and u ∈X, let
P
m≥0 P m
u (x −u) be a power series around u from X to Y whose radius of
uniform convergence is ρu > 0, and let F(x) be its sum for x ∈B(u, ρu).
Then F is analytic on B(u, ρ), where ρ ≥e−1ρu.
The following compares analyticity with B-analyticity as in Deﬁnition 5.17.
Theorem 5.30. Let U be a nonempty connected open subset of a unital Ba-
nach algebra B. Then
(a) any B-analytic function F from U into B is analytic from U into B, and
for each u ∈U, its B-Taylor series (5.14) is its Taylor series around u;
(b) if (5.14) holds whenever ∥x −u∥< r, then for the radius ρu of uniform
convergence, ρu ≥r, and F has a B-Taylor series around x with ρx ≥
ρu −∥x −u∥.
Proof. For each k, X ∋x 7→hkxk = P k[hk](x) is a k-homogeneous polynomial
as deﬁned before Lemma 5.13, and so (5.14) is a power series around u from
B to B. By Theorem 5.18, (5.14) converges uniformly on some neighborhood
of u, and so (a) holds.
For (b), by Lemma 5.13 we have ∥P k[hk]∥= ∥hk∥. Thus ρu ≥r by Theo-
rems 5.18 and 5.10, proving the ﬁrst part of (b). The second part follows from
Theorem 5.21(b) and Corollary 5.23(d), proving the theorem.
2
Analytic continuation
Here we prove that an analytic function from an interval in R into a Banach
space can be extended to a holomorphic function on an open subset of the
complex plane. We begin with several lemmas.
Lemma 5.31. Let Y be a Banach space and let P
k≥0 cktk be a power series
from R to Y around 0, identifying P k(R, Y ) with Y for k = 0, 1, . . . , where
for c ∈Y , P ∈P k(R, Y ) is deﬁned by P(t) = tkc. Suppose that the power
series converges to g(t) on a ball B(0, r) with radius r > 0. If there is a ck ̸= 0
then there is a 0 < q < r such that g(t) ̸= 0 for 0 < |t| < q.

5.2 Higher Order Derivatives and Taylor Series
259
Proof. Let k be the minimal integer such that ck ̸= 0. Then g(t) = tk(ck +
· · · + ck+ntn + · · · ) and the series P
n≥0 ck+ntn converges, say to h(t), for
t ∈B(0, r). The sum h is continuous by the proof of Proposition 2.96 with C
replaced by R. Since h(0) = ck ̸= 0, there is a 0 < q < r such that h(t) ̸= 0
for t ∈B(0, q), proving the lemma.
2
Lemma 5.32. Let X, Y be Banach spaces, and let f be an analytic function
from a convex open set U ⊂X into Y . If f is equal to 0 on a nonempty open
subset of U then f ≡0 on U.
Proof. Let V be an open subset of U such that f = 0 on V , let v ∈V , and let
u be any point in U. Since the segment joining v and u is included in U, the
function g(t) := f(v + t(u −v)), t ∈[0, 1], is deﬁned and analytic on an open
interval including [0, 1]. Let D be the set of all t ∈[0, 1] such that g(s) = 0
for 0 ≤s ≤t, and let d := sup{t ∈[0, 1]: t ∈D}. By assumption, d > 0.
Suppose d < 1. Since g has a Taylor expansion around d, there is a Taylor
series P
k≥0 ck(t −d)k which converges to g(t) for t ∈B(d, ǫ) and some ǫ > 0.
If all ck = 0 then g(t) = 0 for t < d + ǫ, a contradiction. If there is a ck ̸= 0
then g(t) ̸= 0 for some 0 < t < d by Lemma 5.31, again a contradiction. Thus
d = 1, and so f(x) = 0, proving the lemma.
2
Theorem 5.33. Let X, Y be Banach spaces, let U be a connected open subset
of X, and let f be an analytic function from U into Y . If for some u ∈U, f
is zero on a neighborhood of u, then f ≡0 on U.
Proof. Let A be the interior of the set of all x ∈U such that f(x) = 0. Then
A is open and nonempty by assumption. We prove that A is also closed in U,
and so equal to U since U is connected. Let u ∈U be a limit point of A. Since
f has a Taylor expansion around u, there is an open ball B(u, r) ⊂U with
center u and radius r > 0, so that f is analytic on B(u, r). The intersection
B(u, r) ∩A includes another open ball V such that f(x) = 0 for x ∈V . By
Lemma 5.32, f(x) = 0 for x ∈B(u, r), and so u ∈A, proving the theorem. 2
Theorem 5.34. Let X, Y be complex Banach spaces, and let R be a real
vector subspace of X such that the complex subspace Rc := R + iR is dense
in X. If f and g are analytic on a connected open set U in X, and f = g on
some nonempty set V ⊂U ∩R, relatively open in R, then f = g on U.
For the proof we need the following lemma:
Lemma 5.35. Let R be as in the preceding theorem, and let for some k ≥0,
P ∈P k(X, Y ) be such that P vanishes on R. Then P ≡0.

260
5 Derivatives and Analyticity in Normed Spaces
Proof. We can assume that k ≥2. Let L ∈Ls(kX, Y ) be such that P = ˜L,
that is, Px = Lx⊗k for all x ∈X. By the binomial formula (5.8), we have
P(x + iy) = L(x + iy)⊗k =
k
X
l=0
il
k
l

Lx⊗k−l ⊗y⊗l
for x, y ∈X. Since P = 0 on R, by the polarization Theorem 5.6, L = 0 on
Rk, and so P(x + iy) = 0 for all x, y ∈R. Thus P = 0 on the dense set Rc in
X. Since P is continuous, P ≡0, proving the lemma.
2
Proof of Theorem 5.34. It is enough to prove the theorem with g ≡0
on U. Let u ∈V , and let P
k≥0 P k
u be a power series representation of f on an
open ball B(u, ρ) ⊂X for some ρ > 0. By Theorem 5.10, the series converges
absolutely on B(u, ρ). Since f = 0 on V ⊂R, by Theorem 5.9, P k
u (x) = 0 for
all x ∈R and k = 0, 1, . . . . By Lemma 5.35, P k
u (x) = 0 for all x ∈Rc = R+iR
and k = 0, 1, . . . , and so f is zero in a neighborhood of u in X. This proves
that f ≡0 on U by Theorem 5.33. The proof of Theorem 5.34 is complete.
2
Now we are ready to prove that an analytic function on an open interval
extends to a holomorphic function on an open subset of C.
Theorem 5.36. Let Y be a complex Banach space, let U be a nonempty open
interval in R, and let f be an analytic function from U into Y . Then there
are an open connected set V ⊂C such that V ∩R = U and a holomorphic
mapping g from V into Y such that g = f on V .
Proof. For each k = 1, 2, . . . , we identify P k(R, Y ) with Y as in Lemma
5.31. Let u ∈U. There is a sequence {ck}k≥0 ⊂Y and r > 0 such that
f(x) = P∞
k=0 ck(x−u)k and (by Theorem 5.10, or directly) the series converges
absolutely and uniformly for x ∈R and |x−u| < r. Let Au := {z ∈C: |z−u| <
r} and Qu := Au ∩R. Then the power series P∞
k=0 ck(z −u)k converges
absolutely and uniformly on Au by Theorem 5.10. Let gu be its sum on Au.
If u, v ∈U are such that Au ∩Av ̸= ∅then also Qu ∩Qv = (Au ∩Av) ∩R ̸= ∅
and we have gu = gv = f on Qu ∩Qv. Since Au ∩Av is connected, by Theorem
5.34, gu = gv on Au ∩Av. Take V := ∪u∈UAu and deﬁne g to be equal to gu
on each Au. Clearly V is connected. Since g has a Taylor expansion around
each point of V by Corollary 5.23(e), g is analytic on V and agrees with f on
U. The proof is complete.
2
Uniformly entire mappings
A function of one complex variable is called entire if it is analytic (holomor-
phic) on the complex plane. It then has a Taylor series around any point,

5.2 Higher Order Derivatives and Taylor Series
261
converging on the whole plane, uniformly on bounded sets. This is no longer
true for power series on an inﬁnite-dimensional space as the following shows.
Example 5.37. As in Example 5.12, let F : ℓ2 →R be deﬁned by F(x) :=
P
k≥1(xk)k for each x = {xj}j≥1 ∈ℓ2. For any u = {uj}j≥1 ∈ℓ2, by the
binomial formula, we have
F(x) = F(u + x −u) =
X
k≥1
(uk + xk −uk)k =
∞
X
k=1
k
X
j=0
k
j

uk−j
k
(xk −uk)j.
For any ﬁxed u, the double series converges absolutely and uniformly for
∥x−u∥≤ρ provided P
k≥1(|uk|+ρ)k < ∞. The latter holds if and only if ρ <
1. Then the series can be rearranged so that F(x) = F(u) + P
j≥1 P j
u(x −u),
where for each j ≥1,
P j
u(x −u) :=
∞
X
k=j
k
j

uk−j
k
(xk −uk)j.
This gives the Taylor series of F around u with radius of uniform convergence
ρu ≥1. For l = 1, 2, . . ., letting xl
k := uk + 1 if k = l and xl
k := uk if k ̸= l,
we have that xl = {xl
k}k≥1 ∈ℓ2 with ∥xl −u∥= 1 and P
j≥l P j
u(xl −u) =
P l
u(xl −u) = 1. Thus the power series P
j≥1 P j
u(x −u) does not converge
uniformly on the closed ball ¯B(u, 1), and so ρu = 1 for any u ∈ℓ2.
A mapping F : X →Y will be called uniformly entire on X if F is analytic
on X with inﬁnite radius of uniform convergence of its Taylor series around
any point of X. It is equivalent, by Theorem 5.21, that its Taylor series around
0 has inﬁnite radius of uniform convergence.
Composition of analytic functions
We will prove that a composition of analytic functions between Banach spaces
is analytic. Let X and Y be Banach spaces and for k = 0, 1, . . . let P k ∈
P k(X, Y ) be a continuous k-homogeneous polynomial. Let P
:= {P k}∞
k=0
and ρP := 1/ lim supk→∞∥P k∥1/k, which by (5.11) is the radius of uniform
convergence of the power series P∞
k=0 P k(x) around 0, or of P∞
k=0 P k(x −u)
around u for any u ∈X. Also let Lk ∈Ls(kX, Y ) be a continuous symmetric
k-linear map for each k = 1, 2, . . . , let L0 be any element of Y , and let L :=
{Lk}∞
k=0. Let ρL
:= 1/ lim supk→∞∥Lk∥1/k, as in (5.16). If P k = (Lk)efor
each k ≥1 and P 0 ≡L0 ∈Y then a power series around any u ∈X can be
written in two equivalent ways, P
k≥0 P k(x −u) ≡P
k≥0 Lk(x −u)k, where
L0(x −u)0 := L0 ∈Y . Its radius of uniform convergence is ρP. We have
∥P k∥≤∥Lk∥for all k, so ρL ≤ρP. Conversely it was shown in Theorem 5.21
that ρL ≥ρP/e.
Here is a fact about composition of analytic functions.

262
5 Derivatives and Analyticity in Normed Spaces
Theorem 5.38. Let X, Y , and Z be three Banach spaces. Let ξ ∈X with
ξ ∈U, a connected open set, and let F be an analytic function from U into a
connected open set V ⊂Y . Let F have the power series around ξ
F(x) =
∞
X
k=0
P k(x −ξ)
where P k ∈P k(X, Y ) and the series has radius of uniform convergence ρP >
0. Let η := F(ξ) ∈Y . Let G be an analytic function from V into Z, with
power series around η given by
G(y) =
∞
X
j=0
Bj(y −η)j
where Bj ∈Ls(jY, Z) for each j, and let this series also have radius of uniform
convergence ρQ > 0 where Q = {(Bj)e}j≥0. Then for some r with 0 < r < ρP,
there exists an M with 0 < M < ρB for B = {Bj}j≥0 such that
∞
X
k=0
∥P k∥rk ≤M.
(5.33)
For any such r and M, F restricted to a ball B(ξ, r) takes values in another
ball B(η, M), the composition G◦F from B(ξ, r) into Z is analytic, and its
power series around ξ has radius of uniform convergence at least r.
If F and G are uniformly entire from X into Y and Y into Z respectively,
then G◦F is uniformly entire from X into Z.
Proof. Let φ(u) := F(ξ + u) −F(ξ) for all u ∈X such that ξ + u ∈U. Then
φ is deﬁned and analytic on a neighborhood of 0 and has the power series
φ(u) = P∞
k=1 P k(u) around 0. Let ψ(v) := G(η + v) −G(η) for all v ∈Y such
that η + v ∈V . Then ψ is deﬁned and analytic on a neighborhood of 0 in Y
and has the power series ψ(v) = P∞
j=1 Bjvj around 0. The hypotheses hold
for φ, ψ, 0, 0 in place of F, G, ξ, η respectively, with the same P k for k ≥1, the
same Bj for j ≥1, and so the same ρP and ρB. Suppose the conclusion holds
also. We would then have a power series (ψ◦φ)(u) = P∞
l=1 πl(u) for some l-
homogeneous polynomials πl from X into Z, where the series has convergence
properties as stated. Substituting, we would then get
G(F(x)) = G(F(ξ)) +
∞
X
l=1
πl(x −ξ)
for ∥x −ξ∥< r, with the same polynomials πl for l ≥1. Thus we can assume
that ξ = 0 in X and η = 0 in Y .
Next, here is a lemma for power series in real variables.

5.2 Higher Order Derivatives and Taylor Series
263
Lemma 5.39. Let r > 0 and al ≥0 be real numbers and set f(u) =
P∞
l=1 alul. Assume that the series converges for all real u with |u| ≤r. Then
for any j = 2, 3, . . . , f(u)j = P∞
l=1 cj,lul where all cj,l ≥0 and the series also
converges for |u| ≤r. We have a ﬁnite sum
cj,l =
X (
jY
m=1
alm : lm ≥1,
j
X
m=1
lm = l
)
.
(5.34)
The lemma is straightforward to prove (the sum has at most lj terms).
We return to the proof of the theorem.
Since 0 < r < ρP, the series f(r) := P∞
k=1 ∥P k∥rk converges. Recall that
ρB ≥ρQ/e > 0. We have f(r) ↓0 as r ↓0. Thus for any M with 0 < M < ρB,
there exists r > 0 for which f(r) ≤M. Fix such an M and r.
We have for ∥x∥≤r that F(x) = P∞
k=1 P k(x) is uniformly and absolutely
convergent, with the norms of terms dominated termwise by the terms of the
series of nonnegative numbers P∞
k=1 ∥P k∥rk ≤M.
The series P∞
j=1 Bjyj is absolutely convergent uniformly for y with ∥y∥≤
M, in particular for y = F(x) with ∥x∥≤r. Moreover, in each term BjF(x)j,
if we substitute in F(x) = P
k P k(x), we will get, due to the boundedness of
Bj, a convergent inﬁnite series of terms of the form Bj(P i1(x), . . . , P ij(x)),
such that the sum of the norms of all these terms is bounded above by
∥Bj∥M j. Further, when we sum over j, we again get a convergent sum of
norms because M < ρB. Thus we get by dominated convergence a series con-
verging absolutely to G(F(x)) in Z. In the whole sum, for any given ﬁnite
degree l in x, there are only ﬁnitely many terms of that degree, since such
terms occur only for j ≤l and k ≤l. Speciﬁcally, for each l ≥1 let
πl(x) :=
l
X
j=1
X (
Bj(P i1(x), . . . , P ij(x)) : im ≥1 for all m,
j
X
m=1
im = l
)
.
This is a ﬁnite sum (although with many terms for large l), and so a poly-
nomial. For each j, its terms correspond one-to-one to terms in (5.34). It
is the sum of all terms homogeneous of degree l in the series for G(F(x)).
Each term in the sum has norm at most ∥Bj∥Qj
m=1 ∥P im∥rl. Now we apply
Lemma 5.39 to the function f(u) = P∞
l=1 ∥P l∥ul, so that f(r) ≤M and for
each j = 1, 2, . . . , f(r)j ≤M j. Then in the lemma,
cj,l =
X n
jY
m=1
∥P im∥: im ≥1 for all m,
j
X
m=1
im = l
o
.
This implies the bound ∥πl∥≤Pl
j=1 ∥Bj∥cj,l. We want to show that
P∞
l=1 ∥πl∥rl < ∞. For each ﬁxed j, we have by Lemma 5.39 that P∞
l=1 cj,lrl =
f(r)j ≤M j. Then, P
j ∥Bj∥M j < ∞because 0 < M < ρB. So indeed,
P∞
l=1 ∥πl∥rl < ∞. Thus the series G(F(x)) = P∞
l=1 πl(x) is absolutely and

264
5 Derivatives and Analyticity in Normed Spaces
uniformly convergent for ∥x∥≤r, with values in Z. The conclusions follow.
2
5.3 Taylor’s Formulas
Here we prove a Taylor’s formula with integral remainder (Theorem 5.42) for
a smooth function on an open subset U of a Banach space X with values
in another Banach space Y . Then a criterion for analyticity, Theorem 5.43,
will follow. In this section for functions f : [0, 1] →Y and θ: [0, 1] →R, the
integral
Z 1
0
f(t) dθ(t) := (RS)
Z 1
0
f·dθ
is deﬁned as an element of Y using the natural bilinear mapping B : Y ×R →
Y , provided the Riemann–Stieltjes integral is deﬁned.
Lemma 5.40. Let X, Y be two Banach spaces, U an open subset of X, and
F a continuously diﬀerentiable mapping of U into Y . If the segment joining
u and u + x is included in U, then
F(u + x) −F(u) =
Z 1
0
DF(u + tx)x dt.
Proof. Let φ(t) := u + tx ∈U for all t in an open interval V ⊂R including
[0, 1], and let G be the composition F◦φ, deﬁned from V into Y . By the chain
rule for diﬀerentiation of a composition (Theorem 5.1), DG(t) = DF(u +
tx)◦Dφ(t) for each t ∈V , and so G is a continuously diﬀerentiable function
on V . By (5.3) in the mean value theorem, for 0 ≤s < t ≤1,
G(t) −G(s) −DG(s)(t −s)
 ≤(t −s) sup
s≤v≤t
DG(s) −DG(v)
.
Since DG is continuous on [0, 1], given ǫ > 0 there is a δ > 0 such that
Osc(DG; [s, t]) < ǫ whenever t −s < δ. Therefore using telescoping sums, it
follows that
∥G(1) −G(0) −SRS(DG, dθ; τ)∥< 2ǫ
for each tagged partition τ of [0, 1] with mesh |τ| < δ, where θ(t) ≡t. Thus
F(u + x) −F(u) = G(1) −G(0) =
Z 1
0
DG(t) dt =
Z 1
0
DF(u + tx)x dt,
as desired.
2

5.3 Taylor’s Formulas
265
First, we prove the Taylor formula in the case when X = R and U is an
open interval. Let F be a function from U to Y , diﬀerentiable of order n at
u ∈U. Since X = R, for each k = 1, . . . , n, we identify Ls(kR, Y ) with Y via
y ↔Lk[y] deﬁned by Lk[y](t1, . . . , tk) := t1 · · · tky. So there exists hk(u) ∈Y
such that dkF(u) = Lk[hk(u)]. In this case, we let
dkF(u) := dkF(u)(1, . . . , 1) = hk(u).
(5.35)
The Taylor polynomial Tn(·) of F around u of order n is deﬁned by
Tn(x) = F(u) +
n
X
k=1
1
k!dkF(u)xk
for each x ∈R. In this case Taylor’s formula with an integral remainder is
given by the following theorem.
Theorem 5.41. Let U be an open interval in R, let Y be a Banach space,
and for some integer n ≥1, let F be a Cn function on U with values in Y .
Then for any pair of numbers u and u + x in U, we have
F(u + x) −Tn(x) =
Z 1
0

dnF(u + tx) −dnF(u)

xn dθn(t),
(5.36)
where θn(t) := −(1 −t)n/n! for t ∈[0, 1].
Proof. The Riemann–Stieltjes integral in (5.36) exists since the integrand is
continuous and θn is smooth. The proof of the equality in (5.36) will be by
ﬁnite induction in k = 1, . . . , n. Suppose that k = 1. By Lemma 5.40, it follows
that
F(u + x) −T1(x) = F(u + x) −F(u) −d1F(u)x
=
Z 1
0

d1F(u + tx) −d1F(u)

x dt.
Thus, (5.36) holds with n = 1. Suppose that (5.36) holds for some integer
1 ≤k < n instead of n. We then have (recalling Theorem 2.80 on integration
by parts)

266
5 Derivatives and Analyticity in Normed Spaces
F(u + x) −Tk(x)
=
Z 1
0

dkF(u + tx) −dkF(u)

xk dθk(t)
=
Z 1
0
Z t
0
(D(dkF))(u + sx) ds dθk(t)xk+1
by Lemma 5.40
= θk
Z (·)
0
(D(dkF))(u + sx) ds

1
0
integrating by parts
−
Z 1
0
θk(t) d
 Z t
0
(D(dkF))(u + sx) ds

xk+1
e.g. (2.77)
= −
Z 1
0
θk(t)(D(dkF))(u + tx) dt xk+1
by Proposition 2.86
=
Z 1
0
(dk+1F)(u + tx)xk+1 dθk+1(t)
by Proposition 5.25
since θk+1(t) = −∫t
0 θk(s) ds for t ∈[0, 1]. It then follows that
F(u + x) −Tk+1(x) = F(u + x) −Tk(x) −
Z 1
0
dk+1F(u)xk+1 dθk+1(t)
=
Z 1
0

dk+1F(u + tx) −dk+1F(u)

xk+1 dθk+1(t).
Thus (5.36) holds with k + 1 instead of n whenever it holds with k instead of
n. The proof is complete by induction.
2
Let X, Y be two Banach spaces, U an open subset of X, and for a positive
integer n, G: U →Y a function diﬀerentiable of order n at u ∈U. Let Tn(·)
be the Taylor polynomial of G around u of order n, that is, for each x ∈X,
Tn(x) = G(u) +
n
X
k=1
1
k!dkG(u)x⊗k.
The following extends the Taylor formula with an integral remainder of the
preceding theorem to a Banach space X.
Theorem 5.42. Let X, Y be two Banach spaces, let U be an open subset of
X, and for some integer n ≥1, let G be a Cn function on U with values in
Y . If the segment joining u and u + x is included in U, then
G(u + x) −Tn(x) =
Z 1
0

dnG(u + tx) −dnG(u)

x⊗n dθn(t),
(5.37)
where θn(t) := −(1 −t)n/n! for t ∈[0, 1].

5.3 Taylor’s Formulas
267
Proof. The Riemann–Stieltjes integral in (5.37) exists since the integrand is
continuous and θn is smooth. Let φx(t) := u + tx ∈U for all t in an open
interval V including [0, 1]. To prove (5.37) we apply (5.36) to F(t) := G(u +
tx) = G◦φx(t), with t ∈V . By the chain rule (Theorem 5.1), using ﬁnite
induction in k = 1, . . . , n and (5.35), it follows that F is a Cn function on V
and
dkF(t) = DkF(t)(1) · · · (1) = DkG(u + tx)(x) · · · (x) = dkG(u + tx)x⊗k
for k = 1, . . . , n. Thus by (5.36), it follows that
G(u + x) = F(1) = F(0) +
n
X
k=1
dkF(0)
k!
+
Z 1
0

dnF(t) −dnF(0)

dθn(t)
= Tn(x) +
Z 1
0

dnG(u + tx) −dnG(u)

x⊗n dθn(t),
proving (5.37). The proof of Theorem 5.42 is complete.
2
Next, necessary and suﬃcient conditions will be established for a function
to have a Taylor expansion around a point. A condition related to condition
(b) below was used in Corollary 5.11 to characterize uniform convergence of a
power series.
Theorem 5.43. Let X, Y be two Banach spaces and let U be a connected
open subset of X. A function F : U →Y has a Taylor expansion around u ∈U
if and only if there exist constants c ≥0 and r > 0 such that
(a) F is a C∞function on the open ball B(u, r);
(b) ∥dnF(x)∥≤cnn! for x ∈B(u, r) and n = 1, 2, . . ..
Then the Taylor series converges uniformly and absolutely on B(u, ρ) when-
ever 0 < ρ < 1/c and ρ ≤r.
Proof. First suppose that F has a Taylor expansion around u ∈U. There-
fore there is a power series around u from X to Y whose radius of uniform
convergence is ρu > 0 and F(x) is its sum for x ∈B(u, ρu). Let ρ be deﬁned
by (5.16), and let r := ρ/2. Then r ≥ρu/(2e) > 0 by Theorem 5.21 and (a)
follows by Theorem 5.28. By statements (b) and (c) of Theorem 5.21, for each
v ∈B(u, r), there is a power series P
n≥0 P n
v (x −v) converging to F(x) for
each x ∈X such that ∥x −v∥< ρ −∥v −u∥, and having radius of uniform
convergence ρv ≥ρ −r = r. By Theorem 5.28 applied to the power series
P
n≥0 P n
v (x −v) for v = u, (dnF(v))e= n!P n
v on X for each n ≥1. Therefore
using (5.10), (5.11), and Stirling’s formula, for each such v,
lim sup
n→∞
∥dnF(v)∥
n!
1/n
≤lim sup
n→∞
nn∥P n
v ∥
n!
1/n
= e
ρv
≤2e
ρ < ∞.

268
5 Derivatives and Analyticity in Normed Spaces
Thus there is a ﬁnite constant c such that ∥dnF(v)∥/n!)1/n ≤c for all n ≥1
and v ∈B(u, r), and so (b) follows.
To prove the converse implication let (a) and (b) hold for some constants
c ≥0 and r > 0. We can assume that c > 0 since otherwise F is a constant
function. By (a) and Theorem 5.42, for each integer n ≥1, Taylor’s formula
with an integral remainder (5.37) holds with U = B(u, r). Let n ≥1 and
∥x∥< r. By Proposition 2.13, using the bound (2.84) for the RS integral,
since v1(θn) = 1/n!, we have
F(u + x) −Tn(x)
 ≤6∥x∥n
n!
sup
0≤t≤1
dnF(u + tx)
 ≤6(rc)n
for each n ≥1. For any ρ such that ρc < 1 and ρ ≤r, it follows that the
power series F(u) + P
n≥1(dnF(u)/n!)x⊗n converges to F(u + x) absolutely
and uniformly on B(u, ρ), proving the “if” part and the last conclusion, and
hence proving the theorem.
2
Let X, Y be two Banach spaces, U an open subset of X, and G: U →Y
a function diﬀerentiable of order n at u ∈U. For x ∈X such that u + x ∈U,
the remainder in Taylor’s expansion of G around u of order n is deﬁned by
Remn
G(u, x) := G(u + x) −Tn(x) = G(u + x) −G(u) −
n
X
k=1
dkG(u)x⊗k
k!
.
If G is a Cn function on U, then the Taylor formula with an integral remainder
holds by Theorem 5.42, which implies that ∥Remn
G(u, x)∥= o(∥x∥n) as ∥x∥→
0. The next theorem gives the same order of smallness but requires only
diﬀerentiability of order n at u.
Theorem 5.44. Let X, Y be two Banach spaces, let u be an element of an
open subset U of X, and let G: U →Y be a function diﬀerentiable of order
n at u. Then ∥Remn
G(u, x)∥= o(∥x∥n) as ∥x∥→0.
Proof. If n = 1, then the conclusion holds by the deﬁnition of Fr´echet diﬀer-
entiability of G at u. Suppose that n > 1 and that the statement holds when
n is replaced by some m, 1 ≤m < n. It will be proved to hold for m + 1. Let
r > 0 be such that B(u, r) ⊂U and G is diﬀerentiable of order m on B(u, r).
For each x ∈B(0, r), let R(x) := Remm+1
G
(u, x) ∈Y . It will be shown that
R is diﬀerentiable on B(0, r) with derivative DR(x) = L(x) ∈L(X, Y ) for
x ∈B(0, r), where
L(x)(·) := DG(u + x)(·) −DG(u)(·) −
m+1
X
k=2
1
(k −1)!dkG(u)x⊗k−1 ⊗(·).
Let x ∈B(0, r) \ {0}. For each y ∈B(0, r) such that x + y ∈B(0, r), we have

5.4 Tensor Products of Banach Spaces
269
∥R(x + y) −R(x) −L(x)(y)∥
≤∥G(u + x + y) −G(u + x) −DG(u + x)(y)∥
+
m+1
X
k=2
1
k!
dkG(u)

(x + y)⊗k −x⊗k −kx⊗k−1 ⊗y
	.
The sum on the right side is of order O(∥y∥2) = o(∥y∥) as ∥y∥→0 by the
binomial formula (5.8), and the ﬁrst term on the right side is of order o(∥y∥)
due to diﬀerentiability of G at u + x. Thus R is diﬀerentiable on B(0, r) with
the derivative DR = L.
Up through the next display, all derivatives D, . . . , Dk and diﬀerentials
d, . . . , dk−1 are with respect to the variable u. Derivatives D can be inter-
changed with evaluations at points x or x, x1, x2, . . . , xk−1 by the chain rule,
Remark 5.2, since the evaluations are bounded linear operators. We claim
that dkG(u)(x, . . . ) = dk−1(DG(u)(x)) holds in L(k−1X, Y ) for each x ∈X
and k = 2, . . . , m + 1. Indeed for any x1, . . . , xk in X, using the deﬁnitions of
dkG(u) in (5.23), DkG(u), and (5.22), we have
dkG(u)(x1, . . . , xk)
= DkG(u)(x1)(x2) · · · (xk) = D[· · · D[DG(u)(x1)](x2) · · · ](xk)
= Dk−1[DG(u)(x1)](x2) · · · (xk) = dk−1[DG(u)(x1)](x2, . . . , xk),
proving the claim. Therefore we have L(x) = Remm
DG(u, x). Since DG is dif-
ferentiable of order m at u, ∥DR(x)∥= o(∥x∥m) as ∥x∥→0 by the induction
assumption. By (5.2) in the mean value theorem, for x ∈B(0, r) \ {0}, we
have
∥Remm+1
G
(u, x)∥= ∥R(x)∥= ∥R(x) −R(0)∥
≤∥x∥sup
t∈[0,1]
∥DR(tx)∥= o(∥x∥m+1)
as ∥x∥→0, proving the conclusion with m replaced by m + 1. The theorem
is proved by induction.
2
5.4 Tensor Products of Banach Spaces
Given Banach spaces X and Y over K, we have the Banach space M(X, Y ) :=
M2(X, Y ; K) of bounded bilinear maps from X ×Y into K, deﬁned just before
Theorem 5.4 with the norm (5.4). For each x ∈X, y ∈Y , and L ∈M(X, Y ),
let (x ⊗y)(L) := L(x, y). Then clearly x ⊗y is in the dual Banach space
M(X, Y )′ with the dual norm ∥x ⊗y∥′ ≤∥x∥∥y∥. Deﬁne the tensor product
X ⊗Y as the linear subspace of M(X, Y )′ spanned by all such x ⊗y, i.e. as
the set of all ﬁnite sums Pn
i=1 xi ⊗yi, xi ∈X, yi ∈Y , n = 1, 2, . . . .

270
5 Derivatives and Analyticity in Normed Spaces
Beside the most obvious norm from the present approach, namely the dual
norm ∥· ∥′ in M(X, Y )′, other norms can be deﬁned on X ⊗Y . One is what
is called the projective tensor product norm: for each v ∈X ⊗Y , let
∥v∥π := inf
n
n
X
i=1
∥xi∥∥yi∥: v =
n
X
i=1
xi ⊗yi, xi ∈X, yi ∈Y, n = 1, 2, . . .
o
.
(5.38)
It is easily checked that ∥v∥′ ≤∥v∥π for all v ∈X ⊗Y and that ∥· ∥π is a
seminorm, thus a norm since ∥· ∥′ is on M(X, Y )′.
5.5 Notes
M. Fr´echet deﬁned Fr´echet diﬀerentiability in 1925 ([68] and [69]) and proved
the chain rule for it. A. E. Taylor [230], in a survey of Fr´echet’s work in
analysis, discussed historical precursors of Fr´echet’s work.
The chain rule and the mean value theorem (5.2) are Theorems 8.2.1 and
8.5.4 in Dieudonn´e [42], respectively.
Notes on Section 5.1. The polarization identity of Theorem 5.6 is Theo-
rem 4.6 in Chae [32]. Bounds for norms of k-homogeneous polynomials as in
Theorem 5.7 are given in Theorem 4.13 in [32]. Uniqueness of power series
as in Theorem 5.9 is given in Theorem 11.10 in [32]. The Cauchy–Hadamard
formula of Theorem 5.10 is Theorem 11.5 in [32].
A. Mazur and W. Orlicz in 1935 [163] deﬁned polynomials of degree k in
real normed spaces. A historical discussion of diﬀerent concepts of polynomials
in real and complex normed spaces is given in Taylor [229].
An early proof of Corollary 5.23(e) was by Banach in 1938 [9]. Several
other authors either discovered the fact independently, perhaps even earlier,
or gave other proofs. The proof given is from Bochnak and Siciak [20]. They
attribute it to S.  Lojasiewicz.
Notes on Section 5.2. The higher order derivatives of mappings between
normed spaces are elements of L(X, L(X, Y )), L(X, L(X, L(X, Y ))), . . . . Usu-
ally (e.g. [42], [32]) these derivatives are identiﬁed with multilinear mappings
using the natural isomorphism between spaces Lk(X, Y ) and L(kX, Y ) de-
ﬁned by (5.22). Alternatively, the kth diﬀerential can be deﬁned directly by
induction as follows. Let X, Y be Banach spaces, U an open subset of X, and
F : U →Y . Let d1F := DF where it is deﬁned, as usual. Suppose that for
some k ≥1, the kth diﬀerential of F is deﬁned in a neighborhood of x ∈U
as a k-linear mapping dkF(y) ∈L(kX, Y ). Then the (k + 1)st diﬀerential of
F at x is deﬁned if there exists a (k + 1)-linear bounded mapping L from
X × · · · × X (k + 1 times) into Y such that
dkF(x + xk+1)(x1, . . . , xk) −dkF(x)(x1, . . . , xk)
= L(x1, . . . , xk+1) + R(x; x1, . . . , xk+1)

5.5 Notes
271
for all x1, . . . , xk ∈X, xk+1 in a neighborhood of x and
sup

∥R(x, x1, . . . , xk+1)∥: ∥x1∥= · · · = ∥xk∥= 1
	
= o(∥xk+1∥)
as xk+1 →0. Then the (k + 1)st diﬀerential of F at x is deﬁned to be
dk+1F(x) := L ∈L((k+1)X, Y ). In Zeidler [257, Proposition 4.19] it is proved
that the deﬁnition of the kth diﬀerential dkF(x) just given is equivalent to
the one given by (5.23).
The Schwarz theorem on symmetry of diﬀerentials given by Theorem 5.27
is Theorem 7.9 in [32]. Diﬀerentiability of power series given by Theorem 5.28
is Theorem 11.12 in [32]. The principle of analytic continuation as in Theorem
5.36 is Theorem 9.4.5 in [42].
A. Alexiewicz and W. Orlicz [2] gave a deﬁnition of analytic function
from an open set U in a real Banach space X into another Banach space Y
essentially as above in and around (5.32). Taylor [229, §4] discussed earlier
notions of analyticity in real and complex Banach spaces. More on higher-
order derivatives in normed spaces can be found in the books Chae [32] and
Dieudonn´e [42].
Notes on Section 5.3. The Taylor formula with an integral remainder in
Theorem 5.42 is Theorem 8.14.3 in [42]. The form of Taylor’s theorem as in
Theorem 5.44 is sometimes given W. H. Young’s name. His expansion theorem
in section 13 of [252] has this form when X = Y = R. For the case of Banach
spaces see Theorem 5.6.3 in [30].
Many authors write or assume that the composition G◦F of analytic func-
tions between (connected) open sets in Banach spaces is analytic provided
that the range of F is included in the domain of G. Lemma 5.39 for power
series from R into R with nonnegative coeﬃcients is surely well known and
very likely has been known for a century or more.
In the literature, often the Banach space X is a Hilbert space, in which
case the radius ρu of uniform convergence equals ρ deﬁned by (5.16) as shown
in Corollary 5.23(e). Following Cena [31], we call ρ the radius of restricted
convergence. Also often, K = C. But for general real Banach spaces, we do
not know whether Theorems 5.21 or 5.38 could have been formulated correctly
before the possibility that ρ ̸= ρu was ﬁrst noticed, apparently by L. Nachbin
in the late 1960s according to Chae [32, p. 44]. T. Nguyen [179] proves that
in Theorem 5.21, the factor e−1 can be improved to e−1/2.
Cena [31, Deﬁnition 12] notes, without details, that a power series around
u represents an analytic function in the ball B(u, ρ), as in our Theorem 5.21.
Cena [31, Theorem 14] states a theorem on composition of analytic functions
between real Banach spaces, which is as close as we could ﬁnd to our Theorem
5.38 in the literature. We did not do a full search. Cena does not give a proof,
but the references and discussion suggest an approach via a fact like our lemma
5.39.
Notes on Section 5.4. Schatten [205] in 1950 gave apparently the ﬁrst
systematic book-length exposition on tensor products of normed spaces. He

272
5 Derivatives and Analyticity in Normed Spaces
cites earlier papers by J. von Neumann and himself separately and jointly.
The projective tensor product norm (5.38) is deﬁned in Schatten [205, pp.
36–37].
The norm ||| · ||| deﬁned in Theorem 4.39 on the complexiﬁcation of a real
Banach algebra is the special case of the projective tensor product norm ∥·∥π
deﬁned by (5.38) where X = C, but considered as a real Banach space, i.e. as
the 2-dimensional real Hilbert space ℓ2
2, and Y is the real Banach algebra A.

6
Nemytskii Operators on Some Function Spaces
6.1 Overview
For a nonempty set S, Banach spaces X and Y over a ﬁeld K = R or C, and a
nonempty open set U ⊂X, let G, F, and H be vector spaces of functions acting
from S into X, from U into Y , and from S into Y , respectively. Usually, but not
always, F, G, and H will be normed spaces. Given a function (u, s) 7→ψ(u, s)
from U × S into Y , and a function g: S →U, the Nemytskii operator Nψ is
deﬁned by
Nψ(g)(s) := (Nψg)(s) := ψ(g(s), s),
s ∈S.
(6.1)
Other authors call such an operator a superposition operator, e.g. Appell and
Zabrejko [3]. We use the term Nemytskii operator (as many others have) partly
to distinguish it from the two-function composition operator (F, G) 7→F◦G
to be treated in Chapter 8. Recall also that for a linear operator A we write
Ax
:=
A(x). We will often apply this rule also when A is a Nemytskii
operator.
Deﬁnition 6.1. For a set V ⊂G such that each g ∈V has values in U, we
say that Nψ acts from V into H if Nψg ∈H for each g ∈V .
Some of the questions we consider in this chapter and the next are under
what conditions a Nemytskii operator acts from V into H, is continuous,
Fr´echet diﬀerentiable, or analytic.
A Nemytskii operator Nψ will be called autonomous if ψ(u, s) ≡F(u)
for a function F from U into Y . Then NF g := Nψg ≡F◦g. An autonomous
Nemytskii operator is nonlinear unless F is linear. Fr´echet diﬀerentiability of
the operator V ∋g 7→F◦g ∈H at g = G is equivalent to that of g 7→F◦(G+g)
at g = 0 in G. This is equivalent to Fr´echet diﬀerentiability of the Nemytskii
operator Nφ at g = 0 for φ(u, s) := F(G(s) + u), (u, s) ∈U × S.
In the present chapter, S will be any nonempty set or an interval. It will
be a measure space in Chapter 7. Often U = X = Y = K = R or C. G will be
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_6, 
273

274
6 Nemytskii Operators on Some Function Spaces
a space of bounded functions with sup norm in Section 6.2 and a Wp space in
Section 6.4. For ψ(·, ·) also depending on s, Nemytskii operators Nψ will be
considered on a Banach algebra of real-valued bounded functions in Section
6.3 and on Wp spaces in Section 6.5. This chapter is concerned with spaces
of functions as opposed to equivalence classes for a measure. Chapter 7 will
treat Nemytskii operators from spaces Ls into Lp on a measure space.
6.2 Remainders in Diﬀerentiability
In this section we give a simple bound for remainders in diﬀerentiability of
an autonomous Nemytskii operator NF acting between spaces of bounded
functions, provided the derivative of F is a H¨older function. H¨older classes
were already introduced in Section 1.4. Here is some more related notation.
Let X, Y be Banach spaces over a ﬁeld K, let B be a subset of X with more
than one element, and let 0 < α ≤1. Recall that Hα(B; Y ) is the space of
all α-H¨older functions F : B →Y with the seminorm ∥F∥(Hα) = ∥F∥B,(Hα)
deﬁned by (1.18). As in (4.4), Hα,∞(B; Y ) denotes the space of all bounded
functions F in Hα(B; Y ) with the norm
∥F∥Hα := ∥F∥B,Hα := ∥F∥sup + ∥F∥(Hα),
(6.2)
where ∥F∥sup = ∥F∥B,sup = sup{∥F(x)∥: x ∈B} is the supremum norm.
Since completeness is straightforward to check, we have the following:
Proposition 6.2. For any Banach spaces X and Y , set B ⊂X containing
more than one point, and 0 < α ≤1, (Hα,∞(B; Y ), ∥·∥Hα) is a Banach space.
To deﬁne a local α-H¨older property let U be a nonempty open subset of X
and let δ > 0. Let Uδ be the set of all x ∈U such that ∥x∥≤1/δ and y ∈U
whenever ∥x −y∥< δ. Then Uδ is closed and bounded (possibly empty), and
Uδ ↑U as δ ↓0. Note that Uδ = {x: ∥x∥≤1/δ} if U = X.
The following is straightforward to prove:
Proposition 6.3. Let U be an open subset of a Banach space and let K be
compact with K ⊂U. Then for some k = 1, 2, . . ., K ⊂Bk := U1/k.
Deﬁnition 6.4 (of Hloc
α ). Let 0 < α ≤1 and let X, Y be Banach spaces.
For a nonempty open set U ⊂X, let Uδ, δ > 0, be as just deﬁned. For
m = 1, 2, . . ., let Bm := Bm(U) := U1/m. We say that a function F : U →Y
is α-H¨older locally on U if it is α-H¨older on Bm for all suﬃciently large m.
The class of all such functions is denoted by Hloc
α (U; Y ). We write F ∈Hloc
α
if U = X = Y = K.
Note that if U = X, F is α-H¨older locally on X if and only if it is α-H¨older
on each bounded set in X.

6.2 Remainders in Diﬀerentiability
275
Deﬁnition 6.5 (of H1+α and Hloc
1+α). Let 0 < α ≤1, let X, Y be Banach
spaces, and let U be an open subset of X. For a function F : U →Y , we
write F ∈H1+α(U; Y ) if F is Fr´echet diﬀerentiable on U and its derivative
DF is in Hα(U; L(X, Y )), that is, (1.18) holds with F and Y replaced by DF
and L(X, Y ), respectively. Also, we write F ∈Hloc
1+α(U; Y ) if F is Fr´echet
diﬀerentiable on U and DF ∈Hloc
α (U; L(X, Y )). If U = X = Y = K, we
write H1+α = H1+α(K; K) and Hloc
1+α = Hloc
1+α(K; K).
Note that if F : U →Y is in Hloc
α (U; Y ) or in Hloc
1+α(U; Y ) then F is
bounded on each nonempty subset Bm(U) ⊂U.
Recall that as deﬁned at the beginning of Section 6.1 we have a nonempty
set S, Banach spaces X and Y , and a nonempty open set U ⊂X. Also, G, F,
and H are vector spaces, which we now assume are normed spaces, of functions
acting from S into X, from U into Y , and from S into Y , respectively. For
F ∈F and G ∈G, if the autonomous Nemytskii operator NF is Fr´echet
diﬀerentiable at G from G into H, the remainder in the diﬀerentiability is
deﬁned by (5.1), that is,
RemNF (G, g) = NF (G + g) −NF (G) −(DNF (G))g.
(6.3)
Thus RemNF (G, g) ∈H for each g ∈G, and ∥RemNF (G, g)∥= o(∥g∥) as
∥g∥→0. We will see that for X = Y = K the derivative DNF (G), if it exists,
has the following form.
Deﬁnition 6.6. For an integer k ≥1 and for vector spaces G1, . . . , Gk, H
of K-valued functions on a set S, let T be an operator from the Cartesian
product G1 × · · · × Gk into H, and let h be a K-valued function on S. We say
that T is the k-linear multiplication operator M k[h] induced by h if
M k[h](g1, . . . , gk) := hg1g2 · · · gk = T (g1, . . . , gk) ∈H
for all gj ∈Gj, j = 1, . . . , k. If k = 1, the linear operator M 1[h] will be written
as M[h].
If G1 = · · · = Gk = H = B, a Banach algebra of functions, the k-linear
multiplication operator M k[h] is deﬁned and bounded for any h ∈B, as in
any Banach algebra by (5.12).
The following rather easy diﬀerentiability fact will give bounds on sup
norms of remainders for autonomous Nemytskii operators on open subsets of
ℓ∞spaces. Recall that for a Banach space X, ℓ∞(S; X) is the space of all
bounded X-valued functions on the set S with the supremum norm. We will
consider functions G whose ranges are “well inside” an open set U in the sense
that ran (G) ⊂Bm for some m.
Proposition 6.7. Let S be a nonempty set, let X, Y be Banach spaces, let
U be an open subset of X, and let F ∈Hloc
1+α(U; Y ) for some 0 < α ≤1.
Let G ∈ℓ∞(S; X) be such that ran(G) ⊂Bm for some m. Then there is

276
6 Nemytskii Operators on Some Function Spaces
a neighborhood of zero V in ℓ∞(S; X) such that the autonomous Nemytskii
operator NF acts from G + V into ℓ∞(S; Y ), is Fr´echet diﬀerentiable at G
from ℓ∞(S; X) into ℓ∞(S; Y ), with derivative g 7→(s 7→DF(G(s))g(s)), and
the remainder bound
∥RemNF (G, g)∥sup ≤C∥g∥1+α
sup
(6.4)
holds for all g ∈V , where C := ∥DF∥B2m,(Hα). If in addition X = Y = K
then DNF (G) is the linear multiplication operator M[F ′◦G] from ℓ∞(S) into
itself.
Proof. Let V be the set of all g ∈ℓ∞(S; X) such that ∥g∥sup < 1/(2m). It is
easy to see that ran (G + rg) ⊂B2m ⊂U for each g ∈V and r ∈[0, 1]. Since
F is bounded on B2m, ∥NF (G + g)∥sup ≤∥F∥B2m,sup < ∞for each g ∈V ,
and so NF acts from G + V into ℓ∞(S; Y ).
To show Fr´echet diﬀerentiability of NF at G, for each g ∈ℓ∞(S; X), let Hg
be the function s 7→DF(G(s))g(s), s ∈S. Then for each s ∈S, ∥(Hg)(s)∥≤
∥DF∥Bm,sup∥g∥sup, and so H is a bounded linear operator from ℓ∞(S; X) into
ℓ∞(S; Y ). Since F is continuously diﬀerentiable on U, by Lemma 5.40 we have
for some constant C < ∞, any s ∈S, and g ∈V ,

NF (G + g) −NF (G) −Hg
	
(s)

=

Z 1
0

DF(G(s) + rg(s)) −DF(G(s))

g(s) dr
 ≤C∥g∥1+α
sup
since DF ∈Hα(B2m; L(X, Y )). Thus NF is Fr´echet diﬀerentiable at G with
the derivative DNF (G) = H and (6.4) holds.
If in addition X = Y = K then for each s ∈S, F ′(G(s)) = DF(G(s))1,
and so the value DF(G(s))g(s) is the product F ′(G(s)) times g(s). Since
∥F ′◦G∥sup ≤∥DF∥Bm,sup < ∞, DNF (G) = H is the linear multiplication
operator M[F ′◦G], proving the proposition.
2
6.3 Higher Order Diﬀerentiability and Analyticity
In this section Nemytskii operators are treated on Banach spaces of real-
valued functions, then on Banach algebras of bounded K-valued functions.
We begin with necessary conditions for higher order Fr´echet diﬀerentiability
and analyticity of Nemytskii operators. The conditions for a Nemytskii op-
erator Nψ are expressed in terms of higher order derivatives (more precisely,
diﬀerentials as deﬁned by (5.23)) of the function ψ, deﬁned as follows. Recall
the Banach space L(nX, Y ) of bounded n-linear functions from Xn into Y
deﬁned in Section 5.1.
For functions ψ used in deﬁning Nemytskii operators Nψ we will be con-
sidering the nth Fr´echet diﬀerential ψ(n)
u
with respect to u in ψ(u, s), with s

6.3 Higher Order Diﬀerentiability and Analyticity
277
held ﬁxed. For n = 1 and X = R, we could write in partial derivative notation
ψ(1)
u (u, s) ≡∂ψ(u, s)/∂u. Notions of partial derivative can also be deﬁned for
Fr´echet derivatives. We will not consider ∂ψ(u, s)/∂s, however.
Deﬁnition 6.8. Let S be a nonempty set, let X, Y be Banach spaces over
K, let U be a nonempty open subset of X, and let ψ: U × S →Y . Let
ψ(0)
u
≡ψ and L(0X, Y ) ≡Y . For n = 1, 2 . . . , v ∈U and s ∈S, we will
say that ψ is (Fr´echet) u-diﬀerentiable of order n at (v, s) if the function
u 7→f(u) := ψ(u, s), u ∈U, is (Fr´echet) diﬀerentiable of order n at v, and
then we let ψ(n)
u (v, s) := dnf(v) ∈L(nX, Y ) be the nth diﬀerential at (v, s).
Thus, ψ is Fr´echet u-diﬀerentiable at (v, s) if it is Fr´echet u-diﬀerentiable
of order 1 there. Also, for ψ to be Fr´echet u-diﬀerentiable of order n on a
subset W ⊂U × S will mean that for each (v, s) ∈W, (u, s) ∈W for u
in a neighborhood of v and ψ is Fr´echet u-diﬀerentiable of order n at (v, s).
Let g be a function on S with range in U. Then we will say ψ is Fr´echet
u-diﬀerentiable of order n on the graph of g or, brieﬂy, at g if ψ is Fr´echet
u-diﬀerentiable of order n at (g(s), s) for all s ∈S.
For X = Y = K we identify ψ(n)
u (v, s) with its value at 1⊗n and say that ψ
is u-diﬀerentiable of order n at (v, s). Therefore ψ is u-diﬀerentiable of order
n + 1 at (v, s) if ψ(n)
u (u, s) is deﬁned for u in a neighborhood of v and the
partial derivative ψ(n+1)
u
(v, s) := ∂ψ(n)
u (u, s)/∂u

u=v exists.
Next we show that Fr´echet diﬀerentiability of order n of the Nemytskii
operator Nψ at a function G implies Fr´echet u-diﬀerentiability of order n of
ψ at G, and their diﬀerentials are closely related.
Proposition 6.9. Let S be a nonempty set, let X, Y be Banach spaces, and
let G and H be Banach spaces of X-valued and Y -valued functions on S,
respectively, such that G contains the constant functions x1(·), x ∈X, and
x 7→x1(·) is a bounded operator from X into G. Assume that for each s ∈S,
the evaluation h 7→h(s) (which is clearly linear) is a bounded operator from
H into Y . Let U be a nonempty open subset of X, and let ψ: U × S →Y .
Let G ∈G be such that there is a neighborhood V of G in G with ran (g) ⊂U
for each g ∈V . For k ≥1, if the Nemytskii operator Nψ acts from V into H
and is Fr´echet diﬀerentiable of order k at G, then ψ is Fr´echet u-diﬀerentiable
of order k at G and the kth diﬀerential dkNψ(G) ∈L(kG, H) is the k-linear
operator
dkNψ(G)(g1, . . . , gk)(s) = ψ(k)
u (G(s), s)(g1(s), . . . , gk(s))
(6.5)
for each s ∈S and any g1, . . . , gk ∈G. If in addition X = Y = K then ψ is
u-diﬀerentiable of order k at G and the kth diﬀerential dkNψ(G) ∈L(kG, H)
is the k-linear multiplication operator M k[Nφ(G)] for φ = ψ(k)
u , that is,
dkNψ(G)(g1, . . . , gk)(s) = ψ(k)
u (G(s), s)g1(s) · · · gk(s)
(6.6)
for each s ∈S and any g1, . . . , gk ∈G.

278
6 Nemytskii Operators on Some Function Spaces
Proof. Let k = 1. For any x ∈X, we have x1(·) ∈G and ∥x1(·)∥G →0 as
∥x∥→0. Thus if ∥x∥is small enough then G + x1(·) ∈V and the remainder
in the diﬀerentiation of Nψ has values
RemNψ(G, x1(·))(s) = ψ(G(s) + x, s) −ψ(G(s), s) −(DNψ(G)x1(·))(s)
for each s ∈S. Since x 7→x1(·) is a bounded operator from X into G and
∥x1(·)∥G > 0 if x ̸= 0, we have ∥RemNψ(G, x1(·))∥H = o(∥x∥) as ∥x∥→0.
Since the evaluation operators are also bounded, we then have for each s ∈S,
∥ψ(G(s) + x, s) −ψ(G(s), s) −(DNψ(G)x1(·))(s)∥= o(∥x∥)
as ∥x∥→0. Thus for each s ∈S, ψ is Fr´echet u-diﬀerentiable at (G(s), s) and
ψ(1)
u (G(s), s) ∈L(X, Y ) is the composition x 7→x1(·) 7→DNψ(G)x1(·) 7→
(DNψ(G)x1(·))(s) ∈Y , x ∈X. If X = Y = K, then for each s ∈S, ψ
is u-diﬀerentiable at (G(s), s) and ψ(1)
u (G(s), s) = (DNψ(G)1(·))(s) ∈K. To
show (6.5) and (6.6) for k = 1, let g ∈G and s ∈S. For each t ∈K such
that G(s) + tg(s) ∈U, let φ(t) := ψ(G(s) + tg(s), s). Then φ is deﬁned in a
neighborhood of 0 and as t →0,
∥φ(t) −φ(0) −(DNψ(G)tg)(s)∥= ∥RemNψ(G, tg)(s)∥= o(∥tg∥G) = o(|t|).
On the other hand, φ is the composition of the functions t 7→G(s)+tg(s) and
u 7→ψ(u, s). Thus by the chain rule (Theorem 5.1), φ′(0) = ψ(1)
u (G(s), s)g(s)
and
∥φ(t) −φ(0) −tψ(1)
u (G(s), s)g(s)∥= o(|t|)
as |t| →0. Due to uniqueness of the derivative φ′(0), we have (DNψ(G)g)(s) =
ψ(1)
u (G(s), s)g(s) for each g ∈G and s ∈S, proving (6.5) and (6.6) for k = 1.
We will show by induction on k that the conclusions hold for all functions
Γ, in place of G, satisfying the hypotheses on G. Suppose that the conclusion
holds for k with k ≥1 and Nψ is Fr´echet diﬀerentiable of order k +1 at G. By
deﬁnition of the (k + 1)st diﬀerential, dkNψ(Γ) is deﬁned for all Γ in some
neighborhood of G. By the induction assumption, ψ(k)
u (Γ(s), s) is deﬁned for
all such Γ and all s ∈S. Since ∥(G + x1(·)) −G∥G = ∥x1(·)∥G →0 as x →0
in X, it then follows that for each s ∈S, f(u) := ψ(k)
u (u, s) ∈L(kX, Y ) is
deﬁned for all u in a neighborhood W of G(s). For any s ∈S, any x ∈X such
that G(s) + x ∈W, and any x1, . . . , xk in the closed unit ball ¯B(0, 1) ⊂X,
by (6.5) and Proposition 5.25(b) applied to F = Nψ, we have

f(G(s) + x) −f(G(s))

(x1, . . . , xk) −DdkNψ(G)(x1)(x11, . . . , xk1)(s)

=
RemdkNψ(G, x1)(x11, . . . , xk1)(s)

≤sup
n
RemdkNψ(G, x1)(g1, . . . , gk)(s): ∥g1∥≤∥1∥, . . ., ∥gk∥≤∥1∥
o
= o(∥x1∥) = o(∥x∥)
as ∥x∥→0,

6.3 Higher Order Diﬀerentiability and Analyticity
279
where 1 ≡1(·). For x1, . . . , xk+1 ∈X and s ∈S, let
ψ(k+1)
u
(G(s), s)(x1, . . . , xk+1) := dk+1Nψ(G)(x11(·), . . . , xk+11(·))(s),
and so ψ(k+1)
u
(G(s), s) ∈L(k+1X, Y ). By Proposition 5.25(b) once again,
DdkNψ(G)g = dk+1Nψ(G)(g, . . . ) for all g ∈G, and so Df(G(s))x =
ψ(k+1)
u
(G(s), s)(x, . . . ) for all x ∈X and s ∈S. By Proposition 5.25(a) now
applied to F = ψ(·, s), it then follows that ψ is Fr´echet u-diﬀerentiable of
order k + 1 at G and (6.5) holds with k + 1 instead of k, setting xj := gj(s),
j = 1, . . . , k + 1. In the case X = Y
= K, for each s ∈S, it fol-
lows that ψ is u-diﬀerentiable of order k + 1 at G with ψ(k+1)
u
(G(s), s) =
dk+1Nψ(G)(1(·), . . . , 1(·))(s). Thus the conclusion of the proposition holds for
any k ≥1 by induction.
2
The following shows that a power series expansion of a Nemytskii operator
Nψ around G (as deﬁned in Deﬁnition 5.8) has a simple form and implies a
Taylor expansion of ψ(u, s) around u = G(s) for each s (as deﬁned before
(5.32)). As before, we write x0 := 1(·) if x ∈KS or x0 := 1I if x is in a unital
Banach algebra.
Theorem 6.10. Let G and H be Banach spaces of functions on a set S such
that G contains the constant functions on S. Let ψ: K×S →K, and let V be
an open subset of G. Suppose that for some G ∈V , the Nemytskii operator Nψ
acts from V into H and has a power series expansion around G with radius
of (not necessarily uniform) convergence r > 0. Then there is a sequence
{hk}k≥0 ⊂H such that for each g ∈G with ∥g∥G < r, the series P
k≥0 hkgk
converges in G, and for all s ∈S,
Nψ(G + g)(s) = Nψ(G)(s) +
∞
X
k=1
hk(s)g(s)k.
(6.7)
We have
lim sup
k→∞
∥hk∥1/k
H
< ∞.
(6.8)
Moreover, ψ(u, s) has a Taylor expansion in u around u = G(s) for each s ∈S
and hk(s) = ψ(k)
u (G(s), s)/k! for all k ≥1 and all s ∈S.
Proof. We can assume that B(G, r) ⊂V . By assumption, for each k ≥1,
there is a k-homogeneous polynomial P k
G from G into H such that
Nψ(G + g) = Nψ(G) +
∞
X
k=1
P k
G(g)
and the series converges in H for each g ∈B(0, r). Let h0 := Nψ(G). Recalling
that the constant function 1 = 1(·) is in G, let hk := P k
G(1) ∈H for each k ≥1.

280
6 Nemytskii Operators on Some Function Spaces
For any g ∈G and s ∈S such that c := g(s) ̸= 0, there is a δ0 > 0 such
that ∥δg∥G < r and ∥δc1∥G < r for each 0 ≤δ ≤δ0. Since each P k
G is a
k-homogeneous polynomial, we have
NψG(s) +
∞
X
k=1
P k
G(g)(s)δk
= Nψ(G + δg)(s) = ψ(G(s) + δc, s) = Nψ(G + δc1)(s)
= h0(s) +
∞
X
k=1
hk(s)(δc)k =
∞
X
k=0
hk(s)δkg(s)k.
All these power series converge in K absolutely, and due to the uniqueness
of such series (Lemma 2.95), P k
G(g)(s) = hk(s)g(s)k for all g ∈G and all
s ∈S, also when g(s) = 0, proving the ﬁrst conclusion. To prove (6.8), for
some u ̸= 0 in K, taking g as the constant function u, the series P∞
k=1 ukhk
converges in H. Then supk |u|k∥hk∥< ∞. Taking kth roots, (6.8) follows. To
prove the last conclusion, for each s ∈S and some δ > 0, if |v| < δ then
ψ(G(s) + v, s) = Nψ(G + v1)(s) =
∞
X
k=0
hk(s)vk,
and so the function u 7→ψ(u, s) has a Taylor expansion around u = G(s)
for each s ∈S. A (scalar-valued) power series is an analytic (holomorphic)
function inside its circle of convergence, and so hk(s) = ψ(k)
u (G(s), s)/k! for
all k ≥1 and all s ∈S by Proposition 2.100, proving the theorem.
2
The power series expansion (6.7) has the form of (5.14), which gives the
following:
Corollary 6.11. If in addition to the hypotheses of Theorem 6.10, V = G =
H = B, a unital Banach algebra of functions, then (6.7) is the B-Taylor ex-
pansion of Nψ around G and Nψ is B-analytic on {h ∈B: ∥h −G∥< r}.
Proof. Under the present hypotheses, the power series (6.7) satisﬁes Deﬁnition
5.17 of a B-Taylor expansion. Thus Nψ is B-analytic on {h ∈B: ∥h−G∥< r}
by Theorem 5.30(b).
2
Using Theorem 6.10 once again we show next that analyticity of a Nemyt-
skii operator Nψ implies analyticity of the function u 7→ψ(u, ·).
Corollary 6.12. Let G and H be Banach spaces of functions on a set S
such that G contains the constant functions on S and for some K < ∞,
∥·∥sup ≤K∥·∥G on G. Let ψ: K×S →K, and let V := {g ∈G: ∥g∥sup < M}
for some M > 0. If the Nemytskii operator Nψ acts from V into H and is

6.3 Higher Order Diﬀerentiability and Analyticity
281
analytic on V , then the function u 7→ψ(u, ·) ∈H is analytic on the open ball
B(0, M) ⊂K. Moreover, for each u ∈B(0, M), there is an r > 0 such that
ψ(u + x, ·) =
∞
X
k=0
ψ(k)
u (u, ·)xk
k!
and the series converges in H for all x ∈B(0, r).
Proof. The set V is open in G since the sup norm is continuous on G. Since
V contains the constant functions u1(·) with |u| < M and Nψ maps V into H,
ψ(u, ·) ∈H for each u ∈B(0, M). The desired analyticity follows from The-
orem 6.10 applied also to each G = u1(·). The second part of the conclusion
follows from (6.7) applied to g = x1(·).
2
For the next result recall the deﬁnitions of spectral radius r(·) given by
(4.5) and (Banach) algebra of functions, Deﬁnitions 4.3 and 4.11.
Theorem 6.13. Let (B, ∥·∥) be a unital Banach algebra of K-valued functions
on a set S. For each s ∈S and f ∈B, let es(f) := f(s). Then, with K = C
except that (b) also holds for K = R,
(a) es is a character on B for each s ∈S;
(b) for all f ∈B, ∥f∥sup ≤r(f) ≤∥f∥;
(c) ∥f∥sup = r(f) if the closure of ran (f) equals σ(f);
(d) if S is a topological space and the functions in B are continuous, then
s 7→es is continuous from S into M(B) with Gelfand topology.
Proof. By Remark 4.12, the identity in B is the constant function 1(·). Then
(a) follows directly. By Theorem 4.24 and (4.5), for each f ∈B and s ∈S,
|f(s)| = |es(f)| ≤r(f) ≤∥f∥,
so (b) follows for K = C.
If K = R, let (BC, ||| · |||) be the Banach algebra complexiﬁcation of B given
by Theorem 4.39, which is also unital. We have the identiﬁcation f ↔(f, 0) of
B with a real subalgebra of BC, where ∥f∥= |||(f, 0)||| by Theorem 4.39(c). For
all n = 1, 2, . . . , we have ∥f n∥= |||(f n, 0)||| = |||(f, 0)n|||. Thus r(f) = r((f, 0))
and by the case K = C,
∥f∥sup = ∥(f, 0)∥sup ≤r((f, 0)) ≤|||(f, 0)||| = ∥f∥,
proving (b) for K = C.
For (c) suppose ran (f) = σ(f). Note that sup{|z|: z ∈ran (f)} = ∥f∥sup,
and so ∥f∥sup = r(f) holds by Theorem 4.20. For (d), if s(i) →s in S, then
f(s(i)) →f(s) for all f ∈B, so es(i) →es as stated.
2

282
6 Nemytskii Operators on Some Function Spaces
It follows that if ∥fn −f∥→0 in a unital Banach algebra B of functions,
then fn →f not only pointwise, as assumed in Proposition 6.9, but uniformly.
Remark 6.14. Any Banach space (X, ∥· ∥) becomes a Banach algebra with
the trivial multiplication deﬁned by xy = 0 for all x, y ∈X. Of course such an
algebra is not unital. It has r(x) = 0 for each x ∈X. X may be a space of real-
or complex-valued functions which need not be bounded. Thus in Theorem
6.13(b), the hypothesis that B is unital cannot simply be removed.
Proposition 6.15. Let B be a unital Banach algebra of functions on a set S.
For a function h: S →K and k = 1, 2, . . . , (g1, . . . , gk) 7→hg1 · · · gk deﬁnes
a bounded k-linear operator from B × · · · × B into B if and only if h ∈B.
Proof. “If” is obvious, and “only if” follows from setting g1 = g2 = · · · =
gk = 1I = 1(·).
2
If the operator deﬁned in the preceding proposition is bounded then it is
the operator M k[h] deﬁned by (5.12).
Deﬁnition 6.16. If B is a unital Banach algebra of functions on a set K,
where K is a compact Hausdorﬀspace and B ⊂C(K; C), then B will be
called a Banach function algebra on K. A Banach function algebra B on K is
called natural if the evaluation map s 7→es takes K onto M(B).
In the preceding deﬁnition, recall that by deﬁnition of Banach algebras
of functions (Deﬁnition 4.11), B strongly separates points of K. Thus the
evaluation map s 7→es is 1-to-1 as well as onto. Also the map s 7→es is
continuous since B ⊂C(K; C). Thus it is a homeomorphism (e.g. [53, Theorem
2.2.11]).
Recall that any unital Banach algebra of functions on S contains the con-
stant functions and its identity element 1I = 1(·) (Remark 4.12). Before giving
examples of natural Banach algebras of functions (Corollary 6.23 below) we
prove next some important properties of such algebras.
Theorem 6.17. (a) If B is any Banach algebra of C-valued functions on a
set S and f ∈B, then ran (f) ⊂ran ( bf).
(b) For any natural Banach function algebra B on K, a compact Hausdorﬀ
space, and any f ∈B, ran (f) = ran ( bf) = σ(f). Also r(f) = ∥f∥K,sup.
Proof. Part (a) is clear since for each s ∈S, the evaluation es is a character
of B. The ﬁrst statement in (b) then follows from the deﬁnitions and Theorem
4.29. For the second one, by Corollary 4.30, r(f) = ∥bf∥sup = ∥f∥K,sup, proving
the theorem.
2

6.3 Higher Order Diﬀerentiability and Analyticity
283
Recall Deﬁnition 4.28 of the Gelfand transform. A commutative unital
complex Banach algebra (A, ∥· ∥) is called semisimple if the Gelfand trans-
form x 7→bx is 1-to-1 from A into C(M(A), C). Then x 7→bx is an algebra
isomorphism, in other words a 1-to-1 function preserving addition and multi-
plication.
A commutative unital complex Banach algebra need not be semisimple,
as the following shows:
Example 6.18. Consider the set A of 2 × 2 matrices of the form
T =

a b
0 a

for any a, b ∈C, with usual addition and multiplication of matrices. Then A
is a unital commutative algebra over C. It becomes a Banach algebra with the
usual matrix (operator) norm ∥T ∥:= sup{∥Tx∥: x ∈C2, ∥x∥≤1}. Clearly,
A has just one proper, hence maximal, ideal, composed of the matrices T with
a = 0. Thus by Corollary 4.27, there is only one character φ, with φ(T ) = a
for all such T , a. Clearly A is not semisimple.
Proposition 6.19. Let (A, ∥· ∥A) be a commutative unital complex Banach
algebra. Then the range bA of the Gelfand transform with the norm ∥bx∥bA :=
∥x∥A is a Banach function algebra on M(A). If A is semisimple, then bA is
natural.
Proof. The set M(A) of all characters on B with Gelfand topology is a
compact Hausdorﬀspace as was stated after Deﬁnition 4.28. The set bA =
{ bf : f ∈A} always separates points of M(A) since for any φ ̸= ψ in M(A),
φ(f) ̸= ψ(f) for some f ∈A, so bf(φ) ̸= bf(ψ). Also, A strongly separates
points of M(A) since for each φ ∈M(A), b1I(φ) = φ(1I) = 1 ̸= 0. Since each
bf is a continuous complex-valued function on M(A), bA is a Banach function
algebra on M(A) with the norm ∥· ∥bA and identity b1I = 1(·).
For each φ ∈M(bA) and f ∈A, let eφ(f) := φ( bf). If A is semisimple, then
eφ ∈M(A) since the Gelfand transform is an algebra homomorphism and a
1-to-1 mapping onto its range, and so bA is natural, proving the proposition.
2
Next the class Wp(J; X) of all X-valued functions of bounded p-variation
on an interval J will be imbedded into the set C(K; X) of continuous functions
on a compact Hausdorﬀspace K. Partitions and the class Wp for any linearly
ordered set were deﬁned in Section 1.4. For an interval J = [a, b] with −∞<
a < b < ∞, let
J± := {a, a+, b−, b} ∪
[
a<x<b
{x−, x, x+}.
(6.9)

284
6 Nemytskii Operators on Some Function Spaces
On J± we put the linear ordering:
a < a+ < x−< x < x+ < y−< y < y+ < b−< b
whenever a < x < y < b. J± has an interval topology with a subbase given by
all sets {ξ : ξ < η} and {ξ : ξ > η} for all η ∈J±. Then J± with the interval
topology is a compact, non-metrizable, Hausdorﬀspace. Each regulated func-
tion f on J, and thus each function f ∈Wp(J), has a unique extension to
a function ˜f on J± which is continuous on J± for the interval topology. Let
I : R(J) →C(J±) be the mapping deﬁned by I(f) := ˜f.
Proposition 6.20. Let X be a Banach space over K and let J be a nonde-
generate closed interval.
(a) For each f ∈R(J; X), the closure ran (f) = ran ˜f and is compact.
(b) The mapping I is an isometry between R(J; X) and C(J±; X), both with
supremum norm.
(c) for 1 ≤p < ∞, the mapping I when restricted to Wp(J; X) is an isometry
between Wp(J; X) and Wp(J±; X).
(d) The spectra σ(f) and σ( ˜f) are equal for each f ∈R(J; C) and for each
f ∈Wp(J; C) with 1 ≤p < ∞.
Proof. In (a), clearly ran (f) = ran ˜f, and so ∥f∥J,sup = ∥˜f∥J±,sup for any
regulated function f : J →X. Since I takes R(J; X) onto C(J±; X), (b)
holds. Since J± is compact, so is ran ˜f = ran (f) and (a) is proved.
For (c), for any such f, we have vp(f; J) ≤vp( ˜f; J±). For the converse
inequality, let κ = {xi}n
i=0 be a partition of J±. If for some x ∈J and
i, xi = x−or xi = x+, ˜f(xi) can be approximated arbitrarily closely by
f(yi) with yi ∈J. Taking yi := xi for all other i, one can make a partition
λ = {yi}n
i=0 of J so that sp(f; λ) is arbitrarily close to sp( ˜f; κ), proving the
converse inequality, and so vp(f; J) = vp( ˜f; J±). Thus when restricted to
Wp(J; X), I is an isometry from Wp(J; X) onto Wp(J±; X), proving (c).
For (d), let f ∈Wp(J; C). If z ∈C \ σ(f) then let g := (z1(·) −f)−1 ∈
Wp(J; C) by Deﬁnition 4.17 of σ(·). Clearly ˜g = (z1(·) −˜f)−1 ∈Wp(J±; C),
and so z ∈C \ σ( ˜f). Conversely, if z ∈C \ σ( ˜f) then the restriction of
(z1(·) −˜f)−1 ∈Wp(J±; C) to J is the inverse of z1(·) −f in Wp(J; C), and
so z ∈C \ σ(f), proving (d) and the proposition.
2
For a complex-valued function f = g + ih where g and h are real-valued,
the complex conjugate is ¯f = g −ih. A set (vector space, algebra, etc.) F of
complex-valued functions is called self-adjoint if ¯f ∈F whenever f ∈F. Here
are characterizations of natural algebras.
Theorem 6.21. Let B be a Banach function algebra on K. Then
(a) B is natural if and only if for any n = 1, 2, . . ., and f1, . . . , fn ∈B such
that Tn
j=1 f −1
j
(0) = ∅, there exist g1, . . . , gn ∈B with Pn
j=1 gjfj = 1(·);

6.3 Higher Order Diﬀerentiability and Analyticity
285
(b) if B is self-adjoint, then it is natural if and only if for every f ∈B with
f −1(0) = ∅, 1/f ∈B.
Proof. For (a), to prove “only if,” let B be natural, fj ∈B, and Tn
j=1 f −1
j
(0) =
∅. Let L := {Pn
j=1 gjfj : gj ∈B}. Then L is an ideal. If L = B then 1(·) ∈L
as desired. Otherwise, L is a proper ideal and is included in some maximal
ideal M by Theorem 4.4. By Corollary 4.27, there is a character φ of B with
M = φ−1(0). Since B is natural, there is some s ∈K with φ(f) = f(s) for all
f ∈M. Thus s ∈Tn
j=1 f −1
j
(0), a contradiction.
To prove “if” in (a), suppose φ ∈M(B) is a character which is not of the
form es(f) = f(s) for any s ∈K. Thus by Corollary 4.27 the maximal ideal
M = φ−1(0) is diﬀerent from Ms := {f ∈B: f(s) = 0} for each s ∈K. So
M ̸⊂Ms for each s since M is maximal. For each s ∈K, take hs ∈B such
that φ(hs) = 0 and hs(s) ̸= 0. The open sets h−1
s (C \ {0}) cover K, so there
is a ﬁnite subcover. Thus there exist ﬁnitely many fi = hsi, i = 1, . . . , n,
such that Tn
i=1 f −1
i
(0) = ∅and φ(fi) = 0 for each i. Take g1, . . . , gn ∈B with
Pn
i=1 gifi = 1(·). Since φ is a character, we get φ(1(·)) = 0, a contradiction,
so (a) is proved.
For (b), to prove “if,” let f1, . . . , fn ∈B with Tn
j=1 f −1
j
(0) = ∅. Then
f := Pn
j=1 |fj|2 ∈B since B is self-adjoint. Thus f −1(0) = ∅so 1/f ∈B. Let
gj := ¯fj/f ∈B for each j. Then Pn
j=1 gjfj = 1(·), so by part (a), B is natural.
Conversely, if B is natural and f −1(0) = ∅, let n = 1 and f1 = f. Then (a)
gives g1 = 1/f ∈B (self-adjointness is not needed in this direction), ﬁnishing
the proof of Theorem 6.21.
2
Recall the class Hα(B; Y ) of all α-H¨older functions from B to Y deﬁned
in Section 1.4. The following is easy to prove:
Lemma 6.22. Let X, Y be normed spaces over K, let B be a nonempty subset
of X and let F ∈Hβ(B; Y ) for some 0 < β ≤1. Let f be a function on a
nonempty interval J with range in B. Then
(a) if 0 < p < ∞and f ∈Wp(J; X), then F◦f ∈Wp/β(J; Y ) and
∥F◦f∥(p/β) ≤∥F∥B,(Hβ)∥f∥β
(p);
(b) if 0 < α ≤1 and f ∈Hα(J; X), then F◦f ∈Hαβ(J; Y ) and
∥F◦f∥(Hαβ) ≤∥F∥B,(Hβ)∥f∥β
(Hα).
Proof. We can assume that J is nondegenerate. First let 0 < p < ∞and
f ∈Wp(J; X). For any s, t ∈J we have
∥F(f(t)) −F(f(s))∥p/β ≤

∥F∥B,(Hβ)∥f(t) −f(s)∥βp/β
= ∥F∥p/β
B,(Hβ)∥f(t) −f(s)∥p.
(6.10)

286
6 Nemytskii Operators on Some Function Spaces
Summing over any point partition of the interval J, then taking the supremum
over partitions gives vp/β(F◦f) ≤∥F∥p/β
B,(Hβ)vp(f), proving (a).
Now let 0 < α ≤1 and f ∈Hα(J; X). Then again for any s, t ∈J, we
have
∥F(f(t)) −F(f(s))∥≤∥F∥B,(Hβ)∥f(t) −f(s)∥β
≤∥F∥B,(Hβ)∥f∥β
(Hα)|t −s|αβ,
proving (b). The lemma is proved.
2
Corollary 6.23. Let J := [a, b] with −∞< a < b < +∞. In each of the
following cases, A is a natural Banach function algebra:
(a) A = C(K; C) with the norm ∥· ∥sup, where K is a compact Hausdorﬀ
space;
(b) for 0 < α ≤1, the H¨older space A = Hα,∞(J; C) with the norm ∥· ∥Hα;
(c) the space A = Cn(J) of Cn C-valued functions f on J, namely, Cn func-
tions on (a, b) such that for j = 0, 1, . . . , n, with f (0) := f, f (j) extends to
a continuous function on J, with the norm
∥f∥Cn :=
n
X
k=0
∥f (k)∥sup
k!
;
(d) for 1 ≤p < ∞, A = Wp(J±; C) with the norm ∥· ∥[p].
Proof. Each A given is a unital, self-adjoint algebra of continuous functions
on a compact Hausdorﬀspace. The given norms are Banach algebra norms,
clearly for (a), for (b) by Proposition 4.14, and for (d) by Proposition 4.13.
For (c), ∥· ∥Cn is a Banach algebra norm because
∥fg∥Cn =
n
X
k=0
∥(fg)(k)∥sup
k!
≤
n
X
k=0
1
k!
k
X
j=0
k
j

∥f (j)∥sup∥g(k−j)∥sup
≤
h
n
X
k=0
∥f (k)∥sup
k!
ih
n
X
i=0
∥g(i)∥sup
i!
i
= ∥f∥Cn∥g∥Cn.
Thus each A with its given norm is a Banach function algebra. To show that
each A is natural, by Theorem 6.21(b) it suﬃces to check that 1/f ∈A for
each f ∈A with f −1(0) = ∅. For (a) this is immediate. The function z 7→1/z
is uniformly Lipschitz on the complement of any neighborhood of 0 in C. This
implies (b) and (d) by Lemma 6.22 with β = 1. Also, z 7→1/z is C∞with
each derivative uniformly bounded on the complement of each neighborhood
of 0. For derivatives through the nth, this implies (c), completing the proof.
2

6.3 Higher Order Diﬀerentiability and Analyticity
287
Remark 6.24. The Banach algebras of functions R(J; C) of regulated func-
tions with supremum norm, or Wp(J; C) with its usual norm, do not consist
of continuous functions on J. So they are not Banach function algebras, hence
not natural. But they are isometric as Banach algebras to the natural alge-
bras C(J±; C) and Wp(J±; C), respectively. In other words, the maximal ideal
spaces of R(J; C) and of Wp(J; C) are both given by J±.
Example 6.25. Here is an example of a non-natural Banach function alge-
bra. Let D := {z ∈C: |z| ≤1}. Let A(D) be the Banach algebra of continu-
ous C-valued functions on D which are holomorphic on its interior, with norm
∥·∥sup and pointwise operations. Then A(D) is a Banach function algebra but
is not self-adjoint. For each f ∈A(D) let T (f) be its restriction to [−1, 1].
Let A := {T (f): f ∈A(D)}. Now f 7→T (f) is 1-to-1, since T (f) determines
all the derivatives f (n)(0) and thus the Taylor series of f around 0, which
converges to it for |z| < 1 and thus determines f uniquely by continuity.
So ∥T (f)∥:= ∥f∥sup is a well-deﬁned norm on A. T is an algebra isomor-
phism and an isometry of A(D) onto A. Clearly A contains the constants and
strongly separates points of [−1, 1]. For each z = x + iy ∈C with x, y ∈R,
let ¯z := x −iy. To see that A is self-adjoint, note that for each f ∈A(D) we
have f ∗∈A(D) where f ∗(z) := ¯f(¯z) for all z ∈D. (If f(z) = P∞
n=0 anzn for
|z| < 1, then f ∗(z) = P∞
n=0 ¯anzn.) On [−1, 1], f ∗= ¯f, so A is self-adjoint.
Evidently A is not natural, since evaluations at points of D not in [−1, 1] give
characters of A(D) and thus of A not given by points of [−1, 1].
For a vector space of (K-valued) functions B and a nonempty open set
U ⊂K, let B[U] be the set of all f ∈B such that the closure of the range
ran (f) is included in U. Note that if B is a Banach function algebra then each
such ran (f) is already compact and closed. But for a general Banach algebra
of functions such as Wp(J), ran (f) need not be closed.
Proposition 6.26. Let B be a unital Banach algebra of C-valued functions
on a set S such that for each f ∈B, the closure of ran (f) equals σ(f). If U
is a connected open set in C, then B[U] is a connected open set in B.
Remark 6.27. If B is a natural Banach function algebra then the hypothesis
holds by Theorem 6.17(b). If B = Wp(J; C) with 1 ≤p < ∞and J = [a, b],
then ran (f) = ran (I(f)) and σ(f) = σ(I(f)) for each f ∈Wp(J; C), where
I is the isometry between Wp(J; C) and Wp(J±; C) of Proposition 6.20(c).
Therefore the hypothesis holds again because Wp(J±; C) is a natural Banach
function algebra by Corollary 6.23(d).
Let (A, τ) be a topological vector space of real-valued functions, i.e. ad-
dition and multiplication by scalars are both jointly continuous. Let U be a
connected open set in R, i.e. an open interval. Then A[U] is evidently convex
and thus connected for τ. If A is a unital Banach algebra of R-valued functions
then A[U] is open by Theorem 6.13(b) and the following proof.

288
6 Nemytskii Operators on Some Function Spaces
Proof. For any set A ⊂C and z ∈C, let d(z, A) := inf{|z −w|: w ∈A}.
For δ > 0, let Aδ := {z : d(z, A) < δ}. Let f ∈B[U] and let A := ran (f). By
Theorem 6.13(b), f is bounded, and so A is a compact set in C. Since U is
open, there is an ǫ > 0 such that Aǫ ⊂U. Let g ∈B(f, ǫ/3) ⊂B. By Theorem
6.13(b) again, ∥f −g∥sup ≤∥f −g∥< ǫ/3 and so ran (g) ⊂Aǫ ⊂U, proving
that B[U] is an open set in B.
Connectedness of B[U] is clear if U = C. Let U = D = B(0, 1) ⊂C. Then
B[D] is connected because it is convex and the segment joining two functions
in B[D] is a continuous mapping from [0, 1] into B[D]. Let U be a connected
open set in C and let T be a Riemann mapping from U onto D, namely a
1-to-1 holomorphic function from U onto D, where the inverse mapping T −1
is also holomorphic from D onto U (e.g. Ahlfors [1, p. 222]). For each f ∈B[D],
the spectrum σ(f) = ran (f) is included in D, and so NT −1f = T −1◦f ∈B
by Proposition 4.34. Also, ran (T −1◦f) ⊂U since T −1(ran (f)) is a compact
subset of U. To show continuity of the autonomous Nemytskii operator NT −1
from B[D] into B[U] we need the following:
Lemma 6.28. If fn, n ≥0, are functions from a set S into a metric space
(X, d), fn →f0 uniformly on S as n →∞, and each An := ran (fn) is a
compact set in X, then A := ∪n≥0An is compact in X.
Proof. It suﬃces to show that any sequence {xj}∞
j=1 ⊂A has a convergent
subsequence. If inﬁnitely many xj belong to one An this is clear. Thus taking a
subsequence suppose that for some nj →∞and sj ∈S, d(xj, fnj(sj)) < 1/j,
where sups∈S d(fn(s), f0(s)) < 1/j for each n ≥nj. Let yj := f0(sj) ∈A0.
Taking a further subsequence, we can assume that yj →y for some y ∈A0.
Then xj →y also, proving the lemma.
2
To show continuity of NT −1 let fn, n ≥0, be functions in B[D] such that
fn →f0 in B as n →∞. By Theorem 6.13(b) again, fn →f0 uniformly on
S, and so the union A of all ran (fn), n ≥0, is a compact set in D by the
preceding lemma. By Lemma 4.32 there is a C∞simple closed curve ζ(θ),
0 ≤θ ≤2π, with range ran (ζ) ⊂D \ A and winding number w(ζ(·), z) = 1
for all z ∈A. Thus by a classical Cauchy integral formula, e.g. Theorem 2.107
for X = C, for each n ≥0 and s ∈S, we have
T −1(fn(s)) =
1
2πi
I
ζ(·)
T −1(ζ) dζ
ζ −fn(s) .
Since σ(fn) = ran (fn) ⊂A, by Theorem 4.18(b), the function z 7→(z1(·) −
fn)−1 is holomorphic from C \ A into B. Thus it is continuous by Proposition
2.96, and so bounded on ran (ζ). Therefore there is a ﬁnite number M such
that ∥(z1(·) −fn)−1∥≤M for each z ∈ran (ζ) and n ≥0. It then follows
that there is a ﬁnite constant C such that

6.3 Higher Order Diﬀerentiability and Analyticity
289
∥T −1◦fn −T −1◦f0∥= 1
2π

I
ζ(·)
T −1(ζ)(fn −f0) dζ
(ζ1(·) −fn)(ζ1(·) −f0)
 ≤C∥fn −f0∥
for each n ≥1. Thus NT −1fn →NT −1f0 in B as n →∞, and so NT −1
is continuous from B[D] onto B[U], proving connectedness of B[U] and the
proposition.
2
Theorem 6.29. Let B be a unital Banach algebra of C-valued functions on a
set S such that for each f ∈B, we have ran (f) = σ(f), let U be a connected
and simply connected open set in C, and let F be a holomorphic function from
U into C. Then the autonomous Nemytskii operator NF acts from B[U] into
B and is B-analytic on B[U].
Proof. The set B[U] is open and connected by Proposition 6.26. If f ∈B[U]
then σ(f) = ran (f) is a compact subset of U. Thus NF f = F◦f ∈B for each
f ∈B[U] by Proposition 4.34.
To prove B-analyticity of NF on B[U] let f ∈B[U]. Since K := ran (f) is a
compact subset of U, by Lemma 4.32 there is a C∞simple closed curve ζ(θ),
0 ≤θ ≤2π, with range ran (ζ) ⊂U \ K and winding number w(ζ(·), z) = 1
for all z ∈K. Thus by a classical Cauchy integral formula, e.g. Theorem 2.107
for X = C, for each k = 1, 2, . . . and x ∈S, we have
F (k)(f(x)) = k!
2πi
I
ζ(·)
F(ζ) dζ
(ζ −f(x))k+1 .
Since σ(f) = K, by Theorem 4.18(b), the function z 7→(z1(·) −f)−1 is
holomorphic from C \ K into B. Thus it is continuous by Proposition 2.96,
and so bounded on ran (ζ). Therefore there is a ﬁnite number M such that
∥(z1(·) −f)−1∥≤M for each z ∈ran (ζ), and so ∥(z1(·) −f)−k−1∥≤M k+1
for each z ∈ran (ζ) and k = 1, 2, . . . . It follows that there is a ﬁnite constant
C such that for each k = 1, 2, . . ., ∥hk∥≤C∥F∥ran (ζ),supM k+1, where
hk := (F (k)◦f)/k! =
1
2πi
I
ζ(·)
F(ζ) dζ
(ζ1(·) −f)k+1 ∈B.
Then lim supk→∞∥hk∥1/k ≤M, and by the root test, the B-power series
P
k≥1 hkgk converges in B for each g ∈B with ∥g∥< 1/M. Let h0 := NF f.
Since F has an ordinary Taylor expansion around f(x), for each x ∈S,
F(f(x) + z) =
X
k≥0
hk(x)zk
for each z with |z| < r(x) and some r(x) > 0. Since ∥hk∥S,sup ≤∥hk∥for each
k, there is an r > 0 such that r(x) ≥1/M for all x. Thus the B-power series
P
k≥0 hkgk converges in B to NF (f + g) for each g ∈B such that f + g ∈B[U]

290
6 Nemytskii Operators on Some Function Spaces
and ∥g∥S,sup ≤∥g∥< min{r, 1/M}, and so it is the B-Taylor series of NF
around f, proving the theorem.
2
Let B be a self-adjoint unital Banach algebra of C-valued functions and let
BR be the set of all R-valued functions in B. Then BR is a real Banach algebra
of R-valued functions with the norm ∥·∥B. For example, if B = Wp(J; C) with
1 ≤p < ∞then BR = Wp(J; R) ≡Wp(J).
If W = (−M, M) for some 0 < M ≤∞, then we have B[W]
R
= {f ∈
BR : ∥f∥sup < M} since ran (f) ⊂W if and only if ∥f∥sup < M. By Theorem
6.13(b) and Remark 6.27, the set B[W]
R
is connected and open.
Corollary 6.30. Let B be a self-adjoint unital Banach algebra of C-valued
functions on a set S such that ran (f) = σ(f) for each f ∈B, and let W :=
(−M, M) for some 0 < M ≤∞. For F : R →R, the following statements are
equivalent:
(a) The autonomous Nemytskii operator NF : g 7→F◦g acts from B[W]
R
into
B, thus into BR, and is analytic on B[W]
R
.
(b) F is analytic on W.
Proof. Let F : R →R. Suppose (a) holds. By Theorem 6.13(b), ∥·∥sup ≤∥·∥B.
Since B contains the constant functions, by Corollary 6.12 with G = H = BR,
V = B[W]
R
and ψ ≡F, (b) holds.
Conversely, suppose that (b) holds. By analytic continuation in the form
of Theorem 5.36, there is a connected open set U ⊂C such that U ∩R = W
and a holomorphic extension of F from W into U, which will be denoted also
by F. Thus NF acts from B[W]
R
into B and is analytic on B[W]
R
by Theorem
6.29, proving the corollary.
2
Now we return to non-autonomous Nemytskii operators Nψ. Under some
conditions, we will establish their analyticity on open sets B[W]
R
. We begin by
giving conditions for a Taylor expansion of Nψ around a ﬁxed function in BR.
For the last conclusion, recall that the n-linear multiplication operator M n[h]
was deﬁned in Deﬁnition 6.6.
Proposition 6.31. Let B be a self-adjoint unital Banach algebra of C-valued
functions on a set S such that ran (f) = σ(f) for each f ∈B. Let ψ: R×S →
R be u-diﬀerentiable of order n everywhere on R × S for each n ≥1. Let V be
a connected open set in BR and let f ∈V . If the Nemytskii operator Nψ acts
from V into BR then the following statements are equivalent:
(a) there are c ≥0 and r > 0 such that for each n = 1, 2, . . ., sup{|ψ(n)
u (f(s)+
t, s)|: s ∈S} ≤cnn! for t ∈R with |t| ≤r, Nψ(n)
u (f) ∈BR and

6.3 Higher Order Diﬀerentiability and Analyticity
291
lim sup
k→∞
Nψ(k)
u (f)/k!
1/k
B
< ∞;
(b) there is an r > 0 such that Nψ(f + g) is given by the BR-Taylor series
P∞
k=0 Nψ(k)
u (f)gk/k!, which converges absolutely for each g ∈BR such that
∥g∥sup < r;
(c) Nψ on V has a Taylor expansion around f.
If (c) holds then there is an r > 0 such that for n = 1, 2, . . . and g ∈B(f, r)∩
BR, the nth diﬀerential dnNψ(g) ∈L(nBR, BR) is the n-linear multiplication
operator M n[h] induced by the function h := Nψ(n)
u (g) ∈BR.
Proof. (a) ⇒(b). Let h0 := Nψf and for k = 1, 2, . . ., let hk := Nψ(k)
u (f)/k!.
Then each hk is in BR, and T := lim supk→∞∥hk∥1/k
B
< ∞. For each g ∈BR
such that ∥g∥sup < 1/T , the BR-power series P∞
k=0 hkgk converges in BR
absolutely by Theorem 5.16 since the spectral radius r(g) equals ∥g∥sup by
Theorem 6.13(c). Let ρ ∈R be such that 0 < ρ < 1/c and ρ ≤r. By Theorem
5.43 for X = Y = R, F(u) := ψ(u, s), and U := Uρ := {f(s) + t: t ∈R, |t| <
ρ} ⊂R, for each ﬁxed s ∈S and t ∈R with |t| < ρ, we have that the Taylor
series
ψ(f(s) + t, s) = F(f(s) + t) =
∞
X
k=0
F (k)(f(s))tk
k! =
∞
X
k=0
hk(s)tk
converges absolutely on B(f(s), ρ) = U. Thus Nψ(f +g)(s) = (P∞
k=0 hkgk)(s)
for each s ∈S and each g ∈BR with ∥g∥sup < min{1/c, r}, proving (b).
Statement (c) follows from (b) by Theorem 5.30(a). Suppose that (c) holds.
Then by Theorem 5.28, there exists a constant ρ > 0 such that Nψ is a C∞
function on B(f, ρ). By Theorem 6.13(b), ∥· ∥sup ≤∥· ∥B. Since B contains
the constant functions, by Proposition 6.9, for each n = 1, 2, . . . and each
g ∈B(f, ρ) ⊂BR, the nth diﬀerential dnNψ(g) is the multiplication operator
M n[h] from Bn
R into BR induced by the function h = Nψ(n)
u (g) ∈BR, proving
the last conclusion of the theorem. Since ∥· ∥sup ≤∥· ∥B and ∥Nψ(n)
u (g)∥B ≤
∥dnNψ(g)∥for g ∈B(f, r) ∩BR and n = 1, 2, . . . , (a) follows from (c) by
Theorem 5.43. The proof of Proposition 6.31 is complete.
2
Theorem 6.32. Let B be a self-adjoint unital Banach algebra of C-valued
functions on a set S such that ran (f) = σ(f) for each f ∈B. Let W :=
(−M, M) for some 0 < M ≤∞and let ψ: W × S →R be u-diﬀerentiable of
order n everywhere on W × S for each n ≥1. If the Nemytskii operator Nψ
acts from B[W]
R
into BR then for each u ∈W, ψ(u, ·) ∈BR and the following
statements are equivalent:
(a) for each closed interval B ⊂W, there is a c ≥0 such that for k = 1, 2, . . .,
ψ(k)
u

B×S,sup ≤ckk!,
(6.11)

292
6 Nemytskii Operators on Some Function Spaces
and for each f ∈B[W]
R
, Nψ(n)
u (f) ∈BR for n = 1, 2, . . ., and
lim sup
k→∞
Nψ(k)
u (f)/k!
1/k
B
< ∞;
(b) Nψ is BR-analytic on B[W]
R
and for each f ∈B[W]
R
, P
k≥0 Nψ(k)
u (f)gk/k! is
the BR-Taylor expansion around f;
(c) Nψ is analytic on B[W]
R
.
Proof. First, B is unital, so ψ(u, ·) = Nψ(u1S(·)) ∈BR for u ∈W. Next to
show that (a) implies (b), let f ∈B[W]
R
, let M0 be such that ∥f∥sup < M0 < M,
let B := [−M0, M0], and let r := M0 −∥f∥sup. Thus for each t ∈R such that
|t| ≤r and for n = 1, 2, . . . , we have
sup
s∈K
ψ(n)
u (f(s) + t, s)
 ≤
ψ(n)
u

B×S,sup ≤cnn!.
By the implication (a) ⇒(b) of Proposition 6.31, there is a ρ > 0 such
that P
k≥0 Nψ(k)
u (f)gk/k! is a BR-power series which converges (absolutely) to
Nψ(f+g) for each g ∈BR such that ∥g∥sup < ρ, and so for each g ∈B(0, ρ)∩BR
by Theorem 6.13(b). Thus it is the BR-Taylor expansion of Nψ around f. Since
f ∈B[W]
R
is arbitrary, (b) is proved.
Statement (c) follows from (b) by Theorem 5.30(a). To prove that (c)
implies (b), let (c) hold and let B be a closed ﬁnite interval included in W. By
Corollary 6.12 for G = H = BR and so V = B[W]
R
, the function u 7→ψ(u, ·) ∈
BR, u ∈W, is analytic on W. By analytic continuation as in Theorem 5.36,
there are a connected open set U ⊂C such that U ∩R = W and a holomorphic
extension of the function from W to U, which will be denoted by z 7→ψ(z, ·) ∈
B. Let ǫ > 0 be such that D := {z = u + w ∈C: |w| ≤ǫ, u ∈B} ⊂U. By
Proposition 2.96, z 7→ψ(z, ·) ∈B is continuous on U, and so ∥ψ(z, ·)∥B is
bounded for z ∈D. Let u ∈B and let ζu(t) := u + (ǫ/2)e2πit for t ∈[0, 1]. By
Cauchy integral formulas for derivatives as in Theorem 2.98 for f(z) = ψ(z, ·),
z ∈B(u, ǫ), and for each n = 1, 2, . . . , we have
ψ(n)
u (u, ·) = n!
2πi
I
ζu(·)
ψ(ζ, ·) dζ
(ζ −u)n+1 =
n!
(ǫ/2)n
Z 1
0
ψ(ζu(t), ·) dt
e2πint
.
Thus for each u ∈B and each n = 1, 2, . . .,
ψ(n)
u (u, ·)

S,sup ≤
ψ(n)
u (u, ·)

B ≤
n!
(ǫ/2)n sup
z∈D
ψ(z, ·)

B ≤cnn!,
where c := 2C/ǫ and C := max{1, supz∈D ∥ψ(z, ·)∥B}, proving (6.11). The
rest of (a) follows by the implication (c) ⇒(a) of Proposition 6.31 applied to
each f ∈B[W]
R
. The proof of Theorem 6.32 is complete.
2

6.4 Autonomous Nemytskii Operators on Wp Spaces
293
6.4 Autonomous Nemytskii Operators on Wp Spaces
In this section, the autonomous Nemytskii operator NF is considered between
the spaces G = Wp(J; X) and H = Wq(J; Y ) with p ≤q. In particular, we
give conditions for NF to act and be Fr´echet diﬀerentiable.
Necessary and suﬃcient acting conditions from Wp into Wq
We will prove that for X = Y = R and for a closed interval J, the autonomous
Nemytskii operator NF acts from Wp(J) into Wq(J) with 0 < p ≤q < ∞if
and only if F is locally α-H¨older with α = p/q (Corollary 6.36). But ﬁrst here
is an example which shows that one cannot take F ∈W1 and get NF f ∈Wp
even for f very smooth.
Example 6.33. Let f(x) := e−1/x sin(x) for x > 0 and f(x) := 0 for x ≤
0. The function f is C∞, with all derivatives 0 at 0. For F := 1[0,1], the
composition F◦f has no right limit at 0, and so is not regulated. Thus it is
not of bounded p-variation for any p < ∞by Proposition 3.33.
Now we show that a local α-H¨older property (Deﬁnition 6.4) is a suﬃcient
condition for an autonomous Nemytskii operator to act from a suitable subset
of Wp into Wq with 0 < p ≤q < ∞and α = p/q, as well as to be bounded from
Wp into Wq. A nonlinear operator from a subset E of one normed space into
another will be called bounded if it takes bounded subsets of E into bounded
sets. Recall that for a nonempty open set U ⊂X, W[U]
p (J; X) is the set of all
f ∈Wp(J; X) such that the closure of the range ran (f) is included in U. Also
recall Deﬁnition 6.4 of the class Hloc
α (U; Y ) and of the sets Bm(U) = U1/m
with m = 1, 2, . . ..
Proposition 6.34. Let 0 < α ≤1, 0 < p < ∞and let J := [a, b] with a < b.
Let X, Y be Banach spaces, let U be a nonempty open subset of X, and let
F ∈Hloc
α (U; Y ). Then W[U]
p (J; X) is open and for each f ∈W[U]
p (J; X),
NF f ∈Wp/α(J; Y ). Also, if U = X then the autonomous Nemytskii operator
NF is bounded from Wp(J; X) into Wp/α(J; Y ).
Proof. Let f ∈W[U]
p (J; X). By Proposition 6.20(a), the closure of ran (f)
is a compact subset of U. Since ∥· ∥J,sup ≤∥· ∥J,[p], it follows that a ball
B(f, ǫ) is included in W[U]
p (J; X) for some ǫ > 0 just as at the beginning
of the proof of Proposition 6.26, and so W[U]
p (J; X) is open. By Proposition
6.3, ran (f) ⊂Bm(U) for some m ≥1. Then NF f ∈Wp/α(J; Y ) by the ﬁrst
part of Lemma 6.22(a) with B = Bm(U) and β = α. If U = X and E is a
bounded subset of Wp(J; X) then E ⊂Bm(X) for some m and {NF f : f ∈E}
is a bounded set in Wp/α(J; Y ) by the second part of Lemma 6.22(a) with
B = Bm(X) and β = α, proving the proposition.
2

294
6 Nemytskii Operators on Some Function Spaces
In spite of the simplicity of the proofs of Lemma 6.22(a) and Proposition
6.34, in order that F ◦f ∈Wp/α(J; R) for all f ∈Wp(J; R), it is necessary
that F ∈Hloc
α , as will follow from the next theorem, taking Ψ(y) = yp/α and
Φ(x) = xp. Recall that a function Φ: [0, ∞) →[0, ∞) belongs to the class V
if it is strictly increasing, continuous, unbounded, and 0 at 0.
Theorem 6.35 (Ciemnoczo lowski and Orlicz). Let J := [a, b] with a < b, let
Φ, Ψ ∈V, and let Ψ satisfy the ∆2 condition (3.3). Suppose that a function
F : R →R is such that vΨ(F◦f; J) < ∞for each f ∈WΦ(J). Then for every
M > 0 there is a ﬁnite constant K such that for any u, v ∈[−M, M],
Ψ(|F(u) −F(v)|) ≤KΦ(|u −v|).
(6.12)
Proof. First we prove that F is bounded over each interval [−M, M]. Suppose
not. Then for some M > 0, there exists a sequence {ui}i≥1 ⊂[−M, M] such
that |F(ui)| →+∞as i →∞. Due to compactness of [−M, M], by passing to
a subsequence if necessary, we can and do assume that for some u0 ∈[−M, M]
we have |ui −u0| ↓0 and Φ(2|ui −u0|) ≤2−i for each i = 1, 2, . . . . For a
sequence {ti}i≥1 of distinct points of J, let f be a function on J such that
f(ti) = ui for i = 1, 2, . . ., and f(t) = u0 for t ∈J \ {ti}i≥1. Then for any
point partition κ of J, we have
sΦ(f; κ) ≤2
X
i≥1
Φ(|ui −u0|) + 2
X
i≥1
sup
j>i
Φ(|ui −uj|) ≤4
∞
X
i=1
Φ(2|ui −u0|) ≤4,
and so f ∈WΦ(J). On the other hand, we have
vΨ(F◦f; J) ≥Ψ(|F(f(ti)) −F(f(t1))|) = Ψ(|F(ui) −F(u1)|) →+∞
as i →∞, a contradiction, proving that F is bounded on every bounded
interval.
To prove (6.12) suppose that it does not hold for some M > 0. For each
u, v ∈[−M, M] with v > u, let k(u, v) be the ratio of Ψ(|F(v) −F(u)|) to
Φ(v −u). Therefore there exists a sequence {[ui, vi]}i≥1 of subintervals of J
such that
k(ui, vi) →+∞
(6.13)
as i →∞. Since F is bounded on [−M, M], we have that vi−ui →0 as i →∞.
For each i ≥1, let wi := (ui+vi)/2. Due to compactness of [−M, M], taking a
subsequence if necessary, we can and do assume that there is a w0 ∈[−M, M]
such that wi →w0 as i →∞. Let I
:= {i ≥1 : w0 ∈[ui, vi]} and let N
be the cardinality of I. First suppose that N < ∞. By symmetry we can and
do assume that there are inﬁnitely many intervals [ui, vi] to the right of w0.
Recursively select from this set of intervals a subsequence {[u′
i, v′
i]}i≥1 such
that for i = 1, 2, . . . :
(a) w0 < · · · < u′
i+1 < v′
i+1 < u′
i < v′
i < · · · ;

6.4 Autonomous Nemytskii Operators on Wp Spaces
295
(b) Φ(v′
i −w0) ≤2−i−1;
(c) k(u′
i, v′
i) ≥22i+1.
By (b), we have that 2iΦ(v′
i −u′
i) < 1/2 for each i ≥1. Thus for each i ≥1,
letting mi be the largest integer ≤(2iΦ(v′
i −u′
i))−1, we have that
1/2i+1 < miΦ(v′
i −u′
i) ≤1/2i.
(6.14)
Let {[si, ti)}i≥1 be a sequence of nonempty disjoint subintervals of J, and
for each i ≥1, let κi = {sij, tij}mi
j=1 be a point partition of [si, ti), so that
si = si1 < ti1 < · · · < simi < timi < ti. Let f be a function on J such that
f(t) =



v′
i if t = tij for some i, j,
u′
i if t ∈[si, ti) \ {tij}mi
j=1 for some i ≥1,
w0 if t ∈J \ ∪i[si, ti).
(6.15)
Then by (b) and the right side of (6.14), for any point partition κ of J, we
have
sΦ(f; κ) ≤2
X
i≥1
miΦ(v′
i −u′
i) + 2
X
i≥1
Φ(v′
i −w0) ≤3,
(6.16)
and so f ∈WΦ(J). On the other hand by (c) and by the left side of (6.14),
we have for each i
vΨ(F◦f; J) ≥
mi
X
j=1
Ψ(|F(f(tij)) −F(f(sij))|) = miΨ(|F(v′
i) −F(u′
i)|)
= k(u′
i, v′
i)miΦ(v′
i −u′
i) ≥22i+1/2i+1 = 2i →∞
(6.17)
as i →∞, a contradiction.
Now suppose that N = +∞. Then for inﬁnitely many i ≥1, we have
either w0 ∈(ui, vi), or w0 = ui, or w0 = vi. Since the proof in each case is
similar, we assume that ui < w0 < vi for each i ≥1. For each i ≥1, let
Si := max{k(ui, w0), k(w0, vi)}. Then by the ∆2 condition (3.3) for Ψ, we
have
Ψ(|F(vi) −F(ui)|) ≤Ψ(2|F(vi) −F(w0)|) + Ψ(2|F(w0) −F(ui)|)
≤DSi

Φ(vi −w0) + Φ(w0 −ui)

≤2DSiΦ(vi −ui).
Thus for each i ≥1, it follows that Si ≥k(ui, vi)/(2D). By (6.13), we can
recursively select a sequence {[u′
i, v′
i]}i≥1 such that for each i ≥1, either
k(w0, v′
i) ≥22i+1 or k(u′
i, w0) ≥22i+1. By symmetry, we assume that the ﬁrst
case holds. Taking a subsequence if necessary, we assume that Φ(v′
i −w0) ≤
1/2i+1 for each i ≥1. Thus for each i ≥1, letting mi be the largest integer
≤(2iΦ(v′
i −w0))−1 we have that (6.14) holds with w0 instead of u′
i. Let f be
the function on J deﬁned by (6.15) with w0 instead of u′
i for each i ≥1. Then
for any point partition κ of J, (6.16) holds with all u′
i replaced by w0, and so

296
6 Nemytskii Operators on Some Function Spaces
f ∈WΦ(J). On the other hand, (6.17) holds with all u′
i replaced by w0, again
a contradiction, proving (6.12).
2
Proposition 6.34 and Theorem 6.35 imply the following:
Corollary 6.36. Let 0 < p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For a function F : R →R, the autonomous Nemytskii operator NF acts from
Wp(J) into Wq(J) if and only if F ∈Hloc
α .
Fr´echet diﬀerentiability and remainder bounds
We will give a bound for the remainder RemNF , as deﬁned in (6.3), in the
Fr´echet diﬀerentiability of the autonomous Nemytskii operator NF acting
from Wp(J; X) into Wr(J; Y ) with p < r. Recall Deﬁnition 6.5 of the class
Hloc
1+α(U; Y ).
Theorem 6.37. Let 0 < α ≤1, 1 ≤p < αr < ∞and let J := [a, b] with
a < b. For Banach spaces X, Y , let U be a nonempty open subset of X, let
F ∈Hloc
1+α(U; Y ), and let G ∈W[U]
p (J; X). Then there is a neighborhood V of
zero in Wp(J; X) such that the autonomous Nemytskii operator NF acts from
G + V into Wr(J; Y ), and is Fr´echet diﬀerentiable at G with derivative g 7→
(s 7→(DF)(G(s))g(s)), and there is a ﬁnite constant C := C(F, G, V, α, p, r)
such that the remainder bound
RemNF (G, g)

[r] ≤C∥g∥α−p/r
sup
∥g∥[p]
(6.18)
holds for each g ∈V . We can take C := ∥DF∥B2m,Hα[E∥G∥p/r
(p) + 2E + 1]
where for some m ≥1, G takes values in Bm := Bm(U), V
:= {g ∈
Wp(J; X): ∥g∥[p] < 1/(2m)}, E := C(α−1, (1 −α + p/r)−1, pα−1), and
C(·, ·, ·) is the constant in (3.167). If in addition X = Y = K then the deriva-
tive DNF (G) is a linear multiplication operator M[F ′◦G].
The proof is based on bounds, obtained in Theorem 3.111, of the γ-
variation seminorm of the integral transform KH := F(H −H(·, 0), dG) on
[a, b] with G(t) ≡t on [0, 1], deﬁned by (3.164), and so
KH(s) =
Z 1
0
H(s, t) dt −H(s, 0),
a ≤s ≤b.
(6.19)
We will take a function H and a number γ = r ∈[1, ∞) as in the next lemma.
Lemma 6.38. Let 0 < α ≤1, 1 ≤p ≤αr < ∞, J := [a, b] with a < b.
For Banach spaces X, Y , let U be a nonempty open subset of X and let
F ∈Hloc
1+α(U; Y ). Let G, g ∈Wp(J; X) and B := Bm(U) for some m ≥1 be
such that G(s) + tg(s) ∈B for all s ∈J and t ∈[0, 1]. Then for the integral
transform K := KH with

6.4 Autonomous Nemytskii Operators on Wp Spaces
297
H(s, t) := DF(G(s) + tg(s))g(s),
(s, t) ∈J × [0, 1],
(6.20)
we have the bound
K

[r] ≤∥DF∥B,Hα
n
E∥G∥p/r
(p) +(1+E)∥g∥p/r
[p] +E
o
∥g∥[p]∥g∥α−p/r
sup
, (6.21)
where E := C(α−1, (1 −α + p/r)−1, pα−1) and C(·, ·, ·) is the constant in
(3.167).
Proof. Let ep and eq respectively be the parameters called p and q in Theorem
3.111, let the function called G there be here ˜G(t) ≡t, 0 ≤t ≤1, and
apply the theorem to β := p/α, ep := 1/α, and eq := 1/(1 −α + p/r) ≥1.
Then ep−1 + eq−1 = 1 + p/r > 1, γ = r, and ∥˜G∥(eq) ≤∥˜G∥(1) = 1. To bound
Aβ,sup(H; J × [0, 1]) deﬁned by (3.165), let κ = {si}n
i=0 be a point partition
of J and t ∈[0, 1]. Then using the Minkowski inequality (1.5), the fact that
DF ∈Hα(B; L(X, Y )), and letting f := G + tg, we have the bound
sβ(H(·, t); κ)1/β ≤

n
X
i=1
[DF(f(si)) −DF(f(si−1))]g(si)
β1/β
+

n
X
i=1
DF(f(si−1))[g(si) −g(si−1)]
β1/β
≤∥DF∥B,(Hα)

∥G∥α
(p) + ∥g∥α
(p)
	
∥g∥sup + ∥DF∥B,sup∥g∥(p)
≤∥DF∥B,Hα

∥G∥α
(p) + ∥g∥α
(p) + 1
	
∥g∥[p].
Since κ ∈PP (J) and t ∈[0, 1] are arbitrary, the right side gives a bound for
Aβ,sup(H; J × [0, 1]). Now for each point partition λ = {tj}m
j=0 of [0, 1] and
s ∈J, we have the bound
sep(H(s, ·); λ)1/ep ≤∥DF∥B,(Hα)∥g∥1+α
sup
 m
X
j=1
tj −tj−1
α
≤∥DF∥B,(Hα)∥g∥[p]∥g∥α
sup.
Again since λ ∈PP [0, 1] and s ∈J are arbitrary, the right side gives a
bound for Bsup,ep(H; J × [0, 1]) deﬁned by (3.166). Therefore by (3.167), since
β/γ = p/(αr) ≤1, it follows that
K

(r) ≤C∥DF∥B,Hα
n
∥G∥p/r
(p) + ∥g∥p/r
(p) + 1
o
∥g∥[p]∥g∥α−p/r
sup
.
Also, for each s ∈J, we have
K(s)
 ≤∥DF∥B,(Hα)∥g∥1+α
sup . Therefore (6.21)
holds.
2
Proof of Theorem 6.37. By Propositions 6.20(a) and 6.3, there is a positive
integer m such that ran (G) ⊂Bm = Bm(U). Let V be the set of all g ∈

298
6 Nemytskii Operators on Some Function Spaces
Wp(J; X) such that ∥g∥[p] < 1/(2m). It is easy to see that ran (G + tg) ⊂
B2m = B2m(U) ⊂U for each g ∈V and t ∈[0, 1]. Since F is Lipschitz on
B2m and p < r, NF acts from G + V into Wr(J; Y ) by Proposition 6.34.
To show Fr´echet diﬀerentiability of NF, for each g ∈Wp(J; X) let Lg be
the function s 7→(DF(G(s)))g(s), s ∈J. To show that Lg has bounded r-
variation let κ = {ti}n
i=0 be a point partition of J. Then using the Minkowski
inequality (1.5), we have
sr(Lg; κ)1/r ≤

n
X
i=1
[DF(G(ti)) −DF(G(ti−1))]g(ti)
r1/r
+

n
X
i=1
DF(G(ti−1))[g(ti) −g(ti−1)]
r1/r
≤∥DF∥Bm,(Hα)∥G∥α
(αr)∥g∥sup + ∥DF∥Bm,sup∥g∥(r).
Since κ is arbitrary and p < αr ≤r, it follows that Lg ∈Wr(J; Y ), and
so L is a bounded linear operator from Wp(J; X) into Wr(J; Y ). Since F
is continuously diﬀerentiable on U and since the segment joining G(s) and
(G + g)(s) is included in U for each s ∈J, by Lemma 5.40, we have

NF (G + g) −NF (G) −Lg

(s)
=
Z 1
0

DF(G(s) + tg(s)) −DF(G(s))

g(s) dt = KH(s),
where KH is deﬁned by (6.19) and (6.20). By Lemma 6.38 with B = B2m,
since now p/r < α, ∥KH∥[r] = o(∥g∥[p]) as ∥g∥[p] →0, and so NF is Fr´echet
diﬀerentiable at G. Since ∥g∥[p] < 1/2 < 1 for g ∈V , the remainder bound
(6.18) follows from (6.21) with C := ∥DF∥B2m,Hα[E∥G∥p/r
(p) +2E +1], proving
Theorem 6.37.
2
On Fr´echet diﬀerentiability of autonomous Nemytskii operators we also
have the following, recalling Deﬁnition 6.5 with here K = R:
Theorem 6.39. Let 0 < α ≤1, 1 ≤p < αr < ∞and J := [a, b], where
−∞< a < b < ∞. Then for any F ∈H1+α, NF is Fr´echet diﬀerentiable
from Wp(J) into Wr(J), with derivative DNF (G)(g) = F ′(G)g for any G, g ∈
Wp(J). There is a constant M := M(α, p, r) < ∞such that for each G ∈
Wp(G), F ∈H1+α, and g ∈Wp(J),
RemNF (G, g)

[r]
≤∥F ′∥(Hα)
n
M∥G∥p/r
(p) + (1 + M)∥g∥p/r
[p]
o
∥g∥α−p/r
sup
∥g∥[p].
Sketch of proof. The diﬀerentiability, with the given derivative, follows from
the remainder bound as in the proof of Proposition 6.7. The statement is

6.4 Autonomous Nemytskii Operators on Wp Spaces
299
clearly similar to that of Theorem 6.37. There we assume F ∈Hloc
1+α(U; Y ),
here F ∈H1+α(R; R). There we had DF(G(s) + tg(s)]g(s), which in the
present scalar case becomes the product of the functions F ′(G(s)+tg(s)) and
g(s). The r-variation norm of the product can be bounded using the Banach
algebra property of Wr(J). So we need only consider F ′(G(s) + tg(s)). The
proof then is similar to but easier than those of Lemma 6.38 and Theorem
6.37 and is omitted.
2
An operator N acting from a normed space (W1, ∥· ∥1) into a normed
space (W2, ∥· ∥2) is globally Lipschitz if there is a ﬁnite constant L such that
for each x, y ∈W1,
N(y) −N(x)

2 ≤L
y −x

1,
(6.22)
or locally Lipschitz if for each 0 < M < ∞there is a ﬁnite constant L =
L(M) such that (6.22) holds for all x, y ∈W1 having norms bounded by
M. The next theorem gives a local Lipschitz property of the autonomous
Nemytskii operator NF for functions F in the class Hloc
1+α(X; Y ) (Deﬁnition
6.5). Theorem 6.68 extends the local Lipschitz property to non-autonomous
Nemytskii operators. The global Lipschitz property for Nemytskii operators
is treated in Theorem 6.70.
Theorem 6.40. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For Banach spaces X and Y , let F ∈Hloc
1+α(X; Y ). Then the autonomous
Nemytskii operator NF acts from Wp(J; X) into Wq(J; Y ). Also, for any 0 <
R < ∞there are ﬁnite constants C and D such that for any f, g ∈Wp(J; X)
with sup norms bounded by R and for any nondegenerate interval A ⊂J,
∥NFf −NF g∥A,sup ≤C∥f −g∥A,sup,
(6.23)
∥NF f −NF g∥A,(q) ≤C∥f −g∥A,(q) + D∥f −g∥A,sup∥g∥α
A,(p). (6.24)
Moreover, if F ∈H1+α(X; Y ) and DF is bounded then (6.23) and (6.24) hold
with C = ∥DF∥sup and D = ∥DF∥(Hα) for any f, g ∈Wp(J; X).
Proof. Since F ∈Hloc
1+α(X; Y ), its derivative DF is in Hloc
α (X; L(Y ; X)) and
so DF is bounded on bounded sets. Thus by (5.2) in the mean value theorem,
F is locally Lipschitz, and so F ∈Hloc
1
(X; Y ) ⊂Hloc
α (X; Y ). Hence the
autonomous Nemytskii operator NF acts from Wp(J; X) into Wp(J; Y ) ⊂
Wq(J; Y ) by Proposition 6.34 with U = X.
Letting B := {x: ∥x∥≤3R}, we will show that (6.23) and (6.24) hold
with C := ∥DF∥B,sup and D = ∥DF∥B,(Hα). By (5.2) in the mean value
theorem, for each s ∈A we have
F(f(s)) −F(g(s))
 ≤∥DF∥B,sup∥f −g∥A,sup,
and so (6.23) holds. To prove (6.24) let a ≤s < t ≤b. By (5.2) in the mean
value theorem again, we have

300
6 Nemytskii Operators on Some Function Spaces
S :=
F(f(t)) −F(g(t) + (f −g)(s))
 ≤∥DF∥B,sup∥(f −g)(t) −(f −g)(s)∥,
since the segment joining f(t) and g(t) + (f −g)(s) is in B. Since DF ∈
Hα(B; L(X, Y )), and so F is continuously Fr´echet diﬀerentiable, by two ap-
plications of Lemma 5.40, it follows that
T :=

F(g(t) + (f −g)(s)) −F(g(t))

−

F(f(s)) −F(g(s))

=

Z 1
0
h
DF(g(t)+r(f −g)(s))−DF(g(s) + r(f −g)(s))
i
(f −g)(s)

dr

≤∥DF∥B,(Hα)∥g(t) −g(s)∥α∥f(s) −g(s)∥.
Then we have
R(s, t) :=
 F◦f −F◦g

(t) −
 F◦f −F◦g

(s)
 ≤S + T
≤C∥(f −g)(t) −(f −g)(s)∥+ D∥g(t) −g(s)∥α∥f(s) −g(s)∥.
Let κ = {ti}n
i=0 be a point partition of A. Applying the Minkowski inequality
(1.5), it follows that
sq(F◦f −F◦g; κ)1/q =

n
X
i=1
R(ti−1, ti)q1/q
≤Csq(f −g; κ)1/q + D∥f −g∥A,supsp(g; κ)1/q
≤C∥f −g∥A,(q) + D∥f −g∥A,sup∥g∥α
A,(p).
Since κ is an arbitrary partition of A, (6.24) holds, completing the proof of
the theorem.
2
6.5 Nemytskii Operators on Wp Spaces
In this section, the Nemytskii operator Nψ, where ψ = ψ(u, s) can depend on
s, is considered between the spaces G = Wp(J; X) and H = Wq(J; Y ).
Acting and boundedness conditions from Wp into Wq
For X = Y = R, when does the Nemytskii operator Nψ act from Wp(J) into
Wq(J) with 0 < p ≤q < ∞and α := p/q? If ψ(u, s) ≡F(u), then a necessary
and suﬃcient condition is that F is α-H¨older on bounded sets, by Corollary
6.36. For an arbitrary ψ, an α-H¨older condition in u for each s is not necessary,
as the following example shows:
Example 6.41. For a linearly ordered set S, let T be a ﬁnite subset of S, and
let ψ = ψ(u, s) be such that ψ(u, s) ≡0 if s ∈S \ T and ψ(u, s) is arbitrary
if s ∈T . Then Nψ(g) ∈Wq(S) for each q > 0 and any function g: S →R.

6.5 Nemytskii Operators on Wp Spaces
301
For an arbitrary ψ, we use an α-H¨older condition uniformly in s as follows:
Deﬁnition 6.42 (of UHα and Hα). Let 0 < α ≤1 and let S be a nonempty
set. For Banach spaces X and Y , let B be a subset of X with more than one
element and let ψ: B × S →Y . We say that ψ is s-uniformly α-H¨older on B,
or on B × S, or ψ ∈UHα(B × S; Y ), if there exists a ﬁnite constant H such
that
∥ψ(u, s) −ψ(v, s)∥≤H∥u −v∥α
(6.25)
for all u, v ∈B and all s ∈S. Let Hα(ψ) := Hα(ψ; B × S, Y ) be the minimal
H ≥0 such that (6.25) holds. We write ψ ∈UHα(B × S) if X = Y = K.
If ψ: X × S →Y is such that B ∋u 7→ψ(u, ·) =: f(u) ∈ℓ∞(S; Y ), then
the preceding condition ψ ∈UHα(B × J; Y ) holds if and only if f : B →
ℓ∞(S; Y ) has the α-H¨older property. Clearly, if ψ(u, s) ≡F(u) then ψ ∈
UHα(B ×S; Y ) if and only if F ∈Hα(B; Y ) and Hα(ψ) = ∥F∥(Hα). To deﬁne
a local version of a uniform α-H¨older condition recall Deﬁnition 6.4 and the
sequence of sets Bm(U), m = 1, 2, . . ., deﬁned there given an open set U.
Deﬁnition 6.43 (of UHloc
α ). Let α, S, X, and Y be as in Deﬁnition 6.42, let
U be a nonempty open subset of X, and let ψ: U × S →Y . We say that ψ is
s-uniformly α-H¨older locally on U, or ψ ∈UHloc
α (U ×S; Y ), if it is s-uniformly
α-H¨older on Bm(U) for all suﬃciently large m. We write ψ ∈UHloc
α (U × S)
if X = Y = K.
We show next that if the Nemytskii operator Nψ is bounded from Wp into
Wq, then for ψ ≡ψ(u, s), the (p/q)-H¨older condition in u is necessary for
all but countably many s. Recall that a nonlinear operator from one normed
space E into another is called bounded if it takes bounded subsets of E into
bounded sets.
Theorem 6.44. Let 1 ≤p ≤q < ∞, α := p/q, J := [a, b] with a < b, and
ψ: R × J →R. Suppose the Nemytskii operator Nψ is bounded from Wp(J)
into Wq(J). Then ψ ≡η + ξ, where
(a) η ∈UHloc
α (R × J).
(b) for some countable set E ⊂J, ξ(u, s) ≡0 for s ̸∈E.
(c) we have (u, s) 7→ψ(u, s+) ∈UHloc
α (R × [a, b)) and (u, s) 7→ψ(u, s−) ∈
UHloc
α (R × (a, b]).
(d) for each u and for f = ψ, η, or ξ, f(u, ·) ∈Wq(J). For u bounded, f(u, ·)
are bounded in Wq(J).
(e) if for a dense set of values of u, ψ(u, ·) is right-continuous on [a, b) and
left-continuous at b, then we can take ξ ≡0.
(f) Nη and Nξ are also bounded operators from Wp(J) into Wq(J).
Proof. On Wr(J) we have the equivalent norm |||f|||[r] := max{∥f∥(r), ∥f∥sup},
with |||f|||[r] ≤∥f∥[r] ≤2|||f|||[r] for all f. Then for any 0 < C < ∞, Nψ acts

302
6 Nemytskii Operators on Some Function Spaces
from {h: |||h|||[p] ≤C} into {f : ∥f∥(q) ≤M} for some M := M(C) < ∞. For
any C > 0 let
H := H(C) := 22α+1+(1/q)M.
(6.26)
We will ﬁrst show that for some countable set T ⊂J, and ψT = ψ restricted
to R × (J \ T ),
ψT ∈UHloc
α (R × (J \ T )).
(6.27)
Then (6.27) will also hold for any countable E ⊃T in place of T . Sup-
pose (6.27) fails for all countable T ⊂J. Then for some positive integer
k, there is no countable set T such that ψT ∈UHα([−k, k] × (J \ T )). In-
deed, otherwise for each k = 1, 2, . . . , there is a countable T (k) ⊂J such
that ψT (k) ∈UHα([−k, k] × (J \ T (k))). Then letting T := ∪k≥1T (k), (6.27)
holds with T countable, a contradiction. Therefore for each m = 1, 2, . . . ,
the set Em := Em,k of all s ∈J such that for some u, v ∈[−k, k],
ψ(u, s)−ψ(v, s)
 > m|u −v|α is uncountable. For any u, v ∈[−k, k] there are
points ul, vl ∈[−k, k], 1 ≤l ≤10k, such that maxl |ul −vl| ≤1/5 and
|ψ(u, s) −ψ(v, s)| ≤10k max
l
|ψ(ul, s) −ψ(vl, s)|
for any s ∈S. Therefore for each m = 1, 2, . . . and for all s ∈Em,k there are
u, v ∈[−k, k] such that |u −v| ≤1/5 and
ψ(u, s) −ψ(v, s)
 > (m/(10k))|u −
v|α. Take C = k, ﬁx m ≥10kH with H deﬁned by (6.26), and let F := Em,k.
For r = 5, 6, . . ., let Fr be the set of all s ∈F such that u and v can be chosen
with 1/(2r) < |u −v| ≤1/r. Since F = ∪∞
r=5Fr, some Fr is uncountable, and
we can assume F = Fr. Let δ := 1/(2r) < 1/9. We can assume u = ys and
v = zs chosen so that δ < zs−ys ≤2δ for all s. There is a ﬁnite set F ⊂[−C, C]
such that each point of [−C, C] is within δ/3 of some point in F. Thus for
some u ∈F, there is an uncountable set Au ⊂J with ys ≤u ≤zs for all
s ∈Au. For an n > (2M/H)q/δp, take a < s1 < · · · < sn < b with sj ∈Au for
j = 1, . . . , n. Let s0 := a and g(s0) := u. Recursively, suppose we have deﬁned
g(s0), . . . , g(sj−1) for j ≤n, where g(si) = zsi or ysi for each i with 1 ≤i < j,
so that |g(si) −u| ≤2δ. Since |ψ(zsj, sj) −ψ(ysj, sj)| > Hδα, we can choose
g(sj) = ysj or zsj such that ∆j := |ψ(g(sj), sj) −ψ(g(sj−1), sj−1)| > Hδα/2.
In either case, |g(sj)−g(sj−1)| ≤4δ. Thus g(sj) are deﬁned for j = 0, 1, . . . , n.
For each r = 1, . . . , n, we have Pr
j=1 ∆q
j ≥r(H/2)qδp. There is a least r ≤n
such that r(H/2)qδp > M q, and so 2r(4δ)p > 1 by (6.26). Then r ≥2 and
r
X
j=1
Nψ(g)(sj) −Nψ(g)(sj−1)
q =
r
X
j=1
∆q
j > M q.
(6.28)
Also, we have (r/2)(H/2)qδp ≤M q, and so using (6.26) and C = k ≥1,
r
X
j=1
|g(sj) −g(sj−1)|p ≤r(4δ)p ≤1 ≤Cp.
(6.29)

6.5 Nemytskii Operators on Wp Spaces
303
Let h(sj) := g(sj) for j = 0, . . . , r. Let h be linear on each interval [sj−1, sj],
j = 1, . . . , r, and h(s) := h(sr) = g(sr) for s ∈[sr, b]. Any p-variation sum
sp(h; κ) for h with a point partition κ of [a, b] is dominated by one in which
adjoining increments of the same sign are combined, so we can assume that
adjoining increments are of opposite signs. Then we can assume that the
points of κ are local maxima or minima of h and that κ ⊂{sj}r
j=0. Each
g(sj) is within 2δ of u, so vp(h) ≤r(4δ)p ≤1 by (6.29), and ∥h∥(p) ≤1 ≤C.
Since ∥h∥sup ≤C we have |||h|||[p] ≤C, but ∥Nψ(h)∥(q) > M by (6.28), a
contradiction. It follows that (6.27) holds for a countable set T ⊂J.
By taking any constant function u1(·) in Wp(J) we get ψ(u, ·) ∈Wq(J),
which is (d) for f = ψ, and so ψ(u, ·) is regulated by Proposition 3.33. There-
fore for u ∈Q (rational), ψ(u, ·) is continuous except at most for s in a
countable set Eu ⊂J. Let E := T ∪S
u∈Q Eu ∪{b}. Then E is countable.
For every u ∈R and a ≤s < b, the limit ψ(u, s+) = limt↓s ψ(u, t) exists.
The limit can be taken through t ̸∈E since E is countable. For t ̸∈E, the
functions ψ(·, t) are uniformly α-H¨older, thus uniformly equicontinuous, on
every bounded interval [−k, k], k = 1, 2, . . .. So as t ↓s through t ̸∈E,
ψ(·, t) converges uniformly on [−k, k] to ψ(·, s+). Thus (u, s) 7→ψ(u, s+) ∈
UHα([−k, k]×[a, b)). Moreover, if s ̸∈E then ψ(u, s+) = ψ(u, s) for all u ∈Q
and so for all u since both functions are α-H¨older.
For all u ∈R, let η(u, s) := ψ(u, s+) for a ≤s < b, and let η(u, b) :=
limt↑b ψ(u, t). Then (a) holds for η. Let ξ(u, s) := ψ(u, s) −η(u, s) for all
u ∈R and s ∈J. Then (b) holds for ξ. The ﬁrst conclusion of (c) is already
proved. The proof of the second one is symmetric. Next, (d) holds for f = η
since taking right or left limits cannot increase the q-variation. Since Wq is a
vector space, (d) also holds for f = ξ. Boundedness of f(u, ·) for u bounded
holds by the hypotheses, so (d) is proved. For (e), replacing Q by the given
dense set, the same proof gives η ≡ψ so ξ ≡0.
To prove (f), for ∥h∥sup ≤|||h|||[p] ≤S < ∞, we have
∥Nη(h)∥sup ≤sup{|η(u, s)|: s ∈J, |u| ≤S} < ∞
by (d). Any q-variation sum
n
X
i=1
η(h(si), si) −η(h(si−1), si−1)
q
can be approximated arbitrarily closely by a sum
n
X
i=1
ψ(h(si), ti) −ψ(h(si−1), ti−1)
q
for ti ̸∈E, ti close enough to si and ti > si except if sn = b, when tn < sn,
and t1 < t2 < · · · < tn. For any such {ti}n
i=1, there is a g ∈Wp(J) with
g(ti) = h(si) for i = 1, . . . , n and |||g|||[p] ≤|||h|||[p]. It follows that for any
S < ∞,

304
6 Nemytskii Operators on Some Function Spaces
sup

∥Nη(h)∥(q) : |||h|||[p] ≤S
	
≤sup

∥Nψ(g)∥(q) : |||g|||[p] ≤S
	
< ∞.
So (f) holds for Nη, and since Nξ ≡Nψ −Nη, also for Nξ. The theorem is
proved.
2
Remark 6.45. For ψ(u, s) ≡F(u) not depending on s the preceding theorem
gives that F is α-H¨older on bounded intervals. This also follows from the case
Ψ(y) = yq and Φ(y) = yp of Theorem 6.35, which assumes that NF acts
(without assuming it is bounded) from WΦ to WΨ. In this case the acting
condition implies boundedness by Proposition 6.34.
Example 6.41 shows that if the set E in (b) is ﬁnite, ψ(·, s) for s ∈E can
be arbitrary bounded functions. Speciﬁcally, let E have cardinality n < ∞,
let |ψ(u, s)| ≤M < ∞for any s ∈E and u ∈R, and let ψ(u, s) = 0 whenever
s ∈J \ E. Then for an arbitrary function g: J →R we have Nψg ∈Wq(J)
with ∥Nψg∥sup ≤M and ∥Nψg∥(q) ≤2n1/qM. So Nψ is bounded in the
unusually strong sense that it is bounded uniformly on any space of real-
valued functions, not only on bounded sets for some norm. In this case η ≡0
and ξ ≡ψ.
The following shows that ψ(u, ·) is regulated uniformly for u in bounded
intervals whenever the Nemytskii operator Nψ acts from W1(J) into R(J).
Recall that W∞(J) is the space R(J) of real-valued regulated functions on
J and ℓ∞(J) is the space of real-valued bounded functions on J, both with
supremum norm.
Proposition 6.46. Let 1 ≤p ≤∞, 1 ≤q ≤∞, J := [a, b] with a < b, and
ψ: R × J →R. Suppose the Nemytskii operator Nψ acts from Wp(J) into
Wq(J). Then
(a) ψ(u, ·) ∈Wq(J) for each u ∈R;
(b) for each k = 1, 2, . . . , ψ is bounded on [−k, k] × J;
(c) for each C > 0, letting ψC be ψ restricted to [−C, C] × J, the function
s 7→ψC(·, s) is in R(J; ℓ∞([−C, C])).
Proof. Since W1(J) ⊂Wp(J) for p ≥1 by Lemma 3.45, we can assume p = 1.
For each u ∈R, ψ(u, ·) = Nψ(u1(·)) ∈Wq(J) since u1(·) ∈W1(J), proving
(a). To prove (b), suppose it fails for some k. For each j = 1, 2, . . ., choose
uj ∈[−k, k] and tj ∈J with |ψ(uj, tj)| > j. Taking subsequences and by
symmetry, we may and do assume that uj ↓u0 ∈[−k, k] and tj ↑s ∈J. Let
h(a) := u1, h(tj) := uj for j ≥1, let h be linear on each interval [tj−1, tj],
where t0 := a, and let h(t) := u0 for t ∈[s, b]. Then h is nonincreasing and
bounded, so h ∈W1(J), but (Nψh)(tj) are unbounded, a contradiction. Thus
(b) holds.
To prove (c), each ψC(·, s) is bounded on [−C, C] by (b). By (a) and
Proposition 3.33, ψ(u, ·) is regulated for each u ∈R. By symmetry it is enough
to prove that for each s ∈(a, b] and 0 < C < ∞, ψ(u, t) converges to ψ(u, s−)

6.5 Nemytskii Operators on Wp Spaces
305
as t ↑s uniformly for |u| ≤C. Suppose not. Then for some 0 < C < ∞and
s ∈(a, b] there are ǫ > 0, a < tj ↑s, and |uj| ≤C such that |ψ(uj, tj) −
ψ(uj, s−)| ≥2ǫ. Taking a subsequence, we can assume that uj →u0 for some
u0 ∈[−C, C], and then by symmetry that uj ↓u0. For each j, take sj ∈(tj, s)
such that |ψ(uj, sj) −ψ(uj, s−)| < ǫ and so |ψ(uj, tj) −ψ(uj, sj)| > ǫ. Taking
a subsequence of {tj}, we can assume that tj < sj < tj+1 for all j. Let
g(tj) := g(sj) := uj for all j ≥1 and g(a) := u1. Let g be linear on each
interval between adjacent values where it is deﬁned and g ≡u0 on [s, b]. Then
g is nonincreasing, so it is in W1(J). Also, for each j = 1, 2, . . . we have
that |(Nψg)(tj) −(Nψg)(sj)| > ǫ. So Nψg(s−) does not exist and Nψg is not
regulated, contradicting the acting hypothesis.
2
We will next deﬁne some conditions related to boundedness of the Ne-
mytskii operator Nψ from Wp into Wq with p ≤q. For 0 < p < ∞and
x = (x1, . . . , xn), xi ∈X, let wp(x) := vp({xi −xi−1}n
i=2)1/p + maxi ∥xi∥,
where
vp({xi −xi−1}n
i=2) := max
n m
X
j=1
xθ(j) −xθ(j−1)
p : 1 ≤m < n, (6.30)
1 = θ(0) < θ(1) < · · · < θ(m) = n
o
.
Clearly, vp({xi −xi−1}n
i=2) = vΦ({xi −xi−1}n
i=2) with Φ(u) ≡up, u ≥0,
deﬁned by (3.136). For 0 < α ≤1, let ψ ∈UHα(R × J), q := p/α, and
f ∈Wp(J). Using the Minkowski inequality (1.5), for any point partition
κ = {si}n
i=0 of J, we have
sq(Nψf; κ)1/q ≤Hα(ψ)∥f∥α
(p) +

n
X
i=1
ψ(f(si), si) −ψ(f(si), si−1)
q1/q
and wp({f(si)}n
i=1) ≤∥f∥[p]. Therefore Nψf ∈Wq(J) if ψ also satisﬁes the
condition formulated next.
Deﬁnition 6.47 (of Wα,q, Wα,q, and HWα,q). Let 0 < α ≤1, let 0 < q < ∞
and let J be a nondegenerate interval. For Banach spaces X, Y , let B be a
nonempty subset of X and let ψ ≡ψ(u, s): B × J →Y . We say that ψ is in
the class Wα,q(B × J; Y ) if for each 0 ≤K < ∞, there exists a ﬁnite constant
W = W(K) such that
sq(ψ; µ, κ) :=
n
X
i=1
∥ψ(ui, si) −ψ(ui, si−1)∥q ≤W q
(6.31)
for all partitions κ = {si}n
i=0 of J and for all ﬁnite sets µ = {ui}n
i=1 ⊂B such
that wαq(µ) ≤K. Let Wα,q(ψ, K) = Wα,q(ψ, K; B × J, Y ) be the minimal
W ≥0 such that (6.31) holds for a given K.
Suppose in addition that B has more than one element. We say that ψ is
in the class HWα,q(B × J; Y ) if

306
6 Nemytskii Operators on Some Function Spaces
(a) ψ is s-uniformly α-H¨older on B, or ψ ∈UHα(B × J; Y ) (Deﬁnition 6.42);
(b) ψ ∈Wα,q(B × J; Y ).
In other words, HWα,q(B × J; Y ) = UHα(B × J; Y ) ∩Wα,q(B × J; Y ). We
write ψ ∈HWα,q(B × J) if X = Y = K.
We will next compare the conditions ψ ∈UHα(B × J; Y ), ψ ∈Wα,q(B ×
J; Y ) and ψ ∈HWα,q(B × J; Y ) with the following two properties of ψ:
u 7→ψ(u, ·) ∈Hα(B; Wq(J; Y )),
(6.32)
s 7→ψ(·, s) ∈Wq(J; Hα,∞(B; Y )).
(6.33)
In (6.33), if B is bounded, Hα,∞(B; Y ) = Hα(B; Y ) as a set, but Hα,∞(B; Y )
has the norm ∥· ∥Hα and Hα(B; Y ) only a seminorm.
Proposition 6.48. Let 0 < α ≤1, 1 ≤q < ∞, J := [a, b] with a < b, let
X, Y be Banach spaces, and let B be a bounded set in X with more than one
element. For ψ: B × J →Y the following hold:
(a) if (6.32) holds then ψ ∈UHα(B × J; Y );
(b) if (6.33) holds then ψ ∈HWα,q(B × J; Y ).
Proof. For (a), assuming that (6.32) holds, it follows directly that ψ ∈
UHα(B×J; Y ). For (b) let (6.33) hold. The closure of the range of s 7→ψ(·, s) is
compact in Hα,∞(B; Y ) by Propositions 6.2 and 6.20(c), and so it is bounded,
showing that ψ ∈UHα(B ×J; Y ). Clearly (6.33) implies ψ ∈Wα,q(B ×J; Y ).
Thus (6.33) implies ψ ∈HWα,q(B × J; Y ), proving the proposition.
2
Remark 6.49. In the preceding proposition, clearly (a) also holds if in (6.32)
Wq(J; Y ) is replaced by ℓ∞(J; Y ), and (b) also holds if in (6.33) Hα,∞(B; Y )
is replaced by ℓ∞(B; Y ).
The following example shows that ψ ∈HWα,q(B × J; Y ) does not imply
(6.33), that is, the converse to (b) in the preceding proposition does not hold.
Example 6.50. Let Y := R and X = H, a separable, inﬁnite-dimensional
Hilbert space with orthonormal basis {ej}∞
j=1. For j = 1, 2, . . . and u ∈B :=
{x: ∥x∥≤1} ⊂H, let Fj(u) := max{0, 1 −2∥ej −u∥}. Let J := [0, 1] and
for s ∈J, let hj(s) := max{0, 1 −2j+1|s −(1/2j)|}, j = 1, 2, . . . . Then for
(u, s) ∈B × J, let ψ(u, s) := P∞
j=1 Fj(u)hj(s) ∈R. The sum converges since
for any u, Fj(u) ̸= 0 for at most one value of j, and so ∥ψ∥sup = 1. If for some
u, v ∈B, Fj(u) ̸= 0, Fi(v) ̸= 0, and i ̸= j, then ∥u −v∥≥
√
2 −1. Thus if
∥u −v∥<
√
2 −1 and s ∈J then either ψ(u, s) −ψ(v, s) = 0, or for some j,
|ψ(u, s) −ψ(v, s)| = |Fj(u) −Fj(v)||hj(s)| ≤2∥u −v∥,
and so ∥ψ(·, s)∥H1 ≤1 + 2/(
√
2 −1) for all s and ψ ∈UH1(B × J; R) ⊂
UHα(B × J; R) for any α ∈(0, 1]. Let α ∈(0, 1], 1 ≤q < ∞, and p := αq.

6.5 Nemytskii Operators on Wp Spaces
307
To show that ψ ∈Wα,q(B × J; R), let κ = {si}n
i=0 be a partition of J, let
0 < K < ∞, and let µ = {ui}n
i=1 ⊂B be such that wp(µ) ≤K. Then we have
at most ﬁnitely many values of j, say N, such that Fj(ui) ̸= 0 for some i.
Let I be the set of such j. Since wp(µ) ≤K, Kp ≥(N −1)(
√
2 −1)p, and so
N ≤1 + (K/(
√
2 −1))p. Using the Minkowski inequality (1.5), it then follows
that
sq(ψ; µ, κ)1/q ≤
X
j∈I

X
i: ∥ui−ej∥≤1/2
|Fj(ui)|q|hj(si) −hj(si−1)|q1/q
≤2(1 + (K/(
√
2 −1))p),
since v1(hj) ≤2 for each j, proving ψ ∈Wα,q(B × J; R). But letting e0 := 0,
si := 1/2n−i, i = 0, 1, . . . , n, for any n = 1, 2, . . . and 0 < q < ∞we have
n −1 =
n
X
i=1
|ψ(en−i, si) −ψ(en−i, si−1)|q ≤
n
X
i=1
∥ψ(·, si) −ψ(·, si−1)∥q
sup.
Thus the mapping s 7→ψ(·, s) is not in Wq(J; ℓ∞(B; R)), and so s 7→ψ(·, s) ̸∈
Wq(J; Hα,∞(B; R)) for each α ∈(0, 1], although it takes values in Hα(B; R) =
Hα,∞(B; R).
Next, local versions of the conditions in Deﬁnition 6.47 will be deﬁned
on U × J for an open set U ⊂X, using the sequence of closed, bounded
sets Bm := U1/m ↑U as m →∞deﬁned before Proposition 6.3. The Wloc
α,q
condition on ψ ∈UHloc
α
will be shown to be suﬃcient (Proposition 6.54(b))
for the Nemytskii operator Nψ to be bounded from Wp into Wq with q = αp.
Proposition 6.57 will show that a weaker condition is not suﬃcient.
Deﬁnition 6.51 (of Wloc
α,q and HWloc
α,q). Let α, q, J, X, and Y be as in Def-
inition 6.47. Let U be a nonempty open subset of X and let ψ: U × S →Y .
We say that ψ is in the class Wloc
α,q (U ×J; Y ) or in the class HWloc
α,q(U ×J; Y )
if for each suﬃciently large m, ψ is, respectively, in the class Wα,q(Bm ×J; Y )
or in the class HWα,q(Bm × J; Y ). We write ψ ∈Wloc
α,q (U × J) and ψ ∈
HWloc
α,q(U × J) if X = Y = K.
Recalling the deﬁnitions of Hα(·; B × J, Y ) and Wα,q(·, K; B × J, Y ) in
Deﬁnitions 6.42 and 6.47, respectively, the following is easy to check:
Proposition 6.52. Let 1 ≤q < ∞, α ∈(0, 1], let J be a nondegenerate
interval, and for Banach spaces X, Y , let B be a subset of X with more than
one element. Then Hα(·; B × J, Y ), and Wα,q(·, K; B × J, Y ) for each K ∈
[0, ∞), are seminorms.
The two seminorms for ψ just introduced will be used to give suﬃcient
conditions for acting and boundedness of the Nemytskii operator Nψ, in parts
(a) and (b) of the next fact. Conversely, part (c) shows that ﬁniteness of Wα,q
is necessary given that of Hα. See further Theorem 6.58.

308
6 Nemytskii Operators on Some Function Spaces
Lemma 6.53. Let 1 ≤p ≤q < ∞, α := p/q, J := [a, b] with a < b and let
A be a nondegenerate subinterval of J. For Banach spaces X and Y , let B be
a subset of X with more than one element and let ψ: B × J →Y . Then the
following hold:
(a) for g ∈Wp(J; X), if the range of g is included in B, then
Nψg

A,(q) ≤Hα(ψ; B × A, Y )∥g∥α
A,(p) + Wα,q(ψ, ∥g∥A,[p]; B × A, Y );
(b) for g ∈Wp(J; X), if ran (g) ⊂B, v ∈B and t ∈A, then
Nψg

A,sup
≤∥ψ∥B×A,sup
≤Hα(ψ; B×A, Y ) sup
u∈B
∥u −v∥α+Wα,q(ψ, ∥v∥; {v}×A, Y )+∥ψ(v, t)∥;
(c) for 0 ≤K < ∞,
Wα,q(ψ, K; B × A, Y )
≤Hα(ψ; B×A, Y )Kα+sup{∥Nψg∥A,(q): ∥g∥A,[p] ≤K, ran (g) ⊂B}.
Proof. In proving each inequality we can assume that its right side is ﬁ-
nite since otherwise there is nothing to prove. If g is constant, the proof
will show that the inequality in (a) holds with ∞· 0 replaced by 0 if
Hα(ψ; B × A, Y ) = +∞. To prove (a), let κ = {si}n
i=0 be a partition of A.
Then wp({g(si−1)}n
i=1) ≤∥g∥A,[p]. Thus by the Minkowski inequality (1.5),
(6.25) and (6.31), we have
sq(Nψg; κ)1/q ≤

n
X
i=1
h
∥ψ(g(si), si) −ψ(g(si−1), si)∥
+∥ψ(g(si−1), si) −ψ(g(si−1), si−1)∥
iq1/q
≤Hα(ψ; B × A, Y )

n
X
i=1
∥g(si) −g(si−1)∥p1/q
+

n
X
i=1
∥ψ(g(si−1), si) −ψ(g(si−1), si−1)∥q1/q
≤Hα(ψ; B × A, Y )∥g∥α
A,(p) + Wα,q(ψ, ∥g∥A,[p]; B × A, Y ).
Since κ is an arbitrary partition of A, (a) follows.
To prove (b), for g ∈Wp(J; X) with ran (g) ⊂B, for any u, v ∈B and
s, t ∈J, we have
ψ(u, s)
 ≤∥ψ(u, s) −ψ(v, s)∥+ ∥ψ(v, s) −ψ(v, t)∥+ ∥ψ(v, t)∥
≤Hα(ψ; B×A, Y ) sup
u∈B
∥u −v∥α+Wα,q(ψ, ∥v∥; {v}×A, Y )+∥ψ(v, t)∥.

6.5 Nemytskii Operators on Wp Spaces
309
Since the ﬁrst inequality in (b) is immediate, (b) holds.
For (c), let κ = {si}n
i=0 be a partition of A, and let µ = {ui}n
i=1 ⊂B be
such that wp(µ) ≤K. For such {ui} there is a g ∈Wp(J; X) with g(si) = ui
for all i, ran (g) ⊂µ ⊂B, and ∥g∥A,[p] ≤K. Then applying the Minkowski
inequality (1.5), (6.25), and (6.31), where sq(ψ; µ, κ) is deﬁned, we have
sq(ψ; µ, κ)1/q
≤

n
X
i=1
h
∥(Nψg)(si)−(Nψg)(si−1)∥+∥ψ(g(si−1), si−1)−ψ(g(si), si−1)∥
iq 1
q
≤
Nψg

A,(q) + Hα(ψ; B × A, Y )∥g∥α
A,(p)
≤sup

∥Nψg∥A,(q) : ∥g∥A,[p] ≤K, ran (g) ⊂B
	
+ Hα(ψ; B × A, Y )Kα.
Since κ and µ are arbitrary, (c) holds, completing the proof of the lemma. 2
Recall that for a nonempty open set U ⊂X, the sequence Bm(U) =
U1/m ↑U as m →∞is deﬁned before Proposition 6.3 and W[U]
p (J; X) is the
set of all g ∈Wp(J; X) such that the closure of the range ran (g) is included in
U. Also recall that a nonlinear operator from a subset E of one normed space
into another is called bounded if it takes bounded subsets of E into bounded
sets.
Proposition 6.54. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For Banach spaces X and Y , let ψ: X × J →Y . Then the following hold:
(a) if ψ ∈UHloc
α (U × J; Y ) for a nonempty open subset U of X, then (i) for
each 0 ≤K < ∞and each m = 1, 2, . . . ,
sup

∥Nψg∥[q] : ∥g∥[p] ≤K, ran (g) ⊂Bm(U)
	
< ∞
(6.34)
if and only if (ii) ψ ∈Wloc
α,q (U × J; Y ). In particular, Nψ acts from
W[U]
p (J; X) into Wq(J; Y ) provided ψ ∈HWloc
α,q(U × J; Y );
(b) if ψ ∈UHloc
α (X × J; Y ) then Nψ is a bounded operator from Wp(J; X)
into Wq(J; Y ) if and only if ψ ∈Wloc
α,q (X × J; Y );
(c) if B is a bounded subset of X having more than one element and if
ψ ∈UHα(B × J; Y ), then Nψ is a bounded operator from the set {g ∈
Wp(J; X): ran (g) ⊂B} into Wq(J) if and only if ψ ∈Wα,q(B × J; Y ).
Proof. For (a), to show (ii) implies (i), (6.34) follows from (a) and (b) of
Lemma 6.53, provided ψ ∈Wloc
α,q (U×J; Y ). Conversely, suppose that (i) holds.
Then by Lemma 6.53(c), for any K ≥0 and m = 1, 2, . . . , Wα,q(ψ, K; Bm(U)×
J, Y ) < ∞, and so ψ ∈Wloc
α,q (U × J; Y ), proving the ﬁrst part of (a). To
prove the second part let g ∈W[U]
p (J; X). By Propositions 6.20(a) and 6.3,

310
6 Nemytskii Operators on Some Function Spaces
ran (g) ⊂Bm(U) for some m. Then Nψg ∈Wq(J; Y ) by the ﬁrst part of (a).
The proof of (a) is complete.
To prove (b), for U = X and each m, Bm = Bm(X) = {x: ∥x∥≤m}.
Given a bounded set D in Wp(J; X), there is an m such that ran (g) ⊂Bm for
each g ∈D. Applying (a) and (b) of Lemma 6.53 to B = Bm and v = 0 ∈Bm,
we have that there is a ﬁnite constant C = C(ψ, D, m) such that ∥Nψg∥[q] ≤C
for each g ∈D provided ψ ∈Wloc
α,q (X × J; Y ). The converse implication holds
by Lemma 6.53(c) applied to each B = Bm, proving (b).
The proof of (c) is the same as the proof of (b), replacing Bm by B and 0
by any ﬁxed point v of B. The proof of Proposition 6.54 is complete.
2
Remark 6.55. In relation to Proposition 6.54(b), recall that by Deﬁnition
6.47, for a subset B of X with more than one element, HWα,q(B × J; Y ) =
UHα(B × J; Y ) ∩Wα,q(B × J; Y ) and so HWloc
α,q(B × J; Y ) = UHloc
α (B ×
J; Y ) ∩Wloc
α,q (B × J; Y ).
We next consider a condition weaker than ψ ∈Wloc
α,q (X × J; Y ). Namely,
condition (6.31) restricted to singletons µ means that ψ(u, ·) must have
bounded q-variation uniformly for u in bounded sets. Proposition 6.57 will
show that in the case p = q = α = 1, boundedness of the 1-variation of ψ(u, ·)
uniformly in u and an s-uniform Lipschitz condition on ψ(·, s) are not suf-
ﬁcient for Nψ to act from W1 into W1. In that direction we ﬁrst prove the
following.
Lemma 6.56. For any n = 1, 2, . . ., there exists a real-valued function ψ =
ψn on [0, 1] × [0, 1] such that
(a) for any s, u, v ∈[0, 1], |ψ(u, s) −ψ(v, s)| ≤|u −v|;
(b) for any u ∈[0, 1], ∥ψ(u, ·)∥(1) ≤2;
(c) for g(s) ≡s, ∥Nψg∥(1) ≥n;
(d) ψ(u, s) = 0 if s or u = 0 or 1, and |ψ(u, s)| ≤1/(4n+2) for all u, s ∈[0, 1].
Proof. Let n be a positive integer, and let M := Mn := (2n + 1)2. For j =
0, 1, . . . , M, let sj := j/M. Deﬁne ψ on [0, 1] × [0, 1], for u ∈[0, 1], letting
ψ(u, sj) := (−1)j max{0, (4n + 2)−1 −|u −sj|} if j = n + 2, . . . , M −n −2,
ψ(u, sj) := 0 if j = 0, 1, . . ., n+1 or j = M −n−1, . . . , M, and letting ψ(u, ·)
be linear on each interval [sj−1, sj], j = 1, . . . , M. To check (a) notice ﬁrst
that it holds when s = sj for each j, and so it holds for all 0 ≤s ≤1.
To check (b) let u ∈[0, 1]. By the piecewise linearity of ψ(u, ·), we have
∥ψ(u, ·)∥(1) ≤
M
X
j=1
|ψ(u, sj) −ψ(u, sj−1)|.
For each j, we have ψ(u, sj) = 0 if |u −sj| ≥1/(4n + 2), and so ψ(u, sj) ̸= 0
for at most 2n + 1 values of j. Thus in the sum there are at most 2n + 3
non-zero terms, each no larger than (2n+1)−1, giving a sum ≤2, proving (b).

6.5 Nemytskii Operators on Wp Spaces
311
For (c) where g is the identity function, we have
∥Nψg∥(1) ≥
M−n−1
X
j=n+2
ψ(sj, sj) −ψ(sj−1, sj−1)
 ≥2n −1 ≥n,
proving (c).
We have (d) for s = 0 or 1 by the deﬁnition of ψ, and
ψ(0, sn+2) = ψ(1, sM−n−2) = 0.
It follows that ψ(0, s) = ψ(1, s) = 0 for s = sj for all j, and then all s, so (d)
and the lemma are proved.
2
Now we can prove that boundedness of the 1-variation of ψ(u, ·) uniformly
in u and an s-uniform Lipschitz condition on ψ(·, s) are not acting conditions
from W1 into W1 for the Nemytskii operator Nψ.
Proposition 6.57. There exists a real-valued function ψ on [0, 1]×[0, 1] such
that (a) and (b) of Lemma 6.56 hold and ∥Nψg∥(1) = +∞where g(s) ≡s,
0 ≤s ≤1.
Proof. For n = 1, 2, . . . , let ψn be functions on [0, 1] × [0, 1] satisfying all four
properties of Lemma 6.56. For j = 1, 2, . . ., let pj := 1/[j(1 + j)]. Let t0 := 0
and for n ≥1, let tn := Pn
j=1 pj ↑1 as n →∞. Let Cn := [tn−1, tn]×[tn−1, tn].
Deﬁne a function ψ on [0, 1] × [0, 1] to be 0 outside ∪∞
n=1Cn, and on Cn let
ψ(tn−1 + pnu, tn−1 + pns) := pnψn(u, s) for 0 ≤u ≤1 and 0 ≤s ≤1.
To prove (a) of Lemma 6.56 for ψ, let s = tn−1 + pnsn for some sn,
0 ≤sn ≤1. For tn−1 ≤u = tn−1 + pnun ≤v = tn−1 + pnvn ≤tn,
ψ(u, s) −ψ(v, s)
 = pn
ψn(un, sn) −ψn(vn, sn)

≤pn|un −vn| = pn|u −v|/pn = |u −v|.
So (a) holds on Cn for each n. Since ψ is 0 on the boundary of each Cn and
outside their union, (a) holds on [0, 1] × [0, 1].
For (b) of Lemma 6.56, notice that ψ(u, 1−) = 0 for each u ∈[0, 1]. Using
additivity over adjoining intervals of the 1-variation, we then have
∥ψ(u, ·)∥(1) =
X
n≥1
pn∥ψn(u, ·)∥(1) ≤2
for each u ∈[0, 1], proving (b). Actually ∥ψn(u, ·)∥(1) > 1 implies sn−1 < u <
sn, which can hold for only one value of n.
For g(s) ≡s, using (c) of Lemma 6.56, we have
Nψg

(1) ≥
X
n≥1
pn∥Nψng∥(1) ≥
X
n≥1
n
n(n + 1) = +∞.
The proof of Proposition 6.57 is complete.
2

312
6 Nemytskii Operators on Some Function Spaces
The main result of this section thus far is the following suﬃcient condition
for acting and boundedness of a Nemytskii operator Nψ on Banach-valued
functions. Part (b) gives necessity for real-valued functions under a hypothesis
on ψ.
Theorem 6.58. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For Banach spaces X and Y , let ψ: X × J →Y .
(a) If ψ ∈HWloc
α,q(X × J; Y ) then the Nemytskii operator Nψ acts from
Wp(J; X) into Wq(J; Y ) and is bounded.
(b) Suppose that X = Y = R and for a dense set of values of u, ψ(u, ·) is right-
continuous on [a, b) and left-continuous at b. If the Nemytskii operator Nψ
acts and is bounded from Wp(J) into Wq(J) then ψ ∈HWloc
α,q(R × J).
Proof. For (a), Nψ acts from Wp(J; X) into Wq(J; Y ) by the second part of
Proposition 6.54(a) with U = X. By Proposition 6.54(b), Nψ is bounded.
For (b), by Theorem 6.44(e), ψ ∈UHloc
α (R × J). Thus ψ ∈HWloc
α,q(R × J)
by the implication (i) ⇒(ii) of Proposition 6.54(a) with U = X = Y = R. 2
Continuity and Lipschitz properties from Wp into Wq
The continuity of a Nemytskii operator Nψ will be proved using the following
conditions on ψ, which in turn use Deﬁnition 6.47 of Wα,q(B×J; Y ), Deﬁnition
6.8 of u-diﬀerentiability of ψ, and the deﬁnition of wp(x) for x = (x1, . . . , xn)
before (6.30).
Deﬁnition 6.59 (of CW0,q and HW0,α,q). Let 0 < α ≤1, let 0 < q < ∞,
and let J be a nondegenerate interval. For Banach spaces X, Y and for a
nonempty open set U ⊂X, let ψ ≡ψ(u, s): U × J →Y and let B be a
nonempty subset of U. We say that ψ is in the class CW0,q(B × J; Y ) if
(a) ∥ψ∥B×J,sup < ∞and ψ is s-uniformly continuous on B, that is, for each
ǫ > 0 there is a δ > 0 such that ∥ψ(u, s)−ψ(v, s)∥< ǫ whenever u, v ∈B,
∥u −v∥< δ and s ∈J;
(b) ψ ∈W1,q(B × J; Y ).
We say that ψ is in the class HW0,α,q(B×J; Y ) for α = 1 if 0 ∈B, ψ is Fr´echet
u-diﬀerentiable on U × J with derivative ψ(1)
u
∈CW0,q(B × J; L(X, Y )), and
ψ(0, ·) ∈Wq(J; Y ), or for α ∈(0, 1), if the following hold:
(c) sup{∥ψ(u, s) −ψ(v, s)∥: s ∈J, u, v ∈B, ∥u −v∥< δ} = o(δα) as δ ↓0;
(d) ψ ∈Wα,q(B × J; Y ), and for each 0 ≤K < ∞and ǫ > 0 there exists a
δ > 0 such that

6.5 Nemytskii Operators on Wp Spaces
313
∆q(ψ; µ1, µ2, κ)
:=
n
X
i=1
ψ(ui, si) −ψ(vi, si) −ψ(ui, si−1) + ψ(vi, si−1)
q < ǫq
for all partitions κ = {si}n
i=0 of J and for all sets µ1 = {ui}n
i=1 ⊂B,
µ2 = {vi}n
i=1 ⊂B such that wαq(µ1) ≤K, wαq(µ2) ≤K, and maxi ∥ui −
vi∥< δ.
We write ψ ∈CW0,q(B × J) and ψ ∈HW0,α,q(B × J) if X = Y = K.
Next a local version of these conditions will be deﬁned on U × J for an
open set U ⊂X. Recall that for a nonempty open set U ⊂X, the sequence of
closed, bounded sets Bm := Bm(U) := U1/m ↑U as m →∞is deﬁned before
Proposition 6.3.
Deﬁnition 6.60 (of HWloc
0,α,q). Let α, q, J, X, Y , U, and ψ be as in Deﬁni-
tion 6.59 and let 0 ∈U if α = 1. We say that ψ is in the class HWloc
0,α,q(U ×
J; Y ) if for each suﬃciently large m, ψ is in the class HW0,α,q(Bm × J; Y ).
We write ψ ∈HWloc
0,α,q(U × J) if X = Y = K.
The following conditions will be shown to imply a Lipschitz property for
a Nemytskii operator, and will be used in Section 6.6 concerning higher order
diﬀerentiability on Wp spaces.
Deﬁnition 6.61 (of HWn+α,q and HWloc
n+α,q). Let 0 < α ≤1 and 0 < q <
∞. Let J be a nondegenerate interval. For Banach spaces X, Y , let U be an
open subset of X, let B be a subset of U containing 0, and let n be a positive
integer. We say that ψ: U × J →Y is in the class HWn+α,q(B × J; Y ) if ψ
is Fr´echet u-diﬀerentiable of order n on U × J with derivatives such that for
k = 0, . . . , n −1,
ψ(k)
u (0, ·) ∈Wq(J; L(kX, Y ))
and
ψ(n)
u
∈HWα,q(B×J; L(nX, Y )), (6.35)
where L(0X, Y ) ≡Y . Let 0 ∈U, let Bm := U1/m, m = 1, 2, . . . , be the
sequence deﬁned before Proposition 6.3, and let m0 ≥1 be the least integer
such that 0 ∈Bm0. We say that ψ is in the class HWloc
n+α,q(U ×J; Y ) if for each
m > m0, ψ ∈HWn+α,q(Bm × J; Y ). Let HWn+α,q(B × J) := HWn+α,q(B ×
J; R) and HWloc
n+α,q(U × J) := HWloc
n+α,q(U × J; R).
Lemma 6.62. Let 0 < α ≤1, 1 ≤q < ∞, and J := [a, b] with a < b. For
Banach spaces X and Y , let B be a nonempty bounded and convex subset of
X such that 0 ∈B, let U be an open subset of X such that B ⊂U, and let
ψ: U × J →Y be in the class HWn+α,q(B × J; Y ) for some positive integer
n. Then for k = 0, . . . , n −1,
ψ(k)
u
∈HW1,q(B × J; L(kX, Y )).
(6.36)
Moreover, (6.36) holds with k = 0 if ψ ∈HW0,1,q(B × J; Y ).

314
6 Nemytskii Operators on Some Function Spaces
Proof. To prove (6.36) for k = n −1, let u, v ∈B. Since B is convex the
segment [u, v] joining u and v is included in B. Then by (5.2) in the mean
value theorem, we have for each s ∈J,
ψ(n−1)
u
(v, s) −ψ(n−1)
u
(u, s)
 ≤∥ψ(n)
u ∥B×J,sup∥u −v∥,
(6.37)
since ∥Dψ(n−1)
u
(·, s)∥= ∥ψ(n)
u (·, s)∥for each s by Proposition 5.25. Moreover,
since B is bounded, ∥ψ(n)
u ∥B×J,sup < ∞by the second inequality in Lemma
6.53(b) applied to ψ = ψ(n)
u . Thus ψ(n−1)
u
is s-uniformly Lipschitz on B, that
is, condition (a) in Deﬁnition 6.47 holds for ψ = ψ(n−1)
u
with α = 1.
To prove ψ(n−1)
u
∈W1,q(B × J; L(n−1X, Y )), let 0 ≤K < ∞, let µ =
{ui}n
i=1 ⊂B be such that wq(µ) ≤K, and let κ = {si}n
i=0 be a partition of
J. Recall Deﬁnition 6.47, including the deﬁnition (6.31) of sq(η; µ, κ). Since
for each s ∈J, ψ(n−1)
u
(·, s) is a continuously Fr´echet diﬀerentiable function on
U, by Proposition 5.25 and using the fact that Lu := L(u)(· · · ) = L(u, · · · ) ∈
L(n−1X, Y ) for L ∈L(nX, Y ) (see (5.5) and Proposition 5.5 with k = n and
m = 1), we have Dψ(n−1)
u
(rv, s)(v) = ψ(n)
u (rv, s)v ∈L(n−1X, Y ) for each
r ∈[0, 1] and v ∈B. By Lemma 5.40, by the Minkowski inequality (1.5) and
by Jensen’s inequality applied to integrals, we have
sq(ψ(n−1)
u
; µ, κ)1/q =

n
X
i=1

Z 1
0
h
ψ(n)
u (rui, si) −ψ(n)
u (rui, si−1)
i
ui dr
+ψ(n−1)
u
(0, si) −ψ(n−1)
u
(0, si−1)

q1/q
≤K
 Z 1
0
n
X
i=1
∥ψ(n)
u (rui, si) −ψ(n)
u (rui, si−1)∥q dr
1/q
+ sq(ψ(n−1)
u
(0, ·); κ)1/q
≤KW1,q(ψ(n)
u , K) + ∥ψ(n−1)
u
(0, ·)∥(q)
since maxi ∥ui∥≤K and wq({rui}n
i=1) ≤K for each r ∈[0, 1]. Thus
W1,q(ψ(n−1)
u
, K; B × J, L(n−1X, Y )) < ∞for any 0 ≤K < ∞, and so (6.36)
holds for k = n −1. Proceeding in the same way for the lower derivatives we
conclude that (6.36) holds for k = 0, . . . , n −1.
Finally let ψ ∈HW0,1,q(B ×J; Y ). Then ∥ψ(1)
u ∥B×J,sup < ∞by Deﬁnition
6.59(a), and so ψ is s-uniformly Lipschitz on B by (6.37) with n = 1. Since
for each s ∈J, ψ(·, s) is a continuously Fr´echet diﬀerentiable function on U,
and since ψ(1)
u
∈W1,q(B × J; L(X, Y )) by Deﬁnition 6.59(b), the preceding
argument for k = 0 yields (6.36) with k = 0, proving the lemma.
2
Now we are ready to prove continuity properties of the Nemytskii operator
for ψ in one of the classes in Deﬁnition 6.60.

6.5 Nemytskii Operators on Wp Spaces
315
Theorem 6.63. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For Banach spaces X and Y , let ψ ∈HWloc
0,α,q(X ×J; Y ). Then the Nemytskii
operator Nψ is uniformly continuous on bounded sets from Wp(J; X) into
Wq(J; Y ).
Proof. By Deﬁnition 6.60 with U = X, the class HWloc
0,α,q(X ×J; Y ) is deﬁned
with respect to the sequence of balls Bm := Bm(X) = {x: ∥x∥≤m} for m =
1, 2, . . . , and so ψ ∈HW0,α,q(Bm×J; Y ) for each m. If α ∈(0, 1), by Deﬁnition
6.59 with B = Bm, m = 1, 2, . . ., its condition (c) implies that ψ is s-uniformly
α-H¨older on Bm, or ψ ∈UHα(Bm × J; Y ) according to Deﬁnition 6.42. Thus
ψ ∈UHloc
α (X ×J; Y ) by Deﬁnition 6.43. Also, condition (d) of Deﬁnition 6.59
implies that ψ ∈Wα,q(Bm × J; Y ) for each m as deﬁned in Deﬁnition 6.47.
Thus ψ ∈Wloc
α,q (X×J; Y ) by Deﬁnition 6.51. Therefore ψ ∈Wloc
α,q ∩UHloc
α , and
so Nψ acts from Wp(J; X) into Wq(J; Y ) by Proposition 6.54(b) if α ∈(0, 1).
For α = 1, so p = q, by Deﬁnition 6.59, ψ is Fr´echet u-diﬀerentiable everywhere
on X × J with derivative ψ(1)
u
∈CW0,p(Bm × J; L(X, Y )) for each m, and
ψ(0, ·) ∈Wp(J; Y ). Thus by the second part of Lemma 6.62, it follows that
ψ ∈HW1,p(Bm × J; Y ) for each m, and so ψ ∈HWloc
1,p (X × J; Y ) according
to Deﬁnition 6.51. Thus the Nemytskii operator Nψ acts from Wp(J; X) into
Wp(J; Y ) for α = 1, again by Proposition 6.54(b).
To prove the uniform continuity of Nψ on bounded sets let 1 ≤M < ∞
and ǫ ∈(0, 1]. Let K := M + 1. We will show that there are ﬁnite constants
C = C(ψ, M) and δ > 0 such that if G ∈Wp(J; X) with ∥G∥[p] ≤M, then
∥Nψ(G + g) −Nψ(G)∥[q] ≤ǫC
(6.38)
for each g ∈Wp(J; X) with ∥g∥[p] ≤δ. Let B := {x ∈X : ∥x∥≤K}. First
suppose that α = 1. Since ψ ∈HWloc
0,1,q(X×J; Y ), ψ is Fr´echet u-diﬀerentiable
everywhere on X ×J with ψ(1)
u
∈CW0,p(B ×J; Y ), and so by Deﬁnition 6.59,
there is a δ ∈(0, ǫ) such that ∥ψ(1)
u (u, y) −ψ(1)
u (v, y)∥< ǫ whenever u, v ∈B,
∥u −v∥≤δ, and y ∈J. Let g ∈Wp(J; X) be such that ∥g∥[p] ≤δ. For each
s ∈J, since the line segment joining G(s) and (G + g)(s) is included in B, by
(5.2) in the mean value theorem, we have
Nψ(G+g)(s)−Nψ(G)(s)
 ≤∥ψ(1)
u ∥B×J,sup∥g∥sup < ǫ∥ψ(1)
u ∥B×J,sup. (6.39)
To bound the p-variation seminorm of Nψ(G + g) −Nψ(G), for any a ≤s <
t ≤b, let
T (s, t) :=

Nψ(G + g) −Nψ(G)

(t) −

Nψ(G + g) −Nψ(G)

(s)
(6.40)
= [ψ((G + g)(t), t) −ψ((G + g)(s), t)] −[ψ(G(t), t) −ψ(G(s), t)]
+[ψ((G + g)(s), t) −ψ(G(s), t)] −[ψ((G + g)(s), s) −ψ(G(s), s)].
Since ψ(1)
u (·, s) and ψ(1)
u (·, t) are continuous on B, by Lemma 5.40, we have

316
6 Nemytskii Operators on Some Function Spaces
T (s, t) =
Z 1
0
h
ψ(1)
u ((G + g)(s) + r[(G + g)(t) −(G + g)(s)], t)
−ψ(1)
u (G(s) + r[G(t) −G(s)], t)
i
[G(t) −G(s)] dr
+
Z 1
0
ψ(1)
u ((G+g)(s)+r[(G+g)(t)−(G+g)(s)], t)[g(t)−g(s)] dr
+
Z 1
0
h
ψ(1)
u ((G + rg)(s), t) −ψ(1)
u ((G + rg)(s), s)
i
g(s) dr.
For each r ∈[0, 1] we have u := (G + g)(s) + r[(G + g)(t) −(G + g)(s)] ∈B,
v := G(s) + r[G(t) −G(s)] ∈B, and ∥u −v∥≤∥g∥[p] ≤δ. Therefore
∥T (s, t)∥≤ǫ∥G(t) −G(s)∥+ ∥ψ(1)
u ∥B×J,sup∥g(t) −g(s)∥+
+ ∥g∥sup
Z 1
0
ψ(1)
u ((G + rg)(s), t) −ψ(1)
u ((G + rg)(s), s)
 dr.
Let κ = {si}n
i=0 be a partition of J. For any r ∈[0, 1], letting xi := (G +
rg)(si−1) for i = 1, . . . , n, we have wp({xi}n
i=1) ≤∥G∥[p] + ∥g∥[p] ≤K. Since
∥g∥[p] ≤ǫ and ∥G∥[p] ≤M, using the Minkowski inequality (1.5), Jensen’s
inequality for integrals, and Deﬁnition 6.47 for W1.p, it then follows that

n
X
i=1
T (si−1, si)
p1/p
≤ǫ∥G∥(p) + ∥ψ(1)
u ∥B×J,sup∥g∥(p) + ∥g∥sup×
×
 Z 1
0
n
X
i=1
ψ(1)
u ((G + rg)(si−1), si) −ψ(1)
u ((G + rg)(si−1), si−1)

p
dr
1/p
≤ǫ

M + ∥ψ(1)
u ∥B×J,sup + W1,p(ψ(1)
u , K; B × J, L(X, Y ))
	
,
where W1,p(ψ(1)
u , K; . . .) is ﬁnite because ψ(1)
u
∈CW0,p(B × J; L(X, Y )) ⊂
W1,p(B×J; L(X, Y )) by Deﬁnition 6.59(b). Letting C := M+2∥ψ(1)
u ∥B×J,sup+
W1,p(ψ(1)
u , K; B × J, L(X, Y )), and recalling that K = M + 1 and B =
{x: ∥x∥≤K}, so that C depends only on ψ and M, the preceding bound
and (6.39) yield (6.38) in the case α = 1.
Now suppose that α ∈(0, 1). By Deﬁnition 6.59(c), there is a δ1 > 0 such
that ∥ψ(u, s) −ψ(v, s)∥< ǫ∥u −v∥α whenever u, v ∈B, ∥u −v∥< δ1, and
s ∈J. By Deﬁnition 6.59(d), there is a δ2 > 0 such that ∆q(ψ; µ1, µ2, κ) < ǫq
whenever κ is a partition of J, µ1 = {ui}n
i=1 ⊂B, and µ2 = {vi}n
i=1 ⊂B
are such that wp(µ1) ≤K, wp(µ2) ≤K, and maxi ∥ui −vi∥< δ2. Let δ :=
min{δ1, δ2, 1}. By Proposition 3.40 with Φ(u) = up and c = (δ/2)p, there
exists a partition {zj}m
j=0 of J such that m ≤1 + 2pvp(G)/δp ≤1 + (2M/δ)p
and Osc (G, (zj−1, zj)) ≤δ/2 for each j = 1, . . . , m. Let g ∈Wp(J) be such
that ∥g∥α
[p] ≤δp/(2(δp + (2M)p)) < δ/2 < 1. If zj−1 < s < t < zj for some
j ∈{1, . . ., m} then ∥(G + g)(t) −(G + g)(s)∥< δ1 and ∥G(t) −G(s)∥< δ1,
and so by (6.40), we have

6.5 Nemytskii Operators on Wp Spaces
317
∥T (s, t)∥≤2ǫ∥G(t) −G(s)∥α + ǫ∥g(t) −g(s)∥α
+
ψ((G + g)(s), t)−ψ(G(s), t)−ψ((G + g)(s), s)+ψ(G(s), s)
.
Let κ = {si}n
i=0 be a partition of J and for each j = 1, . . . , m, let either
Ij := {i: zj−1 < si−1 < si < zj} or Ij := ∅if there is no such i. Let µ1 = {(G+
g)(si−1)}n
i=1 and µ2 = {G(si−1)}n
i=1. Then recalling that K = M +1, we have
wp(µ1) ≤K, wp(µ2) ≤K, and maxi ∥(G+g)(si−1)−G(si−1)∥≤∥g∥sup < δ2.
Using the Minkowski inequality (1.5), and again recalling Deﬁnition 6.59(d)
for ∆q, we have
 m
X
j=1
X
i∈Ij
∥T (si−1, si)∥q1/q
≤2ǫ∥G∥α
(p) + ǫ∥g∥α
(p) + ∆q(ψ; µ1, µ2, κ)1/q
≤2ǫ(M + 1),
where the sum over the empty set is deﬁned as 0. Since for each s ∈J,
∥(G + g)(s) −G(s)∥≤∥g∥sup < δ1, if i ∈{1, . . . , n} \ ∪m
j=1Ij then we have by
(6.40) ∥T (si−1, si)∥< 2ǫ∥g∥α
sup. Since there are no more than m such indices
i and ∥g∥α
sup ≤δp/(2(δp + (2M)p)) ≤1/(2m), we get the bound
sq(Nψ(G + g) −Nψ(G); κ)1/q ≤2ǫm∥g∥α
sup + 2ǫ(M + 1) ≤ǫ(2M + 3).
Again since ∥g∥sup < δ1, we have
Nψ(G + g)(s) −Nψ(G)(s)
 < ǫ∥g∥α
sup ≤ǫ
for each s ∈J. Therefore (6.38) holds with C = 2M + 4 when α ∈(0, 1),
proving the theorem.
2
In Deﬁnitions 6.59 and 6.60 for α = 1 and U = X = Y = R, if ψ(u, s) ≡
F(u) not depending on s, then Deﬁnition 6.59(b) holds with W1,q(ψ, K; B ×
J, R) ≡0 for each B = Bm(R) = [−m, m], m = 1, 2, . . ., and 0 ≤K < ∞
(Deﬁnition 6.47), and so ψ ∈HWloc
0,1,q(R × J; R) for some, or equivalently all,
q with 1 ≤q < ∞if and only if F is a C1 function on R. Thus we can apply
the preceding theorem to obtain the following:
Corollary 6.64. Let 1 ≤p < ∞and J := [a, b] with a < b. If F is a
real-valued C1 function on R then the autonomous Nemytskii operator NF is
uniformly continuous on bounded sets from Wp(J) into Wp(J).
In Deﬁnitions 6.59 and 6.60 for α ∈(0, 1) and U = X = Y = R, if ψ(u, s) ≡
F(u) not depending on s, then Deﬁnition 6.59(d) holds with W1,q(ψ, K; B ×
J, R) ≡0 for each B = Bm(R) = [−m, m], m = 1, 2, . . ., and 0 ≤K < ∞
(Deﬁnition 6.47), and ∆q ≡0. Therefore such ψ ∈HWloc
0,α,q(R×J; R) for some,
or equivalently all, q with 1 ≤q < ∞if and only if for each m = 1, 2, . . . ,

318
6 Nemytskii Operators on Some Function Spaces
sup

|F(u) −F(v)|: u, v ∈[−m, m], |u −v| < δ
	
= o(δα)
(6.41)
as δ ↓0. Now we can apply Theorem 6.63 to a function ψ(u, s) ≡F(u) in the
class HWloc
0,α,q(R × J; R) with α ∈(0, 1) to obtain local uniform continuity of
the autonomous Nemytskii operator NF :
Corollary 6.65. Let 1 ≤p < q < ∞, α := p/q, and J := [a, b] with a <
b. If F is a real-valued function on R such that (6.41) holds for each m =
1, 2, . . . , then the autonomous Nemytskii operator NF is uniformly continuous
on bounded sets from Wp(J) into Wq(J).
In Corollary 6.64, the operator NF is not necessarily uniformly continuous
on bounded sets if F is only a Lipschitz function:
Proposition 6.66. For F(u) := |u|, J := [0, 2π], and 1 ≤p < ∞, the au-
tonomous Nemytskii operator NF is not uniformly continuous on bounded sets
from Wp(J) into itself; in fact, there is a bounded sequence {Gn} ⊂Wp(J)
such that for the sequence of constant functions gn ≡n−1/p, F ◦(Gn + gn) −
F ◦Gn does not converge to 0 in Wp(J).
Proof. Let Gn(s) := n−1/p cos(ns) for s ∈J. Consider the partition κn of J
consisting of the points sj
:= jπ/(2n) for j = 0, 1, . . ., 4n. Then along κn,
n1/pGn runs through the sequence of values 1, 0, −1, 0, 1, 0, −1, . . ., −1, 0, 1.
Considering only the even values of j we get all the relative maxima and
minima of Gn and ﬁnd that vp(Gn) = 21+p for each n, so ∥Gn∥[p] are bounded.
If j = 4i −1 for i = 1, . . . , n, we have Gn(sj) = 0, Gn(sj) + gn = n−1/p, and
Gn(sj−1) = −n−1/p, so
|F(Gn(sj) + gn) −F(Gn(sj)) −F(Gn(sj−1) + gn) + F(Gn(sj−1))| = 2n−1/p
for each such j. Thus vp(F ◦(Gn+gn)−F ◦Gn) ≥2p, which does not converge
to 0 as n →∞.
2
Remark 6.67. In fact, in the above proof ∥Gn∥H1/p are bounded and ∥gn∥→
0 in any normed space of real functions on [0, 2π] containing the constants.
Under some conditions on ψ we will prove a local Lipschitz property of
a Nemytskii operator Nψ, which in turn will be used to prove existence and
uniqueness of solutions of nonlinear integral equations in Chapter 10. Recall
Deﬁnition 6.61 of the class HWloc
n+α,q. Here we will take n = 1. For a function
ψ(u, s) ≡F(u), the condition ψ ∈HWloc
1+α,q(X × J; Y ) is equivalent to F ∈
Hloc
1+α(X; Y ) (Deﬁnition 6.5), and so the next result extends Theorem 6.40.
Theorem 6.68. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
For Banach spaces X and Y , let ψ ∈HWloc
1+α,q(X×J; Y ). Then the Nemytskii

6.5 Nemytskii Operators on Wp Spaces
319
operator Nψ acts from Wp(J; X) into Wq(J; Y ). Also, for each 0 < R < ∞,
if f, g ∈Wp(J; X) and 3 max{∥f∥[p], ∥g∥[p]} ≤R then for any nondegenerate
subinterval A ⊂J,
Nψf −Nψg

A,sup ≤C∥f −g∥A,sup
(6.42)
and
Nψf −Nψg

A,(q) ≤C∥f −g∥A,(q) + D∥f −g∥A,sup

∥g∥α
A,(p) + 1

,
(6.43)
where C := H1(ψ; BR × J, Y ) with BR := {x ∈X : ∥x∥≤R} and D :=
Hα(ψ(1)
u ; BR × J, Y ) + Wα,q(ψ(1)
u , R; BR × J, Y ).
Proof. Each Bm = Bm(X) in the sequence {Bm}∞
m=1 in the deﬁnition of
HWloc
1+α,q(X × J, Y ) is a ball with center zero and radius m, and so it is
bounded and convex with 0 ∈Bm. Thus by Lemma 6.62 with n = 1, we
have ψ ∈HW1,q(Bm × J; Y ) for each m, and so Nψ acts from Wp(J; X)
into Wq(J; Y ) by Proposition 6.54(b) and Remark 6.55. Let 0 < R < ∞,
let f, g ∈Wp(J; X) be such that 3 max{∥f∥[p], ∥g∥[p]} ≤R, and let A be a
nondegenerate subinterval of J. Let ⌈R⌉be the minimal integer m such that
m ≥R. Then C ≤H1(ψ; B⌈R⌉× J, Y ) < ∞, ran (f) ∪ran (g) ⊂BR, and for
each s ∈A,
 Nψf −Nψg

(s)
 =
ψ(f(s), s) −ψ(g(s), s)
 ≤C∥f −g∥A,sup,
and so (6.42) holds. To prove (6.43) let s, t ∈A and let
T1(s, t) :=
ψ(f(t), t) −ψ(g(t) + (f −g)(s), t)
.
Clearly, ψ(·, s) and ψ(·, t) are continuously Fr´echet diﬀerentiable functions on
X. Then by Lemma 5.40, we have

(Nψf −Nψg)(t) −(Nψf −Nψg)(s)
 −T1(s, t)

≤

ψ(g(t) + (f −g)(s), t) −ψ(g(t), t)

−

ψ(f(s), s) −ψ(g(s), s)

≤∥(f −g)(s)∥

Z 1
0
h
ψ(1)
u (g(t) −g(s) + ξ(r, s), t) −ψ(1)
u (ξ(r, s), s)
i
dr

≤∥f −g∥A,sup

T2(s, t) + T3(s, t)

,
where ξ(r, s) := g(s) + r(f −g)(s) for each r ∈[0, 1],
T2(s, t) :=
Z 1
0
ψ(1)
u (g(t) −g(s) + ξ(r, s), t) −ψ(1)
u (ξ(r, s), t)
 dr,
and
T3(s, t) :=
Z 1
0
ψ(1)
u (ξ(r, s), t) −ψ(1)
u (ξ(r, s), s)
 dr.

320
6 Nemytskii Operators on Some Function Spaces
Let κ = {si}n
i=0 be a partition of A. Then by the Minkowski inequality (1.5),
we have
sq
 Nψf −Nψg; κ
1/q ≤

n
X
i=1
T1(si−1, si)q1/q
+ ∥f −g∥A,sup
3
X
k=2

n
X
i=1
Tk(si−1, si)q1/q
.
(6.44)
Since ran (f) and ran (g)+ran(f −g) are subsets of BR and ψ ∈HW1,q(BR ×
J; Y ) ⊂UH1(BR × J; Y ) (Deﬁnition 6.42 and Remark 6.55 for α = 1 and
B = BR), we have
n
X
i=1
T1(si−1, si)q ≤Cq∥f −g∥q
A,(q).
Let D1 := Hα(ψ(1)
u ; BR × J, Y ). By Jensen’s inequality and the s-uniform
α-H¨older property (6.25) for ψ = ψ(1)
u
and B = BR, we have
n
X
i=1
T2(si−1, si)q
≤
n
X
i=1
Z 1
0
ψ(1)
u (g(si) −g(si−1) + ξ(r, si−1), si) −ψ(1)
u (ξ(r, si−1), si)

q
dr
≤
n
X
i=1
Dq
1
g(si) −g(si−1)
p ≤Dq
1∥g∥qα
A,(p),
since ran (g)+r ·ran(f −g) ⊂BR for each r ∈[0, 1]. Also, by the deﬁnition of
Wα,q(ψ(1)
u , R) following (6.31) with ψ(1)
u
in place of ψ and B = BR, we have
n
X
i=1
T3(si−1, si)q
≤
n
X
i=1
Z 1
0
ψ(1)
u (ξ(r, si−1), si) −ψ(1)
u (ξ(r, si−1), si−1)

q
dr
≤Wα,q(ψ(1)
u , R; BR × J, Y )q,
since wp({ξ(r, si−1)}n
i=1) ≤∥g + r(f −g)∥A,[p] ≤R for each r ∈[0, 1]. Letting
D2 := Wα,q(ψ(1)
u , R; BR × J, Y ), we have D = D1 + D2. The inequality (6.43)
now follows by (6.44), proving the theorem.
2
A local Lipschitz property of a Nemytskii operator now easily follows:

6.5 Nemytskii Operators on Wp Spaces
321
Corollary 6.69. Under the hypotheses of Theorem 6.68, for each 0 < M <
∞there is a ﬁnite constant L = L(M) such that the bound
Nψf −Nψg

[q] ≤L∥f −g∥[p]
holds for each f and g in Wp(J; X) having norms bounded by M.
An entire holomorphic function f from C into C is always locally Lipschitz.
But it is globally Lipschitz if and only if it is linear, f(z) ≡a+bz, by Liouville’s
theorem for f ′. Analogously the following fact, due to Matkowski and Mi´s [161]
for q = p = 1, shows that for a Nemytskii operator Nψ to be globally Lipschitz
from Wp into Wq requires ψ = ψ(u, s) to be of a very special linear form in
u, except perhaps for s in a countable set.
Theorem 6.70. Let 1 ≤p ≤q < ∞, J := [a, b] with a < b, and ψ: R × J →
R. Suppose that the Nemytskii operator Nψ acts from Wp(J) into Wq(J) and
there is a constant L < ∞such that for each f, g ∈Wp(J),
Nψ(f) −Nψ(g)

[q] ≤L∥f −g∥[p].
(6.45)
Then there are functions η, ξ : R×J →R such that ψ ≡η +ξ and a countable
set T ⊂J such that:
(a) ξ(u, s) = 0 for all s ∈J \ T and u ∈R;
(b) there are functions α, β ∈Wq(J) such that η(u, s) = α(s) + β(s)u for all
u ∈R and s ∈J;
(c) for f = ψ, η or ξ, f is s-uniformly Lipschitz on R and for each u ∈R,
f(u, ·) ∈Wq(J) and so is regulated;
(d) for each u ∈R, ξ(u, s−) = 0 for a < s ≤b and ξ(u, s+) = 0 for a ≤s < b;
(e) the Nemytskii operators Nη, Nξ are globally Lipschitz.
Proof. Since Wp(J) contains the constant functions, the function ψ(u, ·) is in
Wq(J) for each u ∈R, and so it is regulated by Proposition 3.33. Using (6.45)
for two constant functions u1(·) and v1(·), we get that
ψ(u, s) −ψ(v, s)| ≤
L|u −v| for any u, v ∈R and s ∈J. Let η(u, s) := ψ(u, s−) if s ∈(a, b] and
η(u, a) := ψ(0, a) for each u ∈R, and let ξ := ψ −η. Clearly η is s-uniformly
Lipschitz on R and for each u ∈R, η(u, ·) ∈Wq(J). The same is true for ξ by
linearity, and so (c) holds.
To prove (b), deﬁne two functions fk, k = 1, 2, as follows. Let {ck, dk},
k = 1, 2, be real numbers, t ∈(a, b], and let {ti}2n+1
i=0
be a partition of [a, t].
For each s ∈[a, b] and k = 1, 2, let
fk(s) :=
dk if s ̸∈{t2i}n
i=1,
ck if s ∈{t2i}n
i=1.
Clearly, f1, f2 ∈Wp(J). Also, we have

322
6 Nemytskii Operators on Some Function Spaces
f1 −f2∥[p] ≤
(f1 −f2)(a)
 + 2∥f1 −f2∥(p)
= |d1 −d2| + 2(2n)1/p|c1 −c2 −d1 + d2|.
Thus by (6.45), it follows that

n
X
i=1
ψ(c1, t2i) −ψ(c2, t2i) −ψ(d1, t2i−1) + ψ(d2, t2i−1)
q1/q
≤
Nψ(f1) −Nψ(f2)

(q) ≤L
n
|d1 −d2| + 2(2n)1/p|c1 −c2 −d1 + d2|
o
.
In the left side of the preceding inequalities, letting t1 →t2n+1 = t, we get
the bound
n1/qψ(c1, t−) −ψ(c2, t−) −ψ(d1, t−) + ψ(d2, t−)

≤L
n
|d1 −d2| + 2(2n)1/pc1 −c2 −d1 + d2

o
.
For any real numbers v, w, taking c1 := v + w, c2 := v, d1 := w, and d2 := 0,
we then have
ψ(v + w, t−) −ψ(v, t−) −ψ(w, t−) + ψ(0, t−)
 ≤Ln−1/q|w|.
Letting n →∞on the right side, it follows that the left side is zero. This
shows that the function ℓt(u) := ψ(u, t−) −ψ(0, t−), u ∈R, is additive. By
(c), ℓt is continuous, hence linear. Since ψ(1, ·) −ψ(0, ·) ∈Wq(J) there is a
function β ∈Wq(J) such that β(a) = 0 and for t ∈(a, b], ℓt(u) = β(t)u,
u ∈R. Letting α(t) := ψ(0, t−) for t ∈(a, b] and α(a) := ψ(0, a), we have the
representation η(u, s) = α(s) + β(s)u for all u ∈R and s ∈J, proving (b).
To prove (a) and (d), for each u ∈Q (rational), ψ(u, ·) is continuous
except at most for s in a countable set Tu ⊂J. Let T := S
u∈Q Tu. Then T is
a countable subset of J. For each u ∈Q and s ̸∈T , ξ(u, s) = 0. By (c), ξ is
s-uniformly Lipschitz on R, so ξ(·, s) ≡0 for each s ∈J \ T , proving (a). Also
by (c), ξ(u, ·) is regulated for each u ∈R, proving (d).
For (e), since Wq(J) is a Banach algebra by Corollary 3.9 and ∥·∥[q] ≤∥·∥[p]
by Lemma 3.45, for each f, g ∈Wp(J), we have
Nηf −Nηg

[q] ≤∥β(f −g)∥[q] ≤∥β∥[q]∥f −g∥[p].
Thus the Nemytskii operator Nη is globally Lipschitz, and so is the Nemytskii
operator Nξ by linearity. The proof of the theorem is complete.
2
The following example shows that ψ(·, s) can in fact be non-aﬃne for s in
a countable set.
Example 6.71. Let 1 ≤p < ∞, let Q := Q ∩[0, 1] = {r0, r1, . . . } be the set
of rational numbers in [0, 1] with r0 = 0, and for each u ∈R, let

6.6 Higher Order Diﬀerentiability and Analyticity on Wp Spaces
323
ξ(u, s) :=

2−k sin u if s = rk for some k ≥0,
0
if s ∈[0, 1] \ Q.
(6.46)
Then for any partition κ = {ti}n
i=0 of [0, 1] and for any function f ∈Wp[0, 1],
we have
sp(Nξf; κ) ≤2p
n
X
i=0
|ξ(f(ti), ti)|p ≤2p
∞
X
k=0
2−kp| sin f(rk)| ≤4p/(2p −1).
Thus the Nemytskii operator Nξ acts from Wp[0, 1] into itself. To check the
global Lipschitz condition for Nξ, let f, g ∈Wp[0, 1] and again let κ be a
partition of [0, 1]. Then we have
sp(Nξf −Nξg; κ) ≤2p X
rk∈κ
2−kp sin f(rk) −sin g(rk)
p ≤4p∥f −g∥p
sup,
and so ∥Nξf −Nξg∥(p) ≤4∥f −g∥sup. Since for any s ∈[0, 1],
(Nξf −Nξg)(s)
 ≤
 sin f(s) −sin g(s)
 ≤∥f −g∥sup,
it then follows that ∥Nξf−Nξg∥[p] ≤5∥f−g∥[p], that is, a global Lipschitz con-
dition holds for the Nemytskii operator Nξ generated by the function (6.46).
If a function ψ = ψ(u, s) is left- or right-continuous in s then global Lip-
schitz conditions from Wp into Wq for the Nemytskii operator Nψ can be
characterized as follows:
Corollary 6.72. Let 1 ≤p ≤q < ∞, let J := [a, b] with a < b, and let
ψ = ψ(u, s): R × J →R be either left-continuous in s ∈(a, b] or right-
continuous in s ∈[a, b). Assume that the Nemytskii operator Nψ acts from
Wp(J) into Wq(J). There exists a constant L < ∞such that (6.45) holds for
each f, g ∈Wp(J) if and only if there are functions α, β ∈Wq(J) such that
ψ(u, s) = α(s) + β(s)u for all s ∈(a, b] or s ∈[a, b) respectively and u ∈R.
Proof. The “if” part holds because Wq(J) is a Banach algebra by Corollary
3.9 and ∥· ∥[q] ≤∥· ∥[p] by Lemma 3.45. The “only if” part holds in case each
ψ(u, ·) is left-continuous on (a, b] since then in the proof of Theorem 6.70,
ψ(u, s) = η(u, s) for a < s ≤b and we apply part (b) of the theorem. The
other case follows by symmetry.
2
6.6 Higher Order Diﬀerentiability and Analyticity on
Wp Spaces
Let M > 0, W := (−M, M) ⊂R, and let ψ = ψ(u, s) be a real-valued function
deﬁned for (u, s) ∈W × [a, b]. Assuming ψ = ψ(u, s) analytic with respect

324
6 Nemytskii Operators on Some Function Spaces
to u on W for each s, and under further conditions, we will prove that the
Nemytskii operator Nψ is analytic as a mapping acting from W[W]
p
into Wp
with p ≥1 (see Corollary 6.78 below for M = +∞, or Corollary 6.79 for
general M > 0). We notice that analytic Nemytskii operators over Wp do
not reduce to polynomials as do analytic Nemytskii operators over Lp-spaces
(see Proposition 7.59 below). The present situation is more similar to the case
when Nψ acts on a Banach space C of bounded continuous R-valued functions.
By Theorem 6.8 of Appell and Zabrejko [3], for ψ(u, s) ≡F(u), the Nemytskii
operator NF is analytic on the space C if and only if F is analytic from R
into R.
We will give a characterization of the Ck property for the Nemytskii op-
erator from Wp to Wq. Recall that for Banach spaces X, Y and an open
set U ⊂X, a mapping F from U into Y is called Ck on U if the Fr´echet
derivatives of F through order k all exist on U and are continuous. Before we
state the characterization, we will ﬁnd the norm of a k-linear multiplication
operator (Deﬁnition 6.6).
Lemma 6.73. Let 1 ≤p ≤q < ∞, let J be a nondegenerate interval,
and let k be a positive integer. Then h ∈Wq(J) if and only if the k-linear
multiplication operator M k[h] acts and is bounded from the Cartesian prod-
uct Wp(J) × · · · × Wp(J) (k times) into Wq(J). Moreover, in either case,
∥M k[h]∥= ∥h∥[q].
Proof. Let h ∈Wq(J). By the Banach algebra property of Wq(J) (Corollary
3.9) and since ∥· ∥[q] ≤∥· ∥[p] (Lemma 3.45), for the norm on L(kWp, Wq)
deﬁned by (5.4), we have
M k[h]
 = sup
nhg1 · · · gk

[q] : ∥gi∥[p] ≤1, i = 1, . . . , k
o
≤∥h∥q],
and so M k[h] is a bounded operator as stated. The converse implication and
the equality of the norms follow by taking M k[h](g1, . . . , gk) with g1 = · · · =
gk = 1(·) ∈Wp(J).
2
The special case p = q of the preceding lemma is also a special case of
Lemma 5.13 on Banach algebras.
Theorem 6.74. Let 1 ≤p ≤q < ∞, J := [a, b] with a < b and ψ: R × J →
R. Then for k = 1, 2, . . ., the following two statements are equivalent:
(a) the Nemytskii operator Nψ is a Ck mapping from Wp(J) into Wq(J);
(b) the function ψ is u-diﬀerentiable of order k on R × J and each Nemytskii
operator Nψ(j)
u
for j = 0, 1, . . . , k is a continuous mapping from Wp(J)
into Wq(J).
When (a) or (b) holds, for each s ∈J, u 7→ψ(u, s) is a Ck function on R.

6.6 Higher Order Diﬀerentiability and Analyticity on Wp Spaces
325
Remark 6.75. Let ψ(u, s) ≡η(u, s) + ξ(s). Then for any k ≥1, ψ(k)
u (u, s) =
η(k)
u (u, s) if either side exists. But it can happen that the Nemytskii operator
Nη is a Ck mapping from Wp(J) into Wq(J) while the Nemytskii operator
Nψ does not act from Wp(J) into Wq(J), if ξ(·) ̸∈Wq(J). Thus, in (b) of
Theorem 6.74, it is not suﬃcient to take j = k (e.g. for k = 1).
Proof. Let k be a positive integer and suppose that (a) holds. Since Nψ is
Fr´echet diﬀerentiable of order k at each constant function, by Proposition 6.9
with X = Y = R, S = J, G = Wp(J), and H = Wq(J), ψ is u-diﬀerentiable
of order k everywhere on R × J, and by (6.6), for each G ∈Wp(J), the kth
diﬀerential dkNψ(G) is the k-linear multiplication operator M k[Nψ(k)
u (G)] in
L(kWp, Wq). Thus by Lemma 6.73, the Nemytskii operator Nψ(k)
u
acts from
Wp(J) into Wq(J). Also for any f1, f2 ∈Wp(J),
dkNψf1 −dkNψf2 = M k
Nψ(k)
u f1 −Nψ(k)
u f2

.
Thus by the second part of Lemma 6.73, we have
dkNψf1 −dkNψf2
 =
Nψ(k)
u f1 −Nψ(k)
u f2

[q],
(6.47)
proving continuity of Nψ(k)
u , and so (b) holds for j = k. Also (b) must hold with
k replaced by j for j = 0, . . . , k, since by the deﬁnition of the Ck property,
Nψ is a Cj mapping from Wp(J) into Wq(J).
The converse implication will be proved by induction. Suppose that (b)
holds with k = 1. For any u, v ∈R and s ∈J, we have
ψ(1)
u (u, s) −ψ(1)
u (v, s)
 ≤
Nψ(1)
u (u1(·)) −Nψ(1)
u (v1(·))

sup.
(6.48)
Since Nψ(1)
u
is a continuous mapping and ∥u1(·) −v1(·)∥[p] = |u −v|, the
function ψ(1)
u (·, s) is continuous for each s ∈J. Let G ∈Wp(J). For φ: R ×
J →R, f : J →R, and s ∈J, let
∆φ(f; s) := φ((G + f)(s), s) −φ(G(s), s) = [Nφ(G + f) −Nφ(G)](s). (6.49)
Then for a ≤s < t ≤b and g ∈Wp(J), by Lemma 5.40, we have
T (g; s, t)
:=
h
∆ψ(g; t) −ψ(1)
u (G(t), t)g(t)
i
−
h
∆ψ(g; s) −ψ(1)
u (G(s), s)g(s)
i
= g(t)
Z 1
0
∆ψ(1)
u (rg; t) dr −g(s)
Z 1
0
∆ψ(1)
u (rg; s) dr
(6.50)
= [g(t)−g(s)]
Z 1
0
∆ψ(1)
u (rg; t) dr+g(s)
Z 1
0
h
∆ψ(1)
u (rg; t)−∆ψ(1)
u (rg; s)
i
dr
=: T1(g; s, t) + T2(g; s, t).

326
6 Nemytskii Operators on Some Function Spaces
Let κ = {xi}n
i=0 be a partition of J. Since p ≤q, then we have

n
X
i=1
T1(g; xi−1, xi)
q1/q
≤

n
X
i=1
T1(g; xi−1, xi)
p1/p
≤∥g∥(p) sup
0≤r≤1
∆ψ(1)
u (rg; ·)

sup.
Also by Jensen’s inequality for integrals, we have

n
X
i=1
T2(g; xi−1, xi)
q1/q
≤∥g∥sup
 Z 1
0
n
X
i=1
∆ψ(1)
u (rg; xi) −∆ψ(1)
u (rg; xi−1)

q
dr
1/q
≤∥g∥sup sup
0≤r≤1
∆ψ(1)
u (rg, ·)

(q).
Thus by Minkowski’s inequality (1.5), it follows that

n
X
i=1
T (g; xi−1, xi)
q1/q
≤∥g∥(p) sup
0≤r≤1
∆ψ(1)
u (rg; ·)

sup + ∥g∥sup sup
0≤r≤1
∆ψ(1)
u (rg; ·)

(q).
Nψ acts from Wp(J) into Wq(J) by (b) for j = 0. Recalling the deﬁnition of
T , since κ is an arbitrary partition, the right side of the preceding inequality
gives a bound for ∥Nψ(G + g) −Nψ(G) −Nψ(1)
u (G)g∥(q). To bound the sup
norm, again using Lemma 5.40, for each s ∈J, we get as in (6.50)
Nψ(G + g)(s) −Nψ(G)(s) −Nψ(1)
u (G)(s)g(s)

= |g(s)|

Z 1
0
∆ψ(1)
u (rg; s) dr
 ≤∥g∥sup sup
0≤r≤1
∆ψ(1)
u (rg; ·)

sup.
It then follows that
Nψ(G + g) −Nψ(G) −Nψ(1)
u (G)g

[q]
≤∥g∥(p) sup
0≤r≤1
∆ψ(1)
u (rg; ·)

sup
+∥g∥sup
h
sup
0≤r≤1
∆ψ(1)
u (rg; ·)

(q) + sup
0≤r≤1
∆ψ(1)
u (rg; ·)

sup
i
≤2∥g∥[p] sup
0≤r≤1
Nψ(1)
u (G + rg) −Nψ(1)
u (G)

[q].
The right side is o(∥g∥[p]) as ∥g∥[p] →0 since Nψ(1)
u
is continuous at G by
assumption. Also by assumption, Nψ(1)
u (G) ∈Wq(J), so the linear multipli-
cation operator M1,ψ,G := M[Nψ(1)
u (G)] is bounded from Wp(J) into Wq(J)

6.6 Higher Order Diﬀerentiability and Analyticity on Wp Spaces
327
by Lemma 6.73 with k = 1. Thus for any G ∈Wp(J), Nψ is diﬀerentiable
at G from Wp(J) to Wq(J) with derivative equal to M1,ψ,G. Also since the
Nemytskii operator Nψ(1)
u
is continuous, the Nemytskii operator Nψ is a C1
mapping by (6.47) with k = 1, proving (a) with k = 1.
Suppose that (b) implies (a) for k = 1, . . . , n for some n ≥1 and (b)
holds for k = n + 1. Then Nψ is a Cn mapping from Wp(J) into Wq(J)
since (b) implies (a) with k = n. Also for each G ∈Wp(J), the nth diﬀerential
dnNψ(G) ∈L(nWp, Wq) is the n-linear multiplication operator M n[Nψ(n)
u (G)]
with Nψ(n)
u (G) ∈Wq(J) by Proposition 6.9. By the implication (b) ⇒(a) with
k = 1 already proved and by Proposition 6.9 with k = 1, both applied to ψ(n)
u ,
for each G ∈Wp(J), Nψ(n)
u : Wp(J) →Wq(J) is diﬀerentiable at G and its
derivative is M[Nψ(n+1)
u
(G)], with Nψ(n+1)
u
(G) ∈Wq(J). By Lemma 6.73 with
k = n, we then have
dnNψ(G + g) −dnNψ(G) −M n[Nψ(n+1)
u
(G)g]

L(nWp,Wq)
=
Nψ(n)
u (G + g) −Nψ(n)
u (G) −Nψ(n+1)
u
(G)g

[q].
These norms are o(∥g∥[p]) as ∥g∥[p] →0 by the facts for k = 1 just men-
tioned, and so dnNψ : Wp →L(nWp, Wq) is diﬀerentiable at G ∈Wp(J)
with the derivative DdnNψ(G)g = M n[Nψ(n+1)
u
(G)g], g ∈Wp(J). For each
G ∈Wp(J), we have by the implication (b) ⇒(a) in Proposition 5.25 applied
to L = M n+1[Nψ(n+1)
u
(G)] that Nψ is diﬀerentiable of order n + 1 at G and
dn+1Nψ(G) = M n+1[Nψ(n+1)
u
(G)]. Since Nψ(n+1)
u
is continuous, it follows that
Nψ is a Cn+1 mapping from Wp(J) into Wq(J), proving (a) with k = n+1. By
induction, (b) ⇒(a) holds for each k = 1, 2, . . .. By (6.48) with ψ(k)
u
in place
of ψ(1)
u
and since Nψ(k)
u
is continuous by (b), it follows that u 7→ψ(k)
u (u, s) is
continuous for each s, completing the proof of the theorem.
2
The next statement is in preparation for giving suﬃcient conditions on ψ
for higher order diﬀerentiability of the Nemytskii operator Nψ. Recall Deﬁni-
tion 6.61 of the class HWn+α,q.
Lemma 6.76. Let 1 ≤p ≤q ≤r < ∞, α := p/q, J := [a, b] with a < b,
and let n be a positive integer. For Banach spaces X, Y , let B be a convex
bounded set in X containing 0, let V be an open set in X including B, and
let φ: V × J →Y be in the class HWn+α,q(B × J; Y ). Then for each k ∈
{1, . . . , n}, there exists a ﬁnite constant Ck = Ck(φ, B, p, r, α) such that the
bound
φ(k−1)
u
(g(·), ·) −φ(k−1)
u
(0, ·) −φ(k)
u (0, ·)(g(·), . . . )

[r] ≤∥g∥[p]ǫk
(6.51)
with

328
6 Nemytskii Operators on Some Function Spaces
ǫk =
(
Ck∥g∥1−(q/r)
sup
, if k ∈{1, . . ., n −1} and n > 1,
Cn∥g∥α−(p/r)
sup
, if k = n,
holds for each g ∈Wp(J; X) such that ∥g∥[p] ≤1 and ran (g) ⊂B.
Proof. Let g ∈Wp(J; X) with ran (g) ⊂B. For k = 1, . . . , n, let Rk(g) =
Rk(g; ·) be the function on J with values in L(k−1X, Y ) for each s ∈J deﬁned
by
Rk(g; s) := φ(k−1)
u
(g(s), s) −φ(k−1)
u
(0, s) −φ(k)
u (0, s)(g(s), . . . ).
(6.52)
Let hk(s, t) := φ(k)
u (tg(s), s)(g(s), . . . ) ∈L(k−1X, Y ) for t ∈[0, 1] and s ∈J.
By Lemma 5.40, it follows that
Rk(g; s) =
Z 1
0
h
hk(s, t) −hk(s, 0)
i
dt =: Ik(g)(s)
(6.53)
for s ∈J, since Dφ(k−1)
u
(0, s)(g(s)) = φ(k)
u (0, s)(g(s), . . . ) by Proposition 5.25.
To bound the r-variation seminorm of Ik(g) = Ik(g)(·), we will use the bounds
for the γ-variation seminorm given by Theorem 3.111 of the integral transform
K(s) = F(hk(s, ·) −hk(s, 0), d ¯G) = Ik(g)(s), s ∈J, where ¯G(t) ≡t, t ∈[0, 1].
To this aim we will bound Aβ,sup(hk) = Aβ,sup(hk; J ×[0, 1]) and Bsup,¯p(hk) =
Bsup,¯p(hk; J × [0, 1]) deﬁned by (3.165) and (3.166), respectively, for β = q
and for suitable values of ¯p ≥1.
If n > 1, then by Lemma 6.62, for each k = 1, . . . , n−1, φ(k)
u
∈HW1,q(B×
J; L(kX, Y )), and so
H1(φ(k)
u ) < ∞
and
W1,q(φ(k)
u , K) < ∞
(6.54)
for each 0 ≤K < ∞, according to Deﬁnitions 6.42 and 6.47. Since B is convex
and contains 0, tg(s) ∈B for each t ∈[0, 1] and s ∈J. Then for any partition
λ = {tj}m
j=0 of [0, 1] and s ∈J, we have
s1(hk(s, ·); λ) ≤∥g∥sup
m
X
j=1
φ(k)
u (tjg(s), s) −φ(k)
u (tj−1g(s), s)

≤H1(φ(k)
u )∥g∥2
sup,
which gives a bound for Bsup,1(hk). By Lemma 3.45, for each s ∈J,
∥hk(s, ·)∥(¯p) ≤∥hk(s, ·)∥(1) ≤Bsup,1(hk), and so we have
Bsup,¯p(hk) ≤Bsup,1(hk) ≤H1(φ(k)
u )∥g∥2
sup
(6.55)
for each k = 1, . . . , n −1 and ¯p ≥1. For n ≥1 and k = n, since φ(n)
u
∈
HWα,q(B × J; L(nX; Y )) by deﬁnition (6.35), we have
Hα(φ(n)
u ) < ∞
and
Wα,q(φ(n)
u , K) < ∞
(6.56)

6.6 Higher Order Diﬀerentiability and Analyticity on Wp Spaces
329
for each 0 ≤K < ∞, according to Deﬁnition 6.47 again. Similarly, for any
partition λ of [0, 1] and s ∈J, we get the bound
sq/p(hn(s, ·); λ) ≤(Hα(φ(n)
u ))q/p∥g∥(q/p)+1
sup
since p = αq, and so the bound
Bsup,q/p(hn) ≤Hα(φ(n)
u )∥g∥1+α
sup
(6.57)
holds. Next we will apply the second property in (6.54) with K = ∥g∥[q]. For
any partition κ = {si}n
i=0 of J and t ∈[0, 1], using the Minkowski inequality
(1.5) and (6.31), it follows that for n > 1 and k = 1, . . . , n −1,
sq(hk(·, t); κ)1/q
≤

n
X
i=1
[φ(k)
u (tg(si), si) −φ(k)
u (tg(si−1), si)](g(si), . . . )

q1/q
+

n
X
i=1
[φ(k)
u (tg(si−1), si) −φ(k)
u (tg(si−1), si−1)](g(si), . . . )

q1/q
+

n
X
i=1
φ(k)
u (tg(si−1), si−1)(g(si) −g(si−1), . . . )

q1/q
≤

H1(φ(k)
u )∥g∥(q) + W1,q(φ(k)
u , ∥g∥[q])

∥g∥sup + ∥φ(k)
u ∥B×J,sup∥g∥(q),
since wq({tg(si−1)}n
i=1) ≤∥g∥[q] for each t ∈[0, 1]. For each k = 1, . . . , n −1,
letting Dk := H1(φ(k)
u ) + W1,q(φ(k)
u , 1) + ∥φ(k)
u ∥B×J,sup, the bound
Aq,sup(hk) ≤Dk∥g∥[q]
(6.58)
holds if ∥g∥[q] ≤1. If n ≥1 and k = n then similarly to the preceding step,
except that now (6.56) with K = ∥g∥[p] is used, we have
sq(hn(·, t); κ)1/q
≤

Hα(φ(n)
u )∥g∥α
(p) + Wα,q(φ(n)
u , ∥g∥[p])

∥g∥sup + ∥φ(n)
u ∥B×J,sup∥g∥(q).
Thus letting Dn := Hα(φ(n)
u ) + Wα,q(φ(n)
u , 1) + ∥φ(n)
u ∥B×J,sup, the bound
Aq,sup(hn) ≤Dn∥g∥[q]
(6.59)
holds if ∥g∥[p] ≤1. Denote by ¯p and ¯q respectively the parameters called p and
q in Theorem 3.111. If n > 1 and k = 1, . . . , n−1, then apply the theorem with
¯p = ¯q := 2 −q/r ∈[1, 2) and β := q. Thus 1/γ = (¯p/β)(1/¯p + 1/¯q −1) = 1/r
and ∥¯G∥[0,1],(¯q) ≤∥¯G∥[0,1],(1) = 1 by Lemma 3.45. Since ¯p ≥1 and β/γ = q/r,
by (3.167), (6.55), and (6.58), we have
Ik(g)

(r) ≤CAq,sup(hk)q/rBsup,1(hk)1−(q/r)
≤Ek(φ, B, p, q, r)∥g∥1−(q/r)
sup
∥g∥[q]
(6.60)

330
6 Nemytskii Operators on Some Function Spaces
if ∥g∥[q] ≤1, where Ek(φ, B, p, q, r) := CDq/r
k
H1(φ(k)
u )1−(q/r). If k = n then
apply Theorem 3.111 with ¯q := 1/(1 + p(1/r −1/q)), ¯p := q/p, and β := q.
Thus 1/¯p + 1/¯q = 1 + p/r > 1 and 1/γ = (¯p/β)(1/¯p + 1/¯q −1) = 1/r. Since
¯p ≥1, ¯q ≥1, and β/γ = q/r, by (3.167), (6.57), and (6.59), we have
In(g)

(r) ≤CAq,sup(hn)q/rBsup,q/p(hn)1−(q/r)
≤En(φ, B, p, q, r)∥g∥(p/q)−(p/r)
sup
∥g∥[q]
(6.61)
if ∥g∥[p] ≤1, where En(φ, B, p, q, r) := CDq/r
n Hα(φ(n)
u )1−(q/r). To bound the
supremum norm of Ik(g) for k ∈{1, . . ., n −1} with n > 1, since φ(k)
u
is
s-uniformly Lipschitz (the ﬁrst property in (6.54)), it follows that
∥Ik(g)(s)∥≤∥g∥sup
Z 1
0
φ(k)
u (tg(s), s) −φ(k)
u (0, s)
 dt ≤H1(φ(k)
u )∥g∥2
sup
(6.62)
for each s ∈J. For k = n, since φ(n)
u
is s-uniformly α-H¨older (the ﬁrst property
in (6.56)) with α = p/q, we have
∥In(g)(s)∥≤∥g∥sup
Z 1
0
φ(n)
u (tg(s), s) −φ(n)
u (0, s)
 dt ≤Hα(φ(n)
u )∥g∥1+α
sup
(6.63)
for each s ∈J. Let M := sup{∥x∥: x ∈B} < ∞. Then for k ∈{1, . . . , n −1}
with n > 1, using (6.60) and (6.62), it follows that
∥Ik(g)∥[r] = ∥Ik(g)∥sup + ∥Ik(g)∥(r)
≤

H1(φ(k)
u )M q/r + Ek(φ, B, p, q, r)

∥g∥1−(q/r)
sup
∥g∥[q]
since ∥g∥sup ≤M. Similarly, using (6.61) and (6.63), it follows that
∥In(g)∥[r] ≤

Hp/q(φ(n)
u )M p/r + En(φ, B, p, q, r)

∥g∥(p/q)−(p/r)
sup
∥g∥[q]
since ∥g∥sup ≤M. This together with (6.52) and (6.53) implies (6.51) since
∥g∥[q] ≤∥g∥[p] by Lemma 3.45, completing the proof of Lemma 6.76.
2
Recall that for a nonempty open set U ⊂X, W[U]
p (J; X) is the set of all
g ∈Wp(J; X) such that the closure of the range ran (g) is included in U.
Theorem 6.77. Let 0 < α ≤1 ≤p < αr < ∞and J := [a, b] with a < b. For
Banach spaces X, Y , let U be an open subset of X with 0 ∈U and let n be a
positive integer. Let ψ ∈HWloc
n+α,p/α(U×J; Y ) and G ∈W[U]
p (J; X). Then the
Nemytskii operator Nψ acts from W[U]
p (J; X) into Wp(J; Y ) and is Fr´echet
diﬀerentiable of order n at G as a mapping with values in Wr(J; Y ). Moreover,
there exist constants C = C(ψ, G, U, p, r, α) < +∞and δ = δ(G, U) > 0 such
that for the remainder in the diﬀerentiation of dn−1Nψ,

6.6 Higher Order Diﬀerentiability and Analyticity on Wp Spaces
331
Remdn−1Nψ(G, g)
 ≤C∥g∥1+α−(p/r)
[p]
(6.64)
for each g ∈Wp(J; X) with ∥g∥[p] ≤δ.
Proof. Let q := p/α < r. By Deﬁnition 6.61, ψ ∈HWn+α,q(Bm × J; Y ) for
each m > m0. Thus ψ(n)
u
∈HWloc
α,q(U × J; L(nX, Y )) and by Lemma 6.62,
ψ(k)
u
∈HWloc
1,q (U × J; L(kX, Y )) for k = 0, . . . , n −1, as deﬁned in Deﬁnition
6.51. By Proposition 6.54(a), for each h ∈W[U]
p (J; X),
Nψ(n)
u (h) ∈Wq(J; L(nX, Y ))
and
Nψ(k)
u (h) ∈Wp(J; L(kX, Y ))
(6.65)
for k = 0, 1, . . . , n −1. In particular, it then follows that Nψ acts from
W[U]
p (J; X) into Wp(J; Y ). To prove higher order diﬀerentiability of Nψ we
will use Proposition 5.25 with k-linear mappings Lk,ψ deﬁned as follows. For
a nonempty open set V ⊂X, φ ∈HWloc
n+α,q(V × J; Y ), k ∈{1, . . ., n},
h ∈W[V ]
p
(J; X), and g1, . . . , gk ∈Wp(J; X), let

Lk,φ(h)(g1, . . . , gk)

(s) := φ(k)
u (h(s), s)(g1(s), . . . , gk(s)) ∈Y
(6.66)
for s ∈J. Then Lk,ψ(h) is a k-linear mapping from the k-fold product
Wp(J; X) × · · · × Wp(J; X) into Y -valued functions on J. (The Wp property
has not yet been used.) For each k ∈{1, . . ., n}, using Corollary 5.24 with
F = Nψ(k)
u (h) and Φ(u) ≡ur, u ≥0, (6.65), and since ∥· ∥[r] ≤∥· ∥[q] ≤∥· ∥[p]
by Lemma 3.45, it follows that
∥Lk,ψ(h)(g1, . . . , gk)∥[r] ≤
Nψ(k)
u (h)

[r]∥g1∥[p] · · · ∥gk∥[p] < ∞.
Thus for each k ∈{1, . . ., n} and h ∈W[U]
p (J; X), Lk,ψ(h) is in L(kWp, Wr).
Now the diﬀerentiability of order n will be proved by induction. By
Propositions 6.20(a) and 6.3, ran (G) ⊂Bm(U) for some m ≥1. Let
δ := δ(G, U) := 1/(4m) and let W := {g ∈Wp(J; X): ∥g∥[p] < 2δ}.
Then G + W ⊂W[U]
p (J; X). Let d0Nψ := Nψ, L0,ψ(h) := Nψ(h), and
L(0Wp, Wr) := Wr. Suppose that for some k ∈{1, . . . , n}, the (k −1)st dif-
ferential dk−1Nψ is deﬁned on G+W. Then dk−1Nψ(h) = Lk−1,ψ(h)(·, · · · , ·)
for all h ∈G + W by deﬁnition if k = 1 and by Proposition 6.9 if k > 1.
Let V := B(0, 2δ) ⊂X and φ(u, s) := ψ(G(s) + u, s) for (u, s) ∈V × J.
By the chain rule (Theorem 5.1) we have φ(k)
u (u, s) = ψ(k)
u (G(s) + u, s) for
k = 1, . . . , n, s ∈J and u ∈V . For g ∈Wp(J; X), let
Dk(g) :=

L1,ψ(G)(g)
if k = 1,
Lk,ψ(G)(g, ·, . . . , ·) if k > 1, =

L1,φ(0)(g)
if k = 1,
Lk,φ(0)(g, ·, . . . , ·) if k > 1.
We apply Lemma 6.76 to φ: V × J →Y with B := {x: ∥x∥≤δ}. Let
g ∈Wp(J; X) be such that ∥g∥[p] ≤δ. If k = 1 then by (6.51) we have

332
6 Nemytskii Operators on Some Function Spaces
dk−1Nψ(G + g) −dk−1Nψ(G) −Dk(g)
 ≤∥g∥[p]ǫ1,
and the right side is of order o(∥g∥[p]) as ∥g∥[p] →0 since r > q. If k ≥2 then
using Corollary 5.24 with F = Rk(g) deﬁned by (6.52), and Φ(u) ≡ur, u ≥0,
we have
dk−1Nψ(G + g) −dk−1Nψ(G) −Dk(g)

L(k−1Wp,Wr)
=
Lk−1,φ(g) −Lk−1,φ(0) −Dk(g)

L(k−1Wp,Wr)
≤sup

∥Rk(g)∥[r]∥g1∥[r] · · · ∥gk−1∥[r]: ∥g1∥[p] ≤1, . . . , ∥gk−1∥[p] ≤1
	
≤∥Rk(g)∥[r],
since ∥· ∥(r) ≤∥· ∥(p) by Lemma 3.45. By (6.51), the right side is of order
o(∥g∥[p]) as ∥g∥[p] →0 since r > q. Therefore dk−1Nψ is diﬀerentiable at
G with derivative D(dk−1Nψ(h))

h=Gg = Dk(g), and so Nψ is Fr´echet dif-
ferentiable of order k at G by deﬁnition if k = 1 and by Proposition 5.25
(b) ⇒(a) with L = Lk,ψ(G) if k > 1. By induction, Nψ is diﬀerentiable of
order n at G as a mapping with values in Wr(J; Y ) and (6.64) holds with
C(ψ, G, U, p, r, α) := Cn(φ, B, p, r, α) by (6.51). The proof of Theorem 6.77 is
complete.
2
Next we apply results from the end of Section 6.3, concerning analyticity
of Nemytskii operators acting from a real Banach algebra BR to itself, where
B is a self-adjoint complex Banach algebra of functions and BR is the set of
all real-valued elements of B. Here we consider the case B = Wp(J; C) with
1 ≤p < ∞and J = [a, b], and so BR = Wp(J; R) ≡Wp(J). By Remark 6.27, B
is a unital Banach algebra of C-valued functions on J such that ran (f) = σ(f)
for each f ∈B. Then the following statement is a special case of Proposition
6.31.
Corollary 6.78. Let 1 ≤p < ∞, J := [a, b] with a < b, and let V be a
connected open set in Wp(J). Let ψ: R × J →R be u-diﬀerentiable of order
n everywhere on R × J for each n ≥1. Let the Nemytskii operator Nψ act
from V into Wp(J), and let G ∈V . Then Nψ on V has a Taylor expansion
around G if and only if
(a) there are c ≥0 and r > 0 such that for each k = 1, 2, . . . ,
sup

|ψ(k)
u (G(x) + t, x)|: x ∈J, t ∈R, |t| ≤r
	
≤ckk!;
(b) Nψ(k)
u (G) ∈Wp(J) for all k ≥1, and supk≥1
Nψ(k)
u (G)/k!
1/k
[p] < ∞.
The next statement is a special case of Theorem 6.32.
Corollary 6.79. Let 1 ≤p < ∞, J := [a, b] with a < b, and W := (−M, M)
for some 0 < M ≤∞. Let ψ: W × J →R be u-diﬀerentiable of order n

6.7 Notes
333
everywhere on W ×J for each n ≥1, and suppose that the Nemytskii operator
Nψ acts from W[W]
p
(J) into Wp(J). Then Nψ is analytic on W[W]
p
(J) if and
only if
(a) for each closed interval B ⊂W, there is a c ≥0 such that for k = 1, 2, . . .,
ψ(k)
u

B×J,sup ≤ckk!;
(b) statement (b) of Corollary 6.78 holds for each G ∈W[W]
p
(J).
The last statement in this section is a special case of Corollary 6.30.
Corollary 6.80. Let F : R →R and 1 ≤p < ∞. Then the autonomous
Nemytskii operator NF, as a mapping from Wp into Wp, is analytic on Wp if
and only if F is analytic on R.
6.7 Notes
We are aware of little previous literature on the speciﬁc topics of this chapter,
e.g. higher order diﬀerentiability of Nemytskii operators, and such operators
on Wp spaces, except for the few references mentioned in the following notes.
There is much more literature about Nemytskii operators on other domain
spaces, e.g. Lp spaces; see Chapter 7. The notes to Chapter 7 mention several
other classes of domain spaces.
Notes on Section 6.3. Dales [36, §4.1] treats natural Banach algebras. The-
orem 6.21 is Proposition 4.1.5 of Dales [36]; his Notes do not say who ﬁrst
proved it.
Notes on Section 6.5. Theorem 6.35 essentially is the main result of Ciem-
noczo lowski and Orlicz [33]. Proposition 6.57 seems to contradict Appell and
Zabrejko [3, p. 174, Theorem 6.12]. Theorem 6.70 with q = p = 1 is due to
Matkowski and Mi´s [161].


7
Nemytskii Operators on Lp Spaces
In this chapter, the Nemytskii operator Nψ is considered between the spaces
G = Ls and H = Lp with s, p ≥1. Thus, it will be considered as an operator
between spaces of equivalence classes of measurable functions on a measure
space.
Throughout this chapter (Ω, S, µ) is a measure space with µ(Ω) > 0. As
before, “µ-almost everywhere” is abbreviated “a.e. (µ).” For 1 ≤p ≤∞,
Lp
:=
Lp(Ω, S, µ)
:=
Lp(Ω, S, µ; R) denotes the set of all real-valued
functions f on Ωsuch that f is µ-measurable, that is, measurable for the
completion of µ, and ∥f∥p < ∞where for 1 ≤p < ∞,
∥f∥p :=
 Z f(ω)
p dµ(ω)
1/p
and
∥f∥∞:= ess.sup |f|
(cf. (1.22) and (1.23) with ∥f∥R := |f|). Lp := Lp(Ω, S, µ) := Lp(Ω, S, µ; R)
with norm ∥· ∥p is the Banach space of all equivalence classes of functions in
Lp(Ω, S, µ; R) for equality a.e. (µ).
In this chapter, the set S in the deﬁnition (6.1) of the Nemytskii operator
Nψ will be Ω. Also in this chapter, U = X = Y = R, and so ψ is a function
(u, ω) 7→ψ(u, ω) from R × Ωinto R.
7.1 Acting, Boundedness, and Continuity Conditions
Given a function ψ from R × Ωinto R, for the Nemytskii operator Nψ to act
from Ls into Lp, it ﬁrst of all must preserve measurability of functions.
Preserving measurability
A function ψ: R × Ω→R will be called bimeasurable or S-bimeasurable if
for each measurable function f : Ω→R, Nψ(f) is measurable. Next some
properties of ψ are stated and shown to imply its bimeasurability.
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_7, 
335

336
7 Nemytskii Operators on Lp Spaces
Deﬁnition 7.1. Let A ∈S. Then A will be called hereditarily S-measurable,
or A ∈Sh, if for every C ⊂A, C ∈S.
Remark 7.2. Any subset of a set in Sh is also in Sh. So is any countable
union of sets in Sh. If ω ∈Ωand the singleton {ω} is in S then {ω} ∈Sh.
If (Ω, S, µ) is complete and µ(A) = 0 then A ∈Sh. Thus if both (Ω, S, µ)
is complete and all singletons are in S, then A ∈Sh if A = B ∪C where
µ(B) = 0 and C is countable. If µ is a ﬁnite or σ-ﬁnite measure on Ω= [0, 1]
then under some set-theoretic assumptions there are no sets in Sh other than
such B ∪C [53, Appendix C].
The following condition on a function ψ will be shown to be suﬃcient for
its bimeasurability. It says that for some N ∈Sh, ψ restricted to (u, ω) such
that ω ̸∈N is jointly measurable.
Deﬁnition 7.3. Let B be the Borel σ-algebra on R. A function ψ = ψ(u, ω),
(u, ω) ∈R × Ω, is called a Shragin function or is said to satisfy Shragin’s
condition if there is a set N ∈Sh such that for any A ∈B,
ψ−1(A) \ (R × N) = {(u, ω) ∈R × N c : ψ(u, ω) ∈A} ∈B ⊗S,
(7.1)
where B ⊗S is the product σ-algebra on R × Ω. If in the Shragin condition,
in addition, µ(N) = 0, then the strong or µ-strong Shragin condition will be
said to hold and a ψ will be called a strong or µ-strong Shragin function.
If (Ω, S, µ) is complete, then a function ψ: R×Ω→R is µ-strong Shragin
if and only if (7.1) holds for some µ-null set N ⊂Ω.
Proposition 7.4. A Shragin function on R × Ωis bimeasurable.
Proof. Let ψ be a Shragin function on R × Ω. Let f : Ω→R be measurable,
A ∈B, and let N be a hereditarily S-measurable set for which Shragin’s con-
dition (7.1) holds. The function ˆf : Ω→R × Ωdeﬁned by ˆf(ω) := (f(ω), ω)
is measurable for the σ-algebra B ⊗S on R × Ω. Since ω ̸∈N if and only if
ˆf(ω) ̸∈R × N, we have that
{ω ∈Ω\ N : ψ(f(ω), ω) ∈A} = {ω ∈Ω: ˆf(ω) ∈ψ−1(A) \ (R × N)} ∈S
by Shragin’s condition. Also, {ω ∈N : ψ(f(ω), ω) ∈A} ∈S since N ∈Sh.
The proof of the proposition is complete.
2
Deﬁnition 7.5. For a measurable space (X, S), a set A ⊂X is called univer-
sally measurable (u.m.) iﬀit is measurable for the completion of every ﬁnite
measure µ on (X, S). If (Y, B) is another measurable space, then a function
f from X into Y is called universally measurable (u.m.) iﬀf −1(B) is u.m.
for all B ∈B. If X and Y are separable metric spaces, then unless otherwise
speciﬁed, S and B will be taken as the Borel σ-algebras in the respective
spaces.

7.1 Acting, Boundedness, and Continuity Conditions
337
The collection US of all u.m. sets for S is easily seen to form a σ-algebra.
Note that if (Ω, S) is a measurable space and (Ω, S, µ) is complete for some
ﬁnite measure µ, then US = S. Also, if (Ω, S, µ) is a complete, σ-ﬁnite measure
space, then there is a ﬁnite measure ν on S equivalent to µ, so US = S in
this case also. If X is any uncountable complete separable metric space, e.g.
X = R, and S is the Borel σ-algebra, then there exist u.m. sets which are not
Borel measurable, e.g. [53, §13.2].
The space of all Shragin functions on R × Ωis linear, as is the space of all
strong Shragin functions.
Proposition 7.6. If (Ω, S, µ) is complete and σ-ﬁnite and if ψ is a µ-strong
Shragin function on R × Ω, then the following are equivalent:
(a) Nψf = 0 a.e. (µ) for all µ-measurable functions f : Ω→R;
(b) for some p, 1 ≤p ≤∞, and some r > 0, Nψf = 0 a.e. (µ) for all
f ∈Lp(Ω, S, µ) such that ∥f∥p < r;
(c) for µ-almost all ω ∈Ω, ψ(u, ω) = 0 for all u ∈R.
Proof. Implications (c) ⇒(a) ⇒(b) are immediate. Suppose that (b) holds
for some p ∈[1, ∞] and let D := {(u, ω): ψ(u, ω) ̸= 0}. Since ψ is a strong
Shragin function there is a µ-null set N ⊂Ωsuch that D \ (R × N) ∈B ⊗S.
According to Sainte-Beuve’s selection theorem (e.g. [52, Theorem 5.3.2] for
F := Y := R with Borel σ-algebra and T the identity R →R, X = ψ restricted
to R × N c), the projection E := {ω: (u, ω) ∈D \ (R × N) for some u ∈R} is
(universally) measurable in Ωand there is a (universally) measurable function
η: E →R such that (η(ω), ω) ∈D \ (R × N) for all ω ∈E. If µ(E) > 0 then
by σ-ﬁniteness there is a C ∈S with C ⊂E, 0 < µ(C) < ∞, |η| ≤M on C
for some M < ∞, and ∥η1C∥p < r. Let ηC := η1C. Thus ηC ∈Lp(Ω, S, µ)
with norm less than r, and so NψηC = 0 a.e. (µ). It then follows that C is a
µ-null set, a contradiction, so µ(E) = 0. For ω ∈Ω\ (N ∪E), ψ(u, ω) = 0 for
all u ∈R, proving (c). The proof of the proposition is complete.
2
Deﬁnition 7.7. For two bimeasurable functions ψ and φ on R × Ω, we write
ψ ⋍φ or equivalently ψ ⋍µ φ if Nψf = Nφf a.e. (µ) for each measurable
function f. For ψ again bimeasurable and for a Borel measurable function
h: Ω→R, we write ψ ⋍h if ψ ⋍ˆh for ˆh(u, ω) := h(ω), (u, ω) ∈R × Ω.
Remark 7.8. If ψ and φ are strong Shragin functions, then so is ψ−φ, and by
Proposition 7.6, ψ ⋍φ if and only if for µ-almost all ω ∈Ω, ψ(u, ω) = φ(u, ω)
for all u ∈R.
Acting and boundedness in the autonomous case
Let F be a function from R into R and let NF be the autonomous Nemytskii
operator deﬁned by NF f = F◦f. Given a complete and ﬁnite measure space
(Ω, S, µ), 1 ≤s ≤∞, and 1 ≤p < ∞, Theorem 7.13(a) will show that NF acts

338
7 Nemytskii Operators on Lp Spaces
from Ls = Ls(Ω, S, µ) into Lp = Lp(Ω, S, µ) if F is universally measurable
and a condition on the growth of F holds, deﬁned as follows (where β will be
s/p). For 0 < β < ∞, let Gβ be the class of all functions F from R into itself
satisfying the β growth condition:
∥F∥Gβ := sup
u |F(u)|/(1 + |u|β) < ∞.
(7.2)
Let G∞be the class of all functions from R into itself which are bounded on
bounded intervals, i.e. F ∈G∞if and only if sup|x|≤M |F(x)| < ∞for each
M with 0 < M < ∞. A norm ∥· ∥G∞is not deﬁned.
For 0 < β < ∞, let Γβ be the class of functions F deﬁned Lebesgue
λ-almost everywhere from R into R such that
∥F∥Γβ := inf{K : |F(u)| ≤K(1 + |u|β) a.e. (λ)} < ∞.
(7.3)
For β = +∞, F ∈Γ∞will mean that for each M with 0 < M < ∞, F
restricted to [−M, M] is in L∞([−M, M], λ). For the next fact recall the class
Hloc
1
of functions that are 1-H¨older locally on R, as deﬁned in Deﬁnition 6.4.
Lemma 7.9. Let F ∈Hloc
1
be such that for some 0 < β < ∞, F ′ ∈Γβ, with
K := ∥F ′∥Γβ. Then |F ′(u)| ≤K(1 + |u|β) for all u such that F ′(u) is deﬁned.
Proof. Let t, u ∈R and ǫ > 0. Suppose t ̸= u and |t| ≤|u| + ǫ. Then F(t) −
F(u) = ∫t
u F ′(u) du, where the integral is well deﬁned although F ′(u) is deﬁned
only a.e. (λ) (e.g. Theorem 8.18 and Example 8.20 in [198]), so
|F(t) −F(u)| ≤|t −u| · K(1 + |u + ǫ|β).
If F ′(u) is deﬁned, then letting t →u and ǫ ↓0, by deﬁnition of derivative
the conclusion follows.
2
Recall that an atom is a set A ∈S (not necessarily a singleton) with
µ(A) > 0 such that for all C ∈S, µ(A ∩C) = 0 or µ(A). If there are no
atoms, then (Ω, S, µ) is called nonatomic. It is known that if (Ω, S, µ) is a
nonatomic ﬁnite measure space then for any A ∈S and 0 < c < µ(A) there
is a C ∈S with C ⊂A and µ(C) = c (Appendix, Proposition A.1).
We will also need NF to preserve measurability of functions. Evidently,
if F is Borel measurable and u(·) is measurable from Ωinto R, then so is
F◦u. For ψ(u, ω) ≡F(u), the function ψ(·, ·) is a Shragin function if and
only if F is Borel measurable. We next deﬁne a regularity condition for a
measure space (X, S, µ). For any function T from X to another set Y , let
ST := {A ⊂Y : T −1(A) ∈S}. Then ST is a σ-algebra of subsets of Y and
µ◦T −1 is a measure deﬁned on each A ∈ST by (µ◦T −1)(A) := µ(T −1(A)). If
(Y, B) is a measurable space and T is measurable for S and B, then B ⊂ST ,
where the inclusion may be strict.

7.1 Acting, Boundedness, and Continuity Conditions
339
Deﬁnition 7.10. A measure space (X, S, µ) is called perfect iﬀfor every
measurable function T from X into R and every set A ⊂R such that T −1(A)
is measurable for the completion of µ, A is measurable for the completion of
the restriction of the measure µ ◦T −1 to the Borel sets in R.
The following shows that some commonly occurring measure spaces are
perfect.
Proposition 7.11. Let (X, d) be a complete separable metric space, let S be
its Borel σ-algebra, and let µ be a ﬁnite measure on S. Then (X, S, µ) is
perfect.
Proof. Let T be Borel measurable from X into R and let A ⊂R be such
that T −1(A) is measurable for the completion of µ, i.e. there are Borel sets
Bi ⊂X, i = 1, 2, with B1 ⊂T −1(A) ⊂B2 and µ(B2 \ B1) = 0. Each
T [Bi] = {T (x): x ∈Bi} is u.m. in R [53, §13.2]. Thus for some Borel sets
Ci ⊂R, C1 ⊂T [B1] ⊂A ⊂T [B2] ⊂C2 with (µ◦T −1)(C2 \ C1) = 0, so A is
measurable for the completion of µ◦T −1, which ﬁnishes the proof.
2
Example 7.12. For X = [0, 1], S the Borel σ-algebra, and λ = Lebesgue
measure on (X, S), let E be a non-measurable set and extend λ to a measure ¯λ
on the smallest σ-algebra SE including S and containing E [53, §3.4, Problems
3-4]. Considering the identity T from X into R and A = E, we see that
(X, SE, ¯λ) is not perfect.
Here is a fact on acting and boundedness conditions for NF from Ls to
Lp for 1 ≤p < ∞and 1 ≤s ≤∞. (Recall that an operator between Banach
spaces is called bounded if it takes bounded sets into bounded sets.) If g, h,
F ◦g, and F ◦h are all measurable, then g = h a.e. (µ) implies that F ◦g = F ◦h
a.e. (µ). Thus if NF acts from Ls into Lp, it will naturally deﬁne an operator
from Ls into Lp.
Theorem 7.13. Let (Ω, S, µ) be complete and ﬁnite, let F be a function from
R into R, let 1 ≤p < ∞and 1 ≤s ≤∞. Then (a) always holds, (b) holds
when (Ω, S, µ) is nonatomic, and (c) holds when (Ω, S, µ) is nonatomic and
perfect, where
(a) If F ∈Gs/p and F is u.m., then NF acts from Ls = Ls(Ω, S, µ) into Lp
and is a bounded operator.
(b) If NF acts from V into Lp then F ∈Gs/p, where V is a nonempty open
subset of Ls for s < ∞or V = L∞for s = +∞.
(c) NF acts from Ls into Lp if and only if both F ∈Gs/p and F is u.m.
Remark 7.14. By Proposition 7.11, the characterization in part (c) applies
when Ω= [0, 1], µ is Lebesgue measure, and S is the σ-algebra of Lebesgue
measurable sets.

340
7 Nemytskii Operators on Lp Spaces
Proof. (a): Let F ∈Gs/p be u.m. and g ∈Ls. Then for any Borel set B ⊂R,
(F◦g)−1(B) = g−1(F −1(B)) ∈S because F −1(B), being u.m. in R, must be
measurable for the completion of µ ◦g−1 on the Borel sets of R, and S is
complete for µ by assumption. So F◦g is a measurable function. If s < ∞,
then we have
Z
|F(g(ω))|pdµ(ω)
1/p
≤∥F∥Gs/p
Z
(1 + |g(ω)|s/p)pdµ(ω)
1/p
≤∥F∥Gs/p
h
∥1(·)∥p + ∥g∥s/p
s
i
< ∞.
If g ∈L∞and ∥g∥∞≤K for some K < ∞, then
∥F◦g∥p ≤sup
|x|≤K
|F(x)|µ(Ω)1/p < ∞.
Thus NF acts from Ls into Lp and deﬁnes a bounded operator from Ls into
Lp, proving (a).
(b): Let s < ∞and let NF act from a neighborhood V of some G ∈Ls
into Lp. Suppose that F /∈Gs/p. Then for some xn ∈R and all n = 1, 2, . . . ,
|F(xn)| > n(1 + |xn|s/p).
(7.4)
We will ﬁnd some numbers µn > 0 and disjoint sets An ∈S with µ(An) = µn
such that
X
n
µn|xn|s < +∞,
(7.5)
X
n
µn|F(xn)|p = +∞.
(7.6)
If supn |xn| < ∞, let µn
:= C/n2 for a constant C > 0. Or if the xn are
unbounded, then taking a subsequence, we can assume that |xn| ≥1 for all
n, and let µn := C/(|xn|sn2) for a constant C > 0. Then in either case (7.5)
holds and since p ≥1, by (7.4), also (7.6) holds. Taking C small enough, we
have P
n µn < µ(Ω) and since µ is nonatomic, disjoint An ∈S with µ(An) =
µn exist by Proposition A.1 and induction. Then h := P
n xn1An ∈Ls by
(7.5). Let Ck := S
n≥k An for k = 1, 2, . . . . Let Gk := h on Ck and Gk := G
elsewhere. Then Gk ∈V for k large enough, but
Z
Ω
|F◦Gk|p dµ ≥
Z
Ck
|F◦h|p dµ = +∞
by (7.6), a contradiction, proving that F ∈Gs/p if s < ∞. Now let s = +∞and
NF act from L∞into Lp. Suppose that F /∈G∞. Then there is a sequence {xn}
of real numbers such that supn |xn| < ∞and |F(xn)| > n for all n = 1, 2, . . . .
Let µn := C/n2 for all n = 1, 2, . . . , where the constant C > 0 is such that

7.1 Acting, Boundedness, and Continuity Conditions
341
P
n µn < µ(Ω), and let An ∈S be disjoint sets with µ(An) = µn. Then
(7.6) holds and h := P
n xn1An ∈L∞. It follows that ∫|F◦h|p dµ = +∞, a
contradiction, proving F ∈G∞, and hence (b).
(c): By (a) and (b), it is enough to prove that F is u.m. provided NF acts
from Ls into Lp. Taking a constant times µ, we can assume that µ is a prob-
ability measure. Let 0 < M < ∞. Each measurable function g from Ωinto
[−M, M] is in Ls. Since µ is nonatomic, for any probability measure Q on the
Borel sets of [−M, M], there is a measurable g with µ◦g−1 = Q on the Borel
sets by Proposition A.7. Since F◦g ∈Lp, F◦g must be measurable. Thus for
each Borel set B ⊂R, g−1(F −1(B)) is measurable. So in R, (µ◦g−1)(F −1(B))
is deﬁned via the completion of the restriction Q of µ◦g−1 to the Borel sets,
since (Ω, S, µ) is perfect. Thus F −1(B) is Q-measurable. Since Q is an an ar-
bitrary probability measure on the Borel sets of [−M, M], F −1(B)∩[−M, M]
is u.m. for all M. Letting M →+∞we get that F −1(B) is u.m., so F is u.m.,
proving (c) and the theorem.
2
Next, here is a criterion for NF to act from Ls into L∞.
Proposition 7.15. Let (Ω, S, µ) be a complete, σ-ﬁnite, nonatomic measure
space, let F : R →R be universally measurable, and let 1 ≤s < ∞. Then NF
acts from Ls into L∞if and only if ∥F∥sup < +∞.
Proof. As in the proof of Theorem 7.13(a), for each g ∈Ls, F◦g is a mea-
surable function. Thus if ∥F∥sup < +∞then NF g ∈L∞, proving the “if”
part. To prove “only if,” suppose ∥F∥sup = +∞. Then there is a sequence
{uk}k≥1 ⊂R such that |F(uk)| →+∞. Take B ∈S with 0 < µ(B) < +∞.
Since µ is nonatomic, by Proposition A.1 for µ restricted to B or subsets of
it and induction on k, for each k, take disjoint A(k) ∈S such that A(k) ⊂B
and 0 < µ(A(k)) ≤µ(B)/[2k(1+|uk|s)]. Let g := P∞
k=1 uk1A(k). Then clearly
g ∈Ls but NF g /∈L∞, a contradiction, proving the proposition.
2
Continuity
Necessary and suﬃcient conditions for the Nemytskii operator Nψ to act from
Ls into Lp continuously will be given in Theorem 7.19 if ψ is a strong Shragin
function. It is not hard to show (cf. the proof of Proposition 7.18 below) that a
Nemytskii operator Nψ is continuous on L0 assuming the following condition
on ψ. A function ψ: R × Ω→R is called a Carath´eodory function (for µ) or
is said to satisfy the Carath´eodory condition (for µ) if ψ(·, ω) is continuous on
R for almost all ω ∈Ω, and ψ(u, ·) is µ-measurable on Ωfor all u ∈R. On
complete measure spaces (Ω, S, µ), the Carath´eodory condition implies the
strong Shragin condition, as the following shows:
Proposition 7.16. If (Ω, S, µ) is complete, then any Carath´eodory function
ψ on R × Ωis a strong Shragin function.

342
7 Nemytskii Operators on Lp Spaces
Proof. Let ψ be a Carath´eodory function on R×Ωand let N ⊂Ωbe a µ-null
set such that for each ω ∈N c, ψ(·, ω) is continuous on R. Since (Ω, S, µ) is
complete, N ∈Sh. For δ > 0 and (u, ω) ∈R × N c, let
ψδ(u, ω) := sup{ψ(v, ω): v ∈Q, |u −v| < δ}.
For δ > 0 and any c ∈R, we have

(u, ω) ∈R×N c: ψδ(u, ω) > c
	
=
[
v∈Q
h
(v−δ, v+δ)×{ω ∈N c : ψ(v, ω) > c}
i
.
Since ψ is a Carath´eodory function, it follows that ψ−1
δ ((c, ∞)) \ (R × N) ∈
B ⊗S for each c ∈R and δ > 0, and so ψδ is a strong Shragin function for
each δ > 0. Also, letting ψn := ψδn for some δn ↓0, it follows that for each
(u, ω) ∈R × N c, we have ψ(u, ω) = limn→∞ψn(u, ω). Thus ψ(·, ·) is jointly
measurable on R × N c (e.g. [53, Theorem 4.2.2]), so ψ is a strong Shragin
function as stated.
2
The converse to the preceding proposition will be shown to hold if in
addition the Nemytskii operator Nψ is continuous from L∞into L0. Recall
that for a ﬁnite measure space (Ω, S, µ), L0 = L0(Ω, S, µ) is the space of all
µ-equivalence classes of real-valued µ-measurable functions on Ω, with the
topology of convergence in µ-measure, metrized by a metric d0 (Section 1.4).
Proposition 7.17. Let (Ω, S, µ) be ﬁnite and complete, and let ψ be a strong
Shragin function on R×Ωsuch that the Nemytskii operator Nψ is continuous
from L∞(Ω, S, µ) into L0(Ω, S, µ). Then ψ is a Carath´eodory function.
Proof. By Proposition 7.4, ψ(u, ·) = Nψ(u1(·)) is measurable for all u ∈R.
Thus it is suﬃcient to prove that for µ-almost all ω ∈Ω, the function ψ(·, ω) is
uniformly continuous on any interval [−c, c] with 0 < c < ∞. For C := [−c, c],
let A = A(C) be the set of all ω ∈Ωsuch that ψ(·, ω) is not uniformly
continuous on C. For k, n = 1, 2, . . ., let Cn := {(u, v) ∈C×C : |u−v| ≤1/n},
Ak,n := {ω ∈Ω: |ψ(u, ω) −ψ(v, ω)| > 1/k for some (u, v) ∈Cn},
and Ak := ∩n≥1Ak,n. Then Ak ↑A as k →∞. To show measurability of Ak,n
ﬁx any k and n. Let
Bk,n := {(ω, u, v) ∈Ω× Cn : |ψ(u, ω) −ψ(v, ω)| > 1/k}.
Since ψ is a strong Shragin function, there is a µ-null set N such that Bk,n \
(N × R2) belongs to the σ-algebra S ⊗B(R2), where B(R2) denotes the σ-
algebra of Borel subsets of R2. According to Sainte-Beuve’s selection theorem
(e.g. [52, Theorem 5.3.2] for F := Y := Cn ⊂R2 with Borel σ-algebra and T
the identity R2 →R2, X(ω, u, v) = ψ(u, ω) −ψ(v, ω) restricted to N c × R2),
the projection

7.1 Acting, Boundedness, and Continuity Conditions
343
Dk,n := {ω ∈Ω: (ω, u, v) ∈Bk,n \ (N × R2) for some (u, v) ∈Cn}
is (universally) measurable in Ωand there are (universally) measurable func-
tions uk,n(·) and vk,n(·) from Dk,n into C such that (ω, uk,n(ω), vk,n(ω)) ∈
Bk,n for all ω ∈Dk,n. Since N is a µ-null set and Ak,n = (Ak,n ∩N) ∪Dk,n,
each Ak,n is measurable, and so are the sets Ak and A.
Suppose that for some interval C = [−c, c] with 0 < c < ∞, the set A has
positive µ-measure. Then there is an integer k ≥1 such that µ(Ak) > 0. Fix
this k. For each ω ∈D := ∩n≥1Dk,n ⊃Ak \ N, by compactness, there is a
u ∈C such that for every neighborhood W of u, uk,n(ω) ∈W for inﬁnitely
many values of n. Let A∗be the set of all such pairs (ω, u) ∈D × C. Then
A∗=
\
m≥1
[
n≥m
[
r∈Q

(ω, u): |uk,n(ω) −r| < 1/m, |r −u| < 1/m
	
,
(7.7)
and so A∗∈S ⊗B. The projection of A∗into Ωequals D. By Sainte-Beuve’s
selection theorem again there is a measurable function η: D →C such that
(ω, η(ω)) ∈A∗for all ω ∈D. For m = 1, 2, . . . , let
Ek,m := {(ω, U, V ) ∈D × C × C : |U −η(ω)| < 2/m, |V −η(ω)| < 3/m,
and |ψ(U, ω) −ψ(V, ω)| > 1/k}.
Then Ek,m ∈S ⊗B(R2). For each ω ∈D and m, there are U and V in
C = [−c, c] with (ω, U, V ) ∈Ek,m, by (7.7) with u = η(ω), U = uk,n(ω)
for some n ≥m, and V = vk,n(ω). Thus by Sainte-Beuve’s selection the-
orem again, there are measurable functions Um and Vm on D such that
(ω, Um(ω), Vm(ω)) ∈Ek,m for all ω ∈D. Let gm := 1DUm(·), hm := 1DVm(·)
and ηD := 1Dη. Then ηD ∈L∞, gm →ηD, and hm →ηD in L∞as m →∞,
and for each m, |Nψgm −Nψhm| > 1/k on the set D. But since Nψ is con-
tinuous on L∞, Nψgm −Nψhm converges to zero in µ-measure as m →∞, a
contradiction, proving the proposition.
2
Proposition 7.18. Let (Ω, S, µ) be ﬁnite and complete, and let ψ be a strong
Shragin function on R × Ω. The Nemytskii operator Nψ is continuous from
L0(Ω, S, µ) into itself if and only if ψ is a Carath´eodory function.
Proof. The “only if” part of the conclusion follows from Proposition 7.17. To
prove the “if” part, let ψ be a Carath´eodory function. Suppose that Nψ is not
continuous on L0. Then there is a sequence {fn} ⊂L0 converging in µ-measure
to an f ∈L0 and such that for some ǫ > 0, d0(Nψfn, Nψf) ≥ǫ for each
n ≥1. By a theorem of F. Riesz (e.g. [53, Theorem 9.2.1]) one can extract a
subsequence {fn′} which converges to f a.e. (µ). Thus the subsequence Nψfn′
converges to Nψf a.e. (µ) as n →∞, and also in µ-measure, a contradiction,
proving continuity of Nψ on L0. The proof of the proposition is complete. 2

344
7 Nemytskii Operators on Lp Spaces
Theorem 7.19. Let (Ω, S, µ) be ﬁnite and complete, let ψ be a strong Shra-
gin function on R × Ω, and let the Nemytskii operator Nψ act from Ls =
Ls(Ω, S, µ) into Lp for some 1 ≤s, p < ∞. Then Nψ is continuous if and
only if ψ is a Carath´eodory function.
Proof. Since convergence in Lp implies convergence in µ-measure, the “only
if” part of the conclusion follows by Proposition 7.17. To prove the “if” part,
let ψ be a Carath´eodory function. First suppose that Nψ0 = 0 and that Nψ
is not continuous at zero. Then there is a sequence {fn} ⊂L0 such that
∞
X
n=1
∥fn∥s
s < ∞
(7.8)
and for some ﬁnite constant C > 0,
Z
Ω
|Nψfn|p dµ ≥C
∀n ≥1.
(7.9)
Further, by induction, one can construct a sequence {ǫk} of positive numbers,
a sequence {Ak} of measurable subsets of Ω, and a subsequence {fnk} such
that for each k ≥1, (1) 0 < ǫk+1 < ǫk/2, (2) µ(Ak) ≤ǫk, (3)
Z
Ak
|Nψfnk|p dµ ≥(2/3)C,
(7.10)
and (4) for each B ∈S such that µ(B) ≤2ǫk+1,
Z
B
|Nψfnk|p dµ ≤(1/3)C.
(7.11)
Indeed, let ǫ1 := µ(Ω), A1 := Ω, and fn1 := f1. Suppose that ǫk, Ak and
fnk are chosen for some k ≥1. Since ∥1BNψfnk∥p →0 as µ(B) →0, there
is an ǫk+1 satisfying (4) and (1). Since convergence in Ls implies convergence
in µ-measure, by Proposition 7.18, there is an integer nk+1 > nk such that
µ(Ak+1) < ǫk+1, where
Ak+1 := {ω ∈Ω:
(Nψfnk+1)(ω)
 > (C/3µ(Ω))1/p}.
By (7.9), it then follows that
Z
Ak+1
Nψfnk+1
p dµ =
Z
Ω
Nψfnk+1
p dµ −
Z
Ω\Ak+1
Nψfnk+1
p dµ ≥(2/3)C,
and so (2) and (3) hold with k replaced by k + 1, completing the inductive
construction of {ǫk}, {Ak}, and {fnk}. For k = 1, 2, . . ., let Bk := Ak\∪i>kAi.
Then for each k ≥1,
µ(Ak \ Bk) ≤µ
 [
i>k
Ai

≤
X
i>k
ǫi < 2ǫk+1.
(7.12)

7.1 Acting, Boundedness, and Continuity Conditions
345
Deﬁne a function g: Ω→R by g(ω) := fnk(ω) if ω ∈Bk for some k ≥1, and
g(ω) := 0 otherwise. Then g is measurable and by (7.8),
Z
Ω
|g|s dµ =
X
k≥1
Z
Bk
|fnk|s dµ ≤
X
k≥1
∥fnk∥s
s < ∞,
and so g ∈Ls. However, for each k ≥1, by (7.10), (7.11), and (7.12), we have
Z
Bk
Nψg
p dµ =
Z
Bk
Nψfnk
p dµ
=
Z
Ak
Nψfnk
p dµ −
Z
Ak\Bk
Nψfnk
p dµ ≥C/3.
Since the sets Bk are disjoint, it follows that ∫Ω|Nψg|p dµ = +∞, contradict-
ing the acting condition for Nψ. Thus Nψ must be continuous at zero provided
Nψ0 = 0.
Now let ψ be any Carath´eodory function and let G ∈Ls. For (u, ω) ∈
R × Ω, let
φ(u, ω) := ψ(G(ω) + u, ω) −ψ(G(ω), ω).
Then clearly Nφ acts from Ls into Lp and Nφ0 = 0. For any u ∈R and ω ∈Ω
let fu(ω) := u1(ω) ≡u. Then fu ∈Ls, so Nφ(fu) ∈Lp and φ(u, ·) = Nφ(fu)(·)
is measurable. It is easily seen that φ is continuous in u for each ω such that
ψ(·, ω) is, so φ is a Carath´eodory function. By Proposition 7.16, φ is a strong
Shragin function. By the preceding part of the proof, Nφ is continuous at zero.
Thus Nψ is continuous at G. The proof of the theorem is complete.
2
Corollary 7.20. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, let ψ be a
Carath´eodory function, and let 1 ≤p, s < ∞. If the Nemytskii operator Nψ
acts from Ls into Lp, then it is bounded, and there is a constant C = Cψ > 0
such that ∥Nψf∥p ≤∥Nψ0∥p + C∥f∥s/p
s
for each f ∈Ls.
Proof. Let φ(u, ω) := ψ(u, ω) −ψ(0, ω), (u, ω) ∈R × Ω. Then for any f ∈Ls,
Nψf = Nφf +ψ(0, ·), and ψ(0, ·) ∈Lp, so it will suﬃce to prove the result for
φ in place of ψ, or in other words to assume that ψ(0, ·) ≡0. By Theorem 7.19,
Nψ is continuous. Therefore there is an r > 0 such that ∥Nψg∥p ≤1 for each
g ∈Ls with ∥g∥s ≤r. By Proposition A.9, for f ∈Ls with ∥f∥s > r, there
exists a partition {Ai}n
i=0 of Ωinto measurable sets such that ∫Ai |f|s dµ =
∥f∥s
s/(n + 1) ∈(rs/2, rs] for i = 0, . . . , n. Then
∥Nψf∥p
p =
n
X
i=0
∥Nψ(1Aif)∥p
p ≤n + 1 ≤(2/rs)∥f∥s
s.
Thus the conclusion holds with C = (2/rs)1/p.
2

346
7 Nemytskii Operators on Lp Spaces
A Nemytskii operator acting from an open subset of Ls into Lp extends
to all of Ls by the next proposition.
Proposition 7.21. Let (Ω, S, µ) be nonatomic, let 1 ≤p, s < ∞, and let V
be a nonempty open set in Ls(Ω, S, µ). For the Nemytskii operator Nψ the
following hold:
(a) if Nψ acts from V into Lp, then it acts from Ls into Lp;
(b) if in addition Nψ is continuous from V into Lp, then it is continuous from
Ls into Lp.
Proof. For (a), let G ∈V and let r > 0 be such that G + Br ⊂V , where
Br = {f ∈Ls : ∥f∥s < r}. For (u, ω) ∈R × Ω, let
φ(u, ω) := ψ(G(ω) + u, ω) −ψ(G(ω), ω).
(7.13)
Then Nφ acts from Br into Lp. Let f ∈Ls be such that f ̸∈G + Br, and so
∥f −G∥s ≥r. By Proposition A.9 with h = f −G and c = r/2, there is a
partition {Ai}k
i=0 of Ωinto measurable sets such that ∥(f −G)1Ai∥s ≤r/2 for
i = 0, . . . , k. Since Nφ(f −G) = Pk
i=0 Nφ((f −G)1Ai), we have Nφ(f −G) ∈
Lp, and so Nψf = Nφ(f −G) + NψG ∈Lp, proving (a).
For (b), as for (a), let G ∈V , let r > 0 be such that G+Br ⊂V , and let φ
be deﬁned by (7.13). Then Nφ is continuous from Br into Lp. Let f ∈Ls be
such that f ̸∈G+Br and for a sequence {fn} ⊂Ls, fn →f in Ls. Again, let a
partition {Ai}k
i=0 of Ωinto measurable sets be such that ∥(f −G)1Ai∥s ≤r/2
for i = 0, . . . , k (Proposition A.9). Thus ∥(fn −G)1Ai∥s < r for each i and all
suﬃciently large n. Since
∥Nφ(fn −G)−Nφ(f −G)∥p
p =
k
X
i=0
∥Nφ((fn −G)1Ai)−Nφ((f −G)1Ai)∥p
p →0
as n →∞, it follows that Nψfn −Nψf = Nφ(fn −G) −Nφ(f −G) →0 in
Lp as n →∞. The proof of the proposition is complete.
2
Let F be a Borel measurable function from R into R such that the au-
tonomous Nemytskii operator NF acts from Ls into Lp. By Theorem 7.19,
NF is (globally) continuous if and only if F is continuous. The following gives
a local continuity condition.
Proposition 7.22. Let (Ω, S, µ) be complete and ﬁnite, and let 1 ≤s, p < ∞.
Let G ∈Ls and let F be universally measurable from R into R, continuous
a.e. for µ◦G−1, and in Gs/p. Then NF is continuous at G from Ls into Lp.
Proof. By Theorem 7.13(a), NF acts from Ls into Lp. To show its continuity
at G, let gn →0 in Ls. Taking a subsequence if necessary, we can assume that
gn →0 a.e. (µ). Then fn := NF(G + gn) −NF (G) →0 as n →∞a.e. (µ)

7.2 H¨older Properties
347
since F is continuous at G(ω) for µ-almost all ω ∈Ω. By e.g. Theorem III.3.6
in [57], it is enough to show that {|fn|p}n≥1 are uniformly integrable, that is,
for each ǫ > 0 there is a δ > 0 such that if µ(A) < δ then ∫A |fn|p dµ < ǫ for
each n ≥1. Using the β growth condition (7.2) with β = s/p, it follows that
Z
A
|fn|p dµ = ∥[NF(G + gn) −NF (G)]1A∥p
p
≤4p−1∥F∥p
Gs/p
n
µ(A) +
Z
A
|G + gn|s dµ
o
+ 2p−1
Z
A
|NF (G)|p dµ
for any A ∈S. Since G + gn →G in Ls as n →∞, and so {|G + gn|s}n≥1 are
uniformly integrable, the right side tends to zero as µ(A) →0 uniformly in n,
proving the proposition.
2
Recall that Proposition 7.15 gave a criterion for NF to act from Ls into
L∞of a suitable measure space, namely that F be bounded. The following
shows that for NF not only to act but to be continuous into L∞is much more
restrictive:
Proposition 7.23. Let (Ω, S, µ) be a σ-ﬁnite, nonatomic measure space, let
F be a function from R into R, and let 1 ≤s < ∞. Then NF both acts and is
continuous from Ls into L∞if and only if F is a constant.
Proof. “If” is clear. To prove “only if,” suppose F is not a constant. Then
F(a) ̸= F(b) for some a, b. Take B with 0 < µ(B) < +∞and let G := a1B ∈
Ls. Take A(k) ⊂B, A(k) ∈S, with 0 < µ(A(k)) →0 as k →+∞, as is
possible by Proposition A.1. Let gk := (b −a)1A(k). Then as k →∞, gk →0
in Ls but F ◦(G + gk) does not converge to F ◦G in L∞. So, either NF
does not act from Ls into L∞, or if it acts, it is not continuous, proving the
proposition.
2
7.2 H¨older Properties
For 0 < α ≤1, recall Deﬁnition 6.42 of a uniformly α-H¨older function ψ(u, s)
specialized to the case when S is a singleton, B = Ls, and Y = Lp, where
1 ≤s, p ≤∞. For a given G ∈Ls, we say that a Nemytskii operator Nψ acting
from Ls into Lp is α-H¨older at G from Ls into Lp if there are a neighborhood
V of 0 in Ls and a ﬁnite constant L such that ∥Nψ(G + g) −NψG∥p ≤L∥g∥α
s
for each g ∈V . In other words, Nψ is α-H¨older at G if ∥Nψ(G+g)−NψG∥p =
O(∥g∥α
s ) as ∥g∥s →0.
It will be shown that the autonomous Nemytskii operator NF has a H¨older
property from spaces Ls to Lp for F ∈Wp(R), but only at suitable functions
G which will be characterized. For 1 ≤p < ∞, let γ(p, s) := 1 + s/[p(1 + s)]
for 1 ≤s < ∞and γ(p, ∞) := 1 + 1/p.

348
7 Nemytskii Operators on Lp Spaces
Theorem 7.24. Let (Ω, S, µ) be a ﬁnite measure space, let J be a nondegen-
erate interval (bounded or unbounded), and let G be a measurable function on
Ωwith values in J. Then the following are equivalent:
(a)
there is a C < ∞such that for some p ∈[1, ∞) and s ∈[1, ∞],
∥NF(G + g) −NF (G)∥p ≤C∥F∥(p)∥g∥γ(p,s)−1
s
(7.14)
for all F ∈Wp(J; R) and g ∈Ls(Ω, S, µ) such that G + g has values in
J;
(a′) (a) holds for all p ∈[1, ∞) and s ∈[1, ∞];
(b)
G ∈Dλ, that is, there is an M < ∞such that µ ◦G−1 has a den-
sity with respect to Lebesgue measure λ on R bounded by M, so that
(µ◦G−1)((c, d]) ≤M(d −c) for −∞< c < d < ∞.
Moreover, the constants C in (a) or (a′) can be chosen to depend only on
µ(Ω) and M in (b), or also on p; we can take M ≥1 and then C = C1 or C2
where C1 := 2(max{µ(Ω), 6M + 1})1/p ≤C2 := 2 max{µ(Ω), 6M + 1}.
Remark. Proposition 7.28 will show that in (7.14) the power γ(p, s) −1 on
∥g∥s, the power 1 on ∥F∥(p), and the seminorm ∥· ∥(p) itself are all optimal.
(b) implies that µ is nonatomic by Proposition A.4; thus, so must (a). In fact,
if µ◦G−1 has an atom at a point where F has a jump, then g 7→NF (G + g)
is not continuous at g = 0 (Remark 7.26 below).
Proof. (b) implies (a′): ﬁx p ∈[1, ∞) and s ∈[1, ∞]. Let g ∈Ls(Ω, S, µ)
be such that G + g has values in J, let δ
:=
∥g∥s, β
:=
s/(1 + s), or
β := 1 if s = +∞, K := µ(Ω), and F ∈Wp(J; R). Subtracting a constant
from F, we can assume that sup F = −inf F and so that ∥F∥sup ≤∥F∥(p)/2.
We can assume that δ ≤1, since otherwise (7.14) holds using C ≥K1/p.
Let A
:=
{ω ∈Ω:
|g(ω)| ≤δβ}. Then µ(Ω\ A) ≤δs(1−β) = δβ if s <
∞, or µ(Ω\ A) = 0 if s = +∞. We can assume that M ≥1 in (b). Let
∆:= ∆(F, G, g) := NF (G + g) −NF (G). It follows that
Z
Ω\A
|∆|pdµ ≤∥F∥p
(p)δβ.
(7.15)
Let k be a positive integer such that 1/(2k) ≤δβ ≤1/k. For ﬁxed k we can
decompose R into disjoint intervals Ik,j := [(j −1)/k, j/k), j ∈Z. Let Z0 be
the set of all j ∈Z such that A(k, j) := A ∩G−1(Ik,j) is nonempty. Then
Z
A
|∆|pdµ ≤
X
j∈Z0
( sup
A(k,j)
|∆|)pµ(A(k, j)).
Choose sk,j ∈A(k, j) for each j ∈Z0 such that |∆(sk,j)| ≥supA(k,j) |∆|/2.
Then |g(sk,j)| ≤δβ ≤1/k. For i = 0, 1, 2 let Z0,i be the set of all integers
j ∈Z0 such that j ≡i mod 3. For each i, the intervals with endpoints
(G + g)(sk,j) and G(sk,j) for all j ∈Z0,i are disjoint. Thus

7.2 H¨older Properties
349
Z
A
|∆|pdµ ≤2p 3M
k ∥F∥p
(p) ≤6Mδβ∥2F∥p
(p).
Combining this with (7.15) and taking pth roots we get ∥∆∥p ≤C∥F∥(p)∥g∥β/p
s
for C as given at the end of the theorem. So (a′) is proved.
Clearly (a′) implies (a). Lastly, to show that (a) implies (b), assume
(a). If (b) fails, then for n = 1, 2, . . ., there exist cn < dn in R with
qn := (µ◦G−1)((cn, dn]) > n(dn −cn). Let gn := 2(cn −dn) on G−1((cn, dn])
and gn := 0 elsewhere, and let Fn := 1[cn,∞). Then for all n, ∥Fn∥(p) =
1 and ∥Fn◦(G + gn) −Fn◦G∥p = q1/p
n
. For s < ∞, ∥gn∥s = 2(dn −
cn)q1/s
n . Letting δn := dn −cn > 0 gives qn > nδn, while by (a), q1/p
n
≤
C(2δn)s/(p(1+s))q1/(p(1+s))
n
, giving qs/(1+s)
n
≤Cp(2δn)s/(1+s) and so qn ≤
2Cp(s+1)/sδn, a contradiction for n large. For s = ∞, q1/p
n
≤C · 1 · (2δn)1/p
so qn ≤2Cpδn while qn > nδn, again a contradiction for n large. So (b) holds
and the theorem is proved.
2
The next fact will be used in Theorem 8.9 below to prove diﬀerentiability of
a two-function composition operator (F, g) 7→F◦(G+g), where both ∥F∥(p) →
0 and ∥g∥s →0.
Corollary 7.25. If (a) in Theorem 7.24 holds then also for any a > 1, b > 1
with a−1 + b−1 = 1 and γ := γ(p, s),
∥NF(G + g) −NF (G)∥p ≤C

a−1∥F∥a
(p) + b−1∥g∥(γ−1)b
s

,
∥NF(G + g) −NF (G)∥p ≤C
 1
γ ∥F∥γ
(p) +

1 −1
γ

∥g∥γ
s

for each F ∈Wp(J; R) and g ∈Ls(Ω, S, µ) such that G and G+g have values
in J.
Proof. For any u, v ≥0 we have uv ≤a−1ua + b−1vb by (3.20), and the ﬁrst
conclusion follows from (7.14). Then a := γ, b = γ/(γ −1) gives the second.
2
The following example shows that the nonatomicity of µ◦G−1 in Theorem
7.24(b) is essential, not only for the given H¨older property, but for continuity
of NF.
Remark 7.26. Let G ∈L∞(Ω, S, µ) and suppose µ◦G−1 has an atom at y,
meaning that µ(G−1({y})) > 0. Then if F(y+) exists but F(y+) ̸= F(y), the
autonomous Nemytskii operator NF is not continuous at G on L∞; to see
this let gn(ω) ≡1/n, so ∥gn∥∞→0, and on G−1({y}), NF (G) ≡F(y), while
NF (G + gn) →F(y+). Similarly if F(y−) ̸= F(y), let gn(ω) ≡−1/n.

350
7 Nemytskii Operators on Lp Spaces
Remark 7.27. Let G(x) = x, 0 ≤x ≤1, and F1(x) := 1{x≤1/2}. Let J(n)
be the interval [1/2, 1/2 + 1/n), and gn := −n−11J(n), n = 2, 3, . . .. Then for
1 ≤p < ∞and µ equal to Lebesgue measure on Ω= [0, 1], ∥NF1(G + gn) −
NF1(G)∥p = n−1/p and ∥F1∥(p) = 1. Also ∥gn∥s = n−(1+s)/s for 1 ≤s < ∞,
∥gn∥sup = 1/n, ∥gn∥(r) = 21/r/n, and so ∥gn∥[r] = (1 + 21/r)/n, 1 ≤r < ∞.
We can also take multiples F = tF1 with t →0.
The last remark gives the following:
Proposition 7.28. If (F, ∥· ∥) is a normed space of real-valued functions on
[0, 1] containing F1 of Remark 7.27, and for some ﬁnite constants C > 0, λ >
0, and ζ > 0,
∥NF(G + gn) −NF (G)∥p ≤C∥F∥λ∥gn∥ζ
s
for F, G, and gn as in Remark 7.27, then λ ≤1 and ζ ≤s/(p(1 + s)) for
1 ≤s < ∞, ζ ≤1/p for s = ∞. Thus the powers λ = 1 in Theorem 7.24 (a)
and ζ = s/(p(1 + s)) for s < ∞, ζ = 1/p for s = ∞, are separately optimal,
and no norm on F allows a better exponent than ∥· ∥(p) does.
On the other hand, the exponents for s = ∞are not improved if we replace
∥· ∥∞by a stronger r-variation norm ∥g∥[r], 1 ≤r < ∞.
By Theorem 7.24, for F ∈Wp(R) and α = s/[p(1 + s)], the autonomous
Nemytskii operator NF is α-H¨older from Ls into Lp at suitable elements of Ls.
We will show in Proposition 7.30 that NF is α-H¨older from Ls into Lp with
α = s/p ≤1 provided F ∈Hα(R; R). Although for a bounded nondegenerate
interval J, Hα(J; R) ⊂W1/α(J; R) for 0 < α ≤1, Wp(R) does not include
any space Hα(R; R).
Let Mk(f1, . . . , fk) := f1 · · · fk be the function deﬁned by the pointwise
multiplication of real-valued functions f1, . . . , fk on Ω. The following bound
for the Lp norm of Mk(f1, . . . , fk) extends H¨older’s inequality and will be used
to prove α-H¨older properties of Nemytskii operators and several times later
for other purposes.
Lemma 7.29. Let (Ω, S, µ) be σ-ﬁnite and Lr := Lr(Ω, S, µ). For any k =
2, 3, . . . , if pj ∈[1, ∞) for j = 1, . . . , k and s := Pk
j=1 1/pj ≤1, then for
p := 1/s,
∥Mk(f1, . . . , fk)∥p ≤∥f1∥p1 · · · ∥fk∥pk
(7.16)
and (f1, . . . , fk) 7→Mk(f1, . . . , fk) is a bounded k-linear map from Lp1 ×· · ·×
Lpk into Lp with norm ∥Mk∥= 1.
Proof. We have p < pj for all j. For k = 2, by H¨older’s inequality (e.g. [53,
Theorem 5.1.2] with p = sp1 and q = sp2), if f ∈Lp1 and g ∈Lp2, then
Z
Ω
|fg|p dµ ≤
 Z
Ω
|f|p1 dµ
p/p1 Z
Ω
|g|p2 dµ
p/p2
,
and so (7.16) holds. For the norm deﬁned by (5.4), we then have

7.2 H¨older Properties
351
∥M2∥= sup{∥fg∥p: ∥f∥p1 ≤1, ∥g∥p2 ≤1} ≤1.
By induction on k it follows that (7.16) and ∥Mk∥≤1 hold for all k.
Conversely, take any h ∈L1 with ∥h∥1 = 1 and let fj := |h|1/pj for j =
1, . . . , k. Then ∥fj∥pj = 1 for all j and ∥Mk(f1, . . . , fk)∥p = 1, so ∥Mk∥= 1,
proving the lemma.
2
The following statement gives suﬃcient conditions for an autonomous Ne-
mytskii operator to be α-H¨older from Ls into Lp with 1 ≤s ≤p < ∞.
Proposition 7.30. Let (Ω, S, µ) be complete and ﬁnite and let 1 ≤s ≤p <
∞. If F ∈Hα(R; R) with 0 < α ≤s/p, then the autonomous Nemytskii
operator NF is α-H¨older from Ls(Ω, S, µ) into Lp(Ω, S, µ).
Proof. Clearly F ∈Gα and F is universally measurable. Thus NF acts from
Ls into Lp by Theorem 7.13(a) since α ≤s/p. For some K < ∞, we have
|F(x)−F(y)| ≤K|x−y|α for all x, y ∈R. Then for any G and g in Ls(Ω, S, µ),
by Lemma 7.29 with k = 2 if α < s/p, or directly if α = s/p,
Z
Ω
F◦(G + g) −F◦G
p dµ ≤Kp
Z
Ω
|g|pα dµ ≤M∥g∥pα
s ,
where M := Kpµ(Ω)1−(pα/s), which gives the conclusion.
2
The upper bound s/p for α in the last proposition cannot be made larger,
as Corollary 7.34 will show. But ﬁrst we show that for a speciﬁc F ∈Hα,
the autonomous Nemytskii operator NF is β-H¨older at suitable elements of
Ls for a β = β(α, s, p) with α < β < s/p ≤1. As deﬁned in the Appendix,
Dλ = Dλ(Ω, S, µ) is the set of all functions G ∈L0(Ω, S, µ) such that µ◦G−1
has a bounded density ξG with respect to Lebesgue measure λ on R.
Proposition 7.31. Let (Ω, S, µ) be complete and ﬁnite, 1 ≤s ≤p < ∞, and
let Fα(u) ≡|u|α with 0 < α ≤s/p. If G ∈Dλ ∩Ls then the autonomous
Nemytskii operator NFα acts from Ls into Lp and there is a constant K < ∞
such that for each g ∈Ls with ∥g∥s ≤1,
∥NFα(G + g) −NFα(G)∥p ≤K∥g∥β
s,
(7.17)
where β := [α + (1/p)]s/(1 + s) ∈[α, s/p].
Proof. If α = s/p then β = α and the conclusion follows from Proposition
7.30. Suppose that α < s/p, and so α < β < s/p ≤1. Since Fα ∈Gα ⊂Gs/p,
NFα acts from Ls into Lp by Theorem 7.13(a). For each g ∈Ls with ∥g∥s ≤1,
let ∆(g) := Fα◦(G+g)−Fα◦G. Let ρ := s/(1+s) and ǫ := ǫ(g) := ∥g∥ρ
s. Thus
β = ρ[α + (1/p)]. Also, let A1 := {ω: |G(ω)| ≤ǫ}, A2 := Ac
1 ∩{ω: |g(ω)| >

352
7 Nemytskii Operators on Lp Spaces
ǫ/2}, and A3 := Ac
1 ∩{ω: |g(ω)| ≤ǫ/2}. Thus the left side of (7.17) does not
exceed the sum of Ti := ∥∆(g)1Ai∥p, i = 1, 2, 3.
Let M := ∥ξG∥∞< ∞. Then µ(A1) = ∫{|x|≤ǫ} ξG(x) dx ≤2Mǫ =
2M∥g∥ρ
s. Since |Fα(u) −Fα(v)| ≤|u −v|α for all u, v ∈R, it then follows
by Lemma 7.29 with k = 2 if α < s/p, or directly if α = s/p, that
T1 ≤
 Z
Ω
|g|αp1A1 dµ
1/p
≤∥g∥α
s µ(A1)(1/p)−(α/s) ≤K1∥g∥β
s,
(7.18)
where K1 := (2M)(1/p)−(α/s). For T2, again, since ǫ = ∥g∥ρ
s, we have
µ(A2) ≤µ({ω: |g(ω)| > ǫ/2}) ≤(2/ǫ)s∥g∥s
s = 2s∥g∥ρ
s.
Thus as in (7.18), we get the bound
T2 ≤
 Z
Ω
|g|αp1A2 dµ
1/p
≤∥g∥α
s µ(A2)(1/p)−(α/s) ≤K2∥g∥β
s,
where K2 := 2(s/p)−α. To bound T3, by (5.2) in the mean value theorem, for
each x, y ∈R such that |x| > ǫ and |y| ≤ǫ/2, we have
Fα(x + y) −Fα(x)
 ≤|y| sup
0≤t≤1
|F ′
α(x + ty)|
where |x + ty| > ǫ/2, so the sup is ﬁnite. It then follows that for each ω ∈A3,
∆(g)(ω)
 ≤α|g(ω)| sup
0≤t≤1
|G(ω) + tg(ω)|α−1
≤(ǫ/2)1−(s/p)|g(ω)|s/p
|G(ω)| −ǫ/2
α−1
since s ≤p. Since ǫ = ∥g∥ρ
s ≤1, we have
T3 ≤
 ǫ
2
1−(s/p)h Z
A3∩{|G|>1}
|g|s2p(1−α)dµ
1/p
+
 Z
A3∩{|G|≤1}
|g|s(ǫ/2)p(α−1) dµ
1/pi
≤(ǫ/2)1−(s/p)∥g∥s/p
s
h
21−α + (ǫ/2)α−1i
= 2(s/p)−αh
∥g∥ρ[1+(1/p)]
s
+ ∥g∥β
s
i
≤K3∥g∥β
s,
where K3 := 2K2. Summing the bounds of Ti, i = 1, 2, 3, and letting K :=
K1 + K2 + K3, it follows that (7.17) holds whenever ∥g∥s ≤1. The proof of
the proposition is complete.
2
For the Nemytskii operator NFα, the order of the remainder bound (7.17)
cannot be improved in general, as the following shows.

7.2 H¨older Properties
353
Proposition 7.32. Let (Ω, S, µ) = ([0, 1], B, λ), 1 ≤s, p < ∞, Fα(u) ≡|u|α,
u ∈R, with 0 < α < ∞, G(x) ≡x, x ∈[0, 1], and β > 0. If the Nemytskii
operator NFα acts from Ls into Lp and ∥NFα(G + g) −NFα(G)∥p = O(∥g∥β
s )
as ∥g∥s →0, then α ≤s/p and β ≤[α + (1/p)]s/(1 + s) ∈[α, s/p].
Proof. By Theorem 7.13(b), it follows that α ≤s/p, and so as in the last proof
[α + (1/p)]s/(1 + s) ∈[α, s/p]. For g ∈Ls, let ∆(g) := Fα◦(G + g) −Fα◦G.
For δ > 0, let gδ(x) := −x1[0,δ](x), x ∈[0, 1]. Then ∥gδ∥s = δ1+(1/s)/(1+s)1/s
and |∆(gδ)| = Fα1[0,δ]. Thus there is a constant C = C(α, s, p) < ∞such that
for each δ > 0,
∥∆(gδ)∥p = δα+(1/p)/(1 + αp)1/p = C∥gδ∥[α+(1/p)]s/(1+s)
s
.
Since ∥gδ∥s →0 as δ ↓0, the stated conclusion follows.
2
For (u, x) ∈R × [0, 1], letting φα(u, x) := |x + u|α −|x|α, φα is a Shragin
function on R × [0, 1]. By Theorem 7.13(a), if α ≤s/p then NFα and so Nφα
acts from Ls([0, 1], B, λ) into Lp([0, 1], B, λ). Thus by the preceding proposi-
tion, if α ≤s/p and ∥Nφαg∥p = O(∥g∥β
s ) as ∥g∥s →0, then β ≤s/p. This
fact holds for any non-degenerate Nemytskii operator acting from Ls into Lp,
as the following shows.
Proposition 7.33. Let (Ω, S, µ) be nonatomic and ﬁnite, 1 ≤s, p < ∞, and
0 < α < ∞. Let a Shragin function φ be such that φ ̸⋍0, and let the Nemytskii
operator Nφ act from Ls into Lp. Then the following hold:
(a) if ∥Nφg∥p = O(∥g∥α
s ) as ∥g∥s →0, then α ≤s/p;
(b) if ∥Nφg∥p = o(∥g∥α
s ) as ∥g∥s →0, then α < s/p.
Proof. Let f ∈L0 be such that Nφf ̸= 0 on a set of positive µ-measure. Then
for some constant C > 0, the set A := {ω: |φ(f(ω), ω)| ≥C} has positive
µ-measure. We can and do assume that for some M < ∞, |f| ≤M on A. Since
µ is nonatomic, by Proposition A.1, for each n = 1, 2, . . ., there are An ∈S
with An ⊂A and 0 < µn := µ(An) →0 as n →∞. For each n = 1, 2, . . . ,
let gn := f1An. Then ∥gn∥s ≤Mµ1/s
n
and ∥Nφ(gn)∥p ≥Cµ1/p
n . Thus for
(a) we have µ1/p
n
= O(µα/s
n
) as n →∞, and so α ≤s/p. For (b) we have
µ1/p
n
= o(µα/s
n
) as n →∞, and so α < s/p. The proof of the proposition is
complete.
2
Corollary 7.34. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete, 1 ≤s ≤
p < ∞, and 0 < α ≤1. Let F be a Borel measurable non-constant function.
If the autonomous Nemytskii operator NF is α-H¨older at some G ∈Ls =
Ls(Ω, S, µ) from Ls into Lp, then α ≤s/p.

354
7 Nemytskii Operators on Lp Spaces
Proof. Let G ∈Ls be such that NF is α-H¨older at G. For (u, ω) ∈R × Ω, let
φ(u, ω) := F(G(ω) + u) −F(G(ω)). Then φ is jointly measurable on R × Ω,
and so it is a µ-strong Shragin function on R × Ω. Since F is not constant,
for each ω ∈Ω, φ(u, ω) ̸= 0 for some u ∈R, and so φ ̸⋍0 by Proposition 7.6.
Since ∥Nφg∥p = O(∥g∥α
s ) as ∥g∥s →0, the conclusion follows from Proposition
7.33(a).
2
Proposition 7.35. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete, 1 ≤s <
p < ∞, s/p < α ≤1, and let ψ be a Shragin function on R×Ω. The Nemytskii
operator Nψ is α-H¨older at some G ∈Ls = Ls(Ω, S, µ) from Ls into Lp if
and only if there is a function h ∈Lp such that ψ ⋍h.
Proof. The “if” part is obvious. To prove the “only if” part suppose that Nψ
is α-H¨older at G ∈Ls from Ls into Lp. For (u, ω) ∈R × Ω, let φ(u, ω) :=
ψ(G(ω) + u, ω) −ψ(G(ω), ω). Then φ is a Shragin function on R × Ωand
∥Nφg∥p = O(∥g∥α
s ) as ∥g∥s →0. Since α > s/p, by Proposition 7.33(a),
Nφf = 0 a.e. (µ) for each f ∈L0. Let h := NψG ∈Lp and f ∈L0. Then
Nψf ≡Nφ(f −G) + h = h a.e. (µ), proving the proposition.
2
7.3 Diﬀerentiability
Proposition 7.35 will be used to show that only degenerate Nemytskii oper-
ators acting from Ls into Lp with 1 ≤s < p < ∞are Fr´echet diﬀerentiable.
Recall the remainder in the diﬀerentiability as deﬁned in (5.1) for a Nemytskii
operator Nψ:
RemNψ(G, g) = Nψ(G + g) −Nψ(G) −(DNψ(G))g.
(7.19)
Corollary 7.36. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete. For 1 ≤
s < p < ∞, the following statements hold:
(a) if ψ is a Shragin function on R × Ωand the Nemytskii operator Nψ is
Fr´echet diﬀerentiable at some G ∈Ls from Ls into Lp then there is a
function h ∈Lp such that ψ ⋍h.
(b) if F is a Borel function on R and the autonomous Nemytskii operator NF
is Fr´echet diﬀerentiable at some G ∈Ls from Ls into Lp then F must be
a constant function.
Proof. Let N be either Nψ or NF . Since N is Fr´echet diﬀerentiable at some
G from Ls into Lp and using (7.19), we have
N(G + g) −N(G)

p ≤
RemN(G, g)

p + ∥(DN(G))g∥p = O(∥g∥s)
as ∥g∥s →0, and so N is 1-H¨older at G. Thus (a) follows by Proposition 7.35.

7.3 Diﬀerentiability
355
For (b) let ψ(u, ω) ≡F(u). Then ψ is a µ-strong Shragin function on R×Ω
(with N = ∅). By part (a), Nψf = h for each f ∈L0. By Proposition 7.6
applied to φ(u, ω) := ψ(u, ω) −h(ω), (u, ω) ∈R × Ω, we have for µ-almost
all ω, ψ(u, ω) = h(ω) for each u ∈R. Since ψ(u, ω) ≡F(u), h must equal a
constant c a.e. (µ) and F ≡c, proving (b).
2
In the case 1 ≤s = p < ∞, ψ must be aﬃne in u to give a Fr´echet
diﬀerentiable operator Nψ from Ls to Lp, as will be shown in Proposition
7.39. But ﬁrst the derivative linear operator in case of diﬀerentiability of a
Nemytskii operator Nψ will be shown to be a multiplication operator M[h]
induced by some function h ∈Lr, where for 1 ≤p ≤s ≤∞with p < ∞,
r := r(s, p) :=



+∞
if s = p,
(sp)/(s −p) if p < s < ∞,
p
if s = +∞.
(7.20)
Recall that for a function h: Ω→R, the multiplication operator M[h] from
Ls into Lp induced by h takes each g ∈Ls to the pointwise product M[h](g) =
hg ∈Lp.
Lemma 7.37. Let (Ω, S, µ) be σ-ﬁnite, let 1 ≤p ≤s ≤∞with p < ∞,
and let h: Ω→R be µ-measurable. Then the following three statements are
equivalent:
(a) h ∈Lr(s,p);
(b) h induces a bounded linear multiplication operator M[h] from Ls into Lp;
(c) for any f ∈Ls, hf ∈Lp.
If these conditions hold, then the operator norm of M[h] in (b) is ∥h∥r.
If 1 ≤s < p < ∞and (Ω, S, µ) is nonatomic, then (b) and (c) are
equivalent to h = 0 in L0.
Proof. To show that (a) implies (b), ﬁrst let s < ∞. If p < s then for any
f ∈Ls, fh is µ-measurable and we have
Z
|hf|pdµ =
Z
|f|p|h|pdµ ≤
 Z
|f|sdµ
p/s Z
|h|rdµ
p/r
< ∞
(7.21)
by Lemma 7.29 with k = 2. Taking pth roots, we see that M[h] is a bounded
linear operator from Ls into Lp. If p = s and h ∈L∞, then for any f ∈Lp,
we have (∫|hf|p dµ)1/p ≤∥h∥∞∥f∥p. Similarly if s = +∞and so r = p, then
for any f ∈L∞, we have (∫|hf|p dµ)1/p ≤∥h∥p∥f∥∞. Thus (b) follows from
(a).
Clearly (b) implies (c). Suppose that (c) holds. To prove (a), ﬁrst let s <
+∞. Let fn →f in Ls and fnh →g in Lp. Taking a subsequence, we can
assume that fn →f µ-almost everywhere and thus that fnh →g a.e. (µ), so
fh = g a.e. (µ). Thus the linear multiplication operator M[h] from Ls into Lp

356
7 Nemytskii Operators on Lp Spaces
is closed, and by the closed graph theorem it is bounded, that is, its operator
norm
M := sup

∥fh∥p: ∥f∥s ≤1
	
(7.22)
is ﬁnite. For any g ∈Ls/p, let f := |g|1/p. Then f ∈Ls and

Z
g|h|pdµ
 ≤
Z
|g||h|pdµ =
Z
|fh|pdµ
≤M p(
Z
|f|sdµ)p/s = M p(
Z
|g|s/pdµ)p/s.
Thus g 7→
R
g|h|pdµ is a bounded linear functional on Ls/p. By the Riesz
representation theorem, it is of the form g 7→
R
gψ dµ for some function ψ ∈
Lr/p, or ψ ∈L∞for s = p, unique up to equality a.e. (µ). If µ({ω: ψ(ω) ̸=
|h(ω)|p}) > 0 let A ∈S with 0 < µ(A) < +∞and ψ ̸= |h|p on A. By
symmetry we can assume ψ > |h|p on A. We have 1A ∈Ls/p and ∫ψ1A dµ >
∫|h|p1A dµ, a contradiction. Thus ψ = |h|p a.e. (µ) and so h ∈Lr, proving
(a) when s < +∞. If s = +∞then (a) also holds since f := 1(·) ∈L∞, r = p,
and h = hf ∈Lr.
To prove that M = ∥h∥r holds suppose that the three conditions hold.
If p < s < +∞, by (7.21) and (7.22), we have M ≤∥h∥r. Conversely, given
h ∈Lr, let f := |h|r/s. Then f ∈Ls, ∥f∥s = ∥h∥r/s
r
, and ∥fh∥p = ∥h∥r/p
r
,
so ∥fh∥p/∥f∥s = ∥h∥r and M = ∥h∥r. If s = p, then M ≤∥h∥∞and we
get M = ∥h∥∞by considering functions fn := 1{|h|>∥h∥∞−1/n}, n →∞. If
s = +∞, then p = r and M = ∥h∥r by (7.22), since ∥1(·)∥∞= 1. So the
equality of norms is proved.
Clearly, if h = 0 a.e. (µ) then (b) and (c) hold. Conversely, suppose 1 ≤s <
p < ∞, (Ω, S, µ) is nonatomic, and (c) holds for a given h ∈L0(Ω, S, µ), not
equal to 0 a.e. (µ). Then for some δ > 0 and set A ∈S with 0 < µ(A) < ∞,
|h| ≥δ on A and so (c) holds with h replaced by δ1A and thus by 1A.
Let µA(E) := µ(E ∩A) for all E ∈S. Then clearly µA is a nonatomic
measure. By Proposition A.5 in the Appendix, there is a measurable function
G from Ωinto [0, 1] such that µA ◦G−1 is µ(A) times Lebesgue measure
on [0, 1]. We can set G(ω) = 1 for all ω in the set Ω\ A of µA-measure 0.
Let f(ω) := G(ω)−1/p1A(ω). Then f ∈Ls but f /∈Lp, a contradiction. The
lemma is proved.
2
Proposition 7.38. Let (Ω, S, µ) be σ-ﬁnite and 1 ≤p ≤s ≤∞with p < ∞.
Let G be a µ-measurable real-valued function on Ωand let ψ be a Shragin
function on R × Ω. If the Nemytskii operator Nψ is Fr´echet diﬀerentiable
at G from Ls(Ω, S, µ) into Lp(Ω, S, µ) then the derivative operator Dψ,G :=
(DNψ)(G)(·) is the multiplication operator M[h] induced by some function
h ∈Lr(Ω, S, µ), where r is deﬁned by (7.20).
Proof. Dψ,G is a bounded linear operator from Ls into Lp. Let A ∈S with
µ(A) < ∞. Let hA := Dψ,G(1A) ∈Lp. Then as t →0,

7.3 Diﬀerentiability
357
∥(Nψ(G + t1A) −NψG)/t −hA∥p →0.
(7.23)
It follows that hA(ω) = 0 for µ-almost all ω ̸∈A. If B ⊂A, we have hB(ω) =
hA(ω) for µ-almost all ω ∈B. Since µ is σ-ﬁnite, it follows that there is a
µ-measurable function h: Ω→R such that we can take hA = h1A for all
A ∈S with µ(A) < ∞. Taking t along the sequence 1/n in (7.23), and by
σ-ﬁniteness again, there is a sequence nk ↑+∞such that
nk[ψ(G(ω) + nk−1, ω) −ψ(G(ω), ω)] →h(ω)
(7.24)
for µ-almost all ω as k →∞. We can redeﬁne h(ω) as the limit of the left side
if it exists and 0 otherwise.
Let g be any µ-simple function on Ω, that is, g = Pn
i=1 ci1Ai where ci ∈R,
Ai ∈S, and µ(Ai) < ∞. Then since Dψ,G is linear, we have Dψ,G(g) = hg.
Now take any g ∈Ls(Ω, S, µ) and take µ-simple gn →g in Ls. We have
Dψ,G(gn) = hgn for all n and Dψ,G(gn) →Dψ,G(g) in Lp. Taking a sub-
sequence, we can assume that gn →g and Dψ,G(gn) = hgn →Dψ,G(g)
hold µ-almost everywhere. Thus Dψ,G(g) = hg a.e. (µ). It follows that
Dψ,G(g) = M[h](g) ∈Lp for each g ∈Ls, and so h ∈Lr by (b) ⇒(a) of
Lemma 7.37.
2
Now we can show that for Nψ to be Fr´echet diﬀerentiable from an Lp space
to itself, ψ must have an aﬃne form in u, up to equivalence in the sense of
Deﬁnition 7.7.
Proposition 7.39. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete, let 1 ≤
p < ∞, and let ψ be a Shragin function. If the Nemytskii operator Nψ is
Fr´echet diﬀerentiable at some G ∈Lp(Ω, S, µ) from Lp into Lp, then for some
ξ ∈Lp and h ∈L∞, ψ ⋍η where η(u, ω) := ξ(ω) + h(ω)u, (u, ω) ∈R × Ω.
Proof. Suppose that Nψ is Fr´echet diﬀerentiable at G ∈Lp from Lp into Lp.
By Proposition 7.38 with s = p, there is an h ∈L∞such that (DNψG)(f) =
hf a.e. (µ) for each f ∈Lp. For (u, ω) ∈R × Ω, let φ(u, ω) := ψ(G(ω) +
u, ω) −ψ(G(ω), ω) −h(ω)u. Then φ is a Shragin function on R × Ωand
∥Nφg∥p = ∥RemNψ(G, g)∥p = o(∥g∥p) as ∥g∥p →0. By Proposition 7.33(b)
with α = 1 and s = p, we must have φ ⋍0, and so Nφf = 0 a.e. (µ)
for each f ∈L0. Let ξ := NψG −hG ∈Lp and f ∈L0. Then Nψf ≡
Nφ(f−G)+(NψG−hG)+hf = ξ+hf = Nηf a.e. (µ), proving the proposition.
2
Proposition 7.41 will give suﬃcient conditions for Fr´echet diﬀerentiability
of an autonomous Nemytskii NF operator from Ls into Lp with p < s. The
following gives necessary conditions. Let F be a u.m. function from R into R
and let ν be a ﬁnite Borel measure on R. Then F will be said to be diﬀer-
entiable in ν-measure if there exists a measurable function η from R into R

358
7 Nemytskii Operators on Lp Spaces
such that (F(y + t) −F(y))/t →η(y) in ν-measure as t →0, and then we will
write D(ν)F = η, deﬁned up to equality a.e. (ν).
Theorem 7.40. Let (Ω, S, µ) be σ-ﬁnite and complete. Let G: Ω→R be
µ-measurable and let F : R →R be Borel measurable. Let 1 ≤p < s ≤∞.
If the autonomous Nemytskii operator NF is Fr´echet diﬀerentiable at G from
Ls(Ω, S, µ) into Lp(Ω, S, µ), then:
(a) the derivative operator DF,G := (DNF )(G)(·) must be the multiplication
operator M[h] induced by some function h ∈Lr(Ω, S, µ), where h can be
taken as η ◦G for some Borel measurable function η, and r is deﬁned by
(7.20);
(b) if µ is ﬁnite and ν is the image measure µ ◦G−1 on R, then F must be
diﬀerentiable in ν-measure with η = D(ν)F.
Proof. Since F is Borel, ψ(u, ω) ≡F(u) is a Shragin function, and so by
Proposition 7.38, the derivative operator DF,G is multiplication by some func-
tion h ∈Lr. As in (7.24), there is a sequence nk ↑+∞such that
h(ω) = lim
k→∞nk

F(G(ω) + n−1
k ) −F(G(ω))

for µ-almost all ω. We can take h(ω) to be the limit if it exists and 0 otherwise.
Then h is G−1(B) := {G−1(B): B ∈B} measurable. It then follows that
h = η ◦G for some Borel measurable function η, e.g. by [53, Theorem 4.2.8]
with X = Ω, Y = R, T = G, and f = h. So (a) is proved.
For (b), if µ is ﬁnite and X is the identity function on R, then it follows
easily that γ 7→F ◦(X+γ) is Fr´echet diﬀerentiable at γ = 0 from Ls(R, B, ν) to
Lp(R, B, ν), setting g := γ ◦G and applying the image measure theorem, e.g.
[53, Theorem 4.1.11], twice. Then, to see that F is diﬀerentiable in ν-measure
with D(ν)F = η, let γ →0 through constants. Theorem 7.40 is proved.
2
A natural question is whether, under the conditions of the previous theo-
rem, the ordinary derivative F ′ exists ν-almost everywhere. Examples will be
given in Proposition 7.63 of Section 7.5 showing that it may not.
Recall the classes Gβ and Γβ of functions satisfying growth conditions,
deﬁned in (7.2) and in (7.3), respectively, and the classes Hloc
1
of functions
that are 1-H¨older locally on R, as deﬁned in Deﬁnition 6.4. We will say that a
function f deﬁned almost everywhere for µ is in Lr(Ω, S, µ) if f = g a.e. (µ)
for some g ∈Lr(Ω, S, µ).
Proposition 7.41. Let (Ω, S, µ) be a ﬁnite complete measure space, and let
1 ≤p < s < ∞. Let F ∈Hloc
1
, F ′ ∈Γ(s/p)−1 and let G ∈Ls(Ω, S, µ). If
F ′◦G exists a.e. (µ), then F ′◦G ∈Lr(Ω, S, µ) with r deﬁned by (7.20), the
autonomous Nemytskii operator NF is Fr´echet diﬀerentiable at G from Ls
into Lp, and DNF (G) = M[F ′◦G].

7.3 Diﬀerentiability
359
The proof of this proposition will use the following measurability fact.
Lemma 7.42. Let F be a real-valued Borel function on R, and let D be the
set of all x ∈R such that F is diﬀerentiable at x. Then D is u.m. (universally
measurable) and for each m = 1, 2, . . . , there is a u.m. function D ∋x 7→
δ(x, m) > 0 such that for each t ∈R with |t| < δ(x, m),
F(x + t) −F(x) −F ′(x)t
 < |t|/m.
Proof. For x, s, t ∈R such that s ̸= 0 and t ̸= 0, let
Q(F; x, s, t) :=
F(x + t) −F(x)
t
−F(x + s) −F(x)
s
.
For k = 1, 2, . . ., and m = 1, 2, . . ., let
Bk,m := Bk,m(F)
:=

(x, s, t) ∈R3 : 0 < |s| < 1/k, 0 < |t| < 1/k, Q(F; x, s, t) > 1/m
	
.
Since F is Borel measurable, each Bk,m is a Borel set in R3. For y := (x, s, t) ∈
R3, let π1(y) := x and let Ak,m := {π1(y): y ∈Bk,m}. Then each Ak,m is
analytic and so a u.m. set in R (e.g. [53, Theorem 13.2.6]), and Ak,m decreases
as k increases. The complement Ac
k,m, that is the set of all x ∈R such that
0 < |s| < 1/k and 0 < |t| < 1/k implies Q(F; x, s, t) ≤1/m, also is a u.m.
set. Now F is diﬀerentiable at x if and only if x ∈D := T∞
m=1
S∞
k=1 Ac
k,m.
Thus D is a u.m. set. For any x ∈D and each m = 1, 2, . . . , there is a least
k = k(x, m) such that x ∈Ac
k,m. The function D ∋x 7→k(x, m) is u.m. for
each m since k(x, m) = k if and only if x ∈Ac
k,m ∩Ak−1,m, where A0,m := R,
for k = 1, 2, . . . . Letting δ(x, m) := 1/k(x, m) for x ∈D and m = 1, 2, . . .
completes the proof of the lemma.
2
Proof of Proposition 7.41. Since F ∈Hloc
1
, it is locally absolutely con-
tinuous and is an indeﬁnite integral of F ′ (e.g. Theorem 8.18 and Example
8.20 in [198]). Thus F ∈Gs/p, and so NF acts from Ls into Lp by Theorem
7.13(a). Notice that r = (sp)/(s−p) > p ≥1 and s/r = (s/p)−1. Since there
is a K < ∞such that |F ′◦G| ≤K(1(·) + |G|s/r) whenever F ′◦G is deﬁned,
by Lemma 7.9, and so a.e. (µ), by the Minkowski inequality for integrals (e.g.
[53, Theorem 5.1.5]), we have
F ′◦G

r ≤K∥1(·) + |G|s/r∥r ≤K
 µ(Ω)1/r + ∥G∥s/r
s

< ∞.
Thus M[F ′◦G] is a bounded linear operator from Ls into Lp by Lemma 7.37.
Let N be a µ-null set such that F ′(G(ω)) exists for each ω ∈Ω\N. For u ∈R,
let
ψ(u, ω) := F(G(ω) + u) −F(G(ω)) −F ′(G(ω))u

360
7 Nemytskii Operators on Lp Spaces
if ω ∈Ω\ N and ψ(u, ω) := 0 if ω ∈N. Then the Nemytskii operator Nψ
acts from Ls into Lp. To prove that NF is Fr´echet diﬀerentiable at G with
derivative M[F ′◦G] we need to show that
∥Nψg∥p = o(∥g∥s)
as
∥g∥s →0.
(7.25)
Let ǫ = 1/m for some m = 1, 2, . . ., and let δ(·, m) be the function from
Lemma 7.42. If ω ∈Ω\ N, let δG(ω) := δ(G(ω), m), and let δG(ω) := 1 if
ω ∈N. Then for each ω ∈Ω, |ψ(u, ω)| ≤ǫ|u| whenever |u| < δG(ω). For
each g ∈Ls, let A := A(g) := {ω: |g(ω)| < δG(ω)} and write Nψ(g) =
R1(g) + R2(g) + R3(g), where R1(g) := Nψ(g)1A, R2(g) := (F ′◦G)g1Ac and
R3(g) := [F◦(G + g) −F◦G]1Ac. For R1, we have
∥R1(g)∥p ≤ǫ∥g∥p ≤ǫ∥g∥sµ(Ω)1/r
(7.26)
by Lemma 7.37. For R2, using the same lemma we have
∥R2(g)∥p ≤∥g∥s∥(F ′◦G)1Ac∥r = o(∥g∥s)
(7.27)
as ∥g∥s →0, because in this case µ(Ac) →0, and so ∥(F ′◦G)1Ac∥r →0 by
dominated convergence. Turning to R3, for each ω ∈Ω, since t 7→F(G(ω) +
tg(ω)) is Lipschitz and so absolutely continuous on 0 ≤t ≤1, we have
F(G(ω) + g(ω)) −F(G(ω)) = g(ω)
Z 1
0
F ′((G + tg)(ω)) dt.
Thus by Lemma 7.37, we have
R3(g)

p ≤∥g∥s
 Z
Ac

Z 1
0
F ′◦(G + tg) dt

r
dµ
1/r
.
(7.28)
Applying H¨older’s inequality (e.g. Lemma 7.29 with k = 2), the β growth
condition with β = s/r = (s/p)−1 and the Minkowski inequality for integrals
twice, we get
 Z
Ac

Z 1
0
F ′◦(G + tg) dt

r
dµ
1/r
≤
 Z 1
0
Z
Ac
F ′◦(G + tg)
rdµ dt
1/r
≤K
 Z
Ac
1(·) +
 |G| + |g|)s/r
r
dµ
1/r
≤K
n
µ(Ac)1/r +
 ∥G1Ac∥s + ∥g∥s
s/ro
= o(1)
as ∥g∥s →0, where K := ∥F ′∥Gs/r. This together with (7.28) yields that
∥R3(g)∥p = o(∥g∥s) as ∥g∥s →0. Letting ǫ ↓0, by (7.26) and (7.27), we see
that (7.25) holds, ﬁnishing the proof.
2

7.3 Diﬀerentiability
361
Proposition 7.43. Let F be a u.m. function from R into R and ν a ﬁnite
Borel measure on R.
(a) If the derivative F ′(x) exists for ν-almost all x, then a derivative in mea-
sure D(ν)F exists and equals F ′(x) for ν-almost all x.
(b) If ν has an atom at a point x, so that ν({x}) > 0, and D(ν)F exists, then
F ′(x) exists and equals D(ν)F(x).
Proof. For (a), the set DF := {x: F ′(x) exists } is u.m. by Lemma 7.42 and
ν(R \ DF ) = 0. Let η(x) := F ′(x) for x ∈DF and η(x) := 0 otherwise. Then
since pointwise convergence a.e. (ν) implies convergence in ν-measure, η is a
derivative of F in ν-measure, and any other function ρ satisfying the deﬁnition
of D(ν)F must equal η and therefore F ′(x) for ν-almost all x.
For (b), let ν({x}) > 0 and η = D(ν)F. Convergence in measure implies
pointwise convergence at an atom, so F ′(x) must exist and equal D(ν)F(x).
2
Corollary 7.44. If F : R →R is everywhere diﬀerentiable, then for every
ﬁnite Borel measure ν on R, D(ν)F exists and can be taken equal to F ′.
Proof. Since F ′(x) exists for all x, F is continuous and so Borel measurable
and u.m. The rest follows from Proposition 7.43(a).
2
Proposition 7.45. Let (Ω, S, µ) be ﬁnite and complete, let 1 ≤p < s < ∞,
and let F : R →R be diﬀerentiable everywhere. The following statements are
equivalent:
(a) F ′ ∈G(s/p)−1;
(b) the autonomous Nemytskii operator NF is everywhere diﬀerentiable from
Ls into Lp and DNF(G) = M[F ′◦G] for each G ∈Ls.
Proof. Assuming (a), since F ′ is locally bounded, F ∈Hloc
1
by the mean
value theorem of calculus. Since Gβ ⊂Γβ and F ′◦G is deﬁned a.e. (µ) for each
G ∈Ls, (b) follows from Proposition 7.41.
Suppose that (b) holds. Then for r = sp/(s −p), F ′◦G ∈Lr for each
G ∈Ls by Lemma 7.37, and so F ′ ∈G(s/p)−1 by Theorem 7.13(b) with r
instead of p. Thus (a) holds, proving the proposition.
2
Proposition 7.46. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, and 1 ≤
p < s < ∞. Let a Borel measurable F : R →R be such that the autonomous
Nemytskii operator NF acts from Ls into Lp. If NF is Fr´echet diﬀerentiable
on a nonempty open set V , then F is everywhere diﬀerentiable on R, it is
locally Lipschitz with F ′ ∈G(s/p)−1, NF is Fr´echet diﬀerentiable on all of Ls,
and the derivative operator DNF(G)(·) at any G ∈Ls is the multiplication
operator M[F ′◦G](·) induced by the function F ′◦G, which is in Lr with r
deﬁned by (7.20).

362
7 Nemytskii Operators on Lp Spaces
Proof. To show that F is diﬀerentiable, let u ∈R and let G ∈V . For A ∈S
with µ(A) > 0, let f : Ω→R be such that f = u on A and f = G elsewhere.
Since µ is nonatomic, by Proposition A.1, one can choose A such that f ∈V ,
and so NF is Fr´echet diﬀerentiable at f. Since µ◦f −1 has an atom at u,
F ′(u) exists by Theorem 7.40 and Proposition 7.43(b). Since u is arbitrary,
F is diﬀerentiable everywhere. By Theorem 7.40 and Corollary 7.44, for each
f ∈V , the derivative operator DNF (f) equals M[F ′◦f] and F ′◦f ∈Lr with
r = (sp)/(s −p) as in (7.20). Thus by Theorem 7.13(b) with r instead of p,
F ′ ∈G(s/p)−1.
By Proposition 7.21(a), NF acts from Ls into Lp. To show that NF is
Fr´echet diﬀerentiable on all of Ls, let G ∈V and let ρ > 0 be such that
G + Bρ ⊂V , where Bρ = {f ∈Ls : ∥f∥s < ρ}. For (u, ω) ∈R × Ω, let
φ(u, ω) := F(G(ω) + u) −F(G(ω)).
Then φ is a Shragin function on R × Ωand the Nemytskii operator Nφ acts
from Ls into Lp. Recalling Deﬁnition 6.8 of φ(1)
u , we have
Nφ(g0 + g) −Nφ(g0) −Nφ(1)
u (g0)g
= NF (G + g0 + g) −NF (G + g0) −F ′◦(G + g0)g
(7.29)
for any g0, g ∈Ls. Let g0 ∈Bρ and let g ∈Ls be such that ∥g∥< ρ −∥g0∥,
and so g0 + g ∈Bρ. Then G + g0 ∈V , G + g0 + g ∈V , and so by (7.29)
∥Nφ(g0 + g) −Nφ(g0) −Nφ(1)
u (g0)g∥p
= ∥RemNF (G + g0, g)∥p = o(∥g∥s)
(7.30)
as ∥g∥s →0, where the remainder RemNF is deﬁned as in (7.19). Thus Nφ is
Fr´echet diﬀerentiable at g0 ∈Bρ and the derivative operator DNφ(g0)(·) is the
multiplication operator from Ls into Lp induced by Nφ(1)
u (g0) = F ′◦(G + g0).
To show that the derivative operator DNF extends from V to all of Ls, let
f ∈Ls be such that f ̸∈G + Bρ, and so ∥f −G∥s ≥ρ. By Proposition
A.9 with h = f −G and c = ρ/2, there exists a partition {Ai}m
i=0 of Ωinto
measurable sets such that ∥(f −G)1Ai∥s ≤ρ/2 for i = 0, . . . , m. For g ∈Ls
such that ∥g∥s < ρ/2, by (7.29) with g0 = f −G, we have
∥NF(f + g) −NF (f) −(F ′◦f)g∥p
p
= ∥Nφ((f −G) + g) −Nφ(f −G) −Nφ(1)
u (f −G)g∥p
p
=
m
X
i=0
∥RemNφ((f −G)1Ai, g1Ai)∥p
p = o(∥g∥p
s)
as ∥g∥s →0 by (7.30) with g0 = (f −G)1Ai and with g1Ai instead of g.
Thus NF is Fr´echet diﬀerentiable on all of Ls and the derivative operator
DNF (f)(·) at f ∈Ls is the multiplication operator M[F ′◦f](·) induced by

7.3 Diﬀerentiability
363
the function F ′◦f ∈Lr with r deﬁned by (7.20). The proof of the proposition
is complete.
2
Corollary 7.47. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, and 1 ≤
p < s < ∞. Let a Borel measurable F : R →R be such that the autonomous
Nemytskii operator NF acts from Ls into Lp. The following statements are
equivalent:
(a) NF is Fr´echet diﬀerentiable on a nonempty open set V in Ls;
(b) NF is Fr´echet diﬀerentiable everywhere on Ls, F is diﬀerentiable every-
where on R, and for each G ∈Ls, DNF (G) = M[F ′◦G];
(c) F is diﬀerentiable everywhere on R and F ′ ∈G(s/p)−1.
Proof. Statement (b) and thus (a) follow from (c) by the implication (a) ⇒(b)
of Proposition 7.45. By Proposition 7.46, (a) implies (b). Then (b) implies (c)
since (b) implies (a) in Proposition 7.45, proving the corollary.
2
By Theorem 7.24 and Proposition 7.28, the autonomous Nemytskii oper-
ator NF has a H¨older property at G of optimal order s/[p(1 + s)] from Ls
into Lp, uniformly for ∥F∥(p) ≤1, if and only if G ∈Dλ, that is, µ◦G−1 has
a bounded density with respect to Lebesgue measure λ. Such G are dense
in Ls(Ω, S, µ) for any nonatomic measure space (Ω, S, µ) by Proposition A.6.
One might ask whether Proposition 7.46 extends to F such that NF is Fr´echet
diﬀerentiable at all such G. The answer is negative: F need not be locally Lip-
schitz, as the following proposition shows for α < 1.
Proposition 7.48. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, let 1 ≤
p < s < ∞, let Fα(u) ≡|u|α with 0 < α ≤1, and let G ∈Dλ ∩Ls.
If α > 1 + (1/s) −(1/p), then the autonomous Nemytskii operator NFα is
Fr´echet diﬀerentiable at G from Ls into Lp, and there is a constant K < ∞
such that for each g ∈Ls with ∥g∥s ≤1,
RemN(G, g)∥p ≤K∥g∥β
s,
(7.31)
where N = NFα and β := [α + (1/p)]s/(1 + s) > 1.
Proof. Since Fα ∈Gα ⊂Gs/p, NFα acts from Ls into Lp by Theorem 7.13(a).
For u ̸= 0, |F ′
α(u)| = α|u|α−1, and F ′
α(u) is undeﬁned for u = 0. Let ξG be a
density of µ◦G−1 and let M := ∥ξG∥∞< ∞. If α < 1, by the image measure
theorem, we have for any r > 0,
Z
Ω
|F ′
α◦G|r dµ = αr
Z
R
|x|(α−1)rξG(x) dx
≤αrµ({ω: |G(ω)| ≥1}) + αrM
Z
{|x|≤1}
|x|(α−1)r dx.

364
7 Nemytskii Operators on Lp Spaces
For r := (sp)/(s −p), (α −1)r > −1, and the right side is ﬁnite since µ
is ﬁnite. If α = 1, then the left side is ﬁnite since µ is ﬁnite and F ′
1 =
±1(·). Thus F ′
α◦G ∈Lr, and so D(g) := (F ′
α◦G)g ∈Lp for each g ∈Ls
by Lemma 7.37. Also, for each g ∈Ls, let ∆(g) := Fα◦(G + g) −Fα◦g
and R(g) := ∆(g) −D(g). We will show that for a ﬁnite constant K < ∞,
∥R(g)∥p ≤K∥g∥β
s for each g ∈Ls such that ∥g∥s ≤1. From this bound it will
follow that NFα is Fr´echet diﬀerentiable at G from Ls into Lp, the derivative
operator DNFα(G)(g) equals D(g), and the stated bound (7.31) holds.
We have 1/p = (1/r) + (1/s) and r ≥p ≥1. Let ρ := s/(1 + s) and
ǫ := ǫ(g) := ∥g∥ρ
s ≤1. Thus β = ρ[α + (1/p)]. Also, let



A := {ω: |G(ω)| ≤ǫ},
B := {ω: |G(ω)| > ǫ, |g(ω)| > ǫ/2},
C := {ω: |G(ω)| > ǫ, |g(ω)| ≤ǫ/2},
and











T1 := ∥∆(g)1A∥p,
T2 := ∥D(g)1A∥p,
T3 := ∥∆(g)1B∥p,
T4 := ∥D(g)1B∥p,
T5 := ∥R(g)1C∥p.
Thus ∥R(g)∥p ≤P5
i=1 Ti. To bound T1, we have µ(A) = ∫{|x|≤ǫ} ξG(x) dx ≤
2Mǫ = 2M∥g∥ρ
s, where M = ∥ξG∥∞. Since |Fα(u) −Fα(v)| ≤|u −v|α for all
u, v ∈R, by Lemma 7.29 with k = 2 it then follows that
T1 ≤
 Z
Ω
|g|αp1A dµ
1/p
≤∥g∥α
s µ(A)(1/p)−(α/s) ≤K1∥g∥β
s,
(7.32)
where K1 := (2M)(1/p)−(α/s). For T2 and α < 1, since ∥ξG∥∞= M, we have
Z
A
F ′
α◦G
r dµ = αr
Z
{|x|≤ǫ}
|x|r(α−1)ξG(x) dx ≤
2αrM
r(α −1) + 1∥g∥[r(α−1)+1]ρ
s
.
Thus by Lemma 7.29 with k = 2, we have
T2 ≤∥g∥s
(F ′
α◦G)1A

r ≤K2∥g∥β
s
for a constant K2 = K2(α, r, M). The same holds when α = 1. For T3, since
ǫ = ∥g∥ρ
s, we have
µ(B) ≤µ({ω: |g(ω)| > ǫ/2}) ≤(2/ǫ)s∥g∥s
s = 2s∥g∥ρ
s.
(7.33)
Thus as in (7.32), we get the bound
T3 ≤
 Z
Ω
|g|αp1B dµ
1/p
≤∥g∥α
s µ(B)(1/p)−(α/s) ≤K3∥g∥β
s,
where K3 := 2(s/p)−α. For T4 and α < 1, we have
Z
B
|F ′
α◦G|rdµ = αr
Z
B∩{|G|<1}
|G|r(α−1) dµ + αr
Z
B∩{|G|≥1}
|G|r(α−1) dµ

7.3 Diﬀerentiability
365
≤αrh
ǫr(α−1) + 1
i
µ({ω: |g(ω)| > ǫ/2}) ≤αr2sh
∥g∥[r(α−1)+1]ρ
s
+ ∥g∥ρ
s
i
by the second inequality and the equality in (7.33). Thus by Lemma 7.29 with
k = 2, it follows that
T4 ≤∥g∥s
(F ′
α◦G)1B

r ≤α2s/rh
∥g∥1+[α−1+(1/r)]ρ
s
+ ∥g∥1+ρ/r
s
i
≤K4∥g∥β
s
since ∥g∥s ≤1 and 1 + ρ/r > β, where K4 := α21+s/r. For α = 1, since
|F ′
1| = 1(·), by Lemma 7.29 with k = 2 and (7.33), we have
T4 ≤∥g∥sµ(B)1/r ≤2s/r∥g∥1+ρ/r
s
≤K4∥g∥β
s ,
where K4 := 2s/r. Finally, for T5, by Taylor’s theorem with remainder, for
each x, y ∈R such that |x| > ǫ and |y| ≤ǫ/2, we have
Fα(x + y) −Fα(x) −F ′
α(x)y
 ≤y2
2
sup
0≤t≤1
F ′′
α(x + ty)
.
For α = 1, the left side is zero, and so we can assume that α < 1. It then
follows that for each ω ∈C,
|R(g)(ω)| ≤α(1 −α)
2

g(ω)
2 sup
0≤t≤1
G(ω) + tg(ω)
α−2
≤α(1 −α)ǫ2
8

|G(ω)| −ǫ/2
α−2.
Since ǫ = ∥g∥ρ
s ≤1 and ∥ξG∥∞= M, we have
 Z
{ǫ≤|G|<1}

|G| −ǫ/2
p(α−2) dµ
1/p
=
 Z
{ǫ≤|x|≤1}

|x| −ǫ/2
p(α−2)ξG(x) dx
1/p
≤
 2(2−α)pM
p(2 −α) −1
1/p
∥g∥ρ[α−2+(1/p)]
s
.
Thus, splitting the integration in T5 over C ∩{|G| ≥1} and C ∩{|G| < 1}, it
follows that
T5 ≤α(1 −α)
8
"
2α−2µ(Ω)1/p∥g∥2ρ
s +
 2(2−α)pM
p(2 −α) −1
1/p
∥g∥β
s
#
≤K5∥g∥β
s ,
since ∥g∥s ≤1 and 2ρ > β, for a suitable constant K5. Summing the bounds of
Ti, i = 1, . . . , 5, it follows that for K := P5
i=1 Ki, ∥R(g)∥p ≤K∥g∥β
s whenever
∥g∥s ≤1. The proof of the proposition is complete.
2

366
7 Nemytskii Operators on Lp Spaces
The following shows that the order of the remainder bound (7.31) cannot
be improved in general.
Proposition 7.49. Let (Ω, S, µ) = ([0, 1], B, λ), 1 ≤p < s < ∞, Fα(u) ≡
|u|α, u ∈R, with 0 < α < ∞and G(x) ≡x, x ∈[0, 1]. If the autonomous
Nemytskii operator NFα is Fr´echet diﬀerentiable at G from Ls into Lp, and
there are constants K < ∞, 0 < ρ ≤1 such that (7.31) holds for all g ∈Ls
with ∥g∥s ≤ρ, then β ≤[α + (1/p)]s/(1 + s).
Proof. By Theorem 7.40, we have that the derivative operator (DNFα)(G) =
M[(D(λ)Fα)◦G], where we take D(λ)Fα(u) = α|u|α/u for u ̸= 0 by Proposition
7.43(a). Thus for each g ∈Ls, we have
R(g) := RemNFα(G, g) = Fα◦(G + g) −Fα◦G −[(D(λ)Fα)◦G]g.
For δ > 0, let gδ(x) := −2x1[0,δ](x), x ∈[0, 1]. Then ∥gδ∥s = 2δ1+(1/s)/(1 +
s)1/s and |R(gδ)| = 2αFα1[0,δ]. Thus there is a constant C = C(α, s, p) < ∞
such that for each δ > 0,
∥R(gδ)∥p = 2αδα+(1/p)/(1 + αp)1/p = C∥gδ∥[α+(1/p)]s/(1+s)
s
.
Since ∥gδ∥s →0 as δ ↓0, the stated conclusion follows.
2
The next fact shows that the suﬃcient lower bound for α in Proposition
7.48 is necessary:
Proposition 7.50. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete, let 1 ≤
p < s < ∞, and let Fα(u) ≡|u|α, u ∈R, for some α > 0. Let G ∈Dλ ∩Ls be
such that for some C > 0 and δ > 0, ξG(x) ≥C for all x ∈[−δ, δ]. Such G
exist. If the autonomous Nemytskii operator NFα is Fr´echet diﬀerentiable at
G from Ls into Lp, then 1 + (1/s) −(1/p) < α ≤s/p.
Proof. Functions G satisfying the hypotheses exist by Proposition A.5. The
interval (1 + (1/s) −(1/p), s/p] is nonempty if and only if s > p. Since NFα
acts from Ls into Lp by Proposition 7.31 and Fα ̸∈Gβ for β < α, we have
α ≤s/p by Theorem 7.13(c). If α ≥1, then the proof is complete. Suppose
that α < 1. By Theorem 7.40, the derivative operator (DNFα)(G) equals
M[(D(λ)Fα)◦G], where D(λ)Fα(u) = α|u|α/u if u ̸= 0 by Proposition 7.43(a).
Letting r := (sp)/(s −p), by Lemma 7.37, (D(λ)Fα)◦G ∈Lr. Thus by the
image measure theorem, we have
∞>
Z
Ω
|D(λ)Fα◦G|r dµ ≥αr
Z
|x|≤δ
|x|(α−1)rξG(x) dx ≥2Cαr
Z δ
0
x(α−1)r dx,
and the conclusion follows.
2

7.3 Diﬀerentiability
367
The following is a consequence of Propositions 7.48 and 7.50:
Corollary 7.51. Let (Ω, S, µ) be nonatomic, ﬁnite, and complete, let 1 ≤
p < s < ∞, and let Fα(u) ≡|u|α, u ∈R, for some 0 < α < 1. The following
statements are equivalent:
(a) for each G ∈Dλ ∩Ls, the autonomous Nemytskii operator NFα is Fr´echet
diﬀerentiable at G from Ls into Lp;
(b) [α + (1/p)]s/(1 + s) > 1.
The following applies if F is the distribution function P((−∞, x]) of a
probability measure P with support in [a, b] and density in Hβ([a, b]; R). Recall
Deﬁnition 6.5 of the class H1+β.
Proposition 7.52. Let (Ω, S, µ) be a ﬁnite measure space, −∞< a < b <
∞, 1 ≤p < s < ∞, and
β := s(1 + p)
p(1 + s) −1 =
s −p
p(1 + s).
Let F : R →R be a function whose restriction to [a, b] is in H1+β([a, b]; R),
F(x) = F(a) for all x ≤a, and F(x) = F(b) for all x ≥b. Let G be a
measurable function from Ωinto [a, b] such that for some K < ∞,
(µ◦G−1)
 [a, a + x] ∪[b −x, b]

≤Kx
(7.34)
for all x ≥0. Then the autonomous Nemytskii operator NF acts from Ls into
Lp, it is Fr´echet diﬀerentiable at G, and the remainder in the diﬀerentiation
has the bound
∥RemNF (G, g)∥p = O(∥g∥1+β
s
)
(7.35)
as ∥g∥s →0.
Proof. Clearly 0 < β < 1. Since F is bounded and µ is ﬁnite, NF acts from
Ls into Lp. To prove its Fr´echet diﬀerentiability at G we can assume a = 0
and b = 1, possibly changing K in (7.34). If h is such that G + h has values
in [0, 1] then by the mean value theorem of calculus
|RemNF (G, h)| = |F ′◦(G + th) −F ′◦G|·|h| ≤∥F ′∥(Hα)|h|1+β
for a variable t with 0 ≤t ≤1. Then by H¨older’s inequality (e.g. Lemma 7.29
with k = 2),
Z
Ω
|RemNF (G, h)|p dµ ≤∥F ′∥p
(Hα)µ(Ω)1−p(1+β)/s∥h∥(1+β)p
s
.
(7.36)
Now let g be any function in Ls(Ω, S, µ). Let A := {G + g ≤0}, B := {0 <
G+g < 1}, and C := {G+g ≥1}. Let g1 := 1A·(G+g), g3 := 1C·(G+g −1),
and g2 := g −g1 −g3. Then we have G + g2 = max{0, min{G + g, 1}},
∥g1∥s ≤∥g∥s, and ∥g3∥s ≤∥g∥s. Thus by (7.36) for h = g2,

368
7 Nemytskii Operators on Lp Spaces
∥RemNF (G, g2)∥p ≤C1∥g2∥1+β
s
≤31+βC1∥g∥1+β
s
(7.37)
for some constant C1. We have G + g2 = G + g −g1 ≡0 on A and G + g2 =
G + g −g3 ≡1 on C. Thus F◦(G + g) ≡F◦(G + g2), on A since F(y) = F(0)
for y ≤0, on C since F(y) = F(1) for y ≥1, and on B since g2 = g there. It
follows that
RemNF (G, g) = RemNF (G, g2) −(F ′◦G)·(g1 + g3).
(7.38)
Again by H¨older’s inequality,
Z
Ω
|g1|p dµ =
Z
A
(−G −g)p dµ ≤∥g∥p
sµ(A)1−p/s.
(7.39)
For any δ > 0, let m := sup{µ(A): ∥g∥s ≤δ}. On A we have 0 ≥−G ≥g.
If we replace g by −G on A, then ∥g∥s is not increased and A is unchanged.
Thus in ﬁnding m we can assume g = −G on A. Then, m is attained by
µ(A) under the constraint ∫A Gs dµ ≤δs when A is a set such that for some
t ≥0, {G < t} ⊂A ⊂{G ≤t} by the Neyman–Pearson lemma (e.g. Lehmann
[137, Theorem 3.1, p. 74]), applied to µ and Gsµ normalized to be probability
measures. Let µA(E) := µ(A ∩E) for all E ∈S, ν := µA◦G−1, and L(x) :=
ν([0, x]). Then ∫A Gs dµ = ∫t
0 xs dL(x) and L(t) = µ(A). We can assume that
t is the (unique) smallest number for which the latter holds. For all x ≥0,
we have L(x) ≤Kx by (7.34) and so L(x) ≤min{Kx, µ(A)}. Integrating by
parts, and then writing ∫t
0 = ∫µ(A)/K
0
+ ∫t
µ(A)/K, it follows that
∥g∥s
s ≥
Z t
0
xs dL(x) = tsµ(A) −
Z t
0
L(x)sxs−1 dx ≥µ(A)1+s/Ks(1 + s).
Thus µ(A) ≤C2∥g∥s/(1+s)
s
for some constant C2. By (7.39) we then have the
bound
∥g1∥p ≤C(s−p)/ps
2
∥g∥1+β
s
.
The function g3 and the set C can be treated symmetrically, interchanging G
with 1 −G and g with −g, giving the same bound. Thus
∥(F ′◦G)(g1 + g3)∥p ≤2∥F ′∥supC(s−p)/sp
2
∥g∥1+β
s
.
This together with (7.37) and (7.38) yields Fr´echet diﬀerentiability with the
remainder bound (7.35), proving the proposition.
2
7.4 Higher Order Diﬀerentiability and Finite Taylor
Series
The kth order diﬀerential of an autonomous Nemytskii operator from Ls to Lp
will be shown under some conditions to be a k-linear multiplication operator
M k[h] induced by a function h ∈Lrk, where for 1 ≤p ≤kp ≤s < ∞,

7.4 Higher Order Diﬀerentiability and Finite Taylor Series
369
rk := rk(s, p) := (sp)/(s −kp),
(7.40)
deﬁned as +∞if kp = s. (This was already done when k = 1 in Deﬁnition
7.20 of r(s, p) ≡r1(s, p).)
Recall that for a function h: Ω→R and a positive integer k, if for any
g1, . . . , gk ∈Ls, the pointwise product M k[h](g1, . . . , gk) = hg1 · · · gk is in Lp,
then M k[h] is the k-linear multiplication operator from (Ls)k := Ls ×· · ·×Ls
(k times) into Lp induced by h. The following extends Lemma 7.37 to k-linear
multiplication operators.
Lemma 7.53. Let (Ω, S, µ) be σ-ﬁnite, let h: Ω→R be µ-measurable, let k
be a positive integer, and let 1 ≤p ≤kp ≤s < ∞. Then the following three
statements are equivalent:
(a) for any g1, . . . , gk ∈Ls, hg1 · · · gk ∈Lp;
(b) h induces a bounded k-linear multiplication operator M k[h] from (Ls)k
into Lp;
(c) h ∈Lrk with rk deﬁned by (7.40).
If these conditions hold, then the operator norm of M k[h] in (b) is ∥h∥rk.
If 1 ≤s < kp and (Ω, S, µ) is nonatomic, then (a) and (b) are equivalent
to h = 0 in L0.
Proof. Clearly (b) implies (a). To show that (a) implies (c), take any f ∈Ls/k.
Let g1 = g2 = · · · = gk = |f|1/k ∈Ls. By (a), h|f| ∈Lp, and so hf ∈Lp. It
follows by Lemma 7.37 with s/k in place of s that h ∈Lrk, i.e. (c) holds.
To show that (c) implies (b), we apply Lemma 7.29 with k + 1 instead of
k, pj = s for j = 1, . . . , k, and pk+1 = rk. By (7.16), it follows that
∥M k[h]∥= sup

∥M k[h](g1, . . . , gk)∥p : ∥gj∥s ≤1, j = 1, . . . , k
	
≤∥h∥rk,
completing the equivalence proof. To prove the reverse inequality let h ∈Lrk
and gj := |h|rk/s/∥h∥rk/s
rk
for j = 1, . . . , k. Then gj ∈Ls, ∥gj∥s = 1, and
∥M k[h](g1, . . . , gk)∥p = ∥h∥rk, completing the proof for kp ≤s.
If kp > s and (Ω, S, µ) is nonatomic, then h = 0 in L0 clearly implies (a)
and (b). Conversely, suppose (a) holds. Then as in the case kp ≤s, we have
fh ∈Lp for any f ∈Ls/k. Applying the last statement of Lemma 7.37 with
s/k < p in place of s, we get h = 0 in L0, ﬁnishing the proof of the lemma.
2
The next fact extends Proposition 7.46 to kth diﬀerentials.
Proposition 7.54. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, k a pos-
itive integer and 1 ≤p ≤kp < s < ∞. Let a Borel measurable function
F : R →R be such that the autonomous Nemytskii operator NF acts from Ls
into Lp. If NF is k times Fr´echet diﬀerentiable on a nonempty open set V ,
then F is k times diﬀerentiable on R, NF is k times Fr´echet diﬀerentiable on

370
7 Nemytskii Operators on Lp Spaces
all of Ls, and for each f ∈Ls, the kth diﬀerential dkNF (f) is the bounded
k-linear multiplication operator from (Ls)k into Lp induced by the function
F (k)◦f, which is in Lrk with rk deﬁned by (7.40).
The proof of this proposition is by induction on m, 1 ≤m ≤k. First, we
prove a lemma giving a part of the induction step, which also extends the
hypothesis to allow f to be ﬁxed and for that f, (k −1)p < s ≤kp, but
shows that if s < kp then dkNF (f) = 0. The lemma will also be used later
in Proposition 7.59, which will show that if NF is k times diﬀerentiable with
k ≥sp at some G ∈Ls then F is a polynomial of degree ≤k (or k −1, if s/p
is not an integer).
Lemma 7.55. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, and let 1 ≤
p ≤mp < s < ∞for some positive integer m. Let a Borel measurable function
F : R →R be such that the autonomous Nemytskii operator NF acts from Ls
into Lp. If NF is m + 1 times Fr´echet diﬀerentiable at f ∈Ls and there
is a Borel measurable function G such that dmNF (g) = M m[G◦g] for each
g ∈V , a neighborhood of f, then there is a function hf ∈L0(Ω, S, µ) such that
dm+1NF (f) = M m+1[hf]. If s < (m+1)p then hf = 0 in L0, so dm+1NF (f) =
0.
Proof. By assumption, the (m + 1)st diﬀerential L := dm+1NF (f) exists
and is in L(m+1Ls, Lp). By Proposition 5.25, the function g 7→dmNF (g) =
M m[G◦g], g ∈V , is diﬀerentiable at f and D(M m[G◦f])(g0) = L(g0, . . . )
for each g0 ∈Ls. Thus for each g0, g1, . . . , gm ∈Ls and t ∈R such that
f + tg0 ∈V , we have
t−1
NG(f + tg0) −NG(f)

g1 · · · gm −L(g0, g1, . . . , gm)

p →0
(7.41)
as t →0. It will be shown by induction on i = 1, 2, . . . , m + 1 that
for any ﬁxed g0, g1, . . . , gm−i ∈Ls there is a µ-measurable function h =
h(g0, g1, . . . , gm−i)(·) such that for the i-linear multiplication operator M i[h]
and any gm−i+1, . . . , gm in Ls we have
L(g0, g1, . . . , gm) = M i[h](gm−i+1, . . . , gm).
(7.42)
For i = m + 1 none of g0, . . . will be ﬁxed and h will be just one function,
giving the conclusion of the lemma.
For i = 1, let g0, g1, . . . , gm−1 ∈Ls be ﬁxed and for each gm ∈Ls, let
T (gm) := L(g0, g1, . . . , gm). Let A ∈S with µ(A) > 0 and gm = 1A. By
(7.41), it follows that T (1A)(ω) = 0 for µ-almost all ω ̸∈A. If B ∈S and
B ⊂A, then T (1B)(ω) = T (1A)(ω) for µ-almost all ω ∈B. Since µ is ﬁnite,
there is a µ-measurable function h = h(g0, g1, . . . , gm−1)(·): Ω→R, namely
h = T (1(·)), such that T (1A) = 1Ah for all A ∈S with µ(A) > 0. In particular
for A = Ω, taking t along the sequence 1/n in (7.41) and gm = 1(·), there is
a sequence nj ↑+∞such that

7.4 Higher Order Diﬀerentiability and Finite Taylor Series
371
nj

G(f(ω) + n−1
j g0(ω)) −G(f(ω))

g1 · · · gm−1 →h(ω)
for µ-almost all ω as j →∞. We can redeﬁne h(ω) as the limit of the left side
if it exists and 0 otherwise.
If gm is a µ-simple function, since T (·) is linear, we have T (gm) = hgm.
For any gm ∈Ls, there exist µ-simple gm,j →gm in Ls as j →∞. We
have T (gm,j) = hgm,j and T (gm,j) →T (gm) in Lp as j →∞. Taking
a subsequence, we can assume that gm,j →gm and T (gm,j) = hgm,j →
T (gm) µ-almost everywhere as j →∞. Thus L(g0, g1, . . . , gm) = T (gm) =
h(g0, g1, . . . , gm−1)gm a.e. (µ) for any gm ∈Ls, and so T (·) is the multiplica-
tion operator from Ls into Lp induced by the function h. By Proposition 5.5,
the operator norm ∥T (·)∥is bounded by ∥L∥∥g0∥s∥g1∥s · · · ∥gm−1∥s. Since
p < s, by Lemma 7.53 with k = 1, h ∈Lr1 with r1 = sp/(s −p), and
∥T (·)∥= ∥h∥r1. Thus (7.42) is proved for i = 1.
For the induction step, given (7.42) for some i with 1 ≤i ≤m, we want
to prove it for i + 1 in place of i. We can write the right side of (7.42) as
h(g0, . . . , gm−i)gm−i+1 · · · gm ∈Lp. Since i ≤m and mp < s we have by
Lemma 7.53 that h(g0, . . . , gm−i) ∈Lri(s,p). We need to show that for any
ﬁxed g0, . . . , gm−i−1 ∈Ls (or with none of g0, ... ﬁxed if i = m), we can
write h(g0, . . . , gm−i) = h(g0, . . . , gm−i−1)gm−i for some measurable function
h(g0, . . . , gm−i−1)(·), or simply a function h if i = m. As in the i = 1 case, for
any gm−i ∈Ls, let T (gm−i)(·) := h(g0, . . . , gm−i) ∈Lri(s,p), and let gm−i =
1A for any A ∈S with µ(A) > 0. By (7.41) and (7.42) we have T (1A)(ω) = 0
for µ-almost all ω /∈A. Also, (m + 1)-linearity of L and (7.42) imply that
T is linear from Ls into Lri(s,p). Thus, the proof as for i = 1 gives that
h(g0, . . . , gm−i−1) exists and (7.42) holds for i + 1 in place of i. For i = m + 1
we get that there is a µ-measurable function hf := h: Ω→R such that
L(g0, g1, . . . , gm) = hfg0g1 · · · gm a.e. (µ) for any g0, g1, . . . , gm ∈Ls. If s <
(m+1)p then hf = 0 in L0 by the last statement in Lemma 7.53 for k = m+1.
Since f ∈V is arbitrary, the proof of the lemma is complete.
2
Proof of Proposition 7.54. If k = 1, then the conclusion follows from
Proposition 7.46. Suppose that k > 1 and the conclusion holds for some m in
place of k with 1 ≤m < k. It will be proved to hold for m+1. By the induction
assumption, (1) F (m) exists everywhere on R, and (2) for each f ∈Ls, the
mth diﬀerential dmNF (f) is the bounded m-linear multiplication operator
from (Ls)m into Lp induced by the function F (m)◦f ∈Lrm. Thus for f ∈Ls,
dmNF (f)(g1, . . . , gm) = NF (m)(f)g1 · · · gm for each g1, . . . , gm ∈Ls.
To prove (1) and (2) with m + 1 in place of m, let f ∈V . Since NF is
m + 1 times diﬀerentiable on V , by Lemma 7.55 with G = F (m), there is an
hf ∈L0(Ω, S, µ) such that dm+1NF(f) = M m+1[hf]. Since (m+1)p ≤kp < s,
the function hm+1(f) := hf ∈Lrm+1 by the implication (b) ⇒(c) of Lemma
7.53 with k replaced by m + 1. By Proposition 5.25 with k = m + 1, the
function ˜f 7→dmNF( ˜f), ˜f ∈V , is diﬀerentiable at f and DdmNF (f)g =
M m+1[hm+1(f)](g, . . . ) for each g ∈Ls. Since

372
7 Nemytskii Operators on Lp Spaces
rm+1 = srm/(s −rm)
(7.43)
the linear multiplication operator M[hm+1(f)] is bounded from Ls into Lrm,
and for each g ∈Ls, the m-linear multiplication operator M m[hm+1(f)g] is
bounded from (Ls)m into Lp. Therefore by Lemma 7.53 with k = m, for each
g ∈Ls such that f + g ∈V , we have
∥NF (m)(f + g) −NF (m)(f) −hm+1(f)g∥rm
=
dmNF (f + g) −dmNF (f) −DdmNF (f)g

L(mLs,Lp) = o(∥g∥s)
as ∥g∥s →0. Thus the autonomous Nemytskii operator NF (m) is diﬀerentiable
from V into Lrm and its derivative at f ∈V is the bounded multiplication
operator induced by the function hm+1(f). Next we will apply Proposition
7.46 with rm and F (m) instead of p and F, respectively, as we may, recalling
that (m+1)p ≤kp < s and so rm < s. It follows that F (m+1) exists everywhere
on R and for each f ∈Ls, hm+1(f) = F (m+1)◦f, proving (1) and (2) with
m+1 in place of m.Therefore the conclusion of the proposition holds for m+1
instead of k. The induction argument is then complete, and the proposition
is proved.
2
In particular, the preceding proposition concludes that F (k)◦f is in Lrk
for each f ∈Ls. Using Theorem 7.13(b) with rk = sp/(s −kp) instead of
p, and recalling the growth-condition classes Gβ deﬁned in (7.2), we get the
following:
Corollary 7.56. Under the hypotheses of Proposition 7.54, F (k) ∈G(s/p)−k.
The necessary condition just stated is also suﬃcient:
Proposition 7.57. Let (Ω, S, µ) be ﬁnite and complete, k a positive integer,
and 1 ≤p ≤kp < s < ∞. If F : R →R is k times diﬀerentiable everywhere on
R and its kth derivative F (k) is in G(s/p)−k, then the autonomous Nemytskii
operator NF is k times Fr´echet diﬀerentiable from Ls into Lp and dkNF (f) =
M k[F (k)◦f] for each f ∈Ls.
Proof. If k = 1, then the conclusion holds by Proposition 7.45. Suppose that
k > 1. Since F (k) is locally bounded, F (k−1) ∈Hloc
1
by the mean value
theorem of calculus, so it is locally absolutely continuous and is an indeﬁnite
integral of F (k) (e.g. Theorem 8.18 and Example 8.20 in [198]). Thus F (k−1) ∈
G(s/p)−(k−1). Iterating, we ﬁnd that
F (j) ∈G(s/p)−j
for j = 0, 1, . . . , k,
(7.44)
where F (0) ≡F.
Now suppose that the conclusion holds with k replaced by some m, 1 ≤
m < k. It will be proved to hold for m + 1. By the induction assumption, NF

7.4 Higher Order Diﬀerentiability and Finite Taylor Series
373
is m times Fr´echet diﬀerentiable from Ls into Lp, and the mth diﬀerential
dmNF (f) equals M m[F (m)◦f] ∈L(mLs, Lp) for each f ∈Ls. Thus F (m)◦f ∈
Lrm by Lemma 7.53. Let G ∈Ls. Recall that rj = (sp)/(s −jp) for jp < s.
Since (m + 1)p ≤kp < s, we have (s/p) −(m + 1) = s/rm+1 and (7.43). By
(7.44) with j = m + 1 and Theorem 7.13(a) with rm+1 instead of p, it follows
that F (m+1)◦G ∈Lrm+1, and so M m+1[F (m+1)◦G] is a bounded (m+1)-linear
multiplication operator from (Ls)m+1 into Lp by Lemma 7.53. Also for each
g ∈Ls, (F (m+1)◦G)g ∈Lrm and M m[(F (m+1)◦G)g] is a bounded m-linear
multiplication operator from (Ls)m into Lp by Lemma 7.37 with rm instead
of p and by Lemma 7.53 with k = m, respectively. By Proposition 5.25, it is
enough to prove that the function f 7→dmNF (f), f ∈Ls, is diﬀerentiable at
G and DdmNF(G)(g) = M m+1[F m+1◦G](g, . . . ) for each g ∈Ls. For g ∈Ls,
let
R(g) := dmNF (G + g) −dmNF (G) −M m+1[F (m+1)◦G](g, . . . )
= M m[F (m)◦(G + g) −F (m)◦G −(F (m+1)◦G)g] ∈L(mLs, Lp).
By the norm statement in Lemma 7.53 with k = m, the operator norm of
R(g) is
∥R(g)∥= ∥F (m)◦(G + g) −F (m)◦G −(F (m+1)◦G)g∥rm.
The right side is o(∥g∥s) as ∥g∥s →0 by Proposition 7.45 applied to F = F (m)
and p = rm, using (7.44) with j = m + 1 and the identity (s/p) −(m + 1) =
(s/rm) −1. The proof of the proposition is complete by induction.
2
Proposition 7.58. Let (Ω, S, µ) be ﬁnite, complete, and nonatomic, k a pos-
itive integer, and 1 ≤p ≤kp < s < ∞. Let a Borel measurable F : R →R be
such that the autonomous Nemytskii operator NF acts from Ls into Lp, and
let V be a nonempty open subset of Ls(Ω, S, µ). Then the following statements
are equivalent:
(a) NF is Ck on V ;
(b) NF is Ck on Ls;
(c) F is Ck on R and NF (k) acts and is continuous from Ls into Lrk with rk
deﬁned by (7.40).
Proof. First suppose that (a) holds. By Proposition 7.54, the kth derivative
F (k) exists on R, and for each f ∈Ls, the kth diﬀerential dkNF (f) exists and
is the bounded k-linear multiplication operator from (Ls)k into Lp induced
by the function F (k)◦f ∈Lrk. Thus the Nemytskii operator NF (k) acts from
Ls into Lrk. By Lemma 7.53, the operator norm of the k-linear multiplication
operator from (Ls)k into Lp induced by a function h ∈Lrk is equal to ∥h∥rk.
Thus for any f1, f2 ∈Ls, we have

374
7 Nemytskii Operators on Lp Spaces
∥NF (k)(f1) −NF (k)(f2)∥rk
= sup

F (k)◦f1 −F (k)◦f2

g1 · · · gk

p : ∥g1∥s ≤1, . . . , ∥gk∥s ≤1
	
= ∥dkNF (f1) −dkNF (f2)∥.
Since dkNF is continuous on V , it then follows that NF (k) is continuous on
V . By Proposition 7.21(b), NF (k) is continuous from Ls into Lrk, proving the
second part of (c). The ﬁrst part follows from Theorem 7.19, since F (k) is
Borel measurable and ψ(u, ω) ≡F (k)(u) is a Carath´eodory function if and
only if F (k) is continuous.
Suppose that (c) holds. By Theorem 7.13 with rk in place of p and F (k) in
place of F, since NF (k) acts from Ls to Lrk, we have F (k) ∈Gs/rk = G(s/p)−k.
Thus by Proposition 7.57, NF is k times Fr´echet diﬀerentiable from Ls into
Lp, with dkNF (G) = M k[F (k)◦G] for each G ∈Ls. By (c), NF (k) is continuous
from Ls into Lrk. By the norm equality in Lemma 7.53, it follows that dkNF (·)
is continuous on Ls, so that (b) holds. Since clearly (b) implies (a), the proof
of the proposition is complete.
2
In the preceding proposition it was assumed that kp < s. If kp > s then rk
in part (c) is not deﬁned. If kp = s, then rk = +∞, and the condition in part
(c), if it holds, implies by Proposition 7.23 that F (k) is a constant, in other
words, that F is a polynomial of degree at most k. The following proposition
conﬁrms this and proves that F is a polynomial also if NF is k times diﬀer-
entiable, even at one point, for a k ≥s/p. Thus such diﬀerentiability is very
restrictive.
Proposition 7.59. Let (Ω, S, µ) be complete, nonatomic, and ﬁnite, let 1 ≤
p ≤s < ∞, and let j and k be respectively the largest and the smallest
integers such that j ≤s/p ≤k. Let F be a Borel function on R such that the
autonomous Nemytskii operator NF acts from Ls into Lp. If NF is k times
Fr´echet diﬀerentiable at a point G then F is a polynomial of degree at most
j.
Proof. If k = 1 then p = s and j = 1, and the conclusion follows from
Proposition 7.39. Thus we can assume that k > 1. Let r > 0 be such that NF
is k −1 times diﬀerentiable on G + Br, where Br = {g ∈Ls : ∥g∥s < r}. For
g ∈Br, the remainder in Taylor’s expansion of NF around G of order k is
deﬁned by
Rk(G, g) := Remk
NF (G, g) = NF (G + g) −NF (G) −
k
X
i=1
1
i!diNF (G)g⊗i.
Thus Rk(G, g) ∈Lp for each g ∈Br. For i = 1, . . . , k −1, since ip < s,
by Proposition 7.54, F (i) exists and diNF (G) = M i[F (i)◦G]. By Lemma
7.55 with m = k −1, there exists hG ∈L0(Ω, S, µ) such that dkNF (G) =

7.4 Higher Order Diﬀerentiability and Finite Taylor Series
375
M k[hG]. Let ai(ω) := (i!)−1F (i)◦G(ω) for i = 1, . . . , k −1, and let ak(ω) :=
(k!)−1hG(ω). For (u, ω) ∈R × Ω, let
ψ(u, ω) := F(G(ω) + u) −F(G(ω)) −
k
X
i=1
ai(ω)ui.
(7.45)
Then ψ is a strong Shragin function on R×Ωand the Nemytskii operator Nψ
acts from Br into Lp since Nψ(g) = Rk(G, g) for each g ∈Br. By Theorem
5.44, ∥Nψ(g)∥p = o(∥g∥k
s) as ∥g∥s →0. If for some g ∈Br, Nψ(g) ̸= 0 on a set
of positive µ-measure, then by Proposition 7.33(b), we must have kp < s. This
contradiction yields that Nψ(g) = 0 for each g ∈Br. Therefore by Proposition
7.6, there is a µ-null set N such that for each ω ∈N c, ψ(u, ω) = 0 for all
u ∈R. Thus taking an ω0 ∈N c, it follows that
F(u) = F(G(ω0)) +
k
X
i=1
ai(ω0)(u −G(ω0))i
for each u ∈R. The proof is complete if j = k, in other words if s/p is an
integer.
Let j < k. Then kp > s and j = k −1. In this case, for g ∈Br, consider
the remainder Rj(G, g) := Remj
NF (G, g) in Taylor’s expansion of NF around
G of order j. Also, for (u, ω) ∈R×Ω, let ψ(u, ω) be deﬁned by (7.45) without
the last term. Then again, ψ is a strong Shragin function on R × Ωand the
Nemytskii operator Nψ acts from Br into Lp since Nψ(g) = Rj(G, g) for
each g ∈Br. By Theorem 5.44, ∥Nψ(g)∥p = O(∥g∥k
s) as ∥g∥s →0. If for
some g ∈Br, Nψ(g) ̸= 0 on a set of positive µ-measure, then by Proposition
7.33(a), we must have k ≤s/p. This contradiction yields that Nψ(g) = 0 for
each g ∈Br. Again by Proposition 7.6, it follows that F is a polynomial of
degree at most j. The proposition is now proved.
2
We will give bounds for the remainders in Taylor expansions of the au-
tonomous Nemytskii operator g 7→NF (G + g). For an open set U ⊂R,
n = 1, 2, . . ., and 0 < α ≤1, we write F ∈Hn+α(U; R) if a function
F : U →R is Cn on U and its nth derivative F (n) is in Hα(U; R). If n = 1
this agrees with Deﬁnition 6.5 for X = Y = R.
Proposition 7.60. Let (Ω, S, µ) be a complete, ﬁnite measure space. Let 1 ≤
p < s < ∞, 0 < α ≤1, and a positive integer n be such that (n + α)p ≤s. Let
F ∈Hn+α(R; R) and let G ∈Ls(Ω, S, µ). Then the autonomous Nemytskii
operator NF acts from Ls(Ω, S, µ) into Lp(Ω, S, µ), it is n times Fr´echet
diﬀerentiable at G, and the remainder in the Taylor series around G has the
bound
NF(G + g) −NF (G) −
n
X
k=1
F (k)◦G
k!
gk
p ≤K∥g∥n+α
s
,
(7.46)

376
7 Nemytskii Operators on Lp Spaces
where K = µ(Ω)(1/p)−(n+α)/s∥F (n)∥(Hα)/n!, for all g ∈Ls.
Proof. Since for each k = 1, . . . , n, F (k−1) is an indeﬁnite integral of F (k),
F (n) ∈Hα, and n+α ≤s/p, it follows that F satisﬁes the β growth condition
(7.2) with β = s/p. By Theorem 7.13, it then follows that NF acts from Ls
into Lp, proving the ﬁrst part of the conclusion. By Taylor’s formula with an
integral remainder (e.g. Theorem 5.41), for each (u, ω) ∈R × Ω, we have
φ(u, ω) := F(G(ω) + u) −F(G(ω)) −
n
X
k=1
F (k)(G(ω))
k!
uk
= un
Z 1
0
h
F (n)(G(ω) + tu) −F (n)(G(ω))
i
dθn(t),
(7.47)
where θn(t) = −(1 −t)n/n! for 0 ≤t ≤1. Let 1 ≤k ≤n. Since (n + α)p ≤s,
F (k) satisﬁes the β growth condition with β = (s −kp)/p = s/rk, and so by
Theorem 7.13 the Nemytskii operator NF (k) acts from Ls into Lrk. By Lemma
7.29 with k + 1 in place of k, p1 = · · · = pk = s and pk+1 = rk, for g ∈Ls and
each 1 ≤k ≤n, we then have
Z
Ω
|(F (k)◦G)gk|p dµ ≤∥NF (k)G∥p
rk∥g∥kp
s < ∞.
Thus Nφ acts from Ls into Lp. Since F (n) ∈Hα, for each (u, ω) ∈R × Ω,
|φ(u, ω)| ≤|u|n+α∥F (n)∥(Hα)/n!.
Therefore by Lemma 7.29 with k = 2, we have
Z
Ω
|Nφg|p dµ ≤

∥F (n)∥(Hα)/n!
pµ(Ω)1−p(n+α)/s∥g∥p(n+α)
s
,
and the conclusion follows. The proof of the proposition is complete.
2
Remark 7.61. The assumption (n + α)p ≤s in the preceding proposition
cannot be improved in general. Indeed, under the hypotheses of Proposition
7.60 suppose in addition that (Ω, S, µ) is nonatomic and F(u) ̸= F(0) +
Pn
k=1(k!)−1F (k)(0)uk for some u ∈R. Thus φ ̸⋍0, where φ is the Shragin
function deﬁned by (7.47) with G ≡0. If (7.46) holds for G ≡0, then by
Proposition 7.33(a) we must have n + α ≤s/p.
The remainder bound O(∥g∥n+α
s
) in (7.46) is of best possible order under
the conditions of Proposition 7.60, as the following shows (for n = 1).
Proposition 7.62. Let 0 < α < 1 and 1 ≤p < p(1 + α) ≤s < ∞. Then
there are a function F ∈H1+α(R; R), a ﬁnite measure space (Ω, S, µ), and a
G ∈Ls(Ω, S, µ) such that if for some β > 1,
∥RemNF (G, g)∥p = O(∥g∥β
s )
as ∥g∥s →0, then β ≤1 + α.

7.4 Higher Order Diﬀerentiability and Finite Taylor Series
377
Proof. Let (Ω, S, µ) be [0, 1] with Lebesgue measure λ and G(x) := x, 0 ≤
x ≤1. Let M > 1 be a large enough integer so that
max{1/(M α −1), π/(M 1−α −1)} < 1/150,
(7.48)
and let
F(u) := (2π)−1
∞
X
n=1
M −n(1+α) sin(2πM nu),
u ∈R.
Then
F ′(u) =
∞
X
n=1
M −nα cos(2πM nu),
u ∈R.
We have F ′ ∈Hα by the proof of Proposition 3.104. Thus F ∈H1+α and so
the autonomous Nemytskii operator NF is Fr´echet diﬀerentiable at G from
Ls to Lp by Proposition 7.41. By the fundamental theorem of calculus for
g ∈Ls([0, 1], λ) and x ∈[0, 1], we have
RemNF (G, g)(x) = g(x)
Z 1
0

F ′(x + tg(x)) −F ′(x)

dt.
For k = 1, 2, . . ., and x ∈[0, 1], let gk(x) := rM −k −x, where r is the nearest
integer to xM k, or the smaller of two equally close integers. The values of |gk|
are uniformly distributed over [0, M −k/2], so
∥gk∥s =

2M k
Z M−k/2
0
ys dy
1/s
= C(s)M −k
for a constant C(s) not depending on M or k. For k, n = 1, 2, . . . , and x, t ∈
[0, 1], let
∆(k, n, x, t) := cos(2πM n(x + tgk(x))) −cos(2πM nx).
Then for k = 1, 2, . . . and x ∈[0, 1], we have
RemNF (G, gk)(x) = gk(x)
∞
X
n=1
M −nα
Z 1
0
∆(k, n, x, t) dt.
(7.49)
Using the deﬁnition of gk and the periodicity of the cosine, it follows that
∆(k, k, x, t) = cos(2πM k(1 −t)gk(x)) −cos(2πM kgk(x)) ≥0,
where the last inequality holds since t ∈[0, 1] and 2πM kgk(x) ∈[−π, π]
for x ∈[0, 1]. If |gk(x)| ≥M −k/4, which occurs on a set A ⊂[0, 1] with
λ(A) = 1/2, and if t ≥3/4, then ∆(k, k, x, t) ≥2−1/2. Thus for the pth norm
of the kth term of the sum on the right side of (7.49), we have the bound

378
7 Nemytskii Operators on Lp Spaces
gkM −kα
Z 1
0
∆(k, k, x, t) dt

p ≥M −k(1+α)2−(9/2)−(1/p) ≥M −k(1+α)/50.
For the sum of the terms with n > k, we have since ∥gk∥sup = M −k/2,
gk
∞
X
n=k+1
M −nα
Z 1
0
∆(k, n, x, t) dt

p ≤M −k−(k+1)α(1 −M −α)−1
≤M −k(1+α)/(M α −1).
For the sum of the terms with n < k, we have
gk
k−1
X
n=1
M −nα
Z 1
0
∆(k, n, x, t) dt

p ≤
gk
k−1
X
n=1
M −nα(2πM n) · M −k
p
≤πM −2k
k−1
X
n=1
M n(1−α) ≤πM −k(1+α)/(M 1−α −1).
By choice of M (7.48), we have
∥RemNF (G, gk)∥p ≥M −k(1+α)/150 ≥C∥gk∥1+α
s
for a constant C > 0. Since ∥gk∥s →0 as k →∞, the conclusion follows. 2
7.5 Examples where NF Is Diﬀerentiable and F Is Not
Here are examples showing that when an autonomous Nemytskii operator NF
is Fr´echet diﬀerentiable at one G, the derivative of F in measure as in Theorem
7.40(b) may not be an ordinary derivative. Let B be the Borel σ-algebra in R.
For a measurable function h ≥0 and a measure µ, we deﬁne a measure hµ by
(hµ)(A) := ∫A h dµ, A ∈B.
Proposition 7.63. There exist a probability measure ν on B, a compact set
K ⊂I
:= [0, 1] with ν(K) = 1, and a continuous function F from R into
R such that for the identity function X(x) ≡x from R into R, and any p, s
with 1 ≤p < s < ∞, the autonomous Nemytskii operator NF is Fr´echet
diﬀerentiable at X, in other words, g 7→F ◦(X + g) is Fr´echet diﬀerentiable
at g = 0, from Ls(I, B, ν) into Lp(I, B, ν) with derivative 0, but F ′ exists
nowhere on K. Moreover, F, K, and ν can be chosen so that for Lebesgue
measure λ, either (a) or (b) holds, where
(a) λ(K) = 1/2, F is α-H¨older for each α ∈(0, 1), and
ν = 2 · 1Kλ;
(7.50)

7.5 Examples where NF Is Diﬀerentiable and F Is Not
379
(b) λ(K) = 0 and F is Lipschitz, with |F(x)−F(y)| ≤2|x−y| for all x, y ∈R.
Remark. The F’s constructed in the proof will be diﬀerentiable everywhere
outside of K. In part (b), F, being Lipschitz, is necessarily diﬀerentiable almost
everywhere for λ.
Proof. Numbers bi ≡1 −ai ∈(0, 1/2] will be deﬁned for i = 0, 1, . . . as
follows. For part (b) we just take ai ≡bi ≡1/2, i = 0, 1, . . . . For part (a) and
i = 0, 1, . . ., let
ai := (i + 1)/(i + 2)
(i + 2)/(i + 3) = (i + 1)(i + 3)
(i + 2)2
,
bi = 1 −ai = 1/(i + 2)2. (7.51)
Then for any k = 0, 1, . . . and n > k,
akak+1 · · · an−1 = (k + 1)/(k + 2)
(n + 1)/(n + 2) →k + 1
k + 2
(7.52)
as n →∞, so
in part (a),
∞
Y
i=0
ai = 1
2.
(7.53)
We will deﬁne the set K as the intersection of a decreasing sequence of
sets Ki, i = 0, 1, . . . , each of which is a ﬁnite union of nondegenerate closed
intervals Kij, j = 1, . . . , M(i), for some M(i). The lexicographic ordering of
ordered pairs of positive integers is deﬁned by (i, j) ≺(i′, j′) if and only if
i < i′ or i = i′ and j < j′.
First, let K01
:=
[0, 1] and M(0)
:=
1. Closed intervals Kij will be
deﬁned recursively in i and j, i = 0, 1, . . . , j = 1, . . . , M(i). Suppose that
Kij, j = 1, . . . , M(i), are deﬁned for some i ≥0. For a positive integer m(i, j)
deﬁned below, each Kij will be a union of 2m(i,j) nonoverlapping intervals
Iijr = [aijr, bijr], r = 1, . . . , 2m(i,j), of equal length
bijr −aijr = hij := λ(Kij)/2m(i,j).
(7.54)
Let cijr := aijr + bihij/2 and dijr := bijr −bihij/2. Then
Kijr := [cijr, dijr]
(7.55)
is a subinterval of Iijr with
λ(Kijr) = aiλ(Iijr) = aihij ≥hij/2
(7.56)
since bi ≤1/2 for all i. The intervals Ki+1,s are deﬁned as the intervals Kijr
for all j = 1, . . . , M(i) and r = 1, . . . , 2m(i,j) where s < s′ if and only if
(j, r) ≺(j′, r′). For i = 0, 1, . . . let
M(i + 1) :=
M(i)
X
j=1
2m(i,j).
(7.57)

380
7 Nemytskii Operators on Lp Spaces
Thus Ki+1,s for s = 1, . . . , M(i + 1) will be deﬁned once m(i, j) are deﬁned.
Now to deﬁne m(i, j) and so hij recursively, we begin with
m(0, 1) := 1
and
h01 = λ(K01)/2m(0,1) = 1/2.
(7.58)
If Kij, m(i, j), and so hij are deﬁned for some i ≥0 and for all j = 1, . . . , M(i),
as they are for i = 0, then all the sets Ki+1,j are deﬁned as in (7.55) and just
after (7.56). Let m(i + 1, 1) be the smallest positive integer such that
hi+1,1 = λ(Ki+1,1)/2m(i+1,1) < (hi,M(i)/(i + 2))i+2 < hi,M(i)/2.
(7.59)
For each j = 1, . . . , M(i) −1, choose m(i + 1, j + 1) as the smallest positive
integer such that
hi+1,j+1 = λ(Ki+1,j+1)/2m(i+1,j+1) < (hi+1,j/(i + 1))i+1.
(7.60)
Then, iterating (7.60) and (7.59), the recursive deﬁnition of all m(i, j), M(i)
by (7.57), Kij, and hij is complete. It follows from (7.58), (7.59), and (7.60)
that for all i = 0, 1, . . .,
hi+1,1 ≤hi,1/2 ≤1/2i+2,
so
∞
X
n=0
hn1 ≤1.
(7.61)
It follows that hij > hi′j′ whenever both are deﬁned and (i, j) ≺(i′, j′), i.e.
h0,1 > h1,1 and for all i = 1, 2, . . .,
hi1 > hi2 > · · · > hi,M(i) > hi+1,1 > 0.
(7.62)
For i = 0, 1, . . ., let Ki := SM(i)
j=1 Kij, a ﬁnite union of closed intervals. Then
λ(K0) = 1 and λ(Ki+1) = aiλ(Ki) for all i ≥0, with K0 ⊃K1 ⊃K2 ⊃· · · .
Let
K :=
∞
\
i=0
Ki.
(7.63)
Then K is a compact, perfect set with λ(K) = Π∞
i=0ai = 0 in part (b), while
in part (a), λ(K) = 1/2 by (7.53). For part (a), ν is deﬁned by (7.50). For
part (b), we deﬁne ν(K01) := 1 and recursively let ν(Kijr) := ν(Kij)/2m(i,j)
for all j = 1, . . . , M(i) and r = 1, . . . , 2m(i,j) (these equations are also true, by
the way, in part (a)). Then in part (b), ν extends to a unique Borel probability
measure on R with ν(K) = 1. We have
in part (a), for each n ≥1 and 1 ≤j ≤M(n),
ν(Knj) < 2λ(Knj) < 2hn−1,1 ≤1/2n−1
(7.64)
by (7.50), (7.56), and (7.61).
We will use the following fact, which holds for the probability measure ν
in each of parts (a) and (b).

7.5 Examples where NF Is Diﬀerentiable and F Is Not
381
Lemma 7.64. For any i = 2, 3, 4, . . . and r = 1, . . . , M(i), let the interval
Kir be [a, b] with a < b and let J be a subinterval of Kir with a common
endpoint, J = [a, x] or [x, b] for some x ∈Kir. Then
ν(J)/ν(Kir) ≤2λ(J)/λ(Kir).
(7.65)
Proof. For part (a), by (7.55), (7.56) iterated, and (7.52), we have for each
i ≥1,
λ(Kir ∩K) = λ(Kir)i/(i + 1) ≥λ(Kir)/2,
while by (7.50), ν(Kir) = 2λ(Kir ∩K) and ν(J) ≤2λ(J), so the conclusion
follows. The rest of the proof will be for part (b). For any Borel set B and
i = 0, 1, . . ., let
νi(B) :=
M(i)
X
j=1
λ(B ∩Kij)/
M(i)
X
j=1
λ(Kij).
(7.66)
Then each νi is a Borel probability measure on I. We claim and will show by
induction that:
in case (b),
ν(Kij) = 2iλ(Kij)
(7.67)
for all i = 0, 1, . . . and j = 1, . . . , M(i). For i = 0 the claim holds. Let i ≥1
and suppose the claim holds for i−1 in place of i. For each j = 1, . . . , M(i) we
have Kij = Ki−1,u,v for some u = 1, . . . , M(i −1) and v = 1, . . . , m(i −1, u).
Then
ν(Kij) = ν(Ki−1,u)/2m(i−1,u)
by deﬁnition of ν
= 2i−1λ(Ki−1,u)/2m(i−1,u)
by induction hypothesis
= 2i−1λ(Ii−1,u,v)
by (7.54) with i −1 in place of i
= 2iλ(Kij)
by (7.56) and since ai−1 = 1/2,
proving (7.67) by induction. Iterating the ﬁrst equation in (7.56), it follows
that PM(i)
j=1 λ(Kij) = ai−1 · · · a0 = 2−i, and so
νi(Kij) = ν(Kij) for each j.
(7.68)
The sequence {νi}i≥0 converges weakly to ν, which has a continuous dis-
tribution function. Thus it suﬃces to prove (7.65) for each νk, k ≥i, in place
of ν. Let k = i + q for q = 0, 1, 2, . . .. On Kir, νi = 2iλ by (7.66) and (7.67),
and νi+q(Kir) = νi(Kir). Suppose J = [a, x] for x ∈[a, b] = Kir. We can
assume x > a and want to prove that for q = 0, 1, 2, . . .,
Gq(x) := νi+q([a, x])/(2i(x −a)) ≤2.
(7.69)
For q = 0, Gq(x) ≡1. For q = 1, we will show that G1(x) ≤4/3 for all x. Kir
is decomposed into 2m(i,r) intervals Iirp of equal length hir. For each p, Kirp

382
7 Nemytskii Operators on Lp Spaces
is the middle half of Iirp. The Radon–Nikodym derivative (density) dνi+1/dνi
equals 2 on each Kirp and is 0 on the complementary intervals Iirp \Kirp. It is
easily seen that G1 = 1 at the endpoints and midpoints of the intervals Iirp,
except that for p = 1, G1 = 0 on an interval (a, a + δ) for some δ > 0. The
midpoints of Iirp and Kirp are the same. Let u be the midpoint of Kirp. Then
on Kirp we have G1(x) = [u−a+2(x−u)]/(x−a) since u−a+(x−u) ≡x−a.
Since u > a it follows that G1 is increasing on each Kirp and attains a relative
maximum at its right-hand endpoint dirp. Then
G1(dirp) =
phir
 p −1
4

hir
= p/

p −1
4

,
which is maximized for p = 1, . . . , 2m(i,r) when p = 1, where it equals 4/3, so
G1(x) ≤4/3 for a < x ≤b. Applying the same proof with i + 1, G2/G1, and
2(x−u) in place of i, G1, and x−u respectively gives that G2(x) ≤(4/3)G1(x)
for a < x ≤b, and hence
G2(x) ≤(4/3)2,
a < x ≤b.
(7.70)
For each q = 0, 1, . . . , νi+q is concentrated on intervals Ki+q,ξ, on each of
which it has density 2q with respect to νi, or 2i+q with respect to λ. Let
hq(x)
:=
(x −a)Gq(x) for each x. Then for each q ≥1, h′
q(x) = 0 or 2q
wherever the derivative is deﬁned (as it is except on a ﬁnite set). We have
dGq(x)/dx = ((x −a)h′
q(x) −hq(x))/(x −a)2 > 0 if and only if x is in the
interior of Ki+q,ξ for some ξ and Gq(x) = hq(x)/(x−a) < h′
q(x), which equals
2q on such an interior.
Now, the bound
Gq(x) = hq(x)/(x −a) < 2q−1
(7.71)
for each q ≥2 will be proved by induction on q. We have dνq+1/dνq ≤2
everywhere, and so hq+1(x) ≤2hq(x) for all x ∈[a, b]. For q = 2, h2(x) <
2(x −a) by (7.70). So (7.71) holds for all q = 2, 3, . . . and a < x ≤b as
claimed, ﬁnishing the induction.
It follows that Gq is increasing on each Ki+q,ξ and has a relative maximum
at its right-hand endpoint. Suppose that q ≥2 and the absolute maximum of
Gq is at a point B, which must be the right endpoint of some Ki+q,ξ. Then
Ki+q,ξ ⊂Ki+q−1,u for some u. Let h := hi+q−1,u = 2λ(Ki+q,ξ).
It will be shown that ξ is the largest η such that Ki+q,ξ ⊂Ki+q−1,u.
Suppose not. The right endpoint of Ki+q,ξ+1 is B +h. Let ∆:= hq(B +h)−
hq(B) = νi+q(Ki+q,ξ+1)/2i = 2qλ(Ki+q,ξ+1) [by (7.67) and (7.68)] = 2q−1h.
To show that Gq(B + h) > Gq(B) is equivalent to showing that (B −a)∆>
hhq(B), or hq(B) < (B−a)·2q−1, or Gq(B) < 2q−1, which is true by (7.71). So
Gq(B +h) > Gq(B), which gives a contradiction, and ξ is the maximal η such
that Ki+q,η ⊂Ki+q−1,u. Let Bq
:= B and let Cq−1 be the right endpoint
of Ki+q−1,u. Then hq−1(Cq−1) = hq(Cq−1) = hq(Bq) and Cq−1 −Bq = h/4.

7.5 Examples where NF Is Diﬀerentiable and F Is Not
383
Let C
:=
Cq−1 −a and D
:=
Bq −a. Then D/C = 1 −(h/(4C)). We
have Ki+q−1,u ⊂Ki+q−2,s for some s and by (7.59) since i ≥2 and q ≥2, so
i + q −2 ≥2 and
C ≥λ(Ki+q−1,u) = hi+q−2,s/2 ≥22(i+q)−1hi+q−1,1.
Since h = hi+q−1,u ≤hi+q−1,1, it follows that h/(4C) ≤1/22(i+q)+1.
Now 1/(1 −z) ≤1 + 2z for 0 ≤z ≤1/2, so
sup
x Gq(x) = Gq(Bq) = hq(Bq)
Bq −a = hq−1(Cq−1)
D
= C
DGq−1(Cq−1)
≤C
D sup
x Gq−1(x) ≤(1 + 4−q) sup
x Gq−1(x).
Using this for q ≥3, the bound (7.70), and since 1 + t ≤et for t ≥0, we have
sup
q≥1
sup
x Gq(x) ≤(4/3)2 exp(1/(64(1 −4−1))) < 2,
proving (7.69) and Lemma 7.64 for intervals J = [a, x]. A proof for intervals
J = [x, b] is similar.
2
Next the function F will be deﬁned. For any b with 0 < b < 1 let G(·; b)
be the trapezoidal function on R deﬁned by
G(x; b) :=











0
if x < 0,
x/b
if 0 ≤x ≤b/2,
1/2
if b/2 < x ≤1 −b/2,
(1 −x)/b if 1 −b/2 < x ≤1,
0
if x > 1.
For each i = 0, 1, . . . , j = 1, . . . , M(i), and r = 1, . . . , 2m(i,j), let
Hijr(x) := hijG((x −aijr)/hij; bi),
Hi+1 :=
M(i)
X
k=1
2m(i,k)
X
s=1
Hiks.
(7.72)
Each Hijr is a continuous, piecewise linear function with support Iijr. We have
H′
ijr = 0 or ±1/bi except at the four points where right and left derivatives
have diﬀerent values. For k = 1, 2, . . ., let Fk := Pk
i=1 Hi. Then each Hi and
Fk is piecewise linear. All functions Hijr, Hi, and Fk are nonnegative and are
0 outside [0, 1]. For each i and each x ∈[0, 1], there is at most one ordered
pair (j, r) such that Hijr(x) > 0. Also, for the ﬁnite union Ui of open intervals
where Hi+1 has a non-zero derivative, Ui ⊂Ki \ Ki+1, so the Ui are disjoint,
Ui ∩Uk = ∅,
i ̸= k.
(7.73)

384
7 Nemytskii Operators on Lp Spaces
For any set S and bounded real-valued function f on S, recall that the
oscillation of f on S is deﬁned by Osc(f; S) = (sup −inf)({f(x) : x ∈S})
and that ∥f∥sup := sup{|f(x)| : x ∈S}. If f ≥0 and f(x) = 0 for some
x ∈S then clearly Osc(f; S) = ∥f∥sup. For any b ∈(0, 1), ∥G(·; b)∥sup = 1/2,
from the deﬁnition of G. It follows from the deﬁnitions of Hijr (7.72) and Kijr
(7.55) that for each i = 0, 1, . . ., j = 1, . . . , M(i), and r = 1, 2, . . . , 2m(i,j),
∥Hijr∥sup = hij/2,
Osc(Hijr, Kijr) = 0.
(7.74)
We have for each i = 0, 1, . . ., by (7.61), and (7.62) for i + 1 in place of i,
∥Hi+1∥sup = ∥Hi11∥sup = hi1/2 ≤1/2i+2.
(7.75)
Also Osc(Hi+1; Ki+1,s) = 0 for all i ≥0 and all s, or in other words
Osc(Hi; Ki,u) = 0 for all i ≥1 and all u. Since each Ki+1,s = Kijr ⊂Kij for
some j and r, it follows that for 1 ≤u ≤i and all s = 1, . . . , M(i),
Osc(Hu; Ki,s) = 0.
(7.76)
From (7.75) it follows that the series
F(x) :=
X
i≥1
Hi(x),
(7.77)
or equivalently the sequence {Fk}k≥1, converges absolutely and uniformly on
R to a function F, which is 0 outside [0, 1].
For each i = 1, 2, . . . and j = 1, . . . , M(i), by (7.76) and (7.74), we have
Osc(F; Kij) ≤
X
k>i
Osc(Hk; Kij) ≤hij/2 +
X
k>i+1
∥Hk∥sup.
For each k > i + 1, by (7.75), (7.59), and (7.62), it follows that ∥Hk∥sup =
hk−1,1/2 and ∥Hk+1∥sup < ∥Hk∥sup/2. Also, hi+1,1 < hij/2, and so
X
k>i+1
∥Hk∥sup ≤2−2hij
X
k≥0
2−k = hij/2.
Therefore for each i = 1, 2, . . . and j = 1, . . . , M(i), we have the bound
Osc(F; Kij) ≤hij ≤hi1.
(7.78)
It will be shown that F ′ exists nowhere on K. Let t ∈K. Then for each
i = 0, 1, . . . , there are some unique j, r, and s with t ∈Kijr = Ki+1,s and
so ui
:= aijr < cijr ≤t ≤dijr < vi
:= bijr. We have Osc(Hk; Iijr) = 0
for all k = 1, . . . , i by (7.76) since [ui, vi] = Iijr ⊂Kij. Also, Hi+1(t) =
Hijr(t) = hij/2 by (7.72), while Hi+1(ui) = Hi+1(vi) = 0. For k > i + 1
we have Hk(ui) = Hk(vi) = 0 since ui, vi /∈Ki+1. Thus F(ui) = F(vi) and
F(t) −F(ui) = F(t) −F(vi) ≥hij/2, while max(t −ui, vi −t) < hij, so

7.5 Examples where NF Is Diﬀerentiable and F Is Not
385
(F(t) −F(ui))/(t −ui) ≥1/2,
(F(vi) −F(t))/(vi −t) ≤−1/2.
As i →∞, ui = aijr ↑t and vi = bijr ↓t, so F ′(t) does not exist.
In part (b), since bi ≡1/2, we have by (7.72) that H′
i(x) = 0 or ±2 every-
where except at ﬁnitely many points where Hi has left and right derivatives
from among the same three values. Recall that the sets where H′
i ̸= 0 are
disjoint (7.73). It follows from (7.77) that |F(x) −F(y)| ≤2(y −x) for 0 ≤
x ≤y ≤1. Since F(x) ≡0 for all x /∈[0, 1], we have |F(x) −F(y)| ≤2|x −y|
for all real x, y.
In both parts (a) and (b) we have H¨older conditions as follows.
Lemma 7.65. For each α ∈(0, 1) F is α-H¨older, i.e. there is a Cα < +∞
such that for all real x and y, |F(x) −F(y)| ≤Cα|x −y|α.
Proof. In part (b), we have for 0 ≤x ≤y ≤1 that |F(x) −F(y)| ≤2|x −y| ≤
2|x −y|α. Since F ≡0 on (−∞, 0] and on [1, ∞), the same H¨older condition
holds for all x, y ∈R. In part (a), by (7.72) and the deﬁnition of G, each Hijr
is piecewise linear, with slope ±1/bi = ±(i + 2)2 by (7.51) on two intervals
each of length bihij/2, and otherwise constant. If |x −y| ≤bihij/2 then
|Hijr(x)−Hijr(y)| ≤|x−y|/bi = |x−y|α|x−y|1−α/bi ≤|x−y|αh1−α
ij
/bα
i .
By (7.62) this is ≤|x −y|αh1−α
i1
/bα
i ≤γi|x −y|α where by (7.61) and (7.51)
we can take γi := (i + 2)2α/2i(1−α).
Or if |x −y| > bihij/2 then by (7.62), (7.72), and (7.74),
|Hijr(x) −Hijr(y)| ≤hij/2 = h1−α
ij
hα
ij/2 ≤h1−α
i1
|x −y|α/bα
i
≤γi|x −y|α
again and so in both cases. Then by (7.72), |Hi+1(x) −Hi+1(y)| ≤γi|x −y|α
for 0 ≤x ≤y ≤1. It follows that |F(x) −F(y)| ≤Cα|x −y|α for Cα
:=
P
i γi = P
i(i + 2)2α/2i(1−α) < ∞.
2
Let F, ν, Kij, hij, and M(i) be as deﬁned in the proof of Proposition 7.63
so far. We still need to prove that NF is Fr´echet diﬀerentiable, with derivative
0, at the identity function. This will be done by the following:
Lemma 7.66. Let 1 ≤p < s < ∞. Let gn →0 in Ls(R, ν). For any function
f : R →R and x ∈R, let ∆nf(x) := f(x + gn(x)) −f(x). Then ∥∆nF∥p =
o(∥gn∥s) as n →∞.
Proof. It will be shown that it suﬃces to consider sequences gn such that for
all n,
hn+1,1 < ∥gn∥s ≤hn,1.
(7.79)
To prove this, note that if the conclusion fails, there are an ǫ > 0 and a
subsequence gn(k) such that ∥∆n(k)F∥p ≥ǫ∥gn(k)∥s for all k. Taking a further
subsequence, we can assume that for each n, there is at most one k such

386
7 Nemytskii Operators on Lp Spaces
that hn+1,1 < ∥gn(k)∥s ≤hn,1. This subsequence can be ﬁlled out by way of
constants so that there is exactly one k for each n, and (7.79) holds.
We claim that for a sequence Bn of Borel subsets of [0, 1],
Z
Bn
|∆nF|p dν = o(∥gn∥p
s)
as n →∞,
(7.80)
provided that for some δ > 0,
ν(Bn) = o(∥gn∥δ
s)
as n →∞.
(7.81)
To prove the claim, let Bn be such a sequence. By Lemma 7.65, F is α-H¨older
for any 0 < α < 1. Thus by Lemma 7.29 with k = 2,
Z
Bn
|∆nF|pdν ≤Cp
α
Z
Bn
|gn|pαdν ≤Cp
α∥gn∥pα
s ν(Bn)(s−pα)/s.
(7.82)
To show that the latter product is o(∥gn∥p
s) for some α ∈(0, 1), it will suﬃce
if
ν(Bn) = o(∥gn∥p(1−α)s/(s−pα)
s
).
For this it will suﬃce in turn if (7.81) holds for some δ > 0 since if so, we can
take α ∈(0, 1) close enough to 1 so that p(1 −α)s/(s −pα) < δ. So the claim
is proved. Moreover, for part (b), (7.80) holds provided
ν(Bn) →0
as n →∞.
(7.83)
This follows from (7.82) with α = 1 since F is a Lipschitz function in this
case.
For a sequence of numbers γn →0 let An := {x ∈[0, 1] : |gn(x)| > γn}.
Then ν(An) ≤∥gn∥s
s/γs
n, which will be o(∥gn∥δ
s) for a given δ > 0 if ∥gn∥s =
o(γs/(s−δ)
n
). This holds for γn := (n∥gn∥s)(s−δ)/s, which goes to 0 as n →∞
by (7.79) and (7.61). Taking δ := s/5 and Bn = An, by (7.81), it follows that
(7.80) holds.
Let for each n = 1, 2, . . ., Cn := [0, 1] \ An and g(1)
n
:= gn1Cn. Then
∥g(1)
n ∥sup ≤(n∥gn∥s)4/5.
(7.84)
Now it will suﬃce to prove (7.80) with Cn in place of Bn, namely
Z
Cn
|∆nF|p dν = o(∥gn∥p
s)
as n →∞.
(7.85)
To continue the proof of Lemma 7.66, here is a technical lemma.
Lemma 7.67. For n ≥3, let i = i(n) = n or n + 1, and let 1 ≤v = vn ≤
q = qn ≤M(i) be integers. Suppose that
hi,v = o(∥gn∥s) as n →∞,
(7.86)

7.5 Examples where NF Is Diﬀerentiable and F Is Not
387
and {hn}n≥3 is a sequence such that 0 < hn ≤hn−1,1,
λ(Kiq) ≥hn/2,
(7.87)
and
∥g(1)
n ∥sup ≤h2
n.
(7.88)
Then (7.80) holds for the sequence Bn = Cn ∩Sq
j=v Kij.
Proof. Let n ≥3. For v ≤j ≤q, let Iij be a subinterval of Kij with end-
points distant by ∥g(1)
n ∥sup from those of Kij. The assumption hn ≤hn−1,1
implies by (7.61) that hn < 1/4. By (7.87), (7.62), and (7.88), Iij exists and
is nondegenerate. Then Jij
:=
Kij \ Iij is a union of two intervals, with
λ(Jij) = 2∥g(1)
n ∥sup.
If v ≤j ≤q and x ∈Cn ∩Iij then x + gn(x) = x + g(1)
n (x) ∈Kij, and so
|∆nF(x)| = |F(x + g(1)
n (x)) −F(x)| ≤Osc(F; Kij) ≤hij
by (7.78). Thus by (7.62), |∆nF(x)| ≤hi,v for each x ∈Un := Cn∩S
v≤j≤q Iij,
and hence (7.80) holds for the sequence Bn = Un by (7.86).
So, let Fn := S
v≤j≤q Jij. Then in part (a),
ν(Fn) ≤4
q
X
j=v
∥g(1)
n ∥sup = 4∥g(1)
n ∥sup
q
X
j=v
λ(Kij)/λ(Kij) ≤8∥g(1)
n ∥sup/hn
by (7.87). In part (b), since each of the two intervals forming Jij has a common
endpoint with Kij, by Lemma 7.64 and (7.87) we have
ν(Fn) =
q
X
j=v
ν(Jij) ≤8
q
X
j=v
∥g(1)
n ∥suph−1
n ν(Kij) ≤8∥g(1)
n ∥sup/hn.
Thus in both parts (a) and (b), by (7.84) and (7.88), we have
ν(Fn) ≤8h−1
n min{h2
n, (n∥gn∥s)4/5} ≤ǫn∥gn∥1/5
s
,
where ǫn := 8n2/5∥gn∥1/5
s
if h2
n ≤(n∥gn∥s)4/5 and ǫn := 8n1/5h1/2
n
if
(n∥gn∥s)4/5 < h2
n. By (7.79) and (7.61), we have ∥gn∥s ≤2−n−1. By the
assumption hn ≤hn−1,1 and (7.61), hn ≤2−n. Thus ν(Fn) = o(∥gn∥1/5
s
) as
n →∞, and so (7.80) holds for Bn = Fn by (7.81) with δ = 1/5. Thus Lemma
7.67 is proved.
2
We deﬁne Kn,M(n)+1 := Kn+1,1 and hn,M(n)+1 := hn+1,1. The latter is
consistent with (7.60) for j = M(n) by (7.59).

388
7 Nemytskii Operators on Lp Spaces
Lemma 7.68. For n = 2, 3, . . . and j = jn = 1, . . . , M(n), suppose that
hn,j+1 ≤∥gn∥s ≤hn,j and Un = Kn,j or Kn,j+1. Then (7.80) holds for the
sequence Bn = Un ∩Cn.
Proof. For part (b), the conclusion holds by (7.83) since ν(Un) →0 as n →∞.
For part (a), if λ(Un) > 2∥g(1)
n ∥sup let the interval Wn ⊂Un have endpoints
distant by ∥g(1)
n ∥sup from those of Un and Vn
:=
Un \ Wn. Otherwise let
Wn = ∅and Vn = Un. In either case, to show that (7.80) holds for the
sequence Bn = Vn, it suﬃces to verify (7.81) for δ = 1/5 and Bn = Vn. We
have
ν(Vn) ≤2λ(Vn) ≤4∥g(1)
n ∥sup ≤4(n∥gn∥s)4/5
by (7.84). Now (n∥gn∥s)4/5 = o(∥gn∥1/5
s
), or equivalently n4∥gn∥3
s →0 as
n →∞, by (7.79) and (7.61), proving (7.81) in this case.
If x ∈Wn ∩Cn then x + gn(x) = x + g(1)
n (x) ∈Un. Thus by (7.76),
∆nHk(x) = 0 for each k ≤n, and so
|∆nF(x)| = |F(x + g(1)
n (x)) −F(x)| ≤|∆nHn+1(x)| +
X
k>n+1
∥Hk∥sup (7.89)
for each x ∈Wn ∩Cn. By (7.75), (7.61), and (7.79),
Sn :=
∞
X
r=n+2
∥Hr∥sup ≤hn+1,1 ≤∥gn∥s.
(7.90)
Thus since ν(Un) →0 as n →∞by (7.64),
Z
Wn
Sp
ndν ≤ν(Un)hp
n+1,1 = o(∥gn∥p
s).
(7.91)
It remains to bound ∆nHn+1 on Wn ∩Cn. First let Un = Kn,j+1. If
x ∈Wn ∩Cn then again x + gn(x) = x + g(1)
n (x) ∈Un and
|∆nHn+1(x)| = |Hn+1(x + g(1)
n (x)) −Hn+1(x)| ≤hn,j+1/2
if j < M(n) by (7.74), or if j = M(n), then ∆nHn+1(x) = 0. In either case,
|∆nF(x)| ≤hn,j+1 by (7.89), (7.90), and (7.59). Since hn,j+1 ≤∥gn∥s, it then
follows by (7.64) that
Z
Wn∩Cn
|∆nF|pdν ≤hp
n,j+1ν(Un) ≤∥gn∥p
s/2n−1 = o(∥gn∥p
s).
Now let Un = Kn,j. Then note that by (7.72), |Hn+1(x)−Hn+1(y)| ≤|x−y|/bn
for all x, y. It follows by H¨older’s inequality (Lemma 7.29 with k = 2) that
Z
Wn
|∆nHn+1|pdν ≤
Z
Wn
|gn|pdν/bp
n ≤∥gn∥p
sν(Wn)(s−p)/s/bp
n.

7.5 Examples where NF Is Diﬀerentiable and F Is Not
389
This is o(∥gn∥p
s) because ν(Wn)(s−p)/s = o((n+2)−3p) and (n+2)−3p = o(bp
n)
by (7.64) and (7.51), with bounds not depending on j. By (7.89), we have on
Wn ∩Cn that |∆nF|p ≤2p[|∆nHn+1|p + Sp
n]. Lemma 7.68 follows by (7.91).
2
Next, to prove (7.85) and so Lemma 7.66, for each n we have three possible
cases.
In Case 1, for some ρ = 1, . . . , M(n) −2,
hn,ρ+2 < ∥gn∥s ≤hn,ρ+1.
(7.92)
In Case 2,
hn+1,1 < ∥gn∥s ≤hn,M(n).
(7.93)
In Case 3,
hn,2 < ∥gn∥s ≤hn,1.
(7.94)
The three cases include all possibilities for each n by (7.79) and (7.62).
It suﬃces to consider n ≥3. The sequence {gn}n≥3 can be decomposed into
three subsequences {gnij}j≥1, i = 1, 2, 3, such that Case i holds for n = nij
for all j. It suﬃces to prove Lemma 7.66 for each subsequence. Filling out the
subsequences with constants, it suﬃces to prove (7.85) assuming that (7.79)
and one of the three Cases holds for all n.
For the proof in Case 1, ﬁrst apply Lemma 7.67 with i = n + 1, v = 1,
q = q(n, ρ), the largest k such that Kn+1,k ⊂Kn,ρ, and hn := hn,ρ ≤hn,1 ≤
hn−1,M(n−1) by (7.62). Then (7.86) holds by (7.92), (7.59), and (7.62); (7.87)
holds since by (7.56), λ(Kn+1,q) ≥hn,ρ/2 = hn/2; and (7.88) holds by (7.84),
(7.92), and (7.60). Thus Lemma 7.67 applies and gives relation (7.80) for the
sequence Bn = Cn ∩K ∩Sρ
t=1 Kn,t ⊂Cn ∩Sq(n,ρ)
j=1
Kn+1,j.
Relation (7.80) for the sequences Bn = Cn∩Kn,ρ+1 and Bn = Cn∩Kn,ρ+2
holds by Lemma 7.68 for j = ρ + 1.
In Case 1, it remains to treat the set Fn,ρ := SM(n)
j=ρ+3 Kn,j. For this set
apply Lemma 7.67 with i = n, v = ρ+3, q = M(n), and hn := hn−1,M(n−1) ≤
hn−1,1 by (7.62). Note that (7.86) holds by (7.92) and (7.60); (7.87) holds since
λ(Kn,M(n)) ≥hn−1,M(n−1)/2 by (7.56); and (7.88) holds by (7.84), (7.92),
(7.62), and (7.59). Thus relation (7.80) holds for Bn = Cn∩Fn,ρ. Since ν(K) =
1 and Cn ∩K ⊂Cn ∩[(K ∩Sρ
t=1 Kn,t) ∪Kn,ρ+1 ∪Kn,ρ+2 ∪Fn,ρ], (7.85) holds
in Case 1.
In Case 2 (7.93), ﬁrst Lemma 7.67 will be applied with i = n + 1, v = 2,
q the largest k such that Kn+1,k ⊂Kn,M(n)−1, and hn
:=
hn,M(n)−1 <
hn−1,1. Then (7.86) holds by (7.93) and (7.60); (7.87) holds since λ(Kn+1,q) ≥
hn,M(n)−1/2 by (7.56); and (7.88) holds by (7.84), (7.93), and (7.60). Thus
relation (7.80) holds for Bn = Cn ∩Sq
j=2 Kn+1,j.
The sets Kn,M(n) and Kn+1,1 are treated by Lemma 7.68 with j = M(n).
Each x ∈K is either in some Kn+1,j ⊂Kn,r for j ≥2 and r ≤M(n) −1, or
in Kn,M(n) or in Kn+1,1. So (7.85) holds in Case 2.

390
7 Nemytskii Operators on Lp Spaces
For Case 3 (7.94), let Ln := S
p≥3 Kn,p. To apply Lemma 7.67, let i = n,
v = 3, q = M(n), and hn := hn−1,M(n−1) < hn−1,1 by (7.62). Then (7.86)
holds by (7.94) and (7.60); (7.87) holds, i.e. λ(Kn,M(n)) ≥hn−1,M(n−1)/2,
by (7.56); and (7.88) holds by (7.84), (7.94), and (7.59). Thus relation (7.80)
follows for Bn = Cn ∩Ln.
The sets Kn,1 and Kn,2 are treated by Lemma 7.68 with j = 1. Then
(7.85) holds in Case 3, and so the proof of Lemma 7.66 is complete.
2
Thus the proof of Proposition 7.63 is also done.
2
7.6 Notes
Notes on Section 7.1. The Shragin measurability condition was given by Shra-
gin [218]. In [220] Shragin also used a diﬀerent version of this condition, which
we call the strong Shragin condition. Proposition 7.4 is a special case of Theo-
rem 2 of Shragin [219]. Proposition 7.6 is close to Lemma 1.5 in [3]. Proposition
7.17 is a special case of Theorem 2 of Shragin [220, Theorem 2]. A related re-
sult when a function ψ is just bimeasurable follows from Theorem 2 of Ponosov
[188]. Namely for such a ψ, the Nemytskii operator Nψ is continuous on L0 if
and only if ψ ⋍φ for some Carath´eodory function φ.
Appell and Zabrejko [3, Chapter 3] treat Nemytskii operators between Lp
spaces, which they call Lebesgue spaces. Most of Theorem 7.13 is a corollary of
their Theorem 3.1, which treats operators Nψ for functions ψ of two variables
and allows atoms. For both reasons the statement becomes more complicated.
If µ is nonatomic the growth condition on ψ is that
|ψ(u, x)| ≤a(x) + b|u|s/p
(7.95)
for some constant b and function a(·) ∈Lp. Krasnosel’ski˘ı [127] proved that
(7.95) is necessary for Nψ to act on Ls into Lp for 1 ≤p < s < ∞, if ψ(·, ·) is
a Carath´eodory function. As Krasnosel’skii points out, (7.95) had been given
earlier, by Va˘ınberg [232], who showed that for a Carath´eodory function, it
is suﬃcient for Nψ not only to act but to be continuous from Ls into Lp. In
the autonomous case ψ(u, x) ≡F(u) the Carath´eodory condition reduces to
continuity of F, which is not at all necessary for NF to act from Ls into Lp,
although it is necessary for continuity by Theorem 7.19.
We do not know previous references for the (easy) extension to the case
that NF is deﬁned only on a nonempty open subset of Ls as in Theorem
7.13(b) and the extension to universal measurability in (a) and part (c) of
Theorem 7.13, other than remarks in [54, Part III] about measurability.
Notes on Section 7.2. Theorem 7.24 is an extension of [55, Theorem 3.3],
where G was unnecessarily assumed to be bounded. The present proof is

7.6 Notes
391
shorter and is self-contained. A predecessor of this fact was [50, Theorem 2.2],
which also included Proposition 7.28.
Notes on Section 7.3. The fact that a Carath´eodory function ψ must be
aﬃne whenever the Nemytskii operator Nψ taking Lp into Lp, 1 ≤p < ∞,
is Fr´echet diﬀerentiable at some function (Proposition 7.39) was proved by
Va˘ınberg [233, pp. 91–92] in the case p = 2. The idea of his proof was similar
to Lemma 7.33(b) as shown more explicitly when p = 2 by Durdil [58, Theorem
11]. Apparently Corollary 7.36 was known to Appell and Zabrejko [4, Theorem
3.12]. Theorem 7.40 is due to Wang Sheng-Wang [237].
Notes on Section 7.4. Proposition 7.59 shows that if the autonomous Ne-
mytskii operator NF acts from Ls into Lp and is k times Fr´echet diﬀerentiable
at a point G, with k ≥s/p, then F is a polynomial of degree ≤s/p. This may
be considered as a reﬁnement of the known fact that an analytic Nemytskii
operator acting from Ls into Lp must be a polynomial (e.g. Theorem 2.20 and
Theorem 3.16 in [3]). The authors of [3, p. 116] say that “[t]his fact is rather
disappointing, in view of the usefulness of Lebesgue spaces in applications,
and may be the reason for the fact that analyticity properties of superposi-
tion operators in other than Lebesgue spaces have not been studied . . . ”. In
contrast, Nemytskii operators Nψ or NF acting on certain Banach algebras of
functions (Theorems 6.29, and 6.32), speciﬁcally acting on Wp spaces (Corol-
laries 6.78, 6.79, and 6.80), are analytic for F analytic, or for (u, x) 7→ψ(u, x),
analytic in u with suitable bounds with respect to x.
Notes on Section 7.5. The counterexample, Proposition 7.63, and its proof
are given here for the ﬁrst time. It shows that Theorem 2.1 of [54, Part I] is
not correct. The proof of the latter relied on the sentence after (2.56) in [3],
which apparently is also incorrect.
Appell and Zabrejko [3] consider Nemytskii operators also on Orlicz spaces,
symmetric spaces (µ-ideal spaces whose norm may be deﬁned by means of
nondecreasing rearrangement of measurable functions), spaces of continuous
functions, functions of bounded variation, H¨older spaces, spaces of smooth
functions, and Sobolev spaces.
Runst and Sickel [199, Chapter 5] consider Nemytskii operators on spaces
of “Besov–Triebel–Lizorkin type.” Such spaces of generalized functions (tem-
pered distributions) on Rk are deﬁned by way of Fourier transforms, partitions
of unity, Lp properties with respect to Lebesgue measure, and ℓq properties
of sequences. They include several known classes of spaces such as Sobolev
spaces but not Wp spaces. Runst and Sickel consider mainly autonomous op-
erators f 7→G◦f or (f1, . . . , fn) 7→(x 7→G(f1(x), . . . , fn(x))) and to a lesser
extent the case where G can depend separately on x. In a long section [199,
§5.3] G is assumed to be C∞; in [199, §5.4], G(y) = |y|µ, which is nonsmooth
at 0 for µ not an even integer.


8
Two-Function Composition
8.1 Overview; General Remarks
Recall that composition of two functions F and G is deﬁned by
(F◦G)(s) := F(G(s)),
(8.1)
where s ∈S, G: S →U, and F : U →Y . In this chapter Y will be a Banach
space and U will be an open subset of a Banach space X. The set S will be
an interval in Section 8.5. Sometimes, as in Section 8.3, a measure µ is given
on a σ-algebra of subsets of S. Often X = Y = K = R or C.
By two-function composition operator we mean the operator
TC : (F, G) 7→TC(F, G) := F◦G,
where F◦G is deﬁned by (8.1). In Chapters 6 and 7, the composition F◦G
is treated for ﬁxed F and is called in this case the autonomous Nemytskii
operator NF , and so TC(F, G) = NF G.
For S, U, X, and Y as before, let G, F, and H be Banach spaces of
functions, or for G and H of µ-equivalence classes, acting from S into X, from
U into Y , and from S into Y , respectively. For a set W ⊂F × G such that
g has values in U for each (f, g) ∈W, we say that TC acts from W into
H if TC(f, g) ∈H for each (f, g) ∈W. Here TC(f, g) is deﬁned when f is
an actual function, not an equivalence class for a ﬁxed σ-ﬁnite measure ν on
U. If g = g1 a.e. (µ) (µ-almost everywhere) for two µ-measurable functions
g, g1 : S →U and f is Borel measurable from U into Y , then clearly also
f◦g = f◦g1 a.e. (µ). But for two functions f and f1, we will have f◦g = f1◦g
a.e. (µ) if and only if f = f1 a.e. (µ◦g−1), a measure on U which depends on
g. Suppose that G contains all constant functions g(s) ≡x, s ∈S, for each
x ∈U, or the equivalence classes of such functions. If f and f1 are two Borel
measurable functions deﬁned on U and f◦g = f1◦g (a.e. (µ) if G is a space
of µ-equivalence classes) for all g ∈G, then f(x) = f1(x) for all x ∈U, i.e.
f = f1. So in
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_8, 
393

394
8 Two-Function Composition
F × G ∋(f, g) 7→TC(f, g) = f◦g ∈H
(8.2)
we will take f in a space F of functions, not of equivalence classes.
Remark 8.1. We may assume that TC acts from F×V into H for a nonempty
open set V ⊂G. Indeed, let W be a nonempty open set in F×G such that TC
acts from W into H. Take any nonempty open sets O ⊂F and V ⊂G such
that O×V ⊂W. Fix F ∈O. Then (F +f)◦G ∈H for all f in a neighborhood
of 0 in F and all G ∈V . Taking f = 0 and subtracting, we get that f◦G ∈H.
But then we can multiply f by an arbitrary constant, so that in fact TC
acts from F × V into H. Let VW be the union of all open V ⊂G such that
O × V ⊂W for some nonempty open O ⊂F. Then TC acts from F × VW into
H and F × VW ⊃W. So if T C acts on an open set W ⊂F × G, as will be
needed to deﬁne continuity and diﬀerentiability at a point (F, G), we may as
well assume W = F × V for an open V ⊂G. On the other hand, restricting g
to a neighborhood of 0 can actually make a diﬀerence in whether f◦(G + g)
is deﬁned at all, or is in H, for example if G is a space of functions with
supremum norm. However, if G is an Lp space and F is such that F ◦G ∈H
for all G in a nonempty open set V ⊂G, then F ◦G ∈H for all G ∈G under
some conditions (cf. Proposition 7.21(a)).
We will consider some cases in which TC acts between some function
spaces and is continuous or diﬀerentiable at certain (F, G). Continuity or
diﬀerentiability of TC at (F, G) is clearly equivalent to that of
(f, g) 7→(F + f)◦(G + g)
(8.3)
at f = g = 0. TC will be considered when G and G + g take values in U.
For ﬁxed G (g ≡0), the operator C◦G : F 7→F◦G is linear. So if it is
a bounded linear operator from a Banach space F of functions on U to a
Banach space H of functions on S, then it is everywhere Fr´echet diﬀerentiable
with derivative DC◦G ≡C◦G and all higher order derivatives identically 0.
Thus the operators C◦G are treated straightforwardly with regard to the kinds
of diﬀerentiability considered in this book. Such operators have their own
interest as linear operators. Singh and Manhas [221] consider operators C◦G
followed by multiplication by a suitable function, especially when the domain
of functions F is an Lp space, and list over 400 references. Shapiro [217]
considers the case where S is an open set in the complex plane C and both F
and G are holomorphic, giving nearly 150 references. Rosenthal [194] reviewed
both books.
8.2 Diﬀerentiability of Two-Function Composition in
General
Let F, G, and H be Banach spaces and let V ⊂G be an open set such that
the two-function composition operator TC acts from F × V into H. Fr´echet

8.2 Diﬀerentiability of Two-Function Composition in General
395
diﬀerentiability of TC at a point can be viewed as joint Fr´echet diﬀerentiability
as follows. There is a natural 1-to-1 correspondence between A ∈L(F × G; H)
and (B, C) ∈L(F; H) × L(G; H), given by A(f, g) = B(f) + C(g) for all f ∈F
and g ∈G. Thus the operator TC is Fr´echet diﬀerentiable at (F, G) ∈F × V
from F × V into H if and only if there exist bounded linear partial derivative
operators D1TC(F, G)(·) ∈L(F; H) and D2TC(F, G)(·) ∈L(G; H) such that
∥RemT C(F, G)(f, g)∥H = o(∥f∥F + ∥g∥G)
as f →0 in F and g →0 in G, where for each (f, g) ∈F × G, the remainder
in the diﬀerentiation deﬁned by (5.1) is
RemT C(F, G)(f, g) := RemT C((F, G), (f, g))
(8.4)
= TC(F + f, G + g) −TC(F, G) −D1TC(F, G)(f)
−D2TC(F, G)(g).
If so, then D1TC(F, G)(·) must be C◦G : f 7→f◦G, and D2TC(F, G)(·) must
be the Fr´echet derivative DNF(G) of the autonomous Nemytskii operator
NF , as will be seen in the next theorem. Recall that if NF is diﬀerentiable at
G, the remainder in the diﬀerentiation as deﬁned by (6.3) is RemNF (G, g) =
F ◦(G+g)−F ◦G−((DNF )(G))(g). The theorem also gives a representation
of RemT C(F, G) in which one term is RemNF (G, g).
For a nonempty open set V ⊂G, a family of autonomous Nemytskii op-
erators {Nf : f ∈F} acting from V into H is equicontinuous at G ∈V if for
each ǫ > 0 there is a δ > 0 such that ∥Nf(G + g) −Nf(G)∥H < ǫ for all g ∈G
such that G + g ∈V and ∥g∥G < δ, and all f ∈F. Here is a characterization
of diﬀerentiability of the two-function composition operator TC at a point.
Theorem 8.2. Let X and Y be Banach spaces. Let G = (G, ∥· ∥G) and
H = (H, ∥· ∥H) be non-zero Banach spaces of X- and Y -valued functions
respectively or µ-equivalence classes of them on a nonempty set S. Let U be a
nonempty open subset of X. Let F = (F, ∥· ∥F) be a Banach space of functions
from U into Y . Let F ∈F and G ∈G. Let V be a neighborhood of G in G
such that all functions in V take values in U. Suppose TC acts from F × V
into H. Then TC is Fr´echet diﬀerentiable at (F, G) from F × V into H if and
only if the following three conditions all hold:
(a) the autonomous Nemytskii operator NF acts from V into H and is Fr´echet
diﬀerentiable at G;
(b) for each f ∈F, the autonomous Nemytskii operator Nf is continuous at
G from V into H, and the set {Nf : f ∈F, ∥f∥F ≤1} is equicontinuous
at G;
(c) C◦G = TC(·, G) is a bounded linear operator from F into H.
If so, then the partial derivatives are D1TC(F, G) = C◦G and D2TC(F, G) =
DNF (G). For (f, g) ∈F × G,

396
8 Two-Function Composition
RemT C(F, G)(f, g) = RemNF (G, g) + f◦(G + g) −f◦G.
(8.5)
If, in addition, for some α > 0,
∥RemNF (G, g)∥H = O(∥g∥1+α
G
)
(8.6)
as g →0 in G and for some β > 1 and γ > 1,
∥f◦(G + g) −f◦G∥H = O(∥f∥β
F + ∥g∥γ
G)
(8.7)
as f →0 in F and g →0 in G, then
∥RemT C(F, G)(f, g)∥H = O

∥f∥β
F + ∥g∥min{γ,1+α}
G

,
(8.8)
as f →0 in F and g →0 in G.
Proof. To prove “only if,” assume that TC is Fr´echet diﬀerentiable at (F, G).
Then there exist B ∈L(F, H) and C ∈L(G, H) such that as f →0 in F and
g →0 in G,
∥(F + f)◦(G + g) −F◦G −B(f) −C(g)∥H = o(∥f∥F + ∥g∥G).
(8.9)
Specializing to f = 0, we get that
∥F◦(G + g) −F◦G −C(g)∥H = o(∥g∥G)
(8.10)
as ∥g∥G →0. Thus NF is Fr´echet diﬀerentiable at G with derivative C, proving
(a). Next, letting g = 0 in (8.9), we get that B = C◦G, so (c) must hold.
Combining (8.9) and (8.10) gives as ∥f∥F + ∥g∥G →0,
∥f◦(G + g) −f◦G∥H = o(∥f∥F + ∥g∥G).
(8.11)
Given any ǫ > 0, take δ > 0 such that if ∥f∥F + ∥g∥G < δ and G + g ∈V then
∥f◦(G + g) −f◦G∥H < ǫ(∥f∥F + ∥g∥G).
Take any f ∈F. If 0 < ∥g∥G < δ/(1 + ∥f∥F) and G + g ∈V (such g exist), let
˜f := ∥g∥Gf. Then
∥˜f◦(G + g) −˜f◦G∥H < ǫ(1 + ∥f∥F)∥g∥G.
Thus ∥f◦(G+g)−f◦G∥H < ǫ(1+∥f∥F). If ∥g∥G = 0 then ∥f◦(G+g)−f◦G∥H =
0 by the acting condition. Thus Nf is indeed continuous at G and the set of
all Nf with ∥f∥F ≤1 is equicontinuous at G, since for all such f, ∥g∥G < δ/2
and G + g ∈V imply ∥f◦(G + g) −f◦G∥H < 2ǫ, proving (b) and thus “only
if.”
To prove “if,” suppose (a), (b), and (c) hold. By (a), a C ∈L(G, H)
satisfying (8.10) exists. By (c), B := C◦G is a bounded linear operator. To
prove (8.9) for these B and C we now just need to prove (8.11). If ∥f∥F = 0

8.3 Measure Space Domains
397
then ∥f◦(G + g) −f◦G∥H = 0 by the acting condition. If ∥f∥F > 0 let ˜f :=
f/∥f∥F. Then (b) implies that for every ǫ > 0 there is a δ > 0, not depending
on f by equicontinuity, such that if ∥g∥G < δ and G + g ∈V then for any
t ≥0, ∥t ˜f◦(G + g) −t ˜f◦G∥H ≤ǫt. For t = ∥f∥F this gives
∥f◦(G + g) −f◦G∥H ≤ǫ∥f∥F ≤ǫ(∥f∥F + ∥g∥G),
which implies (8.11). So TC is Fr´echet diﬀerentiable at (F, G), proving “if.”
The partial derivatives D1 and D2 are as stated. Then (8.5) follows directly
from deﬁnition (8.4), and (8.8) follows from (8.5), (8.6), and (8.7). The proof
of the theorem is complete.
2
Corollary 8.3. In Theorem 8.2, (b) can be replaced by
(b′) ∥f◦(G + g) −f◦G∥H = o(∥f∥F + ∥g∥G) as ∥f∥F + ∥g∥G →0.
Proof. To see that (b) implies (b′), the statement holds when f = 0. For f ̸= 0
let ˜f := f/∥f∥F. Then
∥f◦(G + g) −f◦G∥H = ∥f∥F∥˜f◦(G + g) −˜f◦G∥H = o(∥f∥F + ∥g∥G)
as ∥f∥F + ∥g∥G →0, since ∥˜f◦(G + g) −˜f◦G∥H →0 as ∥g∥G →0 uniformly
in f by (b), and noting that G + g ∈V for ∥g∥G small enough, proving (b′).
Conversely, suppose that (a), (b′), and (c) all hold. Then we will show that
TC is Fr´echet diﬀerentiable at (F, G) from F×V into H with the stated partial
derivatives D1TC and D2TC. The given D1TC and D2TC are bounded linear
operators between the appropriate Banach spaces by (c) and (a) respectively.
Thus it remains to show that the expression on the right in (8.5) is o(∥f∥F +
∥g∥G) as ∥f∥F + ∥g∥G →0, which is true by (a) and (b′). The corollary is
proved.
2
8.3 Measure Space Domains
In this section we will consider the two-function composition operator (8.2)
where G and H are spaces of µ-equivalence classes of functions, that is, spaces
included in L0(µ; K) such as Lp(µ; K), where µ is a ﬁnite measure on a set
Ω= S and K = C or R.
Let (Ω, S, µ) be a ﬁnite measure space. As deﬁned in Section 1.4, L0(µ; K)
= L0(Ω, S, µ; K) is the space of all µ-equivalence classes of K-valued µ-
measurable functions on Ω, with the topology of convergence in µ-measure,
metrized by a metric d0. As usual, equivalence classes will be represented by
individual functions in them, and equations or inequalities will be understood
to hold µ-almost everywhere.

398
8 Two-Function Composition
Deﬁnition 8.4. Let G = (G, ∥· ∥) be a normed space and G ⊂L0(µ; K).
We will say that G is a µ-pre-ideal space if for all g ∈G and f ∈L0(µ; K)
with |f| ≤|g| we have f ∈G and ∥f∥≤∥g∥. A µ-pre-ideal space G which
is complete (a Banach space) will be called a µ-ideal space. A µ-(pre)-ideal
space G will be called full if L∞(µ; K) ⊂G and whenever for a sequence
{gn}n≥1 ⊂L∞with supn ∥gn∥∞< ∞and d0(gn, 0) →0 we have ∥gn∥→0.
For example, the spaces Lp(µ; K) are µ-ideal spaces for 1 ≤p ≤∞and
full for 1 ≤p < ∞.
Proposition 8.5. If (Ω, S, µ) is a ﬁnite measure space and G = (G, ∥· ∥)
is a µ-pre-ideal space, then whenever gn, g ∈G and ∥gn −g∥→0 we have
d0(gn, g) →0.
Proof. We can assume g = 0. If d0(gn, 0)̸→0 then taking a subsequence, we
can assume that for some ǫ > 0, µ(A(n)) > ǫ for all n, where A(n) := {ω :
|gn(ω)| > ǫ}. Let hn
:= ǫ1A(n). Then |hn| ≤|gn| and hn is µ-measurable,
so hn ∈G and 1An ∈G with ∥hn∥≤∥gn∥→0. Thus ∥1A(n)∥→0. Taking
a further subsequence, we can assume that ∥1A(n)∥≤1/2n for all n. For any
k ≤n let B(k, n) := Sn
j=k A(j). Then 1B(k,n) ≤Pn
j=k 1A(j), so 1B(k,n) ∈G
and ∥1B(k,n)∥≤21−k. Let B(k) := S∞
j=k A(j). Then µ(B(k)) ≥µ(A(k)) > ǫ
for all k. We have B(k) ↓B as k →∞where µ(B) ≥ǫ. For each k =
1, 2, . . ., there is an n(k) large enough so that µ(B(k) \ C(k)) < ǫ/3k for
C(k) := B(k, n(k)). Let A := T∞
k=1 C(k). Then A = B \ S
k(B(k) \ C(k)),
so µ(A) > ǫ −ǫ/2 = ǫ/2. We have 1A ∈G since 1A ≤1C(1) = 1B(1,n(1)) ∈G
and 1A ∈L0, and for each k, ∥1A∥≤∥1C(k)∥≤21−k. Thus 1A = 0 in G but
not in L0(µ; K), a contradiction since G ⊂L0. This proves the proposition.
2
The next fact follows directly from the deﬁnition of “full”:
Proposition 8.6. If (Ω, S, µ) is a ﬁnite measure space and H = (H, ∥· ∥) is
a full µ-ideal space, then the injection I : L∞(µ) →H is bounded, with norm
∥I∥:= ∥I∥L∞,H < ∞.
For example, if H = Lp(Ω, S, µ), with 1 ≤p < ∞, then H is a full µ-ideal
space with ∥I∥= µ(Ω)1/p.
As one possible class of Banach spaces to serve as F in (8.2) we consider
the Banach spaces of bounded functions deﬁned as follows. Let ℓ∞
U (K) be the
space of all uniformly bounded, universally measurable functions f from K into
itself, with the supremum norm ∥· ∥sup. (Since K is a separable metric space,
recall that universal measurability means that for every Borel set B ⊂K,
f −1(B) is measurable for the completion of every ﬁnite measure µ on the
Borel sets of K.) Then (ℓ∞
U (K), ∥· ∥sup) is a Banach space over K. Recall that
Cb(K) := Cb(K, K) denotes the space of all bounded continuous functions
from K into itself. Then Cb(K) is a Banach subspace of ℓ∞
U (K).

8.3 Measure Space Domains
399
Here are some suﬃcient conditions for acting, boundedness, and continuity
of the two-function composition operator TC.
Theorem 8.7. Let (Ω, S, µ) be a ﬁnite measure space, G a Banach subspace
of L0(µ), and H a full µ-ideal space. Then
(a) TC acts from ℓ∞
U (K) × G into L∞(µ).
(b) If B ⊂ℓ∞
U (K) is bounded, then TC acts from B ×G into a bounded subset
of L∞(µ).
(c) If F ∈ℓ∞
U (K) and G ∈G are such that the autonomous Nemytskii operator
NF is continuous at G from G into H, then TC is jointly continuous at
(F, G) from ℓ∞
U (K) × G into H.
(d) If F ∈Cb(K) and G is a µ-ideal space, then for any G ∈G, TC is jointly
continuous at (F, G) from ℓ∞
U (K) × G into H.
Proof. The proof of (a) is as in that of Theorem 7.13(a). Then that of (b)
is immediate. For (c), TC acts from ℓ∞
U (K) × G into H = (H, ∥· ∥) since
L∞(µ) ⊂H. Let fn →0 in ℓ∞
U (K) and Gn →G in G. Then
∥(F + fn) ◦Gn −F ◦G∥≤∥(F + fn) ◦Gn −F ◦Gn∥+ ∥F ◦Gn −F ◦G∥.
The ﬁrst term equals ∥fn ◦Gn∥, which is at most ∥I∥∥fn∥sup →0 by Propo-
sition 8.6 and since ∥fn◦Gn∥∞≤∥fn∥sup. The second term goes to 0 by
continuity of NF at G. So (c) is proved.
For (d), if F ∈Cb(K) and Gn →G in G, then d0(Gn, G) →0 by Proposi-
tion 8.5. Thus d0(F ◦Gn, F ◦G) →0. The functions F ◦Gn ∈H are uniformly
bounded. Thus by the deﬁnition of full µ-ideal space applied to F ◦Gn−F ◦G,
∥F ◦Gn −F ◦G∥→0. So NF is continuous at (the arbitrary) G ∈G from G
into H, proving (d) and the theorem.
2
Remark 8.8. Suppose G contains some g with µ(g−1({t})) > 0 for some
t ̸= 0, as is true whenever G is a non-zero µ-ideal space. Then by considering
scalar multiples of g, we see that continuity of F in part (d) of the last theorem
is necessary for that of NF .
Let (Ω, S, µ) be a ﬁnite measure space and 1 ≤p < ∞. We will investigate
conditions on Banach spaces F, G such that TC acts from F × G into H :=
Lp(µ) = Lp(Ω, S, µ), and further conditions under which TC is bounded,
continuous at a point, and diﬀerentiable at a point. Here G will be a space of
real-valued S-measurable functions on Ωor of µ-equivalence classes of such
functions, and F will be a space of functions from R into R, as noted early in
Section 8.1.
Suppose that TC acts from F×G into Lp(µ). If F ∈F, then the Nemytskii
operator NF must act from G into Lp(µ). If F ∈F and g, h ∈G with g = h
a.e. (µ) then F◦g = F◦h a.e. (µ). So we may as well take G as a space of
µ-equivalence classes of measurable functions.

400
8 Two-Function Composition
To apply Theorem 7.13, we will take G = Ls(Ω, S, µ), where 1 ≤s ≤∞
and (Ω, S, µ) is complete, nonatomic, and perfect. Then by Theorem 7.13(c),
NF acts from Ls(µ) into Lp(µ), 1 ≤p < ∞, if and only if F satisﬁes the growth
condition F ∈Gs/p and is universally measurable. Under those conditions, NF
is a bounded nonlinear operator.
For Fr´echet diﬀerentiability of TC at (F, G) ∈F × Ls(µ) we need to check
the conditions of Theorem 8.2 for X = Y = U = R. Only condition (b)
involves both f and g. To deal with it we can apply Theorem 7.24, if we take
F = Wp(R). By Proposition 7.28, no other choice of F containing a particular
function with a simple jump can give a smaller bound for the order of the
norm of the remainder term ∥f◦(G + g) −f◦G∥p.
Recall that Dλ = Dλ(Ω, S, µ) is the set of all G ∈L0(Ω, S, µ) for which
µ◦G−1 has a bounded density with respect to Lebesgue measure λ on R; see
also Appendix A. Theorem 7.24 showed that the condition G ∈Dλ is both
necessary and suﬃcient for a sharp H¨older condition on an operator NF , in
the present case on NF ′ for a remainder bound. Also recall that H1+α =
H1+α(R; R) is deﬁned in Deﬁnition 6.5.
Theorem 8.9. Let (Ω, S, µ) be a complete and ﬁnite measure space, let 1 ≤
p < s < ∞and 0 < α < 1 be such that (1+α)p ≤s. Let G ∈Ls(Ω, S, µ)∩Dλ
and F ∈Wp(R) ∩H1+α. Then the two-function composition operator TC is
Fr´echet diﬀerentiable at (F, G) from Wp(R) × Ls(Ω, S, µ) into Lp(Ω, S, µ).
Also, for any b with p(1 + s)/s < b ≤(1 + α)p(1 + s)/s and a := b/(b −1),
the remainder in the diﬀerentiation has the bound (8.8) with β = a and γ =
sb/[p(1 + s)].
Proof. We apply Theorem 8.2 for X = Y = U = R, F = Wp(R), V = G =
Ls(Ω, S, µ), and H = Lp(Ω, S, µ). For each f ∈Wp(R), F + f ∈Wp(R)
is bounded and so satisﬁes the growth condition Gs/p. Also, F + f is Borel
by Corollary 2.2, hence universally measurable. Thus by Theorem 7.13(a),
TC acts from Wp(R) × Ls(Ω, S, µ) into Lp(Ω, S, µ). Condition (a) and (8.6)
hold by Proposition 7.60 with n = 1. Condition (b) holds by Theorem 7.24.
Condition (c) holds since C◦G is bounded and linear Wp →L∞→Lp, and
(8.7) holds by Corollary 7.25.
2
Remark 8.10. In Theorem 8.9, if b > (1+α)p(1+s)/s, then min{1+α, γ} =
1 + α in (8.8), while β would become smaller. Thus there is no advantage in
choosing such b.
Remark 8.11. Let (F, ∥·∥) be a Banach space of bounded Borel measurable
functions from R into R with ∥·∥≥∥·∥sup, such as F = Wp(R). Then for any
function G: Ω→R, measurable for the completion of µ, the map f 7→f◦G
is a bounded linear operator from F into L∞(µ) and so into Lp(µ). Thus
condition (c) of Theorem 8.2 will hold.

8.4 Spaces with Norms Stronger than Supremum Norms
401
The following result complements Theorem 8.9 in case the functions F and
G satisfy the hypotheses of Proposition 7.52 and
α = s(1 + p)
p(1 + s) −1 =
s −p
p(1 + s).
(8.12)
Theorem 8.12. Let (Ω, S, µ) be a complete, nonatomic, ﬁnite measure space,
−∞< a < b < ∞, 1 ≤p < s < ∞, and let α be deﬁned by (8.12). Let F
be a function from R into R whose restriction to [a, b] is in H1+α([a, b]; R),
F(x) = F(a) for all x ≤a, and F(x) = F(b) for all x ≥b, and let G
be a measurable function in Dλ(Ω, S, µ) with values in [a, b]. Then the two-
function composition operator TC acts from Wp×Ls(Ω, S, µ) into Lp(Ω, S, µ)
and is Fr´echet diﬀerentiable at (F, G). The remainder in the diﬀerentiation
has the bound (8.8) with γ = sb/[p(1 + s)] and β = b/(b −1) for any b with
p(1 + s)/s < b ≤1 + p.
Proof. The proof is the same as for Theorem 8.9 except that now in Theorem
8.2, condition (a) and (8.6) hold by Proposition 7.52.
2
8.4 Spaces with Norms Stronger than Supremum Norms
In this section we will consider the two-function composition operator (8.2)
where G and H are normed spaces with norms stronger than supremum norms.
Let B1 = (B1, ∥·∥1) and B2 = (B2, ∥·∥2) be two Banach spaces over a ﬁeld
K = R or C of K-valued functions deﬁned on a nonempty set S. Let B2/B1
be the set of all functions h: S →K such that hg ∈B2 for each g ∈B1 and
g 7→hg is a bounded linear operator from B1 into B2. For each h ∈B2/B1, let
∥h∥2/1 := sup

∥hg∥2: g ∈B1, ∥g∥1 ≤1
	
.
Then B2/B1 equipped with the norm ∥· ∥2/1 is a normed vector space over K.
If B1 contains the constant functions x1(·), x ∈K, then B2/B1 ⊂B2 and the
embedding of B2/B1 into B2 is a bounded operator.
Remark 8.13. The boundedness of g 7→hg in the deﬁnition of the set
B2/B1 is not automatic as the following shows. Let B1 = B2 be an inﬁnite-
dimensional real Banach space with a Hamel basis {ei}i∈I. Thus B1 is the set
of all sums P
i∈I xiei such that xi ∈R and xi = 0 for all but ﬁnitely many
i ∈I. Let S := I. Then B1 is represented as a Banach space of R-valued func-
tions x: i 7→xi on S (namely, the set of all functions from I to R, zero except
at most on ﬁnite sets). For any h: I →R, hx := P
i∈I h(i)xi ∈B2 = B1,
but x 7→hx is not a bounded operator if h is unbounded or since, in general,
x 7→xi is not a bounded linear functional.

402
8 Two-Function Composition
Let U be a nonempty open set in K. Recall that for a vector space of
K-valued functions B, B[U] is the set of all f ∈B such that the closure of
the range ran (f) is included in U. Let (Y (U), ∥· ∥) be a normed space of
K-valued functions deﬁned on U. Later, we will take Y (U) to be the space
H1+p/q(−M, M) with 0 < M < ∞. The following is a characterization of dif-
ferentiability of the two-function composition operator (8.2) at a point (F, G),
where F ∈F = Y (U), G ∈B[U]
1
⊂B1 = G, and H = B2.
Theorem 8.14. Let B1 = (B1, ∥· ∥1) and B2 = (B2, ∥· ∥2) be Banach spaces
over K of K-valued functions on a nonempty set S with pointwise operations
such that B1 ⊂B2, ∥·∥2 ≤∥·∥1 on B1, ∥·∥sup ≤∥·∥2 on B2, and B1 contains
the constant functions x1(·), x ∈K. For a nonempty open set U ⊂K, let
G ∈B[U]
1
and F ∈Y (U). Suppose that TC acts from Y (U) × B[U]
1
into B2.
Then TC is Fr´echet diﬀerentiable at (F, G) if and only if the following three
conditions hold:
(a) F is diﬀerentiable at G(x) for each x ∈S, F ′◦G ∈B2/B1, and as g →0
in B1,
∥F◦(G + g) −F◦G −(F ′◦G)g∥2 = o(∥g∥1);
(8.13)
(b) for each f ∈Y (U), the autonomous Nemytskii operator Nf is continu-
ous at G from B[U]
1
into B2, and the set {Nf : f ∈Y (U), ∥f∥≤1} is
equicontinuous at G;
(c) C◦G = TC(·, G) is a bounded linear operator from Y (U) into B2.
Proof. Since ∥· ∥sup ≤∥· ∥1 on B1, B[U]
1
is an open set in B1. We apply
Theorem 8.2 for X = Y = K, F = Y (U), G = B1, V = B[U]
1 , and H = B2.
Since these choices in (b) and (c) of Theorem 8.2 yield (b) and (c) of Theorem
8.14, one needs only to check the equivalence of the conditions (a).
Suppose that (a) of Theorem 8.2 holds in this case. To show that the
current (a) holds, we use Proposition 6.9 with X = Y = K, G = B1, V = B[U]
1 ,
H = B2, ψ(u, x) ≡F(u), and k = 1. Clearly, x 7→x1(·) is a bounded operator
from K into B1. Since ∥·∥sup ≤∥·∥2 on B2, for each s ∈S, the evaluation h 7→
h(s) is a bounded operator from B2 into K. Since the autonomous Nemytskii
operator NF acts from V = B[U]
1
into B2 and is Fr´echet diﬀerentiable at G, by
the second part of Proposition 6.9, F is diﬀerentiable at G(x) for each x ∈S
and the derivative operator DNF (G) is the linear multiplication operator
M[F ′◦G], and so F ′◦G ∈B2/B1. Thus (8.13) holds since the left side is the
norm of the remainder RemNF (G, g). Since the current condition (a) clearly
implies condition (a) of Theorem 8.2, the proof is complete.
2
Corollary 8.15. In Theorem 8.14, (b) can be replaced by
(b′) ∥f ◦(G + g) −f ◦G∥2 = o(∥f∥+ ∥g∥1) as ∥f∥+ ∥g∥1 →0.

8.4 Spaces with Norms Stronger than Supremum Norms
403
Proof. In Theorem 8.14, (a) is equivalent to condition (a) of Theorem 8.2,
while (b) and (c) are the same as conditions (b) and (c) of Theorem 8.2. Thus
the conclusion holds by Corollary 8.3.
2
Next consider two-function composition TC : F × G →H with G = H =
(ℓ∞(S), ∥· ∥sup) and F = (Hα,∞, ∥· ∥Hα) for some α ∈(0, 1], as deﬁned
before (6.2). Under some conditions we will show its Fr´echet diﬀerentiability
at (F, G), where G: S →[c, d] ⊂(a, b) and F : [a, b] →R.
Proposition 8.16. Let S be a nonempty set, let J be a nonempty open in-
terval (bounded or unbounded), and let 0 < α, β ≤1. Let F ∈H1+β(J; R), let
G ∈ℓ∞(S), and let V be a neighborhood of G in ℓ∞(S) such that all functions
in V take values in J. Then TC acts from Hα,∞(J; R) × V into ℓ∞(S), it is
Fr´echet diﬀerentiable at (F, G) with the remainders
RemNF (G, g)

sup = O(∥g∥1+β
sup )
(8.14)
as ∥g∥sup →0,
f◦(G + g) −f◦G

sup ≤∥f∥Hα∥g∥α
sup,
(8.15)
and
RemT C(F, G)(f, g)

sup = O

∥f∥1+α
Hα + ∥g∥1+min {β,α}
sup

(8.16)
as ∥f∥Hα + ∥g∥sup →0.
Proof. Clearly TC acts from Hα,∞(J; R) × V into ℓ∞(S). We will apply The-
orem 8.2 for X = Y = R, U = J, F = Hα,∞(J; R), and G = H = ℓ∞(S).
By hypothesis, there is a δ > 0 such that ∥G∥sup ≤1/δ and G(s) + u ∈J
for each s ∈S and u ∈R with |u| ≤δ. Recalling the deﬁnition of Uδ before
Proposition 6.3, the range ran (G) is included in U1/m =: Bm for some integer
m with 1/m ≤δ. Thus Fr´echet diﬀerentiability of NF at G and (8.14) follow
from Proposition 6.7 with α there replaced by β. Thus (a) of Theorem 8.2
holds, and (c) clearly holds. Relation (8.15) is immediate from the deﬁnition
of ∥· ∥(Hα) ≤∥· ∥Hα. Since (b) of Theorem 8.2 follows from (8.15), TC is
Fr´echet diﬀerentiable at (F, G) by the ﬁrst part of Theorem 8.2. By inequal-
ity (3.20) of W. H. Young applied to the right side of (8.15), (8.7) holds for
β = γ = 1 + α. Thus (8.16) follows from (8.8), proving the proposition.
2
Remark 8.17. Suppose we are given F ∈H1+β([c, d]; R) with c < d and
want to apply Proposition 8.16 only when G + g also takes values in [c, d].
This can occur for example when G and G + g are probability distribution
functions, with c = 0, d = 1. Then, we can set a := c−1, b := d+1, extend F ′
to be constant on [a, c] and on [d, b], and extend each f ∈Hα([c, d]; R) to an
element of Hα([a, b]; R) without increasing ∥f∥(Hα) or ∥f∥sup, e.g. [53, Prop.
11.2.3] for the metric d(x, y) := |x −y|α, x, y ∈R.

404
8 Two-Function Composition
8.5 Two-Function Composition on Wp Spaces
In this section we consider the two-function composition operator (8.2), where
F is a normed space of functions, G = Wp and H = Wq with 1 ≤p ≤q < ∞.
By Corollary 6.36, F◦G ∈Wq for all G ∈Wp if and only if F satisﬁes a
H¨older condition of order p/q locally. This gives the following acting conditions
for the TC operator.
Proposition 8.18. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with a < b.
Then the two-function composition operator TC acts from Hloc
α
× Wp(J) into
Wq(J).
Generally we consider operators acting on Banach spaces or at least
normed spaces, so we should note that in the preceding proposition, Hloc
α
is not a normed space.
We will show that the joint Fr´echet diﬀerentiability of the two-function
composition operator with Wr, r > q, instead of Wq, holds whenever F and
f have derivatives in the H¨older space Hα with α = p/q. Recall that classes
of such functions, denoted by H1+α ⊂Hloc
1+α, are deﬁned in Deﬁnition 6.5.
Theorem 8.14 characterizes Fr´echet diﬀerentiability of the two-function
composition operator at a point. The following corollary will be applied to
show that condition (a) of Theorem 8.14 holds. It follows from Theorem 6.77
taking n = 1, X = Y = R, U = (−M, M) with 0 < M < ∞, and ψ(u, s) ≡
F(u) not depending on s.
Corollary 8.19. Let 1 ≤p ≤q < r < ∞, α := p/q, J := [a, b] with a < b,
and W := (−M, M) with 0 < M < ∞. Let G ∈W[W]
p
(J) and F ∈Hloc
1+α(W).
Then the autonomous Nemytskii operator NF acts from W[W]
p
(J) into Wp(J)
and is Fr´echet diﬀerentiable at G from W[W]
p
(J) into Wr(J). Moreover, there
exist constants C = C(F, G, M, p, q, r) < +∞and δ = δ(G, M) > 0 such that
for the remainder in the diﬀerentiation of NF ,
∥RemNF (G, g)∥[r] = ∥F◦(G + g) −F◦G −(F ′◦G)g∥[r]
≤C∥g∥1+α−(p/r)
[p]
(8.17)
for each g ∈Wp(J) such that ∥g∥[p] ≤δ.
Now we are ready to state bounds for the remainder RemT C in the joint
diﬀerentiability of the two-function composition operator, given by (8.4) and
(8.5). Recalling the deﬁnitions (6.2), for a nonempty open set U ⊂R and
α ∈(0, 1], let H1+α,∞(U) be the set of all bounded C1 functions f such that
f ′ ∈Hα,∞(U). With the norm ∥f∥1+α,∞:= ∥f∥U,H1 + ∥f ′∥U,Hα, H1+α,∞(U)
is a Banach space.
Theorem 8.20. Let 1 ≤p ≤q < r < ∞, α := p/q, J := [a, b] with a < b, and
W := (−M, M) with 0 < M < ∞. Let G ∈W[W]
p
(J) and F ∈H1+α,∞(W).

8.6 Notes
405
Then the two-function composition operator TC is Fr´echet diﬀerentiable at
(F, G) from H1+α,∞(W) × W[W]
p
(J) into Wr(J). Moreover, there exist con-
stants C = C(F, G, M, p, q, r) < +∞and δ = δ(G, M) > 0 such that
∥RemT C(F, G)(f, g)∥[r] =
(F + f)◦(G + g) −F◦G −f◦G −(F ′◦G)g

[r]
≤C∥g∥[p]
 ∥f∥1+α,∞+ ∥g∥α−(p/r)
[p]

(8.18)
for each f ∈H1+α,∞(W) and for each g ∈Wp(J) such that ∥g∥[p] ≤δ.
Remark 8.21. The bound (8.18), as well as the bound (8.17), holds when
q = r. In this case, however, the stated Fr´echet diﬀerentiability may not hold.
Proof of Theorem 8.20. By Corollary 8.19, TC acts from H1+α,∞(W) ×
W[W]
p
(J) into Wp(J). We apply Theorem 8.14 with S = J, B1 = Wp(J),
B2 = Wr(J), U = W, and Y (U) = H1+α,∞(W). Since p ≤q < r, we have
Wp(J) ⊂Wq(J) ⊂Wr(J) and ∥· ∥[r] ≤∥· ∥[q] ≤∥· ∥[p]. By Proposition 6.34
with α = 1, U = W, and Y = X = R, for f ∈H1,∞(W) we have
∥f◦G∥(r) ≤∥f◦G∥(q) ≤∥f∥W,(H1)∥G∥(q) ≤∥f∥W,(H1)∥G∥(p).
Also, since ∥f◦G∥sup ≤∥f∥W,sup, we have
∥TC(f, G)∥[r] ≤∥f∥W,H1 max{1, ∥G∥(p)}.
Thus (c) of Theorem 8.14 holds. We have ∥G∥sup < M. So, for g ∈Wp(J)
such that ∥g∥[p] < δ1(G, M) := M −∥G∥sup, G + g ∈W[W]
p
(J). Then for
f ∈H1+α,∞(W), by Theorem 6.40 with X = Y = R, it follows that
f◦(G + g) −f◦G

[q] ≤∥f ′∥W,Hα∥g∥[q] max{1, ∥G∥α
(p)}
≤∥f∥1+α,∞∥g∥[p] max{1, ∥G∥α
(p)}.
(8.19)
Thus the autonomous Nemytskii operator Nf is continuous at G from W[W]
p
(J)
into Wr(J), and the set of all functions Nf with f ∈H1+α,∞(W) and
∥f∥1+α,∞≤1 is equicontinuous at G, so (b) of Theorem 8.14 holds. Since (a)
of Theorem 8.14 follows from Corollary 8.19, the desired Fr´echet diﬀerentia-
bility holds. Taking a minimum if necessary, we can assume that δ = δ(G, M)
in the second part of Corollary 8.19 is less than or equal to δ1(G, M). By
(8.5), the bound (8.18) for the remainder follows from (8.19) and (8.17). The
proof of Theorem 8.20 is complete.
2
8.6 Notes
Notes on Section 8.2. In the literature outside of statistics, where we found
that the two-function composition operator (f, g) 7→(F + f)◦(G + g) has

406
8 Two-Function Composition
been considered, f has been assumed diﬀerentiable at least once: Brokate
and Colonius [26], Gray [85], Hartung and Turi [88]; regarding Ck spaces for
k ≥1 and Sobolev spaces see Ebin and Marsden [61, p. 108], who give earlier
references, and on Ck spaces, also Garay [73], whom we thank for pointing
out his paper and some other references. On the C∞case, which apparently
has been much studied in connection with inﬁnite-dimensional Lie groups,
cf. Milnor [171]. On the composition operator for holomorphic functions, cf.
Stevenson [225], [226]; or for linear operators, Dieudonn´e [42, (8.3.1) p. 148].
Thus it was a striking innovation by Reeds [192] to take f non-diﬀerentiable
and indeed discontinuous, in the space D[0, 1] of right-continuous functions
with left limits on [0, 1]. Reeds and, following his lead, Fernholz [65] proved
(compact) diﬀerentiability of the two-function composition operator.
Notes on Section 8.3. Appell and Zabrejko treat Nemytskii operators on
ideal Banach spaces, which we call µ-ideal, in [3, Chapter 2]. What we call
µ-pre-ideal spaces and µ-ideal spaces have been called respectively K¨othe func-
tion spaces and Banach function spaces by many authors, e.g. in the books
[215, p. 127] and [170, p. 115]. The notion of Banach function space apparently
ﬁrst appeared in the 1955 thesis of W. A. J. Luxemburg [148] and was devel-
oped in a series of 19 notes, the ﬁrst 13 with A. C. Zaanen, beginning with
[149]. See also [256, p. 252]. The names “pre-ideal” and “ideal” spaces were
apparently coined by Zabrejko. We have adopted the terms (but added “µ-”)
because there are many Banach spaces of functions such as spaces of contin-
uous, H¨older, or diﬀerentiable functions or Wp spaces which are not µ-ideal
spaces; on the other hand, µ-ideal spaces are spaces of equivalence classes of
functions depending on µ. Proposition 8.5 is well known and appears e.g. as
[215, Prop. 13.2] and [170, Prop. 2.6.3].

9
Product Integration
As we saw in Chapter 1, the matrix-valued product integral ﬁrst arose as a
way of representing the solutions of initial value problems for linear ordinary
diﬀerential equations
df(t)/dt = C(t) · f(t)
and for linear integral equations
f(t) = f(a) +
Z t
a
C(s)f(s) ds,
where −∞< a ≤t < ∞, f has values in Rk, and C is a k × k matrix-valued
function. This representation has a long history, going back to the 1880s. It
originated in work of Volterra [235]. He deﬁned the product integral with
respect to C over an interval [a, t] with a < t to be the limit
f(t) := lim
τ

I + C(sn)(tn −tn−1)

· · ·

I + C(s1)(t1 −t0)

f(a),
(9.1)
as the mesh |τ| of tagged partitions τ = ({ti}n
i=0, {si}n
i=1) of [a, t] tends to
zero, where I is the k × k identity matrix. Almost at the same time, Peano
[183] suggested a representation of the solution as a series of iterated integrals
of the form
f(t) := f(a) +
∞
X
k=1
Z
a<s1<s2<···<sk<t
C(sk) · · · C(s2)C(s1)f(a)dsk · · · ds2ds1
for each t > a, which is often considered as a series representation of the
product integral (9.1). On the history of the product integral generally, see
also the notes at the end of this chapter.
In this book, we consider the product integral with respect to interval
functions rather than point functions. In Theorem 9.51 we will give a Taylor
series expansion for the nonlinear operator induced by the product integral
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_9, 
407

408
9 Product Integration
acting between suitable Banach spaces of interval functions of bounded p-
variation for p < 2. Then, Corollary 9.52 will show that this Taylor expansion
has a form analogous to Peano’s series.
In this chapter, we consider functions with values in a Banach algebra B
with norm ∥· ∥, and assume that B is unital, that is, it contains an identity 1I.
The multiplication from B × B into B will be written (x, y) 7→xy rather than
x·y. Likewise, in integrals the dots between integrands and integrators will be
omitted. In Section 9.12 we consider a Banach space Y and the Banach algebra
B = BY of bounded linear operators from Y into itself (which is unital). There
we treat some Y -valued functions, and in some integrals, dots appear.
9.1 Multiplicative Interval Functions and Φ-Variation
Let J be a nonempty interval in R, let Y be a Banach space, and let I(J; Y )
be the class of all interval functions deﬁned on the set I(J) of subintervals of J
with values in Y as deﬁned in Section 2.1. There, we considered the properties
of additivity and upper continuity, and proved several facts. The Φ-variation
of such functions was introduced and examined in Sections 3.2 and 3.3. If the
Banach space Y is a Banach algebra B, one can deﬁne what will be called a
multiplicative interval function. The product integral deﬁned next will be the
main example of such a function. Recall the deﬁnitions in Section 1.4. Also
recall that a nondegenerate interval is one containing more than one point.
For an interval function µ on J with values in a Banach algebra B, for a
nonempty interval A ⊂J, and for an interval partition A = {Ai}n
i=1 of A, let
P(µ; A, A) :=
n
Y
i=1
 1I + µ(Ai)

=
 1I + µ(An)

· · ·
 1I + µ(A1)

.
(9.2)
Since B may not be commutative, the product sign is used below with the pre-
scribed order. In (1.12) we saw this order in solving linear ordinary diﬀerential
equations. Some authors use the reverse order.
Deﬁnition 9.1. Let µ ∈I([a, b]; B) with −∞< a ≤b < +∞. We say that
the product integral
(1I + dµ) with respect to µ is deﬁned on [a, b] if for each
nonempty A ∈I[a, b] the limit
A
(1I + dµ) := lim
A P(µ; A, A)
(9.3)
exists under reﬁnements of partitions A of A. We deﬁne
∅(1I + dµ) := 1I.
Thus the product integral
(1I + dµ): A 7→
A(1I + dµ), A ∈I[a, b], if it
exists, is a B-valued interval function on [a, b].

9.1 Multiplicative Interval Functions and Φ-Variation
409
Remark 9.2. The product integral is of most interest when µ is additive.
But additivity is by no means necessary for existence of the product integral,
as can be seen as follows. Let a < b and let µ be an interval function on [a, b]
having a product integral. For example, let µ be additive, speciﬁcally, µ ≡0.
Let 0 < c < b −a. Let ν be an interval function on [a, b] equal to µ on all
intervals of length less than c and deﬁned arbitrarily on other subintervals
of [a, b]. Then ν has a product integral equal to that of µ, since in taking
reﬁnements of partitions we will eventually have only intervals of length less
than c. Clearly, ν will not be additive nor bounded in general.
Deﬁnition 9.3. An interval function ρ on [a, b] with values in a Banach al-
gebra B will be called multiplicative if ρ(∅) = 1I and for any A, B ∈I[a, b] such
that A ∪B ∈I[a, b] and A ≺B if both intervals are nonempty, we have
ρ(A ∪B) = ρ(B)ρ(A).
(9.4)
If instead of (9.4), we have ρ(A ∪B) = ρ(A)ρ(B) then ρ will be called ∗-
multiplicative.
Remark 9.4. The order of multiplication in (9.4) is as in the solution of
(forward) initial value problems; see (1.12).
The product integral (9.3), if it exists, is a multiplicative interval function,
as we will show in Proposition 9.27. Simple examples of multiplicative interval
functions can be given using invertible point functions as follows. Recall that
[a, b]± = {a, a+, b−, b} ∪S
a<t<b{t−, t, t+} as deﬁned in (6.9). Let h be a
regulated function on [a, b] with values in B. Then h extends naturally to a
function ˜h on [a, b]± (see Proposition 6.20). If each x in {˜h(t): t ∈[a, b]±} ⊂B
has an inverse x−1, then we say that h is an invertible function, and deﬁne
the reciprocal function hinv on [a, b]± by hinv(u) := (h(u))−1 for each u ∈
[a, b]±. By Theorem 4.16(b), the reciprocal function hinv is regulated whenever
deﬁned. That is, for a ≤s < t ≤b, we have
lim
u↓s hinv(u) = hinv(s+)
and
lim
u↑t hinv(u) = hinv(t−).
(9.5)
Moreover, by Theorem 4.16(a), if ∥x−1I∥< 1 then x has an inverse x−1. Thus
if ∥h(t) −1I∥< 1 for each t ∈[a, b]± then h is an invertible function.
If h is an invertible function on [a, b], let αh := αh,[a,b] be the interval
function on [a, b] deﬁned on open intervals or singletons ⊂[a, b] by
αh,[a,b]((s, t)) := h(t−)h(s+)inv
for a ≤s < t ≤b,
αh,[a,b]({t}) := h(t+)h(t−)inv
for a < t < b,
αh,[a,b]({a}) := h(a+)h(a)inv
and
αh,[a,b]({b}) := h(b)h(b−)inv
if a < b, and αh,[a,a]({a}) := αh,[a,a](∅) := 1I if a = b. Then αh extends
uniquely to a multiplicative interval function on [a, b].

410
9 Product Integration
Here we consider upper continuity and Φ-variation of an arbitrary multi-
plicative interval function. Recall Deﬁnition 2.3 of upper continuous interval
functions and Deﬁnition 3.16 of the p-variation of an interval function.
Next is an example of a multiplicative interval function which is neither
upper continuous at ∅nor has bounded p-variation for any 0 < p < ∞.
Example 9.5. As in Example 2.4, let (B, ∥· ∥) be either the Banach space
ℓ∞[0, 1] with the supremum norm or the Banach space L∞([0, 1], λ) with the
essential supremum norm, where λ is Lebesgue measure. In both cases B is a
Banach algebra under pointwise multiplication. Also, B is commutative and
unital with the identity 1I being the function equal to 1 everywhere on [0, 1].
For an interval A ⊂[0, 1], let ρ(A) := 1I + 1A. Thus ρ is an interval function
from I[0, 1] into B. If intervals A, B ⊂[0, 1], A ≺B, and A ∪B is again an
interval, then
ρ(B)ρ(A) = (1I + 1B)(1I + 1A) = 1I + 1B + 1A = ρ(A ∪B).
Since also ρ(∅) = 1I, the interval function ρ is multiplicative. Let Ak ↓∅and
Ak ̸= ∅if B = ℓ∞[0, 1], or λ(Ak) > 0 if B = L∞([0, 1], λ). Then ∥ρ(Ak)∥=
2 ̸→1 = ∥µ(∅)∥, so ρ is not upper continuous at ∅. Let A = {Ai}n
i=1 be an
interval partition of [0, 1], with λ(Ai) > 0 in the case B = L∞([0, 1], λ), and
0 < p < ∞. Then
sp(ρ; A) =
n
X
i=1
∥1Ai∥p = n.
Since n is arbitrary, vp(ρ; [0, 1]) = +∞.
As for additive interval functions, the following three propositions char-
acterize multiplicative upper continuous interval functions. Given an interval
function µ on [a, b] deﬁne the functions Rµ,a and Lµ,b on [a, b] respectively by
Rµ,a(t) :=
 µ(∅)
if t = a,
µ([a, t]) if t ∈(a, b],
and
Lµ,b(t) :=
µ([t, b]) if t ∈[a, b),
µ(∅)
if t = b.
The function Rµ,a on [a, b] agrees with the function Rµ,a on [[a, b]] deﬁned by
(2.3). We say that an interval function µ on J is bounded if sup{∥µ(A)∥: A ∈
I(J)} < ∞. The following statement is similar to parts of Proposition 2.6.
Proposition 9.6. Let ρ be a B-valued bounded and multiplicative interval
function on J = [a, b].Then the following three statements are equivalent:
(a) ρ is upper continuous;
(b) ρ is upper continuous at ∅;
(c) ρ(An) →1I whenever open intervals An ↓∅and
card{t ∈J : ∥ρ({t}) −1I∥> ǫ} < ∞
for all ǫ > 0.
(9.6)
Any of (a), (b), or (c) implies the following two statements:

9.1 Multiplicative Interval Functions and Φ-Variation
411
(d) Rρ,a is regulated, Rρ,a(t−)=ρ([a, t)) for t ∈(a, b], and Rρ,a(t+)=ρ([a, t])
for t ∈[a, b);
(e) Lρ,b is regulated, Lρ,b(t−) = ρ([t, b]) for t ∈(a, b], and Lρ,b(t+) = ρ((t, b])
for t ∈[a, b).
Moreover, statement (b) holds if either of the following two statements holds:
(d′) statement (d) holds and Rρ,a is an invertible function;
(e′) statement (e) holds and Lρ,b is an invertible function.
Proof. (a) ⇔(b): clearly, (a) implies (b). For (b) ⇒(a), let intervals An ↓A.
Then An = Bn ∪A∪Cn for intervals Bn ≺A ≺Cn, with Bn ↓∅and Cn ↓∅.
So ρ(An) = ρ(Cn)ρ(A)ρ(Bn) →ρ(A) by continuity of the product in B.
(b) ⇒(c). The ﬁrst part of statement (c) is clear. For the second part,
suppose that there exist an ǫ > 0 and an inﬁnite sequence {tj : j ≥1} of
distinct points of J such that
∥ρ({tj}) −1I∥> ǫ
for all j ≥1.
(9.7)
Then there exist t ∈J and a subsequence {t′
j : j ≥1} such that either t′
j ↓t
or t′
j ↑t as j →∞. In the ﬁrst case, by multiplicativity of ρ, we have
ρ((t, t′
j]) −1I = ρ({t′
j}) [ρ((t, t′
j)) −1I] + ρ({t′
j}) −1I.
Due to the boundedness assumption, supj ∥ρ({tj})∥< ∞. Thus the left side
and the ﬁrst term on the right side tend to zero because (t, t′
j] ↓∅and (t, t′
j) ↓
∅. Hence ρ({t′
j}) →1I as j →∞. This contradicts (9.7). Therefore (9.6) holds
in the ﬁrst case. A proof in the second case is symmetric.
For (c) ⇒(b), let intervals An ↓∅. Then for some t and n0, either for all
n ≥n0, An = (t, sn]] for some sn ∈(t, b), or for all n ≥n0, An = [[sn, t) for
some sn ∈(a, t). Using continuity of the multiplication in B, in each of the
two cases, ρ(An) →1I follows by (c).
For (b) ⇒(d), since ρ is bounded and multiplicative, we have for a < t ≤b,
Rρ,a(s) −ρ([a, t)) =

1I −ρ((s, t))

ρ([a, s]) →0
as s ↑t, and for a ≤t < b,
Rρ,a(s) −ρ([a, t]) =

ρ((t, s]) −1I

ρ([a, t]) →0
as s ↓t. Thus Rρ,a is regulated and (d) holds. The implication (b) ⇒(e)
follows by a symmetric argument.
For (d′) ⇒(b), let intervals An ↓∅. Then for some t and n0, either for
all n ≥n0 An is left-open at t ∈[a, b), or for all n ≥n0 An is right-open at
t ∈(a, b]. If An = (t, sn]] for a ≤t < sn < b, then by multiplicativity of ρ, we
have
ρ(An) = ρ([a, sn]])(Rρ,a)inv(t+) =
Rρ,a(sn+)(Rρ,a)inv(t+) if An = (t, sn],
Rρ,a(sn−)(Rρ,a)inv(t+) if An = (t, sn),

→Rρ,a(t+)(Rρ,a)inv(t+) = 1I
as n →∞.

412
9 Product Integration
If An = [[sn, t) for a < sn < t ≤b, then again by multiplicativity of ρ and by
(9.5) with h = Rρ,a, we have
ρ(An)
=

ρ([a, t))(Rρ,a)inv(sn−) if An = [sn, t),
ρ([a, t))(Rρ,a)inv(sn+) if An = (sn, t),

→Rρ,a(t−)(Rρ,a)inv(t−) = 1I
as n →∞, proving (b). The implication (e′) ⇒(b) follows by a symmetric
argument. The proof of Proposition 9.6 is now complete.
2
We will say that an interval function ρ on J is nondegenerate if for any
A1, A2, . . . ∈I(J) such that An ↓∅, ρ(An) is invertible for all suﬃciently
large n. (This is unrelated to the notion of nondegenerate interval.) Every
element x ∈B such that ∥x −1I∥< 1 is invertible (Theorem 4.16(a)). Thus a
multiplicative interval function upper continuous at ∅is nondegenerate. The
following together with Proposition 9.6 completes the analogy to Proposition
2.6.
Proposition 9.7. Let ρ be a multiplicative interval function on [a, b]. Then
(a) ⇒(c) ⇒(b), and (b) ⇒(a) if, in addition, ρ is nondegenerate, where
(a) ρ is upper continuous at ∅;
(b) ρ(An) →ρ(A) whenever intervals An ↑A;
(c) ρ(An) →ρ(A) whenever intervals An →A ̸= ∅.
Proof. For (a) ⇒(c), let intervals An →A ̸= ∅. If A = (u, v) then {u} ≺
An ≺{v} for n large enough. For such n, there are intervals Cn and Dn with
{u} ≺Cn ≺An ≺Dn ≺{v} and Cn ∪An ∪Dn = A. Also for such n, we
have either Cn = ∅or Cn = (u, ·]], and either Dn = ∅or Dn = [[·, v). Clearly
Cn →∅. If N := {n: Cn ̸= ∅} is inﬁnite, there is a function j 7→n(j) onto N
such that Cn(j) ↓∅. Thus ρ(Cn) →1I. Similarly ρ(Dn) →1I. Each xn ∈B such
that ∥xn−1I∥< 1 has an inverse x−1
n
and x−1
n
→1I as xn →1I (Theorem 4.16).
Therefore for all large enough n, ρ(An) = ρ(Dn)−1ρ(A) ρ(Cn)−1 →ρ(A) as
n →∞. Similar arguments work for the other cases A = (u, v], [u, v) and
[u, v].
Clearly, (c) implies (b). For (b) ⇒(a), let intervals An ↓∅. Then for
some t and n0, either for all n ≥n0, An = (t, sn]] for some sn ∈(t, b), or
for all n ≥n0, An = [[sn, t) for some sn ∈(a, t). Suppose that An = (t, sn]]
for all n ≥n0 ≥1. Since ρ is nondegenerate we can assume that ρ(An0)
is invertible. Then An0 = An0+k ∪Bk for some intervals Bk = [[sn0+k, sn0]],
k ≥1, with Bk ↑An0. Since the set U of all invertible elements x in B is open
and x 7→x−1 is a continuous function on U, ρ(Bk)−1 →ρ(An0)−1 as k →∞
(Theorem 4.16(b)). Since ρ is multiplicative, ρ(An0+k) = ρ(Bk)−1ρ(An0) →1I
as k →∞. A similar argument works in the case An = [[·, t) for some t ∈(a, b].
The proof of Proposition 9.7 is complete.
2

9.1 Multiplicative Interval Functions and Φ-Variation
413
Let ρ be a B-valued interval function on J. If for each A ∈I(J), ρ(A) has
an inverse (ρ(A))−1, then we say that ρ is an invertible interval function, and
deﬁne the reciprocal interval function ρinv on J by ρinv(A) := (ρ(A))−1 for
each A ∈I(J).
Proposition 9.8. Let ρ be a bounded multiplicative interval function on [a, b].
Then the following two statements are equivalent:
(a) ρ is upper continuous at ∅and invertible;
(b) statements (d) and (e) of Proposition 9.6 hold, and the functions Rρ,a and
Lρ,b are both invertible.
Moreover, if (a) or (b) holds then the reciprocal interval function ρinv of ρ is
∗-multiplicative,
ρinv([s, t])
(9.8)
=



Rρ,a(s−)(Rρ,a)inv(t+) = (Lρ,b)inv(s−)Lρ,b(t+) if a < s ≤t < b,
(Rρ,a)inv(t+)
= (Lρ,b)inv(a)Lρ,b(t+)
if a = s ≤t < b,
Rρ,a(s−)(Rρ,a)inv(b)
= (Lρ,b)inv(s−)
if a < s ≤t = b;
ρinv((s, t])
(9.9)
=
 Rρ,a(s+)(Rρ,a)inv(t+) = (Lρ,b)inv(s+)Lρ,b(t+) if a ≤s < t < b,
Rρ,a(s+)(Rρ,a)inv(b)
= (Lρ,b)inv(s+)
if a ≤s < t = b;
ρinv([s, t))
(9.10)
=
 Rρ,a(s−)(Rρ,a)inv(t−) = (Lρ,b)inv(s−)Lρ,b(t−) if a < s < t ≤b,
(Rρ,a)inv(t−)
= (Lρ,b)inv(a)Lρ,b(t−)
if a = s < t ≤b;
and
ρinv((s, t)) = Rρ,a(s+)(Rρ,a)inv(t−) = (Lρ,b)inv(s+)Lρ,b(t−)
(9.11)
if a ≤s < t ≤b.
Proof. (a) ⇒(b): since ρ is upper continuous at ∅, statements (d) and (e) of
Proposition 9.6 hold. To show that Rρ,a is an invertible function, let x be in
the closure of the set {Rρ,a(t): a ≤t ≤b}. Due to compactness of [a, b] and
by statement (d) of Proposition 9.6, there exists t ∈[a, b] such that for some
sequence {tk}k≥1 ⊂[a, b], t = limk tk and either x = Rρ,a(t) = ρ([a, t]), or
x = Rρ,a(t+) = ρ([a, t]) with a ≤t < b, or x = Rρ,a(t−) = ρ([a, t)) with
a ≤t < b. Thus x has an inverse x−1 = ρinv([a, t]]), and since x is arbitrary,
Rρ,a is an invertible function. A symmetric argument yields that Lρ,b is also
an invertible function, completing the proof of (b).
(b) ⇒(a): the interval function ρ is upper continuous at ∅by the last part
of Proposition 9.6. Let Rinv be the reciprocal function of Rρ,a, and let Linv

414
9 Product Integration
be the reciprocal function of Lρ,b. To show that ρ((s, t]) has an inverse for
a ≤s < t ≤b, let
xr := Rρ,a(s+)(Rinv)(b)
+ (t)
and
xl := Linv(s+)ρ((t, b]),
where f (b)
+ = f(t+) if t ∈[a, b) or = f(b) if t = b. Due to multiplicativity of ρ
and by statements (d) and (e) of Proposition 9.6, we have
xl = Linv(s+)ρ((t, b])ρ([a, t])(Rinv)(b)
+ (t)
= Linv(s+)ρ((s, b])ρ([a, s])(Rinv)(b)
+ (t) = xr,
ρ((s, t])xr = ρ((s, t])ρ([a, s])(Rinv)(b)
+ (t) = (Rρ,a)(b)
+ (t)(Rinv)(b)
+ (t) = 1I,
and
xlρ((s, t]) = Linv(s+)ρ((t, b])ρ((s, t]) = Linv(s+)Lρ,b(s+) = 1I.
Thus the inverse (ρ((s, t]))−1 exists and equals xr = xl. Similarly it follows
that inverses (ρ(A))−1 exist for A = [s, t), A = (s, t), and A = [s, t], and so the
reciprocal interval function ρinv is deﬁned on [a, b] with values given by (9.8),
(9.9), (9.10), and (9.11). Thus (a) holds. Moreover, if intervals A, B satisfy
A ≺B and A ∪B is an interval then ρinv(A ∪B) = ρinv(A) ρinv(B), and so
ρinv is ∗-multiplicative.
2
Proposition 9.9. If a B-valued interval function ρ is multiplicative and up-
per continuous on [a, b] then ρ is bounded.
Proof. Suppose not. Recall that the oscillation Osc for interval functions, de-
ﬁned in (2.7), equals the supremum norm. By compactness of [a, b] and multi-
plicativity of ρ, there are t ∈[a, b] and a sequence of closed intervals {Ak}k≥1
such that Ak ↓{t} and Osc(ρ; Ak) = +∞for each k ≥1. Let {Bk}k≥1 be
a sequence of intervals such that ∥ρ(Bk)∥→+∞and Bk ⊂Ak for each
k ≥1. If inﬁnitely many Bk contain t or have t as an endpoint, then taking
a subsequence, we can assume that Bk ↓{t} or Bk ↓∅, contradicting upper
continuity. So we can assume that t < ck ≤dk and Bk = [[ck, dk]] ̸= ∅
for each k ≥1. Again by upper continuity, we have ρ((t, ck]]) →1I and
ρ((t, dk]]) →1I as k →∞. By Theorem 4.16, ρ((t, ck]]) are invertible for all
suﬃciently large k and ρ((t, ck]])−1 →1I as k →∞, and so by multiplicativity,
ρ(Bk) = ρ((t, dk]])ρ((t, ck]])−1 →1I as k →∞, a contradiction, proving the
proposition.
2
Multiplicative interval functions do not form a linear space: if ρ is multi-
plicative then for a constant c ̸= 1, cρ is not since cρ(∅) = c1I ̸= 1I. This is
one reason why the nonlinear operator induced by the product integral and

9.2 Product Integrals for Real-Valued Interval Functions
415
deﬁned on additive interval functions is considered in most of the rest of this
chapter as acting from a subspace of the Banach space of interval functions
of bounded p-variation into itself, for p < 2.
Recall (Section 3.1) that V is the class of all functions Φ: [0, ∞) →[0, ∞)
which are strictly increasing, continuous, unbounded, and 0 at 0, and CV is the
class of those Φ ∈V which are convex. Let Φ ∈CV and let J be a nonempty
interval. The Φ-variation for interval functions is deﬁned in Section 3.2 by
(3.35), and the set of all interval functions on J with values in a Banach algebra
B and having bounded Φ-variation is denoted by IΦ(J; B). Then eIΦ(J; B) is
the set of all interval functions µ ∈I(J; B) such that cµ ∈IΦ(J; B) for some
c > 0. By Proposition 3.22, µ 7→∥µ∥(Φ) = sup{inf{c > 0: vΦ(µ/c; A) ≤
1}: A ∈I(J)} for µ ∈eIΦ(J; B) is a seminorm, which we call the Φ-variation
seminorm. The next fact follows from Proposition 3.20 since µ(∅) = 1I for µ
multiplicative.
Corollary 9.10. For Φ ∈CV and µ ∈eIΦ([a, b]; B) multiplicative, ∥µ∥(Φ) = 0
if and only if µ ≡1I.
9.2 Product Integrals for Real-Valued Interval Functions
Let µ be an additive real-valued interval function on [a, b]. For a nonempty
interval A ⊂[a, b], and for an interval partition A = {Ai}n
i=1 of A, recall
the product P(µ; A, A) deﬁned by (9.2). Also recall that the product integral
A(1+dµ) with respect to µ over a nonempty interval A is deﬁned and equals
C ∈R if for any ǫ > 0, there exists an interval partition B of A such that
|P(µ; A, A) −C| < ǫ for any interval partition A of A which is a reﬁnement
of B. If A is the empty set the product integral is deﬁned by
A(1 + dµ) = 1.
We say that the product integral
(1 + dµ) exists on [a, b] if it is deﬁned over
each interval A ⊂[a, b]. We further say that the product integral
(1 + dµ)
exists and is non-zero on [a, b] if for each interval A ∈I[a, b],
A(1 + dµ) is
deﬁned and non-zero.
The main result of this section is the next theorem, which gives nec-
essary and suﬃcient conditions for the product integral with respect to
an additive and upper continuous interval function to exist and be non-
zero. Recall (Deﬁnition 3.28) that an additive and upper continuous inter-
val function µ has 2∗-variation on [a, b], or µ ∈AI∗
2[a, b] ≡AI∗
2([a, b]; R), if
σ2(µ; [a, b]) = v∗
2(µ; [a, b]) < +∞(as deﬁned in (3.40) and (3.41)).
Theorem 9.11. Let µ be a real-valued additive and upper continuous interval
function on [a, b]. The product integral
(1 + dµ) exists and is non-zero on
[a, b] if and only if µ ∈AI∗
2[a, b] and µ({t}) ̸= −1 for all t ∈[a, b].
Before proving the theorem we note that the characterization of additive µ
such that
(1+dµ) exists and is non-zero may fail if µ is not upper continuous
at ∅, as the following shows.

416
9 Product Integration
Example 9.12. Let µ be the additive interval function on [0, 2] deﬁned in
Example 3.51, which has bounded p-variation for all p ∈(0, ∞) but is not
upper continuous at ∅. If A is an interval included in [0, 1] or in [d, 2] for any
d > 1, then
A(1 + dµ) = 1. If A is not such an interval then A includes (1, c)
for some 1 < c ≤2, and so
A(1+dµ) = 1+r. The product integral
(1+dµ)
is a multiplicative interval function on [0, 2] which has bounded p-variation
for any p, but is not upper continuous at ∅. Also, µ({t}) = 0 ̸= −1 for each
t ∈[0, 2], but
[0,2](1 + dµ) = 0 for r = −1.
The proof of Theorem 9.11 starts with a series of auxiliary statements
which together will prove the necessity part. Then we will prove the suﬃciency
part of the theorem.
By Taylor’s theorem with remainder, for u ∈(−1, 1),
log(1 + u) = u −θ(u)
2
u2,
(9.12)
where
θ(u) = −d2
dv2 log(1 + v) =
1
(1 + v)2
for some v between 0 and u. Thus for |u| ≤ǫ < 1, (9.12) holds with
1
(1 + ǫ)2 ≤θ(u) ≤
1
(1 −ǫ)2 .
(9.13)
Let µ be an additive and upper continuous interval function on [a, b], and
let A ⊂[a, b] be a nondegenerate interval, in other words, we recall, A con-
tains more than one point. By Corollary 2.12, there exists a Young interval
partition B = {(zj−1, zj)}m
j=1 of A such that Osc(µ; (zj−1, zj)) ≤1/2 for all
j = 1, . . . , m. Let B := {zj}m
j=0 ∩A and let A = {Ai}n
i=1 be an interval par-
tition of A which is a reﬁnement of the Young interval partition B, and let
I = I(A, B) be the set of all indices i ∈{1, . . ., n} such that B ∩Ai = ∅. Then
using the notation (9.2), we have
P(µ; A, A) = exp
n X
i∈I
µ(Ai) −1
2
X
i∈I
θiµ(Ai)2o Y
t∈B
 1 + µ({t})

= exp
n
µ(A) −1
2
X
i∈I(A,B)
θiµ(Ai)2oY
t∈B
 1 + µ({t})

exp

−µ({t})
	
,
(9.14)
where by (9.13), 4/9 ≤θi := θ(µ(Ai)) ≤4 for i ∈I(A, B).
Lemma 9.13. Let µ be an additive and upper continuous interval function
on [a, b]. If
[a,b](1 + dµ) exists and is non-zero then v2(µ) < ∞.
Proof. We can assume that a < b. There exist ǫ > 0 and a Young interval
partition B = {(zj−1, zj)}m
j=1 of [a, b] such that Osc(µ; (zj−1, zj)) ≤1/2 for

9.2 Product Integrals for Real-Valued Interval Functions
417
j = 1, . . . , m, and |P(µ; [a, b], A)| ≥ǫ for each interval partition A of [a, b]
which is a reﬁnement of B. Then (9.14) holds with A = [a, b]. Thus we have
ǫ ≤
P(µ; [a, b], A)

≤exp
n
µ([a, b]) −2
9
X
i∈I(A,B)
µ(Ai)2o Y
t∈B
1 + µ({t})
 exp

−µ({t})
	
for any reﬁnement A of B. If v2(µ) = +∞, then by (3.39), for some j,
v2(µ; (zj−1, zj)) = +∞. Then by choosing A, P
i∈I(A,B) µ(Ai)2 can be made
arbitrarily large, and so |P(µ; [a, b], A)| is arbitrarily small. This contradiction
proves v2(µ) < ∞.
2
The following example shows that the assumption in Lemma 9.13 that the
product integral is non-zero is essential.
Example 9.14. Let µ be the interval function on [0, 1] deﬁned as follows: for
k = 2, 3, . . ., µ({1/(2k −1)}) := 1/
√
k, µ({1/(2k)}) := −1/
√
k, and for any
interval A ⊂[0, 1],
µ(A) :=
∞
X
k=3
µ
 {1/k}

1A(1/k).
For an interval A ⊂[0, 1], if 0 ̸∈¯A then µ(A) is a ﬁnite sum. Also, if (0, ǫ) ⊂A
for some 0 < ǫ < 1, then µ(A) is a conditionally convergent sum, and for
each n ≥2, µ((0, 1/(2n −1)]) = 0 and µ((0, 1/(2n)]) = −1/√n. Clearly, µ is
additive and upper continuous. It has bounded p-variation on [0, 1] if and only
if p > 2. The product integral with respect to µ exists, and
A(1 + dµ) = 0
whenever (0, ǫ) ⊂A for some 0 < ǫ < 1 because Q
j≥k(1 −j−1) = 0 for all k.
In this example
(1 + dµ) is degenerate (not nondegenerate, in the sense
deﬁned before Proposition 9.7), and it is not upper continuous although µ is.
Let ξ be a real-valued function deﬁned on a nonempty set T . The product
Q
T ξ will be said to converge unconditionally to a number C if C ̸= 0 and for
each ǫ > 0 there is a ﬁnite set B ⊂T such that

Y
t∈D
ξ(t) −C
 < ǫ
(9.15)
for each ﬁnite subset D of T including B. We have the following:
Lemma 9.15. Let ξ be a function from a nonempty set T into R. Then the
following two statements are equivalent:
(a) For every δ > 0 there is a ﬁnite set B ⊂T such that for every ﬁnite
E ⊂T \ B, |1 −Q
t∈E ξ(t)| < δ.
(b) The sum P
T (1 −ξ) converges absolutely, that is, ξ(t) = 1 except for at
most countably many t ∈T and P
t∈T |ξ(t) −1| < ∞.

418
9 Product Integration
Moreover, the product Q
T ξ converges unconditionally if and only if both (a)
holds and ξ(s) ̸= 0 for all s ∈T .
Proof. If |ξ(t) −1| > 1/2 for inﬁnitely many t ∈T then both (a) and (b)
fail, so we can assume that |ξ(t) −1| ≤1/2 except for t in a ﬁnite set F. Let
xi = ξ(ti) −1 for some ti ∈T \ F. If |x| ≤1/2 then e−2|x| ≤1 + x ≤e|x|.
Thus if 0 < δ ≤1/2 and P
i |xi| < δ then
1 −2δ ≤e−2δ ≤
Y
i
(1 + xi) ≤eδ ≤1 + 2δ.
Letting δ ↓0, it follows that (b) implies (a). Conversely, if P
i |xi| = +∞then,
taking a subsequence, we have |xi| ≤1/2 for all i and either:
(i) xi > 0 for all i and P
i xi = +∞, in which case ∞= exp{P
i≥j xi/2} =
Q
i≥j(1 + xi) for any j,
or
(ii) xi < 0 for all i and P
i xi = −∞, in which case 0 = exp{P
i≥j xi} =
Q
i≥j(1 + xi) for any j.
In either case, (a) fails, so (a) implies (b) and the two are equivalent.
Now suppose Q
T ξ converges unconditionally to some C ̸= 0. Then ξ(s) ̸=
0 for all s ∈T , since otherwise (9.15) is violated for ǫ = |C|/2 and D = B∪{s}.
It suﬃces to prove (a) for 0 < δ < 1. Let ǫ := |C|δ/5. Take a ﬁnite set B ⊂T
such that (9.15) holds for the given ǫ. To show that (a) holds for the same B
and δ as deﬁned, suppose it fails for some ﬁnite E ⊂T . Let Q
A := Q
t∈A ξ(t)
for any ﬁnite A ⊂T . Apply (9.15) to D = B and to D = B ∪E. We get
| Q
B −C| < ǫ and | Q
B∪E −C| < ǫ. Thus
2ǫ > |
Y
B∪E
−
Y
B
| = |
Y
B
| · |
Y
E
−1| ≥|C|δ
2
= 5ǫ
2 ,
a contradiction. So (a) holds.
Conversely, suppose (a) holds and ξ(t) ̸= 0 for all t ∈T . From the proof of
equivalence of (a) and (b) it follows that P
t∈T \F log ξ(t) converges absolutely
to a limit L. It then follows that Q
t∈T ξ(t) converges unconditionally to C =
eL Q
t∈F ξ(t) ̸= 0.
2
For any real-valued interval function µ on [a, b] and nonempty subset T ⊂
[a, b], let
γ(µ; T ) :=
Y
T
(1 + µ)e−µ :=
Y
t∈T
(1 + µ({t}))e−µ({t})
(9.16)
provided the product converges unconditionally, and γ(µ; ∅) := 1.

9.2 Product Integrals for Real-Valued Interval Functions
419
Lemma 9.16. Let µ be an upper continuous, additive interval function on
[a, b] such that σ2(µ; [a, b]) < ∞and µ({t}) ̸= −1 for all t ∈[a, b]. Then
γ(µ; T ) as deﬁned by (9.16) exists for all sets T ⊂[a, b] and is bounded, with
inf{|γ(µ; T )|: T ⊂[a, b]} > 0. For any disjoint sets D, E ⊂[a, b],
γ(µ; D)γ(µ; E) = γ(µ; D ∪E).
(9.17)
Thus, restricted to I[a, b], γ(µ; ·) is a multiplicative and bounded interval func-
tion.
Proof. By Taylor’s theorem with remainder, for |u| ≤1/2,
ξ(u) := (1 + u)e−u = 1 −θ(u)
2 u2,
where
1
2√e ≤θ(u) ≤3√e
2 .
(9.18)
Since µ is upper continuous, by Proposition 2.6(c), there is an at most count-
able set C ⊂[a, b] such that µ({t}) ̸= 0 just for t ∈C and a ﬁnite set F ⊂C
such that |µ({t})| ≤1/2 for all t ∈[a, b] \ F. Thus ξ(µ({t})) = 1 for all
t ∈[a, b] \ C and
X
t∈[a,b]\F
1 −ξ(µ({t}))
 ≤(3√e/4)σ2(µ) < ∞.
(9.19)
Therefore the product (9.16) converges unconditionally for any nonempty set
T ⊂[a, b] by Lemma 9.15, and (9.17) holds by the deﬁnition of product. By
(9.18), (9.19), and Lemma 9.15, for any set D ⊂[a, b] \ F, 0 < γ(µ; D) ≤1.
Thus by (9.17), for each set T ⊂[a, b], we have |γ(µ; T )| ≤maxE⊂F |γ(µ; E)| <
∞and
γ(µ; T )
 ≥γ(µ; [a, b] \ F) min
E⊂F
γ(µ; E)
 > 0.
The results for intervals follow, proving the lemma.
2
For the next statement recall that s2(µ; A) = Pn
i=1 µ(Ai)2 for any interval
partition A = {Ai}n
i=1 of [a, b].
Lemma 9.17. Let µ be an additive and upper continuous interval function
on [a, b]. If
[a,b](1 + dµ) exists and is non-zero then the limit
lim
A s2(µ; A)
(9.20)
exists under reﬁnements of partitions A of [a, b].
Proof. We can assume that a < b. By Corollary 2.12, it follows that given
ǫ ∈(0, 1/2], there exists a Young interval partition B = {(zj−1, zj)}m
j=1 of
[a, b] such that Osc(µ; (zj−1, zj)) < ǫ for j = 1, . . . , m. Since
[a,b](1+dµ) ̸= 0,
µ({t}) ̸= −1 for a ≤t ≤b. By Lemma 9.13, v2(µ) < ∞, and so by Lemma 9.16,

420
9 Product Integration
the interval function γ(µ) given by (9.16) is well deﬁned. Let B := {zj}m
j=0,
and taking a reﬁnement of B and thus of B, we can assume that the set B is
large enough so that, by the method of proof of Lemma 9.15,
G :=
 log |γ(µ; [a, b])| −log |γ(µ; B)|
 < ǫ.
Since
[a,b](1 + dµ) exists and is non-zero, we can also assume that
H :=
 log

[a,b]
(1 + dµ)
 −log
P(µ; [a, b], A)

 < ǫ
for any interval partition A of [a, b] which is a reﬁnement of B. Letting
C := µ([a, b]) + log |γ(µ; [a, b])| −log

[a,b]
(1 + dµ)
,
which does not depend on B, A, or ǫ, it then follows by (9.14) with A = [a, b]
that
1
2
X
i∈I(A,B)
θiµ(Ai)2 −C
 ≤G + H < 2ǫ
for any interval partition A = {Ai}n
i=1 of [a, b] which is a reﬁnement of B.
Since |µ(Ai)| ≤ǫ for each i ∈I(A, B), we have by (9.13),
2(1 −ǫ)2(C −2ǫ) <
X
i∈I(A,B)
µ(Ai)2 < 2(1 + ǫ)2(C + 2ǫ).
Therefore for any two interval partitions A′ = {A′
i} and A′′ = {A′′
i } of [a, b]
which are reﬁnements of B, we have
s2(µ; A′)−s2(µ; A′′)
 =

X
i∈I(A′,B)
µ(A′
i)2−
X
i∈I(A′′,B)
µ(A′′
i )2 < 8ǫ(1+ǫ2+C).
Since ǫ > 0 is arbitrary, the proof is complete.
2
By Lemma 3.27 with p = 2, the limit (9.20) exists if and only if
σ∗
2(µ; [a, b]) = v∗
2(µ; [a, b]) < +∞. Since σ∗
2(µ; [a, b]) = σ2(µ; [a, b]) by Proposi-
tion 3.26, it follows then that µ ∈AI∗
2[a, b]. Now we are ready to ﬁnish the
proof of Theorem 9.11.
Proof of Theorem 9.11. We can assume that a < b. Since µ is upper
continuous and additive, it is bounded by Corollary 2.12. First suppose that
(1 + dµ) exists and is non-zero on [a, b], in particular on each singleton {t},
t ∈[a, b]. Thus µ({t}) ̸= −1 for each t ∈[a, b] by the deﬁnition of product
integral. The interval function µ has 2∗-variation, by Lemmas 3.27 and 9.17
and Proposition 3.26. Thus the “only if” part holds.

9.2 Product Integrals for Real-Valued Interval Functions
421
Now suppose that µ ∈AI∗
2[a, b] is such that µ({t}) ̸= −1 for all t ∈[a, b].
Let A ⊂[a, b] be a nondegenerate interval and let ǫ ∈(0, 1/4]. By Lemma
3.25, σ2(µ; A) < ∞, and so by Lemma 9.16, γ(µ; T ) given by (9.16) is well
deﬁned for any subset T ⊂A, (9.17) holds for any disjoint subsets D, E of T ,
and
0 < C1 := inf{|γ(µ; B)|: B ⊂A} ≤C2 := sup{|γ(µ; B)|: B ⊂A} < ∞.
Therefore by deﬁnition of unconditionally convergent product, there exists a
ﬁnite set B0 ⊂A such that
1 −γ(µ; A \ B)
 ≤|γ(µ; A) −γ(µ; B)|/C1 < ǫ
(9.21)
for any ﬁnite B such that B0 ⊂B ⊂A. Since µ ∈AI∗
2[a, b], by Lemma 3.29
with p = 2, there exists a Young interval partition B = {(zj−1, zj)}m
j=1 of A
such that B := A ∩{zj}m
j=0 ⊃B0 and
m
X
j=1
v2(µ; (zj−1, zj)) < ǫ.
(9.22)
Let A = {Ai}n
i=1 be an interval partition of A which is a reﬁnement of B, and
let I = I(A, B) be the set of all indices i ∈{1, . . . , n} such that Ai ∩B = ∅.
By (9.22), for each i ∈I, |µ(Ai)| ≤√ǫ ≤1/2. Thus by (9.14), we have
P(µ; A, A) −eµ(A)γ(µ; A)
= eµ(A)γ(µ; B)
h
exp
n
−1
2
X
i∈I(A,B)
θiµ(Ai)2o
−γ(µ; A \ B)
i
,
where θi = θ(µ(Ai)) for i ∈I(A, B). Since |1 −e−x| ≤|x|e|x| for any x ∈R,
by (9.13) and (9.22), it follows that
1 −exp
n
−1
2
X
i∈I(A,B)
θiµ(Ai)2o
≤C
X
i∈I(A,B)
µ(Ai)2 ≤C
m
X
j=1
v2(µ; (zj−1, zj)) < Cǫ
where C := 2 exp{2v2(µ; A)}. This together with (9.21) gives the bound
P(µ; A, A) −eµ(A)γ(µ; A)
 ≤e∥µ∥supC2
 C + 1

ǫ
(9.23)
for any reﬁnement A of the Young interval partition B of A. Since ǫ > 0 is
arbitrary, the product integral
A(1+dµ) is deﬁned and equal to eµ(A)γ(µ; A)
if A ⊂[a, b] is a nondegenerate interval. The same conclusion clearly holds
if A is a singleton. So for each A ∈I[a, b],
A(1 + dµ) ̸= 0 if and only if

422
9 Product Integration
γ(µ; A) ̸= 0, which is true whenever the product is deﬁned, proving the “if”
part. The proof of Theorem 9.11 is complete.
2
The preceding proof of Theorem 9.11 also gives the value of the prod-
uct integral over an interval. In particular, recalling the notation (9.2) and
Deﬁnition 9.1, the bound (9.23) implies the following:
Corollary 9.18. Let µ be as in Theorem 9.11. If the product integral with
respect to µ exists and is non-zero on [a, b], then for any interval A ⊂[a, b],
A
(1 + dµ) = eµ(A) Y
A
(1 + µ)e−µ,
where the product converges unconditionally for nonempty A, and equals 1 for
A = ∅.
Let µ be as in Theorem 9.11 and let µ({t}) ̸= −1 for all t ∈[a, b]. By that
theorem, for µ ̸∈AI∗
2[a, b], if the product integral with respect to µ exists it
must be zero. Example 9.14 gives a µ ∈AIp[a, b] := AIp([a, b]; R) for all
p > 2 such that
[a,b](1 + dµ) = 0. The following shows that for p = 2 this
cannot happen. Propositions 3.63 and 3.58 and Corollary 3.59 give examples
of interval functions satisfying the hypothesis.
Proposition 9.19. Let µ be in AI2(J) but not in AI∗
2(J) for J = [a, b] with
a < b, and assume that µ({t}) ̸= −1 for all t ∈J. Then
J(1 + dµ) does not
exist.
Proof. By the assumptions, Proposition 3.26, and Deﬁnition 3.28, σ2(µ; J) =
σ∗
2(µ; J) < v∗
2(µ; J). Let c := (v∗
2 −σ2)(µ; J) and let ǫ > 0. By Corollary
2.12, there exists a Young interval partition {(zj−1, zj)}m
j=1 of J such that
Osc(µ; (zj−1, zj)) < 1/2 for j = 1, . . . , m. By Lemma 9.16, the product γ(µ; J)
is not 0. Moreover, letting B := {zj}m
j=0, we can assume that
(1 −ǫ)
γ(µ; J)
 ≤
γ(µ; B)
 ≤(1 + ǫ)
γ(µ; J)

and 0 ≤σ2(µ; J)−P
t∈B µ({t})2 < ǫ. Let B be a reﬁnement of {(zj−1, zj)}m
j=1.
By (3.42), B has a reﬁnement A1 such that s2(µ; A1) < σ2(µ; J) + ǫ. By
(9.14), since θi ≤4 for i ∈I(A1, B) and P
i∈I(A1,B) µ(Ai)2 = s2(µ; A1) −
P
t∈B µ({t})2, it follows that
P(µ; J, A1)
 > eµ(J)γ(µ; J)
(1 −ǫ) exp{−4ǫ}.
On the other hand, by (3.41), there is another reﬁnement A2 of B such that
s2(µ; A2) > v∗
2(µ; J) −ǫ = c + σ2(µ; J) −ǫ. Again by (9.14), since θi ≥4/9
for i ∈I(A2, B), it follows that
P(µ; J, A2)
 < eµ(J)γ(µ; J)
(1 + ǫ) exp{−(2/9)(c −ǫ)}.

9.2 Product Integrals for Real-Valued Interval Functions
423
Thus, letting ǫ ↓0,
J(1 + dµ) does not exist.
2
But the results of this section for real-valued interval functions do not
extend even to 3-dimensional Banach algebras, as the following proposition
and example will show.
Proposition 9.20. Let B be a Banach algebra, let J be a nondegenerate in-
terval, and let µ ∈I(J; B) be additive and such that
µ(B)µ(A) = 0
if A, B ∈I(J) and A ∩B = ∅.
(9.24)
Then for any interval C ⊂J, the product integral
C(1I+dµ) exists and equals
1I + µ(C).
Proof. Since µ is additive, it is easily seen that for any partition A of C, the
product P(µ; C, A) equals 1I + µ(C), and the conclusion follows.
2
If µ is an additive interval function satisfying the conditions of Proposition
9.20, then µ has certain properties if and only if
(1I + dµ) does, for example,
bounded p-variation for any p ∈(0, ∞).
Example 9.21. Let B be the Banach algebra of 2 × 2 upper triangular real
matrices with usual addition and multiplication, and the matrix (operator)
norm ∥T ∥:= sup{∥Tx∥: x ∈R2, ∥x∥≤1}. Let J be a nondegenerate interval,
and let ν be an additive real-valued interval function on J. For A ∈I(J), let
µ(A) :=
 0 ν(A)
0
0

.
Then µ is an additive interval function on J with values in B and µ(A)µ(B) =
0 for any A and B, so (9.24) holds. Thus the product integral
(1I+dµ) exists
and equals 1I + µ ̸= 0.
The last example shows that Theorem 9.11 for the one-dimensional Banach
algebra R does not extend to a 3-dimensional Banach algebra B. Let h(x) :=
(1/ log(2/x)) cos(π/x) for x ∈(0, 1] and h(0) := 0. Then ν = µh is upper
continuous by Theorem 2.7 and does not have bounded p-variation for any
p ∈(0, +∞) since P
j |ν((1/(j + 1), 1/j])|p = +∞.
In other examples, in contrast to Theorem 9.11, µ is not upper continuous.
In Example 2.5, µ is a real-valued additive interval function for which the
functions Lµ,a and Rµ,a are regulated but µ is not upper continuous. Here
is an easily described example where B is inﬁnite-dimensional. The condition
(9.24) is satisﬁed also by the additive interval function µ(A) = 1A, A ∈
I[0, 1], which is neither upper continuous nor has bounded p-variation for any
0 < p < ∞when considered with values either in ℓ∞[0, 1] or in L∞([0, 1], λ)
(as in Example 2.4). By Proposition 9.20 the multiplicative interval function
A 7→1I + 1A, A ∈I[0, 1], of Example 9.5 is the product integral with respect
to µ.

424
9 Product Integration
9.3 Nonexistence for p > 2
Recall that AIp([a, b]; B) is the set of all additive, upper continuous interval
functions on [a, b] with values in the Banach algebra B having bounded p-
variation (Deﬁnition 3.16). Most of this chapter, beginning with Section 9.4,
will give positive results about product integrals for interval functions in AIp
with p < 2. The next fact, and Theorem 9.11, give some reasons why p < 2 is
needed. It will be shown that for p > 2 the product integral may not exist. Let
M2(R) be the Banach algebra of 2×2 real matrices with the matrix (operator)
norm.
Proposition 9.22. There exists an interval function µ ∈AIp([0, 1]; B) for
all p ∈(2, ∞) such that the product integral
(1I + dµ) does not exist if
(a) B = M2(R);
(b) B is the 1-dimensional complex Banach algebra C, the ﬁeld of complex
numbers;
(c) B = R.
Proof. For (a) let ck > 0 be any sequence of real numbers with P
k c2
k = +∞
but P
k cp
k < ∞for all p > 2, such as ck = 1/
√
k. Deﬁne a 2×2 matrix-valued
interval function µ on [0, 1] as follows. For a nonempty interval J ⊂[0, 1],
let µ(J)
:=
P∞
k=1 µk(J) where µk(J) = ckT [1J(1/(2k −1)) −1J(1/(2k))]
and T =
  0
1
−1 0

, and µ(∅) := 0. For a given interval J, clearly µk(J) ̸=
0 for at most two values of k, so the sum deﬁning µ converges. Here
µ is an additive, upper continuous interval function. For k = 1, 2, . . . ,
let B2k−1 := [1/(2k), 1/(2k −1)] and B2k := (1/(2k + 1), 1/(2k)). Then
vp(µ; B2k−1) = 2cp
k and vp(µ; B2k) = 0 for each k. By Proposition 3.56 for
{Bj}2n−1
j=1 , vp(µ; [1/(2n), 1]) ≤2p P∞
k=1 cp
k for each integer n ≥1. Since µ is
upper continuous it follows that vp(µ; [0, 1]) ≤supn vp(µ; [1/(2n), 1]) < ∞.
Thus µ ∈AIp([0, 1]; M2(R)) for all p > 2. Any interval partition of [0, 1], for
each suﬃciently large k ≥1, has a reﬁnement A which contains intervals Ai,
i = 1, . . . , 2k + 1, such that 1/j ∈A2k+2−j for j = 1, . . . , 2k and 1/j ∈A1 for
all j > 2k. Then
P(µ; [0, 1], A) =
2k+1
Y
r=1
(1I + µ(Ar)) =
k
Y
i=1
(1I −c2
i T 2) =
k
Y
i=1
(1 + c2
i )1I
because on all other intervals in A, µ is 0. These products evidently diverge
as k →∞.
For the complex case (b) we can just replace the matrix T by the number
i = √−1.
In case (c) let f(x)
:=
√x cos(π/x) for 0 < x ≤1 and f(0)
:=
0.
Then f is continuous. Let µ([[a, b]]) := f(b) −f(a) for 0 ≤a ≤b ≤1. Then
µ ∈AIp[0, 1] for any p > 2 by (3.7) with Φ(u) := up and g(t) :=
√
t and
by Proposition 3.30. But µ /∈AI2[0, 1], since P
j µ((aj+1, aj])2 = +∞for

9.4 Inequalities for Finite Products
425
aj := 1/j, j = 1, 2, . . . . Given any interval partition B := {Bi}k
i=1 of [0, 1],
if B1 = {0} then renumber the intervals so that B0 := {0} and in any case
B1 = [[0, b]] for some b > 0.
However the partition B2, . . . , Bk of [[b, 1] is reﬁned, the product over the
resulting intervals will approach a bounded non-zero limit, namely ef(1)−f(b),
by Corollary 9.18.
Consider two kinds of partitions of B1, each giving a kind of reﬁnement of
B. In one kind, subdivide B1 into intervals with endpoints 0, b, and 1/r for
r = 2m−1, 2m, . . ., 2n+1 for some positive integers m < n with 1/(2m−1) <
b. The product of 1 +µ over the resulting partition of B1 will have a bounded
factor 1 + f(1/(2n + 1)) and a factor
n
Y
j=m

1 +
1
√2j +
1
√2j + 1
 
1 −
1
√2j −
1
√2j −1

≤
n
Y
j=m

1 −1
2j

→0
as n →∞. Thus the inﬁmum of the given products is 0.
In another kind of partition, subdivide B1 by ﬁrst choosing a smallest
endpoint c > 0 and then dividing [c, b]] arbitrarily ﬁnely. Then by Corollary
9.18 again the products over partitions of [c, b]] approach ef(b)−f(c), and 1+f(c)
remains bounded.
Thus the products over the resulting subintervals of B1 will approach a
bounded non-zero limit. Since the limits for the two kinds of reﬁnements are
diﬀerent, the product integral does not exist.
2
9.4 Inequalities for Finite Products
As the examples from the end of Section 9.2 show, product integrals in a
general Banach algebra require a correspondingly general treatment, which
we begin to prepare now.
Let x1, . . . , xn be arbitrary elements in B, and let
n
Y
j=1
(1I + xj) := (1I + xn) · · · (1I + x1) = 1I +
n
X
k=1
X
1≤j1<···<jk≤n
xjk · · · xj1.
For k = 1, . . . , n, letting
Hk(m) :=
m
X
j=k
xj Hk−1(j −1),
m = k, . . . , n,
(9.25)
where H0(m) := 1I for m = 0, 1, . . . , n, it then follows that
n
Y
j=1
(1I + xj)
= 1I +
n
X
k=1
Hk(n).
(9.26)

426
9 Product Integration
For 0 < p < ∞and x = (x1, . . . , xn), xi ∈B, recall the notation
vp(x) = max
n m
X
j=1

θ(j)
X
i=θ(j−1)+1
xi

p
: 1 ≤m ≤n,
(9.27)
0 = θ(0) < θ(1) < · · · < θ(m) = n
o
.
Clearly, vp(x) = vΦ(x) with Φ(r) ≡rp, r ≥0, deﬁned by (3.136) and (6.30).
Next is the main result of this section:
Theorem 9.23. Let 1 ≤p < 2 and let x = (x1, . . . , xn). For each k =
1, . . . , n,
Hk(n)
 ≤Ck
p
vp(x)k
k!
1/p
,
(9.28)
where Cp = 1 + 41/pζ(2/p) and ζ(r) = P∞
k=1 k−r for r > 1.
Before proving the theorem we give an application of these bounds. Recall
(1.20) that for 1 ≤p < ∞, ∥µ∥J,(p) = vp(µ; J)1/p. For products P(µ; J, A) as
deﬁned by (9.2) we have the following inequalities.
Corollary 9.24. Let 1 ≤p < 2, let a < b, and let µ ∈Ip([a, b]; B) be additive.
Let Cp be the constant from (9.28) and let
K := K(µ, p) := 1 +
∞
X
k=1
Ck
p
vp(µ; [a, b])k
k!
1/p
.
(9.29)
Then for each nonempty interval J ⊂[a, b] and for any interval partition A
of J, we have
P(µ; J, A)
 ≤K,
(9.30)
P(µ; J, A) −1I
 ≤CpK∥µ∥J,(p),
(9.31)
P(µ; J, A) −1I −µ(J)
 ≤C2
pK∥µ∥2
J,(p).
(9.32)
Proof. Let A = {Ai}n
i=1 be an interval partition of J. Then letting x :=
(µ(A1), . . . , µ(An)), we have vp(x) ≤vp(µ; J) ≤vp(µ; [a, b]), and the corollary
follows from Theorem 9.23 and (9.26), where for (9.32), H1(n) = µ(J).
2
Recall that for a regulated function f on [a, b] we deﬁned the function f (a)
−
on [a, b] with values f (a)
−(t) = f(t−) if t ∈(a, b] or = f(a) if t = a. To prove
Theorem 9.23 we will use step functions deﬁned recursively by
fk(t) := (RRS)
Z t
0
dh (fk−1)(0)
−,
t ∈[0, 1],
(9.33)

9.4 Inequalities for Finite Products
427
where h is a right-continuous step function depending on the n-tuple x, f0 ≡
1I, and k = 1, . . . , n. Then the proof of Theorem 9.23 will be based on the
inequalities in the next two lemmas.
Lemma 9.25. Let ρ be a nondecreasing function on [a, b] with a < b, let
{ti}n
i=0 be a point partition of [a, b] with n ≥2, and let k be a positive integer.
Then there exists an index i ∈{1, . . ., n −1} such that

ρk(ti) −ρk(ti−1)

ρ(ti+1) −ρ(ti)

≤
4
(n −1)2
ρk+1(b) −ρk+1(a)
k + 1

.
Proof. Letting ∆iχ := χ(ti)−χ(ti−1) for a function χ, for each i = 1, . . . , n−1,
we have
∆iρk∆i+1ρ = k
Z ρ(ti)
ρ(ti−1)
uk−1 du ∆i+1ρ
≤k
Z ρ(ti)
ρ(ti−1)
u(k−1)/2 du ρ(ti)(k−1)/2
ρ(ti+1) −ρ(ti)

≤k
Z ρ(ti)
ρ(ti−1)
u(k−1)/2 du
Z ρ(ti+1)
ρ(ti)
u(k−1)/2 du.
(9.34)
Then we get
min
1≤i≤n−1

∆iρk∆i+1ρ
	
=

min
1≤i≤n−1
p
∆iρk∆i+1ρ
2
≤
n
1
n −1
n−1
X
i=1
p
∆iρk∆i+1ρ
o2
.
By (9.34) and using the inequality 2√uv ≤u+v for u, v ≥0, we can continue
the above inequality with
≤
n
1
n −1
√
k
2
 Z ρ(tn−1)
ρ(a)
u(k−1)/2 du +
Z ρ(b)
ρ(t1)
u(k−1)/2 du
o2
≤
n √
k
n −1
Z ρ(b)
ρ(a)
u(k−1)/2 du
o2
=
n 2
√
k
n −1
ρ(k+1)/2(b) −ρ(k+1)/2(a)
k + 1
o2
≤
4
(n −1)2
ρk+1(b) −ρk+1(a)
k + 1

,
where in the last step, the inequality (d −c)2 < d2 −c2 for 0 < c < d was
used. The proof is complete.
2
The next inequality will be used to bound the p-variation of the functions
fk deﬁned by (9.33).

428
9 Product Integration
Lemma 9.26. Let 1 ≤p < 2, let a < b, and let h ∈Wp([a, b]; B) be right-
continuous on [a, b). Also, let f ∈Wp([a, b]; B) be right-continuous on (a, b)
and f(a) = 0. Assume that for a nondecreasing function ρ on [a, b] with
ρ(a) ≥0 and for a positive integer k,
∥f(t) −f(s)∥≤Ck
p
ρk(t) −ρk(s)
k!
1/p
(9.35)
and
∥h(t) −h(s)∥≤
 ρ(t) −ρ(s)
1/p
(9.36)
for each a ≤s < t ≤b, where Cp is the constant from (9.28). Then the
indeﬁnite integral I(f, dh)(t) := (RRS) ∫t
a dh f (a)
−, t ∈[a, b], exists and for
any a ≤c < d ≤b,
I(f, dh)

[c,d],(p) ≤Ck+1
p
ρk+1(d) −ρk+1(c)
(k + 1)!
1/p
.
Proof. Since h and f (a)
−
have no common one-sided discontinuities, the in-
deﬁnite integral I(f, dh) exists by Deﬁnition 2.41 of the full Stieltjes integral
and by Theorem 3.92. Let eh := [(k!)1/p/Ck
p] h. By the additivity property of
I(f, deh) (Corollary 2.91), we have for a ≤u < v ≤b,
I(f, deh)(v) −I(f, deh)(u) = (RRS)
Z v
u
deh f (u)
−.
Thus it is enough to prove that for any a ≤u < v ≤b,
(RRS)
Z v
u
deh f (u)
−
 ≤[1 + 41/pζ(2/p)]
ρk+1(v) −ρk+1(u)
k + 1
1/p
.
(9.37)
Let a ≤u < v ≤b and let ǫ > 0. There exists a point partition λ = {ti}n
i=0 of
[u, v] with n ≥2 such that for each si ∈(ti−1, ti], i = 1, . . . , n, if u > a, or for
each si ∈(ti−1, ti], i = 2, . . . , n, and s1 = a if u = a,
(RRS)
Z v
u
deh f (u)
−
−
n
X
i=1
eh(ti) −eh(ti−1)

f (u)
−(si)
 < ǫ.
Let S(λ) := Pn
i=1[eh(ti)−eh(ti−1)]f(ti−1). Since f is right-continuous on (a, b),
letting si ↓ti−1 for each i such that si > ti−1, it follows that
(RRS)
Z v
u
deh f (u)
−
−S(λ)
 ≤ǫ.
Let λi := λ \ {ti} for each i ∈{1, . . ., n −1}. Then by (9.36) and (9.35), we
have

9.4 Inequalities for Finite Products
429
∥S(λ) −S(λi)∥≤∥eh(ti+1) −eh(ti)∥∥f(ti) −f(ti−1)∥
≤

[ρ(ti+1) −ρ(ti)] [ρk(ti) −ρk(ti−1)]
	1/p.
By Lemma 9.25, there exists an index i ∈{1, . . ., n −1} such that
∥S(λ) −S(λi)∥≤
n
4
(n −1)2
ρk+1(v) −ρk+1(u)
k + 1
o1/p
.
Deleting further points according to Lemma 9.25, we obtain the bound
(RRS)
Z v
u
deh f (u)
−
 ≤41/p
∞
X
m=2
1
(m −1)2/p
ρk+1(v) −ρk+1(u)
k + 1
1/p
+ ∥[eh(v) −eh(u)]f(u)∥+ ǫ.
(9.38)
Since f(a) = 0, by (9.35), ∥f(u)∥p ≤[Ckp
p /k!]ρk(u). Then by (9.36), we have
∥[eh(v) −eh(u)]f(u)∥p ≤[ρ(v) −ρ(u)]ρk(u) ≤
Z ρ(v)
ρ(u)
tk dt = ρk+1(v) −ρk+1(u)
k + 1
.
Letting ǫ ↓0 in (9.38), it then follows that (9.37) holds, proving the lemma.
2
Now we are ready to prove the inequalities (9.28).
Proof of Theorem 9.23. Let tj := j/n, j = 0, 1, . . . , n, and let h be the
right-continuous B-valued step function on [0, 1] deﬁned by
h(t) :=



0
if t ∈[0, t1),
Pj
i=1 xi if t ∈[tj, tj+1), j = 1, . . . , n −1,
Pn
i=1 xi if t = tn.
For this h, and f0 := 1I on [0, 1], deﬁne B-valued functions fk, k = 1, . . . , n,
on [0, 1] by (9.33). Since h and (fk−1)(0)
−
have no common one-sided discon-
tinuities and h is a step function, the integral (9.33) exists by Theorem 2.17.
Each fk, k = 1, . . . , n, is a right-continuous step function equal to 0 on [0, tk),
constant on [tj, tj+1), j = k, . . . , n −1, and having jumps at tj, j = k, . . . , n,
given by
∆−fk(tj) = ∆−h(tj)fk−1(tj−) = xjfk−1(tj−).
Thus for m = k, . . . , n,
fk(tm) =
m
X
j=k
∆−fk(tj) =
m
X
j=k
xjfk−1(tj−).
Since f1 ≡h, it then follows from (9.25) that fk(tm) = Hk(m) for k = 1, . . . , n
and m = k, . . . , n. Also since xi = h(ti) −h(ti−1) for i = 1, . . . , n, we have

430
9 Product Integration
vp(x) = vp(h; [0, 1]). Since ∥Hk(n)∥= ∥fk(1)∥≤∥fk∥[0,1],(p), it is enough to
prove that for k = 1, . . . , n,
fk

[s,t],(p) ≤Ck
p
vp(h; [0, t])k −vp(h; [0, s])k
k!
1/p
(9.39)
for each 0 ≤s < t ≤1. Since f1 ≡h and Cp ≥1, (9.39) holds for k = 1 by
(3.51). Suppose (9.39) holds for some 1 ≤k < n. Applying Lemma 9.26 to
f = fk and ρ := vp(h; [0, ·]), we conclude that (9.39) holds with k replaced
by k + 1. Thus by induction, (9.39) holds for k = 1, . . . , n, proving Theorem
9.23.
2
9.5 The Product Integral
Here we will prove that the product integral with respect to an additive in-
terval function µ with values in a Banach algebra exists provided µ is upper
continuous and has bounded p-variation for some 1 ≤p < 2. First we show
that the product integral, if it exists, is a multiplicative interval function. For
this, recalling Remark 9.2, µ need not be additive.
Proposition 9.27. Let µ be an interval function on [a, b] with values in a
Banach algebra B such that µ(∅) = 0. The product integral
(1I + dµ), if it
exists as an interval function on [a, b], is multiplicative.
Proof. Let A, B ∈I[a, b] be such that A∪B ∈I[a, b]. To prove multiplicativity
we can assume that a < b, and that the intervals A, B are nonempty and
A ≺B. Since
(1I + dµ) exists over each of the intervals A, B and A ∪B,
there exist nested sequences Ak
A, Ak
B, and Ak
A∪B of interval partitions of A,
B, and A ∪B, respectively, such that for C = A, C = B, and C = A ∪B,
C
(1I + dµ) = lim
k→∞P(µ; C, Ak
C).
Moreover, taking reﬁnements of partitions if necessary, we can assume that
for each k ≥1, Ak
A∪B = Ak
A ∪Ak
B. Therefore for each k ≥1, we have
P(µ; A ∪B, Ak
A∪B) = P(µ; B, Ak
B)P(µ; A, Ak
A).
Taking the limit on both sides as k →∞, it follows that
A∪B
(1I + dµ) =
B
(1I + dµ)
A
(1I + dµ).
Since A and B with the stated properties are arbitrary, the product integral
(1I + dµ) is a multiplicative interval function on [a, b], as claimed.
2

9.5 The Product Integral
431
Now we are ready to prove the main result of this section. Recall that
AIp([a, b]; B) is the class of all B-valued additive and upper continuous interval
functions on [a, b] with bounded p-variation.
Theorem 9.28. Let µ ∈AIp([a, b]; B) with 1 ≤p < 2. The product integral
A 7→
A(1I + dµ) is an upper continuous, bounded, and multiplicative interval
function on [a, b], and for each A ∈I[a, b],

A
(1I + dµ)
 ≤K,
(9.40)

A
(1I + dµ) −1I
 ≤CpK
µ

A,(p),
(9.41)

A
(1I + dµ) −1I −µ(A)
 ≤C2
pK
µ
2
A,(p),
(9.42)
where K = K(µ, p) and Cp are as deﬁned in (9.29) and (9.28), respectively.
Proof. To prove the convergence of some products we will use the algebraic
identity
m
Y
j=1
xj −
m
Y
j=1
yj =
m
X
i=1
 m+1
Y
j=i+1
xj
 xi −yi
 i−1
Y
j=0
yj

,
(9.43)
valid by a telescoping sum for any elements x1, . . . , xm and y1, . . . , ym of a
Banach algebra, where we set xm+1 := y0 := 1I. We can assume that a < b.
Let A = (s, t) ⊂[a, b] be open, and let ǫ > 0. By Proposition 3.52, there exists
a Young interval partition {(zj−1, zj)}m
j=1 of A such that
max
1≤j≤m vp(µ; (zj−1, zj)) < ǫ.
(9.44)
For j = 1, . . . , m, let B2j−1 := (zj−1, zj), and for j = 1, . . . , m −1, let B2j :=
{zj}. Let A = {Ai}n
i=1 be a reﬁnement of B = {Bk}2m−1
k=1 . For j = 1, . . . , m, let
I(j) be the set of indices i such that Ai ⊂(zj−1, zj), and for j = 1, . . . , m−1,
let the index i(j) be such that Ai(j) = B2j. Also for j = 1, . . . , m, let
Uj :=
 Qn
i=i(j)

1I + µ(Ai)

if j = 1, . . . , m −1,
1I
if j = m,
and
Vj :=
 Q2j−2
k=1

1I + µ(Bk)

if j = 2, . . . , m,
1I
if j = 1.
To apply the algebraic identity (9.43), with 2m −1 in place of m, let x2r−1 =
Q
i∈I(r)(1I + µ(Ai)), r = 1, . . . , m, x2r = 1I + µ(Ai(r)), r = 1, . . . , m −1, and
yj = 1I + µ(Bj), j = 1, . . . , 2m −1. Then x2r = y2r, r = 1, . . . , m −1, and we
get

432
9 Product Integration
P(µ; A, A) −P(µ; A, B)

=

m
X
j=1
Uj
 Y
i∈I(j)

1I + µ(Ai)

−1I −µ(B2j−1)

Vj

≤
m
X
j=1
Uj


Y
i∈I(j)

1I + µ(Ai)

−1I −µ(B2j−1)

Vj

≤K3C2
p
m
X
j=1
µ
2
(zj−1,zj),(p) ≤ǫ(2/p)−1K3C2
pvp(µ; A) =: M(ǫ),
where the next to last inequality holds by (9.30) and (9.32) and the last by
(9.44) and (3.69), writing the exponent 2 = (2−p)+p. Since ǫ > 0 is arbitrary
and A is any reﬁnement of B ∈IP (A),
A(1I + dµ) exists provided A is open.
If A = [s, t] ⊂[a, b] is closed then take the reﬁnement A′ = {s} ∪A ∪{t} of
the partition B′ = {s} ∪B ∪{t} with A and B as for the open interval (s, t).
Then we have
P(µ; [s, t], A′) −P(µ; [s, t], B′)
=

1I + µ({t})

P(µ; (s, t), A) −P(µ; (s, t), B)

1I + µ({s})

,
and the norm of the left side is less than or equal to K2M(ǫ) by (9.30).
Since the same bound holds if A is a half-open interval, the product integral
(1I + dµ) is deﬁned on I[a, b].
Approximating the product integral over an interval A by ﬁnite products
P(µ; A, A), the inequalities (9.40), (9.41), and (9.42) follow respectively from
the inequalities (9.30), (9.31), and (9.32). Then the product integral interval
function is bounded by (9.40), and it is upper continuous by (9.41) and by
Propositions 3.50 and 9.6. The proof of Theorem 9.28 is complete.
2
9.6 The Strict Product Integral
Given an interval function µ, a condition on a multiplicative interval function
α in relation to µ will be deﬁned, which if it holds for a bounded µ, implies
that α is the product integral with respect to µ, as will be shown in Theorem
9.34.
Deﬁnition 9.29. Let µ be a B-valued interval function on [a, b]. A B-valued
multiplicative interval function α on [a, b] will be called a multiplicative trans-
form of µ on [a, b] if for any ǫ > 0 there is a Young interval partition B of
[a, b] such that for each reﬁnement {Ai}n
i=1 of B,
n
X
i=1
α(Ai) −1I −µ(Ai)
 < ǫ.
(9.45)

9.6 The Strict Product Integral
433
If the product integral β(A) :=
A(1I + dµ) exists for each interval A ⊂[a, b]
and (9.45) holds for α = β, then the product integral will be called strict and
will be denoted by bµ := β =
(1I + dµ).
The product integral
(1I + dµ), if it exists, is unique and a multiplicative
interval function by Proposition 9.27, and so the strict product integral bµ is
well deﬁned if it exists.
Let µ be an additive interval function on [a, b] satisfying the conditions of
Proposition 9.20, that is, µ(A)µ(B) = 0 for disjoint intervals A, B ⊂[a, b]. It
is straightforward that α := 1I + µ is a multiplicative interval function and
(9.45) holds, and so Example 9.21 gives examples of strict product integrals.
It is easy to see that if α is a multiplicative transform of µ then for a
singleton {t}, t ∈[a, b], α({t}) = 1I + µ({t}). Thus if µ has no atoms in [a, b]
then α({t}) = 1I for each t ∈[a, b]. Also, letting δt, t ∈[a, b], be the interval
function on [a, b] such that δt(A) = 1I if t ∈A and = 0 otherwise, δt has the
strict product integral 1I + δt. The following seems to be obvious, but needs a
little proof.
Lemma 9.30. If a B-valued interval function µ on [a, b] has a multiplicative
transform α and A ⊂[a, b] is a nonempty interval such that µ(B) = 0 for every
interval B ⊂A, then α(A) = 1I. In particular, if µ = Pn
i=1 xiδti on [a, b] for
some {xi}n
i=1 ⊂B and {ti}n
i=1 ⊂[a, b] with a ≤t1 < t2 < · · · < tn ≤b, then
α =
n
Y
i=1
(1I + xiδti) =
(1I + dµ).
Proof. Given ǫ > 0, there is an interval partition {Ai}n
i=1 of A such that
Pn
i=1 ǫi < ǫ where ǫi := ∥α(Ai) −1I∥for each i. Then Qn
i=1(1 + ǫi) ≤
exp{Pn
i=1 ǫi} < eǫ. By multiplicativity and (9.43),
α(A) −1I
 =


n
Y
i=1
α(Ai)

−1I
 ≤ǫeǫ.
Letting ǫ ↓0, the ﬁrst conclusion follows. Applying it to each interval (ti−1, ti),
i = 2, . . . , n, the interval (a, t1) if a < t1, (tn, b) if tn < b, and any subintervals
of these intervals, gives the second conclusion.
2
Proposition 9.31. Let µ be an interval function with µ(∅) = 0. Any multi-
plicative transform α of µ, if it exists, is upper continuous at ∅if and only if
µ is upper continuous at ∅.
Proof. Let µ be an interval function on [a, b], and let α be a multiplicative
transform of µ. Given ǫ > 0 there is an interval partition {Bj}m
j=1 of [a, b]
such that for any interval A ⊂[a, b],

434
9 Product Integration
max
1≤j≤m ∥α(A ∩Bj) −1I −µ(A ∩Bj)∥< ǫ.
This holds because the sets A ∩Bj and Bj \ A that are nonempty give a
reﬁnement of {Bj}m
j=1, where the sets are either empty, nonempty intervals,
or for one value of j, Bj \ A may be a union of two nonempty intervals. Let
intervals Ak ↓∅. Then there is j ∈{1, . . . , m} such that for all suﬃciently
large k, Ak ⊂Bj, and so
∥α(Ak) −1I∥< ǫ + ∥µ(Ak)∥
and
∥µ(Ak)∥< ǫ + ∥α(Ak) −1I∥.
Letting k →∞, the conclusion follows.
2
If a multiplicative transform α exists for a bounded interval function µ,
then α is the product integral
(1I + dµ), as will be shown in Theorem 9.34.
But a multiplicative transform may not exist while the product integral does,
and so a product integral need not be strict, as follows.
Example 9.32. Let µ be the additive, upper continuous interval function on
[0, 1] of Example 9.14. Then µ does not have a multiplicative transform, as
follows. Suppose α is a multiplicative transform of µ. Then for any 0 < s < 1,
by Lemma 9.30, α restricted to [s, 1] is equal to the product integral with
respect to the interval function P
3≤k≤1/s µ({1/k})δ{1/k}. Hence for any t > 0,
α([s, t)) →0 as s ↓0. By Proposition 9.31, α is upper continuous at ∅, and so
by the implication (a) ⇒(b) of Proposition 9.7, α((0, t)) = 0 for each t > 0.
On the other hand, by upper continuity at ∅again, α((0, t)) →1 as t ↓0, a
contradiction.
In the next fact, the converse part may not hold if µ is not additive, by
Remark 9.2.
Proposition 9.33. Let µ be an interval function having a multiplicative
transform α. If µ is bounded, then so is α. Conversely, if µ is additive, then
if α is bounded, so is µ.
Proof. Let µ and α be deﬁned on [a, b]. By deﬁnition of multiplicative trans-
form, there is an interval partition B = {Bj}m
j=1 of [a, b] such that for any
interval partition {Ai}n
i=1 of [a, b] which is a reﬁnement of B,
max
1≤i≤n
α(Ai) −1I −µ(Ai)
 ≤
n
X
i=1
α(Ai) −1I −µ(Ai)
 ≤1.
Let ∥µ∥sup < ∞, and let A ∈I[a, b]. By multiplicativity of α, we then have
α(A)
 ≤
m
Y
j=1
α
 A ∩Bj
 ≤
m
Y
j=1
 2 + ∥µ(A ∩Bj)∥

≤
 2 + ∥µ∥sup
m.

9.6 The Strict Product Integral
435
Thus ∥α∥sup < ∞. Conversely, let µ be additive, let ∥α∥sup < ∞, and let
A ∈I[a, b]. We have similarly
µ(A)∥≤
m
X
j=1
µ
 A ∩Bj
 ≤
m
X
j=1
 1 + ∥α(A ∩Bj) −1I∥

≤m(∥α∥sup + 2).
Thus ∥µ∥sup < ∞, completing the proof.
2
Next we show that for a bounded interval function µ, if a multiplicative
transform of µ exists then it is a strict product integral of µ.
Theorem 9.34. If µ is a bounded interval function on [a, b] having a mul-
tiplicative transform α, then the product integral
A(1I + dµ) exists for any
A ∈I[a, b] and equals α(A). Thus, the product integral is strict and is the
unique multiplicative transform of µ.
Proof. By Proposition 9.33, α is bounded. Let M := ∥α∥sup < ∞. Then
M ≥1 since α(∅) = 1I. For any 0 < δ < 1, let ǫ = δ/(7M 2). For any A ∈I[a, b],
there is an interval partition B of A such that for any reﬁnement {Ai}n
i=1 of
B, (9.45) holds. Let A = {Ai}n
i=1 be such a reﬁnement. Let xi := α(Ai) and
yi := 1I + µ(Ai) for i = 1, . . . , n. Let zi := yi −xi and ǫi := ∥yi −xi∥, so that
Pn
i=1 ǫi < ǫ. Let
S :=
n
Y
i=1
(xi + zi) −
n
Y
i=1
xi = yn · · · y2y1 −xn · · · x2x1 = P(µ; A, A) −α(A).
Then S = P
T wT , where T runs over the 2n−1 nonempty subsets of {1, . . ., n}
and wT = un · · · u2u1 where ui = zi for i ∈T and ui = xi for i ̸∈T . For each
T , ∥wT ∥will be bounded by a product of terms, including ǫi for each i ∈T .
Let a gap in T be a nonempty set G ⊂{1, . . ., n} \ T of consecutive integers,
G = {i, i + 1, . . . , j}, maximal in the sense that i = 1 or i −1 ∈T and
j = n or j + 1 ∈T . For each such gap G we use the bound ∥xj · · · xi+1xi∥=
∥α(Ai ∪· · · ∪Aj)∥≤M. Thus ∥wT ∥≤M γ(T ) Q
i∈T ǫi, where γ(T ) is the
number of diﬀerent gaps for T . We have γ(T ) ≤⌊(n + 1)/2⌋, where ⌊x⌋is the
largest integer ≤x. Thus
∥S∥≤
⌊(n+1)/2⌋
X
k=0
M kUk,
where
Uk :=
X
{T : γ(T )=k}
Y
i∈T
ǫi.
Recall that each T is nonempty. Then U0 = ǫ1ǫ2 · · · ǫn < ǫn, U1 < ǫ1 + ǫn +
ǫ2 + ǫ3 + · · · < ǫ/(1 −ǫ) < 2ǫ, and for k ≥2,
Uk ≤
⌊(n+1)/2⌋
X
r=k−1
X
1≤i1<i2<···<ir≤n
ǫi1ǫi2 · · · ǫir ≤
∞
X
r=k−1
ǫr = ǫk−1/(1 −ǫ) < 2ǫk−1.

436
9 Product Integration
Thus
∥S∥≤ǫn + 2Mǫ + 2M
∞
X
k=1
(Mǫ)k ≤3Mǫ + 2M 2ǫ/(1 −Mǫ) ≤7M 2ǫ = δ.
Letting δ ↓0, it follows that
A(1I + dµ) exists and equals α(A).
2
The following example shows that there is a bounded additive interval
function µ such that µ has a strict product integral, but µ neither is upper
continuous nor has bounded p-variation for any 0 < p < ∞.
Example 9.35. Let H = L2([0, 1], λ) be the Hilbert space of functions which
are square integrable with respect to Lebesgue measure λ on [0, 1], and let
BH := L(H, H) be the Banach algebra of bounded linear operators from H
into itself (see Example 4.10). For each interval J ⊂[0, 1], let
µ(J): f 7→1Jf =: µ(J)(f),
f ∈H.
Then µ is an additive interval function on [0, 1] with values in BH. It is easy
to see that µ(A) = 0 if A is a singleton or empty and ∥µ(A)∥= 1 otherwise,
if A is a nondegenerate interval. Thus µ is bounded, not upper continuous (in
operator norm), and has bounded p-variation for no 0 < p < ∞. Moreover,
µ(A)µ(B) = 0 if A, B ∈I[0, 1] and A ∩B = ∅. So by Proposition 9.20 the
product integral with respect to µ exists, and for any interval A ⊂[0, 1],
A
(1I + dµ) = 1I + µ(A) = 1I + m1A,
where mg is multiplication by g. By Theorem 9.34, it follows that the product
integral is strict.
It will be convenient to consider a reversed form of p-variation of interval
functions as follows. For any 1 ≤p < ∞, nondegenerate interval A, interval
function α on A with values in B, and interval partition A = {Ai}n
i=1 of A,
let
s←
p (α; A) :=
n
X
j=1

α


n[
i=j
Ai

−α


n[
i=j+1
Ai



p
(9.46)
where the union over the empty set of indices is empty. Let v←
p (α; A) :=
supA s←
p (α; A) where the supremum is over all interval partitions of A. If α
is additive, then clearly v←
p (α; A) = vp(α; A). Let I←
p (J; B) be the set of all
interval functions α on J with values in B such that supA∈I(J) v←
p (α; A) < ∞.
Then on I←
p (J; B), it is easily seen that
∥α∥←
(p) := ∥α∥←
J,(p) :=
sup
A∈I(J)
v←
p (α; A)1/p
(9.47)

9.6 The Strict Product Integral
437
is a seminorm and ∥α∥←
[p] := ∥α∥←
J,[p] := ∥α∥←
(p) + ∥α∥sup is a norm. Further,
for each p let Ip(J; B) := Ip(J; B) ∩I←
p (J; B) with the seminorm
∥α∥(p) := ∥α∥A,(p) := max(∥α∥(p), ∥α∥←
(p))
(9.48)
and the norm ∥α∥[p] := ∥α∥A,[p] := ∥α∥(p) + ∥α∥sup. It is easily seen that
(I←
p (J; B), ∥· ∥←
[p]) and (Ip(J; B), ∥· ∥[p]) are Banach spaces, the ﬁrst by sym-
metry with Ip and the second by intersecting two Banach spaces of (interval)
functions with the maximum of their norms.
Theorem 9.36. For µ ∈AIp([a, b]; B), 1 ≤p < 2, the strict product integral
bµ with respect to µ exists,
∥bµ∥sup ≤K,
and
∥bµ∥(p) ≤CpK∥bµ∥sup∥µ∥(p),
(9.49)
where K := K(µ, p) is deﬁned by (9.29) and Cp just after (9.28).
Proof. Let µ ∈AIp([a, b]; B) for some 1 ≤p < 2. Then the interval function
I[a, b] ∋A 7→
A(1I + dµ) is deﬁned and multiplicative by Theorem 9.28. To
check the condition of Deﬁnition 9.29, we can assume that a < b. Let ǫ > 0.
By Proposition 3.52, there exists a Young partition B = {(zj−1, zj)}m
j=1 of
[a, b] such that vp(µ; (zj−1, zj)) < ǫ for each j = 1, . . . , m. Let {Ai}n
i=1 be an
interval partition of [a, b] which is a reﬁnement of B, and let I be the set of all
indices i ∈{1, . . . , n} such that Ai∩{zj}m
j=0 = ∅. Then
Ai(1I+dµ) = 1I+µ(Ai)
for each i ∈{1, . . . , n} \ I, and so by the inequality (9.42) of Theorem 9.28,
n
X
i=1

Ai
(1I + dµ) −1I −µ(Ai)
 ≤KC2
p
X
i∈I
µ
2
Ai,(p)
≤KC2
p max
j
µ
2−p
(zj−1,zj),(p)
X
i∈I
vp(µ; Ai)
≤KC2
pǫ(2/p)−1vp(µ; [a, b]).
In the last inequality, (3.69) was used. Thus bµ =
(1I+dµ), and the ﬁrst bound
in (9.49) follows from (9.40). To prove the second bound, let A ∈I[a, b] be
nonempty and let A = {Ai}n
i=1 be an interval partition of A. To bound ∥bµ∥(p),
let Bi = ∪i
j=1Aj for i = 1, . . . , n, and let B0 := ∅. By multiplicativity of bµ,
(9.41) and (3.69) again, we have
sp(bµ; A) =
n
X
i=1
bµ(Bi) −bµ(Bi−1)
p ≤∥bµ∥p
sup
n
X
i=1
bµ(Ai) −1I
p
≤∥bµ∥p
supCp
pKpvp(µ; A).
For ∥bµ∥←
(p), deﬁne instead Bi = Sn
j=i Ai and in place of Bi−1 put Bi+1 with
Bn+1 := ∅. Then a symmetric argument gives the same bound for s←
p as for sp.

438
9 Product Integration
Since A is an arbitrary partition of A and µ is additive, vp(µ; A) ≤vp(µ; [a, b]),
so the second bound in (9.49) follows, completing the proof.
2
Next we deﬁne a transform which for suitable interval functions is an
inverse of the product integral operator. Let ν be an interval function on [a, b]
with values in a Banach algebra B. For a nonempty interval A ⊂[a, b] and for
an interval partition A = {Ai}n
i=1 of A, let
S(ν; A, A) :=
n
X
i=1

ν(Ai) −1I

.
Deﬁnition 9.37. Let ν be a B-valued interval function on [a, b]. We say that
an interval function ˇν (pronounced “nu check”) is the additive transform of ν
if ˇν(∅) = 0 and for each nonempty A ∈I[a, b],
ˇν(A) = lim
A S(ν; A, A),
provided the limit exists under reﬁnements of partitions A of A.
Clearly ˇν, if it exists, is unique and an additive interval function. Let µ be
an additive interval function on [a, b] which has a strict product integral bµ.
Then it is easy to see that the additive transform of bµ exists and (bµˇ) = µ.
In an alternative notation, let L(ν) := ˇν. If µ is an additive interval
function on [a, b] such that the product integral with respect to µ exists,
let P(µ) :=
(1I + dµ).
Corollary 9.38. Let µ ∈AIp([a, b]; B), 1 ≤p < 2. Then L◦P(µ) = µ and
P◦L(bµ) = bµ.
9.7 Commutative Banach Algebras
Throughout this section, let A be a commutative Banach algebra. We will
extend the suﬃciency part of Theorem 9.11 to A-valued interval functions.
Speciﬁcally we show that if a suitable additive upper continuous interval func-
tion µ has values in A and has no atoms, then the product integral with respect
to µ is strict and equals the exponential of µ. If µ has atoms then we will see
that the product integral of µ is strict and is the exponential of µ multiplied
by a product of A-valued functions.
Let ξ be an A-valued function deﬁned on a nonempty set T . The product
Q
T ξ will be said to converge unconditionally to an element C ∈A if C ̸= 0
and for each ǫ > 0 there is a ﬁnite set B ⊂T such that ∥Q
t∈D ξ(t) −C∥< ǫ
for each ﬁnite subset D of T including B.
Recall the exponential function exp(x), x ∈B, deﬁned by (4.14) when B
is a complex Banach algebra. If A is a real Banach algebra the exponential

9.7 Commutative Banach Algebras
439
function is deﬁned by the series representation on the right side of (4.14) using
the complexiﬁcation of A given by Deﬁnition 4.37 and Proposition 4.38. For
an A-valued interval function µ on [a, b] let ξ(t) := (1I+µ({t})) exp{−µ({t})},
t ∈[a, b], for a nonempty subset T ⊂[a, b] let
γ(µ; T ) :=
Y
T
(1I + µ)e−µ :=
Y
t∈T
ξ(t)
(9.50)
provided the product converges unconditionally, and let γ(µ; ∅) := 1I. Recall
the deﬁnition (3.40) of σ2(µ; T ) for any set T ⊂[a, b].
Lemma 9.39. Let µ be an upper continuous and additive A-valued inter-
val function on [a, b] such that σ2(µ; [a, b]) < ∞and µ({t}) ̸= −1I for each
t ∈[a, b]. Then γ(µ) = {γ(µ; A): A ∈I[a, b]} is a well-deﬁned A-valued mul-
tiplicative interval function such that
∥γ(µ)∥sup ≤exp{4σ2(µ; [a, b])}.
(9.51)
Moreover, for each A ∈I[a, b],
∥1I −γ(µ; A)∥≤2−1σ2(µ; A)∥γ(µ)∥A,supe∥µ∥A,sup.
(9.52)
Proof. First we show that the product (9.50) is well deﬁned for a set T ⊂[a, b]
such that ∥µ({t})∥≤1/2 for each t ∈T . Let B be a ﬁnite subset of T . Since
exp
 log(u)

= u for any u ∈A such that ∥1I −u∥< 1, by Lemma 4.35 and
since any ﬁnite product converges unconditionally we have
ξ(t) = exp{log(1I + µ({t}))} exp{−µ({t})} = exp{η(t)}
for each t ∈T , where η(t) := log(1I + µ({t})) −µ({t}). Using again Lemma
4.35, it follows that γ(µ; B) = exp{P
B η} for any ﬁnite subset B of T . By
the series representation of the logarithm function, ∥log(1I + u) −u∥≤∥u∥2
if ∥u∥≤1/2. Thus P
B ∥η∥≤σ2(µ; B) for any subset B ⊂T , and so the sum
P
T η converges absolutely in A. Since the exponential is continuous, it then
follows that the product (9.50) is well deﬁned and the bound
∥γ(µ; T )∥≤exp

σ2(µ; T )}
(9.53)
holds for any set T ⊂[a, b] such that ∥µ({t})∥≤1/2 for each t ∈T .
Now let A = (s, t) be an open subinterval of [a, b]. By Proposition 2.6(c)
since µ is upper continuous and additive, the set {z ∈A: ∥µ({z})∥> 1/2}
is ﬁnite, and so we can assume that it is a set {zj}m−1
j=1
for some m ≥2.
Let z0 := s, zm := t, Aj := (zj−1, zj) for j = 1, . . . , m, V1 := 1I, and Vk :=
Qk−1
j=1 ξ(zj)γ(µ; Aj) for k = 2, . . . , m. Using the series representation of the
exponential function, for each j = 1, . . . , m −1, we have
∥ξ(zj)∥≤exp{2∥µ({zj})∥} ≤exp{4∥µ({zj})∥2}
(9.54)

440
9 Product Integration
since 2∥µ({zj})∥> 1. Since µ({t}) ̸= −1I for t ∈[a, b], V := Vmγ(µ; Am) ̸= 0.
To show that γ(µ; A) = V , let ǫ > 0. By the ﬁrst part of the proof, for each
j = 1, . . . , m, there is a ﬁnite set Bj ⊂Aj such that
∥γ(µ; D) −γ(µ; Aj)∥< ǫ
(9.55)
for each ﬁnite set D such that Bj ⊂D ⊂Aj. Let T be a ﬁnite set such
that T0 := {zj}m−1
j=1 ∪(∪m
j=1Bj) ⊂T ⊂A. Then letting Tj := T ∩Aj for
j = 1, . . . , m, and applying the algebraic identity (9.43) with 2m −1 in place
of m, we have
γ(µ; T ) −V
 =

m−1
Y
j=1
ξ(zj)
m
Y
j=1
γ(µ; Tj) −
m−1
Y
j=1
ξ(zj)
m
Y
j=1
γ(µ; Aj)

≤
m
X
j=1
∥γ(µ; T ∩[zj, t))∥
γ(µ; Tj) −γ(µ; Aj)
∥Vj∥
< ǫm exp{8σ2(µ; A)}.
The last bound holds by (9.53), (9.54), and (9.55) since Bj ⊂Tj ⊂Aj for
each j. Since ǫ > 0 is arbitrary and T is any ﬁnite set including T0, γ(µ; A) is
well deﬁned provided A is an open subinterval of [a, b].
If A = [s, t] ⊂[a, b] with ∥µ({s})∥> 1/2 and ∥µ({t})∥> 1/2, then instead
of T and V as above take T ′ := {s} ∪T ∪{t} and V ′ := ξ(t)V ξ(s). Then the
diﬀerence γ(µ; T ′) −V ′ equals ξ(t)

γ(µ; T ) −V

ξ(s) and its norm is bounded
as in the last display (with now A closed rather than open). Since the same
bound holds in all other cases, the interval function γ(µ) is deﬁned on [a, b].
Clearly γ(µ) is multiplicative and (9.51) holds due to (9.53) and (9.54).
Finally to prove (9.52), let A ∈I[a, b] and let T = {t1, . . . , tm} ⊂A.
Applying the algebraic identity (9.43) with xj := 1I and yj := ξ(tj), we have
1I −γ(µ; T ) =
m
X
j=1

1I −ξ(tj)

γ(µ; Tj),
where Tj := {t1, . . . , tj−1} if j = 2, . . . , m and T1 := ∅. For any t ∈[a, b], using
the series representation of the exponential function, it follows that
∥1I −ξ(t)∥≤2−1∥µ({t})∥2e∥µ({t})∥.
Therefore we have the bound
∥1I −γ(µ; T )∥≤2−1σ2(µ; A)∥γ(µ)∥A,supe∥µ∥A,sup.
Since T is any ﬁnite subset of A, (9.52) holds, proving the lemma.
2

9.7 Commutative Banach Algebras
441
The following extends the suﬃciency part of Theorem 9.11 and Corollary
9.18. Recall that AI∗
p([a, b]; A), 0 < p < ∞, is the class of all A-valued additive
upper continuous interval functions on [a, b] having p∗-variation as deﬁned in
Deﬁnition 3.28.
Theorem 9.40. Let µ ∈AI∗
2([a, b]; A) be such that µ({t}) ̸= −1I for each t ∈
[a, b]. Then the strict product integral bµ exists and for any interval A ⊂[a, b],
bµ(A) = exp

µ(A)
	
γ(µ; A).
(9.56)
Proof. We can assume that a < b. By Deﬁnition 3.28, σ2(µ; [a, b]) < ∞, and
so the right side of (9.56) is deﬁned for each A ∈I[a, b] by Lemma 9.39. Let
α(A) be the right side of (9.56). By Lemmas 4.35 and 9.39, α = {α(A): A ∈
I[a, b]} is an A-valued multiplicative interval function on [a, b]. Since µ is
bounded, by Theorem 9.34, it is enough to prove that α is a multiplicative
transform of µ. To check whether the condition of Deﬁnition 9.29 holds, let
ǫ ∈(0, 1/2]. Since µ ∈AI∗
2, by Lemma 3.29, there exists a Young interval
partition B := {(zj−1, zj)}m
j=1 of [a, b] such that Pm
j=1 v2(µ; (zj−1, zj)) < ǫ.
Let A = {Ai}n
i=1 be an interval partition of [a, b] which is a reﬁnement of B,
and let I be the set of all indices i ∈{1, . . ., n} such that Ai ∩{zj}m
j=0 = ∅.
For each i ∈{1, . . ., n} \ I, Ai = {zj} for some j ∈{0, . . . , m}, and so
α(Ai) = 1I + µ(Ai), again using the multiplicative property of the exponential
function (Lemma 4.35). Using the series representation of the exponential
function, we have
1I + u −exp(u)
 ≤2−1∥u∥2e∥u∥
and
∥exp(u)∥≤e∥u∥
for each u ∈A. This and the bound (9.52) yield
n
X
i=1
1I + µ(Ai) −α(Ai)
 =
X
i∈I
1I + µ(Ai) −α(Ai)

≤
X
i∈I
1I + µ(Ai) −exp{µ(Ai)}
 +
X
i∈I
∥exp{µ(Ai)}∥
1I −γ(µ; Ai)

≤2−1e∥µ∥sup X
i∈I
∥µ(Ai)∥2 + 2−1∥γ(µ)∥supe2∥µ∥sup X
i∈I
σ2(µ; Ai)
≤C
m
X
j=1
v2(µ; (zj−1, zj)) < ǫ C,
where C := 2−1 exp{2∥µ∥sup}(1 + ∥γ(µ)∥sup) and (3.69) was used in the last
line. Thus α is a multiplicative transform of µ, proving the theorem.
2

442
9 Product Integration
9.8 Integrals with Two Integrands
In the next section we will extend the algebraic identity (9.43) to a class
of multiplicative transforms. To prepare for that, in this section we deﬁne
and examine an integral with two integrands, as in R f dµ g. Such an integral
is needed and may diﬀer from
R
f g dµ when B is noncommutative. Two-
integrand integrals are used to express the Fr´echet derivative and the Taylor
series representation of the product integral operator in Proposition 9.63 and
Theorem 9.51 below, respectively (the proposition is proved before the proof
of the theorem is completed).
Deﬁnitions of integrals
Let f, g be B-valued functions on [a, b] and let µ be an additive interval func-
tion on [a, b]. Recall from Section 1.4 the notion of a tagged Young interval
partition. For a tagged Young interval partition T = ({(ti−1, ti)}n
i=1, {si}n
i=1)
of a nonempty interval A ⊂[a, b], let
SYS(f, dµ, g; A, T ) :=
n
X
i=1
f(si)µ((ti−1, ti))g(si) +
n
X
i=0
f(ti)µ({ti} ∩A)g(ti).
For an interval A ⊂[a, b], the Kolmogorov integral with two integrands
R
=A f dµ g is deﬁned as 0 if A = ∅or if A is nonempty, as the limit
R
=
A
f dµ g := lim
T SYS(f, dµ, g; A, T )
if it exists in the reﬁnement sense. It is not at all surprising, and holds by
Proposition 2.25, that for an upper continuous additive interval function µ
on [a, b] and an interval A ∈I[a, b], the Kolmogorov integral with two in-
tegrands
R
=A f dµ 1I exists if and only if the Kolmogorov integral
R
=A f dµ
also does, and then the two are equal since SYS(f, dµ, 1I; A, T ) equals the
sum SYS(f, dµ; A, T ) deﬁned by (2.22) for each tagged Young interval par-
tition T
of A. Moreover, if the Banach algebra B is commutative, then
SYS(f, dµ, g; A, T ) = SYS(fg, dµ; A, T ) for each tagged Young interval par-
tition T of A, and so
R
=A f dµ g =
R
=A fg dµ if either integral exists.
Similarly we will deﬁne the RYS integral with two integrands. Let f, g, h
be B-valued functions on [a, b]. For a tagged Young point partition τ =
({ti}n
i=0, {si}n
i=1) of [a, b] with a < b the Young–Stieltjes sum SYS(f, dh, g; τ)
based on τ is deﬁned by
SYS(f, dh, g; τ) :=
n
X
i=1
f(si)[h(ti−)−h(ti−1+)]g(si)+
n
X
i=0
f(ti)∆±
[a,b]h(ti)g(ti),
where ∆±
[a,b]h is deﬁned by (2.1). The RYS integral with two integrands
(RYS) R b
a f dh g is deﬁned as 0 if a = b, or as

9.8 Integrals with Two Integrands
443
(RYS)
Z b
a
f dh g := lim
τ SYS(f, dh, g; τ)
if a < b, provided the limit exists in the reﬁnement sense. The RYS integral
with two integrands extends the RYS integral (with one integrand), in the
sense that if either of the integrals (RYS) R b
a f dh and (RYS) R b
a f dh 1I exists
then clearly so does the other, with the same value.
Given a regulated function h on [a, b], there is an additive interval function
µh := µh,[a,b] corresponding to h deﬁned by (2.2). Let
bR
=
a
f dh g :=
R
=
[a,b]
f dµh,[a,b] g
provided the Kolmogorov integral with two integrands is deﬁned.
Proposition 9.41. Let f, h, g be B-valued regulated functions on [a, b]. Then
R
=b
a f dh g = (RYS) ∫b
a f dh g if either side is deﬁned.
Proof. We can assume that a < b. Since there is a one-to-one correspondence
between tagged Young partitions τ and tagged Young interval partitions T
with SYS(f, dh, g; τ) = SYS(f, dµh, g; [a, b], T ), the conclusion follows from the
deﬁnitions.
2
Integrals with two integrands have properties extending those of integrals
with one integrand, often straightforwardly. For one such property, the proof
of the following theorem is similar to the proof of Theorem 2.21 and is omitted.
Theorem 9.42. Let f, g: [a, b] →B and let µ: I[a, b] →B be additive. For
A, A1, A2 ∈I(J) such that A = A1 ∪A2 and A1 ∩A2 = ∅,
R
=A f dµ g exists if
and only if both
R
=A1 f dµ g and
R
=A2 f dµ g exist, and then
R
=
A
f dµ g =
R
=
A1
f dµ g +
R
=
A2
f dµ g.
In particular, if the integral
R
=[a,b] f dµ g is deﬁned, then I[a, b] ∋A 7→
R
=A f dµ g is a B-valued additive interval function on [a, b].
The next theorem implies that the operators
U × I × W ∋(f, µ, g) 7→
R
=
[a,b]
f dµ g ∈B
and
U × V × W ∋(f, h, g) 7→
bR
=
a
f dh g ∈B
are trilinear for any point function spaces U, V, W and interval function space
I on which they are deﬁned.

444
9 Product Integration
Theorem 9.43. Let f, g: [a, b] →B, let µ: I[a, b] →B be additive, and
let u1, u2 ∈K. The following three statements mean that the left side exists
provided the right side does, and then the equality holds:
(a) for f1, f2 : [a, b] →B,
R
=
[a,b]
 u1f1 + u2f2

dµ g = u1
R
=
[a,b]
f1 dµ g + u2
R
=
[a,b]
f2 dµ g;
(b) for µ1, µ2 : I[a, b] →B,
R
=
[a,b]
f d
 u1µ1 + u2µ2

g = u1
R
=
[a,b]
f dµ1 g + u2
R
=
[a,b]
f dµ2 g;
(c) for g1, g2 : [a, b] →B,
R
=
[a,b]
f dµ
 u1g1 + u2g2

= u1
R
=
[a,b]
f dµ g1 + u2
R
=
[a,b]
f dµ g2.
Moreover, the preceding three statements hold when µ is replaced by h: [a, b] →
B and
R
=[a,b] is replaced by
R
=b
a.
Proof. Statement (a) follows from the equality
SYS(u1f1 + u2f2, dµ, g; [a, b], T )
= u1SYS(f1, dµ, g; [a, b], T ) + u2SYS(f2, dµ, g; [a, b], T ),
valid for any tagged Young interval partition T of [a, b]. The proof of the other
statements is symmetric and is omitted.
2
The same argument as in the preceding proof gives the following statement.
Theorem 9.44. Let f : [a, b] →B, let µ: I[a, b] →B be additive, and let
u ∈B. If R=[a,b] f dµ exists then so does R=[a,b] uf dµ and
R
=
[a,b]
uf dµ = u
R
=
[a,b]
f dµ.
(9.57)
Love–Young inequalities
Here we extend the Love–Young inequalities of Section 3.6 to Riemann–
Stieltjes and Young–Stieltjes sums and integrals with two integrands. For a
partition κ = {tj}n
j=0 of [a, b], let
S(f, dh, g; κ) :=
n
X
j=1
f(tj)

h(tj) −h(tj−1)

g(tj).

9.8 Integrals with Two Integrands
445
Theorem 9.45. Let Φ, Ψ ∈CV with inverses φ and ψ, respectively, and let
f, g, h: [a, b] →B with a < b. Then for any partition κ of [a, b],
S(f, dh, g; κ) −f(a)[h(b) −h(a)]g(a)

≤

∥f∥sup + ∥g∥sup
	 ∞
X
k=1
φ
vΦ(f) + vΦ(g)
k

ψ
vΨ(h)
k

.
(9.58)
Moreover, if for u ≥0, Φ(u) ≡uq and Ψ(u) ≡up with 1 ≤p, q < ∞and
p−1 + q−1 > 1, then instead of (9.58),
S(f, dh, g; κ) −f(a)[h(b) −h(a)]g(a)

≤ζ(p−1 + q−1)

∥f∥(q)∥g∥sup + ∥g∥(q)∥f∥sup
	
∥h∥(p),
(9.59)
where ζ(r) := P
k≥1 k−r for r > 1.
Proof. Let κ = {tj}n
j=0 be a partition of [a, b]. Deﬁne a sequence {□ij}n
i,j=1
of (trilinear) operators □ij : (f, h, g) →B by
(□ij)(f, h, g) := f(ti)(∆jh)g(ti) −f(ti−1)(∆jh)g(ti−1),
(9.60)
where ∆jF := F(tj)−F(tj−1) for j = 1, . . . , n and F = f, g, h. Then we have
S(f, dh, g; κ) −f(a)

h(b) −h(a)

g(a) =

X
1≤i≤j≤n
□ij

(f, h, g).
In the proof of (9.58), for r = 1, . . . , n and x, y, w ≥0, let
Cr(x, y, w) :=

∥f∥sup + ∥g∥sup
	
φ
x + y
r

ψ
w
r

.
(9.61)
For the proof of (9.59), instead of (9.61), let
Cr(x, y, w) :=
hx
r
1/q
∥g∥sup +
y
r
1/q
∥f∥sup
iw
r
1/p
.
(9.62)
Thus (9.58) and (9.59) will be proved once we show that


X
1≤i≤j≤n
□ij

(f, h, g)
 ≤
n
X
r=1
Cr
 vΦ(f), vΦ(g), vΨ(h)

.
(9.63)
The proof is similar to the proof of Lemma 3.85. We proceed recursively
through k = n, n −1, . . . , 2, replacing the sequence {□ij}n
i,j=1 of operators by
new sequences and choosing one among them to give the desired bound. For
discrete intervals of indices A, B ⊂{1, . . ., k} such as {l, l+1, . . ., m}, suppose
that trilinear operators ξ(k)
uv , u ∈A, v ∈B, with values in B, are deﬁned on
ordered triples (f, h, g) of functions from J into B.
For k = 2, . . . , n, we deﬁne Ik := {1, . . ., k} × {1, . . . , k} and

446
9 Product Integration
S(k)
A,B :=
X
u∈A,v∈B
ξ(k)
uv ,
(9.64)
where ξ(n)
uv
:=
□uv as deﬁned by (9.60) for (u, v) ∈In, and {ξ(k)
uv }(u,v)∈Ik
will be deﬁned recursively for other k in the course of the proof. In each
recursion step we will have operators S(k)
C,D = S(n)
A,B, recalling that ξ(n)
ij
= □ij,
where C, D, A, and B are discrete intervals {l, l + 1, . . . , m}. In that case, for
A = {l, . . . , m} ⊂{1, . . ., n} and any B,
S(n)
A,B(f, h, g)
= f(tm)
 X
j∈B
∆jh

g(tm) −f(tl−1)
 X
j∈B
∆jh

g(tl−1)
=
 X
i∈A
∆if
 X
j∈B
∆jh

g(tm) + f(tl−1)
 X
j∈B
∆jh
 X
i∈A
∆ig

.
Thus
S(n)
A,B(f, h, g)

≤
n
X
i∈A
∆if
∥g∥sup +

X
i∈A
∆ig
∥f∥sup
o
X
j∈B
∆jh
.
(9.65)
Given a set ζ = {ξuv}(u,v)∈Ik, where 1 ≤k ≤n, let
Uk(ζ) :=
X
1≤u≤v≤k
ξuv.
Let z(n) := z = {□ij}(i,j)∈In. We will choose recursively for each k = n −
1, . . . , 2 a sequence z(k) = {ξ(k)
uv }(u,v)∈Ik of operators
ξ(k)
uv = S(n)
A(u,k),B(v,k)
(9.66)
for some discrete intervals A(u, k) ⊂{1, . . ., n}, B(v, k) ⊂{1, . . . , n}. Then
the following inequalities will be proved:


X
1≤i≤j≤n
□ij

(f, h, g)
 =
Un(z)(f, h, g)

≤
n
X
r=k+1
Cr
 vΦ(f), vΦ(g), vΨ(h)

+
Uk(z(k))(f, h, g)

(9.67)
and
U2(z(2))(f, h, g)
 ≤
2
X
r=1
Cr(vΦ(f), vΦ(g), vΨ(h)).
(9.68)

9.8 Integrals with Two Integrands
447
Sets A(u, k) and B(v, k) included in {1, 2, . . ., n} for (u, v) ∈Ik and sets
Ai,l,k and Bj,l,k included in {1, 2, . . ., n} for (i, j) ∈Ik−1 and l ∈{1, . . ., k}
will be deﬁned ﬁrst for k = n and then recursively for k = n −1, . . . , 2. Let
A(u, n) := {u} and B(v, n) := {v} for u, v = 1, . . . , n. To deﬁne Ai,l,k and
Bj,l,k from A(u, k) and B(v, k) let for (i, j) ∈Ik−1,
Ai,l,k :=



A(i, k)
if 1 ≤i ≤l −1,
A(l, k) ∪A(l + 1, k) if i = l,
A(i + 1, k)
if l < i < k,
(9.69)
and
Bj,l,k :=



B(j, k)
if 1 ≤j < l −1,
B(l −1, k) ∪B(l, k) if j = l −1,
B(j + 1, k)
if l ≤j < k.
(9.70)
Deﬁne ξ(k,l)
ij
:= S(n)
Ai,l,k,Bj,l,k for (i, j) ∈Ik−1. At this stage A(i, k) and B(i, k)
are deﬁned just for k = n. Then z(k,l) := {ξ(k,l)
ij
}(i,j)∈Ik−1 is a sequence of
operators depending on k and l. Suppose we have deﬁned z(k) for a given
k = n, n −1, . . . , 3 and thus z(k,l). We then have
Uk−1(z(k,l)) =
X
1≤i≤k−1
k−1
X
j=i
ξ(k,l)
ij
=
X
1≤i<l
S(k)
{i},{i,...,k}
+ S(k)
{l,l+1},{l+1,...,k} +
X
l<i<k
S(k)
{i+1},{i+1,...,k}
= −S(k)
{l},{l} + Uk(z(k)) = −ξ(k)
ll
+ Uk(z(k)).
Thus for l ∈{1, . . . , k},
Uk(z(k)) −Uk−1(z(k,l)) = ξ(k)
ll .
(9.71)
By (9.66), we have ξ(k)
ll
= S(n)
A(l,k),B(l,k). Thus by (9.65),
ξ(k)
ll (f, h, g)

(9.72)
≤
n
X
i∈A(l,k)
∆if
∥g∥sup +

X
i∈A(l,k)
∆ig
∥f∥sup
o
X
j∈B(l,k)
∆jh
.
We will choose a particular value of l using Lemma 3.86. Let ∆′
jF
:=
P
i∈A(j,k) ∆iF for F = f or g and ∆′′
j h := P
i∈B(j,k) ∆ih. First let uj :=
max{∥∆′
jf∥, ∥∆′
jg∥} and vj := ∥∆′′
j h∥. Then (3.139) with m = k gives us an
index l′ ∈{1, . . . , k} such that
ul′vl′ ≤φ
 1
k
k
X
j=1
Φ(uj)

ψ
1
k
k
X
j=1
Ψ(vj)

.
(9.73)

448
9 Product Integration
The inequality Φ(uj) ≤Φ(∥∆′
jf∥) + Φ(∥∆′
jg∥) and (9.72) give the bound
(ξ(k)
l′l′ )(f, h, g)
 ≤Ck(vΦ(f), vΦ(g), vΨ(h)),
(9.74)
where Ck is deﬁned by (9.61). Or in the case when Φ(u) ≡uq and Ψ(u) ≡
up for some 1 ≤p, q < ∞with p−1 + q−1 > 1, to bound (9.72) we keep
vl unchanged but let ul := ∥∆′
lf∥∥g∥sup + ∥∆′
lg∥∥f∥sup. An application of
Lemma 3.86 again gives us an index l′ ∈{1, . . ., k} such that (9.73) holds
with the new values of {uj}. That is, in this case we have the bound
(ξ(k)
l′l′ )(f, h, g)

≤
 1
k
k
X
j=1
 ∥∆′
jf∥∥g∥sup + ∥∆′
jg∥∥f∥sup
q1/q1
k
k
X
j=1
∥∆′′
j h∥p1/p
.
By the Minkowski inequality (1.5) with q instead of p, and for each j, taking
aj = ∥∆′
jf∥∥g∥sup and bj = ∥∆′
jg∥∥f∥sup, (9.74) holds in this case with Ck
deﬁned by (9.62). In either case set A(u, k −1) := Au,l′,k and B(v, k −1) :=
Bv,l′,k. With these deﬁnitions, (9.69) and (9.70), the recursive deﬁnition of
these sets is completed. Thus z(k) = {ξ(k)
uv }(u,v)∈Ik are also deﬁned recursively
by (9.66) for k = n, n −1, . . . , 2. By (9.71) with l = l′ and (9.74), we have the
bound
Uk(z)(f, h, g)
 ≤Ck(vΦ(f), vΦ(g), vΨ(h)) +
Uk−1(z(k−1))(f, h, g)
. (9.75)
Putting k = n in (9.75) gives (9.67) with k there set equal to n −1. Applying
(9.75) inductively, it follows that (9.67) holds with k = 2. To prove (9.68) the
recursive construction starting with z(2) gives z(1) = {ξ(1)
11 } := z(2,l′) such that
U1(z(1)) = ξ(1)
11
and
U2(z(2)) −U1(z(1)) = ξ(2)
ll
for some l = l′ ∈{1, 2} as in (9.71). Thus applying (3.139) as in (9.73) together
with (9.65) and the inequality ∥∆χ∥≤Ξ−1(vΞ(χ)), we get the bound as in
(9.74),
U2(z(2))(f, h, g)
 ≤C2(vΦ(f), vΦ(g), vΨ(h)) + C1(vΦ(f), vΦ(g), vΨ(h)).
Thus (9.68) holds, which together with (9.67) for k = 2 yields (9.63). The
proof of Theorem 9.45 is complete.
2
The preceding Love–Young inequalities were proved for Riemann–Stieltjes
sums based on tagged partitions of a particular form. To bound Young–
Stieltjes sums we need to extend these inequalities to Riemann–Stieltjes sums
based on arbitrary tagged partitions.

9.8 Integrals with Two Integrands
449
Corollary 9.46. Let h ∈Wp([a, b]; B) and f, g ∈Wq([a, b]; B) with a < b,
1 ≤p, q < ∞, p−1 + q−1 > 1. For any tagged partition τ of [a, b], we have
SRS(f, dh, g; τ)
 ≤Kp,q∥f∥[q]∥g∥[q]∥h∥(p),
(9.76)
where Kp,q := 1+ζ(p−1 +q−1). Also, if µ ∈AIp([a, b]; B) then for any tagged
Young interval partition ζ of [a, b],
SYS(f, dµ, g; [a, b], ζ)
 ≤Kp,q∥f∥[q]∥g∥[q]∥µ∥(p).
(9.77)
Proof. Let τ = ({ti}n
i=0, {si}n
i=1) be a tagged partition of [a, b]. Without
changing the value of the sum SRS(f, dh, g; τ) one can assume that si ∈
{ti−1, ti} for i = 1, . . . , n, since for each i such that ti−1 < si < ti one can
reﬁne the partition {ti}n
i=0 to contain si and let si be the tag for both [ti−1, si]
and [si, ti]. Letting ∆iχ := χ(ti) −χ(ti−1) for χ = f, g, or h, we have
SRS(f, dh, g; τ) −f(a)[h(b) −h(a)]g(a)
=
n
X
i=1
f(ti)(∆ih)g(ti) −f(a)[h(b) −h(a)]g(a)
+
n
X
i=1
n
f(si)(∆ih)g(si) −f(ti)(∆ih)g(ti)
o
=: T1 + T2.
Let Ji := [ti−1, ti] for i = 1, . . . , n. By H¨older’s inequality (1.4) and (3.51), we
get
∥T2∥≤
n
X
i=1
n
∥∆if∥∥∆ih∥∥g(ti)∥+ ∥f(ti−1)∥∥∆ih∥∥∆ig∥
o
≤∥g∥sup
n
X
i=1
∥f∥Ji,(q)∥h∥Ji,(p) + ∥f∥sup
n
X
i=1
∥g∥Ji,(q)∥h∥Ji,(p)
≤∥g∥sup

n
X
i=1
vq(f; Ji)
1/q
n
X
i=1
vp(h; Ji)
1/p
+ ∥f∥sup

n
X
i=1
vq(g; Ji)
1/q
n
X
i=1
vp(h; Ji)
1/p
≤

∥f∥(q)∥g∥sup + ∥g∥(q)∥f∥sup
	
∥h∥(p).
To bound ∥T1∥we use Theorem 9.45 with Φ(u) ≡uq, Ψ(u) ≡up, u ≥0,
1 ≤p, q < ∞and p−1 + q−1 > 1. Thus we have
SRS(f, dh, g; τ)
 ≤∥T1∥+ ∥T2∥+ ∥f(a)[h(b) −h(a)]g(a)∥
≤Kp,q

∥f∥(q)∥g∥sup + ∥g∥(q)∥f∥sup
	
∥h∥(p)
+ ∥f∥sup∥h∥(p)∥g∥sup
≤Kp,q∥f∥[q]∥g∥[q]∥h∥(p),

450
9 Product Integration
proving (9.76).
To prove (9.77), let h = Rµ,a as deﬁned by (2.3). By Corollary 2.11, µ = µh
deﬁned by (2.2). Let τ = ({ti}n
i=0, {ui}n
i=1) be a tagged Young point partition
of [a, b] and let ζ = ((ti−1, ti)n
i=1, {ui}n
i=1) be the corresponding tagged Young
interval partition. It follows that SYS(f, dh, g; τ) ≡SYS(f, dµ, g; [a, b], ζ). Now
Young–Stieltjes sums SYS(f, dh, g; τ) can be approximated arbitrarily closely
by Riemann–Stieltjes sums SRS, just as in Proposition 2.18. So (9.77) follows,
proving the corollary.
2
Next we get existence of some integrals with two integrands and bounds
for them.
Proposition 9.47. For 1 ≤p, q < ∞such that p−1 + q−1 > 1, let µ ∈
AIp([a, b]; B) and let f, g ∈Wq([a, b]; B). Then the integral
R
=[a,b] f dµ g exists,
and for each B ∈I[a, b],
 R
=
B
f dµ g
 ≤Kp,q∥f∥B,[q]∥g∥B,[q]∥µ∥B,(p),
(9.78)
where Kp,q := 1 + ζ(p−1 + q−1).
Proof. By Theorem 9.42, the integral in (9.78) exists provided it does when
B = [a, b]. To prove this take q1 > q such that 1/p+1/q1 > 1. Then f, g ∈W∗
q1
by Lemma 3.61, so in proving existence of the integral we can assume f, g ∈
W∗
q . Given ǫ > 0, let δ = (ǫ/5)q. By Proposition 3.60, take a Young interval
partition κ = {(zj−1, zj)}n
j=1 of [a, b] such that Pn
j=1 vq(f; (zj−1, zj)) < δ.
We have another such partition for g, and we can take a common reﬁnement
of both for which the same bounds will hold by superadditivity of vq as an
interval function, (3.51). We can assume that κ is this common reﬁnement.
Let yj
:= (zj−1 + zj)/2 for each j. Let f1 be a step function, as given by
Proposition 3.60(c) and its proof, such that f1(zj) = f(zj) for each j and f1
has values f(zj−1+) on (zj−1, yj] and f(zj−) on (yj, zj), with ∥f −f1∥[q] <
ǫ. Let g1 be a step function deﬁned from g as f1 is from f. Let α be the
Young interval partition {(zj−1, yj), (yj, zj)}n
j=1. Then f1 and g1 are constant
on each interval in α. Let ζ be any tagged reﬁnement of α. It follows that
SYS(f1, dµ, g1; [a, b], ζ) =: S(f1, dµ, g1; ζ) = S(f1, dµ, g1; α) for each ζ. Write
∥S(f, dµ, g; ζ) −S(f1, dµ, g1; α)∥
= ∥S(f, dµ, g; ζ) −S(f1, dµ, g1; ζ)∥
≤∥S(f, dµ, g; ζ) −S(f1, dµ, g; ζ)∥+ ∥S(f1, dµ, g; ζ) −S(f1, dµ, g1; ζ)∥
= T1 + T2,
say. Then by (9.77),
T1 ≤Kp,q∥f −f1∥[q]∥g∥[q]∥µ∥(p) ≤ǫKp,q∥g∥[q]∥µ∥(p)

9.9 Duhamel’s Formula
451
and T2 ≤ǫKp,q∥f∥[q]∥µ∥(p), where ∥f1∥[q] ≤∥f∥[q] since clearly ∥f1∥sup ≤
∥f∥sup and q-variation sums for f1 can be approximated as well as desired by
such sums for f. Letting ǫ ↓0, it follows by the Cauchy test that
R
=[a,b] fdµg
exists.
Now we return to the given q. We omit the proof of inequality (9.78)
because it is the same as the proof of the Love–Young inequality in Theorem
3.93 except that now we use (9.77) if B is closed, and otherwise we ﬁrst
approximate the Young–Stieltjes sum over B by Young–Stieltjes sums over
closed subintervals of B and use the resulting bound.
2
Finally we bound the p-variation of an interval function deﬁned by an
integral:
R
= f dµ g :=

B 7→
R
=
B
f dµ g: B ∈I[a, b]

.
Corollary 9.48. For 1 ≤p, q < ∞such that p−1 + q−1 > 1, let µ ∈
AIp([a, b]; B) and let f, g ∈Wq([a, b]; B). Then
R
= f dµ g is in AIp([a, b]; B)
and for each J ∈I[a, b],
 R
= f dµ g

J,(p) ≤Kp,q∥f∥J,[q]∥g∥J,[q]∥µ∥J,(p),
(9.79)
where Kp,q := 1 + ζ(p−1 + q−1).
Proof. The interval function R= f dµ g is deﬁned and additive due to Propo-
sition 9.47 and Theorem 9.42. Also, it is upper continuous by (9.78) and
Proposition 2.6 since I[a, b] ∋A 7→vp(µ; A) is upper continuous at ∅by
Proposition 3.50. To prove (9.79), let J ∈I[a, b] and let A = {Ai}n
i=1 be an
interval partition of J. By (9.78) and (3.69) with Φ(u) ≡up, it follows that
sp(
R
= f dµ g; A) ≤Kp
p,q∥f∥p
J,[q]∥g∥p
J,[q]vp(µ; J).
Since A is arbitrary, (9.79) holds, and so
R
= f dµ g is in AIp([a, b]; B).
2
9.9 Duhamel’s Formula
In this section the algebraic identity (9.43) is extended to a suitable class of
multiplicative interval functions which includes the product integrals with re-
spect to an additive upper continuous interval function of bounded p-variation
for 1 ≤p < 2.
In the next theorem and hereafter,
R
=A f(t) γ(dt) g(t) ≡
R
=A f dγ g for any
point functions f, g on [a, b] and interval function γ on [a, b].

452
9 Product Integration
Theorem 9.49. Let µ, ν ∈AI∗
2([a, b]; B), and suppose that µ and ν have
strict product integrals bµ, bν respectively. Then for each A ∈I[a, b], the follow-
ing two integrals exist, and
bµ(A) −bν(A) =
R
=
A
bν((t, b] ∩A) (µ −ν)(dt) bµ([a, t) ∩A)
(9.80)
=
R
=
A
bµ((t, b] ∩A) (µ −ν)(dt) bν([a, t) ∩A).
(9.81)
Either of the two relations (9.80) and (9.81) will be called Duhamel’s
formula. Before proving Theorem 9.49 we establish a relation between the
p-variation of an additive interval function µ and a strict product integral bµ.
Let Φ ∈CV and let π be a B-valued interval function on J = [a, b]. For any
c > 0, let
wΦ(π, c) := wΦ(π, c; J) := sup
n
n
X
i=1
Φ
∥π(Ai) −π(∅)∥
c

: {Ai}n
i=1 ∈IP (J)
o
,
and let
VΦ(π) := VΦ(π; J) := inf{c > 0: wΦ(π, c; J) ≤1},
(9.82)
or +∞if no such ﬁnite c exists. For Φ(u) ≡up, u ≥0, 1 ≤p < ∞, we write
Vp := VΦ. Then
Vp(π) =

sup
n
n
X
i=1
∥π(Ai) −π(∅)∥p : {Ai}n
i=1 ∈IP (J)
o1/p
.
(9.83)
It is easy to check that on interval functions π for which it is ﬁnite, Vp
is a seminorm, with Vp(π) = 0 if and only if π ≡π(∅), in other words, π is
constant.
Let 1 ≤p < 2 and let bµ be the strict product integral of µ ∈AIp(J; B),
which exists and is in Ip(J; B) by Theorems 9.36 and 9.28. For an interval
partition {Ai}n
i=1 of J, by (9.41) and (3.69), we have
n
X
i=1
bµ(Ai) −1I
p ≤Cp
pKpvp(µ; J),
where K = K(µ, p) and Cp are as deﬁned in (9.29) and (9.28), respectively,
and so
Vp(bµ) ≤CpK∥µ∥(p) < ∞.
(9.84)
Thus, in this section and the next, various bounds in terms of Vp(bµ) will yield
bounds in terms of K(µ, p) (which is bounded for ∥µ∥[p] bounded) and ∥µ∥(p).
To give a more precise characterization of VΦ(bµ), recall eIΦ and ∥ν∥(Φ) for not
necessarily additive interval functions ν as deﬁned in Deﬁnition 3.18.
From the following lemma, we will actually use only the bound, for 1 ≤
p < 2, ∥bµ∥(p) ≤Vp(bµ)∥bµ∥sup.

9.9 Duhamel’s Formula
453
Lemma 9.50. Let µ be a B-valued additive interval function on [a, b], hav-
ing a strict product integral bµ. For Φ ∈CV, µ ∈eIΦ([a, b]; B) if and only
if max{∥bµ∥sup, VΦ(bµ)} < ∞, and if either of the two statements holds then
∥bµ∥(Φ) ≤VΦ(bµ)∥bµ∥sup < ∞. If 1 ≤p < ∞and Φ(x) = xp for 0 ≤x < ∞then
we also have ∥bµ∥(p) ≤Vp(bµ)∥bµ∥sup and
∥bµ∥[p] ≤Cp(bµ) := (1 + Vp(bµ))∥bµ∥sup.
(9.85)
Proof. We can assume that a < b. There exists a Young interval partition
B = {(zj−1, zj)}m
j=1 of [a, b] such that if {Bl}k
l=1 is a reﬁnement of B then
max
1≤l≤k
bµ(Bl) −1I −µ(Bl)∥≤
k
X
l=1
bµ(Bl) −1I −µ(Bl)∥≤1.
(9.86)
Let ∥µ∥[Φ] < ∞. Then ∥bµ∥sup < ∞by Proposition 9.33. To show that VΦ(bµ) <
∞let {Ai}n
i=1 be an interval partition of [a, b]. There are at most m + 1
values of i such that Ai contains some zj. For all other values of i, Ai is
included in some (zj−1, zj). For j = 1, . . . , m, let I(j) := {i = 1, . . . , n: Ai ⊂
(zj−1, zj)}, and let c > 2 max{∥µ∥(Φ), ∥bµ∥sup +1+∥µ∥sup}. Then the intervals
{Ai : i ∈I(j), j = 1, . . . , m} are members of a reﬁnement of B. Therefore
using convexity of Φ twice and Φ(0) = 0, we get
m
X
j=1
X
i∈I(j)
Φ
∥bµ(Ai) −1I∥
c

≤
m
X
j=1
X
i∈I(j)
n1
2Φ
2∥bµ(Ai) −1I −µ(Ai)∥
c

+ 1
2Φ
2∥µ(Ai)∥
c
o
(9.87)
≤Φ(1)
c
m
X
j=1
X
i∈I(j)
∥bµ(Ai) −1I −µ(Ai)∥+ 1
2vΦ
2µ
c

.
Thus by (9.86), we have the bound
n
X
i=1
Φ
∥bµ(Ai) −1I∥
c

≤(m + 1)Φ
∥bµ∥sup + 1
c

+ Φ(1)
c
+ 1
2vΦ
2µ
c

. (9.88)
Since the interval partition {Ai}n
i=1 is arbitrary, wΦ(bµ, c) < ∞and hence,
letting c →+∞for m ﬁxed, VΦ(bµ) < ∞, proving the “only if” part. Con-
versely, let max{∥bµ∥sup, VΦ(bµ)} < ∞. Then ∥µ∥sup < ∞by Proposition 9.33.
To prove ∥µ∥(Φ) < ∞, let {Ai}n
i=1 be an interval partition of A ∈I[a, b]. As
for (9.88), with bµ(Ai) −1I and µ(Ai) in (9.87) interchanged, we get that
n
X
i=1
Φ
∥µ(Ai)∥
c

≤(m + 1)Φ
∥µ∥sup
c

+ Φ(1)
c
+ wΦ(bµ, c/2)
2

454
9 Product Integration
holds for any c > 2 max{VΦ(bµ), ∥bµ∥sup + 1 + ∥µ∥sup}. For c large enough the
right side of the last display is less than 1 by continuity of Φ at 0 and the
deﬁnition of VΦ. Since {Ai}n
i=1 is arbitrary, ∥µ∥(Φ) < ∞, proving the ﬁrst part
of the conclusion.
To prove the second part let again max{∥bµ∥sup, VΦ(bµ)} < ∞, let c >
VΦ(bµ)∥bµ∥sup, and let {Ai}n
i=1 be an interval partition of A. Then by multi-
plicativity of bµ, we have
n
X
i=1
Φ
 bµ
 i[
j=1
Aj
!
−bµ
 i−1
[
j=1
Aj
!/c
!
≤
n
X
i=1
Φ
bµ(Ai) −1I
∥bµ∥sup
c

≤1.
Since c > VΦ(bµ)∥bµ∥sup is arbitrary, ∥bµ∥(Φ) ≤VΦ(bµ)∥bµ∥sup. If Φ(x) ≡xp then
we can replace ∪i
j=1Aj by ∪n
j=iAj and ∪i−1
j=1Ai by ∪n
j=i+1Ai (= ∅for i = n)
for each i = 1, . . . , n in the last display, giving the same bound for v←
p
as for
vp. The last two statements follow, completing the proof of the lemma.
2
Now we are ready to prove Duhamel’s formula.
Proof of Theorem 9.49. Taking the negative of both sides of either of the
two equalities (9.80) or (9.81), the other follows. Thus it is enough to prove
(9.81). By Deﬁnition 9.29 of multiplicative transform, for any x ∈[a, b],
bµ({x}) −bν({x}) = µ({x}) −ν({x}),
(9.89)
and so (9.81) holds with A = {x}. Thus we can assume that a < b and
A ∈I[a, b] is nondegenerate. First suppose that A = [u, v] ⊂[a, b]. Let T =
({(xi−1, xi)}n
i=1, {yi}n
i=1) be a tagged Young interval partition of [u, v], and
let A2i := {xi} for i = 0, 1, . . . , n, A2i−1 := (xi−1, xi) for i = 1, . . . , n. Then
by multiplicativity, we have
bµ([u, v]) −bν([u, v]) =
2n
Y
k=0
bµ(Ak) −
2n
Y
k=0
bν(Ak) =: M.
Applying the algebraic identity (9.43) to the right side, it follows that
M =
n
X
i=1
bµ([xi, v])

bµ((xi−1, xi)) −bν((xi−1, xi))
	
bν([u, xi−1])
+
n
X
i=0
bµ((xi, v])

bµ({xi}) −bν({xi})
	
bν([u, xi)).
Then by (9.89),
M = SYS(bµ((·, v]), d(µ −ν), bν([u, ·)); [u, v], T ) + R(T ),

9.9 Duhamel’s Formula
455
where R(T ) := Pn
i=1 Di and for i = 1, . . . , n,
Di := bµ([xi, v])

bµ((xi−1, xi)) −bν((xi−1, xi))
	
bν([u, xi−1])
−bµ((yi, v])

µ((xi−1, xi)) −ν((xi−1, xi))
	
bν([u, yi)).
To prove (9.81) for A = [u, v] it is enough to show that
lim
T R(T ) = 0.
(9.90)
For any i ∈{1, . . . , n} we have
Di = bµ([xi, v])

bµ((xi−1, xi)) −1I −µ((xi−1, xi))
	
bν([u, xi−1])
−bµ([xi, v])

bν((xi−1, xi)) −1I −ν((xi−1, xi))
	
bν([u, xi−1])
+ bµ([xi, v])

µ((xi−1, xi)) −ν((xi−1, xi))
	
bν([u, xi−1])
−bµ((yi, v])

µ((xi−1, xi)) −ν((xi−1, xi))
	
bν([u, yi))
=: U1(i) −U2(i) + U3(i) −U4(i).
Let ǫ > 0. By Lemma 3.29 with p = 2 and Deﬁnition 9.29, there exists a
Young interval partition λ = {(zj−1, zj)}m
j=1 of [a, b] such that
S1 :=
m
X
j=1
v2(µ; (zj−1, zj)) < ǫ,
S2 :=
m
X
j=1
v2(ν; (zj−1, zj)) < ǫ,
and for any Young interval partition A = {Ai}N
i=0 that is a reﬁnement of λ,
S3(A) :=
N
X
i=0
bµ(Ai)−1I−µ(Ai)
 < ǫ,
S4(A) :=
N
X
i=0
bν(Ai)−1I−ν(Ai)
 < ǫ.
(The sums can be restricted to the open intervals in A since the terms corre-
sponding to singletons are 0.) Let T = ({(xi−1, xi)}n
i=1, {yi}n
i=1) be a tagged
reﬁnement of {(zj−1, zj)}m
j=1, and A := {(xi−1, xi)}n
i=1. Then we have
n
X
i=1
∥U1(i)∥≤∥bµ∥sup∥bν∥supS3(A) < ǫ∥bµ∥sup∥bν∥sup.
Likewise, Pn
i=1 ∥U2(i)∥< ǫ∥bµ∥sup∥bν∥sup. Let γ := µ −ν. For any i ∈
{1, . . . , n}, since xi−1 < yi < xi, by straightforward algebra we have
U4(i) −U3(i)
=

bµ((yi, v]) −bµ([xi, v]) −bµ([xi, v])µ((yi, xi))
	
γ((xi−1, xi))bν([u, yi))
+ bµ([xi, v])γ((xi−1, xi))

bν([u, yi))−bν([u, xi−1])−ν((xi−1, yi))bν([u, xi−1])
	
+ bµ([xi, v])µ((yi, xi))γ((xi−1, xi))bν([u, yi))
+ bµ([xi, v])γ((xi−1, xi))ν((xi−1, yi))bν([u, xi−1]).

456
9 Product Integration
Using multiplicativity of bµ and bν, we continue the equality
U4(i) −U3(i)
= bµ([xi, v])

bµ((yi, xi)) −1I −µ((yi, xi))
	
γ((xi−1, xi))bν([u, yi))
(9.91)
+ bµ([xi, v])γ((xi−1, xi))

bν((xi−1, yi)) −1I −ν((xi−1, yi))
	
bν([u, xi−1])
+ bµ([xi, v])µ((yi, xi))

µ((xi−1, xi)) −ν((xi−1, xi))
	
bν([u, yi))
+ bµ([xi, v])

µ((xi−1, xi)) −ν((xi−1, xi))
	
ν((xi−1, yi))bν([u, xi−1]).
It is clear that
T1 :=
n
X
i=1
bµ((yi, xi)) −1I −µ((yi, xi))
 < ǫ,
and likewise
T2 :=
n
X
i=1
bν((xi−1, yi)) −1I −ν((xi−1, yi))
 < ǫ.
Using H¨older’s inequality (1.4) with p = q = 2, and then Minkowski’s inequal-
ity (1.5) with r = 2, it follows that
T3 :=
n
X
i=1
µ((yi, xi))

nµ((xi−1, xi))
 +
ν((xi−1, xi))

o
< √ǫ

∥µ∥(2) + ∥ν∥(2)
	
and
T4 :=
n
X
i=1
ν((xi−1, yi))

nµ((xi−1, xi))
 +
ν((xi−1, xi))

o
< √ǫ

∥µ∥(2) + ∥ν∥(2)
	
.
Now summing the norms of the right side of equality (9.91), we have
n
X
i=1
U4(i) −U3(i)

≤∥bµ∥sup∥γ∥sup∥bν∥sup

T1 + T2

+ ∥bµ∥sup∥bν∥sup

T3 + T4

< 2ǫ∥bµ∥sup∥γ∥sup∥bν∥sup + 2√ǫ∥bµ∥sup∥∥bν∥sup

∥µ∥(2) + ∥ν∥(2)
	
.
It follows from these bounds that (9.90) holds.
Now if A = (u, v] then all calculations are the same except that bµ({u}) =
bν({u}) = 1I and µ({u}) = ν({u}) = 0. The proof is also similar to the above
for the other two cases A = [u, v) and A = (u, v). The proof of Theorem 9.49
is complete.
2

9.10 Smoothness of the Product Integral Operator
457
9.10 Smoothness of the Product Integral Operator
For 1 ≤p < ∞, recall that Ip(J; B) is the set of all interval functions on
an interval J with values in B having bounded p-variation, and AIp(J; B)
is the set of all additive and upper continuous interval functions in Ip(J; B).
Integrals
R
= dν f may be written
R
= ν(ds)f(s).
Let 1 ≤p < 2. If µ ∈AIp([a, b]; B) then the strict product integral bµ of
µ exists and is in Ip([a, b]; B) by Theorem 9.36. Thus we have deﬁned the
nonlinear operator P:
AIp([a, b]; B) ∋µ 7→P(µ) = bµ =
(1I + dµ) ∈Ip([a, b]; B),
(9.92)
acting between the two Banach spaces. We call P the product integral operator.
Investigation of smoothness of this operator in the sense of diﬀerential calculus
on normed spaces (see Chapter 5) is the subject of the present section. We
will prove that P has a Taylor expansion around each µ ∈AIp([a, b]; B), and
that the Taylor series has inﬁnite radius of uniform convergence. We will also
show that the kth term of the Taylor series is deﬁned by the interval function
Qk
µ(ν) = {Qk
µ(ν)(A): A ∈I[a, b]}, where
Qk
µ(ν)(A)
(9.93)
=



R
=A bµ((s, b] ∩A) ν(ds) bµ([a, s) ∩A)
if k = 1,
R
=A bµ((s1, b] ∩A) ν(ds1)
R
=[a,s1)∩A bµ((s2, s1)) ν(ds2) · · ·
· · ·
R
=[a,sk−1)∩A bµ((sk, sk−1)) ν(dsk) bµ([a, sk) ∩A)
if k ≥2.
In the latter iterated integral, we have sj ∈A for j = 1, . . . , k, and so each
interval (sj, sj−1) ⊂A and (sj, sj−1) ∩A = (sj, sj−1) for j = 2, . . . , k. Here
the iterated integral is ﬁrst done with respect to sk for each ﬁxed sk−1, then
with respect to sk−1 for each sk−2, and so on. The main result to be proved
in this section is the following theorem:
Theorem 9.51. Let B be a Banach algebra, a < b, and 1 ≤p < 2. The prod-
uct integral operator (9.92) is a uniformly entire mapping from AIp([a, b]; B)
into Ip([a, b]; B). More speciﬁcally, for µ ∈AIp([a, b]; B), the following hold:
(a) for each integer k ≥1 and ν ∈AIp([a, b]; B), relation (9.93) deﬁnes an
interval function Qk
µ(ν) = {Qk
µ(ν)(A): A ∈I[a, b]} in Ip([a, b]; B);
(b) for each integer k ≥1, the mapping
AIp := AIp([a, b]; B) ∋ν 7→Qk
µ(ν) ∈Ip([a, b]; B) =: Ip
is a k-homogeneous polynomial;
(c) the power series P
k≥1 Qk
µ(ν −µ) from AIp to Ip around µ has inﬁnite
radius of uniform convergence and its sum is equal to P(ν) −P(µ).
The following is a special case of the preceding theorem: a Taylor expansion
of the product integral operator around 0.

458
9 Product Integration
Corollary 9.52. Let ν ∈AIp([a, b]; B) with 1 ≤p < 2 and a < b. Then for
any interval A ⊂[a, b],
A
(1I + dν) = 1I + ν(A)
+
X
k≥2
R=
A
ν(ds1)
R=
[a,s1)∩A
ν(ds2) · · ·
R=
[a,sk−1)∩A
ν(dsk).
(9.94)
Before proving Theorem 9.51 we establish several auxiliary results. Let
µ, ν ∈AIp([a, b]; B) for some 1 ≤p < 2. By the Duhamel formula (9.80), for
A ∈I[a, b], we have
\
µ + ν(A) −bµ(A) =
R
=
A
bµ
 (s, b] ∩A

ν(ds) \
µ + ν([a, s) ∩A

.
(9.95)
The Love–Young inequality (9.79), if applicable to the integral on the right
side, would imply the Lipschitzian property of the nonlinear product integral
operator P :
µ 7→bµ. To justify its applicability the next two lemmas give
bounds for the p-variation of the two integrands in (9.95).
Lemma 9.53. For 1 ≤p < 2 and a < b, let α ∈I←
p ([a, b]; B). For nonempty
A ∈I[a, b] and t ∈A, let fA(t) := α((t, b] ∩A). Then for any nonempty
A ∈I[a, b],
∥fA∥A,[p] ≤∥α∥←
A,[p].
(9.96)
In particular if α = bµ for µ ∈AIp([a, b]; B), then
∥fA∥A,[p] ≤∥bµ∥←
A,[p] ≤∥bµ∥A,[p] ≤Cp(bµ)
(9.97)
where the right side is deﬁned by (9.85).
Proof. Statement (9.96) follows by the deﬁnition (9.47) of the reversed form
of the p-variation. Then (9.97) follows from Lemma 9.50.
2
Lemma 9.54. Let a < b, let η ∈Iq([a, b]; B) with 1 ≤q < ∞, let A ∈I[a, b]
be nonempty, and let gA(t) := η([a, t) ∩A), t ∈A. Then gA ∈Wq(A; B),
∥gA∥A,(q) ≤∥η∥A,(q)
and
∥gA∥A,sup ≤∥η∥A,sup.
(9.98)
Proof. The second inequality in (9.98) holds because [a, t)∩A is a subinterval
of A. To prove the ﬁrst one we can assume that A is nondegenerate. Let
κ = {ti}n
i=0 be a point partition of A and let Ai := [ti−1, ti) ∩A, i = 1, . . . , n.
Then {Ai}n
i=1 is an interval partition of [t0, tn) ∩A ⊂A. So we have
sq(gA; κ) =
n
X
i=1
η
 i[
j=1
Aj
!
−η
 i−1
[
j=1
Aj
!
q
≤∥η∥q
A,(q),
where a union over the empty set of indices is deﬁned as the empty set. Thus
the ﬁrst inequality in (9.98) holds, proving the lemma.
2

9.10 Smoothness of the Product Integral Operator
459
Next is a technical device to be used for bounding the remainder in dif-
ferentiating the product integral operator. Its proof will use additivity of the
interval function A 7→
R
=A f(s)ν(ds)g(s) for ﬁxed f, g ∈Wp([a, b]; B), which
holds by Theorem 9.42 and Proposition 9.47. But in (9.99), the integrands
depend on A, and β itself is in general not additive (nor multiplicative, since
β(∅) = 0 ̸= 1I).
Proposition 9.55. For 1 ≤p < 2 and a < b, let µ, ν ∈AIp([a, b]; B) and let
α ∈Ip([a, b]; B). Then the interval function β = {β(A): A ∈I[a, b]} deﬁned
by
β(A) :=
R
=
A
bµ
 (s, b] ∩A

ν(ds) α
 [a, s) ∩A

,
A ∈I[a, b],
(9.99)
exists and we have the bound
∥β∥[p] ≤Kp∥bµ∥←
[p]

2 + Vp(bµ)

∥ν∥(p)∥α∥[p],
(9.100)
where Vp is deﬁned by (9.83) and Kp := Kp,p = 1 + ζ(2/p).
Or if instead α ∈I←
p ([a, b]; B), and we deﬁne
eβ(A) := R=
A
α
 (s, b] ∩A

ν(ds) bµ
 [a, s) ∩A

,
A ∈I[a, b],
(9.101)
then eβ exists and
∥eβ∥←
[p] ≤Kp∥bµ∥[p]

2 + Vp(bµ)

∥ν∥(p)∥α∥←
[p].
(9.102)
Proof. The strict product integral bµ is deﬁned by Theorem 9.36. By Lemmas
9.50, 9.53, and 9.54, the point functions bµ((t, b] ∩A), t ∈A, and α([a, t) ∩A),
t ∈A, have bounded p-variation for each nonempty A ∈I[a, b]. Therefore
by Proposition 9.47 with q = p, the integral (9.99) is deﬁned, and for each
nonempty A ∈I[a, b],
 R
=
A
bµ((s, b] ∩A) ν(ds) α([a, s) ∩A)

≤Kp∥bµ((·, b] ∩A)∥A,[p]∥α([a, ·) ∩A)∥A,[p]∥ν∥A,(p)
≤Kp∥bµ∥←
[p]∥α∥[p]∥ν∥A,(p),
(9.103)
where the second inequality holds by (9.97) and (9.98). To bound the p-
variation of β, let D ∈I[a, b] be nonempty, let A = {Ai}n
i=1 be an interval
partition of D, and for each i = 1, . . . , n, let Bi := ∪j≤iAj. Since bµ is multi-
plicative and [a, s) ∩Bi = [a, s) ∩D for each s ∈Bi, i = 1, . . . , n, we have for
i = 2, . . . , n,

460
9 Product Integration
β(Bi) −β(Bi−1) =
R
=
Ai
bµ((s, b] ∩Bi) ν(ds) α([a, s) ∩D)
+
R
=
Bi−1
bµ((s, b] ∩Ai)bµ((s, b] ∩Bi−1) ν(ds) α([a, s) ∩D)
−R=
Bi−1
bµ((s, b] ∩Bi−1) ν(ds) α([a, s) ∩D)
=
R
=
Ai
bµ((s, b] ∩Ai) ν(ds) α([a, s) ∩D)
+
h
bµ(Ai) −1I
i R
=
Bi−1
bµ((s, b] ∩Bi−1) ν(ds) α([a, s) ∩D).
Since β(∅) = 0, by the Minkowski inequality (1.5), we have
sp(β; A)1/p
=
β(A1)
p +
n
X
i=2
β(Bi) −β(Bi−1)
p1/p
≤

n
X
i=1
 R
=
Ai
bµ((s, b] ∩Ai) ν(ds) α([a, s) ∩D)
p1/p
+

n
X
i=2
bµ(Ai) −1I
p
R
=
Bi−1
bµ((s, b] ∩Bi−1) ν(ds) α([a, s) ∩D)

p1/p
.
(9.104)
As in the bound (9.103) with the point function α([a, t) ∩A), t ∈A, replaced
by the function α([a, t) ∩D), t ∈A ∈I(D), we have
 R
=
A
bµ((s, b] ∩A) ν(ds)α([a, s) ∩D)
 ≤Kp∥bµ∥←
[p]∥α∥[p]∥ν∥A,(p)
for each A ∈I(D). Applying this bound to (9.104) yields
sp(β; A)1/p ≤Kp∥bµ∥←
[p]∥α∥[p]

n
X
i=1
vp(ν; Ai)
1/p
+Kp∥bµ∥←
[p]∥α∥[p]∥ν∥(p)

n
X
i=1
∥bµ(Ai) −1I∥p1/p
≤Kp∥bµ∥←
[p]∥α∥[p]

1 + Vp(bµ)

∥ν∥(p)
by (3.69) and (9.83).
Since A is an arbitrary interval partition of D, we get the bound
vp(β; D)1/p ≤Kp∥bµ∥←
[p]∥α∥[p]

1 + Vp(bµ)

∥ν∥(p)
for each nonempty D ∈I[a, b]. This and (9.103) yield (9.100).
A proof for (9.101) is symmetric, proving the proposition.
2

9.10 Smoothness of the Product Integral Operator
461
We get as a byproduct the following general fact, in which the product
integral does not appear.
Theorem 9.56. For 1 ≤p < 2 and a < b, let ν ∈AIp([a, b]; B) and let
α ∈Ip([a, b]; B). Then the interval function β = {β(A): A ∈I[a, b]} deﬁned
by
β(A) :=
R
=
A
ν(ds)α
 A ∩[a, s)

(9.105)
exists and satisﬁes
∥β∥[p] ≤2Kp∥ν∥(p)∥α∥[p],
(9.106)
where Kp
:=
Kp,p
=
1 + ζ(2/p). Thus (ν, α) 7→β is a bounded bilinear
operator from AIp([a, b]; B) × Ip([a, b]; B) into Ip([a, b]; B).
Or if α ∈I←
p ([a, b]; B), then the interval function eβ = {eβ(A): A ∈I[a, b]}
deﬁned by
eβ(A) :=
R
=
A
α((s, b] ∩A)ν(ds),
A ∈I[a, b],
(9.107)
exists and satisﬁes
∥eβ∥←
[p] ≤2Kp∥ν∥(p)∥α∥←
[p].
(9.108)
Thus (ν, α) 7→eβ takes AIp([a, b]; B) × I←
p ([a, b]; B) into I←
p ([a, b]; B) and is a
bounded bilinear operator.
Proof. In either case we apply Proposition 9.55 to µ ≡0, so that bµ ≡1I.
For (9.106) we apply (9.100) and for (9.108) we use (9.101). The conclusions
follow.
2
The following gives a bound for Vp(β) when β is an interval function
deﬁned by a suitable integral.
Proposition 9.57. Let a < b, 1 ≤p < 2, α ∈I←
p ([a, b]; B), ν ∈AIp([a, b]; B)
and η ∈Ip([a, b]; B). Then β deﬁned by
β(A) :=
R
=
A
α((s, b] ∩A)ν(ds)η([a, s) ∩A)
is an interval function with β(∅) = 0 and
∥β∥sup ≤Vp(β) ≤Kp∥α∥←
[p]∥η∥[p]∥ν∥(p),
where Kp := Kp,p := 1 + ζ(2/p).
Proof. From the deﬁnition it is clear that β(∅) = 0. For any such interval
function β, clearly ∥β∥sup ≤Vp(β). We apply the Love–Young inequality
(9.78) with q = p for fA := α((·, b] ∩A), gA := η([a, ·) ∩A), and ν in place of
µ there, and then apply Lemmas 9.53 and 9.54 for fA and gA, respectively,
giving

462
9 Product Integration
∥β(A)∥≤Kp∥fA∥A,[p]∥gA∥A,[p]∥ν∥A,(p) ≤Kp∥α∥←
[p]∥η∥[p]∥ν∥A,(p).
For any interval partition {Ai}n
i=1 of [a, b], using (3.69), we have
n
X
i=1
∥β(Ai)∥p ≤Kp
p(∥α∥←
[p])p∥η∥p
[p]∥ν∥p
(p),
which also gives the same bound for Vp(β)p, completing the proof.
2
Let 1 ≤p < 2 and µ ∈AIp([a, b]; B). Then the strict product integral bµ
of µ exists and is in Ip([a, b]; B) ⊂Ip([a, b]; B) by Theorem 9.36. Let L0
µ := bµ.
For k ≥1, ν1, . . . , νk ∈AIp([a, b]; B) and A ∈I[a, b], deﬁne recursively
Lk
µ(ν1, . . . , νk)(A)
:=
R
=
A
bµ((s, b] ∩A) νk(ds) Lk−1
µ
(ν1, . . . , νk−1)([a, s) ∩A)
=
R
=
A
bµ((s1, b] ∩A) νk(ds1)
R
=
[a,s1)∩A
bµ((s2, s1)) νk−1(ds2) · · ·
· · ·
R
=
[a,sk−1)∩A
bµ((sk, sk−1)) ν1(dsk) bµ([a, sk) ∩A)
(9.109)
provided the Kolmogorov integrals exist. In the iterated integral we inte-
grate ﬁrst with respect to sk, and then sk−1, . . . , s1. If ν1, . . . , νk = ν then
Lk
µ(ν, . . . , ν) = Qk
µ(ν) deﬁned by (9.93). As in (9.93), for all j = 1, . . . , k
we have sj ∈A, thus for j = 2, . . . , k, (sj, sj−1) ⊂A and (sj, sj−1) ∩A =
(sj, sj−1).
Lemma 9.58. Let µ ∈AIp([a, b]; B), 1 ≤p < 2. Then for each k ≥1
and any ν1, . . . , νk ∈AIp([a, b]; B), the interval function deﬁned by Lk :=
Lk
µ(ν1, . . . , νk) = {Lk
µ(ν1, . . . , νk)(A): A ∈I[a, b]} exists,
∥Lk∥[p] ≤
n
Kp∥bµ∥←
[p](2 + Vp(bµ))
ok
∥bµ∥[p]∥ν1∥(p) · · · ∥νk∥(p),
(9.110)
and
Vp(Lk) ≤
n
Kp∥bµ∥←
[p]
ok
(2 + Vp(bµ))k−1∥bµ∥[p]∥ν1∥(p) · · · ∥νk∥(p).
(9.111)
Proof. By the ﬁrst part of Proposition 9.55 with α = L0
µ = bµ, the interval
function L1
µ(ν1) = {L1
µ(ν1)(A): A ∈I[a, b]} is deﬁned and (9.110) holds with
k = 1. Assuming it holds for some k ≥1 and applying (9.100) with α = Lk =
Lk
µ(ν1, . . . , νk) it follows that (9.110) holds with k + 1 in place of k, and so it
holds for each k ≥1 by induction. Also, for each k ≥1 the interval function
Lk
µ(ν1, . . . , νk) is deﬁned and is in Ip([a, b]; B). For (9.111), by Proposition
9.57 and (9.110), for each k ≥1 we have

9.10 Smoothness of the Product Integral Operator
463
Vp(Lk) ≤Kp∥bµ∥←
[p]∥Lk−1∥[p]∥νk∥(p)
(9.112)
≤
n
Kp∥bµ∥←
[p]
ok
(2 + Vp(bµ))k−1∥bµ∥[p]∥ν1∥(p) · · · ∥νk∥(p),
proving the lemma.
2
For µ as before in AIp([a, b]; B), let Q0
µ(ν) := bµ for any ν ∈AIp, and
let Qk
µ(ν) be deﬁned by (9.93) for each k ≥1. For ν also in AIp([a, b]; B) let
γ0(µ, ν) := \
µ + ν −bµ. For each integer n ≥1, let
γn(µ, ν) := \
µ + ν −
n
X
k=0
Qk
µ(ν) = γ0(µ, ν) −
n
X
k=1
Qk
µ(ν).
(9.113)
By (9.95), we have an integral representation of γ0(µ, ν) = {γ0(µ, ν)(A): A ∈
I[a, b]}. The following extends this fact to γn(µ, ν).
Lemma 9.59. Let µ, ν ∈AIp([a, b]; B). For each n ≥1 and any A ∈I[a, b],
γn(A) =
R
=
A
bµ
 (s, b] ∩A

ν(ds) γn−1([a, s) ∩A

.
(9.114)
Proof. Recall that Qn
µ(ν) = Ln
µ(ν, . . . , ν) for each n ≥1. Let γn := γn(µ, ν)
for each n ≥0, and let A ∈I[a, b]. By Theorem 9.43(c), (9.95), and (9.109)
with k = 1, we have
γ1(A) = γ0(A) −L1
µ(ν)(A) =
R
=
A
bµ
 (s, b] ∩A

ν(ds) γ0([a, s) ∩A

.
Using Theorem 9.43(c) again, γn = γn−1 −Ln
µ(ν, . . . , ν) for n ≥1, and (9.109)
for the induction step, it follows that (9.114) holds for each n ≥1 by induction.
2
The next lemma gives a technical device to bound ∥ρ∥[p] in terms of Vp(ρ)
for suitable non-additive interval functions ρ.
Lemma 9.60. Let µ ∈AIp([a, b]; B), B1, B2 ∈I[a, b], B1 ∪B2 ∈I[a, b], and
B1 ≺B2. For for each n ≥0 and for any ν1, . . . , νn ∈AIp([a, b]; B),
Ln
µ(ν1, . . . , νn)(B1 ∪B2)
=
n
X
k=0
Lk
µ(νn−k+1, . . . , νn)(B2)Ln−k
µ
(ν1, . . . , νn−k)(B1). (9.115)
Also, for each n ≥0 and any ν ∈AIp, writing γn := γn(µ, ν), we have
γn(B1 ∪B2) = γn(B2)\
µ + ν(B1) +
n
X
k=0
Qk
µ(ν)(B2)γn−k(B1).
(9.116)

464
9 Product Integration
Proof. The proof is by induction. To prove (9.115) note that it holds when
n = 0 by multiplicativity of bµ. Assume that (9.115) holds for some n ≥0.
Let L0 := L0
µ and Ln := Ln
µ(ν1, . . . , νn) for each n ≥1. By additivity and
trilinearity of
R
= (Theorems 9.42 and 9.43(c)), we then have Ln+1(B1 ∪B2) =
I1 + I2 where by (9.109),
I1 := bµ(B2)
R
=
B1
bµ((s, b] ∩B1) νn+1(ds) Ln([a, s) ∩B1) = bµ(B2)Ln+1(B1)
and
I2 :=
R
=
B2
bµ((s, b] ∩B2) νn+1(ds) Ln(B1 ∪([a, s) ∩B2)).
The latter integrand in I2, by induction hypothesis, equals
n
X
k=0
Lk(νn−k+1, . . . , νn)([a, s) ∩B2)Ln−k(ν1, . . . , νn−k)(B1)
for s ∈B2, and since the Ln−k factor does not depend on s we get by (9.109),
I2 =
n
X
k=0
Lk+1(νn−k+1, . . . , νn+1)(B2)Ln−k(ν1, . . . , νn−k)(B1).
Thus (9.115) holds for n + 1 in place of n and for each n ≥0 by induction.
To prove (9.116) note that it holds when n = 0 by multiplicativity of bµ
and \
µ + ν. Assume that (9.116) holds for some n ≥0. Then using (9.115)
with n + 1 in place of n and with ν1 = · · · = νn+1 = ν, we have
γn+1(B1 ∪B2)
= γn(B1 ∪B2) −Qn+1(B1 ∪B2)
=

γn(B2) −Qn+1(B2)
\
µ + ν(B1) + Qn+1(B2)
\
µ + ν(B1) −bµ(B1)

+
n
X
k=0
Qk(B2)

γn−k(B1) −Qn+1−k(B1)

= γn+1(B2)\
µ + ν(B1) +
n+1
X
k=0
Qk(B2)γn+1−k(B1),
and so (9.116) holds for each n ≥0, proving the lemma.
2
The following shows that the n-linear mapping Ln
µ deﬁned by (9.109) acts
from the n-fold product (AIp)n into Ip and gives bounds for norms.
Lemma 9.61. Let µ ∈AIp([a, b]; B), 1 ≤p < 2. For each k ≥1 and
ν1, . . . , νk ∈AIp([a, b]; B), let Lk(ν1, . . . , νk) := Lk
µ(ν1, . . . , νk) be the interval
function deﬁned recursively by (9.109). Then for each integer n ≥1 and any
ν1, . . . , νn ∈AIp,

9.10 Smoothness of the Product Integral Operator
465
∥Ln(ν1, . . . , νn)∥[p]
≤D(bµ)Vp(Ln(ν1, . . . , νn))
(9.117)
+
n−1
X
k=1
Vp(Lk(νn−k+1, . . . , νn))Vp(Ln−k(ν1, . . . , νn−k))
≤

Kp∥bµ∥←
[p]
n
D(bµ)n−2∥bµ∥[p]

D(bµ)2+(n−1)∥bµ∥[p]
 n
Y
i=1
∥νi∥(p)
(9.118)
where Kp = 1 + ζ(2/p) and D(bµ) := 1 + Vp(bµ) + ∥bµ∥sup.
Proof. Let L0 := L0
µ := bµ and Lk := Lk(ν1, . . . , νk) for each k ≥1. Let n ≥1,
let D ∈I[a, b] be nonempty, and let A = {Ai}m
i=1 ∈IP (D). To bound the
p-variation sum sp(Ln; A), by (9.115), we have
Ln(B1∪B2)−Ln(B1) =

bµ(B2) −1I

Ln(B1)
+
n
X
k=1
Lk(νn−k+1, . . . , νn)(B2)Ln−k(ν1, . . . , νn−k)(B1)
for B1 := Si−1
j=1 Aj and B2 := Ai for i = 1, . . . , m. As usual, the union over the
empty set of indices is deﬁned as empty. Using the Minkowski inequality (1.5),
and the deﬁnition of Vp(·) for bµ with bµ(∅) = 1I and for Lk with Lk(∅) = 0, it
then follows that
sp(Ln; A)1/p ≤Vp(bµ)∥Ln∥sup
+
n
X
k=1
Vp(Lk(νn−k+1, . . . , νn))∥Ln−k(ν1, . . . , νn−k)∥sup,
and so
∥Ln∥[p] ≤D(bµ)Vp(Ln)
+
n−1
X
k=1
Vp(Lk(νn−k+1, . . . , νn))∥Ln−k(ν1, . . . , νn−k)∥sup.
(9.119)
To bound the reversed p-variation we use the equality
Ln(B1∪B2)−Ln(B2) = Ln(B2)

bµ(B1) −1I

+
n−1
X
k=0
Lk(νn−k+1, . . . , νn)(B2)Ln−k(ν1, . . . , νn−k)(B1)
with B1 := Ai and B2 := S
j>i Aj for i = 1, . . . , m. Similarly using the
Minkowski inequality, it follows that
∥Ln∥←
[p] ≤D(bµ)Vp(Ln)
+
n−1
X
k=1
∥Lk(νn−k+1, . . . , νn)∥supVp(Ln−k(ν1, . . . , νn−k)).

466
9 Product Integration
This together with (9.119) yields (9.117). Inserting (9.110) and (9.111) into
the right side of (9.117) and using 2 + Vp(bµ) ≤D(bµ) gives (9.118), proving
the lemma.
2
Next we give bounds for the remainder γn(µ, ν) deﬁned by (9.113). In its
proof we will use the fact that ∥α∥sup ≤∥α(∅)∥+ Vp(α) for every interval
function α.
Lemma 9.62. Let µ, ν ∈AIp([a, b]; B), 1 ≤p < 2. Then
∥γ0(µ, ν)∥[p] ≤C(µ, ν)Kp∥bµ∥←
[p]∥\
µ + ν∥[p]∥ν∥(p)
(9.120)
and for each n ≥1,
∥γn(µ, ν)∥[p] ≤C(µ, ν)Vp(γn) +
n
X
k=1
Vp(Qk
µ(ν))Vp(γn−k)
(9.121)
≤∥\
µ + ν∥[p]

C(µ, ν)2 + ∥bµ∥[p] + (n −1)C(µ, ν)∥bµ∥[p]

×
×D(bµ)n−1n
Kp∥bµ∥←
[p]∥ν∥(p)
on+1
(9.122)
where Kp = 1 + ζ(2/p), C(µ, ν) = 2 + Vp(bµ) + Vp(\
µ + ν), and D(bµ) := 1 +
Vp(bµ) + ∥bµ∥sup.
Proof. For k ≥0, let Qk := Qk
µ(ν) and γk := γk(µ, ν). Let n ≥0, let D ∈
I[a, b] be nonempty, and let A = {Ai}m
i=1 ∈IP (D). To bound the p-variation
sum sp(γn; A) we use
γn(B1 ∪B2) −γn(B1)
=

bµ(B2) −1I

γn(B1) + γn(B2)\
µ + ν(B1) +
n
X
k=1
Qk(B2)γn−k(B1)
with B1 := Si−1
j=1 Aj and B2 := Ai for i = 1, . . . , m, which holds by (9.116).
The sum on the right side is zero when n = 0. As always, the union over the
empty set of indices is deﬁned as empty. Using the Minkowski inequality (1.5),
and the deﬁnition of Vp(·) for bµ with bµ(∅) = 1I and for γn with γn(∅) = 0, it
then follows that
sp(γn; A)1/p ≤Vp(bµ)∥γn∥sup + Vp(γn)∥\
µ + ν∥sup +
n
X
k=1
Vp(Qk)∥γn−k∥sup.
This gives the bound
∥γn∥[p] ≤C(µ, ν)Vp(γn) +
n
X
k=1
Vp(Qk)∥γn−k∥sup.

9.10 Smoothness of the Product Integral Operator
467
Next using (9.116) with B1 := Ai and B2 := S
j>i Aj for i = 1, . . . , m, it
follows that
∥γn∥←
[p] ≤C(µ, ν)Vp(γn) +
n
X
k=1
∥Qk∥supVp(γn−k),
and so if n ≥1, (9.121) follows. Also if n = 0 we have from the last two
displays
∥γ0∥[p] ≤C(µ, ν)Vp(γ0).
(9.123)
To prove (9.120) we use the integral representation (9.95) for γ0. By Proposi-
tion 9.57 with α = bµ and η = \
µ + ν, it follows that
Vp(γ0) ≤Kp∥bµ∥←
[p]∥\
µ + ν∥[p]∥ν∥(p).
(9.124)
Inserting this bound into the right side of (9.123) gives (9.120).
To prove (9.122) we use the integral representation (9.114) of γk. Also
using (9.100) recursively and (9.120), it follows that for each k ≥1,
∥γk∥[p] ≤Kp∥bµ∥←
[p](2 + Vp(bµ))∥ν∥(p)∥γk−1∥[p]
≤· · · ≤
n
Kp∥bµ∥←
[p](2 + Vp(bµ))∥ν∥(p)
ok
∥γ0∥[p]
≤C(µ, ν)∥\
µ + ν∥[p](2 + Vp(bµ))kn
Kp∥bµ∥←
[p]∥ν∥(p)
ok+1
.
Again using (9.114) and Proposition 9.57 with α = bµ and η = γk−1, together
with the preceding bound, it follows that the bound
Vp(γk) ≤Kp∥bµ∥←
[p]∥γk−1∥[p]∥ν∥(p)
≤C(µ, ν)∥\
µ + ν∥[p](2 + Vp(bµ))k−1n
Kp∥bµ∥←
[p]∥ν∥(p)
ok+1
(9.125)
holds for each k ≥1. Finally, by (9.111), for each k ≥1 we have
Vp(Qk) ≤
n
Kp∥bµ∥←
[p]∥ν∥(p)
ok
(2 + Vp(bµ))k−1∥bµ∥[p].
(9.126)
Now we will prove (9.122) as follows. First we use (9.125) and (9.126) with
k = n together with (9.124) to get that
C(µ, ν)Vp(γn) + Vp(Qn)Vp(γ0)
≤∥\
µ + ν∥[p]

C(µ, ν)2 + ∥bµ∥[p]

D(bµ)n−1n
Kp∥bµ∥←
[p]∥ν∥(p)
on+1
,
since 2 + Vp(bµ) ≤D(bµ). Second if n > 1 we use (9.125) and (9.126) with
k ∈{1, . . . , n −1} to get the bound

468
9 Product Integration
n−1
X
k=1
Vp(Qk
µ(ν))Vp(γn−k)
≤(n −1)C(µ, ν)∥\
µ + ν∥[p]∥bµ∥[p]D(bµ)n−2n
Kp∥bµ∥←
[p]∥ν∥(p)
on+1
.
Adding the preceding two bounds gives (9.122), completing the proof of the
lemma.
2
Next we show that L1
µ deﬁned by (9.109) with k = 1 is the derivative of
the product integral operator.
Proposition 9.63. Under the conditions of Theorem 9.51, the product in-
tegral operator P is everywhere diﬀerentiable from AIp into Ip, its deriva-
tive at µ ∈AIp is given by L1
µ(ν) = Q1
µ(ν), ν ∈AIp, and the remainder
γ1 := γ1(µ, ν) deﬁned by (9.113) has the bound
∥γ1∥[p] ≤C(µ, ν)Vp(γ1) + Vp(L1
µ(ν))Vp(γ0)
≤
n
Kp∥bµ∥←
[p]
o2
∥\
µ + ν∥[p]

C(µ, ν)2 + ∥bµ∥[p]

∥ν∥2
(p),
(9.127)
where Kp = 1 + ζ(2/p) and C(µ, ν) := 2 + Vp(bµ) + Vp(\
µ + ν).
Proof. Let µ ∈AIp([a, b]; B). By Lemma 9.58 with k = 1 the interval function
L1
µ(ν) = {L1
µ(ν)(A): A ∈I[a, b]} is deﬁned for each ν ∈AIp([a, b]; B). By
Lemma 9.61 with n = 1, L1
µ(·) maps AIp into Ip and is linear by Theorem
9.43(b), which also holds for [a, b] replaced by any interval A. By Lemma 9.62
with n = 1, (9.127) holds. By (9.49) and (9.84), respectively,
∥\
µ + ν∥[p] ≤K+CpK2∥µ+ν∥(p)
and
Vp(\
µ + ν) ≤CpK∥µ+ν∥(p) (9.128)
where K = K(µ + ν, p) and Cp are deﬁned by (9.29) and just after (9.28),
respectively. By (9.29), K(µ+ν, p) is bounded uniformly for ν in any bounded
set in AIp([a, b]; B) and µ ﬁxed. Thus so are ∥\
µ + ν∥[p] and Vp(\
µ + ν). It
follows that as ∥ν∥(p) →0, ∥γ1(µ, ν)∥[p] = O(∥ν∥2
(p)) = o(∥ν∥(p)). Thus L1
µ is
the derivative of the operator ν 7→\
µ + ν = P(µ + ν) at ν = 0, proving the
proposition.
2
The conclusion of the next proposition implies that the product integral
operator P deﬁned by (9.92) is analytic.
Proposition 9.64. Let B be a Banach algebra, a < b, 1 ≤p < 2, and µ ∈
AIp([a, b]; B). Then the statements, (a), (b) of Theorem 9.51 and the following
statement (c′) hold:

9.10 Smoothness of the Product Integral Operator
469
(c′) there exists T > 0 such that the power series P
k≥1Qk
µ(ν −µ) converges
to P(ν) −P(µ) absolutely and uniformly for ∥ν −µ∥[p] ≤T .
Proof. Let µ ∈AIp([a, b]; B). By Lemmas 9.58 and 9.61, for each k ≥1 and
ν1, . . . , νk, the interval function Lk
µ(ν1, . . . , νk) = {Lk
µ(ν1, . . . , νk)(A): A ∈
I[a, b]} is deﬁned by (9.109) and is in Ip. Since Qk
µ(ν) = Lk
µ(ν, . . . , ν) for
ν ∈AIp, (a) of Theorem 9.51 holds.
By Theorem 9.43(b), extended to not necessarily closed intervals A, for
each k ≥1, Lk
µ is a k-linear mapping from the k-fold product (AIp)k into Ip.
For ν1, . . . , νk ∈AIp, let
Lk,sym
µ
(ν1, . . . , νk) := (k!)−1 X
π
Lk
µ(νπ(1), . . . , νπ(k)),
(9.129)
where the sum is over all permutations π of {1, . . ., k}. Then Lk,sym
µ
is a k-
linear symmetric mapping from the k-fold product (AIp)k into Ip. By (9.118)
Lk,sym
µ
is a bounded k-linear symmetric mapping from (AIp([a, b]; B))k into
Ip([a, b]; B) with norm
∥Lk,sym
µ
∥≤Kk
p ∥bµ∥k+1
[p] D(bµ)k−2n
D(bµ)2 + (k −1)∥bµ∥[p]
o
,
where Kp = 1 + ζ(2/p) and D(bµ) := 1 + Vp(bµ) + ∥bµ∥sup. Since for ν ∈AIp,
Q1
µ(ν) = L1
µ(ν) and Qk
µ(ν) = Lk,sym
µ
(ν, . . . , ν) = Lk
µ(ν, . . . , ν) for k ≥2, each
Qk
µ is a k-homogeneous polynomial, proving (b) of Theorem 9.51.
For (c′) recall the deﬁnition (9.113) of the remainder γn(µ, ν). By (9.122)
there is a ﬁnite constant C = C(p, bµ) := D(bµ)Kp∥bµ∥[p] ≥1 such that for each
n ≥1 and any ν ∈AIp,
∥γn(µ, ν)∥[p] ≤(n + 1)Cn+2∥\
µ + ν∥[p](2 + Vp(bµ) + Vp(\
µ + ν))2∥ν∥n+1
(p) .
By (9.128) and the boundedness of K(µ + ν, p) for ν bounded, as in the
previous proof, we obtain that for 0 < r < 1/C, ∥γn(µ, ν)∥[p] →0 as n →
∞uniformly for ∥ν∥(p) ≤r, proving (c′). The proof of Proposition 9.64 is
complete.
2
Now we are ready to prove the main result of this section.
Proof of Theorem 9.51. Statements (a) and (b) hold by Proposition 9.64. It
is enough to prove (c) for µ ≡0. Indeed, assuming (c) to hold for the 0 interval
function, let µ ∈AIp([a, b]; B) be arbitrary. By Theorem 5.21 with X = AIp,
Y = Ip, u = 0, and v = µ, for each integer k ≥1 there exists a k-homogeneous
polynomial P k
µ such that the power series P
k≥1 P k
µ(ν −µ) has inﬁnite radius
of uniform convergence, and its sum is P(ν) −P(µ). On the other hand, by
Proposition 9.64, the power series P
k≥1 Qk
µ(ν −µ) converges uniformly and
absolutely in a neighborhood of µ, and its sum is also P(ν) −P(µ). Due to

470
9 Product Integration
uniqueness of power series (Theorem 5.9), Qk
µ = P k
µ for each k ≥1. Thus (c)
holds provided it holds for µ ≡0.
To prove (c) for µ ≡0, we will ﬁrst prove that for each ν ∈AIp, the
bound
Qk
0(ν)

[p] ≤2Ck
p ∥ν∥k
(p)/(k!)1/p
(9.130)
holds for each k ≥2, where Cp := 1 + 41/pζ(2/p). To prove (9.130) we use
Lemma 9.26 inductively to bound the norms of the increments of the functions
fk := RQk,a, k ≥2, deﬁned by (2.3), where Qk := Qk
0(ν). By Proposition 3.30,
vp(Qk; [a, b]) = vp(fk; [a, b])
(9.131)
provided
lim
r↑t Qk([a, r]) = Qk([a, t))
for a < t ≤b
(9.132)
and
lim
r↓t Qk([a, r]) = Qk([a, t])
for a ≤t < b.
(9.133)
Let Q1 := ν. Then for each k ≥2 and A ∈I[a, b], by (9.109) with bµ ≡1I,
Qk(A) =
R
=
A
ν(ds)Qk−1([a, s) ∩A).
(9.134)
For any a ≤r < t ≤b, we have that
Qk([a, t)) −Qk([a, r]) = R=
(r,t)
ν(ds)Qk−1([a, s)).
This Kolmogorov integral over an interval B in place of (r, t) deﬁnes an addi-
tive and upper continuous interval function by Corollary 9.48. Letting r ↑t,
we obtain (9.132). Similarly it follows that (9.133) holds, and so (9.131) does.
So we will next bound the p-variation of the point function fk for each k ≥2.
Let h be the B-valued point function on [a, b] deﬁned by h(t) := ν([a, t])
for a ≤t ≤b. Since ν is upper continuous, h is right-continuous on [a, b).
Let ρ be the nondecreasing function on [a, b] deﬁned by ρ(t) := vp(ν; [a, t]) if
a < t ≤b, and ρ(a) := 0. By (3.68), it follows that for each a ≤s < t ≤b,
∥h(t) −h(s)∥≤vp(ν; (s, t])1/p ≤
 ρ(t) −ρ(s)
1/p.
Letting f1 := RQ1,a = Rν,a, it follows similarly that for each a ≤s < t ≤b,
∥f1(t) −f1(s)∥≤
 ρ(t) −ρ(s)
1/p.
For k ≥2, since Qk({a}) = 0 = Qk(∅), we have for each a ≤t ≤b,
fk(t) = RQk,a(t) =
R
=
[a,t]
ν(ds) Qk−1([a, s)) = (RRS)
Z t
a
dh
 fk−1
(a)
−,

9.10 Smoothness of the Product Integral Operator
471
where the last equality holds by Proposition 2.90 due to (9.132) if k ≥3 and
due to Proposition 2.6(f) if k = 2. Also for each k ≥1, fk is right-continuous
on (a, b) due to (9.133) if k ≥2 and due to Proposition 2.6(f) if k = 1. By
Lemma 9.26 with k = 1, we then have that for each a ≤s < t ≤b,
∥f2(t) −f2(s)∥≤
f2

[s,t],(p) ≤C2
p
ρ2(t) −ρ2(s)
2
1/p
.
Further applying the same lemma inductively, for each a ≤s < t ≤b,
∥fk(t) −fk(s)∥≤Ck
p
ρk(t) −ρk(s)
k!
1/p
for k = 2, 3, . . . . From this and (9.131) it follows that for each k ≥2 and each
ν ∈AIp([a, b]; B), we have
vp(Qk
0(ν); [a, b])1/p ≤Cp∥ν∥k
(p)/(k!)1/p.
(9.135)
Let a ≤c < d ≤b, let ν ∈AIp([a, b]; B), and let eν(A) := ν(A∩[[c, d]]) for each
A ∈I[a, b]. Clearly eν ∈AIp([a, b]; B) and ∥eν∥(p) ≤∥ν∥(p). We claim that for
each k ≥2 and each t ∈[[c, d]],
Qk
0(ν)([[c, t]]) = Qk
0(eν)([a, t]]).
(9.136)
Indeed for any t ∈[[c, d]], by (9.134) we have
Q2
0(ν)([[c, t]]) =
R
=
[[c,t]]
ν(ds) eν([a, s) ∩[a, t]])
=
R
=
[a,t]]
eν(ds) eν([a, s) ∩[a, t]]) = Q2
0(eν)([a, t]]).
Thus (9.136) holds for k = 2. Assuming it holds for some k ≥2, one can show
similarly that it holds with k replaced by k + 1, and so (9.136) holds for each
k ≥2 by induction. Then by (9.135), for each k ≥2,
vp(Qk
0(ν); [[c, d]])1/p = vp(Qk
0(eν); [a, b])1/p ≤Cp
∥eν∥k
(p)
(k!)1/p ≤Cp
∥ν∥k
(p)
(k!)1/p .
Since a ≤c < d ≤b are arbitrary, (9.130) follows.
Next we will show that for each k = 0, 1, . . .,
∥Qk
0∥= sup{∥Qk∥[p]: ∥ν∥[p] ≤1} ≤(k3 + 1)Kp(2Cp)k/k!1/p.
(9.137)
For each k ≥4, by (9.117) with ν1 = · · · = νk = ν and µ ≡0, we have
∥Qk∥[p] ≤2Vp(Qk) + 2∥ν∥(p)Vp(Qk−1) +
k−2
X
i=2
Vp(Qi)Vp(Qk−i),
(9.138)

472
9 Product Integration
since D(bµ) = 2 in this case, and Vp(Q1) = ∥ν∥(p). Next using (9.134) and
Proposition 9.57 to bound the right side, it follows that
∥Qk∥[p] ≤2Kp∥ν∥(p)∥Qk−1∥[p] + 2Kp∥ν∥2
(p)∥Qk−2∥[p]
+ K2
p∥ν∥2
(p)
k−2
X
i=2
∥Qi−1∥[p]∥Qk−i−1∥[p].
This together with (9.130) applied to each ∥Qj∥[p] gives the bound
∥Qk∥[p] ≤4K2
pCk−1
p
∥ν∥k
(p)
n
2
((k −2)!)1/p +
k−2
X
i=2
1
((i −1)!(k −i −1)!)1/p
o
.
For any integers r, s ≥0 we have 1/(r!s!) ≤2r+s/(r + s)!. It follows that
∥Qk∥[p] ≤4K2
pCk−1
p
∥ν∥k
(p)
2 + (k −3)2k−2
(k −2)!1/p

≤
kKp(2Cp)k∥ν∥k
(p)
(k −2)!1/p
,
which implies (9.137) for k ≥4. For k = 1, 2, 3, (9.138) still holds where the
sum on the right drops out; for k = 2, the factor of 2 in the middle term on
the right is unnecessary; and for k = 1, the middle term also disappears, and
we can put (k −1)! in place of (k −2)!. For k = 0, Q0 ≡1I, so ∥Q0∥[p] = 1 and
the given bound holds, so (9.137) is proved for all k = 0, 1, . . .. Therefore
lim sup
k→∞
∥Qk
0∥1/k = 0,
(9.139)
and the radius of uniform convergence is inﬁnite by the Cauchy–Hadamard
formula (Theorem 5.10).
The next step will be to show that for each ν ∈AIp,
P(ν) = 1I +
X
k≥1
Qk
0(ν).
(9.140)
To prove this we will apply a lemma, to be used in full generality in the
next section. Recall that Qp = [1, p/(p −1)) if p > 1, Q1 = {+∞}, and
W∞([a, b]; B) = R([a, b]; B), the class of all regulated functions as deﬁned
before Proposition 3.96. Let Up := {q ∈Qp : q ≥p}. Then Up is nonempty
for each p with 1 ≤p < 2.
Lemma 9.65. Let ν ∈AIp([a, b]; B) for 1 ≤p < 2, and let q ∈Up. If g ∈
Wq([a, b]; B) and either g(t) =
R
=(a,t) dν g for a ≤t ≤b, or g(t) =
R
=(a,t] dν g−
for a ≤t ≤b, then g ≡0 on [a, b].
Proof. We can assume that a < b. In either case, g(a) = g(a+) = 0 since
R
= dν g and
R
= dν g(a)
−
are additive upper continuous interval functions on [a, b]
by Proposition 3.96 and (1.16). First suppose that g(t) =
R
=(a,t) dν g for a ≤

9.10 Smoothness of the Product Integral Operator
473
t ≤b. For each a ≤t ≤b, since ∥g∥[a,t],[q] is a nonincreasing function of q
(Lemma 3.45), then using Corollary 3.43(d) and the Love–Young inequalities
(3.151) and (3.153), we have
∥g∥[a,t],[q] ≤∥g∥[a,t],[p] = ∥
R
= dν g∥(a,t],[p] ≤2Kp,q∥ν∥(a,t],(p)∥g∥(a,t],[q],
where Kp,q = ζ(p−1+q−1) if p > 1 and Kp,q = 1 if p = 1. If 2Kp,q∥ν∥(a,t],(p) <
1, as is true for some t > a by Proposition 3.50, then ∥g∥[a,t],[q] = 0, so g ≡0
on [a, t]. Let u := sup{t ∈[a, b]: g(s) = 0 for a ≤s ≤t}. Then u > a. Since
g(t) −g(s) =
R
=[s,t) dν g for a ≤s < t ≤b and
R
= dν g is an upper continuous
interval function, g is left-continuous, and so g ≡0 on [a, u]. If u = b then we
are done. If u < b, then for u ≤t ≤b, g(t) =
R
=(u,t) dν g by additivity of the
integral (Theorem 9.42). Then by the same argument with u in place of a,
g ≡0 on some interval [u, v] for v > u, contradicting the deﬁnition of u and
proving the lemma in the ﬁrst case.
Now suppose that g(t) = R=(a,t] dν g−for a ≤t ≤b. For a ≤t ≤b, since
∥g−∥(a,t],[q] ≤∥g∥(a,t],[q], as in the ﬁrst case, we have
∥g∥[a,t],[q] ≤2Kp,q∥ν∥(a,t],(p)∥g∥(a,t],[q].
Again, we conclude that u := sup{t ∈[a, b]: g(s) = 0 for a ≤s ≤t} > a.
As before, by additivity and upper continuity of the Kolmogorov integral
R
= dν g(a)
−, we have
lim
s↑u
R
=
(s,u]
dν g−= ν({u})g(u−) = 0.
Thus g(u) = g(u−) = 0, and so g ≡0 on [a, u]. By the same argument as in
the ﬁrst case, g ≡0 on [a, b], completing the proof of the lemma.
2
Continuing the proof of Theorem 9.51, for each n ≥1, let
γn := γn(0, ν) = P(ν) −1I −
n
X
k=1
Qk
0(ν)
(see (9.113)). By (9.139), the series
γ∞:= P(ν) −1I −
∞
X
k=1
Qk
0(ν) = lim
n→∞γn
converges in Ip([a, b]; B), absolutely and uniformly for ν in any bounded subset
in AIp([a, b]; B). By Lemma 9.59 with µ ≡0, we have
γn(A) =
R
=
A
ν(ds) γn−1([a, s) ∩A)
(9.141)

474
9 Product Integration
for any n ≥2 and interval A ⊂[a, b]. Letting n →∞, by the Love–Young
inequality (9.78) and by Lemma 9.54 applied to η = γn−1 −γ∞, we have
γ∞(A) =
R
=
A
ν(ds) γ∞([a, s) ∩A)
(9.142)
for any interval A ⊂[a, b]. For A = [[r, t) ⊂[a, b], letting g(t) := γ∞([[r, t)), we
have g(t) =
R
=[[r,t) dν g. Since γ∞(∅) = 0 (by the deﬁnition of the Kolmogorov
integral), it follows that g(r) = γ∞(∅) = 0. Thus by additivity of the integral
(Theorem 9.42), g(t) =
R
=(r,t) dν g for any a ≤r ≤t ≤b. By Lemma 9.65, it
then follows that γ∞([[r, t)) = 0 for any a ≤r ≤t ≤b. Then by additivity
again,
γ∞([[r, t]) =
R
=
[[r,t]
ν(ds) γ∞([a, s) ∩[[r, t)) = γ∞([[r, t)) + ν({t})γ∞([[r, t)) = 0,
giving γ∞([[r, t]]) = 0 for any a ≤r ≤t ≤b. Thus γ∞≡0 on [a, b], and hence
(9.140) holds. The proof of Theorem 9.51 is complete.
2
9.11 Linear Integral Equations
In the integral equations in this section we either integrate over intervals open
at their variable endpoint t, or take an integrand f(t−) or g(t+). To take the
integral over [a, t] in Theorem 9.66, for example, risks contradictions as in
(1.8). In this section we give solutions, unique in suitable Wq spaces, of four
types of linear integral equations with respect to an additive upper continuous
interval function: (a) forward homogeneous, (b) backward homogeneous, (c)
forward inhomogeneous and (e) backward inhomogeneous. The solutions are
expressed in terms of product integrals.
The next theorem gives solutions of some forward homogeneous linear
integral equations. Recall the notation Up, p ≥1, given before Lemma 9.65.
Theorem 9.66. Let µ ∈AIp([a, b]; B) for 1 ≤p < 2 and let y ∈B. Then the
following two statements hold:
(a) The integral equation
f(t) = y +
R
=
[a,t)
dµ f,
a ≤t ≤b,
(9.143)
has the solution f = f1 where f1(t) := bµ([a, t))y for a ≤t ≤b, f1 ∈
Wp([a, b]; B), and f1 is the unique solution in Wq([a, b]; B) for each q ∈Up.
(b) The integral equation
f(t) = y +
R
=
(a,t]
dµ f−,
a ≤t ≤b,
(9.144)
has the solution f = f2 where f2(t) := bµ((a, t])y for a ≤t ≤b, f2 ∈
Wp([a, b]; B), and f2 is the unique solution in Wq([a, b]; B) for each q ∈Up.

9.11 Linear Integral Equations
475
Proof. By Theorems 9.28 and 9.36, the strict product integral bµ exists and is
an upper continuous, bounded, and multiplicative interval function on [a, b]
having bounded p-variation. By the Duhamel formula (9.80) with ν ≡0 mul-
tiplied from the right by y ∈B, for each A ∈I[a, b],
bµ(A)y = y +
R
=
A
dµ bµ([a, ·) ∩A)y.
(9.145)
We have f1 ∈Wp([a, b]; B) by Lemma 9.54 with A = [a, b]. In (9.145), letting
A = [a, t), it follows that f1 is a solution of (9.143). To prove the stated
uniqueness, let q ∈Up and let h ∈Wq([a, b]; B) be such that (9.143) holds
for h in place of f. Then let g := h −f1 on [a, b]. Since f1 ∈Wq([a, b]; B) by
Lemma 3.45, g ∈Wq([a, b]; B) also. By (9.143) with h in place of f, and by
(9.145) with A = [a, t),
g(t) =
R
=
[a,t)
dµ g,
a ≤t ≤b.
(9.146)
Since g(a) = h(a) −y = 0, by additivity of the integral (Theorem 2.21), for
each t ∈(a, b],
g(t) = µ({a})g(a) +
R
=
(a,t)
dµ g =
R
=
(a,t)
dµ g.
(9.147)
Hence g ≡0 on [a, b] by Lemma 9.65, proving the uniqueness part of statement
(a).
To prove statement (b), ﬁrst we show that f2 has bounded p-variation on
[a, b]. By multiplicativity, we have for any a ≤s < t ≤b,
∥f2(s) −bµ((a, t))y∥≤∥bµ∥sup∥y∥∥1I −bµ((s, t))∥,
(9.148)
and for any a ≤t < r ≤b,
∥f2(r) −bµ((a, t])y∥≤∥bµ∥sup∥y∥∥bµ((t, r]) −1I∥.
(9.149)
Due to boundedness and upper continuity of bµ the right sides tend to 0 as
s ↑t or r ↓t, respectively. Thus (f2)−(t) = bµ((a, t))y for each t ∈(a, b] and
f2(t+) = f2(t) for each t ∈[a, b). Applying Proposition 3.30 with J = (a, b] to
f2 restricted to (a, b] and the interval function {bµ(A)y: A ∈I(a, b]}, and then
using Corollary 3.43(b), we have that f2 has bounded p-variation on [a, b]. Thus
by (9.145) with A = (a, t], it follows that f2 is a solution of (9.144). To prove
the uniqueness statement for it, let q ∈Up and let h ∈Wq([a, b]; B) be such
that (9.144) holds for h in place of f. Let g := h −f2. Then g ∈Wq([a, b]; B)
and instead of (9.146) and (9.147), now we have
g(t) =
R
=
(a,t]
dµ g−
for each t ∈[a, b]. Again applying Lemma 9.65, it follows that g ≡0 on [a, b],
proving the uniqueness of the solution for statement (b). The proof of Theorem
9.66 is complete.
2

476
9 Product Integration
Let MIq([a, b]; B), 0 < q < ∞, be the set of all multiplicative, bounded,
and upper continuous interval functions in Iq([a, b]; B). The following will be
used to solve inhomogeneous linear integral equations. Recall again the point
function Rν,a deﬁned for an interval function ν by Deﬁnition 2.3.
Corollary 9.67. Let a < b, let µ ∈AIp([a, b]; B) for 1 ≤p < 2, let q ≥p
be such that p−1 + q−1 > 1, and let Da := {[a, t), (a, t]: t ∈[a, b]}. For
α ∈MIq([a, b]; B), the following two statements are equivalent:
(a) α(A) = bµ(A) for each A ∈Da;
(b) for each A ∈Da,
α(A) = 1I +
R
=
A
dµ α([a, ·) ∩A).
(9.150)
If in addition the function Rbµ,a on [a, b] is invertible, then either of the above
statements is equivalent to the following statement: (c) α = bµ on [a, b].
Remark 9.68. The following example shows that in general, statement (c)
of the preceding corollary does not follow from (a) or (b). Let B = R. Recall
that δt, t ∈[a, b], is the interval function on [a, b] such that δt(A) = 1 if t ∈A
and = 0 otherwise. Let a < u < v < b, µ := −δu, and ν := −δu −δv. Since
µ, ν ∈AI1([a, b]; R), by Theorem 9.36, the strict product integrals bµ and bν are
in MI1([a, b]; R). Also, by Lemma 9.30, bµ = 1 −δu and bν = (1 −δu)(1 −δv).
Letting α := bν, we have that (a) and (b) hold but not (c).
Proof. As in the previous proof, bµ exists and is in MIp([a, b]; B). Let y = 1I
in Theorem 9.66, and let α ∈MIq([a, b]; B).
(a) ⇒(b). Relation (9.150) for A = [a, t), t ∈[a, b], holds by Theorem
9.66(a), and for A = (a, t], t ∈[a, b], (9.150) holds by Theorem 9.66(b) since
α((a, t)) = lim
s↑t α((a, s]) = lim
s↑t bµ((a, s]) = bµ((a, t))
for each t ∈(a, b] by upper continuity of bµ and α as in (9.148).
(b) ⇒(a). Relation (9.150) for A = [a, t), t ∈[a, b], gives that the function
f := α([a, ·)) is a solution of the integral equation (9.143). By Lemma 9.54
with A = [a, b], f ∈Wq([a, b]; B). Thus α([a, t)) = bµ([a, t)) for all t ∈[a, b]
by Theorem 9.66(a). Let g := α((a, ·]). By upper continuity, as in (9.148),
g−(t) = α((a, t)) for each t ∈(a, b]. Thus (9.150) for A = (a, t], t ∈[a, b],
gives that g is a solution of the integral equation (9.144). Once again as in
(9.148) and (9.149), it follows that the hypotheses of Proposition 3.30 with
J = (a, b] hold for g and α restricted to (a, b]. This together with Corollary
3.43(b) yields g ∈Wq([a, b]; B), and so α((a, t]) = bµ((a, t]) for all t ∈[a, b] by
Theorem 9.66(b), proving (a).
(a) ⇔(c). Clearly, (c) implies (a). For the converse implication, since
a < b and [a, t) ↓{a} as t ↓a, α({a}) = bµ({a}) by upper continuity of α
and bµ. Thus by multiplicativity, Rα,a(t) = α([a, t]) = bµ([a, t]) = Rbµ,a(t) for
each t ∈(a, b], and Rα,a(a) = α(∅) = 1I = bµ(∅) = Rbµ,a(a). By (a) ⇒(d) of

9.11 Linear Integral Equations
477
Proposition 9.6, Rbµ,a ≡Rα,a is a regulated function on [a, b], and α([a, t)) =
Rα,a(t−) = Rbµ,a(t−) = bµ([a, t)) holds for each t ∈(a, b]. Let (Rbµ,a)inv be the
reciprocal function of Rbµ,a, and thus of Rα,a. So by multiplicativity, we have
α([s, t]) = α([s, t])α([a, s))(Rα,a)inv(s−) = Rα,a(t)(Rα,a)inv(s−)
= Rbµ,a(t)(Rbµ,a)inv(s−) = bµ([s, t])bµ([a, s))(Rbµ,a)inv(s−) = bµ([s, t])
for each a < s ≤t ≤b. Similarly it follows that α([[s, t]]) = bµ([[s, t]]) for each
a ≤s < t ≤b, proving (c). The proof of Corollary 9.67 is complete.
2
The next theorem gives a solution of a backward homogeneous linear inte-
gral equation. Its proof is omitted since it is similar to the proof of Theorem
9.66 except that here we use Duhamel’s formula (9.81) instead of (9.80).
Theorem 9.69. Let µ ∈AIp([a, b]; B) for 1 ≤p < 2 and let y ∈B. Then the
following two statements hold:
(a) The integral equation
g(t) = y +
R
=
(t,b]
g dµ,
a ≤t ≤b,
(9.151)
has the solution g = g1 where g1(t) = ybµ((t, b]) for a ≤t ≤b, g1 ∈
Wp([a, b]; B), and g1 is the unique solution in Wq([a, b]; B) for each q ∈Up.
(b) The integral equation
g(t) = y + R=
[t,b)
g+ dµ,
a ≤t ≤b,
(9.152)
has the solution g = g2 where g2(t) = ybµ([t, b)) for a ≤t ≤b, g2 ∈
Wp([a, b]; B), and g2 is the unique solution in Wq([a, b]; B) for each q ∈Up.
The next statement will also be used to solve inhomogeneous linear integral
equations. Recall the point function Lν,b deﬁned for an interval function ν by
Deﬁnition 2.3.
Corollary 9.70. Let a < b, let µ ∈AIp([a, b]; B) for 1 ≤p < 2, let q ≥p
be such that p−1 + q−1 > 1, and let Db := {(t, b], [t, b): t ∈[a, b]}. For α ∈
MIq([a, b]; B), the following two statements are equivalent:
(a) α(B) = bµ(B) for each B ∈Db;
(b) for each B ∈Db,
α(B) = 1I +
R
=
B
α((·, b] ∩B) dµ.
(9.153)
If in addition the function Lbµ,b is invertible then either of the above statements
is equivalent to the following statement: (c) α = bµ on [a, b].

478
9 Product Integration
A proof of the corollary is based on arguments symmetric to those used
to prove Corollary 9.67 and therefore is omitted.
Now we turn to inhomogeneous linear integral equations.
Theorem 9.71. Let µ, ν ∈AIp([a, b]; B) for 1 ≤p < 2, and let y ∈B. Then
the following two statements hold:
(a) The integral equation
f(t) = y +
R
=
[a,t)
dµ f + ν([a, t)),
a ≤t ≤b,
(9.154)
has the solution f = f3, in Wp([a, b]; B) and unique in Wq([a, b]; B) for
each q ∈Up, where
f3(t) := bµ([a, t))y + R=
[a,t)
bµ((·, t)) dν,
a ≤t ≤b.
(9.155)
(b) The integral equation
f(t) = y +
R
=
(a,t]
dµ f−+ ν((a, t]),
a ≤t ≤b,
(9.156)
has the solution f = f4, in Wp([a, b]; B) and unique in Wq([a, b]; B) for
each q ∈Up, where
f4(t) := bµ((a, t])y + R=
(a,t]
bµ((·, t]) dν,
a ≤t ≤b.
(9.157)
For the proof we will use an integral relation to be proved next by solving
a homogeneous linear integral equation with respect to a suitable 2×2 matrix-
valued interval function.
Lemma 9.72. Let a < b, let µ, ν ∈AIp([a, b]; B) for 1 ≤p < 2, and let γ be
the interval function on [a, b] deﬁned by
γ(A) :=
R
=
A
bµ((·, b] ∩A) dν,
A ∈I[a, b].
(9.158)
Then for each A ∈Da = {(a, t], [a, t): t ∈[a, b]}, we have
γ(A) =
R
=
A
dµ γ([a, ·) ∩A) + ν(A).
(9.159)
Proof. The interval function γ is well deﬁned by Proposition 9.55 with α ≡1I,
which also gives the bound
∥γ∥[p] ≤KpCp(bµ)

2 + Vp(bµ)

∥ν∥(p),
(9.160)
where Kp := Kp,p = 1+ζ(2/p), Cp(bµ) := [1+Vp(bµ)]∥bµ∥sup, and Wp is deﬁned
by (9.83). Then, by Proposition 9.55 with α = γ, µ and ν interchanged, and

9.11 Linear Integral Equations
479
then ν ≡0, so that bν ≡1I, it follows that the Kolmogorov integral in (9.159)
exists for each interval A. Let B⌝be the set of all 2 × 2 matrices ( x y
0 z ) with
x, y, z ∈B. As for matrices with scalar elements, deﬁne addition of matrices
elementwise, and let
 x y
0 z
  u v
0 w

:=
 xu xv + yw
0
zw

and
 x y
0 z
  u
v

:=
xu + yv
zv

.
Then B⌝is a vector space. For u, v ∈B, let ∥( u
v )∥:= max{∥u∥, ∥v∥}. Deﬁne
a norm on B⌝by

 x y
0 z
 := sup

 x y
0 z
  u
v
 : u, v ∈B, ∥u∥≤1, ∥v∥≤1

.
Then
max{∥x∥, ∥y∥, ∥z∥} ≤


x y
0 z
 ≤2 max{∥x∥, ∥y∥, ∥z∥}.
Equipped with the identity 1I⌝
:=
  1I 0
0 1I

, B⌝is a Banach algebra. Let
ξ := ( µ ν
0 0 ). It is easy to verify that ξ is an additive upper continuous in-
terval function on [a, b] with bounded p-variation, that is, ξ ∈AIp([a, b]; B⌝).
Also, let ˜ξ :=
  bµ γ
0 1I

, another B⌝-valued interval function on [a, b]. The p-
variation of ˜ξ is bounded because the p-variation of γ is bounded by (9.160),
and the p-variation of bµ is bounded by Theorem 9.36. We next show that
˜ξ is multiplicative and ˜ξ(A) = bξ(A) for each A ∈Da. To this aim, let
nonempty A, B ∈I[a, b] be such that A ≺B and C := A ∪B is an in-
terval. For t ∈A, (t, b] ∩C = ((t, b] ∩A) ∪B, and so by multiplicativity,
bµ((t, b] ∩C) = bµ(B)bµ((t, b] ∩A). For t ∈B, (t, b] ∩C = (t, b] ∩B. Thus by
deﬁnition (9.158) of γ, by additivity of the Kolmogorov integral (Theorem
2.21), and by (9.57) with u = bµ(B), where
R
=A bµ((·, b] ∩A)dν = γ(A) exists,
we have
γ(C) =
R
=
A
bµ
 (·, b] ∩C

dν +
R
=
B
bµ
 (·, b] ∩C

dν
= bµ(B) R=
A
bµ
 (·, b] ∩A

dν + R=
B
bµ
 (·, b] ∩B

dν
= bµ(B)γ(A) + γ(B).
Multiplying two matrices, it then follows that
˜ξ(B)˜ξ(A) =
 bµ(B)bµ(A)
bµ(B)γ(A) + γ(B)
0
1I

=
 bµ(C) γ(C)
0
1I

= ˜ξ(C).
Since γ(∅) = 0, ˜ξ(∅) is the identity in B⌝, and so ˜ξ is a multiplicative interval
function on [a, b]. For each a ≤t < c ≤b, we have, letting y := 1I in Theorem
9.69, with c in place of b there,

480
9 Product Integration
1I +
R
=
At,c
bµ((·, c] ∩At,c) dµ = bµ(At,c)
for At,c = (t, c] by Theorem 9.69(a), and for At,c = [t, c) by Theorem 9.69(b)
since bµ((s, c)) = limr↓s bµ([r, c)) by multiplicativity and upper continuity. By
deﬁnition of the Kolmogorov integral, we then get
1I⌝+
R
=
At,c
˜ξ
 (·, c] ∩At,c

dξ
=
 1I +
R
=At,c bµ
 (·, c] ∩At,c

dµ
R
=At,c bµ
 (·, c] ∩At,c

dν
0
1I

(9.161)
=
 bµ(At,c)
R
=At,c bµ
 (·, c] ∩At,c

dν
0
1I

= ˜ξ(At,c)
for each a ≤t < c ≤b. By implication (b) ⇒(a) of Corollary 9.70 applied
to the B⌝-valued interval functions ξ and α = ˜ξ restricted to [a, c], we have
˜ξ(At,c) = bξ(At,c) for each a ≤t < c ≤b. In particular, ˜ξ(A) = bξ(A) for
each A ∈Da. Now by implication (a) ⇒(b) of Corollary 9.67 applied to the
B⌝-valued interval functions ξ and α = ˜ξ, it follows that for each A ∈Da,

bµ(A)
γ(A)
0
1I

= ˜ξ(A) = 1I⌝+
R
=
A
dξ ˜ξ
 [a, ·) ∩A

=

1I +
R
=A dµ bµ([a, ·) ∩A)
R
=A dµ γ([a, ·) ∩A) + ν(A)
0
1I

.
Thus (9.159) must hold for each A ∈Da, completing the proof of the lemma.
2
Proof of Theorem 9.71. If a = b it is straightforward that all conclusions
hold, with f3(a) = f4(a) = y. So we can assume that a < b. Let γ be the
interval function on [a, b] deﬁned by (9.158). Then for f3 deﬁned by (9.155),
f3(t) = bµ([a, t))y+γ([a, t)) for t ∈[a, b]. We have f3 ∈Wp([a, b]; B) by Lemma
9.54 with q = p and A = [a, b] and since bµ, γ ∈Ip([a, b]; B) by Theorem 9.36
and (9.160). Therefore by Theorem 9.66(a) and by (9.159) with A = [a, t), we
have
R
=
[a,t)
dµ f3 =
R
=
[a,t)
dµ bµ([a, ·))y +
R
=
[a,t)
dµ γ([a, ·))
= bµ([a, t))y −y + γ([a, t)) −ν([a, t)) = f3(t) −y −ν([a, t))
for each t ∈[a, b], that is, f3 indeed solves the integral equation (9.154). To
show uniqueness, let h ∈Wq([a, b]; B) be such that (9.154) holds for h in place
of f. Then letting g := h −f3, we have g(a) = h(a) −y = 0 and

9.11 Linear Integral Equations
481
g(t) =
R
=
[a,t)
dµ g =
R
=
(a,t)
dµ g
for each t ∈[a, b] as in (9.147). By Lemma 9.65, it then follows that g ≡0
on [a, b]. Therefore (9.155) gives the unique solution of (9.154) in Wq, proving
(a).
To prove (b), for f4 deﬁned by (9.157), using (9.158) with A = (a, t], we
have f4(t) = bµ((a, t])y + γ((a, t]) for a ≤t ≤b. First we show that
(f4)−(t) = bµ((a, t))y + γ((a, t))
for t ∈(a, b].
(9.162)
Since the strict product integral bµ is an upper continuous, bounded, and mul-
tiplicative interval function, it follows by (9.148) with y = 1I that bµ((a, s]) →
bµ((a, t)) as s ↑t for t ∈(a, b]. For γ, by additivity of the Kolmogorov integral
(Theorem 2.21), and by bringing a ﬁxed element u = bµ((s, t)) of B outside an
integral via (9.57), as we can since the integral deﬁning γ((a, s]) exists,
γ((a, t)) =
R
=
(a,s]
bµ((·, s] ∪(s, t)) dν +
R
=
(s,t)
bµ((·, t)) dν
= bµ((s, t))γ((a, s]) + γ((s, t))
(9.163)
for a < s < t ≤b. Since bµ is upper continuous at ∅, bµ((s, t)) →1I as s ↑t.
By Lemma 9.53 with f[a,u) = bµ((·, u)), ∥bµ((·, u))∥(s,u),[p] ≤Cp(bµ) for each
a ≤s < u ≤b, where the ﬁnite constant Cp(bµ) is deﬁned just after (9.160).
Therefore by the Love–Young inequality (9.78), for each a ≤s < t ≤b,
∥γ((s, t))∥=

R
=
(s,t)
bµ((·, t)) dν
 ≤KpCp(bµ)∥ν∥(s,t),(p),
where Kp := Kp,p = 1 + ζ(2/p). By Proposition 3.50, ∥ν∥(s,t),(p) →0 as s ↑t,
and so ∥γ((s, t))∥→0 as s ↑t. Hence since ∥γ∥sup < ∞by (9.160), we get by
(9.163) that
γ((a, t)) −γ((a, s]) =

bµ((s, t)) −1I

γ((a, s]) + γ((s, t)) →0
(9.164)
as s ↑t for a < t ≤b, and so (9.162) holds. Now as for (a), by Theorem
9.66(b), and by (9.159) with A = (a, t], we have
R
=
(a,t]
dµ (f4)−=
R
=
(a,t]
dµ bµ((a, ·))y +
R
=
(a,t]
dµ γ((a, ·))
= bµ((a, t])y −y + γ((a, t]) −ν((a, t]) = f4(t) −y −ν((a, t])
for each t ∈(a, b], that is, f4 solves the integral equation (9.156). To show
uniqueness, let h ∈Wq([a, b]; B) be such that (9.156) holds with h in place of
f. For a ≤t ≤b, let g(t) := h(t) −bµ((a, t])y −γ((a, t]). By (9.156) with h in
place of f, Theorem 9.66(b) and (9.159) with A = (a, t], we then have

482
9 Product Integration
g(t) =
R
=
(a,t]
dµ

h−−bµ((a, ·))y −γ([a, ·))

=
R
=
(a,t]
dµ g−
for each a ≤t ≤b. By Lemma 9.65, it follows that g ≡0 on [a, b]. Therefore
(9.157) is the unique solution of (9.156) in Wq. The proof of Theorem 9.71 is
complete.
2
We next have an analogous result for a backward inhomogeneous integral
equation.
Theorem 9.73. Let µ, ν ∈AIp([a, b]; B) for 1 ≤p < 2, and let y ∈B. Then
the following two statements hold:
(a) The integral equation
g(t) = y +
R
=
(t,b]
g dµ + ν((t, b]),
a ≤t ≤b,
(9.165)
has the solution g = g3, in Wp([a, b]; B) and unique in Wq([a, b]; B) for
each q ∈Up, where
g3(t) := ybµ((t, b]) +
R
=
(t,b]
dν bµ((t, ·)),
a ≤t ≤b.
(9.166)
(b) The integral equation
g(t) = y +
R
=
[t,b)
g+ dµ + ν([t, b)),
a ≤t ≤b,
(9.167)
has the solution g = g4, in Wp([a, b]; B) and unique in Wq([a, b]; B) for
each q ∈Up, where
g4(t) := ybµ([t, b)) + R=
[t,b)
dν bµ([t, ·)),
a ≤t ≤b.
(9.168)
To prove this theorem we use the following lemma, analogous to Lemma
9.72. The rest of the proof is similar to the proof of Theorem 9.71 and so is
omitted.
Lemma 9.74. Let a < b, let µ, ν ∈AIp([a, b]; B) for 1 ≤p < 2, and let γ be
the interval function on [a, b] deﬁned by
γ(A) :=
R
=
A
dν bµ([a, ·) ∩A),
A ∈I[a, b].
(9.169)
Then for each A ∈Db = {(t, b], [t, b): t ∈[a, b]},
γ(A) =
R
=
A
γ((·, b] ∩A)dµ + ν(A).
(9.170)

9.11 Linear Integral Equations
483
Proof. The interval function γ is well deﬁned by Proposition 9.55, with
(µ, ν, α) there equal to (0, ν, bµ) here, so that bµ ≡1 there. The rest of the
proof of the lemma is essentially symmetric to that of Lemma 9.72 and only a
few diﬀerences will be mentioned. Let B⌞be the set of all 2×2 matrices
  x 0
y z

with x, y, z ∈B. Deﬁne algebra operations in B⌞as for ordinary matrices,
analogously to those in B⌝. Deﬁning a norm as before, B⌞is a unital Banach
algebra. Let ξ :=
  µ 0
ν 0

. Then ξ ∈AIp([a, b]; B⌞). Also, for γ now deﬁned by
(9.169), let ˜ξ :=

bµ 0
γ 1I

another B⌞-valued interval function on [a, b]. Although
one cannot simply take transposes of matrices (see Remark 9.75), one can
show in analogy to the proof of (9.161) that
1I⌞+
R
=
Ac,t
dξ ˜ξ
 [c, ·) ∩Ac,t

= ˜ξ(Ac,t)
for each Ac,t = (c, t] with a ≤c < t ≤b. By the implication (b) ⇒(a)
of Corollary 9.67 applied to the B⌞-valued interval functions ξ and α = ˜ξ
restricted to [c, a], we have ˜ξ(Ac,t) = bξ(Ac,t) for each a ≤c < t ≤b. In
particular, ˜ξ(A) = bξ(A) for each A ∈Db. Now using implication (a) ⇒(b) of
Corollary 9.70, it follows that (9.170) holds for each A ∈Db, completing the
proof of the lemma.
2
Remark 9.75. The reader might have noted that as a set of matrices, B⌞as
in the last proof is the set of all transposes Ct of matrices C ∈B⌝in the proof
of Lemma 9.72, where Ct
ij
:=
Cji for all i, j. Unfortunately, however, the
relation (CD)t = DtCt, familiar for matrices with scalar elements and valid
if B is commutative, reverses the direction of multiplication and is not even
valid if B is not commutative unless one uses the reversed multiplication (∗-
multiplication) on one side. If B is commutative, even if B = K, two matrices
in B⌞(or two in B⌝) still do not commute in general.
The interval function ξ⌞:= ξ as deﬁned in the last proof is exactly the
transpose of ξ⌝= ξ as in the proof of Lemma 9.72. But γ⌞:= γ deﬁned by
(9.169) is not the same as γ⌝:= γ deﬁned by (9.158). So, ˜ξ deﬁned in the
proofs of Lemmas 9.72 and 9.74 are not actually transposes of each other.
Let 1 ≤p < 2, let a < b, and let B be a Banach algebra. By Theorem
9.71(a), for y ∈B and µ, ν ∈AIp([a, b]; B) ≡AIp, the forward inhomogeneous
linear integral equation (9.154) has a unique solution f3 ∈Wp([a, b]; B) ≡
Wp. Deﬁne the solution mapping S≻
[a,·) corresponding to the integral equation
(9.154) by
B × AIp × AIp ∋(y, µ, ν) 7→S≻
[a,·)(y, µ, ν) := f3 ∈Wp.
(9.171)
Likewise by Theorems 9.71(b) and 9.73, there exist solution mappings S≻
(a,·],
S≺
(·,b], and S≺
[·,b) corresponding to the integral equations (9.156), (9.165), and

484
9 Product Integration
(9.167), respectively. We show next that the four solution mappings are ana-
lytic.
Theorem 9.76. Let B be a Banach algebra, a < b, and 1 ≤p < 2. Then the
four solution mappings S≻
[a,·), S≻
(a,·], S≺
(·,b] and S≺
[·,b) corresponding to the inte-
gral equations (9.154), (9.156), (9.165) and (9.167), respectively, are uniformly
entire.
Proof. There are symmetric or similar proofs for each of the four mappings, so
a detailed proof will be given only for the mapping (9.171). At the end of the
proof we will indicate what changes are needed for the other three mappings.
By Theorem 5.38 it is enough to show that S≻
[a,·) is a composition of uni-
formly entire mappings. The product integral operator P deﬁned by (9.92) is
a uniformly entire mapping from AIp([a, b]; B) into Ip([a, b]; B) by Theorem
9.51.
The map β 7→β([a, ·)) is a bounded linear operator with norm 1 from
Ip([a, b]; B) into Wp([a, b]; B). For y ∈B and µ ∈AIp([a, b]; B) let
F1(y, µ) := bµ([a, ·))y.
(9.172)
Then F1 is uniformly entire from B × AIp([a, b]; B) into Wp([a, b]; B) by com-
position of uniformly entire functions, Theorem 5.38. F1 gives the ﬁrst term
on the right in (9.155). Most of the proof, to be done, will deal with the second
term.
Let ν ∈AIp([a, b]; B). For a B-valued interval function α on [a, b], let
χ(α, ν)(A) :=
R
=
A
α((·, b] ∩A) dν
(9.173)
provided the Kolmogorov integral is deﬁned for each interval A ⊂[a, b]. Thus
if deﬁned, χ := χ(α, ν) := {χ(α, ν)(A): A ∈I[a, b]} is a B-valued interval
function on [a, b]. The function t 7→χ(bµ, ν)([a, t)), t ∈[a, b], gives the second
term on the right in (9.155), and is the composition of the interval function
χ(bµ, ν) with the map t 7→[a, t) from [a, b] into I[a, b].
Remark 9.77. By the second part of Theorem 9.56, if α ∈I←
p then χ(α, ν) ∈
I←
p
and the map (α, ν) 7→χ(α, ν) is a bounded bilinear operator from I←
p ×
AIp into I←
p . By Proposition 9.55 with α ≡1I there, we have that χ(bµ, ν) ∈Ip.
But whether the map χ is deﬁned on Ip × AIp and if so, takes values in Ip
and is a bounded bilinear operator, is not obvious (to us) in general. We
will show (see (9.176) below) that there is a subspace Mp ⊂Ip such that χ
takes Mp × AIp into Ip. It turns out that bµ and its Taylor polynomials and
remainders, to be used in the proof, all are in Mp. On Mp we will have a norm
∥· ∥[p],W ≥∥· ∥[p].
For an interval function α on [a, b] and a nondegenerate interval J ⊂[a, b],
let Wp(α) ≡Wp(α; J), where

9.11 Linear Integral Equations
485
Wp(α) := sup

n
X
i=2
∥α((·, b] ∩
[
j≤i
Aj) −α((·, b] ∩
[
j≤i−1
Aj)∥pS
j≤i−1 Aj,[p]
1/p
,
the norm is for point functions restricted to S
j≤i−1 Aj in the ith term, and
the supremum is taken over A = {Ai}n
i=1 ∈IP (J). Then Wp(·) is a seminorm
and ∥· ∥←
J,[p] + Wp(·) is a norm. If α = bµ, using multiplicativity we have
Wp(bµ) = sup
A

n
X
i=2
∥[bµ(Ai) −1I]bµ((·, b] ∩
[
j≤i−1
Aj)∥pS
j≤i−1 Aj,[p]
1/p
≤sup
A

n
X
i=2
∥bµ(Ai) −1I∥p∥bµ((·, b] ∩
[
j≤i−1
Aj)∥pS
j≤i−1 Aj,[p]
1/p
≤sup
A

n
X
i=2
∥bµ(Ai) −1I∥p1/p
sup
A∈I(J)
∥bµ((·, b] ∩A)∥A,[p]
≤Vp(bµ) sup
A∈I(J)
∥bµ∥←
A,[p]
by deﬁnition of Vp(·), and by the ﬁrst inequality in (9.97). Therefore for each
nondegenerate J ⊂[a, b],
Wp(bµ; J) ≤Vp(bµ; J)∥bµ∥←
J,[p] ≤Vp(bµ; [a, b])∥bµ∥←
[p] < ∞
(9.174)
by (9.84).
For boundedness of χ into Ip we will show that for any α ∈Ip,
vp(χ; J)1/p ≤Kp∥α∥←
J,[p]∥ν∥(p) + KpWp(α; J)∥ν∥(p).
(9.175)
Indeed, let B1, B2 ∈I(J) be such that B1 ∪B2 ∈I(J) and B1 ≺B2. Then
χ(B1 ∪B2) −χ(B1) = χ(B2) +
R
=
B1

α((t, b] ∩(B1 ∪B2)) −α((t, b] ∩B1)

ν(dt).
This also holds when B1 = ∅. Taking B1 := S
j≤i−1 Aj, B2 := Ai, and using
the Minkowski inequality, we have since χ(∅) = 0,
sp(χ; A)1/p ≤Vp(χ)+

n
X
i=2

R=
B1

α((·, b]∩(B1 ∪B2))−α((·, b]∩B1)

dν

p1/p
.
Then we apply Proposition 9.57 to the ﬁrst term on the right side. To bound
the second term, for i = 2, . . . , n, by the Love–Young inequality (9.78) with
q = p, f(t) := α((t, b] ∩(B1 ∪B2)) −α((t, b] ∩B1), g ≡1I, B := B1 =
S
j≤i−1 Aj ∈I[a, b], and ν in place of µ, we have

R=
B1

α((·, b] ∩(B1 ∪B2)) −α((·, b] ∩B1)

dν

≤Kp∥α((·, b] ∩(B1 ∪B2)) −α((·, b] ∩B1)∥B1,[p]∥ν∥(p).

486
9 Product Integration
Then taking pth powers and summing over i = 2, . . . , n, we have

n
X
i=2

R
=
B1

α((·, b] ∩(B1 ∪B2)) −α((·, b] ∩B1)

dν

p1/p
≤Kp

n
X
i=2
α((·, b] ∩(B1 ∪B2)) −α((·, b] ∩B1)
p
B1,[p]
1/p
∥ν∥(p)
≤KpWp(α; J)∥ν∥(p),
and (9.175) follows.
Let Wp(α; ∅) := 0. Since ∥χ∥sup ≤Vp(χ), by (9.175) we have
∥χ∥[p] ≤Kp

2∥α∥[p] +
sup
A∈I[a,b]
Wp(α; A)

∥ν∥(p).
(9.176)
For an interval function α let
∥α∥[p],W := ∥α∥[p] +
sup
A∈I[a,b]
Wp(α; A) ≤+∞
and let Mp := {α ∈Ip([a, b]; B): ∥α∥[p],W < ∞}. Then ∥· ∥[p],W is a norm
on Mp and (α, ν) 7→χ(α, ν) is bounded and bilinear from Mp × AIp into Ip.
Also, by (9.174) we have bµ ∈Mp.
Let AIp := AIp([a, b]; B) and likewise for Ip and Ip. We will show that
(µ, ν) 7→χ(bµ, ν) is uniformly entire from AIp × AIp into Ip. We will ﬁnd a
Taylor expansion for (µ, ν) 7→χ(bµ, ν) around (0, 0). The following lemma will
provide individual terms in the expansion. Recall the notation Qk
0 deﬁned by
(9.93) with Q0
0 := 1I.
Lemma 9.78. Let 1 ≤p < 2. For each integer k ≥1,
(a) the mapping χ(k) deﬁned by χ(k)(µ, ν) := χ(Qk
0(µ), ν) is a (k + 1)-
homogeneous polynomial from AIp × AIp into Ip;
(b) for each ν ∈AIp, µ 7→χ(k)(µ, ν) is a k-homogeneous polynomial from
AIp into Ip;
(c) for all µ and ν in AIp, and all k ≥1,
∥χ(k)(µ, ν)∥[p] ≤3K4
p(k7 + 3)(4eCp)kk!−1/p∥µ∥k
[p]∥ν∥(p),
where Kp = 1 + ζ(2/p) and Cp = 1 + 41/pζ(2/p);
(d) for each µ ∈AIp, ν 7→χ(k)(µ, ν) is a bounded linear operator (homoge-
neous polynomial of degree 1) from AIp into Ip.
Proof. First, (b) and (c) will be proved. For k ≥1 and ν1, . . . , νk ∈AIp, let
Lk,sym
µ
(ν1, . . . , νk) be deﬁned by (9.109) and (9.129) and let
M k
ν (ν1, . . . , νk) := χ(Lk,sym
0
(ν1, . . . , νk), ν) = 1
k!
X
π
χ(Lk
0(νπ(1), . . . , νπ(k)), ν).

9.11 Linear Integral Equations
487
The mapping M k
ν is k-linear and symmetric. It satisﬁes χ(Qk
0(µ), ν) =
M k
ν (µ, . . . , µ). We will prove that M k
ν is a mapping from the k-fold product
(AIp)k into Ip.
Let k ≥1, ν1, . . . , νk ∈AIp, Lk := Lk
0(ν1, . . . , νk), B1, B2 ∈I[a, b], B1 ∪
B2 ∈I[a, b], and B1 ≺B2. By (9.115) with n = k, and since L0
0 ≡1I, we have
Lk(B1 ∪B2) −Lk(B1) =
k
X
l=1
Ll
0(ν2)(B2)Lk−l
0
(ν1)(B1),
(9.177)
where ν2 := (νk−l+1, . . . , νk) and ν1 := (ν1, . . . , νk−l). Let A ∈I[a, b]. Let
A = {Ai}n
i=1 ∈IP (A), B1 = ∪j<iAj, and B2 = Ai. Also, for each x ∈B1 let
Br,x := Br ∩(x, b] for r = 1, 2 and note that (9.177) holds for Br,x in place of
Br, since its hypotheses do. By the Minkowski inequality (1.5), it follows that
Wp(Lk; A) ≤
k
X
l=1
sup
A

n
X
i=2
Ll
0(ν2)(Ai)Lk−l
0
(ν1)((·, b] ∩B1)
p
B1,[p]
1/p
≤
k
X
l=1
Vp(Ll
0(ν2))
sup
B∈I(A)
∥Lk−l
0
(ν1)((·, b] ∩B)∥B,[p]
≤
k
X
l=1
Vp(Ll
0(νk−l+1, . . . , νk))∥Lk−l
0
(ν1, . . . , νk−l)∥←
[p]
by (9.96). Therefore we have
sup
A∈I[a,b]
Wp(Lk; A)≤
k
X
l=1
Vp(Ll
0(νk−l+1, . . . , νk))∥Lk−l
0
(ν1, . . . , νk−l)∥←
[p].
(9.178)
The bound (9.137) for ∥Qk
0∥gives via Theorem 5.7 for the norm of a k-linear
operator, into Ip([a, b]; B) in this case, and then Stirling’s formula that for all
k = 0, 1, . . .,
∥Lk
0∥≤(k3 + 1)Kp(2kCp)k
k!(p+1)/p
≤Kp(k3 + 1)(2eCp)k
k!1/p
.
(9.179)
To bound Vp(Lk) for k ≥1, (9.112) gives in this case
Vp(Lk) ≤Kp∥Lk−1∥[p]∥νk∥(p) ≤K2
p(k3 + 1)(2eCp)k
k!1/p
k
Y
i=1
∥νi∥(p).
(9.180)
Using (9.176) and (9.178), then (9.179) and (9.180), it follows that
∥χ(Lk, ν)∥[p] ≤Kp
"
2∥Lk∥[p] +
sup
A∈I[a,b]
Wp(Lk; A)
#
∥ν∥(p)
≤Kp
h
2∥Lk∥[p] + Vp(Lk) +
k−1
X
l=1
Vp(Ll
0(ν2))∥Lk−l
0
(ν1)∥←
[p]
i
∥ν∥(p).

488
9 Product Integration
Now by (9.180) applied to l in place of k and to ν2, we have
Vp(Ll
0(ν2)) ≤K2
p(l3 + 1)(2eCp)l∥νk−l+1∥[p] · · · ∥νk∥[p]/l!1/p,
and from (9.179) applied to k −l in place of k and to ν1, we get
∥Lk−l
0
(ν1)∥[p] ≤Kp((k −l)3 + 1)(2eCp)k−l∥ν1∥[p] · · · ∥νk−l∥[p]/(k −l)!1/p.
For each l we have 1/(l!(k −l)!)1/p ≤2k/p/k!1/p. It can be veriﬁed that
for k > 0, f(x) := (x3 + 1)((k −x)3 + 1) has f(0) = f(k) = k3 + 1 and
f ′(x) = 3(k −2x)[x2(k −x)2 −k], so f ′(0) = −3k2 = −f ′(k). For k ≥3, f ′
has three simple zeros in (0, k) of which the outer two are relative minima
and x = k/2 is a relative maximum. It is the absolute maximum on [0, k] for
k ≥4, and then
k−1
X
l=1
(l3 + 1)((k −l)3 + 1) ≤k
 k
2
3
+ 1
!2
.
(9.181)
One can verify directly that the same bound holds for k = 1 and 2. For k = 3
it holds with a further factor of 3 on the right. From this and last four displays
it follows that for k ≥1
∥χ(Lk, ν)∥[p] ≤K4
p(2eCp)kk!−1/p∥ν∥(p)∥ν1∥[p] · · · ∥νk∥[p] ×
×

2(k3 + 1) + (k3 + 1) + 3k2k/p
(k
2
3
+ 1
)2
.
Routine calculations show that the quantity in square brackets is bounded
above by 3k72k for k ≥4 (it is quite easy to see that it is no larger in order
of magnitude) and by 3(k7 + 3)2k for all k ≥1. Thus for all k ≥1,
∥M k
ν (ν1, . . . , νk)∥[p] ≤1
k!
X
π
∥χ(Lk
0(νπ(1), . . . , νπ(k)), ν)∥[p]
≤3K4
p(k7 + 3)(4eCp)kk!−1/p∥ν∥(p)∥ν1∥[p] · · · ∥νk∥[p].
Therefore the mapping M k
ν takes the k-fold product (AIp)k into Ip. Thus (b)
and (c) follow, taking ν1 = · · · = νk = µ.
Clearly ν 7→M k
ν (ν1, . . . , νk) is linear for ﬁxed ν1, . . . , νk. For µj and νj ∈
AIp, j = 0, 1, . . . , k, let ν := µ0 and
Y k+1((µ0, ν0), (µ1, ν1), . . . , (µk, νk)) := M k
ν (ν1, . . . , νk).
Inequality (c) implies that Y k+1 is a bounded (k +1)-linear map from (AIp ×
AIp)k+1 into Ip. It follows that
(µ, ν) 7→χ(Qk
0(µ), ν) = Y k+1(ν, µ)⊗(k+1)

9.11 Linear Integral Equations
489
is a (k + 1)-homogeneous polynomial, so (a) holds. It follows that (d) also
holds, so the lemma is proved.
2
Let 1 ≤p < 2 and µ, ν ∈AIp([a, b]; B). Recall the notation γn deﬁned by
(9.113). We have for each n = 0, 1, . . . by Theorem 9.51,
bµ = γn(0, µ) +
n
X
k=0
Qk
0(µ),
where each term is in Ip. For ﬁxed µ, the mapping ν 7→χ(bµ, ν) is linear since
the Kolmogorov integral is linear with respect to an integrator, and bounded
from AIp into Ip by (9.176) with α = bµ and (9.174).
By Lemma 9.78, χ(Qk
0(µ), ν) is deﬁned for each k. Then by bilinearity of
the Kolmogorov integral and induction, for each integer n ≥1 we have
χ(bµ, ν) =
n
X
k=0
χ(Qk
0(µ), ν) + Rn(µ, ν),
(9.182)
where
Rn(µ, ν) = χ(γn(0, µ), ν).
(9.183)
We need to ﬁnd a suitable bound for ∥Rn(µ, ν)∥[p].
For µ ∈AIp, recall K(µ, p) deﬁned by (9.29), which is easily seen to
be bounded if ∥µ∥[p] is bounded (although it grows rapidly as ∥µ∥[p] be-
comes large). We have K(µ, p) ≥1 for all µ. Also recall Cp as deﬁned
just after (9.28). By Theorem 9.36 we have ∥bµ∥sup ≤K(µ, p) and ∥bµ∥(p) ≤
CpK(µ, p)∥bµ∥sup∥µ∥(p). It follows that
∥bµ∥[p] ≤N(µ, p) := K(µ, p)[1 + CpK(µ, p)∥µ∥(p)],
(9.184)
which clearly also remains bounded for ∥µ∥[p] bounded. Also, N(µ, p) ≥1 for
1 ≤p < 2 and any µ.
Lemma 9.79. Let µ, ν ∈AIp([a, b]; B), 1 ≤p < 2. There exists n0 = n0(µ, p)
depending only on µ and p such that for each integer n ≥1 and γn := γn(0, µ),
∥χ(γn, ν)∥[p] ≤B(n, µ, ν, p) := 4n0K4
p∥ν∥(p)[(n + n0)3 + 1]2 ×
(9.185)
×{2eCp(1 + |µ∥[p])}n+n0
1
n!1/p
h
1 + N(µ, p) + n2(n+1)/pi
.
Proof. Let n ≥1. By (9.176) with α = γn, we have
∥χ(γn, ν)∥[p] ≤Kp
"
2∥γn∥[p] +
sup
A∈I[a,b]
Wp(γn; A)
#
∥ν∥(p).
(9.186)
By Theorem 9.51 we have

490
9 Product Integration
γn = γn(0, µ) ≡
∞
X
k=n+1
Qk
0(µ),
(9.187)
where the sum converges in Ip. From (9.137) we get for all k ≥0,
∥Qk
0(µ)∥[p] ≤Tk := Tk(µ, p) := (k3 + 1)Kp(2Cp∥µ∥[p])k/k!1/p.
(9.188)
It is easy to check that (k + 1)3 + 1 ≤2k3 for all k ≥4. Recall that ⌊x⌋is the
largest integer ≤x and that N(µ, p) ≥1. For each k ≥4 we have
Tk+1/Tk ≤4Cp∥µ∥[p]/(k + 1)1/p,
which is ≤1/2 if k ≥n0 deﬁned by
n0 := n0(µ, p) := ⌊max{3 + N(µ, p), (8Cp∥µ∥[p])p}⌋≥4,
(9.189)
where the N(µ, p) is included for later convenience. If n ≥n0(µ, p) it then
follows via domination by a geometric series with ratio 1/2 and (9.188) that
for n ≥n0(µ, p),
∥γn(0, µ)∥[p] ≤2Tn+1 = 2Kp((n + 1)3 + 1)(2Cp∥µ∥[p])n+1
(n + 1)!1/p
.
(9.190)
Suppose on the other hand that 1 ≤n < n0 = n0(µ, p). Let
Sn := Sn(µ, p) :=
n0
X
k=n+1
Tk.
In this sum the number of terms is at most n0 and each term, bounding each
factor separately, satisﬁes
Tk ≤Kp(n3
0 + 1)

2Cp(1 + ∥µ∥[p])
n0 /(n + 1)!1/p,
n < k ≤n0.
Thus Sn is bounded above by n0 times the latter bound. Further, applying
(9.190) with n there replaced by n0, for which it holds, we get that if 0 ≤n <
n0 then
∥γn∥[p] ≤Sn + 2Tn0+1
≤n0Kp(n3
0 + 1)

2Cp(1 + ∥µ∥[p])
n0
(n + 1)!1/p
+ 2Kp
 (n0 + 1)3 + 1

[2Cp∥µ∥[p]]n0+1
(n0 + 1)!1/p
≤(n0 + 1)Kp((n0 + 1)3 + 1)

2Cp(1 + ∥µ∥[p])
n0+1/(n + 1)!1/p,
since n0 > 1. Combining with (9.190) gives for all n ≥1,
∥γn(0, µ)∥[p] ≤2n0Kp((n + n0)3 + 1)[2Cp(1 + ∥µ∥[p])]n+n0/(n + 1)!1/p.
(9.191)

9.11 Linear Integral Equations
491
By Lemma 9.59 with µ = 0 there, and ν there equal to µ here, we have for
all A ∈I[a, b] and n ≥1,
γn(A) =
R
=
A
µ(ds)γn−1([a, s) ∩A).
It follows from Proposition 9.57 that for all n ≥2,
Vp(γn) ≤Kp∥µ∥(p)∥γn−1(0, µ)∥[p]
and thus that
Vp(γn) ≤2n0K2
p((n + n0)3 + 1)[2Cp(1 + ∥µ∥[p])]n+n0/n!1/p.
(9.192)
To bound Wp(γn; A), let A ∈I[a, b] and A = {Ai}m
i=1 ∈IP (A). For
B1 := S
j<i Aj and B2 := Ai, by (9.116), we have
γn(B1 ∪B2) −γn(B1) = γn(B2)bµ(B1) +
n
X
k=1
Qk(B2)γn−k(B1),
(9.193)
where Qk := Qk
0(µ). As in the last proof, for each x ∈B1 let Br,x := Br∩(x, b]
for r = 1, 2 and note that (9.193) holds for Br,x in place of Br, since its
hypotheses do, with B2,x ≡B2 = Ai. Thus by the Minkowski inequality (1.5)
and then by (9.96), it follows that
Wp(γn; A) ≤sup
A
 m
X
i=2
∥γn(Ai)∥p1/p
sup
B∈I(A)
∥bµ((·, b] ∩B)∥B,[p]
+
n
X
k=1
sup
A
 m
X
i=2
∥Qk(Ai)∥p1/p
sup
B∈I(A)
∥γn−k((·, b] ∩B)∥B,[p]
≤Vp(γn)∥bµ∥←
[p] +
n
X
k=1
Vp(Qk)∥γn−k∥←
[p].
Inserting this bound into (9.186), we have
∥χ(γn, ν)∥[p] ≤Kp
h
2∥γn∥[p] + Vp(γn)∥bµ∥←
[p] +
n
X
k=1
Vp(Qk)∥γn−k∥←
[p]
i
∥ν∥(p).
(9.194)
We bound Vp(Qk) by (9.180), which gives
Vp(Qk) ≤K2
p(k3 + 1)(2eCp)k∥µ∥k
[p]/k!1/p.
(9.195)
We can bound ∥γn−k∥←
[p] by (9.191) with n −k in place of n for k < n, giving
∥γn−k∥[p] ≤2n0Kp((n −k + n0)3 + 1)[2Cp(1 + ∥µ∥[p])]n−k+n0
(n −k + 1)!1/p
.
(9.196)

492
9 Product Integration
For k = n, we get
∥γ0∥[p] = ∥bµ −1I∥[p] ≤∥bµ∥[p] + 1 ≤N(µ, p) + 1 ≤n0(µ, p)
by (9.184) and the deﬁnition (9.189) of n0. Thus (9.196) holds for k = n also
and so for all k = 1, . . . , n.
As in previous proofs we have 1/(k!(n −k + 1)!)1/p ≤2(n+1)/p/(n + 1)!1/p.
Thus the sum in (9.194) is bounded above by
2n0K3
p(2eCp{1 + ∥µ∥[p]})n+n02(n+1)/pn!−1/p
n
X
k=1
(k3 + 1)((n + n0 −k)3 + 1).
(9.197)
As in (9.181) and since n0 ≥4, the sum in (9.197) is bounded above by
n[{(n + n0)/2}3 + 1]2
(9.198)
for all n ≥1. Inserting (9.198) in place of the sum in (9.197) and then (9.184),
(9.197), and (9.192) into (9.194) gives for n ≥1, ∥χ(γn, ν)∥[p] ≤B(n, µ, ν, p) as
deﬁned in (9.185). Thus (9.185) is proved. The proof of the lemma is complete.
2
It follows from Lemma 9.79 that for each µ, ν ∈AIp and B(n, µ, ν, p) as
deﬁned in (9.185), as n →∞,
B(n + 1, µ, ν, p)
B(n, µ, ν, p)
∼2(p+1)/peCp{1 + ∥µ∥[p]}
(n + 1)1/p
→0.
Thus for any µ, ν ∈AIp, ∥χ(γn, ν)∥[p] →0 as n →∞. From this, (9.182),
and (9.183) it follows that
χ(bµ, ν) = ν +
∞
X
k=1
χ(Qk
0(µ), ν),
(9.199)
where the series converges absolutely in Ip for all µ and ν in AIp and uni-
formly for ∥µ∥[p] and ∥ν∥[p] bounded. By Lemma 9.78, it is the Taylor expan-
sion around (0, 0) of the mapping (µ, ν) 7→χ(bµ, ν) from AIp × AIp into Ip.
By the Cauchy–Hadamard formula (Theorem 5.10), it has inﬁnite radius of
uniform convergence, and so by Theorem 5.21 and in light of Lemma 9.78 the
function (µ, ν) 7→χ(bµ, ν) is uniformly entire from AIp × AIp into Ip.
From this and composition of uniformly entire functions (Theorem 5.38),
taking χ(bµ, ν), then the bounded linear operator χ 7→χ([a, t)) from Ip into
Wp, we get that the second term in (9.155) is a uniformly entire function
of (µ, ν). The ﬁrst term, in other words F1(y, µ) as deﬁned in (9.172), was
seen there to be a uniformly entire function of (y, µ). Since the sum of two

9.11 Linear Integral Equations
493
uniformly entire functions of (y, µ, ν) is uniformly entire, the conclusion of the
theorem for the solution (9.155) of the forward equation (9.154) follows.
The other forward equation (9.156) has a solution given by (9.157). To
adapt the proof to that case we need to replace [a, ·) by (a, ·] in (9.172) and
[a, t) by (a, t] in the preceding paragraph.
To prove that the solution mapping
B × AIp × AIp ∋(y, µ, ν) 7→S≺
(·,b](y, µ, ν) := g3 ∈Wp
corresponding to the backward integral equation (9.165), and given by (9.166),
is uniformly entire we make the following changes. Let ν ∈AIp([a, b]; B). For
an interval function α on [a, b], let χ←(ν, α)(A) := R=A dν α([a, ·)∩A) provided
the Kolmogorov integral is deﬁned for each subinterval A ⊂[a, b]. Then if
deﬁned, χ←≡χ←(ν, α) = {χ←(ν, α)(A): A ∈I[a, b]} is an interval function
on [a, b]. The function t 7→χ←(ν, bµ)((t, b]), t ∈[a, b], gives the second term on
the right in (9.166), and is the composition of the interval function χ←(ν, bµ)
with the map t 7→(t, b] from [a, b] into I[a, b]. Here the map β 7→β((·, b]) is
a bounded linear operator with norm 1 from I←
p ([a, b]; B) into Wp([a, b]; B).
Since the product integral operator is uniformly entire from AIp into I←
p , the
function (y, µ) 7→ybµ((·, b]) is uniformly entire from B×AIp into Wp, and this
gives the ﬁrst term on the right in (9.166). To prove that the second term on
the right in (9.166) is uniformly entire it is enough to show that the function
(µ, ν) 7→χ←(ν, bµ) is uniformly entire from AIp × AIp into I←
p .
For an interval function α on [a, b] and a nondegenerate interval J ⊂[a, b],
let W ←
p (α) ≡W ←
p (α; J), where
W ←
p (α) := sup
A
 n−1
X
i=1
∥α([a, ·) ∩
[
j≥i
Aj) −α([a, ·) ∩
[
j≥i+1
Aj)∥pS
j≥i+1 Aj,[p]
1/p
,
the norm is for point functions restricted to S
j≥i+1 Aj in the ith term, and
the supremum is taken over A = {Ai}n
i=1 ∈IP (J). Let W ←
p (ν, α)(∅) := 0.
Then as for (9.176), we obtain the bound
∥χ←(ν, α)∥←
[p] ≤Kp
h
2∥α∥[p] +
sup
J∈I[a,b]
W ←
p (α; J)
i
∥ν∥(p).
(9.200)
For an interval function α let
∥α∥←
[p],W := ∥α∥[p] +
sup
J∈I[a,b]
W ←
p (α; J) ≤+∞
and let M ←
p
:= {α ∈Ip([a, b]; B): ∥α∥←
[p],W < ∞}. Then ∥·∥←
[p],W is a norm on
M ←
p
and (ν, α) 7→χ←(ν, α) is bounded and bilinear from M ←
p ×AIp into I←
p .
As in Lemma 9.78 we obtain that the mapping χ←
(k) deﬁned by χ←
(k)(µ, ν) :=
χ←(ν, Qk
0(µ)) is a (k + 1)-homogeneous polynomial from AIp × AIp into I←
p

494 
9 Product Integration 
and the bound in Lemma 9.78(c) holds when X(k) is replaced by XCk)' As for 
(9.182), we have 
n 
X+-(v,/L) = Lx+-(v,Q~(p)) + X+-(v, 'Yn(O, p)) 
k=O 
for each n ;::: 1. We show that IIx+-(v, 'Yn(O, p))II[;) tends to zero as n ---+ 00 
rapidly enough as in Lemma 9.79 except that now we use the bound (9.200) 
instead of (9.176). Then it follows that the function (p,v) 1-+ X+-(v,/L) is 
uniformly entire from AIp x AIp into Z; as desired. 
For the other backward equation (9.167) with solution (9.168) we replace 
(t, b] by It, b) and (., b] by [', b) in the above proof. The proof of the theorem 
is complete. 
0 
9.12 Integral Equations for Banach-Space-Valued 
Functions 
If B2 is a Banach algebra and a subset B1 C ~ is also a Banach algebra, with 
the same algebra operations and norm, then B1 will be called a Banach sub-
algebra of B2. Let Y be a Banach space and let By := L(Y, Y) be the Banach 
algebra of all bounded linear operators from Y into itself, as in Example 4.10. 
Let B be a Banach subalgebra of By. Let p be a B-valued additive interval 
function on [a, b] and let y E Y. We will show that the linear integral equation 
for an unknown function 4>: [a, b] ---+ Y, 
4>(t) = y + =.f dp 4>, 
[a,t) 
a:::; t :::; b, 
(9.201) 
can be solved for ¢ given y and p E AIp([a, b]; B), 1 :::; p < 2, using the results 
of the preceding section. 
By Theorem 9.66 with y = n there, the linear integral equation (9.143) has 
the solution fI(t) = /L([a,t)), t E [a,b], unique in Wq([a,b];By) for q E Up. It 
follows that ¢(t) = fI(t)y gives a solution of (9.201). 
Corollary 9.80. Let Y be a Banach space, let B be a Banach subalgebra of 
By, let p E AIp([a,b];B) for 1 :::; p < 2, and let y E Y. Then the following 
two statements hold: 
(a) The integral equation 
4>(t) = Y + =.f dp 4>, 
[a,t) 
a:::; t :::; b, 
(9.202) 
has the solution ¢(1)(t) = /L([a,t))y for a:::; t :::; b, 4>(1) E Wp([a,b];B), 
and ¢(1) is the unique solution in Wq ([a, b]; B) for q E Up. 

9.12 Integral Equations for Banach-Space-Valued Functions 
495 
( b ) The integral equation 
1>(t) = y + j dl-l1>-, 
(a,t) 
a ~ t ~ b, 
(9.203) 
has the solution <P(2)(t) = ,:t«a,t])y for a ~ t :5 b, <P(2) E Wp([a,b);B), 
and <P(2) is the unique solution in Wq ([a, b); B) for q E Up. 
We already have shown the existence of a solution of the integral equation 
(9.202). Likewise we get a solution of (9.203). The uniqueness statements can 
be proved as in the proof of Theorem 9.66(a) except that here instead of 
Lemma 9.65 we use the following analogue under the present assumptions. 
Lemma 9.81. Let Y be a Banach space and let:8 be a Banach subalgebra of 
By. Let I-l E AIp([a, b);:8) for 1 :5 p < 2, and let q E Up. If 9 E W q ( [a, b); Y) 
and eitherg(t) = j(a,t)dl-lg fora:5 t:5 b, org(t) = j(a,t)dl-lg- fora:5 t:5 b, 
then 9 = 
0 on [a, b). 
We omit the proof of this lemma because it is the same as the proof of 
Lemma 9.65. 
The next statement gives solutions of some forward inhomogeneous linear 
integral equations. The given functions <P3 and <P4 are solutions by way of 
Theorem 9.71, and the uniqueness statements follow from Lemma 9.81. 
Corollary 9.82. Let Y be a Banach space, let :8 be a Banach subalgebra of 
By, let v E AIp([a,bj;Y), let I-l E AIp([a,b);B) for 1:5 p < 2, and let y E Y. 
Then the following two statements hold: 
(a) The integral equation 
1>(t)=y+ j dl-l<p+v{[a,t», 
[a,t) 
a:5 t :5 b, 
(9.204) 
has the solution <P3, in Wp{[a, bj; Y) and unique in Wq{[a, b); Y) for q E Up, 
where 
1>3{t) := ,:t{[a, t»y + j ,:t«., t» dv, 
[a,t) 
(b) The integral equation 
<p{t) = Y + 1= dl-l<p- + v({a, tj), 
(a,tj 
a :5 t :5 b. 
(9.205) 
a:5 t :5 b, 
has the solution <P4, in Wp{[a, bj; Y) and unique in Wq([a, bj; Y) for q E Up, 
where 
<P4{t) := ,:t({a, t])y + 1= ,:t({., t]) dv, 
(a,tj 
a ~ t ~ b. 

496 
9 Product Integration 
Example 9.83. Suppose the hypotheses of the preceding corollary hold with 
B = By and that for any two intervals A, B C [a, bJ, J.L(A)J.L(B) = J.L(B)J.L(A). 
Let S be the range of J.L in By. There is a smallest algebra A. including S, 
namely the set of all finite linear combinations of finite products of elements 
of S, and A. is commutative. The closure B of A. in By is a commutative Banach 
subalgebra of By, and we can apply the Corollary to B. If J.L( {t}) :j; -li for all 
t E [a, b) then ji has an explicit form given by Theorem 9.40. 
Linear differential equations. 
Let Y be a Banach space, and again let By := L(Y, Y) be the Banach algebra 
of all bounded linear operators from Y into itself. By analogy with stochastic 
differential equations (e.g. [108)), if J.L E AIp([a, b);By ) and II E AIp([a, b); Y) 
with 1 :::; p < 2, we will say that the formal linear differential equation 
(9.206) 
holds on [a, b), where </J: [a, b) -+ Y, if and only if the integral equation (9.204) 
holds for a :::; t :::; b with y := </J(a). For any y E Y, such an equation has a 
solution </J = </J3 with ¢(a) = y, unique in Wq for q E Up, given by (9.205), 
where ji: 3[a,b)-+ By. 
Let.>. be Lebesgue measure, g(.) E £l([a, b), '>';By), and hE £l([a, b),.>.; V). 
We will say that the linear differential equation 
d</J 
-
=g</J+ h 
dt 
(9.207) 
holds on [a, b) if </J is continuous from [a, b) into Y, g</J + h E £1 ([a, b),'>'; V), 
d</J(t)/dt exists in Y for .>.-almost all t E (a, b), and we have the Bochner 
integrals 
</J(t) - ¢(a) = (Bo) f 
(g</J + h) d.>., 
i[a,ti 
for a :::; t :::; b. 
(9.208) 
The (a) continuity of </J and (b) existence of d</J(t)/dt equal to g</J + h for .>.-
almost all t actually follow from the other assumptions, (a) from dominated 
convergence for Bochner integrals, and (b) by an extension of a theorem of 
Lebesgue to Banach-valued functions, given as Theorem 2.35. 
Theorem 9.84. Under the hypotheses of (9.207) and (9.208), let 
J.L(A) := I(g)(A) := (Bo) f g(s) d.>.(s), 
v(A):= I(h)(A) := (Bo) f h(s) d.>.(s) 
A 
A 
for each A E 3[a,b). Then J.L E AIl([a,b);By) and v E AIl([a,b);Y). For any 
y E Y, the solution </J3 of (9.204) given by Corollary 9.82 is also a solution 
of (9.207), in other words of (9.208), with </J3(a) = y, and is the unique 
continuous solution </J with </J(a) = y. 

9.12 Integral Equations for Banach-Space-Valued Functions 
497 
The mapping tP3 defined by tP3(y, g, h) := 4>3(-) is a uniformly entire func-
tionfrom the Banach space Yx .c1([a, bl, ),;By) x .c1([a, bl,),; Y) with the norm 
II(y, g, h)11 := lIyll + IIglh + Ilhlh into C([a, bl; Y) with the sup norm. 
Remark 9.85. The existence of a solution of a first-order linear differen-
tial equation with Bochner integrable coefficients (9.207) is known, see e.g. 
DaleckiYand KreYn [35, §3.1j. It is solved via a corresponding integral equa-
tion [35, (3.1.2)1, i.e. (9.208) above. In [35, (3.1.6)1 the solution (of a somewhat 
more general integral equation) is written in the form of a Peano series similar 
to that in Corollary 9.52, but in a form adapted to solving inhomogeneous 
equations. After the proof, DaleckiYand Krein's form of the solution will be 
given and compared with ours. 
Proof By Proposition 2.33, J.L and v are well-defined additive interval func-
tions satisfying 
IIJ.L(A) II S; i Ilg(s)lIds and IIv(A)1I S; i IIh(s)lIds 
(9.209) 
for all A E J[a, bl. It follows that J.L E AI1([a, bj;By) and v E AI1([a, bj; Y). 
So J.L and v satisfy the hypotheses of Corollary 9.82 for p = 1. Thus there is a 
unique function </>3 E Woo ([a, b]; Y), in other words a regulated function into 
Y, satisfying (9.204). Then 4>J(a) = y. Also, 4>3 is actually continuous in light 
of (9.209). To show that 4>3 satisfies (9.208), for each t E [a, bj, we have 
(Bo) r (g</>3 + h)d)' = (Bo) r g</>3d)' + (Bo) r hd)' 
i[a,tj 
i(a,tj 
J[a,tj 
where the Bochner integrals all exist since </>3 is bounded and measurable into 
Y and both 9 and h, thus g</>3, are Bochner integrable. We have v([a, t)) = 
(Bo) f[a,tl hdA by definition of v and since A( {t}) = O. By (9.204), it will suffice 
to show that for each t E [a, bj, 
=f= dJ.L</>3 = (Bo) r g4>3dA. 
[a,t) 
i[a,tj 
(9.210) 
Let ({Aj }J=1,{tj}j=d be any tagged interval partition of [a,bj. Then if </>3 
is replaced in (9.210) by the function 'I/J := L~=11Aj()</>3(tj), the resulting 
equation holds since we get equal jth terms (Bo) fA. g(s)dA(s) </>3 (tj) on both 
J 
sides by definition of J.L. Now, </>3, being continuous, can be approximated 
arbitrarily closely in the sup norm by a sequence of such functions 'I/J = 'l/Jn, 
letting the mesh of {Aj }J=l approach O. The integrals on each side with 'l/Jn 
converge to those for 4>3, on the left side by a Love-Young inequality for 
p = 1 and q = 00, Proposition 3.96, so (9.210) holds. Here d4>3(t)/dt exists 
for A-almost all t E (a, b) by Theorem 2.35. 
To prove the uniqueness for given </>(a), let 4> be any continuous solution 
of (9.207), in other words of (9.208) for the same y = 4>(a) = 4>3(a). Then for 

498 
9 Product Integration 
~ := <P - <P3, we have ~(t) = (Bo) Ila,t] g~ d,X, a::; t ::; b. Given 0 < € < 1 there 
exists ad> 0 such that i[a,a+<5)llg I d,X < €. Let s := sUPa9~a+<5I1~(t)lI. Then 
s ::; €s, and so s = O. Since ~ is continuous it follows that ~ == 0 on [a, a + d). 
Iterating this argument as in the proof of Lemma 9.65, it follows that ~ == 0 
on [a, b), and hence <P3 is the unique solution of (9.207). 
As to analyticity, the maps 1: 9 ~ 1(g) = J-l and 1: h ~ 1(h) = v are 
bounded linear operators (with norm 2), thus uniformly entire. Via Theorem 
9.76 and composition with the maps 1(·), using Theorem 5.38, we get that 4>3 
is uniformly entire. This completes the proof of the theorem. 
0 
To compare the solution as given by Daleckii and Krein [35, (3.1.6») with 
ours, for each t E J := [a, b), 9 E £1 (J; By) == £1 (J,'x; By), h E £1 (J; Y) == 
£[(J,'x; Y), and k ~ 1, let 
and 
Vk(t) := Vk(g, h)(t) := it itk .. ·itl 9(tk) ... g(tdh(u) du dtl ... dtk, 
where we write I: instead of (Bo)f[a,s)' Let Uo(t) := Uo(g, y)(t) == y and 
Vo(t) := Vo(g, h)(t) := J; h(u) duo If F(t) = I! v(u) du where v is Bochner 
integrable then F E WI with IIFII[L] ::; 2l1vlh. As in [35, (3.1.5), (3.1.7») we 
have for k ~ 2 and a ::; tk ::; t, 
ltk .. 'l
tt Ilg(tk-dll .. 'lIg(tl)lIllh(u)11 dudtl" ·dtk-l ::; Mk 
where Nh := IIhlll (J! IIg(u)11 du)k-l I(k -1)L It follows that 
IlVdg,h)li[l] ::; 21lglbl\!h ::; 2l1gl17l1 hlh/(k - I)L 
(9.211) 
The same bound holds for the k = 1 term. Similarly, IlUk(g, y)II[[] ::; 
211g11TIIYII/(k - I)! for each k ~ 1. For k = 0 we have IlUo(g,y)ll[l] = Ilyll 
and IlVo(g, h)II[I] ::; 211hlh- It then follows that for each k, Vk (,,·) is a 
(k + I)-homogeneous polynomial from £l(J;By) x £l(J;Y) into W1(J;Y), 
and Uk(-,') is a (k + I)-homogeneous polynomial from £l(J;By) x Y into 
W1(J;Y). 
Let R[,R2,R3 be any three numbers with 0 < Rj < 00. If IIglll ::; R[, 
Ilhlll ::; R2 and Ilyll ::; R3, then from (9.211), IlVk(g, h)lI[l] ::; 2R~'R2/(k - I)L 
Likewise, IlUdg,y)lI[l] ::; 2R~'R3/(k -I)!, and so 
00 L IlUk(9, y)lI[l) + IlVk(9, h) II (1) ::; 2(R2 + R3)Rl exp(R1) < 00. 
k=1 

9.13 Notes 
499 
Thus the power series E~=oUk(-,·) from £1(J;By) x Y into Wl(J;Y) 
around zero, and the power series E~=o Vk (·,·) from £1(J;By ) x £1(J;Y) 
into WI (J; Y) around zero, both converge absolutely, and uniformly on any 
bounded set of (y, g, h). Let ¢ be Daleckii and Krein's solution of (9.208) as 
a function of (y, g, h) E Y X £1 (J; By) x £1 (J; Y), given by [35, (3.1.6)] with 
their A, J, x(·), and xo equal to our g, h, ¢(.), and y = ¢(a), respectively, and 
their g(t) equal to our y + J! h(s) ds. Then for each t E [a, b], 
00 
00 
¢(t) = 2: Uk(g, y)(t) + 2: Vk(g, h)(t). 
(9.212) 
k=O 
k=O 
The sum (9.212) gives a Taylor expansion around zero of ¢ as a function 
of (y, g, h). By the uniqueness stated in Theorem 9.84, and the uniqueness of 
Taylor polynomials, Theorem 5.9, the solution and the respective polynomials 
equal those in our solution. 
9.13 Notes 
During the long history of its development, product integration became a 
wide area of analysis mainly related to the theory of differential and integral 
equations. At least this was the area which motivated the definition of the 
product integral (9.1) given by Volterra [235, Opere, I, p. 235] in 1887. Earlier 
results related to product integrals, including equivalence of different forms 
of Volterra's original product integral, product integration over contours, and 
differentiability of the product integral with respect to a parameter, are pre-
sented in Schlesinger [206], [207], in Rasch [191], and in Volterra and Hostinsky 
[236, pp. 86-88,223]. Most of these results deal with matrix-valued product in-
tegrals. Volterra and Hostinsky's form of the derivative is somewhat obscured 
by their notation. They also allow the "fixed" endpoints a, b to vary. 
In a somewhat different direction is a work [17] of Garrett Birkhoff, in 
which he extended Volterra's product integral representation of a solution 
of a matrix-valued differential equation to differential equations describing 
an evolution in infinite-dimensional families of transformations. Birkhoff de-
fined a product integral of Volterra's form for functions with values in more 
general spaces and took the limit in (9.1) under refinements of tagged parti-
tions. Birkhoff emphasized a dual relation between product integration and 
differentiation. Similar ideas on product integration in nonlinear manifolds 
are discussed in a survey paper of Masani [159]. Earlier, Masani [158, Sect. 
V] proved among other things that for a function C with values in a Banach 
algebra, the limit (9.1) exists if and only if C is Riemann integrable. 
Schlesinger ([206]' [207]) developed product integration as in (9.1) based 
on approximation by step functions of a matrix-valued function C whose en-
tries are bounded Lebesgue measurable functions. Schmidt [208] proved ex-
istence of such a product integral when C is a Bochner integrable Banach 

500 
9 Product Integration 
space operator-valued function. Another approach to proving existence of the 
Volterra product integral of a Lebesgue integrable matrix-valued function was 
indicated by Dollard and Friedman [45, Section 1.8J. Moreover, Dollard and 
Friedman [45, Theorem 3.5.1] proved that for a Banach space X and the space 
IRx of bounded linear operators from X into itself, with operator norm II . II, 
such a product integral exists for each function A: [a, bJ 3 t 1-+ A(t) E Bx such 
that for each I E X, A(·)I is the pointwise limit of a sequence of simple func-
tions almost everywhere and IIAII has finite upper integral on [a, bJ. Jarnik and 
Kurzweil [1I1] initiated a study of the product integral obtained by extending 
the limit in (9.1) as follows. Let C be a matrix-valued function on [a, bJ. An 
invertible matrix Q is called the product integral of C if given € > ° 
there is 
a gauge function 8(·) on [a, b] such that II rr=l [I + C(Si)(ti - ti-l)]- QII < € 
for all 8-fine tagged partitions ({ t;}i=o, {s;}i=l) of [a, b] (see the beginning of 
Section 2.6). FUrther extensions of this product integral are due to Schwabik 
[212], [213]. 
Another possible definition of product integral is reminiscent of the Rie-
mann-Stieltjes integral. Let h be a function on an interval [a, b] with values in 
a Banach algebra IR with identity n. Define the product integral with respect 
to the function h over [a, b] to be the limit 
lim [1r + h(tn) - h(tn-d] ... [1r + h(tt} - h(to)] 
IKllo 
(9.213) 
if it exists as the mesh 111:1 of partitions II: = {ti}~O of [a,b] tends to zero. 
The product integral (9.213) was treated by MacNerney [152], who discov-
ered reciprocal formulas involving so-called additive and product integrals. 
Earlier analogous formulas, in which h is an interval function and the limit 
exists under refinements of interval partitions, were proved by Dobrushin [43]. 
In particular, MacNerney [152] proved that (9.213) exists if h is continuous 
and of bounded variation. Hildebrandt [96] removed the continuity require-
ment. Freedman [70] replaced the bounded variation condition for a continuous 
function h by the finiteness of the p-variation for some p < 2. He first proved 
existence of a unique solution of an appropliate linear integral equation and, 
second, showed that this solution is the limit (9.213). The product integral de-
fined by (9.213), except that the limit is taken under refinements of partitions 
11:, was treated in [54, Part II]. 
Dollard and Friedman [45, p. 35] differentiate product integrals of the 
Volterra form along suitable I-dimensional curves. Thus far, one would en-
visage differentiability of JC,(1 + df) in the I-variation seminorm 11111(1), as 
actually proved for I absolutely continuous, when 11111(1) = 111'11t. Dollard 
and FHedman [45, p. 36] briefly state analyticity, also along curves, in a form 
that suggests it also holds with respect to the semi norm 11-+ 111'111. Gill and 
Johansen [81] proved compact differentiability with respect to the supremum 
norm, although still on II . lI(1rbounded sets. Freedman [701, by showing ex-
istence of the product integral for continuous I E W p , opened the way to 
extending the differentiability. 

9.13 Notes 
501 
Gill and Johansen [81], see also Gill [80], made a substantial advance in 
showing infinite-dimensional differentiability with uniformity and including 
discontinuous directions f. They also gave several applications of the product 
integral in statistics and probability. It takes a hazard function into a sur-
vival function (for real-valued functions), and matrix-valued functions arise 
for Markov chains in continuous time with non-stationary transitions. 
Notes on Section 9.1. Dobrushin [43] considered matrix-valued multiplica-
tive and additive interval functions of bounded variation in relation to product 
integration. He assumed the interval functions to be upper continuous at 0. 
Notes on Section 9.2. Necessary and sufficient conditions for a product 
integral with respect to a real-valued (point) function f to exist and to be 
non-zero were proved for the first time to our knowledge in [54, Theorem 4.4 
in Part II]. Theorem 9.11 is closely related but is different in regard to atoms 
of f.L in that a function f could have jumps on both sides of a point. 
Notes on Section 9.4. Inequalities similar to those in Corollary 9.24 were 
proved by Freedman [70, Lemma 5.1] using the Love-Young inequality for a 
Riemann-Stieltjes sum and under additional assumptions. Due to the (k!)l/v 
in the denominator of the right side of (9.28) these assumptions turn out to 
be unnecessary. The proof of Theorem 9.23, which yields the inequalities of 
Corollary 9.24, is based on extending two inequalities of Lyons [lSI]. The 
inequality of Lemma 9.25 is part of Theorem 1.1 of Lyons [151], up to the 
constant 4. The inequality of Lemma 9.26 was proved by Lyons [151, Theorem 
1.2] for continuous functions. 
Notes on Section 9.5. The fact that the finiteness of the p-variation with 
o < p < 2 is sufficient for the existence of the product integral with respect to 
a Banach-algebra-valued (point) function f was proved in [54, Theorem 4.23 in 
Part II]. Earlier, Freedman [70] proved existence of a product integral defined 
as a solution of a linear Riemann-Stieltjes integral equation with respect to a 
continuous function f having bounded p-variation with 1 ::; p < 2. Theorem 
9.28 is a related result for the product integral with respect to an upper 
continuous additive interval function. The existence of the product integral 
with respect to a matrix-valued upper continuous additive interval function 
of bounded variation was proved by Dobrushin [43, Theorem 4]. 
Notes on Section 9.6. The property defining the multiplicative transform 
was introduced in attempts to prove Duhamel's formula under the conditions 
of Theorem 9.49. Also, it sometimes appears (e.g. in the proof of Theorem 
5 in [43]) in proofs of duality between multiplicative and additive transforms 
as in Corollary 9.38. For point functions of bounded p-variation, 0 < p < 2, 
a duality between the product integral operator and a logarithm operator is 
proved in [54, Part II, Theorems 6.10, 6.12]. 
Notes on Section 9.8. Two-integrand extensions I f dh 9 of the RS, RRS, 
and CY integrals for a point function integrator h were considered in Section 3 
of [54, Part II]. There LY and RY integrals with two integrands f and 9 were 
introduced and used for the same purpose as the Kolmogorov integral with 

502 
9 Product Integration 
two integrands in this chapter. In that case f and 9 are not interchangeable 
even if B is commutative. 
Notes on Section 9.9. The Duhamel formula as given by Theorem 9.49 
extends the algebraic identity (9.43) to a class of multiplicative transforms 
using the Kolmogorov integral with two integrands. Other extensions to dif-
ferent types of product integrals were proved by Dollard and Friedman [45, 
Theorem 1.51] and in [54, Part II, Theorem 5.5]. A simpler variant of this 
formula known under the same name is the following: for any matrices A, B, 
and each t ~ 0, 
exp(tA) - exp(tB) = lot exp«t - s)A) ds(A - B) exp(sB). 
Notes on Section 9.10. The fact that the product integral operator (9.92) 
is a uniformly entire mapping on AIp([a,b];B), 1 :5 p < 2, (Theorem 9.51) 
is the main result of this chapter. Frechet differentiability of the product 
integral operator with respect to a point function at each function of bounded 
p-variation 0 < p < 2 was proved in [54, Theorem 5.16 in Part II]. Theorem 
5.17 in [54, Part II] gives analyticity of this operator when restricted to right-
or left-continuous functions of bounded p-variation, 0 < p < 2. 
Notes on Section 9.11. Using an integral equivalent to the refinement 
Young-Stieltjes integral, Hildebrandt [96, p. 359] proved that if a matrix-
valued function h with bounded variation has a finite number of discontinuities 
on [a, b] then the integral equation 
f(t) = n + it dh f, 
a :5 t :5 b, 
(9.214) 
has a unique solution if and only if the matrices n - ..:1-h( x) have inverses for 
all points of discontinuity of h. Hildebrandt considers cases where h IIlay have 
non-zero jumps (..:1+ h) (u) and (..:1-h) (u) on both sides of the same point and 
seeks an actual solution of (9.214). The solution is a kind of product integral 
where the factor at a point u where h has jumps on one side or the other is 
[n + ..:1+h(u)][11 -..:1- h(U)tl. 
MacNerney [153] used the left Cauchy and right Cauchy integrals defined 
as refinement Riemann-Stieltjes, or RRS, integrals except that tagged parti-
tions ({ ti }i=o, {sdi=d are used such that Si = ti-l and Si = ti, respectively. 
Honig [100] used the interior RRS integral defined as the RRS integral ex-
cept that the tagged partitions ({ti}f=o, {Si}r~l) defining the integral satisfy 
the relation ti-l < Si < ti. The book of Schwabik, Tvrdy, and Vejvoda [214] 
treats linear integral equations with respect to functions of bounded variation 
using the Henstock-Kurzweil integral. 
In the proof that the solution operators for inhomogeneous integral equa-
tions are uniformly entire functions of given y, p, and v in Theorem 9.76, we 
used normed subspaces Mp and !vi;; of interval functions with norms osten-
sibly stronger than the two-sided p-variation norm II '1IIp], At this writing, we 
do not know whether Mp and !vi;; are equal to each other or to Ip. 

9.13 Notes 
503 
Notes on Section 9.12. The main facts in this section on Banach-space-
valued functions are corollaries of those in the previous section for Banach-
algebra-valued functions. We also consider differential equations with Bochner 
integrable coefficients and relate these to integral equations in the case p = 1. 
Here a reference, treated in the text, is the book by Daleckil' and KreIn [35, 
§3.1]. The available methods for p = 1, to the extent that they are based on 
absolute integrability, seem not to extend to 1 < p < 2. 


10
Nonlinear Diﬀerential and Integral Equations
10.1 Classical Picard Iteration
Let us recall the classical method of Picard iteration. Let F be a (globally)
Lipschitz function from Rk into Rk,
F(x) −F(y)
 ≤K|x −y|
for all x, y ∈Rk and some constant K < ∞. Suppose we want to solve a
nonlinear ordinary diﬀerential equation
df/dt = F(f(t)),
a < t < ∞,
(10.1)
for f with values in Rk, with the initial conditions f(a) = c ∈Rk and f(t) →c
as t ↓a. Consider the sequence of functions fn deﬁned by f0 ≡c and
fn+1(t) = c +
Z t
a
F(fn(s)) ds,
a ≤t < ∞.
(10.2)
Then for n = 0, 1, . . . , fn is a C1 function on [a, ∞) with fn(a) = c. Picard
showed that the sequence {fn}n≥0 converges to a solution. By the Lipschitz
condition on F, for each n = 1, 2, . . ., and a ≤t < ∞, we have
|(fn+1 −fn)(t)| ≤K
Z t
a
|(fn −fn−1)(s)| ds.
(10.3)
Let Gn(t) := supa≤s≤t |(fn −fn−1)(s)|. Then Gn+1(t) ≤
R t
a KGn(s) ds for
each t ≥a and n = 1, 2, . . .. We have G1(t) = (t −a)|F(c)| for each t ≥a. It
follows by induction that for n = 1, 2, . . . ,
Gn(t) ≤|F(c)|Kn−1(t −a)n/n!.
Since the Taylor series of eKy converges absolutely for all y ∈R, we get that
fn(t) converges for all t ≥a to some f(t) := f∞(t), uniformly on any bounded
interval [a, b], and that the function f is a solution of the integral equation
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_10, 
505

506
10 Nonlinear Diﬀerential and Integral Equations
f(t) = c +
Z t
a
F(f(s)) ds,
a ≤t < ∞.
(10.4)
As a uniform limit of continuous functions, f is continuous and so by (10.4)
it is C1 and satisﬁes the diﬀerential equation (10.1).
Theorem 10.1. The function f = f∞:= limn→∞fn is the unique solution
of the diﬀerential equation (10.1) on (a, b) for any b with a < b ≤+∞such
that f(a) = c and limt↓a f(t) = c.
Proof. First, let L∞
loc := L∞
loc([a, b)) be the set of all measurable functions from
[a, b) into Rk, bounded on each interval [a, d] for a < d < b. It will be shown
that f = f∞is the unique solution of (10.4) in L∞
loc. Suppose g is another
such solution. For each t ∈[a, b), letting H(t) := supa≤s≤t |(f −g)(s)| < ∞,
we have |(f −g)(t)| ≤∫t
a K|(f −g)(s)| ds, and so H(t) ≤K(t −a)H(t). Thus
for a ≤t < min(b, a + 1/K) we get H(t) = 0. If b ≤a + 1/K we are done.
Otherwise we can start again at a + 1/K and iterate the argument as many
times as needed. It then follows that f(t) = g(t) for all a ≤t < b, proving
that f∞is the unique solution of (10.4) in L∞
loc.
We have seen that f = f∞is a solution of (10.1) as well as (10.4) and
that it is C1. Also, f∞satisﬁes the initial condition f(a) = c. It is the unique
solution of (10.1) that does so: Let g be another such solution. Then being
diﬀerentiable, it is continuous, and so by (10.1) it is C1. Thus for each t ≥a,
g(t) −g(a) =
Z t
a
g′(s) ds =
Z t
a
F(g(s)) ds,
i.e., g satisﬁes (10.4). Since it is in L∞
loc, it equals f∞, completing the proof.
2
Example 10.2. Consider the analytic but not globally Lipschitz function
F(x) = x2, x ∈R. Solving (10.1) by separation of variables gives f(t) =
1/((1/c) −t) with c = f(0) ̸= 0. If c > 0 we get a solution f of (10.1) and
(10.4) for a = 0 ≤t < 1/c which goes to +∞as t ↑1/c.
10.2 Picard’s Method in p-Variation Norm, 1 ≤p < 2
A classical non-autonomous nonlinear ﬁrst-order ordinary diﬀerential equation
is of the form
df(t)/dt = ψ(f(t), t) = (Nψf)(t),
a < t < ∞,
extending (10.1). In a diﬀerential form we could write
df(t) = (Nψf)(t)dt.

10.2 Picard’s Method in p-Variation Norm, 1 ≤p < 2
507
Here we will extend such equations, replacing dt by dµ(t) where µ is an interval
function in AIp, and we seek a solution f ∈Wp, where Nψ takes Wp into
Wq with p−1 + q−1 > 1. We will also add a term (Nφf)(t)dν(t) where ν is of
bounded 1-variation, giving a formal equation
df = (Nψf)·dµ + (Nφf)·dν,
to be made precise by the integral equation (10.5), or alternate equations
(10.6), (10.7), or (10.8).
Let X, Y , and Z be Banach spaces with a bounded bilinear map (x, y) 7→
x · y: X × Y →Z as usual (1.14), and let J := [a, b] with −∞< a < b < ∞.
For 1 ≤p < 2, let µ ∈AIp(J; Y ) and ν ∈AI1(J; Y ), that is, let µ and
ν be Y -valued additive and upper continuous interval functions on J having
bounded p-variation and 1-variation, respectively. Let φ, ψ: Z × J →X be
such that the Nemytskii operator Nψ takes Wp(J; Z) into Wq(J; X) with
q ≥p and p−1 + q−1 > 1 (as before, we identify W∞(J; X) with the class of
regulated functions R(J; X)), and the Nemytskii operator Nφ takes R(J; Z)
into R(J; X). Explicit suﬃcient conditions on ψ are given in Theorem 6.58.
For φ, conditions will be given in Deﬁnition 10.5 and Proposition 10.6(b). Also
let c ∈Z.
In this section we consider two forward nonlinear integral equations for
Kolmogorov integrals:
f(t) = c +
R
=
(a,t]
(Nψf)−·dµ +
R
=
(a,t]
(Nφf)−·dν,
a ≤t ≤b,
(10.5)
g(t) = c +
R
=
[a,t)
(Nψg)·dµ +
R
=
[a,t)
(Nφg)·dν,
a ≤t ≤b,
(10.6)
and two analogous backward integral equations:
f(t) = c +
R
=
[t,b)
(Nψf)+·dµ +
R
=
[t,b)
(Nφf)+·dν,
a ≤t ≤b,
(10.7)
g(t) = c +
R
=
(t,b]
(Nψg)·dµ +
R
=
(t,b]
(Nφg)·dν,
a ≤t ≤b.
(10.8)
Recall, as for linear equations in the previous chapter, that use of a closed
interval [a, t] in (10.6) or omission of the left limit in (10.5) can lead to contra-
dictions as in (1.8). Analogous considerations hold for the backward equations.
A solution f of (10.5) or g of (10.8), if it exists, will be right-continuous,
and solutions of (10.6) and (10.7) will be left-continuous, by additivity and
upper continuity at ∅of the Kolmogorov integral (Theorem 2.21 and Corollary
2.23, respectively). But solutions g of (10.6) and f of (10.5) may not simply
satisfy g(t) = f(t−) for a < t ≤b, or f(t) = g(t+) for a ≤t < b, e.g. if µ or ν
has an atom at a then in general
g(a+) = c + (Nψg)(a)·µ({a}) + (Nφg)(a)·ν({a}) ̸= c = f(a).

508
10 Nonlinear Diﬀerential and Integral Equations
If µ and ν have no atoms, solutions f and g of (10.5) and (10.6) will be
continuous and equal by Lemma 2.49 and Corollary 2.26.
The main result giving the existence and uniqueness of a solution for each
of the four integral equations holds for functions ψ and φ satisfying suitable
hypotheses. First recall Deﬁnition 6.42 of the class UHα and Deﬁnition 6.47
of the class Wα,q.
Deﬁnition 10.3 (of HWGα,q, WGα,q, and Gα,q). Let 0 < α ≤1, 0 < q <
∞, and let J be a nondegenerate interval. For Banach spaces Z and X, let
ψ ≡ψ(z, s): Z × J →X, and let B be a nonempty subset of Z. We say that
ψ is in the class WGα,q(B × J; X) if there is a ﬁnite constant C such that for
each 0 ≤K < ∞,
Wα,q(ψ, K; B × J, X) ≤C(1 + Kα),
(10.9)
where Wα,q is deﬁned to be the minimal W ≥0 such that (6.31) holds for
a given K. Let Gα,q(ψ) := Gα,q(ψ; B × J, X) be the minimal such C. Let
HWGα,q(B × J; X) := UHα(B × J; X) ∩WGα,q(B × J; X).
Remark 10.4. It follows immediately from the deﬁnitions that WGα,q(B ×
J; X) ⊂Wα,q(B × J; X) for any nonempty B ⊂Z.
For the function φ we will assume growth conditions of the following kind:
Deﬁnition 10.5 (of Gβ, UGβ, UCR, and CRGβ). Let 0 < β < ∞and let J
be a nondegenerate interval. For Banach spaces Z and X, let φ ≡φ(z, s): Z ×
J →X, and let B be a nonempty subset of Z. We say that φ satisﬁes the
s-uniform β growth condition on B, or φ ∈UGβ(B × J; X), if
∥φ∥Gβ := ∥φ∥B×J,Gβ := sup
z∈B
∥φ(z, ·)∥J,sup/(1 + ∥z∥β) < ∞.
If this holds for φ(z, s) ≡G(z) then we write G ∈Gβ(B; X). We say that φ is
in the class UCR(B × J; X) if (a) B ∋z 7→φ(z, ·) ∈ℓ∞(J, X) is continuous,
and (b) J ∋s 7→φ(z, s) is regulated for each z ∈B. Let CRGβ(B × J; X) :=
UCR(B × J; X) ∩UGβ(B × J; X).
Proposition 10.6. (a) If B is bounded, UGβ(B × J; X) = ℓ∞(B × J; X) for
any β.
(b) If φ ∈UCR(Z × J; Y ) then the Nemytskii operator Nφ takes R(J; Z) into
R(J; X).
Proof. Part (a) is clear. For part (b), suppose that f ∈R(J; Z) and tn ↓t
or tn ↑t ∈J where t1 ∈J and tn ̸= t for all n. We need to show that the
sequence φ(f(tn), tn) converges to some limit. Let zn = f(tn) ∈Z. Then zn
converge to some limit z0, and supt∈J ∥φ(zn, t) −φ(z0, t)∥→0 as n →∞.
Also φ(z0, ·) is regulated. Then

10.2 Picard’s Method in p-Variation Norm, 1 ≤p < 2
509
∥φ(zn, tn) −φ(zm, tm)∥
≤∥φ(zn, tn)−φ(z0, tn)∥+∥φ(z0, tn)−φ(z0, tm)∥+∥φ(z0, tm)−φ(zm, tm)∥,
which approaches 0 as m, n →∞, so {φ(zn, tn)}n≥1 is a Cauchy sequence and
converges.
2
Finally, Fr´echet u-diﬀerentiability of ψ and the local classes HWloc
α,q, UHloc
α
are deﬁned in Deﬁnitions 6.8, 6.51, and 6.43, respectively. Now we are ready
to formulate the main result of this chapter.
Theorem 10.7. Let α, β ∈(0, 1], 1 ≤p < 1 + α, and J := [a, b] with a < b.
Assuming (1.14), let ψ ∈HWG1,p(Z × J; X) be Fr´echet u-diﬀerentiable on
Z with the derivative ψ(1)
u
∈HWloc
α,p/α(Z × J; L(Z; X)), let φ ∈UGβ(Z ×
J; X) ∩UHloc
1
(Z × J; X) be such that φ(z, ·) ∈R(J; X) for each z ∈Z, let
µ ∈AIp(J; Y ), ν ∈AI1(J; Y ), and c ∈Z. Then each of the four integral
equations (10.5), (10.6), (10.7), and (10.8) has a unique solution in Wp(J; Z).
If ψ(z, s) ≡F(z) and φ(z, s) ≡G(z), the theorem just stated implies the
following:
Corollary 10.8. Let α, β ∈(0, 1], 1 ≤p < 1 + α, and J := [a, b] with
a < b. Assuming (1.14), let F ∈H1(Z; X) be Fr´echet diﬀerentiable on Z with
derivative DF ∈Hloc
α (Z; L(Z; X)), let G ∈Gβ(Z; X) ∩Hloc
1
(Z; X), let µ ∈
AIp(J; Y ), ν ∈AI1(J; Y ), and c ∈Z. Then the conclusion of Theorem 10.7
holds with the Nemytskii operators Nψ and Nφ replaced by the autonomous
Nemytskii operators NF and NG, respectively.
The proofs of the above theorem and corollary are given in Section 10.3.
Deﬁne the integral transforms T ≻
c,u,µ,ν and Q≻
c,u,µ,ν, for any a ≤u ≤t ≤b
and f ∈Wp([u, b]; Z), letting
T ≻
c,uf(t) := T ≻
c,u,µ,νf(t) := c +
R
=
(u,t]
(Nψf)−·dµ +
R
=
(u,t]
(Nφf)−·dν,
(10.10)
Q≻
c,uf(t) := Q≻
c,u,µ,νf(t) := c +
R
=
[u,t)
(Nψf)·dµ +
R
=
[u,t)
(Nφf)·dν,
(10.11)
provided the Kolmogorov integrals are deﬁned. It will be shown that these
transforms are well deﬁned and take Wp([u, b]]; Z) into itself under some con-
ditions, as follows:
Proposition 10.9. Let c ∈Z, J
:= [a, b] with a < b, 1 ≤p < 2,
ν ∈AI1(J; Y ), and µ ∈AIp(J; Y ). Let φ, ψ: Z × J →X be such that
the Nemytskii operator Nψ takes Wp(J; Z) into Wq(J; X) with q ≥p and
p−1+q−1 > 1, and assume that Nφ takes R(J; Z) into R(J; X). Let a ≤u < b.
(a) Then the integral transforms Q≻
c,u and T ≻
c,u are deﬁned on Wp([u, b]]; Z)
and take it into itself.

510
10 Nonlinear Diﬀerential and Integral Equations
(b) The hypothesis on ψ holds if ψ ∈HWp/q,q(Z × J; X) or more generally if
ψ ∈HWloc
p/q,q(Z × J; X), and that on φ holds if φ ∈UCR(Z × J; X).
(c) The hypotheses of Theorem 10.7 imply those of this proposition; speciﬁcally
they imply conclusion (a).
Proof. To prove (a) we note that for given c and u, the values of T ≻
c,uf and
Q≻
c,uf on [u, b] depend only on the values of f on [u, b), and apply the Love–
Young inequality Proposition 3.96 and Proposition 3.31. Part (b) follows di-
rectly from Theorem 6.58(a) and Proposition 10.6(b).
To prove part (c), we need to check the conditions on ψ and φ. In Theorem
10.7 it is assumed that ψ ∈HWG1,p(Z × J; X), which by Deﬁnition 10.3
and Remark 10.4 implies that ψ ∈UH1(Z × J; X) ∩W1,p(Z × J; X). By
Proposition 6.54(b), it follows that Nψ takes Wp([u, b]]; Z) into itself (and is a
bounded nonlinear operator). The range can also be taken to be Wq([u, b]]; Z)
for any q ≥p, by Lemma 3.45. Since 2/p > 1 the hypothesis on ψ for this
proposition holds.
For φ, the hypotheses of Theorem 10.7 imply that φ ∈UH1(Z ×J; X) and
φ(z, ·) ∈R(J; X) for each z ∈Z. Thus by Deﬁnition 10.5, φ ∈UCR(Z ×J; X)
and part (b) for φ applies, proving part (c) and the proposition.
2
Now, (10.5) is equivalent to f = T ≻
c,a,µ,νf on [a, b], and similarly for (10.6).
Later the deﬁnitions (10.10) and (10.11) will be applied to v in place of b
where u < v ≤b.
Picard iterates
We will show that each of the four integral equations can also be solved by
performing an iteration similar to the classical Picard iteration (10.2). To
deﬁne the iterates, let f ≻
0 := g≻
0 := c, and for each n ≥1 and t ∈J, let
f ≻
n (t) := T ≻
c,af ≻
n−1(t) = c +
R
=
(a,t]
(Nψf ≻
n−1)−·dµ +
R
=
(a,t]
(Nφf ≻
n−1)−·dν, (10.12)
g≻
n (t) := Q≻
c,ag≻
n−1(t) = c + R=
[a,t)
(Nψg≻
n−1)·dµ + R=
[a,t)
(Nφg≻
n−1)·dν.
(10.13)
Then {f ≻
n }n≥0 and {g≻
n }n≥0 are two sequences of functions in Wp(J; Z), which
will be called Picard iterates associated to the forward integral equations (10.5)
and (10.6), respectively, or obtained by the integral transforms T ≻
c,u,µ,ν and
Q≻
c,u,µ,ν, respectively.
With respect to the two backward integral equations (10.7) and (10.8) we
deﬁne backward integral transforms and sequences symmetrically as follows.
For f ∈Wp(J; Z) and a ≤t ≤v ≤b, let
T ≺
c,vf(t) := T ≺
c,v,µ,νf(t) := c +
R
=
[t,v)
(Nψf)+·dµ +
R
=
[t,v)
(Nφf)+·dν,
(10.14)
Q≺
c,vf(t) := Q≺
c,v,µ,νf(t) := c +
R
=
(t,v]
(Nψf)·dµ +
R
=
(t,v]
(Nφf)·dν.
(10.15)

10.2 Picard’s Method in p-Variation Norm, 1 ≤p < 2
511
Remark 10.10. As in Proposition 10.9, under its hypotheses, with now u <
v ≤b, the integral transforms T ≺
c,v and Q≺
c,v act from Wp([[u, v]; Z) into itself.
Let f ≺
0 := g≺
0 := c, and for each n ≥1 and t ∈J, let
f ≺
n (t) := T ≺
c,bf ≺
n−1(t) = c +
R
=
[t,b)
(Nψf ≺
n−1)+·dµ +
R
=
[t,b)
(Nφf ≺
n−1)+·dν, (10.16)
g≺
n (t) := Q≺
c,bg≺
n−1(t) = c +
R
=
(t,b]
(Nψg≺
n−1)·dµ +
R
=
(t,b]
(Nφg≺
n−1)·dν.
(10.17)
Then {f ≺
n }n≥0 and {g≺
n }n≥0 are two sequences of functions in Wp(J; Z), which
will be called Picard iterates associated to the backward integral equations
(10.7) and (10.8), respectively, or obtained by the integral transforms T ≺
c,v,µ,ν
and Q≺
c,v,µ,ν, respectively.
Theorem 10.11. Under the hypotheses of Theorem 10.7, each of the four
sequences of Picard iterates (10.12), (10.13), (10.16) and (10.17) converges
in Wp(J; Z) to the unique solution in Wp(J; Z) of the corresponding integral
equation given by Theorem 10.7.
If ψ(z, s) ≡F(z) and φ(z, s) ≡G(z), the preceding theorem implies the
following:
Corollary 10.12. Under the hypotheses of Corollary 10.8, the conclusion of
Theorem 10.11 holds with the Nemytskii operators Nψ and Nφ replaced by the
autonomous Nemytskii operators NF and NG, respectively.
We will prove Theorem 10.11 and Corollary 10.12 in Section 10.4. Before
proving Theorems 10.7 and 10.11 we next present several consequences.
Examples and corollaries
First we notice that under the assumption (1.14), the order of integrand and
integrator in the four nonlinear integral equations is unimportant. It can be
reversed using the formal rule (1.16), and the new equations can be solved
as follows. For now, let µ be an X-valued additive and upper continuous
interval function on an interval [a, b] having bounded p-variation for some
1 ≤p < 2. Also for now, let a function F : Z →Y be α-H¨older continuous
with p −1 < α ≤1, and let c ∈Z. Consider two forward nonlinear integral
equations for Kolmogorov integrals:
f(t) = c +
R
=
(a,t]
dµ·(F◦f)−,
a ≤t ≤b,
(10.18)
g(t) = c +
R
=
[a,t)
dµ·(F◦g),
a ≤t ≤b.
(10.19)
The two analogous backward equations can be solved similarly, and are not
considered here. Related to the integral equations (10.18) and (10.19), deﬁne

512
10 Nonlinear Diﬀerential and Integral Equations
the associated Picard iterates {fn}n≥0 and {gn}n≥0, respectively, by f0 :=
g0 ≡c and for each n ≥1, let
fn(t) = c +
R
=
(a,t]
dµ·(F◦fn−1)−,
a ≤t ≤b,
(10.20)
gn(t) = c +
R
=
[a,t)
dµ·(F◦gn−1),
a ≤t ≤b.
(10.21)
Applying Corollaries 10.8 and 10.12 to the bounded bilinear operator eB : Y ×
X →Z deﬁned by eB(y, x) := B(x, y) := x · y we get the following:
Corollary 10.13. Let 0 < α ≤1, 1 ≤p < 1 + α, and J := [a, b] with
a < b. Assuming (1.14), let µ ∈AIp(J; X), let F ∈H1(Z; Y ) be Fr´echet
diﬀerentiable on Z with derivative DF ∈Hloc
α (Z; L(Z, Y )), and c ∈Z. Then
(a) each of the two integral equations (10.18) and (10.19) has a unique solution
in Wp(J; Z), and (b) each of the two sequences of Picard iterates (10.20) and
(10.21) converges in Wp(J; Z) to the solution of the respective equation from
(a).
Let Y be a Banach space and let X := BY = L(Y, Y ) be the Banach
algebra of bounded linear operators from Y into itself. Let Z = Y and
B(T, y) = Ty for T ∈X and y ∈Y . Suppose that F ∈BY is the identity
mapping from Y onto itself, denoted by 1I. Then (10.18) becomes the forward
homogeneous linear integral equation (9.203) with c = y. In this case using
Corollary 2.23 with the reversed order of integrand and integrator, (10.20)
can be written recursively in closed form as follows: for a ≤t ≤b, and n ≥2,
fn(t) = c + µ((a, t])c + R=
(a,t]
µ(ds) R=
(a,s)
dµ (fn−2)−= · · ·
=
n
1I + µ((a, t]) +
n
X
k=2
R
=
(a,t]
µ(ds1)
R
=
(a,s1)
µ(ds2) · · ·
R
=
(a,sk−1)
µ(dsk)
o
c.
By (9.94), fn(t) is a partial sum of the Taylor expansion of the product integral
with respect to µ over the interval A = (a, t]. Similarly, assuming that F in
(10.19) is the identity, the associated Picard iterates gn(t), n ≥2, t ∈[a, b], in
(10.21) can be rewritten in the form of partial sums of the Taylor expansion of
the product integral with respect to µ over the intervals A = [a, t), t ∈[a, b].
Finally, we show how Corollary 10.12 can be used to solve a nonlin-
ear reﬁnement Riemann–Stieltjes integral equation with respect to a right-
continuous point function.
Corollary 10.14. Let 0 < α ≤1, 1 ≤p < 1 + α, and J := [a, b] with
a < b. Assuming (1.14), let F ∈H1(Z; X) be Fr´echet diﬀerentiable on Z with
derivative DF ∈Hloc
α (Z; L(Z, Y )), let h ∈Wp(J; Y ) be right-continuous, and
let c ∈Z. Let f0 ≡c ∈Z, and for n = 1, 2, . . . ,

10.3 Existence and Uniqueness
513
fn(t) := c + (RRS)
Z t
a
(F◦fn−1)(a)
−·dh,
a ≤t ≤b.
(10.22)
Then fn ∈Wp(J; Z) for all n and the fn converge in Wp(J; Z) to some f
which is the unique solution in Wp(J; Z) of
f(t) = c + (RRS)
Z t
a
(F◦f)(a)
−·dh,
a ≤t ≤b.
(10.23)
Proof. Let µ := µh,J be the Y -valued interval function on J deﬁned by (2.2).
Then since h is regulated, µ is upper continuous by Theorem 2.7. Let ˜h(t) :=
µ([a, t]) for a ≤t ≤b. Since h is right-continuous, by Proposition 2.6, we have
˜h = Rµ,a = h −h(a) for a ≤t ≤b and Rµ,a deﬁned by (2.3). By Proposition
3.31, vp(µ; J) = vp(h; J) < ∞. For an X-valued regulated function g on J, let
ν := µg,J be the X-valued interval function on J also deﬁned by (2.2). Then
ν is also upper continuous by Theorem 2.7, ν(∅) = 0, and g(t−) = ν([a, t))
for a < t ≤b by Proposition 2.6. Since µ({a}) = h(a+) −h(a) = 0, the
Kolmogorov integral
R
=(a,b] g−·dµ exists if and only if
R
=J ν([a, ·))·dµ does and
if they exist then they are equal by Theorem 2.21 with A1 = {a}. Therefore
by Proposition 2.89, the Kolmogorov integral
R
=(a,b] g−·dµ exists if and only if
the reﬁnement Riemann–Stieltjes integral (RRS) ∫b
a g(a)
−·dh does, and if they
exist then for each a ≤t ≤b,
R
=
(a,t]
g−·dµ = (RRS)
Z t
a
g(a)
−·dh.
Now, each function fn deﬁned by (10.22) is equal to the function deﬁned by
(10.12) with Nψ ≡NF and Nφ ≡0. Thus by Corollary 10.12 with G ≡0 and
ν ≡0, the fn converge in Wp(J; Z) to some function f which is the unique
solution in Wp(J; Z) of (10.5), and hence of (10.23), proving the corollary. 2
10.3 Existence and Uniqueness
To prepare for the proof of Theorem 10.7 we will characterize relation (10.9)
deﬁning the class HWGα,q given by Deﬁnition 10.3. Recall Deﬁnition 6.42 of
the class UHα of s-uniformly α-H¨older functions ψ: B × J →X with its
seminorm Hα(ψ) := Hα(ψ; B × J, X), and Deﬁnition 6.47 of the seminorm
Wα,q(·, K), 0 ≤K < ∞.
Proposition 10.15. Let 1 ≤p ≤q < ∞, α := p/q, and J := [a, b] with
a < b. For Banach spaces Z and X, let B be a nonempty subset of Z, and let
ψ: Z × J →X be in UHα(B × J; X). The following statements (a) and (b)
are equivalent:

514
10 Nonlinear Diﬀerential and Integral Equations
(a) ψ ∈HWGα,q(B × J; X), or equivalently since ψ ∈UHα(B × J; X), ψ ∈
WGα,q(B × J; X); in other words, there is a ﬁnite constant C such that
(10.9) holds for each 0 ≤K < ∞;
(b) there is a ﬁnite constant D such that for each g ∈Wp(J; Z) with range
ran (g) ⊂B and any nondegenerate interval A ⊂J,
Nψg

A,[q] ≤D(1 + ∥g∥α
A,[p]).
Moreover, if (a) holds, we can take D = C+max{∥Nψ(z1J)∥sup+∥z∥αHα(ψ),
2Hα(ψ)} for any z ∈B.
Proof. Suppose (a) holds. Then by Lemma 6.53(a) and (10.9), we have
∥Nψg∥A,(q) ≤Hα(ψ)∥g∥α
A,(p) + Wα,q(ψ, ∥g∥A,[p])
≤C + (C + Hα(ψ))∥g∥α
A,[p].
Let z ∈B. By the deﬁnition (6.31) of Wα,q(ψ, K), ψ(z, ·) ∈Wq(J; X), and so
∥Nψ(z1J)∥sup < ∞. Since ψ ∈UHα(B × J; X), it then follows that
∥Nψg∥A,sup ≤∥Nψ(z1J)∥sup + Hα(ψ)(∥g∥α
A,sup + ∥z∥α).
Thus letting D := C + max{∥Nψ(z1J)∥sup + ∥z∥αHα(ψ), 2Hα(ψ)}, (b) holds.
Now suppose that (b) holds. By Lemma 6.53(c), for 0 ≤K < ∞, we have
Wα,q(ψ, K; B × J, X) ≤Hα(ψ)Kα + D + DKα.
Thus taking C := D + Hα(ψ), (a) follows, proving the proposition.
2
The next three examples give suﬃcient conditions for statement (a) of the
preceding proposition.
Example 10.16. Using the notation of Proposition 10.15, let h ∈Wq(J) and
let F : Z →X be such that for some constant M, ∥F(z)∥≤M(1 + ∥z∥α),
z ∈Z (in the case Z = X = R this is the α growth condition (7.2)). For each
(z, s) ∈Z × J, let ψ(z, s) := F(z)h(s). To show that (a) of Proposition 10.15
holds for ψ, recall the notation (6.31). Let 0 ≤K < ∞, B ⊂Z, let κ = {si}n
i=0
be a partition of J, and let µ = {zi}n
i=1 ⊂B be such that wαq(µ) ≤K. Then
sq(ψ; µ, κ)1/q ≤∥h∥(q) max
i
∥F(zi)∥≤M∥h∥(q)
 1 + Kα
,
and so (10.9) holds with C = M∥h∥(q).
Example 10.17. Another example is ψ(z, s) := Pm
j=1 Fj(z)hj(s) with z ∈
Z, s ∈J, and 1 ≤m < ∞, where Fj ∈Hα(Z; X) and hj ∈Wq(J). Let
0 ≤K < ∞, B ⊂Z, let κ = {si}n
i=0 be a partition of J and let µ =
{zi}n
i=1 ⊂B be such that wαq(µ) ≤K. For a function f : J →R and each i,

10.3 Existence and Uniqueness
515
let ∆if := f(si) −f(si−1). Using the triangle inequality, and then iterating
the Minkowski inequality (1.5), it follows that
sq(ψ; µ, κ)1/q ≤

n
X
i=1
 m
X
j=1
∥Fj(zi)∥|∆ihj|
q1/q
≤
m
X
j=1

n
X
i=1
∥Fj(zi)∥q|∆ihj|q1/q
≤
m
X
j=1
∥hj∥(q) max
i
∥Fj(zi)∥
≤
m
X
j=1
∥hj∥(q)∥Fj(0)∥+ Kα
m
X
j=1
∥hj∥(q)∥Fj∥(Hα).
Thus (10.9) holds with C = Pm
j=1 ∥hj∥(q)∥Fj∥Hα.
Example 10.18. For j = 1, 2, . . . , let Fj ∈Hα(Z; X) and hj ∈Wq(J) be
such that
∞
X
j=1
∥hj∥[q]∥Fj∥Hα < ∞.
Since P∞
j=1 ∥hj∥sup∥Fj∥sup < ∞, it follows that for each (z, s) ∈Z × J,
ψ(z, s) := P∞
j=1 Fj(z)hj(s) ∈X. Let 0 ≤K < ∞, B ⊂Z, let κ = {si}n
i=0
be a partition of J and let µ = {zi}n
i=1 ⊂B be such that wαq(µ) ≤K. For a
function f : J →R and each i, let ∆if := f(si) −f(si−1). Then
sq(ψ; µ, κ)1/q ≤

n
X
i=1
 ∞
X
j=1
∥Fj(zi)∥|∆ihj|
q1/q
.
Let C := P∞
j=1 ∥hj∥(q)∥Fj∥Hα < ∞. For each 1 ≤m < ∞, as in the preceding
example we have

n
X
i=1
 m
X
j=1
∥Fj(zi)∥|∆ihj|
q1/q
≤C(1 + Kα).
Letting m →∞, it follows that (10.9) holds. Moreover, for any z, w ∈Z and
s ∈J, we have
∥ψ(z, s) −ψ(w, s)∥≤
X
j
∥Fj(z) −Fj(w)∥∥hj∥sup
≤∥z −w∥α X
j
∥Fj∥(Hα)∥hj∥sup.
Thus Hα(ψ; Z ×J; X) < ∞, and so ψ ∈HWGα,q(B ×J; Y ) for each bounded
set B ⊂Z.
We will next give bounds which control p-variation norms for the two
integral transforms T ≻
c,a and Q≻
c,a deﬁned respectively by (10.10) and (10.11).
Recall Deﬁnitions 10.3 for Gα,q and 10.5 for CRGβ.

516
10 Nonlinear Diﬀerential and Integral Equations
Lemma 10.19. Let α, β ∈(0, 1], 1 ≤p < 1+α, q := p/α, and J := [a, b] with
a < b. Assuming (1.14), let ψ ∈HWGα,q(Z × J; X), φ ∈CRGβ(Z × J; X),
µ ∈AIp(J; Y ), and ν ∈AI1(J; Y ). Suppose that for some a ≤u < v ≤b,
∥µ∥(u,v),(p) < ρ1 := {16Kp,q(Gα,q(ψ) + ∥Nψ(0)∥sup + 2Hα(ψ))}−1,
∥ν∥(u,v),(1) < ρ2 := {16∥φ∥Gβ}−1,
(10.24)
where Kp,q = ζ((1 + α)/p), ρ1 := +∞if ψ ≡0, and ρ2 := +∞if φ ≡0. Then
for any R ≥1 the following two statements hold:
(a) ∥T ≻
c,af∥[u,v),[p] ≤2R whenever f ∈Wp([a, v); Z), ∥T ≻
c,af(u)∥≤R and
∥f∥[u,v),[p] ≤2R;
(b) ∥Q≻
c,af∥(u,v],[p] ≤2R whenever f ∈Wp([a, v]; Z), ∥Q≻
c,af(u+)∥≤R and
∥f∥(u,v],[p] ≤2R.
Proof. If ψ ≡0 and φ ≡0 then T ≻
c,af = Q≻
c,af ≡c, and the conclusion of the
lemma holds for any a ≤u < v ≤b. Suppose that either ψ ̸≡0 or φ ̸≡0.
To prove (a), let κ = {ti}n
i=0 be a point partition of [u, v) ⊂J and let
A := (u, v). By additivity of the Kolmogorov integral (Theorem 2.21), the
Minkowski inequality (1.5), the inequality (P
i ap
i )1/p ≤P
i ai valid for any
ai ≥0, and the Love–Young inequality (3.153), we have
sp(T ≻
c,af; κ)1/p
≤

n
X
i=1

R
=
(ti−1,ti]
(Nψf)−·dµ

p1/p
+
n
X
i=1

R
=
(ti−1,ti]
(Nφf)−·dν

≤Kp,q∥(Nψf)−∥A,[q]

n
X
i=1
vp(µ; (ti−1, ti])
1/p
+
(Nφf)−

A,sup
n
X
i=1
v1(ν; (ti−1, ti]).
Thus by superadditivity of vp and v1 over an interval partition (3.69),
∥T ≻
c,af∥[u,v),(p) ≤Kp,q∥Nψf∥A,[q]∥µ∥A,(p) + ∥Nφf∥A,sup∥ν∥A,(1).
(10.25)
Since φ ∈UGβ(Z × J; X), we have by Deﬁnition 10.5,
∥Nφf∥A,sup ≤∥φ∥Gβ(1 + ∥f∥β
A,sup).
(10.26)
Since ψ ∈HWGα,q(Z × J; Y ), by Proposition 10.15(b) with z := 0 ∈B := Z
and A = (u, v), we have
Nψf

A,[q] ≤D(1 + ∥f∥α
A,[p]),
(10.27)
where D := Gα,q(ψ)+∥Nψ(0)∥sup +2Hα(ψ) with Gα,q(ψ) given by Deﬁnition
10.3. Since ∥T ≻
c,af∥[u,v),sup ≤∥T ≻
c,af(u)∥+ ∥T ≻
c,af∥[u,v),(p), it then follows that

10.3 Existence and Uniqueness
517
∥T ≻
c,af∥[u,v),[p] ≤∥T ≻
c,af(u)∥+ 2∥T ≻
c,af∥[u,v),(p)
(10.28)
≤∥T ≻
c,af(u)∥+ 2Kp,qD(1+∥f∥α
A,[p])∥µ∥A,(p) + 2∥φ∥Gβ(1+∥f∥β
A,sup)∥ν∥A,(1)
≤∥T ≻
c,af(u)∥+ 4
n
Kp,qD∥µ∥A,(p) + ∥φ∥Gβ∥ν∥A,(1)
o
max{1, ∥f∥[u,v),[p]}.
Thus for any R ≥1, assuming that ∥T ≻
c,af(u)∥≤R and ∥f∥[u,v),[p] ≤2R, we
have that ∥T ≻
c,af∥[u,v),[p] ≤2R by (10.24), proving (a).
To prove (b), in the proof of (a) we can replace T ≻
c,af by Q≻
c,af, (Nψf)−by
Nψf, (Nφf)−by Nφf, intervals (ti−1, ti] by intervals [ti−1, ti), and [u, v) by
(u, v]. Now in (10.28), since ∥Q≻
c,af∥(u,v],sup ≤∥Q≻
c,af(u+)∥+ ∥Q≻
c,af∥(u,v],(p),
we can also replace ∥T ≻
c,af(u)∥by ∥Q≻
c,af(u+)∥. Thus for any R ≥1, assuming
∥f∥(u,v],[p] ≤2R and ∥Q≻
c,af(u+)∥≤R, it follows that ∥Q≻
c,af∥(u,v],[p] ≤2R
by (10.24), proving (b). The proof of the lemma is now complete.
2
For the following recall that the integral transforms T ≻
c,uf and Q≻
c,uf are
deﬁned respectively by (10.10) and (10.11), for f ∈Wp(A; Z), 1 ≤p < 2, and
A := [u, v) or [u, v], a ≤u < v ≤b. For a ≤u ≤t ≤b we have by additivity
of Kolmogorov integrals (Theorem 2.21)
T ≻
c,af(t) = T ≻
c,af(u) + T ≻
0,uf(t).
(10.29)
By additivity and upper continuity of Kolmogorov integrals (Proposition
2.22), we have for a ≤u < t ≤b,
Q≻
c,af(t) = Q≻
c,af(u) + Q≻
0,uf(u+) + Q≻
0,u+f(t),
(10.30)
where in (10.11) each
R
=[u+,t) equals
R
=(u,t).
The following gives bounds for the last terms on the right sides of (10.29)
and (10.30). Recall the space HWloc
1+α,q as in Deﬁnition 6.61 for n = 1.
Lemma 10.20. Let 0 < α ≤1 ≤p < 1 + α, q := p/α, 0 < R < ∞, and
J := [a, b] with a < b. Assuming (1.14), let ψ ∈HWloc
1+α,q(Z × J; X), let
φ ∈UHloc
1
(Z × J; X) be such that φ(z, ·) ∈R(J; X) for each z ∈Z, let
µ ∈AIp(J; Y ) and ν ∈AI1(J; Y ). Suppose that an interval [u, v] ⊂J is such
that
∥µ∥(u,v),(p) ≤θ1 :=

1 + 16Kp,q[H1(ψ) + D(1 + Rα)]
	−1,
∥ν∥(u,v),(1) ≤θ2 := {1 + 16H1(φ)}−1,
(10.31)
where H1(χ) = H1(χ; BR × J, X) for χ = ψ or φ and with BR := {z ∈
Z : ∥z∥≤R}, D := Hα(ψ(1)
u ; BR × J, X) + Wα,q(ψ(1)
u , R; BR × J, X), and
Kp,q = ζ((1 + α)/p). Let C := [u, v) for part (a) and [u, v] for part (b) below.
Let f, g ∈Wp(C; Z) be such that 3 max{∥f∥C,[p], ∥g∥C,[p]} ≤R. Then for any
ǫ > 0, the following two statements hold:

518
10 Nonlinear Diﬀerential and Integral Equations
(a) ∥T ≻
0,uf −T ≻
0,ug∥[u,v),[p] ≤ǫ/2 whenever ∥f −g∥[u,v),[p] ≤2ǫ;
(b) ∥Q≻
0,u+f −Q≻
0,u+g∥(u,v],[p] ≤ǫ/2 whenever ∥f −g∥(u,v],[p] ≤2ǫ.
Proof. To prove (a), let A := (u, v). As in the proof of Lemma 10.19(a), we
have
∥T ≻
0,uf −T ≻
0,ug∥[u,v),(p)
≤Kp,q∥Nψf −Nψg∥A,[q]∥µ∥A,(p) + ∥Nφf −Nφg∥A,sup∥ν∥A,(1).
By Theorem 6.68 and since ∥· ∥A,(q) ≤∥· ∥A,(p) by Lemma 3.45, we have
∥Nψf −Nψg∥A,[q] ≤H1(ψ)∥f −g∥A,[q] + D
 1 + ∥g∥α
A,(p)

∥f −g∥A,sup
≤[H1(ψ) + D(1 + Rα)]∥f −g∥A,[p].
By the deﬁnition of s-uniform Lipschitz condition (Deﬁnition 6.42), we get
∥Nφf −Nφg∥A,sup ≤H1(φ)∥f −g∥A,sup.
Since (T ≻
0,uf −T ≻
0,ug)(u) = 0, we then have
∥T ≻
0,uf −T ≻
0,ug∥[u,v),[p]
≤2∥T ≻
0,uf −T ≻
0,ug∥[u,v),(p)
(10.32)
≤

2Kp,q[H1(ψ) + D(1 + Rα)]∥µ∥A,(p) + 2H1(φ)∥ν∥A,(1)
	
∥f −g∥A,[p].
For ǫ > 0, assuming ∥f −g∥[u,v),[p] ≤2ǫ, by (10.31), it then follows that
∥T ≻
0,uf −T ≻
0,ug∥[u,v),[p] ≤

4Kp,q

H1(ψ) + D(1 + Rα)

θ1 + 4H1(φ)θ2
	
ǫ ≤ǫ/2.
The proof of statement (a) is complete.
To prove (b), we can replace intervals (ti−1, ti] in the proof of Lemma
10.19(a) by intervals [ti−1, ti), [u, v) by (u, v], and T ≻
0,u by Q≻
0,u+. In this case
to show the analogue of (10.32), we use the fact that
∥Q≻
0,u+g −Q≻
0,u+f∥(u,v],sup ≤∥Q≻
0,u+g −Q≻
0,u+f∥(u,v],(p),
which follows by Corollary 2.23. The proof of the lemma is complete.
2
Finally, before proving Theorem 10.7 we recall the Banach ﬁxed point
theorem. Let (S, d) be a metric space. A mapping T : S →S is called a
contraction if there is a constant 0 ≤q < 1 such that d(Tx, Ty) ≤qd(x, y)
for all x, y ∈S. An element x ∈S is called a ﬁxed point (for T ) if Tx = x.
Theorem 10.21 (Banach ﬁxed point theorem). If (S, d) is complete, every
contraction has a unique ﬁxed point.

10.3 Existence and Uniqueness
519
Proof. Let T nx := (T ◦T ◦· · · ◦T )x to n iterations. For any x ∈S, it is easy
to check that {T nx}n≥1 is a Cauchy sequence, with a limit y which is a ﬁxed
point, and there is no other ﬁxed point.
2
Proof of Theorem 10.7. It seems useful to distinguish between condi-
tions we will call “global,” namely, when the set B is the entire Banach space
Z, as in Deﬁnition 10.3 or 10.5; and other conditions we call “local,” where B
is a proper subset, such as a ball in Lemma 10.20, and which may be indicated
by the superscript loc in deﬁnitions. We begin by considering some global hy-
potheses in Theorem 10.7. Since ψ ∈HWG1,p(Z × J; X), by Deﬁnition 10.3
with α = 1, with p in place of q and B = Z, ψ ∈UH1(Z×J; X). By Deﬁnition
6.42 with B = Z, S = J and Y = X, it then follows that H1(ψ; Z×J, X) < ∞.
Since φ ∈UGβ(Z × J, X), by Deﬁnition 10.5, ∥φ∥Z×J,Gβ < ∞.
Let
V := H(H1(ψ; Z × J, X) + ∥φ∥Z×J,Gβ) < ∞,
W := H(∥Nψ(0)∥sup + 2∥φ∥Z×J,Gβ) < ∞,
(10.33)
where H := supt∈J max{∥µ({t})∥, ∥ν({t})∥}.
We will use Lemmas 10.19 and 10.20, with their local hypotheses, to show
that the two integral operators T ≻
c,a and Q≻
c,a on suitable classes of functions
restricted to suﬃciently small intervals are contractions. By Deﬁnition 10.5,
since
φ ∈UHloc
1
(Z × J; X) and φ(z, ·) ∈R(J; X) for each z ∈Z,
(10.34)
φ ∈UCR(Z × J; X), and so φ ∈CRGβ(Z × J; X). This together with the hy-
pothesis ψ ∈HWG1,p(Z ×J; X) shows that ψ and φ satisfy the hypotheses on
them in the second sentence of Lemma 10.19 with α = 1 there. By Deﬁnition
10.3, ψ ∈WG1,p(Z × J; X), and so ψ(0, ·) ∈Wp(J; X). Thus by Deﬁnition
6.61 with n = 1,
ψ ∈HWloc
1+α,p/α(Z × J; X).
(10.35)
By (10.34) and (10.35), φ and ψ satisfy the hypotheses on them in the second
sentence of Lemma 10.20.
Let ρ1 and ρ2 be deﬁned by (10.24) with α = 1 there. Using Proposition
3.52 twice, one can ﬁnd a Young interval partition {(tj−1, tj)}m
j=1 of J = [a, b]
such that vp(µ; (tj−1, tj)) ≤ρp
1 and v1(ν; (tj−1, tj)) ≤ρ2 for each 1 ≤j ≤m,
and m ≤1 + vp(µ; J)/ρp
1 + v1(ν; J)/ρ2 since the intersections of m1 disjoint
open intervals and m2 such intervals yield at most m1+m2−1 intervals. Thus
the conclusion of Lemma 10.19 holds if tj−1 ≤u < v ≤tj for some j, which
will be used in Lemmas 10.22 and 10.23.
To prove the existence of a unique solution of the integral equation
(10.5), let T ≻
c,a be the integral operator deﬁned by (10.10). For a function
g ∈Wp(J; Z) and a ≤u < v ≤b, since ∥g(v)∥≤∥g∥[u,v),sup + ∥∆−g(v)∥, we
have

520
10 Nonlinear Diﬀerential and Integral Equations
∥g∥[u,v],sup ≤∥g∥[u,v),sup + ∥∆−g(v)∥.
Thus by Corollary 3.43(a), it follows that
∥g∥[u,v],[p] ≤∥g∥[u,v),[p] + 2∥∆−g(v)∥.
(10.36)
Applying this to g = T ≻
c,af with f ∈Wp(J; Z), we have
∥T ≻
c,af∥[u,v],[p] ≤∥T ≻
c,af∥[u,v),[p] + 2∥∆−T ≻
c,af(v)∥.
By additivity of the Kolmogorov integral over adjoining disjoint intervals
(Theorem 2.21), and then by Corollary 2.23, we have
∥∆−T ≻
c,af(v)∥
= lim
u↑v

R
=
(u,v]
(Nψf)−·dµ +
R
=
(u,v]
(Nφf)−·dν

= ∥(Nψf)(v−)·µ({v}) + (Nφf)(v−)·ν({v})∥
≤H{H1(ψ)∥f∥[u,v),sup + ∥Nψ(0)∥sup + ∥φ∥Gβ(1 + ∥f∥β
[u,v),sup)}
≤W + V ∥f∥[u,v),sup
for V and W deﬁned by (10.33). Thus
∥T ≻
c,af∥[u,v],[p] ≤∥T ≻
c,af∥[u,v),[p] + 2W + 2V ∥f∥[u,v),sup.
(10.37)
Let R1 := max{∥c∥, 1} and let Rj+1 := 2W + (2 + 4V )Rj for j = 1, . . . , m.
Let F be the set of all f ∈Wp(J; Z) such that ∥f∥[tj−1,tj),[p] ≤2Rj for j =
1, . . . , m and ∥f(b)∥≤2Rm+1. By Corollary 3.43(a) again, for a ≤u < v ≤b,
we have
∥f∥[u,v],[p] ≤∥f∥[u,v),[p] + ∥∆−f(v)∥+ ∥f(v)∥.
Then ∥f∥[tj−1,tj],[p] ≤4Rj +4Rj+1 for each f ∈F and j = 1, . . . , m. Applying
subadditivity of ∥· ∥(p) and thus of ∥· ∥[p] over closed, adjoining intervals
(Proposition 3.35(a)) recursively,
∥f∥J,[p] ≤
m
X
j=1
∥f∥[tj−1,tj],[p] ≤4R1 + 8
m
X
j=2
Rj + 4Rm+1 =: S < ∞
(10.38)
for each f ∈F.
In the following lemma and its proof, we apply the deﬁnitions (10.10) and
(10.11) with, in place of b, various B with tj−1 ≤B ≤tj.
Lemma 10.22. Let j ∈{1, . . . , m}. Suppose that there is a unique function
h in Wp([a, tj−1]; Z) such that T ≻
c,ah = h, and that ∥h∥[tr−1,tr],[p] ≤Rr+1 for
r = 1, . . . , j −1 if j ≥2. Then there is a unique function g ∈Wp([a, tj]; Z)
such that T ≻
c,ag = g, and we have ∥g∥[tj−1,tj],[p] ≤Rj+1.

10.3 Existence and Uniqueness
521
Proof. Let R := 3S. For this value of R, let θ1 and θ2 be deﬁned by (10.31). For
k = 1, 2, recalling the deﬁnition (10.24) with α = 1 of ρk, let σk := min{θk, ρk}
if m > 1 and σk := θk if m = 1. Again using Proposition 3.52 twice, one can
ﬁnd a Young interval partition {(si−1, si)}n
i=1 of J such that ∥µ∥(si−1,si),(p) ≤
σ1 and ∥ν∥(si−1,si),(1) ≤σ2 for each 1 ≤i ≤n. We can assume that {si}n
i=0 is
a reﬁnement of {tj}m
j=0 and n ≤m + vp(µ; J)/σp
1 + v1(ν; J)/σ2.
Since the partition {si}n
i=0 of J is a reﬁnement of {tj}m
j=0, tj−1 = sij−1 <
· · · < sij = tj for some integers 0 ≤ij−1 < ij ≤n. Let ul := sij−1+l
for l = 0, . . . , k := ij −ij−1, so that u0 = tj−1, and let h(t) := h(u0) for
t ∈(u0, u1). Let H1 := H1,j be the set of all f ∈Wp([a, u1); Z) such that f = h
on [a, u0] and ∥f∥[u0,u1),[p] ≤2Rj. The set H1 is closed in Wp([a, u1); Z) and
nonempty since h ∈H1. Thus H1 is a complete metric space with the metric
d1(f, g) := ∥f −g∥[u0,u1),[p]. By the deﬁnition (10.10) of the integral operator
T ≻
c,a, for each f ∈H1, T ≻
c,af(u0) = T ≻
c,ah(u0) = h(u0), and so ∥T ≻
c,af(u0)∥≤Rj
by hypothesis if j ≥2 and if j = 1, since h(a) = T ≻
c,ah(a) = c and by
deﬁnition of R1. We will apply Lemmas 10.19 and 10.20, both with u = u0
and v = u1. Here (10.24) and (10.31) hold by choice of {si}n
i=0. The hypotheses
in the second sentence of each lemma were veriﬁed around (10.35). By Lemma
10.19(a), with R there equal to Rj here, T ≻
c,a takes the set H1 into itself. Also
for each f ∈H1, letting c1 := T ≻
c,af(u0), by (10.29) with u = u0, we have
T ≻
c,af = T ≻
c1,u0f on [u0, u1).
By deﬁnition of the class H1, for each f ∈H1, we have ∥f∥[u0,u1),[p] ≤2Rj.
We have 2Rj < S = R/3 by (10.38). Thus we have checked all the hypotheses
of Lemma 10.20.
By Lemma 10.20(a), for f1, f2 ∈H1, taking ǫ := (1/2)∥f1 −f2∥[u0,u1),[p],
we have
∥T ≻
c1,u0f1 −T ≻
c1,u0f2∥[u0,u1),[p] = ∥T ≻
0,u0f1 −T ≻
0,u0f2∥[u0,u1),[p]
≤(1/4)∥f1 −f2∥[u0,u1),[p],
(10.39)
and so T ≻
c,a is a contraction for d1. Thus by the Banach ﬁxed point theorem
(Theorem 10.21), there is a unique function
h1 ∈H1 such that T ≻
c,ah1 = h1 on [a, u1).
(10.40)
In particular, h1(tj−1) = T ≻
c,ah1(tj−1) = T ≻
c,ah(tj−1) = h(tj−1). Suppose that
there is another function g in Wp([a, u1); Z) such that T ≻
c,ag = g on [a, u1).
We have that g = h1 = h on [a, u0] since such a function h is unique by
hypothesis. Let u := sup{t ∈[u0, u1): g(t) = h1(t)}, which is deﬁned since
g(u0) = h1(u0). If u = u1 then we are done. Suppose u < u1. We have u = u0,
or u > u0 and g = h1 on [u0, u). In the latter case,
(g −h1)(u) = ∆−(g −h1)(u)
= (Nψg −Nψh1)(u−)·µ({u}) + (Nφg −Nφh1)(u−)·ν({u}) = 0,
by upper continuity of the Kolmogorov integral (Corollary 2.23), and so g(u) =
h1(u). Recall that at the beginning of this proof, θ1 and θ2 were deﬁned by

522
10 Nonlinear Diﬀerential and Integral Equations
(10.31) for R := 3S and S from (10.38). We will choose v > u close enough to
u to satisfy three conditions. First, by Proposition 3.50, the interval function
A 7→vp(µ; A), A ∈I(J), is upper continuous at ∅, so for v ∈(u, u1] close
enough to u we have ∥µ∥(u,v),(p) < θ1. Second, likewise, we can and will make
∥ν∥(u,v),(1) < θ2. Third, by (10.40), we have h1 ∈H1 and so by deﬁnition of
H1, ∥h∥[u0,u1) ≤2Rj. We have 2Rj < S = R/3 by (10.38). Since T ≻
c,ag = g
on [a, u1), by additivity and upper continuity of the Kolmogorov integral
(Proposition 2.22), g is right-continuous on [a, u1). Thus by Proposition 3.42,
limv↓u ∥g∥[u,v],(p) = 0. So by the subadditivity of ∥· ∥(p) over adjoining closed
intervals (3.53), we can and do assume that ∥g∥[u0,v],[p] < S = R/3. This
ﬁnishes the choice of v.
Let ǫ := (1/2)∥g −h1∥[u,v),[p]. We have (g −h1)(t) = T ≻
0,ug(t) −T ≻
0,uh1(t)
for each t ∈[u, u1). By Lemma 10.20(a), it follows that
2ǫ = ∥g −h1∥[u,v),[p] = ∥T ≻
0,ug −T ≻
0,uh1∥[u,v),[p] ≤ǫ/2.
Thus ǫ = 0, and hence g = h1 on [u, v), a contradiction, proving u = u1.
So h1 is the unique function in Wp([a, u1); Z) such that T ≻
c,ah1 = h1.
Now suppose that for some 2 ≤l < k, hl−1 is the unique function in
Wp([a, ul−1); Z) such that T ≻
c,ahl−1 = hl−1 on [a, ul−1). Also suppose that
hl−1(u0) = h(u0) and ∥hl−1∥[u0,ul−1),[p] ≤2Rj, which hold for l = 2 as shown
above. Let hl−1(t) := hl−1(ul−1−) for t ∈[ul−1, ul), and let Hl be the set of
all f ∈Wp([a, ul); Z) such that f = hl−1 on [a, ul−1) and ∥f∥[u0,ul),[p] ≤2Rj.
The set Hl is closed in Wp([a, ul); Z) and nonempty since hl−1 ∈Hl. Thus Hl
is a complete metric space with the metric dl(f, g) := ∥f −g∥[ul−1,ul),[p]. Note
that if f ̸= g in Hl, since f ≡g ≡hl on [a, ul−1), we have f ̸= g somewhere
in [ul−1, ul). By the deﬁnition (10.10) of the integral operator T ≻
c,a, for each
f ∈Hl, T ≻
c,af(u0) = T ≻
c,ah(u0) = h(u0), and so ∥T ≻
c,af(u0)∥≤Rj. Thus by
Lemma 10.19(a), T ≻
c,a takes the set Hl into itself. By deﬁnition of the class Hl,
for each f ∈Hl, we have ∥f∥[ul−1,ul),[p] ≤2Rj. We have 2Rj < S = R/3 by
(10.38). Also all the functions in Hl have the same value cl := T ≻
c,ahl−1(ul−1)
at ul−1, and so by (10.29) with u = ul−1, we have T ≻
c,af = T ≻
cl,ul−1f on
[ul−1, ul) for each f ∈Hl.
By (10.39) with cl in place of c1, [ul−1, ul) in place of [u0, u1) and f1, f2 ∈
Hl, T ≻
c,a is a contraction for dl. Thus by the Banach ﬁxed point theorem
(Theorem 10.21), there is a unique function hl ∈Hl such that T ≻
c,ahl = hl
on [a, ul). In particular, hl(tj−1) = T ≻
c,ahl(tj−1) = T ≻
c,ah(tj−1) = h(tj−1). It
follows as in the case l = 1 that hl is the unique such function in Wp([a, ul); Z).
By induction, there is a unique function g ∈Wp([a, tj); Z) such that T ≻
c,ag = g,
and ∥g∥[tj−1,tj),[p] ≤Rj. Let
g(tj) := g(tj−) + (Nψg)(tj−)·µ({tj}) + (Nφg)(tj−)·ν({tj})
= g(tj−) + ∆−(T ≻
c,ag)(tj) = (T ≻
c,ag)(tj),

10.3 Existence and Uniqueness
523
where the second equality holds by Corollary 2.23. Then T ≻
c,ag = g on [a, tj]
and ∥g∥[tj−1,tj],[p] ≤Rj+1 by (10.37), proving the lemma.
2
Now returning to the proof of Theorem 10.7, let h(a) := c = T ≻
c,ah(a).
Recall that Rj are deﬁned after (10.37). Since the p-variation on a singleton
is zero, ∥h∥{a},[p] = ∥h(a)∥≤R1. By Lemma 10.22 with j = 1, there is
a unique function g1 ∈Wp([a, t1]; Z) such that T ≻
c,ag1 = g1, and we have
∥g1∥[p] ≤R2. Suppose that for some 2 ≤j < m, there is a unique function
gj−1 in Wp([a, tj−1]; Z) such that T ≻
c,agj−1 = gj−1 and ∥gj−1∥[tr−1,tr],[p] ≤
Rr+1 for r = 1, . . . , j −1. Then by Lemma 10.22 with h = gj−1, there is
a unique function gj ∈Wp([a, tj]; Z) such that T ≻
c,agj = gj, and we have
∥gj∥[tj−1,tj],[p] ≤Rj+1.
Also since gj = gj−1 on [a, tj−1], ∥gj∥[tr−1,tr],[p] ≤Rr+1 for r = 1, . . . , j −1
as well as r = j. Now a unique solution f = gm of the integral equation (10.5)
in Wp(J; Z) exists by induction.
To prove the existence of a unique solution of the integral equation (10.6)
in Wp(J; Z), let Q≻
c,a be the integral operator deﬁned by (10.11). By additivity
of the Kolmogorov integral over adjoining disjoint intervals (Theorem 2.21),
and then by Corollary 2.23, for a ≤u < b, we have
∥∆+Q≻
c,af(u)∥= lim
v↓u

R=
[u,v)
(Nψf)·dµ + R=
[u,v)
(Nφf)·dν

= ∥(Nψf)(u)·µ({u}) + (Nφf)(u)·ν({u})∥
≤H{H1(ψ)∥f(u)∥+ ∥Nψ(0)∥sup + ∥φ∥Gβ(1 + ∥f(u)∥β)}
≤W + V ∥f(u)∥
for V and W deﬁned by (10.33) and H just after it. Thus assuming Q≻
c,af(u) =
f(u), we have
∥Q≻
c,af(u+)∥≤∥Q≻
c,af(u)∥+ ∥∆+Q≻
c,af(u)∥≤W + (1 + V )∥f(u)∥. (10.41)
Let R0 := max{1, ∥c∥} and let Rj := W + (1 + V )2Rj−1 for j = 1, . . . , m. Let
F be the set of all f : J →Z such that f(a) = c and ∥f∥(tj−1,tj],[p] ≤2Rj for
j = 1, . . . , m. By Corollary 3.43(b), for a ≤u < v ≤b, we have
∥f∥[u,v],[p] ≤∥f(u)∥+ ∥∆+f(u)∥+ ∥f∥(u,v],[p].
Then ∥f∥[tj−1,tj],[p] ≤4Rj−1 +4Rj for each f ∈F and j = 1, . . . , m. Applying
subadditivity of ∥· ∥(p) and thus of ∥· ∥[p] over closed, adjoining intervals
(Proposition 3.35(a)) recursively, it follows that
∥f∥J,[p] ≤
m
X
j=1
∥f∥[tj−1,tj],[p] ≤4R0 + 8
m−1
X
j=1
Rj + 4Rm =: S < ∞
(10.42)
for each f ∈F.
Here we will use another lemma.

524
10 Nonlinear Diﬀerential and Integral Equations
Lemma 10.23. Let j ∈{1, . . . , m}. Suppose that there is a unique function
h in Wp([a, tj−1]; Z) such that Q≻
c,ah = h, and that ∥h∥(tr−1,tr],[p] ≤2Rr for
r = 1, . . . , j −1 if j ≥2. Then there is a unique function g ∈Wp([a, tj]; Z)
such that Q≻
c,ag = g, and we have ∥g∥(tj−1,tj],[p] ≤2Rj.
Proof. Again let R := 3S. For this value of R, let θ1 and θ2 be deﬁned by
(10.31). For k = 1, 2, recalling the deﬁnition (10.24) with α = 1 of ρk, let
σk := min{θk, ρk} if m > 1 and σk := θk if m = 1. Again using Proposition
3.52 twice, one can ﬁnd a Young interval partition {(si−1, si)}n
i=1 of J such
that ∥µ∥(si−1,si),(p) ≤σ1 and ∥ν∥(si−1,si),(1) ≤σ2 for each 1 ≤i ≤n. We can
assume that {si}n
i=0 is a reﬁnement of {tj}m
j=0 and n ≤m + vp(µ; J)/σp
1 +
v1(ν; J)/σ2. Then for each i = 0, . . . , n −1 and each f, g ∈Wp([si, si+1]; Z)
such that max{∥f∥[p], ∥g∥[p]} ≤S, by Lemma 10.20(b) with ǫ := (1/2)∥f −
g∥(si,si+1],[p], we have
∥Q≻
z,si+f −Q≻
z,si+g∥(si,si+1],[p] = ∥Q≻
0,si+f −Q≻
0,si+g∥(si,si+1],[p]
≤(1/4)∥f −g∥(si,si+1],[p]
(10.43)
for any z ∈Z. Since the partition {si}n
i=0 of J is a reﬁnement of {tj}m
j=0,
tj−1 = sij−1 < · · · < sij = tj for some integers 0 ≤ij−1 < ij ≤n. Let ul :=
sij−1+l for l = 0, . . . , k := ij −ij−1, so that u0 = tj−1, and let h(t) := h(u0)
for t ∈(u0, u1]. Let H1 be the set of all f ∈Wp([a, u1]; Z) such that f = h
on [a, u0] and ∥f∥(u0,u1],[p] ≤2Rj. If j = 1, ∥h∥(u0,u1],[p] = ∥c∥(u0,u1],[p] =
∥c∥≤R0 ≤2R1. The set H1 is closed in Wp([a, u1]; Z) and nonempty since
h ∈H1. Thus H1 is a complete metric space with the metric d1(f, g) :=
∥f −g∥(u0,u1],[p]. Moreover, for each f ∈H1, ∥f∥[a,u1],[p] ≤R/3 by (10.42). We
have ∥h(u0)∥≤2Rj−1 by hypothesis if j ≥2, and since h(a) = Q≻
c,ah(a) = c if
j = 1. Thus ∥Q≻
c,af(u0+)∥≤Rj for each f ∈H1 by (10.41) and the deﬁnition
of Rj. Also since Q≻
c,af = Q≻
c,ah = h on [a, u0], the integral transform Q≻
c,a
takes H1 into itself by Lemma 10.19(b), with R there equal to Rj here. We
have c1 := Q≻
c,ah(u0+) = Q≻
c,af(u0+) for each f ∈H1, and so by (10.30)
with u = u0, Q≻
c,af = Q≻
c1,u0+f on (u0, u1] for each f ∈H1. By (10.43) with
z = c1, Q≻
c,a is a contraction for d1, and so by the Banach ﬁxed point theorem
(Theorem 10.21), there is a unique function h1 ∈H1 such that Q≻
c,ah1 = h1
on [a, u1]. In particular, ∥h1(tj−1)∥= ∥h(tj−1)∥≤2Rj−1. Suppose that there
is another function f in Wp([a, u1]; Z) such that Q≻
c,af = f on [a, u1]. We have
that f = h1 = h on [a, u0] since such a function h is unique by hypothesis. Let
u := sup{t ∈[u0, u1]: f(t) = h1(t)}, which is deﬁned since f(u0) = h1(u0).
Then u = u0, or u > u0 and f = h1 on [a, u). In the latter case, by the
deﬁnition (10.11) of Q≻
a,c, we also have f(u) = Q≻
c,af(u) = Q≻
c,ah1(u) = h1(u).
If u = u1 then we are done. Suppose u < u1. Recall that now θ1 and θ2
are deﬁned by (10.31) for R := 3S and S from (10.42). By Proposition 3.50,
there exists v ∈(u, u1] such that ∥µ∥(u,v),(p) < θ1 and ∥ν∥(u,v),(1) < θ2. Let
ǫ := (1/2)∥f −h1∥(u,v],[p]. We have (f −h1)(t) = Q≻
0,u+f(t) −Q≻
0,u+h1(t) for
each t ∈(u, u1]. By Lemma 10.20(b), it follows that

10.3 Existence and Uniqueness
525
2ǫ = ∥f −h1∥(u,v],[p] = ∥Q≻
0,u+f −Q≻
0,u+h1∥(u,v],[p] ≤ǫ/2.
Thus ǫ = 0, and hence f = h1 on (u, v], a contradiction, proving u = u1, and
so h1 is the unique function in Wp([a, u1]; Z) such that Q≻
c,ah1 = h1.
Now suppose that for some 2 ≤l < k, hl−1 is the unique function in
Wp([a, ul−1]; Z) such that Q≻
c,ahl−1 = hl−1. Also suppose that ∥hl−1(u0)∥≤
2Rj−1 and ∥hl−1∥(u0,ul−1],[p] ≤2Rj, which hold for l = 2 as shown above.
Let hl−1(t) := hl−1(ul−1) for t ∈(ul−1, ul], and let Hl be the set of all
f ∈Wp([a, ul]; Z) such that f = hl−1 on [a, ul−1] and ∥f∥(tj−1,ul],[p] ≤2Rj.
The set Hl is closed in Wp([a, ul]; Z) and nonempty since hl−1 ∈Hl. Thus Hl
is a complete metric space with the metric dl(f, g) := ∥f −g∥(ul−1,ul],[p]. For
each f ∈Hl, ∥f∥[a,ul],[p] ≤R/3 by (10.42). Also for each f ∈Hl, f = hl−1 on
[a, ul−1] implies ∥f(u0)∥≤2Rj−1, and so ∥Q≻
c,af(u0+)∥≤Rj by (10.41) and
the deﬁnition of Rj. Thus the integral transform Q≻
c,a takes Hl into itself by
Lemma 10.19(b), with R there equal to Rj here, and since Q≻
c,af = hl−1 on
[a, ul−1]. All the functions in Hl have the same value cl := Q≻
c,ah(ul−1+) at
ul−1+, and so by (10.30) with u = ul−1, Q≻
c,af = Q≻
cl,ul−1+f on (ul−1, ul] for
each f ∈Hl. By (10.43) with z = cl, Q≻
c,a is a contraction for dl, and so by the
Banach ﬁxed point theorem (Theorem 10.21), there is a function hl ∈Hl such
that Q≻
c,ahl = hl on [a, ul]. It follows as in the case l = 1 that hl is the unique
such function in Wp([a, ul]; Z). We have ∥hl∥(u0,ul],[p] ≤2Rj by deﬁnition of
Hl. The conclusion of the lemma now follows by induction.
2
Now to ﬁnish the proof of Theorem 10.7, let h(a) := c = Q≻
c,ah(a). By
Lemma 10.23 with j = 1, there is a unique function g1 ∈Wp([a, t1]; Z) such
that Q≻
c,ag1 = g1 and ∥g1∥(a,t1],[p] ≤2R1. Suppose that for some 2 ≤j < m,
there is a unique function gj−1 in Wp([a, tj−1]; Z) such that Q≻
c,agj−1 = gj−1
and ∥g∥(tr−1,tr],[p] ≤2Rr for r = 1, . . . , j −1. Then by Lemma 10.23 with
h = gj−1, there is a unique function gj ∈Wp([a, tj]; Z) such that Q≻
c,agj = gj,
and we have ∥gj∥(tj−1,tj],[p] ≤2Rj. Now a unique solution f = gm of the
integral equation (10.6) in Wp(J; Z) exists by induction.
To prove the existence of a solution of the backward integral equation
(10.7) we use a change of variables for the Kolmogorov integral as follows.
The function θ(t) := a+b−t takes [a, b] 1-to-1 onto itself, homeomorphically,
interchanging a and b, with θ ≡θ−1 on [a, b]. Let eµ := µ◦θ−1, eν := ν◦θ−1,
eψ(z, t) := ψ(z, θ(t)), and eφ(z, t) := φ(z, θ(t)) for a ≤t ≤b and z ∈Z. It
is easy to check that eµ, eν, eψ, and eφ satisfy the hypotheses of the present
theorem, and so by the ﬁrst part of the proof there exists a solution ef of the
integral equation
ef(t) = c + R=
(a,t]
(N e
ψ ef)−·deµ + R=
(a,t]
(Neφ ef)−·deν,
a ≤t ≤b.
(10.44)
Let f(t) := ef(θ(t)) for a ≤t ≤b. Then f(b) = c and for a ≤t < b,

526
10 Nonlinear Diﬀerential and Integral Equations
f(t) = c +
R
=
(a,a+b−t]
eψ( ef(s), s)−·deµ(s) +
R
=
(a,a+b−t]
eφ( ef(s), s)−·deν(s).
Now for the ﬁrst integral on the right side, we have
R
=
(a,a+b−t]
eψ( ef(s), s)−·deµ(s)
=
R
=
(a,a+b−t]
ψ(f(a + b −s), a + b −s)−·deµ(s)
(10.45)
=
R
=
[t,b)
ψ(f(u), u)+·dµ(u) =
R
=
[t,b)
(Nψf)+·dµ
by a change of variables for Kolmogorov integrals, Proposition 2.30. Similarly,
for the second integral it follows that for a ≤t < b,
R
=
(a,a+b−t]
eφ( ef(s), s)−·deν(s) =
R
=
[t,b)
(Nφf)+·dν.
(10.46)
Thus f is a solution of the backward integral equation (10.7). To show its
uniqueness in Wp(J; Z), let g be another solution of (10.7), and let eg(t) :=
g(θ(t)) for a ≤t ≤b. Again using a change of variables for Kolmogorov
integrals it follows that eg is a solution of (10.44). Since eg ̸= ef, this contradicts
the uniqueness of the solution of (10.44), shown in the ﬁrst part of the proof.
This contradiction proves uniqueness in Wp(J; Z) of a solution of (10.7).
The same argument based on the use of a change of variables for Kol-
mogorov integrals proves that the backward integral equation (10.8) has a
unique solution in Wp(J; Z). The proof of Theorem 10.7 is complete.
2
The existence and uniqueness of solutions of the integral equations deﬁned
by autonomous Nemytskii operators follow just by verifying the assumptions
of Theorem 10.7 as follows.
Proof of Corollary 10.8. Let ψ(z, s) ≡F(z) and φ(z, s) ≡G(z). By Exam-
ple 10.16 with h ≡1 and α = 1 there, statement (a) of Proposition 10.15 with
α = 1 holds for ψ, that is (10.9) holds with C = 0 for each 0 ≤K < ∞, and
so ψ ∈HWG1,p(Z ×J; X) by Deﬁnition 10.3 with α = 1 and q = p. Returning
to α ∈(0, 1] in the statement of Corollary 10.8, since Wα,q(ψ(1)
u , K) ≡0 with
q = p/α for each 0 ≤K < ∞, ψ(1)
u
∈HWloc
α,q(Z × J; L(Z; X)) by Deﬁni-
tions 6.47 and 6.51. Since clearly φ ∈UGβ(Z × J; X) ∩UHloc
1
(Z × J; X) and
φ(z, ·) ∈R(J; X) for each z ∈Z, all the hypotheses on ψ and φ of Theorem
10.7 hold, and so the conclusion follows.
2

10.4 Boundedness and Convergence of Picard Iterates
527
10.4 Boundedness and Convergence of Picard Iterates
Before proving Theorem 10.11, we will show that the four sequences of Picard
iterates deﬁned by (10.12), (10.13), (10.16), and (10.17) are uniformly bounded
in n with respect to the p-variation norm for ψ and φ as in Lemma 10.19.
Proposition 10.24. Let α, β ∈(0, 1], 1 ≤p < 1 + α, and J := [a, b] with
a < b. Assuming (1.14), let ψ ∈HWGα,p/α(Z × J; X), φ ∈CRGβ(Z × J; X),
µ ∈AIp(J; Y ), and ν ∈AI1(J; Y ). Then there is an integer 1 ≤m ≤
1 + vp(µ; J)/ρp
1 + v1(ν; J)/ρ2, with ρ1 and ρ2 deﬁned by (10.24), such that for
all n = 0, 1, 2, . . .,
max

∥f ≻
n ∥[p], ∥f ≺
n ∥[p]
	
≤C2m+1 1 + 2DH
m
(10.47)
and
max

∥g≻
n ∥[p], ∥g≺
n ∥[p]
	
≤C3m+1 1 + DH
m,
(10.48)
where C := max{1, ∥c∥}, D := Hα(ψ) + ∥Nψ(0)∥sup + 2∥φ∥Gβ, and H :=
supt∈J max{∥µ({t})∥, ∥ν({t})∥}.
Proof. We can assume that either ψ ̸≡0 or φ ̸≡0. Using Proposition 3.52
twice, one can ﬁnd a Young interval partition {(zj−1, zj)}m
j=1 of J = [a, b] such
that vp(µ; (zj−1, zj)) ≤ρp
1 and v1(ν; (zj−1, zj)) ≤ρ2 for each 1 ≤j ≤m, and
m ≤1 + vp(µ; J)/ρp
1 + v1(ν; J)/ρ2 since the intersections of m1 disjoint open
intervals and m2 such intervals yield at most m1 + m2 −1 intervals.
Let {fn}n≥0 be either of the two sequences of forward Picard iterates {f ≻
n }
or {g≻
n }. We will show that for j = 1, . . . , m,
Aj,n :=
fn

[zj−1,zj],[p] ≤CAj
for n = 0, 1, 2, . . .,
(10.49)
where A = 2(1 + 2DH) if {fn} is {f ≻
n } and A = 3(1 + DH) if {fn} is {g≻
n }.
Assuming that (10.49) holds, and applying Proposition 3.35(a) recursively, it
will follow that ∥fn∥[a,b],[p] ≤Pm
j=1 Aj,n ≤2CAm for each n = 0, 1, 2, . . .,
which is (10.47) and implies (10.48) for the two sequences of forward Picard
iterates.
To prove (10.47) and (10.48) for the two sequences of backward Picard it-
erates we use a time reversal for the Kolmogorov integral as in (10.44) through
(10.46). Recall the function θ(t) := a+b−t taking [a, b] one-to-one onto itself,
and that eµ ≡µ◦θ−1, eν ≡ν◦θ−1, eψ(z, t) ≡ψ(z, θ(t)), and eφ(z, t) ≡φ(z, θ(t))
for a ≤t ≤b and z ∈Z. Let { ˜f ≻
n } be the sequence of Picard iterates obtained
by the integral transform T ≻
c,a,eµ,eν and eψ, eφ. It is easy to check that eµ, eν, eψ,
and eφ satisfy the hypotheses of the present theorem, and so (10.47) holds for
{ ˜f ≻
n } in place of {f ≻
n }. For n = 1, 2 . . ., let hn(t) := ˜f ≻
n (θ(t)), t ∈J, and let
h0 := c. Then as in (10.45) and (10.46), it follows that for n = 1, 2, . . . and
each t ∈J,
hn(t) = c +
R
=
[t,b)
(Nψhn−1)+·dµ +
R
=
[t,b)
(Nφhn−1)+·dν.

528
10 Nonlinear Diﬀerential and Integral Equations
Thus {hn}n≥0 is the sequence {f ≺
n }n≥0 of backward Picard iterates obtained
by the integral transform T ≺
c,b,µ,ν and ψ, φ. Since the change of variables θ
does not change the p-variation, ∥f ≺
n ∥[p] = ∥˜f ≻
n ∥[p] for each n, and so (10.47)
holds. The same argument applies to the second sequence of backward Picard
iterates, proving (10.48).
To prove (10.49), ﬁrst let {fn} be {f ≻
n } and A = 2(1 + 2DH). Note that
∥f ≻
0 ∥[p] = ∥c∥≤C and A ≥1. Thus it is enough to bound Aj,n for each
j ∈{1, . . . , m} and n ≥1. By (10.36) with g = f ≻
n and [u, v] = [zj−1, zj], we
have
Aj,n ≤∥f ≻
n ∥[zj−1,zj),[p] + 2∥∆−f ≻
n (zj)∥.
(10.50)
Recalling Deﬁnitions 6.47 and 10.3 and Remark 10.4, we have that ψ ∈
HWα,p/α(Z × J; X). By Deﬁnition 10.5, we have φ ∈UCR(Z × J; X), so
the hypotheses of Proposition 10.9(b) hold. It follows that the integral trans-
form T ≻
c,a takes Wp([a, b]]; Z) into itself. Iterating, we see that the Kolmogorov
integrals in the deﬁnition of each f ≻
n are deﬁned. Thus by Corollary 2.23 ap-
plied twice, and then by additivity of the Kolmogorov integral over adjoining
disjoint intervals one of which here is A2 = {t} (Theorem 2.21), for each
t ∈(a, b],
∥∆−f ≻
n (t)∥= ∥(Nψf ≻
n−1)(t−)·µ({t}) + (Nφf ≻
n−1)(t−)·ν({t})∥
(10.51)
≤
 Hα(ψ)∥f ≻
n−1(t−)∥α+∥Nψ(0)∥sup+∥φ∥Gβ(1+∥f ≻
n−1(t−)∥β)

H,
since ψ is s-uniformly α-H¨older and since φ satisﬁes the s-uniform β growth
condition, Deﬁnition 10.5. Applying this bound to (10.50), we get that for
each j ∈{1, . . . , m} and n ≥1,
Aj,n ≤∥f ≻
n ∥[zj−1,zj),[p] + 2DH max{1, ∥f ≻
n−1∥[zj−1,zj),sup}.
(10.52)
Using this relation and Lemma 10.19(a), the claim (10.49) will be proved by
induction on j. For j = 1, let u = a, v = z1, R = C, and f = f ≻
n−1. Then
∥T ≻
c,af(u)∥= ∥f ≻
n (a)∥= ∥c∥≤C and ∥f ≻
0 ∥[p] = ∥c∥< 2C. Applying Lemma
10.19(a) recursively in n, it follows that ∥f ≻
n ∥[a,z1),[p] ≤2C for n = 0, 1, 2, . . ..
Since C ≥1, using this bound in (10.52), (10.49) holds for j = 1. Suppose
that (10.49) holds for some 1 ≤j < m. It will then be proved for j + 1.
Let Tj := CAj be the right side of (10.49). Let u = zj, v = zj+1, R = Tj,
and f = f ≻
n−1. By the induction assumption, ∥T ≻
c,af(u)∥= ∥f ≻
n (zj)∥≤Tj for
n = 1, 2, . . . . Also, ∥f ≻
0 (zj)∥= ∥c∥≤Tj and ∥f ≻
0 ∥[zj,zj+1),[p] = ∥c∥≤Tj <
2Tj. Then again applying Lemma 10.19(a) recursively in n, it follows that
∥f ≻
n ∥[zj,zj+1),[p] ≤2Tj for each n = 0, 1, 2, . . .. Using this bound in (10.52)
with j replaced by j + 1 it follows that (10.49) holds with j + 1 instead of
j. Hence by induction, (10.49) holds for all j = 1, . . . , m, when {fn} is the
sequence of Picard iterates {f ≻
n }.
A proof of (10.48) is similar to the preceding proof of (10.47). Recall that
now A = 3(1 + DH) and let {fn} be the sequence {g≻
n }. Now we apply the
inequality

10.4 Boundedness and Convergence of Picard Iterates
529
Aj,n = ∥g≻
n ∥[zj−1,zj],[p]
(10.53)
≤∥g≻
n (zj−1)∥+ ∥∆+g≻
n (zj−1)∥+ ∥g≻
n ∥(zj−1,zj],[p],
which follows using Corollary 3.43(b), for each j ∈{1, . . . , m} and n ≥1. By
additivity and upper continuity of the Kolmogorov integral (Theorem 2.21
and Corollary 2.23), we have for each t ∈[a, b),
∆+g≻
n (t) = (Nψg≻
n−1)(t)·µ({t}) + (Nφg≻
n−1)(t)·ν({t}).
(10.54)
Since ψ is s-uniformly α-H¨older and since φ satisﬁes the s-uniform β growth
condition, we thus have for each t ∈[a, b),
∥∆+g≻
n (t)∥
≤

Hα(ψ)∥g≻
n−1(t)∥α + ∥Nψ(0)∥sup + ∥φ∥Gβ(1 + ∥g≻
n−1(t)∥β)
	
H
≤DH max{1, ∥g≻
n−1(t)∥}.
(10.55)
Again, (10.49) will be proved by induction on j. For j = 1, since ∥g≻
k (a)∥=
∥c∥≤C for each k ≥0, it follows that
∥g≻
n (a+)∥≤∥g≻
n (a)∥+ ∥∆+g≻
n (a)∥≤C(1 + DH) =: T0
(10.56)
holds for each n ≥1. Then using Lemma 10.19(b) for R = T0 recursively in
k ≥0, it follows that for each k = 0, 1, 2, . . .,
∥g≻
k ∥(a,z1],[p] ≤2T0.
(10.57)
Now applying the second inequality in (10.56), and (10.57) with k = n, to
(10.53) with j = 1, we have that A1,n ≤3T0 = CA for each n ≥1. Since
A1,0 = ∥c∥≤C, (10.49) holds for j = 1. Suppose that (10.49) holds for some
1 ≤j < m. It then will be shown to hold for j + 1 in place of j. Letting
Rj := CAj, which is the right side of (10.49), by the induction assumption
(10.49), we have ∥g≻
k (zj)∥≤Rj for each k ≥0. Therefore by (10.55), we have
that
∥g≻
n (zj+)∥≤∥g≻
n (zj)∥+ ∥∆+g≻
n (zj)∥≤Rj(1 + DH) =: Tj
(10.58)
holds for each n ≥1. Using Lemma 10.19(b) for R = Tj recursively in k ≥0,
it follows that for each k = 0, 1, 2, . . .,
∥g≻
k ∥(zj,zj+1],[p] ≤2Tj.
(10.59)
Now applying the second inequality in (10.58), and (10.59) with k = n, to
(10.53) with j + 1 in place of j, it follows that Aj+1,n ≤3Tj = RjA = CAj+1
for each n ≥1. Since Aj+1,0 = ∥c∥≤C, (10.49) holds for j + 1 in place of j.
By induction, (10.49) holds for each j = 1, . . . , m, when {fn} is the sequence
of Picard iterates {g≻
n }. The proof of Proposition 10.24 is complete.
2

530
10 Nonlinear Diﬀerential and Integral Equations
The following is a consequence of Proposition 10.24 when ψ and φ are
autonomous. Recall Deﬁnition 10.5 for the class Gβ.
Corollary 10.25. Let α, β ∈(0, 1], 1 ≤p < 1 + α, and J := [a, b] with
a < b. Assuming (1.14), let F ∈Hα(Z; X), let G ∈Gβ(Z; X) be continuous,
let µ ∈AIp(J; Y ), and let ν ∈AI1(J; Y ). Also let
ρ1 := {16Kp,p/α(∥F(0)∥+ 2∥F∥(Hα))}−1
and
ρ2 := {16∥G∥Gβ}−1,
(10.60)
where Kp,p/α = ζ((1 + α)/p), ρ1 := +∞if F ≡0, and ρ2 := +∞if G ≡0.
Then there is an integer 1 ≤m ≤1 + vp(µ; J)/ρp
1 + v1(ν; J)/ρ2 such that
(10.47) and (10.48) hold except that here D = ∥F(0)∥+ ∥F∥(Hα) + 2∥G∥Gβ.
Proof. We can assume that F ̸≡0 or G ̸≡0. Let ψ(z, s) ≡F(z) and φ(z, s) ≡
G(z). By Example 10.16 with h ≡1, ψ ∈HWGα,p/α(Z×J; X) with Gα,q(ψ) =
0. Also clearly φ ∈CRGβ(Z × J; X). Since F is α-H¨older continuous, by
Lemma 6.22(a), for any a ≤u < v ≤B we have
NF f

(u,v),[p/α] ≤∥F(0)∥+ 2∥F∥(Hα)∥f∥α
(u,v),[p],
and so (10.27) holds with D = ∥F(0)∥+ 2∥F∥(Hα). Since also (10.26) holds
with ∥φ∥Gβ = ∥G∥Gβ it follows that Lemma 10.19 holds with ρ1 and ρ2 in
(10.24) replaced by (10.60). The conclusion then follows from Proposition
10.24.
2
After proving convergence of the four sequences of Picard iterates in the
next proposition, we will then prove Theorem 10.11, showing that the limits
are the unique solutions of the corresponding four nonlinear integral equations.
Recall again the space HWloc
1+α,q as in Deﬁnition 6.61 for n = 1.
Proposition 10.26. Let 0 < α ≤1 ≤p < 1 + α, q := p/α, and J := [a, b]
with a < b. Assuming (1.14), let ψ ∈HWloc
1+α,q(Z × J; X), let φ ∈UHloc
1
(Z ×
J; X) be such that φ(z, ·) ∈R(J; X) for each z ∈Z, let µ ∈AIp(J; Y ), and
let ν ∈AI1(J; Y ). For each of the four sequences of Picard iterates, if it is
bounded in Wp(J; Z) then it converges.
Proof. Let {fn}n≥0 be either of the two sequences of forward Picard iterates.
Let R := 3 supn≥0 ∥fn∥[p] < ∞and let BR be the ball in Z with center at 0 and
radius R. In particular, the range of each fn is in the ball BR. If ψ(z, ·) ≡h1
and φ(z, ·) ≡h2 for each z in BR and some functions h1, h2 : J →X then
fn ≡f1 for each n > 1 and so the conclusion holds. Suppose that either ψ(z, ·)
or φ(z, ·) is non-constant with respect to z ∈BR.
Since ψ ∈HW1+α,q(BR × J; X), it follows from Deﬁnitions 6.61 and 6.47
that ∥ψ(1)
u ∥BR×J,sup ≤∥ψ(1)
u (·, a)∥BR,sup + Wα,q(ψ(1)
u , R) < ∞. Thus by the
mean value theorem (5.2), ψ is s-uniformly Lipschitz on BR with H1(ψ; BR ×
J, X) ≤∥ψ(1)
u ∥BR×J,sup. Also, since φ ∈UHloc
1
(Z × J; X), we have

10.4 Boundedness and Convergence of Picard Iterates
531
C := H1(ψ; BR × J, X) + H1(φ; BR × J, X) < ∞.
(10.61)
Let θ1 and θ2 be deﬁned by (10.31), with R as deﬁned in this proof. Then
0 < θj < ∞for j = 1, 2. Using Proposition 3.52, one can ﬁnd a Young
interval partition {(tj−1, tj)}m
j=1 of J such that vp(µ; (tj−1, tj)) ≤θp
1 and
v1(ν; (tj−1, tj)) ≤θ2 for each 1 ≤j ≤m, and m ≤1 + vp(µ; J)/θp
1 +
v1(ν; J)/θ2.
Let E := ∥f1∥(p), H := supt∈(a,b] max{∥µ({t})∥, ∥ν({t})∥}, and A := 1 +
4CH. We claim that for each j = 1, . . . , m,
Aj,n :=
fn+1 −fn

Jj,[p] ≤2−n(2A)jE =: Bj,n
for n = 0, 1, . . . ,
(10.62)
where Jj := [tj−1, tj]. Assuming that the claim holds, and applying Proposi-
tion 3.35(a) recursively, it follows that
fn+1 −fn

J,[p] ≤
m
X
j=1
fn+1 −fn

Jj,[p] ≤2−n+1(2A)mE
for each n = 0, 1, . . .. Therefore {fn}n≥0 is a Cauchy sequence in Wp(J; Z),
and so by Proposition 3.7(d), it converges to some function in Wp(J; Z),
proving the conclusion for the two sequences of forward Picard iterates. The
same conclusion follows for the two sequences of backward Picard iterates by
applying time reversal for Kolmogorov integrals as in the proof of Proposition
10.24.
First suppose that {fn} is {f ≻
n }. For each n = 0, 1, 2, . . . and u ∈J, let
∆u,n :=
 T ≻
0,uf ≻
n −T ≻
0,uf ≻
n−1 if n ≥1,
T ≻
0,uf ≻
0
if n = 0,
(10.63)
where T ≻
0,uf is deﬁned by (10.10) with c = 0.
The claim (10.62) will be proved by induction on j. Before starting the
induction we show that for each j ∈{1, . . . , m} and n ≥1,
Aj,n = ∥∆a,n∥Jj,[p] ≤
∆a,n(tj−1)
 +
∆tj−1,n

[tj−1,tj),[p]
(10.64)
+ 2CH
n∆a,n−1(tj−1)
 +
∆tj−1,n−1

[tj−1,tj),(p)
o
.
For a function g ∈Wp(J; Z) and a ≤u < v ≤b, since ∥g∥[u,v),sup ≤∥g(u)∥+
∥g −g(u)∥[u,v),sup, by (10.36) we have
∥g∥[u,v],[p] ≤∥g(u)∥+ ∥g −g(u)∥[u,v),[p] + 2∥∆−g(v)∥.
(10.65)
Let j ∈{1, . . . , m} and n ≥1. Applying (10.65) to g = ∆a,n = f ≻
n+1 −f ≻
n ,
u = tj−1 and v = tj, since g −g(tj−1) = ∆tj−1,n on [tj−1, tj) by (10.29), it
follows that
∥∆a,n∥Jj,[p] ≤∥∆a,n(tj−1)∥+∥∆tj−1,n∥[tj−1,tj),[p]+2∥∆−(f ≻
n+1−f ≻
n )(tj)∥.
(10.66)

532
10 Nonlinear Diﬀerential and Integral Equations
As in (10.51), we have
∥∆−(f ≻
n+1 −f ≻
n )(tj)∥
= ∥(Nψf ≻
n −Nψf ≻
n−1)(tj−)·µ({tj}) + (Nφf ≻
n −Nφf ≻
n−1)(tj−)·ν({tj})∥
≤H

∥Nψf ≻
n −Nψf ≻
n−1∥[tj−1,tj),sup + ∥Nφf ≻
n −Nφf ≻
n−1∥[tj−1,tj),sup

.
For tj−1 ≤s < tj we have
∥(Nψf ≻
n −Nψf ≻
n−1)(s)∥≤H1(ψ; BR × J, X)∥(f ≻
n −f ≻
n−1)(s)∥
and likewise for the term with φ. Thus using notation (10.61), it follows that
∥∆−(f ≻
n+1 −f ≻
n )(tj)∥≤CH∥(f ≻
n −f ≻
n−1)∥[tj−1,tj),sup.
(10.67)
To bound the right side, we have by deﬁnition (10.12) of f ≻
n , also for n replaced
by n −1, and for n ≥2 by (10.29) for f = f ≻
n−1 and f ≻
n−2, that
(f ≻
n −f ≻
n−1)(s) = ∆tj−1,n−1(s) + ∆a,n−1(tj−1)
for each s ∈[tj−1, tj). The same holds for n = 1 by the deﬁnitions. Since
clearly T ≻
0,uf(u) = 0 for any f and u by deﬁnition (10.10) of T ≻
c,u, we have
∥∆u,k∥[u,t),sup ≤∥∆u,k∥[u,t),(p)
for any a ≤u < t ≤b and k ≥1. Thus
∥f ≻
n −f ≻
n−1∥[tj−1,tj),sup ≤∥∆a,n−1(tj−1)∥+ ∥∆tj−1,n−1∥[tj−1,tj),(p).
Applying this bound to (10.67) gives
∥∆−(f ≻
n+1 −f ≻
n )(tj)∥≤CH
n∆a,n−1(tj−1)
 +
∆tj−1,n−1

[tj−1,tj),(p)
o
.
By the preceding bound and (10.66), it follows that (10.64) holds.
To begin the proof of (10.62) by induction on j, let j = 1. We claim that
for each k = 0, 1, 2, . . .,
∆a,k

[a,t1),[p] ≤2−k+1E.
(10.68)
The claim will be proved by induction on k. For k = 0, we have
∥∆a,0∥[a,t1),[p] ≤2∥f ≻
1 ∥[a,t1),(p) ≤2E.
Suppose (10.68) holds for some k ≥0. To prove it for k + 1 we use Lemma
10.20(a) with g = f ≻
k+1, f = f ≻
k , u = a, v = t1, and ǫ = 2−k+1E. We have
∥g −f∥[u,v),[p] = ∥∆a,k∥[a,t1),[p] ≤ǫ ≤2ǫ by the induction assumption. Thus
by Lemma 10.20(a),
∥∆a,k+1∥[a,t1),[p] = ∥T ≻
0,ug −T ≻
0,uf∥[u,v),[p] ≤ǫ/2 = 2−kE.

10.4 Boundedness and Convergence of Picard Iterates
533
Therefore (10.68) holds with k+1 in place of k, and hence for all k = 0, 1, 2, . . .,
as desired. For n ≥1, applying (10.64) with j = 1, then (10.68) with k =
n, n −1, since (f ≻
k −f ≻
k−1)(a) = 0 for each k ≥1, it follows that
A1,n ≤0 + ∥∆a,n∥[a,t1),[p] + 2CH

0 + ∥∆a,n−1∥[a,t1),(p)
	
≤2−n+1E + 2CH2−n+2E = 2−n+1EA = B1,n.
For n = 0, we have
A1,0 ≤2∥f ≻
1 ∥J1,(p) ≤2E ≤B1,0.
Thus (10.62) holds for j = 1. Now suppose (10.62) holds for some 1 ≤j < m.
It then will be shown to hold for j + 1 in place of j. We claim that for each
k = 0, 1, 2, . . .,
∆tj,k

[tj,tj+1),[p] ≤Bj,k.
(10.69)
Again the claim will be proved by induction on k. For k = 0, we have
∥∆tj,0∥[tj,tj+1),[p] = ∥T ≻
0,tjf ≻
0 ∥[tj,tj+1),[p] ≤2∥f ≻
1 ∥[a,tj+1),(p) ≤2E ≤Bj,0.
Suppose (10.69) holds for some k ≥0. To prove it for k + 1 we use Lemma
10.20(a) again, now with g = f ≻
k+1, f = f ≻
k , u = tj, v = tj+1, and ǫ = Bj,k.
By the induction assumption on j, that is, by (10.62), we have
∥(g −f)(u)∥= ∥(f ≻
k+1 −f ≻
k )(tj)∥≤Aj,k ≤Bj,k.
By the induction assumption on k, that is by (10.69), and by (10.29) for
f = f ≻
k and if k ≥1 for f ≻
k−1, we have
∥g −f∥[u,v),[p] ≤∥(g −f)(u)∥+ ∥∆tj,k∥[tj,tj+1),[p] ≤2Bj,k = 2ǫ.
For k = 0 the same can be seen directly. Thus by Lemma 10.20(a),
∥∆tj,k+1∥[tj,tj+1),[p] = ∥T ≻
0,ug −T ≻
0,uf∥[u,v),[p] ≤ǫ/2 = Bj,k+1.
Therefore (10.69) holds with k+1 in place of k, and hence for all k = 0, 1, 2, . . ..
By (10.64) with j + 1 in place of j, by assumption (10.62) of the induction on
j, and by (10.69) with k = n, n −1, it follows that for each n ≥1,
Aj+1,n ≤Aj,n + ∥∆tj,n∥[tj,tj+1),[p] + 2CH
n
Aj,n−1 + ∥∆tj,n−1∥[tj,tj+1),(p)
o
≤2Bj,n + 4CHBj,n−1 = 2Bj,n(1 + 4CH) = Bj+1,n.
Since for n = 0,
Aj+1,0 =
f ≻
1 −f ≻
0

Jj+1,[p] ≤2∥f ≻
1 ∥(a,tj+1],(p) ≤2E ≤Bj+1,0,
(10.62) holds for j + 1 in place of j. By induction on j, (10.62) holds for each
j = 1, . . . , m, proving that claim when {fn} is {f ≻
n }.

534
10 Nonlinear Diﬀerential and Integral Equations
Now, suppose that {fn} is {g≻
n }. For each n = 0, 1, 2, . . . and u ∈[a, b], let
∆u,n :=
 Q≻
0,ug≻
n −Q≻
0,ug≻
n−1 if n ≥1
Q≻
0,ug≻
0
if n = 0,
(10.70)
where Q≻
0,uf is deﬁned by (10.11) with c = 0, and so ∆a,n = g≻
n+1 −g≻
n for
all n ≥0. Let j ∈{1, . . . , m} and n ≥1. For each t ∈(tj−1, tj], by (10.30) we
have
∆a,n(t) = ∆a,n(tj−1) + ∆tj−1,n(tj−1+) + ∆tj−1+,n(t).
(10.71)
Therefore
∥∆a,n∥Jj,sup ≤∥∆a,n(tj−1)∥+∥∆tj−1,n(tj−1+)∥+∥∆tj−1+,n∥(tj−1,tj],sup.
(10.72)
By the second statement in Corollary 3.43(b) we have
∥∆a,n∥Jj,(p) ≤∥∆+(∆a,n)(tj−1)∥+ ∥∆a,n∥(tj−1,tj],(p).
Here ∥∆a,n∥(tj−1,tj],(p) = ∥∆tj−1+,n∥(tj−1,tj],(p) because in (10.71) the ﬁrst two
terms on the right do not depend on t. Also by (10.71) we have
∆+(∆a,n)(tj−1)=∆a,n(tj−1)+∆tj−1,n(tj−1+)+∆tj−1+,n(tj−1+)−∆a,n(tj−1),
which equals ∆tj−1,n(tj−1+) because ∆tj−1+,n(tj−1+) = 0. It follows that
∥∆a,n∥Jj,(p) ≤∥∆tj−1,n(tj−1+)∥+ ∥∆tj−1+,n∥(tj−1,tj],(p).
(10.73)
By additivity and upper continuity of the Kolmogorov integral (Theorem 2.21
and Corollary 2.23), as in (10.54), for any t ∈[a, b),
∆t,n(t+) =

Nψg≻
n −Nψg≻
n−1

(t)·µ({t}) +

Nφg≻
n −Nφg≻
n−1

(t)·ν({t}).
(10.74)
By (10.61), it follows as just before (10.67) that
∥∆tj−1,n(tj−1+)∥≤CH∥∆a,n−1(tj−1)∥.
(10.75)
Adding the two inequalities (10.72) and (10.73), and applying the preceding
bound, gives
Aj,n ≤∥∆a,n(tj−1)∥+ 2CH∥∆a,n−1(tj−1)∥+ ∥∆tj−1+,n∥(tj−1,tj],[p]. (10.76)
To begin the proof of (10.62) by induction on j, let j = 1. We claim that for
each k = 0, 1, 2, . . .,
∥∆a+,k∥(a,t1],[p] ≤2−k+1E.
(10.77)
The claim will be proved by induction on k. For k = 0, we have
∥∆a+,0∥(a,t1],[p] ≤2∥g≻
1 ∥(a,t1],(p) ≤2E,

10.4 Boundedness and Convergence of Picard Iterates
535
recalling that E = ∥f1∥(p) where now f1 = g≻
1 . Suppose (10.77) holds for some
k ≥0. To prove it for k + 1 we use Lemma 10.20(b) with g = g≻
k+1, f = g≻
k ,
u = a, v = t1, and ǫ = 2−k+1E. If k ≥1, since g≻
k (a) = g≻
k−1(a) = c, and
so ∆a,k(a+) = 0 by (10.74) with t = a and n = k, we have ∥g −f∥(u,v],[p] =
∥∆a+,k∥(a,t1],[p] ≤ǫ ≤2ǫ by the induction assumption. If k = 0, we have
∥g −f∥(u,v],[p] = ∥g≻
1 −g≻
1 (a)∥(a,t1],[p] ≤2∥g≻
1 ∥(p) ≤ǫ ≤2ǫ. Thus by Lemma
10.20(b),
∥∆a+,k+1∥(a,t1],[p] = ∥Q≻
0,a+g −Q≻
0,a+f∥(u,v],[p] ≤ǫ/2 = 2−kE.
Therefore (10.77) holds with k+1 in place of k, and hence for all k = 0, 1, 2, . . ..
For n ≥1, applying (10.76) with j = 1, then (10.77) with k = n, since
∆a,k(a) = 0 for each k ≥0, it follows that A1,n ≤2−n+1E ≤B1,n. For n = 0,
we have
A1,0 ≤2∥g≻
1 ∥J1,(p) ≤2E ≤B1,0.
Thus (10.62) holds for j = 1. Now, suppose (10.62) holds for some 1 ≤j < m.
It then will be shown to hold for j + 1 in place of j. We claim that for each
k = 0, 1, 2, . . .,
∆tj+,k

(tj,tj+1],[p] ≤(1 + 2CH)Bj,k.
(10.78)
Again the claim will be proved by induction on k. For k = 0, we have
∥∆tj+,0∥(tj,tj+1],[p] ≤2∥g≻
1 ∥(tj,tj+1],(p) ≤2E,
so (10.78) holds in this case. Suppose (10.78) holds for some k ≥0. To prove
it for k + 1 we use Lemma 10.20(b) with g = g≻
k+1, f = g≻
k , u = tj, v = tj+1,
and ǫ = (1+2CH)Bj,k. By the induction assumption on j, that is, by (10.62),
and by (10.71) and (10.75) both with j in place of j −1 and n = k, we have
∥∆a,k(tj+)∥≤Bj,k + CHBj,k−1 = (1 + 2CH)Bj,k.
Therefore by (10.30) and by the induction assumption on k,
∥g −f∥(u,v],[p] = ∥∆a,k∥(tj,tj+1],[p] ≤∥∆a,k(tj+)∥+ ∥∆tj+,k∥(tj,tj+1],[p]
≤2(1 + 2CH)Bj,k = 2ǫ.
Thus by Lemma 10.20(b),
∥∆tj+,k+1∥(tj,tj+1],[p] = ∥Q≻
0,u+g −Q≻
0,u+f∥(u,v],[p] ≤ǫ/2 = (1 + 2CH)Bj,k+1.
Therefore (10.78) holds with k+1 in place of k, and hence for all k = 0, 1, 2, . . ..
By (10.76) with j + 1 in place of j, by the induction assumption (10.62) on j,
and by (10.78) with k = n, it follows that for each n ≥1,
Aj+1,n ≤Aj,n + 2CHAj,n−1 + ∥∆tj+,n∥(tj,tj+1],[p]
≤Bj,n + 2CHBj,n−1 + (1 + 2CH)Bj,n ≤2(1 + 4CH)Bj,n = Bj+1,n.

536
10 Nonlinear Diﬀerential and Integral Equations
For n = 0, we have
Aj+1,0 ≤2∥g≻
1 ∥[a,tj+1],(p) ≤2E ≤Bj+1,0.
Thus (10.62) holds for j+1 in place of j, so (10.62) holds for each j = 1, . . . , m
when {fn} is {g≻
n }. Thus (10.62) is proved for the two sequences of forward
Picard iterates, proving the proposition.
2
Now we are ready to prove Theorem 10.11.
Proof of Theorem 10.11 and Corollary 10.12. The assumed hypotheses
on ψ and φ imply the respective hypotheses of Proposition 10.24 with α = 1:
this is clear for ψ. For φ, by Deﬁnition 10.5, the hypotheses φ ∈UHloc
1
(Z ×
J; X) and φ(z, ·) ∈R(J; X) for each z ∈Z yield φ ∈UCR(Z × J; X), and
so φ ∈CRGβ(Z × J; X). Thus by Proposition 10.24 or Corollary 10.25 in the
case of Corollary 10.12, both with α = 1, the four sequences of Picard iterates
(10.12), (10.13), (10.16), and (10.17) are bounded in Wp(J; Z).
The assumed hypotheses on ψ and φ also imply the respective hypothe-
ses of Proposition 10.26: This is clear for φ. For ψ, by Deﬁnition 10.3,
ψ ∈WG1,p(Z × J, X), and so ψ(0, ·) ∈Wp(J; X) by the deﬁnition (6.31)
of W1,q(ψ, K). Thus ψ ∈HWloc
1+α,q(Z × J; X) with q = p/α. Then by Propo-
sition 10.26, the four sequences of Picard iterates converge in Wp(J; Z).
Suppose f ≻is the limit of {f ≻
n }n≥0 in Wp(J; Z). By Theorem 6.68 with
R := 3 supn ∥f ≻
n ∥[p] < ∞, Nψf ≻
n →Nψf ≻in Wq(J; X) as n →∞. Since
φ ∈UHloc
1
(Z × J; X), it follows that Nφf ≻
n →Nφf ≻in ℓ∞(J; X). Using
the fact that the Kolmogorov integral is a continuous bilinear mapping from
Wq(J; X) × AIp(J; Y ) into Wp(J; Z) (Proposition 3.96), it follows that f ≻
is a solution of (10.5). Similarly, for each of the other three nonlinear integral
equations, if the associated Picard iterates converge in Wp(J; Z), their limit
is a solution. The proof of Theorem 10.11 and Corollary 10.12 is complete. 2
10.5 Continuity of the Solution Mappings
Let 0 < α ≤1, 1 ≤p < 1 + α, and J := [a, b]. Suppose that ψ: Z × J →X
and φ: Z × J →X satisfy the hypotheses of Theorem 10.7. Then for c ∈Z,
µ ∈AIp(J; Y ) = AIp, and ν ∈AI1(J; Y ) = AI1, the forward nonlinear
integral equation (10.5) has a unique solution f ∈Wp(J; Z) = Wp. Deﬁne the
solution mapping S≻
(a,·] corresponding to the integral equation (10.5) by
Z × AIp × AI1 ∋(c, µ, ν) 7→S≻
(a,·](c, µ, ν) := f ∈Wp.

10.5 Continuity of the Solution Mappings
537
Likewise, by Theorem 10.7, there exist solution mappings S≻
[a,·), S≺
(·,b] and S≺
[·,b)
corresponding to the integral equations (10.6), (10.7), and (10.8), respectively.
We will prove in this section that the four solution mappings are continuous.
Next is the main result of this section:
Theorem 10.27. Let α, β ∈(0, 1], 1 ≤p < 1 + α, and J := [a, b] with a < b.
Assuming (1.14), let ψ: Z ×J →X and φ: Z ×J →X satisfy the hypotheses
of Theorem 10.7. Then the four solution mappings S≻
(a,·], S≻
[a,·), S≺
[·,b), and S≺
(·,b]
from Z × AIp(J; Y ) × AI1(J; Y ) to Wp(J; Z) corresponding to the integral
equations (10.5), (10.6), (10.7), and (10.8), respectively, are continuous.
To prepare for the proof we next give bounds for the last terms on the right
sides of (10.29) and (10.30). Recall again the space HWloc
1+α,q as in Deﬁnition
6.61 for n = 1.
Lemma 10.28. Let 0 < α ≤1 ≤p < 1 + α, q := p/α, 0 < R < ∞, and
J := [a, b] with a < b. Assuming (1.14), let ψ ∈HWloc
1+α,q(Z × J; X), let
φ ∈UHloc
1
(Z × J; X) be such that φ(z, ·) ∈R(J; X) for each z ∈Z, let
µ, γ ∈AIp(J; Y ), let ν, π ∈AI1(J; Y ), and let f, g ∈Wp(J; Z) be such that
3 max{∥f∥[p], ∥g∥[p]} ≤R. Let
τ1 := 1/

1+8Kp,q[G(ψ)+W1,q(ψ, R)]
	
and
τ2 := 1/

1+8G(φ)
	
, (10.79)
where G(χ) := ∥Nχ(0)∥sup + RH1(χ) and H1(χ) = H1(χ; BR × J, X) for
χ = ψ or φ, W1,q(ψ, R) = W1,q(ψ, R; BR × J, X), BR := {z ∈Z : ∥z∥≤R},
and Kp,q = ζ(1/p + 1/q). Suppose that an interval [u, v] ⊂J is such that
(10.31) holds for µ and ν. For any E > 0 such that ∥µ −γ∥J,(p) ≤Eτ1 and
∥ν −π∥J,(1) ≤Eτ2, the following two statements hold:
(a) ∥T ≻
0,u,µ,νf −T ≻
0,u,γ,πg∥[u,v),[p] ≤E if ∥f −g∥[u,v),[p] ≤2E;
(b) ∥Q≻
0,u+,µ,νf −Q≻
0,u+,γ,πg∥(u,v],[p] ≤E if ∥f −g∥(u,v],[p] ≤2E.
Proof. To prove (a), for a ≤u ≤t ≤b, let
Ru(t) :=
R
=
(u,t]
(Nψg)−·d(µ −γ) +
R
=
(u,t]
(Nφg)−·d(ν −π).
Since the Kolmogorov integral is bilinear (Theorem 2.72 and Corollary 2.26),
for each t ∈[u, v), we have
T ≻
0,u,µ,νf(t) −T ≻
0,u,γ,πg(t) = T ≻
0,u,µ,νf(t) −T ≻
0,u,µ,νg(t) + Ru(t).
(10.80)
In Lemma 10.20, the hypotheses on J, α, p, q, R, ψ, φ, µ, and ν are the same
as in the present lemma. The choice of u, v ∈J is the same in both lemmas.
The functions f and g here satisfy the hypotheses on them in Lemma 10.20.
Since ∥f −g∥[u,v),[p] ≤2E, by Lemma 10.20(a), we have
∥T ≻
0,u,µ,νf −T ≻
0,u,µ,νg∥[u,v),[p] = ∥T ≻
0,uf −T ≻
0,ug∥[u,v),[p] ≤E/2,
(10.81)

538
10 Nonlinear Diﬀerential and Integral Equations
and so it is enough to prove that ∥Ru∥[u,v),[p] ≤E/2. Since ψ ∈HWloc
1+α,q(Z ×
J; X), by Lemma 6.62 with n = 1, ψ ∈HWloc
1,q (Z × J; X). Thus by Lemma
6.53(a) with α = 1 there,
∥Nψg∥J,(q) ≤H1(ψ)∥g∥J,(q) + W1,q(ψ, ∥g∥J,[q]).
Since ψ ∈UHloc
1
(Z × J; X), it follows that
∥Nψg∥J,sup ≤∥Nψ(0)∥sup + H1(ψ)∥g∥J,sup.
Summing the two bounds, using the fact that ∥g∥(q) ≤∥g∥(p) (Lemma 3.45),
and applying the hypothesis ∥g∥J,[p] ≤R, we get
∥Nψg∥J,[q] ≤G(ψ) + W1,q(ψ, R).
Also, recalling some notation given in the paragraph before (2.1), we have
∥(Nψg)(a)
−∥J,[q] ≤∥Nψg∥J,[q]. Similarly, since φ ∈UHloc
1
(Z × J; X), it follows
that ∥(Nφg)(a)
−∥J,sup ≤G(φ). By additivity of the Kolmogorov integral over
disjoint adjoining intervals (Theorem 2.21) and by the Love–Young inequality
(3.153), we have
Ru

[u,v),(p) ≤

R
=(Nψg)(a)
−·d(µ −γ)

J,(p) +

R
=(Nφg)(a)
−·d(ν −π)

J,(1)
≤Kp,q
(Nψg)(a)
−

J,[q]
µ−γ

J,(p)+
(Nφg)(a)
−

J,sup
ν−π

J,(1)
≤Kp,q
n
G(ψ) + W1,q(ψ, R)
o
∥µ −γ∥J,(p) + G(φ)∥ν −π∥J,(1).
Using the fact that Ru(u) = 0, it then follows that
∥Ru∥[u,v),[p] ≤2∥Ru∥[u,v),(p)
≤2Kp,q
n
G(ψ)+W1,q(ψ, R)
o
∥µ −γ∥J,(p)+2G(φ)∥ν −π∥J,(1),
and so ∥Ru∥[u,v),[p] ≤E/2 since ∥µ −γ∥J,(p) ≤Eτ1 and ∥ν −π∥J,(1) ≤Eτ2.
This together with (10.80) and (10.81) proves (a). The proof of statement (b)
is similar except that we use (b) of Lemma 10.20, and therefore is omitted.
The proof of the lemma is complete.
2
To continue the proof of Theorem 10.27 we have the next fact.
Proposition 10.29. Let 0 < α ≤1 ≤p < 1 + α, q := p/α, and J := [a, b]
with a < b. Assuming (1.14), let ψ ∈HWloc
1+α,q(Z × J; X), let φ ∈UHloc
1
(Z ×
J; X) be such that φ(z, ·) ∈R(J; X) for each z ∈Z, let µ, γ ∈AIp(J; Y ), let
ν, π ∈AI1(J; Y ), and let c, d ∈Z. Suppose that {fn}n≥0 and {hn}n≥0 are
two sequences of Picard iterates bounded in Wp(J; Z) obtained, respectively,
by T ≻
c,a,µ,ν and by T ≻
d,a,γ,π. Given ǫ > 0 there exist δr > 0, r = 1, 2, 3, such that
if ∥c −d∥< δ1, ∥µ −γ∥(p) < δ2, and ∥ν −π∥(1) < δ3 then ∥fn −hn∥[p] < ǫ for
each n ≥0, and the same holds if T ≻is replaced by Q≻for both sequences.

10.5 Continuity of the Solution Mappings
539
Proof. Let R := 3 supn≥0 max{∥fn∥[p], ∥hn∥[p], 1} and let BR := {z ∈
Z : ∥z∥≤R}. In particular, the range of each fn and hn is in the ball
BR. If ψ(z, ·) ≡χ1 and φ(z, ·) ≡χ2 for each z in BR and some functions
χ1, χ2 : J →X then for each n ≥1 and t ∈J,
(fn −hn)(t) = c −d +
R
=
Jt
χ1·d(µ −γ) +
R
=
Jt
χ2·d(ν −π),
where Jt = (a, t] or [a, t), and so the conclusion holds by the Love–Young
inequality (3.153). Suppose that either ψ(z, ·) or φ(z, ·) is non-constant with
respect to z ∈BR. Let θ1 and θ2 be deﬁned by (10.31). Using Proposition
3.52, one can ﬁnd a Young interval partition {(tj−1, tj)}m
j=1 of J such that
vp(µ; (tj−1, tj)) ≤θp
1
and
v1(ν; (tj−1, tj)) ≤θ2
(10.82)
for each 1 ≤j ≤m, and m ≤1 + vp(µ; J)/θp
1 + v1(ν; J)/θ2. Since ψ ∈
HWloc
1+α,q(Z × J; X), by Lemma 6.62, ψ ∈HWloc
1,q (Z × J; X), and so
H1(ψ) := H1(ψ; BR × J, X) < ∞
(10.83)
and W1,q(ψ, R) := W1,q(ψ, R; BR × J, X) < ∞. Since φ ∈UHloc
1
(Z × J; X),
H1(φ) := H1(φ; BR × J, X) < ∞. Let A := 3 + 4H[H1(ψ) + H1(φ)] < ∞,
where H := supt∈J max{∥µ({t})∥, ∥ν({t})∥}. Given ǫ > 0, let
δ1 := ǫA−m−1/

3 + 4Kp,q[H1(ψ) + D]∥µ∥(p) + 4H1(φ)∥ν∥(1)
	
,
(10.84)
where Kp,q = ζ(1/p+1/q) and D := Hα(ψ(1)
u ; BR×J, X)+Wα,q(ψ(1)
u , R; BR×
J, X), let
δ2 := ǫA−m−1/

1 + 8Kp,q[G(ψ) + W1,q(ψ, R)]
	
,
(10.85)
where G(χ) := ∥Nχ(0)∥sup + RH1(χ) for χ = ψ or φ, and let
δ3 := ǫA−m−1/

1 + 8G(φ)
	
.
(10.86)
We claim that if ∥c −d∥< δ1, ∥µ −γ∥(p) < δ2 and ∥ν −π∥(1) < δ3 then for
each j = 1, . . . , m and n = 1, 2, . . . ,
Aj,n := ∥fn −hn∥Jj,[p] ≤ǫAj−m−1 =: Bj,
(10.87)
where Jj := [tj−1, tj]. Assuming that the claim holds and applying subaddi-
tivity of ∥·∥[p] over closed adjoining intervals (Proposition 3.35(a)) recursively,
since A > 2, it follows that
∥fn −hn∥[p] ≤
m
X
j=1
∥fn −hn∥Jj,[p] < ǫ
for all n, as desired.

540
10 Nonlinear Diﬀerential and Integral Equations
To prove (10.87), ﬁrst suppose that {fn} is the sequence of Picard iterates
{f ≻
n } obtained by the integral transform T ≻
c,a,µ,ν and {hn} is the sequence of
Picard iterates {ξ≻
n } obtained by the integral transform T ≻
d,a,γ,π, where
∥c −d∥< δ1,
∥µ −γ∥(p) < δ2,
and
∥ν −π∥(1) < δ3.
(10.88)
The claim (10.87) will be proved by induction on j. Before starting the induc-
tion, we give a preliminary bound on Aj,n for each j ∈{1, . . . , m} and n ≥2.
For a ≤u ≤t ≤b and n = 1, 2, . . ., let
Sψ,µ,γ
u,n
(t) :=
R
=
(u,t]
 Nψf ≻
n−1

−·dµ −
R
=
(u,t]
 Nψξ≻
n−1

−·dγ,
Sφ,ν,π
u,n (t) :=
R
=
(u,t]
 Nφf ≻
n−1

−·dν −
R
=
(u,t]
 Nφξ≻
n−1

−·dπ,
and let
Su,n := Sψ,µ,γ
u,n
+ Sφ,ν,π
u,n .
(10.89)
Then Su,n is a function on [u, b] such that when u = a,
Sa,n = [f ≻
n −ξ≻
n ] −[c −d].
(10.90)
By additivity of the Kolmogorov integral (Theorem 2.21), for each a ≤u ≤
t ≤b, we have
Sa,n(t) = Sa,n(u) + Su,n(t).
(10.91)
Let j ∈{1, . . . , m} and n ≥2. Applying (10.65) to f = f ≻
n −ξ≻
n = c−d+Sa,n,
u = tj−1, and v = tj, since f −f(tj−1) = Stj−1,n on [tj−1, b] by (10.91), it
follows that
Aj,n = ∥f ≻
n −ξ≻
n ∥Jj,[p]
(10.92)
≤∥(f ≻
n −ξ≻
n )(tj−1)∥+ ∥Stj−1,n∥[tj−1,tj),[p] + 2∥∆−Sa,n(tj)∥.
Clearly ∆−Sa,n = ∆−Sψ,µ,γ
a,n
+ ∆−Sφ,ν,π
a,n . As in (10.51), we have
∥∆−Sψ,µ,γ
a,n
(tj)∥= ∥(Nψf ≻
n−1)(tj−)·µ({tj}) −(Nψξ≻
n−1)(tj−)·γ({tj})∥
≤∥(Nψf ≻
n−1)(tj−) −(Nψξ≻
n−1)(tj−)∥∥µ({tj})∥
(10.93)
+ ∥(Nψξ≻
n−1)(tj−)∥∥(µ −γ)({tj})∥.
For the ﬁrst term on the right side of (10.93), as in (10.67) and using (10.91),
since ψ is s-uniformly Lipschitz on BR by (10.83) and Stj−1,n−1(tj−1) = 0, it
follows that
∥(Nψf ≻
n−1)(tj−) −(Nψξ≻
n−1)(tj−)∥
≤H1(ψ)∥f ≻
n−1 −ξ≻
n−1∥[tj−1,tj),sup
≤H1(ψ)
n
∥(f ≻
n−1 −ξ≻
n−1)(tj−1)∥+ ∥Stj−1,n−1∥[tj−1,tj),(p)
o
.

10.5 Continuity of the Solution Mappings
541
For the second term on the right side of (10.93), again since ψ is s-uniformly
Lipschitz on BR, we have
∥(Nψξ≻
n−1)(tj−)∥≤∥Nψ(0)∥sup + H1(ψ)R = G(ψ).
Inserting the preceding two bounds in (10.93) gives
∥∆−Sψ,µ,γ
a,n
(tj)∥≤G(ψ)∥µ −γ∥(p)
+ HH1(ψ)
n
∥(f ≻
n−1−ξ≻
n−1)(tj−1)∥+∥Stj−1,n−1∥[tj−1,tj),(p)
o
.
Since φ also is s-uniformly Lipschitz on BR, the same bound holds when ψ,
µ, and γ are replaced, respectively, by φ, ν, and π. Adding the two bounds
gives a bound for ∥∆−Sa,n(tj)∥in (10.92), and so we have
Aj,n ≤∥(f ≻
n −ξ≻
n )(tj−1)∥+ ∥Stj−1,n∥[tj−1,tj),[p]
+ 2H(H1(ψ)+H1(φ))
n
∥(f ≻
n−1 −ξ≻
n−1)(tj−1)∥+∥Stj−1,n−1∥[tj−1,tj),(p)
o
+ 2G(ψ)∥µ −γ∥(p) + 2G(φ)∥ν −π∥(1)
(10.94)
for each j ∈{1, . . . , m} and n ≥2.
To begin the induction on j, let j = 1. Recalling (10.90), we claim that
for each k = 1, 2, . . . ,
Sa,k

[a,t1),[p] ≤ǫA−m−1.
(10.95)
For a ≤u ≤t ≤b, and for the constant function 1, let
Iψ,µ,γ
u
(t) :=
R
=
(u,t]
h
Nψ(c1) −Nψ(d1)
i
−·dµ +
R
=
(u,t]

Nψ(d1)

−·d(µ −γ). (10.96)
By Theorem 6.68, since max{∥c∥, ∥d∥} ≤R, we get the bound
∥Nψ(c1) −Nψ(d1)∥J,[q] ≤[H1(ψ) + D]∥c −d∥.
By Lemma 6.53(a) with α = 1, ∥Nψ(d1)∥J,(q) ≤W1,q(ψ, R), and since ψ is
s-uniformly Lipschitz on BR,
∥Nψ(d1)∥J,sup ≤∥Nψ(0)∥sup + RH1(ψ) = G(ψ).
Thus by the Love–Young inequality (3.153) and by the inequality ∥g(a)
−∥J,[q] ≤
∥g∥J,[q] applied to g = Nψ(c1) −Nψ(d1) and g = Nψ(d1), for any a ≤u <
v ≤b, we get
∥Iψ,µ,γ
u
∥[u,v],(p)
(10.97)
≤Kp,q
n
Nψ(c1) −Nψ(d1)
(a)
−

J,[q]∥µ∥(p) +

Nψ(d1)
(a)
−

J,[q]∥µ −γ∥(p)
o
≤Kp,q
n
[H1(ψ) + D]∥c −d∥∥µ∥(p) + [G(ψ) + W1,q(ψ, R)]∥µ −γ∥(p)
o
.

542
10 Nonlinear Diﬀerential and Integral Equations
Similarly, letting Iφ,ν,π
u
(t) be the right side of (10.96) with ψ, µ, γ replaced
by φ, ν, π, respectively, by the Love–Young inequality (3.153) with p = 1, for
any a ≤u < v ≤b, we get
∥Iφ,ν,π
u
∥[u,v],(1) ≤H1(φ)∥ν∥(1)∥c −d∥+ G(φ)∥ν −π∥(1).
(10.98)
Recalling (10.89) with n = 1, f ≻
0 = c1, ξ≻
0 = d1, and using bilinearity of the
Kolmogorov integral (Theorem 2.72 and Corollary 2.26), we have
Su,1 = Sψ,µ,γ
u,1
+ Sφ,ν,π
u,1
= Iψ,µ,γ
u
+ Iφ,ν,π
u
.
Applying (10.97) and (10.98), and since ∥·∥(p) ≤∥·∥(1) (by Lemma 3.45) and
Su,1(u) = 0, it follows that
∥Su,1∥[u,v],[p]
≤2∥Su,1∥[u,v],(p)
≤2
n
Kp,q[H1(ψ) + D]∥µ∥(p) + H1(φ)∥ν∥(1)
o
∥c −d∥
(10.99)
+ 2Kp,q

G(ψ) + W1,q(ψ, R)

∥µ −γ∥(p) + 2G(φ)∥ν −π∥(1) ≤ǫA−m−1
for any a ≤u < v ≤b, by (10.88), (10.84), (10.85), and (10.86). Thus (10.95)
holds for k = 1. Suppose (10.95) holds for some k ≥1. To prove it for k + 1
we will use Lemma 10.28(a) with f = f ≻
k , g = ξ≻
k , u = a, v = t1, R as in
the present proof, and E = ǫA−m−1. The hypothesis (10.31) holds for µ and
ν by (10.82). Since ∥c −d∥< δ1 ≤E by (10.84), it follows by (10.90) and the
induction assumption (10.95) that
∥f −g∥[u,v),[p] = ∥f ≻
k −ξ≻
k ∥[a,t1),[p] ≤∥c −d∥+ ∥Sa,k∥[a,t1),[p] ≤2E.
With τ1 and τ2 deﬁned by (10.79) and δ2, δ3 by (10.85) and (10.86) respec-
tively, we have δ2 = Eτ1 and δ3 = Eτ2. Using Lemma 10.28(a), it follows
that
∥Sa,k+1∥[a,t1),[p] =
T ≻
0,a,µ,νf −T ≻
0,a,γ,πg

[a,t1),[p] ≤E = ǫA−m−1.
Therefore (10.95) holds with k + 1 in place of k, and hence for all k = 1, 2, . . .
by induction.
To bound A1,n for n ≥2, recalling (10.88), ﬁrst apply (10.94) with j = 1,
then the bound ∥(f ≻
l
−ξ≻
l )(a)∥= ∥c −d∥< δ1 ≤ǫA−m−1 for each l ≥1
obtained using (10.84), then (10.95) with k = n, n −1, and also (10.85) and
(10.86), it follows that
A1,n ≤ǫA−m−1
3 + 4H[H1(ψ) + H1(φ)]
	
= ǫA−m = B1.
(10.100)
To bound Aj,1, let j ∈{1, . . ., m}. By (10.90), (10.99), and (10.88), we have
Aj,1 ≤∥c −d∥+ ∥Sa,1∥[a,b],[p] ≤2ǫA−m−1 < Bj.
(10.101)

10.5 Continuity of the Solution Mappings
543
This for j = 1 together with (10.100) for n ≥2 proves that (10.87) holds for
j = 1 and each n ≥1.
Now suppose (10.87) holds for some 1 ≤j < m. It then will be shown to
hold for j + 1 in place of j. We claim that for each k = 1, 2, . . . ,
Stj,k

[tj,tj+1),[p] ≤ǫAj−m−1 = Bj.
(10.102)
This bound holds for k = 1 by (10.99). Suppose (10.102) holds for some k ≥1.
To prove it for k+1 we will use Lemma 10.28(a) with f = f ≻
k , g = ξ≻
k , u = tj,
v = tj+1, R as in the present proof, and E = Bj. The hypothesis (10.31) holds
for µ and ν by (10.82). By (10.90) and (10.91), we have
∥f −g∥[u,v),[p] = ∥f ≻
k −ξ≻
k ∥[tj,tj+1),[p]
≤∥(f ≻
k −ξ≻
k )(tj)∥+ ∥Stj,k∥[tj,tj+1),[p].
By the induction assumption on j, that is, by (10.87), we have
∥(f ≻
k −ξ≻
k )(tj)∥≤Aj,k ≤Bj = E.
This and the induction assumption on k, which is (10.102), yields that ∥f −
g∥[u,v),[p] ≤2E. Again since δ2 ≤Eτ1 and δ3 ≤Eτ2 with τ1 and τ2 deﬁned
by (10.79), using Lemma 10.28(a), it follows that
∥Stj,k+1∥[tj,tj+1),[p] =
T ≻
0,u,µ,νf −T ≻
0,u,γ,πg

[u,v),[p] ≤E = Bj.
Therefore (10.102) holds with k+1 in place of k, and hence for all k = 1, 2, . . .
by induction. To bound Aj+1,n for n ≥2, ﬁrst apply (10.94) with j + 1 in
place of j. Next, by the induction assumption, ∥(f ≻
l −ξ≻
l )(tj)∥≤Aj,l ≤Bj
for each l ≥1. Then by (10.102) with k = n, n −1 and (10.88), it follows that
Aj+1,n ≤ǫAj−m−1
3 + 4H[H1(ψ) + H1(φ)]
	
= ǫAj−m = Bj+1.
Since the same bound holds for n = 1 by (10.101), (10.87) holds for j +
1 in place of j for each n ≥1. By induction on j, (10.87) holds for each
j ∈{1, . . . , m}, proving the claim for the two bounded sequences of Picard
iterates {f ≻
n }n≥0 and {ξ≻
n }n≥0 obtained by the integral transforms T ≻
c,a,µ,ν
and T ≻
d,a,γ,π, respectively.
Now suppose that {fn} is the sequence of Picard iterates {g≻
n } obtained
by the integral transform Q≻
c,a,µ,ν and {hn} is the sequence of Picard iterates
{ζ≻
n } obtained by the integral transform Q≻
d,a,γ,π, where again (10.88) holds.
The claim (10.87) will be proved again by induction on j. Before starting the
induction, we give a preliminary bound on Aj,n for each j ∈{1, . . ., m} and
n ≥2. For u ∈J and n = 1, 2, . . . , let
Su,n := Sψ,µ,γ
u,n
+ Sφ,ν,π
u,n
(10.103)
be the functions on [u, b] with values for each t ∈[u, b],

544
10 Nonlinear Diﬀerential and Integral Equations
Sψ,µ,γ
u,n
(t) :=
R
=
[u,t)
 Nψg≻
n−1

·dµ −
R
=
[u,t)
 Nψζ≻
n−1

·dγ,
Sφ,ν,π
u,n (t) :=
R
=
[u,t)
 Nφg≻
n−1

·dν −
R
=
[u,t)
 Nφζ≻
n−1

·dπ.
Let j ∈{1, . . . , m} and n ≥2. By (10.30), for a ≤u < t ≤b, we have
Sa,n(t) = Sa,n(u) + Su,n(u+) + Su+,n(t).
(10.104)
For a function f : J →Z and any t ∈(u, v] ⊂J, we have f(t) = f(u) +
∆+f(u) + f(t) −f(u+), and so by Corollary 3.43(b), it follows that
∥f∥[u,v],[p] ≤∥f(u)∥+ 2∥∆+f(u)∥+ ∥f −f(u+)∥(u,v],[p].
(10.105)
Since g≻
n −ζ≻
n = c−d+Sa,n, letting f := g≻
n −ζ≻
n and [u, v] := [tj−1, tj] = Jj,
we have f −f(u+) = Stj−1+,n on (u, b], and ∆+f(u) = Stj−1,n(tj−1+). Thus
by (10.105), we get
Aj,n = ∥g≻
n −ζ≻
n ∥Jj,[p]
(10.106)
≤∥(g≻
n −ζ≻
n )(tj−1)∥+ 2∥Stj−1,n(tj−1+)∥+ ∥Stj−1+,n∥(tj−1,tj],[p].
By additivity and upper continuity of the Kolmogorov integral (Theorem 2.21
and Corollary 2.23), as in (10.54), for any t ∈[a, b),
∥Sψ,µ,γ
t,n
(t+)∥
= ∥(Nψg≻
n−1)(t)·µ({t}) −(Nψζ≻
n−1)(t)·γ({t})∥
(10.107)
≤∥(Nψg≻
n−1)(t) −(Nψζ≻
n−1)(t)∥∥µ({t})∥+ ∥(Nψζ≻
n−1)(t)∥∥(µ −γ)({t})∥.
Since ψ is s-uniformly Lipschitz on BR, we have the bounds
∥(Nψg≻
n−1)(t) −(Nψζ≻
n−1)(t)∥≤H1(ψ)∥(g≻
n−1 −ζ≻
n−1)(t)∥
and
∥(Nψζ≻
n−1)(t)∥≤∥Nψ(0)∥sup + H1(ψ)R = G(ψ)
respectively, since ∥ζ≻
n−1∥sup ≤R, and so applying the preceding two bounds
in (10.107) gives
∥Sψ,µ,γ
t,n
(t+)∥≤HH1(ψ)∥(g≻
n−1 −ζ≻
n−1)(t)∥+ G(ψ)∥µ −γ∥(p),
recalling H = supt∈J max{∥µ({t})∥, ∥ν({t})∥}. Since φ also is s-uniformly
Lipschitz on BR, the same bound holds when ψ, µ, γ, and ∥·∥(p) are replaced,
respectively, by φ, ν, π, and ∥· ∥(1). Adding the two bounds gives
∥St,n(t+)∥≤H[H1(ψ) + H1(φ)]∥(g≻
n−1 −ζ≻
n−1)(t)∥
(10.108)
+ G(ψ)∥µ −γ∥(p) + G(φ)∥ν −π∥(1).

10.5 Continuity of the Solution Mappings
545
Taking t = tj−1 and applying the preceding bound in (10.106) gives the
preliminary bound
Aj,n ≤∥(g≻
n −ζ≻
n )(tj−1)∥+ ∥Stj−1+,n∥(tj−1,tj],[p]
+ 2H[H1(ψ) + H1(φ)]∥(g≻
n−1 −ζ≻
n−1)(tj−1)∥
(10.109)
+ 2G(ψ)∥µ −γ∥(p) + 2G(φ)∥ν −π∥(1)
for each j ∈{1, . . . , m} and n ≥2.
To begin the induction on j for (10.87) in this case, let j = 1. We claim
that for each k = 1, 2, . . . ,
Sa+,k

(a,t1],[p] ≤ǫA−m−1.
(10.110)
For a ≤u < t ≤b, let
Iψ,µ,γ
u
(t) :=
R
=
(u,t)
h
Nψ(c1) −Nψ(d1)
i
·dµ +
R
=
(u,t)
Nψ(d1)·d(µ −γ).
(10.111)
As for (10.96), by the Love–Young inequality, (10.97) holds. Letting Iφ,ν,π
u
be the right side of (10.111) with ψ, µ, γ replaced by φ, ν, π, it follows
similarly that (10.98) holds. Recalling (10.103) with n = 1, g≻
0 = c1, ζ≻
0 = d1,
using bilinearity, additivity, and upper continuity of the Kolmogorov integral
(Theorem 2.72, Corollary 2.26, Theorem 2.21, and Corollary 2.23), we have
Su+,1 = Sψ,µ,γ
u+,1 + Sφ,ν,π
u+,1 = Iψ,µ,γ
u
+ Iφ,ν,π
u
.
Thus since Su+,1(u) = 0, by (10.97) and (10.98), it follows as in (10.99) that
∥Su+,1∥[u,v],[p]
≤2
n
Kp,q[H1(ψ) + D]∥µ∥(p) + H1(φ)∥ν∥(1)
o
∥c −d∥
(10.112)
+ 2Kp,q

G(ψ) + W1,q(ψ, R)

∥µ −γ∥(p) + 2G(φ)∥ν −π∥(1) ≤ǫA−m−1
for any a ≤u < v ≤b. Thus (10.110) holds for k = 1. Suppose (10.110)
holds for some k ≥1. To prove it for k + 1 we will use Lemma 10.28(b) with
f = g≻
k , g = ζ≻
k , u = a, v = t1, R as in the present proof, and E = ǫA−m−1.
The hypothesis (10.31) holds for µ and ν by (10.82). Recalling the equality
g≻
k −ζ≻
k = c −d + Sa,k just after (10.105), and (10.104) with u = a, we have
∥f −g∥(a,t1],[p] = ∥g≻
k −ζ≻
k ∥(a,t1],[p]
≤∥c −d∥+ ∥Sa,k(a+)∥+ ∥Sa+,k∥(a,t1],[p].
Since (g≻
k−1 −ζ≻
k−1)(a) = c−d, using (10.108) with t = a and n = k, it follows
that
∥c −d∥+ ∥Sa,k(a+)∥
≤∥c −d∥

1 + H[H1(ψ) + H1(φ)]
	
+ G(ψ)∥µ −γ∥(p) + G(φ)∥ν −π∥(1)
≤E

546
10 Nonlinear Diﬀerential and Integral Equations
by (10.88), (10.84), (10.85), and (10.86), and using Kp,q > ζ(2) = π2/6 > 3/2.
This and the induction assumption (10.110) yield that ∥f −g∥(a,t1],[p] ≤2E.
Since δ2 ≤Eτ1 and δ3 ≤Eτ2 with τ1 and τ2 deﬁned by (10.79), using Lemma
10.28(b), it follows that ∥Sa+,k+1∥(a,t1],[p] ≤E. Therefore (10.110) holds with
k + 1 in place of k, and hence for all k = 1, 2, . . . by induction.
To bound A1,n for n ≥2, applying ﬁrst (10.109) with j = 1, then the
bound ∥(g≻
l −ζ≻
l )(a)∥= ∥c −d∥< δ1 ≤ǫA−m−1 for each l ≥1 obtained
using (10.84), and (10.110) with k = n, it follows that
A1,n ≤ǫA−m−1
3 + 2H[H1(ψ) + H1(φ)]
	
< ǫA−m = B1.
(10.113)
To bound Aj,1 for j ∈{1, . . ., m}, note that (g≻
1 −ζ≻
1 )(t) = [c −d] + Sa,1(t)
and
Sψ,µ,γ
a,1
(t) =
R
=
[a,t)
h
Nψ(c1) −Nψ(d1)
i
· dµ +
R
=
[a,t)
Nψ(d1) · d(µ −γ)
for each t ∈[a, b]. A similar equality holds for Sφ,ν,π
a,1
. By (10.103) with u = a
and n = 1, the bound ∥Sa,1∥J,[p] ≤ǫA−m−1 follows as in (10.99). Thus since
Sa,1(a) = 0, as in (10.101) it follows that for each j ∈{1, . . ., m},
Aj,1 ≤∥c −d∥+ ∥Sa,1∥J,[p] ≤2ǫA−m−1 < B1 ≤Bj.
(10.114)
This for j = 1 together with (10.113) proves that (10.87) holds for j = 1.
Now suppose (10.87) holds for some 1 ≤j < m. It then will be shown to
hold for j + 1 in place of j. We claim that for each k = 1, 2, . . . ,
Stj+,k

(tj,tj+1],[p] ≤{1.5 + H[H1(ψ) + H1(φ)]}Bj.
(10.115)
This bound holds for k = 1 by (10.112) with u = tj and v = tj+1 since
ǫA−m−1 < Bj. Suppose (10.115) holds for some k ≥1. To prove it for k + 1
we will use Lemma 10.28(b) with f = g≻
k , g = ζ≻
k , u = tj, v = tj+1, R as
in the present proof, and E being the right side of (10.115). The hypothesis
(10.31) holds for µ and ν by (10.82). To check the other hypotheses of Lemma
10.28(b), for a function h: J →Z and any a ≤u < v ≤b, using Corollary
3.43(b) as in (10.105), it follows that
∥h∥(u,v],[p] ≤∥h(u)∥+ ∥∆+h(u)∥+ ∥h −h(u+)∥(u,v],[p].
For k ≥2, taking h := g≻
k −ζ≻
k as in (10.106), then using (10.108) with t = tj
and n = k, it follows that
∥f −g∥(u,v],[p] = ∥g≻
k −ζ≻
k ∥(tj,tj+1],[p]
≤∥(g≻
k −ζ≻
k )(tj)∥+ ∥Stj,k(tj+)∥+ ∥Stj+,k∥(tj,tj+1],[p]
≤{1 + H[H1(ψ) + H1(φ)]}
max
l∈{k,k−1} ∥(g≻
l −ζ≻
l )(tj)∥
+G(ψ)∥µ −γ∥(p) + G(φ)∥ν −π∥(1) + ∥Stj+,k∥(tj,tj+1],[p]
≤{1.5 + H[H1(ψ) + H1(φ)]}Bj + {1.5 + H[H1(ψ) + H1(φ)]}Bj = 2E,

10.5 Continuity of the Solution Mappings
547
where the last inequality holds by (10.88), (10.85), and (10.86) since A > 1,
and by the induction assumptions on j and on k. For k = 1, ∥f −g∥(u,v],[p] ≤
Aj+1,1 < B1 ≤Bj < 2E by (10.114), with j there equal to j +1 here, which is
valid since j + 1 ≤m. Because δ2 ≤Eτ1 and δ3 ≤Eτ2 with τ1 and τ2 deﬁned
by (10.79), using Lemma 10.28(b), it follows that
Stj+,k+1

(tj,tj+1],[p] ≤E = {1.5 + H[H1(ψ) + H1(φ)]}Bj.
Therefore (10.115) holds with k + 1 in place of k, hence for all k = 1, 2, . . . by
induction.
To bound Aj+1,n for n ≥2, we apply ﬁrst (10.109) with j + 1 in place of
j. The induction assumption (10.87) implies ∥(g≻
l −ζ≻
l )(tj)∥≤Aj,l ≤Bj for
each l ≥1. Then applying (10.115) with k = n and (10.88), it follows that
Aj+1,n ≤{1 + 2H[H1(ψ) + H1(φ)]}
max
l∈{n,n−1} ∥(g≻
l −ζ≻
l )(tj)∥
+∥Stj+,n∥(tj,tj+1],[p] + 2G(ψ)∥µ −γ∥(p) + 2G(φ)∥ν −π∥(1)
≤Bj{1 + 2H[H1(ψ) + H1(φ)]} + Bj{1.5 + H[H1(ψ) + H1(φ)]}
+Bj/2 ≤ABj = Bj+1.
Since the same bound holds for n = 1 by (10.114), (10.87) holds for j +
1 in place of j for each n ≥1. By induction on j, (10.87) holds for each
j ∈{1, . . . , m}, proving the claim for the two bounded sequences of Picard
iterates {g≻
n }n≥0 and {ζ≻
n }n≥0 obtained by the integral transforms Q≻
c,a,µ,ν
and Q≻
d,a,γ,π, respectively. Thus the claim (10.87) is proved for each of the
two pairs of sequences of Picard iterates, completing the proof of Proposition
10.29.
2
Proof of Theorem 10.27. Let c ∈Z, let µ ∈AIp(J; Y ), and let ν ∈
AI1(J; Y ). By Theorem 10.7, each of the four integral equations (10.5), (10.6),
(10.7), and (10.8) has respectively a solution mapping S≻
(a,·], S≻
[a,·), S≺
[·,b), and
S≺
(·,b] from Z ×AIp(J; Y )×AI1(J; Y ) to Wp(J; Z). Let S := S≻
(a,·] and let ǫ >
0. We will show that there is a neighborhood V of (c, µ, ν) ∈Z ×AIp(J; Y )×
AI1(J; Y ) such that ∥S(c, µ, ν) −S(d, γ, π)∥J,[p] < ǫ for any (d, γ, π) ∈V .
Let {fn}n≥0 be the sequence of Picard iterates (10.12) obtained by the
integral transform T ≻
c,a,µ,ν, converging in Wp(J; Z) to S(c, µ, ν) by Theorem
10.11. Let ρ1 ≡ρ(p, α, ψ) and ρ2 ≡ρ(p, β, φ) be deﬁned by (10.24). The
assumed hypotheses on ψ and φ imply the respective hypotheses of Propo-
sition 10.24 with α = 1 there as shown in the proof of Theorem 10.11, and
so ρ1 > 0 and ρ2 > 0. Let υ := 1 + (1 + ∥µ∥(p))p/ρp
1 + (1 + ∥ν∥(1))/ρ2,
C1 := 1 + max{1, ∥c∥}, and
R := C13υ+1(1 + 2D(1 + H))υ,
(10.116)

548
10 Nonlinear Diﬀerential and Integral Equations
where D := H1(ψ) + ∥Nψ(0)∥sup + 2∥φ∥Gβ and H := supt∈J max{∥µ({t})∥,
∥ν({t})∥}. Let V1 be the set of (d, γ, π) ∈Z × AIp(J; Y ) × AI1(J; Y ) such
that ∥c −d∥≤1, ∥µ −γ∥(p) ≤1, and ∥ν −π∥(1) ≤1. Given (d, γ, π) ∈V1 let
{hn}n≥0 be the sequence of Picard iterates obtained by the integral transform
T ≻
d,a,γ,π, converging in Wp(J; Z) to S(d, γ, π) by Theorem 10.11. The right
side of (10.47), with m, C, and H deﬁned for (c, µ, ν) or for (d, γ, π), is less
than R deﬁned by (10.116). Thus by Proposition 10.24 with α = 1 there, we
have supn≥0 max{∥fn∥[p], ∥hn∥[p]} ≤R. The assumed hypotheses on ψ and φ
also imply the respective hypotheses of Proposition 10.29. This is clear for φ.
For ψ, by Deﬁnition 10.3, ψ ∈WG1,p(Z × J; X), and so ψ(0, ·) ∈Wp(J; X)
⊂Wq(J; X) with q = p/α by the deﬁnition (6.31) of W1,p(ψ, K), and so
ψ ∈HWloc
1+α,q(Z × J; X) as deﬁned in Deﬁnition 6.61. Thus by Proposition
10.29, there exist δ1 > 0, δ2 > 0, and δ3 > 0 such that if ∥c −d∥< δ1,
∥µ −γ∥(p) < δ2, and ∥ν −π∥(1) < δ3 then ∥fn −hn∥[p] < ǫ/3 for all n. Let
V be the set of (d, γ, π) ∈Z × AIp(J; Y ) × AI1(J; Y ) such that ∥c −d∥<
min{1, δ1}, ∥µ−γ∥(p) < min{1, δ2}, and ∥ν−π∥(1) < min{1, δ3}. Then for any
(d, γ, π) ∈V , it follows that ∥S(c, µ, ν)−S(d, γ, π)∥J,[p] < ǫ, proving continuity
of S = S≻
(a,·]. The same proof, except that now (10.48) is used instead of
(10.47), applies to the solution mapping S≻
[a,·) and is therefore omitted.
To prove continuity of the solution mapping S≺
[·,b), recall that θ(t) := a +
b −t, eψ(z, t) ≡ψ(z, θ(t)), and eφ(z, t) ≡φ(z, θ(t)) for a ≤t ≤b and z ∈Z.
As was noted in the proof of Theorem 10.7, eψ and eφ satisfy the hypotheses of
Theorem 10.7, and so the solution mapping ˜S≻
(a,·], corresponding to the integral
equation (10.5) with eψ and eφ in place of ψ and φ, is deﬁned. Let ǫ > 0, let
(c, µ, ν) be in Z × AIp(J; Y ) × AI1(J; Y ), and recall that eµ ≡µ◦θ−1 and
eν ≡ν◦θ−1. Then (c, eµ, eν) is in Z × AIp(J; Y ) × AI1(J; Y ). By the ﬁrst part
of the proof, there exists a neighborhood of zero V such that ∥˜S≻
(a,·](c, eµ, eν) −
˜S≻
(a,·](d, eγ, eπ)∥[p] < ǫ for any (d, eγ, eπ) in V . Let (d, γ, π) be in V , let eγ := γ◦θ−1,
and let eπ := π◦θ−1. Then (d, eγ, eπ) is in V . Also as in (10.45) and (10.46),
it follows that the solutions f := S≺
[·,b)(c, µ, ν) and h := S≺
[·,b)(d, γ, π) are
obtained by the change of variables with θ from the solutions ef := ˜S≻
(a,·](c, eµ, eν)
and eh := ˜S≻
(a,·](d, eγ, eπ), respectively, and so ∥f −h∥[p] = ∥ef −eh∥[p] < ǫ,
proving continuity of the solution mapping S≺
[·,b). The same change of variables
argument shows continuity of the solution mapping S≺
(·,b], proving the theorem.
2

10.6 Notes
549
10.6 Notes
Notes on Section 10.1. Picard iteration, also known as the method of “suc-
cessive approximation” of solutions, is apparently named for work in 1893 by
´E. Picard [186]. Ince [105, p. 63] gives earlier history and references.
Notes on Section 10.2. Lyons [151] proved Corollary 10.14 in the case
X = M(d, R), the space of d × d real matrices, Z = Y = Rd, h is continuous,
and F is bounded. Banach [6, Th´eor`eme II.6, p. 160] proved the ﬁxed point
theorem 10.21.


11
Fourier Series
11.1 On the Order of Decrease of Fourier Coeﬃcients
Let T 1 := {z : |z| = 1} = {eiθ : 0 ≤θ < 2π} be the unit circle in the complex
plane C. On T 1 let dµ = dθ/2π be the rotationally invariant probability
measure. For Z = {0, ±1, ±2, . . .}, the functions z 7→zn or θ 7→einθ for n ∈Z
form an orthonormal basis of complex L2(T 1, µ) (e.g. [53], Proposition 7.4.2).
For g ∈L1(T 1, µ), deﬁning the coeﬃcients cn := bg(n) := ∫g(z)z−n dµ yields
the formal series
g ∼
X
n∈Z
cnzn.
(11.1)
If g ∈L2(T 1, µ), the series converges unconditionally (as deﬁned in Chapter
1) to g in L2(T 1, µ). For general g ∈L1(T 1, µ) and z ∈T 1, let
Smg(z) :=
X
|n|≤m
cnzn,
m = 0, 1, 2, . . ..
(11.2)
There is a one-to-one correspondence between functions f : R →C, peri-
odic of period 2π, and functions g: T 1 →C, given by g(eit) = f(t), t ∈R.
For such a pair we will write
g = ˙f
(11.3)
(the latter notation is as in Edwards [63, p. 15]). We will set bf(n) = cn = bg(n).
For f ∈L1([0, 2π]; C) (with respect to Lebesgue measure) the formal series
(11.1) corresponds to
f(θ) ∼
X
n∈Z
cneinθ,
(11.4)
which has been called the exponential Fourier series of f. In terms of trigono-
metric functions we get another series
f(θ) ∼c0 +
∞
X
n=1
an cos(nθ) + bn sin(nθ),
(11.5)
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_11, 
551

552
11 Fourier Series
called the Fourier series of f (or of g). Here an := cn + c−n and bn :=
i(cn −c−n) for n ≥1. Then
cn = (an −ibn)/2
and
c−n = (an + ibn)/2
for n ≥1.
(11.6)
For a complex number w = u +iv with u, v real, the complex conjugate is de-
ﬁned by w := u−iv. A function f in L1([0, 2π]; C) is real-valued (equivalently,
˙f in L1(T 1, µ) is) if and only if c−n = cn for all n, which holds if and only if
c0 and an, bn for n ≥1 are all real-valued. In that case |cn|2 = (a2
n + b2
n)/4
for n ≥1.
The Fourier series converges to f (in whatever sense) if and only if for
g =
˙f, the sequence Smg converges to g in the same sense as m →∞.
Speciﬁcally, the Fourier series of f converges to f at a given θ if and only
if limm→∞Smg(eiθ) = g(eiθ). Regarding such pointwise convergence, Kol-
mogorov [119] showed that for g ∈L1(T 1, µ) the Fourier series may diverge
everywhere. Carleson [29] for p = 2 (and thus for p ≥2) showed that if
g ∈Lp(T 1, µ), then the Fourier series converges almost everywhere to g.
Carleson conjectured, and R. A. Hunt [104] proved, that the same holds
for 1 < p < 2. The Fourier series of g converges to g in Lp norm for all
g ∈Lp(T 1, µ) if 1 < p < ∞(but not for p = 1 or ∞). This is a consequence
of the theorem of Marcel Riesz about boundedness of the Hilbert transform
in Lp-spaces (see Section 12.10 in Edwards [63]).
For g ∈L1(T 1, µ), the partial sums (11.2) may not converge to g in L1
norm (see e.g. Section II.1.2 in Katznelson [114], or Proposition 1.6.14 in
Krantz [126]). For positive integers N, let σNg be the Ces`aro sum deﬁned by
σNg(z) :=
1
N + 1
N
X
m=0
Smg(z) =
X
|n|≤N

1 −
|n|
N + 1

cnzn,
z ∈T 1.
By the Fej´er theorem (Theorem III.3.4 in [258, p. 89]),
lim
N→∞σNg(eiθ) = 1
2

g(eiθ+) + g(eiθ−)]
(11.7)
at each point eiθ ∈T 1 such that the right side of (11.7) is deﬁned, and
σNg converges to g uniformly if g is continuous. For a summable function
g, Lebesgue proved (Theorem III.3.9 in [258, p. 90]) that σNg converges to g
almost everywhere. More precisely, if z = eiθ ∈T 1 is such that
lim
h↓0
1
h
Z h
0
g(ei(θ+φ)) + g(ei(θ−φ)) −2g(eiθ)
 dφ = 0
then σNg(z) →g(z) as N →∞. In the norm sense for g ∈L1(T 1, µ), the
Fourier series of g is summable in L1 to g by means of a family of summa-
bility kernels, which includes the Fej´er and Poisson kernels (see Section I.2 in
Katznelson [114] and Section 1.4 in Krantz [126]). Thus, σNg →g as N →∞
in L1 norm.

11.1 On the Order of Decrease of Fourier Coeﬃcients
553
For 1 ≤p ≤2, the Hausdorﬀ–Young inequality (co-named for W. H.
Young) states that if f ∈Lp(T 1, µ) then the sequences {an}, {bn}, and {cn}
are in the set ℓq = {{dn}: P
n |dn|q < ∞}, where 1/p + 1/q = 1. For 2 <
p ≤∞, stronger integrability conditions do not provide any improvement
beyond ℓ2 on the order of the Fourier coeﬃcients. For f continuous on T 1
(= continuous in θ and periodic of period 2π), Carleman [28] showed that
{cn} need not be in ℓ2−ǫ for any ǫ > 0. Orlicz [182] showed that for any
{dn : n ∈Z} ̸∈ℓ2 one can have P
n |cndn| = +∞. Bary [10, pp. 338–340]
gives a proof.
If f is real-valued, periodic of period 2π, and on [0, 2π] satisﬁes the H¨older
condition
|f(θ′) −f(θ′′)| ≤K|θ′ −θ′′|α,
(11.8)
where 0 < α ≤1, then |cn| = O(|n|−α) as n →∞, as will be shown next.
Functions H¨older of order α on a bounded interval have bounded 1/α-variation
as shown by (1.7). So more generally, let f ∈Wp[0, 2π] for some 1 < p < ∞
and let gn(θ) = cos(nθ) or sin(nθ) on [0, 2π]. It is easily seen that vq(gn) ≤
2n · 2q for any 1 ≤q < ∞. For any q ≥1 such that p−1 + q−1 > 1, by the
Love–Young inequality (3.148),
|an| =
 1
π
Z 2π
0
f(θ) d sin(nθ)/n
 ≤21+1/qπ−1Kp,q∥f∥[p]n−1+1/q = O(n−r)
for r = (1 −1/q) < 1/p, and so for any r < 1/p. In fact, Marcinkiewicz [156,
Theorem 3] proved that this is true for r = 1/p. His proof is based on the
following observation:
Lemma 11.1. Let f be a real-valued periodic function on R with period 2π
and of bounded p-variation on [0, 2π] for some 0 < p < ∞. Then for 0 < φ ≤
π,
Z 2π
0
|f(θ + φ) −f(θ)|p dθ ≤2φvp(f; [0, 2π]).
(11.9)
Proof. Let n ≥2 be the integer part of 2π/φ, so 0 ≤2π −nφ < φ. Let
(∆φf)(θ) := f(θ + φ) −f(θ). By a change of variables, we then have
Z 2π−φ
0
|∆φf(θ)|pdθ
=
n−1
X
i=1
Z φ
0
|∆φf(θ + (i −1)φ)|p dθ +
Z 2π−nφ
0
|∆φf(θ + (n −1)φ)|p dθ
=
Z 2π−nφ
0
n
X
i=1
|∆φf(θ+(i −1)φ)|p dθ+
Z φ
2π−nφ
n−1
X
i=1
|∆φf(θ+(i −1)φ)|p dθ
≤φvp(f; [0, 2π]).

554
11 Fourier Series
Also due to periodicity of f, |∆φf(θ)|p = |f(θ+φ−2π)−f(θ)|p ≤vp(f; [0, 2π])
for each θ ∈[2π −φ, 2π], and so
Z 2π
2π−φ
|∆φf(θ)|p dθ ≤φvp(f; [0, 2π]),
proving (11.9).
2
Returning to bounds for the Fourier coeﬃcients, we have the following:
Theorem 11.2 (Marcinkiewicz). For any p with 1 ≤p < ∞and f ∈
Wp[0, 2π], its Fourier coeﬃcients are of order |an|∨|bn| ≤2|cn| = O(|n|−1/p).
Proof. It is easily seen that the identity function g(θ) = θ, 0 ≤θ ≤2π, is in
Wp[0, 2π] with vp(g) = (2π)p and that its Fourier coeﬃcients are bg(n) = i/n
for n ̸= 0, which are O(|n|−1/p). Thus we can subtract a constant multiple of
g from f and assume that f(0) = f(2π). Then f has a unique extension to be
periodic of period 2π on all of R.
Due to periodicity, we then have
cn = 1
2π
Z 2π
0
f(θ)e−inθ dθ = 1
4π
Z 2π
0
h
f(θ) −f

θ + π
n
 i
e−inθ dθ
for each n ∈Z \ {0}. Thus by H¨older’s inequality for integrals and (11.9), it
follows that
|cn| ≤1
4π
Z 2π
0
f(θ) −f

θ + π
n
  dθ
≤(2π)1−(1/p)
4π
 Z 2π
0
f(θ) −f

θ + π
n
 
p
dθ
1/p
≤2−1|n|−1/p∥f∥[0,2π],(p).
Using |cn|2 = (a2
n + b2
n)/4 as mentioned after (11.6) completes the proof. 2
Remark 11.3. Proposition 3.46 with hk ≡1 shows that the previous the-
orem is sharp in that |cn| need not be o(|n|−1/p). Perhaps surprisingly, the
Fourier series of a function f ∈Wp[0, 1] or f ∈Wp[0, 2π] may converge to it
uniformly and absolutely while the terms do not approach 0 in Wp.
11.2 Uniform Convergence
Let f be a complex-valued periodic function on R with period 2π, integrable on
[0, 2π], so that it has a well-deﬁned Fourier series (which does not necessarily

11.2 Uniform Convergence
555
converge to it anywhere in general). In this section it is proved (Theorem 11.8
below) that the Fourier series of f converges to f uniformly if f is continuous
and has bounded Φ-variation under a hypothesis on Φ. In particular, each
continuous function of bounded p-variation for some p with 0 < p < ∞has
its Fourier series converging uniformly (Corollary 11.10). It is also shown that
the hypothesis on Φ is best possible (Theorem 11.13).
We begin by recalling a test for convergence of Fourier series. The partial
Fourier sums Umf are deﬁned for each positive integer m and x ∈R by
Umf(x) := Sm ˙f(eix), using the deﬁnitions (11.2) and (11.3), in other words,
Umf(x) :=
X
|n|≤m
bf(n)einx.
If Umf(x) →f(x) uniformly in x as m →∞then we say that the Fourier
series converges uniformly. For each m ≥1 deﬁne the Dirichlet kernel Dm
and the simpliﬁed Dirichlet kernel D∗
m respectively by
Dm(t) :=
X
|n|≤m
eint =
(
sin(m+1/2)t
sin(t/2)
if t ̸∈2πZ,
2m + 1
if t ∈2πZ,
and
D∗
m(t) :=

2 sin mt
t
if 0 < |t| ≤π,
2m
if t = 0,
and extending D∗
m to R to be periodic of period 2π, as Dm clearly is. Inserting
the integral expressions for the Fourier coeﬃcients bf(n), by periodicity we have
Umf(x) = 1
2π
Z 2π
0
f(t)Dm(t −x) dt = 1
2π
Z π
−π
f(x + t)Dm(t) dt.
(11.10)
We will see that Dm equals the simpler function D∗
m plus a function which
is bounded uniformly in m and x. To this aim let h(t) := 1/ tan(t/2) −2/t if
0 ̸= t ∈[−π, π) and h(0) := 0, where 1/ tan(−π/2) := 0 and 1/ tan(π/2) := 0.
Let h be periodic of period 2π. By the Taylor series of the tangent function
around 0, we have |h(t)| = O(|t|) as t →0 and so h is continuous at 0 and
thus on [0, 2π] and bounded on R. Then we can write for all t ∈R,
Dm(t) = sin(m + 1/2)t
sin(t/2)
=
sin mt
tan(t/2) + cos mt
= D∗
m(t) + h(t) sin mt + cos mt,
(11.11)
where h(t) sin(mt) + cos(mt) is indeed bounded uniformly in m and t. We
show next that for f regulated,
lim
m→∞
Z π
−π
f(x + t)

h(t) sin mt + cos mt

dt = 0
(11.12)
uniformly in x.

556
11 Fourier Series
Lemma 11.4. If f and h are regulated and periodic of period 2π, then
lim
m→∞
Z π
−π
f(x+t)h(t) sin mt dt = lim
m→∞
Z π
−π
f(x+t)h(t) cosmt dt = 0 (11.13)
uniformly in x.
Proof. Let ηx(t) := f(x + t)h(t), and let ∆tρ(s) := ρ(t + s) −ρ(t) for ρ = f or
ρ = h. For a periodic integrable function ρ, its integral modulus of continuity
w1(ρ; u) is deﬁned for u ≥0 by
w1(ρ; u) := sup
|s|≤u
Z π
−π
∆tρ(s)
 dt.
By periodicity, for any x we have
2

Z π
−π
ηx(t) sin mt dt

=

Z π
−π

ηx(t) −ηx

t + π
m
 
sin mt dt
 ≤
Z π
−π
ηx(t) −ηx

t + π
m
  dt
≤
Z π
−π
∆x+tf(π/m)
h(t + π/m)
 dt +
Z π
−π
f(x + t)
∆th(π/m)
 dt
≤∥h∥∞w1(f; π/m) + ∥f∥∞w1(h; π/m).
Since f and h are each bounded and continuous except at most on countable
sets by Corollary 2.2, the right side of the preceding bound tends to zero as
m →∞by Lebesgue’s dominated convergence theorem. Thus the ﬁrst limit
in (11.13) exists uniformly in x and is zero. The same proof applies to the
second limit, proving the lemma.
2
Therefore (11.12) holds uniformly in x, replacing h(t) by 1 in the cosine
term, which together with (11.10) and (11.11) yields the relations
Umf(x) = 1
2π
Z π
−π
f(x + t)D∗
m(t) dt + o(1)
as m →∞
(11.14)
= 1
2π
Z π
0

f(x + t) + f(x −t)

D∗
m(t) dt + o(1)
as m →∞
uniformly in x. The second relation (11.14) holds because D∗
m(−t) ≡D∗
m(t).
Since for f ≡1, its partial Fourier sums Umf are identically 1 for each m ≥1,
by the preceding relation we have that
1 = 1
π
Z π
0
D∗
m(t) dt + o(1)
as m →∞.

11.2 Uniform Convergence
557
Multiplying both sides by g(x) for a function g, and then combining with
(11.14), we can further write
Umf(x)−g(x) = 1
2π
Z π
0

f(x+t)+f(x−t)−2g(x)

D∗
m(t) dt+o(1)
as m →∞.
We are ready to prove the following test:
Proposition 11.5. For a complex-valued regulated function f periodic of pe-
riod 2π, its Fourier series converges to g at x (resp. uniformly) if and only
if
lim
m→∞
Z π
0

f(x + t) + f(x −t) −2g(x)

D∗
m(t) dt = 0
(11.15)
(respectively, uniformly in x). Moreover, for f ≡g, the same equivalences
hold if m →∞through odd values,
lim
n→∞
Z π
0

f(x + t) + f(x −t) −2f(x)

D∗
2n+1(t) dt = 0.
(11.16)
Remark 11.6. The values of f can be changed on a set of measure 0 without
changing its Fourier series, in particular, changed on a countable set {ak} ⊂
[0, 2π), e.g., if f is regulated, the jumps of f, by amounts ck →0, while
preserving the regulated property. A question is, if the Fourier series converges
at a point, to what does it converge. One possibility is, if f is regulated, to set
g(x) := [f(x+) + f(x−)]/2, which equals f except possibly on the countable
set of jumps of f, and diﬀers from it there if f is left- or right-continuous.
Marcinkiewicz [156, Theorem 5] proved that the Fourier series of f converges
pointwise everywhere to g if the p-variation of f is bounded for some p < ∞.
Wiener [241] had proved this fact for p ≤2. Recall that the Fourier series of a
continuous function can diverge at some points as shown by du Bois-Reymond
in 1876; see e.g. [53, Proposition 7.4.3].
Proof. The ﬁrst sentence of the proposition has already been proved. For the
second, letting ∆xf(u) := f(x + u) −f(x), for each m ≥1 and x, the integral
in (11.15) with g ≡f is
Im(x) :=
Z π
0

f(x + t) + f(x −t) −2f(x)

D∗
m(t) dt =
Z π
−π
∆xf(t)D∗
m(t) dt.
By Lemma 11.4, we have
Im+1(x) −Im(x) =
Z π
−π
∆xf(t)
h2(cost −1)
t
sin mt + 2 sin t
t
cos mt
i
dt = o(1)
(11.17)
as m →∞uniformly in x. Thus the second sentence of the proposition,
showing equivalences with (11.16), follows.
2

558
11 Fourier Series
A more specialized test will be proved assuming in addition that f is
continuous. For x ∈R and for a positive integer n, let
T +
n (x) :=
n
X
j=1
1
2j −1

f

x + (2j −1)π
2n + 1

−f

x +
2jπ
2n + 1

(11.18)
and
T −
n (x) :=
n
X
j=1
1
2j −1

f

x −(2j −1)π
2n + 1

−f

x −
2jπ
2n + 1

.
(11.19)
Proposition 11.7. For a continuous periodic function f, its Fourier series
converges to f at x (uniformly) if and only if
lim
n→∞
Z π
0
h
T +
n

x +
t
2n + 1

+ T −
n

x −
t
2n + 1
i
sin t dt = 0
(11.20)
for x (respectively, uniformly in x).
Proof. For x ∈R and for a positive integer m, let
I+
m(x) :=
Z π
0
∆xf(t)D∗
m(t) dt
and
I−
m(x) :=
Z π
0
∆xf(−t)D∗
m(t) dt.
Call the integral in (11.16) I2n+1(x). Then I2n+1(x) = I+
2n+1(x) + I−
2n+1(x).
We will show that as n →∞, uniformly in x,
I+
2n+1(x) = −2
π
Z π
0
T +
n

x +
t
2n + 1

sin t dt + o(1),
(11.21)
as well as
I−
2n+1(x) = −2
π
Z π
0
T −
n

x −
t
2n + 1

sin t dt + o(1).
(11.22)
Then the statement of the proposition will follow by the second part of Propo-
sition 11.5.
Let w(f; u) := sup{|f(t) −f(s)|: |t −s| ≤u}, u ≥0, be the modulus of
continuity of f, and let m ≥3. Since sin x ≤x for 0 ≤x ≤π, for the integral
I+
m over the interval [0, π/m], we have

Z π/m
0
∆xf(t)D∗
m(t) dt
 ≤2πw(f; π/m) = o(1)
as m →∞
uniformly in x. For the integral I+
m over the remaining interval [π/m, π], chang-
ing variables twice, we have

11.2 Uniform Convergence
559
Z π
π/m
∆xf(t)D∗
m(t) dt =
m−2
X
k=0
Z (k+2)π/m
(k+1)π/m
∆xf(t)2 sin mt
t
dt
=
m−2
X
k=0
Z 2π/m
π/m
∆xf

u + kπ
m
(−1)k2 sin mu
u + kπ/m
du
= 2
Z 2π
π
Fm(v, x) sin v dv,
where
Fm(v, x) :=
m−2
X
k=0
∆xf
v + kπ
m
 (−1)k
v + kπ .
We have
I+
m(x) = 2
Z 2π
π
Fm(t, x) sin t dt + o(1)
as m →∞.
(11.23)
To prove (11.21), we have
F2n+1(t, x) =
n
X
j=1
n
∆xf
t + (2j −2)π
2n + 1

1
t + (2j −2)π
−∆xf
t + (2j −1)π
2n + 1

1
t + (2j −1)π
o
.
For j = 1, . . . , n, the jth term uj of the latter sum can be written as
uj := ∆xf
t + (2j −2)π
2n + 1

1
t + (2j −2)π
−∆xf
t + (2j −1)π
2n + 1

1
t + (2j −1)π
=

f

x + t + (2j −2)π
2n + 1

−f

x + t + (2j −1)π
2n + 1

1
(2j −1)π
+

f

x + t + (2j −2)π
2n + 1

−f

x + t + (2j −1)π
2n + 1

×
×

1
t + (2j −2)π −
1
(2j −1)π

+ ∆xf
t + (2j −1)π
2n + 1
 
1
t + (2j −2)π −
1
t + (2j −1)π

=:
3
X
l=1
ul,j(t, x).

560
11 Fourier Series
Thus F2n+1(t, x) = S1,n(t, x) + S2,n(t, x) + S3,n(t, x), where Sl,n(t, x) :=
Pn
j=1 ul,j(t, x) for l = 1, 2, 3.
We show next that S2,n and S3,n tend to zero as n →∞uniformly in x
and t ∈[π, 2π]. For π ≤t ≤2π and each j ≥1, we have that the maximum

1
(2j −1)π −
1
t + (2j −2)π

∨

1
t + (2j −2)π −
1
t + (2j −1)π

is in the interval [0, 1/(π(2j−1)2)]. Letting j(n) be the integer part of √2n + 1,
for π ≤t ≤2π we have
|S3,n(t, x)|
≤
n
X
j=1
f

x + t + (2j −1)π
2n + 1

−f(x)


1
t + (2j −2)π −
1
t + (2j −1)π

≤w

f; π + 2π√2n + 1
2n + 1
 j(n)
X
j=1
1
π(2j −1)2 + 2∥f∥∞
n
X
j=j(n)+1
1
π(2j −1)2 .
Since j(n) →∞as n →∞, we get that |S3,n(t, x)| = o(1) as n →∞uniformly
in x and t ∈[π, 2π]. For S2,n, we have the bound
|S2,n(t, x)| ≤
n
X
j=1
f

x + t + (2j −2)π
2n + 1

−f

x + t + (2j −1)π
2n + 1
 ×
×

1
t + (2j −2)π −
1
(2j −1)π

≤w

f;
π
2n + 1
 ∞
X
j=1
1
π(2j −1)2 = π
8 w

f;
π
2n + 1

.
Again the right side, and hence |S2,n(t, x)|, is of order o(1) as n →∞uniformly
in x and t ∈[π, 2π]. For T +
n deﬁned by (11.18), we have T +
n (x + (t −π)/(2n +
1)) = πS1,n(t, x). Thus
Z 2π
π
F2n+1(t, x) sin t dt
= 1
π
Z 2π
π
T +
n

x + t −π
2n + 1

sin t dt +
Z 2π
π

S2,n(t, x) + S3,n(t, x)

sin t dt
= −1
π
Z π
0
T +
n

x +
t
2n + 1

sin t dt + o(1)
as n →∞
(11.24)
uniformly in x by the dominated convergence theorem. This together with
(11.23) proves (11.21).

11.2 Uniform Convergence
561
To prove (11.22), we can apply essentially the same proof to the integral
I−
m(x). Now Fm and uj are replaced by expressions in which ∆xf(w) for
each w occurring is replaced by ∆xf(−w), and so f(x + w) −f(x + v) =
∆xf(w) −∆xf(v) is replaced by f(x −w) −f(x −v) for the w and v in the
proof. We then get, instead of (11.23) and (11.24), the following relations with
m = 2n + 1:
I−
m(x) = 2
Z 2π
π
 m−2
X
k=0
∆xf
−t −kπ
m
 (−1)k
t + kπ

sin t dt + o(1)
as m →∞
= −2
π
Z π
0
T −
n

x −
t
2n + 1

sin t dt + o(1)
as n →∞
uniformly in x. Thus (11.22) holds, proving the proposition.
2
Recall that V is the class of all functions Φ: [0, ∞) →[0, ∞) which are
strictly increasing, continuous, unbounded, and 0 at 0, CV is the subclass of
convex functions in V, and CV∗is the class of all functions Φ ∈CV satisfying
(3.18). Recalling the deﬁnition (3.17) of the complementary function Φ∗, now
we are ready to prove the following result of Salem:
Theorem 11.8. Let Φ∗be the complementary function to Φ ∈CV∗. If
∞
X
j=1
Φ∗(1/j) < ∞
(11.25)
then every continuous periodic function of bounded Φ-variation has uniformly
convergent Fourier series.
For the proof we use the following fact:
Lemma 11.9. Let Ψ ∈V. If for some a > 0, P
k≥1 Ψ(a/k) < ∞, then
P
k≥1 Ψ(b/k) < ∞for any b > 0, and there is a sequence ck ↑+∞with
ck ≥1 for all k such that P
k≥1 Ψ(ck/k) < ∞.
Proof. If b ≤a the convergence is clear, so assume b > a. Let N be the least
integer greater than or equal to the ratio r := b/a. Then we have
X
k>r
Ψ
 b
k

≤
∞
X
j=1
X
Nj≤k<N(j+1)
Ψ
 b
k

≤N
X
j≥1
Ψ
a
j

< ∞.
This proves the ﬁrst part of the conclusion and that for each n ≥1,
P
k≥1 Ψ(n/k) < ∞. Thus for n = 1, 2, . . . , there is a least integer kn such
that P
k>kn Ψ(n/k) < 1/2n. Let ck := n for kn < k ≤kn+1 for each n and
ck := 1 for k ≤k1. Then

562
11 Fourier Series
X
k>k1
Ψ
ck
k

=
∞
X
n=1
X
kn<k≤kn+1
Ψ
ck
k

≤
X
n≥1
2−n < ∞,
completing the proof of the lemma.
2
Proof of Theorem 11.8. By Proposition 11.7 and the dominated conver-
gence theorem, it is enough to prove that T +
n (x) and T −
n (x) tend to zero as
n →∞uniformly in x ∈[0, 2π]. Let Φ ∈CV∗be such that P
j≥1 Φ∗(1/j) < ∞.
By Proposition 3.11, Φ∗∈CV∗⊂V, and so by Lemma 11.9, there is a se-
quence ǫj ↓0 such that P
j≥1 Φ∗(1/(jǫj)) < ∞. For j = 1, . . . , n, n ≥1, and
x ∈[0, 2π], let
uj,n(x) :=
1
ǫj(2j −1)
f

x + (2j −1)π
2n + 1

−f

x +
2jπ
2n + 1
.
(11.26)
Then by the W. H. Young inequality (3.19), for each n ≥1, we have the bound
n
X
j=1
uj,n(x)
≤
n
X
j=1
Φ
f

x + (2j −1)π
2n + 1

−f

x +
2jπ
2n + 1


+
n
X
j=1
Φ∗
1
ǫj(2j −1)

≤vΦ(f; [0, 3π]) +
∞
X
j=1
Φ∗ 1
jǫj

=: A.
Thus for n > 2 and x ∈[0, 2π], it follows by the deﬁnition (11.18) of T +
n that
|T +
n (x)| ≤
k−1
X
j=1
1
2j −1
f

x + (2j −1)π
2n + 1

−f

x +
2jπ
2n + 1
 +
n
X
j=k
ǫjuj,n(x)
≤w

f;
π
2n + 1
 
1 + 1
3 + · · · +
1
2k −3

+ ǫkA
(11.27)
for any 1 < k < n. Since the modulus of continuity w(f; π/(2n + 1)) tends
to zero as n →∞, the right side of (11.27) can be made arbitrarily small
by ﬁrst choosing k large enough so that ǫk is small enough and then n large
enough. Therefore T +
n (x) tends to zero as n →∞uniformly in x ∈[0, 2π]. If
in (11.26), π is replaced by −π then the same arguments imply that T −
n (x)
tends to zero as n →∞uniformly in x ∈[0, 2π], proving the theorem.
2
The next fact then follows:
Corollary 11.10. Let 0 < p < ∞. Then every continuous function f of
bounded p-variation has uniformly convergent Fourier series.

11.2 Uniform Convergence
563
Proof. It suﬃces to consider 1 < p < ∞since then the cases 0 < p ≤1 will
follow by Lemma 3.45. (Also, for 0 < p < 1, f, being continuous, must be
constant by Theorem 2.11 in [54, Part II].) For Φ(u) ≡up/p we then have
Φ ∈CV∗, and its complementary function Φ∗(v) ≡vq/q with q = p/(p−1) > 1,
as in the example just after (3.19). Thus the hypothesis (11.25) holds and the
result follows from Theorem 11.8.
2
For a continuous periodic function f, let In(f; x) be the integral in (11.20),
that is, for a positive integer n and x ∈R,
In(f; x)
(11.28)
=
n
X
j=1
1
2j −1
Z π
0
n
f

x + t + (2j −1)π
2n + 1

−f

x + t + 2jπ
2n + 1
o
sin t dt
+
n
X
j=1
1
2j −1
Z π
0
n
f

x −t + (2j −1)π
2n + 1

−f

x −t + 2jπ
2n + 1
o
sin t dt.
By Proposition 11.7, the Fourier series of f converges at x if and only if In(f, x)
tends to zero as n →∞. In the rest of this section we show that the hypothesis
(11.25) is necessary, that is, if Φ ∈CV∗is such that P
k≥1 Φ∗(1/k) = ∞, then
there exists a continuous periodic function f ∈WΦ for which In(f; 0) does
not converge to zero.
For Φ ∈CV, let ℓΦ be the set of all sequences of real numbers a = {ak}k≥1
such that P
k≥1 Φ(|ak|/c) < ∞for some c > 0. The space ℓΦ equipped with
the norm
∥a∥Φ := inf
n
c > 0:
X
k≥1
Φ(|ak|/c) ≤1
o
is a Banach space, usually called an Orlicz sequence space (see Section 4 in
[142]). Luxemburg norms on Orlicz spaces were deﬁned more generally in
(1.24). If in addition Φ satisﬁes the conditions (3.18), that is, if Φ ∈CV∗, then
its complementary function Φ∗is deﬁned and one can deﬁne another norm on
ℓΦ by
|||a|||Φ := sup
n X
k≥1
|ak|βk : βk ≥0,
X
k≥1
Φ∗(βk) ≤1
o
.
Then ∥· ∥Φ and ||| · |||Φ are two equivalent norms on ℓΦ: for all a ∈ℓφ,
∥a∥Φ ≤|||a|||Φ ≤2∥a∥Φ.
(11.29)
The proof of (11.29) is similar to the proof of Proposition 3.12 and we omit it.
Let φ∗be the inverse function to Φ∗. Then for any k′ ≥1, taking βk′ = φ∗(1)
and βk = 0 if k ̸= k′, we get the bound |ak′|φ∗(1) ≤|||a|||Φ, and so
∥a∥sup ≤|||a|||Φ/φ∗(1).
(11.30)

564
11 Fourier Series
By Proposition 3.11, Φ∗∈CV∗⊂V, and so by Lemma 11.9, the suﬃcient
condition (11.25) of Theorem 11.8 is equivalent to the condition that the
sequence {1/k}k≥1 is in the Orlicz sequence space ℓΦ∗. Also, by Proposition
3.11 again, the norm ||| · |||Φ∗is well deﬁned, and Φ∗∗= Φ. These facts will
be used next to derive certain implications on ℓΦ from the assumption that
{1/k}k≥1 ̸∈ℓΦ∗.
Lemma 11.11. Let Φ∗be the complementary function to Φ ∈CV∗. If
P
k≥1 Φ∗(1/k) = +∞, then given ǫ > 0, there exists a sequence a = {ak}
with all ak ≥0 such that ak = 0 for all suﬃciently large k, |||a|||Φ ≤ǫ, and
P
k≥1 k−1ak > 1.
Proof. For each integer n ≥1, let bn
k := 1/k for k = 1, . . . , n, and let bn
k := 0
for k > n. Letting bn := {bn
k}k≥1 we then have |||bn|||Φ∗↑∞as n →∞,
as follows. Clearly |||bn|||Φ∗is nondecreasing in n. By (11.29) it suﬃces to
prove that ∥bn∥Φ∗↑∞. If not, then there is a positive integer M such that
∥bn∥Φ∗≤M for all n. It then follows that P
k≥1 Φ∗(1/(Mk)) ≤1. Thus by
Lemma 11.9, P
j≥1 Φ∗(1/j) < ∞, a contradiction, proving the claim. Let n
be so large that |||bn|||Φ∗> 2ǫ−1. Since Φ∗∗= Φ, there exists d = {dk}k≥1 ∈ℓΦ
with all dk ≥0 such that P
k≥1 Φ(dk) ≤1 and Pn
k=1 k−1dk > 2ǫ−1. We can
assume that dk = 0 for all k > n. Also ∥d∥Φ ≤1 implies by (11.29) that
|||d|||Φ ≤2. Thus a := (ǫ/2)d satisﬁes the conclusion.
2
Now assuming Φ ∈CV∗, recall the deﬁnition (3.23) of ||| · |||J,(Φ), which on
f
WΦ is a seminorm equivalent to the seminorm ∥· ∥J,(Φ) by Proposition 3.12.
Let |||f|||(Φ) := |||f|||[−π,π],(Φ) for a function f periodic of period 2π.
Lemma 11.12. For Φ ∈CV∗, let a = {ak} ∈ℓΦ with all ak ≥0 be such that
for some m > 1, ak = 0 if k > m, let n ≥m and ǫ > 0. Then there exists
a function f, continuous and periodic of period 2π, with the following three
properties:
(a) f ≥0, f(t) = 0 for t ∈[−π, π/(2n+1)]∪[2mπ/(2n+1), π], and supt f(t) =
maxk ak;
(b) for In(f; x) deﬁned by (11.28),
In(f; 0) =
m
X
j=1
1
2j −1
Z π
0
n
f
t + (2j −1)π
2n + 1

−f
t + 2jπ
2n + 1
o
sin t dt
>
X
k≥1
ak
k −ǫ;
(c) |||f|||(Φ) ≤2|||a|||Φ.
Proof. Let ui := iπ/(2n + 1) for i = 1, . . . , 2m, and let vi, i = 1, . . . , 2m, be
such that u2j−1 < v2j−1 < v2j < u2j for j = 1, . . . , m. Deﬁne a function f on

11.2 Uniform Convergence
565
[−π, π] to be zero on [−π, π/(2n + 1)] ∪[2mπ/(2n + 1), π] and on [u2j, u2j+1],
j = 1, . . . , m −1. Let f be equal to aj on [v2j−1, v2j] for j = 1, . . . , m, and
let f be linear on the remaining intervals and continuous on [−π, π]. For
j = 1, . . . , m, choose v2j−1 and v2j such that
Ij :=
Z π
0
n
f
t + (2j −1)π
2n + 1

−f
t + 2jπ
2n + 1
o
sin t dt > 2aj −2−jǫ.
This is possible because (t + 2jπ)/(2n + 1) ∈[u2j, u2j+1] for t ∈[0, π]. Let
t2j−1 := v2j−1(2n + 1) −(2j −1)π and t2j := v2j(2n + 1) −(2j −1)π. Then
Ij =
Z π
0
f
t + (2j −1)π
2n + 1

sin t dt ≥aj
Z t2j
t2j−1
sin t dt ↑2aj
as t2j−1 ↓0 and t2j ↑π. Extend f to R by periodicity. Then (a) clearly holds.
For (b), since f is zero on [−π, u1] ∪[u2m, π], we have
In(f; 0) =
m
X
j=1
1
2j −1Ij >
m
X
j=1
2aj −2−jǫ
2j −1
>
X
k≥1
k−1ak −ǫ.
To prove (c), let κ = {ti}n
i=0 be a partition of [−π, π] and let {βi}n
i=1 be
nonnegative real numbers such that Pn
i=1 Φ∗(βi) ≤1. First suppose that κ
is a reﬁnement of the partition λ of [−π, π] formed by the points {−π, 0, π}
and {ui, vi : i = 1, . . . , 2m}, that is, λ ⊂κ. For j = 1, . . . , m, let Aj :=
{i: u2j−1 < ti ≤v2j−1} and Bj := {i: v2j < ti ≤u2j}. The sets Aj and Bj
are 2m disjoint nonempty sets of values of i. Let ∆if := f(ti) −f(ti−1) for
i = 1, . . . , n. Then ∆if = 0 if i ̸∈∪m
j=1(Aj ∪Bj), and for each j = 1, . . . , m,
X
i∈Aj
|∆if| = aj
and
X
i∈Bj
|∆if| = aj.
Thus letting β′
j := maxi∈Aj βi and β′′
j := maxi∈Bj βi, we have Pm
j=1 Φ∗(β′
j) ≤
Pn
i=1 Φ∗(βi) ≤1 and Pm
j=1 Φ∗(β′′
j ) ≤Pn
i=1 Φ∗(βi) ≤1, and so
n
X
i=1
|∆if|βi =
m
X
j=1
 X
i∈Aj
|∆if|βi +
X
i∈Bj
|∆if|βi

≤
m
X
j=1
ajβ′
j +
m
X
j=1
ajβ′′
j ≤2|||a|||Φ
(11.31)
for each reﬁnement κ of λ. To prove (c) it suﬃces to prove (11.31) for an
arbitrary partition κ of [−π, π], so suppose that λ \ κ is nonempty. Let κ′ =
{yl : l = 0, . . . , r} := λ ∪κ, that is, κ′ is the least common reﬁnement of κ
and λ. With each index i ∈{1, . . . , n} of κ we will associate a unique index
σ(i) ∈{1, . . . , r} of κ′ such that

566
11 Fourier Series
[yσ(i)−1, yσ(i)] ⊂[ti−1, ti]
and
|∆if| ≤|f(yσ(i)) −f(yσ(i)−1)|.
(11.32)
If f(ti) = f(ti−1) then let σ(i) be such that yσ(i) = ti. Then (11.32) clearly
holds. If f(ti) > f(ti−1) then ti ∈(u2j−1, u2j) for some j = 1, . . . , m. Let σ(i)
be such that yσ(i) = ti if ti ∈(u2j−1, v2j−1], or yσ(i) = v2j−1 if ti ∈(v2j−1, u2j).
Then ∆if ≤f(yσ(i))−f(yσ(i)−1), and so (11.32) holds. If f(ti) < f(ti−1) then
ti−1 ∈(u2j−1, u2j) for some j = 1, . . . , m. Let σ(i) be such that yσ(i)−1 = ti−1
if ti−1 ∈[v2j, u2j), or yσ(i)−1 = v2j if ti−1 ∈(u2j−1, v2j). Then −∆if ≤
f(yσ(i)−1) −f(yσ(i)), and (11.32) holds again and so in all cases.
We will show that σ(·) is one-to-one. Suppose not. Then for some ℓthere
are two indices i′ ̸= i′′ such that ℓ= σ(i′) = σ(i′′). By the ﬁrst relation in
(11.32) it follows that the nondegenerate interval [yℓ−1, yℓ] is a subset of two
diﬀerent intervals [ti′−1, ti′] and [ti′′−1, ti′′], which yields a contradiction. So
σ is one-to-one.
For ℓ= 1, . . . , r, let γℓ:= βi if ℓ= σ(i) for some i ∈{1, . . ., n}, and let
γℓ:= 0 if ℓ̸∈{σ(i): i = 1, . . . , n}. Then we have
n
X
i=1
|∆if|βi ≤
n
X
i=1
|f(yσ(i)) −f(yσ(i)−1)|βi
=
r
X
ℓ=1
|f(yℓ) −f(yℓ−1)|γℓ≤2|||a|||Φ
by (11.31) since κ′ is a reﬁnement of λ. The proof of (c), and hence of the
lemma, is complete.
2
Now we are ready to prove the result of Baernstein [5]:
Theorem 11.13. Let Φ∗be the complementary function to Φ ∈CV∗and let
P
k≥1 Φ∗(1/k) = ∞. Then there exists a continuous function periodic of period
2π and of bounded Φ-variation with Fourier series divergent at the point 0.
Proof. For each integer r ≥1, by Lemma 11.11 with ǫ = 2−r−1, there exists
a(r) = {a(r)
k }k≥1 ∈ℓΦ with all a(r)
k
≥0 and a positive integer kr ≥2 such that
a(r)
k
= 0 if k > kr, |||a(r)|||Φ ≤2−r−1, and P
k≥1 k−1a(r)
k
> 1. We can assume
that kr →∞as r ↑+∞. Let n1 ≥k1 and let f1 be the function given by
Lemma 11.12 with a = a(1), n = n1, m = k1, and ǫ = 1. Suppose that we
have already chosen functions f1, . . . , fr−1 and integers n1, . . . , nr−1 for some
r ≥2. Then let nr be an integer so large that
2kr + 1
2nr + 1 <
1
2nr−1 + 1 and w
 r−1
X
i=1
fi;
π
2nr + 1
!
<
1
r log(4nr−1 + 2), (11.33)
where w(h; u) := sup{|h(t) −h(s)|: |t −s| ≤u}, u ≥0. Then nr ≥kr. Let fr
be the function f of Lemma 11.12 obtained with a = a(r), n = nr, m = kr,

11.2 Uniform Convergence
567
and ǫ = 1/r. Continuing this process indeﬁnitely we obtain a sequence of
continuous functions {fr}r≥1 and a sequence of integers {nr}r≥1 satisfying
(11.33). By the ﬁrst relation in (11.33) and by the property (a) of Lemma
11.12 applied to fr and fr−1, the set {t ∈[−π, π]: fr(t) ̸= 0} lies strictly
to the left of the set {t ∈[−π, π]: fr−1(t) ̸= 0}. Thus for each t ∈[−π, π],
fr(t) ̸= 0 for at most one r. Since by (11.30),
sup
t fr(t) = max
k
a(r)
k
≤|||a(r)|||Φ/φ∗(1) ≤2−r−1(φ∗(1))−1 = o(1)
as r →∞, it then follows that P
r≥1 fr converges uniformly, and so the
sum f := P
r≥1 fr is a continuous function. Recall that the space f
WΦ[−π, π]
is complete (a Banach space) by Theorem 3.7(d) for the norm ∥· ∥[Φ] :=
∥· ∥(Φ) + ∥· ∥sup. The norm ||| · |||[Φ] := ||| · |||(Φ) + ∥· ∥sup is equivalent by
Proposition 3.12. Since ||| · |||(Φ) is subadditive, it follows from Lemma 11.12(c)
that
|||f|||(Φ) ≤
∞
X
i=1
|||fi|||(Φ) ≤2
∞
X
i=1
|||a(i)|||Φ ≤1.
It follows by the completeness that f ∈f
WΦ[−π, π] and by Proposition 3.12
again that ∥f∥(Φ) ≤1. By Theorem 3.7(b), f has bounded Φ-variation, f ∈
WΦ[−π, π], in fact vΦ(f; [−π, π]) ≤1.
Now for a given integer r ≥1, consider the integral Inr(f; 0) deﬁned by
(11.28). For a function h, t ∈[0, π], and integers j = 1, . . . , n, n ≥1, let
Wj,n(h; t) := h
t + (2j −1)π
2n + 1

−h
t + 2jπ
2n + 1

.
(11.34)
Each function fi, i ≥1, is zero on [−π, 0], by part (a) of Lemma 11.12. More-
over, by the same part (a), speciﬁcally fi(s) = 0 for s ∈[2kiπ/(2ni + 1), π],
and by the ﬁrst inequality in (11.33) for i in place of r, we have Wj,nr(fi; t) = 0
for each i > r, j = 1, . . . , nr, and t ∈[0, π]; in fact, both values of fi whose
diﬀerence is taken are 0. Thus
Inr(f; 0) = Inr(fr; 0) +
nr
X
j=1
1
2j −1
Z π
0
Wj,nr
 r−1
X
i=1
fi; t
!
sin t dt.
(11.35)
Lemma 11.12(b) with ǫ = 1/r and the choice of a(r)
k
give
Inr(fr; 0) > 1 −r−1.
(11.36)
To bound the sum in (11.35), let mr be the largest integer j ≥2 such that
(2j + 1)/(2nr + 1) < 1/(2nr−1 + 1), which exists by the ﬁrst inequality in
(11.33) since kr ≥2. Thus
2mr + 1
2nr + 1 <
1
2nr−1 + 1 ≤2mr + 3
2nr + 1 ,

568
11 Fourier Series
and so
1 < nr
mr
≤4nr−1 + 2.
Again by Lemma 11.12(a), speciﬁcally fi(s) = 0 for s ∈[−π, π/(2ni +1)], and
by the deﬁnition of mr, Wj,nr(fi; t) = 0 for each i = 1, . . . , r−1, j = 1, . . . , mr,
and t ∈[0, π]. Therefore by the deﬁnition (11.34) of Wj,n and the second
inequality in (11.33), and since for j ≥1, (2j −1)−1 ≤∫j
j−1 x−1 dx, applied
for j ≥mr + 1 ≥3, we have the bound

nr
X
j=1
1
2j −1
Z π
0
Wj,nr
 r−1
X
i=1
fi; t
!
sin t dt

≤πw
 r−1
X
i=1
fi;
π
2nr + 1

nr
X
j=mr+1
1
2j −1 ≤π
r .
(11.37)
In (11.35), applying (11.36) and (11.37), it follows that Inr(f; 0) > 1 −(1 +
π)r−1 for each integer r ≥1. Hence Inr(f; 0) > 1 −o(1) as r →∞. Recalling
the deﬁnition (11.28) of In(f; 0), the Fourier series of f diverges at 0 by
Proposition 11.7. The proof of Theorem 11.13 is complete.
2
To illustrate Theorems 11.8 and 11.13, consider some examples of pairs
of functions Φ, Φ∗∈CV∗deﬁned by their derivatives P, Q, respectively. For
0 < p < ∞, let
Q(t) :=



0
if t = 0,
| log t|−p if 0 < t ≤e−1,
et
if t > e−1,
and P(s) :=



0
if s = 0,
exp{−s−1/p} if 0 < s ≤1,
s/e
if s > 1.
Then Q is the inverse of P. Integrating by parts we get
Φ∗
p(v) :=
Z v
0
Q(t) dt ∼v/| log v|p
as v ↓0.
Also,
Φp(u) :=
Z u
0
P(s) ds < exp{−u−1/p}
for 0 < u ≤1. Then Φp ∈CV∗and Φ∗
p is the complementary function to
Φp as shown after (3.22). Now by Theorems 11.8 and 11.13, every continuous
function of bounded Φp-variation has its Fourier series convergent uniformly
if and only if P
k≥1 k−1(log k)−p < ∞, that is, if and only if 1 < p < ∞.
11.3 Notes
Notes on Section 11.1. Much of the early work on H¨older conditions and on p-
variation was done with Fourier series as one application in view, e.g. Lipschitz

11.3 Notes
569
(1864) [143], Wiener (1924) [241], L. C. Young (1936) [244]. The Hausdorﬀ–
Young inequality is proved in Edwards [63, Theorem 13.5.1]. Theorem 11.2 is
Theorem 3 in Marcinkiewicz [156]. An extension of this fact to several other
classes of functions is given by B. I. Golubov [83, §4].
Notes on Section 11.2. Salem [202] proved Theorem 11.8. Theorem 11.13
is due to Baernstein [5].


12
Stochastic Processes and Φ-Variation
We refer to the book of Kallenberg [112] for probability terminology and will
cite it often, although far from exclusively, for results needed in this chapter.
12.1
Processes with Regulated Sample Functions
Let T ⊂[0, ∞) and let (Ω, F, Pr) be a complete probability space. A real-
valued stochastic process {Xt}t∈T , which may also be written {X(t)}t∈T or
{X(t), t ∈T }, is a function (t, ω) 7→Xt(ω) ≡X(t)(ω) ≡X(t, ω) from T × Ω
into R such that for each t ∈T , Xt is a random variable on Ω. If T = [0, +∞)
we may write {Xt}t≥0, or if T = [0, T] where 0 < T < ∞we may write
{Xt}0≤t≤T. A stochastic process Y = {Yt}t≥0 on the same probability space is
a modiﬁcation of X iﬀfor each t ≥0, Xt = Yt almost surely (with probability
1). For each ω ∈Ω, the function X· = X·(ω) is called a sample function
of X. A stochastic process X = {Xt}t≥0 has regulated sample functions if
X·(ω) ∈R[0, ∞) for almost all ω ∈Ω. Then we write X ∈R[0, ∞). In
probability theory sample functions of stochastic processes are often assumed
to be regulated and right-continuous. One sometimes refers to such processes
using the French abbreviation “cadlag” processes. Stochastic processes with
regulated sample functions then might be called “ladlag” processes.
For any real-valued stochastic process X = {Xt}t≥0 on a probability space
(Ω, F, Pr) and ﬁnite set F = {t1 < · · · < tk} ⊂[0, ∞), the mapping RF :
ω 7→(Xt1(ω), . . . , Xtk(ω)) gives an image probability measure Pr ◦R−1
F
on the
ﬁnite-dimensional Euclidean space RF or Rk. These measures are called the
ﬁnite-dimensional joint distributions of X. Suppose that for each ﬁnite set
F ⊂[0, ∞) a probability measure PF is given on the Borel sets of RF , with
the natural consistency property that whenever F ⊂G, the image measure of
PG on RF under the natural projection is PF . Then there exists a stochastic
process X having PF as its ﬁnite-dimensional joint distributions by a theorem
of Kolmogorov, e.g. [99, Section 9.4] or [53, Theorem 12.1.2].
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
in Mathematics, DOI 10.1007/978-1-4419-6950-7_12, 
571

572
12 Stochastic Processes and Φ-Variation
Let X ∈R[0, ∞) and let ΩX := {ω ∈Ω: X·(ω) ∈R[0, ∞)}. Due to
completeness of the underlying probability space, ΩX ∈F and Pr(ΩX) = 1.
For each t ∈[0, ∞), let
X+(t) := X+(t, ω) :=
X(t+, ω) if ω ∈ΩX,
X(t, ω)
otherwise.
Similarly deﬁne X−(t) for each t ∈(0, ∞) and let X−(0) := X(0). For each
t ∈[0, ∞), X+(t) is a random variable because it is the limit for ω ∈ΩX of
the random variables X(rn) for rn rational, rn ↓t, and equals X(t) otherwise.
Likewise, X(t−) is a random variable. Therefore X+ = {X+(t), t ≥0} and
X−= {X−(t), t ≥0} are stochastic processes on the same probability space
as X.
Recall that ∆+X(t) := X+(t) −X(t) and ∆−X(t) := X(t) −X−(t). For
each t ∈[0, ∞), let
Ωd(t) :=

ω ∈Ω:
either ∆−X(t) ̸= 0 or ∆+X(t) ̸= 0
	
.
A point t ∈[0, ∞) is called a point of ﬁxed discontinuity of X if Pr(Ωd(t)) > 0.
If t is not a point of ﬁxed discontinuity of X then
lim
s→t X(s) = X(t)
almost surely.
(12.1)
Indeed, for each t ∈(0, ∞) and ω ∈ΩX \ Ωd(t), we have
lim
s↑t X(s, ω) = X(t−, ω) = X(t, ω) = X(t+, ω) = lim
s↓t X(s, ω).
Since Pr(ΩX \ Ωd(t)) = 1, (12.1) holds when t ∈(0, ∞). The same argument
yields (12.1) when t = 0. If the stochastic process X has no points of ﬁxed
discontinuity then the three processes X−, X+, and X are modiﬁcations of
each other.
A point t ∈[0, ∞) is a point of stochastic continuity of X if X(s) →X(t)
in probability as s →t, otherwise a point of stochastic discontinuity.
Theorem 12.1. Let X ∈R[0, ∞). Then the set of points of ﬁxed discontinu-
ity of X is at most countable and coincides with the set of points of stochastic
discontinuity of X.
Proof. Since the limit of a sequence convergent in probability is unique almost
surely, one can show that X is not stochastically continuous at some t ∈[0, ∞)
if t is a point of ﬁxed discontinuity. Also, X is stochastically continuous at t
whenever t is not a point of ﬁxed discontinuity. This yields the second part
of the claim. The ﬁrst part follows from Theorem 11.1, Ch. VII, of Doob [46].
2

12.1
Processes with Regulated Sample Functions
573
By the preceding theorem, the set of ﬁxed discontinuities of any stochastic
process with regulated sample functions is at most countable. However, almost
every sample function of such a process may have a non-ﬁxed discontinuity,
e.g. X(t, ω) = 1t≥ω, where ω has a uniform distribution in [0, 1].
Let (Ω, F, Pr) be a probability space. Then a ﬁltration F = {Ft: t ≥0} is
a family of sub-σ-algebras of F such that Fs ⊂Ft for 0 ≤s ≤t. A real-valued
stochastic process X = {Xt}t≥0 is adapted to F iﬀXt is Ft measurable for
each t. Given X, the ﬁltration F(X) = {Ft}t≥0 generated by X is deﬁned by
letting Ft be the smallest σ-algebra for which Xs are measurable for 0 ≤s ≤t.
Then clearly X is adapted to F(X) and if {Gt}t≥0 is any other ﬁltration to
which X is adapted then Ft ⊂Gt for all t ≥0.
Suppose that almost all sample functions of a stochastic process X have
bounded p-variation on [0, t] for some 0 < p < ∞and 0 < t < ∞. Since the
set of partitions PP [0, t] is uncountable, the function
ω 7→vp(X(·, ω); [0, t])
(12.2)
need not be measurable. For example, let Pr be Lebesgue measure on Ω:=
[0, 1]. For a non-Lebesgue measurable set A ⊂[0, 1], let X be a stochastic
process deﬁned by X(t, ω) = 1t=ω∈A, t ∈[0, 1]. Then vp(X; [0, 1]) = 0 if
ω /∈A, and = 2 if ω ∈A. We will show in Theorem 12.3 that in many cases
there is a stochastic process adapted to the ﬁltration F(X) generated by X
and whose sample functions almost surely agree with (12.2).
Recall that V is the class of all functions Φ: [0, ∞) →[0, ∞) which are
strictly increasing, continuous, unbounded, and 0 at 0.
Deﬁnition 12.2. Let X = {Xt}t≥0 be a stochastic process, and let Φ ∈V.
We say that X has locally bounded Φ-variation (or locally bounded p-variation
if Φ(u) ≡up) and write X ∈Wloc
Φ
if
(a) for almost all ω ∈Ω,
vΦ(X(·, ω); [0, T]) < +∞
∀T > 0;
(12.3)
(b) there exists an F(X)-adapted stochastic process vΦ(X) = {vΦ(X; t)}t≥0
such that for a Pr-null set Ω0, if ω /∈Ω0 then
vΦ(X(·, ω); [0, t]) = vΦ(X; t)(ω)
∀t > 0.
(12.4)
We call vΦ(X) the Φ-variation stochastic process (or p-variation stochastic
process if Φ(u) ≡up) of X.
A stochastic process X = {Xt}t≥0 is called separable if there exist a count-
able set S ⊂[0, ∞) and a Pr-null set Ω0 such that for every closed subset A
of R and open subset I of [0, ∞), we have

ω: X(t, ω) ∈A,
t ∈S ∩I
	
\

ω: X(t, ω) ∈A,
t ∈I
	
⊂Ω0.
(12.5)

574
12 Stochastic Processes and Φ-Variation
The set S in the deﬁnition of separability is called a separating set.
The following shows that (b) follows from (a) in Deﬁnition 12.2 under some
conditions.
Theorem 12.3. Let X = {Xt}t≥0 be either a separable stochastic process
continuous in probability, or a cadlag stochastic process. If for some Φ ∈V,
(12.3) holds for almost all ω ∈Ω, then X has locally bounded Φ-variation.
Proof. Let S = {tk}∞
k=0 be a countable dense subset of [0, ∞) with t0 = 0.
Suppose ﬁrst that X is a separable stochastic process continuous in proba-
bility. Then by Theorem 2.2 of Doob [46, Section II.2], S is a separating set.
The following consequence of separability is what we need. Let I be an open
subset of [0, ∞) and let Ω0 be the Pr-null set in (12.5). Then for ω /∈Ω0,
sup
t∈S∩I
X(t, ω) = sup
t∈I
X(t, ω)
and
inf
t∈S∩I X(t, ω) = inf
t∈I X(t, ω).
(12.6)
Second, if X is a cadlag stochastic process then (12.5) holds with Ω0 = ∅,
which also implies (12.6). To construct the Φ-variation stochastic process, for
each n ≥2, let Sn := {tn
0, . . . , tn
n} be the elements {t0, . . . , tn} arranged in
increasing order, and let [0, t] ⋓Sn := {tn
0, . . . , tn
k, t}, where k is the largest
j = 1, . . . , n such that tn
j < t. We can and do assume that (12.3) holds for
each ω /∈Ω0. For each t ≥0, let
vΦ(X; t)(ω) :=

supn vΦ(X(·, ω); [0, t] ⋓Sn) if ω /∈Ω0,
0
if ω ∈Ω0,
where the Φ-variation over a ﬁnite set E is deﬁned by restricting partitions to
be subsets of E. It is easily seen that for each t ≥0, vΦ(X; t)(·) is measurable
with respect to the σ-algebra generated by {X(s): s ≤t}. Thus vΦ(X) =
{vΦ(X; t)}t≥0 is adapted to the ﬁltration F(X) generated by X. To prove
(12.4) notice that
vΦ(X(·, ω); [0, t]) ≥vΦ(X; t)(ω)
(12.7)
for each ω ∈Ωand each t ≥0. To prove the converse inequality let ω /∈Ω0
and let t > 0. Given ǫ > 0 let κω ∈PP [0, t] be such that
sΦ(X(·, ω); κω) ≥vΦ(X(·, ω); [0, t]) −ǫ.
Taking non-intersecting open neighborhoods around each point of κω \ {0, t}
and using (12.6), one can ﬁnd an integer n = nω and a subset λω of [0, t] ⋓Sn
including {0, t} such that
sΦ(X(·, ω); λω) ≥sΦ(X(·, ω); κω) −ǫ.
Since ǫ > 0 is arbitrary, the inequality converse to (12.7) holds. Thus vΦ(X) =
{vΦ(X; t)}t≥0 is the Φ-variation stochastic process by Deﬁnition 12.2.
2
Notice that the ladlag (regulated) property of X is not suﬃcient for the
theorem by the example given before Deﬁnition 12.2.

12.2
Brownian Motion
575
12.2
Brownian Motion
A Brownian motion or Wiener process is a sample-continuous real-valued
Gaussian process B = {Bt}t≥0 with mean 0 and covariance EBtBu =
min{t, u} for t, u ≥0. Recall that a stochastic process {Xt}t≥0 is said to
have stationary increments if for any 0 ≤t0 < t1 < · · · < tn, the joint dis-
tribution of {Xtj+h −Xtj−1+h}1≤j≤n for h ≥0 does not depend on h. It is
easily seen that Brownian motion has stationary increments.
The local law of the iterated logarithm for 1-dimensional Brownian mo-
tion is well known and not hard to prove [53, Theorem 12.5.2], noting that
{B(t)}t>0 and {tB(1/t)}t>0 are equal in distribution: with probability 1,
lim sup
t↓0
|B(t)|
p
2t log log (1/t)
= 1.
(12.8)
The same holds if |B(t)| is replaced by |B(u + t) −B(u)| for any ﬁxed u ≥0,
by the stationary increments property.
Next is P. L´evy’s global H¨older condition for Brownian motion:
Proposition 12.4. With probability 1,
lim sup
s↓0
sup
0≤t≤1
|B(t + s) −B(t)|
p
2s log(1/s)
= 1.
(12.9)
For almost every ω there is a K(ω) < ∞such that for 0 ≤t ≤t + s ≤1,
|B(t + s) −B(t)|(ω) ≤K(ω)
p
s log(3/s).
(12.10)
Proof. Equation (12.9) is proved e.g. in Section 1.9 of Itˆo and McKean [109].
Then, for almost all ω there is a δ(ω) > 0 such that (12.10) holds with K(ω)
replaced by 2 if 0 < s ≤δ(ω). Let M(ω) := max0≤t≤1 |B(t, ω)| < +∞. Since
s 7→s log(3/s) is increasing for 0 < s ≤1, (12.10) then holds for
K(ω) := max(2, 2M(ω)/
p
δ(ω) log(3/δ(ω))),
completing the proof.
2
Brownian paths have bounded p-variation only for p > 2, as P. L´evy
proved.
Proposition 12.5 (P. L´evy). For a Brownian motion B and 0 < T < ∞, we
have almost surely
vp(B; [0, T])
< +∞if p > 2,
= +∞if p ≤2.
(12.11)

576
12 Stochastic Processes and Φ-Variation
Proof. The fact that vp(B; [0, T]) < ∞a.s. (almost surely) for p > 2 follows
from L´evy’s H¨older condition, Proposition 12.4, for T = 1. For general T > 0,
B(Tu) =
√
TB(u) in distribution as processes for 0 ≤u ≤1.
It will be shown that (v2(B(·, ω); [0, 1])) = +∞almost surely. Let J
:=
(1/4, 3/4) and 0 < M < ∞. By sample continuity and the local law of the
iterated logarithm (12.8), for any t ∈(1/4, 3/4), almost surely there exist
rational q, r with 1/4 ≤q < t < r ≤3/4, r −q < 1/4, and
(B(r) −B(q))2 > M(r −q).
(12.12)
Let A be the set of (t, ω) ∈J × Ωfor which such r and q exist. Then A is
evidently jointly measurable. For each t ∈J, Pr({ω : (t, ω) ∈A}) = 1, so by
the Fubini theorem, with λ equal to Lebesgue measure, (λ × Pr)(A) = 1/2.
Let Ω1 := {ω : (t, ω) ∈A for λ-almost all t ∈J}. Then Pr(Ω1) = 1. For
each ω ∈Ω1, {t : (t, ω) ∈A} is a countable union of open intervals (qn, rn)
satisfying (12.12). By a Vitali lemma, e.g. [53, Lemma 7.2.2], there is a ﬁnite,
disjoint set (qnj, rnj) of those intervals such that P
j rnj −qnj > 1/(3 · 2) and
thus by (12.12),
v2(B(·, ω); [0, 1]) ≥
X
j
(B(rnj) −B(qnj))2 > M/6.
So v2(B; [0, 1]) > M/6 almost surely and since M < +∞was arbitrary,
v2(B; [0, 1]) = +∞almost surely. It follows by Lemma 3.45 that vp(B; [0, 1]) =
+∞a.s. for p ≤2, and the proof is complete.
2
Rather than the global modulus of continuity (H¨older condition) as in
Proposition 12.4, S. J. Taylor showed that the local modulus of continuity
(log log law), as in (12.8) and the proof just given, determines the precise
Φ-variation behavior of Brownian motion. His theorem will follow as a special
case of facts about fractional Brownian motion, in Corollary 12.24.
12.3
Martingales
A complete probability space (Ω, F, Pr) and a ﬁltration F = {Ft : t ≥0}
will be said to satisfy the usual hypotheses if F is (i) complete, meaning that
all sets of probability zero are in F0, and (ii) right-continuous, meaning that
Ft = ∩s>tFs for each 0 ≤t < ∞. We assume throughout this section that
the usual hypotheses hold.
Let X = {Xt}t≥0 be a real-valued stochastic process deﬁned on Ω. The
pair (X, F) is a martingale iﬀX is adapted to F, the expectation E|X(t)| is
ﬁnite for all t ≥0, and the conditional expectation E(X(t)
Fs) equals X(s)
almost surely for 0 ≤s ≤t. (Conditional expectations are deﬁned e.g. in [53,
Section 10.1] and [112, Theorem 6.1].)

12.3
Martingales
577
It is known that under the usual hypotheses, a martingale (X, F) has a
modiﬁcation M = {Mt}t≥0 which is a cadlag stochastic process and such that
(M, F) is still a martingale ([112, Theorem 7.27]).
For a ﬁltration F = {Ft: t ≥0}, a random variable τ on Ωwith values in
[0, +∞] is called a stopping time iﬀ{τ ≤t} ∈Ft for every t ∈[0, ∞). Suppose
that on (Ω, F, Pr), F is a ﬁltration and M is a cadlag stochastic process.
The pair (M, F) is a local martingale iﬀM is adapted to F and there is a
nondecreasing sequence of stopping times {τn}n≥1 such that limn τn = +∞
almost surely and Mn := {Mt∧τn}t≥0 is a uniformly integrable martingale for
each n. (Uniform integrability is deﬁned e.g. in [53, p. 355] and [112, p. 67].)
For a cadlag stochastic process X = {Xt}t≥0 adapted to F, the pair (X, F)
is a semimartingale iﬀalmost surely X(t) = M(t)+A(t) for each t ≥0, where
(M, F) = {Mt, Ft}t≥0 is a local martingale and A = {A(t)}t≥0 is a stochastic
process having locally bounded variation (as in Deﬁnition 12.2 for p = 1).
If B = {B(t)}t≥0 is a stochastic process and F = {Ft : t ≥0} is a ﬁltra-
tion, we will say that (B, F) is a Brownian motion if B is a Brownian motion,
it is adapted to F, and for 0 ≤t ≤u, the increments B(u) −B(t) are in-
dependent of Ft. We say that a stochastic process X is equivalent to a time
change of Brownian motion if there exist a Brownian motion (B, F) and a
stochastic process {τt}t≥0 such that each τt is an F stopping time, 0 ≤τs ≤τt
whenever 0 ≤s ≤t, and the stochastic process {B(τt)}t≥0 has the same
ﬁnite-dimensional joint distributions as X. Here X and B may be deﬁned on
diﬀerent probability spaces.
Theorem 12.6 (Monroe [174]). A real-valued stochastic process is equivalent
to a time change of Brownian motion if and only if it is a semimartingale.
This fact can be used to bound the p-variation of a semimartingale as
follows. Given p > 2, it follows from Proposition 12.5 that vp(B; [0, T]) < ∞
almost surely for any T < ∞and thus for any ﬁnite-valued random variable τ,
vp(B; [0, τ]) < ∞almost surely. Let X be a semimartingale, and let t > 0. By
Theorem 12.6, for a suitable ﬁnite-valued stopping time τt, vp(X; [0, t]) has
the same distribution as vp(B◦τ; [0, t]). We have vp(B◦τ; [0, t]) ≤vp(B; [0, τt])
almost surely, since s 7→τs is nondecreasing and restricting partitions to
consist of points of its range gives a supremum over a smaller set of p-variation
sums. So vp(X; [0, t]) < ∞almost surely. Thus we have proved the following:
Corollary 12.7. A semimartingale is of bounded p-variation on any bounded
interval for each p > 2.
If M is a martingale such that EM(t) = 0, 0 ≤t ≤T , EM(T )2 < ∞, and
B(u), u ≥0, is a Brownian motion with stopping times τt, 0 ≤t ≤T , as in the
deﬁnition before Theorem 12.6, such that B(τt) and M(t) for 0 ≤t ≤T each
have the same ﬁnite-dimensional joint distributions, then EτT = EM(T )2
(Monroe, [173, Theorems 5 and 11]). Thus for any sequence of martingales
Mi = {Mi(t), 0 ≤t ≤T }, if supi EMi(T )2 < +∞then for each p > 2,

578
12 Stochastic Processes and Φ-Variation
vp(Mi; [0, T]) is bounded in probability uniformly in i. It is well known that
if (B, F) is a Brownian motion and τ is a stopping time for F with Eτ < ∞
then EB(τ)2 = Eτ, e.g. [53, Theorem 12.4.1].
It was also well known that sample functions of martingales which are
continuous and nonconstant must have unbounded 1-variation (Lemma 3.2.1
of Fisk [67]). In fact, we will see that they must have unbounded p-variation
for every p < 2:
Theorem 12.8. If for some p < 2 a sample continuous local martingale has
locally bounded p-variation then almost surely its sample functions are con-
stants.
A proof of this statement will be given, based on a stopping time tech-
nique, as follows. We will say that a stochastic process X is sample uniformly
continuous if for each 0 < T < ∞there exists a null set Ω0 such that for
any ǫ > 0 one can choose δ > 0 such that |X(t, ω) −X(s, ω)| < ǫ whenever
|t −s| < δ, t, s ∈[0, T ], and ω ̸∈Ω0.
For a stopping time τ, let Xτ := {X(t ∧τ), t ≥0}.
Lemma 12.9. Let X be a sample continuous stochastic process adapted to
a ﬁltration F. For each 0 < T < ∞there exists a nondecreasing sequence
{τn}n≥1 of F stopping times τn ≤T such that Pr(∪∞
n=1{τn = T }) = 1, and
each Xτn is sample uniformly continuous and bounded by n.
Proof. Let 0 < T < ∞. Since almost every sample function of X is uniformly
continuous on [0, T ], there exists a double sequence {δkn}k,n≥1 of positive
numbers such that for each k, δk1 > δk2 > · · · , and for each k, n,
Pr
 {sup{|X(t) −X(s)|: |t −s| ≤δkn, s, t ∈[0, T]} ≥1/k}

≤2−n−k.
(12.13)
Let τ′
kn be the least r ∈[0, T ] such that
sup

|X(t) −X(s)|: |t −s| ≤δkn, s, t ∈[0, r]
	
≥1/k.
If there is no such r, let τ ′
kn := T . Since X is sample continuous each τ′
kn is an
F stopping time. Let τ ′
n := infk τ ′
kn. Then for each n and any t ∈[0, ∞), {τ′
n <
t} = ∪k{τ′
kn < t} ∈Ft. Since F is right-continuous, each τ′
n is an F stopping
time. Then each stopped process Xτ ′
n is sample uniformly continuous.
For n ≥1, since δkn > δk,n+1 for each k, it follows that τ′
kn ≤τ ′
k,n+1 for
each k, and so τ ′
n ≤τ ′
n+1. Also, by (12.13), Pr({Xτ ′
n ̸= X on [0, T]}) ≤2−n.
It then follows from the Borel–Cantelli lemma that Pr(∪n{τ′
n = T }) = 1.
Let τ′′
n be the least t ∈[0, T] such that |X(t)| ≥n. If no such t exists,
let τ ′′
n := T . Then each τ′′
n is an F stopping time and Xτ ′′
n is bounded by n.
Clearly the sequence of F stopping times τn := τ ′
n ∧τ ′′
n, n ≥1, satisﬁes the
conclusion of the lemma.
2

12.4
Gaussian Stochastic Processes
579
Now we are ready to prove Theorem 12.8.
Proof of Theorem 12.8. Let a sample continuous local martingale (X, F) =
{Xt, Ft}t≥0 have locally bounded p-variation for some p < 2, and let 0 < T <
∞. It is enough to prove that almost surely, X(t) = X(0) for each 0 ≤t ≤T .
Since X is sample continuous, the p-variation stochastic process vp(X) is also
sample continuous by Propositions 3.35(a) and 3.42. By Lemma 12.9 applied
to X and vp(X), taking the minimum of stopping times for each process, and
because X is a local martingale, there exists a nondecreasing sequence {τn}n≥1
of F stopping times such that Pr(S
n{τn = T }) = 1, each Xτn is a sample
uniformly continuous martingale by optional sampling or “localization” [112,
Lemma 17.1], bounded by n, and each vp(X)τn is bounded by n. Notice that
for each n, vp(X)τn is the p–variation process of Xτn. Let λ = {λm}m≥1
be a nested sequence of partitions λm = {tm
i }i=0,...,k(m) of [0, T] such that
maxi(tm
i −tm
i−1) →0 as m →∞. Then ∪mλm is dense in [0, T]. For each
n, m ≥1, let
ǫn,m :=
 max
i
|Xτn(tm
i ) −Xτn(tm
i−1)|

∞.
Let t ∈∪mλm. Then there exists an integer mt such that t ∈λm for each
m ≥mt. For any 0 ≤s1 < t1 ≤s2 < t2 ≤T , let ∆iX := Xτn(ti) −Xτn(si)
for i = 1, 2. Since Xτn is uniformly bounded it follows that
E

∆1X∆2X

= E

∆1X E

∆2X
Fs2

= 0
(Xτn has orthogonal increments), using the martingale property and proper-
ties of conditional expectations, e.g. [53, Theorem 10.1.9] or [112, Theorem
6.1]. Thus for each m ≥mt, we have
E

Xτn(t) −Xτn(0)
2 = E
 k(m)
X
i=1
[Xτn(tm
i ) −Xτn(tm
i−1)]2
≤E
 ǫ2−p
n,mvp(X)τn(t)

≤nE
 ǫ2−p
n,m

.
Since for each n ≥1, ǫn,m ≤2n and ǫn,m →0 almost surely as m →∞, by
the bounded convergence theorem, the left side of the preceding inequality is
zero for each n ≥1. Therefore, almost surely, for each n ≥1, Xτn(t) = Xτn(0)
for each t ∈∪mλm. Since X is sample continuous and for almost every ω ∈Ω,
there is an n ≥1 such that Xτn(t, ω) = X(t, ω) for 0 ≤t ≤T , it follows that
almost surely, X(t) = X(0) for each 0 ≤t ≤T . The proof of Theorem 12.8 is
complete.
2
12.4
Gaussian Stochastic Processes
A Gaussian stochastic process is a process all of whose ﬁnite-dimensional joint
distributions are normal measures. To recall the deﬁnition of normal prob-
ability measure on ﬁnite-dimensional Euclidean spaces, ﬁrst on R, for any

580
12 Stochastic Processes and Φ-Variation
µ ∈R and σ > 0, the normal or Gaussian probability measure N(µ, σ2) is
deﬁned as having the density (σ
√
2π)−1 exp(−(x−µ)2/(2σ2)) with respect to
Lebesgue measure. If σ = 0 then N(µ, σ2) is deﬁned as a point mass δµ at µ.
A Borel probability measure P on Rk is called normal or Gaussian iﬀwhen
X = (X1, . . . , Xk) has distribution P, for any t ∈Rk, the inner product (t, X)
has a 1-dimensional normal distribution N(µ(t), σ2(t)) where σ2(t) ≥0. Then
X has a well-deﬁned mean vector µ = EX and a covariance matrix C with
Crs = E[(Xr −µr)(Xs −µs)] for r, s = 1, . . . , k. Here C is nonnegative deﬁnite
and symmetric. Conversely, for any such matrix C and any µ ∈Rk there is a
unique normal measure, called N(µ, C), with mean vector µ and covariance
matrix C, e.g. by [53, Theorems 9.5.7 and 9.5.13], where Theorem 9.5.7 for
µ = 0 extends by translation to other µ.
Let X = {Xt}t≥0 be a separable Gaussian stochastic process with mean 0,
and let fX(t) := X(t, ·) ∈L2(Ω, Pr) for t ≥0. Recall that CV is the subclass
of convex functions in the class V of all functions Ψ : [0, ∞) →[0, ∞) which
are strictly increasing, continuous, unbounded, and 0 at 0. For Ψ ∈CV and
0 < T < ∞, recall the Ψ-variation vΨ(f) = vΨ(f; J) as deﬁned in (3.1), which
will be applied for f = fX and J = [0, T].
By Lemma 3.79(a), for 1 < p < ∞there is a δ with 0 < δ ≤e−e such that
Ψp,2(u) := [u(log log(1/u))1/2]p
(12.14)
is convex for 0 < u ≤δ. By (3.125) we can set Ψp,2(0) := 0 and extend Ψp,2
to be linear on [δ, +∞) in such a way that Ψp,2 is convex on [0, ∞) and so in
CV. In Theorem 12.13 we will show that for 1 < p < ∞, X has almost all
sample functions of bounded p-variation on [0, T], assuming boundedness of
vΨp,2(fX; [0, T ]).
Proposition 12.10. Let X be a separable Gaussian stochastic process with
mean 0, and let 1 ≤p < ∞. If X has locally bounded p-variation then
vp(fX; [0, T ]) < ∞for each 0 < T < ∞. The converse implication holds
for p = 1.
Proof. First let p = 1. It will be shown that X has almost all sample functions
of bounded 1-variation on [0, T] if and only if
v1(fX; [0, T]) < ∞.
(12.15)
Indeed, suppose (12.15) holds. By separability of X, there exists a nested
sequence {κn}n≥1 of partitions of [0, T] formed by points of a separating set S
such that v1(X; [0, T ]) = supn≥1 s1(X; κn) almost surely and S
n κn = S. Note
that for any function f and partitions κn ⊂κn+1, s1(f; κn) ≤s1(f; κn+1). By
the monotone convergence theorem,
E sup
n≥1
s1(X; κn) = sup
n≥1
Es1(X; κn) = K1v1(fX; [0, T]) < ∞,
(12.16)

12.4
Gaussian Stochastic Processes
581
where K1 := E|Z| for a standard normal random variable Z, i.e. one having
distribution N(0, 1), and so v1(X; [0, T]) < ∞almost surely. Conversely, let
V := RS be the set of all real-valued functions on a separating set S ⊂
[0, T ] with product topology. Then V is a measurable vector space and the
distribution of X restricted to S is a centered Gaussian measure P on V , both
as deﬁned on p. 25 of [52]. Now ∥· ∥:= ∥· ∥(1),[0,T ] is a measurable function
from V to [0, ∞] and by assumption, we have P(∥· ∥< ∞) = 1. Therefore
∫∥x∥dP(x) < ∞, in fact ∫exp{α∥x∥2} dP(x) < ∞for some α > 0, by a
theorem of Fernique [52, Lemma 2.2.5]. Thus (12.15) holds by (12.16).
Now let 1 < p < ∞and suppose X has almost all sample functions of
bounded p-variation. Then by the same theorem of Fernique applied to the
seminorm ∥· ∥= ∥· ∥(p),[0,T ], we have
∞> E∥X∥p ≥sup

Esp(X; κ): κ ∈PP[0, T]
	
= Kpvp(fX; [0, T]),
where Kp := E|Z|p for a standard normal random variable Z. Thus the propo-
sition holds for 1 < p < ∞.
2
The converse in Proposition 12.10 does not hold for p > 1, however, as
(12.11) with p = 2 shows for a Brownian motion.
By Lemma 3.79(a), for 1 < p < ∞there is a δ with 0 < δ ≤e−e such
that Ψp,1(u) := [u(log(1/u))1/2]p is convex for 0 < u ≤δ. By (3.125) we
can set Ψp,1(0) := 0 and extend Ψp,1 to be linear on [δ, +∞) in such a way
that Ψp,1 is convex on [0, ∞) and so in CV. Letting Ψp(u) ≡up, it is clear
that Ψp ≤Ψp,2 ≤Ψp,1 on [0, δ] for some δ > 0. The following shows that
vΨp,1(fX) < ∞is a suﬃcient condition for a Gaussian process X to have
locally bounded p-variation.
Lemma 12.11. Let X = {Xt}t≥0 be a separable Gaussian stochastic process
with mean zero such that vp(fX; [0, T]) < ∞for some 1 < p < ∞and 0 <
T < ∞. Then for almost all ω ∈Ωthere is a C(ω) < +∞such that for
s, t ∈[0, T],
|X(t, ω) −X(s, ω)| ≤C(ω)

Ψp,1(d(fX(t), fX(s)))
1/p,
(12.17)
where d is the usual metric on the Hilbert space H = L2(Ω, Pr).
Proof. Let 0 < T < ∞and 1 < p < ∞be such that vp(fX; [0, T]) < ∞. Let
R := {fX(t)}0≤t≤T ⊂L2(Ω, Pr). For each ǫ > 0, let N(R, ǫ) be the minimal
number of balls of radius at most ǫ with respect to d that cover R. Then for
each 0 < t ≤T let
F(t) := sup
n
n
X
i=1
E|X(ti)−X(ti−1)|p : {ti}n
i=0 ∈PP [0, t]
o
= Kpvp(fX; [0, t]).

582
12 Stochastic Processes and Φ-Variation
Thus for each 0 ≤s < t ≤T ,
K1/p
p
d(fX(s), fX(t)) =
 E|X(t) −X(s)|p1/p ≤

F(t) −F(s)
1/p,
and so there is a ﬁnite constant A such that N(R, ǫ) ≤Aǫ−p. By Corollary
2.3 of [47], for almost all ω there exists a ﬁnite C(ω) such that (12.17) holds.
2
For 1 ≤p < ∞, let ψp,2(v) := v1/p/
p
log log(1/v) if 0 < v ≤e−e,
ψp,2(v) := v1/p if v > e−e and ψp,2(0) := 0. For p > 1, by Lemma 3.79,
there is a δ′ = δ′(p) > 0 such that ψp,2 is concave on [0, δ′].
Lemma 12.12. Let 1 < p < ∞, and for some 0 < T < ∞let X =
{Xt}0≤t≤T be a separable Gaussian stochastic process with mean zero. Sup-
pose that there are a nondecreasing function F on [0, T] with F(0) = 0, a
ﬁnite constant γ, and a δ with 0 < δ < e−e such that ψp,2 is concave on [0, δ]
and
σX(s, t) := [E((fX(s) −fX(t))2)]1/2 ≤γψp,2(F(t) −F(s))
(12.18)
whenever s, t ∈[0, T ] and F(t) −F(s) ≤δ. Then there is a ﬁnite constant
K such that for any k > 0, and any a, b ∈R with 0 < b −a < δ and
(a, b) ∩[0, F(T )] ̸= ∅,
Pr
 
sup
s,t∈I(a,b)
|X(t) −X(s)| > 2(K + γ
√
2k)(b −a)1/p	
≤
h
log
1
b −a
i−k
,
where I(a, b) := {t ∈[0, T ]: a < F(t) < b}.
Proof. Let k > 0 and let a, b ∈R be such that 0 < b −a < δ and (a, b) ∩
[0, F(T )] ̸= ∅. Let R := (a, b) ∩{F(t): 0 ≤t ≤T }. If R = ∅the conclusion
holds vacuously, so suppose R ̸= ∅. Let V := (a, b)\R. We will show that there
exists a separable, Gaussian stochastic process with mean zero Y = {Yu}a<u<b
such that X(t, ω) = Y (F(t), ω) for all t ∈I(a, b) for almost all ω ∈Ωand for
each u, v ∈(a, b),
σY (u, v) ≤γψp,2(|u −v|) ≤γ|u −v|1/p.
(12.19)
First we will show that V = ∪∞
i=1Vi, where all Vi are disjoint open or
half-open intervals. Indeed, if F(t) = c ∈(a, b) for some t ∈[0, T], J = (a, c)
or J = (c, b), and J ⊂V , then J is clearly a maximal interval included in
V . If F(t) < F(t+) for some t ∈[0, T) and F(t+) ∈(a, b), then either the
open interval (a ∨F(t), F(t+)) or the half-open interval (a ∨F(t), F(t+)]
is a maximal interval included in V , depending on whether F(t+) ∈R or
F(t+) ∈V . Similarly, if F(t−) < F(t) for some t ∈(0, T] and F(t−) ∈(a, b),
then either (F(t−), F(t)∧b) or [F(t−), F(t)∧b) is a maximal interval included

12.4
Gaussian Stochastic Processes
583
in V . To deﬁne Y , let Y (u) := X(t) if u ∈R and u = F(t) for some t.
Then the set {t: F(t) = u}, if not empty, is a singleton or a nondegenerate
interval, Iu, in which case X is almost surely constant on Iu by (12.18) and
separability. Since there are at most countably many such intervals the almost
sure constancy holds for all of them.
For each t such that F(t) < F(t+) ∈(a, b) there is an ǫ > 0 such that
F(s) < F(t+) + δ for t < s < t + ǫ, and so X(t+), deﬁned as the limit in
L2(Ω, Pr) of X(s) as s ↓t, exists by (12.18). Similarly, if F(t) > F(t−) ∈
(a, b), we can deﬁne X(t−). Now, if u ∈(a, b) is a right endpoint of Vi for
some i, then either u = F(t+) for some t and we let Y (u) := X(t+), or
u = F(t) and Y (u) is already deﬁned. Similarly, if u ∈(a, b) and u = F(t−)
is a left endpoint of Vi, then let Y (u) := X(t−). On the interior of Vi the
paths of Y are deﬁned either by linearity if both endpoints of Vi are in (a, b)
or equal to the value of Y at the one endpoint in (a, b).
The stochastic process Y = {Yu}a<u<b is Gaussian with mean zero, and
X(·, ω) = Y (F(·), ω) on I(a, b) for almost all ω ∈Ω. Moreover, Y is separable
with separating set (F(S) ∩(a, b)) ∪S1, where S is a separating set for X and
S1 is any countable dense subset of V .
To show (12.19) for u, v ∈(a, b) note that it holds by (12.18) if u, v ∈R.
If u, v ∈Vi and a or b is an endpoint of Vi there is no problem. Otherwise if
u, v ∈Vi = (u1, u2] for some u1, u2 ∈(a, b) and λ := (v −u)/(u2 −u1) > 0,
then since ψp,2 is concave on [0, δ],
σY (u, v) = λσY (u1, u2) ≤γλψp,2(u2 −u1) ≤γψp,2(v −u).
Now let v ∈Vi = (u1, u2] with Y (u2) = X(t+), Y (u1) = X(t), and u =
F(s) ∈(a, u1) for some s, t ∈I(a, b). Letting λ := (v −u1)/(u2 −u1), we have
Y (v) −Y (u) = (1 −λ)[X(t) −X(s)] + λ[X(t+) −X(s)].
Thus by concavity of ψp,2 again it follows that
σY (u, v) ≤(1 −λ)σX(s, t) + λ lim sup
r↓t
σX(s, r)
≤γ
h
(1 −λ)ψp,2(u1 −u) + λψp,2(u2 −u)
i
≤γψp,2(v −u).
Similarly, one can also check that (12.19) holds for any u, v ∈(a, b). This
ﬁnishes the proof of existence of Y with the stated properties.
Let c := (a + b)/2. Let Z(u) := Y (u) −Y (c) for u ∈(a, b) and let
∥Z∥sup := supu∈(a,b) |Z(u)|. Endowed with the pseudometric σY , (a, b) is
a totally bounded pseudometric space. Denote by N(r) = N((a, b), σY , r)
the smallest number of open balls of radius r > 0 in the pseudometric σY
which form a covering of (a, b). By (12.19), N(r) ≤1 + (b −a)γp/rp for
0 < r ≤¯σY (a, b) := sup{σY (u, v): u, v ∈(a, b)}. Clearly N(r) = 1 if
r > ¯σY (a, b). Then by the change of variables s = (r/γ)p(b −a)−1, where
N(r) = 1 for s > 1, we get

584
12 Stochastic Processes and Φ-Variation
Z ∞
0
p
log N(r) dr ≤p−1γ(b −a)1/p
Z 1
0
s(1/p)−1p
log (1 + (1/s)) ds < ∞.
It follows that the sample functions of the process {Z(u) : a < u < b} can
be taken to be in the separable Banach space E of all real-valued uniformly
continuous functions on (a, b) for σY , e.g. [135, Theorems 6.1 and 6.2] or [52,
Theorem 2.6.1], with supremum norm. Because Z(c) = 0, we have
∥Z∥sup =
sup
u∈(a,b)
|Z(u)| ≤
sup
u∈(a,b)
Z(u) + sup
u∈(a,b)
−Z(u).
By the metric entropy bound for Gaussian processes in expectation (cf. e.g.
[135, Theorem 6.1]), we have
E∥Z∥sup ≤84
Z ∞
0
p
log N(r) dr ≤K(b −a)1/p
for some ﬁnite constant K depending only on p and γ. By (12.19), we have
sup
u∈(a,b)
(EZ(u)2)1/2 ≤γψp,2(b −a).
Then by the Gaussian concentration inequality of Ledoux [135, (4.4)], it fol-
lows that
Pr
 
sup
s,t∈I(a,b)
|X(t) −X(s)| > 2(K + γ
√
2k)(b −a)1/p	
≤Pr
 {∥Z∥sup > (K + γ
√
2k)(b −a)1/p}

≤Pr
 {∥Z∥sup > E∥Z∥sup + γ
√
2k(b −a)1/p}

≤exp
n
−2kγ2(b −a)2/p
2γ2ψ2
p,2(b −a)
o
=
h
log
1
b −a
i−k
,
proving the lemma.
2
Now we are ready to prove the main result of this section, which gives a
suﬃcient condition for boundedness of the p-variation of almost all sample
functions of a Gaussian stochastic process. Proposition 12.14 will show that
in some cases the condition is necessary.
Theorem 12.13. Let X be a separable Gaussian stochastic process with mean
zero, and let 1 < p < ∞. If vΨp,2(fX; [0, T]) < ∞for each 0 < T < ∞, then
X has locally bounded p-variation.
Proof. Let 0 < T < ∞and for each 0 ≤t ≤T , let F(t) := vΨp,2(fX; [0, t]).
Recalling ψp,2 as deﬁned before Lemma 12.12, note that we have

12.4
Gaussian Stochastic Processes
585
Ψ −1
p,2(v) ∼ψp,2(v)
(12.20)
as v ↓0. This and Lemma 3.79 yield that there is a δ > 0 such that ψp,2 is
concave on [0, δ] and for 0 ≤s < t ≤T ,
σX(s, t) ≤eψp,2
 F(t) −F(s)

≤e

F(t) −F(s)
1/p
(12.21)
if F(t) −F(s) ≤δ. Also we assume that δ is so small that δ ≤(δ1/e)p where
δ1 is such that Ψp,1(u) = [u(log(1/u))1/2]p for 0 < u ≤δ1 as deﬁned before
Lemma 12.11.
Let m0 ≥4 be the smallest integer such that 2e−m0 < δ, and let K be the
constant obtained from Lemma 12.12 with γ = e. For each m ≥m0 and each
j = 0, 1, . . . , jm := ⌊emF(T )⌋, let Sm,j := I((j −1)e−m, (j + 1)e−m), where
I(a, b) = {t ∈[0, T ]: a < F(t) < b}, and let
Vm,j :=

ω ∈Ω:
sup
t,s∈Sm,j
|X(t, ω) −X(s, ω)| > Me−m/p	
,
where M := 21+1/p(K + e
√
2k) and k is such that k > 2 + p/2. The intervals
Sm,j, j = 0, . . . , jm, overlap and cover [0, T]. We shall bound the number
Zm(ω) := card

j = 0, . . . , jm : ω ∈Vm,j}. By Lemma 12.12 with a = (j −
1)e−m and b = (j + 1)e−m, we have Pr
 Vm,j

≤2km−k for all j = 0, . . . , jm
and all m ≥m0. Thus for all such m, it follows that
EZm ≤
jm
X
j=0
Pr
 {
sup
t,s∈Sm,j
|X(t) −X(s)| > Me−m/p}

≤(1 + F(T ))em2km−k.
We choose ν such that 2 + p/2 < ν + 1 < k. Then we have
X
m
Pr
 {Zm > emm−ν}

≤
X
m
EZme−mmν ≤(1 + F(T ))2k X
m
m−(k−ν) < ∞.
By the Borel–Cantelli lemma, for almost all ω ∈Ω, there exists an integer
m1(ω) ≥m0 such that Zm(ω) ≤emm−ν for all m ≥m1(ω).
Since F is regulated on [0, T], by Theorem 2.1, there exists a Young in-
terval partition {(zj−1, zj)}m
j=1 of [0, T] such that the oscillation of F on each
(zj−1, zj) is < e−m0. By Proposition 3.36, it suﬃces to prove the bounded
p-variation of paths of X on each interval (zj−1, zj), or, on any open interval
(u, v) ⊂[0, T] on which the oscillation of F, namely F(v−) −F(u+), is less
than e−m0. Then, X′(u) := X(u+) and X′(v) := X(v−) exist as limits in
quadratic mean. Deﬁning X′(t) := X(t) for u < t < v we get a process X′ on
the closed interval [u, v]. It suﬃces to prove the almost sure ﬁnite p-variation
of paths of X′ on [u, v]. Thus, without loss of generality, it suﬃces to prove
this for X on [u, v] assuming that F(v) −F(u) < e−m0.
Let κ = {ti}n
i=0 be a partition of [u, v], and for ω ∈Ω, let
E(ω) :=

i: |X(ti, ω) −X(ti−1, ω)|p > eM p[F(ti) −F(ti−1)]
	
.

586
12 Stochastic Processes and Φ-Variation
For m ≥m0, let
Λm := {i: e−m−1 ≤F(ti) −F(ti−1) < e−m	
.
Then
X
i̸∈E(ω)
X(ti, ω) −X(ti−1, ω)
p < e1−m0M p.
(12.22)
Since vp(fX) ≤vΨp,2(fX) < ∞, by Lemma 12.11, for almost all ω ∈Ω, there
exists a C = C(ω) < ∞such that (12.17) holds. Moreover, card{E(ω)∩Λm} ≤
5Zm(ω). Since for each i, F(ti)−F(ti−1) < e−m0, there is an m ≥m0 such that
i ∈Λm. For δ1 mentioned near the beginning of the proof, since δ ≤(δ1/e)p,
by (12.21) we have ui := σX(ti−1, ti) ≤δ1, and in (12.17) we have Ψp,1(ui)
for 0 < ui ≤δ1 and the formula for Ψp,1(u) for small u > 0 applies. Moreover,
for any m ≥m0 and i ∈Λm we have σX(ti−1, ti) ≤δ1e−(m−m0)/p. Recalling
that d(fX(t), fX(s)) = σX(s, t), we have
X
i∈E(ω)
X(ti, ω) −X(ti−1, ω)
p
=
∞
X
m=m0
X
i∈E(ω)∩Λm
X(ti, ω) −X(ti−1, ω)
p
≤C(ω)p
∞
X
m=m0
X
i∈E(ω)∩Λm
h
σX(ti−1, ti)
p
log(1/σX(ti−1, ti))
ip
≤5δp
1C(ω)p
∞
X
m=m0
Zm(ω)e−m+m0h
log(1/δ1) + (m −m0)/p
ip/2
.
The last series converges because Zm(ω) ≤emm−ν for all m ≥m1(ω) ≥m0,
and because P
m≥m1(ω) mp/2−ν < ∞by the choice of ν. This together with
(12.22) gives a bound on sp(X(·, ω); κ) for almost all ω ∈Ω, proving the
theorem.
2
The next fact shows that boundedness of vΨp,2(fX; [0, 1]) in the preceding
theorem is necessary in some cases.
Proposition 12.14. Let 1 < p < ∞, let M > 1 be an even integer such
that M 1−(1/p) > 4, let {ξk}k≥1 be independent identically distributed N(0, 1)
random variables on (Ω, F, Pr), let h = {hk}k≥1 be a nondecreasing sequence
of positive numbers such that (3.66) holds, and for 0 ≤t ≤1 and ω ∈Ωlet
X(t, ω) :=
∞
X
k=1
ξk(ω)
p
log(k + 1)
hkM −k/p sin(2πM kt).
(12.23)
Then X = {Xt}0≤t≤1 is a Gaussian stochastic process with mean zero having
almost all sample functions continuous, and the following three statements are
equivalent:

12.4
Gaussian Stochastic Processes
587
(a) vp(X(·, ω); [0, 1]) < ∞for almost all ω ∈Ω;
(b) ∥h∥sup = supk≥1 hk < ∞;
(c) vΨp,2(fX; [0, 1]) < ∞.
Proof. By the Borel–Cantelli lemma, Pr(∪n≥1 ∩k≥n {|ξk| ≤2
p
log(k + 1)}) =
1, and so supk≥1 |ξk(ω)|/
p
log(k + 1) < ∞for almost all ω ∈Ω. Thus by
(3.66), for almost all ω ∈Ω, the series (12.23) converges uniformly for t ∈
[0, 1], and so X is a well-deﬁned Gaussian stochastic process with mean zero
having almost all sample functions continuous.
(a) ⇒(b). Suppose that ∥h∥sup = ∞. By (a) and Proposition 3.46, for
almost all ω ∈Ω, supk≥1 hk|ξk(ω)|/
p
log(k + 1) < ∞. Since {hk}k≥1 is non-
decreasing, |ξk|/
p
log(k + 1) →0 as k →∞with probability 1. On the other
hand, by the Borel–Cantelli lemma, Pr(∩n≥1 ∪k≥n {|ξk| >
p
log(k + 1)}) = 1,
a contradiction, proving (b).
(b) ⇒(c). It will be shown that there exist a δ > 0 and a ﬁnite constant
C such that
σX(s, t) ≤Cψp,2(|t −s|)
if s, t ∈[0, 1] and |s −t| < δ,
(12.24)
where σX is deﬁned in (12.18) and ψp,2 is deﬁned before Lemma 12.12. To show
that (12.24) suﬃces, by deﬁnition (12.14) of Ψp,2, if K > 1 and 0 < u ≤δ′/K
for some 0 < δ′ ≤e−e, we have
Ψp,2(Ku) = Kp (log log[1/(Ku)])p/2
(log log(1/u))p/2
Ψp,2(u) ≤KpΨp,2(u)
since log log is a positive and nondecreasing function on [ee, ∞). We can as-
sume that δ in (12.24) is such that ψu,2(u) ≤2Ψ −1
p,2(u) and Ψ −1
p,2(u) ≤δ′/K
for 0 < u < δ and K = max{1, 2C} by (12.20) and continuity of Ψ −1
p,2 at 0.
Therefore if s, t ∈[0, 1] and |s −t| < δ, then
Ψp,2(σX(s, t)) ≤Ψp,2(2CΨ −1
p,2(|s −t|)) ≤max{1, (2C)p}|s −t|,
so indeed (12.24) suﬃces. To prove (12.24), for s, t ∈[0, 1], we have
σ2
X(s, t) =
∞
X
k=1
h2
kM −2k/p
log(k + 1)

sin(2πM kt) −sin(2πM ks)
2.
If |t −s| < 1/M let k0 = k0(|t −s|) ≥1 be the maximal integer such that
M k0 ≤1/|t −s| and let k0 = 1 otherwise. Then as in the proof of Lemma
3.47, it follows that σ2
X(s, t) ≤4∥h∥2
sup[π2(t−s)2S(k0)+T (k0)], where letting
q := 1 −(1/p),
S(k0) :=
k0
X
k=1
M 2kq
log(k + 1)
and
T (k0) :=
X
k>k0
M −2k/p
log(k + 1).
(12.25)

588
12 Stochastic Processes and Φ-Variation
For x ≥1, let L(x) := 1/ log(2 ∨x). Then changing variables in the integral,
we get the bound
S(k0) ≤
Z k0+1
1
L(x)M 2qx dx =
1
log M
Z Mk0+1
M
L
 log y
log M

y2q−1dy =: ˜S(k0).
It is easily seen that L((log y)/ log M) ∼1/(log log y) as y →+∞. Also,
L(x) ≤1/ log 2 for all x. So since p > 1, as k0 →∞, we have (cf. Karamata’s
theorem, e.g. [15, Proposition 1.5.8])
˜S(k0) ∼M 2q(k0+1)
2q log M L(k0 + 1) ≤
M 2q
q log M
|t −s|−2q
log log(1/|t −s|),
where the last inequality holds by the deﬁnitions of L and k0, provided M ≤
k0 + 1. For the second sum in (12.25), we have
T (k0) ≤M 2/p
Z ∞
k0+1
L(x) dx
M 2x/p = M 2/p
log M
Z ∞
Mk0+1 L
 log y
log M

dy
y1+2/p =: ˜T(k0).
By monotonicity of the logarithm and by the deﬁnition of k0, it follows that
˜T(k0) ≤pM 2/p
2 log M M −(k0+1)(2/p)L(k0 + 1) ≤pM 2/p
log M
|t −s|2/p
log log(1/|t −s|)
provided M ≤k0 + 1. Because k0 →∞as |t −s| ↓0, there exist δ > 0 and
a ﬁnite constant C depending on M, p, and ∥h∥sup such that (12.24) holds,
proving (c). Since (a) follows from (c) by Theorem 12.13, the proof of the
proposition is complete.
2
For a function f on [a, b], deﬁne the index of p-variation by
υ(f; [a, b]) :=
inf{p > 0: vp(f) < ∞}
if the set is nonempty,
+∞
otherwise.
Let X be a separable mean-zero Gaussian stochastic process. If for some
1 < p < ∞, vp(fX) < ∞and if p′ > p, then vΨp′,2(fX) < ∞. Thus by
Theorem 12.13, X has locally bounded p′-variation. On the other hand, if for
some 1 < p < ∞, X has locally bounded p-variation then vp(fX) < ∞by
Proposition 12.10. These considerations yield the following fact.
Corollary 12.15. Let X be a separable mean-zero Gaussian stochastic pro-
cess and let 0 < T < ∞. Then with probability 1
υ(X; [0, T]) = inf{p > 0: vp(fX; [0, T]) < ∞}.

12.4
Gaussian Stochastic Processes
589
Fractional Brownian motion
A fractional Brownian motion with Hurst index H ∈(0, 1) is a mean-zero
Gaussian stochastic process BH = {BH(t), t ≥0} with the covariance func-
tion
E

BH(t)BH(s)

= 1
2
h
t2H + s2H −|t −s|2Hi
for t, s ≥0.
(12.26)
Proposition 12.16. For each H with 0 < H < 1, (12.26) does deﬁne a (non-
negative deﬁnite) covariance, and fractional Brownian motion exists. More-
over, it can be taken to be sample-continuous.
Proof. Given H, there is an isometric embedding fH of the half-line [0, ∞)
with the metric dH(s, t) := |s −t|H into a Hilbert space H, as shown by
Schoenberg [209, Theorem 1], or more generally [210, Corollary 1]. We can
assume that fH(0) = 0 ∈H. Then for each s, t ≥0 we have for the norm ∥· ∥
on H that ∥fH(t)∥2 = t2H and
|t −s|2H = ∥fH(t) −fH(s)∥2 = t2H + s2H −2(fH(s), fH(t))
where (·, ·) is the inner product in H. Then the expression in (12.26) equals
(fH(s), fH(t)) and so it gives a covariance. Fractional Brownian motions thus
exist by the general theorem on existence of Gaussian processes (with mean
0), e.g. [53, Theorem 12.1.3]. They can be taken to be sample-continuous by
the metric entropy suﬃcient condition, e.g. [52, Theorem 2.6.1].
2
Remark 12.17. For H = 1 the proposition still holds but the resulting
process is a trivial one with B1(t) ≡tZ for one standard normal ran-
dom variable Z. For H > 1, (12.26) does not deﬁne a covariance, because
[E(BH(t) −BH(s))2]1/2 would equal |s −t|H, which is not a metric on [0, ∞).
Since the right side of (12.26) is equal to t ∧s for H = 1/2, BH is a
Brownian motion in this case. It follows from (12.26) that for each t, u ≥0,
σH(u) := σBH(t, t + u) =

E

BH(t + u) −BH(t)
21/2 = uH.
For the p-variation of fractional Brownian motions we have the following. Let
0 < H < 1 and let 1 < p < ∞. Then for any 0 < T < ∞,
vp(fBH; [0, T]) =
+∞if pH < 1,
T pH if pH ≥1.
Thus if a fractional Brownian motion BH is of locally bounded p-variation
then p ≥1/H by Proposition 12.10. More precisely, by Corollary 12.15, the
p-variation index of a fractional Brownian motion BH is given by
υ(BH) = 1/H
with probability 1.

590
12 Stochastic Processes and Φ-Variation
Corollary 12.23 below will show that vp(BH) = +∞almost surely for p =
1/H. It will also be proved in Corollary 12.23 that a fractional Brownian
motion has locally bounded Φ-variation for a suitable Φ ∈CV which is best
possible.
Let H ∈(0, 1). By Lemma 3.79(a) there is a δ with 0 < δ ≤e−e such that
ΦH(u) :=

u/
p
2 log log(1/u)
1/H is convex for 0 < u ≤δ. By (3.125) we can
set ΦH(0) := 0 and extend ΦH to be linear on [δ, +∞) in such a way that
ΦH is convex on [0, ∞) and so in CV. Moreover, the function ΦH is regularly
varying near zero of order 1/H, that is, for each λ > 0,
lim
u↓0 ΦH(λu)/ΦH(u) = λ1/H.
(12.27)
Let φH(v) := vHp
2 log log(1/v) for 0 < v ≤e−e and φH(0) := 0. Then
we have for the inverse function Φ−1
H (v) ∼φH(v) as v ↓0. It will be proved
that a fractional Brownian motion with Hurst index H has locally bounded
ΦH-variation and for any Φ ∈V such that ΦH(u) = o(Φ(u)) as u ↓0, the
Φ-variation of a sample function of such a process is inﬁnite almost surely. We
begin with preliminary results.
We will use the following probability bound, which will be shown to be a
simple consequence of the Landau–Shepp–Marcus–Fernique theorem.
Lemma 12.18. Let S be a compact set in a Banach space such that cS ⊂
S for each c ∈(0, 1]. Let X = {Xt}t∈S be a mean-zero sample-continuous
Gaussian stochastic process such that for some 0 < H < 1 and each c ∈(0, 1],
{X(ct)}t∈S is equal in distribution to cHX. Let S(1) be a closed subset of
S and deﬁne S(δ) := δS(1) for 0 < δ < 1. For each δ ∈(0, 1], let σ2
δ :=
sup{EX(t)2 : t ∈S(δ)}. Then σ2
δ = δ2Hσ2
1 for 0 < δ < 1. For each θ ∈(0, 1)
there is a ﬁnite M = M(θ) such that for each δ ∈(0, 1] and x > 0,
Pr
 
sup
t∈S(δ)
|X(t)| > x
	
≤M exp

−θx2
2σ2
δ

.
(12.28)
Proof. The ﬁrst part of the conclusion follows easily from the assumptions.
To prove the second part, for each δ > 0 let Cδ be the separable Banach space
of all continuous real-valued functions on S(δ) with supremum norm ∥· ∥sup.
Then Xδ, deﬁned as X restricted to S(δ), is a random element of Cδ with a law
P, deﬁned on the Borel sets of Cδ, which is centered and Gaussian. Let Dδ be
a countable dense subset of S(δ) and consider the sequence {ex : x ∈Dδ} of
continuous linear forms ex : f 7→f(x) on Cδ. Then sup{∫e2
x dP : x ∈Dδ} =
σ2
δ. Let Aδ := sup{|X(t)|: t ∈S(δ)}. By the Landau–Shepp–Marcus–Fernique
theorem (e.g. [52, Theorem 2.2.8]), we have
M(α, δ) := EeαA2
δ =
Z
Cδ
eα∥f∥2
sup P(df) < ∞
if and only if
α <
1
2σ2
δ
.
(12.29)

12.4
Gaussian Stochastic Processes
591
For θ ∈(0, 1), let αδ := θ/(2σ2
δ). For any c > 0, Acδ is equal in distribution
to cHAδ and αcδ = c−2Hαδ, and so αcδA2
cδ = αδA2
δ in distribution. Thus
M := M(θ) := M(αδ, δ) depends on θ but not on δ. Now (12.28) follows from
(12.29), proving the lemma.
2
Next is the local law of the iterated logarithm for fractional Brownian
motion.
Proposition 12.19. For 0 < H < 1, with probability 1,
lim sup
t↓0
|BH(t)|
tHp
2 log log (1/t)
= 1.
(12.30)
To prove the proposition we use the following:
Lemma 12.20. Let {ξk}k≥1 be a sequence of jointly normal random variables
with mean zero and variance 1, such that for some 0 < θ < 1/2,
lim sup
n→∞max

E

ξkξm

: k, m ∈(n, 2n], k ̸= m
	
< θ.
(12.31)
Then with probability 1,
lim sup
k→∞
ξk
√2 log k ≥1 −2θ.
(12.32)
Proof. By the Borel–Cantelli lemma, it is enough to prove that
X
n≥1
Pr

max
2n<k≤2n+1 ξk/
p
2 log k < 1 −2θ

< ∞.
(12.33)
Let {η, ηk}k≥1 be a sequence of independent normal random variables with
mean zero, Eη2 = θ and Eη2
k = 1 −θ for each k. Let N be a positive integer
such that for each n ≥N,
max

E

ξkξm

: 2n < k, m ≤2n+1, k ̸= m
	
< θ,
and let n ≥N. Then E

ξkξm

≤θ = E

(η+ηk)(η+ηm)

for 2n < k, m ≤2n+1
with k ̸= m, and Eξ2
k = 1 = E[η + ηk]2. By the Slepian lemma (e.g. Corollary
3.12 in Ledoux and Talagrand [136]), we have
Pr

max
2n<k≤2n+1 ξk/
p
2 log k ≤1 −2θ

≤Pr

max
2n<k≤2n+1 ξk ≤(1 −2θ)
p
2 log 2n+1

≤Pr

η +
max
2n<k≤2n+1 ηk ≤(1 −2θ)
p
2 log 2n+1

≤Pr
 
η ≤−θ
p
2 log 2n+1	
+

Pr
 
η1 ≤(1 −θ)
p
2 log 2n+1	2n
.

592
12 Stochastic Processes and Φ-Variation
Because η/
√
θ has law N(0, 1), it follows that
Pr
 
η ≤−θ
p
2 log 2n+1	
≤2−θ(n+1).
Similarly since η1/
√
1 −θ has law N(0, 1) and x < e−(1−x) for 0 < x < 1,
there is a ﬁnite constant C = C(θ) such that for all large enough n,

Pr
 
η1 ≤(1 −θ)
p
2 log 2n+1	2n
< exp

−C2θn/
√
n + 1
	
.
Thus (12.33) holds, proving the lemma.
2
Proof of Proposition 12.19. For each r ∈(0, 1), since log(k(log(1/r)) ∼
log k as k →∞, we have
lim sup
t↓0
BH(t)
tHp
2 log log (1/t)
≥lim sup
k→∞
BH(rk)
rkH√2 log k .
(12.34)
For k = 1, 2, . . . , let ξk := BH(rk)/rkH. Then {ξk}k≥1 is a sequence of jointly
normal random variables with mean zero and variance 1, and for 1 ≤k <
m < ∞,
E

ξkξm

= 1
2
h
r(m−k)H + r(k−m)H −
 r(k−m)/2 −r(m−k)/22Hi
.
For any x with 0 < x < 1, using a derivative if 1 < 2H < 2 and concavity if
0 < 2H ≤1, it follows that
x2H + x−2H −
 x−1 −x
2H ≤

x2H + 2Hx2−2H if 1 < 2H < 2,
2x2H
if 0 < 2H ≤1.
Thus for any ǫ ∈(0, 1/2), there is an r ∈(0, 1) small enough such that
E[ξkξm] < ǫ for each k ̸= m, and so by Lemma 12.20, we have
lim sup
k→∞
ξk
√2 log k > 1 −2ǫ
with probability 1. Since ǫ ∈(0, 1/2) is arbitrary, this together with (12.34)
yields (12.30) with “≥” instead of “=”.
To prove the reverse inequality ﬁrst note that given ǫ > 0 and r ∈(0, 1),
for each positive integer k large enough so that rk < e−e,
Pr
 
|BH(rk)| ≥(1 + ǫ)φH(rk)
	
= 2N(0, 1)([(1 + ǫ)
p
2 log(k log(1/r)), +∞)) ≤2

k log(1/r)
−(1+ǫ)2
,
and so by the Borel–Cantelli lemma, with probability 1 we have

12.4
Gaussian Stochastic Processes
593
lim sup
k→∞
|BH(rk)|/φH(rk) ≤1 + ǫ.
(12.35)
Next, given ǫ ∈(0, 1/2), let r ∈(0, 1) be such that 2(1 −r)H ≤ǫ and
rH ≥(1 + ǫ)/(1 + 2ǫ). Then we will show that with probability 1,
lim sup
k→∞
sup
nBH(t)
φH(t) −BH(rk)
φH(rk)
: rk+1 ≤t ≤rko
< 3ǫ.
(12.36)
Given k = 1, 2, . . . let Xk(s) := BH((1 −s)rk) −BH(rk) for s ∈[0, 1]. Then
Xk is a mean-zero Gaussian stochastic process with covariance equal to that
of {BH(srk), s ∈[0, 1]}. Since
sup{|BH(t) −BH(rk)|: rk+1 ≤t ≤rk} = sup{|Xk(s)|: s ∈[0, 1 −r]}
it then follows that
Pr
 
sup{|BH(t) −BH(rk)|: rk+1 ≤t ≤rk} > ǫφH(rk)
	
= Pr
 
sup{|BH(s)|: s ∈[0, rk(1 −r)]} > ǫφH(rk)
	
=: A.
Applying Lemma 12.18 with X = BH, S = [0, 1], S(δ) = [0, δ], 0 < δ < 1,
θ = 1/2, and M = M(1/2), we have for rk < e−e
A ≤M exp

−
ǫ2φH(rk)2
4(1 −r)2Hr2kH

= M
 k log(1/r)
−ǫ2/(2(1−r)2H) ≤M
 k log(1/r)
−2
by the choice of r. Thus by the Borel–Cantelli lemma, with probability 1, we
have
lim sup
k→∞
sup

|BH(t) −BH(rk)|/φH(rk): rk+1 ≤t ≤rk	
≤ǫ.
(12.37)
Since φH is increasing on [0, δ] for some δ > 0, it follows by the choice of r
again that
lim
k→∞sup
nφH(rk)
φH(t) −1
: rk+1 ≤t ≤rko
= r−H −1 ≤
ǫ
1 + ǫ.
This together with (12.35) and (12.37) yields (12.36). Finally, by (12.35) and
(12.36), letting ǫ ↓0, (12.30) holds with probability 1 and with “≤” instead
of “=”, proving the proposition.
2
Lemma 12.21. Let H ∈(0, 1). For each t > 0, with probability 1,
lim
δ↓0


sup
0≤u,v
0<u+v≤δ
|BH(t + u) −BH(t −v)|
φH(u + v)

= 1.
(12.38)

594
12 Stochastic Processes and Φ-Variation
Proof. Let t > 0 and τ := min{t, e−e}. For 0 < δ ≤1, let S(δ) := {(u, v) ∈
[0, ∞) × [0, ∞): 0 < u + v ≤δτ} and
D(δ) := sup
|BH(t + u) −BH(t −v)|
φH(u + v)
: (u, v) ∈S(δ)

.
Clearly D(δ) is nondecreasing in δ, and limδ↓0 D(δ) ≥1 with probability 1 by
the local law of the iterated logarithm (12.30). To bound D(δ) let ǫ ∈(0, 1/2).
For each n = 8, 9, . . . , let δn := exp{−n1−ǫ}, φn := (δnτ)Hp
2 log log(1/δn),
Sn := S(δn), and
En :=

ω ∈Ω:
sup
(u,v)∈Sn
|BH(t + u) −BH(t −v)| ≥(1 + 2ǫ)φn
	
.
To bound Pr(En) we apply Lemma 12.18. For (u, v) ∈S := [0, τ] × [0, τ],
let X(u, v) := BH(t + u) −BH(t −v), Y (u) := BH(t + u) −BH(t), and
Z(v) := BH(t)−BH(t−v). Then X(u, v) ≡Y (u)+Z(v), and X is a Gaussian
process satisfying the hypotheses of Lemma 12.18 with S and S(1) as deﬁned
in this proof. Then σ2
δ = (τδ)2H for 0 < δ ≤1. By (12.28) with θ = 1/(1+2ǫ),
M = M(θ), and x = (1 + 2ǫ)y(τδ)H, the inequality
Pr({
sup
(u,v)∈S(δ)
|X(u, v)| > (1+2ǫ)y(τδ)H}) ≤M exp

−(1+2ǫ)y2/2
	
(12.39)
holds for each y > 0 and 0 < δ ≤1.
For each n ≥8, setting δ = δn and y :=
p
2 log log(1/δn), by (12.39), we
have
Pr(En) ≤M exp

−(1 + 2ǫ) log log(1/δn)
	
= Mn−(1−ǫ)(1+2ǫ).
By the Borel–Cantelli lemma, with probability 1, there exists n0 = n0(ω) such
that for each n ≥n0,
sup
(u,v)∈Sn
|BH(t + u) −BH(t −v)| ≤(1 + 2ǫ)φn.
Now for δ ≤δn and n ≥n0, we have
D(δ) ≤sup
m≥n
sup
|BH(t + u) −BH(t −v)|
φH(u + v)
: (u, v) ∈Sm \ Sm+1

≤sup
m≥n
sup
(u,v)∈Sm
|BH(t + u) −BH(t −v)|
(τδm+1)Hp
2 log log(1/(τδm))
≤(1 + 2ǫ) sup
m≥n
 δm
δm+1
H
s
log log(1/δm)
log log(1/(τδm)).
Since δm/δm+1 →1 as m →∞, the function x 7→log log x is slowly varying
as x →∞and ǫ > 0 is arbitrary, (12.38) holds with probability 1, proving
the lemma.
2

12.4
Gaussian Stochastic Processes
595
The stationary increments property of a stochastic process was recalled
before (12.8). Fractional Brownian motions clearly have the property where
now, since for H ̸= 1/2 BH does not have independent increments, we need
the full deﬁnition as given for joint distributions, not only for one-dimensional
distributions.
Theorem 12.22. Let H ∈(0, 1) and 0 < T < ∞. For the fractional Brown-
ian motion BH, almost surely
lim
δ↓0 sup

sΦH(BH; κ): κ ∈PP [0, T], |κ| ≤δ
	
= T.
(12.40)
Proof. The fact that the left side of (12.40) is at least T will be obtained using
the local law of the iterated logarithm (12.30) and the Vitali covering lemma.
Let 0 < ǫ < 1. For each δ > 0, let Eδ be the set of all (t, ω) ∈[0, T] × Ωsuch
that
ΦH(|BH(t + s, ω) −BH(t, ω)|) > (1 −ǫ)s
(12.41)
for some (rational) s ∈(0, δ). By continuity of ΦH and sample continuity of
BH, the set Eδ is jointly measurable, with Lebesgue measure on [0, T]. Since
ΦH is regularly varying of order 1/H (12.27) and is asymptotic near zero to
φ−1
H , for each c > 0, we have
lim
v↓0 ΦH(cφH(v))/v = lim
u↓0 ΦH(cu)/φ−1
H (u) = c1/H.
(12.42)
Taking c = (1 −ǫ/2)H, there is a ξ(ǫ) > 0 such that
ΦH((1 −ǫ/2)HφH(v)) > (1 −ǫ)v
for each 0 < v < ξ(ǫ). Since BH has stationary increments, by Proposition
12.19, for each t ∈[0, T] and δ > 0, we have Pr
 {ω ∈Ω: (t, ω) ∈Eδ}

= 1.
The Fubini theorem then yields
Z
Ω
Z
[0,T ]
h
1 −1Eδ(t, ω)
i
dt Pr(dω) =
Z
[0,T ]
Z
Ω
h
1 −1Eδ(t, ω)
i
Pr(dω) dt = 0.
For Lebesgue measure λ and any Lebesgue measurable set A, let |A| := λ(A).
Thus for each δ > 0, Pr
 {ω ∈Ω:
{t ∈[0, T]: (t, ω) ∈Eδ}
 = T }

= 1. Let
E := ∩0<δ≤1Eδ = ∩∞
k=1E1/k and
Ω0 := {ω ∈Ω:
{t ∈[0, T]: (t, ω) ∈E}
 = T }.
By continuity of Lebesgue measure, Pr(Ω0) = 1. Let ω ∈Ω0 and δ > 0. Then
the set Fδ(ω) of all intervals [t, t + s], t ∈[0, T], s ∈(0, δ], such that (12.41)
holds is a Vitali cover of E(ω) := {t ∈[0, T]: (t, ω) ∈E}, that is, for each
η > 0 one can extract a subcover of E(ω) by intervals in Fδ(ω) of length less
than η. By the Vitali lemma (e.g. Corollary II.17.2 in [40]), one can pick a
ﬁnite subcollection of intervals from Fδ(ω) which are disjoint and have total

596
12 Stochastic Processes and Φ-Variation
length at least T −ǫ. Let κ = {xi}n
i=0 be a partition of [0, T] with mesh |κ| < δ
such that for each of the disjoint intervals [tj, tj + sj] from Fδ(ω) with total
length at least T −ǫ, there is some i with xi−1 = tj and xi = tj + sj. Then
the bound
sΦH(BH(·, ω); κ) ≥
X
j
ΦH(|BH(tj + sj, ω) −BH(tj, ω)|)
> (1 −ǫ)
X
j
sj > (1 −ǫ)(T −ǫ)
holds for each ω ∈Ω0. Thus almost surely
sup

sΦH(BH; κ): κ ∈PP [0, T], |κ| ≤δ
	
> (1 −ǫ)(T −ǫ).
Since ǫ > 0 and δ > 0 are arbitrary, (12.40) holds with “≥” instead of “=”.
To prove the reverse inequality let ǫ > 0. For any partition κ = {ti}n
i=0 of
[0, T ], let ∆i := ti−ti−1 and ∆iBH := BH(ti)−BH(ti−1) for each i = 1, . . . , n.
Also let I1, I2, and I3 be the sets of i ∈{1, . . . , n} for which |∆iBH| is, re-
spectively, in [0, (1+ǫ)φH(∆i)), [(1+ǫ)φH(∆i), AφH(∆i)), and [AφH(∆i), ∞)
with
A :=
p
8γe2H and γ := 4 + 1/(2H),
(12.43)
and so the ΦH-variation sum sΦH(BH; κ) splits into three sums, to be bounded
as follows.
By (12.42), for any c > 0 there is an η(c, ǫ) > 0 such that
ΦH(cφH(v)) ≤[c1/H + ǫ]v
(12.44)
for each 0 < v < η(c, ǫ). Letting δ1 := η(1 + ǫ, ǫ), for a partition κ of [0, T]
with mesh |κ| < δ1, we then have
X
i∈I1
ΦH(|∆iBH|) ≤
X
i∈I1
ΦH((1 + ǫ)φH(∆i)) ≤

(1 + ǫ)1/H + ǫ

T.
(12.45)
We will show that the sum of ∆i for i ∈I1 is close to T as the mesh of κ
becomes small enough, while the contribution of I2 ∪I3 is negligible. To this
aim, for a given δ > 0, let Uδ be the set of all (t, ω) ∈[0, T] × Ωsuch that
|BH(t + u, ω) −BH(t −v, ω)| < (1 + ǫ)φH(u + v)
for all u, v ≥0 with u +v ≤δ and v ≤t. By Lemma 12.21, for each t ∈(0, T),
we have
Pr
 
ω ∈Ω: lim
δ↓0 1Uδ(t, ω) = 1
	
= 1.
By Fatou’s lemma and the Fubini theorem, it follows that
Z
Ω
h
lim inf
δ↓0
Z
[0,T ]
1Uδ(t, ω) dt
i
Pr(dω) ≥
Z
Ω
Z
[0,T ]
h
lim inf
δ↓0
1Uδ(t, ω)
i
dt Pr(dω)
=
Z
[0,T ]
Z
Ω
h
lim
δ↓0 1Uδ(t, ω)
i
Pr(dω) dt = T,

12.4
Gaussian Stochastic Processes
597
where we can take δ ↓0 through the sequence {1/k}k≥1. Hence
Pr
 (
ω ∈Ω: lim
δ↓0
Z
[0,T ]
1Uδ(t, ω) dt = T
)!
= 1.
Let Ω1 ⊂Ωbe a set with probability 1 such that for each ω ∈Ω1 there exists
a δ2(ω) > 0 with the property
{t ∈[0, T ]: (t, ω) ̸∈Uδ}
 =
Z
[0,T ]

1 −1Uδ(t, ω)

dt ≤ǫ
for all δ ≤δ2(ω). We can and do choose δ2(ω) ≤η(A, ǫ). If the partition κ has
mesh |κ| ≤δ2(ω) and an interval [ti−1, ti] for it contains a point of Uδ2(ω), then
i ∈I1. Also, the total length of such intervals is at least T −ǫ. In particular,
P
i∈I2 ∆i ≤ǫ. By (12.44) with c = A, if |κ| ≤δ2(ω) then
X
i∈I2
ΦH(|∆iBH|) ≤
X
i∈I2
ΦH(AφH(∆i))
≤(A1/H + ǫ)
X
i∈I2
∆i ≤(A1/H + ǫ)ǫ.
(12.46)
It remains to bound the sum of terms ΦH(|∆iBH|) with i ∈I3.
For each integer m ≥3 and each j = 0, 1, . . ., jm := ⌊2T em⌋−1, where
⌊x⌋is the largest integer ≤x, let Sm,j := [(j/2)e−m, (1 + j/2)e−m] and
Vm,j :=
(
ω ∈Ω:
sup
t,s∈Sm,j
|BH(t, ω) −BH(s, ω)| ≥AφH(e−m−2)
)
.
The intervals Sm,j, j = 0, . . . , jm, overlap and cover [0, T]. Moreover, we have
card

i ∈I3(ω): e−m−1 < 2∆i ≤e−m	
≤5 card

j = 0, . . . , jm : ω ∈Vm,j} =: Zm(ω)
(12.47)
for each ω ∈Ω. To bound Zm we apply Lemma 12.18. For a given u ≥0,
let X(t) := BH(t + u) −BH(u) for t ∈[0, 1]. Then X is a Gaussian process
with the covariance of BH and satisfying the hypotheses of Lemma 12.18 with
S = S(1) = [0, 1] and σ2
δ = δ2H for 0 < δ ≤1. By (12.28) with θ = 1/2, so
M = M(1/2), and x = 2yδH, the inequality
Pr
 
sup
t∈[0,δ]
|X(t)| > 2yδH	
≤M exp

−y2	
holds for each y > 0 and δ ∈(0, 1]. For each m ≥3 and j = 0, . . . , jm, setting
u := (j/2)e−m, δ := e−m and y :=
p
γ log(m + 2), recalling (12.43), it then
follows that

598
12 Stochastic Processes and Φ-Variation
Pr(Vm,j) = Pr
 
sup
t,s∈Sm,j
|BH(t) −BH(s)| ≥AφH(e−m−2)
	
(12.48)
≤Pr({ sup
t∈[0,δ]
|X(t)| ≥2yδH}) ≤M exp{−y2} = M(m + 2)−γ.
Thus EZm ≤(2·5) TMemm−γ, and so
X
m≥3
Pr({Zm > emm−γ+2}) ≤10 TM
X
m≥3
m−2 < ∞.
By the Borel–Cantelli lemma, there is a set Ω2 ⊂Ωwith probability 1
such that for each ω ∈Ω2 there exists an integer m1(ω) ≥3 such that
Zm(ω) ≤emm−γ+2 for all m ≥m1(ω). Let m′
1 be large enough so that
δ′ := exp(−m′
1) ≤δ in the deﬁnition of Ψp,1 before Lemma 12.11. We can
assume that m1(ω) ≥m′
1 for all ω ∈Ω2. By Lemma 12.11, there is another
set Ω3 ⊂Ωwith probability 1 such that for each ω ∈Ω3 there exists a ﬁnite
constant K(ω) such that for 0 ≤s < t ≤δ′,
|BH(t, ω) −BH(s, ω)| ≤K(ω)(t −s)Hp
log(1/(t −s)).
(12.49)
Let ω ∈Ω2 ∩Ω3. Let m2(ω) ≥m1(ω) be such that
C(ω) := 21/(2H)−1K(ω)1/H
X
m≥m2(ω)
m−2 < ǫ,
and let δ3(ω) := e−m2(ω)/2. Let κ = {ti}n
i=0 be a partition of [0, T] with mesh
|κ| < δ3(ω), and for each m ≥m2(ω), let Λm := {i = 1, . . . , n: e−m−1 <
2∆i ≤e−m}. Then for each i = 1, . . . , n, 2∆i ≤e−m2(ω), so i ∈Λm for
some m ≥m2(ω). For each m, if i ∈Λm then [ti−1, ti] ⊂Sm,j for some
j = 0, . . . , jm. Thus for such a κ, by (12.47) and (12.49), we have
X
i∈I3
ΦH(|∆iBH|)
=
X
m≥m2(ω)
X
i∈I3∩Λm
ΦH(|∆iBH|)
(12.50)
≤
X
m≥m2(ω)
Zm(ω)ΦH

K(ω)(e−m/2)Hp
log(2em+1)

≤
X
m≥m2(ω)
emm−γ+2K(ω)1/H(e−m/2)(m + 2)1/(2H) ≤C(ω) < ǫ
since ΦH(u) < u1/H for 0 ≤u ≤e−e and γ = 4 + 1/(2H).
Finally, let ω ∈Ω1∩Ω2∩Ω3. Taking δ ≤min{δ1, δ2(ω), δ3(ω)}, by (12.50),
(12.46), and (12.45), for each partition κ of [0, T] with mesh |κ| < δ(ω) we
have the bound
sΦH(BH; κ) ≤

(1 + ǫ)1/H + ǫ

T + (A1/H + ǫ)ǫ + ǫ.

12.4
Gaussian Stochastic Processes
599
Since ǫ > 0 is arbitrary, (12.40) holds, proving the theorem.
2
Now we are ready to show that a fractional Brownian motion BH has
locally bounded ΦH-variation and ΦH is best possible in a sense to be given.
Corollary 12.23. Let H ∈(0, 1). A fractional Brownian motion BH has
locally bounded ΦH-variation and for each 0 < T < ∞,
Pr({T ≤vΦH(BH; [0, T]) < ∞}) = 1.
If Φ ∈V and ΦH(u) = o(Φ(u)) as u ↓0, then vΦ(BH; [0, T]) = +∞almost
surely. In particular, vp(BH; [0, T]) = +∞almost surely for p = 1/H.
Proof. Let 0 < T < ∞. The almost sure bound vΦH(B; [0, T]) ≥T follows
from Theorem 12.22. Moreover, by the same theorem, for almost every ω ∈Ω,
there is a δ(ω) > 0 such that
sup

sΦH(BH(·, ω); κ): κ ∈PP [0, T], |κ| ≤δ(ω)
	
≤T + 1.
If κ is a partition of [0, T ] then the number of intervals of the partition of
length at least δ(ω) cannot be more than T/δ(ω). Thus
vΦH(BH(·, ω); [0, T]) ≤1 + T + Tδ(ω)−1ΦH(Osc(B(·, ω); [0, T]))
and the right side is ﬁnite for almost all ω. The ﬁrst part of the corollary
now follows from Theorem 12.3 since almost all sample functions of BH are
continuous by Proposition 12.16.
Let Φ ∈V be such that ΦH(u) = o(Φ(u)) as u ↓0. Then for any partition
κ of [0, T ], we have
sΦ(BH; κ) ≥sΦH(BH; κ) min
i

Φ(|∆iBH|)/ΦH(|∆iBH|)
	
,
where ∆iBH are non-zero increments of BH over intervals of κ. Letting the
mesh of κ be arbitrarily small, the second part of the corollary now follows
from Theorem 12.22.
2
Letting H = 1/2, the preceding theorem and corollary yield the following
result for Brownian motion:
Corollary 12.24 (S. J. Taylor [231]). For Brownian motion B and for 0 <
T < ∞, almost surely
lim
δ↓0 sup

sΦ1/2(B; κ): κ ∈PP [0, T], |κ| ≤δ
	
= T.
If Φ ∈V and Φ1/2(u) = o(Φ(u)) as u ↓0, then vΦ(B; [0, T]) = +∞almost
surely.

600
12 Stochastic Processes and Φ-Variation
12.5
Markov Processes
This section contains one main result, Theorem 12.27, showing that Markov
processes with certain power-type bounds on their transition probabilities can
be chosen to have trajectories of bounded p-variation.
A measurable space (S, S) is a set S together with a σ-algebra S of subsets
of S. It will be called a Borel space if it is measurably isomorphic to a Borel
subset of a Polish (complete separable metric) space with Borel σ-algebra.
(The terminology follows [112, p. 7].) In this section we consider measurable
functions with values in S. In particular, given a set T and a probability space
(Ω, F, Pr), a stochastic process {Xt}t∈T is a function (t, ω) 7→Xt(ω), t ∈T ,
ω ∈Ω, with values in S, such that for each t ∈T , Xt(·) is measurable.
For any measurable space (Ω, F) and measurable function ξ from Ωto
another measurable space, let σ(ξ) denote the smallest σ-algebra for which ξ
is measurable. Thus σ(ξ) ⊂F. For a probability space (Ω, F, Pr), a stochastic
process {Xt}t∈T deﬁned on Ω, and a subset V ⊂T , let σ({X(s): s ∈V }) ≡
σ({X(s)}s∈V ) ⊂F be the smallest σ-algebra for which all X(s) for s ∈V are
measurable.
For any sub-σ-algebra B ⊂F, let PrB denote the restriction of Pr to B. For
any W ∈F, the conditional probability Pr(W|B) is a B-measurable real-valued
random variable satisfying, for each C ∈B,
Pr(W ∩C) =
Z
C
Pr(W|B) d Pr.
(12.51)
Then Pr(W|B) is unique up to equality PrB-almost surely.
Let ξ and η be two random variables on (Ω, F, Pr) with values in measur-
able spaces (S, S) and (M, M), respectively. For each A ∈M, we can then
deﬁne
Pr({η ∈A}|σ(ξ)) ≡Pr(η−1(A)|σ(ξ))
(12.52)
since {η ∈A} is just another notation for the set η−1(A). Let Pξ := Pr ◦ξ−1, in
other words Pξ(B) := Pr(ξ−1(B)) for each B ∈S. The conditional probability
Pr(η−1(A)|σ(ξ)) can be represented as a function fA(ξ) = fA ◦ξ, where fA
is an S-measurable function from S into [0, 1] (see e.g. [112, Lemma 1.13]),
since [0, 1] with its Borel σ-algebra is a Borel space. Then fA is unique up to
equality Pξ-a.s. We also write Pr(η−1(A)|{ξ = x}) := fA(x) for x ∈S. By
a change of variables (image measure theorem, e.g. [53, Theorem 4.1.11]) in
(12.51) with C = ξ−1(B) and W = η−1(A), we have
Pr(η−1(A) ∩ξ−1(B)) =
Z
B
Pr(η−1(A)|{ξ = x}) Pξ(dx)
(12.53)
for each B ∈S.
For any two measurable spaces (S, S) and (M, M), a probability kernel
on (S, S|M, M) will mean a function Q from S × M into [0, 1] such that
Q(x, ·) is a probability measure on (M, M) for all x ∈S and Q(·, A) is an

12.5
Markov Processes
601
S-measurable function on S for all A ∈M. A probability kernel on (S, S) will
mean one on (S, S|S, S). A regular conditional distribution of η given ξ is a
probability kernel Qξ,η on (S, S|M, M) such that for each A ∈M, Qξ,η(·, A) is
a conditional probability Pr(η−1(A)|{ξ = ·}). If (M, M) is a Borel space, then
a regular conditional distribution Qξ,η exists, and if Q′
ξ,η is another regular
conditional distribution, then for some B ∈S with Pξ(B) = 0, if x ̸∈B, then
Q′
ξ,η(x, A) = Qξ,η(x, A) for all A ∈M (e.g. Theorems 10.2.2 and 13.1.1 in
[53]).
Thus Qξ,η is a probability kernel such that for each A ∈M and B ∈S,
Pr(η−1(A) ∩ξ−1(B)) =
Z
B
Qξ,η(x, A) Pξ(dx).
(12.54)
Most often, stochastic processes X(t) are considered starting at time t = 0,
but we will also consider processes starting at times s0 ≥0 with a view
to the behavior beginning at time s0 of a process conditional on having a
certain value at time s0. In what follows, [s0, T]] will mean [s0, ∞) if T =
+∞but for s0 < T < ∞it may mean, as usual, either [s0, T) or [s0, T].
Let (S, S) be a Borel space and s0 < T ≤+∞. Then (s, t) 7→Ps,t(·, ·) for
s0 ≤s < t ∈(s0, T ]] will be called a Markov (transition) kernel on (S, S) if
for any s0 ≤s < t ∈(s0, T ]], Ps,t is a probability kernel on (S, S) and for
any s0 ≤s < t < u ∈(s0, T ]], x ∈S, and A ∈S, the following Chapman–
Kolmogorov equation holds:
Ps,u(x, A) =
Z
Pt,u(y, A)Ps,t(x, dy).
(12.55)
A stochastic process {Xt}t∈[s0,T ]] for T > s0 with values in S will be called
a Markov process if there exists a Markov kernel (s, t) 7→Ps,t(·, ·) on (S, S)
for s0 ≤s < t ∈(s0, T]] such that Ps,t is a regular conditional distribution
of X(t) given X(s) for s0 ≤s < t ∈(s0, T]]. (Actually, if Ps,t(x, A) is just a
conditional probability that X(t) ∈A given X(s) = x, the regular conditional
probability properties follow from those assumed for Markov kernels.) Given
Ps,t for s < t one can deﬁne Pt,t(x, A)
:=
δx(A) ≡1A(x). This is clearly
a probability kernel, and (12.55) still holds if t = s or t = u. If s0 is not
mentioned explicitly, then it is meant that s0 = 0, which is usually the case in
the main deﬁnition of a Markov kernel or process. Then in proofs or auxiliary
statements, other values of s0 may be used.
For any nonempty set J recall that SJ denotes the set of all functions
from J into S. For each t ∈J, we have the function ξt on SJ deﬁned by
ξt(f) := f(t) (ξt may be called the t coordinate function on SJ.) On SJ let
SJ be the smallest σ-algebra for which all ξt for t ∈J are measurable. The
following is known:
Theorem 12.25 (Kolmogorov–Doob). Let (S, S) be a Borel space, let 0 ≤
s0 < T ≤+∞, and suppose Ps,t(·, ·) is a Markov kernel on (S, S) for s0 ≤s <
t ∈(s0, T]] and a probability measure ν on (S, S). Then there are a probability

602
12 Stochastic Processes and Φ-Variation
space (Ω, A, Pr) and a Markov process X(t) := X(t, ω) for t ∈J := [s0, T]]
and ω ∈Ωhaving the kernel Ps,t and for which X(s0) has distribution ν.
Speciﬁcally, we can take Ω= SJ, A = SJ, and X(t) = ξt, and then the
probability measure Ps0;ν := Pr is unique.
Proof. A proof is given by Kallenberg [112, Theorem 8.4] and will also be
sketched here. It suﬃces to consider the case Ω= SJ, A = SJ, and X(t) :=
ξt. Let n = 1, 2, . . . , and let s0 < s1 < · · · < sn ∈(s0, T]]. If B is a measurable
set in S × S, let
Ps0;ν ((ξs0, ξs1) ∈B) :=
Z Z
1B(u, v)Ps0,s1(u, dv)dν(u).
Beginning with measurable rectangles B = C × D, continuing via ﬁnite (dis-
joint) unions of them, and using monotone classes (e.g. [53, §4.4, Theorem
10.2.1]), one gets that Ps0;ν is a countably additive probability measure on
such sets. Then, if A is a measurable set in S{s0,...,sn}, let
Ps0;ν ((ξs0, . . . , ξsn) ∈A)
:=
Z Z
. . .
Z
1A(u0, . . . , un)Psn−1,sn(un−1, dun) · · · Ps0,s1(u0, du1)dν(u0).
By the argument for n = 1 and induction, we get a countably additive prob-
ability measure on S{s0,...,sn}. The resulting joint distributions of ξs0, . . . , ξsn
are mutually consistent by the Chapman–Kolmogorov equation (12.55). So,
by Kolmogorov’s general existence theorem for stochastic processes, e.g. [53,
Theorem 12.1.2], and since (S, S) is a Borel space, Ps0;ν extends to a prob-
ability measure on (SJ, SJ). The extension is unique because the union of
the σ-algebras SF for ﬁnite sets F ⊂J is an algebra generating SJ, by a
monotone class theorem (e.g. [53, Theorem 4.4.2]). By construction, {ξt}t∈J
is then a Markov process with kernel Ps,t and ξs0 has distribution ν.
2
If ν is a point mass δx at a point x ∈S, then let Ps;x := Ps;δx.
Remark 12.26. The σ-algebra SJ is a relatively small one, since it is the
union of SV over all countable subsets V of J (this union is easily seen to be
a σ-algebra with respect to which all ξt for t ∈J are measurable). In other
words, each individual set in SJ depends on only countably many coordinates
ξt. It follows that a real-valued function on SJ, measurable for SJ, can depend
on only countably many coordinates. On the other hand, if we take a σ-algebra
larger than SJ, speciﬁcally, larger than its completion for a given Ps0;ν, then
Ps0;ν will not extend uniquely to such a σ-algebra.
A frequent alternative deﬁnition of Markov process is as follows. Given a
probability space (Ω, F, Pr), a stochastic process X = {Xt}t∈[s0,T ]] has the
Markov property if for each t ∈(s0, T]], the σ-algebras σ(X(s): s ≥t) and

12.5
Markov Processes
603
FX
t
:= σ(X(s): s0 ≤s ≤t) are conditionally independent given σ(X(t)). It is
easily seen that any Markov process as deﬁned above has the Markov property.
Conversely, for a given process X with the Markov property and values in
a Borel space, we can deﬁne probability kernels Ps,t as regular conditional
distributions of X(t) given X(s). Then the Chapman–Kolmogorov equation
(12.55) will hold for almost all x with respect to the distribution of X(s) [112,
Corollary 7.3]. In order that the Markov kernel be deﬁned uniquely rather than
only in an almost sure sense, following Kallenberg [112, p. 140] and others,
we assume the deﬁnition of Markov process as given above after (12.55).
Let (S, d) be a complete separable metric space with Borel σ-algebra S
and 0 < T < ∞. Let T be a linearly ordered set, speciﬁcally, [0, T] or a
subset of it. Let f be a function from T into S. Let κ be a point partition
of T . The p-variation sum sp(f; κ) is deﬁned as in and before (1.19) except
with d(f(ti−1), f(ti))p in place of ∥f(ti) −f(ti−1)∥p. Then the p-variation
vp(f) := vp(f; T ) is deﬁned as in (1.19), namely as the supremum of sp over
all point partitions of T .
Let Ps,t(·, ·), 0 ≤s < t ≤T , be a Markov kernel on (S, S). For h ∈[0, T),
0 ≤s0 < T −h, and r > 0, let αs0,T (h, r) be deﬁned by αs0,T (0, r) := 0 and
for h > 0,
αs0,T (h, r) := sup

Ps,t(x, {y: d(x, y) ≥r}): x ∈S, s0 ≤s ≤t ≤(s+h)∧T
	
.
If s0 = 0 then let αT (h, r) := α0,T (h, r).
For β ≥1 and γ > 0, the kernel P·,·(·, ·) will be said to belong to the class
M(β, γ) if there exist constants r0 > 0 and K > 0 such that
αT (h, r) ≤K hβ
rγ
(12.56)
for all h ∈[0, T ] and r ∈(0, r0].
Here is the main theorem of this section. As Manstaviˇcius [155] pointed
out, the conclusion is sharp: it can fail when p = γ/β, for symmetric stable
L´evy processes as will be shown in Remark 12.39.
Theorem 12.27 (M. Manstaviˇcius). Let (S, d) be a complete separable met-
ric space with Borel σ-algebra S and let ν be any probability measure on (S, S).
Let β ≥1 and γ > 0. For any p > γ/β and 0 < T < ∞, and any Markov ker-
nel {Ps,t(·, ·)}0≤s<t≤T on (S, S) in the class M(β, γ), there exists a Markov
process {Yt}0≤t≤T with this kernel, such that Y (0) ≡Y0 has distribution ν, and
such that the trajectories t 7→Y (t, ω), 0 ≤t ≤T , have bounded p-variation
on [0, T ] and are right-continuous on [0, T) almost surely.
To begin the proof, let {Xt}0≤t≤T be a Markov process with the given
kernel and initial distribution by Theorem 12.25, namely, let Ω:= S[0,T ],
A := S[0,T ], X(t) = ξt for 0 ≤t ≤T , and Pr = P0;ν. Let T be a countable
dense subset of [0, T ] containing 0 and T . Let Y (t) := X(t) for t ∈T . Then
Y (0) has distribution ν. The plan of the proof is to bound the p-variation of

604
12 Stochastic Processes and Φ-Variation
{Yt}t∈T over ﬁnite subsets F of T , uniformly in F and thus over T , then to
extend to [0, T ].
By rescaling time we can assume that T = 1. From here on let α(·, ·) :=
α1(·, ·)
:=
αT (·, ·) for T = 1. For a countable set F and subinterval J of
[0, 1], let JF := J ∩F.
For a function g from a set V into a metric space X with metric d, the
oscillation of g on V is deﬁned by Osc(g; V ) := sup{d(g(u), g(v)) : u, v ∈V }.
The proof continues with the following inequality of Ottaviani type.
Lemma 12.28. Let the Markov process X(v, ·) = ξv, v ∈[0, 1], and α(·, ·)
be as deﬁned above. Let 0 ≤s < t ≤1 and suppose that u > 0 is such that
α(t −s, u/4) < 1. Let F be a countable subset of [0, 1]. Then almost surely
Pr
 
Osc(X; [s, t]F ) > u
	σ(X(s))

≤Pr({d(X(t), X(s)) > u/4
	σ(X(s))

1 −α(t −s, u/4)
.
(12.57)
Proof. Let G :=
[s, t]F ∪{s, t}, which is countable. The oscillation, X(s),
and X(t) are all measurable with respect to SG. For the given s, and each
x ∈S, we have the probability measure Ps;x deﬁning a Markov process on
S[s,1], which is uniquely determined on S[s,1] and thus on SG.
It will be shown that for each x ∈S,
Ps;x
 
Osc(X; [s, t]F) > u
	
≤Ps;x({d(X(t), X(s)) > u/4
	
1 −α(t −s, u/4)
.
(12.58)
For any event A ∈S[0,1], the conditional probability Pr
 A|σ(X(s))

equals
gA(X(s)) almost surely for some S-measurable function gA ≡Pr(A|X(s) = ·),
as noted above after (12.52), and Pr = P0;ν. If, moreover, A ∈SG, then
Pr(A|X(s) = x) = Ps;x(A)
(12.59)
almost surely for PX(s) = Pr ◦X(s)−1. To see this, ﬁrst suppose that A ∈SH
for a ﬁnite set H ⊂G. Then by the constructions of P0;ν and Ps;x in the proof
of Theorem 12.25, we have
Pr(A ∩{X(s) ∈B}) =
Z
B
Ps;x(A) PX(s)(dx)
for each B ∈S. Thus (12.59) holds if A ∈SH for PX(s)-almost all x by a.s.
uniqueness of conditional probabilities as in (12.51), (12.52), and (12.53). We
can let the ﬁnite sets H increase up to the countable set G via a monotone
class theorem. So, (12.58) will imply (12.57).
To prove (12.58), for any ﬁxed x, let Pr = Ps;x in the rest of the proof.
Note that the kernel for the Markov process deﬁned by each Ps;x is the subset
{Pv,w : s ≤v < w ≤1} of the original one, where clearly αs,1(h, r) ≤α1(h, r)

12.5
Markov Processes
605
for all h > 0 and r > 0 and the bound on the right side of (12.56) also applies
to αs,1.
First let F be ﬁnite. We can assume that s ∈F and t ∈F since this can
only enlarge the oscillation. Let [s, t]F = {tj}m
j=0 where s = t0 < t1 < · · · <
tm = t. For k = 2, . . . , m, let Bk be the set of all (x0, x1, . . . , xk) ∈Sk+1
such that d(xj, x0) ≤u/2 for j = 1, . . . , k −1 and d(xk, x0) > u/2, and
let B1 be the set of all (x0, x1) ∈S2 such that d(x1, x0) > u/2. Letting
Uk := Uk(ω) := (X(t0, ω), . . . , X(tk, ω)), ω ∈Ω, we have

ω:
max
v∈[s,t]F d(X(v, ω), X(s, ω)) > u/2

=
m
[
k=1

ω: Uk(ω) ∈Bk
	
,
(12.60)
a union of disjoint sets. For k = 1, . . . , m, let Vk := (X(tk), X(t)), and let C
be the set of all (x, y) ∈S2 such that d(x, y) < u/4. Then
{ω: d(X(t, ω), X(s, ω)) > u/4} ⊃
m
[
k=1
{Uk ∈Bk} ∩{Vk ∈C}.
(12.61)
Due to the Markov property of X, for each k ∈{1, . . ., m} the events {Uk ∈
Bk} and {Vk ∈C} are conditionally independent given σ(X(tk)), and so
using the deﬁnitions (12.51), (12.52) of conditional probabilities and a change
of variables, we have
Pr
 {Uk ∈Bk} ∩{Vk ∈C}

=
Z
Pr
 {Uk ∈Bk} ∩{Vk ∈C}
σ(X(tk))

d Pr
=
Z
Pr
 {Uk ∈Bk}
{X(tk) = x}

×
(12.62)
× Pr
 {Vk ∈C}
{X(tk) = x}

PX(tk)(dx).
By the deﬁnitions of Vk and C, it follows that for each k ∈{1, . . . , m}, and
almost all x for PX(tk),
Pr
 {Vk ∈C}|{X(tk) = x}

= 1 −Ptk,t(x, {y: d(y, x) ≥u/4})
≥1 −α(t −s, u/4).
(12.63)
By (12.62), (12.63), and (12.51) with C there = Ωand W = {Uk ∈Bk} in
(12.51), we then have
Pr
 {Uk ∈Bk} ∩{Vk ∈C}

≥[1 −α(t −s, u/4)] Pr
 {Uk ∈Bk}

.
Since the sets {Uk ∈Bk} are disjoint, by (12.60) and (12.61), it then follows
that
Pr
 
d(X(t), X(s)) > u/4
	
≥
m
X
k=1
Pr
 {Uk ∈Bk} ∩{Vk ∈C}

≥
h
1 −α

t −s, u
4
i
Pr
 
max
v∈[s,t]F d(X(v), X(s)) > u/2
	
.

606
12 Stochastic Processes and Φ-Variation
Letting the ﬁnite set F increase up to a countable set, this yields (12.58) and
so (12.57), proving the lemma.
2
Now continuing with the proof of Theorem 12.27, recall that T
is a
countable dense subset of [0, 1] containing 0 and 1, and Y (t) = X(t) = ξt
for t ∈T . Let F be any ﬁnite subset of T with 1 ∈F. For t ≥0, let
FY,F
t
:=
σ(Y (s):
0 ≤s ≤t, s ∈F). Thus a random variable τ ≥0 is
a stopping time for the process Y = {Yt}t∈F if and only if {τ ≤t} ∈FY,F
t
for each t ≥0. If τ is any stopping time for {Yt}t∈F then the σ-algebra
Fτ := FY,F
τ
is deﬁned as the collection of all measurable sets A such that for
each t ≥0, A ∩{τ ≤t} ∈FY,F
t
.
Lemma 12.29. Let Y , F, and Ft = FY,F
t
, t ≥0, be as above, let τ be a
stopping time for the ﬁltration {Ft : t ≥0} such that τ has values in the
ﬁnite set F ∪{2}, and let A(s) ∈σ(Y (t): t ≥s, t ∈F) for each s ∈F and
A(2) := ∅. Let A(τ) := S
t∈F ∪{2} A(t) ∩{τ = t}. Then almost surely on
{τ ≤1},
Pr(A(τ)|Fτ) = Pr(A(τ)|σ(τ, Y (τ))).
(12.64)
Proof. Note that in the deﬁnition of A(τ), F ∪{2} can be replaced equivalently
by F. Let s ∈F. We have {τ = s} = {τ ≤s} ∩Cs ∈Fs where Cs = Ωif
s = min{t :
t ∈F}. Otherwise, if u = max{v ∈F :
v < s}, we can let
Cs = Ω\ {τ ≤u} ∈Fu ⊂Fs. Since Y is a Markov process and A(s) ∈
σ(Y (t): t ≥s, t ∈F), by the Markov property, we have almost surely
Pr(A(s)|Fs) = Pr(A(s)|σ(Y (s))) = Ps;Y (s)(A(s)),
(12.65)
where the last equality holds by (12.59). Let B ∈Fτ. Then B ∩{τ = s} ∈Fs,
since B ∩{τ ≤u} ∈Fu ⊂Fs for u < s, and so
Pr(A(τ) ∩B ∩{τ = s})
=
Z
B∩{τ=s}
Pr(A(s)|Fs) d Pr
=
Z
B∩{τ=s}
Pr(A(s)|σ(Y (s))) d Pr =
Z
B∩{τ=s}
Pτ;Y (τ)(A(τ)) d Pr
by (12.65). Summing over the ﬁnitely many values of τ it follows that
Pr(A(τ) ∩B) =
Z
B∩{τ≤1}
Pτ;Y (τ)(A(τ)) d Pr
for any B ∈Fτ since A(2) = ∅. Now on {τ
≤1}, Pτ;Y (τ)(A(τ)) ≡
P
s∈F 1τ=sPs;Y (s)(A(s)) and for each s ∈F, Ps;Y (s)(A(s)) is a measurable
function of Y (s). Thus Pτ;Y (τ)(A(τ)) is measurable for σ(τ, Y (τ)) and so for
Fτ on {τ ≤1}. Then Pr(A(τ)|Fτ) = Pτ;Y (τ)(A(τ)). Similarly we have on
{τ ≤1} that Pr(A(τ)|σ(τ, Y (τ))) = Pτ;Y (τ)(A(τ)), proving (12.64).
2

12.5
Markov Processes
607
For integers k = 0, ±1, ±2, . . ., let Mk := 2−k−1 and let {τi,k}i=0,1,2,... be
the sequence of random variables deﬁned by τ0,k := 0 and
τi,k :=

min

t ∈[τi−1,k, 1]F : Osc(Y ; [τi−1,k, t]F ) > Mk
	
if such a t exists,
2
otherwise.
Here τF
i,k
:=
τi,k depends on F. For each integer k, let i0 = i0(k) be the
smallest integer i ≥0 such that τi,k ≥1. We have 0 = τ0,k < τ1,k < · · · <
τi0−1,k < 1 ≤τi0,k almost surely. Moreover, {τi,k ≤t} ∈FY,F
t
for each t ≥0,
and so τi,k is a stopping time for each i, k.
For each integer k and i = 1, 2, . . . , let ζi,k := ζF
i,k
:= τF
i,k −τF
i−1,k. For
random variables ξ and η on (Ω, F, Pr) and A ∈F, we say that ξ ≤η almost
surely on A if Pr({ξ ≤η} ∩A) = Pr(A). If Pr(A) > 0, this is equivalent to
Pr({ξ ≤η}|A) = 1.
Lemma 12.30. For an integer k, let h0 ∈(0, 1] be such that α(h0, Mk+2) <
1. Then for any ﬁnite F ⊂T , each i = 1, 2, . . . , and h ∈[0, h0], almost surely
on {τi−1,k < 1},
Pr
 
ζF
i,k ≤h
	FY,F
τi−1,k

≤
α(h, Mk+2)
1 −α(h, Mk+2).
Proof. Let i be such that Pr({τi−1,k < 1}) > 0. If τi,k = 2 then the conclusion
holds. Otherwise, τi,k ≤1. Let h ∈(0, h0]. If ζi,k ≤h and τi−1,k < 1, then
τi,k ≤1. By deﬁnition of the stopping times, we have

ζi,k ≤h, τi−1,k < 1
	
=

Osc(Y ; [τi−1,k, (τi−1,k + h) ∧1]F ) > Mk, τi−1,k < 1
	
.
(12.66)
Now τi−1,k has possible values less than 1 in a ﬁnite set Fi = Fi,k ⊂[0, 1)F .
Let σi,k := σ(τi−1,k, Y (τi−1,k)). Since {Yt}t∈F is a Markov process, for each
s ∈Fi, the two events {Osc(Y ; [s, (s + h) ∧1]F ) > Mk} and {d(Y ((s + h) ∧
1), Y (s)) > Mk+2} are each conditionally independent of {τi−1,k = s} given
σ(Y (s)). To apply Lemma 12.29, note that {ζi,k ≤h} is an event A(τ) for
τ := τi−1,k. Thus by Lemmas 12.29 and 12.28, and since Mk+2 ≡Mk/4, we
have
Pr
 
ζi,k ≤h
	FY,F
τi−1,k

= Pr
 
ζi,k ≤h
	σi,k

≤Pr
 
Osc(Y ; [τi−1,k, (τi−1,k + h) ∧1]F ) > Mk
	σi,k

=
X
s∈Fi
Pr(τi−1,k = s|σ(Y (s))) Pr
 {Osc(Y ; [s, (s + h)∧1]F )>Mk}
σ(Y (s))

≤
X
s∈Fi
Pr(τi−1,k = s|σ(Y (s)))Pr
 {d(Y ((s + h)∧1), Y (s))>Mk+2}|σ(Y (s))

1 −α(h, Mk+2)
= Pr({d(Y ((τi−1,k + h) ∧1), Y (τi−1,k)) > Mk+2}|σi,k)/[1 −α(h, Mk+2)]

608
12 Stochastic Processes and Φ-Variation
almost surely on {τi−1,k < 1} by (12.66). For a ﬁxed h > 0, (τi−1,k +h)∧1 has
possible values in a ﬁnite set Gi,h. For each u ∈Fi and v := (u+h)∧1 ∈Gi,h,
we have 0 < v −u ≤h. Applying the deﬁnition of α to the Markov kernel Pu,v
for all such (u, v) and noting that the supremum over x includes all possible
values of Y (τi−1,k), we see that the numerator in the last displayed fraction
is at most α(h, Mk+2). The conclusion of the lemma follows.
2
We also need to deal with the incomplete gamma function deﬁned for a > 0
and x ≥0 by
γ(a, x) :=
Z x
0
ua−1e−u du.
(12.67)
Lemma 12.31. If 0 < x < 3(3 + a)(2 + a)−1 then
γ(a, x) < xa
a
n
1 −
a
(a + 1)x +
a
2(a + 2)x2o
.
Proof. By equations (6.5.2), (6.5.4), and (6.5.29) from [38, pp. 260 and 262],
the incomplete gamma function has the following series representation: for
any a > 0 and x ≥0,
γ(a, x) =
∞
X
k=0
(−1)kxk+a
k!(k + a) .
For k ≥2 and x as speciﬁed, the ratio of absolute values of successive terms
is
x(k + a)
(k + 1)(k + a + 1) < 1,
as can be seen since (u + a)/[(u + 1)(u + a + 1)] is decreasing for u ≥2. Since
the series is alternating and the term with index k = 3 is negative, one can
discard all terms with k ≥3 and get the stated bound, completing the proof
of the lemma.
2
For all h ∈[0, 1] and r > 0, since α(h, r) is nondecreasing as r decreases,
we have for r0 as in the deﬁnition of the class M(β, γ),
α(h, r) ≤K
hβ
(r ∧r0)γ .
(12.68)
Lemma 12.32. Suppose that for an integer k, we have
Tk := min
n(r0 ∧Mk+2)γ
2K
1/β
, 1
o
< 1.
(12.69)
Then for each ﬁnite F ⊂T and j = 1, 2, . . .,
Pr({τF
j,k ≤1}) ≤e

βγ(β, Tk)/T β
k
j
.

12.5
Markov Processes
609
Proof. By condition (12.68) and by the deﬁnition of Tk, for each k such that
(12.69) holds, we have
α(Tk, Mk+2) ≤KT β
k (Mk+2 ∧r0)−γ = 1/2.
Let i be a positive integer. Recall that ζi,k = τi,k −τi−1,k. Using Theorem
10.2.5 in [53], integration by parts, Lemma 12.30, and (12.68), we have
E
 e−ζi,k|FY,F
τi−1,k

=
Z 2
0
e−x d Pr
 
ζi,k ≤x|FY,F
τi−1,k
	
≤e−2 +
Z 2
Tk
e−x dx +
Z Tk
0
Pr
 
ζi,k ≤x|FY,F
τi−1,k
	
e−x dx
≤e−Tk + 2
Z Tk
0
α
 x, Mk+2)e−x dx ≤e−Tk + 1
T β
k
Z Tk
0
xβe−x dx
almost surely on {τi−1,k < 1}. Recalling the incomplete gamma function
(12.67), integration by parts once again yields
0 ≤γ(β + 1, Tk) =
Z Tk
0
xβe−x dx = −T β
k e−Tk + βγ(β, Tk).
Thus almost surely on {τi−1,k < 1}, we have
E
 e−ζi,k|FY,F
τi−1,k

≤βγ(β, Tk)/T β
k .
(12.70)
Let j ≥1 be an integer. Using properties of conditional expectations, Markov’s
inequality, and the bound (12.70) applied j times, it follows that
Pr({τj,k ≤1}) = Pr({τj,k ≤1, τj−1,k < 1})
= E

1{τj−1,k<1} Pr({τj,k ≤1|FY,F
τj−1,k})

= E

1{τj−1,k<1} Pr({e−τj,k ≥e−1|FY,F
τj−1,k})

≤eE

1{τj−1,k<1}E
 e−τj,k|FY,F
τj−1,k

= eE
 j−1
Y
i=1
 1{τi,k<1}e−ζi,k
E
 e−ζj,k|FY,F
τj−1,k

!
≤eβγ(β, Tk)
T β
k
E
 j−2
Y
i=1
 1{τi,k<1}e−ζi,k
E
 e−ζj−1,k|FY,F
τj−2,k

!
≤· · · ≤e
 
βγ(β, Tk)
T β
k
!j
,
proving the lemma.
2

610
12 Stochastic Processes and Φ-Variation
Now to complete the proof of Theorem 12.27, we can and do assume that
0 < r0 ≤1 and K ≥1. For u > 0 and ω ∈Ω, let νu(ω) be the supremum
of integers m such that for some {ti}2m
i=1 ⊂T such that 0 ≤t1 < t2 ≤t3 <
· · · < t2m ≤1, we have ∆iY (·, ω) := d(Y (t2i, ω), Y (t2i−1, ω)) > u for each
1 ≤i ≤m. For an integer k, a partition κ = {ti}2n
i=0 ⊂T of [0, 1], and ω ∈Ω,
let
Ik = Ik(κ, ω) :=

i ∈{1, . . . , n}: 2−k−1 ≤∆iY (·, ω) < 2−k	
and Nk(ω) := sup{card Ik(κ, ω): κ ∈PP[0, 1], κ ⊂T }. Let k1 be the largest
integer less than or equal to −(log2 r0 + 3) ≥−3. Thus k1 ≥−3 and 2−k−1 ≥
4r0 > r0 for each k ≤k1. Then we have
vp
 Y (·, ω); T

≤
X
k>k1
sup
κ
X
i∈Ik
∆iY (·, ω)p + sup
κ
X
k≤k1
X
i∈Ik
∆iY (·, ω)p
≤
X
k>k1
2−kpNk(ω) + Osc(Y (·, ω); T )pνr0(ω).
(12.71)
It will next be proved that
X
k>k1
2−kpENk < ∞.
(12.72)
Let k > k1. Then we have
ENk =
Z ∞
0
Pr({Nk ≥x}) dx ≤
∞
X
j=0
Pr({Nk ≥j}).
(12.73)
By deﬁnition of k1, we have 2−k−3 < r0 ≤1, and so
Tk = min{(2−(k+3)γ/(2K))1/β, 1} < 1.
By Lemma 12.32, for each j
Pr({Nk ≥j}) ≤sup
F ⊂T
Pr({τ F
j,k ≤1}) ≤e
(
βγ(β, Tk)
T β
k
)j
,
(12.74)
where the supremum is over ﬁnite sets F ⊂T or speciﬁcally over a sequence
F = Fn ↑T . By Lemma 12.31, since Tk < 1 < 2(β + 2)/(β + 1), we have
βγ(β, Tk) < T β
k and further
1
T β
k −βγ(β, Tk)
≤
1
β
β+1T β+1
k
−
β
2(β+2)T β+2
k
≤2(β + 1)
βT β+1
k
≤
4
T β+1
k
,
recalling that β ≥1 is assumed. Thus by (12.73) and (12.74),
ENk ≤e
∞
X
j=0
(
βγ(β, Tk)
T β
k
)j
=
eT β
k
T β
k −βγ(β, Tk)
≤4e
Tk
.

12.6
L´evy Processes
611
Still for k > k1, for some constant C,
T −1
k
= (2K)1/β2(k+3)γ/β ≤C2kγ/β.
Summing a geometric series, since p > γ/β, it follows that
X
k>k1
2−kpENk ≤4e
X
k>k1
2−kpT −1
k
≤4eC
X
k>k1
2−k(p−γ/β)
= 4eC 2−(k1+1)(p−γ/β)
1 −2−(p−γ/β) < ∞,
proving (12.72).
Now, for any k > k1, we have βγ(β, Tk) < T β
k , and so the right side of
(12.74) tends to 0 as j →∞. For u = 2−k−1 it follows that Pr({νu < ∞}) = 1.
For a ﬁxed k, e.g. k = k1 +1, we get for almost all ω that for any ﬁxed x0 ∈S,
supt∈T d(Yt(ω), x0) < ∞. Also, since 2−k−1 can be arbitrarily small, it follows
that Pr({νu < ∞}) = 1 for every u > 0, in particular for u = r0. It then
follows from (12.71) and (12.72) that vp(Y (·, ω); T ) < ∞almost surely.
Just as a function of bounded p-variation (or Φ-variation) from [0, 1] into
a Banach space must be regulated (Proposition 3.33), it follows that for some
A0 with Pr(A0) = 0, for all ω /∈A0, and every t ∈[0, 1), the right limit
Y (t+, ω) := lims↓t,s∈T Y (s, ω) exists in S (here we use completeness of S).
From the assumptions and deﬁnition of α, for each t ∈[0, 1), Y (s) = X(s) →
X(t) in probability as s ↓t with s ∈T . Thus X(t) = Y (t+) a.s. In particular,
Y (t) = Y (t+) a.s. for all t ∈T ∩[0, 1). Since T is countable, for some A1
with Pr(A1) = 0, we have Y (t, ω) = Y (t+, ω) for all t ∈T ∩[0, 1) and
ω /∈A1. Deﬁne Y (t, ω) = Y (t+, ω) for all t ∈[0, 1) and ω /∈A0 ∪A1, which
leaves Y (t, ω) unchanged for t ∈T . For a ﬁxed x0 ∈S let Y (t, ω) = x0 for
ω ∈A0 ∪A1 and all t ∈[0, 1]. Then Y (t, ω), 0 ≤t ≤1, is a Markov process
with Pr({ω: Y (t, ω) = Xt(ω)}) = 1 for each t. So, Y has the same kernel
P·,·(·, ·) as for X. Clearly the Y process has right-continuous trajectories on
[0, 1). Because of that, and because 1 ∈T , Y (·, ω) has the same p-variation
on [0, 1] as on T , which is ﬁnite. The proof of Theorem 12.27 is complete. 2
12.6
L´evy Processes
Inﬁnitely divisible laws and the L´evy–Khinchin formula
Recall that for two laws (probability measures) P and Q, deﬁned in this
section on the Borel sets of the real line, the convolution P ∗Q is deﬁned by
(P ∗Q)(A) =
R ∞
−∞P(A−x) dQ(x). Convolution is a commutative, associative
operation. For n = 1, 2, . . ., the nth convolution power of a law P is deﬁned
by P ∗n := (P ∗P ∗· · · ∗P) to n factors, with P ∗0 := δ0.

612
12 Stochastic Processes and Φ-Variation
A law P is said to be inﬁnitely divisible iﬀfor all n there is a law we call
P1/n such that P ∗n
1/n = P. Recall that the characteristic function of a law P is
deﬁned by fP (u) :=
R +∞
−∞eiux dP(x) for u ∈R. Then we recall the following
fact, called a L´evy–Khinchin formula (e.g. [23, Chapter 9], [64, §XVII.2]):
Theorem 12.33. A law P on R is inﬁnitely divisible if and only if its char-
acteristic function can be written in the form fP (u) ≡eη(u) where
η(u) := ηa,σ,L(u) := iau −σ2
2 u2 +
Z
R\{0}
 eiux −1 −iuh(x)

L(dx)
(12.75)
for u ∈R, where h(x) := x/(1 + x2), a and σ ≥0 are real numbers, and L is
a measure on R \ {0} such that R
R\{0}(1 ∧x2) L(dx) < ∞. Here the numbers
a and σ and the measure L are uniquely determined.
A measure µ on R or R \ {0} is called symmetric if it is preserved by
x 7→−x. We then have the following:
Corollary 12.34. An inﬁnitely divisible law P is symmetric if and only if in
the representation (12.75), a = 0 and L is symmetric. Then the integrand can
be replaced by its real part cos(ux) −1.
Proof. If P is symmetric, it is easily seen that its characteristic function fP
is real-valued and even, fP (−u) ≡fP (u). Since in (12.75), η(0) = 0, η, being
continuous by dominated convergence, must also be real-valued and even.
From (12.75) with −u in place of u and uniqueness of a and L we see that
a = 0 and L is symmetric. Then since the imaginary part of the integrand is
an odd function of x, its integral vanishes and η has the stated form.
Conversely, the given form implies that η and so fP are real-valued and
even, which by uniqueness of characteristic functions implies that P is sym-
metric.
2
The function h in Theorem 12.33 is far from uniquely determined. Its
essential properties are that it is bounded and Borel measurable on R and is
x + O(x2) as x →0. Diﬀerent choices of h satisfying these conditions can give
diﬀerent values of a. The choice of h given in the theorem as an odd function
is convenient, as in the proof of Corollary 12.34. Under the conditions of
Theorem 12.33, η is called a characteristic exponent and L a L´evy measure.
A family {Pt}t≥0 of laws on R will be called a convolution semigroup if
Ps ∗Pt = Ps+t for all s, t ≥0. A convolution semigroup {Pt} will be called
continuous iﬀas t ↓0, Pt →δ0 in the sense of weak convergence, in other
words,
R +∞
−∞f(x) dPt(x) →f(0) as t ↓0 for every bounded continuous real-
valued function f on R. The following fact will then be easy to prove, and the
one-to-one correspondence will show that the notation P1/n is unambiguous
for inﬁnitely divisible laws.

12.6
L´evy Processes
613
Theorem 12.35. There is a one-to-one correspondence between inﬁnitely di-
visible laws P on R and continuous convolution semigroups {Pt}t≥0 such that
P = P1.
Proof. Clearly, each law, speciﬁcally P1, in a convolution semigroup is in-
ﬁnitely divisible. Conversely, let P be inﬁnitely divisible. It is immediate that
if a L´evy measure L or characteristic exponent η is multiplied by a constant
c ≥0, then it remains a L´evy measure or characteristic exponent respectively.
Let η be the characteristic exponent of P. Then for each t ≥0, there exists a
law Pt with characteristic function etη(·), and by properties of characteristic
functions (e.g. [53, Theorems 9.4.3, 9.5.1, 9.8.2]), Pt for t ≥0 form a continu-
ous convolution semigroup, with P = P1. Let {Qt}t≥0 be another continuous
convolution semigroup with Q1 = P. For each n = 2, 3, . . . , the characteristic
exponent of Q1/n is η/n by the uniqueness of a, σ, and L in Theorem 12.33.
It follows that Qt = Pt for all rational t ≥0 and thus by continuity of both
semigroups for all t ≥0, ﬁnishing the proof.
2
Let X = {Xt}t≥0 be a real-valued stochastic process with independent
increments. Then the ﬁnite-dimensional joint distributions of the process, in
other words the distributions of {X(t)}t∈F for each ﬁnite set F, are uniquely
determined by those of the increments X(t) −X(s) for 0 ≤s < t. Thus the
process has stationary increments (the deﬁnition is recalled before (12.8)) if
and only if the distribution of X(t + s) −X(t) with t, s ≥0 does not depend
on t. If in addition X(0) ≡0, then the ﬁnite-dimensional joint distributions of
the process are uniquely determined by the distributions Pt of X(t) for each
t ≥0, which clearly form a convolution semigroup. If the process is continuous
in probability at 0, i.e. X(t) →0 in probability as t ↓0, then the convolution
semigroup is continuous at 0.
We then have the following fact:
Theorem 12.36. Let {Pt}t≥0 be any continuous convolution semigroup of
laws on R. Then there exists a stochastic process {Xt}t≥0 with stationary,
independent increments, with X(0) ≡0, where for any 0 ≤s < t, the distri-
bution of X(t) −X(s) is Pt−s. Moreover, the process can be chosen so that
almost all its sample functions are right continuous with left limits, and for
each ﬁxed t, the probability that X(·) is continuous at t is 1.
Proof. The existence of a process with the given properties except those in
the last sentence follows from the Kolmogorov consistency theorem, e.g. [53,
Theorem 12.1.2]. The last sentence follows e.g. from Kallenberg [112, Theorem
13.1].
2
A process X with the properties given in Theorem 12.36 is called a L´evy
process (cf. Itˆo [107, Section 1.3]). For a L´evy process X, the characteristic

614
12 Stochastic Processes and Φ-Variation
function of X(t) for each t is given by E exp{iuX(t)} = exp

tη(u)
	
for each
t ≥0 and u ∈R, where η is the characteristic exponent of the distribution of
X(1).
A L´evy process X has the Itˆo representation (cf. Itˆo [107, Section 1.7]),
for each t ≥0,
X(t) = at + σB(t)
(12.76)
+ lim
ǫ↓0
h X n
∆−X(s): s ≤t, |∆−X(s)| > ǫ
o
−t
Z
|x|>ǫ
h(x) L(dx)
i
,
where B is a Brownian motion independent of X −σB.
It is well known that sample functions of a L´evy process X with the char-
acteristic exponent (12.75) are of bounded variation if and only if σ = 0 and
Z
R\{0}
(1 ∧|x|) L(dx) < ∞
(12.77)
(cf. e.g. Gihman and Skorohod [78, Theorem 3, p. 279]). The following result
of Bretagnolle [24, Th´eor`eme III b] is less well known. It sharpened an earlier
result of Blumenthal and Getoor [19] and Monroe [172].
Theorem 12.37 (J. Bretagnolle). Let 1 < p < 2 and let X = {Xt}t≥0 be
a mean-zero L´evy process with the characteristic exponent (12.75) such that
σ = 0. Then vp(X; [0, 1]) < ∞with probability 1 if and only if
Z
R\{0}
(1 ∧|x|p) L(dx) < ∞.
(12.78)
If (12.78) fails then vp(X; [0, 1]) = +∞almost surely.
The theorem is used in Remark 12.39 to show that the main result in the
preceding section (Theorem 12.27) is sharp.
Remark 12.38. Suppose a L´evy process X is symmetric in the sense that
the process −X is the same in distribution, or equivalently that in the cor-
responding convolution semigroup {Pt}t≥0 given by Theorem 12.36 and the
discussion before it, each Pt, or equivalently P1, is symmetric. Then by Corol-
lary 12.34, in (12.75) and (12.76), a = 0 and L is symmetric. Thus the integral
in (12.76) is 0 for all ǫ > 0. If in addition as in the preceding Theorem 12.37,
σ = 0, then the Itˆo representation (12.76) reduces to
X(t) = lim
ǫ↓0
X n
∆−X(s): s ≤t, |∆−X(s)| > ǫ
o
for each t ≥0. Thus the process is determined entirely by its jumps, although
if the integral in (12.77) diverges, these will not be absolutely summable. On
a ﬁnite, nondegenerate interval, the jumps will sum up in a nontrivial way.

12.7
Empirical Processes
615
α-stable L´evy motion
A L´evy process X is an α-stable L´evy motion with α ∈(0, 2) if in its char-
acteristic exponent (12.75), σ = 0 and the L´evy measure L has the form
L = Lα = Lα,r,q, where
Lα,r,q(dx) :=
rx−1−αdx
if x > 0,
q(−x)−1−αdx if x < 0,
for r, q ≥0 with r + q > 0. It is easy to see that (12.78) with L = Lα holds
if and only if p > α. Therefore vp(X; [0, 1]) < ∞with probability 1 for each
p > α.
An α-stable L´evy motion X is called symmetric if in (12.75) also a = 0
and r = q. In that case, taking X0 ≡0, the distribution of X1 is a symmetric
α-stable law, i.e. one whose characteristic function eη for η given by (12.75)
has a = σ = 0 and L´evy measure L = Lα,r,r for some r > 0. Symmetry of the
law of X1 implies a = 0 and q = r by Corollary 12.34. It is well known, e.g.
[204, p. 86, Theorem 14.15], that in this case for η in (12.75), η(u) ≡c|u|α
for some c > 0. Moreover, for 0 < s < t, the distribution of Xt −Xs, also
conditional on any value of Xs, equals that of (t −s)1/αX1 by equality of
characteristic functions (e.g. [53, Theorem 9.5.1]).
Remark 12.39. It will be shown that for a symmetric α-stable process with
0 < α < 2, Theorem 12.27 of Manstaviˇcius is sharp in that p > γ/β cannot
be replaced by p ≥γ/β. Given α, there is a b with 0 < b < ∞such that as
x →+∞, xα Pr(X1 > x) →b, e.g. [203, p. 16, Property 1.2.15]. Thus for some
x0 with 0 < x0 < ∞we have Pr(X1 > x) ≤2bx−α for all x ≥x0. Clearly
Pr(X1 > x) ≤(x0/x)α for 0 < x ≤x0. Since X1 is symmetric, it follows that
for some K < ∞, Pr(|X1| > x) ≤K/xα for all x > 0. It follows for any h > 0,
a > 0, and t ≥0 that
Pr(|Xt+h −Xt| > a) = Pr(|X1| > ah−1/α) ≤Kh/aα,
also conditional on any value of Xt. Thus, the condition (12.56) holds with
β = 1 and γ = α and so γ/β = α. Since the process for given α does not have
bounded p-variation for p = α, this shows that the assumption p > γ/β in
Theorem 12.27 is sharp. Moreover, for this, according to Manstaviˇcius [155],
one does not need the full strength of Bretagnolle’s theorem as quoted above;
the earlier results of Blumenthal and Getoor [19] suﬃce.
12.7
Empirical Processes
Let P be a probability distribution on R with distribution function F: F(x) :=
P((−∞, x]) for all x. Then F is nondecreasing and right-continuous. For 0 <

616
12 Stochastic Processes and Φ-Variation
y < 1 let F ←(y) := inf{x : F(x) ≥y}. Then the quantile function F ←is
nondecreasing and left-continuous from (0, 1) into R.
Let X1, X2, . . . , Xn be independent with law P and let Fn be the empirical
distribution function Fn(t) := n−1 Pn
j=1 1{Xj≤t} for t ∈R. Let U be the
U[0, 1] distribution function U(t) := max(0, min(1, t)) for t ∈R, and Un an
empirical distribution function for it. Clearly U◦F ≡F, and we can take
Fn ≡Un◦F [53, Lemma 11.4.3]. Then letting βn := n1/2(Un −U) on [0, 1],
αn := n1/2(Fn −F) = βn◦F
(12.79)
is the classical empirical process.
For any distribution function F and function h on [0, 1] it follows from the
deﬁnition of p-variation that
∥h◦F∥[p] ≤∥h∥[p].
(12.80)
Here, equality holds if F is continuous and h is right-continuous at 0 and
left-continuous at 1. Almost surely Un is continuous at 0 and at 1. Then for
F continuous, by (12.79), the p-variation of αn on R equals that of βn. In
studying the p-variation norm of αn for F continuous we can thus assume
F ≡U and αn = βn. Another simpliﬁcation comes from the fact that for a
function f : [0, 1] →R which is 0 at the endpoints of [0, 1], as βn is, we have
for 1 ≤p < ∞,
∥f∥sup ≤∥f∥(p)
and so
∥f∥[p] ≤2∥f∥(p).
(12.81)
Qian [189, Theorems 3.2 and 4.2] proved the following:
Theorem 12.40 (J. Qian). Let 1 ≤p < 2. Then there are constants Mp, λp <
∞, depending only on p, such that
Evp(αn) ≤Mpn1−p/2
and
lim sup
n→∞vp(αn)/n1−p/2 ≤λp
almost surely.
Conversely, if F is continuous, the Xi are almost surely distinct, so we
have vp(αn) ≥n1−p/2, and the above theorem is sharp up to the constants
Mp and λp.
For p = 2 we have the following:
Theorem 12.41. Let F be a distribution function on R.
(a) v2(αn) = OPr(log log n) as n →∞.
(b) If F is continuous and 0 < c < 1/12, then Pr({v2(αn) > c log log n}) →1
as n →∞.

12.7
Empirical Processes
617
Proof. (a): By (12.80) with h = βn we can assume that F is continuous. For a
given n let f := αn. For a partition κ = {ti}m
i=0 of R let ∆i := f(ti)−f(ti−1),
i = 1, . . . , m. We can assume that m ≥2 and
inf{t ∈R: F(t) > 0} < t1 ≤tm−1 < sup{t ∈R: F(t) < 1}.
To maximize the 2-variation sums s2(f; κ) = Pm
i=1 ∆2
i while using only ele-
ments of κ we can assume that all ∆i ̸= 0 and that the ∆i are alternating in
sign, since (A + B)2 > A2 + B2 for AB > 0, so any adjoining diﬀerences of
the same sign should be combined. Moreover, if at any stage of the following
proof, points are adjoined to or deleted from κ, giving a new partition κ′ such
that s2(f; κ′) ≥s2(f; κ), and if κ′ gives any ∆i = 0, or any adjoining ∆i of
the same sign, points can be deleted from κ′ until we get a partition κ′′ with
no ∆i = 0, all ∆i alternating in sign, and s2(f; κ′′) ≥s2(f; κ′) ≥s2(f; κ).
Claim 1: while only increasing m by at most 3, we can always assume that
∆1 < 0.
To prove the claim, if F(t0) = 0 then for X(1), the smallest Xj, we have
X(1) > t0 and F(X(1)) > 0 (with probability 1) and if ∆1 ≥0, then X(1) ≤t1
and we can enlarge s2(f; κ) by inserting a new point just to the left of X(1),
giving a new ∆′
1 < 0 as desired and ∆′
2 > ∆1.
If F(t0) > 0 and X(1) ≥t0 then we can enlarge s2(f; κ) by adjoining two
new points t−2 < t−1 < t0 with F(t−2) < F(t−1) and so again ∆′
1 < 0. So we
can assume X(1) < t0 but then we adjoin three points, t−1 = X(1), t−2 just
to the left of X(1), and t−3 < t−2 where F(t−3) < F(t−2). In this last case we
again get a ∆′
1 < 0, proving Claim 1.
Claim 2: In s2(f; κ) we can assume, adjoining at most one point to the
partition κ, that
(1) ∆i > 2/(3n1/2) whenever ∆i > 0, and
(2) if ∆i < 0, then either i = 1 or m or |∆i| ≥1/(3n1/2).
For (1) let ∆i > 0, so i ≥2 by Claim 1. There is at least one Xj (in the
sample on which Fn is based) with ti−1 < Xj ≤ti. For the largest such Xj,
we can take ti = Xj since this can only enlarge both ∆i and |∆i+1| (or a new
|∆m+1| if i = m). Likewise, we can let ti−1 increase toward (but not quite
equal) some Xk ≤Xj. If Xk = Xj then (1) holds. Otherwise Xk < Xj and
if ∆i ≤2/(3n1/2) we can move ti−1 to a point just less than Xj. This will
increase both |∆i−1| and ∆i and make ∆i > 2/(3n1/2), so (1) is proved.
For (2) let ∆i < 0 and i ≥2. By Claim 1, we can assume ∆1 < 0 and
therefore ∆2 > 0. Thus in fact i ≥3 and X(1) ≤t2. The sum s2(f; κ) is not
decreased if we let ti−1 decrease until ti−1 = Xj for some j. (If the largest Xj <
ti−1 also satisﬁes Xj ≤ti−2 then ∆i−1 < 0, contradicting the alternation in
sign.) If i < m, we can also let ti increase nearly up to another observation Xk.
Suppose (2) fails for ∆i and there is another r with Xj < Xr < Xk. Then by
inserting new division points at Xr and just below it, say at y, we can enlarge
the 2-variation sum, as follows. Let A := f(y) −f(ti−1), B := f(Xr) −f(y),

618
12 Stochastic Processes and Φ-Variation
and C := f(ti) −f(Xr). Then by assumption ∆2
i = (A + B + C)2 ≤1/(9n),
whereas A2 + B2 + C2 ≥B2 which is as close as we want to 1/n and so is
larger. If the partition κ′ resulting from the proof so far has any ∆i = 0 or
any ∆i∆i+1 > 0, points can be deleted from κ′ until we have a partition κ′′
where ∆i alternate in sign and s2(f; κ′′) ≥s2(f; κ′) ≥s2(f; κ). Then (1) is
preserved. Iterating, we can assume that there is no such r. By (1), we have
A := ∆i−1 > 2/(3n1/2) and B := ∆i+1 > 2/(3n1/2), while 0 < C := −∆i <
1/(3n1/2). Since C < (1/2) min{A, B} and A + B ≤2 max{A, B} it follows
that AB > C(A + B) and so
(f(ti+1) −f(ti−2))2 = (A + B −C)2 > A2 + B2 + C2.
Therefore the 2-variation sum is increased by deleting ti−1 and ti. Since A +
B −C > 2/(3n1/2) > 0, again (1) is preserved, and, iterating, (2) is proved.
For Φ := Φ1/2 deﬁned before (12.27) we have Φ(u) = u2/(2 log log(1/u))
if 0 < u ≤δ for some 0 < δ < e−e and Φ is linear on [δ, ∞). Since |∆i| ≥
1/(3n1/2) for i = 1, . . . , m except possibly for i = 1, m, there is a ﬁnite
constant K such that
s2(f; κ) ≤K

vΦ(f) log log n + ∥f∥supvΦ(f) + 1/n

.
Dudley [50, §5] proved that vΦ(αn) is bounded in probability. It is well known
that ∥αn∥sup is bounded in probability (in connection with Kolmogorov–
Smirnov statistics and Dvoretzky–Kiefer–Wolfowitz inequalities, e.g. Massart
[160]). Conclusion (a) then follows.
Qian [189, Theorem 3.1] proved (b).
2
We do not know at this writing whether the bound in Theorem 12.41(a)
holds almost surely.
Let B◦= {B◦
t }0≤t≤1 be the Brownian bridge process, a Gaussian stochas-
tic process with mean 0 and EB◦(t)B◦(s) = t(1 −s) for 0 ≤t ≤s ≤1,
and such that t 7→B◦(t, ω) is continuous for almost all ω. We can write
B◦(t) = B(t) −tB(1) for 0 ≤t ≤1 where B(·) is a Brownian motion since
this gives the correct mean 0 and covariances. Thus, as for Brownian motion
(12.11), almost surely
vp(B◦(·, ω); [0, 1])
< +∞if p > 2,
= +∞if p ≤2.
(12.82)
For 1 ≤p < ∞and y ≥0, let
φp(y) := (ey/p)p10≤y<p + ey1y≥p.
(12.83)
The left and right limits and derivatives of φp at y = p all equal ep, and so φp
is a C1 function. Also, φp is strictly increasing and convex from [0, ∞) onto
itself, that is, φp ∈CV. Let ∥· ∥φp be the corresponding Luxemburg norm on
the Orlicz space Lφp = Lφp(Ω, F, Pr; R) as deﬁned in (1.24). The following
fact, to be proved, is from Huang and Dudley [103].

12.7
Empirical Processes
619
Theorem 12.42. For 2 < p < ∞there is a ﬁnite constant A(p) such that
if F is any probability distribution function on R, then on some probability
space there exist independent random variables X1, X2, . . . with distribution
function F and Brownian bridges B◦
n such that for all n, if Fn is the empirical
d.f. based on X1, . . . , Xn, then
 n1/2(Fn −F) −B◦
n◦F

[p]

φp ≤A(p)n
1
p −1
2 .
(12.84)
The bound (12.84) in Lφp-norm is sharp since the bound in L1-norm it
implies is sharp according to the following corollary (the ﬁrst result in this
section to be proved; see the Notes):
Corollary 12.43 (Y.-C. Huang). For 2 < p < ∞and B◦
n, Fn, and F as in
Theorem 12.42, there is a ﬁnite constant C(p) such that
E
n1/2(Fn −F) −B◦
n◦F

[p] ≤C(p)n
1
p −1
2 .
(12.85)
If F is continuous, then for V
= B◦
n◦F or any other sample-continuous
stochastic process V ,
n1/2(Fn −F) −V

(p) ≥n
1
p −1
2
almost surely.
(12.86)
Proof. (12.85) follows from (12.84) once we show that for any nonnegative
random variable Y and 1 < p < ∞,
EY ≤(1 + p/e)∥Y ∥φp.
(12.87)
By homogeneity we can assume that ∥Y ∥φp = 1. Thus by Fatou’s lemma,
it follows that Eφp(Y ) ≤1. Then by H¨older’s inequality and the deﬁnition
(12.83) of φp,
EY 1{Y <p} ≤
 EY p1{Y <p}
1/p ≤p/e.
This together with the bound EY 1{Y ≥p} ≤1 yields (12.87). Thus (12.85)
holds by (12.84).
For the lower bound (12.86), since F is continuous, the random variables
X1, X2, . . . are almost surely distinct, so the function n1/2(Fn −F) has n
distinct jumps of height n−1/2, and (12.86) follows.
2
Now we will prove Theorem 12.42. First, by (12.79) and (12.80), we can
and do assume that F is the U[0, 1] distribution function U. Next, for any
f : [0, 1] →R and integer r ≥0, we deﬁne a piecewise linear interpolation
[f]r to be the function equal to f at k/2r+1 for k = 0, 1, . . . , 2r+1 and linear
in between. If f(0) = f(1) = 0, as holds for f = βn or B◦
n, then [f]r can be
written as a sum as follows. For j = 0, 1, . . . , and k = 1, . . . , 2j, let Tj,k be the
“triangle function” such that Tj,k = 0 outside the interval ((k −1)/2j, k/2j),

620
12 Stochastic Processes and Φ-Variation
Tj,k = 1 at the midpoint (2k −1)/2j+1, and Tj,k is linear in between. For each
j and k, let
fj,k := Wj,k(f) := f((2k −1)/2j+1) −1
2[f((k −1)/2j) + f(k/2j)].
(12.88)
Then for r = 0, 1, . . . , we have
[f]r =
r
X
j=0
2j
X
k=1
fj,kTj,k.
(12.89)
Using the piecewise linear interpolations [βn]r and [B◦
n]r of βn and B◦
n, we
bound ∥βn −B◦
n∥(p) above by
∥βn −[βn]r∥(p) + ∥[βn]r −[B◦
n]r∥(p) + ∥[B◦
n]r −B◦
n∥(p).
(12.90)
The goal is to ﬁnd a good bound for the Luxemburg norm ∥· ∥φp of each
term in (12.90). We will ﬁx an integer r at ﬁrst; then an appropriate r will be
chosen to have a good total bound.
We can bound the function φp deﬁned by (12.83) as follows:
Lemma 12.44. For each p with 1 < p < ∞, there is a ﬁnite constant Cp
such that for all y ≥0,
φp(y) ≤exp(Cpy) −1.
(12.91)
Proof. For y ≥p, since 1 ≤ey, (12.91) holds if ey ≤exp(Cpy)/2, which
in turn holds if Cp ≥1 + (log 2)/p. For 0 ≤y < p, since ex ≥1 + x for
any x, (12.91) holds if κpyp ≤Cpy with κp := (e/p)p. Since y 7→yp is
convex, the latter bound holds if it holds for y = p. So we can set Cp :=
max{κppp−1, 1 + (log 2)/p}.
2
It will be useful to consider another Luxemburg norm closely related to
∥·∥φp. For 1 < p < ∞and y ≥0, let ψp(y) := φp(y1/p). Then ψp is also C1 for
y > 0. We have ψp(y) = κpy for 0 ≤y ≤yp, where κp = (e/p)p and yp = pp.
For y > yp, ψp(y) = exp{y1/p} and one can check that ψ′′
p(y) > 0. Thus ψp is
convex and so is in the class CV.
It is easily seen that for a random variable Y , Y ∈Lφp if and only if
|Y |p ∈Lψp, with
∥Y ∥p
φp = ∥|Y |p∥ψp.
(12.92)
In particular, for any stochastic process X such that vp(X) is measurable,
 ∥X∥(p)

φp =
vp(X)
1/p
ψp .
(12.93)
Lemma 12.45. For each p with 1 < p < ∞, there is a ﬁnite constant Kp
such that whenever Y has a binomial b(n, q) distribution with nq ≥1, we have
∥Y p∥ψp ≤Kp(nq)p.

12.7
Empirical Processes
621
Proof. By (12.92), it is enough to show that Eφp(Y/(K1/p
p
nq)) ≤1. Let Kp :=
(3Cp)p with Cp from Lemma 12.44. Then by (12.91), it is enough to show that
E exp(Y/(3nq)) ≤2. We have EeuY = (qeu + 1 −q)n and 1 + x ≤ex ≤1 + 2x
for 0 ≤x ≤1. Thus E exp(Y/(3nq)) ≤(1 + 2/(3n))n ≤e2/3 < 2, as desired.
2
Lemma 12.46. Let {B◦
t }0≤t≤1 be a Brownian bridge. For 0 ≤u < v ≤1
and t ∈[0, 1], let
M(t; [u, v]) := (v−u)−1/2
B◦(tv+(1−t)u)−tB◦(v)−(1−t)B◦(u)

. (12.94)
Then {M(t; [u, v])}0≤t≤1 is a Brownian bridge. Also, the variable Wj,k(B◦)
has a N(0, 2−j−2) distribution for all j and k for which (12.88) is deﬁned.
The variables Wj,k(B◦) are all jointly independent.
Proof. Let Z be a standard normal random variable independent of the pro-
cess B◦. Then B(t) := B◦(t) + Zt, 0 ≤t ≤1, gives a Brownian motion on
[0, 1]. Moreover, Wj,k(B◦) = Wj,k(B) by deﬁnition (12.88). It is then easy to
check that this has distribution N(0, 2−j−2). For t ∈[0, 1], letting
W(t) := (v −u)−1/2
B(tv + (1 −t)u) −B(u)

,
it then follows that M(t; [u, v]) = W(t) −tW(1). Again, it is easy to check
by covariances that {Wt}0≤t≤1 is a Brownian motion, and so the ﬁrst part of
the conclusion follows. The independence of the Wj,k(B◦) follows from zero
covariances of Wj,k(B).
2
Lemma 12.47. For any p ∈(2, ∞) and Brownian bridge B◦, there exists a
ﬁnite constant CB(p) such that for r = 1, 2, . . . ,
 ∥B◦−[B◦]r−1∥(p)

φp ≤CB(p)(2r)−(p−2)/(2p).
(12.95)
Proof. Since B◦−[B◦]r−1 is equal to 0 at k/2r for k = 0, 1, . . . , 2r, by Propo-
sition 3.37, we have
vp(B◦−[B◦]r−1; [0, 1]) ≤2p−1
2r
X
k=1
vp(B◦−[B◦]r−1; Jr,k),
(12.96)
where Jr,k := [(k −1)/2r, k/2r]. Using the notation (12.94) and Mr,k :=
M(·; Jr,k), for k = 1, . . . , 2r and t ∈Jr,k, we have (B◦−[B◦]r−1)(t) =
(2r)−1/2Mr,k(st) with st := t2r −k+1 ∈[0, 1]. To see this in more detail, note
that t 7→st is the unique linear, increasing map from Jr,k onto [0, 1]. For any
u < v, s 7→u+s(v−u) = (1−s)u+sv is the unique increasing linear map from
[0, 1] onto [u, v]. Thus for [u, v] = Jr,k, these maps must be inverses of each

622
12 Stochastic Processes and Φ-Variation
other. So for t ∈Jr,k, we have 2−r/2Mr,k(st) = B◦(t)−stB◦(v)−(1−st)B◦(u).
Moreover, for t ∈Jr,k, t 7→stB◦(v)+(1−st)B◦(u) is a linear random function
equal to B◦at the endpoints; thus it equals [B◦]r−1 on Jr,k as stated. So,
vp(B◦−[B◦]r−1; Jr,k) = (2r)−(p−2)/2 1
2r vp(Mr,k; [0, 1]).
By Lemma 12.46, Mr,k is a Brownian bridge and vp(B◦; [0, 1]) < ∞a.s.
by (12.82). Using (12.93), the Landau–Shepp–Marcus–Fernique theorem (e.g.
Lemma 2.2.5 in [52]) and Lemma 12.44, we have that ∥vp(B◦; [0, 1])∥ψp =
∥∥B◦∥(p)∥p
φp < ∞. Thus by (12.96), it follows that
vp(B◦−[B◦]r−1; [0, 1])

ψp ≤2p−1(2r)−(p−2)/2∥∥B◦∥(p)∥p
φp.
Applying (12.93) to the left side of the preceding inequality, (12.95) follows
with CB(p) = 21−1/p∥∥B◦∥(p)∥φp.
2
Next we bound the Luxemburg norm ∥· ∥φp of the ﬁrst term in (12.90).
Lemma 12.48. For any p ∈(2, ∞), there exists a ﬁnite constant Cβ(p) such
that for r = 1, 2, . . . and n ≥2r,
 ∥βn −[βn]r−1∥(p)

φp ≤Cβ(p)n1/2(2r)−(1−1/p).
(12.97)
Proof. Let n, r be a pair of positive integers with n/2r ≥1. As in the pre-
ceding proof, since βn −[βn]r−1 is equal to 0 at k/2r for k = 0, 1, . . . , 2r, by
Proposition 3.37 again, we have
vp(βn −[βn]r−1; [0, 1]) ≤2p−1
2r
X
k=1
vp(βn −[βn]r−1; Jr,k),
where Jr,k = [(k −1)/2r, k/2r]. Note that the map f 7→[f]r−1 is linear and
that [U]r−1 equals the U[0, 1] distribution function U. Thus βn −[βn]r−1 ≡
√n(Un −[Un]r−1). For k = 1, . . . , 2r, let Yr,k be the number of values of
j = 1, . . . , n such that Xj ∈((k −1)/2r, k/2r]. Then Yr,k almost surely equals
the number of i = 1, . . . , n with Xi in the closure Jr,k. By convexity of y 7→yp,
y ≥0, and then, since vp(H) = (sup H −inf H)p for any monotone function
H, we have
vp(βn −[βn]r−1; Jr,k) ≤2p−1n−p/2 [vp(nUn; Jr,k) + vp([nUn]r−1; Jr,k)]
≤2pn−p/2Y p
r,k.
Since Yr,k has a binomial b(n, 1/2r) distribution for each k, by Lemma 12.45,
it follows that

12.7
Empirical Processes
623
∥vp(βn −[βn]r−1; [0, 1])∥ψp ≤4pn−p/2
2r
X
k=1
∥Y p
r,k∥ψp ≤4pKpnp/22−r(p−1).
Then (12.97) with Cβ(p) = 4K1/p
p
follows from (12.93).
2
To bound the middle term in (12.90), the Koml´os, Major, and Tusn´ady
construction will be used to link empirical processes and Brownian bridges.
For N = 0, 1, . . . and k = 0, 1, . . . , N, let PN,1/2(k) =
 N
k

2−N, the binomial
b(N, 1/2) distribution. Let F(N) be its distribution function. For its quantile
function let H(t|N) := F ←
(N)(t) from (0, 1) onto {0, 1, . . ., N}. Let Φ be the
standard normal distribution function, Φ(x) := R x
−∞exp(−u2/2)du. Given a
positive integer n and a Brownian bridge B◦
n, random variables Y ∗
j,k, j =
0, 1, . . . , k = 1, . . . , 2j will be constructed iteratively as follows. Let Y ∗
0,1 := n.
Next, let Y ∗
1,1 := H(Φ(2W0,1(B◦
n))|Y ∗
0,1) and Y ∗
1,2 := Y ∗
0,1 −Y ∗
1,1. Then, given
Y ∗
j−1,k, for j ≥2, for each k = 1, . . . , 2j−1, let
Y ∗
j,2k−1 := H
 Φ
 2(j+1)/2Wj−1,k(B◦
n)
Y ∗
j−1,k

(12.98)
and Y ∗
j,2k := Y ∗
j−1,k −Y ∗
j,2k−1. By Lemma 12.46, each 2(j+1)/2Wj−1,k(B◦
n) has
law N(0, 1), and so Φ of it has law U[0, 1]. In fact, if Y is any random variable
having a continuous distribution function F, then F(Y ) has law U[0, 1], since
for 0 < t < 1,
P(F(Y ) ≥t) = P(Y ≥F ←(t)) = 1 −F(F ←(t)) = 1 −t
by continuity. For Φ, simply Φ←= Φ−1. Therefore each Y ∗
j,2k−1 has the bino-
mial law b(Y ∗
j−1,k, 1/2), given Y ∗
j−1,k, e.g. by [53, Proposition 9.1.2]. By inter-
preting Y ∗
j,k as the number of points in the interval Ij,k := ((k −1)/2j, k/2j]
for each j and k, and letting j →∞, the Y ∗
j,k deﬁne n points in the interval
(0, 1), so that intervals Ij,k containing the points have Y ∗
j,k = 1 for j large
enough. Let these n points be the ordered sample X∗
(1), X∗
(2), . . . , X∗
(n) and
deﬁne X∗
1, X∗
2, . . . , X∗
n by a random permutation π of {1, . . . , n}, independent
of X∗
(·):
X∗
i := X∗
(π(i)), i = 1, 2, . . ., n. Let X1, . . . , Xn be a sample of inde-
pendent uniform (0, 1) random variables and Yj,k the number of Xi in Ij,k. To
show that Yj,k and the Y ∗
j,k have the same joint distribution, note that the Y ∗
j,k
are obtained by starting with n points in the interval (0, 1] and successively
bisecting intervals, where if an interval Ij,k has Y ∗
j,k points, the number of
points in the left half Ij+1,2k−1 is binomial b(Y ∗
j,k, 1/2) given Y ∗
j,k. Because the
variables Wj,k(B◦
n) are all jointly independent (by Lemma 12.46), the array of
random variables {Y ∗
j,k} has the same joint distribution as {Yj,k}, namely the
distribution of the increments of Un over the intervals Ij,k. So X∗
1, X∗
2, . . . , X∗
n
are indeed i.i.d. with uniform (0, 1) distribution. By virtue of this fact, we will
drop the superscript ∗from now on and treat Y ∗
j,k and Yj,k, and thus X∗
i and
Xi, as the same.

624
12 Stochastic Processes and Φ-Variation
In sum, the so-called KMT construction deﬁnes a joint distribution of a
Brownian bridge B◦
n and empirical process βn = n1/2(Un −U) as follows.
Begin with B◦
n, which has continuous sample functions, and for it, extend
(12.89) to
B◦
n =
∞
X
j=0
2j
X
k=1
Wj,k(B◦
n)Tj,k,
which by piecewise linear interpolation clearly converges uniformly on [0, 1].
Next let Un(0) := 0 and Un(1) := 1. Apply (12.98) repeatedly to get
Un(1/2) := Y ∗
1,1/n,
Un(1/4) := Y ∗
2,1/n,
(12.99)
Un(3/4) := Un(1/2) + Y ∗
2,3/n,
and so on. Then Un(k/2j) for j = 0, 1, . . . , k = 0, 1, . . . , 2j, have their correct
joint distribution, and Un(t) for 0 ≤t ≤1 is then deﬁned by monotonicity
and right-continuity.
We note that Theorem 8.1 of Major [154] implies that if Z has law N(0, 1),
then Y = H(Φ(Z)|m) minimizes E(|m−1/2(2Y −m) −Z|p) for 1 ≤p < ∞
among all Y with law b(m, 1/2). This motivates the choice (12.98).
To prove Theorem 12.42, we need to deﬁne a distribution of {(βn, B◦
n)}∞
n=1,
although the joint distribution for diﬀerent n has no eﬀect on (12.84). One
way is as follows. Let X1, X2, . . . be independent and identically distributed
random variables with uniform law U[0, 1] and deﬁne βn from X1, . . . , Xn as
usual. For each n, let ((X1, X2, . . . , Xn), B◦
n) have the KMT joint distribution
as just deﬁned. Let ξ := {Xi}∞
i=1. Then for each n, since C[0, 1] is a complete
separable metric space, B◦
n has a conditional distribution µn(·|ξ) given ξ,
where for each ξ, µn(·|ξ) is a probability measure on the Borel σ-algebra of
C[0, 1] [53, Theorem 10.2.2]. It depends on ξ only through {Xi}n
i=1. Moreover,
for each Borel set A ⊂C[0, 1], µn(A|ξ) is a measurable function of {Xi}n
i=1.
Let Cn be a copy of C[0, 1] on which µn is deﬁned. On the countable Cartesian
product C[0, 1]∞:= Π∞
n=1Cn, we can form the product probability measure
µ(·|ξ) := Π∞
n=1µn(·|ξ) for any ﬁxed ξ, e.g. [53, Theorem 8.2.2]. For any Borel
sets Aj ⊂Cj, j = 1, . . . , n, n = 1, 2, . . ., Πn
j=1µj(Aj|ξ) is clearly a measurable
function of ξ. It follows by monotone convergence as in the proofs of [53,
Theorems 4.4.4, 8.2.2] that ξ 7→µ(E|ξ) is measurable for any measurable set
E ⊂C[0, 1]∞for the product σ-algebra. Let U be the uniform probability
measure on the Borel sets of [0, 1] whose distribution function is U. We have
also the product measure U∞= Π∞
i=1Ui of copies Ui of U on the inﬁnite-
dimensional cube I∞
:=
Π∞
i=1[0, 1]i of possible values of ξ. Thus, for any
measurable A ⊂I∞we can deﬁne a joint distribution for {B◦
n}∞
n=1 and ξ =
{Xi}∞
i=1 for which
Pr(ξ ∈A, {B◦
n}∞
n=1 ∈E) =
Z
A
µ(E|ξ)dU∞(ξ)

12.7
Empirical Processes
625
for any measurable sets A and E as described. The joint distribution then
extends from rectangles A×E to general product measurable subsets of I∞×
C[0, 1]∞by the usual extension for measures on a product space. The B◦
n are
conditionally independent given {Xi}∞
i=1.
Recall that for each n, (βn, B◦
n) have the joint distribution given by the
KMT construction. For the middle term in (12.90), by (12.89), we obtain the
representation
[βn]r −[B◦
n]r =
r
X
j=0
2j
X
k=1

Wj,k(βn −B◦
n)

Tj,k
(12.100)
for r = 1, 2 . . .. For 1 ≤p < ∞and each j, by Proposition 3.37, since
vp(Tj,k) = 2, we have
vp
 2j
X
k=1

Wj,k(βn −B◦
n)

Tj,k

ψp
≤2p
2j
X
k=1

Wj,k(βn −B◦
n)

p
ψp
. (12.101)
Let Z be a standard normal random variable. Let γ(Z, N) := F ←
(N)(Φ(Z)) −
N/2. To bound the right side of (12.100), we use a lemma of Tusn´ady whose
ﬁrst published proof was given as far as we know by Bretagnolle and Massart
[25], Lemma 4: (almost surely)
γ(Z, N) −
√
N
2 Z
 ≤1 + Z2/8.
(12.102)
Letting N := Y ∗
j−1,k and Z := Zj,k := 2(j+1)/2Wj−1,k(B◦
n), by (12.88), (12.99),
and (12.98), it follows that
Wj−1,k(βn) ≡√nWj−1,k(Un) ≡
1
√n

Y ∗
j,2k−1 −
Y ∗
j−1,k
2

≡γ(Z, N)/√n.
Since EN = n/2j−1, by (12.102), and then using the inequality 2ab ≤a2 +b2,
we have the bound
√n
Wj−1,k(βn −B◦
n)
 =
γ(Z, N) −
√
EN
2
Z

≤1 + 3
8Z2 + 1
4|
√
N −
√
EN|2.
For a standard normal variable Z such as Zj,k, ∥|Z|2p∥ψp is a ﬁnite constant
depending on p. Therefore using the inequality (a+b+c)p ≤3p−1(ap+bp+cp),
we get ﬁnite constants Ap, Bp such that
np/2
Wj−1,k(βn −B◦
n)
p
ψp ≤Ap + Bp

√
N −
√
EN
2p
ψp.
(12.103)
Since for 1 < p < ∞and y ≥0, ψp(y) = φp(y1/p), by Lemma 12.44, there is
a ﬁnite constant Cp such that for each t > 0,

626
12 Stochastic Processes and Φ-Variation
Eψp
√
N −
√
EN
2p/t

≤E exp
n
Cp
 √
N −
√
EN
2/t1/po
−1.
For each s > 0, let ηN(s) := E exp

s(
√
N −
√
EN)2	
. If ηN(Cp/t1/p) ≤2,
then we can bound the Luxemburg norm by
∥|
√
N −
√
EN|2p∥ψp ≤t.
(12.104)
The following will be used to bound such t:
Lemma 12.49. For any binomial b(n, q) random variable N and s ∈(0, 1/2),
ηN(s) ≤es/√1 −2s.
Proof. Since E
√
N ≤
√
EN, we have
(
√
N −
√
EN)2 ≤(
√
N −E
√
N)2 + EN −(E
√
N)2.
(12.105)
By H¨older’s inequality (Efg)3 ≤(Ef 3/2)2Eg3 for f = N 1/3 ∈L3/2 and
g = N 2/3 ∈L3. It follows that −(E
√
N)2 ≤−(EN)3/E(N 2). Next, since
[E(N 2) −(EN)2]2 ≥0, we have the bound
EN −(E
√
N)2 ≤EN −(EN)3/E(N 2) ≤Var(N)/EN = 1 −q ≤1.
Thus if N ′ and N are independent and identically distributed random vari-
ables, then E
√
N ′ = E
√
N and
ηN(s) ≤esE exp
n
s
 √
N −E
√
N
2o
≤esE exp
n
s
 √
N −
√
N ′2o
by (12.105) and Jensen’s inequality, taking expectations with respect to
√
N ′
for each ﬁxed N. Let U := N + N ′ and V := N −N ′. Then
 √
N −
√
N ′2 ≡U
 1 −
p
1 −(V/U)2
≤V 2/U
as is easily checked. Now write V = N −N ′ = Pn
i=1 ξi, where ξi = ρi −ρ′
i and
ρi, ρ′
i, i = 1, . . . , n are independent and identically distributed Bernoulli (q)
random variables (i.e., Pr(ρi = 1) = 1 −Pr(ρi = 0) = q). Then ρi ≡ρ2
i and
ρ′
i ≡ρ′2
i , so U ≥Pn
i=1 ξ2
i . Conditional on ξ2
i for i = 1, . . . , n, V is equal in
distribution to Pn
i=1 ǫiξi, where ǫi are Rademacher random variables, equal
to ±1 with probability 1/2 each, independent of each other and the ξi. It then
follows that
ηN(s) ≤es sup
(
E exp
 
s
h
n
X
i=1
αiǫi
i2
!
:
n
X
i=1
α2
i ≤1
)
.
(12.106)
To see this, write the expectation as that of the conditional expectation given
the ξi. If not all ξi are 0, let αi := ξi/(Pn
j=1 ξ2
j )1/2. If all ξi are 0, let αi = 0
for all i.
We next need the following bound, which is asymptotically sharp, letting
αi = 1/√n, n →∞.

12.7
Empirical Processes
627
Lemma 12.50. For 0 < s < 1/2, a N(0, 1) random variable Z, any αi with
Pn
i=1 α2
i ≤1, and independent Rademacher ǫi,
E exp

s
" n
X
i=1
αiǫi
#2
≤E exp
 sZ2
.
Proof. Let Y := Pn
i=1 αiǫi. It suﬃces to show that E(Y 2k) ≤E(Z2k) for
k = 0, 1, 2, . . .. We have from EetZ = exp(t2/2) that E(Z2k) = (2k)!/(2kk!).
For any real u, EeuY
=
Πn
i=1E exp(uǫiαi)
=
Πn
i=1 cosh(uαi), where for
each real v, cosh(v) = P∞
j=0 v2j/(2j)!. For given nonnegative integers k and n
let (P Π)n,k denote the sum, over all n-tuples {ji}n
i=1 of nonnegative integers
ji such that Pn
i=1 ji = k, of products from i = 1 to n of given functions of
ji. Thus E(Y 2k) = (2k)!(P Π)n,kα2ji
i
/(2ji)!, and 1 ≥(α2
1 + · · · + α2
n)k
=
k!(P Π)n,kα2ji
i
/ji!. So it will be enough to prove that for any integers ji ≥0
with Pn
i=1 ji = k, Πn
i=11/(2ji)! ≤2−kΠn
i=11/ji!, which is clear since 2jj! ≤
(2j)! for each j = ji (with equality for j = 0 or 1, which helps to explain the
asymptotic sharpness for large n and ﬁxed k).
2
By Lemma 12.50 and (12.106), since E exp(sZ2) = 1/√1 −2s for s < 1/2,
Lemma 12.49 follows.
2
Lemma 12.49 gives that ηN(0.28) < 2. Thus one can replace t in (12.104)
by (3.6Cp)p, and so by (12.103), there is a ﬁnite constant Dp such that
np/2
Wj,k(βn −B◦
n)
p
ψp ≤Dp
for each j = 0, 1, 2, . . ., k = 1, . . . , 2j, and n = 1, 2, . . . . Then by (12.100),
(12.93), and (12.101), it follows that
 ∥[βn]r −[B◦
n]r∥(p)

φp ≤
r
X
j=0
vp
 2j
X
k=1

Wj,k(βn −B◦
n)

Tj,k

1/p
ψp
≤2D1/p
p
n−1/2(2r)1/p/(1 −2−1/p)
for each r = 1, 2, . . . . We choose r = r(n) = ⌊log2(n)⌋, where ⌊x⌋is the
largest integer less than or equal to x. Then n ≥2r, 2−r < 2/n, and the
desired bound (12.84) follows by (12.90), (12.95), (12.97), and the preceding
bound. The proof of Theorem 12.42 is complete.
2

628
12 Stochastic Processes and Φ-Variation
12.8
Diﬀerentiability of Operators on Processes
Some operators are Fr´echet diﬀerentiable with respect to p-variation norms
only for p < 2. The product integral need not exist for interval functions in
AI2(J) but not in AI∗
2(J) (Proposition 9.19) or in AIp(J) for all p > 2
(Proposition 9.22).
In the Love–Young inequality (3.129) and the inequality for convolutions
(3.167), at least one of the two functions must be in Wp for p < 2. On
the other hand, paths of Brownian motion and certain other processes have
bounded p-variation only for p > 2, and the empirical process converges in
p-variation norm to the Brownian bridge only for p > 2. The question arises
how the diﬀerentiability can still be useful. We will examine this question for
the empirical process.
The degree of smoothness of an operator T on distribution functions (re-
mainder bounds of suﬃciently small order) and properties of the derivative
operator DT may compensate for the relatively slow convergence of Fn to F
in ∥· ∥(p) for p < 2. We have for example the following.
Proposition 12.51. Let 1 < p < 2, let F be a distribution function on R,
and let T be an operator deﬁned on an open neighborhood U of F in Wp(R),
Fr´echet diﬀerentiable at F, with derivative DT at F, and such that for some
γ > 1, as g →F in Wp,
∥T (g) −T (F) −(DT )(g −F)∥= O(∥g −F∥γ
[p]).
(12.107)
If p > (2γ)/(2γ −1) then for the empirical distribution functions Fn we have
√n
 T (Fn) −T (F)

= (DT )
 √n(Fn −F)

+ OPr
 n[p+2γ(1−p)]/(2p)
= (DT )
 √n(Fn −F)

+ oPr(1),
where T (Fn) is deﬁned with probability converging to 1 as n →∞.
Proof. We have Fn ∈U with probability converging to 1 as n →∞by
Theorem 12.40, which also then implies the ﬁrst conclusion. The second holds
since the hypothesis on p is equivalent to p+2γ(1−p) < 0, and the proposition
is proved.
2
Remark 12.52. Since 1 < 2γ/(2γ −1) < 2, we can choose p < 2. If γ = 2,
e.g. if T is twice diﬀerentiable at F, then for p close enough to 2, the remainder
becomes OPr(nǫ−1/2) for any ǫ > 0.
Let Y be the range Banach space of T , so that DT is a bounded linear
operator from all of Wp(R) into Y . Even though √n(Fn−F) does not converge
in distribution to a Brownian bridge evaluated at F in the sense that it does
for p > 2, it may well be that (DT )(√n(Fn −F)) converges in distribution
in Y to (DT )(B◦◦F) for a Brownian bridge B◦, for example if Y is ﬁnite-
dimensional, and then so does √n(T (Fn) −T (F)).

12.9
Integration
629
12.9
Integration
One might be tempted to think that R 1
0 B dB = B(1)2/2 for almost all paths
of Brownian motion B, but such integrals do not exist in any of the pathwise
senses we have treated up to this point:
Proposition 12.53. For almost all paths B = {Bt}t≥0 of a Brownian mo-
tion, (A) ∫1
0 B dB is not deﬁned for A = RS, RRS, LS, RYS, CY , or HK.
Proof. It suﬃces to consider CY and HK integrals by the implications shown
in Figure 2.1 in Section 2.9. If the CY integral (deﬁned in Section 2.5) existed
it would equal the RRS integral by sample continuity and the deﬁnition of
the integral, so the reﬁnement Young–Stieltjes integral would exist. Brownian
paths almost surely have unbounded 2-variation on every interval [a, b], a < b,
by (12.11). By continuity, there are arbitrarily large sums
n
X
i=1

B(ti) −B(ti−1)

B(vi) −B(ui)

with a = t0 < · · · < ti−1 < ui < vi < ti < · · · < tn = b for each i = 1, . . . , n.
Thus the sums Pn
i=1[B(ti) −B(ti−1)]B(wi) with ti−1 < wi < ti for each i
are unbounded. Since these are Young sums, (RYS) ∫1
0 B dB does not exist.
Nor does (HK) ∫1
0 B dB by Proposition 2.70 since the corresponding sums are
unbounded on any subinterval of [0, 1].
2
Stochastic integrals
Integrals have been deﬁned (for more than half a century) by probabilistic
methods.
We recall ﬁrst the Itˆo integral. Let B = {Bt}t≥0 be a Brownian motion on
a probability space (Ω, F, Pr). For t ≥0, let Ft be the σ-algebra generated
by the random variables {B(u): 0 ≤u ≤t}. Then for 0 ≤s < t < ∞we have
{∅, Ω} := F0 ⊆Fs ⊆Ft ⊆F. For 0 < T < ∞consider the class H[0, T] of
stochastic processes H = {Ht}0≤t≤T satisfying the following properties:
(1) (t, ω) 7→H(t, ω) is B × F-measurable, where B is the Borel σ-algebra on
[0, T ];
(2) H is Ft-adapted, i.e. H(t, ·) is Ft-measurable for all 0 ≤t ≤T ;
(3) E

∫T
0 H(t)2 dt

< ∞.
We now deﬁne the Itˆo integral (I) ∫T
0 H dB for each H ∈H([0, T]). First
suppose that H is elementary, that is,
H(t, ω) = h01{0}(t) +
n
X
i=1
hi(ω)1(ti−1,ti](t)

630
12 Stochastic Processes and Φ-Variation
for 0 ≤t ≤T and some 0 = t0 < t1 < · · · < tn = T , where h0 is a constant,
each hi, i = 1, . . . , n, is Fti−1-measurable, and Eh2
i < ∞. For such H deﬁne
the Itˆo integral by
(I)
Z T
0
H dB :=
n
X
i=1
hi

B(ti) −B(ti−1)

.
(12.108)
It is easy to check that
E
h
(I)
Z T
0
H dB
i2
= E
h Z T
0
H(t)2 dt
i
(12.109)
for each elementary H ∈H[0, T]. The set of all elementary stochastic processes
is dense in H[0, T] in the norm of L2([0, T], λ) (see e.g. Section 2.2 in McKean
[164]): for an arbitrary H ∈H[0, T], there exists a sequence {Hm}m≥1 of
elementary processes Hm such that
lim
m→∞E
h Z T
0
 H(t) −Hm(t)
2 dt
i
= 0.
Then the Itˆo integral for H is deﬁned as the limit
(I)
Z T
0
H dB := lim
m→∞(I)
Z T
0
Hm dB
in L2(Ω, Pr),
which by (12.109) does not depend on the actual sequence {Hm}m≥1 chosen.
The identity (12.109) extends to all processes in H[0, T] and then is called the
Itˆo isometry.
The following equality for a smooth function of a Brownian motion is an
important tool in stochastic calculus: for a C2 function F the composition
F ′◦B is Itˆo integrable with respect to B and for any 0 ≤s < t < ∞,
(F◦B)(t) −(F◦B)(s) = (I)
Z t
s
(F ′◦B) dB + 1
2
Z t
s
(F ′′◦B) dt.
(12.110)
This identity is called the Itˆo formula for a Brownian motion, and extensions
of it hold for a large class of stochastic processes (Theorem 6 in [106]). The
Itˆo formula is sometimes written in a diﬀerential form as
dF(B) = F ′(B)dB + F ′′(t)dt/2,
whose precise meaning is just (12.110). For example, the integral
R 1
0 B dB,
shown not to exist in several senses in Proposition 12.53, exists in the Itˆo
sense: for F(u) ≡u2/2, the formula (12.110) gives
(I)
Z 1
0
B dB = (B(1)2 −1)/2,
(12.111)

12.9
Integration
631
diﬀering by −1/2 from the value if B is replaced by a C1 function of t.
Let f be a real-valued continuous function of bounded variation on [a, b]
and let F be a C1 function. By Theorem 2.87, the composition F ′◦f is
Riemann–Stieltjes integrable with respect to f and
(F◦f)(b) −(F◦f)(a) = (RS)
Z b
a
(F ′◦f) df.
(12.112)
The Itˆo formula (12.110) diﬀers from the “chain rule” equality (12.112) by a
correction term.
Let f, h: [a, b] →R. For a partition κ = {xi}n
i=0 of [a, b], let
SMS(f, dh; κ) := 1
2
n
X
i=1

f(xi−1) + f(xi)
 
h(xi) −h(xi−1)

and |κ| := maxi(xi −xi−1). Deﬁne the (mesh) mean Stieltjes integral by
(MS)
Z b
a
f dh :=
lim
|κ|→0 SMS(f, dh; κ)
(12.113)
provided the limit exists. Hildebrandt [97, Section 19.1] treats this integral
and gives some of its history. Let f be any real-valued function on [a, b]. Then
for any partition κ of [a, b], we have
SMS(f, df; κ) = [f 2(b) −f 2(a)]/2,
and so the integral (MS) ∫b
a f df exists and equals the right side. In particular,
for almost all sample functions of a Brownian motion B and each t > 0, we
have (MS) ∫t
0 B dB = B(t)2/2, in contrast to (12.111).
Let X and Y be two real-valued stochastic processes deﬁned for 0 ≤t < ∞.
Then for each 0 < T < ∞, the limit
[X, Y ](T ) :=
lim
|{ti}|→0
n
X
i=1
[X(ti) −X(ti−1)][Y (ti) −Y (ti−1)],
(12.114)
if it exists in probability, is called the quadratic covariation between X and
Y on [0, T ]. It exists under some conditions, see e.g. Proposition 17.17 in O.
Kallenberg [112]. In particular [X, X](T ) is called the quadratic variation of
X on [0, T] and satisﬁes [X, X](T ) ≤v2(X; [0, T]) a.s. For example, it is well
known that for Brownian motion B, [B, B](T ) = T a.s. Recall however that
v2(B; [0, T]) = +∞a.s. by (12.11).
Nonexistence of pathwise integrals for some marginal Brownian motions
In Proposition 12.53 we saw that for a Brownian motion B, (A) ∫1
0 B dB does
not exist for several integrals of Riemann–Stieltjes type. The Itˆo stochastic
integral (I) ∫t
0 B dB, given by (12.111), exists.

632
12 Stochastic Processes and Φ-Variation
If X and Y are two independent Brownian motions, then the Itˆo inte-
grals (I) ∫t
0 X dY and (I) ∫t
0 Y dX exist. (It is easily seen that the quadratic
covariation [X, Y ](T ), deﬁned by (12.114), is 0 for all T > 0.) If X and Y
are Brownian motions with an arbitrary joint distribution, however, it will
be shown that the sums “approximating” (I) ∫t
0 Y dX may be unbounded in
probability. Nonexistence of such an integral can occur because X is antic-
ipating with respect to Y . Thus, it appears that not only properties of the
individual sample functions X and Y , but probabilistic properties are needed
for existence of such integrals.
For a partition κ = {tr}n
r=0 of [a, b] and two real functions f, g on [a, b],
let
SLC(f, dg; κ) :=
n
X
i=1
f(ti−1)

g(ti) −g(ti−1)

.
Here LC denotes “left Cauchy.” Also, the sums SLC are of the form of approx-
imating sums for Itˆo integrals as in (12.108), where hi is Fti−1 measurable.
Let
A(κ) := A(f, g; κ) := 1
2
n
X
r=1

f(tr−1)g(tr) −f(tr)g(tr−1)

= 1
2
n
SLC(f, dg; κ) −SLC(g, df; κ)
o
.
If t 7→(f, g)(t), a ≤t ≤b, deﬁnes a simple, piecewise C1, counterclockwise
closed curve in R2 (so that it has winding number 1 around each point in the
bounded part U of its complement), then by a corollary of Green’s theorem
(e.g. [157, Section 7.1, Theorem 2]) the area A(U) of U is given by
A(U) = 1
2
Z b
a
f dg −g df.
A simple example is (f, g)(θ) := (cos θ, sin θ), 0 ≤θ ≤2π. Extending this, if f
and g are continuous on [a, b] and (f, g)(b) = (f, g)(a), then the limit of A(κ)
as the mesh |κ| ↓0, if it exists, has been deﬁned as the area enclosed by the
closed curve (f, g), e.g. W. H. Young [255]. Here, U will be a union of disjoint
connected open sets Un. The winding number of the curve around each point
x ∈Un will be an integer zn ∈Z. One can see in some elementary cases that
1
2
Z b
a
f dg −g df =
X
n
znA(Un).
(12.115)
For more complicated nonsmooth curves, we can have supn |zn| = +∞, and
the sum in (12.115) may not converge. We will see in part (c) of the next
proposition that for f and g Brownian bridges, the integral in (12.115) need
not exist (even as a stochastic integral).

12.9
Integration
633
Proposition 12.54. For n = 1, 2, . . . let κn be the partition {r/n}n
r=0 of
[0, 1]. On some probability space (Ω, F, Pr), there exists a Gaussian stochastic
process {(Xt, Yt)}0≤t≤1 with values in R2 such that X and Y are each Brown-
ian motions, and Sn is unbounded in probability as n →∞, where for each
n,
(a) Sn = SLC(Y, dX; κn);
(b) Sn = SMS(Y, dX; κn);
(c) Sn = A(Y0, X0; κn) where X0 = {X(t) −X(1)t}0≤t≤1 and Y0 = {Y (t) −
Y (1)t}0≤t≤1 are Brownian bridges.
Proof. Let L be the isonormal Gaussian process on a probability space
(Ω, F, Pr), indexed by the Hilbert space L2[0, 1] = L2([0, 1], λ) with Lebesgue
measure λ, that is, {L(f), f ∈L2[0, 1]} is a Gaussian process with mean 0
and covariance E[L(f)L(g)] = (f, g), the inner product in the Hilbert space
L2[0, 1]. In particular, the stochastic process B = {Bt := L(1[0,t])}0≤t≤1
is a Brownian motion, since it has mean zero and the correct covariance
min{s, t}. Let c0(x) ≡1, and for k = 1, 2, . . ., let ck(x) :=
√
2 cos(2πkx)
and sk(x) :=
√
2 sin(2πkx) for x ∈[0, 1]. Then {c0, ck, sk}k≥1 form an or-
thonormal basis of L2[0, 1] and we have the expansion
B(t) = ξ0t + 1
2π
∞
X
k=1
1
k
n
ξksk(t) + ηk(
√
2 −ck(t))
o
,
(12.116)
where ξk, ηk are i.i.d. N(0, 1) random variables on the probability space
(Ω, F, Pr). The series converges a.s. uniformly on [0, 1], e.g. [52, Theorem
2.5.5]. Recall the notion of unconditional convergence of series in a Banach
space from Section 1.4. For any given t, the series (12.116) converges uncon-
ditionally in H = L2(Ω, F, Pr). For 0 ≤t ≤1, let
X0(t) :=
1
2π
∞
X
k=1
1
k
n
ξksk(t) + ηk[
√
2 −ck(t)]
o
and
Y0(t) :=
1
2π
∞
X
k=1
1
k
n
ηksk(t) + ξk[ck(t) −
√
2]
o
.
Then by (12.116), X(t) := B(t) = X0(t) + ξ0t is a Brownian motion. The
processes X0 and Y0 are the same in distribution since {ηk, −ξk}k≥1 are i.i.d.
N(0, 1). Thus Y (t) := Y0(t) + η0t, where η0 is such that {ξk, ηk}k≥0 are i.i.d.
N(0, 1), gives another Brownian motion. Clearly (X, Y ) is Gaussian. So the
ﬁrst statement in the proposition is proved. Here X and Y have an unusual
joint distribution.
It is enough to prove statement (a) for the Gaussian process (X0, Y0)
instead of (X, Y ). Indeed, for a function ψ deﬁned on [0, 1] and tr := r/n,

634
12 Stochastic Processes and Φ-Variation
let (∆ψ)(tr) := ψ(tr) −ψ(tr−1) for r = 1, . . . , n. For each n we then have
SLC(Y, dX; κn) = SLC(Y0, dX0; κn) + Rn, where
Rn := Y (1)
n
X
r=1
tr−1(∆X)(tr) + X(1)
n
X
r=1
Y (tr−1) 1
n −X(1)Y (1)n −1
2n .
Here (∆X)(tr) for r = 1, . . . , n are i.i.d. N(0, 1/n) random variables. Thus
the ﬁrst sum in Rn has mean 0 and variance < 1 and so it is bounded in
probability as n varies. Applying summation by parts to the second sum in
Rn, we get a representation Y (1)−Pn
r=1 tr(∆Y )(tr), which is again bounded
in probability. Therefore for any ǫ > 0, there exists a ﬁnite C such that
supn Pr({|Rn| > C}) < ǫ. So for each ﬁnite M and each n, we have
Pr({|SLC(Y, dX; κn)| ≤M}) ≤Pr({|SLC(Y0, dX0; κn)| ≤M + C} + ǫ,
proving the claim.
Let η := (
√
2/(2π)) P∞
k=1 ηk/k and ξ := (
√
2/(2π)) P∞
k=1 ξk/k. For each
k = 1, . . . , n, let N(k) := {k, k + n, k + 2n, . . . } be the set of all positive
integers j such that j −k is divisible by n. Then for all j ∈N(k) and all
r = 0, 1, . . . , n, cj(tr) = ck(tr) and sj(tr) = sk(tr). It follows that
X0(tr) −η =
1
2π
n
X
k=1
Gksk(tr) −Hkck(tr)
(12.117)
where Gk := P
j∈N(k) ξj/j and Hk := P
j∈N(k) ηj/j, each converging almost
surely, and unconditionally in H, as follows from the unconditional conver-
gence mentioned after (12.116). Each of Gk and Hk has distribution N(0, σ2
k)
where
σ2
k :=
X
j∈N(k)
1/j2.
(12.118)
Likewise
Y0(tr) + ξ =
1
2π
n
X
k=1
Hksk(tr) + Gkck(tr).
(12.119)
Then we have
S(κn) := SLC(Y0, dX0; κn)
(12.120)
= SLC((Y0 + ξ), d(X0 −η); κn) = S1(n) + S2(n),
where
S1(n) :=
1
4π2
n
X
k,l=1
GkGlSLC(ck, dsl; κn) −HkHlSLC(sk, dcl; κn), (12.121)
S2(n) :=
1
4π2
n
X
k,l=1
HkGlSLC(sk, dsl; κn) −GkHlSLC(ck, dcl; κn). (12.122)

12.9
Integration
635
We have sn(tr) = 0 and cn(tr) = 1 for all r, so the diﬀerence between any
two values of cn is 0. Thus in both sums S1(n) and S2(n) we can take Pn−1
k,l=1.
In proving the unboundedness in probability we can and will assume that n
is odd. Let n be ﬁxed. The following relations, no doubt well known, about
the discrete Fourier transform, are given here for completeness. For k, l =
1, . . . , n −1 we have
Tk,l,1 :=
n
X
r=1
exp(2πiktr−1) exp(2πiltr−1) = n1{k+l=n},
(12.123)
Tk,l,2 :=
n
X
r=1
exp(2πiktr−1) exp(2πiltr) = exp(2πil/n)Tk,l,1.
(12.124)
Taking real and imaginary parts it follows that if k + l ̸= n,
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr−1) −sin(2πktr−1) sin(2πltr−1)
=
n
X
r=1
cos(2πktr−1) sin(2πltr−1) + sin(2πktr−1) cos(2πltr−1)
(12.125)
and
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr) −sin(2πktr−1) sin(2πltr)
=
n
X
r=1
cos(2πktr−1) sin(2πltr) + sin(2πktr−1) cos(2πltr).
(12.126)
On the other hand, likewise
Tk,l,3 :=
n
X
r=1
exp(2πiktr−1) exp(−2πiltr−1) = n1{k=l},
(12.127)
Tk,l,4 :=
n
X
r=1
exp(2πiktr−1) exp(−2πiltr) = exp(−2πil/n)Tk,l,3.
(12.128)
Taking real and imaginary parts again gives for k ̸= l,
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr−1) + sin(2πktr−1) sin(2πltr−1)
=
n
X
r=1
−cos(2πktr−1) sin(2πltr−1) + sin(2πktr−1) cos(2πltr−1)
(12.129)
and

636
12 Stochastic Processes and Φ-Variation
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr) + sin(2πktr−1) sin(2πltr)
=
n
X
r=1
−cos(2πktr−1) sin(2πltr) + sin(2πktr−1) cos(2πltr).
(12.130)
If k ̸= l and k + l ̸= n, then combining (12.125) and (12.129) gives
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr−1) =
n
X
r=1
sin(2πktr−1) sin(2πltr−1)
=
n
X
r=1
cos(2πktr−1) sin(2πltr−1) =
n
X
r=1
sin(2πktr−1) cos(2πltr−1),
(12.131)
and likewise combining (12.126) and (12.130) gives
0 =
n
X
r=1
cos(2πktr−1) cos(2πltr) =
n
X
r=1
sin(2πktr−1) sin(2πltr)
=
n
X
r=1
cos(2πktr−1) sin(2πltr) =
n
X
r=1
sin(2πktr−1) cos(2πltr).
(12.132)
Subtracting each of the four sums in (12.131) from the corresponding sum in
(12.132) gives also for k ̸= l and k + l ̸= n,
0 = SLC(ck, dcl; κn) = SLC(sk, dsl; κn) = SLC(ck, dsl; κn) = SLC(sk, dcl; κn).
Thus when neither k = n −l nor k = l, all the terms in S1(n) and S2(n) are
0. So S1(n) = S11(n) + S12(n) and S2(n) = S21(n) + S22(n) where
S11(n) :=
1
4π2
n−1
X
k=1
G2
kSLC(ck, dsk; κn) −H2
kSLC(sk, dck; κn),
S12(n) :=
1
4π2
n−1
X
k=1
GkGn−kSLC(ck, dsn−k; κn)−HkHn−kSLC(sk, dcn−k; κn),
S21(n) :=
1
4π2
n−1
X
k=1
GkHk [SLC(sk, dsk; κn) −SLC(ck, dck; κn)] ,
S22(n) :=
1
4π2
n−1
X
k=1
HkGn−kSLC(sk, dsn−k; κn)−GkHn−kSLC(ck, dcn−k; κn)
=
1
4π2
n−1
X
k=1
HkGn−k[SLC(sk, dsn−k; κn) −SLC(cn−k, dck; κn)].
(Because n is odd, the cases k = l and k + l = n do not overlap.) Let m :=
⌊n/2⌋= (n−1)/2 since n is odd. Then to write S12(n) as a sum of independent
terms, we have S12(n) = S121(n) + S122(n) where using

12.9
Integration
637
cn−k ≡ck and sn−k ≡−sk,
(12.133)
S121(n) :=
1
4π2
m
X
k=1
GkGn−k[SLC(ck, dsn−k; κn) + SLC(cn−k, dsk; κn)] ≡0,
S122(n) :=
1
4π2
m
X
k=1
−HkHn−k[SLC(sk, dcn−k; κn) + SLC(sn−k, dck; κn)] ≡0.
Thus S12(n) ≡0. Clearly ESij(n) = 0 except for i = j = 1. So
E(S(κn)) =
1
4π2
n−1
X
k=1
σ2
k (SLC(ck, dsk; κn) −SLC(sk, dck; κn)) .
(12.134)
We have clearly E[Sij(n)Suv(n)] = 0 except when u = i and v = j. It follows
that
Var(S(κn)) =
1
16π4
n−1
X
k=1
σ4
k(Ak + Ck + Dk)
(12.135)
where again using (12.133),
Ak := 2[SLC(ck, dsk; κn)2 + SLC(sk, dck; κn)2],
Ck := [SLC(sk, dsk; κn) −SLC(ck, dck; κn)]2,
(12.136)
Dk := [SLC(sk, dsk; κn) + SLC(ck, dck; κn)]2.
When k = l, we have k + l ̸= n since n is odd, so (12.125) and (12.126) hold.
By (12.127) in this case, in (12.129) the second line still equals 0, but now the
right side of the ﬁrst line equals n in an obvious identity. Combining gives for
each k = 1, . . . , n,
n
X
r=1
sk(tr−1)ck(tr−1) = 0,
n
X
r=1
s2
k(tr−1) =
n
X
r=1
c2
k(tr−1) = n.
(12.137)
By (12.128) for k = l, the second line of (12.130) equals −n sin(2πk/n) and
the right side of its ﬁrst line equals n cos(2πk/n). Combining these equations
with (12.126) gives
n
X
r=1
ck(tr−1)sk(tr) = n sin(2πk/n) = −
n
X
r=1
sk(tr−1)ck(tr)
(12.138)
and
n
X
r=1
sk(tr−1)sk(tr) =
n
X
r=1
ck(tr−1)ck(tr) = n cos(2πk/n).
(12.139)

638
12 Stochastic Processes and Φ-Variation
Combining in the last four displays gives
SLC(sk, dsk; κn) = SLC(ck, dck; κn) = n[cos(2πk/n) −1] < 0,
(12.140)
SLC(ck, dsk; κn) = n sin(2πk/n) = −SLC(sk, dck; κn).
(12.141)
We then get from (12.134) that
E(S(κn)) =
1
4π2
n−1
X
k=1
2nσ2
k sin(2πk/n) =
n
2π2
m
X
k=1
(σ2
k −σ2
n−k) sin(2πk/n).
For 1 ≤k ≤m < n/2 we have sin(2πk/n) > 0, and from the deﬁnition
(12.118) of σk we have that each term in the sum deﬁning σ2
n−k is smaller
than the corresponding term in the sum for σ2
k. It follows that σ2
k −σ2
n−k >
k−2 −(n −k)−2 > 0. Moreover, a straightforward calculation shows that for
k ≤n/4 we have σ2
k −σ2
n−k ≥8/(9k2). We also have sin(x) ≥2x/π for
0 ≤x ≤π/2 by concavity. We thus have
ES(κn) ≥4n
9π2
⌊n/4⌋
X
k=1
1
k2 sin
2πk
n

≥16
9π2
⌊n/4⌋
X
k=1
1
k
∼16
9π2 log
n
4

→∞
as n →∞, n odd. It will next be shown that Var(S(κn)) is bounded for n
odd. In (12.135) and (12.136) we have by (12.140) and (12.141) that Ak =
4n2 sin2(2πk/n) and Ck+Dk = 4n2(1−cos(2πk/n))2. For any real x, it is well
known and easily checked by derivatives that | sin x| ≤|x| and 1−cosx ≤x2/2.
It follows that
Var(S(κn)) ≤
1
16π4
n−1
X
k=1
σ4
k(16π2k2 + 16π4k4/n2)
≤1
π2
n−1
X
k=1
k2σ4
k(1 + π2).
From (12.118) we have since k ≤n that
σ2
k ≤k−2
∞
X
j=1
j−2 = π2/(6k2);
thus Pn−1
k=1 k2σ4
k ≤(π2/6)3, so indeed the variance of S(κn) remains bounded,
and since its expectation is unbounded, S(κn) is unbounded in probability for
n odd, proving (a).

12.9
Integration
639
For (b), for each n, we have
SMS(Y, dX; κn) = SLC(Y, dX; κn) + 1
2
n
X
r=1
∆Y (tr)∆X(tr).
The quadratic variation of a Brownian motion exists, as noted after (12.114)
(for the given sequence of partitions, even in an almost sure sense: [47, Theo-
rem 4.5]), so by the Cauchy–Schwarz inequality, the sum on the right side is
bounded in probability, that is, given ǫ > 0, there is a ﬁnite C such that
sup
n Pr
n1
2

n
X
r=1
∆Y (tr)∆X(tr)
 > C
o
< ǫ.
So for any ﬁnite M and each n, we have
Pr
 
|SMS(Y, dX; κn)| ≤M
	
≤Pr
 
|SLC(Y, dX; κn)| ≤M + C
	
+ ǫ.
The right side is less than 2ǫ for all suﬃciently large n odd by the proof of
(a), proving (b).
For (c), by (12.120), we have A(κn) := A(Y0, X0; κn) = A1(n) + A2(n),
where
A1(n) :=
1
8π2
n
X
k,l=1

GkGl + HkHl

SLC(ck, dsl; κn) −SLC(sk, dcl; κn)

and
A2(n) :=
1
8π2
n
X
k,l=1

HkGl −GkHl

SLC(sk, dsl; κn) + SLC(ck, dcl; κn)

.
Let n be odd, as in the proof of (a). Since sn(tr) = 0 and cn(tr) = 1 for all r in
both sums A1(n) and A2(n) we can take Pn−1
k,l=1. When neither k = n −l nor
k = l, all the terms in A1(n) and A2(n) are 0. Thus A1(n) = A11(n) + A12(n)
and A2(n) = A21(n) + A22(n) where
A11(n) :=
1
8π2
n−1
X
k=1

G2
k + H2
k

SLC(ck, dsk; κn) −SLC(sk, dck; κn)

,
A12(n)
:=
1
8π2
n−1
X
k=1

GkGn−k+HkHn−k

SLC(ck, dsn−k; κn)−SLC(sk, dcn−k; κn)

,
A21(n) :=
1
8π2
n−1
X
k=1

HkGk−GkHk

SLC(sk, dsk; κn)+SLC(ck, dck; κn)

= 0,

640
12 Stochastic Processes and Φ-Variation
A22(n)
:=
1
8π2
n−1
X
k=1

HkGn−k−GkHn−k

SLC(sk, dsn−k; κn)+SLC(ck, dcn−k; κn)

.
By (12.133) and (12.141) it follows that A12(n) = 0. By (12.133) and (12.140)
it follows that A22(n) = 0. Thus A(κn) ≡A11(n), and EA(κn) = ES(κn) in
the proof of (a), which as shown there is unbounded for n odd. The variance
of A11(n) is bounded similarly as but more easily than in the proof of (a).
This completes the proof of (c) and the proposition.
2
12.10
Notes
Notes on Section 12.2. The book Kallenberg [112], which we often cite
throughout the chapter, is the second edition of a book that ﬁrst appeared
in 1997. The second edition has, perhaps most notably, newly inserted chap-
ters 2: “Measure Theory: Key Results,” 11: “Special notions of symmetry and
invariance,” 20: “Ergodic properties of Markov processes,” and 27: “Large
deviations.”
For p > 2 and for almost all sample functions of Brownian motion B =
B(·, ω), the boundedness of the p-variation of B, which is the ﬁrst part of
(12.11), follows from the α-H¨older property for B with α = 1/p. The latter
fact was established by N. Wiener in [240, §7]. The second part of (12.11),
that is, the almost sure unboundedness of the 2-variation of B, was proved by
P. L´evy in [140, Theorem 9, p. 516].
Notes on Section 12.4. Theorem 12.13 and Proposition 12.14 are due to
Jain and Monrad [110]. The local law of the iterated logarithm for a fractional
Brownian motion follows from a functional version of the law of the iterated
logarithm for a class of Gaussian processes proved by Oodaira [181] (see Lai
[132] for some corrections). The direct proof given here (Proposition 12.19) is
based on ideas of Nisio [180] used to prove related results. A probability bound
similar to the one in Lemma 12.18 can also be obtained using the Gaussian
concentration inequality (4.4) and Ledoux [135, Theorem 6.1].
Notes on Section 12.5. Regarding Theorem 12.25 on existence of Markov
processes, J. L. Doob’s book [46], Chapter 2, §6, between (6.18) and (6.19),
states that for given, not necessarily stationary, transition probabilities and an
initial distribution, ﬁrst consistent ﬁnite-dimensional joint distributions can
be deﬁned by iterated integrals, and then a Markov process with the given
transition probabilities exists by the general Kolmogorov existence theorem.
The rest of the section is based on a paper by M. Manstaviˇcius [155]. The
lemmas and inequalities are virtually the same as in his paper, but the the-
oretical framework has been arranged diﬀerently here. Most of the accessible

12.10
Notes
641
theory of Markov processes has restrictions that were inconvenient for our
purposes.
Many authors deal with processes taking values in a locally compact met-
ric space, with conditions having to do with compact sets, and/or the time-
homogeneous case, where Ps,t depends only on the diﬀerence t −s; see e.g.
Kallenberg [112, Chapter 19]. Some more elementary parts of the theory are
developed without time homogeneity [112, Chapter 8].
One of the main tools of Markov process theory is the strong Markov prop-
erty, saying that a suitable Markov process gets a fresh start at Markov times
such as stopping times. This is easiest to formulate for time-homogeneous
processes.
Dynkin [59, §2.1] deﬁnes general (not necessarily time-homogeneous) Mar-
kov processes in general state spaces, where not only the transition probabili-
ties Ps,t but the full distribution Ps;x of a process starting at x at time s
are included in the deﬁnition. Also, beyond a ﬁltration Ft of events occurring
between times 0 and t, Dynkin’s deﬁnition includes σ-algebras Fs
t of events
occurring between times s and t for 0 ≤s ≤t. Dynkin [59, §5.2] gives a def-
inition of strong (“strict”) Markov property and, in §5.4, he gives suﬃcient
conditions for this in a class of topological measurable spaces including metric
spaces, for right-continuous processes. Instead of trying to prove the theorem
just as stated by Manstaviˇcius [155, Theorem 1.3] through Dynkin’s formula-
tions, we decided to give a more direct, self-contained formulation and proof.
Thus, we do not need the strong Markov property since we consider stopping
times with ﬁnitely many values, where the ordinary Markov property suﬃces.
The classical theorem of Kinney [116], saying that if for each r > 0,
α(h, r) ↓0 as h ↓0, trajectories can be taken to be cadlag (right-continuous
with left limits), was formulated for real-valued functions. Kallenberg [112,
Theorem 17.15] gives a version in locally compact metric spaces. Gihman and
Skorohod [79, Vol. I, Chapter III, §4] treat separable processes with values in
a complete metric space. Kinney’s result is extended, ﬁrst with regulated tra-
jectories in Theorem 4, then with right-continuity in Theorem 5. These results
are derived from a fact about general stochastic processes where the bound
α(h, r) is assumed on suitable conditional probabilities in place of Markov
kernels (Theorem 2). Gihman and Skorohod also [79, Vol. II, Chapter I, §6,
Theorem 2] extend Kinney’s theorem to “Markov families” Ps,x, Fs
t , i.e. to
Markov processes with non-stationary transition probabilities indexed by dif-
ferent starting times and points, as deﬁned by Dynkin. The processes are
assumed to be separable, with values in a complete metric space. Existence
of separable versions is proved assuming that the state space is a separable
locally compact metric space. The local compactness is used by way of a com-
pactiﬁcation such as a 1-point compactiﬁcation, e.g. [79, Vol. I, Chapter III,
Theorem 2]. Indeed, the separable version may take values in the compactiﬁ-
cation, not necessarily in the original sample space. Thus, for processes with
values in metric spaces that are not locally compact, separability seems to be

642
12 Stochastic Processes and Φ-Variation
a nontrivial assumption, and results assuming it may not be as useful as they
ﬁrst appear.
In our proof, instead of calling on some version of Kinney’s theorem, we
just obtain right-continuity with left limits of the trajectories as a byproduct
near the end of the proof. The right continuity is virtually necessary for the
strong Markov property, and so it is generally adopted in the literature. For
p-variation alone, as seen in our proof, one could if desired take left continuity
instead.
Notes on Section 12.6. An exact result on Φ-variation is due to Fristedt
and Taylor [72, Theorem 2]. Namely for a suitable α-stable L´evy motion Xα
with α ∈(0, 2) and any Φ ∈V, with probability 1,
lim
|κ|→0, κ∈PP [0,1] sΦ(Xα; κ) =
X
(0,1]
Φ(|∆−Xα|),
where the right side is ﬁnite with probability 1 if and only if
Z
R\{0}
 1 ∧Φ(|x|)

dx
|x|1+α < ∞.
Xu [242, Section 3] established necessary and/or suﬃcient conditions for the
boundedness of the p-variation of a symmetric α-stable process with possibly
dependent increments. More information about p-variation of stable processes
can be found in Fristedt [71].
Notes on Section 12.7. For a sequence of independent real random variables
X1, X2, . . . with a distribution function F, let Yi(t) := 1{Xi≤t}−F(t) for t ∈R
and i = 1, 2, . . .. Theorem 12.41(a) then states that the sequence
n
(n log log n)−1/2
n
X
i=1
Yi

(2)
o
n≥3
is bounded in probability. The question whether the bound in this theorem
holds almost surely is a question whether the bounded law of the iterated
logarithm holds for the random elements Y1, Y2, . . . with respect to the 2-
variation seminorm.
In historical order, ﬁrst Y.-C. Huang [101], [102] proved Corollary 12.43,
then Dudley [51] proved Theorem 12.41(a), then Qian [189] proved Theorem
12.40 and Theorem 12.41(b), then Huang and Dudley [103] proved Theorem
12.42. The bound E(Y 2k) ≤E(Z2k), used in the proof of Lemma 12.50, was
proved by Whittle [239, Theorem 1] by a diﬀerent method.
Koml´os, Major, and Tusn´ady [121] stated that on some probability space
there exist independent random variables X1, X2, . . . having U[0, 1] distribu-
tion and Brownian bridges B◦
n such that
Pr
n
sup
0≤t≤1
√n(βn(t) −B◦
n(t))
 > x + c log n
o
< Ke−λx

12.10
Notes
643
for all n and positive real numbers x, where c, K, and λ are positive absolute
constants. Koml´os, Major, and Tusn´ady formulated the KMT construction
giving a joint distribution of βn and B◦
n also used to prove Theorem 12.42.
Bretagnolle and Massart [25] gave a proof of the stated inequality for n ≥2
with constants c = 12, K = 2, and λ = 1/6.
Notes on Section 12.9. The construction of the Itˆo integral can be extended
in several ways (see e.g. Dellacherie and Meyer [39, Chapter VIII]). Condition
3 can be relaxed to ∫T
0 H(t)2 dt < ∞almost surely (see e.g. Section 2.2 in
McKean [164]). Then (I) ∫T
0 H dB need no longer be square-integrable but
can be an arbitrary FT -measurable random variable (see [48]). Researchers in
stochastic analysis some decades ago deﬁned ∫H dX rather generally, speciﬁ-
cally when X is a semimartingale (for example, a right-continuous martingale)
and H is a locally bounded predictable process (for example, an adapted pro-
cess with regulated, left-continuous paths); see Dol´eans-Dade and Meyer [44],
Dellacherie and Meyer [39]. We will just mention that there are also ways to
deﬁne stochastic integrals with anticipating integrands: Skorohod [222].
Let a closed curve be deﬁned by continuous functions x(t), y(t), t ∈[a, b],
such that x(a) = x(b) and y(a) = y(b). W. H. Young [255, p. 346] deﬁned the
area to be the limit
A = 1
2 lim
|κ|→0
n
X
i=1
h
y(ti)x(ti−1) −y(ti−1)x(ti)
i
,
if it exists, as the mesh of partitions κ = {ti}n
i=0 of [a, b] tends to zero.
Paul L´evy [141] wrote that if (X(t), Y (t)) is 2-dimensional Brownian mo-
tion, then the area S included by its graph C for 0 ≤t ≤T and the chord
D which is the straight line segment from (0, 0) to (X(T ), Y (T )) “may be
formally deﬁned by the formula
S = 1
2
Z 2π
0
X(t)dY (t) −Y (t)dX(t).”
L´evy noted that a formal calculation with Fourier series gave an almost surely
convergent series of random variables, and he went on to consider the area
further. The “L´evy area” seems to have been named in honor of this work.
The proof of Proposition 12.54 is based on the paper by Lyons [150].


Appendix
Nonatomic Measure Spaces
In this appendix we collect some facts about ﬁnite measure spaces without
(and with) atoms, which are applied in Chapter 7.
Let (Ω, S, µ) be a σ-ﬁnite measure space. Then an atom of µ is a set
A ∈S with µ(A) > 0 such that for all C ∈S with C ⊂A, either µ(C) = 0 or
µ(C) = µ(A). By σ-ﬁniteness, we have µ(A) < +∞. (Ω, S, µ) or µ is called
nonatomic if it has no atoms.
Proposition A.1. Let (Ω, S, µ) be a nonatomic ﬁnite measure space with
µ(Ω) > 0. Then for any c with 0 < c < µ(Ω), there is an A ∈S with
µ(A) = c.
Proof. We can assume that µ(Ω) = 1. It will ﬁrst be shown that for some C ∈
S, 1/3 ≤µ(C) ≤2/3. Suppose not. Let p := sup{µ(B): µ(B) < 1/3} ≤1/3.
Then p > 0 since Ωis not an atom and if 2/3 < µ(D) < 1, let B := Ω\D. Take
Bn ∈S with µ(Bn) ↑p. Let En := Sn
j=1 Bj. It will be shown by induction
that µ(En) < 1/3 for all n. This is true for n = 1. Assuming it holds for a
given n, we have µ(En+1) = µ(En ∪Bn+1) < (1/3)+(1/3) = 2/3. Thus by the
assumption that µ takes no values in [1/3, 2/3], µ(En+1) < 1/3, completing
the induction. Let E := S∞
n=1 Bn. Then µ(E) = p, so p < 1/3.
Now, Ω\ E is not an atom, so take F ⊂Ω\ E with 0 < µ(F) < 1 −p. If
µ(F) ≤(2/3) −p, then p < µ(E ∪F) ≤2/3, contradicting the assumption or
the deﬁnition of p. But if µ(F) > (2/3) −p, replacing F by Ω\ (E ∪F) leads
to the same contradiction. So, it is shown that for some C ∈S, 1/3 ≤µ(C) ≤
2/3.
Next, an inclusion-chain will be a ﬁnite sequence {Cj}n
j=0 ⊂S with ∅=
C0 ⊂C1 ⊂· · · ⊂Cn = Ω. One inclusion-chain {Cj}n
j=0 will be a reﬁnement
of another {Di}k
i=0 iﬀfor each i, Di = Cj for some j. Let C0 := {∅, Ω}. Given
an inclusion-chain Cn = {Cn
j }2n
j=0, deﬁne a reﬁnement Cn+1 of it by adjoining,
for each j = 1, . . . , 2n, a set Cj−1 ∪Aj where Aj ∈S, Aj ⊂Cn
j \ Cn
j−1, and
µ(Aj)/µ(Cn
j \ Cn
j−1) ∈[1/3, 2/3]. Thus Cn are deﬁned recursively for all n.
Clearly, for each n and j = 1, . . . , 2n, if Cn = {Cn
j }2n
j=0, then µ(Cn
j \ Cn
j−1) ≤
©
R.M. Dudley and R. Norvaiša, Concrete Functional Calculus, Springer Monographs 
  Springer Science+Business Media, LLC 2011
645
in Mathematics, DOI 10.1007/978-1-4419-6950-7, 

646
Appendix Nonatomic Measure Spaces
(2/3)n →0 as n →∞. Thus the values {µ(Cn
j )}2n
j=0 become dense in [0, 1] as
n →∞. For any t ∈[0, 1], let Bt := S
n
S2n
j=0{Cn
j : µ(Cn
j ) ≤t}. Then Bt ∈S
and µ(Bt) = t, completing the proof.
2
Proposition A.1 and induction on n give directly the following:
Corollary A.2. Let (Ω, S, µ) be a ﬁnite nonatomic measure space. Let ri
for i = 1, . . . , n be numbers with ri > 0 and Pn
i=1 ri = µ(Ω). Then Ωcan be
decomposed as a union of disjoint sets Ai ∈S with µ(Ai) = ri for i = 1, . . . , n.
Here are suﬃcient conditions under which atoms equal singletons up to
sets of measure 0, as holds in familiar cases. A measurable space (Ω, S) is
called separated iﬀfor every x ̸= y in Ω, there is some C ∈S containing just
one of x and y.
Proposition A.3. Let (Ω, S, µ) be a σ-ﬁnite measure space such that (Ω, S)
is separated and S is countably generated, i.e. for some countably many Aj ∈
S, S is the smallest σ-algebra containing all Aj. Then for any atom A of µ
there is an x ∈A such that µ(A \ {x}) = 0. So, the singleton {x} is also
an atom. This holds in particular if there is a metric on Ωfor which it is
separable and S is its Borel σ-algebra.
Proof. Let A be an atom of µ. By σ-ﬁniteness we have 0 < µ(A) < +∞. For
each j, let Bj := Aj if µ(A ∩Aj) = µ(A) or Bj := Ac
j if µ(A ∩Aj) = 0. Let
C := A ∩T∞
j=1 Bj. Then µ(C) = µ(A) and C is also an atom. If there exist
x ̸= y in C then by the separated assumption there must exist Aj such that
Aj contains one of x and y but not both, contradicting the deﬁnition of C.
Thus C is a singleton {x} and µ(A \ {x}) = 0 as stated.
The Borel σ-algebra of a separable metric space is generated by the count-
ably many open balls with centers in a countable dense set and rational radii,
and it clearly separates points. This completes the proof.
2
Let Dλ = Dλ(Ω, S, µ) be the set of all functions G ∈L0(Ω, S, µ) such that
µ◦G−1 has a bounded density ξG with respect to Lebesgue measure λ on R.
Such functions were characterized in Theorem 7.24. If the set Dλ(Ω, S, µ) is
nonempty then µ must be nonatomic as the following shows:
Proposition A.4. Let (Ω, S, µ) be a ﬁnite measure space and G∈L0(Ω, S, µ).
If µ has an atom then µ◦G−1 has an atom {y} for some y.
Proof. Suppose that A ∈S is an atom of µ with c := µ(A) > 0. Restricting
µ to A, we can assume that Ω= A. Let F(x) := µ(G−1((−∞, x])) ∈[0, c]
for each x ∈R. Then F(x) ↓0 as x →−∞and F(x) ↑c as x →+∞.
If F(x) ∈(0, c) for some x ∈R, then the set G−1((−∞, x]) ∈S gives a
contradiction to the fact that A is an atom. Thus F has only one point of

Appendix Nonatomic Measure Spaces
647
increase, say y ∈R, with F(x) = 0 for all x < y and F(x) = c for all x ≥y,
and so {y} is an atom of µ◦G−1. This completes the proof.
2
On the other hand if (Ω, S, µ) is nonatomic, then the set Dλ(Ω, S, µ) is
rich enough in the sense stated by the following two propositions.
Proposition A.5. For any nonatomic ﬁnite measure space (Ω, S, µ) with
µ(Ω) > 0 and −∞< a < b < ∞, there is a G ∈Dλ such that the den-
sity ξG equals c1[a,b], where c = µ(Ω)/(b −a).
Proof. If G exists such that the density ξG equals µ(Ω)1[0,1], then a+(b−a)G
satisﬁes the conclusion. So we can assume a = 0 and b = 1. Also, multiplying
µ by a constant, we can assume µ(Ω) = 1.
By Proposition A.1, take A11 ∈S with µ(A11) = 1/2. Let A12 := Ω\ A11,
and G1 := (1/2)1A12. At the jth stage we will have a decomposition of Ω
into 2j disjoint sets Ajk ∈S, k = 1, . . . , 2j, with µ(Ajk) = 1/2j and Aj,k =
Aj+1,2k−1 ∪Aj+1,2k for each j ≥1 and k = 1, . . . , 2j. Let Gj := (k −1)/2j on
Ajk for k = 1, . . . , 2j. Then µ◦G−1
j
is uniformly distributed over the points
(k −1)/2j for k = 1, . . . , 2j. As j →∞, Gj converges uniformly to a µ-
measurable function G. So the probability laws µ◦G−1
j
converge to µ◦G−1
with the density ξG = 1[0,1], completing the proof of the proposition.
2
Proposition A.6. For any nonatomic ﬁnite measure space (Ω, S, µ) and 1 ≤
s < ∞, bounded elements of Dλ are dense in Ls(Ω, S, µ).
Proof. We know that µ-simple functions h := Pk
i=1 ci1Ai are dense. By Propo-
sition A.5, for any δ > 0 and i = 1, . . . , k, there is a µ-measurable function
fi on Ai such that for the restriction µi of µ to Ai, µi◦f −1
i
has density
µ(Ai)1[ci,ci+δ]/δ with respect to Lebesgue measure. Let G := Pk
i=1 fi1Ai.
Then ∥G −h∥s ≤δµ(Ω)1/s and µ◦G−1 has density ξG ≤µ(Ω)/δ < ∞. The
proof of the proposition is complete.
2
The following is used to prove the necessity of a suitable measurability
assumption on Nemytskii operators acting on Lp spaces (Theorem 7.13(c)).
Proposition A.7. Let (Ω, S, µ) be any nonatomic probability space and let
Q be any probability measure on the Borel sets of R. Then there is a G ∈
L0(Ω, S, µ) such that µ◦G−1 = Q.
Proof. By Proposition A.5, take H ∈L0(Ω, S, µ) such that µ◦H−1 = U[0, 1]
(Lebesgue measure restricted to [0, 1]). Let F(x) := Q((−∞, x]) for all x ∈R
and F ←(y) := inf{x: F(x) ≥y} for 0 < y < 1. Then U[0, 1]◦(F ←)−1 = Q [53,
Proposition 9.1.2]. Since F ←is Borel measurable, G := F ←◦H ∈L0(Ω, S, µ)
and µ◦G−1 = Q.
2

648
Appendix Nonatomic Measure Spaces
The following is used to show that continuity of a Nemytskii operator
implies its boundedness and that several smoothness properties of Nemytskii
operators valid on a nonempty open subset of Ls can be extended to all of
Ls.
Proposition A.8. Let (Ω, S, µ) be a nonatomic σ-ﬁnite measure space. Let
g ∈L1(Ω, S, µ), g ≥0, and ∫g dµ > 0. For each E ∈S, let ν(E) := ∫E g dµ.
Then (Ω, S, ν) is a nonatomic ﬁnite measure space.
Proof. Clearly ν is a ﬁnite measure. Suppose that A is an atom of ν. Then
ν(A) > 0 and µ(A) > 0. Let B := {ω ∈A: g(ω) ̸= 0}. Then µ(B) > 0. Take
C ∈S such that C ⊂B and 0 < µ(C) < µ(B). Then both ν(C) > 0 and
ν(A \ C) = ν(B \ C) > 0, a contradiction, proving that ν is nonatomic.
2
Proposition A.9. Let (Ω, S, µ) be a nonatomic ﬁnite measure space with
µ(Ω) > 0, and let 1 ≤s < ∞. For each c > 0 and h ∈Ls(Ω, S, µ) such that
∥h∥s > c there exists a partition {Ai}n
i=0 of Ωinto measurable sets such that
∫Ai |h|s dµ = ∥h∥s
s/(n + 1) ∈(cs/2, cs] for i = 0, . . . , n.
Proof. Let g := |h|s and apply Proposition A.8. Then (Ω, S, ν) is nonatomic.
Let n be the unique positive integer such that ncs < ∥h∥s
s ≤(n + 1)cs. Then
the desired partition {Ai}n
i=0 of Ωexists by Corollary A.2.
2
Notes. The statement of Proposition A.1 is [53, §3.5 Problem 11] and [87, §41
Problem 2].
Regarding Proposition A.3, it is known, e.g. Cohn [34, Corollary 8.6.4],
that if a measurable space (Ω, S) is separated and S is countably generated
then there exists a metric d on Ωfor which it is separable and S is the Borel
σ-algebra. Thus the “particular” case is not really special.

References
1. L. V. Ahlfors. Complex Analysis. 2d ed., McGraw-Hill, New York, 1966.
2. A. Alexiewicz and W. Orlicz. Analytic operations in real Banach spaces. Studia
Math. 14 (1954), 57–78.
3. J. Appell and P. P. Zabrejko. Nonlinear Superposition Operators. Cambridge
University Press, 1990.
4. J. Appell and P. P. Zabrejko. On the degeneration of the class of diﬀerentiable
superposition operators in function spaces. Analysis 7 (1987), 305–312.
5. A. Baernstein. On the Fourier series of functions of bounded Φ-variation. Studia
Math. 42 (1972), 243–248.
6. S. Banach. Sur les op´erations dans les ensembles abstraits et leur application
aux ´equations int´egrales. Fund. Math. 3 (1922), 133–181.
7. S.
Banach.
Teorja
Operacyj,
tom
I.
Operacje
Liniowe
(in
Polish).
Kasa im. Mianowskiego, Warszawa, 1931. Web address of a photocopy:
http://banach.univ.gda.pl/teoria-operacji-pol.html
8. S. Banach. Th´eorie des op´erations lin´eaires. Monograﬁe Matematyczne 1.
PWN, Warszawa, 1932.
9. S. Banach. ¨Uber homogene Polynome in (L2). Studia Math. 7 (1938), 36–44.
10. N. K. Bari (Bary). A Treatise on Trigonometric Series. 2 vols., Fizmatgiz,
Moscow, 1961; transl. by M. F. Mullins, Macmillan, New York, 1964.
11. R. G. Bartle. A general bilinear vector integral. Studia Math. 15 (1956), 337–
352.
12. A. F. Beardon. Complex Analysis. Wiley, Chichester, 1979.
13. V. A. Belﬁand R. S. Doran. Norm and spectral characterizations in Banach
algebras. L’Enseignement Math´ematique (Ser. 2) 26, fasc. 1-2 (1981), 103–130.
14. A. Beurling. Analyse harmonique de pseudomesures. Int´egration par rapport
aux pseudomesures. C. R. Acad. Sci. Paris 258 (1964), 1984–1987.
15. N. H. Bingham, C. M. Goldie and J. L. Teugels. Regular Variation. Encyclo-
pedia of Math. and its Appl., Cambridge University Press, 1987.
16. Garrett Birkhoﬀ. Integration of functions with values in a Banach space. Trans.
Amer. Math. Soc. 38 (1935), 357–378.
17. Garrett Birkhoﬀ. On product integration. J. Math. Phys. (MIT, Cambridge,
Mass.), 16 (1937), 104–132.
18. Z. Birnbaum and W. Orlicz. ¨Uber die Verallgemeinerung des Begriﬀes der
zueinander konjugierten Potenzen. Studia Math. 3 (1931), 1–67.

650
References
19. R. M. Blumenthal and R. K. Getoor. Sample functions of stochastic processes
with stationary independent increments. J. Math. and Mech. 10 (1961), 493–
516.
20. J. Bochnak and J. Siciak. Polynomials and multilinear mappings in topological
vector spaces. Studia Math. 39 (1971), 59–76.
21. S. Bochner. Integration von Funktionen, deren Werte die Elemente eines Vek-
torraumes sind. Fund. Math. 20 (1933), 262-276.
22. F. F. Bonsall and J. Duncan. Complete Normed Algebras. Ergebnisse der Math-
ematik und ihrer Grenzgebiete. Berlin, Springer-Verlag, 1973.
23. L. Breiman. Probability. Addison-Wesley, Reading, Mass., 1968.
24. J. Bretagnolle. p-variation de fonctions al´eatoires. In: S´eminaire de Probabilit´es
VI, Lect. Notes in Math. (Springer-Verlag) 258 (1972), 51–71.
25. J. Bretagnolle and P. Massart. Hungarian constructions from the nonasymp-
totic viewpoint. Ann. Probab. 17 (1989), 239–256.
26. M. Brokate and F. Colonius (1990). Linearizing equations with state-dependent
delays. Appl. Math. Optimiz. 21, 45–52.
27. J. C. Burkill. Diﬀerential properties of Young-Stieltjes integrals. J. London
Math. Soc. 23 (1948), 22–28.
28. T. Carleman. ¨Uber die Fourierkoeﬃzienten einer stetigen Funktion. Acta Math.
(Sweden) 41 (1918), 377–384.
29. L. Carleson. On convergence and growth of partial sums of Fourier series. Acta
Math. (Sweden) 116 (1966), 135–157.
30. H. Cartan. Calcul diﬀer´entiel. Hermann, Paris, 1967.
31. A. Cena. Geometric structures on the non-parametric statistical manifold. Doc-
toral thesis, Univ. degli studi di Milano, 2002-2003.
32. S. B. Chae. Holomorphy and Calculus in Normed Spaces. Dekker, New York,
1985.
33. J. Ciemnoczo lowski and W. Orlicz. Composing functions of bounded φ-
variation. Proc. Amer. Math. Soc. 96 (1986), 431–436.
34. D. L. Cohn. Measure Theory. Birkh¨auser, Boston, 1980.
35. Ju. L. Dalecki˘ı and M. G. Kre˘ın. Stability of Solutions of Diﬀerential Equations
in Banach Space. Amer. Math. Soc. Transls. of Math. Monographs 43, 1974.
Russian orig. Nauka, Moscow, 1970.
36. H. G. Dales. Banach Algebras and Automatic Continuity. Clarendon Press,
Oxford, 2000.
37. P. J. Daniell. A general form of integral. Ann. Math. (Ser. 2) 19 (1918), 279–
294.
38. P. J. Davis. Gamma Function and Related Functions. In: Handbook of Mathe-
matical Functions (M. Abramowitz and I. A. Stegun, eds.), chap. 6, pp. 253–
293. Dover, New York, 1970.
39. C. Dellacherie and P.-A. Meyer. Probabilities and potential B. Transl. by J. P.
Wilson. North-Holland, Amsterdam, 1982.
40. E. DiBenedetto. Real Analysis. Birkh¨auser, Boston, 2002.
41. J. Diestel and J. J. Uhl. Vector Measures. Mathematical Surveys 15, AMS,
Providence, Rhode Island, 1977.
42. J. Dieudonn´e. Foundations of Modern Analysis. Academic Press, New York,
1960.
43. R. L. Dobrushin. Generalization of Kolmogorov’s equations for Markov pro-
cesses with a ﬁnite number of possible states (in Russian). Mat. Sb. 33 (1953),
567–596.

References
651
44. C. Dol´eans-Dade and P. A. Meyer. Int´egrales stochastiques par rapport aux
martingales locales. In: S´eminaire de Probabilit´es IV, Univ. Strasbourg, Lecture
Notes in Math. (Springer-Verlag) 124 (1970), 77–107.
45. J. D. Dollard and C. N. Friedman. Product Integration with Applications to
Diﬀerential Equations. Encyclopedia of Math. and its Appl., Vol. 10, Addison-
Wesley, Reading, Massachusetts, 1979.
46. J. L. Doob. Stochastic Processes. Wiley, New York, 1953.
47. R. M. Dudley. Sample functions of the Gaussian process. Ann. Probab. 1 (1973),
66–103.
48. R. M. Dudley. Wiener functionals as Itˆo integrals. Ann. Probab. 5 (1977), 140–
141.
49. R. M. Dudley. Fr´echet diﬀerentiability, p-variation and uniform Donsker
classes. Ann. Probab. 20 (1992), 1968–1982.
50. R. M. Dudley. The order of the remainder in derivatives of composition and
inverse operators for p-variation norms. Ann. Statist. 22 (1994), 1–20.
51. R. M. Dudley. Empirical processes and p-variation. In: Festschrift for Lucien
Le Cam (D. Pollard, E. Torgersen, and G. L. Yang, eds.), 219–233. Springer-
Verlag, New York, 1997.
52. R. M. Dudley. Uniform Central Limit Theorems. Cambridge University Press,
1999.
53. R. M. Dudley. Real Analysis and Probability. 2d ed., Cambridge University
Press, 2002.
54. R. M. Dudley and R. Norvaiˇsa. Diﬀerentiability of Six Operators on Nonsmooth
Functions and p-Variation. Lecture Notes in Math. (Springer-Verlag) 1703
(1999).
55. R. M. Dudley and R. Norvaiˇsa. An Introduction to p-variation and Young
Integrals. MaPhySto Lecture Notes no. 1, 1998, Aarhus, Denmark.
56. N. Dunford. Integration of abstract functions (abstract). Bull. Amer. Math.
Soc. 42 (1936), 178.
57. N. Dunford and J. T. Schwartz. Linear Operators, Part I: General Theory.
Wiley Classics Library Ed., New York, 1988. 1st ed. 1958.
58. J. Durdil. On the diﬀerentiability of Urysohn and Nemyckij operators. Com-
ment. Math. Univ. Carolinae 8 (1967), 515–553.
59. E. B. Dynkin. Theory of Markov Processes. English transl. by D. E. Brown,
ed. T. K¨ovary. Prentice-Hall, Englewood Cliﬀs, NJ, 1961. Russian orig. Osno-
vaniy Teorii Markovskikh Protsessov. Fizmatgiz, Moscow, 1959. German transl.
by Joseph Wloka, Die Grundlagen der Theorie der Markoﬀschen Prozesse.
Springer-Verlag, Berlin, 1961. French transl. by Ch. Sarthou, Th´eorie des pro-
cessus markoviens. Dunod, Paris, 1963.
60. A. M. D’yaˇckov. Conditions for the existence of Stieltjes integral of functions
of bounded generalized variation. Anal. Math. (Budapest) 14 (1988), 295–313.
61. D. G. Ebin and J. Marsden. Groups of diﬀeomorphisms and the motion of an
incompressible ﬂuid. Ann. Math. 92 (1970), 102–163.
62. C. H. Edwards, Jr. Advanced Calculus of Several Variables. Dover, New York,
1973.
63. R. E. Edwards. Fourier Series: A Modern Introduction. 2d ed., Springer-Verlag,
New York, 1982.
64. W. Feller. An Introduction to Probability Theory and Its Applications, vol. 2,
2d ed. Wiley, New York, 1971.

652
References
65. L. T. Fernholz. von Mises Calculus for Statistical Functionals. Lect. Notes in
Statist. (Springer-Verlag) 19 (1983).
66.
∗B. de Finetti and M. Jacob. Sull’ integrale di Stieltjes-Riemann. Giorn. Isti-
tuto Ital. Attuari 6 (1935), 303–319.
67. D. L. Fisk. Quasi-martingales. Trans. Amer. Math. Soc. 120 (1965), 369–389.
68. M. Fr´echet. La notion de diﬀ´erentielle dans l’analyse g´en´erale. C. R. Acad. Sc.
Paris 180 (1925), 806–809.
69. M. Fr´echet. La notion de diﬀ´erentielle dans l’analyse g´en´erale. Ann. Ecole
Norm. Sup. 42 (1925), 293–323.
70. M. A. Freedman. Operators of p-variation and the evolution representation
problem. Trans. Amer. Math. Soc. 279 (1983), 95–112.
71. B. Fristedt. Sample functions of stochastic processes with stationary, indepen-
dent increments. In: Advances in Probability and Related Topics, 3 241–396.
Dekker, New York, 1974.
72. B. Fristedt and S. J. Taylor. Strong variation for the sample functions of a
stable process. Duke Math. J. 40 (1973), 259–278.
73. B. M. Garay. Hyperbolic structures in ODE’s and their discretization. In
Nonlinear Analysis and Boundary Value Problems for ODEs (Proc. CISM,
Udine, 1995; F. Zanolin, ed.). CISM Courses and Lectures 371 (1996), 149–
174. Springer-Verlag, Vienna.
74. F. W. Gehring. A study of α-variation. I. Trans. Amer. Math. Soc. 76 (1954),
420–443.
75. I. M. Gelfand. On normed rings. Dokl. Akad. Nauk SSSR 23 (1939), 430–432.
In: Izrail M. Gelfand: Collected Papers 1 (S. G. Gindikin et al., eds.), 169–171.
Springer-Verlag, Berlin, 1987.
76. I. M. Gelfand. Normierte Ringe. Rec. Math. (Matem. Sbornik) N. S. 9 (1941),
3–24. In: Izrail M. Gelfand: Collected Papers 1 (S. G. Gindikin et al., eds.),
181–201. Springer-Verlag, Berlin, 1987.
77. I. M. Gelfand, D. Raikov, and G. Shilov. Commutative Normed Rings. English
ed. Chelsea, New York, 1964.
78. I. I. Gihman [Gikhman] and A. V. Skorohod [Skorokhod]. Introduction to the
Theory of Random Processes. W. B. Saunders, Philadelphia, 1969.
79. I. I. Gihman and A. V. Skorohod. The Theory of Stochastic Processes I, II,
III. Fizmatgiz, Moscow, 1971, 1973, 1975; English transl. by S. Kotz, Springer-
Verlag, Berlin, 1974, 1975, 1979.
80. R. D. Gill. Lectures on Survival Analysis. In: Ecole d’´et´e de Probabilit´es de
Saint-Flour (P. Bernard, ed.), Lect. Notes in Math. (Springer-Verlag) 1581
(1994), 115–241.
81. R. D. Gill and S. Johansen. A survey of product-integration with a view toward
application in survival analysis. Ann. Statist. 18 (1990), 1501–1555.
82. E. Ch. Gochman. The Stieltjes integral and its applications (in Russian).
Moscow, GIFML, 1958.
83. B. I. Golubov. Functions of bounded p-variation (in Russian). Izv. Akad. Nauk
SSSR Ser. Mat. 32 (1968), 837–858. English transl. in: Math. USSR Izv. 2
(1968), 799–819.
84. R. A. Gordon. The Integrals of Lebesgue, Denjoy, Perron, and Henstock. Amer.
Math. Soc., Providence, 1994.
85. A. Gray. Diﬀerentiation of composites with respect to a parameter. J. Austral.
Math. Soc. (Ser. A) 19 (1975), 121–128.

References
653
86. R. E. Greene and S. G. Krantz. Function Theory of One Complex Variable.
2d ed., Graduate Studies in Mathematics 40, AMS, Providence, Rhode Island,
2002.
87. P. Halmos. Measure Theory. Van Nostrand, Princeton, 1950.
88. F. Hartung and J. Turi. On diﬀerentiability of solutions with respect to param-
eters in state-dependent delay equations. J. Diﬀerential Equations 135 (1997),
192–237.
89. F. Hausdorﬀ. Zur Theorie der linearen metrischen R¨aume. J. Reine Angew.
Math. 167 (1932), 294–311.
90. R. Henstock. Deﬁnitions of Riemann type of the variational integrals. Proc.
London Math. Soc. (3) 11 (1961), 402–418.
91. R. Henstock. Theory of Integration. Butterworths, London, 1963.
92. R. Henstock. The General Theory of Integration. Clarendon Press, Oxford,
1991.
93. E. Hewitt. Integration by parts for Stieltjes integrals. Amer. Math. Monthly
67 (1960), 419–423.
94. T. H. Hildebrandt. Deﬁnitions of Stieltjes integrals of the Riemann type. Amer.
Math. Monthly 45 (1938), 265–278.
95. T. H. Hildebrandt. Integration in abstract spaces. Bull. Amer. Math. Soc. 59
(1953), 111–139.
96. T. H. Hildebrandt. On systems of linear diﬀerentio-Stieltjes-integral equations.
Illinois J. Math. 3 (1959), 352–373.
97. T. H. Hildebrandt. Introduction to the Theory of Integration. Academic Press,
New York, 1963.
98. W. Hoeﬀding. Probability inequalities for sums of bounded random variables.
J. Amer. Statist. Assoc. 58, 13–30.
99. J. Hoﬀmann-Jørgensen. Probability with a View toward Statistics, Vols. I, II.
Chapman & Hall, New York, 1994.
100. C. S. H¨onig. Volterra Stieltjes-Integral Equations. In: Functional Diﬀerential
Equations and Bifurcation (A. F. Iz´e, ed.), Lect. Notes in Math. (Springer-
Verlag) 799 (1980), 173–216.
101. Yen-Chin Huang. Empirical distribution function statistics, speed of conver-
gence, and p-variation. Ph.D. thesis, Massachusetts Institute of Technology,
1994.
102. Yen-Chin Huang. Speed of convergence of classical empirical processes in p-
variation norm. Preprint, 1998.
103. Yen-Chin Huang and R. M. Dudley. Speed of convergence of classical empirical
processes in p-variation norm. Ann. Probab. 29 (2001), 1625–1636.
104. R. A. Hunt. On the convergence of Fourier series. In: Orthogonal Expansions
and Their Continuous Analogues (D. T. Haimo, ed.), 235–255. Southern Illinois
Univ. Press [Carbondale], 1968.
105. E. L. Ince. Ordinary Diﬀerential Equations. Longmans, London, 1927. Repr.
Dover, New York, 1956.
106. K. Itˆo. On a formula concerning stochastic diﬀerentials. Nagoya Math. J. 3
(1951), 55–65. Reprinted in: Kiyosi Itˆo. Selected papers (D. W. Stroock, S. R.
S. Varadhan eds.), 169–179. Springer-Verlag, New York, 1987.
107. K. Itˆo. Stochastic processes. Lecture Notes Series 16. Aarhus Universitet, 1969.
108. K. Itˆo. Stochastic diﬀerentials. Applied Mathematics and Optimization 1
(1974), 374–381.

654
References
109. K. Itˆo and H. P. McKean, Jr. Diﬀusion Processes and their Sample Paths.
Academic Press, New York, 1965.
110. N. C. Jain and D. Monrad. Gaussian measures in Bp. Ann. Probab. 11 (1983),
46–57.
111. J. Jarn´ık and J. Kurzweil. A general form of the product integral and linear
ordinary diﬀerential equations. Czechoslovak Math. J. 37 (1987), 642–659.
112. O. Kallenberg. Foundations of Modern Probability. 2d ed., Springer-Verlag,
New York, 2002.
113. H. S. Kaltenborn. Existence conditions and a substitution theorem for Stieltjes
mean integrals. Tohoku Math. J. 44 (1938), 1–11.
114. Y. Katznelson. An Introduction to Harmonic Analysis. Wiley, New York, 1968.
115. T. Kawada and N. Kˆono. On the variation of Gaussian processes. In: Proc.
Second Japan-USSR Symp. on Probab. Theory (G. Maruyama and Yu. V.
Prokhorov, eds.), Lect. Notes in Math. (Springer-Verlag) 330 (1973), 176–192.
116. J. R. Kinney. Continuity properties of sample functions of Markov processes.
Trans. Amer. Math. Soc. 74 (1953), 280–302.
117. P. Kirwan. On an error by Angus E. Taylor. Irish Math. Soc. Bull. 44 (2000),
66–75.
118. I. Kluv´anek. Integration Structures. Proceedings of the Centre for Mathematical
Analysis, Australian National University, Vol. 18, 1988.
119. A. N. Kolmogorov. Une s´erie de Fourier-Lebesgue divergente partout. C. R.
Acad. Sci. Paris 183 (1926), 1327–1328.
120. A. N. Kolmogorov. Untersuchungen ¨uber den Integralbegriﬀ. Math. Ann. 103
(1930), pp. 654–696. Russian transl. by P. Osvald in: A. N. Kolmogorov. Se-
lected Works. Mathematics and Mechanics. Nauka, Moscow, 1985, pp. 96–134.
English transl. by V. M. Volosov in: Selected Works of A. N. Kolmogorov. Vol.
I. Mathematics and mechanics. (V. M. Tikhomirov, ed.) Kluwer, Dordrecht,
1993, pp. 100–143.
121. J. Koml´os, P. Major, and G. Tusn´ady. An approximation of partial sums of
independent RV’-s and the sample DF. I. Z. Wahrscheinlichkeitstheorie verw.
Geb. 32 (1975), 111–131.
122.
∗Gyula K¨onig. On the theory of deﬁnite integrals (in Hungarian). Math. ´es
Term. tud. ´Ertesit¨o 15 (1897), 380–394.
123. J. Kope´c and J. Musielak. On the estimation of the norm of the n-linear sym-
metric operation. Studia Math. 15 (1956), 29–30.
124. G. L. Krabbe. Integration with respect to operator-valued functions. Bull.
Amer. Math. Soc. 67 (1961), 214–218.
125. G. L. Krabbe. Integration with respect to operator-valued functions. Acta Sci.
Math. (Szeged) 22 (1961), 301–319.
126. S. G. Krantz. A Panorama of Harmonic Analysis. Carus Math. Monographs,
No. 27. Math. Assoc. America, USA, 1999.
127. M. A. Krasnosel’ski˘ı. Topological Methods in the Theory of Nonlinear Integral
Equations (in Russian). Gostekhizdat, Moscow, 1956. English transl. Macmil-
lan, New York, 1964.
128. M. A. Krasnosel’ski˘ı and Ya. B. Ruticki˘ı. Convex Functions and Orlicz Spaces
(in Russian). Fizmatgiz, Moscow, 1958. English transl. by L. F. Boron. Noord-
hoﬀ, Groningen, 1961.
129. J. Kurzweil. Generalized ordinary diﬀerential equations and continuous depen-
dence on a parameter. Czechoslovak Math. J. 7 (1957), 418–446.

References
655
130. J. Kurzweil. On integration by parts. Czechoslovak Math. J. 8 (1958), 356–359.
131. J. Kurzweil. Addition to my paper “Generalized ordinary diﬀerential equations
and continuous dependence on a parameter.” Czechoslovak Math. J. 9 (1959),
564–573.
132. T. L. Lai. Reproducing kernel Hilbert spaces and the law of the iterated log-
arithm for Gaussian processes. Z. Wahrscheinlichkeitstheorie verw. Geb. 29
(1974), 7–19.
133. R. Larsen. Banach Algebras: An Introduction. Dekker, New York, 1973.
134. H. Lebesgue. Sur l’int´egrale de Stieltjes et sur les op´erations fonctionnelles
lin´eaires. C. R. Acad. Sci. Paris 150 (1910), 86–88.
135. M. Ledoux. Isoperimetry and Gaussian analysis. In: Lectures on Probabil-
ity Theory and Statistics, Saint-Flour, 1994, Lect. Notes in Math. (Springer-
Verlag) 1648 (1996), 165–294.
136. M. Ledoux and M. Talagrand. Probability in Banach Spaces. Springer-Verlag,
Berlin, 1991.
137. E. L. Lehmann. Testing Statistical Hypotheses. 2d ed., Wiley, New York, 1986,
repr. Springer-Verlag, New York, 1997.
138. R. Le´sniewicz. On Hardy-Orlicz spaces, I. Comment. Math. Prace Mat. 15
(1971), 3–56.
139. R. Le´sniewicz and W. Orlicz. On generalized variations (II). Studia Math. 45
(1973), 71–109.
140. P. L´evy. Le mouvement brownien plan. Amer. J. Math. 62 (1940), 487–550.
141. P. L´evy. Wiener’s random function, and other Laplacian random functions. In:
Proc. 2d Berkeley Symp. Math. Statist. Probability (J. Neyman, ed.), 171–187.
Univ. Calif. Press, Berkeley and Los Angeles, 1951.
142. J. Lindenstrauss and L. Tzafriri. Classical Banach Spaces I. Sequence Spaces.
Springer-Verlag, Berlin, 1977.
143. R. Lipschitz. De explicatione per series trigonometricas instituenda functiorum
unius variabilis arbitrariarum . . . J. reine angew. Math. 63 (1864), 296–308.
French. transl. by P. Montel in: Acta Math. (Sweden) 36 (1912-13), 281–295.
144. E. R. Love. The reﬁnement-Ross-Riemann-Stieltjes (R3S) integral. In: Analy-
sis, Geometry and Groups: A Riemann Legacy Volume (H. M. Srivastava and
Th. M. Rassias, eds.), 289–312. Hadronic Press, Palm Harbor, FL, 1993.
145. E. R. Love. Integration by parts and other theorems for R3S-integrals. Real
Anal. Exchange 24 (1998/9), 315–336.
146. E. R. Love and L. C. Young. Sur une classe de fonctionelles lin´eaires. Fund.
Math. 28 (1937), 243–257.
147. E. R. Love and L. C. Young. On fractional integration by parts. Proc. London
Math. Soc. (Ser. 2) 44 (1938), 1–35.
148. W. A. J. Luxemburg. Banach function spaces. Ph.D. Dissertation, Delft, 1955.
149. W. A. J. Luxemburg and A. C. Zaanen. Notes on Banach function spaces I.
Indag. Math. 7 = Akad. Wetenschappen Amsterdam Proc. Ser. A Math. 66
(1963), 135–147.
150. T. Lyons. On the non-existence of path integrals. Proc. Roy. Soc. Lond. (Ser.
A) 432 (1991), 281–290.
151. T. Lyons. Diﬀerential equations driven by rough signals (I): an extension of an
inequality of L. C. Young. Math. Res. Letters 1 (1994), 451–464.
152. J. S. MacNerney. Stieltjes integrals in linear spaces. Ann. Math. 61 (1955),
354–367.

656
References
153. J. S. MacNerney. Integral equations and semigroups. Illinois J. Math. 7 (1963),
148–173.
154. P. Major. On the invariance principle for sums of independent identically dis-
tributed random variables. J. Multivariate Anal. 8 (1978), 487–517.
155. M. Manstaviˇcius. p-variation of strong Markov processes. Ann. Probab. 32
(2004), 2053–2066.
156. J. Marcinkiewicz. On a class of functions and their Fourier series. C. R. Soc.
Sci. Varsovie 26 (1934), 71–77. Reprinted in: J. Marcinkiewicz. Collected Pa-
pers (A. Zygmund, ed.), 36–41. Pa´nstwowe Wydawnictwo Naukowe, Warsaw,
1964.
157. J. E. Marsden and A. J. Tromba. Vector Calculus. 2d ed., W. H. Freeman, San
Francisco, 1981.
158. P. R. Masani. Multiplicative Riemann integration in normed rings. Trans.
Amer. Math. Soc. 61 (1947), 147–192.
159. P. R. Masani. The place of multiplicative integration in modern analysis. Ap-
pendix II in [45].
160. P. Massart. The tight constant in the Dvoretzky–Kiefer–Wolfowitz inequality.
Ann. Probab. 18 (1990), 1269–1283.
161. J. Matkowski and J. Mi´s. On a characterization of Lipschitzian operators of
substitution in the space BV [a, b]. Math. Nachr. 117 (1984), 155–159.
162. S. Mazur. Sur les anneaux lin´eaires. C. R. Acad. Sci. Paris 207 (1938), 1025–
1027.
163. S. Mazur and W. Orlicz. Grundlegende Eigenschaften der polynomischen Op-
erationen, I, II. Studia Math. 5 (1935), 50–68, 179–189.
164. H. P. McKean, Jr. Stochastic Integrals. Academic Press, New York, 1969.
165. R. M. McLeod. The Generalized Riemann Integral. Carus Math. Monographs,
No. 20. Math. Assoc. America, 1980.
166. E. J. McShane. A Riemann-type Integral that Includes Lebesgues-Stieltjes,
Bochner and Stochastic Integrals. Memoirs AMS, 88 (1969). Providence, Rhode
Island.
167. E. J. McShane. Uniﬁed Integration. Academic Press, Orlando, 1983.
168. F. A. Medvedev. Development of the Concept of Integral (in Russian). Nauka,
Moscow, 1974.
169. P.-A. Meyer. Probability and Potentials. Blaisdell, Waltham, MA, 1966.
170. P. Meyer-Nieberg. Banach Lattices. Springer-Verlag, Berlin, 1991.
171. J. Milnor. Remarks on inﬁnite-dimensional Lie groups. In: Relativit´e, groupes
et topologie II, Les Houches 1983 (B. S. DeWitt and R. Stora, eds.), 1007–1057.
North-Holland, Amsterdam, 1984.
172. I. Monroe. On the γ-variation of processes with stationary independent incre-
ments. Ann. Math. Statist. 43 (1972), 1213–1220.
173. I. Monroe. On embedding right continuous martingales in Brownian motion.
Ann. Math. Statist. 43 (1972), 1293–1311.
174. I. Monroe. Processes that can be embedded in Brownian motion. Ann. Probab.
6 (1978), 42–56.
175. E. H. Moore. Deﬁnition of limit in general integral analysis. Proc. Nat. Acad.
Sci. USA 1 (1915), 628.
176. J. Musielak and W. Orlicz. On generalized variations (I). Studia Math. 18
(1959), 11–41.

References
657
177. M. A. Naimark. Normed Algebras. Transl. from the 2d Russian ed. by L. F.
Boron. Wolters-Noordhoﬀ, Groningen, 1972. Normirovannye Kol’tsa. 2d ed.
revised, Nauka, Moscow, 1968.
178. M. H. A. Newman. Elements of the Topology of Plane Sets of Points. 2d ed.,
Cambridge University Press, 1951.
179. T. Nguyen. A lower bound on the radius of analyticity of a power series in a
real Banach space. Studia Math. 191 (2009), 171–179,
180. M. Nisio. On the extreme values of Gaussian processes. Osaka J. Math. 4
(1967), 313–326.
181. H. Oodaira. On Strassen’s version of the law of the iterated logarithm for
Gaussian processes. Z. Wahrscheinlichkeitstheorie verw. Geb. 21 (1972), 289–
299.
182. W. Orlicz. Beitr¨age zur Theorie der Orthogonalentwicklungen (III). Bull. Acad.
Pol. Sci. 1932, 229–238.
183. G. Peano. Int´egration par s´eries des ´equations diﬀ´erentielles lin´eaires. Math.
Ann. 32 (1888), 450–456.
184. Lee Peng-Yee. Lanzhou Lectures on Henstock Integration. World Scientiﬁc, Sin-
gapore, 1989.
185. W. F. Pfeﬀer. The Riemann Approach to Integration: Local Geometric Theory.
Cambridge University Press, 1993.
186. ´E. Picard. Sur l’application des m´ethodes d’approximation successives a l’´etude
de certaines ´equations diﬀ´erentielles ordinaires. J. Math. Pures et Appliqu´ees
(Ser. 4) 9 (1893), 217–271.
187. S. Pollard. The Stieltjes’ integral and its generalisations. Quart. J. Pure Appl.
Math. 49 (1923), 73–138.
188. A. V. Ponosov. On the Nemytskij conjecture (in Russian). Doklady Akad. Nauk
SSSR 289 (1986), 1308–1311. English transl. in: Soviet Math. Doklady 34
(1987), 231–233.
189. Jinghua Qian. The p-variation of partial sum processes and the empirical pro-
cess. Ann. Probab. 26 (1998), 1370–1383.
190. J. Radon. Theorie und Anwendungen der absolut additiven Mengenfunktionen.
Sitzungsber. K. Akad. Wiss. Wien, Math.-Naturwiss. Kl., Abt. IIa, 122 (1913),
1295–1438.
191. G. Rasch. Zur Theorie und Anwendung des Produktintegrals. J. reine angew.
Math. 171 (1934), 65–119.
192. J. A. Reeds III. On the deﬁnition of von Mises functionals. Ph.D. thesis, Statis-
tics, Harvard University (1976).
193. F. Riesz. Sur les op´erations fonctionnelles lin´eaires. C. R. Acad. Sci. Paris 149
(1909), 974–977.
194. P. Rosenthal. Review of Shapiro (1993) and Singh and Manhas (1993). Bull.
Amer. Math. Soc. 32 (1995), 150–153.
195. K. A. Ross. Elementary Analysis: The Theory of Calculus. Springer-Verlag,
New York, 1980.
196. W. T. Ross and H. S. Shapiro. Generalized Analytic Continuation. Amer. Math.
Soc. University Lect. Ser. 25, 2002.
197. A. I. Rubinˇste˘ın. On ω-lacunary series and functions of the class Hω (in Rus-
sian). Mat. Sb. (N. S.) 65 (107) (1964), 239–271.
198. W. Rudin. Real and Complex Analysis. 2d ed., McGraw-Hill, New York, 1974.
199. T. Runst and W. Sickel. Sobolev Spaces of Fractional Order, Nemytskij Oper-
ators, and Nonlinear Partial Diﬀerential Equations. de Gruyter, Berlin, 1996.

658
References
200. A. F. Ruston. Fredholm Theory in Banach Spaces. Cambridge University Press,
1986.
201. S. Saks. Theory of the Integral. 2d ed. English transl. by L. C. Young. Hafner,
New York. Repr. corrected Dover, New York, 1964.
202. R. Salem. Sur un test g´en´eral pour la convergence uniforme des s´eries de
Fourier. C. R. Acad. Sci. Paris 207 (1938), 662–665. Repr. as: La convergence
uniforme des s´eries de Fourier. Chap. VI. Essais sur les s´eries trigonom´etriques.
Ensembles et fonctions. Expos´es publi´es par A. Denjoy. Actual. Sci. et Industr.,
862, Hermann, Paris, 1940, and in: Rapha¨el Salem Œuvres Math´ematiques, pp.
156–161. Hermann, Paris, 1967.
203. G. Samorodnitsky and M. S. Taqqu. Stable Non-Gaussian Random Processes.
Stochastic Models with Inﬁnite Variance. Chapman & Hall, New York, 1994.
204. K. Sato. L´evy Processes and Inﬁnitely Divisible Distributions. Cambridge Uni-
versity Press, 1999.
205. R. Schatten. A Theory of Cross-Spaces. Annals of Mathematics Studies, 26.
Princeton University Press, 1950.
206. L. Schlesinger. Neue Grundlagen f¨ur einen Inﬁnitesimalkalkul der Matrizen.
Math. Z. 33 (1931), 33–61.
207. L. Schlesinger. Weitere Beitr¨age zum Inﬁnitesimalkalkul der Matrizen. Math.
Z. 35 (1932), 485–501.
208. G. Schmidt. On multiplicative Lebesgue integration and families of evolution
operators. Math. Scand. 29 (1971), 113–133.
209. I. J. Schoenberg. On certain metric spaces arising from Euclidean spaces by a
change of metric and their imbedding in Hilbert space. Ann. Math (Ser. 2) 38
(1937), 787–793.
210. I. J. Schoenberg. Metric spaces and positive deﬁnite functions. Trans. Amer.
Math. Soc. 44 (1938), 522–536. Reprinted in: I. J. Schoenberg. Selected Papers
(Carl de Boor, ed.), Vol. 1, 100–114. Birkh¨auser, Boston, 1988.
211. ˇS. Schwabik. On the relation between Young’s and Kurzweil’s concept of Stielt-
jes integral. ˇCasopis Pˇest. Mat. 98 (1973), 237–251.
212. ˇS. Schwabik. The Perron product integral and generalized linear diﬀerential
equations. ˇCasopis Pˇest. Mat. 115 (1990), 368–404.
213. ˇS. Schwabik. Bochner product integration. Math. Bohem. 119 (1994), 305–335.
214. ˇS. Schwabik, M. Tvrd´y and O. Vejvoda. Diﬀerential and Integral Equations.
Reidel, Dordrecht, 1979.
215. H.-U. Schwarz. Banach Lattices and Operators. Teubner, Leipzig, 1984.
216. I. E. Segal and R. A. Kunze. Integrals and Operators. McGraw-Hill, New York.
217. J. H. Shapiro. Composition Operators and Classical Function Theory. Springer-
Verlag, New York, 1993.
218. I. V. Shragin. Conditions for the measurability of superpositions (in Russian).
Doklady Akad. Nauk SSSR 197 (1971), 295–298. English transl. in: Soviet
Math. Doklady 12 (1971), 465–470. Erratum: Soviet Math. Doklady 12 No. 4
(1971), vi.
219. I. V. Shragin. Superpositional measurability (in Russian). Izvestija Vyssh.
Uchebn. Zaved. Mat. 1 (1975), 82–89.
220. I. V. Shragin. On the Carath´eodory conditions (in Russian). Uspekhi Mat.
Nauk 34 3 (1979), 219–220. English transl. in: Russian Math. Surveys 34, 3
(1979), 220–221.
221. R. K. Singh and J. S. Manhas. Composition Operators on Function Spaces.
North-Holland, Amsterdam, 1993.

References
659
222. A. V. Skorohod. On a generalization of the stochastic integral. Theory Probab.
Appl. 20 (1975), 219–233.
223. H. L. Smith. On the existence of the Stieltjes integral. Trans. Amer. Math.
Soc. 27 (1925), 491–515.
224. E. M. Stein and R. Shakarchi. Complex Analysis. Princeton University Press,
Princeton, 2003.
225. J. O. Stevenson. Holomorphy of composition. Bull. Amer. Math. Soc. 80
(1974), 300–303.
226. J. O. Stevenson. Holomorphy of composition. In: Inﬁnite Dimensional Holo-
morphy and Applications (M. C. Matos, ed.), 397–424. North-Holland, Ams-
terdam, 1977.
227.
∗T. J. Stieltjes. Recherches sur les fractions continues. Ann. Fac. Sci. Toulouse
S´er. 1 8 (1894), 1–122; 9 (1895), 1–47.
228. B. Sz´en´assy. History of Mathematics in Hungary until the 20th Century. En-
glish transl. by J. Pokoly, ed. by J. Bogn´ar. Springer-Verlag, New York, 1992.
229. A. E. Taylor. Historical notes on amalyticity as a concept in functional analysis.
In: Problems in Analysis. A Symposium in Honor of Solomon Bochner (R. C.
Gunning, ed.), 325–343. Princeton University Press, Princeton, 1970. Reprinted
in [32].
230. A. E. Taylor. A study of Maurice Fr´echet: III. Fr´echet as analyst, 1909–1930.
Arch. Hist. Exact Sci. 37 (1987), 25–76.
231. S. J. Taylor. Exact asymptotic estimates of Brownian path variation. Duke
Math. J. 39 (1972), 219–241.
232. M. M. Va˘ınberg. On the continuity of some special operators (in Russian).
Doklady Akad. Nauk SSSR 73 (1950), 253–255.
233. M. M. Va˘ınberg. Some questions of the diﬀerential calculus in linear spaces (in
Russian). Uspehi Matem. Nauk (N.S.) 7 (1952), no. 4(50), 55–102.
234. Yu. R. Va˘ınerman. Suﬃcient conditions for existence of the Stieltjes integral
(in Russian). Vestnik Leningrad Univ. 1972 no. 13, 15–20.
235. V. Volterra. Sui fondamenti della teoria delle equazioni diﬀerenziali lineari.
Mem. Soc. Ital. Sci. (XL), ser. III, vol. 6, no. 8, 1887. In: Opere Matematiche
I, 209–289. Accad. Nazionale dei Lincei, Rome, 1954.
236. V. Volterra and B. Hostinsky. Op´erations Inﬁnit´esimales Lin´eaires. Applica-
tions aux ´equations diﬀ´erentielles et fonctionnelles. Gauthier-Villars, Paris,
1938.
237. Wang Sheng-Wang. Diﬀerentiability of the Nemyckii operator. Doklady Akad.
Nauk SSSR 150 (1963), 1198–1201 (in Russian); Sov. Math. Doklady 4 (1963),
834–837.
238. A. J. Ward. The Perron–Stieltjes integral. Math. Z. 41 (1936), 578–604.
239. P. Whittle. Bounds for the moments of linear and quadratic forms in indepen-
dent variables. Theory Probab. Appl. 5 (1960), 302–305.
240. N. Wiener. Diﬀerential-Space. J. Math. Phys. (MIT, Cambridge, Mass.) 2
(1923), 131–174. In: Norbert Wiener: Collected Works 1, 455–498. MIT Press,
Cambridge, 1976.
241. N. Wiener. The quadratic variation of a function and its Fourier coeﬃcients.
J. Math. Phys. (MIT, Cambridge, Mass.) 3 (1924), 72–94. In: Norbert Wiener:
Collected Works 2, 36–58. MIT Press, Cambridge, 1979.
242. Quanhua Xu. Espaces d’interpolation r´eels entre les espaces Vp: propri´et´es
g´eom´etriques et applications probabilistes. In: S´eminaire d’Analyse Fonction-
nelle 1985/1986/1987, Publ. Math. Univ. Paris VII 28 1988, 77–123.

660
References
243. L. C. Young. The Theory of Integration. Cambridge University Press, 1927.
Repr. Stechert-Hafner, New York, 1964.
244. L. C. Young. An inequality of the H¨older type, connected with Stieltjes inte-
gration. Acta Math. (Sweden) 67 (1936), 251–282.
245. L. C. Young. Inequalities connected with bounded p-th power variation in the
Wiener sense and with integrated Lipschitz conditions. Proc. London Math.
Soc. (Ser. 2) 43 (1937), 449–467.
246. L. C. Young. Sur une g´en´eralisation de la notion de variation de puissance pi`eme
born´ee au sens de M. Wiener, et sur la convergence des s´eries de Fourier. C.
R. Acad. Sc. Paris 204 (1937), 470–472.
247. L. C. Young. General inequalities for Stieltjes integrals and the convergence of
Fourier series. Math. Ann. 115 (1938), 581–612.
248. L. C. Young. Some new stochastic integrals and Stieltjes integrals. Part I.
Analogues of Hardy-Littlewood classes. In: Advances in Probability and Related
Topics, Vol. II (P. Ney, ed.), 161–240. Dekker, New York, 1970.
249. L. C. Young. Some new stochastic integrals and Stieltjes integrals. Part II. In:
Advances in Probability and Related Topics, Vol. III (P. Ney, ed.), 101–178.
Dekker, New York, 1974.
250. L. C. Young. A converse to some inequalities and approximations in the theory
of Stieltjes and stochastic integrals, and for nth derivatives. Studia Math. 55
(1976), 215–223.
251. R. C. Young. On Riemann integration with respect to a continuous increment.
Math. Ann. 29 (1928), 217–233.
252. W. H. Young. The Fundamental Theorems of the Diﬀerential Calculus. Cam-
bridge University Press, 1910. Repr. Hafner, New York, 1971.
253. W. H. Young. On classes of summable functions and their Fourier series. Proc.
Roy. Soc. London (Ser. A) 87 (1912), 225–229.
254. W. H. Young. On integration with respect to a function of bounded variation.
Proc. London Math. Soc. (Ser. 2) 13 (1914), 109–150.
255. W. H. Young. On a formula for an area. Proc. London Math. Soc. (Ser. 2) 18
(1919), 339–345.
256. A. C. Zaanen. Riesz Spaces II. North-Holland, Amsterdam, 1983.
257. E. Zeidler. Nonlinear Functional Analysis and its Applications. I: Fixed-Point
Theorems. Springer-Verlag, New-York, 1986.
258. A. Zygmund. Trigonometric series. 2d ed., Cambridge University Press, 1959,
repr. with corrections and some additions 1968, repr. 1988.
An asterisk (∗) indicates works we have seen cited in secondary sources
but have not seen in the original.

Subject Index
Page numbers in italics indicate pages with the main or most general
deﬁnition of each term
additive transform, 438
analytic continuation, 258–260
analytic mapping, 258
area of curve, 632
α-stable L´evy motion, 615
B-Taylor series, 246
B-analytic function, 246
B-power series, 246
Banach algebras, 218, 215–235
natural, 282
semisimple, 283
Banach ﬁxed point theorem, 518
Banach space of functions, 11
Beurling’s condition, 168
bimeasurable function, 335
Borel space, 600
bounded k-linear operator, 239
bounded bilinear operator, 9
bounded linear operator, 10
bounded semivariation, 26, 41
Brownian bridge, 618, 618–628, 632
Brownian motion, 575, 575–576,
629–640
Ck function, 255
C∞function, 255
Carath´eodory function, 341
Cauchy–Hadamard formula, 244
chain, 226
chain rule, 1, 85, 237, 631
character, 222
characteristic exponent, 612
common discontinuities, 25
common one-sided discontinuities, 25
complementary function, 110, 109–114
complexiﬁcation, 232, 231–233
component, 96
composition, 237, 393, 393–406
concave function, 15
conditional probability, 600
connected, 91
locally, 96
simply, 96
contraction, 518
convergence
in µ-measure, 15
in outer µ-semivariation, 43
unconditional, of a product, 417
unconditional, of a sum, 13
convex function, 15
convex set, 14
convolution of interval functions, 196
convolution of point functions, 198
convolution semigroup, 612
continuous, 612
curve, 90
null-homotopic, 96
reversed, 225

662
Subject Index
degree of lacunarity, 149
derivative, of a nonlinear operator, 237
kth, 252
diﬀerentiable in ν-measure, 357
diﬀerential equations, 7–9
formal linear, 496
formal nonlinear, 507
linear, 496–499
nonlinear, 505–549
diﬀerential, kth, 252
Dirichlet kernel, 555
Duhamel’s formula, 452, 451–456
∆2 condition, 103
empirical distribution function, 616
empirical process, 616, 615–627
essentially bounded, 14
exponential Fourier series, 551
ﬁltration, 573
generated, 573
satisfying the usual hypotheses, 576
ﬁnite-dimensional joint distributions,
571
ﬁxed discontinuity, 572
ﬁxed point, 518
Fourier series, 552, 551–569
convergent uniformly, 555
fractional Brownian motion, 589
functional calculus, 229
Φ-variation (for point functions), 103,
103–116, 127–138
norm, 105
seminorm, 105
sum, 103
Φ-variation (for interval functions), 117,
116–127, 138–142
norm, 118
seminorm, 118
sum, 117
Φ-variation stochastic process, 573
Gaussian probability measure, 580
Gaussian stochastic processes, 579,
579–599
gauge function, 56
Gelfand topology, 224
Gelfand transform, 224
growth condition, 338
hereditarily S-measurable set, 336
H¨older condition of order α, 4, 11
locally, 274
locally s-uniformly, 301
holomorphic function, 91
Hurst index, 589
index of p-variation, 588
inﬁnitely divisible law, 612
integral equations, 7–9
backward homogeneous linear, 477
backward nonlinear, 507
forward homogeneous linear, 474
forward nonlinear, 507
inhomogeneous linear, 478
linear, 7, 474–496
nonlinear, 505–549
integral transform, 197
integrals
Bartle, 43, 41–46, 100
Bochner, 39, 38–41, 499
central Young, 55, 51–56
contour, 92
Darboux–Stieltjes, 98
full Stieltjes, 47, 159
Henstock–Kurzweil, 57, 56–71
Itˆo, 630
Kolmogorov, 6, 32
Lebesgue–Stieltjes, 4
McShane, 71
mean Stieltjes, 631
reﬁnement Riemann–Stieltjes, 2, 24
reﬁnement Young–Stieltjes, 5, 29
relations between, 87–90
Riemann–Stieltjes, 2, 24, 24–28
Ross–Darboux–Stieltjes, 100
stochastic, 629–631, 640
Ward–Perron–Stieltjes, 63
with two integrands, 442–451
Y1, Y2, 51
integration by parts, 78–81
interval, 11
nondegenerate, 11
interval function, 6, 19
additive, 6, 19
bounded, 410
invertible, 413
multiplicative, 409, 408–415
nondegenerate, 412

Subject Index
663
reciprocal, 413
upper continuous, 6, 19
upper continuous at ∅, 19
interval partition, 6
associated Young, 34
reﬁnement of, 6
tagged, 6
tagged reﬁnement of, 6
tags of, 6
trace Young, 34
Young, 6, 12
invertible function, 409
Itˆo formula, 630
Itˆo isometry, 630
k-linear operator, 107
M-bounded, 107
KMT construction, 624
Kolmogorov sum, 6, 32
L´evy measure, 612
L´evy process, 613, 611–615
Lipschitz property, 299
locally, 299
locally bounded Φ-variation, 573
locally bounded p-variation, 573
Love–Young inequalities, 173–188,
444–451
major function, 62
Markov kernel, 601
Markov process, 601, 600–611
Markov property, 602
martingale, 576, 576–579
local, 577
mean value theorem, 238
measurable space, 600
minor function, 62
modiﬁcation of stochastic process, 571
modulus of continuity, 115, 115–116
multiplicative transform, 432
µ-almost separably valued function, 38
µ-measurable function, 14
µ-null set, 43
µ-(pre)-ideal space, 398
full, 398
µ-simple function for an additive µ, 42
µ-simple function for a subadditive µ,
38
Nemytskii operator, 273
autonomous, 273
nonatomic measure space, 338, 645
normal probability measure, 580
operator
bounded, 293
(Fr´echet) diﬀerentiable, 237, 628
diﬀerentiable of order k, 252
k-linear, 239
multiplication, 275
Nemytskii, 273, 273–333
product integral, 457
two-function composition, 393
operator norm, 10
Orlicz norm, 114
Orlicz space, 14
oscillation, 10, 604
perfect measure space, 339
Picard iterates
backward, 511
forward, 510
point partition, 2, 12
δ-ﬁne tagged, 56
mesh of, 12
mesh of tagged, 2, 12
reﬁnement of, 2, 12
tagged, 2, 12
tagged intervals of, 12
tagged reﬁnement of, 2, 12
Young tagged, 5, 12
polarization, 241
polynomial, between Banach spaces,
242, 239–251
k-homogeneous, 241
Taylor, 265
power series in Banach spaces, 243
probability kernel, 600
product integral, 9, 408, 407–503
strict, 433
p-variation (for interval functions), 13,
117
norm, 118
seminorm, 118
p-variation (for point functions), 3, 13
local, 142
norm, 3, 13
seminorm, 3, 13

664
Subject Index
sum, 3, 13
p-variation stochastic process, 573
p∗-variation
for interval functions, 124
for point functions, 142
quadratic covariation, 631
quadratic variation, 631
quantile function, 616
radius of uniform convergence, 244
reciprocal function, 409
regular conditional distribution, 601
regulated function, 5, 17
regulated sample function, 571
remainder in diﬀerentiation, 237
remainder in Taylor’s expansion, 268
resolvent, 221
Riemann–Stieltjes sum, 2, 24
s-uniformly α-H¨older, 301
sample function, 571
Schwarz theorem, 253
semimartingale, 577
semivariation of a function, 26
separated measurable space, 646
separating set, 574
sequence
D’yaˇckov, 151
Hadamard-lacunary, 149
W (φ, ψ)-, 150
W ′(φ, ψ)-, 150
ξ-lacunary, 149
Shragin function, 336
strong, 336
solution mapping, 483, 536
spectral radius, 219, 219–222, 281
spectrum, 221
stationary increments, 575
step function, 18
Stieltjes pair, 159
stochastic continuity, 572
stochastic discontinuity, 572
stochastic process, 571, 600
adapted, 573
cadlag, 571
ladlag, 571
separable, 573
stopping time, 577
substitution rule, 83, 188, 233
sup norm, 10
symmetric function, 240
symmetrization, 241
Taylor series in Banach spaces, 91, 258,
251–269
Taylor’s formulas, 264–269
tensor product, 269, 269–270
u-diﬀerentiable, 277
on the graph, 277
uniformly entire mapping, 261
universally measurable, 336
winding number, 90, 226, 632
Young, W. H., inequality, 110
Young–Stieltjes sum, 5, 29

Author Index
Ahlfors, L. V., 93, 102
Alexiewicz, A., 271
Appell, J., 273, 324, 333, 390, 391, 406
Artin, E., 102
Baernstein, A., 566, 569
Banach, S., 234, 235, 270, 549
Bartle, R. G., 43, 100
Bary, N. K., 553
Beardon, A. F., 97
Belﬁ, V. A., 234
Beurling, A., 168
Birkhoﬀ, G., 100, 499
Birnbaum, Z., 211
Blumenthal, R. M., 614, 615
Bochnak, J., 270
Bochner, S., 100
du Bois-Reymond, P., 557
Bonsall, F. F., 235
Bretagnolle, J., 614, 615, 625, 643
Brokate, M., 406
Carleman, T., 553
Carleson, L., 552
Cena, A., 249, 271
Chae, S. B., 270, 271
Ciemnoczo lowski, J., 333
Cohn, D. L., 648
Colonius, F., 406
D’yaˇckov, A. M., 212
Dalecki˘ı, Ju. L., 497–499, 503
Dales, H. G., 229, 333
Daniell, P. J., 99
de Finetti, B., 102
Dellacherie, C., 643
Diestel, J., 100
Dieudonn´e, J., 270, 271, 406
Dobrushin, R. L., 500, 501
Dol´eans-Dade, C., 643
Dollard, J. D., 500, 502
Doob, J. L., 572, 574, 640
Doran, R. S., 234
Dudley, R. M., VIII, 101, 618, 642
Duncan, J., 235
Dunford, N., 100, 234
Durdil, J., 391
Dvoretzky, A., 618
Dynkin, E. B., 641
Ebin, D. G., 406
Edwards, R. E., 551, 552, 569
Fernholz, L. T., 406
Fernique, X., 590
Fisk, D. L., 578
Fr´echet, M., 270
Freedman, M. A., 500, 501
Friedman, C. N., 500, 502
Fristedt, B., 642
Garay, B. M., 406
Gehring, F. W., 214
Gelfand, I. M., 222, 234, 235
Getoor, R. K., 614, 615
Gihman, I. I., 614, 641
Gill, R. D., 500, 501
Gochman, E. Ch., 99

666
Author Index
Golubov, B. I., 569
Gordon, R. A., 62, 101
Gray, A., 406
Greene, R. E., 228
Hartung, F., 406
Hausdorﬀ, F., 234
Henstock, R., 101
Hewitt, E., 102
Hildebrandt, T. H., 99, 100, 102, 500,
502, 631
H¨onig, C. S., 502
Hostinsky, B., 499
Huang, Y.-C., 618, 642
Hunt, R. A., 552
Ince, E. L., 549
Itˆo, K., 575, 613, 630
Jacob, M., 102
Jain, N. C., 640
Jarn´ık, J., 500
Johansen, S., 500, 501
Kallenberg, O., 571, 602, 603, 613, 631,
640, 641
Katznelson, Y., 552
Kiefer, J., 618
Kinney, J. R., 641
Kirwan, P., 235
Kluvanek, I., 212
Kolmogorov, A. N., 6, 552, 571, 613,
618
Koml´os, J., 642
K¨onig, G., 98
Kope´c, J., 243
Krabbe, G., 211
Krantz, S. G., 228, 552
Krasnosel’ski˘ı, M. A., 390
Kre˘ın, M. G., 497–499, 503
Kurzweil, J., 101, 500
Lai, T. L., 640
Landau, H. J., 590
Larsen, R., 234
Le´sniewicz, R., 213, 214
Lebesgue, H., 99, 552
Ledoux, M., 584, 591, 640
Lehmann, E. L., 368
L´evy, P., 613, 640, 643
Lipschitz, R., 568
 Lojasiewicz, J., 270
Love, E. R., 102, 212, 213
Luxemburg, W. A. J., 211, 406
Lyons, T., 501, 549, 643
MacNerney, J. S., 500, 502
Major, P., 624, 642
Manhas, J. S., 394
Manstaviˇcius, M., 603, 615, 640, 641
Marcinkiewicz, J., 211, 214, 553, 557,
569
Marcus, M. B., 590
Marsden, J., 406
Masani, P. R., 499
Massart, P., 618, 625, 643
Matkowski, J., 321, 333
Mazur, A., 270
Mazur, S., 222, 234
McKean, H. P., 575, 630, 643
McLeod, R. M., 101
McShane, E. J., 71, 101
Medvedev, F. A., 99
Meyer, P.-A., 643
Milnor, J., 406
Mi´s, J., 321, 333
Monrad, D., 640
Monroe, I., 577, 614
Moore, E. H., 99
Musielak, J., 211, 243
Neumann, J. von, 272
Newman, M. H. A., 97
Nguyen, T., 271
Nisio, M., 640
Norvaiˇsa, R., VIII
Oodaira, H., 640
Orlicz, W., 211, 213, 214, 270, 271, 333,
553
Peano, G., 407
Peng-Yee, L., 101
Pfeﬀer, W. F., 71
Picard, E., 549
Pollard, S., 74, 98, 99
Ponosov, A. V., 390
Qian, J., 616, 618, 642

Author Index
667
Radon, J., 99
Raikov, D., 234
Rasch, G., 499
Reeds, J. A., 406
Riesz, F., 98, 343
Riesz, M., 552
Rosenthal, P., 394
Ross, K. A., 99
Rubinˇste˘ın, A. I., 212
Runst, T., 391
Ruston, A. F., 235
Sainte-Beuve, M.-F., 337, 343
Saks, S., 71, 101
Salem, R., 569
Schatten, R., 271, 272
Schlesinger, L., 499
Schmidt, G., 499
Schoenberg, I. J., 589
Schwabik, ˇS., 102, 500, 502
Schwartz, J. T., 100, 234
Shakarchi, R., 228, 230
Shapiro, J. H., 394
Shepp, L. A., 590
Shilov, G., 234
Shragin, I. V., 390
Siciak, J., 270
Sickel, W., 391
Singh, R. K., 394
Skorohod, A. V., 614, 641, 643
Slepian, D., 591
Smirnov, N. V., 618
Smith, H. L., 99, 101
Stein, E. M., 228, 230
Stevenson, J. O., 406
Stieltjes, T. J., 98
Sz´en´assy, B., 98
Talagrand, M., 591
Taylor, A. E., 270, 271
Taylor, S. J., 599, 642
Turi, J., 406
Tusn´ady, J., 642
Tvrd´y, M., 502
Uhl, J. J., 100
Va˘ınberg, M. M., 390, 391
Vejvoda, O., 502
Volterra, V., 407, 499
Wang Sheng-Wang, 391
Ward, A. J., 71, 101
Whittle, P., 642
Wiener, N., 211, 212, 557, 569, 640
Wolfowitz, J., 618
Xu, Q., 642
Young, L. C., 51, 99, 101, 173, 211–214,
569
Young, R. C., 99
Young, W. H., 5, 99, 211, 271, 632, 643
Zaanen, A. C., 406
Zabrejko, P. P., 273, 324, 333, 390, 391,
406
Zeidler, E., 271
Zygmund, A., 214

