Signals and Communication Technology
Markus Rupp
Stefan Schwarz
Martin Taranetz
The Vienna 
LTE-Advanced 
Simulators
Up and Downlink, Link and System 
Level Simulation

Signals and Communication Technology

More information about this series at http://www.springer.com/series/4748

Markus Rupp
• Stefan Schwarz
Martin Taranetz
The Vienna LTE-Advanced
Simulators
Up and Downlink, Link and System Level
Simulation
123

Markus Rupp
Institute of Telecommunications
TU Wien
Vienna
Austria
Stefan Schwarz
Institute of Telecommunications
TU Wien
Vienna
Austria
Martin Taranetz
Institute of Telecommunications
TU Wien
Vienna
Austria
ISSN 1860-4862
ISSN 1860-4870
(electronic)
Signals and Communication Technology
ISBN 978-981-10-0616-6
ISBN 978-981-10-0617-3
(eBook)
DOI 10.1007/978-981-10-0617-3
Library of Congress Control Number: 2016931607
© Springer Science+Business Media Singapore 2016
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or
dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt
from the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained
herein or for any errors or omissions that may have been made.
Printed on acid-free paper
This Springer imprint is published by SpringerNature
The registered company is Springer Science+Business Media Singapore Pte Ltd.

Preface
A simulation is something nobody believes, except the person
who made it.
An experiment is something everybody believes, except the
person who made it.
Freely modiﬁed after Albert Einstein
The Vienna LTE Simulators started as a project in 2009. Our ﬁrst concept
included two simulators, a link and a system level simulator for Downlink (DL).
With one postdoc, ﬁve Ph.D., and some ﬁve Master level students we started this
endeavor and soon realized that it would take longer than expected. After one year,
we had basic functionality working and were continuously puzzled by inconsistent
results. The more we tested, the more we found inconsistencies. Once we were
satisﬁed with overcoming most of those hurdles, we decided to make the ﬁrst
release freely available on the Internet. Although we included from the very
beginning an acknowledgment that the simulator is only to use for academic
research, not all of the downloading parties took their promise seriously. At this
point we did not care much about it but were mostly happy about the feedback we
obtained. We started a web forum on which everybody could freely post troubles
that were encountered and to our utmost surprise even people outside of our group
showed up as experts and helped us in solving our ‘mysteries’. After some two
years we counted ten thousands of downloads, by far much more than serious users
and it was time to become more professional about it. Both simulators had evolved
into a product and after spending several hundred thousand Euros to pay all the
students’ salaries, we needed to see something in return. Also, the continuation
of the project was in serious ﬁnancial jeopardy at some time periods. Our download
handling thus changed into a business part that allowed only downloads for obvious
academic usage, conﬁrmed by deans or department heads of existing universities,
while all others had to pay a fee. The fees have been kept moderately low in
comparison to commercial products on the market. We basically traded responsi-
bility against price. Some companies decided not to use our ‘cheap’ tools as we
were not willing to guarantee compensatory payment in case of faults, some
companies required 24 h switching boards to have someone answering their
v

questions; all of such desires we could not possibly satisfy. Nevertheless, word had
passed around that our simulators were quite useful and that we behaved as
trustworthy partners, taking requests seriously and repairing reported bugs in the
next revisions. Finally, many 3rd Generation Partnership Project (3GPP) companies
had decided to use the tools as platform for exchanging ideas. Our simulators serve
as reference to compare against their own ideas.
While there were sporadic requests for Uplink (UL) simulators as well, for a
long time we could not respond positively as we were not having sufﬁcient per-
sonnel as well as money to pay extra students. Finally, in 2012 we decided to
devote also effort into a link level UL simulator. All three simulators together now
have experienced more than 50,000 downloads and have become reliable tools for
companies as well as academia worldwide. As we still continue working out our
own research tasks, the simulators are permanently improved and enhanced by
more and more capabilities. This book is intended to provide an overview of our
own research activities related to these three simulators. We are aware of hundreds
of serious efforts of other research groups that are covering ﬁelds we could not and
will not. Listing all of those would certainly blast this book. From the very
beginning, quality issues were important for us and even if it hampered down the
publication rate, we devoted ourselves to some requirements. These are as follows:
Reproducibility has become an increasingly important issue in the past years.
As systems become more and more complex and thus complicated, it becomes
more and more difﬁcult to repeat results of others and even reproducing our own
results is often difﬁcult after some time has passed. To facilitate reproducibility we
have therefore launched open access ‘Vienna LTE Simulators’ to provide a com-
mon platform for researchers and engineers. Furthermore, most of our research
papers are associated with code that can be downloaded and easily repeated on
other researchers’ personal computers.
Our Web Forum represents a focal point for information exchange and pro-
vides us with permanent requests by third-party users. Through this measure many
bugs are found and, as we take these seriously, we permanently repair them and
provide new improved releases. By this means we have been tested by several
hundreds of experts. Not many software providers can say that about their products.
Quality insurance is important to us. How do you know your Monte Carlo
(MC) runs are sufﬁcient? We always include conﬁdence intervals with every
averaging point to measure how reliable our simulation is. This often leads to
signiﬁcant speed improvements as there is no need to average more data once the
conﬁdence intervals have become very small. Standard bootstrapping techniques
are being applied to compute such intervals.
Speed of simulation is a relevant factor. As multi-core machines are becoming
cheaper and cheaper, it makes sense to parallelize the software and speedup sim-
ulation signiﬁcantly. Some time-consuming decoders have also been ported to the
graphical boards featuring hundreds of cores, which are now available in every
personal computer as standard equipment; this allows to boost performance even
more.
vi
Preface

Evaluation is particularly important when modeling is very abstract. We thus
conduct experimental research for which the link level simulators in up- and
downlink provide key functionality. In the same way the link level simulator
provides the reference for the system level simulator, Fig. 1 describes the scenarios.
While many more ensemble values can be generated by the link level simulator,
only a few are selected to be evaluated by the testbed. Similarly, the system level
simulator selects small setups with a few base stations and/or a few users that can
still be computed at link level precision in reasonable time.
How to Read This Book
Part
I of this
book
is about
long-term
evolution
(LTE) and long-term
evolution-advanced (LTEA) link level techniques. As the downlink direction has
experienced high demand and interest from our partners and collaborators, a lot of
research work has been conducted by the DL simulator and most chapters thus
focus on the downlink. This ﬁrst part of the book reports some highlights including
single-user (SU) and multi-user (MU) as well as single-input single-output (SISO)
and multiple-input multiple-output (MIMO) transmissions, and also reports on
optimal pilot pattern for high-speed communications as well as synchronization
issues. One chapter is devoted to experiments showing how the link level simulator
can provide input to the measurement testbed. Also basic results on orthogonal
frequency division multiplexing (OFDM) transmissions, not only valid for LTE, are
reported and validated by measurements. Furthermore, one chapter deals with our
newest tool, the UL link level simulator, and explains some interesting novel results
obtained by it.
The second part of this book is on system level simulations. From early on
system level simulations have been in high demand in industry and academia, since
people wanted to ﬁnd answers for situations when many base stations and hundreds
Experimental
Testbed
Vienna Link-Level
Simulator
Vienna System-Level
Simulator
Requests specific
experiments
Requests specific
experiments
Delivers results
Delivers results
Fig. 1 Applied evaluation chain, cross-validating amongst experimental results from testbed
measurements and simulation outcomes from the Vienna Link Level and System Level Simulators
Preface
vii

of users were involved. How the mathematical abstraction of such large cellular
networks can be accomplished to speedup simulations by a factor of several hun-
dred without sacriﬁcing precision is explained in this part of the book. We explain
some new theories of how to abstract large cities equipped with small cells, that is,
heterogeneous networks, and demonstrate the capabilities of our system level
simulator on applications such as train and car transmissions.
Both parts are in general a rather independent read; if the reader is interested in
comparing link and system level results, he is recommended to study both.
Vienna
Markus Rupp
December 2015
Stefan Schwarz
Martin Taranetz
viii
Preface

Acknowledgments
This book is the outcome of many years of research and teaching in the ﬁeld of
signal processing and wireless communications.
We thank many people from A1 Telekom for their long-term support; speciﬁ-
cally, we express our appreciation to W. Müllner, W. Wiedermann, T. Ergoth,
W. Weiler, M. Kogelbauer, and T. Baumgartner.
Our friends and colleagues at Kathrein Werke KG have no small impact on our
work; in particular we thank A. Kathrein, G. Schell, R. Gabriel, G. Saala, and
J. Rumold for their support and input.
Recently, we started to collaborate more intensively with General Motors who
introduced us to interesting communication problems in vehicular scenarios. We
thank T. Philosof and K. Scheim for this.
Very special thanks go to Christoph F. Mecklenbräuker who supported many of
our efforts within his Christian Doppler Laboratory “Wireless Technologies for
Sustainable Mobility.”
This book would not have been possible without the support of many helpful
people from Springer; our thanks especially go to C. Baumann and I. Schildmann.
ix

Contents
Part I
Link Level Simulations and Experiments
1
Link Level Simulation Basics . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1
Some Basics on Wireless Channels and Notations . . . . . . . . . .
3
1.2
OFDM Basics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.3
Advanced Features: ICI Modeling . . . . . . . . . . . . . . . . . . . . .
9
1.3.1
Analytical Model . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.3.2
Extension to MIMO Transmissions. . . . . . . . . . . . . . .
11
1.3.3
Performance Evaluation. . . . . . . . . . . . . . . . . . . . . . .
12
1.4
LTE in a Nutshell . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
1.5
Input–Output Relationship of a Cellular User. . . . . . . . . . . . . .
15
1.6
Instantaneous Post-equalization SINR . . . . . . . . . . . . . . . . . . .
19
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
2
Downlink Synchronization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.2
Evaluation Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.3
Mean Square Error of Carrier Frequency Offset Estimation . . . .
24
2.4
Signal to Interference and Noise Ratio Modeling . . . . . . . . . . .
27
2.5
Bit Interleaved Coded Modulation Capacity. . . . . . . . . . . . . . .
29
2.6
Numerical Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2.6.1
Mean Square Error . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2.6.2
Post-equalization Signal to Interference
and Noise Ratio . . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
2.6.3
Average Spectral Efﬁciency . . . . . . . . . . . . . . . . . . . .
32
2.6.4
Coded Throughput Loss . . . . . . . . . . . . . . . . . . . . . .
34
2.7
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
36
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3
Symbol Detection in High Speed Channels . . . . . . . . . . . . . . . . . .
39
3.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
3.2
OFDM in High Speed Channels. . . . . . . . . . . . . . . . . . . . . . .
40
xi

3.3
Closed-Form BEP Expression for One-Tap Equalizer . . . . . . . .
43
3.4
Time-Variant Channel Estimation and ICI Mitigation . . . . . . . .
48
3.5
Simulations and Measurements . . . . . . . . . . . . . . . . . . . . . . .
52
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
4
Optimal Pilot Pattern for Downlink Transmissions . . . . . . . . . . . .
61
4.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
4.2
Least Squares Channel Estimation . . . . . . . . . . . . . . . . . . . . .
62
4.3
Linear Minimum Mean Square Error Channel Estimation . . . . .
67
4.4
Optimal Power Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . .
69
4.4.1
Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . .
72
4.5
Optimal Pilot Patterns. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.5.1
Unit Pilot Power . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
4.5.2
Optimal Pilot Power . . . . . . . . . . . . . . . . . . . . . . . . .
77
4.6
Adaptive Pilot Sets. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
4.6.1
Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . .
80
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5
Single User MIMO LTE Transmission with Quantized
Feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
5.1
Principles of Link Adaptation and Linear Precoding . . . . . . . . .
87
5.1.1
Link Adaptation . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
5.1.2
Linear Precoding for Single User Muliple-Input
Multiple-Output . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
5.2
Implicit CSI Feedback Algorithms . . . . . . . . . . . . . . . . . . . . .
93
5.2.1
Feedback Clustering . . . . . . . . . . . . . . . . . . . . . . . . .
93
5.2.2
Feedback Selection Algorithm . . . . . . . . . . . . . . . . . .
95
5.2.3
Approximate Sequential Solution . . . . . . . . . . . . . . . .
98
5.2.4
Antenna Subset Selection for DASs . . . . . . . . . . . . . . 100
5.3
Performance Investigation . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
5.3.1
Comparison of LTE to Theoretical Throughput
Bounds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5.3.2
Evaluation of the Feedback Algorithms. . . . . . . . . . . . 104
5.3.3
Impact of CSI Feedback Granularity. . . . . . . . . . . . . . 108
5.4
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
6
Multi User and Multi Cell Simulations . . . . . . . . . . . . . . . . . . . . . 115
6.1
Zero-Forcing and Block-Diagonalization Precoding . . . . . . . . . 117
6.1.1
Transmit Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
6.1.2
Limited Feedback Model. . . . . . . . . . . . . . . . . . . . . . 120
6.2
Explicit CSI Feedback Algorithms . . . . . . . . . . . . . . . . . . . . . 122
6.2.1
Memoryless Grassmannian Quantization . . . . . . . . . . . 123
6.2.2
Predictive Grassmannian Quantization. . . . . . . . . . . . . 124
6.2.3
Evaluation of the Quantization MSE. . . . . . . . . . . . . . 136
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
xii
Contents

7
Advanced Multi User MIMO Concepts . . . . . . . . . . . . . . . . . . . . . 143
7.1
Extension to Systems with Excess Antennas . . . . . . . . . . . . . . 143
7.1.1
Summary of Previous Results . . . . . . . . . . . . . . . . . . 144
7.1.2
Subspace Quantization Based Combining . . . . . . . . . . 146
7.1.3
Maximum Eigenmode Transmission . . . . . . . . . . . . . . 153
7.1.4
Achievable Rate Comparison of SQBC and MET. . . . . 155
7.1.5
Adjustment of the Grassmannian CSI Feedback . . . . . . 158
7.2
Extension to Frequency-Selective Systems. . . . . . . . . . . . . . . . 159
7.2.1
Grassmannian Interpolation and Clustering . . . . . . . . . 160
7.2.2
Channel Quality Feedback and Multi-user
Scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165
7.2.3
Performance Investigation . . . . . . . . . . . . . . . . . . . . . 168
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
8
LTE-Advanced Uplink Transmissions . . . . . . . . . . . . . . . . . . . . . . 177
8.1
LTE-Speciﬁc System Model and Post-equalization SINR . . . . . 178
8.1.1
Post-spreading SINR in SC-FDM Transmissions . . . . . 180
8.1.2
Post-equalization SINR in OFDM Transmissions . . . . . 181
8.2
SC-FDM Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
8.2.1
Peak to Average Power Ratio . . . . . . . . . . . . . . . . . . 182
8.2.2
BER Comparison Over Frequency Selective
Channels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183
8.3
Throughput Performance with Link Adaptation . . . . . . . . . . . . 185
8.3.1
Optimal Rate Adaptation. . . . . . . . . . . . . . . . . . . . . . 186
8.3.2
Realistic Link Adaptation . . . . . . . . . . . . . . . . . . . . . 189
8.4
Reference Symbols. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
8.5
Channel Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
8.5.1
Minimum Mean Square Error Estimation. . . . . . . . . . . 194
8.5.2
Correlation Based Estimation. . . . . . . . . . . . . . . . . . . 195
8.5.3
MSE and BER Comparison . . . . . . . . . . . . . . . . . . . . 199
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
9
Link Level Measurements. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
9.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
9.2
The Vienna MIMO Testbed. . . . . . . . . . . . . . . . . . . . . . . . . . 204
9.3
Evaluation of LTE MIMO Downlink Transmissions . . . . . . . . . 206
9.3.1
Physical Layer Throughput . . . . . . . . . . . . . . . . . . . . 209
9.3.2
Channel Capacity . . . . . . . . . . . . . . . . . . . . . . . . . . . 211
9.4
Measurements at High Velocities . . . . . . . . . . . . . . . . . . . . . . 213
9.4.1
Measurement Setup and Methodology. . . . . . . . . . . . . 214
9.4.2
LTE Uplink Fast Fading Channel Interpolation . . . . . . 215
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
Contents
xiii

Part II
System Level Simulations
10
Basic System Level Simulations and Advanced Features . . . . . . . . 227
10.1
Survey on Existing Simulation Tools . . . . . . . . . . . . . . . . . . . 227
10.2
The Vienna LTE-A Downlink System Level Simulator . . . . . . . 228
10.3
Physical Layer Modeling. . . . . . . . . . . . . . . . . . . . . . . . . . . . 228
10.4
Link-to-System Mapping. . . . . . . . . . . . . . . . . . . . . . . . . . . . 229
10.5
Advanced Features: Runtime Precoding . . . . . . . . . . . . . . . . . 231
10.5.1
Relevance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 231
10.5.2
Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 232
10.5.3
Performance Evaluation. . . . . . . . . . . . . . . . . . . . . . . 233
10.6
Advanced Features: 3D Channel Modeling . . . . . . . . . . . . . . . 236
10.6.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236
10.6.2
3GPP 3D Channel Model . . . . . . . . . . . . . . . . . . . . . 238
10.6.3
Implementation on System-Level . . . . . . . . . . . . . . . . 241
10.6.4
Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 244
10.6.5
Opportunities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 246
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 248
11
Modeling Regular Aggregate Interference by Symmetric
Structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 251
11.1
Preliminaries on the Gamma Distribution . . . . . . . . . . . . . . . . 252
11.2
Hexagonal Reference Model . . . . . . . . . . . . . . . . . . . . . . . . . 253
11.3
Circular Interference Model . . . . . . . . . . . . . . . . . . . . . . . . . . 254
11.3.1
Proposed Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . 255
11.3.2
The Dual Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . 255
11.4
Statistics of Aggregate Interference. . . . . . . . . . . . . . . . . . . . . 256
11.4.1
Interference Statistics at the Center . . . . . . . . . . . . . . . 256
11.4.2
Interference Statistics Outside the Center. . . . . . . . . . . 257
11.5
Numerical Results and Discussion . . . . . . . . . . . . . . . . . . . . . 258
11.5.1
Validation of Expected Aggregate Interference. . . . . . . 258
11.5.2
Validation of Gamma Approximation . . . . . . . . . . . . . 260
11.6
Application in Heterogeneous Networks . . . . . . . . . . . . . . . . . 262
11.7
LTE-Advanced System Level Simulations . . . . . . . . . . . . . . . . 265
11.7.1
System Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266
11.7.2
Validation of Gamma Approximation . . . . . . . . . . . . . 267
11.8
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 269
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 270
12
Modeling Asymmetric Aggregate Interference by Symmetric
Structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273
12.1
Circular Interference Model . . . . . . . . . . . . . . . . . . . . . . . . . . 274
12.2
Distribution of the Sum of Gamma Random Variables . . . . . . . 278
12.2.1
Proposed Finite Sum Representation . . . . . . . . . . . . . . 278
12.2.2
Application in Circular Interference Model . . . . . . . . . 279
xiv
Contents

12.3
Mapping Scheme for Stochastic Network Deployments. . . . . . . 280
12.3.1
Mapping Procedure . . . . . . . . . . . . . . . . . . . . . . . . . 280
12.3.2
Performance Evaluation of Homogeneous Base
Station Deployments. . . . . . . . . . . . . . . . . . . . . . . . . 282
12.3.3
Performance Evaluation of Heterogeneous Base
Station Deployments. . . . . . . . . . . . . . . . . . . . . . . . . 283
12.4
Interference and Rate at Eccentric User Locations . . . . . . . . . . 285
12.4.1
Generic Circularly Symmetric Scenario . . . . . . . . . . . . 285
12.4.2
Components of Asymmetric Interference . . . . . . . . . . . 286
12.4.3
Transmitter Collaboration Schemes. . . . . . . . . . . . . . . 287
12.5
LTE-Advanced System Level Simulations . . . . . . . . . . . . . . . . 291
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294
13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks . . . 297
13.1
Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298
13.1.1
Random Shape Theory . . . . . . . . . . . . . . . . . . . . . . . 298
13.1.2
Indoor Coverage Ratio . . . . . . . . . . . . . . . . . . . . . . . 299
13.2
System Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 300
13.2.1
Topology Model for Urban Environments . . . . . . . . . . 300
13.2.2
Network Deployment . . . . . . . . . . . . . . . . . . . . . . . . 300
13.2.3
User Association . . . . . . . . . . . . . . . . . . . . . . . . . . . 301
13.2.4
Virtual Building Approximation . . . . . . . . . . . . . . . . . 302
13.2.5
Signal Propagation . . . . . . . . . . . . . . . . . . . . . . . . . . 303
13.3
Performance Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304
13.3.1
Typical Building with Small Cell Base Station. . . . . . . 304
13.3.2
Typical Building Without Small Cell Base Station . . . . 305
13.3.3
Typical Indoor User . . . . . . . . . . . . . . . . . . . . . . . . . 306
13.4
Numerical Evaluation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 306
13.5
LOS- and NLOS Macro Base Stations . . . . . . . . . . . . . . . . . . 308
13.5.1
Distance Distributions of Associated Macro Base
Stations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 308
13.5.2
SINR and Coverage Analysis. . . . . . . . . . . . . . . . . . . 310
13.5.3
Numerical Evaluation . . . . . . . . . . . . . . . . . . . . . . . . 312
13.6
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 314
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 315
14
Simulation of Two-Tier Heterogeneous Cellular Networks . . . . . . . 319
14.1
System Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319
14.2
Urban Two-Tier Heterogeneous Cellular Network . . . . . . . . . . 322
14.3
User Hot Spot Scenarios . . . . . . . . . . . . . . . . . . . . . . . . . . . . 325
14.4
Sensitivity on Femtocell Deployment Density and -Isolation . . . 327
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 331
Contents
xv

15
Advanced System Level Applications . . . . . . . . . . . . . . . . . . . . . . 335
15.1
Modeling Train Transmissions . . . . . . . . . . . . . . . . . . . . . . . . 335
15.1.1
Performance of Remote Unit Collaboration
Schemes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 336
15.1.2
Comparison of Relay-Based
and Direct Communication . . . . . . . . . . . . . . . . . . . . 342
15.2
Evolved Multimedia Broadcast Multicast Service . . . . . . . . . . . 345
15.2.1
Latency Evaluation. . . . . . . . . . . . . . . . . . . . . . . . . . 348
15.2.2
Network Utilization . . . . . . . . . . . . . . . . . . . . . . . . . 348
15.2.3
CQI Adaptation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 349
15.2.4
Performance Evaluation. . . . . . . . . . . . . . . . . . . . . . . 349
15.2.5
Bandwidth Scaling . . . . . . . . . . . . . . . . . . . . . . . . . . 350
15.2.6
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 355
xvi
Contents

Authors and Contributors
About the Authors
Markus Rupp was born in 1963 in Völklingen, Germany. He received his
Dipl.-Ing. degree in 1988 at the University of Saarbrücken, Germany and his
Dr.-Ing. degree in 1993 at the Technische Universität Darmstadt, Germany, where
he worked with Eberhardt Hänsler on designing new algorithms for acoustical and
electrical echo compensation. From November 1993 until July 1995, he had a
postdoctoral position at the University of Santa Barbara, California, with Sanjit
Mitra where he worked with Ali H. Sayed on a robustness description of adaptive
ﬁlters with impact on neural networks and active noise control. From October 1995
until August 2001 he was a member of Technical Staff in the Wireless Technology
Research Department of Bell-Labs at Crawford Hill, NJ, where he worked on
various topics related to adaptive equalization and rapid implementation for IS-136,
802.11 and UMTS. Since October 2001 he is full professor for Digital Signal
Processing in Mobile Communications at the TU Wien where he served as Dean
from 2005–2007 and is appointed from 2016–2019. He was associate editor of
IEEE Transactions on Signal Processing from 2002–2005, is currently associate
editor of JASP EURASIP Journal of Advances in Signal Processing, and
JES EURASIP Journal on Embedded Systems. He is a Fellow of the IEEE and was
elected AdCom member of EURASIP from 2004 to 2012, serving as president of
EURASIP from 2009–2010. He has authored and co-authored more than 500
scientiﬁc papers including 15 patents on adaptive ﬁltering, and wireless commu-
nications. E-mail: mrupp@nt.tuwien.ac.at
Stefan Schwarz was born in Neunkirchen, Austria, in 1984. He received his BSc
in
Electrical
Engineering
and
his
Dipl.-Ing.
degree
(MSc
equivalent)
in
Telecommunications Engineering with highest distinctions in 2007 and 2009,
respectively, both at TU Wien. He also received his Dr. techn. degree (Ph.D.
equivalent) in Telecommunications Engineering with highest distinctions in 2013 at
TU Wien. In 2010 he received the honorary prize of the Austrian Minister of
Science and Research, for excellent graduate of scientiﬁc and artistic universities
xvii

and in 2014 he received the INiTS award in the category Information and
Communication Technologies for innovative scientiﬁc works with prospect for
economic applicability. From 2008 to 2014 he was working as a project assistant at
the Mobile Communications group of Prof. Markus Rupp at the Institute of
Telecommunications of TU Wien, focusing on link and system level simulation of
LTE/LTE-A networks and acting as one of the lead developers of the Vienna LTE
Simulators. In 2012 he visited The University of Texas at Austin as research
scholar, collaborating with Prof. Robert W. Heath, Jr. on limited feedback algo-
rithms for distributed antenna systems. Since 2015 he is employed as postdoctoral
researcher (University Assistant) at the Institute of Telecommunications, leading
the research collaboration with General Motors. He also serves as the Head of the
Christian Doppler laboratory on Dependable Wireless Connectivity for the Society
in Motion. His research interests include the broad ﬁelds of wireless communica-
tions and signal processing. E-mail: sschwarz@nt.tuwien.ac.at
Martin Taranetz was born in 1986 in Amstetten, Austria. He received the B.Sc.
degree in Electrical Engineering and Dipl.-Ing degree (M.Sc. equivalent) in
Telecommunications with highest distinctions from the TU Wien, Vienna, Austria,
in 2008 and 2011, respectively. He also received his Dr.-techn. degree (Ph.D.
equivalent) in Telecommunications Engineering with highest honors from the TU
Wien in 2015. In his dissertation, he focused on system level modeling and eval-
uation of heterogeneous cellular networks. Since 2015, he is employed as project
assistant
in
the
Mobile
Communications
group
of
the
Institute
of
Telecommunications, TU Wien. From January 2014 to April 2014 he was a visiting
researcher with the Wireless Networking and Communications Group at The
University of Texas at Austin. His research interests include the broad ﬁelds of
wireless communications and signal processing. He is a reviewer for IEEE
Transactions on Wireless Communications and IEEE Transactions on Signal
Processing. E-mail: mtaranet@nt.tuwien.ac.at
Contributors
Fjolla Ademaj was born in 1989 in Istog, Kosovo. She received the B.Sc. degree
in Electrical Engineering and the M.Sc. degree in Telecommunications from
Faculty of Electrical and Computer Engineering, University of Prishtina, Kosovo,
in 2011 and 2014, respectively. Since 2014 she is working as project assistant at the
Institute of Telecommunications, TU Wien, and is currently pursuing her Ph.D.
degree in Telecommunications Engineering. Her research interests are in the ﬁeld of
wireless communications, in modeling of 3D wireless channels by system-level
tools, full dimension MIMO, and 3D beamforming techniques. E-mail: fademaj
@nt.tuwien.ac.at
Martin Lerch was born in Vienna, Austria in 1978. After attending a technical
high school, he studied electrical and communication engineering at TU Wien
where he received his master’s degree in 2008. During this time and later, Martin
xviii
Authors and Contributors

developed several database, Web, and desktop applications before he returned to
TU Wien in 2011 to work on the Vienna MIMO Testbed at the Institute of
Telecommunications. Martin’s work focuses on the development of new mea-
surement methodologies for static and high mobility mobile communication sce-
narios. E-mail: mlerch@nt.tuwien.ac.at
Martin Müller was born in Fürstenfeldbruck, Germany. He received his B.Eng.
degree in Electrical Engineering and Telecommunications from the DHBW
Ravensburg, Germany, in 2009 and his Dipl.-Ing degree in Telecommunications
with highest distinctions from the TU Wien, Vienna, Austria, in 2013. Since 2011
he is working as project assistant at the Institute of Telecommunications, TU Wien,
and is currently pursuing the Ph.D. degree in Telecommunications Engineering.
His research interests include supplying mobile access in train and highway envi-
ronments
and
wireless
communications
in
indoor
scenarios.
E-mail:
mmueller@nt.tuwien.ac.at
Ronald Nissel was born 1985 in Vienna, Austria. He ﬁnished his Bachelor degree
in Electrical Engineering in 2010 and his Dipl.-Ing. degree (MSc equivalent) in
Telecommunications in 2013, both with highest distinctions at the TU Wien.
Additionally, he received a Bachelor degree in Economics from the Vienna
University of Economics and Business in 2010 and a Mag.rer.soc.oec. degree (MSc
equivalent) in Economics from the University of Vienna in 2015 (with highest
distinction). Currently he is working towards his PhD degree at the TU Wien. From
2011 to 2013 he was working as a project member at the Mobile Communications
group of Prof. Markus Rupp at the Institute of Telecommunications of TU Wien,
focusing on testbed measurements. Since 2013 he is employed as pre-Doc
researcher (Project Assistant) at the Institute of Telecommunications. His research
focuses on high-velocity transmission as well as testbed measurements and in
particular the comparison of theoretical expectations with measurement results.
E-mail: rnissel@nt.tuwien.ac.at
Stefan Pratschner was born in 1990, in Vienna, Austria. He started his studies at
the TU Wien, Austria, in 2010, where he received his BSc in 2014. Since 2013
Stefan Pratschner is working at the Institute of Telecommunications, TU Wien, as a
project assistant in the mobile communication group. His research interests include
the LTE-A uplink and its simulation at link level. Currently he is working toward
his master degree at the TU Wien. E-mail: spratsch@nt.tuwien.ac.at
Illia Saﬁulin was born in 1991 in Donetsk, Ukraine. In 2008 he started studying
Applied Physics in Donetsk National University, Ukraine, where he received his
BSc and master degrees with highest distinctions in 2012 and 2013, respectively. In
2013 he started his Master’s degree in Telecommunications at the TU Wien.
Additionally from 2014 he has been employed as project assistant at the Institute of
Telecommunications in the Mobile Communications group. His research interests
are vehicular communication and scheduling optimization. E-mail: illia.saﬁulin
@nt.tuwien.ac.at
Authors and Contributors
xix

Michal Šimko was born in Bratislava, Slovakia, in October 1985. In June 2009,
he received his Dipl.-Ing. degree (with highest honors) and in May 2013 his Ph.D.
degree (with highest honors), both from TU Wien, Vienna, Austria. In June 2011,
he received also a Bachelor degree in Industrial/Organizational and Social
Psychology from the Comenius University, Bratislava, Slovakia. Since August
2009
he
has
been
working
as
project
assistant
at
the
Institute
of
Telecommunications, TU Wien. During August and September 2010 he was vis-
iting researcher at the Department of Electrical Engineering of Linköping
University, Sweden. From January 2012 to June 2012, he was visiting researcher at
the Signal Processing Laboratory of Federal University of Rio de Janeiro, Brazil.
His research interests include channel estimation techniques, pilot pattern opti-
mization, and communications under time-variant channels. He has been awarded
the Best Student Paper Award by IEEE VTS Society at IEEE VTC 2011 Spring in
Budapest, Hungary. E-mail: michal@simko.biz
Qi Wang was born in Beijing, China, in November 1982. In 2001, she received the
Bachelor degree in Telecommunication Engineering from Beijing University of
Posts and Telecommunications. From August 2005 to October 2007, she studied in
Linköping University in Linköping, Sweden, where she obtained the Master’s
degree in Computer Science and Engineering. From November 2007 to December
2012, she worked as university assistant at the Institute of Communications and
Radio-Frequency Engineering of the TU Wien. Her research interests are in the
ﬁeld of wireless communications, in particular, synchronization aspects of OFDM
systems. E-mail: wangqiasia@gmail.com
Erich Zöchmann was born in 1989 in Horn, Austria. In 2015, he ﬁnished his
master’s degree in Electrical Engineering (Telecommunications) from TU Wien.
His master’s thesis is entitled “Generalized LASSO in Array Signal Processing.”
He is currently employed as project assistant at the Institute of Telecommunications
in the Mobile Communications group, headed by Markus Rupp. His research
interests include sparse modeling, optimization, array processing, and wireless
communications for 4G and beyond. E-mail: erich.zoechmann@nt.tuwien.ac.at
xx
Authors and Contributors

Notation
Table 1 Mathematical notation
Symbol
Annotation
fXðÞ
Probability density function of X
FXðÞ
Cumulative distribution function of X
E½X
Expected value of X
Var½X
Variance of X
NCða; σ2IÞ
Complex-valued Gaussian distribution with mean a and variance σ2
Γ½k; θ
Gamma distribution with shape k and scale θ
WC
NðM; ΓÞ
Central complex-valued Wishart distribution of dimension N,having M degrees
of freedom and scale matrix Γ
WC
N ðM; ΓÞ
Inverse complex-valued Wishart distribution of dimension N, having M degrees
of freedom and scale matrix Γ.
v 2 Rd1
Real-valued column vector of length d
½vl
l-th element of vector v
½Vl;k
l; k-th element of matrix V
1a  b
All one matrix of dimension a  b
ek
Canonical base vector with a single one entry at position k
Φ
Point process on Rd
Bðx; rÞ
Ball with center x 2 R2 and radius r [ 0
diag ðVÞ
Vector v formed out of diagonal elements of matrix V
Diag ðvÞ
Diagonal matrix V formed out of elements of vector v
tr ðVÞ
Scalar representing the sum of diagonal elements of matrix V

Kronecker product

Hadamard point-wise product
xxi

Table 2 Important parameters and variables
Variable
Dimension
Description
ALS
CNDNP
LS estimator matrix
ALMMSE
CNDNP
LMMSE estimator matrix
cðt; τÞ
C
Time-variant channel impulse response
Cðt; f Þ
C
Time-variant transfer function
CðSÞðν; τÞ
C
Spreading function
CðDÞðν; f Þ
C
Doppler variant transfer function
Dt
N
Pilot spacing in time
Df
N
Pilot spacing in frequency
D
CNcNc
Equivalent diagonal channel matrix for time-invariant channel
Dn
CNcNc
Equivalent channel matrix for time-variant channel
Δt
R þ
Sampling interval
Δf
R þ
Subcarrier spacing
f
R
Continuous frequency
Fk
CNTNL
Precoding matrix at subcarrier k
Fn,k
CNTNL
Precoding matrix at time instant n and subcarrier k
Fn,k[u,i]
CNTNL
Precoding matrix at time instant n and subcarrier k of user u and cell i
Gk
CNLNR
Channel equalizer at subcarrier k
Gn,k
CNLNR
Channel equalizer at time instant n and subcarrier k
Gn,k[u,i]
CNLNR
Channel equalizer at time instant n and subcarrier k of user u and cell i
G ct
ð Þ
n;k u; i
½

CNRNL
Conjugate transpose of receive ﬁlter Gn;k u; i
½

Hk
CNRNT
Channel matrix at subcarrier k
H(eff)
CNRNcNLNc
Channel matrix (precoding included)
H eff
ð
Þ
k
CNRNL
Channel matrix (precoding included) at subcarrier k
H(diag)
CNRNcNTNc
Diagonalized channel matrix
Hn,k
CNRNT
Channel matrix at time instant n and subcarrier k
H eff
ð
Þ
n;k
CNRNL
Channel matrix (precoding included) at time instant n and subcarrier k
Hn,k[u,i]
CNRNT
Channel matrix at time instant n and subcarrier k of user u and cell i
HðctÞ
n;k ½u; i
CNTNR
Conjugate transpose of channel matrix Hn,k[u,i]
HðeffÞ
n;k ½u; i
CNLNR
Channel matrix (receive ﬁlter included) at time instant n and
subcarrier k of user u and cell i
HðectÞ
n;k ½u; i
CNRNL
Conjugate transpose of effective channel matrix HðeffÞ
n;k ½u; i
^h
LS
P
CNP1
LS estimate of the channel at pilot positions
^H
LS
P
CNPNP
LS estimate of the channel matrix at pilot positions
^h
LMMSE
P
CNP1
LMMSE estimate of the channel at pilot positions
~hi
CNP1
Estimation error of the channel at position i
hD
CND1
Channel at data positions
(continued)
xxii
Notation

Table 2 (continued)
Variable
Dimension
Description
^hD
CND1
Channel estimate at data positions
^h
LS
D
CND1
LS estimate of the channel at data positions
^h
LMMSE
D
CND1
LMMSE estimate of the channel at data positions
hP
CNP1
Channel at pilot positions
^hP
CNP1
Channel estimate at pilot positions
k
N
Subcarrier index
l
N
Transmission layer index
‘k
N
Number of spatial streams over time
‘k u; i
½

N
Number of spatial streams at subcarrier k for user u in cell i
‘n;k u; i
½

N
Number of spatial streams at time n and subcarrier k for user u in cell i
n
Z
OFDM symbol index
Nc
N
Number of active subcarriers
Nf
N
Number OFDM symbols/subframe
NFFT
N
Max. number of subcarriers = FFT size
Ncp
N
Number of samples per CP
No
N
Oversampling factor
Nh
N
Number of channel taps
Ns
N
Number of samples per OFDM symbols
Nsl
N
Number of OFDM symbols/slot
ND
N
No. of OFDM data symbols/slot
Np
N
Number of OFDM pilot symbols/slot
NL
N
No. of transmission layers
NT
N
No. of transmit antennas
NR
N
No. of receive antennas
NTTI
N
No. of transmission time intervals
PD
R þ
Data symbol power
PD
n;k
R þ
Data symbol power at subcarrier k and OFDM symbol n
PICI
R þ
ICI power
PICI
n;k
R þ
ICI power at subcarrier k and OFDM symbol n
Pn;k i½ 
R þ
Transmit power at time instant n and subcarrier k of cell i
PP
R þ
Pilot power
PS
R þ
Transmit power
PV
R þ
Noise power
r(t)
C
Continuous received signal
rn,k
C
Received data symbol at subcarrier k and OFDM symbol n
rn,k
CNR1
Received data symbol vector at subcarrier k and OFDM symbol n
rn;k½u; i
CNR1
Received data symbol vector at subcarrier k and OFDM symbol n for
user u and cell i
rn
CNc1
Received data symbol vector at OFDM symbol n
(continued)
Notation
xxiii

Table 2 (continued)
Variable
Dimension
Description
rP
CNP1
Received symbol vector at pilot positions
rP;0
CNP1
Received symbol vector at pilot positions in slot 0
rP;1
CNP1
Received symbol vector at pilot positions in slot 1
RhD;hP
CNDNP
CCF matrix of data and pilot channel
RhP;hD
CNPND
CCF matrix of pilot and data channel
RhP;hP
CNPNP
ACF matrix of pilot channel
RhD;hD
CNDND
ACF matrix of data channel
t
R
Continuous time
T
R þ
OFDM symbol duration without cyclic preﬁx
Tcp
R þ
Cyclic preﬁx duration
Ts
R þ
OFDM symbol duration in the time domain
WN
CNN
DFT matrix of dimension N
x(t)
C
Continuous transmit signal
xn,k
C
Transmitted data symbol at subcarrier k and OFDM symbol n
xn,k
CNT1
Transmitted data symbol vector at subcarrier k and OFDM symbol n
xn;k½u; i
CNT1
Transmitted data symbol vector at time instant n and subcarrier k of
user u and cell i
xn
CNc1
Transmitted data symbol vector at subcarrier k and OFDM symbol n
xD
CND1
Vector with stacked data symbols
xP
CNP1
Vector with stacked pilot symbols
xðlÞ
P
CNc1
Vector with stacked pilot symbols in uplink layer l
XðlÞ
P
CNcNc
Matrix obtained from Diag (xðlÞ
P )
xL
CNc1
Vector with Zadoff–Chu uplink pilot sequence
xP;0
CNP1
Vector with pilot symbols in slot 0
xP;1
CNP1
Vector with pilot symbols in slot 1
yn,k
C
Received symbol after equalizer at subcarrier k and OFDM symbol n
yn,k
CNR1
Received symbol vector after equalizer at subcarrier k and OFDM
symbol n
yn;k½u; i
CNR1
Received symbol vector after equalizer at time instant n and
subcarrier k of user u and cell i
yICI
n;k
C
ICI vector at subcarrier k and OFDM symbol n
vn,k
C
Noise symbol at subcarrier k and OFDM symbol n
vk
C
Noise symbol at subcarrier k
vn,k
CNR1
Noise vector at subcarrier k and OFDM symbol n
vn
CNc1
Noise vector at OFDM symbol n

Acronyms
2D
Two-dimensional
3D
Three-dimensional
3GPP
3rd Generation Partnership Project
ACK
ACKnowledged
ALMMSE
Approximate Linear Minimum Mean Square Error
AMC
Adaptive Modulation and Coding
AP
Access Point
ARQ
Automatic Repeat reQuest
ASE
Area Spectral Efﬁciency
AWGN
Additive White Gaussian Noise
BCa
Bias-Corrected and accelerated
BCCH
Broadcast Control Channel
BCH
Broadcast Channel
BD
Block Diagonalization
BEP
Bit Error Probability
BER
Bit Error Ratio
BF
Beam Forming
BICM
Bit Interleaved Coded Modulation
BICMLR
Bit Interleaved Coded Modulation with Linear Receiver
BLEP
Block Error Probability
BLER
Block Error Ratio
BM
Boolean Model
BPP
Binomial Point Process
BPSK
Binary Phase Shift Keying
BS
Base Station
CA
Content Aware
CAM
Cooperative Awareness Message
CAPEX
Capital Expenditure
CAS
Centralized Antenna System
CB
Code Block
CC
Chase Combining
xxv

CCCH
Common Control Channel
CCDF
Complementary Cumulative Distribution Function
CCI
Co-Channel Interference
CDD
Cyclic Delay Diversity
CDF
Cumulative Distribution Function
CDI
Channel Direction Indicator
CDMA
Code-Division Multiple Access
CE
Channel Estimation
CF
Characteristic Function
CFO
Carrier Frequency Offset
CIR
Carrier to Interference Ratio
CL
Closed Loop
CLMI
Closed Loop Mutual Information
CLMILR
Closed Loop Mutual Information with Linear Receiver
CLSM
Closed Loop Spatial Multiplexing
CLT
Central Limit Theorem
CM
Coded Modulation
CoMP
Coordinated Multi-Point
COST
European COoperation in the ﬁeld of Scientiﬁc and Technical
research
CP
Cyclic Preﬁx
CPE
Common Phase Error
CPICH
Common Pilot CHannel
CPP
Control Plane
CPU
Central Processing Unit
CQI
Channel Quality Indicator
CRC
Cyclic Redundancy Check
CRLB
Cramér-Rao Lower Bound
CSG
Closed Subscriber Group
CSI
Channel State Information
CSI-RS
Channel State Information Reference Signal
CSIT
Channel State Information at the Transmitter
CTC
Convolutional Turbo Code
CU
Channel Use
CVQ
Channel Vector Quantization
CW
Codeword
DAS
Distributed Antennas System
DCCH
Dedicated Control Channel
DCH
Dedicated Channel
DFT
Discrete Fourier Transform
DHCP
Dynamic Host Conﬁguration Protocol
DiffServ
Differentiate Service
DL
Downlink
DLSCH
Downlink Shared Channel
DMRS
Demodulation Reference Signals
xxvi
Acronyms

DoF
Degrees of Freedom
DPC
Dirty Paper Coding
DPCCH
Dedicated Physical Control CHannel
DPDCH
Dedicated Physical Data CHannel
DS
Double-Stream
DSA
Dynamic Subcarrier Allocation
DSTTDSGRC
Double Space-Time Transmit Diversity with Sub-Group Rate
Control
DTCH
Dedicated Trafﬁc Channel
DTxAA
Double Transmit Antenna Array
ECDF
Empirical Cumulative Distribution Function
ECR
Effective Code Rate
EDGE
Enhanced Data Rates for Global system for mobile communi-
cations Evolution
EESM
Exponential Effective Signal to Interference and Noise Ratio
Mapping
EGC
Equal Gain Combining
eICIC
Enhanced Intercell Interference Coordination
eMBMS
Evolved Multimedia Broadcast Multicast Service
eNodeB
Evolved Base Station
EPC
Evolved Packet Core
ESM
Effective Signal to Interference and Noise Ratio Mapping
ETSI
European Telecommunications Standard Institute
EUTRA
Evolved Universal Terrestrial Radio Access
EUTRAN
Evolved Universal Terrestrial Radio Access Network
EVD
Extreme Value Distribution
EVehA
Extended Vehicular A
FAP
Femtocell Access Point
FBI
FeedBack Information
FD
Full Dimensional
FD-CDM
Frequency Domain Code Division Multiplexing
FDD
Frequency Division Duplex
FDMA
Frequency Division Multiple Access
FEC
Forward Error Correction
FFO
Fractional Frequency Offset
FFT
Fast Fourier Transform
FIFO
First In, First Out
FIR
Finite Impulse Response
FPGA
Field-Programmable Gate Array
FTP
File Transfer Protocol
GGSN
Gateway-General packet radio service Support Node
GIG
Generalized Integer Gamma
GOF
Goodness Of Fit
GOP
Group Of Pictures
GPRS
General Packet Radio Service
Acronyms
xxvii

GPS
Global Positioning System
GSCM
Geometry-based Stochastic Channel Model
GSM
Global System for Mobile communications
GSMR
Global System for Mobile communications—Rail(way)
HARQ
Hybrid Automatic Repeat reQuest
HCN
Heterogeneous Cellular Network
HeNB
Home evolved base station
HI
High Isolation
HPP
Homogeneous Point Process
HSDPA
High-Speed Downlink Packet Access
HSDPCCH
High-Speed Dedicated Physical Control CHannel
HSDSCH
High-Speed Downlink Shared CHannel
HSPA
High-Speed Packet Access
HSPDSCH
High-Speed Physical Downlink Shared CHannel
HSS
Home Subscriber Server
HSSCCH
High-Speed Shared Control CHannel
HST
High Speed Train
HSUPA
High-Speed Uplink Packet Access
IA
Interference Alignment
IC
Interference Cancelation
ICE
Inter-City Express
ICI
Inter-Carrier Interference
ICIC
Intercell Interference Coordination
IDE
Integrated Development Environment
IDFT
Inverse Discrete Fourier Transform
IEEE
Institute of Electrical and Electronics Engineers
IFFT
Inverse Fast Fourier Transform
IFO
Integer Frequency Offset
iid
independent and identically distributed
IMS
IP Multimedia Subsystem
IMT
International Mobile Telecommunications
IMT-A
International Mobile Telecommunications-Advanced
IP
Internet Protocol
IR
Incremental Redundancy
ISI
Inter-Symbol Interference
ISM
Industrial, Scientiﬁc and Medical
ISO
International Standard Organization
ITU
International Telecommunication Union
ITU-R
International Telecommunication Union—Radiocommunication
Sector
JFI
Jain’s Fairness Index
KS
Kolmogorov–Smirnov
LAN
Local Area Network
LDPC
Low Density Parity Check
LEP
Link Error Prediction
xxviii
Acronyms

LLR
Log-Likelihood Ratio
LMMSE
Linear Minimum Mean Square Error
LMMSE-MAP
Linear Minimum Mean Square Error Maximum A Posteriori
LOS
Line-Of-Sight
LS
Least Squares
LT
Laplace Transformation
LTE
Long-Term Evolution
LTEA
Long-Term Evolution-Advanced
LTER
LTE for Railway
MAC
Multiple Access Channel
MACd
Medium Access Control dedicated
MAChs
Medium Access Control for High-Speed Downlink Packet
Access
MAP
Maximum A-Posteriori
maxCI
Maximum Carrier-to-Interference ratio
MB
MacroBlock
MBMS
Multimedia Broadcast Multicast Service
MBSFN
Multimedia Broadcast/Multicast Single Frequency Network
MBS
Macrocell Base Station
MC
Monte Carlo
MCCH
Multicast Control Channel
MCH
Multicast Channel
MCS
Modulation and Coding Scheme
MET
Maximum Eigenmode Transmission
MEX
Matlab EXecutable
MGF
Moment Generating Function
MI
Mutual Information
MIESM
Mutual Information Effective Signal to Interference and Noise
Ratio Mapping
MIMO
Multiple-Input Multiple-Output
MISO
Multiple-Input Single-Output
ML
Maximum Likelihood
MLE
Maximum Likelihood Estimation
MME
Mobility Management Entity
MMSE
Minimum Mean Square Error
mm-wave
millimeter-wave
MoRSE
Mobile Radio Simulation Environment
MPEG
Moving Picture Expert Group
MRC
Maximum Ratio Combining
MRT
Maximum Ratio Transmission
MSE
Mean Square Error
MTCH
Multicast Control Channel
MTU
Maximum Transfer Unit
MU
Multi-User
MUMIMO
Multi-User Multiple-Input Multiple-Output
Acronyms
xxix

MVU
Minimum Variance Unbiased
NACK
Non-ACKnowledged
NAL
Network Abstract Layer
NAS
Non-Access Stratum
NBAP
NodeB Application Part
NDI
New Data Indicator
NI
No Isolation
NLOS
Non-Line of Sight
NodeB
Base station
NSAW
N Stop And Wait
NSN
Nokia Siemens Networks
OA
Open Acess
OFDM
Orthogonal Frequency Division Multiplexing
OFDMA
Orthogonal Frequency Division Multiple Access
OLMI
Open Loop Mutual Information
OLSM
Open Loop Spatial Multiplexing
OOP
Object-Oriented Programming
OPEX
Operational Expenditure
OSG
Open Subscriber Group
OSI
Open Systems Interconnection
O-to-I
Outdoor-to-Indoor
PAPR
Peak-to-Average Power Ratio
PARC
Per-Antenna Rate Control
PBCH
Physical Broadcast Channel
PC
Personal Computer
PCCC
Parallel Concatenated Convolutional Code
PCCH
Paging Control Channel
PCCPCH
Primary Common Control Physical Channel
PCH
Paging Channel
PCI
Precoding Control Indicator
PCIsock
Peripheral Component Interconnect
PCP
Poisson Cluster Process
PCPs
Poisson Cluster Processes
PCRF
Policy and Charging Rules Function
PDCCH
Physical Downlink Control Channel
PDCP
Packet Data Convergence Protocol
pdf
Probability density function
PDN
Packet Data Network
PDP
Power Delay Proﬁle
PDSCH
Physical Downlink Shared Channel
PDU
Packet Data Unit
PedA
Pedestrian A
PedB
Pedestrian B
PER
Packet Error Ratio
PF
Proportional Fair
xxx
Acronyms

PGFL
Probability Generating Functional
PGW
Packet Data Network Gateway
PHY
Physical
PLR
Packet Loss Ratio
PMCH
Physical Multicast Channel
PMI
Precoding Matrix Indicator
PN
Pseudo Noise
PP
Point Process
PPs
Poisson Processes
PPP
Poisson Point Process
PPPs
Poisson Point Processes
PPS
Pulse Per Second
PRACH
Physical Random Access Channel
PSCH
Primary Synchronization Signal
PSD
Power Spectral Density
PSK
Phase-Shift Keying
PSNR
Peak Signal-to-Noise Ratio
PSS
Primary Synchronization Signal
PUCCH
Physical Uplink Control Channel
PUSCH
Physical Uplink Shared Channel
QAM
Quadrature Amplitude Modulation
QBC
Quantization-Based Combining
QBICM
QuantizedBit Interleaved Coded Modulation
QCIF
Quarter Common Intermediate Format
QoE
Quality of Experience
QoS
Quality of Service
QPP
Quadratic Permutation Polynomial
QPSK
Quadrature Phase Shift Keying
QS
Quadratic Smoothing
QSBICM
Quantized and Shifted Bit Interleaved Coded Modulation
RAC
Random Closed Set
RACH
Random Access Channel
RAID
Redundant Array of Independent Disks
RAN
Radio Access Network
RAS
Receive Antenna Selection
RB
Resource Block
RE
Resource Element
RF
Radio Frequency
RFO
Residual Frequency Offset
RI
Rank Indicator
RLC
Radio Link Control
RLS
Recursive Least Squares
RMS
Root Mean Square
RN
Relay Node
RNC
Radio Network Controller
Acronyms
xxxi

ROI
Region Of Interest
ROP
Random Object Process
RR
Round Robin
RRC
Radio Resource Control
RRCﬁlt
Root Raised Cosine ﬁlter
RRE
Remote Radio Equipment
RRH
Remote Radio Head
RRM
Radio Resource Management
RRU
Remote Radio Unit
RS
Reference Signal
RS232
Recommended Standard 232
RS-CC
Reed–Solomon Convolutional Code
RTP
Real-time Transport Protocol
RV
Random Variable
Rvidx
Redundancy version index
RVQ
Random Vector Quantization
RX
Receiver
SAE
System Architecture Evolution
SBICM
Shifted Bit Interleaved Coded Modulation
SC-FDM
Single-Carrier Frequency Division Multiplexing
SC-FDMA
Single-Carrier Frequency Division Multiple Access
SCH
Synchronization Channel
SCM
Spatial Channel Model
SCME
Spatial Channel Model Extension
SDMA
Spatial Division Multiple Access
SDU
Service Data Unit
SER
Symbol Error Ratio
SGSN
Serving-General packet radio service Support Node
SGW
Serving Gateway
SIC
Successive Interference Cancelation
SID
Size Index Identiﬁer
SIMO
Single-Input Multiple-Output
SINR
Signal to Interference and Noise Ratio
SIR
Signal-to-Interference Ratio
SISO
Single-Input Single-Output
SM
Spatial Multiplexing
SNR
Signal-to-Noise Ratio
SQBC
Subspace Quantization-Based Combining
SQP
Sequential Quadratic Programming
SRS
Sounding Reference Signals
SS
Single-Stream
SSCH
Secondary Synchronization Signal
SSD
Soft Sphere Decoder
SSS
Secondary Synchronization Signal
STBC
Space-Time Block Code
xxxii
Acronyms

STMMSE
Space-Time Minimum Mean Squared Error
STTD
Space-Time Transmit Diversity
SU
Single-User
SUMIMO
Single-User Multiple-Input Multiple-Output
SUS
Semi-Orthogonal User Selection
SVD
Singular Value Decomposition
TAS
Transmit Antenna Selection
TB
Transport Block
TBS
Transport Block Size
TDD
Time Division Duplex
TFC
Transport Format Combination
TFCI
Transport Format Combination Indicator
TFT
Trafﬁc Flow Template
TM
Transmission Mode
TOS
Type Of Service
TPC
Transmit Power-Control
TR
Transmission Rate
TrCH
Transport CHannel
TSN
Transmission Sequence Number
TTI
Transmission Time Interval
TU
Typical Urban
TX
Transmitter
TxAA
Transmit Antenna Array
TxD
Transmit Diversity
UDP
User Datagram Protocol
UE
User Equipment
UL
Uplink
ULA
Uniform Linear Array
ULSCH
Uplink Shared Channel
UMa
Urban Macro cell
UMa-H
UMa-High rise
UMi
Urban Micro cell
UMTS
Universal Mobile Telecommunications System
UP
User Plane
USB
Universal Serial Bus
UTRA
Universal mobile telecommunications system Terrestrial Radio
Access
UTRAN
Universal mobile telecommunications system Terrestrial Radio
Access Network
VBLAST
Vertical Bell Laboratories Layered Space-Time
VCEG
Video Coding Expert Group
VCL
Video Coding Layer
VehA
Vehicular A
VHSIC
Very High Speed Integrated Circuits
VoIP
Voice over IP
Acronyms
xxxiii

WB-CLMI
Wideband Closed Loop Mutual Information
WB-CLMI-LR
Wideband Closed Loop Mutual Information with Linear Receiver
WCDMA
Wideband Code-Division Multiple Access
WiMAX
Worldwide Inter-Operability for Microwave Access
WINNER
Wireless World Initiative New Radio
WLAN
Wireless Local Area Network
WSSUS
Wide-Sense Stationary Uncorrelated Scattering
XPR
Cross Polarization Power Ratio
ZC
Zadoff-Chu
ZF
Zero Forcing
ZFBF
Zero Forcing Beam Forming
xxxiv
Acronyms

Part I
Link Level Simulations and Experiments
Up and Downlink–From Simulations to Experiments
In this ﬁrst part of the book the Vienna Link Level (LL) Simulators are described.
The ﬁrst chapter provides basics of LL simulations, introduces the most common
variables and parameters as well as the transceiver structures that are applied in
Long-Term Evolution (LTE) and Long-Term Evolution-Advanced (LTEA). We
focus here mostly on the Downlink (DL) of LTE as most results reported in later
chapters are related to DL transmissions.
Chapter 2 focuses on the DL synchronization, in particular how to optimally
estimate frequency offsets under various channel conditions. The interested reader
can ﬁnd more details on synchronization issues and frequency offset impact from Qi
Wang’s Ph.D. thesis available at http://theses.eurasip.org/theses/470/performance-
evaluation-of-practical-ofdm-systems/.
In Chap. 3 Ronald Nissel reports on his ﬁndings in the context of very high
mobility. As we are able to reproducibly measure at velocities of 400km/h, we were
interested in the performance of optimal decoding and Orthogonal Frequency
DivisionMultiplexing (OFDM) architectures under such extreme conditions.
Chapter 4 provides insight into optimal pilot pattern design. Here a method is
described that allows to match the pilot pattern optimally to a given Root
MeanSquare (RMS) delay spread and Doppler spread. Also the transmit power for
the pilots is selected optimally to achieve maximal mutual information. More
details are available in Michal Šimko’s Ph.D. thesis http://theses.eurasip.org/theses/
488/pilot-pattern-optimization-for-doubly-selective/.
Chapter 5 reviews the basic principles of link adaptation and linear precoding for
single-user Multiple-Input Multiple-Output (MIMO) transmission and evaluates
LTE’s DL Single-User (SU) MIMO transmission modes. The focus of this chapter
is on designing optimal limited feedback algorithms to enable efﬁcient operation
with quantized channel state information at the base station.

Chapters 6 and 7 put the scope on multi-user MIMO transmission. In Chap. 6
channel
state
information
quantization
algorithms
for
block-diagonalization
precoding are developed, exploiting the subspace structure of the precoder design
to enable efﬁcient quantization on the Grassmann manifold. Memoryless and pre-
dictive Grassmannian quantization algorithms are presented, with the latter utilizing
temporal channel correlation to improve quantization accuracy. In Chap. 7 these
quantizers are extended to OFDM transmission over frequency-selective channels.
Furthermore, systems with excess antennas at the receivers are considered and
receive antenna combiners that minimize the impact of channel state information
quantization errors are developed. The content of Chaps. 5–7 are taken from the
Ph.D. thesis of Stefan Schwarz; more detailed treatments of such techniques
are available in http://theses.eurasip.org/theses/514/limited-feedback-transceiver-
design-for-downlink/.
The Uplink (UL) simulator is the youngest of the Vienna LTE simulators. We
were ﬁrst hesitant to start this project as our main resources were bound to DL
simulations, but the requests for a UL LL simulator became stronger and stronger
from the community. We ﬁrst tried to spin the effort off by colleagues from TU
Brno [1] but they were also suffering a lack of students. In 2012 we ﬁnally decided
to set up some resources and, based on a few students’ work, we eventually got
started.
Our initial opinion was that the UL is a straightforward copy of the DL with just
some particularities such as Single-Carrier Frequency Division Multiple Access
(SC-FDMA), but soon we learned that there are signiﬁcant differences in both
worlds and concepts that proved to work well in the DL did not work equally in the
UL. In Chap. 8 Erich Zöchmann and Stefan Pratschner report on their ﬁndings for
channel estimation and interpolation in UL scenarios.
Early on there has always been the demand for experimental work to validate
link level simulations. In Chap. 9 Martin Lerch reports on LTE transmission sce-
narios and displays the truly obtained throughput.
Reference
[1] J. Blumenstein, J. Ikuno, J. Prokopec, and M. Rupp, Simulating the long term evolution uplink
physical layer, in Proceedings ELMAR, pp. 141–144, Zadar, (2011)
2
Part I:
Link Level Simulations and Experiments

Chapter 1
Link Level Simulation Basics
Markus Rupp, Stefan Schwarz and Martin Taranetz
This chapter serves to provide the basic background on Orthogonal Frequency
Division Multiplexing (OFDM) transmission and Multiple-Input Multiple-Output
(MIMO) transmissions for Multi-User (MU). We will introduce the most important
parameters used later on in the following chapters. The experts in Long Term Evo-
lution (LTE) can simply skip this chapter.
1.1
Some Basics on Wireless Channels and Notations
We model wireless channels by a two-dimensional time-variant channel impulse
response c(t, τ), reﬂecting that for each time instant t, we obtain a different impulse
response c(τ). Given such channel, we can perform Fourier transformations on both
parameters t and τ either individually or jointly. Figure1.1 displays the four different
representations. The most important transform is the time-variant transfer function
C(t, f ) obtained by Fourier transformation of the lag parameter τ. This function is
very much suitable for the OFDM transmissions of LTE and will be used extensively.
Applying the Fourier transform on the ﬁrst parameter t, we compute the so-called
spreading function C(S)(ν, τ). Finally, applying the Fourier transform on both para-
meters results in the so-called Doppler-variant transfer function C(D)(ν, f ).
As we are using sampled values in digital form, it makes sense to introduce the
corresponding sampled versions. Sampling with (Δt, Δτ, Δf, Δν), we obtain
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_1
3

4
M. Rupp et al.
Fig. 1.1 The Fourier transformations of the time-variant channel impulse response c(t, τ). Left
time-continuous description; right time-discrete version
cm,m′ = c(mΔt, m′Δτ),
(1.1)
Cm,k = C(mΔt, kΔf ),
(1.2)
C(S)
k′,m′ = C(S)(k′Δν, m′Δτ),
(1.3)
C(D)
k′,k = C(D)(k′Δν, kΔf ),
(1.4)
respectively. In this form the four terms describe two-dimensional sequences of
inﬁnite dimensions. More insight into these four functions can be found in the text-
book [1]. While the time index m typically remains unbounded, we will only employ
a limited bandwidth and thus the frequency index k will be limited by the number of
subcarriers that we design the OFDM transmission system for.
1.2
OFDM Basics
Consider data symbols xn,k; k = 0, 1, . . . , Nc −1 to be transmitted over a duration T
at time instant n in a Single-Input Single-Output (SISO) point-to-point transmission:
s(t) =
∞

n=−∞
Nc−1

k=0
xn,kgT,k(t −nT ),
(1.5)
thus being modulated with help of a pulse shaping ﬁlter
gT,k(t) =

1
√
T e j2πk t
T 0 ≤t < T
0
else.
(1.6)

1
Link Level Simulation Basics
5
In LTE T = 66.7 µs. For this speciﬁc pulse shaping ﬁlter, the modulation resembles
a so-called OFDM modulation that can be implemented very efﬁciently by a Fast
Fourier Transform (FFT) algorithm. Here, the number of subcarriers Nc deﬁnes how
many individual streams of data xn,k; k = 0, 1, . . . , Nc −1 are being transmitted.
Note that 1/T = Δf in (1.6) deﬁnes the subcarrier spacing. As not all subcarriers are
modulated with data symbols xn,k, the true number is typically larger and is equivalent
to the order NFFT > Nc of the FFT operation. The physical subcarrier spacing is
simply calculated by dividing the entire transmit bandwidth Bc by the number of
active subcarriers Nc, thus Δf = Bc
Nc =
B
NFFT . Note, however, that the bandwidth B >
Bc required for the transmission is larger as some subcarriers may not be modulated
but are required for different reasons, e.g., to facilitate the provisioning of analogue
ﬁlters that keep a security distance to carriers of other service providers. Note that
the given bandwidth B is what is offered to a service provider to use but OFDM
modulation theoretically requires an inﬁnite bandwidth due to the unlimited time-
frequency product of such signals. The demarcation to the next service provider’s
frequency range in practice is achieved by additional analogue ﬁlters. To understand
why the bandwidth of OFDM signals is unlimited, simply recall that
gT,k(t) = gT,k(t) · rectT (t).
(1.7)
The symbols are thus multiplied by a rectangular pulse in time (here rectT (t) = 1
for the symbol duration T and zero outside) which corresponds to the convolution
with a sinc function in frequency. The spectrum is deﬁned by the squared magnitude
of such sinc function and thus the occupied bandwidth is inﬁnite.
Once the generated signal s(t) is transmitted over a time-variant channel with
impulse response c(t, τ), we obtain at the receiver antenna the distorted signal
r(t) =
 τmax
0
c(t, τ)s(t −τ)dτ + v(t),
(1.8)
corrupted by the channel as well as additive noise v(t). To accommodate a channel
with maximal duration τmax, we introduce a so-called Cyclic Preﬁx (CP), that is
simply a fractional repetition of the transmit signal, placed in front of the signal.
In principle, it could also be a cyclic postﬁx, repeated after the symbol but in LTE
a CP was selected. In the Downlink (DL) of LTE two possible values of a CP are
allowed, a short one of duration Tcp = 4.7 µs and a long one of Tcp = 16.7 µs. To be
precise, when applying the short CP, the ﬁrst symbol has a CP of 5.2µs, the following
six are 4.7µs long. The reason for the different CP length of the ﬁrst symbol is to
make the overall slot length in terms of time units divisible by 15360. Seven OFDM
symbols together with their CPs make up one slot (Nf = 7). Then the pattern starts
again. The long CP is to be employed in high Root Mean Square (RMS) delay spread
scenarios. If this is used, only six symbols make up for one slot (Nf = 6). With a
typical CP length of 4.7µs and an FFT length of NFFT = 1024, we ﬁnd Ncp = 72.
In this example the CP length has a duration of 72 samples.

6
M. Rupp et al.
The pulse shaping with CP can be best modeled by modifying the pulse shaping
ﬁlter to:
gTs,k(t) =

1
√
T e j2πk t
T −Tcp ≤t < T
0
else
.
(1.9)
With such a pulse shape, the actual signal duration becomes a bit longer: Ts =
T + Tcp. Applying this pulse shape and assuming that the channel impulse response
is not exceeding Tcp, the convolution of (1.8) now reads during the period T of the
OFDM symbol at time instant n:
rT (t) =
 Tcp
0
c(t, τ)
Nc−1

k=0
xn,kgTs,k(t −τ −nTs)dτ + v(t)
(1.10)
=
1
√
T
 Tcp
0
c(t, τ)
Nc−1

k=0
xn,ke j2πk t−τ−nTs
T
dτ + v(t)
(1.11)
=
Nc−1

k=0
1
√
T
 Tcp
0
c(t, τ)e−j2πk τ
T dτxn,ke j2πk t−nTs
T
+ v(t)
(1.12)
=
1
√
T
Nc−1

k=0
C(t, kΔf )xn,ke j2πk t−nTs
T
+ v(t),
(1.13)
with C(t, f ) denoting the time-variant transfer function from Eq.(1.2). Due to the CP
extension, no Inter-Symbol Interference (ISI) occurs from the previous symbols and
as a further consequence, the time-variant transfer function C(t, kΔt) fully describes
the transmission system.
At the receiver end we sample the observed signal, say with NFFT samples per
period T . Starting at the beginning of the symbol the sampling period per symbol runs
from tm = (n −1)Ts + Tcp + mΔt, m = 0, 1, . . . , NFFT −1, with Δt =
T
NFFT = Ts
Ns .
The receiver thus performs at every time instant n a Fourier transform of the sampled
symbol:
rn,k =
√
T
NFFT
NFFT−1

m=0
rT (tm = mΔt + (n −1)Ts + Tcp)e−j2π
mk
NFFT + vn,k
(1.14)
= 1
N
N−1

m=0
Nc−1

k′=0
C(mΔt + (n −1)Ts + Tcp, k′Δf )
· xn,k′e j2πk′ mΔt+(n−1)Ts+Tcp−nTs
T
e−j2π
mk
NFFT + vn,k,
(1.15)
=
1
NFFT
NFFT−1

m=0
Nc−1

k′=0
C(mΔt + (n −1)Ts + Tcp, k′Δf )xn,k′e j2π (k′−k)m
NFFT + vn,k.
(1.16)

1
Link Level Simulation Basics
7
We now reformulate the term during mΔt + (n −1)Ts + Tcp = Δt(m −NFFT +
nNs) which allows us to introduce a time-variant transfer function that only depends
on discrete parameters: Cm−NFFT+nNs,k′ = C(mΔt + (n −1)Ts + Tcp, k′Δf ). This
allows now a much more compact formulation
rn,k =
1
NFFT
NFFT−1

m=0
Nc−1

k′=0
Cm−NFFT+nNs,k′xn,k′e j2π (k′−k)m
NFFT + vn,k.
(1.17)
Figure1.2 depicts the scenario showing a time-frequency resource grid with sym-
bols and their CP associated with the magnitude of a potential time-variant transfer
function Cm,k. The ﬁgure also contains the placement of the pilot positions as they
are speciﬁed in the LTE standards for DL transmissions.
Understanding Eq.(1.17) now is crucial for the understanding of OFDM transmis-
sions over time-variant channels. We would like to obtain rn,k = xn,k only hampered
by the additive noise term vn,k. If we have a time-invariant transfer function Ck′, the
dependence of the channel on m and n disappears. Only for k = k′, one element
remains and we obtain rn,k = Ckxn,k + vn,k, or in form of a diagonal channel matrix
D containing all elements of Ck on its diagonal. This allows us to formulate a simple
transmission model from transmit symbols xn,k to observed noisy symbols rn,k after
the FFT operation at the receiver in vector notation:
Fig. 1.2 A possible realization of the sampled time-variant transfer function Cm,k for Nc = 13,
Nf = 15, N = 13 and Ncp = 2. Data symbols xn,k are transmitted over a Nc × Nf frequency-time
grid, whereas Hn,k denotes the piecewise time-average of Cm,k. The pilot symbol positions are
chosen according to the LTE standard for DL transmissions

8
M. Rupp et al.
rn = Dxn + vn,
(1.18)
where we concatenated all data symbols xn,k at time instant n over all subcarriers
in vector xn ∈CNc×1 and all sampled received values rn,k after FFT in vector
rn ∈CNc×1. The additive noise is considered vn ∼NC

0, PV INc

as sampled white
Gaussian noise after a uniform FFT transformation preserves its statistical properties.
Note that the noise statistics are preserved by the Fourier transform and simply reuse
the same notation vn,k. Once the channel taps, that is the diagonal values of D are
known, the corresponding receiver can then simply apply its inverse and so obtain
good and low complex estimates of xn,k:
ˆxn = D−1rn = rn + D−1vn,
(1.19)
well-known as the Zero Forcing (ZF) receiver (one-tap receiver for SISO transmis-
sions).
As soon as the channel is time-variant, however, the situation becomes somewhat
more complicated. Equation(1.17) tells us now that all data symbols xn,k at time
instant n of all Nc subcarriers have an inﬂuence on the decoded value. Even in the
absence of noise, there exists an Inter-Carrier Interference (ICI) that corrupts the
data and prevents simple detection schemes. We can still describe the mapping from
xn to rn by a matrix but such matrix is no longer diagonal and also dependent on
time-instant n:
rn = Dnxn + vn,
(1.20)
where we identify all elements of matrix D from (1.17)
[Dn]k,k′ =
1
NFFT
NFFT−1

m=0
Cm−NFFT+nNs,k′e j2π (k′−k)m
NFFT ,
k, k′ = 0, 1, . . . , Nc −1.
(1.21)
We can now interpret the elements of Dn as the Fourier transformed values of the
time-variant transfer function. In particular the elements on the main diagonal k = k′,
are the piecewise time-averaged values Hn,k of the channel transfer function Cm,k at
time instant n. With hn = diag (Dn), we can thus equivalently formulate Eq.(1.20)
in a very compact form in which now xn, rn and vn ∈CNc×1:
rn = Diag (hn) xn + yICI
n
+ vn,
(1.22)
where we split the data symbol part in a diagonal part associated with hn and a non-
diagonal part yICI
n
that depends on channel and data. For time-invariant channels, we
ﬁnd that yICI
n
= 0.
At this point several important comments are required:
• The presented concept here requires a perfect synchronization to start the sampling
exactlyatthebeginningoftheOFDMsymbol.However,duetotheCPthesampling

1
Link Level Simulation Basics
9
can also start a bit earlier as the symbol is preserved as long as the sampling points
are not earlier than Tcp −τmax before the symbol starts.
• The presentation here is for a simple SISO system, the extension to MIMO trans-
missions with NT transmit and NR receive antennas is straightforward; the time-
variant matrix Dn becomes multidimensional, its main diagonal elements Hn,k
then become NR × NT dimensional matrices Hn,k. The m,lth entry of this matrix
is referred to as [Hn,k]m,l; m = 1, 2, . . . , NR;l = 1, 2, . . . , NT.
• We did not mention transmit power so far. If it is included, Eq.(1.22) is modiﬁed
to
rn = Diag (hn)

PSxn + yICI
n
+ vn,
(1.23)
which also scales the ICI term yICI
n . In a MIMO transmission also precoding
matrices Fn,k can be included for each xn,k at every entry of the time-frequency
grid (n, k) and we obtain
rn,k = Hn,kFn,kxn,k + yICI
n,k + vn,k,
(1.24)
where the precoding matrix includes the transmit power term. Once an equalizer
Gn,k is applied, the corresponding signal is
yn,k = Gn,k

Hn,kFn,kxn,k + yICI
n,k + vn,k

.
(1.25)
• Similarly to the presented concept here also Single-Carrier Frequency Division
Multiplexing (SC-FDM) can be described, in which an FFT operation followed
by an inverse FFT causes a mixing of the symbols including pilots over the subcar-
riers. The FFT operation is typically employed twice after the reception to include
an equalizer stage. Multiple FFT and inverse FFT schemes keep the transmission
properties more or less equivalent due to the linearity of the channel. However, non-
linear power ampliﬁers as well the different treatment of the additive noise cause
some differences in the behavior when compared to OFDM transmissions. Due to
smaller Peak-to-Average Power Ratio (PAPR) values, the SC-FDM transmission
mode is employed in the Uplink (UL) of LTE and Long Term Evolution-Advanced
(LTE-A) while OFDM is used in the DL. A more detailed description of SC-FDM
can be found in Chap.8.
At this point we like to refer the interested reader to some classical textbooks, see,
e.g., [2–4], for more details on OFDM transmissions.
1.3
Advanced Features: ICI Modeling
As shown in Eq.(1.22) the ICI component is relatively complex as it contains data
as well as channel components. Although often argued that due to a sum of multiple
independent sources, the Central Limit Theorem would hold and the corresponding

10
M. Rupp et al.
signal is Gaussian distributed, the nature of this signal is not easily described as
such. It certainly can be described by a Gaussian mixture process [5]. Nevertheless,
once multiple transmit antennas come into play, ICI can become more Gaussian and
with additional coding the obtained ICI impacts throughput of OFDM transmission
systems very much like Gaussian distortions with proper signal power. This section
describes how we model ICI in system level simulations and we validate our results
for high speed channels, as it may occur in high speed trains or even transmissions
to airplanes.
1.3.1
Analytical Model
The impulse response of the channel is described by cm,m′ as described in Eq.(1.1),
the indexes denoting the tap gain of the m′th tap at time instant m. We can express
cm,m′ as: cm,m′ = L ·cm,m′, where L denotes macroscopic pathloss and shadow fading
that remains a constant for a longer time period and cm,m′ represents microscopic
fading. We consider for this a so-called Wide-Sense Stationary Uncorrelated Scat-
tering (WSSUS) channel model [1, 6], where the channel can be characterized by
its statistics, such as the Power Delay Proﬁle (PDP) and its scattering function [1].
According to these assumptions, and further assuming a two-dimensional propaga-
tion scenario, the autocorrelation function of the channel at time indexes m1, m2 and
channel taps m′
1, m′
2 is
E{cm1,m′
1c∗
m2,m′
2} = c|L|2J0
	
2π fdΔt(m1 −m2)

δ(m′
1 −m′
2),
(1.26)
where c is a normalization constant, J0(·) denotes the zeroth-order Bessel function
of the ﬁrst kind, fd is the Doppler frequency and Δt is the sampling time. The inverse
Fourier transform of the Doppler spectrum is its autocorrelation function which is
in two-dimensional propagation scenarios well described by the zeroth-order Bessel
function J0(·) of the ﬁrst kind [7].
We can write Eq.(1.22) as
rn,k = Hn,k

PSxn,k + yICI
n,k + vn,k,
k = 0, 1, . . . , Nc.
(1.27)
As derived in [8], the power of the ICI term can be calculated as
E{PICI
n,k } = |L|2PS
N 2
FFT
Nc−1

m=0,m̸=k
NFFT−1

m1=0
NFFT−1

m2=0
J0
	
2π fdΔt(m1 −m2)

· exp

j 2π(m1 −m2)(m −k)
NFFT

.
(1.28)

1
Link Level Simulation Basics
11
We recognize that the ICI power is a function of the subcarrier index k. Further we
will indicate the overall ICI power at subcarrier k as PICI
k
= E{|yICI
n,k|2}. Obviously
here, the averaging has been performed over all possible data and thus the dependency
on symbol n is lost.
1.3.2
Extension to MIMO Transmissions
In this subsection we extend our transmission system model to MIMO transmissions.
Let Fk be an NT × NL dimensional semi-unitary precoding matrix. Assuming equal
power allocation at transmit antennas (according to the LTE standard) and making
an assumption that the channels between the transmit antennas at each base station
are statistically independent, we can extend our model as
rn,k = Hn,kFn,kxn,k + yICI
n,k + vn,k
(1.29)
where rn,k is the received vector of size NR × 1, Hn,k is the averaged channel matrix
of size NR × NT , vn,k is the noise vector and vector yICI
n,k introduces the total ICI
power at each time instant n.
Underanisotropicprecoderassumption,theautocorrelationofthetransmitsignals
can be expressed as
E{(Fn,kxn,k)(Fn,kxn,k)H} = PS
NT
I
(1.30)
where E{∥xn,k∥2
2} = NL and E{Fn,kFH
n,k} = PS
NT I. Based on this assumption, the ICI
terms from different antennas are uncorrelated. The ICI on receive antenna i, i.e.,
element [yICI
n,k]i of vector yICI
n,k, is obtained by summing up the contributions from all
NT transmit antennas:
[yICI
n,k]i =
NT

m=1
yICI,m
n,k
1
NT
.
(1.31)
This ﬁnally allows to compute ICI in MIMO transmissions and then add it as addi-
tional Gaussian noise in a simple model. Even though the ICI is not Gaussian dis-
tributed, it might converge to Gaussian due to Central limit theorem for sufﬁciently
large NT. This may become handy for so-called massive MIMO technologies that
are being discussed for the 5th Generation in wireless cellular transmissions.

12
M. Rupp et al.
1.3.3
Performance Evaluation
In this subsection we provide the validation of our ICI analytical model. As already
mentioned at the receiver the ICI noise can be treated as additional complex-valued
Gaussian noise with distribution
yICI
n,k ∼NC

0, PICI
n,k · I

.
(1.32)
To obtain a similar performance to fast fading simulations, however, it is neces-
sary to additionally decrease the length of the fading blocks in case of block fading
simulations of high user velocity systems, to account for the reduced coherence time
of the channel. Below we demonstrate the validity of the implemented ICI abstrac-
tion model by comparing the throughput obtained with fast-fading simulations, i.e.,
when the channel varies during one OFDM symbol causing ICI, to the performance
achieved with block-fading simulations and adding Gaussian noise to emulate the ICI
effects. To demonstrate the validity of the implemented ICI abstraction, we compare
results with the Vienna LTE link level simulator that allows a very detailed mod-
eling of the various signal sources. In Figs.1.3 and 1.4 we compare the achievable
throughput and BLER. We recognize that with appropriate ICI calculation and short-
ened block-fading length we can almost perfectly mimic the fast-fading behaviour
and, as a consequence, simulate with high accuracy systems with high mobility users.
Similar performance can be observed in the case of MIMO transmissions which is
depicted in Fig.1.5.
Fig. 1.3 Comparison of BLER between fast-fading and block-fading simulation with shortened
block-fading length. Simulations of block-fading channels with block fading length of 1, 3, 4, 7 and
14 OFDM symbols are considered

1
Link Level Simulation Basics
13
Fig. 1.4 Justiﬁcation of ICI abstraction model at 2GHz center frequency. Simulations of block-
fading channels with block fading length of 1, 3, 4, 7 and 14 OFDM symbols are considered
Fig. 1.5 Comparison of 4 × 2 MIMO transmissions with system and link level simulations

14
M. Rupp et al.
1.4
LTE in a Nutshell
Understanding how OFDM transmissions work, makes the essential part of LTE but
a lot more details are required in order to understand what options LTE and LTE-A
offer. The entire transmitter architecture for DL transmissions is depicted in Fig.1.6
about which we have only explained the last box in the previous section. Going
from left to right, the pure data bits are going through an interleaver, shufﬂing the bit
locations to reduce burst errors and introducing coding as well as various modulation
schemes. In LTE 32 so called Modulation and Coding Schemes (MCSs) are deﬁned.
They all are a pair of coding and modulation schemes. Here, four modulation schemes
are in use all based on Quadrature Amplitude Modulation (QAM): Binary Phase Shift
Keying (BPSK), 4-QAM, 16-QAM and 64-QAM. Note that in many 3rd Generation
Partnership Project (3GPP) documents modulation schemes referred to BPSK and
Quadrature Phase Shift Keying (QPSK) are actually QAM modulation schemes. As
only the symbol constellation in the I-Q plane is of interest, the more modulation
details do not matter here. A turbo coder, very similar to the 3GPP scheme for
3rd generation allows to vary the code rate between 1/2 in many steps up to 5/6.
The selection of the MCS is made adaptively based on the Channel Quality Indicator
(CQI) which is feedback information from the receivers. As the selection of the MCS
is adaptive, it is called Adaptive Modulation and Coding (AMC). More details on
how the CQI value is selected, are explained further ahead in Sect.1.6. The next phase
in Fig.1.6 is the MIMO processing required if transmitted over more than a single
antenna. LTE supports NT = 2 and NT = 4 transmit antennas, LTE-A even eight
of them. Depending on the Rank Indicator (RI) which is also feedback information
delivered from the User Equipments (UEs), the transmitter selects the number of
layers (or streams) over which the data stream is transferred. In LTE a set of Nf = 7
OFDM symbols at six adjacent subcarriers is combined to form a so-called Resource
Element (RE). These seven symbols span the duration of 0.5ms, called a slot. In the
Fig. 1.6 MIMO OFDM transceiver architecture

1
Link Level Simulation Basics
15
investigations of this book we even allow the scheduler a ﬁner granularity, i.e., each
symbol in the time-frequency plane is assigned to a number ℓn,k[u, 0] of layers it will
make use of. By this user u is assigned its resources. With each data stream comes a
so-called precoding matrix Fn,k[u, 0] selected with help of a third piece of feedback
information, the Precoding Matrix Indicator (PMI).
With all this information on resource allocation for each user u, the data streams
are mapped into the time-frequency plane, signaling information is added as well and
ﬁnally the Inverse Discrete Fourier Transform (IDFT) operation with the additive CP
as explained in the previous section is performed. There is many textbooks on LTE
available that we recommend the reader to for more details, see e.g., [9–11]. The UL
behaves very similar and is described in more detail in Chap.8.
The receiver architecture is more or less the transmitter in backward order.
Receivers are called UE in LTE terminology and can have an arbitrary number of
receiver antennas NR. The ﬁrst step after the Discrete Fourier Transform (DFT) oper-
ation and removing of the CP is to apply an equalizer Gn,k to minimize interference
between layers and potentially reduce noise impact. A transmission chain can thus
be abstracted to the simple form
rn,k = Gn,kHn,kFn,kxn,k + vn,k,
(1.33)
of which we understand now that for each point (n, k) of the time-frequency plane
the entire transmission including the wireless channel and the OFDM modulation is
condensed in an equivalent channel matrix Hn,k ∈CNR×NT, the NT antennas at the
transmitter are controlled by the precoding matrix Fn,k and the receiver applies an
equalizer Gn,k on its NR receive antennas. If the base station is concerned (typically
in the DL), often the channel and the equalizer are combined as effective channel
H(eff)
n,k = Gn,kHn,k.
(1.34)
However, if the receiver is in the focus, it may make sense to combine the precoding
with the channel and deﬁne H(eff)
n,k = Hn,kFn,k. However, if this happens we will refer
to it in the text. In general we use the short form (1.34).
1.5
Input–Output Relationship of a Cellular User
A single point-to-point connection from a base station, in LTE called Evolved Base
Station (eNodeB), to a UE does not make an LTE network yet. The modeling of a
cellular network consisting of I + 1 cells is under consideration in the following.
In Fig.1.7 we depict a single eNodeB serving multiple UEs in three sectors, which
employs so called Remote Radio Units (RRUs). Such RRUs are becoming more
and more common as they offer low cost solutions with increased coverage. They
typically consist of a set of antennas with power ampliﬁers and are connected via
ﬁber glass to a single eNodeB that does all the processing of data.

16
M. Rupp et al.
Fig. 1.7 Segment of an
exemplary cellular network
serving multiple users over
sectorized macro base
stations and remote radio
units
In each cell i ∈{0, . . . , I}, the attached users are served via a central antenna array
that is located at the macro base station and consists of NT[0, i] antenna elements.
Note that we denote the central eNodeB by index 0, while the surrounding base
stations have higher indexes. Additionally, the cell is supplied with Ri RRUs that
are distributed over the cell area, as illustrated in Fig.1.7. RRU r ∈{1, . . . , Ri} is
equipped with an antenna array comprising NT[r, i] antenna elements. The total
number of transmit antennas available in cell i is denoted NT[i] = Ri
r=0 NT[r, i].
In cell i, a total number of Ui users is served. The receive antenna array of user
u ∈Ui, Ui = {1, . . . ,Ui} is composed of NR[u, i] antennas. The channel between
user u in cell i and RRU r in cell j at OFDM subcarrier NFFT and symbol-time k
is described by an NR[u, i] × NT[r, j] dimensional complex-valued channel matrix
H(r, j)
n,k [u, i], employing the equivalent complex baseband representation of the OFDM
wireless communication system, see, e.g., [2–4]. The channels to the central antenna
array of cell j as well as all R j RRUs are combined in the matrix
H( j)
n,k[u, i] =

H(0, j)
n,k [u, i], . . . , H
(R j, j)
n,k
[u, i]

∈CNR[u,i]×NT[ j].
(1.35)
To simplify notation, the superscript ( j) is omitted whenever in-cell channels, j = i,
are considered. Also, if the description of an algorithm or method is independent
of the subcarrier index NFFT and/or the symbol-time index k, the respective index
is dropped. Such situations are particularly indicated in the text. Following LTE
notations, the subcarrier and symbol-time index pair (n, k) is denoted as a RE.
The set of users that is selected by the scheduling algorithm of cell i to be served
on a given RE is denoted Sn,k[i] ⊆Ui. The employed Single User Multiple-Input

1
Link Level Simulation Basics
17
Multiple-Output (SU-MIMO) and Multi User Multiple-Input Multiple-Output (MU-
MIMO) schedulers are described in detail in Chaps.5 and 6, respectively. The number
of served users in cell i on RE (n, k) is given by Sn,k[i] = |Sn,k[i]|. The transmit
symbol vector intended for user u ∈Sn,k[i] is written as xn,k[u, i] ∈Cℓk[u,i]×1, with
ℓk[u, i] ≤NR[u, i] being the number of data-streams spatially multiplexed to user
u. In general, the number of streams per user ℓk[u, i] could potentially change
over subcarriers. With the considered LTE compliant transceiver architecture shown
in Fig.1.6 this is not possible, because the mapping of the user data onto spatial
streams (layer mapping) is performed before the mapping onto REs. Hence, ℓk[u, i]
can at most change from one OFDM symbol to the next, provided that each OFDM
symbol is coded individually. In LTE the number of streams per user is constant
for the duration of one slot consisting of seven OFDM symbols (Nf = 7), provided
the short CP is employed. It is assumed that such restrictions are handled by the
scheduler.
The total number of streams of cell i transmitted on RE (n, k) is denoted
ℓn,k[i] = 
u∈Sn,k[i] ℓk[u, i]. To account for the maximum possible spatial multi-
plexing capabilities of the base station in cell i, the number of streams is constrained
as ℓn,k[i] ≤NT[i]. Although ℓk[u, i] is independent of the subcarrier index, the
total number of streams depends on NFFT due to the frequency selective multi-user
scheduling. The transmit symbol vector is normalized as
E

xn,k[u, i] xn,k[u, i]H
= Iℓk[u,i].
(1.36)
Prior to transmission over the wireless channel, the user symbol vector xn,k[u, i]
is precoded with a precoding matrix Fn,k[u, i] ∈CNT[i]×ℓk[u,i], mapping the ℓk[u, i]-
dimensional transmit symbol vector onto the NT[i] transmit antennas. Notice that the
allocation of the available transmit power Pn,k[i] among users and spatial streams is
considered in the precoding matrices, as detailed in Chaps.5 and 6. The precoders are
obtained such that Pn,k[i] is conserved, irrespective of the number of users and spatial
streams. In the simulation results presented in the following chapters, power loading
over REs is not considered: Pn,k[i] = Pi, ∀n, k. Better performance can be achieved
by allocating the available transmit power over subcarriers following a water-ﬁlling
power allocation policy [12], provided the required Channel State Information at the
Transmitter (CSIT) is available.
With this notation, the NR[u, i]-dimensional received signal vector of user u in
cell i at RE (n, k) is
rn,k[u, i] = Hn,k[u, i]Fn,k[u, i]xn,k[u, i] + Hn,k[u, i]

s∈Sn,k[i]
s̸=u
Fn,k[s, i]xn,k[s, i]
+
I

j=0, j̸=i
H( j)
n,k[u, i]

s∈Sn,k[ j]
Fn,k[s, j]xn,k[s, j] + zn,k[u, i]



˜zn,k[u,i]
,
(1.37)

18
M. Rupp et al.
where the Additive White Gaussian Noise (AWGN) added at the receiver is denoted
zn,k[u, i] ∈NC

0, σ 2
z INR[u,i]

. The intended signal of user u is represented by the
ﬁrst summand in this equation. In-cell interference between the streams spatially
multiplexed to several users in the same cell i is captured in the second summand.
Out-of-cell interference from other cells j ̸= i of the cellular network is taken into
account in the third term on the right hand side of Eq.(1.37). The sum of out-of-cell
interference and receiver noise is called the effective noise vector ˜zn,k[u, i].
The users are assumed to employ linear receive ﬁlters to equalize their respective
channels and to separate the spatially multiplexed data-streams from each other
and from the interference caused by the transmission to other users. The ℓk[u, i] ×
NR[u, i] dimensional receive ﬁltering matrix applied by user u in cell i is written as
Gn,k[u, i]. Applying this matrix to the received signal vector, the estimated symbol
vector is obtained as
yn,k[u, i] = Gn,k[u, i] rn,k[u, i] = Gn,k[u, i]Hn,k[u, i]Fn,k[u, i]xn,k[u, i]
+ Gn,k[u, i]Hn,k[u, i]

s∈Sn,k[i]
s̸=u
Fn,k[s, i]xn,k[s, i] + Gn,k[u, i] ˜zn,k[u, i].
(1.38)
The product of channel matrix and receive ﬁlter is referred to as effective channel
matrix
H(eff)
n,k [u, i] = Gn,k[u, i]Hn,k[u, i].
(1.39)
In Chaps.6 and 7, we will employ an alternative representation of channel matrices
and receive ﬁlters using their conjugate transposes:
H(ct)
n,k [u, i] = Hn,k[u, i]H ∈CNT[i]×NR[u,i],
(1.40)
G(ct)
n,k [u, i] = Gn,k[u, i]H ∈CNR[u,i]×ℓk[u,i],
(1.41)
H(ect)
n,k [u, i] = H(eff)
n,k [u, i]H = (Gn,k[u, i]Hn,k[u, i])H
= H(ct)
n,k [u, i]G(ct)
n,k [u, i] ∈CNT[i]×ℓk[u,i].
(1.42)
This representation facilitates highly intuitive subspace interpretations in the context
of multi-user MIMO transmission and considerably shortens notation for precoder
calculation. The corresponding input–output relationship reads
yn,k[u, i] = H(ect)
n,k [u, i]HFn,k[u, i]xn,k[u, i]
+ H(ect)
n,k [u, i]H

s∈Sn,k[i]
s̸=u
Fn,k[s, i]xn,k[s, i] + G(ct)
n,k [u, i]H ˜zn,k[u, i].
(1.43)

1
Link Level Simulation Basics
19
Considering the transceiver architecture of Fig.1.6, all signal processing steps
starting from the spatial streams at the output of the layer mapper up to the received
signal, obtained at the receiver after the inverse OFDM processing and the equaliza-
tion, are incorporated in the input–output relationships (1.38) and (1.43). The non-
linear mappings involved in the AMC stage are not covered by the system model,
but are considered in more detail in Chap.5.
1.6
Instantaneous Post-equalization SINR
The supported transmission rate of communication channels is frequently subject to
signiﬁcant ﬂuctuations over time and frequency. Such fading effects are especially
pronounced in cellular communication systems, where multipath propagation caused
by reﬂections and refractions, shadowing of the radio signal due to obstacles, and
movement of the users and/or obstacles can result in variations of the signal strength
in the order of tens of decibels [13]. A common method to respond to these fading
effects is the application of transmission rate adaptation, e.g., by means of AMC as
employed in LTE, such as to match the current data rate to the channel conditions. As
detailed throughout Chap.5, rate adaptation in practical systems can be based on the
instantaneous per-stream Signal to Interference and Noise Ratio (SINR) experienced
after the receive ﬁlter. Considering the input–output relationship of Eq.(1.38), the
instantaneous post-equalization SINR of stream ν ∈{1, . . . , ℓk[u, i]} of user u in
cell i is obtained as
βn,k[ν, u, i] =
Sn,k[ν, u, i]
Zn,k[ν, u, i] + I (self)
n,k [ν, u, i] + I (in)
n,k [ν, u, i] + I (out)
n,k [ν, u, i]
,
(1.44)
Sn,k[ν, u, i] =
gn,k[ν, u, i]HHn,k[u, i]fn,k[ν, u, i]
2 ,
Zn,k[ν, u, i] = σ 2
z
gn,k[ν, u, i]
2 ,
I (self)
n,k [ν, u, i] =
ℓk[k]

μ=1,μ̸=ν
gn,k[ν, u, i]HHn,k[u, i]fn,k[μ, u, i]
2 ,
I (in)
n,k [ν, u, i] =

s∈Sn,k[i]
s̸=u
gn,k[ν, u, i]HHn,k[u, i]Fn,k[s, i]
2 ,
I (out)
n,k [ν, u, i] =
I

j=0, j̸=i

s∈Sn,k[ j]
gn,k[ν, u, i]HHn,k[u, i]Fn,k[s, j]
2 ,
wheregn,k[ν, u, i]andfn,k[ν, u, i]denotetheνthcolumnofGn,k[u, i]H andFn,k[u, i],
respectively. Notice that the statistical independence of the data symbols of the

20
M. Rupp et al.
streams of a user according to Eq.(1.36) has been exploited to obtain Eq.(1.44),
and that the symbols of different users are too assumed as statistically independent
E

xn,k[u, i]xs, j[n, k]H
= 0ℓk[u,i]×ℓk[s, j], whenever u ̸= s ∨i ̸= j.
(1.45)
In Eq.(1.44), the useful signal power of stream ν is represented by the term
Sn,k[ν, u, i] in the numerator. The residual interference power between the streams
of the user after equalization is given by I (self)
n,k [ν, u, i]. The in-cell interference power
on stream ν from other users that are served in parallel in the same cell i is denoted
I (in)
n,k [ν, u, i], and the out-of-cell interference power from other cells that operate at
the same frequency is captured in the term I (out)
n,k [ν, u, i]. Notice that depending on
the considered transmission and reception strategy, some of these terms are equal to
zero, e.g., for SU-MIMO there is no in-cell interference. In Chaps.5 and 6 this gen-
eral SINR expression is further specialized to account for the considered transceiver
architectures.
References
1. A. Molisch, Wireless Communications (Wiley, New York, 2005)
2. S. Haykin, An Introduction to Analog and Digital Communications (Wiley, New York, 1989)
3. T. Chiueh, P. Tsai, OFDM Baseband Receiver Design for Wireless Communications (Wiley,
New York, 2008)
4. Y. Cho, J. Kim, W. Yang, C. Kang, MIMO-OFDM Wireless Communications with MATLAB
(Wiley, Singapore, 2010)
5. T. Wang, J. Proakis, E. Masry, J. Zeidler, Performance degradation of OFDM systems due to
Doppler spreading. IEEE Trans. Wirel. Commun. 5(6), 1422–1432 (2006). doi:10.1109/TWC.
2006.1638663
6. P. Bello, Characterization of randomly time-variant linear channels. IEEE Trans. Commun.
Syst. 11(4), 360–393 (1963)
7. R. Clarke, A statistical theory of mobile-radio reception. Bell Syst. Tech. J. 47(6), 957–1000
(1968)
8. Y.-S. Choi, P.J. Voltz, F.A. Cassara, On channel estimation and detection for multicarrier signals
in fast and selective Rayleigh fading channels. IEEE Trans. Commun. 49(8), 1375–1387 (2001)
9. E. Dahlman, S. Parvall, J. Skold, P. Beming, 3G Evolution: HSPA and LTE for Mobile Broad-
band (Academic Press, Orlando, 2007)
10. S. Sesia, M. Baker, I. Touﬁk, LTE, the UMTS Long Term Evolution: From Theory to Practice
(Wiley, New York, 2009)
11. S. Caban, C. Mehlführer, M. Rupp, M. Wrulich, Evaluation of HSDPA and LTE: From Testbed
Measurements to System Level Performance (Wiley, UK, 2012)
12. J.A.C. Bingham, Multicarrier modulation for data transmission: an idea whose time has come.
IEEE Commun. Mag. 28(5), 5–14 (1990)
13. D. Tse, P. Viswanath, Fundamentals of Wireless Communication, Wiley series in telecommu-
nications (Cambridge University Press, Cambridge, 2005)

Chapter 2
Downlink Synchronization
Qi Wang
In this chapter, we present a framework for link performance evaluation of a Long
Term Evolution (LTE) downlink with imperfect carrier frequency synchronization.
This framework interconnects three performance metrics, namely mean squared error
of the carrier frequency offset estimation, post-equalization signal-to-interference-
plus-noise ratio, and eventually bit-interleaved coded modulation capacity. With the
presented framework, the throughput loss from a residual Carrier Frequency Offset
(CFO) estimation error can be analytically determined, given standardized OFDM
transmission parameters. In order to validate this mathematical model, extensive link
level simulations were carried out using a standard compliant LTE link level sim-
ulator. The comparison between the calculated and the simulated results exhibits a
fair agreement. This model on the one hand exposes the CFO-tolerance of a stan-
dardized OFDM transmission system; on the other hand, it may serve as a means for
evaluating CFO estimation algorithms designed for the LTE downlink.1
2.1
Introduction
As a dominant physical layer technique in the next generation wireless communi-
cation standard, 3GPP LTE, Orthogonal Frequency Division Multiplexing (OFDM)
promises signiﬁcant performance gain in frequency selective channels. Nevertheless,
it poses a drawback, namely, sensitive to synchronization errors, such as CFO,
1More details on synchronization issues can be found in the Ph.D. thesis of Qi Wang, avail-
able at http://theses.eurasip.org/theses/470/performance-evaluation-of-practical-ofdm-systems/
download/.
This work has been carried out while she was at the Institute of Telecommunications, TU Wien.
Q. Wang (B)
Huawei Technologies Düsseldorf GmbH, Düsseldorf, Germany
e-mail: wangqiasia@gmail.com
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_2
21

22
Q. Wang
sampling frequency offset and symbol timing offset. Tremendous efforts were
devoted to estimating synchronization errors in the digital signal processing domain.
Taking the CFO for example, the performance is evaluated in terms of the Mean
Square Error (MSE). Such a metric indicates the estimation performance itself, yet
fails to reﬂect the inﬂuence of a residual estimation error on the overall system per-
formance. In a real world communication system, the physical layer performance
is eventually expressed in terms of coded throughput. Therefore, not only the per-
formance of an individual processing block but also their overall impact on the
throughput needs to be investigated.
For an OFDM system in general, the performance degradation caused by a CFO
has been investigated in [1–8]. The authors of [1, 2] evaluated the degradation in
termsoftheSignaltoInterferenceandNoiseRatio(SINR)inthedemodulatedOFDM
signal. In [3–8], Bit Error Ratio (BER) of OFDM systems with CFO was analytically
derived for Additive White Gaussian Noise (AWGN) [3–5] and frequency selective
fading channel [6]. In [8], a capacity analysis of impaired OFDM links is presented,
takingintoaccountavarietyofreceiverimperfections,e.g.,channelestimationerrors,
CFO and I/Q imbalance. The authors calculated the average mutual information of
the impaired OFDM link using the probability density function derived in [7]. From
a methodology point of view, these approaches evaluate the degradation induced
by the Inter-Carrier Interference (ICI) exclusively and are applicable to an arbitrary
OFDM system; whereas in order to evaluate a standardized system like LTE, many
practical aspects need to be taken into account, such as the speciﬁed frame structure
and the overall receiver design.
Performance modeling has become of interest as nowadays communication sys-
tems grow dramatically in complexity. Since simulating a perfect replica of the real
system turns to be costly in terms of run time efﬁciency, it is necessary to combine
mathematical and empirical models in the simulation-based performance evalua-
tion. In order to reduce the simulation complexity without losing insight into the real
behavior, modeling with an acceptable degree of approximations is desired. For the
LTE downlink, a link quality modeling approach has been presented in [9, 10]. The
authors derived bounds on achievable throughput of LTE where the post-equalization
SINR was employed as the intermediate performance metric. This approach can be
utilized to abstract the major physical layer behavior, whereas synchronization errors
were ignored.
We apply the methodology elaborated in [9] and develop a throughput loss pre-
diction model for the CFO impaired LTE downlink. This model takes into account
the estimation performance of a CFO estimator, a linear receiver structure as well as
the Bit Interleaved Coded Modulation (BICM) architecture and analytically deter-
mines the performance loss in terms of coded throughput. Validated by extensive
standard compliant simulations, this evaluation model on the one hand exposes the
CFO-tolerance of such a system; on the other hand, implies how accurate the carrier
frequency offset estimation is required to be.

2
Downlink Synchronization
23
The chapter is organized as follows. A description of the evaluation model is
presented in Sect.2.2. The MSE performance of an exempliﬁed CFO estimator is
described in Sect.2.3. The post-equalization SINR model for a CFO-impaired OFDM
transmission is derived in Sect.2.4. The BICM capacity model is brieﬂy introduced
in Sect.2.5. Numerical validations using the standard compliant Vienna LTE Link-
Level DL simulator are provided in Sect.2.6. Conclusion can be found in Sect.2.7.
2.2
Evaluation Model
Consider a signal processing chain on the receiver side of the LTE downlink in
Fig.2.1, the frequency synchronization block is located at the beginning of the
processing chain, compensating the CFO in the time domain. In order to model the
impact of a residual CFO on the resulting coded throughput at the end of the chain,
analytical representations need to be found for the function blocks in between.
The signal transmission in LTE is based on a frame structure, illustrated in Fig.2.2.
The transmission resources are segmented into 10ms frames. Each frame is divided
into ten subframes. When a Cyclic Preﬁx (CP) of normal length is employed, a sub-
frame consists of 14 OFDM symbols [11]. The frame structure is designed so that the
signaling information can be embedded on a certain basis with a reasonable overhead.
After the Fast Fourier Transform (FFT) transform, the transmission resource can be
interpreted as a time-frequency grid, where Reference Signals (RSs) are embedded
among data symbols.
Since the post-equalization SINR has been widely utilized for evaluating the
performance of a radio link, we choose it as an intermediate step to evaluate the
entire receiver chain, i.e.,
MSE →post-equalization SINR →coded throughput.
Fig. 2.1 Signal processing
chain in an OFDM receiver

24
Q. Wang
Fig. 2.2 LTE frame structure with normal length CPs, displaying a time-frequency grid in the
frequency domain with RS positions
Typically, optimizations are applied based on MSE, assuming an overall optimal
can be correspondingly achieved. Our analysis however, will provide an insight by
modeling the joint effect of the three.
2.3
Mean Square Error of Carrier Frequency Offset
Estimation
In order to compensate the CFO in a real-world OFDM transmission system, var-
ious CFO estimation schemes can be applied. Their estimation performances in
terms of MSE can be mathematically determined. In [12], a generic CFO esti-
mation scheme was investigated based on the RSs of LTE, where the normal-
ized CFO ε ∈(−0.5, 0.5) is estimated ﬁrstly in the time domain then reﬁned in
the frequency domain. We focus on the frequency domain estimation in the fol-
lowing because it determines the overall estimation performance. Deﬁne vectors
rP,0, rP,1 ∈CNP NR×1 for the received RS in slot 0 and 1, diagonal matrices
X0 = diag

xP,0

, X1 = diag

xP,1

∈CNP NR×NP NR containing the corresponding
RSs along their diagonals. The CFO is estimated in the frequency domain by

2
Downlink Synchronization
25
ˆε = −
Nc
2π(Nc + Ncp)Nsl
arg

rH
P,1X1XH
0 rP,0

,
(2.1)
where Nsl ∈{6, 7} is the number of OFDM symbols per slot and NP is the number
of RSs per slot. We consider this estimation scheme as an example and evaluate
the throughput loss of a CFO-impaired LTE downlink with this estimation scheme
employed.
The MSE of the overall CFO estimation scheme is given as
MSE(γ ) = E

|ε −ˆε|2
=
N 2
c
4π2(Nc + Ncp)2N 2
slNRNPγ ,
(2.2)
The variable γ denotes the average Signal to Noise Ratio (SNR) at the receiver side
in the frequency domain.
The estimation performance of the generic difference phase estimator has been
thoroughly analyzed in [13]. A derivation of Eq.(2.2) following the work in [12]
is provided. Deﬁne the channel frequency response on the RS subcarriers as h ∈
CNP NR×1; the received RS symbols in slot 0 and 1 can be expressed as
rP,0 = X0h + v0,
(2.3)
rP,1 = ei·φNslX1h + v1,
(2.4)
where v0, v1 denote the corresponding noise vectors and φ = 2πε(Nc+Ncp)
Nc
. From
Eq.(2.1), there is
rH
P,1X1XH
0 rP,0 = e−i·φNslhHXH
1 X1XH
0 X0h
+ e−i·φNslhHXH
1 X1XH
0 v0 + vH
1 X1XH
0 X0h
+ vH
1 X1XH
0 v0.
(2.5)
Omitting the second-order noise term vH
1 X1XH
0 v0, rH
P,1X1XH
0 rP,0 can be approxi-
mated as a complex Gaussian random variable, expressed as
rH
P,1X1XH
0 rP,0 ∼NC

e−iφNsl P2
S hHh, 2PVP3
S hHh

,
(2.6)
where PS and PV denote the signal and noise power, respectively. Deﬁne
Y, X ∼NC

0, PVP3
S hHh

,
(2.7)

26
Q. Wang
and assume −π
2 < φNsl < π
2 , Eq.(2.1) becomes
ˆφ = −1
Nsl
arctan

ℑ

rH
P,1X1XH
0 rP,0

ℜ

rH
P,1X1XH
0 rP,0


= −1
Nsl
arctan
 P2
S hHh · sin(−φNsl) + Y
P2
S hHh · cos(−φNsl) + X
	
≈−1
Nsl
arctan
 P2
S hHh · sin(−φNsl)
P2
S hHh · cos(−φNsl)
	
−1
Nsl
· Y cos(−φNsl) −X sin(−φNsl)
P2
S hHh
= φ −1
Nsl
· Y cos(−φNsl) −X sin(−φNsl)
P2
S hHh
(2.8)
by applying a ﬁrst-order Taylor expansion. Plugging in Eq.(2.7), we obtain
ˆφ ∼NC

φ, PVP3
S hHh cos2(−φNsl) + PVP3
S hHh sin2(−φNsl)
N 2
slP4
S hHhhHh

∼NC

φ,
PV
N 2
slPShHh

.
(2.9)
Therefore, the estimator is unbiased and
MSE(γ ) = E

|ε −ˆε|2
=
N 2
c
4π2(Nc + Ncp)2 E

|φ −ˆφ|2
=
N 2
c PV
4π2(Nc + Ncp)2N 2
slPShHh =
N 2
c
4π2(Nc + Ncp)2N 2
slNPNRγ ,
(2.10)
where the average SNR
γ =
PShHh
NPNR PV
.
(2.11)
In classical estimation theory, the MSE of an unbiased estimator for ε is lower
bounded as
MSEε =
N 2
c
4π2(Nc + Ncp)2 MSEφ ≥
N 2
c
4π2(Nc + Ncp)2 ·
1
J(φ),
(2.12)
where the Fisher information
J(φ) = −E
 ∂2
∂φ2 Λ(φ)
	
.
(2.13)

2
Downlink Synchronization
27
Given the notation in Eqs.(2.3) and (2.4), we characterize the RS-based CFO
estimation problem by the log-likelihood function
Λ(φ) = ln f (rP,0, rP,1; φ)
= ln
1
π2NP NR det(R) exp

−
rH
P,0 rH
P,1

R−1
rP,0
rP,1
	
,
(2.14)
with
R = E
rP,0
rP,1
 rH
P,0 rH
P,1
	
.
(2.15)
Plugging Eqs.(2.3) and (2.4) into (2.14), after arithmetic manipulations, Eq.(2.13)
becomes
J(φ) = N 2
slPShHh
PV
.
(2.16)
This leads to the Cramér-Rao Lower Bound (CRLB)
MSEε ≥
N 2
c PV
4π2(Nc + Ncp)2N 2
slPShHh
=
N 2
c
4π2(Nc + Ncp)2N 2
slNPNRγ .
(2.17)
Compared to Eq.(2.10), the lower bound of the estimation variance is attained.
2.4
Signal to Interference and Noise Ratio Modeling
The authors of [1, 2] investigated the impact of a CFO on OFDM systems where such
impact means exclusively the degradation in terms of the post-FFT SINR, shown in
Fig.2.1. In [14], a post-equalization SINR model was presented. This measure is of
importance, because it directly determines the theoretically possible throughput I
via Shannon’s formula:
I ≈log2(1 + SINR).
(2.18)
In an urban scenario with low to medium mobility, it can be shown that the channel
is quasi-static within the duration of one subframe (1ms). Therefore, time-invariant
channel estimation and equalization can be applied on a subframe basis. Following
the analysis in [14], we constrain the evaluation within one subframe and consider
a residual CFO which is normalized to the standardized subcarrier spacing, denoted

28
Q. Wang
by ε ∈(−0.5, 0.5). Let n be the OFDM symbol index within a subframe, k the
subcarrier index, NT the number of transmit antennas and NR the number of receive
antennas. We denote the transmitted signal vector by xn,k ∈CNL×1, the precoded
channel matrix in the frequency domain by H(eff)
k
∈CNR×NL, the received signal
by rn,k ∈CNR×1 and the AWGN by vn,k ∈CNR×1. We use here the abbreviation
H(eff)
k
= HkFk, where the channel matrix Hk ∈CNR×NT and the precoding matrix
Fk ∈CNT×NL. Given the block fading assumption, the channel matrix within one
subframe stays constant, independent from the OFDM symbol index n. When the
system is impaired by a CFO, the signal transmission can be described as
rn,k = I (0, ε) · eiΦ(ε,n) · H(eff)
k
xn,k
+

p̸=k
I (p −k, ε) · eiΦ(ε,n) · H(eff)
p
xn,p + vn,k,
(2.19)
where
I (0, ε) =
sin(πε)
Nc sin(πε/Nc) · ei πε(Nc−1)
Nc
,
(2.20)
I (p −k, ε) =
sin[π(p −k + ε)]
Nc sin[π(p −k + ε)/Nc] · ei π(p−k+ε)(Nc−1)
Nc
,
(2.21)
eiΦ(ε,n) = ei
2πεn(Nc+Ncp)
Nc
.
(2.22)
Here, the factor I (0, ε) · eiΦ(ε,n) introduces time-variant distortion to the desired
signal term besides the channel response. However, since the system is assumed on a
subframe basis to be static, the receiver is designed to be time invariant on a subframe
basis; in other words, a universal channel estimate which is independent of the time
index n is to be obtained using all RSs shown in Fig.2.2.
For simplicity, we assume that the perfect and static channel knowledge is
available at each subframe. A Zero Forcing (ZF) equalizer at subcarrier k is then
given as
Gk =

H(eff)
k
HH(eff)
k
−1
H(eff)
k
H.
(2.23)
Thus, the estimated data symbol after equalization can be expressed as
ˆxn,k = Gk · rn,k = I (0, ε) · eiΦ(ε,n) · xn,k
+ Gk

p̸=k
I (p −k, ε) · eiΦ(ε,n) · H(eff)
p
xl,p



yICI
n,k
+ Gkvn,k
  
˜vn,k
= I (0, ε) · eiΦ(ε,n) · xn,k + yICI
n,k + ˜vn,k,
(2.24)

2
Downlink Synchronization
29
where yICI
n,k denotes the ICI and ˜vn,k is the equalized noise vector. Let NL denote
the number of transmission layers which is indexed by l = 0, 1, . . . , NL −1, the
SINR(l)
n,k on the lth layer can be found by
SINR(l)
n,k(ε, H(eff)
k
) =

xn,kxH
n,k

(l,l)

(ˆxn,k −xn,k)(ˆxn,k −xn,k)H
(l,l)
,
(2.25)
where [ · ](i, j) denotes the entry on the ith row and jth column of the given matrix.
We denote the average signal power on each subcarrier and each layer by PS and
the corresponding noise power by PV. Plugging Eq.(2.24) into (2.25), we obtain a
closed form expression of the post-equalization SINR on the lth layer at Resource
Element (RE) (n, k), shown in Eq.(2.27). Since the system assumes block fading
on a subframe bases, the so-called Common Phase Error (CPE) in Eq.(2.22) which
increases linearly with the time index n causes a signal distortion term. As suggested
in [14], this is the dominant term compared to the ICI.
SINR(l)
n,k(ε, H(eff)
k
)
(2.26)
=
PS

yICI
n,kyICI
n,k
H
(l,l) +

˜vn,k ˜vH
n,k

(l,l) + |I (0, ε) · eiΦ(ε,n) −1|2 ·

xn,kxH
n,k

(l,l)
=
PS
ICI + PV

GH
k Gk

(l,l)



noise
+ PS|I (0, ε) · eiΦ(ε,n) −1|2



signal distortion
,
(2.27)
ICI = PS

p̸=k
|I (p −k, ε)|2 
GH
k GkH(eff)
p
H(eff)
p
H
(l,l) .
(2.28)
2.5
Bit Interleaved Coded Modulation Capacity
In general, a BICM architecture is obtained by concatenating channel coding with
modulation mapping through a bit interleaver. Such a scheme allows combinations
of any channel code with any arbitrary modulation alphabet [15]. Based on this archi-
tecture, LTE employs 4, 16 or 64-Quadrature Amplitude Modulation (QAM) and a
rate 1/3 turbo code that is appropriately rate matched to achieve the desired code
rates as deﬁned in [16]. The capacity of BICM systems is well known, though not in
closed-form [17]. In Fig.2.3, BICM capacity of the three LTE-deﬁned modulation
alphabets (4-QAM, 16-QAM, 64-QAM) are plotted. Analogous to [10], a function
f (SINR) is introduced to describe the maximum efﬁciency over all available mod-
ulation alphabets.

30
Q. Wang
Fig. 2.3 BICM capacity of
4, 16 and 64-QAM
modulation
Given the SINR model in Sect.2.2, the spectral efﬁciency of an LTE downlink
transmission suffering from a CFO ε can be expressed as f (SINR(l)
n,k(ε, H(eff)
k
)),
where SINR(l)
n,k(ε, H(eff)
k
) is plugged in from Eq.(2.27). The index (n, k) denotes an
RE which is devoted to data transmission; in other words, overhead such as RSs,
Primary Synchronization Signal (PSS), Secondary Synchronization Signal (SSS)
and guard bands are excluded. Therefore, the average spectral efﬁciency that can be
achieved at each transmission layer is written as
¯B(ε) =
1
NDNL

(n,k)

l
f (SINR(l)
n,k(ε, H(eff)
k
)),
(2.29)
where ND is the number of available data REs.
Given the MSE analysis in Sect.2.3, a theoretical residual estimation error can be
assumed, labeled as ¯ε = √MSE(γ ). Thus, a theoretically achievable BICM capacity
can be expressed as
B(γ ) =

(n,k)

l
f (SINR(l)
n,k(¯ε, H(eff)
k
))
=

(n,k)

l
f (SINR(l)
n,k(

MSE(γ ), H(eff)
k
)).
(2.30)
This capacity bound takes into account the ﬁnite set of Modulation and Coding
Schemes (MCSs) suggested in [16], a linear receiver structure and the limitation of
the CFO estimation performance, while it ignores other aspects such as a subopti-
mal channel coding, selection of suitable precoding matrix and number of transmit
streams. Since we are only interested in the throughput difference between the

2
Downlink Synchronization
31
zero-CFO case and the CFO-compensated case, these imperfect modeling aspects
cause the same effect in both cases. The throughput loss, being the difference of them
two, can be calculated as
ΔB(γ ) =

(n,k)

l
f (SINR(l)
n,k(0, H(eff)
k
)) −B(γ ).
(2.31)
2.6
Numerical Results
In this section, we validate the analytical models presented in Sects.2.3, 2.4 and 2.5
by standard compliant simulations of LTE downlink using the Vienna LTE Link Level
Simulator [18]. The parameter setting is shown in Table2.1. All presented simulation
examples are made available for downloading.
2.6.1
Mean Square Error
Figure2.4 shows the calculated MSE curves and the simulated estimation perfor-
mance of the estimation scheme in Sect.2.3. Generally speaking, the overall MSE is
determined by the estimation in the frequency domain. The simulated curves follow
the calculation except in the lower SNR region, due to the fact that the estimation
errors from the time-domain estimation exceed the estimation range of the estimator
Table 2.1 Simulation parameters for results in Sect.2.6
Parameter
Value
Channel bandwidth
1.4MHz
FFT size (Nc)
128
No. data subcarriers
72
Subcarrier spacing
15kHz
Carrier frequency
2.5GHz
CP length (Ncp)
[10, 9] (normal [11])
Transmission setting NR × NT
1 × 1, 2 × 2
Transmission mode
Spatial multiplexing
Precoding
Identity
Channel model
ITU Pedestrian B [19]
CFO introduced (ε)
0, 0.14159 . . . subcarrier spacing
Channel knowledge
Perfect
Equalizer
Zero Forcing (ZF)

32
Q. Wang
Fig. 2.4 Simulated and
calculated MSE curves of the
CFO estimation scheme
in the frequency domain. This effect, unfortunately, is not included in the theoretical
analysis of the estimation performance.
2.6.2
Post-equalization Signal to Interference and Noise
Ratio
In order to validate Eq.(2.27), we introduced 20 logarithmically spaced CFOs which
are normalized to the subcarrier spacing, namely 15kHz in LTE. Neither an estima-
tion nor a compensation procedure was applied at this stage. For better visualization
of the impact from the CFOs, the SNR is ﬁxed at γ = 30dB. The resulting post-
equalization SINR curves are plotted in Fig.2.5 and compared to those obtained
using Eq.(2.27).
Figure2.5 shows that calculated results match well with those from the standard
compliant simulation. This indicates that Eq.(2.27) can be used as a valid character-
ization of the system behavior.
2.6.3
Average Spectral Efﬁciency
The average spectral efﬁciency in Eq.(2.29) degrades as the post-equalization SINR
decreases correspondingly. Given a series of deterministic CFOs, this degradation
calculated using Eq.(2.29) is shown in Fig.2.6. The results are based on 200 channel

2
Downlink Synchronization
33
Fig. 2.5 Post-equalization SINR under increasing levels of residual CFOs in ITU Pedestrian B
channel. The relatively large conﬁdence intervals are due to the frequency selectivity over the data
subcarriers
Fig. 2.6 Degradation in average spectral efﬁciency (per layer for the MIMO cases) due to the
residual CFOs
realizations. For the MIMO cases, results are exhibited on a per transmission layer
basis.
The subﬁgure on the left-hand side shows the theoretical degradation in average
spectral efﬁciency subjected to a ﬁxed CFO at different SNR levels. Two CFOs
are introduced as examples where ε = 1.27 × 10−3 corresponds to 19.1Hz and ε =
5.46 × 10−3 to 81.8Hz given the subcarrier spacing 15kHz. Compared to the zero-
CFO case, it can be observed that the higher SNR region where higher efﬁciency is
aimed, appears to be more sensitive to the CFO. Moreover, the impacts on Single-
Input Single-Output (SISO) and MIMO systems are fairly equal on a per layer basis.
In the subﬁgure on the right-hand side, the SNR is ﬁxed at γ = 30dB in order to
visualize the impact under CFOs of increasing magnitudes. The average spectral efﬁ-

34
Q. Wang
ciency starts to decrease around ε = 1 × 10−3, approximately. A similar behavior can
be observed for the SISO and MIMO cases, although the average spectral efﬁciency
per layer is slightly lower for the multiple antenna scenario due to the incremental
noise enhancement from a ZF equalizer.
2.6.4
Coded Throughput Loss
As a comparison to the calculated BICM capacity, we simulated coded throughput
of the LTE downlink. The ﬁfteen MCSs indicated by Channel Quality Indicators
(CQIs) are implemented, shown in Table2.2. In the LTE downlink, User Equipments
(UEs) provide wideband feedbacks to the eNodeB so that the MCS can be adapted
to the actual channel quality. In our experiment, the CQI feedback is forced to be
optimal by selecting the MCS that delivers the highest throughput for each channel
realization.
Figures2.7 and 2.8 exhibit the results obtained for a SISO and a 2 × 2 MIMO
LTE DL. In the upper ﬁgures, coded throughputs of ideally synchronized transmis-
sions are compared to the CFO-compensated case. With the CFO estimation scheme
in [12] applied, the loss between the two cases is hardly visible, especially for the
MIMO case. The corresponding achievable BICM capacity curves conﬁrm such an
Table 2.2 Modulation scheme, Effective Code Rate (ECR) and efﬁciency for each of the Channel
Quality Indicators (CQIs) of the LTE standard
CQI Index
Modulation
ECR
Data (bit/symbol)
0
Out of range
1
4-QAM
0.08
0.15
2
4-QAM
0.12
0.23
3
4-QAM
0.19
0.38
4
4-QAM
0.30
0.60
5
4-QAM
0.44
0.88
6
4-QAM
0.59
1.18
7
16-QAM
0.37
1.48
8
16-QAM
0.48
1.91
9
16-QAM
0.60
2.41
10
64-QAM
0.46
2.73
11
64-QAM
0.55
3.32
12
64-QAM
0.65
3.90
13
64-QAM
0.75
4.52
14
64-QAM
0.85
5.12
15
64-QAM
0.93
5.55

2
Downlink Synchronization
35
Fig. 2.7 Achievable BICM capacity and simulated coded throughput for an SISO LTE DL under
CFO, 5000 subframes Monte Carlo simulation
observation. Note that there are absolute differences between calculated capacity
curves and simulated coded throughput, it is due to the imperfect channel code.
In the lower subﬁgures of Figs.2.7 and 2.8, the absolute coded throughput loss
between the no-CFO and the CFO-compensated case are plotted. The absolute differ-
ences in the upper ﬁgure cancels out when calculating the relative loss. In the higher
SNR region, it can be observed that the simulated coded throughput loss follows the
trend of the analytical calculation. However, mismatches appear in the lower SNR
region, which agrees with the MSE performance shown in Fig.2.4. Since the theo-
retical MSE analysis fails to model the overﬂow in the frequency domain estimation,
an increasing loss in the simulated overall throughput can be observed.

36
Q. Wang
Fig. 2.8 Achievable BICM capacity and simulated coded throughput for a 2 × 2 spatial multiplex-
ing LTE DL under CFO, 5000 subframes Monte Carlo simulation
2.7
Conclusion
In this chapter, we propose a throughput loss prediction model for a CFO-impaired
LTE downlink. This model interconnects the three performance metrics, namely
MSE, post-equalization SINR and the BICM capacity bound. Given the theoretical
estimation performance of an arbitrary CFO estimator, the resulting performance loss
in terms of coded throughput can be analytically determined with acceptable accu-
racy, avoiding extensive time-consuming link performance simulations. Validated by
standard compliant link level simulations, a good agreement can be found. Since for
a practical OFDM system, it is more important to ﬁnd a sufﬁcient estimator than the
‘best’, this model may serve as an evaluation tool for such purpose. Moreover, the
example estimation scheme in [12] is shown to be sufﬁcient for the LTE downlink
with multiple antenna conﬁguration in frequency selective scenarios.

2
Downlink Synchronization
37
References
1. B. Stantchev, G. Fettweis, Time-variant distortion in OFDM. IEEE Commun. Lett. 4, 312–314
(2000)
2. J. Lee, H.-L. Lou, D. Toumpakaris, J. Ciofﬁ, SNR analysis of ofdm systems in the presence of
carrier frequency offset for fading channels. IEEE Trans. Wirel. Commun. 5(12), 3360–3364
(2006)
3. K. Sathananthan, C. Tellambura, Probability of error calculation of OFDM systems with fre-
quency offset. IEEE Trans. Commun. 49(11), 1884–1888 (2001)
4. T. Pollet, M. Van Bladel, M. Moeneclaey, BER sensitivity of OFDM systems to carrier fre-
quency offset and Wiener phase noise. IEEE Trans. Commun. 43(234), 191–193 (1995)
5. P. Dharmawansa, N. Rajatheva, H. Minn, An exact error probability analysis of OFDM systems
with frequency offset. IEEE Trans. Commun. 57(1), 26–31 (2009)
6. L. Rugini, P. Banelli, BER of OFDM systems impaired by carrier frequency offset in multipath
fading channels. IEEE Trans. Wirel. Commun. 4(5), 2279–2288 (2005)
7. M. Krondorf, G. Fettweis, Bit error rate calculation for OFDM with synchronization errors
in time and frequency selective fading channels, in Proceedings of 13th European Wireless
Conference (EW’07), Paris, France, Apr 2007
8. M. Krondorf, G. Fettweis, OFDM link performance analysis under various receiver impair-
ments, in EURASIP Journal on Wireless Communications and Networking, vol. 2008, Article
ID 145279, 2008
9. S. Schwarz, M. Šimko, M. Rupp, On performance bounds for MIMO OFDM based wireless
communication systems, in Proceedings of IEEE Signal Processing Advances in Wireless
Communications SPAWC 2011, June 2011
10. S. Caban, C. Mehlführer, M. Rupp, M. Wrulich, Evaluation of HSDPA and LTE: From Testbed
Measurements to System Level Performance, 1st edn. (Wiley, New York, 2012)
11. Technical Speciﬁcation Group Radio Access Network, E-UTRA; physical channels and mod-
ulation, 3GPP, Technical Report TS 36.211 Version 9.1.0, Mar 2010
12. Q. Wang, C. Mehlführer, M. Rupp, Carrier frequency synchronization in the downlink of 3GPP
LTE, in Proceeding of the 21st Annual IEEE International Symposium on Personal, Indoor
and Mobile Radio Communications (PIMRC’10) Istanbul, Turkey, 2010
13. M. Sandell, D. McNamara, S. Parker, Analysis of frequency-offset tracking in MIMO OFDM
systems.IEEETrans.Commun.54(8),1481–1489(2006).doi:10.1109/TCOMM.2006.878841
14. Q. Wang, M. Rupp, Analytical link performance evaluation of LTE downlink with carrier
frequency offset, in Conference Record of the 45th Asilomar Conference on Signals, Systems
and Computers, 2011 (Asilomar-2011), Paciﬁc Grove, USA, Nov. 2011
15. G. Caire, G. Taricco, E. Biglieri, Bit-interleaved coded modulation. IEEE Trans. Inf. Theory
44(3), 927–946 (1998)
16. Technical Speciﬁcation Group Radio Access Network, E-UTRA; physical layer procedures,
3GPP, Technical Report TS 36.211 Version 9.2.0, June 2010
17. G. Caire, G. Taricco, E. Biglieri, Capacity of bit-interleaved channels. Electron. Lett. 32(12),
1060–1061 (1996)
18. C. Mehlführer, J.C. Ikuno, M. Šimko, S. Schwarz, M. Wrulich, M. Rupp, The Vienna LTE
simulators—enabling reproducibility in wireless communications research. EURASIP J. Adv.
Signal Process. (2011)
19. Members of ITU, Recommendation ITU-R M.1225: Guidelines for evaluation of radio trans-
mission technologies for IMT-2000, International Telecommunication Union (ITU), Technical
Report, 1997

Chapter 3
Symbol Detection in High Speed Channels
Ronald Nissel
3.1
Introduction
Mobile wireless communication channels are characterized by time-varying multi-
path propagation [1], that is, due to multiple scatterers, the electromagnetic signal can
propagate along several different paths which causes frequency-selectivity and time-
selectivity. Orthogonal Frequency Division Multiplexing (OFDM) as being utilized
in Long Term Evolution (LTE) and Long Term Evolution-Advanced (LTE-A) down-
link transmissions can efﬁciently deal with frequency-selective channels caused by
multi-path delays by inserting a so-called Cyclic Preﬁx (CP), see also Chap.1 for
more details. However, in high mobility scenarios, as they appear for example in
car/train to infrastructure communication, the channel can become so time-selective,
that it changes signiﬁcantly within one OFDM symbol. In this case the subcarriers
are no longer orthogonal and lead to Inter-Carrier Interference (ICI) which can only
be combated by sophisticated and costly algorithms [2].
In a ﬁrst step, we consider ICI as an additional Gaussian noise term which allows
us to derive a closed-form expression for the Bit Error Probability (BEP). Such
closed-form expressions are useful because they provide a much deeper insight into
the system and allow efﬁcient performance optimization with respect to speciﬁc
parameters such as the pilot symbol power.
In order to combat ICI we need an accurate estimate of the time-variant channel
that also requires more knowledge of the interfering terms. In principle, we can
distinguish between Channel Estimation (CE) methods utilizing either one OFDM
symbol [3] or multiple OFDM symbols [4–6]. The ﬁrst method usually employs a
basis expansion model to reduce the number of unknown variables and requires a
clustered pilot symbol structure, which is not compliant with most standards. The
second method, on the other hand, initially ignores ICI and interpolates the estimated
R. Nissel (B)
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: rnissel@nt.tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_3
39

40
R. Nissel
time-averaged channel impulse responds of several OFDM symbols, e.g., linearly
[4], by Least Squares (LS) polynomial ﬁtting [5] or by Least Squares (LS) discrete
prolate spheroidal ﬁtting [6]. Once the channel is estimated, the ICI at pilot positions
can be reduced in order to increase the accuracy of an iterative channel estimation. We
follow such second approach, based on multiple OFDM symbols. In contrast to [4–
6] we interpolate the estimated channel of several OFDM symbols according to the
Minimum Mean Square Error (MMSE) criteria, thus obtaining the MMSE channel
estimation of the sampled time-variant transfer function. MMSE channel estimation
was investigated for example in [7] and [8] but they considered only one OFDM
symbol and their estimation process includes ICI, making it rather complex. We, on
the other hand, treat ICI as an additional noise term which is then stepwise reduced by
our iterative ICI mitigation technique that combines channel estimation, equalization
and ICI cancellation. Iterative channel estimation was, e.g., discussed in [9] where
the authors model the channel variations by a polynomial basis expansion and use
the estimated data symbols to estimate the ICI. We, however, use the estimated data
symbols only to cancel ICI and, in the ﬁnal iteration step, as pilot symbols. Many
authors [10–12] proposed low-complexity equalizers which exploit the underlying
structure of the ICI. However, the main focus of this chapter is channel estimation
so that we employ an ordinary full block MMSE equalizer [13] to combat ICI.
By employing the Vienna Wireless Testbed (for more details, see Chap.9), we
show the applicability of our ICI mitigation technique in real world physical channels.
Testbeds which support mobile receivers typically place the measurement equipment
in a car [14–16]. However, such method offers only a limited velocity and lacks
repeatability and controllability, which constitutes the main problem for a fair com-
parison of different transmission techniques. To avoid these drawbacks we developed
a transmission system [17, 18] in which the receive antenna rotates around a central
pivot. Compared to a linear guide we avoid the repeated acceleration and deceleration
step, so that even high velocities can be achieved. Our setup represents a scenario
in which the rotational speed is low relative to the transmission time, so that the
antenna moves approximately linear during the transmission. Assume for example a
velocity of 100km/h (4.4 revolutions per second for a 1m arm). Then, for a transmis-
sion time of 1ms, the antenna moves only by 4.4 rps × 1 ms × 360◦= 1.6◦which is
close enough to a linear movement. To the best of our knowledge, such high velocity
measurement setup is unique in the world. The main advantages are repeatability,
controllability and cost efﬁciency. The main disadvantage, on the other hand, is the
indoor location of our receiver, so that our setup does not necessarily accurately
reﬂect the channel characteristics of a typical high velocity application.
3.2
OFDM in High Speed Channels
In this section, we model the effect of time-variant channels [1] on OFDM transmis-
sions. In particular, we will derive equations to specify the ICI power and show how
it depends on the subcarrier index.

3
Symbol Detection in High Speed Channels
41
We start our discussion with Eq.(1.22) of Chap.1:
rn = Diag (hn) xn + yICI
n
+ vn
(3.1)
rn,k = Hn,kxn,k + yICI
n,k + vn,k,
(3.2)
which shows the linear operation of transmissions including the Fast Fourier Trans-
form (FFT) operation at the receiver end. We can specify the received signal power
given by PSRX = E{|Hn,kxn,k|2}, ICI power by PICI
n,k = E{|yICI
n,k|2}and noise power by
PV = E{|vn,k|2}. In Sect.3.3, we assume that the ICI terms yICI
n,k are uncorrelated
and Gaussian distributed, even though the real distribution is given by a weighted
Gaussian mixture due to random data symbols [19].
To characterize the ICI power we need a statistical description of OFDM matrix
Dn, Eq.(1.21). However, in order to describe the correlation of all elements of the
two-dimensional channel transfer function Cm,k in Eq.(1.21), we have to perform
vectorization, making the description by a large correlation matrix feasible. We struc-
ture the correlation matrix by sorting the vectorized channel elements accordingly,
so that the correlation matrix can be found in a straightforward manner, see for exam-
ple Eq.(3.56). Thus, we deﬁne a new vector cn ∈CNcNFFT×1 in which we stack all
elements of the sampled time-variant transfer function, relevant to OFDM symbol
n, according to:
cn =
⎡
⎢⎢⎢⎢⎢⎢⎣
CnNs+Ncp,0
:
CnNs+Ncp,Nc−1
CnNs+Ncp+1,0
:
CnNs+Ncp+NFFT−1,Nc−1
⎤
⎥⎥⎥⎥⎥⎥⎦
.
(3.3)
We can then ﬁnd a sparse matrix ˜Wk ∈CNc×NcNFFT (100 Nc−1
Nc
percent of the ele-
ments are zero), so that OFDM matrix Dn, Eq.(1.21), can be rewritten in matrix
notation as:
Dn =
⎡
⎢⎢⎢⎣

˜W0cn
	T
...

˜WNc−1cn
	T
⎤
⎥⎥⎥⎦,
(3.4)
whereas we obtain ˜Wk (k = 0, 1, 2 . . . , Nc −1) by comparing Eqs.(3.3) and (3.4)
to (1.21), resulting in:
˜Wk =
1
NFFT
exp
⎧
⎪⎨
⎪⎩
−j2π
NFFT
⎛
⎜⎝11×NFFT ⊗
⎡
⎢⎣
k 0
0
0 ...
0
0 0 k −(Nc −1)
⎤
⎥⎦
⎞
⎟⎠
◦
0 · · · NFFT −1
⊗INc
 
◦

11×NFFT ⊗diag

11×Nc

.
(3.5)

42
R. Nissel
Here, the exp{·} operator is applied at each element of the matrix, the operations ⊗
and ◦are the Kronecker product, respectively the Hadamard (point-wise) product, INc
denotes the identity matrix of size Nc and 11×NFFT an all-one vector of size 1 × NFFT.
Let us further split the matrix ˜Wk into a signal part ˜WS
k and an ICI part ˜WICI
k :
˜Wk = ˜WS
k + ˜WICI
k .
(3.6)
Matrix ˜WICI
k
consists of nearly the same elements as ˜Wk, with the difference that
the kth row is set to zero. Therefore, ˜WICI
k
describes only the ICI part of our system,
that is, yICI
n,k =

˜WICI
k cn
	T
xn. Similar, ˜WS
k consists only of the signal part of our
transmission system, that is, only the kth row of ˜Wk, while all other elements are
zero. In particular, we have Hn,kxn,k =

˜WS
kcn
	T
xn. The signal power PSRX
n,k and the
ICI power PICI
n,k are then given by:
PSRX
n,k = tr

˜WS
kRcn

˜WS
k
	H
(3.7)
PICI
n,k = tr

˜WICI
k Rcn

˜WICI
k
	H
,
(3.8)
whereasRcn = E{cncH
n } ∈CNcNFFT×NcNFFT denotesthecorrelationmatrix(seeSect.3.5
for an example). For a Wide-Sense Stationary Uncorrelated Scattering (WSSUS)
channel, the signal power is independent of the subcarrier position k and the time
position n, that is, PSRX
n,k = PSRX. On the other hand, the ICI power depends on k
if the number of samples NFFT is larger than Nc, due to aliasing. For a given time
autocorrelation function and the limit case of NFFT →∞, an analytical expression
for the signal power can be found by [20]:
Puniform
SRX
= cos(2πνmaxT ) + 2πνmaxT Si(2πνmaxT ) −1
2(πνmaxT )2
,
(3.9a)
PJakes
SRX
= 1F2
1
2; 3
2, 2; −(πνmaxT )2

.
(3.9b)
A uniform distributed Doppler spectral density is assumed for the signal power
Puniform
SRX
and a Jakes Doppler spectrum for PJakes
SRX . The functions Si(·) and 1F2(·)
are the sine integral function respectively the generalized hypergeometric function.
Note that the signal power depends only on the normalized maximum Doppler shift
νmaxT = νmax
Δf . For inﬁnitely many subcarriers, the law of conservation of energy
(PSRX + PICI = 1) can be applied, so that the ICI power is ﬁnally given as:
Puniform
ICI
= Puniform
SRX
−1,
(3.10a)
PJakes
ICI
= PJakes
SRX
−1.
(3.10b)

3
Symbol Detection in High Speed Channels
43
number of subcarriers: ∞
number of subcarriers: 41
0
20
40
0
10
20
30
40
50
subcarrier index k
Signal-to-interference ratio [dB]
T
Jakes Spectrum
Uniform Spectrum
0
0.05
0.1
0
10
20
30
40
50
normalized maximum
Doppler shift νmax
Signal-to-interference ratio [dB]
Fig. 3.1 Signal-to-Interference Ratio as a function of subcarrier index respectively Doppler shift:
SIR is relatively high so that in most cases ICI can be neglected, SIR of the ﬁrst and last subcarrier
is approximately 3dB higher than the center values
TherightpartofFig.3.1showstheSignal-to-InterferenceRatio(SIR)forinﬁnitely
many subcarriers (Eqs.3.9 and 3.10). This ratio is usually very high so that in many
cases the ICI can be neglected compared to the noise. Consider for example LTE
(Δf =15kHz) at 2.5GHz. For a SIR smaller than 20 dB, the velocity has to be larger
than 500km/h (νmaxT = 0.08). The left ﬁgure compares the case of ﬁnite (Eqs.3.7
and 3.8, Nc = 41, NFFT = 410) with inﬁnitely many subcarriers. Since the ﬁrst and
last subcarriers have interferers only at one side, the SIR is approximately 3dB higher
compared to the closed form solution. Furthermore, we observe that the SIR ratio at
the middle subcarrier coincide with the closed form solution because only the few
nearest neighboring subcarriers have a signiﬁcant effect on the ICI.
3.3
Closed-Form BEP Expression for One-Tap Equalizer
This section is based on [18, 21] and shows how we can derive closed-form solu-
tions for the BEP in case of one-tap equalizer and pilot-symbol-aided channel esti-
mation. Here, the ICI is considered as an additional noise term and approximated
by a Gaussian random variable while in Sect.3.4 we will investigate more evolved
data symbol estimation methods. Similar results are provided in for ﬁlter-bank multi-
carrier modulation [22]. Closed-form solutions are investigated in [23–25], extended
forms to describe ICI in [21].

44
R. Nissel
The ultimate goal of every transmission system is to recover the transmitted data
symbols xn,k. Dividing Eq.(3.2) by the estimated channel ˆHn,k leads to the zero
forcing equalization and delivers an LS estimate of the transmitted data symbol xn,k:
ˆxn,k = rn,k
ˆHn,k
.
(3.11)
For perfect channel knowledge ( ˆHn,k = Hn,k), the zero forcing equalizer corresponds
to the Maximum Likelihood (ML) detection. However, for pilot-symbol-aided chan-
nel estimation such equalization is no longer optimal in the ML sense [26], but due
to its simplicity still a reasonable choice. The required channel estimate in (3.11)
is found by interpolation (weighted average), via the weights an,k, of known LS
estimates at pilot positions:
ˆHn,k =

{n p,kp}∈P

a∗
n,k

{n p,kp}
rn p,kp
xn p,kp
.
(3.12)
Set P is a collection of the two-dimensional (2D) pilot position indexes whereas the
number of pilot symbols is given by its cardinality |P| = Np. Rewriting Eq.(3.12)
in vector notation leads to:
ˆHn,k = aH
n,k ˆhLS
P,
(3.13)
where the vector ˆhLS
P ∈CNP×1 consists of the vectorized LS estimates at pilot posi-
tions and the vector weight function an,k ∈CNP×1 is deﬁned by the interpolation
method (for example MMSE, linear, spline). We also assume that each pilot symbol
has unit power. Figure3.2 shows a 4-Quadrature Amplitude Modulation (QAM) and
ℑ{xn,k}
ℜ{xn,k}
1
√
2
1
√
2
01
11
00
10
Bit 2
ℜ{xn,k}
0
1
Bit 1
ℑ{xn,k}
1
0
ℑ{xn,k}
ℜ{xn,k}
1
√
10
3
√
10
1
√
10
3
√
10
0000
1000
0100
1100
0010
1010
0110
1110
0001
1001
0101
1101
0011
1011
0111
1111
Bit 3,4
ℜ{xn,k}
11
01
10
00
Bit 1,2
ℑ{xn,k}
10
00
11
01
Fig. 3.2 4-QAM (left) and 16-QAM (right) applying Gray code

3
Symbol Detection in High Speed Channels
45
a 16-QAM signal constellation, that is, the set from which the data symbols xn,k are
chosen. The bit mapping follows Gray-coding. The one-tap equalizer in Eq.(3.11)
then leads to the following BEP for 4-QAM:
BEP4QAM
n,k
(an,k) =1
2 Pr

ℜ

rn,k
ˆHn,k

< 0
     xn,k = 1 + j
√
2
!
+ 1
2 Pr

ℜ

rn,k
ˆHn,k

< 0
     xn,k = 1 −j
√
2
!
.
(3.14)
and for 16-QAM:
BEP16QAM
n,k
(an,k)
= 1
16

qr∈
{1,3}

qi∈{−3,
−1,1,3}
Pr

ℜ

rn,k
ˆHn,k

< 0
     xn,k = qr + jqi
√
10
!
+ 1
16

qi∈{−3,
−1,1,3}

1 −Pr

−2
√
10
< ℜ

rn,k
ˆHn,k

<
2
√
10
     xn,k = 1 + jqi
√
10
!!
+ 1
16

qi∈{−3,
−1,1,3}
Pr

−2
√
10
< ℜ

rn,k
ˆHn,k

<
2
√
10
     xn,k = 3 + jqi
√
10
!
,
(3.15)
In order to ﬁnd closed-form expressions for the BEP, we thus have to ﬁnd close-
form expressions for the Cumulative Distribution Function (CDF) of the complex
Gaussian ratio rn,k
ˆHn,k , which is provided by the following theorem based on:
Theorem 3.1 Let H ∼NC

0, PSRX

, ˆhLS
P ∼NC

0, RˆhLS
P
	
and uncorrelated v ∼
NC (0, PV) be zero mean complex-valued Gaussian random variables and vectors.
Assume further that the transmission system model is given by r = Hx + v, that
the channel is estimated by pilot symbols, that is, ˆH = aH ˆhLS
P, with a being an
arbitrary complex-valued vector deﬁned by the interpolation scheme, and that the
cross-correlation vector E{ˆhLS
P H ∗} = rˆhLS
P,H is given. Conditioned on x, the proba-
bility that the real part of the complex-valued Gaussian ratio r/ ˆH is smaller than a
certain value zR and at the same time the imaginary part smaller than zI, reads:

46
R. Nissel
Pr

ℜ
 r
ˆH

< zR ∧ℑ
 r
ˆH

< zI
    x

= 1
4
+

zR −ℜ
"
α
β x
#	
⎛
⎝2 tan−1
⎛
⎝
zI−ℑ

α
β x
	
$
zR−ℜ{ α
β x}
	2
+γ
⎞
⎠+ π
⎞
⎠
4π
$
zR −ℜ{ α
β x}
	2
+ γ
+

zI −ℑ
"
α
β x
#	
⎛
⎝2 tan−1
⎛
⎝
zR−ℜ

α
β x
	
$
zI−ℑ{ α
β x}
	2
+γ
⎞
⎠+ π
⎞
⎠
4π
$
zI −ℑ{ α
β x}
	2
+ γ
,
(3.16)
with
α = aHrˆhLS
P,H,
(3.17)
β = aHRˆhLS
Pa,
(3.18)
γ = PV + PSRX |x|2
β
−
    
α
β x
    
2
.
(3.19)
Of particular interest is the case when only the projection onto one axis, say the
real axis, matters. Then zI approaches inﬁnity, so that the tan−1 terms vanish and
we end up with a very compact expression, see Eq.(3.26). Theorem 3.1 delivers the
probability for arbitrary linear interpolation methods a.
Let us now consider the special case of MMSE channel estimation [27]:
aMMSE = R−1
ˆhLS
PrˆhLS
P,H,
(3.20)
which minimizes the Mean Square Error (MSE) of our channel estimation:
aMMSE = arg min
a MSE = arg min
a E{|H −aH ˆhLS
P|2}.
(3.21)
The variables α and β in Eqs.(3.17) and (3.18) then transform to:
αMMSE = βMMSE = aHRˆhLS
Pa = PSRX −MSE,
(3.22)
and γ in Eq.(3.19) becomes:
γ MMSE = PV + MSE |x|2
PSRX −MSE .
(3.23)

3
Symbol Detection in High Speed Channels
47
For perfect channel knowledge, the MSE approaches zero and therefore:
αperfect = βperfect = PSRX
(3.24)
and
γ perfect =
PV
PSRX
=
1
SNR.
(3.25)
Note that for MMSE channel estimation, the probability in Theorem 3.1 behaves
the same way as for perfect channel knowledge where the signal power is lowered
by the MSE and the noise power increased by MSE |x|2, as shown by Eq.(3.23) and
the fact that α/β becomes one, so that Theorem 3.1 only depends on γ .
The BEP equations in (3.14) and (3.15) require the projection onto the real axis,
that is, zI →∞, so that Theorem 3.1 transforms to:
Pr

ℜ

rn,k
ˆHn,k

<
a
√
b
     
qr + jqi
√
b
!
= 1
2 −1
2
%
qrℜ{αn,k} −qiℑ{αn,k} −aβn,k
&
×
%
(q2
r + q2
i )PSRX
n,k + b(PICI
n,k + PV)
−2a

qrℜ{αn,k} −qiℑ{αn,k}

+ a2βn,k

βn,k
−

qiℜ{αn,k} + qrℑ{αn,k}
2 &−1
2
(3.26)
with
αn,k = rH
ˆhLS
P,Hn,kan,k
(3.27)
βn,k = aH
n,kRˆhLS
Pan,k,
(3.28)
Equation(3.26) delivers immediately the required probabilities of Eqs.(3.14) and
(3.15) so that we can ﬁnd closed-form expressions. However, because the resulting
Equations are quite lengthy we consider, without loss of generality, only the special
case of of ℑ{rH
ˆhLS
P,Hn,kan,k} = 0 (interpolation compensates average phase shifts) and
ℜ{rH
ˆhLS
P,Hn,kan,k} > 0 (interpolation is better than a random guess), the BEP for 4-
QAM can then be written as:

BEP
4QAM
n,k
(an,k) = 1
2 −
1
2
'
(
(
)2(PSRX
n,k + PICI
n,k + PV)
aH
n,kRˆhLS
P an,k

rH
ˆhLS
P,Hn,k an,k
2 −1
.
(3.29)
One advantage of having close-form expressions is the fact that they can be used
for performance optimization. Let us for example minimize the BEP. In order to
minimize Eq.(3.29), the generalized Rayleigh quotient inside the square root has to

48
R. Nissel
be minimized, or equivalently, the inverse quotient
aH
n,krˆhLS
P,Hn,k rH
ˆhLS
P,Hn,k an,k
aH
n,kRˆhLS
P an,k
maximized.
Since the matrices in the nominator and denominator are Hermitian, this maximiza-
tion becomes a generalized eigenvalue problem
rˆhLS
P,Hn,krH
ˆhLS
P,Hn,kan,k = λ RˆhLS
Pan,k.
(3.30)
The unique solution (except irrelevant scaling) for Eq.(3.30) can be found by insert-
ing the MMSE estimation, see Eq.(3.20). The optimal interpolation for 4-QAM
therefore becomes:
a4QAM,minBEP
n,k
= arg min
an,k BEP4QAM
n,k
(an,k)
= R−1
ˆhLS
PrˆhLS
P,Hn,k
= aMMSE
n,k
.
(3.31)
Following along the same lines, the optimal interpolation for 16-QAM can be found
as:
a16QAM,minBEP
n,k
= arg min
an,k BEP16QAM
n,k
(an,k)
= κn,kR−1
ˆhLS
PrˆhLS
P,Hn,k,
(3.32)
whereas for low signal-to-noise ratios the real valued scaling factor κn,k is larger
then one and for large ratios it has to be smaller. However, numerical evaluations
have shown that Eq.(3.32) improves the BEP16QAM
n,k
only by less than 1% so that the
differences between a16QAM,minBEP
n,k
and aMMSE
n,k
can be neglected.
As already mentioned, the BEP in case of perfect channel knowledge can also be
calculated via Eq. (3.29) by selecting MMSE interpolation and setting the MSE to
zero, which leads to:
BEP4QAM,perfect
n,k
= 1
2 −
1
2
$
1 + 2
PICI
n,k +PV
P
SRX
n,k
.
(3.33)
3.4
Time-Variant Channel Estimation and ICI Mitigation
This section follows the idea of [28]: by assuming a continuous transmit signal, a
discrete receiver structure and a sufﬁcient long CP, the sampled time-variant transfer
function straightforwardly describes the OFDM transmission, so that an accurate
estimation of the channel is possibly. Compared with the usually considered impulse
response, which includes frequency components not relevant for data transmission,
the transfer function allows to ignore these irrelevant frequency components. By

3
Symbol Detection in High Speed Channels
49
employing a full block MMSE equalizer we are then able to combat the effects of
high mobility wireless channels.
Our goal is to estimate the sampled time-variant transfer function Cm,k using
known pilot symbols xP ∈CNP×1. The pilot symbol pattern can be arbitrary, e.g.,
diamond shaped, as deﬁned in the LTE standard (see Fig.1.2). Similar to Eq.(3.3),
we stack all elements of the channel Cm,k in a large vector c ∈CNcNsNf×1:
c =
C0,0 · · · C0,Nc−1 C1,0 · · · CNsNf−1,Nc−1
T
(3.34)
The assumption of Rayleigh fading implies that c is jointly complex-valued Gaussian,
that is, c ∼NC (0, Rc). The channel is normalized so that the diagonal elements of
Rc become one.
According to Eqs.(3.1) and (3.2), an LS estimation of the channel (Eq.3.37)
delivers onlythepiecewisemeanof thechannel, Hn,k, corruptedbyICI andnoise. The
relationship between the piecewise mean channel h ∈CNcNf×1 (h =
hT
1 · · · hT
Nf
T)
and the channel vector c ∈CNcNsNf×1 can be described by a sparse matrix M ∈
RNcNf×NcNsNf (100[1 −
N
NcNsNf ] percent of the elements are zero):
h = Mc.
(3.35)
with M given by:
M =

INf ⊗
01×Ncp 11×N
 1
N

⊗INc.
(3.36)
The received data symbols at pilot positions P are stacked in a vector rP ∈CNP×1
and element wise divided by the pilot symbols xP, so that the LS estimate of the
piecewise mean channel ˆhLS
P ∈CNP×1 at pilot positions becomes:
ˆhLS
P = Diag (xP)−1 rP.
(3.37)
An estimation of the channel vector c can then be found by:
ˆc = ˜AˆhLS
P.
(3.38)
Matrix ˜A ∈CNcNsNf×NP represents a general description of a linear estimation and
includes, for example, basis expansion models [6] or the MMSE solution (Eq.3.44).
Note that the linear estimator in Sect.3.3, an,k, represents only the estimation of
the piecewise mean channel and is written as vector function instead of a matrix.
Figure3.3 illustrates Eq.(3.38): estimates of the piecewise mean channel at pilot
positions are interpolated/extrapolated, delivering an estimate of the time variant
transfer function Cm,k.
Correlation matrix Rˆc = E{ˆcˆcH} ∈CNcNsNf×NcNsNf of our channel estimation can
be written as:
Rˆc = ˜A

MPRcMH
P + Diag

pICI
P

+ PV INP
 ˜AH,
(3.39)

50
R. Nissel
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
LS estimation of the piecewise mean channel
Subcarrier
| ˆHLS
n,k|
50
100 150 200
2
4
6
8
10
12
0
1
time index
MMSE channel estimation
Subcarrier
| ˆCm,k|
˜ALMMSE
Fig. 3.3 Illustration of our time-variant channel estimation: LS estimates of the piecewise mean
channel at pilot positions are interpolated respectively extrapolated (using the MMSE criterion)
which delivers an estimate of the time variant transfer function Cm,k
whereasvectorpICI
P ∈RNP×1 consistsofallICIpowerelements(Eq.3.8),correspond-
ing to the correct pilot positions. In order to determine matrix MP ∈RNP×NcNsNf, we
take NP rows, at correct pilot positions, out of matrix M ∈RNcNf×NcNsNf. The MSE
of our channel estimation is then given as the diagonal elements of the following
correlation matrix:
Rc−ˆc = Rc −˜AMPRc −RcMH
P ˜AH + Rˆc.
(3.40)
For the derivation of the MMSE channel estimation, we consider the ith element
of the channel estimation ˆc individually (i = k + (n −1)Nc). Let us denote the ith
row of matrix ˜A as ˘aT
i ∈R1×NP. Equation(3.38) then transforms to:
[ˆc]i = ˘aT
i ˆhLS
P
(3.41)
= ˘aT
i

MPc + Diag (xP)−1 (yICI
P + vP)

.
(3.42)
The orthogonal projection theorem requires:
E
*
([ˆc]i −[c]i)[ˆc]∗
i
+
= 0,
(3.43)
so that the MMSE solution ˜AMMSE ∈CNcNsNf×NP becomes:
˜ALMMSE = RcMH
P

MPRcMH
P + diag{pICI
P } + PV INP
−1
(3.44)
Equation(3.44) together with (3.38) delivers all NcNsNf MMSE estimates of the
channel Cm,k which can be inserted in Eq.(1.21) or (3.4) to estimate the behavior
of our OFDM system. Multiplying matrix M with Eq.(3.44) results in the MMSE
ﬁlter matrix AMMSE ∈CNcNf×NP, which delivers the MMSE estimate of the piecewise
mean channel ˆh:
ALMMSE = M ˜ALMMSE.
(3.45)

3
Symbol Detection in High Speed Channels
51
This is the conventional two-dimensional MMSE solution [27], see also Eq.(3.20) in
Sect.3.3, whereas usually the matrices RhP = MPRcMH
P ∈CNP×NP and Rh,hP =
MRcMH
P ∈CNcNf×NP are assumed to be known explicitly. We, on the other hand,
showed in this section how these matrices (RhP and Rh,hP) can be decomposed to
describe OFDM systems in doubly-selective channels.
Let us denote ˜An ∈CNcNFFT×NP as the ﬁlter matrix, consisting of those row ele-
ments of ˜A ∈CNcNsNf×NP which deliver the estimated channel ˆcn (see Eq.3.3):
ˆcn = ˜An ˆhLS
P.
(3.46)
We now denote the column i of ˜An as ˜a(i)
n ∈CNcNFFT×1:
˜An =
˜a(1)
n
· · · ˜a(NP)
n

.
(3.47)
Combining Eqs.(3.4), (3.46) and (3.47), the estimated OFDM matrix ˆDn becomes a
linear combination of the basis matrices B(i)
n ∈CNc×Nc:
ˆDn =
NP

i=1
yPi
xPi
⎡
⎢⎢⎢⎣

˜W1˜a(i)
n
	T
...

˜WNc ˜a(i)
n
	T
⎤
⎥⎥⎥⎦
,
-.
/
B(i)
n
.
(3.48)
Note that the matrices B(i)
n can be precomputed. Once we have the estimated OFDM
matrix ˆDn, the equalization is performed as follows:
ˆxn = ˆDH
n

ˆDn ˆDH
n + PV INc
	−1
rn.
(3.49)
For perfect channel knowledge, that is, ˆDn = Dn, Eq.(3.49) delivers the MMSE
estimation of the transmitted data symbols ˆxn [13]. However, we will call it MMSE
equalization even if the channel estimation is not perfect. Note that the complexity
of Eq.(3.49) can be reduced by exploiting the banded structure of the OFDM matrix
Dn [11]. It is also possible to reduce the amount of ICI by means of ICI cancellation
[29]:
rICICancel
n
= Dnxn + vn −ˆDICI
n
Q

ˆxn

,
(3.50)
where matrix ˆDICI
n
consists of nearly the same elements as ˆDn, with the difference that
thediagonalelementsareallzero,thusreﬂectingonlytheICIrelevantterms.Function
Q (·)indicatesthequantizationoftheestimateddatasymbols ˆxn,thatis,harddecision
according to the minimum distance criteria. The quantization process is nonlinear, so
that the ICI power after cancellation PICICancel
n,k
cannot be straightforwardly calculated.

52
R. Nissel
We approximate this power by assuming that the estimated data symbols in Eq.(3.50)
are perfectly known ˆxn = xn. The ICI power after cancellation can then be found as:
PICICancel
n,k
= tr

˜WICI
k Rcn−ˆcn

˜WICI
k
	H
,
(3.51)
whereas the correlation matrix Rck−ˆck is given by Eq.(3.40).
Our ICI mitigation method combines the OFDM matrix estimation in Eq.(3.48),
the MMSE equalization in Eq.(3.49) and the ICI cancellation in Eq.(3.50). The three
basic steps of our ICI mitigation method are:
• Step 1: We estimate the OFDM matrix ˆDn according to Eq.(3.48) in combina-
tion with (3.44) whereby the ICI power pICI
P is given by Eq.(3.8). The MMSE
equalization, Eq.(3.49), then delivers the estimated data symbols ˆxn of the ﬁrst
step.
• Step 2: The estimated data symbols ˆxn together with the estimated matrix ˆDn,
both obtained from the ﬁrst step, reduce the ICI at pilot position, see Eq.(3.50),
so that the piecewise mean LS channel estimates at pilot positions ˆhLS
P become
more accurate: ˆhLS
P = Diag (xP)−1 rICICancel
P
. This improved channel estimation
is then used in Eq.(3.48) together with (3.44) to estimate the OFDM matrix ˆDn.
Compared with the ﬁrst step, the ICI power pICI
P in Eq.(3.44) is now lower and
given by Eq.(3.51). After MMSE equalization, Eq.(3.49), we obtain the estimated
data symbols ˆxn of the second step.
• Step 3: Here, we treat all estimated data symbols ˆxn as if they were pilot symbols.
After ICI cancellation, using ˆxn and ˆDn from the second step, see Eq.(3.50), we
obtain the piecewise mean LS channel estimates at all NcNf positions by: ˆhLS =
diag{ˆx}−1rICICancel. In this step, we assume NcNf “pilot symbols”, so that matrix
MP in Eq.(3.44) becomes M and NP in Eq.(3.48) becomes NcNf. Additionally,
the ICI power pICI
P in Eq.(3.44) is further decreased compared to Step 2, because
the ICI cancellation uses more accurate estimations of the OFDM matrix. Note
that, if there exist data symbols of nonunit magnitude, e.g., 16-QAM, the ICI
power and noise power are enhanced due to the LS estimation process. Again,
MMSE estimation of the OFDM matrix, Eqs.(3.44) and (3.48), in combination
with MMSE equalization, Eq.(3.48), delivers the estimated data symbols ˆxn of the
third step.
All three steps are illustrated in Figs.3.4, 3.5 and 3.6.
3.5
Simulations and Measurements
This section presents the measurement results of [28]. In this example we use 13
subcarriers, 15 OFDM symbols and an LTE downlink pilot symbol pattern (as illus-
trated in Fig.1.2). Furthermore, we assume 4-QAM, a subcarrier spacing of 15kHz
and a carrier frequency of 2.5GHz.

3
Symbol Detection in High Speed Channels
53
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
LS estimation of the piecewise mean channel
Subcarrier
| ˆHLS
n,k|
50
100 150 200
2
4
6
8
10
12
0
1
time index
MMSE channel estimation
Subcarrier
| ˆCm,k|
˜ALMMSE
ˆDn
ˆxn = ˆDH
n
ˆDn ˆDH
n + P VINc
−1
rn
Fig. 3.4 Illustration of the ﬁrst step of our ICI mitigation technique (Step 1)
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
LS estimation of the piecewise mean channel
Subcarrier
| ˆHLS
n,k|
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
ICI cancelled LS estimation
Subcarrier
| ˆHLS
n,k|
50 100 150 200
2
4
6
8
10
12
0
1
time index
MMSE channel estimation
Subcarrier
| ˆCm,k|
ˆDn
ˆxn = ˆDH
n
ˆDn ˆDH
n + PV INc
−1
rn
ICI cancellation
Fig. 3.5 Illustration of the second step of our ICI mitigation technique (Step 2)

54
R. Nissel
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
LS estimation of the piecewise mean channel
Subcarrier
| ˆHLS
n,k|
5
10
15
2
4
6
8
10
12
0
1
OFDM Symbol
ICI cancelled LS estimation
Subcarrier
| ˆHLS
n,k|
50 100 150 200
2
4
6
8
10
12
0
1
time index
MMSE channel estimation
Subcarrier
| ˆCm,k|
ˆDn
ˆxn = ˆDH
n
ˆDn ˆDH
n + PV INc
−1
rn
ICI cancellation
estimated data symbols considered as pilot symbols
Fig. 3.6 Illustration of the third step of our ICI mitigation technique (Step 3)
Simulations
For our simulations we obtain the sampled time-variant transfer function Cm,k, as in
Eq.(1.21), by utilizing the following WSSUS channel model [30]:
Cm,k =
1
√
I
I

i=1
e
j

θi+2π νi
Δf
m
NFFT −2π τi
T k
	
,
(3.52)
whereas the random Doppler shifts νi are distributed according to a Jakes Doppler
spectral density, the random normalized delays τi
T are uniformly distributed between
0 and τmax
T
= 0.01 and the random phases θi are uniformly distributed between 0 and
2π, ensuring circularly symmetry. We assume NFFT = 13 samples, I = 200 channel
paths and consider 50,000 realizations over which we average. Additionally, all
random variables are assumed to be statistically independent, so that the frequency-
time correlation function becomes:
E
*
Cm1,k1C∗
m2,k2
+
= rC f [k1 −k2]rCt[m1 −m2].
(3.53)
with (J0 is the zero-th order Bessel function):
rCt[m1 −m2] = J0

2π νmax
Δf
m1 −m2
NFFT

(3.54)

3
Symbol Detection in High Speed Channels
55
rC f [k1 −k2] = sinc
τmax
T (k1 −k2)
	
e jπ τmax
T
(k1−k2).
(3.55)
If the channel elements are stacked according to Eq.(3.34), correlation matrix Rc ∈
CNcNsNf×NcNsNf becomes:
Rc =
⎡
⎢⎣
rCt[0]
· · · rCt[(Nf Ns −1)]
:
...
:
rCt[−(Nf Ns −1)] · · ·
rCt[0]
⎤
⎥⎦
⊗
⎡
⎢⎣
rC f [0]
· · · rC f [(Nc −1)]
:
...
:
rC f [−(Nc −1)] · · ·
rC f [0]
⎤
⎥⎦.
(3.56)
Figure3.7 shows that our theoretical BEP expressions for one-tap equalizers
(Sect.3.3) coincide with the simulated BER. The illustrated conventional methods
ignore ICI and estimate the channel either by MMSE (ICI is considered as additional
noise) or by linear interpolation of the three closest LS estimates at pilot position
(no statistical knowledge necessary). For a high SNR, the ICI becomes the limiting
factor so that the BEP of conventional methods soon saturates. This effect can be
mitigated by our proposed ICI mitigation technique. The BER after the third step
Theory
Simulation
0
5
10
15
20
25
30
35
10−4
10−3
10−2
10−1
10
0
Signal-to-Noise Ratio (dB)
Bit Error Ratio, Bit Error Probability
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Perfect Channel Knowledge, No ICI
Step 1
Step 2
Step 3
Conventional:
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Proposed method:
Step1 ⇒Step2 ⇒Step3
4QAM
v = 400 km/h
Fig. 3.7 Simulated BER and theoretical BEP as a function of SNR. Simulation conﬁrms our
analytical prediction. At high SNR, our ICI mitigation method avoids an early saturation of the
BER. Each step improves the BER and Step 3 achieves a performance close to perfect channel
knowledge and no ICI

56
R. Nissel
0
0.01
0.02
0.03
0.04
0.05
0.06
Normalized maximum Doppler shift νmax/Δf
0
50
100
150
200
250
300
350
400
1
5
10
15
20
Velocity (km/h)
Bit Error Ratio relative to the BER of Step 3
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Step 1
Step 2
Step 3
4QAM
SNR = 35 dB
Our proposed
method reduces
the BER by a
factor of 20
Fig. 3.8 Simulated BER relative to the BER of Step 3 as a function of velocity, respectively
normalized maximum Doppler shift. The higher the velocity, the better our methods performs
compared to conventional methods. For a velocity of zero, the BER of MMSE (no ICI mitigation),
Step 1 and Step 2 coincide
comes very close to perfect channel knowledge and no ICI which corresponds to the
lowest possible BER.
Figure3.8 shows observed BER relative to the BER of Step 3, thereby delivering
the improvement factor of our method. Clearly, for higher velocities, the ICI becomes
moreandmoreanimpedimentsothattheperformanceofourICImitigationtechnique
increases relatively to conventional methods. For time-invariant channels, i.e., zero
velocity, Step 1 and 2 exhibit the same BER as the one-tap equalizer using MMSE
CE (no ICI mitigation).
Measurements
Our measurements were conducted on the Vienna Wireless Testbed that has been
augmented by a rotating wheel unit to generate high speed movements [18]. Trans-
mitter and receiver are both placed indoors, in different rooms, and the number of
samples after demodulation is set to 26. For a given transmit power, corresponding
to a speciﬁc average SNR, we obtain different channel realizations by relocating
the transmit antenna to 144 positions, equidistantly spaced over a 3 × 3 wavelength

3
Symbol Detection in High Speed Channels
57
grid. The receive antenna moves at up to 400km/h and we measure always over
the same three wavelengths movement interval. To estimate the noise power at the
receiver, we include two all-zero OFDM symbols, x0 = 0Nc×1 and xNf+1 = 0Nc×1.
Similar, the ICI-plus-noise power is estimated by using all-zero subcarriers, xn,0 = 0
and xn,Nc = 0. Because the second order statistics, required for the MMSE estima-
tion, are not perfectly known, we obtain only a mismatched solution. We assume a
WSSUS channel and a separable correlation function, as in Eq.(3.53). For the MMSE
estimation, we cannot directly insert the estimated correlation functions because they
are corrupted by noise, leading to large errors due to the matrix inversion. We thus
model the delays as well as the Doppler shifts by a uniform distribution, so that the
frequency correlation is given by Eq.(3.55) and the time correlation by:
rCt[m1 −m2] = sinc

2νmax
Δf
m1 −m2
NFFT

.
(3.57)
From the estimated frequency correlation function ˆrC f we conclude that τmax =
0. The maximum Doppler shifts νmax, on the other hand, are chosen so that the
theoreticalICIpowerandthemeasuredICIpowercoincide.Atavelocityof100km/h,
we measure the same ICI power we would expect at 98km/h for a uniform distributed
Doppler spectral density, so that the normalized maximum Doppler shift in Eq.(3.57)
is set to νmax
Δf = 0.015. Similar, the measurement velocity of 200km/h corresponds to
an equivalent (uniform Doppler spectral density) velocity of 187km/h, 300–280km/h
and 400–372km/h.
Theory
Measurements
0
5
10
15
20
25
30
35
10
−4
10
−3
10
−2
10
−1
10
0
estimated Signal-to-Noise Ratio (dB)
Bit Error Ratio, Bit Error Probability
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Perfect Channel Knowledge, No ICI
Step 1
Step 2
Step 3
Conventional:
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Proposed method:
Step1 ⇒Step2 ⇒Step3
4QAM
v = 400 km/h
95 % conﬁdence
interval obtained
by bootstrapping
mean
Fig. 3.9 Measured BER and theoretical BEP as a function of estimated SNR, similar to Fig.3.7.
Also in testbed measurements, our proposed ICI mitigation methods comes close to perfect channel
knowledge and no ICI

58
R. Nissel
0.015
0.02
0.025
0.03
0.035
0.04
0.045
0.05
0.055
0.06
Normalized maximum Doppler shift νmax/Δf
100
150
200
250
300
350
400
1
5
10
15
20
Velocity (km/h)
Bit Error Ratio relative to the BER of Step 3
Linear, No ICI Mitigation
MMSE, No ICI Mitigation
Step 1
Step 2
Step 3
4QAM
SNR = 35 dB
Our proposed
method reduces
the BER by a
factor of 13
Fig. 3.10 Measured BER relative to the BER of Step 3 as a function of velocity. Compared to
Fig.3.8, the potential improvement of our ICI mitigation method is lower because the underlying
channel parameters differ between simulation and measurements (lower delay spread due to indoor
measurements, lower Doppler spread and NFFT > Nc)
Figure3.9 shows that our theoretical expressions for one-tap equalizers (Sect.3.3)
accurately model the true physical behavior. Each step of our proposed mitigation
technique reduces the BER whereas the third step achieves a performance close to
perfect channel knowledge and no ICI.
Figure3.10 illustrates the measured BER relative to the BER of Step 3. Compared
to Fig.3.8, the one-tap equalizers perform better due to different channel parameters
(lower delay spread, lower Doppler spread and NFFT > Nc), lowering the potential
improvement of our ICI mitigation method.
References
1. F. Hlawatsch, G. Matz, Wireless Communications over Rapidly Time-Varying Channels (Aca-
demic Press, Amsterdam, 2011)
2. F. Pena-Campos, R. Carrasco-Alvarez, O. Longoria-Gandara, R. Parra-Michel, Estimation of
fast time-varying channels in OFDM systems using two-dimensional prolate. IEEE Trans.
Wirel. Commun. 12(2), 898–907 (2013). doi:10.1109/TWC.2013.010413.120624
3. Z. Tang, R.C. Cannizzaro, G. Leus, P. Banelli, Pilot-assisted time-varying channel estimation
for OFDM systems. IEEE Trans. Signal Process. 55(5), 2226–2238 (2007)

3
Symbol Detection in High Speed Channels
59
4. Y. Mostoﬁ, D.C. Cox, ICI mitigation for pilot-aided OFDM mobile systems. IEEE Trans. Wirel.
Commun. 4(2), 765–774 (2005)
5. H. Hijazi, L. Ros, Polynomial estimation of time-varying multipath gains with intercarrier
interference mitigation in OFDM systems. IEEE Trans. Veh. Technol. 58(1), 140–151 (2009)
6. M. Simko, C. Mehlführer, T. Zemen, M. Rupp, Inter-carrier interference estimation in MIMO
OFDM systems with arbitrary pilot structure, in IEEE Vehicular Technology Conference (VTC
Spring) (2011)
7. C. Sgraja and J. Lindner, Estimation of rapid time-variant channels for OFDM using Wiener
ﬁltering, in IEEE International Conference on Communications (ICC), vol. 4, pp. 2390–2395
vol. 4, 2003, doi:10.1109/ICC.2003.1204362
8. C. Shin, J. Andrews, E. Powers, An efﬁcient design of doubly selective channel estimation
for OFDM systems. IEEE Trans. Wireless Commun. 6(10), 3790–3802 (2007). doi:10.1109/
TWC.2007.060134. Oct
9. S. Tomasin, A. Gorokhov, H. Yang, J.-P. Linnartz, Iterative interference cancellation and chan-
nel estimation for mobile OFDM. IEEE Trans. Wireless Commun. 4(1), 238–245 (2005)
10. P. Schniter, Low-complexity equalization of OFDM in doubly selective channels. IEEE Trans.
Signal Process. 52(4), 1002–1011 (2004)
11. L. Rugini, P. Banelli, G. Leus, Simple equalization of time-varying channels for OFDM. IEEE
Commun. Lett. 9(7), 619–621 (2005). doi:10.1109/LCOMM.2005.1461683. July
12. K. Fang, L. Rugini, G. Leus, Low-complexity block turbo equalization for OFDM systems in
time-varying channels. IEEE Trans. Signal Process. 56(11), 5555–5566 (2008)
13. Y.-S. Choi, P. Voltz, F. Cassara, On channel estimation and detection for multicarrier signals in
fast and selective Rayleigh fading channels. IEEE Trans. Commun. 49(8), 1375–1387 (2001).
doi:10.1109/26.939860
14. N. Miyazaki, S. Nanba, and S. Konishi, MIMO-OFDM throughput performances on MIMO
antenna conﬁgurations using LTE-based testbed with 100 MHz bandwidth, in 2010 IEEE 72nd
Vehicular Technology Conference Fall (VTC 2010-Fall), pp. 1–5 (2010). doi:10.1109/VETECF.
2010.5594527
15. P. Mahasukhon, H. Sharif, M. Hempel, T. Zhou, T. Ma, Distance and throughput measurements
in mobile WiMAX test bed, in IEEE Military Communications Conference (MILCOM’2010),
pp. 154–159 (2010)
16. K. Jang, M. Han, S. Cho, H.-K. Ryu, J. Lee, Y. Lee, S.B. Moon, 3G and 3.5 G wireless network
performance measured from moving cars and high-speed trains, in Proceedings of the 1st ACM
Workshop on Mobile Internet Through Cellular Networks, pp. 19–24. ACM (2009)
17. S. Caban, J. Rodas, J.A. García Naya, A methodology for repeatable, off-line, closed-loop
wireless communication system measurements at very high velocities of up to 560 km/h, in
Proceedings of the 2011 IEEE International Instrumentation and Measurement Technology
Conference (I2MTC2011) (2011). doi:10.1109/IMTC.2011.5944019
18. R. Nissel, M. Lerch, M. Rupp, Experimental validation of the OFDM bit error probability for
a moving RX antenna, in Proceedings of IEEE VTC, Vancouver, Canada (2014)
19. T. Wang, J. Proakis, E. Masry, J. Zeidler, Performance degradation of OFDM systems due to
Doppler spreading. IEEE Trans. Wirel. Commun. 5(6), 1422–1432 (2006). doi:10.1109/TWC.
2006.1638663
20. P. Robertson and S. Kaiser, The effects of Doppler spreads in OFDM(A) mobile radio systems,
in IEEE 50th Vehicular Technology Conference (VTC Fall), pp. 329–333, vol. 1 (1999). doi:10.
1109/VETECF.1999.797150
21. R. Nissel, S. Caban, M. Rupp, Closed-form capacity expression for low complexity BICM with
uniform inputs, in Proceedings of IEEE 26th Annual International Symposium on Personal,
Indoor and Mobile Radio Communications (PIMRC), Hong Kong (2015)
22. R. Nissel, M. Rupp, Bit error probability for pilot-symbol aided channel estimation in FBMC-
OQAM, in Proceedings of the IEEE International Conference on Communications (ICC),
Kuala Lumpur, Malaysia, (2016)
23. M.-X. Chang, Y.T. Su, Performance analysis of equalized OFDM systems in Rayleigh fading.
IEEE Trans. Wirel. Commun. 1(4), 721–732 (2002)

60
R. Nissel
24. P. Tan, N.C. Beaulieu, Effect of channel estimation error on bit error probability in OFDM
systems over Rayleigh and Ricean fading channels. IEEE Trans. Commun. 56(4), 675–685
(2008)
25. F.J. López-Martínez, E. Martos-Naya, J.F. Paris, U. Fernández-Plazaola, Generalized BER
analysis of QAM and its application to MRC under imperfect CSI and interference in Ricean
fading channels. IEEE Trans. Veh. Technol. 59(5), 2598–2604 (2010)
26. G. Taricco, E. Biglieri, Space-time decoding with imperfect channel estimation, vol. 4(4), pp.
1874–1888 (2005)
27. P. Hoeher, S. Kaiser, P. Robertson, Two-dimensional pilot-symbol-aided channel estimation by
Wiener ﬁltering, IEEE International Conference on Acoustics, Speech, and Signal Processing,
vol. 3, pp. 1845–1848 (1997)
28. R. Nissel, M. Rupp, Doubly-selective MMSE channel estimation and ICI mitigation for OFDM
systems, in Proceedings of the IEEE International Conference on Communications (ICC’15),
London (2015)
29. A. Molisch, M. Toeltsch, S. Vermani, Iterative methods for cancellation of intercarrier inter-
ference in OFDM systems. IEEE Trans. Veh. Technol. 56(4), 2158–2167 (2007). doi:10.1109/
TVT.2007.897628
30. P. Hoeher, A statistical discrete-time model for the WSSUS multipath channel. IEEE Trans.
Veh. Technol. 41(4), 461–468 (1992). doi:10.1109/25.182598

Chapter 4
Optimal Pilot Pattern for Downlink
Transmissions
Michal Šimko
Long Term Evolution (LTE) standards deﬁne a ﬁxed diamond shaped pilot pattern
over the time frequency grid in the downlink for Multiple-Input Multiple-Output
(MIMO) Orthogonal Frequency Division Multiplexing (OFDM) transmission sys-
tems. While the choice of the pattern is a compromise to cover a wide range of
channels with different Root Mean Square (RMS) delays and Doppler spreads, it is
also selected sparsely not to hamper capacity. In this chapter we investigate patterns,
that allow a variable pilot density as well as a variable power distribution between
pilots and data. Finally, both degrees of freedom are optimized and due to a certain
range of trade-off we propose a small set of pilot patterns that offers a substantially
higher throughput than today’s.1
4.1
Introduction
In [1] it is shown that for a given amount of pilot-symbol overhead, in terms of
Mean Square Error (MSE), it is optimal to position the pilot-symbols in a diamond-
shaped constellation for a time-frequency grid in an OFDM transmission scheme.
It is, however, not shown how to choose shape parameters of the diamond-shaped
pilot-symbol pattern and consequently how much overhead is required for a proper
channel estimation. Figure4.1 shows an example of such a diamond-shaped pilot-
symbol pattern. Diamond-shaped pilot-symbol patterns can be decomposed into two
patterns with pilot-symbols equi-spaced in time and in frequency directions with
distances Dt and Df, respectively. These two patterns with equi-spaced pilot-symbols
1The material presented here can be accessed in more detail in the Ph.D. thesis of Michal Šimko
available for download at http://theses.eurasip.org/theses/488/pilot-pattern-optimization-for-
doubly-selective/.
M. Šimko (B)
TU Wien, Vienna, Austria
e-mail: michal@simko.biz
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_4
61

62
M. Šimko
Fig. 4.1 Example of a
diamond-shaped
pilot-symbol pattern: the
pilot-symbol pattern is fully
described by two variables
Df and Dt. These parameters
determine the pilot-symbol
density in the time and the
frequency dimension
pilot symbol
data symbol
Dt
Df
 Df /2
 Dt/2
are separated from each other by ⌈Dt
2 ⌉in the time direction and by ⌈Df
2 ⌉in the
frequency direction. Therefore, a diamond-shaped pattern is fully described by two
variables Df and Dt. Figure4.1 shows an example of a diamond-shaped pilot-symbol
pattern with Df = 4 and Dt = 10.
Note that also LTE utilizes such a diamond shaped pilot-symbol pattern with ﬁxed
values Df = 6 and Dt = 7.
When the power is evenly distributed between the data and pilot-symbols, stacked
each in a vector xD and xP, respectively, there is:
PS =
1
ND
E

∥xD∥2
2

= 1,
(4.1)
PP = 1
NP
E

∥xP∥2
2

= 1,
(4.2)
where ND is the number of data-symbols, NP the number of pilot-symbols and
Nf = ND + NP the entire number of transmited symbols.
4.2
Least Squares Channel Estimation
In order to investigate the optimal choice of the pilot patterns, knowledge of the
channel estimator performance with a given pilot pattern is required. The Least
Squares (LS) channel estimate at the pilot-symbol positions is obtained by solving
the following minimization problem
ˆHLS
P = arg min
H ∥rP −HxP∥2
2 ,
(4.3)

4
Optimal Pilot Pattern for Downlink Transmissions
63
where the matrix ˆHLS
P ∈CNP×NP is assumed to be diagonal, representing the channel
only at the pilot-symbol positions. Vector xP contains the known pilot symbols and
rP the observations. Note that, Diag

ˆHLS
P

= ˆhLS
P, identical to Chap.3. Obviously,
such an estimator ignores the non-diagonal elements of the channel matrix and treats
the potential Inter-Carrier Interference (ICI) as noise. More details on this topic can
be found in [2]. The resulting MSE at the pilot-symbol positions is given as
σ 2
e,P = PV + PICI
PP
,
(4.4)
where PV denotes the noise power and PICI the ICI contribution. By increasing the
power radiated at the pilot-symbols PP, the channel estimates at the pilot-symbols
become more reliable. The channel estimates at the data positions have to be obtained
by applying a two-dimensional interpolation. In the following, we analyze the per-
formance of a general linear channel estimator in terms of MSE. A channel estimate
at an arbitrary data position using a linear interpolation is given by a weighted sum
of the S nearest channel estimates (in the Euclidean sense of the time-frequency
grid) at pilot positions. Let us denote the channel estimate at the jth data position by
ˆhD, j and the channel estimate at the ith pilot position by ˆhP,i. The lower indices i
and j are used as general description of the location in the time-frequency grid. In
contrast to Chap.3, we no longer denote each time-frequency position explicitly in
order to better distinguish between data symbols and pilot symbols, simplifying the
optimality decision. A channel estimate at a data position j can be expressed as a
weighted sum of S closest pilot-symbols
ˆhD, j =

i∈P j
a j,i ˆhP,i,
(4.5)
where P j denotes a set of the S nearest pilot-symbol positions to the data position
j. The weight a j,i is a real number that indicates how much the channel estimate at
the jth data position is inﬂuenced by the channel estimate at the ith pilot position.
We evaluate the performance of such a linear channel estimator by analytically
deriving its theoretical MSE at the data positions. Given the deﬁnition of MSE,
σ 2
e, j = E
hD, j −ˆhD, j

2	
= E

hD, j
2
−2ℜ

E

h∗
D, j ˆhD, j

+ E
ˆhD, j

2	
.
(4.6)
For the analytical derivation, we made the following assumptions:
• The channel power is normalized to one

E

hD, j
2
= 1

.
• The channel hD, j at a data position j and the estimation error ˜hi = hP,i −ˆhP,i
at a pilot position i are uncorrelated

E

h∗
D, j ˜hi

= 0

.

64
M. Šimko
• The channel hP,i at a pilot position i and the estimation error ˜hi′ at a pilot position
i′ are uncorrelated

E

hP,i ˜hi′

=

0.
Let us analyze the three terms in Eq.(4.6) individually. The ﬁrst term is equal
to one due to the system model E

hD, j
2
= 1. In the second term, ˆhD, j can be
replaced by Eq.(4.5)
ℜ

E

h∗
D, j ˆhD, j

= ℜ
⎧
⎨
⎩E
⎧
⎨
⎩h∗
D, j

i∈P j
a j,i ˆhP,i
⎫
⎬
⎭
⎫
⎬
⎭
= ℜ
⎧
⎨
⎩

i∈P j
a j,iE

h∗
D, j

hP,i −˜hi

⎫
⎬
⎭
=

i∈P j
a j,iℜ

R j,i

,
(4.7)
where ˜hi represents the estimation noise at the ith pilot position. The last step in
the above equation can be justiﬁed by the assumption that the channel at the jth
data position and the estimation error at the ith pilot position are uncorrelated. The
coefﬁcient R j,i = E

h∗
D, jhP,i

denotes the correlation between the channels at the
jth data-symbol and the ith pilot-symbol positions.
Let us proceed with the last term of Eq.(4.6), in which Eq.(4.5) is inserted and
consequentlytheequality ˆhP,i = hP,i −˜hi,whichstatesthatthechannelestimateat
the pilot-symbol position is given as the true channel superimposed by an estimation
error. Note that due to Eq.(4.2), it can be shown that the MSE of the LS channel
estimator at the pilot-symbol positions is identical to the noise power divided by the
power radiated at the pilot-symbols PV
PP for time-invariant channels [3]. In the case of
time-variant channels, also the ICI power has to be considered. Therefore the power
of ˜hi is equal to PV+PICI
PP
. We obtain:
E
ˆhD, j

2	
= E
⎧
⎨
⎩


i∈P j
a j,i

hP,i −˜hi


2⎫
⎬
⎭
= E
⎧
⎨
⎩

i∈P j

i′∈P j
a j,ia j,i′

hP,i −˜hi
∗
hP,i′ −˜hi′

⎫
⎬
⎭
=

i∈P j

i′∈P j
a j,ia j,i′ Ri,i′ +

i∈P j
a2
j,i
PV + PICI
PP
.
(4.8)
In the last step, we applied the assumption that the estimation error and channel are
uncorrelated. To summarize, Eq.(4.6) is simpliﬁed to

4
Optimal Pilot Pattern for Downlink Transmissions
65
σ 2
e, j = E
hD, j −ˆhD, j

2	
= 1 −2

i∈P j
a j,iℜ

R j,i

+

i∈P j

i′∈P j
a j,ia j,i′ Ri,i′ + PV + PICI
PP

i∈P j
a2
j,i.
(4.9)
A part of Eq.(4.9) is independent of the term PV+PICI
PP
, as it only depends on the
weights a j,i and on the correlation matrix. The dependency of the correlation matrix
can also be regarded as dependency on the maximum Doppler spread (or equivalently
the user velocity) and RMS delay spread. The second part of the MSE depends on
PV+PICI
PP
. This term is on the other hand independent of the correlation matrix. In
order to obtain the overall, MSE additional averaging over all data-symbols has to
be applied
σ 2
e =
1
ND
ND

j=1
σ 2
e, j.
(4.10)
The MSE error can be decomposed into a noise dependent part and a noise indepen-
dent part
σ 2
e = ce
PV + PICI
PP
+ d,
(4.11)
where ce is a scalar depending on the weights a j,i, given as
ce =
1
ND
ND

j=1

i∈P j
a2
j,i ≥0.
(4.12)
The value of the variable ce is obtained as arithmetic average over all data-symbol
positions. Its depends only on the interpolation weights a j,i of the estimator. The
constant d is a scalar depending on the weights a j,i as well as the correlation matrix.
In the following text, it is referred to as interpolation error (variance) d, given as
d =
1
ND
ND

j=1
⎛
⎝1 −2

i∈P j
a j,iℜ

R j,i

+

i∈P j

i′∈P j
a j,ia j,i′ Ri,i′
⎞
⎠≥0.
(4.13)
The interpolation error variance d is always greater than or equal to zero. If perfect
channel knowledge at the pilot-symbol positions is assumed, the resulting MSE
equals he interpolation error. Therefore, the interpolation error can be interpreted as
the estimation error caused by the interpolation process.
The choice of the interpolation weights a j,i depends on the interpolation strategy.
The simplest way to obtain the interpolation weights for doubly-selective channels

66
M. Šimko
is a two-dimensional linear interpolation. In this case, the set of S closest pilot-
symbols shrinks to those three closest pilot-symbols that deﬁne a plane. Additionally,
because of geometry reasons, the sum of the interpolation weights has to be equal
to one, namely 
i∈P j a j,i = 1. An example of a two-dimensional interpolation is
0
5
10
0
5
10
0
0.5
1
OFDM symbol index
subcarrier index
channel
pilot 2
pilot 1
pilot 3
data symbol
Fig. 4.2 Two-dimensional linear interpolation: channel estimate at a data position (green line) is
obtained by spanning a two-dimensional plane that is deﬁned by the three closest pilot-symbols
(red lines)
Doppler frequency
0 Hz
200 Hz
400 Hz
600 Hz
800 Hz
1000 Hz
1200 Hz
LS channel estimator
VehA channel model
NT=1
0
5
10
15
20
25
30
10-4
10-3
10-2
10-1
100
SNR [dB]
MSE 
Fig. 4.3 Comparison between theoretical (dashed lines) and simulated (solid lines) MSE of an LS
channel estimator at pilot position for a 1 × 1 transmission system at different Doppler frequencies
and linear interpolation at the data positions

4
Optimal Pilot Pattern for Downlink Transmissions
67
provided in Fig.4.2. First, three pilot-symbols (red lines), that are closest to a data-
symbol (green) line, are located. Second, a plane, that is spanned by these three
pilot-symbols, is sampled at the data-symbol position. Note that due to the linear
interpolation/extrapolation by a plane, some weights can become negative. More
details on how to obtain the interpolation weights for the two-dimensional linear
interpolation can be found in [4]. In this case, the interpolation weights depend
solely on the location of the pilot-symbols and are independent of the noise variance
and channel correlation.
In the case of a two-dimensional linear interpolation, the coefﬁcient ce depends
only on the pilot pattern. In the case of a two-dimensional linear interpolation with an
LTE Single-Input Single-Output (SISO) pilot-symbol pattern using an LS channel
estimator at pilot positions, delivers ce = 0.6623. Figure4.3 shows the simulated
(solid lines) and theoretical (dashed lines) MSE of an LS channel estimator, for
which an excellent agreement can be found.
4.3
Linear Minimum Mean Square Error Channel
Estimation
A better choice than the LS estimator is the Linear Minimum Mean Square Error
(LMMSE) estimator. Note, however, that the LMMSE channel estimator requires
knowledge of the second order statistics of the channel and the noise. It can be
shown that the LMMSE channel estimate is obtained by multiplying the LS estimate
at the pilot-symbol positions with a ﬁltering matrix ALMMSE ∈CND×NP [5]
ˆhLMMSE
D
= ALMMSE ˆhLS
P.
(4.14)
In order to ﬁnd the LMMSE ﬁltering matrix, the MSE
σ 2
e = E
hD −ALMMSE ˆhLS
P

2
2
	
,
(4.15)
has to be minimized, leading to
ALMMSE = RhD,hP

RhP,hP + PV + PICI
PP
I
−1
,
(4.16)
where the matrix RhP,hP = E

hPhH
P

∈CNP×NP denotes the channel correlation
matrix at the pilot-symbols, and the matrix RhD,hP = E

hDhH
P

∈CND×NP is the
channel crosscorrelation matrix.

68
M. Šimko
To derive the theoretical MSE, we insert Eq.(4.16) into Eq.(4.15):
σ 2
e =E

hD −

RhD,hP

RhP,hP −PV + PICI
PP
I
−1
ˆhLS
P

(4.17)

hD −

RhD,hP

RhP,hP −PV + PICI
PP
I
−1
ˆhLS
P
H⎫
⎬
⎭.
After a straightforward manipulation, the average MSE at the data subcarriers is
expressed as
σ 2
e =
1
ND
tr

RhD,hD −RhD,hP

RhP,hP + PV + PICI
PP
I
−1
RhP,hD

,
(4.18)
where ND is the number of data-symbols.
In order to derive interpolation error d for an LMMSE channel estimator, we
neglect the expression PV+PICI
PP
. Such an assumption corresponds to perfect knowledge
of the channel estimates at the pilot-symbol positions. In this way, interpolation error
d can be directly obtained from Eq.(4.18) as
d =
1
ND
tr

RhD,hD −RhD,hPR−1
hP,hPRhP,hD

.
(4.19)
0
5
10
15
20
25
30
10-4
10-3
10-2
10-1
100
SNR [dB]
MSE 
Doppler frequency
0 Hz
200 Hz
400 Hz
600 Hz
800 Hz
1000 Hz
1200 Hz
LMMSE channel estimator
VehA channel model
NT=1
Fig. 4.4 Comparison between theoretical (dashed lines) and simulated (solid lines) MSE of an LS
channel estimator at pilot position for a 1 × 1 transmission system at different Doppler frequencies
and LMMSE interpolator at the data positions

4
Optimal Pilot Pattern for Downlink Transmissions
69
An alternative approach to ﬁnd the LMMSE channel estimate can be obtained
using Eq.(4.5), where the set of pilot-symbols P j that impact the channel estimate
at a speciﬁc data position is extended from the three nearest pilot-symbols to all avail-
ablepilot-symbols.However,incontrasttothepreviouslyexplainedtwo-dimensional
linear interpolator, the weights a j,i depend on the channel correlation matrix and
Signal to Noise Ratio (SNR). Therefore, for the LMMSE channel estimator, SNR
dependent scalars ce(SNR) and d(SNR) can be found. In [4], it is shown how to ﬁnd
an SNR independent approximation of the variables ce and d.
Figure4.4 depicts the simulated (solid line) and the analytical (dashed line) MSE
of an LMMSE channel estimator for different Doppler frequencies. The simulated
MSE and the analytically derived MSE show nearly perfect identity. Further gener-
alizations in the context of multi-cell transmissions can be found in [6].
4.4
Optimal Power Allocation
Wenowdescribehowtodistributetheavailablepoweramongpilot-anddata-symbols
in an optimal manner. As the cost function, the post-equalization Signal to Interfer-
ence and Noise Ratio (SINR) of a Zero Forcing (ZF) equalizer under imperfect
channel knowledge is used. The general case of doubly-selective channels is con-
sidered. The resulting average post-equalization SINR for a ZF equalizer on the lth
layer and kth subcarrier is derived as
¯γn,k =
PS

PV + PICI + σ 2e PD

eHn

H(eff)
k
HH(eff)
k
−1
en
,
(4.20)
with matrix H(eff)
k
= HkFk, that is including a potential precoding matrix Fk. In
Eq.(4.20), it is assumed that the available data power PD is evenly distributed over
individual layers, i.e., PS = PD
Nf . Furthermore, a-priori knowledge about the channel
estimation performance in incldued in the SINR expression of a ZF equalizer by
inserting Eq.(4.11) in Eq.(4.20) and decomposing the expression into two parts
¯γn,k = fh

H(eff)
k

fpow (ce, d, PS, PP, PV) ,
(4.21)
with the so-called power allocation function fpow (ce, d, PS, PP, PV) being
fpow (ce, d, PS, PP, PV) =
PD

PV + PICI +

ce
PV+PICI
PP
+ d

PD

(4.22)

70
M. Šimko
and the equalizer allocation function
fh

H(eff)
k

=
1
NfeHn

H(eff)
k
HH(eff)
k
−1
en
.
(4.23)
It was shown in [7] that the post-equalization SINR of a ZF equalizer is a random
variable following a Gamma distribution for a stationary channel. Therefore, when
assuming a stationary channel, the mean value of the equalizer allocation function
can be obtained analytically
σZF,H(eff)
k
= E

fh

H(eff)
k

.
(4.24)
The value of σZF,H(eff)
k
is equal to NR −NT + 1 if neglecting antenna correlation
[7, 8]. Inserting Eq.(4.24) in Eq.(4.21), the average post-equalization SINR for a ZF
equalizer under imperfect channel knowledge is obtained as
¯¯γ = E

¯γn,k

=
PD

σ 2e PD + PV + PICI
σZF,H(eff)
k
.
(4.25)
In order to keep the overall transmit power constant, the powers radiated at the
pilot-symbols PP and at the data-symbols PD have to fulﬁll the following equation
PPNP + PSND = NP + ND,
(4.26)
where the variables NP and ND represent the number of pilot-symbols and data-
symbols in a subframe, respectively. In order to describe the interconnection between
the pilot-power PP and the data-power PD, we introduce a variable poff which is
the power offset between the power of the pilot-symbols and the data-symbols,
denoted by
PP = poff PD.
(4.27)
Therefore, PP and PD can be expressed in terms of the variables NP, NP, and poff:
PD =
NP + ND
ND + NP poff
,
(4.28)
PP = NP + ND
ND
poff + NP
= poff PD.
(4.29)

4
Optimal Pilot Pattern for Downlink Transmissions
71
Inserting Eqs.(4.28) and (4.29) into the power allocation function and simplifying
the expression, we obtain
fpow

ce, d, PP
poff
, PP, PV

=
1
(PV + PICI)

1
PP (poff + ce) +
d
PV+PICI

=
1
(PV + PICI)
 ND
poff +NP
NP+ND (poff + ce) + ˜d
,
(4.30)
with the variable ˜d being proportional to the interpolation error d (see Eq.(4.13))
and given as
˜d =
d
PV + PICI
.
(4.31)
Note that Eq.(4.30) is independent of the channel realization.
Let us proceed to the deﬁnition of the optimization problem. The target is to ﬁnd
an optimal value of poff that maximizes the post-equalization SINR in Eq.(4.20)
while keeping the overall transmit power constant. The optimization problem can be
formulated mathematically as
maximize
poff
¯γn,k
subject to
NDPD + NPPP = ND + NP.
(4.32)
In order to maximize the post-equalization SINR with respect to the variable
poff, the power allocation function in Eq.(4.30) has to be maximized with respect
to the variable poff. The terms PV + PICI and ˜d are larger than or equal to zero and
independent of the variable poff. Thus, in order to maximize the power allocation
function, the following expression has to be minimized
f (PP, PD) = 1
PD
+ ce
PP
,
(4.33)
which we refer to as simpliﬁed power allocation function. The simpliﬁed power
allocation function can be further simpliﬁed when inserting Eqs.(4.28) and (4.29)
leading to
¯f (poff) =
ND
poff + NP
NP + ND
(poff + ce) .
(4.34)
The above expression depends solely on the power offset among the pilot- and data-
powers not on the actual powers. The minimum of the simpliﬁed power allocation

72
M. Šimko
Fig. 4.5 The simpliﬁed
power allocation function
f (poff) for different antenna
conﬁgurations: the simpliﬁed
power allocation function
f (poff) versus power offset
for two state-of-the-art linear
channel estimators. The
functions have distinct
minimum points that
correspond to the optimal
choice of the power offset
-5
0
5
10
103.1
103.2
103.3
103.4
 power offset poff [dB]
power allocation function
LS channel estimator
LMMSE
channel estimator
1×1
2×2
4×4
function in Eq.(4.34) can simply be found by differentiation, resulting in the optimal
value of the variable poff
poff,opt =

NDce
NP
.
(4.35)
Figure4.5 shows an example of the simpliﬁed power allocation function from
Eq.(4.34) for LS and LMMSE channel estimators for various numbers of transmit
antennas utilizing LTE pilot patterns. All of these functions have distinct minimum
points.Theseminimumpointscorrespondtothemaximizationofthepost-equalization
SINR. Note that although ND and NP depend on the utilized bandwidth, the mini-
mum of f (poff) is independent of it, since ND and NP scale with the same constant
with increasing bandwidth and actually only their ratio is what matters.
4.4.1
Simulation Results
In the following part, we present simulation results and discuss the performance of
LTE transmission systems with different pilot-symbol powers under doubly-selective
channels. Table4.1 presents the most important simulator settings. The upper part
of the table list simulator settings that remain identical for all simulations, the lower
part will change during the following investigations. The performance of the system
is demonstrated at an SNR value of 10dB. Note that as derived earlier, the optimal
value of the variable poff is independent of the value of SNR.
Simulation results showing throughput performance for 1 × 1, 2 × 2, and 4 × 4
antenna conﬁgurations are shown in Fig.4.6 for LS and LMMSE channel estima-
tors. In this example, the Doppler frequency is set to 230Hz and SNR = 10dB. Little

4
Optimal Pilot Pattern for Downlink Transmissions
73
Table 4.1 Simulator settings
Parameter
Value
Bandwidth
1.4MHz
Number of data subcarriers
72
FFT size
128
CP duration
≈4.76µs
Number of transmit antennas
1, 2, 4
Number of receive antennas
1, 2, 4
Receiver type
ZF
Transmission mode
Open-loop spatial multiplexing
Channel type
ITU VehA [9]
MCS
Adaptive
SNR
10dB
Doppler frequency
230Hz
Lower part: settings for power distribution simulations
Fig. 4.6 Throughput of LTE
system versus poff using
different channel estimators
and various antenna setups.
Little arrows always indicate
the theoretically derived
optimal value of the variable
poff, that maximizes the
post-equalization SINR.
Conﬁdence intervals are
95%
-5
0
5
10
0
0.5
1
1.5
2
2.5
3
power offset poff [dB]
throughput [Mbit/s]
LS channel estimator
LMMSE channel estimator
SNR = 10 dB
Doppler frequency 230 Hz
VehA channel model
1×1
2×2
4×4
arrows always indicate the theoretically derived optimal value of the variable poff
that maximizes the post-equalization SINR. The simulation results show an excellent
match with the analytical solution. The precision of the simulated throughput curves
is indicated by 95% conﬁdence intervals. Using the optimal value of power offsets
between pilot- and data-symbols results in throughput maximization. Moving away
from this value, a throughput loss can be observed. However, this loss is usually not
severe and the relatively broad maximum indicates a high robustness against inac-
curate power distribution between pilot- and data-symbols. This is valid especially
for a highly accurate channel estimator such as the LMMSE channel estimator.
A negative value of the variable poff (in dB) corresponds to the reduction of
the power radiated at the pilot-symbols and an increasing power radiated at the

74
M. Šimko
data-symbols. Such a negative value is optimal in the case of four transmit antennas
applying an LMMSE estimator. This kind of channel estimator is of superb perfor-
mance and therefore requires less power at the pilot-symbols to obtain a high quality
channel estimate.
Considering a single transmit antenna with an LS channel estimator, the optimal
value of poff,opt = 5.61dB may be considered rather high. However, due to the low
number of pilot-symbols compared to the number of data-symbols, the overall power
radiated at the pilot-symbols is increased approximately by 6% compared to the case
of the uniform power distribution.
An OFDM transmission system that does not utilize different power levels for
its pilot- and data-symbols, corresponds to poff = 0 dB. In Fig.4.6 can be observed,
that using optimal power distribution results in throughput gains up to 10%. For the
LMMSE channel estimators, only a small gain can be observed because the values
of poff,opt are close to 1 (0dB). Therefore, a system with equal power radiated at
the pilot- and data-symbols is already close to the optimum. Although the provided
results are shown in the context of the current LTE standard, the presented concept is
not limited to it and can principally be applied to any MIMO OFDM based system.
4.5
Optimal Pilot Patterns
At this point, it is possible to analytically express the performance of a linear channel
estimator as a function of Df and Dt for diamond-shaped pilot-symbol patterns. With
this knowledge it is possible to maximize the post-equalization SINR in Eq.(4.21)
simply by maximizing the power allocation function in Eq.(4.22) [10]. However,
the optimal values of Df and Dt and the optimal power distribution between the
pilot- and the data-symbols cannot be found exclusively by maximizing the post-
equalization SINR. Such an approach leads to a solution with minimum distances
between adjacent pilot-symbols in the time and frequency directions, which would
decrease the available bandwidth for data transmission. Therefore, another cost
function is required that includes a penalty due to the bandwidth occupied by the
pilot-symbols. The constrained channel capacity is thus a natural choice for the new
cost function since it provides a more accurate estimate of the expected throughput
than capacity [11, 12]
C = Bs
Nf

n=1

k
log2

1 + γn,k

,
(4.36)
where Bs is the bandwidth utilized for the data transmission of a subcarrier and γn,k
is the post-equalization SINR at a layer n and a subcarrier k. The second sum in the
above equation is a sum over all subcarriers carrying data-symbols.
The constrained capacity in Eq.(4.36) is realistic as a waterﬁling solution for a
temporally changing channel is not feasible. Note also that for typically measured

4
Optimal Pilot Pattern for Downlink Transmissions
75
frequency selective MIMO channels the difference between the waterﬁlling solution
(capacity) and the proposed constrained version is very small [13]. The impact of pre-
coding matrices can be included in the channel estimation, as we consider here. Vari-
able γn,k represents the instantaneous post-equalization SINR. However, Eq.(4.36)
cannot be directly utilized as a cost function, since it would require the knowledge
of the instantaneous channel matrix and its estimation error. These are however not
available and thus we utilize an ergodic capacity in terms of its expectation value.
Such ergodic capacity requires the a-priori knowledge of statistics and is in gen-
eral difﬁcult to evaluate. However, its upper bound [14, 15] obtained by applying
Jensen’s inequality when inserting the mean post-equalization SINR Eq.(4.25) in
the constrained capacity expression Eq.(4.36), results in
C ≤
¯
C ,
(4.37)
¯
C = B (Df, Dt) log2

1 + ¯¯γ

,
(4.38)
= B log2

1 + fpow (ce, d, PS, PP, PV) σZF,H(eff)
k

.
(4.39)
Due to simplicity reasons in the above equations, we omit the dependency of the
variables B (Df, Dt), ce (Df, Dt), and d (Df, Dt, Rh) on the variables Dt, Df, and
Rh in the above equations. The ultimate target from physical-layer perspective is
to maximize throughput. However, throughput is very difﬁcult if not impossible to
track analytically [12], which would allow a low complexity solution. Therefore,
an analytical performance measure is required that allows to predict throughput
including channel estimation error. The presented upper bound of the constrained
capacity fulﬁls these requirements.
4.5.1
Unit Pilot Power
In the following, we present throughput simulation results and compare the perfor-
mance of two competitive wireless transmission systems in order to quantify the
performance gain provided by optimal pilot patterns compared to conventional ﬁxed
pilot patterns. The ﬁrst system utilizes LTE compliant pilot patterns for the purposes
of channel estimation. The second system is the same in all parameters as the ﬁrst
system except for the pilot patterns. It utilizes optimal pilot patterns with unit power
distribution among pilot- and data-symbols. We repeated the simulations according to
thesettingsinTable4.1withsomeparameterselecteddifferentlyaslistedinTable4.2.
In order to generate channels with an arbitrary RMS delay spread, we utilized the
model presented in [16]. For generating channels with an arbitrary Doppler spread,
we employed the modiﬁed Rosa Zheng model, (see, e.g., the appendix of [17]).
Figure4.7a illustrates throughput as a function of Doppler frequency for various
MIMO setups at a ﬁxed SNR value of 14dB and a ﬁxed RMS delay spread of 400ns.
The throughput of the system with LTE pilot patterns is approximately constant

76
M. Šimko
Table 4.2 Simulator settings
for optimal pilot patterns with
unit power distribution and
optimal power distribution
Parameter
Value
Channel type
RMS delay spread = 400ns
MCS
Adaptive
SNR
14dB, [0...30dB]
Doppler frequency
200Hz, [0...1200Hz]
Fig. 4.7 Performance of
optimal pilot patterns with
unit power distribution:
Dashed lines represent
systems utilizing LTE pilot
patterns. Solid lines represent
systems utilizing optimal
pilot patterns with unit power
distribution. a Throughput
versus Doppler frequency for
a ﬁxed SNR of 14dB and a
ﬁxed RMS delay spread of
400ns. b Throughput versus
SNR for a Doppler frequency
of 200Hz and a ﬁxed RMS
delay spread of 400ns
0
200
400
600
800
1000
1200
0
1
2
3
4
5
6
Doppler frequency [Hz]
throughput [Mbit/s]
SNR = 14 dB
RMS delay spread 400 ns
LS channel estimator
2×2
1×1
4×4
LTE pilot pattern
optimal pilot pattern
unit power allocation
0
5
10
15
20
25
30
0
2
4
6
8
10
12
14
16
18
20
SNR [dB]
throughput [Mbit/s]
1×1
2×2
4×4
Doppler frequency = 200 Hz
RMS delay spread 400 ns
LS channel estimator
LTE pilot pattern
optimal pilot pattern
unit power allocation
(a)
(b)
up to a certain value of Doppler frequency and then is begins to degrade. This
Doppler frequency value shifts to lower values as the number of transmit antennas is
increased. The performance degradation also worsens with an increasing number of
transmit antennas. The performance drop with an increasing Doppler frequency of a
4 × 4 system with LTE pilot pattern is mainly caused due to the pilot pattern placed
on the third and fourth transmit antennas that does not allow a precise estimation of

4
Optimal Pilot Pattern for Downlink Transmissions
77
time-variantchannels.Thesystemsutilizingoptimalpilotpatternsalwaysoutperform
the corresponding LTE systems. Let us consider a 1 × 1 transmission system. The
throughput approximately linearly decreases with an increasing Doppler frequency.
At around a Doppler frequency of 350Hz, a gap between the two competing systems
is the smallest from the considered scenarios and therefore we can conclude that the
LTE pilot pattern for a single transmit antenna is close to an optimal pilot pattern with
unit power distribution at a Doppler frequency of 350Hz. The performance of the
remaining antenna setups with optimal pilot patterns behaves in a similar manner:
approximately linear throughput loss with an increasing Doppler frequency. Note
that the throughput loss is more signiﬁcant as the number of transmit antennas is
increased. This is caused mainly by the fact that for a higher amount of transmit
antennas, there are more channel coefﬁcients to estimate and therefore also more
pilot-symbols are required. At Doppler frequencies around 950Hz, an SISO system
utilizing optimal pilot patterns outperforms a 2 × 2 MIMO system with the LTE pilot
pattern. Thus, at high Doppler spreads optimal pilot patterns allow to save hardware
cost and complexity that are inherently connected with MIMO applications.
Figure4.7b illustrates throughput versus SNR for various MIMO setups utilizing
either LTE pilot patterns or optimal pilot patterns with unit power distribution among
data- and pilot-symbols. In this simulation, the RMS delay spread and the Doppler
frequencyareﬁxedto400nsand200Hz,respectively.Consideringthedashedcurves,
which represent the systems utilizing LTE pilot patterns, a typical behavior can
be observed: increasing the number of transmit and receive antennas boosts the
overall throughput of the systems. However, at a low SNR value of 0dB, it is more
beneﬁcial to transmit only with a single antenna, because the potential multiplexing
beneﬁts cannot be exploited at such a low SNR value. The solid lines represent
systemsutilizingoptimalpilotpatterns.Thesealwaysoutperformtheircorresponding
counterparts. Note that for higher values of the Doppler frequency, the 4 × 4 MIMO
system with LTE pilot pattern performs poorly, due to the LTE pilot design on the
third and fourth transmit antennas. The standard compliant pilot pattern enables to
estimate time-variant channels with a very poor quality [18].
4.5.2
Optimal Pilot Power
Naturally, the adaptively selected pilot pattern can now also be combined with opti-
mal power allocation strategies. We thus repeat the previous experiment with optimal
power allocation. Figure4.8a presents throughput simulation results versus Doppler
frequency for various MIMO setups at a ﬁxed SNR of 14dB and a ﬁxed RMS delay
spread of 400ns. The dashed lines represent a transmission system utilizing pilot
patterns deﬁned by the LTE standard for various numbers of transmit antennas. The
solid lines represent the competing systems utilizing optimal pilot patterns with
optimal power distribution among pilot- and data-symbols. The system with optimal
pilot patterns outperforms the corresponding benchmark system in the considered
Doppler spread range. With increasing Doppler frequency the gap between an LTE

78
M. Šimko
Fig. 4.8 Performance of
optimal pilot patterns with
optimal power distribution.
a Throughput performance
versus Doppler frequency for
a ﬁxed SNR of 14dB and a
ﬁxed RMS delay spread of
400ns. Throughput as a
function of Doppler
frequency: Dashed lines
represent systems utilizing
LTE pilot patterns. Solid
lines represent systems
utilizing optimal pilot
patterns with optimal power
distribution. b Throughput
performance versus SNR for
a ﬁxed Doppler frequency of
200Hz and a ﬁxed RMS
delay spread of 400ns.
Throughput as a function of
SNR: Dashed lines represent
systems utilizing LTE pilot
patterns. Solid lines
represent systems utilizing
optimal pilot patterns with
optimal power distribution
LTE pilot pattern
optimal pilot pattern
optimal power allocation
SNR = 14 dB
RMS delay spread 400 ns
LS channel estimator
1×1
2×2
4×4
LTE pilot pattern
optimal pilot pattern
optimal power allocation
1×1
2×2
4×4
Doppler frequency = 200 Hz
RMS delay spread 400 ns
LS channel estimator
0
200
400
600
800
1000
1200
0
1
2
3
4
5
6
Doppler frequency [Hz]
throughput [Mbit/s]
0
5
10
15
20
25
30
0
2
4
6
8
10
12
14
16
18
20
SNR [dB]
throughput [Mbit/s]
(a)
(b)
system and the competing system widens. The throughput increase grows with an
increasing number of transmit antennas. Similar to the case of optimal pilot patterns
with unit power distribution, the throughput loss of the optimal systems is approxi-
mately linear with an increasing Doppler frequency. The loss is more signiﬁcant as
the number of transmit antennas is increased. A comparison of these results with the
results from Fig.4.7a yields a signiﬁcant improvement of the system utilizing also
optimal power distribution and not only optimal pilot patterns.
In the following, we investigate the performance of the considered systems versus
SNR for a ﬁxed Doppler and RMS delay spreads. Figure4.8b shows throughput for
various MIMO setups for an RMS delay spread of 400ns and a Doppler frequency of
200Hz. The dashed lines represent systems utilizing pilot patterns provided by LTE.
The solid lines represent systems utilizing optimal pilot patterns with optimal power
distribution. The optimal systems always outperform the LTE benchmark systems.
For the 1 × 1 system, the throughput gain is approximately constant up to an SNR

4
Optimal Pilot Pattern for Downlink Transmissions
79
value of 20dB. After this value, the gain becomes smaller when further increasing
SNR. For the 2 × 2 MIMO setup, the system utilizing optimal pilot patterns outper-
forms the LTE system by an approximately constant throughput offset in the whole
considered SNR range. The situation differs for a 4 × 4 system. In this case, the pilot
pattern provided by LTE fails to estimate precisely enough time-variant channels
and therefore the gap between the optimal system and the LTE system widens with
increasing SNR. Based on the behavior of the gap size, we can conclude that the LTE
pilot patterns for a single and two transmit antennas are close to optimal for high
SNR values. Note that these SNR values are far beyond a typical operation point.
Thus, the LTE pilot patterns are designed for rather extreme and unrealistic situations
in order to operate suboptimally but in a wide range of scenarios. Again it is worth
to compare with Fig.4.7b.
4.6
Adaptive Pilot Sets
Previously, we demonstrated how to design an optimal pilot-symbol pattern for a
given SNR value and a given channel autocorrelation matrix. The channel autocorre-
lation matrix can be decomposed into a time correlation matrix and a frequency cor-
relation matrix [2]. These two correlation matrices depend on the RMS delay spread
and maximum Doppler spread, respectively. Therefore, an optimal pilot-symbol pat-
tern is given by a triple of SNR, Doppler frequency, and RMS delay spread values.
In this section, we describe a concept of adaptive pilot-symbol patterns that adjust
to varying channel conditions. Furthermore, we investigate the feedback require-
ments for adaptive pilot-symbol patterns applied in MIMO OFDM systems. The
main goal is to support a wide range of Doppler spreads and RMS delay spreads
while keeping the number of allowed pilot-symbol patterns at a minimum.
Let us consider a state-of-the-art LTE system for a moment. This system for wire-
less transmission allows to adapt coding rate, modulation alphabet, precoding, and
some other important parameters of the transmission according to the quality of the
channel. The main idea in LTE is the usage of the so-called Channel Quality Indi-
cator (CQI) that is reported by the user equipment back to an Evolved Base Station
(eNodeB). The CQI is not only a measure of the channel quality, in consequence it
also deﬁnes two important transmission properties, the coding rate and the modu-
lation alphabet. There are 15 different CQIs deﬁned in LTE. The CQI corresponds
to an Additive White Gaussian Noise (AWGN) equivalent SNR value of a channel
realization. Therefore, for each CQI value, an optimal pilot pattern should be deﬁned.
In this way, no additional feedback overhead is created to distinguish different SNR
values, since the feedback for CQI is already implemented in the standard feedback
channel.
In order to allow the pilot pattern to adapt to a varying user mobility, pilot patterns
for various Doppler spreads (user velocities) have to be deﬁned. Later in this section,
we investigate a number of different pilot-symbol patterns required to support a
wide range of Doppler spreads. A typical LTE system shall support users moving

80
M. Šimko
with velocities up to 500km/h, which corresponds to a Doppler frequency of approx-
imately 1150Hz at a carrier frequency of 2.5GHz. Therefore, we divide the range
of the Doppler frequencies between 0 and 1200Hz into Nfr bins and for each bin, an
optimal pilot-symbol pattern is deﬁned for the center value of the corresponding bin.
Finally, in order to allow the pilot-symbol patterns to adapt to frequency selectivity
of the channel, optimal pilot-symbol patterns have to be designed for different values
of RMS delay spread. Typical values of RMS delay spread range between 0 and
800ns. We divide this range of RMS delay spread into Nt bins and for each bin, an
optimal pilot-symbol pattern is deﬁned for the center value of the corresponding bin.
Since the same pilot-symbol pattern is used for the entire transmission bandwidth,
the extra feedback requirements caused by the adaptive pilot-symbol patterns are
log2 (Nfr) log2 (Nt) bits, if coded by brute force. In case of a multi-user transmission,
log2 (Nfr) log2 (Nt)bits need to be reserved for each user. Note that since a single
pilot-symbol pattern is used across the entire transmission bandwidth, its feedback
requirements are negligible compared to other narrowband feedback indicators such
as CQI, Precoding Matrix Indicator (PMI), and Rank Indicator (RI).
4.6.1
Simulation Results
In the following, we present simulation results and compare the throughput of a
system with adaptive pilot-symbol patterns with different bin granularities, against
a system with a pilot-symbol pattern deﬁned by LTE standards and unit distribution
of power between data- and pilot-symbols. Figure4.9a illustrates throughput as a
function of RMS delay spread for a ﬁxed Doppler frequency of 0Hz at SNR values
of 14 and 30dB. The blue dashed curves represents the throughput for an SISO LTE
transmission system at a given SNR value. The throughput is approximately constant
versusRMSdelayspreadfortheLTEsystem.Thebluesolidcurverepresentsasystem
with optimal pilot patters with perfect granularity, i.e., an optimal pilot pattern is
generated for each RMS delay value. This system outperforms the standard compliant
LTE system in the whole considered RMS delay range. Let us focus on the green solid
curve in the 14dB SNR scenario. This curve represents a system utilizing optimal
pilot patterns, but in contrast to the previous case, the RMS delay spread range
is divided into two bins, and optimal pilot-symbol patterns generated for the center
points are utilized in the corresponding bins. The system with only two different pilot
patterns in the considered RMS delay spread range shows the same performance as
the competitive system utilizing a much higher number of pilot-symbol patterns.
Therefore, we can conclude that for the considered situation of a ﬁxed SNR of 14dB
and a ﬁxed Doppler frequency of 0Hz, only one bit of extra feedback is required, i.e.,
Nt = 2. Considering the green curve at an SNR value of 30dB, a throughput drop
occurs compared to the perfect case at an RMS delay spread of 350ns. Therefore, we
divide the RMS delay spread operation range into four bins, represented by the red
curve. In this case the performance is the same as in the case of perfect granularity.

4
Optimal Pilot Pattern for Downlink Transmissions
81
Fig. 4.9 Throughput
comparison of an LS with
optimal pilot patterns with
various feedback
granularities at SNR of 14
and 30dB. a Throughput as a
function of RMS delay
spread for a ﬁxed SNR of 14
and 30dB, and a ﬁxed
Doppler frequency of 0Hz.
Two bits of extra wide-band
feedback are sufﬁcient to
support a range of RMS
delay spread up to 800ns. b
Throughput as a function of
Doppler frequency for a ﬁxed
SNR of 14dB and a ﬁxed
RMS delay spread of 400ns.
Two bits of extra wide-band
feedback are sufﬁcient to
support a range of Doppler
frequency up to 1200Hz
0
200
400
600
800
0
1
2
3
4
5
6
RMS delay spread [ns]
throughput [Mbit/s]
Doppler frequency 0 Hz
LS channel estimator
SNR = 30 dB
SNR = 14 dB
granularity 400 ns
granularity 200 ns
perfect granularity
optimal pilot pattern
LTE pilot pattern
0
200
400
600
800
1000
1200
0
1
2
3
4
5
6
Doppler frequency [Hz]
throughput [Mbit/s]
RMS delay spread 400 ns
LS channel estimator
SNR = 30 dB
SNR = 14 dB
optimal pilot pattern
LTE pilot pattern
granularity 600 Hz
granularity 300 Hz
perfect granularity
(a)
(b)
Therefore, we can conclude that with two bits of extra wide-band feedback the RMS
delay spread operation range up to 800ns can be served.
Figure4.9b shows throughput versus Doppler frequency for a ﬁxed RMS delay
spread of 400ns at SNR of 14 and 30dB. The blue dashed curves represents through-
put for an SISO LTE transmission system at a given SNR value. A throughput drop
occurs as the Doppler frequency increases. The blue solid curve represents a system
with optimal pilot patters with perfect granularity. This system outperforms the stan-
dard compliant LTE system in the whole considered Doppler frequency range. Let
us focus on the green solid curve it the 14dB SNR scenario. This curve represents
a system utilizing optimal pilot patterns, but in contrast to the previous case, the
Doppler frequency range is divided into two bins, and optimal pilot-symbol patterns
generated for the center points are utilized in the corresponding bins. The system uti-
lizing only two different patterns in the considered Doppler frequency range shows
poorer performance than the system with perfect granularity. The performance loss

82
M. Šimko
can be observed at two points: ﬁrst, at low values of Doppler frequency, where too
many pilots are utilized for channel estimation and therefore they cannot serve for
data transmission. A second point is, at a Doppler frequency of 550Hz, where the
channel is not estimated properly. Therefore, we divide the Doppler frequency range
into four bins. The system utilizing four different pilot patterns is represented by
the red curve. The performance of such a system is the same as of the system with
perfect granularity. Therefore, we can conclude that in order to support Doppler fre-
quencies up to 1200Hz at an SNR value of 14dB, four different pilot patterns are
required. In order to draw more general conclusions, let us consider the simulation
results at a higher SNR value of 30dB. In general, at higher SNR values the system is
more sensitive to the utilized pilot patterns, since more precise channel estimates are
required. The curves at an SNR of 30dB show the same behavior as the 14dB. Thus,
four different pilot patterns are sufﬁcient to support the desired Doppler frequency
range. More details about adaptive pilot patterns can be found in [4, 19, 20].
References
1. J. Choi, Y. Lee, Optimum pilot pattern for channel estimation in OFDM systems. IEEE Trans.
Wirel. Commun. 4(5), 2083–2088 (2005). doi:10.1109/TWC.2005.853891
2. M. Šimko, C. Mehlführer, M. Wrulich, M. Rupp, Doubly Dispersive Channel Estimation with
Scalable Complexity, in Proceedings of the 14th International ITG Workshop on Smart Anten-
nas (WSA 2010), Bremen (2010), pp. 251–256. doi:10.1109/WSA.2010.5456443
3. M. Šimko, S. Pendl, S. Schwarz, Q. Wang, J.C. Ikuno, M. Rupp, Optimal pilot symbol
power allocation in LTE, in Proceedings of the 74th IEEE Vehicular Technology Conference
(VTC2011-Fall), San Francisco (2011). doi:10.1109/VETECF.2011.6092929
4. M. Šimko, Pilot pattern optimization for doubly-selective MIMO OFDM transmissions, Ph.D.
Thesis, TU Wien, 2013
5. S. Omar, A. Ancora, D. Slock, Performance analysis of general pilot-aided linear channel
estimation in LTE OFDMA systems with application to simpliﬁed MMSE schemes, in Pro-
ceedings of the IEEE 19th International Symposium on Personal, Indoor and Mobile Radio
Communications (PIMRC 2008), Cannes (2008), pp. 1–6. doi:10.1109/PIMRC.2008.4699619
6. M. Šimko, M. Rupp, Optimal pilot symbol power allocation in multi-cell scenarios of LTE, in
Conference Record of the Fourtyﬁfth Asilomar Conference on Signals, Systems and Computers,
Paciﬁc Grove (2011)
7. D. Gore, R. Heath Jr., A. Paulraj, On performance of the zero forcing receiver in presence
of transmit correlation, in Proceedings of the IEEE International Symposium on Information
Theory (ISIT 2002), Lausanne (2002), p. 159. doi:10.1109/ISIT.2002.1023431
8. P. Li, D. Paul, R. Narasimhan, J. Ciofﬁ, On the distribution of SINR for the MMSE MIMO
receiver and performance analysis. IEEE Trans. Inf. Theory 52(1), 271–286 (2006). doi:10.
1109/TIT.2005.860466
9. ITU, Recommendation ITU-R M.1225: Guidelines for evaluation of radio transmission tech-
nologies for IMT-, systems, International Telecommunication Union, 1998 (2000)
10. M. Šimko, Q. Wang, and M. Rupp, Optimal pilot symbol power allocation under time-variant
channels, EURASIP J. Wirel. Commun. Netw. (2012). doi:10.1186/1687-1499-2012-225
11. C. Mehlführer, S. Caban, M. Rupp, Cellular system physical layer throughput: how far off are
we from the Shannon bound? IEEE Wirel. Commun. 18(6), 54–63 (2011). doi:10.1109/MWC.
2011.6108334

4
Optimal Pilot Pattern for Downlink Transmissions
83
12. S. Schwarz, M. Šimko, M. Rupp, On performance bounds for MIMO OFDM based wireless
communication systems, in Proceedings of the IEEE Signal Processing Advances in Wireless
Communications, San Francisco (2011)
13. M. Rupp, J. Garcia-Naya, C. Mehlführer, S. Caban, L. Castedo, On mutual information
and capacity in frequency selective wireless channels, in Proceedings of the IEEE Interna-
tional Conference on Communications (ICC 2010), Cape Town (2010). doi:10.1109/ICC.2010.
5501942
14. A. Forenza, M. McKay, A. Pandharipande, R. Heath, I. Collings, Adaptive MIMO transmission
for exploiting the capacity of spatially correlated channels. IEEE Trans. Veh. Technol. 56(2),
619–630 (2007). doi:10.1109/TVT.2007.891427
15. S. Loyka, A. Kouki, New compound upper bound on MIMO channel capacity. IEEE Commun.
Lett. 6(3), 96–98 (2002). doi:10.1109/4234.991144
16. K. Hassan, T. Rahman, M. Kamarudin, F. Nor, The mathematical relationship between max-
imum access delay and the RMS delay spread, in Proceedings of the 7th International Con-
ference on Wireless and Mobile Communications (ICWMC 2011), Luxembourg (2011), pp.
18–23
17. T. Zemen, C. Mecklenbräuker, Time-variant channel estimation using discrete prolate spher-
oidal sequences. IEEE Trans. Signal Process. 53(9), 3597–3607 (2005). doi:10.1109/TSP.2005.
853104
18. M. Šimko, P.S.R. Diniz, Q. Wang, M. Rupp, Adaptive pilot-symbol patterns for MIMO OFDM
systems. IEEE Trans. Wirel. Commun. 12(9), 4705–4715 (2013)
19. M. Šimko, P.S.R. Diniz, M. Rupp, Design requirements of adaptive pilot-symbol patterns, in
Proceedings of the ICC Workshop: beyond LTE-A, Budapest (2013)
20. M. Šimko, Q. Wang, M. Rupp, Optimal pilot pattern for time variant channels, in Proceedings
of the IEEE International Conference on Communications (ICC 2013), Budapest (2013)

Chapter 5
Single User MIMO LTE Transmission
with Quantized Feedback
Markus Rupp, Stefan Schwarz and Martin Taranetz
Since the introduction of single-user spatial multiplexing in radio communications
in the early nineties of the last century by A. Paulraj and T. Kailath [1], Single
User Multiple-Input Multiple-Output (SU-MIMO) is heavily adopted in commercial
systems to leverage the theoretically established advantages of multiple antennas at
the transmitter and the receiver for improving the transmission rate (spatial mul-
tiplexing) and the reliability (diversity) of the communication channel [2–4]. The
highest performance in Multiple-Input Multiple-Output (MIMO) communications
is achieved if instantaneous Channel State Information (CSI) is available at both, the
transmitter and the receiver. A comprehensive overview of results on the Shannon
capacity of SU-MIMO with different assumptions about the availability of CSI at
the transmitter and the receiver is provided in [5]. The focus of this chapter is hence
on the acquisition of instantaneous CSI. It is assumed that the receivers obtain CSI
autonomously using channel estimation, while the base station relies on ﬁnite rate
feedback links from the users to obtain instantaneous Channel State Information at
the Transmitter (CSIT).
In this chapter, the most commonly implemented variant of SU-MIMO in com-
mercial wireless communications, that is, codebook based linear precoding [6], is
considered. With codebook based precoding efﬁcient CSI feedback is facilitated,
enabling reasonably close to optimal performance with an acceptable feedback over-
head [7]. The capacity of the point-to-point Additive White Gaussian Noise (AWGN)
MIMO channel with perfect instantaneous CSI at the transmitter and the receiver
can be achieved by Singular Value Decomposition (SVD) based unitary precoding
and reception along with power loading across the eigenmodes of the channel [8].
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_5
85

86
M. Rupp et al.
In the considered wireless communication system, motivated by the approach stan-
dardized in Long Term Evolution (LTE), a coarse approximation of SVD based
precoding is implemented. In this approach the unitary precoders are restricted to a
pre-speciﬁed set (codebook) of matrices and the continuous power loading is replaced
with an on-off switching of spatial data streams, effectively leading to a codebook of
semi-unitary precoders. Notice, a p × q matrix U with q ≤p is called semi-unitary if
UHU = Iq. Based on this codebook, the preferred precoder that optimizes a given per-
formance criterion is determined by the users and this information is efﬁciently con-
veyed to the base station by signaling the codebook index together with the number of
spatial streams that are switched on, i.e., the transmission rank. This idea of implicit
CSI feedback can be straightforwardly extended to MIMO Orthogonal Frequency
Division Multiplexing (OFDM), by providing feedback for each Resource Element
(RE) separately. To reduce the CSI feedback overhead, the correlation of the wireless
channel in the time-frequency domain can be exploited by means of clustered feed-
back [9] or feedback interpolation [10]. Again motivated by the approach standard-
ized in LTE, clustered feedback is considered. Here, the optimal precoder is deter-
mined for a set of REs, denoted as Resource Block (RB), effectively scaling down
the feedback overhead by the size of the set in the time domain and in the frequency
domain. The feedback clustering considered in this chapter is detailed in Sect.5.2.
In addition to CSI feedback for MIMO precoding, feedback for transmission rate
adaptation is another important topic of this chapter. Transmission rate adaptation
is achieved by means of Adaptive Modulation and Coding (AMC), supporting a set
of pre-speciﬁed combinations of modulation alphabets and coding rates of the For-
ward Error Correction (FEC), denoted as Modulation and Coding Schemes (MCSs),
to cover the projected operating regime of the cellular network. The binary channel
coder and the modulation mapper are joined over a bit-interleaver, forming a Bit
Interleaved Coded Modulation (BICM) architecture. BICM is employed by many
of today’s waveform communication systems, due to its high ﬂexibility in allowing
to combine virtually any binary code with any modulation format, while provid-
ing performance close to Shannon capacity [11, 12]. With the considered system
architecture of Fig.1.6, the same MCS is applied on all REs that are assigned to a
user. Hence, an average channel quality measure must be deﬁned that realistically
represents the achievable transmission rate over a multitude of OFDM subcarriers.
To this end, effective Signal to Interference and Noise Ratio (SINR) averaging, a
technique commonly employed for link to system level abstraction [13], is used to
determine the average channel quality, which is utilized as CSI feedback for trans-
mission rate adaptation.
If multiple users are served in a cell, CSI about the achievable transmission rate can
additionally be exploited during multi-user scheduling to achieve a multi-user diver-
sity gain. It has been shown that the sum capacity over Rayleigh fading channels with
opportunistic scheduling scales double logarithmically with the number of users, due
to the statistically independent fading of the different users; see, e.g., [14]. Lever-
aging the multi-user diversity in Orthogonal Frequency Division Multiple Access
(OFDMA)requirestime-frequencyselectivefeedbackfromtheusers.Similarlytothe
precoder feedback, clustered feedback is useful to reduce the CSI feedback overhead

5
Single User MIMO LTE Transmission with Quantized Feedback
87
of the achievable rate feedback as well. The trade-off between the feedback granu-
larity and the achieved multi-user diversity gain is investigated in a simulation-based
study at the end of this chapter.
This chapter is organized as follows: In Sect.5.1, the concepts of AMC are
described in more detail and the principles of codebook based precoding and capacity
achieving SVD based precoding are reviewed, considering a system architecture in
accordance with the LTE standard. Taking into account the constraints mentioned
above, a discrete joint-optimization problem for ﬁnding the optimal feedback indi-
cators for the achievable transmission rate, the precoders and the transmission rank
is deﬁned in Sect.5.2. To reduce the complexity of an exhaustive search, a subop-
timal sequential solution of the optimization problem is derived. Also, an antenna
subset selection algorithm is proposed that is useful for improving the performance
of codebook based precoding in Distributed Antennas Systems (DASs). In Sect.5.3,
the throughput and Block Error Ratio (BLER) performance of the proposed feedback
selection algorithms is investigated by means of Monte-Carlo simulations. Further-
more, the performance is compared to theoretical throughput bounds that take into
account the constraints imposed by the considered technology. The details of these
bounds are provided in [15, Appendix D]. The methods presented in this chapter are
published in [16–20].
5.1
Principles of Link Adaptation and Linear Precoding
5.1.1
Link Adaptation
In cellular communications, the quality of the transmission link is subject to signif-
icant variations over time and frequency, due to macroscopic (pathloss, shadowing)
and microscopic (multipath interference) fading and due to interference from neigh-
boring cells [8]. A common approach to counteract these effects and to improve the
reliability and data rate of the transmission is link adaptation, where the transmission
parameters of the communication link are adapted to account for the current channel
conditions. The preferred link adaptation method of early Code-Division Multiple
Access (CDMA) systems is fast power control, where variations in the channel gain
are compensated by the transmit power of the base station. More recently, e.g., in
High-Speed Packet Access (HSPA) and LTE, link adaptation is implemented through
AMC, improving the network capacity by exploiting the fading conditions of the
wireless channel [21]. In all cases, link adaptation is based on CSIT.
Here, link adaptation by means of AMC in accordance with the LTE standard
[22, 23] is considered. The corresponding BICM system architecture of LTE is
illustrated in Fig.5.1, presenting a more detailed block-diagram of the AMC part
of Fig.1.6. The user input data is processed according to the following steps:
• Mapping of payload bits onto codewords. In LTE, the number of codewords Cℓk[u,i]
ofauserisrestrictedasCℓk[u,i] ≤2andisimplicitlydeterminedbythetransmission
rank, i.e., the number of spatial data streams ℓk[u, i].

88
M. Rupp et al.
Adaptive modulation and coding
channel
coding
modulation
mapping
user data bits
codeword
mapping
codewords
coded bits
bit
interleaving
modulated symbols
Fig. 5.1 AMC based on a BICM architecture according to the LTE speciﬁcations
• Channel coding of the codewords. The coding rate of each codeword can be chosen
independently in LTE, accounting for the varying channel quality over spatial
streams.
• Bit interleaving of the coded bits. Independent interleaving is applied to each
codeword in LTE. Bit interleaving is employed to reduce the impact of error bursts
due to channel fading [24], improving the performance of the FEC.
• Mapping of the coded bits onto modulated symbols. In AMC, a set of modulation
alphabets A is supported to enable robust transmission in case of bad channel
conditions and high spectral efﬁciency in case of good channel quality. In LTE,
4Quadrature Amplitude Modulation (QAM), 16QAM and 64QAM are imple-
mented.
Following the AMC stage, the modulated symbols corresponding to the codewords
are mapped onto the spatial streams by the layer mapping shown in Fig.1.6. In case
that ℓk[u, i] > Cℓk[u,i], a codeword is divided onto multiple spatial streams [22].
The capacity of BICM is derived for memoryless channels in [11]. In Fig.5.2,
a comparison between the capacity achieved with the BICM architecture and the
Shannon capacity is shown for a Single-Input Single-Output (SISO) AWGN chan-
nel. The three BICM curves correspond to the performance of 4/16/64QAM. The
Fig. 5.2 Shannon capacity
versus BICM capacity and
the efﬁciency of LTE over an
AWGN channel
1
0
2
2
2
4
2
6
-
4
-
2
-
0
2
4
6
8
0
1
2
1
4
1
6
1
8
8
7
6
5
4
3
2
1
0
SNR [dB]
Spectral efficiency [bit/s/Hz]
Shannon capacity
BICM64 capacity
BICM16 capacity
BICM4 capacity
LTE efficiency

5
Single User MIMO LTE Transmission with Quantized Feedback
89
saturation of the BICM capacity at high Signal to Noise Ratio (SNR) occurs due to
the ﬁnite number of symbols in the modulation alphabets. It can be seen that the
theoretical spectral efﬁciency obtained with BICM is close to the Shannon capacity
(implying Gaussian signaling) over a wide SNR range, explaining the popularity of
BICM for commercial implementations. Notice though that powerful channel codes
and complex detection algorithms are required in practice to achieve close to optimal
performance with BICM, involving soft-information exchange between the symbol
demapper and the channel decoder and possibly iterative detection [12, 25]. Also
shown in the ﬁgure is the performance achieved with the MCSs deﬁned in the LTE
speciﬁcations [23] as obtained from link level simulations employing the Vienna LTE
link level simulator [26]. No iterations between the soft-output symbol demapper and
the soft-input channel decoder are considered in these simulations and perfect CSI
at the receiver is assumed for data detection. The LTE efﬁciency curve is obtained
as the maximum over the 15MCSs of LTE. The efﬁciency is calculated only from
frequency bins that are used for data transmission, i.e., the additional loss caused by
the overhead for reference symbols is not taken into account. The values at the saddle
points of this curve are equal to the peak spectral efﬁciencies of the individual MCSs.
A loss of approximately 2dB is encountered by LTE compared to the BICM capacity.
Over a SISO AWGN channel the SNR range from −10 to 20 dB can effectively be
covered by the link adaptation of LTE. The incurred loss of LTE compared to the
BICM capacity can be attributed to the imperfect operation of the channel code.
5.1.2
Linear Precoding for Single User Muliple-Input
Multiple-Output
In SU-MIMO transmission, only one user is served per cell on a given time-
frequency resource. Hence, the in-cell interference term I (in)
ν,u,i[n, k] in the SINR
expression (1.44) is equal to zero. In this chapter it is assumed that the out-of-
cell interference is treated as additional Gaussian noise by the transmitter and the
receiver, and that the users are able to estimate the power of the effective noise
deﬁned in Eq.(1.37). Notice that Gaussianity of the out-of-cell interference may
not be fulﬁlled in all cases, e.g., if there are only a few dominant interferers. Then
better performance can be achieved with receivers that estimate the interference sta-
tistics [27]. However, Gaussianity of the out-of-cell interference can be justiﬁed by
the central limit theorem, considering the increasing density of cellular networks.
With this simplifying assumption, the general input-output relationship of user u in
cell i according to Sect.1.5 is reduced to a point-to-point AWGN MIMO channel,
possibly with distributed transmit antennas
yn,k[u, i] = Gn,k[u, i]Hn,k[u, i]Fn,k[u, i]xn,k[u, i] + Gn,k[u, i] ˜zn,k[u, i],
(5.1)
where ˜zn,k[u, i] ∼NC

0, P˜z INR[u,i]

.

90
M. Rupp et al.
SVD Based Precoding and Equalization
The capacity of the point-to-point AWGN MIMO channel with perfect CSI at
the transmitter and the receiver can be achieved by SVD based precoding and
equalization [8]. Although perfect CSI is unrealistic in practice, the method still
provides a good benchmark for comparing the performance of limited feedback
techniques and it is hence brieﬂy reviewed.
The compact-form SVD of the channel matrix Hn,k[u, i] at RE [n, k] can be
written as
Hn,k[u, i] = Un,k[u, i]Σn,k[u, i]Vn,k[u, i]H,
(5.2)
Σn,k[u, i] = diag

σ (1)
n,k[u, i], . . . , σ (ℓmax)
n,k
[u, i]

,
wherethesemi-unitarymatricesUn,k[u, i] ∈CNR[u,i]×ℓmax andVn,k[u, i] ∈CNT[i]×ℓmax
denote the matrices of left singular vectors and right singular vectors, respectively.
The νth diagonal element σ (ν)
n,k [u, i] of the singular value matrix Σn,k[u, i] is equal to
the νth largest singular value of Hn,k[u, i]. Assuming a full-rank channel, the max-
imum number of streams is ℓmax = min (NT[i], NR[u, i]). By setting the precoder
and the receive ﬁlter according to
Fn,k[u, i] = Vn,k[u, i]Pn,k[u, i]1/2,
(5.3)
Gn,k[u, i] = Un,k[u, i],
(5.4)
with Pn,k[u, i] = diag

p1[n, k], . . . , pℓmax[n, k]

being a diagonal power loading
matrix, the effective channel is decomposed into ℓmax parallel non-interfering AWGN
SISO channels, denoted as spatial modes. The input-output relationship simpliﬁes to

yn,k[u, i]

ν =

pν[n, k]σ (ν)
n,k [u, i]

xn,k[u, i]

ν + ˜zn,k[u, i], ν ∈{1, . . . , ℓmax} , (5.5)
with ˜zn,k[u, i] ∼NC (0, P˜z) because the receive ﬁlter is semi-unitary. To achieve
the highest transmission rate, the diagonal elements of Pn,k[u, i] have to be set
according to the water-ﬁlling power allocation policy over the squared singular values
normalized by the effective noise variance. The water level is equal to the transmit
power Pi [8]. Assuming equal and spatially uncorrelated out-of-cell interference on
all receive antennas, the effective noise variance is calculated as
˜σ 2
z = σ 2
z +
1
NR[u, i]
I
	
j=0, j̸=i



H( j)
n,k[u, i]Fn,k[ j]



2
,
(5.6)
with H( j)
n,k[u, i] denoting the channel of user u at base station i with respect to base
station j, and Fn,k[ j] being the precoder applied at base station j. Notice that knowl-
edge of the out-of-cell channel matrices and the precoders applied in the other cells

5
Single User MIMO LTE Transmission with Quantized Feedback
91
is not required in practice to estimate the effective noise variance [28]. Due to the
applied water level, the total power constraint


Fn,k[u, i]


2 = Pi
(5.7)
is satisﬁed by the precoder. In this derivation independent per RE power constraints
are assumed. If power loading over REs is considered, the water-ﬁlling power allo-
cation is calculated over spatial streams and REs; see [13, 19].
Codebook Based Precoding with Linear Equalization:
In the previous paragraph it is shown that the capacity achieving transmit strategy
of the point-to-point AWGN MIMO channel involves linear precoding and recep-
tion employing semi-unitary matrices. To calculate the precoder at the base station,
knowledge of the left singular matrix together with the SNR obtained on each spatial
mode is required. This suggests that with limited feedback these values should be
quantized and fed back by the users [29].
Nonetheless, with codebook based precoding a different approach is taken, which
is shown to outperform direct quantization of the channel matrix in [6]. Instead
of quantizing the channel, the optimal precoder is determined by the user from a
given precoder quantization codebook. In [6], criteria for the selection of the optimal
precoder and corresponding quantization codebook constructions are proposed for
single carrier systems. It is shown that the optimal quantization codebooks for the
transmission of ℓspatial streams are maximally spaced subspace packings in the
Grassmann manifold of ℓ-dimensional subspaces in the NT[i]-dimensional Euclid-
ean space G (NT[i], ℓ). For a short introduction of the Grassmann manifold see
[15, Appendix C]. Depending on the considered performance criterion, different dis-
tance metrics are employed for the construction of the Grassmannian codebooks, e.g.,
the projection two-norm, the Fubini-Study distance or the chordal distance [6]. The
corresponding codebooks can be represented by sets of semi-unitary matrices, i.e.,
orthonormal bases, spanning the ℓ-dimensional subspaces. Notice that this approach
can also be interpreted as a high SNR approximation of direct channel quantization.
At high SNR it is known that the water-ﬁlling power allocation converges to equal
power allocation over all spatial modes [30]. Therefore, quantization of the left singu-
lar matrix only is sufﬁcient, which can be efﬁciently achieved using a Grassmannian
codebook. Alternative codebook designs are based on vector quantization [31], dis-
crete Fourier-transform matrices [32], QAM [33] and other concepts [34].
Motivated by the gains promised by these investigations, codebook based precod-
ing has been implemented in commercial cellular technology, e.g., in LTE’s Closed
Loop Spatial Multiplexing (CLSM) transmission mode [35]. Hence, the precoder
codebook employed for SU-MIMO transmission is assumed as given. Speciﬁcally,
the precoder codebook for the transmission of ℓstreams over NT[i] transmit antennas,
consisting of semi-unitary precoders, is denoted

92
M. Rupp et al.
Q(NT[i])
ℓ
⊂

Q ∈CNT[i]×ℓQHQ = Iℓ

.
(5.8)
Such precoder codebooks are deﬁned for all possible numbers of data streams
ℓ∈{1, . . . , NT[i]}. Assuming that precoder Qn,k[u, i] ∈Q(NT[i])
ℓk[u,i] is selected as the
preferred precoder of user u on RE [n, k], the precoder applied for transmission in
cell i is
Fn,k[u, i] =

Pi
ℓk[u, i]Qn,k[u, i],
(5.9)
accounting for the power constraint Pi of the base station. The power is equally
distributed over all ℓk[u, i] spatial streams. Power allocation among spatial streams
is restricted to an on-off switching of spatial modes, by selecting the preferred trans-
mission rank ℓk[u, i]. Hence, the continuous trade-off between MIMO beamforming
and spatial multiplexing, which is achieved with the water-ﬁlling power allocation
employed with SVD based precoding, is coarsely approximated in this case. The
capacity loss of SU-MIMO with limited feedback is known to decrease exponen-
tially in the number of feedback bits b [29]. The number of feedback bits b is related
to the codebook size as
b = log2

Q(NT[i])
ℓ

, Q(NT[i])
ℓ
=
Q(NT[i])
ℓ
 .
(5.10)
To separate the spatial data streams at the receiver, a linear equalizer ﬁlter
Gn,k[u, i] is employed. Speciﬁcally, in the presented simulations Zero Forcing (ZF)
and Minimum Mean Square Error (MMSE) equalization are considered, with the
corresponding receive ﬁltering matrices
G(ZF)
n,k [u, i] =

(Hn,k[u, i]Fn,k[u, i])HHn,k[u, i]Fn,k[u, i]
−1(Hn,k[u, i]Fn,k[u, i])H,
(5.11)
G(MMSE)
n,k
[u, i] =

(Hn,k[u, i]Fn,k[u, i])HHn,k[u, i]Fn,k[u, i] + P˜zIℓk[u,i]
−1
× (Hn,k[u, i]Fn,k[u, i])H.
(5.12)
In the presented simulations, the precoder codebooks proposed in the LTE spec-
iﬁcation [22] are employed. Instead of applying maximally spaced Grassmannian
subspace packings, these codebooks are designed having computational and imple-
mentation complexity in mind, e.g., by minimizing the amount of complex multipli-
cations involved in precoding or by changing only the phase of the transmit signal
and not its amplitude, reducing the requirements posed on ampliﬁer linearity [36]. In
case of two transmit antennas, only seven possible precoders are deﬁned by the LTE
standard. With four and eight transmit antennas, 64 and 621 precoders are supported,
respectively [22]. Other transmit antenna conﬁgurations are currently not considered
by the standard.

5
Single User MIMO LTE Transmission with Quantized Feedback
93
5.2
Implicit CSI Feedback Algorithms
The aim of the CSI feedback selection algorithms proposed in this section is to
maximize the instantaneous user throughput, given the CSI available at the receiver
as obtained from channel estimation using, e.g., training symbols [37]. Naturally,
instantaneous CSI feedback is reasonable only if the current channel estimate at the
receiver, employed for calculating the feedback, is representative for the time when
the feedback is utilized to adapt the data transmission. Hence, the delay experienced
in the feedback path must be sufﬁciently small compared to the coherence time of
the channel to ensure similar channel conditions; see Sect.5.3 for a more detailed
investigation on the impact of a feedback delay on the proposed algorithms. If this
cannot be guaranteed, statistical (or long-term) CSI feedback should be employed
instead, as proposed, e.g., in [38].
5.2.1
Feedback Clustering
Before going into the details of the proposed feedback selection algorithms, some
useful notation is introduced in this section to capture the concept of feedback clus-
tering. As mentioned above, feedback clustering is a technique for reducing the CSI
feedback overhead, by exploiting the correlation of the wireless channel in the time-
frequency domain. With feedback clustering, the optimal CSI feedback is determined
not for each RE individually, but for a set of consecutive time instants and subcarriers.
The intuition behind this approach is that the best precoder stays constant over a spe-
ciﬁc time-frequency interval, due to the restricted size of the precoder codebook
Q(NT[i])
ℓ
and the correlation of the channel. Therefore, the size of this interval is
determined by the coherence time and bandwidth of the channel, but also by the
size of the codebook; see [39] for an overview of different clustering approaches for
precoder feedback. Similarly, due to the restricted set of supported MCSs, the achiev-
able transmission rate does not change arbitrarily fast. But even if this assumption
is not fulﬁlled and signiﬁcant variations of the channel occur over the cluster size,
optimal feedback indicators can still be determined using appropriate averaging as
explained in Sect.5.2.2, though for the price of a reduced throughput as investigated
in Sect.5.3.3.
The idea of clustering is illustrated in Fig.5.3. This ﬁgure shows the time-
frequency resource grid spanned by the OFDM subcarriers and symbols. The pair
[n, k] of subcarrier index and symbol-time index is denoted as RE, as already intro-
duced before. With clustering, a set of N ( f )
clust subcarriers and N (t)
clust time instants is
combined to a so called RB.1 The number of REs per cluster is NRE = N ( f )
clustN (t)
clust.
1Notice the slight abuse of LTE notation; the RBs considered can have variable size, while those of
LTE consist of exactly 12 subcarriers and 7 OFDM symbols.

94
M. Rupp et al.
Fig. 5.3 OFDM time-frequency resource grid and clustering of REs into RBs
The time axis is divided into slots by the time domain clustering. The feedback is
calculated for each slot κ individually. Similarly, the frequency axis is divided into
clusters by the frequency domain clustering. A speciﬁc RB is indexed with the pair
[η, κ] of cluster index and slot index. The number of RBs per time slot is NRB =
Ntot
N ( f )
clust ,
with Ntot denoting the total number of subcarriers. To index the REs of a speciﬁc RB
[η, κ], the single RB speciﬁc RE index ρ ∈{1, . . . , NRE} is employed, which relates
to the index pair [n, k] as
k = (κ −1)N (t)
clust +

ρ
N ( f )
clust

, n = (η −1)N ( f )
clust + ρ −(k −1)N ( f )
clust,
(5.13)
η =

n
N ( f )
clust

, κ =

k
N (t)
clust

,
(5.14)
ρ =

n −N ( f )
clust(η −1)

+

k −N (t)
clust(κ −1) −1

N ( f )
clust.
(5.15)
This is equivalent to indexing the REs within an RB along subcarriers one time
instant after the other, as illustrated in Fig.5.3.
With clustering, the same precoder is applied for all REs within an RB. Hence,
the RB index η, κ is employed in that case to index the precoders instead of the

5
Single User MIMO LTE Transmission with Quantized Feedback
95
RE index n, k, i.e., Qn,k[u, i] is replaced with Qη,κ[u, i]. Similarly, the transmission
rank is indexed with the time slot index κ instead of the OFDM symbol index k, i.e.,
ℓκ[u, i].
5.2.2
Feedback Selection Algorithm
With the support of AMC and codebook based precoding with a variable transmis-
sion rank, the assumed transceiver architecture is able to adapt the parameters of the
SU-MIMO transmission to the current channel conditions such as to maximize
the MIMO gain and to ensure a reliable data transmission. This is achieved with
the provision of CSIT for each time slot κ using the following three feedback indi-
cators: Channel Quality Indicator (CQI)
• The preferred MCSs mη,κ[u, i] ∈M Cℓ, ∀η ∈{1, . . . , NRB} are signaled with the
CQIs. The set of supported MCSs of the considered technology is denoted M . As
the MCS determines the spectral efﬁciency of the data transmission, the CQI is
equivalent to the achievable transmission rate over RBη,κ. RB and codeword spe-
ciﬁc CQI feedback is considered to enable exploitation of the multi-user diversity
during scheduling.
• The preferred transmission rank ℓκ[u, i] is signaled with the Rank Indicator (RI).
With rank adaptive transmission, a trade-off between the SNR gain provided by
beamforming and the spatial multiplexing gain of the MIMO system is enabled,
adjusting the transmission to the current SINR experienced by a user.
• The Precoding Matrix Indicator (PMI) is employed for MIMO precoding, select-
ing the favored precoders Qη,κ[u, i], ∀η ∈{1, . . . , NRB} from the quantization
codebooks Q(NT[i])
ℓ
, ℓ∈{1, . . . , ℓmax}. The maximum number of spatial streams
is ℓmax = min (NT[i], NR[u, i]).
The selection of the preferred feedback indicators is based on maximizing the
achievable throughput. Due to the ﬁnite block-length of the codewords cκ[u, i] ∈
{1, . . . , Cℓκ[u,i]]} and other imperfections of the channel code, a vanishing BLER is
in general not achieved. The system is rather designed to operate below a target BLER
P(t)
b
that is commonly determined by the application driving the data transmission.
This target BLER is considered in the proposed feedback selection algorithm as an
implicit constraint of the optimization problem.
In the following, feedback clustering with a cluster size of N ( f )
clust in the frequency
domain and N (t)
clust in the time domain is assumed. The same cluster size is applied
for CQI and PMI feedback to simplify the exposition, although different cluster
sizes can be accommodated with an extended notation; see [18]. The RI is a wide
band feedback value that is valid for all REs of a time slot κ. The CSI feedback is
determined for each slot κ individually; hence, κ is assumed as ﬁxed in the following.

96
M. Rupp et al.
Assuming that precoder Qη ∈Q(NT[i])
ℓ
is employed during transmission on RBη,κ,
the post-equalization SINR of data stream ν ∈{1, . . . , ℓ} on REn,k equals
βn,k[ν, u, i] =
Pi
ℓ
gn,k[ν, u, i]HHn,k[u, i]Hqη[ν]

2
Pi
ℓ
ℓ
μ=1,μ̸=ν
gn,k[ν, u, i]HHn,k[u, i]Hqη[μ]
2 + P˜z


gn,k[ν, u, i]


2 ,
(5.16)
with gn,k[ν, u, i] =

Gn,k[u, i]H
:,ν, qη[ν] =

Qη

:,ν and P˜z from Eq.(5.6). Due to
SU-MIMO transmission, the in-cell interference term of the more general instanta-
neous SINR deﬁned in (1.44) does not appear in Eq.(5.16). Also, the semi-unitary
precoder Q is employed in (5.16) instead of its scaled version F from (5.9) as
in Eq.(1.44), to express the dependency of the SINR on the precoder codebook
more clearly.
In order to determine the achievable transmission rate over an RB comprising NRE
REs, Mutual Information Effective Signal to Interference and Noise Ratio Mapping
(MIESM) is employed in this work to average the corresponding post-equalization
SINRs [40]. The idea of MIESM is to identify the time-frequency selective channel
experienced over the NRE REs, with an AWGN channel that achieves the same
average spectral efﬁciency in terms of the BICM capacity. Assuming transmission
with MCS mη ∈M on RBη,κ, this is achieved with the following averaging function
β
(mη)
η,κ [ν, u, i] = B−1
mη
⎛
⎝1
NRE
NRE
	
ρ=1
Bmη

βρ[ν, u, i]

⎞
⎠,
(5.17)
where the absolute RE index n, k has been replaced with the implicit RB speciﬁc RE
index ρ using Eq.(5.15). In Eq.(5.17), the function Bmη(β) is deﬁned as
Bmη(β) = BAmη
 β
φmη

,
(5.18)
with BAmη (β) denoting the BICM capacity of the modulation alphabet Amη ∈A that
is associated with the MCS mη. The scalar φmη is employed for calibration purposes,
to adapt the MIESM averaging to the performance of the different MCSs. The inverse
of the bijective function Bmη(β) is denoted B−1
mη (·).
The RB speciﬁc AWGN equivalent effective SNR β
(mη)
η,κ [ν, u, i] is dependent on
the spatial stream index ν. As mentioned in Sect.5.1.1, in LTE the data of multiple
spatial streams can be jointly coded, that is, a codeword c ∈{1, . . . , Cℓ} is mapped
onto several streams ν ∈{1, . . . , ℓ}. If this is the case, it is sufﬁcient to provide CQI
feedback for each codeword only, instead of for each stream. To accommodate this
case, MIESM averaging is applied to determine the average SNR not only over REs,
but also over spatial streams. Denoting the set of spatial streams associated with
codeword c as Lc ⊆{1, . . . , ℓ}, the codeword dependent effective SNR is deﬁned as

5
Single User MIMO LTE Transmission with Quantized Feedback
97
β
(mη)
c,u,i[η, κ] = B−1
mη
⎛
⎝
1
NRE |Lc|
	
ν∈Lc
NRE
	
ρ=1
Bmη

βν,u,i[ρ]

⎞
⎠.
(5.19)
The AWGN equivalent SNR β
(mη)
η,κ [c, u, i] is employed to estimate the BLER
achieved with MCS mη on RBη,κ, using precomputed AWGN look-up tables that
quantify the performance of the considered technology. For the AWGN BLERs
attained with the MCSs of LTE, which are employed as look-up tables in the sim-
ulations, as well as for details on MIESM, see [15, Appendix E]. Denoting the
relationship between the SNR β of an AWGN channel and the corresponding BLER
of MCS mη as gmη(β), the estimated BLER of codeword c over RBη,κ equals
P
(mη)
η,κ [c, u, i] = gmη

β
(mη)
η,κ [c, u, i]

.
(5.20)
To account for the target BLER P(t)
b , a function hmη(P, P(t)
b ) is deﬁned that outputs
the spectral efﬁciency emη of MCS mη if the BLER P is less than the target BLER
and zero otherwise
hmη(P, P(t)
b ) =

emη, P ≤P(t)
b
0, P > P(t)
b
.
(5.21)
With this function, the spectral efﬁciency of codeword c using MCS mη for the
transmission over RB [η, κ] is estimated as
e
(mη)
c,u,i[η, κ] =

1 −P
(mη)
c,u,i [η, κ]

hmη

P
(mη)
c,u,i [η, κ], P(t)
b

.
(5.22)
In this equation, the success probability of the data transmission is taken into account
in the ﬁrst term, and the achieved spectral efﬁciency in case of successful transmission
is quantiﬁed with the second term. Hence, e
(mη)
c,u,i[η, κ] corresponds to the expected
value of the spectral efﬁciency. Notice though that zero spectral efﬁciency is output
in case that the BLER target is not satisﬁed, preventing these MCSs to be selected
by the optimization problem deﬁned below. The target BLER is hence implicitly
considered as a hard constraint of the optimization problem.
The optimal feedback values at time slot κ are jointly determined from the fol-
lowing optimization problem maximizing the achievable throughput, i.e., the sum
spectral efﬁciency over all RBs and codewords

ℓu,i[κ], Qu,i[η, κ],mu,i[η, κ]

= argmax
ℓ,Q[η],m[η]
NRB
	
η=1
Cℓ
	
c=1
e(mc[η])
c,u,i
[η, κ]
(5.23)
subject to: ℓ≤min (NT[i], NR[u, i]) ,
Q[η] ∈Q(NT[i])
ℓ
, ∀η ∈{1, . . . , NRB}
m[η] =

m1[η], . . . , mCℓ[η]
T ∈M Cℓ, ∀η ∈{1, . . . , NRB} .

98
M. Rupp et al.
In general, a joint optimization over all NRB RBs is required to solve this problem,
because the individual summands of the sum over η are coupled over the transmission
rank ℓ. Only if ℓis ﬁxed, the summands in (5.23) decouple and the optimal precoder
and MCSs for each RB can be determined independently. Based on this observation,
the most efﬁcient way for solving the joint optimization problem (5.23) is
• Fix the transmission rank ℓand solve the decoupled optimization problem for
each η

Q(ℓ)
u,i[η, κ], m(ℓ)
u,i[η, κ], e(ℓ)
u,i[η, κ]

= argmax
Q[η],m[η]
Cℓ
	
c=1
e(mc[η])
c,u,i
[η, κ]
(5.24)
subject to: Q[η] ∈Q(NT[i])
ℓ
,
m[η] ∈M Cℓ.
Here, the optimized efﬁciency on RB [η, κ] when transmitting ℓstreams is denoted
e(ℓ)
u,i[η, κ].
• Maximize the sum of the optimized efﬁciencies with respect to the transmission
rank ℓ
ℓu,i[κ] = argmax
ℓ∈{1,...,ℓmax}
NRB
	
η=1
e(ℓ)
u,i[η, κ],
(5.25)
Qu,i[η, κ] = Q(ℓu,i[κ])
u,i
[η, κ],
mu,i[η, κ] = m(ℓu,i[κ])
u,i
[η, κ].
A closed-form solution of this optimization problem is not possible, because the
variables are conﬁned to pre-speciﬁed codebooks and are hence discrete. As soon
as the optimization problem is solved, the feedback indicators are obtained as the
codebookindicescorrespondingtotheoptimalsolutions,i.e.,thePMIsaretheindices
oftheprecodersQu,i[η, κ]inthecodebookQ(NT[i])
ℓu,i[κ] ,theRIisequaltothetransmission
rank ℓu,i[κ] and the CQIs are determined by the indices of mu,i[η, κ] within M .
5.2.3
Approximate Sequential Solution
The complexity involved in the exhaustive search required to obtain the optimal solu-
tion of Eq.(5.23) may often be too high for practical implementations. For example,
ﬁnding the optimum of only one RB in an LTE compliant system with eight transmit
antennas and four receive antennas already requires a search over almost 10,000
options, which may not be feasible within the strict delay requirements of instanta-
neous CSI feedback.

5
Single User MIMO LTE Transmission with Quantized Feedback
99
To reduce the complexity of the exhaustive search, an approximate sequential
solution is proposed, selecting the precoders independently of the MCSs by employ-
ing a coarser estimation of the achievable throughput. This estimation is obtained
from the BICM capacity. To make the calculation independent of the modulation
alphabet A ∈A and hence of the MCS, the BICM system capacity is deﬁned as the
envelope of the modulation alphabet dependent capacities
B (β) = max
A∈A BA (β) .
(5.26)
The RB speciﬁc estimated achievable throughput using precoder Q[η] ∈Q(NT[i])
ℓ
is
B(Q[η])
u,i
[η, κ] =
ℓ
	
ν=1
NRE
	
ρ=1
B

βν,u,i[ρ]

,
(5.27)
with βν,u,i[ρ] from Eq.(5.16). Maximizing this value with respect to the precoders,
the transmission rank dependent optimal precoders are obtained

Q(ℓ)
u,i[η, κ], B(ℓ)
u,i [η, κ]

=
argmax
Q[η]∈Q
(NT[i])
ℓ
B(Q[η])
u,i
[η, κ],
(5.28)
with B(ℓ)
u,i [η, κ] denoting the transmission rank dependent optimized achievable
throughput. The solutions for the precoders can then be employed as a-priori knowl-
edge in Eq.(5.23) to obtain the corresponding transmission rank and MCSs.
If this is still too complex, the transmission rank ℓcan also be selected indepen-
dently of the MCSs by maximizing the sum of B(ℓ)
u,i [η, κ] over the RBs
ℓu,i[κ] = argmax
ℓ∈{1,...,ℓmax}
NRB
	
η=1
B(ℓ)
u,i [η, κ],
(5.29)
Qu,i[η, κ] = Q(ℓu,i[κ])
u,i
[η, κ].
Utilizing these solutions as a-priori knowledge in Eq.(5.23) the corresponding MCSs
are obtained. The optimization of the MCSs cannot be further simpliﬁed to ensure
that the upper bound on the BLER speciﬁed by P(t)
b
is satisﬁed.
The most expensive step involved in solving these optimization problems is the
calculation of the post-equalization SINR in (5.16) for every precoder, because it
involves matrix inversions to determine the equalizer Gn,k[u, i]. This can be avoided
by employing the pre-equalization mutual information achieved with Gaussian sig-
naling to estimate the achievable throughput according to [41]
Iu,i[n, k] = log2 det

INR[u,i] + Pi
˜σ 2z ℓHn,k[u, i]Q[η]Q[η]HHn,k[u, i]H

.
(5.30)

100
M. Rupp et al.
Replacing ℓ
ν=1 B

βν,u,i[ρ]

in Eq.(5.27) with Iu,i[n, k], the same optimization
steps as in Eqs.(5.28) and (5.29) can again be performed to calculate suboptimal
solutions for the precoders and the transmission rank. Then, the post-equalization
SINR hast to be calculated only once, for the optimization of the MCSs. The precoder
selection based on the mutual information is also proposed in [6]. The performance
of the different methods is compared in Sect.5.3.2.
5.2.4
Antenna Subset Selection for DASs
The available transmit power Pi of cell i is distributed uniformly over all NT[i]
transmit antennas by the precoders of the considered semi-unitary codebook (5.8). In
case of distributed transmit antennas, when pathloss differences between the Remote
Radio Units (RRUs) become signiﬁcant, it is beneﬁcial to concentrate the transmit
power on those antenna arrays that experience good channel quality, thus employing
only a subset of the antennas for transmission. To transmit the data from ˜Ni ≤NT[i]
antennas, the reduced size codebook Q( ˜Ni)
ℓ
is employed to distribute the signal onto
the ˜Ni activated antennas, while the other antenna elements are deactivated.
The preferred antenna subset can be determined by solving the optimization prob-
lem (5.23) for all possible antenna subset choices, amounting in
NT[i]
	
˜Ni=1
NT[i]
˜Ni

= 2NT[i] −1
(5.31)
possibilities and thus in an additional feedback overhead of roughly NT[i] bits.
To enable efﬁcient transmit antenna subset selection, with minimal extra CSI
feedback overhead, it is assumed that the macroscopic in-cell channel gains with
respect to all distributed antenna arrays are known by both, the base station and the
user. This is a reasonable, often made assumption in DASs, because the large-scale
statistics change only very slowly over time and frequency, and can thus be learned
either from the uplink [42], provided the duplex distance is not too large, or via a very
low rate feedback link (e.g., during connection setup). The CSI feedback overhead
can then be reduced by considering only the antenna subsets with the largest channel
gains as possible candidates for antenna subset selection. Thus, e.g., if ˜Ni = 4, the
optimization problem (5.23) is only solved for the four strongest distributed antennas,
reducing the additional CSI feedback overhead to log2 (NT[i]) bits.
As an alternative to antenna subset selection, power loading over transmit anten-
nas can be employed [43], which requires accurate knowledge of the instantaneous
channel gain at the transmitter, thus increasing the CSI feedback overhead signiﬁ-
cantly.

5
Single User MIMO LTE Transmission with Quantized Feedback
101
5.3
Performance Investigation
In this section, the performance of the proposed CSI feedback selection algorithms
is investigated by means of Monte-Carlo simulations. Due to the involved non-
linear functions (MIESM, BICM capacity) and the discrete nature of the proposed
optimization problem, an analytic performance investigation was not successful.
Instead, the theoretical throughput bounds developed in [15, Appendix D] are applied
to evaluate the performance of LTE using the proposed CSI feedback algorithms,
and to identify the dominant sources of the observed throughput loss with respect
to the Shannon capacity. In Sect.5.3.2, the performance of the individual feedback
indicators, i.e., the RI, CQI and PMI, is scrutinized and the impact of a delay in the
feedback path is evaluated. Finally, in Sect.5.3.3, the impact of the CSI feedback
granularity applied with feedback clustering on the achieved throughput is examined.
The simulations presented here are mostly obtained with the Vienna Long
Term Evolution-Advanced (LTE-A) link level simulator [26, 44]. This open source
MATLAB based LTE compliant link level simulator is publicly available for down-
load, pursuing the goal of facilitating reproducibility in wireless communications
research.Thelinklevelsimulatorisaugmentedwithasystemlevelsimulatorenabling
the simulation of large cellular networks with reasonable complexity. The results are
presented in dependence of the equivalent average transmit SNR deﬁned as
SNR = Pi
σ 2z
= Ei
N0
,
(5.32)
with Ei denoting the symbol energy and N0 being the noise power spectral
density.
Centralized antenna systems, without RRUs, are studied in the simulations pre-
sented in this section. Pathloss and shadow fading are not considered, the instan-
taneous SNR observed by a user is rather determined by the microscopic channel
fading realization and the variance of the receiver noise. In case of multi-user sim-
ulations, the average SNR of all users is equal. A block fading channel model is
assumed with a temporally constant channel for the duration of one LTE Transmis-
sion Time Interval (TTI), denoted as subframe (1 ms or 14OFDM symbols). The
channel realizations of consecutive subframes are either statistically independent or
correlated according to Clarke’s model. CSI feedback is provided for each TTI. In
most simulations a feedback delay of zero is assumed, meaning that the CSIT is
acausally available before the transmission. The impact of a feedback delay is sep-
arately investigated. Proportional fair multi-user scheduling is applied [45] utilizing
the LTE optimized scheduling framework of [46]. Important simulation parameters
are summarized in Table5.1. Notice, parameter sets are speciﬁed by curly brackets
{·}; intervals are deﬁned by square brackets [·].

102
M. Rupp et al.
Table 5.1 Simulation parameters of the SUMIMO performance investigation
Parameter
Value
Carrier bandwidth
{1.4, 10} MHz
Carrier frequency
fc = 2 GHz
Signal to noise ratio
SNR ∈[−10, 40] dB
Number of subcarriers
Ntot ∈{72, 600}
Channel models
Power delay proﬁle based:
VehicularA, pedestrianB [47]
Typical urban [48]
Number of receive antennas
NR[u, i] ∈{4, 8}
Number of transmit antennas
NT[i] ∈{4, 8}
Number of users
Ui ∈{1, 2, 4, . . . , 64}
Spatial correlation parameter
αcorr ∈{0, 0.9}
Maximum channel doppler frequency
fd ∈[10, 500] Hz
CSI feedback delay
τd ∈[0, 8] TTIs
Multi-user scheduling
Proportional fair
MIMO receiver
ZF
5.3.1
Comparison of LTE to Theoretical Throughput Bounds
In this section, a single user scenario employing the largest LTE compliant antenna
conﬁguration of NT[i] = 8 transmit antennas and NR[u, i] = 8 receive antennas is
assumed, transmitting over a bandwidth of 1.4 MHz (72 subcarriers). The spatial cor-
relation parameter of the receive antenna array is optimistically assumed as αcorr = 0.
The performance of LTE’s CLSM transmission mode, utilizing PMI, RI and CQI
feedback, is compared to the throughput bounds derived in [15, Appendix D]. CSI
feedback clustering is applied with N (t)
clust = 14 and N ( f )
clust = 12. The performance
with perfect and estimated channel knowledge at the receiver is simulated, employ-
ing a least-squares channel estimator [37]. The additional noise caused by the channel
estimator has to be considered in the post-equalization SINR βν,u,i[n, k] used for the
calculation of the feedback indicators to ensure an accurate CQI estimation [17].
This is achieved by employing the ﬁrst-order Taylor approximation proposed in [49]
together with the analytic expression of the channel estimation error variance of the
least-squares channel estimator derived in [50].
The results of the investigation are shown in Fig.5.4 in terms of the absolute
throughput and the relative throughput with respect to channel capacity. As detailed
in [15, Appendix D], the proposed throughput upper bounds shown in the ﬁgure
account for the throughput loss due to the system overhead for guard bands and
reference symbols (achievable capacity), the restriction to codebook based precod-
ing (Closed Loop Mutual Information (CLMI)), the application of a linear receiver
(Closed Loop Mutual Information with Linear Receiver (CLMI LR)) and the BICM

5
Single User MIMO LTE Transmission with Quantized Feedback
103
Fig. 5.4 Comparison of the
achieved throughput to
channel capacity and the
proposed throughput bounds
with NT[i] × NR[u, i] =
8 × 8. a Absolute
throughput. b Relative
throughput
1
0
2
5
2
0
3
5
-
0
5
0
1
5
40
36
32
28
24
20
16
12
8
4
0
SNR [dB]
Throughput [Mbit/s]
capacity
capacity excl. 
guard bands
achiev. capacity
CLMI LR
BICM LR
feedback method
simulated optimum
feedback method with LS channel est.
CLMI 
1
0
2
5
2
0
3
5
-
0
5
0
1
5
80
70
60
50
40
30
20
10
0
SNR [dB]
Relative throughput [%]
feedback method with LS channel est.
feedback method
simulated optimum
CLMI 
CLMI LR
BICM LR
capacity excl. 
guard bands
achiev. capacity
(a)
(b)
architecture (Bit Interleaved Coded Modulation with Linear Receiver (BICM LR)).
It can be seen in Fig.5.4b that each of these factors entails a throughput loss in
the order of 10–20% of channel capacity, amounting in an achievable throughput
of approximately 35–45% of channel capacity (BICMLR). The simulated optimum
performance of LTE with perfect channel knowledge at the receiver, obtained by
exhaustive search, is found another 3–7% below the BICM LR bound. With the
proposed feedback selection algorithms close to optimal performance is attained
(feedback method). The loss of approximately 1 % can be explained by the non-zero
BLER achieved with the proposed CQI selection. With imperfect channel knowl-
edge at the receiver a further throughput reduction to 20–30% of channel capacity
is experienced (feedback method with LS channel est.).
Notice that the performance of LTE is pessimistically represented in these results
due to some assumptions of the simulation. With all other LTE compliant carrier

104
M. Rupp et al.
bandwidths (3/5/10/20MHz), the guard band overhead is reduced from 23 to 10%.
The bandwidth of 1.4 MHz was chosen for complexity reasons to be able to determine
the optimal performance of LTE with an exhaustive search. The channel estimator
performance can be improved, e.g., by means of linear MMSE channel estimation
providing close to perfect performance [37]. Also, signiﬁcantly improved MIMO
detection is possible, e.g., with successive interference cancellation [8]. Still, it is
questionable whether such highly complex algorithms are feasible in practice in the
near future, particularly in mobile phones.
5.3.2
Evaluation of the Feedback Algorithms
The performance of the individual feedback indicators is evaluated in the following
in more detail. In the ﬁrst scenario, an NT[i] × NR[u, i] = 4 × 4 antenna conﬁgu-
ration is investigated assuming strongly correlated receive antennas, i.e., αcorr = 0.9
in Eq.(5.33). The correlation matrices are generated according to the 3rd Generation
Partnership Project (3GPP) document [51, Appendix B.2.3] assuming uniform linear
arrays; e.g., the user-side correlation matrices for two and four receive antennas are
RRX =
 1
αcorr
αcorr
1

, RRX =
⎡
⎢⎢⎢⎢⎢⎢⎣
1
α
1
9corr α
4
9corr αcorr
α
1
9corr
1
α
1
9corr α
4
9corr
α
4
9corr α
1
9corr
1
α
1
9corr
αcorr α
4
9corr α
1
9corr
1
⎤
⎥⎥⎥⎥⎥⎥⎦
,
(5.33)
with αcorr ∈[0, 1] determining the strength of the correlation.
Other simulation parameters are set as in the previous section considering perfect
channel estimation at the receiver. The corresponding throughput versus SNR is
shown in Fig.5.5a, comparing the performance of ﬁxed rank transmission (ℓu,i ∈
{1, 2, 3, 4}) to rank adaptation by means of the proposed joint feedback selection
algorithm of Eq.(5.23). These results show that the proposed feedback selection
algorithm is able to determine the optimal transmission rank in dependency of the
channel conditions, and automatically trades-off the MIMO beamforming gain for
the MIMO multiplexing gain to achieve the best performance. The corresponding
BLER of the two codewords is shown in Fig.5.5b demonstrating that the target BLER
P(t)
b
= 0.1 is observed by the proposed CQI selection. Due to the limited set of only
15MCSs supported in LTE the achieved BLER is markedly below the constraint
P(t)
b
= 0.1. Notice that the second codeword is activated just in case ℓu,i ≥2; hence
the BLER curve starts only at 14 dB SNR.
The same scenario is considered in the results presented in Fig.5.6a to investigate
the performance of the approximate sequential solutions(5.28) and (5.29) of the joint
CSI feedback selection problem(5.23). The ﬁgure shows that the best performance is

5
Single User MIMO LTE Transmission with Quantized Feedback
105
Fig. 5.5 Comparison of the
proposed rank adaptive
scheme to ﬁxed rank
transmission and simulated
BLER achieved with the
proposed feedback
algorithms. a Rank
adaptation versus ﬁxed rank
transmission. b BLER
achieved with the proposed
feedback algorithms
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
16
14
12
10
8
6
4
2
0
SNR [dB]
Throughput [Mbit/s]
rank adaptive
rank 4
rank 3
rank 2
rank 1
40
1
0
2
5
2
0
3
0
1
-
5
-
0
5
0
1
5
35
100
10-1
10-2
10-3
SNR [dB]
Block error ratio
BLER codeword 1
BLER codeword 2
(a)
(b)
achieved with the accurate rate estimation considered in the joint selection algorithm.
If the PMI and RI are selected from the BICM capacity as in Sect.5.2.3 almost equally
good performance is achieved, with a complexity that is approximately a factor of
ten below the joint selection in case of LTE. Similar throughput is attained if the
pre-equalization mutual information of Eq.(5.30) is employed instead of the BICM
capacity for the PMI selection to avoid the calculation of the post-equalization SINR.
Notice though that the RI selection based on the pre-equalization mutual information
leads to a signiﬁcant throughput reduction, because the performance of higher rank
transmission is obviously overestimated. For comparison the achieved transmission
rate with random precoder selection is also shown in Fig.5.6a. It can be seen that a
gain of approximately 5–10dB in SNR is obtained with optimal precoder selection.
Similar behavior is observed in Fig.5.6b for the case of eight transmit antennas.
Notice that the LTE precoder codebook for eight antennas is four times larger than
the four antenna codebook.

106
M. Rupp et al.
Fig. 5.6 Performance of
approximate sequential CSI
feedback selection schemes
compared to the joint
optimization. a
Ni × Mu,i = 4 × 4. b
Ni × Mu,i = 8 × 4
15
20
5
2
30
35
40
-10
-5
0
5
10
16
14
12
10
8
6
4
2
0
SNR [dB]
Throughput [Mbit/s]
joint selection
PMI, RI mutual information
PMI mutual information
PMI random
PMI, RI BICM 
15
20
25
0
3
5
3
0
4
-10
-5
0
5
10
18
16
14
12
10
8
6
4
2
0
SNR [dB]
Throughput [Mbit/s]
joint selection
PMI, RI mutual information
PMI mutual information
PMI random
PMI, RI BICM
(a)
(b)
Next, the impact of a delay in the feedback path on the transmission rate obtained
with the proposed instantaneous CSI feedback algorithms is investigated. Again,
the NT[i] × NR[u, i] = 4 × 4 conﬁguration is assumed, this time with uncorrelated
receive antennas, i.e., αcorr = 0. The effect of the feedback delay is determined by the
strength of the temporal correlation of the wireless channel. Hence, the performance
of the system is evaluated in terms of the maximum channel Doppler frequency fd,
deﬁning the channel coherence time according to Eq.(5.34). The 50 % coherence
time of the channel, assuming Clarke’s model [52], is deﬁned as [53]
TC =
9
16π fd
,
(5.34)

5
Single User MIMO LTE Transmission with Quantized Feedback
107
where fd is the maximum channel Doppler frequency. The results are plotted in
dependency of the normalized channel Doppler frequency
νd = fd Ts,
(5.35)
with Ts = 1 ms being the temporal sampling rate of the channel, i.e., the CSI feedback
interval. The throughput degradation due to the feedback delay is shown in Fig.5.7a.
With a delay of 1 TTI, i.e., τd = 1 ms, optimal performance is achieved up to a
normalized Doppler frequency of ν(c)
d
= 0.025, corresponding to a user speed of
v = ν(c)
d
Ts fc
c ≈15 km/h,
(5.36)
Fig. 5.7 Sensitivity of the
proposed instantaneous CSI
feedback algorithms with
respect to a delay in the
feedback path. a Throughput
versus channel Doppler
frequency. b Block error
ratio versus channel Doppler
frequency
12
11
10
9
8
7
6
5
4
0.5
10-1
10-2
Normalized Doppler frequency
Throughput [Mbit/s]
RLS prediction
no prediction
delay 1
delay 2
delay 4
delay 1
delay 4
delay 8
100
10-1
10-2
0.5
10-1
10-2
Normalized Doppler frequency
Block error ratio
RLS prediction
no prediction
delay 1
delay 2
delay 4
delay 1
delay 4
delay 8
(a)
(b)

108
M. Rupp et al.
with fc = 2 GHz denoting the carrier frequency and c being the speed of light.
With τd = 4 ms a further reduction to 5 km/h is incurred. Hence, without any delay-
compensation, the proposed algorithms are suitable for quasi-stationary situations.
The reason for the performance degradation can be seen in Fig.5.7b. Due to the
mismatch between the channel observed during CSI feedback calculation and the
channel for which the outdated CSIT is employed for rate adaptation, the BLER is
severely increased and the target BLER is not satisﬁed. A simple means to overcome
this problem is the inclusion of an adaptive link margin to account for the channel
mismatch [54].
Alternatively, channel prediction can be employed to compensate for the feed-
back delay. To demonstrate the capabilities of this approach, Finite Impulse Response
(FIR) ﬁlter based channel prediction is implemented. For simplicity, each column
of the channel matrix Hn,k[u, i] is independently predicted. Also, each RB [η, κ] is
represented by the single channel matrix in the center of the RB for CSI feedback
calculation, utilizing the channel sub sampling approach of [16]. The FIR ﬁlter coef-
ﬁcients are trained by means of the Recursive Least Squares (RLS) algorithm [55].
The corresponding results, labeled with RLS prediction, are shown in Fig.5.7. The
delay sensitivity is signiﬁcantly reduced with channel prediction, enabling optimal
performance up to user speeds of 100 and 40 km/h at delays of 1TTI and 8TTIs,
respectively. Interestingly, the throughput reduction at high Doppler frequencies is
not caused by an increased BLER. It is rather a consequence of the reduction of
the gain of the predicted channel matrix, due to diminishing magnitudes of the FIR
ﬁlter coefﬁcients with decreasing channel correlation. Hence, the SINR is automat-
ically reduced with decreasing channel correlation, entailing a more conservative
CQI estimation.
5.3.3
Impact of CSI Feedback Granularity
The SU-MIMO CSI feedback indicators investigated in this chapter can be exploited
in a twofold way to improve the downlink data rate of cellular networks. Firstly, the
single user throughput is increased through the optimized selection of the precoders,
transmissionrankandMCSsenabledbytheproposedfeedbackselectionalgorithmof
Eq.(5.23). Secondly, the CQI feedback is useful in multi-user scheduling to achieve
a multi-user diversity gain and hence to improve the sum data rate in a multi-user
scenario [46, 56]. In both cases, the potential gain is larger with a smaller CSI
feedback cluster size. The downside of reducing the cluster size is an increase in the
CSI feedback overhead. This trade-off is investigated below by means of a simulation
based study.
In the ﬁrst scenario the improvement of the single user throughput with reducing
PMI feedback cluster size and with increasing precoder codebook size is evaluated.
To enable a variable precoder codebook size, which is not considered in LTE, a
random codebook of independent and isotropically distributed semi-unitary matrices
is generated [57]. Such random codebooks are known to be asymptotically optimal

5
Single User MIMO LTE Transmission with Quantized Feedback
109
in the case of Identically Distributed (I.I.D.) channel matrices; hence αcorr is set equal
to zero. The results are averaged over random codebook realizations. An NT[i] ×
NR[u, i] = 8 × 1 antenna conﬁguration is considered. The typical urban channel
model [48] is employed, having a 50 % coherence bandwidth of BC = 400 kHz. A
carrier bandwidth of 10 MHz is assumed. The precoder codebook size is varied from
one element to 212 elements corresponding to a feedback overhead of 0–12bits per
cluster. The number of feedback clusters per TTI is varied from 1–50. The results of
the simulation are shown in Fig.5.8a. A signiﬁcant throughput improvement from
14 Mbit/s without precoder feedback to 34 Mbit/s with a feedback overhead of 12 ·
50bit/ms = 600 kbit/s is obtained. Such investigations are also useful to determine
the optimal trade-off between cluster size and codebook size for a ﬁxed amount of
CSI feedback bits. For example, the best performance with 10 bits per TTI is obtained
with a single cluster using a precoder codebook of size 210, amounting in 22 Mbit/s
downlink throughput. On the contrary, with 10 clusters each using a codebook of
Fig. 5.8 Cell throughput
with proportional fair
scheduling versus CSI
feedback granularity,
codebook size and number of
users. a Variation of PMI
feedback granularity and
codebook size. b Variation of
CQI feedback granularity
and user number
Cell throughput [Mbit/s]
Number of feedback clusters
Number of feedback bits
25
20
15
10
5
0
30
35
1
2
5
10
25
50
12
8
6
4
2
1
3
0
25
20
15
10
5
0
Cell throughput [Mbit/s]
1
2
5
10
25
50
32
16
8
4
2
1
64
Number of feedback clusters
Number of users
(a)
(b)

110
M. Rupp et al.
size two only 17 Mbit/s are achieved. Naturally, these results depend on the channel
coherence bandwidth.
In the second scenario the impact of the CQI cluster size on the achievable multi-
user scheduling gain is investigated. A 10 MHz SISO system is assumed to eliminate
the effect of the precoder feedback. The pedestrianB channel model [47] with a
coherencebandwidthof BC = 267 kHzisemployed.ThenumberofusersUi isvaried
from one to 64 and the number of CSI feedback clusters is increased from one to 50.
The simulation results are plotted in Fig.5.8b, visualizing the improvement of the
multi-user gain with an increasing number of feedback clusters. With one feedback
cluster, only temporal multi-user diversity can be exploited, leading to a throughput
improvement by a factor of two when increasing the number of users form one to 64.
With 50 feedback clusters a threefold throughput gain is obtained as the frequency
diversity can additionally be exploited during scheduling. With 64 users the cell
throughput grows by 6 Mbit/s when increasing the number of clusters from one to 50.
Notice though that this downlink improvement is outweighed by the increased CQI
feedback overhead, scaling from 4 · 64bit/ms = 256 kbit/s up to 4 · 64 · 50bit/ms =
12.8 Mbit/s, if 4 bits per CQI are employed as in LTE. Solutions for this problem have
been published, e.g., K-signiﬁcant scheduling [58] and thresholding, i.e., providing
feedback only in case a threshold is exceeded [59].
5.4
Summary
In this chapter, limited feedback SU-MIMO transmission in wireless communica-
tions is investigated. Following the approach that is currently implemented in most
commercial systems, the transmission parameters of the single user link are adapted
by means of AMC and codebook based precoding to ensure reliable and spectrally
efﬁcient data transmission. This is achieved by the provision of CSIT using feed-
back indicators for the selection of the optimal transmission rate, transmission rank
and precoders. The best performance is achieved with instantaneous CSIT enabling
the exploitation of the space, time, frequency and multi-user diversity inherent in
wireless communication systems.
By deriving an accurate estimate of the achievable user data rate, based on the post-
equalization SINR, the optimization problem for the joint-selection of the optimal
CSI feedback indicators is derived in this chapter. The performance of this method is
investigated by means of simulations, demonstrating that close to optimal throughput
is achieved with the proposed algorithm. Several simplifying approximations are
considered to reduce the complexity of the exhaustive search. A promising trade-off
between complexity and performance is obtained by selecting the precoders based on
the pre-equalization mutual information and considering the post-equalization SINR
only for transmission rank and rate adaptation, signiﬁcantly reducing the amount of
matrix inversion.
The sensitivity of instantaneous CSI feedback with respect to a delay in the feed-
back path is investigated. The obtained results show that this kind of feedback is

5
Single User MIMO LTE Transmission with Quantized Feedback
111
restricted to quasi-stationary situations if no delay compensation is incorporated.
The scope of the algorithms can be extended to moderate mobility (∼50km/h) if
delay compensation by means of channel prediction is implemented. The achievable
throughput with limited feedback is strongly dependent on the granularity of the
feedback indicators in the OFDM time-frequency grid, requiring a careful choice of
the feedback parameters to achieve a good trade-off between the uplink overhead
and the downlink throughput.
References
1. A. Paulraj, T. Kailath, Increasing capacity in wireless broadcast systems using distributed
transmission/directional reception (DTDR), U.S. patent 5,345,599, Sept. 1994
2. G.J. Foschini, M.J. Gans, On limits of wireless communications in a fading environment when
using multiple antennas. Wirel. Pers. Commun. 6, 311–335 (1998)
3. L. Zheng, D.N.C. Tse, Diversity and multiplexing: a fundamental tradeoff in multiple antenna
channels. IEEE Trans. Inf. Theory 49, 1073–1096 (2002)
4. A. Paulraj, D. Gore, R. Nabar, H. Bolcskei, An overview of MIMO communications—a key
to Gigabit wireless. Proc. IEEE 92(2), 198–218 (2004)
5. A. Goldsmith, S. Jafar, N. Jindal, S. Vishwanath, Capacity limits of MIMO channels. IEEE J.
Sel. Areas Commun. 21(5), 684–702 (2003)
6. D. Love, R. Heath Jr., Limited feedback unitary precoding for spatial multiplexing systems.
IEEE Trans. Inf. Theory 51(8), 2967–2976 (2005)
7. A.Dabbagh,D.Love,Feedbackrate-capacitylosstradeoffforlimitedfeedbackMIMOsystems.
IEEE Trans. Inf. Theory 52(5), 2190–2202 (2006)
8. D. Tse, P. Viswanath, Fundamentals of Wireless Communication, Wiley series in telecommu-
nications (Cambridge University Press, Cambridge, 2005)
9. T. Pande, D. Love, J. Krogmeier, Reduced feedback MIMO-OFDM precoding and antenna
selection. IEEE Trans. Signal Proc. 55(5), 2284–2293 (2007)
10. J. Choi, R. Heath Jr., Interpolation based transmit beamforming for MIMO-OFDM with limited
feedback. IEEE Trans. Signal Proc. 53(11), 4125–4135 (2005)
11. G. Caire, G. Taricco, E. Biglieri, Capacity of bit-interleaved channels. Electron. Lett. 32(12)
(1996)
12. A. Guillen i Fabregas, A. Martinez, G. Caire, Bit-interleaved coded modulation. Found. Trends
Commun. Inf. Theory 5, 1–153 (2008)
13. S. Caban, C. Mehlführer, M. Rupp, M. Wrulich, Evaluation of HSDPA and LTE: From Testbed
Measurements to System Level Performance (Wiley, UK, 2012)
14. P. Viswanath, Opportunistic communication: a system view, Space-Time Wireless Systems
(Cambridge University Press, Cambridge, 2006), pp. 426–442 (Cambridge Books Online)
15. S.Schwarz,LimitedfeedbacktransceiverdesignfordownlinkMIMOOFDMcellularnetworks,
Ph.D. dissertation, Technische Universität Wien, 2013, http://theses.eurasip.org/theses/514/
limited-feedback-transceiver-design-for-downlink/
16. S. Schwarz, M. Wrulich, M. Rupp, Mutual information based calculation of the precoding
matrix indicator for 3GPP UMTS/LTE, in International ITG Workshop on Smart Antennas
(Bremen, Germany, Feb. 2010) pp. 52–58
17. S. Schwarz, C. Mehlführer, M. Rupp, Calculation of the spatial preprocessing and link adaption
feedback for 3GPP UMTS/LTE, in 6th Conference on Wireless Advanced (London, UK, June
2010) pp. 1–6
18. S. Schwarz, M. Rupp, Throughput maximizing feedback for MIMO OFDM based wireless
communication systems, in IEEE 12th International Workshop on Signal Processing Advances
in Wireless Communications, (San Francisco, CA, June 2011) pp. 316–320

112
M. Rupp et al.
19. S. Schwarz, M. Simko, M. Rupp, On performance bounds for MIMO OFDM based wireless
communication systems, in IEEE 12th International Workshop on Signal Processing Advances
in Wireless Communications, (San Francisco, CA, June 2011) pp. 311–315
20. S. Schwarz, R. Heath Jr., M. Rupp, Single-user MIMO versus multi-user MIMO in distributed
antenna systems with limited feedback. EURASIP J. Adv. Signal Proc. 2013(54), 1–20 (2013)
21. E. Armanious, D. Falconer, H. Yanikomeroglu, Adaptive modulation, adaptive coding, and
power control for ﬁxed cellular broadband wireless systems: some new insights. IEEE Wirel.
Commun. Netw. 1, 238–242 (2003)
22. Technical Speciﬁcation Group RAN, E-UTRA; physical channels and modulation, 3GPP, Tech-
nical Report, TS 36.211 Version 10.0.0 (2010)
23. 3GPP, Technical speciﬁcation group radio access network; evolved universal terrestrial radio
access (E-UTRA); multiplexing and channel coding (release 10), http://www.3gpp.org/ftp/
Specs/html-info/36212.htm (2010)
24. L.-J. Chen, T. Sun, M. Y. Sanadidi, M. Gerla, Improving wireless link throughput via interleaved
FEC, in Proceedings of the 9th International Symposium on Computers and Communications,
(Washington, DC, USA, 2004) pp. 539–544
25. A. Chindapol, J. Ritcey, Design, analysis, and performance evaluation for BICM-ID with square
QAM constellations in Rayleigh fading channels. IEEE J. Sel. Areas Commun. 19(5), 944–957
(2001)
26. C. Mehlführer, J.C. Ikuno, M. Simko, S. Schwarz, M. Rupp, The vienna LTE simulators—
enabling reproducibility in wireless communications research. EURASIP J. Adv. Signal Proc.
Spec. Issue Rep. Res. 2011(29), 1–14 (2011)
27. M. Wrulich, C. Mehlführer, M. Rupp, Managing the interference structure of MIMO HSDPA:
a multi-user interference aware MMSE receiver with moderate complexity. IEEE Trans. Wirel.
Commun. 9(4), 1472–1482 (2010)
28. T. Yucek, H. Arslan, MMSE noise power and SNR estimation for OFDM systems, in IEEE
Sarnoff Symposium (2006) pp. 1–4,
29. J. Zheng, B. Rao, Capacity analysis of MIMO systems using limited feedback transmit pre-
coding schemes. IEEE Trans. Signal Proc. 56(7), 2886–2901 (2008)
30. A. Paulraj, R. Nabar, D. Gore, Introduction to Space-Time Wireless Communications (Cam-
bridge University Press, Cambridge, 2003)
31. J. Roh, B. Rao, Design and analysis of MIMO spatial multiplexing systems with quantized
feedback. IEEE Trans. Signal Proc. 54(8), 2874–2886 (2006)
32. D. Yang, L.-L. Yang, L. Hanzo, DFT-based beamforming weight-vector codebook design for
spatially correlated channels in the unitary precoding aided multiuser downlink, in IEEE Inter-
national Conference on Communications, (Cape Town, South Africa, 2010) pp. 1–5
33. D. Ryan, I. Vaughan, L. Clarkson, I. Collings, D. Guo, M. Honig, QAM codebooks for low-
complexity limited feedback MIMO beamforming, in IEEE International Conference on Com-
munications, (Glasgow, Scotland, 2007) pp. 4162–4167
34. T. Inoue, R. Heath, Jr., Kerdock codes for limited feedback MIMO systems, in IEEE Inter-
national Conference on Acoustics, Speech and Signal Processing, (Las Vegas, NV, 2008) pp.
3113–3116
35. 3GPP, Technical speciﬁcation group radio access network; evolved universal terrestrial radio
access (E-UTRA); physical layer procedures (release 10) (2010). http://www.3gpp.org/ftp/
Specs/html-info/36213.htm
36. S. Sesia, I. Touﬁk, M. Baker, LTE, the UMTS Long Term Evolution: From Theory to Practice,
ser (Wiley InterScience online books, Wiley, 2009)
37. M. Simko, C. Mehlfuhrer, M. Wrulich, M. Rupp, Doubly dispersive channel estimation with
scalable complexity, in International ITG Workshop on Smart Antennas, (Feb. 2010) pp. 251–
256
38. H. Zhang, S. Wei, G. Ananthaswamy, D. Goeckel, Adaptive signaling based on statistical
characterizations of outdated feedback in wireless communications. Proc. IEEE 95(12), 2337–
2353 (2007)

5
Single User MIMO LTE Transmission with Quantized Feedback
113
39. M. Wu, C. Shen, Z. Qiu, Feedback reduction based on clustering in MIMO-OFDM beamform-
ing systems, in 5th International Conference on Wireless Communications, Networking and
Mobile Computing (WiCom) (2009) pp. 1–4
40. L. Wan, S. Tsai, M. Almgren, A fading-insensitive performance metric for a uniﬁed link quality
model. IEEE Wirel. Commun. Netw. Conf. 4, 2110–2114 (2006)
41. Z. Wang, G. Giannakis, Outage mutual information of space-time MIMO channels. IEEE Trans.
Inf. Theory 50(4), 657–662 (2004)
42. M. Jordan, A. Dimofte, X. Gong, G. Ascheid, Conversion from uplink to downlink spatio-
temporal correlation with cubic splines, in IEEE 69th Vehicular Technology Conference, (April
2009) pp. 1–5
43. D. Lim, K. Choi, H. Liu, Optimum power allocation for distributed antenna systems with large-
scale fading-only feedback, in Sixth International Conference on Information Technology (New
Generations) (April 2009)
44. S. Schwarz, J. Ikuno, M. Simko, M. Taranetz, Q. Wang, M. Rupp, Pushing the limits of LTE:
a survey on research enhancing the standard. IEEE Access 1, 51–62 (2013)
45. R. Jain, D. Chiu, W. Hawe, A Quantitative Measure of Fairness and Discrimination for Resource
Allocation in Shared Computer Systems, DEC, Technical Report TR-301, Sept. 1984
46. S. Schwarz, C. Mehlführer, M. Rupp, Low complexity approximate maximum throughput
scheduling for LTE, in Conference Record of the Forty Fourth Asilomar Conference on Signals,
Systems, and Computers, (Paciﬁc Grove, California, Nov. 2010) pp. 1563–1569
47. ITU, Recommendation ITU-R M.1225: Guidelines for Evaluation of Radio Transmission Tech-
nologies for IMT-2000, ITU, Technical Report (1997)
48. 3GPP, Technical speciﬁcation group radio access networks; Deployment aspects (Release 8)
(2008). http://www.3gpp.org/ftp/Specs/html-info/25943.htm
49. T. Weber, A. Sklavos, M. Meurer, Imperfect channel-state information in MIMO transmission.
IEEE Trans. Commun. 54(3), 543–552 (2006)
50. M. Simko, S. Pendl, S. Schwarz, Q. Wang, J. Ikuno, M. Rupp, Optimal pilot symbol power
allocation in LTE, in IEEE 74th Vehicular Technology Conference, (San Francsico, CA, 2011)
pp. 1–5
51. Technical Speciﬁcation Group Radio Access Network, Evolved universal terrestrial radio
access (E-UTRA); user equipment (UE) radio transmission and reception, 3GPP, Technical
Report TS 36.101 Version 8.5.1 (2009)
52. R.H. Clarke, A statistical theory of mobile radio reception. Bell Syst. Tech. J. 47, 957–1000
(1968)
53. T. Rappaport, Wireless Communications: Principles and Practice, (Prentice Hall communica-
tions engineering and emerging technologies series, Dorling Kindersley, 2009)
54. T. Cui, F. Lu, V. Sethuraman, A. Goteti, S. Rao, P. Subrahmanya, Throughput optimization in
high speed downlink packet access (HSDPA). IEEE Trans. Wirel. Commun. 10(2), 474–483
(2011)
55. S. Haykin, Adaptive Filter Theory, 4th edn. (Prentice Hall, Upper Saddle River, 2002)
56. S. Schwarz, C. Mehlführer, M. Rupp, Throughput maximizing multiuser scheduling with
adjustable fairness, inInternational Conference on Communications,( Kyoto, Japan, June 2011)
pp. 1–5
57. N. Ravindran, N. Jindal, Limited feedback-based block diagonalization for the MIMO broad-
cast channel. IEEE J. Sel. Areas Commun. 26(8), 1473–1482 (2008)
58. D. Gesbert, M.-S. Alouini, Selective multi-user diversity, in Proceedings of the 3rd IEEE
International Symposium on Signal Processing and Information Technology (ISSPIT) (2003),
pp. 162–165
59. S. Sanayei, A. Nosratinia, Exploiting multiuser diversity with only 1-bit feedback. IEEE Wirel.
Commun. Netw. Conf. 2, 978–983 (2005)

Chapter 6
Multi User and Multi Cell Simulations
Markus Rupp, Stefan Schwarz and Martin Taranetz
Spatial multiplexing of multiple users, i.e., Multi User Multiple-Input Multiple-
Output (MU-MIMO), is considered as a promising technique in multi-antenna broad-
cast systems to achieve high spectral efﬁciencies by serving multiple users in parallel
over the same time-frequency resources [1, 2]. In contrast to Single User Multiple-
Input Multiple-Output (SU-MIMO), the potential multiplexing gain of MU-MIMO
is only conﬁned by the capabilities of the transmitter. Hence, with MU-MIMO the
need for multiple antennas at the users is eliminated, facilitating the development of
small and cheap user equipments. Another important advantage of MU-MIMO over
SU-MIMO is the reduced sensitivity to channel impairments such as line-of-sight
propagation and antenna correlation, which cause an increase in the singular value
imbalance of the single-user channel and hence effectively limit the transmission
rank of SU-MIMO [3, 4]. Unfortunately, these advantages come at the cost of signif-
icantly increased susceptibility of the achievable multi-user throughput with respect
to the accuracy of the Channel State Information at the Transmitter (CSIT), due to
residual multi-user interference incurred with imperfect channel knowledge [5–8].
The literature on MU-MIMO precoding can be coarsely partitioned into two main
concepts, that is, linear precoding and non-linear precoding. While non-linear tech-
niques based on Tomlinson-Harashima precoding [7] and vector perturbation [8, 9]
provide an advantage in terms of the achievable throughput, linear strategies such
as Zero Forcing (ZF) beamforming [10] and Block Diagonalization (BD) precoding
[11] are considered as practically important for complexity reasons. In addition to
their complexity advantage, ZF and BD precoding have the beneﬁt that partial CSIT,
speciﬁcally channel subspace information, is sufﬁcient for the calculation of the
precoders, reducing the burden on the feedback channel. Notice that BD precoding
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_6
115

116
M. Rupp et al.
can be viewed as a generalization of ZF beamforming to multiple data stream trans-
mission per user; hence in the sequel mostly BD precoding is used to refer to both
methods.
For the reasons mentioned above, MU-MIMO transmission based on BD pre-
coding is investigated. Although codebook based precoding as in SU-MIMO is an
option for MU-MIMO as well [12], the precoders employed with BD precoding
are not conﬁned to a codebook but are calculated during operation from explicit
channel knowledge at the base station. Correspondingly, the implicit Channel State
Information (CSI) feedback of SU-MIMO is replaced with direct quantization of the
channel matrix in MU-MIMO. To this end, memoryless and predictive CSI quanti-
zation algorithms are proposed in this chapter, building upon the concepts of Grass-
mannian quantization [13, 14]. The temporal correlation of the wireless channel can
be exploited by the proposed predictive quantizer to achieve high ﬁdelity quantiza-
tion in low to moderate mobility scenarios, i.e., when the channel coherence time
is large. In case of distributed antennas, knowledge of the channel gain matrix is
utilized during quantization to further improve the accuracy.
Similar to SU-MIMO, Channel Quality Indicator (CQI) feedback is employed in
MU-MIMO as well, for transmission rate adaptation and multi-user scheduling. In
contrast to single-user transmission, the achievable rate with MU-MIMO cannot be
estimated accurately by the users ahead of scheduling due to the unknown precoders.
Exploiting the precoder construction of BD precoding, a lower bound on the expected
Signal to Interference and Noise Ratio (SINR) of a user with imperfect CSIT is
derived, facilitating estimation of the achievable transmission rate. This bound is
proposed as CQI feedback for multi-user scheduling.
In case the number of data streams per user is less than the number of receive
antennas, interference cancellation by means of BD is only achieved over a subspace
of a users’ channel matrix. Ideally, joint user subspace selection and scheduling must
be performed at the transmitter to maximize the achievable throughput, requiring full
channel knowledge for all users at the base station. To reduce the CSI feedback over-
head, it is, however, proposed to perform a pre-selection of the preferred channel
subspace by the users based on selﬁsh arguments, effectively decreasing the dimen-
sionality of the Grassmannian quantization problem. To ﬁlter-out the interference-
free subspace at the users, semi-unitary antenna combiners are employed. It is shown
how the Degrees of Freedom (DoF) provided by the excess antennas can be utilized to
trade-off the residual multi-user interference, due to imperfect CSI, for the effective
channel gain experienced by a user.
The proposed CSI feedback algorithms are extended to frequency selective
Orthogonal Frequency Division Multiplexing (OFDM) systems employing the same
concepts as in SU-MIMO, i.e., by means of CSI feedback clustering and interpola-
tion. The performance of these two methods is evaluated in this chapter using sim-
ulations, with the result that interpolation is only reasonable if the distance between
CSI pilots is small compared to the channel coherence bandwidth, challenging its
value for practical implementations.
This chapter is organized as follows: In Sect.6.1, the ZF beamforming and BD
precoding constructions are introduced, providing the motivation for the proposed

6
Multi User and Multi Cell Simulations
117
Grassmannian quantization algorithms. The memoryless and predictive CSI quan-
tizers are detailed in Sects.6.2.1 and 6.2.2, respectively. In Sect.7.1, the proposed
antenna combiners are derived.
6.1
Zero-Forcing and Block-Diagonalization Precoding
In this section, an overview of ZF and BD precoding is provided and the relevant CSIT
for precoder calculation is identiﬁed. It is shown that channel subspace information
is sufﬁcient if uniform power allocation over spatial streams and users is considered,
which is known to be a asymptotically optimal in the limit of high Signal to Noise
Ratio (SNR) [15]. Although not considered here, optimal power allocation by means
of water-ﬁlling can be facilitated with additional channel magnitude feedback [11].
6.1.1
Transmit Strategy
The input-output relationship of user u in cell i on Resource Element (RE) [n, k],
assuming MU-MIMO transmission and employing the description with conjugate-
transpose channel matrices as introduced in Sect.1.5, is
yn,k[u, i] = H(ect)
n,k [u, i]HFn,k[u, i]xn,k[u, i]
+ H(ect)
n,k [u, i]H

s∈Sn,k[i]
s̸=u
Fn,k[s, i]xn,k[s, i] + G(ct)
n,k [u, i]H ˜zn,k[u, i],
(6.1)
with the effective channel H(ect)
n,k [u, i] ∈CNT[i]×ℓk[u,i] being speciﬁed in Eq.(1.42)
and ˜zn,k[u, i] ∼NC

0, ˜σ 2
z INR[u,i]

, hence the out-of-cell interference is treated as
additional Gaussian noise. To simplify notations, the user set Ui is re-ordered
after scheduling such that the served users Sn,k[i] can be indexed as Sn,k[i] =

1, . . . , Sn,k[i]

. The goal of BD precoding is to calculate the precoders Fn,k[s, i], ∀s
such that the interference at each user due to all other users is perfectly eliminated. BD
was originally proposed for the case that each user is served over ℓk[u, i] = NR[u, i]
streams.ThennoantennacombinerG(ct)
n,k [u, i]isrequiredattheusers.Ifthenumberof
data streams ℓk[u, i] is less than the number of receive antennas NR[u, i], the BD pre-
coder is calculated for the effective channel H(ect)
n,k [u, i]. Hence the multi-user interfer-
ence is only cancelled in the ℓk[u, i]-dimensional subspace of span

H(ct)
n,k [u, i]

that
is spanned by H(ect)
n,k [u, i]. The precoders are obtained from the following conditions
H(ect)
n,k [u, i]HFn,k[s, i] = 0ℓk[u,i]×ℓk[s,i], ∀u, s ∈Sn,k[i] and s ̸= u,
(6.2)
rank

H(ect)
n,k [u, i]HFn,k[u, i]

= ℓk[u, i], ∀u ∈Sn,k[i].
(6.3)

118
M. Rupp et al.
Notice the similarity of this formulation of BD to interference alignment [16, 17],
with the difference that there is only a single transmitter in BD that has access
to the data of all users. When applied for Coordinated Multi-Point (CoMP) trans-
mission, BD is hence classiﬁed as a joint transmission strategy. Certain feasibility
conditions on the number of streams per user and the total number of spatial streams
ℓn,k[i] have to be fulﬁlled to assure that a solution to this problem exists, such as
ℓk[u, i] ≤NR[u, i] and ℓn,k[i] ≤NT[i] [11]. Provided these feasibility conditions
are satisﬁed, the solution is obtained from
Fn,k[u, i] ∈null

Hn,k[u, i]

, rank

Fn,k[u, i]

= ℓk[u, i], ∀u ∈Sn,k[i], (6.4)
Hn,k[u, i] =
	
˜Hn,k[1, i], . . . , ˜Hn,k[u −1, i], ˜Hn,k[u + 1, i], . . . , ˜Hn,k[Sn,k[i], i]

H
,
(6.5)
span

˜Hn,k[s, i]

= span

H(ect)
n,k [s, i]

,
(6.6)
˜Hn,k[s, i]H ˜Hn,k[s, i] = Iℓk[s,i], ˜Hn,k[s, i] ∈CNT[i]×ℓk[s,i], ∀s ∈Sn,k[i].
(6.7)
Here, the matrices ˜Hn,k[s, i] form orthonormal bases for the respective effective
channels H(ect)
n,k [s, i] and can, e.g., be obtained from a QR or a Singular Value Decom-
position (SVD) of H(ect)
n,k [s, i]. The precoder of user u lies in the left null space of
all other users’ effective channels. Hence, after antenna combining, the transmission
to user u does not interfere with the transmission to any of the other users. As the
same holds true for every u ∈Sn,k[i], interference-free transmission to all users is
achieved. To satisfy the rank constraint (6.3), rank

Fn,k[u, i]

= ℓk[u, i] must be
fulﬁlled.
As mentioned above, to maximize the SINR of the users, a joint optimization of
the precoders Fn,k[s, i] and the antenna combiners G(ct)
n,k [s, i] at the base station, based
on perfect knowledge of H(ct)
n,k [s, i], ∀s, is required; see, e.g., [18]. With the proposed
approach, however, it is sufﬁcient to feed back the subspace span

H(ect)
n,k [s, i]

, ∀s,
effectively reducing the feedback overhead, facilitating independent design of the
transmit- and receive-ﬁlters and enabling the application of Grassmannian quantiza-
tion, as detailed Sect.6.1.2. Useful selections of H(ect)
n,k [s, i] are proposed in Sect.7.1.
In case of ZF beamforming, transmitting a single stream per user ℓk[u, i] = 1, ∀u,
the effective channel matrix H(ect)
n,k [u, i] of user u is reduced to the effective channel
vector h(ect)
n,k [u, i] and the precoding matrix Fn,k[u, i] is obtained as the column-vector
fn,k[u, i] ∈CNT[i]×1. Combining the normalized effective channel vectors (channel
directions)
˜hn,k[u, i] =
h(ect)
n,k [u, i]
h(ect)
n,k [u, i]

(6.8)

6
Multi User and Multi Cell Simulations
119
of all served users in the so-called cell channel direction matrix
˜Hn,k[i] =
	
˜hn,k[1, i], . . . , ˜hn,k[Sn,k[i], i]

H
∈CSn,k[i]×NT[i],
(6.9)
a closed-form solution of the cell ZF precoding matrix Fn,k[i] of all users is
obtained as
Fn,k[i] = ˜Hn,k[i]H 
˜Hn,k[i] ˜Hn,k[i]H−1
Pn,k[i]1/2 = ˜Fn,k[i]Pn,k[i]1/2,
(6.10)
Fn,k[i] =

fn,k[1, i], . . . , fn,k[Sn,k[i], i]

, Pn,k[i] = diag

pn,k[1, i], . . . , pn,k[Sn,k[i], i]

,
where the precoding vectors fn,k[u, i] are obtained as the columns of Fn,k[i]. Con-
sidering equal power allocation, the powers pn,k[u, i] are calculated as
pn,k[u, i] =
Pi
Sn,k[i]
[˜Fn,k[i]]:,u

2 , ∀u ∈{1, . . . , Si[n, k]} ,
(6.11)
with Pi denoting the instantaneous total power constraint of the base station.
With the BD condition (6.2), the input-output relationship with perfect CSIT
simpliﬁes to
yn,k[u, i] = H(ect)
n,k [u, i]H Fn,k[u, i] xn,k[u, i] + G(ct)
n,k [u, i]H ˜zn,k[u, i].
(6.12)
The precoder Fn,k[u, i] obtained from (6.4) is unique only up to right-multiplication
with any full-rank ℓk[u, i] × ℓk[u, i] matrix, as this multiplication has no impact on
span

Fn,k[u, i]

.
In [11], this ambiguity is removed by treating the interference-free input-output
relationship (6.12) as a SU-MIMO system (c.f. Eq.(5.1)), and additionally perform-
ing SVD based precoding with water-ﬁlling power allocation over the obtained
single-user channel. Hence, if ˜Fn,k[u, i] denotes an arbitrary semi-unitary solution
of (6.4), the unambiguous precoder according to [11] is obtained as
H(ect)
n,k [u, i]H ˜Fn,k[u, i] = Un,k[u, i]Σn,k[u, i]Vn,k[u, i]H,
(6.13)
Fn,k[u, i] = ˜Fn,k[u, i]Vn,k[u, i]Pn,k[u, i]1/2,
(6.14)
with (6.13) denoting an SVD of

H(ect)
n,k [u, i]H ˜Fn,k[u, i]

and Pn,k[u, i] being the
diagonal power allocation matrix obtained form the water-ﬁlling solution; see
Sect.5.1.2.
This, however, is not a reasonable approach with the subspace CSI feedback
proposed below, because the feedback only provides an arbitrary orthonormal basis
for H(ect)
n,k [u, i] that neither matches the individual orientations of the eigenmodes
of the effective channel nor contains information on their magnitude. Instead, semi-
unitary precoding with equal power allocation is considered, enforcing the following
additional precoder constraint

120
M. Rupp et al.
Fn,k[u, i]HFn,k[u, i] =
Pi
Sn,k[i] ℓk[u, i]
˜Fn,k[u, i]H ˜Fn,k[u, i] = Pu,i[n, k]Iℓk[u,i].
(6.15)
The corresponding solution is unique up to right-multiplication with any unitary
matrix, which has no impact on the achievable per user transmission rate with perfect
CSIT and equal power allocation
RBD = E log2 det

Iℓk[u,i] + ρ H(ect)
n,k [u, i]H ˜Fn,k[u, i]˜Fn,k[u, i]HH(ect)
n,k [u, i]

,
ρ = Pu,i[n,k]
˜σ 2z
.
(6.16)
6.1.2
Limited Feedback Model
With the assumption of equal power allocation, BD precoders can be calculated at the
base station if knowledge of the ℓk[u, i]-dimensional subspace span

H(ect)
n,k [u, i]

is
available for every u ∈Sn,k[i]. This subspace can be interpreted as a point on the
Grassmann manifold of ℓk[u, i]-dimensional subspaces in the NT[i]-dimensional
Euclidean space, denoted as G (NT[i], ℓk[u, i]). In general it can be represented
equivalently by any matrix S spanning the subspace
S ≡H(ect)
n,k [u, i] ⇔span (S) = span

H(ect)
n,k [u, i]

.
(6.17)
The most common approach to represent points on the Grassmann manifold is
employed, using orthonormal bases as in Eqs.(6.6) and (6.7). For a short introduction
of the Grassmann manifold see [19, Appendix C].
Perfect knowledge of ˜Hn,k[u, i], ∀u ∈Sn,k[i] from (6.6) is required at the base
station to achieve zero multi-user interference. With limited feedback, however, a
quantized version ˆHn,k[u, i] of the subspace is fed back to the transmitter. To convey
the CSI to the transmitter, a quantization codebook Qn,k[u, i] of size 2b is employed
by user u, with b denoting the number of feedback bits
Qn,k[u, i] =

Q j ∈CNT[i]×ℓk[u,i]QH
j Q j = Iℓk[u,i], j ∈{1, . . . , 2b}

.
(6.18)
The codebook is known by the base station. The quantized channel subspace is
obtained by minimizing the subspace chordal distance [6] between H(ect)
n,k [u, i] and
the elements of the codebook
ˆHn,k[u, i] =
argmin
Q j∈Qn,k[u,i]
d2
c

H(ect)
n,k [u, i], Q j

,
(6.19)
d2
c

H(ect)
n,k [u, i], Q j

= ℓk[u, i] −tr

˜Hn,k[u, i]HQ jQH
j ˜Hn,k[u, i]

,
(6.20)

6
Multi User and Multi Cell Simulations
121
d2
c,min = d2
c

H(ect)
n,k [u, i], ˆHn,k[u, i]

= ℓk[u, i] −
ℓk[u,i]

ℓ=1
cos

ϕ(q)
ℓ
2
.
(6.21)
In this equation, the variables ϕ(q)
ℓ
denote the ℓk[u, i] principal angles between
span

H(ect)
n,k [u, i]

= span
 ˜Hn,k[u, i]

and span
 ˆHn,k[u, i]

. When the chordal dis-
tance is employed as quantization metric the expected value of the residual multi-user
interference, due to the CSI quantization error, is minimized. This is investigated in
more detail in Sects.7.1 and 7.2.2, when considering the theoretical performance of
BD precoding with limited feedback and deriving the lower bound on the expected
SINR. The quantization problem(6.19) is well known as Grassmannian quantization
on the Grassmann manifold G (NT[i], ℓk[u, i]) [13].
It is assumed that the base station treats the quantized subspaces ˆHn,k[u, i] as
the actual subspaces ˜Hn,k[u, i], and calculates the precoders from (6.4), replacing
Hn,k[u, i] with
ˆHn,k[u, i] =
	
ˆHn,k[1, i], . . . , ˆHn,k[u −1, i], ˆHn,k[u + 1, i], . . . , ˆHn,k[Sn,k[i], i]

H
.
(6.22)
The effective channel H(ect)
n,k [u, i] can be decomposed into its range space compo-
nent H(ect,r)
n,k
[u, i] and its left null space component H(ect,n)
n,k
[u, i], with respect to the
orthonormal basis ˆHn,k[u, i]
H(ect)
n,k [u, i] = ˆHn,k[u, i] ˆHn,k[u, i]H H(ect)
n,k [u, i]
+

INT[i] −ˆHn,k[u, i] ˆHn,k[u, i]H
H(ect)
n,k [u, i]
= ˆHn,k[u, i] ˆHn,k[u, i]H H(ect)
n,k [u, i]



H(ect,r)
n,k
[u,i]
+ ˆH⊥
n,k[u, i] ˆH⊥
n,k[u, i]H H(ect)
n,k [u, i]



H(ect,n)
n,k
[u,i]
,
(6.23)
with ˆH⊥
n,k[u, i] ∈CNT[i]×NT[i]−ℓk[u,i] being an orthonormal basis for the orthogo-
nal complement of span
 ˆHn,k[u, i]

. Using this notation and ˆHn,k[u, i]HFn,k[s, i] =
0, ∀s ̸= u, due to the BD construction, the input-output relationship with quantized
CSIT is
yn,k[u, i] = H(ect)
n,k [u, i]HFn,k[u, i]xn,k[u, i]
+ H(ect,n)
n,k
[u, i]H
Sn,k[i]

s=1,s̸=u
Fn,k[s, i]xn,k[s, i] + G(ct)
n,k [u, i]H ˜zn,k[u, i].
(6.24)

122
M. Rupp et al.
Thus, with quantized CSIT perfect interference cancellation is not achieved. The
residual interference is determined by the quantization error of ˜Hn,k[u, i], captured by
thenullspacecomponentH(ect,n)
n,k
[u, i].Theper-usertransmissionratewithquantized
CSIT is [6]
RBD-Quant = E log2 det
⎛
⎝Iℓk[u,i] +
Sn,k[i]

s=1
H(ect)
n,k [u, i]HFn,k[s, i]Fn,k[s, i]HH(ect)
n,k [u, i]
⎞
⎠
−E log2 det
⎛
⎝Iℓk[u,i] +
Sn,k[i]

s=1,s̸=u
H(ect)
n,k [u, i]HFn,k[s, i]Fn,k[s, i]HH(ect)
n,k [u, i]
⎞
⎠,
(6.25)
where the expectation is taken with respect to channel and corresponding precoder
realizations.
6.2
Explicit CSI Feedback Algorithms
In interference limited multi-user precoding systems, such as MU-MIMO and inter-
ference alignment, strict requirements are placed on the CSIT accuracy, because CSI
imperfections directly impact the residual multi-user interference and strongly dete-
riorate the throughput performance [5, 6, 20]. Therefore, efﬁcient CSI quantization
is central in such systems to obtain sufﬁciently accurate CSIT with a reasonable
feedback overhead. As mentioned above, for the calculation of the BD precoders
with equal power allocation channel subspace information is sufﬁcient. The same
holds true for other concepts as well, e.g., interference alignment [21] and signal
to leakage and noise ratio beamforming [22]. This information can efﬁciently be
conveyed by the Grassmann manifold, putting Grassmannian quantization at the
center of this section. In Sect.6.2.1, memoryless quantization of channel subspaces
is studied, where the CSI at each Transmission Time Interval (TTI) is independently
quantized, i.e., without considering the past. Efﬁcient memoryless quantization in
Distributed Antennas Systems (DASs) is achieved by taking into account the channel
gain with respect to the individual antenna arrays during construction of the quanti-
zation codebook, to match the spatial distribution of the compound channel matrix.
For this purpose, we employ the following decomposition of the channel matrix into
a macroscopic and a microscopic fading part
H(ct)
n,k [u, i] = C[u, i] ¯H(ct)
n,k [u, i],
(6.26)
C[u, i] = diag

γ1[u, i], . . . , γNT[i][u, i]

,
(6.27)
with γ j[u, i] denoting the large-scale channel gain between transmit antenna j of
cell i and all receive antennas of user u in cell i.

6
Multi User and Multi Cell Simulations
123
Often sufﬁcient CSIT accuracy cannot be obtained with an acceptable feedback
overhead employing memoryless techniques. To circumvent this problem, predictive
quantization is proposed in Sect.6.2.2, exploiting the temporal channel correlation
to improve the quantizer’s ﬁdelity. The performance of the quantizers is investigated
numerically by evaluating the quantization Mean Square Error (MSE) in Sect.6.2.3.
Thederivationofchannelqualityfeedbackfortransmissionrateadaptationandmulti-
user scheduling is postponed until Sect.7.2.2 when frequency selective systems are
treated.
The methods proposed in this section are designed for CSI quantization on a
single frequency ﬂat subcarrier. Efﬁcient extensions to multi-carrier OFDM are pro-
posed in Sect.7.2, considering feedback clustering and interpolation. Also, antenna
combining is not considered in Sects.6.2.1 and 6.2.2; hence, ℓk[u, i] = NR[u, i] and
G(ct)
n,k [u, i] = INR[u,i] is assumed. Excess receive antennas, i.e., the case ℓk[u, i] ≤
NR[u, i], and antenna combining are covered in Sect.7.1. Notice that it is possible to
apply the predictive quantization proposed in Sect.6.2.2 in the frequency domain as
well, i.e., over OFDM subcarriers. This is not treated here, although it has been inves-
tigated in [23, 24]. With sufﬁciently dense placement of CSI pilots in the frequency
domain, a substantial prediction gain can be achieved, especially if large system
bandwidths are considered. The interpolation and clustering methods proposed here,
however, facilitate a signiﬁcant reduction of the required CSI pilots in the frequency
domain.
6.2.1
Memoryless Grassmannian Quantization
With memoryless quantization, the temporal correlation of the source to be quantized
is neglected and the quantization is performed independently at each time instant
k, employing a pre-speciﬁed quantization codebook Qn,k[u, i]. Possibly different
codebooks are used by different users to avoid situations in which users feed back
the same CSI, excluding them from being spatially multiplexed with each other. The
average quantization distortion in terms of the chordal distance MSE
D = E

d2
c,min

(6.28)
is critically determined by the construction of the quantization codebook.
Codebooks for Isotropic Subspaces
If the channel subspace span

˜Hn,k[u, i]

is uniformly distributed on the Grassmann
manifold G (NT[i], NR[u, i]), i.e., the channel matrix H(ct)
n,k [u, i] is isotropically dis-
tributed (e.g., independent and Identically Distributed (I.I.D.) Rayleigh fading), the
minimum average quantization distortion is achieved by maximally spaced Grass-
mannian subspace packings with respect to the chordal distance [25]. These packings
are essentially uniform on the Grassmann manifold in terms of the chordal distance.

124
M. Rupp et al.
Unfortunately, ﬁnding good codebooks is in general hard except for special cases;
an algorithm for obtaining good codebooks is provided, e.g., in [26].
More suitable for analytical investigations, however, are random quantization
codebooks,consistingofelementsQ j ∈Qn,k[u, i]thatarechosenindependentlyand
uniformly distributed on G (NT[i], NR[u, i]) [6]. The elements of such codebooks
can be obtained as the compact left singular matrices of I.I.D. Gaussian matrices
H ∈CNT[i]×NR[u,i], [H]m,n ∼NC (0, 1). Such a codebook construction, denoted as
Random Vector Quantization (RVQ), is applied in here whenever memoryless quan-
tization is evaluated. In that case, the results are averaged over codebook realizations
by employing independent quantization codebooks at each time instant k. Bounds on
the average distortion achieved with random isotropically distributed Grassmannian
quantization codebooks are derived in [14], and the codebooks are shown to perform
asymptotically optimal in a number of applications, e.g., [27].
Codebooks for Correlated Subspaces
In case the channel subspace to be quantized is not obtained from an isotropically
distributed channel matrix, better quantization performance can be achieved if knowl-
edge of the spatial channel correlation is exploited. An efﬁcient heuristic codebook
construction is proposed in [28] for single-user multiple-input single-output beam-
forming systems, which effectively “colors” a Grassmannian line packing according
to the channel correlation matrix. This approach is extended here for Grassmannian
subspace packings to exploit the pathloss differences experienced in DASs. Consid-
ering a DAS model, a random Grassmannian codebook that is statistically matched
to the distribution of the channel subspace can be obtained as
Q(corr)
n,k
[u, i] =

Q(corr)
j
Q(corr)
j
ΣVH = C[u, i]1/2 ¯H ∈CNT[i]×NR[u,i], [ ¯H]m,n ∼NC (0, 1)

.
(6.29)
Here, Q(corr)
j
ΣVH represents a compact SVD of the matrix C[u, i]1/2 ¯H. The code-
book construction is denoted as correlated RVQ. An analytic performance charac-
terization of this construction was not yet successful. Simulations demonstrating the
performance gain achieved in DASs with this codebook are provided in [29, 30].
The method can be applied to account for the spatial correlation in-between different
entries of the channel matrix as well. Alternative approaches to consider the pathloss
differences in DASs or the spatial channel correlation exist in literature, e.g., in [31]
a quantization codebook for ZF beamforming based on estimated channel statistics
is proposed, and in [32] a feedback bit allocation scheme for DASs is derived.
6.2.2
Predictive Grassmannian Quantization
MU-MIMO techniques are mostly considered for situations in which users are either
static or moving slowly through the cell. If this is the case, the temporal correlation

6
Multi User and Multi Cell Simulations
125
of the wireless channel is often high, which can be exploited to improve the CSI
quantization accuracy and to reduce the feedback overhead. A common approach in
quantization and source coding for exploiting the correlation of the source signal is
vector quantization [33], where multiple consecutive samples of the source signal
are combined to a vector and are jointly coded/quantized. Although such techniques
are rate-distortion optimal, they cannot be applied for CSI quantization in wireless
communications, because the throughput performance of MU-MIMO with outdated
CSI degrades in a similar way as with a quantization error [34]. Hence, the delay
of vector quantization caused by gathering and processing the data cannot be toler-
ated. Instead, predictive quantization on the Grassmann manifold is proposed in this
section to achieve efﬁcient subspace quantization. Predictive quantizers are able to
leverage the temporal correlation of the source signal at consecutive time instants
to provide higher ﬁdelity at a given quantization rate. The prediction of points on
the Grassmannian is realized by translating the problem to the tangent space associ-
ated with the manifold. The statistics of the prediction error in the tangent space are
approximated with a Gaussian distribution, which is valid for sufﬁciently small pre-
diction errors. Based on this approximation, a Grassmannian quantization codebook
is generated to quantize the prediction error. The performance of the proposed algo-
rithm is evaluated by means of Monte Carlo simulations of the quantization MSE in
Sect.6.2.3. An application of the proposed quantizer for CSI quantization in limited
feedback MU-MIMO is investigated in Sect.7.2.3. For a short introduction of the
Grassmann manifold see [19, Appendix C]. To shorten notations, the RE index [n, k]
is partly omitted for intermediate steps and auxiliary variables of the derivation.
Predictive Quantization Model
The predictive Grassmannian quantizer derived below explicitly considers the effect
of distributing antenna arrays over the cell area, by employing the decomposition
of the channel matrix into a temporally constant channel gain matrix C[u, i] and a
small-scale fading matrix ¯Hu,i[n, k]. The channel gain matrix C[u, i] is supposed to
be known by the transmitter and the receiver. The temporal variation of the channel
due to the movement of obstacles and/or users is hence captured in ¯Hu,i[n, k]. In the
derivation of the quantizer, a general model for the temporal evolution of ¯Hu,i[n, k]
is considered
¯H(ct)
n,k [u, i] = G

¯H(ct)
n,k−1[u, i], ¯H(ct)
n,k−2[u, i], . . .

+ ¯Jn,k[u, i] = ¯H(d)
n,k[u, i] + ¯Jn,k[u, i].
(6.30)
Here, the deterministic dependence of the current channel on the past is described
with ¯H(d)
n,k[u, i] and the random innovation is captured in the matrix ¯Jn,k[u, i], which
is assumed as I.I.D. Gaussian
vec
¯Jn,k[u, i]

∼NC

0, σ 2
j [n, k] INT[i]·NR[u,i]

.
(6.31)
No speciﬁc assumptions are made about the nature of the deterministic function G (·)
in (6.30), because the behavior of the wireless channel is strongly dependent on the

126
M. Rupp et al.
surrounding environment [35]. In [36] it is shown that Rayleigh fading processes can
be accurately modeled using auto-regressive relations, ﬁtting well to the considered
decomposition in (6.30).
In the proposed quantizer, a prediction algorithm is implemented to provide an
estimate of the deterministic evolution ¯H(d)
n,k[u, i], based on previously quantized
channel observations. Assuming that a prediction ¯H(p)
n,k[u, i] of ¯H(d)
n,k[u, i] is available,
the channel is written as
H(ct)
n,k [u, i] = C[u, i]1/2
¯H(p)
n,k[u, i] + ¯E(p)
n,k[u, i] + ¯Jn,k[u, i]



¯En,k[u,i]

= ¯H(p)
n,k[u, i] + C[u, i]1/2 ¯En,k[u, i],
(6.32)
with ¯E(p)
n,k[u, i] denoting the prediction error. The prediction error is assumed as
independent of the innovation and I.I.D. Gaussian:
vec
 ¯E(p)
n,k[u, i]

∼NC

0, σ 2
p[n, k] INT[i]·NR[u,i]

.
Thus, the total error ¯En,k[u, i] is distributed as
vec
 ¯En,k[u, i]

∼NC

0, σ 2
e [n, k] INT[i]·NR[u,i]

, σ 2
e [n, k] = σ 2
p[n, k] + σ 2
j [n, k].
(6.33)
Given the prediction ¯H(p)
n,k[u, i] at both ends of the CSI feedback link, the channel
can be reproduced from knowledge of the error ¯En,k[u, i]. With an accurate predic-
tion (σ 2
p[n, k] ≪1) and a smoothly varying channel (σ 2
j [n, k] ≪1), the variance of
the signal to be quantized can thus be reduced by quantizing ¯En,k[u, i] instead of
¯H(ct)
n,k [u, i].
By taking advantage of the CSIT invariances introduced in Sect.6.1.2, the required
feedback information can further be reduced. Using orthonormal bases ˜Hn,k[u, i] and
˜H(p)
n,k[u, i] for the actual channel H(ct)
n,k [u, i] and the predicted channel ¯H(p)
n,k[u, i], as
deﬁned by Equation (6.7), the channel matrix can be written as
H(ct)
n,k [u, i] = ˜Hn,k[u, i]Dn,k[u, i] = ˜H(p)
n,k[u, i]D(p)
n,k[u, i] + C[u, i]1/2 ¯En,k[u, i],
(6.34)
Dn,k[u, i] = ˜Hn,k[u, i]HH(ct)
n,k [u, i], D(p)
n,k[u, i] = ˜H(p)
n,k[u, i]H ¯H(p)
n,k[u, i].
(6.35)
The channel subspace, represented by the orthonormal basis ˜Hn,k[u, i], is thus
obtained as
˜Hn,k[u, i] =

˜H(p)
n,k[u, i]D(p)
n,k[u, i] + C[u, i]1/2 ¯En,k[u, i]
−1
Dn,k[u, i].
(6.36)

6
Multi User and Multi Cell Simulations
127
Exploiting the differential geometry associated with the Grassmannian, it is possi-
ble to describe the error between the predicted subspace span
 ˜H(p)
n,k[u, i]

and the
observed subspace span
 ˜Hn,k[u, i]

with the error tangent
Tn,k[u, i] = T

˜H(p)
n,k[u, i], ˜Hn,k[u, i]

∈T

˜H(p)
n,k[u, i]

⊂CNT[i]×NR[u,i], (6.37)
where T
 ˜H(p)
n,k[u, i]

denotes the tangent space associated with the prediction
˜H(p)
n,k[u, i]. The shortest path on the manifold between the predicted subspace and
the actual subspace, which is denoted as the geodesic Γ
 ˜H(p)
n,k[u, i], Tn,k[u, i], p

, is
speciﬁed by the tangent Tn,k[u, i] and parametrized by variable p ∈[0, 1]. Having
knowledge of ˜H(p)
n,k[u, i] and Tn,k[u, i], it is hence possible to obtain an equivalent
representation of span
 ˜Hn,k[u, i]

from
˜Hn,k[u, i] ≡˜H(e)
n,k[u, i] = Γ

˜H(p)
n,k[u, i], Tn,k[u, i], 1

,
(6.38)
span

˜Hn,k[u, i]

= span

˜H(e)
n,k[u, i]

,
˜H(e)
n,k[u, i]H ˜H(e)
n,k[u, i] = INR[u,i].
(6.39)
In general, the two orthonormal bases ˜Hn,k[u, i] and ˜H(e)
n,k[u, i] are not equal but
equivalent representatives of the same point on the Grassmann manifold
G (NT[i], NR[u, i]), since they span the same subspace. For the purpose of precoder
calculation for BD MU-MIMO either matrix can be employed; an explicit distinction
between ˜Hn,k[u, i] and ˜H(e)
n,k[u, i] is hence omitted in the following. To calculate the
subspace span
 ˜Hn,k[u, i]

at the base station, it is sufﬁcient to feed back the error tan-
gent Tn,k[u, i]. Notice that this tangent lies in the (NT[i] −NR[u, i])-dimensional
tangent space associated with ˜H(p)
n,k[u, i]. Therefore, compared to quantization of
¯En,k[u, i], the dimensionality of the quantization problem is reduced from NT[i] to
NT[i] −NR[u, i].
Approximation of the Error Tangent Statistics
To derive an efﬁcient quantizer for the error tangent, knowledge about the statistics
of Tn,k[u, i] is required. Due to the nonlinear operations involved in the calculation
of the tangent, obtaining a closed-form statistical description is hard. Therefore, an
approximation is employed in the following that is valid if the channel correlation is
sufﬁciently large.
The tangent Tn,k[u, i] is obtained as
Tn,k[u, i] = UΦVH, U tan (Φ) VH = Θn,k[u, i],
(6.40)
Θn,k[u, i] =

INT[i] −˜H(p)
n,k[u, i] ˜H(p)
n,k[u, i]H



Pn,k[u,i]

˜Hn,k[u, i]

˜H(p)
n,k[u, i]H ˜Hn,k[u, i]
−1
.
(6.41)

128
M. Rupp et al.
Here, the diagonal matrix Φ = diag

ϕ(p)
1 , . . . , ϕ(p)
NR[u,i]

is composed of the princi-
pal angles between the subspaces spanned by ˜H(p)
n,k[u, i] and ˜Hn,k[u, i], which are
obtained from the arctangent of the singular values of Θn,k[u, i]. Under the assump-
tion ϕ(p)
i
≤0.30 ˆ= 17◦an error that is below 3 % is caused by the approximation
tan

ϕ(p)
i

≈ϕ(p)
i .
(6.42)
With this approximation, the tangent simpliﬁes to
Tn,k[u, i] ≈Θn,k[u, i] = Pn,k[u, i] ˜Hn,k[u, i]

˜H(p)
n,k[u, i]H ˜Hn,k[u, i]
−1
,
(6.43)
where the matrix Pn,k[u, i], which is deﬁned in Eq.(6.41), can be identiﬁed as a
projectionontotheorthogonalcomplementof ˜H(p)
n,k[u, i].Substituting ˜Hn,k[u, i]from
Eq.(6.36) the approximated tangent can be written as
Tn,k[u, i] ≈Pn,k[u, i]C[u, i]1/2 ¯En,k[u, i]

˜H(p)
n,k[u, i]HH(ct)
n,k [u, i]
−1
,
(6.44)
wheretheﬁrsttermfrom(6.36)vanishesduetotheprojectionPn,k[u, i]andthematrix
Dn,k[u, i]−1 is pulled inside the brackets. The tangent matrix is hence obtained as the
product of the left null space component of the channel matrix with respect to the
predicted subspace span
 ˜H(p)
n,k[u, i]

, and the inverse of the term ˜H(p)
n,k[u, i]HH(ct)
n,k [u, i]
that is determined by the range space component. Applying an SVD to the term in
brackets
˜H(p)
n,k[u, i]HH(ct)
n,k [u, i] = Yn,k[u, i]Λn,k[u, i]Wn,k[u, i]H,
(6.45)
Yn,k[u, i], Λn,k[u, i], Wn,k[u, i] ∈CNR[u,i]×NR[u,i],
the approximated tangent can be formulated as
Tn,k[u, i] ≈Pn,k[u, i]C[u, i]1/2 ¯En,k[u, i]

Wn,k[u, i]−1Λn,k[u, i]Yn,k[u, i]H
.
(6.46)
Assuming ˜H(p)
n,k[u, i]HH(ct)
n,k [u, i] as ﬁxed/observed, the distribution of the tangent
is determined by the null space component Pn,k[u, i]C[u, i]1/2 ¯En,k[u, i]. This term
is obtained as the projection of the zero-mean Gaussian error C[u, i]1/2 ¯En,k[u, i]
onto the orthogonal complement of span
 ˜H(p)
n,k[u, i]

and is therefore itself Gaussian
distributed. The distribution of Tn,k[u, i] is hence obtained as
vec

Tn,k[u, i]

∼NC

0, C(t)
n,k[u, i]

,
(6.47)

6
Multi User and Multi Cell Simulations
129
C(t)
n,k[u, i] = σ 2
e [n, k]

Yn,k[u, i]Λn,k[u, i]−2Yn,k[u, i]H



CM∈CNR[u,i]×NR[u,i]
⊗Pn,k[u, i]C[u, i]Pn,k[u, i]



CN ∈CNi ×Ni

.
(6.48)
Notice that the correlation matrix (6.48) is obtained from a Kronecker product. It
is therefore possible to derive a statistically matched quantization codebook for the
error tangent Tn,k[u, i] by correlating I.I.D. Gaussian matrices
Q(t,corr)
n,k
[u, i] =

C1/2
N Q jC1/2
M
 Q j ∈CNT[i]×NR[u,i],

Q j

l,m ∼NC

0, σ 2
e [n, k]

.
(6.49)
The correlation matrix CN can be calculated by the transmitter and the receiver,
because both have knowledge of the predicted subspace and of the channel gain
matrix. Unfortunately, CM is not known a-priori and can therefore not be exploited
to improve the quantization efﬁciency. Hence, the codebook is designed under the
assumption that CM is a scaled identity, which is the case if Λn,k[u, i] in (6.48) is a
scaled identity. The error tangent correlation matrix is then obtained as
C(t)
n,k[u, i] ≈
 σe[n, k]
λn,k[u, i]
2 
INR[u,i] ⊗CN

.
(6.50)
To further motivate this approach, two special cases are considered below that enable
a more detailed investigation of the factor λn,k[u, i].
Error Tangent Statistics with NR[u, i] = 1
When the users are equipped with single receive antennas, the channel matrix is
reduced to the channel vector h(ct)
n,k [u, i] and CM is obtained as
CM =
1
h(ct)
n,k [u, i]

2
cos

ϕ(p)2 , cos

ϕ(p)2 =
˜h(p)
n,k[u, i]H ˜hn,k[u, i]

2
,
(6.51)
with 0 ≤ϕ(p) ≤π/2 denoting the principal angle of the subspace prediction error. In
this case, CM is reduced to a scalar and has an impact only on the variance of the error
tangent. Notice that the variance is increased in fading dips, i.e., when
h(ct)
n,k [u, i]

2
is small, and in case the subspace prediction error is large.
Error Tangent Statistics for I.I.D. Gaussian Channels
When the channel matrix is I.I.D. Gaussian distributed
	
H(ct)
n,k [u, i]

l,m ∼
NC

0, γu,i

, it is possible to determine the expected value of the matrix CM with
respect to the unknown range space component of H(ct)
n,k [u, i] within span
 ˜H(p)
n,k[u, i]

.
This is achieved by considering the inverse of CM

130
M. Rupp et al.
C−1
M = Yn,k[u, i]Λn,k[u, i]2Yn,k[u, i]H = ˜H(p)
n,k[u, i]HH(ct)
n,k [u, i]H(ct)
n,k [u, i]H ˜H(p)
n,k[u, i].
(6.52)
With a compact SVD of the channel matrix H(ct)
n,k [u, i] = UΣVH, this product is
written as
C−1
M = ˜H(p)
n,k[u, i]HUΣ2UH ˜H(p)
n,k[u, i].
(6.53)
Notice that U is an isotropically distributed unitary matrix that is statistically inde-
pendent of the singular value matrix Σ, due to the assumption that the channel is
I.I.D. Gaussian and hence also isotropic [37, Theorem1]. Applying an SVD to the
product ˜H(p)
n,k[u, i]HU = Q cos (Φ) WH, the inverse of CM is obtained as
C−1
M = Q cos (Φ)

WHΣ2W

cos (Φ) QH.
(6.54)
Due to the isotropy of U, its projection onto span
 ˜H(p)
n,k[u, i]

is isotropically distrib-
uted within the subspace. Hence, the NR[u, i] × NR[u, i] matrices Q, cos (Φ) and
W are statistically independent, and Q and W are isotropically distributed unitary
matrices [37, Theorem1]. Furthermore, cos (Φ) is composed of the cosines of the
principal angles between span
 ˜H(p)
n,k[u, i]

and span
 ˜Hn,k[u, i]

cos (Φ) = diag

cos

ϕ(p)
1

, . . . , cos

ϕ(p)
NR[u,i]

.
(6.55)
Because of the isotropy of W and its statistical independence of Σ, it follows that
WHΣ2W ∼W C
NR[u,i]

NT[i], γu,i INR[u,i]

,
(6.56)
with W C
NR[u,i]

NT[i], γu,i INR[u,i]

denoting a central complex-valued Wishart distri-
bution of dimension NR[u, i], having NT[i] DoF. With this notation, the correlation
matrix CM is obtained as
CM = Q cos (Φ)−1 
WHΣ2W
−1 cos (Φ)−1 QH,
(6.57)
where the inverse matrix in the center is distributed according to the inverse Wishart
distributionW −C
NR[u,i]

NT[i], γ −1
u,i INR[u,i]

.Correspondingly,theexpectedvalueofCM
can be calculated as [38]
E (CM) =
E

Q cos (Φ)−2 QH
γu,i (NT[i] −NR[u, i])
=
1
γu,i (NT[i] −NR[u, i])
⎛
⎝
1
NR[u, i]
NR[u,i]

j=1
1
cos

ϕ(p)
j
2
⎞
⎠INR[u,i], (6.58)

6
Multi User and Multi Cell Simulations
131
where the second equality follows from the isotropy of Q. Hence, averaging out the
unknown orientation of the range space component of H(ct)
n,k [u, i] within the unknown
singular values and span

˜H(p)
n,k[u, i]

, a scaled identity matrix is obtained. The exact
scaling is determined by the distribution of the chordal distance prediction error
among the subspace dimensions. Notice that the expected value of (6.51) in case of
I.I.D. Rayleigh fading is obtained from (6.58) by setting NR[u, i] = 1.
Quantization Algorithm
Based on the observations of the previous paragraphs, a predictive Grassmannian
quantizer is proposed that generates at each time instant k a quantization codebook,
according to the tangent statistics derived in Eqs.(6.47) and (6.50). To determine the
correlation matrix C(t)
n,k[u, i] in (6.50), a subspace prediction ˜H(p)
n,k[u, i] is required
at the CSI encoder and the decoder. In this paragraph the prediction is assumed
to be given; subspace prediction algorithms are proposed in the next paragraph. In
general the scaling

σe[n,k]
λn,k[u,i]
2
of C(t)
n,k[u, i] is time-dependent; a tracking algorithm
is proposed to adapt the scaling of the quantization codebook correspondingly. As
described in Sect.6.1.2, the chordal distance is employed as quantization metric.
The chordal distance cannot be evaluated directly in the tangent space associated
with the Grassmannian. It is therefore necessary to project the tangent codebook
onto the manifold to obtain an equivalent Grassmannian codebook that enables the
quantization. The quantization algorithm is described in the following steps:
1. Initialize the codebook scale parameter sn,0[u, i] = 0 and the scale growth rate
g > 1. These parameters are used to track the scaling of C(t)
n,k[u, i].
2. Initialize a Gaussian quantization codebook Q(0)
u,i of size 2b for a standard nor-
mal random matrix of size NT[i] × NR[u, i]. Here this codebook is randomly
generated
Q(0)
u,i =

Q(0)
j

	
Q(0)
j

l,m ∼NC (0, 1)

.
(6.59)
3. Correlate the elements of Q(0)
u,i to match the correlation of the prediction error
C[u, i]1/2 ¯En,k[u, i]
Q(corr)
u,i
=

C[u, i]1/2Q(0)
j
 ∀Q(0)
j
∈Q(0)
u,i

.
(6.60)
Repeat the following steps for each k > 0:
4. Predict the current subspace and calculate the projection matrix Pn,k[u, i] in
Eq.(6.41).
5. Project the correlated codebook onto the orthogonal complement of
span
 ˜H(p)
n,k[u, i]

to determine the tangent codebook matching the structure of
the error tangent correlation matrix C(t)
n,k[u, i] deﬁned in (6.50)

132
M. Rupp et al.
Q(t)
n,k[u, i] =

Pn,k[u, i]Q j
 ∀Q j ∈Q(corr)
u,i

⊂T

˜H(p)
n,k[u, i]

.
(6.61)
6. Calculate two scaled codebooks to track the scaling of C(t)
n,k[u, i]
Q(t)
−,n,k[u, i] =

gs−Q(t)
j
 ∀Q(t)
j ∈Q(t)
n,k[u, i]

,
(6.62)
Q(t)
+,n,k[u, i] =

gs+ Q(t)
j
 ∀Q(t)
j ∈Q(t)
n,k[u, i]

,
(6.63)
s−= sn,k−1[u, i] −1,
s+ = min

sn,k−1[u, i] + 1, 0

.
(6.64)
7. Project the obtained tangent codebooks onto the manifold to obtain two Grass-
mannian codebooks Q−,u,i[n, k] and Q+,u,i[n, k]. This is achieved with the
geodesic Γ (·)
Q−,n,k[u, i] =

Γ

˜H(p)
n,k[u, i], Q(t)
j , 1
 ∀Q(t)
j ∈Q(t)
−,n,k[u, i]

,
(6.65)
Q+,n,k[u, i] =

Γ

˜H(p)
n,k[u, i], Q(t)
j , 1
 ∀Q(t)
j ∈Q(t)
+,n,k[u, i]

.
(6.66)
8. Quantize the observed subspace ˜Hn,k[u, i] with respect to both Grassmannian
codebooks
Q−=
argmin
Q j∈Q−,n,k[u,i]
d2
c

˜Hn,k[u, i], Q j

, d−= d2
c

˜Hn,k[u, i], Q−

,
(6.67)
Q+ =
argmin
Q j∈Q+,n,k[u,i]
d2
c

˜Hn,k[u, i], Q j

, d+ = d2
c

˜Hn,k[u, i], Q+

.
(6.68)
9. Determine the “winning” codebook, i.e., the one with minimum quantization
error
w = argmin
i∈{−,+}
di.
(6.69)
10. Determine the quantized channel subspace and update the codebook scale para-
meter
ˆHn,k[u, i] = Qw ∈Qw,n,k[u, i], sn,k[u, i] = sw.
(6.70)
11. Feedback the indices of Qw and sw.
The tangent codebook obtained in step 2 of the algorithm is equal in distribution to
the error tangent speciﬁed by Eqs.(6.47) and (6.50), despite a scaling factor. The
codebook scale parameter sn,k[u, i] is employed to track the scaling

σe[n,k]
λn,k[u,i]
2
of
C(t)
n,k[u, i], by determining the appropriate up- or down-scaling of the codebook scale
parameter in steps 3 and 6 of the algorithm. The ratio of the scaling between two
consecutive time instants is given by

6
Multi User and Multi Cell Simulations
133
gsn,k[u,i]
gsn,k−1[u,i] = g±1.
(6.71)
Thus, the tracking speed of the algorithm is determined by the variance growth
rate g; increasing g causes a faster tracking speed, but also a larger steady state
tracking error. The optimal value of g is determined by means of simulations in my
corresponding publication [39], where it is shown that the optimum depends on the
subspace dimension, but the sensitivity of the algorithm to the calibration of g is not
strongly pronounced. In this publication also the accuracy of the approximation of
the error tangent statistics in (6.47) is evaluated, demonstrating that the estimated
tangent variance ﬁts well to the observed variance up to very high channel Doppler
frequencies.
The feedback overhead of the proposed quantization algorithm is b + 1 bits per
quantization instant. The 1bit overhead is caused by the codebook scale parame-
ter that must be signaled to the decoder as additional side-information. The same
prediction algorithm is employed at the encoder and at the decoder, such that both
sides are able to calculate the two scaled codebooks Q−,n,k[u, i] and Q+,n,k[u, i].
With the feedback information, i.e., the indices of Qw and sw, the quantized channel
subspace ˆHn,k[u, i] and the scale parameter sn,k[u, i] can therefore be reproduced by
the decoder.
Prediction Algorithm
The Grassmannian quantization algorithm proposed in the previous paragraph is
based on the availability of a prediction ˜H(p)
n,k[u, i] of the current channel subspace,
to calculate a quantization codebook that is matched to the temporal evolution of
the subspace. The prediction algorithm must be based on quantized CSI to enable
the prediction at the encoder and at the decoder. Trivially, the previously quantized
subspace can be employed as a prediction ˜H(p)
n,k[u, i] = ˆHn,k−1[u, i], leading to a
differential quantizer as proposed in [40]. Better performance can be achieved with a
more sophisticated prediction. One possibility is to implement the prediction directly
on the Grassmann manifold, e.g., by means of a linear predictor
˜H(p)
n,k[u, i] =
Np

j=1
ˆHn,k−j[u, i] a j.
(6.72)
In general, the obtained prediction ˜H(p)
n,k[u, i] is not compatible with the considered
semi-unitary matrix representation of points on G (NT[i], NR[u, i]), which could be
resolved by applying an SVD decomposition after linear prediction to determine the
corresponding subspace. With this approach, however, an optimal solution for the
ﬁlter coefﬁcients is hard to obtain.
Thisdifﬁcultycanbeavoidedbypredictingthetangent T
 ˆHn,k−1[u, i], ˜Hn,k[u, i]

between the quantized subspace ˆHn,k−1[u, i] at time instant k −1 and the observed
subspace ˜Hn,k[u, i] at time instant k. With the geodesic deﬁned by this predicted

134
M. Rupp et al.
tangent, a subspace prediction ˜H(p)
n,k[u, i] can indirectly be obtained. In the tangent
space well known prediction algorithms from Euclidean geometry can be reused.
Although statistical models for the temporal evolution of the channel matrix exist,
there are no corresponding models for the temporal evolution of tangents available.
Due to the highly nonlinear relationship between subspaces and tangents, it is difﬁcult
to derive such a model. Instead, predictors that are not based on an underlying channel
model are proposed here. For one-dimensional subspaces adaptive Finite Impulse
Response (FIR) ﬁlters are employed, while a regression model is considered for
higher dimensional subspaces. The adaptive ﬁltering approach is not used for higher
dimensional subspaces, due to the large number of ﬁlter coefﬁcients required to
achieve an accurate prediction and the corresponding slow ﬁlter convergence speed.
The basic idea of regression based prediction is proposed by Zhang et.al. for one-
dimensional subspaces in [41] under the name robust Grassmannian prediction. Its
extension to higher dimensional subspaces is straightforward and is conducted in
my publication [42]; the interested reader is referred to this publication for details.
The basic idea is to apply a linear regression to the tangents observed over multiple
time instants and to predict the current tangent based on this regression. Compared to
the adaptive ﬁlter based approach proposed below, the regression has the advantage
that the ﬁlter convergence phase of the adaptive ﬁlter is omitted, despite a slightly
reduced prediction performance as shown in Sect.6.2.3.
Adaptive Filter Based Prediction of One-Dimensional Subspaces
The following predictor is derived for a prediction on the Grassmann manifold
G (NT[i], 1). An auto-regressive model of order Np is considered to describe the tem-
poral evolution of the tangent random process. The prediction is based on quantized
CSI. The tangent describing the geodesic between the quantized channel subspaces
ˆhn,k−1[u, i] and ˆhn,k[u, i] at consecutive time instants is denoted
t(q)
n,k[u, i] = T

ˆhn,k−1[u, i], ˆhn,k[u, i]

∈T

ˆhn,k−1[u, i]

.
(6.73)
At time instant k, a prediction ˜h(p)
n,k[u, i] of the subspace ˜hn,k[u, i] is required by
the quantizer to calculate the quantization codebook. This prediction is obtained
indirectlybyﬁrst predictingthetangenttn,k[u, i] = T

ˆhn,k−1[u, i], ˜hn,k[u, i]

using
a linear predictor of order Np
t(p)
n,k[u, i] =
Np

j=1
¯t(q)
n,k−j[u, i] a( j)
n,k[u, i] = T(q)
n,k[u, i]an,k[u, i],
(6.74)
T(q)
n,k[u, i] =
	
¯t(q)
n,k−1[u, i], . . . , ¯t(q)
n,k−Np[n, k −Np]

∈T

ˆhn,k−1[u, i]

,
(6.75)
an,k[u, i] =
	
a(1)
n,k[u, i], . . . , a
(Np)
n,k [u, i]

T
.
(6.76)

6
Multi User and Multi Cell Simulations
135
A linear combination of tangent vectors as in (6.74) is only meaningful if the tan-
gents are deﬁned in the same tangent space. Hence, the tangents t(q)
n,k−j[u, i], j ∈
{1, . . . , Np} cannot directly be employed in (6.74). Instead, it is necessary to trans-
port the geometric information contained in t(q)
n,k−j[u, i] from the respective tangent
space T
ˆhn,k−j−1[u, i]

to the current position T
ˆhn,k−1[u, i]

. This is enabled by
means of parallel transport. Thus, parallel transported versions ¯t(q)
n,k−j[u, i] of the
previously observed tangents t(q)
n,k−j[u, i] are employed in (6.74). This is achieved by
updating the matrix T(q)
n,k[u, i] at each time instant k, as soon as ˆhn,k[u, i] is observed,
as follows:
1. Circularly shift the columns of T(q)
n,k[u, i] by one to the right.
2. Calculate the tangent t(q)
n,k[u, i] and replace the ﬁrst column of T(q)
n,k[u, i] with
t(q)
n,k[u, i].
3. Parallel transport the columns of T(q)
n,k[u, i] along the geodesic deﬁned by t(q)
n,k[u, i]
from T
ˆhn,k−1[u, i]

to T
ˆhn,k[u, i]

.
	
T(q)
n,k+1[u, i]

:, j = Π

ˆhn,k−1[u, i], ˆhn,k[u, i],
	
T(q)
n,k[u, i]

:, j

,
(6.77)
with Π(·) denoting the parallel transport operator.
The predictor coefﬁcients an,k[u, i] are trained with a stochastic gradient algorithm,
namely the normalized least mean squares algorithm [43]. Deﬁning the tangent pre-
diction error at time k as
e(p)
n,k[u, i] = t(q)
n,k[u, i] −t(p)
n,k[u, i] = t(q)
n,k[u, i] −T(q)
n,k[u, i]an,k[u, i],
(6.78)
the ﬁlter coefﬁcient update rule is obtained as
an,k+1[u, i] = an,k[u, i] + μ T(q)
n,k[u, i]H
T(q)
n,k[u, i]

2 e(p)
n,k[u, i].
(6.79)
The step size μ, determining the trade-off between the ﬁlter convergence speed and
the steady-state MSE, has to satisfy 0 < μ < 2 for convergence [43]. Notice that the
error (6.78) is calculated with the tangent t(q)
n,k[u, i] obtained from the quantized sub-
space ˆhn,k[u, i] and not from the actual subspace ˜hn,k[u, i]. Therefore, the accuracy
of the prediction of ˜hn,k[u, i] is impacted by the quantization error. This approach is
necessary to enable the prediction at the decoder, which has only access to quantized
CSI.
In Fig.6.1, a schematic of the concatenation of the proposed quantization, pre-
diction and codebook generation methods is illustrated, visualizing the interplay
between the different components. The quantized subspace is passed from the

136
M. Rupp et al.
Fig. 6.1 Structure of the Grassmannian subspace quantizer visualizing the different components
quantizer to the predictor at both ends of the feedback link to enable the prediction of
the next subspace. Based on this prediction and on information about the previously
employed codebook scaling, a new quantization codebook is calculated that spans
a certain volume on the Grassmann manifold around the predicted subspace. Over
a dedicated feedback channel the quantized CSI is passed from the encoder to the
decoder in form of the codebook index and the scale index. This information is suf-
ﬁcient for the decoder to reconstruct the quantized channel subspace and to prepare
the codebook for the next time instant.
6.2.3
Evaluation of the Quantization MSE
In this section, the performance of the proposed Grassmannian quantization algo-
rithms is investigated by means of Monte-Carlo simulations. The chordal distance
MSE as deﬁned in Eq.(6.28), providing a natural distance measure for points on
the Grassmannian, is employed as performance metric. The chordal distance also
determines the achievable rate loss of BD based MU-MIMO with quantized CSIT
compared to perfect CSIT; see Sect.7.1 for details.
In the ﬁrst simulation, predictive Grassmannian quantization on G (4, 1) is con-
sidered using the quantization codebook sizes Q ∈{8, 32, 128} which translates to
a CSI feedback overhead of b ∈{3, 5, 7} + 1 bit, due to the 1 bit overhead caused by
the codebook scale index. The performance of differential quantization [40], robust
Grassmannian prediction [41] and the adaptive ﬁlter based prediction proposed in the
previous section is compared. The temporal correlation is determined by Clarke’s
model. The results are plotted in dependency of the normalized channel Doppler
frequency νd deﬁned in Eq.(5.35). The appropriate length Np of the prediction ﬁlter
is determined by the channel correlation according to Clarke’s model. The length is
set as

6
Multi User and Multi Cell Simulations
137
Np = min
 1.5
2πνd

, 20

,
(6.80)
employing past values with a correlation of ≥0.5 for prediction, where the argument
of the Bessel function determining the correlation in Clarke’s model is approximately
1.5 [44]. The maximum ﬁlter length is restricted to 20 taps to achieve moderate
complexity and a reasonable ﬁlter convergence speed. The channel gain matrix is
assumed as an identity matrix.
The results of the simulation are shown in Fig.6.2a. The performance of the quan-
tizer is strongly dependent on the Doppler frequency, which determines the channel
correlation according to (5.34). With increasing Doppler frequency the channel corre-
lation is reduced, leading to a larger prediction error and thus to an increased variance
of the error tangent Tn,k[u, i]. It can be seen that the slope of the MSE achieved with
Fig. 6.2 MSE performance
comparison of the proposed
predictive Grassmannian
quantizer using different
prediction algorithms. a
Predictive quantization on
G (4, 1). b Predictive
quantization on G (8, 2).
(a)
(b)

138
M. Rupp et al.
the adaptive ﬁlter based predictor and the robust predictor is similar. Differential
quantization is signiﬁcantly outperformed by predictive quantization if the channel
correlation is sufﬁciently large, i.e., at low Doppler frequencies. Notice though that
this observation depends on the considered channel model. In [40] it is observed
that quantizers using higher order prediction do not achieve a gain over differential
quantizers in case the temporal channel evolution is determined by an autoregres-
sive model of order 1. This is evident, because in this case the current channel is
obtained by adding I.I.D. noise to the previous channel realization; as the I.I.D. noise
cannot be predicted, the best approach is to use the previous quantized observation
as prediction. Comparing adaptive prediction and robust prediction, it can be seen
that the adaptive ﬁlter is able to extract a prediction gain already at higher Doppler
frequencies. With a similar or even slightly improved slope, this gain is maintained
over the full range of considered Doppler frequencies. The gain is achieved because
the adaptive ﬁlter adjusts to the temporal statistics of the tangents, in contrast to the
tangent regression model employed by [41], which does not exploit any statistical
information.
Similar observations are obtained if quantization of higher dimensional subspaces
is investigated. In Fig.6.2b, the quantization performance on G (8, 2) is shown. In
this case, a CSI feedback overhead of 7bit and 11bit is considered. A comparison
of differential quantization and predictive quantization is conducted. The predictive
quantizers employ the robust prediction algorithm of [42]. Again it is observed that
a larger MSE slope is achieved with predictive quantization compared to differential
quantization, leading to a signiﬁcantly reduced quantization error at low Doppler fre-
quencies. The gain obtained by jointly quantizing all subspace dimensions (denoted
as matrix quantization) is investigated by comparing to an individual quantization
of the subspace dimensions (vector quantization). In case of matrix quantization, a
matrix codebook of size Qm ∈{64, 1024} is employed, while with vector quantiza-
tion the codebook size has to be reduced to Qv ∈{6, 23} to achieve the same feedback
overhead of log2 (64) + 1 ≈2 (log2 (6) + 1) ≈7 bit respectively 11bit. Due to the
reduced codebook size, individual quantization of the subspace dimensions is outper-
formed by joint quantization. With a growing subspace dimension the performance
difference is also increased.
In the next simulation, the effect of different channel gains experienced in a DAS
on the quantization performance is considered, by assuming a channel gain matrix
of the form
C[u, i] = diag (1, 1, 1, 1, γs, γs, γs, γs) ,
with γs ∈[0, 1]. Effectively this causes a gradual switching from the quantiza-
tion on G (4, 1) to G (8, 1). A codebook size of Q = 16 is assumed. The perfor-
mance of memoryless quantization, using the correlated RVQ codebook proposed in
Sect.(6.2.1), is compared to the MSE of predictive quantization, employing adaptive
ﬁlter based prediction. The obtained quantization MSE is shown in Fig.6.3. It can
be seen how the quantizers adapt to the varying channel gains. With decreasing γs
the quantization MSE is improved from the pure 8 × 1 performance at γs = 1 to

6
Multi User and Multi Cell Simulations
139
Fig. 6.3 Quantization MSE
achieved with memoryless
and predictive quantization
in a DAS with varying
channel gain differences
the pure 4 × 1 curve at γs = 0. Also, the performance improvement of predictive
quantization over memoryless quantization at low to moderate Doppler frequencies
is demonstrated in Figure6.3.
References
1. H. Weingarten, Y. Steinberg, S. Shamai, The capacity region of the Gaussian multiple-input
multiple-output broadcast channel. IEEE Trans. Inf. Theor. 52(9), 3936–3964 (2006)
2. D. Gesbert, M. Kountouris, R. Heath Jr., C. Chae, T. Slzer, From single user to multiuser
communications: shifting the MIMO paradigm. IEEE Signal Process. Mag. 24(5), 36 (2007)
3. D. Shiu, G. Foschini, M. Gans, J. Kahn, Fading correlation and its effect on the capacity of
multielement antenna systems. IEEE Trans. Commun. 48(3), 502–513 (2000)
4. A. Molisch, A generic model for MIMO wireless propagation channels in macro- and micro-
cells. IEEE Trans. Signal Process. 52(1), 61–71 (2004)
5. N. Jindal, MIMO broadcast channels with ﬁnite-rate feedback. IEEE Trans. Inf. Theor. 52(11),
5 (2006)
6. N. Ravindran, N. Jindal, Limited feedback-based block diagonalization for the MIMO broad-
cast channel. IEEE J. Sel. Areas Commun. 26(8), 1473–1482 (2008)
7. H. Bizaki, A. Falahati, Tomlinson-harashima precoding with imperfect channel state informa-
tion. IET Commun. 2(1), 151–158 (2008)
8. D. Ryan, I. Collings, I.V.L. Clarkson, R. Heath Jr., Performance of vector perturbation multiuser
MIMO systems with limited feedback. IEEE Trans. Commun. 57(9), 2633–2644 (2009)
9. A. Razi, D. Ryan, I. Collings, J. Yuan, Sum rates, rate allocation, and user scheduling for
multi-user MIMO vector perturbation precoding. IEEE Trans. Wirel. Commun. 9(1), 356–365
(2010)
10. C. Peel, B. Hochwald, A. Swindlehurst, A vector-perturbation technique for near-capacity mul-
tiantenna multiuser communication-part I: channel inversion and regularization. IEEE Trans.
Commun. 53(1), 195–202 (2005)
11. Q. Spencer, A. Swindlehurst, M. Haardt, Zero-forcing methods for downlink spatial multiplex-
ing in multiuser MIMO channels. IEEE Trans. Signal Process. 52(2), 461–471 (2004)

140
M. Rupp et al.
12. J.S. Kim, H. Kim, C.S. Park, K.B. Lee, On the performance of multiuser MIMO systems in
WCDMA/HSDPA: beamforming, feedback and user diversity. IEICE Trans. 89, 2161–2169
(2006)
13. B. Mondal, S. Dutta, R. Heath Jr., Quantization on the Grassmann manifold. IEEE Trans. Signal
Process. 55(8), 4208–4216 (2007)
14. W. Dai, Y. Liu, B. Rider, Quantization bounds on Grassmann manifolds and applications to
MIMO communications. IEEE Trans. Inf. Theor. 54(3), 1108–1123 (2008)
15. J. Lee, N. Jindal, High SNR analysis for MIMO broadcast channels: dirty paper coding versus
linear precoding. IEEE Trans. Inf. Theor. 53(12), 4787–4792 (2007)
16. V. Cadambe, S. Jafar, Interference alignment and degrees of freedom of the K-user interference
channel. IEEE Trans. Inf. Theor. 54(8), 3425–3441 (2008)
17. M. Maddah-Ali, A. Motahari, A. Khandani, Communication over MIMO X channels: Interfer-
ence alignment, decomposition, and performance analysis. IEEE Trans. Inform. Theor. 54(8),
3457–3470 (2008)
18. J. Park, B. Lee, B. Shim, A MMSE vector precoding with block diagonalization for multiuser
MIMO downlink. IEEE Trans. Commun. 60(2), 569–577 (2012)
19. S.Schwarz,LimitedfeedbacktransceiverdesignfordownlinkMIMOOFDMcellularnetworks,
Ph.D. Dissertation, Technische Universität Wien (2013). http://theses.eurasip.org/theses/514/
limited-feedback-transceiver-design-for-downlink/
20. B. Nosrat-Makouei, J. Andrews, R. Heath Jr., MIMO interference alignment over correlated
channels with imperfect CSI. IEEE Trans. Signal Process. 59(6), 2783–2794 (2011)
21. M. Rezaeekheirabadi, M. Guillaud, Limited feedback for interference alignment in the k-user
MIMO interference channel, in Proceedings of the Information Theory Workshop (Lausanne,
2012), pp. 1–5
22. L. Qiang, Y. Yang, F. Shu, W. Gang, SLNR precoding based on QBC with limited feedback
in downlink CoMP system," in International Conference on Wireless Communications and
Signal Processing (2010), pp. 1–5
23. S. Schwarz, M. Rupp, Adaptive channel direction quantization for frequency selective channels,
in 20th European Signal Processing Conference (Bucarest, 2012), pp. 2536–2540
24. T. Inoue, R. Heath, Jr., Grassmannian predictive frequency domain compression for limited
feedback beamforming, in Information Theory and Applications Workshop (2010), pp. 173–177
25. D. Love, R. Heath Jr., Limited feedback unitary precoding for spatial multiplexing systems.
IEEE Trans. Inf. Theor. 51(8), 2967–2976 (2005)
26. I.S. Dhillon, R. Heath Jr., T. Strohmer, J.A. Tropp, Constructing packings in Grassmannian
manifolds via alternating projection, ArXiv e-prints (2007)
27. W. Santipach, M. Honig, Capacity of a multiple-antenna fading channel with a quantized
precoding matrix. IEEE Trans. Inf. Theor. 55(3), 1218–1234 (2009)
28. D. Love, R. Heath Jr., Limited feedback diversity techniques for correlated channels. IEEE
Trans. Veh. Tech. 55(2), 718–722 (2006)
29. S. Schwarz, R. Heath Jr., M. Rupp, Multiuser MIMO in distributed antenna systems with limited
feedback, in IEEE 4th International Workshop on Heterogeneous and Small Cell Networks,
GLOBECOM (Anaheim, 2012)
30. S. Schwarz, R. Heath Jr., M. Rupp, Single-user MIMO versus multi-user MIMO in distributed
antenna systems with limited feedback. EURASIP J. Adv. Signal Process. 2013(54), 1–20
(2013)
31. B. Clerckx, G. Kim, S. Kim, MU-MIMO with channel statistics-based codebooks in spatially
correlated channels, in IEEE Global Telecommunications Conference (2008) pp. 1–5
32. E. Park, H. Kim, H. Park, I. Lee, Feedback bit allocation schemes for multi-user distributed
antenna systems. IEEE Commun. Lett. 17(1), 99–102 (2013)
33. A. Gersho, R. Gray, Vector Quantization and Signal Compression, The Kluwer international
series in engineering and computer science : communications and information theory (Kluwer
Academic Publishers, Boston, 1992)
34. B. Zhou, L. Jiang, S. Zhao, C. He, BER analysis of TDD downlink multiuser MIMO systems
with imperfect channel state information. EURASIP J. Adv. Signal Process. 2011(1), 104
(2011)

6
Multi User and Multi Cell Simulations
141
35. D. McNamara, M. Beach, P. Fletcher, Experimental investigation of the temporal variation of
MIMO channels, in IEEE 54th Vehicular Technology Conference, vol. 2 (2001), pp. 1063–1067
36. K. Baddour, N. Beaulieu, Autoregressive modeling for fading channel simulation. IEEE Trans.
Wirel. Commun. 4(4), 1650–1662 (2005)
37. B. Hassibi, Random matrices, integrals and space-time systems, in DIMACS Workshop on
Algebraic Coding Theory and Information Theory (Piscataway, 2003)
38. D. Maiwald, D. Kraus, Calculation of moments of complex Wishart and complex inverse
Wishart distributed matrices. IEE Proc. Radar Sonar Navig. 147(4), 162–168 (2000)
39. S. Schwarz, R. Heath Jr., M. Rupp, Adaptive quantization on a Grassmann-manifold for limited
feedback beamforming systems. IEEE Trans. Signal Process. 61(18), 4450–4462 (2013)
40. O. El Ayach, R. Heath Jr., Grassmannian differential limited feedback for interference align-
ment. IEEE Trans. Signal Process. 60(12), 6481–6494 (2012)
41. Y. Zhang, M. Lei, Robust Grassmannian prediction for limited feedback multiuser MIMO
systems, in IEEE Wireless Communications and Networking Conference (2012), pp. 863–867
42. S. Schwarz, R. Heath, Jr., M. Rupp, Adaptive quantization on the Grassmann-manifold for
limited feedback multi-user MIMO systems, in 38th International Conference on Acoustics,
Speech and Signal Processing (Vancouver, 2013)
43. S. Haykin, Adaptive ﬁlter theory, 4th edn. (Prentice Hall, New Jersey, 2002)
44. R.H. Clarke, A statistical theory of mobile radio reception. Bell Syst. Tech. J. 47, 957–1000
(1968)

Chapter 7
Advanced Multi User MIMO Concepts
Markus Rupp, Stefan Schwarz and Martin Taranetz
We start with extensions to systems with excess antennas in Sect.7.1. In the
following Sect.7.2, the feedback methods are extended to frequency selective sys-
tems by means of interpolation and clustering, and the lower bound on the Signal
to Interference and Noise Ratio (SINR) for Channel Quality Indicator (CQI) feed-
back is presented in Sect.7.2.2. The performance of the methods and algorithms
is investigated in Sect.7.2.3 through extensive Monte-Carlo simulations. Relevant
background information on the Grassmann manifold, useful for the understanding
of the proposed Grassmannian quantizer, is provided in [1, AppendixC]. Proofs and
derivations related to the antenna combiners and the SINR lower bound proposed
in this chapter are presented in [2, 3]. The Multiple-Input Multiple-Output (MIMO)
Minimum Mean Square Error (MMSE) equalizer that is employed in some of the sim-
ulations presented in Sect.7.2.3 is derived in [4]. The impact of the residual multi-user
interference due to Channel State Information at the Transmitter (CSIT) inaccuracies
is effectively reduced by this equalizer by exploiting the Block Diagonalization (BD)
construction to estimate the multi-user interference. More details are in [2–11].
7.1
Extension to Systems with Excess Antennas
The performance of Zero Forcing (ZF) beamforming and BD precoding based Multi
User Multiple-Input Multiple-Output (MU-MIMO) with quantized CSIT has been
studied thoroughly in the literature, for the case that the number of data streams per
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_7
143

144
M. Rupp et al.
user ℓ[u, i][k] is equal to the number of receive antennas NR[u, i]. It is shown in [12]
that the Channel State Information (CSI) feedback overhead of ZF beamforming
must be scaled linearly with the logarithmic Signal to Noise Ratio (SNR) (the SNR
in [dB]) to achieve the same multiplexing gain as in a system with perfect CSIT. A
similar bit-scaling law is determined in [13] for BD precoding to multiple users, if the
number of data streams per user is equal to the number of receive antennas. In [14], the
results of [12] on ZF beamforming are extended to the case that the users are equipped
with multiple receive antennas. An efﬁcient antenna combining algorithm denoted
as Quantization Based Combining (QBC) is proposed, which exploits the excess
antennas to minimize the CSI quantization error. With this strategy a signiﬁcant
reduction of the residual multi-user interference is achieved, implying a reduced
slope of the feedback bit-scaling law.
In this section, the QBC algorithm of [14] is extended to multiple data-streams
per user via BD precoding, for the case that the number of data streams per user
is less than or equal to the number of receive antennas, i.e., ℓ[u, i][k] ≤NR[u, i].
The performance of the obtained Subspace Quantization Based Combining (SQBC)
algorithm is investigated analytically by deriving the statistics of the Gramian of
the effective channel when including the antenna combiner. An upper bound on the
rate loss of a BD system employing SQBC with quantized CSIT compared to a BD
system with perfect CSIT is derived. It is shown that this bound generalizes the
previous results [12–14]. The corresponding scaling law of the feedback overhead
to achieve the same multiplexing gain as a system with perfect CSIT is calculated.
Depending on the number of data streams per user, the slope of the bit-scaling law
is signiﬁcantly reduced compared to BD without antenna combining.
To set the basis for the proposed antenna combining algorithm, previous results on
the rate loss of ZF and BD precoding systems with quantized CSIT are summarized
in Sect.7.1.1. The SQBC strategy, derived and analyzed in Sect.7.1.2, is compared
to a conventional antenna combining method, namely Maximum Eigenmode Trans-
mission (MET), which considers maximization of the effective channel gain of a
user. The performance of MET with quantized CSIT is evaluated in Sect.7.1.3 by
deriving an upper bound on the rate loss with respect to perfect CSIT. Although MET
provides an advantage in case of perfect CSIT, a signiﬁcant throughput improvement
is obtained with SQBC in interference-limited scenarios if a reasonable CSI feedback
overhead is considered. The RE index [n, k] is partly omitted for intermediate steps
and auxiliary variables to shorten notations.
7.1.1
Summary of Previous Results
Important results that assess the sensitivity of special cases of BD based MU-MIMO
systems with respect to the CSI quantization error are summarized below under
the assumption of independent and Identically Distributed (I.I.D.) Rayleigh fading
channels, i.e.,

H(ct)
n,k [u, i]

n,m ∼NC (0, γ [u, i]), with γ [u, i] denoting the macro-
scopic fading loss. A symmetric system is investigated where all users have the same

7
Advanced Multi User MIMO Concepts
145
number of antennas and receive an equal number of data streams ℓk[u, i] = NL, ∀u.
The schedule Sn,k[i] is supposed to be time independent, constantly serving the same
set of S[i] = NT[i]
NL users in parallel (supposed to be integer-valued). CSI quantization
is achieved with an Random Vector Quantization (RVQ) quantization codebook.
ZF Beamforming with NL = NR[u, i] = 1
The gap between the per-user transmission rate achieved with ZF beamforming based
on perfect CSIT (see Eq.(6.16)) and the rate of ZF beamforming with quantized CSIT
(see Eq.(6.25)) employing RVQ is upper-bounded by [12]
RZF −RZF-Quant ≤log2

1 + Pi γ [u, i]
˜σ 2z
D

, D = 2−
b
NT[i]−1 ,
(7.1)
with D being the average distortion achieved with RVQ. To maintain a bounded rate
gap, the number of feedback bits b must be scaled linearly with the logarithmic SNR,
with a slope that is determined by the number of transmit antennas NT[i].
BD Precoding with NL = NR[u, i] ≥1
The performance of “pure” BD precoding without receive antenna combining is
investigated in [13]. The number of streams NL per user is here equal to the number
of receive antennas NR[u, i]. The per-user rate gap between BD precoding with
perfect CSIT and BD precoding with quantized CSIT is upper-bounded by
RBD −RBD-Quant ≤NR[u, i] log2

1 + Pi γ [u, i]
˜σ 2z NR[u, i]D

,
(7.2)
D = CBD 2−
b
NR[u,i](NT[i]−NR[u,i]) .
(7.3)
As before it is observed that the number of feedback bits must be scaled linearly with
the SNR in [dB] to maintain a bounded rate gap, with a slope that depends on both
NT[i] and NR[u, i]. The constant CBD is speciﬁed in [15]. Setting NL = NR[u, i] = 1
this bound reduces to the result of [12].
ZF Beamforming with NL = 1, NR[u, i] ≥1 and Receive Antenna Combining
ZF beamforming with multiple receive antennas is considered in [14]. The QBC
antenna combiner proposed in [14] results in an effective channel that can be quan-
tized with minimal quantization error, given the quantization codebook Q[u, i]. In
that way, the expected residual multi-user interference is minimized without requir-
ing knowledge about the interference statistics. On the downside, the gain of the
effective channel is reduced when applying QBC, causing a loss in the received
power of the intended signal. Still, in interference limited scenarios this power-loss
is outweighed by the reduction of the multi-user interference. The rate gap between
ZF beamforming with N(ZF)
R
[u, i] = 1 and perfect CSIT and ZF beamforming with
NR[u, i] > 1 employing QBC and quantized CSIT is bounded by

146
M. Rupp et al.
RZF −R(NR[u,i])
QBC
≤log2

1 + Pi γ [u, i]
˜σ 2z
NT[i] −NR[u, i] + 1
NT[i]
D

+ log2 (e)
NT[i]−1

ℓ=NT[i]−NR[u,i]+1
1
ℓ,
(7.4)
with D being proportional to 2−
b
NT[i]−NR[u,i] as speciﬁed in [14]. Hence, with
NR[u, i] > 1, the distortion is reduced compared to Eq.(7.1). The superscript (NR[u,i])
is employed to highlight the important dependency of the performance of QBC on
the number of available receive antennas. In contrast to the other bounds consid-
ered above, a constant residual rate loss (the second summand) is caused by the
application of QBC, which does not depend on the quantization accuracy and thus
cannot be reduced by increasing the feedback overhead. This loss is caused by the
reduced channel gain of QBC compared to the single receive antenna system. With
NR[u, i] = 1 the result of [12] is recovered.
7.1.2
Subspace Quantization Based Combining
Considering the list of previous work on theoretical performance bounds for ZF
and BD MU-MIMO with limited feedback presented in the previous section, it is
noticedthatthegeneralcaseofBDprecodingwith1 ≤ℓk[u, i] ≤NR[u, i]andreceive
antenna combining is not evaluated. This general case is investigated below by ﬁrst
extending the QBC method to multi-stream transmission per user and then deriving
an upper-bound on the rate loss compared to perfect CSIT, generalizing the results
of [12–14] presented above.
SQBC Algorithm
The proposed antenna combiner is designed such as to generate an effective channel
that can be quantized with minimal subspace quantization error, given the quantiza-
tion codebook Qn,k[u, i] and the number of streams ℓk[u, i], that is,

G(SQBC)
n,k
[u, i], ˆH(SQBC)
n,k
[u, i]

= argmin
G,Qj
d2
c
	
H(ect)
n,k [u, i], Qj

= argmin
G,Qj
d2
c
	
H(ct)
n,k [u, i]G, Qj

,
(7.5)
subject to: G ∈CNR[u,i]×ℓk[u,i], GHG = Iℓk[u,i],
Qj ∈Qn,k[u, i] =

Qj ∈CNT[i]×ℓk[u,i]|QH
j Qj = Iℓk[u,i], j ∈{1, . . . , 2b}

.
Considering any Qj ∈Qn,k[u, i], a decomposition into its range space and left null
space components with respect to H(ct)
n,k [u, i] can be applied, using an orthonormal
basis B[u, i] for span
	
H(ct)
n,k [u, i]


7
Advanced Multi User MIMO Concepts
147
Qj = Q(R)
j
+ Q(N)
j
,
(7.6)
Q(R)
j
= H(ct)
n,k [u, i]
	
H(ct)
n,k [u, i]HH(ct)
n,k [u, i]

−1
H(ct)
n,k [u, i]HQj
= B[u, i]B[u, i]HQj,
(7.7)
Q(N)
j
=

INT[i] −B[u, i]B[u, i]H
Qj,
(7.8)
span (B[u, i]) = span
	
H(ct)
n,k [u, i]

,
(7.9)
B[u, i] ∈CNT[i]×NR[u,i], B[u, i]HB[u, i] = INR[u,i].
(7.10)
As Q(R)
j
is in the range space of H(ct)
n,k [u, i], it is possible to ﬁnd an antenna com-
biner G(ct)
n,k [u, i] such that the effective channel spans the same space as Q(R)
j , i.e.,
span

H(ct)
n,k [u, i]G(ct)
n,k [u, i]

= span

Q(R)
j

. On the other hand, the subspace distance
to the component Q(N)
j
in the orthogonal complement of span

H(ct)
n,k [u, i]

cannot be
reduced with antenna combining. Hence, with appropriate antenna combining, the
subspace quantization error is only determined by Q(N)
j
, and the minimal quantization
error is obtained with that Qj that is closest to the range space of H(ct)
n,k [u, i].
Theorem 7.1 (Subspace Quantization Based Combining) An ℓk[u, i] ≤NR[u, i]
dimensionalsubspaceofachannelmatrixH(ct)
n,k [u, i] ∈CNT[i]×NR[u,i] istobequantized
with a given quantization codebook
Qn,k[u, i] =

Qj ∈CNT[i]×ℓk[u,i]|QH
j Qj = Iℓk[u,i], j ∈{1, . . . , 2b}

.
(7.11)
Applying an antenna combiner to generate an effective channel of dimension NT[i] ×
ℓk[u, i], the minimal quantization error that can be obtained and the corresponding
quantized channel subspace are
d2
c,SQBC[n, k] =
min
Qj∈Qn,k[u,i]
Q(N)
j
2 =
min
Qj∈Qn,k[u,i] tr
	
(Q(N)
j
)HQ(N)
j

=
min
Qj∈Qn,k[u,i] ℓk[u, i] −tr

B[u, i]HQjQH
j B[u, i]

=
min
Qj∈Qn,k[u,i] d2
c
	
H(ct)
n,k [u, i], Qj

,
(7.12)
ˆH(SQBC)
n,k
[u, i] = argmin
Qj∈Qn,k[u,i]
d2
c
	
H(ct)
n,k [u, i], Qj

,
(7.13)
with
span (B[u, i]) = span
	
H(ct)
n,k [u, i]

,
B[u, i]HB[u, i] = INR[u,i].
The
corre-
sponding receive antenna combiner, generating the effective channel that achieves
this error, is obtained from the conditions
span
	
H(ct)
n,k [u, i]G(SQBC)
n,k
[u, i]

!= span
	
(B[u, i]B[u, i]H) ˆH(SQBC)
n,k
[u, i]

,
(7.14)
(G(SQBC)
n,k
[u, i])HG(SQBC)
n,k
[u, i]
!= Iℓk[u,i].
(7.15)

148
M. Rupp et al.
A formal proof of this theorem is provided in [1, AppendixF]. Notice that the quanti-
zation metric (7.13) is independent of the antenna combiner. Hence, it is not necessary
for CSI quantization to calculate the combiner for each Qj, providing an advantage
in terms of computational complexity.
A solution for the antenna combiner obtained from the conditions stated in Theo-
rem7.1 is unique only up to right-multiplication with any unitary ℓk[u, i] × ℓk[u, i]
matrix. In the following a speciﬁc solution is derived that enables further investiga-
tions on the channel statistics; an equivalent alternative solution is provided in [4].
The condition (7.14) can be written as
H(ct)
n,k [u, i]G(SQBC)
n,k
[u, i] = (B[u, i]B[u, i]H) ˆH(SQBC)
n,k
[u, i] ˜K[u, i],
(7.16)
with an appropriate full-rank matrix ˜K[u, i] ∈Cℓk[u,i]×ℓk[u,i]. The orthonormal basis
B[u, i] can be chosen such that the ﬁrst ℓk[u, i] columns of B[u, i] correspond to the
range space component of ˆH(SQBC)
n,k
[u, i] with respect to H(ct)
n,k [u, i] and the remaining
NR[u, i] −ℓk[u, i] columns are orthogonal to ˆH(SQBC)
n,k
[u, i]
B[u, i]H ˆH(SQBC)
n,k
[u, i] = W[u, i]R[u, i] =
Iℓk[u,i]
0

R[u, i],
(7.17)
W[u, i] ∈CNR[u,i]×ℓk[u,i], R[u, i] ∈Cℓk[u,i]×ℓk[u,i].
The channel H(ct)
n,k [u, i] is decomposed in terms of B[u, i], resulting in H(ct)
n,k [u, i] =
B[u, i]D[u, i]
with
D[u, i] = B[u, i]HH(ct)
n,k [u, i] ∈CNR[u,i]×NR[u,i].
With
these
decompositions the solution for G(SQBC)
n,k
[u, i] is obtained as
G(SQBC)
n,k
[u, i] = H(ct)
n,k [u, i]†B[u, i]W[u, i] R[u, i] ˜K[u, i]



K[u,i]
= D[u, i]−1W[u, i]K[u, i].
(7.18)
The undetermined matrix K[u, i] of size ℓk[u, i] × ℓk[u, i] is obtained by invoking
condition (7.15)
(G(SQBC)
n,k
[u, i])HG(SQBC)
n,k
[u, i]
= K[u, i]H 	
W[u, i]H 
D[u, i]D[u, i]H−1 W[u, i]

K[u, i]
!= Iℓk[u,i],
(7.19)
⇒K[u, i] =

W[u, i]H 	
B[u, i]HH(ct)
n,k [u, i]H(ct)
n,k [u, i]HB[u, i]

−1
W[u, i]
−1/2
.
(7.20)
With this solution, the effective channel employing SQBC is given by
H(ect)
n,k [u, i] = H(ct)
n,k [u, i]G(SQBC)
n,k
[u, i] = B[u, i]W[u, i]K[u, i] = ˜Hn,k[u, i]K[u, i].
(7.21)

7
Advanced Multi User MIMO Concepts
149
Channel Statistics
To derive statements about the statistics of the effective channel obtained with SQBC,
and to develop the throughput bound of the rate loss incurred with quantized CSIT
compared to perfect CSIT, it is necessary to impose additional assumptions on the
channel H(ct)
n,k [u, i] and the quantization codebook Qn,k[u, i]. Speciﬁcally, in the fol-
lowing two paragraphs the channel matrix is assumed as I.I.D. Rayleigh fading,
i.e., [H(ct)
n,k [u, i]]n,m ∼NC (0, γ [u, i]), and RVQ is employed for channel subspace
quantization. Also, the number of streams per user is assumed as time independent
ℓk[u, i] = ℓ[u, i].
Lemma 7.1 The subspaces spanned by the effective channels H(ect)
n,k [u, i], ∀u are
statistically independent and isotropically (uniformly) distributed on G (NT[i] ,
ℓ[u, i]).
Proof From (7.14) it is known that the subspace spanned by H(ect)
n,k [u, i] is determined
by the projection of the best quantization matrix ˆHn,k[u, i] onto span
	
H(ct)
n,k [u, i]

.
Since the quantization matrices are isotropically distributed on G (NT[i], ℓ[u, i]),
their projections onto span
	
H(ct)
n,k [u, i]

are isotropically distributed within this sub-
space. This holds also true for the best quantization matrix, since it is chosen
based solely on the Frobenius norm of the null space component. Furthermore, the
subspace span
	
H(ct)
n,k [u, i]

itself is isotropically distributed on G (NT[i], NR[u, i]),
since we assume i.i.d. Rayleigh fading. Thus, span
	
H(ect)
n,k [u, i]

is isotropically dis-
tributed on G (NT[i], ℓ[u, i]). Finally, the quantization codebooks and channels of
different users are statistically independent, implying statistical independence of
Heff
1,i[n, k], . . . , Heff
S[i],i[n, k].
Lemma 7.2 The Gramian of the effective channel (H(ect)
n,k [u, i])HH(ect)
n,k [u, i] is
complex-valued Wishart distributed of dimension ℓ[u, i], with NT[i] −NR[u, i] +
ℓ[u, i] degrees of freedom and identity scale matrix
(H(ect)
n,k [u, i])HH(ect)
n,k [u, i] ∼W C
ℓ[u,i]

NT[i] −NR[u, i] + ℓ[u, i], γ [u, i] Iℓ[u,i]

.
(7.22)
The proof of this lemma is provided in [1, AppendixF].
Throughput Analysis
Utilizing the results of the previous paragraph, it is possible to derive an upper
bound on the rate loss of BD precoding with quantized CSIT and excess receive
antennas NR[u, i] ≥ℓ[u, i], with respect to BD precoding with perfect CSIT but
having no excess antennas at the receivers, i.e., N(BD)
R
[u, i] = ℓ[u, i]. In case of excess
antennas, it is assumed that the users employ SQBC antenna combining to determine
the channel subspace feedback according to the quantization metric in Theorem7.1.

150
M. Rupp et al.
The quantized CSIT is used by the base station to calculate the precoders from (6.4)
and (6.22), respectively. The same symmetric scenario as in Sect.7.1.1 is considered,
i.e., all S[i] users are equipped with the same number of NR[u, i] receive antennas and
are served over the same number of ℓ[u, i] = NL data streams. An RVQ quantization
codebook is employed for quantization of the effective channel subspace.
According to (6.16), the achievable user rate of BD with perfect CSIT and no
excess antennas is
R(NL)
BD = E log2 det
	
INL + ρ H(ct)
n,k [u, i]H ˜Fn,k[u, i]˜Fn,k[u, i]HH(ct)
n,k [u, i]

,
(7.23)
ρ =
Pi
˜σ 2z S[i] NL
,
(7.24)
with H(ct)
n,k [u, i] = H(ect)
n,k [u, i] because N(BD)
R
[u, i] = NL. The expected value is calcu-
lated with respect to the channel and the precoder. Similarly, with quantized CSIT,
NL ≤NR[u, i] data streams and application of SQBC antenna combining, the achiev-
able rate is obtained as
R(NL,NR[u,i])
SQBC
= E log2 det

INL + ρ
S[i]

s=1
H(ect)
n,k [u, i]H ˜Fn,k[s, i]˜Fn,k[s, i]HH(ect)
n,k [u, i]

−E log2 det
⎛
⎝INL + ρ
S[i]

s=1,s̸=u
H(ect)
n,k [u, i]H ˜Fn,k[s, i]˜Fn,k[s, i]HH(ect)
n,k [u, i]
⎞
⎠,
(7.25)
ρ =
Pi
˜σ 2z S[i] NL
,
(7.26)
with H(ect)
n,k [u, i] being determined by Eq.(7.21). Here, the expected value is addi-
tionally calculated over quantization codebook realizations. Similar to the bounds
proposed in [12–14], i.e., Eqs.(7.1), (7.3), and (7.4), the throughput loss R(NL)
BD −
R(NL,NR[u,i])
SQBC
can be upper bounded:
Theorem 7.2 (SQBC rate loss) Consider a broadcast system with NT[i] transmit
antennas, NR[u, i] receive antennas per user and transmit power Pi. The system
serves S[i] users with NL ≤NR[u, i] streams each, over I.I.D. Rayleigh fading chan-
nels with additive Gaussian receiver noise of variance ˜σ 2
z . The per-user throughput
loss of BD precoding employing SQBC with quantized CSIT compared to BD precod-
ing with perfect CSIT, but having only NR[u, i](BD) = NL receive antennas, is upper
bounded by
R(NL)
BD −R(NL,NR[u,i])
SQBC
≤NL log2

1 + ρ γ [u, i] NT[i] −NR[u, i] + NL
NT[i] −NL
(S[i] −1) D


7
Advanced Multi User MIMO Concepts
151
+ log2 (e)
NL−1

k=0
NT[i]−1

ℓ=NT[i]−NR[u,i]+NL
1
ℓ−k , ρ =
Pi
˜σ 2z S[i] NL
.
(7.27)
Here, the average quantization distortion in terms of subspace chordal distance
achieved with RVQ is denoted D and the macroscopic pathloss is considered in
γ [u, i].
The proof of this theorem is provided in Appendix [1, AppendixF]. As can be seen
from (7.12), the relevant distortion D for SQBC is the distortion achieved when
quantizing subspaces from G (NT[i], NR[u, i]) using a quantization codebook with
entries from G (NT[i], NL). This quantization problem is considered in [15]. It is
shown in [15], that the average distortion with random isotropically distributed quan-
tization codebooks, i.e., RVQ, is obtained as
D = E

d2
c,SQBC

≈CSQBC 2−
b
NL(NT[i]−NR[u,i]) ,
(7.28)
with CSQBC being a function of NL, NT[i] and NR[u, i] as speciﬁed in [15, Eqs.(8)
and (11)], and 2b being the size of the codebook. Notice, for random quantization
the upper bound of [15, Eq.(11)] is relevant; the O(1) term is omitted. By setting
appropriate values for NL, NT[i] and NR[u, i] and considering the case S[i] = NT[i]
NL it
can be veriﬁed that (7.1), (7.3) and (7.4) are contained in (7.27).
Discussion of the Bound
The upper bound on the rate loss in (7.27) is composed of two summands captur-
ing distinct effects of the SQBC antenna combiner. The second summand, which is
abbreviated by Δa, is independent of the quantization accuracy D. From the argu-
mentation in the proof in [1, Appendix F], it follows that Δa gives a tight upper bound
on the rate loss R(NL)
BD −R(NL,NR[u,i])
SQBC
for the case of perfect CSIT (b →∞, D →0)
and ρ γ [u, i] →∞, i.e., at high SINR. This high SINR rate loss is caused by the
reduction of the effective channel gain due to the antenna combiner. Speciﬁcally, for
BD with NR[u, i](BD) = NL, the term H(ect)
n,k [u, i]HH(ect)
n,k [u, i] is distributed according
to W C
NL

NT[i], γ [u, i] INL

, while it is shown in Lemma7.2 that it is distributed as
W C
NL

NT[i] −NR[u, i] + NL, γ [u, i] INL

for SQBC. This loss in Degrees of Freedom
(DoF) of the Wishart distribution is the cause for the constant rate offset Δa. Hence,
SQBC is disadvantageous if the CSI quantization accuracy is already very high.
In this case, it is better to invest the available DoF provided by the NR[u, i] ≥NL
antennas to obtain a large effective channel gain, instead of further reducing the
quantization error.
The more important insights for limited feedback systems are captured in the ﬁrst
summand of (7.27) (abbreviated by Δb). If b is ﬁxed, this term grows to inﬁnity as the
SNR increases, meaning that the system becomes interference limited. If b is scaled

152
M. Rupp et al.
with the SNR, however, the rate gap can be kept constant and a multiplexing gain of
NT[i] can be achieved. Assuming S[i] = NT[i]
NL
the necessary feedback bit scaling is
determined by setting Δb equal to a constant rate loss ΔR in [bits/s/Hz]
b = NL (NT[i] −NR[u, i])

log2
 Pi
˜σ 2z
γ [u, i]
NT[i]

+ log2
NT[i] −NR[u, i] + NL
NL
CSQBC

−log2
	
2
ΔR
NL −1

 
.
(7.29)
The important insight is the growth-rate of the number of feedback bits with the SNR
βdB in [dB]
db
dβdB
=NL (NT[i] −NR[u, i]) log2 (10)
10
≈NL (NT[i] −NR[u, i])
3
,
(7.30)
βdB = 10log10
 Pi
˜σ 2z

.
It can be seen that the slope of the feedback overhead with SNR grows linearly with
the number of streams NL, and reduces with the number of receive antennas NR[u, i].
Hence, having more receive antennas with a ﬁxed NL the CSI feedback overhead
can be decreased. Still, this does not give the full picture, because varying NL and/or
NR[u, i] also impacts the absolute achievable throughput.
To investigate this inﬂuence, the high SINR sum rate difference between two
SQBC systems with the same NT[i] and NL, but different NR[u, i] ∈{M1, M2} is
determined. This rate difference is obtained from (7.27) by considering the bound
on R(NL)
BD −R(NL,M2)
SQBC
−

R(L)
BD −R(NL,M1)
SQBC

at high SINR
ΔR(M1, M2) = NT[i]
NL
	
R(NL,M1)
SQBC
−R(NL,M2)
SQBC

= NT[i]
NL
log2 (e)
NL−1

k=0
NT[i]−M1+NL−1

ℓ=NT[i]−M2+NL
1
ℓ−k ,
(7.31)
which results in a positive rate loss if M2 > M1. Thus, in contrast to most conven-
tional antenna combining strategies, if SQBC is employed with perfect CSIT, a rate
reduction is incurred at high SINR with growing number of receive antennas NR[u, i].
Similarly, it can be shown that the sum rate of SQBC is improved if the number of
streams per user is increased and the number of users is correspondingly decreased;
see [2] for details.

7
Advanced Multi User MIMO Concepts
153
7.1.3
Maximum Eigenmode Transmission
In this section, the performance of an alternative interference-unaware receive
antenna combining algorithm, namely MET, is investigated. With MET the effective
channel generated by a user is composed of the NL maximum eigenmodes of the
channel matrix. Hence, with perfect CSIT the NL-dimensional dominant subspace of
each users’ channel is kept free of interference, providing a potentially large channel
gain. On the other hand, the CSI quantization error achieved with MET is signif-
icantly larger than with SQBC, and thus the residual multi-user interference has a
much stronger impact on the performance of MET. The main reason for considering
MET as an alternative strategy to SQBC is that it enables an instructive investigation
on the trade off between investing the provided DoF of having NR[u, i] ≥NL excess
antennas to maximizing the signal power by means of MET, in contrast to minimiz-
ing the CSI quantization error (and hence the expected interference power) utilizing
SQBC. Also, the complexity and CSI feedback requirements (subspace informa-
tion) of MET are very similar to those of SQBC. In [16], MET is combined with a
coordinated eigenmode selection by the base station, such that users with close to
orthogonal channels are served in parallel. In the following investigation, scheduling
is not explicitly considered.
MET Algorithm
The goal of MET is to generate an NL-dimensional effective channel that maximizes
the achievable transmission rate of a user in the absence of multi-user interference,
by applying a semi-unitary antenna combiner. This is achieved, if the transmission
to the user takes place over the NL-dimensional dominant subspace of the channel
matrix H(ct)
n,k [u, i]. Consider an Singular Value Decomposition (SVD) of the channel
matrix H(ct)
n,k [u, i] in compact form
H(ct)
n,k [u, i] = Un,k[u, i]Σn,k[u, i]Vn,k[u, i]H
(7.32)
Un,k[u, i] ∈CNT[i]×NR[u,i], Σn,k[u, i] ∈CNR[u,i]×NR[u,i], Vn,k[u, i] ∈CNR[u,i]×NR[u,i].
Notice that Un,k[u, i], Σn,k[u, i], Vn,k[u, i] are statistically independent, and
Un,k[u, i] and Vn,k[u, i] are isotropic for I.I.D. Rayleigh fading. The channel sub-
space to be quantized is chosen as the ﬁrst NL columns of Un,k[u, i], corresponding
to the NL largest singular values of H(ct)
n,k [u, i]. The quantized subspace is obtained as
ˆH(MET)
n,k
[u, i] = argmin
Qj∈Qn,k[u,i]
d2
c
	
Un,k[u, i]

:,1:NL , Qj

.
(7.33)
As with SQBC, the quantized channel subspace can be obtained without having to
calculate the antenna combiner for each Qj. The codebook index of the quantized
channel subspace is fed back to the base station by the users, and the BD precoder
is calculated from quantized CSIT. With the provided subspace feedback power

154
M. Rupp et al.
loading over the eigenmodes is not reasonable, because no information about the
magnitude of the singular values is available at the base station. The corresponding
MET antenna combiner and the effective channel are given by
G(MET)
n,k
[u, i] =

Vn,k[u, i]

:,1:NL ,
(7.34)
H(ect)
n,k [u, i] =

Un,k[u, i]

:,1:NL

Σn,k[u, i]

1:NL,1:NL
= U(NL)
n,k [u, i]Σ(NL)
n,k [u, i] = H(NL)
n,k [u, i].
(7.35)
Throughput Analysis
The performance of BD precoding with MET antenna combining and quantized
CSIT can be evaluated in a similar way as the performance of SQBC under the
same assumptions (symmetric scenario, I.I.D. Rayleigh fading, RVQ), by deriving
an upper bound on the rate loss with respect to perfect CSIT. With the effective
channel from Eq.(7.35), the achievable per-user rate with perfect CSIT according to
Eq.(6.16) is
RMET = E log2 det
	
INL + ρ H(NL)
n,k [u, i]H ˜Fn,k[u, i]˜Fn,k[u, i]HH(NL)
n,k [u, i]

.
(7.36)
Similarly to (7.25), with quantized CSIT the achievable per-user rate is obtained as
RMET-Quant = E log2 det

INL + ρ
S[i]

s=1
H(NL)
n,k [u, i]H ˜Fn,k[s, i]˜Fn,k[s, i]HH(NL)
n,k [u, i]

−E log2 det
⎛
⎝INL + ρ
S[i]

s=1,s̸=u
H(NL)
n,k [u, i]H ˜Fn,k[s, i]˜Fn,k[s, i]HH(NL)
n,k [u, i]
⎞
⎠.
(7.37)
Theorem 7.3 (MET rate loss) Consider a multi-user broadcast system with NT[i]
transmit antennas, NR[u, i] receive antennas per user and transmit power Pi. The
system serves S[i] users with NL ≤NR[u, i] spatial streams each, over I.I.D. Rayleigh
fading channels with additive Gaussian receiver noise of variance ˜σ 2
z . The per-user
throughput loss of BD precoding employing MET antenna combining with quantized
CSIT compared to perfect CSIT is upper bounded by
RMET −RMET−Quant ≤
NL

ℓ=1
log2

1 + ρ ¯σ 2
ℓ,u,i
S[i] −1
NT[i] −NL
D

, ρ =
Pi
˜σ 2z S[i] NL
.
(7.38)
Here, the average quantization distortion in terms of subspace chordal distance
achieved with RVQ is denoted D. The set

¯σ 2
1 [u, i] . . . , ¯σ 2
NL[u, i]

is composed of

7
Advanced Multi User MIMO Concepts
155
the expected values of the NL largest squared singular values of the channel matrix
H(ct)
n,k [u, i]. Hence, ¯σ 2
ℓ[u, i] is equal to the expected value of the ℓ-th largest eigenvalue
of H(ct)
n,k [u, i]HH(ct)
n,k [u, i] ∼W C
NR[u,i]

NT[i], γ [u, i] INR[u,i]

, with γ [u, i] denoting the
macroscopic pathloss.
The proof of this theorem is provided in [1, Appendix F]. Notice that the macro-
scopic pathloss γ [u, i] does not appear explicitly in (7.38) but is captured in the
squared singular values. Closed form expressions for the expected eigenvalues of
H(ct)
n,k [u, i]HH(ct)
n,k [u, i] are known [17], but the expressions are involved and do not
provide further analytical insights. In contrast to the distortion D in (7.28) achieved
with SQBC, the average distortion D with MET is determined by quantizing an
isotropically distributed subspace from G (NT[i], NL) with a random codebook of
isotropically distributed entries from G (NT[i], NL) [15]
D ≈CMET 2−
b
NL(NT[i]−NL) .
(7.39)
It is hard to derive a closed form solution for b in dependency of the rate loss as
in (7.29), but the required number of bits can be evaluated numerically. The important
fact to note is that with MET the exponent of the distortion scales inversely propor-
tional to NL(NT[i] −NL) in contrast to NL(NT[i] −NR[u, i]), which is achieved with
SQBC. Hence, with SQBC having NR[u, i] > NL leads to a reduction of the average
quantization error, which is not the case with MET.
7.1.4
Achievable Rate Comparison of SQBC and MET
Whether SQBC or MET is considered as the preferred receive antenna combining
strategy in combination with BD precoding is determined by the available CSI feed-
back resources. This is investigated and explained in more detail in this section.
For that purpose, the achievable transmission rates of the two strategies in the lim-
iting case of perfect CSIT, i.e., b →∞is evaluated. The rates are calculated from
the corresponding achievable rate Eqs.(7.23) and (7.25) by estimating the expected
value by means of Monte-Carlo simulations. The achievable rate is calculated for a
single Orthogonal Frequency Division Multiplexing (OFDM) subcarrier, assuming
frequency ﬂat Rayleigh fading with

H(ct)
n,k [u, i]

l,m ∼NC (0, 1). The result is shown
in Fig.7.1a for the case NT[i] = 6, NL = 2 and NR[u, i] ∈{2, 3, 4, 5}. As scheduling
is not considered in this investigation, it is supposed that the set of scheduled users
S [i] is composed of all Ui = 3 users in the cell (hence also S[i] = 3).
It is observed in Fig.7.1a that the achievable sum rate of SQBC decreases with
increasing number of receive antennas, while the throughput of MET improves. This
is in conformance with our theoretical investigation of Sect.7.1.2. More speciﬁcally,
the throughput loss of SQBC at high SNR is given by the value ΔR(M1, M2) cal-
culated in (7.31), e.g., ΔR(2, 5) = 8.08bits/s/Hz according to (7.31). Hence, with
perfect CSIT, SQBC is not a reasonable choice. This behavior can be explained by

156
M. Rupp et al.
Fig. 7.1 Evaluation of the
achievable rate performance
and CSI feedback overhead
requirement of BD
precoding with SQBC and
MET antenna combining.
Three users are served over
six transmit antennas via two
streams per user. a
Achievable sum rate with
perfect CSIT. b Feedback
bit-scaling for a per-user rate
loss of 1bits/s/Hz
30
27
24
21
18
15
12
9
6
3
0
50
45
40
35
30
25
20
15
10
5
0
SNR [dB]
Achievable sum rate [bits/s/Hz]
SQBC 
MET
R(2,5) 
NR[u,i] = 2
NR[u,i] = 3
NR[u,i] = 4
NR[u,i] = 5
30
28
26
24
22
20
18
16
14
12
10
90
80
70
60
50
40
30
20
10
0
SNR [dB]
Sufficient number of feedback bits
SQBC 
MET
NR[u,i] = 5
NR[u,i] = 4
NR[u,i] = 3
NR[u,i] = 2
(a)
(b)
considering the channel statistics provided in Lemma7.2. According to this lemma,
the DoF of the Wishart distribution deﬁning the statistics of H(ect)
n,k [u, i]HH(ect)
n,k [u, i]
are reduced with a growing number of receive antennas NR[u, i]. Correspondingly,
the eigenvalues of this Wishart matrix are decreased on average, causing a reduction
of the average effective channel gain. On the other hand, with MET the channel gain
is determined by the NL maximum eigenvalues of a matrix with Wishart distribu-
tion W C
NR[u,i]

NT[i], INR[u,i]

according to Theorem7.3. It is well known that these
eigenvalues increase on average with growing dimension NR[u, i].
The advantage of SQBC is visualized in Fig.7.1b. In this ﬁgure the sufﬁcient
number of CSI feedback bits to achieve a per-user rate loss of 1bits/s/Hz compared to
perfect CSIT is shown. With MET, the slope of the feedback overhead versus the SNR
for a given number of data streams NL per user is independent of the number of receive
antennas NR[u, i] and the required feedback overhead is signiﬁcantly larger than in
case of SQBC. With SQBC, the feedback overhead can be substantially reduced by

7
Advanced Multi User MIMO Concepts
157
increasing the number of receive antennas NR[u, i], for the cost of a moderate SNR
offset in the achievable throughput. This reduction is due to the decreasing exponent
in the average distortion (7.28) with increasing NR[u, i], obtained from the degree of
freedom to select the best NL-dimensional subspace within an NR[u, i]-dimensional
space during CSI quantization.
In Fig.7.2, the validity of the bit-scaling law derived in (7.29) is investigated. In
the results shown in Fig.7.2a the base station is equipped with NT[i] = 6 transmit
antennas. S[i] = 3 users are served in parallel over NL = 2 streams each. The CSI
feedback overhead is scaled such as to achieve a sum rate loss of 1.5bits/s/Hz for the
case of SQBC with NR[u, i] = 5. At an SNR of βdB = 0 dB, a feedback overhead of
b = 0bits is required to maintain the intended rate loss, which is increased to b =
17 bits at βdB = 30 dB. The other conﬁgurations considered in Fig.7.2b are simulated
with the same number of feedback bits. It is observed that the actually achieved rate
loss is equal to 1.3bits/s/Hz, which is close to the desired value. With the same
Fig. 7.2 Achievable sum
rate of BD-based
MU-MIMO systems
employing SQBC with
quantized and perfect CSIT
and NT[i] = 6. a NL = 2,
three users and
NR ∈{2, . . . , 5}. b NR = 5,
NL ∈{1, 2, 3} and
S = U = NT[i]
NL
30
27
24
21
18
15
12
9
6
3
0
45
40
35
30
25
20
15
10
5
0
SNR [dB]
SNR [dB]
Achievable sum rate [bits/s/Hz]
1.3
SQBC quant. CSIT 
SQBC perfect CSIT
MET quant. CSIT NR[u,i] = 5
NR[u,i] = 2
NR[u,i] = 4
NR[u,i] = 5
NR[u,i] = 5
NR[u,i] = 4
NR[u,i] = 3
NR[u,i] = 2
R(2,5) 
2
0
3
0
3
6
9
2
1
5
1
8
1
1
2
4
2
7
40
35
30
25
20
15
10
5
0
Achievable sum rate [bits/s/Hz]
SQBC quant. CSIT (scaled bits)
SQBC perfect CSIT
3 streams per user
2 streams per user
1 stream per user
(a)
(b)

158
M. Rupp et al.
feedback overhead a signiﬁcant reduction in throughput is incurred when NR[u, i] is
decreased. This reduction is caused by the increased residual multi-user interference
due to the CSI quantization error. If MET is employed with NR[u, i] = 5 and the same
feedback overhead, a much worse performance compared to SQBC is observed if
βdB > 10 dB. At low SNR, however, SQBC is outperformed by MET, because the
transmission rate is limited by the noise rather than the multi-user interference. In
this case, the interference reduction capabilities of SQBC are outweighed by the
channel gain improvement of MET.
In Fig.7.2b, the performance of SQBC with NT[i] = 6, NR[u, i] = 5 and NL ∈
{1, 2, 3} is shown. The feedback overhead is scaled such as to achieve a sum
rate loss of 2bits/s/Hz with respect to perfect CSIT. This is obtained with an
overhead of b ∈[0, 8] bits/user for NL = 1, b ∈[0, 16.1] bits/user for NL = 2 and
b ∈[0, 18.3] bits/user for NL = 3. With decreasing number of streams NL per user
a sum rate reduction is observed. This is because the interference between a larger
number of users must be canceled by the BD precoder when the number of streams
per user is reduced and the total number of streams is kept constant, leading to an
SNR loss of the effective user channel [18].
Further simulation results investigating the tightness of the proposed bounds on
the rate loss are provided in [2]. A trade-off between SQBC and MET can be achieved
by restricting the SQBC algorithm to ﬁnding the best subspace within only a subset
of the eigenmodes of the channel. This is explained in Sect.7.2 when extending the
method to frequency selective channels.
7.1.5
Adjustment of the Grassmannian CSI Feedback
In Sect.6.2, memoryless and predictive Grassmannian quantization codebooks are
proposed under the assumption that the number of data streams per user ℓk[u, i]
is equal to the number of receive antennas NR[u, i], rendering the application of
an antenna combiner obsolete. In this case, the quantization metric is given by the
chordal distance between the NR[u, i]-dimensional subspace deﬁned by the channel
matrix H(ct)
n,k [u, i] and the NR[u, i]-dimensional subspaces spanned by the elements
Qj of the codebook Qn,k[u, i]; see Eq.(6.19).
With the antenna combiners of the previous section the quantization metric is mod-
iﬁed, which can be considered in correlated RVQ to improve the quantizer efﬁciency.
Speciﬁcally,withSQBCthechordaldistancebetweentheNR[u, i]-dimensionalchan-
nel subspace and each of the ℓk[u, i]-dimensional subspaces deﬁned by the elements
of the codebook is minimized according to Eq.(7.13). The minimum is achieved with
that element of the codebook, that has the smallest left null space component with
respect to the channel matrix. As the null space component of the codebook elements
is the decisive factor during quantization, there exists no preferred subspace orien-
tation within the range space of the channel matrix. Hence, efﬁcient memoryless
quantization is enabled if the quantization codebook is matched to the distribution
of any ℓk[u, i]-dimensional subspace of the channel matrix. With correlated RVQ,

7
Advanced Multi User MIMO Concepts
159
the quantization codebook can be generated according to
Q(SQBC)
n,k
[u, i] =

Q(SQBC)
j
= Q(corr)
j
U|Q(corr)
j
∈Q(corr)
n,k [u, i],
UΣVH = ¯H ∈CNR[u,i]×ℓk[u,i], [ ¯H]m,n ∼NC (0, 1)

.
(7.40)
Here, the codebook deﬁned in (6.29) is employed to obtain semi-unitary matrices
Q(corr)
j
of size NT[i] × NR[u, i] whose span is matched in distribution to the subspace
span
	
H(ct)
n,k [u, i]

. The multiplication with the isotropic semi-unitary matrix U ∈
CNR[u,i]×ℓk[u,i] then generates an orthonormal basis Q(SQBC)
j
that spans a uniformly
distributed subspace within span

Q(corr)
j

.
With MET, the quantization metric (7.33) is determined by the chordal dis-
tance between the subspace spanned by the ℓk[u, i] maximum eigenmodes of the
channel matrix and the elements of the codebook. Efﬁcient memoryless quantization
is hence enabled by matching the quantization codebook to the distribution of these
eigenmodes. This can, e.g., be achieved by modifying the codebook construction
in Sect.6.2.1 to select only the ﬁrst ℓk[u, i] columns of the matrix of left singular
vectors
Q(MET)
n,k
[u, i] =

Q(MET)
j
=

Q(corr)
j

:,1:ℓk[u,i]
Q(corr)
j
∈Q(corr)
n,k [u, i]
 
.
(7.41)
In case of predictive quantization, deriving the tangent statistics when MET or SQBC
is applied was not successful. The tangent codebook is therefore generated assuming
the channel subspace to be uniformly distributed on G (NT[i], ℓk[u, i]). This is not
a critical issue, because the predictive quantizer automatically adjusts to the statis-
tics of the subspace spanned by the effective channel using the adaptive codebook
construction described in Sect.6.2.2.
7.2
Extension to Frequency-Selective Systems
The CSI feedback algorithms and channel subspace selection methods proposed
in Sects.6.2 and 7.1 are derived for frequency ﬂat channels and are hence applicable
to OFDM on a per-subcarrier basis. Providing CSI feedback for each Resource Ele-
ment (RE), however, implies a large feedback overhead, which cannot be sustained in
practical systems. The CSI feedback overhead can be reduced by employing the same
approaches as in Single User Multiple-Input Multiple-Output (SU-MIMO), i.e., CSI
feedback clustering and interpolation. CSI feedback interpolation for ZF and BD
based MU-MIMO is considered, e.g., in [7, 19–21]. Linear subspace interpolation
on the Grassmannian is possible by sampling the geodesic between neighboring CSI
pilots. Geodesic interpolation is reviewed in Sect.7.2.1 for completeness. Higher

160
M. Rupp et al.
order spline interpolation on the unit-sphere has been proposed in [22] in the context
of graphics and animations. These algorithms are applicable to CSI interpolation
for ZF beamforming, but suffer from high computational complexity. An issue of
interpolation based methods is the high density of CSI pilots required to achieve
sufﬁciently accurate results; see Sect.7.2.3. If this cannot be sustained due to limita-
tions on the feedback overhead, better performance is possible with suitable feedback
clustering. To this end, a clustering approach is proposed in Sect.7.2.1, in which a
single representative subspace is determined for each Resource Block (RB) such that
the average chordal distance is minimized. This method can be viewed as a natural
extension of the SQBC idea to multiple REs, providing a signiﬁcant performance
improvement especially in systems with excess antennas. With the SQBC cluster-
ing approach, it is possible to exploit the time-frequency channel correlation within
each RB separately. The residual interference in-between RBs, on the other hand,
is utilized by the predictive quantizer proposed in Sect.6.2.2. Combining the two
methods, efﬁcient CSI quantization is achieved, as demonstrated in Sect.7.2.3.
In Sect.7.2.2, channel quality feedback for transmission rate adaptation and multi-
user scheduling in the space, time and frequency domain is considered. A combina-
tion of the Semi-Orthogonal User Selection (SUS) algorithm [23] with proportional
fair scheduling [24] is employed to determine the multi-user resource allocation. The
scheduling is based on a proposed estimate of the achievable user data rate with BD
precoding. The performance of the proposed techniques is evaluated by means of
simulations in Sect.7.2.3. Notice that the notation introduced for feedback clustering
in Sect.5.2.1 is reused in this section.
7.2.1
Grassmannian Interpolation and Clustering
Geodesic Interpolation
Interpolation on the Grassmannian can be achieved by exploiting the differential
geometry associated with the manifold. The concept of a straight line in the Euclidean
space is generalized to curved spaces and manifolds with the geodesic; see, e.g.,
[1, AppendixC]. Linear interpolation on the manifold is possible by equidistantly
sampling the geodesic between neighbouring CSI pilots.
When CSI interpolation is employed, it is assumed that the OFDM time-frequency
resource grid is partitioned into RBs as visualized in Fig.5.3. With the notation
introduced in Sect.5.2.1, the index pair [η, κ] is employed to indicate the RBs. The
channel matrix observed on the RE in the center of the RB is quantized and fed back
by the users, employing the Grassmannian quantizers of Sect.6.2. The corresponding
subcarrier index and symbol-time index are denoted as
nη = (η −1)N(f )
clust +
!
N(f )
clust
2
"
,
kκ = (κ −1)N(t)
clust +
#
N(t)
clust
2
$
.
(7.42)

7
Advanced Multi User MIMO Concepts
161
The quantized subspace on RB [η, κ] is thus obtained as
ˆHη,κ[u, i] = argmin
Qj∈Qη,κ[u,i]
d2
c
	
˜Hnη,kκ[u, i], Qj

.
(7.43)
Because CSI feedback is provided only once per RB, the quantization codebook
Qη,κ[u, i] is adapted on a per-RB basis. To simplify the exposition, block fading
is considered in this section; hence, the channel is assumed as temporally constant
within each RB. Then 1D interpolation in the frequency domain is sufﬁcient. A
trivial extension to time-frequency selective channels is possible by consecutive
1D interpolation in time and frequency (or vice versa); more sophisticated multi-
dimensional manifold interpolators are proposed in [25].
Considering two neighbouring quantized channel subspaces ˆHη,κ[u, i] as well as
ˆHη+1,κ[u, i], the tangent deﬁning the geodesic is denoted as
Tη,κ[u, i] = T
	
ˆHη,κ[u, i], ˆHη+1,κ[u, i]

∈T
	
ˆHη,κ[u, i]

.
(7.44)
We deﬁne the linearly interpolated subspace between the subspaces span
 ˆHη,κ[u, i]

and span
 ˆHη+1,κ[u, i]

at distance Δf = N(f )
clust p, p ∈[0, 1] from span
 ˆHη,κ[u, i]

via the geodesic Γ (·)
ˆHnη+Δf ,kκ[u, i] = Γ
	
ˆHη,κ[u, i], Tη,κ[u, i], p

,
(7.45)
with N(f )
clust denoting the number of subcarriers in-between ˆHη,κ[u, i] and ˆHη+1,κ[u, i].
At the boundaries of the system bandwidth CSI extrapolation is necessary. Consider-
ing, e.g., the upper boundary, CSI extrapolation is achieved by extending the tangent
between ˆHNRB−1,κ[u, i] and ˆHNRB,κ[u, i] beyond the subcarrier nNRB, using (7.45) with
p > 1.
SQBC Clustering
As an alternative to CSI interpolation, feedback clustering is considered, avoiding the
need for an interpolator at the base station. The clustering approach is suitable when
the distance N(f )
clust between CSI pilots is large compared to the channel coherence
bandwidth, entailing unsatisfactory performance of linear interpolation because of
signiﬁcant channel variations within the RBs. For such situations it is proposed that
the users determine the best ℓκ[u, i]-dimensional subspace representation for each
RB, assuming zeroth-order interpolation. The best subspace representation ˜Hη,κ[u, i]
of RB [η, κ] is deﬁned by minimizing the average chordal distance over the RB
˜Hη,κ[u, i] = argmin
˜H
1
NRE
NRE

ρ=1
d2
c
	
Un,k[u, i], ˜H


162
M. Rupp et al.
= argmin
˜H
1
NRE
NRE

ρ=1
ℓκ[u, i] −tr
	
˜HH
Un,k[u, i]Un,k[u, i]H ˜H

, (7.46)
subject to: ˜H ∈CNT[i]×ℓκ[u,i],
˜HH ˜H = Iℓκ[u,i],
with Un,k[u, i] being obtained from an SVD of the channel matrix as in (7.32),
and the RE index [n, k] being implicitly determined by [η, κ] and ρ as speciﬁed
in(5.13).NoticethesimilarityofthisoptimizationproblemtotheSQBCoptimization
in Eq.(7.13). In fact, (7.46) can be combined with SQBC to not only ﬁnding the best
subspace representation in terms of zeroth-order interpolation, but minimizing both,
the interpolation and the quantization error
ˆHη,κ[u, i] = argmin
Qj
1
NRE
NRE

ρ=1
d2
c

Un,k[u, i], Qj

,
(7.47)
subject to: Qj ∈Qη,κ[u, i] =

Qj ∈CNT[i]×ℓκ[u,i]QH
j Qj = Iℓκ[u,i]

.
The solution to problem (7.46) is obtained according to
˜Hη,κ[u, i] =
 ¯Uη,κ[u, i]

:,1:ℓκ[u,i] = ¯U(ℓκ[u,i])
η,κ
[u, i],
(7.48)
¯Uη,κ[u, i] ¯Λη,κ[u, i] ¯Uη,κ[u, i]H = ¯Rη,κ[u, i],
(7.49)
¯Rη,κ[u, i] =
1
NRE
NRE

ρ=1
Un,k[u, i]Un,k[u, i]H,
(7.50)
with (7.49) denoting an eigendecomposition of ¯Rη,κ[u, i]. Matrix ¯Rη,κ[u, i] can be
interpreted as a subspace correlation matrix. Notice that the eigenvalues in ¯Λη,κ[u, i]
are assumed in decreasing order. Similarly, the solution of (7.47) is determined by
the quantization metric
ˆH(SQBC)
η,κ
[u, i] = argmin
Qj∈Qη,κ[u,i]
ℓκ[u, i] −tr
 ¯Λη,κ[u, i]
 ¯Uη,κ[u, i]HQjQH
j ¯Uη,κ[u, i]

,
Δ= argmin
Qj∈Qη,κ[u,i]
d2
c,w
 ¯Uη,κ[u, i], Qj, ¯Λη,κ[u, i]

,
(7.51)
d2
c,SQBC[η, κ] =
min
Qj∈Qη,κ[u,i] d2
c,w
 ¯Uη,κ[u, i], Qj, ¯Λη,κ[u, i]

.
(7.52)
Here, d2
c,w
 ¯Uη,κ[u, i], Qj, ¯Λη,κ[u, i]

can be viewed as a weighted chordal distance
with weighting matrix ¯Λη,κ[u, i]. The importance of the individual eigenmodes of
the subspace correlation matrix in the quantization metric (7.51) is speciﬁed by the
diagonal weighting matrix.
By applying the SQBC antenna combiner of Sect.7.1.2 to generate the effective
channel on RE [n, k] based on the quantized subspace ˆH(SQBC)
η,κ
[u, i], the quantization
error (7.52) is achieved.

7
Advanced Multi User MIMO Concepts
163
Dimensionality Adaptation
As observed in Sect.7.1.4, SQBC is subject to the problem that all NR[u, i] modes
of the channel matrix H(ct)
n,k [u, i] are equally treated in the quantization metric (7.13),
potentially causing a weak channel gain of the effective channel matrix. This is also
the case with SQBC clustering and its corresponding quantization metric (7.51).
When the transmission is noise limited, rather than interference limited, the effective
channel gain is of greater importance than the CSI quantization error. A trade-off
between MET and SQBC can be achieved by considering only the subset of d max-
imum eigenmodes of the channel during quantization, with ℓκ[u, i] ≤d ≤NR[u, i].
Then, the weighted chordal distance quantization metric (7.51) is replaced with
ˆH(d)
η,κ[u, i] = argmin
Qj∈Qη,κ[u,i]
d2
c,w
	
¯U(d)
η,κ[u, i], Qj, ¯Λ
(d)
η,κ[u, i]

,
(7.53)
¯U(d)
η,κ[u, i] ¯Λ
(d)
η,κ[u, i] ¯U(d)
η,κ[u, i]H = ¯R(d)
η,κ[u, i],
(7.54)
¯R(d)
η,κ[u, i] =
1
NRE
NRE

ρ=1
U(d)
n,k[u, i]U(d)
n,k[u, i]H,
(7.55)
U(d)
n,k[u, i] =

Un,k[u, i]

:,1:d .
(7.56)
With this metric, the best ℓκ[u, i]-dimensional subspace representation in the quanti-
zation codebook Qη,κ[u, i] is determined, with respect to the average chordal distance
to the d maximum eigenmodes of the channel matrices within the RB [η, κ].
The natural question that arises when considering the quantization metric (7.53)
is how to select the dimension d. To answer this question, an estimate of the
pre-equalization achievable data rate with BD precoding and quantized CSIT is
employed. The corresponding pre-equalization input-output relationship is given
in Eq.(1.37). According to [26], the instantaneous mutual information between the
channel input and output, determining the achievable transmission rate, is
R(d)
n,k[u, i] = log2 det
	
INR[u,i]
+ H(ct)
n,k [u, i]HSn,k
[u, i]H(ct)
n,k [u, i]
	
˜σ 2
z INR[u,i] + R(d)
n,k[u, i]

−1 
,
(7.57)
with Sn,k[u, i] denoting the covariance matrix of the channel input and R(d)
n,k[u, i]
being the interference covariance matrix. During the calculation of the CSI feedback,
the precoders are unknown to the users. To determine an estimate of the mutual
information, the precoders are hence considered as random and are taken into account
in the covariance matrices
Sn,k[u, i] = E

Fn,k[u, i]xn,k[u, i](Fn,k[u, i]xn,k[u, i])H
= E

Fn,k[u, i]Fn,k[u, i]H
,
(7.58)

164
M. Rupp et al.
R(d)
n,k[u, i] =
Sn,k[i]

s=1,s̸=u
H(ct)
n,k [u, i]HE

Fs,i[n, k]Fs,i[n, k]H
H(ct)
n,k [u, i],
(7.59)
withtheexpectationbeingtakenwithrespect tothetransmit signals andtheprecoders
and considering the statistical independence of transmit signals corresponding to
different streams and users. The precoder Fn,k[u, i] is determined by the channels
of the other users according to Eq.(6.4). As these channels are unknown to user u,
Fn,k[u, i] is assumed as isotropically distributed, implying
Sn,k[u, i] = Pn,k[u, i] E
	
˜Fn,k[u, i]˜Fn,k[u, i]H
= Pn,k[u, i] ℓκ[u, i]
NT[i] Iℓκ[u,i] =
Pi
NT[i] Sn,k[i] Iℓκ[u,i],
(7.60)
with ˜Fn,k[u, i] as deﬁned in Eq.(6.15). Due to the BD construction, the precoders
Fs,i[n, k] of the other users are restricted to the left null space of ˆH(d)
η,κ[u, i]. Consider-
ing this knowledge in the calculation of R(d)
n,k[u, i] and assuming that Sn,k[i] =
NT[i]
ℓκ[u,i]
users are served in parallel each over ℓκ[u, i] streams, the interference covariance
matrix is obtained as
R(d)
n,k[u, i] =
Pi
NT[i]H(ct)
n,k [u, i]H 	
INR[u,i] −ˆH(d)
η,κ[u, i] ˆH(d)
η,κ[u, i]H
H(ct)
n,k [u, i].
(7.61)
The preferred dimensionality dη,κ[u, i] is selected by maximizing the sum rate
dη,κ[u, i] =
argmax
ℓκ[u,i]≤d≤NR[u,i]
NRE

ρ=1
R(d)
n,k[u, i],
(7.62)
where the RE index [n, k] is implicitly determined by ρ and [η, κ], according
to Eq.(5.13). Notice that knowledge of dη,κ[u, i] is not required at the base station;
hence dimensionality adaptation does not imply an additional feedback overhead.
The sum rate in (7.62) could potentially also be considered as quantization metric
for the channel subspace. This is not followed up here for two reasons. Firstly,
calculating (7.62) for all quantization matrices is computationally expensive. The
second reason is only relevant for predictive quantization. The performance of the
prediction algorithm in the proposed quantizer of Sect.6.2.2 is strongly impacted by
the chordal distance quantization error, because the prediction is based on quantized
CSI. Not choosing the quantized subspace according to the minimal chordal distance
can entail a signiﬁcant degradation of the prediction accuracy.

7
Advanced Multi User MIMO Concepts
165
7.2.2
Channel Quality Feedback and Multi-user Scheduling
CQI Feedback for Limited Feedback BD
To determine the multi-user resource allocation in the time, frequency and spatial
domain, it is necessary to calculate the achievable data rate of a given schedule at the
base station. In the spatial domain this rate is dependent on the number of users that is
served in parallel, because the available transmit power is equally distributed among
users and spatial streams according to Eq.(6.15). Therefore, it must be possible
to update the CQI feedback at the base station to account for the number of users
served in parallel. For this reason, the pre-equalization mutual information estimated
in the previous paragraph in Eq.(7.57) is not employed as channel quality feedback,
because the power allocation is hidden within the log2 det (·) and cannot be updated
subsequently.
The achievable data rate of a realistic communication system is determined by the
post-equalization SINR, as argued in Sect.5.2.2. It is therefore proposed to employ
an estimate of the post-equalization SINR, achieved with limited feedback based BD
precoding, as CQI feedback. An accurate SINR estimate cannot be obtained during
feedback calculation, because the applied precoders are unknown at that time, in
contrast to SU-MIMO with codebook based precoding. To circumvent this problem,
a lower bound on the expected value of the SINR is utilized instead, similar to the
proposal in [27] for ZF beamforming. The derivation of this lower bound is provided
in [1, AppendixG]; the lower bound on the expected SINR of stream ν is expressed as
˜βν,n,k[u, i] =
cS,n,k σ eff
ν,n,k[u, i]2
˜σ 2z + cI,n,k σ eff
ν,n,k[u, i]2 ,
(7.63)
Σeff
u,i[n, k] = diag

σ eff
1,n,k[u, i], . . . , σ eff
ℓ[u,i],n,k[u, i]

,
cS,n,k =
Pi
Sn,k[i](NT[i] −¯ℓi[n, k])·

1−d2
c
 ˆHn,k[u, i], Bn,k[u, i]

ℓk[u, i]
 
1−d2
c
 ˜Hn,k[u, i], ˆHn,k[u, i]

ℓk[u, i]

,
cI,n,k =
Pi
NT[i] ℓk[u, i] d2
c
 ˜Hn,k[u, i], ˆHn,k[u, i]

.
with Σeff
n,k[u, i] denoting the matrix of singular values of the effective user chan-
nel H(ect)
n,k [u, i], ˜Hn,k[u, i] as deﬁned in (6.6), ˆHn,k[u, i] being the quantized channel
subspace, Bn,k[u, i] denoting an orthonormal basis for the orthogonal complement
of the other served users’ effective channels and ¯ℓn,k[i] = %
s∈Sn,k[i],s̸=u ℓk[s, i]. The
residual multi-user interference due to imperfect CSI feedback is determined by the
chordal distance quantization error in cI,n,k, justifying the application of the chordal
distance as CSI quantization metric.
Considering the constant cS,n,k, the ﬁrst two factors cannot be determined by
the user u during feedback calculation, because neither the number of served users

166
M. Rupp et al.
Sn,k[i] nor the number of interfering streams ¯ℓn,k[i] is known, and also the other users’
quantized effective channels are unknown. The last term, however, depending on the
quantization error, can be calculated by the user. Also, the constant cI,n,k and the
singular values in Σeff
n,k[u, i] are available at the user, because they depend on local
CSI only. It is therefore proposed to employ the following value as per-stream CQI
feedback
CQIν,n,k[u, i] =
σ eff
ν,n,k[u, i]2

1 −
d2
c

˜Hn,k[u,i], ˆHn,k[u,i]

ℓk[u,i]

˜σ 2z +
Pi
NT[i] ℓk[u,i] d2c
 ˜Hn,k[u, i], ˆHn,k[u, i]

σ eff
ν,n,k[u, i]2 .
(7.64)
With this CQI feedback, it is possible to obtain an estimate of the achievable user rate
Rn,k[u, i] for a given schedule Sn,k[i], because the remaining two factors of cS,n,k
can be calculated by the base station, enabling the calculation of the SINR
˜βν,n,k[u, i] =
Pi
Sn,k[i](NT[i] −¯ℓn,k[i])

1 −d2
c
 ˆHn,k[u, i], Bn,k[u, i]

ℓk[u, i]

CQIν,n,k[u, i],
(7.65)
Rn,k[u, i] ≈
ℓk[u,i]

ν=1
log2
	
1 + ˜βν,n,k[u, i]

.
(7.66)
In case of feedback clustering or interpolation, CQI feedback is provided only once
per RB. In the proposed SU-MIMO feedback algorithms of Sect.5.2.2, Mutual Infor-
mationEffectiveSignaltoInterferenceandNoiseRatioMapping(MIESM)isapplied
to obtain a single SNR that represent the average channel quality of an RB. This
approach is not applicable here, because the CQI in (7.64) represents only a scaled
version of the SINR (7.63), and MIESM is not a linear function; hence, without
the correct scaling the application of MIESM is pointless. Instead, it is proposed to
calculate an average CQI for RB [η, κ], by linearly averaging the chordal distance
quantization error and the squared singular values
CQIν,η,κ[u, i] =
¯σ eff
ν,η,κ[u, i]2 	
1 −
¯d2
c,η,κ
ℓκ[u,i]

˜σ 2z +
Pi
NT[i] ℓκ[u,i] ¯d2c,η,κ ¯σ eff
ν,η,κ[u, i]2 ,
(7.67)
¯σ eff
ν,η,κ[u, i]2 = 1
NRE
NRE

ρ=1
σ eff
ν,n,k[u, i]2, ¯d2
c,η,κ =
1
NRE
NRE

ρ=1
d2
c
 ˜Hn,k[u, i], ˆHn,k[u, i]

,
with [n, k] being determined by [η, κ] and ρ as speciﬁed in Eq.(5.13).
The performance of the proposed CQI feedback for multi-user scheduling is eval-
uated in Sect.7.2.3, demonstrating reasonably close to optimal results with quantized
CSIT. Notice though that the CQI is not sufﬁciently accurate for transmission rate
adaptation. As the CQI is based on a lower bound on the expected value of the SINR,

7
Advanced Multi User MIMO Concepts
167
the instantaneous SINR achieved with a given schedule can be considerably above
or below this value. It is therefore proposed to employ (7.64) only as an initial CQI
for multi-user scheduling. As soon as the schedule is ﬁxed, the users are able to
estimate the instantaneous SINR deﬁned in (1.44). Using this instantaneous SINR in
combination with the CQI feedback algorithm of Sect.5.2.2, accurate transmission
rate adaptation can be achieved. Naturally this approach is only useful if the sched-
ule is kept ﬁxed for several Transmission Time Intervals (TTIs), implying a loss of
temporal multi-user diversity. However, accounting for the downlink signaling over-
head involved in changing the multi-user resource allocation, the performance loss
is negligible in the considered low to moderate mobility scenarios.
Multi-user Scheduling
The sum throughput achieved with ZF beamforming and BD precoding is very much
dependent on the selected set of users that is served in parallel [23]. If the channels of
the selected users are orthogonal, the signal energy of the user can be steered into the
user’s channel subspace without causing any interference. This effect is also observ-
able in the term cS,n,k of the proposed SINR lower bound in Eq.(7.63): when the chan-
nelsoftheselectedusersareorthogonal,thechordaldistanced2
c
 ˆHn,k[u, i], Bn,k[u, i]

is equal to zero, implying no reduction of the channel gain by the precoder. In prin-
cipal, the schedule can hence be obtained from an exhaustive search employing the
achievable rate (7.66) as the scheduling metric. To avoid the complexity of an exhaus-
tive search, greedy scheduling based on the SUS algorithm is instead considered here.
To achieve some level of fairness among the users in the cell and to avoid user starva-
tion, proportional fairness is utilized as scheduling metric [24]. Scheduling is applied
on an RB basis, due to the availability of RB-speciﬁc CQI feedback. The scheduling
procedure is summarized below for RB [η, κ]; the same approach is applied on all
RBs. To simplify the presentation, it is assumed that ℓη,κ[s, i] = NL, ∀s ∈Ui and that
NT[i]
NL is integer-valued. Otherwise, an explicit validation of the feasibility conditions
of BD precoding must be performed by the scheduler.
1. Initialize the weighted sum rate Rη,κ[i] = 0, the set of scheduled users Sη,κ[i] =
{}, the set of potential users Pη,κ[i] = Ui and the number of scheduled users
Sη,κ[i] = 0.
Repeat the following steps until the maximum number of Sη,κ[i] = NT[i]
NL users is
served:
2. Calculate an orthonormal basis Bη,κ[i] for the space spanned by the channels of
the served users in Sη,κ[i].
3. Find the semi-orthogonal user set
˜
Sη,κ[i], by determining all users s ∈Pη,κ[i]
for which the SUS condition is fulﬁlled:
tr
	
ˆHη,κ[s, i]HBη,κ[i]Bη,κ[i]H ˆHη,κ[s, i]

≤αSUS NL.
(7.68)
4. If the SUS user set is empty, stop the algorithm and serve the users in Sη,κ[i].

168
M. Rupp et al.
5. For all users s ∈
˜
Sη,κ[i], calculate the estimated achievable rate Rη,κ[s, i] in (7.66)
(replacing ˜βν,n,j[s, i] with ˜βν,η,κ[s, i] as obtained from CQIν,η,κ[s, i]) under the
assumption that user s is served in parallel with the users in Sη,κ[i].
6. Determine the user s ∈
˜
Sη,κ[i] that achieves the largest weighted rate
ˆs = argmax
s∈˜
Sη,κ[i]
Rη,κ[s, i]
T[s, i] ,
(7.69)
with T[s, i] denoting the average throughput of user s achieved over the past.
7. Update the estimated achievable rates Rη,κ[s, i] of the users s ∈Sη,κ[i], assuming
that ˆs is served in addition to the users in Sη,κ[i].
8. Calculate the weighted sum rate of the schedule

Sη,κ[i], ˆs

R =

s∈{Sη,κ[i],ˆs}
Rη,κ[s, i]
T[s, i] .
(7.70)
9. If R ≥Rη,κ[i], add user ˆs to Sη,κ[i] and update Sη,κ[i], set Rη,κ[i] = R and remove
ˆs from Pη,κ[i]. Otherwise, stop the algorithm and serve the users in Sη,κ[i]
In step 2 of the scheduling algorithm, a pre-selection of users is performed, based
on their subspace distance to the already served users. Only if a user is close to
orthogonal to the previously served users, he is considered as a potential additional
user. The exact meaning of “close to orthogonal” is determined by the choice of the
SUS parameter αSUS; see [23] for details on the selection of this parameter. In the
presented simulations, the parameter αSUS = 0.35 turned out as a good choice.
7.2.3
Performance Investigation
In this section, the performance of CSI feedback using subspace clustering and inter-
polation for BD precoding based MU-MIMO transmission over a frequency-selective
OFDM broadcast channel is investigated. Monte-Carlo simulations of the quantiza-
tion Mean Square Error (MSE) are conducted and the corresponding throughput
achieved in the downlink of a single Long Term Evolution (LTE) compliant cell
is evaluated. The frequency-selectivity of the wireless channel is characterized by
the coherence bandwidth or equivalently by the Root Mean Square (RMS) delay
spread τRMS of the channel multipath power delay proﬁle. When the sensitivity of
the proposed methods with respect to the frequency-selectivity of the channel is
investigated, the simulation results are presented in dependence of the normalized
sampling bandwidth
Bs = Δfs N(f )
clust τRMS,
(7.71)

7
Advanced Multi User MIMO Concepts
169
with Δfs [Hz] being the OFDM subcarrier spacing (Δfs = 15kHz in case of LTE)
and N(f )
clust denoting the size of a feedback cluster in the frequency domain in multiples
of subcarriers. The advantage of SQBC clustering in terms of the chordal distance
quantization MSE is demonstrated, but also its downside, i.e., the implied channel
gain reduction, is highlighted, which can cause a signiﬁcant throughput degradation,
especially in case of strongly correlated receive antennas. In order to enable efﬁcient
CSI feedback operation, channel prediction, subspace clustering and Grassmannian
quantization are combined at the user. The MSE contribution of the individual com-
ponents is investigated to reveal the corresponding limitations and operating regimes
of the proposed feedback algorithms. Finally, the performance achieved with the
proposed SUS based multi-user scheduler, utilizing the derived CQI feedback, is
evaluated by comparing to the throughput attained with the optimal schedule, as
determined from an exhaustive search.
Chordal Distance MSE Evaluation
In the ﬁrst simulation, the chordal distance MSE obtained with MET subspace selec-
tion, according to Sect.7.1.3, in combination with zeroth- and ﬁrst-order interpola-
tion, as detailed in Sect.7.2.1, is compared to SQBC clustering. The channel matrix is
of size NT[i] × NR[u, i] = 8 × 4, and an ℓ[u, i] = 1-dimensional subspace is selected
as CSI feedback. Unquantized feedback of this representative subspace is consid-
ered; hence the error is caused only by the subspace clustering and the interpolation,
respectively. In case of MET, the maximum eigenmode of the channel matrix expe-
rienced in the center of each RB is used as feedback information, while with SQBC
clustering the subspace feedback is determined by solving the optimization prob-
lem (7.46). The MSE is estimated by means of Monte-Carlo simulations as
D ≈
1
Ntot
1
K
Ntot

n=1
K

k=1
d2
c
	
ˆHn,k[u, i], H(ct)
n,k [u, i]

,
(7.72)
where the interpolated subspace ˆHn,k[u, i] ∈CNT[i]×ℓ[u,i] is obtained from Eq.(7.45)
in case of ﬁrst-order interpolation, while ˆHn,k[u, i] = ˜Hη,κ[u, i] is employed with
zeroth-order interpolation and SQBC clustering ([η, κ] is deﬁned in Eq.(5.14).
The effect of dimensionality adaptation, as deﬁned in Eq.(7.53), on the MSE
performance of SQBC clustering is investigated. A system bandwidth of 5MHz is
assumed and the power delay proﬁle of the channel is determined by the SCME
urban micro channel model [28], having a coherence bandwidth of BC = 680 kHz.
The results of the simulation are shown in Fig.7.3a. Considering MET subspace
selection with CSI interpolation, it is observed that zeroth-order interpolation is
outperformed by ﬁrst-order (linear) geodesic interpolation, as soon as the distance
between the CSI pilots is sufﬁciently small. With SQBC clustering, a substantial
MSE reduction is achieved by increasing the dimensionality d of the optimization
problem (7.53), which determines the subspace selection. Notice that the dimension-
ality d has no impact on the dimension ℓ[u, i] of the subspace feedback; it is rather

170
M. Rupp et al.
Fig. 7.3 Chordal distance
MSE investigation of the
proposed CSI feedback
methods for
frequency-selective
channels. a Comparison of
feedback clustering and
interpolation. b Contribution
of CSI prediction, clustering
and quantization
Normalized sampling bandwidth
Chordal distance MSE
2
10-1
5·10-2
100
100
10-1
10-2
10-3
10-4
clustering
interpolation order 0
interpolation order 1
SQBC dimension 4
SQBC dimension 3
SQBC dimension 2
SQBC dimension 1
MET with interpolation
100
10-1
10-2
10-3
10-1
10-2
10-3
0.5
Normalized Doppler frequency
Chordal distance MSE
quantization
clustering
combination
prediction
20 TTIs
10 TTIs
4TTIs
(a)
(b)
the dimension of the search space in the optimization problem (7.53) that is speciﬁed
with d. Comparing CSI interpolation and clustering, a signiﬁcant MSE improvement
is observed with clustering when a small density of CSI pilots, i.e., a large sampling
bandwidth Bs, is applied. This MSE improvement, however, is obtained at the cost
of a channel gain reduction of the effective channel, causing a throughput loss at low
SNR, as demonstrated below.
In the next simulation, predictive CSI quantization and Grassmannian subspace
clustering are combined to enable efﬁcient limited feedback operation. Additionally,
the effect of a delay in the feedback path is investigated. To compensate for this delay,
Finite Impulse Response (FIR) based channel prediction, as described in Sect.5.3.2,
is employed by the user. Notice that this channel predictor is only required at the
user and not at the base station and it can therefore be based on perfect CSI. Channel
prediction for delay compensation is not related to the operation of the predictive
quantizer; the quantizer is working independently on top of the channel predictor

7
Advanced Multi User MIMO Concepts
171
output. Feedback of an ℓ[u, i] = 2-dimensional subspace of an NT[i] × NR[u, i] =
8 × 2 dimensional channel matrix is considered. The PedA channel model [29], with
BC = 4.4 MHz, is employed and a single feedback cluster is applied to represent
the 1.4 MHz system bandwidth, resulting in a feedback overhead of 7bit per TTI
(7 kbit/s assuming the LTE subframe duration of 1 ms).
The results of the investigation are shown in Fig.7.3b. The individual MSE con-
tributions of the channel prediction, the subspace clustering and the quantization, as
well as the performance of the concatenated system are separately plotted. At low
normalized Doppler frequencies (see (5.35)), i.e., when the channel variation over
time is slow, the overall MSE is dominated by the subspace representation error,
due to feedback clustering. In this case, the adaptive codebook construction of the
predictive quantizer is able to track the channel variation very well, causing a negli-
gible quantization error. A reduction of the observed error ﬂoor is only possible by
reducing the cluster size, implying an increased feedback overhead. At intermediate
Doppler frequencies, the overall MSE is determined by the quantization error. This
error can be reduced by enlarging the quantization codebook, for the cost of increas-
ing the feedback rate. Only at high Doppler frequencies and with a large feedback
delay, the error caused by the channel prediction comes into play. In the region of
interest for predictive quantization (νd ≈10−2), even a feedback delay of 20TTIs
is irrelevant; hence, the feedback delay is not further considered in the remaining
simulations of this chapter.
Throughput Evaluation
Next, the throughput performance of BD based MU-MIMO is investigated, when
the proposed limited feedback algorithms are applied to provide CSIT. In the ﬁrst
simulation, the transmission rate reduction with respect to perfect CSIT, due to the
subspace representation error caused by SQBC clustering, is evaluated, demonstrat-
ing the effect of dimensionality adaptation on the achieved throughput in dependence
of the equivalent average transmit SNR (5.32).
The base station is equipped with NT[i] = 8 transmit antennas; S[i] = 8 users,
having NR[u, i] = 4 receive antennas, are served in parallel, each over a single spatial
stream ℓ[u, i] = 1. The power delay proﬁle of the channel is speciﬁed by the rural
area model [30], which has a coherence bandwidth of BC = 2 MHz. The carrier band-
width of 1.4 MHz is represented with a single CSI feedback cluster, using unquan-
tized CSI feedback. Correlated receive antennas are assumed according to Eq.(5.33)
with αcorr ∈{0, 0.9}. The interference-averaged MMSE equalizer proposed in [4]
is applied by the users to detect their data streams. The throughput simulations are
conducted with the standard compliant Vienna LTE link level simulator [31].
The obtained simulations results are shown in Fig.7.4. At low SNR, the best per-
formance is achieved with a dimensionality of d = 1. With d = 1, only the maximum
eigenmodes of the channels experienced over the subcarriers of an RB are taken into
account for the calculation of the subspace representation according to Eq.(7.53).
The calculated subspace is kept free of interference by the BD precoder; hence, the
interference-free subspace has a potentially large channel gain. Due to clustering,
however, the single subspace representation is imperfect for a given RE, implying

172
M. Rupp et al.
Fig. 7.4 Sum throughput
achieved with ZF
beamforming and SQBC
feedback clustering in an
NT[i] × NR[u, i] = 8 × 4
system, serving S[i] = 8
users over ℓ[u, i] = 1 spatial
stream each. The impact of
dimensionality adaptation is
investigated. a No receive
antenna correlation
αcorr = 0. b Strong receive
antenna correlation
αcorr = 0.9
1
0
2
5
2
0
3
5
3
0
5
0
1
5
27
24
21
18
15
12
9
6
3
0
SNR [dB]
Sum throughput [Mbit/s]
SQBC dim. 1
SQBC dim. 3
SQBC dim. 4
SQBC dim. adaptive
perfect CSIT
1
0
2
5
2
0
3
5
3
0
5
0
1
5
27
24
21
18
15
12
9
6
3
0
SNR [dB]
Sum throughput [Mbit/s]
SQBC dim. adaptive
perfect CSIT
SQBC dim. 1
SQBC dim. 4
SQBC dim. 3
SQBC dim. 2
(a)
(b)
residualmulti-userinterferenceafterprecoding.Therefore,aninterference-limitation
is observed at high SNR. The strength of the residual multi-user interference is
impacted by the dimensionality d of the feedback clustering. By increasing d the
search space for the subspace representation in (7.53) is extended, enabling a reduc-
tion of the chordal distance error, as shown in Fig.7.3a, which implies reduced
residual multi-user interference according to (7.63). The optimal dimensionality is
dependent on the SNR. The proposed dimensionality adaptation (7.62) is able to iden-
tify the optimal dimensionality, as demonstrated in Fig.7.4. Comparing Fig.7.4a, b,
it is observed that the throughput difference between different dimensionalities is
increased with growing antenna correlation. This behavior is due to the increased
singular value spread of the channel matrix with larger αcorr. Notice the similarity
of the performance observed with dimensionality adaptation and with transmission
rank adaptation, as shown in Fig.5.5a. In the current simulations, however, the trans-
mission rank is not changed; the total number of data streams is always equal to
eight.

7
Advanced Multi User MIMO Concepts
173
Fig. 7.5 Sum throughput
achieved with BD precoding
and the proposed limited
feedback clustering and
quantization algorithms in an
NT[i] × NR[u, i] = 8 × 4
system, serving S[i] = 4
users over ℓ[u, i] = 2 spatial
streams each. a MET
feedback with interpolation
versus SQBC clustering. b
Predictive versus
memoryless quantization
1
0
2
5
2
0
3
5
3
0
5
0
1
5
35
30
25
20
15
10
5
0
SNR [dB]
Sum throughput [Mbit/s]
SQBC dim. adaptive
MET interpolation
perfect CSIT
1 cluster
2 clusters
6 clusters
2
0
3
0
3
6
9
2
1
5
1
8
1
1
2
4
2
7
30
27
24
21
18
15
12
9
6
3
0
SNR [dB]
Sum throughput [Mbit/s]
11bit
9bit
11 bit
9 bit
clustering
predictive quant.
perfect CSIT
memoryless quant.
(a)
(b)
In Fig.7.5a, a similar scenario is evaluated where four users are served over
ℓ[u, i] = 2 streams each. The throughput of SQBC clustering with dimensionality
adaptation is compared to MET subspace selection with linear geodesic interpolation.
The number of feedback clusters is varied from NRB = 1 to NRB = 6 and uncorrelated
receive antennas, αcorr = 0, are assumed. It is observed that MET is outperformed
by SQBC at high SNR if the feedback cluster size is large, because the residual
multi-user interference achieved with SQBC is smaller due to the improved subspace
representation. SQBC clustering is never surpassed by MET feedback, not even at
low SNR when the throughput is determined by the effective channel gain, due to
the application of dimensionality adaptation, which trades-off the effective channel
gain for the residual multi-user interference depending on the SNR.
Finally, in Fig.7.5b, the performance of the combination of feedback cluster-
ing and quantization is evaluated. The 1.4 MHz channel generated with the PedA
model [29], assuming strongly correlated receive antennas, αcorr = 0.9, is quantized

174
M. Rupp et al.
with a single feedback cluster. Nine and eleven bit of feedback per TTI are con-
sidered, corresponding to a feedback rate of 9 kbit/s and 11 kbit/s, respectively. A
maximum normalized Doppler frequency of νd = 0.01 is assumed, representing, at
a center frequency of 2 GHz, a walking user with a speed of approximately 5 km/h.
With these parameters, a negligible throughput degradation is caused by the sub-
space clustering, compared to perfect CSIT, up to an SNR of approximately 15dB.
Abovethisvalue,athroughputlossisobserved,duetotheresidualmulti-userinterfer-
ence induced by the frequency selectivity of the channel. When the SQBC subspace
selection is conveyed to the base station by means of predictive quantization, close
to optimal performance is achieved with 11 bit of feedback per TTI over a large SNR
range. Naturally, a throughput deterioration is incurred when the quantization code-
book size is reduced. Considering memoryless quantization, however, the obtained
CSIT accuracy is insufﬁcient to ensure reliable transmission to four users in paral-
lel, each being served over ℓ[u, i] = 2 streams. In this case, better performance is
possible by employing a multi-user scheduler to select only a subset of the users for
transmission, implying reduced multi-user interference.
Multi-user Scheduling
In this section, the efﬁciency of the SUS based greedy multi-user scheduler, proposed
in Sect.7.2.2, is investigated by comparing the achieved sum throughput to the opti-
mal schedule, as obtained from an exhaustive search. Two different antenna conﬁgu-
rations are considered, i.e., NT[i] × NR[u, i] = 4 × 1 and NT[i] × NR[u, i] = 8 × 4.
In the 4 × 1 system, a single stream is transmitted per user, ℓ[u, i] = 1, while with
8 × 4 antennas ℓ[u, i] = 2 streams per user are employed. At most four users can
thus be spatially multiplexed in both cases. The rural area channel model [30] is used
and the antenna correlation parameter αcorr is set equal to zero. In case of imperfect
CSIT, unquantized feedback of a single feedback cluster is considered for the total
system bandwidth of 1.4 MHz using SQBC clustering. All users are simulated with
the same SNR of 20dB.
Fig. 7.6 Performance of the
proposed SUS scheduling
algorithm with perfect and
imperfect CSIT compared to
an exhaustive search. Two
conﬁgurations are
considered:
NT[i] × NR[u, i] = 4 × 1
with ℓ[u, i] = 1 and
NT[i] × NR[u, i] = 8 × 4
with ℓ[u, i] = 2
24
32
40
48
56
64
0
8
16
35
30
25
20
15
10
5
Number of users
Sum throughput [Mbit/s]
8×4 perfect CSIT
4×1 perfect CSIT
8×4 imperfect CSIT
4×1 imperfect CSIT
exhaustive search
greedy scheduling

7
Advanced Multi User MIMO Concepts
175
The simulation results are presented in Fig.7.6, in terms of the sum throughput
achieved in the downlink of the cell versus the number of served users. It can be seen
that a similar multi-user diversity is attained with the exhaustive search scheduler and
the proposed greedy scheduling algorithm, albeit an approximately constant rate loss
that is dependent on the settings of the system. Especially in the realistic situation
of imperfect CSIT, the throughput obtained with the greedy algorithm is close to the
rate achieved with the optimal schedule.
References
1. S.Schwarz,LimitedfeedbacktransceiverdesignfordownlinkMIMOOFDMcellularnetworks.
Ph.D. dissertation, Technische Universität Wien (2013). http://theses.eurasip.org/theses/514/
limited-feedback-transceiver-design-for-downlink/
2. S. Schwarz, M. Rupp, Subspace quantization based combining for limited feedback block-
diagonalization. IEEE Trans. Wirel. Commun. 12(11), 5868–5879 (2013). doi:10.1109/TWC.
2013.093013.130403
3. S. Schwarz, M. Rupp, Evaluation of distributed downlink multi-user MIMO-OFDM with lim-
ited feedback. IEEE Trans. Wirel. Commun. 13(11), 6081–6094 (2014)
4. S. Schwarz, M. Rupp, Antenna combiners for block-diagonalization based multi-user MIMO
with limited feedback, in Proceedings of the IEEE International Conference on Communica-
tions, Workshop Beyond LTE-A. Budapest, Hungary, June 2013
5. S. Schwarz, M. Rupp, Adaptive channel direction quantization based on spherical prediction,
in Proceedings of the IEEE International Conference on Communications, pp. 3757–3762.
Ottawa, Canada, June 2012
6. S. Schwarz, M. Rupp, Adaptive channel direction quantization— enabling multi user MIMO
gains in practice, in Proceedings of the IEEE International Conference on Communications,
pp. 6947–6952. Ottawa, Canada, June 2012
7. S. Schwarz, M. Rupp, Adaptive channel direction quantization for frequency selective channels,
in Proceedings of the 20th European Signal Processing Conference, pp. 2536–2540. Bucarest,
Romania, Aug 2012
8. S. Schwarz, R. Heath Jr., M. Rupp, Multiuser MIMO in distributed antenna systems with
limited feedback, in Proceedings of the IEEE 4th International Workshop on Heterogeneous
and Small Cell Networks, GLOBECOM. Anaheim, CA, Dec 2012
9. S. Schwarz, R. Heath Jr., M. Rupp, Adaptive quantization on the Grassmann-manifold for lim-
ited feedback multi-user MIMO systems, in Proceedings of the 38th International Conference
on Acoustics, Speech and Signal Processing. Vancouver, Canada, May 2013
10. S. Schwarz, R. Heath Jr., M. Rupp, Adaptive quantization on a Grassmann-manifold for limited
feedback beamforming systems. IEEE Trans. Signal Process. 61(18), 4450–4462 (2013)
11. S. Schwarz, R. Heath Jr., M. Rupp, Single-user MIMO versus multi-user MIMO in distributed
antenna systems with limited feedback. EURASIP J. Adv. Signal Process. 2013(54), 1–20
(2013)
12. N. Jindal, MIMO broadcast channels with ﬁnite-rate feedback. IEEE Trans. Inf. Theory 52(11),
5 (2006)
13. N. Ravindran, N. Jindal, Limited feedback-based block diagonalization for the MIMO broad-
cast channel. IEEE J. Sel. Areas Commun. 26(8), 1473–1482 (2008)
14. N. Jindal, Antenna combining for the MIMO downlink channel. IEEE Trans. Wirel. Commun.
7(10), 3834–3844 (2008)
15. W. Dai, Y. Liu, B. Rider, Quantization bounds on Grassmann manifolds and applications to
MIMO communications. IEEE Trans. Inf. Theory 54(3), 1108–1123 (2008)

176
M. Rupp et al.
16. F. Boccardi, H. Huang, A near-optimum technique using linear precoding for the MIMO broad-
cast channel, in Proceedings of the IEEE International Conference on Acoustics, Speech and
Signal Processing, vol. 3, pp. III-17–III-20, April 2007
17. A. Zanella, M. Chiani, The PDF of the lth largest eigenvalue of central Wishart matrices and its
application to the performance analysis of MIMO systems, in Proceedings of the IEEE Global
Telecommunications Conference, pp. 1–6. New Orleans, LA, Dec 2008
18. J. Lee, N. Jindal, High SNR analysis for MIMO broadcast channels: dirty paper coding versus
linear precoding. IEEE Trans. Inf. Theory 53(12), 4787–4792 (2007)
19. T. Li, L. Yang, Z. He, Interpolation-based multiuser precoding for MIMO-OFDM system with
limited feedback, in Proceedings of the International Conference on Neural Networks and
Signal Processing, pp. 205–209 (2008)
20. T. Inoue, R. Heath Jr., Grassmannian predictive frequency domain compression for limited
feedback beamforming, in Proceedings of the Information Theory and Applications Workshop,
pp. 173–177, Feb 2010
21. J. Chang, I. Lu, Y. Li, Adaptive codebook-based channel prediction and interpolation for
multiuser multiple-input multiple-output orthogonal frequency division multiplexing systems.
IET Commun. 6(3), 281–288 (2012)
22. S.R. Buss, J.P. Fillmore, Spherical averages and applications to spherical splines and interpo-
lation. ACM Trans. Graph. 20, 95–126 (2001)
23. T. Yoo, A. Goldsmith, On the optimality of multiantenna broadcast scheduling using zero-
forcing beamforming. IEEE J. Sel. Areas Commun. 24(3), 528–541 (2006)
24. R. Jain, D. Chiu, W. Hawe, A quantitative measure of fairness and discrimination for resource
allocation in shared computer systems. DEC, Technical report TR-301, Sept 1984
25. D.Amsallem,InterpolationonmanifoldsofCFD-basedﬂuidandﬁniteelement-basedstructural
reduced-order models for on-line aeroelastic predictions, Dissertation, Standford University
(2010)
26. R. Blum, MIMO capacity with interference. IEEE J. Sel. Areas Commun. 21(5), 793–801
(2003)
27. M. Trivellato, F. Boccardi, F. Tosate, User selection schemes for MIMO broadcast channels
with limited feedback, in Proceedings of the IEEE 65th Vehicular Technology Conference, pp.
2089–2093. Dublin, Ireland, April 2007
28. D. Baum, J. Hansen, J. Salo, An interim channel model for beyond-3G systems: extending the
3GPP spatial channel model (SCM), in Proceedings of the IEEE 61st Vehicular Technology
Conference, vol. 5, pp. 3132–3136. Stockholm, Sweden (2005)
29. ITU, Recommendation ITU-R M.1225: Guidelines for Evaluation of Radio Transmission Tech-
nologies for IMT-2000, ITU, Technical report (1997)
30. 3GPP, Technical speciﬁcation group radio access networks; Deployment aspects (Release 8),
Dec 2008. http://www.3gpp.org/ftp/Specs/html-info/25943.htm
31. C. Mehlführer, J.C. Ikuno, M. Simko, S. Schwarz, M. Rupp, The Vienna LTE simulators—
enabling reproducibility in wireless communications research. EURASIP J. Adv. Signal
Process., Special issue on reproducible research, 2011(29), 1–14 (2011)

Chapter 8
LTE-Advanced Uplink Transmissions
Stefan Pratschner and Erich Zöchmann
In Long Term Evolution (LTE) uplink transmissions Single-Carrier Frequency
Division Multiplexing (SC-FDM) is employed, mainly to achieve a lower Peak-
to-Average Power Ratio (PAPR) at the transmitting mobile device, when compared
to Orthogonal Frequency Division Multiplexing (OFDM) transmissions. SC-FDM,
however, is essentially OFDM with an additional Discrete Fourier Transform (DFT)
spreading at the transmitter and a de-spreading at the receiver. Employing such
modulation scheme, subcarriers are still orthogonal due to the OFDM processing.
Unlike in pure OFDM transmissions, individual subcarriers cannot be treated inde-
pendently, since each data symbol is spread over all subcarriers by means of a DFT.
Therefore, we present a Multiple-Input Multiple-Output (MIMO) SC-FDM system
model, suitable to describe the Long Term Evolution-Advanced (LTE-A) uplink
link level, together with appropriate Signal to Interference and Noise Ratio (SINR)
expressions. Already at this point, severe differences to the downlink occur in the
post-equalization SINR for Zero Forcing (ZF) and Minimum Mean Square Error
(MMSE) receiver. Due to the spreading of symbols across all subcarriers, the system
performance is dominated by the subcarrier with the lowest channel gain. Employing
an MMSE receiver in SC-FDM is thus even more beneﬁcial.
Similar to downlink transmissions the Modulation and Coding Scheme (MCS)
is adapted to the current channel state by the post-equalization SINR. However, in
uplink transmissions,it turns out that the post-spreading SINR is the relevant metric
to select the optimal Adaptive Modulation and Coding (AMC).
Within this framework, we compare SC-FDM performance to OFDM in terms
of Bit Error Ratio (BER) and PAPR by replacing the spreading and de-spreading
with the identity function. This even allows to compare the achieved throughput as
the system’s overhead is not inﬂuenced. We show that the reduction in PAPR of
S. Pratschner (B) · E. Zöchmann
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: spratsch@nt.tuwien.ac.at
E. Zöchmann
e-mail: ezoechma@nt.tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_8
177

178
S. Pratschner and E. Zöchmann
SC-FDM compared to OFDM transmissions is signiﬁcant, even at a low bandwidth
of 1.4MHz. This, however, comes at the cost of a performance loss, as in an OFDM
transmissions the coded BER is in general lower.
Another aspect of differences between uplink and downlink transmissions is
observed when it comes to Channel Estimation (CE). In both cases, CE for coherent
detection is pilot aided. While the allocation of pilot symbols in the downlink shows a
diamond pattern (see Fig.2.2 in Chap.2), the uplink pilot symbols (see Fig.8.7 further
ahead) are allocated at symbol time n = 3 in each slot, spanning the entire sched-
uled bandwidth range. Also, user speciﬁc reference symbols, required for channel
estimation in the downlink, are multiplexed such that reference symbols of different
spatial transmission layers do not overlap. This allows to estimate all MIMO chan-
nel components separately. The uplink reference symbols, of different transmission
streams, on the other hand, overlap entirely and have to be separated by exploiting
their Frequency Domain Code Division Multiplexing (FD-CDM) orthogonality. Fur-
ther, the non-diamond shaped pilot allocation in the uplink hampers sophisticated
interpolation between the reference symbols. We present well known DFT based CE,
as well as novel estimation methods with improved performance together with time
interpolation methods in the last part of this chapter.
8.1
LTE-Speciﬁc System Model and Post-equalization
SINR
We focus one those details, necessary to describe our system model at time n. In an
SC-FDM model, OFDM tranmissions can be considered a special case. The major
difference is an additional spreading and de-spreading stage at the transmitter and
receiver, highlighted via dashed boxes in Fig.8.1. The common parts of the system
model will be described from left to right. An equivalent mathematical model is
given in Eqs.(8.1) and (8.2).
Fig. 8.1 The LTE-A uplink transceiver

8
LTE-Advanced Uplink Transmissions
179
ˆx =

INL ⊗WH
Nc

G

INR ⊗MHWNFFTPremCP

(receiver)
× H
(channel)
×

INT ⊗PaddCPWH
NFFTM
 
F ⊗INc
 
INL ⊗WNc

x
(transmitter)
+

INL ⊗WH
Nc

G

INR ⊗MHWNFFTPremCP

v



˜v
(transformed noise)
=

INL ⊗WH
Nc




INL Nc
for OFDM
GH(eff) 
INL ⊗WNc




INL Nc
for OFDM
x + ˜v
(8.1)
= Kx + ˜v =
I ⊙Kx
  
desired signal
+
(K −I ⊙K) x



intra- and interlayer interference
+
˜v.
(8.2)
Right after the DFT spreading, the Demodulation Reference Signals (DMRS)
are inserted. DMRS will be considered later for the purpose of CE. Next, MIMO
precoding is carried out, exploiting a set of semi-unitary precoding matrices F, pooled
in the precoder codebook Q, as deﬁned in [1]. For LTE-A uplink transmission, the
precoding matrix applied for a given user is equal for all Resource Block (RB)
assigned to this user. In case of spatial multiplexing, each spatial layer is transmitted
with equal power.
Each antenna is equipped with its own OFDM modulator, consisting of subcarrier
mapping, Inverse Fast Fourier Transform (IFFT) and an Cyclic Preﬁx (CP) addition.
At the transmitter, processing occurs in reversed order. First, the OFDM demodu-
lation by an Fast Fourier Transform (FFT) takes place to get back into the frequency
domain. The immunity to multipath propagation (stemming from the CP) allows to
employ one-tap frequency domain equalizers G ∈CNL Nc×NR Nc without performance
loss. Eventually, de-spreading delivers the data estimates.
All this previously informally described processing is linear and we are able to
formulate a matrix-vector input–output relationship between a (stacked) data-vector
x and its estimate ˆx. For simplicity we assume that the channel stays constant during
one OFDM symbol. A more detailed system description can be found in [2, 3].
In order to adapt the data transmission to the current channel state, LTE-A applies
limited feedback. Limited feedback is depicted via the feedback arrow in Fig.8.1.
The data vector x(l) ∈CNc×1 of layer l ∈{1, . . . , NL} contains modulated and coded
symbols for each of the Nc subcarriers; the modulation format and code rate is
adapted via the Channel Quality Indicator (CQI). The number of transmit layers
depends on the LTE-A speciﬁc Rank Indicator (RI) feedback. All x(l) are stacked
into one vector x ∈CNcNL×1 on which layer-wise spreading and joint precoding—
according to the Precoding Matrix Indicator (PMI)—of all subcarriers takes place.
The subsequent OFDM modulator consists of the localized subcarrier mapping M,
mapping Nc subcarriers to the center of an NFFT point IFFT, and the addition of
the CP.

180
S. Pratschner and E. Zöchmann
Depending on the level of abstraction, our system model can be described via
different channel matrices. The physical baseband time domain channel is described
by a block-wise Toeplitz matrix H ∈C(NFFT+Ncp)NR×(NFFT+Ncp)NT, with NT transmit
and NR receive antennas, which turns block-wise circulant after addition (PaddCP)
and removal (PremCP) of an appropriately chosen CP of length Ncp. Finally, it turns
diagonal after the IFFT and FFT on the transmitter and receiver, respectively.
H(diag) =

INR ⊗WNFFTPremCP

H

INT ⊗PaddCPWH
NFFT

.
(8.3)
The last step of the OFDM de-modulator is the reversal of the localized subcarrier
mapping MH. The effective MIMO channel from NL transmit layers to NR receive
antennas, incorporating the precoder, the OFDM modulator, the time-domain MIMO
channel H and the OFDM de-modulator, is abstracted to one block matrix H(eff). This
greatly facilitates the readability of all formulas later on.
H(eff) =

INR ⊗MH
H(diag)
INT ⊗M

F ⊗INc

(8.4)
The additive noise is assumed independent across antennas and is distributed
zero mean, white Gaussian v(i) ∼NC (0, PVI) , i ∈{1, . . . , NR}. The stacked noise
vector v =

(v(1))T , . . . , (v(NR))T T is thus zero mean, white Gaussian as well.
The frequency domain one-tap equalizer G is chosen conforming to different
criteria, either the ZF criterion, which removes all channel distortions at risk of noise
enhancement, or the MMSE criterion, that tries to minimize the effects of noise
enhancement and channel distortion.
After the de-spreading operation the data estimates ˆx of the noisy, received signal
are given in Eq.(8.2), with the before mentioned convenient abbreviation (8.4) and
WNFFT is the DFT matrix of size NFFT.
8.1.1
Post-spreading SINR in SC-FDM Transmissions
The special structure of Eq.(8.2), due to the frequency domain one tap equalizer and
the DFT spreading, yields a block-wise circulant input–output matrix,
K =

INL ⊗WH
Nc

GH(eff)
INL ⊗WNc

.
(8.5)
This block-wise circulant structure produces a constant post equalization and post
spreading SINR over all subcarriers within one layer l = 1, 2, . . . , NL [3, 4]. The
detailed derivation is provided in the appendix of [5]. We obtain for the SINR

8
LTE-Advanced Uplink Transmissions
181
SINRSC−FDM, (l) =
PS
Nc
1T
Nc S(l)diag

GH(eff) 2
PS∥S(l)GH(eff)∥2
F −PS
Nc
1T
Nc S(l)diag

GH(eff)2 + PV∥S(l)G∥2
F
,
where
S(l) =

0,
INc,
0

,
(8.6)
selects that part of GH(eff), that effects the lth layer. The second moment of the zero-
meandatasymbolsequalsthebasebandtransmitpower PS asLTE-Ahasstandardized
semi-unitary precoders F, so that the overall transmitter (spreading, precoding and
OFDM modulation) is unitary.
8.1.2
Post-equalization SINR in OFDM Transmissions
In contrast to SC-FDM, no spreading takes place for OFDM. The dashed boxes in
Fig.8.1 are replaced by identity matrices; they are thus simply omitted. Different
subcarriers k are orthogonal/independent and the equalizer treats the corresponding
subcarrier channel Hk only. Subscript k denotes the relevant part of the effective
channel matrix H(eff)
k
for the kth subcarrier. The corresponding indexes within diag-
onal matrix H(diag) are 1NR×NT ⊗Diag (ek), with the canonical base vectors ek. With
this notation, the effective subcarrier channel H(eff)
k
∈CNR×NL is
H(eff)
k
=
	
H(diag)
1NR×NT ⊗Diag(ek) F,
(8.7)
and Gk reduces to its linear one tap equalizer. Precoding matrix F remains constant
for all subcarriers. The SINR formula is quite similar to the SC-FDM case, except that
the SINR shows subcarrier dependency now. The SINR takes on a vector dimension
now and reads at layer l and subcarrier k
	
SINROFDM, (l)
k =
PS
s(l) diag (GkHk)
2
PS∥s(l)GkHk∥2
2 −PS
s(l) diag (GkHk)
2 + PV∥s(l)Gk∥2
2
,
with the selection vector
s(l) =
0 . . . 0, 1, 0 . . . 0
,
(8.8)
that contains an appropriate number of zeros and a single one at the lth entry.

182
S. Pratschner and E. Zöchmann
8.2
SC-FDM Features
In this section, the speciﬁc impacts of the single carrier such as the modulation
scheme in the LTE-A uplink will be analyzed. First, the main reason for SC-FDM
employment, namely the PAPR reduction, is discussed. The transmit signal’s PAPR
is simulated for different bandwidths and compared to OFDM. Second, the SINR
expressions are specialized to speciﬁc receiver types both, with DFT spreading and
without DFT spreading. The impacts on the system performance in terms of BER
are discussed.
8.2.1
Peak to Average Power Ratio
SC-FDM is employed as the physical layer modulation scheme for LTE uplink trans-
mission, due to its lower PAPR compared to OFDM [6]. Lower PAPR, or similarly
lower crest factor, leads to reduced linearity requirements for the power ampliﬁers
and to relaxed resolution speciﬁcations for the digital-to-analog converters at the
user equipments, entailing higher power efﬁciency.
The Vienna LTE-A uplink simulator calculates the discrete-time baseband PAPR
with the default oversampling factor No = 4 [7]. The discrete time signal on each of
the NT transmit antennas is therefore calculated as
	
s(tx)
m =
1
√NFFT
NFFT−1

k=0
	
x(pre)
k e j
2πmk
No NFFT ,
0 ≤m ≤NoNFFT −1,
where x(pre) is the transmit vector right after precoding and before the IFFT at each
transmit antenna. The PAPR of the stacked vector s(tx) containing all NT transmit
vectors is calculated as
PAPR{stx} = ∥diag

s(tx)s(tx)H
∥∞
E
	
s(tx)
m
2
≈
∥s(tx)∥2
∞
1
NTNFFT ∥s(tx)∥2
2
,
where the Euclidean norm in the denominator serves as an estimate for the ensemble
average.
Figure8.2 depicts the PAPR of OFDM and SC-FDM obtained for different system
bandwidths. Already for a small bandwidth (1.4MHz), there is a signiﬁcant reduction
for SC-FDM over OFDM transmissions. With increasing bandwidth OFDM’s PAPR
grows and the gains obtained by SC-FDM become more and more pronounced. The
PAPR also depends on the modulation alphabet; the smaller the alphabet, the smaller
the PAPR. This effect is illustrated in dotted lines in Fig.8.2, where we depict the
PAPR of 4-Quadrature Amplitude Modulation (QAM) as an example.

8
LTE-Advanced Uplink Transmissions
183
Fig. 8.2 PAPR for SC-FDM
and OFDM for different
bandwidths (1.4 and
10MHz) and modulation
alphabets (4/64 QAM)
Peak-to-average power ratio [dB]
Probability( PAPR > abscissa)
100
10-1
10-2
10-3
12
11
10
9
8
7
6
5
SC-FDM
OFDM
10MHz
1.4MHz
1.4MHz 4-QAM
8.2.2
BER Comparison Over Frequency Selective Channels
The additional spreading of SC-FDM leads to an SINR expression that is constant
over all subcarriers, legitimating its name. The aim of this subsection is to analyze
the SINR expression more in detail for the Single-Input Single-Output (SISO) case
and draw conclusions on BER performance.
We focus on the two most prominent equalizer concepts and start with the ZF
equalizer, for whom the SC-FDM Signal to Noise Ratio (SNR) expression (8.6)
reduces to the harmonic mean
SNRSC−FDM
ZF
= PS
PV
1
1
Nc
Nc

k=1
1
|hk|2
,
(8.9)
whereas the OFDM expression (8.8) is sub-carrier dependent and becomes propor-
tional to the channel transfer function
	
SNROFDM
ZF

k = PS
PV
|hk|2.
(8.10)
The average OFDM SNR
SNROFDM
ZF
= PS
PV
1
Nc
Nc

k=1
|hk|2
(8.11)
yields an upper bound on the Single-Carrier Frequency Division Multiple Access
(SC-FDMA) SNR due to the harmonic mean—arithmetic mean inequality [8]

184
S. Pratschner and E. Zöchmann
Fig. 8.3 BER comparison
between OFDM and
SC-FDM for a SISO PedB
channel with 5MHz
bandwidth and ﬁxed
CQI = 4 transmission. a ZF
receiver. b MMSE receiver
Average SNR [dB]
BER
100
10-1
10-2
10-4
10-3
35
30
25
20
15
10
5
0
uncoded SC-FDM
uncoded OFDM
coded SC-FDM
coded OFDM
Average SNR [dB]
BER
100
10-1
10-2
10-4
10-3
35
30
25
20
15
10
5
0
uncoded SC-FDM
uncoded OFDM
coded SC-FDM
coded OFDM
uncoded ML bound
(a)
(b)
SNRSC−FDM
ZF
≤SNROFDM
ZF
.
(8.12)
The equality in Eq.(8.12) holds if and only if the channel is frequency ﬂat. The
difference between the harmonic mean and the arithmetic mean becomes increas-
ingly pronounced, the more selective the channel becomes. We, therefore, expect
the (uncoded) BER of SC-FDM and ZF equalization to perform worse than OFDM,
which is well reﬂected by simulation results. The BER simulations were carried
out with CQI = 4 on a PedB channel [9]. This MCS employs 4-QAM and has an
effective code-rate of 0.3008. As expected, the BER performance of SC-FDM is
worse than in OFDM transmissions, both shown in Fig.8.3a in solid lines. Due
to the spreading SC-FDM already expends all channel diversity and coding does
not increase the SNR slope of the BER curve. This manifests in an almost par-
allel shift of the BER curve for SC-FDM, as visual in Fig.8.3a in dashed lines.
While the SC-FDM in the uplink utilizes channel diversity by spreading, in OFDM

8
LTE-Advanced Uplink Transmissions
185
transmissions of the downlink diversity supports coding across subcarriers which
increases the BER slope considerably, cf. Fig.8.3a dashed line. Closed form solu-
tions for the BER achieved with ZF receivers in SC-FDM transmission are presented
in [10].
To obtain the MMSE SINR expression a couple of mathematical transformations,
as provided in the appendix of [5], are required to arrive at
SINRSC−FDM
MMSE
= PS
PV
1 −PV
PS
1
Nc
Nc

k=1
1
PV
PS +|hk|2
1
Nc
Nc

k=1
1
PV
PS +|hk|2
= PS
PV
⎛
⎜⎜⎜⎝
1
1
Nc
Nc

k=1
1
PV
PS +|hk|2
−PV
PS
⎞
⎟⎟⎟⎠.
(8.13)
The denominator of Eq.(8.13) is regularized and less sensitive to spectral notches.
An upper bound on the SINR can be obtained via the maximum of the transfer
function hk
SINRSC−FDM
MMSE
≤PS
PV

1
1
PV
PS +maxk |hk|2
−PV
PS

= PS
PV
max
k
|hk|2.
(8.14)
In the low SNR regime PV
PS ≫|hk|2 this bound becomes tight. The higher the inverse
SNR PV
PS in relation to the maximum of the transfer function, the tighter the bound
becomes. The average OFDM SNR can never be larger than its maximum entry and
is only equal for frequency ﬂat channels. The bound (8.14) is particularly tight at
low SNR causing a lower BER when compared to OFDM transmissions. For the
SISO case, ZF and MMSE equalizers perform equivalent for OFDM and 4-QAM.
Again, this presumption is validated by our simulation, showing that the uncoded
BER is lower for SC-FDM as for OFDM, cf. Fig.8.3b in solid lines. There are
also semi-closed form approximations for the BER of MMSE detection in SC-FDM
transmission available [11]. Although the uncoded BER shows superior performance,
the coded BER is lower for OFDM due to the coding gains stemming from channel
diversity, cf., Fig.8.3b dashed lines.
A bound for the Maximum Likelihood (ML) detection performance was derived
in [12]. As bandwidth increases, the slope of the BER curve achieved with MMSE
receivers reaches to the slope of ML detection, demonstrating the full exploitation
of channel diversity by the MMSE equalizer, cf., Fig.8.3b line.
8.3
Throughput Performance with Link Adaptation
In this section, we ﬁrst investigate the throughput performance of LTE-A uplink
transmissions, employing optimal rate adaptation and compare SC-FDM to OFDM
transmissions with ZF and MMSE receivers. Then, we extend our single-user MIMO

186
S. Pratschner and E. Zöchmann
Channel State Information (CSI) feedback algorithms proposed for LTE downlink
transmissions in [13] to LTE uplink and evaluate their performance comparing to
the throughput bounds developed in [14]. We also highlight some important basic
differences between link adaptation in LTE up- and downlink transmissions.
8.3.1
Optimal Rate Adaptation
As demonstrated in the previous section, SC-FDM provides a signiﬁcant advantage
in terms of PAPR over OFDM, thus relaxing linearity requirements of radio fre-
quency power ampliﬁers for user equipments. Yet, this comes at the cost of coded
BER degradation since channel diversity is not taken advantage of and the perfor-
mance is mostly dominated by the weakest subcarrier of a user, especially with ZF
receivers; cf., (8.9). Such diversity loss cannot be recovered from by forward-error-
correction channel coding since the DFT-spreading applied with SC-FDM effectively
causes an averaging over SINR observed on all scheduled subcarriers according
to (8.6). As a consequence, SC-FDM over frequency selective channels achieves
worse throughput than OFDM transmissions. This is demonstrated in Fig.8.4, where
we cross-compare the achievable rate, as deﬁned in Eqs.(8.15) and (8.16), and the
actual throughput of SC-FDM and OFDM transmission as obtained by the Vienna
LTE-A uplink simulator. We consider single-user transmission over 5MHz band-
width assuming NT = NR = 2 antennas at the user and the base station and NL = 2
spatial layers. The precoder is selected as a scaled identity matrix: F = 1/√NL INL.
We consider transmission over independent and identically distributed frequency-
selective Rayleigh fading channels, emphasizing the difference between OFDM and
SC-FDM. The achievable rate in bits per OFDM/SC-FDM symbol with Gaussian
signalling and equal power allocation over subcarriers and spatial layers is calculated
as
ROFDM =
Nc

k=1
NL

l=1
log2

1 +
	
SINROFDM, (l)
k

,
(8.15)
RSC−FDM = Nc
NL

l=1
log2

1 + SINRSC−FDM, (l)
,
(8.16)
with the receiver-speciﬁc post-de-spreading (post-equalization) SINRs from (8.6)
and (8.8), respectively.
We observe a signiﬁcant loss of achievable rate of SC-FDM transmission com-
pared to OFDM in Fig.8.4, which is especially pronounced with ZF receivers due
to noise enhancement. In Fig.8.4, we also show the actual rate achieved by LTE
uplink SC-FDM transmission with optimal rate adaptation and compare to the per-
formance obtained by OFDM transmission; the corresponding curves are denoted
by LTE rate. We determine the performance of optimal rate adaptation by simulating

8
LTE-Advanced Uplink Transmissions
187
Fig. 8.4 Throughput
comparison of OFDM and
SC-FDM with rate
adaptation and 2 × 2
Rayleigh fading channels of
5MHz bandwidth. a ZF
receivers. b MMSE receivers
Average SNR [dB]
Throughput [Mbit/s]
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
45
40
35
30
25
20
15
10
5
0
OFDM
SC-FDM
achievable rate
LTE rate
rate with fixed CQI (1-15) 
Average SNR [dB]
Throughput [Mbit/s]
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
45
40
35
30
25
20
15
10
5
0
rate with fixed CQI (1-15) 
LTE rate
OFDM
SC-FDM
achievable rate
(a)
(b)
all possible transmission rates, corresponding to CQI1–CQI15, and selecting at each
subframe the largest rate that achieves error free transmission. The ﬁgure also shows
the throughput of the individual CQIs. We observe a gap between the LTE through-
put with OFDM and SC-FDM that is similar to the gap in terms of achievable rate.
Notice that the performance loss with MMSE receivers is signiﬁcantly smaller than
with ZF detection, since MMSE avoids excessive noise enhancement.
We also observe in Fig.8.4a that the gain achieved by instantaneous rate adapta-
tion, as compared to rate adaptation based on the long-term average SNR, is much
larger for ZF SC-FDM than for ZF OFDM; this is evident from the distance between
the curves with rate adaptation (LTE rate) and the curves with ﬁxed CQI. The reason
for this behaviour is that the SNR of ZF SC-FDM shows strong variability around its
means since it is dominated by the worst-case per-subcarrier SNR according to (8.9).
The average SNR over subcarriers of ZF OFDM, however, approximately coincides
with its mean value. This implies that the optimal CQI of ZF SC-FDM can vary

188
S. Pratschner and E. Zöchmann
signiﬁcantly in-between subframes, as reﬂected by the large average SNR variation
required to increase the rate with ﬁxed CQI from zero to its respective maximum. Yet,
for ZF OFDM the throughput of the individual CQIs follows almost a step function;
hence, rate adaptation can be based on the long-term average SNR without substan-
tial performance degradation. Notice, however, that instantaneous rate adaptation for
ZF OFDM can be advantageous in case of frequency-correlated channels [15].
In case NR > NL, we can easily estimate the achievable rate of SC-FDM trans-
mission: The per-layer SNR with ZF receivers is governed by the harmonic mean of
the channel responses on the individual subcarriers, similar to (8.9)
SNRSC−FDM, (l)
ZF
=
PS/PV
1
Nc
Nc
k=1

(HkF)H (HkF)
−1
l,l
,
(8.17)
where Hk ∈CNR×NT denotes the OFDM channel matrix at subcarrier k. Assuming
constant precoding and semi-correlated Rayleigh fading
Hk = ˜HkC
1
2
T ,

˜Hk

i, j ∼NC (0, 1) ,
(8.18)
with CT ∈CNT×NT determining the spatial correlation at the user equipment side, the
matrix in the denominator of (8.17) follows a complex-valued inverse Wishart distri-
bution W C
L (NR, C) with NR degrees of freedom and scale matrix C =

FHCT F
−1
H =

(HkF)H (HkF)
−1 ∼W C
L (NR, C) .
(8.19)
Letting Nc →∞, we can replace the term in the denominator of (8.17) with its
expected value
1
Nc
Nc

k=1
	
H

l,l
Nc→∞
−→E
	
H

l,l

.
(8.20)
This expected value only exists in case NR > NL [16]. For NR = NL, the diagonal
elements of H follow a heavy-tailed inverted Gamma distribution [17, 18] with a
non-ﬁnite ﬁrst moment. Yet, for NR > NL, which is a common situation in cellular
networks since the base station is mostly equipped with far more antennas than the
users, the expected value is ﬁnite and given by
E
	
H

l,l

=
1
NR −NL
[C]l,l .
(8.21)
Hence, we can estimate the achievable rate of SC-FDMA transmission over semi-
correlated Rayleigh fading channels

8
LTE-Advanced Uplink Transmissions
189
RSC−FDM ≈Nc
NL

l=1
log2

1 + PS/PV
[C]l,l
(NR −NL)

(8.22)
≈NcNL
⎡
⎢⎣log2
⎛
⎜⎝
PS/PV
NL
l=1 [C]l,l
1/NL
⎞
⎟⎠+ log2 (NR −NL)
⎤
⎥⎦.
(8.23)
Here (8.23) resembles the high SNR approximation of the achievable rate of OFDM
transmission with ZF detection as proposed in [19, Eq.(14)]; even more, for ﬁxed NL
and letting NR grow to inﬁnity, (8.23) and [19, Eq.(14)] tend to the same limit, due
to channel hardening on each subcarrier with a growing number of receive antennas.
In Fig.8.5, we investigate the performance of the rate estimate (8.22) for NT =
NL = 4 and varying number of receive antennas. We assume F = 1/√NL INL and a
correlation
CT =
⎡
⎢⎢⎢⎢⎣
1 0.9 . . . 0.9
0.9 ...
...
...
0.9
0.9 . . . 0.9 1
⎤
⎥⎥⎥⎥⎦
,
and consider the smallest LTE bandwidth of Nc = 72 subcarriers. We observe that the
proposed estimate performs very well even at this small bandwidth; notice, though,
that a more realistic channel model with correlation over subcarriers may require
larger bandwidth to validate the proposed estimate. Figure8.5 also conﬁrms the
observation that single-user MIMO OFDM and SC-FDM with ZF detectors tend to
the same limiting performance with increasing number of receive antennas.
This statement, however, will not hold true if the total number of layers grows
proportionally with the number of receive antennas. For example, multi-user MIMO
transmission with ZF equalization and single antenna users achieves only a diversity
order of NR −NL + 1 [20], with NL denoting the total number of layers being equal
to the number of spatially multiplexed users. Hence, if NL scales proportionally with
NR, channel hardening on each subcarrier will not occur and thus the performance
of OFDM and SC-FDM will not coincide.
8.3.2
Realistic Link Adaptation
Instantaneous rate adaptation is an important tool for exploiting diversity of the
wireless channel in LTE, by adjusting the transmission rate according to the current
channel quality experienced by a user. LTE speciﬁes a set of ﬁfteen different MCSs;
the selected MCS is signaled by the CQI.
LTE additionally supports spatial link adaptation by means of codebook based
precoding with variable transmission rank. With this method, the precoding matrix

190
S. Pratschner and E. Zöchmann
Fig. 8.5 Achievable rate of
OFDM and SC-FDM with
ZF equalizers and growing
number of receive antennas
at ﬁxed number of streams
NL = 4. a Comparison of
achievable rate and the rate
estimate of Eq.(8.22). b
Relative achievable rate of
SC-FDM with respect to
OFDM
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
45
40
35
30
25
20
15
10
5
0
Average SNR [dB]
Achievable rate [Mbit/s]
4 × 4
5 × 4
8 × 4
16 × 4
64 × 4
OFDM
SC-FDM
SC-FDM estimate
SC-FDM estimate
antenna configuration NR × NT
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
Average SNR [dB]
Relative achievable rate
4 × 4
5 × 4
8 × 4
16 × 4
64 × 4
SC-FDM
SC-FDM estimate
SC-FDM estimate
antenna configuration NR × NT
(a)
(b)
F ∈CNT×NL satisfying FHF = 1/NL INL is selected from a standard deﬁned code-
book QNL of scaled semi-unitary matrices; furthermore, the number of spatial layers
NL can be adjusted to achieve a favorable trade-off between beamforming and spatial
multiplexing. The selected precoder and transmission rank are signaled, employing
thePMIandtheRI.Insingle-userMIMOLTEuplinktransmission,thesameprecoder
is applied on all RBs that are assigned to a speciﬁc user, whereas frequency-selective
precoding is supported in LTE downlink.
There is a basic difference between the utilization of CQI, PMI and RI in up- and
downlink directions of Frequency Division Duplex (FDD) systems. In downlink, the
base station is reliant on CSI feedback from the users for link adaptation and multi-
user scheduling [21], since channel reciprocity cannot be exploited in FDD. CQI,
PMI and RI can be employed to convey such CSI from the users to the base station via
dedicated feedback channels [15]. In the uplink, on the other hand, the base station
can by itself determine the CSI, exploiting the Sounding Reference Signalss (SRSs)

8
LTE-Advanced Uplink Transmissions
191
Fig. 8.6 Absolute and
relative throughput of LTE
uplink transmission over
4 × 4 VehA channels of
1.4MHz bandwidth
employing rate adaptation.
We compare the
performance of ﬁxed rank,
rank adaptive and PMI +
rank adaptive transmission to
the performance bounds
proposed in [14]. a Absolute
throughput. b Relative
throughput
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
20
16
12
8
4
0
Average SNR [dB]
Throughput [Mbit/s]
rank 1
rank 2
rank 3
rank 4
channel capacity 
(excl. guard bands)
achiev. channel capacity
achiev. BICM bound
rank adaptive
PMI and rank adaptive
1
0
2
5
2
0
3
5
3
0
4
0
1
-
5
-
0
5
0
1
5
100
90
80
70
60
50
40
30
20
10
0
Average SNR [dB]
Relative throughput [%]
rank 1
rank 2
rank 3
rank 4
achiev. channel capacity
achiev. BICM bound
rank adaptive
PMI and rank adaptive
(a)
(b)
transmitted by the users. In this case, CQI, PMI and RI are employed by the base
station to convey to the users its decision on link adaptation that has to be applied by
the users during uplink transmission.
In Fig.8.6, we evaluate the performance of single-user MIMO LTE uplink trans-
missions over NT = NR = 4 antennas with link adaptation, 1.4 MHz system band-
width and ZF receiver. We do not consider signaling delays between the base station
and the user. We employ the VehA channel model [9] and compare the absolute and
relative (to channel capacity) throughput to the performance bounds proposed in [14].
Notice that the simulation setup is the same as employed in [14] for the investigation
of LTE downlink transmission, thus, facilitating the comparison of up- and downlink
performance. Channel capacity is obtained by applying Singular Value Decompo-
sition (SVD)-based transceivers and water-ﬁlling power allocation over subcarriers
and spatial streams. Notice that we do not account for guard band and CP overheads
when calculating the channel capacity; that is, we only consider subcarriers that are

192
S. Pratschner and E. Zöchmann
available for data transmission. The achievable channel capacity takes overhead for
pilot symbols (DMRS and SRS) into account, corresponding to a loss of 16.7% in
our simulation. The achievable Bit Interleaved Coded Modulation (BICM) bound
additionally accounts for equal power allocation, codebook-based precoding, ZF
detection as well as the applied BICM architecture as detailed in [14].
The performance of LTE uplink transmissions with full link adaptation (PMI and
rank adaptive) is similar to the achievable BICM bound but shifted by approximately
3dB. Notice that the saturation value is not the same because the highest CQI of LTE
achieves 5.55bit/channel use, whereas the BICM bound saturates at 6bit/channel
use. We also show the performance of LTE uplink when restricted to ﬁxed precoding
(rank adaptive) and ﬁxed rank transmission (rank 1, 2, 3, 4). We observe that rank
adaptive transmission even outperforms the envelope of the ﬁxed rank transmission
curves, since instantaneous rank adaptation selects the optimal rank in each subframe
independently. In terms of relative throughput, we observe that LTE uplink with ZF
receivers achieves around 40–50% of channel capacity. Remember, though, that this
does not include CP and guard band overheads.
8.4
Reference Symbols
In LTE uplink two types of reference signals are standardized. For CE and coher-
ent detection, DMRS are exploited, while SRS are employed for channel sounding
to enable frequency selective scheduling. For the purpose of CE we will consider
DMRS only. The reference symbols are deﬁned in [1] and are explained in more
detail in [22, 23]. As shown in Fig.8.7, DMRSs are multiplexed in the resource grid
at OFDM symbol time n = 3 in every slot. In a Physical Uplink Shared Channel
(PUSCH) transmission of the LTE-A uplink, an DMRS occupies all scheduled sub-
carriers. We assume that the user is assigned all Nc subcarriers starting at 0, i.e.,
k ∈{0, 1, . . . , Nc −1}. We denote the Zadoff-Chu Zadoff-Chu (ZC) base sequence
on Nc subcarriers for one slot by xZ ∈CNc×1. The base sequences xZ are complex-
valued exponential sequences lying on the unit circle fulﬁlling
Fig. 8.7 The LTE-A uplink
reference symbol allocation
in two slots (one subframe)

8
LTE-Advanced Uplink Transmissions
193
|[xZ ]k| = 1.
(8.24)
In LTE-A the DMRS of different transmission layers in the same slot are orthogonal
in terms of FD-CDM [22]. This is obtained by cyclically shifting the base sequence.
Similar to [24], DMRS on layer l for one slot is given by
X(l)
P = Diag

x(l)
P

= T(l)Diag (xZ ) ,
(8.25)
with the cyclic shift operator
T(l) = Diag

e j0, . . . , e jαlk, . . . , e jαl(Nc−1)
,
(8.26)
and the layer dependent cyclic shift αl. We further conclude from (8.24)–(8.26) that
(X(l)
P)H = (X(l)
P)−1 which implies

X(l)
P
HX(l)
P = INc. Exploiting (8.24), the product
of two DMRSs from layers l and u with l, u ∈{1, . . . , NL}, becomes

X(l)
P
HX(u)
P =

T(l)HT(u) Diag (xZ )HDiag (xZ )
= Diag

e j0 . . . e jΔαu,lk . . . e jΔαu,l(Nc−1)
,
(8.27)
with Δαu,l = αu −αl being the cyclic phase shift between DMRS of two different
spatial layers. The FD-CDM orthogonality can therefore be exploited as
tr

X(u)
P
HX(l)
P

=

x(u)
P
Hx(l)
P =
"
Nc
for u = l
0
for u ̸= l.
(8.28)
After the transmission over a frequency selective channel, this orthogonality has to
be exploited to separate all effective MIMO channels at the receiver.
8.5
Channel Estimation
For channel estimation we exploit the system model only at symbol times, where
reference signals are allocated. For normal CP length this is the 4th symbol in each
slot, i.e., n = 3 as shown in Fig.8.7. Since we estimate the channel only at this single
symbol time per slot, interpolation in time has to be carried out to obtain channel
estimates for the whole resource grid. As illustrated in Fig.8.1, the DMRS are added
after DFT spreading, right before precoding. As the channel estimation takes place
after the receiver’s DFT, just before equalization, the system model for CE amounts
to an OFDM system. The system model (8.2) therefore reads as

194
S. Pratschner and E. Zöchmann
y = H(eff)xP + v′,
(8.29)
with (pre-equalization) noise
v′ =

INR ⊗MHWNFFTPremCP

v,
(8.30)
and the stacked vector xP consisting of DMRS x(l)
P ∈CNc×1 from all active spatial
layersl ∈{1, . . . , NL}, i.e., xP =

x(1)
P
T , . . . ,

x(NL)
P
T T . To consider the received
signal separately for each receive antenna i, we can select the according part from
y by left multiplying with the selector matrix S(i) from (8.6). The received signal
y(i) = S(i)y on antenna i is given by
y(i) =

H(eff)
i,1 , . . . , H(eff)
i,NL

xP + v′(i)
=
NL

l=1
H(eff)
i,l x(l)
P + v′(i),
(8.31)
with the pre-equalization noise v′(i) = S(i)v′ on receive antenna i and H(eff)
i,l
=
S(i)H(eff)
S(l)T being the (i,l)th block of H(eff). Since H(eff)
i,l
is diagonal, we exploit
the relations X(l)
P = Diag

x(l)
P

and H(eff)
i,l
= diag

H(eff)
i,l

to estimate a channel vec-
tor rather than a matrix and rearrange terms in (8.31) leading to
y(i) =
NL

l=1
X(l)
PH(eff)
i,l
+ v′(i)
=

X(1)
P, . . . , X(NL)
P




XP
H(eff)
i
+ v′(i),
(8.32)
with the stacked vector H(eff)
i
=

H(eff)
i,1
T , . . . ,

H(eff)
i,NL
T T of all effective channels
from NL active layers to receive antenna i for which we will drop the subscript in
the following.
8.5.1
Minimum Mean Square Error Estimation
First we present a MMSE estimator where we exploit (8.32) and estimate the stacked
vectorh(i) consistingofeffectivechannelsfromall NL activelayerstoreceiveantenna
i. The MMSE CE for receive antenna i is given by
ˆh(i)
MMSE = argmin
ˆh(i)
E
#$$ˆh(i) −h(i)$$2
2
%
,
(8.33)

8
LTE-Advanced Uplink Transmissions
195
which leads to the well-known solution [25]
ˆh(i)
MMSE =

σ 2
v(i)C−1
h(i) + XH
PXP
−1 XH
Py(i),
(8.34)
with Ch(i) = E{h(i)h(i)H}.
8.5.2
Correlation Based Estimation
As a low complexity approach, we correlate (matched ﬁlter) the received signal with
the reference symbol of layer l to obtain a channel estimate for the effective channel
h(i,l) from layer l to receive antenna i
˜h(i,l) =

X(l)
P
Hy(i).
(8.35)
Inserting our system model (8.32) and exploiting (8.27), we obtain
˜h(i,l) =

X(l)
P
H NL
u=1 X(u)
P h(i,u) +

X(l)
P
Hv′(i)
(8.36)
=
h(i,l) +
NL

u=1
u̸=l

T(l)HT(u)h(i,u)



inter-layer interference
+ ˜v(i).
Here ˜v(i) has the same distribution as v′(i) since (X(l)
P)H is unitary and introduces
phase changes only, cf. (8.25). Due to the allocation of DMRS on the same time
and frequency resources on different spatial layers, the initial estimate ˜h(i,l) of one
effective MIMO channel actually consists of a superposition of all NL effective
MIMO channels to receive antenna i. The unintentional contributions in (8.36),
from layers u ̸= l are inter-layer interference, making it unsuited as initial estimate
for coherent detection. Different methods to separate the different effective MIMO
channels in (8.36) will be presented in the following.
8.5.2.1
DFT Based Channel Estimation
A well known approach for CE in LTE-A uplink is DFT based estimation [23], which
aims to separate the MIMO channels contributing to (8.36) in time domain. For this
the individual cyclic shift of each DMRS is exploited. Applying a DFT on the receive
signal, the individual phase shifts will translate into a shifts in time domain. This
makes a separation of Carrier to Interference Ratio (CIR)s from different MIMO
channels possible by windowing. Applying an Inverse Discrete Fourier Transform
(IDFT) on the initial estimate yields

196
S. Pratschner and E. Zöchmann
˜h(i,l)
t
= WH
Nc ˜h(i,l)
= WH
Nc
NL

u=1

T(l)HT(u)WNch(i,u)
t
+ WH
Nc ˜v(i)
=
NL

u=1
ΠΔNh(i,u)
t
+ WH
Nc ˜v(i),
(8.37)
with permutation matrix Π which is obtained by cyclically left shifting the identity
matrix as in [24]. The power of the permutation matrix is ΔN = Δαu,l Nc/2π and
depends on the difference in phase shift between layer u and l from Sect.8.4. The
time domain estimate ˜h(i,l)
t
consists of NL CIRs, from all NL active layers to receive
antenna i. An example of ˜h(i,l)
t
for two active spatial layers is shown in Fig.8.8a with
the two contributing CIRs, h(i,1)
t
from layer one and h(i,2)
t
from layer two. Due to the
cyclic shift of DMRS, these NL contributions are shifted relative to each other such
that the distance in time between them is maximized. The intended CIR, from layer
one, is centered around the origin and can be separated by windowing. In case of
a narrow transmission bandwidth or a long CIR, the time domain MIMO channels
overlap, cf. Fig.8.8b, which is referred to as CIR leakage. DFT based CE there-
fore leads to inferior performance for small scheduled user bandwidths or channels
with high delay spread. To separate the different MIMO channels, windowing with
window size 2β is carried out

ˇh(i,l)
t

m =
"
˜h(i,l)
t

m
for m < β or m > Nc −β
0
otherwise,
(8.38)
where β is chosen to be the CP length Ncp. To yield a frequency domain CE, a DFT
is applied on the separated CIR
ˆh(i,l)
DFT = WNc ˇh(i,l)
t
.
(8.39)
8.5.2.2
Averaging
In the initial estimate (8.36) obtained by correlation, we observe that the interference
term is characterized by (8.27), which is a rotation on the unit circle in the complex
plane. The phase shift between two adjacent points in frequency is determined by
Δαu,l and the number of distinct points on the unit circle is given by γ = 2π/Δαu,l.
As the points are equally spaced on the unit circle, summing (8.27) over a com-
plete turn will cancel the interference. For this we have to sum, or average, over γ
consecutive elements of ˜h(i,l).
The phase shift Δαu,l = αu −αl and therefore the periodicity γ of the interference
is dependent on the two layers u and l. When estimating all MIMO channels, all

8
LTE-Advanced Uplink Transmissions
197
(a)
(b)
Fig. 8.8 Time domain separation of CIRs for DFT based CE with NL = 2. a Nc large compared
to CIR length. b Nc small compared to CIR length
possible combinations of u,l ∈{1, . . . , NL} appear in the interference term of (8.36).
Therefore different values of Δαu,l ∈{0, ±π/2, ±π} will occur. According to [1], a
relation between the possible occurring phase shifts and the number of active spatial
layers can be established. In order to cancel all interference terms at once we have
to sum over the largest possible number of points on the unit circle, i.e., the largest
possibly occurring periodicity which we denote by ¯γ . For a given number of active
streams NL = 1, 2, 3, 4 this largest periodicity equals to ¯γ = 1, 2, 4, 4, respectively.
From this we conclude that the sum of ¯γ consecutive elements in (8.27) will
evaluate to zero, independent on the actual layers u and l. As a consequence for CE,
when we sum (average) the initial estimate (8.36) over ¯γ adjacent subcarriers k, all
products of different (u ̸= l) DMRS will vanish and the FD-CDM orthogonality will
be preserved [26]. For this method however, we have to assume the channel to be
piecewise ﬂat in frequency domain, since only the average channel gain is estimated
for ¯γ consecutive subcarriers.
Within this context, the meaning of FD-CDM orthogonality can be further
explained. DMRS are orthogonal in frequency domain, such that the inner prod-
uct of two reference symbols from different layers is zero, as shown in (8.28). In
terms of correlation based estimation, evaluating this inner product would also can-
cel all the inter-layer interference. However, with this method there would be only
a single estimate of channel gain for all OFDM subcarriers. This estimate is only
a useful one, if the channel is frequency ﬂat. On a frequency selective channel, the
inner product is split up into pieces of length of ¯γ . In this way, still the inter-layer
interference is cancelled and a channel estimate for each part is obtained, representing
the frequency selectivity of the channel.
Further, it sufﬁces to sum over all points of interference on the unit circle while
it actually does not matter where the summation starts and stops. Therefore we can
augment this method to a sliding average. Here, the averaging window of size ¯γ is
shifted subcarrier by subcarrier over the scheduled bandwidth. As explained in [27],
assuming the channel to be frequency ﬂat on these ¯γ consecutive subcarriers, the
sliding average is given by

198
S. Pratschner and E. Zöchmann

ˆh(i,l)
SAV

k = 1
¯γ 2
k

t=k−¯γ +1
t+ ¯γ −1

j=t

˜h(i,l)
j ,
(8.40)
for ¯γ ≤k ≤Nc −¯γ + 1. The second sum describes the averaging of ¯γ elements
while the ﬁrst sum describes the shift of this averaging window.
8.5.2.3
Quadratic Smoothing
The initial correlator estimate solves the decoupled least squares estimation problem
for the channel h(i,l) from layer l to receive antenna i, ignoring the other channels
˜h(i,l) = argmin
h(i,l)
$$y(i) −X(l)
Ph(i,l)$$2
2.
(8.41)
The unitary structure of the DMRS yields
˜h(i,l) =

X(l)
P
HX(l)
P
−1 
X(l)
P
Hy(i)
=

X(l)
P
Hy(i),
(8.42)
which is identical to (8.35). This observation together with the previous assump-
tion of correlated subcarriers leads to the idea of augmenting (8.41) by a frequency
smoothness constraint. Quadratic smoothing [28] with a matrix Q ∈R(Nc−1)×Nc
Q =
⎛
⎜⎜⎜⎝
−1 1
−1 1
... ...
−1 1
⎞
⎟⎟⎟⎠
(8.43)
can be formulated as a convex minimization problem
ˆh(i,l)
QS = argmin
h(i,l)
$$y(i) −X(l)
Ph(i,l)$$2
2 + λ
$$Qh(i,l)$$2
2,
(8.44)
with the known result
ˆh(i,l)
QS =

IB + λQHQ
−1 
X(l)
P
Hy(i)



˜h(i,l)
.
(8.45)
Similar to (8.40) this can be interpreted as another way to cope with the inter-layer
interference in (8.36) by post processing. This method does not use the DMRS
structure explicitly but suppresses the interference by smoothing. It is therefore not
able to cancel the complete inter-layer interference.

8
LTE-Advanced Uplink Transmissions
199
The value of λ can be interpreted as the prior about the channel [29] as it reﬂects
its frequency selectivity. The choice of λ poses another optimization problem where
the optimal value depends on the number of used layers NL. The minimum w.r.t. λ
is rather broad and minima obtained for different channel models lie close to each
other. This allows λ to be ﬁxed for practical realizations such that the matrix inverse
in (8.45) can be precomputed.
8.5.3
MSE and BER Comparison
We assume a single user 2 × 2 MIMO transmission with Nc = 72 subarriers, a ﬁxed
number of layers NL = 2 and a TU channel model [9] at zero speed. We show the
MSE curves of the proposed estimators in Fig.8.9a. The DFT based CE (D-bCE)
Fig. 8.9 Channel estimation
performance comparison for
block fading. a MSE curves
of the proposed CE methods
for a 2 × 2 transmission with
NL = 2 on a TU channel. b
Resulting uncoded BER
curves for the proposed CE
schemes for 4-QAM and ZF
equalization
(a)
(b)

200
S. Pratschner and E. Zöchmann
shows the highest error ﬂow of all estimators at high SNR while the MMSE estimator,
of course shows best performance over the whole SNR range. Compared to these two
methods, the Sliding-Averaging estimator (8.40), denoted by SAV, encounters an 8dB
SNR penalty when compared to MMSE, but comes closest to MMSE performance
at high SNR. The quadratic smoothing estimation is denoted by QS and shows a
signiﬁcant improvement for low SNRs because it smooths over several observed
channel coefﬁcients. Quadratic smoothing performs uniformly better than D-bCE
over the whole SNR range and comes close to 4dB to MMSE at low SNR. The high
error ﬂoor shows that QS is not able to cancel all the inter-layer interference.
In terms of BER performance, at high SNR, naturally the estimation method with
lowest MSE leads to the smallest BER. At low SNR, the difference in CE MSE
translates into very small differences in BER, meaning we cannot gain too much
from a good low SNR MSE performance of QS or MMSE estimation. Considering
estimationcomplexityandthatMMSE aswellasQS requirepriorchannelknowledge,
SAV estimation provides a good complexity performance trade-off.
References
1. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access (E-
UTRA) Physical Channels and Modulation, TS 36.211 (2015)
2. A. Wilzeck, Q. Cai, M. Schiewer, T. Kaiser, Effect of multiple carrier frequency offsets in
MIMO SC-FDMA systems, in Proceedings of the International ITG/IEEE Workshop on Smart
Antennas (2007)
3. E. Zöchmann, S. Pratschner, S. Schwarz, M. Rupp, MIMO transmission over high delay spread
channels with reduced cyclic preﬁx length, in 19th International ITG Workshop on Smart
Antennas (WSA) (2015)
4. E. Zöchmann, S. Pratschner, S. Schwarz, M. Rupp, Limited feedback in OFDM systems for
combating ISI/ICI caused by insufﬁcient cyclic preﬁx length, in Proceedings of the IEEE
Asilomar Conference on Signals, Systems, and Computers (2014)
5. E. Zöchmann, S. Schwarz, S. Pratschner, L. Nagel, M. Lerch, M. Rupp, Exploring the physical
layer frontiers of cellular uplink - the Vienna LTE-A simulator, submitted to Eurasip Journal
on Wireless Communications and Networking (2015). arXiv:1509.02351v1 [cs.IT]
6. H.G. Myung, J. Lim, D. Goodman, Single carrier FDMA for uplink wireless transmission.
IEEE Veh. Technol. Mag. 1(3), 30–38 (2006)
7. T. Jiang, Y. Wu, An overview: peak-to-average power ratio reduction techniques for OFDM
signals. IEEE Trans. Broadcast 54(2), 257 (2008)
8. P.S. Bullen, Handbook of Means and Their Inequalities (Springer Science & Business Media,
Berlin, 2003)
9. Technical Speciﬁcation Group Radio Access Network, Deployment aspects, 3rd Generation
Partnership Project (3GPP). Technical report, TR 25.943 Version 12.0.0 (2014). http://www.
3gpp.org/DynaReport/25943.htm
10. J.J. Sánchez-Sánchez, M. Aguayo-Torres, U. Fernández-Plazaola, BER analysis for zero-
forcing SC-FDMA over Nakagami-m fading channels. IEEE Trans. Veh. Technol. 60(8), 4077–
4081 (2011)
11. J.J. Sánchez-Sánchez, U. Fernández-Plazaola, M.C. Aguayo-Torres, BER analysis for SC-
FDMA over Rayleigh fading channels, in 6th IEEE International Conference on Broadband
and Biomedical Communications (IB2Com) (2011), pp. 43–47

8
LTE-Advanced Uplink Transmissions
201
12. M. Geles, A. Averbuch, O. Amrani, D. Ezri, Performance bounds for maximum likelihood
detection of single carrier FDMA. IEEE Trans. Commun. 60(7), 1945–1952 (2012)
13. S. Schwarz, M. Rupp, Throughput maximizing feedback for MIMO OFDM based wireless
communication systems, in IEEE International Workshop on Signal Processing Advances in
Wireless Communications (SPAWC) (San Francisco, 2011), pp. 316–320
14. S. Schwarz, M. Simko, M. Rupp, On performance bounds for MIMO OFDM based wireless
communication systems, in Signal Processing Advances in Wireless Communications SPAWC
(San Francisco, 2011), pp. 311–315
15. S. Schwarz, C. Mehlführer, M. Rupp, Calculation of the spatial preprocessing and link adaption
feedback for 3GPP UMTS/LTE, in 6th Conference on Wireless Advanced (WiAD) (London,
2010), pp. 1–6
16. D. Maiwald, D. Kraus, Calculation of moments of complex Wishart and complex inverse
Wishart distributed matrices. IEE Proc. Radar Sonar Navig. 147(4), 162–168 (2000)
17. A. Gupta, D. Nagar, Matrix Variate Distributions, vol. 104, Monographs and Surveys in Pure
and Applied Mathematics (Chapman & Hall/CRC, Oregon, 2000)
18. R.Xu,Z.Zhong,J.-M.Chen,B.Ai,Bivariate gamma distributionfromcomplexinverse Wishart
matrix. IEEE Commun. Lett. 13(2), 118–120 (2009)
19. D. Gore, R. Heath, A. Paulraj, Transmit selection in spatial multiplexing systems. IEEE Com-
mun. Lett. 6(11), 491–493 (2002)
20. A. Hedayat, A. Nosratinia, Outage and diversity of linear receivers in ﬂat-fading MIMO chan-
nels. IEEE Trans. Signal Process. 55(12), 5868–5873 (2007)
21. S. Schwarz, C. Mehlführer, M. Rupp, Low complexity approximate maximum throughput
scheduling for LTE, in Conference Record of the Forty Fourth Asilomar Conference on Signals,
Systems, and Computers (Paciﬁc Grove, 2010), pp. 1563–1569
22. X. Hou, Z. Zhang, H. Kayama, DMRS design and channel estimation for LTE-advanced MIMO
uplink, in IEEE 70th Vehicular Technology Conference Fall (VTC 2009-Fall) (2009), pp. 1–5
23. X. Zhang, Y. Li, Optimizing the MIMO channel estimation for LTE-advanced uplink, in Inter-
national Conference on Connected Vehicles and Expo (ICCVE) (2012), pp. 71–76
24. C.-Y. Chen, D. Lin, Channel estimation for LTE and LTE-A MU-MIMO uplink with a nar-
row transmission band, in IEEE International Conference on Acoustics, Speech and Signal
Processing (ICASSP) (2014), pp. 6484–6488
25. S.M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory (Prentice Hall,
Upper Saddle River, 1993)
26. E. Dahlman, S. Parkvall, J. Skold, 4G: LTE/LTE-Advanced for Mobile Broadband (Academic
Press, Waltham, 2013)
27. S. Pratschner, E. Zöchmann, M. Rupp, Low complexity estimation of frequency selective
channels for the LTE-A uplink. IEEE Wirel. Commun. Lett. 4, 673–676 (2015)
28. S. Boyd, L. Vandenberghe, Convex Optimization (Cambridge University Press, Cambridge,
2009)
29. R. Gribonval, Should penalized least squares regression be interpreted as maximum a posteriori
estimation? IEEE Trans. Signal Process. 59(5), 2405–2410 (2011)

Chapter 9
Link Level Measurements
Martin Lerch
Simulators are a powerful tool to evaluate current mobile communications standards
and to investigate new transmission and receiver techniques. The next step should
then be to perform measurements in a real-world environment. Therefore, a very
ﬂexible wireless testbed, the Vienna MIMO Testbed was developed at TU Wien
which allows for Long Term Evolution (LTE) measurements including the Vienna
LTE-A Link Level Simulators as signal source and receiver. In Sect.9.2 we provide
an overview of the Vienna MIMO Testbed and the methodologies to perform LTE
measurements. A measurement campaign that evaluated the impact of the transmit
antenna conﬁguration on the performance of the LTE Downlink (DL) is presented
in Sect.9.3. In order to perform reproducible and fully controllable measurements at
velocities of up to 400 km/h our testbed was extended by an antenna on a rotary unit.
In Sect.9.4, this unit and the corresponding measurement methodology is described
followed by a measurement campaign comparing different channel interpolation
techniques for LTE Uplink (UL) transmissions.
9.1
Introduction
The decades after Marconi’s invention were ﬁlled with wireless experiments.
Although we understand many physical phenomena of wireless propagations today
much better than in the past, our channel models still capture only a part of the
complex physical propagation process. Nevertheless, in the last two decades, it has
become a common method to entirely skip experimental validation and trust existing
channel models when designing mobile communication systems. As the complexity
of mobile communication standards also increases, simulation methods appear to
be the Holy Grail to address open design questions. While these methods deliver
M. Lerch (B)
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mlerch@nt.tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_9
203

204
M. Lerch
quantitative results in acceptable time, many important issues are simpliﬁed or not
modeled at all, trading off timely results against accuracy. Converting new algorith-
mic ideas into hardware on the other hand is quite time consuming and often lacks
ﬂexibility so that experimental evaluation remains no longer an attractive choice.
With our testbed approach [1], we essentially combine the advantages of both worlds:
design ﬂexibility and timeliness under true physical conditions.
Although LTE cellular systems are already being rolled out and operated in many
countries around the world, there are still unresolved issues in transmission tech-
nology. Focusing on point-to-point single-user LTE transmissions, there exist many
open questions that can be best tackled by LTE measurements:
• Performance comparison of different kinds of receivers (receiver algorithms),
• Performance of novel and modiﬁed transmission schemes following the LTE stan-
dard,
• Performance measurements at extreme channels (for example, very high speed)
for which channel models are very crude or even nonexistent,
• Comparison of different penetration scenarios or different antenna conﬁgurations.
9.2
The Vienna MIMO Testbed
Figure9.1 exhibits the main hardware components of the Vienna MIMO Testbed
required to convert a priori generated data into electromagnetic waves, transmit them
over the air and ﬁnally to capture them before storing them in digital form for further
evaluation. The major hardware components are:
• Three rooftop transmitters supporting four antennas each. The digital signal sam-
ples are converted with a precision of 16 bits and are transmitted with adjustable
power within a continuous range of about −35–35dBm per antenna.
• One indoor receiver with four channels that converts the received signals with a
precisionof16bitsbeforetherawsignalsamplesaresavedtoharddisk.Thereceive
consumer PC
consumer PC
control network
rubidium,
clock,
trigger
DAC
RF
software
ampliﬁer
GPS
transmitter
rubidium,
clock,
trigger
ADC
RF
software
GPS
receiver
mobile channel
trigger network
Fig. 9.1 Major components of the Vienna MIMO testbed

9
Link Level Measurements
205
antennas are mounted on a positioning table, which allows for measurements at
different positions within an area of about 1m × 1m, correspondingly 8λ × 8λ.
• The carrier frequency, the sample clock, and the trigger signals are generated
separately at each station utilizing Global Positioning System (GPS) synchronized
rubidium frequency standards. The synchronization of the triggers is based on
exchanging timestamps in the form of User Datagram Protocol (UDP) packets over
a trigger network [2]. The precision of this trigger mechanism does not require any
further post-synchronization at the receiver. It is sufﬁcient to measure the delay
once and time-shift all signals according to the measured delay.
• A dedicated ﬁber-optic network is utilized to exchange synchronization commands
as well as feedback information and general control commands.
The current setup supports a transmission bandwidth of up to 20MHz at a center
frequency of 2.503GHz.
In typical measurements, the transmission of signals generated according to para-
meters of interest, is repeated with different values of transmit power in order to
obtain results for a certain range of Signal to Noise Ratio (SNR). Furthermore, the
transmission of such signals at all values of transmit power is repeated at different
receive antenna positions in order to average over small-scale fading scenarios. As
a rule of thumb, in a typical scenario approximately 30 measurements of different
receive antenna positions are necessary to obtain sound results for an LTE signal with
a 10 MHz bandwidth. In order to check whether we have measured sufﬁcient channel
realizations, we always include BCa bootstrap conﬁdence intervals in our results [3].
While this process is usually the same for different kinds of measurements, they may
differ in the way transmit signals are generated.
As illustrated in Fig.9.2, we distinguish between two different methodologies as
detailed in the following:
testbed
transmitter
transmit
signals
signal
generation
mobile
channel
testbed
receiver
received
signals
post-
processing
results
measurement
ofﬂine
processing
testbed
transmitter
mobile
channel
testbed
receiver
received
signals
feedback
calculation
signal
generation
post-
processing
results
measurement
ofﬂine
processing
(a)
(b)
Fig. 9.2 Methodologies used in LTE measurements: a Brute-force approach. b Measurements with
feedback

206
M. Lerch
• Brute force measurements: All signals of interest are pre-generated, transmitted
over the physical channel, and saved as raw signal samples to hard disk. The
received signals are then evaluated ofﬂine. This approach is only feasible as long
as the time duration of all the different transmit signals is small compared to the
channel variations so that successively transmitted data sets appear to be transmit-
ted over the same channel.
• Measurements with feedback: The transmit signals are generated on the ﬂy uti-
lizing channel state information obtained via a preceding transmission of training
symbols. While the processing and evaluation of the actual data symbols can be
computed ofﬂine, the demodulation of the training symbols, evaluation, and deci-
sion about the generation of the next transmit signal has to be performed in (quasi-)
real time.
While brute force measurements typically take longer than the feedback approach
and the number of different signals that need to be evaluated is much higher, results
obtained by brute force measurements are typically more detailed and are certainly
not contaminated by the quality of the feedback function. If the number of different
transmit signals is not too large, a combination of both methodologies is possible. All
signalsofinterestarepre-generated,butonlythoseafeedbackfunctiondecidesforare
transmitted. This approach reduces the number of signals that have to be evaluated
and signals do not have to be generated during the measurement. Nevertheless, it
should be noted that if the number of possible transmit signals is very large (for
example, zero-forcing Multi-User MIMO or Interference Alignment (IA) [4]), only
a feedback approach is feasible.
9.3
Evaluation of LTE MIMO Downlink Transmissions
In different measurement campaigns using Worldwide Inter-Operability for Micro-
wave Access (WiMAX) [5], High-Speed Downlink Packet Access (HSDPA) [6] and
LTE [7, 8] the impact of the transmit antenna conﬁguration on the performance
of Multiple-Input Multiple-Output (MIMO) transmission modes was investigated.
Besides the transmit antenna conﬁguration, the scenario the measurement was per-
formed in has an impact on the performance. Furthermore, the impact of the antenna
conﬁguration depends on the receive SNR. In typical ﬁeld tests, measurements are
performed in different scenarios where the SNR is set by the actual scenario. Our
approach [9] is different. We ﬁx the scenario and measure over a wide range of
transmit power allowing for deeper insights in the impact of the transmit antenna
conﬁguration on MIMO transmissions. Thereby, we evaluate the performance of the
LTE DL in terms of physical layer throughput on the one hand, and on the other
hand, we evaluate the channel capacity as theoretical performance metric.
Measurement Setup
The measurements were performed in an urban scenario at TU Wien in the city of
Vienna, Austria using the MIMO testbed described in Sect.9.2. The measurement

9
Link Level Measurements
207
d
≈11λ
(a)
antennas
(b)
Fig. 9.3 Measurement setup in downtown Vienna, Austria: a Transmitter: Two separately shiftable
pairs of vertically stacked antennas allow for measurements at vertical and horizontal transmit
antenna conﬁgurations. b Receiver: A laptop carrying the receive antennas can be moved along the
X, Y and Φ axis in order to measure different channel realizations
setup is shown in Fig.9.3 where the transmitter is located outdoors on a rooftop and
serves a single user located indoors in the opposite building. In order to implement
the desired transmit antenna conﬁgurations, we use two pairs of vertically mounted
commercial cross polarized antennas that can be moved separately along a linear
guide. The four output channels of the transmitter are mapped to four out of the
eight antenna elements to transmit with four channels over both, vertically stacked
and horizontally spaced antennas. The receive antennas are two horizontally and two
vertically polarized custom build patch-antennas mounted around the display of a
laptop. This laptop is mounted on a XYΦ positioning table and can so be moved
within an area of about 3 λ × 3 λ as well as rotated within a range of about 210◦.
Measurement Methodology
Measuring at just a single implementation of a transmit antenna conﬁguration neither
allows for a fair comparison of different antenna conﬁgurations nor does it lead to
reproducible results. With our setup, different antenna elements are employed for
different antenna conﬁgurations. For that reason, we repeat transmissions using all
possible implementations of the antenna conﬁgurations under investigation. Then,
as illustrated in Fig.9.4, when averaging the results over all possible implementa-
tions, the same antenna elements are selected for every antenna conﬁguration. Single
antenna results are obtained in a similar way by averaging over the results for all
single transmit antenna elements. Furthermore, the transmit antennas are at differ-
ent positions for different antenna spacings. We, therefore, do not just measure at
a single position of the transmit antennas. For every antenna spacing, we repeat
the measurement at different random positions along the linear guide and average
over the results. At the receiver site, results for different numbers of receive anten-
nas are averaged in a similar way as it is done for the transmit antennas. For 2 × 2

208
M. Lerch
,
,
,
(a)
d
,
d
,
d
,
d
(b)
,
,
,
(c)
d
,
d
,
(d)
Fig. 9.4 Averaging over all possible implementations of an antenna conﬁguration allows for a
fair comparison with other antenna conﬁgurations. Every antenna element is used once for every
conﬁguration: a 2 × 2 cross polarized, b 2 × 2 horizontally spaced, c 2 × 2 vertically spaced and
d 4 × 4 horizontally and vertically spaced
transmissions we average over the results obtained by the ﬁrst two antennas and the
results obtained by the second two antennas. Results for 1 × 1 are averaged over all
four available receive antennas. Furthermore, measurements are repeated at different
XYΦ positions of the receive antennas. Finally, the whole measurement procedure
is repeated for different transmit powers. For the generation of the transmit signals
and the evaluation after the transmission we modiﬁed the Vienna LTE-A Downlink
Link Level Simulator [10] to work with the testbed. Thereby, to keep the number of
different transmit signals low to use the brute-force approach described in Sect.9.2,
we use the open-loop transmit modes of LTE rather than the closed-loop modes. A
summary of all measurement parameters is listed in Table9.1.
Table 9.1 Measurement parameters
System bandwidth
10MHz, scheduled for a single user
Transmission modes
Single antenna, Transmit Diversity (TxD),
Open Loop Spatial Multiplexing (OLSM)
Center frequency
2.503GHz (λ ≈12cm)
Transmit power
−13 . . . 35dBm
Transmit antennas
4 × Kathrein 80010541 cross polarized
Transmit antenna spacings
1.5λ, 5.75λ, 10λ (horizontal)
≈11 λ (vertical)
Transmit antenna polarizations
2 × 2: cross polarized (X-pol), equally
polarized
4 × 4: double cross polarized

9
Link Level Measurements
209
Evaluation
9.3.1
Physical Layer Throughput
By applying the brute-force approach, all possible combinations of Modulation and
Coding Schemes (MCSs) and transmission rank NL = {1, 2, 3, 4} are transmitted and
evaluated independently. Thereby, we obtain for every channel realization r, transmit
power PS and all combinations of the signal parameters MCSs and NL a result in
terms of physical layer throughput Dr (PS, MCS, NL). The average throughput for
a certain antenna conﬁguration is then calculated as the average over all channel
realizations r of the throughput of the respectively best performing combination of
MCS and NL to
D (PS) = 1
R
R

r=1
max
MCS,NL Dr (PS, MCS, NL) .
(9.1)
In order to compare the impact of different antenna conﬁgurations in more detail,
we furthermore evaluate the throughput for a ﬁxed number of spatial streams NL:
DNL (PS) = 1
R
R

r=1
max
MCS Dr (PS, MCS, NL) .
(9.2)
Figure9.5 shows the measurement results for 2 × 2 transmissions when using
equally polarized transmit antennas. If the transmission rank is ﬁxed to NL = 1,
we do not observe a difference between different antenna spacings. That is differ-
ent when transmitting two spatial streams (NL = 2). The higher the spacing, the
higher the measured throughput D2. Furthermore, the average SNR, at which the
two-stream transmission outperforms the single-stream transmission is shifted to
Fig. 9.5 Results for 2 × 2
LTE transmissions: While
the performance of single
stream transmissions is
independent of the antenna
spacing, the throughput
when transmitting two
streams increases with
antenna spacing
-10
-5
0
5
10
15
20
25
30
35
40
0
10
20
30
40
50
60
70
80
90
SNR (dB)
throughput D (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
D1, d=1.5λ
D1, d=10λ
D2, d=1.5λ
D2, d=10λ
D, d=10λ
95% conﬁdence interval
estimated scenario mean

210
M. Lerch
Fig. 9.6 Average
contribution of rank NL
transmissions to the average
throughput when using rank
adaption: a 2 × 2 using
equally polarized antennas
with horizontal spacing of
d = 10 λ. b 4 × 4 double
cross polarized antennas
with horizontal spacing of
d = 10 λ
-10
-5
0
5
10
15
20
25
30
35
40
0
10
20
30
40
50
60
70
80
90
SNR (dB)
throughput D (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
ℓ=1
ℓ=2
-10
-5
0
5
10
15
20
25
30
35
40
0
25
50
75
100
125
150
SNR (dB)
throughput D (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
ℓ=1
ℓ=2
ℓ=3
ℓ=4
(a)
(b)
lower SNRs. The evaluation of D reﬂects the technique of rank adaption. In the
lower SNR regime, the measured throughput is very close to the throughput for
the single-stream transmission. With increasing SNR, the throughput gets close to
the throughput of the two-stream transmission. In the region of moderate SNR, D is
higherthantherespectivethroughputs D1 and D2,asweevaluateaveragethroughputs
and the break-even point in terms of average SNR differs from channel realization
to channel realization. This smooth transition is also shown in Fig.9.6, where the
average contribution of transmissions using NL spatial streams to the average total
throughput is illustrated. The results for all 2 × 2 antenna conﬁgurations when using
rank adaption are given by Fig.9.7. Large differences are only observed at moder-
ate to high SNRs where transmissions with NL = 2 outperform the single-stream
transmissions. Thereby, the throughput increases with antenna spacing d when using
equally polarized transmit antennas. The vertically stacked antennas perform about
as good as the horizontally spaced antennas with spacing d = 10 λ. Cross polarized
transmit antennas outperform all other antenna conﬁgurations. Figure9.8 shows the
results of the 4 × 4 measurements using double cross polarized antennas. As for the

9
Link Level Measurements
211
Fig. 9.7 Results for 2 × 2
LTE transmissions: The best
performance for two antenna
transmissions is observed
when cross polarized
antennas are employed
-10
-5
0
5
10
15
20
25
30
35
40
0
10
20
30
40
50
60
70
80
90
SNR (dB)
throughput D (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
d=1.5λ
d=5.75λ
d=10λ
vertical
X pol
95% conﬁdence interval
estimated scenario mean
Fig. 9.8 Results for 4 × 4
LTE transmissions: The
performance increases with
antenna spacing
-10
-5
0
5
10
15
20
25
30
35
40
0
25
50
75
100
125
150
SNR (dB)
throughput D (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
d=1.5λ
d=5.75λ
d=10λ
vertical
95% conﬁdence interval
estimated scenario mean
2 × 2 case, the performance increases with antenna spacing. The throughput with
vertically stacked antennas is close to the throughput for horizontally spaced antennas
with d = 10 λ.
9.3.2
Channel Capacity
Besides results in terms of throughput, the receiver of the LTE simulator provides
channel estimates for every subframe transmitted. We evaluate the channel capac-
ity [11] as an upper bound for the data rate by these channel estimates Hk measured
at the highest transmit power. For an Orthogonal Frequency Division Multiplexing
(OFDM) transmission with Nc subcarriers, a total channel bandwidth B and NT trans-
mit antennas, the channel capacity C (PS) as a function of the measured channels
Hk, the measured noise power PV and the transmit power PS is given by

212
M. Lerch
C (PS) = B
Nc
Nc

k=1
log2 det

I + 1
NT
PS
PV
HkFkFH
k HH
k

.
(9.3)
Due to the guard band of 1 MHz speciﬁed in the 10 MHz LTE DL, Hk is esti-
mated over a bandwidth of 9 MHz only. Therefore, we extrapolate the results to
the full bandwidth of B = 10 MHz. Thereby, we assume full Channel State Infor-
mation (CSI) at the transmitter and use the waterﬁlling algorithm to calculate the
optimal precoder Fk for every channel realization. The waterﬁlling algorithm dis-
tributes a ﬁxed value of total transmit power to the available layers according to the
eigenvalues λl of HkHH
k . At low SNRs the maximum is achieved by assigning all
power to the strongest eigenvalue. With increasing SNR the number of eigenvalues
increases before the available transmit power is assigned equally to all eigenvalues.
The eigenvalues obtained by the measurement are listed in Table9.2 for 2 × 2 and in
Table9.3 for the 4 × 4 channels. A comparison of channel capacity and LTE phys-
ical layer throughput for three different transmit antenna conﬁgurations for 2 × 2
transmissions is depicted in Fig.9.9. At low SNRs, both, the capacity and the LTE
throughput is independent of the antenna conﬁguration. With increasing SNR, the
differences observed for the LTE throughput become visible for the channel capacity
in a similar way. The same effects are observed when evaluating the eigenvalues in
Table9.2 where the measured eigenvalues are normalized to the strongest eigenvalue
at d = 1.5 λ. Thereby, the strongest eigenvalue λ1 is independent of the transmit
antenna conﬁguration while the second eigenvalue λ2 depends on the antenna con-
ﬁguration. The measured eigenvalues for 4 × 4 are listed in Table9.3 where the two
strongest eigenvalues are quite independent of the antenna conﬁguration. The impact
of the antenna conﬁguration is visible for the two weakest eigenvalues only.
Finally, we were interested in how much of the channel capacity the LTE phys-
ical layer throughput could reach in our measurement. Therefore, we deﬁne the
Table 9.2 Normalized eigenvalues of measured 2 × 2 channels
d=1.5λ (dB)
d=5.75 λ
(dB)
d=10 λ (dB)
Vertical (dB)
X polarized
(dB)
λ1
0.0
0.1
0.0
0.0
−0.27
λ2
−20.2
−16.5
−14.4
−14.7
−10.9
Table 9.3 Normalized eigenvalues of measured 4 × 4 channels
d=1.5 λ (dB)
d=5.75 λ (dB)
d=10 λ (dB)
Vertical (dB)
λ1
0.0
0.2
0.1
−0.1
λ2
−7.6
−7.7
−7.5
−7.5
λ3
−21.0
−17.1
−15.0
−15.4
λ4
−31.0
−26.1
−23.9
−25.6

9
Link Level Measurements
213
Fig. 9.9 Comparison of
channel capacity and LTE
physical layer throughput of
2 × 2 setups for three
different transmit antenna
conﬁgurations
-10
-5
0
5
10
15
20
25
30
35
40
0
50
100
150
200
250
SNR (dB)
throughput D, capacity C (Mbit/s)
10MHz LTE downlink, fc=2.5GHz
d=1.5λ
vertical
X pol
d=1.5λ
vertical
X pol
95% conﬁdence interval
estimated scenario mean
channel capacity C
LTE throughput D
Fig. 9.10 Comparison of
1 × 1, 2 × 2 (cross
polarized) and 4 × 4
(d = 10 λ) in terms of
relative throughput. The LTE
throughput reaches nearly
half of the channel capacity
for 1 × 1 transmissions and
decreases with increasing
number of transmit antennas
-10
-5
0
5
10
15
20
25
30
35
40
0
10
20
30
40
50
60
SNR (dB)
relative throughput D%
10MHz LTE downlink, fc = 2.5GHz
1×1
2×2
4×4
95% conﬁdence interval
estimated scenario mean
relative throughput as the ratio of throughput and capacity: D% (PS) = 100 · D(PS)
C(PS) .
In Fig.9.10 we show a comparison of the respectively best performing antenna con-
ﬁgurations in terms of relative throughput. For all different numbers of transmit
antennas the relative throughput increases with SNR and reaches a maximum as
the maximum data rates deﬁned in the LTE standard are reached. This maximum
decreases with increasing number of transmit antennas as the overhead increases.
9.4
Measurements at High Velocities
LTE is designed to support user velocities of up to 500 km/h whereas mobile com-
munications experiments in high mobility environments such as high speed trains,
motorways or airplanes are expensive and time-consuming. Although such experi-
ments are feasible, they are not well suited to, for example, directly compare dif-
ferent transmission techniques or to measure at different velocities or SNRs. Such

214
M. Lerch
experiments require a fully controllable setup that allows for repeated transmissions
under identical environmental conditions where all parameters are ﬁxed except the
one whose effect is being tested. In order to perform such experiments, the Vienna
MIMOtestbedwas extendedbyantennas onthetipof arotaryunit [12, 13] that allows
for fully controllable and repeatable measurements at velocities of up to 400 km/h.
In this section, we give an overview of this measurement setup before the results of
a measurement campaign comparing different channel interpolation methods for the
LTE UL are presented.
9.4.1
Measurement Setup and Methodology
In our setup, as it is shown in Fig.9.11, repeatable time-variant channels are generated
by rotating the receive antennas around a central pivot. The received signals are then
fed through the rod to rotary joints mounted inside the axis and are connected to
the static receiver hardware of our testbed. A light barrier mounted on the axis
captures the start of each turn of the rotating rod. This signal is connected to the
trigger network of the testbed and triggers the signal transmission. Thereby, signal
transmissions can be triggered at any desired angle of the rotating rod. The light
barrier together with the trigger network allows for repeated transmissions over the
same time-varying channel. Examples when multiple transmissions over the same
channel are needed are:
Δx=3λ
Δy=2.2λ
Δz
receive antennas
light barrier
motor
rail to move the
whole setup
Fig. 9.11 Measurement setup to generate repeatable time-variant channels

9
Link Level Measurements
215
• Measurements at different SNRs. The same signals need to be transmitted with
different transmit powers over the same channel.
• When comparing different transmit signals or transmit modes.
• Brute-force LTE measurements where different signals need to be transmitted over
the same channel.
• Measurements with feedback, if feedback information should be applied to trans-
missions over the same channels to obtain the CSI. For measurements with feed-
back delay the trigger can be delayed according to the desired delay.
• Measurements at different velocities. As the spatial length Δz = T · v of a signal
with a certain temporal length T depends on the velocity v, it is not possible to
transmit the same signal over the same channel at different velocities. Our approach
for a fair comparison at different velocities is illustrated in Fig.9.12. We transmit
n realizations of the transmit signal of interest at the highest velocity. At half the
maximum velocity, we transmit 2n realizations and so forth.
In order to measure different channel realizations within the same scenario, the
whole setup can be moved along the x and y-axis. The area where typical mea-
surements are performed is illustrated by the box in Fig.9.11. While Δx and Δy
are given by mechanical constraints of the setup, Δz = T · v depends on the length
T of the transmit signals and the actual velocity v. Considering measurements at
a velocity of v = 400 km/h and the transmission of single LTE subframes having
a length of T = 1 ms, the length of the path the receive antennas move during the
transmission calculates to Δz ≈11cm. For the rod having a length of 1 m, the length
of the path corresponds to an angle of about 6◦. Figure9.12 illustrates the path of the
receive antennas and the corresponding bending of the path over 1ms when moving
at 400 km/h.
9.4.2
LTE Uplink Fast Fading Channel Interpolation
In the measurement campaign reported in [14] we were interested in the performance
of different channel interpolation techniques for the LTE UL. Compared to the LTE
400km/h
LTE subframe (1 ms, Δz≈11 cm)
trigger point
1 ms
200km/h
1 ms
100km/h
Fig. 9.12 Trajectories of the receive antennas when transmitting LTE subframes. Multiple trans-
missions of the transmit signals at lower velocities allows for transmissions over the same spatial
channels at different velocities

216
M. Lerch
DL, the temporal spacing of the Demodulation Reference Signals (DMRS) in the
UL is about twice the spacing as in the DL. Furthermore, if frequency-hopping is
performed the number of adjacent pilots transmitted in a certain subband is two for
inter-subframe frequency hopping and one for intra-subframe frequency hopping
where frequency hopping is performed on a per-slot basis. Due to this special struc-
ture of pilot symbols, channel estimation in the LTE UL is a challenging problem.
The authors of [15] proposed an interpolation algorithm based on adaptive order
polynomial ﬁtting to mitigate Inter-Carrier Interference (ICI), in [16] the polynomial
basis expansion model is employed and the estimation accuracy is improved by an
autoregressive model. Our idea is to include channel estimates from the previous and
from the subsequent subframe into the process of channel interpolation. The addi-
tional delay that is introduced by applying channel estimates from the subsequent
subframe is not considered.
System Model
We consider continuous single antenna LTE UL transmissions with frequency hop-
ping being disabled. Sounding Reference Signals (SRS) and the Physical Uplink
Control Channel (PUCCH) are both not considered. Figure9.13 illustrates the result-
ing time/frequency resource grid for three consecutive resource blocks that consist
only of data symbols and pilot symbols. At the receiver side we perform a symbol-by-
symbol Least Squares (LS) channel estimation in the frequency domain and calculate
the Zero Forcing (ZF) equalizer by the different interpolation methods under investi-
gation. Although we do not perform frequency hopping, we emulate it by considering
the cases where only one or two pilot symbols are used.
• Average: Averaging the channel estimates from pilot positions p0 and p1. In the
static case this method improves the channel estimation by 3 dB in terms of signal-
to-noise ratio (SNR) but averages over temporal variations in the fast fading case.
p-2
p-1
p0
p1
p2
p3
time
frequency
subframe n
1. slot
2. slot
data symbol
pilot symbol
Fig. 9.13 Resource grid of the LTE uplink. Due to SC-FDMA modulation, symbols marked as
data symbols are the DFT-precoded data symbols rather than the actual data symbols

9
Link Level Measurements
217
• 1 point: Data symbols of slot n are equalized by the channel estimates from pilot
at position pn. This method is applicable in the case of intra-subframe frequency
hopping.
• 2 point linear: Linear interpolation and extrapolation based on the estimates at pilot
position p0 and p1. This method is applicable in the case inter-subframe frequency
hopping is performed but intra-subframe frequency hopping is not activated.
• 4 point linear: Linear interpolation based on the estimates at pilot position p-1, p0,
p1 and p2.
• 4 point spline: Spline interpolation based on the estimates at pilot position p-1, p0,
p1 and p2.
• 6 point spline: Spline interpolation using the estimates from pilot positions p-2 to
p3.
The resulting equalizers are then applied in the frequency domain on the DFT-
precoded data symbols transmitted during subframe n in Fig.9.13. The previous sub-
frame and the subsequent subframe are only considered to obtain additional channel
estimates.
Measurement
Both, the generation of transmit signals and the processing of the received signals is
based on the Vienna LTE-A Uplink Link Level Simulator [17]. In order to measure
the physical layer throughput by the brute-force approach described in Sect.9.2, one
subframe for each of the 15 different MCSs is pre-generated. Every subframe is
repeated three times for transmissions at the maximum velocity of v = 400 km/h
whereas the central subframe n is the subframe to be decoded and the neighboring
subframes n −1 and n + 1 are used to obtain the additional channel estimates. At
half of the maximum velocity (200 km/h) two subframes of interest (n) are trans-
mitted over the desired channel (Δz) and so forth. Figure9.14 illustrates this idea of
transmitting over the same spatial channel at different velocities whereas the number
of subframes considered in the evaluation is given by R (v) = 400
v (Table9.4).
Table 9.4 Measurement parameters.
Center frequency
2.506 GHz (λ ≈12cm)
Velocities
50, 100, 200 and 400 km/h
Channel realizations
49 (within an area of about 3 λ × 2.2λ)
Transmission mode
10 MHz LTE UL, single antenna transmission,
normal cyclic preﬁx, all resources scheduled
for a single user, no SRS, no PUCCH
Modulation and coding
15 different MCSs according to the 15 different
Channel Quality Indicators (CQIs) deﬁned in
the standard
Receiver
Single antenna, LS channel estimation, ZF
equalization

218
M. Lerch
Δz
trigger point
z
subframe n−1
subframe n
subframe n+1
r=1
v = 400km/h
n−1
n
n−1
n+1
n
n+1
r=1
r=2
v = 200km/h
Fig. 9.14 Transmitting over the same spatial channels allows for a fair comparison at different
velocities
Evaluation
As ﬁgure of merit for the comparison of different channel interpolation methods the
physical layer throughput is considered. Furthermore, the SNR as well as the Signal-
to-Interference Ratio (SIR) and the Signal to Interference and Noise Ratio (SINR)
as measures for the amount of ICI are evaluated.
Physical Layer Throughput
By using the brute-force approach perfect knowledge of the best performing MCS is
emulated for every channel realization and every value of transmit power by trans-
mitting all different MCSs over the same channel. The independent evaluation of
all received signals then yields a value of throughput Dm for every combination of
measurement parameters whereas k denotes the channel realization, r being the tem-
poral repetition, v the velocity, PS the transmit power and I the channel interpolation
method. The throughput Dm is maximized over the different MCSs by
Dm (k,r, v, I, PS) = max
MCS Dm (k,r, v, I, PS, MCS)
(9.4)
before the average throughput
D (v, I, PS) = 1
K
1
R (v)
K

k=1
R(v)

r=1
Dm (k,r, v, I, PS)
(9.5)
is obtained by averaging over all K different channel realizations and R (v) temporal
repetitions.
SIR, SINR and SNR
The power of each subcarrier is estimated in the frequency domain whereas we obtain
the signal-plus-interference-plus-noise power PSIN at data subcarrier positions, the
interference-plus-noise power PIN at the DC subcarrier where no data is transmitted

9
Link Level Measurements
219
and the noise power PV by measuring at the same subcarrier positions during a
noise gap when no signal is transmitted. These thereby obtained power estimates are
averaged similar to Eq. (9.5) separately over all channel realizations and temporal
repetitions. PSIN and PIN are furthermore averaged over all different MCSs. The
estimated SIR then calculates to
SIR (v, PS) = PSIN (v, PS) −PIN (v, PS)
PIN (v, PS) −PV (v, PS)
,
(9.6)
the SINR to
SINR (v, PS) = PSIN (v, PS) −PIN (v, PS)
PIN (v, PS)
,
(9.7)
and the SNR to
SNR (v, PS) = PSIN (v, PS) −PIN (v, PS)
PV (v, PS)
.
(9.8)
Results
The conditions in terms of SIR, SINR and SNR under which the measurement was
performed are shown in Fig.9.15. Due to the aforementioned methodology, the SNR
is constant over the whole range of velocities. Comparing the SIR to analytical
results [18], derived for two popular models, shows a higher SIR in our scenario. Both
models, Jakes’ spectrum and the uniform model are based on uniformly distributed
scattering objects which is not the case in our scenario. The SINR is upper bounded
by noise at low velocities and upper bounded by the ICI power at high velocities.
While we observe a large decrease of SINR for increasing velocity at high SNR, the
SINR curve ﬂattens for lower SNRs. The impact of ICI on the throughput becomes
nearly independent of the velocity and the performance is rather determined by noise
and the quality of the channel interpolation method than by ICI.
Fig. 9.15 Channel
conditions under which the
measurement was performed
50
100
150
200
250
300
350
400
20
25
30
35
40
45
velocity (kmh/h)
SIR, SINR, SNR (dB)
10MHz LTE uplink, fc=2.5GHz
measured
Jakes’ model
uniform
SNR≈21dB
SINR
SNR
SIR
SNR≈38dB

220
M. Lerch
Fig. 9.16 Measurement
results comparing different
channel interpolation
methods in terms of
throughput for two different
values of transmit power
resulting in an average SNR
of a ≈38 dB and b ≈21 dB
50
100
150
200
250
300
350
400
0
10
20
30
40
velocity (km/h)
throughput D (Mbit/s)
10MHz LTE uplink, fc=2.5GHz, SNR≈38dB
avg.
1 pt.
2 pt.
4 pt. linear
4 pt. spline
6 pt. spline
95% conﬁdence interval
estimated scenario mean
50
100
150
200
250
300
350
400
0
10
20
30
40
velocity (km/h)
throughput D (Mbit/s)
10MHz LTE uplink, fc=2.5GHz, SNR≈21dB
avg.
1 pt.
2 pt.
4 pt. linear
4 pt. spline
6 pt. spline
95% conﬁdence interval
estimated scenario mean
(a)
(b)
Figure9.16 compares the considered channel interpolation methods in terms of
physical layer throughput for two different values of SNR. As expected, the worst
performance is observed when channel estimates from two pilots are averaged. The
performance increases with the number of pilots in the channel interpolation. The
highest gains at high SNR are observed between 1 point, where no interpolation is
performed and 2 point interpolation and moreover when channel extrapolation in the
2point caseisreplacedbyinterpolationwhenperforming4pointlinear interpolation.
Additional gains are observed when using spline interpolation, especially at high
SNR and high velocities. At lower SNR, spline interpolation outperforms 4 point
linear interpolation only at moderate to high velocities. At low velocities, the gain of
channel estimation SNR becomes visible for the averaging method as it performs as
good as the 2 point method. Furthermore, the throughput ﬂattens at lower SNRs as
the SINR ﬂattens. At low velocities, the throughput is then determined by the SNR.
The impact of the channel interpolation method is still visible at high velocities.

9
Link Level Measurements
221
References
1. M. Lerch, S. Caban, M. Mayer, M. Rupp, The Vienna MIMO testbed: evaluation of future
mobile communication techniques. Intel Technol. J. 18, 58–69 (2014)
2. S. Caban, A. Disslbacher-Fink, J.A. García Naya, M. Rupp, Synchronization of wireless radio
testbedmeasurements,inProceedingsofIEEEInternationalInstrumentationandMeasurement
Technology Conference (I2MTC2011) (2011). doi:10.1109/IMTC.2011.5944089
3. S. Caban, J.A. García Naya, M. Rupp, Measuring the physical layer performance of wireless
communication systems. IEEE Instrum. Meas. Mag. 14(5), 8–17 (2011). doi:10.1109/MIM.
2011.6041377
4. M. Mayer, G. Artner, G. Hannak, M. Lerch, M. Guillaud, Measurement based evaluation of
interference alignment on the Vienna MIMO testbed, in Proceedings of the Tenth International
Symposium on Wireless Communication Systems (ISWCS’13), Ilmenau, 2013
5. S. Caban, J.A. García Naya, L. Castedo, C. Mehlführer, Measuring the inﬂuence of TX antenna
spacing and transmit power on the closed-loop throughput of IEEE 802.16-2004 WiMAX, in
Proceedings of IEEE Instrumentation and Measurement Technology Conference (I2MTC2010),
2010
6. S. Caban, J.A. García Naya, C. Mehlführer, M. Rupp, Measuring the closed-loop throughput
of 2x2 HSDPA over TX power and TX antenna spacing, in Proceedings of 2nd International
Conference on Mobile Lightweight Wireless Systems (Mobilight-2010), 2010
7. K. Werner, J. Furuskog, M. Riback, B. Hagerman, Antenna conﬁgurations for 4x4 MIMO in
LTE—ﬁeld measurements, in 71st IEEE Vehicular Technology Conference (VTC 2010-Spring),
pp. 1–5, 2010. doi:10.1109/VETECS.2010.5493762
8. W. Xie, T. Yang, X. Zhu, F. Yang, Q. Bi, Measurement-based evaluation of vertical separation
MIMO antennas for base station. IEEE Antennas Wirel. Propag. Lett. 11, 415–418 (2012).
doi:10.1109/LAWP.2012.2194688
9. M. Lerch, M. Rupp, Measurement-based evaluation of the lte mimo downlink at different
antenna conﬁgurations, in Proceedings of the 17th International ITG Workshop on Smart
Antennas,WSA 2013, Stuttgart, 2013
10. S. Schwarz, J.C. Ikuno, M. Simko, M. Taranetz, Q. Wang, M. Rupp, Pushing the limits of
LTE: a survey on research enhancing the standard. IEEE Access 1, 51–62 (2013). doi:10.1109/
ACCESS.2013.2260371
11. G. Foschini, M. Gans, On limits of wireless communications in a fading environment
when using multiple antennas. Wirel. Pers. Commun. 6, 311–335 (1998). doi:10.1023/A:
1008889222784
12. S. Caban, J. Rodas, J.A. García-Naya, A methodology for repeatable, off-line, closed-loop
wireless communication system measurements at very high velocities of up to 560 km/h,
in Proceedings of International Instrumentation and Measurement Technology Conference
(I2MTC 2011), Binjiang, 2011. doi:10.1109/IMTC.2011.5944019
13. S.Caban,R.Nissel,M.Lerch,M.Rupp,ControlledOFDMmeasurementsatextremevelocities,
in Proceedings of ExtremeCom’2014, Galapagos Islands, Ecuador, 2014
14. M. Lerch, Experimental comparison of fast-fading channel interpolation methods for the LTE
uplink,inProceedingsofthe57thInternationalSymposiumELMAR-2015,Zadar,2015.doi:10.
1109/ELMAR.2015.7334482
15. B. Karakaya, H. Arslan, H. Cirpan, Channel estimation for LTE Uplink in High Doppler Spread,
in Wireless Communications and Networking Conference (WCNC 2008), pp. 1126–1130, 2008.
doi:10.1109/WCNC.2008.203
16. L. Yang, G. Ren, B. Yang, Z. Qiu, Fast time-varying channel estimation technique for LTE
uplink in HST environment. IEEE Trans. Vehic. Technol. 61(9), 4009–4019 (2012). doi:10.
1109/TVT.2012.2214409
17. J. Blumenstein, J.C. Ikuno, J. Prokopec, M. Rupp, Simulating the long term evolution uplink
physical layer, in Proceedings of the 53rd International Symposium ELMAR-2011, Zadar, 2011
18. P. Robertson, S. Kaiser, The effects of Doppler spreads in OFDM (A) mobile radio systems.
IEEE Vehic. Technol. Conf. Fall 1, 329–333 (1999)

Part II
System Level Simulations
In the second part of the book, the focus is on system level, where performance
evaluation requires to encompass a large number of network elements and upscales
the number of interconnecting links. These have become an indispensable tool for
predicting the behavior of wireless cellular systems [1−3]. The main interest lies in
network-related issues such as resource allocation, mobility management, and
network planning [4−8]. Hence, computational complexity needs to be decreased
substantially in order to make the problem feasible. A widely accepted solution is
the application of link abstraction models that specify the interaction between link-
and system level simulators [2]. This approach is expected to persist in simulation
tools for the ﬁfth generation of wireless cellular networks (5G) [9].
Exhaustive simulations enable to study any scenario at any desired depth of
detail. On the other hand, this requires to run a separate simulation for every setup
and each choice of parameters. As an example, in a heterogeneous cellular network,
the amount of combinations of deployment parameters rises exponentially with the
number of network tiers. Hence, it is expedient to use insights from analytical
models to shrink the search space, and to run targeted simulations. Results from
theory provide overall insights without misinterpreting or being biased by any
speciﬁc scenario.
Current analytical models for system level evaluation of mobile cellular net-
works focus on an accurate statistical description of the aggregate interference, i.e.,
the cumulative impact from all co-channel interferers, as it is one of the main
performance limiting factors [10]. The two key interference-shaping factors are the
spatial distribution of concurrently transmitting BS and the path losses, which
encompass signal attenuation by distance and fading [10−15].
Tractable interference statistics have mainly been reported in the ﬁeld of
stochastic geometry. This powerful mathematical framework recently gained
momentum as the only available tool that provides a rigorous approach to mod-
eling, analysis, and design of networks with a substantial amount of nodes per unit
area [10−12, 15−26]. When closed-form expressions are desired, it imposes its own
particular limitations, typically including spatial stationarity and isotropy of the

scenario [10, 15, 27]. Hence, the potential to consider an asymmetric interference
impact is very limited and notions such as cell-center and cell-edge are, in general,
not accessible.
The second part of this book places particular emphasis on system models of low
complexity that enable to analytically evaluate interference statistics of arbitrary
interferer topologies at any desired user location. The second major focus is on a
systematic and reproducible simulation methodology.
This part is organized as follows. First, basic concepts of system level simula-
tions
are
explained
in
Chap.
10.
Moreover,
advanced
features
such
as
runtime-precoding and 3D channel modeling are introduced. In Chaps. 11−13, two
circular as well as a stochastic interference model are presented that enable to
analytically predict system level performance. Their applicability against LTEA
system level simulations is validated. Chapter 14 provides a systematic and
reproducible simulation methodology for evaluating two-tier heterogeneous cellular
networks. Advanced system level applications are presented in Chap. 15.
References
[1] L. Chen, W. Chen, B. Wang, X. Zhang, H. Chen, D. Yang, System-level simulation
methodology and platform for mobile cellular systems. IEEE Commun. Mag. 49(7), 148–155
(2011). doi:10.1109/MCOM.2011.5936168
[2] S. Ahmadi, LTE-Advanced: A Practical Systems Approach to Understanding 3GPP LTE
Releases 10 and 11 Radio Access Technologies, ser. ITPro collection. (Elsevier Science,
2013)
[3] J.C. Ikuno, M. Wrulich, M. Rupp, System level simulation of LTE networks, in IEEE
Vehicular Technology Conference (VTC Spring). Taipei, Taiwan, (2010)
[4] Y. Gao, Y. Li, H. Yu, S. Gao, Performance of dynamic comp cell selection in 3gpp lte system
level simulation, in IEEE International Conference Communications Software and Networks
(ICCSN), pp. 210–213. Xi'an, China, (2011). doi:10.1109/ICCSN.2011.6013577
[5] D. Jiang, H. Wang, E. Malkamaki, E. Tuomaala, Principle and performance of
semi-persistent scheduling for VoIP in LTE system, in International Conference Wireless
Communication Networking and Mobile Computing (WiCom), pp. 2861–2864. Shanghai,
China, ( 2007). doi:10.1109/WICOM.2007.710
[6] O. Yilmaz, S. Hamalainen, J. Hamalainen, System level analysis of vertical sectorization for
3GPP LTE, in International Symposium Wireless Communication System (ISWCS), pp. 453–
457. Tuscany, Italy, ( 2009). doi:10.1109/ISWCS.2009.5285317
[7] M. Sawahashi, Y. Kishiyama, A. Morimoto, D. Nishikawa, M. Tanno, Coordinated
multipoint transmission/reception techniques for LTE-advanced [coordinated and distributed
MIMO]. IEEE Wirel. Commun. 17(3), 26–34, (2010). doi:10.1109/MWC.2010.5490976
[8] K. Kusume, G. Dietl, T. Abe, H. Taoka, S. Nagata, System level performance of downlink
MU-MIMO transmission for 3GPP LTE-Advanced, in IEEE Vehicular Technology
Conference (VTC), pp. 1–5. Taipei, Taiwan, (2010). doi:10.1109/VETECS.2010.5493979
[9] Y. Wang, J. Xu, L. Jiang, Challenges of system-level simulations and performance
evaluation for 5G wireless networks, IEEE Access, 2, 1553–1561 (2014). doi:10.1109/
ACCESS.2014.2383833
[10] M. Haenggi, R.K. Ganti, Interference in Large Wireless Networks, ser. Foundations and
Trends in Networking. 1em plus 0.5em minus 0.4em NoW Publishers, vol. 3, (2009)
224
Part II:
System Level Simulations

[11] J. Andrews, R. Ganti, M. Haenggi, N. Jindal, S. Weber, A primer on spatial modeling and
analysis in wireless networks, IEEE Commun. Mag. 48(11), 156–163, (2010)
[12] M. Win, P. Pinto, L. Shepp, A mathematical theory of network interference and its
applications. Proc. 97(2), 205–230, (2009)
[13] K. Gulati, A. Chopra, B.L. Evans, K.R. Tinsley, Statistical modeling of co-channel
interference, in IEEE Global Telecommunications Conference (GLOBECOM), Honolulu, HI,
USA, ( 2009)
[14] M. Kountouris, N. Pappas, Approximating the interference distribution in large wireless
networks, in International Symposium Wireless Communication System (ISWCS), Barcelona,
Spain, (2014)
[15] M. Haenggi, J. Andrews, F. Baccelli, O. Dousse, M. Franceschetti, Stochastic geometry and
random graphs for the analysis and design of wireless networks, IEEE J. Sel. Areas Commun.
27(7), 1029–1046, (2009). doi:10.1109/JSAC.2009.090902
[16] F. Baccelli, S. Zuyev, Stochastic geometry models of mobile communication networks, in
Frontiers in queueing: Models And Applications in Science and Engineering, pp. 227–243,
(1996)
[17] T. Brown, Cellular performance bounds via shotgun cellular systems, IEEE J. Sel. Areas
Commun. 18(11), 2443–2455, (2000), doi:10.1109/49.895048
[18] F. Baccelli, M. Klein, M. Lebourges, S. Zuyev, Stochastic geometry and architecture of
communication
networks.
Telecommun.
Syst.,
7,
209–227,
(1997).
doi:10.1023/A:
1019172312328
[19] F. Baccelli, B. Blaszczyszyn, Stochastic Geometry and Wireless Networks: Volume I Theory,
ser. Foundation and Trends in Networking. Now Publishers, March 2009. doi:10.1561/
1300000006
[20] F. Baccelli, B. Blaszczyszyn, Stochastic Geometry and Wireless Networks, Volume II—
Applications, ser. Foundations and Trends in Networking, F. Baccelli and B. Blaszczyszyn,
Eds. vol 2 (Now Publishers, 2009). doi:10.1561/1300000026
[21] C. Ren, J. Zhang, W. Xie, D. Zhang, Performance analysis for heterogeneous cellular
networks based on Matern-like point process model, in International Conference Information
Science and Technology (ICIST), pp. 1507–1511, Yangzhou, China, (2013). doi:10.1109/
ICIST.2013.6747823
[22] A. Guo, M. Haenggi, Spatial stochastic models and metrics for the structure of base stations
in cellular networks. IEEE Trans. Wireless Commun. 12(11), 5800–5812, (2013)
[23] M. Di Renzo, A. Guidotti, G. Corazza, Average rate of downlink heterogeneous cellular
networks over generalized fading channels: A stochastic geometry approach, IEEE Trans.
Commun., 61(7), 3050–3071, (2013)
[24] M. Haenggi, Stochastic Geometry for Wireless Networks, ser. Stochastic Geometry for
Wireless Networks. (Cambridge University Press, 2012)
[25] S. Weber, J.G. Andrews, Transmission capacity of wireless networks. Found. Trends Netw. 5
(2–3), pp. 109–281, 2012, doi:10.1561/1300000032
[26] T. Bai, R. Vaze, R.W. Heath Jr., Analysis of blockage effects on urban cellular networks.
IEEE Trans. Wirel. Commun. 13(9), 5070–5083, (2014). doi:10.1109/TWC.2014.2331971
[27] H. ElSawy, E. Hossain, M. Haenggi, Stochastic geometry for modeling, analysis, and design
of multi-tier and cognitive cellular wireless networks: A survey, IEEE Commun. Surv.
Tutorials, 15(3), 996–1019, (2013)
Part II:
System Level Simulations
225

Notation and Common Simulation Parameters
The subsequent table summarizes commonly employed parameters.
Common simulation parameters for Chaps. 11−14 are summarized in Table 2.
Table 1 Frequently used parameters
Symbol
Annotation
ðr; /Þ
User location in polar coordinates
ðR; WÞ
Transmitter-site location in polar coordinates
PM
Macro base station transmit power in [W]
lM
Macro base station density in [m-2]
PM
Small cell transmit power in [W]
lS
Small cell density in [m-2]
g
Small cell occupation probability/-ratio, 0  g  1
‘ðÞ
Distance-dependent path loss law, 0  ‘ðÞ  1
RI
Radius of indoor area or building
LW
Wall penetration loss, 0  LW  1
S; I
Aggregate signal and interference powers in [W]
c
Signal-to-Interference Ratio c ¼ S=I
s
Normalized rate (spectral efﬁciency) in [bit/s/HZ]
Table 2 Common simulation parameters
Parameter
Value
Carrier frequency
fc ¼ 2:14 GHz
LTEA bandwidth
20 MHz
Macro site deployment
Hexagonal grid, one ring
Inter-macro site distance
500 m
eNodeB transmit power
PM ¼ 46 dBm
eNodeB minimum coupling loss
cB ¼ 70 dB
Shadow fading
Spatially correlated log-normal
Fast fading
Time-correlated Rayleigh
Receiver type
Zero forcing
Noise power density
174 dBm/Hz
Trafﬁc model
Full buffer
Channel knowledge
Perfect
Simulation length
100 Transmission Time Interval (TTI)
Number of simulation runs
100
226
Part II:
System Level Simulations

Chapter 10
Basic System Level Simulations
and Advanced Features
Markus Rupp, Stefan Schwarz and Martin Taranetz
10.1
Survey on Existing Simulation Tools
Thischaptergivesanoverviewonexistingsimulationtools,outlinesbasicconcepts of
system level simulations and introduces the advanced features of runtime-precoding
and 3D channel modeling. There are several ways to categorize existing system-level
simulation tools. First, we may distinguish between simulators, which are imple-
mented as ‘modules’ of a larger suite, and those, which are speciﬁcally designed
for LTE-A [1]. Examples for the former include the Riverbed SteelCentral NetMod-
eler (formerly OPNET Modeler Suite) [2], OMNeT++ [3], IT++ [4], ns-2 [5, 6],
GNS3 [7], openWNS [8] and Hurricane II [9]. The main drawback of these solu-
tions is their low level of detail, hence leaving most implementation work to the
user. Consequently, results often lack accuracy and veriﬁcation. On the other hand,
technology-speciﬁc simulators are mainly developed by network operators and ven-
dors, and are typically not intended for commercial distribution [1, 10–12]. Such
tools yield a broad range of possibilities for parameter calibration and statistical
evaluation. Thus, they are key instruments for the standardization process and the
development of new technologies.
While these two classes of simulators largely vary in complexity, scalability and
usability, probably the most relevant difference for scientiﬁc research is their acces-
sibility. The authors strongly believe that open access is a key prerequisite for repro-
ducible simulation studies. The short list of openly available, technology-speciﬁc
approaches includes LTE-Sim [13], the tool presented in [12] and the Vienna LTE-A
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_10
227

228
M. Rupp et al.
downlink system level simulator. While the ﬁrst lacks of detailed Multiple-Input
Multiple-Output (MIMO) modeling, the second provides a rather limited set of fea-
tures.Inthisbook,wepresenttheViennaLTE-Adownlinksystemlevelsimulator [14].
10.2
The Vienna LTE-A Downlink System
Level Simulator
The Vienna LTE-A system level simulator is implemented in object-oriented
MATLAB. For further information, see, e.g., [15]. It is made openly available for
download under an academic, non-commercial use license. Its rich set of features
and easy adaptability has led to numerous publications from researchers all over the
globe,includingstudiesonenergy-efﬁcientcell-coordinationschemes[16],handover
algorithms in self-optimizing networks [17], and resource allocation techniques for
femtocell networks [18] as well as for machine-to-machine communication [19].
On top of that, the open accessibility warrants the reproducibility of these contribu-
tions. Today (December 2015), the simulator counts more than 30,000 downloads
and undergoes permanent peer-review from a substantially large online community.
With some 100,000 lines of code, employing a large forum with active users is the
only method to guarantee its quality.
10.3
Physical Layer Modeling
This section provides a brief introduction to modeling concepts of the physical layer
ofLTE-Aonsystemlevel.TheLTE-APHYprocedurescanconceptuallybedescribed
as a Bit Interleaved Coded Modulation (BICM)-system [20], as shown in Fig.10.1. It
comprises a transmitter including channel coder, bit interleaver and modulator (M ).
In LTE-A, coding and interleaving is achieved by a turbo-coder in combination with
rate matching. The symbol mapping employs 4-, 16- and 64-QAM with Gray map-
ping, respectively. Signal propagation over an NR × NT MIMO channel is commonly
modeled by slowly-varying, position-dependent macro-scale fading L0, small-scale
Fig. 10.1 Separation of an LTE link into link quality- and link performance model. The link can
equivalently be described as an LTE BICM transmitter–receiver chain [20]

10
Basic System Level Simulations and Advanced Features
229
fading H0 and Additive White Gaussian Noise (AWGN). The matrix representation
follows from the assumption that the cyclic preﬁx exceeds the channel length, hence
omitting inter-symbol interference. The channel coefﬁcients are typically calculated
from a power-delay proﬁle or a ray-based spatial channel model, such as the Wireless
World Initiative New Radio (WINNER) model [21] or 3GPP’s 3D model [22]. The
receiver encompasses an equalizer ﬁlter and a demodulator (M −1) as well as a
turbo decoder, which provides de-interleaving and channel decoding. In the current
version (v1.8r1375) of the Vienna LTE-A system level simulator, low complexity
models for Zero Forcing (ZF)- and Minimum Mean Square Error (MMSE) receivers
are available. The former approaches the average performance of an optimal receiver
by exploiting Multi-User (MU) diversity, which is typically present in system level
scenarios [23].
10.4
Link-to-System Mapping
The objective of the link abstraction model or link-to-system mapping is to predict the
performance of the presented LTE-A link, given a parameterization of the inputs. For
simpliﬁcation, the model can be divided into a link quality- and a link performance
model, as indicated in Fig.10.1. The link quality model measures the quality of the
received signal after equalization. Since the metric has to represent the quality of
the input to the turbo decoder, the post-equalization Signal to Interference and Noise
Ratio (SINR) is a straightforward choice [20]. The link performance model translates
this measure into Block Error Ratio (BLER) and further into (area) spectral efﬁciency
and effective throughput, based on the employed Modulation and Coding Scheme
(MCS). The translation is carried out by means of an AWGN BLER curve of the
corresponding MCS. The curves are obtained from LTE link level simulations, thus
forming the only computationally costly physical layer evaluation, which is required
for the link abstraction model.
In order to accurately map the system level SINR to the link level curves, an
effective SINR is calculated. This mapping is commonly denoted as Effective Signal
to Interference and Noise Ratio Mapping (ESM) in literature [24]. It compresses
the vector of post-equalization SINR values of the allocated Orthogonal Frequency
Division Multiplexing (OFDM) subcarriers to a single effective SINR value that can
be further mapped to a BLER value. The general process is illustrated in Fig.10.2.
Several approaches of an ESM have been reported in literature, including Exponen-
tial Effective Signal to Interference and Noise Ratio Mapping (EESM) and Mutual
Information Effective Signal to Interference and Noise Ratio Mapping (MIESM) [25,
26], respectively. The Vienna LTE-A simulator employs a MIESM, which already
proved beneﬁcial in Release 5 of UMTS [27], and was shown to outperform all other
approaches (e.g., EESM [28]) in both complexity and performance. In comparison
to other methods, it does not require an empirical calibration step as long as the
employed codes perform close to capacity [20].

230
M. Rupp et al.
Fig. 10.2 PHY link-to-system mapping procedure [29]
TheMIESMmethodcompressestheSINRvaluesoftheassignedResourceBlocks
(RBs) for each User Equipment (UE) and TTI into an effective SINR, yielding an
AWGN-equivalent representation in terms of mutual information. The non-linear
ESM mapping is expressed as
γeff = I−1
k

1
N
N

n=1
Ik(γn)

,
(10.1)
where N is the length of the SINR vector and Ik denotes the BICM capacity for the
chosen modulation at the given SINR value γn. Thus, MIESM effectively averages
the subcarriers in the Mutual Information (MI) domain and then remaps the average
MI value to Signal to Noise Ratio (SNR) [20]. For a modulation encoding k bits per
symbol, the BICM capacity is expressed as [30]:
Ik(γ ) = k −E
⎧
⎨
⎩
1
k
k

i=1
1

b=0

z∈X i
b
log

ˆx∈X exp(−|Y −√γ (ˆx −z)|2)

x∈X i
b exp(−|Y −√γ (x −z)|2)
⎫
⎬
⎭,
(10.2)
where X is the set of 2k constellation symbols, X i
b denotes the set of symbols for
which bit i equals b and Y is complex normal Random Variable (RV) with zero mean
and unit variance.
The model in Fig.10.1 is a simpliﬁcation of the actual link abstraction model,
as it does not account for interference from other base stations. Its expansion to the
whole network is illustrated in Fig.10.3. The ﬁgure identiﬁes the main components
of the model as network layout, time-variant fading and scheduling. It also illustrates
the corresponding input–output relations to the link quality- and link performance
model, respectively.

10
Basic System Level Simulations and Advanced Features
231
time-dependent
position-dependent
link performance
model
link quality model
throughput
BLER
precoding
power allocation
HARQ
Block Size
modulation
& coding
network layout
shadow fading
pathloss
antenna gain
small-scale fading
assigned PHY
resources
scheduling
traffic model
QoS
link
adaptation
strategy
post-equalization SINR
Fig. 10.3 LTE link abstraction model as employed in the Vienna LTE-A downlink system level
simulator
10.5
Advanced Features: Runtime Precoding
10.5.1
Relevance
In existing open-source system level simulation tools, UE association is limited to a
single eNodeB with all antennas being mounted at the same site. In such scenarios,
the fading as experienced over a MIMO link can be decomposed into a slowly
varying, position-dependent macro-scale component and a faster changing small-
scale component, as shown in Fig.10.3. Macro-scale fading is determined by the
network layout and comprises antenna directivity, path loss and shadowing. Small-
scale fading represents fast, frequency-selective channel variations over time. As
explained in Sect.10.3, it is commonly modeled by a normalized NR × NT channel
matrix H0, where NT and NR denote the number of transmit- and receive antennas,
respectively. All entries of Hi have unit mean power in ensemble average.
In the single-eNodeB-single-site case, the macro-scale parameter L0 is a scalar,
which is applied on all entries of H0. Thus, both L0 and H0 can be computed off-line
and independently from each other. Such separation further enables to determine the
optimal precoder for each transmission rank a-priori with minimum loss of accuracy
[20]. The effective channel H = GH0F, which encompasses precoder F and receive
ﬁlter G, can be stored in channel traces and may be reused in all simulations with
the same MIMO setting.

232
M. Rupp et al.
If the desired signal is received from multiple eNodeBs (e.g., in certain Coordi-
nated Multi-Point (CoMP) schemes, as indicated in Sect.10.5.2a) or from a single
eNodeB with geographically separated antennas (e.g., in Distributed Antennas Sys-
tem (DAS)- and Remote Radio Head (RRH) deployments, as shown in Sect.10.5.2b),
a-priori computation of the optimal precoders and the corresponding receive ﬁlters
is no longer possible. In this case, only the normalized small-scale fading matrices
Hi for each transmitter site can be pre-generated. The composite channel of the
desired signal does not become available until runtime. It is obtained by stacking the
matrices Hi from each transmitter-site and weighting them with the corresponding
macro-scale losses, Li, i.e.,
H′
0 = [L1H1 L2H2 L3H3 . . .] .
(10.3)
Then, the effective channel is calculated as H = GH′
0F. In this case, the optimal
precoder, F, and the corresponding receive ﬁlter G are determined at runtime. The
challenge is to enable coherent signal reception from spatially distributed trans-
mission points while keeping additional computational complexity at a minimum.
Subsequently, we introduce the so called runtime-precoding method.
10.5.2
Implementation
The functionality of runtime-precoding is implemented in the UE’s link quality
model, as indicated in Fig.10.3. Its major building blocks are outlined in Algorithm 1.
Themodelenablescoherentsignalreceptionfromspatiallydistributedsources,which
can be selected at runtime. At ﬁrst, it collects the normalized small-scale fading
channels and macro-scale losses for both desired and interfering signals. Then, the
channels are stacked according to Eq.10.3.
In the next step, the corresponding precoders are determined. By default, they
may be chosen from a 3GPP standard-compliant codebook [31]. Note there is no
(a)
(b)
Fig. 10.4 Spatially distributed transmission points. a CoMP scenario. b eNodeB with RRHs

10
Basic System Level Simulations and Advanced Features
233
Algorithm 1: Proposed UE link quality model with runtime-precoding func-
tionality.
Result: post equalization SINR
collect macroscopic path losses and normalized channel matrices from all transmitting sites;
calculate composite desired channel by stacking channel matrices of desired signal;
determine precoder or beamformer;
if there are interferers then
calculate composite interfering channels by stacking channel matrices of interferers;
determine precoders or beamformers for interfering channels;
else
noise power only;
end
calculate receive ﬁlters and effective channel matrices;
determine post equalization SINR and store for link performance model;
calculate feedback based on actual channel;
standardized method to determine the Precoding Matrix Indicator (PMI). The Vienna
LTE-Adownlinksystemlevelsimulatoremploysaschemethatmaximizesthemutual
information between transmitted and received symbols [32]. Nonetheless, the avail-
ability of the full channel at runtime allows researchers to apply arbitrary precoders
and beamformers, yielding a profound novelty in open-source LTE-A system level
simulation tools. Note that in general, beamforming strategies are found by solving
multi-objective optimization problems [33]. The implementation of 3GPP’s 3D chan-
nel model enables the investigation of elevation beamforming and full-dimension
MIMO [22].
10.5.3
Performance Evaluation
In this section, we evaluate the price to pay for enabling coherent multi-point trans-
mission in system level simulations. For this purpose, we extend the UE link quality
model of the Vienna LTE-A simulator by the runtime-precoding functionality accord-
ing to Algorithm 1. Then we measure simulation run times with the new- and the
legacy model. The results are compared with run times as obtained with the Vienna
LTE-A Downlink Link Level simulator [34]. For a meaningful comparison, all simu-
lations were carried out on the same hardware, an Intel(R) Core(TM) i7-3930K CPU
@ 3.20 GHz, equipped with 32 GB of DDR3 1333 quad-channel RAM.
The common setup, which is employed in both link- and system level simulations,
is summarized in Table10.1. We carry out simulations with the LTE bandwidths
B = {1.4, 3, 5, 10, 20}MHz and the NT × NR antenna conﬁgurations {2 × 2, 4 ×
2, 4 × 1}forvarioussimulationlengths(measuredinmultiplesof1TTI),inparticular
NTTI = {100, 500, 1000} on system level and NTTI = {10, 100, 500} on link level,
respectively. Moreover, we perform system level simulations with K = {1, 10, 100}
UEsatasimulationlengthof100 TTI.Aroundrobinschedulerisemployed.Notethat

234
M. Rupp et al.
Table 10.1 Simulation parameters as employed for the simulation run time evaluation
Parameter
Value
Frequency
2.14 GHz
Number of eNodeBs
1
Transmit power
5 W
eNodeB antenna gain pattern
Omni-directional
LTE transmission mode
CLSM
Path loss in dB
max

10 log10

4πd f
c0
2
, 0

Shadow fading
None
Channel model
ITU-R Ped-A, block fading
Receiver type
Zero forcing
Noise power spectral density
−160 dBm/Hz
UE position
Random in circle with R = 250 m
UE antenna gain pattern
Omni-directional
Trafﬁc model
Full buffer
Channel knowledge
Perfect
Feeback
AMC: CQI, MIMO: PMI and RI
Feedback delay
3 TTI
theroundrobinschedulerdoesnotincreaseincomplexitywiththenumberofphysical
RBs (i.e., increasing B). Other scheduling algorithms may have a considerable impact
on the simulation run time in multi-user scenarios [20].
Figure10.5 shows the obtained simulation run times. Each point was computed
by averaging over ten simulation runs. It is observed that on system level the results
scale approximately linearly with the simulation length NTTI, the bandwidth B and
the number of UEs K. Compared to this, the link level results exhibit a slightly
non-linear scaling with B (note that on link level, only a single link is evaluated,
i.e., K = 1). Both link- and system level run times show a non-linear dependence on
the number of transmit- and receive antennas, NT and NR, respectively. From these
observations, we can derive the following generic run time estimator (for a better
understanding of the scaling with NT and NR, additional simulations with the MIMO
conﬁgurations {2 × 1, 4 × 1} were carried out).
T[s](NTTI, B, NT, NR, K)
= (c0 + NTTI · K · B[MHz] · (c1 NT + c2 NR + c3 NTNR)
+ · · · + NTTI · K · B2
[MHz] · (c4 NT + c5 NR + c6 NTNR))
× · · · × 1 s,
(10.4)

10
Basic System Level Simulations and Advanced Features
235
4 x 4
4 x 2
2 x 2
0
5
10
15
20
0
500
1000
0
50
100
150
Simulation length [TTI]
Bandwidth [MHz]
Simulation run time [s]
0
5
10
15
20
0
500
1000
0
50
100
150
200
250
300
Simulation length [TTI]
Bandwidth [MHz]
Simulation run time [s]
0
5
10
15
20
0
50
100
0
500
1000
1500
Number of UEs
Bandwidth [MHz]
Simulation run time [s]
0
5
10
15
20
0
50
100
0
500
1000
1500
2000
2500
3000
Number of UEs
Bandwidth [MHz]
Simulation run time [s]
0
5
10
15
20
0
100
200
300
400
500
0
500
1000
1500
2000
2500
Simulation length [TTI]
Bandwidth [MHz]
Simulation run time [s]
(a)
(b)
(c)
(d)
(e)
Fig. 10.5 Simulation run times (s) for various LTE bandwidths (MHz), antenna conﬁgurations
{NT × NR} and number of UEs, a system level, old model, 1 UE, b system level, new model, 1 UE,
c system level, old model, 100 TTIs, d system level, new model, 100 TTIs, e link level, 1 UE
where B[MHz] = B/106 Hz. Next, we compute the coefﬁcients c0, . . . , c6 by linear
least squares. The results are summarized in Table10.2. Compared to the legacy link
quality model, simulations with the new model require 1.25× longer for initializa-
tion (represented by the coefﬁcient c0), which is still 52.5× faster than link level
simulations. It slightly decreases the scaling with B[MHz] · NR (referring to c2) by
1.4× while increasing c3 (according to the scaling with B[MHz] · NT · NR) by 2.7×.
The latter term is of particular relevance for investigating massive MIMO scenarios

236
M. Rupp et al.
Table 10.2 Coefﬁcients for the runtime estimator in Eq.10.4 as obtained by linear least squares
Simulation type
c0
c1
c2
c3
c4
c5
c6
Legacy link
quality model
0.8
0
8.2 × 10−4
2.7 × 10−4
0
0
0
New link
quality model
1.0
0
5.7 × 10−4
7.4 × 10−4
0
0
0
Link level
simulations
52.5 0
235.0 × 10−4
0
2.3 × 10−4
11.0 × 10−4
0
Values are provided for system level simulations with the legacy- and the new link quality model
as well as for link level simulations
with a large number of transmit antennas. On link level, c2 (referring to a scaling
proportional to B[MHz] · NR) is 41.2× larger than on system level, while c3 = 0 (corre-
sponding to the scaling proportional to B[MHz] · NR · NT). On the other hand, the link
level simulation run times scale with NT · B2
[MHz] and NR · B2
[MHz] (referring to c4 and
c5), while system level simulations with both legacy- and new link quality model
exhibit no dependency on B2
[MHz], i.e., c4 = 0, c5 = 0 and c6 = 0, respectively. A
more detailed analysis of the link level simulation times shows that the non-linearity
mainly arises from the symbol demapping and decoding, as described in Sect.10.3.
10.6
Advanced Features: 3D Channel Modeling
Fjolla Ademaj
10.6.1
Introduction
Developing realistic channel models is one of the greatest challenges in describ-
ing wireless communications. Their quality is crucial for accurately predicting the
performance of a wireless cellular system. Broadly speaking, channel models can
be divided into two categories, deterministic and stochastic. Deterministic models
describe the channel for a speciﬁc propagation environment between transmitter and
receiver. This method can be tedious to evaluate and does not allow for general
statements in an ensemble of environments. In stochastic models, the channel char-
acteristics are often condensed to a statistical description, e.g., the typical Power
Delay Proﬁle (PDP).
In order to close the gap between the two approaches, 3rd Generation Partnership
Project (3GPP) has introduced the Spatial Channel Model (SCM) [35]. Unlike tra-
ditional channel models, it incorporates not only a random PDP but also a random

10
Basic System Level Simulations and Advanced Features
237
angular proﬁle Access Point (AP). The model represents scatterers through statistical
parameterswithoutbeingphysicallypositioned.TheSCMbelongstotheclassof geo-
metric stochastic model and separately deﬁnes large scale parameters (e.g., shadow
fading, delay spread and angular spreads) as well as small scale parameters (e.g.,
delays, cluster powers, and arrival- and departure angles). Both parameter sets are
randomly drawn from tabulated distributions. The large scale parameters encompass
the geometric positions of the BSs and the UEs, respectively. Moreover, they are
used to parameterize the statistics of the small scale parameters.
The SCM model in [35] includes six different scenarios, each of them representing
a unique environment. Initially it was targeted for a bandwidth of only 5 MHz, and
a carrier frequency of 2 GHz. Later, it was extended to the Spatial Channel Model
Extension (SCME). The SCME follows the same procedure as the SCM, but supports
bandwidths of up to 100 MHz and a frequency range of 2–6 GHz. In the course of
the WINNER projects, the model was extended for 15 different scenarios, including
urban-, rural- and moving environments [21, 36]. The WINNER model is recom-
mended as a baseline for evaluating radio interface technologies in the International
Telecommunication Union-Radiocommunication Sector (ITU-R) [37].
Recently there has been a signiﬁcant interest in enhancing system performance
through the use of antenna systems having a two-dimensional array structure that
provides adaptive control over both the elevation- and the azimuth dimension. The
additional control over the elevation dimension enables a variety of strategies such
as sector-speciﬁc elevation beamforming (e.g., adaptive control over the vertical
pattern beamwidth and/or downtilt), advanced sectorization in the vertical domain,
and UE-speciﬁc elevation beamforming. Vertical sectorization can improve average
systemperformancethroughthehighergainoftheverticalsectorpatterns,butvertical
sectorization generally does not need additional standardization support. UE-speciﬁc
elevation beamforming promises to increase the SINR statistics seen by the UEs
by pointing the vertical antenna pattern in the direction of the UE while spraying
less interference to adjacent sectors by virtue of being able to steer the transmitted
energy in elevation. In order to enable evaluation of the possible speciﬁcation method
to enhance the performance with 3D beamforming or with Full Dimensional (FD)-
MIMO, a new channel model is needed which enables modelling in both vertical-
and horizontal dimension of the environment. Recently, 3GPP introduced a new 3D
SCM for LTE-A [22].
As of this writing, only few simulation studies, including reports from the 3GPP
TSG RAN WG1 meetings, have been published that claim the practical implemen-
tation of the model [38, 39]. However, the employed tools are mainly developed by
network operators and vendors, and thus typically intended for commercial use. We
provides a guideline for the practical implementation of the model. The MATLAB
source code is openly available for download on our webpage www.nt.tuwien.ac.at/
vienna-lte-a-simulators under an academic, non-commerical use license. It is pro-
vided as a stand-alone package that is directly applicable for system level simulation
tools and can straightforwardly be ported to link level.

238
M. Rupp et al.
Based on [40], the contribution of this section outlines as follows. The guideline
for a computationally efﬁcient implementation of the 3GPP 3D channel model is
presented in Sect.10.6.3. In Sect.10.6.4, the implementation is validated against
results from the 3GPP standard with the Vienna LTE-A Downlink System Level
Simulator. An outline of new opportunities and challenges is given in Sect.10.6.5.
10.6.2
3GPP 3D Channel Model
The 3GPP 3D channel model characterizes wireless communication channels of typ-
ical European cities. It is a 3D geometric stochastic model, describing the scattering
environment between BS and UE in both azimuth and elevation dimensions. The
scatterers are represented by statistical parameters without having a real physical
location. In 3GPP TR 36.873 [22], three scenarios, Urban Macro cell (UMa), Urban
Micro cell (UMi) and UMa-high rise (UMa-H) are speciﬁed. They represent typical
urban macro-cell and micro-cell environments. Both UMa and UMa-H scenarios,
consider a BS height of 25 m, thus surpassing the surrounding buildings. UMa-H
also speciﬁes such environments with one high-rise building per Evolved Base Sta-
tion (eNodeB) sector. UMi, considers a BS height of 10 m, lying below the rooftop
level. All three environments are assumed to be densely populated with buildings
and take into account both indoor- and outdoor UEs.
The 3GPP 3D channel model speciﬁes three propagation conditions, Line-Of-
Sight (LOS), Non Line of Sight (NLOS) and Outdoor-to-Indoor (O-to-I). For each
of these conditions it deﬁnes different parameters for mean propagation path loss,
macroscopic fading and microscopic fading. All three scenarios in [22], UMa, UMi
and UMa-H, consider 80 % of the UEs to be located indoors. The probability of
being in LOS is determined separately for indoor and outdoor UEs and depends on
the height of the UE as well as the break point distance. The break point distance
characterizes the gap between transmitter and receiver at which the Fresnel zone is
barely broken for the ﬁrst time [41]. For an indoor UE, LOS refers to the signal
propagation outside the building in which the UE is located. For each UE location,
large scale parameters are generated according to its geographic position as well as
the propagation conditions at this location. The large scale parameters incorporate
shadow fading, the Ricean K-factor (only in the LOS case), delay spread, azimuth
angle spread of departure- and arrival, as well as zenith angle spread of departure-
and arrival.
The small scale parameters incorporate delays, cluster powers as well as angles
of departure and -arrival in azimuth and elevation direction, respectively. The model
considers N clusters of scatterers, where each cluster is resolvable to M paths. A
simpliﬁed sketch of the model is given in Fig.10.6. The channel coefﬁcients are
deﬁned per cluster n, BS antenna element s and UE antenna element u as

10
Basic System Level Simulations and Advanced Features
239
Fig. 10.6 Scattering concept in the 3D model. Figure demonstrates a link that is resolvable to M
paths. Elevation- and azimuth angles at BS and UE are denoted as θ and φ, respectively
Hu,s,n (t) =

Pn
M
M

m=1
Frx,u,θ

θn,m,ZOA, φn,m,AOA

Frx,u,φ

θn,m,ZOA, φn,m,AOA

T
×
⎡
⎣
exp

jΨ θθ
n,m


K−1
n,m exp

jΨ θφ
n,m


K−1
n,m exp

jΨ φθ
n,m

exp

jΨ φφ
n,m

⎤
⎦
×
Ftx,s,θ

θn,m,ZOD, φn,m,AOD

Ftx,s,φ

θn,m,ZOD, φn,m,AOD


× exp

j2πλ−1
0

ˆrT
rx,n,m ¯drx,u

× exp

j2πλ−1
0

ˆrT
tx,n,m ¯dtx,s

× exp

j2π vn,mt

,
(10.5)
where Pn is the power of path n, Frx,u,θ and Frx,u,φ are ﬁeld patterns of the receive
antenna element u in the direction of the spherical basis vectors, ˆθ in the zenith
direction, ˆφ in the azimuth direction. The expressions Ftx,s,θ and Ftx,s,φ are ﬁeld
patterns of the transmit antenna element s in the direction of ˆθ and ˆφ, respectively.
The departure- and arrival angels in zenith and azimuth direction are denoted with θ
and φ, respectively. The term Kn,m represents cross polarization power ratios for each
path m and cluster n, and Ψ AB
n,m are random initial phases for four different polarization
combinations AB = {θθ, θφ, φθ, φφ}. The terms ˆrrx,n,m and ˆrtx,n,m are the receiver
and transmitter spherical unit vectors expressed in Cartesian coordinates. They are
deﬁned as
ˆrn,m =
⎛
⎝
sin θ cos φ
sin θ sin φ
cos θ
⎞
⎠.
(10.6)
The parameters ¯drx,u and ¯dtx,s are the location vectors of receive and transmit antenna
elements, respectively. Considering a BS with coordinates

sx, sy, sz

, and a planar
antenna array, the location vector per antenna element is

240
M. Rupp et al.
¯dtx,s =
⎛
⎝
sx
sy
sz
⎞
⎠+
⎛
⎝
0
(p −1)dH
(q −1)dV
⎞
⎠
(10.7)
where p ∈P and q ∈Q. The terms P and dH denote the number of antenna elements
and the element spacing in the horizontal direction, while Q and dV are the number of
antenna elements and the element spacing in the vertical direction, respectively. The
last component of (10.5), vn,m, represents the Doppler frequency component of the
UE moving at velocity ¯v. Further details on the calculation of the variables in (10.5)
can be referred from [22].
Antenna Modeling
The 3GPP 3D channel model enables to scrutinize 2-dimensional (2D) planar antenna
arrays, also known as rectangular arrays. The antenna elements can either be lin-
early polarized (co-pol) or cross prolarized (cross-pol), as shown in Fig.10.7. In this
regard, the model represents a compromise between practicality and precision as it
does not include the mutual coupling effect as well as different propagation effects
of horizontally and vertically polarized waves. Our well-structured implementation
will substantially facilitate the implementation of further techniques for modeling
different polarization modes such as the one proposed in [42].
The antenna elements are equidistantly spaced in the y- and the z-direction. For
static electrical beam steering, also known as electrical tilting, a complex weight is
applied to each antenna element in the vertical direction. For an antenna element in
the qth row, it is given as
wq =
1
√Q exp

−j2π
λ (q −1)dV cos θetilt

,
(10.8)
where Q represents the total number of antenna elements in the vertical direction
and θetilt is the steering angle in the vertical plane. Unlike the conventional approach
of applying an array factor to the ﬁeld pattern of a single element of a uniform
Fig. 10.7 Geometry and
polarization modes of a
planar antenna array. The
antenna elements in
horizontal and vertical
direction are indexed by p
and q, respectively
y
x
z
dvv
H
d
d
p,q
Co-pol
Cross-pol
p={1,...,P}
q={1,...,Q}
(a)
(b)

10
Basic System Level Simulations and Advanced Features
241
antenna array, in the 3D model the beamforming weights are applied to the channel
coefﬁcients for each antenna element
[Hc
i,n(t)]a,b =

uεPa
wu

sεPb
wsHi,u,s,n (t) ,
(10.9)
where [Hc
n(t)]a,b represents the weighted and combined channel coefﬁcients. The
terms Pa and Pb denote the sets of antenna elements that belong to receive antenna
port a with a ∈{1, . . . , NRx} and transmit antenna port b with b ∈{1, . . . , NTx},
respectively. The terms ωu and ωs are complex weights that account for phase shifts as
appliedforstaticbeamforming(e.g.,electricaldowntilting),respectively.Therelative
position of each element in the array is incorporated in the channel coefﬁcients
Hu,s,n (t), where n denotes the cluster index, s and u are the BS and UE antenna
elements, respectively.
In the following, a detailed procedure on the implementation of the model for
simulations is provided.
10.6.3
Implementation on System-Level
In this section, we describe the necessary steps to integrate the 3D channel model into
an existing simulation tool. The target is to compute a NRx × NTx MIMO-channel
matrix H(t, f ) for each sampling point on the time-frequency grid, where NTx and
NRx refer to the number of transmit- and receive antenna ports, respectively. On link
level, channel realizations are typically calculated per OFDM symbol and LTE-A
subcarrier [34]. On system level, they are commonly generated per physical RB and
TTI [11] (Fig.10.8).
In the 3GPP 3D channel model, the channel coefﬁcients depend on the UE location
in the 3D space and, thus, have to be calculated at runtime. Hence, in order to reduce
complexity, the challenge is to perform computationally intensive tasks off-line or
on demand, whenever possible. We will follow the stepwise procedure as speciﬁed
in [22, Sect.7.3] and illustrated in Fig.10.9, and explain its expedient partition for
implementation. The steps are denoted as ‘Step N’ with N∈{1, . . . , 12}.
Fig. 10.8 Hexagonal-grid
macro-cell scenario with
seven BSs and 21 sectors.
This scenario is used in
simulations throughout the
paper

242
M. Rupp et al.
Set scenario, 
network layout and 
antenna parameters
Generate XPRs
Perform random 
coupling of rays
Generate arrival & 
departure angles
Generate cluster 
powers
Generate delays
Assign propagation 
condition (NLOS/
LOS)
Calculate pathloss
Generate correlated 
large scale 
parameters (DS, 
AS, SF, K)
Draw random initial 
phases
Generate channel 
coefficient
Apply pathloss and 
shadowing
General parameters:
Small scale parameters:
Coefficient generation:
Fig. 10.9 Procedure for generating channel coefﬁcients in 3GPP 3D channel model
[GP] The ﬁrst step is to generate the general parameters. It starts with specifying
the network layout, the scenario environment and the antenna array parameters
(Step 1). Currently, the standard speciﬁes three scenarios, 3D-UMa, 3D-UMi and
3D-UMa-H, and various planar antenna array structures, deﬁning the location and
polarization of each antenna element, as well as the element-to-port mapping. Step
2 is to assign the propagation condition, i.e., either LOS or NLOS, separately for
indoor and outdoor UEs. The decision is based on the LOS probability as speciﬁed
in [22, Table7.2-2], which is dependent on the UE’s height and its distance to the
macro-site. Different path loss models are applied for LOS, NLOS and O-to-I, as
deﬁned in [22, Table7.2-1]. The experienced path loss is calculated in Step 3. In
Step 4, the large scale parameters are generated. The detailed procedure is described
in [21, Sect.3.3.1]. For each UE, a vector of large scale parameters is generated as
LSP =
δSK δK δDS δASD δASA δZSD · · · δZSA

.
(10.10)
In case the UE is not in LOS of BS, δK = 0. These tasks can be performed off-
line, i.e., before entering the actual simulation loop. Similar to the generation of the
shadow fading, they have to be performed only once per site.
[SSP] The next step is to generate small scale parameters. In the 3GPP 3D channel
model, channel coefﬁcients Hu,s,n(t) are determined individually for each cluster n
and each receiver- and transmitter antenna element pair {u, s}, respectively. The
calculation of Hu,s,n(t) requires to generate delays (Step 5), cluster powers (Step 6)

10
Basic System Level Simulations and Advanced Features
243
as well as arrival- and departure angles for both azimuth and elevation (Step 7). After
coupling the rays within a cluster (Step 8), Cross Polarization Power Ratios (XPRs)
and random initial phases are drawn (Step 9 and 10). Together with the calculation
of the spherical unit vectors and the Doppler frequency component (both Step 11),
all parameters mentioned above are commonly applied to each antenna element pair
{u, s} and thus have to be determined only once per antenna array and eNodeB. The
Doppler component accounts for the time variance of the channel. The frequency
selectivity is determined by the channel impulse response Hi,u,s,n(t) and the sampling
frequency, which is directly related to the system bandwidth.
[CG] After generating the channel coefﬁcients for each antenna element pair
{u, s}, the channel coefﬁcients for an antenna array are combined according to the
antenna element-to-port mapping given in Sect.10.6.2. Then, the combined channel
Hc
n(t), for each cluster n is sampled based on the delay taps m deﬁned as
m =
τn
Ts

,
(10.11)
where m ∈{1, . . . , N}, Ts is the sample interval in the time domain and τn denotes
the actual delay of the nth cluster. The sampled NRx × NTx channel matrix is denoted
as ˆHm(t), with an element [ ˆHm(t)]a,b, referring to the sampled channel coefﬁcient
for receive antenna port a and transmit antenna port b, respectively. It is important
to note that the model is designed such that the channel impulse response before
sampling has unit sum power on average over t, i.e., Et
 
n |[Hc
n(t)]a,b|2!
= 1,
when assuming antenna elements with omni-directional gain pattern and 0 dB
gain, as well as an XPR of one. In order not to change the sum power after the
sampling, we multiply the sampled channel coefﬁcients [ ˆHm(t)]a,b by a factor of

n |[Hcn(t)]a,b|2/
m |[ ˆHm(t)]a,b|2. The ﬁnal channel impulse response in the fre-
quency domain is obtained by performing a Fast Fourier Transform (FFT) over the
sampled and normalized channel impulse response
˜H[k, t] =
N−1

m=0
ˆHm(t)e−j2πk m
N ,
(10.12)
where,k = 0, 1, . . . , N −1.ThetermN representsthenumberofFFTsampleswhich
is the maximum number of delay taps m. For example, assuming a transmission
bandwidth of 10 MHz, according to [43], the sampling interval is Ts = 65 ns and the
number of FFT samples is N = 1024.
Considering a UE with a ﬁxed location in the 3D space, [SSP] and [CG] have to
be carried out only in the ﬁrst time instant of the simulation. Afterwards, the channel
will remain static over time (no Doppler effect). If the UE moves at a certain speed,
represented by the vector v ∈R3, in principle, [SSP] would have to be performed
at runtime in each time instant of the simulation. This also implies the generation

244
M. Rupp et al.
Fig. 10.10 UE travels
through cube with an edge
length of 1 m
of new clusters and random initial phases, i.e., a complete change of the multi-path
propagation environment. Thus, it is considered reasonable from a physical perspec-
tive (see, e.g., [21]) as well as in view of computational complexity to partition the
scenario into equally sized cubes. As long as the UE resides within the same cube, it
is assumed to experience the same path loss, shadow fading, propagation conditions
(LOS/NLOS/O-to-I) and large scale parameters, as generated in [GP]. Then, [SSP]
has to be carried out only once at the beginning of the simulation and each time the
UE transfers to another cube. Assuming a spatial resolution of 1 m and a temporal
resolution of 1 ms, referring to the length of one LTE sub-frame, also denoted as TTI,
a UE moving at v = [27.78, 0, 0] m/s requires 36 ms to travel from one face of the
cube to the other, as indicated in Fig.10.10. In this case, [SSP] is performed every
36 sub-frames. Within a cube, channel variations are caused by the slightly changing
angles of arrival and departure (and thus the antenna element ﬁeld patterns) as well
as the phase shift due to the Doppler effect. They can be incorporated into [CG]
thus yielding the only variable components that have to be recalculated in each time
instant of the simulation. If the UE trace is known, e.g., in train and car scenarios, the
simulation complexity can be reduced even further. In such scenarios, the Doppler
frequency component in (10.5) has to be calculated only in the ﬁrst time instant of
the simulation, and can be reused in subsequent time instances as long as the user
stays within the same cube.
10.6.4
Calibration
Following the steps in Sect.10.6.3, we incorporated the 3D channel model in the
Vienna LTE-A Downlink System Level Simulator (current version v1.8r1375) [11].
The simulator is implemented in object-oriented MATLAB and is made openly
available for download under an academic, non-commercial use license. It is built

10
Basic System Level Simulations and Advanced Features
245
Fig. 10.11 Enhanced link abstraction model for enabling 3D channel modeling
according to the commonly employed structure for system level simulation tools (see,
e.g., in [24, 44]), as illustrated in Fig.10.11, thus serving as a representative example.
Its centerpiece is the link abstraction model that speciﬁes the interaction between
link- and system level simulations [11, 24]. This structure is expected to persist in
simulation tools for the ﬁfth generation of mobile cellular networks (5G) [44]. The
enhancements that were necessary to enable the 3D channel model are depicted by
the boxes shaded in gray at the top of the ﬁgure.
For calibration purposes, we carry out simulations with the setup as speciﬁed
in [22, Table8.2-2] and summarized in Table10.3. Two scenarios, 3D-UMa and 3D-
UMi are investigated. We provide the calibration results for large scale parameter
statistics, using the circular angle spread method, as recommended in [45]. This
method is used to generate the angular statistics a posteriori from the angular para-
meters generated in Step 11. We thus consider this procedure to provide a more
reliable veriﬁcation of our implementation than the previously used method in [40].
Figure10.12 depicts the obtained statistics for zenith spread of departure- and arrival.
In accordance with the results in [46], the distributions show similar characteristics
for 3D-UMa and 3D-UMi scenarios. Furthermore, they exhibit a good agreement
with results from [22] (dash-dotted curves), which were obtained by averaging over
21 sources as reported in [47]. In Fig.10.13 we provide the calibration results for
largest and smallest singular values as referred from [22, Table8.2-2]. The singular
values are generated on a RB basis at t = 0 by considering channel matrices where

246
M. Rupp et al.
Table 10.3 Simulation parameters for calibration as referred from [22]
Parameter
Value
Carrier frequency
2 GHz
LTE bandwidth
10 MHz
Macro-site deployment
Hexagonal grid
Scenarios
3D-UMa, 3D-UMi
BS antenna height (UMa)
25 m
BS antenna height (UMi)
10 m
BS antenna conﬁguration
NTx = 4
UE antenna conﬁguration
NRx = 2
Polarized antenna modeling
Model 2 [22]
BS antenna polarization
X-pol (±45◦)
UE antenna polarization
X-pol (0/ + 90◦)
Antenna elements per port
M = 10
Vertical antenna element spacing
0.5λ
Horizontal antenna element spacing
0.5λ
Maximum antenna element gain
8 dBi
UE antenna pattern
Isotropic antenna gain
Electrical downtilt
12◦
UE distribution
Uniform in cell [22, Table6-1]
path loss and shadowing are not yet applied to the channel coefﬁcients. The results
show a good agreement with the results from [22] (dash-dotted curves), which were
obtained by averaging over 21 sources as reported in [47].
10.6.5
Opportunities
The integration of the 3D channel model into existing link- and system level simula-
tion tools paves the way for more advanced studies on the performance of a mobile
cellular system in realistic environments. Existing channel models only support lin-
ear antenna arrays in the azimuth. With the introduction of the third dimension, not
only higher-order MIMO schemes but also a higher number of antenna elements
per antenna array can be investigated. Currently, the 3GPP LTE-A standard supports
up to eight antenna ports. However, recent trends aim at 100 and more antenna ports
per eNodeB [48]. A main enabler for this so called massive MIMO approach will
be the adoption of higher carrier frequencies, also termed millimeter-wave commu-
nication, as it enables to considerably decrease the size of the antenna arrays. On
the one hand, this may lead to higher complexity of the hardware, larger energy
consumption and a greater demand for signal processing capabilities. On the other

10
Basic System Level Simulations and Advanced Features
247
0
10
20
30
40
50
60
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Zenith spread of departure [°]
ECDF
3GPP - data from 21 sources
3GPP - median from 21 sources
Vienna LTE-A System-Level simulator
Zenith spread of departure [°]
ECDF
3GPP - data from 21 sources
3GPP - median from 21 sources
Vienna LTE-A System-Level simulator
3GPP - data from 21 sources
3GPP - median from 21 sources
Vienna LTE-A 
System-Level simulator
Zenith spread of arrival [°]
ECDF
Zenith spread of arrival [°]
ECDF
3GPP - data from 21 sources
3GPP - median from 21 sources
Vienna LTE-A 
System-Level simulator
0
10
20
30
40
50
60
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
10
20
30
40
50
60
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
10
20
30
40
50
60
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(a)
(b)
(c)
(d)
Fig. 10.12 Large scale parameter statistics. Gray lines refer to results reported by 21 sources
from [47]. Dashed curves denote the 3GPP reference results from [22, Figs.8.2-11, 8.2-13]. a UMa-
Zenith spread of departure. b UMi-Zenith spread of departure. c UMa-Zenith spread of arrival. d
UMi-Zenith spread of arrival
hand, it will enable a much more accurate bundling of energy towards the intended
receiver, which is a key prerequisite for aggressive frequency reuse. In dense urban
environments, where UEs move in three dimension (consider, e.g., shopping malls,
skyscrapers, and more) it is conceivable that the spectral efﬁciency per unit sphere
might replace the area spectral efﬁciency as a ﬁgure of merit. Other important use
cases are scenarios with high user mobility, as the number of commuters is expected
to increase substantially. People have become used to services following them wher-
ever they travel. Mobile cellular access has even become a key argument to choose
the means of transportation. Sharp, steerable beams might be an expedient solution
to this issue, as they could follow a vehicle along its path.
Improvements targeting planar antenna arrays are to be further investigated.
New virtualization models of antenna arrays, considering a full-connection between
antenna elements, weighted in both horizontal-and vertical direction will lead to a
better understanding of the 3D beamforming. Moreover, new two-dimensional code-
book designs are necessary for the evaluation of FD-MIMO.

248
M. Rupp et al.
-30
-20
-10
0
10
20
30
40
50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Largest singular value (10log10)
ECDF
Vienna LTE-A 
System-Level simulator
3GPP - data 
from 21 sources
3GPP - median 
from 21 sources
Largest singular value (10log10)
ECDF
Vienna LTE-A 
System-Level simulator
3GPP - median 
from 21 sources
3GPP - data 
from 21 sources
-50 -40 -30 -20 -10
0
10
20
30
40
50
Smallest singular value (10log10)
ECDF
Vienna LTE-A 
System-Level simulator
3GPP - median 
from 21 sources
3GPP - data 
from 21 sources
Smallest singular value (10log10)
ECDF
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Vienna LTE-A 
System-Level simulator
3GPP - median 
from 21 sources
3GPP - data 
from 21 sources
-30
-20
-10
0
10
20
30
40
50
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
-50 -40 -30 -20 -10
0
10
20
30
40
50
(a)
(b)
(c)
(d)
Fig. 10.13 Largest and smallest singular value ECDF in logarithmic scale. Gray lines refer to results
reported by 21 sources from [47]. Dashed curves denote the 3GPP reference results from [22,
Figs.8.2-17, 8.2-19]. a UMa-Largest (1st) singular value. b UMi-Largest (1st) singular value. c
UMa-Smallest (2nd) singular value. d UMi-Smallest (2nd) singular value
References
1. M. Gerasimenko, S. Andreev, Y. Koucheryavy, A. Trushanin, V. Shumilov, M. Shashanov, S.
Sosnin, Performance comparison of system level simulators for 3GPP LTE Uplink, in Inter-
net of Things, Smart Spaces, and Next Generation Networking. Lecture Notes in Computer
Science, vol. 7469, ed. by S. Andreev, S. Balandin, Y. Koucheryavy (Springer, Berlin, 2012),
pp. 186–197
2. Riverbed
(2015),
http://www.riverbed.com/products/performance-management-control/
opnet.html?redirect=opnet
3. OMNeT++ (2015), http://www.omnetpp.org
4. IT++ (2015), http://itpp.sourceforge.net/4.3.1/
5. ns-2 (2015), http://www.isi.edu/nsnam/ns
6. ns-3 (2015), http://www.nsnam.org/
7. GNS3 (2015), http://www.gns3.com/
8. S. Max, D. Bltmann, R. Jennen, M. Schinnenburg, Evaluation of IMT-advanced scenarios using
the open wireless network simulator, in International ICST Conference on Simulation Tools
and Techniques (Torremolinos, Malaga, Spain, 2010), p. 26
9. Hurricane II WAN Emulation and Network Simulation (2015), http://packetstorm.com/
packetstorm-products/hurricane-ii-software

10
Basic System Level Simulations and Advanced Features
249
10. Nomor System Level Simulation (2015), http://www.nomor.de/home/solutions-and-products/
system-level-simulation
11. M. Taranetz, T. Blazek, T. Kropfreiter, M.K. Müller, S. Schwarz, M. Rupp, Runtime precoding:
enabling multipoint transmission in LTE-advanced system level simulations. IEEE Access 3,
725–736 (2015). Jun
12. Y. Li, F. Yu, S. lei Zheng, C. lei Yang, LTE system level simulation with MATLAB, in Interna-
tional Conference Internet Technology and Applications (iTAP), pp. 1–4 (2011). doi:10.1109/
ITAP.2011.6006434
13. G. Piro, L. Grieco, G. Boggia, F. Capozzi, P. Camarda, Simulating LTE cellular systems: an
open-source framework. IEEE Trans. Veh. Technol. 60(2), 498–513 (2011). Feb
14. The Vienna LTE Simulators (2015), http://www.nt.tuwien.ac.at/ltesimulator
15. Mathworks, MATLAB Documentation (2015), http://www.mathworks.com/help/matlab/
index.html
16. K. Abdallah, I. Cerutti, P. Castoldi, Energy-efﬁcient coordinated sleep of LTE cells, in
IEEE International Conference on Communication (ICC) (Ottawa, ON, Canada, 2012),
pp. 5238–5242. doi:10.1109/ICC.2012.6363707
17. M. Carvalho, P. Vieira, An enhanced handover oscillation control algorithm in LTE self-
optimizing networks, in IEEE International Symposium Wireless Personal Multimedia Com-
munication (WPMC) (Brest, France, 2011)
18. M.M. Selim, M. El-Khamy, M. El-Sharkawy, Enhanced frequency reuse schemes for interfer-
ence management in LTE femtocell networks, in International Symposium on Wireless Com-
munication System (ISWCS) (Paris, France, 2012), pp. 326–330
19. S.Y. Shin, D. Triwicaksono, Radio resource control scheme for machine-to-machine communi-
cation in lte infrastructure, in International Conference ICT Convergence (ICTC) (Jeju Island,
South Korea, 2012)
20. J.C. Ikuno, System level modeling and optimization of the LTE downlink, Ph.D. dissertation,
E389, Technische Universität Wien (2013), http://theses.eurasip.org/theses/479/system-level-
modeling-and-optimization-of-the-lte/
21. WINNER II WP1, WINNER II channel models, IST-4-027756 WINNER II Deliverable D1.1.2
(2007)
22. 3rdGenerationPartnershipProject(3GPP).Studyon3DchannelmodelforLTE,3rdGeneration
Partnership Project (3GPP), TR 36.873 (2014)
23. R.W. Heath Jr., M. Airy, A. Paulraj, Multiuser diversity for MIMO wireless systems with
linear receivers, in Asilomar Conference on Signals, Systems and Computers (Asilomar),
vol. 2 (Paciﬁc Grove, CA, USA, 2001), pp. 1194–1199. doi:10.1109/ACSSC.2001.987680
24. S. Ahmadi, LTE-Advanced: A Practical Systems Approach to Understanding 3GPP LTE
Releases 10 and 11 Radio Access Technologies. ITPro collection (Elsevier Science, 2013)
25. I. Latif, F. Kaltenberger, R. Knopp, Link abstraction for multi-user MIMO in LTE using
interference-aware receiver, in IEEE Wireless Communication and Networking Conference
(WCNC) (Shanghai, China, 2012), pp. 842–846. doi:10.1109/WCNC.2012.6214489
26. M. Döttling et al., Assessment of Advanced Beamforming and MIMO Technologies, IST2003-
507581 WINNER, Technical Report, D2.7 ver 1.1 (2005)
27. S. Caban, M. Rupp, C. Mehlführer, M. Wrulich, Evaluation of HSDPA and LTE: From Testbed
Measurements to System Level Performance. (Wiley, 2011)
28. Nortel Networks, OFDM Exponential Effective SIR Mapping Validation, EESM Simulation
Results, 3rd Generation Partnership Project (3GPP). TR R1–040089 (2004)
29. IEEE 802.16 Broadband Wireless Access Working Group, IEEE 802.16m Evaluation Method-
ology Document (EMD), IEEE, Technical Report (2008)
30. G. Caire, G. Taricco, E. Biglieri, Capacity of bit-interleaved channels. Electron. Lett. 32,
1060–1061 (1996)
31. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access
(E-UTRA); Further advancements for E-UTRA physical layer aspects, 3rd Generation Part-
nership Project (3GPP), TR 36.814 (2010)

250
M. Rupp et al.
32. S. Schwarz, M. Wrulich, M. Rupp, Mutual information based calculation of the precoding
matrix indicator for 3GPP UMTS/LTE, in International ITG Workshop Smart Antennas (WSA)
(Bremen, Germany, 2010), pp. 52–58. doi:10.1109/WSA.2010.5456388
33. E. Björnson, E. Jorswieck, Optimal resource allocation in coordinated multi-cell systems.
Found. Trends Commun. Inform. Theory 9(2–3), 381-p (2013)
34. S. Schwarz, J.C. Ikuno, M. Simko, M. Taranetz, Q. Wang, M. Rupp, Pushing the limits of LTE:
A survey on research enhancing the standard. IEEE Access 1, 51–62 (2013)
35. 3rd Generation Partnership Project (3GPP), Spatial channel model for Multiple Input Multiple
Output (MIMO) simulations, 3rd Generation Partnership Project (3GPP), TR 36.996 (2003)
36. WINNER I WP5, Final report on link level and system level channel models, IST-2003-507581
WINNER I Deliverable D5.4 (2005)
37. M. ITU-R, Guidelines for evaluation of radio interface technologies for IMT-Advanced, Report
(2009)
38. A. Kammoun, H. Khanﬁr, Z. Altman, M. Debbah, M. Kamoun, Preliminary results on 3D
channel modeling: From theory to standardization. IEEE J. Sel. Areas Commun. 32(6),
1219–1229 (2014). doi:10.1109/JSAC.2014.2328152
39. Z. Hu, R. Liu, S. Kang, X. Su, J. Xu, Work in progress: 3D beamforming methods with user-
speciﬁc elevation beamfoming, in International Conference on Communications and Network-
ing in China (CHINACOM) (2014), pp. 383–386. doi:10.1109/CHINACOM.2014.7054323
40. F. Ademaj, M. Taranetz, M. Rupp, Implementation, validation and application of the 3GPP
3D MIMO channel model in open source simulation tools, in IEEE International Symposium
Wireless Commununication System (ISWCS) (2015)
41. H. Masui, T. Kobayashi, M. Akaike, Microwave path-loss modeling in urban line-of-sight
environments. IEEE J. Sel. Areas Commun. 20(6), 1151–1155 (2002). doi:10.1109/JSAC.
2002.801215
42. A. Weber, A. Bestard, Modeling of X-pol antennas for LTE system simulation, in 8th Inter-
national Symposium on Wireless Communication Systems (ISWCS) (2011), pp. 221–225.
doi:10.1109/ISWCS.2011.6125342
43. 3rd Generation Partnership Project (3GPP), LTE Physical Layer - General Description, 3rd
Generation Partnership Project (3GPP), TS 36.201 (2009)
44. Y. Wang, J. Xu, L. Jiang, Challenges of system-level simulations and performance evaluation
for 5G wireless networks. IEEE Access 2, 1553–1561 (2014). doi:10.1109/ACCESS.2014.
2383833
45. 3rd Generation Partnership Project (3GPP), Spatial channel model for Multiple Input Multiple
Output (MIMO) simulations, 3rd Generation Partnership Project (3GPP), TR 325.996 (2012)
46. 3GPP TSG RAN WG-1, R1-140048: Phase 2 calibration results for 3D channel model, 3rd
Generation Partnership Project (3GPP), Technical Report (2014)
47. 3GPP TSG RAN WG-1, R1-143469: Summary of 3D-channel model calibration results, 3rd
Generation Partnership Project (3GPP), Technical Report (2014)
48. F. Rusek, D. Persson, B.K. Lau, E. Larsson, T. Marzetta, O. Edfors, F. Tufvesson, Scaling up
MIMO: opportunities and challenges with very large arrays. IEEE Signal Process. Mag. 30(1),
40–60 (2013). doi:10.1109/MSP.2011.2178495

Chapter 11
Modeling Regular Aggregate Interference
by Symmetric Structures
Markus Rupp, Stefan Schwarz and Martin Taranetz
In this chapter, downlink co-channel interference statistics in wireless cellular
networks with hexagonal grid layout are investigated. The main target is to facil-
itate the analysis at user locations outside the center of the cell of interest.
The proposal of a cellular structure for mobile networks dates back to 1947. Two
Bell Labs engineers, Douglas H. Ring and W. Rae Young were the ﬁrst to mention
the idea in an internal memorandum [1]. Almost two decades later, in 1966, Richard
H. Frenkiel and Philip T. Porter, shaped a hexagonal cellular array of areas to pro-
pose the ﬁrst mobile phone system. Although never proposed as innovative research
solution, the hexagon model gained high popularity within the research community
and is still extensively utilized nowadays [2–7]. It serves either as the system model
itself, or as a reference system for more involved simulation scenarios. On the other
hand, its geometric structure renders closed-form analysis of aggregate interference
statistics difﬁcult [8]. Hence, simulation results often lack a mathematical back up.
Recently, closed-form results have been reported with system models based on
stochastic geometry [9–11]. The stochastic approach is based on an ensemble of
network realizations and is therefore not applicable when a ﬁxed structure of the
network is given. Since the well-planned deployment of macro-sites is not expected
to vanish in the medium term, it is thus considered imperative to make interference
analysis in the hexagonal grid model more convenient.
Current work on regular grid models has mainly focused on link-distance statistics
[12, 13].Theauthorsalsoaccountforfadingandprovideclosed-formapproximations
for the co-channel interference of a single link. However, convenient expressions
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_11
251

252
M. Rupp et al.
for the moments and the distribution of aggregate co-channel interference are not
available yet.
Based on the work in [14, 15], the contributions of this chapter are:
• Acircularinterferencemodel tofacilitateinterferenceanalysisincellularnetworks
with regular grid layout is introduced. Particular focus is placed on the hexagonal
grid due to its ubiquity in wireless communication engineering [2–7]. The key idea
is to consider the power of the interfering BSs as being uniformly spread along
the perimeter of the hexagon.
• It is proposed to model interference statistics in a hexagonal scenario by a single
Gamma Random Variable RV. Its shape- and scale parameters are determined in
closed form by employing the circular model. The analysis yields key insights
on the formative components of the interference distribution. A scenario with
regularly arranged macro-sites and randomly distributed small cells demonstrates
the model’s expedient application in heterogeneous cellular networks.
The chapter forgoes hexagonal grid setups with more than one ring of interferers as
well as further performance analysis, which is enabled by the Gamma approximation.
Both are considered straightforward and of no particular relevance for this thesis.
The remainder of this chapter is structured as follows: Sect.11.1 provides prelim-
inaries on the Gamma distribution. Section11.2 speciﬁes the hexagonal reference-
system model. In Sect.11.3 the circular interference model and its dual pendant are
introduced. Section11.4 investigates Gamma-distributed interference and its para-
metrization by the proposed circular interference model. In Sect.11.5, the accuracy
of the Gamma approximation is veriﬁed. In Sect.11.6, the circular model is applied
for modeling the interference from the macro BSs in a two-tier heterogeneous cellu-
lar network. Section11.7 provides a comparison of the circular model against Long
Term Evolution-Advanced LTE-A system level simulations. Section11.8 concludes
the chapter.
11.1
Preliminaries on the Gamma Distribution
In the current- as well as the subsequent chapter, particular focus is placed upon the
Gamma distribution due to its wide range of useful properties for wireless commu-
nication engineering, some of which are outlined in this section.
The Probability Density Function (PDF) of a Gamma distributed RV X with shape
parameter k and scale parameter θ, i.e., G ∼Γ [k, θ], is deﬁned as
fG(x) =
1
θkΓ (k)xk−1e−x/θ.
(11.1)
Its mean and variance are given by E[G] = kθ and Var[G] = kθ2.
The Gamma distribution exhibits the scaling property, i.e., if G ∼Γ [k, θ], then
a G ∼[k, a θ], ∀a > 0, and the summation property, i.e., if Gi ∼Γ [ki, θ] with i =
1, 2, . . . , N, then N
i=1 Gi ∼Γ [N
i=1 ki, θ].

11
Modeling Regular Aggregate Interference by Symmetric Structures
253
Consider an arbitrary distribution with mean ν and variance σ 2. Then, the distri-
bution Γ [k, θ] with the same ﬁrst- and second order moments has the parameters
k = ν2
σ 2 ,
θ = σ 2
ν .
(11.2)
These simple moment-matching identities can be exploited for accurately approx-
imating fading distributions [16], such as generalized-K [17, 18] and log-normal
[16–19], as well as aggregate interference statistics [11, 20, 21].
Additionally, the Gamma distribution covers the power fading distribution of
various single- and multi-antenna schemes under the Rayleigh fading assumption.
Conventional Single-Input Single-Output (SISO) yields an exponential distribution
Exp[1/θ], which is equivalent to Γ [1, θ]. The power fading of Maximum Ratio
Transmission(MRT)with NTx transmitantennasandonereceiveantennacanbemod-
eled by Γ [NTx, θ], Maximum Ratio Combining (MRC) with one transmit antenna
and NRx receive antennas is characterized by Γ [NRx, θ]. Furthermore, MRC is
often studied in the presence of Nakagami-m fading. Let Y ∼Nakagami[m, Ω] and
G = Y 2. Then, G ∼Γ [m, Ω/m].
According to [22], the quotient γ = S/I of two RVs S ∼Γ [kS, θS] and I ∼
Γ [kI, θI] is distributed as
fγ (x) = (θI/θS)kS
B(kS, kI)

1 + θI
θS
x
−kS−kI
xkS−1, x > 0
(11.3)
with B(·, ·) denoting the Beta function. Interpreting γ as a Signal-to-Interference
Ratio (SIR) allows to determine the success probability P[γ > δ] for a given thresh-
old δ as
P[γ > δ] = Γ (kS + kI)
Γ (kS)
 θS
δ θI
kI
2 ¯F1

kI, kS + kI, 1 + kI, −θS
δ θI

,
(11.4)
where 2 ¯F1(·, ·, ·, ·) is a regularized hypergeometric function [11].
These observations motivate the application of the Gamma RV as a sensible com-
promise between accuracy and tractability. Further properties of Gamma RVs will
be discussed as needed.
11.2
Hexagonal Reference Model
The reference hexagonal setup is composed of a central cell and six interfering BSs,
as shown in Fig.11.1. The interferers are equipped with omnidirectional antennas and
are located at the edges of a hexagon with radius R (marked as ‘+’ in Fig.11.1). All
BSs are assumed to transmit with the same power. The signal from the ith interfering
BS with polar coordinates (R, Ψi) to a user with polar coordinates (r, φ) experiences
macroscopic path loss and fading. It is assumed that 0 < r ≤R/2, so as to assure

254
M. Rupp et al.
Fig. 11.1 System model.
Center cell with user at
(r, φ). Interfering BSs are
located at (R, Ψi), where
Ψi = 2π i/M, i = 1, . . . , M
that the user is associated with the central BS. The path loss is modeled by the
exponential law
ℓ

d(M)
r,Δi

= min

bP, 1
cP

d(M)
r,Δi
−α
,
(11.5)
where bP denotes the intercept, cP is a constant, α refers to the path loss exponent
and
d(M)
r,Δi =

R2 + r2 −2Rr cos (Δi),
(11.6)
withΔi = φ −Ψi andΨi = 2π i/M, i = 1, . . . , M.Intheremainderofthischapter,
it is assumed that d(M)
r,Δi > (bPcP)−1/α. Exemplifying from [23], a minimum coupling
loss of 70 dB and free space propagation at an LTE-A frequency of fc = 2.14 GHz
yield bP = 10−7, cP = 8.05 × 10−3 and (bPcP)−1/α = 0.028 m, hence justifying this
assumption.
In the hexagonal scenario, M = 6. The terms r and Δi denote the user’s distance
to the center and its angle-difference to the ith interfering BS, respectively. Motivated
by Sect.11.1, fading is modeled by an independent and Identically Distributed (I.I.D.)
Gamma RV Gi ∼Γ [k0, θ0], where k0 and θ0 refer to shape- and scale parameter,
respectively.
11.3
Circular Interference Model
In a one-tier hexagonal grid scenario, as presented in Sect.11.2, the experienced
aggregate interference power at position (r, φ) can be expressed as
I6(r, φ) =
6

i=1
PM Gi ℓ

d(6)
r,Δi

,
(11.7)

11
Modeling Regular Aggregate Interference by Symmetric Structures
255
where PM denotes the transmit power, Gi is the fading and ℓ(d(6)
r,Δi) refers to the path
loss at distance d(6)
r,Δi, as speciﬁed in Eqs.(11.5) and (11.6), respectively. Each sum
term can be regarded as a RV Gi, which is weighted by the factor PM ℓ(d(6)
r,Δi). Hence,
the statistics of I6(r, φ) outside the cell-center, i.e., r > 0, are accessible via a sum of
differently weighted RVs. Since, in general, this does not lead to closed-form results,
as detailed in Chap.12, in this chapter a circular interference model is proposed in
order to facilitate the statistical analysis.
11.3.1
Proposed Model
In the proposed circular interference model, the power of the six reference BSs is
spread uniformly along a circle of radius R. This is achieved by evenly distributing
the total transmit power 6 PM among M equally spaced BSs and considering the
limiting case M →∞. By generalizing Eq.(11.7), this is expressed as
IC(r) = lim
M→∞
6 PM
M
M

i=1
Gi ℓ

d(M)
r,Δi

= 6 PM
2π E [Gi]
π
	
−π
ℓ

dr,Δ

dΔ,
(11.8)
with ℓ(·) from Eq.(11.5) and d(M)
r,Δi from Eq.(11.6). The terms dr,Δ and Δ denote dis-
tance and angle-difference between the user and an inﬁnitesimal interfering circular
segment, as illustrated in Fig.11.1.
Assuming a path loss exponent α = 2, i.e., free space propagation, Eq.(11.8) can
explicitly be evaluated as
IC(r) = 6 PM E [Gi] 1
cP
1
R2 −r2 .
(11.9)
An intuitive interpretation of this result is provided in the next section by the
model’s pendant.
In the remainder of this chapter, α = 2 is employed. It represents the worst case
of low interference attenuation. However, previously- as well as all subsequently
presented analysis can be carried out in closed-form for α = 2n with n ∈N. Values
α other than these require the evaluation of elliptic integrals (see, e.g., [24]). Thus,
a practical ﬁrst order estimate for arbitrary values of α is achieved by evaluating the
performance with 2n and 2(n + 1), where 2n < α < 2(n + 1).
11.3.2
The Dual Model
Consider a user in a hexagonal scenario, which is moved along a circle of radius r
from −π to π, as indicated in Fig.11.1. The average expected interference along the
circle can be calulated as

256
M. Rupp et al.
I ′
C(r) = 1
2π
π
	
−π
E

I6(r, φ′)

dφ′
(11.10)
=
6

i=1
PM E [Gi]
1
2π
π
	
−π
ℓ(dr,Δ)dφ′.
(11.11)
The result is obtained by plugging Eq.(11.7) into Eq.(11.10), exchanging sum and
integral, and exploiting the linearity of the expectation. It is equivalent to IC(r) in
Eq.(11.8) and, consequently, also yields Eq.(11.9). Thus, the result is independent
of the user’s angle-position. It can be interpreted as the average expected interfer-
ence, i.e., the interference experienced by a typical user in a hexagonal scenario at
distance r.
From Eq.(11.9) it is observed that the average expected interference increases by
either increasing the transmit power PM, decreasing the distance of the interferers R,
or moving the user further away from the origin, which is reﬂected by the parame-
ter r. The fading enters the equation only via the expectation, i.e., Eqs.(11.8) and
(11.11) hold for arbitrary fading distributions with ﬁnite mean. Finally, note that the
circular interference model is not restricted to hexagons. By replacing ‘6’ by ‘N’ in
Eqs.(11.7)–(11.11), it can generally be applied for substituting any convex regular
N-polygonal model, as validated in Sect.11.5.1.
11.4
Statistics of Aggregate Interference
In this section, aggregate interference in a hexagonal scenario with I.I.D. Gamma
fading is investigated. Motivated by the ﬁndings in Sect.11.1, it is proposed to
approximate its statistics by a single Gamma RV. The corresponding shape- and
scale parameters are dependent on the distance and can be determined by applying
the previously presented circular model.
11.4.1
Interference Statistics at the Center
Assume I.I.D. Gamma fading with Gi ∼Γ [k0, θ0]. Then, according to Sect.11.3,
interference can be considered as a sum of Gamma RVs, which are weighted by the
factors PM ℓ(d(6)
r,Δi), i.e., the received power without fading.
At the center of a hexagonal scenario (i.e., at r = 0), all weighting factors are
equal, i.e., PM ℓ(d(6)
r,Δi) = PM ℓ(R). By virtue of the scaling- and summation property
of a Gamma RV (cf. Sect.11.1), the resulting interference is distributed as
I6(0, φ) ∼Γ [6 k0, θ0PMℓ(R)] .
(11.12)

11
Modeling Regular Aggregate Interference by Symmetric Structures
257
11.4.2
Interference Statistics Outside the Center
Outside the center (i.e., at r > 0), the distances d(6)
r,Δi and, thus, also the weighting
factors PM ℓ(d(6)
r,Δi ) generally differ from each other. Hence, a non-uniform impact
of the interferers is observed. Then, the interference statistics are only accessible via
evaluating the distribution of a sum of Gamma RVs with varying scale parameter.
This method is particularized in Chap.12.
The current chapter resorts to the following ﬁrst order estimate. It is proposed
to approximate the typically experienced interference distribution at distance r, 0 <
r ≤R/2, by
ˆI(r) ∼Γ [ˆk(r), ˆθ(r)].
(11.13)
The rationale for this model are ﬁndings in prior work, where out-of-cell inter-
ference in stochastic networks is appropriately assessed by a Gamma distribution
[11]. If it can be proven as accurate, it considerably facilitates further performance
analysis by applying the methods in Sect.11.1.
The distribution in Eq.(11.13) is fully determined by the distance-dependent
shape- and scale parameters ˆk(r) and ˆθ(r), respectively. In order to evaluate the two
parameters, ﬁrstly the proposed circular interference model is employed to determine
expectation and variance of ˆI(r). Then, it is exploited that E[ ˆI(r)] = ˆk(r) ˆθ(r) and
Var[ ˆI(r)] = ˆk(r) ˆθ2(r).
As discussed in Sect.11.3.1, the distinct received powers from the interfering BSs
can be averaged along a circle of radius r. Thus, the typical impact of one interferer
is calculated as
PM
1
2π
π
	
−π
ℓ

dr,Δ

dΔ = PM
cP
1
R2 −r2 ,
(11.14)
and yields the average expected interference at distance r as
E

ˆI(r)

= 6 k0θ0
PM
cP
1
R2 −r2 .
(11.15)
The variance of the aggregate interference comprises two components:
1. The variance of the fading, which calculates as
Var f

ˆI(r)

= 6 k0

θ0
PM
cP
1
R2 −r2
2
.
(11.16)
2. The variance of the received power without fading, which is caused by the unequal
distances dr,Δi. With

258
M. Rupp et al.
1
2π
π
	
−π

PMℓ

dr,Δ

−PMℓ(R)
2 dΔ =
 PM
cPR2
2 2r2R4 + r4R2 −r6

R2 −r23
,
(11.17)
the second variance component is obtained as
Vard

ˆI(r)

= 6k0

θ0
PM
cPR2
2 2r2R4 + r4R2 −r6

R2 −r23
.
(11.18)
Since the two components are statistically independent, the overall variance is cal-
culated as
Var

ˆI(r)

= Var f

ˆI(r)

+ Vard

ˆI(r)

= 6 k0

θ0
PM
cP
1
R2 −r2
2 
1 + 2r2R4 + r4R2 −r6
R6 −r2R4

(11.19)
where Var f [ ˆI(r)] and Vard[ ˆI(r)] refer to Eqs.(11.16) and (11.18), respectively.
Finally, the distance-dependent shape- and scale parameter are derived from
Eqs.(11.15) and (11.19) as
ˆk(r) = 6 k0
R4(R2 −r2)
R6 + r2R4 + r4R2 −r6 ,
(11.20)
ˆθ(r) = θ0
PM
cP
1
R2 −r2

1 + 2r2R4 + r4R2 −r6
R6 −r2R4

.
(11.21)
11.5
Numerical Results and Discussion
In this section, the accuracy of the circular model and the proposed Gamma approx-
imation are veriﬁed by numerical evaluation.
11.5.1
Validation of Expected Aggregate Interference
First, the expected interference powers in the hexagonal reference scenario and the
proposed circular interference setup are compared to each other. The transmit power
and inter-site distance are speciﬁed as PM = 40 W and R = 500 m, based on the
standard 3rd Generation Partnership Project (3GPP) macro cell scenario from [23].
Intercept and constant of the path loss ℓ(·) are set bP = 1 and cP = 1 for simplicity.

11
Modeling Regular Aggregate Interference by Symmetric Structures
259
Table 11.1 System
parameters for validation.
Transmit power and circle
radius are referred from [23]
Parameter
Value
Transmit power
PM = 40W
Circle radius
R = 500m
Path loss intercept
bP = 1
Path loss constant
cP = 1
Path loss exponent
α = 2
Fading distribution
Gi ∼Γ [1, 1]
Fading is assumed to be distributed as Gi ∼Γ [1, 1]. The parameters are summarized
in Table11.1.
Consider a user which is moved along a semi circle {(r, φ)| φ ∈[0, π]}, as indi-
cated in Fig.11.1. The expected interference in the hexagonal scenario is calculated
as
E [I6(r, φ)] =
6

i=1
PM E[Gi] ℓ

d(6)
r,Δi

,
(11.22)
with I6(r, φ) from Eq.(11.7) and E[Gi] = 1. For the circular model, E [IC(r)] =
IC(r), with IC(r) from Eq.(11.9).
Figure11.2 depicts the evaluated results of Eqs.(11.9) and (11.22) for various
distances r. It is observed that
• At cell-center, i.e., at r = 0 m, the expected interference powers in the hexagonal-
and circular scenario (E[I6(0, φ)] and IC(0)) are equal.
• Outside the center, i.e., at r > 0 m, E[I6(r, φ)] ﬂuctuates around IC(r). The devi-
ation is weak in the middle of the cell (r = 125 m), and strong at cell-edge
Fig. 11.2 Expected
aggregate interference
experienced at position (r, φ)
in circular- (IC(r)) and
hexagonal model
(E[I6(r, φ)]), respectively.
Receiver distances
r = {0, 125, 250} m refer to
cell-center, middle of cell
and cell-edge, respectively

260
M. Rupp et al.
(r = 250 m). Note that E[I6(r, φ)] is not symmetric about IC(r) due to the con-
cavity of the path loss model.
The relative error of the circular interference model is calculated as
ε (r, φ) =

E [I6(r, φ)] −IC(r)
E [I6(r, φ)]
 ,
(11.23)
with IC(0) and E[I6(0, φ)] from Eqs.(11.9) to (11.22), respectively. The largest error
occurs at cell-edge, i.e.,
max
r,φ ϵ (r, φ) = max
φ
ϵ (250, φ).
(11.24)
In the speciﬁed scenario, maxφ ϵ (250, φ) = 3.2 %, as shown in Fig.11.3.
11.5.2
Validation of Gamma Approximation
In this section, the accuracy of the Gamma approximation in Eq.(11.13) and its para-
meterization by Eqs.(11.20) and (11.21) are veriﬁed. The exact position-dependent
distributions of I6(r, φ) are obtained by evaluating Theorem12.1.
In order to capture a representative proﬁle of distributions, three user distances
r = {0, 125, 250} m and three angle-positions φ = {0, π
12, π
6 } are considered, as
illustrated by bold dots in Fig.11.4. The distances correspond to cell-center, middle
of cell and cell-edge, respectively. The angle φ = 0 represents a user, which is moved
Fig. 11.3 Maximum
deviation of circular
interference model from
expected interference in
convex regular N-polygonal
models. The labeled
cell-shapes can be arranged
in a grid without overlapping
areas

11
Modeling Regular Aggregate Interference by Symmetric Structures
261
Fig. 11.4 Setup for
evaluation. Cutout of
Fig.11.1 (upper right
quadrant)
directly towards its strongest interferer, φ = π
6 refers to the path with two equidistant
dominant interferers, and φ = π
12 is a variation thereof.
Fading is speciﬁed as Gi ∼Γ [2, 1]. This corresponds to a 1 × 2 Single-Input
Multiple-Output SIMO system with Rayleigh-fading and Multiple-Input Single-
Output (MISO) at the user, or, equivalently, a 2 × 1 MISO system with MRT at
the BS.
The Cumulative Distribution Function (CDF) of the Gamma approximation,
FˆI(x; ˆk(r), ˆθ(r)) and the CDF F6(x;r, φ) of I6(r, θ) are evaluated at each distance
r and angle φ, respectively. The accuracy of the Gamma approximation is quantiﬁed
by Kolmogorov–Smirnov KS statistics, which formulate as
DKS(r, φm) = sup
x
FˆI

x; ˆk(r), ˆθ(r)

−F6 (x;r, φ)
 .
(11.25)
Results are depicted in Fig.11.5. The Gamma approximation most closely resem-
bles the experienced interference distributions at φ = π
12. In this case, the difference
between exact- and approximated CDFs is less than 1 % for r < 159 m and 2.75 %
at cell-edge (r = 250 m). The largest deviation occurs at φ = π
6 , where the user is
moved centrally in between its two dominant interferers (upper curve). Then, the
distributions differ by less than 1 % for r < 155 m and by 3.7% at cell-edge.
For qualitative evaluation, Fig.11.6 depicts the exact CDFs and the corresponding
Gamma approximations at the speciﬁed representative user positions, which are
denoted by bold dots in Figs.11.4 and 11.5, respectively.
TheGammaCDFsperfectlyﬁtatcellcenter(r = 0 m)andinthemiddleofthecell
(r = 125 m). At cell-edge (r = 250 m), the Gamma approximation closely resem-
bles the experienced interference of a user at φ = π
12. The probability of high inter-
ference values at φ = π
6 is slightly underestimated by at most 3.7 % (cf. Fig.11.5).

262
M. Rupp et al.
Fig. 11.5 KS statistics at
position (r, φm), comparing
Gamma approximation and
exact distribution. Receiver
distancesr = {0, 125, 250}m
refer to cell-center, middle of
cell and cell-edge,
respectively
Fig. 11.6 Aggregate
interference at particular user
positions (see bold dots in
Fig.11.4): Exact CDFs, as
obtained by numerically
evaluating [25] for a hexagon
scenario dashed lines and
corresponding Gamma
approximations solid lines
11.6
Application in Heterogeneous Networks
In this section, aggregate interference statistics in a two-tier heterogeneous cellular
network with regularly placed macro-BSs and randomly distributed small cell BSs
are investigated. The interference contribution from each tier is approximated by a
single Gamma RV and the total interference is calculated as the sum of the two. The
accuracy of the approximations is veriﬁed by extensive Monte Carlo simulations.
The macro-tier comprises six hexagonally arranged BSs at distance R = 500 m,
each transmitting with PM = 40 W. Small cell BSs are distributed according to a
Poisson Point Process PPP of density μS = 10−4 m−2 and transmit with a power
of PS = 0.4 W. As indicated in Fig.11.7, they are excluded from a ball (in fact,
it is a disc, but ball is the more common term in literature, e.g., in [11]) of radius
REx = (PM/PS)−1/α R/2 around the user so as to ensure user association to the central

11
Modeling Regular Aggregate Interference by Symmetric Structures
263
Fig. 11.7 Snapshot of a
heterogeneous network
deployment. Macro-BSs are
arranged on a hexagon.
Small cell BSs are randomly
distributed around a user at
(r, φ) and excluded from a
ball of radius REx
Table 11.2 Parameters for
numerical evaluation of
heterogeneous scenario
Parameter
Value
Macro-BS transmit power
PM = 40W
Inter macro-site distance
R = 500m
Small cell BS transmit power PS = 0.4W
Small cell density
μS = 10−4m−2
Path loss intercept
bP = 1
Path loss constant
cP = 1
Path loss exponent
α = 4
Fading distribution
Gi ∼Γ [1, 1]
macro-BS at cell-edge. In both tiers, the path loss ℓ(·) is modeled according to
Eq.(11.5), with intercept bP = 1, constant cP = 1 and exponent α = 4. Fading is
assumed to be distributed as Gi ∼Γ [1, 1]. The parameters are summarized in
Table11.2.
In the ﬁrst step, the interference contribution from the macro-tier is approximated
by a Gamma RV ˆIM(r) ∼Γ [ˆkM(r), ˆθM(r)]. According to Sect.11.4, it can be para-
meterized by the circular interference model. Recalculating Eqs.(11.15), (11.16),
(11.18) and (11.19) for α = 4 yields
ˆkM(r) =
6 k0R8 
r2 −R2 
r2 + R22
r14 −7r12R2 + 23r10R4 −41r8R6 + 39r6R8 −25r4R10 −9r2R12 −R14 ,
(11.26)
ˆθM(r) = θ0 PM

−r14 + 7r12R2 −23r10R4 + 41r8R6 −39r6R8 + 25r4R10 + 9r2R12 + R14
cP

r2 −R24 
r2 + R2
R8
.
(11.27)

264
M. Rupp et al.
Secondly, the contribution of the small cell tier is also approximated by a Gamma RV
ˆIS ∼Γ [ˆkS, ˆθS]. Along the lines of [26, Eqs.(2.19) and (2.21)], mean and variance
of the actual interference IA,S from the PPP model are determined as
E[IA,S] = PS E[Gi]2πμS
	 ∞
REx
r ℓ(r)dr
= PS k0 θ0
1
cP
πμS R−2
Ex ,
(11.28)
Var[IA,S] = E[G2
i ]2πμS
	 ∞
REx
r ℓ(r)2dr
= (1 + k0)k0 θ2
0 P2
S
1
c2
P
μSπ
3
R−6
Ex .
(11.29)
Then, exploiting the identities E[ ˆIS] = ˆkS ˆθS and Var[ ˆIS] = ˆkS ˆθ2
S yields
ˆkS = 3R2
Ex k0 θ0 μS
(1 + k0)
,
(11.30)
ˆθS = PS(1 + k0)
3 cP Rα
Ex
.
(11.31)
Finally, the PDF of the total aggregate interference, ˆIA(r) = ˆIM(r) + ˆIS, at user
distance r is calculated as
f ˆIA(x;r) = ˆθM (r)
−ˆkM(r) ˆθ−ˆkS
S
e
−x
ˆθS x
ˆkM(r)+ˆkS−1
× 1 ˜F1

ˆkM (r); ˆkM (r) + ˆkS;
 1
ˆθS
−
1
ˆθM (r)

x

,
(11.32)
where 1 ˜F1(·; ·; ·) denotes the regularized conﬂuent hypergeometric function.
In order to verify the accuracy of this approximation, Monte Carlo simulations are
carried out. The results for a typical user at distance r are obtained by averaging over
106 uniformly distributed angle-positions on [0, 2π]. For each position, 105 fading-
and 104 spatial realizations of the small cell deployment are generated. The small
cell BSs are distributed over a circular area of radius 10R.
Figure11.8a depicts the individual interference contributions from the macro-
and the small cell tier at various user distances r. It is observed that the CDFs for
the macro tier, which correspond to the approximation in Eqs.(11.26), and (11.27),
show an accurate ﬁt with the Monte Carlo simulations. This corroborates the claim
in Sect.11.3.1 that the circular model is also applicable for path loss exponents other
than α = 2. The interference CDF of the small cell tier, which refers to the approx-
imation in Eqs.(11.30) and (11.31), is independent of the user distance r due to
the ﬁxed exclusion radius REx. It is also in close agreement with the simulations.
Figure11.8b shows the CDFs of the aggregate interference from both macro- and

11
Modeling Regular Aggregate Interference by Symmetric Structures
265
Fig. 11.8 CDFs of
interference from macro- and
small cell tier a and
aggregate interference from
both tiers b. Solid lines
indicate results as obtained
by approximating the
contribution of each tier by a
Gamma RV. Dashed lines
show results from Monte
Carlo simulations. User
distances r = {0, 125, 250}
m refer to cell-center, middle
of cell and cell-edge,
respectively
(a)
(b)
Individual tiers
Both tiers
small cell tier. It is found that the approximation by a sum of two independently
parameterized Gamma RVs almost perfectly captures the actual interference char-
acteristics at the cell center (r = 0 m) and in the middle of the cell (r = 125 m). It
even provides an accurate ﬁt at cell-edge (r = 250 m).
11.7
LTE-Advanced System Level Simulations
In this section, the validity of the Gamma distribution for approximating aggregate
interference in symmetric interference scenarios is evaluated. In the ﬁrst part, the
corresponding system model is introduced.

266
M. Rupp et al.
11.7.1
System Model
The system model is composed of a central macro site and six neighboring nodes,
which are arranged according to a hexagonal grid, as illustrated in Fig.11.9. Each
site employs a single eNodeB, which is equipped with an omni-directional antenna.
For systematic investigations, the UEs are equidistantly distributed along concen-
tric circles of radius r = {50, 120, 210} m, referring to cell-center, middle of cell
and cell-edge, respectively. Each circle encompasses 24 UEs, which are uniquely
identiﬁed by the tuple (r, φ), where φ denotes the angle position. The signal expe-
riences free-space path loss, fast fading according to a time-correlated Rayleigh
channel, and spatially-correlated log-normal shadowing with 8 dB standard devia-
tion. Hereinafter, the combination of these three mechanisms is termed composite
fading. The free-space path loss law is deﬁned as min(bP, 1/cPd−2). In this section,
bP = 10−7 and fc = 2.14 GHz, yielding cP = (4π fc/c0)2 = 8.0465 × 103, where
c0 isthespeedoflight.Theshadowfadingmapsarecomputedbyapplyingthemethod
in [27]. The results in this section are obtained by averaging over 100 channel real-
izations and 100 TTIs. The simulation parameters are summarized in Tables9.6 and
11.3, respectively.
Fig. 11.9 Hexagonal grid
setup with central cell and
six interfering eNodeBs.
UEs are equidistantly
distributed along circles of
radius r = {50, 120, 210}m.
Bold dots indicate represen-
tative UE positions. The
corresponding angles are
given by φ = {0, π
12, π
6 },
respectively. In the case of
BS collaboration, eNodeB 7
does not contribute to the
aggregate interference
Table 11.3 Speciﬁc
parameters for simulations of
homogeneous macro cellular
network
Parameter
Value
Antenna conﬁguration
NTx × NRx = 1 × 1
eNodeB antenna gain in dB
A(θ) = 0 dB
Path loss
ℓ(d) = min(bP, 1/cP d−2)
Scheduler type
Round robin

11
Modeling Regular Aggregate Interference by Symmetric Structures
267
11.7.2
Validation of Gamma Approximation
In this section, the introduced circular interference model is validated. The particular
focus lies on the accuracy of the Gamma distribution as an approximation for both
composite fading and aggregate interference. The system model is referred from
Sect.11.7.1.
Firstly, the average aggregate interference is measured along each of the three
UE circles. The results are depicted as solid lines in Fig.11.10. In accordance with
Sect.11.5.1,itisobservedthataverageaggregateinterferenceisalmostconstantatthe
cell-center and in the middle of the cell. At cell-edge, the curves exhibit ﬂuctuations
due to the vicinity of the dominant interferers. Results from the circular interference
model accurately assess the average behavior, as shown by the dashed lines.
In the next step, the Empirical Cumulative Distribution Function (ECDF) of
the aggregate interference is computed at nine representative UE locations, which
are marked by bold dots in Fig.11.9. Similar to Sect.11.5.2, the angle positions
φ = {0, π
6 , π
12} refer to UEs with one dominant interferer (eNodeB 7), two equidis-
tant dominant interferers (eNodeBs 6 and 7) and a variation thereof. Solid lines in
Fig.11.11 depict the results. In accordance with Sect.11.5.2, the interference distri-
butions are dominated by the UEs’ distances to the origin while their angle positions
have only minor impact. The latter is illustrated by the enlarged section in Fig.11.11.
Finally, the introduced circular model is applied to approximate the aggregate
interference distribution at a certain distance r by a Gamma RV. The ﬁrst step con-
sists in determining the parameters k0 and θ0 of the Gamma distribution Γ [k0, θ0]
that models the composite fading (cf. Sect.11.4). This is achieved by applying Algo-
rithm 2. The intital values k′
0 and θ′
0 are obtained from Maximum Likelihood Estima-
tion (MLE). MLE maximizes the likelihood L(k′
0, θ′
0|x) = f (x|k′
0, θ′
0), where f (·)
denotes a Gamma PDF with shape k′
0 and scale θ′
0, and x are the given outcomes.
Fig. 11.10 Average
aggregate interference power
along the three UE circles in
Fig.11.9. Solid curves refer
to simulation results, dashed
curves denote results from
circular interference model

268
M. Rupp et al.
Using a step size of Δ = 0.001 and Niterations = 100 yields a KS distance of 0.0512
between simulated- and approximated composite fading distribution. For compari-
son, employing only MLE achieves a KS distance of 0.0917.
Algorithm 2: Iterative algorithm for improving KS distance between empirical
composite fading distribution and Gamma approximation. The term F(x; k, θ)
denotes the CDF of a Gamma distribution with shape k and scale θ, respectively.
Data: empirical CDF of composite fading from simulations: Ffading(x);
initial shape- and scale parameter: k′
0, θ′
0;
stepsize: Δ;
number of iterations: Niterations;
Result: shape- and scale parameter: k0, θ0;
set k0 = k′
0 and θ0 = θ′
0;
for i = 1 to Niterations do
compute {k∗, t∗} = arg min{k,t}supx|Ffading(x) −F(x; k, θ)|, with
k ∈[k0 −Δ, k0, k0 + Δ] and θ ∈[θ0 −Δ, θ0, θ0 + Δ];
if k∗equals k0 and θ∗equals θ0 then
break;
else
set k0 = k∗and θ0 = θ∗;
end
end
Then, for each UE distance, the parameters of the aggregate interference distrib-
ution, ˆk(r) and ˆθ(r), are calculated with Eqs.(11.20) and (11.21), respectively. The
corresponding CDF curves are depicted as dashed lines in Fig.11.11. It is observed
that the approximated distributions slightly underestimate the occurrence of high
interference values. In order to quantify the deviation from the simulated curves,
Fig. 11.11 Aggregate
interference distributions at
representative UE locations
r = {50, 120, 210}m and
φ = {0, π
12, π
6 }, as marked
by bold dots in Fig.11.9.
Solid lines refer to ECDF
curves from simulations,
dashed lines denote Gamma
approximations as obtained
with circular model

11
Modeling Regular Aggregate Interference by Symmetric Structures
269
Table 11.4 KS distances between Gamma approximations and simulated ECDF curves at repre-
sentative UE locations
φ = 0
φ = π
12
φ = π
6
r = 50m
0.0713
0.0768
0.0762
0.1391
0.1491
0.1454
0.0720
0.0797
0.0773
r = 120m
0.0697
0.0659
0.0698
0.1347
0.1393
0.1300
0.0815
0.0708
0.0701
r = 210m
0.0565
0.0496
0.0466
0.1183
0.1289
0.1274
0.0823
0.0828
0.0840
For each r, the ﬁrst two rows correspond to the Gamma approximation as obtained with the circular
model. In the ﬁrst row, composite fading is estimated with Algorithm 2, while in the second row
it is assessed with MLE, respectively. The third row refers to the direct application of MLE on the
distribution of the aggregate interference
the ﬁrst row in Table11.4 provides the KS distance for each UE location (r, φ). The
values range from 0.05 at r = 210 m to 0.08 at r = 50 m.
For comparison, each simulated curve is also approximated by two further Gamma
distributions. The ﬁrst distribution adapts the circular model and estimates the com-
posite fading by MLE, i.e., it employs the parameters k0 and θ0 that were used above
to initialize Algorithm 2. The second distribution is computed by applying MLE
directly to the simulated aggregate interference. The corresponding KS distances are
likewise listed in the second- and third row of Table11.4 for each UE location (r, φ).
The ﬁrst observation is that Algorithm 2 considerably improves the performance of
the circular model, such that it even exceeds pure MLE of the aggregate interfer-
ence. Hence, the accuracy of the circular model crucially depends on the precision
of the composite fading approximation. Secondly, the results of the MLE range from
0.07 to 0.08, indicating that the assumption of Gamma-distributed interference itself
induces a systematic error.
In summary, the circular model achieves a remarkable accuracy of ﬁt despite its
simplicity, thus corroborating its applicability.
11.8
Conclusion
In this chapter, a circular interference model for aggregate interference analysis in
regular grid deployments is introduced. Particular focus is placed on characterizing
a user at an eccentric location. The expected interference from the circular model is
identiﬁed as the interference that is experienced by a typical user in a hexagonal grid
at a certain distance from the origin. At cell-edge, it deviates by at most 3.2 % from
the actual values.

270
M. Rupp et al.
In a second step, the corresponding interference statistics are approximated by a
single Gamma RV. By means of the circular model, the distance-dependent shape-
and scale parameters are determined in closed form and unveil the two key formative
components of the distribution as the variance of the fading and the variance of the
path loss due to the eccentric user location, respectively. Qualitative- and quantita-
tive comparisons with the exact distributions conﬁrm the accuracy of the Gamma
approximation, yielding KS statistics no higher than 3.7 %.
The circular model’s expedient adaption for representing the well-planned part
of a two-tier heterogeneous cellular network is demonstrated. The example merges
a fully regular macro-deployment with completely randomly distributed small cells
and models the interference contribution from each tier by a single Gamma RV. The
resulting aggregate interference distribution shows a remarkably good ﬁt with Monte
Carlo simulations. Hence, the model enables to accurately capture the impact of both
user eccentricity and heterogeneity of the network with only few key parameters.
In the last part of the chapter, it is shown that the circular model enables an accu-
rate prediction of the interference statistics in an LTE-A hexagonal grid scenario.
Deviations from the simulation results mainly stem from the inaccurate approxima-
tion of the composite fading. The remainder of the approximation error is caused by
the assumption of Gamma distributed aggregate interference itself.
The presented circular model does not allow to account for power control and
coordination among BSs. This is a major motivation for the next chapter, which
extends the model by non-uniform power proﬁles.
References
1. J. Gertner, The Idea Factory: Bell Labs and the Great Age of American Innovation (Penguin
Group, New York, 2012)
2. P. Marsch, G. Fettweis, Static clustering for cooperative multi-point (CoMP) in mobile com-
munications, in IEEE International Conference on Communications (ICC) Kyoto, June (2011).
doi:10.1109/icc.2011.5963458
3. C. Ball, R. Mullner, J. Lienhart, H. Winkler, Performance analysis of closed and open loop
MIMO in LTE, in European Wireless Conference (EW), pp. 260–265, Aalborg, May (2009).
doi:10.1109/EW.2009.5358012
4. A. Farajidana, W. Chen, A. Damnjanovic, T. Yoo, D. Malladi, C. Lott, 3GPP LTE downlink sys-
tem performance, in IEEE Global Telecommunication Conference (GLOBECOM) Honolulu,
December (2009). doi:10.1109/GLOCOM.2009.5425327
5. J. Giese, M. Amin, S. Brueck, Application of coordinated beam selection in heterogeneous
LTE-advanced networks, in International Symposium on Wireless Communications Systems
(ISWCS), pp. 730–734, Aachen, November (2011)
6. Y. Liang, A. Goldsmith, G. Foschini, R. Valenzuela, D. Chizhik, Evolution of base stations in
cellular networks: denser deployment versus coordination, in IEEE International Conference
on Communications (ICC), pp. 4128–4132, Beijing, May (2008). doi:10.1109/ICC.2008.775
7. T. Novlan, R. Ganti, J. Andrews, Coverage in two-tier cellular networks with fractional fre-
quency reuse, in IEEE Global Telecommunications Conference (GLOBECOM), Houston,
December (2011). doi:10.1109/GLOCOM.2011.6133767

11
Modeling Regular Aggregate Interference by Symmetric Structures
271
8. F. Di Salvo, A characterization of the distribution of a weighted sum of Gamma variables
through multiple hypergeometric functions. Integral Transforms Special Funct. 19(8), 563–
575 (2008). doi:10.1080/10652460802045258
9. M. Haenggi, J. Andrews, F. Baccelli, O. Dousse, M. Franceschetti, Stochastic geometry and
random graphs for the analysis and design of wireless networks. IEEE J. Sel. Areas Commun.
27(7), 1029–1046 (2009). doi:10.1109/JSAC.2009.090902
10. M. Haenggi, Stochastic Geometry for Wireless Networks (Cambridge University Press, Cam-
bridge, 2012)
11. R.W. Heath Jr., M. Kountouris, T. Bai, Modeling heterogeneous network interference using
Poisson point processes. IEEE Trans. Signal Process. 61(16), 4114–4126 (2013). doi:10.1109/
TSP.2013.2262679
12. Y. Zhuang, Y. Luo, L. Cai, J. Pan, A geometric probability model for capacity analysis and
interference estimation in wireless mobile cellular systems, in IEEE Global Telecommunica-
tions Conference (GLOBECOM) Houston, December (2011). doi:10.1109/GLOCOM.2011.
6134503
13. K.B. Baltzis, Hexagonal vs Circular Cell Shape: A Comparative Analysis and Evaluation
of the Two Popular Modeling Approximations, Cellular Networks-Positioning, Performance
Analysis, Reliability (InTech, Rijeka, 2011). doi:10.5772/626
14. M. Taranetz, M. Rupp, A circular interference model for wireless cellular networks, in Proceed-
ings of the International Wireless Communications & Mobile Computing Conference, Nicosia
(2014)
15. M. Taranetz, System level modeling and evaluation of heterogeneous cellular networks,
Ph.D. dissertation, Institute of Telecommunications, TU Wien (2015). http://theses.eurasip.
org/theses/611/system-level-modeling-and-evaluation-of/
16. I. Kostic, Analytical approach to performance analysis for channel subject to shadowing and
fading. IEEE Proc. Commun. 152(6), 821–827 (2005)
17. S. Al-Ahmadi, H. Yanikomeroglu, On the approximation of the generalized-K PDF by a gamma
PDF using the moment matching method, in IEEE Wireless Communications and Networking
Conference (WCNC) Budapest, April (2009). doi:10.1109/WCNC.2009.4917849
18. S. Al-Ahmadi, H. Yanikomeroglu, On the use of high-order moment matching to approxi-
mate the generalized-K distribution by a gamma distribution, in IEEE Global Telecommunica-
tion Conference (GLOBECOM) Honolulu, November (2009). doi:10.1109/GLOCOM.2009.
5425259
19. J. Zhang, M. Matthaiou, Z. Tan, H. Wang, Performance analysis of digital communication
systems over composite η −μ gamma fading channels. IEEE Trans. Veh. Technol. 61(7),
3114–3124 (2012). doi:10.1109/TVT.2012.2199344
20. R.W. Heath Jr., T. Wu, Y.H. Kwon, A. Soong, Multiuser MIMO in distributed antenna systems
with out-of-cell interference. IEEE Trans. Signal Process. 59(10), 4885–4899 (2011). doi:10.
1109/TSP.2011.2161985
21. S. Kusaladharma, C. Tellambura, Aggregate interference analysis for underlay cognitive radio
networks. IEEE Wireless Commun. Lett. 1(6), 641–644 (2012). doi:10.1109/WCL.2012.
091312.120600
22. C.A. Coelho, J.T. Mexia, On the distribution of the product and ratio of independent generalized
gamma-ratio random variables. Sankhy¯a: Indian J. Statist. 69(12), 221–255 (2007)
23. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access (E-
UTRA);radiofrequency(RF)systemscenarios,in3rdGenerationPartnershipProject (3GPP),
TR 36.942, October (2014)
24. I.S. Gradshteyn, I.M. Ryzhik, Table of Integrals, Series, and Products, 7th edn. (Else-
vier/Academic Press, Amsterdam, 2007)

272
M. Rupp et al.
25. P. Moschopoulos, The distribution of the sum of independent gamma random variables. Ann.
Inst. Statist. Math. 37(1), 541–544 (1985)
26. F. Baccelli, B. Blaszczyszyn, Stochastic Geometry and Wireless Networks: Volume I The-
ory, Foundation and Trends in Networking (Now Publishers, Hanover, 2009). doi:10.1561/
1300000006
27. H. Claussen, Efﬁcient modelling of channel maps with correlated shadow fading in mobile
radio systems, in IEEE International Symposium on Personal, Indoor and Mobile Radio Com-
munications (PIMRC), vol. 1, pp. 512–516, Berlin, September (2005)

Chapter 12
Modeling Asymmetric Aggregate
Interference by Symmetric Structures
Markus Rupp, Stefan Schwarz and Martin Taranetz
In this chapter, the circular model from Chap.11 is extended by non-uniform power
proﬁles along the circles. The enhanced model enables to aggregate given interferer
deployments such that the original interference statistics are accurately preserved
while the amount of relevant interferers is reduced considerably.
Scaling up the number of base stations per unit area is one of the major trends
in mobile cellular systems of the fourth (4G)- and ﬁfth generation (5G) [1], making
it increasingly difﬁcult to characterize aggregate interference statistics with system
models of low complexity. Tractable interference statistics have mainly been reported
in the ﬁeld of stochastic geometry. When closed-form expressions are desired, this
mathematical framework imposes its own particular limitations, typically including
spatial stationarity and isotropy of the scenario [2–4]. Hence, the potential to consider
an asymmetric interference impact is very limited and notions such as cell-center
and cell-edge are, in general, not accessible. Based on [5, 6], the contributions of
this chapter outline as follows:
• A new circular interference model is introduced. The key idea is to map arbitrary
out-of-cell interferer deployments onto circles of uniformly spaced nodes such
that the original aggregate interference statistics can accurately be reproduced.
The model greatly reduces complexity as the number of participating interferers
is signiﬁcantly reduced.
• A mapping scheme that speciﬁes a procedure for determining the power proﬁles
of arbitrary interferer deployments is proposed. Its performance is evaluated by
means of Kolmogorov–Smirnov (KS) statistics. The test scenarios are modeled by
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_12
273

274
M. Rupp et al.
Poisson Point Processes (PPPs) so as to confront the regular circular structure with
complete spatial randomness. It is shown that the individual spatial realizations
exhibit largely diverging power proﬁles.
• A new ﬁnite sum representation for the Probability Density Function (PDF) of
the sum of Gamma Random Variables (RVs) with integer-valued shape para-
meter is introduced to further enhance and validate interference analysis with
the circular model. Its restriction to integer-valued shape parameters is driven by
relevant use cases for wireless communication engineering and the availability of
exact solutions. The key strength of the proposed approach lies in the ability to
decompose the interference distribution into the contributions of the individual
interferers.
• Statistics of aggregate interference with asymmetric interference impact are inves-
tigated. The asymmetry is induced by eccentrically placing a user in a generic,
isotropicscenario.Thissetupisachievedbyapplyingtheintroducedcircularmodel
with uniform power proﬁles. The model enables to employ the proposed ﬁnite sum
representation. It is shown that the partition of the interference distribution is par-
ticularly useful to identify candidate Base Stations (BSs) for user-centric BS col-
laboration schemes. Moreover, the framework allows to predict the corresponding
Signal-to-Interference Ratio (SIR)- and rate statistics.
The main focus of this chapter is on downlink transmission in cellular networks.
A comparable framework for the uplink is found in [7].
This chapter is organized as follows. Sections12.1 and 12.2 introduce the circular
interference model and the new ﬁnite sum representation for the sum of Gamma RVs
with integer-valued shape parameter, respectively. Section12.3 presents a mapping
scheme and validates the applicability of the circular model. Section12.4 investigates
aggregate interference statistics and the performance of BS collaboration schemes
at eccentric user locations. In Sect.12.5, the rate performance as predicted by the
circular model is compared against Long Term Evolution-Advanced (LTE-A) system
level simulations.
12.1
Circular Interference Model
Consider the serving BS to be located at the origin. The proposed circular interference
model is composed of C concentric circles of interferers, as shown in Fig.12.1. On
circle c ∈{1, . . . , C} of radius Rc, Nc interfering nodes are spread out equidistantly.
The interferer locations are expressed in terms of polar coordinates as (Rc, Ψc,n),
where Ψc,n = 2πn/Nc −φc, with n ∈{1, . . . , Nc} and φc ∈[0, 2π). Each node is
unambiguously assigned to a tuple (c, n) and labeled as Tc,n. The central BS is
denoted as T0,0. Some of the interferers on the circles may also become serving nodes
when BS collaboration schemes are applied, as will be shown later in Sect.12.4.3.
The interferers on the circles do not necessarily represent real physical sources. As
illustrated in Fig.12.2, they rather correspond to the Nc mapping points of an angle-
dependent power proﬁle pc[n], with Nc
n=1 pc[n] = 1. Exemplary proﬁles of a single

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
275
Fig. 12.1 Circular interference model with C circles of radius Rc and phase φc, c ∈{1, . . . , C},
and user at (r, 0). Tc,n denotes the nodes of the model
Fig. 12.2 Circular interference model with two circles, i.e., C = 2. Characteristics of an arbitrary
heterogeneous interferer deployment are condensed to circles of equidistantly spaced nodes Tc,n
such that the original interference statistics can accurately be reproduced. A mapping scheme is
presented in Sect.12.3. The original BSs are distributed within an annulus of inner radius Rin and
outer radius Rout
circleareshowninFig.12.3.Intuitively, pc[n]condensestheinterferercharacteristics
of an annulus with inner radius Rc (Rin in case of c = 1) and possibly outer radius
Rc+1 (Rout in case of c = C) such that the circular model equivalently reproduces the
original BS deployment in terms of interference statistics. This technique enables to
represent substantially large networks by a ﬁnite- and well-deﬁned constellation of
nodes. By reducing the number of relevant interferers, it greatly reduces complexity
and thus allows to apply ﬁnite sum-representations as those introduced in Sect.12.2.

276
M. Rupp et al.
0
5
10
15
20
0
0.1
0.2
0.3
0.4
0.5
Mapping point index n
10 interferers
1000 interferers
Hexagonal grid
100 interferers
Power profile p1[n]
0
5
10
15
20
0
0.1
0.2
0.3
0.4
0.5
Mapping point index n
Power profile p1[n]
0
5
10
15
20
0
0.1
0.2
0.3
0.4
0.5
Mapping point index n
Power profile p1[n]
0
2
4
6
8
10
12
0
0.1
0.2
0.3
0.4
0.5
Mapping point index n
Power profile p1[n]
(a)
(b)
(c)
(d)
Fig. 12.3 Power proﬁles of circular models with one circle, i.e., C = 1, for three stochastic inter-
ference scenarios (a–c) with N1 = 20 mapping points, and for a hexagonal grid with N1 = 12
mapping points, respectively. The stochastic BS distributions are modeled by a PPP of intensity
λ = 10−6 m−2. The expected number of interferers as denoted by the ﬁgure labels, is varied by
altering the scenario size
Table 12.1 Parameters of the circular interference model
Symbol
Annotation
Rin
Inner radius of mapping region, Rin ≥0
Rout
Outer radius of mapping region, Rout > Rin
C
Number of interferer circles, C ∈N+
Rc
Radius of circle c, c ∈{1, . . . , C}, Rc > 0
φc
Phase of circle c, c ∈{1, . . . , C} φc ∈[−π
Nc , π
Nc ]
Nc
Number of mapping points, c ∈{1, . . . , C}, Nc ∈N+
Pc
Total transmit power of circle c, c ∈{1, . . . , C}, Pc > 0
pc[n]
Power proﬁle of circle c, c ∈{1, . . . , C}, n ∈{1, . . . , Nc}, pc[n] ∈[0, 1]
Table12.1 summarizes the parameters of the model. Typically, the size of the
mapping region, as speciﬁed by Rin and Rout, is predetermined by the scenario. The
freely selectable variables are the amount of circles C and, for each circle, the phase

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
277
φc, the radius Rc and the number of mapping points Nc, respectively. Section12.3
presents systematic experiments to provide a reference for the parameter setting and
proposes a mapping scheme to determine power proﬁles pc[n] and transmit powers
Pc, respectively.
A signal from node Tc,n, located at (Rc, Ψc,n), to a user at (r, 0) experiences path
loss ℓ(dc,n(r)), where dc,n(r) =

R2c + r2 −2Rcr cos(Ψc,n) (cf. Fig.12.1) and ℓ(·)
is an arbitrary distance-dependent path loss law, as well as fading, which is modeled
by statistically independent RVs Gc,n. The received power from node Tc,n at position
(r, 0) is determined as
PRx,c,n(r) = Pc pc[n] ℓ(dc,n(r)) Gc,n,
(12.1)
where Pc denotes the total transmit power of circle c. It is important to note that
the term PRx,c,n(r) can be interpreted as a RVs Gc,n, which is scaled by a factor of
Pc pc[n] ℓ(dc,n(r)).
Thenodesemployomnidirectionalantennaswithunitantennagain.Characteristics
of antenna directivity are incorporated into the power proﬁle. In general, the central
cell will have an irregular shape that can be determined by Voronoi tessellation [8].
For simplicity, the small ball approximation from [8] is applied. A user is considered
as cell-edge user, if it is located at the edge of the central Voronoi cell’s inscribing
ball. This approximation misses some poorly covered areas at the actual cell-edge
with marginal loss of accuracy [8].
Let S and I denote the sets of nodes Tc,n corresponding to desired signal and
interference, respectively. Then, the aggregate signal- and interference powers are
calculated as
S(r) =

{(c,n)|Tc,n∈S }
PRx,c,n(r),
(12.2)
I (r) =

{(c,n)|Tc,n∈I }
PRx,c,n(r),
(12.3)
with PRx,c,n(r) from Eq.12.1. The setS may include the central node T0,0 as well as
nodes on the circles, if collaboration among the BSs is employed. The incoherence
assumption is exploited for a more realistic assessment of the co-channel interference
[9]. Following the interpretation of Eqs.12.1, 15.6 and 15.7 can be viewed as sums
of scaled RVs, which are supported by a vast amount of literature for certain fading
distributions such as Rayleigh, log-normal and Nakagami-m [10–29].
This chapter places particular focus upon the Gamma distribution due to its wide
range of useful features for wireless communication engineering. Preliminary infor-
mation is provided in Sect.11.1. The next section introduces a new theorem on the
sum of Gamma RVs. The theorem is presented before validating the accuracy of the
circular model as it is later exploited for this purpose.

278
M. Rupp et al.
12.2
Distribution of the Sum of Gamma Random Variables
As explained in Sect.11.1, the Gamma distribution exhibits the summation property,
i.e., if Gi ∼Γ [ki, θ] with i = 1, 2, . . . , N, then N
i=1 Gi ∼Γ [N
i=1 ki, θ]. While
this feature is convenient to apply, it is the sum of Gamma RVs with distinct scale
parameters that has attracted a lot of attention in describing wireless communica-
tions though. Most commonly, it emerged in the performance analysis of diversity
combining receivers and the study of aggregate co-channel interference under
Rayleigh fading [10–20]. Therefore, communication engineers have considerably
pushed the search for closed form statistics.
Representatively, Moschopoulos’ much-cited series expansion in [21] was
extended for correlated Gamma RVs in [10]. Other approaches based on the inverse
Mellin transform (e.g., [30, 31]) paved the way for representations with a single inte-
gral as shown, e.g., in [12] or a Lauricella hypergeometric series as employed, e.g., in
[11, 16].
All the aforementioned contributions focus on the sum of Gamma RVs with real-
valued shape parameter. The resulting integrals and inﬁnite series, despite being com-
posed of elementary functions, typically yield a slow rate of convergence. Therefore,
an accurate approximation by a truncated series requires to keep a high amount of
terms and complicates further analysis.
The sum of Gamma RVs with integer shape parameter has mainly been reported
in statistical literature. Initial approaches focused on the moment generating function
and results were obtained in the form of series expansions [22]. Based on the work
of [23, 24] was among the ﬁrst to formulate a convenient closed form solution. Soon
after, the Generalized Integer Gamma (GIG) distribution was published in [25].
This approach was also adopted in wireless communication engineering [13, 15]. In
comparison to RVs with real-valued shape parameter, the PDF of the sum of RVs
with integer shape parameter allows an exact representation by a ﬁnite series.
12.2.1
Proposed Finite Sum Representation
In the analysis of aggregate interference statistics, it is particularly desirable to iden-
tify the main distribution-shaping factors, i.e., the interfering sources with the high-
est impact. However, the expressions in [13, 15] are not suitable for this task due to
multiple nested sums and recursions. The proposed ﬁnite-sum representation in this
chapter avoids recursive functions and enables to straightforwardly trace the main
determinants of the distribution characteristics.
Theorem 12.1 Let Gl ∼Γ [kl, θl] be L independent Gamma RVs with kl ∈N+ and
all θl different. Then, the PDF of Y = G1 + · · · + GL can be expressed as
fY(y) =
L

l=1
Λl
θkl
l
hkl−1,l(0)e−y/θl
(12.4)

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
279
with
Λl = (−1)kl+1
(kl −1)!
L

i=1,i̸=l

1 −θi
θl
−ki
,
l = 1, . . . , L
(12.5)
hδ+1,l(ζ) = h1,l(ζ)hδ,l(ζ) + d
dζ hδ,l(ζ),
δ = 0, . . . , kl −1
(12.6)
and
h1,l(0) = −y +
L

i=1,i̸=l
ki
 1
θi
−1
θl
−1
,
l = 1, . . . , L
(12.7)
h(m)
1,l (0) = m!
L

i=1,i̸=l
ki
 1
θi
−1
θl
−m−1
,
m = 1, . . . , kl −1
(12.8)
Proof The proof is provided in [6, Appendix C].
The uniqueness of θl can be assumed without loss of generality. In case of some θl
being equal, the corresponding RVs are added up by virtue of the summation property
of Gamma RVs (cf. Sect.11.1).
Superscript (m) of h(m)
1,l (ζ) denotes the mth derivative of h1,l(ζ). The recursive
determination of hδ,l(ζ) in Eq.12.6 seemingly interrupts the straightforward calcu-
lation of fY(y). However, hδ,l(ζ) is a function of only h1,l(ζ) and its higher order
derivatives. Therefore, the function series in Eq.12.6 can be evaluated in advance
up to the highest required degree δmax = maxl kl −1.
Thus, the proposed approach enables the exact calculation of fY(y) in a
component-wise manner. In the next step, it is shown how to apply Theorem 12.1 in
the proposed circular model.
12.2.2
Application in Circular Interference Model
Assume that Gc,n ∼Γ [kc,n, θc,n] in Eq.12.1, with kc,n ∈N+ and θc,n > 0. Then,
Eqs.15.6 and 15.7 represent sums of scaled Gamma RVs PRx,c,n(r) ∼Γ [kc,n,
θ′
c,n(r)], where θ′
c,n(r) = Pc pc[n] · ℓ(dc,n(r)) θc,n. Therefore, their PDFs can be
determined by applying Theorem 12.1.
The theorem requires all scale parameters to be different. Thus, let θI (r)
denote the vector of unique scale parameters θ′
c,n(r) with (c, n) from the set
{(c, n)|Tc,n ∈I }. A second vector kI contains the corresponding shape parame-
ters. By virtue of the summation property, if θ′
c,n(r) occurs multiple times in the set,
the respective shape parameter in kI is calculated as the sum of shape parameters
kc,n of the according entries. The vectors θS (r) and kS are obtained equivalently.
Then, the PDFs of S(r) and I (r) are expressed as

280
M. Rupp et al.
fS(γ ;r) =
LS

l=1
Λl
θl(r)kl hkl−1,l(0)e−γ/θl(r),
(12.9)
fI(γ ;r) =
LI

l=1
Λl
θl(r)kl hkl−1,l(0)e−γ/θl(r),
(12.10)
with Λl and hδ,l(·) as deﬁned in Eqs.(12.5) and (12.6). Subscript l indicates the lth
components of the vectors kS (θS (r)) and kI (θI (r)) and LS and LI are their
corresponding lengths, respectively.
Hence, employing Theorem 12.1 allows to evaluate the exact distributions of the
aggregate signal- and interference from the circular model by ﬁnite sums. In the
following section, this fact is exploited to verify the accuracy of the model.
12.3
Mapping Scheme for Stochastic Network Deployments
This section presents a procedure to determine the power proﬁles pc[n] and the
corresponding powers Pc of the circular model for completely random interferer
distributions. Then, systematic experiments are carried out to provide a reference for
selecting the free variables C and Nc, respectively. The parameters Rc and φc are
also speciﬁed by the procedure. The accuracy of the approximation is measured by
means of the KS distance. It is deﬁned as
DKS(r) = supx
FI,original(x;r) −FI,circular(x;r)
 ,
(12.11)
where r refers to the user’s eccentricity and FI,original(x;r) and FI,circular(x;r) denote
the aggregate-interference Cumulative Distribution Functions (CDFs) of the origi-
nal deployment and the circular model, respectively. The corresponding PDFs are
obtained by applying Theorem 12.1.
12.3.1
Mapping Procedure
Let N denote a (possibly heterogeneous) set of BSs that are arbitrarily distributed
within an annulus A of inner radius Rin and outer radius Rout, as shown in Fig.12.2.
Radius Rout as well as the number of nodes in N could be substantially large. Given
a circular model with C circles and Nc nodes per circle, the parameters Pc, Rc and
φc as well as the power proﬁle pc[n] can be determined by Algorithm 3.

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
281
Algorithm 3: Mapping procedure for circular model.
Data: number of circles C; nodes per circle Nc;
original base station deployment N ;
inner- and outer radius of mapping region A : Rin and Rout;
Result: Pc, pc[n], Rc and φc for all c ≤C;
for c = 1 to C do
determine Rc and φc based on the strongest interferer that has not yet been mapped;
end
for c = 1 to C do
specify mapping region Ac with inner radius Rc and outer radius Rc+1;
if c = 1 then set inner radius of Ac to Rin; end
if c = C then set outer radius of Ac to Rout; end
compute Pc and pc[n] for Ac;
end
The presented procedure employs the origin as a reference point and therefore
does not depend on the user location. The computation of Pc and pc[n] outlines as
follows. Let Tc,n denote node n on circle c. Assume that its associated mapping
area Ac,n is bounded by the circles of radius Rc and Rc+1 (in the case of c = 1,
the inner radius is set to Rin; for c = C the outer radius is set to Rout) as well as
the perpendicular bisectors of the two line segments Tc,nTc,n−1, and Tc,nTc,n+1, as
illustrated in Fig.12.2. This yields an even division of circle c’s mapping area Ac,
which can be formulated as Ac = 	
n∈{1,...,Nc} Ac,n. The average received power at
the origin from all considered BSs in Ac is calculated as
PRx,Ac =

i ∈N ∩Ac
PTx,i ℓ(di)E[Gi],
(12.12)
where PTx,i, di and Gi correspond to transmit power, distance and experienced fading
of interferer i, respectively. Then, the total transmit power Pc is obtained by mapping
PRx,Ac back on the circle, which formulates as Pc = PRx,Ac ℓ(Rc)−1. Hence, in this
scheme the average received powers from the original deployment and the circular
model are equivalent at the origin. The segmentation of Ac into areas Ac,n yields the
corresponding power proﬁle
pc[n] =
1
PRx,Ac
⎛
⎝

i ∈N ∩Ac,n
PTx,i ℓ(di)
⎞
⎠,
(12.13)
with PRx,Ac from Eq.12.12.
In the presented procedure, the parameters Rc and φc are set such that the cth
dominant interferer coincides with a node on circle c, as illustrated in Fig.12.2. This
ensures that R1 ≥Rin (in a heterogeneous network, as investigated in Sect.12.3.3,
non-dominant interferers between Rin and R1 are mapped “back” on circle 1 by the
receive-power dependent weighting in Eq.12.13) and RC ≤Rout, and is especially

282
M. Rupp et al.
suitable for completely random interferer distributions, as demonstrated in the next
section. In fully regular scenarios, on the other hand, a circle comprises multiple,
equally dominant nodes, making it expedient to specify Rc and φc according to the
structure of the grid. For example, the circular model allows to perfectly represent
a hexagonal grid setup, when the number of mapping points is set as a multiple of
six. Then, the nodes on the circle coincide with the actual interferer locations. An
exemplary power proﬁle for N1 = 12 is shown in Fig.12.3d.
Algorithm 3 is one of many possible mapping approaches. It is a heuristic, based
on my experience and observations and is thus not claimed to be optimal. Its reﬁne-
ment yields an interesting topic for further work. In the next two sections, systematic
experiments in completely random scenarios are performed to provide a reference for
setting C and Nc. For reasons of clarity, Sect.12.3.2 is limited to homogeneous BS
deployments. Heterogeneous setups are then evaluated in Sect.12.3.3. It is refrained
from stochastic scenarios with a certain degree of regularity, since measuring spatial
inhomogeneity is itself an ongoing topic of research [32]. Completely random- and
fully regular scenarios are considered as limiting cases, encompassing every con-
ceivable practical deployment in between.
12.3.2
Performance Evaluation of Homogeneous Base
Station Deployments
The original interferer deployment N is modeled by a PPP of intensity λ. Such
process is considered most challenging for the regularly structured circular model,
as it represents complete spatial randomness. Signal attenuation is modeled by a
log-distance dependent path loss law ℓ(x) = min(bP, 1/cP x−4), and Gamma fading
with k = 2 and θ = 1, referring to a 2 × 1 Multiple-Input Single-Output (MISO)
setup and Maximum Ratio Transmission (MRT). In this chapter, bP = 1 and cP = 1
for simplicity. The BSs transmit with power PT 1 = 40 W and are distributed within
an annular regions of inner radius Rin = 500 m and Rout =

NI/(πλ) + R2
in. Radius
Rin ensures that the inscribing ball of the central cell has a minimum radius of 250 m,
assuming that the central BS also transmits with PT 1. The outer radii Rout are chosen
such that, on average, NI BSs locations are generated within the corresponding
annulus. Consider a PPP of intensity λ within an annulus of inner radius Rin and
outer radius Rout. The expected number of generated nodes is calculated as NI =
λ(R2
out −R2
in)π. In order to cover a wide range of scenarios, NI = {100, 1000} and
λ = {0.5 × 10−6, 10−6} m−2 are studied. The parameter settings are summarized in
Table12.2.
For each scenario snapshot, eight circular models with C = {1, 2, 3, 4} and two
distinct values of Nc are set up according to Sect.12.3.1. In the case of λ = 0.5 ×
10−6 m−2, Nc = {10, 20} and, for λ = 10−6 m−2, Nc = {20, 40}, respectively. Then,
the aggregate interference distributions are determined. The distributions for the
original interferer deployment are only obtained via simulations (by averaging over

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
283
Table 12.2 System setup for evaluation
Parameter
Value
Transmit power
PT 1 = 40 W (PT 2 = 4 W)
Node density
λ = {0.5 × 10−6, 10−6} m−2 (λ2 = 0.5 × 10−5 m−2)
Expected number of interferers
NI = {100, 1000}
Path loss
ℓ(x) = min(bP, 1/cP x−4), bP = 1, cP = 1, x > 0
Fading
Gc,n ∼Γ [2, 1]
1000 spatial realizations and 10,000 fading realizations), since the vast amount of
nodes hampers the application of Theorem 12.1 due to complexity issues. On the
other hand, the circular models comprise at most 43 active nodes and therefore enable
to utilize the theorem. This number is obtained for C = 4 and Nc = 40, and stems
from the fact that in a homogeneous BSs deployment, the dominant interferers are
also the closest ones. Therefore, the presented scheme only maps a single BSs on
each circle c < C, i.e., except for c = C there is only one active node per circle.
Figure12.4 depicts KS distances over the user eccentricity r. The ﬁrst important
observation is that the accuracy considerably improves with an increasing number
of circles C. This mainly results from accurately capturing the ﬁrst few dominant
BSs that have the largest impact on the aggregate interference distribution, as later
shown in Sect.12.4. A second remarkable observation is that doubling the amount of
nodes per circle from Nc = 10 to Nc = 20 for λ = 0.5 × 10−6 m2 (cf. Fig.12.4a, b),
and from Nc = 20 to Nc = 40 for λ = 10−6 m2 (cf. Fig.12.4c, d) does not achieve
smaller KS distances, respectively. This result indicates that it is rather the number of
circles C than the number of nodes per circle Nc that impacts the accuracy. As shown
in the examples, good operating points for homogeneous macro-BS deployments are
Nc = 20 and C = 4, independent of the deployment parameters. Lastly, it should be
noted that the circular model allows to represent 1000 and more interferers by some
10 nodes with KS distances at the cell-edge not exceeding 0.05.
12.3.3
Performance Evaluation of Heterogeneous Base
Station Deployments
In this section, a second independent PPP of intensity λ2 = 0.5 × 10−5 m−2 is added
on top of the PPP scenarios with λ = 0.5 × 10−6 m−2 in Sect.12.3.2. The corre-
sponding nodes transmit with normalized power PT 2 = 4 W, thus representing a
dense overlay of low power BSs. For simplicity, they are distributed within annuli of
inner radius Rin and outer radii Rout as speciﬁed above. Note that in order to ensure
that the inscribing ball of the central cell has a radius of 250 m, an inner radius of
1 + (PT 1/PT 2)−1/α would be sufﬁcient. This yields a total number of {1100, 11 000}
expected interferers, respectively. For each snapshot, Algorithm 3 is applied with

284
M. Rupp et al.
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
C=2
C=1
C=3
C=4
NI = 100
NI = 1000
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
C=2
C=1
C=3
C=4
NI = 100
NI = 1000
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
C=2
C=1
C=3
C=4
NI = 100
NI = 1000
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
C=2
C=1
C=3
C=4
NI = 100
NI = 1000
(a)
(b)
(c)
(d)
Fig. 12.4 KS distance over user eccentricity r. Plot markers {“◦”, “▽”} refer to various sce-
nario sizes with NI = {100, 1000} expected interferers, respectively. Different line styles denote
circular models with C = {1, 2, 3, 4}. Figure labels refer to the corresponding number of nodes
per circle, Nc, and the spatial density λ of the original interferer deployment. Black bars depict
95 % conﬁdence intervals a Nc = 10, λ = 0.5 × 10−6 m−2, b Nc = 20, λ = 0.5 × 10−6 m−2, c
Nc = 20, λ = 0.5 × 10−6 m−2, d Nc = 40, λ = 0.5 × 10−6 m−2
C = {2, 4, 6, 8, 10, 12} and Nc = {10, 20}. The performance evaluation is carried
out along the lines of Sect.12.3.2 and the parameters are summarized in Table12.2.
Figure12.5 depicts the results in terms of KS distances. It is observed that, in
accordance with Sect.12.3.2, accuracy is rather improved by increasing the number
of circles C than by employing more nodes per circle (i.e., increasing Nc). In the
heterogeneous scenarios the number of circles has to be roughly tripled in order to
achieve a performance similar to the homogeneous cases (cf. Fig.12.5), although
mapping 11 times as many interferers.

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
285
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
1100 expected interferers
11000 expected interferers
C=4
C=2
C=8
C=6
C=10
C=12
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
Kolmogorov-Smirnov distance
User eccentricity r[m]
1100 expected interferers
11000 expected interferers
C=4
C=2
C=8
C=6
C=10
C=12
(a)
(b)
Fig. 12.5 KS distance over user eccentricity r for heterogeneous PPP scenarios with λ = 0.5 ×
10−6 m−2 (PT 1 = 40 W) and λ2 = 0.5 × 10−5 m−2 (PT 2 = 4 W). Plot markers {“◦”, “▽”} refer
to various scenario sizes with {1100, 11,000} expected interferers, respectively. Different line styles
denotecircularmodelswithC = {2, 4, 6, 8, 10, 12}.Figurelabelsrefertothecorrespondingnumber
of nodes per circle Nc. Black bars depict 95 % conﬁdence intervals. a Nc = 10, b Nc = 20
12.4
Interference and Rate at Eccentric User Locations
In this section, user-centric BS collaboration schemes in scenarios with asymmetric
interferer impact are investigated. The asymmetry can either arise from non-uniform
power proﬁles or user locations outside the center of an otherwise isotropic scenario.
The particular emphasis of this section is on the latter, since it is found less fre-
quently in literature. In order to generate a generic, circularly symmetric scenario, the
introduced circular model is applied, which enables to employ Theorem 12.1 for the
analysis of the interference statistics. Note that, in fact, the circular model generates a
rotationallysymmetric scenarioduetotheﬁnitenumberofnodes.However,bysetting
Nc sufﬁciently large, the scenario can be considered as quasi-circularly symmetric.
12.4.1
Generic Circularly Symmetric Scenario
The network is composed of a central BS and two circles of interferers with R1 =
500 m and R2 = 1000 m, as depicted in Fig.12.6. Each circle employs 10 interferers
and a uniform power proﬁle, i.e., pc[n] = 1/10. The respective total transmit powers
are speciﬁed as P1 = 400 W and P2 = 800 W, respectively. The interferer locations
are assumed to be rotated by φ1 = −π/10 and φ2 = 0, respectively. BS T0,0 is
located at the origin and P0 = 40 W.
The parameters of the circular model are summarized in Table12.3 and the mod-
eling of the signal propagation is referred from Table12.2, respectively. The ﬁrst
goal is to identify the nodes, which dominate the interference statistics at eccentric
user locations. Then, these insights are applied for user-centric BS coordination
and -cooperation.

286
M. Rupp et al.
Fig. 12.6 Circular model
with two circles of radius
R1 = 500 m and
R2 = 1000 m, respectively.
Each circle employs 10 BSs.
The BS positions are rotated
by φ1 = −π/10 and φ2 = 0.
Users at (125 m, 0) and
(250 m, 0) are denoted as
bold dots and refer to middle
of cell and cell-edge,
respectively
Table 12.3 Parameters of circular model for numerical evaluation
Circle
Parameters
1
R1 = 500 m
N1 = 10
P1 = 400 W
φ1 = −π
10
p1[n] =
1
10
n ∈{1, . . . , 10}
2
R2 = 1000 m
N2 = 10
P2 = 800 W
φ2 = 0
p2[n] =
1
10
n ∈{1, . . . , 10}
12.4.2
Components of Asymmetric Interference
In the ﬁrst step, only the inner circle of interferers is assumed to be present, i.e.,
the set I comprises the 10 nodes T1,n, n = 1, . . . , 10, of circle 1. The target is to
determine the impact of the closest nodes on the aggregate interference statistics.
For this purpose, two representative user locations at r = R1/4 and r = R1/2 are
investigated, referring to middle of cell and cell-edge, respectively.
The PDF of the aggregate interference is obtained by Theorem 12.1. Its
evaluation is simpliﬁed by the scenario’s symmetry about the x-axis: (i) equal node-
to-user distances from upper- and lower semicircle, i.e., d1,n = d1,10−n+1, (ii) uni-
form power proﬁle p1(n) = 1/10, and (iii) equal scale parameters θ1,n = 1. Thus,
θ′
1,n(r) = θ′
1,10−n+1(r), with θ′
1n(r) = P1/10 ℓ(d1,n(r)). The vectors θI (r) and kI
are of length LI = 5, with [θI (r)]l = θ′
1,l(r) and [kI ]l = 4, respectively. Hence,
the distribution of aggregate interference at distance r from the center formulates as
fI(x;r) =
5

l=1
Λl
θ′
1,l(r)4 h3,l(0)e−x/θ′
1,l(r),
(12.14)

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
287
where
Λl = −1
6
5

i=1,i̸=l

1 −θi
θl
−4
,
l = 1, . . . , 5,
(12.15)
h3,l =

h1,l(0)
3 + 3h1,l(0)h(1)
1,l (0) + h(2)
1,l (0),
(12.16)
with
h1,l(0) = −y + 4
5

i=1,i̸=l
 1
θi
−1
θl
−1
,
(12.17)
h(1)
1,l (0) = 4
5

i=1,i̸=l
 1
θi
−1
θl
−2
,
(12.18)
h(2)
1,l (0) = 8
5

i=1,i̸=l
 1
θi
−1
θl
−3
.
(12.19)
Figure12.7 shows fI(x;r) for r = 125 m (narrow solid curve) and r = 250 m
(wide solid curve), referring to middle of cell and cell-edge, respectively. The dots
denote results as obtained with the approach in [12], which requires numerical
evaluation of a line-integral and conﬁrms the accuracy of the proposed ﬁnite-sum
representation.
In Eq.12.14, each sum term refers to a pair of transmitters {T1,l, T1,10−l+1}. The
contribution of each pair to the ﬁnal PDF is rendered visible by truncating the sum
in Eq.12.14 at L′ with L′ ∈{1, . . . , 5}, i.e., only the ﬁrst L′ sum terms are taken into
account. Dashed curves in Fig.12.7 depict results for L′ = 1 and L′ = 2.
It is observed that (i) in the middle of the cell, body and tail of the PDF are mainly
shaped by the four closest interferers while (ii) at cell-edge the distribution is largely
dominated by the two closest interferers, and (iii) interference at r = 250 m yields
a larger variance than at r = 125 m due to higher diversity of the transmitter-to-
user distances. The results verify link-level simulations in [33]. They emphasize the
strong impact of interference asymmetry due to an eccentric user location, which is
commonly overlooked in stochastic geometry analysis. In the next section, the above
ﬁndings are exploited for BS coordination and -cooperation and the resulting SIR-
and rate statistics are investigated.
12.4.3
Transmitter Collaboration Schemes
In this section, SIR- and rate statistics in the full two-circle scenario, as shown in
Fig.12.6, are studied. Motivated by the observations in Sect.12.4.2, three schemes
of BS collaboration are discussed:

288
M. Rupp et al.
Fig.12.7 Distributionofaggregateinterferenceatuserdistancesr = 125 m andr = 250 m,respec-
tively. Dots refer to results as obtained with the approach in [12]. Dashed curves show contribution
from dominant interferers
1. No collaboration among nodes: This scenario represents the baseline, where S =
{T0,0} and I comprises all nodes on the circle, i.e., I = {Tc,n} with c ∈{1, 2}
and n ∈{1, . . . , 10}.
2. Interference coordination (cf., e.g., Enhanced Intercell Interference Coordination
(eICIC) in the 3GPP LTE-A standard [34]): The nodes coordinate such that co-
channel interference from the two strongest interferers of the inner circle, T1,1
and T1,10, is eliminated. This could be achieved, e.g., by joint scheduling. Then,
S = {T0,0} and I is composed of {T1,n} with n ∈{2, . . . , 9} and {T2,n} with
n ∈{1, . . . , 10}.
3. Transmitter cooperation (cf., e.g., Coordinated Multi-Point (CoMP) in the 3GPP
LTE-A standard [35]): The signals from the two closest nodes of the inner circle,
T1,1 and T1,10, can be exploited as useful signals and are incoherently combined
with the signal from T0,0. Then, S = {T0,0, T1,1, T1,10} and, as above, I com-
prises {T1,n} with n ∈{2, . . . , 9} and {T2,n} with n ∈{1, . . . , 10}.
For each collaboration scheme, the PDFs of aggregate signal and -interference,
fS(x;r) and fI(x;r), are calculated using Theorem 12.1. The SIR at user location
(r, 0) is deﬁned as γ (r) = S(r)/I (r). According to [36], the PDFs of γ (r) is

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
289
calculated as
fγ (γ ;r) =
 ∞
0
zfS(z γ ;r) fI(z;r)dz,
(12.20)
where z is an auxiliary variable, fS(·;r) and fI(·;r) refer to Eqs.(12.9) and (12.10),
and the integration bounds are obtained by exploiting the fact that fS(γ ;r) = 0 and
fI(γ ;r) = 0 for x < 0, respectively.
Evaluating Eqs.(12.9) and (12.10) yields sums of elementary functions of the
form aγ be−cγ , with the auxiliary parameters a ∈R, b ∈N+ and c > 0. Therefore,
fS(γ ;r) and fI(γ ;r) can generically be written as
fS(γ ;r) =

s
asγ bse−csγ ,
(12.21)
fI(γ ;r) =

i
aiγ bie−ciγ ,
(12.22)
and allow to straightforwardly evaluate Eq.(12.20) as
fγ (γ ;r) =

s

i
 ∞
0
z as(zγ )bse−cs(γ z) aizbie−ci zdz
=

s

i
asaiγ bs(ci + csγ )−i−bs−biΓ (i + bs + bi).
(12.23)
The normalized ergodic rate τ as a function of the SIR γ (r) is calculated by
the modiﬁed Shannon capacity formula τ(γ (r)) = αB log2 (1 + αSIRγ (r)), where
αB and αSIR are coefﬁcients for the calibration against link level simulations with
0 < αB ≤1 and 0 < αSIR ≤1. Since τ(·) is a function of the RV γ (r), its distribution
is obtained by a transformation as
fτ(x;r) =
1
αBαSIR
2x/αB fγ
 1
αSIR

2x/αB −1

;r

loge(2),
(12.24)
with fγ (·; ·) from Eq.(12.23).
The distributions fγ (γ ;r) and fτ(τ;r) are analyzed at r = 125 m and r = 250 m
referring to middle of the cell, and cell-edge, respectively. In this chapter, αB = 1
and αSIR = 1. For reasons of clarity, CDF curves are presented. In order to verify
the analysis, Monte Carlo simulations are carried out, employing the system model
from Sect.12.4.1 and the signal propagation model from Table12.2. The results are
computed by averaging over 107 channel realizations for each BSs collaboration
scheme and each user location, and are denoted as bold dots in Figs.12.8 and 12.9,
respectively.
Figure12.8 shows the obtained SIR distributions. It is observed that
• In the case of no collaboration (solid lines in Fig.12.8), the curves have almost
equal shape in the middle of the cell and at cell-edge. The distribution in the middle

290
M. Rupp et al.
−20
−10
0
10
20
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SIR [dB]
CDF
250
-250
-250
-250
-500
-500
-500
y[m]
x[m]
No collaboration   
Interference coordination   
Base station cooperation    
Monte Carlo simulations
r =250m
r =125m
Fig. 12.8 SIR CDF curves for user locations in the middle of the cell (r = 125 m) and at cell-edge
(r = 250 m), respectively. Three cases are depicted: (i) no collaboration among BSs (solid), (ii)
interference coordination (dashed), (iii) cooperation among BSs (dotted)
0
1
2
3
4
5
6
7
8
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Normalized ergodic rate [bit/s/Hz]
CDF
250
-250
-250
-250
-500
-500
-500
y[m]
x[m]
No collaboration 
 
 
Interference coordination  
 
Base station cooperation  
 
 
Monte Carlo simulations
r =250m
r =125m
Fig. 12.9 Normalized-rate CDF curves for user locations in the middle of the cell (r = 125 m) and
at cell-edge (r = 250 m), respectively. Three cases are depicted: (i) no collaboration among BSs
(solid), (ii) interference coordination (dashed), (iii) cooperation among BSs (dotted)
of the cell is slightly steeper due to the lower variance of the interferer impact.
Their medians, hereafter used to represent the distributions’ position, differ by
15.5dB.
• When the central node T0,0 coordinates its channel access with the user’s two
dominant interferers, T1,1 and T1,10, the SIR improves by 2.4dB in the middle
of the cell and 5.9dB at cell-edge (dashed curves in Fig.12.8), compared to no
collaboration.

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
291
• BS cooperation enhances the SIR by 10.2dB at cell-edge in comparison to no
collaboration (left dotted curve in Fig.12.8). Note that the CDF curve also has a
steeper slope than without coordination, indicating lower variance of the SIR.
• In the middle of the cell, cooperation achieves hardly any additional improvement,
as recognized from the overlapping rightmost curves in Fig.12.8. This remarkable
result states that interference coordination already performs close to optimal at
this user location. Note that in realistic networks coordination is typically far less
complex than cooperation.
The curves reﬂect ﬁndings from [37], stating that even in the best case, gains of
transmitter cooperation are much smaller than largely envisioned. Figure12.9 depicts
the corresponding rate distributions. The results show that
• Notably, the rate statistics of all three collaboration schemes indicate lower vari-
ance at cell-edge than in the middle of the cell.
• In terms of median value, BS coordination shows rate improvements by 18.7 % in
the middle of the cell and by 167 % at cell-edge.
• Cooperation between the central node T0,0 and the user’s two closest interferers,
T1,1 and T1,10, achieves a rate enhancement of 19.8% in the middle of the cell
and 355.7% at cell-edge. Similar to the SIR, it is observed that in the middle of
the cell, interference coordination already performs close to optimal.
In summary, collaboration among the BSs that were identiﬁed as main contrib-
utors to the shape of the interference distribution by Theorem 12.1, achieved large
performance enhancements in terms of SIR and rate. It was further shown that the
efﬁciency of such schemes considerably depends on the user eccentricity, or equiv-
alently, the asymmetry of the interference impact.
12.5
LTE-Advanced System Level Simulations
In this section, SINR and spectral efﬁciency at eccentric UE locations are evalu-
ated by LTE-A system level simulations, validating results from theory. The system
model is directly adopted from Sect.11.7.1. The corresponding circular model from
Sect.12.1 encompasses one circle (C = 1) with radius R1 = 500 m and six transmit-
ters. According to Sect.12.3, such model allows to exactly reproduce a regular grid
model in terms of aggregate interference characteristics, provided that the composite
fading follows a Gamma distribution. In order to omit the error, which is induced
by the Gamma approximation as detailed in Sect.11.7.2, composite fading is mod-
eled by free space path loss and Rayleigh fading in both simulations and analysis
(i.e., Gc,n ∼Γ [1, 1] in Eq.(12.1)).
The particular aim of this section is to verify results from Sect.12.4. Accordingly,
two scenarios, namely no collaboration among transmitters and interference coor-
dination are deﬁned. In the latter case, eNodeB 7 in Fig.11.9 does not contribute
to the co-channel interference. From the representative UE locations, as speciﬁed

292
M. Rupp et al.
Fig. 12.10 SINR at various
UE distances
r = {50, 120, 210} m and
angle position φ = 0,
considering no
collaboration- and
interference coordination
among the eNodeBs. The
curves show results as
obtained by system level
simulations and the circular
model from Sect.12.4
with-(b) and without
calibration (a), respectively
Simulations (no collaboration)
Simulations (coordination)
Circular model (no collaboration)
Circular model (coordination)
−20
−10
0
10
20
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SINR [dB]
Without calibration
Calibration against link level simulations.
CDF / ECDF
r = 210 m
r = 120 m
r = 50 m
(a)
−20
−10
0
10
20
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SINR [dB]
CDF / ECDF
r = 210 m
r = 120 m
r = 50 m
(b)
in Sect.11.7.1 and marked by bold dots in Fig.11.9, the particular interest of this
section is on the angle position φ = 0.
Figure12.10a depicts SINR distributions for both collaboration schemes, compar-
ing results from system level simulations and the circular model. It is observed that
the SINR consistently deteriorates for a UE moving from cell-center to cell-edge.
In accordance with Sect.12.4, it is improved by interference coordination, with the
largest gains being achieved at cell-edge. The simulated median values increase by
1.2, 1.8 and 1.9 dB at the cell-center, middle of the cell and cell-edge, respectively.
Furthermore, it is seen that the curves from the simulations are steeper, i.e., have a
smaller variance than those obtained with the circular model. This is mainly caused
by the fact that the simulator employs a Zero Forcing (ZF) receiver and measures
the post-equalization SINR. In order to more accurately capture the receiver char-
acteristics, the ﬁrst adaption of the circular model concerns the shape of the fading
distribution. It is set to k = 2, i.e., Gc,n ∼Γ [2, 1].
In a practical system, performance is decreased by a variety of design constraints.
Hence, the circular model has to be further calibrated against simulations

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
293
[38]. This chapter employs the modiﬁed channel capacity formula τ(γ (r)) =
αB log2 (1 + αSIRγ (r)), as introduced in Sect.12.4.3. The term γ (r) denotes the SIR
at distance r (note that in this section the UEs of interest have angle position φ = 0),
and αB and αSIR are freely adjustable calibration parameters, with 0 < αB ≤1 and
0 < αSIR ≤1.
Figure12.10 depicts the simulation results from both baseline- and coordination
scheme in terms of spectral efﬁciency versus SINR. The dots refer to the simulation
results at various user distances r = {50, 120, 210} m. For comparison, the ﬁgure
also shows the channel capacity and the performance of a SISO LTE-A system over
an Additive White Gaussian Noise (AWGN) channel. The latter is obtained from link
level simulations and can expediently be used to predict the optimal performance
of the system. Its discontinuous behavior stems from LTE-A’s Adaptive Modulation
and Coding (AMC) scheme [39]. It is observed that the results from the system
level simulations lie below this curve, since they encompass the actual channel code
performance [40]. In order to achieve reliable upper performance bounds, the link
level results are employed as a reference for the calibration of the circular model,
yielding αB = 0.85 and αSIR = 0.5, respectively. The term αB shifts the capacity
curve in Fig.12.11, while αSIR determines its scale. The calibration is carried out such
that the curve is tangent to the link level results and achieves the maximum spectral
efﬁciency in the scenario without collaboration, as denoted by ‘×’ in Fig.12.11a.
Intuitively, the ﬁrst term accounts for overhead, such as pilot symbols, while the
second term represents the limits of the AMC in LTE-A [41, 42].
The dashed curves in Fig.12.11a show the adapted SIR distributions. Except
for r = 210 m, they exhibit a better ﬁt than the uncalibrated curves in both shape
and scale. The deviation at the cell-edge (r = 210 m) is partly compensated by
−20
−10
0
10
20
30
0
1
2
3
4
5
6
SINR [dB]
No collaboration
collaboration
Spectral efficiency [bit/s/Hz]
Channel capacity
AWGN with AMC
Calibrated capacity
System level
simulations
r = 50m
r = 210m
r = 120m
−20
−10
0
10
20
30
0
1
2
3
4
5
6
SINR [dB]
Spectral efficiency [bit/s/Hz]
Channel capacity
AWGN with AMC
Calibrated capacity
System level
simulations
r = 50m
r = 210m
r = 120m
(a)
(b)
Fig. 12.11 Spectral efﬁciency [bit/s/Hz] versus SINR [dB] for baseline- (a) and coordina-
tion scheme (b). Dots refer to results from system level simulations at various user distance
r = {50, 120, 210} m. The curves refer to the Shannon channel capacity, the calibrated capac-
ity (with αB = 0.85 and αSIR = 0.5) and the performance of a SISO LTE-A system over an AWGN
channel employing AMC, as obtained from link level simulations

294
M. Rupp et al.
Fig. 12.12 Spectral
efﬁciency [bit/s/Hz] at
various UE distances
r = {50, 120, 210} and angle
position φ = 0, considering
no collaboration- and
interference coordination
among the eNodeBs. The
curves show results as
obtained by system level
simulations and the circular
model with αB = 0.85 and
αSIR = 0.5, respectively
0
1
2
3
4
5
6
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Spectral Efficiency [bit/s/Hz]
CDF / ECDF
Simulations (no collaboration)
Simulations (coordination)
Circular model (no collaboration)
Circular model (coordination)
r = 210 m
r = 120 m
r = 50 m
overestimating the link level performance in the low-SINR regime (cf. Figure12.11).
ThecorrespondingspectralefﬁciencydistributionsareobtainedbyapplyingEq.12.24
from Sect.12.4.3 Note that the term spectral efﬁciency is employed instead of
normalized rate in this chapter. They are depicted in (Fig.12.12) together with the
simulation results. It is observed that, despite the large number of simulated TTIs,
the curves from the simulations exhibit a discontinuous behavior due to the AMC.
As expected, the circular model provides reliable upper performance bounds that are
tightest at r = 210 m.
Inconclusion, thecircular model fromSect.12.1is well suitedtomakeaﬁrst-order
prediction of the SINR- and spectral efﬁciency performance. The presented calibra-
tion against link level simulations has to be carried out only once for each MISO- or
Single-Input Multiple-Output (SIMO) transmission scheme. This method forfeits a
certain amount of accuracy while avoiding tedious ad-hoc calibration against each
system level simulation run.
References
1. N. Bhushan, J. Li, D. Malladi, R. Gilmore, D. Brenner, A. Damnjanovic, R. Sukhavasi, C.
Patel, S. Geirhofer, Network densiﬁcation: the dominant theme for wireless evolution into 5G.
IEEE Commun. Mag. 52(2), 82–89 (2014). doi:10.1109/MCOM.2014.6736747
2. H. ElSawy, E. Hossain, M. Haenggi, Stochastic geometry for modeling, analysis, and design of
multi-tier and cognitive cellular wireless networks: A survey. IEEE Commun. Surveys Tutor.
15(3), 996–1019 (2013)
3. M. Haenggi, R.K. ganti, Interference in large wireless networks, in, Foundations and Trends
in Networking (Now Publishers, The Netherlands, 2009), pp. 127–248
4. M. Haenggi, J. Andrews, F. Baccelli, O. Dousse, M. Franceschetti, Stochastic geometry and
random graphs for the analysis and design of wireless networks. IEEE J. Sel. Areas Commun.
27(7), 1029–1046 (2009). doi:10.1109/JSAC.2009.090902
5. M. Taranetz, M. Rupp, A circular interference model for heterogeneous cellular networks.
IEEE Trans. Wirel. Commun. 15(2), 1432–1444 (2015). doi:10.1109/TWC.2015.2490068

12
Modeling Asymmetric Aggregate Interference by Symmetric Structures
295
6. M. Taranetz, System level modeling and evaluation of heterogeneous cellular networks, Ph.D.
dissertation, Institute of Telecommunications, TU Wien, 2015, http://theses.eurasip.org/theses/
611/system-level-modeling-and-evaluation-of/
7. H. Tabassum, F. Yilmaz, Z. Dawy, M.-S. Alouini, A framework for uplink intercell interference
modeling with channel-based scheduling. IEEE Trans. Wirel. Commun. 12(1), 206–217 (2013).
doi:10.1109/TWC.2012.120412.112244
8. R.W. Heath Jr., M. Kountouris, T. Bai, Modeling heterogeneous network interference using
poisson point processes. IEEE Trans. Signal Process. 61(16), 4114–4126 (2013). doi:10.1109/
TSP.2013.2262679
9. R. Prasad, A. Kegel, Improved assessment of interference limits in cellular radio performance.
IEEE Trans. Veh. Technol. 40(2), 412–419 (1991)
10. M.-S. Alouini, A. Abdi, M. Kaveh, Sum of gamma variates and performance of wireless
communication systems over Nakagami-fading channels. IEEE Trans. Veh. Technol. 50(6),
1471–1480 (2001). doi:10.1109/25.966578
11. V. Aalo, T. Piboongungon, G. Efthymoglou, Another look at the performance of MRC schemes
in Nakagami-m fading channels with arbitrary parameters. IEEE Trans. Commun. 53(12),
2002–2005 (2005). doi:10.1109/TCOMM.2005.860089
12. I. Ansari, F. Yilmaz, M.-S. Alouini, O. Kucur, On the sum of gamma random variates with
application to the performance of maximal ratio combining over Nakagami-m fading channels,
in, IEEE International Workshop Signal Processing Advances in Wireless Commununication
(SPAWC), Cesme, June 2012, pp. 394–398
13. T.A. Tsiftsis, G.K. Karagiannidis, S.A. Kotsopoulos, N.C. Sagias, Performance of MRC diver-
sity receivers over correlated Nakagami-m fading channels, in, International Symposium on
Communication Systems, Networks and Digital Signal Processing (CSNDSP), Patras, July 2006
14. E.K. Al-Hussaini, A. Al-Bassiouni, Performance of MRC diversity systems for the detection
of signals with Nakagami fading. IEEE Trans. Commun. 33(12), 1315–1319 (1985). doi:10.
1109/TCOM.1985.1096243
15. G. Karagiannidis, N. Sagias, T. Tsiftsis, Closed-form statistics for the sum of squared
Nakagami-m variates and its applications. IEEE Trans. Commun. 54(8), 1353–1359 (2006).
doi:10.1109/TCOMM.2006.878812
16. G. Efthymoglou, T. Piboongungon, V. Aalo, Performance of DS-CDMA receivers with MRC
in Nakagami-m fading channels with arbitrary fading parameters. IEEE Trans. Veh. Technol.
55(1), 104–114 (2006). doi:10.1109/TVT.2005.861204
17. P. Lombardo, G. Fedele, M. Rao, MRC performance for binary signals in Nakagami fading
with general branch correlation. IEEE Trans. Commun. 47(1), 44–52 (1999). doi:10.1109/26.
747812
18. Q. Zhang, Exact analysis of postdetection combining for DPSK and NFSK systems over
arbitrarily correlated Nakagami channels. IEEE Trans. Commun. 46(11), 1459–1467 (1998).
doi:10.1109/26.729390
19. L.-L. Yang, H.-H. Chen, Error probability of digital communications using relay diversity over
Nakagami-m fading channels. IEEE Trans. Wirel. Commun. 7(5), 1806–1811 (2008)
20. D.J. Torrieri, M.C. Valenti, The outage probability of a ﬁnite ad hoc network in Nakagami
fading. IEEE Trans. Commun. 60(11), 3509–3518 (2012)
21. P. Moschopoulos, The distribution of the sum of independent gamma random variables. Ann.
Inst. Stat. Math. 37(1), 541–544 (1985)
22. D.G. Kabe, On the exact distribution of a class of multivariate test criteria. Ann. Math. Stat.
33(3), 1197–1200 (1962)
23. E. Scheuer, Reliability of an m-out-of-n system when component failure induces higher failure
rates in survivors. IEEE Trans. Rel. 37(1), 73–74 (1988). doi:10.1109/24.3717
24. S. Amari, R. Misra, Closed-form expressions for distribution of sum of exponential random
variables. IEEE Trans. Rel. 46(4), 519–522 (1997). doi:10.1109/24.693785
25. C.A. Coelho, The generalized integer gamma distribution—a basis for distributions in multi-
variate statistics. J. Multivar. Anal. 64(1), 86–102 (1998). doi:10.1006/jmva.1997.1710

296
M. Rupp et al.
26. A.A. Abu-Dayya, N.C. Beaulieu, Outage probabilities in the presence of correlated lognormal
interferers. IEEE Trans. Veh. Technol. 43(1), 164–173 (1994)
27. N.C. Beaulieu, A.A. Abu-Dayya, P.J. McLane, Estimating the distribution of a sum of inde-
pendent lognormal random variables. IEEE Trans. Commun. 43(12), 2869–2873 (1995)
28. J. Hu, N.C. Beaulieu, Accurate simple closed-form approximations to rayleigh sum distribu-
tions and densities. IEEE Commun. Lett. 9(2), 109–111 (2005)
29. N.B. Mehta, J. Wu, A.F. Molisch, J. Zhang, Approximating a sum of random variables with a
lognormal. IEEE Trans. Wirel. Commun. 6(7), 2690–2699 (2007)
30. S.B.P. Iman Mabrouk, The exact density function of a sum of independent gamma random
variables as an inverse Mellin transform. Int. J. Appl. Math. Stat. 41(11) (2013)
31. S.B. Provost, On sums of independent gamma random variates. Stat. J. Theor. Appl. Stat. 20(4)
(1989)
32. J. Andrews, R. Ganti, M. Haenggi, N. Jindal, S. Weber, A primer on spatial modeling and
analysis in wireless networks. IEEE Commun. Mag. 48(11), 156–163 (2010)
33. S. Plass, X.G. Doukopoulos, R. Legouable, Investigations on link-level inter-cell interference
in OFDMA systems, in, Symposium on Communications and Vehicular Technology (SCVT),
Liege, November 2006, pp. 49–52
34. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access (E-
UTRA); mobility enhancements in heterogeneous networks, in 3rd Generation Partnership
Project (3GPP), TR 36.839, January 2013
35. 3rdGenerationPartnershipProject(3GPP),Coordinatedmulti-pointoperationforLTEphysical
layer aspects, in 3rd Generation Partnership Project (3GPP), TR 36.819, September 2013
36. J.H. Curtiss, On the distribution of the quotient of two chance variables. Ann Math. Stat. 12(4),
409–421 (1941)
37. A. Lozano, R.W. Heath Jr., J. Andrews, Fundamental limits of cooperation. IEEE Trans. Inf.
Theory 59(9), 5213–5226 (2013). doi:10.1109/TIT.2013.2253153
38. J.C. Ikuno, System level modeling and optimization of the LTE downlink, Ph.D. dissertation,
E389, Technische Universität Wien, 2013, http://theses.eurasip.org/theses/479/system-level-
modeling-and-optimization-of-the-lte/
39. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access (E-
UTRA); physical layer procedures, in 3rd Generation Partnership Project (3GPP), TS 36.213,
January 2015
40. S. Schwarz, M. Simko, M. Rupp, On performance bounds for MIMO OFDM based wireless
communication systems, in, IEEE International Workshop Signal Processing Advances in
Wireless Commununication (SPAWC), San Francisco, June 2011, pp. 311–315. doi:10.1109/
SPAWC.2011.5990419
41. A. Burr, A. Papadogiannis, T. Jiang, MIMO truncated Shannon bound for system level capacity
evaluation of wireless networks, in, IEEE Wireless Commununication and Networking Con-
ference Workshops (WCNCW), Paris, April 2012
42. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access (E-
UTRA); radio frequency (RF) system scenarios, 3rd Generation Partnership Project (3GPP),
TR 36.942, October 2014

Chapter 13
Analysis of Urban Two-Tier Heterogeneous
Cellular Networks
Markus Rupp, Stefan Schwarz and Martin Taranetz
This chapter presents a system model that is based on techniques from stochastic
geometry and enables the analysis of indoor downlink performance in urban two-
tier heterogeneous cellular networks. Chapters11 and 12 mainly deal with eccentric
receiverlocations,which,ingeneral,stronglyrestrictstochasticmodelsfromyielding
convenient expressions. In this chapter, the issue is resolved by proposing a virtual
building approximation. Moreover, two other important limitations are addressed,
namely shadowing and the separation between indoor- and outdoor environments.
In the analysis on stochastic geometry, shadowing is typically incorporated by
log-normally distributed Random Variables (RVs) [1–3] or neglected at all [4–12].
A recent study on blockage effects in urban environments indicates its dependency
on the link length [13]. It follows the intuition that a longer link increases the like-
lihood of buildings to intersect with it. Such propagation characteristics have been
discussed by the 3rd Generation Partnership Project (3GPP) only recently in a techni-
cal report on 3-dimensional channel modeling [14]. Secondly, scenarios comprising
both indoor- and outdoor environments have not received much attention in analytical
studies due to the imposed inhomogeneities on signal propagation. The designated
area of operation for small cell Base Stations (BSs) is indoors. Existing approaches
either neglect the wall partitioning [2, 15], as indicated in Fig.13.1a, oversimplify
the macro-tier topology [7–9] or omit cross-tier interference [1].
In this chapter, a two-tier cellular network with outdoor macro- and indoor-
deployed small cell BSs is considered. Referring to the work in [17, 18], the
contributions are:
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien,Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_13
297

298
M. Rupp et al.
(a)
(b)
Fig. 13.1 Model environments of two-tier heterogeneous cellular networks. a Flat plane [16].
b Urban
• A tractable model for urban environment topologies is introduced. It comprises an
outdoor environment, which is partly covered by circular building objects with a
certaindensity.Amethodtoextractitsparametersfromreal-worlddataisprovided.
Based on concepts from random shape theory, the model is applied to characterize
both signal propagation and network deployment.
• A novel virtual building approximation to simplify aggregate interference analysis
is presented. The key idea is to establish a user-centric interference environment
by shifting the centers of the typical building and its exclusion regions to the user
location.
• Assuming that a building is served by a small cell BS with a certain occupation
probability, the normalized ergodic rate of a typical indoor user is evaluated with
respect to building density and wall penetration loss. Based on these results, the
impact of distinguishing Line-Of-Sight (LOS)- and Non Line of Sight (NLOS)
macro BSs is identiﬁed.
The chapter is organized as follows. Section13.1 provides preliminaries on ran-
dom shape theory and indoor area coverage. Section13.2 presents the system model.
In Sect.13.3 analytical expressions for the coverage probability of indoor users are
derived. Section13.4 studies the accuracy of the model by numerical evaluations. In
Sect.13.5, the model is extended by the consideration of LOS macro BSs.
13.1
Preliminaries
13.1.1
Random Shape Theory
In this section, concepts from random shape theory are reviewed (see, e.g., [19, 20]),
so as to make the model formulation in this chapter more accessible.
Let O denote a set of objects on Rn, which are closed and bounded, i.e., have ﬁnite
areaandperimeter.Forinstance,O couldbeacollectionofcirclesorrectanglesonR2,
or a combination of cubes in R3. For each object in O, a center point is determined,

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
299
which has to be well-deﬁned but does not necessarily relate to the object’s center
of gravity. Non-symmetric objects additionally require to specify the orientation in
space by a directional unit vector.
A Random Object Process (ROP) is constructed by randomly sampling objects
from O and placing their corresponding center points at the points of some Point
Process (PP). The orientation of each object is independently determined according
to some probability distribution.
In general, a ROP is difﬁcult to analyze, particularly when there are correlations
between sampling, location and orientation of the objects. For the sake of tractability,
this chapter employs a Boolean scheme, which satisﬁes the following properties: (i)
the center points form a Poisson Point Process (PPP), (ii) the attributes of the objects
such as orientation, shape and size are mutually independent, and (iii) for each object,
sampling, location and orientation are also independent.
The scheme is used to model an urban environment, where the objects of the
process refer to buildings. In the next section, a method to parameterize this model
with real-world data is presented.
13.1.2
Indoor Coverage Ratio
Deﬁne the indoor coverage ratio as the fraction of the total area on R2 that is covered
by buildings. Then, consider a Boolean model with the center points being distributed
according to a stationary PPP on R2 with intensity λB, i.e., Λ(dx) = λBdx. Further,
let C denote a random closed set on R2, representing a generic building. According
to [21, Deﬁnition 3.1.8], the resulting indoor coverage ratio is determined as
pI = 1 −e−λB E[|C |],
(13.1)
where | · | denotes the Lebesgue measure on R2.
As an example, assume that C is a random closed ball that is centered at the origin
and has random radius R ∈R+, i.e., C = B(0, R). Then,
pI = 1 −e−λB E[R2]π.
(13.2)
Expediently, the indoor coverage ratio can also be extracted from real-world data.
For example, the OpenStreetMap project provides open access to shape ﬁles, as
illustrated in Fig.13.2. In order to determine the degree of coverage by buildings,
these ﬁles can be processed by a simple MATLAB script. For the University of
Texas at Austin and Vienna’s inner district (see Fig.13.2a, b) ratios of pI = 0.25
and pI = 0.6 were measured. Related work in [22] evaluated the indoor coverage of
various Turkish cities. The ratios ranged from 0.13 to 0.39.
In the following, the Boolean model is applied to model the deployment of a
heterogeneous cellular network in accordance with the characteristics of an urban
environment.

300
M. Rupp et al.
Fig. 13.2 Building footprints as extracted from OpenStreetMap data. a University of Texas at
Austin. b Downtown Vienna
13.2
System Model
13.2.1
Topology Model for Urban Environments
Consider a two-tier cellular network comprising outdoor macro- and indoor small
cell BSs, as shown in Fig.13.3. Buildings are modeled by a Boolean scheme of circles
on the R2 plane. The centers of the circles form a PPP ΦB of intensity λB [21]. For
simplicity, it is assumed that all circles have a ﬁxed radius RI. A point on the plane is
said to be indoors, if it is covered by a building, and outdoors otherwise. Indoor- and
outdoor environment are partitioned by a wall penetration loss, which is hereafter
assumed constant for all buildings and denoted as LW unless speciﬁed otherwise.
13.2.2
Network Deployment
Macro BSs are distributed according to a PPP ΦM of intensity μM. Note that these
BSs are required to be located outdoors. Thus, the macro BS process can equivalently
be constructed by independently thinning (see, e.g., [21]) an initial PPP of density
μ′
M = μM/pO, where pO equals the probability that a point on R2 is not covered

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
301
Fig. 13.3 Urban two-tier
heterogeneous cellular
network. Macro BSs are
deployed in an outdoor
environment. Buildings are
modelled as a random
process of circles and are
assumed to have a ﬁxed
radius RI. Only a fraction of
buildings is occupied by
small cell BSs. The ﬁgure
depicts a typical indoor user
with macro BSs and
neighboring small cell BSs
(dashed lines)
R I
Macro base station
Building
Small cell base station
r
User in typical building
by a building. According to Sect.13.1.2, the thinning probability is determined as
pO = 1 −pI = exp(−λBR2
I π).
A building will deploy an indoor small cell BS with a certain occupation proba-
bility η. Assume the indoor small cell BSs to be located at the center points of the
occupied buildings. Then, their spatial distribution can be modeled by a PPP ΦS of
intensity λB η, which results from independently thinning the object center PPP ΦB.
13.2.3
User Association
The aim of this chapter is to characterize the coverage and rate performance of indoor
users. Noting that the buildings are assumed to form a Boolean scheme, the centers
of the buildings form a PPP on the plane [13]. Therefore, by Slivnyak’s theorem
[21], when ﬁxing a typical building at the origin, the centers of the other buildings
still form a PPP. The performance of users will be investigated inside the typical
building. Separate association rules are deﬁned, depending on whether or not this
building is occupied by a small cell BS.
Case 1 [Typical Building with Small Cell BS]: Consider a typical building at the
origin, which is equipped with an indoor small cell BS. For simplicity, it is assumed
that all users inside this building are associated with the small cell at the origin. The
cases in which indoor users at the edge of the typical building may receive stronger
signals from a close-by outdoor macro BS are omitted, thus underestimating the
coverage probability. Similar to the analysis in [23], exclusion guard regions are
imposed on both macro- and small cell tier, where no BSs from the corresponding
tier are allowed to distribute. For simplicity, it is assumed that the exclusion region
for macro BSs is a ball of radius RI centered at the origin, ensuring that no macro
BSs are located inside the typical building. The exclusion region of the small cell tier

302
M. Rupp et al.
is deﬁned as a ball of radius 2 RI in order to prevent overlapping association regions
of two small cells.
Case 2 [Typical Building without Small Cell BS]: When the typical building is not
occupied by a small cell BS, the user is either associated to the dominant macro
BS or a small cell BS in the immediate vicinity. The former is regarded as being of
greater relevance and the latter is omitted, which leads to a lower bound on coverage
probability. In this case, the indoor user will be served by the nearest BS of the macro-
tier. The same exclusion regions as deﬁned in Case 1 are employed for macro- and
small cell BSs.
13.2.4
Virtual Building Approximation
Without loss of generality, a typical indoor user is assumed to be located at (r, 0).
Note that the exclusion regions as deﬁned in Sect.13.2.3 are centered at the origin
rather than at the user. Consequently, the interference ﬁeld as observed by the user
is asymmetric and renders analysis difﬁcult in general. Thus, the following approx-
imation is proposed.
Let (R, θ) denote the position of an interference. Its distance to a user located at
(r, 0) is determined as
d(r) =

R2 + r2 −2Rr cos θ.
(13.3)
Since typically R ≫r, d(r) is approximated as
d(r) ≈R,
(13.4)
which is independent of the angle θ. As shown in Fig.13.4, the approximation in
Eq.(13.4) is equivalent to shifting all the BSs along with the exclusion regions by a
vector (r, 0), as if the typical building was centered at the user location. Thus, this
Fig. 13.4 Target area
without small cell BS (gray
shaded) and user-centric
virtual building (dashed).
Dashed-dotted circles
denotes the shifted small cell
exclusion region. The indoor
user is assumed to be served
by the nearest macro BS at
distance R0
r
2R I
R0
Serving macro-base station
Typical building
Virtual building
RI

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
303
approach is referred to as virtual building approximation, and is applied to simplify
further analysis.
13.2.5
Signal Propagation
13.2.5.1
Macro BS to Indoor User
A signal originating from a macro BS experiences small scale fading, log-distance
dependent path loss, attenuation due to building blockage and wall penetration, LW.
Small scale fading is modeled by a Gamma RV Gi, with Gi ∼Γ [1, 1], i.e., Rayleigh
fading. Along the lines of [13, Theorem 1], the number of obstructing blockages
along a link of length R is a Poisson RV with parameter βBR, where βB = 2λBRI
in the introduced topology model. For analytical tractability the expected blockage
attenuation as referred from [13, Theorem 6] is employed. Combining blockage- and
log-distance path loss along a link of length R yields
ℓ(R) = e−βBR(1−LB)ℓO(R),
(13.5)
where LB refers to the attenuation of a single blockage, also denoted as building
penetration loss and ℓO(R) = min(bO, 1/cO R−αO), with intercept bO, constant cO
and outdoor path loss exponent αO. In this chapter, bO = 1 and cO = 1 for simplicity.
Note that the exponential term in Eq.(13.5) incorporates the condition that the macro
BS is deployed outdoors.
Equation13.5 reveals a major strength of the model: Shadowing is entirely char-
acterized by the parameters of the underlying environment topology, which can, e.g.,
be extracted from openly-available online data, as demonstrated in Sect.13.1.2. For
comparison, the variance of log-normally distributed shadowing is typically obtained
from measurements, which substantially exacerbates the ﬁnding of topologies with
similar characteristics.
13.2.5.2
Small Cell BS to Indoor User
When user and small cell BS are situated in the same building, the signal experiences
small scalefadingandpathloss ℓI(r) = min(bI, 1/cI r−αI), withintercept bI, constant
cI and indoor path loss exponent αI. For simplicity, bI = 1 and cI = 1 in this chapter.
The signals from all other small cell BSs are subject to small scale fading, log-
distance path loss ℓO(·) as deﬁned above, and attenuation by a factor L2
W, as caused
by the indoor-to-outdoor and outdoor-to-indoor wall penetration. Since the transmit
power of a small cell BS is typically low, only small cell interferers from neighboring
buildings are taken into account. Two buildings are deﬁned as being neighbors to each
other, if the segment connecting their centers is not intersected by any other building.

304
M. Rupp et al.
13.3
Performance Analysis
In this section, analytical expressions for the coverage probability of an indoor user
at position (r, 0) are derived, regarding both buildings with- and without small cell
deployment. The network is assumed to be interference limited, as is typically the
case in urban areas [24]. Thus, thermal noise is neglected in the analysis.
13.3.1
Typical Building with Small Cell Base Station
Let ΦM = {Xi} and ΦS = {Xj} denote the point processes of macro- and small cell
BSs, respectively. Further, deﬁne Ri = |OXi| and Rj = |OXj| as the distances of
macro BS i and small cell BS j to the origin O. Assume the typical building to be
occupied by a small cell BS. Then, the Signal-to-Interference Ratio (SIR) at distance
r, 0 < r ≤RI, is determined as
γS(r) =
PSG0ℓI(r)

i:Ri∈ΦM\B(0,RI) PMGiLWℓ(Ri) + 
j:Xj∈ΦS\B(0,2RI) SjPSGjL2
WℓO(Rj)
(13.6)
where the terms PM and PS denote macro- and small cell BS transmit powers, ℓI(·)
andℓO(·) areindoor- andoutdoor pathloss laws as speciﬁedinSect.13.2.5, ℓ(·) corre-
sponds to the combined blockage- and path loss attenuation, as deﬁned in Eq.(13.5),
and B(0, R) refers to a ball of radius R, which is centered at the origin. The RVs Sj
are Bernoulli distributed and, by [13, Theorem 1], have parameters exp(−βBRj−pB),
where pB = λBR2
I π. They indicate whether or not an interfering small cell BS is in
a neighboring building of the typical user.
Theorem 13.1 Consider a user at distance r, 0 < r ≤RI, away from the center of
a small cell BS-occupied building. Then, its coverage probability is determined as
Pc,S(δ|r) = P

γS(r) > δ|r

= e−2π(μSIS+μMIM),
(13.7)
where
IS =
∞

2RI
δ L2
W ℓO(t)e−(βBt+pB)
ℓI(r) + δ L2
W ℓO(t)

t dt,
(13.8)
IM =
∞

RI
	
1 −
PS
PM ℓI(r)
PS
PM ℓI(r) + δ LWℓ(t)

t dt.
(13.9)
Proof The proof is provided in [18, Appendix E].

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
305
Note that Eqs.(13.8) and (13.9) correspond to the two interference contributions
in Eq.(13.6).
13.3.2
Typical Building Without Small Cell Base Station
Assume a dominant macro BS to be located at distance R0, with R0 > RI, away from
the center of the typical building and consider that this building is not occupied by a
small cell BS. Then, the SIR at distance r, 0 < r ≤RI, calculates as
γM(R0) =
PMG0ℓ(R0)

i:Ri∈ΦM\B(0,R0) PMGiℓ(Ri) + 
j:Xj∈ΦS\B(0,2RI) SjPSGjLWℓO(Rj)
(13.10)
Note that (i) the expression is independent of r and (ii) the factor LW is omitted,
since attenuation due to wall penetration is experienced by all signals and therefore
cancels out in the SIR term.
Theorem 13.2 Consider a user at distance r, 0 < r ≤RI, away from the center
of a typical building without small cell BS and assume that it is associated with its
dominant macro BS. Then, its coverage probability is determined as
Pc,M(δ) = P

ER0

γM(R0) > δ

=
 ∞
RI
Pc,M(δ|R)fR0(R)dR,
(13.11)
where
Pc,M(δ|R0) = e−2π(μSIS+μMIM),
(13.12)
with
IS =
 ∞
2RI
	
δLW
PS
PM ℓO(t)e−(βBt+pB)
ℓ(R0) + δLW
PS
PM ℓO(t)

t dt,
(13.13)
IM =
 ∞
R0

1 −
ℓ(R0)
ℓ(R0) + δ ℓ(t)

t dt,
(13.14)
and
fR0(R) =

2πμMR e−πμM(R2−R2
I ),
R ≥RI
0,
otherwise
.
(13.15)
Proof The conditional coverage probability Pc,M(δ|R) in Eq.(13.12) is derived along
the lines of Eq.(13.7). Averaging over the dominant macro BS distance leads to
Eq.(13.11). According to [21, Example 1.4.7], the term fRO(R) in Eq.(13.15) is
the nearest neighbor distance distribution of a homogeneous PPP outside a ball of
radius RI.

306
M. Rupp et al.
13.3.3
Typical Indoor User
Thecoverageprobabilityofatypical indooruseratdistancer,0 < r ≤RI,isobtained
by linearly combining Pc,S(δ|r) from Eq.(13.7) and Pc,M(δ) from Eq.(13.11) accord-
ing to the small cell occupation probability η. Then,
Pc(δ|r) = η Pc,S(δ|r) + (1 −η) Pc,M(δ).
(13.16)
13.4
Numerical Evaluation
In this section, the performance of a typical user at the edge of a building, i.e.,
r = RI is evaluated numerically. At this location, the proposed virtual building
approximation isexpectedtoperformworst.Thenormalizedergodicrateisemployed
as a metric. Along the lines of Sect.12.4.3, it is deﬁned as τ(r) = Eγ (r)[αB log2(1 +
αSIR min(δmax, γ (r)))] and can be reformulated in terms of coverage probability as
τ(r) =
αB
log(2)
 δmax
0
αSIR
1 + αSIRδ Pc(δ|r)dδ,
(13.17)
with Pc(δ|r) from Eq.(13.16) and δmax = 26 −1, referring to 64-Quadrature Ampli-
tude Modulation (QAM), which is the highest modulation order in the current LTE-A
standard [25]. The terms αB and αSIR denote calibration parameters, with 0 < αB ≤1
and 0 < αSIR ≤1. In this chapter, αB = 1 and αSIR = 1.
Parameters for numerical evaluation are listed in Table13.1. To verify the accuracy
of the virtual building approximation, Monte Carlo simulations are carried out, using
the system model as introduced in Sect.13.2. The density of the macro BSs is chosen
such that the inscribing ball of the typical cell has RC = 250 m and the BSs are
distributed over a ﬁeld of 15 RC × 15 RC. The results are estimated from averaging
over 500 fading- and 500 spatial realizations.
Figure13.5 depicts the normalized ergodic rate τ(r) over the indoor coverage
ratio pI, as deﬁned in Sect.13.1.2. Note that when ﬁxing the average building size, pI
Table 13.1 Parameters for
numerical evaluation
Parameter
Value
Macro-to-small cell power
ratio
PS/PM = 10−2
Macro BS density
μM = 4.61 × 10−6 m−2
Outdoor path loss exponent
αO = 4
Indoor path loss exponent
αI = 2
Radius of building area
RI = 25 m

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
307
0.2
0.3
0.4
0.5
0.6
0.7
0.8
1
2
3
4
5
6
Normalized rate [bit/s/Hz]
Indoor coverage ratio
L =10-1
LW=10 -3
=0.8
=0.2
W
LW=10-3
W
L =10-1
Analysis
Simulations
Fig. 13.5 Normalized rate [bit/s/Hz] over area-ratio, which is covered by buildings. Solid- and
dashedlines denoteresultsfromanalysisandsimulations,respectively.Curves areshownforvarying
small cell occupation probability η and wall penetration loss LW
scales with the density of the buildings. Solid- and dashed lines correspond to analysis
and simulations, respectively. Results are shown for a sparse- and a dense small cell
deployment, as quantiﬁed by the occupation probability η. For both scenarios, weak-
and strong wall partitioning are investigated. The wall penetration loss is correlated
to the building penetration loss LB, as introduced in Eq.(13.5). This work employs
the conservative setting LB = LW, which can be replaced by more elaborated models
in future work. It is observed that
• The achievable normalized rate improves with increasing building density. This
result follows the intuition that obstructions due to large objects establish a safe-
guard against interference [13]. Note that for constant occupation probability, the
small cell density grows in proportion to the building density. Therefore, the results
render the existence of a hotspot limited regime in urban environments question-
able, supporting simulation results in [8, 9, 26, 27] and Chap.14.
• Low isolation by wall penetration deteriorates performance in both deployment
scenarios. Intuitively, the isolation of the interfering small cell BSs is decreased
when the wall penetrations become weaker. The impact of penetration loss on cov-
erage probability, however, becomes minor especially when the building density is
high. Intuitively, this indicates that the number of penetrations rather than the loss
per penetration dominates the effect of partitioning between indoor and outdoor
environment.
• Even though a user at the edge of a typical building is evaluated, the analyti-
cal results closely resemble the simulations. This conﬁrms the accuracy of the
virtual building approximation as well as the inclusion of macro-interferers in the
immediate vicinity of the typical building, as claimed in Sect.13.2.3.

308
M. Rupp et al.
13.5
LOS- and NLOS Macro Base Stations
In this section, previous analyses are reﬁned by taking into account whether the
path between a macro BS and the indoor user is obstructed by any other building.
The distinction between LOS- and NLOS links recently gained momentum with the
study of millimeter wave communication [28, 29]. In contrast, it has commonly been
neglected in the analysis of conventional cellular microwave networks. Typically, sig-
nal propagation is modeled by a single combination of shadow fading distribution,
path loss law and wall penetration. Nonetheless, numerous measurement campaigns
clearly indicate the differences between LOS- and NLOS microwave link character-
istics [30–36].
In this section, a framework is established which enables to account for both
link states. The idea is to partition the macro BSs process ΦM into two independent
non-homogeneous PPPs ΦL and ΦN, referring to LOS- and NLOS nodes such that
ΦM = ΦL ∪ΦN. Each process employs its own model for signal propagation,
incorporating log-distance dependent path loss, blockage and wall penetration. LOS-
and NLOS model are hereinafter referred to as ℓL(·) and ℓN(·), respectively.
Consider a typical building at the origin and an indoor user at distance r, 0 <
r ≤RI. Further, let a macro BS be located at distance R away from the origin.
Then, using the Boolean scheme as speciﬁed in Sect.13.2.1 and the virtual building
approximation as introduced in Sect.13.2.4, the probability that the link between
user and BS is obstructed by any other building is obtained as v(R) = exp(−βB(R −
RI)). This term can be interpreted as LOS probability, following the intuition that it
becomes increasingly unlikely to experience a connection with a distant BS.
According to [13], the shadowing of different links can be considered as uncorre-
lated with minor loss of accuracy. This allows to apply the thinning property of PPPs
and yields the intensities of the independent BS processes ΦL and ΦN as μM v(R)
and μM(1 −v(R)), respectively.
13.5.1
Distance Distributions of Associated Macro Base
Stations
Consider a typical building without small cell BS. The following lemmas provide
Probability Density Functions (PDFs) for the distance between an indoor user and its
associated macro BS, given that the BS is either in LOS or NLOS. The expressions
extend results in [28] by conditioning on deploying a virtual building around the
user, as illustrated in Fig.13.6.
Lemma 13.1 Consider a typical building without a small cell BS and an indoor user
at distance r, 0 < r ≤RI, away from its center, which is associated with the closest
LOS macro BS. Then, applying the virtual building approximation, its distance to
the serving BS is distributed as

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
309
Fig. 13.6 Snapshot of an
urban environment as
obtained by a Boolean
scheme with circles of
random radius. The ﬁgure
depicts an indoor user in a
typical building, which is
occupied by a small cell BS.
The scenario encompasses
LOS- and NLOS macro BSs.
The dashed circle indicates
the virtual building
LOS macro-base station
NLOS macro-base station
Typical building
Virtual building
fL(x) =

BLˆfL(x)
AL
e−2πμM
 ΨL(x)
RI
(1−v(t))tdt, x ≥RI
0,
otherwise
,
(13.18)
where
BL = 1 −e−2πμM
 ∞
RI v(r)rdr
(13.19)
ˆfL(x) =

1
BL 2πμMxv(x)e−2πμM
 x
RI v(r)rdr,
x ≥RI
0,
otherwise
(13.20)
AL = BL
 ∞
RI
e−2πμM
 ΨL(x)
RI
(1−v(t))tdtˆfL(x)dx,
(13.21)
and ΨL(x) = ℓ−1
L (ℓN(x)). The term BL denotes the probability that the user receives
at least one LOS BS and ˆfL(x) is the corresponding conditional distance distribution
function of the closest node. The quantity AL captures the likelihood to be associated
with the closest LOS BS.
Proof The proof is derived along the lines of [13, Theorem 10] by excluding BS
from a ball of radius RI around the user.
Lemma 13.2 Consider an indoor user at distance r, 0 < r ≤RI away from the
center of a typical building without a small cell BS. Let the user be attached to the
closest NLOS BS. Then, employing the virtual building approximation, the PDF of
its distance to the serving BS is expressed as

310
M. Rupp et al.
fN(x) =

BNˆfN(x)
AN
e−2πμM
 ΨN(x)
RI
v(t)tdt , x ≥RI
0
, otherwise
,
(13.22)
where
BN = 1 −e−2πμM
 ∞
RI (1−v(r))rdr
(13.23)
ˆfN(x) =

1
BN 2πμMx(1 −v(x))e−2πμM
 x
RI (1−v(r))rdr , x ≥RI
0
, otherwise
(13.24)
AN = 1 −AL,
(13.25)
with AL from Eq.(13.21) and ΨN(x) = ℓ−1
N (ℓL(x)). The term BN refers to the proba-
bility that the user receives at least one NLOS BS and ˆfN is the according conditional
pdf of the distance to the closest node.
Proof As above, the proof follows [13, Theorem 10] and is therefore omitted.
13.5.2
SINR and Coverage Analysis
Given an indoor user at distance r, 0 < r ≤RI away from the center of a typical
building with small cell BS, its SIR is determined as
γS(r) =
PSG0ℓI(r)

i:Xi∈ΦL
\B(0,RI)
PMGiℓL(Ri) + 
j:Xj∈ΦN
\B(0,RI)
PMGjℓN(Rj) + 
k:Xk∈ΦS
\B(0,2RI)
SkPSGkLWℓL(Rk),
(13.26)
where the ﬁrst- and second sum in the denominator denote the aggregate interference
from the LOS- and NLOS macro BSs, respectively. The third sum refers to the
contribution from the small cell tier.
When the building is not occupied by a small cell BS, the user associates with the
dominant macro BS at distance R0, with R0 > RI. Depending on whether the serving
BS is in LOS or NLOS, Eq.(13.10) reformulates as
γL(R0) =
PMG0ℓL(R0)

i:Xi∈ΦL
\B(0,R0)
PMGiℓL(Ri) + 
j:Xj∈ΦN
\B(0,ΨL(R0))
PMGjℓN(Rj) + 
k:Xk∈ΦS
\B(0,2RI)
SkPSGkLW ℓL(Rk),
(13.27)
or
γN(R0) =
PMG0ℓN(R0)

i:Xi∈ΦL
\B(0,ΨN(R0))
PMGiℓL(Ri) + 
j:Xj∈ΦN
\B(0,R0)
PMGjℓN(Rj) + 
k:Xk∈ΦS
\B(0,2RI)
SkPSGkLW ℓL(Rk).
(13.28)

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
311
Note that by virtue of the virtual building approximation from Sect.13.2.4 both γL(·)
and γN(·) are independent of the user’s location within the building. The following
theorems extend Theorems 13.1 and 13.2 with respect to NLOS- and NLOS macro
BSs.
Theorem 13.3 Consider an indoor user at distance r, 0 < r ≤RI away from the
center of a typical building with a small cell BS. Then, its coverage probability is
calculated as
Pc,S(δ|r) = P

γS(r) > δ|r

= e−2π(μSIS+μM(IL+IN)),
(13.29)
with γS(·) from Eq.(13.26) and
IS =
 ∞
2RI
δLWℓL(t)e−(βBt+pB)
ℓI(r) + δLWℓL(t) tdt,
(13.30)
IL =
 ∞
RI
	
1 −
PS
PM ℓI(r)
PS
PM ℓI(r) + δℓL(t)

tv(t)dt,
(13.31)
IN =
 ∞
RI
	
1 −
PS
PM ℓI(r)
PS
PM ℓI(r) + δ ℓN(t)

t(1 −v(t))dt.
(13.32)
Proof The proof is provided in [18, Appendix F].
Theorem 13.4 Consider a typical building without a small cell BS and an indoor
user at distance r, 0 < r ≤RI away from its center. Given that the user is associated
with the closest LOS macro BS, its coverage probability is determined as
Pc,L(δ) = P

ER0[γL(R0) > δ]

=
 ∞
RI
e−2π(μSIS+μM(IL+IN))fL(R)dR,
(13.33)
with γL(·) from Sect.13.5.2, fL(·) from Eq.(13.18) and
IS =
 ∞
2RI
δPSLWℓL(t)e−(βBt+pB)
PMℓL(R) + δPSLWℓL(t)t dt
(13.34)
IL =
 ∞
R

1 −
ℓL(R)
ℓL(R) + δℓL(t)

t v(t)dt
(13.35)
IN =
 ∞
ΨL(R)

1 −
ℓL(R)
ℓL(R) + δℓN(t)

t (1 −v(t))dt.
(13.36)
When the user is served by the closest NLOS macro BS, its coverage probability
is calculated as
Pc,N(δ) = P

ER0[γN(R0) > δ]

=
 ∞
RI
e−2π(μSIS+μM(IL+IN))fN(R)dR
(13.37)

312
M. Rupp et al.
where γN(·) and fN(·) are obtained from Eq.(13.22) and Sect.13.5.2, and
IS =
 ∞
2RI
δPSLWℓL(t)e−(βBt+pB)
PMℓN(R) + δPSLWℓL(t)t dt
(13.38)
IL =
 ∞
ΨN(R)

1 −
ℓN(R)
ℓN(R) + δℓL(t)

t v(t)dt
(13.39)
IN =
 ∞
R

1 −
ℓN(R)
ℓN(R) + δℓN(t)

t (1 −v(t))dt.
(13.40)
Proof For a given BS distance R0, the proofs for P[γN(R0) > δ] and P[γL(R0) >
δ] are carried out along the lines of [18, Appendix F]. Averaging over R0 yields
Eqs.(13.33) and (13.37), respectively.
Finally, Theorems 13.3 and 13.4 enable to extend Eq.(13.16). The coverage prob-
ability of a typical indoor user at distance r, 0 < r ≤RI, which experiences LOS-
and NLOS macro BSs, is expressed as
Pc(δ|r) = ηPc,S(δ|r) + (1 −η)(ALPc,L(δ) + (1 −AL)Pc,N(δ)),
(13.41)
where η denotes the small cell occupation probability and AL is the likelihood that
the user associates with a LOS macro BS, as derived in Eq.(13.21).
13.5.3
Numerical Evaluation
In this section, the performance of a typical user at the edge of a building, i.e., r = RI,
is numerically evaluated. The results are provided in terms of normalized ergodic
rate and are obtained by plugging Pc(δ|R) from Eq.(13.41) into Eq.(13.17).
Signal propagation along LOS- and NLOS links is modeled by
ℓL(R) = ℓO(R) LL,
(13.42)
ℓN(R) = e−βBR(1−LB) ℓO(R) LN,
(13.43)
where LL and LN denote the wall penetration losses, exp(−βBR(1−LB)) accounts for
the shadowing, as referred from Sect.13.2.5, and ℓO(·) refers to the log-distance path
loss, as deﬁned in Sect.13.2.5. Note that, in general, the intercept bO, the constant cO
and the path loss exponent αO will be different in the LOS- and NLOS case. These
models are based on the following ﬁndings from measurement campaigns.
For analytical convenience, the characteristics of an urban environment are often
condensed into different variances of a log-normally distributed RVs, which account
for the shadowing [37]. However, the authors of [30] observed considerable devia-
tions from this model in LOS scenarios, where signal characteristics are largely dom-
inated by free space propagation as long as the ﬁrst Fresnel zone is not obstructed

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
313
[30–34]. Breaking distances of 160–800m have been reported from measurements in
metropolitan areas [33, 38]. Using the concept of a LOS ball as deﬁned in [28] yields
equivalent circular LOS areas of radius 49.1m for pI = 0.8, 96.2m for pI = 0.5
and 266m for pI = 0.2, respectively. Hence, it is considered reasonably accurate
to employ a single-slope free-space path loss law for LOS signal propagation, i.e.,
αO = 2 in Eq.(13.42).
In accordance with the 3GPP LTE-A standard [39] and numerous measurement
campaigns [31–34, 40, 41], NLOS propagation alters the path loss exponent and adds
an additional shadowing component. In this section, αO = 4 and LB = 10−1, respec-
tively. Furthermore, measurement results in [30, 35, 36] indicate that signals from a
NLOS BS experience a lower wall penetration loss. Intuitively, this is caused by the
fact that multi path components approach the building more frontally after multiple
reﬂections. The wall penetration loss for NLOS links is set LN = 10−1 whereas
the loss for LOS links, LL, is varied as speciﬁed below. Table13.2 summarizes the
parameters for numerical evaluation.
In order to verify the accuracy of the virtual building approximation, Monte Carlo
simulations are carried out with the same system model. BS are distributed over a
ﬁeld of 15 RC × 15 RC and their density is chosen such that the inscribing ball of the
typical cell has a radius of 250m. The results are assessed from averaging over 500
spatial- and 500 fading realizations.
Figure13.7 depicts normalized ergodic rate τ(RI) over indoor coverage ratio pI.
The curves correspond to two small cell occupation probabilities, η = 0.2 and
η = 0.8, and two wall penetration loss values for the LOS signal, LL = 10−1 and
LL = 10−3, respectively.
It is observed that
• Unlike results in Sect.13.4, the normalized rate does not increase uniformly with
the indoor coverage ratio but rather exhibits certain minima. This is explained by
the facts that (i) a low indoor coverage ratio favors LOS connections and (ii) the
likelihood to experience a LOS link rapidly decreases with higher indoor coverage
ratio as the exponent of the LOS probability v(R) linearly scales with the building
density.
Table 13.2 Parameters for
numerical evaluation
Parameter
Value
Macro-to-small cell power
ratio
PS/PM = 10−2
Macro BS density
μM = 4.61 × 10−6 m−2
Radius of building area
RI = 25 m
Intercept of path loss law
bO = 1
Constant of path loss law
cO = 1
LOS path loss exponent
αO = 2
NLOS path loss exponent
αO = 4
Building penetration loss
LB = 10−1
NLOS wall penetration loss
LN = 10−1

314
M. Rupp et al.
Normalized rate [bit/s/Hz]
Indoor coverage ratio
LL=10-1
LL=10-3
=0.8
=0.2
LL=10-1
LL=10-3
0.2
0.3
0.4
0.5
0.6
0.7
0.8
1
2
3
4
5
6
Analysis
Simulations
Fig. 13.7 Normalized rate in [bit/s/Hz] over indoor coverage ratio. Solid- and dashed lines corre-
spond to results from analysis and simulations, respectively. Curves are depicted for varying small
cell occupation probability η and wall penetration loss for LOS links, LL, respectively
• InascenariowithlowwallpenetrationlossforLOSlinks,smallcellBSsareweakly
isolated from the outdoor environment. Hence, for a high small cell occupation
probability, they considerably contribute to the aggregate interference. As a result,
the normalized rate for LL = 10−1 and η = 0.8 monotonically increases rather
than exhibiting a minimum.
• The impact of the wall penetration loss becomes inferior with higher indoor area
coverage. The result is based on the effects that (i) the likelihood of experiencing
LOS interferers reduces with decreasing LOS probability and (ii) a higher building
density establishes a safeguard against NLOS interferers. This corroborates previ-
ous ﬁndings that it is the amount of blockages rather than their exact penetration
loss which dominates the effect of indoor-outdoor partitioning.
• The curves precisely ﬁt with results from Monte Carlo simulations. In compari-
son to Sect.13.4, the consideration of LOS- and NLOS macro BSs improves the
accuracy of the model.
As shown in Chap.14, these effects cannot be identiﬁed with the widely used log-
normal shadowing model.
13.6
Conclusion
This chapter introduces a novel system model for two-tier heterogeneous cellular net-
works in urban environments. The focus lies on indoor users. Analytical expressions
for the coverage probability in buildings with- and without small cell deployment
are derived. The proposed virtual building approximation considerably improves the

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
315
tractability of the analysis. Its accuracy is conﬁrmed by simulation results. Numer-
ically evaluations are carried out to investigate the performance of a typical indoor
user in terms of normalized ergodic rate. The results reveal essential effects of an
urban environment. Observations such as the blockage safeguard and the vanishing
impact of LOS BSs and wall isolation with increasing building density are missed
by overly simplistic models, as demonstrated in the next chapter.
References
1. V. Chandrasekhar, J. Andrews, Spectrum allocation in tiered cellular networks. IEEE Trans.
Commun. 57(10), 3059–3068 (2009)
2. V. Chandrasekhar, J. Andrews, Uplink capacity and interference avoidance for two-tier cellular
networks, in IEEE Global Telecommunications Conference, Washington (2007), pp. 3322–
3326. doi:10.1109/GLOCOM.2007.630
3. P. Xia, V. Chandrasekhar, J.G. Andrews, Open vs. closed access femtocells in the uplink. IEEE
Trans. Wireless Commun. 9(12), 3798–3809 (2010)
4. F. Baccelli, B. Blaszczyszyn, P. Muhlethaler, Stochastic analysis of spatial and opportunistic
ALOHA. IEEE J. Sel. Areas Commun. 27(7), 1105–1119 (2009). doi:10.1109/JSAC.2009.
090908
5. H. Wang, M. Reed, Tractable model for heterogeneous cellular networks with directional
antennas, in Australian Communications Theory Workshop, Wellington (2012), pp. 61–65.
doi:10.1109/AusCTW.2012.6164907
6. S.Mukherjee,UEcoverageinLTEmacronetworkwithmixedCSGandopenaccessfemtoover-
lay, in IEEE International Conference on Communications Workshops (ICC), Kyoto (2011).
doi:10.1109/iccw.2011.5963549
7. V. Chandrasekhar, M. Kountouris, J. Andrews, Coverage in tiered cellular networks with spatial
diversity, in IEEE Global Telecommunications Conference, Honolulu (2009). doi:10.1109/
GLOCOM.2009.5425918
8. V. Chandrasekhar, J. Andrews, Z. Shen, T. Muharemovict, A. Gatherer, Distributed power con-
trol in femtocell-underlay cellular networks, in IEEE Global Telecommunications Conference,
Honolulu (2009)
9. V. Chandrasekhar, M. Kountouris, J.G. Andrews, Coverage in multi-antenna two-tier networks.
IEEE Trans. Wirel. Commun. 8(10), 5314–5327 (2014)
10. J. Andrews, F. Baccelli, R. Ganti, A tractable approach to coverage and rate in cellular net-
works.IEEETrans.Commun.59(11),3122–3134(2011).doi:10.1109/TCOMM.2011.100411.
100541
11. H.-S. Jo, Y.J. Sang, P. Xia, J. Andrews, Heterogeneous cellular networks with ﬂexible cell
association: a comprehensive downlink SINR analysis. IEEE Trans. Wireless Commun. 11(10),
3484–3495 (2012). doi:10.1109/TWC.2012.081612.111361
12. S. Mukherjee, Distribution of downlink SINR in heterogeneous cellular networks. IEEE J. Sel.
Areas Commun. 30(3), 575–585 (2012)
13. T. Bai, R. Vaze, R.W. Heath Jr., Analysis of blockage effects on urban cellular networks. IEEE
Trans. Wirel. Commun. 13(9), 5070–5083 (2014). doi:10.1109/TWC.2014.2331971
14. 3rdGenerationPartnershipProject(3GPP),Studyon3DchannelmodelforLTE,3rdGeneration
Partnership Project (3GPP), TR 36.873 (2014)
15. H. ElSawy, E. Hossain, Two-tier HetNets with cognitive femtocells: downlink performance
modeling and analysis in a multichannel environment. IEEE Trans. Mob. Comput. 13(3), 649–
663 (2014). doi:10.1109/TMC.2013.36
16. H. ElSawy, E. Hossain, M. Haenggi, Stochastic geometry for modeling, analysis, and design
of multi-tier and cognitive cellular wireless networks: a survey. IEEE Commun. Surv. Tutor.
15(3), 996–1019 (2013)

316
M. Rupp et al.
17. M. Taranetz, M. Rupp, R.W. Heath Jr., T. Bai, Analysis of small cell partitioning in urban
two-tier heterogeneous cellular networks, in Proceedings of the International Symposium on
Wireless Communications System (ISWCS’14), Barcelona (2014)
18. M. Taranetz, System level modeling and evaluation of heterogeneous cellular networks, Ph.D.
dissertation, Institute of Telecommunications, TU Wien, 2015, http://theses.eurasip.org/theses/
611/system-level-modeling-and-evaluation-of/
19. R. Cowan, Objects arranged randomly in space: an accessible theory. Adv. Appl. Probab. 21(3),
543–569 (1989)
20. S. Chiu, D. Stoyan, W. Kendall, J. Mecke, Stochastic Geometry and its Applications, Wiley
Series in Probability and Statistics (Wiley, Chichester, 2013)
21. F. Baccelli, B. Blaszczyszyn, Stochastic Geometry and Wireless Networks: Volume I The-
ory, Foundation and Trends in Networking (Now Publishers, Hanover, 2009). doi:10.1561/
1300000006
22. B. Hanci, I. Cavdar, Mobile radio propagation measurements and tuning the path loss model in
urban areas at GSM-900 band in Istanbul-Turkey. IEEE Veh. Technol. Conf. (VTC) 1, 139–143
(2004). doi:10.1109/VETECF.2004.1399948
23. R.W. Heath Jr., M. Kountouris, T. Bai, Modeling heterogeneous network interference using
Poisson point processes. IEEE Trans. Signal Process. 61(16), 4114–4126 (2013). doi:10.1109/
TSP.2013.2262679
24. G. Boudreau, J. Panicker, N. Guo, R. Chang, N. Wang, S. Vrzic, Interference coordination and
cancellation for 4G networks. IEEE Commun. Mag. 47(4), 74–81 (2009)
25. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access (E-
UTRA) physical channels and modulation, 3rd Generation Partnership Project (3GPP), TS
36.211 (2015)
26. M. Taranetz, J.C. Ikuno, M. Rupp, Sensitivity of OFDMA-based macrocellular LTE networks
to femtocell deployment density and isolation, in International Symposium on Wireless Com-
munications Systems, Ilmenau (2013)
27. M. Taranetz, M. Rupp, Performance of femtocell access point deployments in user hot-spot sce-
narios, in Australasian Telecommunication Networks and Applications Conference, Brisbane
(2012)
28. T. Bai, R.W. Heath Jr., Coverage analysis for millimeter wave cellular networks with blockage
effects, in IEEE Global Conference on Signal and Information Processing (GlobalSIP), Austin
(2013), pp. 727–730. doi:10.1109/GlobalSIP.2013.6736994
29. M. Di Renzo, Stochastic geometry modeling and analysis of multi-tier millimeter wave cellular
networks, CoRR (2014). arXiv:1410.3577
30. R. Gahleitner, E. Bonek, Radio wave penetration into urban buildings in small cells and micro-
cells. IEEE Veh. Technol. Conf. (VTC) 2, 887–891 (1994). doi:10.1109/VETEC.1994.345218.
Stockholm
31. Y. Nagata, Y. Furuya, E. Moriyama, M. Mizuno, I. Kamiya, S. Hattori, Measurement and
modeling of 2 GHz-band out-of-sight radio propagation characteristics under microcellular
environments, in IEEE International Symposium on Personal, Indoor and Mobile Radio Com-
munications (PIMRC), Sydney (1991), pp. 341–346. doi:10.1109/PIMRC.1991.571513
32. T. Schwengler, M. Glbert, Propagation models at 5.8 GHz - path loss and building penetration,
in IEEE Radio and Wireless Conference (RAWCON), Denver (2000), pp. 119–124. doi:10.
1109/RAWCON.2000.881870
33. N. Papadakis, A. Kanatas, P. Constantinou, Microcellular propagation measurements and sim-
ulation at 1.8 GHz in urban radio environment. IEEE Trans. Veh. Technol. 47(3), 1012–1026
(1998). doi:10.1109/25.704856
34. J. Andersen, T. Rappaport, S. Yoshida, Propagation measurements and models for wireless
communications channels. IEEE Commun. Mag. 33(1), 42–49 (1995). doi:10.1109/35.339880
35. F. Kakar, K. Sani, F. Elahi, Essential factors inﬂuencing building penetration loss, in IEEE
International Conference on Communication Technology (ICCT), Hangzhou (2008). doi:10.
1109/ICCT.2008.4716083

13
Analysis of Urban Two-Tier Heterogeneous Cellular Networks
317
36. J.-E. Berg, Building penetration loss at 1700 MHz along line of sight street microcells, in IEEE
International Symposium on Personal, Indoor and Mobile Radio Communications (PIMRC),
Boston (1992), pp. 86–87. doi:10.1109/PIMRC.1992.279958
37. A. De Toledo, A.M. Turkmani, Propagation into and within buildings at 900, 1800 and 2300
MHz. IEEE Veh. Technol. Conf. (VTC) 2, 633–636 (1992). doi:10.1109/VETEC.1992.245316.
Denver
38. H. Masui, T. Kobayashi, M. Akaike, Microwave path-loss modeling in urban line-of-sight
environments. IEEE J. Sel. Areas Commun. 20(6), 1151–1155 (2002). doi:10.1109/JSAC.
2002.801215
39. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access
(E-UTRA); Further advancements for E-UTRA physical layer aspects, 3rd Generation Part-
nership Project (3GPP), TR 36.814 (2010)
40. T. Rappaport, Wireless Communications: Principles and Practice, 2nd edn. (Prentice Hall PTR,
Upper Saddle River, 2001)
41. X. Zhao, J. Kivinen, P. Vainikainen, K. Skog, Propagation characteristics for wideband outdoor
mobile communications at 5.3 GHz. IEEE J. Sel. Areas Commun. 20(3), 507–514 (2002).
doi:10.1109/49.995509

Chapter 14
Simulation of Two-Tier Heterogeneous
Cellular Networks
Markus Rupp, Stefan Schwarz and Martin Taranetz
In this section, two-tier heterogeneous cellular networks are investigated, encom-
passing eNodeBs on macro sites and femtocell Base Stations (BSs), respectively.
Although numerous system level simulation campaigns have been carried out,
the utilized system models such as the dual-stripe- and the 5 × 5 approach from [1]
or other customized setups such as [2–7] are mostly too speciﬁc to systematically
investigate the impact of a femtocell enhancement on the existing macro cellular
deployment. On the other is commonly evaluated in terms of capacity and cannot
directly be transfered to achievable throughput due to highly idealistic setups.
This section introduces a system model, which enables to analyze the impact
of User Equipment (UE) distribution, femtocell deployment density and femtocell
isolation on the performance of a two-tier heterogeneous cellular network in a sys-
tematic manner. Moreover, it allows to discuss results from Chap.13. In contrast to
all previous considerations in Chaps.11–13, the focus of this chapter is on network-
wide performance metrics, i.e., a global- rather than a user-centric point of view.
14.1
System Model
The macro cellular setup comprises a central site and one tier of hexagonally arranged
neighbors, as illustrated in Fig.14.1. Each site employs three eNodeBs, which are
equipped with one sector antenna each. The antennas are arranged at a spacing of
M. Rupp (B) · S. Schwarz · M. Taranetz
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mrupp@nt.tuwien.ac.at
S. Schwarz
e-mail: sschwarz@nt.tuwien.ac.at
M. Taranetz
e-mail: martin.taranetz@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_14
319

320
M. Rupp et al.
−600
−400
−200
0
200
400
600
−500
−400
−300
−200
−100
0
100
200
300
400
500
x position [m]
y position [m]
1
2
3
4
5
6
7
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
3
0
1
2
0
1
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
Macro-site
Outdoors
Indoors
Building with 
femtocell base station
Fig. 14.1 Urban two-tier heterogeneous cellular network. UEs are located within annular regions
around the centers of the randomly distributed buildings. Buildings are served by a femtocell BS
with occupation ratio η = 0.8. Indoor- and outdoor environment are separated by wall penetration
loss LW
2π/3. Their radiation pattern is referred from [8] and is speciﬁed as
A(θ) = −min

12
 θ
θ3dB
2
, Am

,
−π ≤θ ≤π,
(14.1)
where θ3dB =
65
180π and Am = 20 dB. Applying maximum-Signal to Interference and
Noise Ratio (SINR)-based UE association, such setup yields hexagonally shaped
eNodeB coverage-regions, as illustrated in Fig.14.1. Hereinafter, these regions are
referred to as macro sectors.
Afterestablishingthemacrodeployment, NC circularly-shapedbuildingsofradius
RI = 25m are uniformly distributed within each macro sector such that their foot-
prints do not overlap each other. Along the lines of Sect.13.2, a point is denoted as
indoors, if it is covered by a building, and outdoors otherwise.
Each building hosts NU UEs, which are uniformly distributed within an annular
region of inner radius 5m and outer radius 25m around the center of the building.
This procedure is equivalent to generating UE hot-spots according to an independent
cluster process (see, e.g., [9] for nomenclature and further details on cluster

14
Simulation of Two-Tier Heterogeneous Cellular Networks
321
processes). In this case, the parent process is constituted by the distribution of the
building centers. A UE-cluster is formed by the UEs of a given building. In total,
there are NS = NCNU UEs in each macro sector, hereafter denoted as sector UEs.
By keeping NS constant, the parameters NC and NU adjust the degree of clustering,
also referred to as extent of clustering or level of inhomogeneity [10].
Femtocell BSs are deployed at the centers of buildings and equipped with omni-
directional antennas. Their occupation ratio η is tuned by NF/NC, with 0 ≤NF
≤NC (cf. Sect.13.2.2). The parameter NF denotes the number of randomly chosen
buildings per macro sector, which are equipped with a femtocell BS. Figure14.1
shows a snapshot with NF = 8 and NC = 10, respectively. Distributing the UEs
within an annular region around the building centers guarantees a certain minimum
distance to the femtocell BSs.
Both Open Subscriber Group (OSG)- and Closed Subscriber Group (CSG) mode
are considered. In the OSG case, a femtocell BS serves all UEs within its coverage
area (UE association regions are calculated according to a maximum SINR criterion),
whereas in the CSG mode, only the UEs of the corresponding cluster are allowed
to attach. UEs associated with an eNodeB from a macro site are denoted as macro
UEs, UEs attached to a femtocell are referred to as femto UEs, respectively. Macro-
and femtocell tiers are assumed to be uncoordinated and employ universal frequency
reuse, i.e., reuse-1, thus representing a worst-case scenario in terms of interference.
Signal propagation in and out of a building is modeled by a constant wall pen-
etration loss LW. Depending on whether a signal originates from an eNodeB on a
macro site or a femtocell BS, one of the following two path loss models is applied:
• eNodeB on macro site: The path loss model is referred from [8, subclause 4.5.2]
and depicted as dashed line in Fig.14.2.
• Femtocell BS: A dual-slope model is applied (solid line in Fig.14.2). Within the
building, the propagation model as speciﬁed in [11, subclause 5.2] is employed.
Fig. 14.2 Distance
dependent channel gain from
eNodeB on macro site and
femtocell BS
0
50
100
150
200
250
−140
−120
−100
−80
−60
−40
−20
0
Distance to transmitter [m]
Channel gain [dB]
Wall penetration LW
Building radius RI
From femtocell BS
From eNodeB on macro-site

322
M. Rupp et al.
Table 14.1 Speciﬁc simulation parameters for two-tier heterogeneous cellular network
Parameter
Value
eNodeB deployment
Three eNodeBs per macro site, 2π/3 spacing
eNodeB antenna gain
A(θ) = −min

12

θ
θ3 dB
2
, Am
	
, −π ≤θ ≤π
Femtocell BS Transmit power
PS = 26 dBm
Femtocell backhaul
Unlimited, no delay
Femtocell access mode
{OSG, CSG}
Femtocell antenna gain
0 dB omni-directional
At distance RI the signal is attenuated by the wall penetration loss LW. For dis-
tances larger than RI, again the propagation loss model from [8, subclause 4.5.2]
is utilized.
Small scale fading and shadowing are modeled by time correlated Rayleigh- and
spatially-correlated log-normal Random Variables (RVs), respectively. The simula-
tion parameters are summarized in Tables9.6 and 14.1, respectively.
The introduced system model serves as a basis for the subsequent investigations
on altering UE distribution, building characteristics and urban environment. The pre-
sented simulation results are obtained by taking into account the three sectors of the
central macro site and averaging over 100 scenario snapshots and 100 Transmis-
sion Time Intervals (TTIs) per snapshot, respectively. Network-wide performance is
represented by sector-wise metrics.
14.2
Urban Two-Tier Heterogeneous Cellular Network
In this section, the performance of a typical indoor-UE in an urban two-tier heteroge-
neous cellular LTE network is evaluated. The target is to verify results from Chap.13.
Simulations are carried out with the system model from Sect.14.1, which, however,
differs from the model in Sect.13.2 in two major aspects:
• Macro sites are arranged according to a hexagonal grid, as depicted in Fig.14.1.
This setup guarantees a certain macro sector size that is necessary to carry out
systematic simulations, as detailed in Sect.14.1.
• The characteristics of the urban topology, such as building density, are incorporated
into the standard deviation of the log-normal RVs which represent the shadowing.
Typical values in literature range from 6 to 10dB[12–19]. The rationale for this
model is to emphasize the difference to the exponential law in Eq.(13.5).
In accordance with Chap.13, performance is evaluated for two wall penetration
losses LW = {−10, −30} dB, and two femtocell occupation ratios η = {0.2, 0.8},
respectively. Figure14.3 shows the average spectral efﬁciency of a typical indoor
UE plotted over the shadow fading standard deviation. It is observed that

14
Simulation of Two-Tier Heterogeneous Cellular Networks
323
Fig. 14.3 Average spectral
efﬁciency [bit/s/Hz] of
typical indoor UE. Results
are provided for femtocells
operating in OSG- and CSG
mode, respectively.
Performance is evaluated for
two wall penetration losses
LW = {−10, −30} dB, and
two femtocell occupation
ratios η = {0.2, 0.8},
respectively. The shaded
regions denote 95%
conﬁdence intervals. a
Femotcell OSG-mode. b
Femotcell CSG-mode
6
6.5
7
7.5
8
8.5
9
9.5
10
0
1
2
3
4
5
6
Shadow fading standard deviation [dB]
Average spectral efficiency [bit/s/Hz]
LW=-10 dB
LW=-30 dB
=0.8
=0.2
LW=-10 dB
LW=-30 dB
(a)
6
6.5
7
7.5
8
8.5
9
9.5
10
0
1
2
3
4
5
6
Shadow fading standard deviation [dB]
Average spectral efficiency [bit/s/Hz]
LW=-10 dB
LW=-30 dB
=0.8
=0.2
LW=-10 dB
LW=-30 dB
(b)
• The standard deviation of the shadow fading has almost no effect on the per-
formance. Thus, the impact of the urban environment topology is completely
overlooked with the log-normal model. Moreover, the model neglects the dif-
ferentiation between Line-Of-Sight (LOS)- and Non Line of Sight (NLOS) BSs,
as investigated in Sect.13.5. The importance of the latter is manifested through its
inclusion into Rel. 12 of the Long Term Evolution (LTE) standard [20].
• The performance in OSG- and CSG-mode considerable deviate at high femto-
cell occupation ratio (η = 0.8) and low wall penetration (LW = −10 dB). This is
caused by the fact that, in the OSG case, UEs in a building without femtocell-BS
can associate with a femtocell in a close-by building. In contrast, CSG opera-
tion forces these UEs to associate with the eNodeB on the macro site. Moreover,
they will receive severe interference from the nearby femtocell-BS. This aspect is
further investigated in Sect.14.4 as it is not considered in the model of Chap.14.

324
M. Rupp et al.
Fig. 14.4 Spectral efﬁciency
[bit/s/Hz] of typical indoor
user versus area ratio that is
covered by buildings. Curves
are obtained by numerical
evaluating the theoretical
model from Chap.13 and
applying the calibration
parameters αB = 0.85 and
αSIR = 0.5. Curves are
depicted for varying small
cell occupation probability η
and wall penetration loss LW
1
2
3
4
5
6
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0
Average spectral efficiency [bit/s/Hz]
Indoor coverage ratio
LW=-10 dB
LW=-30 dB
=0.8
=0.2
LW=-10 dB
LW=-30 dB
Analysis
Simulations
For comparison, a numerical evaluation of Eq.(13.17) with Pc(δ|r) from
Eq.(13.16) is carried out, assuming that the users are uniformly distributed within
an annulus of inner radius 5m and outer radius RI = 25m, respectively. Since
the simulator does not distinguish LOS- and NLOS BSs, it is refrained from
employing the more elaborated model from Sect.13.5. The curves are computed
with the settings PS/PM = 10−2 and μM = 4.61 × 10−6 m−2 (according to the BS
density in a hexagonal grid with an inter-site distance of 500m), and the calibra-
tion parameters αB = 0.85 and αSIR = 0.5 from Sect.12.5. According to Sect.14.1,
outdoor- and indoor path loss are speciﬁed as ℓO(R) = min(10−7, 1/101.597 R−3.76)
and ℓI(r) = min(10−4.5, 1/103.846 r−2), respectively. Figure14.4 shows the results.
It is observed that, in agreement with Sect.12.5, the theoretical model tends to
overestimate the performance due to the conservative calibration against the ideal
system performance. The deviation is particularly pronounced at high indoor area
coverage, where the building blockage provides a safeguard against interference. It
is further remarkable that, in contrast to the simulation results, the analytical curves
show a similar performance improvement when altering the wall penetration from
LW = −10 dB to LW = −30 dB for both η = 0.2 and η = 0.8. This is caused by the
fact that the model only takes into account interference from neighboring femtocells.
In conclusion, the model from Chap.13 enables more subtle insights on the effects
of building blockages than log-normally distributed shadowing, including the safe-
guard against interference as well as the decreasing impact of LOS BSs, which were
not included in the simulations due to the novelty in the 3rd Generation Partnership
Project (3GPP) standard [20]. On the other hand, it misses aspects of OSG and CSG-
operation. The subsequent sections complete the picture by systematically evaluating
network-wide performance. In the remainder of this chapter, shadowing is modeled
by spatially correlated log-normal RVs with 8 dB standard deviation.

14
Simulation of Two-Tier Heterogeneous Cellular Networks
325
14.3
User Hot Spot Scenarios
In this section, the impact of UE clustering on the global performance of femtocell-
enhanced macro cellular networks is investigated. Current research mainly focuses
on the positioning of the transmitters while users are commonly considered uniformly
distributed [21–28]. However, femtocell BSs are most effectively deployed at user
hot-spots [29, 30]. Hence, appropriate models for the user distribution are essential
to investigate the performance limits of a heterogeneous network. Based on [31], the
contributions of this section are:
• A system model is presented, which enables to explicitly identify the effects of
altering the degree of UE clustering.
• The importance of a fairness metric is stressed, as it is often disregarded in litera-
ture. By means of sum throughput, it is shown that a network-wide performance
metric provides only limited view on the UE performance, since it conceals the
distribution of the individual values.
In this section, the system model from Sect.14.1 is exploited without separating
indoor- and outdoor environment, i.e., LW = 0 dB. For a fair comparison of different
UE distributions, the total amount of UEs per sector, NS, is kept constant over all
simulations. The degree of clustering is tuned by the parameters NC and NU, i.e.,
the number of UE clusters per sector and the number of UEs per cluster, such that
NS = NCNU.
The parameter settings for simulations are summarized in Tables9.6 and 14.1,
respectively. Sector-wise sum throughput is employed as a global performance met-
ric. It is calculated by accumulating the throughput values of all NS sector UEs, i.e.,
including macro- and femto UEs. Such metric is of particular interest for network
providers when planning a femtocell roll-out.
The results are depicted in Fig.14.5. Three scenarios are investigated, ranging
from a low- to a high degree of UE clustering. The corresponding {NC, NU}-tuples
0
2
4
6
8
10
0
20
40
60
80
100
120
140
160
180
200
Sector sum throughput [Mbit/s]
Number of femtocell−occupied UE clusters
40,2
10,2
20,4
(a)
0
2
4
6
8
10
0
20
40
60
80
100
120
140
160
180
200
Number of femtocell−occupied UE clusters
Sector sum throughput [Mbit/s]
40,2
10,2
20,4
(b)
Fig. 14.5 Sector sum throughput [Mbit/s] over number of femtocell-occupied UE clusters. a Femot-
cell OSG-mode. b Femotcell CSG-mode

326
M. Rupp et al.
are speciﬁed as {40, 2}, {20, 4} and {10, 8}, respectively. It is observed that in all three
cases the sum throughput strictly increases with additional femtocells, thus conﬁrm-
ing the claim in [28]. The results however reveal that the efﬁciency of the femtocell
operation considerably depends on the degree of clustering. The sum throughput
increases steepest in a UE hot-spot scenario, and lowest in a close to uniform UE
distribution. Remarkably, the curves show a slight saturation effect when increasing
the number of femtocell BSs. This indicates that the femtocell deployment density
does not perfectly compensate for the additional interference.
Sum throughput is suitable to measure the global performance of a femtocell-
enhanced network. However, it conceals possible performance imbalances between
the individual UEs. Therefore, measures for the distribution of the throughput values
are imperative. In this section, Jain’s fairness index is employed. For a given macro
sector, it is expressed as
JFI(t) =

NS
i=1 ti
2
NS

NS
i=1 t2
i
,
(14.2)
where ti denotes the throughput as achieved by UE i.
Figure14.6 depicts the fairness index plotted over the number of femtocell occu-
pied UE clusters per macro sector. In a sparse femtocell deployment (i.e., low num-
ber of femtocell BSs), only few UEs achieve high throughput due to their vicinity
to the femtocell BSs. The remaining UEs are attached to the eNodeB on the macro
site, experiencing additional interference from the femtocells. Thus, low fairness is
observed. The index increases with the number of employed femtocell BSs. At full
femtocell occupation (η = 1), it lies below the reference case of a plain macro cellu-
lar network without femtocells (η = 0) for both OSG- and CSG mode. In accordance
with the sum-throughput results, highest fairness is achieved at the largest extent of
UE clustering.
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Number of femtocell−occupied UE clusters
Fairness
40,2
20,4
10,8
(a)
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Number of femtocell−occupied UE clusters
Fairness
40,2
20,4
10,8
(b)
Fig. 14.6 Jain’s fairness index over number of femtocell-occupied UE clusters. a Femotcell OSG-
mode. b Femotcell CSG-mode

14
Simulation of Two-Tier Heterogeneous Cellular Networks
327
Hence, femtocells are most efﬁciently deployed in scenarios with a high degree
of UE clustering. Motivated by the low fairness values, macro- and femto UE per-
formance are evaluated separately in the next section. The particular focus is on
the effect of isolating UEs in indoor areas from the outdoor environment by wall
penetration loss.
14.4
Sensitivity on Femtocell Deployment Density
and -Isolation
In this section, the impact of femtocell deployment density and -isolation on the
downlink-performance of an LTE network is investigated. Isolation is deﬁned as the
separation between indoor- and outdoor environment by wall penetration loss.
Referring to my work in [32], the contributions of this section are:
• A system model is introduced, which allows to explicitly analyze the effects of
varying femtocell density and -isolation.
• The individual UE performance, which would be concealed by network-wide per-
formance metrics (cf. Sect.14.3), is assessed by separately investigating macro-
and femto UEs.
The system model which is largely based on the setup in Sect.14.1. High- and no-
isolation scenariosareinvestigated,correspondingto LW = −20 dBand LW = 0 dB,
i.e., the worst case in terms of interference, respectively. According to results in
Sect.14.3, efﬁcient balancing of UE throughput is only possible in scenarios with a
high degree of UE clustering. Therefore, NC = 10 and NU = 8 in the remainder of
this section.
The ﬁrst metric of interest is the wideband SINR. It is deﬁned as the ratio of the
average receive power from the serving cell and the average aggregate interference
from other cells plus noise [33]. Figure14.7 depicts the corresponding Empirical
Cumulative Distribution Function (ECDF) curves for OSG- and CSG mode, con-
sidering both high- and no isolation of the indoor areas. The curves are computed
from the average wideband-SINR values of the NS sector UEs. Various femtocell-
occupation ratios η = {0, 0.2, 0.4, 0.8, 1} are evaluated. Arrows indicate the direc-
tions of increasing η from 0 to 1. The case η = 0 serves as a baseline, representing
a macro cellular network without femtocells.
The major observations are
• High- and no-isolation scenarios exhibit signiﬁcantly different characteristics. On
the one hand, for LW = −20 dB the SINR almost consistently improves with
increasing η. On the other hand, for LW = 0 dB it hardly deviates from the baseline
in the OSG case, while deteriorating in the CSG scenarios. These results indicate
the system’s high sensitivity to ﬂuctuations of the femtocell isolation.
• The step-like behavior of the curves, which is particularly pronounced in OSG
scenarios at high isolation, indicates a severe imbalance between UEs with

328
M. Rupp et al.
Fig. 14.7 SINR ECDFs for
various femtocell-occupation
ratios η = {0, 0.2, 0.4,
0.6, 0.8, 1} and wall
penetration losses
LW = {0, −20} dB,
respectively. Arrows denote
the direction of increasing η.
The case η = 0 serves as a
baseline, corresponding to a
macro cellular network
without femtocells.
a Femotcell OSG-mode.
b Femotcell CSG-mode
−20
−10
0
10
20
30
40
0
0.1
0.2
0.3
0.4
0.5
0.7
0.8
0.9
1
UE wideband SINR [dB]
0.6
ECDF
=1
=1
=0
LW=0 dB
LW=-20 dB
(a)
−20
−10
0
10
20
30
40
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
UE wideband SINR [dB]
ECDF
=1
=1
=0
LW=0 dB
LW=-20 dB
(b)
good- and UEs with bad channel conditions. Figure14.8 depicts a snapshot of
individual average-UE-throughput values over SINR for LW = −20 dB, η = 0.6
and OSG mode. It allows to unambiguously identify the two groups as macro- and
femto UEs, thus motivating their separate investigation.
Figure14.9 shows throughput values as achieved by the typical macro-, femto-
and sector UE, respectively. The results are obtained by averaging over the individual
throughput values of the corresponding UE class. The axis of abscissas shows the
femtocell occupation ratio η. It is found that
• The throughput of the typical sector UE monotonically increases with larger η and
achieves its maximum at full femtocell occupation, i.e., η = 1.
• The performance of a typical femto UE is considerably higher for high isolation
(LW = −20 dB) than for no isolation (LW = 0 dB). The latter might serve as a

14
Simulation of Two-Tier Heterogeneous Cellular Networks
329
−20
−10
0
10
20
30
40
0
2
4
6
8
10
12
14
UE wideband SINR [dB]
Average UE throughput [Mbit/s]
Femto-UEs
Macro-UEs
Typical sector-UE
Typical femto-UE
Typical macro-UE
Fig. 14.8 Snapshot of individual average-UE-throughput values [Mbit/s] over wideband SINR
[dB] for wall penetration loss LW = −20 dB, femtocell occupation ratio η = 0.6 and OSG mode.
The dashed lines denote throughput values of the typical macro-, femto- and sector UE as referred
from Fig.9a, respectively
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7 0.8
0.9
1
0
2
4
6
8
10
12
14
Throughput [Mbit/s]
LW=-20 dB
LW=0 dB
Femto-associated
Sector
Reference for
snapshot
Macro-associated
(a)
0
2
4
6
8
10
12
14
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7 0.8
0.9
1
Throughput [Mbit/s]
LW=-20 dB
LW=0 dB
Femto-associated
Sector
Macro-associated
(b)
Femtocell occupation ratio 
Femtocell occupation ratio 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7 0.8
0.9
1
0
2
4
6
8
10
12
14
Throughput [Mbit/s]
LW=-20 dB
LW=0 dB
Femto-associated
Sector
Reference for
snapshot
Macro-associated
(a)
0
2
4
6
8
10
12
14
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7 0.8
0.9
1
Throughput [Mbit/s]
LW=-20 dB
LW=0 dB
Femto-associated
Sector
Macro-associated
(b)
Femtocell occupation ratio 
Femtocell occupation ratio 
Fig. 14.9 Throughput of typical macro-, femto- and sector UE [Mbit/s] over femtocell occupation
ratio η for LW = {0, −20} dB. Shaded regions denote 95% conﬁdence intervals. The circled points
in (a) corresponds to the straight dashed lines in Fig.14.8. a Femotcell OSG-mode. b Femtocell
CSG-mode
warning scenario for network providers, considering open doors and windows
throughout the whole scenario.
• In agreement with the results in Sect.14.3 and the observations in the current
section, the throughput of the typical sector UE considerably deviates from the
typical macro- and femto-UE performance. This becomes particularly clear in
OSG scenarios with LW = 0 dB, where the throughput of the typical sector UE is
enhanced while the performance of the typical macro UE deteriorates.

330
M. Rupp et al.
• Except for the aforementioned case, the throughput of the typical macro UE
generally improves for increasing η. This is caused by the fact that handing off
a growing amount of macro UEs to the femtocells compensates for the harm of
additional interference.
Mapping the circled throughput values in Fig.14.9a to Fig.14.8 (straight dashed
lines) substantiates the observation that the individual UE either performs much
better or much worse than the typical sector UE. On the other hand, typical macro-
and femto UE throughputs provide reasonably accurate indicators for the actual
performances.
Hence, these two metrics bridge the gap between individual- and sector-wise per-
formance. Figure14.10 depicts typical femto- versus typical macro UE throughput.
Each point represents a certain femtocell occupation ratio η, with lines connecting
successive values. This depiction is conceptually similar to a capacity- or through-
put trade-off region with the competing axes being typical macro- and typical femto
UE throughput [34, 35], respectively. The following observations are equivalently
obtained from Fig.14.9, but become much clearer from Fig.14.10:
• The typical femto UE throughput is almost constant for η > 0. High- and
no-isolation scenario differ by a factor of about 3.8 in OSG- and about 3.5 in
CSG-mode, respectively.
• In OSG mode the average macro UE throughput grows with increasing η at LW =
0 dB, even exceeding the performance at LW = −20 dB. In the CSG case, the
throughput tuples exhibit a loop, yielding the lowest throughput of the typical
macro UE at full femtocell occupation. Thus, operation in CSG mode is more
resilient to ﬂuctuations of LW.
In conclusion, the results in this section conﬁrm the assumption from Sect.14.3
that the imbalance among individual UE performance values mainly results from
0.2
0.4
0.6
0.8
1
1.2
1.4
0
2
4
6
8
10
12
14
Typical macro-UE throughput [Mbit/s]
Typical femto-UE throughput [Mbit/s]
=1
=1
=0
LW=0 dB
LW=20 dB
(a)
0.2
0.4
0.6
0.8
1
1.2
1.4
0
2
4
6
8
10
12
14
Typical macro-UE throughput [Mbit/s]
Typical femto-UE throughput [Mbit/s]
=0
=1
=1
LW=0 dB
LW=20 dB
(b)
Fig. 14.10 Typical femto- versus typical macro UE throughput [Mbit/s]. Each point corresponds
to a certain femtocell occupation ratio η ∈{0, 0.1, 0.2, 0.4, 0.6, 0.8, 1}. Lines connect throughput
tuples of successive η-values. a Femotcell OSG-mode. b Femotcell CSG-mode

14
Simulation of Two-Tier Heterogeneous Cellular Networks
331
the difference between macro- and femto UEs. On the other hand, performances
within the corresponding UE class turned out to be relatively similar and motivated
to introduce the notions of typical macro- and typical femto UE. Depicting their
throughput values in a similar manner to a capacity region revealed that femtocell
isolation mainly scales the throughput of the typical femto UEs while femtocell den-
sity and femtocell access mode predominantly affect the performance of the typical
macro UE.
References
1. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access
(E-UTRA); Further advancements for E-UTRA physical layer aspects, in 3rd Generation Part-
nership Project (3GPP), TR 36.814, March 2010
2. E. Pateromichelakis, M. Shariat, A. ul Quddus, R. Tafazolli, On the analysis of co-tier interfer-
ence in femtocells, in International Symposium Personal Indoor and Mobile Radio Communi-
cations(PIMRC) pp. 122–126 Toronto (2011). doi:10.1109/PIMRC.2011.6139696
3. F. Capozzi, G. Piro, L. Grieco, G. Boggia, P. Camarda, On accurate simulations of LTE fem-
tocells using an open source simulator. EURASIP J. Wirel. Commun. Netw. 1 (2012). doi:10.
1186/1687-1499-2012-328
4. L.T.W. Ho, H. Claussen, Effects of user-deployed, co-channel femtocells on the call drop
probability in a residential scenario, in IEEE International Symposium Personal, Indoor and
Mobile Radio Communications (PIMRC), September Athens (2007). doi:10.1109/PIMRC.
2007.4394281
5. J. Ling, D. Chizhik, R. Valenzuela, On resource allocation in dense femto-deployments, in
IEEE International Conference Microwaves, Communications, Antennas and Electronics Sys-
tems(COMCAS), Tel Aviv, November (2009). doi:10.1109/COMCAS.2009.5385992
6. D. Calin, H. Claussen, H. Uzunalioglu, On femto deployment architectures and macrocell
ofﬂoading beneﬁts in joint macro-femto deployments. IEEE Commun. Mag. 48(1), 26–32
(2010)
7. D. Lopez-Perez, A. Valcarce, G. de la Roche, E. Liu, J. Zhang, Access methods to WiMAX
femtocells: a downlink system-level case study, in IEEE International Conference Commu-
nication Systems(ICCS), pp. 1657–1662, Guangzhou, November (2008). doi:10.1109/ICCS.
2008.4737463
8. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access (E-
UTRA); radio frequency (RF) system scenarios, in 3rd Generation Partnership Project (3GPP),
TR 36.942, October 2014
9. A. Lawson, D. Denison, Spatial Cluster Modelling (Taylor & Francis, London, 2002)
10. U. Schilcher, M. Gyarmati, C. Bettstetter, Y.W. Chung, Y.H. Kim, Measuring inhomogene-
ity in spatial distributions, in Vehicular Technology Conference(VTC Spring), pp. 2690–2694
Singapore, May (2008). doi:10.1109/VETECS.2008.589
11. 3rd Generation Partnership Project (3GPP), Evolved Universal Terrestrial Radio Access (E-
UTRA); FDD Home eNode B (HeNB) Radio Frequency (RF) requirements analysis, in 3rd
Generation Partnership Project (3GPP), TR 36.921, September 2014
12. S. Seidel, T. Rappaport, S. Jain, M. Lord, R. Singh, Path loss, scattering and multipath delay
statistics in four european cities for digital cellular and microcellular radiotelephone. IEEE
Trans. Veh. Technol. 40(4), 721–730 (1991). doi:10.1109/25.108383
13. V. Erceg, L. Greenstein, S. Tjandra, S. Parkoff, A. Gupta, B. Kulic, A. Julius, R. Bianchi, An
empirically based path loss model for wireless channels in suburban environments. IEEE J.
Sel. Areas Commun. 17(7), 1205–1211 (1999). doi:10.1109/49.778178

332
M. Rupp et al.
14. M.J. Feuerstein, K.L. Blackard, T.S. Rappaport, S.Y. Seidel, H. Xia, Path loss, delay spread,
and outage models as functions of antenna height for microcellular system design. IEEE Trans.
Veh. Technol. 43(3), 487–498 (1994)
15. V. Abhayawardhana, I. Wassell, D. Crosby, M. Sellars, M. Brown, Comparison of empirical
propagation path loss models for ﬁxed wireless access systems. IEEE Veh. Technol. Conf.
(VTC) 1, 73–77 (2005). doi:10.1109/VETECS.2005.1543252
16. G. Durgin, T.S. Rappaport, H. Xu, Measurements and models for radio path loss and penetration
loss in and around homes and trees at 5.85 GHz. IEEE Trans. Commun. 46(11), 1484–1496
(1998)
17. J. Porter, I. Lisica, G. Buchwald, Wideband mobile propagation measurements at 3.7 GHz in
an urban environment, in IEEE Antennas and Propagation Society International Symposium,
vol 4 pp. 3645–3648 June (2004). doi:10.1109/APS.2004.1330136
18. T. Rautiainen, K. Kalliola, J. Juntunen, Wideband radio propagation characteristics at 5.3 GHz
in suburban environments, in IEEE International Symposium Personal, Indoor, and Mobile
Radio Communications(PIMRC), September 2005
19. T. Schwengler, M. Glbert, Propagation models at 5.8 GHz - path loss and building penetration,
in IEEE Radio and Wireless Conference(RAWCON), pp. 119–124, Denver, September (2000).
doi:10.1109/RAWCON.2000.881870
20. 3rd Generation Partnership Project (3GPP), Study on 3D channel model for LTE, in 3rd Gen-
eration Partnership Project (3GPP), TR 36.873, September 2014
21. S. Singh, H. Dhillon, J. Andrews, Downlink rate distribution in multi-RAT heterogeneous
networks, in IEEEInternational Conference Communications(ICC), pp. 5188–5193, Budapest,
June (2013). doi:10.1109/ICC.2013.6655408
22. J. Andrews, F. Baccelli, R. Ganti, A tractable approach to coverage and rate in cellular net-
works.IEEETrans.Commun.59(11),3122–3134(2011).doi:10.1109/TCOMM.2011.100411.
100541
23. M. Haenggi, R.K. Ganti, Interference in Large Wireless Networks, ser. Foundations and Trends
in Networking, vol. 3 (NoW Publishers, Hanover, 2009)
24. F. Baccelli, B. Blaszczyszyn, Stochastic Geometry and Wireless Networks: Volume I Theory,
ser. Foundation and Trends in Networking, (Now Publishers, Hanover, 2009). doi:10.1561/
1300000006
25. F. Baccelli, B. Blaszczyszyn, in Stochastic Geometry and Wireless Networks, Volume II - Appli-
cations, ser. Foundations and Trends in Networking, vol. 2, ed. by F. Baccelli, B. Blaszczyszyn,
(NoW Publishers, Hanover, 2009), doi:10.1561/1300000026
26. H.-S. Jo, Y.J. Sang, P. Xia, J. Andrews, Heterogeneous cellular networks with ﬂexible cell
association: a comprehensive downlink SINR analysis. IEEE Trans. Wireless Commun. 11(10),
3484–3495 (2012). doi:10.1109/TWC.2012.081612.111361
27. T. Zahir, K. Arshad, Y. Ko, K. Moessner, A downlink power control scheme for interfer-
ence avoidance in femtocells, in International Wireless Communications and Mobile Com-
puting Conference(IWCMC), pp. 1222–1226, Istanbul, July 2011, doi:10.1109/IWCMC.2011.
5982714
28. J. Andrews, Seven ways that HetNets are a cellular paradigm shift. IEEE Commun. Mag. 51(3),
136–144 (2013). doi:10.1109/MCOM.2013.6476878
29. V. Chandrasekhar, J. Andrews, A. Gatherer, Femtocell networks: a survey. IEEE Commun.
Mag. 46(9), 59–67 (2008). doi:10.1109/MCOM.2008.4623708
30. H.-S. Jo, P. Xia, J.G. Andrews, Open, closed, and shared access femtocells in the downlink,
in EURASIP Journal on Wireless Communications and Networking, vol. 1, December 2012,
doi:10.1186/1687-1499-2012-363
31. M. Taranetz, M. Rupp, Performance of femtocell access point deployments in user hot-spot sce-
narios, in Australasian Telecommunication Networks and Applications Conference, Brisbane,
2012
32. M. Taranetz, J.C. Ikuno, M. Rupp, Sensitivity of OFDMA-based macrocellular LTE networks
to femtocell deployment density and isolation, in International Symposium Wireless Commu-
nication Systems, Ilmenau, 2013

14
Simulation of Two-Tier Heterogeneous Cellular Networks
333
33. S. Ahmadi, LTE-Advanced: A Practical Systems Approach to Understanding 3GPP LTE
Releases 10 and 11 Radio Access Technologies, ser (Elsevier Science, Philadelphia, 2013)
34. A. Adhikary, G. Caire, On the coexistence of macrocell spatial multiplexing and cognitive
femtocells, in IEEE Int. Conf. Commun.(ICC), pp. 6830–6834, June 2012
35. J. Andrews, R. Ganti, M. Haenggi, N. Jindal, S. Weber, A primer on spatial modeling and
analysis in wireless networks. IEEE Commun. Mag. 48(11), 156–163 (2010)

Chapter 15
Advanced System Level Applications
Martin Müller and Illia Saﬁulin
System level simulations have been proven to be a very important means when the
behavior of many users need to be taken into account. Typical numbers can be 20,
100 or even 1000. In the following we demonstrate the feasibility of such studies on
the example of communications in trains and in cars. In train communications we
typically have a single train connected to a base-station but the train, e.g., German
Inter-City Express (ICE), may carry 500 users at once. Similarly, along motorways
there may be 500 cars with one user each in the neighborhood of a base-station.
15.1
Modeling Train Transmissions
Martin Müller
In the current market of train services, being able to provide mobile broadband
access to costumers has become a main inducement for choosing this means of
transportation. Due to the ubiquitous use of the Internet and the rapid adoption of
novel devices such as smart phones and tablet computers, most passengers have
become accustomed to experiencing high data rates and having the service follow-
ing them no matter where they go. With the number of commuters being expected
to increase, the high user mobility is also one of the most emphasized scenarios in
the initiative for the ﬁfth generation of wireless communications (5G). Long Term
Evolution-Advanced (LTE-A), the contemporary standard for wireless communi-
cation, is not optimized for the challenges of High Speed Train (HST) scenarios.
M. Müller (B) · I. Saﬁulin
Institute of Telecommunications, TU Wien, Vienna, Austria
e-mail: mmueller@nt.tuwien.ac.at
I. Saﬁulin
e-mail: illia.saﬁulin@tuwien.ac.at
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3_15
335

336
M. Müller and I. Saﬁulin
Hence, many train operators—mostly in collaboration with mobile operators—have
increased efforts to satisfy the ever increasing requirements. There also exist inter-
national collaborations on a broad level to push for higher data rates and shorter
latencies, for example the Shift2Rail initiative by the European Union [1].
Wireless communications in HST scenarios is confronted with unique conditions,
which have a considerable impact on network planning. In particular, the scenarios
are characterized by User Equipments (UEs) being densely packed inside of the train
and moving at high speed, as well as the speciﬁc propagation effects in a diversity
of different environments. More particularities are described in [2].
Employing dedicated hardware in the vicinity of the tracks allows to optimize
the positioning of the stationary infrastructure. One promising approach for that
matter is the utilization of Remote Radio Units (RRUs). Thus, also due to the smaller
dimensions, the point of radiation can be brought closer to the tracks. Such distributed
radiation points can be efﬁciently simulated with the Vienna LTE-A Dowlink System
Level Simulator, as explained in Sect.10.5. An additional advantage of RRUs is the
possibility of collaboration among them, leading to a potential improvement of the
overall system performance. The ﬁrst part of this section deals with the description
of the comparison of such collaboration schemes and is based on [3]. We introduce
a theoretical model and compare it to the results obtained from simulations.
There exist two main approaches, when communication in HST scenarios is con-
sidered. Most publications on this topic assume a relay-based approach, assuming
additional hardware installed on the train, i.e., a relay that communicates with the
Evolved Base Station (eNodeB) as well as with UEs without them communicating
directly [4, 5]. However, the direct communication between UEs and Base Stations
(BSs) has its own advantages, but has not been given enough attention in literature.
We discuss a comparison between the relay approach and the less studied direct link
approach in the second part of this section. It is based on [6]. Next to a general
comparison we also provide simulation results to compare the performance of both
approaches.
15.1.1
Performance of Remote Unit Collaboration Schemes
15.1.1.1
System Model
First we introduce the system model. We consider a representative segment of an
RRU deployment along a railroad track, which comprises four equidistantly spaced
sites, each equipped with two RRUs, pointing in opposite directions, as shown in
Fig.15.1. The train is assumed to move between RRU0 and RRU1, and its center
position is expressed relative to RRU0 as δ dB, with 0< δ <1. The nodes RRU−1 and
RRU2 serve as dominant interferers. For simplicity, all other sources of interference
are neglected. Due to antenna directivity, some RRUs are ignored in the analysis, as
indicated by dashed arrows in Fig.15.1.

15
Advanced System Level Applications
337
Fig. 15.1 Representative segment of a railroad track with four equidistantly spaced sites. Each site
employs two RRUs pointing in opposite directions. RRUs depicted as dashed lines are omitted in
the analysis. The UE is located at position δ dB relative to RRU0
There are several ways to associate eNodeBs with the RRUs. In this work, we
investigate three schemes:
1. Baseline. All RRUs employ different cell IDs, i.e., are attached to different
eNodeBs. Then,
S = {RRU0}; I = {RRU−1, RRU1, RRU2}, 0 < δ < 0.5
S = {RRU1}; I = {RRU−1, RRU0, RRU2}, 0.5 < δ < 1.
(15.1)
2. Coordination. RRU0 and RRU1 are attached to different eNodeBs and coordinate
their transmission such that they do not interfere each other. Then,
S = {RRU0}; I = {RRU−1, RRU2}, 0 < δ < 0.5
S = {RRU1}; I = {RRU−1, RRU2}, 0.5 < δ < 1.
(15.2)
3. Cooperation. RRU0 and RRU1 are associated with the same eNodeB and coor-
dinate their transmission such that both can be exploited as useful signal. Then,
S = {RRU0, RRU1}; I = {RRU−1, RRU2}, 0 < δ < 0.5
S = {RRU0, RRU1}; I = {RRU−1, RRU2}, 0.5 < δ < 1.
(15.3)
To make a fair comparison, it is assumed that the transmit power per eNodeB is
limited to PT, i.e.,

{i|RRUi∈S }
PTx
i
≤PT.
(15.4)
In order to clarify the impact of the RRU deployment on the performance, no sophisti-
catedpower allocationtechniques areapplied. Inthecooperation scheme, associated-
and interfering RRUs transmit with half power in each direction.
15.1.1.2
Theoretical Model
For the analysis, the signal from RRUi is assumed to experience a log-distance
dependent path loss law ℓi(δ) with exponent α = 2 (i.e., free space propagation)

338
M. Müller and I. Saﬁulin
and Gamma distributed small-scale fading, G ∼Γ [NTx, θ], which corresponds to
Maximum Ratio Transmission (MRT) with NTx transmit antennas and θ is the scale
parameter of the fading. The relevance of the Gamma distribution is explained by
the facts that it includes several important channel models such as Rayleigh and
Nakagami-m as special cases and further allows to accurately approximate composite
fading distributions such as Rayleigh-Lognormal [7].
The received power from RRUi at a UE at relative position δ is expressed as
PRx
i
(δ) = PTx
i
Gi ℓi(δ),
(15.5)
where PTx
i
denotes the transmit power of RRUi. Assuming that the penetration loss
into the train carriage is constant, it can be omitted in the analysis since the scenario
is considered interference limited.
ApplyingMRTcorrespondstoabestcasescenariointermsofdesiredsignalpower
and a worst case in terms of interference. The corresponding aggregate received
powers are
S(δ) =

{i|RRUi∈S }
PRx
i
(δ),
(15.6)
I (δ) =

{i|RRUi∈I }
PRx
i
(δ),
(15.7)
where S and I refer to the set of desired and interfering RRUs as obtained from
Eqs.(15.1)–(15.3), respectively. These expressions correspond to weighted sums
of Gamma Random Variables (RVs). Sticking to integer-valued shape parameters,
which correspond, e.g., to the number of antennas per RRU under the assumptions of
MRT and Rayleigh fading, allows to employ the Generalized Integer Gamma (GIG)
distribution[8].Ityieldsexpressionsoftheform
k akxbkeckx forbothdesiredsignal-
and aggregate interference distributions, respectively. Then, the distribution of the
Signal-to-Interference Ratio (SIR) γ (δ) = S(δ)/I (δ) generically formulates as (see
Appendix of [3])
fγ (γ ;r) =

s

i
asaiγ bs(ci + csγ )−i−bs−biΓ (i + bs + bi).
(15.8)
The spectral efﬁciency is deﬁned by the well known expression τ(γ (δ)) = log2(1 +
γ (δ)). Its distribution is straightforwardly obtained by a non-linear, monotone trans-
formation of RVs applied on Eq.(15.8) as
fτ(τ; δ) = log(2)2τ fγ (2τ −1;r).
(15.9)
Since the length of the train is typically in the same order of magnitude as the inter-
RRU distance, it is not reasonable to represent all passengers by a single point. We
apply the following procedure for performance evaluation. First, we determine the

15
Advanced System Level Applications
339
average spectral efﬁciency at each UE position between RRU0 and RRU1. Then, we
assume the UEs to be uniformly distributed within the train. Intuitively, the train thus
acts as a sliding window for the moving average over the single UEs’ performances.
The result is an average spectral efﬁciency value for each train position, also referred
to as train average spectral efﬁciency in the remainder of this section.
For numerical evaluation, we consider a setup as illustrated in Fig.15.1 with dB =
1000m. The train has a length of 200.84m and a width of 2.95m, corresponding to
a German “ICE 3” train. Each RRU employs two transmit antennas and each UE is
equipped with one receive antenna. Results in terms of train average spectral efﬁ-
ciency for each RRU collaboration scheme are provided in Fig.15.2, represented
by the dashed curves and are discussed later in this section, together with the sim-
ulation results. The original results were obtained under the assumption that each
RRU chooses its MRT beamformer independently. However, a LTE-A system only
offers codebooks with a limited number of precoders, which typically distribute
the available transmit power uniformly over all transmit antennas. As the simulator
also applies LTE-A-compliant codebook based precoding, the numerical results of
the theoretical model are scaled by a factor that accounts for the loss from utilizing
codebook based precoding. This factor is constant over the train center position (with
negligible variations).
100
300
500
700
900
0
1
2
3
4
4.5
Train center position x [m]
Train Average Spectral Efﬁciency [bit/s/Hz]
Coordination
Baseline
Cooperation
Simulation
results
Theoretical
 results
Fig. 15.2 Train average spectral efﬁciency in [bit/s/Hz] over train center position for baseline-,
coordination- and cooperation scheme. Dashed- and solid curves refer to results of theoretical
model and simulations, respectively (Conﬁdence intervals are insigniﬁcantly small and therefore
omitted in the ﬁgure.)

340
M. Müller and I. Saﬁulin
15.1.1.3
Simulation Setup
For simulations we consider the same ICE 3 train with the same dimensions as
before and 460 seats in total. We assume 230 active UEs and employ a full-buffer
trafﬁc model. The UEs are distributed within the train according to a uniform random
distribution.
RRUs dynamically assign to eNodeBs, according to the collaboration scheme.
Each eNodeB has a total transmit power of PT = 40W. The signal between eNodeB
and UE experiences path loss, fast fading and penetration loss. We employ the rural
path loss model of the TR 36.942 speciﬁcation [9], representing the typical propaga-
tion environment for a train traveling through the countryside. The small scale fading
is modeled by an ITU ‘Vehicular A’ channel [10], which is designated for receivers
inside moving metal objects. Although other literature on high speed train scenarios
commonly employs a variation of the Wireless World Initiative New Radio (WIN-
NER) Phase II model [11], it is not applicable in our case, since it was designed for
moving objects with relay-units. Finally, we account for the penetration loss into the
carriage by a constant of 30dB (more on that in the following section). A summary
of all simulation parameters is provided in Table15.1.
15.1.1.4
Discussion of Results
Numerical results of the theoretical model and the simulation results are provided
together in Fig.15.2. The results of the theoretical model are displayed by solid
lines, while the simulation results are represented by dashed lines, including the 95%-
conﬁdence intervals. It is observed that the performance for each scheme respectively
shows a close accordance of theoretical and simulation results. The major difference
in the setup—MRT versus codebook based precoding—has been accounted for by the
aforementioned correction factor. The remaining gap is caused by various practical
design constraints of an LTE-A system such as Adaptive Modulation and Coding
and scheduling (see [16]), which are not incorporated in the theoretical model.
Considering the three collaboration schemes individually, it is observed that the
cooperation scheme universally yields the best performance. This ﬁnding has also
been obtained in comparable studies, which assumed the trains to be equipped with
relay nodes [11]. Note that this scheme completely avoids handovers in the region of
interest. The coordination scheme shows a slightly lower performance than coopera-
tion, particularly when approaching the middle point between two RRUs. In practical
systems, coordination is typically far less complex than cooperation since only con-
trol data has to be exchanged between the eNodeBs. Even though the coordination
scheme is less complex in its installation and only grants a slightly reduced perfor-
mance, handovers occur more often, which might pose a problem for high speeds.
Concretely, for a train, travelling at 200km/h and an inter RRU distance of 1000m,
this would be the case every 1000m/55.5m/s = 18s. While theoretically supported

15
Advanced System Level Applications
341
Table 15.1 Simulation parameters
Parameter
Value
System bandwidth
20MHz
Carrier frequency
2.14GHz
Inter-RRU distance
1000m
eNodeB transmit power PT
40W
Antennas per RRU
2
MIMO mode
CLSM
Path loss model
TS 36.942 ‘rural’ [9]
Channel model
ITU-R Vehicular A [10]
Train speed
200km/h
Receiver type
Zero forcing
Noise power spectral density
−174dBm/Hz
Penetration loss for direct communication
30dB
Receiver noise ﬁgure
9dB
Train length
200.84m
Train width
2.95m
Active UEs
230
UE distribution within train
Random uniform
Antennas per UE
1
Trafﬁc model
Full buffer
Scheduler
Proportional fair
Channel knowledge
Perfect
Feedback
AMC: CQI, MIMO: PMI and RI
RRU backhaul connection
Radio over ﬁber, no delay
by the standard, such frequent handovers would cause considerable overhead on the
air-interface and the backhaul. The kink in the coordination results at δ = 0.5 stems
from the RRU switching. The baseline scheme yields the worst performance even
when the train is close to one of the RRUs, as RRU0 and RRU1 severely interfere
each other. Again, the kink for the theoretical results at δ = 0.5 stems from switching
off RRU0 and associating the user with RRU1. The curve for the simulation results
of the baseline scheme does not show a kink in the middle between two RRUs. This
is caused by the fact that in the simulator, UEs are assigned to the eNodeB with
the highest receive power. Consequently, for train center positions between 400 and
600m, one fraction of the UEs associates to RRU0, while the rest is assigned to
RRU1, respectively. If the UEs were forced to stay attached to one of the RRUs, the
performance would even decrease in this region.

342
M. Müller and I. Saﬁulin
rooftop-mounted
antenna
UE
UE
base station / remote unit
indoor
transmitter
electro-magnetic apertures
Fig. 15.3 Signal reception with relay- and direct-link approach. Zoomed view indicates possibilities
for applying electro-magnetic apertures
15.1.2
Comparison of Relay-Based
and Direct Communication
In this section we consider the downlink direction exclusively. Similar considera-
tions are valid for the uplink direction. Generally speaking, there exist two opposing
approaches to provide wireless communications to passengers of an HST. In the ﬁrst
case, the UE directly associates with the BSs along the tracks, while in the second
case this link is established via a relay, as shown in Fig.15.3. A comparison between
these two approaches is drawn in this section and advantages and drawbacks on
both sides are discussed. For evaluation purposes, we use the same system model as
described in Sect.15.1.1.
15.1.2.1
Relay Approach
In the relay scenario, one or several antennas are mounted on the outside of the train.
These are connected to one or more relays which are then distributing the signal inside
the train. This approach has the major advantage that the signal is not attenuated by
the windows of the carriage. Moreover, this setup allows to conﬁgure the relay such
that it appears as a single UE to the eNodeB, thus signiﬁcantly reducing the number
of handovers. Therefore, all trafﬁc is aggregated by the relays and then distributed
to the UEs.
While the quality of the experienced link might considerably be improved, the
employment of relays does not come without cost. Firstly, relays have to be licensed
for the speciﬁc band they are operating on. This is of minor consequence when no
borders are crossed. In smaller countries such as, e.g., in most European, one train
connection can easily span three or more countries. For each country, the relays have
to be registered individually or have to be switched off, which leaves the system in a
direct-link state. Another consequence is, that the employment of carriages becomes
restricted to the countries/routes for which the relays on board are licensed and thus
becomes less ﬂexible.

15
Advanced System Level Applications
343
A second issues appears with the choice of the frequencies for the RRU-to-relay
and the relay-to-UE connection. If the same frequency is used on both link-sections,
thus only bypassing the penetration loss of the carriage, the UE might still receive a
considerable amount of the desired signal by a direct link through the window. The
relative receive power of these two links depends on the individual position of the
UE and the actual penetration loss. Due to the latency caused by the relay, the signal
might be perceived via several multi-path components that cannot be equalized.
The aforementioned problem is completely avoided when two different frequen-
cies are used on both sections of the link. For example, a dedicated frequency of a
mobile operator is used from RRU to the relay and a second frequency, e.g., in the
Industrial, Scientiﬁc and Medical (ISM) band, for the supply with WiFi inside. This
setup is frequently referred to in literature [4]. Nonetheless, it only provides a data
connection for the passengers. Since only the relay is visible as a single UE for the
eNodeB, the passengers are not accessible for mobility management.
The performance of this setup may also considerably depend on the number of
antennas and relays per train/carriage. It has to be scrutinized whether the relays
should work individually (e.g., one per carriage) or if the received signals should be
combined. This is also affected by the possibility to connect all relays to all carriages.
Since a cable connection is feasible in practice, near ﬁeld communication standards
at higher frequencies than the traditional 6GHz band (e.g., in the upper mm Wave
band) may be considered for this task.
15.1.2.2
Direct-Link Approach
The direct-link approach assumes a direct connection between RRU and UE. In
comparison to the above scenario, the signal does experience a severe penetration loss
into the carriage in this case. As the chassis of the carriages is usually made of metal,
the signal enters the train mainly through the windows. However, the penetration loss
may greatly vary among window types, as they are mostly metal coated themselves.
Attenuation values range from 20 to 40dB for metal coated windows of a German
ICE-train [12], but other train-types exhibit different values as observed, e.g., in
[5, 13] with a combined range of 10–40dB.
Note that these values reﬂect the situation for current carriages in use. Since the
interest among train operators is increasing to provide best quality of experience to
their customers, the design of future trains is likely to be adapted to the demands
of the wireless link. Among various options is the possibility to introduce windows
with small penetration loss (omitting the metal coating). Another option is to include
apertures in the chassis or the window itself, by incorporating materials that are more
permeable for electro-magnetic waves, for example carbon ﬁber materials. Examples
for such apertures are indicated in Fig.15.3.

344
M. Müller and I. Saﬁulin
15.1.2.3
Simulation Results
In order to compare the relay- and the direct link setup, system level simulations
were carried out. Again, a fully occupied German ICE-train with 460 passengers
is regarded, 10% of them are having an active wireless connection. For the direct-
link setup a penetration loss of 30dB is applied referring to the mean value of the
aforementioned penetration losses. No penetration loss is considered for the relay
setup and the relay is modeled as one active UE. The simulation parameters are the
same as in Table15.1 with the difference of the train speed being set to 250km/h and
only 46 UEs. Simulations were again performed with the Vienna LTE-A Downlink
System Level Simulator.
Simulation results are shown in Fig.15.4 in terms of average UE throughput
[Mbit/s] over center position of the train [m] (conﬁdence intervals are insigniﬁcantly
small, so that they were omitted). Since the throughput at the relay represents the
cumulative throughput of all active UEs, the results for the relay-setup were normal-
ized to 46 (UEs) for a fair comparison. Dashed lines represent the baseline scheme,
solid lines the cooperation scheme. Comparing the performance of relay (circular
markers) and direct-link setup (triangular markers), employing relays improves the
performance roughly by a factor of two. This gain is surprisingly low, considering
that the UEs in the direct setup experience a penetration loss of 30 dBs, and the relays
are operating under ideal conditions (e.g., no processing delays, no overhead). Tak-
ing into account the already discussed advantages, the direct-link approach becomes
a notable alternative. The throughput peaks in the vicinity of the base stations can
Train center position x [m]
100
300
500
700
900
Average UE throughput [Mbit/s]
0
0.5
1
1.5
1.8
Baseline direct
Cooperation relay
Baseline relay
Cooperation direct
Fig. 15.4 Train average throughput [Mbit/s] versus train center position [m]. Curves refer to results
for baseline- and cooperation scheme among RRUs for relay- and direct-link setup (Conﬁdence
intervals are insigniﬁcantly small and therefore omitted in the ﬁgure.)

15
Advanced System Level Applications
345
be exploited by a sophisticated scheduler scheme. In regard of the trafﬁc-type, UEs
with delay sensitive data could be assigned resources such that their requirements
are fulﬁlled. UEs with best-effort trafﬁc models could mostly be served when the
train is closer to an RRU and a higher total data rate is available.
15.2
Evolved Multimedia Broadcast Multicast Service
Illia Saﬁulin
3GPP introduced Multimedia Broadcast Multicast Service (MBMS) initially in
Release 6 of Universal Mobile Telecommunications System (UMTS) [14]. MBMS
enables to broadcast/multicast information in 3G networks, similar to classical
radio/TV broadcast networks, targeting mobile TV as the main service offered.
Commercially successful deployments, however, have not been reported to date.
Nonetheless, development of MBMS has continued within 4G Long Term Evolution
(LTE), evolving the technology to Evolved Multimedia Broadcast Multicast Service
(eMBMS).eMBMSsupportsmulticastingnotonlyfromsinglebasestations,buteven
from multiple strictly time- and frequency-synchronized base stations, forming a so-
called Multimedia Broadcast/Multicast Single Frequency Network (MBSFN) area
(Fig.15.5). In the current Release 12 of UMTS/LTE, MBMS/MBSFN is restricted to
single antenna transmission; however, discussions are ongoing within 3GPP to enable
multi-antenna support in future releases. MBSFN operation can provide substantial
throughput gains at the cell edge for multicast users due to Signal to Interference and
Noise Ratio (SINR) enhancement, since all signals received from base stations within
the MBSFN area contribute useful information. Furthermore, MBMS/MBSFN trans-
mission can enhance network efﬁciency, because common information can be deliv-
ered highly resource and cost effective to many users in parallel. Recent interest
in the technology by network operators and equipment manufacturers exists espe-
cially in the context of venue casting [15], that is, multicasting/broadcasting at local
events. This is conﬁrmed by several technology trials conducted at sport events,
such as, football games and car racing [16–18]. At such events, MBMS can be
utilized to enhance the experience of spectators by providing additional informa-
tion, e.g., live video feeds from inside race cars [17] or slow-motions of highlight
scenes. Other applications envisioned include software/ﬁrmware/operating-system
updates for mobile Internet of Things devices [19] as well as broadcasting of road
safety related information to vehicles on highways and motorways [20]. Exchange
of safety-relevant information for vehicular safety services imposes very stringent
requirements on the employed communication technology in terms of dependability,
that is, timeliness and reliability of data exchange. Mobile communications may not
be suited as a substitute to dedicated vehicular communication technology such as
ITS G5 [21], which is speciﬁcally designed for the potentially harsh vehicular com-
munication environment, but should rather be considered as a supplement to enhance

346
M. Müller and I. Saﬁulin
Fig. 15.5 Example of
network with two MBSFN
areas
MBSFN Area 1
MBSFN Area 2
the dependability of such dedicated systems. In [22], we have investigated the per-
formance of MBSFN networks for exchange of Cooperative Awareness Messages
(CAMs) [23] amongst high mobility cars in terms of packet-error-ratio, employing
the Vienna LTE-A system level simulator.
We consider Single-Input Single-Output (SISO) transmission in the downlink of
a cellular network. The input–output relationship of user i at subcarrier k in case of
MBSFN transmission is
yk[i] =

u∈MBSFN
hk[u, i] · xMBSFN,k +

l /∈MBSFN
hk[l, i] · xk[l] + zk[i],
(15.10)
where u denotes the base station index in the MBSFN area, xMBSFN,k denotes MBMS
data, which is the same for all multicast users, zk[i] is Additive White Gaussian
Noise (AWGN) and hk[u, i] is complex channel coefﬁcient, hk[u, i] = γu · hk[u, i],
where γu denotes macroscopic pathloss and shadow fading and hk[u, i] represents
microscopic fading.
Based on Eq.(15.10) we can expressed the SINR of MBMS user i as
SINRi,multicast =
| 
u∈MBSFN h[u, i]|2
σ 2z + 
l /∈MBSFN |h[l, i]|2 .
(15.11)
In our work we assume delay- and error-free uplink transmission from vehicles to
base stations and mainly focus on the downlink domain. According to Fig.15.6 we
assume that each car user generates MBMS data of size pS bits at random starting
time r and then produces packets every T ms. These data should be successfully
distributed to all other vehicles in MBSFN area via multicasting or unicasting. The
buffer size of car user i at time n can be calculated as
bi[n] = ps −
n p

m=1
pt[n −m],
(15.12)

15
Advanced System Level Applications
347
(a)
(b)
Fig. 15.6 Explanation of latency calculation
where pt[n −m] is successfully transmitted packet of size pt bits at time [n −m]
and n p is speciﬁed as
n p =

n −⌊n
T ⌋T −r,
r < n,
n = n −⌊n
T ⌋T
n −(⌊n
T ⌋−1)T −r, r > n,
n = n −⌊n
T ⌋T,
(15.13)
which denotes the time difference between packet generation and time instancen. We
consider latency as time interval between data generation and successful delivery to
all appropriate users within the MBSFN area. The latency value can be calculated for
both cases of erroneous and error free transmission. According to the LTE standard,
Hybrid Automatic Repeat reQuest (HARQ) is not speciﬁed in MBMS transmissions.
It means that in case of the unsuccessful transmission of a packet, the packet will
not be retransmitted but instead we accumulate the latency until we successfully
receive the next packet from the same user. Additionally, if during waiting time
new packets were generated, the old packets replace them. In Fig.15.6 two cases of
latency calculation are shown in more details. In Fig.15.6a, the latency evaluation
in case of success transmission is described, while in Fig.15.6b the procedure of
latency accumulation in case of unsuccessful transmission is explained. Assuming
total number of MBMS users equal Nm_ue and each of them generate in total Npackets
packets, we stack corresponding latency values into a large matrix L of size Npackets ×
Nm_ue, with elements

348
M. Müller and I. Saﬁulin
Ls,i =

ti,
error free transmission
ti + T · j, errorneous transmission,
(15.14)
where ti is the time when bi[ti] = 0, i.e., complete transmission of packet s and j is
the number of required retransmissions.
15.2.1
Latency Evaluation
We can deﬁne three different ways of latency performance indicators:
Combined latency CDF: We transform matrix L into a vector l of size Npackets ·
Nm_ue × 1 and calculate the empirical cumulative distribution function (ECDF)
CDFcombined = ECDF

l

.
(15.15)
It should be noticed that the main contribution to this latency evaluation is added by
the users that have high SINR and, as a consequence, represent signiﬁcant amount
of low latency receptions.
CDFofmeanlatency:Wedeterminethemeanlatencyforeachuserposition(average
over all latency values s obtained at a given user (i) and calculate the Cumulative
Distribution Function (CDF) of these mean latencies.
CDFmean = ECDF

l

,
(15.16)
where [l]i =
1
Npackets
Npackets
s=1
Ls,i. Notice that this method does not represent the worst
latency, which is, however, a critical indicator especially for safety-relevant applica-
tions (road-safety transmission).
Latency of individual users: We determine the latency Empirical Cumulative Dis-
tribution Function (ECDF) of each user position individually, i.e., we obtain Nm_ue
CDFs corresponding to different car users within the network.
15.2.2
Network Utilization
Network utilization is considered as another important performance metric which
gives us better understanding of the price to be paid in terms of throughput of ordinary
unicast users for supporting MBSFN transmission. In our investigation we evaluated
the network utilization as a percentage of resources to be used for sustaining the
MBMS trafﬁc. It can be calculated as
Util =
ps · Nm_ue
NRB · NRE · EfﬁciencyCQI[n]
· 100 %
(15.17)

15
Advanced System Level Applications
349
where NRB is a number of resource blocks, NRE denotes number of recourse elements
per resource block and EfﬁciencyCQI[n] is the efﬁciency of the Channel Quality Indi-
cator (CQI) (in bits per resource element) chosen for the transmission of MBMS data.
With (15.17) we can calculate the number of subframes to be reserved for MBMS
data transmissions.
15.2.3
CQI Adaptation
In our simulations, irrespective whether rate adaptation was applied, we reserve the
same number of subframes for MBMS data, calculated with (15.17). However, for
rate adaptation the real amount of used subframes could be reduced and unused
MBMS subframes can instantaneously be reassigned for ordinary trafﬁc, which may
not be feasible in practice. The CQIs of all users in the MBSFN area are calculated
according to proposed in [24] technique and stored in the vector CQI. From the vector
CQI we choose the smallest CQI index for transmission, in order to support all users.
During our research we found that using the smallest CQI index for transmission
can cause trafﬁc congestions and we should specify some lower bound (CQIbound) to
assure that the generated MBMS trafﬁc can be sustained by the network. Therefore
the CQI index at time n to be used for transmission can be calculated as
CQIn = max(min
i (CQI[i]), CQIbound).
(15.18)
15.2.4
Performance Evaluation
In this subsection we provide comparison of the performance of MBSFN trans-
mission with standard unicast transmission in terms of Packet Loss Ratio (PLR),
latency, network utilization and standard unicast user throughput. All results are
based on [25, 26]. According to Fig.15.7 we observe that transmission with low
transmission rate (4QAM with strong forward-error-correction coding) is necessary
to achieve sufﬁcient reliability and that the network overhead for distribution of
Cooperative Awareness Messages (CAMs) is substantially reduced when employ-
ing MBSFN transmission instead of unicasting. Appropriate results on cell resource
utilization are depicted in Table15.2, simulation parameters in Table15.3.
In Fig.15.8 we compare the CDF of mean latencies for unicast and multicast
transmissions of CAMs. We observe signiﬁcant advantages of multicast transmis-
sions comparing to the unicast case in terms of latency which is even more remarkable
in terms of throughput of standard unicast users in Fig.15.7. Such throughput reduc-
tion in case of unicasting is explained by resource consumption: transmission of
CAMs via unicasting consumes 99.95% of cell resources, while multicasting con-
sumes 60%. Hence we present mainly the behaviour of multicast transmissions in
the MBSFN area (Table15.3).

350
M. Müller and I. Saﬁulin
Fig. 15.7 Comparison of the
throughput of ordinary users
in case of unicast and
multicast transmission
0
1
2
3
4
5
6
7
8
9
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
User throughput [Mbit/s]
Cumulative probability
Uni.,CQI 9
Mult.,CQI 9
Uni.,CQI 6
Mult.,CQI 6
Mult.,CQI 3
Uni.,CQI 3
Table 15.2 Comparison of
utilized resources
Unicast (%)
Multicast (%)
CQI 3
99.95
60
CQI 6
52
19
CQI 9
26
8
Fig. 15.8 Comparison of
CDF of mean latency for
unicasting and multicasting
of CAMs at 5MHz
bandwidth and transmission
with CQI3
10
0
10
1
10
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Cumulative probability
Latency[ms]
CDF of mean latency,unicast
CDF of meanlatency,multicast
15.2.5
Bandwidth Scaling
In Fig.15.9a, b we compare the latency of multicast CAM transmission for both
considered system bandwidths of 5 and 20MHz and transmission with CQI3 (efﬁ-
ciency is 0.377). With 5MHz bandwidth we have to reserve six subframes per radio-
frame for MBMS transmission. However, if not all of them are required, we reassign

15
Advanced System Level Applications
351
Table 15.3 Simulation parameters
Parameter
Value
Center frequency
2.14GHz
System bandwidth
5, 20MHz
Channel
ITU-T VehA [10]
Number of base stations in MBSFN
7
Number of users per base station
6
Number of car users per base station
3
Speed of car users
100km/h
Transmission
Unicast/multicast
Packet size to be transmitted
300bytes
Packet generation rate (T)
10Hz
Transmission rate
Rate adaptation/ﬁxed rate for car users
Rate adaptation for ordinary unicast users
Antenna conﬁguration
1 × 1
10
1
10
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Latency [ms]
Cumulative probability
Combined latency CDF
CDF of mean latency
Latency of individual users
10
0
10
1
10
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Latency [ms]
Cumulative probability
Combined latency CDF
CDF of mean latency
Latency of individual users
Combined latency CDF
CDF of mean latency
Latency of individual users
(a)
(b)
Fig. 15.9 Comparison of CDF of latency for multicast transmission with 5 and 20MHz bandwidth.
a Transmission with 5MHz bandwidth. b Transmission with 20MHz bandwidth
unused MBMS subframes for unicast transmission. With 20MHz bandwidth, two
subframes are sufﬁcient. The corresponding mean values of main parameters are pro-
vided in Table15.4. Given the multicast network utilization values from Table15.4,
the expected throughput improvement is:
R20
R5
= (1 −0.157) · 100
(1 −0.52) · 25
= 7.03
where R20 and R5 are the number of resource blocks utilized for serving ordinary
users at 20 and 5MHz bandwidth. According the Table15.4, the observed improve-
ment equals 7.08. Hence, the throughput values scale very well with the bandwidth,
provided the network utilization is considered. Considering transmissions with rate

352
M. Müller and I. Saﬁulin
Table 15.4 Summary of performance results with 5 and 20MHz bandwidth and transmission with
CQI3
Bandwidth (MHz)
Mean latency (TTI)
Mean throughput
(Mbit/s)
Utilization (%)
5
14.7
0.72
52
20
8
5.1
15.7
10
0
10
1
10
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Latency [ms]
Cumulative probability
Combined latency CDF
CDF of mean latency
Latency of individual use
Combined latency CDF
CDF of mean latency
Latency of individual users
10
0
10
1
10
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Latency [ms]
Cumulative probability
Combined latency CDF
CDF of mean latency
Latency of individual users
(a)
(b)
Fig. 15.10 Comparison of CDF of latency for multicast transmission with 5MHz with and without
CQI lower bound. a No CQI lower bound. b CQI lower bound of three
Table 15.5 Performance results for ﬁxed CQI and adaptive CQI transmission with 5MHz band-
width
Transmission rate
Mean latency (TTI)
Mean throughput
(Mbit/s)
Utilization (%)
CQI3
14.7
0.72
52
Adaptive
11.9
0.83
43
adaptation for multicast users, at ﬁrst, we investigate how the performance changes
if we do not apply a lower bound for the CQI, i.e., if we simply take the minimum
CQI of all users even if we cannot sustain the trafﬁc in this way. This is shown in
Fig.15.10a. Then we perform rate adaptation with the lower bound of CQI3. The
corresponding results are illustrated in Fig.15.10b and summarized in Table15.4. We
observe an improvement in the mean latency by a few Transmission Time Intervals
(TTIs) with rate adaptation, which can be explained by the fact that we now require
less Resource Blocks (RBs) for transmission in case the CQI of all users is high
(exploiting channel diversity). This can also be seen in the average network utiliza-
tion for multicast transmission, which reduces by almost 10%. Correspondingly, the
mean throughput of ordinary users improves from 0.72 to 0.83Mbit/s (Table15.5).

15
Advanced System Level Applications
353
15.2.6
Conclusion
The introduction of MBSFN, however, also causes some new difﬁculties in the
cellular network. As now many base stations broadcast the same signal in time and
frequency, the overall signal delay can considerably increase and thus the cyclic pre-
ﬁx may not be of sufﬁcient length any more. The straightforward solution proposed
by 3GPP is to employ an extended cyclic preﬁx to avoid inter-symbol-interference,
which is mandatory in LTE MBSFN transmission. Yet, this approach can be very
inefﬁcient especially at low Signal to Noise Ratio (SNR), since it sacriﬁces available
resources. With the expected introduction of multi-antenna MBMS/MBSFN trans-
mission in future releases of LTE, sophisticated beamforming/precoding schemes can
be applied to optimize the efﬁciency of the network. Since the achievable transmis-
sion rate of multicasting is determined by the weakest user, well-known Coordinated
Multi-Point (CoMP) transmission schemes for unicast situations do not perform well
in multicast scenarios. We thus extended CoMP transmission in [27, 28] to multicast
scenarios employing an interference-leakage control based distributed coordination
algorithm. The method achieves substantial performance gains over other techniques;
implementation complexity, however, can be an issue in practical realizations, since it
involves iteratively solving complex optimization problems. Hence, we also provide
some simple heuristic schemes in [28] that achieve a reasonable trade-off between
performance and complexity.
References
1. Shift2rail: driving innovation on railways, European Commission (2014) [Online]. http://www.
shift2rail.org
2. B. Ai, K. Guan, M. Rupp, T. Kürner, X. Cheng, X.-F. Yin, Q. Wang, G.-Y. Ma, Y. Li, L. Xiong,
J.-W. Ding, Future railway services oriented mobile communications network. IEEE Commun.
Mag. 53, 78–85 (2015)
3. M.K. Müller, M. Taranetz, M. Rupp, Performance of remote unit collaboration schemes in high
speed train scenarios, in Proceedings of the 82nd Vehicular Technology Conference (VTC2015-
Fall), Boston (2015)
4. Y. Zhou, Z. Pan, J. Hu, J. Shi, X. Mo, Broadband wireless communications on high speed
trains, in 20th Annual Wireless and Optical Communications Conference (WOCC) (2011).
doi:10.1109/WOCC.2011.5872303
5. J.-Y. Zhang, Z.-H. Tan, Z. dui Zhong, Y. Kong, A multi-mode multi-band and multi-system-
basedaccessarchitectureforhigh-speedrailways,IEEE72ndVehicularTechnologyConference
Fall (VTC 2010-Fall), 2010 (2010), pp. 1–5. doi:10.1109/VETECF.2010.5594223
6. M.K. Müller, M. Taranetz, M. Rupp, Providing current and future cellular services to high
speed trains. IEEE Commun. Mag. 53, 96–101 (2015)
7. R.W. Heath, M. Kountouris, T. Bai, Modeling heterogeneous network interference using Pois-
son point processes. IEEE Trans. Signal Process. 61(16), 4114–4126 (2013)
8. C.A. Coelho, The generalized integer gamma distribution - a basis for distributions in multi-
variate statistics. J. Multivar. Anal. 64(1), 86–102 (1998). doi:10.1006/jmva.1997.1710
9. 3rd Generation Partnership Project (3GPP), Evolved universal terrestrial radio access
(E-UTRA); radio frequency (RF) system scenarios, TR 36.942 (2014)

354
M. Müller and I. Saﬁulin
10. ITU, Recommendation ITU-R M.1225: Guidelines for Evaluation of Radio Transmission Tech-
nologies for IMT-2000, ITU, Technical report (1997)
11. Y. Qiu, H. Liu, P. Fan, Capacity enhancement using cooperative distributed antenna system
under LOS MIMO channels in high speed train scenario, in The Sixth International Workshop
on Signal Design and its Applications in Communications (2013), pp. 103–106. doi:10.1109/
IWSDA.2013.6849073
12. M. Uhlirz, Adapting GSM for use in high-speed railway networks, Ph.D. dissertation, Institute
für Nachrichtentechnik und Hochfrequenztechnik, Technische Universität Wien (1995)
13. C. Li, B. Li, An analysis on high speed train coverage solutions. Commun. World 33 (2008)
14. 3GPP, TSG RAN; introduction of the multimedia broadcast multicast service (mbms) in the
radio access network (ran); stage 2 (release 6) (2006), http://www.3gpp.org/DynaReport/
25346.htm
15. Ericsson, LTE broadcast: a revenue enabler in the mobile media era, Feb 2013, white paper
16. Valter D’Avino (Ericsson), Ericsson and Polkomtel test LTE broadcast in Poland, 1 (2014),
press release
17. Deby Lewis (Verizon), Verizon delivers LTE multicast over commercial 4G LTE network in
Indy, 21 May 2014, press release
18. Bill Smith (AT&T), AT&T LTE broadcast demo at college football national championship
showcases exciting network future, 16 Jan 2015, press release
19. T. Lohmar, M. Slssingar, S. Puustinen, V. Kenehan, Delivering content with LTE broadcast.
Ericsson Rev.: Commun. Technol. J. Since 1924 2013(1) (2013)
20. D. Valerio, F. Ricciato, P. Belanovic, T. Zemen, UMTS on the road: broadcasting intelligent
road safety information via MBMS, in 67th IEEE Vehicular Technology Conference (VTC2008-
Spring) (2008), pp. 3026–3030
21. ETSI Standard ES 202 663 V1.1.0, Intelligent transport systems (ITS); European proﬁle stan-
dard for the physical and medium access control layer of Intelligent Transport Systems oper-
ating in the 5 GHz frequency band (2010)
22. I. Saﬁulin, S. Schwarz, M. Rupp, System level simulation of LTE MBSFN networks with high
mobility users, in IWSSIP Conference, London (2015)
23. ETSI TS 102 637–2 V1.2.1, Intelligent transport systems (ITS); vehicular communications;
basic set of applications; part 2: speciﬁcation of cooperative awareness basic service (2011)
24. S. Schwarz, M. Rupp, Throughput maximizing feedback for MIMO OFDM based wireless
communication systems, in IEEE International Workshop Signal Processing Advances in Wire-
less Communications (SPAWC) (IEEE, San Francisco, 2011), pp. 316–320
25. I. Saﬁulin, S. Schwarz, M. Rupp, System level simulation of LTE MBSFN networks with high
mobility users, in 2015 International Conference on Systems, Signals and Image Processing
(IWSSIP), London (2015), pp. 21–24
26. I. Saﬁulin, S. Schwarz, T. Philosof, M. Rupp, Latency investigation of LTE MBSFN transmis-
sion for vehicular communications, in submitted (2015)
27. S. Schwarz, T. Philosof, M. Rupp, Leakage-based multicast transmit beamforming, in Pro-
ceedings of the IEEE International Conference on Communications (ICC’15), London (2015)
28. S. Schwarz, M. Rupp, Transmit optimization for the MISO multicast interference channel.
IEEE Trans. Commun. 63, 4936–4949 (2015)

Index
A
Achievable rate, 99, 120, 122, 150, 154, 155,
163, 166
Adaptive modulation and coding, 87, 95
Aggregate co-channel interference, 252
Aggregate interference analysis, 298
Antenna Combining, 145
Antenna combining, 144, 146
Antenna selection, 100
B
Base station collaboration schemes, 285
BICM, 22, 29, 34, 86, 87, 89, 96, 99, 192,
228
Block-diagonalization precoding, 117, 118,
144, 171
Boolean scheme, 301
Building density, 298
Building objects, 298
C
CAMs, 346
Capacity, 22, 29, 89, 96, 211, 228
Channel estimation, 62, 64, 65, 67, 69, 193
Channel model, 236, 241, 245
Channel quality indicator, 98, 104, 108, 143,
165
Channel state information, 85, 93, 120, 122,
125, 131, 144, 170
Chordal distance, 91, 120, 123, 131, 136,
151, 161–163, 165, 166, 169
Clarke’s model, 106, 136
Close subscriber group, 321
Cluster process, 321
Clustering, 93, 101, 116, 123, 159, 161, 166,
169, 171
Codebook,91,93,95,98,100,108,120,124,
129, 131, 159
Coherence bandwidth, 110, 116, 169, 171
Coherence time, 106, 116, 137
CoMP schemes, 287, 337, 341, 353
Coverage probability, 304, 305, 311
Cyclic preﬁx, 5, 23, 39, 217, 353
D
Degrees of freedom, 116, 130, 151, 153, 156
Distortion, 124, 145, 151, 155
Distributed antenna system, 122, 124, 138
Dual-slope model, 322
E
EESM, 229
EMBMS, 345–347, 349, 351, 353
Equalization, 90, 92
ESM, 229
Exclusion guard regions, 301
Exclusion regions, 298
F
Feedback, 85, 93, 95, 104, 120, 122, 132,
165, 169
Femtocell base stations, 319
Femtocell deployment density, 319
Femtocell isolation, 319
G
Gamma distribution, 252, 257, 261, 264,
267, 269, 278, 338
Geodesic, 127, 134, 160, 161
Grassmann manifold, 120, 122, 124, 133
© Springer Science+Business Media Singapore 2016
M. Rupp et al., The Vienna LTE-Advanced Simulators,
Signals and Communication Technology, DOI 10.1007/978-981-10-0617-3
355

356
Index
H
Hexagonal grid, 251
I
ICI modeling, 8, 11, 12, 22, 29, 39, 63, 64,
216, 218, 219
Interference analysis, 252
Interference coordination, 288
Interference modeling, 251–254, 256–258,
261–264, 273, 274
Interference statistics, 257
Interpolation, 116, 123, 160, 169, 170
Inverse Wishart distribution, 130
L
Large-scale parameters, 236
Latency, 347
Limited feedback, 85, 93, 95, 104, 120, 122,
152, 165
Line-of-sight probability, 308
Link Abstraction model, 229
Link adaptation, 87
Link-to-system-mapping, 229
LTE basics, 14–16, 18, 88
M
Mapping points, 275
Mapping Procedure, 280
Maximum eigenmode transmission, 144,
153, 155, 173
MCS, 14, 31, 34, 75, 86, 95, 99, 177, 185,
189, 209, 210, 217, 218, 229
MIESM, 96, 97, 229
MLE, 268
Monte Carlo simulations, 306
Multi-user MIMO, 115, 117, 125, 144, 171
N
Network utilization, 348
Normalized Doppler frequency, 107, 136
Normalized ergodic rate, 298, 307
O
Occupation probability, 298
OFDM basics, 3, 5, 7–10, 19, 20, 178
Open subscriber group, 321
P
PAPR, 9, 177, 182, 186
Pilots, 23, 62, 123, 191, 192
Poisson point process, 274, 299, 300, 303
Post-equalization SINR, 19, 27, 32, 96, 165,
178
Post-spreading SINR, 180
Power allocation, 69, 90, 92, 119
Power proﬁle, 275
Precoding, 90, 91, 117, 119
Precoding matrix indicator, 95, 98, 105, 108
Prediction, 108, 123, 125, 126, 133, 134,
169, 171
Projection, 128, 131
Q
Quantization, 91, 95, 120, 123, 125, 131,
136, 169, 171
Quantization based combining, 144, 145
R
Random object process, 299
Random shape theory, 298, 299
Random vector quantization, 124, 139, 145,
149, 159
Rank indicator, 95, 98, 105
Rate gap, 145
Rayleigh fading, 87, 126, 145, 149, 153
Remote radio head/unit, 100
Runtime precoding, 231, 233, 236
Runtime-precoding, 232
S
Scheduling, 87, 95, 101, 108, 116, 167, 174
SCM, 236
Semi-orthogonal user selection, 160, 168,
174
Shadowing, 297, 313
Single-user MIMO, 85, 89
Singular value decomposition, 90, 119, 128,
153
SINR, 291
Slivnyak’s theorem, 301
Small cell base station, 298
Small-scale parameters, 236
Spectral efﬁciency, 29, 32, 34, 42, 58, 88,
229, 291, 293, 324, 338, 339
Stochastic geometry, 297
Subspace, 120, 124, 149, 153, 161
Subspace quantization based combining,
144, 146, 148, 155, 162, 171, 173
Sum of Gamma random variables, 278
System-level simulation tools, 227

Index
357
T
Tangent, 125, 127, 131, 134, 161
Tangent space, 125, 127, 135
Transmitter cooperation, 288
Two-tier heterogeneous cellular networks,
319
Typical femto UE, 330
U
Urban environment topologies, 298
User Association, 301
User cluster, 321
User-centric, 285
User-centric interference environment, 298
V
Virtual building approximation, 298, 303
W
Wall penetration loss, 298, 321
Water-ﬁlling, 90, 92, 119
Wideband-SINR, 327
Wishart distribution, 130, 149, 156, 188
Z
Zero-forcing beamforming, 117, 119, 144

