Power Systems
Kyo-Beum Lee
June-Seok Lee
Reliability 
Improvement 
Technology for 
Power Converters

Power Systems

More information about this series at http://www.springer.com/series/4622

Kyo-Beum Lee
• June-Seok Lee
Reliability Improvement
Technology for Power
Converters
123

Kyo-Beum Lee
Department of Electrical and Computer
Engineering
Ajou University
Suwon
Korea (Republic of)
June-Seok Lee
Korea Railroad Research Institute (KRRI)
Uiwang-si
Korea (Republic of)
ISSN 1612-1287
ISSN 1860-4676
(electronic)
Power Systems
ISBN 978-981-10-4991-0
ISBN 978-981-10-4992-7
(eBook)
DOI 10.1007/978-981-10-4992-7
Library of Congress Control Number: 2017943172
© Springer Nature Singapore Pte Ltd. 2017
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or
dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt
from the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained herein or
for any errors or omissions that may have been made. The publisher remains neutral with regard to
jurisdictional claims in published maps and institutional afﬁliations.
Printed on acid-free paper
This Springer imprint is published by Springer Nature
The registered company is Springer Nature Singapore Pte Ltd.
The registered company address is: 152 Beach Road, #21-01/04 Gateway East, Singapore 189721, Singapore

Preface
Power electronics technology, which was used only for motor drives in the past, is
currently being used in numerous industries including renewable energy in
household appliances, automobiles, and energy storage devices. This change is due
in part to the increased interest in improving the efﬁciency of electronic and electric
devices. The main reason is that research on power electronics has been carried out
in many universities and research institutes, and researchers equipped with skills in
the ﬁeld of power electronics have been exported across the industry. Based on this,
it can be said that the power electronics technology related to low- and
medium-capacity systems has matured considerably. The existing power electronics
technology has evolved into a highly reliable technology based on the development
experiences and know-how of researchers. However, due to recent increases in
energy demand within the industry, high-pressure/high-capacity systems are
required. As a result, new power electronics topologies are being developed and
studied. There are two highly representative research areas in the ﬁeld of multilevel
converters. Multilevel converters, mainly in Europe and China, have been applied
to high-voltage/high-capacity wind power generation systems, and related research
is being actively conducted. In addition, the development of HVDC (high-voltage
DC) transmission systems is also a representative ﬁeld in terms of the application of
multilevel converters. This book includes the basic introduction of the most widely
studied and used multilevel converter topologies, and it introduces the most reliable
three-level converter technology, which is the most similar to a two-level converter.
In addition, this book introduces reliable technology for cascaded H-bridge
inverters in the last chapter. Three-level converters and cascaded H-bridge inverters
have been applied to high-voltage systems mainly due to the advantages of mul-
tilevel converters. The cascaded H-bridge converter is expanding its application
range to high-power and high-voltage systems. However, three-level converters
have recently been used in low voltage/medium capacity systems and have been
expanding their applications as well. Two-level converters, which have been
studied in the ﬁeld of motor drives in the past, are typical topologies with high
reliability based on accumulated technology. On the other hand, although
three-level converters and cascaded H-bridge inverter have been applied in the past.
v

However, since the ﬁeld is narrow and there are not many cases, their
reliability-related technology is lacking. This book introduces the concept of
multilevel converters and basic knowledge of three-level converters and cascaded
H-bridge converter to students that want to study multilevel converters as well as
power electronics engineers who want to apply three-level converters and cascaded
H-bridge inverter to their ﬁeld. They will also be introduced to techniques for
dealing with a variety of reliability-related issues.
Suwon, Korea (Republic of)
Kyo-Beum Lee
Uiwang-si, Korea (Republic of)
June-Seok Lee
vi
Preface

Contents
1
Three-Level Converter Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Three-Level Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.2
Three-Level Converter Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.2.1
NPC (Neutral-Point Clamped) Converter . . . . . . . . . . . . . .
5
1.2.2
T-Type Three-Level Converter . . . . . . . . . . . . . . . . . . . . . .
6
1.2.3
Comparison Between Two-Level Converter
and NPC/T-Type Three-Level Converters . . . . . . . . . . . . . .
8
1.3
Three-Level Converter Operation Principle. . . . . . . . . . . . . . . . . . .
9
1.3.1
I/O Characteristics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.3.2
Output Voltage of Three-Leg Three-Level Inverters . . . . . .
11
1.3.3
Space Vector PWM (SVPWM). . . . . . . . . . . . . . . . . . . . . .
12
1.3.4
Carrier-Based PWM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
1.3.5
Neutral-Point Voltage Fluctuation . . . . . . . . . . . . . . . . . . . .
19
1.4
Three-Level Converter Reliability Research Field. . . . . . . . . . . . . .
20
1.4.1
Fault Diagnosis and Tolerance Control of Three-Level
Converters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
1.4.2
Neutral-Point Voltage Ripple Reduction . . . . . . . . . . . . . . .
21
1.4.3
Leakage Current Reduction. . . . . . . . . . . . . . . . . . . . . . . . .
23
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
2
Open-Circuit Fault Detection Methods for Three-Level
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.1
Switch Fault Case and Reasons . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.2
Switch Open-Circuit Fault Detection Methods
for NPC Three-Level Inverters . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.2.1
Switch Open-Circuit Fault Detection Methods
Using Additional Devices . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.2.2
Switch Open-Circuit Fault Detection Method
Using Current Distortion. . . . . . . . . . . . . . . . . . . . . . . . . . .
31
vii

2.3
Switch Open-Circuit Fault Detection Methods
for NPC Three-Level Rectiﬁers . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
2.3.1
Switch Open-Circuit Fault Detection Method Using
Additional Devices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
2.3.2
Switch Open-Circuit Fault Detection Method Using
Current Distortion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
2.4
Switch Open-Circuit Fault Detection Method for T-Type
Three-Level Inverter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
2.4.1
Switch Open-Circuit Fault Detection Method
Using Current Distortion. . . . . . . . . . . . . . . . . . . . . . . . . . .
55
2.5
Switch Open-Circuit Fault Detection Method for T-Type
Three-Level Rectiﬁers. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
2.5.1
Switch Open-Circuit Fault Detection Method
Using Current Distortion. . . . . . . . . . . . . . . . . . . . . . . . . . .
64
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
3
Three-Level Converter Tolerant Control for Switch Faults . . . . . . . .
75
3.1
Three-Level Converter Tolerant Control in Topology
Modiﬁcations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
3.1.1
Tolerant Control with Six Thyristors. . . . . . . . . . . . . . . . . .
76
3.1.2
Tolerant Control with an Additional Leg
and Thyristors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
3.1.3
Tolerant Control with Six Additional Switches . . . . . . . . . .
78
3.1.4
Other Tolerant Control Topologies . . . . . . . . . . . . . . . . . . .
79
3.2
Three-Level Converter Tolerant Control Using Modiﬁcations
of the Switching Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
3.2.1
Open-Circuit Faults in NPC Three-Level
and T-Type Three-Level Converters . . . . . . . . . . . . . . . . . .
81
3.2.2
Tolerant Control for Sx2 and Sx3 Open-Circuit Faults . . . . .
82
3.2.3
Tolerant Control for Sx1 and Sx4 Open-Circuit Fault. . . . . .
109
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
137
4
Neutral-Point Voltage Reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
139
4.1
Neutral-Point Voltage of Three-Level Converters. . . . . . . . . . . . . .
139
4.2
Neutral-Point AC Ripple Voltage Reduction Methods . . . . . . . . . .
144
4.2.1
Dwell Time Compensation for Neutral-Point Voltage
Reduction in the Carrier Based PWM Method . . . . . . . . . .
144
4.2.2
Dwell Time Compensation for Neutral-Point Voltage
Reduction in SVPWM Method . . . . . . . . . . . . . . . . . . . . . .
154
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
176
viii
Contents

5
Leakage Current Reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
179
5.1
Leakage Current Analysis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
179
5.1.1
Main Reason for Leakage Current . . . . . . . . . . . . . . . . . . .
179
5.1.2
Leakage Current Reduction Methods in H-Bridge
and Two-Level Converters . . . . . . . . . . . . . . . . . . . . . . . . .
180
5.1.3
Three-Level Converters. . . . . . . . . . . . . . . . . . . . . . . . . . . .
182
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
204
6
Switch Fault Diagnosis and Tolerant Control in Cascaded
H-Bridge Multilevel Inverters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
207
6.1
Cascaded H-Bridge Multilevel Inverters . . . . . . . . . . . . . . . . . . . . .
208
6.1.1
Conﬁguration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
208
6.1.2
PWM Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
211
6.2
Fault Diagnosis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
213
6.2.1
Fault Diagnosis Using Additional Devices . . . . . . . . . . . . .
213
6.2.2
Fault Diagnosis Using Currents. . . . . . . . . . . . . . . . . . . . . .
215
6.3
Fault Tolerant Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
232
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
250
Contents
ix

Chapter 1
Three-Level Converter Overview
1.1
Three-Level Converters
The development of power electronics coincides with the development of power
semiconductor devices. Since the use of AC motors has increased since the 1980s,
power conversion devices composed of power semiconductor devices have been
steadily developed. In the early 2000s, there was a large increase in renewable
energy industries such as wind power generation and photovoltaic power genera-
tion, which require connections with AC systems. This has widened the application
ﬁelds of the power conversion apparatuses used only in existing AC motors.
In accordance with the demands of industry, power semiconductor devices have
been continuously increased in terms of pressure and capacity. As a result, various
power conversion topologies have been proposed. The most basic method among
the proposed power conversion topologies is to connect a switching device in series
and operate the converter at a high voltage as shown in Fig. 1.1a. Another method
is to implement a new topology of the multi-level converter type such as Fig. 1.1b.
When a switching device is connected in series to increase the voltage and capacity
of a converter, the operation of the converter is the same as that of a two-level
converter, and synchronization of the on-off operation of the switching elements
connected in series is required. The multi-level converters produce output voltages
with multiple levels by properly operating each of the switching elements. The
output voltage with multiple levels has a smaller total harmonic distortion
(THD) than a converter implemented by series-connected switching devices. This is
advantageous in reducing ﬁlter size in grid-connected voltage converters and in
reducing noise in converters driving an AC motor.
Multilevel converters are divided into Cascaded H-bridge converters, Flying
Capacitor converters, and Neutral-Point-Clamped (NPC) converters as shown in
Figs. 1.1 and 1.2 [1–3]. Of these, the NPC converters were ﬁrst developed by Nabae
in 1981. The NPC three-level converter is one of the most actively studied type of
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_1
1

multi-level converter, and NPC three-level converter-based power converters have
been applied to many products. Meanwhile, NPC four-level or higher level con-
verters are not practical.
Sx1
Sx2
Sx3
Sx4
S1a
S2a
S3a
S4a
S1a
S2a
S3a
S4a
S1a
S2a
S3a
S4a
Vo
Vo
Cdc
Vdc
C1
Vdc
C2
Vdc
C3
Vdc
Fig. 1.1 High voltage and high capacity system using, a series connection method of switches
(L), cascaded H-bridge topology (R)
S1a
S2a
S3a
S4a
S4b
S3b
S2b
S1b
Vo
Vdc
C1
C2
C3
C4
C1a
C2a
C2a
C3a
C3a
C3a
Sa1
Sa2
Sa3
Sa4
Sb1
Sb2
Sb3
Sb4
Vdc
C1
C2
C3
C4
Vo
Fig. 1.2 Flying capacitor converter (L), NPC converter (R)
2
1
Three-Level Converter Overview

ABB’s ACS1000 which is shown in Fig. 1.3 is a NPC three-level converter that
can drive up to 4 kV/2 MW and uses an Integrated Gate Commutated Thyristor
(IGCT) switching device. In 2012, Samsung Heavy Industries (Korea) developed a
power conversion system based on a NPC three-level converter for 3.3 kV/7 MW
offshore wind power generation as a national support project. As can be seen from
the capacity of these commercial products, multi-level converters have been suit-
able for high-voltage and large-capacity power converters. However, recently they
are also applied to small-capacity products with high performance requirements
such as low total voltage harmonic distortion (THD) and high efﬁciency [4–7].
A typical product is the SUNNY TRIPOWER 12000TL 12 kW power converter
shown in Fig. 1.4 for solar power generation system which was launched by SMA.
Fig. 1.3 ABB 4 kV/2 MW NPC Three-Level Converter (ACS 1000)
Fig. 1.4 Power converter for photovoltaic power generation system using a SMA’s NPC
three-level converter (SUNNY TRIPOWER 12000TL)
1.1
Three-Level Converters
3

Since the application of three-level converters has expanded, Inﬁneon, Semikron,
and Vincotech, which are known worldwide as switching device and module
manufacturers, have released and sold speciﬁc modules for three-level converter as
shown in Fig. 1.5. The recently introduced modules for three-level converter are
mainly composed of switching devices with rated voltage of 600 V, and the rated
capacity is steadily decreasing. In recent years, three-level converters have been
adopted based on the advantages mentioned above in various industrial ﬁelds where
two-level converters were mainly used. As a result, many control technologies
related to three-level converters have been developed, which are generalized for
immediate application in the industry.
Fig. 1.5 Productized three-level converter module (as of 2015): Inﬁneon Inc. FS3L50R07W2H3F
(650V/50A), Semikron Inc. SK20MLI066 (600V/50A), Vincotech Inc. 10-FZ06NRA099FS
(600V/18A)
4
1
Three-Level Converter Overview

It is clear that three-level converters are complicated in terms of structure and
control compared to a two-level converter because the three-level converters consist
of switches more than the two-level converter. Therefore, it is necessary to take
measures to improve the reliability of the power conversion systems, which are
increasingly complicated.
1.2
Three-Level Converter Types
Three-level converters include the NPC three-level converter and the T-type
three-level converter mentioned above. Both of these topologies differ in terms of
their structure, several performances, and design procedure. The following com-
parison between these topologies is based on a three-phase system.
1.2.1
NPC (Neutral-Point Clamped) Converter
The NPC three-level converter is structurally composed of 12 switches and 6
clamping diodes as shown in Fig. 1.6. The dc capacitor is divided into two parts,
and the midpoint between the upper and lower parts is called the neutral-point. The
six diodes are clamping diodes that connect the output of each leg of the converter
to the neutral-point.
The NPC three-level converter is based on a series connection of four switches in
each leg. Compared with a two-level converter, the rated-voltage of the used switch
can be reduced by half, making it suitable for a high voltage and large capacity
system.
C1
C2
Z
D1
D2
Sa1
Sa2
Sa3
Sa4
D3
D4
D5
D6
Sb1
Sb2
Sb3
Sb4
Sc1
Sc2
Sc3
Sc4
Fig. 1.6 NPC three-level converter
1.1
Three-Level Converters
5

1.2.2
T-Type Three-Level Converter
T-type three-level converter is also called ANPC (Advanced NPC) three-level
converter. Like the NPC three-level converter, the T-type three-level converter has
two capacitors divided into upper and lower parts, and its consists of a total of 12
switches as shown in Fig. 1.7. In a T-type three-level converter, a bidirectional
switch connected to the neutral-point or two switches connected in series is used to
connect the neutral-point of the converter to the output of each leg.
T-type three-level converter is structurally similar to the conventional two-level
converter. The rated-voltage of the switches Sx1 and Sx4 is designed to be equal to
the rate-voltage of the switches used in two-level converter. On the other hand, the
switches Sx2 and Sx3 which are connected to neutral-point have the rated-voltage
which is half of the switches Sx1 and Sx4. The T-type three-level converter has a
disadvantage that it is difﬁcult to apply T-type three-level converter to high-voltage,
high-capacity power conversion sytem since the rated-voltage of the external
switches Sx1 and Sx4 is not low and is the same as the two-level converter, unlike
that of the NPC three-level converter. However, in a ﬁeld that is relatively sensitive
to the addition of switching elements, T-type three-level converter that does not use
a clamping diode is advantageous.
In addition, the T-type three-level converter achieves a higher power conversion
efﬁciency than the NPC three-level converter by using SiC (Silicon Carbide)
switches and diodes as shown in Fig. 1.8. The efﬁciency is improved because the
switching loss of a SiC switch is smaller than that of a Si (silicon) switch, and the
on-voltage of a SiC diode is smaller than that of an IGBT (Insulated Gate Bipolar
Transistor) as shown in Fig. 1.9 [8].
Z
C2
C1
Da1
Da2
Sa2
Sa1
Sa3
Sa4
Da3
Db2
Sb2
Sb3
Db3
Dc2
Sc2
Sc3
Dc3
Da4
Sb4
Db4
Sc4
Dc4
Db1
Sb1
Dc1
Sc1
Fig. 1.7 T-type three-level converter
6
1
Three-Level Converter Overview

Fig. 1.8 SiC T-type
three-level converter module
with a diodes to switch
Fig. 1.9 SiC device
characteristics
1.2
Three-Level Converter Types
7

1.2.3
Comparison Between Two-Level Converter
and NPC/T-Type Three-Level Converters
In order to analyze the efﬁciency of two-level converter and NPC/T-type three-level
converters, Inﬁneon switch characteristics are used.
– Two-level converter: Inﬁneon IKW25T120 (1200 V)
– NPC three-level converter: Inﬁneon IKW30N60T (600 V)
– T-type three-level converter: External switch Inﬁneon IKW25T120 (1200 V).
Internal switch Inﬁneon Corporation IKW30N60T (600 V). Converter operating
conditions: DC stage (700 V), three-phase output voltage (325 V), and output
current (20.5 A).
(a) Switching frequency 32 kHz: inverter mode loss of a two-level converter (L), rectifier mode loss (R)
(b) Switching frequency 48 kHz: inverter mode loss of a NPC three-level converter (L), rectifier mode
     loss (R) 
(c) Switching frequency 32 kHz: inverter mode loss of  a T-type three-level converter (L), rectifier
mode loss (R) 
Fig. 1.10 Loss comparison between two-level and three-level converters (reprinted from [9],
Fig. 5)
8
1
Three-Level Converter Overview

In order to compare the efﬁciency, the switching loss and conduction loss for
each of the switches are considered and a loss analysis is performed in the inverter
mode and rectiﬁer mode according to the operation of the converter and the analysis
results are shown in Fig. 1.10. When operating in the inverter mode in a two-level
converter, the loss generated by the switch is larger than that of the diode; and when
operating in the rectiﬁer mode, the loss occurring in the diode is larger than that of
the switch. The losses in the inverter mode in the NPC three-level converter and
T-type three-level converter are also greater than those generated by the diode in the
switch. In addition, the reverse loss in the rectiﬁer mode is large. T-type three-level
converter has no associated losses due to the absence of a clamping diode.
However, since the external switches T1 and T4 of the T-type three-level converter
have twice the rated voltage compared with the rated voltages of the external
switches T1 and T4 of the NPC three-level converter, the efﬁciency improvement
caused by absence of clamping diodes is mitigated. The efﬁciency values of the
NPC three-level converter and the T-type three-level converter are different
depending on the switching frequency. The efﬁciency of the T-type three-level
converter is better when the switching frequency is operated at 20 kHz or more.
1.3
Three-Level Converter Operation Principle
The operation principles of the NPC three-level converter and the T-type three-level
converter are the same. When the gate signal input to the switch of the NPC
three-level converter can be used as the gate signal of the switch of the T-type
three-level converter. In this chapter, the operation principle of three-level con-
verters is explained based on the NPC three-level converter.
1.3.1
I/O Characteristics
The input-output characteristics of a three-level converter can be found by com-
paring the input-output characteristics of a two-level converter. In Fig. 1.11, the
input voltage of the two-level converter refers to the DC voltage (Vdc), and the
output voltage (Vxz) has a value of Vdc/2 or −Vdc/2 depending on the switching state
as shown in Fig. 1.11a. The input voltage of the three-level converter refers to the
same DC voltage (Vdc) as the two-level converter. Since the three-level converter
has a switching state connected to the neutral point, an output voltage of Vdc/2, 0 or
−Vdc/2 can be generated as shown in Fig. 1.11b. Two-level converter and
three-level converter depend on the number of output voltages. In the NPC
three-level converter, the output voltage of the three levels is determined by the
on-off operation of each switch. When the ﬁrst switch Sx1 and the second switch Sx2
are turned on and the third switch Sx3 and the fourth switch Sx4 are turned off, the
output is connected to the top of the DC stage, and the output voltage is Vdc/2.
1.2
Three-Level Converter Types
9

Conversely, when the ﬁrst switch Sx1 and the second switch Sx2 are turned off and
the third switch Sx3 and the fourth switch Sx4 are turned on, the output voltage has a
value of -Vdc/2. Finally, when the ﬁrst switch Sx1 and the fourth switch Sx4 are
turned off and the second switch Sx2 and the third switch Sx3 are turned on, the
output voltage has a value of zero. It is summarized in Fig. 1.12 and the output
voltage of the third level is deﬁned as P, N or O depending on the switch operation
state, and can be expressed as shown in Table 1.1.
C1
Vdc
C2
Vxz
Vxz
Vdc /2
-Vdc /2
(a) Two-level converter
C1
Vdc
C2
Vxz
Vxz
Vdc /2
-Vdc /2
0
(b) Three-level converter 
Fig. 1.11 Comparison of two-level and three-level converters
Table 1.1 Operation characteristics in accordance to the ON/OFF state of each switch
Switching state
State of switching device
Output voltage Vxz (x = a, b, c)
Sx1
Sx2
Sx3
Sx4
P
ON
ON
OFF
OFF
+Vdc/2
O
OFF
ON
ON
OFF
0
N
OFF
OFF
ON
ON
−Vdc/2
10
1
Three-Level Converter Overview

1.3.2
Output Voltage of Three-Leg Three-Level Inverters
In a three-leg NPC three-level converter, the switching state of each leg can be
represented as P, N or O. Therefore, it is possible to represent the three-leg output
voltage using the switching states of the three legs. There are 27 switching states
that can be represented by the three-leg output voltage, and these 27 switching
states can be expressed as vectors as shown in Fig. 1.13 and Table 1.2.
Dx1
Dx2
Dx3
Dx4
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
O
Dx1
Dx2
Dx3
Dx4
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
P
Dx1
Dx2
Dx3
Dx4
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
N
Fig. 1.12 Circuit connection diagram in accordance with the ON/OFF state of a switch
Fig. 1.13 Voltage vectors of a three-level converter (reprinted from [10])
1.3
Three-Level Converter Operation Principle
11

A vector diagram of the three-level converter is composed of a large vector, a
medium vector, a small vector, and a zero vector. Small vectors have two types,
P-type and N-type.
1.3.3
Space Vector PWM (SVPWM)
The voltage vector diagram of a three-level converter is divided into six sectors.
The six sectors are expressed as Sectors I–VI. Each of these sectors can be divided
into four parts, which are expressed as Regions 1–4. In the space vector PWM
method, the command voltage vector is determined by the output voltage of the
three-level converter by the following four steps.
Table 1.2 Switching states and voltage vectors
Space vector
Switching state
Types of vector
Magnitude
V0
[POO][OOO][NNN]
Zero vector
0
P-type
N-type
Small vector
1
3 Vdc
V1
V1P
[POO]
–
V1N
–
[ONN]
V2
V2P
[PPO]
–
V2N
–
[OON]
V3
V3P
[OPO]
–
V3N
–
[NON]
V4
V4P
[OPP]
–
V4N
–
[NOO]
V5
V5P
[OOP]
–
V5N
–
[NNO]
V6
V6P
[POP]
–
V6N
–
[ONO]
V7
[PON]
Medium vector
ﬃﬃ
3
p
3 Vdc
V8
[OPN]
V9
[NPO]
V10
[NOP]
V11
[ONP]
V12
[PNO]
V13
[PNN]
Large vector
2
3 Vdc
V14
[PPN]
V15
[NPN]
V16
[NPP]
V17
[NNP]
V18
[PNP]
12
1
Three-Level Converter Overview

(a) Determine the Sector and Region of the command voltage vector.
In Fig. 1.14, the Sector and Region to which the command voltage vector (V*)
belongs are determined to be Sector I and Region 2.
(b) Determine the effective vector for generating the command voltage vector.
If Sector I-Region 2 is determined in accordance with the command voltage
vector (V*) is determined to be Sector I-Region 2, the voltage vectors V1, V2, and V7
that are closest to the command voltage vector (V*) are selected as valid vectors that
are the output voltage vectors. The command voltage vector (V*) can be selected
with different criteria for various purposes. The method of selecting adjacent vec-
tors shown here exhibits excellent performance in terms of output voltage ripple.
(c) Calculate the effective time of the selected effective vectors
Prior to the calculation of the effective time of the selected effective vectors, the
command voltage vector can be expressed using the magnitude (Vref) and phase (h)
as shown in the following equation.
V
*
ref ¼ Vref ejh
ð1:1Þ
The following equation is arrived at following equation when the magnitude and
phase of the selected voltage vectors V1, V2, and V7 are used.
V
*
1 ¼ 1
3 Vdc;
V
*
2 ¼ 1
3 Vdcejp=3;
V
*
7 ¼
ﬃﬃﬃ
3
p
3 Vdcejp=6
ð1:2Þ
Fig. 1.14 Command voltage
vector in Sector I
1.3
Three-Level Converter Operation Principle
13

The effective time of the selected valid vectors is calculated so that the average
output voltage during a switching period (Ts) becomes equal to the command
voltage vector (V*). Therefore, the following equations must be satisﬁed.
V
*
ref Ts ¼ V
*
1T1 þ V
*
2T2 þ V
*
7T7
ð1:3Þ
Ts ¼ T1 þ T2 þ T7
ð1:4Þ
where T1, T2, and T7 represent the effective switching time of the selected voltage
vector V1, V2, and V7.
The following equation can be obtained by substituting Eqs. (1.1) and (1.2) into
Eq. (1.3).
Vref ejhTs ¼ 1
3 VdcT1 þ
ﬃﬃﬃ
3
p
3 Vdcejp=6T2 þ 1
3 Vdcejp=3T7
ð1:5Þ
Equation (1.5) is divided into the real part (Re) and the imaginary part (Im) as
shown below.
Vref ðcos h þ j sin hÞTs
¼ 1
3 VdcT1 þ
ﬃﬃﬃ
3
p
3 Vdcðcos p
6 þ j sin p
6ÞT2 þ 1
3 Vdcðcos p
3 þ j sin p
3ÞT7
ð1:6Þ
Re : T1 þ 3
2 T2 þ 1
2 T7 ¼ 3 Vref
Vdc
ðcos hÞTs
Im : 3
2 T2 þ
ﬃﬃﬃ
3
p
2 T7 ¼ 3 Vref
Vdc
ðsin hÞTs
ð1:7Þ
When Eq. (1.7) is substituted into Eq. (1.4), the effective switching time of the
V1, V2, and V7 voltage vectors in Sector I-Region 2 can be calculated as follows.
T1 ¼ Ts½1  2Vref
Vdc
sin h
T2 ¼ Ts½2Vref
Vdc
sinðp
3 þ hÞ  1
T7 ¼ Ts½1  2Vref
Vdc
sinðp
3  hÞ
ð1:8Þ
The selected valid vectors selected in Sector I-Region 2 are generated for the
calculated effective switching time. In Sector I, the effective vectors and effective
switching time depending on the Region are calculated as shown in Table 1.3.
14
1
Three-Level Converter Overview

(d) Determine the output order of the selected valid vectors
There are two considerations in the output order of the selected valid vectors.
The ﬁrst is that one switching should be done within a switching period Ts to have a
constant switching frequency. The second consideration is that since N-type and
P-type can be selected as small vectors, the N-ype and P-type small vectors should
be arranged relatively evenly. Sector I-Region 2 outputs valid vectors according to
Regions 2a and 2b in different orders. Figure 1.15 shows the valid vector and its
effective switching time in Sector I-Region 2a. The output order of the valid vectors
is V1N, V2N, V7, V1P, V7, V2N and V1N, and the small vector is divided into P-type
and N-type. The output state of each leg changes with the output order of the
effective vectors according to the time, and each of the four phases switches on and
off according to the output state. Since the effective switching time is calculated so
that the average output voltage during a switching period (Ts) is equal to the
command voltage vector (V*), the output order of the valid vectors does not need to
be considered.
However, having a constant switching frequency results in ease of implemen-
tation and clariﬁes the frequency selection of the attenuation target in the ﬁlter
Table 1.3 The selected valid vector and effective switching time in Sector I
Region
Tx
Ty
Tz
1
V1
Ts½2Vref
Vdc sinðp
3  hÞ
V0
Ts½1  2Vref
Vdc sinðp
3 þ hÞ
V2
Ts½2Vref
Vdc sin h
2
V1
Ts½1  2Vref
Vdc sin h
V7
Ts½2Vref
Vdc sinðp
3 þ hÞ  1
V2
Ts½1  2Vref
Vdc sinðp
3  hÞ
3
V1
Ts½2  2Vref
Vdc sinðp
3 þ hÞ
V7
Ts½2Vref
Vdc sin h
V13
Ts½2Vref
Vdc sinðp
3  hÞ  1
4
V14
Ts½2Vref
Vdc sin h  1
V7
Ts½2Vref
Vdc sinðp
3  hÞ
V2
Ts½2  2Vref
Vdc sinðp
3 þ hÞ
V1N
ONN
V1N
ONN
V2N
OON
V2N
OON
V7
PON
V7
PON
V1P
POO
Ta,on
Tb,on
Tc,on
Vaz
Vbz
Vcz
1T
4
1T
4
2T
2
2T
2
7T
2
7T
2
1T
2
sT
Fig. 1.15 Switching
sequence in sector I-region 2a
1.3
Three-Level Converter Operation Principle
15

design. In addition, placing the P-type and N-type small vectors evenly helps
maintain the neutral-point voltage at equilibrium.
1.3.4
Carrier-Based PWM
The space vector PWM method can achieve various control purposes by changing
the voltage vector selection method. DTC (Direct Torque Control) [11], which is
used in motor control and outputs one switching state during a switching cycle, can
also be said to be a kind of space voltage PWM method. However, the space vector
PWM method requires complicated equations and processes before the output
voltage is generated. One possible solution to this drawback is to use the
carrier-based PWM method. The switching state of each switch is determined
simply by comparing the triangular carrier and the command voltage as shown in
Fig. 1.16, and various control purposes can be achieved depending on how the
command voltage is changed.
The command voltage for the carrier-based PWM method in the three-level
converter can be generated by applying Sinusoidal PWM (SPWM), PWM methods
using the offset voltage, and Third Harmonic Injection PWM (TH-PWM).
In this chapter, the PWM method using the offset voltage shown in Fig. 1.17 is
introduced.
The three-leg command voltages (Va,ref, Vb,ref, and Vc,ref) are represented as follows.
Va;ref ¼ Vmag cosð2pff tÞ
Vb;ref ¼ Vmag cosð2pff t  2p=3Þ
Vc;ref ¼ Vmag cosð2pff t þ 2p=3Þ
ð1:9Þ
Offset Voltage Calculation
Two Carriers
0
1
0
1
0
1
0
1
0
1
0
1
Va,ref
Vb,ref
Vc,ref
Va,ref,offset
Vb,ref,offset
Vc,ref,offset
Sa2,4
Sa1,3
Sb2,4
Sb1,3
Sc2,4
Sc1,3
Voffset
Fig. 1.16 Block diagram of the carrier-based PWM method using the offset voltage
16
1
Three-Level Converter Overview

Here, Vmag represents the magnitude of the command voltage, and ƒf represents
the fundamental wave frequency. The offset voltage (Voffset) is used to increase the
voltage modulation range and can be expressed as
Voffset ¼  Vref ;max þ Vref ;min
2
ð1:10Þ
Here, Vref,max represents the largest value among the three-leg command volt-
ages, and Vref,min represent the smallest voltage among the three-leg command
voltages. The offset voltage (Voffset) calculated in Eq. (1.10) is added to the three-leg
command voltage in Eq. (1.9).
Va;ref ;offset ¼ Va;ref þ Voffset
Vb;ref ;offset ¼ Vb;ref þ Voffset
Vc;ref ;offset ¼ Vc;ref þ Voffset
ð1:11Þ
The method of generating the command voltage in the PWM method using the
offset voltage is the same as in the two-level converter. However, unlike the
two-level converter in which the command voltage is compared to one carrier, in a
three-level converter, two carriers are compared with the command voltage to
produce an output voltage.
The on-off operation of the four switches in one leg is determined by comparing
the command voltage with two carriers placed in parallel, as shown in Fig. 1.18a
and is deﬁned as follows.
Fig. 1.17 Comparison of the
command voltages for SPWM
and PWM method using
offset voltage
1.3
Three-Level Converter Operation Principle
17

(a) The above carrier waves determine the complementary switch states of Sx1 and
Sx3
• Carrier < command voltage: Sx1 (ON), Sx3 (OFF)
• Carrier > command voltage: Sx1 (OFF), Sx3 (ON)
(b) The following carrier waves determine the complementary switch states of Sx2
and Sx4
• Carrier < command voltage: Sx2 (ON), Sx4 (OFF)
• Carrier > command voltage: Sx2 (OFF), Sx4 (ON)
(a) Two carriers and one command voltage
(b) One carrier and two command voltages 
Fig. 1.18 PWM method using carrier waves in a three-level converter
18
1
Three-Level Converter Overview

When realizing an offset voltage PWM method in a real system, a carrier
function provided by an MCU (Micro Controller Unit) can be used. However, this
carrier function cannot be implemented in parallel with a single triangular function.
To solve this problem, two command voltages are generated, as shown in
Fig. 1.18b, so that only one carrier can be used. One of the two command voltages
is compared to the carrier for the complementary on-off operations of Sx1 and Sx3
and the other command voltage is compared with the carrier for the complementary
on-off operations of Sx2 and Sx4.
1.3.5
Neutral-Point Voltage Fluctuation
The three-level converter has two DC capacitors. The input and output character-
istics discussed above are based on the assumption that half of the total DC
capacitor voltage is applied to each of the DC capacitors (neutral-point voltage
equilibrium state).
Neutral-point voltage refers to the difference between two DC capacitor volt-
ages. The PWM methods of a three-level converter need to consider the change in
the neutral-point voltage, and each switching state causes the change in the
neutral-point voltage to be different as shown in Fig. 1.19. The voltage vector
directly affecting the neutral-point voltage is a small vector. When the three-level
converter operates as an inverter, the P-type small vector reduces the upper
capacitor voltage and decreases the lower capacitor voltage. On the other hand, the
N-type small vector increases both the upper capacitor voltage and the lower
capacitor voltage. The medium vector is not directly related to the change in the
neutral-point voltage. However it indirectly affects the change in the neutral-point
voltage depending on the state of the output current. In addition, the large vector
does not affect the change of the neutral-point voltage by generating the same
voltage change in the two DC capacitor voltages. Furthermore, the zero vector does
not change the neutral-point voltage. In a three-level rectiﬁer, the change in the two
DC capacitor voltages due to the small and medium vectors appears opposite the
three-level inverter.
Even if neutral-point voltage equilibrium is considered in the PWM method of
the three-level converter, the imbalance of the neutral voltage can be caused by
various reasons. The differences in the capacitance of DC short capacitors generated
in the manufacturing process, the characteristics of each switching device, and
mismatches of switching on-off points all contribute to neutral-point voltage
imbalance.
1.3
Three-Level Converter Operation Principle
19

1.4
Three-Level Converter Reliability Research Field
Three research areas have been considered for reliability improvement of
three-level converters. The ﬁrst area is the switch fault diagnosis and tolerance
control of three-level converters, the second one is the neutral-point voltage ripple
reduction of three-level converters, and the third is related to the leakage current
reduction of three-level converters.
V13 [PNN]
Z
+
_
L
O
A
D
V0 [PPP]
Z
+
_
L
O
A
D
V1 [POO]
Z
+
_
L
O
A
D
V1 [ONN]
Z
+
_
L
O
A
D
V7 [PON]
Z
+
_
L
O
A
D
V7 [PON]
Z
+
_
L
O
A
D
Vdc
Vtop
Vbot
Ctop
Cbot
Vdc
Vtop
Vbot
Ctop
Cbot
Vdc
Vtop
Vbot
Ctop
Cbot
Vdc
Vtop
Vbot
Ctop
Cbot
Vdc
Vtop
Vbot
Ctop
Cbot
Vdc
Vtop
Vbot
Ctop
Cbot
Fig. 1.19 Neutral point voltage change depending on the voltage vector type of a three-level
converter
20
1
Three-Level Converter Overview

1.4.1
Fault Diagnosis and Tolerance Control of Three-Level
Converters
Compared to a two-level converter, the number of switches in a three-level converter
is twice as large. Generally, when the number of switches in a power conversion
apparatus increases, the probability of a fault in this power conversion apparatus also
increases. This results in inoperability of the power conversion apparatus, which can
result in a disruption of the plant and an interruption of the power supply. In fact,
switch faults of power converters are found to make up about 21% of faults after
capacitor and PCB faults as shown in Fig. 1.20. Research has been actively con-
ducted in two areas to solve the problems caused by switch faults. The ﬁrst research
area is the fault diagnosis of switches. Switch fault diagnosis must accurately
determine whether or not the switch of a power converter has failed and where it is
located. This information is then used for the tolerant control or maintenance of the
switch in which the fault occurred. It is a more required technology in a power
conversion apparatus composed of many switches. The second research area is the
use of tolerant control. Tolerant control is a technique for minimizing the loss caused
by the faults of power converters. The operation of a power converter using tolerant
control cannot satisfy all requirements in the steady state. However, it enables basic
operations to be performed even in the event of a fault. Tolerant control can be
utilized more easily in power converters consisting of many switches, such as
three-level converters. An open-loop switch fault diagnosis method for the
open-circuit switch fault of three-level converter is presented in Chap. 2 of this book,
while tolerant control methods for open-circuit switch failures are explained in
Chap. 3. The open-circuit switch fault diagnosis method and tolerant control
methods presented in Chaps. 2 and 3 do not require additional elements or devices
since they only use the surviving switches in the three-level converter.
1.4.2
Neutral-Point Voltage Ripple Reduction
In three-level converters, the neutral-point voltage refers to the voltage difference
between the upper and lower capacitors of the DC stage. The imbalance of the
neutral-point voltage caused by those mentioned in Sect. 1.3.5 results in a voltage
imbalance of the DC component. The voltage imbalance of the DC component at
the neutral-point results in switch breakdown and a THD increase of the output
current. Therefore, various neutral-point voltage balance control methods are pro-
posed for solving this problem. In order to use a three-level converter, the
neutral-point voltage balance control must be applied.
There is also an imbalance of the AC component at the neutral-point voltage
ﬂuctuation. This means a ripple of the neutral-point voltage. Neutral-point voltage
ripple is not caused by the problems mentioned above. However, it is determined by
the PWM method and operating condition of the three-level converter. Increasing
1.4
Three-Level Converter Reliability Research Field
21

the neutral-point voltage ripple results in a performance penalty, such as increases
in the THD of the output current like the neutral-point voltage imbalance of the DC
component. In addition, a large neutral-point voltage ripple means that the voltage
Table 1.4 Allowable ripple current depending on the capacitor capacity (Samyoung, RFA Series)
Rated
voltage (V)
Capacitance
(lF)
Magnitude
(Diameter  height)
Permissible current ripple
(Arms, 120 Hz)
350
3300
63.5  120
11.1
3900
63.5  130
12.8
4700
63.5  160
15.2
7400
76.5  120
14.7
5600
63.5  170
17.3
5600
76.5  130
16.9
450
2200
63.5  120
9.1
2700
63.5  130
10.6
2700
76.5  120
11.2
3300
63.6  160
12.7
3300
76.5  130
13.0
3900
63.5  170
14.4
4700
76.5  160
16.7
5600
76.5  170
21.1
5600
89  160
19.9
Fig. 1.20 Power converter fault type distribution (reprinted from [13], Fig. 2)
22
1
Three-Level Converter Overview

ripple and the injected current ripple of the two DC capacitors are large. A capacitor
has the amount of allowable current ripple depending on its capacitance and size as
shown in Table 1.4, and its life is shortened when the ripple current exceeds its
allowable ripple current capacity. Therefore, it is necessary to analyze the com-
ponent and magnitude of the ripple current to determine the capacitance and con-
ﬁguration of the series/parallel combination of capacitors in the design process. It
should also be noted that the current ripple that can be tolerated on a capacitor is
different for each frequency as shown in Table 1.5. A neutral-point voltage ripple
reduction technique for reducing the capacitance of a three-level converter and
increasing the lifetime of three-level converter is described in Chap. 4 of this book.
1.4.3
Leakage Current Reduction
Leakage current refers to current ﬂowing to ground. This book describes leakage
current that can occur during steady-state operation, not the leakage current caused
by accidents. Many recently developed products use transformerless topology
which is economical in terms of size and cost. Three-level converters have been
applied without the transformer in many ﬁelds such as photovoltaic power gener-
ation, wind power generation and ESS (Energy Storage System). However, a power
conversion apparatus of the transformerless type may cause leakage current. The
magnitude of the leakage current is determined by the size of the leakage capacitor
and the PWM method of the power converter. The magnitude of the leakage
capacitor varies depending on environmental factors such as temperature and
humidity. Large leakage currents can result in performance degradation, such as
increasing the current THD of the power converter. In addition, since the size of
leakage current is clearly regulated to ensure the safe operation of power conversion
apparatus, reduction measures are required for authentication and product devel-
opment. The most common solution is to connect additional ﬁlters to reduce
leakage current. However, this causes problems such as increases in the price and
size of products. In addition, it is possible to reduce leakage current by changing the
PWM method of the power converter. Methods of reduce the leakage current of a
three-level converter are described in Chap. 5 of this book. These methods do not
require additional elements or devices and they reduce the leakage current by
changing the PWM method of three-level converters.
Table 1.5 Calculation of capacitor allowable ripple current with frequency change factor
(Samyoung, RFA Series)
Frequency (Hz)
60
120
300
1 k
3 k
Factor
0.8
1.0
1.1
1.3
1.4
1.4
Three-Level Converter Reliability Research Field
23

References
1. Rodriguez, J., J.S. Lai, and F.Z. Peng. 2002. Multilevel inverters: A survey of topologies,
controls, and applications. IEEE Transactions on Industrial Electronics 49 (4): 724–738.
2. Malinowski, M., K. Gopakumar, J. Rodriguez, and M.A. Pérez. 2010. A survey on cascaded
multilevel inverters. IEEE Transactions on Industrial Electronics 57 (7): 2197–2206.
3. Rodriguez,
J.,
S.
Bernet,
P.K.
Steimer,
and
I.E.
Lizama.
2010.
A
survey
on
neutral-point-clamped inverters. IEEE Transactions on Industrial Electronics 57 (7): 2219–
2230.
4. Schweizer, M., I. Lizamay, T. Friedli, and J.W. Kolar. 2010. Comparison of the chip area
usage of 2-level and 3-level voltage source converter topologies. In Proceeding of IECON,
pp. 391–396, Nov. 2010.
5. Schweizer, M., and J.W. Kolar. 2012. Design and implementation of a highly efﬁcient
three-level T-type converter for low-voltage applications. IEEE Transactions on Power
Electronics 28 (2): 899–907.
6. Soeiro, T.B., and J.W. Kolar. 2013. The new high-efﬁciency hybrid neutral point-clamped
converter. IEEE Transaction on Industrial Electronics 60 (5): 1919–1935.
7. Soeiro, T.B., and J.W. Kolar. 2013. Analysis of high-efﬁciency three-phase two- and
three-level unidirectional hybrid rectiﬁers. IEEE Transaction on Industrial Electronics 60 (9):
3589–3601.
8. Woo, H.M. 2014. Applications for next generation power semiconductor of SiC and GaN.
The Korean Institute of Electrical Engineers (KIEE) 63 (5): 5.
9. Schweizer, M., T. Friedli, and J.W. Kolar. 2013. Comparative evaluation of advanced
three-phase three-level inverter/converter topologies against two-level systems. IEEE
Transaction on Industrial Electronics 60 (12): 5515–5527.
10. Wo, B. High-power converter and AC drives. Hoboken: Wiley
11. Lee, K.B., S.H. Huh, J.Y. Yoo, and F. Blaabjerg. 2005. Performance improvement of DTC
for induction motor-fed by three-level inverter with an uncertainty observer using RBFN.
IEEE Transactions on Energy Conversion 20 (2): 276–283.
12. Choi, U.M., F. Blaabjerg, and K.B. Lee. 2015. Reliability improvement of a T-type
three-level inverter with fault-tolerant control strategy. IEEE Transactions on Power
Electronics 30 (5): 2660–2673.
24
1
Three-Level Converter Overview

Chapter 2
Open-Circuit Fault Detection Methods
for Three-Level Converters
2.1
Switch Fault Case and Reasons
IGBT modules are typically classiﬁed into two types: wire-bonded IGBT modules
and press-pack IGBT modules. They have different characteristics which are a
tradeoff between cost and performance, as shown in Table 2.1.
IGBT modules have a larger thermal resistance, a lower power density, and a higher
failure rate because of the soldering and bond-wire connections of the internal chips.
Press-pack packaging technology shown in Fig. 2.1 improves the connections between
chips by direct press-pack contact. Therefore, press-pack IGBT modules have better
reliability, a higher power density, and better cooling capability. However, their cost is
also higher than that of conventional IGBT modules. Therefore, wire-bonded power
device modules are still widely used in power electronics. Therefore, the failure
mechanisms of conventional wire-bond IGBT modules are presented.
A wire-bonded IGBT is made up of several layers consisting of different
materials. A silicon (Si) chip is soldered to a direct copper bonded (DCB) ceramic
substrate. The DCB substrate insulates the Si chip from the baseplate and conducts
the heat dissipated by the chip to the cooling system. Finally, the top side of the Si
chip is contacted by aluminum (Al) bond wires. Figure 2.2 shows the structure of a
wire-bond IGBT modules package.
The weak points in wire-bond IGBT modules are the wire bond and silicon
interconnection, the silicon and DCB substrate solder joint, and the DCB substrate
and baseplate solder joint. The primary failure mechanism in IGBT modules is the
wire-bond liftoff as shown in Fig. 2.3. Al and Si material have different coefﬁcients
of thermal expansion (CTE), and thermal cycling causes repeated cooling and
heating. This allows the disparately joined materials to expand and shrink at dif-
ferent rates when stress is applied at the point of contact. This CTE mismatch with
temperature swings leads to wire-bond liftoff failures.
Another dominant failure mechanism is solder joint fatigue as shown in Fig. 2.4.
Two solder joints are present in a standard IGBT module. They are between the Si
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_2
25

and the DCB and between the DCB and the baseplate. The CTE mismatch between
the DCB substrate and the baseplate is higher than that between the DCB substrate
and the Si. Therefore, the possibility of failure is higher in the solder joint between
the DCB and the baseplate. This solder joint degradation increases the thermal
resistance of the power device module. Therefore, the temperature in the module
increases, which accelerates the lifting of the wire-bond.
The faults of IGBTs are classiﬁed into short-switch faults and open-switch faults.
Short-switch faults may have serious impact on systems such as breakdown, as
shown in Fig. 2.5, because a large current (which is above the rated current) ﬂows
through the short-circuited switch. Therefore, the system has to stop to ensure the
safety of the other parts and the fuse, or additional devices, as shown in Fig. 2.6 [2],
are used for preventing explosion from an abnormal large current.
On the other hand, open-switch faults (which are generated by thermal cycling,
excessive collector current, and gate driver faults) cause input current distortions in
NPC and T-type three-level converters [9, 10]. For the input side of the rectiﬁer, this
current distortion increases the total harmonic distortion (THD) and adversely
affects the grid. Moreover, the power factor of the rectiﬁer decreases, and the
DC-link ripple increases. If an open-switch fault is not detected for a long time,
other problems are generated because the distorted current is used to control the
Table 2.1 Wire-bond IGBT modules versus press-pack IGBT modules
Characteristic
Wire-bond module
Press-pack IGBT module
Power density
Moderate
High
Reliability
Moderate
High
Cost
Moderate
High
Failure mode
Open circuit
Short circuit
Ease of maintenance
Better
Worse
Insulation of heat sink
Yes
No
Thermal resistance
Moderate
Small
Switching loss
Low
Low
Conduction loss
High
High
Fig. 2.1 Press-pack IGBT module
26
2
Open-Circuit Fault Detection Methods …

Fig. 2.2 Wire-bond IGBT module
Fig. 2.3 Fault cases of a wire-bond IGBT module (wire fatigue)
2.1
Switch Fault Case and Reasons
27

Fig. 2.5 Breakdown case
Fig. 2.4 Fault cases of a wire-bond IGBT module (solder fatigue)
28
2
Open-Circuit Fault Detection Methods …

converter. Consequently, open-switch faults should be detected quickly, and tol-
erance control should be applied if possible.
Research into open-switch fault detection methods for three-level converters has
been presented in a lot of papers. Some of these methods include an additional
device for open-switch fault detection. Owing to this, current shape is considered in
a lot of papers. Detection methods using currents are often based on the fact that the
current pattern of the normal condition is different from the current pattern of an
open-switch fault.
In this book, detection methods without additional devices for the open-circuit
fault of three-level converters will be explained. Since the current patterns caused
by a fault switch are different depending on the topology and the position of the
switch, a detection method for each converter is required. In this chapter, the effects
of the current under switch open-circuit faults will be introduced and the operation
Fig. 2.6 Detection and tolerant control method using additional devices for switch short-circuit
fault: a fault detection method using a fuse, b tolerant control method with an additional leg
(drawn from Ref. [2], Fig. 1)
2.1
Switch Fault Case and Reasons
29

characteristic according to the operation mode (inverter mode and rectiﬁer mode)
will be explained. Finally, based on these results, several detection methods will be
demonstrated.
2.2
Switch Open-Circuit Fault Detection Methods
for NPC Three-Level Inverters
The three-level converter is used as a power conversion system in motor drives and
renewable energy generation. Inverter operation means that the energy stored in the
DC-link is transferred to the output of the inverter. This chapter shows switch
open-circuit fault detection methods for NPC three-level inverters.
2.2.1
Switch Open-Circuit Fault Detection Methods Using
Additional Devices
A. Switch open-circuit fault detection method using voltage sensors
Figure 2.7 shows a two-level inverter used in motor drive applications [1]. There
are voltage sensors for detecting switch open-circuit faults. This method uses the
fact that the output voltage of the three legs cannot make the desired output voltage
Fig. 2.7 Switch open-circuit fault detection method using voltage sensors (reprinted from Ref.
[1], Fig. 4)
30
2
Open-Circuit Fault Detection Methods …

in the presence of a switch open-circuit fault. In this method, the detection signal is
generated by comparing two voltages in the normal condition and in the switch
fault condition.
B. Switch open-circuit fault detection method using additional detection circuits
Figure 2.8 shows a detection circuits for switch open-circuit faults [3].
The inputs of the detection circuits are the pole voltage (Vxo, x = a, b, c) of each
leg and the fault signal is generated through the Voltage-level detection circuit,
the Integration circuit, and the Comparison circuit in order. This method can
identify a fault state exactly. However, it cannot distinguish the position of the
switch fault.
2.2.2
Switch Open-Circuit Fault Detection Method Using
Current Distortion
The detection methods using additional devices have big drawbacks due to their
increases in terms of size and cost. Therefore, a lot of papers have proposed
detection methods using current distortion without additional devices.
Fig. 2.8 Switch open-circuit fault detection method using additional detection circuits (reprinted
from [3], Fig. 9)
2.2
Switch Open-Circuit Fault Detection Methods …
31

The abnormal voltage caused by a switch open-circuit fault leads to current
distortion. The output currents which are measured by current sensors are used to
control the system and to obtain useful information for detecting fault switches.
A. The effects on current from switch open-circuit faults
The basic operation of a NPC three-level converter is shown in Chap. 1. The
switching states are divided into three states P, O, and N. By considering the current
direction, six current paths are expressed as shown in Fig. 2.9. When the switching
state is P, there are two current paths depending on the current direction. In one
path, the current ﬂows through the two switches and the current direction is from
the output to the DC-link. In the other path, the current direction is from the
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(b) Switching state O
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(a) Switching state P
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(c) Switching state N
Inverter mode
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Exs
Exs
Exs
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(e) Switching State O
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(f) Switching state N
Dx1
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
(d) Switching state P 
Inverter mode
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Exs
Exs
Exs
Fig. 2.9 Current paths of the NPC topology for the current directions and switching states
32
2
Open-Circuit Fault Detection Methods …

DC-link to the output and the current ﬂows through two diodes. Based on the
results, the switching states O and N can be analyzed.
When the NPC three-level converter operates in the inverter mode with unity
power factor, only four current paths are used because the sign of the output voltage
is the same as that of the output current. A positive output voltage is generated by
the P- and O-switching states and the current ﬂows from the DC-link to the output.
The N- and O-switching states lead to a negative output voltage and the current
ﬂows from the output to the DC-link. The P- (or N-) switching state is a valid
switching state which causes the current to ﬂow in the inverter mode. The
O-switching state act as a freewheeling path.
• Sx1 open-circuit fault
When the open-switch fault occurs in switch Sx1 while the switching state is
“P,” the phase current path in the grid-connected system is different from that
under the RL load condition. Because of the grid phase voltage Exs, the diode D1
becomes reverse-biased. The grid phase voltage Exs is the voltage between the
grid and ground. The current path is opened, and the positive phase current
becomes zero as shown in Fig. 2.10a. If Exs is higher than the dc-link voltage
(VDC/2), the current path is formed through diodes Dx1 and Dx2. Since this period
is very short and the potential difference is very small, the negative phase current
is almost zero.
• Sx2 open-circuit fault
When the open-switch fault occurs in switch Sx2 while the switching state is “P,”
the phase current does not ﬂow as shown in Fig. 2.10b, because the phase current
path is opened. Even when the switching state is “O,” the phase current path is not
formed, because the switch Sx2 is opened. If Exs is higher than Vxz, the phase current
is formed through switch Sx3 and diode D2. However, the negative phase current
does not ﬂow, because this period is very short.
• Sx3 open-circuit fault
When the switching state is “N,” the phase current path is opened because of the
occurrence of the open-switch fault in switch Sx3. The negative phase current
becomes zero as shown in Fig. 2.10c.
Even when the switching state is “O,” the phase current path is not formed,
because switch Sx3 is opened. The path is formed through diode D1 and switch Sx2
when Vxz is higher than Exs. However, the positive phase current does not ﬂow
because of the abovementioned reasons.
2.2
Switch Open-Circuit Fault Detection Methods …
33

• Sx4 open-circuit fault
When the open-switch fault occurs in switch Sx4 while the switching state is
“N,” diode D2 becomes reverse biased. The current path follows the open circuit,
and the phase current becomes zero as shown in Fig. 2.10d.
The feasible and infeasible switching states of NPC three-level converter
depending on the position of the open-switch fault are summarized in Table 2.2.
B. Analysis of the current distortion caused by open-circuit faults
The measured three-phase currents (Ia, Ib, Ic) can be transformed into two
dimensions (Ids, Iqs) through the following equations:
Ids ¼ Ia
Iqs ¼ 1ﬃﬃﬃ
3
p ðIb  IcÞ
ð2:1Þ
The current patterns that indicate the location of a faulty switch can be classiﬁed
into 12 patterns. The shape of the current pattern under a healthy condition is a
circle [4, 5].
In the occurrence of an open-switch fault, there is a change in the phase
current value at the location where the fault has occurred. Therefore, a change in
the circle shape and angle represents the occurrence of an open fault condition
and is an indicator of the location of the faulty switching device, as shown in
Table 2.3 and Fig. 2.11 under RL load. The magnitude and semicircle angle are
deﬁned as:
Table 2.2 Feasible and infeasible switching state of a T-type three-level converter depending
on the position of the open-switch fault
Position of open-switch fault
Feasible switching state
Infeasible switching state
Sx1
N (Fig. 2.9c, f)
O (Fig. 2.9b, e)
P (Fig. 2.9a]
P (Fig. 2.9d)
Sx2
N (Fig. 2.9c, f)
O (Fig. 2.9b)
P (Fig. 2.9a)
P (Fig. 2.9d)
O (Fig. 2.9e)
Sx3
N (Fig. 2.9f)
O (Fig. 2.9e)
P (Fig. 2.9a, d)
N (Fig. 2.9c)
O (Fig. 2.9b)
Sx4
N (Fig. 2.9f)
O (Fig. 2.9b, e)
P (Fig. 2.9a, d)
N (Fig. 2.9c)
34
2
Open-Circuit Fault Detection Methods …

Fig. 2.10 Grid-connected NPC inverter characteristics: a Sx1, b Sx2, c Sx3, d Sx4 (reprinted from
[4], Figs. 10–13)
2.2
Switch Open-Circuit Fault Detection Methods …
35

Imag ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
I2
qs þ I2
ds
q
ð2:2Þ
h ¼ tan1 Iqs
Ids


ð2:3Þ
The open-switch fault detection steps under RL load are as follows
(1) First, calculate the magnitude of the current vector using (2.2).
(2) Second, compare Imag with the magnitude of the current reference.
Imag;ref ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
I2
qe;ref þ I2
de;ref
q
ð2:4Þ
(3) Third, if the difference of (2.2) exceeds the deﬁned value, determine the angle
of (2.3).
(4) Fourth, determine the position of the open-circuit fault by Table 2.3.
In the third step, by dividing the detection level into two levels, Sx1 and Sx2 (or
Sx3 and Sx4) the faults can be classiﬁed.
Figure 2.12 shows the current patterns of a grid-connected NPC inverter system
under the fault condition. As in the previous analysis, the phase currents are the
same in the two situations when either the Sx1 switch or the Sx2 switch are broken
down. The phase currents when a fault occurs in either Sx3 or Sx4 are also equal. It
is impossible to distinguish a fault in switch Sx1 from that in switch Sx2, or a fault in
switch Sx3 from that in switch Sx4 using the method explained in the previous
section.
C. Experimental result of switch open-circuit fault detection in NPC three-level
inverters
• Sx1 and Sx2 (Sx3 and Sx4) classiﬁcation using the pulse of the O-switching state
The main difference between a fault in switch Sx1 and that in switch Sx2 or
between a fault in switch Sx3 and that in switch Sx4 is the possibility of switching
state O. However, Exs nulliﬁes positive phase current and negative phase current,
Table 2.3 Angle of
semicircles during the
occurrence of an open-switch
fault
h
Fault switch
30°–90°
Sc1 or Sc2 fault
90°–150°
Sb3 or Sb4 fault
150°–210°
Sa1 or Sa2 fault
210°–270°
Sc3 or Sc4 fault
270°–330°
Sb1 or Sb2 fault
330°–30°
Sa3 or Sa4 fault
36
2
Open-Circuit Fault Detection Methods …

Fig. 2.11 Simulated current patterns during the occurrence of an open-switch fault under RL load
(reprinted from [4], Fig. 9)
2.2
Switch Open-Circuit Fault Detection Methods …
37

Fig. 2.12 Measured current patterns during the occurrence of an open-switch fault in a
grid-connected system (reprinted from [4], Fig. 30)
38
2
Open-Circuit Fault Detection Methods …

regardless of the possibility of the O-switching state. It is difﬁcult to determine the
effects of the O-switching state on the current patterns. It is only possible to
determine whether an open-switch fault occurs in one of the two upper switches
(Sx1, Sx2) or in one of the two lower switches (Sx3, Sx4), on the basis of the current
patterns. The location of a faulty switch either between the two upper switches or
between the two lower switches in a grid-connected NPC inverter system can be
identiﬁed by adding a simple switching scheme to the conventional method.
(5:1) Current generation identiﬁcation using the pulse of the O-switching state [4]
If an open-switch fault occurs in one of the two upper switches, the O-switching
state is applied for a very short period when Exs is negative. If positive phase current
ﬂows for a short period, then it can be inferred that an open-switch fault has
occurred in switch Sx1. If positive current does not ﬂow, then it can be inferred that
an open-switch fault has occurred in switch Sx2.
If an open-switch fault occurs in one of the two lower switches, the O-switching
state is applied for a very short period when Exs is positive. If negative phase current
ﬂows for a short period, then it can be inferred that an open-switch fault has
occurred in switch Sx4. If negative current does not ﬂow, it can be inferred that an
open-switch fault has occurred in switch Sx3.
Figure 2.13a shows experimental results under the parameters of Table 2.4 when
an open-switch fault occurs in switch Sx1. It is possible to detect the open-switch
fault within half of a fundamental period and to identify the location of the faulty
switch within two fundamental periods. Figure 2.13b shows the fault signal, phase
angle, and phase current when an open-switch fault occurs in switch Sx2. Similarly,
Fig. 2.13c, d show the phase angle, fault signal, and phase current when an
open-switch fault occurs in switches Sx3 and Sx4, respectively. Open switch fault
detection is also possible within half of a fundamental period, and identiﬁcation of
the faulty switch is possible within two fundamental periods. It is noted here that a
satisfactory diagnosis is obtained. It can also be seen from the experimental results
that the location of the faulty switch can be identiﬁed with the proposed algorithm
by using a simple switching control.
• Sx1 and Sx2 (Sx3 and Sx4) classiﬁcation using reactive current injection [11]
Usually, grid-connected inverters transfer electric power to the grid with a unity
Power Factor (PF). Therefore, the polarities of the output phase current and the
output voltage are almost the same, as shown in Fig. 2.14a. If an under excited
reactive power is injected, the phase current leads the output pole voltage and grid
voltage. Therefore, regions that have the different polarities between the phase
Table 2.4 Experimental parameters
DC-link voltage
600 V
Line-to-line voltage
380 Vrms
DC-link capacitor
1230 lF
Control period
160 ls
Switching frequency
6.25 kHz
Injection time for the O switching state
1–2 ms
2.2
Switch Open-Circuit Fault Detection Methods …
39

current and the output voltage occur as shown in Fig. 2.14b. In this section, region
1 means that the phase current is positive and that the output pole voltage is
negative, while region 2 means that the phase current is negative and that the output
voltage is positive. By making regions 1 and 2 through under excited reactive
power injection, the possibility of O-switching state can be determined and the
faulty switch can be identiﬁed. Whether or not the current in regions 1 or 2 ﬂows
depending on the faulty switch.
(5:2) Current generation identiﬁcation using reactive current injection [11]
First detection steps 1–4 are performed. Then reactive current is injected. If
current is generated, the fault switch is Sx4 (or Sx1), if it is not generated, the switch
is Sx2 (or Sx3).
Figure 2.15 shows experimental results under the parameters of Table 2.5. In the
case of a Sa1 fault, positive phase current ﬂows in the region where under excited
current is injected as shown in Fig. 2.15a. However, if an open-circuit fault occurs
in Sa2, positive current does not ﬂow as shown in Fig. 2.15b. From this result, the
Fig. 2.13 Measured results of fault diagnosis when an open-switch fault occurs: a Sa1, b Sa2,
c Sa3, d Sa4 (reprinted from Ref. [4], Figs. 31–34)
40
2
Open-Circuit Fault Detection Methods …

faulty switch between the upper two switches can be correctly identiﬁed.
Figure 2.15c, d show experimental results obtained with the discussed fault
detection method when Type-A open-circuit faults have occurred in Sa3 and Sa4,
respectively. To determine the fault location from between the two lower switches
(Sa3 and Sa4), under excited reactive current has been injected. Negative current
does not ﬂow under an open-circuit fault in Sa3. However, negative current ﬂows in
the case of an open-circuit fault in Sa4. The location of the faulty switch is identiﬁed
precisely by the discussed method.
Fig. 2.14 Phase currents Ia and pole voltage Vaz: a before and b after the injection of under
excited reactive current (reprinted from [11], Fig. 6)
Table 2.5 Experiment parameters
DC-link voltage
600 V
Line-to-line voltage
380 Vrms
DC-link capacitor
2200 lF
Control period
100 ls
Switching frequency
10 kHz
Injection time for O switching state
2 A
2.2
Switch Open-Circuit Fault Detection Methods …
41

2.3
Switch Open-Circuit Fault Detection Methods
for NPC Three-Level Rectiﬁers
2.3.1
Switch Open-Circuit Fault Detection Method Using
Additional Devices
Switch open-circuit fault detection methods using additional devices can detect the
position of an open-circuit fault regardless of the operation mode (inverter mode or
rectiﬁer mode). The methods mentioned in Sect. 2.2.1 can be used for detecting
switch faults in NPC-type three-level rectiﬁers.
2.3.2
Switch Open-Circuit Fault Detection Method Using
Current Distortion
A. The effects on current from switch open-circuit faults
The operating status of the switches and the pole voltage in NPC inverters can be
represented by switching states. The switching state P indicates that the two upper
switches Sx1 and Sx2 are ON and that the pole voltage Vxz, which is the voltage at
terminal x (x = a, b, c) with respect to the neutral-point voltage Z, is +Vdc/2. The
Fig. 2.15 Diagnosis of a faulty switch under a type-A open-circuit fault in: a Sa1, b Sa2, c Sa3,
d Sa4 by the injection of under excited reactive current (reprinted from [11], Fig. 20)
42
2
Open-Circuit Fault Detection Methods …

switching state O denotes that the two inner switches Sx2 and Sx3 are ON and that
Vxz is zero. The switching state N signiﬁes that the two lower switches Sx3 and Sx4
are ON and that Vxz is −Vdc/2.
Figure 2.16 shows the current paths according to the switching state and the
phase current direction. The phase current includes information on the switching
states in the NPC inverter. If an open-switch fault occurs, the switching state does
not reach the desired state. This causes a change in Vxz and the phase current ix.
B. Sx1 and Sx4 open-circuit faults of the three-level converters used in WTSs [8, 12]
Figure 2.17 shows a back-to-back power converter using a neutral-point-
clamped (NPC) topology in a Wind Turbine Systems (WTS). The voltage differ-
ence DV between the input voltage, provided by the NPC rectiﬁer, and the back
electromotive force (EMF) of the PMSG generates input current, which has a
different phase angle than the voltage difference DV because of the inductance and
resistance of the PMSG. The magnitude of the input voltage is almost the same as
(b) Switching state O
(a) Switching state P
(c) Switching state N
Rectifier mode
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
(e) Switching State O
(f) Switching state N
(d) Switching state P 
Rectifier mode
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Dx1
Sx1
Sx2
Sx3
Sx4
D1
D2
ix
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Dx1
Dx2
Dx3
Dx4
Fig. 2.16 Current paths of the NPC topology for the current directions and switching states
2.3
Switch Open-Circuit Fault Detection Methods …
43

Fig. 2.17 Back-to-back converter using the NPC topology for a WTS (reprinted from [8], Fig. 1)
44
2
Open-Circuit Fault Detection Methods …

(or smaller than) the back EMF. If the two voltage magnitudes are almost the same,
the current magnitude is determined by the phase angle difference between the input
voltage and the back EMF. Zero current means that the two voltages are the same
and that the phase angle of the input voltage matches that of the back EMF. For
unity power factor, the input voltage is controlled to correspond to the phase of the
current with the same phase as the back EMF, as shown in Fig. 2.18.
If the time intervals containing the paths in Fig. 2.16c, d are not long enough to
distort the current, Sx2 and Sx3 open-switch faults (which are related to the paths of
Fig. 2.16b, e, excluding Sx1 and Sx4 open-switch faults) can be considered because
there is no current through the IGBTs in the paths of Fig. 2.16a, f. Therefore, the
switching state O, which is shown in Fig. 2.16b, e, is a valid switching state that
generates current in the rectiﬁer.
However, the time intervals of [(b), (c)] and [(d), (e)] are inﬂuenced by the
current magnitude and modulation index. There are two Cases causing wide
intervals [(b), (c)] and [(d), (e)]:
• Case 1: When VEMF is small and a large Irec is required
• Case 2: When reactive current is injected for the IPMSG
Figure 2.19 shows the current ﬂow when a NPC rectiﬁer generates a large
current with a small modulation index. To create a large current ﬂow, the phase
angle difference is expanded. As a result, the time intervals of [(b), (c)] and [(d), (e)]
increase. In this case, current distortion is generated by Sx1 and Sx4 open-switch
faults. Consequently, all of the open-switch faults in the rectiﬁer must be
considered.
C. Open-circuit faults detection of the three-level converters used in WTSs
The current pattern is divided into four patterns depending on the location of the
open-switch fault. An Sx2 open-switch fault prevents the generation of negative
Fig. 2.18 Normal current ﬂow between a NPC rectiﬁer and a PMSG (reprinted from [12], Fig. 4)
2.3
Switch Open-Circuit Fault Detection Methods …
45

current, and an Sx3 open-switch fault prevents the generation of positive current. An
Sx1 open-switch fault makes the current zero for some duration in the negative
current, while the current becomes zero for some duration in the positive current
when an Sx4 open-switch fault occurs.
The range where the current distortion occurs can be deﬁned as shown in
Fig. 2.20. In each range, a switch open-circuit fault makes the current zero.
In the discussed detection method, the current can be divided into three ranges,
as shown in Fig. 2.21, to separate the four patterns. The time of the zero range TZ,Ix
is used to detect the location of an open-switch fault. The current belongs in one of
the three ranges. If an Sx2 open-switch fault occurs, no current ﬂows in the negative
range. An Sx3 open-switch fault prevents current from ﬂowing in the positive range,
and the current is in the zero range for a longer time.
If the previous sign of the current was positive and if the current is in the zero
range for half of a period, this indicates an Sx2 open-switch fault, as shown in
Fig. 2.21c. In the case of an Sx3 open-switch fault, the previous sign of the input
current is negative, and all of the other characteristics are the same as those in the
Sx2 open-switch fault detection method.
The detection method for the TZ,Ix of Sx2 and Sx3 open-switch faults is expressed
as:
D23 ¼ R23Thalf ¼ R23
1
2fs
\TZ
if Cpre;sign ¼ Positive; Sx2 fault
if Cpre;sign ¼ Negative; Sx3 fault

ð2:5Þ
where R23 is the detection parameter, Cpre,sign,Ix is the previous sign of the current,
Thalf is half of the current period, and fs is the angular frequency of the PMSG.
The previous sign of the current is determined when the input current enters the
zero range and the time of the zero range is calculated, as shown in Fig. 2.22.
Fig. 2.19 Current ﬂow process with a small modulation index and a large current (reprinted from
[12], Fig. 5)
46
2
Open-Circuit Fault Detection Methods …

Sx1 and Sx4 open-switch faults are also detected by calculating TZ,Ix. When the
current is sinusoidal, TP and TN are almost the same, and TZ,Ix is small. However, an
Sx1 open-switch fault leads to a decrease in TN and an increase in TZ,Ix, as shown in
Fig. 2.21b, and an Sx4 open-switch fault decreases TP and increases TZ,Ix.
Therefore, the detection method for Sx1 and Sx4 open-switch faults is expressed as:
D14 ¼ R14Thalf ¼ R14
1
2fs
\TZ
if Cpre;sign ¼ Positive; Sx1 fault
if Cpre;sign ¼ Negative; Sx4 fault

ð2:6Þ
where R14 is the detection parameter.
To determine the zero range value, the current ripple is considered. 10% of the
current is used in this study. Thalf for open-switch fault detection is changed
depending on the angular frequency because the period of the current is propor-
tional to the speed of the PMSG.
• Determination of the R23 and R14 values
In the determination of the R23 and R14 values, the zero range value due to each
open-switch fault should be considered. When an Sx2 or Sx3 open-switch fault
occurs, TZ,Ix is almost the same as a half period of fs (1/2 fs) regardless of the system
parameters. Therefore, if R23 is lower than 1, it is possible to detect Sx2 and Sx3
(a), (b)
(e), (f)
(b), (c)
(d), (e)
Irec
B
A
D
C
Sx3 open-switch fault
Sx2 open-switch fault
Sx4 open-switch fault
Sx1 open-switch fault
Fig. 2.20 Current distortion range depending on the position of a switch open-circuit fault
(reprinted from [12], Fig. 6)
2.3
Switch Open-Circuit Fault Detection Methods …
47

Current
TP.R
TZ.R
TN.R
1) Positive range
3) Negative range
2) Zero range
ZeroMax
ZeroMin
(a) Normal state
Current
TP
TZ.R
TN
R14Thalf
1) Positive range
3) Negative range
2) Zero range
ZeroMax
ZeroMin
(b) Sx1 fault 
Current
TP
TZ
R23Thalf
1) Positive range
3) Negative range
2) Zero range
ZeroMax
ZeroMin
(c) Sx2 fault
Fig. 2.21 Concept of the open switch fault detection method (reprinted from [8], Figs. 9, 10, 12)
48
2
Open-Circuit Fault Detection Methods …

open-switch faults, and the detection performance can be improved by decreasing
R23 close to 0.
To selecting R14, the zero range value TZ,Ix caused by an Sx1 or Sx4 open-switch
fault should be considered. Regardless of the open-switch fault, 10% of the current
is contained in the zero range, and its range hn is expressed as:
hn ¼ 2  sin1
1
10


¼ 11:5
ð2:7Þ
To consider the time of the zero range TZ,Ix caused by an Sx1 or Sx4 open-switch
fault, the system parameters shown in Fig. 2.23 are used. The voltage–current
equation is expressed as
Ix;rec ¼ BackEMF  Vref \h
Rs þ j2pfsLs
ð2:8Þ
where Vref is the rectiﬁer input voltage and h is the phase angle difference between
the input voltage and the Back EMF.
h is represented as:
h ¼
Ix;rec  2pfsLs
BackEMF  Ix;recRs
360
p
ð2:9Þ
Ls
Rs
PMSG
Rectifier
Back EMF
Irec
ref
V
∠θ
Fig. 2.23 PMSG circuit
model (reprinted from [8],
Fig. 13)
Zero range
Decision of 
previous current sign 
Current
Calculation of 
zero range time
Sign of previous 
current
Open-switch fault 
detection
Zero range time 
Current
Previous
current sign
Current
Zero range
Time (Tz)
Position of 
open-switch fault
Fig. 2.22 Block diagram for the detection of the previous current sign and the calculation of the
zero range duration (reprinted from Ref. [8], Fig. 11)
2.3
Switch Open-Circuit Fault Detection Methods …
49

When an Sx1 or Sx4 open-switch fault occurs, the range of the zero current hfault
is expressed as:
hfault ¼ h þ hn
2
ð2:10Þ
For selecting R14, the requirement can be expressed as:
hn
180
1
2fs
\R14
1
2fs
\ hfault
180
1
2fs
ð2:11Þ
Consequently, the values of R23 and R14 are in the range of 0–1, and R23 should
be larger than R14 because the TZ,Ix for Sx2 and Sx3 open-switch faults is longer than
that for Sx1 and Sx4 open-switch faults. R14 should satisfy (2.11).
The location of an open-switch fault in a rectiﬁer can be detected using (2.5) and
(2.6). Sx2 and Sx3 open-switch faults satisfy both (2.5) and (2.6). However, Sx1 and
Sx4 open-switch faults satisfy only (2.6). Therefore, an open-switch fault is detected
using (2.6), Then (2.6) is used to determine the location of the open-switch fault.
The proposed detection method is applied to three-phase currents.
• Detection principle for open-switch faults in NPC inverters
There are two current patterns caused by open-switch faults in an inverter with a
unity power factor. These are the same as those in the cases of Sx2 and Sx3
open-switch faults in a rectiﬁer. In the non-unity power factor case, although Sx1
and Sx2 open-switch faults create different current patterns, these faults generate the
same pattern for at least one-quarter of a period of the current (from the starting
point of the zero current), as shown in Fig. 2.24.
Therefore, (2.6) can be used to detect an open-switch faults in an inverter. The
previous sign of the current and the duration of the zero range are determined in the
same procedure of the rectiﬁer, as shown in Fig. 2.22. The detection equation for
open-switch faults of an inverter is expressed as:
Dup;low ¼ Iup;lowThalf ¼ Iup;low
1
2  60 [ TZ;Ix
if Cpre;sign;Ix ¼ Positive; Sx1fault or Sx2 fault
if Cpre;sign;Ix ¼ Negative; Sx3fault or Sx4 fault

ð2:12Þ
where Iup,low is the detection parameter. A grid frequency of 60 Hz is used for fs,
and Iup,low should be in the range of 0–0.5 due to the zero power factor.
The location of an open-switch fault can be classiﬁed into an upper-side (Sx1 and
Sx2) fault or a lower-side (Sx3 and Sx4) fault using this detection method. When the
open-switch fault detection method using the duration of the zero current is applied
to a back-to-back converter using the NPC topology, a block diagram of the
open-switch fault detection method for the back-to-back converter is shown in
Fig. 2.25.
50
2
Open-Circuit Fault Detection Methods …

C. Experimental results of the switch open-circuit fault detection in NPC
three-level rectiﬁers/inverters
The steps for switch fault detection in NPC three-level rectiﬁers/inverters is as
follows:
(1) Calculation of the current sign (Cpre,sign) as shown in Fig. 2.22
(2) Calculation of the zero range using (2.5) and (2.6)
(3) If it exceeds only D14, an Sx1 or Sx4 open-circuit fault occurs. Then the ﬁnal
position of the open-circuit fault is determined by Cpre,sign. If it exceeds D14 and
D23, an Sx2 or Sx3 open-circuit fault occurs. Then ﬁnal position of the
open-circuit fault is decided by Cpre,sign.
Figure 2.26 shows the experimental setup and the simulation and experimental
parameters are shown in Table 2.6.
Figure 2.27 shows distorted currents caused by open-switch faults in a rectiﬁer
at 600 rpm. The negative current remains zero for some time after the zero crossing
point when an Sa1 open-switch fault occurs, as shown in Fig. 2.27a. An Sa4
open-switch fault prevents the ﬂow of positive a-phase current for some time after
Fig. 2.24 Current distortion and a-phase pole voltage of open-switch faults for a power factor of
0.5: a Sa2, b Sa1, c Sa3, d Sa4 (reprinted from [8], Fig. 8)
2.3
Switch Open-Circuit Fault Detection Methods …
51

the zero crossing point, as shown in Fig. 2.27b. The negative current in the a-phase
becomes zero when an Sa2 open-switch fault occurs, as shown in Fig. 2.27c. An Sa3
open-switch fault prevents the ﬂow of positive current in the a-phase, as shown in
Fig. 2.27d. This characteristic of open-switch faults, which is veriﬁed by experi-
mental results, is the same as that of the simulated results.
Figure 2.28 shows the performance of the open-switch fault detection method in
a rectiﬁer at 600 rpm. TZ,Ix is always smaller than D14 for normal operation.
However, TZ,Ix increases when the current is zero because of an open-switch fault.
Then, an open-switch fault is detected when TZ,Ix exceeds DX (x = 14 and 23). The
detection signal, which is indicated by the red line, represents the location of the
Table 2.6 Simulation and experimental parameters
Generator
Rated power
11 kW
Rated power
191 Vrms
pole
6
pole
1450 rpm
Stator resistance
0.099 Ω
Stator resistance
4.07/4.65 mH
System parameter
DC-link voltage
600 V
DC-link voltage
380 Vrms
DC-link capacitance
1100 lF
DC-link capacitance
60 Hz
Switching frequency
10 kHz
Switching frequency
100 ls
Detection parameter
R14
0.075
R23/Iup,low
0.3
Ia,inv, Ib,inv, Ic,inv
Ia,rec, Ib,rec, Ic,rec
TZ.R calculation
Y
Sx3 open-switch 
fault
Cpre,sign,Ix
Negative
Sx2 open-switch 
fault
Positive
TZ.Ix > R14/2fs
Y
N
Cpre,sign,Ix
Sx1 open-switch 
fault
Sx4 open-switch 
fault
Negative
Positive
TZ.Ix > R23/2fs
N
TZ,Ia,rec
Tb,Ib,rec
Tc,Ic,rec
TZ.Ix > Iup,low/120
Y
Lower side fault
(Sx3 and Sx4)
Cpre,sign,Ix
Negative
Upper side fault
(Sx1 and Sx2)
Positive
TZ,Ia,inv
Tb,Ib,inv
Tc,Ic,inv
N
Inverter
Rectifier
Fig. 2.25 Block diagram of the open-switch fault detection method in a back-to-back converter
(reprinted from [8], Fig. 14)
52
2
Open-Circuit Fault Detection Methods …

open-switch fault. The open-switch fault detection method determines the location
of the open-switch fault using TZ,Ix and the previous sign of the current, as shown in
Fig. 2.28. Each fault detection signal is sent within one period of the current.
Figure 2.29 shows the performance of the open-switch fault detection method in a
rectiﬁer at 1200 rpm. Because an angular frequency of 1200 rpm is twice that of
Fig. 2.26 Experimental setup of a back-to-back converter using a NPC three-level topology
(reprinted from [8], Fig. 15)
(a) Sal open-switch fault
(b) Sa4 open-switch fault
(c) Sa2 open-switch fault
(d) Sa3 open-switch fault 
Fig. 2.27 Current distortion caused by open-switch faults in the rectiﬁer of a PMSG at 600 rpm
(reprinted from [8], Fig. 16)
2.3
Switch Open-Circuit Fault Detection Methods …
53

600 rpm, D14 and D23, which are calculated using (1) and (2), decrease in mag-
nitude by half, and their values are shown in Fig. 2.29. Similar to the case in
Fig. 2.28, TZ,Ix increases after an open-switch fault occurs, and the location of the
open-switch fault is determined within one period of the current.
Figure 2.30 shows the performance of the open-switch fault detection method in
an inverter at a unity power factor. In the inverter, Sx1 and Sx2 (Sx3 and Sx4)
open-switch faults lead to the same current pattern shown in Fig. 2.30. An
open-switch fault is detected when TZ,Ix exceeds Dup,low. A value of 1 for the red
line, which is the detection signal, indicates that there is one Sx1 and Sx2
open-switch fault. Meanwhile, a value of 2 for the red line indicates that there is one
Sx3 and Sx4 open-switch fault. The open-switch fault detection method determines
the location of the open-switch fault, as shown in Fig. 2.30. Each fault detection
signal is sent within one period of the current.
Figure 2.31 shows the performance of the open-switch fault detection method in
an inverter at a power factor of 0.5. In this case, Sx1 and Sx2 (Sx3 and Sx4)
open-switch faults lead to different current patterns. An Sx2 (Sx3) open-switch fault
leads to a zero current for a longer duration than an Sx1 (Sx4) open-switch fault, as
shown in Fig. 2.31. Although the power factor is not unity, the open-switch fault
detection method accurately determines the location of the open-switch fault. Each
fault detection signal is sent within one period of the current.
(a) Sal open-switch fault
(b) Sa4 open-switch fault
(c) Sa2 open-switch fault
(d) Sa3 open-switch fault 
Ia (10A/div)
Detection signal (2/div)
(25 ms/div)
D14 (=0.00125)
TZ (0.0025/div)
Ia (10A/div)
Detection signal (2/div)
(25 ms/div)
D14 (=0.00125)
TZ (0.0025/div)
Detection signal (2/div)
Ia (10A/div)
(25 ms/div)
D23 (=0.005)
TZ (0.01/div)
Detection signal (2/div)
Ia (10A/div)
(25 ms/div)
D23 (=0.005)
TZ (0.01/div)
Fig. 2.28 Experimental results for the proposed open-switch fault detection in the rectiﬁer of a
PMSG at 600 rpm (reprinted from [8], Fig. 17)
54
2
Open-Circuit Fault Detection Methods …

2.4
Switch Open-Circuit Fault Detection Method
for T-Type Three-Level Inverter
There are three switching states for three-level topologies. The ﬁrst switching state
is named P, and this means that Sx1 and Sx2 are ON and that Sx3 and Sx4 are OFF.
The next switching state is named O, and this means that Sx2 and Sx3 are ON and
that Sx1 and Sx4 are OFF. The switching state N means that Sx1 and Sx2 are OFF and
that Sx3 and Sx4 are ON. Depending on the current direction and switching state,
there are six current paths in the T-type topology, as shown in Fig. 3.32.
2.4.1
Switch Open-Circuit Fault Detection Method Using
Current Distortion
A. The effects on current depending on the position of an open-circuit fault
The current paths of inverter and rectiﬁer operations are different. For inverter
operation with a unity power factor, most of the positive current ﬂows through the
paths of Fig. 2.32b, c, and most of the negative current ﬂows through the paths of
Detection signal (2/div)
Ia (10A/div)
(10 ms/div)
D14 (=0.000625)
TZ (0.000625/div)
(a) Sa1 open-switch fault
Detection signal (2/div)
Ia (10A/div)
(10 ms/div)
D14 (=0.000625)
TZ (0.000625/div)
(b) Sa4 open-switch fault
Detection signal (2/div)
Ia (10A/div)
(25 ms/div)
D23 (=0.0025)
TZ (0.005/div)
(c) Sa2 open-switch fault
Detection signal (2/div)
Ia (10A/div)
(25 ms/div)
D23 (=0.0025)
TZ (0.005/div)
(d) Sa3 open-switch fault
Fig. 2.29 Experimental results for the proposed open-switch fault detection in the rectiﬁer of a
PMSG at 1200 rpm (reprinted from [8], Fig. 18)
2.4
Switch Open-Circuit Fault Detection Method …
55

Fig. 2.32d, e. Therefore, in a NPC inverter, the P-switching state of Fig. 2.32d is
made infeasible by an Sx1 or Sx2 open-switch fault regardless of the position of the
open-switch fault. This means that NPC inverters have a structural limitation to
realizing tolerance control without additional devices. On the other hand, in rectiﬁer
operation with a unity power factor, most of the positive current ﬂows through the
paths of Fig. 2.32a, b, and most of the negative current ﬂows through the paths of
Fig. 2.32e, f. These paths do not include the current ﬂowing through Sx1 and Sx4.
• Sx1 open-circuit faults
In T-type three-level inverters, Sx1 open-circuit fault makes the P-switching state
infeasible. This means that the current path of Fig. 2.32d cannot be generated. If
R-L load is connected to the output of the inverter, an Sx1 open-circuit fault leads to
variations of the load voltage, and an undesired current ﬂows through the
O-switching state instead of the P-switching state. However, the grid voltage and
back EMF of the motor drive do not generate any current due to the impossibility of
the P-switching state.
(a) Sa1 open-switch fault
(b) Sa4 open-switch fault
(c) Sa2 open-switch fault
(d) Sa3 open-switch fault
Fig. 2.30 Experimental results for the open-switch fault detection in an inverter at a unity power
factor (reprinted from [8], Fig. 19)
56
2
Open-Circuit Fault Detection Methods …

• Sx2 open-circuit faults
In T-type three-level inverters, an Sx2 open-circuit fault inﬂuences the
O-switching state. Therefore, the current path of Fig. 2.32e cannot be generated.
• Sx3 open-circuit faults
In T-type three-level inverters, an Sx3 open-circuit fault inﬂuences the
O-switching state. This is related to the current path of Fig. 2.32b which cannot be
generated.
• Sx4 open-circuit fault
Sx4 open-circuit faults lead to the impossibility of the N switching state. As a
result, the current path of Fig. 2.32c cannot be generated. Similar to Sx1
open-circuit faults, in the R-L load condition, current is generated by the feasible
O-switching state. On the other hand, there is no current in grid-connected and
motor drive applications when an Sx4 open-circuit fault occurs regardless of the
validity of the O-switching state.
Fig. 2.31 Experimental results for the open-switch fault detection in an inverter at a power factor
of 0.5 (reprinted from [8], Fig. 20)
2.4
Switch Open-Circuit Fault Detection Method …
57

The feasible and infeasible switching states of T-type three-level converter
depending on the position of the open-switch fault are summarized in Table 2.7.
B. Switch open-circuit fault detection method for T-type converters [6]
• The classiﬁcation of upper switch (Sx1, Sx2) and lower switch (Sx3, Sx4)
open-circuit faults
Under normal conditions, the average of the phase current is zero. However, in
faulty cases, the value of the phase current’s average is changed. If an open-switch
fault occurs in Sx1 or Sx2, the average of the phase current is a negative value
because the positive phase current is distorted as shown in Fig. 2.33. If an
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
(b) Switching state O
(a) Switching state P
(c) Switching state N
Inverter mode
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
(e) Switching State O
(f) Switching state N
(d) Switching state P 
Inverter mode
Fig. 2.32 Current paths depending on the current direction and operating state
58
2
Open-Circuit Fault Detection Methods …

Table 2.7 Feasible and infeasible switching states of a T-type three-level converter depending on
the position of an open-switch fault
Position of open-switch fault
Feasible switching state
Infeasible switching state
Sx1
N (Fig. 2.32c, f)
O (Fig. 2.32b, e)
P (Fig. 2.32a)
P (Fig. 2.32d)
Sx2
N (Fig. 2.32c, f)
O (Fig. 2.32b)
P (Fig. 2.32a, d)
O (Fig. 2.32e)
Sx3
N (Fig. 2.32c, f)
O (Fig. 2.32e)
P (Fig. 2.32a, d)
O (Fig. 2.32b)
Sx4
N (Fig. 2.32f)
O (Fig. 2.32b, e)
P (Fig. 2.32a, d)
N (Fig. 2.32c)
Fig. 2.33 Phase current in a T-type three-level inverter with RL load depending on the position of
an open-circuit fault: a Sx1, b Sx2, c Sx3, d Sx4 (reprinted from [6], Figs. 6–9)
2.4
Switch Open-Circuit Fault Detection Method …
59

open-switch fault occurs in Sx3 or Sx4, the average of the phase current has a
positive value because the negative phase current is distorted in the faulty leg.
The averages of the other phase currents are also changed due to distortions of
the phase current in the faulty leg. However, if these values are used directly, they
may lead to a false alarm when harmonic components exist in the phase current or
when this system is notably under fast transients. To improve the accuracy of
detection, the normalized current method is employed. The normalized current can
be obtained by the following equation:
Is ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
I2
qs þ I2
ds
q
IxN ¼ Ix
Is
ð2:13Þ
where x = a, b, c, and Ids and Iqs are the reactive and active currents in the stationary
reference frame, respectively.
The average of the phase current (IxN,avg) for one-fundamental period can be
expressed as:
IxN;avg ¼
Z2p
0
IxN
ð2:14Þ
Using these values, it is possible to identify the faulty leg and whether the
open-switch faults occur in one of the two switches Sx1 and Sx2 or in one of the two
switches Sx3 and Sx4. To improve accuracy, the threshold value Ithr is set. It is
summarized as:
IxN;avg [ Ithr :
IxN;avg\  Ithr :
Ithr\IxN;avg\Ithr :
Ux ¼ 1
Ux ¼ 1
Ux ¼ 0
ð2:15Þ
• An analysis of the characteristic difference between upper switch (Sx1, Sx2) and
lower switch (Sx3, Sx4) open-circuit faults
As mentioned above, by using the average phase current (IxN,avg), it is possible to
divide faults into upper switch (Sx1, Sx2) and lower switch (Sx3, Sx4) open-circuit faults.
However, the positions should be classiﬁed as Sx1 and Sx2 (Sx3 and Sx4) in detail.
To do this, it is necessary to analyze T-type three-level converter operation in the
case of a switch fault. The operation conditions can be divided into the R-L load
condition and the voltage condition. The T-type three-level converter operates as an
inverter, and the P-switching state, which is a valid switching state, leads to the
current ﬂow. In the case of the RL load condition, when the P-switching state is
infeasible, current ﬂows through Sx2 as shown in Fig. 2.34. This circuit is the same
as that of the O-switching state. Although the O-switching state is not a valid
60
2
Open-Circuit Fault Detection Methods …

switching state, current ﬂows because the current is determined by the output
voltage in the R-L load condition. However, in the case of the grid-connected
condition or the motor drive condition, since the current is affected by both the
output voltage and the grid voltage or the back EMF of the motor, current does not
ﬂow if the P-switching state is infeasible as shown in Fig. 2.34.
In addition, two DC-link voltages are changed owing to the current variation of an
Sx1 open-circuit fault as shown in Fig. 2.34. The P-switching state transfers power
from two DC-link capacitors to the output under normal operation. However, an Sx1
open-circuit fault in the R-L load condition leads the current ﬂow through the
neutral-point and it ﬂows from the bottom capacitor. This means that Sx1 open-circuit
faults cause different voltage variations in both of the DC-link capacitors.
Sx2 open-circuit faults make the O-switching state infeasible which is not a valid
switching state. Therefore, it generates current directly and just operates as a
freewheeling path for the current. The current generated by a valid switching state
ﬂows continuously through Dx4 when an Sx2 open-circuit fault occurs. Sx2
open-circuit faults makes the same current ﬂow, as shown in Fig. 2.35, regardless
of the condition of the load (R-L or voltage). DC-link voltage variation is also
generated by Sx2 open-circuit faults. The current ﬂows through the neutral-point
and it ﬂows to the bottom capacitor which is the opposite situation when compared
to Sx1 open-circuit faults.
Using the change of the two capacitor voltages, a faulty switch can be identiﬁed
between switch Sx1 and switch Sx2 or between switch Sx3 and switch Sx4. If Vdc1 is
bigger than Vdc2, the open-switch fault occurs in switch Sx1 or switch Sx3.
Reversely, if Vdc2 is larger than Vdc1, the open-switch fault occurs in switch Sx2 or
switch Sx4.
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Load(RL)
Sx1 Open-switch fault
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Load (Grid/Motor)
No path
Normal
Vtop
Vbottom
Vtop
Vbottom
Vtop
Vbottom
Fig. 2.34 Current path of a T-type three-level converter with an Sx1 open-circuit fault during the
P switching state
2.4
Switch Open-Circuit Fault Detection Method …
61

To improve accuracy, the threshold value Vthr is set. It is expressed as:
Vtop  Vbottom [ Vthr :
Vtop  Vbottom\  Vthr :
Vthr\Vtop  Vbottom\Vthr :
Vx ¼ 1
Vx ¼ 1
Vx ¼ 0
ð2:16Þ
C. Experimental results of switch open-circuit fault detection in T-type three-level
inverters
The steps for the fault diagnosis of T-type three-level inverters is as follows.
(1) Calculate the average of the normalized phase currents.
(2) Using these values, identify the faulty leg and whether the open-switch faults
occur in one of the two switches Sx1 and Sx2 or in one of the two switches Sx3
and Sx4.
(3) Identify the location of the faulty switch between Sx1 and Sx2 or between Sx3
and Sx4 using the change of the two capacitor voltages. Values of the diag-
nostics variables are shown in Table 2.9.
Figure 2.36 shows experimental results of the proposed fault diagnosis method
under the parameters of Table 2.8 when an open-switch fault occurs in switches Sa1,
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Load(RL)
Sx2 Open-switch fault
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Load(Grid/Motor)
Normal
Vtop
Vbottom
Vtop
Vbottom
Vtop
Vbottom
Fig. 2.35 Current path of a T-type three-level converter with an Sx2 open-circuit fault during the
O switching state
Table 2.8 Experimental parameters
DC-link voltage
200 V
Fundamental frequency
60 Hz
Control period
100 ls
Load
10 mH, 10 Ω
Switching period
10 kHz
Ithr, Vthr
0.08, 10 V
62
2
Open-Circuit Fault Detection Methods …

Sa2, Sa3, and Sa4, respectively. After the fault, the phase current is distorted, and the
upper capacitor voltage becomes larger than the lower capacitor voltage as dis-
cussed in the previous analysis. The faulty switch is detected within 30 ms. In all of
the cases, the faulty switch is identiﬁed accurately in about 50 ms. More time is
needed to detect the fault switch when an open-switch fault occurs in neutral-point
Table 2.9 Values of the diagnostics variables
Fault position
Diagnosis variables
Ua
Ub
Uc
Vx
Sa1
−1
+1
–
+1
Sa2
−1
+1
–
−1
Sa3
+1
−1
–
+1
Sa4
+1
−1
–
−1
Sb1
–
−1
+1
+1
Sb2
–
−1
+1
−1
Sb3
–
+1
−1
+1
Sb4
–
+1
−1
−1
Sc1
+1
–
−1
+1
Sc2
+1
–
−1
−1
Sc3
−1
–
+1
+1
Sc4
−1
–
+1
−1
Fig. 2.36 Experiment results of the proposed fault diagnosis method (reprinted from [6],
Figs. 26–29)
2.4
Switch Open-Circuit Fault Detection Method …
63

switches (Sx2 or Sx3) than when an open-switch fault occurs in half-bridge switches
(Sx1 or Sx4). This is because the phase currents are less distorted in the
neutral-switch fault case than those of the half-bridge switch fault case. This
diagnosis time is closely related to the magnitude of the phase current, the size of
the capacitor, and the threshold value. Experimental results show that the proposed
fault diagnosis method precisely detects the faulty switch.
2.5
Switch Open-Circuit Fault Detection Method
for T-Type Three-Level Rectiﬁers
2.5.1
Switch Open-Circuit Fault Detection Method Using
Current Distortion
A. Analysis of T-type rectiﬁers in the presence of an open-switch fault.
Depending on the operating state and current direction, there are six paths as
shown in Fig. 2.37. In the rectiﬁer, almost all of the current is generated when the
operating state is O, and the current continuously ﬂows through a diode if the
operating state is changed to P or N. This means that the infeasibility of the
O-operating state leads to the zero current regardless of the P-operating state.
There are three paths when the current is positive. In the positive current part,
most of the current of the rectiﬁer which has a unity power factor, ﬂows through
paths (a) and (b). Therefore, the range of a-path (c) is small compared to ranges of
paths (a) and (b). Hence, an Sx3 open-switch fault in the O-operating state is fatal to
rectiﬁer operation and causes current distortion. On the other hand, an Sx1
open-switch fault does not cause current distortion in the P-operating state because
the current ﬂows through a diode. In the N-operating state, the current ﬂows
through Sx4. An Sx4 open-switch fault has little effect on the current when the
rectiﬁer is operated with a unity power factor. In addition, Sx1 also does not affect
the current in the negative current part.
B. Current distortion of T-type three-level rectiﬁers in the grid-connected
condition [7]
Figure 2.38a shows the current, DC-link voltage, and pole voltage when an Sa2
open-switch fault occurs. The Sa2 open-switch fault has a fatal effect on the input
current. In the negative current part, the valid O-operating state, which is shown in
Fig. 2.37e, becomes impossible. Therefore, the whole negative current cannot be
generated. Moreover, the DC-link voltage is largely changed. The negative current
of Fig. 2.38a is caused by the decreased DC-link voltage. When the DC-link
voltage is lower than the line-to-line peak voltage of the grid, the current can ﬂow
into the DC-link capacitor from the grid through the diodes of the rectiﬁer.
64
2
Open-Circuit Fault Detection Methods …

Although the P-operating state is possible, current does not ﬂow because P is not
a valid operating state. The pole voltage of Fig. 2.38a does not have meaning in the
negative current part. This is because, when the input voltage is a valid operating
state O, the rectiﬁer inner circuit can be an open circuit by an Sa2 open-switch fault
Fig. 2.40.
Figure 2.38b shows the current, DC-link voltage and pole voltage when an Sa3
open-switch fault occurs. Like an Sa2 open-switch fault, a valid operating state is
impossible. Therefore, an Sa3 open-switch fault makes the positive current zero for
some parts and causes DC-link voltage ripple. Open-switch faults of Sa2 and Sa3 in
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
(b) Switching state O
(a) Switching state P
(c) Switching state N
Rectifier mode
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
Dx2
Sx2
Sx3
Dx3
Dx1
Sx1
Sx4
Dx4
(e) Switching State O
(f) Switching state N
(d) Switching state P 
Rectifier mode
Fig. 2.37 Current paths depending on the current direction and operating state
2.5
Switch Open-Circuit Fault Detection Method …
65

the b-phase and c-phase legs cause the same current distortion as those of the
a-phase leg.
To detect all of the open-switch faults without additional devices, current shapes
should be considered. The input current angle is the same as the grid voltage angle
with a unity power factor. Therefore, the grid voltage angle is used to detect
open-switch faults.
Fig. 2.38 Rectiﬁer waveforms: Ia, Vdc, Vline-to-line,peak, and Vaz: a Sx2, b Sx3 (reprinted from [7],
Figs. 5, 6)
66
2
Open-Circuit Fault Detection Methods …

By using the measured grid voltages, the d-axis and q-axis voltages are calcu-
lated as:
Eds ¼ 2Ea  Eb  Ec
3
Eqs ¼ Eb þ Ec
ﬃﬃﬃ
3
p
ð2:17Þ
By using the d-axis and q-axis voltages, the grid voltage angle is calculated as:
h ¼ tan1ðEqs
Eds
Þ
ð2:18Þ
A calculated angle (h) of (2.18) is more accurate than the angle from the grid
current because the grid voltage always has a large value. Depending on an position
of the open-switch fault, the angle value which makes the current zero is different.
Figure 2.39 shows the angle range with zero current depending on the position of
an open-switch fault. The zero current range is changed by the DC-link capacitor
and load current. A large DC-link capacitor decreases the DC-link voltage change
and keeps the DC-link voltage higher than the grid rectiﬁer voltage for a long time.
This means that the zero current range is expanded. On the other hand, a small
DC-link capacitor reduces the zero current range. A large load current also reduces
the zero current range because a large current ﬂows of the load from the DC-link
capacitor. However, the start angle value of the zero current range is always the
same regardless of the DC-link capacitor value and load current. When an Sa2
open-switch fault occurs, zero current is generated from the angle value p/2. In an
Sa3 open-switch fault, the current becomes zero from the angle value 3p/2.
(a) Sa2 open-switch fault
(b) Sa3 open-switch fault
Fig. 2.39 Angle value with zero current according to the position of an open-switch fault in the
a-phase leg (reprinted from [7], Fig. 7)
2.5
Switch Open-Circuit Fault Detection Method …
67

Through considerations of b-phase and c-phase current distortions, the start
angle values which lead to zero current are deﬁned as shown in Fig. 2.40. To detect
the position of an open-switch fault, the angle value and differential equation for
each of the currents are used, and the differential equation is deﬁned as:
DI ¼ dIx
dt ¼ Ix½n  Ix½n  1
Tfault
;
x ¼ a;
x ¼ b;
x ¼ c;
h ¼ p=2  2p=3; 3p=2  5p=3
h ¼ p=6  p=2; 7p=6  4p=3
h ¼ 5p=6  p; 11p=6  2p
8
<
:
ð2:19Þ
where Tfault is a period of the differential equation and Ix (x = a, b, c) is the
measured current. The proposed detection method monitors open-switch faults for
the p/6 range from each start angle value.
The derivative value of the current at the detection angle range becomes zero
when an open-switch fault occurs because the slope of the current is steepest at the
zero crossing point of the current. The derivative value of the current has its largest
value at the zero crossing point of the normal current. Therefore, if an open-switch
fault occurs, a dramatic change can be observed because the current and the
derivative value of the current become zero at the zero crossing point of the current.
Consequently, the proposed open-switch detection method uses the current value
and grid angle as shown in Table 2.10. Moreover, a block diagram of the sum-
marized open-switch fault detection method is shown in Fig. 2.41. For the ﬁnal
decision determination of an open-switch fault, both of the fault alarms 1 and 2
have to be generated, which means that the input current has a smaller value than
Fig. 2.40 Detection angle values according to the position of an open-switch fault in all of the
phases (reprinted from [7], Fig. 8)
68
2
Open-Circuit Fault Detection Methods …

the boundary value (0.2), and the derivative value of the current is smaller than the
boundary value (0.5).
In the discussed open-switch fault detection method, the boundary values of the
current and the differential equation of the current are important factors in the
performance of the open-switch fault detection. Ideally, an open-switch fault causes
the result of (2.19) to be 0 for some part of the current. Therefore, an open-switch
fault can be detected when the result of (2.19) is 0. In such a case, the boundary
values can be chosen as 0. However, boundary values should be used, excluding 0,
because currents contain ripple and noise components. Selecting boundary values
Fig. 2.41 Block diagram of the proposed detection method for a T-type rectiﬁer (reprinted from
[7], Fig. 9)
Table 2.10 Open-switch fault detection table
Detection angle range
p/6 * p/3
p/2 * 2p/3
5p/6 * p
7p/6 * 4p/3
3p/2 * 5p/3
11p/6 * 2p
Detection
boundary value
|Ib| < A,
|dIb/dt| < B
|Ia| < A,
|dIa/dt| < B
|Ic| < A,
|dIc/dt| < B
|Ib| < A,
|dIb/dt| < B
|Ia| < A,
|dIa/dt| < B
|Ic| < A,
|dIc/dt| < B
Detection switch
Sb3
Sa2
Sc3
Sb2
Sa3
Sc2
Table 2.11 Simulation and experimental results
DC-link voltage
150 V
Grid line-to-line voltage
150 Vrms
DC-link capacitor
550 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
Load
33.3 Ω
Control period
100 us
A, B
0.5, 0.2
2.5
Switch Open-Circuit Fault Detection Method …
69

for currents should consider the current ripple, and this value should be larger than
the current ripple. However, a very large boundary.
C. Experimental results of switch open-circuit fault detection in T-type three-level
rectiﬁers
Fig. 2.42 Currents and fault detection signal depending on the open-switch fault position
(reprinted from [7], Fig. 16)
70
2
Open-Circuit Fault Detection Methods …

(20 V/div)
(10 A/div)
Vdc
Ia
Fault detection signal
Ib
(2 /div)
(20 ms/div)
(a) Sa2 open-switch fault
(20 V/div)
(10 A/div)
Vdc
Ia
Ib
(2 /div)
(20 ms/div)
Fault detection signal
(b) Sa3 open-switch fault
Fig. 2.43 Experimental results of open-switch fault detection (reprinted from [7], Fig. 21)
2.5
Switch Open-Circuit Fault Detection Method …
71

The steps for the fault diagnosis of T-type three-level rectiﬁers
(1) Calculate the grid angle using (2.18).
(2) During 60° from the six points shown in Fig. 2.40, calculate (2.19).
(3) Determine the position of the switch open-circuit fault with Table 2.10.
The simulation and experiment was implemented under the parameter of
Table 2.11.
Figure 2.42 shows the input currents, fault detection angle, fault detection signal,
and derivation of the current ﬂowing through a leg that contains a fault switch. The
open-switch fault occurs at 0.4 s, and the fault detection signal has a value of 1, 2,
3, 4, 5, and 6 depending on the position of the open-switch fault. The fault detection
signal is generated by the rule of Table 2.10. In Fig. 2.42a, the fault detection signal
becomes 1 when the a-phase current and the derivation of this current go into the
boundary value at the detection angle p/2 of Table 2.10. The ﬁgures shown in
Fig. 2.42b–f, also show the open-switch fault detection process. An open-switch
fault of all the switches is detected in a period of the grid frequency (60 Hz)
regardless of the position of the open-switch fault.
Figure 2.43a, b show the input currents (Ia and Ib), DC-link voltage, and fault
detection signal when Sa2 and Sa3 open-switch faults occur. The a-phase input
current Ia becomes zero at some part of the negative current due to the Sa2
open-switch fault in Fig. 2.43. When an Sa3 open-switch fault occurs, the a-phase
input current Ia in some part of the positive current becomes zero. The DC-link
voltage has a ripple, as shown in Fig. 2.43a, b, and this value is 16 V. The
open-switch fault detection method identiﬁes the open-switch fault and the position
of the fault switch. The fault detection signal becomes 1, which means that the
open-switch fault position is Sa2. The fault detection signal becomes 2 after an Sa3
open-switch fault occurs as shown in Fig. 2.43b. These results are the same as those
obtained in simulations.
References
1. Ribeiro, R.L.A., C.B. Jacobina, E.R.C. Silva, and A.M.N. Lima. 2003. Fault detection of
open-switch damage in voltage-fed PWM motor drive systems. IEEE Transaction on Power
Electronics 18 (2): 587–593.
2. Ribeiro, R.L.A., C.B. Jacobina, E.R.C. Silva, and A.M.N. Lima. 2004. Fault-tolerant
voltage-fed PWM inverter AC motor drive systems. IEEE Transaction on Industrial
Electronics 51 (2): 439–446.
3. Kim, T.J., W.C. Lee, and D.S. Hyun. 2009. Detection method for open-circuit fault in
neutral-point-clamped inverter systems. IEEE Transaction on Industrial Electronics 56 (7):
2754–2763.
4. Choi, U.M., H.G. Jeong, K.B. Lee, and F. Blaabjerg. 2012. Method for detecting an
open-switch fault in a grid-connected npc inverter system. IEEE Transaction on Power
Electronics 27 (6): 2726–2739.
72
2
Open-Circuit Fault Detection Methods …

5. Ko, Y.J., K.B. Lee, D.C. Lee, and J.M. Kim. 2012. Fault diagnosis of three-parallel
voltage-source converter for a high-power wind turbine. IET Power Electronics 5 (7):
1058–1067.
6. Choi, U.M., K.B. Lee, and F. Blaabjerg. 2014. Diagnosis and tolerant strategy of an
open-switch fault for T-type three-level inverter systems. IEEE Transactions on Industry
Applications 50 (1): 495–508.
7. Lee, J.S., and K.B. Lee. 2014. An open-switch fault detection method and tolerance controls
based on SVM in a grid-connected T-type rectiﬁer with unity power factor. IEEE
Transactions on Industrial Electronics 61 (12): 7092–7104.
8. Lee, J.S., K.B. Lee., and F. Blaabjerg. 2015. Open-switch fault detection method of a
back-to-back converter using NPC topology for wind turbine systems. IEEE Transaction on
Industrial Electronics 51 (1): 325–335.
9. Choi, U.M., F. Blaabjerg, and K.B. Lee. 2015. Reliability improvement of a T-type
three-level inverter with fault-tolerant control strategy. IEEE Transaction on Power
Electronics 30 (5): 2660–2673.
10. Choi, U.M., F. Blaabjerg, and K.B. Lee. 2015. Study and handling methods of power IGBT
module failures in power electronic converter systems. IEEE Transaction on Power
Electronics 30 (5): 2517–2533.
11. Choi, U.M., J.S. Lee, F. Blaabjerg, and K.B. Lee. 2016. Open-circuit fault diagnosis and
fault-tolerant control for a grid-connected NPC inverter. IEEE Transactions on Power
Electronics 31 (10): 7234–7247.
12. Lee, J.S., and K.B. Lee. 2015. Open-switch fault tolerance control for a three-level
NPC/T-type rectiﬁer in wind turbine systems. IEEE Transactions on Industrial Electronics 62
(2): 1012–1021.
References
73

Chapter 3
Three-Level Converter Tolerant Control
for Switch Faults
In power conversion systems, tolerant control can be deﬁned as control for per-
forming fundamental functions even if a fault occurs. Performance mitigation can
be shown by tolerant control. However, the basic function of transferring power
should be achieved. Managers and operators can prepare for secondary problems by
using tolerant control. For example, blade accidents caused by the emergency stop
of a WTS can be avoided.
Tolerant control for three-level converters can be divided into two cases which
are those equipped with or without additional devices. Tolerant controls with
additional switches can provide a solution for short-circuit faults or both short and
open-circuit faults. Modiﬁed topologies adding an extra leg shown in Fig. 3.1 are
typical among tolerant controls with additional switches, In these topologies, the
extra leg operates instead of a leg containing a fault switch. However, adding
switches or devices is a major drawback. It results in increases in both size and
price, and requires additional circuits such as gate drivers and sensors.
On the other hand, tolerant controls for open-circuit faults of a switch can be
realized without additional devices and they can ensure normal operation without
the use of the fault switch.
The tolerant control for Sx2 and Sx3 open-circuit faults explained in chapter 3 can
be applied to three-level converter regardless of the operation mode (rectiﬁer mode
or inverter mode). This is due to the fact that the infeasible vectors caused by switch
open-circuit faults are the same in both operation modes.
In Sect. 3.1, tolerant controls with additional devices will be explained brieﬂy. In
Sect. 3.2, several tolerant controls, which do not use the additional devices, will be
explained in detail.
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_3
75

3.1
Three-Level Converter Tolerant Control in Topology
Modiﬁcations
3.1.1
Tolerant Control with Six Thyristors [1]
Figure 3.2 shows a modiﬁed three-level converter topology with six thyristors. Two
thyristors in parallel are located between the neutral-point and output point on each
leg. The tolerant control can be implemented simply. If an open-circuit fault or
short-circuit fault occurs, all of the IGBTs of the leg containing the fault switch do
not operate and the two thyristors of the leg become ON. This means that the output
of the leg only has the O-switching state. Since the P- or N-switching states cannot
be generated in the tolerant control of the modiﬁed topology, the feasible output
voltage range of the NPC three-level converter is reduced and limited to half. The
limited output voltage range is a critical disadvantage in the tolerant control. If this
topology is used in a grid-connected system, this topology cannot provide a solu-
tion for switch faults depending on the operating conditions although six thyristors
are added to conventional NPC three-level topology.
3.1.2
Tolerant Control with an Additional Leg
and Thyristors [2]
Figure 3.3 shows a modiﬁed three-level converter. This topology adds an additional
leg to the conventional NPC three-level converter and six thyristors are added to
+
−
+
−
Sa1
Sa2
Sa3
Sa4
Da1
Da2
Da3
Da4
Sb1
Sb2
Sb3
Sb4
Db1
Db2
Db3
Db4
Sc1
Sc2
Sc3
Sc4
Dc1
Dc2
Dc3
Dc4
Se1
Se2
Se3
Se4
De1
De2
De3
De4
De5
De6
D1
D2
D3
D3
D5
D6
dc
V
2
dc
V
2
Z
Fig. 3.1 Basic tolerant control topology with an addition leg
76
3
Three-Level Converter Tolerant Control for Switch Faults

help the operation of the additional leg. The tolerant control of this topology is also
simple. If an open-circuit fault or short-circuit fault occurs all of the IGBTs of the
leg containing the fault switch do not operate. The two thyristors connected
between the leg and the additional leg become ON and the additional leg operates
instead of the leg containing the fault switch. Unlike the tolerant control shown in
Fig. 3.2, this topology makes the whole output voltage range, which is the main
beneﬁt of the topology with an additional leg. However, several switching devices
are used for conﬁguring the additional leg and a lot of thyristors are used in this
+
−
+
−
Sa1
Sa2
Da1
D1
Sa3
Sa4
Da2
Da3
Da4
Sb1
Sb2
Sb3
Sb4
Db1
Db2
Db3
Db4
Dc1
Dc2
Dc3
Dc4
Sc1
Sc2
Sc3
Sc4
D2
D3
D3
D5
D6
dc
V
2
dc
V
2
Z
Fig. 3.2 The modiﬁed three-level converter topology with six thyristors (drawn from Ref. [1],
Fig. 8)
+
−
+
−
Sa1
Sa2
Sa3
Sa4
Da1
Da2
Da3
Da4
Se1
Se2
Se3
Se4
De1
De2
De3
De4
De5
De6
D1
D2
dc
V
2
dc
V
2
D3
D4
D5
D6
Sb1
Sb2
Sb3
Sb4
Db1
Db2
Db3
Db4
Sc1
Sc2
Sc3
Sc4
Dc1
Dc2
Dc3
Dc4
Z
Fig. 3.3 The modiﬁed three-level converter topology with an additional leg and thyristors (drawn
from Ref. [2], Fig. 1)
3.1
Three-Level Converter Tolerant Control …
77

topology. Therefore, the large number of switching devices required in this
topology are its main drawback.
3.1.3
Tolerant Control with Six Additional Switches [3]
Figure 3.4 shows a modiﬁed NPC three-level converter with six additional
switches. Compared to the previous topologies, this topology only takes into
account the short-circuit faults. In the tolerant control of this topology, the addi-
tional switches operate to prevent the occurrence of short circuits through DC-link
and Sx1–Sx3 (or Sx2–Sx4). If an Sx1 or Sx2 short-circuit fault occurs, Sx6 turns OFF.
If and Sx3 or Sx4 short-circuit fault occurs, Sx5 turns OFF. By this tolerant control,
the leg containing the fault switch is completely disconnected from the
neutral-point. Therefore, the O-switching state cannot be generated and only the P-
or N-switching state is used to make the output voltage. This tolerant control can
operate like the normal operation. However, the output voltage/current THD is
increased and the efﬁciency is decreased because of the absence of the O-switching
state in the output voltage of the leg containing the fault switch.
+
−
+
−
Fuse
Fuse
Fuse
Fuse
Fuse
Fuse
Sa1
Sa2
Sa3
Sa4
Sb1
Sb2
Sb3
Sb4
Sc1
Sc2
Sc3
Sc4
Da1
Da2
Da3
Da4
Db1
Db2
Db3
Db4
Dc1
Dc2
Dc3
Dc4
Sa5
Sa6
Sb5
Sb6
Sc5
Sc6
D1
D2
D3
D4
D5
D6
dc
V
2
dc
V
2
Z
Fig. 3.4 The modiﬁed three-level converter topology with an additional six switches (drawn from
Ref. [3], Fig. 5)
78
3
Three-Level Converter Tolerant Control for Switch Faults

3.1.4
Other Tolerant Control Topologies
Various topologies for tolerant control operation are shown in Figs. 3.5, 3.6, and 3.7
[3]–[5]. Like the previous topologies, the fault switch is isolated and additional
devices operate to maintain normal operation.
+
−
+
−
Sa1
Sa2
Sa3
Sa4
Sb1
Sb2
Sb3
Sb4
Sc1
Sc2
Sc3
Sc4
D1
D2
D3
D4
D5
D6
Z
dc
V
2
dc
V
2
Fig. 3.5 Topology with twelve thyristors (drawn from Ref. [4], Fig. 4)
+
−
+
−
Fuse
Fuse
Fuse
Fuse
Fuse
Fuse
Sa1
Sa2
Sa3
Sa4
Sb1
Sb2
Sb3
Sb4
Sc1
Sc2
Sc3
Sc4
Da1
Da2
Da2
Da2
Db1
Db2
Db2
Db2
Dc1
Dc2
Dc2
Dc2
D1
D2
D3
D4
D5
D6
dc
V
2
dc
V
2
Z
Fig. 3.6 Topology using additional diodes and thyristors (drawn from Ref. [3], Fig. 3)
3.1
Three-Level Converter Tolerant Control …
79

3.2
Three-Level Converter Tolerant Control Using
Modiﬁcations of the Switching Method
In this chapter, several tolerant controls, which do not use additional devices, are
introduced. Tolerant control should operate closely with a switch fault detection
algorithm. Under the assumption that the switch fault detection algorithms intro-
duced in previous chapter is used with the tolerant control, this chapter focuses on
tolerant control for the open-switch faults.
Fig. 3.7 Topology with the special additional leg (reprinted from Ref. [5], Figs. 11 and 12)
80
3
Three-Level Converter Tolerant Control for Switch Faults

3.2.1
Open-Circuit Faults in NPC Three-Level and T-Type
Three-Level Converters
NPC three-level converters are vastly different from T-type three-level converters in
terms of the structure. Depending on the position of an open-switch fault, the
infeasible switching states are determined, and are shown in Table 3.1 [6, 7].
In both topologies, the infeasible switching state cases due to Sx1 and Sx4
open-circuit faults are the same. This means that the tolerant control for Sx1 and Sx4
open-circuit faults can be applied in both topologies. However, Sx2 and Sx3
open-circuit faults show different characteristic in both topologies. NPC three-level
converters make the O- and P- (or N-) switching states infeasible. However, only
O-switching state is infeasible in T-type three-level converters. This makes a big
difference in developing tolerance control without additional devices. When the O-
and P- (or N-) switching states are infeasible, like in the case of NPC three-level
converters, the leg containing the open-circuit fault cannot make positive output
voltage. This means that the tolerant control deﬁnitely needs additional devices.
However, in the case of T-type three-level converters, Sx2 and Sx3 open-circuit
faults just effect that O-switching state. Therefore, in the tolerant control, the output
voltage is conﬁgured without the use of the O-switching state.
Consequently, some tolerant controls for three-level converters can be applied to
both topologies. However, due to structural differences, unique tolerant control for
only one topology can exist.
Table 3.1 Feasible and infeasible switching state of three-level converter depending on position
of open-switch fault
Position of
open-switch
fault
NPC three-level converter
T-type three-level converter
Feasible
switching state
Infeasible
switching state
Feasible
switching state
Infeasible
switching state
Sx1
N (Fig. 2.9c, f)
O (Fig. 2.9b, e)
P (Fig. 2.9a)
P (Fig. 2.9d)
N (Fig. 2.32c, f)
O (Fig. 2.32b, e)
P (Fig. 2.32a)
P (Fig. 2.32d)
Sx2
N (Fig. 2.9c, f)
O (Fig. 2.9b)
P (Fig. 2.9a)
P (Fig. 2.9d)
O (Fig. 2.9e)
N (Fig. 2.32c, f)
O (Fig. 2.32b)
P (Fig. 2.32a, d)
O (Fig. 2.32e)
Sx3
N (Fig. 2.9f)
O (Fig. 2.9e)
P (Fig. 2.9a, d)
N (Fig. 2.9c)
O (Fig. 2.9b)
N (Fig. 2.32c, f)
O (Fig. 2.32e)
P (Fig. 2.32a, d)
O (Fig. 2.32b)
Sx4
N (Fig. 2.9f)
O (Fig. 2.9b, e)
P (Fig. 2.9a, d)
N (Fig. 2.9c)
N (Fig. 2.32f)
O (Fig. 2.32b, e)
P (Fig. 2.32a, d)
N (Fig. 2.32c)
3.2
Three-Level Converter Tolerant Control Using …
81

3.2.2
Tolerant Control for Sx2 and Sx3 Open-Circuit Faults
As mentioned before, in NPC three-level converters, Sx2 (or Sx3) open-circuit faults
make both the O- and P- (or N-) switching states infeasible. Therefore, it is
impossible to realize tolerant control without additional devices. On the other hand,
T-type converters give the chance to apply tolerant control. In particular, when a
T-type converter operates in the rectiﬁer mode, Sx1 and Sx4 open-circuit faults
cannot effect the output current. Therefore, only Sx2 and Sx3 open-circuit faults are
normally taken into account in the tolerant control of T-type rectiﬁers.
Fig. 3.8 shows the space vector diagram where all of vectors are available in
T-type three-level converters. Sx2 open-circuit faults make the O-switching state
infeasible. Although an Sx2 open-circuit fault occurs, there is no effect on the output
current if the current ﬂows from the output to the DC-link (rectiﬁer mode) because
the current ﬂows through Dx2 not Sx2. Based on this result, Fig. 3.9 shows a space
vector diagram of a three-level converter, which contains the infeasible vectors
caused by an Sa2 open-circuit fault. Vectors with the O-switching vector of the
a-leg, where Sa2 open-circuit fault has inﬂuence, cannot be generated. [OPN],
[ONP], [OPO], [OPP], [OPO] and [OOO] cannot be generated due to the presence
of an Sa2 open-circuit fault. In the tolerant control of Sx2 and Sx2 open-circuit faults,
the output voltage is conﬁgured without the infeasible voltage vectors of Fig. 3.9.
Fig. 3.8 Space vector diagram of three-level converter
82
3
Three-Level Converter Tolerant Control for Switch Faults

A. Replacement Two-Level Switching Tolerance Control (R2LS-TC) [8].
An Sa2 open-switch fault causes two medium-vectors (OPN, ONP), three
small-vectors (OPO, OPP, OOP), and one zero vector (OOO) to be infeasible when
the a-phase current is negative. Therefore, in R2LS-TC, without using these
infeasible vectors, the Two-Level Switching Method (2-LSM) using large vectors
(NPN, NPP, NNP, PNP) which use the structure of three-level topology shown in
Fig. 3.10 is implemented in sectors II–V as shown in the gray parts of Fig. 3.11 and
Three-Level Switching Method (3-LSM) is conducted in the rest of sector.
R2LS-TC replaces 3-LSM with 2-LSM in several sectors when an Sa2 open-switch
occurs. This tolerance control can be applied in the entire modulation index range.
Moreover, consideration of neutral-point voltage balancing is not required because
large vectors do not cause the neutral-point voltage unbalancing [23]. However, the
input current ripple of each phase increases in the sectors, where the 2-LSM is
applied, owing to the use of large vectors in 2-LSM. For an Sa3 open-switch fault,
2-LSM is applied in sectors I, II, V, and VI.
The Replacement Two-Level Switching (R2LS) tolerance control for Sx2 and Sx3
(x = a, b, c) open-switch faults is shown in Table 3.2.
OPN
Ia (DC-link
output)
Ia (DC-link
output)
OPP
OOP
OPO
OOO
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
1
2
3
4
NNN
PPP
POO
ONN
PPO
OON
POP
ONO
NON
NOO
NNO
PNN
PON
PPN
NPN
NPO
NPP
NOP
NNP
ONP
PNP
PNO
13
V
1
V
0
V
2
V
3
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(1/ 3)Vdc
(1/3)Vdc
(2/3)Vdc
Fig. 3.9 Space vector diagram of three-level converter when Sa2 open-circuit fault occurs
3.2
Three-Level Converter Tolerant Control Using …
83

• Simulation and experimental results for R2LS-TC.
Simulation parameters are as follows: the rated power is 1.5 kW, the grid
line-to-line voltage is 127 Vrms, the grid frequency is 60 Hz, the L-ﬁlter value is 1
mH, the DC-link voltage is 200 V, the DC-link capacitor is 1100 lF, the load is
Vdc1
Vdc2
+
−
+
−
Sc1
Sc2
Sc4
Dc1
Dc4
Db1
Da1
Sb1
Sa1
Sb4
Sa4
Da4
Db4
C2
C1
Sc3
Dc2
Dc3
Db2
Sb2
Sb3
Db3
Sa3
Sa2
Da2
Da3
Vdc1
Vdc2
+
−
+
−
Sc1
Sc4
Dc1
Dc4
Db1
Da1
Sb1
Sa1
Sb4
Sa4
Da4
Db4
C2
C1
Sc2
Z
Sc3
Dc2
Dc3
Db2
Sb2
Sb3
Db3
Sa3
Sa2
Da2
Da3
Fig. 3.10 Conﬁguration of two-level converter and T-type three-level converter
Fig. 3.11 R2LS-TC for Sa2 open-switch fault (reprinted from Ref. [6], Fig. 7)
84
3
Three-Level Converter Tolerant Control for Switch Faults

33.3 X, the switching frequency is 10 kHz, and the control period is 100 us. They
are listed in Table 3.3
Figure 3.12 shows the pole voltage and current waveforms of tolerance controls
when an Sa2 open-switch occurs. The R2LS-RC restores the distorted input currents
after 0.5 s. The R2LS-TC makes the pole voltage of three-phase as two levels (Vdc/2
and −Vdc/2).
R2LS-TC replaces 3-LSM with 2-LSM in four Sectors as shown in the exper-
imental result of Fig. 3.13. Therefore, the DC-link voltage ripple and the difference
between the top voltage and the bottom voltage (Vdif), which are 0.5 V and 0.3 V,
respectively, are small because 2-LSM does not cause any unbalance of the
neutral-point voltage.
B. Maintenance Three-Level Switching Tolerance Control (M3LS-TC) [8].
Sx2 and Sx3 open-switch faults cause a large current distortion and DC-link
voltage ripple. NPC-type rectiﬁers cannot remove current distortion completely due
to structural limitations. However, T-type rectiﬁer can restore the current distorted
by an open-switch fault. Two methods for the tolerance control are proposed based
on the SVM.
For an explanation of tolerance control, an Sa3 open switch fault is considered as
an example.
In the positive current part, the O-operating state is impossible in the presence of
an Sa3 open-switch fault. This means that OOO, OPN, OON, ONN, ONO, and
ONP, which contain the O-operating state in the a-phase input voltage, in the right
half plane of Fig. 3.14, cannot be made.
In sectors II and V, a two-level switching method is applied because the medium
vectors OPN and ONP are impossible. A T-type rectiﬁer can be operated as a
Table 3.2 R2LS-TC depending on the position of open-switch fault
Position of open switch
fault
Applied switching method
Sector for two-level
switching
Sector for three-level
switching
Sa2
Sector II, III, IV, V
Sector I, VI
Sa3
Sector I, II, V, VI
Sector III, IV
Sb2
Sector I, IV, V, VI
Sector II, III
Sb3
Sector I, II, III, IV
Sector V, VI
Sc2
Sector I, II, III, VI
Sector IV, V
Sc3
Sector III, IV, V, VI
Sector I, II
Table 3.3 Simulation and experiment parameters
DC-link voltage
200 V
Line-to-line voltage
127 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
L-ﬁlter
1 mH
Control period
100 ls
Load
33.3 Ω
3.2
Three-Level Converter Tolerant Control Using …
85

two-level rectiﬁer by stopping the operation of Sx2 and Sx3. To make the input
voltage, NPN, PPN, NNN, and PPP are used in sector II. Similarly, in sector V,
NNP, PNP, NNN, and PPP are used. The two-level switching method replaces the
impossible O-operating state with the N-operating state.
In sectors I and VI, all of the impossible vectors are N-type small vectors. N-type
small vectors can be replaced with P-type small vectors. There are four segments in
sector I. Figure 3.15a shows the switching sequence in sector I-1 of Fig. 3.14 when
the rectiﬁer operates without any faults. This switching sequence consists of OON,
PON, PPN, and PPO. The switching on-times (Ta,on, Tb,on, and Tc,on) and the
switching off-times (Ta,off, Tb,off, and Tc,off) for the a-phase, b-phase, and c-phase are
expressed as:
Ta;onT7 þ T14 þ T2
2 ;
Tb;on ¼ T14 þ T2
2 ;
Tc;on ¼ T2
2
Ta;off ¼ Ts  Ta;on;
Tb;off ¼ Ts  Tb;on;
Tc;off ¼ Ts  Tc;on
ð3:1Þ
where Tx (x = 1, 2, …, 18) denotes on-times Vx.
Due to Sx3 open-switch faults, the N-type small vector, OON, is impossible in
sector I-1. OON can be changed to PPO which is a P-type small vector as shown in
Fig. 3.15b.
Fig. 3.12 Simulation results of R2LS-TC when Sa2 open fault occurs (reprinted from Ref. [6],
Fig. 13)
86
3
Three-Level Converter Tolerant Control for Switch Faults

Switching on-times for the tolerance control (Ta,on,tolerance, Tb,on,tolerance, and Tc,
on,tolerance) are simply calculated using the minimum on-time (Tmin) among Ta,on,
Tb,on, and Tc,on, and they are expressed as
Tmin ¼ Ta;on;
Tb;on;
Tc;on
½

Toffset ¼ Tmin
Tx;on;tolerance ¼ Tx;on þ Toffset; x ¼ a; b; c
ð3:2Þ
Fig. 3.13 Experimental results of R2LS-TC when Sa2 open fault occurs (reprinted from Ref. [6],
Figs. 20 and 21)
3.2
Three-Level Converter Tolerant Control Using …
87

Figure 3.16a shows the normal switching sequence in sector I-2. OON is
impossible and can be changed to PPO as shown in Fig. 3.16b. Ta,on,tolerance,
Tb,on,tolerance, and Tc,on,tolerance are calculated using (3.2).
In sector I-3, there are two impossible vectors as shown in Fig. 3.17a. The
N-type small vector, ONN, can be easily changed to the P-type small vector, PON,
using (3.2). The calculated on-times (Ta,on,new1, Tb,on,new1, and Tc,on,new1) are shown
in Fig. 3.17b. In addition, the N-type small vector, OON, should be changed to the
P-type small vector, PPO. Then the switching order becomes PPO-PON-POO-
PON-PPO as shown in Fig. 3.17c. Then the on-times are changed. Ta,on,tolerance,
Tb,on,tolerance, and Tc,on,tolerance are expressed as:
Tmax ¼ Ta;on;new1;
Tb;on;new1;
Tc;on;new1
½

Toffset2 ¼ Ts  Tmax
Tx;on;tolerance ¼ Tx;on;new1 þ Toffset2; x ¼ a; b; c
ð3:3Þ
Changing a switching order is not necessary because each of the recalculated
on-times Tb,on,tolerance and Tc,on,tolerance from (3.3) corresponds to the sums of the
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
OOO
NNN
PPP
POO
ONN
PPO
OON
POP
ONO
OPO
NON
OPP
NOO
OOP
NNO
PNN
PON
PPN
OPN
NPN
NPO
NPP
NOP
NNP
ONP
PNP
PNO
13
V
1
V
0
V
2
V
3
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(2/3)Vdc
Ia (DC-link
output)
Ia (DC-link
output)
1
2
3
4
Fig. 3.14 Space vector diagram with the Sa3 open-switch fault
88
3
Three-Level Converter Tolerant Control for Switch Faults

b-phase separated times and the c-phase separated times in Fig. 3.17c. The recal-
culated on-times are relocated to the center of Ts. Therefore, the switching order
becomes PON-POO-PPO-POO-PON.
V2N
OON
V2N
OON
V7
PON
V7
PON
V14
PPN
V14
PPN
V2P
PPO
Vaz
Vbz
Vcz
(a) Conventional PWM
Ta,on
Tb,on
Tc,on
2T
4
7T
4
2T
2
2T
4
7T
4
14
T
4
14
T
4
V7
PON
V7
PON
V14
PPN
V14
PPN
V2P
PPO
Vaz
Vbz
Vcz
(b) Tolerance control 
Ta,on,tolerance
Tb,on,tolerance
Tc,on,tolerance
7T
4
14
T
4
2T
14
T
4
7T
4
Fig. 3.15 Switching sequence in sector I-1 (reprinted from Ref. [7], Fig. 11)
3.2
Three-Level Converter Tolerant Control Using …
89

In sector I-4, the N-type vector, ONN, is impossible. ONN can be changed to the
P-type small vector, POO. Ta,on,tolerance, Tb,on,tolerance, and Tc,on,tolerance are calcu-
lated using (3.2). The same switching methods used in sector I for the tolerance
control are applied in sector VI.
V2N
OON
V2N
OON
V7
PON
V7
PON
V1P
POO
V1P
POO
V2P
PPO
Vaz
Vbz
Vcz
(a) Conventional PWM
Ta,on
Tb,on
Tc,on
2T
4
7T
2
1T
2
2T
2
1T
2
7T
2
2T
4
V7
PON
V7
PON
V1P
POO
V1P
POO
V2P
PPO
Vaz
Vbz
Vcz
(b) Tolerance control 
Ta,on,tolerance
Tb,on,tolerance
Tc,on,tolerance
7T
2
1T
2
2T
1T
2
7T
2
Fig. 3.16 Switching sequence in sector I-2 (reprinted from Ref. [7], Fig. 12)
90
3
Three-Level Converter Tolerant Control for Switch Faults

Consequently, in sectors I and VI, all of the N-type small vectors are replaced
with P-type small vectors. This causes a neutral-point voltage unbalance. Therefore,
the P-type small vectors, OPO, OPP, and OOP, in sectors III and IV should be
replaced with the N-type small vectors, NON, NOO, and NNO.
The tolerance control for Sx2 and Sx3 (x = a, b, c) open-switch faults is shown in
Table 3.4. This tolerance control maintains the characteristic of three-level topology
in four sectors as shown in Fig. 3.18. Therefore, the input current ripple is not
greatly increased. However, neutral-point voltage ripple increases because the
switching by the P-type or N-type small vectors is only continued for a half period
of the output voltage.
• Simulation and experimental results of M3LS-TC.
The performance of the M3LS tolerance control is identiﬁed in Fig. 3.19. An Sa2
open-switch fault occurs at 0.3 s as shown in Fig. 3.19a. As a result, the three phase
currents are distorted, and the DC-link voltage has a ripple of 20 V. The M3LS
tolerance control is applied at 0.4 s, and these distorted currents are restored to a
sinusoidal current. Moreover, DC-link voltage ripple is also eliminated.
V1N
ONN
V!N
ONN
V2N
OON
V2N
OON
V7
PON
V7
PON
V1P
POO
Vaz
Vbz
Vcz
Vaz
Vbz
Vcz
(b) Tolerance control (step1)
Vaz
Vbz
Vcz
V2N
PPO
V7
PON
V7
PON
V1P
POO
Vaz
Vbz
Vcz
(d) Tolerance control (complete)
(c) Tolerance control (step2)
V1P
POO
V2N
OON
V2N
OON
V7
PON
V7
PON
V1P
POO
V7
PON
V7
PON
V1P
POO
V2N
PPO
V2N
PPO
(a) Conventional PWM
Ta,on
Tb,on
Tc,on
Ta,on,tolerance
Tb,on,tolerance
Tc,on,tolerance
Ta,on,tolerance
Tb,on,tolerance
Tc,on,tolerance
Ta,on,new1
Tb,on,new1
Tc,on,new1
1T
4
1T
4
2
T
2
2
T
2
7T
2
7T
2
1T
2
2
T
2
7T
2
7T
2
2
T
2
1T
2
T
2
7T
2
7T
2
2
T
2
1T
7T
2
7T
2
1T
2
1T
2
2
T
Fig. 3.17 Switching sequence in sector I-3 (reprinted from Ref. [7], Fig. 13)
3.2
Three-Level Converter Tolerant Control Using …
91

Figure 3.19b shows the input currents and DC-link voltage when the M3LS
tolerance control is applied. When an Sa3 open-switch fault occurs, the switching
levels of the input voltages in sectors I and VI, which are the shaded parts of
Fig. 3.19b, have the characteristic of three-level topology.
Table 3.4 M3LS-TC depending on the position of an open-switch fault
Position of open-switch fault
Sa2 or Sa3
Sb2 or Sb3
Sc2 or Sc3
Sector I
OON ! PPO
ONN ! POO
Two-level switching
method
OON ! PPO
ONN ! POO
Sector II
Two-level switching
method
OON ! PPO
OPO ! NON
OON ! PPO
OPO ! NON
Sector III
OPO ! NON
OPP ! NOO
OPO ! NON
OPP ! NOO
Two-level switching
method
Sector IV
OPP ! NOO
OOP ! NOO
Two-level switching
method
OPP ! NOO
OOP ! NNO
Sector V
Two-level switching
method
OOP ! NNO
ONO ! POP
OOP ! NNO
ONO ! POP
Sector VI
ONN ! POO
ONO ! POP
ONN ! POO
ONO ! POP
Two-level switching
method
NPN
NPO
NPP
POO
PPO  PPO
PPN
OPN
ONP
ONN
POO
NOO
ONO
O
POP
O
O  PPO
OON
V*
PPO
V*
PPP
OOO
V*
NNN
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
POP
OPO
NON
OPP
OOP
NNO
PNN
PON
NOP
P
N
P
P
N
N
PNO
13
V
1
V
0
V
2
V
3
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(1/3)Vdc
(2/3)Vdc
Fig. 3.18 M3LS-TC for an Sa2 open-switch fault
92
3
Three-Level Converter Tolerant Control for Switch Faults

Figure 3.20a shows the performance of the M3LS tolerance control when an Sa3
open-switch fault occurs. The distorted input currents are restored by the M3LS
tolerance control, and the ripple due to the open-switch fault decreases. The
DC-link voltage of Fig. 3.20a has a ripple of 6.5 V, because the M3LS tolerance
control considers neutral-point balancing. In comparison with the DC-link voltage
ripple of Fig. 3.13, the DC-link voltage ripple of the R2LS tolerance control is
smaller than that of the M3LS tolerance control since the R2LS tolerance control
Fig. 3.19 Simulation results of M3LS-TC when an Sa3 open fault occurs (reprinted from Ref. [7],
Figs. 17 and 19)
3.2
Three-Level Converter Tolerant Control Using …
93

does not need to consider neutral-point balancing. However, the input current THD
of the R2LS tolerance control is larger than that of the M3LS tolerance control.
C. One Phase Two-Level Switching Tolerance Control (OP2LS-TC) [9].
For an Sa2 open-switch fault, OP2LS-TC maintains three-level switching in the
two phases that do not contain the open-switch fault, and the input voltage of the
one phase with the open-switch fault has two levels by OP2LS-TC. In order to
satisfy the operation of OP2LS-TC when an Sa2 open-switch fault occurs, for all the
sectors, the offset value is added to the switch on-time (Tx,on) of the one-phase
Fig. 3.20 Experimental results of M3LS-TC when an Sa3 open fault occurs (reprinted from Ref.
[7], Figs. 22 and 24)
94
3
Three-Level Converter Tolerant Control for Switch Faults

reference voltage, which contains the open-switch fault, to make its phase voltage
level two. This means that each Sector is divided into two parts, as shown in
Fig. 3.21, and the nearest vectors are used to generate input voltages.
To explain the modiﬁcation of the switching on-times (Ta,on, Tb,on, Tc,on), the
case of an Sa2 open fault is used as an example.
In sector II-A, the switching sequence is shown in Fig. 3.22a. When an Sa2 open
fault occurs, there are infeasible [OPN] and [OPO] vectors. The switching on-time
of the a-leg should be changed to apply the two-level switching method only to the
a-leg. The averaged output voltage for a switching period has to be equal before and
after the tolerant control is applied. As a result, the switching on-time in sector II-A
can be expressed as:
Ta;on;TC ¼ 1
2 Ta;on
ð3:4Þ
By changing the switch on-time of the a-leg in OP2LS-TC, the a-leg does not
contain the O switching state as shown in Fig. 3.22b. It only generates the P and N
switching states which is the main characteristic of the two-level switching method.
Nevertheless, the averaged output voltage is maintained at the same value by
decreasing the switching on-time by half. In addition, we can see that there are no
changes at the b-leg or c-leg.
SECTOR
SECTOR
SECTOR
SECTOR
NNN
NNN
OPO
NON
OPP
NOO
OOP
NNO
NPN
NPO
NPP
NOP
NNP
V*
SECTOR
SECTOR
OOO
POO
ONN
PPO
OON
POP
ONO
PNN
PON
PPN
OPN
ONP
PNP
PNO
V*
V*
PPP
ONN
V*
PPP
P
A
B
C
D
F
E
13
V
1
V
0
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(2/3)Vdc
Fig. 3.21 OP2LS-TC for an Sa2 open-switch fault (reprinted from Ref. [6], Fig. 12)
3.2
Three-Level Converter Tolerant Control Using …
95

The switching on-time (Ta,on) of the a-leg in sector II-B should be changed, as
shown in Fig. 3.23, to apply the two-level switching method in the a-leg containing
the open-switch fault. As in the case of sector II-A, it can be seen that by using
(3.4), the averaged output voltage of the sector II-A a-leg is maintained at the same
value.
V3N
NON
V3N
NON
V15
NPN
V15
NPN
V8
OPN
V8
OPN
V3P
OPO
Vaz
Vbz
Vcz
(a) Normal switching
Ta,on
Tb,on
Tc,on
Ts
(b) Tolerance switching
V3N
NON
V3N
NON
V15
NPN
V15
NPN
2P
PPO
Vaz
Vbz
Vcz
Ta,on,TC
Tb,on
Tc,on
V
V
14
PPN
V15
NPN
V15
NPN
V14
PPN
Ts
Ta,on/4
,
on
P
2
V
Ta,on/2
Ta,on
Fig. 3.22 Switching sequence in sector II-A (reprinted from Ref. [6], Fig. 9)
96
3
Three-Level Converter Tolerant Control for Switch Faults

In Sector II-C and II-D, the switching on-time of the a-leg is changed as shown
in Fig. 3.24 and it is expressed as:
Ta;off ¼ Ts  Ta;on
ð3:5Þ
Ta;on;TC ¼ 1
2 Ta;off þ Ta:on ¼ 1
2 ðTa;on þ TsÞ
ð3:6Þ
The changing vector of OPTL-TC depending on the sector is summarized in
Table 3.6 based on the position of an open switch fault. Like 3LSO-TC, this
tolerance control can be applied in the entire modulation index range. As mentioned
above, the input voltage of the one phase that contains an open-switch fault has two
levels and other phases maintain the three-level input voltage. Therefore, the current
ripple of only one phase increases. Nevertheless, the neutral-point balancing control
for a switching period is not performed in sectors II, III, IV, and VI, which is similar
to 3LSO-TC. The N-type small vectors or the P-type small vectors are used for
two-thirds of a fundamental period of the input current. Therefore, the neutral-point
voltage has a large ripple that has a fundamental frequency component.
• Simulation and experimental results of OP2LS-TC.
Table 3.5 shows the parameters of simulation and experiment for the M3LS-TC.
The simulation parameters are as follows: the rated power is 1.5 kW, the grid
line-to-line voltage is 127 Vrms, the grid frequency is 60 Hz, the L-ﬁlter value is 1
mH, the DC-link voltage is 200 V, the DC-link capacitor is 1100 lF, the load is
33.3 X, the switching frequency is 10 kHz, and the control period is 100 us. They
are shown in Table 3.7.
OP2LS-TC makes the a-phase pole voltage into two levels in all of the sectors.
The b-phase and c-phase have three-level pole voltages as shown in Fig. 3.25.
V3N
NON
V3N
NON
V2N
OON
V2N
OON
V8
OPN
V8
OPN
V3P
OPO
Vaz
Ta,on
V3N
NON
V3N
NON
V15
NPN
2P
PPO
Vaz
Ta,on,TC
V14
PPN
V
V
14
PPN
Ta,on/2
Ta,on
V15
NPN
V3N
NON
V3N
NON
n
P
2
V
Ta,on/4
Fig. 3.23 Switching sequence of tolerance control in sector II-B (reprinted from Ref. [6], Fig. 10)
3.2
Three-Level Converter Tolerant Control Using …
97

V2N
OON
V2N
OON
V8
OPN
V8
OPN
V3P
OPO
V3P
OPO
V2P
PPO
Vaz
(a) Sector -C
Ta,on
V3N
NON
V3N
NON
V14
PPN
V2P
PPO
Vaz
Ta,on,TC
V2P
PPO
V2P
PPO
(Ts/2-Ta,off/2)/2
V14
PPN
V15
NPN
V15
NPN
Ta,on
V2N
OON
V2N
OON
V8
OPN
V8
OPN
V3P
OPO
V3P
OPO
V2P
PPO
Vaz
(b) Sector -D
Ta,on
V3N
NON
V3N
NON
V14
PPN
V2P
PPO
Vaz
Ta,on,TC
V2P
PPO
V2P
PPO
V14
PPN
V15
NPN
V15
NPN
(Ts/2-Ta,off/2)/2
Ta,on
Fig. 3.24 Switching sequence of tolerance control (reprinted from Ref. [6], Fig. 11)
Table 3.5 Simulation and experimental parameters
DC-link voltage
150 V
Line-to-line voltage
100 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
L-ﬁlter
1 mH
Control period
100 ls
Load
33.3 Ω
98
3
Three-Level Converter Tolerant Control for Switch Faults

In Fig. 3.26, the pole voltage Vaz, which contains an open-switch fault, operates
as 2-LSM by OP2LS-TC. The DC-link voltage ripple and the neutral-point voltage
are 1 and 2 V. Even if the neutral voltage equilibrium is considered in the PWM
method of the three-level converter, the imbalance of the neutral voltage can be
caused by a number of reasons. Differences in the capacitance of the DC short
Table 3.6 OP2LS-TC depending on the position of an open-switch fault
Position of open-switch fault
Vx,ref (x = a, b, c) < 0
Vx,ref (x = a, b, c) > 0
Sa2 or Sa3
Ta;on;TC ¼ 1
2 Ta;on
Ta;on;TC ¼ 1
2 ðTa;off þ TsÞ
Sb2 or Sb3
Tb;on;TC ¼ 1
2 Tb;on
Tb;on;TC ¼ 1
2 ðTb;off þ TsÞ
Sc2 or Sc3
Tc;on;TC ¼ 1
2 Tc;on
Tc;on;TC ¼ 1
2 ðTc;off þ TsÞ
Table 3.7 Simulation and experimental parameters
DC-link voltage
200 V
Line-to-line voltage
127 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
L-ﬁlter
1 mH
Control period
100 ls
Load
33.3 Ω
Fig. 3.25 Simulation results of OP2LS-TC when an Sa2 open fault occurs (reprinted from Ref. [6],
Fig. 13)
3.2
Three-Level Converter Tolerant Control Using …
99

capacitor generated in the manufacturing process, the characteristics of each
switching device, and a mismatch of the switching on-off points all contribute to the
neutral point voltage imbalance.
D. Three-Level Switching Oriented Tolerance Control (3LSO-TC) [9].
3LSO-TC maintains 3-LSM in sectors as much as possible when an open-switch
fault occurs. In 3LSO-TC, as shown in Fig. 3.27, the infeasible vectors, OPO, OPP,
OOP, and OOO, are changed to NON, NOO, NNO, and NNN vectors in sectors III
and IV when an Sa2 open-switch fault occurs. This method was explained in the
M3LS tolerance control, which adds an offset value to the switch on-times (Ta,on,
Tb,on, and Tc,on) of the three-phase reference voltages. The changed vectors in
Fig. 3.26 Experimental results of OP2LS-TC when an Sa2 open fault occurs (reprinted from Ref.
[6], Figs. 20 and 21)
100
3
Three-Level Converter Tolerant Control for Switch Faults

sectors III and IV, are N-type small vectors NON, NOO, and NNO. Therefore, in
order to consider neutral-point voltage balancing, the P-type small vectors should
be chosen in sectors I and VI, as explained in the M3LS tolerance control.
Table 3.8 shows the range for applying a two-level switching method depending
on the tolerant control. Among them, 3LSO-TC uses the two-level switching
method in the smallest range. Table 3.9 shows the summary of 3LSO-TC.
• Simulation and Experimental results of 3LSO-TC.
Table 3.10 shows the parameters of simulation and experiment for 3LSO-TC.
The a-phase pole voltage has two levels in sectors II and V. In the rest of the sector,
the a-phase pole voltage is clamped at Vdc/2 and −Vdc/2 when 3LSO-TC is applied.
The b-phase and c-phase pole voltages maintain three levels as shown in Fig. 3.28.
Table 3.8 The range for applying the two-level switching method in 3LSO-TC, M3LS-TC and
OP2LS-TC
M3LS-TC
OP2LS-TC
3LSO-TC
The range of the
two-level
switching method
Two of the
sectors in
three legs
All of the sectors in a leg
containing an
open-switch fault
Two of the sectors in a
leg containing an
open-switch fault
SECTOR
SECTOR
SECTOR
SECTOR
NOO
NNO
NPN
NPO
NPP
NOP
NNP
SECTOR
SECTOR
POO
ONN
PPO  PPO
OON
POP
PNN
PON
PPN
OPN
ONP
PNP
PNO
OPP
V*
D
OPO
NON
V*
PPO
V*
NNN
A
B
C
O
OOP
NNO
O
OOO
O
POP
ONO
O
PPP
PPP
P
V*
A
B
C
D
13
V
1
V
0
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(2/3)Vdc
Fig. 3.27 3LSO-TC for an Sa2 open-switch fault (reprinted from Ref. [6], Fig. 8)
3.2
Three-Level Converter Tolerant Control Using …
101

Figure 3.29 shows the performance of the proposed 3LSO-TC when an Sa2
open-switch fault occurs in the experiment. Due to the Sa2 open-switch fault, the
positive a-phase current (Ia) becomes zero and the DC-link voltage has a large
ripple. After 3LSO-TC is applied, the a-phase and b-phase currents (Ia and Ib) are
restored as sinusoidal waveforms and the DC-link voltage ripple decreases as
shown in Fig. 3.29a. As can be seen from the experimental results, the Vab of
3LSO-TC, which is different from the conventional Vab in two sectors, is the same
as that in the simulation. Moreover, the a-phase pole voltage Vaz, which contains an
open-switch fault, has two levels and is maintained at Vdc/2 or –Vdc/2 in four
sectors. The b-phase pole voltage Vbz is not changed when compared to that
obtained during normal operation.
E. Comparison of tolerant controls [9].
In this section, the characteristics of the tolerance controls introduced in section
IV, are analyzed and compared through the simulation results. For analysis of the
Table 3.9 3LSO-TC depending on the position of an open-switch fault
Position of open-switch fault
Sa2 or Sa3
Sb2 or Sb3
Sc2 or Sc3
Sector I
OON ! PPO
ONN ! POO
-A,-B: Tb;on;TC ¼ Tb;on
2
-C,-D: Tb;on;TC ¼ Tb;off þ Ts
2
OON ! PPO
ONN ! POO
Sector II
-A,-B: Ta;on;TC ¼ Ta;on
2
-C,-D: Ta;on;TC ¼ Ta;off þ Ts
2
OON ! PPO
OPO ! NON
OON ! PPO
OPO ! NON
Sector III
OPO ! NON
OPP ! NOO
OPO ! NON
OPP ! NOO
-A,-B: Tc;on;TC ¼ Tc;on
2
-C,-D: Tc;on;TC ¼ Tc;off þ Ts
2
Sector IV
OPP ! NOO
OOP ! NOO
-A, -B: Tb;on;TC ¼ Tb;off þ Ts
2
-C, -D: Tb;on;TC ¼ Tb;on
2
OPP ! NOO
OOP ! NNO
Sector V
-A,-B: Ta;on;TC ¼ Ta;off þ Ts
2
-C,-D: Ta;on;TC ¼ Ta;on
2
OOP ! NNO
ONO ! POP
OOP ! NNO
ONO ! POP
Sector VI
ONN ! POO
ONO ! POP
ONN ! POO
ONO ! POP
-A,-B: Tc;on;TC ¼ Tc;off þ Ts
2
-C,-D: Tc;on;TC ¼ Tc;on
2
Table 3.10 Simulation and experimental parameters
DC-link voltage
200 V
Line-to-line voltage
127 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
L-ﬁlter
1 mH
Control period
100 ls
Load
33.3 Ω
102
3
Three-Level Converter Tolerant Control for Switch Faults

input current ripple, DC-link voltage ripple, and switch losses, the simulation
parameters are as follows: the rated power is 1.5 kW, the grid line-to-line voltage is
127 Vrms, the grid frequency is 60 Hz, the L-ﬁlter value is 1 mH, the DC-link
voltage is 200 V, the DC-link capacitor is 1100 lF, the load is 33.3 X, the switching
frequency is 10 kHz, and the control period is 100 ls. The parameters of an IGBT
module 4MBI300VG-120R-50 from Fuji Electric were used in the simulation.
• Input current ripple.
Figures 3.12, 3.25 and 3.28 show the pole voltage and current waveforms of the
tolerance controls when an Sa2 open-switch occurs. Three of the tolerance controls
restore the distorted input currents after 0.5 s. However, each of the tolerance
controls has a different pole voltage and current ripple. R2LS-TC makes the pole
voltage of the three-phase as two levels (Vdc/2 and −Vdc/2) as shown in Fig. 3.12.
The a-phase pole voltage has two levels in sectors II and V, In the rest of the
sectors, the a-phase pole voltage is clamped at Vdc/2 and −Vdc/2 when 3LSO-TC is
applied. The b-phase and c-phase pole voltages maintain three levels as shown in
Fig. 3.28 Simulation results of 3LSO-TC when an Sa2 open fault occurs (reprinted from Ref. [6],
Fig. 13)
3.2
Three-Level Converter Tolerant Control Using …
103

Fig. 3.29 Experimental results of 3LSO-TC when an Sa2 open fault occurs (reprinted from Ref.
[6], Figs. 19 and 21)
104
3
Three-Level Converter Tolerant Control for Switch Faults

Fig. 3.25. OP2LS-TC makes the a-phase pole voltage as two levels in all of the
sectors. The b-phase and c-phases have three-level pole voltages as shown in
Fig. 3.28.
Figure 3.30 shows expanded current waveforms of the tolerance controls.
R2LS-TC increases the ripple of the three-phase currents in sectors II–V as shown
in Fig. 3.30b owing to 2-LSM. 3LSO-TC has a current ripple in sector II–V that is
smaller than that of R2LS-TC. However, the current ripple in sectors I and IV
increases compared with that of R2LS-TC as shown in Fig. 3.30c. Although
OP2LS-TC only makes the a-phase pole voltage as two levels, it exhibits good
performance with respect to the current ripple as shown in Fig. 3.30d. Table 3.11
shows the THD results of the three-phase currents depending on the tolerance
controls. Consequently, OP2LS-TC is advantageous in terms of the current THD.
• DC-link voltage ripple.
Figure 3.31 shows the DC-link voltage and neutral-point voltage (top-voltage and
bottom voltage) when each tolerance control is applied at a unity power factor.
Among the three tolerance controls, R2LS-TC has the smallest ripple in the
neutral-point voltage. The neutral-point voltages of 3LSO-TC and OP2LS-TC
contain larger ripples. Therefore, the DC-link voltage also has ripple because it is
affected by the ripple of the neutral-point voltage.
Table 3.12 lists the magnitudes of the DC-link voltage ripple and neutral-point
voltage ripple (Vdc,ripple, Vneu,ripple), when the power factor is unity depending on
various power levels (Load = 27, 33, and 66 X). It can be seen that R2LS-TC is
advantageous in terms of the ripples in the DC-link voltage and neutral-point
voltage.
• Loss.
The switch losses are divided into switching loss and conduction loss. Therefore, a
loss analysis of the three tolerance controls is conducted by considering both of the
loss components.
To analyze the switch losses, the parameters of a 4MBI300VG-120R-50 from
Fuji are used. The parameters of Dx1 and Dx4 are used to calculate the diode losses
of Dx2 and Dx3 that are not included in the 4MBI300VG-120R-50. The simulation
is performed, with the included junction temperature set as 25 °C. Figures 3.32 and
3.33 show the efﬁciency analysis results.
This chapter discusses the characteristics of the tolerant controls. To evaluate
these controls, the following three factors were considered: the current THD,
DC-link voltage ripple, and efﬁciency. These factors are summarized in Table 3.13.
From the analyzed results, the following conclusions can be obtained.
3.2
Three-Level Converter Tolerant Control Using …
105

Fig. 3.30 Expanded three-phase currents of tolerance controls for an Sa2 open-switch fault
(reprinted from Ref. [6], Fig. 14)
106
3
Three-Level Converter Tolerant Control for Switch Faults

R2LS-TC: This control guarantees a lower DC-link voltage ripple compared to
the other tolerance controls (3LSO-TC and OP2LS-TC). In sectors that operate as
the convectional three-level switching method, the neutral-point voltage balancing
control can be achieved. However, this method results in a high current THD and a
low efﬁciency.
3LSO-TC: This control guarantees a higher efﬁciency. Still the current THD and
DC-link voltage ripple increase. Additionally, the changed small vectors from the
infeasible vectors due to open-switch faults are not used for the neutral-point
voltage balancing control. However, the changed vectors for neutral-point voltage
balancing control in opposite sectors can be used as the neutral-point voltage
balancing control (the small vectors, which are the opposite type, in the opposite
sector, guarantee the neutral-point balance). These vectors for neutral-point voltage
Table 3.11 Current THD
comparison of the tolerant
controls
Normal
R2LS-TC
a
b
c
a
b
c
3.5%
3.5%
3.5%
7.5%
6.7%
6.7%
3LSO-TC
OP2LS-TC
a
b
c
a
b
c
8.2%
5.1%
5.1%
7.0%
4.6%
4.6%
Table 3.12 DC-link voltage ripple comparison of the tolerant controls
Normal
R2LS-TC
Power (%)
100
80
40
100
80
40
DC-link voltage ripple (V)
0.04
0.04
0.03
0.05
0.05
0.04
Neutral-point voltage ripple (V)
0.3
0.25
0.1
0.4
0.3
0.2
3LSO-TC
OP2LS-TC
Power (%)
100
80
40
100
80
40
DC-link voltage ripple (V)
0.28
0.22
0.1
0.07
0.06
0.05
Neutral-point voltage ripple (V)
2
1.4
0.71
0.9
0.8
0.38
Table 3.13 Performance comparison of R2LS-TC, 3LSO-TC, and OP2LS-TC
R2LS-TC
3LSO-TC
OP2LS-TC
Current THD
Large incensement
incensement
Small incensement
Voltage ripple
No change
Large incensement
Incensement
Loss
Large incensement
Small incensement
Incensement
3.2
Three-Level Converter Tolerant Control Using …
107

Fig. 3.31 DC-link voltages of tolerance control for an Sa2 open-switch fault at a unity power
factor (reprinted from Ref. [6], Fig. 15)
108
3
Three-Level Converter Tolerant Control for Switch Faults

balancing control are decided depending on the position of an open-switch fault.
Therefore, the neutral-point voltage balancing control in 3LSO-TC has a limitation
since it can counteract the unidirectional neutral-point voltage unbalancing.
OP2LS-TC: This control guarantees a lower current THD. However, the efﬁ-
ciency decreases and the DC-link voltage ripple increases. Like 3LSO-TC, the
neutral-point
voltage
balancing
control
can
counteract
the
unidirectional
neutral-point voltage unbalancing.
3.2.3
Tolerant Control for Sx1 and Sx4 Open-Circuit Fault
This chapter focuses on open-circuit faults of the outer switches in three-level
topologies. In general, tolerant controls for the T-type topology cannot be applied as
tolerant control for the NPC topology because of their structural differences. The
effects caused by an open-circuit fault of the outer switches in both the T-type and
NPC topologies are the same. Therefore, tolerant control can be applied to
open-circuit faults of the outer switches in both T-type and NPC topologies.
Fig. 3.31 (continued)
3.2
Three-Level Converter Tolerant Control Using …
109

Fig. 3.32 Loss analysis results of the tolerance controls for an Sa2 open-switch fault (reprinted
from Ref. [6], Fig. 16)
110
3
Three-Level Converter Tolerant Control for Switch Faults

However, the operating mode must be considered to develop the tolerant control
because the input currents of a three-level rectiﬁer do not ﬂow through the outer
switches (Sx1 and Sx4) at a unity power factor (PF). If not, in the inverter mode,
open-circuit faults of the outer switches become critical.
Sx1 and Sx4 open-circuit faults cause current distortion when a three-level
topology operates in the inverter mode. In this mode, an Sx1 open-circuit fault
makes the P-switching state infeasible, and an Sx4 open-circuit fault makes the
N-switching state infeasible. Therefore, when there is an Sa1 open-circuit fault, the
voltage vectors containing the P-switching state in the a-leg cannot be generated as
shown in Fig. 3.34. These vectors are [PPN], [PNN], [PNP], [PON], [PNO], [PPO],
[POO], and [POP].
Fig. 3.32 (continued)
Fig. 3.33 Total loss comparison of the tolerance controls for an Sa2 open-switch fault (reprinted
from Ref. [6], Fig. 17)
3.2
Three-Level Converter Tolerant Control Using …
111

SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
OOO
NNN
PPP
POO
ONN
PPO
OON
POP
ONO
OPO
NON
OPP
NOO
OOP
NNO
PNN
PON
PPN
OPN
NPN
NPO
NPP
NOP
NNP
ONP
PNP
PNO
1
2
3
4
13
V
1
V
0
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(2/3)Vdc
Fig. 3.34 Space vector diagram for tolerant control when an Sa1 open-circuit fault occurs
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
SECTOR
OOO
NNN
PPP
POO
ONN
PPO
OON
POP
ONO
OPO
NON
OPP
NOO
OOP
NNO
PNN
PON
PPN
OPN
NPN
NPO
NPP
NOP
NNP
ONP
PNP
PNO
2a
1b
2b
3a
3b
4a
4b
5a
5b
6a
6b
1a
13
V
1
V
0
V
4
V
5
V
6
V
7
V
8
V
9
V
10
V
11
V
12
V
14
V
15
V
16
V
17
V
18
V
(2/3)Vdc
Fig. 3.35 Space vector diagram for tolerant control when an Sa1 open-circuit fault occurs
112
3
Three-Level Converter Tolerant Control for Switch Faults

A. Three-level inverter tolerant control with a limited output voltage range [10].
If an open-circuit fault occurs in the Sx1 and Sx4 switches, the output phase currents
are considerably distorted and the neutral-point voltage is unbalanced as mentioned
previously. This is because it is impossible to generate large-voltage and
medium-voltage vectors that contain the P- or N- switching state states in the faulty
leg. Hence, when an open-circuit fault occurs in the outer switches, the modulation
index should be reduced to generate output without the impossible voltage vectors.
Taking an Sa1 fault for an example, the large-voltage vectors [PNN], [PNP], and
[PPN] and the medium-voltage vectors [PNO] and [PON] are impossible. To
generate output without theses vectors, the modulation index should be reduced so
that the reference voltage is in an inner hexagon, as shown in Fig. 3.35.
To assist in understanding of this method, the case of a fault in leg-a is con-
sidered. If an open-switch fault occurs in the switch Sa1, the modulation index needs
to be reduced so that the voltage reference is in the inner hexagon (red region).
Then add Tmin to the three phase turn-on times (Ta, Tb, Tc) when the reference
voltage is in regions 1, 2, and 6.
Figure 3.36 shows the switching sequence before Tmin is added and after Tmin is
added when an Sa1 open-switch fault occurs and the voltage reference is in region 1a.
In this sequence, Tmin is Tc. As shown in Fig. 3.36b, after Tmin is added, the new
switching sequence is [OON]-[ONO]-[OOO]-[ONO]-[ONN]. In this sequence, the
Fig. 3.36 Switching sequence when the reference voltage is in region 1a: a before Tmin is added
and b after Tmin is added (reprinted from Ref. [8], Fig. 11)
3.2
Three-Level Converter Tolerant Control Using …
113

dwell time of the P-type switching state [POO] becomes zero, and the dwell time of
the N-type switching state [ONN] is doubled in comparison with the conventional
three-level space vector modulation (SVM). This does not affect the output phase
voltage because the dwell times of the other switching states are unchanged, and the
small switching states [ONN] and [POO] generate the same line-to-line ac output
voltage. However, in regions 2a and 6b, the P-type switching state [POO] still remains
after Tmin is added as shown in Fig. 3.37. Therefore, the P-type switching state [POO]
should be replaced with the N-type switching state [ONN] as shown in Fig. 3.38a.
In regions 1, 2, and 6, the dwell time of the P-type switching state becomes zero,
and the dwell time of the N-type switching state is doubled by adding Tmin to the
three phase turn on times. This causes an unbalance of the neutral-point voltage. To
balance the neutral-point voltage, Tmin should be subtracted when the reference
voltage is in regions 3, 4, and 5. Furthermore, the N-type switching state [NOO]
should be replaced with the P-type switching state [OPP] in regions 3b and 5a. This
is because the P-type switching state [POO] is substituted with [ONN] in regions 2a
and 6b. In regions 2a, 3b, 5a, and 6b, the number of switching is increased because
the switching states of the small voltage vector are changed. Therefore, the
switching sequence should be rearranged to reduce the number of switching. For
example, in region 2a, the switching sequence is [OON]-[OOO]-[ONN]-[OOO]-
[OON] as shown in Fig. 3.38a.
Fig. 3.37 Switching sequence when the reference voltage is in region 2a: a before Tmin is added
and b after Tmin is added (reprinted from Ref. [8], Fig. 12)
114
3
Three-Level Converter Tolerant Control for Switch Faults

In this switching sequence, leg c changes its switching state twice. To reduce the
number of switching, the switching sequence should be rearranged as [ONN]-
[OON]-[OOO]-[OON]-[ONN] as shown in Fig. 3.38b. In order to rearrange the
switching sequence as shown in Fig. 3.38b, the dwell time of each switching state
should be obtained. The dwell time can be expressed by the turn-on times as follows:
Tdwell½OON ¼ 2ðTc þ TminÞ ¼ 4Tc
Tdwell½OOO ¼ 2ðTa þ TcÞ
Tdwell½POO ¼ Tdwell½ONN ¼ 2ðTb þ TaÞ
ð3:7Þ
Using these conditions, the three phase turn-on times (Ta, Tb, Tc) are redeﬁned as
follows:
Ta;TC ¼ Ts=2
Tb;TC ¼ 1
2 Tdwell½ONN ¼ Tb  Ta
Tc;TC ¼ 1
2 ðTdwell½ONN þ Tdwell½OONÞ ¼ 2Tc þ Tb  Ta
ð3:8Þ
Fig. 3.38 Switching sequence when the reference voltage is in region 2a: a when the P-type
switching state [POO] is replaced with the N-type switching state [OON] and b when the
switching sequence is rearranged (reprinted from Ref. [8], Fig. 13)
3.2
Three-Level Converter Tolerant Control Using …
115

Table 3.14 Tolerant control with limited output voltage ranges
Sa1, Sa4 open-circuit fault
Sb1, Sb4 open-circuit fault
Sc1, Sc4 open-circuit fault
1a
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ta  Tb
Tb;TC ¼ Ts=2
Tc;TC ¼ Ts=2 þ Tc  Tb
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
1b
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ta  Tc
Tb;TC ¼ Ts=2 þ Tb  Tc
Tc;TC ¼ Ts=2
2a
Ta;TC ¼ Ts=2
Tb;TC ¼ Tb  Ta
Tc;TC ¼ 2Tc þ Tb  Ta
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
2b
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ta  Tb
Tb;TC ¼ Ts=2
Tc;TC ¼ 2Tc þ Ta  Tb
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
3a
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ts=2 þ Ta  Tc
Tb;TC ¼ Tb  Tc
Tc;TC ¼ Ts=2
3b
Ta;TC ¼ Ts=2
Tb;TC ¼ Tb  Ta
Tc;TC ¼ Ts=2  Ta þ Tc
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
4a
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Ta;TC ¼ 2Ta þ Tc  Tb
Tb;TC ¼ Ts=2
Tc;TC ¼ Tc  Tb
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
(continued)
116
3
Three-Level Converter Tolerant Control for Switch Faults

Table 3.14 (continued)
Sa1, Sa4 open-circuit fault
Sb1, Sb4 open-circuit fault
Sc1, Sc4 open-circuit fault
4b
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Ta;TC ¼ 2Ts þ Tb  Tc
Tb;TC ¼ Tb  Tc
Tc;TC ¼ Ts=2
5a
Ta;TC ¼ Ts=2
Tb;TC ¼ Ts=2 þ Tb  Ta
Tc;TC ¼ Tc  Ta
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
5b
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ts=2 þ Ta  Tb
Tb;TC ¼ Ts=2
Tc;TC ¼ Tc  Tb
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
6a
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Ta;TC ¼ Ta  Tc
Tb;TC ¼ 2Ts þ Ta  Tc
Tc;TC ¼ Ts=2
6b
Ta;TC ¼ Ts=2
Tb;TC ¼ Tc þ 2Tb  Ta
Tc;TC ¼ Tc  Ta
Tx;TC ¼ Tx  Tminðx ¼ a; b; cÞ
Tx;TC ¼ Tx þ Tminðx ¼ a; b; cÞ
3.2
Three-Level Converter Tolerant Control Using …
117

Following the fault-tolerant strategy explained earlier, the redeﬁned turn-on
times for the tolerant control of a switch Sa4 fault are the same as those of a switch
Sa1 fault. The redeﬁned turn-on times to achieve the fault-tolerant control are
presented in Table 3.14.
• Simulation and experimental results.
Simulations have been carried out to verify the validity of the algorithm. The
parameters of simulation and experiment are listed in Table 3.15.
Figure 3.39 shows the simulation results of the fault tolerant strategy when an
open-switch fault occurs in Sa1. The distortion of the phase current is eliminated
after the algorithm is applied. The output line-to-line voltage is not ﬁve levels but
three levels, and the magnitude of the phase current is decreased because the
modulation index is reduced for the fault tolerant control. After the algorithm is
applied, the output pole voltage of the A-phase is ﬁxed to zero. This means that the
switches Sa1 and Sa4 are not used in this method.
Figure 3.40 shows experimental results after the fault-tolerant control is applied
when the switch Sa1 is faulty. The output line-to-line voltage is not ﬁve levels but
Table 3.15 Simulation and experiment parameters
System parameters
DC-link voltage
(simulation/experiment)
300 V/200 V
Load (simulation/experiment)
3mH, 15Ω/
10mH, 10Ω
DC-link capacitor
1100 lF
Frequency of Current
60 Hz
Switching frequency
10 kHz
Control period
100 ls
Fig. 3.39 Simulation results of fault-tolerant control when an open switch fault occurs in switch
Sa1 (reprinted from Ref. [8], Fig. 20)
118
3
Three-Level Converter Tolerant Control for Switch Faults

three levels and the magnitude of the output phase current is decreased because the
modulation index is reduced. As a result, the reference voltage is in the inner
hexagon of the space vector diagram. In this control, the output pole voltage is ﬁxed
to zero. This means that the switches Sa1 and Sa4 are not used in this method.
Therefore, distortions due to the P- and N-switching states does not occur. Although
the magnitude of the output phase current is decreased, the distortion of the phase
current is eliminated.
B. Three-level rectiﬁer tolerant control using reactive current injection [11].
If a three-level rectiﬁer operates at a unity power factor, an Sx1 or Sx4 open circuit
fault does not affect the current or cause current distortion. However, as mentioned in
Fig. 3.40 Output of a T-type three-level inverter when tolerant control is applied under the switch
Sa1 fault condition (reprinted from Ref. [8], Fig. 32)
3.2
Three-Level Converter Tolerant Control Using …
119

Sect. 2.3, when a three-level rectiﬁer is used in a WTS, the current distortion caused
by an Sx1 or Sx4 open-circuit fault can be generated in following cases:
• Case 1: when the VEMF is small and a large Irec is required.
• Case 2: when the reactive current is injected for an IPMSG.
The current distortion is caused by the impossibility of the P-switching state in
the negative current or the impossibility of the N-switching state in the positive
current when an Sx1 or Sx4 open-switch fault occurs, respectively. The time inter-
vals of A and C containing infeasible switching states should be eliminated to
restore the current distorted by an Sx1 or Sx4 open-switch fault. Therefore, the
proposed tolerance control moves Irec to the new current Irec,new, which is the red
line, as shown in Fig. 3.41.
Moving Irec is performed by injecting the d-axis current Ide. In a WTG system,
d-axis and q-axis current controllers based on the synchronous reference frame are
used to control the ﬂux and torque of PMSGs. The q-axis current Iqe only indicates
the torque component and is controlled to transfer power from the PMSG to the
DC-link capacitor. Ide is normally controlled to be 0 because this indicates the ﬂux
component.
To completely remove current distortion, an exact Ide should be injected. An Ide
that is more or less than the exact Ide, extends the time intervals of A and C
containing infeasible switching states, and the current either cannot be restored or
becomes more distorted. To determine the value of the exact Ide, the phase angle
difference Dh between VEMF and Vref should be calculated. Figure 2.23 shows a
circuit model of one phase between the PMSG and the rectiﬁer. The phase of Irec
corresponds with the phase of VEMF, and Vref is expressed with h. Irec is expressed as:
vEMF  vref
Z
¼ VEMF\0  Vref \h
Rs þ j2pfsLs
¼ Irec\0
ð3:9Þ
Fig. 3.41 Current change by the proposed tolerance control (reprinted from Ref. [9], Fig. 8)
120
3
Three-Level Converter Tolerant Control for Switch Faults

where Ls and Rs are the stator inductance and resistance of the PMSG, and fs is the
angular frequency of the PMSG.
By using (1), h is calculated as:
h ¼ tan1 Irec  2pfsLs
VEMF  IrecRs


ð3:10Þ
Due to the d-axis and q-axis current controllers, Ide is zero, and Irec is the same as
Iqe. The injected Ide is calculated using the calculated h, and this value is expressed as:
Ide ¼ Iqe tan h
ð3:11Þ
A vector diagram of the tolerance control is shown in Fig. 3.42. The injected Ide
changes Irec to Irec,new, and the phases of Irec,new and Vref become equal. In using the
proposed tolerance control, the rated current Irated should be considered. Therefore,
the injected Ide is limited by:
Ide\Ide;max ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
I2
rated  I2
qe
q
ð3:12Þ
The tolerance control for Sx1 and Sx4 open-switch faults can be applied to both
NPC and T-type rectiﬁers. Moreover, this control guarantees normal operation
when one or more open-switch faults of Sa1, Sa4, Sb1, Sb4, Sc1, or Sc4 occur until the
WTG system is safely stopped.
VEMF
q - axis
Vref
Irec,new
Irec = Iqs
Ids
IZs = I(Rs+j Ls)
d - axis
IZ
Fig. 3.42 Vector diagram of the proposed tolerance control for Sx1 and Sx4 open-switch faults in
the stationary frame (reprinted from Ref. [9], Fig. 10)
3.2
Three-Level Converter Tolerant Control Using …
121

Abruptly stopping a WTG system is difﬁcult owing to the inertia of the PMSG
and blades. The ﬁrst purpose of the tolerance control is to maintain stable operation
of a system without additional faults until the system is completely stopped. The
proposed tolerance control satisﬁes the ﬁrst purpose. Additionally, although the
power factor of the rectiﬁer slightly decreases, the WTG system continues on
generating power.
• Simulation and experimental results of tolerant control using reactive current
injection.
Simulations and experiments are performed using PSIM Tool to verify the
proposed tolerance control. The parameters of the PMSG are shown in Table 3.16.
The DC-link voltage Vdc is 600 V (Vtop and Vbottom are 300 V), the total DC-link
capacitance is 1100 lF, the switching frequency is 10 kHz, the control period is 100
ls, and the grid line-to-line voltage is 380 Vrms. Irec is controlled at 10 and 20 A.
The neutral-point voltage balancing control is performed on the grid-side inverter.
These parameters are summarized in Table 3.16.
Figure 3.43a shows the performance of the tolerance control of a three-level
rectiﬁer at 600 rpm. In Fig. 3.34, the currents are distorted by an Sa1 open-switch
fault before the tolerance control is applied. However, the current distortion is
removed by the injected Ide, which is about 6 A. Figure 3.43b shows the perfor-
mance of the tolerance control of a three-level rectiﬁer at 1200 rpm. Like the
simulation of 600 rpm, the distorted currents are restored after the tolerance control
is applied. The injected Ide is almost the same as that of the 600 rpm case. This
value is not changed because fs and VEMF are increased at the same rate, and the
voltage dip due to IrecRs of the denominator is much smaller than VEMF. In
Fig. 3.43c, an Sa4 open-switch fault occurs at 0.35 s. From 0.35 s, the current is
distorted and Vdc has a ripple. The current distortion and Vdc ripple are removed by
the tolerance control after 0.45 s. Additionally, the tolerance control guarantees a
sinusoidal current for the range of the speed transition.
Figure 3.44 shows the performance of the tolerance control for Sa1 open-switch
faults of a three-level rectiﬁer under two speed conditions (600 and 1200 rpm) of
experiment. The Ide of the tolerance control is calculated and then injected. In this
case, due to the 600 rpm of the PMSG, fs is 30 Hz, and VEMF is 64.53 V. Therefore,
the calculated h by (2) is 7.9°, and the calculated Ide is 1.39 A, which is identiﬁed as
Table 3.16 Simulation and experiment parameters
Generator
Rated power
11 kW
Rated line-to-line voltage
191 Vrms
pole
6
Rated speed
1450 rpm
Stator resistance
0.099 Ω
d/q inductance
4.07/4.65 mH
System parameter
DC-link voltage
600 V
Grid line-to-line voltage
380 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
Control period
100 ls
122
3
Three-Level Converter Tolerant Control for Switch Faults

shown in Fig. 3.44a. The current distortion is eliminated after the tolerance control
is applied. Figure 3.44b shows the performance of the tolerance control at 1200
rpm. The Ide by the tolerance control is almost the same as that at 600 rpm because
fs and VEMF are increased at the same rate and the voltage dip due to IrecRs of the
denominator is much smaller than VEMF. The current distortion is eliminated after
the tolerance control is applied. The distorted and restored current THD values are
measured, as shown in Table 3.17.
Fig. 3.43 Tolerance control for a three-level rectiﬁer: a Sa1 open-switch fault, 600 rpm, b Sa1
open-switch fault, 1200 rpm, c Sa4 open-switch fault, 1200 rpm (reprinted from Ref. [9],
Figs. 15 and 16)
3.2
Three-Level Converter Tolerant Control Using …
123

C. Three-level rectiﬁer tolerant control using offset voltage injection [12].
In the above mentioned tolerant control for Sx1 and Sx4 open-circuit faults, the
control method injects the exact reactive current required to eliminate the current
distortion. However, this means that the PF is changed.
In tolerant control using offset voltage, a switch with an open-circuit fault is not
used to generate the input voltages of the three-level rectiﬁer by adding a com-
pensation value to the reference voltages. The compensation value is simply cal-
culated and the PF does not change in the tolerant control.
Figure 3.45 shows the input current generation process of a rectiﬁer for cases I
(when VEMF is small and a large Irec is required) and II (when reactive current is
injected for the IPMSG).
Fig. 3.43 (continued)
124
3
Three-Level Converter Tolerant Control for Switch Faults

There are two phase differences as shown in Fig. 3.45: the phase difference (hZ)
between VEMF and Vrec explained in [22], and the phase difference (hPF) between
Iref and VEMF caused by the PF. In Fig. 3.45, part B (or part D) consists of hZ and
Fig. 3.44 Experimental result of the proposed tolerance control for Sx1 and Sx4 open-switch
faults: a 600 rpm, b 1200 rpm (reprinted from Ref. [9], Fig. 21)
Table 3.17 Current THD values
Normal condition
Sa1 open fault
Appling tolerant control
Current THD of a leg (%)
11
14.5
11.1
3.2
Three-Level Converter Tolerant Control Using …
125

/PF, and their lengths increase. This means that current can be more distorted by an
open-circuit fault of the outer switches compared to when hZ alone is considered.
Case I can be ignored because hZ is determined based on the operating conditions of
the rectiﬁer and PMSG. However, because hPF is determined by the PF, Case II
should be considered when an IPMSG is employed.
The current distortion caused by an open-circuit fault of the outer switches is
shown in Fig. 3.46 for various PFs. Owing to an infeasible open-circuit fault
switch, the current becomes zero during the range consisting of hZ and hPF.
hZ and hPF of A in Fig. 3.45 can be calculated by (3.9) and (3.10). If the d–q
control theorem is used, hPF can be calculated as:
Fig. 3.45 Rectiﬁer operation with an IPMSG at any PF (reprinted from Ref. [10], Fig. 4)
Fig. 3.46 Current distortion depending on an open-circuit fault and the PF (reprinted from Ref.
[11], Fig. 5)
126
3
Three-Level Converter Tolerant Control for Switch Faults

hPF ¼ cos1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
I2
qe
I2
qe þ I2
de
s
 
!
ð3:13Þ
where Ide indicates the d-axis current related to the ﬂux, and Iqe indicates the q-axis
current related to the torque. In addition, these values are in the d–q synchronous
rotating frame. hZ and hPF, which are calculated from (3.10) and (3.13), are located
near the zero-crossing point of VEMF as shown in Fig. 3.47. Therefore, the com-
pensation position for adding Vcomp is deﬁned on the basis of VEMF’s angle (hEMF).
Figure 3.48 shows three-phase VEMF s and hEMF. hEMF is acquired from an encoder
or a position sensor. Six zero-crossing points are expressed for every 60°, which are
matched to each open-circuit fault as shown in Fig. 3.48.
Consequently, the value of hEMF representing each zero-crossing point is a
criterion for adding Vcomp. For example, when an Sa1 open-circuit fault occurs,
Vcomp should be added for the compensation range from (0° −hPF) to (0° + hZ),
which is based on 0°.
In the proposed tolerant control, the reference voltage of a phase containing an
Sx1 open-circuit fault is changed to zero as shown in Fig. 3.47. As a result, only the
O-switching state is used in part B. To make the reference voltage zero, |Vcomp| is
assigned to the magnitude of the reference voltage (Vx,ref,offset) containing an
open-circuit fault, and Vcomp can be expressed as:
Vcomp ¼ Va;ref ;offset
ð3:14Þ
Fig. 3.47 Change of the reference voltages in the proposed tolerant control for an Sa1 open-circuit
fault (0.95 PF) (reprinted from Ref. [12], Fig. 6)
3.2
Three-Level Converter Tolerant Control Using …
127

The proposed tolerant control is implemented by adding Vcomp to the reference
voltages (Vx,ref,offset, x = a, b, c). The new reference voltages (Vx,ref,tolerance, x = a, b,
c) of the proposed tolerant control are expressed as:
Va;ref ;tolerance ¼ Va;ref ;offset þ Vcomp
Vb;ref ;tolerance ¼ Vb;ref ;offset þ Vcomp
Vc;ref ;tolerance ¼ Vb;ref ;offset þ Vcomp
ð3:15Þ
• Considering neutral-point voltage balance.
Compensation voltage, which is one of the offset voltages, can cause neutral-point
voltage unbalance because Vcomp calculated from Table 3.17 is a one-sided voltage.
Therefore, two DC-link capacitors have different values depending on the polarity
of Vcomp generated for an open-circuit fault. Neutral-point voltage unbalance
increases both the voltage stress on the switch and the current THD. Tolerant
control for open-circuit faults of the outer switches has to incorporate a solution for
the neutral-point voltage unbalance problem. Therefore, as mentioned earlier, Vcomp
is added to the corresponding compensation position based on the position of the
open-circuit fault. Then Vcomp is also added to the diametrically opposite com-
pensation position to balance the neutral-point voltage. Figure 3.49 shows the
concept of tolerant control considering the neutral-point voltage balance when an
Fig. 3.48 Compensation position on the basis of an VEMF’s angle (hEMF) (reprinted from Ref.
[12], Fig. 7)
128
3
Three-Level Converter Tolerant Control for Switch Faults

Sa1 open-circuit fault occurs. In Fig. 3.49, Vcomp is added to the compensation range
[(0° −hPF)  (0° + hZ)], which corresponds to the position of the Sa1 open-circuit
fault. In addition, Vcomp is also added to the diametrically opposite compensation
range [(180° −hPF)  (180° + hZ)], which is the range for the Sa4 open-circuit
fault. The two Vcomps added to two positions have opposite polarities, which results
in a balanced neutral-point voltage.
The ﬁnal principles of tolerant control with neutral-point voltage balance are
summarized in Table 3.18.
• Limitation of this tolerant control.
Vx,ref,tolerance cannot exceed a limitation voltage (Vlimit), which is restricted by the
DC-link voltage (Vdc). Therefore, Vcomp is limited as follows:
Vcomp\Vlim it  Vref ;max
ð3:16Þ
where Vlimit is Vdc/2.
On the basis of (3.16), the applicable operation range of the tolerant control is
determined depending on Ma and the PF. Figure 3.50 shows Vx,ref,tolerance and Vcomp
of the tolerant control depending on the PF when Ma is 0.5. In Fig. 3.50, Vcomp
Fig. 3.49 Tolerant control considering the neutral-point voltage balance under an Sa1 open-circuit
fault (reprinted from Ref. [12], Fig. 8)
3.2
Three-Level Converter Tolerant Control Using …
129

leads to Va,ref,tolerance with a zero value in the corresponding compensation range.
Moreover, the peak value of Vc,ref,tolerance increases due to Vcomp. When the PF
decreases, this peak value increases. However, it does not exceed Vlimit.
Consequently, when Ma is smaller than 0.5, Vcomp can be added regardless of the
PF because Vc,ref,tolerance cannot exceed Vlimit. When Ma is larger than 0.5, the
Fig. 3.50 Vx,ref,tolerance (x = a, b, c) and Vcomp depending on the PF and Ma (reprinted from
Ref. [12], Fig. 9)
Table 3.18 Principle of the proposed tolerant control depending on the position of an open-circuit
fault
Position of open-circuit fault
Vcomp
Compensation range
Sa1, (Sa4)
Vcomp ¼ Va;ref ;offset
0° −hZ −0° + hPF
Sc4, (Sc1)
Vcomp ¼ Vc;ref ;offset
60° −hZ −60° + hPF
Sb1, (Sb4)
Vcomp ¼ Vb;ref ;offset
120° −hZ −120° + hPF
Sa4, (Sa1)
Vcomp ¼ Va;ref ;offset
120° −hZ −120° + hPF
Sc1, (Sc4)
Vcomp ¼ Vc;ref ;offset
120° −hZ −120° + hPF
Sb4, (Sb1)
Vcomp ¼ Vb;ref ;offset
120° −hZ −120° + hPF
130
3
Three-Level Converter Tolerant Control for Switch Faults

applicable PF range is determined by Ma. This is because a low Ma provides a large
margin for Vcomp. However, a large Vcomp cannot be acceptable for a high Ma.
Figure 3.51 shows the applicable PF range for various values of Ma. The shaded
part of Fig. 3.51 represents the applicable operation range. The tolerant control is
feasible over the entire factor range when Ma is smaller than 0.5. By making Ma
larger than 0.5, the applicable operation range decreases. The applicable operation
range shown in ARPF’s is largest when only the PF related to hPF is taken into
account. However, a large hZ means that a large portion of the compensation range
is reserved for hZ, and that the rest can be used to compensate hPF. Therefore, hZ
caused by the impedance of a PMSG reduces the applicable PF range, as shown in
ARPF,Z with hZ = 10°. hZ is determined by the operation conditions and parameters
of the PMSG shown in (3.10).
The tolerant control has a limitation in terms of its operation range that depends
on the PF and Ma. However, considering that wind turbine systems do not always
operate at the rated wind speed (high Ma) and that the operating PF of the rectiﬁer
of an IPMSG is not too low, the tolerant control can clearly be effective.
• Simulation and experimental results of tolerant control using offset voltage.
Simulations and experiments are conducted to identify the performance of the
tolerant control for open-circuit faults of the outer switches. The low-power pro-
totype hardware setup consists of a power converter and an M–G set. An induction
motor operates as the blades of a wind turbine systems. Therefore, a gearbox is not
used in the experiment. In addition, 3L-NPC IGBT modules (Semikron,
SK75MLI066T) are used in the experiment. The simulation and experimental setup
Fig. 3.51 Applicable PF range of tolerant control depending on Ma (reprinted from Ref. [12],
Fig. 10)
3.2
Three-Level Converter Tolerant Control Using …
131

parameters are as follows: the switching frequency is 10 kHz, the control period is
100 ls, the DC-link capacitor is 1100 lF, and the DC-link voltage is 600 V.
The IPMSG parameters used in the simulation and experiment are shown in
Table 3.19.
Figure 3.52 shows simulation results of the tolerant control when an Sa1
open-circuit fault occurs. The speed of the PMSG is 900 rpm, Ma is 0.5, and the PF
of the rectiﬁer is 0.95. Due to the Sa1 open-circuit fault, the negative current is
distorted as shown in Fig. 3.52a. After the tolerant control is applied, the reference
voltages are changed by Vcomp in the corresponding ranges [(0° −hPF)  (0° + hZ),
(180° −hPF)  (180° + hZ)], which are deﬁned in Table 3.18. As a result, the
a-phase pole voltage (Van) is clamped to 0 in these ranges as shown in Fig. 3.52b,
and the current distortion is eliminated completely. In addition, the two DC-link
capacitor voltages are balanced.
Figure 3.53 shows the performance of the tolerant control when an Sa1
open-circuit fault occurs in the experiment. The speed of the PMSG is 900 rpm, Ma
is 0.5, and the PF is 0.95. Like the simulation results, the Sa1 open-circuit fault
causes current distortion, as shown in Fig. 3.53a. After the tolerant control is
applied, the reference voltages are changed by Vcomp. Vcomp is added to the corre-
sponding compensation ranges as shown in Fig. 3.53b. The a-phase pole voltage
(Van) is zero for these ranges. Therefore, the current path related to the Sa1
open-circuit fault is not used, and current distortion is eliminated.
Figure 3.54 shows the compensation range of the tolerant control for different
PFs. When the PF decreases, the compensation range is extended. Closer inspec-
tion reveals that the PF is only related to hPF. Therefore, hZ is almost unchanged in
Fig. 3.54a, b.
The tolerant control can respond to open-circuit faults of two switches. In
Fig. 3.55, Sa1 and Sb1 open-circuit faults occur, and the tolerant control for each
fault is applied in order. First, the tolerant control for the Sa1 open-circuit fault is
applied and the distorted a-phase current (Ia) is corrected. Second, the b-phase
current (Ib) distortion caused by the Sb1 open-circuit fault is also eliminated.
Table 3.19 Simulation and experimental parameters
Generator
Rated power
11 kW
Rated line-to-line voltage
380 Vrms
Pole
6
Rated speed
1750 rpm
Stator resistance
0.349 Ω
d/q inductance
15.6/4.1 mH
System parameter
DC-link voltage
600 V
Grid line-to-line voltage
380 Vrms
DC-link capacitance
1100 lF
Grid frequency
60 Hz
Switching frequency
10 kHz
Control period
100 ls
132
3
Three-Level Converter Tolerant Control for Switch Faults

Fig. 3.52 Simulation results with the proposed tolerant control under an Sa1 open-circuit fault
(600 rpm)
3.2
Three-Level Converter Tolerant Control Using …
133

Fig. 3.53 Experimental results with the proposed tolerant control under an Sa1 open-circuit fault
(900 rpm) (reprinted from Ref. [12], Fig. 15)
134
3
Three-Level Converter Tolerant Control for Switch Faults

Fig. 3.54 Experimental results with the proposed tolerant control at different PFs (450 rpm, Ma =
0.25): a 0.95 PF, b 0.9 PF (reprinted from Ref. [12], Fig. 16)
3.2
Three-Level Converter Tolerant Control Using …
135

Fig. 3.55 Experimental results with the tolerant control under Sa1 and Sb1 open-circuit faults (450
rpm, Ma = 0.25, 0.95 PF) (reprinted from Ref. [12], Fig. 17)
136
3
Three-Level Converter Tolerant Control for Switch Faults

References
1. Ceballos, S., J. Pou, E. Robles, I. Gabiola, J. Zaragoza, J.L. Villate, and D. Boroyevich. 2000.
Three-level converter topologies with switch breakdown fault-tolerance capability. IEEE
Transaction on Industrial Electronics 55 (3): 982–995.
2. Park, G.T., T.J. Kim, D.W. Kang, and D.S. Hyun. 2004. Control method of npc inverter for
continuous operation under one phase fault condition. In Proceeding of IAS (pp. 2188–2193).
3. Silva, E.R., W.S. Lima, A.S. Oliveira, C.B. Jacobina, and H. Razik. 2006. Detection and
compensation of switch faults in a three level inverter. In Proceeding of PESC (pp. 1–7).
4. Ceballos, S., J. Pou, E. Robles, J. Zaragoza, and J.L. Martín. 2010. Performance evaluation of
fault-tolerant neutral-point-clamped converters. IEEE Transaction on Industrial Electronics
57 (8): 2709–2718.
5. Ceballos, S., J. Pou, and J. Zaragoza. 2011. Fault-tolerant neutral-point-clamped converter
solutions based on including a fourth resonant leg. IEEE Transaction on Industrial
Electronics 58 (6): 2293–2303.
6. Lee, J.S., K.B. Lee, and F. Blaabjerg. 2015. Open-Switch Fault Detection Method of a
Back-to-Back Converter using NPC Topology for Wind Turbine Systems. IEEE Transactions
on Industry Applications 51 (1): 325–335.
7. Lee, J.S., and K.B. Lee. 2014. Tolerance Control for Inner Open-Switch Faults of a T-type
Three-Level Rectiﬁer. Journal of Power Electronics 14 (6): 1157–1165.
8. Lee, J.S., and K.B. Lee. 2014. An Open-Switch Fault Detection Method and Tolerance
Controls Based on SVM in a Grid-Connected T-Type Rectiﬁer with Unity Power Factor.
IEEE Transactions on Industrial Electronics 61 (12): 7092–7104.
9. Lee, J.S., U.M. Choi, and K.B. Lee. 2015. Comparison of Tolerance Controls for
Open-Switch Fault in a Grid-Connected T-Type Rectiﬁer. IEEE Transactions on Power
Electronics 30 (10): 5810–5820.
10. Choi, U.M., K.B. Lee, and F. Blaabjerg. 2014. Diagnosis and tolerant strategy of an
open-switch fault for T-type three-level inverter systems. IEEE Transactions on Industry
Applications 50 (1): 495–508.
11. Lee, J.S., and K.B. Lee. 2015. Open-switch fault tolerance control for a three-level
NPC/T-type rectiﬁer in wind turbine systems. IEEE Transactions on Industrial Electronics 62
(2): 1012–1021.
12. Lee, J.S., and K.B. Lee. 2016. Open-circuit fault tolerant control for outer switches of
three-level rectiﬁers in wind turbine systems. IEEE Transactions on Power Electronics 31 (5):
3806–3815.
References
137

Chapter 4
Neutral-Point Voltage Reduction
A three-level converter has two DC-links and it makes output voltage with three
levels. If the two DC-link voltages are not the same, the output voltage is distorted.
To prevent this problem, the PWM methods in three-level converters generate
output voltage while guaranteeing that the two DC-link voltages are the same.
However, due to hardware problems, a voltage difference between the two DC-link
voltages can be generated. We call it as the DC component of neutral-point voltage.
To eliminate it, lots of methods have been proposed and existing methods com-
pensate the voltage difference of two DC-link voltages by measuring them [1–4].
In addition to the DC component of neutral-point voltage, an AC component,
which inﬂuences the lifetime of DC-link capacitors, is generated. However, it is not
generated due to hardware problems [5, 6]. The AC component is a unique char-
acteristic of PWM methods. Different AC components are produces depending on the
PWM method. A large AC component of neutral-point voltage leads to a lifetime
reduction of DC-link capacitors and it requires a large value for DC-link capacitors.
In this chapter, only the AC component of neutral-point voltage is taken into
account. A PWM method for reducing the AC component of neutral-point voltage
and for increasing the lifetime of DC-link capacitors will be introduced.
4.1
Neutral-Point Voltage of Three-Level Converters
The main reason for the neutral-point voltage in a three-level converter is shown in
this section. As mentioned in Chap. 1, space vector PWM (SVPWM) makes output
voltage by combining the voltage vectors nearest to the reference voltage.
There are six areas in sector I as shown in Fig. 4.1 and Table 4.1 shows the
voltage vectors in order depending on the area containing the reference voltage.
In sector I-1a, the order of the voltage vectors is [ONN]-[OON]-[OOO]-[POO]-
[OOO]-[OON]-[ONN]. Among them, the [ONN] and [OON] N-type small vectors
and the [POO] P-type small vector effect the variation of the neutral-point voltage.
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_4
139

The [ONN] and [POO] vectors have the same output voltage and they output the
same dwell time. However, the [OON] N-type small vector causes variation of the
neutral-point voltage and it makes the neutral-point voltage unbalanced in a
switching period. In sector I-3, the [PON] medium vector leads to variation of the
neutral-point voltage.
The neutral-point voltage variation in a switching period produces an AC
voltage ripple with a constant frequency component in the neutral-point voltage.
The frequency is depended on the PWM method used in the three-level converter.
The SVPWM method and the carrier based PWM method [7, 8] using the offset
voltage mentioned in Chap. 1 generate an AC voltage ripple with a frequency that
is three times the fundamental frequency of the output voltage as shown in Fig. 4.2.
2b
3
4
OOO
NNN
PPP
POO
ONN
PPO
OON
PNN
PON
PPN
2a
1b
1a
0
V
2
V
14
V
7
V
1
V
13
V
Fig. 4.1 Space vectors in sector I
Table 4.1 Voltage vectors depending on the area of sector I
Sector I
Order
1a
1b
2a
2b
3
4
1
V1N[ONN]
V2N[OON]
V1N[ONN]
V2N[OON]
V1N[ONN]
V2N[OON]
2
V2N[OON]
V0[OOO]
V2N[OON]
V7[PON]
V13[PNN]
V7[PON]
3
V0[OOO]
V1P[POO]
V7[PON]
V1P[POO]
V7[PON]
V14[PPN]
4
V1P[POO]
V2P [PPO]
V1P[POO]
V2P[PPO]
V1P[POO]
V2P[PPO]
5
V0[OOO]
V1P[POO]
V7[PON]
V1P[POO]
V7[PON]
V14[PPN]
6
V2N[OON]
V0[OOO]
V2N[OON]
V7[PON]
V13[PNN]
V7[PON]
7
V1N[ONN]
V2N[OON]
V1N[ONN]
V2N[OON]
V1N[ONN]
V2N[OON]
140
4
Neutral-Point Voltage Reduction

• Neutral-point current calculation
In a three-level converter, the neutral-point voltage ripple can be calculated by
using the neutral-point current. In this section, the neutral-point current of the
carrier based PWM method with the offset voltage mentioned in Chap. 1 will be
calculated.
The reference voltages for the a, b, and c phases are expressed as:
Va;ref ¼ Vmag cosð2pff tÞ
Vb;ref ¼ Vmag cosð2pff t  2p=3Þ
Vc;ref ¼ Vmag cosð2pff t þ 2p=3Þ
ð4:1Þ
where Vmag is the magnitude of the reference voltages, and ff is the fundamental
frequency.
The offset value (Voffset) is added to each reference voltage to expand Ma. Voffset
can be calculated using the maximum, medium, and minimum values. These three
values are expressed as:
Vref ;max ¼ maxðVa;ref ; Vb;ref ; Vc;ref Þ
Vref ;mid ¼ midðVa;ref ; Vb;ref ; Vc;ref Þ
Vref ;min ¼ minðVa;ref ; Vb;ref ; Vc;ref Þ
ð4:2Þ
Voffset and the changed reference voltages (Va,ref,offset, Vb,ref,offset, Vc,ref,offset) are
shown in Fig. 4.3, and are expressed as:
Voffset ¼  ðVref ;max þ Vref ;minÞ
2
ð4:3Þ
Va;ref ;offset ¼ Va;ref þ Voffset
Vb;ref ;offset ¼ Vb;ref þ Voffset
Vc;ref ;offset ¼ Vc;ref þ Voffset
ð4:4Þ
Va,ref,offset, Vb,ref,offset, and Vc,ref,offset can be represented as Vref,offset,max, Vref,offset,mid,
and Vref,offset,min depending on the value, which is similar to (4.2). Vref,offset,max,
Fig. 4.2 Neutral-point voltage with 150 Hz (fundamental frequency: 50 Hz) (reprinted from [9],
Fig. 4)
4.1
Neutral-Point Voltage of Three-Level Converters
141

Vref,offset,mid, and Vref,offset,min are compared with two carrier signals as shown in
Fig. 4.4. The relationship among the reference voltages, the reference duty signals for
each of the phases, and the inverter output voltages (Vout,offset,min, Vout,offset,mid, Vout,
offset,max) is shown. The reference duty signals (dref,offset,max, dref,offset,mid, dref,offset,min)
for each of the phases are represented as:
dref ;offset;max ¼ 2  Vref ;offset;max=Vdc
dref ;offset;mid ¼ 2  Vref ;offset;mid=Vdc
dref ;offset;min ¼ 2  Vref ;offset;min=Vdc
ð4:5Þ
dref,offset,max always causes Vout,offset,max to be connected to point P of the DC-link
during dref,offset,min  Ts, and dref,offset,min always causes Vout,offset,min to be connected
to point N of the DC-link during ([1 −dref,offset,min]  Ts). However, the Vout,offset,mid
produced by dref,offset,mid can be connected to point P or N of the DC-link depending
on the sign of dref,offset,mid. If the dc-link voltage (Vdc), the three phase currents, and
the reference duty signals do not change for a switching period (Ts) and the sum of
the three phase currents is zero, the average neutral-point current (INP) for Ts, which
is expressed in [11], can be expressed as:
INP ¼  dref ;offset;max

  IVref ;offset;max þ dref ;offset;mid

  IVref ;offset;mid þ dref ;offset;min

  IVref ;offset;min


ð4:6Þ
where Imax, Imid, and Imin are the currents of the maximum, medium, and minimum
reference voltages.
INP is calculated by the reference duty signals and the three phase currents. INP
affects the neutral-point AC ripple voltage, and the frequency of INP is the same as
that of the neutral-point AC ripple voltage. Figure 4.5 shows the two voltages and
Fig. 4.3 Reference voltages
(reprinted from [10], Fig. 3)
142
4
Neutral-Point Voltage Reduction

INP calculated from (4.6) when the previous mentioned CB-PWM method is applied
with a unity PF. The frequency of INP is three times the fundamental frequency of
the output current. The top-side voltage (Vtop) is decreased and the bottom-side
voltage (Vbottom) is increased when INP is positive. A negative INP causes Vtop to be
increased and Vbottom to be decreased. The magnitude of the neutral-point AC ripple
voltage (VNP,mag,ripple) is determined by the magnitude of the output current, the
DC-link capacitor value, and the PF. A small value of the DC-link capacitor, a large
output current, and a low-PF increase VNP,mag,ripple.
Vdc/2
-Vdc/2
0
Vout,offset,max
Vout,offset,mid
Vout,offset,min
Vref,offset,max
Vref,offset,mid
Vref,offset,min
Vdc/2
-Vdc/2
-Vdc/2
Ts
dref,offset,maxTs
dref,offset,midTs
dref,offset,minTs
0
0
0
Fig. 4.4 Relationship between the reference voltages and the duty signals (reprinted from [10],
Fig. 4)
4.1
Neutral-Point Voltage of Three-Level Converters
143

4.2
Neutral-Point AC Ripple Voltage Reduction Methods
The main reason for neutral-point voltage ripple was introduced and the neutral-point
voltage of the conventional PWM method was calculated in the above section.
Neutral-point AC ripple voltage reduction methods are introduced in this section.
4.2.1
Dwell Time Compensation for Neutral-Point Voltage
Reduction in the Carrier Based PWM Method [10]
INP can be zero by adding the optimal compensation value (dcomp) to the reference
duty signals. This means that VNP,mag,ripple can be reduced. When the optimal
Vtop
Vbottom
INP
Inp,mag,ripple
Vnp,mag,ripple
Fig. 4.5 Change in the
neutral-point voltage due to
the average neutral-point
current (INP) (reprinted from
[10], Fig. 5)
|dref,offset,mid|
dref,offset,mid
dcomp
|dref,offset,mid +dcomp|
=|dref,offset,mid| + |dcomp|
|dcomp|
0
d
Fig. 4.6 Case 1: dcomp > 0
and dref,offset,mid > 0 (reprinted
from [10], Fig. 6)
144
4
Neutral-Point Voltage Reduction

compensation value (dcomp) is added to the reference duty signals, (4.6) is repre-
sented as:
INP;casex ¼  dref ;offset;max þ dcomp

  Ivref ;offset;max þ dref ;offset;mid þ dcomp

  Ivref ;offset;mid þ dref ;offset;min þ dcomp

  Ivref ;offset;min


ð4:7Þ
where INP,casex represents the average neutral-point current affected by dcomp.
A. Optimal compensation value (dcomp) calculation
In (4.7), dref,offset,max is always positive and dref,offset,min is always negative.
However, dref,offset,mid and dcomp can be positive or negative. When considering that |
dcomp| should be smaller than |dref,offset,min| (or |dref,offset,max|) because Ma must not
exceeded 1, there are four cases.
• Case 1: dcomp > 0, dref,offset,mid > 0
In this case, the sign of dref,offset,mid is not changed as shown in Fig. 4.6.
Equation (4.7) can be represented as:
INP;case1 ¼  dref ;offset;max

  IVref ;offset;max þ dref ;offset;mid

  IVref ;offset;mid þ dref ;offset;min

  IVref ;offset;min


dcomp

  IVref ;offset;max  dcomp

  IVref ;offset;min þ dcomp

  IVref ;offset;mid


ð4:8Þ
By using INP, which is the initial value before adding dcomp to the reference duty
signals, (4.8) is represented as:
INP;case1 ¼ INP 
dcomp

  IVref ;offset;max  dcomp

  IVref ;offset;min þ dcomp

  IVref;offset;mid


ð4:9Þ
To make INP,case1 equal to zero, dcomp can be calculated as:
dcomp

 ¼
INP
IVref ;offset;max  IVref ;offset;min þ IVref ;offset;mid
; INP;case1 ¼ 0
ð4:10Þ
Then, because (Imax −Imin + Imid) > 0, (4.10) is ﬁnally expressed as
dcomp ¼
INP
IVref ;offset;max  IVref ;offset;min þ IVref ;offset;mid
for INP [ 0
ð4:11Þ
• Case 2: dcomp > 0, dref,offset,mid < 0
Depending on the magnitude of dcomp and dref,offset,mid, Case 2 can be divided
into two cases (Cases 2-1 and 2-2) as shown in Fig. 4.7. For Case 2–1, in which |
dcomp| is larger than |dref,offset,mid|, (4.7) can be represented as:
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
145

INP;case21 ¼  dref ;offset;max

  IVref ;offset;max þ dref ;offset;mid

  IVref ;offset;mid þ dref ;offset;min

  IVref ;offset;min



dcomp

  IVref ;offset;max  dcomp

  IVref ;offset;min þ
dcomp

  2 dref ;offset;mid




 IVref ;offset;mid


ð4:12Þ
To make INP,case2-1 equal to zero, dcomp can be calculated as:
dcomp

 ¼ INP þ 2 dref ;offset;mid

  IVref ;offset;mid
IVref ;offset;max  IVref ;offset;min þ IVref ;offset;mid
; INP;case21 ¼ 0
ð4:13Þ
Then, because (Imax −Imin + Imid) > 0, (4.13) can be ﬁnally expressed as:
dcomp ¼
INP þ 2 dref;offset;mid
j
jIVref ;offset;mid
IVref ;offset;max IVref ;offset;min þ IVref ;offset;mid
for INP þ 2 dref ;offset;mid

  IVref ;offset;mid [ 0
ð4:14Þ
|dref,offset,mid|
dref,offset,mid
dcomp
|dref,offset,mid +dcomp|
=|dcomp| - |dref,offset,mid|
|dcomp|
0
d
(a) Case 2-1
|dref,offset,mid|
dref,offset,mid
dcomp
|dref,offset,mid +dcomp|
=|dref,offset,mid| - |dcomp|
|dcomp|
0
d
(b) Case 2-2 
Fig. 4.7 Case 2: dcomp > 0
and dref,offset,mid < 0 (reprinted
from [10], Fig. 7)
146
4
Neutral-Point Voltage Reduction

For Case 2–2, in which |dcomp| is smaller than |dref,offset,mid|, (4.7) can be repre-
sented as:
INP;case22 ¼  dref ;offset;max

  IVref ;offset;max

þ dref ;offset;mid

  IVref;offset;mid þ dref ;offset;min

  IVref ;offset;min


dcomp

  IVref ;offset;max

 dcomp

  IVref ;offset;min  dcomp

  IVref ;offset;mid

ð4:15Þ
Like Case 1, to make INP, Case2-2 equal to zero, (4.15) can be expressed as:
dcomp ¼
INP
IVref ;offset;max  IVref;offset;min  IVref ;offset;mid
for INP [ 0
ð4:16Þ
Additionally, dcomp of Case 3 (dcomp < 0 and dref,offset,mid < 0) and Case 4
(dcomp < 0 and dref,offset,mid > 0) can be calculated in a manner that is similar to Case
1 and Case 2.
• Case 3: dcomp < 0, dref,offset,mid > 0
Ia
INP Calculation
(6)
Ib
Ic
Carrier
Based
PWM
Sort
(Max,Mid,Min)
Va,ref,offset
Vb,ref,offset
Vc,ref,offset
Va,ref
Voffset
+
+
+
dcomp Calculation
TABLE
INP
+
+
+
dcomp
Vb,ref
Vc,ref
Vdc/2
Load
Neutral-Point Ripple Compensation
3-Level
Inverter
da,ref,comp
db,ref,comp
dc,ref,comp
÷
÷
÷
÷
÷
÷
IVref,offset,max, IVref,offset,mid, IVref,offset,min
Vref,offset,max
Vref,offset,min
Vref,offset,mid
dref,offset,max
dref,offset,min
dref,offset,mid
da,ref,offset
db,ref,offset
dc,ref,offset
Fig. 4.8 Block diagram for neutral-point AC ripple voltage reduction (reprinted from [10],
Fig. 10)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
147

dcomp of Case 3-1, in which |dcomp| is larger than |dref,offset,mid|, is represented as:
dcomp ¼
INP þ 2 dref ;offset;mid
j
jIVref ;offset;mid
IVref ;offset;maxIVref ;offset;minIVref ;offset;mid
for INP þ 2 dref ;offset;mid

  IVref ;offset;mid\0
ð4:17Þ
dcomp of Case 3-2, in which |dcomp| is smaller than |dref,offset,mid|, is represented as:
dcomp ¼
INP
IVref ;offset;max  IVref ;offset;min þ IVref ;offset;mid
for INP\0
ð4:18Þ
• Case 4: dcomp < 0, dref,offset,mid < 0
dcomp of Case 4 is represented as:
dcomp ¼
INP
IVref ;offset;max  IVref ;offset;min  IVref ;offset;mid
;
for INP\0
ð4:19Þ
The requirements of (4.14) and (4.17) are not obvious. Therefore, this should be
veriﬁed mathematically. The magnitudes of |dref,offset,max| and |dref,offset,min| are the
same as those shown in Fig. 4.3. Thus, (4.7) can be represented as:
INP ¼  K  IVref ;offset;max þ dref ;offset;mid

  IVref ;offset;mid

þ K  IVref ;offset;min

K ¼ dref ;offset;max

 ¼ dref ;offset;min


ð4:20Þ
Equation (4.20) is simpliﬁed as:
INP ¼  K  ðIVref ;offset;max þ IVref ;offset;minÞ

þ dref ;offset;mid

  IVref ;offset;mid

¼
K  dref ;offset;mid




 IVref ;offset;mid


ð4:21Þ
From (4.21), the sign of INP is always the same as the sign of Imid because (K −|
dref,offset,mid|) of (4.21) is always positive. Consequently, the requirements of (4.14)
and (4.17) are:
dcomp ¼ INP þ 2 dref ;offset;mid

  IVref ;offset;mid
IVref ;offset;max  IVref ;offset;min þ IVref ;offset;mid
for INP [ 0
ð4:22Þ
dcomp ¼ INP þ 2 dref ;offset;mid

  IVref ;offset;mid
IVref ;offset;max  IVref ;offset;min  IVref ;offset;mid
for INP\0
ð4:23Þ
From (4.11), (4.19), (4.22), and (4.23), which are mathematical results consid-
ering the conditions of dcomp and dref,offset,mid, it is known that the sign of dcomp is
always the same as the sign of INP. Therefore, two requirements (INP and dref,offset,mid)
148
4
Neutral-Point Voltage Reduction

are provided to calculate dcomp. In summary, dcomp is calculated depending on the
values of dref,offset,mid and the original INP. In Case 2 and Case 3, ﬁrst, Case x – 1
(x = 2, 3) is calculated. Then Case x – 2 (x = 2, 3) is calculated if dcomp calculated
from Case x–1 does not satisfy its requirement (|dcomp| > |dref,offset,mid|). The dcomp
calculation method for neutral-point AC ripple voltage reduction is shown in
Table 4.2, and the compensated reference duty signals are expressed as:
dx;ref ;comp ¼ dx;ref ;offset þ dcompðx ¼ a; b; cÞ
ð4:24Þ
Although the phase of the currents is not the same as that of the reference duty
signals in a nonunity PF, all of the equations in this chapter can be applied for the
case of a nonunity PF because these equations only consider the signs of dref,offset,
min, dref,offset,mid, and dref,offset,max.
B. The applicable range of the proposed neutral-point AC ripple voltage reduction
method
dcomp is calculated from Table 4.1. The value of dx,ref,comp cannot exceed 1.
Therefore, the margin (dmargin) for adding dcomp is expressed as:
dmargin ¼ 1  dref ;offset;max


ð4:25Þ
Table 4.2 Compensation value calculations
Condtion
dref,offset,mid > 0
dref,offset,mid < 0
INP > 0
Case 1
Case 2-1: |dcomp| > |dref,offset,mid|
dcomp ¼
INP
IVref ;offset;max IVref ;offset;min þ IVref ;offset;mid
dcomp ¼
INP
IVref ;offset;max IVref ;offset;min IVref ;offset;mid
Case 2-2: |dcomp| < |dref,offset,mid|
(If |dcomp| > |dref,offset,mid| is not true)
dcomp ¼
INP þ 2 dref ;offset;mid
j
jIVref ;offset;mid
IVref ;offset;max IVref ;offset;min þ IVref ;offset;mid
INP < 0
Case 3-1: |dcomp| > |dref,offset,mid|
Case 4
dcomp ¼
INP
IVref ;offset;max IVref ;offset;min þ IVref ;offset;mid
dcomp ¼
INP
IVref ;offset;max IVref ;offset;min IVref ;offset;mid
Case 3-2: |dcomp| < |dref,offset,mid|
(If |dcomp| > |dref,offset,mid| is not true)
dcomp ¼
INP þ 2 dref ;offset;mid
j
jIVref ;offset;mid
IVref ;offset;max IVref ;offset;min IVref ;offset;mid
Table 4.3 Simulation and
experiment parameters
DC-link voltage
200 V
Output frequency
60 Hz
DC-link capacitor
165 lF
Output current
10 Apeak
Control period
100 ls
Switching frequency
10 kHz
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
149

dcomp should satisfy the following condition:
dcomp

\dmargin
ð4:26Þ
Additionally, the PF and Ma affect the applicable range of the proposed
neutral-point voltage AC ripple reduction method. Figure 4.9 shows the magnitude
of the neutral-point AC ripple voltage depending on the PF and Ma. This result is
the same as that in some papers which show that a low PF causes the neutral-point
AC ripple voltage to increase [3, 5, 12].
Figure 4.10 shows the required dcomp for the zero neutral-point AC ripple
voltage when the CB-PWM method is applied. This is provided from simulation
results obtained using the simulation parameters in section IV. A large Ma or a low
PF require a large dcomp to make the neutral-point AC ripple voltage zero. In
addition, Fig. 4.10 illustrates the applicable range of the proposed method. For
example, when Ma is 0.7, dmargin is 0.3 and the applicable range means that the
proposed method can eliminate the neutral-point AC ripple voltage completely
when the PF is from 0.6 to 1. For a low PF, large dcomp values are needed for
neutral-point AC ripple voltage reduction. In addition, because a high Ma provides a
small dmargin to add to dcomp, the neutral-point AC ripple voltage cannot be elim-
inated completely in the high Ma situation with a low PF. Consequently, dcomp is
restricted to dmargin, which varies depending on Ma. When Ma increases, dmargin
becomes smaller. The total control diagram of this method is shown in Fig. 4.8.
C. Simulation and experimental results
Figure 4.11 shows waveforms of the CB-PWM method. Each waveform of
Fig. 4.11a signiﬁes the values in the block diagram of Fig. 4.8. The reference
voltages (Va,ref, Vb,ref, and Vc,ref) are modiﬁed by Voffset. The changed reference
voltages (Va,ref,offset, Vb,ref,offset, and Vc,ref,offset) are used for determining the inverter
Fig. 4.9 Magnitude of the neutral-point AC ripple voltage (from the simulation results using the
parameters in Section IV) (reprinted from [10], Fig. 8)
150
4
Neutral-Point Voltage Reduction

output voltages by comparing them with two carrier signals. In this case, the PF is
unity because the phase of the currents corresponds with that of the reference
voltages. The frequency of the neutral-point AC ripple voltage, which is shown in
Fig. 4.11b, is three times as large as the fundamental frequency of the current. The
INP and the variables for the INP calculation are shown in Fig. 4.11b.
Figures 4.12 and 4.13 show the performance of the proposed neutral-point AC
ripple voltage reduction method according to the PF and Ma. The neutral-point AC
ripple voltage decreases after the proposed method is applied at 4.05 s. In
Fig. 4.12a, VNP,mag,ripple decreases from 1.7 to 0.1 V. Because dx,ref,comps (x = a, b,
c) cannot exceed 1, the proposed method does not completely eliminate the AC
ripple voltage (see Fig. 4.12b). Instead it is decreased from 5.8 to 2 V. When the
PF decreases, VNP,mag,ripple increases, and a large magnitude of dcomp is needed to
reduce it as shown in Fig. 4.12b, c.
The x-dot in Fig. 4.13a–c means that Ma exceeds 1 by adding dcomp to dx,ref
(x = a, b, c). Therefore, the neutral-point AC ripple voltage is not completely
eliminated. As Ma decreases, dmargin becomes large and the range where the
compensation can be achieved completely is expanded. When Ma is below 0.6, this
method guarantees complete reduction of the neutral-point AC ripple voltage, when
the inverters are operated at a PF from 0.5 to 1 as shown in Fig. 4.13d.
Figure 4.14 shows the experimental results of this method. The magnitude of the
neutral-point AC ripple voltage increases when the PF decreases. According to the
PF and Ma, a suitable dcomp is calculated for the neutral-point AC ripple voltage
reduction. Then, dx,ref,comp (x = a, b, c,) is changed by adding dcomp. The changed
da,ref,comp causes the neutral-point voltage to be reduced. However, the a-phase
current is not changed. In Fig. 4.14a, c, the neutral-point AC ripple voltage is
Fig. 4.10 dcomp for the zero neutral-point AC ripple voltage according to Ma (from the simulation
results using the parameters in Table 4.3) (reprinted from [10], Fig. 9)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
151

Fig. 4.11 Waveforms: a conventional CB-PWM method, b INP calculation (reprinted from [10],
Fig. 11)
152
4
Neutral-Point Voltage Reduction

Fig. 4.12 Waveforms of the CB-PWM method with neutral-point AC ripple voltage reduction:
a Ma = 0.87, PF = 1. b Ma = 0.87, PF = 0.8 (reprinted from [10], Fig. 12)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
153

almost eliminated and da,ref,comp has a value from −1 to 1. However, the
neutral-point AC ripple voltage of Fig. 4.14b, where Ma is 0.87 and the PF is 0.8, is
not completely eliminated. This is because |da,ref,comp| does not have to exceed 1 and
is limited by 1 and −1 as shown in the dotted circles of Fig. 4.14b.
4.2.2
Dwell Time Compensation for Neutral-Point Voltage
Reduction in SVPWM Method [9]
Table 4.4 shows the space voltage vector, switching states, and neutral currents of
three-level inverters. As previous mentioned, the voltage vectors, except for the
large-voltage and zero-voltage vectors, affect the neutral-point voltage oscillations.
INP is deﬁned depending on the switching states of the small and medium vectors.
Fig. 4.13 Performance of the neutral-point AC ripple voltage reduction method according to Ma
and PF: a Ma = 0.87, b Ma = 0.8, c Ma = 0.7, d Ma = 0.6–0.1 (reprinted from [10], Fig. 13)
154
4
Neutral-Point Voltage Reduction

Fig. 4.14 Experimental results of the CB-PWM method with this neutral-point AC ripple voltage
reduction according to Ma and PF: a Ma = 0.87, PF = 1, b Ma = 0.87, PF = 0.8, c Ma = 0.7,
PF = 0.75 (reprinted from [10], Fig. 18)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
155

A. Time-offset injection
The small-voltage and medium-voltage vectors oscillate the two capacitor
voltages. To minimize the oscillation, INP should be zero during the switching
sequence. This can be obtained by adding a proper time offset (Toff) to the
three-phase turn-on times (Ta, Tb, Tc).
The method to obtain a proper time offset (Toff) is expressed in this paragraph.
Sector I in Fig. 4.15 will be considered as an example to explain the method to
reduce the oscillation of the neutral-point voltage. The algorithm is explained under
the assumption that the inverter is in the normal operating (inverting) mode.
A block diagram of the method is shown in Fig. 4.16.
• Region 1
If the reference voltage Vref is in region 1 of sector I, it is made by the four
switching states [ONN], [PNN], [PON], and [POO] using symmetrical SVM. Using
these switching states, the switching sequence is formed as [ONN]–[PNN]–[PON]–
[POO]–[PON]–[PNN]–[ONN], and the dwell time of the N-type small switching
Table 4.4 Switching states, voltage vectors, and neutral current
Vector
Magnitude
Switching state
Neutral current
Zero vector
0
[PPP], [OOO], [NNN]
–
Small vector
1
3 Vdc
P-type
N-type
[POO]
[ONN]
Ib + Ic
Ia
[PPO]
[OON]
Ic
Ia + Ib
[OPO]
[NON]
Ia + Ic
Ib
[OPP]
[NOO]
Ia
Ib + Ic
[POP]
[ONO]
Ib
Ia + Ic
[OOP]
[NNO]
Ia + Ib
Ic
Medium vector
ﬃﬃ
3
p
3 Vdc
[PON]
Ib
[OPN]
Ia
[NPO]
Ic
[NOP]
Ib
[ONP]
Ia
[PNO]
Ic
Large vector
2
3 Vdc
[PNN]
–
[PPN]
–
[NPN]
–
[NPP]
–
[NNP]
–
[PNP]
–
156
4
Neutral-Point Voltage Reduction

state [ONN] and the P-type small switching state [POO] is equally divided as
shown in Fig. 4.17a. In this sequence, the medium switching state [PON] makes INP
not zero during the switching sequence. The neutral-point voltage is increased or
decreased depending on the current direction of phase B.
To make INP to zero during the switching sequence, a time offset (Toff) should be
added. The dwell times of the medium and small switching states should be
obtained by calculating a proper Toff. This can be easily calculated by the turn-on
times. In this region, the dwell time of [PON], [ONN], and [POO] can be expressed
as:
Vzero
Vsmall
Vmedium
Vlarge
2
1
4-b
4-a
3-b
3-a
Fig. 4.15 Space vector diagram of a three-level inverter (reprinted from Ref. [9], Fig. 2)
Fig. 4.16 Block diagram of the neutral-point voltage oscillation reduction method (reprinted from
[9], Fig. 5)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
157

Tdwell½PON ¼ 2ðTc  TbÞ
Tdwell½ONN ¼ 2Ta
Tdwell½POO ¼ 2ðTsw=2  TcÞ ¼ 2Ta
ð4:27Þ
The magnitude of the neutral-point voltage change DV by [PON] can be
expressed as:
DV ¼ 1
C
Z
t¼Tdwell½PON
t¼0
InðtÞdt
ð4:28Þ
where In is the neutral current, C is the size of the capacitor, and Tdwell[PON] is the
dwell time of the medium vector [PON]. Assuming that there is no change in the
current during a short period, it can be rewritten as:
Fig. 4.17 a Switching sequence in region 1 of sector I, b conventional SVM after Toff is added
(reprinted from [9], Fig. 6)
158
4
Neutral-Point Voltage Reduction

DV ¼ 1
C
Z
t¼2ðTcTbÞ
t¼0
InðtÞdt ¼ 1
C  2ðTc  TbÞ  Ib
ð4:29Þ
This magnitude should be the same with a change of the neutral-point voltage
using Toff as follows:
DV
j
j ¼ 1
C  2ðTc  TbÞ  Ib


¼ 1
C  2ðTa þ Toff Þ  Ia þ 1
C  ðTsw  2Tc  Toff Þ  ðIaÞ


ð4:30Þ
1
C  2ðTc  TbÞ  Ib

 ¼ 1
C  2Toff  Ia


ð4:31Þ
Toff

 ¼ Ib
j j
Ia
j j ðTc  TbÞ
ð4:32Þ
If [PON] increases the neutral-point voltage, Toff should be added so that the
dwell times of the P-type and N-type small switching states are changed to decrease
the neutral-point voltage. This means that the dwell time of P-type small switching
states decreases and the dwell time of N-type small switching states increases. The
time offset is added simply by redeﬁning the three-phase turn-on times (Ta, Tb, Tc).
In this region, [PON] increases the neutral-point voltage with P-type small
switching states because Ib is negative. Therefore, the dwell time of P-type small
switching states should be reduced by Toff, and the dwell time of N-type small
switching states should be increased by Toff. The turn-on times (Ta, Tb, Tc) are
redeﬁned as:
T0
a ¼ Ta þ 1
2
Ib
j j
Ia
j j ðTc  TbÞ
T0
b ¼ Tb þ 1
2
Ib
j j
Ia
j j ðTc  TbÞ
T0
c ¼ Tc þ 1
2
Ib
j j
Ia
j j ðTc  TbÞ
ð4:33Þ
where the switching sequences of the redeﬁned turn-on times are shown in
Fig. 4.17b. In this sequence, the dwell time of [ONN] and [POO] can be changed as:
Tdwell½ONN ¼ 2Ta þ Ib
j j
Ia
j j ðTc  TbÞ
Tdwell½POO ¼ 2Ta  Ib
j j
Ia
j j ðTc  TbÞ
ð4:34Þ
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
159

In the opposite case, if Ib has a positive value, Toff should be added so that the
dwell times of the P-type and N-type switching states are changed to increase the
neutral-point voltage. Tdwell[ONN] should be decreased by Toff, and Tdwell[POO] should
be increased by Toff.
• Region 2
The principle to calculate a precise Toff is the same as the above case. In this
sequence, the dwell times of [PON], [OON], and [PPO] should be considered and
can be expressed as
Tdwell½PON ¼ 2ðTb  TaÞ
Tdwell½OON ¼ 2Ta
Tdwell½PPO ¼ 2ðTsw=2  TcÞ ¼ 2Ta
ð4:35Þ
where the magnitude of the neutral-point voltage change DV by [PON] is:
DV
j
j ¼ 1
C  2ðTb  TaÞ  Ib


¼ 1
C  ð2Ta  Toff Þ  ðIcÞ þ 1
C ðTsw  2Tc þ Toff Þ  Ic


ð4:36Þ
and Toff is calculated as:
1
C  2ðTb  TaÞ  Ib

 ¼ 1
C  2Toff  Ic


ð4:37Þ
Then:
Toff

 ¼ Ib
j j
Ic
j j ðTb  TaÞ
ð4:38Þ
In this region, [PON] decreases the neutral-point voltage because the direction of
Ib is positive. Therefore, Tdwell[OON] should be decreased by Toff, and Tdwell[PPO]
should be increased by Toff. The turn-on times (Ta, Tb, Tc) are redeﬁned as:
T
0
a ¼ Ta  1
2
Ib
j j
Ic
j j ðTb  TaÞ
T
0
b ¼ Tb  1
2
Ib
j j
Ic
j j ðTb  TaÞ
T
0
c ¼ Tc  1
2
Ib
j j
Ic
j j ðTb  TaÞ
ð4:39Þ
160
4
Neutral-Point Voltage Reduction

• Region 3-a
Unlike the above cases, in this region, the switching sequence is [ONN]–
[OON]–[PON]–[POO]–[PON]–[OON]–[ONN]. There is one more switching state
of a small voltage vector. Therefore, two voltage vectors should be considered to
calculate Toff. The dwell times are deﬁned as:
Tdwell½PON ¼ 2ðTc  TaÞ
Tdwell½OON ¼ 2ðTa  TbÞ
Tdwell½ONN ¼ 2Tb
Tdwell½POO ¼ 2ðTsw=2  TcÞ ¼ 2Tb
ð4:40Þ
The oscillation by [OON] and the time offset Toff[OON] are:
DV
j
j ¼ 1
C  2ðTa  TbÞ  Ic

 ¼ 1
C  2Toff ½OON  Ia


ð4:41Þ
Toff ½PON

 ¼ Ic
j j
Ia
j j ðTa  TbÞ
ð4:42Þ
The oscillation by [PON] and the time offset Toff[PON] are:
DV
j
j ¼ 1
C  2ðTc  TaÞ  Ib

 ¼ 1
C  2Toff ½PON  Ia


ð4:43Þ
Toff ½PON

 ¼ Ib
j j
Ia
j j ðTc  TaÞ
ð4:44Þ
Since [OON] decreases the neutral-point voltage and [PON] increases the
neutral-point voltage, the dwell times of Tdwell[ONN] and Tdwell[POO] are changed as:
Tdwell½ONN ¼ 2Ta  Toff ½ONN þ Toff ½PON
Tdwell½POO ¼ 2Ta þ Toff ½OON  Toff ½PON
ð4:45Þ
The turn-on times (Ta, Tb, Tc) are redeﬁned as:
T
0
a ¼ Ta  1
2 Toff ½OON  Toff ½PON


T
0
b ¼ Tb  1
2 Toff ½OON  Toff ½PON


T
0
c ¼ Tc  1
2 Toff ½OON  Toff ½PON


ð4:46Þ
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
161

• Region 3-b
In this region, the switching sequence is [ONN]–[PON]–[POO]–[PPO]–[POO]–
[PON]–[ONN]. The two switching states [PON] and [POO] are also considered in
this region. The time offsets by [PON] and [POO] are calculated as given in (4.48)
and (4.50). Thus:
DV
j
j ¼ 1
C  2ðTc  TaÞ  Ib

 ¼ 1
C  2Toff ½PON  Ic


ð4:47Þ
Toff ½PON

 ¼ Ib
j j
Ic
j j ðTc  TaÞ
ð4:48Þ
DV
j
j ¼ 1
C  2ðTb  TcÞ  Ia

 ¼ 1
C  2Toff ½POO  Ic


ð4:49Þ
Toff ½POO

 ¼ Ia
j j
Ic
j j ðTb  TcÞ
ð4:50Þ
• Region 4-a
In this region, an additional N-type small switching state [OON] makes INP not
zero in the sequence. The sequence is [ONN]–[OON]–[OOO]–[POO]–[OOO]–
[OON]–[ONN]. The dwell times of switching states [ONN], [OON], and [POO] are
deﬁned as:
Tdwell½OON ¼ 2Tb
Tdwell½OON ¼ 2ðTc  TbÞ
Tdwell½POO ¼ 2ðTsw=2  TaÞ ¼ 2Tb
ð4:51Þ
The offset Toff for the zero INP is obtained by:
DV
j
j ¼ 1
C  2ðTc  TbÞ  Ic

 ¼ 1
C  2Toff ½OON  Ia


ð4:52Þ
Toff ½POO

 ¼ Ic
j j
Ia
j j ðTc  TbÞ
ð4:53Þ
162
4
Neutral-Point Voltage Reduction

The turn-on times are redeﬁned as:
T
0
a ¼ Ta  Ic
j j
Ia
j j ðTc  TbÞ
T
0
b ¼ Tb  Ic
j j
Ia
j j ðTc  TbÞ
T
0
c ¼ Tc  Ic
j j
Ia
j j ðTc  TbÞ
ð4:54Þ
• Region 4-b
The switching sequence in this region is [OON]–[OOO]–[POO]–[PPO]–[POO]–
[OOO]–[OON]. In this sequence, [POO] is considered to ﬁnd the time offset Toff.
The dwell time of [POO] is Tb −Ta. Therefore, Toff is calculated as:
DV
j
j ¼ 1
C  2ðTb  TaÞ  Ic

 ¼ 1
C  2Toff ½POO  Ic


ð4:55Þ
Toff

 ¼ Ia
j j
Ic
j j ðTb  TaÞ
ð4:56Þ
The Tdwell[OON] of the N-type switching state should be increased by Toff, and the
Tdwell[PPO] of the P-type switching state should be decreased by Toff. The turn-on
times (Ta, Tb, Tc) are redeﬁned as:
T
0
a ¼ Ta þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
T
0
b ¼ Tb þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
T
0
c ¼ Tc þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
ð4:57Þ
A proper Toff can be obtained in the other sectors using the same principles of
calculation and compensation.
Table 4.5 shows the time offset Toff and the redeﬁned turn-on times when the
reference voltage Vref is in sector I. If the magnitude of Toff is larger than Tmin,
distortions appear in the output voltages. Therefore, the magnitude of Toff should be
limited by Tmin. Tmin refers to the minimum turn-on time among Ta, Tb, and Tc in
each sequence. The proper time offset and the redeﬁned turn-on times for other
sectors are arranged in Tables 4.6, 4.7, 4.8, 4.9 and 4.10.
This time-offset injection method only changes the distribution of the small
vector’s dwell time between the N-type and P-type switching states depending on
the conditions to reduce neutral-point voltage oscillations. The N-type and P-type
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
163

switching states produce the same line-to-line voltages and only affect the
neutral-point voltage. The total dwell time of the small-voltage vector is not
changed, and the dwell times of the other voltage vectors are not changed.
Therefore, the outputs are not distorted by this method.
B. Sequence change
As previously mentioned, if the time offset is properly injected, the neutral-point
voltage oscillations are considerably decreased. However, there is a limitation to
injecting time offset to minimize the effect of time-offset injection on the outputs. If
the power factor is lower, the neutral current by the medium voltage vector is
increased. In this case, the required time offset is bigger than the minimum turn-on
times. This means that it is impossible to make the average of the neutral-point
voltage zero. Therefore, the magnitude of the neutral-point still remains. The ability
to reduce neutral-point voltage oscillations can be improved by changing the
switching sequences in regions 3 and 4.
For example, in the case of sector I, if the reference voltage is in region 3-a of
sector I, the switching sequence is formed as [ONN]–[OON]–[PON]–[POO]–
[PON]–[OON]–[ONN]. This sequence is called sequence 1 in this chapter. In this
sequence, [PON] acts similar to a P-type switching state of small voltage vectors. In
the case of region 3-b of sector I, the switching sequence is formed as [OON]–
[PON]–[POO]–[PPO]–[POO]–[PON]–[ONN], and [PON] acts as an N-type
switching sequence. This sequence is called sequence 2 in this chapter. However,
for example, if the power factor is 0.5, [PON] in region 3-b acts as a P-type
switching state. Although the maximum time offset is injected to increase the
N-type switching state, the effect of [PON] is higher than the increased N-type
switching state due to the time offset. Therefore, the upper capacitor voltage is
decreased, and the lower capacitor voltage is increased in this period.
Table 4.5 Time offset and redeﬁned turn-ON times for sector I
R
|Toff|
Tx (x = a, b, c)
1
Toff

 ¼ Ib
j j
Ia
j j ðTc  TbÞ
T
0
x ¼ Tx þ 1
2 Toff


2
Toff

 ¼ Ib
j j
Ic
j j ðTb  TaÞ
T
0
x ¼ Tx  1
2 Toff


3-a
Toff ½OON

 ¼ Ic
j j
Ia
j j ðTa  TbÞ
Toff ½PON

 ¼ Ib
j j
Ia
j j ðTc  TaÞ
T
0
x ¼ Tx  1
2 ð Toff ½OON

  Toff ½PON

Þ
3-b
Toff ½PON

 ¼ Ib
j j
Ic
j j ðTc  TaÞ
Toff ½POO

 ¼ Ia
j j
Ic
j j ðTb  TcÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½PON

  Toff ½POO

Þ
4-a
Toff

 ¼ Ic
j j
Ia
j j ðTc  TbÞ
T
0
x ¼ Tx  1
2 Toff


4-b
Toff

 ¼ Ia
j j
Ic
j j ðTb  TaÞ
T
0
x ¼ Tx þ 1
2 Toff


164
4
Neutral-Point Voltage Reduction

Table 4.6 Time offset and redeﬁned turn-ON times for sector II
R
|Toff|
Oscillations
Balancing (Vdc1 > Vdc2)
Balancing (Vdc1 < Vdc2)
1
Toff

 ¼ Ia
j j
Ic
j j ðTa  TbÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
2
Toff

 ¼ Ia
j j
Ib
j j ðTc  TaÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


3-a
Toff ½OPN

 ¼ Ia
j j
Ic
j j ðTc  TbÞ
Toff ½OPO

 ¼ Ib
j j
Ic
j j ðTa  TcÞ
T
0
x ¼ Tx  1
2 ð Toff ½OPN

  Toff ½OPO

Þ
T
0
x ¼ Tx  1
2 Toff ½OPN


T
0
x ¼ Tx þ 1
2 Toff ½OPO


3-b
Toff ½OPN

 ¼ Ia
j j
Ib
j j ðTc  TbÞ
Toff ½OON

 ¼ Ic
j j
Ib
j j ðTb  TaÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½OPN

  Toff ½OON

Þ
T
0
x ¼ Tx  1
2 Toff ½OON


T
0
x ¼ Tx þ 1
2 Toff ½OPN


4-a
Toff

 ¼ Ib
j j
Ic
j j ðTa  TbÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


4-b
Toff

 ¼ Ic
j j
Ib
j j ðTc  TaÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
165

Table 4.7 Time offset and redeﬁned turn-ON times for sector III
R
|Toff|
Oscillations
Balancing (Vdc1 > Vdc2)
Balancing (Vdc1 < Vdc2)
1
Toff

 ¼ Ic
j j
Ib
j j ðTa  TcÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


2
Toff

 ¼ Ic
j j
Ia
j j ðTc  TbÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
3-a
Toff ½NPO

 ¼ Ic
j j
Ib
j j ðTa  TbÞ
Toff ½NOO

 ¼ Ia
j j
Ib
j j ðTb  TcÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½NPO

  Toff ½NOO

Þ
T
0
x ¼ Tx  1
2 Toff ½NOO


T
0
x ¼ Tx þ 1
2 Toff ½NPO


3-b
Toff ½NPO

 ¼ Ic
j j
Ia
j j ðTa  TbÞ
Toff ½OPO

 ¼ Ib
j j
Ia
j j ðTc  TaÞ
T
0
x ¼ Tx  1
2 ð Toff ½NPO

  Toff ½OPO

Þ
T
0
x ¼ Tx  1
2 Toff ½NPO


T
0
x ¼ Tx þ 1
2 Toff ½OPO


4-a
Toff

 ¼ Ia
j j
Ib
j j ðTa  TcÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
4-b
Toff

 ¼ Ib
j j
Ia
j j ðTc  TbÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


166
4
Neutral-Point Voltage Reduction

Table 4.8 Time offset and redeﬁned turn-ON times for sector IV
R
|Toff|
Oscillations
Balancing (Vdc1 > Vdc2)
Balancing (Vdc1 < Vdc2)
1
Toff

 ¼ Ib
j j
Ia
j j ðTb  TcÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
2
Toff

 ¼ Ib
j j
Ia
j j ðTa  TbÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


3-a
Toff ½NOP

 ¼ Ib
j j
Ic
j j ðTb  TcÞ
Toff ½OOP

 ¼ Ic
j j
Ia
j j ðTb  TaÞ
T
0
x ¼ Tx  1
2 ð Toff ½NOP

  Toff ½OOP

Þ
T
0
x ¼ Tx  1
2 Toff ½NOP


T
0
x ¼ Tx þ 1
2 Toff ½OOP


3-b
Toff ½NOP

 ¼ Ib
j j
Ic
j j ðTa  TcÞ
Toff ½NOO

 ¼ Ia
j j
Ic
j j ðTc  TbÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½NOP

  Toff ½NOO

Þ
T
0
x ¼ Tx  1
2 Toff ½NOO


T
0
x ¼ Tx þ 1
2 Toff ½NOP


4-a
Toff

 ¼ Ic
j j
Ia
j j ðTb  TcÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


4-b
Toff

 ¼ Ia
j j
Ic
j j ðTa  TbÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
167

Table 4.9 Time offset and redeﬁned turn-ON times for sector V
R
|Toff|
Oscillations
Balancing (Vdc1 > Vdc2)
Balancing (Vdc1 < Vdc2)
1
Toff

 ¼ Ia
j j
Ic
j j ðTb  TaÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


2
Toff

 ¼ Ia
j j
Ib
j j ðTb  TaÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
3-a
Toff ½ONP

 ¼ Ia
j j
Ib
j j ðTa  TcÞ
Toff ½ONO

 ¼ Ib
j j
Ic
j j ðTc  TaÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½ONP

  Toff ½ONO

Þ
T
0
x ¼ Tx  1
2 Toff ½ONO


T
0
x ¼ Tx þ 1
2 Toff ½ONP


3-b
Toff ½ONP

 ¼ Ia
j j
Ib
j j ðTb  TcÞ
Toff ½OOP

 ¼ Ic
j j
Ib
j j ðTa  TbÞ
T
0
x ¼ Tx  1
2 ð Toff ½ONP

  Toff ½OOP

Þ
T
0
x ¼ Tx  1
2 Toff ½ONP


T
0
x ¼ Tx þ 1
2 Toff ½OOP


4-a
Toff

 ¼ Ib
j j
Ic
j j ðTb  TaÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
4-b
Toff

 ¼ Ic
j j
Ib
j j ðTa  TcÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


168
4
Neutral-Point Voltage Reduction

Table 4.10 Time offset and redeﬁned turn-ON times for sector VI
R
|Toff|
Oscillations
Balancing (Vdc1 > Vdc2)
Balancing (Vdc1 < Vdc2)
1
Toff

 ¼ Ic
j j
Ib
j j ðTc  TaÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
2
Toff

 ¼ Ic
j j
Ia
j j ðTb  TcÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


3-a
Toff ½PNO

 ¼ Ic
j j
Ia
j j ðTb  TaÞ
Toff ½POO

 ¼ Ia
j j
Ib
j j ðTc  TbÞ
T
0
x ¼ Tx  1
2 ð Toff ½PNO

  Toff ½POO

Þ
T
0
x ¼ Tx  1
2 Toff ½PNO


T
0
x ¼ Tx þ 1
2 Toff ½POO


3-b
Toff ½PNO

 ¼ Ib
j j
Ic
j j ðTa  TcÞ
Toff ½ONO

 ¼ Ib
j j
Ia
j j ðTa  TcÞ
T
0
x ¼ Tx þ 1
2 ð Toff ½PNO

  Toff ½ONO

Þ
T
0
x ¼ Tx  1
2 Toff ½ONO


T
0
x ¼ Tx þ 1
2 Toff ½PNO


4-a
Toff

 ¼ Ia
j j
Ib
j j ðTc  TaÞ
T
0
x ¼ Tx þ 1
2 Toff


T
0
x ¼ Tx
T
0
x ¼ Tx þ 1
2 Toff


4-b
Toff

 ¼ Ib
j j
Ia
j j ðTb  TcÞ
T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx  1
2 Toff


T
0
x ¼ Tx
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
169

To reduce the magnitude of the neutral-point voltage oscillations, more N-type
switching states are needed. The dwell time of N-type switching states can be
increased by changing switching sequence 2 to switching sequence 1 in region 3-b.
The redeﬁned turn-on times for the change from sequence 2 to sequence 1 can be
obtained as follows. The dwell time of each switching state can be deﬁned as:
T
0
a ¼ Ta þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
T
0
b ¼ Tb þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
T
0
c ¼ Tc þ 1
2
Ia
j j
Ic
j j ðTb  TaÞ
ð4:58Þ
The dwell time of each switching state should be equal as when sequence 2 was
changed to sequence 1 in region 3-b of sector I. Therefore, the turn-on times are
redeﬁned as:
T
0
a ¼ 1
2 Tdwell½ONN þ 1
2 Tdwell½OON þ Tdwell½PPO ¼ 1
2 ðTb  TcÞ þ 2Ta
T
0
b ¼ 1
2 Tdwell½ONN ¼ 1
2 ðTb  TcÞ
T
0
c ¼ T
0
a þ 1
2 Tdwell½PON ¼ 1
2 ðTb  TcÞ þ 2Ta þ ðTc  TaÞ
ð4:59Þ
By changing the switching sequence, the dwell times of Tdwell[OON] and Tdwell
[ONN] are increased by 2Ta and (Tb −Tc), respectively. Conversely, the dwell times
of Tdwell[PPO] and Tdwell[POO] is decreased to 0 and from 2(Tb −Tc) to (Tb −Tc),
respectively. This has the same effect as injecting the extra time offset. The extra
time offset can be represented by the time offset as:
Toff
ex

 ¼ 2  Ta þ ðTb  TcÞ  Ia
j j
Ic
j j
ð4:60Þ
By changing the switching sequence, the required time offset in sequence 2 is
reduced by:
T
0
off
seq2

 ¼ Toff
seq2

  Toff
ex

 ¼ Toff

  ð2Ta þ ðTb  TcÞ  Ia
j j
Ic
j jÞ
ð4:61Þ
The required time offset in sequence 2 should be changed in terms of sequence 1.
The time offset for sequence 1 can be deﬁned as:
170
4
Neutral-Point Voltage Reduction

Toff
seq2

  Toff
ex




 Ic
j j ¼ Toff
seq1

  Ic
j j
Toff
seq1

 ¼ Toff
seq2

  Toff
ex

 Ic
j j
Ia
j j
ð4:62Þ
By changing switching sequence 2 to sequence 1 in region 3-b, the dwell times
of N-type switching states are increased. This has the same effect since the mag-
nitude of the maximum time offset that can be injected is increased.
C. Simulation and experiment results
Simulations and experiments have been carried out to verify the validity of the
algorithm. The simulations are performed with a grid-connected T-type inverter
under the conditions shown in Tables 4.11 and 4.12.
Figure 4.18a shows the outputs when the modulation index Ma is 0.83 and a
conventional SVM is applied. The capacitor voltages oscillate, and the output phase
current is 43 Apeak. The output line-to-line voltage has ﬁve levels at a high mod-
ulation index. Figure 4.18b shows simulated outputs when the neutral-point voltage
ripple reduction method is applied. After the method is applied, the neutral-point
voltage oscillation is considerably reduced.
The outputs of the conventional SVM when the modulation index is 0.415 are
shown in Fig. 4.19a. The output line-to-line voltages have three levels because the
modulation index is below 0.5. After the neutral-point voltage ripple reduction
method is applied, the neutral-point voltage oscillations are decreased as shown in
Fig. 4.19b. In this case, there is no distortion in the outputs.
Figure 4.20 shows comparison results of neutral-point voltage oscillations when
Ma is 0.77 and the power factor (PF) is 0.5. In this case, the magnitude of the
neutral-point voltage oscillation is larger than when the PF is 1. This is because the
magnitude of the neutral current under medium-voltage vectors when the PF is 0.5
is bigger than when the PF is 1. The voltage oscillations have their maximum
magnitude when the PF is near zero. The neutral-point voltage oscillation is
reduced after the time-offset injection method is applied. However, the oscillation
Table 4.11 Simulation parameters
DC-link
650 V
Output frequency
50 Hz
C1, C2
550 lF
Output current
43 Apeak
Control period
100 ls
Switching frequency
10 kHz
Table 4.12 Experiment parameters
DC-link
180 V(Ma = 0.83),
400 V(Ma = 0.365)
Output frequency
60 Hz
C1, C2
550 lF
Load (R,L)
10 Ω, 9 mH
Control period
100 ls
Switching frequency
10 kHz
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
171

still remains because there is a limitation to the injection of the time offset as
mentioned in section III. To effectively decrease the neutral-point voltage oscilla-
tion, the switching sequences are changed in region 3-b. After the switching
sequences are changed, the low voltage oscillations are signiﬁcantly decreased as
shown in Fig. 4.20.
Figure 4.21a shows experimental results before the neutral-point voltage ripple
reduction method is applied when the modulation index is 0.83. After the method is
Fig. 4.18 Simulation results when Ma = 0.83 and PF = 1: a conventional SVM, b Neutral-point
voltage ripple reduction method (reprinted from [9], Figs. 7 and 8)
172
4
Neutral-Point Voltage Reduction

applied, the magnitudes of the neutral-point voltage oscillations are signiﬁcantly
reduced as shown in Fig. 4.21b. There are no distortions in the output line-to-line
voltage or the phase current.
Figure 4.22a shows the two capacitor voltages, the line-to-line voltage, and the
phase current when the modulation index is 0.365. The magnitudes of the
neutral-point voltage oscillations are also decreased as shown in Fig. 4.22b. The
Fig. 4.19 Simulation results when Ma = 0.415 and PF = 1: a conventional SVM, b neutral-point
voltage ripple reduction method (reprinted from [9], Figs. 9 and 10)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
173

Fig. 4.20 Comparison of the neutral-point voltage oscillation and output phase currents when
Ma = 0.77 and PF = 0.5 (reprinted from [9], Fig. 12)
Fig. 4.21 Experimental results when Ma = 0.83: a conventional SVM, b neutral-point voltage
ripple reduction method (reprinted from [9], Figs. 13 and 14)
174
4
Neutral-Point Voltage Reduction

oscillations of the neutral-point voltage in the experiments are smaller than those of
the simulation results. This is due to the smaller output phase currents and larger
output frequency when compared to those of simulations. The magnitude of the low
voltage oscillations in the neutral-point is proportional to the magnitude of the
output phase currents, and it is inversely proportional to the size of the capacitors
and fundamental output frequency. Nevertheless, these experimental results show
that the algorithm can reduce low-frequency voltage oscillations well without
distortions in the output phase currents or the line-to-line voltages.
Figure 4.23 shows results of the neutral-point voltage balancing method. To
make Vdc1 and Vdc2 unbalanced, a resistor is connected in parallel with the lower
capacitor. Due to the neutral-point voltage deviation, the phase current is distorted
as shown in Fig. 4.23a. After the balancing method is applied, the two capacitor
voltages are converge at the same value, and the distortion of the phase current is
eliminated as shown in Fig. 4.23b.
Fig. 4.22 Experimental results when Ma = 0.365: a conventional SVM, b neutral-point voltage
ripple reduction method (reprinted from [9], Figs. 15 and 16)
4.2
Neutral-Point AC Ripple Voltage Reduction Methods
175

References
1. Jiang, W.D., S.W. Du, L.C. Chang, Y. Zhang, and Q. Zhao. 2010. Hybrid PWM strategy of
SVPWM and VSVPWM for NPC three-level voltage-source inverter. IEEE Transactions on
Power Electronics 25 (10): 2607–2619.
2. Monge, S.B., S. Somavilla, J. Bordonau, and D. Boroyevich. 2007. Capacitor voltage balance
for the neutral-point-clamped converter using the virtual space vector concept with optimized
spectral performance. IEEE Transaction on Power Electronics 22 (4): 1128–1135.
3. Shen, J., S. Schröder, B. Duro, and R. Roesner. 2013. A neutral-point balancing controller for
a three-level inverter with full power-factor range and low distortion. IEEE Transaction on
Industry Applications 49 (1): 138–148.
4. Zabalza, J.C., P.I. Moreno, D. Madariaga, G. Calvo, and M.A. Rodríguez. 2013, October.
Voltage balancing control in 3-level neutral-point clamped inverters using triangular carrier
PWM modulation for FACTS applications. IEEE Transaction on Power Electronics 28 (10):
4473–4484.
Fig. 4.23 Comparison of phase currents: a before the neutral-point voltage is balanced, b after the
neutral-point voltage is balanced (reprinted from [9], Fig. 18)
176
4
Neutral-Point Voltage Reduction

5. Pou, J., J. Zaragoza, S. Ceballos, M. Saeedifard, and D. Boroyevich. 2012, A carrier-based
PWM strategy with zero-sequence voltage injection for a three-level neutral-point-clamped
converter. IEEE Transactions on Power Electronics 27 (2): 642–651.
6. Lee J.S., and K. B. Lee. 2014, A carrier-based PWM method for neutral-point ripple reduction
of a 3-level inverter. In Proceedings of IEEE Energy Conversion Congress and Exposition
Conference (pp. 2096–2100).
7. Choi, U.M., H.H. Lee, and K.B. Lee. 2013. Simple neutral-point voltage control for
three-level inverters using a discontinuous pulse width modulation. IEEE Transaction on
Energy Conversion 28 (2): 434–443.
8. Bendre, A., G. Venkataramanan, and D. Rosene. 2006. Modeling and design of a
neutral-point
voltage
regulator
for
a
three-level
diode-clamped
inverter
using
multiple-carrier modulation. IEEE Transaction on Industrial Electronics 53 (3): 718–726.
9. Choi, U.M., F. Blaabjerg and K.B. Lee. 2015. Method to Minimize the Low-Frequency
Neutral-Point Voltage Oscillations with Time-Offset Injection for Neutral-Point-Clamped
Inverters. IEEE Transactions on Industry Applications 51 (2): 1678–1691.
10. Lee, J.S., and K.B. Lee. 2016. Time-offset injection method for neutral-point AC ripple
voltage reduction in a three-level inverter. IEEE Transactions on Power Electronics 31 (3):
1931–1941.
11. Maheshwari, R., S. Munk-Nielsen, and S. Busquets-Monge. 2013, May. Design of
neutral-point voltage controller of a three-level NPC inverter with small DC-link capacitors.
IEEE Transaction on Industry Electronics 60 (5): 1861–1871.
12. Wang, C., and Y. Li. 2010, Analysis and calculation of zero-sequence voltage considering
neutral-point potential balancing in three-level NPC converters. IEEE Transaction on
Industrial Electronics 57 (7): 2262–2271.
References
177

Chapter 5
Leakage Current Reduction
Leakage current can be deﬁned as the current ﬂowing through the ground in a lot of
systems. The magnitude of the leakage current is deﬁned based on the application
and its topology. In particular, applications with transformerless topologies can be
attacked by leakage current. Leakage current leads to safety problems and quality
aggravation of the output current. Therefore, the leakage current has been restricted
in a lot of systems such as wind turbine systems, photovoltaic systems, and energy
storage systems by the regulation of the grid connection. A simple and normal
solution for leakage current reduction is to add a transformer. However, adding a
transformer decreases the total efﬁciency of the system and increases in terms of
volume and cost [1–3]. It is a big disadvantage in the recent market situation due to
a serious price war because transformers make up a large portion of the total cost of
a system. Other solutions, switching devices and passive components are being
used to reduce leakage current. Recently, modiﬁed PWM methods have been
proposed to mitigate leakage current.
Most of the existing methods focus on the two-level converter topology.
Recently, several leakage current reduction methods for small scale three-level
converters have been proposed. This section analyzes the cause of leakage current
in a photovoltaic system, which is a representative application suffering from
leakage current. In addition, the PWM methods for leakage current reduction are
introduced.
5.1
Leakage Current Analysis
5.1.1
Main Reason for Leakage Current
Leakage current and Common Mode Voltage (CMV) should be considered in PV
systems. Leakage current is generated by the leakage capacitor CPV which is
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_5
179

between the PV cells and the PV frame connected to the ground as shown in
Figs. 5.1 and 5.2. If there is no voltage difference between the PV cells and the PV
frame, leakage current does not ﬂow. However, the P voltage and N voltage of the
PV cells with respect to the grid ground have different voltage values depending on
the inverter switching method. The generated P and N voltages are referred to as
CMV and these voltages cause leakage current. Many countries restrict leakage
current to low values, and rules about leakage current should be satisﬁed for the
accreditation of manufactured goods.
5.1.2
Leakage Current Reduction Methods in H-Bridge
and Two-Level Converters
A. H-bridge converters [4, 5]
It is not easy to change the PWM method in the H-bridge converters used in
single-phase
systems.
Therefore,
additional
switching
devices
and
passive
Fig. 5.1 Leakage capacitor
existing in PV modules
Fig. 5.2 Grid connected PV
system
180
5
Leakage Current Reduction

components are used to reduce leakage current. Figures 5.3 and 5.4 show that
additional switching devices isolate the DC-link with the PV from the grid. These
topologies avoid building circuits that generate leakage current.
B. Two-level converters [6–12]
Not only new topologies based on two-level converter also a lot of PWM
methods have been proposed for the leakage current reduction of two-level con-
verters. The discontinuous PWM, active zero state PWM, and near state PWM
methods are representative methods for the leakage current reduction of two-level
converters. Figure 5.5 shows the PWM pattern and common-mode voltage leading
to the leakage current of the representative methods compared to the conventional
PWM method. The three PWM methods have a magnitude of common-mode
voltage that is lower than that of the conventional PWM method.
Filter
PV
S1
S1
S3
S4
S5
S6
Cdc
Cdc
CG-PV
A
B
S5
S6
Fig. 5.3 Highly efﬁcient and reliable inverter concept topology (SunWay)
Filter
PV
S1
S1
S3
S4
S5
Cdc
Cdc
CG-PV
A
B
Fig. 5.4 H5 Topology (SMA)
5.1
Leakage Current Analysis
181

5.1.3
Three-Level Converters
Three-level converters have more voltage vectors than two-level converters.
Therefore, a lot of PWM methods can be considered in three-level converters. This
section explains the reason for leakage current in three-level converters using circuit
analysis and introduces a PWM method for the leakage current reduction of
three-level converters.
A. Common-mode voltage of three-level converters
A grid-connected three-level inverter with PV is shown in Fig. 5.6. This ﬁgure
shows the leakage capacitor CPV, three level inverter, and the L-ﬁlter. It also shows
the leakage inductance LPV and leakage resistor RPV between the leakage capacitor
CPV and the grid ground (n). Sa1 and Sa3 of a leg are operated in reverse at the same
time. Sa2 and Sa4 also perform this operation. The leakage capacitor CPV is inﬂu-
enced by weather conditions. Therefore, the leakage current value can be changed
due to the environmental factors.
Figure 5.7 represents a simple model of Fig. 5.6 by considering the leakage
capacitor CPV that is connected at N. The three-phase voltages to N (VAN, VBN, and
Fig. 5.5 Comparison of PWM methods for leakage current reduction
182
5
Leakage Current Reduction

VCN) are considered in this model and Vdc is sum of VC1 and VC2. In a three-level
inverter, the output voltages of the inverter’s legs are determined by the connection
with one point among VP, VZ, and VN. If the grid ground (n) is the standard, the output
voltages can be divided into three cases depending upon the connection. In the ﬁrst
case, when the inverter’s output is connected to VP, the output voltage is Vdc + VN. In
the second case, the output voltage is Vdc/2 + VN when the output is connected at VZ.
In the last case, VN is the output voltage when the output is attached to VN.
VN is deﬁned by using the fact that the sum of the grid currents is zero. In
addition, the output voltages are denoted as VAN, VBN, and VCN. The grid currents
ﬂow due to the voltage difference between the output voltages of the inverter and
P
N
Z
Ea
Eb
Ec
Filter
Grid
n
Sa1
Sa2
Sa3
Sa4
Sb2
Sb3
Sc3
Sc2
Sb1
Sc1
Sb4
Sc4
C2
C1
P
V
CPV
LPV
CPV
LPV
Fig. 5.6 Three-phase grid-connected transformerless PV three-level inverter (reprinted from [13],
Fig. 1)
VP
VN
Ea
Eb
Ec
n
Sb1
Sc1
C2
C1
CPV
LPV
L
Sc2
Sc3
Sb2
Sc3
Sa1
Sa2
Sa3
VZ
VAN
VBN
VCN
Fig. 5.7 Simple model of a transformerless PV inverter (reprinted from [13], Fig. 2)
5.1
Leakage Current Analysis
183

the grid voltages in each phase. Therefore, the sum equation of the grid currents is
expressed as:
VAN þ VN  Ea
ZL
þ VBN þ VN  Eb
ZL
þ VCN þ VN  Ec
ZL
¼ 0
ð5:1Þ
Ea þ Eb þ Ec ¼ 0
ð5:2Þ
where ZL is the impedance of the L-ﬁlter. Equation (5.1) can be represented by
using (5.2), and the represented equation is expressed as:
VAN þ VBN þ VCN þ 3VN
ZL
¼ 0
ð5:3Þ
VN can be calculated from (5.3) and this voltage is expressed as:
VN ¼  VAN þ VBN þ VCN
3
ð5:4Þ
Likewise, VP is deﬁned using the same method.
VN is determined according to the output voltages of the inverter as (5.4). This
means that VN can be inﬂuenced due to the inverter switching state. Figure 5.8
shows the circuit for the output voltage levels (Vdc + VN, Vdc/2 + VN, and VN) and
the values of VAN, VBN, and VCN which are the ones among Vdc, Vdc/2, and 0.
Sa;b;cðVAN;BN;CNÞ ¼
Sa ¼ 1; VAN ¼ Vdc
Sa ¼ 1
2 ; VAN ¼ Vdc
2
Sa ¼ 0; VAN ¼ 0
Sb ¼ 1; VBN ¼ Vdc
Sb ¼ 1
2 ; VBN ¼ Vdc
2
Sb ¼ 0; VBN ¼ 0
Sc ¼ 1; VCN ¼ Vdc
Sc ¼ 1
2 ; VCN ¼ Vdc
2
Sc ¼ 0; VCN ¼ 0
8
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
<
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
:
9
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
=
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
;
ð5:5Þ
VN
Ea
Eb
Ec
n
CPV
LPV
L
Vdc
Vdc / 2
VAN
VBN
VCN
Sc
Sb
Sa
Fig. 5.8 Circuit for the
output voltages of an inverter
depending on the switching
states (reprinted from [13],
Fig. 3)
184
5
Leakage Current Reduction

Equation (5.1) is represented with switching states as:
VdcðSaÞ þ VN  Ea
ZL
þ VdcðSbÞ þ VN  Eb
ZL
þ VdcðScÞ þ VN  Ec
ZL
¼ 0
ð5:6Þ
Then, (5.6) is simply represented as:
VN ¼  VdcðSaÞ þ VdcðSbÞ þ VdcðScÞ
3
ð5:7Þ
Therefore, the value of VN can be selected among −Vdc, −5Vdc/6, −4Vdc/6,
−3Vdc/6, −2Vdc/6, −1Vdc/6, and 0 depending on the switching states, and VN
includes an AC component. The ac-component of VN generates leakage current
through the line including CPV.
The current equation is calculated by considering CPV. In Fig. 5.9, there are four
paths and the sum of the four currents through these four paths is zero. Therefore,
the current equation should be expressed as:
VAN þ VCM  Ea
ZL
þ VBN þ VCM  Eb
ZL
þ VCN þ VCM  Ec
ZL
þ VCM
ZPV
¼ 0
ð5:8Þ
where VCM is the voltage of VN with consideration of ZPV, and ZPV is the combined
impedance of CPV, RPV, and LPV.
From (5.8), using (5.4), VCM is expressed as:
VCM ¼
ZPV
3ZPV þ ZL
3VN
ð5:9Þ
VCM is proportional to VN. The leakage current can be calculated using VCM
because the voltages of the circuit in Fig. 5.9 are deﬁned from the grid ground (n).
The magnitude of the leakage current is calculated as:
VCM
Ea
Eb
Ec
n
CPV
LPV
L
Inverter
Ileakage
RPV
Fig. 5.9 Model circuit for
the output voltage of an
inverter (reprinted from [13],
Fig. 4)
5.1
Leakage Current Analysis
185

ICM
j
j ¼ VCM
j
j
ZPV
j
j ¼
3 VN
j
j
3ðRPV þ j2pf LPV þ
1
j2pf CPVÞ þ j2pf L


ð5:10Þ
The leakage current is the same as the current of the LC resonant circuit because
the resistor is normally small. The current reaches its peak at the resonant frequency
according to L and C.
Figure 5.10 shows the leakage current magnitude depending on the switching
frequency. These waveforms are calculated using (5.11). There are three waveforms
depending on the leakage resistor RPV. The leakage resistor RPV acts as a damping.
Therefore, the leakage current decreases due to a large RPV.
The total leakage current is the sum of each of the currents due to the odd
multiples of the switching frequency because CMV is a square wave. Therefore, the
total leakage current is expressed as:
ICM;total

 ¼
X
1
n¼1;3;5;...
ICMðnf Þ
j
j
ð5:11Þ
The total leakage current can increase if the switching frequency increases to the
value of the resonant frequency. However, the total leakage current is not pro-
portional to the switching frequency due to the damping resistor, which is the
leakage resistor RPV.
The leakage current is affected by the magnitude and frequency of CMV, the
leakage inductance LPV, leakage resistor RPV, and the leakage capacitor CPV from
(5.10). The leakage inductance LPV and the leakage resistor RPV are excluded from
the leakage current calculation, and the leakage capacitor CPV is decided based on
environmental factors. To decrease the leakage current, the magnitude and fre-
quency of VN or CMV should be low. In addition, (5.10) is valid when the grid is
replaced with a load.
Fig. 5.10 Leakage current
magnitude depending on the
frequency and RPV value
(reprinted from [13], Fig. 5)
186
5
Leakage Current Reduction

B. VN of the conventional SVPWM
The conventional PWM is commonly used in three-level inverters. A space
vector diagram of a three-level inverter including four types of vectors is shown in
Fig. 5.11. There are zero vectors, small vectors, medium vectors, and large vectors.
There are three combinations for a zero vector, two combinations for a small vector,
and one combination for a medium and a large vector as shown in Fig. 5.11.
Depending on the vector, the magnitude of VN for all of the vectors is deﬁned
from (5.7) in Table 5.1. The conventional PWM for a three-level inverter uses all of
the vectors to control its output voltage. Therefore, VN can be from 0 V to Vdc.
Solutions to reduce the leakage current are a small magnitude and a low
switching frequency of VN. These two solutions can be identiﬁed through (5.10).
The magnitude of VN should be small, and its frequency should be low to reduce the
leakage current.
In each switching period TT, the modulation index of an inverter is usually
greater than 0.44. For this condition, the zero vectors NNN and PPP are not used to
generate the output voltage of the inverter. Therefore, the magnitude of VN is from
Vdc/6 to 4Vdc/6 or from 2Vdc/6 to 5Vdc/6 according to the sector in Fig. 5.11. The
conventional PWM requires a low frequency of VN because this modulation
switches only once for each switching period TT in VN as shown in Fig. 5.12. As a
result, the conventional PWM shows the best sequence that does not generate a high
frequency.
Fig. 5.11 Space vector diagram of a three-level inverter
5.1
Leakage Current Analysis
187

Table 5.1 VN value according to the switching states
VSmall
Sa
Sb
Sc
|VN|
VMedium
Sa
Sb
Sc
|VN|
V0(NNN)
0
0
0
0
V7(PON)
1
1/2
0
3Vdc/6
V0(OOO)
1/2
1/2
1/2
3Vdc/6
V8(OPN)
1/2
1
0
3Vdc/6
V0(PPP)
1
1
1
Vdc
V9(PNO)
1
0
1/2
3Vdc/6
V1(POO)
1
1/2
1/2
4Vdc/6
V10(NOP)
0
1/2
1
3Vdc/6
V1(ONN)
1/2
0
0
1Vdc/6
V11(ONP)
1/2
0
1
3Vdc/6
V2(PPO)
1
1
1/2
5Vdc/6
V12(PNO)
1
0
1/2
3Vdc/6
V2(OON)
1/2
1/2
0
2Vdc/6
VLarge
Sa
Sb
Sc
|VN|
V3(OPO)
1/2
1
1/2
4Vdc/6
V13(PNN)
1
0
0
2Vdc/6
V3(NON)
0
1/2
0
1Vdc/6
V14(PPN)
1
1
0
4Vdc/6
V4(OPP)
0
1
1
5Vdc/6
V15(NPN)
0
1
0
2Vdc/6
V4(NOO)
1
1/2
1/2
2Vdc/6
V16(NPP)
0
1
1
4Vdc/6
V5(POO)
1
1/2
1/2
4Vdc/6
V17(NNP)
0
0
1
2Vdc/6
V5(NNO)
0
0
1/2
1Vdc/6
V18(PNP)
1
0
1
4Vdc/6
V6(POP)
1
1/2
1
5Vdc/6
V6(ONO)
1/2
0
1/2
2Vdc/6
P
S1a
S2a
S1b
S2b
S1c
S2c
V1
V13
V7
V1
V7
V13
V1
O
P
P
P
P
O
N
N
O
O
O
N
N
N
N
N
O
N
N
N
|VCM|
TT
Vdc/6
Vdc
Fig. 5.12 Switching order
and VN for the conventional
PWM at the region 3 of sector
1 (reprinted from [13], Fig. 7)
188
5
Leakage Current Reduction

C. Modulation technique using medium and zero vectors [12, 14]
Many combinations can produce a switching sequence because many vectors
exist in the space vector diagram with three levels. Therefore, the magnitude and
frequency of VN are changed depending on the selected switching sequence.
Modulation using only medium and zero vectors has been proposed as shown in
Fig. 5.13. This modulation can generate an output voltage by Vdc/2. However, it
requires a higher DC-link voltage compared to that of the conventional PWM.
Furthermore, it switches twice in a switching period TT. This makes the leakage
current high and increases the THD of the grid currents.
D. LMZVM (Large, Medium and Zero Vector Modulation) method [13]
The ﬁrst discussed modulation method has the best sequence in terms of fre-
quency, which is similar to that of the conventional PWM. In addition, it has a
lower magnitude of VN when compared to the conventional PWM. Using small
vectors critically increases or decreases VN. Therefore, this modulation does not use
small vectors to generate the output voltages of the inverter. Instead, it uses only
large vectors, medium vectors, and zero vectors. In addition, only OOO is used as
the zero vector because the ﬂuctuation of VN is minimized. Therefore, the space
vector diagram of a three-level inverter is divided into 12 sectors as shown in
Fig. 5.14.
When the output vector is in sector 1, V13, V7, and V0 are used to make the output
vector. In Fig. 5.15, the switching time for the output vector is calculated. The
medium vector’s switching time TM and the large vector’s switching time TL are
Fig. 5.13 Space vector diagram of a modulation technique using medium and zero vectors
5.1
Leakage Current Analysis
189

calculated in advanced according to h. Then the remaining time TZ is allocated for
the zero vector. As in sector 1, the adjacent vectors are used in N sector.
Another consideration is the switching sequence. This sequence is important for
reducing the leakage current. Thus, only one switching should be executed in a
switching period TT. If frequencies higher than the switching frequency are gen-
erated, the leakage current increases. Therefore, the selected sequence is shown in
Fig. 5.16.
The output vector of sector 1 consists of a large vector, a medium vector, and a
zero vector in this order. This sequence switches only once per switching period TT,
and the magnitudes of VN are from 2Vdc/6 to 3Vdc/6 and from 3Vdc/6 to 4Vdc/6
depending on the sector. In summary, the frequency of VN is the same as that of the
conventional PWM, and the magnitude of VN is half that of the conventional PWM.
Fig. 5.14 Space vector diagram of a three-level inverter for LMZVM (reprinted from [13], Fig. 8)
Fig. 5.15 Output vector
times in sector 1 (reprinted
from [13], Fig. 9)
190
5
Leakage Current Reduction

• Simulation and experimental results of the LMZVM method.
Table 5.2 shows the parameters used in the simulation and experiment.
Figure 5.17 shows VN and the leakage current waveforms when the conventional
PWM is used. VN has a magnitude from 200 to 500 V and from 100 to 400 V
depending on the sector. At that time, the leakage current ranges in value from –500
to 500 mA.
Figure 5.18a shows the dropped VN and the leakage current waveforms when the
LMZVM is used. The small vectors that generate VN of −5Vdc/6 and −Vdc/6 are not
used. In comparison with Fig. 5.18a, VN is half that in Fig. 5.17. For this reason, the
leakage current decreases approximately by half. Figure 5.18b shows the ON “1”/
P
S1a
S2a
S1b
S2b
S1c
S2c
V13
V7
V0
V0
V7
V13
P
O
O
P
P
N
O
O
O
O
N
N
N
O
O
N
N
|VN|
TT
Vdc/6
Vdc
Fig. 5.16 Switching order
and VN for LMZVM in sector
1 (reprinted from [13],
Fig. 10)
Table 5.2 Simulation and experimental parameters
DC-link voltage
600 V (Simulation)/300 V (Experiment)
Filter
2 mH
DC-link capacitor
1100 lF
CPV
0.01 lF, 0.015 lF
Switching frequency
10 kHz
RPV
15 X
5.1
Leakage Current Analysis
191

OFF “0” signals of the switches and VN when h is in the sector 1 of Fig. 5.14. The
switching order is V13(PNN)-V7(PON)-V0(POO)-V7(PON)-V13(PNN), which is the
same as that of Fig. 5.16. Also, the magnitude of VN is from 200 to 300 V and
switching occurs once in TT.
Figure 5.19a, b show VN and the leakage current when the conventional PWM is
used in the experiment. The magnitude ranges of VN are from 100 to 250 V and from
50 to 200 V. The peak values of the leakage current are 200 and 280 mA as shown in
Fig. 5.19a, b. VN and the leakage current are shown in Fig. 5.20a, b when the
LMZVM is applied. The leakage currents decrease and the peak values are 100 and
180 mA because VN decreases with a magnitude from 150 to 200 V and from 100 to
150 V. When the magnitude of VN is reduced by one-third, the leakage current also is
reduced. These results indicate the same characteristics as the simulation results.
E. LMSVM (Large, Medium and Small Vector Modulation) method [13]
During the LMZVM operation, it is not possible to control the neutral-point
voltage because this technique uses large, medium, and zero vectors. For
neutral-point voltage balance, the small vectors have to be used. This is available to
the N-type small vectors for top side DC-link charging and to the P-type small
vectors for bottom side dc-link charging. Therefore, the second technique, based on
Fig. 5.17 Simulation waveforms of VN and leakage current with the conventional PWM
(reprinted from [13], Fig. 14)
192
5
Leakage Current Reduction

Fig. 5.18 Simulation waveforms of LMZVM: a VN and leakage current, b with the ON “1”/OFF
“0” signals and VN (reprinted from [13], Figs. 15 and 16)
5.1
Leakage Current Analysis
193

LMZVM, substitutes the zero vector with the small vector (LMSVM), which is the
closest to the present large and medium vectors to prevent the THD of output
current from increasing.
In sector 1, V2[OON], one of the N-type vectors, is selected for neutral-point
voltage control. Then, the switching order is V2[OON]-V7[PON]-V13[PNN]-
V7[PON]-V2[OON] which is shown in Fig. 5.21. The top side capacitor voltage
increases due to the N-type small vector V2[OON]. The magnitude of VN is
maintained as the magnitude of the LMZVM. In sector 2, V1[POO], one of the
P-type vectors, is used and the switching order is V1[POO]- V7[PON]-V14[PPN]-
Fig. 5.19 Experimental result of VN and the leakage current using the conventional PWM:
a CPV = 0.01 lF, b CPV = 0.015 lF (reprinted from [13], Fig. 22)
194
5
Leakage Current Reduction

V7[PON]-V1[POO]. The bottom side capacitor voltage increases due to the P-type
small vector V1[POO], and the magnitude of VN is the same as that of the LMZVM.
In sectors 1, 4, 5, 8, 9, and 12, the N-type small vectors are chosen and these vectors
increase the top side capacitor voltage. The chosen P-type small vectors increase the
bottom side capacitor voltage in sectors 2, 3, 6, 7, 10, and 11.
The switching times in the odd sectors and even sectors are calculated as shown
in the following equations:
Fig. 5.20 Experimental result of VN and the leakage current using LMZVM: a CPV = 0.01 lF,
b CPV = 0.015 lF (reprinted from [13], Fig. 23)
5.1
Leakage Current Analysis
195

Even sectors:
TL ¼ 1  2
ﬃﬃﬃ
3
p
mi sin h
h
i
TT
TM ¼ 3mið
ﬃﬃﬃ
3
p
sin h þ cos hÞ  2
h
i
TT
TS ¼ 2  mið
ﬃﬃﬃ
3
p
sin h þ 3 cos hÞ
h
i
TT
ð5:12Þ
Odd sectors:
TL ¼ ½1 þ mið
ﬃﬃﬃ
3
p
sin h  3 cos hÞTT
TM ¼ ½2mið3coshÞ  2TT
TS ¼ ½2 þ mið
ﬃﬃﬃ
3
p
sin h  3 cos hÞTT
ð5:13Þ
where TL is the large vector’s switching time, TM is the medium vector’s switching
time, TS is the small vector’s switching time, h is the grid’s angle, Ma is the
modulation index (Vref /Vdc), and TT is the switching period.
P
S1a
S2a
S1b
S2b
S1c
S2c
V2
V7
V13
V13
V7
V2
O
P
P
P
O
O
O
N
N
O
O
N
N
N
N
N
N
|VN|
TT
Vdc/6
Vdc
Fig. 5.21 Switching order
and VN for LMSVM in sector
1 (reprinted from [13],
Fig. 11)
196
5
Leakage Current Reduction

The switching times, which are calculated by (5.12) and (5.13), have to be
positive values. Therefore, the h range to obtain positive values for TL and TM is
considered because TT can be calculated by the following equation:
TS ¼ TT  ðTM þ TLÞ
ð5:14Þ
• Feasible range of the LMSVM method
The h range to obtain positive values for TL and TM is related to Ma, and is deﬁned
depending on the sectors. In sectors 1 and 2, the relationship between h and Ma is
expressed as
Sector 1 (0\h\30Þ :
sin h\
1
2
ﬃﬃﬃ
3
p
Ma
; for TL [ 0
sinðh  30Þ [
1
3Ma
; for TM [ 0
ð5:15Þ
Sector 2 (30\h\60Þ :
sinðh  30Þ [ 
1
2Ma
; for TL [ 0
cos h [
1
3Ma
; for TM [ 0
ð5:16Þ
The Ma value is calculated as 0.518 by setting Vdc as 600 V and Vref as
311.14 V, which are the parameters used at the grid connection. To satisfy the two
equations in (5.15) and (5.16), each h range is calculated as
sector 1 : 10:05\h\30
sector 2 : 30\h\49:95
ð5:17Þ
The LMSVM is applied in the range of (5.17). The h range from (5.17) can be
expanded to all of the sectors and these ranges are expressed as:
30ðS  1Þ þ 10:05\h\30S; for odd sectors
30ðS  1Þ\h\60S  10:05; for even sectors
ð5:18Þ
where S is a sector.
All of the ranges from (5.18) are shown as Fig. 5.22. The gray parts are the
ranges for the LMSVM. In the gray parts, the parts with patterns indicate the range
where the P-type small vectors are chosen to increase the bottom side capacitor
voltage, and the N-type small vectors are chosen for the top side capacitor voltage
in the parts without a pattern. In the rest of the parts, the LMZVM is always applied.
5.1
Leakage Current Analysis
197

If the bottom side capacitor voltage is larger than the top side capacitor voltage, the
LMSVM is applied in the gray parts without a pattern, and the LMZVM is used
both in the gray parts with a pattern and in the rest of the parts. On the other hand, if
the top side capacitor voltage is larger than the bottom side capacitor voltage, the
LMSVM is used in the gray parts with a pattern, and the LMZVM is used in the rest
of the gray parts without a pattern.
F. Hybrid operation of the LMZVM and LMSVM methods [13]
The proposed modulation technique is based on the SVM technique. In the SVM
technique, the switching times are calculated by using h and Ma. The calculation
amount of the ﬁrst proposed modulation technique is similar to that of the con-
ventional PWM based on the SVM technique. However, to apply the second
proposed modulation technique, the sector calculation of the neutral-point voltage
balancing and the (5.15) and (5.16) calculations are needed.
Figure 5.23 shows a control block diagram to balance the dc-link capacitor
voltages by using the LMSVM. From Fig. 5.23, both leakage current reduction and
neutral-point voltage balancing control are possible. When the dc-link voltages are
balanced, only the LMZVM is applied. If unbalancing of the DC-link voltages
occurs, the LMSVM is substituted for the LMZVM depending on the sectors.
• Simulation and experimental results of the hybrid method.
Table 5.3 shows the parameters used in the simulation and experiment.
Neutral-point voltage balancing control is conducted by the control block of
Fig. 5.23, and the results are shown in Fig. 5.24a. The switching mode 0 means the
Fig. 5.22 Space vector diagram of the h range for LMSVM when Ma is 0.518 (reprinted from
[13], Fig. 12)
198
5
Leakage Current Reduction

LMZVM and switching mode 1 means the LMSVM. The bottom side capacitor
voltage is higher than the top side before 0.8 s. From 0.8 s, the LMSVM is applied
to decrease the bottom side capacitor voltage in sectors 1, 4, 5, 8, 9, and 12. Sectors
1, 4, 5, 8, 9, and 12 contain the N-type vectors. The LMSVM is applied in the valid
range of these sectors that is calculated from (5.14).
When the LMZVM and LMSVM are applied together, the magnitude of VN is
maintained from 200 to 300 V and from 300 to 400 V, which is the same as when
only the LMZVM is applied, and the results are shown in Fig. 5.24b. However,
compared to when only the LMZVM is applied, the leakage current becomes bigger
in the LMSVM operation parts because the switching number in VN is doubled.
Table 5.3 Simulation and experimental parameters
DC-link voltage
600 V (Simulation)/300 V (Experiment)
Filter
2 mH
DC-link capacitor
1100 uF
CPV
0.01 lF, 0.015 lF
Switching frequency
10 kHz
RPV
15 X
LMZVM
VTop > VBottom
Sector=(2, 3, 6, 7, 10, 11)
Sector=(1, 4, 5, 8, 9, 12)
Y
Y
Y
Y
N
N
N
Calculating the range of θ for LMSM 
by using Vdc and Vref
The angle is in θ ranges 
Y
LMSVM
START
N
Fig. 5.23 Block diagram of the leakage current reduction and the neutral-point voltage balancing
control (reprinted from [13], Fig. 13)
5.1
Leakage Current Analysis
199

Fig. 5.24 Simulation waveforms of VN and leakage current with a hybrid method of LMZVM and
LMSVM (reprinted from [13], Fig. 17 and 18)
200
5
Leakage Current Reduction

Figure 5.25 shows the transition of the neutral-point voltage balancing control in
the experiment. Switching modes 0 and 1 represent the LMZVM and LMSVM. The
values of VTop and VBottom are different before the neutral-point voltage balancing
control is applied. After the start point in Fig. 5.25a, the switching mode is con-
tinuously changed. The switching mode becomes 1 in the ranges that contain the
N-type small vectors. From Fig. 5.25b, it can be seen that the switching mode is
changed to 1 in the valid range of sectors 1, 4, 5, 8, 9, and 12. This valid value is
from (5.14) and such simulations. In the rest of these ranges which are represented
Fig. 5.25 Experimental result of the neutral-point voltage balancing control with a hybrid method
of LMZVM and LMSVM (reprinted from [13], Fig. 24)
5.1
Leakage Current Analysis
201

as the switching mode 0, the LMZVM is used. The difference between VTop and
VBottom progressively decreases and becomes zero with the LMSVM.
In the LMSVM operation range, VN is maintained at the same value as the
LMZVM as shown in Fig. 5.26a, b. Like the analysis in section III-B, the LMSVM
causes a double frequency in these operation ranges, and this double frequency is
identiﬁed in VN of Fig. 5.26a, b. Due to the increased frequency, the leakage current
is raised during the LMSVM operation. In Fig. 5.26a, the leakage current is from
−100 to 100 mA during the LMZVM operation and from −130 to 130 mA during
the LMSVM operation.
Both the LMSVM and the LMSVM with LMZVM raise the THD of the output
currents. Figure 5.27a shows the line-to-line voltage of an inverter using the
Fig. 5.26 Experimental result of VN and the leakage current using a hybrid method of LMZVM
and LMSVM: a CPV = 0.01 lF, b CPV = 0.015 lF (reprinted from [13], Fig. 25)
202
5
Leakage Current Reduction

Fig. 5.27 Experimental result of the line-to-line voltage: a SVPWM, b LMZVM, c hybrid
method (LMZVM and LMSVM) (reprinted from [13], Figs. 26, 27 and 28)
5.1
Leakage Current Analysis
203

conventional PWM. The level of the line-to-line voltage is ﬁve levels. This is a
characteristic of three-level inverters, and the cause of the THD is decreased than
that of two-level inverters.
In the LMZVM and LMSVM, the THD increase is identiﬁed from Fig. 5.27b, c.
The waveform of Fig. 5.27b is the line-to-line voltage using the LMZVM. The peak
part of the line-to-line voltage has values of Vdc and 0. During the LMSVM
operation, the line-to-line voltage has the same value as that of the convectional
PWM in the LMSVM operation part as shown in Fig. 5.27c. Therefore, the THD
decreases more in the LMZVM operation with LMSVM than with the LMZVM
operation alone.
References
1. González, R., J. López, P. Sanchis, and L. Marroyo. 2007. Transformerless inverter for
single-phase photovoltaic systems. IEEE Transactions on Power Electronics 22 (2): 693–697.
2. Koutroulis, E., and F. Blaabjerg. 2013. Design optimization of transformerless grid-connected
PV inverters including reliability. IEEE Transactions on Power Electronics 28 (1): 325–335.
3. Zhang, L., K. Sun, L. Feng, H. Wu, and Y. Xing. 2013. A family of neutral point clamped
full-bridge topologies for transformerless photovoltaic grid-tied inverters. IEEE Transactions
on Power Electronics 28 (2): 730–738.
4. Saridakis, S., E. Koutroulis, and F. Blaabjerg. 2013. Optimal Design of Modern
Transformerless PV Inverter Topologies. IEEE Transactions on Energy Conversion 28 (2):
394–404.
5. Zhao, Z., J. Lai, and Y. Cho. 2013. Dual-Mode Double-Carrier-Based Sinusoidal Pulse Width
Modulation Inverter With Adaptive Smooth Transition Control Between Modes. IEEE
Transactions on Industrial Electronics 60 (5): 2094–2103.
6. Kerekes, T., R. Teodorescu, M. Liserre, C. Klumpner, and Mark Sumner. 2009. Evaluation of
three-phase transformerless photovoltaic inverter topologies. IEEE Transactions on Power
Electronics 24 (9): 2202–2211.
7. Heldwein, M.L., H. Ertl, J. Biela, and J.W. Kolar. 2010. Implementation of a transformerless
common-mode active ﬁlter for ofﬂine converter systems. IEEE Transactions on Industrial
Electronics 57 (5): 1772–1786.
8. Dong, D., F. Luo, D. Boroyevich, and P. Mattavelli. 2012. Leakage current reduction in a
single-phase bidirectional AC–DC full-bridge inverter. IEEE Transactions on Power
Electronics 27 (10): 4281–4291.
9. Yang, B., W. Li, Y. Gu, W. Cui, and X. He. 2013. Improved transformerless inverter with
common-mode leakage current elimination for a photovoltaic grid-connected power system.
IEEE Transactions on Power Electronics 27 (2): 752–762.
10. Hava, A.M., and E. Ün. 2011. A high-performance PWM algorithm for common-mode
voltage reduction in three-phase voltage source inverters. IEEE Transactions on Power
Electronics 26 (7): 1998–2008.
11. Kimball, J.W., and M. Zawodniok. 2011. Reducing common-mode voltage in three-phase
sine-triangle PWM with interleaved carriers. IEEE Transactions on Power Electronics 26 (8):
2229–2236.
12. Cavalcanti, M.C., K.C. de Oliveira, A.M. de Farias, F.A.S. Neves, G.M.S. Azevedo, and
F.C. Camboim. 2010. Modulation techniques to eliminate leakage currents in transformerless
three-phase photovoltaic systems. IEEE Transactions on Industrial Electronics 57 (4):
1360–1368.
204
5
Leakage Current Reduction

13. Lee, J.S., and K.B. Lee. 2014. New modulation techniques for a leakage current reduction and
a neutral-point voltage balance in transformerless photovoltaic systems using a three-level
inverter. IEEE Transactions on Power Electronics 29 (4): 1720–1732.
14. Cavalcanti, M.C., A.M. Farias, K.C. Oliveira, F.A.S. Neves, and J.L. Afonso. 2012.
Eliminating leakage currents in neutral point clamped inverters for photovoltaic system. IEEE
Transactions on Industrial Electronics 59 (1): 435–443.
References
205

Chapter 6
Switch Fault Diagnosis and Tolerant
Control in Cascaded H-Bridge Multilevel
Inverters
As previous mentioned, multilevel inverters have become an increasingly attractive
topology for industrial high-voltage applications. They have enabled important
development in the ability to reach high power with increasing voltage levels.
Multilevel inverters have particular advantages and are used in many applications such
as pipeline pumps, rolling machines, and railway electrical traction drive systems [1–4].
Multilevel inverters have many topologies, such including diode-clamped multilevel
inverters like the NPC topology, ﬂying capacitor multilevel inverters, and CHMIs.
Among these topologies, the CHMI is one of the most popular inverter topologies used
in high-power and medium-voltage (MV) drives [5, 6]. CHMIs are simple and modular
in structure, and do not require extra hardware such as clamp diodes or capacitors. As a
result, the manufacturing process is fast and economical. The modularized structure of
this topology as shown in Fig. 6.1 enables the number of output voltage levels to be
easily increased by adding more H-bridge inverter cells.
A common characteristic of all multilevel topologies is that a large number of
semiconductors and passive components are required. With this increase in the
number of switches, the fault probability also increases. As a result, reliability
decreases. The reliability of power electronics equipment is very important because
multilevel inverter systems are utilized in high-power applications. For example,
industrial applications such as industrial manufacturing are dependent on induction
motors and their inverter systems for process control. A fault can cause an
unbalanced output voltage and current while a traction motor is operating. The
results can be serious damage to the traction motor if it runs in this state for a long
period of time. In addition, if a system has to be shut down, the downtime can lead
to a great ﬁnancial loss per hour. Therefore fault tolerance is vital to companies.
Many engineers and researchers have focused their efforts on fault detection and
preventive maintenance to mitigate this issue. Fortunately, the CHMI provides a
large number of redundant switching states, which allows an inverter to maintain
normal operation under internal fault conditions. Therefore, the several studies on
switch fault detection and tolerant control for multilevel inverters are still in
© Springer Nature Singapore Pte Ltd. 2017
K.-B. Lee and J.-S. Lee, Reliability Improvement Technology for Power Converters,
Power Systems, DOI 10.1007/978-981-10-4992-7_6
207

progress. This chapter introduces switching device fault detection methods and
tolerant controls for the CHMI.
6.1
Cascaded H-Bridge Multilevel Inverters
6.1.1
Conﬁguration
The general a CHMI is composed of several H-bridge cells that are connected in
series and it is expanded to three-phase systems as shown in Fig. 6.2. In the CHMI,
the minimum variation between the voltage levels is the DC-link voltage (Vcap)
connected to each H-bridge cell, and the number (m) of voltage levels of a phase is
determined using the number (H) of H-bridge cells connected in series. The rela-
tionship between them is expressed as:
Cell-1
Cell-2
Cell-H
Vout
Vcap
Vcap
Vcap
Sa1
Sa2
Sa4
Sa3
Sb1
Sb2
Sb4
Sb3
Sn1
Sn2
Sn4
Sn3
Fig. 6.1 Structure of a
CHMI (reprinted from [7],
Fig. 1)
208
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

m ¼ 2H þ 1:
ð6:1Þ
At the inverter side, the switching state of Cell-H (H = 1, 2, 3) is determined by
the logical value of two signals (Sk1, Sk3), which can be 1 and 0 representing the
ON and OFF state of each switch device, respectively. Sk2 and Sk4 are switched
complementarily to Sk1 and Sk3. This leads to four different binary combinations
that generate three different output voltages +Vcap, 0, and −Vcap. Because the cells
are connected in series, the total inverter output voltage of the u-phase, for example,
is given by:
vuM ¼
X
N
k¼1
vuk ¼
X
N
k¼1
VcapðSk1  Sk3Þ
ð6:2Þ
The voltage level, m, is always an odd number for the CHMI and can be
extended to any number of voltage levels. The total number (Nsw) of active switches
(IGBTs) used in the CHMI can be calculated from
dc
V
dc
V
dc
V
Rectifier
Rectifier
Rectifier
TR
dc
V
dc
V
dc
V
Rectifier
Rectifier
Rectifier
TR
Multi-phase TR
Rectifier
Rectifier
Rectifier
TR
Grid
H-bridge cell
Vcap
Vcap
Vcap
Va
Vb
Vc
Fig. 6.2 Three-phase CHMI system
6.1
Cascaded H-Bridge Multilevel Inverters
209

Nsw ¼ 6ðL  1Þ:
ð6:3Þ
Isolated DC sources are normally obtained from diode rectiﬁers, including
multi-phase transformers, to achieve a low line current harmonic distortion and a
high input power factor.
To overcome this problem, a modiﬁed conﬁguration which is a network inverter
is shown in Fig. 6.3 [6]. One rectiﬁer is used to transform the AC voltages of the
grid to DC voltage of the DC-link and every H-bridge cell should have a DC-link.
In other words they are connected to the DC-link in parallel. The most important
characteristic is that each H-bride cell has a transformer at its output. One H-bridge
cell which is a sub H-bridge cell has a special transformer which is different from
the others. The rest of the H-bridge cells which are main H-bridge cells use the
same transformer and are in charge of power transmission.
dc
V
dc
V
dc
V
Rectifier
Rectifier
Rectifier
TR
dc
V
dc
V
dc
V
Rectifier
Rectifier
Rectifier
TR
Multi-phase TR
Rectifier
Rectifier
Rectifier
TR
Grid
H-bridge cell
Vcap
Vcap
Vcap
Va
Vb
Vc
Fig. 6.3 Three-phase modiﬁed CHMI system
210
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

6.1.2
PWM Methods
Various switching methods exist for multilevel inverters, including space vector
pulse-width modulation (PWM), multicarrier-based PWM, selective harmonic
elimination, and nearest level control. Among these methods, the multicarrier-based
PWM is the most popular due to its simple realization and applicability to various
topologies. Multicarrier PWM methods can be classiﬁed into Phase-Shifted PWM
(PS-PWM) and Level-Shifted PWM (LS-PWM) methods.
A. Level-shifted PWM
In LS-PWM, the m-level CHMI needs (m −1) carriers which have the same
frequency and magnitude, and are vertically disposed. The operating principle of
the LS-PWM method, which is a seven-level CHMI, is shown in Fig. 6.4. The
seven-level multilevel inverter requires six carriers with the same frequency and
amplitude. Each carrier is vertically disposed. To determine the switching states of
each H-bridge cell, the six carriers are compared with their corresponding reference
signals. The phase voltage of the CHMI is generated through a summation of the
output voltage for each of the H-bridge cells. The amplitude of the voltage level is
the separated DC source, Vcap. By generating the output voltage of each H-bridge
cell, a seven voltage-level scan is generated by the LS-PWM switching process.
In the LS-PWM, it is identiﬁed that only one of the H-bridge cells conducts the
switching operation and the other H-bridge cells keep their switching state every
one switching period. This means that the main switching frequency of the phase
voltage is the same as that of the H-bridge cell.
+
vu1
-
vuM
M
vvM
vwM
Zm
u-phase
v-phase
w-phase
iu
iv
iw
S13
S11
S14
S12
Cell-1
Vcap
S23
S21
S24
S22
Cell-2
S33
S31
S34
S32
Cell-3
+
vu2
-
+
vu3
-
O
Vcap
Vcap
(a)
(b)
Fig. 6.4 LS-PWM method: a the conﬁguration of carrier signals and output voltage,
b three-phase seven-level CHMI (reprinted from [8], Fig. 1)
6.1
Cascaded H-Bridge Multilevel Inverters
211

Vx,C1
Leg-A
Leg-B
Vx,ref
Leg-A
Leg-B
Vx,C2
Vcarrier1
Vcarrier2
Vcarrier3
Vcarrier4
HBC1
HBC2
θs
Vcap
-Vcap
0
Vx,ref
Vx,ref
Sx,11
Sx,12
Sx,13
Sx,14
Sx,21
Sx,22
Sx,23
Sx,24
Vx,C1
Leg-A
Leg-B
Vx,ref
Leg-A
Leg-B
Vx,C2
Vcarrier1
Vcarrier2
Vcarrier3
Vcarrier4
HBC1
HBC2
θs
Vcap
-Vcap
0
Vx,ref
Vx,ref
Sx,11
Sx,12
Sx,13
Sx,14
Sx,21
Sx,22
Sx,23
Sx,24
(a)
(b)
Fig. 6.5 Three-phase CHB 5-level inverter: a the conﬁguration of carrier signals in a phase,
b voltage waveforms
212
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

B. Phase-shifted PWM
Like the level-shifted PWM, the m-level CHMI needs (m −1) phase-shifted
carriers. The carriers have the same frequency and magnitude. The phase shift (hc)
between two adjacent carriers depend on the voltage level and is represented as:
hc ¼ 360
m  1 :
ð6:4Þ
Each carrier determines the switching state of each leg. The phase voltage of the
CHMI is the summation of all of the H-bridge cells connected in series. In the
PS-PWM, all of the H-bridge cells conduct the switching operation. Therefore, the
main frequency (finv) of the phase voltage is increased depending on the number
(H) of H-bridge cells. This relationship is expressed as:
finv ¼ ðm  1ÞfHBC ¼ 2HfHBC;
ð6:5Þ
where fHBC is the switching frequency applied to the H-bridge cells.
The operating principle of the PS-PWM method, which is a ﬁve-level CHMI, is
shown in Fig. 6.5. Four carriers are used and the phase shift between any two
adjacent carriers is 90°. The two carrier signals which are symmetric with respect to
the time-axis are used together in one HBC and the switches at each HBC operate
by the unipolar PWM method. As a result, a different output voltage is generated in
each HBC, and the synthesized phase voltage of the CBHI has a frequency that is
4-times larger than the switching frequency.
6.2
Fault Diagnosis
The fault diagnosis methods for multilevel inverters deal with both the open-circuit
fault and short-circuit faults in a switch. Like the fault diagnosis methods of
three-level converters, the methods using additional devices will be introduced ﬁrst.
Then the state of the art fault diagnosis method which use only currents will be
shown.
6.2.1
Fault Diagnosis Using Additional Devices
Voltage sensors are installed at the output of H-bridge cell as shown in Fig. 6.6 [9].
This method focuses on short-circuit fault and uses the fault characteristic where the
output voltage of the H-bridge cell containing the short-circuit fault switch becomes
6.1
Cascaded H-Bridge Multilevel Inverters
213

zero. The measured output voltages are compared with the corresponding desired
output voltages. If they are not equal, the fault signal is generated at every H-bridge
cell.
Voltage sensors installed at the output of a phase are used to diagnosis fault
switches as shown in Figs. 6.7 and 6.8 [10, 11]. The method shown in Fig. 6.7 can
diagnose both open-circuit and short-circuit faults. The position of the fault switch
is detected through a frequency analysis of the measured output voltage of the
phase. The switching components of the H-bridge cells are extracted from the
output voltage of the phase. The magnitude and phase for each of the switching
components are used to distinguish the position of the fault switch. Therefore, the
performance of this method is guaranteed in a CHMI using the PS-PWM method.
The method shown in Fig. 6.8 uses an artiﬁcial intelligence algorithm to detect a
switch fault depending on the output voltage pattern caused by the switch fault, and
the position of the fault switch is determined.
Fig. 6.6 Fault diagnosis using voltage sensors installed at the output of each H-bridge cell
(reprinted from [9], Fig. 4)
Fig. 6.7 Frequency based fault diagnosis using voltage sensors installed at the output of a phase
(reprinted from [10], Fig. 7)
214
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

6.2.2
Fault Diagnosis Using Currents [7]
The current shape is inﬂuenced by the position of the fault switch. Therefore, it is
possible to detect the position of a fault switch from an analysis of the relationship
between the current shape and the fault switch. To implement it, the overall
operation conditions such as the switching method applied in the multilevel
inverter, the current path depending on the switching state, the power factor, and so
on, must be known. This chapter introduces an open-circuit fault switch diagnosis
method for the CHMI using the LS-PWM method. This method only uses output
current which is already used to control the CHMI. Therefore, it does not need
additional devices.
A. Zero-voltage switching states
When an open-switch fault occurs in a CHMI using the LS-PWM method, the
location of the current distortion is different depending on the faulty cell. If the
open-switch fault occurs in Cell-2, for instance, the current distortion is generated in
the second voltage level (+Vcap * +2Vcap or –Vcap * −2Vcap). Therefore, if the
output voltage level of the location of the current distortion is detected, the faulty
cell can be found. However, to apply this method, zero-voltage switching states
Fig. 6.8 AI-based diagnosis using voltage sensors installed at the output of phase (reprinted from
[11], Fig. 8)
6.2
Fault Diagnosis
215

must be considered, because the location of the current distortion differs depending
on zero-voltage switching states.
There are two types of zero-voltage switching states in an H-bridge cell. In
Fig. 6.9, one type is when Sx1 and Sx2 are on while Sx3 and Sx4 are off. The other is
the exact opposite. This is summarized in Table 6.1. This basic theory is important
for the open-switch fault detection method. In this chapter, the current paths
depending on the zero-voltage switching states are presented. In addition, an
analysis of the current paths is done considering open-switch fault conditions.
The current path, according to the two types of zero-voltage switching states in a
seven-level CHMI with a low modulation index Ma, is shown in Fig. 6.10. When
Ma is less than 0.33, only a single cell generates output voltage. In this case, Cell-1
generates the output voltage, while the other cells make the current path by
zero-voltage switching. The output currents ﬂow through the on-state switches and
diodes. Therefore, the current path is changed according to the zero-voltage
switching states. In addition, the zero-voltage switching states affect the current
path when an open-switch fault occurs.
B. Current path with open-switch faults
In each H-bridge cell, both Sx1 and Sx4 are used for the positive output voltage
and current. However, when an open-switch fault occurs, the characteristic of the
current distortion differs depending on the zero-voltage switching states (this also
applies to Sx2 and Sx3).
The current paths of Cell-3 under normal and open-switch fault conditions, when
Sx3 and Sx4 are on for zero-voltage switching and the output current I > 0, are
shown in Fig. 6.11. The solid line indicates the current path under normal condi-
tions, while the dashed line indicates faulty conditions. If an open-switch fault
occurs on switch Sc1, the current path is the same as the normal condition, which
does not cause a distortion in the current waveform. However, if the modulation
index is greater than 0.66, the current distortion is generated by an Sc1 fault, as
Sa1
Sa2
Sa4
Sa3
Vcap
Vout
Fig. 6.9 An example of one
H-bridge cell
Table 6.1 Zero-voltages
switching states
Sx1
Sx2
Sx3
Sx4
AC terminal voltage
On
On
Off
Off
0 V
Off
Off
On
On
0 V
216
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Cell-1
Cell-2
Cell-3
L
O
A
D
Vcap
Sa1
Sa2
Sa4
Sa3
Vcap
Sa1
Sa2
Sa4
Sa3
Vcap
Sa1
Sa2
Sa4
Sa3
Cell-1
Cell-2
Cell-3
L
O
A
D
Vcap
Sa1
Sa2
Sa4
Sa3
Vcap
Sa1
Sa2
Sa4
Sa3
Vcap
Sa1
Sa2
Sa4
Sa3
(a) 
(b)
Fig. 6.10 Current path according to two types of zero-voltage switching states for (Ma < 0.33):
a Sx1, Sx2-On, b Sx3, Sx4-On (reprinted from [7], Fig. 4)
Vcap
Sc1
Sc2
Sc4
Sc3
Dc1
Dc3
Dc4
Dc2
Vcap
Sc1
Sc2
Sc4
Sc3
Dc1
Dc3
Dc4
Dc2
(a)                               
(b)
(c)                               
(d)
Vcap
Sc1
Sc2
Sc4
Sc3
Dc1
Dc3
Dc4
Dc2
Vcap
Sc1
Sc2
Sc4
Sc3
Dc1
Dc3
Dc4
Dc2
Fig. 6.11 Current path of Cell-3 under normal and open-switch fault conditions (Sx3 and Sx4-On,
Io > 0): a Sc1 fault (Ma < 0.66), b Sc1 fault (Ma > 0.66), c Sc4 fault (Ma < 0.33), d Sc4 fault
(Ma > 0.33). (reprinted from [7], Fig. 5)
6.2
Fault Diagnosis
217

shown in Fig. 6.11b. On the other hand, if Sc4 has an open-switch fault, the current
path is disconnected by the faulty switch when the modulation index Ma < 0.33.
When Cell-2 generates the output voltage by increasing modulation index Ma, the
output node voltage of Cell-3 becomes larger than the supply voltage. Therefore,
current ﬂows through the diode Dc2, as shown in Fig. 6.11d. In this case, the current
distortion is generated at the lowest voltage level. Therefore, the location of the
current distortion differs depending on Sc1 and Sc4 faults, even though they generate
the same output voltage in the on states at the same time.
Waveforms of the current distortion, under different fault conditions and
zero-voltage switching states, are shown in Figs. 6.12 and 6.13. Cell-2 starts to
operate at the second voltage level. If an open fault occurs on Sb1 during zero-voltage
switching through the use of Sx3 and Sx4, current distortion is generated at the second
voltage level (+Vcap * +2Vcap). Likewise, if an open fault occurs on Sb3 during
zero-voltage switching through Sx1 and Sx2, current distortion is generated at the
second voltage level (−Vcap * −2Vcap). On the other hand, if an open fault occurs on
the switch of the zero-voltage switching state, current distortion is only generated at
the lowest voltage level, as shown in Figs. 6.12b and 6.13b.
C. Asymmetric zero-voltage switching for fault diagnosis
In the “Current path with open-switch faults” section, the current waveforms
caused by each switch fault according to the zero-voltage switching states were
discussed. If an open fault occurs on a switch that performs zero-voltage switching,
regardless of the cell, it is impossible to detect faults, because distortions of all the
current waveforms are generated at the equivalent voltage level between −Vcap and
Fig. 6.12 Output current waveforms under open-switch fault conditions (Sx3 and Sx4-On): a Sb1
fault, b Sb4 fault (reprinted from [7], Fig. 6)
218
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

+Vcap. Therefore, as shown in Fig. 6.14, the zero-voltage switching states of the
increasing interval and the decreasing interval of the reference voltage are changed
as follows:
Sx1; Sx2  ON; dVref
dt \0
Sx3; Sx4  ON; dVref
dt \0
(
;
ð6:6Þ
In this case, when a fault occurs on a single switch, the location of the current
distortion for every half period varies as shown in Fig. 6.15. If the open fault occurs
on Sb1 of Cell-2, the distortion is generated in the second voltage level because Sb1
is not related to the zero-voltage switching. In the decreasing interval, distortion is
Fig. 6.13 Output current waveforms under open-switch fault conditions (Sx1 and Sx2-On): a Sb2
fault, b Sb3 fault (reprinted from [7], Fig. 7)
Sx3, Sx4 - ON
Sx1, Sx2 - ON
Zero voltage switching states
Vcap
Sx1, Sx2 - ON Sx3, Sx4 - ON
2Vcap
3Vcap
-Vcap
-2Vcap
-3Vcap
V*
Fig. 6.14 Asymmetric
zero-voltage switching
(reprinted from [7], Fig. 8)
6.2
Fault Diagnosis
219

generated at the lowest voltage level because of the disconnection of the current
path, which is caused by the Sb1 fault. Therefore, current distortion is generated at
the lowest voltage level during a half cycle of the current. In the other half cycle, the
current distortion is generated at a voltage level depending on the faulty cell.
During one cycle of the current, one of the half cycles is used to detect faulty
cells and to determine which set of switches, (Sx1, Sx4) or (Sx2, Sx3), produces a
positive output voltage and which set produces a negative output voltage. The other
half cycle is used to identify which set of switches, (Sx1, Sx2) or (Sx3, Sx4), is used
for zero-voltage switching. Using a combination of the two half cycles, it is possible
to accurately detect the faulty cell and switch.
D. Evaluating the slope of the current for fault diagnosis
To diagnose an open-switch fault using the distortion of the current waveform,
the slope of the current is used. If an open fault occurs, the slope of the current is
decreased compared to the normal condition. Therefore, the fault can be detected
when the slope decreases below Kratio compared with the previous state, as shown
in (6.7). The value of Kratio is important in detecting an open-switch fault. For a
unity power factor, the range of Kratio is not critical because the current slope is
almost zero when an open-switch fault occurs. However, for a non-unity power
factor, as the power factor decreases, the value of Kratio increases.
Islope;Njk
Islope;Njk1
\Kratio; ð0\Kratio\1Þ;
ð6:7Þ
Islope ¼ di
dt ; Islope;N ¼
Islope
Io
j j  xs
;
ð6:8Þ
Fig. 6.15 Current distortion waveform with asymmetric zero-voltage switching under the Sb1
open-fault condition (reprinted from [7], Fig. 9)
220
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

where Islope is the slope of the output current, Islope,N is the normalized slope, Io is
the magnitude of the output current, Kratio is the current slope ratio compared with
the previous state, xs is the angular frequency, and k is the period index.
To reduce noise effects, the normalized slope is used, as expressed in (6.8). By
comparing this value with that of the normalized slope of the previous state, the
location of the faulty cell and switch can be determined.
Figure 6.16 shows current waveforms depending on the PWM method under the
switch Sa1 fault condition. The LS-PWM method has an unbalanced conduction
time for each cell. To distribute the conduction time evenly, a switching pattern
should rotate among the cells.
When the conventional PWM method is used, it is impossible to accurately
detect faulty switches. This is due to the fact that the location of the current
distortion is the same regardless of the zero-voltage switching states, as shown in
Fig. 6.16a. In this case, it is possible to distinguish either (Sx1, Sx4) or (Sx2, Sx3)
fault. However, it is impossible to know exactly which switch is faulty. On the other
hand, in the rotating PWM method, the location of the current distortion is shifted
in every fundamental cycle. Since a seven-level inverter is composed of three cells,
the fault-detection cycle comprises three cycles of current, as shown in Fig. 6.16b.
The slope of the current is compared with those in previous states during the
Fig. 6.16 Current waveform depending on the PWM method under a switch Sa1 fault in Cell-1:
a the conventional LS-PWM, b the rotating LS-PWM (reprinted from [7], Fig. 10)
6.2
Fault Diagnosis
221

fault-detection cycle. Through the location of the current distortion, depending on
the rotating cells during the fault-detection cycle, the faulty cells and switches can
be detected.
In the rotating PWM method, the detection cycle increases with an increasing
number of levels. Therefore, this method is more effective with a low number of
levels. However, it can be applied to a large number of levels because open-switch
faults do not have a signiﬁcant impact on a system in a short period of time.
E. Considering a non-unity power factor
Faulty cells can be detected by comparing the position of current distortions with
their corresponding reference voltage level. Therefore, if a system has a non-unity
power factor, it is impossible to accurately determine an open-switch fault.
A non-unity power factor system is shown in Fig. 6.17, where the difference in
phase between the current and the voltage is hPF. To compensate the lagging output
current, the virtual reference of the voltage Vref(PF), as expressed in (6.9). Therefore,
it is possible to detect an open-switch fault by comparing the distorted current point
and the virtual reference of the voltage Vref(PF).
Fig. 6.17 Method for considering a non-unity power factor (reprinted from [7], Fig. 11)
222
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Vref ¼ Va cosðhÞ;
ð6:9Þ
Vref ðPFÞ ¼ Va cosðh  hPFÞ;
ð6:10Þ
A ﬂowchart of the open-switch fault detection method is shown in Fig. 6.18.
F. Simulation results
To effectively verify the fault-detection method, Simulations are implemented
and the simulation parameters are presented in Table 6.2.
Simulation results concerning the rotated switching pattern for each cell are
shown in Fig. 6.19. The switching pattern of each cell is shifted every period while
maintaining a seven level output voltage. In comparison with the conventional
LS-PWM method, the output voltages of each cell have the same switching fre-
quencies and conduction times.
Calculating
current slope
Eq.(2)
Eq.(2)
(Sx1 Sx2  ON)
(Sx3 Sx4  ON)
Eq.(3)
Vref(PF)
YES
YES
NO
NO
Io
Asymmetric zero-voltage 
switching state
Determine a faulty 
cell and switch
Fig. 6.18 Flowchart of the
open-switch fault-detection
method (reprinted from [7],
Fig. 12)
Table 6.2 Simulation
parameters
Parameter
Value
Individual DC-link voltage
50 (V)
Rload
50 (Ω)
Lload
1.5 (mH)
Switching frequency
10 (kHz)
Power factor
1
Fundamental frequency
60 (Hz)
6.2
Fault Diagnosis
223

Figure 6.20 shows simulation results of the fault-detection method under
open-switch faults in Cell-2. It presents two cases of open-switch faults on Sb1 and
Sb4. It can be seen that the current waveforms have different shapes after an
open-switch fault occurs at 0.1 s. The slope of the current sharply decreases when
the distortion is generated by the open-switch fault. By analyzing the slope of the
current distortion during three cycles of the current, the fault can be detected. In the
non-faulty state, each fault-detection signal is set as zero. When an Sb1 fault occurs
in Cell-2, the fault-detection signal of Cell-2 becomes one, which means that the
open fault occurred on Sb1 in Cell-2. In addition, the fault-detection signal of Cell-2
becomes four, as shown in Fig. 6.20b, when an Sb4 open-switch fault occurs. For
the two cases of open-switch faults in Cell-2, the faulty cells and switches are
precisely distinguished.
Figure 6.21 shows simulation results of the fault detection method under
open-switch faults in Cell-3. Likewise, it presents two cases of open-switch faults
Fig. 6.19 Simulation results of the seven-level output voltage and each H-bridge cell output
voltage (reprinted from [7], Fig. 13)
224
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Fig. 6.20 Simulation results of the fault detection under an open-switch faults in Cell-2: a Sb1
fault in Cell-2, b Sb4 fault in Cell-2 (reprinted from [7], Fig. 14)
6.2
Fault Diagnosis
225

Fig. 6.21 Simulation results of the fault detection under an open-switch faults in Cell-3: a Sc2
fault in Cell-3, b Sc3 fault in Cell-3 (reprinted from [7], Fig. 15)
226
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

on Sc2 and Sc3. In this case, the fault-detection signal of Cell-3 is given a value
when a fault is detected. Each value of the fault signal indicates the number of faulty
switches. Therefore, the faulty cells and switches are identiﬁed. Consequently, the
simulation results demonstrate that the fault-detection method is useful when an
open-switch fault occurs in the CHMI.
G. Experimental results
A 6-kW three-phase, four-layer CHMI prototype was manufactured, as shown in
Fig. 6.22. The system is composed of a main control board, sensor boards, a SMPS,
and several H-bridge modules. To verify the open-switch fault detection method, a
one-phase seven-level inverter is used. Instantaneous values of the voltage reference
are transmitted from the main control board to each H-bridge control board by a
controller area network communication protocol. The experiments were carried out
under the same conditions as the simulation, as shown in Table 6.3.
Figure 6.23 shows the seven-level output voltage of the CHMI using the rotating
LS-PWM. This ﬁgure also includes the output voltage of one H-bridge cell that is
rotated every period. Therefore, it leads to balancing power for each of the H-bridge
cells.
Figure 6.24 shows the output voltage and current under the R–L load and
non-fault state. In this case, the load inductance Lload is 1.5 mH, which is a unity
power factor. On the other hand, the peak value of the current is 6 A. Thus, the
current slope is normalized with 6 A. In the fault-detection method, faulty cells can
be detected by comparing the position of the current distortions with their corre-
sponding reference voltage level.
Figure 6.25 shows output voltage and current distortion waveforms when an
open-switch fault occurs in Cell-2. Due to the characteristics of the LS-PWM
method, current distortion is generated at the corresponding voltage level, and the
slope of the distorted current is almost zero. By comparing the slope of the distorted
current with the previous value, the open-switch fault can be detected. On the other
hand, Sx1 and Sx4 open-switch faults prevent the generation of positive voltage,
which can lead to a reduction of the positive voltage level. Therefore, current
distortion is generated at a positive current interval in both cases. However, the
positions of the current distortion are different due to the different zero-voltage
switching states. In the case of an Sx1 open-switch fault, current distortion occurs on
the rising edge of the current, whereas an Sx4 open-switch fault generates current
distortion on the falling edge of the current. Similarly, the same principle is applied
for open-switch faults in Sx2 and Sx3. Therefore, it is conﬁrmed through experi-
mental results that the current distortion waveforms are different from each other
due to the asymmetric zero-voltage switching state. In addition, by rotating the
switching pattern among the H-bridge cells, the position of the current distortion is
shifted every period.
6.2
Fault Diagnosis
227

Fig. 6.22 Experimental
setup of the CHMI (reprinted
from [7], Fig. 16)
Table 6.3 Experiment
parameters
Parameter
Value
Individual DC-link voltage
50 (V)
Rload
20 (Ω)
Lload
1.5/15 (mH)
Switching frequency
10 (kHz)
Fundamental frequency
60 (Hz)
228
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Figure 6.26a, b show output current waveforms and fault-detection signal when
Sb1 and Sb4 open-switch faults occur, respectively. The open-switch fault-detection
method identiﬁes both the faulty cells and the switches. In Fig. 6.26a, when an
open-switch fault occurs in Sb1, the fault-detection signal becomes one after the
detection cycle, which is three periods of the reference voltage. In addition, when an
Fig. 6.24 Output voltage and current waveform under the non-fault state. (reprinted from [7],
Fig. 18)
Fig. 6.23 Output phase voltage of the seven-level CHMI and the output voltage of one H-bridge
cell (reprinted from [7], Fig. 17)
6.2
Fault Diagnosis
229

Fig. 6.25 Output voltage and
current waveforms under the
open-switch fault condition in
Cell-2: a Sb1 open-switch
fault, b Sb2 open-switch fault,
c Sb3 open-switch fault, d Sb4
open-switch fault (reprinted
from [7], Fig. 19)
230
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

open-switch fault occurs in Sb4, the fault-detection signal becomes four. This
fault-detection signal indicates an open-fault switch in Cell-2. Furthermore, an
additional experiment was performed for a non-unity power factor. Figure 6.27
shows experimental results at a non-unity power factor when Sc1 and Sc2
open-switch faults occur. In this case, Sc1 and Sc2 in Cell-3 have open-switch faults.
By applying the detection algorithm of the power factor, it can be seen that the
open-switch faults are accurately detected.
Fig. 6.26 Experimental results under the open-switch fault conditions in Cell-2 (PF  1): a Sb1
open-switch fault, b Sb4 open-switch fault (reprinted from [7], Fig. 20)
6.2
Fault Diagnosis
231

6.3
Fault Tolerant Control
Many engineers and researchers have focused their attention on fault detection and
preventive maintenance. Fortunately, the CHMI provides a large number of
redundant switching states, which allows an inverter to maintain normal operation
under internal fault conditions.
Several fault-tolerant methods use additional devices such as thyristor switches
and a bypass contactor as shown in Fig. 6.28 [12]. Fault cell isolation methods cope
with the case of an open or short fault in switches larger than two. However, it is
Fig. 6.27 Experimental results for a non-unity power factor (PF  0.9): a Sc1 open-switch fault,
b Sc2 open-switch fault (reprinted from [7], Fig. 21)
232
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

possible to make the current path by bypassing the fault cell as shown in Fig. 6.29.
This requires no additional bypass switches. For example, if S1 fails in the short
mode, S3 is ON, while the two bottom switches S2 and S4 are OFF, which effec-
tively bypasses the faulty converter cell. This chapter focuses on tolerant control
methods using no additional devices.
A. Fault condition of PS-PWM and LS-PWM [1]
Tolerant control must be inﬂuenced by the PMW method. PS-PWM is mainly
employed for multi-cell topologies, because all of the power cells can operate under
the same switching conditions. This makes the power distribution among inverter
power cells equal. However, it is known when compared to other multicarrier
methods, LS-PWM has a better output voltage quality with a lower distortion.
Because the carrier signals of PS-PWM need to have a phase displacement between
any two adjacent carriers, the output line-to-line and load voltages have some
additional dv/dTs. These distortion factors are not produced with LS-PWM where
all the carriers are in phase. LS-PWM methods are based on the amplitude shifts
Fig. 6.28 Methods for
bypassing a faulty converter
cell using: a thyristor switches
and b a bypass contactor
(reprinted from [12], Fig. 3)
Fig. 6.29 Method for
bypassing a faulty cell
(reprinted from [12], Fig. 4)
6.3
Fault Tolerant Control
233

between carriers. As shown in Fig. 6.30, there are three schemes for LS-PWM:
Phase Disposition (PD), Alternative Phase Opposite Disposition (APOD) and Phase
Opposite Disposition (POD).
Figure 6.31 shows the modulation results of the CHMI based on PS-PWM and
LS-PWM under a faulty single-inverter cell of the u-phase. Each voltage level has
an amplitude of Vcap. Both of the output voltage waveforms contain only ﬁve
voltage levels instead of seven. However, the waveforms are different in the central
portion of the positive and negative half-cycles of vuM.
(c) Phase opposite disposition (POD)
(b) Alternative phase opposite disposition (APOD)
(a) Phase disposition (PD)
vcr1
vcr2
vcr2-
vcr1-
vcr3
vcr3-
vcr1
vcr2
vcr2-
vcr1-
vcr3
vcr3-
vcr1
vcr2
vcr2-
vcr1-
vcr3
vcr3-
Fig. 6.30 Level-shifted multicarrier modulation for seven-level inverters (reprinted from [8],
Fig. 2)
234
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

In PS-PWM, the amplitude modulation index (Ma) is always in the range of 0–1
even if the CHMI has faulty inverter cells. This means that the CHMI based on
PS-PWM can afford to modulate a modiﬁed reference signal with carrier bands for
fault-tolerant control.
However, Ma of the CHMI based on LS-PWM can be represented as follows:
0\Ma\ H  nf
H
; ðnf ¼ 0; 1; 2; . . .; HÞ
ð6:11Þ
where H is the number of operating inverter cells, and nf is the number of faulty
inverter cells.
Vcap
(b) Level-shifted modulation
(a)Phase-shifted modulation
2Vcap
3Vcap
-3Vcap
-2Vcap
-Vcap
vuM
vuM
0
Tf
Tf
Vcap
2Vcap
3Vcap
-3Vcap
-2Vcap
-Vcap
0
Fig. 6.31 Level-shifted multicarrier modulation for seven-level inverters (reprinted from [8],
Fig. 3)
6.3
Fault Tolerant Control
235

For the CHMI based on LS-PWM, Ma is also in the range of 0 to 1 under normal
operation conditions. However, if one of the inverter cells in the u-phase of the
seven-level CHMI is out of order, the available Ma for the faulty u-phase is reduced
to the range of 0 to 2/3 by (6.4). As shown in Fig. 6.31, the output voltage vuM in
the central portion (Tf), where the desired voltage ranges from 2Vcap to 3Vcap,
maintains an amplitude of 2Vcap because there are no available carrier bands to be
modulated with the reference signal in this portion, Tf.
The general basic strategy for achieving fault tolerance of CHMIs is increasing
Ma for the healthy inverter cells in the faulty phase, and many studies are based on
this strategy. However, CHMIs based on LS-PWM cannot apply these method-
ologies because the range of the available Ma is reduced when an inverter cell
malfunctions, as described previously. The fundamental wave of the output voltage
cannot be increased in CHMIs based on LS-PWM even if Ma of the reference signal
is increased for fault tolerance. For the faulty region (Tf), where the reference signal
should be modulated with the outermost carrier bands in the normal operation
mode, vuM is always 2Vcap. Thus the fundamental wave of vuM cannot be increased
under the faulty S11 condition.
B. Neutral-shift method [12]
The neutral shift control method is used to maximize the available voltage after a
bypass to increase the number of module failures that can be tolerated. For the
neutral shift of this study, a fundamental-frequency zero-sequence voltage is
injected. This section brieﬂy introduces the neutral shift method. It should be noted
that this fault-tolerant method is also based on PS-PWM as its switching scheme.
In the following, it is assumed that the u-phase inverter Cell-1 has malfunc-
tioned. Therefore, faulty Cell-1 is bypassed.
vu1 ¼ 0
ð6:12Þ
As shown in Fig. 6.32b, the modulation index Ma of the remaining healthy
inverter cells in the u-phase need to be increased by a factor of H/(H −1) so as to
maintain three-phase balanced line-to-line voltages.
vuM ¼ H=ðH  1ÞMaVdc sin xt
vvM ¼ MaVdc sin xt  2p=3
ð
Þ
vwM ¼ MaVdc sin xt þ 2p=3
ð
Þ
ð6:13Þ
where N is the cascaded number, Vdc is the total DC-link voltage which equals
HVcap.
Figure 6.32b shows a phasor diagram of (6.13) for H = 3. If Cell-1 of the
u-phase is out of order, only Ma of Cell-2 and Cell-3 should be increased to
maintain the balanced line-to-line voltage while the healthy inverter cells in the
v-phase and w-phases are working normally, which is similar to the condition in
Fig. 6.32a.
236
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

After the neutral shift by a zero-sequence voltage injection, the reference voltage
of the healthy inverter cells can be expressed as:
vuM ¼ H=ðH  1Þ MaVdc sin xt  v0f sin xt


vvM ¼ MaVdc sin xt  2p=3
ð
Þ  v0f sin xt
vwM ¼ MaVdc sin xt þ 2p=3
ð
Þ  v0f sin xt:
ð6:14Þ
Fig. 6.32 Phasor diagrams of inverter-cell voltages with a cascade number H = 3 during a fault in
u-phase inverter cell number 1 with an injection of zero-sequence voltage (reprinted from [8],
Fig. 4)
6.3
Fault Tolerant Control
237

The second term on the right-hand side of each equation represents the injected
zero-sequence voltage. The amplitude of the zero-sequence voltage v0f is derived as:
v0f ¼
2
3H  1 MaVdc:
ð6:15Þ
For a cascaded number H = 3, as shown in Fig. 6.32c, the zero-sequence voltage
is calculated as:
v0f ¼ 1
4 MaVdc:
ð6:16Þ
Substituting (6.16) into (6.14) yields:
vuM ¼ 1:125MaVdc sin xt
vvM ¼ 1:145MaVdc sin xt  130:9
ð
Þ
vwM ¼ 1:145MaVdc sin xt þ 130:9
ð
Þ
ð6:17Þ
When the neutral shift is applied, the modulation index Ma is increased by a
factor of 1.125 in the u-phase and by a factor of 1.145 in the v-phase and w-phases
during a single-inverter-cell fault in the u-phase. Without the neutral shift, an
increase by a factor of 1.5 in the u-phase would be necessary to maintain the
three-phase balanced line-to-line voltages and currents. In other words, the neutral
shift can share the additional burden of the increasing Ma with all of the 3H −1
healthy inverter cells in the three phases.
If the u-phase and v-phase fail simultaneously, this condition can be tolerated in
the same way. Because the u-phase and v-phase have failed, the two zero-sequence
voltages should be calculated, and these two offset voltages are added to each
phase. Thus, the three-phase reference voltage signals of the healthy inverter cells
are expressed as:
vuM ¼ H=ðH  1Þ MaVdc sin xt  v0f sin xt  v0f sinðxt  2p=3Þ


vvM ¼ H=ðH  1ÞðMaVdc sin xt  2p=3
ð
Þ  v0f sin xt
 v0f sinðxt  2p=3ÞÞ
vwM ¼ MaVdc sin xt þ 2p=3
ð
Þ  v0f sin xt  v0f sinðxt  2p=3Þ:
ð6:18Þ
For a cascaded number N = 3, substituting (6.16) into (6.18) yields:
vuM ¼ 1:352MaVdc sinðxt þ 13:89Þ
vvM ¼ 1:352MaVdc sin xt  133:89
ð
Þ
vwM ¼ 1:25MaVdc sin xt þ 120
ð
Þ
ð6:19Þ
In this faulty case, the increasing factor of Ma is smaller than 1.5 in the u-phase
and v-phase. In a medium-voltage system, a high number of H-bridge cells, i.e., six
238
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

or more, may be used. By increasing the cascade number H, the increasing factor of
Ma is further decreased.
C. Tolerant control based on LS-PWM [8]
This section presents an LS-PWM scheme for fault-tolerant operation of a
CHMI. First, the bypass method is introduced brieﬂy. The tolerant control is then
described with two types of schemes so as to cover both open-switching and
short-switching device faults. Bypassing the faulty inverter cell is used. If an
open-fault of S1 is detected, a fault signal is generated and transmitted to the
controller. In addition, S3 is given the OFF signal, while the two bottom switches S2
and S4 are given the ON signal. Thus, the faulty inverter cell is effectively bypassed.
On the other hand, if a short-fault of S1 is detected, S3 is given the ON signal, and
S2 and S4 are given the OFF signal. This method can be expanded to all of the
switch fault cases.
Type 1: For both open-switching and short-switching device faults
Figure 6.33 shows the reference signal of the u-phase and the triangular wave
carrier bands. It is assumed that the switching device S11 of Cell-1 in the u-phase
has failed. In this ﬁrst scheme, Cell-1 and the faulty S11 are bypassed. Therefore,
both open-fault and short-fault cases of S11 can be effectively dealt with.
From the left side of Fig. 6.33, it can be seen that faulty Cell-1 is bypassed.
Because Cell-1 has lost its switching ability, the two carrier bands vcr1 and vcr1—
cannot be compared with the reference signal (Vref_u) of the u-phase. Therefore, the
gating signals for S11 and S13 are not generated. Even if Ma is increased by neutral
Fig. 6.33 Output voltage waveforms when a reference signal is adjusted by the Type 1 LS-PWM
(reprinted from [8], Fig. 6)
6.3
Fault Tolerant Control
239

shift for fault tolerance as discussed in the previous section, the upper-most and
lower-most portions of Vref_u still cannot be modulated with the carrier bands. To
allow the reference signal to be modulated linearly with carrier bands, the reference
signal is adjusted in this PWM method. In the middle of the time scale of Fig. 6.33,
Ma of the reference signal is decreased, and the adjusted reference signal is marked
by V
ref
u. The factor of this decrement can be derived as follows:
V
ref
x ¼ N  nf
N
Vref
x
ð6:20Þ
where x represents the phase including the faulty inverter cells.
For a cascade number H = 3 and a number of faulty inverter cells nf = 1, the
adjusted reference signal V
ref
u is given by:
V
ref
u ¼ 2
3 Vref
u
ð6:21Þ
As shown on the right-side of Fig. 6.33, even though the reference signal V
ref
u
has been increased by an injection of zero-sequence voltage for the neutral shift,
V
ref
u can be modulated linearly from its peak-to-peak value with the carrier bands.
Type 2: For open-switching device faults only
In the explanation of Type 1, the faulty Cell-1 of the u-phase is bypassed, and
the u-phase can generate a ﬁve-level output voltage when the cascade number
H = 3. Even though only one switching device has failed, the corresponding
H-bridge cell is only used as a current path and cannot generate any voltage level.
If the faulty inverter cell is not bypassed, the remaining healthy switching
devices in the faulty cell can be used, and it is possible to generate more output
voltage levels than when the faulty inverter cell is bypassed.
Figure 6.34 shows the reference signal of the u-phase and the triangular wave
carrier bands when the second type of LS-PWM scheme is applied. Since only
switching device S11 has failed, the reference signal is modiﬁed during the original
modulation period of S11. For a cascade number N = 3 and a number of faulty
inverter cells nf = 1, the adjusted reference signal V
ref
u is expressed as follows:
where  1\Vref
u\1;
ði) if Vref
u [ 2=3; V
ref
u ¼ 2
3 Vref
u
ðii) if Vref
u\2=3; V
ref
u ¼ Vref
u
ð6:22Þ
The lowermost portion of V
ref
u can still be compared with the carrier band vcr1.
Thus, shows that the healthy switching device S13 can generate a voltage level in
the negative domain. Finally, the output voltage of the u-phase can be formed with
six levels.
240
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

The fundamental-frequency zero-sequence voltage is also only injected in the
period where the reference signal is adjusted. Since all of the remaining healthy
switching devices can be operated normally, it is possible to minimize the effect of
the switching device failure on the output voltage waveform.
D. Rotation scheme of the switching pattern [8]
In LS-PWM, the power delivery of each H-bridge cell in a phase is not evenly
distributed because the conduction times of the devices are unequal. In addition, the
switching frequency is not the same for devices in different H-bridge cells. These
unequal power delivery and switching frequencies cause unequal switch device
losses. To evenly distribute power delivery, the switching pattern should rotate
among the H-bridge cells.
In Fig. 6.35a, it is assumed that the switching device S11 of Cell-1 in the u-phase
has failed. The type 2 LS-PWM is applied with the conventional rotation scheme.
The faulty Cell-1 should be ﬁxed for the modulation of the outermost voltage level,
and Cell-2 and Cell-3 rotate their switching patterns mutually.
The faulty Cell-1 conducts power for a very short time when compared to the
other healthy inverter cells. This means that the healthy inverter cells, Cell-2 and
Cell-3, experience more conduction losses than Cell-1. If the faulty Cell-1 can take
on more power delivery, the switching device losses can be distributed among the
H-bridge inverter cells. In this section, a modiﬁed rotation scheme for LS-PWM is
introduced.
Fig. 6.34 Output voltage waveforms when a reference signal is adjusted by the Type 2 LS-PWM
(reprinted from [8], Fig. 7)
6.3
Fault Tolerant Control
241

Figure 6.35b shows the output waveforms after the type 2 LS-PWM is applied
with the rotation scheme under the faulty switching device S11 of the Cell-1 con-
dition. The faulty Cell-1 is responsible for the inner-most modulation level of the
negative region. The healthy inverter cells, Cell-2 and Cell-3, are responsible for the
inner-most or middle level in the positive region and middle and outer-most level in
the negative region. With this modiﬁed rotation scheme, the total amount of power
delivered by Cell-2 and Cell-3 is still equal during the two cycles of the funda-
mental wave. However, the faulty Cell-1 can take on more power-conduction time,
and Cell-2 and Cell-3 can share the burden of their power delivery with Cell-1. The
improved power distribution among the H-bridge cells can extend the life-cycle of
the switching devices.
E. Simulation results
To ensure that all of the H-bridge cells implement the switching operation under
normal operating conditions, the magnitude of the three-phase ac reference voltages
is set to 750 V. Therefore, the amplitude modulation index Ma is 0.83. The sim-
ulation conditions are shown in Table 6.4.
Fig. 6.35 Output voltage waveforms under the faulty Cell-1 condition after the type 2 LS-PWM
is applied with: a conventional rotation scheme, b proposed rotation scheme (reprinted from [8],
Fig. 8)
Table 6.4 Simulation
parameters
Parameter
Value
Individual DC source voltage
300 V
Total DC bus voltage
900 V
Amplitude modulation index
0.8333
Reference signal frequency
60 Hz
Switching frequency
2.5 kHz
242
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Figure 6.36 shows simulation waveforms when the switching device S11 of Cell-
1 in the u-phase has failed. In this simulation, the faulty Cell-1 is bypassed, and
only ﬁve-level output voltage is generated in the u-phase. On the left side of
Fig. 6.36, the u-phase reference signal cannot be modulated at the outermost region,
and the output voltage retains a 2Vcap magnitude (600 V) in this region. The type 1
LS-PWM scheme is applied at the middle of the time scale. The output voltage
waveform of the u-phase still has ﬁve levels. However, the reference signal can be
modulated from the peak to peak linearly with the four carrier bands.
The neutral shift is implemented on the right side of the time scale by an
injection of zero-sequence voltage. Due to the injection of offset voltage, the
three-phase
reference
voltage
signals
are
increased.
Finally,
the
balanced
three-phase line-to-line voltages and currents are generated. Note that LS-PWM and
the neutral shift should be implemented at the same time. The waveforms in
Fig. 6.36 help explain the fault-tolerant method step by step.
Fig. 6.36 Simulated output waveforms at the AC side of a CHMI, when the faulty Cell-1 is
bypassed and the type 1 LS-PWM is implemented (reprinted from [8], Fig. 9)
6.3
Fault Tolerant Control
243

Figure 6.37 shows simulation waveforms under the same faulty switching
device S11 condition as the simulation shown in Fig. 6.36. However, in this case,
Cell-1, which has the faulty S11, is not bypassed, and the healthy switching devices
in Cell-1 are operated normally. Therefore, a six-level output voltage waveform is
generated in the u-phase.
The type 2 LS-PWM scheme is applied at the middle of the time scale. The
u-phase reference signal is only modiﬁed during the modulation period of the faulty
S11. When the reference signal is higher than 2Vcap (600 V), the reference signal is
decreased by a factor of 2/3 by (6.22). However, during this period, the reference
signal is not modiﬁed.
Zero-sequence voltage is injected only for this period, as shown in Fig. 6.37.
Therefore, the three-phase reference signals are increased in this period by an
injection of offset voltage. With the Type 2 LS-PWM and neutral shift, balanced
three-phase line-to-line voltages and currents are generated.
Fig. 6.37 Simulated output waveforms at the ac side of a CHMI, when the faulty Cell-1 is not
bypassed and the type 2 LS-PWM is implemented with the neutral shift (reprinted from [8],
Fig. 10)
244
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Simulations were performed to verify the performance of the fault-tolerant
strategy under two faulty phase conditions, and the results are shown in Fig. 6.38.
In this simulation, the type 2 LS-PWM is applied at the middle of the time scale. In
the same way, the type 2 LS-PWM and neutral shift are only applied for the period
where the reference signals of both the u-phase and v-phase are higher than 2Vcap.
Even though the faulty switching device condition occurred in w-phases,
three-phase balanced line-to-line voltages and line currents are generated by the
fault-tolerant strategy.
Figure 6.39a shows simulation results when the conventional rotation scheme is
applied. It is assumed that the switching device S11 of Cell-1 in the u-phase has
failed. The faulty Cell-1 conducts power for a very brief time when compared to the
healthy Cell-2 and Cell-3. Only 587.27 W of AVG power is transmitted through the
faulty Cell-1 when Cell-2 and Cell-3 conduct 4799.97 W each.
Fig. 6.38 Simulated output waveforms at the ac side of a CHMI, when one of the switching
devices failed in each u-phase and v-phase and the type 2 LS-PWM is implemented (reprinted
from [8], Fig. 11)
6.3
Fault Tolerant Control
245

Figure 6.39b shows the resulting waveforms under the same simulation condi-
tions as Fig. 6.39a, but with the rotation scheme is applied. Cell-1 can take on a
greater burden of power conduction with this rotation scheme. Cell-2 and Cell-3
can reduce their conduction burden by 22.77% due to the increase in the Cell-1
conduction time. Table 6.5 shows the power-conduction ratio of the faulty cell
under the same faulty conditions for the two different rotation schemes.
F. Experimental results
To test the feasibility of the tolerant control strategy for fault tolerance, a
three-phase 6 kW seven-level CHMI system was constructed as shown in Fig. 6.22.
The experimental conditions are shown in Table 6.6. Each H-bridge inverter cell
has an independent DC source of 30 V. This DC voltage is too small for the
original purpose of a CHMI topology, but it is enough to show the switching results
of the tolerant control.
Fig. 6.39 Simulated output waveforms at the AC side of each H-bridge cell in the u-phase under
the faulty Cell-1 condition with the type 2 LS-PWM: a conventional rotation scheme, b proposed
rotation scheme (reprinted from [8], Fig. 12)
Table 6.5 Comparison of
power distributions depending
on the rotation scheme
Rotation
scheme
Conventional
Proposed
Cell-1
587.27 W
0.122
2772.38 W
0.748
Cell-2
4799.97 W
1
3707.42 W
1
Cell-3
4799.97 W
1
3707.42 W
1
246
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

Figure 6.40 shows experimental waveforms that verify the effectiveness of the
type 1 modulation method. At T0, one of the switching devices in Cell-1 failed and
the faulty cell, Cell-1, is bypassed. The u-phase reference signal cannot be mod-
ulated at the outermost region. As a result, only a ﬁve-level output voltage is
generated. The type 1 LS-PWM scheme is applied at T1. The reference signal of the
u-phase can be modulated from its peak-to-peak value even though the output
voltage waveform of the u-phase still has ﬁve levels. After the offset voltage is
injected for a neutral shift at T2, balanced three-phase line-to-line voltages and line
currents are generated.
Figure 6.41 shows experimental waveforms when the switching device, S11 of
Cell-1 in the u-phase, has failed. The faulty inverter cell, Cell-1, is not bypassed and
the healthy switching devices in the cell are used normally. Due to the fault in S11,
the inverter cannot perform the switching operation when the reference signal
exceeds 2Vcap in the u-phase. Therefore, the uppermost voltage level (3Vcap) of the
u-phase is not generated, and the total six-level output voltage waveform is gen-
erated in the u-phase. The type 2 LS-PWM is applied at T1. After the type 2
LS-PWM is implemented, the inverter carries out the switching operation contin-
uously for every fundamental period.
The neutral shift is applied from T2. The zero-sequence voltage is injected when
the
reference
signal
of
the
u-phase
exceeds
2Vcap
as
explained
earlier.
Figure 6.41b–c show that three-phase line-to-line voltage and current waveforms
are balanced after all of the steps of the fault-tolerant strategy are completed.
Although the fundamental components of the line-to-neutral voltages are not bal-
anced, those of the line-to-line voltages and currents are balanced well. It may be a
little difﬁcult to evaluate the performance of the fault-tolerant control from wave-
forms of the line-to-line voltages. Since Cell-1 takes charge of the outermost
voltage level, the failure effects of Cell-1 are the smallest among the inverter cells.
However, the three-phase line current waveforms show that the control scheme
performs well for fault-tolerant operation. As previously mentioned, the tolerant
control and neutral shift should be implemented at the same time once the fault is
detected.
Table 6.6 Experiment parameters
Parameter
Value
Individual DC source voltage
30 V
Total DC bus voltage
90 V
Amplitude modulation index
0.8333
Reference signal frequency
60 Hz
Switching frequency
2.5 kHz
Load
25 Ω resistors and 4 mH inductors
6.3
Fault Tolerant Control
247

Figure 6.42 shows output voltage waveforms for each of the H-bridge inverter
cells in the u-phase when the proposed rotation scheme is applied. These are the
same waveforms as the simulation results in Fig. 6.12b, which shows that the
proposed rotation scheme can be experimentally realized. Since the switching
Fig. 6.40 Experimental output waveforms at the ac side of a CHMI, when the faulty Cell-1 is
bypassed and the type 1 LS-PWM is implemented with the neutral shift (reprinted from [8], Fig. 14)
248
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

device S11 failed, the faulty Cell-1 takes charge of the innermost modulation level
in the negative domain. If S12 or S13 of Cell-1 fails, the faulty Cell-1 generates the
innermost voltage level in the positive domain.
Fig. 6.41 Experimental output waveforms at the ac side of CHMI, when the faulty Cell-1 is not
bypassed and the type 2 LS-PWM is implemented with the neutral shift (reprinted from [8],
Fig. 15)
6.3
Fault Tolerant Control
249

References
1. Wu, B. 2006. High-Power Converters and AC Drives. Hoboken, NJ, USA: Wiley.
2. Rodriguez,
J.,
S.
Bernet,
B.
Wu,
J.O.
Pontt,
and
S.
Kouro.
2007.
Multilevel
voltage-source-converter
topologies
for
industrial
medium-voltage
drives.
IEEE
Transaction Industrial Electronics 54 (6): 2930–2945.
3. Lee, J.S., and K. B. Lee. 2015. Open-switch fault tolerance control for a three level
NPC/T-type rectiﬁer in wind turbine systems. IEEE Transaction Industrial Electronics 62 (2):
1012–1021.
4. Youssef, M.Z., K. Woronowicz, K. Aditya, N. A. Azeez, and S. S. Williamson. 2016. Design
and development of an efﬁcient multilevel DC/AC traction inverter for railway transportation
electriﬁcation. IEEE Transaction on Power Electronics 31 (4): 3036–3042.
5. Malinowski, M., K. Gopakumar, J. Rodriguez, and M.A. Perez. 2010. A survey on cascaded
multilevel inverters. IEEE Transactions on Industrial Electronics 57 (7): 2197–2206.
6. Lee, J.S., H.W. Sim, and K.B. Lee. 2014. Cascaded H-bridge multilevel inverter for
increasing output voltage levels. In Proceedings of IEEE Energy Conversion Congressand
Exposition Conference (pp. 365–370).
7. Sim, H.W., J.S. Lee, and K.B. Lee. 2016. Detecting open-switch faults: Using asymmetric
zero-voltage switching states. IEEE Industry Applications Magazine 22 (2): 27–37.
8. Kim, S.M., J.S. Lee, and K.B. Lee. 2016. A modiﬁed level-shifted PWM strategy for fault
tolerant cascaded multilevel inverters with improved power distribution. IEEE Transactions
on Industrial Electronics 63 (11): 7264–7274.
9. Yazdani, A., H. Sepahvand, M.L. Crow, and M. Ferdowsi. 2011. Fault detection and
mitigation in multilevel converter STATCOMs. IEEE Transactions on Industrial Electronics
58 (4): 1307–1315.
10. Lezana, P., R. Aguilera, and J. Rodríguez. 2009. Fault detection on multicell converter based
on output voltage frequency analysis. IEEE Transactions on Industrial Electronics 56 (6):
2275–2283.
Fig. 6.42 Experimental output voltage waveforms of each H-bridge cells in the u-phase when the
proposed rotation scheme is applied under the faulty Cell-1 condition (reprinted from [8], Fig. 16)
250
6
Switch Fault Diagnosis and Tolerant Control in Cascaded …

11. Khomfoi, S., and L.M. Tolbert. 2007. Fault diagnosis and reconﬁguration for multilevel
inverter drive using AI-based techniques. IEEE Transactions on Industrial Electronics 54 (6):
2954–2968.
12. Maharjan, L., T. Yamagishi, H. Akagi, and J. Asakura. 2010. Fault-tolerant operation of a
battery-energy-storage system based on a multilevel cascade PWM converter with star
conﬁguration. IEEE Transactions on Power Electronics 25 (9): 2386–2396.
References
251

