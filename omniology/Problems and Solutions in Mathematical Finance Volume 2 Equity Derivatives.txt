
Problems and Solutions
in Mathematical Finance

For other titles in the Wiley Finance series
please see www.wiley.com/finance

Problems and Solutions
in Mathematical Finance
Volume 2: Equity Derivatives
Eric Chin, Dian Nel and Sverrir ´Olafsson

This edition first published 2017
© 2017 John Wiley & Sons, Ltd
Registered office
John Wiley & Sons Ltd, The Atrium, Southern Gate, Chichester, West Sussex, PO19 8SQ, United Kingdom
For details of our global editorial offices, for customer services and for information about how to apply for
permission to reuse the copyright material in this book please see our website at www.wiley.com.
All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any
form or by any means, electronic, mechanical, photocopying, recording or otherwise, except as permitted by the UK
Copyright, Designs and Patents Act 1988, without the prior permission of the publisher.
Wiley publishes in a variety of print and electronic formats and by print-on-demand. Some material included with
standard print versions of this book may not be included in e-books or in print-on-demand. If this book refers to
media such as a CD or DVD that is not included in the version you purchased, you may download this material at
http://booksupport.wiley.com. For more information about Wiley products, visit www.wiley.com.
Designations used by companies to distinguish their products are often claimed as trademarks. All brand names and
product names used in this book are trade names, service marks, trademarks or registered trademarks of their
respective owners. The publisher is not associated with any product or vendor mentioned in this book.
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in preparing
this book, they make no representations or warranties with respect to the accuracy or completeness of the contents of
this book and specifically disclaim any implied warranties of merchantability or fitness for a particular purpose. It is
sold on the understanding that the publisher is not engaged in rendering professional services and neither the
publisher nor the author shall be liable for damages arising herefrom. If professional advice or other expert
assistance is required, the services of a competent professional should be sought.
A catalogue record for this book is available from the Library of Congress.
A catalogue record for this book is available from the British Library.
ISBN 978-1-119-96582-4 (hardback) ISBN 978-1-119-96610-4 (ebk)
ISBN 978-1-119-96611-1 (ebk)
ISBN 978-1-119-19219-0 (obk)
Cover design: Cylinder
Cover image: © Attitude/Shutterstock
Set in 10/12pt Times by Aptara Inc., New Delhi, India
Printed in Great Britain by TJ International Ltd, Padstow, Cornwall, UK

“Blue dye is derived from the indigo plant and surpassed its parental colour”
Xunzi, An Exhortation to Learning

Contents
Preface
ix
About the Authors
xi
1
Basic Equity Derivatives Theory
1
1.1
Introduction
1
1.2
Problems and Solutions
8
1.2.1
Forward and Futures Contracts
8
1.2.2
Options Theory
15
1.2.3
Hedging Strategies
27
2
European Options
63
2.1
Introduction
63
2.2
Problems and Solutions
74
2.2.1
Basic Properties
74
2.2.2
Black–Scholes Model
89
2.2.3
Tree-Based Methods
190
2.2.4
The Greeks
218
3
American Options
267
3.1
Introduction
267
3.2
Problems and Solutions
271
3.2.1
Basic Properties
271
3.2.2
Time-Independent Options
292
3.2.3
Time-Dependent Options
305
4
Barrier Options
351
4.1
Introduction
351
4.2
Problems and Solutions
357
4.2.1
Probabilistic Approach
357
4.2.2
Reflection Principle Approach
386
4.2.3
Further Barrier-Style Options
408

viii
Contents
5
Asian Options
439
5.1
Introduction
439
5.2
Problems and Solutions
443
5.2.1
Discrete Sampling
443
5.2.2
Continuous Sampling
480
6
Exotic Options
531
6.1
Introduction
531
6.2
Problems and Solutions
532
6.2.1
Path-Independent Options
532
6.2.2
Path-Dependent Options
586
7
Volatility Models
647
7.1
Introduction
647
7.2
Problems and Solutions
652
7.2.1
Historical and Implied Volatility
652
7.2.2
Local Volatility
685
7.2.3
Stochastic Volatility
710
7.2.4
Volatility Derivatives
769
A Mathematics Formulae
787
B
Probability Theory Formulae
797
C Differential Equations Formulae
813
Bibliography
821
Notation
825
Index
829

Preface
Mathematical finance is a highly challenging and technical discipline. Its fundamentals and
applications are best understood by combining a theoretically solid approach with extensive
exercises in solving practical problems. That is the philosophy behind all four volumes in
this series on mathematical finance. This second of four volumes in the series Problems and
Solutions in Mathematical Finance is devoted to the discussion of equity derivatives. In the
first volume we developed the probabilistic and stochastic methods required for the successful
study of advanced mathematical finance, in particular different types of pricing models. The
techniques applied in this volume assume good knowledge of the topics covered in Volume 1.
As we believe that good working knowledge of mathematical finance is best acquired through
the solution of practical problems, all the volumes in this series are built up in a way that allows
readers to continuously test their knowledge as they work through the texts.
This second volume starts with the analysis of basic derivatives, such as forwards and
futures, swaps and options. The approach is bottom up, starting with the analysis of simple con-
tracts and then moving on to more advanced instruments. All the major classes of options are
introduced and extensively studied, starting with plain European and American options. The
text then moves on to cover more complex contracts such as barrier, Asian and exotic options.
In each option class, different types of options are considered, including time-independent and
time-dependent options, or non-path-dependent and path-dependent options.
Stochastic financial models frequently require the fixing of different parameters. Some can
be extracted directly from market data, others need to be fixed by means of numerical methods
or optimisation techniques. Depending on the context, this is done in different ways. In the risk-
neutral world, the drift parameter for the geometric Brownian motion (Black–Scholes model)
is extracted from the bond market (i.e., the returns on risk-free debt). The volatility parameter,
in contrast, is generally determined from market prices, as the so-called implied volatility.
However, if a stochastic process is to be fitted to known price data, other methods need to
be consulted, such as maximum-likelihood estimation. This method is applied to a number of
stochastic processes in the chapter on volatility models.
In all option models, volatility presents one of the most important quantities that determine
the price and the risk of derivatives contracts. For this reason, considerable effort is put into
their discussion in terms of concepts, such as implied, local and stochastic volatilities, as well
as the important volatility surfaces.
At the end of this volume, readers will be equipped with all the major tools required for
the modelling and the pricing of a whole range of different derivatives contracts. They will

x
Preface
therefore be ready to tackle new techniques and challenges discussed in the next two volumes,
including interest-rate modelling in Volume 3 and foreign exchange/commodity derivatives in
Volume 4.
As in the first volume, we have the following note to the student/reader: Please try hard to
solve the problems on your own before you look at the solutions!

About the Authors
Eric Chin is a quantitative analyst at an investment bank in the City of London where he
is involved in providing guidance on price testing methodologies and their implementation,
formulating model calibration and model appropriateness on commodity and credit products.
Prior to joining the banking industry he worked as a senior researcher at British Telecom inves-
tigating radio spectrum trading and risk management within the telecommunications sector. He
holds an MSc in Applied Statistics and an MSc in Mathematical Finance both from University
of Oxford. He also holds a PhD in Mathematics from University of Dundee.
Dian Nel has more than 10 years of experience in the commodities sector. He currently works
in the City of London where he specialises in oil and gas markets. He holds a BEng in Elec-
trical and Electronic Engineering from Stellenbosch University and an MSc in Mathematical
Finance from Christ Church, Oxford University. He is a Chartered Engineer registered with
the Engineering Council UK.
Sverrir ´Olafsson is Professor of Financial Mathematics at Reykjavik University; a Visiting
Professor at Queen Mary University, London and a director of Riskcon Ltd, a UK based risk
management consultancy. Previously he was a Chief Researcher at BT Research and held
academic positions at The Mathematical Departments of Kings College, London; UMIST
Manchester and The University of Southampton. Dr ´Olafsson is the author of over 95 ref-
ereed academic papers and has been a key note speaker at numerous international conferences
and seminars. He is on the editorial board of three international journals. He has provided an
extensive consultancy on financial risk management and given numerous specialist seminars to
finance specialists. In the last five years his main teaching has been MSc courses on Risk Man-
agement, Fixed Income, and Mathematical Finance. He has an MSc and PhD in mathematical
physics from the Universities of T¨ubingen and Karlsruhe respectively.

1
Basic Equity Derivatives Theory
In finance, an equity derivative belongs to a class of derivative instruments whose underlying
asset is a stock or stock index. Hence, the value of an equity derivative is a function of the value
of the stock or index. With a growing interest in the stock markets of the world, and the preva-
lence of employee stock options as a form of compensation, equity derivatives continue to
expand with new product structures continuously being offered. In this chapter, we introduce
the concept of equity derivatives with emphasis on forwards, futures, option contracts and also
different types of hedging strategies.
1.1
INTRODUCTION
Among the many equity derivatives that are actively traded in the market, options and futures
are by far the most commonly traded financial instruments. The following is the basic vocab-
ulary of different types of derivatives contracts:
s Option A contract that gives the holder the right but not the obligation to buy or sell an
asset for a fixed price (strike/exercise price) at or before a fixed expiry date.
s Call Option A contract that gives the holder the right to buy an asset for a fixed price
(strike/exercise price) at or before a fixed expiry date.
s Put Option A contract that gives the holder the right to sell an asset for a fixed price
(strike/exercise price) at or before a fixed expiry date.
s Payoff Difference between the market price and the strike price depending on derivative
type.
s Intrinsic Value The payoff that would be received/paid if the option was exercised when
the underlying asset is at its current level.
s Time Value Value that the option is above its intrinsic value. The relationship can be
written as
Option Price = Intrinsic Value + Time Value.
s Forward/Futures A contract that obligates the buyer and seller to trade an underlying,
usually a commodity or stock price index, at some specified time in the future. The dif-
ference between a forward and a futures contract is that forwards are over-the-counter
(OTC) products which are customised agreements between two counterparties. In con-
trast, futures are standardised contracts traded on an official exchange and are marked to
market on a daily basis. Hence, futures contracts do not carry any credit risk (the risk that
a party will not meet its contractual obligations).
s Swap An OTC contract in which two counterparties exchange cash flows.
s Stock Index Option A contract that gives the holder the right but not the obligation to buy
or sell a specific amount of a particular stock index for an agreed fixed price at or before

2
1.1 INTRODUCTION
a fixed expiry date. As it is not feasible to deliver an actual stock index, this contract is
usually settled in cash.
s Stock Index Futures A contract that obligates the buyer and seller to trade a quantity of
a specific stock index on an official exchange at a price agreed between two parties with
delivery on a specified future date. Like the stock index option, this contract is usually
settled in cash.
s Strike/Exercise Price Fixed price at which the owner of an option can buy (for a call
option) or sell (for a put option) the underlying asset.
s Expiry Date/Exercise Date The last date on which the option contract is still valid. After
this date, the option contract becomes worthless.
s Delivery Date The last date by which the underlying commodity or stock price index
(usually cash payment based on the underlying stock price index) for a forward/futures
contract must be delivered to fulfil the requirements of the contract.
s Discounting Multiplying an amount by a discount factor to compute its present value (dis-
counted value). It is the opposite of compounding, where interest is added to an amount so
that the added interest also earns interest from then on. If we assume the risk-free interest
rate 𝑟is a constant and continuously compounding, then the present value at time 𝑡of a
certain payoff 𝑀at time 𝑇, for 𝑡< 𝑇, is 𝑀𝑒−𝑟(𝑇−𝑡).
s Hedge An investment position intended to reduce the risk from adverse price movements
in an asset. A hedge can be constructed using a combination of stocks and derivative
products such as options and forwards.
s Contingent Claim A claim that depends on a particular event such as an option payoff,
which depends on a stock price at some future date.
Within the context of option contracts we subdivide them into option style or option family,
which denotes the class into which the type of option contract falls, usually defined by the
dates on which the option may be exercised. These include:
s European Option An option that can only be exercised on the expiry date.
s American Option An option that can be exercised any time before the expiry date.
s Bermudan Option An option that can only be exercised on predetermined dates. Hence,
this option is intermediate between a European option and an American option.
Unless otherwise stated, all the options discussed in this chapter are considered to be European.
Option Trading
In option trading, the transaction involves two parties: a buyer and a seller.
s The buyer of an option is said to take a long position in the option, whilst the seller is said
to take a short position in the option.
s The buyer or owner of a call (put) option has the right to buy (sell) an asset at a specified
price by paying a premium to the seller or writer of the option, who will assume the obli-
gation to sell (buy) the asset should the owner of the option choose to exercise (enforce)
the contract.

1.1 INTRODUCTION
3
s The payoff of a call option at expiry time 𝑇is defined as
Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0}
where 𝑆𝑇is the price of the underlying asset at expiry time 𝑇and 𝐾is the strike price. If
𝑆𝑇> 𝐾at expiry, then the buyer of the call option should exercise the option by paying
a lower amount 𝐾to obtain an asset worth 𝑆𝑇. However, if 𝑆𝑇≤𝐾then the buyer of
the call option should not exercise the option because it would not make any financial
sense to pay a higher amount 𝐾to obtain an asset which is of a lower value 𝑆𝑇. Here,
the option expires worthless.
In general, the profit earned by the buyer of the call option is
Υ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0} −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the premium paid at time 𝑡< 𝑇(written on the underlying asset
𝑆𝑡) in order to enter into a call option contract.
Neglecting the premium for buying an option, a call option is said to be in-the-money
(ITM) if the buyer profits when the option is exercised (𝑆𝑇> 𝐾). In contrast, a call option
is said to be out-of-the-money (OTM) if the buyer loses when the option is exercised
(𝑆𝑇< 𝐾). Finally, a call option is said be to at-the-money (ATM) if the buyer neither loses
nor profits when the option is exercised (𝑆𝑇= 𝐾). Figure 1.1 illustrates the concepts we
have discussed.
Payoﬀ/Proﬁt
−(
;
)
+
(
;
)
Payoﬀ
Proﬁt
Figure 1.1
Long call option payoff and profit diagram.
s The payoff of a put option at expiry time 𝑇is defined as
Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0}
where 𝑆𝑇is the price of the underlying asset at expiry time 𝑇and 𝐾is the strike price. If
𝐾> 𝑆𝑇at expiry, then the buyer of the put option should exercise the option by selling
the asset worth 𝑆𝑇for a higher amount 𝐾. However, if 𝐾≤𝑆𝑇then the buyer of the put

4
1.1 INTRODUCTION
option should not exercise the option because it would not make any financial sense to
sell the asset worth 𝑆𝑇for a lower amount 𝐾. Here, the option expires worthless.
In general, the profit earned by the buyer of the put option is
Υ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0} −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the premium paid at time 𝑡< 𝑇(written on the underlying asset
𝑆𝑡) in order to enter into a put option contract.
Neglecting the premium for buying an option, a put option is said to be ITM if the buyer
profits when the option is exercised (𝐾> 𝑆𝑇). In contrast, a put option is said to be OTM
if the buyer loses when the option is exercised (𝐾< 𝑆𝑇). Finally, a put option is said
to be ATM if the buyer neither loses nor profits when the option is exercised (𝑆𝑇= 𝐾).
Figure 1.2 illustrates the concepts we have discussed.
Payoﬀ/Proﬁt
−
−
−
(
;
)
(
;
)
Payoﬀ
Proﬁt
(
;
)
Figure 1.2
Long put option payoff and profit diagram.
Forward Contract
In a forward contract, the transaction is executed between two parties: a buyer and a seller.
s The buyer of the underlying commodity or stock index is referred to as the long side
whilst the seller is known as the short side.
s The contractual obligation to buy the asset at the agreed price on a specified future date
is known as the long position. A long position profits when the price of an asset rises.
s The contractual obligation to sell the asset at the agreed price on a specified future date
is known as the short position. A short position profits when the price of an asset falls.
s For a long position, the payoff of a forward contract at the delivery time 𝑇is
Π𝑇= 𝑆𝑇−𝐹(𝑡, 𝑇)
where 𝑆𝑇is the spot price (or market price) at the delivery time 𝑇and 𝐹(𝑡, 𝑇) is the
forward price initiated at time 𝑡< 𝑇to be delivered at time 𝑇.

1.1 INTRODUCTION
5
s For a short position, the payoff of a forward contract at the delivery time 𝑇is
Π𝑇= 𝐹(𝑡, 𝑇) −𝑆𝑇
where 𝑆𝑇is the spot price (or market price) at the delivery time 𝑇and 𝐹(𝑡, 𝑇) is the
forward price initiated at time 𝑡< 𝑇to be delivered at time 𝑇.
s Since there is no upfront payment to enter into a forward contract, the profit at delivery
time 𝑇is the same as the payoff of a forward contract at time 𝑇. Figure 1.3 illustrates the
concepts we have discussed.
Payoﬀ
(
)
(
)
(
)
Long Forward
Short Forward
−
Figure 1.3
Long and short forward payoffs diagram.
Futures Contract
Similar to a forward contract, a futures contract is also an agreement between two parties in
which the buyer agrees to buy an underlying asset from the seller. The delivery of the asset
occurs at a specified future date, where the price is determined at the time of initiation of the
contract. As in the case of a forward contract, it costs nothing to enter into a futures contract.
However, the differences between futures and forwards are as follows:
s In a futures contract, the terms and conditions are standardised where trading takes place
on a formal exchange with deep liquidity.
s There is no default risk when trading futures contracts, since the exchange acts as a coun-
terparty guaranteeing delivery and payment by use of a clearing house.
s The clearing house protects itself from default by requiring its counterparties to settle
profits and losses or mark to market their positions on a daily basis.
s An investor can hedge his/her future position by engaging in an opposite transaction
before the delivery date of the contract.
In the futures market, margin is a performance guarantee. It is money deposited with the clear-
ing house by both the buyer and the seller. There is no loan involved and hence, no interest is

6
1.1 INTRODUCTION
charged. To safeguard the clearing house, the exchange requires buyers/sellers to post margin
(i.e., deposit funds) and settle their accounts on a daily basis. Prior to trading, the trader must
post margin with their broker who in return will post margin with the clearing house.
s Initial Margin Money that must be deposited in order to initiate a futures position.
s Maintenance Margin Minimum margin amount that must be maintained; when the mar-
gin falls below this amount it must be brought back up to its initial level. Margin calcu-
lations are based on the daily settlement price, the average of the prices for trades during
the closing period set by the exchange.
s Variation Margin Money that must be deposited to bring it back to the initial margin
amount. If the account margin is more than the initial margin, the investor can withdraw
the funds for new positions.
s Settlement Price Known also as the closing price for a stock. The settlement price is
the price at which a derivatives contract settles once a given trading day has ended. The
settlement price is used to calculate the margin at the end of each trading day.
s Marking-to-Market Process of adding gains to or subtracting losses from the margin
account daily, based on the change in the settlement prices from one day to the next.
Termination of a futures position can be achieved by:
s An offsetting trade (known as a back-to-back trade), entering into an opposite position in
the same contract.
s Payment of cash at expiration for a cash-settlement contract.
s Delivery of the asset at expiration.
s Exchange of physicals.
Stock Split (Divide) Effect
When a company issues a stock split (e.g., doubling the number of shares), the price is adjusted
so as to keep the net value of all the stock the same as before the split.
Stock Dividend Effect
When dividends are paid during the life of an option contract they will inadvertently affect the
price of the stock or asset. Here, the direction of the stock price will be determined based on
the choice of the company whether it pays dividends to its shareholders or reinvests the money
back in the business. Since we may regard dividends as a cash return to the shareholders,
the reinvestment of the cash back into the business could create more profit and, depending
on market sentiment, lead to an increase in stock price. Conversely, paying dividends to the
shareholders will effectively reduce the stock price by the amount of the dividend payment,
and as a result will affect the premium prices of options as well as futures and forwards.
Hedging Strategies
In the following we discuss how an investor can use options to design investment strategies
with specific views on the stock price behaviour in the future.
s Protective This hedging strategy is designed to insure an investor’s asset position (long
buy or short sell).

1.1 INTRODUCTION
7
An investor who owns an asset and wishes to be protected from falling asset values
can insure his asset by buying a put option written on the same asset. This combination
of owning an asset and purchasing a put option on that asset is called a protective put.
In contrast, an investor shorting an asset who will experience a loss if the asset price
rises in value can insure his position by purchasing a call option written on the same asset.
Such a combination of selling an asset and purchasing a call option on that asset is called
a protective call.
s Covered This hedging strategy involves the investor writing an option whilst holding
an opposite position on the asset. The motivation for doing so is to generate additional
income by receiving premiums from option buyers, and this strategy is akin to selling
insurance. When the writer of an option has no position in the underlying asset, this form
of option writing is known as naked writing.
In a covered call, the investor would hold a long position on an asset and sell a call
option written on the same asset.
In a covered put, the investor would short sell an asset and sell a put option written on
the same asset.
s Collar This hedging strategy uses a combination of protective strategy and selling options
to collar the value of an asset position within a specific range. By using a protective
strategy, the investor can insure his asset position (long or short) whilst reducing the cost
of insurance by selling an option.
In a purchased collar, the strategy consists of a protective put and selling a call option
whilst in a written collar, the strategy consists of a protective call and selling a put option.
s Synthetic Forward A synthetic forward consists of a long call, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a short
put, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) written on the same asset 𝑆𝑡at time 𝑡with the same expiration date
𝑇> 𝑡and strike price 𝐾.
At expiry time 𝑇, the payoff is
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑆𝑇−𝐾
and, assuming a constant risk-free interest rate 𝑟and by discounting the payoff back to
time 𝑡, we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
The above equation is known as the put–call parity, tying the relationship between options
and forward markets together.
s Bull Spread An investor who enters a bull spread expects the stock price to rise and
wishes to exploit this.
For a bull call spread, it is composed of
Bull Call Spread = 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
which consists of buying a call at time 𝑡with strike price 𝐾1 and expiry 𝑇and selling a
call at time 𝑡with strike price 𝐾2, 𝐾2 > 𝐾1 and same expiry 𝑇.
For a bull put spread, it is composed of
Bull Put Spread = 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
which consists of buying a put at time 𝑡with strike price 𝐾1 and expiry 𝑇and selling a
put at time 𝑡with strike price 𝐾2, 𝐾2 > 𝐾1 and same expiry 𝑇.

8
1.2.1 Forward and Futures Contracts
s Bear Spread The strategy behind the bear spread is the opposite of a bull spread. Here,
the investor who enters a bear spread expects the stock price to fall.
For a bear call spread, it is composed of
Bear Call Spread = 𝐶(𝑆𝑡.𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
which consists of selling a call at time 𝑡with strike price 𝐾1 and expiry 𝑇and buying a
call at time 𝑡with strike price 𝐾2, 𝐾2 > 𝐾1 and same expiry 𝑇.
For a bear put spread, it is composed of
Bear Put Spread = 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
which consists of selling a put at time 𝑡with strike price 𝐾1 and expiry 𝑇and buying a
put at time 𝑡with strike price 𝐾2, 𝐾2 > 𝐾1 and same expiry 𝑇.
s Butterfly Spread The investor who enters a butterfly spread expects that the stock price
will not change significantly. It is a neutral strategy combining bull and bear spreads.
s Straddle This strategy is used if an investor believes that a stock price will move signifi-
cantly, but is unsure in which direction. Here such a strategy depends on the volatility of
the stock price rather than the direction of the stock price changes.
For a long straddle, it is composed of
Long Straddle = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
which consists of buying a call and a put option at time 𝑡with the same strike price 𝐾
and expiry 𝑇.
For a short straddle, it is composed of
Short Straddle = −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
which consists of selling a call and a put option at time 𝑡with the same strike price 𝐾and
expiry 𝑇.
s Strangle The strangle hedging strategy is a variation of the straddle with the key differ-
ence that the options have different strike prices but expire at the same time.
s Strip/Strap The strip and strap strategies are modifications of the straddle, principally
used in volatile market conditions. However, unlike a straddle which has an unbiased
outlook on the stock price movement, investors who use a strip (strap) strategy would
exploit on downward (upward) movement of the stock price.
1.2
PROBLEMS AND SOLUTIONS
1.2.1
Forward and Futures Contracts
1. Consider an investor entering into a forward contract on a stock with spot price $10 and
delivery date 6 months from now. The forward price is $12.50. Draw the payoff diagrams
for both the long and short forward position of the contract.
Solution: See Figure 1.4.

1.2.1 Forward and Futures Contracts
9
Payoﬀ
Spot Price
$12.50
$12.50
$12.50
Long Forward
Short Forward
−
Figure 1.4
Long and short forward payoff diagram.
2. In terms of credit risk, is a forward contract riskier than a futures contract? Explain.
Solution: Given that forward contracts are traded OTC between two parties and futures
contracts are traded on exchanges which require margin accounts, forward contracts are
riskier than futures contracts.
3. Suppose ABC company shares are trading at $25 and pay no dividends and that the risk-
free interest rate is 5% per annum. The forward price for delivery in 1 year’s time is $28.
Draw the payoff and profit diagrams for a long position for this contract.
Solution: As there is no cost involved in entering into a forward contract, the payoff and
profit diagrams coincide (see Figure 1.5).
Payoﬀ/Proﬁt
Spot Price
$28
$28
Long Forward
−
Figure 1.5
Long forward payoff and profit diagram.

10
1.2.1 Forward and Futures Contracts
4. Consider a stock currently worth $100 per share with the risk-free interest rate 2% per
annum. The futures price for a 1-year contract is worth $104. Show that there exists an
arbitrage opportunity by entering into a short position in this futures contract.
Solution: At current time 𝑡= 0, a speculator can borrow $100 from the bank, buy the stock
and short a futures contract.
At delivery time 𝑇= 1 year, the outstanding loan is now worth 100𝑒0.02×1 = $102.02.
By delivering the stock to the long contract holder and receiving $104, the speculator can
make a riskless profit of $104 −$102.02 = $1.98.
5. Let the current stock price be $75 with the risk-free interest rate 2.5% per annum. Assume
the futures price for a 1-year contract is worth $74. Show that there exists an arbitrage
opportunity by entering into a long position in this futures contract.
Solution: At current time 𝑡= 0, a speculator can short sell the stock, invest the proceeds
in a bank account at the risk-free rate and then long a futures contract.
At time 𝑇= 1 year, the amount of money in the bank will grow to 75𝑒0.025×1 = $76.89.
After paying for the futures contract which is priced at $74, the speculator can then
return the stock to its owner. Thus, the speculator can make a riskless profit of $76.89 −
$74 = $2.89.
6. An investor holds a long position in a stock index futures contract with a delivery date
3 months from now. The value of the contract is $250 times the level of the index at the
start of the contract, and each index point movement represents a gain or a loss of $250
per contract. The futures contract at the start of the contract is valued at $250,000, and the
initial margin deposit is $15,000 with a maintenance margin of $13,750 per contract.
Table 1.1 shows the stock index movement over a 4-day period.
Table 1.1
Daily closing stock index.
Day
Closing Stock Index
1
1002
2
994
3
998
4
997
Calculate the initial stock index at the start of the contract. By setting up a table, calculate
the daily marking-to-market, margin balance and the variation margin over a 4-day period.
Solution: Since the futures contract is valued at $250,000 at the start of the contract, the
initial stock index is 250,000
250
= 1000.
Table 1.2 displays the daily marking-to-market, margin balance and the variation margin
in order to maintain the maintenance margin.
On Day 0, the initial balance is the initial margin requirement of $15,000 while on
Day 1, as the change in the stock index is increased by 2 points, the margin balance is
increased by $250 × 2 = $500. On Day 2, the margin balance is $13,500 which is below
the maintenance margin level of $13,750. Therefore, a deposit of $1,500 is needed to

1.2.1 Forward and Futures Contracts
11
Table 1.2
Daily movements of stock index.
Required
Closing Stock
Daily
Marking-to-
Margin
Variation
Day
Deposit
Index
Change
Market
Balance
Margin
0
$15,000
1000
0
0
$15,000
0
1
0
1002
+2
$500
$15,500
0
2
0
994
−8
−$2,000
$13,500
$1,500
3
$1,500
998
+4
$1,000
$16,000
0
4
0
997
−1
−$250
$15,750
0
bring the margin back to the margin requirement of $15,000. Hence, the variation margin
is $1,500 occurring on Day 2.
7. An investor wishes to enter into 10 stock index futures contracts where the value of a
contract is $250 times the level of the index at the start of the contract and each index
point movement represents a gain or a loss of $250 per contract. The stock index at the
start of the contract is 1,000 points and the initial margin deposit is 10% of the total futures
contract value.
Let the continuously compounded interest rate be 5% which can be earned on the margin
balance and the maintenance margin be 85% of the initial margin deposit. Suppose the
investor position is marked on a weekly basis. What does the maximum stock index need
to be in order for the investor to receive a margin call on week 1.
Solution: At the start of the contract the total futures contract value is $250 × 1,000 × 10 =
$2,500,000 and the initial margin deposit is $2,500,000 × 10
100 = $250,000. The mainte-
nance margin is therefore $250,000 × 85
100 = $187,500.
To describe the movement of the stock index for week 1, see Table 1.3.
Table 1.3
Movement of stock index on week 1.
Closing Stock
Weekly
Marking-to-
Margin
Variation
Week
Index
Change
Market
Balance
Margin
0
1000
0
0
$250,000
0
1
𝑥
𝑥−1000
$2,500
$250,000
$187,500
×(𝑥−1000)
+ $2,500
×(𝑥−1000)
Thus, in order to invoke a margin call we can set
2500(𝑥−1000) + 250,000 = 187,500
𝑥= 975.
Therefore, if the stock index were to fall to values below 975 points then a margin call will
be issued on week 1.
8. Let 𝑆𝑡denote the price of a stock with a dividend payment 𝛿≥0 at time 𝑡. What is the
price of the stock immediately after the dividend payment?

12
1.2.1 Forward and Futures Contracts
Solution: Let 𝑆+
𝑡denote the price of the stock immediately after the dividend payment.
Therefore,
𝑆+
𝑡= 𝑆𝑡−𝛿.
9. Consider the price of a futures contract 𝐹(𝑡, 𝑇) with delivery time 𝑇on a stock with price
𝑆𝑡at time 𝑡(𝑡< 𝑇). Suppose the stock does not pay any dividends. Show that under the
no-arbitrage condition the futures contract price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒𝑟(𝑇−𝑡)
where 𝑟is the risk-free interest rate.
Solution: We prove this result via contradiction.
If 𝐹(𝑡, 𝑇) > 𝑆𝑡𝑒𝑟(𝑇−𝑡) then at time 𝑡an investor can short the futures contract worth
𝐹(𝑡, 𝑇) and then borrow an amount 𝑆𝑡from the bank to buy the asset. By time 𝑇the bank
loan will amount to 𝑆𝑡𝑒𝑟(𝑇−𝑡). Since 𝐹(𝑡, 𝑇) > 𝑆𝑡𝑒𝑟(𝑇−𝑡) then using the money received at
delivery time 𝑇, the investor can pay off the loan, deliver the asset and make a risk-free
profit 𝐹(𝑡, 𝑇) −𝑆𝑡𝑒𝑟(𝑇−𝑡) > 0.
In contrast, if 𝐹(𝑡, 𝑇) < 𝑆𝑡𝑒𝑟(𝑇−𝑡) then at time 𝑡an investor can long the futures contract,
short sell the stock valued at 𝑆𝑡and then put the money in the bank. By time 𝑇the money
in the bank will grow to 𝑆𝑡𝑒𝑟(𝑇−𝑡) and after returning the stock (from the futures contract)
the investor will make a risk-free profit 𝑆𝑡𝑒𝑟(𝑇−𝑡) −𝐹(𝑡, 𝑇) > 0.
Therefore, under the no-arbitrage condition we must have 𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒𝑟(𝑇−𝑡).
10. Consider the price of a futures contract 𝐹(𝑡, 𝑇) with delivery time 𝑇on a stock with price
𝑆𝑡at time 𝑡(𝑡< 𝑇). Throughout the life of the futures contract the stock pays discrete divi-
dends 𝛿𝑖, 𝑖= 1, 2, … , 𝑛where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇. Show that under the no-arbitrage
condition the futures contract price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒𝑟(𝑇−𝑡) −
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝑖)
where 𝑟is the risk-free interest rate.
Solution: Suppose that over the life of the futures contract the stock pays dividends 𝛿𝑖
at time 𝑡𝑖, 𝑖= 1, 2, … , 𝑛where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇. When dividends are paid, the
stock price 𝑆𝑡is reduced by the present values of all the dividends paid, that is
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡).

1.2.1 Forward and Futures Contracts
13
Hence, using the same steps as discussed in Problem 1.2.1.9 (page 12), the futures price is
𝐹(𝑡, 𝑇) =
(
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
)
𝑒𝑟(𝑇−𝑡)
= 𝑆𝑡𝑒𝑟(𝑇−𝑡) −
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝑖).
11. Consider the number of stocks owned by an investor at time 𝑡as 𝐴𝑡where each of the
stocks pays a continuous dividend yield 𝐷. Assume that all the dividend payments are
reinvested in the stock. Show that the number of stocks owned by time 𝑇(𝑡< 𝑇) is
𝐴𝑇= 𝐴𝑡𝑒𝐷(𝑇−𝑡).
Next consider the price of a futures contract 𝐹(𝑡, 𝑇) with delivery time 𝑇on a stock with
price 𝑆𝑡at time 𝑡(𝑡< 𝑇). Suppose the stock pays a continuous dividend yield 𝐷. Using
the above result, show that under the no-arbitrage condition the futures contract price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
where 𝑟is the risk-free interest rate.
Solution: We first divide the time interval [𝑡, 𝑇] into 𝑛sub-intervals such that 𝑡𝑖= 𝑡+
𝑖(𝑇−𝑡)
𝑛
, 𝑖= 1, 2, … , 𝑛with 𝑡0 = 𝑡and 𝑡𝑛= 𝑇. By letting the dividend payment at time
𝑡𝑖be
𝛿𝑖= 𝐷(𝑇−𝑡)
𝑛
𝑆𝑡
for 𝑖= 1, 2, … , 𝑛, and because all the dividends are reinvested in the stock, the number of
stocks held becomes
𝐴𝑡1 = 𝐴𝑡0
[
1 + 𝐷(𝑇−𝑡)
𝑛
]
𝐴𝑡2 = 𝐴𝑡1
[
1 + 𝐷(𝑇−𝑡)
𝑛
]
= 𝐴𝑡0
[
1 + 𝐷(𝑇−𝑡)
𝑛
]2
𝐴𝑡3 = 𝐴𝑡2
[
1 + 𝐷(𝑇−𝑡)
𝑛
]
= 𝐴𝑡0
[
1 + 𝐷(𝑇−𝑡)
𝑛
]3
⋮
𝐴𝑡𝑛= 𝐴𝑡𝑛−1
[
1 + 𝐷(𝑇−𝑡)
𝑛
]
= 𝐴𝑡0
[
1 + 𝐷(𝑇−𝑡)
𝑛
]𝑛
.

14
1.2.1 Forward and Futures Contracts
Because 𝐴𝑡0 = 𝐴𝑡and 𝐴𝑡𝑛= 𝐴𝑇, therefore
𝐴𝑇= 𝐴𝑡
[
1 + 𝐷(𝑇−𝑡)
𝑛
]𝑛
and taking limits 𝑛→∞we have
lim
𝑛→∞𝐴𝑇= 𝐴𝑡lim
𝑛→∞
[
1 + 𝐷(𝑇−𝑡)
𝑛
]𝑛
= 𝐴𝑡𝑒𝐷(𝑇−𝑡).
From the above result we can deduce that investing one stock at time 𝑡will lead to a total
growth of 𝑒𝐷(𝑇−𝑡) by time 𝑇. Hence, if we start by buying 𝑒−𝐷(𝑇−𝑡) number of stocks 𝑆𝑡at
time 𝑡it will grow to one stock at time 𝑇. The total value of the stock at time 𝑡is therefore
𝑆𝑡𝑒−𝐷(𝑇−𝑡)
and following the arguments in Problem 1.2.1.9 (page 12) the futures price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒𝑟(𝑇−𝑡)
= 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡).
12. Suppose an asset is currently worth $20 and the 6-month futures price of this asset is
$22.50. By assuming the stock does not pay any dividends and the risk-free interest rate is
the same for all maturities, calculate the 1-year futures price of this asset.
Solution: By definition the futures price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒𝑟(𝑇−𝑡)
where 𝑡is the time of the start of the contract, 𝑇is the delivery time, 𝑆𝑡is the spot price at
time 𝑡and 𝑟is the risk-free interest rate.
By setting 𝑡= 0, 𝑆0 = $20 and 𝑇1 = 0.5 years we have
𝐹(0, 𝑇1) = 𝑆0𝑒𝑟𝑇1 = $22.50.
Hence,
𝑟= 2 log
(22.50
20
)
= 2 log 1.125.
Therefore, for a 1-year futures price, 𝑇2 = 1 year
𝐹(0, 𝑇2) = 𝑆0𝑒𝑟𝑇2 = $20𝑒2 log 1.125×1 = $25.31.
13. Assume an investor buys 100,000 stocks of XYZ company and holds them for 3 years.
Each of the stocks held pays a continuous dividend yield of 4% per annum and the investor

1.2.2 Options Theory
15
reinvests all the dividends when they are paid. Calculate the additional number of shares
the investor would have at the end of 3 years.
Solution: Let 𝐴0 = 100,000, 𝐷= 0.04 and 𝑇= 3 years. Therefore, by the end of 3 years,
the number of shares owned by the investor is
𝐴𝑇= 𝐴0𝑒𝐷𝑇= 100,000𝑒0.04×3 = 112,749.69.
Therefore, the additional number of shares the investor has by the end of year 3 is
𝐴𝑇−𝐴0 = 112,749.69 −100,000 = 12,749.69 ≃12,749.
14. Let the current stock price be $30 with two dividend payments in 6 months and 9 months
from today of $1.50 and $1.80, respectively. The continuously compounded risk-free inter-
est rate is 5% per annum. Find the price of a 1-year futures contract.
Solution: Let 𝑆0 = $30, 𝑡1 = 6
12 = 0.5 years, 𝑡2 = 9
12 = 0.75 years, 𝛿1 = $1.50, 𝛿2 =
$1.80, 𝑟= 0.05 and 𝑇= 1 year.
Therefore, the price of a 1-year futures contract is
𝐹(0, 𝑇) = 𝑆0𝑒𝑟𝑇−𝛿1𝑒𝑟(𝑇−𝑡1) −𝛿2𝑒𝑟(𝑇−𝑡2)
= 30𝑒0.05×1 −1.50𝑒0.05×(1−0.5) −1.80𝑒0.05×(1−0.75)
= $28.18.
15. Let the current price of a stock be $12.75 that pays a continuous dividend yield 𝐷. Suppose
the risk-free interest rate is 6% per annum and the price of a 6-month forward contract is
$13.25. Find 𝐷.
Solution: Let 𝑆0 = $12.50, 𝑟= 0.06, 𝑇= 0.5 years and 𝐹(0, 𝑇) = $13.25. Since
𝐹(0, 𝑇) = 𝑆0𝑒(𝑟−𝐷)𝑇,
12.75𝑒(0.06−𝐷)×0.5 = 13.25
𝐷= 0.06 −log
(13.25
12.75
)
× 1
0.5
= 0.020395.
Hence, the dividend yield is 𝐷= 2.0395% per annum.
1.2.2
Options Theory
1. Consider a long call option with strike price 𝐾= $100. The current stock price is 𝑆𝑡=
$105 and the call premium is $10. What is the intrinsic value of the call option at time 𝑡?
Find the payoff and profit if the spot price at the option expiration date 𝑇is 𝑆𝑇= $120.
Draw the payoff and profit diagrams.

16
1.2.2 Options Theory
Solution: By defining 𝑆𝑡= $105, 𝑆𝑇= $120, 𝐾= $100 and the call premium as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $10, the intrinsic value of the call option at time 𝑡is
Ψ(𝑆𝑡) = max{𝑆𝑡−𝐾, 0} = max{105 −100, 0} = $5.
At expiry time 𝑇, the payoff is
Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0} = max{120 −100, 0} = $20
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $20 −$10 = $10.
Figure 1.6 shows the payoff and profit diagrams for a long call option at the expiry time
𝑇. Here the profit diagram is a vertical shift of the call payoff based on the premium paid.
Payoﬀ/Proﬁt
$10
$100
$110
Payoﬀ
Proﬁt
−
Figure 1.6
Long call option payoff and profit diagrams.
2. Consider a long put option with strike price 𝐾= $100. The current stock price is 𝑆𝑡= $80
and the put premium is $5. What is the intrinsic value of the put option at time 𝑡? Find the
payoff and profit if the spot price at the option expiration date 𝑇is 𝑆𝑇= $75. Draw the
payoff and profit diagrams.
Solution: By defining 𝑆𝑡= $80, 𝑆𝑇= $75, 𝐾= $100 and the put premium as
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $5, the intrinsic value of the call option at time 𝑡is
Ψ(𝑆𝑡) = max{𝐾−𝑆𝑡, 0} = max{100 −80, 0} = $20.

1.2.2 Options Theory
17
At expiry time 𝑇, the payoff is
Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0} = max{100 −75, 0} = $25
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $25 −$5 = $20.
Figure 1.7 shows the payoff and profit diagrams for a long put option at the expiry time 𝑇.
Here the profit diagram is a vertical shift of the put payoff based on the premium paid.
Payoﬀ/Proﬁt
$95
$100
$95
Payoﬀ
Proﬁt
$100
−$5
Figure 1.7
Long put option payoff and profit diagrams.
3. At time 𝑡we consider a long call option with a strike price 𝐾and a long forward con-
tract with price 𝐾on the same underlying asset 𝑆𝑡. The premium for the call option is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇). Draw the profit diagram for these two financial instruments at the option
expiry date 𝑇.
Under what conditions is the call option more profitable than the forward contract, and
vice versa?
Solution: Figure 1.8 shows the profit diagram for a long call and a long forward contract
at expiry date 𝑇.
At time 𝑇the break even at the profit level is at 𝑆𝑇= 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇). Therefore, if
the stock 𝑆𝑇≤𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the call option is more profitable as the loss is fixed
with the amount of premium paid. However, if 𝑆𝑇> 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the forward
contract is more profitable since there is no cost in entering a forward contract.
4. At time 𝑡we consider a long put option with strike price 𝐾and a short forward contract with
price 𝐾on the same underlying asset 𝑆𝑡. The premium for the put option is 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Draw the profit diagram for these two financial instruments at the option expiry date 𝑇.

18
1.2.2 Options Theory
Long Forward
(
;
)
+
(
;
)
Proﬁt
Long Call Option
−
−
Figure 1.8
Long call option and long forward profit diagrams.
Under what conditions is the put option more profitable than the forward contract, and
vice versa?
Solution: Figure 1.9 shows the profit diagram for a long put and a short forward contract
at expiry date 𝑇.
Proﬁt
−
(
;
)
−
(
;
)
Short Forward
Long Put Option
(
;
)
−
Figure 1.9
Long put option and short forward profit diagrams.
At time 𝑇the break-even point is at 𝑆𝑇= 𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇). Therefore, if the stock
𝑆𝑇≥𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the put option is more profitable as the loss is fixed with the
amount of premium paid. However, if 𝑆𝑇< 𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the forward contract
is more profitable since there is no cost in entering a forward contract.

1.2.2 Options Theory
19
5. Consider a short call option with strike price 𝐾= $100. The current stock price is 𝑆𝑡=
$105 and the call premium is $10. What is the intrinsic value of the call option at time 𝑡?
Find the payoff and profit if the spot price at the option expiration date 𝑇is 𝑆𝑇= $120.
Draw the payoff and profit diagrams.
Solution: By defining 𝑆𝑡= $105, 𝑆𝑇= $120, 𝐾= $100 and the call premium as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $10, the intrinsic value of the short call option at time 𝑡is
Ψ(𝑆𝑡) = −max{𝑆𝑡−𝐾, 0} = min{𝐾−𝑆𝑡, 0} = min{100 −105, 0} = −$5.
At expiry time 𝑇, the payoff is
Ψ(𝑆𝑇) = −max{𝑆𝑇−𝐾, 0} = min{𝐾−𝑆𝑇, 0} = −min{100 −120, 0} = −$20
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = −$20 + $10 = −$10.
Figure 1.10 shows the payoff and profit diagram for a short call option at the expiry time
𝑇. Here the profit diagram is a vertical shift of the short call payoff based on the premium
received.
Proﬁt
$10
$100
$110
Payoﬀ/Payoﬀ
Payoﬀ
Figure 1.10
Short call option payoff and profit diagrams.
6. Consider a short put option with strike price 𝐾= $100. The current stock price is 𝑆𝑡= $80
and the put premium is $5. What is the intrinsic value of the put option at time 𝑡? Find the
payoff and profit if the spot price at the option expiration date 𝑇is 𝑆𝑇= $75. Draw the
payoff and profit diagrams.

20
1.2.2 Options Theory
Solution: By defining 𝑆𝑡= $80, 𝑆𝑇= $75, 𝐾= $100 and the put premium as
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $5, the intrinsic value of the short put option at time 𝑡is
Ψ(𝑆𝑡) = −max{𝐾−𝑆𝑡, 0} = min{𝑆𝑡−𝐾, 0} = min{80 −100, 0} = −$20.
At expiry time 𝑇, the payoff is
Ψ(𝑆𝑇) = −max{𝐾−𝑆𝑇, 0} = min{𝑆𝑇−𝐾, 0} = min{75 −100, 0} = −$25
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = −$25 + $5 = −$20.
Figure 1.11 shows the payoff and profit diagrams for a short put option at the expiry time
𝑇. Here the profit diagram is a vertical shift of the short put payoff based on the premium
received.
Payoﬀ/Proﬁt
−$95
−$100
$95
Payoﬀ
Proﬁt
$100
$5
Figure 1.11
Short put option payoff and profit diagrams.
7. At time 𝑡we consider a short call option with strike price 𝐾and a short forward contract
with price 𝐾on the same underlying asset 𝑆𝑡and expiry time 𝑇> 𝑡. The premium for
the call option is 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) at time 𝑡. Draw the profit diagram for these two financial
instruments at the option expiry time 𝑇.
Under what conditions is the call option more profitable than the forward contract, and
vice versa?
Solution: Figure 1.12 shows the profit diagram for a short call and a short forward contract
at expiry time 𝑇.

1.2.2 Options Theory
21
Short Forward
(
;
)
+
(
;
)
Proﬁt
Short Call Option
Figure 1.12
Short call option and short forward profit diagrams.
At time 𝑇the break-even point is at 𝑆𝑇= 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇). Therefore, if the stock
𝑆𝑇≤𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the forward contract is more profitable as the short call profit
is fixed with the amount of premium received. However, if 𝑆𝑇> 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) then
the forward contract is less profitable since the short call is augmented by the amount of
premium paid to it.
8. At time 𝑡we consider a short put option with strike price 𝐾and a long forward contract
with price 𝐾on the same underlying asset 𝑆𝑡and expiry time 𝑇> 𝑡. The premium for the
put option is 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇). Draw the profit diagram for these two financial instruments at
the option expiry time 𝑇.
Under what conditions is the put option more profitable than the forward contract, and
vice versa?
Solution: Figure 1.13 shows the profit diagram for a short put and a long forward contract
at expiry time 𝑇.
At time 𝑇the break-even point is at 𝑆𝑇= 𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇). Therefore, if the stock
𝑆𝑇≥𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) then the forward contract is more profitable as the short put profit
is fixed by the amount of premium received. However, if 𝑆𝑇< 𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) then
the forward contract is less profitable since the short put is augmented by the amount of
premium paid to it.
9. Put–Call Parity I. At time 𝑡we consider a non-dividend-paying stock with spot price 𝑆𝑡
and a risk-free interest rate 𝑟. Show that by taking a long European call option price at time
𝑡, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a short European put option price at time 𝑡, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same

22
1.2.2 Options Theory
Proﬁt
+
(
;
)
−
−
−
(
;
)
Long Forward
Short Put Option
(
;
)
Figure 1.13
Short put option and long forward profit diagrams.
underlying stock 𝑆𝑡, strike price 𝐾and expiry time 𝑇(𝑡< 𝑇) we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
Solution: At time 𝑡we define the call option price as 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and the put option
price as 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇), and we set the portfolio Π𝑡as
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇≥𝐾
𝑆𝑇−𝐾
if 𝑆𝑇< 𝐾
= 𝑆𝑇−𝐾.
In order for the portfolio to generate a guaranteed 𝐾at expiry time 𝑇, at time 𝑡we can
discount the final value of the portfolio to
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
since a share valued at 𝑆𝑡will be worth 𝑆𝑇at expiry time 𝑇.
10. Put–Call Parity II. At time 𝑡we consider a discrete dividend-paying stock with spot price
𝑆𝑡where the stock pays dividend 𝛿𝑖≥0 at time 𝑡𝑖, 𝑖= 1, 2, … , 𝑛for 𝑡< 𝑡1 < 𝑡2 < ⋯<

1.2.2 Options Theory
23
𝑡𝑛< 𝑇. Show that by taking a long European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a short Euro-
pean put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same underlying stock 𝑆𝑡, strike price 𝐾and expiry
time 𝑇(𝑡< 𝑇) we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
where 𝑟is the risk-free interest rate.
Solution: At time 𝑡we set up the portfolio Π𝑡as
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and at expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇≥𝐾
𝑆𝑇−𝐾
if 𝑆𝑇< 𝐾
= 𝑆𝑇−𝐾.
In order for the portfolio to generate one stock 𝑆𝑇with guaranteed 𝐾at expiry time 𝑇, at
time 𝑡we can discount the final value of the portfolio to
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
since when dividends are paid the stock price 𝑆𝑡is reduced by the present value of all the
dividends paid.
11. Put–Call Parity III. At time 𝑡we consider a continuous dividend-paying stock with spot
price 𝑆𝑡where 𝐷is the continuous dividend yield and 𝑟is the risk-free interest rate. Show
that by taking a long European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a short European put option
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same underlying stock 𝑆𝑡, strike price 𝐾and expiry time 𝑇(𝑡< 𝑇)
we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡).
Solution: At time 𝑡we define the call option price as 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and the put option
price as 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇), and we set the portfolio Π𝑡as
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).

24
1.2.2 Options Theory
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝐾−𝑆𝑇, 0}
=
{𝑆𝑇−𝐾
if 𝑆𝑇≥𝐾
𝑆𝑇−𝐾
if 𝑆𝑇< 𝐾
= 𝑆𝑇−𝐾.
In order for the portfolio to generate one stock 𝑆𝑇with guaranteed 𝐾at expiry time 𝑇, at
time 𝑡we can discount the final value of the portfolio to
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
since 𝑒−𝐷(𝑇−𝑡) number of shares valued at 𝑆𝑡𝑒−𝐷(𝑇−𝑡) will become one share worth 𝑆𝑇at
expiry time 𝑇.
12. At time 𝑡we consider a call option with strike price 𝐾= $100. Calculate the intrinsic
value of this option if the current spot price is 𝑆𝑡= $105, 𝑆𝑡= $100 or 𝑆𝑡= $95 and state
whether it is ITM, OTM or ATM.
Solution: At time 𝑡the intrinsic call option value is Ψ(𝑆𝑡) = max{𝑆𝑡−𝐾, 0}. Hence, if
𝑆𝑡= $105
Ψ(𝑆𝑡) = max{105 −100, 0} = $5
and since 𝑆𝑡> 𝐾, the intrinsic value of the call option is ITM.
As for 𝑆𝑡= $100
Ψ(𝑆𝑡) = max{100 −100, 0} = 0
and because Ψ(𝑆𝑡) = 0 and 𝑆𝑡= 𝐾, the intrinsic value of the call option is ATM.
Finally, for 𝑆𝑡= $95
Ψ(𝑆𝑡) = max{95 −100, 0} = 0
and since 𝑆𝑡< 𝐾, the intrinsic value of the call option is OTM.
13. At time 𝑡we consider a put option with strike price 𝐾= $100. Compute the intrinsic value
of this option if the current spot price is 𝑆𝑡= $105, 𝑆𝑡= $100 or 𝑆𝑡= $95 and state whether
it is ITM, OTM or ATM.
Solution: At time 𝑡the intrinsic put option value is Ψ(𝑆𝑡) = max{𝐾−𝑆𝑡, 0}. Hence, if
𝑆𝑡= $105
Ψ(𝑆𝑡) = max{100 −105, 0} = 0
and since 𝑆𝑡> 𝐾, the intrinsic value of the put option is OTM.
As for 𝑆𝑡= $100
Ψ(𝑆𝑡) = max{100 −100, 0} = 0
and because Ψ(𝑆𝑡) = 0 and 𝑆𝑡= 𝐾, the intrinsic value of the put option is ATM.

1.2.2 Options Theory
25
Finally, for 𝑆𝑡= $95
Ψ(𝑆𝑡) = max{100 −95, 0} = $5
and since 𝑆𝑡< 𝐾, the intrinsic value of the put option is OTM.
14. Suppose we have a quote for a 3-month European put option, with a strike price 𝐾= $60
of $1.25. The current stock price 𝑆0 = $62 and the risk-free interest rate 𝑟= 5% per annum.
Owing to small trading in call options, there is no listing for the 3-month $60 call (a call
option price with strike $60 expiring in 3 months). Suppose the stock does not pay any
dividends then find the price of the 3-month European call option.
Solution: We first denote 𝐶(𝑆0, 0; 𝐾, 𝑇) and 𝑃(𝑆0, 0; 𝐾, 𝑇) as the call and put option
prices, respectively at time 𝑡= 0 with strike price 𝐾and option expiry time 𝑇= 3 months.
Given 𝑃(𝑆0, 0; 𝐾, 𝑇) = $1.25 and 𝑇= 3
12 = 0.25 years, by rearranging the put–call parity
we can write
𝐶(𝑆0, 0; 𝐾, 𝑇) = 𝑃(𝑆0, 0; 𝐾, 𝑇) + 𝑆0 −𝐾𝑒−𝑟𝑇
= $1.25 + $62 −60𝑒−0.05×0.25
= $4.00.
Hence, if the 3-month $60 call is available, it should be priced at $4.00.
15. At time 𝑡we consider a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a European put option
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same underlying asset 𝑆𝑡, strike price 𝐾and expiry time 𝑇. Suppose
the underlying asset pays a continuous dividend yield 𝐷and there is a risk-free interest
rate 𝑟, then under what condition is a European call option more expensive than a European
put option?
Solution: From the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
then 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) if
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) > 0
or
𝑆𝑡> 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡).
16. Suppose that a 6-month European call option, with a strike price of 𝐾= $85, has a premium
of $2.75. The futures price for a 6-month contract is worth $75 and the risk-free rate 𝑟= 5%
per annum. Find the price of a 6-month European put option with the same strike price.
Solution: At initial time 𝑡= 0 we denote 𝐶(𝑆0, 0; 𝐾, 𝑇) and 𝑃(𝑆0, 0; 𝐾, 𝑇) as the call and
put option prices, respectively on the underlying asset 𝑆0, strike 𝐾and expiry time 𝑇= 6

26
1.2.2 Options Theory
months. Let the expiry time 𝑇= 6
12 = 0.5 years, 𝐶(𝑆0, 0; 𝐾, 𝑇) = $2.75 and set the futures
price 𝐹(0, 𝑇) = $75. From the put–call parity we have
𝐶(𝑆0, 0; 𝐾, 𝑇) −𝑃(𝑆0, 0; 𝐾, 𝑇) = 𝑆0𝑒−𝐷𝑇−𝐾𝑒−𝑟𝑇
where 𝐷is the continuous dividend yield. Since
𝐹(0, 𝑇) = 𝑆0𝑒(𝑟−𝐷)𝑇
we can write
𝑃(𝑆0, 0; 𝐾, 𝑇) = 𝐶(𝑆0, 0; 𝐾, 𝑇) −(𝐹(0, 𝑇) −𝐾)𝑒−𝑟𝑇
and by substituting 𝐶(𝑆0, 0; 𝐾, 𝑇) = $2.75, 𝐹(0, 𝑇) = $75, 𝐾= $85, 𝑟= 0.05 and 𝑇=
0.5 years, the put option price is
𝑃(𝑆0, 0; 𝐾, 𝑇) = $2.75 −($75 −$85)𝑒−0.05×0.5 = $12.50.
17. Suppose a 12-month European call option, with a strike price of 𝐾= $35, has a premium
of $2.15. The stock pays a dividend valued at $1.50 four months from now and another
dividend valued at $1.75 eight months from now. Given that the current stock price is
𝑆0 = $32 and the risk-free rate 𝑟= 5% per annum, find the price of a 12-month European
put option with the same strike price.
Solution: Using the put–call parity for a stock with discrete dividends at time 𝑡= 0 we
have
𝐶(𝑆0, 0; 𝐾, 𝑇) −𝑃(𝑆0, 0; 𝐾, 𝑇) = 𝑆0 −𝛿1𝑒−𝑟𝑡1 −𝛿2𝑒−𝑟𝑡2 −𝐾𝑒−𝑟𝑇
where 𝑆0 = $32, 𝛿1 = $1.50, 𝑡1 = 4
12 = 1
3 years, 𝛿2 = $1.75, 𝑡2 = 8
12 = 2
3 years, 𝐾= $35,
𝑟= 0.05 and 𝑇= 1 year with European call option price 𝐶(𝑆0, 0; 𝐾, 𝑇) = $2.15 and
unknown European put option price 𝑃(𝑆0, 0; 𝐾, 𝑇).
Thus,
𝑃(𝑆0, 0; 𝐾, 𝑇) = 𝐶(𝑆0, 0; 𝐾, 𝑇) −𝑆0 + 𝛿1𝑒−𝑟𝑡1 + 𝛿2𝑒−𝑟𝑡2 + 𝐾𝑒−𝑟𝑇
= 2.15 −32 + 1.50𝑒−0.05× 1
3 + 1.75𝑒−0.05× 2
3 + 35𝑒−0.05
= $6.61.
18. Consider a European put option priced at $2.50 with strike price $22 and a European call
option priced at $4.75 with strike price $30. What are the maximum losses to the writer of
the put and the buyer of the call?

1.2.3 Hedging Strategies
27
Solution: At time 𝑡the maximum loss of a short put is −𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝐾is the
strike price, 𝑇> 𝑡is the expiry date and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the put option price. Therefore,
the maximum loss of a short put is −$22 + $2.50 = −$19.50.
In contrast, the maximum loss to the buyer of the call option is the premium paid, that
is −$4.75.
19. Let the current stock price be $35 and the European put option is ITM by $3.50. Find the
corresponding strike price.
Solution: At current time 𝑡, the intrinsic value of the put option is defined as
Ψ(𝑆𝑡) = max{𝐾−𝑆𝑡, 0}
where 𝑆𝑡and 𝐾are the current stock price and strike price, respectively.
Given 𝑆𝑡= $35, Ψ(𝑆𝑡) = $3.50 and since 𝐾> 𝑆𝑡(intrinsic value is ITM), then
𝐾−$35 = $3.50
or
𝐾= $38.50.
20. Given the current spot price 𝑆0 = $55 we consider a European call option and a European
put option with premiums $1.98 and $0.79, respectively on a common strike price 𝐾=
$58 and having the same expiry time 𝑇. By setting the risk-free interest rate 𝑟= 3% per
annum, find 𝑇.
Solution: From the put–call parity at time 𝑡= 0,
𝐶(𝑆0, 0; 𝐾, 𝑇) + 𝑃(𝑆0, 0; 𝐾, 𝑇) = 𝑆0 −𝐾𝑒−𝑟𝑇
where the call option 𝐶(𝑆0, 0; 𝐾, 𝑇) = $1.98 and the put option 𝑃(𝑆0, 0; 𝐾, 𝑇) = $0.79.
Substituting 𝑆0 = $55, 𝐾= $58 and 𝑟= 0.03, we have
1.98 −0.79 = 55 −58𝑒−0.03×𝑇
1.19 = 55 −58𝑒−0.03×𝑇
and solving the equation, we have
𝑒−0.03×𝑇= 0.9278
or
𝑇≃2.5 years.
1.2.3
Hedging Strategies
1. Covered Call. A covered call is an investment strategy constructed by buying a stock and
selling an OTM call option on the same stock.

28
1.2.3 Hedging Strategies
Explain why a call writer would set up this portfolio trading strategy and show that this
strategy is undertaken for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡−𝐾where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the call option
price written on stock 𝑆𝑡with strike price 𝐾at time 𝑡with option expiry time 𝑇> 𝑡.
Draw the profit diagram of this strategy at expiry time 𝑇(𝑇> 𝑡).
Solution: In writing a covered call where the writer owns the stock, the writer can cover
the obligation of delivering the stock if the holder of the call exercises the option at expiry
date. In addition, by writing a covered call, the writer assumes the stock price will not
be higher than the strike price and thus enhance his income by receiving the call option’s
premium. In contrast, if the stock price declines in value then the writer will lose money.
At time 𝑇the payoff of this portfolio is
Ψ(𝑆𝑇) = 𝑆𝑇−𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝑆𝑇−max{𝑆𝑇−𝐾, 0}
=
⎧
⎪
⎨
⎪⎩
𝐾
if 𝑆𝑇≥𝐾
𝑆𝑇
if 𝑆𝑇< 𝐾
whilst the profit is
Υ(𝑆𝑇) =
{𝐾−𝑆𝑡+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≥𝐾
𝑆𝑇−𝑆𝑡+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇< 𝐾
where we need to deduct the cost of acquiring 𝑆𝑡and also to add the call option premium
at the start of the contract.
Since the break-even point occurs when 𝑆𝑇= 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) where Υ(𝑆𝑇) = 0, in
order for the strategy to take place we require 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾or 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤
𝑆𝑡−𝐾.
Figure 1.14 shows the profit diagram of a covered call.
Since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡−𝐾, the maximum gain from this strategy is 𝐾−𝑆𝑡+
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 whilst the maximum loss is −𝑆𝑡+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤0.
2. Covered Put. A covered put is a hedging strategy constructed by selling a stock and selling
an OTM put option on the same stock.
Explain why a put writer would set up this portfolio trading strategy and show that this
strategy is undertaken for 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾−𝑆𝑡where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the put option
price written on stock 𝑆𝑡with strike price 𝐾at time 𝑡and expiry time 𝑇> 𝑡.
Draw the profit diagram of this strategy at expiry time 𝑇(𝑇> 𝑡).
Solution: In writing a covered put the writer expects the stock price will decline in value
relative to the strike and thus enhance his income by receiving the put option’s premium.
By selling the stock short, the writer does not need to worry if the stock price drops further.
However, if the stock price is much greater than the strike price at expiry then the writer
will lose money.

1.2.3 Hedging Strategies
29
+
=
Proﬁt
Proﬁt
Proﬁt
Long Stock
(
;
)
−
+
(
;
)
−
+
(
;
)
Short Call Option
Covered Call
−
Figure 1.14
Construction of a covered call.
At time 𝑇the payoff of this portfolio is
Ψ(𝑆𝑇) = −𝑆𝑇−𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= −𝑆𝑇−max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
−𝑆𝑇
if 𝑆𝑇≥𝐾
−𝐾
if 𝑆𝑇< 𝐾
whilst the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑡−𝑆𝑇+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≥𝐾
𝑆𝑡−𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇< 𝐾
where we need to add the sale of 𝑆𝑡and also the put option premium received at the start
of the contract.
Since the break-even point occurs when 𝑆𝑇= 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) where Υ(𝑆𝑇) = 0,
this strategy is undertaken when 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾or 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡−𝐾.
For a detailed construction of a covered put, see Figure 1.15.

30
1.2.3 Hedging Strategies
+
=
Proﬁt
Proﬁt
Proﬁt
Short Stock
(
;
)
−
+
(
;
)
Short Put Option
Covered Put
−
+
(
;
)
Figure 1.15
Construction of a covered put.
Since 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾−𝑆𝑡, the maximum gain from this strategy is capped at 𝑆𝑡−
𝐾+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 whilst the loss is unlimited.
3. Protective Call. A protective call is an investment strategy constructed by selling a stock
and buying an OTM call option on the same stock.
Explain why a call holder would set up this portfolio trading strategy and show that this
strategy is undertaken for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡−𝐾where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the call option
price written on stock 𝑆𝑡with strike price 𝐾at time 𝑡and expiry time 𝑇> 𝑡.
Draw the profit diagram of this strategy at expiry time 𝑇(𝑇> 𝑡).
Solution: In buying a protective call the investor strategy is to protect profits from the rising
stock price with respect to the strike price. By selling the stock the call holder assumes that
the stock price will decline further. If the stock price is less than the strike at expiry time
then the option will not be exercised and the call buyer will only lose the premium paid.
At time 𝑇the payoff of this portfolio is
Ψ(𝑆𝑇) = −𝑆𝑇+ 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= −𝑆𝑇+ max{𝑆𝑇−𝐾, 0}
=
{−𝐾
if 𝑆𝑇≥𝐾
−𝑆𝑇
if 𝑆𝑇< 𝐾

1.2.3 Hedging Strategies
31
+
=
Proﬁt
Proﬁt
Proﬁt
Short Stock
−(
;
)
−
(
;
)
Long Call Option
Protective Call
−
−
(
;
)
Figure 1.16
Construction of a protective call.
whilst the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑡−𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≥𝐾
𝑆𝑡−𝑆𝑇−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇< 𝐾
where we need to add the sale of the stock at time 𝑡and deduct the call option premium
paid at the beginning of the contract.
Since the break-even point occurs when 𝑆𝑇= 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) so that Υ(𝑆𝑇) =
0, this strategy should be undertaken when 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾or 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥
𝑆𝑡−𝐾.
Figure 1.16 shows the profit diagram of a protective call.
From the profit formula we can see that the protective call has a maximum upside gain
of 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇), which is the difference between the sale of the stock and the call
option premium, and a limited loss of 𝑆𝑡−𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤0.

32
1.2.3 Hedging Strategies
4. Protective Put. A protective put is a hedging strategy constructed by buying a stock and
buying an OTM put option on the same stock.
Explain why a put buyer would set up this portfolio trading strategy and show that this
strategy is undertaken for 𝑃(𝑆𝑡, 𝑡) ≥𝐾−𝑆𝑡where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the put option price
written on stock 𝑆𝑡with strike price 𝐾at time 𝑡and expiry time 𝑇> 𝑡.
Draw the profit diagram of this strategy at expiry time 𝑇(𝑇> 𝑡).
Solution: In buying a protective put the investor strategy is to protect profits from the stock
declining in value with respect to the strike price. By owning the stock the put holder can
cover the obligation of delivering the stock to the put writer if the option is exercised at
expiry time. If the stock price is above the strike at expiry time then the option will not be
exercised and the put buyer will only lose the premium paid.
At time 𝑇the payoff of this portfolio is
Ψ(𝑆𝑇) = 𝑆𝑇+ 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝑆𝑇+ max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇
if 𝑆𝑇≥𝐾
𝐾
if 𝑆𝑇< 𝐾
whilst the profit is
Υ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝑆𝑡−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≥𝐾
𝐾−𝑆𝑡−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇< 𝐾
where we need to deduct both the cost of acquiring 𝑆𝑡and the put option premium paid at
the beginning of the contract.
Since the break-even point occurs when 𝑆𝑇= 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) so that Υ(𝑆𝑇) = 0,
this strategy is undertaken if 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾or 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾−𝑆𝑡.
Figure 1.17 shows the profit diagram of a protective put.
From the profit formula we can see that the protective put has an unlimited upside gain
and, because 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾−𝑆𝑡, it has a limited loss of 𝐾−𝑆𝑡−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤0.
5. At time 𝑡consider a writer of a covered call on a $35 stock with a strike price of $40.
The premium of the call option is $1.75. Calculate the writer’s maximum gain and loss at
expiry time 𝑇> 𝑡.
Solution: At time 𝑡at the start of the contract let 𝑆𝑡= $35, 𝐾= $40 and the call option
price 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $1.75.
From Problem 1.2.3.1 (page 28) the maximum gain of a covered call at expiry time 𝑇
(𝑇> 𝑡) is
Υ𝐺(𝑆𝑇) = 𝐾−𝑆𝑡+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 40 −35 + 1.75 = $6.75

1.2.3 Hedging Strategies
33
+
=
Proﬁt
Proﬁt
Proﬁt
Long Stock
−
(
;
)
−
−
(
;
)
Long Put Option
Protective Put
−(
;
)
−
Figure 1.17
Construction of a protective put.
and the maximum loss is
Υ𝐿(𝑆𝑇) = −𝑆𝑡+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = −35 + 1.75 = −$33.25.
6. At time 𝑡a writer short sells a stock for $33 and sells a put option with strike price $25 for
$1.75. What is the maximum gain and loss for the writer of this protective put at expiry
time 𝑇> 𝑡?
Solution: At current time 𝑡we let the spot price of the stock be 𝑆𝑡= $33, strike 𝐾= $25
and put option price 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $1.75. Therefore, from Problem 1.2.3.4 (page 33)
Maximum Gain of Protective Put = +∞
and
Maximum Loss of Protective Put = 𝐾−𝑆𝑡−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= $25 −$33 −$1.75
= −$9.75.
7. Bull Call Spread. A bull call spread is a hedging position designed to buy a call option
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and simultaneously sell a call option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with

34
1.2.3 Hedging Strategies
strike 𝐾2, 𝐾1 ≤𝐾2 on the same underlying asset 𝑆𝑡and having the same expiry time 𝑇
(𝑇> 𝑡).
Show that
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇),
𝐾1 ≤𝐾2
and draw the payoff and profit diagrams of a bull call spread.
Discuss under what conditions an investor should invest in such a hedging strategy.
Solution: We first assume 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) and we set up a portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾1) −𝐶(𝑆𝑇, 𝑇; 𝐾2)
= max{𝑆𝑇−𝐾1, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾2
≥0
which constitutes an arbitrage opportunity. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇),
𝐾1 ≤𝐾2.
At time 𝑇the payoff of this hedging strategy is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝑆𝑇−𝐾1, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾2
and the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝑆𝑇> 𝐾2
where the break-even point is 𝑆𝑇= 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) so that
Υ(𝑆𝑇) = 0.
Figure 1.18 shows the payoff and profit diagrams of a bull call spread.
Based on the payoff and profit diagrams of a bull call spread, this hedging strat-
egy would appeal to investors who have a bullish sentiment that the stock price

1.2.3 Hedging Strategies
35
Payoﬀ/Proﬁt
2 −
1
2 −
1 +
(
;
2
) −
(
;
1
)
1
Payoﬀ
Proﬁt
2
(
;
2
) −
(
;
1
)
Figure 1.18
Construction of a bull call spread.
will increase in value relative to the strike prices 𝐾1 and 𝐾2. Hence, if 𝑆𝑇> 𝐾1 +
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a profit but capped at
a maximum gain of 𝐾2 −𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) > 0. However, if 𝑆𝑇<
𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a loss but limited to
the difference between premiums received and paid.
8. Bull Put Spread. A bull put spread is an investment strategy constructed by buying
a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and simultaneously selling a put option
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike 𝐾2, 𝐾1 ≤𝐾2 on the same underlying asset 𝑆𝑡and having the
same expiry time 𝑇(𝑇> 𝑡).
Show that
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇),
𝐾1 ≤𝐾2
and draw the payoff and profit diagrams of a bull put spread.
Discuss under what conditions an investor should invest in such an investment strategy.
Solution: We first assume 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and we set up a portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= max{𝐾2 −𝑆𝑇, 0} −max{𝐾1 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇≤𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
0
if 𝑆𝑇> 𝐾2
≥0
which constitutes an arbitrage opportunity. Therefore, 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇),
𝐾1 ≤𝐾2.

36
1.2.3 Hedging Strategies
At time 𝑇the payoff of this hedging strategy is
Ψ(𝑆𝑇) = 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝐾1 −𝑆𝑇, 0} −max{𝐾2 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 −𝐾2
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾2
if 𝐾1 < 𝑆𝑇≤𝐾2
0
if 𝑆𝑇> 𝐾2
and the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 −𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
if 𝑆𝑇> 𝐾2
where the break-even point is 𝑆𝑇= 𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) so that
Υ(𝑆𝑇) = 0.
Figure 1.19 shows the payoff and profit diagrams of a bull put spread.
Payoﬀ/Proﬁt
1 −
2
(
;
2
) −
(
;
1
)
1
Payoﬀ
Proﬁt
2
1 −
2 +
(
;
2
) −
(
;
1
)
Figure 1.19
Construction of a bull put spread.
Based on the payoff and profit diagrams of a bull put spread, this hedging strategy
would appeal to investors who have a bullish sentiment that the stock price will increase
in value relative to the strike prices 𝐾1 and 𝐾2. Hence, if 𝑆𝑇> 𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a profit but capped at a maximum gain
based on the difference between the put premiums received and paid. However, if 𝑆𝑇<
𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a loss but limited to a
maximum loss of 𝐾1 −𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.

1.2.3 Hedging Strategies
37
9. Bear Call Spread. A bear call spread is a hedging position designed to sell a call option
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and simultaneously buy a call option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with
strike 𝐾2, 𝐾1 ≤𝐾2 on the same underlying asset 𝑆𝑡and having the same expiry time 𝑇
(𝑇> 𝑡).
Show that
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇),
𝐾1 ≤𝐾2
and draw the payoff and profit diagrams of a bear call spread.
Discuss under what conditions an investor should invest in such a hedging strategy.
Solution: To show that 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) for 𝐾1 ≤𝐾2 see Problem 1.2.3.7
(page 34).
At time 𝑇the payoff of this hedging strategy is
Ψ(𝑆𝑇) = −𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= −max{𝑆𝑇−𝐾1, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝐾1 −𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾1 −𝐾2
if 𝑆𝑇> 𝐾2
and the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇≤𝐾1
𝐾1 −𝑆𝑇+ 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾1 −𝐾2 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇> 𝐾2
where the break-even point is 𝑆𝑇= 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) so that
Υ(𝑆𝑇) = 0.
Figure 1.20 is the payoff and profit diagrams of a bear call spread.
Based on the payoff and profit diagrams of a bear call spread, this hedging strategy
would appeal to investors who have a bearish attitude that the stock price will decrease
in value relative to the strike prices 𝐾1 and 𝐾2. Hence, if 𝑆𝑇< 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a profit but capped at a maximum gain based
on the difference between the call premiums received and paid. On the other hand, if 𝑆𝑇>
𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a loss but limited to a
maximum loss of 𝐾1 −𝐾2 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
10. Bear Put Spread. A bear put spread is an investment strategy constructed by selling
a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and simultaneously buying a put option
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike 𝐾2, 𝐾1 ≤𝐾2 on the same underlying asset 𝑆𝑡and having the
same expiry time 𝑇(𝑇> 𝑡).

38
1.2.3 Hedging Strategies
Payoﬀ/Proﬁt
1 −
2
1 −
2 +
(
;
1
) −
(
;
2
)
1
Payoﬀ
Proﬁt
2
(
;
1
) −
(
;
2
)
Figure 1.20
Construction of a bear call spread.
Show that
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇),
𝐾1 ≤𝐾2
and draw the payoff and profit diagrams of a bear put spread.
Discuss under what conditions an investor should invest in such an investment strategy.
Solution: To show that 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) for 𝐾1 ≤𝐾2 see Problem 1.2.3.8
(page 36).
At time 𝑇the payoff of this hedging strategy is
Ψ(𝑆𝑇) = −𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= −max{𝐾1 −𝑆𝑇, 0} + max{𝐾2 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇≤𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
0
if 𝑆𝑇> 𝐾2
and the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇≤𝐾1
𝐾2 −𝑆𝑇+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇> 𝐾2
where the break-even point is 𝑆𝑇= 𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) so that
Υ(𝑆𝑇) = 0.
Figure 1.21 shows the payoff and profit diagrams of a bear put spread.

1.2.3 Hedging Strategies
39
Payoﬀ/Proﬁt
2 −
1
2 −
1 +
(
;
1
) −
(
;
2
)
1
Proﬁt
Payoﬀ
2
(
;
1
) −
(
;
2
)
Figure 1.21
Construction of a bear put spread.
From the payoff and profit diagrams of a bear put spread we can see that this hedg-
ing strategy would appeal to investors who have a bearish attitude that the stock price
will decrease in value relative to the strike prices 𝐾1 and 𝐾2. Hence, if 𝑆𝑇< 𝐾2 +
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a profit but capped at a
maximum gain of 𝐾2 −𝐾1 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇). However, if 𝑆𝑇> 𝐾2 +
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would make a loss but limited to a max-
imum loss of 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
11. Box Spread. A long box spread is an investment strategy constructed by buying a bull
call spread 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) and buying a bear put spread 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strikes 𝐾1 and 𝐾2, 𝐾1 ≤𝐾2 on the same underlying asset 𝑆𝑡and
having the same expiry time 𝑇(𝑇> 𝑡). Let the risk-free interest rate be 𝑟and the stock
pays a continuous dividend 𝐷.
Show that the premium paid to enter into this portfolio strategy is the same as the present
value of the payoff.
Show also that at time 𝑇the profit based on this strategy is independent of the terminal
stock price 𝑆𝑇.
Give a financial interpretation of this investment strategy.
Solution: At initial time 𝑡the portfolio is worth
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
and from the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾1𝑒−𝑟(𝑇−𝑡)
and
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾2𝑒−𝑟(𝑇−𝑡).

40
1.2.3 Hedging Strategies
Therefore,
Π𝑡= (𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡).
At expiry time 𝑇the portfolio is
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
+𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= max{𝑆𝑇−𝐾1, 0} −max{𝐾1 −𝑆𝑇, 0}
−max{𝑆𝑇−𝐾2, 0} + max{𝐾2 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇≤𝐾1
𝐾2 −𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾2
= 𝐾2 −𝐾1.
Thus, at time 𝑡we can discount back the final value of the portfolio to become
Π𝑡= (𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
which is also the price of the premium paid.
The profit of entering such a hedging strategy is therefore
Υ(𝑆𝑇) = Π𝑇−Π𝑡
= (𝐾2 −𝐾1)(1 −𝑒−𝑟(𝑇−𝑡))
> 0
which guarantees a positive cash flow irrespective of the terminal stock price value 𝑆𝑇.
Thus, the box spread is clearly an arbitrage opportunity provided the transaction cost is
low.
12. At current time 𝑡= 0 a stock is trading at $20 and for a risk-free interest rate of 4% per
annum the prices of 6-month European options are given in Table 1.4.
Table 1.4
European option prices for different strikes.
Strike Price
European Call
European Put
$20
$1.98
$1.58
$27
$1.21
$7.68
Determine the payoff, premium paid and profit at the expiry time for a box spread con-
structed by buying a 20-strike European call, selling a 27-strike European call, selling a
20-strike European put and buying a 27-strike European put.

1.2.3 Hedging Strategies
41
Solution: By setting 𝑆0 = $20, 𝐾1 = $20, 𝐾2 = $27, 𝑟= 0.04 and 𝑇= 6
12 = 0.5 years,
from Problem 1.2.3.11 (page 40) the payoff of a box spread is
Ψ(𝑆𝑇) = 𝐾2 −𝐾1 = $27 −$20 = $7.
The premium paid is therefore
Ψ(𝑆0) = (𝐾2 −𝐾1)𝑒−𝑟𝑇= $7𝑒−0.04×0.5 = $6.86
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Ψ(𝑆0) = $7 −$6.86 = $0.14.
13. Purchased Collar. A purchased collar is a hedging strategy whereby at time 𝑡an investor
buys an asset 𝑆𝑡, buys a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike price 𝐾1 and sells a call option
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike price 𝐾2, 𝐾1 < 𝐾2 on the same underlying 𝑆𝑡and having the
same expiry time 𝑇(𝑇> 𝑡).
Show that in order to prevent any arbitrage opportunity
𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
Draw the profit diagram and give a financial interpretation of this hedging strategy.
Solution: We assume at time 𝑡that 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0 and we set
up a portfolio
Ψ(𝑆𝑡) = 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Ψ(𝑆𝑇) = 𝑆𝑇+ 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= 𝑆𝑇+ max{𝐾1 −𝑆𝑇, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1
if 𝑆𝑇≤𝐾1
𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2
if 𝑆𝑇> 𝐾2
≥0
which is an arbitrage opportunity. Hence, 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
Given that the investor has paid for both the stock 𝑆𝑡and the put premium 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
and simultaneously received 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇), the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡

42
1.2.3 Hedging Strategies
where Ψ(𝑆𝑇) = 𝑆𝑇+ 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇) is the payoff of the purchased
collar contract. Thus,
Υ(𝑆𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡
if 𝑆𝑇≤𝐾1
𝑆𝑇+ 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡
if 𝑆𝑇> 𝐾2
with break even at 𝑆𝑇= 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
Figure 1.22 shows the payoff and profit diagrams of a purchased collar.
Payoﬀ/Payoﬀ
1 +
(
;
2
) −
(
;
1
) −
1
2
2 +
(
;
2
) −
(
;
1
) −
1
2
Payoﬀ
Proﬁt
Figure 1.22
Construction of a purchased collar.
From the combination of options and asset we can see that the purchased collar is a
hedging strategy consisting of buying a protective put and selling a call option. By buying
a protective put the investor is able to insure the asset, whilst selling a call reduces the
cost of insurance. Therefore, this position would be beneficial when the asset price 𝑆𝑇>
𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (up to a maximum gain of 𝐾2 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡) but if 𝑆𝑇< 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor
would lose money (up to a maximum loss of 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡).
14. Written Collar. A written collar is an investment strategy whereby at time 𝑡an investor
would sell an asset 𝑆𝑡, sell a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike price 𝐾1 and buy a call
option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike price 𝐾2, 𝐾1 < 𝐾2 on the same underlying 𝑆𝑡and having
the same expiry time 𝑇> 𝑡.
Show that in order to prevent any arbitrage opportunity
𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
Draw the payoff and profit diagrams and give a financial interpretation of this hedging
strategy.

1.2.3 Hedging Strategies
43
Solution: To show that at time 𝑡, 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0 see Problem
1.2.3.13 (page 42).
At expiry time 𝑇the payoff is
Ψ(𝑆𝑇) = −𝑆𝑇−𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= −𝑆𝑇−max{𝐾1 −𝑆𝑇, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
−𝐾1
if 𝑆𝑇≤𝐾1
−𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
−𝐾2
if 𝑆𝑇> 𝐾2
while the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
−𝐾1 + 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇≤𝐾1
−𝑆𝑇+ 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
−𝐾2 + 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇> 𝐾2
with break even at 𝑆𝑇= 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
Figure 1.23 shows the payoff and profit diagrams of a written collar.
Payoﬀ/Payoﬀ
−
1 +
+
(
;
1
) −
(
;
2
)
1
2
−
2 +
+
(
;
1
) −
(
;
2
)
−
1
−
2
Payoﬀ
Proﬁt
Figure 1.23
Construction of a written collar.
Given the combination of options and asset we can see that the written collar is a hedg-
ing strategy consisting of buying a protective call and selling a put option. By buying
a protective call the investor is able to insure the short sale of the asset, whilst sell-
ing a put reduces the cost of insurance. Hence, this position would be beneficial when
the asset price declines 𝑆𝑇< 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (up to a maximum

44
1.2.3 Hedging Strategies
gain of −𝐾2 + 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2)) but if 𝑆𝑇> 𝑆𝑡+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) then the investor would lose money (up to a maximum loss of −𝐾1 + 𝑆𝑡+
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)).
15. Long Straddle. A long straddle is an investment strategy whereby at time 𝑡an investor
would buy a call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and buy a put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same
strike 𝐾using the same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: We consider at time 𝑡that there is a stock worth 𝑆𝑡and for a strike price 𝐾the
investor buys a call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same stock
𝑆𝑡with expiry time 𝑇.
The payoff at time 𝑇is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} + max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑇
if 𝑆𝑇≤𝐾
𝑆𝑇−𝐾
if 𝑆𝑇> 𝐾
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑇−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
𝑆𝑇−𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with break even at the profit level occurring at 𝑆𝑇= 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
(provided 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾) and 𝑆𝑇= 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡;
𝐾, 𝑇).
Figure 1.24 shows the payoff and profit diagrams of a long straddle.
From the profit diagram we can see that the investor would make an unlimited profit if
𝑆𝑇> 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) or a limited profit if 𝑆𝑇< 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇). In contrast, the maximum loss for the investor is the cost of purchasing the
option. Hence, this strategy is dependent on how high the volatility of the stock is rather
than the direction of the stock price. In short, the profit at expiry time relies on how much
the stock price moves instead of whether it is increasing or decreasing in value.
16. Short Straddle. A short straddle is an investment strategy where at time 𝑡an investor would
sell a call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and sell a put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same strike 𝐾
using the same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).

1.2.3 Hedging Strategies
45
Payoﬀ/Payoﬀ
−(
;
) −
(
;
)
−
(
;
) −
(
;
)
Payoﬀ
Proﬁt
Figure 1.24
Construction of a long straddle.
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: We consider at time 𝑡that there is a stock worth 𝑆𝑡and for a strike price 𝐾the
writer sells a call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) on the same stock
𝑆𝑡with expiry time 𝑇.
The payoff at time 𝑇is
Ψ(𝑆𝑇) = −𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= −max{𝑆𝑇−𝐾, 0} −max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇≤𝐾
𝐾−𝑆𝑇
if 𝑆𝑇> 𝐾
and the profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
𝐾−𝑆𝑇+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with break even at the profit level occurring either at 𝑆𝑇= 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
(provided
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾)
or
𝑆𝑇= 𝐾+ 𝐶(𝑆𝑡, 𝑡;
𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Figure 1.25 illustrates the payoff and profit diagrams of a short straddle.
From the profit diagram we can see that the writer would make an unlimited loss if
𝑆𝑇> 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) or a limited loss if 𝑆𝑇< 𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇). In contrast, the maximum gain for the writer is only the options premium
received. Thus, unlike the long straddle, the short straddle depends very much on low

46
1.2.3 Hedging Strategies
Payoﬀ/Payoﬀ
−
+
(
;
) +
(
;
)
(
;
) +
(
;
)
−
Payoﬀ
Proﬁt
Figure 1.25
Construction of a short straddle.
volatility and is most profitable if 𝑆𝑇= 𝐾. Hence, this strategy is dependent on the volatil-
ity of the stock rather than the direction of the stock price, and the writer who sells this
portfolio of options would bet on the low volatility of the stock price.
17. Consider an investor buying a 35-strike call option and a 25-strike put option on a stock for
prices of $0.69 and $0.52, respectively. Both of the options have the same expiry time of
6 months from now. Given that the current price of a stock is $28 and the risk-free interest
rate is 𝑟= 3% per annum, what is the position of this investment strategy? Find the profit
and determine the break-even price of this hedging position at expiry time.
Solution: Let 𝑆0 = $28, 𝐾1 = $25, 𝐾2 = $35, 𝑇= 6
12 = 1
2 years and we can write the
portfolio at time 𝑡= 0 as
Π0 = 𝑃(𝑆0, 0; 𝐾1, 𝑇) + 𝐶(𝑆0, 0; 𝐾2, 𝑇)
where 𝑃(𝑆0, 0; 𝐾1, 𝑇) = $0.52 is the put option price with strike 𝐾1 = $25 and
𝐶(𝑆0, 0; 𝐾2, 𝑇) = $0.69 is the call option price with strike price 𝐾2 = $35.
Since 𝐾1 < 𝐾2 and the options have the same expiry time on the same underlying asset
price, the position is a long straddle.
At expiry time 𝑇the payoff is
Ψ(𝑆𝑇) = 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝐾1 −𝑆𝑇, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 −𝑆𝑇
if 𝑆𝑇≤𝐾1
𝐾1 −𝐾2
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑆𝑇−𝐾2
if 𝑆𝑇> 𝐾2.

1.2.3 Hedging Strategies
47
Given the total cost of the premium paid is 𝑃(𝑆0, 0; 𝐾1, 𝑇) + 𝐶(𝑆0, 0; 𝐾2, 𝑇) = $0.52 +
$0.69 = $1.21, the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −$1.21
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
$25 −𝑆𝑇−$1.21
if 𝑆𝑇≤𝐾1
$25 −$35 −$1.21
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑆𝑇−$35 −$1.21
if 𝑆𝑇> 𝐾2
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
$23.79 −𝑆𝑇
if 𝑆𝑇≤𝐾1
−$11.21
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑆𝑇−$36.21
if 𝑆𝑇> 𝐾2
with break-even points occurring at 𝑆𝑇= $23.79 and 𝑆𝑇= $36.21.
18. Long Strangle. A long strangle is a hedging technique where at time 𝑡an investor would
buy a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and buy a call option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with
strike 𝐾2, 𝐾1 < 𝐾2 on the same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: At expiry time 𝑇the payoff of a long strangle portfolio is
Ψ(𝑆𝑇) = 𝑃(𝑆𝑇; 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇; 𝑇; 𝐾2, 𝑇)
= max{𝐾1 −𝑆𝑇, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 −𝑆𝑇
if 𝑆𝑇≤𝐾1
0
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑆𝑇−𝐾2
if 𝑆𝑇> 𝐾2.
Given that the investor paid for the call and put premiums at time 𝑡, the profit at expiry
time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾1 −𝑆𝑇−𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇≤𝐾1
−𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝑆𝑇−𝐾2 −𝑃(𝑆𝑡, 𝑡; 𝐾1) −𝐶(𝑆𝑡, 𝑡; 𝐾2)
if 𝑆𝑇> 𝐾2

48
1.2.3 Hedging Strategies
with break even occurring at 𝑆𝑇= 𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (provided
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾1) and 𝑆𝑇= 𝐾2 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇).
Figure 1.26 shows the payoff and profit diagrams of a long strangle.
Payoﬀ/Payoﬀ
−(
;
1
) −
(
;
2
)
1
1 −
(
;
1
) −
(
;
2
)
1
Payoﬀ
Proﬁt
2
Figure 1.26
Construction of a long strangle.
Like the long straddle, the long strangle also exploits the volatility of the stock price
where the profit is based on how much the price of the stock moves instead of its direction.
Here the investor makes a positive gain at the expiry time 𝑇if 𝑆𝑇> 𝐾2 + 𝑃(𝑆𝑡; 𝑡; 𝐾1, 𝑇) +
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (unlimited gain) and if 𝑆𝑇< 𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (gain
limited to 𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)). As for the downward risk, this strategy
has a limited risk which is only the cost of the premiums paid and there is a range between
the strikes in which the loss is unaffected by the change in stock price. Hence, this strategy
is more suitable for high-volatility stocks.
19. Short Strangle. A short strangle is a hedging technique where at time 𝑡a writer would sell
a put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1 and sell a call option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike
𝐾2, 𝐾1 < 𝐾2 on the same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: At expiry time 𝑇the payoff of a short strangle portfolio is
Ψ(𝑆𝑇) = −𝑃(𝑆𝑇; 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇; 𝑇; 𝐾2, 𝑇)
= −max{𝐾1 −𝑆𝑇, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑆𝑇−𝐾1
if 𝑆𝑇≤𝐾1
0
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝑆𝑇
if 𝑆𝑇> 𝐾2.

1.2.3 Hedging Strategies
49
Given that the investor received the call and put premiums at time 𝑡, the profit at expiry
time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑆𝑇−𝐾1 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇≤𝐾1
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝑆𝑇+ 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
if 𝑆𝑇> 𝐾2
with break even occurring at 𝑆𝑇= 𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) (provided
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾1) and 𝑆𝑇= 𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
Figure 1.27 shows the payoff and profit diagrams of a short strangle.
Payoﬀ/Payoﬀ
−
1 +
(
;
1
) +
(
;
2
)
1
(
;
1
) +
(
;
2
)
−
1
Payoﬀ
Proﬁt
2
Figure 1.27
Construction of a short strangle.
Like the short straddle, the short strangle also exploits the low volatility of the stock
price where the maximum profit is attained from the premiums received. But unlike
the short straddle, this contract has a range between the strikes in which the gain is
a constant value and unaffected by the change in strike price 𝑆𝑇. In contrast, by tak-
ing a short position of a strangle, the writer is exposed to a limited loss if 𝑆𝑇< 𝐾1 −
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) and an unlimited loss if 𝑆𝑇> 𝐾2 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) +
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇). Hence, this strategy is more suitable for low-volatility stocks.
20. Long Strip. A long strip is an investment strategy where at time 𝑡an investor would buy a
call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and buy two put options 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾on the same
stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.

50
1.2.3 Hedging Strategies
Solution: At expiry time 𝑇the payoff of this portfolio of options is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) + 2𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} + 2 max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
2(𝐾−𝑆𝑇)
if 𝑆𝑇≤𝐾
𝑆𝑇−𝐾
if 𝑆𝑇> 𝐾.
Given that the investor paid for the options premiums, the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
2(𝐾−𝑆𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
𝑆𝑇−𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with
break
even
at
𝑆𝑇= 𝐾−1
2
(𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇))
(provided
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤2𝐾) and 𝑆𝑇= 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Figure 1.28 shows the payoff and profit diagrams of a long strip.
Payoﬀ/Payoﬀ
−(
;
) −2 (
;
)
2
−
(
;
) −2 (
;
)
2
Payoﬀ
Proﬁt
Figure 1.28
Construction of a long strip.
From the profit diagram we can see that the investor would make an unlimited profit if
𝑆𝑇> 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
or a limited profit if
𝑆𝑇< 𝐾−1
2(𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)).

1.2.3 Hedging Strategies
51
In contrast, the maximum loss for the investor is the cost of purchasing the options. Hence,
like the long straddle, this strategy is also dependent on how high the volatility of the stock
is rather than the direction of the stock price. However, the only difference between a long
straddle and a long strip is that in the latter the strategy exploits more the fall in the stock
price as the profit is much higher.
21. Short Strip. A short strip is an investment strategy where at time 𝑡an investor would sell a
call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and sell two put options 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾on the same
stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: At expiry time 𝑇the payoff of this portfolio of options is
Ψ(𝑆𝑇) = −𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −2𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= −max{𝑆𝑇−𝐾, 0} −2 max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
2(𝑆𝑇−𝐾)
if 𝑆𝑇≤𝐾
𝐾−𝑆𝑇
if 𝑆𝑇> 𝐾.
Given that the writer received the options premium, the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
2(𝑆𝑇−𝐾) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
𝐾−𝑆𝑇+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with break even at 𝑆𝑇= 𝐾−1
2
(𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)) (provided 𝐶(𝑆𝑡, 𝑡;
𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤2𝐾) and 𝑆𝑇= 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Figure 1.29 illustrates the payoff and profit diagrams of a short strip.
From the profit diagram we can see that the writer would make an unlimited loss if
𝑆𝑇> 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
or a limited loss if
𝑆𝑇< 𝐾−1
2(𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)).
In contrast, the maximum gain is the premium received from the options. Hence, like the
short straddle, this strategy is also dependent on how high the volatility of the stock is
rather than the direction of the stock price. Here the writer bets that the stock price will
remain stagnant but incurs a smaller loss if the stock price rises in value.

52
1.2.3 Hedging Strategies
Payoﬀ/Payoﬀ
(
;
) + 2 (
;
)
−2
+
(
;
) + 2 (
;
)
−2
Payoﬀ
Proﬁt
Figure 1.29
Construction of a short strip.
22. Long Strap. A long strap is a hedging technique where at time 𝑡an investor buys two call
options 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and one put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾on the same stock
𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: At expiry time 𝑇the payoff of this portfolio of options is
Ψ(𝑆𝑇) = 2𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 2 max{𝑆𝑇−𝐾, 0} + max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑇
if 𝑆𝑇≤𝐾
2(𝑆𝑇−𝐾)
if 𝑆𝑇> 𝐾.
Given that the investor paid for an options premium, the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑇−2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
2(𝑆𝑇−𝐾) −2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with break even at 𝑆𝑇= 𝐾−2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) (provided 2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾) and 𝑆𝑇= 𝐾+ 1
2
(2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)).
Figure 1.30 shows the payoff and profit diagrams of a long strap.

1.2.3 Hedging Strategies
53
Payoﬀ/Payoﬀ
−2 (
;
) −
(
;
)
−2 (
;
) −
(
;
)
Payoﬀ
Proﬁt
Figure 1.30
Construction of a long strap.
From the profit diagram we can see that the investor would make an unlimited profit if
𝑆𝑇> 𝐾+ 1
2(2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇))
or a limited profit if
𝑆𝑇< 𝐾−2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
whilst the maximum loss for the investor is the cost of purchasing the options. Thus, like
the long straddle, this strategy is also dependent on how high the volatility of the stock is
rather than the direction of the stock price. However, the only difference between a long
straddle and a long strap is that in the latter the strategy exploits more the rise in the stock
price as the profit is much higher.
23. Short Strap. A short strap is a hedging technique where at time 𝑡a writer sells two call
options 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and one put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾on the same stock
𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy and give a financial
interpretation based on this combination of options portfolio.
Solution: At expiry time 𝑇the payoff of this portfolio of options is
Ψ(𝑆𝑇) = −2𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= −2 max{𝑆𝑇−𝐾, 0} −max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇≤𝐾
2(𝐾−𝑆𝑇)
if 𝑆𝑇> 𝐾.

54
1.2.3 Hedging Strategies
Given that the writer received the options premium, the profit at expiry time 𝑇is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) + 2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾+ 2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇≤𝐾
2(𝐾−𝑆𝑇) + 2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑇> 𝐾
with break even at 𝑆𝑇= 𝐾−2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) (provided 2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾) and 𝑆𝑇= 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Figure 1.31 shows the payoff and profit diagrams of a short strap.
Payoﬀ/Payoﬀ
2 (
;
) +
(
;
)
−
+ 2 (
;
) +
(
;
)
−
Payoﬀ
Proﬁt
Figure 1.31
Construction of a short strap.
Based on the profit diagram we can see that the writer would make an unlimited loss if
𝑆𝑇> 𝐾+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
or a limited loss if
𝑆𝑇< 𝐾−2𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
In contrast, the maximum gain is the premium received from the options. Hence, like the
short straddle, this strategy is also dependent on how high the volatility of the stock is
rather than the direction of the stock price. Here, the writer bets that the stock is price will
remain stagnant but incurs a smaller loss if the stock price falls in value.
24. Butterfly Spread (Using Call Options). A butterfly spread is a hedging technique that,
at time 𝑡and for strikes 𝐾1 < 𝐾2 < 𝐾3, is constructed by buying one call option
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇), buying one call option 𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) and selling two call options
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) on the same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this hedging strategy with 𝐾2 = 1
2(𝐾1 + 𝐾3).

1.2.3 Hedging Strategies
55
Solution: At expiry time 𝑇the payoff of a butterfly spread is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾3, 𝑇) −2𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝑆𝑇−𝐾1, 0} + max{𝑆𝑇−𝐾3, 0} −2 max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
2𝐾2 −𝐾1 −𝑆𝑇
if 𝐾2 < 𝑆𝑇≤𝐾3
2𝐾2 −𝐾1 −𝐾3
if 𝑆𝑇> 𝐾3
and by setting Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) the corresponding
profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Π𝑡.
Hence, provided
−𝐾1 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤2𝐾2 −1
then break even occurs at
𝑆𝑇= 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
and
𝑆𝑇= 2𝐾2 −𝐾1 −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 2𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
Figure 1.32 shows the payoff and profit diagrams of a butterfly spread using call options
with 𝐾2 = 1
2(𝐾1 + 𝐾3).
Payoﬀ/Payoﬀ
1
2 −
1
Payoﬀ
Proﬁt
2
3
2 −
1 −Π
Figure 1.32
Construction of a butterfly spread with 𝐾2 = 1
2(𝐾1 + 𝐾3) and Π𝑡the net premium paid.

56
1.2.3 Hedging Strategies
25. Butterfly Spread (Using Put Options). A butterfly spread is a hedging technique that, at time
𝑡and for strikes 𝐾1 < 𝐾2 < 𝐾3, is constructed by buying one put option 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇),
buying one put option 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) and selling two put options 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) on the
same stock 𝑆𝑡and having the same expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this hedging strategy with 𝐾2 = 1
2(𝐾1 + 𝐾3).
Solution: At expiry time 𝑇the payoff of a butterfly spread is
Ψ(𝑆𝑇) = 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾3, 𝑇) −2𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝐾1 −𝑆𝑇, 0} + max{𝐾3 −𝑆𝑇, 0} −2 max{𝐾2 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
𝐾1 + 𝐾3 −2𝐾2
if 𝑆𝑇≤𝐾1
𝑆𝑇+ 𝐾3 −2𝐾2
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾3 −𝑆𝑇
if 𝐾2 < 𝑆𝑇≤𝐾3
0
if 𝑆𝑇> 𝐾3
and by setting Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) the corresponding
profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Π𝑡.
Hence, provided
𝐾3 −2𝐾2 ≤𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾3
then break even occurs at
𝑆𝑇= 2𝐾2 −𝐾3 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −2𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
and
𝑆𝑇= 𝐾3 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
Figure 1.33 shows the payoff and profit diagrams of a butterfly spread using put options
with 𝐾2 = 1
2(𝐾1 + 𝐾3).
26. Butterfly Spread (Using Straddle and Strangle). A butterfly spread is a hedging technique
that, at time 𝑡and for strikes 𝐾1 < 𝐾2 < 𝐾3, is constructed by selling a straddle:
s sell a call option 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike 𝐾2
s sell a put option 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) with strike 𝐾2
and buying a strangle:
s buy a call option 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) with strike 𝐾1
s buy a put option 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) with strike 𝐾3
on the same stock 𝑆𝑡and having the same option expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this investment strategy with 𝐾2 = 1
2(𝐾1 + 𝐾3).

1.2.3 Hedging Strategies
57
Payoﬀ/Payoﬀ
1
3 −
2
Payoﬀ
Proﬁt
2
3
3 −
2 −Π
Figure 1.33
Construction of a butterfly spread with 𝐾2 = 1
2(𝐾1 + 𝐾3) and Π𝑡the net premium paid.
Solution: At expiry time 𝑇the payoff of a butterfly spread is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾3, 𝑇)
−𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝑆𝑇−𝐾1, 0} + max{𝐾3 −𝑆𝑇, 0}
−max{𝑆𝑇−𝐾2, 0} −max{𝐾2 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
𝐾3 −𝐾1
if 𝑆𝑇≤𝐾1
𝑆𝑇+ 𝐾3 −𝐾1 −𝐾2
if 𝐾1 < 𝑆𝑇≤𝐾2
−𝑆𝑇+ 𝐾2 + 𝐾3 −𝐾1
if 𝐾2 < 𝑆𝑇≤𝐾3
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾3
and by setting Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Π𝑡.
Hence, provided
−𝐾1 −𝐾2 + 𝐾3 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇)
−𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤−𝐾1 + 𝐾2 + 𝐾3
break even occurs at
𝑆𝑇= 𝐾2 + 𝐾3 −𝐾1 −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇)
+ 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)

58
1.2.3 Hedging Strategies
and
𝑆𝑇= 𝐾1 + 𝐾2 −𝐾3 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇)
−𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
Figure 1.34 shows the payoff and profit diagrams of a butterfly spread with 𝐾2 =
1
2(𝐾1 + 𝐾3).
Payoﬀ/Payoﬀ
1
3 −
1
Payoﬀ
Proﬁt
2
3
2 −
1
2 −
1 −Π
Figure 1.34
Construction of a butterfly spread with 𝐾2 = 1
2(𝐾1 + 𝐾3) and Π𝑡the net premium paid.
27. What is the financial motivation for an investor to enter into a butterfly spread contract?
Solution: Given three strike prices 𝐾1 < 𝐾2 < 𝐾3, a butterfly spread can be constructed
with a combination of call options, put options or by combining a straddle and a strangle.
At expiry time 𝑇for 0 < 𝑆min
𝑇
< 𝑆max
𝑇
such that the profit of a butterfly spread
Υ(𝑆min
𝑇
) = 0 and Υ(𝑆max
𝑇
) = 0 then the investor would make a limited loss if the stock
price 𝑆𝑇> 𝑆max
𝑇
or 𝑆𝑇< 𝑆min
𝑇
. In contrast, the maximum gain for the investor occurs
when 𝑆𝑇= 𝐾2.
Thus, the investor buying a butterfly spread would speculate that the stock price at expiry
time 𝑇will be between 𝐾1 and 𝐾3 in which the strategy will be most profitable. In essence,
by exploiting simultaneously both the low and high volatilities of the stock price based on
the combination of options, the investor purchasing a butterfly spread would bet that the
stock price will stay close to 𝐾2.
28. Condor Spread (Using Call Options). A condor spread is a hedging technique that,
at time 𝑡and for strikes 𝐾1 < 𝐾2 < 𝐾3 < 𝐾4, is constructed by buying one call
option 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇), buying one call option 𝐶(𝑆𝑡, 𝑡; 𝐾4, 𝑇), selling one call option
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) and selling one call option 𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) on the same stock 𝑆𝑡and having
the same option expiry time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this hedging strategy with 𝐾2 −𝐾1 = 𝐾4 −𝐾3.

1.2.3 Hedging Strategies
59
Solution: Based on the construction of the options, the payoff at expiry time 𝑇is
Ψ(𝑆𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
−𝐶(𝑆𝑇, 𝑇; 𝐾3, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾4, 𝑇)
= max{𝑆𝑇−𝐾1, 0} −max{𝑆𝑇−𝐾2, 0}
−max{𝑆𝑇−𝐾3, 0} + max{𝑆𝑇−𝐾4, 0}
=
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝐾2 < 𝑆𝑇≤𝐾3
𝐾2 −𝐾1 + 𝐾3 −𝑆𝑇
if 𝐾3 < 𝑆𝑇≤𝐾4
𝐾2 −𝐾1 + 𝐾3 −𝐾4
if 𝑆𝑇> 𝐾4
and by setting Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾4, 𝑇)
the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Π𝑡.
Hence, provided
−𝐾1 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
−𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾4, 𝑇) ≤−𝐾1 + 𝐾2 + 𝐾3
then break even occurs at
𝑆𝑇= 𝐾1 + 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾4, 𝑇)
and
𝑆𝑇= 𝐾2 −𝐾1 + 𝐾3 −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
+𝐶(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾4, 𝑇).
Figure 1.35 shows the payoff and profit diagrams of a condor spread using call options
with 𝐾2 −𝐾1 = 𝐾4 −𝐾3.
29. Condor Spread (Using Put Options). A condor spread is a hedging technique that, at
time 𝑡and for strikes 𝐾1 < 𝐾2 < 𝐾3 < 𝐾4, is constructed by buying one put option
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇), buying one put option 𝑃(𝑆𝑡, 𝑡; 𝐾4, 𝑇), selling one put option 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
and selling one put option 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) on the same stock 𝑆𝑡and having the same expiry
time 𝑇(𝑡< 𝑇).
Draw the payoff and profit diagrams of this hedging strategy with 𝐾2 −𝐾1 = 𝐾4 −𝐾3.

60
1.2.3 Hedging Strategies
Payoﬀ/Payoﬀ
1
2 −
1
Payoﬀ
Proﬁt
2
3
2 −
1 −Π
4
Figure 1.35
Construction of a condor spread with 𝐾2 −𝐾1 = 𝐾4 −𝐾3 and Π𝑡the net premium paid.
Solution: Based on the construction of the put options, the payoff at expiry time 𝑇is
Ψ(𝑆𝑇) = 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
−𝑃(𝑆𝑇, 𝑇; 𝐾3, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾4, 𝑇)
= max{𝐾1 −𝑆𝑇, 0} −max{𝐾2 −𝑆𝑇, 0}
−max{𝐾3 −𝑆𝑇, 0} + max{𝐾4 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
𝐾1 −𝐾2 −𝐾3 + 𝐾4
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾2 −𝐾3 + 𝐾4
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾4 −𝐾3
if 𝐾2 < 𝑆𝑇≤𝐾3
𝐾4 −𝑆𝑇
if 𝐾3 < 𝑆𝑇≤𝐾4
0
if 𝑆𝑇> 𝐾4
and by setting Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾4, 𝑇)
the corresponding profit is
Υ(𝑆𝑇) = Ψ(𝑆𝑇) −Π𝑡.
Hence, provided
−𝐾2 −𝐾3 + 𝐾4 ≤𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
−𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾4, 𝑇) ≤𝐾4

1.2.3 Hedging Strategies
61
then break even occurs at
𝑆𝑇= 𝐾2 + 𝐾3 −𝐾4 + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
−𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾4, 𝑇)
and
𝑆𝑇= 𝐾4 −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾3, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾4, 𝑇).
Figure 1.36 shows the payoff and profit diagrams of a condor spread using put options
with 𝐾2 −𝐾1 = 𝐾4 −𝐾3.
Payoﬀ/Payoﬀ
1
4 −
3
Payoﬀ
Proﬁt
2
3
4 −
3 −Π
4
Figure 1.36
Construction of a condor spread with 𝐾2 −𝐾1 = 𝐾4 −𝐾3 and Π𝑡the net premium paid.
30. Explain the financial motivation for an investor to enter into a condor spread contract.
Solution: Using four different strike prices 𝐾1 < 𝐾2 < 𝐾3 < 𝐾4, a condor spread can be
constructed with a combination of call options or put options.
At expiry time 𝑇for 0 < 𝑆min
𝑇
< 𝑆max
𝑇
such that the profit of a condor spread Υ(𝑆min
𝑇
) =
0 and Υ(𝑆max
𝑇
) = 0 then the investor would make a limited loss if the stock price 𝑆𝑇>
𝑆max
𝑇
or 𝑆𝑇< 𝑆min
𝑇
.
Thus, the investor who invests in a condor spread speculates that the stock price at expiry
time 𝑇will be between 𝐾2 and 𝐾3 in which the strategy will be most profitable. But unlike
a butterfly spread, a condor spread has a much wider profit range at the expense of a higher
premium paid. Thus, this contract is profitable for the investor who has a neutral outlook
on the market.


2
European Options
Options are one of the basic building blocks in finance and European options are the most
common type of equity derivatives. They give the holder of the contract the right but not the
obligation to enter into a future transaction only at the expiry date of the contract. In short,
for buyers of European options, their right of exercise is only at expiration of the contract. As
discussed in Chapter 1, a combination of such options with other products provides a multitude
of trading strategies for hedgers, investors, traders and speculators.
2.1
INTRODUCTION
Central to the pricing of European options are the Black–Scholes (or Black–Scholes–Merton)
formula and the martingale pricing theory. In the Black–Scholes–Merton formulation, there
are two major approaches which arrive at the same partial differentiation equation formula:
s delta hedging strategy
s self-financing trading strategy
Delta Hedging Strategy
In 1973, Fischer Black and Myron Scholes published their paper “The pricing of options and
corporate liabilities” in The Journal of Political Economy with the aim of deriving a theoretical
valuation formula to price European options. The principal idea behind their theory is to hedge
the option by buying/selling the underlying asset in such a way as to eliminate risk. This type
of hedging is called delta hedging. Conceptually, at time 𝑡the hedging portfolio Π𝑡can be
expressed by
Π𝑡= 𝑉−Δ𝑆𝑡
consisting of a long position in the option 𝑉and a Δ number of short positions in the asset 𝑆𝑡.
Before the formula was derived, they made the following assumptions:
s The risk-free interest rate is known and is constant over time.
s The asset price follows a geometric Brownian motion.
s The asset pays no dividends during the life of the option.
s The option is European-style, which can only be exercised at expiry date.
s No transaction costs are associated with buying or selling the asset/option.
s Trading of the asset can take place continuously.
s Short selling is permitted.
Under these assumptions the option value depends only on the price of the asset and time,
and on parameters which are taken to be known constants (i.e, 𝑉= 𝑉(𝑆𝑡, 𝑡)). In addition,

64
2.1 Introduction
over “short” time intervals, the stochastic part of the change in the option price is perfectly
correlated with changes in the stock price, i.e.,
𝑑Π𝑡= 𝑑𝑉−Δ𝑑𝑆𝑡.
By writing the stochastic process of the asset price 𝑆𝑡as a geometric Brownian motion
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift or expected rate of return, 𝜎is a constant volatility and 𝑊𝑡is the standard
Wiener process on the probability space (Ω, ℱ, ℙ), and expanding 𝑉(𝑆𝑡, 𝑡) in a Taylor series
about (𝑆𝑡, 𝑡) and subsequently apply It¯o’s lemma we eventually have
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + …
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝜇𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡.
As a result
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝜇𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
))
𝑑𝑡+ 𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
By choosing the portfolio weight Δ = 𝜕𝑉
𝜕𝑆𝑡
to eliminate all market risk, and from the assump-
tion that the risk-free portfolio must have an expected return equal to the risk-free rate 𝑟,
the governing partial-differential (or Black–Scholes) equation for an option price at time 𝑡,
𝑉(𝑆𝑡, 𝑡) is
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
Note that in the Black–Scholes equation the drift parameter is not present, and this shows that
the value of an option is independent of the rate of change of an underlying asset. The only
parameters that affect the option price are the risk-free interest rate and the volatility of the
asset underlying. As a result of this important argument, we may have a situation whereby two
parties may differ in their estimate of the asset price growth, yet still agree on the price of an
option.
Self-Financing Trading Strategy
In the same year, Robert C. Merton published “Theory of rational option pricing” in The Bell
Journal of Economics and Management Science where an alternative derivation of the Black–
Scholes model is presented via the construction of a self-financing trading strategy.

2.1 Introduction
65
By definition, at time 𝑡∈[0, 𝑇], the trading strategy (𝜙𝑡, 𝜓𝑡) of holding 𝜙𝑡shares of risky
asset 𝑆𝑡and 𝜓𝑡units of risk-free asset 𝐵𝑡having a portfolio value
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
is called self-financing (or a self-financing portfolio) if and only if
𝑑Π𝑡= 𝜙𝑡𝑑𝑆𝑡+ 𝜓𝑡𝑑𝐵𝑡
implying that the change in portfolio value is due to changes in market conditions and not to
either infusion or extraction of funds.
By definition, the contingent claim 𝑉(𝑆𝑇, 𝑇) is said to be attainable if there exists an admis-
sible strategy worth Π𝑇= 𝑉(𝑆𝑇, 𝑇) at the option expiry time 𝑇. Here, the trading strategy (𝜙𝑡,
𝜓𝑡) is admissible if the portfolio Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡is self-financing and if Π𝑡≥−𝛼almost
surely for some 𝛼> 0 (i.e., a finite credit line).
In the absence of arbitrage, at every time 𝑡∈[0, 𝑇], 𝑉(𝑆𝑡, 𝑡) must be equal to the portfolio
value Π𝑡such that
Π𝑡= 𝑉(𝑆𝑡, 𝑡).
Otherwise, an arbitrage opportunity occurs. At time 𝑡∈[0, 𝑇], to replicate the option 𝑉(𝑆𝑡, 𝑡),
we can now form the following self-financing portfolio
𝑉(𝑆𝑡, 𝑡) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡.
Let the risk-free asset price 𝐵𝑡and the risky asset price 𝑆𝑡have the following diffusion process
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
and
𝑑𝑆𝑡= 𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝑟is the risk-free interest rate, 𝜇is the asset drift rate, 𝜎is the asset price volatility which
are all constants and {𝑊𝑡: 0 ≤𝑡≤𝑇} is a standard Wiener process on the probability space
(Ω, ℱ, ℙ).
Applying Taylor series on 𝑑𝑉and using It¯o’s lemma, we eventually have
𝑑𝑉= 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)
𝑑𝑡.
Since the trading strategy (𝜙𝑡, 𝜓𝑡) is self-financing if and only if
𝑑𝑉= 𝜙𝑡𝑑𝑆𝑡+ 𝜓𝑡𝑑𝐵𝑡= 𝜙𝑡𝑑𝑆𝑡+ 𝑟𝐵𝑡𝜓𝑡𝑑𝑡
equating both of the equations we have
𝑟𝐵𝑡𝜓𝑡= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
and
𝜙𝑡= 𝜕𝑉
𝜕𝑆𝑡

66
2.1 Introduction
and substituting the results into
𝑉(𝑆𝑡, 𝑡) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
we have the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
For a constant strike 𝐾> 0, if the terminal payoff at time 𝑇> 𝑡is
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
max{𝑆𝑇−𝐾, 0}
for European call option
max{𝐾−𝑆𝑇, 0}
for European put option
with boundary conditions
𝑉(0, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
0
for European call option
𝐾𝑒−𝑟(𝑇−𝑡)
for European put option
and
lim
𝑆𝑡→∞𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡
for European call option
0
for European put option
then by solving the Black–Scholes equation via the the heat equation, the closed-form solution
for the European call or put option price at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for European call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡Φ(−𝑑+)
for European put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢is the cumulative distribution function (cdf) of a standard
normal.

2.1 Introduction
67
Given that the values of the European call and put options contain the function for the cdf
of a standard normal distribution, we can see that the option prices have a relationship with
the probability density function of the asset 𝑆𝑡which is log normally distributed. From the
Feynman–Kac formula, we can infer that the option price can be interpreted as the discounted
expected value of the payoff at expiry time 𝑇. This leads us to the subject of risk-neutral
valuation of contingent claims via the martingale pricing theory.
Martingale Pricing Theory
As the name suggests, martingale pricing is based on the notion of equivalent martingale mea-
sure and risk-neutral valuation. Without loss of generality, assume we are in the Black–Scholes
world with an economy consisting of a risky asset or stock 𝑆𝑡following a geometric Brownian
motion and a risk-free asset 𝐵𝑡growing at a continuously compounded interest rate 𝑟of the
form
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡,
𝑑𝐵𝑡
𝐵𝑡
= 𝑟𝑑𝑡
where 𝜇is the stock drift, 𝜎is the stock volatility and 𝑊𝑡is a standard Wiener process on the
probability space (Ω, ℱ, ℙ).
Definition 2.1 (Equivalent Martingale Measure) Let (Ω, ℱ, ℙ) be the probability space
satisfying the usual conditions and let ℚbe another probability measure on (Ω, ℱ, ℚ). The
probability measure ℚis said to be an equivalent measure or risk-neutral measure if it satisfies
s ℚ∼ℙ.
s The discounted price process {𝐵−1
𝑡𝑆(𝑖)
𝑡}, 𝑖= 1, 2, … , 𝑚are martingales under ℚ, that is
𝔼ℚ(
𝐵−1
𝑢𝑆(𝑖)
𝑢
||| ℱ𝑡
)
= 𝐵−1
𝑡𝑆(𝑖)
𝑡
for all 0 ≤𝑡≤𝑢≤𝑇.
From the definition of an equivalent martingale measure, we can now state Girsanov’s the-
orem which tells us how to convert from the physical measure ℙto the risk-neutral measure
ℚ.
Theorem 2.2 (Girsanov’s Theorem) Let {𝑊𝑡: 0 ≤𝑡≤𝑇} be a ℙ-standard Wiener process
on the probability space (Ω, ℱ, ℙ) and let ℱ𝑡, 0 ≤𝑡≤𝑇be the associated Wiener process
filtration. Suppose 𝜃𝑡is an adapted process, 0 ≤𝑡≤𝑇and consider
𝑍𝑡= 𝑒−∫𝑡
0 𝜃𝑠𝑑𝑊𝑠−1
2 ∫𝑡
0 𝜃2
𝑠𝑑𝑠.
If
𝔼ℙ(
𝑒
1
2 ∫𝑇
0 𝜃2
𝑡𝑑𝑡)
< ∞

68
2.1 Introduction
then 𝑍𝑡is a positive ℙ-martingale for 0 ≤𝑡≤𝑇. By changing the measure ℙto a measure ℚ
such that
𝔼ℙ
(
𝑑ℚ
𝑑ℙ
||||
ℱ𝑡
)
= 𝑑ℚ
𝑑ℙ
||||ℱ𝑡
= 𝑍𝑡
then ̃
𝑊𝑡= 𝑊𝑡+ ∫
𝑡
0
𝜃𝑢𝑑𝑢is a ℚ-standard Wiener process.
Finally, as far as pricing of contingent claims 𝑉(𝑆𝑇, 𝑇) we can obtain the risk-neutral val-
uation approach given in the following theorem.
Theorem 2.3 Assume that an equivalent martingale measure ℚexists, and let 𝑉(𝑆𝑇, 𝑇) be an
attainable contingent claim generated by an admissible self-financing trading strategy. Under
the filtration ℱ𝑡, the European option price at time 𝑡is given by
𝑉(𝑆𝑡, 𝑡) = 𝐵𝑡𝔼ℚ[
𝐵−1
𝑇𝑉(𝑆𝑇, 𝑇)||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[𝑉(𝑆𝑇, 𝑇)|ℱ𝑡].
Remark 2.4
Consider the stochastic differential equation (SDE)
𝑑𝑋𝑡= 𝜇(𝑋𝑡, 𝑡)𝑑𝑡+ 𝜎(𝑋𝑡, 𝑡)𝑑𝑊𝑡
with 𝔼
[(
∫
𝑡
0
𝜎(𝑋𝑠, 𝑠)2𝑑𝑠
)2]
< ∞, then 𝑋𝑡is a martingale if and only if 𝑋𝑡is driftless (i.e.,
𝜇(𝑋𝑡, 𝑡) = 0).
Since
𝑑
(𝑆𝑡
𝐵𝑡
)
(𝑆𝑡
𝐵𝑡
) = 𝑑𝑆𝑡
𝑆𝑡
−𝑑𝐵𝑡
𝐵𝑡
−𝑑𝑆𝑡
𝑆𝑡
𝑑𝐵𝑡
𝐵𝑡
+
(𝑑𝐵𝑡
𝐵𝑡
)2
= (𝜇−𝑟)𝑑𝑡+ 𝜎𝑑𝑊𝑡
and by writing 𝑑̃
𝑊𝑡= 𝑑𝑊𝑡+ 𝜃𝑑𝑡where 𝜃is a constant and ̃
𝑊𝑡a ℚ-standard Wiener process,
and applying Girsanov’s theorem to 𝑑
(𝑆𝑡
𝐵𝑡
)/ (𝑆𝑡
𝐵𝑡
)
, we obtain
𝑑
(𝑆𝑡
𝐵𝑡
)
(𝑆𝑡
𝐵𝑡
) = (𝜇−𝑟−𝜃𝜎)𝑑𝑡+ 𝜎𝑑̃
𝑊𝑡.
To make 𝑆𝑡∕𝐵𝑡a ℚ-martingale, we set
𝜃= 𝜇−𝑟
𝜎
.

2.1 Introduction
69
Thus, there is a unique 𝜃which makes the discounted asset price process driftless, which is
equivalent to saying that there is a unique change of measure which makes the discounted asset
price a martingale under the risk-neutral measure.
Hence, under the risk-neutral measure ℚ, the asset price follows the diffusion process
𝑑𝑆𝑡
𝑆𝑡
= 𝑟𝑑𝑡+ 𝜎𝑑̃
𝑊𝑡
and solving the SDE for 𝑇> 𝑡and under the filtration ℱ𝑡we have
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡∼
((
𝑟−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
)
.
Thus, the European call option at time 𝑡with strike price 𝐾and expiry time 𝑇> 𝑡is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
(𝑆𝑇−𝐾)1I{𝑆𝑇≥𝐾}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) {
𝔼ℚ[
𝑆𝑇1I{𝑆𝑇≥𝐾}||| ℱ𝑡
]
−𝐾𝔼ℚ[
1I{𝑆𝑇≥𝐾}||| ℱ𝑡
]}
= 𝑒−𝑟(𝑇−𝑡) {
𝔼ℚ[
𝑆𝑇1I{𝑆𝑇≥𝐾}||| ℱ𝑡
]
−𝐾ℚ(𝑆𝑇≥𝐾|| ℱ𝑡
)}
whilst the European put option at time 𝑡with strike price 𝐾and expiry time 𝑇> 𝑡is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝑆𝑇, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
(𝐾−𝑆𝑇)1I{𝑆𝑇≤𝐾}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) {
𝐾𝔼ℚ[
1I{𝑆𝑇≤𝐾}||| ℱ𝑡
]}
−𝔼ℚ[
𝑆𝑇1I{𝑆𝑇≤𝐾}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) {
𝐾ℚ(𝑆𝑇≤𝐾|| ℱ𝑡
) −𝔼ℚ[
𝑆𝑇1I{𝑆𝑇≤𝐾}||| ℱ𝑡
]}
.
Continuous-Time Limit of Binomial Model
The binomial model or lattice approach is an alternative way to describe the evolution of the
stochastic asset price process in discrete time. Following the seminal work of Cox, Ross and
Rubinstein (1979), for each time step Δ𝑡, if the asset price begins at 𝑆𝑡at time 𝑡, then at time
𝑡+ Δ𝑡the asset can either move up to a value 𝑢𝑆𝑡or move down to a value 𝑑𝑆𝑡with risk-
neutral probabilities 𝜋and 1 −𝜋, respectively where 𝑢and 𝑑= 1∕𝑢are fixed constants such
that 0 < 𝑑< 𝑒𝑟Δ𝑡< 𝑢. The condition 𝑑= 1∕𝑢is used to ensure that the lattice is symmetri-
cal and is recombinant. Here, an up movement in the asset price for one node followed by a
down movement in the asset price for the next node generates the same asset price as a down
movement in the first node followed by an up movement in the next node.
Assuming that the asset price follows a geometric Brownian motion under the risk-neutral
measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]

70
2.1 Introduction
and by matching the first and second moments up to 𝑂(Δ𝑡)
𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝜋𝑢𝑆𝑡+ (1 −𝜋)𝑑𝑆𝑡
𝔼ℚ(
𝑆2
𝑡+Δ𝑡
||| 𝑆𝑡
)
= 𝜋𝑢2𝑆2
𝑡+ (1 −𝜋)𝑑2𝑆2
𝑡
we eventually have
𝑢= 𝑒𝜎Δ𝑡,
𝑑= 𝑒−𝜎Δ𝑡
and
𝜋= 𝑒𝑟Δ𝑡−𝑑
𝑢−𝑑.
Once we have built up a lattice of possible asset prices up to the option expiry time 𝑇, 𝑇> 𝑡
we can work backwards to price the option. Under the risk-neutral probability measure ℚ, the
European call option price at any node is given as the discounted expected value using the
move up option and the move down option values multiplied by their respective risk-neutral
probabilities. Thus, the option price corresponding to a node for time 𝑡is calculated as
𝑉(𝑆𝑡, 𝑡) = 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆𝑡, 𝑡+ Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆𝑡, 𝑡+ Δ𝑡)] .
To show that the Black–Scholes equation can be obtained as a limiting case in continuous
time of the binomial model, we first take Taylor expansions of 𝑉(𝑢𝑆𝑡, 𝑡+ Δ𝑡) and 𝑉(𝑑𝑆𝑡, 𝑡+
Δ𝑡) so that
𝑉(𝑢𝑆𝑡, 𝑡+ Δ𝑡) = 𝑉(𝑆𝑡+ (𝑢−1)𝑆𝑡, 𝑡+ Δ𝑡)
= 𝑉(𝑆𝑡, 𝑡) + 𝜕𝑉
𝜕𝑡Δ𝑡+ 𝜕𝑉
𝜕𝑆𝑡
(𝑢−1)𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑢−1)2𝑆2
𝑡
+𝑂((Δ𝑡)2) + 𝑂((𝑢−1)3𝑆3
𝑡
)
and
𝑉(𝑑𝑆𝑡, 𝑡+ Δ𝑡) = 𝑉(𝑆𝑡+ (𝑑−1)𝑆𝑡, 𝑡+ Δ𝑡)
= 𝑉(𝑆𝑡, 𝑡) + 𝜕𝑉
𝜕𝑡Δ𝑡+ 𝜕𝑉
𝜕𝑆𝑡
(𝑑−1)𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑−1)2𝑆2
𝑡
+𝑂((Δ𝑡)2) + 𝑂((𝑑−1)3𝑆3
𝑡
) .
Hence,
𝜋𝑉(𝑢𝑆𝑡, 𝑡+ Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆𝑡, 𝑡+ Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆𝑡, 𝑡) = 0
becomes
𝜕𝑉
𝜕𝑡Δ𝑡+ 1
2
[𝜋(𝑢−1)2 + (1 −𝜋)(𝑑−1)2] 𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ [𝜋(𝑢−1) + (1 −𝜋)(𝑑−1)] 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (1 −𝑒𝑟Δ𝑡) 𝑉(𝑆𝑡, 𝑡) + 𝑂((Δ𝑡)2) + 𝑂((𝑢−1)3𝑆3
𝑡
) + 𝑂((𝑑−1)3𝑆3
𝑡
) = 0.

2.1 Introduction
71
Taking first-order approximations
1 −𝑒𝑟Δ𝑡= −𝑟Δ𝑡+ 𝑂((Δ𝑡)2)
𝜋(𝑢−1) + (1 −𝜋)(𝑑−1) = 𝑟Δ𝑡+ 𝑂((Δ𝑡)2)
𝜋(𝑢−1)2 + (1 −𝜋)(𝑑−1)2 = 𝜎2Δ𝑡+ 𝑂((Δ𝑡)2)
and because
𝑂((𝑢−1)3𝑆3
𝑡
) = 𝑂((Δ𝑡)3), 𝑂((𝑑−1)3𝑆3
𝑡
) = 𝑂((Δ𝑡)3)
and by substituting the above information into the equation and dividing it by Δ𝑡, we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) + 𝑂(Δ𝑡) = 0.
Taking limits Δ𝑡→0, we finally obtain the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
The Greeks
In this section we present the “Greeks”, which are the sensitivities of the option prices with
respect to the variables (i.e., asset price and time) and the parameters used as inputs to the
Black–Scholes formula. The importance of Greeks lies mainly in the construction of portfolio
and dynamic hedging, since the sign and magnitude of the Greeks provide an indication of how
much the option price increases or decreases in value when the variables/parameters change.
Note that the Greek for a written option is opposite in sign to its purchased option counterpart.
Tables 2.1 and 2.2 list the most common Greeks used for risk management.
Table 2.1
Delta and gamma for European options.
Name
Symbol
Definition
Description
Delta
Δ
𝜕𝑉
𝜕𝑆𝑡
s Calculates the rate of change of the theoretical Black–
Scholes formula with respect to asset price.
s Commonly used as a percentage of the total number of
shares in an option contract.
s Delta for a call option is always positive. Thus, an increase
in stock price increases the call option value.
s Delta for a put option is always negative. Thus, an increase
in strike price decreases the put option value.
s Maximum delta value occurs when it is near the strike price.
Gamma
Γ
𝜕2𝑉
𝜕𝑆2
𝑡
s Calculates the rate of change of the delta with respect to the
asset price or second partial derivatives of the option with
respect to the asset price.
s Gamma is identical for call and put options, and is positive.
Thus, both call and put options are convex functions.
s Gamma is maximum when it is near the strike price and
decreases its value when it is away from the strike price.

72
2.1 Introduction
Table 2.2
Vega, rho and theta for European options.
Name
Symbol
Definition
Description
Vega

𝜕𝑉
𝜕𝜎
s Calculates the rate of change of the theoretical Black–
Scholes formula with respect to the asset price volatility.
s Vega is identical for call and put options and is positive.
Thus, higher volatility increases both call and put option
prices.
s Usually measures how much an option price will change as
volatility increases or decreases by 1%.
Rho
𝜌
𝜕𝑉
𝜕𝑟
s Calculates the rate of change of the theoretical Black–
Scholes formula with respect to the risk-free interest rate.
s Higher interest rates increase (decrease) call (put) option
price.
s Lower interest rates increase (decrease) put (call) option
price.
Theta
𝜃
𝜕𝑉
𝜕𝑡
s Calculates the rate of change of the theoretical Black–
Scholes formula with respect to the passage of time.
s Theta has its maximum absolute value when the call option
is ATM.
Extension of Black–Scholes Model
The assumptions of the Black–Scholes model can be relaxed further to obtain closed-form
formulas for European options on the following.
s Asset-paying dividends (fixed discrete dividends, discrete or continuous dividend yield).
For asset 𝑆𝑡which pays a sequence of fixed discrete dividends 𝐷𝑖at time 𝑡𝐷𝑖, 𝑖=
1, 2, … , 𝑛such that 𝑡< 𝑡𝐷1 < 𝑡𝐷2 < ⋯< 𝑡𝐷𝑛, the Black–Scholes equation becomes
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝑟𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝛿(𝑡−𝑡𝐷𝑖) is the Dirac delta function centred at 𝑡𝐷𝑖.
For asset 𝑆𝑡paying continuous dividend yield 𝐷, the Black–Scholes equation becomes
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
s Time-dependent continuous dividend yield, risk-free interest rate and volatility.
For asset 𝑆𝑡paying time-dependent continuous dividend yield 𝐷𝑡with time-dependent
volatility 𝜎𝑡and risk-free interest rate 𝑟𝑡, the Black–Scholes equation becomes
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟𝑡−𝐷𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑡𝑉(𝑆𝑡, 𝑡) = 0.

2.1 Introduction
73
s Incorporating the effects of transaction costs in the hedging portfolio.
By setting the following transaction costs in buying or selling an asset 𝑆𝑡which pays
continuous dividend yield 𝐷:
(i) a fixed cost at each transaction, 𝜅1
(ii) a cost proportional to the number of assets traded, 𝜅2|𝜈|
(iii) a cost proportional to the value of the assets traded, 𝜅3|𝜈|𝑆𝑡
where 𝜅1, 𝜅2, 𝜅3 > 0, 𝜈> 0 (for buying assets) and 𝜈< 0 (for selling assets), the Black–
Scholes equation with transaction costs at time interval 𝛿𝑡becomes
𝜕𝑉
𝜕𝑡+ 1
2̃𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−̃𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) −𝜅1
𝛿𝑡= 0
where
̃𝐷= 𝐷+ 𝜅2𝜎
√
2
𝜋𝛿𝑡
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
(
𝜕𝑉
𝜕𝑆𝑡
)−1
and
̃𝜎2 = 𝜎2 −𝜅3𝜎
√
2
𝜋𝛿𝑡sgn
(
𝜕2𝑉
𝜕𝑆2
𝑡
)
such that sgn(𝑥) = 𝑥
|𝑥|.
s Discontinuous jumps in asset price.
For an asset 𝑆𝑡paying continuous dividend yield 𝐷and having a jump process such that
𝐽𝑡is the jump size variable, the Black–Scholes equation becomes
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ [𝑟−𝐷−𝔼𝐽(𝐽𝑡−1)] 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
+𝜆𝔼𝐽
[𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)] = 0
where the expectation 𝔼𝐽(⋅) is taken over the jump component.
Criticisms of Black–Scholes Model
Given that the Black–Scholes model with European payoffs has closed-form solutions, one
of the main advantages is to be able to calculate option prices analytically. In addition, the
Black–Scholes formula is also easy to understand intuitively without the need to evaluate it
using expensive numerical methods.
Unfortunately, some of the assumptions in the formula are questionable under the current
economic and market conditions. One major criticism is the assumption of stock prices moving
in a manner referred to as a random walk (stock price moves up and down with the same
probability) and the stock returns following a normal distribution. Empirical tests have shown
that there are significant fat tails (leptokurtic) and asymmetry (skewness) in the stock returns.
Another major weakness of the Black–Scholes framework is that the volatility at the time of
buying/selling the option remains unchanged until the option expiry date. This is simply not
true. Nevertheless, even with the availability of option valuation models incorporating either
stochastic volatility or fat tails which are more expensive to evaluate, the Black–Scholes model
still continues to be used due to its robustness and tractability. After all, the model has only
one unobservable parameter and that is the volatility.

74
2.2.1 Basic Properties
2.2
PROBLEMS AND SOLUTIONS
2.2.1
Basic Properties
1. Consider a European call option with price 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry date of the option and 𝐾is the strike price. Show that the call option
is greater than or equal to its intrinsic value
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
Solution: We assume 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝑆𝑡−𝐾, 0} and at time 𝑡we set up the follow-
ing portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −max{𝑆𝑡−𝐾, 0} < 0.
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −max{𝑆𝑇−𝐾, 0}
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0
which is an arbitrage opportunity. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
2. Consider a European put option with price 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry date of the option and 𝐾is the strike price. Show that the put option
is greater than or equal to its intrinsic value
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0}.
Solution: We assume 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝐾−𝑆𝑡, 0} and at time 𝑡we set up the follow-
ing portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) −max{𝐾−𝑆𝑡, 0} < 0.
At expiry time 𝑇
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) −max{𝐾−𝑆𝑇, 0}
= max{𝐾−𝑆𝑇, 0} −max{𝐾−𝑆𝑇, 0}
= 0
which is an arbitrage opportunity. Therefore, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0}.
3. Let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European call option where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry date of the option and 𝐾is the strike price. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡.

2.2.1 Basic Properties
75
Solution: We assume at time 𝑡, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝑆𝑡and we set up the portfolio
Π𝑡= 𝑆𝑡−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
At time 𝑇
Π𝑇= 𝑆𝑇−𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝑆𝑇−max{𝑆𝑇−𝐾, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇
if 𝑆𝑇≤𝐾
𝐾
if 𝑆𝑇> 𝐾
> 0
which is an arbitrage opportunity. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡.
4. Let 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European put option where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry date of the option and 𝐾is the strike price. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾.
Solution: We assume at time 𝑡, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝐾and we set up the portfolio
Π𝑡= 𝐾−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
At time 𝑇
Π𝑇= 𝐾−𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝐾−max{𝐾−𝑆𝑇, 0}
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇
if 𝑆𝑇≤𝐾
𝐾
if 𝑆𝑇> 𝐾
> 0
which is an arbitrage opportunity. Therefore, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾.
5. Consider a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike price 𝐾where 𝑆𝑡is the spot
price of a risky asset at time 𝑡< 𝑇, with 𝑇the expiry time of the option. Assume that 𝑆𝑡
pays a continuous dividend yield 𝐷, then show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}
where 𝑟is the risk-free interest rate.

76
2.2.1 Basic Properties
Solution: We assume 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0} and we set up a
portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0} < 0.
At time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑡; 𝐾, 𝑇) −max{𝑆𝑇−𝐾, 0}
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0
which is an arbitrage opportunity and hence a contradiction. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥
max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}.
N.B. We can also show this result using the put–call parity 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European put option
on the same strike price 𝐾and expiry time 𝑇. Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}
since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
6. Consider a European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike price 𝐾where 𝑆𝑡is the spot
price of a risky asset at time 𝑡< 𝑇, with 𝑇the expiry time of the option. Assume that 𝑆𝑡
pays a continuous dividend yield 𝐷, then show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}
where 𝑟is the risk-free interest rate.
Solution: We assume 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0} and we set up a
portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) −max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0} < 0.
At time 𝑇
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) −max{𝐾−𝑆𝑇, 0}
= max{𝐾−𝑆𝑇, 0} −max{𝐾−𝑆𝑇, 0}
= 0
which is an arbitrage opportunity and hence a contradiction. Therefore, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥
max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}.

2.2.1 Basic Properties
77
N.B. Like its European call option counterpart, we can also show this result using the put–
call parity 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
is the European call option on the same strike price 𝐾and expiry time 𝑇. Thus,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}
since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
7. Consider a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike price 𝐾where 𝑆𝑡is the spot
price of a risky asset at time 𝑡< 𝑇, with 𝑇the expiry time of the option. If the stock pays a
sequence of discrete dividends 𝐷𝑖at time 𝑡𝑖, 𝑖= 1, 2, … , 𝑛, 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇and
by denoting 𝑟as the risk-free interest rate show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0
}
.
Solution:
Using
the
put–call
parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
∑𝑛
𝑖=1 𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European put option on the
same strike price 𝐾and expiry time 𝑇. Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥max
{
𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0
}
since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
8. Consider a European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike price 𝐾where 𝑆𝑡is the spot
price of a risky asset at time 𝑡< 𝑇, with 𝑇the expiry time of the option. If the stock pays a
sequence of discrete dividends 𝐷𝑖at time 𝑡𝑖, 𝑖= 1, 2, … , 𝑛, 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇and
by denoting 𝑟as the risk-free interest rate show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡), 0
}
.
Solution:
Using
the
put–call
parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
∑𝑛
𝑖=1 𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European call option on the

78
2.2.1 Basic Properties
same strike price 𝐾and expiry time 𝑇. Thus,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡)
≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡)
≥max
{
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝐷𝑖𝑒−𝑟(𝑡𝑖−𝑡), 0
}
since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
9. A stock price is currently worth $25 and it pays a continuous dividend yield of 2.29%.
Given that the risk-free interest rate is 4% find the lower bound for an 8-month European
put option on the stock with strike price $30.
Solution: At initial time 𝑡= 0 we set the current stock price 𝑆0 = $25, strike 𝐾= $30, div-
idend yield 𝐷= 2.29%, risk-free interest rate 𝑟= 4% and expiry time 𝑇= 8
12 = 2
3 years.
By setting 𝑃(𝑆0, 0; 𝐾, 𝑇) as the European put option at time 𝑡= 0 its lower bound is
𝑃(𝑆0, 0; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟𝑇−𝑆0𝑒−𝐷𝑇, 0}
= max{30𝑒−0.04× 2
3 −25𝑒−0.029× 2
3 , 0}
= max{4.69, 0}
= $4.69.
10. Consider a 6-month European call option on a discrete dividend-paying stock having a
strike price of $33. The current stock price is worth $35 and dividends of $1.00 and $1.25
are expected to be paid in two months and four months, respectively. Given that the risk-
free interest rate is 2.5% find the lower bound for the European call option price.
Solution: At initial time 𝑡= 0 we let the current stock price 𝑆0 = $35, strike 𝐾= $33,
discrete dividends 𝐷1 = $1.00 at time 𝑡1 = 2
12 = 1
6 years, 𝐷2 = $1.25 at time 𝑡2 = 4
12 = 1
3
years, risk-free interest rate 𝑟= 2.5% and expiry time 𝑇= 6
12 = 1
2 years.
By denoting 𝐶(𝑆0, 0; 𝐾, 𝑇) as the European call option at time 𝑡= 0, its lower bound
is
𝐶(𝑆0, 0; 𝐾, 𝑇) ≥max{𝑆0 −𝐷1𝑒−𝑟𝑡1 −𝐷2𝑒−𝑟𝑡2 −𝐾𝑒−𝑟𝑇, 0}
= max{35 −𝑒−0.025× 1
6 −1.25𝑒−0.025× 1
3 −33𝑒−0.025× 1
2 , 0}
= max{0.1745, 0}
= $0.17.

2.2.1 Basic Properties
79
11. Consider two European call options 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) and 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) having expiry times
𝑇1 and 𝑇2 with 𝑇1 < 𝑇2, 𝑆𝑡is the spot price at time 𝑡and 𝐾is the common strike price.
Show that for a non-dividend-paying stock
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.
Solution: We assume 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) > 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) where at time 𝑡we can set up a
portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) < 0.
At time 𝑇1, the portfolio is now worth
Π𝑇1 = 𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −max{𝑆𝑇1 −𝐾, 0}
=
⎧
⎪
⎨
⎪⎩
𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2)
if 𝑆𝑇1 ≤𝐾
𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −𝑆𝑇1 + 𝐾
if 𝑆𝑇1 > 𝐾.
Since 𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) ≥𝑆𝑇1 −𝐾we have Π𝑇1 ≥0, which is a contradiction. Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) for 𝑇1 < 𝑇2.
12. Consider two European put options 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) having expiry times
𝑇1 and 𝑇2 with 𝑇1 < 𝑇2, 𝑆𝑡is the spot price at time 𝑡and 𝐾is the common strike price.
Show that for a non-dividend-paying stock
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.
Solution: We assume 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) > 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) where at time 𝑡we can set up a
portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) < 0.
At time 𝑇1, the portfolio is now worth
Π𝑇1 = 𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −max{𝐾−𝑆𝑇1, 0}
=
⎧
⎪
⎨
⎪⎩
𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2)
if 𝑆𝑇1 ≥𝐾
𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −𝐾+ 𝑆𝑇1
if 𝑆𝑇1 < 𝐾.
Since 𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) ≥𝐾−𝑆𝑇1 we have Π𝑇1 ≥0, which is a contradiction. Therefore,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝑃(𝑆𝑡, 𝑡; 𝑇2) for 𝑇1 < 𝑇2.

80
2.2.1 Basic Properties
13. For a non-dividend-paying stock we consider a 3-month European call option with strike
$51 and a 6-month European call with strike $52 with premiums $4.50 and $4.17, respec-
tively. Let the risk-free interest rate be 10% and show that we can construct an arbitrage
opportunity portfolio.
Solution: At time 𝑡= 0 we denote 𝑆0 as the current stock price, strikes 𝐾1 = $4.50,
𝐾2 = $4.17, expiry times 𝑇1 = 3
12 = 1
4 years, 𝑇2 = 6
12 = 1
2 years and risk-free interest rate
𝑟= 10%.
We denote the 3-month European call option with strike 𝐾1 = $51 and the 6-month
European
call
option
with
strike
𝐾2 = $52
as
𝐶(𝑆0, 0; 𝐾1, 𝑇1) = $4.50
and
𝐶(𝑆0, 0; 𝐾2, 𝑇2) = $4.17, respectively.
At time 𝑡= 0 we set up the following portfolio
Π0 = 𝐶(𝑆0, 0; 𝐾2, 𝑇2) −𝐶(𝑆0, 0; 𝐾1, 𝑇1)
= $4.17 −$4.50
= −$0.33.
At time 𝑇1
Π𝑇1 = 𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐶(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1)
= 𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −max{𝑆𝑇1 −𝐾1, 0}
=
⎧
⎪
⎨
⎪⎩
𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2)
if 𝑆𝑇1 ≤𝐾1
𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝑆𝑇1 + 𝐾1
if 𝑆𝑇1 > 𝐾1
≥
⎧
⎪
⎨
⎪⎩
𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2)
if 𝑆𝑇1 ≤𝐾1
𝑆𝑇1 −𝐾2𝑒−𝑟(𝑇2−𝑇1) −𝑆𝑇1 + 𝐾1
if 𝑆𝑇1 > 𝐾1
=
⎧
⎪
⎨
⎪⎩
𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2)
if 𝑆𝑇1 ≤𝐾1
𝐾1 −𝐾2𝑒−𝑟(𝑇2−𝑇1)
if 𝑆𝑇1 > 𝐾1.
Given 𝐶(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) ≥0 and 𝐾1 −𝐾2𝑒−𝑟(𝑇2−𝑇1) = 51 −52𝑒−0.1× 1
4 = $0.28 > 0, the
portfolio Π𝑇1 ≥0 which is an arbitrage opportunity.
In contrast, at time 𝑇2
Π𝑇2 = 𝐶(𝑆𝑇2, 𝑇2; 𝐾2, 𝑇2) = max{𝑆𝑇2 −𝐾2, 0} ≥0
which is also an arbitrage opportunity.
Thus, by setting up the portfolio at time 𝑡= 0
Π0 = 𝐶(𝑆0, 0; 𝐾2, 𝑇2) −𝐶(𝑆0, 0; 𝐾1, 𝑇1)
we can guarantee an arbitrage opportunity.

2.2.1 Basic Properties
81
14. Consider two European call options 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having strike prices
𝐾1 and 𝐾2, respectively with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Show that
0 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.
Solution: We first assume 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) where at time 𝑡we can set up
a portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝑆𝑇−𝐾1, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾2.
Hence, Π𝑇≥0 which is a contradiction.
We next assume 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) > 𝐾2 −𝐾1 where at time 𝑡we set up
the following portfolio
Π𝑡= 𝐾2 −𝐾1 −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐾2 −𝐾1 −𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= 𝐾2 −𝐾1 −max{𝑆𝑇−𝐾1, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇≤𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
0
if 𝑆𝑇> 𝐾2.
Hence, Π𝑇≥0 which is also a contradiction.
Therefore,
0 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.

82
2.2.1 Basic Properties
15. Consider two European put options 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having strike prices
𝐾1 and 𝐾2, respectively with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Show that
0 ≤𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.
Solution: We first assume 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) where at time 𝑡we can set up
a portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= max{𝐾2 −𝑆𝑇, 0} −max{𝐾1 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇< 𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 ≤𝑆𝑇< 𝐾2
0
if 𝑆𝑇≥𝐾2.
Hence, Π𝑇≥0 which is a contradiction.
We next assume 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) > 𝐾2 −𝐾1 where at time 𝑡we set up
the following portfolio
Π𝑡= 𝐾2 −𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐾2 −𝐾1 −𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= 𝐾2 −𝐾1 −max{𝐾2 −𝑆𝑇, 0} + max{𝐾1 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇< 𝐾1
𝑆𝑇−𝐾1
if 𝐾1 ≤𝑆𝑇< 𝐾2
𝐾2 −𝐾1
if 𝑆𝑇≥𝐾2.
Hence, Π𝑇≥0 which is also a contradiction.
Therefore,
0 ≤𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.

2.2.1 Basic Properties
83
16. Consider two European call options 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having strike prices
𝐾1 and 𝐾2, respectively with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Given the risk-free interest rate 𝑟show that
0 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
for 𝐾1 < 𝐾2.
Solution: From Problem 2.2.1.14 (page 81) we have shown that
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≥0.
In order to show that
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
we note that from the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑆𝑡−𝐾1𝑒−𝑟(𝑇−𝑡)
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑆𝑡−𝐾2𝑒−𝑟(𝑇−𝑡).
Taking differences, we have
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = (𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
−𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
and since 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤0 (see Problem 2.2.1.15, page 82)
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
for 𝐾1 < 𝐾2.
17. Consider two European put options 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having strike prices
𝐾1 and 𝐾2, respectively with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Given the risk-free interest rate 𝑟show that
0 ≤𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
for 𝐾1 < 𝐾2.
Solution: From Problem 2.2.1.15 (page 82) we have
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥0.
In order to show that
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)

84
2.2.1 Basic Properties
we note that from the put–call parity
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑆𝑡+ 𝐾2𝑒−𝑟(𝑇−𝑡)
𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑆𝑡+ 𝐾1𝑒−𝑟(𝑇−𝑡).
Taking differences, we have
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = (𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
−𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇)
and since 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤0 (see Problem 2.2.1.14, page 81)
𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤(𝐾2 −𝐾1)𝑒−𝑟(𝑇−𝑡)
for 𝐾1 < 𝐾2.
18. Let the prices of two European put options with strikes $50 and $53 be $1.50 and $5.00,
respectively where both options have the same time to expiry.
(a) Is the no-arbitrage condition violated?
(b) Suggest
a
spread
position
so
that
the
portfolio
will
ensure
an
arbitrage
opportunity.
Solution: We assume the options are priced at time 𝑡with spot price 𝑆𝑡and we let 𝐾1 = $50
and 𝐾2 = $53 so that 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = $1.50 and 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = $5.00 where 𝑇> 𝑡are
the options’ expiry time.
(a) Since 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = $5.00 −$1.50 > 𝐾2 −𝐾1 = $53 −$50 for
𝐾1 < 𝐾2, this violates the condition 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤𝐾2 −𝐾1.
(b) We let the portfolio at time 𝑡be
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = $1.50 −$5.00 = −$3.50
where at time 𝑇, the portfolio will be worth
Π𝑇= max{50 −𝑆𝑇, 0} −max{53 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
−3
if 𝑆𝑇≤50
𝑆𝑇−53
if 50 < 𝑆𝑇≤53
0
if 𝑆𝑇> 53.

2.2.1 Basic Properties
85
Hence, the profit at time 𝑇is
Υ𝑇= Π𝑇−Π𝑡
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0.50
if 𝑆𝑇≤50
𝑆𝑇−49.50
if 50 < 𝑆𝑇≤53
3.50
if 𝑆𝑇> 53
> 0.
Thus, Υ𝑇> 0, which shows that the portfolio Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) pro-
vides an arbitrage opportunity.
19. The Black–Scholes formulae for the value of a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) are
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the expiry
date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the spot price volatility. In the following limits show that the values
of the call and put prices satisfy
(a) lim
𝑡→𝑇𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}, lim
𝑡→𝑇𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}
(b) lim
𝜎→0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
if 𝑆𝑡> 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
0
if 𝑆𝑡≤𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
lim
𝜎→0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
0
if 𝑆𝑡≥𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
𝐾−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
if 𝑆𝑡< 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)

86
2.2.1 Basic Properties
(c) lim
𝜎→∞𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡), lim
𝜎→∞𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)
(d)
lim
𝐷→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
lim
𝐷→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)
(e)
lim
𝑇→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡
if 𝐷= 0
0
if 𝐷> 0
lim
𝑇→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝐾
if 𝑟= 0
0
if 𝑟> 0.
Solution:
(a) For the case 𝑡→𝑇
lim
𝑡→𝑇𝑑± = lim
𝑡→𝑇
{
log(𝑆𝑡∕𝐾)
𝜎
√
𝑇−𝑡
+
(𝑟−𝐷
𝜎
± 1
2𝜎
) √
𝑇−𝑡
}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
+∞
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇= 𝐾
−∞
if 𝑆𝑇< 𝐾.
Hence,
lim
𝑡→𝑇𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
lim
𝑡→𝑇𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑇
if 𝑆𝑇< 𝐾
0
if 𝑆𝑇≥𝐾
or
lim
𝑡→𝑇𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
lim
𝑡→𝑇𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}.

2.2.1 Basic Properties
87
(b) For the case 𝜎→0
lim
𝜎→0 𝑑± = lim
𝜎→0
{
log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
± 1
2𝜎
√
𝑇−𝑡
}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
+∞
if 𝑆𝑡> 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
0
if 𝑆𝑡= 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
−∞
if 𝑆𝑡< 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡).
Therefore,
lim
𝜎→0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
if 𝑆𝑡> 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
0
if 𝑆𝑡≤𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
and
lim
𝜎→0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
0
if 𝑆𝑡≥𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡)
𝐾−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
if 𝑆𝑡< 𝐾𝑒−(𝑟−𝐷)(𝑇−𝑡).
(c) For the case 𝜎→∞
lim
𝜎→∞𝑑± = lim
𝜎→∞
{
log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
± 1
2𝜎
√
𝑇−𝑡
}
= ±∞.
Therefore,
lim
𝜎→∞𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
and
lim
𝜎→∞𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡).
(d) For the case 𝐷→∞and 𝜎> 0
lim
𝐷→∞,𝜎>0 𝑑± =
lim
𝐷→∞,𝜎>0
{log(𝑆𝑡∕𝐾) + (𝑟± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
−𝐷
𝜎
√
𝑇−𝑡
}
= −∞.

88
2.2.1 Basic Properties
Hence,
lim
𝐷→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
and
lim
𝐷→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡).
(e) For the case 𝑇→∞, 𝜎> 0 and if 𝐷> 0, 𝑟> 0 and because 0 ≤Φ(𝑑±) ≤1, 0 ≤
Φ(−𝑑±) ≤1
lim
𝑇→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0, lim
𝑇→∞𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
For the case 𝑇→∞, 𝜎> 0 and if 𝐷= 0, 𝑟> 0 we have
lim
𝑇→∞,𝜎>0 𝑑+ =
lim
𝑇→∞,𝜎>0
{
log(𝑆𝑡∕𝐾)
𝜎
√
𝑇−𝑡
+
( 𝑟
𝜎+ 1
2𝜎
) √
𝑇−𝑡
}
= +∞.
Hence,
lim
𝑇→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡
and
lim
𝑇→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
Finally, for the case 𝑇→∞, 𝜎> 0 and if 𝐷> 0, 𝑟= 0 we have
lim
𝑇→∞,𝜎>0 𝑑−=
lim
𝑇→∞,𝜎>0
{
log(𝑆𝑡∕𝐾)
𝜎
√
𝑇−𝑡
−
(𝐷
𝜎+ 1
2𝜎
) √
𝑇−𝑡
}
= −∞.
Therefore,
lim
𝑇→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
lim
𝑇→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾.
Collectively, we can deduce
lim
𝑇→∞,𝜎>0 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡
if 𝐷= 0
0
if 𝐷> 0

2.2.2 Black–Scholes Model
89
and
lim
𝑇→∞,𝜎>0 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝐾
if 𝑟= 0
0
if 𝑟> 0.
2.2.2
Black–Scholes Model
1. Black–Scholes Equation with Stock Paying Continuous Dividend Yield I. Let {𝑊𝑡: 𝑡≥0}
be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the stock price
𝑆𝑡follow a geometric Brownian motion (GBM) with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter and 𝜎is the volatility parameter. In addition, let 𝐵𝑡be the
risk-free asset having the following differential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟denotes the risk-free interest rate.
Assume that the stock 𝑆𝑡pays a continuous dividend yield 𝐷. Intuitively, explain why
the above SDE can be written as
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
By considering a delta-hedging portfolio involving both an option 𝑉(𝑆𝑡, 𝑡) which can only
be exercised at expiry time 𝑇and a stock 𝑆𝑡, derive the Black–Scholes equation for a stock
that pays continuous dividend yield.
Solution: Given that dividend yield is defined as the proportion of asset price paid out per
unit time, when a dividend is paid out, the stock price 𝑆𝑡is reduced by 𝐷𝑆𝑡𝑑𝑡. Therefore,
we can write
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ 𝑆𝑡
where it involves buying one unit of option 𝑉(𝑆𝑡, 𝑡) and selling Δ units of 𝑆𝑡. Since the
investor receives 𝐷𝑆𝑡𝑑𝑡for every unit of asset held, and because the investor holds −Δ 𝑆𝑡,

90
2.2.2 Black–Scholes Model
the portfolio changes by an amount −Δ𝐷𝑆𝑡𝑑𝑡and therefore the change in portfolio Π𝑡is
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡)
= 𝑑𝑉−Δ𝑑𝑆𝑡−Δ𝐷𝑆𝑡𝑑𝑡.
Expanding 𝑉(𝑆𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡
)2 + …
and by substituting 𝑑𝑆𝑡= (𝜇−𝐷) 𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡and subsequently applying It¯o’s lemma
we have
𝑑𝑉=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡.
Substituting back into 𝑑Π𝑡and rearranging the terms we have
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
−Δ [(𝜇−𝐷) 𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
] −Δ𝐷𝑆𝑡𝑑𝑡
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
)
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
To eliminate the random component we choose
Δ = 𝜕𝑉
𝜕𝑆𝑡
which leads to
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡.
Under the no-arbitrage condition the return on the amount Π𝑡invested at a risk-free interest
rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡

2.2.2 Black–Scholes Model
91
where 𝑟is the risk-free rate and hence we have
𝑟Π𝑡𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡
𝑟(𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
) 𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
and finally
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
which is the Black–Scholes equation for a stock which pays continuous dividend yield.
2. Black–Scholes Equation with Stock Paying Continuous Dividend Yield II. Let {𝑊𝑡: 𝑡≥0}
be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the stock price
𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatil-
ity parameter. In addition, let 𝐵𝑡be the risk-free asset having the following differential
equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟denotes the risk-free interest rate.
At time 𝑡we consider a trader who has a portfolio valued at Π𝑡, given as
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
holding 𝜙𝑡shares of stock and 𝜓𝑡units being invested in a risk-free asset 𝐵𝑡. Let the option
price at time 𝑡be 𝑉(𝑆𝑡, 𝑡); the contingent claim 𝑉(𝑆𝑇, 𝑇) is said to be attainable if there
exists an admissible strategy worth Π𝑇= 𝑉(𝑆𝑇, 𝑇) at the option expiry time 𝑇, 𝑇> 𝑡.
In the absence of arbitrage, show that Π𝑡= 𝑉(𝑆𝑡, 𝑡), 𝑡∈[0, 𝑇].
Finally, show that the portfolio (𝜙𝑡, 𝜓𝑡) is self-financing if and only if 𝑉(𝑆𝑡, 𝑡) satisfies
the Black–Scholes equation for a stock that pays continuous dividend yield.
Solution: Assume there is a risk-free interest rate 𝑟where an investor can invest in a money
market account. At time 𝑡, if Π𝑡> 𝑉(𝑆𝑡, 𝑡) then the investor can sell the portfolio Π𝑡and
use the proceeds to buy the option 𝑉(𝑆𝑡, 𝑡), making a profit Π𝑡−𝑉(𝑆𝑡, 𝑡) > 0 and saving
it in a risk-free money-market account. At time 𝑇both of the asset values are identical,

92
2.2.2 Black–Scholes Model
Π𝑇= 𝑉(𝑆𝑇, 𝑇), with the value of the bought option covering the sold portfolio and making
a risk-free profit (Π𝑡−𝑉(𝑆𝑡, 𝑡))𝑒𝑟(𝑇−𝑡).
Alternatively, at time 𝑡if Π𝑡< 𝑉(𝑆𝑡, 𝑡) then an investor can sell the option 𝑉(𝑆𝑡, 𝑡) and
buy the portfolio Π𝑡, also making an instant profit 𝑉(𝑆𝑡, 𝑡) −Π𝑡> 0, and the proceeds can
go into the money-market account. At time 𝑇the asset values are equal, Π𝑇= 𝑉(𝑆𝑇, 𝑇),
with the value of the bought portfolio covering the sold option and making a risk-free profit
(𝑉(𝑆𝑡, 𝑡) −Π𝑡)𝑒𝑟(𝑇−𝑡).
Therefore, under the no-arbitrage condition we must have Π𝑡= 𝑉(𝑆𝑡, 𝑡).
At time 𝑡∈[0, 𝑇], to replicate the option 𝑉(𝑆𝑡, 𝑡), let the self-financing portfolio be
𝑉(𝑆𝑡, 𝑡) = 𝜙𝑆𝑡+ 𝜓𝑡𝐵𝑡.
By applying Taylor’s theorem on 𝑑𝑉
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + …
and since (𝑑𝑆𝑡)2 = ((𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡)2 = 𝜎2𝑆2
𝑡𝑑𝑡such that (𝑑𝑡)𝜈= 0, 𝜈≥2 we
have
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝑑𝑡
= 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)
𝑑𝑡.
Since the trader will receive 𝐷𝑆𝑡𝑑𝑡for every stock held, the portfolio (𝜙𝑡, 𝜓𝑡) is self-
financing if and only if
𝑑𝑉= 𝜙𝑡𝑑𝑆𝑡+ 𝜓𝑡𝑑𝐵𝑡+ 𝜙𝑡𝐷𝑆𝑡𝑑𝑡= 𝜙𝑡𝑑𝑆𝑡+ (𝑟𝐵𝑡𝜓𝑡+ 𝜙𝑡𝐷𝑆𝑡)𝑑𝑡.
By equating both of the equations we have
𝑟𝐵𝑡𝜓𝑡+ 𝜙𝑡𝐷𝑆𝑡= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
and
𝜙𝑡= 𝜕𝑉
𝜕𝑆𝑡
and substituting the above two equations into
𝑉= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.

2.2.2 Black–Scholes Model
93
3. Black–Scholes Equation with Stock Paying Discrete Dividends. Let {𝑊𝑡: 𝑡≥0} be a ℙ-
standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow
the SDE
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter and 𝜎is the volatility parameter. In addition, let 𝐵𝑡be the
risk-free asset having the following differential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟denotes the risk-free interest rate.
Assume the asset 𝑆𝑡pays a sequence of fixed dividends 𝐷𝑖at time 𝑡𝐷𝑖, 𝑖= 1, 2, … , 𝑛
such that 𝑡< 𝑡𝐷𝑖< 𝑡𝐷2 < ⋯< 𝑡𝐷𝑛. Explain intuitively why the SDE for 𝑆𝑡can be written
as
𝑑𝑆𝑡=
(
𝜇𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝛿(𝑡−𝑡𝐷𝑖) is the Dirac delta function centred at 𝑡𝐷𝑖.
By considering a hedging portfolio involving both an option 𝑉(𝑆𝑡, 𝑡) which can only be
exercised at expiry time 𝑇> 𝑡𝐷𝑛and a stock 𝑆𝑡, show that 𝑉(𝑆𝑡, 𝑡) satisfies the following
differential equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝑟𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
Solution: When a discrete dividend 𝐷𝑖is paid at time 𝑡𝐷𝑖, the asset price 𝑆𝑡is reduced by
the same amount. However, for the time between dividend payment dates, 𝑆𝑡still follows
a GBM process. Hence, we can write
𝑑𝑆𝑡=
(
𝜇𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
where it involves buying one unit of option 𝑉(𝑆𝑡, 𝑡) and selling Δ units of 𝑆𝑡. At times
𝑡𝐷1, 𝑡𝐷2, … , 𝑡𝐷𝑛, the owner of the portfolio receives 𝐷1, 𝐷2, … , 𝐷𝑛dividend payments

94
2.2.2 Black–Scholes Model
for every asset held. Therefore, the change in portfolio Π𝑡becomes
𝑑Π𝑡= 𝑑𝑉−Δ
(
𝑑𝑆𝑡+
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)𝑑𝑡
)
= 𝑑𝑉−Δ(𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡).
Expanding 𝑉(𝑆𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡
)2 + …
and by substituting 𝑑𝑆𝑡=
(
𝜇𝑆𝑡−∑𝑛
𝑖=1 𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡and applying It¯o’s
lemma we have
𝑑𝑉=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝜇𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡.
Hence,
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝜇𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
)
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
Setting Δ = 𝜕𝑉
𝜕𝑆𝑡
to eliminate the random component leads to
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖) 𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡.
Under the no-arbitrage condition the return on the portfolio Π𝑡invested in a risk-free inter-
est rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡

2.2.2 Black–Scholes Model
95
where 𝑟is the risk-free interest rate and hence we have
𝑟Π𝑡𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖) 𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡
𝑟(𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
) 𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖) 𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖) 𝜕𝑉
𝜕𝑆𝑡
which eventually leads to
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝑟𝑆𝑡−
𝑛
∑
𝑖=1
𝐷𝑖𝛿(𝑡−𝑡𝐷𝑖)
)
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
which is a Black–Scholes equation with stock paying discrete dividend payments.
4. European Option Valuation (PDE Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with
the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the dividend yield, 𝜎is the volatility parameter and let
𝑟denote the risk-free interest rate.
Let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European call option with strike 𝐾and expiry time
𝑇> 𝑡, satisfying the Black–Scholes equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary conditions
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}, 𝐶(0, 𝑡; 𝐾, 𝑇) = 0
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ∼𝑆𝑡𝑒−𝐷(𝑇−𝑡) as 𝑆𝑡→∞.
With the introduction of variables 𝑥, 𝜏and 𝑣(𝑥, 𝜏) defined by
𝑆𝑡= 𝐾𝑒𝑥, 𝑡= 𝑇−
𝜏
1
2𝜎2 , 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑣(𝑥, 𝜏)

96
2.2.2 Black–Scholes Model
show that the Black–Scholes equation is reduced to
𝜕𝑣
𝜕𝜏= 𝜕2𝑣
𝜕𝑥2 + 𝑘1
𝜕𝑣
𝜕𝑥−𝑘0𝑣
with boundary condition
𝑣(𝑥, 0) = max{𝑒𝑥−1}
where 𝑘1 =
(𝑟−𝐷−1
2𝜎2)
1
2𝜎2
and 𝑘0 =
𝑟
1
2𝜎2 .
Using a change of variables 𝑣(𝑥, 𝜏) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) show that by setting
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0
the problem is reduced to a diffusion equation of the form
𝜕𝑢
𝜕𝜏= 𝜕2𝑢
𝜕𝑥2 , 𝑢(𝑥, 0) = 𝑓(𝑥)
where 𝑓(𝑥) = max{𝑒
1
2 (𝑘1+1)𝑥−𝑒
1
2 𝑘1𝑥, 0} for −∞< 𝑥< ∞and 𝜏> 0.
Given the solution
𝑢(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2
4𝜏
𝑑𝑧
deduce that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (𝑑+
) −𝐾𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) is the standard normal cdf
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: A European call option with value 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the Black–Scholes
equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0

2.2.2 Black–Scholes Model
97
with conditions
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}, 𝐶(0, 𝑡; 𝐾, 𝑇) = 0
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ∼𝑆𝑡𝑒−𝐷(𝑇−𝑡) as 𝑆𝑡→∞.
First we transform the Black–Scholes equation by making it dimensionless, setting
𝑆𝑡= 𝐾𝑒𝑥, 𝑡= 𝑇−
𝜏
1
2𝜎2 , 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑣(𝑥, 𝜏)
and write
𝜕𝐶
𝜕𝑡= 𝜕𝐶
𝜕𝜏
𝜕𝜏
𝜕𝑡= −1
2𝐾𝜎2 𝜕𝑣
𝜕𝜏, 𝜕𝐶
𝜕𝑆𝑡
= 𝜕𝐶𝑡
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝐾
𝑆𝑡
𝜕𝑣
𝜕𝑥
and
𝜕2𝐶
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝜕𝐶
𝜕𝑆𝑡
)
=
𝜕
𝜕𝑆𝑡
(
𝜕𝐶
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
)
=
𝜕
𝜕𝑆𝑡
(𝜕𝐶
𝜕𝑥
) 𝜕𝑥
𝜕𝑆𝑡
+
𝜕
𝜕𝑆𝑡
(
𝜕𝑥
𝜕𝑆𝑡
)
𝜕𝐶
𝜕𝑥
= 𝜕
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
(𝜕𝐶
𝜕𝑥
) 𝜕𝑥
𝜕𝑆𝑡
−
(
1
𝑆2
𝑡
)
𝜕𝐶
𝜕𝑥
= 𝜕2𝐶
𝜕𝑥2
(
𝜕𝑥
𝜕𝑆𝑡
)2
−
(
1
𝑆2
𝑡
)
𝜕𝐶
𝜕𝑥
= 𝐾
𝑆2
𝑡
(
𝜕2𝑣
𝜕𝑥2 −𝜕𝑣
𝜕𝑥
)
.
By substituting the above expressions back into the Black–Scholes equation we have
𝜕𝑣
𝜕𝜏= 𝜕2𝑣
𝜕𝑥2 −𝜕𝑣
𝜕𝑥+ 𝑟−𝐷
1
2𝜎2
𝜕𝑣
𝜕𝑥−
𝑟
1
2𝜎2 𝑣(𝑥, 𝜏)
or
𝜕𝑣
𝜕𝜏= 𝜕2𝑣
𝜕𝑥2 + 𝑘1
𝜕𝑣
𝜕𝑥−𝑘0𝑣(𝑥, 𝜏)
where 𝑘1 =
(𝑟−𝐷−1
2𝜎2)
1
2𝜎2
and 𝑘0 =
𝑟
1
2𝜎2 .

98
2.2.2 Black–Scholes Model
As for the boundary condition
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max {𝑆𝑇−𝐾, 0}
it becomes
𝐾𝑣(𝑥, 0) = max {𝐾𝑒𝑥−𝐾, 0}
or
𝑣(𝑥, 0) = max {𝑒𝑥−1, 0} .
In order to simplify the partial differential equation (PDE) we let
𝑣(𝑥, 𝜏) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏)
with
𝜕𝑣
𝜕𝜏= 𝛽𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) + 𝑒𝛼𝑥+𝛽𝜏𝜕𝑢
𝜕𝜏
𝜕𝑣
𝜕𝑥= 𝛼𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) + 𝑒𝛼𝑥+𝛽𝜏𝜕𝑢
𝜕𝑥
𝜕2𝑣
𝜕𝑥2 = 𝛼2𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) + 𝛼𝑒𝛼𝑥+𝛽𝜏𝜕𝑢
𝜕𝑥+ 𝛼𝑒𝛼𝑥+𝛽𝜏𝜕𝑢
𝜕𝑥+ 𝑒𝛼𝑥+𝛽𝜏𝜕2𝑢
𝜕𝑥2
= 𝑒𝛼𝑥+𝛽𝜏
(
𝛼2𝑢(𝑥, 𝜏) + 2𝛼𝜕𝑢
𝜕𝑥+ 𝜕2𝑢
𝜕𝑥2
)
.
Substituting the above expressions back into the PDE yields
𝛽𝑢(𝑥, 𝜏) + 𝜕𝑢
𝜕𝜏= 𝛼2𝑢+ 2𝛼𝜕𝑢
𝜕𝑥+ 𝜕2𝑢
𝜕𝑥2 + 𝑘1
(
𝛼𝑢+ 𝜕𝑢
𝜕𝑥
)
−𝑘0𝑢(𝑥, 𝜏)
or
𝜕2𝑢
𝜕𝑥2 + (2𝛼+ 𝑘1
) 𝜕𝑢
𝜕𝑥+ (𝛼2 + 𝑘1𝛼−𝑘0 −𝛽) 𝑢(𝑥, 𝜏) = 𝜕𝑢
𝜕𝜏.
In order to reduce the above problem to the form
𝜕2𝑢
𝜕𝑥2 = 𝜕𝑢
𝜕𝜏
we let
𝛽= 𝛼2 + 𝑘1𝛼−𝑘0
and
2𝛼+ 𝑘1 = 0
which gives
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0.

2.2.2 Black–Scholes Model
99
Therefore,
𝑣(𝑥, 𝜏) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏)
= 𝑒−1
2 𝑘1𝑥−( 1
4 𝑘2
1+𝑘0)𝜏𝑢(𝑥, 𝜏)
where
𝜕2𝑢
𝜕𝑥2 = 𝜕𝑢
𝜕𝜏, 𝑥∈(−∞, ∞), 𝜏> 0
with
𝑢(𝑥, 0) = 𝑒𝛼𝑥𝑣(𝑥, 0)
= 𝑒
1
2 𝑘1𝑥max {𝑒𝑥−1, 0}
= max{𝑒( 1
2 𝑘1+1)𝑥−𝑒
1
2 𝑘1𝑥, 0}
or
𝑓(𝑥) = max{𝑒( 1
2 𝑘1+1)𝑥−𝑒
1
2 𝑘1𝑥, 0}.
The solution to the diffusion equation
𝜕2𝑢
𝜕𝑥2 = 𝜕𝑢
𝜕𝜏, 𝑥∈(−∞, ∞), 𝜏> 0
is given by
𝑢(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2
4𝜏
𝑑𝑧.
Using the changing of variables we let 𝑦= 𝑧−𝑥
√
2𝜏
𝑢(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
−∞
𝑓(𝑥+
√
2𝜏𝑦)𝑒−1
2 𝑦2√
2𝜏𝑑𝑦.
Since 𝑓(𝑥+
√
2𝜏𝑦) = min{𝑒
1
2 𝑘1(𝑥+
√
2𝜏𝑦)(𝑒𝑥+
√
2𝜏𝑦−1), 0} > 0 if 𝑦> −
𝑥
√
2𝜏
𝑢(𝑥, 𝜏) =
1
√
2𝜋∫
∞
−
𝑥
√
2𝜏
[
𝑒( 1
2 𝑘1+1)(𝑥+
√
2𝜏𝑦) −𝑒
1
2 𝑘1(𝑥+
√
2𝜏𝑦)
]
𝑒−1
2 𝑦2𝑑𝑦
= 𝐼1 −𝐼2
where
𝐼1 =
1
√
2𝜋∫
∞
−
𝑥
√
2𝜏
𝑒( 1
2 𝑘1+1)(𝑥+
√
2𝜏𝑦)−1
2 𝑦2𝑑𝑦

100
2.2.2 Black–Scholes Model
and
𝐼2 =
1
√
2𝜋∫
∞
−
𝑥
√
2𝜏
𝑒
1
2 𝑘1(𝑥+
√
2𝜏𝑦)−1
2 𝑦2𝑑𝑦.
To calculate 𝐼1 we have
𝐼1 =
1
√
2𝜋∫
∞
−
𝑥
√
2𝜏
𝑒( 1
2 𝑘1+1)(𝑥+
√
2𝜏𝑦)−1
2 𝑦2𝑑𝑦
= 𝑒( 1
2 𝑘1+1)𝑥+( 1
2 𝑘1+1)2𝜏
√
2𝜋
∫
∞
−
𝑥
√
2𝜏
𝑒−1
2 (𝑦−( 1
2 𝑘1+1)
√
2𝜏)2𝑑𝑦.
Let 𝑠= 𝑦−( 1
2𝑘1 + 1)
√
2𝜏then
𝐼1 = 𝑒( 1
2 𝑘1+1)𝑥+( 1
2 𝑘1+1)2𝜏
√
2𝜋
∫
∞
−
𝑥
√
2𝜏−( 1
2 𝑘1+1)
√
2𝜏
𝑒−1
2 𝑠2𝑑𝑠
= 𝑒( 1
2 𝑘1+1)𝑥+( 1
2 𝑘1+1)2𝜏Φ (𝑑+
)
where Φ (𝑑+
) =
1
√
2𝜋∫
𝑑+
−∞
𝑒−1
2 𝑠2𝑑𝑠and 𝑑+ =
𝑥
√
2𝜏
+
(1
2𝑘1 + 1
) √
2𝜏.
Using the same techniques we can write 𝐼2 as
𝐼2 = 𝑒
1
2 𝑘1𝑥+ 1
4 𝑘2
1𝜏Φ (𝑑−
)
where 𝑑−=
𝑥
√
2𝜏
+ 1
2𝑘1
√
2𝜏.
Thus,
𝑢(𝑥, 𝜏) = 𝑒( 1
2 𝑘1+1)𝑥+( 1
2 𝑘1+1)2𝜏Φ(𝑑+) + 𝑒
1
2 𝑘1𝑥+ 1
4 𝑘2
1𝜏Φ(𝑑−)
and from 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑣(𝑥, 𝜏) = 𝐾𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) we eventually have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒𝑥+(𝑘1−𝑘0+1)𝜏Φ(𝑑+) −𝐾𝑒−𝑘0𝜏Φ(𝑑−)
where 𝛼= −1
2𝑘1 and 𝛽= −1
4𝑘2
1 −𝑘0.
Finally, by substituting 𝑘1 =
(𝑟−𝐷−1
2𝜎2)
1
2𝜎2
and 𝑘0 =
𝑟
1
2𝜎2 we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)

2.2.2 Black–Scholes Model
101
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
N.B. Using the put–call parity we can show that the price of a European put option is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+).
5. European Option Valuation (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM
with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. Using It¯o’s lemma show that under the risk-neutral measure ℚthe conditional
distribution of 𝑆𝑇given 𝑆𝑡is
𝑆𝑇|𝑆𝑡∼log -
[
log 𝑆𝑡+ (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
where 𝑟is the risk-free interest rate and 𝑇> 𝑡.
From the Feynman–Kac formula the European call option with strike 𝐾and expiry time
𝑇is given by
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
where 𝔼ℚ(⋅) is the expectation under the risk-neutral measure ℚ.
Using the risk-neutral valuation approach show that the European call option price is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log (𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) is the standard normal cdf
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.

102
2.2.2 Black–Scholes Model
Finally, deduce that the European put option price with strike 𝐾and expiry time 𝑇is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+).
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚwe can write
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
such that 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It̄o’s lemma we
can show that for 𝑡< 𝑇
𝑑(log 𝑆𝑡) = 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
−1
2𝜎2𝑑𝑡
=
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡.
Integrating over time we have
∫
𝑇
𝑡
𝑑(log 𝑆𝑢) = ∫
𝑇
𝑡
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑑𝑊ℚ
𝑢
log
(𝑆𝑇
𝑆𝑡
)
=
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) + 𝜎𝑊ℚ
𝑇−𝑡
where 𝑊ℚ
𝑇−𝑡∼(0, 𝑇−𝑡). Hence, conditional on 𝑆𝑡we can write
𝑆𝑇|𝑆𝑡∼log -
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
.
Under the risk-neutral measure ℚwe can write the European call option price as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
max{𝑆𝑇−𝐾, 0}𝑓(𝑆𝑇|𝑆𝑡)𝑑𝑆𝑇.
Here, for a log normally distributed random variable log 𝑋∼(𝜇, 𝜎2) the probability
density function (pdf) is
𝑓𝑋(𝑥; 𝜇, 𝜎) =
1
𝑥𝜎
√
2𝜋
𝑒
−1
2
( log𝑥−𝜇
𝜎
)2
, 𝑥> 0

2.2.2 Black–Scholes Model
103
and we can thus write
𝑓(𝑆𝑇|𝑆𝑡
) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log 𝑆𝑇−log 𝑆𝑡−(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
, 𝑆𝑇> 0
or
𝑓(𝑆𝑇|𝑆𝑡
) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log 𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
)2
, 𝑆𝑇> 0
where 𝑚= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡). Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∫
𝐾
0
max{𝑆𝑇−𝐾, 0}𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
max{𝑆𝑇−𝐾, 0}𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑆𝑇−𝐾)𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
= 𝐼1 −𝐼2
where
𝐼1 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑆𝑇𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
and
𝐼2 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝐾𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇.
Solving 𝐼1 we have
𝐼1 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑆𝑇𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log 𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
)2
𝑑𝑆𝑇
and by letting 𝑢= log𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
we then have
𝐼1 = 𝑒𝑚−𝑟(𝑇−𝑡)
√
2𝜋
∫
∞
log 𝐾−𝑚
𝜎
√
𝑇−𝑡
𝑒−1
2 𝑢2+𝜎𝑢
√
𝑇−𝑡𝑑𝑢.
Using the sum of squares
−1
2𝑢2 + 𝜎𝑢
√
𝑇−𝑡= −1
2
[(
𝑢−𝜎
√
𝑇−𝑡
)2
−𝜎2(𝑇−𝑡)
]

104
2.2.2 Black–Scholes Model
we can simplify 𝐼1 to become
𝐼1 = 𝑒𝑚−𝑟(𝑇−𝑡)
√
2𝜋
∫
∞
log 𝐾−𝑚
𝜎
√
𝑇−𝑡
𝑒
−1
2
[(
𝑢−𝜎
√
𝑇−𝑡
)2
−𝜎2(𝑇−𝑡)
]
𝑑𝑢
= 𝑒𝑚−𝑟(𝑇−𝑡)+ 1
2 𝜎2(𝑇−𝑡)
∫
∞
log𝐾−𝑚
𝜎
√
𝑇−𝑡
1
√
2𝜋
𝑒
−1
2
(
𝑢−𝜎
√
𝑇−𝑡
)2
𝑑𝑢.
By setting 𝑣= 𝑢−𝜎
√
𝑇−𝑡and substituting 𝑚= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) we
eventually have
𝐼1 = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Similarly for 𝐼2 we have
𝐼2 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝐾𝑓(𝑆𝑇) 𝑑𝑆𝑇
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
)2
𝑑𝑆𝑇
and by setting 𝑢= log 𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
and substituting 𝑚= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
𝐼2 = 𝑒−𝑟(𝑇−𝑡)𝐾∫
∞
log 𝐾−𝑚
𝜎
√
𝑇−𝑡
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢
= 𝐾𝑒−𝑟(𝑇−𝑡)
[
1 −Φ
(
log𝐾−𝑚
𝜎
√
𝑇−𝑡
)]
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (𝑑+
) −𝐾𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)

2.2.2 Black–Scholes Model
105
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2) (𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Using the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
the European put option is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑆𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐾𝑒−𝑟(𝑇−𝑡)
= −𝑆𝑡𝑒−𝐷(𝑇−𝑡) [1 −Φ(𝑑+)] + 𝐾𝑒−𝑟(𝑇−𝑡) [1 −Φ(𝑑−)]
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+).
6. Martingale Property. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, let 𝑟be the risk-free interest rate.
We define the price of a European call option priced at time 𝑡with strike price 𝐾and
expiry time 𝑇, 𝑡< 𝑇as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(⋅) is the cdf of a standard normal.
Show that 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a martingale under the risk-neutral measure ℚ.
Solution: Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.

106
2.2.2 Black–Scholes Model
Using It¯o’s lemma we can easily show for 𝑇> 𝑡
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
with density function for 𝑆𝑇
𝑓(𝑆𝑇|𝑆𝑡) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log(𝑆𝑇∕𝑆𝑡)−(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
.
To show that 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a ℚ-martingale we note the following.
(a) For 𝑡< 𝜏< 𝑇and by setting 𝑑𝜏
± =
log(𝑆𝜏∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝜏)
𝜎
√
𝑇−𝜏
𝔼ℚ[𝑒−𝑟𝜏𝐶(𝑆𝜏, 𝜏; 𝐾, 𝑇)|| ℱ𝑡
] = 𝔼ℚ[𝑒−𝑟𝜏{𝑆𝜏𝑒−𝐷(𝑇−𝜏)Φ(𝑑𝜏
+)
−𝐾𝑒−𝑟(𝑇−𝜏)Φ(𝑑𝜏
−)}||| ℱ𝑡
]
= 𝑒−𝑟𝜏−𝐷(𝑇−𝜏)𝔼ℚ[
𝑆𝜏Φ(𝑑𝜏
+)||| ℱ𝑡
]
−𝐾𝑒−𝑟𝑇𝔼ℚ[Φ(𝑑𝜏
−)|| ℱ𝑡
]
= 𝐼1 −𝐼2
where 𝐼1 = 𝑒−𝑟𝜏−𝐷(𝑇−𝜏)𝔼ℚ[
𝑆𝜏Φ(𝑑𝜏
+)||| ℱ𝑡
]
and 𝐼2 = 𝐾𝑒−𝑟𝑇𝔼ℚ[Φ(𝑑𝜏
−)|| ℱ𝑡
].
For the case
𝐼1 = 𝑒−𝑟𝜏−𝐷(𝑇−𝜏)𝔼ℚ[
𝑆𝜏Φ(𝑑𝜏
+)||| ℱ𝑡
]
= 𝑒−𝑟𝜏−𝐷(𝑇−𝜏)
× ∫
∞
0
𝑆𝜏Φ
(log(𝑆𝜏∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝜏)
𝜎
√
𝑇−𝜏
)
𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
and by setting 𝑥=
log(𝑆𝜏∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝜏−𝑡)
𝜎
√
𝜏−𝑡
we have
𝐼1 = 𝑆𝑡𝑒−𝑟𝜏−𝐷(𝑇−𝜏)+(𝑟−𝐷−1
2 𝜎2)(𝜏−𝑡)
× ∫
∞
−∞
Φ
(
𝑚+ 𝑥𝜎
√
𝜏−𝑡
𝜎
√
𝑇−𝜏
)
1
√
2𝜋
𝑒−1
2 (𝑥2−2𝑥𝜎
√
𝜏−𝑡)𝑑𝑥

2.2.2 Black–Scholes Model
107
or
𝐼1 = 𝑆𝑡𝑒−𝑟𝜏−𝐷(𝑇−𝜏)+(𝑟−𝐷)(𝜏−𝑡)
× ∫
∞
−∞
Φ
(
𝑚+ 𝑥𝜎
√
𝜏−𝑡
𝜎
√
𝑇−𝜏
)
1
√
2𝜋
𝑒−1
2 (𝑥−𝜎
√
𝜏−𝑡)2𝑑𝑥
where 𝑚= log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝜏) + (𝑟−𝐷−1
2𝜎2)(𝜏−𝑡).
By setting 𝑦= 𝑥−𝜎
√
𝜏−𝑡we have
𝐼1 = 𝑆𝑡𝑒−𝑟𝜏−𝐷(𝑇−𝜏)+(𝑟−𝐷)(𝜏−𝑡)
× ∫
∞
−∞
Φ
(
𝑚+ 𝜎2(𝜏−𝑡) + 𝑦𝜎
√
𝜏−𝑡
𝜎
√
𝑇−𝜏
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
or
𝐼1 = 𝑆𝑡𝑒−𝑟𝜏−𝐷(𝑇−𝑡)
∫
∞
−∞
Φ
(
𝑑+ + 𝜌𝑦
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
where 𝜌=
√
𝜏−𝑡
𝑇−𝑡. From Problem 1.2.2.14 of Problems and Solutions in Mathemat-
ical Finance, Volume 1: Stochastic Calculus we can deduce
𝐼1 = 𝑆𝑡𝑒−𝑟𝑡−𝐷(𝑇−𝑡)𝚽(∞, 𝑑+, −𝜌)
= 𝑆𝑡𝑒−𝑟𝑡−𝐷(𝑇−𝑡)Φ(𝑑+)
where 𝑑+ =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
In contrast, for
𝐼2 = 𝐾𝑒−𝑟𝑇𝔼ℚ[Φ(𝑑𝜏
−)|| ℱ𝑡
]
= 𝐾𝑒−𝑟𝑇
∫
∞
0
Φ
(log(𝑆𝜏∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝜏)
𝜎
√
𝑇−𝜏
)
𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏

108
2.2.2 Black–Scholes Model
and by setting 𝑥=
log(𝑆𝜏∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝜏−𝑡)
𝜎
√
𝜏−𝑡
we have
𝐼2 = 𝐾𝑒−𝑟𝑇
× ∫
∞
−∞
Φ
⎛
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡) + 𝑥𝜎
√
𝜏−𝑡
𝜎
√
𝑇−𝜏
⎞
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥
= 𝐾𝑒−𝑟𝑇
∫
∞
−∞
Φ
(
𝑑−+ 𝜌𝑥
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥
= 𝐾𝑒−𝑟𝑇𝚽(∞, 𝑑−, −𝜌)
= 𝐾𝑒−𝑟𝑇Φ(𝑑−)
where 𝜌=
√
𝜏−𝑡
𝑇−𝑡and 𝑑−=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Therefore,
𝔼ℚ[𝑒−𝑟𝜏𝐶(𝑆𝜏, 𝜏; 𝐾, 𝑇)|| ℱ𝑡
] = 𝑒−𝑟𝑡[𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)]
= 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇).
(b) Since ||𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)|| = 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and because 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 𝑆𝑡< ∞
therefore
𝔼ℚ[||𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)||
] = 𝔼ℚ[𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)] < 𝑒−𝑟𝑡𝑆𝑡< ∞.
(c) Given that 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a function of 𝑆𝑡, hence it is ℱ𝑡-adapted.
From the results of (a) – (c) we have shown that 𝑒−𝑟𝑡𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a ℚ-martingale.
N.B. Using the same steps we can also show that 𝑒−𝑟𝑡𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a ℚ-martingale where
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European put option price with strike 𝐾and expiry time 𝑇where the
stock pays a continuous dividend yield.
7. Invariance Property I. Let the price of a European option 𝑉(𝑆𝑡, 𝑡) satisfy the Black–
Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝑆𝑡is the spot price of a stock at time 𝑡, 𝜎is the stock volatility, 𝑟is the constant
risk-free interest rate, 𝐷is the continuous dividend yield and 𝑇is the option expiry time.
Show that 𝑉(𝜆𝑆𝑡, 𝑡) is also a solution of the Black–Scholes equation for 𝜆> 0.
Give a financial interpretation of this property.

2.2.2 Black–Scholes Model
109
Solution: Let 𝑊(𝑆𝑡, 𝑡) = 𝑉(𝜆𝑆𝑡, 𝑡) and by setting ̂𝑆𝑡= 𝜆𝑆𝑡we have
𝜕𝑊
𝜕𝑡
= 𝜕𝑉
𝜕𝑡, 𝜕𝑊
𝜕𝑆𝑡
= 𝜕𝑉
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
= 𝜆𝜕𝑉
𝜕̂𝑆𝑡
𝜕2𝑊
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝜕𝑊
𝜕𝑆𝑡
)
=
𝜕
𝜕𝑆𝑡
(
𝜆𝜕𝑉
𝜕̂𝑆𝑡
)
= 𝜆𝜕2𝑉
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
= 𝜆2 𝜕2𝑉
𝜕̂𝑆2
𝑡
.
By substituting the above expressions into
𝜕𝑊
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑊
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑊
𝜕𝑆𝑡
−𝑟𝑊(𝑆𝑡, 𝑡)
we have
𝜕𝑊
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑊
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑊
𝜕𝑆𝑡
−𝑟𝑊(𝑆𝑡, 𝑡)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝜆2𝑆2
𝑡
𝜕2𝑉
𝜕̂𝑆2
𝑡
+ (𝑟−𝐷)𝜆𝑆𝑡
𝜕𝑉
𝜕̂𝑆𝑡
−𝑟𝑉( ̂𝑆𝑡, 𝑡)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2 ̂𝑆2
𝑡
𝜕2𝑉
𝜕̂𝑆2
𝑡
+ (𝑟−𝐷) ̂𝑆𝑡
𝜕𝑉
𝜕̂𝑆𝑡
−𝑟𝑉( ̂𝑆𝑡, 𝑡)
= 0.
Thus, the Black–Scholes equation is invariant under the change of variable ̂𝑆𝑡= 𝜆𝑆𝑡
for 𝜆> 0.
Given that both 𝑉(𝑆𝑡, 𝑡) and 𝑉(𝜆𝑆𝑡, 𝑡), 𝜆> 0 satisfy the Black–Scholes equation, the
price of a European option scales with the underlying stock price.
8. Invariance Property II. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) denote the Black–Scholes formula at time 𝑡for
a European option with expiry 𝑇, 𝑇> 𝑡, strike 𝐾, given 𝑆𝑡is the spot price of a stock at
time 𝑡, 𝜎is the stock volatility, 𝐷is the continuous dividend yield, and let 𝑟be the constant
risk-free interest rate.
Prove that for any constant 𝛼> 0,
𝑉𝑏𝑠(𝛼𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛼𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾∕𝛼, 𝑇).
Solution: By definition
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛿=
{
+1
for European call option
−1
for European put option.

110
2.2.2 Black–Scholes Model
For any constant 𝛼> 0,
𝑉𝑏𝑠(𝛼𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛼𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
𝑑± =
log(𝛼𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
=
log(𝑆𝑡∕(𝐾∕𝛼)) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Thus,
𝑉𝑏𝑠(𝛼𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛼[𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿(𝐾∕𝛼)𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)]
= 𝛼𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾∕𝛼, 𝑇).
N.B. For example in a one-for-two stock split (holder of one share before the split will hold
two shares after the split), with the introduction of new shares the value of the stock price
and the strike price will be scaled by half. Thus, the value of the option prices will also be
halved.
9. Higher Derivatives Property. We consider the value of a European option 𝑉(𝑆𝑡, 𝑡) satisfy-
ing the following Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝑆𝑡is the spot price of a stock at time 𝑡, 𝜎is the stock volatility, 𝑟is the constant
risk-free interest rate, 𝐷is the continuous dividend yield and 𝑇> 𝑡is the option expiry
time.
Using mathematical induction show that
𝑊(𝑛)(𝑆𝑡, 𝑡) = 𝑆𝑛
𝑡
𝜕𝑛𝑉
𝜕𝑆𝑛
𝑡
also satisfy the Black–Scholes equation for any 𝑛= 1, 2, …
Solution: Let 𝑊(𝑛)(𝑆𝑡, 𝑡) = 𝑆𝑛
𝑡
𝜕𝑛𝑉
𝜕𝑆𝑛
𝑡
, 𝑛= 1, 2, …
For 𝑛= 1 we have 𝑊(1)(𝑆𝑡, 𝑡) = 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
and by differentiation
𝜕𝑊(1)
𝜕𝑡
= 𝑆𝑡
𝜕
𝜕𝑡
(
𝜕𝑉
𝜕𝑆𝑡
)
,
𝑆𝑡
𝜕𝑊(1)
𝜕𝑆𝑡
= 𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
= 𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)

2.2.2 Black–Scholes Model
111
and
𝑆2
𝑡
𝜕2𝑊(1)
𝜕𝑆2
𝑡
= 𝑆2
𝑡
[
𝜕
𝜕𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)]
= 2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 𝑆3
𝑡
𝜕3𝑉
𝜕𝑆3
𝑡
= 𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)
.
Substituting 𝜕𝑊(1)
𝜕𝑡
, 𝑆𝑡
𝜕𝑊(1)
𝜕𝑆𝑡
and 𝑆2
𝑡
𝜕2𝑊(1)
𝜕𝑆2
𝑡
into
𝜕𝑊(1)
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑊(1)
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑊(1)
𝜕𝑆𝑡
−𝑟𝑊(1)(𝑆𝑡, 𝑡)
we have
𝜕𝑊(1)
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑊(1)
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑊(1)
𝜕𝑆𝑡
−𝑟𝑊(1)(𝑆𝑡, 𝑡)
= 𝑆𝑡
𝜕
𝜕𝑡
(
𝜕𝑉
𝜕𝑆𝑡
)
+ 1
2𝜎2𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
)
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
−𝑟𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
= 𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0.
Hence, 𝑊(1)(𝑆𝑡, 𝑡) = 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
is a solution of the Black–Scholes equation.
Assume that 𝑊(𝑛)(𝑆𝑡, 𝑡) = 𝑆𝑛
𝑡
𝜕𝑛𝑉
𝜕𝑆𝑛
𝑡
is also a solution of the Black–Scholes equation such
that
𝑆𝑛
𝑡
𝜕
𝜕𝑆𝑛
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0.
For the case of 𝑊(𝑛+1)(𝑆𝑡, 𝑡) = 𝑆𝑛+1
𝑡
𝜕𝑛+1𝑉
𝜕𝑆𝑛+1
𝑡
we first differentiate
𝜕
𝜕𝑆𝑡
[
𝑆𝑛
𝑡
𝜕
𝜕𝑆𝑛
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)]
= 0

112
2.2.2 Black–Scholes Model
and we then have
𝑛𝑆𝑛−1
𝑡
𝜕𝑛
𝜕𝑆𝑛
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
+𝑆𝑛𝜕𝑛+1
𝜕𝑆𝑛+1
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0.
By multiplying the above equation with 𝑆𝑡we obtain
𝑛𝑆𝑛
𝑡
𝜕𝑛
𝜕𝑆𝑛
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
+𝑆𝑛+1 𝜕𝑛+1
𝜕𝑆𝑛+1
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0
and since
𝑆𝑛
𝑡
𝜕
𝜕𝑆𝑛
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0
we therefore have
𝑆𝑛+1 𝜕𝑛+1
𝜕𝑆𝑛+1
𝑡
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0.
Hence, 𝑊(𝑛+1)(𝑆𝑡, 𝑡) = 𝑆𝑛+1
𝑡
𝜕𝑛+1𝑉
𝜕𝑆𝑛+1
𝑡
is also a solution of the Black–Scholes equation.
Thus, from mathematical induction we have shown that 𝑆𝑛
𝑡
𝜕𝑛𝑉
𝜕𝑆𝑛
𝑡
satisfies the Black–
Scholes equation for 𝑛= 1, 2, …
10. Let the Black–Scholes equation for the price of a European option 𝑉(𝑆𝑡, 𝑡) on an underly-
ing asset priced 𝑆𝑡at time 𝑡be
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝜎is the constant volatility, 𝑟is the constant risk-free interest rate and 𝐷is the con-
stant dividend yield.

2.2.2 Black–Scholes Model
113
Show that if
𝑉(𝑆𝑡, 𝑡) = 𝑓(𝑆𝑡)𝑔(𝑡)
then
𝑔′(𝑡)
𝑔(𝑡) = −
[ 1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −𝑟𝑓(𝑆𝑡)
𝑓(𝑆𝑡)
]
.
Explain why 𝑔and 𝑓satisfy the following ordinary differential equations (ODEs)
𝑔′(𝑡) −𝜆𝑔(𝑡) = 0
and
1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −(𝑟−𝜆)𝑓(𝑆𝑡) = 0
for a constant 𝜆.
Hence, conditional on 𝜆find all solutions of the Black–Scholes equation.
Solution: If 𝑉(𝑆𝑡, 𝑡) can be separated as a product 𝑉(𝑆𝑡, 𝑡) = 𝑓(𝑆𝑡)𝑔(𝑡) then
𝜕𝑉
𝜕𝑡= 𝑓(𝑆𝑡)𝑔′(𝑡),
𝜕𝑉
𝜕𝑆𝑡
= 𝑓′(𝑆𝑡)𝑔(𝑡)
and
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝑓′′(𝑆𝑡)𝑔(𝑡)
and by substituting them into the Black–Scholes equation we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
= 𝑓(𝑆𝑡)𝑔′(𝑡) + 1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡)𝑔(𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡)𝑔(𝑡) −𝑟𝑓(𝑆𝑡)𝑔(𝑡)
= 𝑓(𝑆𝑡)𝑔′(𝑡) + 𝑔(𝑡)
[1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −𝑟𝑓(𝑆𝑡)
]
= 0.
Hence,
𝑔′(𝑡)
𝑔(𝑡) = −
[ 1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −𝑟𝑓(𝑆𝑡)
𝑓(𝑆𝑡)
]
.
Given that the left-hand side of the equation is a function of 𝑡whilst the right-hand side is
a function of 𝑆𝑡, both equations must be equal to a constant 𝜆. Thus,
𝑔′(𝑡) −𝜆𝑔(𝑡) = 0

114
2.2.2 Black–Scholes Model
and
1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −(𝑟−𝜆) 𝑓(𝑆𝑡) = 0.
For the first-order ODE 𝑔′(𝑡) −𝜆𝑔(𝑡) = 0, by setting the integrating factor
𝐼= 𝑒−∫𝜆𝑑𝑡= 𝑒−𝜆𝑡
we have
𝑑
𝑑𝑡
(𝑒−𝜆𝑡𝑔(𝑡)) = 0
or
𝑔(𝑡) = 𝐶𝑔𝑒𝜆𝑡
where 𝐶𝑔is a constant value.
As for solving 1
2𝜎2𝑆2
𝑡𝑓′′(𝑆𝑡) + (𝑟−𝐷)𝑆𝑡𝑓′(𝑆𝑡) −(𝑟−𝜆)𝑓(𝑆𝑡) = 0, which is a second-
order ODE, we let 𝑓(𝑆𝑡) = 𝐶𝑆𝑚
𝑡where 𝐶is a constant. By substituting
𝑓(𝑆𝑡) = 𝐶𝑆𝑚
𝑡, 𝑓′(𝑆𝑡) = 𝑚𝐶𝑆𝑚−1
𝑡
and
𝑓′′(𝑆𝑡) = 𝑚(𝑚−1)𝐶𝑆𝑚−2
𝑡
we eventually have
1
2𝜎2𝑚2 + (𝑟−𝐷−1
2𝜎2)𝑚−(𝑟−𝜆) = 0.
Hence, by solving the above quadratic equation
𝑚=
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2(𝑟−𝜆)
𝜎2
where we need to consider three cases of roots of 𝑚.
First, if 𝜆< 𝑟+
1
2𝜎2 (𝑟−𝐷−1
2𝜎2)2 then the solution of the ODE is of the form
𝑓(𝑆𝑡) = 𝐴𝑓𝑆𝑚+
𝑡
+ 𝐵𝑓𝑆𝑚−
𝑡
where
𝑚+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2(𝑟−𝜆)
𝜎2
> 0
𝑚−=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2(𝑟−𝜆)
𝜎2
< 0

2.2.2 Black–Scholes Model
115
and 𝐴𝑓, 𝐵𝑓are unknown constants. Thus,
𝑉(𝑆𝑡, 𝑡) = 𝑓(𝑆𝑡)𝑔(𝑡) = 𝐶1𝑒𝜆𝑡𝑆𝑚+
𝑡
+ 𝐶2𝑒𝜆𝑡𝑆𝑚−
𝑡
where 𝐶1 = 𝐴𝑓𝐶𝑔and 𝐶2 = 𝐵𝑓𝐶𝑔.
Second, if 𝜆= 𝑟+
1
2𝜎2
(
𝑟−𝐷−1
2𝜎2)2
then
𝑓(𝑆𝑡) = 𝐶𝑓𝑆𝑚
𝑡
where 𝑚= −1
𝜎2 (𝑟−𝐷−1
2𝜎2) and 𝐶𝑓is a constant. Therefore,
𝑉(𝑆𝑡, 𝑡) = 𝑓(𝑆𝑡)𝑔(𝑡) = 𝐶𝑒𝜆𝑡𝑆𝑚
𝑡
where 𝐶= 𝐶𝑓𝐶𝑔.
Third, if 𝜆> 𝑟+
1
2𝜎2 (𝑟−𝐷−1
2𝜎2)2 then we have complex roots for 𝑚so that
𝑓(𝑆𝑡) = 𝐾1𝑆𝛼+𝑖𝛽
𝑡
+ 𝐾2𝑆𝛼−𝑖𝛽
𝑡
where 𝛼= −1
𝜎2 (𝑟−𝐷−1
2𝜎2), 𝛽= 1
𝜎2
√
−(𝑟−𝐷−1
2𝜎2)2 −2𝜎2(𝑟−𝜆) and 𝐾1, 𝐾2 are
constants.
From the identity 𝑒𝑖𝜃= cos 𝜃+ 𝑖sin 𝜃we can write the solution of the second-order
ODE as
𝑓(𝑆𝑡) = 𝐶(1)
𝑓𝑆𝛼
𝑡cos (𝛽log 𝑆𝑡
) + 𝐶(2)
𝑓𝑆𝛼
𝑡sin (𝛽log 𝑆𝑡
)
where 𝐶(1)
𝑓
and 𝐶(2)
𝑓
are constants. Therefore,
𝑉(𝑆𝑡, 𝑡) = 𝑓(𝑆𝑡)𝑔(𝑡) = 𝐶1𝑒𝜆𝑡𝑆𝛼
𝑡cos (𝛽log 𝑆𝑡
) + 𝐶2𝑒𝜆𝑡𝑆𝛼
𝑡sin (𝛽log 𝑆𝑡
)
where 𝐶1 = 𝐶(1)
𝑓𝐶𝑔and 𝐶2 = 𝐶(2)
𝑓𝐶𝑔.
11. Discrete Dividends I – Escrowed Dividend Model. We consider at time 𝑡a European option
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾written on a stock priced at 𝑆𝑡paying a dividend 𝛿at time 𝑡𝛿,
𝑡𝛿< 𝑇where 𝑇> 𝑡is the option expiry time.
Using no-arbitrage arguments explain why
𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿,
0 ≤𝛿≤𝑆𝑡−
𝛿
𝑉(𝑆𝑡−
𝛿, 𝑡−
𝛿; 𝐾, 𝑇) = 𝑉(𝑆𝑡−
𝛿−𝛿, 𝑡+
𝛿; 𝐾, 𝑇)
where 𝑡−
𝛿and 𝑡+
𝛿are the time immediately before and after the dividend is paid, respectively.

116
2.2.2 Black–Scholes Model
Hence, deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡−𝛿𝑒−𝑟(𝑡𝛿−𝑡), 𝑡; 𝐾, 𝑇)
if 0 < 𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a European option with strike 𝐾and expiry time 𝑇written on a
non-dividend-paying stock 𝑆𝑡satisfying the Black–Scholes equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
max{𝑆𝑇−𝐾, 0}
if option is a call
max{𝐾−𝑆𝑇, 0}
if option is a put
where 𝜎is the stock volatility and 𝑟is the risk-free interest rate.
Finally, deduce that if there are 𝑛> 1 dividends 𝛿1, 𝛿2, … , 𝛿𝑛to be paid by the stock at
time 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛, respectively where 𝑡< 𝑡𝛿1 and 𝑡𝛿𝑛< 𝑇then
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉𝑏𝑠
(
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝛿𝑖−𝑡), 𝑡; 𝐾, 𝑇
)
if 0 ≤𝑡< 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿𝑛< 𝑡≤𝑇.
Solution: At time 𝑡𝛿the stock pays out a discrete dividend 𝛿and to ensure there is no
arbitrage opportunity we need to show
𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿.
Assume that 𝑆𝑡+
𝛿< 𝑆𝑡−
𝛿−𝛿then we can sell the stock at 𝑡= 𝑡−
𝛿, forfeiting the dividend at
time 𝑡= 𝑡𝛿, and buy back the stock at time 𝑡+
𝛿. Hence, the profit is
Profit = 𝑆𝑡−
𝛿−𝛿−𝑆𝑡+
𝛿> 0
which is an arbitrage opportunity.
In contrast, if 𝑆𝑡+
𝛿> 𝑆𝑡−
𝛿−𝛿then the strategy is to buy the stock at 𝑡= 𝑡−
𝛿, collecting the
dividend at time 𝑡= 𝑡𝛿and selling it afterwards. Thus, the profit is
Profit = −𝑆𝑡−
𝛿+ 𝛿+ 𝑆𝑡+
𝛿> 0
which is also an arbitrage opportunity. Hence, 𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿and since 𝑆𝑡+
𝛿≥0 therefore
0 ≤𝛿≤𝑆𝑡−
𝛿.

2.2.2 Black–Scholes Model
117
Given that the option holder does not receive the dividend, the option value cannot jump
across time 𝑡𝛿. Therefore,
𝑉(𝑆𝑡−
𝛿, 𝑡−
𝛿; 𝐾, 𝑇) = 𝑉(𝑆𝑡+
𝛿, 𝑡+
𝛿; 𝐾, 𝑇).
That is, the value of the option is the same immediately before the dividend date as well
as immediately after the dividend date. Thus, the option price remains continuous in 𝑆𝑡𝛿
even though 𝑆𝑡𝛿is not continuous.
Since 𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿therefore
𝑉(𝑆𝑡−
𝛿, 𝑡−
𝛿; 𝐾, 𝑇) = 𝑉(𝑆𝑡−
𝛿−𝛿, 𝑡+
𝛿; 𝐾, 𝑇).
If the option is priced at time 0 ≤𝑡< 𝑡𝛿then at expiry 𝑇
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑇−𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇; 𝐾, 𝑇)
since 𝛿being paid at time 𝑡𝛿will grow at a risk-free interest rate 𝑟.
In contrast, if the option is priced at 𝑡> 𝑡𝛿and because no dividends are paid thereafter,
the option payoff at time 𝑇is 𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇). Therefore, by discount-
ing the option payoff back to time 𝑡we can write
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡−𝛿𝑒−𝑟(𝑡𝛿−𝑡), 𝑡; 𝐾, 𝑇)
if 0 ≤𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇.
Finally, for the case when we have 𝑛> 1 dividends, we use an iterative method to prove
the desired results.
For the case when 𝑡𝛿𝑛< 𝑡< 𝑇and because there are no more dividends being paid, we
have
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
For 𝑡< 𝑡𝛿𝑛< 𝑇and given that a dividend 𝛿𝑛is paid at time 𝑡𝛿𝑛, then
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡−𝛿𝑛𝑒−𝑟(𝑡𝛿𝑛−𝑡), 𝑡; 𝐾, 𝑇)
with spot price reset to ̃𝑆𝑡= 𝑆𝑡−𝛿𝑛𝑒−𝑟(𝑡𝛿𝑛−𝑡).
When 𝑡< 𝑡𝛿𝑛−1 < 𝑡𝛿𝑛< 𝑇then, following the same arguments as before
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠( ̃𝑆𝑡−𝛿𝑛−1𝑒−𝑟(𝑡𝛿𝑛−1−𝑡), 𝑡; 𝐾, 𝑇)
= 𝑉𝑏𝑠(𝑆𝑡−𝛿𝑛−1𝑒−𝑟(𝑡𝛿𝑛−1−𝑡) −𝛿𝑛𝑒−𝑟(𝑡𝛿𝑛−𝑡), 𝑡; 𝐾, 𝑇)
with spot price now reset to ̃𝑆𝑡= 𝑆𝑡−𝛿𝑛−1𝑒−𝑟(𝑡𝛿𝑛−1−𝑡) −𝛿𝑛𝑒−𝑟(𝑡𝛿𝑛−𝑡).

118
2.2.2 Black–Scholes Model
Hence, for the case when 𝑡< 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛< 𝑇we can deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠( ̃𝑆𝑡−𝛿1𝑒−𝑟(𝑡𝛿𝑛−1−𝑡), 𝑡; 𝐾, 𝑇)
where ̃𝑆𝑡= 𝑆𝑡−
𝑛
∑
𝑖=2
𝛿𝑖𝑒−𝑟(𝑡𝛿𝑖−𝑡). Thus,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉𝑏𝑠
(
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝛿𝑖−𝑡), 𝑡; 𝐾, 𝑇
)
if 0 ≤𝑡< 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿𝑛< 𝑡≤𝑇.
12. Discrete Dividends II – Forward Dividend Model. We consider at time 𝑡a European option
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾written on a stock 𝑆𝑡paying a dividend 𝛿at time 𝑡𝛿, 𝑡𝛿< 𝑇
where 𝑇> 𝑡is the option expiry time.
Using no-arbitrage arguments explain why
𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿,
0 ≤𝛿≤𝑆𝑡−
𝛿
𝑉(𝑆𝑡−
𝛿, 𝑡−
𝛿; 𝐾, 𝑇) = 𝑉(𝑆𝑡−
𝛿−𝛿, 𝑡+
𝛿; 𝐾, 𝑇)
where 𝑡−
𝛿and 𝑡+
𝛿are the time immediately before and after the dividend is paid, respectively.
Hence, deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾+ 𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇)
if 0 < 𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a European option with strike 𝐾and expiry time 𝑇written on a
non-dividend-paying stock 𝑆𝑡satisfying the Black–Scholes equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
max{𝑆𝑇−𝐾, 0}
if option is a call
max{𝐾−𝑆𝑇, 0}
if option is a put
where 𝜎is the stock volatility and 𝑟is the risk-free interest rate.

2.2.2 Black–Scholes Model
119
Finally, deduce that if there are 𝑛> 1 dividends 𝛿1, 𝛿2, … , 𝛿𝑛to be paid by the stock at
time 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛, respectively where 𝑡< 𝑡𝛿1 and 𝑡𝛿𝑛< 𝑇then
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉𝑏𝑠
(
𝑆𝑡, 𝑡; 𝐾+
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝛿𝑖), 𝑇
)
if 0 ≤𝑡< 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿𝑛< 𝑡≤𝑇.
Solution: See Problem 2.2.2.11 (page 115) for the first part of the solutions.
Using the same arguments as in Problem 2.2.2.11 (page 115) we note that if the option
is priced at time 0 ≤𝑡< 𝑡𝛿then at expiry time 𝑇
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑇−𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝛿𝑒𝑟(𝑇−𝑡𝛿) −𝐾, 0}
for a European call option
max {𝐾−𝑆𝑇+ 𝛿𝑒𝑟(𝑇−𝑡𝛿), 0}
for a European put option
=
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−(𝐾+ 𝛿𝑒𝑟(𝑇−𝑡𝛿)) , 0}
for a European call option
max {(𝐾+ 𝛿𝑒𝑟(𝑇−𝑡𝛿)) −𝑆𝑇, 0}
for a European put option
= 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾+ 𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇).
By discounting the option payoff back to time 𝑡, we eventually have
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾+ 𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇)
if 0 < 𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇.
Following the same iterative analysis as presented in Problem 2.2.2.11 (page 115) we can
easily deduce that for 𝑛> 1 number of dividends the option price is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉𝑏𝑠
(
𝑆𝑡, 𝑡; 𝐾+
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝛿𝑖), 𝑇
)
if 0 ≤𝑡< 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿𝑛< 𝑡≤𝑇.

120
2.2.2 Black–Scholes Model
13. Discrete Dividends III – Bos–Vandermark Model. We consider at time 𝑡a European option
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾written on a stock 𝑆𝑡paying a dividend 𝛿at time 𝑡𝛿, 𝑡𝛿< 𝑇
where 𝑇> 𝑡is the option expiry time.
Using no-arbitrage arguments explain why
𝑆𝑡+
𝛿= 𝑆𝑡−
𝛿−𝛿,
0 ≤𝛿≤𝑆𝑡−
𝛿
𝑉(𝑆𝑡−
𝛿, 𝑡−
𝛿; 𝐾, 𝑇) = 𝑉(𝑆𝑡−
𝛿−𝛿, 𝑡+
𝛿; 𝐾, 𝑇)
where 𝑡−
𝛿and 𝑡+
𝛿are the time immediately before and after the dividend is paid, respectively.
By setting 𝜆𝑡∈[0, 1], deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡−𝜆𝑡𝛿𝑒−𝑟(𝑡𝛿−𝑡), 𝑡; 𝐾+ (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇)
if 0 < 𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a European option with strike 𝐾and expiry time 𝑇written on a
non-dividend-paying stock 𝑆𝑡satisfying the Black–Scholes equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
max{𝑆𝑇−𝐾, 0}
if option is a call
max{𝐾−𝑆𝑇, 0}
if option is a put
where 𝜎is the stock volatility and 𝑟is the risk-free interest rate.
Finally, find the option price if there are 𝑛> 1 dividends 𝛿1, 𝛿2, … , 𝛿𝑛to be paid by the
stock at time 𝑡𝛿1 < 𝑡𝛿2 < ⋯< 𝑡𝛿𝑛, respectively where 𝑡< 𝑡𝛿1 and 𝑡𝛿𝑛< 𝑇, and 𝜆(𝑖)
𝑡
∈[0, 1],
𝑖= 1, 2, … , 𝑛.
Solution: See Problem 2.2.2.11 (page 115) for the first part of the solutions.
Using the same arguments as in Problems 2.2.2.11 (page 115) and 2.2.2.12 (page 118)
we note that if the option is priced at time 0 ≤𝑡< 𝑡𝛿then at expiry time 𝑇
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝑉𝑏𝑠(𝑆𝑇−𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇; 𝐾, 𝑇)
=
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝛿𝑒𝑟(𝑇−𝑡𝛿) −𝐾, 0}
for a call option
max {𝐾−𝑆𝑇+ 𝛿𝑒𝑟(𝑇−𝑡𝛿), 0}
for a put option

2.2.2 Black–Scholes Model
121
=
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝜆𝑡𝛿𝑒𝑟(𝑇−𝑡𝛿) −(1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿) −𝐾, 0}
for a call option
max {𝐾−𝑆𝑇+ 𝜆𝑡𝛿𝑒𝑟(𝑇−𝑡𝛿) + (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿), 0}
for a put option
=
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝜆𝑡𝛿𝑒𝑟(𝑇−𝑡𝛿) −(𝐾+ (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿)) , 0}
for a call option
max {(𝐾+ (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿)) −(𝑆𝑇−𝜆𝑡𝛿𝑒𝑟(𝑇−𝑡𝛿)) , 0}
for a put option
= 𝑉𝑏𝑠(𝑆𝑇−𝜆𝑡𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇; 𝐾+ (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇).
By discounting the option payoff back to time 𝑡, we eventually have
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠(𝑆𝑡−𝜆𝑡𝛿𝑒−𝑟(𝑡𝛿−𝑡), 𝑡; 𝐾+ (1 −𝜆𝑡)𝛿𝑒𝑟(𝑇−𝑡𝛿), 𝑇)
if 0 < 𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇.
Following the same iterative analysis as presented in Problem 2.2.2.11 (page 115) we
can easily deduce that for 𝑛> 1 number of dividends and 𝜆(𝑖)
𝑡
∈[0, 1], 𝑖= 1, 2, … , 𝑛, the
option price is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠
(
𝑆𝑡−
𝑛
∑
𝑖=1
𝜆(𝑖)
𝑡𝛿𝑖𝑒−𝑟(𝑡𝛿𝑖−𝑡), 𝑡; 𝐾+
𝑛
∑
𝑖=1
(1 −𝜆(𝑖)
𝑡)𝛿𝑖𝑒𝑟(𝑇−𝑡𝛿𝑖), 𝑇
)
if 0 ≤𝑡< 𝑡𝛿1 < ⋯< 𝑡𝛿𝑛and
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿𝑛< 𝑡≤𝑇.
14. Discrete Dividend Yields. We consider at time 𝑡a European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) with
strike 𝐾written on a stock 𝑆𝑡paying a discrete dividend yield 𝐷at time 𝑡𝐷, 𝑡𝐷< 𝑇where
𝑇is the option expiry time.
Using no-arbitrage arguments explain why
𝑆𝑡+
𝐷= (1 −𝐷)𝑆𝑡−
𝐷,
0 ≤𝐷≤1
𝑉(𝑆𝑡−
𝐷, 𝑡−
𝐷; 𝐾, 𝑇) = 𝑉((1 −𝐷)𝑆𝑡−
𝐷, 𝑡+
𝐷; 𝐾, 𝑇)
where 𝑡−
𝐷and 𝑡+
𝐷are the times immediately before and after the dividend yield is paid,
respectively.

122
2.2.2 Black–Scholes Model
Hence, deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠
((1 −𝐷)𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 0 ≤𝑡< 𝑡𝐷
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝐷< 𝑡≤𝑇
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a European option with strike 𝐾and expiry time 𝑇written on a
non-dividend-paying stock 𝑆𝑡satisfying the Black–Scholes equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
max{𝑆𝑇−𝐾, 0}
if option is a call
max{𝐾−𝑆𝑇, 0}
if option is a put
where 𝜎is the stock volatility and 𝑟is the risk-free interest rate.
Finally, deduce if there are 𝑛> 1 dividend yields 𝐷1, 𝐷2, … , 𝐷𝑛to be paid by the stock
at time 𝑡𝐷1 < 𝑡𝐷2 < ⋯< 𝑡𝐷𝑛, respectively where 𝑡< 𝑡𝐷1 and 𝑡𝐷𝑛< 𝑇then
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠
(𝛽𝑛𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝛽𝑛=
𝑛
∏
𝑖=1
(1 −𝐷𝑖).
Solution: At time 𝑡𝐷the stock pays out a discrete dividend 𝐷𝑆𝑡𝐷and to ensure there is no
arbitrage opportunity we need to show
𝑆𝑡+
𝐷= (1 −𝐷)𝑆𝑡−
𝐷.
Assume that 𝑆𝑡+
𝐷< (1 −𝐷)𝑆𝑡−
𝐷then an investor can sell the stock at 𝑡= 𝑡−
𝐷, forfeiting the
dividend at time 𝑡= 𝑡𝐷, and buy back the stock at time 𝑡+
𝛿. Hence, the profit is
Profit = 𝑆𝑡−
𝐷−𝐷𝑆𝑡−
𝐷−𝑆𝑡+
𝐷> 0
which is an arbitrage opportunity.
In contrast, if 𝑆𝑡+
𝐷> (1 −𝐷)𝑆𝑡−
𝐷then the investor can buy the stock at 𝑡= 𝑡−
𝐷, collecting
the dividend at time 𝑡= 𝑡𝐷and selling it afterwards. Thus, the profit is
Profit = −𝑆𝑡−
𝐷+ 𝐷𝑆𝑡−
𝐷+ 𝑆𝑡+
𝐷> 0
which is also an arbitrage opportunity. Hence, 𝑆𝑡+
𝐷= (1 −𝐷)𝑆𝑡−
𝐷and since 𝑆𝑡+
𝐷≥0 there-
fore 0 ≤𝐷𝑆𝑡−
𝐷≤𝑆𝑡−
𝐷or 0 ≤𝐷≤1.

2.2.2 Black–Scholes Model
123
Given that the option holder does not receive the dividend, the option value cannot jump
across time 𝑡𝐷. Therefore,
𝑉(𝑆𝑡−
𝐷, 𝑡−
𝐷; 𝐾, 𝑇) = 𝑉(𝑆𝑡+
𝐷, 𝑡+
𝐷; 𝐾, 𝑇).
That is, the value of the option is the same immediately before the dividend date as well
as immediately after the dividend date. Hence, the option price remains continuous in 𝑆𝑡𝐷
even though 𝑆𝑡𝐷is not continuous.
Since 𝑆𝑡+
𝐷= (1 −𝐷)𝑆𝑡−
𝐷therefore
𝑉(𝑆𝑡−
𝐷, 𝑡−
𝐷; 𝐾, 𝑇) = 𝑉((1 −𝐷)𝑆𝑡−
𝐷, 𝑡+
𝐷; 𝐾, 𝑇).
If the option is priced at time 0 < 𝑡< 𝑡𝐷then at expiry 𝑇we can set
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑉𝑏𝑠((1 −𝐷)𝑆𝑇, 𝑇; 𝐾, 𝑇).
In contrast, if the option is priced at 𝑡> 𝑡𝐷and because no dividends are paid thereafter,
the payoff at time 𝑇is 𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇).
Therefore, by discounting the option payoff back to time 𝑡we can write
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑉𝑏𝑠((1 −𝐷)𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 0 ≤𝑡< 𝑡𝛿
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑡𝛿< 𝑡≤𝑇.
Finally, for the case when we have 𝑛> 1 dividends, we use an iterative method to prove
the desired results.
For the case when 𝑡𝐷𝑛< 𝑡< 𝑇and because there are no more dividends being paid, we
have
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
For 𝑡< 𝑡𝐷𝑛< 𝑇and given that a dividend 𝐷𝑛is paid at time 𝑡𝐷𝑛, then
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠((1 −𝐷𝑛)𝑆𝑡, 𝑡; 𝐾, 𝑇)
with spot price reset to ̃𝑆𝑡= (1 −𝐷𝑛)𝑆𝑡.
When 𝑡< 𝑡𝐷𝑛−1 < 𝑡𝐷𝑛< 𝑇then, following the same arguments as before
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠((1 −𝐷𝑛−1) ̃𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑉𝑏𝑠((1 −𝐷𝑛−1)(1 −𝐷𝑛)𝑆𝑡, 𝑡; 𝐾, 𝑇)
with spot price now reset to ̃𝑆𝑡= (1 −𝐷𝑛−1)(1 −𝐷𝑛)𝑆𝑡.
Hence, for the case when 𝑡< 𝑡𝐷1 < 𝑡𝐷2 < ⋯< 𝑡𝐷𝑛< 𝑇we can deduce that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠((1 −𝐷1) ̃𝑆𝑡, 𝑡; 𝐾, 𝑇)

124
2.2.2 Black–Scholes Model
where ̃𝑆𝑡= 𝑆𝑡
𝑛
∏
𝑖=2
(1 −𝐷𝑖). Thus,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠
(
𝑆𝑡
𝑛
∏
𝑖=1
(1 −𝐷𝑖), 𝑡; 𝐾, 𝑇
)
for 𝑡< 𝑡𝐷1 < 𝑡𝐷2 < ⋯< 𝑡𝐷𝑛< 𝑇.
15. Market Price of Risk. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ). Suppose the stock price 𝑆𝑡follows the following SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter, and let 𝑟denote the risk-free interest rate.
By considering a portfolio Π𝑡holding only one option 𝑉(𝑆𝑡, 𝑡) which is only exercised
at expiry 𝑇> 𝑡and using the Black–Scholes equation show that
𝑑Π𝑡−𝑟Π𝑡𝑑𝑡= 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
(𝑑𝑊𝑡+ 𝜆𝑑𝑡)
where 𝜆= 𝜇−𝑟
𝜎
is known as the market price of risk.
Is the portfolio riskless? Interpret the function 𝜆.
Solution: At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑡)
and the change in portfolio Π𝑡becomes
𝑑Π𝑡= 𝑑𝑉.
Expanding 𝑉(𝑆𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡
)2 + …
and by substituting 𝑑𝑆𝑡= (𝜇−𝐷) 𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡and applying It¯o’s lemma we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡.

2.2.2 Black–Scholes Model
125
Hence,
𝑑Π𝑡−𝑟Π𝑡𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
]
𝑑𝑡
+𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
and from the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
we have
𝑑Π𝑡−𝑟Π𝑡𝑑𝑡= (𝜇−𝑟) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
= 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
(
𝑑𝑊𝑡+ 𝜇−𝑟
𝜎
𝑑𝑡
)
= 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
(𝑑𝑊𝑡+ 𝜆𝑑𝑡)
where 𝜆= 𝜇−𝑟
𝜎
.
Given the presence of 𝑑𝑊𝑡, the portfolio is not riskless.
By accepting a certain level of risk, 𝜆= 𝜇−𝑟
𝜎
can be interpreted as the excess return
above the risk-free interest rate.
16. Black–Scholes Model with Transaction Costs. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with
the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter, and let 𝑟be the risk-free interest rate from a money-market account.
We consider incorporating a transaction cost in buying or selling the asset which has
three components:
(i) a fixed cost at each transaction, 𝜅1
(ii) a cost proportional to the number of assets traded, 𝜅2|𝜈|
(iii) a cost proportional to the value of the assets traded, 𝜅3|𝜈|𝑆𝑡
where 𝜅1, 𝜅2, 𝜅3 > 0, 𝜈> 0 (for buying assets) and 𝜈< 0 (for selling assets).
Show that 𝔼(|𝑊𝑡|) =
√
2𝑡
𝜋.

126
2.2.2 Black–Scholes Model
By considering a hedging portfolio involving buying an option 𝑉(𝑆𝑡, 𝑡) which can only
be exercised at expiry time 𝑇> 𝑡, selling Δ numbers of asset 𝑆𝑡plus transaction costs,
using It¯o’s lemma show that after a time interval 𝛿𝑡> 0, 𝑉(𝑆𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2̃𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−̃𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) −𝜅1
𝛿𝑡= 0
where
̃𝐷= 𝐷+ 𝜅2𝜎
√
2
𝜋𝛿𝑡
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
(
𝜕𝑉
𝜕𝑆𝑡
)−1
and
̃𝜎2 = 𝜎2 −𝜅3𝜎
√
2
𝜋𝛿𝑡sgn
(
𝜕2𝑉
𝜕𝑆2
𝑡
)
such that sgn(𝑥) = 𝑥
|𝑥|.
Can the option price following a transaction cost model be negative?
Solution: For the first part of the problem, given 𝑊𝑡∼(0, 𝑡) then from Problem 1.2.2.11
of Problems and Solutions in Mathematical Finance, Volume 1: Stochastic Calculus, |𝑊𝑡|
follows a folded normal distribution, |𝑊𝑡| ∼𝑓(0, 𝑡). Therefore, 𝔼(|𝑊𝑡|) =
√
2𝑡
𝜋.
At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
where it involves buying one unit of option 𝑉(𝑆𝑡, 𝑡) and selling Δ units of 𝑆𝑡. The contin-
uous dividend yield is defined as the proportion of the asset price paid out per unit time.
At time interval 𝛿𝑡> 0, since we receive 𝐷𝑆𝑡𝛿𝑡for every asset held and the change in
transaction costs is 𝜅1 + 𝜅2|𝛿Δ| + 𝜅3|𝛿Δ|𝑆𝑡, the change in portfolio Π𝑡is
𝛿Π𝑡= 𝛿𝑉−Δ(𝛿𝑆𝑡+ 𝐷𝑆𝑡𝛿𝑡) −(𝜅1 + 𝜅2|𝛿Δ| + 𝜅3|𝛿Δ|𝑆𝑡).
Expanding 𝑉(𝑆𝑡, 𝑡) using Taylor’s theorem
𝛿𝑉= 𝜕𝑉
𝜕𝑡𝛿𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝛿𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝛿𝑆𝑡
)2 + …
and by substituting 𝛿𝑆𝑡= (𝜇−𝐷) 𝑆𝑡𝛿𝑡+ 𝜎𝑆𝑡𝛿𝑊𝑡and subsequently applying It¯o’s lemma
we have
𝛿𝑉=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝛿𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝛿𝑊𝑡.

2.2.2 Black–Scholes Model
127
Substituting back into 𝛿Π𝑡and rearranging the terms we have
𝛿Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝛿𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝛿𝑊𝑡
−Δ [(𝜇−𝐷) 𝑆𝑡𝛿𝑡+ 𝜎𝑆𝑡𝛿𝑊𝑡
] −Δ𝐷𝑆𝑡𝛿𝑡
−(𝜅1 + 𝜅2|𝛿Δ| + 𝜅3|𝛿Δ|𝑆𝑡)
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
)
𝛿𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝛿𝑊𝑡−(𝜅1 + 𝜅2|𝛿Δ| + 𝜅3|𝛿Δ|𝑆𝑡).
To eliminate the random component we choose
Δ = 𝜕𝑉
𝜕𝑆𝑡
which leads to
𝛿Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝛿𝑡−(𝜅1 + 𝜅2|𝛿Δ| + 𝜅3|𝛿Δ|𝑆𝑡).
To find |𝛿Δ| we note that
𝛿Δ = 𝜕𝑉
𝜕𝑆𝑡
(𝑆𝑡+ 𝛿𝑆𝑡, 𝑡+ 𝛿𝑡) −𝜕𝑉
𝜕𝑆𝑡
(𝑆𝑡, 𝑡)
= 𝜕𝑉
𝜕𝑆𝑡
(𝑆𝑡, 𝑡) + 𝛿𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡) + 𝛿𝑡𝜕2𝑉
𝜕𝑡𝜕𝑆𝑡
(𝑆𝑡, 𝑡) + … −𝜕𝑉
𝜕𝑆𝑡
(𝑆𝑡, 𝑡)
= 𝛿𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡) + 𝛿𝑡𝜕2𝑉
𝜕𝑡𝜕𝑆𝑡
(𝑆𝑡, 𝑡) + …
and because 𝛿𝑆𝑡= 𝜎𝑆𝑡𝜙
√
𝛿𝑡+ (𝛿𝑡) such that 𝜙∼(0, 1) we have
𝛿Δ = 𝜎𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝜙
√
𝛿𝑡+ (𝛿𝑡) ≈𝜎𝑆𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝜙
√
𝛿𝑡.
Thus, the expected number of assets bought or sold becomes
𝔼(|𝛿Δ|) = 𝜎𝑆𝑡
√
2𝛿𝑡
𝜋
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
.

128
2.2.2 Black–Scholes Model
Under the no-arbitrage condition the expected return on the amount Π𝑡invested in a risk-
free interest rate would see a growth of
𝔼(𝛿Π𝑡) = 𝑟𝔼(Π𝑡)𝛿𝑡
and hence we have
𝑟𝔼(Π𝑡)𝛿𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝛿𝑡
−(𝜅1 + 𝜅2𝔼(|𝛿Δ|) + 𝜅3𝔼(|𝛿Δ|)𝑆𝑡)
𝑟(𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
) 𝛿𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝛿𝑡
−
(
𝜅1 + 𝜅2𝜎𝑆𝑡
√
2𝛿𝑡
𝜋
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
+ 𝜅3𝜎𝑆2
𝑡
√
2𝛿𝑡
𝜋
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
)
𝑟
(
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜅1
𝛿𝑡−𝜅2𝜎𝑆𝑡
√
2
𝜋𝛿𝑡
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
−𝜅3𝜎𝑆2
𝑡
√
2
𝜋𝛿𝑡
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
and after rearranging terms we finally have the Black–Scholes equation with transaction
costs
𝜕𝑉
𝜕𝑡+ 1
2̃𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−̃𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) −𝜅1
𝛿𝑡= 0
where
̃𝐷= 𝐷+ 𝜅2𝜎
√
2
𝜋𝛿𝑡
|||||
𝜕2𝑉
𝜕𝑆2
𝑡
|||||
(
𝜕𝑉
𝜕𝑆𝑡
)−1
and
̃𝜎2 = 𝜎2 −𝜅3𝜎
√
2
𝜋𝛿𝑡sgn
(
𝜕2𝑉
𝜕𝑆2
𝑡
)
.
By considering the case when 𝜅2 = 𝜅3 = 0, the Black–Scholes equation with transaction
costs becomes
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) −𝜅1
𝛿𝑡= 0.
The solution to the above equation can be negative by setting 𝑉(𝑆𝑡, 𝑡) = −𝜅1
𝑟𝛿𝑡< 0.
17. Merton Model. Let (Ω, ℱ, ℙ) be a probability space and let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process and {𝑁𝑡: 𝑡≥0} be a Poisson process with intensity 𝜆> 0 relative to the
same filtration ℱ𝑡, 𝑡≥0. Suppose the stock price 𝑆𝑡follows a jump diffusion process with

2.2.2 Black–Scholes Model
129
the following SDE
𝑑𝑆𝑡
𝑆𝑡−= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡+ (𝐽𝑡−1)𝑑𝑁𝑡
where
𝑑𝑁𝑡=
{
1
with probability 𝜆𝑑𝑡
0
with probability 1 −𝜆𝑑𝑡
with 𝜇being the drift parameter, 𝐷the continuous dividend yield, 𝜎the volatility parameter
and 𝐽𝑡the jump size variable. Let 𝑟denote the risk-free interest rate and assume that 𝐽𝑡,
𝑊𝑡and 𝑁𝑡are mutually independent.
By considering a hedging portfolio involving both an option 𝑉(𝑆𝑡, 𝑡) which can only be
exercised at expiry time 𝑇≥𝑡and a stock 𝑆𝑡, and assuming that the jump component is
uncorrelated with the market, show that 𝑉(𝑆𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ [𝑟−𝐷−𝔼𝐽(𝐽𝑡−1)] 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
+𝜆𝔼𝐽
[𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)] = 0
where the expectation 𝔼𝐽(⋅) is taken over the jump component.
Solution: At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
where it involves buying one unit of option 𝑉(𝑆𝑡, 𝑡) and selling Δ units of 𝑆𝑡. Since we
receive 𝐷𝑆𝑡𝑑𝑡for every asset held and because we hold −Δ𝑆𝑡, our portfolio changes by
an amount Δ𝐷𝑆𝑡𝑑𝑡and therefore the change in portfolio Π𝑡is
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡) = 𝑑𝑉−Δ𝑑𝑆𝑡−Δ𝐷𝑆𝑡𝑑𝑡.
Expanding 𝑉(𝑆𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2!
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡
)2 + 1
3!
𝜕3𝑉
𝜕𝑆3
𝑡
(𝑑𝑆𝑡
)3 + …
and substituting 𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡+ (𝐽𝑡−1)𝑑𝑁𝑡where 𝑆𝑡−= 𝑆𝑡and subse-
quently applying It¯o’s lemma we have

130
2.2.2 Black–Scholes Model
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
[(𝜇−𝐷) 𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡+ (𝐽𝑡−1)𝑆𝑡𝑑𝑁𝑡
]
+ 1
2!
𝜕2𝑉
𝜕𝑆2
𝑡
[𝜎2𝑆2
𝑡𝑑𝑡+ (𝐽𝑡−1)2𝑆2
𝑡𝑑𝑁𝑡
] + 1
3!
𝜕3𝑉
𝜕𝑆3
𝑡
[(𝐽𝑡−1)3𝑆3
𝑡𝑑𝑁𝑡
] + …
=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
+
[
(𝐽𝑡−1)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 1
2!(𝐽𝑡−1)2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
3!(𝐽𝑡−1)3𝑆3
𝑡
𝜕3𝑉
𝜕𝑆3
𝑡
+ …
]
𝑑𝑁𝑡
=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
+ [𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)] 𝑑𝑁𝑡.
Substituting back into 𝑑Π𝑡and rearranging terms we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
+ [𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)] 𝑑𝑁𝑡−Δ [(𝜇−𝐷) 𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡+ (𝐽𝑡−1)𝑆𝑡𝑑𝑁𝑡
]
−Δ𝐷𝑆𝑡𝑑𝑡
=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
]
𝑑𝑡+ 𝜎𝑆𝑡
[
𝜕𝑉
𝜕𝑆𝑡
−Δ
]
𝑑𝑊𝑡
+
[
𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡) −Δ(𝐽𝑡−1)𝑆𝑡
]
𝑑𝑁𝑡.
To eliminate the random component so as to ensure the profit or loss is riskless, we choose
Δ = 𝜕𝑉
𝜕𝑆𝑡
and hence
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
+
[
𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡) −(𝐽𝑡−1)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑁𝑡.
Given that the jump component is uncorrelated with the market and under the no-arbitrage
condition, the return on the amount Π𝑡invested in a risk-free interest rate would see a
growth of
𝔼𝐽(𝑑Π𝑡) = 𝑟Π𝑡𝑑𝑡

2.2.2 Black–Scholes Model
131
and because 𝐽𝑡⟂⟂𝑁𝑡we have
𝑟Π𝑡𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
+𝔼𝐽
[
𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡) −(𝐽𝑡−1)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝔼𝐽(𝑑𝑁𝑡)
𝑟[𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
] 𝑑𝑡=
{
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜆𝔼𝐽(𝐽𝑡−1)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜆𝔼𝐽
[𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)]
}
𝑑𝑡
𝑟
[
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜆𝔼𝐽(𝐽𝑡−1) 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜆𝔼𝐽
[𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)]
and finally
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ [𝑟−𝐷−𝔼𝐽(𝐽𝑡−1)] 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
+𝜆𝔼𝐽
[𝑉(𝐽𝑡𝑆𝑡, 𝑡) −𝑉(𝑆𝑡, 𝑡)] = 0
which is the partial differentiation equation of 𝑉(𝑆𝑡, 𝑡) under the jump diffusion price pro-
cess.
18. European Option Valuation on Merton Model. Let (Ω, ℱ, ℙ) be a probability space and let
{𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process and {𝑁𝑡: 𝑡≥0} be a Poisson process with
intensity 𝜆> 0 relative to the same filtration ℱ𝑡, 𝑡≥0. Suppose the asset price 𝑆𝑡follows
a jump diffusion process with the following SDE
𝑑𝑆𝑡
𝑆𝑡−= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡+ (𝐽𝑡−1)𝑑𝑁𝑡
where
𝑑𝑁𝑡=
{
1
with probability 𝜆𝑑𝑡
0
with probability 1 −𝜆𝑑𝑡
with 𝜇being the drift parameter, 𝐷the continuous dividend yield, 𝜎the volatility parameter
and 𝐽𝑡the jump size variable which follows a log-normal distribution log 𝐽𝑡∼(𝜇𝐽, 𝜎2
𝐽).
Let 𝑟denote the risk-free interest rate and assume that 𝐽𝑡, 𝑊𝑡and 𝑁𝑡are mutually
independent.

132
2.2.2 Black–Scholes Model
By assuming that the jump component is uncorrelated with the market, using It¯o’s for-
mula show that under the equivalent martingale measure ℚ𝑀the conditional distribution
of 𝑆𝑇given 𝑆𝑡and 𝑁𝑇−𝑡= 𝑛, 𝑛= 0, 1, 2, … and 𝑡< 𝑇can be expressed as
log 𝑆𝑇||
{𝑆𝑡, 𝑁𝑇−𝑡= 𝑛} ∼
[
log 𝑆𝑡+
(
𝑟−̃𝐷−1
2̃𝜎2)
(𝑇−𝑡), ̃𝜎2(𝑇−𝑡)
]
where ̃𝐷= 𝐷+ 𝜆
(
𝑒𝜇𝐽+ 1
2 𝜎2
𝐽−1
)
−
𝑛
𝑇−𝑡
(
𝜇𝐽+ 1
2𝜎2
𝐽
)
and ̃𝜎2 = 𝜎2 +
𝑛𝜎2
𝐽
𝑇−𝑡.
Hence, show that the European call option price at time 𝑡≤𝑇with strike 𝐾> 0 and
expiry time 𝑇is
𝐶𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∞
∑
𝑛=0
𝑒−𝜆(𝑇−𝑡)[𝜆(𝑇−𝑡)]𝑛
𝑛!
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−̃𝐷(𝑇−𝑡)Φ( ̃𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ( ̃𝑑−)
such that ̃𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−̃𝐷± 1
2̃𝜎2)(𝑇−𝑡)
̃𝜎
√
𝑇−𝑡
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: From Problem 5.2.4.4 of Problems and Solutions in Mathematical Finance, Vol-
ume 1: Stochastic Calculus, under the equivalent martingale measure ℚ𝑀we can express
the jump diffusion process as
𝑑𝑆𝑡
𝑆𝑡−= (𝑟−𝐷−𝜆( ̄𝐽−1)) 𝑑𝑡+ 𝜎𝑑̃
𝑊𝑡+ (𝐽𝑡−1)𝑑𝑁𝑡
where
̄𝐽= 𝔼ℙ(𝐽𝑡) = 𝑒𝜇𝐽+ 1
2 𝜎2
𝐽,
̃
𝑊𝑡= 𝑊𝑡−
(𝜇−𝑟+ 𝜆( ̄𝐽−1)
𝜎
)
𝑡is a ℚ𝑀-standard
Wiener process and 𝑁𝑡∼Poisson(𝜆𝑡).
Using the results of Problem 5.2.2.3 of Problems and Solutions in Mathematical
Finance, Volume 1: Stochastic Calculus we can write
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−𝜆( ̄𝐽−1)−1
2 𝜎2)(𝑇−𝑡)+𝜎̃
𝑊𝑇−𝑡
𝑁𝑇−𝑡
∏
𝑖=1
𝐽𝑖
where 𝐽𝑖∼log-(𝜇𝐽, 𝜎2
𝐽), 𝑖= 1, 2, … , 𝑁𝑇−𝑡is a sequence of independent and iden-
tically distributed random variables and ̃
𝑊𝑇−𝑡∼(0, 𝑇−𝑡). By independence of 𝐽𝑖,
𝑖= 1, 2, … , 𝑁𝑇−𝑡, ̃
𝑊𝑇−𝑡and 𝑁𝑇−𝑡we have
log 𝑆𝑇||
{𝑆𝑡, 𝑁𝑇−𝑡= 𝑛} ∼
[
log 𝑆𝑡+
(
𝑟−𝐷−𝜆
(
𝑒𝜇𝐽+ 1
2 𝜎2
𝐽−1
)
−1
2𝜎2)
(𝑇−𝑡)
+𝑛𝜇𝐽, 𝜎2(𝑇−𝑡) + 𝑛𝜎2
𝐽
] .

2.2.2 Black–Scholes Model
133
By setting
log 𝑆𝑇||
{𝑆𝑡, 𝑁𝑇−𝑡= 𝑛} ∼
[
log 𝑆𝑡+
(
𝑟−̃𝐷−1
2̃𝜎2)
(𝑇−𝑡), ̃𝜎2(𝑇−𝑡)
]
where ̃𝐷and ̃𝜎are the “continuous dividend” and “volatility” of the asset price 𝑆𝑡follow-
ing a GBM process we can therefore set
(
𝑟−̃𝐷−1
2̃𝜎2)
(𝑇−𝑡) =
(
𝑟−𝐷−𝜆
(
𝑒𝜇𝐽+ 1
2 𝜎2
𝐽−1
)
−1
2𝜎2)
(𝑇−𝑡) + 𝑛𝜇𝐽
̃𝜎2(𝑇−𝑡) = 𝜎2(𝑇−𝑡) + 𝑛𝜎2
𝐽.
Solving the equations simultaneously we have
̃𝐷= 𝐷+ 𝜆
(
𝑒𝜇𝐽+ 1
2 𝜎2
𝐽−1
)
−
𝑛
𝑇−𝑡
(
𝜇𝐽+ 1
2𝜎2
𝐽
)
and
̃𝜎2 = 𝜎2 +
𝑛𝜎2
𝐽
𝑇−𝑡.
From the definition of a European call option price with strike 𝐾> 0 and expiry time
𝑇≥𝑡
𝐶𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ𝑀[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∞
∑
𝑛=0
ℚ𝑀(𝑁𝑇−𝑡= 𝑛)𝔼ℚ𝑀[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡, 𝑁𝑇−𝑡= 𝑛]
= 𝑒−𝑟(𝑇−𝑡)
∞
∑
𝑛=0
{𝑒−𝜆(𝑇−𝑡)[𝜆(𝑇−𝑡)]𝑛
𝑛!
×𝔼ℚ𝑀[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡, 𝑁𝑇−𝑡= 𝑛]}
where the term 𝑒−𝜆(𝑇−𝑡)[𝜆(𝑇−𝑡)]𝑛
𝑛!
is the probability of 𝑛jumps in time period (𝑡, 𝑇]. Since
the conditional distribution of 𝑆𝑇given 𝑆𝑡and 𝑁𝑇−𝑡= 𝑛can be written as
log 𝑆𝑇||
{𝑆𝑡, 𝑁𝑇−𝑡= 𝑛} ∼
[
log 𝑆𝑡+
(
𝑟−̃𝐷−1
2̃𝜎2)
(𝑇−𝑡), ̃𝜎2(𝑇−𝑡)
]
therefore from Problem 2.2.2.5 (page 101) the conditional call option
𝔼ℚ𝑀[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡, 𝑁𝑇−𝑡= 𝑛]
is simply the Black–Scholes call option price with dividend ̃𝐷and volatility ̃𝜎
𝔼ℚ𝑀[
max{𝑆𝑇−𝐾, 0}|| ℱ𝑡, 𝑁𝑇−𝑡= 𝑛
]
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)

134
2.2.2 Black–Scholes Model
where
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−̃𝐷(𝑇−𝑡)Φ( ̃𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ( ̃𝑑−)
with ̃𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−̃𝐷± 1
2̃𝜎2)(𝑇−𝑡)
̃𝜎
√
𝑇−𝑡
.
Hence, the explicit solution is
𝐶𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∞
∑
𝑛=0
𝑒−𝜆(𝑇−𝑡)[𝜆(𝑇−𝑡)]𝑛
𝑛!
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
19. Digital Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the
probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility, param-
eter, and let 𝑟denote the risk-free interest rate.
A digital (or cash-or-nothing) call option is a contract that pays $1 at expiry time 𝑇if
the spot price 𝑆𝑇> 𝐾and nothing if 𝑆𝑇≤𝐾.
By denoting 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) as the price of a European digital call option satisfying the
following PDE with boundary conditions
𝜕𝐶𝑑
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑑
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑑
𝜕𝑆𝑡
−𝑟𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝐶𝑑(0, 𝑡; 𝐾, 𝑇) = 0,
𝐶𝑑(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 1I{𝑆𝑇>𝐾}
and letting the solution of the SDE be in the form 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) where
𝑥= log (𝑆𝑡∕𝐾) and 𝜏= 1
2𝜎2(𝑇−𝑡), show that by setting
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0
where 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 , the Black–Scholes equation for 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) is
𝜕𝑢
𝜕𝜏= 𝜕2𝑢
𝜕𝑥2 ,
𝑢(𝑥, 0) = 𝑓(𝑥),
𝑥∈(−∞, ∞),
𝜏> 0
where 𝑓(𝑥) = 𝑒
1
2 𝑘1𝑥1I{𝑥>0}.

2.2.2 Black–Scholes Model
135
Given that the solution of 𝑢(𝑥, 𝜏) is
𝑢(𝑥, 𝜏) =
1
√
2𝜋𝜏∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝜏)2
4𝜏
𝑑𝑧
deduce that
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Solution: Let 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) where 𝑥= log (𝑆𝑡∕𝐾) and 𝜏= 1
2𝜎2(𝑇−𝑡).
We have
𝜕𝐶𝑑
𝜕𝑡
= 𝜕𝐶𝑑
𝜕𝜏⋅𝜕𝜏
𝜕𝑡= −1
2𝜎2𝑒𝛼𝑥+𝛽𝜏[𝜕𝑢
𝜕𝜏+ 𝛽𝑢(𝑥, 𝜏)
]
𝜕𝐶𝑑
𝜕𝑆𝑡
= 𝜕𝐶𝑑
𝜕𝑥⋅𝜕𝑥
𝜕𝑆𝑡
= 𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[ 𝜕𝑢
𝜕𝑥+ 𝛼𝑢(𝑥, 𝜏)
]
and
𝜕2𝐶𝑑
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
{
𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[
𝛼𝑢(𝑥, 𝜏) + 𝜕𝑢
𝜕𝑥
]}
= 𝑒𝛼𝑥+𝛽𝜏
𝑆2
𝑡
[
𝜕2𝑢
𝜕𝑥2 + (2𝛼−1) 𝜕𝑢
𝜕𝑥+ 𝛼(𝛼−1)𝑢(𝑥, 𝜏)
]
.
By substituting the above expressions into the Black–Scholes equation for 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇),
we eventually have
1
2𝜎2 ( 𝜕𝑢
𝜕𝑥2 −𝜕𝑢
𝜕𝜏
)
+ 𝜕𝑢
𝜕𝑥
[1
2𝜎2(2𝛼−1) + 𝑟−𝐷
]
+ 𝑢
[1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟
]
= 0.
To eliminate the terms 𝜕𝑢
𝜕𝑥and 𝑢we set
1
2𝜎2(2𝛼−1) + 𝑟−𝐷= 0
1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟= 0.

136
2.2.2 Black–Scholes Model
By solving the equations simultaneously we have
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0
where 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 .
Thus,
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−1
2 𝑘1𝑥−( 1
4 𝑘2
1+𝑘0)𝜏𝑢(𝑥, 𝜏)
such that
𝑢(𝑥, 0) = 𝑒
1
2 𝑘1𝑥𝐶𝑑(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑒
1
2 𝑘1𝑥1I{𝑥>0}.
Writing the solution
𝑢(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2
4𝜏
𝑑𝑧
=
1
2
√
𝜋𝜏∫
𝜏
0
𝑒
1
2 𝑘1𝑧−1
4𝜏(𝑥−𝑧)2𝑑𝑧
= 𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
∫
∞
0
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑧−(𝑥+𝑘1𝜏)
√
2𝜏
)2
𝑑𝑧
= 𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
∫
∞
−(𝑥+𝑘1𝜏)
√
2𝜏
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
𝑥+ 𝑘1𝜏
√
2𝜏
)
hence
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏)
= 𝑒𝛼𝑥+𝛽𝜏𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
𝑥+ 𝑘1𝜏
√
2𝜏
)
= 𝑒−𝑘0𝜏Φ
(
𝑥+ 𝑘1𝜏
√
2𝜏
)
where 𝛼= −1
2𝑘1 and 𝛽= −1
4𝑘2
1 −𝑘0.

2.2.2 Black–Scholes Model
137
Finally, by setting 𝑥= log (𝑆𝑡∕𝐾) and 𝜏= 1
2𝜎2(𝑇−𝑡) we have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
N.B. Using the same techniques, for a digital (or cash-or-nothing) put which pays $1 at
expiry time 𝑇if the spot price 𝑆𝑇< 𝐾and nothing if 𝑆𝑇≥𝐾we can also show that the
cash-or-nothing put price at time 𝑡< 𝑇is
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
−log(𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
20. Digital Option (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter, and let 𝑟denote the risk-free interest rate.
A digital (or cash-or-nothing) call option is a contract that pays $1 at expiry time 𝑇if
the spot price 𝑆𝑇> 𝐾and nothing if 𝑆𝑇≤𝐾. In contrast, a digital (or cash-or-nothing)
put pays $1 at expiry time 𝑇if the spot price 𝑆𝑇< 𝐾and nothing if 𝑆𝑇≥𝐾.
By denoting 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) as the digital call and put option prices,
respectively at time 𝑡, 𝑡< 𝑇show using the risk-neutral valuation approach that
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−)
where
𝑑−=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢.
Verify that the put–call parity for a digital option is
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡).

138
2.2.2 Black–Scholes Model
Solution: From Girsanov’s theorem, the spot price SDE under the risk-neutral measure ℚ
is
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
By definition
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ(
1I{𝑆𝑇>𝐾}||| ℱ𝑡
)
= 𝑒−𝑟(𝑇−𝑡) [1 ⋅ℚ(𝑆𝑇> 𝐾|| ℱ𝑡
) + 0 ⋅ℚ(𝑆𝑇≤𝐾|| ℱ𝑡
)]
= 𝑒−𝑟(𝑇−𝑡)ℚ(𝑆𝑇> 𝐾|| ℱ𝑡
) .
From It¯o’s lemma we can write
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡, 𝑡< 𝑇.
Hence,
ℚ(𝑆𝑇> 𝐾|| ℱ𝑡
) = ℚ
(
𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡> 𝐾||||
ℱ𝑡
)
= ℚ
(
𝑊ℚ
𝑇−𝑡>
log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
||||||
ℱ𝑡
)
.
Given that 𝑊ℚ
𝑇−𝑡∼(0, 𝑇−𝑡), 𝑍=
𝑊ℚ
𝑇−𝑡
√
𝑇−𝑡
∼(0, 1) and hence
ℚ(𝑆𝑇> 𝐾|| ℱ𝑡
) = ℚ
(
𝑊ℚ
𝑇−𝑡
√
𝑇−𝑡
>
log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
||||||
ℱ𝑡
)
= ℚ
(
𝑍>
log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
||||||
ℱ𝑡
)
= Φ(𝑑−)
where 𝑑−=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
. Therefore,
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).

2.2.2 Black–Scholes Model
139
In contrast, for a digital put option price, by definition
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ(
1I{𝑆𝑇<𝐾}||| ℱ𝑡
)
= 𝑒−𝑟(𝑇−𝑡) [1 ⋅ℚ(𝑆𝑇< 𝐾|| ℱ𝑡
) + 0 ⋅ℚ(𝑆𝑇≥𝐾|| ℱ𝑡
)]
= 𝑒−𝑟(𝑇−𝑡)ℚ(𝑆𝑇< 𝐾|| ℱ𝑡
)
and using the same techniques we can easily show that
ℚ(𝑆𝑇< 𝐾|| ℱ𝑡
) = Φ(−𝑑−)
and thus 𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−).
Finally, given that Φ(𝑑−) + Φ(−𝑑−) = 1
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡).
21. Asset-or-Nothing Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter, and let 𝑟denote the risk-free interest rate.
An asset-or-nothing call option is a contract that pays 𝑆𝑇> 0 at expiry time 𝑇if the spot
price 𝑆𝑇> 𝐾and nothing if 𝑆𝑇≤𝐾. In contrast, an asset-or-nothing put pays 𝑆𝑇> 0 at
expiry time 𝑇if the spot price 𝑆𝑇< 𝐾and nothing if 𝑆𝑇≥𝐾.
By denoting 𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) as the price of an asset-or-nothing call option at time 𝑡< 𝑇
satisfying the following PDE with boundary conditions
𝜕𝐶𝑎
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑎
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑎
𝜕𝑆𝑡
−𝑟𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝐶𝑎(0, 𝑡; 𝐾, 𝑇) = 0,
𝐶𝑎(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝑆𝑇1I{𝑆𝑇>𝐾}
and letting the solution of the PDE be in the form 𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) where
𝑥= log (𝑆𝑡∕𝐾) and 𝜏= 1
2𝜎2(𝑇−𝑡), show that by setting
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0

140
2.2.2 Black–Scholes Model
where 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 , the Black–Scholes equation for 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) is
𝜕𝑢
𝜕𝜏= 𝜕2𝑢
𝜕𝑥2 ,
𝑢(𝑥, 0) = 𝑓(𝑥),
𝑥∈(−∞, ∞), 𝜏> 0
where 𝑓(𝑥) = 𝑒( 1
2 𝑘1+1)𝑥1I{𝑥>0} .
Given that the solution
𝑢(𝑥, 𝜏) =
1
√
2𝜋𝜏∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝜏)2
4𝜏
𝑑𝑧
deduce that
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Solution: By setting 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏) such that 𝑥= log (𝑆𝑡∕𝐾), 𝜏=
1
2𝜎2(𝑇−𝑡) and using the same steps as described in Problem 2.2.2.19 (page 134), we
can show that
𝜕𝑢
𝜕𝜏= 𝜕2𝑢
𝜕𝑥2 ,
𝑢(𝑥, 0) = 𝑒( 1
2 𝑘1+1)𝑥1I{𝑥>0},
𝑥∈(−∞, ∞), 𝜏> 0
where 𝛼= −1
2𝑘1, 𝛽= −1
4𝑘2
1 −𝑘0, 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 .
By solving the heat equation we have
𝑢(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
0
𝑓(𝑧)𝑒−(𝑥−𝑧)2
4𝜏
𝑑𝑧
=
1
2
√
𝜋𝜏∫
∞
0
𝑒( 1
2 𝑘1+1)𝑧−(𝑥−𝑧)2
4𝜏
𝑑𝑧
= 𝑒
(𝑥+( 1
2 𝑘1+1)𝜏)2−𝑥2
4𝜏
∫
∞
0
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑧−(𝑥+( 1
2 𝑘1+1)𝜏)
√
2𝜏
)2
𝑑𝑧
= 𝑒
(𝑥+( 1
2 𝑘1+1)𝜏)2−𝑥2
4𝜏
∫
∞
−
𝑥+( 1
2 𝑘1+1)𝜏
√
2𝜏
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑒
(𝑥+( 1
2 𝑘1+1)𝜏)2−𝑥2
4𝜏
Φ
(𝑥+ ( 1
2𝑘1 + 1)𝜏
√
2𝜏
)
.

2.2.2 Black–Scholes Model
141
Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒𝛼𝑥+𝛽𝜏𝑢(𝑥, 𝜏)
= 𝐾𝑒𝑥+(𝑘1−𝑘0+1)𝜏Φ
(𝑥+ ( 1
2𝑘1 + 1)𝜏
√
2𝜏
)
where 𝛼= −1
2𝑘1 and 𝛽= −1
4𝑘2
1 −𝑘0.
By substituting 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 , the asset-or-nothing call option price is
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
N.B. Using the same techniques we can also show that the asset-or-nothing put option
price is
𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
−log (𝑆𝑡∕𝐾) −
(
𝑟−𝐷+ 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
22. Asset-or-Nothing Option (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM
with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter, and let 𝑟denote the risk-free interest rate.
An asset-or-nothing call option is a contract that pays 𝑆𝑇at expiry time 𝑇if the spot
price 𝑆𝑇> 𝐾and nothing if 𝑆𝑇≤𝐾. In contrast, an asset-or-nothing put pays 𝑆𝑇> 0 at
expiry time 𝑇if the spot price 𝑆𝑇< 𝐾and nothing if 𝑆𝑇≥𝐾.
By denoting 𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) as the asset-or-nothing call and put
option prices, respectively at time 𝑡, 𝑡< 𝑇show using the risk-neutral valuation approach
that
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+)
and
𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)

142
2.2.2 Black–Scholes Model
where
𝑑+ =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢.
Verify that the put–call parity for an asset-or-nothing option is
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡).
Solution: Using Girsanov’s theorem, the spot price SDE under the risk-neutral measure
ℚis
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s lemma we can
write
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡,
𝑡< 𝑇
such that
𝑆𝑇|𝑆𝑡∼log -
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
.
By definition
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ(
𝑆𝑇1I{𝑆𝑇>𝐾}||| ℱ𝑡
)
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑆𝑇𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
such that
𝑓(𝑆𝑇|𝑆𝑡
) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log 𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
)2
,
𝑆𝑇> 0
where 𝑚= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡).
Hence, we can write
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log 𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
)2
𝑑𝑆𝑇

2.2.2 Black–Scholes Model
143
and by letting 𝑢= log𝑆𝑇−𝑚
𝜎
√
𝑇−𝑡
we have
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑚−𝑟(𝑇−𝑡)
√
2𝜋
∫
∞
log 𝐾−𝑚
𝜎
√
𝑇−𝑡
𝑒−1
2 𝑢2+𝜎𝑢
√
𝑇−𝑡𝑑𝑢.
Using the sum of squares
−1
2𝑢2 + 𝜎𝑢
√
𝑇−𝑡= −1
2
[(
𝑢−𝜎
√
𝑇−𝑡
)2
−𝜎2(𝑇−𝑡)
]
we can simplify the integral to become
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑚−𝑟(𝑇−𝑡)
√
2𝜋
∫
∞
log 𝐾−𝑚
𝜎
√
𝑇−𝑡
𝑒
−1
2
[(
𝑢−𝜎
√
𝑇−𝑡
)2
−𝜎2(𝑇−𝑡)
]
𝑑𝑢
= 𝑒𝑚−𝑟(𝑇−𝑡)+ 1
2 𝜎2(𝑇−𝑡)
∫
∞
log𝐾−𝑚
𝜎
√
𝑇−𝑡
1
√
2𝜋
𝑒
−1
2
(
𝑢−𝜎
√
𝑇−𝑡
)2
𝑑𝑢.
Finally, by changing the variable once again with 𝑣= 𝑢−𝜎
√
𝑇−𝑡and substituting
𝑚= log 𝑆𝑡+ (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡) we eventually have
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
As for the asset-or-nothing put option price, using similar arguments we can easily show
that
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ(
𝑆𝑇1I{𝑆𝑇<𝐾}||| ℱ𝑡
)
= 𝑒−𝑟(𝑇−𝑡)
∫
𝐾
−∞
𝑆𝑇𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
−log(𝑆𝑡∕𝐾) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Thus,
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+)
and
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)

144
2.2.2 Black–Scholes Model
where
𝑑+ =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Because of the identity Φ(𝑑+) + Φ(−𝑑+) = 1, the put–call parity for an asset-or-nothing
option is
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡).
23. Black Model. From the Black–Scholes assumptions the price of a futures contract maturing
at time 𝑇> 𝑡on an asset with price 𝑆𝑡at time 𝑡is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
where 𝐷is the continuous dividend yield and 𝑟is the constant risk-free interest rate. Here,
under the risk-neutral measure ℚthe asset price is assumed to follow a GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where {𝑊ℚ
𝑡
: 𝑡≥0} is a ℚ-standard Wiener process on the probability space (Ω, ℱ, ℚ)
and 𝜎is the asset volatility parameter.
By considering a hedging portfolio involving both a European option on futures
𝑉(𝐹(𝑡, 𝑇), 𝑡) and a futures contract 𝐹(𝑡, 𝑇), show that the Black equation is
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
Solution: Let the value of the portfolio at time 𝑡be
Π𝑡= 𝑉(𝐹(𝑡, 𝑇), 𝑡) −Δ𝐹(𝑡, 𝑇)
where it involves buying one unit of an option on futures 𝑉(𝐹(𝑡, 𝑇), 𝑡) and selling Δ units
of 𝐹(𝑡, 𝑇). The jump in the value of the portfolio in a single time step is
𝑑Π𝑡= 𝑑𝑉−Δ𝑑𝐹
where, by expanding 𝑉(𝐹(𝑡, 𝑇), 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡+ 𝜕𝑉
𝜕𝐹𝑑𝐹+ 1
2
𝜕2𝑉
𝜕𝐹2 (𝑑𝐹)2 + …

2.2.2 Black–Scholes Model
145
Given 𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and 𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
we can write
𝑑𝐹= 𝑑(𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡))
= 𝑒(𝑟−𝐷)(𝑇−𝑡)𝑑𝑆𝑡−(𝑟−𝐷)𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)𝑑𝑡
= 𝑒(𝑟−𝐷)(𝑇−𝑡) [(𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊ℚ
𝑡
] −(𝑟−𝐷)𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)𝑑𝑡
= 𝜎𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)𝑑𝑊ℚ
𝑡
= 𝜎𝐹(𝑡, 𝑇)𝑑𝑊ℚ
𝑡.
From It¯o’s lemma
(𝑑𝑊ℚ
𝑡)2 = 𝑑𝑡,
(𝑑𝑡)2 = 𝑑𝑊ℚ
𝑡𝑑𝑡= 𝑑𝑡𝑑𝑊ℚ
𝑡
= 0
we have
(𝑑𝐹)2 = 𝜎2𝐹(𝑡, 𝑇)2𝑑𝑡
and
(𝑑𝐹)𝜈= 0,
𝜈> 2.
Therefore,
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝐹𝑑𝐹+ 1
2
𝜕2𝑉
𝜕𝐹2 (𝑑𝐹)2 + …
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2
)
𝑑𝑡+ 𝜎𝐹(𝑡, 𝑇)𝜕𝑉
𝜕𝐹𝑑𝑊ℚ
𝑡.
By substituting 𝑑𝑉into 𝑑Π𝑡and rearranging terms, we have
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2
)
𝑑𝑡+ 𝜎𝐹(𝑡, 𝑇)
(𝜕𝑉
𝜕𝐹−Δ
)
𝑑𝑊ℚ
𝑡.
To ensure a risk-free portfolio we set
Δ = 𝜕𝑉
𝜕𝐹
which leads to
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2
)
𝑑𝑡.
Since it costs nothing to enter into a futures contract the cost of setting up the portfolio at
time 𝑡is only 𝑉(𝐹(𝑡, 𝑇), 𝑡), and therefore
𝑑Π𝑡= 𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡)𝑑𝑡.

146
2.2.2 Black–Scholes Model
Thus,
𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡)𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2
)
𝑑𝑡
or
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
24. Consider the value of a European option 𝑉(𝑆𝑡, 𝑡) satisfying the following Black–Scholes
equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝑆𝑡is the spot price of a stock at time 𝑡, 𝜎is the stock volatility, 𝑟is the constant
risk-free interest rate, 𝐷is the continuous dividend yield and 𝑇> 𝑡is the option expiry
time.
Given that the price of a futures contract maturing at time 𝑇on an asset with price 𝑆𝑡at
time 𝑡is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
derive the Black equation for a European option written on a futures contract 𝑉(𝐹(𝑡, 𝑇), 𝑡).
Solution: Let ̂𝑉(𝑆𝑡, 𝑡) = 𝑉(𝐹(𝑡, 𝑇), 𝑡) so that
𝜕̂𝑉
𝜕𝑡= 𝜕𝑉
𝜕𝑡+ 𝜕𝑉
𝜕𝐹
𝜕𝐹
𝜕𝑡
= 𝜕𝑉
𝜕𝑡−(𝑟−𝐷)𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) 𝜕𝑉
𝜕𝐹
= 𝜕𝑉
𝜕𝑡−(𝑟−𝐷)𝐹(𝑡, 𝑇)𝜕𝑉
𝜕𝐹
𝜕̂𝑉
𝜕𝑆𝑡
= 𝜕𝑉
𝜕𝐹
𝜕𝐹
𝜕𝑆𝑡
= 𝑒(𝑟−𝐷)(𝑇−𝑡) 𝜕𝑉
𝜕𝐹
=
(𝐹(𝑡, 𝑇)
𝑆𝑡
)
𝜕𝑉
𝜕𝐹

2.2.2 Black–Scholes Model
147
and
𝜕2 ̂𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝑒(𝑟−𝐷)(𝑇−𝑡) 𝜕𝑉
𝜕𝐹
)
= 𝑒(𝑟−𝐷)(𝑇−𝑡) 𝜕2𝑉
𝜕𝐹2
𝜕𝐹
𝜕𝑆𝑡
= 𝑒2(𝑟−𝐷)(𝑇−𝑡) 𝜕2𝑉
𝜕𝐹2
=
(𝐹(𝑡, 𝑇)
𝑆𝑡
)2 𝜕2𝑉
𝜕𝐹2 .
By substituting ̂𝑉(𝑆𝑡, 𝑡), 𝜕̂𝑉
𝜕𝑡, 𝜕̂𝑉
𝜕𝑆𝑡
and 𝜕2 ̂𝑉
𝜕𝑆2
𝑡
into
𝜕̂𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̂𝑉
𝜕𝑆𝑡
−𝑟̂𝑉(𝑆𝑡, 𝑡) = 0
we have
𝜕𝑉
𝜕𝑡−(𝑟−𝐷)𝐹(𝑡, 𝑇)𝜕𝑉
𝜕𝐹+ 1
2𝜎2𝑆2
𝑡
(𝐹(𝑡, 𝑇)
𝑆𝑡
)2 𝜕2𝑉
𝜕𝐹2
+(𝑟−𝐷)𝑆𝑡
(𝐹(𝑡, 𝑇)
𝑆𝑡
)
𝜕𝑉
𝜕𝐹−𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0
or
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
25. Let the price of a futures contract maturing at time 𝑇> 𝑡on an asset with price 𝑆𝑡at time
𝑡be
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
where 𝑟is the constant risk-free interest rate and 𝐷is the continuous dividend yield. For a
European option written on a futures contract 𝑉(𝐹(𝑡, 𝑇), 𝑡) it satisfies the Black–Scholes
equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
Show that 𝐹(𝑡, 𝑇)
𝐵
𝑉
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡
)
is also a solution of the Black–Scholes equation for any
constant 𝐵.

148
2.2.2 Black–Scholes Model
Show also that the prices of a European call option 𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) and put option
𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) on a futures contract with the same strike 𝐾and expiry time 𝜏< 𝑇(i.e.,
the options expire before the futures contract maturity) have the following property
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐹(𝑡, 𝑇)
𝐾
𝑃
(
𝐾2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
.
Solution: Let 𝑊(𝐹(𝑡, 𝑇), 𝑡) = 𝐹(𝑡, 𝑇)
𝐵
𝑉( ̂𝐹(𝑡, 𝑇), 𝑡) where ̂𝐹(𝑡, 𝑇) =
𝐵2
𝐹(𝑡, 𝑇). By differ-
entiation we have
𝜕𝑊
𝜕𝑡
= 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕𝑡
𝜕𝑊
𝜕𝐹= 1
𝐵𝑉( ̂𝐹(𝑡, 𝑇), 𝑡) + 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕̂𝐹
𝜕𝐹
𝜕𝐹
= 1
𝐵𝑉( ̂𝐹(𝑡, 𝑇), 𝑡) + 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕̂𝐹
(
−
𝐵2
𝐹(𝑡, 𝑇)
)
= 1
𝐵𝑉( ̂𝐹(𝑡, 𝑇), 𝑡) −
𝐵
𝐹(𝑡, 𝑇)
𝜕𝑉
𝜕̂𝐹
and
𝜕2𝑊
𝜕𝐹2 = 1
𝐵
𝜕𝑉
𝜕̂𝐹
𝜕𝐹
𝜕𝐹+
𝐵
𝐹(𝑡, 𝑇)2
𝜕𝑉
𝜕̂𝐹
−
𝐵
𝐹(𝑡, 𝑇)
𝜕2𝑉
𝜕̂𝐹2
𝜕̂𝐹
𝜕𝐹
= 1
𝐵
(
−
𝐵2
𝐹(𝑡, 𝑇)2
)
𝜕𝑉
𝜕̂𝐹
+
𝐵2
𝐹(𝑡, 𝑇)2
𝜕𝑉
𝜕̂𝐹
+
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2
=
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2 .
Since
𝜕𝑊
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑊
𝜕𝐹2 −𝑟𝑊(𝐹(𝑡, 𝑇), 𝑡) = 0
therefore
𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2 −𝑟
(𝐹(𝑡, 𝑇)
𝐵
)
𝑉( ̂𝐹(𝑡, 𝑇), 𝑡)
= 𝐹(𝑡, 𝑇)
𝐵
{
𝜕𝑉
𝜕𝑡+ 1
2𝜎2 ̂𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝑉( ̂𝐹(𝑡, 𝑇), 𝑡)
}
= 0.

2.2.2 Black–Scholes Model
149
Hence,
𝜕𝑉
𝜕𝑡+ 1
2𝜎2 ̂𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝑉( ̂𝐹(𝑡, 𝑇), 𝑡) = 0
which shows that 𝐹(𝑡, 𝑇)
𝐵
𝑉
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡
)
is also a solution of the Black–Scholes equation
for any constant 𝐵.
Finally, to show that 𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐹(𝑡, 𝑇)
𝐾
𝑃
(
𝐾2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
at the option
expiry 𝜏
𝐹(𝜏, 𝑇)
𝐾
𝑃
(
𝐾2
𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏
)
= 𝐹(𝜏, 𝑇)
𝐾
max
{
𝐾−
𝐾2
𝐹(𝜏, 𝑇), 0
}
= max{𝐹(𝜏, 𝑇) −𝐾}
= 𝐶(𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏).
By discounting the payoffs back to time 𝑡we have
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐹(𝑡, 𝑇)
𝐾
𝑃
(
𝐾2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
.
26. Consider the price of a futures contract 𝐹(𝑡, 𝑇) with delivery time 𝑇on a stock with price
𝑆𝑡at time 𝑡(𝑡< 𝑇). Throughout the life of the futures contract the stock pays discrete divi-
dends 𝛿𝑖, 𝑖= 1, 2, … , 𝑛where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇. Under the no-arbitrage condition
the futures contract price is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒𝑟(𝑇−𝑡) −
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝑖)
where 𝑟is the risk-free interest rate.
By considering a European option on the futures 𝑉(𝐹(𝑡, 𝑇), 𝑡), show that the Black–
Scholes equation is
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
(
𝐹(𝑡, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝑖)
)2
𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0
where 𝜎is the stock volatility.
Solution: Let ̂𝑉(𝑆𝑡, 𝑡) = 𝑉(𝐹(𝑡, 𝑇), 𝑡); differentiating with respect to 𝑡and 𝑆𝑡we have
𝜕̂𝑉
𝜕𝑡= 𝜕𝑉
𝜕𝑡+ 𝜕𝑉
𝜕𝐹
𝜕𝐹
𝜕𝑆𝑡
= 𝜕𝑉
𝜕𝑡−𝑟𝑆𝑡𝑒𝑟(𝑇−𝑡) 𝜕𝑉
𝜕𝐹
𝜕̂𝑉
𝜕𝑆𝑡
= 𝜕𝑉
𝜕𝐹
𝜕𝐹
𝜕𝑆𝑡
= 𝑒𝑟(𝑇−𝑡) 𝜕𝑉
𝜕𝐹

150
2.2.2 Black–Scholes Model
and
𝜕2 ̂𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝑒𝑟(𝑇−𝑡) 𝜕𝑉
𝜕𝐹
)
= 𝑒𝑟(𝑇−𝑡) 𝜕2𝑉
𝜕𝐹2
𝜕𝐹
𝜕𝑆𝑡
= 𝑒2𝑟(𝑇−𝑡) 𝜕2𝑉
𝜕𝐹2 .
Given that
𝜕̂𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉
𝜕𝑆2
𝑡
+ 𝑟𝑆𝑡
𝜕̂𝑉
𝜕𝑆𝑡
−𝑟̂𝑉(𝑆𝑡, 𝑡) = 0
we have
𝜕𝑉
𝜕𝑡−𝑟𝑆𝑡𝑒𝑟(𝑇−𝑡) 𝜕𝑉
𝜕𝐹+ 1
2𝜎2𝑆2
𝑡𝑒2𝑟(𝑇−𝑡) 𝜕2𝑉
𝜕𝐹2 + 𝑟𝑆𝑡𝑒𝑟(𝑇−𝑡) 𝜕𝑉
𝜕𝐹−𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0
or
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
(
𝐹(𝑡, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒𝑟(𝑇−𝑡𝑖)
)2
𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
27. Let the price of a futures contract maturing at time 𝑇on an asset with price 𝑆𝑡at time 𝑡,
𝑡< 𝑇be
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
where 𝑟is the constant risk-free interest rate, 𝐷is the continuous dividend yield and 𝜎is the
asset volatility. For European call 𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) and put 𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) options
written on a futures contract with expiry time 𝑇and strike price 𝐾, show that
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐹(𝑡, 𝑇)Φ(𝑑1) −𝐾Φ(𝑑2)]
and
𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐾Φ(−𝑑2) −𝐹(𝑡, 𝑇)Φ(−𝑑1)]
where
𝑑1,2 =
log (𝐹(𝑡, 𝑇)∕𝐾) ± 1
2𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Show that the put–call parity relationship for options on futures is
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) −𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐹(𝑡, 𝑇) −𝐾] .

2.2.2 Black–Scholes Model
151
Solution: For European call 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and put 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) options written on 𝑆𝑡
with strike price 𝐾and expiry time 𝑇, we have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Since 𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡), by substituting 𝑆𝑡= 𝐹(𝑡, 𝑇)𝑒−(𝑟−𝐷)(𝑇−𝑡) we have
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐹(𝑡, 𝑇)Φ(𝑑1) −𝐾Φ(𝑑2)]
and
𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐾Φ(−𝑑2) −𝐹(𝑡, 𝑇)Φ(−𝑑1)]
where
𝑑1,2 =
log (𝐹(𝑡, 𝑇)∕𝐾) ± 1
2𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Given the identity Φ(𝑑1) + Φ(−𝑑1) = 1 and Φ(𝑑2) + Φ(−𝑑2) = 1 therefore
𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) −𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) [𝐹(𝑡, 𝑇) −𝐾] .
N.B. From the expressions of 𝐶(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) and 𝑃(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) we can deduce
that options on futures contracts are independent on an asset that pays a continuous divi-
dend yield.
28. Arithmetic Brownian Motion. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the
probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow an arithmetic Brownian motion
(ABM) with the following SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. Using It¯o’s lemma show that under the risk-neutral measure ℚthe conditional

152
2.2.2 Black–Scholes Model
distribution of 𝑆𝑇given 𝑆𝑡is
𝑆𝑇|𝑆𝑡∼
(
𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡),
𝜎2
2(𝑟−𝐷)
[𝑒2(𝑟−𝐷)(𝑇−𝑡) −1])
where 𝑟is the risk-free interest rate and 𝑇> 𝑡.
Using the risk-neutral valuation approach show that the European call option price at
time 𝑡with strike 𝐾and expiry time 𝑇is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)) Φ (𝑑) + ̂𝜎Φ′(𝑑)
and from the put–call parity deduce that the European put option price at time 𝑡with strike
𝐾and expiry time 𝑇is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ̂𝜎Φ′(−𝑑) −(𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)) Φ(−𝑑)
where
𝑑= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
̂𝜎
, ̂𝜎= 𝜎
√
𝑒−2𝐷(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)
2(𝑟−𝐷)
and Φ(𝑥) is the standard normal cdf
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚthe asset price fol-
lows the process
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟𝑆𝑡
𝜎
)
𝑡is a ℚ-standard. Further details on this change of mea-
sure can be found in Problem 4.2.3.7 of Problems and Solutions in Mathematical Finance,
Volume 1: Stochastic Calculus.
From Taylor’s theorem and from the application of It¯o’s lemma
𝑑(𝑒−(𝑟−𝐷)𝑡𝑆𝑡) = −(𝑟−𝐷)𝑒−(𝑟−𝐷)𝑡𝑆𝑡𝑑𝑡+ 𝑒−(𝑟−𝐷)𝑡𝑑𝑆𝑡
+1
2(𝑟−𝐷)2𝑒−(𝑟−𝐷)𝑡𝑆𝑡(𝑑𝑡)2 + …
= −(𝑟−𝐷)𝑒−(𝑟−𝐷)𝑡𝑆𝑡𝑑𝑡+ 𝑒−(𝑟−𝐷)𝑡((𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡)
= 𝜎𝑒−(𝑟−𝐷)𝑡𝑑𝑊ℚ
𝑡.

2.2.2 Black–Scholes Model
153
Taking integrals
∫
𝑇
𝑡
𝑑(𝑒−(𝑟−𝐷)𝑢𝑆𝑢) = ∫
𝑇
𝑡
𝜎𝑒−(𝑟−𝐷)𝑢𝑑𝑊ℚ
𝑢
𝑒−(𝑟−𝐷)𝑇𝑆𝑇−𝑒−(𝑟−𝐷)𝑡𝑆𝑡= 𝜎∫
𝑇
𝑡
𝑒−(𝑟−𝐷)𝑢𝑑𝑊ℚ
𝑢
or
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) + 𝜎∫
𝑇
𝑡
𝑒(𝑟−𝐷)(𝑇−𝑢)𝑑𝑊ℚ
𝑢.
Since ∫
𝑇
𝑡
𝑒(𝑟−𝐷)(𝑇−𝑢)𝑑𝑊ℚ
𝑢∼
(
0, ∫
𝑇
𝑡
𝑒2(𝑟−𝐷)(𝑇−𝑢)𝑑𝑢
)
therefore
𝑆𝑇|𝑆𝑡∼
(
𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡),
𝜎2
2(𝑟−𝐷)
[𝑒2(𝑟−𝐷)(𝑇−𝑡) −1])
.
By writing 𝑚= 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and 𝑠= 𝜎
√
𝑒2(𝑟−𝐷)(𝑇−𝑡) −1
2(𝑟−𝐷)
so that the conditional pdf of
𝑆𝑇given 𝑆𝑡is
𝑓(𝑆𝑇|𝑆𝑡) =
1
𝑠
√
2𝜋
𝑒
−1
2
( 𝑆𝑇−𝑚
𝑠
)2
then from the definition of a European call option
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑆𝑇−𝐾)𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇
= 𝐼1 −𝐼2
where 𝐼1 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑆𝑇𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇and 𝐼2 = 𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑓(𝑆𝑇|𝑆𝑡) 𝑑𝑆𝑇.

154
2.2.2 Black–Scholes Model
For case 𝐼1 and by setting 𝑧= 𝑆𝑇−𝑚
𝑠
we can write
𝐼1 = 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝑆𝑇
𝑠
√
2𝜋
𝑒
−1
2
( 𝑆𝑇−𝑚
𝑠
)2
𝑑𝑆𝑇
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾−𝑚
𝑠
𝑠𝑧+ 𝑚
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧
= 𝑠𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾−𝑚
𝑠
𝑧
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧+ 𝑚𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾−𝑚
𝑠
1
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡) [
𝑚Φ
(𝑚−𝐾
𝑠
)
+ 𝑠Φ′ (𝑚−𝐾
𝑠
)]
.
Using similar techniques for case 𝐼2 we have
𝐼2 = 𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
1
𝑠
√
2𝜋
𝑒
−1
2
( 𝑆𝑇−𝑚
𝑠
)2
𝑑𝑆𝑇
= 𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾−𝑚
𝑠
1
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ
(𝑚−𝐾
𝑠
)
.
By substituting 𝑚= 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and 𝑠= 𝜎
√
𝑒2(𝑟−𝐷)(𝑇−𝑡) −1
2(𝑟−𝐷)
we have
𝑚−𝐾
𝑠
=
𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) −𝐾
𝜎
√
𝑒2(𝑟−𝐷)(𝑇−𝑡) −1
2(𝑟−𝐷)
= 𝑒𝑟(𝑇−𝑡) (𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡))
𝜎
√
𝑒2(𝑟−𝐷)(𝑇−𝑡) −1
2(𝑟−𝐷)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
̂𝜎
where ̂𝜎= 𝜎
√
𝑒−2𝐷(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)
2(𝑟−𝐷)
and hence the European call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐼1 −𝐼2
= 𝑒−𝑟(𝑇−𝑡) [
(𝑚−𝐾)Φ
(𝑚−𝐾
𝑠
)
+ 𝑠Φ′ (𝑚−𝐾
𝑠
)]
= (𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)) Φ (𝑑) + ̂𝜎Φ′(𝑑)
where 𝑑= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
̂𝜎
.

2.2.2 Black–Scholes Model
155
Finally, from the put–call parity relationship of European options
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
the equivalent European put option price at time 𝑡is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐾𝑒−𝑟(𝑇−𝑡)
= (𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)) (Φ (𝑑) −1) + ̂𝜎Φ′(𝑑)
= ̂𝜎Φ′(−𝑑) −(𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)) Φ(−𝑑)
since Φ′(𝑥) =
1
√
2𝜋
𝑒−1
2 𝑥2 is an even function.
29. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and
let the stock price 𝑆𝑡satisfy the following GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟denote the risk-free interest rate.
We consider a European-style option contract with strike 𝐾written on the stock 𝑆𝑡that
pays amount
Ψ(𝑆𝑇) = log
(𝑆𝑇
𝑆0
)
−𝐾
at the expiry time 𝑇> 𝑡where 𝑆0 is the initial stock price.
Using It¯o’s lemma find the SDE for log 𝑆𝑡under the risk-neutral measure ℚ.
Hence, show that the price of the option struck at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
[
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾
]
.
Find the hedging ratio, the number of stocks to hold and the amount of cash needed to
invest in a risk-free money market in order to hedge this option contract at time 𝑡.
Finally, by considering a European contract that pays
Ψ(𝑆𝑇) =
[
log
(𝑆𝑇
𝑆0
)
−𝐾
]2
at expiry time 𝑇what is the option price of this contract at time 𝑡?

156
2.2.2 Black–Scholes Model
Solution: From Girsanov’s theorem the SDE of 𝑆𝑡under the risk-neutral measure ℚis
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
From Taylor’s expansion
𝑑(log 𝑆𝑡) = 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
and using It¯o’s lemma we eventually have
𝑑(log 𝑆𝑡) =
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡.
Taking integrals
∫
𝑇
𝑡
𝑑log 𝑆𝑢= ∫
𝑇
𝑡
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑑𝑊ℚ
𝑢
log
(𝑆𝑇
𝑆𝑡
)
=
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) + 𝜎𝑊ℚ
𝑇−𝑡
such that
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
.
Hence, the option price at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
log
(𝑆𝑇
𝑆0
)
−𝐾
|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
log
(𝑆𝑇
𝑆𝑡
)
+ log
( 𝑆𝑡
𝑆0
)
−𝐾
|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
[
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾
]
.
At time 𝑡,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡

2.2.2 Black–Scholes Model
157
where 𝜙𝑡is the number of units of 𝑆𝑡and 𝜓𝑡is the amount of cash invested in the risk-free
money market. By partial differentiation with respect to 𝑆𝑡we therefore have
𝜙𝑡= 𝜕𝑉
𝜕𝑆𝑡
= 𝑒−𝑟(𝑇−𝑡)
𝑆𝑡
and hence
𝜓𝑡= 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝜙𝑡𝑆𝑡
= 𝑒−𝑟(𝑇−𝑡)
[
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾−1
]
.
For the case when the payoff is Ψ(𝑆𝑇) =
[
log
(𝑆𝑇
𝑆0
)
−𝐾
]2
, the option price at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
log
(𝑆𝑇
𝑆0
)
−𝐾
)2|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
log
(𝑆𝑇
𝑆𝑡
)
+ log
( 𝑆𝑡
𝑆0
)
−𝐾
)2|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[ (
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) + log
( 𝑆𝑡
𝑆0
)
−𝐾
)2|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
)2|||||
ℱ𝑡
]
+ 2𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
|||||
ℱ𝑡
]
× 𝔼ℚ
[
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾
|||||
ℱ𝑡
]
+ 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾
)2|||||
ℱ𝑡
]
.
Since
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
∼(0, 1)

158
2.2.2 Black–Scholes Model
therefore
⎡
⎢
⎢
⎢
⎢⎣
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎤
⎥
⎥
⎥
⎥⎦
2
∼𝜒2(1)
with
𝔼ℚ
⎡
⎢
⎢
⎢
⎢⎣
⎛
⎜
⎜
⎜
⎜⎝
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
2||||||||||
ℱ𝑡
⎤
⎥
⎥
⎥
⎥⎦
= 1
or
𝔼ℚ
[(
log
(𝑆𝑇
𝑆𝑡
)
−
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
)2|||||
ℱ𝑡
]
= 𝜎2(𝑇−𝑡).
Hence,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
{
𝜎2(𝑇−𝑡)
+
[
log
( 𝑆𝑡
𝑆0
)
+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) −𝐾
]2}
.
30. Merton Model for Default of a Company I. At time 𝑡, we assume the asset 𝐴𝑡of a company
satisfies the SDE
𝑑𝐴𝑡
𝐴𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝜎is the volatility and {𝑊𝑡: 𝑡≥0} is a standard Wiener
process on the probability space (Ω, ℱ, ℙ). Let 𝑟be the risk-free interest rate.
In financial accounting the asset 𝐴𝑡is a combination of equity 𝐸𝑡and debt 𝐷𝑡so that
𝐴𝑡= 𝐸𝑡+ 𝐷𝑡
where at time 𝑇, 𝑡< 𝑇the debt holders will receive an amount 𝐹> 0 which is the face
value of the debt if 𝐴𝑇> 𝐹and the equity holders will receive the rest of the value of the
company. Otherwise, the company will be in default and the debt holders will receive 𝐴𝑇
and the equity holders will receive nothing.
By constructing the payoff diagrams for 𝐸𝑇and 𝐷𝑇, find the values of 𝐸𝑡and 𝐷𝑡for
all 𝑡< 𝑇under the Black–Scholes framework.

2.2.2 Black–Scholes Model
159
Solution: At time 𝑇, for the debt holders
𝐷𝑇=
⎧
⎪
⎨
⎪⎩
𝐹
if 𝐴𝑇> 𝐹
𝐴𝑇
if 𝐴𝑇≤𝐹
and hence, for the equity holders
𝐸𝑇= 𝐴𝑇−𝐷𝑇
= 𝐴𝑇−
⎧
⎪
⎨
⎪⎩
𝐹
if 𝐴𝑇> 𝐹
𝐴𝑇
if 𝐴𝑇≤𝐹
=
⎧
⎪
⎨
⎪⎩
𝐴𝑇−𝐹
if 𝐴𝑇> 𝐹
0
if 𝐴𝑇≤𝐹
= max{𝐴𝑇−𝐹, 0}.
At terminal time 𝑇, the payoff diagram for equity shareholders is given in Figure 2.1.
Mathematically
𝐸𝑇= max{𝐴𝑇−𝐹, 0}
is the payoff of a European call option on the assets with strike equal to the face value.
Payoﬀ
Figure 2.1
Payment to equity holders at time 𝑇.

160
2.2.2 Black–Scholes Model
Given that 𝐴𝑡follows a GBM process, the amount of equity 𝐸𝑡at time 𝑡is
𝐸𝑡= 𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇)
where
𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇) = 𝐴𝑡Φ(𝑑+) −𝐹𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
such that
𝑑± =
log(𝐴𝑡∕𝐹) + (𝑟± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
In contrast, the payment to debt holders at time 𝑇is
𝐷𝑇=
⎧
⎪
⎨
⎪⎩
𝐹
if 𝐴𝑇> 𝐹
𝐴𝑇
if 𝐴𝑇≤𝐹
= min{𝐹, 𝐴𝑇}
or
𝐷𝑇=
⎧
⎪
⎨
⎪⎩
𝐹
if 𝐴𝑇> 𝐹
𝐴𝑇
if 𝐴𝑇≤𝐹
=
⎧
⎪
⎨
⎪⎩
𝐹
if 𝐴𝑇> 𝐹
𝐹
if 𝐴𝑇≤𝐹
−
⎧
⎪
⎨
⎪⎩
0
if 𝐴𝑇> 𝐹
𝐹−𝐴𝑇
if 𝐴𝑇≤𝐹
= 𝐹−max{𝐹−𝑉𝑇, 0}.
Therefore, the payoff diagram for the debt holders is given in Figure 2.2.
Thus,
𝐷𝑇= min{𝐹, 𝐴𝑇} = 𝐹−max{𝐹−𝐴𝑇, 0}
which is the difference between the face value and the payoff of a European put option
with strike price equal to 𝐹. Thus, at time 𝑡the debt is equal to
𝐷𝑡= 𝐹𝑒−𝑟(𝑇−𝑡) −𝑃(𝐴𝑡, 𝑡; 𝐹, 𝑇)
= 𝐴𝑡−𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇)

2.2.2 Black–Scholes Model
161
Payoﬀ
Figure 2.2
Payment to debt holders at time 𝑇.
where, from the put–call parity
𝑃(𝐴𝑡, 𝑡; 𝐹, 𝑇) = 𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇) −𝐴𝑡+ 𝐹𝑒−𝑟(𝑇−𝑡).
31. Generalised Black–Scholes Formula. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process
on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡have the following diffusion
process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
where 𝜇𝑡, 𝐷𝑡and 𝜎𝑡are time-dependent drift, continuous dividend yield and volatility
functions, and let 𝑟𝑡be the time-dependent risk-free interest rate from a money-market
account.
Under the risk-neutral measure ℚ, deduce that the European option price at time 𝑡, writ-
ten on 𝑆𝑡with strike price 𝐾expiring at 𝑇, 𝑇> 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛿𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝛿𝑑+) −𝛿𝐾𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢Φ(𝛿𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + ∫𝑇
𝑡(𝑟𝑢−𝐷𝑢± 1
2𝜎2
𝑢) 𝑑𝑢
√
∫𝑇
𝑡𝜎2
𝑢𝑑𝑢
𝛿=
{
+1
for call option
−1
for put option.

162
2.2.2 Black–Scholes Model
Solution: Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+ ∫
𝑡
0
𝜇𝑢−𝑟𝑢
𝜎𝑢
𝑑𝑢is a ℚ-standard Wiener process.
Hence, from It¯o’s lemma
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡
−1
2𝜎2
𝑡𝑑𝑡
=
(
𝑟𝑡−𝐷𝑡−1
2𝜎2
𝑡
)
𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡.
Taking integrals
∫
𝑇
𝑡
𝑑log 𝑆𝑢= ∫
𝑇
𝑡
(
𝑟𝑢−𝐷𝑢−1
2𝜎2
𝑢
)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ
𝑢
or
log
(𝑆𝑇
𝑆𝑡
)
= ∫
𝑇
𝑡
(
𝑟𝑢−𝐷𝑢−1
2𝜎2
𝑢
)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ
𝑢.
Since we can also write the It¯o integral as
∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ
𝑢= lim
𝑛→∞
𝑛−1
∑
𝑖=0
𝜎𝑡𝑖(𝑊ℚ
𝑡𝑖+1 −𝑊ℚ
𝑡𝑖)
where 𝑡𝑖= 𝑡+ 𝑖(𝑇−𝑡)∕𝑛, 𝑡= 𝑡0 < 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛−1 < 𝑡𝑛= 𝑇, 𝑛∈ℕand due to the
stationary increment of a standard Wiener process, each term of 𝑊ℚ
𝑡𝑖+1 −𝑊ℚ
𝑡𝑖∼

(
0, 𝑇−𝑡
𝑛
)
is normally distributed multiplied by a deterministic term, therefore we can
deduce that
∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ
𝑢∼
(
0, ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
)
and hence
log
(𝑆𝑇
𝑆𝑡
)
∼
[
∫
𝑇
𝑡
(
𝑟𝑢−𝐷𝑢−1
2𝜎2
𝑢
)
𝑑𝑢, ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
]
or
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]

2.2.2 Black–Scholes Model
163
where
𝑟=
1
𝑇−𝑡∫
𝑇
𝑡
𝑟𝑢𝑑𝑢,
𝐷=
1
𝑇−𝑡∫
𝑇
𝑡
𝐷𝑢𝑑𝑢,
𝜎2 =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢.
By analogy with the risk-neutral pricing methodology (see Problem 2.2.2.5, page 101),
we can substitute the constants 𝑟, 𝐷and 𝜎of the Black–Scholes formula with 𝑟, 𝐷and 𝜎,
respectively so that the price of European call 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and put 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) options
with strike 𝐾are
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
such that
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Substituting the values of 𝑟, 𝐷and 𝜎2 we finally have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝑑+) −𝐾𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(−𝑑+) −𝐾𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢Φ(−𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + ∫𝑇
𝑡(𝑟𝑢−𝐷𝑢± 1
2𝜎2
𝑢) 𝑑𝑢
√
∫𝑇
𝑡𝜎2
𝑢𝑑𝑢
.
32. Non-Dividend-Paying Asset Price as Num´eraire. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡have the following
diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
where 𝜇𝑡, 𝐷𝑡and 𝜎𝑡are time-dependent drift, continuous dividend yield and volatility,
functions, and let 𝑟𝑡be the time-dependent risk-free interest rate from a money-market
account.
Show that under the risk-neutral measure ℚ, 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢follows a non-dividend diffusion
process of the form
𝑑
(
𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢)
= 𝑟𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+ ∫
𝑡
0
𝜇𝑢−𝑟𝑢
𝜎𝑢
𝑑𝑢is a ℚ-standard Wiener process.

164
2.2.2 Black–Scholes Model
By definition the price of a European-style option with payoff Ψ(𝑆𝑇) at time 𝑡< 𝑇is
𝑉(𝑆𝑡, 𝑡) = 𝔼ℚ[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢Ψ(𝑆𝑇)
||||
ℱ𝑡
]
where under the risk-neutral measure ℚ, the risk-free money-market account acts as the
num´eraire.
By denoting ℚ𝑆as the equivalent martingale measure where the asset price 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢
is used as the num´eraire and using
𝑋𝑡=
(
𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢)−1
𝑒∫𝑡
0 𝑟𝑢𝑑𝑢
as the discounted money-market account, show that under ℚ𝑆the asset price 𝑆𝑡now
evolves according to the diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡+ 𝜎2
𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ𝑆
𝑡
where 𝑊ℚ𝑆
𝑡
= 𝑊ℚ
𝑡
−∫
𝑡
0
𝜎𝑢𝑑𝑢is a ℚ𝑆-standard Wiener process.
Hence, show that for a strike price 𝐾the price 𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) of a European asset-or-
nothing call with terminal payoff
Ψ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑇
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
is given by
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝑑+)
where
𝑑+ =
log(𝑆𝑡∕𝐾) + ∫𝑇
𝑡(𝑟𝑢−𝐷𝑢+ 1
2𝜎2
𝑢) 𝑑𝑢
√
∫𝑇
𝑡𝜎2
𝑢𝑑𝑢
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡

2.2.2 Black–Scholes Model
165
where 𝑊ℚ
𝑡
= 𝑊𝑡+ ∫
𝑡
0
𝜇𝑡−𝑟𝑡
𝜎𝑡
𝑑𝑢is a ℚ-standard Wiener process. From It¯o’s lemma
𝑑
(
𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢)
= 𝐷𝑡𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑡+ 𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑆𝑡
= 𝐷𝑡𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑡+ 𝑒∫𝑡
0 𝐷𝑢𝑑𝑢[(𝑟𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡
]
= 𝑟𝑡𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑊ℚ
𝑡.
Given that 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢is a non-dividend-paying asset and strictly positive, thus it can be
used as a num´eraire.
Under the change of num´eraire for a payoff Ψ(𝑆𝑇)
𝑁(1)
𝑡𝔼ℚ(1)
[
Ψ(𝑆𝑇)
𝑁(1)
𝑇
||||||
ℱ𝑡
]
= 𝑁(2)
𝑡𝔼ℚ(2)
[
Ψ(𝑆𝑇)
𝑁(2)
𝑇
||||||
ℱ𝑡
]
where for 𝑖= 1, 2, 𝑁(𝑖) is a num´eraire and ℚ(𝑖) is the measure under which the asset prices
discounted by 𝑁(𝑖) are ℚ(𝑖)-martingales.
Under the risk-neutral measure ℚwe have
𝑁(1)
𝑡
= 𝑒∫𝑡
0 𝑟𝑢𝑑𝑢and 𝑁(1)
𝑇
= 𝑒∫𝑇
0 𝑟𝑢𝑑𝑢
and under the ℚ𝑆measure
𝑁(2)
𝑡
= 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢and 𝑁(2)
𝑇
= 𝑆𝑇𝑒∫𝑇
0 𝐷𝑢𝑑𝑢.
Hence,
𝑉(𝑆𝑡, 𝑡) = 𝔼ℚ
[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢Ψ(𝑆𝑇)||||
ℱ𝑡
]
= 𝑒∫𝑡
0 𝑟𝑢𝑑𝑢𝔼ℚ
[
Ψ(𝑆𝑇)
𝑒∫𝑇
0 𝑟𝑢𝑑𝑢
|||||
ℱ𝑡
]
= 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝔼ℚ𝑆
[
Ψ(𝑆𝑇)
𝑆𝑇𝑒∫𝑇
0 𝐷𝑢𝑑𝑢
||||||
ℱ𝑡
]
.
Given
Ψ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑇
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
= 𝑆𝑇1I{𝑆𝑇>𝐾}

166
2.2.2 Black–Scholes Model
the asset-or-nothing call price under ℚ𝑆is
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢𝔼ℚ𝑆
[
𝑆𝑇1I{𝑆𝑇>𝐾}
𝑆𝑇𝑒∫𝑇
0 𝐷𝑢𝑑𝑢
||||||
ℱ𝑡
]
= 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢𝔼ℚ𝑆
[
1I{𝑆𝑇>𝐾}||| ℱ𝑡
]
= 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢ℚ𝑆
(𝑆𝑇> 𝐾|| ℱ𝑡
) .
Under ℚ𝑆the discounted money-market account is defined as
𝑋𝑡=
(
𝑆𝑡𝑒∫𝑡
0 𝐷𝑢𝑑𝑢)−1
𝑒∫𝑡
0 𝑟𝑢𝑑𝑢
where 𝑋𝑡is a ℚ𝑆-martingale. Using It¯o’s lemma
𝑑𝑋𝑡= 𝑑
(
𝑆−1
𝑡𝑒∫𝑡
0 (𝑟𝑢−𝐷𝑢)𝑑𝑢)
= (𝑟𝑡−𝐷𝑡)𝑆−1
𝑡𝑒∫𝑡
0 (𝑟𝑢−𝐷𝑢)𝑑𝑢𝑑𝑡+ 𝑒∫𝑡
0 (𝑟𝑢−𝐷𝑢)𝑑𝑢𝑑(𝑆−1
𝑡)
= (𝑟𝑡−𝐷𝑡)𝑆−1
𝑡𝑒∫𝑡
0 (𝑟𝑢−𝐷𝑢)𝑑𝑢𝑑𝑡+ 𝑆−1
𝑡𝑒∫𝑡
0 (𝑟𝑢−𝐷𝑢)𝑑𝑢
(
−𝑑𝑆𝑡
𝑆𝑡
+
(𝑑𝑆𝑡
𝑆𝑡
)
+ …
)
= (𝑟𝑡−𝐷𝑡)𝑋𝑡𝑑𝑡−𝑋𝑡
[(𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ
𝑡
] + 𝜎2𝑋𝑡𝑑𝑡
= −𝜎𝑡𝑋𝑡𝑑𝑊ℚ
𝑡
+ 𝜎2
𝑡𝑋𝑡𝑑𝑡
= −𝜎𝑡𝑋𝑡𝑑𝑊ℚ𝑆
𝑡
where 𝑊ℚ𝑆
𝑡
= 𝑊ℚ
𝑡
−∫
𝑡
0
𝜎𝑢𝑑𝑢is a ℚ𝑆-standard Wiener process.
By substituting 𝑑𝑊ℚ
𝑡
= 𝑑𝑊ℚ𝑆
𝑡
+ 𝜎𝑡𝑑𝑡into 𝑑𝑆𝑡= (𝑟𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊ℚ
𝑡
the asset
price diffusion process under ℚ𝑆becomes
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡+ 𝜎2
𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ𝑆
𝑡
.
To find the distribution of 𝑆𝑡we note that
𝑑(log 𝑆𝑡) = 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟𝑡−𝐷𝑡+ 𝜎2
𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ𝑆
𝑡
−1
2𝜎2
𝑡𝑑𝑡
=
(
𝑟𝑡−𝐷𝑡+ 1
2𝜎2
𝑡
)
𝑑𝑡+ 𝜎𝑡𝑑𝑊ℚ𝑆
𝑡
and taking integrals
log 𝑆𝑇= log 𝑆𝑡+ ∫
𝑇
𝑡
(
𝑟𝑢−𝐷𝑢+ 1
2𝜎2
𝑢
)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ𝑆
𝑢
.

2.2.2 Black–Scholes Model
167
Since 𝑊ℚ𝑆
𝑡
is a ℚ𝑆-martingale we have
∫
𝑇
𝑡
𝜎𝑢𝑑𝑊ℚ𝑆
𝑢
∼
(
0, ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
)
and hence
log 𝑆𝑇∼
(
log 𝑆𝑡+ ∫
𝑇
𝑡
(
𝑟𝑢−𝐷𝑢+ 1
2𝜎2
𝑢
)
𝑑𝑢, ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
)
.
Therefore,
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢ℚ𝑆
(𝑆𝑇> 𝐾|| ℱ𝑡
)
= 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢ℚ𝑆
(log 𝑆𝑇> log 𝐾|| ℱ𝑡
)
= 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢
× ℚ𝑆
⎛
⎜
⎜
⎜⎝
𝑍>
log 𝐾−log 𝑆𝑡−∫𝑇
𝑡
(
𝑟𝑢−𝐷𝑢+ 1
2𝜎2
𝑢
)
𝑑𝑢
√
∫𝑇
𝑡𝜎2
𝑢𝑑𝑢
||||||||
ℱ𝑡
⎞
⎟
⎟
⎟⎠
where 𝑍∼(0, 1).
Thus,
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝑑+)
where
𝑑+ =
log(𝑆𝑡∕𝐾) + ∫𝑇
𝑡(𝑟𝑢−𝐷𝑢+ 1
2𝜎2
𝑢) 𝑑𝑢
√
∫𝑇
𝑡𝜎2
𝑢𝑑𝑢
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
33. European Option Price Under Stochastic Interest Rate I. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑟
𝑡: 𝑡≥
0} be ℙ-standard Wiener processes on the probability space (Ω, ℱ, ℙ) and let the asset
price 𝑆𝑡have the following diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑆
𝑡
where 𝜇𝑡, 𝐷𝑡and 𝜎𝑡are time-dependent drift, continuous dividend yield and volatility
functions and the risk-free interest rate 𝑟𝑡is assumed to follow an Ornstein-Uhlenbeck
process (or Vasicek process in the interest-rate modelling world)
𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡)𝑑𝑡+ 𝛼𝑑𝑊𝑟
𝑡

168
2.2.2 Black–Scholes Model
where 𝜅, 𝜃and 𝛼are constant parameters. In addition, we assume 𝑊𝑆
𝑡
and 𝑊𝑟
𝑡are corre-
lated with coefficient 𝜌∈(−1, 1),
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑟
𝑡= 𝜌𝑑𝑡.
Assume in the market there is a family of tradeable, risk-free zero-coupon bonds whose
price at time 𝑡is 𝑃(𝑡, 𝑇) where they deliver a unit of currency at maturity 𝑇, 𝑃(𝑇, 𝑇) = 1.
The zero-coupon bond has the process
𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) = 𝜇𝑝(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑𝑊𝑟
𝑡
where 𝜇𝑝(𝑡, 𝑇) is the drift and 𝜎𝑝(𝑡, 𝑇) is the volatility.
(a) By defining {𝑌𝑡: 𝑡≥0} as a ℙ-standard Wiener process where 𝑌𝑡⟂⟂𝑊𝑟
𝑡, show that
we can write
𝑊𝑆
𝑡
= 𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡.
(b) At time 𝑡, we consider a trader who has a portfolio valued at Π𝑡holding 𝜙𝑡units of
risky asset 𝑆𝑡and 𝜓𝑡units invested in zero-coupon bonds. Using the two-dimensional
Girsanov’s theorem, show that under the risk-neutral measure ℚ,
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑆
𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) = 𝑟𝑡𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
𝑑𝑟𝑡= (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝑑𝑡+ 𝛼𝑑̃
𝑊𝑟
𝑡
where ̃
𝑊𝑆= 𝜌̃
𝑊𝑟
𝑡+
√
1 −𝜌2 ̃𝑌𝑡, ̃
𝑊𝑟
𝑡= 𝑊𝑟
𝑡+ ∫
𝑡
0
𝛾𝑢𝑑𝑢, ̃𝑌𝑡= 𝑌𝑡+ ∫
𝑡
0
𝜆𝑢𝑑𝑢are ℚ-
standard Wiener processes, 𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
is the market price of interest risk and
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡= 𝜇𝑡−𝑟𝑡
𝜎𝑡
.
(c) Using It¯o’s formula, show that the zero-coupon bond price 𝑃(𝑡, 𝑇) satisfies the follow-
ing PDE
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0
𝑃(𝑇, 𝑇) = 1.

2.2.2 Black–Scholes Model
169
(d) Using the Feynman-Kac formula, state the price of the zero-coupon bond 𝑃(𝑡, 𝑇) at
time 𝑡as an expectation.
Assuming the market price of risk 𝛾𝑡is a constant value 𝛾and by setting ̃𝜃= 𝜃−𝛼𝛾
𝜅,
show that the solution of 𝑃(𝑡, 𝑇) can be written in the form
𝑃(𝑡, 𝑇) = 𝑒𝐴(𝑡,𝑇)−𝑟𝑡𝐵(𝑡,𝑇)
where
𝐴(𝑡, 𝑇) =
(
̃𝜃−1
2
(𝛼
𝜅
)2)
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
4𝜅𝐵(𝑡, 𝑇)2,
𝐵(𝑡, 𝑇) = 1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡))
and
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
(e) By denoting ℚ𝑇as the 𝑇-forward measure where the zero-coupon bond price is used
as the num´eraire, show that under the ℚ𝑇measure, the risky asset 𝑆𝑡, zero-coupon
bond 𝑃(𝑡, 𝑇) and the interest rate 𝑟𝑡follow the diffusions
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡+ 𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)) 𝑑𝑡+ 𝜎𝑡𝑑̂
𝑊𝑆
𝑡
𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) = (𝑟𝑡+ 𝜎𝑝(𝑡, 𝑇)2) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̂
𝑊𝑟
𝑡
𝑑𝑟𝑡= (𝜅(𝜃−𝑟𝑡) + 𝛼(𝜎(𝑡, 𝑇) −𝛾𝑡)) 𝑑𝑡+ 𝛼𝑑̂
𝑊𝑟
𝑡
where ̂
𝑊𝑆
𝑡
= ̃
𝑊𝑆
𝑡
−∫
𝑡
0
𝜌𝜎𝑝(𝑢, 𝑇) 𝑑𝑢and ̂
𝑊𝑟
𝑡= ̃
𝑊𝑟
𝑡−∫
𝑡
0
𝜎𝑝(𝑢, 𝑇) 𝑑𝑢are ℚ𝑇-
standard Wiener processes.
(f) Finally, under ℚ𝑇show that for a payoff
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0}
the European call option price with strike price 𝐾under stochastic interest rate is
𝐶stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝑑+) −𝐾𝑃(𝑡, 𝑇)Φ(𝑑−)

170
2.2.2 Black–Scholes Model
where
𝑑± =
log (𝑆𝑡∕(𝑃(𝑡, 𝑇)𝐾)) −∫
𝑇
𝑡
(
𝐷𝑢∓1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢
√
∫𝑇
𝑡𝜎(𝑢, 𝑇)2 𝑑𝑢
𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡))
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution:
(a) By writing 𝑊𝑆
𝑡
= 𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡we have the following properties
𝔼(𝑊𝑆
𝑡) = 𝔼
(
𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡
)
= 𝜌𝔼(𝑊𝑟
𝑡) +
√
1 −𝜌2𝔼(𝑌𝑡) = 0
and
Var(𝑊𝑆
𝑡) = Var(𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡) = 𝜌2Var(𝑊𝑟
𝑡) + (1 −𝜌2)Var(𝑌𝑡) = 𝑡
since 𝑊𝑟
𝑡⟂⟂𝑌𝑡
Given both 𝑊𝑟
𝑡∼(0, 𝑡), 𝑌𝑡∼(0, 𝑡) and 𝑊𝑟
𝑡⟂⟂𝑌𝑡therefore
𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡∼(0, 𝑡).
From It¯o’s formula and taking note that 𝑊𝑟
𝑡⟂⟂𝑊𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑟
𝑡= 𝑑(𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡) ⋅𝑑𝑊𝑟
𝑡
= (𝜌𝑑𝑊𝑟
𝑡+
√
1 −𝜌2𝑑𝑌𝑡) ⋅𝑑𝑊𝑟
𝑡
= 𝜌(𝑑𝑊𝑟
𝑡)2 +
√
1 −𝜌2𝑑𝑌𝑡⋅𝑑𝑊𝑟
𝑡
= 𝜌𝑑𝑡.
Thus, we can write 𝑊𝑆
𝑡
= 𝜌𝑊𝑟
𝑡+
√
1 −𝜌2𝑌𝑡.
(b) We first define,
̃𝑌𝑡= 𝑌𝑡+ ∫
𝑡
0
𝜆𝑢𝑑𝑢
̃
𝑊𝑟
𝑡= 𝑊𝑟
𝑡+ ∫
𝑡
0
𝛾𝑢𝑑𝑢
where 𝜆𝑡is the market price of asset risk and 𝛾𝑡is the market price of interest rate risk.
Since 𝑌𝑡⟂⟂𝑊𝑟
𝑡therefore we can easily deduce ̃𝑌𝑡⟂⟂̃
𝑊𝑟
𝑡.

2.2.2 Black–Scholes Model
171
From the two-dimensional Girsanov’s theorem, there exist a risk-neutral measure ℚ
on the filtration ℱ𝑠, 0 ≤𝑠≤𝑡defined by the Radon-Nikod´ym process,
𝑑ℚ
𝑑ℙ= 𝑍𝑡= 𝑒−1
2 ∫𝑡
0 𝜆2
𝑢𝑑𝑢−∫𝑡
0 𝜆𝑢𝑑𝑌𝑢⋅𝑒−1
2 ∫𝑡
0 𝛾2
𝑢𝑑𝑢−∫𝑡
0 𝛾𝑢𝑑𝑊𝑟
𝑢
so that ̃𝑌𝑡and ̃
𝑊𝑟
𝑡are ℚ-standard Wiener processes and ̃𝑌𝑡⟂⟂̃
𝑊𝑟
𝑡.
Let the portfolio Π𝑡be defined as
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝑃(𝑡, 𝑇)
where 𝜙𝑡units are invested in risky asset 𝑆𝑡and 𝜓𝑡units are invested in zero-coupon
bond 𝑃(𝑡, 𝑇). Given the holder of the portfolio will receive 𝐷𝑡𝑆𝑡𝑑𝑡for every risky asset
held, thus
𝑑Π𝑡= 𝜙𝑡
(𝑑𝑆𝑡+ 𝐷𝑡𝑆𝑡𝑑𝑡) + 𝜓𝑡𝑑𝑃(𝑡, 𝑇)
= 𝜙𝑡
(𝜇𝑡𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
)
+𝜓𝑡
(𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑊𝑟
𝑡
)
= 𝑟𝑡Π𝑡𝑑𝑡+ 𝜙𝑡𝑆𝑡
[
(𝜇𝑡−𝑟𝑡)𝑑𝑡+ 𝜎𝑡
(
𝜌𝑑𝑊𝑟
𝑡+
√
1 −𝜌2𝑑𝑌𝑡
)]
+𝜓𝑡𝑃(𝑡, 𝑇) [(𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑𝑊𝑟
𝑡
]
By substituting
𝑑𝑊𝑟
𝑡= 𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡
𝑑𝑌𝑡= 𝑑̃𝑌𝑡−𝜆𝑡𝑑𝑡
into 𝑑Π𝑡we have
𝑑Π𝑡= 𝑟𝑡Π𝑡𝑑𝑡
+𝜙𝑡𝑆𝑡
[(𝜇𝑡−𝑟𝑡)𝑑𝑡
+𝜎𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡−𝜌𝛾𝑡𝑑𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡−
√
1 −𝜌2𝜆𝑡𝑑𝑡
)]
+𝜓𝑡𝑃(𝑡, 𝑇)
[(𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)
(
𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡
)]
= 𝑟𝑡Π𝑡𝑑𝑡
+𝜙𝑡𝑆𝑡
[(
𝜇𝑡−𝑟𝑡−
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝜎𝑡
)
𝑑𝑡
+𝜎𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡
)]
+𝜓𝑡𝑃(𝑡, 𝑇)
[(𝜇𝑝(𝑡, 𝑇) −𝑟𝑡−𝛾𝑡𝜎𝑝(𝑡, 𝑇)) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
]
.
By writing 𝐵𝑡= 𝑒∫𝑡
0 𝑟𝑢𝑑𝑢so that 𝑑𝐵𝑡= 𝑟𝑡𝐵𝑡𝑑𝑡, and under the risk-neutral measure
ℚ, both ̃
𝑊𝑟
𝑡
and ̃
𝑊𝑡are ℚ-martingales. In order for the discounted 𝐵−1
𝑡Π𝑡to

172
2.2.2 Black–Scholes Model
be a ℚ-martingale,
𝑑(𝐵−1
𝑡Π𝑡) = −𝑟𝑡𝐵−1
𝑡Π𝑡𝑑𝑡+ 𝐵−1
𝑡𝑑Π𝑡
= 𝐵−1
𝑡𝜙𝑡𝑆𝑡
[(
𝜇𝑡−𝑟𝑡−
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝜎𝑡
)
𝑑𝑡
+𝜎𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡
)]
+𝐵−1
𝑡𝜓𝑡𝑃(𝑡, 𝑇)
[(𝜇𝑝(𝑡, 𝑇) −𝑟𝑡−𝛾𝑡𝜎𝑝(𝑡, 𝑇)) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
]
we require
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡= 𝜇𝑡−𝑟𝑡
𝜎𝑡
and
𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
.
Hence, by substituting
𝑑𝑊𝑟
𝑡= 𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡,
𝑑𝑌𝑡= 𝑑̃𝑌𝑡−𝜆𝑡𝑑𝑡,
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡= 𝜇𝑡−𝑟𝑡
𝜎𝑡
into
𝑑𝑆𝑡= (𝜇𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑𝑊𝑟
𝑡+
√
1 −𝜌2𝑑𝑌𝑡
)
we have
𝑑𝑆𝑡= (𝜇𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡
+𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡−𝜌𝛾𝑡𝑑𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡−
√
1 −𝜌2𝜆𝑡𝑑𝑡
)
= (𝜇𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡
)
−𝜎𝑡𝑆𝑡
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝑑𝑡
= (𝜇𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡
)
−𝜎𝑡𝑆𝑡
(𝜇𝑡−𝑟𝑡
𝜎𝑡
)
𝑑𝑡
= (𝑟𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝑟
𝑡+
√
1 −𝜌2𝑑̃𝑌𝑡
)
= (𝑟𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
where ̃
𝑊𝑆
𝑡
= 𝜌̃
𝑊𝑟
𝑡+
√
1 −𝜌2 ̃𝑌𝑡.

2.2.2 Black–Scholes Model
173
On the other hand, by substituting
𝑑𝑊𝑟
𝑡= 𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡,
𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
into
𝑑𝑃(𝑡, 𝑇) = 𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑊𝑟
𝑡,
𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡)𝑑𝑡+ 𝛼𝑑𝑊𝑟
𝑡
the zero-coupon bond price and the instantaneous interest rate under the ℚ-measure
become
𝑑𝑃(𝑡, 𝑇) = 𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)
(
𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡
)
= 𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
−𝜎𝑝(𝑡, 𝑇)
(𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
)
𝑑𝑡
= 𝑟𝑡𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
and
𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡)𝑑𝑡+ 𝛼
(
𝑑̃
𝑊𝑟
𝑡−𝛾𝑡𝑑𝑡
)
= (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝑑𝑡+ 𝛼𝑑̃
𝑊𝑟
𝑡.
(c) From It¯o’s formula,
𝑑𝑃(𝑡, 𝑇) = 𝜕𝑃
𝜕𝑡𝑑𝑡+ 𝜕𝑃
𝜕𝑟𝑡
𝑑𝑟𝑡+ 1
2
𝜕2𝑃
𝜕𝑟2
𝑡
(𝑑𝑟𝑡)2 + …
= 𝜕𝑃
𝜕𝑡𝑑𝑡+ 𝜕𝑃
𝜕𝑟𝑡
[(𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝑑𝑡+ 𝛼𝑑̃
𝑊𝑟
𝑡
]
+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
𝑑𝑡
=
[
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
]
𝑑𝑡+ 𝛼𝜕𝑃
𝜕𝑟𝑡
𝑑̃
𝑊𝑟
𝑡.
By equating coefficients with
𝑑𝑃(𝑡, 𝑇) = 𝑟𝑡𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
we will have
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0

174
2.2.2 Black–Scholes Model
and
𝜎𝑝(𝑡, 𝑇) = 𝛼𝜕𝑃
𝜕𝑟𝑡
𝑃(𝑡, 𝑇)−1
with boundary condition
𝑃(𝑇, 𝑇) = 1.
(d) From the Feynman-Kac formula, under the risk-neutral measure ℚ, the solution of the
PDE at time 𝑡is given by
𝑃(𝑡, 𝑇) = 𝔼ℚ
[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢𝑃(𝑇, 𝑇)
||||
ℱ𝑡
]
= 𝔼ℚ
[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢||||
ℱ𝑡
]
.
By setting 𝛾𝑡= 𝛾where 𝛾is a constant value and writing ̃𝜃= 𝜃−𝛼𝛾
𝜅, we therefore
have
𝑑𝑟𝑡= 𝜅(̃𝜃−𝑟𝑡)𝑑𝑡+ 𝛼𝑑̃
𝑊𝑟
𝑡.
Solving the SDE directly,
∫
𝑇
𝑡
𝑑𝑟𝑢= ∫
𝑇
𝑡
(
𝜅(̃𝜃−𝑟𝑢)
)
𝑑𝑢+ 𝛼∫
𝑇
𝑡
𝑑̃
𝑊𝑟
𝑢
𝑟𝑇= 𝑟𝑡= 𝜅̃𝜃(𝑇−𝑡) −𝜅∫
𝑇
𝑡
𝑟𝑢𝑑𝑢+ 𝛼∫
𝑇
𝑡
𝑑̃
𝑊𝑟
𝑢
which we finally have
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢= 1
𝜅(𝑟𝑇−𝑟𝑡) −̃𝜃(𝑇−𝑡) −𝛼
𝜅∫
𝑇
𝑡
𝑑̃
𝑊𝑟
𝑢.
From Problem 3.2.2.10 of Problems and Solutions of Mathematical Finance 1:
Stochastic Calculus, we can write
𝑟𝑇= 𝑟𝑡𝑒−𝜅(𝑇−𝑡) + ̃𝜃(1 −𝑒−𝜅(𝑇−𝑡)) + ∫
𝑇
𝑡
𝛼𝑒−𝜅(𝑇−𝑢)𝑑̃
𝑊𝑟
𝑢
and substituting it to the above equation
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢= 𝑟𝑡
(
1 −𝑒−𝜅(𝑇−𝑡)
𝜅
)
+ ̃𝜃
(
1 −𝑒−𝜅(𝑇−𝑡)
𝜅
−𝑇+ 𝑡
)
+𝛼
𝑘∫
𝑇
𝑡
(𝑒−𝜅(𝑇−𝑢) −1) 𝑑̃
𝑊𝑟
𝑢

2.2.2 Black–Scholes Model
175
or
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢= −𝑟𝑡𝐵(𝑡, 𝑇) + ̃𝜃(𝐵(𝑡, 𝑇) −𝑇+ 𝑡)
+𝛼
𝑘∫
𝑇
𝑡
(𝑒−𝜅(𝑇−𝑢) −1) 𝑑̃
𝑊𝑟
𝑢
where 𝐵(𝑡, 𝑇) = 1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)).
Taking mean, we have
𝔼ℚ
[
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢
|||||
ℱ𝑡
]
= −𝑟𝑡𝐵(𝑡, 𝑇) + ̃𝜃(𝐵(𝑡, 𝑇) −𝑇+ 𝑡)
since
𝔼ℚ
[
𝛼
𝑘∫
𝑇
𝑡
(𝑒−𝜅(𝑇−𝑢) −1) 𝑑̃
𝑊𝑟
𝑢
|||||
ℱ𝑡
]
= 0
and variance,
Varℚ
[
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢
|||||
ℱ𝑡
]
=
(𝛼
𝑘
)2
𝔼ℚ
[[
∫
𝑇
𝑡
(
𝑒−𝜅(𝑇−𝑠) −1
)
𝑑̃
𝑊𝑟
𝑠
]2||||||
ℱ𝑡
]
=
(𝛼
𝑘
)2
𝔼ℚ
[
∫
𝑇
𝑡
(𝑒−𝜅(𝑇−𝑢) −1)2 𝑑𝑢
|||||
ℱ𝑡
]
= −
(𝛼
𝑘
)2 (
1 −𝑒−𝜅(𝑇−𝑡)
𝜅
−𝑇+ 𝑡
)
−𝛼2
2𝜅
(
1
𝜅2 + 𝑒−2𝜅(𝑇−𝑡)
𝜅2
−2𝑒−𝜅(𝑇−𝑡)
𝜅2
)
= −
(𝛼
𝑘
)2
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
2𝜅𝐵(𝑡, 𝑇)2.
Since 𝑟𝑇∼
(
𝑟𝑡𝑒−𝜅(𝑇−𝑡) + ̃𝜃(1 −𝑒−𝜅(𝑇−𝑡)) , 𝛼2
𝜅
[1 −𝑒−2𝜅(𝑇−𝑡)])
, we can deduce
that
−∫
𝑇
𝑡
𝑟𝑢𝑑𝑢∼
(
−𝑟𝑡𝐵(𝑡, 𝑇) + ̃𝜃(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) ,
−
(𝛼
𝑘
)2
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
2𝜅𝐵(𝑡, 𝑇)2
)
.

176
2.2.2 Black–Scholes Model
Thus,
𝑃(𝑡, 𝑇) = 𝔼ℚ
[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢||||
ℱ𝑇
]
= 𝑒
−𝑟𝑡𝐵(𝑡,𝑇)+̃𝜃(𝐵(𝑡,𝑇)−𝑇+𝑡)−1
2
( 𝛼
𝑘
)2
(𝐵(𝑡,𝑇)−𝑇+𝑡)−𝛼2
4𝜅𝐵(𝑡,𝑇)2
= 𝑒𝐴(𝑡,𝑇)−𝑟𝑡𝐵(𝑡,𝑇)
where
𝐴(𝑡, 𝑇) =
(
̃𝜃−1
2
(𝛼
𝜅
)2)
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
4𝜅𝐵(𝑡, 𝑇)2
and
𝐵(𝑡, 𝑇) = 1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
Thus, the volatility of the zero-coupon bond is given as
𝜎𝑝(𝑡, 𝑇) = 𝛼𝜕𝑃
𝜕𝑟𝑡
𝑃(𝑡, 𝑇)−1
= −𝛼𝐵(𝑡, 𝑇)
= −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
(e) Under the risk-neutral measure ℚ, the discounted zero-coupon bond 𝐵−1
𝑡𝑃(𝑡, 𝑇) is a
ℚ-martingale. Hence, we can deduce
𝑑(𝐵−1
𝑡𝑃(𝑡, 𝑇))
𝐵−1
𝑡𝑃(𝑡, 𝑇)
= 𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) −𝑑𝐵𝑡
𝐵𝑡
−𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇)
𝑑𝐵𝑡
𝐵𝑡
+
(𝑑𝐵𝑡
𝐵𝑡
)2
= 𝑟𝑡𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡−𝑟𝑡𝑑𝑡
= 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
is a ℚ-martingale.
From It¯o’s formula,
𝑑(log (𝐵−1
𝑡𝑃(𝑡, 𝑇))) =
𝑑(𝐵−1
𝑡𝑃(𝑡, 𝑇))
𝐵−1
𝑡𝑃(𝑡, 𝑇)
−1
2
(
𝑑(𝐵−1
𝑡𝑃(𝑡, 𝑇))
𝐵−1
𝑡𝑃(𝑡, 𝑇)
)2
+ …
= 𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡−1
2𝜎𝑝(𝑡, 𝑇)2𝑑𝑡
and solving the differential equation we have
log
(
𝐵−1
𝑡𝑃(𝑡, 𝑇)
𝐵−1
0 𝑃(0, 𝑇)
)
= ∫
𝑡
0
𝜎𝑝(𝑢, 𝑇) 𝑑̃
𝑊𝑟
𝑡−1
2 ∫
𝑡
0
𝜎𝑝(𝑢, 𝑇)2 𝑑𝑢

2.2.2 Black–Scholes Model
177
or
𝐵−1
𝑡𝑃(𝑡, 𝑇)
𝐵−1
0 𝑃(0, 𝑇)
= 𝑒∫𝑡
0 𝜎𝑝(𝑢,𝑇)𝑑̃
𝑊𝑟
𝑡−1
2 ∫𝑡
0 𝜎𝑝(𝑢,𝑇)2𝑑𝑢
where 𝐵0 = 1.
From Girsanov’s theorem, we can define a 𝑇-forward measure ℚ𝑇, given by the
Radon-Nikod´ym derivative
𝑑ℚ𝑇
𝑑ℚ
||||ℱ𝑡
= 𝑃(𝑡, 𝑇)
𝑃(0, 𝑇)
/ 𝐵𝑡
𝐵0
=
𝐵−1
𝑡𝑃(𝑡, 𝑇)
𝐵−1
0 𝑃(0, 𝑇)
= 𝑒−∫𝑡
0 (−𝜎𝑝(𝑢,𝑇))𝑑̃
𝑊𝑟
𝑢−1
2 ∫𝑡
0 𝜎𝑝(𝑢,𝑇)2𝑑𝑢
so that ̂
𝑊𝑟
𝑡= ̃
𝑊𝑟
𝑡−∫
𝑡
0
𝜎𝑝(𝑢, 𝑇) 𝑑𝑢is a ℚ𝑇-standard Wiener process.
In a similar vein, we can also set
̃
𝑊𝑟
𝑡= 𝜌̃
𝑊𝑆
𝑡
+
√
1 −𝜌2 ̃
𝑍𝑡
where ̃
𝑊𝑆
𝑡
and ̃
𝑍𝑡are ℚ-standard Wiener processes and ̃
𝑊𝑆
𝑡
⟂⟂̃
𝑍𝑡.
Thus, we can write
𝑑𝑃(𝑡, 𝑇) = 𝑟𝑡𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑̃
𝑊𝑟
𝑡
= 𝑟𝑡𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)
(
𝜌𝑑̃
𝑊𝑆
𝑡
+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
and we can deduce
𝑑(log (𝐵−1
𝑡𝑃(𝑡, 𝑇))) =
𝑑(𝐵−1
𝑡𝑃(𝑡, 𝑇))
𝐵−1
𝑡𝑃(𝑡, 𝑇)
−1
2
(
𝑑(𝐵−1
𝑡𝑃(𝑡, 𝑇))
𝐵−1
𝑡𝑃(𝑡, 𝑇)
)2
+ …
= 𝜌𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑊𝑆
𝑡
−1
2𝜌2𝜎𝑝(𝑡, 𝑇)2𝑑𝑡
+
√
1 −𝜌2𝜎𝑝(𝑡, 𝑇)𝑑̃
𝑍𝑡−1
2(1 −𝜌2)𝜎𝑝(𝑡, 𝑇)2𝑑𝑡
and hence
𝐵−1
𝑡𝑃(𝑡, 𝑇)
𝐵−1
0 𝑃(0, 𝑇)
= 𝑒∫𝑡
0 𝜌𝜎𝑝(𝑢,𝑇)𝑑̃
𝑊𝑆
𝑡−1
2 ∫𝑡
0 𝜌2𝜎𝑝(𝑢,𝑇)2𝑑𝑢
×𝑒∫𝑡
0
√
1−𝜌2𝜎𝑝(𝑢,𝑇)𝑑̃
𝑍𝑡−1
2 ∫𝑡
0 (1−𝜌2)𝜎𝑝(𝑢,𝑇)2𝑑𝑢.

178
2.2.2 Black–Scholes Model
From the two-dimensional Girsanov’s theorem, there exist a 𝑇-forward measure ℚ𝑇
on the filtration ℱ𝑠, 0 ≤𝑠≤𝑡defined by the Radon-Nikod´ym process,
𝑑ℚ𝑇
𝑑ℚ= 𝑒−∫𝑡
0 (−𝜌𝜎𝑝(𝑢,𝑇))𝑑̃
𝑊𝑆
𝑢−1
2 ∫𝑡
0 𝜌2𝜎𝑝(𝑢,𝑇)2𝑑𝑢
×𝑒−∫𝑡
0 (−
√
1−𝜌2𝜎𝑝(𝑢,𝑇))𝑑̃
𝑍𝑢−1
2 ∫𝑡
0 (1−𝜌2)𝜎𝑝(𝑢,𝑇)2𝑑𝑢
so that ̂
𝑊𝑆
𝑡
= ̃
𝑊𝑆
𝑡
−∫
𝑡
0
𝜌𝜎𝑝(𝑢, 𝑇) 𝑑𝑢and ̂
𝑍𝑡= ̃
𝑍𝑡−∫
𝑡
0
√
1 −𝜌2𝜎𝑝(𝑢, 𝑇) 𝑑𝑢are
ℚ𝑇-standard Wiener processes and ̂
𝑊𝑆
𝑡
⟂⟂̂
𝑍𝑡.
Hence, under the ℚ𝑇measure,
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡
(
𝑑̂
𝑊𝑆
𝑡
+ 𝜌𝜎𝑝(𝑡, 𝑇)𝑑𝑡
)
= (𝑟𝑡−𝐷𝑡+ 𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)) 𝑑𝑡+ 𝜎𝑡𝑑̂
𝑊𝑆
𝑡,
𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) = 𝑟𝑡𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)
(
𝑑̂
𝑊𝑟
𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑𝑡
)
= (𝑟𝑡+ 𝜎𝑝(𝑡, 𝑇)2) 𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑̂
𝑊𝑟
𝑡
and
𝑑𝑟𝑡= (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝑑𝑡+ 𝛼
(
𝑑̂
𝑊𝑟
𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑𝑡
)
= (𝜅(𝜃−𝑟𝑡) + 𝛼(𝜎𝑝(𝑡, 𝑇) −𝛾𝑡)) 𝑑𝑡+ 𝛼𝑑̂
𝑊𝑟
𝑡.
(f) Under the change of num´eraire for a payoff Ψ(𝑆𝑇)
𝑁(1)
𝑡𝔼ℚ(1)
[
Ψ(𝑆𝑇)
𝑁(1)
𝑇
||||||
ℱ𝑡
]
= 𝑁(2)
𝑡𝔼ℚ(2)
[
Ψ(𝑆𝑇)
𝑁(2)
𝑇
||||||
ℱ𝑡
]
where for 𝑖= 1, 2, 𝑁(𝑖) is a num´eraire and ℚ(𝑖) is the measure under which the asset
prices discounted by 𝑁(𝑖) are ℚ(𝑖)-martingales.
Under the risk-neutral measure ℚwe have
𝑁(1)
𝑡
= 𝑒∫𝑡
0 𝑟𝑢𝑑𝑢
and
𝑁(1)
𝑇
= 𝑒∫𝑇
0 𝑟𝑢𝑑𝑢
and under the 𝑇-forward measure ℚ𝑇
𝑁(2)
𝑡
= 𝑃(𝑡, 𝑇)
and
𝑁(2)
𝑇
= 𝑃(𝑇, 𝑇) = 1.
Hence, with the change of num´eraire from the risk-neutral measure ℚto the 𝑇-
forward measure ℚ𝑇, the European call option price at time 𝑡under stochastic

2.2.2 Black–Scholes Model
179
interest rate is
𝐶stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ
[
𝑒−∫𝑇
𝑡
𝑟𝑢𝑑𝑢max{𝑆𝑇−𝐾, 0}
||||
ℱ𝑡
]
= 𝑒∫𝑡
0 𝑟𝑢𝑑𝑢𝔼ℚ
[
max{𝑆𝑇−𝐾, 0}
𝑒∫𝑇
0 𝑟𝑢𝑑𝑢
|||||
ℱ𝑡
]
= 𝑃(𝑡, 𝑇)𝔼ℚ𝑇
[ max{𝑆𝑇−𝐾, 0}
𝑃(𝑇, 𝑇)
||||
ℱ𝑡
]
= 𝑃(𝑡, 𝑇)𝔼ℚ𝑇
[
max
{
𝑆𝑇
𝑃(𝑇, 𝑇) −𝐾, 0
}|||||
ℱ𝑡
]
.
From It¯o’s formula,
𝑑(𝑃(𝑡, 𝑇)−1𝑆𝑡
)
𝑃(𝑡, 𝑇)−1𝑆𝑡
= 𝑑𝑆𝑡
𝑆𝑡
−𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) −
(𝑑𝑆𝑡
𝑆𝑡
) (𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇)
)
+
(𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇)
)2
= (𝑟𝑡−𝐷𝑡+ 𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)) 𝑑𝑡+ 𝜎𝑡𝑑̂
𝑊𝑆
𝑡
−(𝑟𝑡+ 𝜎𝑝(𝑡, 𝑇)2) 𝑑𝑡−𝜎𝑝(𝑡, 𝑇)𝑑̂
𝑊𝑟
𝑡−𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)𝑑𝑡
+𝜎𝑝(𝑡, 𝑇)2𝑑𝑡
= −𝐷𝑡𝑑𝑡+ 𝜎𝑡𝑑̂
𝑊𝑆
𝑡
−𝜎𝑝(𝑡, 𝑇)𝑑̂
𝑊𝑟
𝑡
= −𝐷𝑡𝑑𝑡+ 𝜎(𝑡, 𝑇)𝑑̂𝑉𝑡
where
𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)
and
𝑑̂𝑉𝑡=
𝜎𝑡𝑑̂
𝑊𝑆
𝑡
−𝜎𝑝(𝑡, 𝑇)𝑑̂
𝑊𝑟
𝑡
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)
is a ℚ𝑇-standard Wiener process.
Hence, by solving the geometric Brownian motion process,
log
(𝑃(𝑇, 𝑇)−1𝑆𝑇
𝑃(𝑡, 𝑇)−1𝑆𝑡
)
∼
(
−∫
𝑇
𝑡
(
𝐷𝑢+ 1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢, ∫
𝑇
𝑡
𝜎(𝑢, 𝑇)2 𝑑𝑢
)
.
Following Problem 1.2.2.7 of Problems and Solutions in Mathematical Finance,
Stochastic Calculus, Volume 1, the European call option price at time 𝑡under stochastic

180
2.2.2 Black–Scholes Model
interest rate is
𝐶stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(𝑑+) −𝐾𝑃(𝑡, 𝑇)Φ(𝑑−)
where
𝑑± =
log (𝑆𝑡∕(𝑃(𝑡, 𝑇)𝐾)) −∫
𝑇
𝑡
(
𝐷𝑢∓1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢
√
∫𝑇
𝑡𝜎(𝑢, 𝑇)2 𝑑𝑢
,
𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇) −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)
and
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
34. European Option Price Under Stochastic Interest Rate II. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑟
𝑡:
𝑡≥0} be ℙ-standard Wiener processes on the probability space (Ω, 𝐹, ℙ) and let the asset
price 𝑆𝑡have the following diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑡−𝐷𝑡)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑆
𝑡
where 𝜇𝑡, 𝐷𝑡and 𝜎𝑡are time-dependent drift, continuous dividend yield and volatility
functions and the risk-free interest rate 𝑟𝑡is assumed to follow an Ornstein-Uhlenbeck
process (or Vasicek process in the interest-rate modelling world)
𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡)𝑑𝑡+ 𝛼𝑑𝑊𝑟
𝑡
where 𝜅, 𝜃and 𝛼are constant parameters. In addition, we assume 𝑊𝑆
𝑡
and 𝑊𝑟
𝑡are corre-
lated with coefficient 𝜌∈(−1, 1),
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑟
𝑡= 𝜌𝑑𝑡.
Assume that in the market there is a family of tradeable, risk-free zero-coupon bonds whose
price at time 𝑡is 𝑃(𝑡, 𝑇) where they deliver a unit of currency at maturity 𝑇, 𝑃(𝑇, 𝑇) = 1.
The zero-coupon bond has the process
𝑑𝑃(𝑡, 𝑇)
𝑃(𝑡, 𝑇) = 𝜇𝑝(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑑𝑊𝑟
𝑡
where 𝜇𝑝(𝑡, 𝑇) is the drift and 𝜎𝑝(𝑡, 𝑇) is the volatility

2.2.2 Black–Scholes Model
181
(a) By considering a hedging portfolio involving an option 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) under stochastic
interest rate which can only be exercised on the option expiry time 𝑇> 𝑡, a risky asset
𝑆𝑡and a zero-coupon bond 𝑃(𝑡, 𝑇) show that 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
+ (𝑟𝑡−𝐷𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑉
𝜕𝑟𝑡
−𝑟𝑡𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) = 0
with boundary condition
𝑉(𝑆𝑇, 𝑟𝑇, 𝑇) = Ψ(𝑆𝑇)
where 𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
is the market price of risk of the interest rate and Ψ(𝑆𝑇) is
the option payoff.
(b) Using It¯o’s formula, show that the zero-coupon bond price 𝑃(𝑡, 𝑇) satisfies the follow-
ing PDE
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0
with boundary condition
𝑃(𝑇, 𝑇) = 1.
(c) Assuming 𝛾𝑡= 𝛾where 𝛾is a constant value, ̃𝜃= 𝜃−𝛼𝛾
𝜅and writing the price of a
zero-coupon bond maturing at time 𝑇in the affine function form
𝑃(𝑡, 𝑇) = 𝑒𝐴(𝑡,𝑇)−𝑟𝑡𝐵(𝑡,𝑇)
with boundary conditions
𝐴(𝑇, 𝑇) = 0,
𝐵(𝑇, 𝑇) = 0
find the functions of 𝐴(𝑡, 𝑇) and 𝐵(𝑡, 𝑇) by solving the PDE satisfied by 𝑃(𝑡, 𝑇).
Hence, show the volatility of the zero-coupon bond to be
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
(d) To reduce the dimensionality of the PDE satisfied by 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡), let
̂𝑆𝑡=
𝑆𝑡
𝑃(𝑡, 𝑇)
and
̂𝑉( ̂𝑆𝑡, 𝑡) = 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡)
𝑃(𝑡, 𝑇)

182
2.2.2 Black–Scholes Model
and using the zero-coupon bond price PDE, show that ̂𝑉( ̂𝑆𝑡, 𝑡) satisfies
𝜕̂𝑉
𝜕𝑡+ 1
2𝜎(𝑡, 𝑇)2 ̂𝑆𝑡
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
−𝐷𝑡̂𝑆𝑡
𝜕̂𝑉𝑡
𝜕̂𝑆𝑡
= 0
with boundary condition
̂𝑉( ̂𝑆𝑡, 𝑇) = Ψ( ̂𝑆𝑇)
where 𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇) and Ψ( ̂𝑆𝑇) = Ψ(𝑆𝑇)
𝑃(𝑇, 𝑇).
(e) Finally, for a payoff
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0}
deduce that the European put option price with strike price 𝐾under stochastic interest
rate is
𝑃stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑃(𝑡, 𝑇)Φ(−𝑑−) −𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(−𝑑+)
where
𝑑± =
log (𝑆𝑡∕(𝑃(𝑡, 𝑇)𝐾)) −∫
𝑇
𝑡
(
𝐷𝑢∓1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢
√
∫𝑇
𝑡𝜎(𝑢, 𝑇)2 𝑑𝑢
,
𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇),
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡))
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution:
(a) We let the portfolio at time 𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) −Δ1𝑆𝑡−Δ2𝑃(𝑡, 𝑇)
where it consists of purchasing one unit of option, and selling Δ1 and Δ2 units of risky
asset 𝑆𝑡and zero-coupon bond 𝑃(𝑡, 𝑇) respectively. Since the holder of the portfolio

2.2.2 Black–Scholes Model
183
receives 𝐷𝑡𝑆𝑡𝑑𝑡for every asset held and because the investor holds −Δ1𝑆𝑡, the port-
folio changes by an amount −Δ1𝐷𝑡𝑆𝑡𝑑𝑡and therefore the change in portfolio Π𝑡is
𝑑Π𝑡= 𝑑𝑉−Δ1(𝑑𝑆𝑡+ 𝐷𝑡𝑆𝑡𝑑𝑡) −Δ2𝑑𝑃(𝑡, 𝑇)
= 𝑑𝑉−Δ1𝑑𝑆𝑡−Δ1𝐷𝑡𝑆𝑡𝑑𝑡−Δ2𝑑𝑃(𝑡, 𝑇)
= 𝑑𝑉−Δ1
(𝜇𝑡𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
)
−Δ2
(𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑊𝑟
𝑡
)
= 𝑑𝑉−(Δ1𝜇𝑡𝑆𝑡+ Δ2𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)) 𝑑𝑡−Δ1𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
−Δ2𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑊𝑟
𝑡.
Expanding 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 𝜕𝑉
𝜕𝑟𝑡
𝑑𝑟𝑡+ 1
2
𝜕2𝑉
𝜕𝑡2 (𝑑𝑡)2 + 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2
+1
2
𝜕2𝑉
𝜕𝑟2
𝑡
(𝑑𝑟𝑡)2 + 𝜕2𝑉
𝜕𝑡𝜕𝑆𝑡
(𝑑𝑡)(𝑑𝑆𝑡) + 𝜕2𝑉
𝜕𝑡𝜕𝑟𝑡
(𝑑𝑡)(𝑑𝑟𝑡)
+ 𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
(𝑑𝑆𝑡)(𝑑𝑟𝑡) + …
and substituting 𝑑𝑆𝑡= (𝜇𝑡−𝐷𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
and 𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡) + 𝛼𝑑𝑊𝑟
𝑡, and
applying It¯o’s lemma,
𝑑𝑉=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
+(𝜇𝑡−𝐷𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑟𝑡)𝜕𝑉
𝜕𝑟𝑡
)
𝑑𝑡+ 𝜎𝑡𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑆
𝑡
+ 𝛼𝜕𝑉
𝜕𝑟𝑡
𝑑𝑊𝑟
𝑡.
Substituting back into 𝑑Π𝑡and rearranging the terms, we have
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
+(𝜇𝑡−𝐷𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑟𝑡)𝜕𝑉
𝜕𝑟𝑡
−Δ1𝜇𝑡𝑆𝑡−Δ2𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)
)
𝑑𝑡
+𝜎𝑡𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ1
)
𝑑𝑊𝑆
𝑡
+
(
𝛼𝜕𝑉
𝜕𝑟𝑡
−Δ2𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)
)
𝑑𝑊𝑟
𝑡.
To eliminate the random components, we set
Δ1 = 𝜕𝑉
𝜕𝑆𝑡
and
Δ2 = 𝛼𝜎𝑝(𝑡, 𝑇)−1𝑃(𝑡, 𝑇)−1 𝜕𝑉
𝜕𝑟𝑡

184
2.2.2 Black–Scholes Model
leading to
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
−𝐷𝑡𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+
(
𝜅(𝜃−𝑟𝑡) −𝛼
𝜇𝑝(𝑡, 𝑇)
𝜎𝑝(𝑡, 𝑇)
)
𝜕𝑉
𝜕𝑟𝑡
]
𝑑𝑡.
Under no arbitrage condition, the return on the amount Π𝑡invested in a interest rate
would see a growth of
𝑑Π𝑡= 𝑟𝑡Π𝑡𝑑𝑡
and hence we have
𝑟𝑡
(
𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−
𝛼
𝜎𝑝(𝑡, 𝑇)
𝜕𝑉
𝜕𝑟𝑡
)
𝑑𝑡
=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
−𝐷𝑡𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+
(
𝜅(𝜃−𝑟𝑡) −𝛼
𝜇𝑝(𝑡, 𝑇)
𝜎𝑝(𝑡, 𝑇)
)
𝜕𝑉
𝜕𝑟𝑡
]
𝑑𝑡.
Removing 𝑑𝑡and rearranging the terms we finally have the Black-Scholes equation
under stochastic interest rate
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛼2 𝜕2𝑉
𝜕𝑟2
𝑡
+ 𝜌𝛼𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
+ (𝑟𝑡−𝐷𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑉
𝜕𝑟𝑡
−𝑟𝑡𝑉(𝑆𝑡, 𝑟𝑡, 𝑡) = 0
with boundary condition
𝑉(𝑆𝑇, 𝑟𝑇, 𝑇) = Ψ(𝑆𝑇)
where 𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
is the market price of risk of the interest rate.
(b) To find the PDE satisfied by the zero-coupon bond 𝑃(𝑡, 𝑇), from Taylor’s theorem
𝑑𝑃(𝑡, 𝑇) = 𝜕𝑃
𝜕𝑡𝑑𝑡+ 𝜕𝑃
𝜕𝑟𝑡
𝑑𝑟𝑡+ 1
2
𝜕2𝑃
𝜕𝑟2
𝑡
(𝑑𝑟𝑡)2 + …
and substituting 𝑑𝑟𝑡= 𝜅(𝜃−𝑟𝑡)𝑑𝑡+ 𝛼𝑑𝑊𝑟
𝑡and using It¯o’s formula
𝑑𝑃(𝑡, 𝑇) =
(
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ 𝜅(𝜃−𝑟𝑡)𝜕𝑃
𝜕𝑟𝑡
)
𝑑𝑡+ 𝛼𝜕𝑃
𝜕𝑟𝑡
𝑑𝑊𝑟
𝑡.

2.2.2 Black–Scholes Model
185
By equating coefficients with 𝑑𝑃(𝑡, 𝑇) = 𝜇𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑡+ 𝜎𝑝(𝑡, 𝑇)𝑃(𝑡, 𝑇)𝑑𝑊𝑟
𝑡we
have
𝜇𝑝(𝑡, 𝑇) =
(
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ 𝜅(𝜃−𝑟𝑡)𝜕𝑃
𝜕𝑟𝑡
)
𝑃(𝑡, 𝑇)−1
and
𝜎𝑝(𝑡, 𝑇) = 𝛼𝑃(𝑡, 𝑇)−1 𝜕𝑃
𝜕𝑟𝑡
.
Substituting the expressions of 𝜇𝑝(𝑡, 𝑇) and 𝜎𝑝(𝑡, 𝑇) into the market price of risk
formula
𝛾𝑡=
𝜇𝑝(𝑡, 𝑇) −𝑟𝑡
𝜎𝑝(𝑡, 𝑇)
we will have
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0
with boundary condition
𝑃(𝑇, 𝑇) = 1.
(c) By setting 𝛾𝑡= 𝛾where 𝛾is a constant value and writing ̃𝜃= 𝜃−𝛼𝛾
𝜅, we therefore
have
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+
(
𝜅(̃𝜃−𝑟𝑡)
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0
with boundary condition
𝑃(𝑇, 𝑇) = 1.
By substituting
𝜕𝑃
𝜕𝑡=
(𝜕𝐴
𝜕𝑡−𝑟𝑡
𝜕𝐵
𝜕𝑡
)
𝑃(𝑡, 𝑇),
𝜕𝑃
𝜕𝑟𝑡
= −𝐵(𝑡, 𝑇)𝑃(𝑡, 𝑇),
𝜕2𝑃
𝜕𝑟2
𝑡
= 𝐵(𝑡, 𝑇)2𝑃(𝑡, 𝑇)
into the PDE and equating coefficients we eventually have
𝜕𝐵
𝜕𝑡= 𝜅𝐵(𝑡, 𝑇) −1
𝜕𝐴
𝜕𝑡= 𝜅̃𝜃𝐵(𝑡, 𝑇) −1
2𝛼2𝐵(𝑡, 𝑇)2.

186
2.2.2 Black–Scholes Model
Solving 𝜕𝐵
𝜕𝑡−𝜅𝐵(𝑡, 𝑇) = −1 we let the integrating factor be 𝐼= 𝑒−𝜅𝑡, and thus
𝑑
𝑑𝑡
(𝑒−𝜅𝑡𝐵(𝑡, 𝑇)) = −𝑒−𝜅𝑡
𝑒−𝜅𝑡𝐵(𝑡, 𝑇) = 𝑒−𝜅𝑡
𝜅
+ 𝐶
where 𝐶is a constant.
At time 𝑡= 𝑇, 𝐵(𝑇, 𝑇) = 0 and hence 𝐶= −𝑒−𝜅𝑇
𝜅
. Thus,
𝐵(𝑡, 𝑇) = 1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
Solving 𝜕𝐴
𝜕𝑡= 𝜅̃𝜃𝐵(𝑡, 𝑇) −1
2𝛼2𝐵(𝑡, 𝑇)2 and because 𝐴(𝑇, 𝑇) = 0, we have
𝐴(𝑡, 𝑇) = 1
2𝛼2
∫
𝑇
𝑡
𝐵(𝑢, 𝑇) 𝑑𝑢−𝜅̃𝜃∫
𝑇
𝑡
𝐵(𝑢, 𝑇) 𝑑𝑢.
Since
∫
𝑇
𝑡
𝐵(𝑢, 𝑇) 𝑑𝑢= 1
𝜅∫
𝑇
𝑡
(1 −𝑒−𝜅(𝑇−𝑢)) 𝑑𝑢
= 1
𝜅
(
𝑇−𝑡−1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)))
= 1
𝜅(𝑇−𝑡−𝐵(𝑡, 𝑇))
and
∫
𝑇
𝑡
𝐵(𝑢, 𝑇)2 𝑑𝑢= 1
𝜅2 ∫
𝑇
𝑡
(1 −2𝑒−𝜅(𝑇−𝑢) + 𝑒2𝜅(𝑇−𝑢)) 𝑑𝑢
= 1
𝜅2 (𝑇−𝑡−2𝐵(𝑡, 𝑇)) + 1
2𝜅
(
1 −𝑒−2𝜅(𝑇−𝑡)
𝜅2
)
= 1
𝜅2
(
𝑇−𝑡−𝐵(𝑡, 𝑇) −𝜅
2 𝐵(𝑡, 𝑇)2)
we have
𝐴(𝑡, 𝑇) = 1
2
(𝛼
𝜅
)2 (
𝑇−𝑡−𝐵(𝑡, 𝑇) −𝜅
2 𝐵(𝑡, 𝑇)2)
−̃𝜃(𝑇−𝑡−𝐵(𝑡, 𝑇))
=
(
̃𝜃−1
2
(𝛼
𝜅
)2)
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
4𝜅𝐵(𝑡, 𝑇)2.

2.2.2 Black–Scholes Model
187
Therefore, the bond price is
𝑃(𝑡, 𝑇) = 𝑒𝐴(𝑡,𝑇)−𝑟𝑡𝐵(𝑡,𝑇)
where
𝐴(𝑡, 𝑇) =
(
̃𝜃−1
2
(𝛼
𝜅
)2)
(𝐵(𝑡, 𝑇) −𝑇+ 𝑡) −𝛼2
4𝜅𝐵(𝑡, 𝑇)2
and
𝐵(𝑡, 𝑇) = 1
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
Furthermore, the volatility of the zero-coupon bond is given as
𝜎𝑝(𝑡, 𝑇) = 𝛼𝜕𝑃
𝜕𝑟𝑡
𝑃(𝑡, 𝑇)−1
= −𝛼𝐵(𝑡, 𝑇)
= −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
(d) By setting
̂𝑆𝑡=
𝑆𝑡
𝑃(𝑡, 𝑇)
and
̂𝑉( ̂𝑆𝑡, 𝑡) = 𝑉(𝑆𝑡, 𝑟𝑡, 𝑡)
𝑃(𝑡, 𝑇)
we have the following
𝜕𝑉
𝜕𝑡= ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑡+ 𝑃(𝑡, 𝑇)𝜕̂𝑉
𝜕𝑡+ 𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑡𝑃(𝑡, 𝑇)
= ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑡+ 𝑃(𝑡, 𝑇)𝜕̂𝑉
𝜕𝑡−
𝑆𝑡
𝑃(𝑡, 𝑇)2
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑡𝑃(𝑡, 𝑇)
= ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑡+ 𝑃(𝑡, 𝑇)𝜕̂𝑉
𝜕𝑡−̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑡,
𝜕𝑉
𝜕𝑆𝑡
= 𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
𝑃(𝑡, 𝑇) = 𝜕̂𝑉
𝜕̂𝑆𝑡
,
𝜕2𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝜕̂𝑉
𝜕̂𝑆𝑡
)
= 𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
=
1
𝑃(𝑡, 𝑇)
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
,

188
2.2.2 Black–Scholes Model
𝜕𝑉
𝜕𝑟𝑡
= 𝑃(𝑡, 𝑇) 𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑟𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑟𝑡
= −𝑃(𝑡, 𝑇) 𝜕̂𝑉
𝜕̂𝑆𝑡
𝑆𝑡
𝑃(𝑡, 𝑇)2
𝜕𝑃
𝜕𝑟𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑟𝑡
= −̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑟𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕𝑃
𝜕𝑟𝑡
,
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑟𝑡
=
𝜕2𝑉
𝜕𝑟𝑡𝜕𝑆𝑡
= 𝜕
𝜕𝑟𝑡
(
𝜕̂𝑉
𝜕̂𝑆𝑡
)
= 𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑟𝑡
= −
̂𝑆𝑡
𝑃(𝑡, 𝑇)
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
𝜕𝑃
𝜕𝑟𝑡
,
𝜕2𝑉
𝜕𝑟2
𝑡
= −𝜕̂𝑆𝑡
𝜕𝑟𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑟𝑡
−̂𝑆𝑡
𝜕2𝑉
𝜕𝑟𝑡𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑟𝑡
−̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕2𝑃
𝜕𝑟2
𝑡
+ 𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑟𝑡
𝜕𝑃
𝜕𝑟𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕2𝑃
𝜕𝑟2
𝑡
= −
(
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑃
𝜕𝑟𝑡
)
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑟𝑡
+
̂𝑆2
𝑡
𝑃(𝑡, 𝑇)
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
(
𝜕𝑃
𝜕𝑟𝑡
)2
−̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕2𝑃
𝜕𝑟2
𝑡
+ 𝜕̂𝑉
𝜕̂𝑆𝑡
(
𝜕̂𝑆𝑡
𝜕𝑃
𝜕𝑃
𝜕𝑟𝑡
)
𝜕𝑃
𝜕𝑟𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕2𝑃
𝜕𝑟2
𝑡
=
̂𝑆2
𝑡
𝑃(𝑡, 𝑇)
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
(
𝜕𝑃
𝜕𝑟𝑡
)2
−̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
𝜕2𝑃
𝜕𝑟2
𝑡
+ ̂𝑉( ̂𝑆𝑡, 𝑡)𝜕2𝑃
𝜕𝑟2
𝑡
.
Substituting the above expressions into the Black-Scholes model under stochastic
interest rate, dividing it by 𝑃(𝑡, 𝑇) and taking note that 𝜎𝑝(𝑡, 𝑇) = 𝛼𝑃(𝑡, 𝑇)−1 𝜕𝑃
𝜕𝑟𝑡
, we
will eventually have
𝜕̂𝑉
𝜕𝑡+ 1
2
(𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)) ̂𝑆2
𝑡
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
−𝐷𝑡̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
+
(
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇)
) ̂𝑉( ̂𝑆𝑡, 𝑡)
𝑃(𝑡, 𝑇)
−
(
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇)
)
̂𝑆𝑡
𝑃(𝑡, 𝑇)
𝜕̂𝑉
𝜕̂𝑆𝑡
= 0.
Since
𝜕𝑃
𝜕𝑡+ 1
2𝛼2 𝜕2𝑃
𝜕𝑟2
𝑡
+ (𝜅(𝜃−𝑟𝑡) −𝛼𝛾𝑡
) 𝜕𝑃
𝜕𝑟𝑡
−𝑟𝑡𝑃(𝑡, 𝑇) = 0

2.2.2 Black–Scholes Model
189
therefore we have the reduced Black-Scholes equation of the form
𝜕̂𝑉
𝜕𝑡+ 1
2𝜎(𝑡, 𝑇)2 ̂𝑆2
𝑡
𝜕2 ̂𝑉
𝜕̂𝑆2
𝑡
−𝐷𝑡̂𝑆𝑡
𝜕̂𝑉
𝜕̂𝑆𝑡
= 0
with boundary condition
̂𝑉( ̂𝑆𝑇, 𝑇) = Ψ( ̂𝑆𝑇)
where
𝜎(𝑡, 𝑇)2 = 𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇)2 −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇)
and
Ψ( ̂𝑆𝑇) = Ψ(𝑆𝑇)
𝑃(𝑇, 𝑇).
(e) By writing ̂𝑃𝑏𝑠( ̂𝑆𝑡, 𝑡; 𝐾, 𝑇) as the European put option price at time 𝑡satisfying the
reduced Black-Scholes equation with payoff
̂𝑃𝑏𝑠( ̂𝑆𝑇, 𝑇; 𝐾, 𝑇) =
1
𝑃(𝑇, 𝑇) max{𝐾−𝑆𝑇, 0} = max{𝐾−̂𝑆𝑇}
where ̂𝑆𝑇=
𝑆𝑇
𝑃(𝑇, 𝑇), 𝑃(𝑇, 𝑇) = 1, 𝐾is the strike price and 𝑇> 𝑡, then the solution
can be deduced as
̂𝑃𝑏𝑠( ̂𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾Φ(−𝑑−) −̂𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(−𝑑+)
𝑑± =
log( ̂𝑆𝑡∕𝐾) −∫
𝑇
𝑡
(
𝐷𝑢∓1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢
√
∫𝑇
𝑡𝜎(𝑢, 𝑇)2 𝑑𝑢
.
Hence, by setting back ̂𝑆𝑡= 𝑃(𝑡, 𝑇)−1𝑆𝑡, the European put option price at time 𝑡under
stochastic interest rate, 𝑃stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) is
𝑃stochIR(𝑆𝑡, 𝑟𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑡, 𝑇) ̂𝑃𝑏𝑠( ̂𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐾𝑃(𝑡, 𝑇)Φ(−𝑑−) −̂𝑆𝑡𝑃(𝑡, 𝑇)𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(−𝑑+)
= 𝐾𝑃(𝑡, 𝑇)Φ(−𝑑−) −𝑆𝑡𝑒−∫𝑇
𝑡
𝐷𝑢𝑑𝑢Φ(−𝑑+)
where
𝑑± =
log (𝑆𝑡∕(𝑃(𝑡, 𝑇)𝐾)) −∫
𝑇
𝑡
(
𝐷𝑢∓1
2𝜎(𝑢, 𝑇)2)
𝑑𝑢
√
∫𝑇
𝑡𝜎(𝑢, 𝑇)2 𝑑𝑢
,

190
2.2.3 Tree-Based Methods
𝜎(𝑡, 𝑇) =
√
𝜎2
𝑡+ 𝜎𝑝(𝑡, 𝑇) −2𝜌𝜎𝑡𝜎𝑝(𝑡, 𝑇),
and
𝜎𝑝(𝑡, 𝑇) = −𝛼
𝜅
(1 −𝑒−𝜅(𝑇−𝑡)) .
2.2.3
Tree-Based Methods
1. Risk-Neutral Approach. At time 𝑡, the value of the stock is 𝑆𝑡and at time 𝑇> 𝑡, the price
has moved to either 𝑢𝑆𝑡or 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. We assume under continuous compounding
that there is a risk-free interest rate 𝑟and the stock pays a continuous dividend yield 𝐷
where it follows a GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
such that 𝜇is the drift, 𝜎is the volatility and {𝑊𝑡: 𝑡≥0} is the ℙ-standard Wiener process
on the probability space (Ω, ℱ, ℙ).
Suppose 0 < 𝑑< 𝑒(𝑟−𝐷)(𝑇−𝑡) < 𝑢, show that the risk-neutral probabilities for upward
and downward movement of the stock price are
𝜋= 𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑
𝑢−𝑑
and
1 −𝜋= 𝑢−𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑢−𝑑
respectively.
Prove that 0 < 𝜋< 1.
Hence, find the market price of a European call option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) which expires at
time 𝑇with strike price 𝐾.
Solution: We first need to find the risk-neutral probabilities 𝜋, 1 −𝜋for upward/downward
movement of the stock price where, under the risk-neutral probability measure ℚ
𝔼ℚ(𝑆𝑇|| 𝑆𝑡
) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡).
Since the stock price would grow to either 𝑢𝑆𝑡with probability 𝜋or 𝑑𝑆𝑡with probability
1 −𝜋, we therefore have
𝜋𝑢𝑆𝑡+ (1 −𝜋)𝑑𝑆𝑡= 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
such that
𝜋= 𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑
𝑢−𝑑
and
1 −𝜋= 𝑢−𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑢−𝑑
.

2.2.3 Tree-Based Methods
191
Since 0 < 𝑑< 𝑒(𝑟−𝐷)(𝑇−𝑡) < 𝑢we have
𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑> 0
and
𝑢−𝑑> 0
and hence, 𝜋> 0. In addition, because 0 < 𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑< 𝑢−𝑑, therefore 𝜋< 1.
Hence, the European call option price at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max {𝑆𝑇−𝐾, 0}||| 𝑆𝑡
]
= 𝑒−𝑟(𝑇−𝑡) [𝜋max {𝑆𝑇−𝐾, 0} + (1 −𝜋) max {𝑆𝑇−𝐾, 0}]
= 𝑒−𝑟(𝑇−𝑡)
[(
𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑
𝑢−𝑑
)
max {𝑢𝑆𝑡−𝐾, 0}
+
(
𝑢−𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑢−𝑑
)
max {𝑑𝑆𝑡−𝐾, 0}]
.
2. Self-Financing Trading Strategy Approach. At time 𝑡, the value of the stock is 𝑆𝑡and at
time 𝑇> 𝑡, the price has moved to either 𝑢𝑆𝑡or 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. We assume under contin-
uous compounding that there is a risk-free interest rate 𝑟and the stock pays a continuous
dividend yield 𝐷.
Suppose 0 < 𝑑< 𝑒(𝑟−𝐷)(𝑇−𝑡) < 𝑢. Denoting 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) as the market price of a Euro-
pean put option which expires at time 𝑇with strike price 𝐾, show by setting up a portfolio
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡
where 𝜙𝑡is the number of units of 𝑆𝑡and 𝜓𝑡is the amount of cash invested in the money
market that
𝜙𝑡= 𝑒−𝐷(𝑇−𝑡)
[𝑉(𝑢𝑆𝑡, 𝑇) −𝑉(𝑑𝑆𝑡, 𝑇)
(𝑢−𝑑)𝑆𝑡
]
and
𝜓𝑡= 𝑒−𝑟(𝑇−𝑡)
[𝑢𝑉(𝑑𝑆𝑡, 𝑇) −𝑑𝑉(𝑢𝑆𝑡, 𝑇)
𝑢−𝑑
]
.
Hence, find the price of a European put option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) which expires at time 𝑇with
strike price 𝐾.
Solution: At time 𝑡, the portfolio is worth
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡
where 𝜙𝑡is the number of units of 𝑆𝑡and 𝜓𝑡is the amount of cash invested in the money
market.

192
2.2.3 Tree-Based Methods
Given that 𝑆𝑡pays a continuous dividend yield 𝐷, then at time 𝑇the number of stocks
and the amount of cash will grow to 𝜙𝑡𝑒𝐷(𝑇−𝑡) and 𝜓𝑒𝑟(𝑇−𝑡), respectively. Because 𝑆𝑇can
either be 𝑆𝑇= 𝑢𝑆𝑡or 𝑆𝑇= 𝑑𝑆𝑡, we can write
𝑉(𝑢𝑆𝑡, 𝑇; 𝐾, 𝑇) = 𝜙𝑡𝑒𝐷(𝑇−𝑡)𝑢𝑆𝑡+ 𝜓𝑡𝑒𝑟(𝑇−𝑡)
and
𝑉(𝑑𝑆𝑡, 𝑇; 𝐾, 𝑇) = 𝜙𝑡𝑒𝐷(𝑇−𝑡)𝑑𝑆𝑡+ 𝜓𝑡𝑒𝑟(𝑇−𝑡).
Hence, by solving the two equations we have
𝜙𝑡= 𝑒−𝐷(𝑇−𝑡)
[𝑉(𝑢𝑆𝑡, 𝑇; 𝐾, 𝑇) −𝑉(𝑑𝑆𝑡, 𝑇; 𝐾, 𝑇)
(𝑢−𝑑)𝑆𝑡
]
and
𝜓𝑡= 𝑒−𝑟(𝑇−𝑡)(𝑉(𝑢𝑆𝑡, 𝑇; 𝐾, 𝑇) −𝜙𝑡𝑒𝐷(𝑇−𝑡)𝑢𝑆𝑡)
= 𝑒−𝑟(𝑇−𝑡)
[𝑢𝑉(𝑑𝑆𝑡, 𝑇; 𝐾, 𝑇) −𝑑𝑉(𝑢𝑆𝑡, 𝑇; 𝐾, 𝑇)
𝑢−𝑑
]
.
Finally, because
𝑉(𝑢𝑆𝑡, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑢𝑆𝑡, 0}and 𝑉(𝑑𝑆𝑡, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑑𝑆𝑡, 0}
therefore
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜙𝑡𝑆𝑡+ 𝜓𝑡
= 𝑒−𝑟(𝑇−𝑡)
[(
𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑
𝑢−𝑑
)
max {𝐾−𝑢𝑆𝑡, 0}
+
(
𝑢−𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑢−𝑑
)
max {𝐾−𝑑𝑆𝑡, 0}]
.
3. By referring to Problems 2.2.3.1 and 2.2.3.2 explain why, when we drop the assumption
0 < 𝑑< 𝑒(𝑟−𝐷)(𝑇−𝑡) < 𝑢, there is an arbitrage opportunity.
Solution: To show that there is an arbitrage opportunity if we drop the assumption 0 < 𝑑<
𝑒(𝑟−𝐷)(𝑇−𝑡) < 𝑢we first assume 𝑑≥𝑒(𝑟−𝐷)(𝑇−𝑡) then, at time 𝑡, a speculator can borrow from
the money market in order to buy stock worth 𝑆𝑡. At time 𝑇, the stock price is worth either
𝑢𝑆𝑡or 𝑑𝑆𝑡which is enough to pay off the money-market debt since 𝑢> 𝑑≥𝑒(𝑟−𝐷)(𝑇−𝑡).
Hence, this provides an arbitrage.
In contrast, if 𝑢≤𝑒(𝑟−𝐷)(𝑇−𝑡), a speculator can short sell the stock worth 𝑆𝑡at time 𝑡
and invest the proceeds in the money market whilst paying dividends to the owner of the
stock. By time 𝑇, the money invested is worth 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and by replacing the cost of

2.2.3 Tree-Based Methods
193
the stock, and since 𝑑< 𝑢≤𝑒(𝑟−𝐷)(𝑇−𝑡), the profit would either be 𝑆𝑡(𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑢) ≥0
or 𝑆𝑡(𝑒(𝑟−𝐷)(𝑇−𝑡) −𝑑) ≥0 which is also an arbitrage.
4. Cox–Ross–Rubinstein Method. At time 𝑡, the value of the asset is 𝑆𝑡and at time 𝑡+ Δ𝑡,
Δ𝑡> 0 the asset price is either increased to 𝑢𝑆𝑡or decreased to 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. In addition,
under continuous compounding there is a risk-free interest rate 𝑟and the asset pays a
continuous dividend yield 𝐷. By assuming the asset price follows the geometric Brownian
motion such that under the risk-neutral measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
where 𝜎is the asset price volatility, show by using the first two moments of 𝑆𝑡+Δ𝑡given
𝑆𝑡that
𝜋𝑢+ (1 −𝜋)𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋𝑢2 + (1 −𝜋)𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
where 𝜋and 1 −𝜋are the risk-neutral probabilities of upward and downward movement
of the asset price, respectively.
By setting 𝑢= 1
𝑑show that
𝑢= 𝐴+
√
𝐴2 −1,
𝑑= 𝐴−
√
𝐴2 −1
and
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
where 𝐴= 1
2
[
𝑒−(𝑟−𝐷)Δ𝑡+ 𝑒(𝑟−𝐷+𝜎2)Δ𝑡]
.
By expanding 𝑢and 𝑑up to (Δ𝑡) show that
𝑢= 𝑒𝜎
√
Δ𝑡
and
𝑑= 𝑒−𝜎
√
Δ𝑡
and to ensure 𝜋, 1 −𝜋∈(0, 1) deduce that
0 < Δ𝑡<
(
𝜎
𝑟−𝐷
)2
.
Solution: Since log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
, therefore the expectation
and variance of 𝑆𝑡+Δ𝑡given 𝑆𝑡are
𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝑆𝑡𝑒(𝑟−𝐷)Δ𝑡
and
Varℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡(
𝑒𝜎2Δ𝑡−1
)
.

194
2.2.3 Tree-Based Methods
Thus,
𝔼ℚ(
𝑆2
𝑡+Δ𝑡
||| 𝑆𝑡
)
= Varℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) + [𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
)]2
= 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡(
𝑒𝜎2Δ𝑡−1
)
+ 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡
= 𝑆2
𝑡𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡.
As the asset price at time 𝑡+ Δ𝑡could grow to either 𝑢𝑆𝑡or 𝑑𝑆𝑡with risk-neutral proba-
bilities 𝜋and 1 −𝜋, respectively, therefore
𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝜋𝑢𝑆𝑡+ (1 −𝜋)𝑑𝑆𝑡
𝔼ℚ(
𝑆2
𝑡+Δ𝑡
||| 𝑆𝑡
)
= 𝜋𝑢2𝑆2
𝑡+ (1 −𝜋)𝑑2𝑆2
𝑡.
Hence, by equating the continuous risk-neutral random walk and the discrete binomial
model we have
𝜋𝑢+ (1 −𝜋)𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋𝑢2 + (1 −𝜋)𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡.
From
𝜋𝑢+ (1 −𝜋)𝑑= 𝑒(𝑟−𝐷)Δ𝑡
we have
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
.
In addition, because
𝜋𝑢2 + (1 −𝜋)𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
we can also write
𝜋= 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑑2
𝑢2 −𝑑2
.
Thus,
𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
= 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑑2
𝑢2 −𝑑2
or
𝑢+ 𝑑= 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑑2
𝑒(𝑟−𝐷)Δ𝑡−𝑑
.

2.2.3 Tree-Based Methods
195
By setting 𝑢= 1
𝑑,
1
𝑑+ 𝑑= 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑑2
𝑒(𝑟−𝐷)Δ𝑡−𝑑
or
𝑑2 −2𝐴𝑑+ 1 = 0
where 𝐴= 1
2
[
𝑒−(𝑟−𝐷)Δ𝑡+ 𝑒(𝑟−𝐷+𝜎2)Δ𝑡]
. Hence,
𝑑= 𝐴±
√
𝐴2 −1
and because 𝑑< 𝑢we can therefore set
𝑑= 𝐴−
√
𝐴2 −1
and
𝑢= 𝐴+
√
𝐴2 −1.
From Taylor’s theorem we can expand 𝐴and 𝐴2 as
𝐴= 1
2
[
𝑒−(𝑟−𝐷)Δ𝑡+ 𝑒(𝑟−𝐷+𝜎2)Δ𝑡]
= 1
2
[1 −(𝑟−𝐷)Δ𝑡+ 1 + (𝑟−𝐷+ 𝜎2)Δ𝑡+ (Δ𝑡2)]
= 1 + 1
2𝜎2Δ𝑡+ (Δ𝑡2)
and
𝐴2 = 1
4
[
𝑒−(𝑟−𝐷)Δ𝑡+ 𝑒(𝑟−𝐷+𝜎2)Δ𝑡]2
= 1
4
[
𝑒−2(𝑟−𝐷)Δ𝑡+ 2𝑒𝜎2Δ𝑡+ 𝑒2(𝑟−𝐷+𝜎2)Δ𝑡]
= 1
4
[1 −2(𝑟−𝐷)Δ𝑡+ 2(1 + 𝜎2Δ𝑡) + 1 + 2(𝑟−𝐷+ 𝜎2)Δ𝑡] + (Δ𝑡2)
= 1 + 𝜎2Δ𝑡+ (Δ𝑡2).
Therefore,
𝑑= 1 −𝜎
√
Δ𝑡+ (Δ𝑡)
and
𝑢= 1 + 𝜎
√
Δ𝑡+ (Δ𝑡)
or
𝑑= 𝑒−𝜎
√
Δ𝑡
and
𝑢= 𝑒𝜎
√
Δ𝑡
since the terms 1 −𝜎
√
Δ𝑡+ (Δ𝑡) and 1 + 𝜎
√
Δ𝑡+ (Δ𝑡) agree with 𝑒−𝜎
√
Δ𝑡and 𝑒𝜎
√
Δ𝑡
up to (Δ𝑡), respectively.

196
2.2.3 Tree-Based Methods
Finally, to ensure
0 < 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
< 1
or
0 < 𝑒(𝑟−𝐷)Δ𝑡−𝑒−𝜎
√
Δ𝑡
𝑒𝜎
√
Δ𝑡−𝑒−𝜎
√
Δ𝑡
< 1
and by solving the inequality we have
0 < Δ𝑡<
(
𝜎
𝑟−𝐷
)2
.
5. Jarrow–Rudd Method. At time 𝑡, the value of the asset is 𝑆𝑡and at time 𝑡+ Δ𝑡, Δ𝑡> 0 the
asset price is either increased to 𝑢𝑆𝑡or decreased to 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. In addition, under
continuous compounding there is a risk-free interest rate 𝑟and the asset pays a continuous
dividend yield 𝐷. By assuming the asset price follows the geometric Brownian motion
such that under the risk-neutral measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
where 𝜎is the asset price volatility, show by using the first two moments of 𝑆𝑡+Δ𝑡given
𝑆𝑡that
𝜋𝑢+ (1 −𝜋)𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋𝑢2 + (1 −𝜋)𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
where 𝜋and 1 −𝜋are the risk-neutral probabilities of upward and downward movement
of the asset price, respectively.
By setting 𝜋= 1
2 show that
𝑑= 𝑒(𝑟−𝐷)Δ𝑡(
1 −
√
𝑒𝜎2Δ𝑡−1
)
and
𝑢= 𝑒(𝑟−𝐷)Δ𝑡(
1 +
√
𝑒𝜎2Δ𝑡−1
)
and to ensure 0 < 𝑑< 𝑒(𝑟−𝐷)Δ𝑡< 𝑢, deduce that
0 < Δ𝑡< log 2
𝜎2 .
Solution: To show
𝜋𝑢+ (1 −𝜋)𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋𝑢2 + (1 −𝜋)𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
see Problem 2.2.3.4 (page 193).

2.2.3 Tree-Based Methods
197
By setting 𝜋= 1
2 we have
𝑢+ 𝑑= 2𝑒(𝑟−𝐷)Δ𝑡
𝑢2 + 𝑑2 = 2𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
and letting 𝑢= 2𝑒(𝑟−𝐷)Δ𝑡−1 we have
𝑑2 −2𝑒(𝑟−𝐷)Δ𝑡𝑑+ 2𝑒(𝑟−𝐷)Δ𝑡−𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
or
𝑑= 𝑒(𝑟−𝐷)Δ𝑡(
1 ±
√
𝑒𝜎2Δ𝑡−1
)
.
Since 𝑑< 𝑢we therefore have
𝑑= 𝑒(𝑟−𝐷)Δ𝑡(
1 −
√
𝑒𝜎2Δ𝑡−1
)
and
𝑢= 𝑒(𝑟−𝐷)Δ𝑡(
1 +
√
𝑒𝜎2Δ𝑡−1
)
.
Finally, to ensure that 0 < 𝑑< 𝑒(𝑟−𝐷)Δ𝑡< 𝑢,
0 < 𝑒(𝑟−𝐷)Δ𝑡(
1 −
√
𝑒𝜎2Δ𝑡−1
)
< 𝑒(𝑟−𝐷)Δ𝑡
and solving the inequality we eventually obtain
0 < Δ𝑡< log 2
𝜎2 .
6. Boyle Method. We consider a trinomial model where at time 𝑡, the value of the asset is 𝑆𝑡
and at time 𝑡+ Δ𝑡, Δ𝑡> 0 the asset price is increased to 𝑢𝑆𝑡, unchanged 𝑆𝑡or decreased
to 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. In addition, under continuous compounding there is a risk-free interest
rate 𝑟and the asset pays a continuous dividend yield 𝐷. By assuming the asset price follows
the geometric Brownian motion such that under the risk-neutral measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
where 𝜎is the asset price volatility, show by using the first two moments of 𝑆𝑡+Δ𝑡given
𝑆𝑡that
𝜋1𝑢+ 𝜋2 + 𝜋3𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋1𝑢2 + 𝜋2 + 𝜋3𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
𝜋1 + 𝜋2 + 𝜋3 = 1

198
2.2.3 Tree-Based Methods
where 𝜋1, 𝜋2 and 𝜋3 are the risk-neutral probabilities of upward, unchanged and downward
movement of the asset price, respectively.
By setting 𝑢= 1
𝑑and 𝑢= 𝑒𝜆𝜎
√
Δ𝑡, 𝜆> 0 show that
𝜋1 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑒𝜆𝜎
√
Δ𝑡−(𝑒(𝑟−𝐷)Δ𝑡−1)
(𝑒𝜆𝜎
√
Δ𝑡−1)(𝑒2𝜆𝜎
√
Δ𝑡−1)
𝜋3 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑒2𝜆𝜎
√
Δ𝑡−(𝑒(𝑟−𝐷)Δ𝑡−1) 𝑒3𝜆𝜎
√
Δ𝑡
(𝑒𝜆𝜎
√
Δ𝑡−1)(𝑒2𝜆𝜎
√
Δ𝑡−1)
𝜋2 = 1 −𝜋1 −𝜋3.
Solution: Since log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
, the expectation and vari-
ance of 𝑆𝑡+Δ𝑡given 𝑆𝑡are
𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝑆𝑡𝑒(𝑟−𝐷)Δ𝑡
and
Varℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡(
𝑒𝜎2Δ𝑡−1
)
.
Thus,
𝔼ℚ(
𝑆2
𝑡+Δ𝑡
||| 𝑆𝑡
)
= Varℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) + [𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
)]2
= 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡(
𝑒𝜎2Δ𝑡−1
)
+ 𝑆2
𝑡𝑒2(𝑟−𝐷)Δ𝑡
= 𝑆2
𝑡𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡.
As the asset price at time 𝑡+ Δ𝑡could grow to 𝑢𝑆𝑡, 𝑆𝑡or 𝑑𝑆𝑡with risk-neutral probabilities
𝜋1, 𝜋2 and 𝜋3, respectively, therefore
𝔼ℚ(𝑆𝑡+Δ𝑡|| 𝑆𝑡
) = 𝜋1𝑢𝑆𝑡+ 𝜋2𝑆𝑡+ 𝜋3𝑑𝑆𝑡
𝔼ℚ(
𝑆2
𝑡+Δ𝑡
||| 𝑆𝑡
)
= 𝜋1𝑢2𝑆2
𝑡+ 𝜋2𝑆2
𝑡+ 𝜋3𝑑2𝑆2
𝑡.
Hence, by equating the continuous risk-neutral random walk and the discrete binomial
model, and with the sum of probabilities of all mutually exclusive events equal to one, we
have
𝜋1𝑢+ 𝜋2 + 𝜋3𝑑= 𝑒(𝑟−𝐷)Δ𝑡
𝜋1𝑢2 + 𝜋2 + 𝜋3𝑑2 = 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡
𝜋1 + 𝜋2 + 𝜋3 = 1.

2.2.3 Tree-Based Methods
199
By setting 𝑑= 1
𝑢and 𝜋2 = 1 −𝜋1 −𝜋3 we can write the equations as
𝜋1(𝑢−1) + 𝜋3
(1
𝑢−1
)
= 𝑒(𝑟−𝐷)Δ𝑡−1
𝜋1(𝑢2 −1) + 𝜋3
( 1
𝑢2 −1
)
= 𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−1
or
𝜋1𝑢(𝑢−1) −𝜋3(𝑢−1) = 𝑢(𝑒(𝑟−𝐷)Δ𝑡−1)
𝜋1𝑢2(𝑢2 −1) −𝜋3(𝑢2 −1) = 𝑢2 (
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−1
)
.
By solving the equations simultaneously we have
𝜋1 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑢−(𝑒(𝑟−𝐷)Δ𝑡−1)
(𝑢−1)(𝑢2 −1)
𝜋3 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑢2 −(𝑒(𝑟−𝐷)Δ𝑡−1) 𝑢3
(𝑢−1)(𝑢2 −1)
.
Hence, by setting 𝑢= 𝑒𝜆𝜎
√
Δ𝑡we have
𝜋1 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑒𝜆𝜎
√
Δ𝑡−(𝑒(𝑟−𝐷)Δ𝑡−1)
(𝑒𝜆𝜎
√
Δ𝑡−1)(𝑒2𝜆𝜎
√
Δ𝑡−1)
𝜋3 =
(
𝑒(2(𝑟−𝐷)+𝜎2)Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
𝑒2𝜆𝜎
√
Δ𝑡−(𝑒(𝑟−𝐷)Δ𝑡−1) 𝑒3𝜆𝜎
√
Δ𝑡
(𝑒𝜆𝜎
√
Δ𝑡−1)(𝑒2𝜆𝜎
√
Δ𝑡−1)
with 𝜋2 = 1 −𝜋1 −𝜋3.
7. Kamrad–Ritchken Method. We consider a trinomial model where at time 𝑡, the value of the
asset is 𝑆𝑡and at time 𝑡+ Δ𝑡, Δ𝑡> 0 the asset price is increased to 𝑢𝑆𝑡, unchanged 𝑆𝑡or
decreased to 𝑑𝑆𝑡, 0 < 𝑑< 𝑢. In addition, under continuous compounding there is a risk-
free interest rate 𝑟and the asset pays a continuous dividend yield 𝐷. By assuming the asset
price follows the geometric Brownian motion such that under the risk-neutral measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]

200
2.2.3 Tree-Based Methods
where 𝜎is the asset price volatility, show by using the first two moments of log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
given 𝑆𝑡that
𝜋1 log 𝑢+ 𝜋3 log 𝑑=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡
𝜋1(log 𝑢)2 + 𝜋3(log 𝑑)2 = 𝜎2Δ𝑡+
(
𝑟−𝐷−1
2𝜎2)2
(Δ𝑡)2
𝜋1 + 𝜋2 + 𝜋3 = 1
where 𝜋1, 𝜋2 and 𝜋3 are the risk-neutral probabilities of upward, unchanged and downward
movement of the asset price, respectively.
By setting 𝑢= 1
𝑑and 𝑢= 𝑒𝜆𝜎
√
Δ𝑡, 𝜆> 0 show by taking an approximation up to (Δ𝑡)
that
𝜋1 =
1
2𝜆2 +
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡
𝜋2 = 1 −1
𝜆2
𝜋3 =
1
2𝜆2 −
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡.
Finally, to ensure 𝜋1, 𝜋2, 𝜋3 ∈(0, 1) deduce that
𝜆> 1
and
0 <
√
Δ𝑡< 𝜎
𝜆
(
𝑟−𝐷−1
2𝜎2)−1
.
Solution: Under the risk-neutral measure ℚ
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
and we therefore have
𝔼ℚ
[
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)|||||
𝑆𝑡
]
=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡
𝔼ℚ
[{
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)}2|||||
𝑆𝑡
]
= Varℚ
[
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)|||||
𝑆𝑡
]
+ 𝔼ℚ
[
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)|||||
𝑆𝑡
]2
= 𝜎2Δ𝑡+
(
𝑟−𝐷−1
2𝜎2)
(Δ𝑡)2.

2.2.3 Tree-Based Methods
201
By matching the expectations within the trinomial model we have
𝜋1 log
(𝑢𝑆𝑡
𝑆𝑡
)
+ 𝜋2 log
(𝑆𝑡
𝑆𝑡
)
+ 𝜋3 log
(𝑑𝑆𝑡
𝑆𝑡
)
=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡
𝜋
[
log
(𝑢𝑆𝑡
𝑆𝑡
)]2
+ 𝜋2
[
log
(𝑆𝑡
𝑆𝑡
)]2
+ 𝜋3
[
log
(𝑑𝑆𝑡
𝑆𝑡
)]2
= 𝜎2Δ𝑡+
(
𝑟−𝐷−1
2𝜎2)
(Δ𝑡)2
or
𝜋1 log 𝑢+ 𝜋3 log 𝑑=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡
𝜋1 (log 𝑢)2 + 𝜋3 (log 𝑑)2 = 𝜎2Δ𝑡+
(
𝑟−𝐷−1
2𝜎2)
(Δ𝑡)2
𝜋1 + 𝜋2 + 𝜋3 = 1.
By setting 𝑑= 1
𝑢we can write
(𝜋1 −𝜋3) log 𝑢=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡
(𝜋1 + 𝜋3)(log 𝑢)2 = 𝜎2Δ𝑡+
(
𝑟−𝐷−1
2𝜎2)
(Δ𝑡)2
and by substituting 𝑢= 𝑒𝜆𝜎
√
Δ𝑡
𝜋1 −𝜋3 = 1
𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡
𝜋1 + 𝜋3 = 1
𝜆2 +
1
𝜆2𝜎2
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡.
By solving the two equations simultaneously we have
𝜋1 =
1
2𝜆2 +
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡+
1
2𝜆2𝜎2
(
𝑟−𝐷−1
2𝜎2)2
Δ𝑡
𝜋2 = 1 −1
𝜆2
𝜋3 =
1
2𝜆2 −
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡−
1
2𝜆2𝜎2
(
𝑟−𝐷−1
2𝜎2)2
Δ𝑡
since 𝜋2 = 1 −𝜋1 −𝜋3.

202
2.2.3 Tree-Based Methods
Hence, by taking an approximation up to (Δ𝑡)
𝜋1 =
1
2𝜆2 +
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡
𝜋2 = 1 −1
𝜆2
𝜋3 =
1
2𝜆2 −
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡.
To ensure 𝜋1, 𝜋2, 𝜋3 ∈(0, 1) we require
0 < 1 −1
𝜆2 < 1
and
0 <
1
2𝜆2 ±
1
2𝜆𝜎
(
𝑟−𝐷−1
2𝜎2) √
Δ𝑡< 1
or
𝜆> 1
and
0 <
√
Δ𝑡< 𝜎
𝜆
(
𝑟−𝐷−1
2𝜎2)−1
.
8. Continuous-Time Limit of Binomial Model. In a discrete Black–Scholes world we consider
the binomial method to calculate the price of a European option. At time 𝑡where the current
spot price is 𝑆𝑡, we build a binomial tree of possible scenarios of future stock prices
𝑆(𝑗)
𝑖
= 𝑢𝑖𝑑𝑖−𝑗𝑆𝑡,
𝑖= 0, 1, 2, … , 𝑁,
𝑗= 0, 1, 2, … , 𝑖
such that 𝑆(0)
0
= 𝑆𝑡, 𝑁is the total number of time intervals, 𝑢= 𝑒𝜎
√
Δ𝑡, 𝑑= 𝑒−𝜎
√
Δ𝑡, Δ𝑡=
(𝑇−𝑡)∕𝑁is the size of the binomial time step, 𝑇is the option expiry time and 𝜎is the
stock price volatility.
The intermediate option price calculated at the 𝑚-th possible tree value and at the time
step 𝑡+ 𝑛Δ𝑡where 𝑚≤𝑛≤𝑁is given as
𝑉(𝑆(𝑚)
𝑛, 𝑡+ 𝑛Δ𝑡) = 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆(𝑚)
𝑛, 𝑡+ (𝑛+ 1)Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆(𝑚)
𝑛, 𝑡+ (𝑛+ 1)Δ𝑡)]
where 𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
is the risk-neutral probability, 𝑟is the risk-free interest rate and
𝐷is the continuous dividend yield.
By expanding the Taylor series up to (Δ𝑡2), show that in the limit Δ𝑡→0 the interme-
diate option price satisfies the Black–Scholes equation
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) = 0
where 𝑆= 𝑆(𝑚)
𝑛
and 𝑡′ = 𝑡+ 𝑛Δ𝑡.

2.2.3 Tree-Based Methods
203
Solution: By setting 𝑆= 𝑆(𝑚)
𝑛
and 𝑡′ = 𝑡+ 𝑛Δ𝑡then from Taylor’s expansion we have
𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) = 𝑉(𝑆+ (𝑢−1)𝑆, 𝑡′ + Δ𝑡)
= 𝑉(𝑆, 𝑡′) + 𝜕𝑉
𝜕𝑆(𝑢−1)𝑆+ 𝜕𝑉
𝜕𝑡′ Δ𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2 (𝑢−1)2𝑆2
+𝑂((Δ𝑡)2) + 𝑂((𝑢−1)3𝑆3)
and
𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) = 𝑉(𝑆+ (𝑑−1)𝑆, 𝑡′ + Δ𝑡)
= 𝑉(𝑆, 𝑡′) + 𝜕𝑉
𝜕𝑆(𝑑−1)𝑆+ 𝜕𝑉
𝜕𝑡′ Δ𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2 (𝑑−1)2𝑆2
+𝑂((Δ𝑡)2) + 𝑂((𝑑−1)3𝑆3) .
By substituting Taylor’s expansion into the intermediate European option price
𝑉(𝑆, 𝑡′) = 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡)]
we can write
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′)
= 𝜕𝑉
𝜕𝑡′ Δ𝑡+ 1
2
[𝜋(𝑢−1)2 + (1 −𝜋)(𝑑−1)2] 𝑆2 𝜕2𝑉
𝜕𝑆2
+ [𝜋(𝑢−1) + (1 −𝜋)(𝑑−1)] 𝑆𝜕𝑉
𝜕𝑆+ (1 −𝑒𝑟Δ𝑡) 𝑉(𝑆, 𝑡′)
+𝑂((Δ𝑡)2) + 𝑂((𝑢−1)3𝑆3) + 𝑂((𝑑−1)3𝑆3) .
Since
1 −𝑒𝑟Δ𝑡= −𝑟Δ𝑡+ 𝑂((Δ𝑡)2)
𝜋(𝑢−1) + (1 −𝜋)(𝑑−1) = 𝜋(𝑢−𝑑) + 𝑑−1
= 𝑒(𝑟−𝐷)Δ𝑡−1
= (𝑟−𝐷)Δ𝑡+ 𝑂((Δ𝑡)2)
𝜋(𝑢−1)2 + (1 −𝜋)(𝑑−1)2 = 𝜋[(𝑢−1)2 −(𝑑−1)2] + (𝑑−1)2
= 𝜋(𝑢−𝑑)(𝑢+ 𝑑−2) + (𝑑−1)2
= (𝑒(𝑟−𝐷)Δ𝑡−1) (
𝑒𝜎
√
Δ𝑡+ 𝑒−𝜎
√
Δ𝑡−2
)
+
(
𝑒−𝜎
√
Δ𝑡−1
)2
= 𝜎2Δ𝑡+ 𝑂((Δ𝑡)2)

204
2.2.3 Tree-Based Methods
and because
𝑂((𝑢−1)3𝑆3) = 𝑂((Δ𝑡)3) , 𝑂((𝑑−1)3𝑆3) = 𝑂((Δ𝑡)3)
therefore
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′)
= 𝜕𝑉
𝜕𝑡′ Δ𝑡+ 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 Δ𝑡+ (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆Δ𝑡−𝑟𝑉(𝑆, 𝑡′)Δ𝑡+ 𝑂((Δ𝑡)2)
=
[
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) + 𝑂(Δ𝑡)
]
Δ𝑡.
Since
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′) = 0
hence we can set
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) + 𝑂(Δ𝑡) = 0.
By taking limits Δ𝑡→0 we have
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) = 0.
9. In a discrete-time Black–Scholes world, we consider the binomial tree model to calculate
the price of a European call option. At time 𝑡where the current spot price is 𝑆𝑡, we build
a tree of possible scenarios of future stock prices
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆𝑡, 𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, 2, … , 𝑖
such that 𝑆(0)
0
= 𝑆𝑡, 𝑛is the total number of time periods, 𝑢= 𝑒𝜎
√
Δ𝑡, 𝑑= 𝑒−𝜎
√
Δ𝑡, Δ𝑡=
(𝑇−𝑡)∕𝑛is the time step, 𝑇is the option expiry date and 𝜎is the stock price volatility.
Here 𝑆(𝑗)
𝑖
denotes the 𝑗-th possible value of the stock price at time period 𝑖(or time step
𝑡+ 𝑖Δ𝑡).
Show that the European call option price with strike 𝐾at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑛𝑟Δ𝑡
𝑛
∑
𝑗=0
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗max{𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾, 0}
where 𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
is the risk-neutral probability, 𝑟is the risk-free interest rate and
𝐷is the continuous dividend yield.

2.2.3 Tree-Based Methods
205
Solution: We prove this result via mathematical induction.
Let 𝑛= 1 where at time 𝑇= 𝑡+ Δ𝑡, 𝑆𝑇can either be 𝑢𝑆𝑡or 𝑑𝑆𝑡with risk-neutral prob-
abilities 𝜋and 1 −𝜋, respectively. Following Problem 2.2.3.1 (page 190), the price of a
European call option at time 𝑡under the risk-neutral measure ℚis
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟Δ𝑡𝔼ℚ(max{𝑆𝑇−𝐾, 0}|| 𝑆𝑡
)
= 𝑒−𝑟(𝑇−𝑡) [𝜋max{𝑢𝑆𝑡−𝐾, 0} + (1 −𝜋) max{𝑑𝑆𝑡−𝐾, 0}] .
Hence, the result is true for 𝑛= 1.
We assume the result is true for 𝑛= 𝑘such that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟𝑘Δ𝑡
𝑘
∑
𝑗=0
(
𝑘
𝑗
)
𝜋𝑗(1 −𝜋)𝑘−𝑗max{𝑢𝑗𝑑𝑘−𝑗𝑆𝑡−𝐾, 0}
= 𝑒−𝑟𝑘Δ𝑡[(1 −𝜋)𝑘max{𝑑𝑘𝑆𝑡−𝐾, 0}
+ 𝑘𝜋(1 −𝜋)𝑘−1 max{𝑢𝑑𝑘−1𝑆𝑡−𝐾, 0}
+ 𝑘(𝑘−1)
2
𝜋2(1 −𝜋)𝑘−2 max{𝑢2𝑑𝑘−2𝑆𝑡−𝐾, 0}
+ ⋯+ 𝜋𝑘max{𝑢𝑘𝑆𝑡−𝐾, 0}]
= 𝑒−𝑟𝑘Δ𝑡[(1 −𝜋)𝑘𝑉(𝑑𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)
+ 𝑘𝜋(1 −𝜋)𝑘−1𝑉(𝑢𝑑𝑘−1𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)
+ 𝑘(𝑘−1)
2
𝜋2(1 −𝜋)𝑘−2𝑉(𝑢2𝑑𝑘−2𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)
+ ⋯+ 𝜋𝑘𝑉(𝑢𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)]
where 𝑉(𝑢𝑗𝑑𝑘−𝑗𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇) = max{𝑢𝑗𝑑𝑘−𝑗−𝐾, 0} is the option’s intrinsic value at
time step 𝑡+ 𝑘Δ𝑡, 𝑗= 0, 1, 2, … , 𝑘.
For 𝑛= 𝑘+ 1 we then have 𝑘+ 1 possible stock prices at time step 𝑡+ (𝑘+ 1)Δ𝑡where
𝑆(0)
𝑘+1 = 𝑑𝑘+1𝑆𝑡, 𝑆(1)
𝑘+1 = 𝑢𝑑𝑘𝑆𝑡, 𝑆(2)
(𝑘+1) = 𝑢2𝑑𝑘−1𝑆𝑡, …, 𝑆(𝑘+1)
𝑘+1
= 𝑢𝑘+1𝑆𝑡. Therefore,
𝑉(𝑑𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇) = 𝑒−𝑟Δ𝑡[𝜋max{𝑢𝑑𝑘𝑆𝑡−𝐾, 0}
+(1 −𝜋) max{𝑑𝑘+1𝑆𝑡−𝐾, 0}]
𝑉(𝑢𝑑𝑘−1𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇) = 𝑒−𝑟Δ𝑡[𝜋max{𝑢2𝑑𝑘−1𝑆𝑡−𝐾, 0}
+(1 −𝜋) max{𝑢𝑑𝑘𝑆𝑡−𝐾, 0}]
𝑉(𝑢2𝑑𝑘−2𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇) = 𝑒−𝑟Δ𝑡[𝜋max{𝑢3𝑑𝑘−2𝑆𝑡−𝐾, 0}
+(1 −𝜋) max{𝑢2𝑑𝑘−1𝑆𝑡−𝐾, 0}]
⋮
⋮
𝑉(𝑢𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇) = 𝑒−𝑟Δ𝑡[𝜋max{𝑢𝑘+1𝑆𝑡−𝐾, 0}
+(1 −𝜋) max{𝑢𝑘𝑑𝑆𝑡−𝐾, 0}]

206
2.2.3 Tree-Based Methods
and by substituting the values into
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟𝑘Δ𝑡[(1 −𝜋)𝑘𝑉(𝑑𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝑘, 𝑇)
+𝑘𝜋(1 −𝜋)𝑘−1𝑉(𝑢𝑑𝑘−1𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)
+𝑘(𝑘−1)
2
𝜋2(1 −𝜋)𝑘−2𝑉(𝑢2𝑑𝑘−2𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)
+ ⋯+ 𝜋𝑘𝑉(𝑢𝑘𝑆𝑡, 𝑡+ 𝑘Δ𝑡; 𝐾, 𝑇)]
we have
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑘+1)Δ𝑡[(1 −𝜋)𝑘+1(1 −𝜋) max{𝑑𝑘+1𝑆𝑡−𝐾, 0}
+(𝑘+ 1)𝜋(1 −𝜋)𝑘max{𝑢𝑑𝑘𝑆𝑡−𝐾, 0}
+(𝑘+ 1)𝑘
2
𝜋2(1 −𝜋)𝑘−1 max{𝑢2𝑑𝑘−1𝑆𝑡−𝐾, 0}
+ ⋯+ 𝜋𝑘+1 max{𝑢𝑘+1𝑆𝑡−𝐾, 0}]
= 𝑒−𝑟(𝑘+1)Δ𝑡
𝑘+1
∑
𝑗=0
(
𝑘+ 1
𝑗
)
𝜋𝑗(1 −𝜋)𝑘+1−𝑗max{𝑢𝑗𝑑𝑘+1−𝑗𝑆𝑡−𝐾, 0}.
Hence, the result is also true for 𝑛= 𝑘+ 1. Thus, from mathematical induction we can
deduce that the European call option price with strike 𝐾at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟𝑛Δ𝑡
𝑛
∑
𝑗=0
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗max{𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾, 0}
where 𝑛Δ𝑡= 𝑇−𝑡.
10. In a discrete-time Black–Scholes world, we consider the binomial tree model to calculate
the price of a European call option. At time 𝑡where the current spot price is 𝑆𝑡, we build
a tree of possible scenarios of future stock prices
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆𝑡,
𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, 2, … , 𝑖
such that 𝑆(0)
0
= 𝑆𝑡, 𝑛is the total number of time periods, 𝑢= 𝑒𝜎
√
Δ𝑡, 𝑑= 𝑒−𝜎
√
Δ𝑡, Δ𝑡=
(𝑇−𝑡)∕𝑛is the time step, 𝑇is the option expiry date and 𝜎is the stock price volatility.
Here 𝑆(𝑗)
𝑖
denotes the 𝑗-th possible value of the stock price at time period 𝑖(or time step
𝑡+ 𝑖Δ𝑡).
Let the European call option price with strike 𝐾at time 𝑡be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑛𝑟Δ𝑡
𝑛
∑
𝑗=0
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗max{𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾, 0}

2.2.3 Tree-Based Methods
207
where 𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
is the risk-neutral probability, 𝑟is the risk-free interest rate and
𝐷is the continuous dividend yield. By setting
𝑚=
log
(
𝐾
𝑆𝑡𝑑𝑛
)
log
( 𝑢
𝑑
)
show that 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) can be written as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
̃𝜋𝑗(1 −̃𝜋)𝑛−𝑗
−𝐾𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗
where ̃𝜋= 𝜋𝑢𝑒−(𝑟−𝐷)Δ𝑡.
Finally, from the asymptotic property of a binomial distribution 𝑍∼Binomial(𝑛, 𝑝),
0 ≤𝑝≤1
lim
𝑛→∞𝑍∻(𝑛𝑝, 𝑛𝑝(1 −𝑝))
show that
lim
𝑛→∞𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) is the standard normal cdf
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: By writing 𝑚=
log
(
𝐾
𝑆𝑡𝑑𝑛
)
log
( 𝑢
𝑑
)
so that
max{𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾, 0} =
{
0
𝑗< 𝑚
𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾
𝑗≥𝑚

208
2.2.3 Tree-Based Methods
and setting 𝑛Δ𝑡= 𝑇−𝑡we can write
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗=0
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗max{𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾, 0}
= 𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗(𝑢𝑗𝑑𝑛−𝑗𝑆𝑡−𝐾)
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
(𝜋𝑢)𝑗((1 −𝜋)𝑑)𝑛−𝑗
−𝐾𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
) (𝜋𝑢𝑒−(𝑟−𝐷)Δ𝑡)𝑗((1 −𝜋)𝑑𝑒−(𝑟−𝐷)Δ𝑡)𝑛−𝑗
−𝐾𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗.
By setting ̃𝜋= 𝜋𝑢𝑒−(𝑟−𝐷)Δ𝑡therefore
1 −̃𝜋= 1 −𝜋𝑢𝑒−(𝑟−𝐷)Δ𝑡
= 𝑒−(𝑟−𝐷)Δ𝑡(𝑒(𝑟−𝐷)Δ𝑡−𝜋𝑢)
= 𝑒−(𝑟−𝐷)Δ𝑡(𝜋(𝑢−𝑑) + 𝑑−𝜋𝑢)
= (1 −𝜋)𝑑𝑒−(𝑟−𝐷)Δ𝑡.
Hence,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
̃𝜋𝑗(1 −̃𝜋)𝑛−𝑗
−𝐾𝑒−𝑟(𝑇−𝑡)
𝑛
∑
𝑗≥𝑚
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)ℙ(𝑋≥𝑚) −𝐾𝑒−𝑟(𝑇−𝑡)ℙ(𝑌≥𝑚)
where 𝑋∼Binomial(𝑛, ̃𝜋) and 𝑌∼Binomial(𝑛, 𝜋).
Since
lim
𝑛→∞𝑋∻(𝑛̃𝜋, ̃𝜋(1 −̃𝜋))
and
lim
𝑛→∞𝑌∻(𝑛𝜋, 𝑛𝜋(1 −𝜋))

2.2.3 Tree-Based Methods
209
therefore
lim
𝑛→∞𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(
𝑛̃𝜋−𝑚
√
𝑛̃𝜋(1 −̃𝜋)
)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
𝑛𝜋−𝑚
√
𝑛𝜋(1 −𝜋)
)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(
log(𝑆𝑡∕𝐾) + 𝑛̃𝜋log (𝑢∕𝑑) + 𝑛log 𝑑
log (𝑢∕𝑑)
√
𝑛̃𝜋(1 −̃𝜋)
)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log(𝑆𝑡∕𝐾) + 𝑛𝜋log (𝑢∕𝑑) + 𝑛log 𝑑
log (𝑢∕𝑑)
√
𝑛𝜋(1 −𝜋)
)
.
From Taylor’s expansion
𝑒(𝑟−𝐷)Δ𝑡= 1 + (𝑟−𝐷)Δ𝑡+ ((Δ𝑡)2)
𝑒−(𝑟−𝐷)Δ𝑡= 1 −(𝑟−𝐷)Δ𝑡+ ((Δ𝑡)2)
𝑒𝜎
√
Δ𝑡= 1 + 𝜎
√
Δ𝑡+ 1
2𝜎2Δ𝑡+ 
(
(Δ𝑡)
3
2
)
𝑒−𝜎
√
Δ𝑡= 1 −𝜎
√
Δ𝑡+ 1
2𝜎2Δ𝑡+ 
(
(Δ𝑡)
3
2
)
and taking limits
lim
𝑛→∞𝑛
[
𝜋log
( 𝑢
𝑑
)
+ log 𝑑
]
= lim
𝑛→∞
[
𝑛
(
𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
)
log
( 𝑢
𝑑
)
+ 𝑛log 𝑑
]
= lim
𝑛→∞𝑛
(
𝑒(𝑟−𝐷)Δ𝑡−𝑒−𝜎
√
Δ𝑡)
lim
𝑛→∞
2𝜎
√
Δ𝑡
𝑒𝜎
√
Δ𝑡−𝑒−𝜎
√
Δ𝑡
−lim
𝑛→∞𝑛𝜎
√
Δ𝑡
= lim
𝑛→∞
[
𝑛
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡+ 𝑛𝜎
√
Δ𝑡+ 𝑛
(
(Δ𝑡)
3
2
)]
× lim
𝑛→∞
2𝜎
√
Δ𝑡
2𝜎
√
Δ𝑡+ (Δ𝑡)
−lim
𝑛→∞𝑛𝜎
√
Δ𝑡
=
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)

210
2.2.3 Tree-Based Methods
lim
𝑛→∞𝑛
[
̃𝜋log
( 𝑢
𝑑
)
+ log 𝑑
]
= lim
𝑛→∞
[
𝑛𝜋𝑢𝑒−(𝑟−𝐷)Δ𝑡log
( 𝑢
𝑑
)
+ 𝑛log 𝑑
]
= lim
𝑛→∞
[
𝑛
(
𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
)
𝑢𝑒−(𝑟−𝐷)Δ𝑡log
( 𝑢
𝑑
)
+ 𝑛log 𝑑
]
= lim
𝑛→∞
[
𝑛
(
𝑢−𝑒−(𝑟−𝐷)Δ𝑡
𝑢−𝑑
)
log
( 𝑢
𝑑
)
+ 𝑛log 𝑑
]
= lim
𝑛→∞𝑛
(
𝑒𝜎
√
Δ𝑡−𝑒−(𝑟−𝐷)Δ𝑡)
lim
𝑛→∞
2𝜎
√
Δ𝑡
𝑒𝜎
√
Δ𝑡−𝑒−𝜎
√
Δ𝑡
−lim
𝑛→∞𝑛𝜎
√
Δ𝑡
= lim
𝑛→∞
[
𝑛
(
𝑟−𝐷+ 1
2𝜎2)
Δ𝑡+ 𝑛𝜎
√
Δ𝑡+ 𝑛
(
(Δ𝑡)
3
2
)]
× lim
𝑛→∞
2𝜎
√
Δ𝑡
2𝜎
√
Δ𝑡+ (Δ𝑡)
−lim
𝑛→∞𝑛𝜎
√
Δ𝑡
=
(
𝑟−𝐷+ 1
2𝜎2)
(𝑇−𝑡)
lim
𝑛→∞𝑛𝜋(1 −𝜋)
[
log
( 𝑢
𝑑
)]2
= lim
𝑛→∞𝑛
(
𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
) (
𝑢−𝑒(𝑟−𝐷)Δ𝑡
𝑢−𝑑
) [
log
( 𝑢
𝑑
)]2
= lim
𝑛→∞𝑛(𝑒(𝑟−𝐷)Δ𝑡−𝑑) (𝑢−𝑒(𝑟−𝐷)Δ𝑡) [log (𝑢∕𝑑)
(𝑢−𝑑)
]2
= lim
𝑛→∞𝑛
(
𝑒(𝑟−𝐷)Δ𝑡−𝑒−𝜎
√
Δ𝑡) (
𝑒𝜎
√
Δ𝑡−𝑒(𝑟−𝐷)Δ𝑡)
×
[log (𝑢∕𝑑)
(𝑢−𝑑)
]2
= lim
𝑛→∞𝑛
(
𝜎2Δ𝑡+ (Δ𝑡
3
2 )
)
lim
𝑛→∞
[
2𝜎
√
Δ𝑡
2𝜎
√
Δ𝑡+ (Δ𝑡)
]2
= 𝜎2(𝑇−𝑡)
and
lim
𝑛→∞𝑛̃𝜋(1 −̃𝜋)
[
log
( 𝑢
𝑑
)]2
= lim
𝑛→∞𝑛𝜋(1 −𝜋)𝑒−2(𝑟−𝐷)Δ𝑡[
log
( 𝑢
𝑑
)]2
= lim
𝑛→∞𝑛𝜋(1 −𝜋)
[
log
( 𝑢
𝑑
)]2
lim
𝑛→∞𝑒−2(𝑟−𝐷)Δ𝑡
= 𝜎2(𝑇−𝑡)

2.2.3 Tree-Based Methods
211
such that using L’Ĥopital’s rule
lim
𝑛→∞
2𝜎
√
Δ𝑡
2𝜎
√
Δ𝑡+ (Δ𝑡)
= lim
𝑛→∞
2𝜎
2𝜎+ (
√
Δ𝑡)
= 1.
Hence, we can write
lim
𝑛→∞𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
11. Consider a binomial tree model for an underlying asset process {𝑆𝑛: 0 ≤𝑛≤3} where
𝑆0 = 100. Let
𝑆𝑛+1 =
⎧
⎪
⎨
⎪⎩
𝑢𝑆𝑛
with probability 𝜋
𝑑𝑆𝑛
with probability 1 −𝜋
where 𝑢= 𝑒𝜎
√
Δ𝑡and 𝑑= 1∕𝑢, with 𝜎the volatility and Δ𝑡the binomial time step. By
assuming the risk-neutral interest rate 𝑟= 5%, continuous dividend yield 𝐷= 1% and
volatility 𝜎= 10% we wish to price a European call option with strike 𝐾= 95 and expiry
time 𝑇= 1 year in a 3-period binomial tree model.
(a) Find the risk-neutral probabilities 𝜋and 1 −𝜋.
(b) Find the price of the European call option.
Solution:
(a) Given 𝑆0 = 100, 𝐾= 95, 𝑟= 0.05, 𝐷= 0.01, 𝜎= 0.1 and time step Δ𝑡= 1
3, then
𝑢= 𝑒𝜎
√
Δ𝑡= 𝑒
0.1
√
3 = 1.0594
and
𝑑= 𝑒−𝜎
√
Δ𝑡= 𝑒
−0.1
√
3 = 0.9439.
The risk-neutral probabilities are
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
= 0.6019

212
2.2.3 Tree-Based Methods
0∙
2
0
∙
2
0
∙
0
∙
0
∙
0
∙
3
0
∙
2
0
∙
2
0
∙
3
0
∙
Figure 2.3
A 3-period binomial tree model.
and
1 −𝜋= 1 −0.6019 = 0.3981.
(b) The binomial tree in Figure 2.3 shows the price movement of 𝑆0 in a 3-period binomial
model.
By setting
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆0,
𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, … , 𝑖
the European call option price at each of the lattice points is
𝑉(𝑗)
𝑖
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]
such that
𝑉(𝑗)
𝑛
= Ψ(𝑆(𝑗)
𝑛) = max {𝑆(𝑗)
𝑛
−𝐾, 0}
where 𝑖= 0, 1, … , 𝑛and 𝑗= 0, 1, … , 𝑖.
Hence, at time period 𝑛= 3
𝑉(0)
3
= Ψ(𝑆(0)
3 )
= max{𝑑3𝑆0 −𝐾, 0}
= max{0.94393 × 100 −95, 0}
= 0

2.2.3 Tree-Based Methods
213
𝑉(1)
3
= Ψ(𝑆(1)
3 )
= max{𝑢𝑑2𝑆0 −𝐾, 0}
= max{1.0594 × 0.94392 × 100 −95, 0}
= 0
𝑉(2)
3
= Ψ(𝑆(2)
3 )
= max{𝑢2𝑑𝑆0 −𝐾, 0}
= max{1.05942 × 0.9439 × 100 −95, 0}
= 10.9366
𝑉(3)
3
= Ψ(𝑆(3)
3 )
= max{𝑢3𝑆0 −𝐾, 0}
= max{1.05943 × 100 −95, 0}
= 23.8995.
At time period 𝑛= 2
𝑉(0)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
= 𝑒−0.05
3 [0.6019 × 0 + 0.3981 × 0]
= 0
𝑉(1)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
3
+ (1 −𝜋)𝑉(1)
3
]
= 𝑒−0.05
3 [0.6019 × 10.9366 + 0.3981 × 0]
= 6.4739
𝑉(2)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]
= 𝑒−0.05
3 [0.6019 × 23.8995 + 0.3981 × 10.9366]
= 18.4292.
At time period 𝑛= 1
𝑉(0)
1
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]
= 𝑒−0.05
3 [0.6019 × 6.4739 + 0.3981 × 0]
= 3.8322
𝑉(1)
1
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]
= 𝑒−0.05
3 [0.6019 × 18.4292 + 0.3981 × 6.4739]
= 13.4438

214
2.2.3 Tree-Based Methods
and finally at time period 𝑛= 0
𝑉(0)
0
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]
= 𝑒−0.05
3 [0.6019 × 13.4438 + 0.3981 × 3.8322]
= 9.4585.
Therefore, the price of the European call based on a 3-period binomial model is 𝑉(0)
0
=
9.4585.
N.B. Take note that we can also obtain the same result by utilising the formula given
in Problem 2.2.3.9 (page 204)
𝑉(0)
0
= 𝑒−𝑛𝑟Δ𝑡
𝑛
∑
𝑗=0
(
𝑛
𝑗
)
𝜋𝑗(1 −𝜋)𝑛−𝑗max{𝑢𝑗𝑑𝑛−𝑗𝑆0 −𝐾, 0}
= 𝑒−3×0.05× 1
3
3
∑
𝑗=0
(
3
𝑗
)
0.6019𝑗× 0.3981𝑛−𝑗× 𝑉(𝑗)
3
= 𝑒−0.05 [0.39813 × 0 + 3 × 0.6019 × 0.39812 × 0
+3 × 0.60192 × 0.3981 × 10.9366 + 0.60193 × 23.8995]
= 9.4585.
12. Consider a binomial tree model for an underlying asset process {𝑆𝑛: 0 ≤𝑛≤3} where
𝑆0 = 100. Let
𝑆𝑛+1 =
⎧
⎪
⎨
⎪⎩
𝑢𝑆𝑛
with probability 𝜋
𝑑𝑆𝑛
with probability 1 −𝜋
where 𝑢= 𝑒𝜎
√
Δ𝑡and 𝑑= 1∕𝑢, with 𝜎is the volatility and Δ𝑡the binomial time step. By
assuming the risk-neutral interest rate 𝑟= 5% and the volatility 𝜎= 10% we wish to price a
European call option with strike 𝐾= 95 and expiry time 𝑇= 1 year in a 3-period binomial
tree model where the stock price pays a discrete dividend 𝛿= 1.00 at time period 2.
(a) Find the risk-neutral probabilities 𝜋and 1 −𝜋.
(b) Find the price of the European call option.
Solution:
(a) Given 𝑆0 = 100, 𝐾= 95, 𝑟= 0.05, 𝛿= 1.00, 𝜎= 0.1 and time step Δ𝑡= 1
3, then
𝑢= 𝑒𝜎
√
Δ𝑡= 𝑒
0.1
√
3 = 1.0594

2.2.3 Tree-Based Methods
215
and
𝑑= 𝑒−𝜎
√
Δ𝑡= 𝑒
−0.1
√
3 = 0.9439.
The risk-neutral probabilities are
𝜋= 𝑒𝑟Δ𝑡−𝑑
𝑢−𝑑
= 0.6312
and
1 −𝜋= 1 −0.6312 = 0.3688.
(b) The 3-period binomial tree in Figure 2.4 shows the price movement of 𝑆0 with discrete
dividend payment at 𝑛= 2.
By setting
𝑆(𝑗)
𝑖
=
⎧
⎪
⎨
⎪⎩
𝑢𝑗𝑑𝑖−𝑗𝑆0
𝑖= 0, 1 𝑗= 0, … , 𝑖
𝑢𝑗𝑑2−𝑗𝑆0 −𝛿
𝑖= 2, 𝑗= 0, … , 𝑖
and
𝑆(0)
3
= 𝑑(𝑑2𝑆0 −𝛿), 𝑆(1)
3
= 𝑢(𝑑2𝑆0 −𝛿), 𝑆(2)
3
= 𝑑(𝑢𝑑𝑆0 −𝛿)
𝑆(3)
3
= 𝑢(𝑢𝑑𝑆0 −𝛿), 𝑆(4)
3
= 𝑑(𝑢2𝑆0 −𝛿), 𝑆(5)
3
= 𝑢(𝑢2𝑆0 −𝛿)
0∙
2
0 −
∙
2
0 −
∙
0 −
∙
0
∙
0
∙
( 2
0 −
)
∙
( 2
0 −
)
∙
(
0 −
)
∙
(
0 −
)
∙
(
2
0 −
)
∙
(
2
0 −
)
∙
Figure 2.4
A 3-period binomial tree model with discrete dividend payment at time period 𝑛= 2.

216
2.2.3 Tree-Based Methods
the European call option price at each of the lattice points is
𝑉(𝑗)
𝑖
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]
where 𝑖= 0, 1 and 𝑗= 0, … , 𝑖
𝑉(0)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
𝑉(1)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]
𝑉(2)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(5)
3
+ (1 −𝜋)𝑉(4)
3
]
such that
𝑉(𝑗)
3
= Ψ(𝑆(𝑗)
3 ) = max
{
𝑆(𝑗)
3
−𝐾, 0
}
for 𝑗= 0, 1, … , 5.
For time period 𝑛= 3, the payoffs are
𝑉(0)
3
= max{𝑑(𝑑2𝑆0 −𝛿) −𝐾, 0}
= max{0.9439(0.94392 × 100 −1) −95, 0}
= 0
𝑉(1)
3
= max{𝑢(𝑑2𝑆0 −𝛿) −𝐾, 0}
= max{1.0594(0.94392 × 100 −1) −95, 0}
= 0
𝑉(2)
3
= max{𝑑(𝑢𝑑𝑆0 −𝛿) −𝐾, 0}
= max{0.9439(0.9439 × 1.0594 × 100 −1) −95, 0}
= 0
𝑉(3)
3
= max{𝑢(𝑢𝑑𝑆0 −𝛿) −𝐾, 0}
= max{1.0594(1.0594 × 0.9439 × 100 −1) −95, 0}
= 9.8772
𝑉(4)
3
= max{𝑑(𝑢2𝑆0 −𝛿) −𝐾, 0}
= max{0.9439(1.05942 × 100 −1) −95, 0}
= 9.9927
𝑉(5)
3
= max{𝑢(𝑢2𝑆0 −𝛿) −𝐾, 0}
= max{1.0594(1.05942 × 100 −1) −95, 0}
= 22.8401.

2.2.3 Tree-Based Methods
217
At time period 𝑛= 2
𝑉(0)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
= 𝑒−0.05
3 [0.6312 × 0 + 0.3688 × 0]
= 0
𝑉(1)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]
= 𝑒−0.05
3 [0.6312 × 9.8772 + 0.3688 × 0]
= 6.1314
𝑉(2)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(5)
3
+ (1 −𝜋)𝑉(4)
3
]
= 𝑒−0.05
3 [0.6312 × 22.8401 + 0.3688 × 9.9927]
= 17.8028.
At time period 𝑛= 1
𝑉(0)
1
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]
= 𝑒−0.05
3 [0.6312 × 6.1314 + 0.3688 × 0]
= 3.8062
𝑉(1)
1
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]
= 𝑒−0.05
3 [0.6312 × 17.8028 + 0.3688 × 6.1314]
= 13.2753
and finally at time period 𝑛= 0
𝑉(0)
0
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]
= 𝑒−0.05
3 [0.6312 × 13.2753 + 0.3688 × 3.8062]
= 9.6214.
Therefore, the price of the European call with discrete dividend based on a 3-period
binomial model is 𝑉(0)
0
= 9.6214.

218
2.2.4 The Greeks
2.2.4
The Greeks
1. Let
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
where 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the expiry date of the option, 𝐾is the strike
price, 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield and 𝜎is the spot
price volatility.
Show that
𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
Hence, deduce that
𝜕𝑑+
𝜕𝑆𝑡
= 𝜕𝑑−
𝜕𝑆𝑡
𝜕𝑑+
𝜕𝐾= 𝜕𝑑−
𝜕𝐾
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝐾
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝐾
where Φ(⋅) is the cdf of a standard normal.
Solution: From the definition
𝑑+ =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝑑−=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡

2.2.4 The Greeks
219
we can write
𝑑+ −𝜎
√
𝑇−𝑡=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
−𝜎
√
𝑇−𝑡
=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡) −𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Hence,
𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡.
As for the second result we note that
1
2
(𝑑2
+ −𝑑2
−
) = 1
2
(
𝑑2
+ −𝑑2
+ + 2𝑑+𝜎
√
𝑇−𝑡−𝜎2(𝑇−𝑡)
)
= log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡)
from which follows that
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
From 𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡and by differentiating with respect to 𝑆𝑡and 𝐾we have
𝜕𝑑+
𝜕𝑆𝑡
= 𝜕𝑑−
𝜕𝑆𝑡
and
𝜕𝑑+
𝜕𝐾= 𝜕𝑑−
𝜕𝐾.
Since
𝜕Φ(𝑑+)
𝜕𝑆𝑡
=
𝜕
𝜕𝑆𝑡∫
𝑑+
−∞
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥=
1
√
2𝜋
𝑒−1
2 𝑑2
+ 𝜕𝑑+
𝜕𝑆𝑡
𝜕Φ(𝑑−)
𝜕𝑆𝑡
=
𝜕
𝜕𝑆𝑡∫
𝑑−
−∞
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥=
1
√
2𝜋
𝑒−1
2 𝑑2
−𝜕𝑑−
𝜕𝑆𝑡
𝜕Φ(𝑑+)
𝜕𝐾
=
𝜕
𝜕𝐾∫
𝑑+
−∞
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥=
1
√
2𝜋
𝑒−1
2 𝑑2
+ 𝜕𝑑+
𝜕𝐾

220
2.2.4 The Greeks
𝜕Φ(𝑑−)
𝜕𝐾
=
𝜕
𝜕𝐾∫
𝑑−
−∞
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥=
1
√
2𝜋
𝑒−1
2 𝑑2
−𝜕𝑑−
𝜕𝐾
and by substituting the terms 𝑒−1
2 𝑑2
+ and 𝑒−1
2 𝑑2
−into 𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
and taking note that 𝜕𝑑+
𝜕𝑆𝑡
= 𝜕𝑑−
𝜕𝑆𝑡
, 𝜕𝑑+
𝜕𝐾= 𝜕𝑑−
𝜕𝐾, we have the relations
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝐾
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝐾
.
2. Delta. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Without explicitly computing the partial derivatives of 𝑑± show that the delta of a
European call, Δ𝐶= 𝜕𝐶
𝜕𝑆𝑡
and a European put, Δ𝑃= 𝜕𝑃
𝜕𝑆𝑡
are
Δ𝐶= 𝑒−𝐷(𝑇−𝑡)Φ(𝑑+)
and
Δ𝑃= 𝑒−𝐷(𝑇−𝑡)(Φ(𝑑+) −1)
respectively.
Solution: Using the properties of Problem 2.2.4.1 (page 218) we note that
Δ𝐶= 𝜕𝐶
𝜕𝑆𝑡
= 𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
= 𝑒−𝐷(𝑇−𝑡)Φ(𝑑+).

2.2.4 The Greeks
221
Taking note that
Φ(−𝑑±) = 1 −Φ(𝑑±)
hence
Δ𝑃= 𝜕𝑃
𝜕𝑆𝑡
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕
𝜕𝑆𝑡
(1 −Φ(𝑑−)) −𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕
𝜕𝑆𝑡
(1 −Φ(𝑑+))
= −𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
−𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
= −𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
= 𝑒−𝐷(𝑡−𝑡)(Φ(𝑑+) −1).
3. Gamma. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Show that the gamma of a European call, Γ𝐶= 𝜕2𝐶
𝜕𝑆2
𝑡
and a European put, Γ𝑃= 𝜕2𝑃
𝜕𝑆2
𝑡
are equal such that
Γ = 𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
𝜎𝑆𝑡
√
2𝜋(𝑇−𝑡)
= 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
𝜎𝑆2
𝑡
√
2𝜋(𝑇−𝑡)
where Γ = Γ𝐶= Γ𝑃.
Solution: Using the results of Problem 2.2.4.2 (page 220) for a European call, the gamma
is defined as
Γ𝐶= 𝜕2𝐶
𝜕𝑆2
𝑡
= 𝜕Δ𝐶
𝜕𝑆𝑡
=
𝜕
𝜕𝑆𝑡
(𝑒−𝐷(𝑇−𝑡)Φ(𝑑+)) = 𝑒−𝐷(𝑇−𝑡)Φ′(𝑑+)𝜕𝑑+
𝜕𝑆𝑡
.

222
2.2.4 The Greeks
Using similar steps, the gamma of a European put is
Γ𝑃= 𝜕2𝑃
𝜕𝑆2
𝑡
= 𝜕Δ𝑃
𝜕𝑆𝑡
=
𝜕
𝜕𝑆𝑡
(𝑒−𝐷(𝑡−𝑡)(Φ(𝑑+) −1)) = 𝑒−𝐷(𝑇−𝑡)Φ′(𝑑+)𝜕𝑑+
𝜕𝑆𝑡
.
Hence,
Γ𝐶= Γ𝑃= 𝑒−𝐷(𝑇−𝑡)Φ′(𝑑+)𝜕𝑑+
𝜕𝑆𝑡
and by manipulating 𝜕𝑑+
𝜕𝑆𝑡
,
𝜕𝑑+
𝜕𝑆𝑡
=
𝜕
𝜕𝑆𝑡
{log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
}
=
1
𝜎𝑆𝑡
√
𝑇−𝑡
.
Therefore,
Γ𝐶= Γ𝑃= 𝑒−𝐷(𝑇−𝑡)Φ′(𝑑+)
𝜎𝑆𝑡
√
𝑇−𝑡
= 𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
𝜎𝑆𝑡
√
2𝜋(𝑇−𝑡)
where Φ′(𝑥) =
1
√
2𝜋
𝑒−1
2 𝑥2.
In addition, from Problem 2.2.4.1 (page 218) we have the identity
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
and thus we can also write the gamma as
Γ𝐶= Γ𝑃= 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
𝜎𝑆2
𝑡
√
2𝜋(𝑇−𝑡)
.
4. Dual Delta. Let the Black–Scholes formulae of a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
a European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡

2.2.4 The Greeks
223
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Show that the dual delta of a European call, 𝜕𝐶
𝜕𝐾and a European put, 𝜕𝑃
𝜕𝐾are
𝜕𝐶
𝜕𝐾= −𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
𝜕𝑃
𝜕𝐾= 𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−)
respectively.
Solution: Taking partial derivatives with respect to the strike price 𝐾
𝜕𝐶
𝜕𝐾= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕
𝜕𝐾Φ(𝑑+) −𝑒−𝑟(𝑇−𝑡)Φ(𝑑−) −𝐾𝑒−𝑟(𝑇−𝑡) 𝜕
𝜕𝐾Φ(𝑑−)
and
𝜕𝑃
𝜕𝐾= 𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) + 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕
𝜕𝐾Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕
𝜕𝐾Φ(−𝑑+).
For 𝜖∈{−1, 1},
𝜕
𝜕𝐾Φ(𝜖𝑑+) =
−𝜖
𝜎𝐾
√
2𝜋(𝑇−𝑡)
𝑒−1
2 𝑑2
+
and
𝜕
𝜕𝐾Φ(𝜖𝑑−) =
−𝜖
𝜎𝐾
√
2𝜋(𝑇−𝑡)
𝑒−1
2 𝑑2
−
and using the properties of Problem 2.2.4.1 (page 218)
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
we eventually have
𝜕𝐶
𝜕𝐾= −𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
𝜕𝑃
𝜕𝐾= 𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−).
5. Dual Gamma. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and a European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡

224
2.2.4 The Greeks
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Show that the dual gamma of a European call, 𝜕2𝐶
𝜕𝐾2 and a European put, 𝜕2𝑃
𝜕𝐾2 are equal
such that
𝜕2𝐶
𝜕𝐾2 = 𝜕2𝑃
𝜕𝐾2 =
𝑒−𝑟(𝑇−𝑡)
𝜎𝐾
√
2𝜋(𝑇−𝑡)
𝑒−1
2 𝑑2
−.
Solution: From Problem 2.2.4.4 (page 222), taking partial derivatives with respect to 𝐾
𝜕2𝐶
𝜕𝐾2 = −𝑒−𝑟(𝑇−𝑡) 𝜕
𝜕𝐾Φ(𝑑−) and 𝜕2𝑃
𝜕𝐾2 = 𝑒−𝑟(𝑇−𝑡) 𝜕
𝜕𝐾Φ(−𝑑−)
and since 𝜕
𝜕𝐾Φ(𝜖𝑑−) =
−𝜖
𝜎𝐾
√
2𝜋(𝑇−𝑡)
𝑒−1
2 𝑑2
−for 𝜖∈{−1, 1}, we have
𝜕2𝐶
𝜕𝐾2 = 𝜕2𝑃
𝜕𝐾2 =
𝑒−𝑟(𝑇−𝑡)
𝜎𝐾
√
2𝜋(𝑇−𝑡)𝑒−1
2 𝑑2−
.
6. Vega. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Without explicitly computing the partial derivatives of 𝑑± show that the vega of a
European call, 𝐶= 𝜕𝐶
𝜕𝜎and a European put, 𝑃= 𝜕𝑃
𝜕𝜎are equal such that
=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
where = 𝐶= 𝑃.

2.2.4 The Greeks
225
Hence, deduce that
= 𝜎(𝑇−𝑡)𝑆2
𝑡Γ
where Γ = 𝜕2𝐶
𝜕𝑆2
𝑡
= 𝜕2𝑃
𝜕𝑆2
𝑡
.
Solution: For a European call the vega is defined as
𝐶= 𝜕𝐶
𝜕𝜎
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
𝜕𝑑+
𝜕𝜎−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
𝜕𝑑−
𝜕𝜎
and using the identity 𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡we have
𝜕𝑑−
𝜕𝜎= 𝜕𝑑+
𝜕𝜎−
√
𝑇−𝑡.
Hence,
𝐶= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
(𝜕𝑑−
𝜕𝜎+
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
𝜕𝑑−
𝜕𝜎
=
(
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
) 𝜕𝑑−
𝜕𝜎
+
√
𝑇−𝑡𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
=
1
√
2𝜋
(
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ −𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
) 𝜕𝑑−
𝜕𝜎
+
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
since 𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
Therefore,
𝐶=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
As for the European put, we note that
Φ(−𝑑±) = 1 −Φ(𝑑±)

226
2.2.4 The Greeks
and hence we can write
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)(1 −Φ(𝑑−)) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)(1 −Φ(𝑑+))
= 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Therefore,
𝑃= 𝜕𝑃
𝜕𝜎= 𝜕𝐶
𝜕𝜎
which implies
𝑃=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
Finally, by letting = 𝐶= 𝑃and Γ = Γ𝐶= Γ𝑃such that
Γ = 𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
𝜎𝑆𝑡
√
2𝜋(𝑇−𝑡)
= 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
𝜎𝑆2
𝑡
√
2𝜋(𝑇−𝑡)
and by setting 𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ or 𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−in terms of Γ and substituting it into we
have
= 𝜎(𝑇−𝑡)𝑆2
𝑡Γ.
7. Vomma. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.

2.2.4 The Greeks
227
Show that the vomma of a European call, 𝜕𝐶
𝜕𝜎= 𝜕2𝐶
𝜕𝜎2 and a European put, 𝜕𝑃
𝜕𝜎= 𝜕2𝑃
𝜕𝜎2
are equal such that
𝜕
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ 𝑑+𝑑−
𝜎
=
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−𝑑+𝑑−
𝜎
where 𝜕
𝜕𝜎= 𝜕𝐶
𝜕𝜎= 𝜕𝑃
𝜕𝜎.
Hence, deduce that
𝜕
𝜕𝜎= 𝑑+𝑑−
𝜎
where = 𝜕𝐶
𝜕𝜎= 𝜕𝑃
𝜕𝜎.
Solution: From Problem 2.2.4.6 (page 224), both the European call and put options have
the same vega
= 𝜕𝐶
𝜕𝜎= 𝜕𝑃
𝜕𝜎
where
=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−.
By considering =
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ and taking partial differences with respect
to 𝜎,
𝜕
𝜕𝜎= −
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+𝑑+
𝜕𝑑+
𝜕𝜎
and because
𝜕𝑑+
𝜕𝜎=
𝜎2(𝑇−𝑡)
3
2 −
[
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
] √
𝑇−𝑡
𝜎2(𝑇−𝑡)
= −𝑑−
𝜎
therefore
𝜕
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ 𝑑+𝑑−
𝜎
.

228
2.2.4 The Greeks
In contrast, by setting =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−and taking partial differences with
respect to 𝜎,
𝜕
𝜕𝜎= −
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−𝑑−
𝜕𝑑−
𝜕𝜎
and since
𝜕𝑑−
𝜕𝜎=
−𝜎2(𝑇−𝑡)
3
2 −
[
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
] √
𝑇−𝑡
𝜎2(𝑇−𝑡)
= −𝑑+
𝜎
therefore
𝜕
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−𝑑+𝑑−
𝜎
.
Because
=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ =
√
𝑇−𝑡
2𝜋𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
we can easily deduce
𝜕
𝜕𝜎= 𝑑+𝑑−
𝜎
.
8. Theta. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.

2.2.4 The Greeks
229
Without explicitly computing the partial derivatives of 𝑑± show that the theta of a
European call, Θ𝐶= 𝜕𝐶
𝜕𝑡and a European put, Θ𝑃= 𝜕𝑃
𝜕𝑡are
Θ𝐶=
(
𝐷Φ(𝑑+) −
𝜎𝑒−1
2 𝑑2
+
√
8𝜋(𝑇−𝑡)
)
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝜎𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
Θ𝑃= 𝑟𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −
(
𝐷Φ(−𝑑+) −
𝜎𝑒−1
2 𝑑2
+
√
8𝜋(𝑇−𝑡)
)
𝑆𝑡𝑒−𝐷(𝑇−𝑡).
Solution: By definition
𝜕𝐶
𝜕𝑡= 𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
𝜕𝑑+
𝜕𝑡
−𝑟𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−) −𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
𝜕𝑑−
𝜕𝑡.
Using the identity 𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡we have
𝜕𝑑−
𝜕𝑡= 𝜕𝑑+
𝜕𝑡+
𝜎
2
√
𝑇−𝑡
and since
𝜕Φ(𝑑±)
𝜕𝑑±
=
1
√
2𝜋
𝑒−1
2 𝑑2
±
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
we have
𝜕𝐶
𝜕𝑡= 𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝑟𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
+
1
√
2𝜋
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ 𝜕𝑑+
𝜕𝑡−
1
√
2𝜋
𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
(
𝜕𝑑+
𝜕𝑡+
𝜎
2
√
𝑇−𝑡
)
= 𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −
(
𝑟Φ(𝑑−) +
𝜎𝑒−1
2 𝑑2
−
√
8𝜋(𝑇−𝑡)
)
𝐾𝑒−𝑟(𝑇−𝑡)

230
2.2.4 The Greeks
or
𝜕𝐶
𝜕𝑡=
(
𝐷Φ(𝑑+) −
𝜎𝑒−1
2 𝑑2
+
√
8𝜋(𝑇−𝑡)
)
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝜎𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).
From the put–call parity equation
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
we have
𝜕𝑃
𝜕𝑡= 𝑟𝐾𝑒−𝑟(𝑇−𝑡) −𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝜕𝐶
𝜕𝑡
=
(
𝑟Φ(−𝑑−) −
𝜎𝑒−1
2 𝑑2
−
√
8𝜋(𝑇−𝑡)
)
𝐾𝑒−𝑟(𝑇−𝑡) −𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
or
𝜕𝑃
𝜕𝑡= 𝑟𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −
(
𝐷Φ(−𝑑+) −
𝜎𝑒−1
2 𝑑2
+
√
8𝜋(𝑇−𝑡)
)
𝑆𝑡𝑒−𝐷(𝑇−𝑡).
9. Rho. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Without explicitly computing the partial derivatives of 𝑑± show that the rho of a
European call, 𝜌𝐶= 𝜕𝐶
𝜕𝑟and a European put, 𝜌𝑃= 𝜕𝑃
𝜕𝑟are
𝜌𝐶= (𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
and
𝜌𝑃= −(𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−)
respectively.

2.2.4 The Greeks
231
Solution: Differentiating 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with respect to 𝑟,
𝜕𝐶
𝜕𝑟= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
𝜕𝑑+
𝜕𝑟−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
𝜕𝑑−
𝜕𝑟+ (𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).
Using the identity 𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡we have
𝜕𝑑−
𝜕𝑟= 𝜕𝑑+
𝜕𝑟
and since
𝜕Φ(𝑑±)
𝜕𝑑±
=
1
√
2𝜋
𝑒−1
2 𝑑2
±
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
we have
𝜕𝐶
𝜕𝑟=
1
√
2𝜋
(
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ −𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
) 𝜕𝑑+
𝜕𝑟
+(𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
= (𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).
Using the put–call parity
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
we have
𝜕𝑃
𝜕𝑟= −(𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡) (1 −Φ(𝑑−))
= −(𝑇−𝑡)𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−).
10. Psi. Let the Black–Scholes formulae for a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and a
European put option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)

232
2.2.4 The Greeks
with 𝑑± given by
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
expiry date of the option, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the
continuous dividend yield and 𝜎is the spot price volatility.
Without explicitly computing the partial derivatives of 𝑑± show that the psi of a
European call, 𝜓𝐶= 𝜕𝐶
𝜕𝐷and a European put, 𝜓𝑃= 𝜕𝑃
𝜕𝐷are
𝜓𝐶= −(𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+)
and
𝜓𝑃= (𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
respectively.
Solution: Differentiating 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with respect to 𝐷,
𝜕𝐶
𝜕𝐷= −(𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑑+
𝜕𝑑+
𝜕𝐷
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑑−
𝜕𝑑−
𝜕𝐷.
Using the identity 𝑑−= 𝑑+ −𝜎
√
𝑇−𝑡we have
𝜕𝑑−
𝜕𝐷= 𝜕𝑑+
𝜕𝐷
and since
𝜕Φ(𝑑±)
𝜕𝑑±
=
1
√
2𝜋
𝑒−1
2 𝑑2
±
and
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−
we can deduce
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ 𝜕𝑑+
𝜕𝐷= 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 𝑑2
−𝜕𝑑−
𝜕𝐷.

2.2.4 The Greeks
233
Thus,
𝜕𝐶
𝜕𝐷= −(𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+).
Finally, using the put–call parity
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
we have
𝜕𝑃
𝜕𝐷= 𝜕𝐶
𝜕𝐷+ (𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)
= −(𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) + (𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)
= (𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡) (1 −Φ(𝑑+))
= (𝑇−𝑡)𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+).
11. Bos–Vandermark Model. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the proba-
bility space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝜎is the volatility, and let 𝑟denote the risk-free interest rate.
Assume the stock 𝑆𝑡pays a fixed discrete dividend Δ𝐷at time 𝑡Δ𝐷> 𝑡. For a strike price
𝐾, find the differential equation satisfied by the option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) which can only be
exercised at expiry time 𝑇> 𝑡Δ𝐷.
By setting 𝜆𝑡∈[0, 1] such that
𝑆∗
𝑡= 𝑆𝑡−𝜆𝑡Δ𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡)
𝐾∗= 𝐾+ (1 −𝜆𝑡)Δ𝐷𝑒𝑟(𝑇−𝑡Δ𝐷)
show that for 𝑡< 𝑡Δ𝐷, the option premium price is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆∗
𝑡, 𝑡; 𝐾∗, 𝑇)
satisfying
Δ𝐷
(𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗
)
𝜆′
𝑡+ 𝜎2 (1
2Δ2
𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡)𝜆2
𝑡−Δ𝐷𝑆∗
𝑡𝜆𝑡
) 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 = 0
where 𝑉𝑏𝑠(⋅) is the European option solution for zero discrete dividend.

234
2.2.4 The Greeks
By neglecting higher orders of 𝑇−𝑡and assuming 𝑆∗
𝑡→𝐾∗, show that
𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗≈𝜎2(𝑇−𝑡)𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2
and finally by neglecting the contribution of Δ2
𝐷deduce that
𝜆𝑡≈
𝑇−𝑡Δ𝐷
𝑇−𝑡.
You may assume that the cdf of the standard normal Φ(𝑥) can be approximated by the
Marsaglia formula
Φ(𝑥) = 1
2 + 𝜙(𝑥)
(
𝑥+ 𝑥3
3 + 𝑥5
3 ⋅5 + ⋯+
𝑥2𝑛+1
3 ⋅5 ⋅7 ⋯(2𝑛+ 1) + …
)
, 𝑛∈ℕ
where 𝜙(𝑥) =
1
√
2𝜋
𝑒−1
2 𝑥2.
Solution: For the first two results, refer to Problems 2.2.2.3 (page 93) and 2.2.2.13
(page 120).
Since
𝑆∗
𝑡= 𝑆𝑡−𝜆𝑡Δ𝐷𝑒−𝑟(𝑡𝛿𝐷−𝑡)
𝐾∗= 𝐾+ (1 −𝜆𝑡)Δ𝐷𝑒𝑟(𝑇−𝑡Δ𝐷)
and from the identity 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑉𝑏𝑠(𝑆∗
𝑡, 𝑡; 𝐾∗, 𝑇) we have
𝜕𝑉
𝜕𝑡= 𝜕𝑉𝑏𝑠
𝜕𝑡
+ 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
𝜕𝑆∗
𝑡
𝜕𝑡+ 𝜕𝑉𝑏𝑠
𝜕𝐾∗
𝜕𝐾∗
𝜕𝑡
= 𝜕𝑉𝑏𝑠
𝜕𝑡
+ 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
(
−𝑟𝜆𝑡Δ𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡) −Δ𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡)𝜆′
𝑡
)
+𝜕𝑉𝑏𝑠
𝜕𝐾∗
(
−Δ𝐷𝑒𝑟(𝑇−𝑡Δ𝐷)𝜆′
𝑡
)
= 𝜕𝑉𝑏𝑠
𝜕𝑡
−𝑟𝜆𝑡Δ𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
−Δ𝐷𝜆′
𝑡
(
𝑒−𝑟(𝑡Δ𝐷−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡Δ𝐷) 𝜕𝑉𝑏𝑠
𝜕𝐾∗
)
𝜕𝑉
𝜕𝑆𝑡
= 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
𝜕𝑆∗
𝑡
𝜕𝑆𝑡
= 𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
and
𝜕2𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
)
= 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2
𝜕𝑆∗
𝑡
𝜕𝑆𝑡
= 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 .

2.2.4 The Greeks
235
By substituting the above results into the differential equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+
(
𝑟𝑆𝑡−Δ𝐷⋅𝛿(𝑡−𝑡Δ𝐷)
) 𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
where 𝛿(𝑡−𝑡Δ𝐷) is the Dirac delta function centred at time 𝑡= 𝑡Δ𝐷, and after some alge-
braic manipulation we eventually arrive at
𝛿
(𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗
)
𝜆′
𝑡+ 𝜎2 (1
2Δ2
𝐷𝑒−𝑟(𝑡Δ𝐷−𝑡)𝜆2
𝑡−Δ𝐷𝑆∗
𝑡𝜆𝑡
) 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 = 0.
Using the property Φ(𝑥) = 1 −Φ(−𝑥) and from Problems 2.2.4.2 (page 220) and 2.2.4.4
(page 222), we have
𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗= Φ(𝑑+) −Φ(𝑑−).
From the definition
𝑑∗
+ =
log(𝑆∗
𝑡∕𝐾∗) + (𝑟+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
we can express
𝑑∗
+ =
(𝑟+ 1
2𝜎2
𝜎
) √
𝑇−𝑡+ 𝑂(log(𝑆∗
𝑡∕𝐾∗))
(𝑑∗
+)2 =
(𝑟+ 1
2𝜎2
𝜎
)2
(𝑇−𝑡) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
(𝑑∗
+)3 = 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗)).
Using Marsaglia’s formula
Φ(𝑑∗
+) = 1
2 + 𝜙(𝑑∗
+)
(
𝑑∗
+ +
(𝑑∗
+)3
3
+ …
)
= 1
2 + 𝜙(𝑑∗
+)
(𝑟+ 1
2𝜎2
𝜎
) √
𝑇−𝑡+ 𝑂((𝑇−𝑡)3∕2)
+𝑂(log(𝑆∗
𝑡∕𝐾∗))

236
2.2.4 The Greeks
and since 𝑑∗
−= 𝑑∗
+ −𝜎
√
𝑇−𝑡, from Taylor’s expansion
𝜙(𝑑∗
−) = 1
2 + 𝜙(𝑑∗
−)
(
𝑑∗
−+
(𝑑∗
−)3
3
+ …
)
= 1
2 + 𝜙(𝑑∗
+ −𝜎
√
𝑇−𝑡)
(
𝑑∗
+ −𝜎
√
𝑇−𝑡+
(𝑑∗
+ −𝜎
√
𝑇−𝑡)3
3
+ …
)
= 1
2 +
(
𝜙(𝑑∗
+) −𝜎𝜙′(𝑑∗
+)
√
𝑇−𝑡+ 1
2𝜎2𝜙′′(𝑑∗
+)(𝑇−𝑡) + 𝑂((𝑇−𝑡)3∕2)
)
×
((𝑟−1
2𝜎2
𝜎
) √
𝑇−𝑡+ 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
)
= 1
2 + 𝜙(𝑑∗
+)
(𝑟−1
2𝜎2
𝜎
) √
𝑇−𝑡+ 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗)).
Thus,
Φ(𝑑∗
+) −Φ(𝑑∗
−) = 𝜎𝜙(𝑑∗
+)
√
𝑇−𝑡+ 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
= 𝜎
√
𝑇−𝑡
2𝜋𝑒−1
2 (𝑑∗
+)2 + 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
= 𝜎2(𝑇−𝑡)𝑆∗
𝑡
𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 + 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
since 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 =
𝑒−1
2 (𝑑∗
+)2
𝜎𝑆∗
𝑡
√
2𝜋(𝑇−𝑡)
(see Problem 2.2.4.3, page 221).
Hence,
𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗= 𝜎2(𝑇−𝑡)𝑆∗
𝑡
𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 + 𝑂((𝑇−𝑡)3∕2) + 𝑂(log(𝑆∗
𝑡∕𝐾∗))
and ignoring higher orders of 𝑇−𝑡and assuming 𝑆∗
𝑡→𝐾∗,
𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗≈𝜎2(𝑇−𝑡)𝑆∗
𝑡
𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 .

2.2.4 The Greeks
237
By substituting the above result into
Δ𝐷
(𝜕𝑉𝑏𝑠
𝜕𝑆∗
𝑡
+ 𝑒𝑟(𝑇−𝑡) 𝜕𝑉𝑏𝑠
𝜕𝐾∗
)
𝜆′
𝑡+ 𝜎2 (1
2Δ𝐷
2𝑒−𝑟(𝑡Δ𝐷−𝑡)𝜆2
𝑡−Δ𝐷𝑆∗
𝑡𝜆𝑡
) 𝜕2𝑉𝑏𝑠
𝜕(𝑆∗
𝑡)2 = 0
and neglecting the contribution of 𝛿2
𝐷, we arrive at
𝜆′
𝑡≈
𝜆𝑡
𝑇−𝑡.
Solving the first-order differentiation function,
log 𝜆𝑡≈−log(𝑇−𝑡) + 𝐶
where 𝐶is a constant. Since the discrete dividend Δ𝐷is paid at 𝑡= 𝑡Δ𝐷, therefore 𝜆𝑡Δ𝐷= 1.
Hence, we have 𝐶= log(𝑇−𝑡Δ𝐷) and so
𝜆𝑡≈
𝑇−𝑡Δ𝐷
𝑇−𝑡.
12. Delta Hedging. Assume we are in a Black–Scholes world where on day 𝑡= 0 a stock is
trading at 𝑆0 = $35 per share. The stock price volatility is 𝜎= 25% and it pays a contin-
uous dividend yield 𝐷= 2%. Suppose the writer of a European option sells a call option
with strike 𝐾= $33 on 1000 shares with time to expiration 𝑇= 180 days.
Given the risk-free interest rate 𝑟= 5% per annum, calculate the following.
(a) The call price and the corresponding delta at day 0. What is the writer’s risk by selling
a call option?
(b) The writer’s trading strategy to maintain a delta-hedged portfolio on day 0. How much
money does the writer need to borrow/put in a risk-free money market on day 0 in
order to maintain a delta-hedged portfolio?
(c) The writer’s profit if the stock price increases to $35.50 on day 1. Calculate also the
cost to keep the portfolio delta neutral.
(d) The writer’s profit if the stock price falls to $34.80 on day 2. Calculate also the cost to
keep the portfolio delta neutral.
Note if 𝑍∼(0, 1) then the cumulative standard normal distribution function in the
range [0, 𝑥], 𝑥> 0 can be approximated by
ℙ(0 < 𝑍< 𝑥) =
1
√
2𝜋
(
𝑥−𝑥3
6 + 𝑥5
40 −𝑥7
336 +
𝑥9
3456
)
, 0 < 𝑥≪1.
Solution:
(a) On day 0 we have 𝑆0 = 35, 𝐾= 33, 𝑟= 0.05, 𝐷= 0.02, 𝜎= 0.25, 𝑇= 180
365. From the
Black–Scholes formula we can write the call option price as
𝐶(𝑆0, 0; 𝐾, 𝑇) = 𝑆0𝑒−𝐷𝑇Φ(𝑑1) −𝐾𝑒−𝑟𝑇Φ(𝑑2)

238
2.2.4 The Greeks
where
𝑑1 =
log (𝑆0∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)𝑇
𝜎
√
𝑇
=
log (35∕33) + (0.05 −0.02 + 0.5 × 0.252) 180
365
0.25 ×
√
180
365
= 0.5072
and
𝑑2 = 𝑑1 −𝜎
√
𝑇= 0.5072 −0.25 ×
√
180
365 = 0.3316.
Hence, from the polynomial approximation
Φ(𝑑1) = 1
2 + ℙ(0 < 𝑍< 𝑑1)
= 1
2 +
1
√
2𝜋
(
0.5072 −0.50723
6
+ 0.50725
40
−0.50727
336
+ 0.50729
3456
)
= 0.6940
and
Φ(𝑑2) = 1
2 + ℙ(0 < 𝑍< 𝑑2)
= 1
2 +
1
√
2𝜋
(
0.3316 −0.33163
6
+ 0.33165
40
−0.33167
336
+ 0.33169
3456
)
= 0.6299.
Therefore, on day 0 the call option price is
𝐶(𝑆0, 0; 𝐾, 𝑇) = 35 × 𝑒−0.02× 180
365 × 0.6940 −33 × 𝑒−0.05× 180
365 × 0.6299
= $3.7712
and the corresponding delta is
Δ0 = 𝑒−𝐷𝑇Φ(𝑑1) = 𝑒−0.02× 180
365 × 0.6940 = 0.6872.
The risk of the call option writer is rising stock prices with respect to the option written
on 𝑆0.
(b) On day 𝑡= 0, let the hedging portfolio be
Π0 = −𝐶(𝑆0, 0; 𝐾, 𝑇) + Δ𝑆0

2.2.4 The Greeks
239
where the call writer sells an option and buys Δ number of 𝑆0. To maintain a delta-
hedged portfolio we need
𝜕Π0
𝜕𝑆0
= 0
so that
Δ = 𝜕𝐶
𝜕𝑆0
= 0.6872.
That is, for each call option sold, the writer needs to buy 0.6872 units of 𝑆0 = $35.
To calculate how much money needs to be borrowed/put in a risk-free money market
we replicate the derivative as
𝐶(𝑆0, 0; 𝐾, 𝑇) = Δ0𝑆0 + 𝜓0
where 𝜓0 is the amount of cash injected into the money market earning a risk-free
interest rate 𝑟= 5%.
Given 𝐶(𝑆0, 0; 𝐾, 𝑇) = 3.7712, 𝑆0 = 35 and Δ0 = 0.6872 we have
𝜓0 = 𝐶(𝑆0, 0; 𝐾, 𝑇) −Δ0𝑆0 = 3.7712 −0.6872 × 35 = −$20.2808.
Thus, on day 0 the writer’s trading strategy is to borrow 1000 × $20.2808 =
$20,280.80 from the money market at 𝑟= 5% interest rate and purchase 1000 ×
0.6872 = 687.20 units of 𝑆0 = $35.
(c) On day 1, 𝑆𝛿𝑡= 35.50 where 𝛿𝑡=
1
365. The call option price is then
𝐶(𝑆𝛿𝑡, 𝛿𝑡; 𝐾, 𝑇) = 𝑆𝛿𝑡𝑒−𝐷(𝑇−𝛿𝑡)Φ(𝑑1) −𝐾𝑒−𝑟(𝑇−𝛿𝑡)Φ(𝑑2)
where
𝑑1 =
log (𝑆𝛿𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝛿𝑡)
𝜎
√
𝑇−𝛿𝑡
=
log (35.50∕33) + (0.05 −0.02 + 0.5 × 0.252) 179
365
0.25 ×
√
179
365
= 0.5887
and
𝑑2 = 𝑑1 −𝜎
√
𝑇−𝛿𝑡= 0.5887 −0.25 ×
√
179
365 = 0.4136.

240
2.2.4 The Greeks
Hence, from the polynomial approximation
Φ(𝑑1) = 1
2 + ℙ(0 < 𝑍< 𝑑1)
= 1
2 +
1
√
2𝜋
(
0.5887 −0.58873
6
+ 0.58875
40
−0.58877
336
+ 0.58879
3456
)
= 0.7720
and
Φ(𝑑2) = 1
2 + ℙ(0 < 𝑍< 𝑑2)
= 1
2 +
1
√
2𝜋
(
0.4136 −0.41363
6
+ 0.41365
40
−0.41367
336
+ 0.41369
3456
)
= 0.6604.
Therefore, on day 1 the call option price is
𝐶(𝑆𝛿𝑡, 𝛿𝑡; 𝐾, 𝑇) = 35.50 × 𝑒−0.02× 179
365 × 0.7720 −33 × 𝑒−0.05× 179
365 × 0.6604
= $4.1155
where
Gains on option price sold = 1000 × (3.7712 −4.1155) = −$344.40
Gains on share price purchased = 1000 × 0.6872 × (35.50 −35) = $343.60
1-Day interest = 20,280.80 × (1 −𝑒0.05× 1
365 ) = −$2.7783
so that
Total profit on day 1 = −344.40 + 343.60 −2.7783 = −$3.4783.
The delta of the call option on day 1 is
Δ𝛿𝑡= 𝑒−𝐷(𝑇−𝛿𝑡)Φ(𝑑1) = 𝑒−0.02× 179
365 × 0.7220 = 0.7150
and to replicate the option
𝐶(𝑆𝛿𝑡, 𝛿𝑡; 𝐾, 𝑇) = Δ𝛿𝑡𝑆𝛿𝑡+ 𝜓𝛿𝑡
we have
𝜓𝛿𝑡= 𝐶(𝑆𝛿𝑡, 𝛿𝑡; 𝐾, 𝑇) −Δ𝛿𝑡𝑆𝛿𝑡= 4.1155 −0.7150 × 35.50 = −$21.2670.

2.2.4 The Greeks
241
Thus, on day 1, the writer needs to buy an additional 1000 × (0.7150 −0.6872) =
27.8 units of 𝑆𝛿𝑡= $35.50 and borrow an additional 1000 × (21.2670 −20.2808) =
$986.20 from the money market at 𝑟= 5% interest rate.
(d) On day 2, 𝑆2𝛿𝑡= 34.80 where 𝛿𝑡=
1
365. The call option price is defined as
𝐶(𝑆2𝛿𝑡, 2𝛿𝑡; 𝐾, 𝑇) = 𝑆2𝛿𝑡𝑒−𝐷(𝑇−2𝛿𝑡)Φ(𝑑1) −𝐾𝑒−𝑟(𝑇−2𝛿𝑡)Φ(𝑑2)
where
𝑑1 =
log (𝑆2𝛿𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−2𝛿𝑡)
𝜎
√
𝑇−2𝛿𝑡
=
log (34.80∕33) + (0.05 −0.02 + 0.5 × 0.252) 178
365
0.25 ×
√
178
365
= 0.4753
and
𝑑2 = 𝑑1 −𝜎
√
𝑇−2𝛿𝑡= 0.4753 −0.25 ×
√
178
365 = 0.3007.
Hence, from the polynomial approximation
Φ(𝑑1) = 1
2 + ℙ(0 < 𝑍< 𝑑1)
= 1
2 +
1
√
2𝜋
(
0.4753 −0.47533
6
+ 0.47535
40
−0.47537
336
+ 0.47539
3456
)
= 0.6870
and
Φ(𝑑2) = 1
2 + ℙ(0 < 𝑍< 𝑑2)
= 1
2 +
1
√
2𝜋
(
0.3007 −0.30073
6
+ 0.30075
40
−0.30077
336
+ 0.30079
3456
)
= 0.6182.
Therefore, on day 2 the call option price is
𝐶(𝑆2𝛿𝑡, 2𝛿𝑡; 𝐾, 𝑇) = 34.80 × 𝑒−0.02× 178
365 × 0.6870
−33 × 𝑒−0.05× 178
365 × 0.6182
= $3.6182

242
2.2.4 The Greeks
where
Gains on option price sold = 1000 × (4.1155 −3.6182) = $497.30
Gains on share price purchased = 1000 × 0.7150 × (34.80 −35.50)
= −$500.50
1-Day interest = 21, 267 × (1 −𝑒0.05× 1
365 ) = −$2.9135
so that
Total profit on day 2 = 497.30 −500.50 −2.9135 = −$6.1135.
The delta of the call option on day 2 is
Δ2𝛿𝑡= 𝑒−𝐷(𝑇−2𝛿𝑡)Φ(𝑑1) = 𝑒−0.02× 178
365 × 0.6870 = 0.6761
and to replicate the option
𝐶(𝑆2𝛿𝑡, 2𝛿𝑡; 𝐾, 𝑇) = Δ2𝛿𝑡𝑆2𝛿𝑡+ 𝜓2𝛿𝑡
we have
𝜓2𝛿𝑡= 𝐶(𝑆2𝛿𝑡, 2𝛿𝑡; 𝐾, 𝑇) −Δ2𝛿𝑡𝑆2𝛿𝑡
= 3.6182 −0.6761 × 34.80
= −$19.91008.
Thus, on day 2, the writer needs to sell 1000 × (0.7150 −0.6761) = 38.9 units of
𝑆2𝛿𝑡= $34.80 and invest 1000 × (21.2670 −19.91008) = $1356.92 into the money
market earning 𝑟= 5% interest rate.
13. By referring to Problem 2.2.3.11 (page 211) find the trading strategy to hedge the option
at the initial time period.
If the asset price moves down and up at time period 𝑛= 1 and 𝑛= 2, respectively, cal-
culate the trading strategy to hedge this option.
Solution: At time period 𝑛= 0, let 𝜙0 and 𝜓0 be the unit of the underlying asset 𝑆0 and
the amount of cash invested in the money market, respectively. At time period 𝑛= 1, the
asset price can either be 𝑆(0)
1
= 𝑑𝑆0 or 𝑆1
1 = 𝑢𝑆0 and 𝜓0 will grow to 𝜓0𝑒𝑟Δ𝑡. Thus, we
can write
𝑉(0)
1
= 𝜙0𝑆(0)
1
+ 𝜓0𝑒𝑟Δ𝑡
𝑉(1)
1
= 𝜙0𝑆(1)
1
+ 𝜓0𝑒𝑟Δ𝑡.
Hence,
𝜙0 =
𝑉(1)
1
−𝑉(0)
1
𝑆(1)
1
−𝑆(0)
1
=
𝑉(1)
1
−𝑉(0)
1
𝑢𝑆0 −𝑑𝑆0

2.2.4 The Greeks
243
and
𝜓0 = 𝑒−𝑟Δ𝑡(𝑉(0)
1
−𝜙0𝑆(0)
1 ).
By substituting 𝑉(0)
1
= 3.8322, 𝑉(1)
1
= 13.4438, 𝑆(0)
1
= 𝑑𝑆0 = 94.39, 𝑆(1)
1
= 𝑢𝑆0 =
105.94, 𝑟= 0.05 and Δ𝑡= 1
3 we have
𝜙0 = 0.8322
and
𝜓0 = −73.4817
which implies we need to buy 0.8322 units of the underlying asset 𝑆0 and borrow $73.4817
from the money market at 5% interest rate.
At time period 𝑛= 1 we have 𝑆1 = 𝑆(0)
1
= 𝑑𝑆0 and by setting 𝜙1 as the number of units
of the underlying 𝑆1 and 𝜓1 as the amount of money invested in the money market, we
can write the replication portfolio as
𝑉(0)
2
= 𝜙1𝑆(0)
2
+ 𝜓1𝑒𝑟Δ𝑡
𝑉(1)
2
= 𝜙1𝑆(1)
2
+ 𝜓1𝑒𝑟Δ𝑡.
Hence,
𝜙1 =
𝑉(1)
2
−𝑉(0)
2
𝑆(1)
2
−𝑆(0)
2
=
𝑉(1)
2
−𝑉(0)
2
𝑢𝑑𝑆0 −𝑑2𝑆0
and
𝜓1 = 𝑒−𝑟Δ𝑡(𝑉(0)
2
−𝜙1𝑆(0)
2 ).
By substituting 𝑉(0)
2
= 0, 𝑉(1)
2
= 6.4739, 𝑆(0)
2
= 𝑑2𝑆0 = 89.09, 𝑆(1)
2
= 𝑢𝑑𝑆0 = 100, 𝑟=
0.05 and Δ𝑡= 1
3 we have
𝜙1 = 0.5936
and
𝜓1 = −52.0360
where at time period 𝑛= 1 we now need to sell 0.8322 −0.5936 = 0.2386 units of the
underlying asset 𝑆1 = $94.39 and invest 73.4817 −52.0360 = $21.4457 into the money
market earning 5% interest rate.
For time period 2, we set 𝑆2 = 𝑆(1)
2
= 𝑢𝑑2𝑆0 and we let 𝜙2 be the number of units of the
underlying 𝑆2 and 𝜓2 be the amount of money invested in the money market. To replicate
the payoff we have
𝑉(1)
3
= 𝜙2𝑆(1)
3
+ 𝜓2𝑒𝑟Δ𝑡
𝑉(2)
3
= 𝜙2𝑆(2)
3
+ 𝜓2𝑒𝑟Δ𝑡

244
2.2.4 The Greeks
and hence by solving the linear equations we have
𝜙2 =
𝑉(2)
3
−𝑉(1)
3
𝑆(2)
3
−𝑆(1)
3
=
𝑉(2)
3
−𝑉(1)
3
𝑢2𝑑𝑆0 −𝑢𝑑2𝑆0
and
𝜓2 = 𝑒−𝑟Δ𝑡(𝑉(1)
3
−𝜙2𝑆(1)
3 ).
Substituting 𝑉(1)
3
= 0, 𝑉(2)
3
= 10.9366, 𝑆(1)
3
= 𝑢𝑑2𝑆0 = 94.39, 𝑆(2)
3
= 𝑢2𝑑𝑆0 = 105.94,
𝑟= 0.05 and Δ𝑡= 1
3 we have
𝜙2 = 0.9469
and
𝜓2 = −89.8998
where we need to buy an additional 0.9469 −0.5934 = 0.3535 units of the underlying
asset 𝑆2 = $100 and borrow an additional 89.8998 −52.0360 = $31.8638 from the money
market at 5% interest rate.
14. At time 𝑡the stock price is trading at 𝑆𝑡= $40 with delta Δ𝑡= 0.4127 and gamma Γ𝑡=
0.1134. Estimate the new value of delta if 𝑆𝑡+𝛿𝑡= $42.75 at time 𝑡+ 𝛿𝑡, 𝛿𝑡> 0.
Solution: By definition, Γ𝑡= 𝜕Δ𝑡
𝜕𝑆𝑡
which can be approximated by
Γ𝑡≈Δ𝑡+𝛿𝑡−Δ𝑡
𝑆𝑡+𝛿𝑡−𝑆𝑡
.
Hence,
Δ𝑡+𝛿𝑡≈Δ𝑡+ Γ𝑡(𝑆𝑡+𝛿𝑡−𝑆𝑡)
= 0.4127 + 0.1134 × (42.75 −40)
= 0.7246.
15. Consider a stock trading at 𝑆𝑡= $49 with volatility 𝜎𝑡= 35% at time 𝑡. A European put
option 𝑃(𝑆𝑡, 𝑡) on the stock is priced at $2.3217 with vega 𝑡= 0.3796. If the volatility
increases by 0.5% at time 𝑡+ 𝛿𝑡, 𝛿𝑡> 0, find the new put option price.
Solution: By definition, 𝑡= 𝜕𝑃
𝜕𝜎𝑡
which can be approximated by
𝑡≈𝑃(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) −𝑃(𝑆𝑡, 𝑡)
𝜎𝑡+𝛿𝑡−𝜎𝑡
.

2.2.4 The Greeks
245
Hence,
𝑃(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) ≈𝑃(𝑆𝑡, 𝑡) + 𝑡(𝜎𝑡+𝛿𝑡−𝜎𝑡)
= 2.3217 −0.3796 × 0.05
= 2.3407.
16. At time 𝑡, we have an asset price 𝑆𝑡= $37 which pays a continuous dividend yield
𝐷= 1.2% with volatility 𝜎= 30%. By setting the risk-free interest rate 𝑟= 8.5% we let
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the European call option price having a strike price 𝐾= $35 with time
to expiry 𝑇−𝑡= 90 days, where 𝑇is the option expiry time.
From the information given in Table 2.3 find the price of the European put option at
time 𝑡.
Table 2.3
European call option Greek values.
European Call Option Greeks
Value
Δ𝑡
0.7110
Γ𝑡
0.0620
𝑡
0.0624
Θ𝑡(per calendar day)
−0.0146
Solution: From the Black–Scholes equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
or
Θ𝑡+ 1
2𝜎2𝑆2
𝑡Γ𝑡+ (𝑟−𝐷)𝑆𝑡Δ𝑡−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
Given that Θ𝑡= 0.0146 is quoted per calendar day, then per year
Θ𝑡= −0.0146 × 365 = −5.3290.
Therefore, the call option price is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 1
𝑟
(
Θ𝑡+ 1
2𝜎2𝑆2
𝑡Γ𝑡+ (𝑟−𝐷)𝑆𝑡Δ𝑡
)
=
1
0.085
(−5.3290 + 0.5 × 0.32 × 372 × 0.0620
+(0.085 −0.012) × 37 × 0.7110)
= $4.8344.

246
2.2.4 The Greeks
From put–call parity, the put option price is
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝐾𝑒−𝑟(𝑇−𝑡)
= 4.8344 −37𝑒−0.012× 90
365 + 35𝑒−0.085× 90
365
= $2.2178.
17. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and
let the evolution of the asset price 𝑆𝑡have the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the asset price
volatility. By setting 𝑟as the risk-free interest rate, a derivative security written on this
asset has price 𝑉(𝑆𝑡, 𝑡) with payoff Ψ(𝑆𝑇) at expiry time 𝑇.
Show that the interest-rate sensitivity 𝜌(𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝑟satisfies the differential equation
𝐵𝑆[𝜌(𝑆𝑡, 𝑡)] = 𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
with boundary condition 𝜌(𝑆𝑇, 𝑇) = 0 where 𝐵𝑆denotes the differential operator
𝐵𝑆= 𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟.
Interpret this result financially.
By writing the solution of 𝜌(𝑆𝑡, 𝑡) in the form
𝜌(𝑆𝑡, 𝑡) = 𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)
with 𝑈(𝑆𝑇, 𝑇) = 0, show that
𝜌(𝑆𝑡, 𝑡) = −(𝑇−𝑡)
[
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
.
Solution: Since 𝑉(𝑆𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0

2.2.4 The Greeks
247
then by differentiating the Black–Scholes equation with respect to 𝑟we have
𝜕
𝜕𝑟
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0
or
𝜕
𝜕𝑡
(𝜕𝑉
𝜕𝑟
)
+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
(𝜕𝑉
𝜕𝑟
)
+ 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
(𝜕𝑉
𝜕𝑟
)
−𝑉(𝑆𝑡, 𝑡) −𝑟𝜕𝑉
𝜕𝑟= 0.
By setting 𝜌(𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝑟we have
𝜕𝜌
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜌
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜌
𝜕𝑆𝑡
−𝑟𝜌(𝑆𝑡, 𝑡) = 𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
.
Because 𝑉(𝑆𝑇, 𝑇) = Ψ(𝑆𝑇), thus 𝜕𝑉
𝜕𝑟(𝑆𝑇, 𝑇) = 𝜌(𝑆𝑇, 𝑇) = 0.
Hence,
𝐵𝑆[𝜌(𝑆𝑡, 𝑡)] = 𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
with boundary condition 𝜌(𝑆𝑇, 𝑇) = 0.
If we set the delta of the option 𝜕𝑉
𝜕𝑆𝑡
= Δ then
𝐵𝑆[𝜌(𝑆𝑡, 𝑡)] = 𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
which is equivalent to a hedging portfolio used to construct the Black–Scholes equation.
By letting the solution of 𝜌(𝑆𝑡, 𝑡) be written as
𝜌(𝑆𝑡, 𝑡) = 𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)
where 𝑔(𝑡) is a function depending on time 𝑡, then by substituting it into the Black–Scholes
differential operator
𝐵𝑆[𝜌(𝑆𝑡, 𝑡)] = 𝐵𝑆[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)]
= 𝜕
𝜕𝑡[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)] + 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)]
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)] −𝑟[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)]
= 𝑑𝑔
𝑑𝑡𝑈(𝑆𝑡, 𝑡) + 𝑔(𝑡)𝐵𝑆[𝑈(𝑆𝑡, 𝑡)].

248
2.2.4 The Greeks
By setting 𝑈(𝑆𝑡, 𝑡) = 𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
and since both 𝑉(𝑆𝑡, 𝑡) and 𝜕𝑉
𝜕𝑆𝑡
satisfy the Black–
Scholes equation (see Problem 2.2.2.9, page 110), therefore
𝐵𝑆[𝑈(𝑆𝑡, 𝑡)] = 𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] −𝐵𝑆
[
𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
= 0.
Thus, we can set
𝐵𝑆[𝜌(𝑆𝑡, 𝑡)] = 𝑑𝑔
𝑑𝑡
[
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
where 𝑑𝑔
𝑑𝑡= 1 with boundary condition 𝑔(𝑇) = 0.
Solving the first-order differential equation and taking note that 𝑔(𝑇) = 0, we have
𝑔(𝑡) = −(𝑇−𝑡)
and hence
𝜌(𝑆𝑡, 𝑡) = −(𝑇−𝑡)
[
𝑉(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
.
18. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and
let the asset price 𝑆𝑡follow a GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the asset price
volatility. By setting 𝑟as the risk-free interest rate, a derivative security written on this
asset has price 𝑉(𝑆𝑡, 𝑡) with payoff Ψ(𝑆𝑇) at expiry time 𝑇.
Show that the volatility sensitivity (𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝜎satisfies
𝐵𝑆[(𝑆𝑡, 𝑡)] + 𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) = 0
with boundary condition (𝑆𝑇, 𝑇) = 0 where
Γ(𝑆𝑡, 𝑡) = 𝜕2𝑉
𝜕𝑆2
𝑡
is the gamma of the option price and 𝐵𝑆denotes the differential operator
𝐵𝑆= 𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟.

2.2.4 The Greeks
249
Let 𝑈(𝑆𝑡, 𝑡) be the price of another option that receives or pays 𝐾(𝑆𝑡, 𝑡) per unit time
(𝐾(𝑆𝑡, 𝑡) > 0 denotes receiving an income whilst 𝐾(𝑆𝑡, 𝑡) < 0 corresponds to a payment).
By setting up a hedging portfolio show that 𝑈(𝑆𝑡, 𝑡) satisfies
𝐵𝑆[𝑈(𝑆𝑡, 𝑡)] + 𝐾(𝑆𝑡, 𝑡) = 0.
Further, show that if 𝑈(𝑆𝑇, 𝑇) = 0 and 𝐾(𝑆𝑡, 𝑡) > 0 for 0 ≤𝑡< 𝑇then 𝑈(𝑆𝑡, 𝑡) > 0 for
0 ≤𝑡< 𝑇.
Hence, deduce that if Γ(𝑆𝑡, 𝑡) > 0 then (𝑆𝑡, 𝑡) > 0 and finally show that
(𝑆𝑡, 𝑡) = (𝑇−𝑡)𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡).
Solution: Since 𝑉(𝑆𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
and by differentiating the Black–Scholes equation with respect to 𝜎we have
𝜕
𝜕𝜎
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0
or
𝜕
𝜕𝑡
(𝜕𝑉
𝜕𝜎
)
+ 𝜎𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
(𝜕𝑉
𝜕𝜎
)
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
(𝜕𝑉
𝜕𝜎
)
−𝑟𝜕𝑉
𝜕𝜎= 0.
By setting (𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝜎and Γ(𝑆𝑡, 𝑡) = 𝜕2𝑉
𝜕𝑆2
𝑡
we can write
𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟(𝑆𝑡, 𝑡) + 𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) = 0
and using the differential operator 𝐵𝑆we eventually have
𝐵𝑆[(𝑆𝑡, 𝑡)] + 𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) = 0
with boundary condition
(𝑆𝑇, 𝑇) = 𝜕𝑉
𝜕𝜎(𝑆𝑇, 𝑇) = 𝜕Ψ
𝜕𝜎(𝑆𝑇) = 0.
At time 𝑡we let the hedging portfolio Π𝑡be constructed by taking a long position on option
𝑈(𝑆𝑡, 𝑡) and short Δ units of 𝑆𝑡such that
Π𝑡= 𝑈(𝑆𝑡, 𝑡) −Δ𝑆𝑡.

250
2.2.4 The Greeks
Since the asset pays a continuous dividend yield 𝐷and the option 𝑈(𝑆𝑡, 𝑡) receives/pays
𝐾(𝑆𝑡, 𝑡) per unit time, the instantaneous change in the portfolio is
𝑑Π𝑡= 𝑑𝑈+ 𝐾(𝑆𝑡, 𝑡)𝑑𝑡−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡)
= 𝑑𝑈−Δ𝑑𝑆𝑡+ (𝐾(𝑆𝑡, 𝑡) −Δ𝐷𝑆𝑡)𝑑𝑡.
Expanding 𝑈(𝑆𝑡, 𝑡) using Taylor’s theorem we have
𝑑𝑈= 𝜕𝑈
𝜕𝑡𝑑𝑡+ 𝜕𝑈
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑈
𝜕𝑆2
𝑡
𝑑𝑆2
𝑡+ …
Substituting 𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡and applying It¯o’s lemma
𝑑𝑈=
(
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
)
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
𝑑𝑊𝑡.
Hence,
𝑑Π𝑡=
(
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
+ 𝐾(𝑆𝑡, 𝑡) −𝜇Δ𝑆𝑡
)
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑈
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡
and to eliminate the risk we set
Δ = 𝜕𝑈
𝜕𝑆𝑡
so that
𝑑Π𝑡=
(
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
+ 𝐾(𝑆𝑡, 𝑡) −𝜇Δ𝑆𝑡
)
𝑑𝑡.
Under the no-arbitrage condition the return on the amount Π𝑡invested in a risk-free interest
rate 𝑟would be
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡

2.2.4 The Greeks
251
and taking into account that Δ = 𝜕𝑉
𝜕𝑆𝑡
we have
𝑟Π𝑡𝑑𝑡=
(
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
+𝐾(𝑆𝑡, 𝑡) −𝜇Δ𝑆𝑡
)
𝑑𝑡
𝑟(𝑈(𝑆𝑡, 𝑡) −Δ𝑆𝑡)𝑑𝑡=
(
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
+𝐾(𝑆𝑡, 𝑡) −𝜇Δ𝑆𝑡
)
𝑑𝑡
𝑟
(
𝑈(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
)
= 𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
+𝐾(𝑆𝑡, 𝑡) −𝜇𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
and finally we have
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
−𝑟𝑈(𝑆𝑡, 𝑡) + 𝐾(𝑆𝑡, 𝑡) = 0
or
𝐵𝑆[𝑈(𝑆𝑡, 𝑡)] + 𝐾(𝑆𝑡, 𝑡) = 0.
Assume that if 𝑈(𝑆𝑇, 𝑇) = 0 and 𝐾(𝑆𝑡, 𝑡) > 0 for 0 ≤𝑡< 𝑇then 𝑈(𝑆𝑡, 𝑡) ≤0 for 0 ≤𝑡<
𝑇. Let the portfolio be
̃Π𝑡= 𝑈(𝑆𝑡, 𝑡) ≤0
where the instantaneous change in the portfolio becomes
𝑑̃Π𝑡= 𝑑𝑈(𝑆𝑡, 𝑡) + 𝐾(𝑆𝑡, 𝑡)𝑑𝑡.
Taking integrals and because 𝑈(𝑆𝑇, 𝑇) = 0 and 𝐾(𝑆𝑡, 𝑡) > 0 for 0 ≤𝑡< 𝑇
̃Π𝑇−̃Π𝑡= 𝑈(𝑆𝑇, 𝑇) −𝑈(𝑆𝑡, 𝑡) + ∫
𝑇
𝑡
𝐾(𝑆𝑡, 𝑡)𝑑𝑡
̃Π𝑇= 𝑈(𝑆𝑇, 𝑇) + ∫
𝑇
𝑡
𝐾(𝑆𝑡, 𝑡)𝑑𝑡
= ∫
𝑇
𝑡
𝐾(𝑆𝑡, 𝑡)𝑑𝑡
> 0

252
2.2.4 The Greeks
which is a contradiction under the no-arbitrage condition. Therefore, 𝑈(𝑆𝑡, 𝑡) > 0 for 0 ≤
𝑡< 𝑇.
By comparing
𝐵𝑆[(𝑆𝑡, 𝑡)] + 𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) = 0,
(𝑆𝑇, 𝑇) = 0
and
𝐵𝑆[𝑈(𝑆𝑡, 𝑡)] + 𝐾(𝑆𝑡, 𝑡) = 0,
𝑈(𝑆𝑇, 𝑇) = 0
we can deduce that if 𝐾(𝑆𝑡, 𝑡) = 𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) > 0 then 𝑈(𝑆𝑡, 𝑡) = (𝑆𝑡, 𝑡) > 0 for 0 ≤𝑡<
𝑇. Hence, for any option price, if the gamma is always positive then it has a positive vega.
Let (𝑆𝑡, 𝑡) = 𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡) where ̃
𝐾(𝑆𝑡, 𝑡) = −𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡) and since 𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
satisfies
the Black–Scholes equation we have
𝐵𝑆[(𝑆𝑡, 𝑡)] = 𝐵𝑆[𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡)]
= 𝜕
𝜕𝑡[𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡)] + 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
[𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡)]
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
[𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡)] −𝑟[𝑔(𝑡) ̃
𝐾(𝑆𝑡, 𝑡)]
= 𝑑𝑔
𝑑𝑡
̃
𝐾(𝑆𝑡, 𝑡) + 𝑔(𝑡)𝐵𝑆[ ̃
𝐾(𝑆𝑡, 𝑡)]
= 𝑑𝑔
𝑑𝑡
̃
𝐾(𝑆𝑡, 𝑡).
Since 𝐵𝑆[(𝑆𝑡, 𝑡)] = ̃
𝐾(𝑆𝑡, 𝑡) then
𝑑𝑔
𝑑𝑡= 1
with boundary condition
𝑔(𝑇) = 1.
Solving the first-order differential equation we have
𝑔(𝑡) = −(𝑇−𝑡)
and hence
(𝑆𝑡, 𝑡) = −(𝑇−𝑡) ̃
𝐾(𝑆𝑡, 𝑡) = (𝑇−𝑡)𝜎𝑆2
𝑡Γ(𝑆𝑡, 𝑡).

2.2.4 The Greeks
253
19. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and at
time 𝑡let the asset price 𝑆𝑡follow a GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the asset price
volatility.
Let the European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfy the following PDE
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
and the European digital call option price 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfy
𝜕𝐶𝑑
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑑
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑑
𝜕𝑆𝑡
−𝑟𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝐶𝑑(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
{
1
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
where 𝑟is the risk-free interest rate, 𝐾is the strike price and 𝑇is the option expiry time.
Explain why, given
𝜕
𝜕𝑆𝑇
max{𝑆𝑇−𝐾, 0} =
{
1
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
we have 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≠Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) where Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜕𝐶
𝜕𝑆𝑡
.
Suppose ̂𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the price of another European call option with strike 𝐾and
expiry time 𝑇where in this case the risk-free interest rate is ̂𝑟, the continuous dividend
yield ̂𝐷and volatility 𝜎. By choosing appropriate ̂𝑟and ̂𝐷in terms of 𝑟, 𝐷and 𝜎show that
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) and ̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜕̂𝐶
𝜕𝑆𝑡
satisfy exactly the same Black–Scholes equa-
tion and payoff. Hence, deduce that
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑−=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.

254
2.2.4 The Greeks
Solution: From the Black–Scholes equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
and by differentiating with respect to 𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
)
= 0
or
𝜕
𝜕𝑡
(
𝜕𝐶
𝜕𝑆𝑡
)
+ 𝜎2𝑆𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
(
𝜕𝐶
𝜕𝑆𝑡
)
+(𝑟−𝐷) 𝜕𝐶
𝜕𝑆𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝜕𝐶
𝜕𝑆𝑡
)
−𝑟𝜕𝐶
𝜕𝑆𝑡
= 0.
By setting Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜕𝐶
𝜕𝑆𝑡
we have
𝜕Δ𝐶
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2Δ𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷+ 𝜎2)𝑆𝑡
𝜕Δ𝐶
𝜕𝑆𝑡
−𝐷Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
Δ𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
{
1
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
which is not the same problem that 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies. Hence, 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≠
Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇).
For the case ̂𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇), it satisfies
𝜕̂𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝐶
𝜕𝑆2
𝑡
+ (̂𝑟−̂𝐷)𝑆𝑡
𝜕̂𝐶
𝜕𝑆𝑡
−̂𝑟̂𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
̂𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
and its delta ̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜕̂𝐶
𝜕𝑆𝑡
satisfies
𝜕̂Δ𝐶
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2̂Δ𝐶
𝜕𝑆2
𝑡
+ (̂𝑟−̂𝐷+ 𝜎2)𝑆𝑡
𝜕̂Δ𝐶
𝜕𝑆𝑡
−̂𝐷̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
̂Δ𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) =
{
1
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾.

2.2.4 The Greeks
255
By comparing the PDEs and payoffs satisfied by 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) and ̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
in order for
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
we can set ̂𝐷= 𝑟and ̂𝑟−̂𝐷+ 𝜎2 = 𝑟−𝐷. Hence,
̂𝑟= 2𝑟−𝐷−𝜎2
and
̂𝐷= 𝑟.
Following Problem 2.2.4.2 (page 220) we have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ̂Δ𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
𝜕
𝜕𝑆𝑡
̂𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑒−̂𝐷(𝑇−𝑡)Φ( ̂𝑑+)
where ̂𝑑+ =
log(𝑆𝑡∕𝐾) + (̂𝑟−̂𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
By substituting ̂𝑟= 2𝑟−𝐷−𝜎2 and ̂𝐷= 𝑟we have
𝑒−̂𝐷(𝑇−𝑡) = 𝑒−𝑟(𝑇−𝑡)
and
̂𝑑+ =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
= 𝑑−.
Hence, 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).
20. Let {𝑊𝑡: 𝑡≥0} be the standard Wiener process on the probability space (Ω, ℱ, ℙ) where
at time 𝑡the stock price 𝑆𝑡follows the following diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
for constant drift 𝜇, continuous dividend yield 𝐷and volatility 𝜎. The risk-free interest
rate is a constant 𝑟and a derivative security written on this asset has price 𝑉(𝑆𝑡, 𝑡) with
payoff Ψ(𝑆𝑇) at expiry time 𝑇.
By defining the sensitivity of the option price with respect to the continuous dividend
yield
𝜑(𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝐷

256
2.2.4 The Greeks
show that
𝐵𝑆[𝜑(𝑆𝑡, 𝑡)] −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
= 0
with boundary condition 𝜑(𝑆𝑇, 𝑇) = 0 where 𝐵𝑆denotes the Black–Scholes differential
operator
𝐵𝑆= 𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟.
Deduce that
𝜑(𝑆𝑡, 𝑡) = −(𝑇−𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
and give a financial interpretation of this result.
Solution: Given that 𝑉(𝑆𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
and by differentiating the Black–Scholes equation with respect to 𝐷we have
𝜕
𝜕𝐷
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)
)
= 0
or
𝜕
𝜕𝑡
(𝜕𝑉
𝜕𝐷
)
+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
(𝜕𝑉
𝜕𝐷
)
−𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
(𝜕𝑉
𝜕𝐷
)
−𝑟𝜕𝑉
𝜕𝐷= 0.
By substituting 𝜑(𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝐷we have
𝜕𝜑
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜑
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜑
𝜕𝑆𝑡
−𝑟𝜑(𝑆𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
= 0
or in terms of the differential operator
𝐵𝑆[𝜑(𝑆𝑡, 𝑡)] −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
= 0
with boundary condition
𝜑(𝑆𝑇, 𝑇) = 𝜕
𝜕𝐷𝑉(𝑆𝑇, 𝑇) =
𝜕
𝜕𝐷Ψ(𝑆𝑇) = 0.

2.2.4 The Greeks
257
Let 𝜑(𝑆𝑡, 𝑡) = 𝑔(𝑡)𝑈(𝑆𝑡, 𝑡), where 𝑈(𝑆𝑡, 𝑡) = 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
. At expiry
𝜑(𝑆𝑇, 𝑇) = 𝑔(𝑇)𝑈(𝑆𝑇, 𝑇) = 𝑔(𝑇)𝑆𝑇
𝜕𝑉
𝜕𝑆𝑇
= 0.
Hence, 𝑔(𝑇) = 0.
In addition,
𝐵𝑆[𝜑(𝑆𝑡, 𝑡)] = 𝐵𝑆[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)]
= 𝜕
𝜕𝑡[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)] + 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)]
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
[𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)] −𝑟𝑔(𝑡)𝑈(𝑆𝑡, 𝑡)
= 𝑑𝑔
𝑑𝑡𝑈(𝑆𝑡, 𝑡) + 𝑔(𝑡)𝐵𝑆[𝑈(𝑆𝑡, 𝑡)]
= 𝑑𝑔
𝑑𝑡𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑔(𝑡)𝐵𝑆
[
𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
= 𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
.
Since 𝐵𝑆
[
𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
= 0 (see Problem 2.2.2.9, page 110) we have
𝑑𝑔
𝑑𝑡= 1.
Because 𝑔(𝑇) = 0 we have
𝑔(𝑡) = −(𝑇−𝑡)
and therefore
𝜑(𝑆𝑡, 𝑡) = −(𝑇−𝑡)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
.
By setting the option delta 𝜕𝑉
𝜕𝑆𝑡
= Δ𝑡we have
𝐵𝑆[𝜑(𝑆𝑡, 𝑡)] = Δ𝑡𝑆𝑡

258
2.2.4 The Greeks
which is equivalent to the number of shares needed to be bought or sold in a delta-hedging
portfolio. Furthermore, because
𝜑(𝑆𝑡, 𝑡) = −(𝑇−𝑡)Δ𝑡𝑆𝑡
then as the number of shares increases (decreases), the sensitivity of the option with
respect to the continuous dividend yield also decreases (increases). In addition, because
of the presence of the time to expiration 𝜏= 𝑇−𝑡, we can see that any change
in the dividend will have a bigger effect on longer-term options than shorter-term
options.
21. Let 𝑆𝑡be the price of an asset following a GBM process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility and
𝑊𝑡is the standard Wiener process on the probability space (Ω, ℱ, ℙ). Consider a digital (or
cash-or-nothing) put option written on 𝑆𝑡with strike 𝐾having a terminal payoff Ψ(𝑆𝑇) =
1I{𝑆𝑇<𝐾} at expiry time 𝑇> 𝑡.
By considering a hedging portfolio consisting of long 1∕𝜀European put option with
strike 𝐾+ 𝜀and short 1∕𝜀European put option with strike 𝐾, show that as 𝜀→0 the
digital put option 𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) is
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
where 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+) such that
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Hence, deduce that the asset-or-nothing put option 𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) with terminal payoff
Ψ(𝑆𝑇) = 𝑆𝑇1I{𝑆𝑇<𝐾} is
𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Solution: At time 𝑡the portfolio Π𝑡is worth
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾+ 𝜀, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜀
.

2.2.4 The Greeks
259
At expiry time 𝑇we have
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾+ 𝜀, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
𝜀
=
⎧
⎪
⎨
⎪⎩
1
𝜀(𝐾+ 𝜀−𝑆𝑇)
if 𝑆𝑇< 𝐾+ 𝜀
0
if 𝑆𝑇≥𝐾+ 𝜀
−
⎧
⎪
⎨
⎪⎩
1
𝜀(𝐾−𝑆𝑇)
if 𝑆𝑇< 𝐾
0
if 𝑆𝑇≥𝐾
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
1
if 𝑆𝑇< 𝐾
1
𝜀(𝐾−𝑆𝑇+ 𝜀)
if 𝐾≤𝑆𝑇< 𝐾+ 𝜀
0
if 𝑆𝑇≥𝐾+ 𝜀.
Taking limits and from L’Ĥopital’s rule
lim
𝜀→0,𝑆𝑇→𝐾
𝐾−𝑆𝑇+ 𝜀
𝜀
=
lim
𝜀→0,𝑆𝑇→𝐾
−1 + 1
1
= 0
therefore
lim
𝜀→0 Π𝑇=
{
1
if 𝑆𝑇< 𝐾
0
if 𝑆𝑇≥𝐾
= 1I{𝑆𝑇<𝐾}
which is equal to the payoff of a digital put option.
Hence, by discounting the payoff up to time 𝑡and using Taylor’s theorem we have
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = lim
𝜀→0
𝑃(𝑆𝑡, 𝑡; 𝐾+ 𝜀, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜀
= lim
𝜀→0
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
𝜀−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + (𝜀2)
𝜀
= 𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
+ lim
𝜀→0 (𝜀)
= 𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
.

260
2.2.4 The Greeks
From Problem 2.2.2.21 (page 139) the closed-form solution for an asset-or-nothing put
option price is
𝑃𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑1)
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑2) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐾𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐾𝜕𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
−𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇).
N.B. By setting up a portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾.𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾+ 𝜀, 𝑇)
𝜀
we can also show that the digital call option price is
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = −𝜕𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
and the asset-or-nothing call option price is
𝐶𝑎(𝑆𝑡, 𝑡; 𝐾, 𝑇) = −𝐾𝜕𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝜕𝐾
+ 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−).
22. Boyle–Emanuel Method. Let 𝑉(𝑆𝑡, 𝑡) denote the derivative security at time 𝑡on an asset
𝑆𝑡where 𝑆𝑡follows a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the asset volatility
and 𝑊𝑡is the standard Wiener process on the probability space (Ω, ℱ, ℙ). Assume that
𝑉(𝑆𝑡, 𝑡) satisfies the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
with payoff 𝑉(𝑆𝑇, 𝑇) = Ψ(𝑆𝑇) at expiry time 𝑇, 𝑡< 𝑇and 𝑟is the risk-free interest rate.
Consider a trader setting up a hedging portfolio at time 𝑡
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ(𝑆𝑡, 𝑡)𝑆𝑡
where Δ(𝑆𝑡, 𝑡) = 𝜕𝑉
𝜕𝑆𝑡
is the delta of 𝑉(𝑆𝑡, 𝑡). The portfolio is left unhedged for a
small time 𝛿𝑡> 0. By ignoring higher terms of ((𝛿𝑡)
3
2 ) show that the hedging error

2.2.4 The Greeks
261
(or return on the hedge) is
𝜀𝑡= (Π𝑡+𝛿𝑡−Π𝑡) −𝑟Π𝑡𝛿𝑡
≈1
2𝜎2𝑆2
𝑡Γ(𝑆𝑡, 𝑡)(𝑍2 −1)𝛿𝑡
where Γ(𝑆𝑡, 𝑡) = 𝜕2𝑉
𝜕𝑆2
𝑡
and 𝑍2 ∼𝜒2(1).
Find the expectation and variance of 𝜀𝑡given 𝑆𝑡. Interpret the results financially if 𝑉(𝑆𝑡, 𝑡)
is a European option and the market behaviour over the time between rehedges is volatile.
Solution: At time 𝑡the portfolio is worth
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ(𝑆𝑡, 𝑡)𝑆𝑡
and given that the portfolio is unhedged at time 𝑡+ 𝛿𝑡, and because the asset pays a con-
tinuous dividend yield 𝐷, we therefore have
Π𝑡+𝛿𝑡= 𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) −Δ(𝑆𝑡, 𝑡)(𝑆𝑡+𝛿𝑡+ 𝐷𝑆𝑡𝛿𝑡).
In addition, since
𝛿Π𝑡= Π𝑡+𝛿𝑡−Π𝑡
and under the no-arbitrage condition
𝛿Π𝑡= 𝑟Π𝑡𝛿𝑡
the hedging error 𝜀𝑡is
𝜀𝑡= (Π𝑡+𝛿𝑡−Π𝑡) −𝑟Π𝑡𝛿𝑡
= 𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) −Δ(𝑆𝑡, 𝑡)(𝑆𝑡+𝛿𝑡+ 𝐷𝑆𝑡𝛿𝑡) −𝑉(𝑆𝑡, 𝑡) + Δ(𝑆𝑡, 𝑡)𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡)𝛿𝑡+ 𝑟Δ(𝑆𝑡, 𝑡)𝑆𝑡𝛿𝑡
= 𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) −𝑉(𝑆𝑡, 𝑡) −𝑟𝑉(𝑆𝑡, 𝑡)𝛿𝑡+ (𝑟−𝐷)Δ(𝑆𝑡, 𝑡)𝑆𝑡𝛿𝑡
−Δ(𝑆𝑡, 𝑡)𝛿𝑆𝑡
where 𝛿𝑆𝑡= 𝑆𝑡+𝛿𝑡−𝑆𝑡.
From Taylor’s theorem
𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) = 𝑉(𝑆𝑡, 𝑡) + 𝜕𝑉
𝜕𝑆𝑡
𝛿𝑆𝑡+ 𝜕𝑉
𝜕𝑡𝛿𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝛿𝑆𝑡)2 + 1
2
𝜕2𝑉
𝜕𝑡2 (𝛿𝑡)2
+ 𝜕2𝑉
𝜕𝑆𝑡𝜕𝑡(𝛿𝑆𝑡𝛿𝑡) + …

262
2.2.4 The Greeks
and by substituting 𝛿𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝛿𝑡+ 𝜎𝑆𝑡
√
𝛿𝑡𝑍where 𝑍∼(0, 1) and Δ(𝑆𝑡, 𝑡) =
𝜕𝑉
𝜕𝑆𝑡
we have
𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) = 𝑉(𝑆𝑡, 𝑡) + Δ(𝑆𝑡, 𝑡)𝛿𝑆𝑡+ 𝜕𝑉
𝜕𝑡𝛿𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝑍2𝛿𝑡+ ((𝛿𝑡)
3
2 )
where 𝑍2 ∼𝜒(1).
Substituting the result of 𝑉(𝑆𝑡+𝛿𝑡, 𝑡+ 𝛿𝑡) and by neglecting higher orders of (𝛿𝑡
3
2 ) we
have
𝜀𝑡≈
[𝜕𝑉
𝜕𝑡+ (𝑟−𝐷)Δ(𝑆𝑡, 𝑡)𝑆𝑡−𝑟𝑉(𝑆𝑡, 𝑡)
]
𝛿𝑡+ 1
2𝜎2𝑆2
𝑡𝑍2𝛿𝑡
= 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑍2 −1)𝛿𝑡
= 1
2𝜎2𝑆2
𝑡Γ(𝑆𝑡, 𝑡)(𝑍2 −1)𝛿𝑡
since 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0.
Given 𝑆𝑡, the expectation and variance of 𝜀𝑡are
𝔼(𝜀𝑡|𝑆𝑡) ≈0
and
Var(𝜀𝑡|𝑆𝑡) ≈1
2
{𝜎2𝑆2
𝑡Γ(𝑆𝑡, 𝑡)𝛿𝑡}2
since 𝔼(𝑍2) = 1 and Var(𝑍2) = 2.
Finally, if 𝑉(𝑆𝑡, 𝑡) is a European option then Γ(𝑆𝑡, 𝑡) > 0 (see Problem 2.2.4.3, page
221). Given that the market behaviour is volatile, Var(𝜀𝑡|𝑆𝑡) would increase since 𝜎
increases in value. Hence, 𝑉(𝑆𝑡, 𝑡) would also increase in value as the option price
increases with volatility. Then the hedge portfolio would also rise because of the increase
in the variance estimate of the hedging error.
23. At time 𝑡a contract was written to sell 100 units of “strip” consisting of one European
call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and two European put options 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) written on a non-
dividend-paying stock 𝑆𝑡with the same strike 𝐾and time to expiry 𝑇−𝑡= 270 days,
where 𝑇is the expiry time. The writer delta-hedged the contract at time 𝑡and since then has
not rebalanced the portfolio. At time 𝜏(𝑡< 𝜏) the writer decided to close out the position
with the information given in Table 2.4.
Table 2.4
European option prices and deltas.
Time
𝑡
𝜏
Stock Price
$60
$65
Call Price
$6.4884
$7.3351
Put Price
$13.9466
$10.4433
Call Option Delta
0.4565
Put Option Delta
−0.5435
By assuming the risk-free interest rate 𝑟as a constant value, calculate the profit of the
writer at time 𝜏.

2.2.4 The Greeks
263
Solution: At time 𝑡we denote one unit of short strip as
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices written
on 𝑆𝑡with the same strike 𝐾and expiry time 𝑇(𝑡< 𝑇). Let the portfolio consist of short
one unit of 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) and long Δ𝑡units of stock 𝑆𝑡so that
Π𝑡= −𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) + Δ𝑡𝑆𝑡.
By differentiating the portfolio Π𝑡with respect to 𝑆𝑡
𝜕Π𝑡
𝜕𝑆𝑡
= −𝜕𝑉
𝜕𝑆𝑡
+ Δ𝑡
and for the portfolio to be delta neutral we set 𝜕Π𝑡
𝜕𝑆𝑡
= 0 and hence
Δ𝑡= 𝜕𝑉
𝜕𝑆𝑡
= 𝜕𝐶
𝜕𝑆𝑡
+ 2 𝜕𝑃
𝜕𝑆𝑡
= 0.4565 −2 × 0.5435
= −0.6305.
In order to replicate the option payoff 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) we let
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = Δ𝑡𝑆𝑡+ Ψ𝑡
where Ψ𝑡is the amount of cash invested in a risk-free money market. Hence,
Ψ𝑡= 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) −Δ𝑡𝑆𝑡
= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 2𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) −Δ𝑡𝑆𝑡
= 6.4884 + 2 × 13.9466 + 0.6305 × 60
= 72.2116.
Thus, to maintain a delta-hedged portfolio the writer needs to invest 100 × 72.2116 =
$7,221.16 into the money market and sell 100 × 0.6304 = 63.04 units of 𝑆𝑡= $60.
In order to calculate the interest earned between time 𝑡and 𝜏, from the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
𝐶(𝑆𝜏, 𝜏; 𝐾, 𝑇) −𝑃(𝑆𝜏, 𝜏; 𝐾, 𝑇) = 𝑆𝜏−𝐾𝑒−𝑟(𝑇−𝜏)
and by substituting 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = $6.4884, 𝐶(𝑆𝜏, 𝜏; 𝐾, 𝑇) = $7.3351, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
$13.9466, 𝑃(𝑆𝜏, 𝜏; 𝐾, 𝑇) = $10.4433, 𝑆𝑡= $60 and 𝑆𝜏= $65 we have
𝐾𝑒−𝑟(𝑇−𝑡) = $67.4582
and
𝐾𝑒−𝑟(𝑇−𝜏) = $68.1082

264
2.2.4 The Greeks
such that
𝑒𝑟(𝜏−𝑡) = 68.1082
67.4582.
Hence,
Gains on “strip” sold = 100 × [6.4884 + 2 × 13.9466 −7.3351
−2 × 10.4432]
= $615.99
Gains on share price purchased = −100 × 0.6305 × (65 −60)
= −$315.25
Interest earned = 7,221.16 × (𝑒𝑟(𝜏−𝑡) −1)
= 7,221.16
(68.1082
67.4582 −1
)
= $69.58
so that
Total profit at time 𝜏= 615.99 −315.25 + 69.58 = $370.32.
24. At time 𝑡an investor has sold 1000 units of 33-strike call option on a non-dividend-paying
stock 𝑆𝑡. From the information given in Table 2.5, calculate how many units of 35-strike
call and stock the investor should buy/sell in order to maintain a delta and gamma-neutral
portfolio.
Table 2.5
European call option Greek values
for different strikes.
33-Strike Call
35-Strike Call
Delta
0.6986
0.5217
Gamma
0.07584
0.06245
Solution: Let 𝐾1 = 33 and 𝐾2 = 35 denote the strike prices for 33-strike call
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 35-strike call 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) option prices, respectively, where 𝑇is
the option expiry time.
Let the portfolios be constructed as follows:
Π(1)
𝑡
= −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + Δ(1)
𝑡𝑆𝑡
Π(2)
𝑡
= 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −Δ(2)
𝑡𝑆𝑡
where Δ(1)
𝑡
and Δ(2)
𝑡
are the number of shares needed to be bought/sold for each of the
portfolios Π(1)
𝑡
and Π(2)
𝑡, respectively.

2.2.4 The Greeks
265
In order to maintain gamma neutrality using 35-strike calls, we let the combined port-
folios be
Π𝑡= 𝑛1Π(1)
𝑡
+ 𝑛2Π(2)
𝑡
where 𝑛1 and 𝑛2 are the numbers of 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) options needed to
set the gamma of the portfolio Π𝑡to zero. By differentiating Π𝑡twice with respect to 𝑆𝑡
we have
𝜕2Π𝑡
𝜕𝑆2
𝑡
= −𝑛1
𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑛2
𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
and by setting 𝜕2Π𝑡
𝜕𝑆2
𝑡
= 0
−𝑛1
𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝑛2
𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = 0.
Given 𝑛1 = 1000, 𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾1) = 0.07584 and 𝜕2𝐶
𝜕𝑆2
𝑡
(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = 0.06245, we have
𝑛2 = 1214.4115. Thus, to ensure that portfolio Π𝑡is gamma neutral the investor needs to
buy 1214.4115 units of 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
Finally, to delta-neutralise portfolio Π𝑡we note that
𝜕Π𝑡
𝜕𝑆𝑡
= 𝑛1
𝜕Π(1)
𝑡
𝜕𝑆𝑡
+ 𝑛2
𝜕Π(2)
𝑡
𝜕𝑆𝑡
= 𝑛1
[
−𝜕𝐶
𝜕𝑆𝑡
(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + Δ(1)
𝑡
]
+ 𝑛2
[
𝜕𝐶
𝜕𝑆𝑡
(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −Δ(2)
𝑡
]
= 0
or
𝑛1Δ(1)
𝑡
−𝑛2Δ(2)
𝑡
= 𝑛1
𝜕𝐶
𝜕𝑆𝑡
(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝑛2
𝜕𝐶
𝜕𝑆𝑡
(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
= 1000 × 0.6986 −1214.4115 × 0.5217
= 65.04152.
Hence, in order to delta-hedge the portfolio the investor needs to buy 65.04152 shares of
𝑆𝑡.


3
American Options
In the previous chapter we concentrated solely on European options, but in most exchange-
traded options nearly all stock and equity options are American options whilst stock indices
are mainly European options. For a European option, the option price is only dependent on
the underlying asset price at expiry and is independent of the path that the underlying asset
price follows over the life of the option. Hence, the payoff is path independent and it fol-
lows that the discounted expected value of the payoff is also path independent. In contrast,
an American option gives the holder of the contract the right but not the obligation to enter
into a future transaction at any time until the expiry date of the contract. Therefore, American
options belong to path-dependent options since they depend on the path of the underlying asset
price prior to the option’s expiry time. Given that investors have the freedom to exercise their
American options any time during the life of the contract, naturally they are more expensive
than European options which can only be exercised at expiry.
3.1
INTRODUCTION
As an American option value is greater than its equivalent European counterpart, it does not
satisfy the same problem specification as the European option. Hence, the American option
cannot satisfy the Black–Scholes equation. However, both have the same value at the option
expiry time.
By setting 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) to be the American call and put option
prices, respectively whilst 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put
option prices, respectively with 𝑆𝑡being the common dividend-paying stock price at time 𝑡,
𝑇> 𝑡being the option’s expiry time, 𝐷being the continuous dividend yield, 𝐾being the com-
mon strike and 𝑟being the risk-free interest rate, we have the following properties for the call
options
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡
and for the put options
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾.
For European options, the put–call parity is
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
whilst for American options, the put–call parity is
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾≤𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).

268
3.1 INTRODUCTION
Conceptually, the pricing formulations for the American option can be framed as follows:
s optimal stopping time formulation
s free boundary formulation
s linear complementarity formulation.
Optimal Stopping Time Formulation
Consider an American option with terminal payoff Ψ(𝑆𝑇) where 𝑇is the option expiry
time and suppose the option is exercised at time 𝑢≤𝑇. Under the risk-neutral measure ℚ,
conditional on the filtration ℱ𝑡, the discounted price of the option at time 𝑡≤𝑢with payoff at
time 𝑢is given by
𝔼ℚ[
𝑒−𝑟(𝑢−𝑡)Ψ(𝑆𝑢)||| ℱ𝑡
]
where 𝔼ℚdenotes the expectation under the risk-neutral measure ℚ, and under which the stock
𝑆𝑡follows the diffusion process
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊ℚ
𝑡
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the stock volatility
and 𝑊ℚ
𝑡
is a ℚ-standard Wiener process.
As the holder of the American option can exercise at any time during the life of the option
contract, the American option price at time 𝑡≤𝑢≤𝑇is
𝑉(𝑆𝑡, 𝑡) = sup
𝑡≤𝑢≤𝑇
𝔼ℚ[
𝑒−𝑟(𝑢−𝑡)Ψ(𝑆𝑢)||| ℱ𝑡
]
where the supremum is taken over all possible stopping times 𝑢. The supremum is reached at
the optimal stopping time 𝜏such that
𝜏= inf
𝑢
{𝑡≤𝑢≤𝑇: 𝑉(𝑆𝑢, 𝑢) = Ψ(𝑆𝑢)} .
Note that the optimal stopping time problem is useful for theoretical arguments when formu-
lating the problem via a probabilistic approach. However, it is impractical when it comes to
numerical computation, except for special types of American options like immediate-touch
options.
Free Boundary Formulation
The Black–Scholes equation which is satisfied by European options is no longer valid where
early exercise is permitted. As the American option gives its holder much more flexibility
over when to exercise it, it therefore has a higher value. When early exercise is permitted, the
American option satisfies the Black–Scholes inequality
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) ≤0

3.1 INTRODUCTION
269
with constraints
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡),
𝑉(𝑆𝑇, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑡) is the intrinsic value of the American option payoff at time 𝑡.
Thus, the problem of finding the option price value is known as a free boundary problem
since the optimal exercise price is not known a priori. To decide when to exercise rather than
holding the option, there are two criteria to adhere to:
s The option price can never be worth less than its intrinsic value; otherwise there will be
an arbitrage opportunity.
s The holder of the option must exercise so as to give the option its maximum value.
At the optimal exercise boundary 𝑆∞
𝑡
the following hold:
s The option price and the intrinsic function must be continuous as functions of the stock
price, 𝑆𝑡.
s The sensitivity of the option price with respect to the stock price, 𝜕𝑉
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∞
𝑡
is contin-
uous as a function of the stock price, 𝑆𝑡. This condition is known as the smooth pasting
condition.
When trying to understand the local behaviour of American options, the free boundary for-
mulation is an extremely useful tool. However, it is not a very practical method, since with
the presence of free boundaries they have to be determined via expensive numerical strategies
which are non-trivial.
Linear Complementarity Formulation
From the free boundary problem, the American option price 𝑉(𝑆𝑡, 𝑡) can be formulated further
as a linear complementarity problem. In general, by writing 𝐵𝑆to denote the Black–Scholes
operator
𝐵𝑆= 𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟
the linear complementarity formulation to determine the American option 𝑉(𝑆𝑡, 𝑡) is given as
𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] ≤0,
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡),
[𝑉(𝑆𝑡, 𝑡) −Ψ(𝑆𝑡)] ⋅𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] = 0
such that
𝑉(𝑆𝑇, 𝑇) = Ψ(𝑆𝑇)
and
𝜕𝑉
𝜕𝑆𝑡
is continuous in 𝑆𝑡.

270
3.1 INTRODUCTION
There are several advantages to this formulation:
s The formulation does not explicitly contain a free boundary.
s The formulation is independent of the number of free boundaries.
s The free boundary is recovered from the solution.
s The problem can be solved numerically, such as using finite-difference approximations or
numerical optimisation. However, for high-dimensional (multi-asset) American options,
the numerical scheme is impractical. An alternative is to use the least-squares Monte
Carlo method.
Binomial Option Pricing
The binomial formula can also be modified to evaluate American options. Like its European
counterparts, the binomial formula for American options also consists of a lattice representing
the movements of the stock price where the option is priced by working backwards through
the lattice. For the case of American options, since there is a possibility of early exercise, at
each node we take the maximum of the value of the option if it is held to expiration and the
gain that could be realised with immediate exercise.
Thus, for an American call the value of the option at a node is given by
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max {𝑆𝑡−𝐾,
𝑒−𝑟Δ𝑡[𝜋𝐶𝑎𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝐶𝑎𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]}
and for an American put it is given by
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = max {𝐾−𝑆𝑡,
𝑒−𝑟Δ𝑡[𝜋𝑃𝑎𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝑃𝑎𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]}
where 𝑆𝑡is the stock price at time 𝑡(equivalent to a node in a tree), 𝑟is the risk-free interest
rate, 𝐾is the strike price, 𝑇> 𝑡is the option expiry time, Δ𝑡is the binomial time step, 𝜋
and 1 −𝜋are the risk-neutral probabilities for the increase and decrease in the stock price,
respectively.
In contrast, for the case of Bermudan options, since early exercise is only allowed on
predetermined dates, the value of a Bermudan call option, 𝐶𝑏𝑒𝑟𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) at a node
becomes
𝐶𝑏𝑒𝑟𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
max {𝑆𝑡−𝐾,
early exercise
𝑒−𝑟Δ𝑡[𝜋𝐶𝑏𝑒𝑟𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝐶𝑏𝑒𝑟𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]}
is allowed
𝑒−𝑟Δ𝑡[𝜋𝐶𝑏𝑒𝑟𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝐶𝑏𝑒𝑟𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]
early exercise
is not allowed

3.2.1 Basic Properties
271
and the corresponding value of a Bermudan put option, 𝑃𝑏𝑒𝑟𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) is
𝑃𝑏𝑒𝑟𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
max {𝐾−𝑆𝑡,
early exercise
𝑒−𝑟Δ𝑡[𝜋𝑃𝑏𝑒𝑟𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝑃𝑏𝑒𝑟𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]}
is allowed
𝑒−𝑟Δ𝑡[𝜋𝑃𝑏𝑒𝑟𝑚(𝑢𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇) + (1 −𝜋)𝑃𝑏𝑒𝑟𝑚(𝑑𝑆𝑡, 𝑡+ Δ𝑡; 𝐾, 𝑇)]
early exercise
is not allowed.
3.2
PROBLEMS AND SOLUTIONS
3.2.1
Basic Properties
1. Consider the American and European call options with prices 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the dividend-paying asset price at time 𝑡< 𝑇,
𝑇is the expiry time of the options and 𝐾is the common strike price. Show that
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
where 𝐷is the continuous dividend yield.
Solution: Assume 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) for all 𝑡. Therefore, at time 𝑡we can
set up a portfolio with long one American call and short one European call options
Π𝑡= 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Assume at time 𝜏, 𝑡≤𝜏≤𝑇, that the American call option is exercised, giving a payoff
𝑆𝜏−𝐾> 0
and by exercising the American call option it gives us
Net profit at time 𝜏= 𝑆𝜏−𝐾−𝐶𝑎𝑚(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) > 0.
At expiry time 𝑇, and because we are holding the asset now worth 𝑆𝑇(bought at strike
price 𝐾at time 𝜏), then irrespective of whether the holder of the European call option
exercises the option or not
Net profit at time 𝑇=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝐾
if 𝑆𝑇> 𝐾
0
if 𝑆𝑇≤𝐾
≥0.
Hence, we always have a guaranteed positive return for the case when 𝑆𝑡> 𝐾, which
implies the existence of an arbitrage opportunity.

272
3.2.1 Basic Properties
In contrast, if the American call option is not exercised then at terminal time 𝑇
Π𝑇= 𝐶𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0.
Hence,
we
also
have
an
arbitrage
opportunity.
Therefore,
we
conclude
that
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
For the case 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡)) we assume
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
and set up the following portfolio at time 𝑡
Π𝑡= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡)) −𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Assume at time 𝜏, 𝑡≤𝜏≤𝑇, that the American call option is exercised with payoff
𝑆𝜏−𝐾> 0.
Thus, the value of the portfolio at time 𝜏is
Π𝜏= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑆𝜏(1 −𝑒−𝐷(𝑇−𝜏)) −(𝑆𝜏−𝐾)
= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) −𝑆𝜏𝑒−𝐷(𝑇−𝜏) + 𝐾
≥𝑆𝜏−𝐾−𝑆𝜏𝑒−𝐷(𝑇−𝜏) + 𝐾
= 𝑆𝜏(1 −𝑒−𝐷(𝑇−𝜏))
> 0
which is an arbitrage opportunity.
In addition, if the American call option is not exercised then at terminal time 𝑇, the
portfolio is now worth
Π𝑇= 𝐶𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0
which is also an arbitrage opportunity. Hence, 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −
𝑒−𝐷(𝑇−𝑡)).
2. Consider the American and European call options with prices 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the dividend-paying asset price at time 𝑡< 𝑇,
𝑇is the expiry time of the options and 𝐾is the common strike price. Show that
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)

3.2.1 Basic Properties
273
where 𝛿1, 𝛿2, … , 𝛿𝑛is a sequence of discrete dividends paid at time 𝑡1, 𝑡2, … , 𝑡𝑛, respec-
tively where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇.
Solution: For the proof of the inequality 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) see Problem
3.2.1.1 (page 271).
For the case 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + ∑𝑛
𝑖=1 𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) we assume
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
and set up the following portfolio at time 𝑡,
Π𝑡= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Assume at time 𝜏, 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑘−1 < 𝜏< 𝑡𝑘< 𝑡𝑘+1 < ⋯< 𝑡𝑛< 𝑇, that the Amer-
ican call option is exercised by the owner with payoff
𝑆𝜏−𝐾> 0.
Thus the value of the portfolio at time 𝜏is
Π𝜏= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) +
𝑛
∑
𝑖=𝑘
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝜏) −(𝑆𝜏−𝐾)
= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) +
𝑛
∑
𝑖=𝑘
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝜏) −𝑆𝜏+ 𝐾
≥𝑆𝜏−𝐾+
𝑛
∑
𝑖=𝑘
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝜏) −𝑆𝜏+ 𝐾
=
𝑛
∑
𝑖=𝑘
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝜏)
> 0
which is an arbitrage opportunity.
In addition, if the American call option is not exercised then at terminal time 𝑇, the
portfolio is now worth
Π𝑇= 𝐶𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0
which is also an arbitrage opportunity. Hence, 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
∑𝑛
𝑖=1 𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡).

274
3.2.1 Basic Properties
3. Consider the American and European call options with prices 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the expiry time
of the options and 𝐾is the common strike price. Let 𝑟be the risk-free interest rate. Show
that if the stock does not pay dividends, then it is never optimal to exercise an American
call option before expiry, i.e.
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
but this is not true for an American put option.
Solution: Given that 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}, the price of a European call
option is always greater than the intrinsic value of an American call option. Therefore, it
is inadvisable to exercise the American call option early since there is no incentive to hold
onto the stock which pays no dividends, and hence 𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
By delaying the exercise of an American call option until expiry time, the holder will
gain interest on the strike. However, by delaying the exercise of an American put option
the holder would lose the interest gained on the strike.
N.B. Note that by setting the continuous dividend yield or discrete dividends to zero,
from Problems 3.2.1.1 and 3.2.1.2 (see pages 271–273) we have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
or
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
4. Consider the American and European put options with prices 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the expiry time
of the options, 𝐾is the common strike price and 𝑟is the constant risk-free interest rate.
Show that
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡)).
Solution: Assume that 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) for all 𝑡. Therefore, at time 𝑡we
can set up a portfolio with long one American put and short one European put options,
Π𝑡= 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Assume at time 𝜏, 𝑡≤𝜏≤𝑇, that the American put option is exercised giving a payoff
𝐾−𝑆𝜏> 0.
Thus, by exercising the American put option it gives us
Net profit at time 𝜏= 𝐾−𝑆𝜏−𝑃𝑎𝑚(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑃𝑏𝑠(𝑆𝜏, 𝑡; 𝐾, 𝑇) > 0
and we can invest 𝐾in the bank that will give us 𝐾𝑒𝑟(𝑇−𝜏) at time 𝑇.

3.2.1 Basic Properties
275
At expiry time 𝑇, and because we are holding 𝐾𝑒𝑟(𝑇−𝜏) worth of cash, then irrespec-
tive of whether the holder of the European put option exercises the option or not, we are
always guaranteed to have a positive return 𝐾𝑒𝑟(𝑇−𝜏) −𝐾≥0 which implies an arbitrage
opportunity. Therefore, 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
In contrast, if the American put option is not exercised then at terminal time 𝑇
Π𝑇= 𝑃𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝐾−𝑆𝑇, 0} −max{𝐾−𝑆𝑇, 0}
= 0.
Hence, we also have an arbitrage opportunity. Therefore, we can conclude that
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
For the case 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡)) we assume
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡))
and set up the following portfolio at time 𝑡
Π𝑡= 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡)) −𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Assume at time 𝜏, 𝑡≤𝜏≤𝑇, that the American put option is exercised with the payoff
𝐾−𝑆𝜏
where 𝐾> 𝑆𝜏. Thus, the value of the portfolio at time 𝜏is
Π𝜏= 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝜏)) −(𝐾−𝑆𝜏)
= 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝜏) + 𝑆𝜏
≥𝐾−𝑆𝜏−𝐾𝑒−𝑟(𝑇−𝜏) + 𝑆𝜏
= 𝐾(1 −𝑒−𝑟(𝑇−𝜏))
> 0
which is an arbitrage opportunity.
In addition, if the American put option is not exercised then at terminal time 𝑇, the
portfolio is now worth
Π𝑇= 𝑃𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= max{𝐾−𝑆𝑇, 0} −max{𝐾−𝑆𝑇, 0}
= 0
which is also an arbitrage opportunity. Hence, 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −
𝑒−𝑟(𝑇−𝑡)).

276
3.2.1 Basic Properties
5. Consider the American and European put options with prices 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is a dividend-paying asset price at time 𝑡< 𝑇, 𝑇is
the expiry time of the options and 𝐾is the common strike price. Show that in the absence
of a risk-free interest rate, 𝑟= 0 it is never optimal to exercise an American put option
before expiry time, i.e.
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
but this is not the case for an American call option.
Solution: Since 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0}, which is the intrinsic value of an
American put option, and if 𝑟= 0 then by exercising the option early there is no finan-
cial gain in holding 𝐾in the money market. Therefore, it is never optimal to exercise an
American put option before expiry time.
By delaying the exercise of an American put option until expiry time, the holder will
gain dividend on the stock. However, by delaying the exercise of an American call option
the holder would lose dividend gained on the stock.
N.B. Note that by setting the interest rate to zero, from Problem 3.2.1.4 (see page 274)
we have
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
or
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
6. Consider an American call option with price 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝑆𝑡is the spot price at
time 𝑡< 𝑇, 𝑇is the expiry date of the option and 𝐾is the strike price. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
Solution: We assume 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝑆𝑡−𝐾, 0} and at time 𝑡we set up the follow-
ing portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −max{𝑆𝑡−𝐾, 0} < 0
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −max{𝑆𝑇−𝐾, 0}
= max{𝑆𝑇−𝐾, 0} −max{𝑆𝑇−𝐾, 0}
= 0
which is an arbitrage opportunity. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
N.B. We can also prove the following. Assume 𝑆𝑡> 𝐾and let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 𝑆𝑡−𝐾.
Because 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 an investor can then buy the option at time 𝑡and exercise
it immediately, leading to a profit 𝑆𝑡−𝐾> 0. The net profit is therefore 𝑆𝑡−𝐾−

3.2.1 Basic Properties
277
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 0, which in turn provides an arbitrage opportunity to the investor. Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
7. Let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American call option where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry time of the option and 𝐾is the strike price. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡.
Solution: Assume that 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝑆𝑡and hence at time 𝑡we can sell an American
call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and buy a stock 𝑆𝑡, giving us a profit of 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑆𝑡> 0.
Given that we own the stock, we can always cover the delivery of the stock should the
option be exercised by the holder at any time until time 𝑇. Therefore, we are always guar-
anteed to have a positive return max{𝑆𝑡−𝐾, 0} ≥0 which implies an arbitrage opportu-
nity. Therefore, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡.
8. For a non-dividend-paying asset, let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American call option
where 𝑆𝑡is the asset price at time 𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike
price and 𝑟is a constant interest rate. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡), 0}.
Solution: From the put–call parity for European options
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
≥𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
since 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
Because 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we therefore have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
Since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0, then 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡), 0}.
9. Let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American call option where 𝑆𝑡is the asset price at
time 𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike price and 𝑟is a constant
interest rate. Assume that the asset pays a continuous dividend yield 𝐷. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}.

278
3.2.1 Basic Properties
Solution: From the put–call parity for European options
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
since 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
Because 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we therefore have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡).
Since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0, then 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}.
10. Let 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American call option where 𝑆𝑡is the asset price at
time 𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike price and 𝑟is a constant
interest rate. Assume that the asset pays a sequence of discrete dividends 𝛿𝑖at time 𝑡𝑖,
𝑖= 1, 2, … , 𝑛where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0
}
.
Solution: From the put–call parity for European options
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
≥𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
since 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.

3.2.1 Basic Properties
279
Because 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we therefore have
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡).
Since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0, then
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0
}
.
11. Consider an American call option with price 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝑆𝑡is the spot price at
time 𝑡< 𝑇, 𝑇is the expiry time of the option and 𝐾is the strike price. By assuming the
stock does not pay dividends, should the holder of an American call option exercise the
option if 𝑆𝑡> 𝐾whilst believing that the future stock price will go below 𝐾?
Solution: If the option is sold at time 𝑡then
Net profit = Profit of option sold −Cost of option bought
= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 0.
On the contrary, if the holder does nothing at time 𝑡then
Net profit = −Cost of option bought = −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 0.
Since
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0} = 𝑆𝑡−𝐾
and if the option is exercised at time 𝑡then
Net profit = Payoff at time 𝑡−Cost of option bought
= 𝑆𝑡−𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
≤0.
Therefore, the holder should sell the option rather than exercise it.
12. Consider an American put option with price 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) where 𝑆𝑡is the spot price at
time 𝑡< 𝑇, 𝑇is the expiry time of the option and 𝐾is the strike price. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0}.

280
3.2.1 Basic Properties
Solution: We assume 𝐾> 𝑆𝑡and let
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) < 𝐾−𝑆𝑡.
Because 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 an investor can buy a put option at time 𝑡and exercise
it immediately, leading to a profit 𝐾−𝑆𝑡> 0. The net profit is therefore 𝐾−𝑆𝑡−
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 0, which in turn provides an arbitrage opportunity to the investor. Hence,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0}.
13. Let 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American put option where 𝑆𝑡is the spot price at time
𝑡< 𝑇, 𝑇is the expiry time of the option and 𝐾is the strike price. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾.
Solution: Assume 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) > 𝐾and hence at time 𝑡we can sell an American put
option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) and deposit the money in the bank, earning a risk-free interest rate
𝑟which will give us at least 𝐾𝑒𝑟(𝜏−𝑡) for 𝑡≤𝜏≤𝑇. Given that we own the cash, we can
always cover the purchase of the stock for the price of 𝐾, should the option be exercised
by the holder at any time until time 𝑇. Therefore, we are always guaranteed to have a
positive return max{𝐾−𝑆𝑡, 0} ≥0, which implies an arbitrage opportunity. Therefore,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐾.
14. For a non-dividend-paying asset, let 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American put option
where 𝑆𝑡is the asset price at time 𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike
price and 𝑟is a constant interest rate. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡, 0}.
Solution: From the put–call parity for European options
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then have
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡
≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
Because 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we have
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡.
Since 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 therefore 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡, 0}.

3.2.1 Basic Properties
281
15. Let 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American put option where 𝑆𝑡is the asset price at time
𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike price and 𝑟is a constant interest
rate. Assume that 𝑆𝑡pays a continuous dividend yield 𝐷. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}.
Solution: From the put–call parity for European options we have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then express
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.
Because 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we have
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡).
Since 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 therefore 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}.
16. Let 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American put option where 𝑆𝑡is the asset price at time
𝑡< 𝑇, 𝑇is the expiry time of the option, 𝐾is the strike price and 𝑟is a constant interest
rate. Assume that the asset pays a sequence of discrete dividends 𝛿𝑖at time 𝑡𝑖, 𝑖= 1, 2, … , 𝑛
where 𝑡< 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛< 𝑇. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡), 0
}
.
Solution: From the put–call parity for European options we have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices at
time 𝑡written on 𝑆𝑡with common strike 𝐾and expiry time 𝑇> 𝑡.
We then have
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0.

282
3.2.1 Basic Properties
Because 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) we have
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡).
Since 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥0 therefore
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max
{
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡), 0
}
.
17. Put–Call Parity I. Consider the American call and put options with prices 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the expiry
time of the options, 𝐾is the common strike price and 𝑟is a constant risk-free interest rate.
Show that
𝑆𝑡−𝐾≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
Solution: Since 𝑆𝑡does not pay any dividends, then
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European call option price written on 𝑆𝑡at time 𝑡with strike
price 𝐾and option expiry 𝑇.
In addition, from Problem 3.2.1.4 (page 274) we have
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡))
where 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the European put option price written on 𝑆𝑡at time 𝑡with strike
price 𝐾and option expiry 𝑇.
Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡) −𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡−𝐾
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−𝐾−𝑟(𝑇−𝑡).

3.2.1 Basic Properties
283
In contrast, using the put–call parity for European options again
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
18. Put–Call Parity II. Consider the American call and put options with prices 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the spot price at time 𝑡< 𝑇which pays a con-
tinuous dividend yield 𝐷, 𝑇is the expiry time of the options, 𝐾is the common strike price
and 𝑟is a constant risk-free interest rate. Show that
𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
Solution: From Problems 3.2.1.1 and 3.2.1.4 (pages 271–274) we have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡))
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices,
respectively written on 𝑆𝑡at time 𝑡with strike price 𝐾and option expiry 𝑇.
Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) −𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾−𝑟(𝑇−𝑡).
In contrast, using the put–call parity for European options again
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
−𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡) + 𝑆𝑡(1 −𝑒−𝐷(𝑇−𝑡))
= 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
19. Put–Call Parity III. Consider the American call and put options with prices 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇), respectively where 𝑆𝑡is the spot price at time 𝑡< 𝑇which pays a
sequence of discrete dividends 𝛿1, 𝛿2, … , 𝛿𝑛at times 𝑡1, 𝑡2, … , 𝑡𝑛, respectively, 𝑡< 𝑡1 <

284
3.2.1 Basic Properties
𝑡2 < ⋯< 𝑡𝑛< 𝑇, 𝑇is the expiry time of the options, 𝐾is the common strike price and 𝑟
is a constant risk-free interest rate. Show that
𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
Solution: From Problems 3.2.1.2 and 3.2.1.4 (pages 272–274) we have
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐾(1 −𝑒−𝑟(𝑇−𝑡))
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European call and put option prices,
respectively written on 𝑆𝑡at time 𝑡with strike price 𝐾and option expiry 𝑇.
Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾−𝑟(𝑇−𝑡)
−𝐾(1 −𝑒−𝑟(𝑇−𝑡))
= 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾
since 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡−∑𝑛
𝑖=1 𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾−𝑟(𝑇−𝑡).
In contrast, using the put–call parity for European options again
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
−𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
= 𝑆𝑡−
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡) −𝐾−𝑟(𝑇−𝑡) +
𝑛
∑
𝑖=1
𝛿𝑖𝑒−𝑟(𝑡𝑖−𝑡)
= 𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡).
20. Given that the continuously compounded risk-free interest rate is 2% per annum, what
is the greatest lower bound of a 3-month American put option on a non-dividend-paying
stock currently worth $10 with strike price $15?

3.2.1 Basic Properties
285
Solution: Let 𝑆0 = 10, 𝐾= 15, 𝑇= 3
12 = 0.25 years, 𝑟= 0.02, and let 𝑃(𝑆0, 0; 𝐾, 𝑇)
denote the American put option at time 𝑡= 0. As
𝑃(𝑆0, 0; 𝐾, 𝑇) ≥max{𝐾−𝑆0, 0}
the greatest lower bound is then given by
𝑃(𝑆0, 0; 𝐾, 𝑇) ≥max{15 −10, 0} = $5.
21. Given that the continuously compounded risk-free interest rate is 5% per annum, what is
the greatest lower bound of a 6-month American call option on a non-dividend-paying
stock currently worth $20 with strike price $15?
Solution: Let 𝑆0 = 20, 𝐾= 15, 𝑇= 6
12 = 0.5 years, 𝑟= 0.05, and let 𝐶(𝑆0, 0; 𝐾, 𝑇)
denote the American call option at time 𝑡= 0. As
𝐶(𝑆0, 0; 𝐾, 𝑇) ≥max{𝑆0 −𝐾𝑒−𝑟𝑇, 0}
the greatest lower bound is given by
𝐶(𝑆0, 0; 𝐾, 𝑇) ≥max{20 −15 × 𝑒−0.05×0.5, 0} = $5.37.
22. Suppose that a trader holds an American call option on a non-dividend-paying stock with
strike price $100 with expiry time 6 months from now. The continuously compounded
interest rate is 5% and the current stock price is $110.
(a) What happens if the trader exercises the call option now?
(b) Does the trader have an advantage if he exercises the option at expiry time?
(c) What would be the trader’s strategy if he knew the stock price was going to fall?
Solution: Let the current time 𝑡= 0 so that 𝑆0 = 110, 𝑇= 6
12 = 0.5, 𝑟= 0.05 and 𝐾=
100.
(a) By exercising at time 𝑡= 0, the trader would pay $100 to own a stock which is worth
$110. If the trader sells the stock, he would make an instant profit of $110 −$100 =
$10.
(b) By delaying exercising the option, the trader can deposit $100 in a bank earning a
risk-free interest rate 𝑟= 5% which, in 6 months’ time, will be worth 100 × 𝑒0.05×0.5 =
$102.53.
At time 𝑇, if 𝑆𝑇> 100 the trader can exercise the call and pay $100 to own the stock.
Therefore, he makes an extra profit of $2.53 compared with exercising the option now.
In contrast, if 𝑆𝑇≤100 the trader would not exercise the option and would have
$102.53 in the bank. Had the trader exercised the option at time 𝑡= 0, he would own
stock worth 110 and, by selling the stock and putting the proceeds in the bank, it will
grow to $110 × 𝑒0.05×0.5 = $112.78 in 6 months’ time. Thus, if the trader only exer-
cises the option at the expiry time and if 𝑆𝑇≤100 then he will be making a loss of
$112.78 −$102.53 = $10.25.

286
3.2.1 Basic Properties
(c) If the trader exercises the call option now, he will pay $100 for the stock and can sell
it for $110 and deposit the profit of $10 in the bank. At time 𝑇= 0.5 the trader will
earn $10 × 𝑒0.05×0.5 = $10.25.
Conversely, if he waits until expiry time, he can short sell the stock now and deposit
$110 in the bank, thus earning $110 × 𝑒0.05×0.5 = $112.78 in 6 months’ time. To cover
his short-selling activity he can exercise the call option at expiry time by paying $100
for 𝑆𝑇. Thus, he makes a profit of $12.78, which is more than the $10.25 if he exercised
immediately.
23. Consider an American put option on a non-dividend-paying stock with strike price $12
with expiry time 8 months from now. The current stock price is $10 and the continuously
compounded interest rate is 5% per annum. Given that the price of the American put option
is $2.50, calculate the range of values for the corresponding American call option with the
same strike price and expiry time.
Solution: Let the current time be 𝑡= 0, so that 𝑆0 = 10, 𝑇= 8
12 = 2
3 years, 𝑟= 0.05
and 𝐾= 12. By denoting 𝑃(𝑆0, 0; 𝐾, 𝑇) = 2.50 as the price of an American put option
then, from the put–call parity, the corresponding American call option 𝐶(𝑆0, 0; 𝐾, 𝑇)
satisfies
𝑃(𝑆0, 0; 𝐾, 𝑇) + 𝑆0 −𝐾≤𝐶(𝑆0, 0; 𝐾, 𝑇) ≤𝑃(𝑆0, 0; 𝐾, 𝑇) + 𝑆0 −𝐾𝑒−𝑟𝑇.
Thus,
2.5 + 10 −12 ≤𝐶(𝑆0, 0; 𝐾, 𝑇) ≤2.5 + 10 −12 × 𝑒−0.05× 2
3
or
$0.50 ≤𝐶(𝑆0, 0; 𝐾, 𝑇) ≤$0.89.
24. Consider two identical American call options 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) and 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) having
expiry times 𝑇1 and 𝑇2 with 𝑇1 < 𝑇2, 𝑆𝑡is the spot price at time 𝑡and 𝐾is the common
strike price. Show that
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.
Solution: We assume 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) > 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) where at time 𝑡we can set up a
portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2) −𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) < 0.

3.2.1 Basic Properties
287
At time 𝑇1, the portfolio is now worth
Π𝑇1 = 𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −max{𝑆𝑇1 −𝐾, 0}
=
⎧
⎪
⎨
⎪⎩
𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2)
if 𝑆𝑇1 ≤𝐾
𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −𝑆𝑇1 + 𝐾
if 𝑆𝑇1 > 𝐾.
Since 𝐶(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) ≥𝑆𝑇1 −𝐾then Π𝑇1 ≥0, which is a contradiction.
Therefore,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.
25. Consider two identical American put options 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) and 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) having
expiry times 𝑇1 and 𝑇2 with 𝑇1 < 𝑇2, 𝑆𝑡is the spot price at time 𝑡and 𝐾is the common
strike price. Show that
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.
Solution: We assume 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) > 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) where at time 𝑡we can set up a
portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2) −𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) < 0.
At time 𝑇1, the portfolio is now worth
Π𝑇1 = 𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −max{𝐾−𝑆𝑇1, 0}
=
⎧
⎪
⎨
⎪⎩
𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2)
if 𝑆𝑇1 ≥𝐾
𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) −𝐾+ 𝑆𝑇1
if 𝑆𝑇1 < 𝐾.
Since 𝑃(𝑆𝑇1, 𝑇1; 𝐾, 𝑇2) ≥𝐾−𝑆𝑇1 then Π𝑇1 ≥0, which is a contradiction.
Therefore,
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇1) ≤𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇2)
for 𝑇1 < 𝑇2.

288
3.2.1 Basic Properties
26. Consider two identical American call options 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having
strike prices 𝐾1 and 𝐾2 with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Show that
0 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.
Solution: We first assume 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) where at time 𝑡we can set up
a portfolio
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= max{𝑆𝑇−𝐾1, 0} −max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤𝐾1
𝑆𝑇−𝐾1
if 𝐾1 < 𝑆𝑇≤𝐾2
𝐾2 −𝐾1
if 𝑆𝑇> 𝐾2.
Hence, Π𝑇≥0 which is a contradiction.
We next assume 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) > 𝐾2 −𝐾1 where at time 𝑡we set up
the following portfolio
Π𝑡= 𝐾2 −𝐾1 −𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) + 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐾2 −𝐾1 −𝐶(𝑆𝑇, 𝑇; 𝐾1, 𝑇) + 𝐶(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
= 𝐾2 −𝐾1 −max{𝑆𝑇−𝐾1, 0} + max{𝑆𝑇−𝐾2, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇≤𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 < 𝑆𝑇≤𝐾2
0
if 𝑆𝑇> 𝐾2.
Hence, Π𝑇≥0 which is also a contradiction.
Therefore,
0 ≤𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.

3.2.1 Basic Properties
289
27. Consider two identical American put options 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) and 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) having
strike prices 𝐾1 and 𝐾2 with 𝐾1 < 𝐾2, 𝑆𝑡is the spot price at time 𝑡and 𝑇> 𝑡is the expiry
time. Show that
0 ≤𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.
Solution: We first assume 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) where at time 𝑡we can set up
a portfolio
Π𝑡= 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) −𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= max{𝐾2 −𝑆𝑇, 0} −max{𝐾1 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝐾2 −𝐾1
if 𝑆𝑇< 𝐾1
𝐾2 −𝑆𝑇
if 𝐾1 ≤𝑆𝑇< 𝐾2
0
if 𝑆𝑇≥𝐾2.
Hence, Π𝑇≥0 which is a contradiction.
We next assume 𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) > 𝐾2 −𝐾1 where at time 𝑡we set up
the following portfolio
Π𝑡= 𝐾2 −𝐾1 −𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) + 𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 0.
At expiry time 𝑇
Π𝑇= 𝐾2 −𝐾1 −𝑃(𝑆𝑇, 𝑇; 𝐾2, 𝑇) + 𝑃(𝑆𝑇, 𝑇; 𝐾1, 𝑇)
= 𝐾2 −𝐾1 −max{𝐾2 −𝑆𝑇, 0} + max{𝐾1 −𝑆𝑇, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇< 𝐾1
𝑆𝑇−𝐾1
if 𝐾1 ≤𝑆𝑇< 𝐾2
𝐾2 −𝐾1
if 𝑆𝑇≥𝐾2.
Hence, Π𝑇≥0 which is also a contradiction.
Therefore,
0 ≤𝑃(𝑆𝑡, 𝑡; 𝐾2, 𝑇) −𝑃(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≤𝐾2 −𝐾1
for 𝐾1 < 𝐾2.

290
3.2.1 Basic Properties
28. Let the prices of two American call options with strikes $50 and $60 be $2.50 and $3.00,
respectively where both options have the same time to expiry.
(a) Is the no-arbitrage condition violated?
(b) Suggest a spread position so that the portfolio will ensure an arbitrage opportunity.
Solution: We assume the options are priced at time 𝑡with spot price 𝑆𝑡and we let
𝐾1 = $50, 𝐾2 = $60 and 𝑇> 𝑡is the expiry time so that 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) = $2.50 and
𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) = $3.00.
(a) Since 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) < 𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) for 𝐾1 < 𝐾2, this violates the condition
𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) ≥𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
(b) We let the portfolio at time 𝑡be
Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) < 0
where at time 𝑇the portfolio will be worth
Π𝑇= max{𝑆𝑇−50, 0} −max{𝑆𝑇−60, 0}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
0
if 𝑆𝑇≤50
𝑆𝑇−50
if 50 < 𝑆𝑇≤60
10
if 𝑆𝑇> 60.
Thus, Π𝑇≥0 which shows that the portfolio Π𝑡= 𝐶(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶(𝑆𝑡, 𝑡; 𝐾2, 𝑇) pro-
vides an arbitrage opportunity.
29. At time 𝑡we consider an American put option on a non-dividend-paying stock 𝑆𝑡with
strike price 𝐾> 𝑆𝑡and 𝑟is the risk-free interest rate. The stock price is forecast to fall in
value where at the expiry time 𝑇, 𝑆𝑇< 𝑆𝑡. Is it advisable to exercise the option early? If
the stock pays a dividend 𝛿> 0 at intermediate time 𝜏, 𝑡< 𝜏< 𝑇, should we exercise the
option early?
Solution: If the option is exercised early at time 𝑡, the payoff is
Ψ(𝑆𝑡) = max{𝐾−𝑆𝑡, 0} = 𝐾−𝑆𝑡.
If the option is exercised at expiry time 𝑇, the payoff is
Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0} = 𝐾−𝑆𝑇.
Hence, the present value of the payoff at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡< 𝐾−𝑆𝑡.
Therefore, it is advisable to exercise early if the stock price is forecast to fall in value.

3.2.1 Basic Properties
291
If the stock pays a dividend at time 𝜏then the present value of the payoff at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡) −(𝑆𝑡−𝛿𝑒−𝑟(𝜏−𝑡)) = 𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+ 𝛿𝑒−𝑟(𝜏−𝑡).
Thus, early exercise is advisable if
𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡+ 𝛿𝑒−𝑟(𝜏−𝑡) < 𝐾−𝑆𝑡
or
𝛿𝑒−𝑟(𝜏−𝑡) < 𝐾(1 −𝑒−𝑟(𝑇−𝑡)).
30. Consider an investor holding one American call option and one European call option on
the same non-dividend-paying stock with strike price 𝐾= $50. The price of the American
call option is $5 with time to expiry 8 months, whilst the European call option is priced at
$7 with time to expiry 6 months. The continuously compounded risk-free interest rate is
𝑟= 5%. Show that the investor can construct an arbitrage portfolio.
Solution: At time 𝑡= 0 with spot price 𝑆0 we denote the price of an American call
option by
𝐶𝑎𝑚(𝑆0, 0; 𝐾, 𝑇1) = $5
for 𝑇1 = 8
12 = 2
3 years
and the European call option price by
𝐶𝑏𝑠(𝑆0, 0; 𝐾, 𝑇2) = $7
for 𝑇2 = 6
12 = 1
2 years.
We first set up a portfolio at time 𝑡= 0
Π0 = 𝐶𝑎𝑚(𝑆0, 0; 𝐾, 𝑇1) −𝐶𝑏𝑠(𝑆0, 0; 𝐾, 𝑇2) < 0.
At time 𝑡= 𝑇2 we have
Π𝑇2 = 𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1) −𝐶𝑏𝑠(𝑆𝑇2, 𝑇2; 𝐾, 𝑇2)
= 𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1) −max{𝑆𝑇2 −𝐾, 0}
=
⎧
⎪
⎨
⎪⎩
𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1)
if 𝑆𝑇2 ≤𝐾
𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1) −𝑆𝑇2 + 𝐾
if 𝑆𝑇2 > 𝐾
≥
⎧
⎪
⎨
⎪⎩
𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1)
if 𝑆𝑇2 ≤𝐾
𝐾(1 −𝑒−𝑟(𝑇1−𝑇2))
if 𝑆𝑇2 > 𝐾

292
3.2.2 Time-Independent Options
since 𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1) ≥𝑆𝑇2 −𝐾𝑒−𝑟(𝑇1−𝑇2). Further, because 𝐶𝑎𝑚(𝑆𝑇2, 𝑇2; 𝐾, 𝑇1) ≥0,
then Π𝑇2 > 0 which constitutes an arbitrage opportunity.
3.2.2
Time-Independent Options
1. Generalised Perpetual American Option. Consider an economy which consists of a risk-
free asset and a stock, whose values at time 𝑡are 𝐵𝑡and 𝑆𝑡, respectively. Assume that these
values evolve according to the following diffusion processes
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡,
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝐷is the continuous dividend yield, 𝑟is the risk-free rate, 𝜇is the stock price growth
rate and 𝜎𝑡> 0 is the stock price volatility. In addition, {𝑊𝑡: 0 ≤𝑡≤𝑇} is the ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ) and ℱ𝑡, 0 ≤𝑡≤𝑇is the filtration gen-
erated by the standard Wiener process.
Show that a perpetual American option 𝑉(𝑆𝑡) (which has not yet been exercised) satis-
fies the following second-order ODE
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
−𝑟𝑉(𝑆𝑡) = 0.
Show also that the general solution of the above equation is
𝑉(𝑆𝑡) = 𝐴𝑆𝛼+
𝑡
+ 𝐵𝑆𝛼−
𝑡
where 𝐴and 𝐵are unknown constants, 𝛼+ > 0 and 𝛼−< 0.
Solution: We consider a perpetual American option with an arbitrary payoff and because
it is time independent we can denote the option price at time 𝑡as 𝑉(𝑆𝑡).
By setting a Δ-hedged portfolio
Π𝑡= 𝑉(𝑆𝑡) −Δ𝑆𝑡
and because during time 𝑑𝑡the stock pays out a continuous dividend 𝐷𝑆𝑡𝑑𝑡we have
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡).
By Taylor’s expansion and subsequently using It̄o’s lemma we can write
𝑑𝑉= 𝑑𝑉
𝑑𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝑑2𝑉
𝑑𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
3!
𝑑3𝑉
𝑑𝑆3
𝑡
(𝑑𝑆𝑡)3 + ⋯
= 𝑑𝑉
𝑑𝑆𝑡
[(𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑑𝑊𝑡
] + 1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
𝑑𝑡
=
[
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
]
𝑑𝑡+ 𝜎𝑑𝑉
𝑑𝑆𝑡
𝑑𝑊𝑡

3.2.2 Time-Independent Options
293
and
𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡= 𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
By substituting the above expressions into 𝑑Π𝑡we have
𝑑Π𝑡=
[
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
−Δ𝜇𝑆𝑡
]
𝑑𝑡+ 𝜎
[
𝑑𝑉
𝑑𝑆𝑡
−Δ
]
𝑑𝑊𝑡.
To eliminate risk we set
Δ = 𝑑𝑉
𝑑𝑆𝑡
and hence
𝑑Π𝑡=
[
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
−𝐷𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
]
𝑑𝑡.
Given that there is no time limit to exercise the option, to avoid arbitrage we set
𝑑Π𝑡= 𝑟Π𝑑𝑡
or
[
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
−𝐷𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
]
𝑑𝑡= 𝑟
[
𝑉(𝑆𝑡) −𝑑𝑉
𝑑𝑆𝑡
𝑆𝑡
]
𝑑𝑡.
Hence,
1
2𝜎2𝑆2
𝑡
𝑑2𝑉
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝑉
𝑑𝑆𝑡
−𝑟𝑉(𝑆𝑡) = 0.
To solve the second-order ODE we look for solutions of the form
𝑉(𝑆𝑡) = 𝐶𝑆𝑚
𝑡
where 𝐶is a constant. By substituting
𝑉(𝑆𝑡) = 𝐶𝑆𝑚
𝑡,
𝑑𝑉
𝑑𝑆𝑡
= 𝑚𝐶𝑆𝑚−1
𝑡
,
𝑑2𝑉
𝑑𝑆2
𝑡
= 𝑚(𝑚−1)𝐶𝑆𝑚−2
𝑡
into the ODE we have
1
2𝜎2𝑚(𝑚−1) + (𝑟−𝐷)𝑚−𝑟= 0

294
3.2.2 Time-Independent Options
or
1
2𝜎2𝑚2 +
(
𝑟−𝐷−1
2𝜎2)
𝑚−𝑟= 0.
Hence,
𝑚=
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.
Since
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟> (𝑟−𝐷−1
2𝜎2)
the solution of the ODE must be of the form
𝑉(𝑆𝑡) = 𝐴𝑆𝛼+
𝑡
+ 𝐵𝑆𝛼−
𝑡
where 𝐴and 𝐵are unknown constants,
𝛼+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
> 0
and
𝛼−=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
< 0.
2. Perpetual American Call Option. By definition a perpetual American call option gives the
holder the right but not the obligation to buy an underlying asset (where the current price
at time 𝑡is 𝑆𝑡) for a specified strike price 𝐾at any time in the future with no expiry time.
Assume that the price of the perpetual American call option 𝐶(𝑆𝑡) satisfies
1
2𝜎2𝑆2
𝑡
𝑑2𝐶
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝐶
𝑑𝑆𝑡
−𝑟𝐶(𝑆𝑡) = 0,
0 < 𝑆𝑡< 𝑆∞
with boundary conditions
𝐶(0) = 0,
𝐶(𝑆∞) = 𝑆∞−𝐾
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the constant
volatility and 𝑆∞> 𝐾denotes the unknown optimal exercise boundary such that for 𝑆𝑡≥
𝑆∞the option should be exercised whilst for 𝑆𝑡< 𝑆∞the option should be held.

3.2.2 Time-Independent Options
295
Show that
𝐶(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
(𝑆∞−𝐾)
( 𝑆𝑡
𝑆∞
)𝛼+
if 𝑆𝑡< 𝑆∞
𝑆𝑡−𝐾
if 𝑆𝑡≥𝑆∞
where
𝛼+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
> 0.
Hence, show that the optimal exercise boundary is
𝑆∞= 𝛼+𝐾
𝛼+ −1
and that for this optimal value the “smooth-pasting” condition
Δ = 𝑑𝐶
𝑑𝑆𝑡
||||𝑆𝑡=𝑆∞= 1
is satisfied.
Deduce that if 𝐷= 0, it is not optimal to exercise the perpetual American call option.
Solution: Given that 𝑆∞> 𝐾is the optimal exercise boundary then, for 𝑆𝑡≥𝑆∞, we can
deduce that the perpetual American call option is equal to its intrinsic value, that is
𝐶(𝑆𝑡) = 𝑆𝑡−𝐾,
𝑆𝑡≥𝑆∞.
For 𝑆𝑡< 𝑆∞, 𝐶(𝑆𝑡) satisfies the second-order ODE and from Problem 3.2.2.1 (page 292)
the general solution is
𝐶(𝑆𝑡) = 𝐴𝑆𝛼+
𝑡
+ 𝐵𝑆𝛼−
𝑡
where 𝐴and 𝐵are unknown constants,
𝛼+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
> 0
and
𝛼−=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
< 0.

296
3.2.2 Time-Independent Options
From the initial conditions, for 𝑆𝑡→0, 𝐶(𝑆𝑡) →0 and because 𝛼−< 0 we can set 𝐵= 0.
Thus,
𝐶(𝑆𝑡) = 𝐴𝑆𝛼+
𝑡.
Because 𝑆∞> 𝐾therefore 𝐶(𝑆∞) = 𝑆∞−𝐾. By continuity
𝐴(𝑆∞)𝛼+ = 𝑆∞−𝐾
or
𝐴= (𝑆∞−𝐾)
( 1
𝑆∞
)𝛼+ .
Therefore, for 𝑆𝑡< 𝑆∞
𝐶(𝑆𝑡) = (𝑆∞−𝐾)
( 𝑆𝑡
𝑆∞
)𝛼+
.
In order to find the optimal exercise boundary we differentiate 𝐶(𝑆𝑡) with respect to 𝑆∞
𝑑𝐶
𝑑𝑆∞=
( 𝑆𝑡
𝑆∞
)𝛼+
−
( 𝑆𝑡
𝑆∞
)𝛼+ [𝛼+(𝑆∞−𝐾)
𝑆∞
]
=
( 𝑆𝑡
𝑆∞
)𝛼+ [
1 −𝛼+(𝑆∞−𝐾)
𝑆∞
]
and by setting 𝑑𝐶
𝑑𝑆∞= 0 we have
𝑆∞= 𝛼+𝐾
𝛼+ −1.
By differentiating 𝑑𝐶
𝑑𝑆∞once again with respect to 𝑆∞
𝑑2𝐶
𝑑(𝑆∞)2 = −𝛼+
𝑆∞
( 𝑆𝑡
𝑆∞
)𝛼+ [
1 −𝛼+(𝑆∞−𝐾)
𝑆∞
]
−
( 𝑆𝑡
𝑆∞
)𝛼+ 𝛼+𝐾
(𝑆∞)2
and by substituting 𝑆∞= 𝛼+𝐾
𝛼+ −1 we have
𝑑2𝐶
𝑑(𝑆∞)2
||||𝑆∞= 𝛼+𝐾
𝛼+−1
< 0.
Hence, 𝑆∞= 𝛼+𝐾
𝛼+ −1 is a local maximum point.

3.2.2 Time-Independent Options
297
For 𝑆𝑡< 𝑆∞, 𝐶(𝑆𝑡) = (𝑆∞−𝐾)
( 𝑆𝑡
𝑆∞
)𝛼+
and by differentiating 𝐶(𝑆𝑡) with respect
to 𝑆𝑡
𝑑𝐶
𝑑𝑆𝑡
= 𝛼+(𝑆∞−𝐾)
𝑆∞
( 𝑆𝑡
𝑆∞
)𝛼+−1
.
By taking limits
lim
𝑆𝑡→(𝑆∞)−
𝑑𝐶
𝑑𝑆𝑡
= 𝛼+(𝑆∞−𝐾)
𝑆∞
=
𝛼+
( 𝛼+𝐾
𝛼+ −1 −𝐾
)
𝛼+𝐾
𝛼+ −1
= 1.
For 𝑆𝑡≥𝑆∞, 𝐶(𝑆𝑡) = 𝑆𝑡−𝐾and by differentiating 𝐶(𝑆𝑡) with respect to 𝑆𝑡we have
𝑑𝐶
𝑑𝑆𝑡
= 1
or
lim
𝑆𝑡→(𝑆∞)+
𝑑𝐶
𝑑𝑆𝑡
= 1.
Since
lim
𝑆𝑡→(𝑆∞)−
𝑑𝐶
𝑑𝑆𝑡
=
lim
𝑆𝑡→(𝑆∞)+
𝑑𝐶
𝑑𝑆𝑡
= 1
therefore the “smooth-pasting” condition Δ = 𝑑𝐶
𝑑𝑆𝑡
||||𝑆𝑡=𝑆∞= 1 is satisfied.
If 𝐷= 0 then
𝛼+ = 1
𝜎2
[
−
(
𝑟−1
2𝜎2)
+
√(
𝑟−1
2𝜎2
)
+ 2𝑟𝜎2
]
= 1
𝜎2
[
−
(
𝑟−1
2𝜎2)
+
√(
𝑟−1
2𝜎2
)2]
= 1.

298
3.2.2 Time-Independent Options
Hence,
lim
𝐷→0 𝑆∞= lim
𝛼→1
𝛼+𝐾
𝛼+ −1 = ∞
which implies it is never optimal to exercise the perpetual American call when 𝐷= 0.
3. Perpetual American Put Option. By definition a perpetual American put option gives the
holder the right but not the obligation to sell an underlying asset (where the current price
at time 𝑡is 𝑆𝑡) for a specified strike price 𝐾at any time in the future with no expiry time.
Assume that the price of the perpetual American put option 𝑃(𝑆𝑡) satisfies
1
2𝜎2𝑆2
𝑡
𝑑2𝑃
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝑃
𝑑𝑆𝑡
−𝑟𝑃(𝑆𝑡) = 0,
𝑆𝑡> 𝑆∗
with boundary conditions
𝑃(∞) = 0,
𝑃(𝑆∗) = 𝐾−𝑆∗
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the constant
volatility and 𝑆∗< 𝐾denotes the unknown optimal exercise boundary such that for 𝑆𝑡≤
𝑆∗the option should be exercised whilst for 𝑆𝑡> 𝑆∗the option should be held.
Show that
𝑃(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑡
if 𝑆𝑡≤𝑆∗
(𝐾−𝑆∗)
( 𝑆𝑡
𝑆∗
)𝛼−
if 𝑆𝑡> 𝑆∗
where
𝛼−=
−
(
𝑟−𝐷−1
2𝜎2)
−
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
< 0.
Hence, show that the optimal exercise boundary is
𝑆∗= 𝛼−𝐾
𝛼−−1
and for this optimal value the “smooth-pasting” condition
Δ = 𝑑𝑃
𝑑𝑆𝑡
||||𝑆𝑡=𝑆∗= −1
is satisfied.
Deduce that if 𝑟= 0 then it is not optimal to exercise the perpetual put option.

3.2.2 Time-Independent Options
299
Solution: Given that 𝑆∗< 𝐾is the optimal exercise boundary then, for 𝑆𝑡≤𝑆∗, the per-
petual American put option can be deduced to be equal to its intrinsic value, that is
𝑃(𝑆𝑡) = 𝐾−𝑆𝑡,
𝑆𝑡< 𝑆∗.
For 𝑆𝑡> 𝑆∗, 𝑃(𝑆𝑡) satisfies the second-order ODE and from Problem 3.2.2.1 (page 292)
the general solution is
𝑃(𝑆𝑡) = 𝐴𝑆𝛼+
𝑡
+ 𝐵𝑆𝛼−
𝑡
where 𝐴and 𝐵are unknown constants,
𝛼+ =
−
(
𝑟−𝐷−1
2𝜎2)
+
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
> 0
and
𝛼−=
−
(
𝑟−𝐷−1
2𝜎2)
−
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
< 0.
From the initial conditions, for 𝑆𝑡→∞, 𝑃(𝑆𝑡) →0 and because 𝛼+ > 0 we can set 𝐴= 0.
Thus,
𝑃(𝑆𝑡) = 𝐵𝑆𝛼−
𝑡.
Because 𝑃(𝑆∗) = 𝐾−𝑆∗by continuity
𝐵(𝑆∗)𝛼−= 𝐾−𝑆∗
or
𝐵= (𝐾−𝑆∗)
( 1
𝑆∗
)𝛼−.
Therefore, for 𝑆𝑡> 𝑆∗
𝑃(𝑆𝑡) = (𝐾−𝑆∗)
( 𝑆𝑡
𝑆∗
)𝛼−
.
To find the optimal exercise boundary we differentiate 𝑃(𝑆𝑡) with respect to 𝑆∗
𝑑𝑃
𝑑𝑆∗= −
( 𝑆𝑡
𝑆∗
)𝛼−
−𝛼−(𝐾−𝑆∗)
𝑆∗
( 𝑆𝑡
𝑆∗
)𝛼−
= −
( 𝑆𝑡
𝑆∗
)𝛼−[
1 + 𝛼−(𝐾−𝑆∗)
𝑆∗
]

300
3.2.2 Time-Independent Options
and by setting 𝑑𝑃
𝑑𝑆∗= 0 we have
𝑆∗= 𝛼−𝐾
𝛼−−1.
By differentiating 𝑑𝑃
𝑑𝑆∗once again with respect to 𝑆∗
𝑑2𝑃
𝑑(𝑆∗)2 = 𝛼−
𝑆∗
( 𝑆𝑡
𝑆∗
)𝛼−[
1 + 𝛼−(𝐾−𝑆∗)
𝑆∗
]
+
( 𝑆𝑡
𝑆∗
)𝛼−𝛼−𝐾
(𝑆∗)2
and by substituting 𝑆∗= 𝛼−𝐾
𝛼−−1 we have
𝑑2𝑃
𝑑(𝑆∗)2
||||𝑆∗= 𝛼−𝐾
𝛼−−1
< 0.
Hence, 𝑆∗= 𝛼−𝐾
𝛼−−1 is a local maximum point.
For 𝑆𝑡> 𝑆∗, 𝑃(𝑆𝑡) = (𝐾−𝑆∗)
( 𝑆𝑡
𝑆∗
)𝛼−
and by differentiating 𝑃(𝑆𝑡) with respect to
𝑆𝑡
𝑑𝑃
𝑑𝑆𝑡
= 𝛼−(𝐾−𝑆∗)
𝑆∗
( 𝑆𝑡
𝑆∗
)𝛼−−1
.
By taking limits 𝑆𝑡→(𝑆∗)+
lim
𝑆𝑡→(𝑆∗)+
𝑑𝑃
𝑑𝑆𝑡
=
𝛼−
(
𝐾−𝛼−𝐾
𝛼−−1
)
𝛼−𝐾
𝛼−−1
= −1.
For 𝑆𝑡≤𝑆∗, 𝑃(𝑆𝑡) = 𝐾−𝑆𝑡and by differentiating 𝑃(𝑆𝑡) with respect to 𝑆𝑡we have
𝑑𝑃
𝑑𝑆𝑡
= −1
and by taking limits
lim
𝑆𝑡→(𝑆∗)−
𝑑𝑃
𝑑𝑆𝑡
= −1.

3.2.2 Time-Independent Options
301
Since
lim
𝑆𝑡→(𝑆∗)−
𝑑𝑃
𝑑𝑆𝑡
=
lim
𝑆𝑡→(𝑆∗)+
𝑑𝑃
𝑑𝑆𝑡
= −1 therefore the “smooth-pasting” condition Δ =
𝑑𝑃
𝑑𝑆𝑡
||||𝑆𝑡=𝑆∗= −1 is satisfied.
If 𝑟= 0 then
𝛼−=
𝐷+ 1
2𝜎2 −
√(
𝐷+ 1
2𝜎2
)2
𝜎2
= 0.
Therefore, the optimal exercise boundary 𝑆∗becomes
lim
𝑟→0 𝑆∗= lim
𝑟→0
𝛼−𝐾
𝛼−−1
= 0.
Hence, if the risk-free interest rate is zero then it is not optimal to exercise the perpetual
put option.
4. Let (Ω, ℱ, ℙ) be a probability space and let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process
on the probability space (Ω, ℱ, ℙ). Suppose at time 𝑡that the stock price 𝑆𝑡follows the
GBM process with the following SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
and a risk-free asset 𝐵𝑡follows
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝜇is the drift rate, 𝐷is the continuous dividend yield, 𝜎is the asset price volatility
and 𝑟is the risk-free interest rate.
For a constant 𝜆show that 𝑋𝑡= 𝑒𝜆𝑊𝑡−1
2 𝜆2𝑡is a martingale.
By setting 𝑇= min{𝑡≥0 : 𝑊𝑡= 𝑎+ 𝑏𝑡} as the first-passage time of hitting the slope
line 𝑎+ 𝑏𝑡where 𝑎and 𝑏are constants, using the optimal stopping theorem show that the
Laplace transform of its distribution is given by
𝔼(𝑒−𝜃𝑇) = 𝑒−𝑎(𝑏+
√
𝑏2+2𝜃),
𝜃> 0.
We consider the perpetual American call and put options denoted by 𝐶(𝑆𝑡) and 𝑃(𝑆𝑡),
respectively for a specified strike price 𝐾. Let 𝑆∞> 𝐾and 𝑆∗< 𝐾denote the unknown
optimal exercise boundaries for the perpetual American call and put options, respectively.
Here, for 𝑆𝑡≥𝑆∞(𝑆𝑡> 𝑆∗) the perpetual American call (put) option should be exercised
(held) and for 𝑆𝑡< 𝑆∞(𝑆𝑡≤𝑆∗) the perpetual American call (put) option should be held
(exercised).

302
3.2.2 Time-Independent Options
Under the risk-neutral measure ℚand using the Laplace transform for the distribution
of the time to hit the optimal exercise boundaries show that
𝐶(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
(𝑆∞−𝐾)
( 𝑆𝑡
𝑆∞
)𝛼+
if 𝑆𝑡< 𝑆∞
𝑆𝑡−𝐾
if 𝑆𝑡≥𝑆∞
and
𝑃(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑡
if 𝑆𝑡≤𝑆∗
(𝐾−𝑆∗)
( 𝑆𝑡
𝑆∗
)𝛼−
if 𝑆𝑡> 𝑆∗
where
𝛼+ =
−
(
𝑟−𝐷−1
2𝜎2)
+
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
> 0
and
𝛼−=
−
(
𝑟−𝐷−1
2𝜎2)
−
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
< 0.
Solution: To show that 𝑋𝑡= 𝑒𝜆𝑊𝑡−1
2 𝜆2𝑡is a martingale and the Laplace transform of the
first-passage time distribution see Problems 2.2.3.3 and 2.2.4.7, respectively of Problems
and Solutions in Mathematical Finance, Volume 1: Stochastic Calculus.
We first consider the perpetual American call option case where we let 𝜏∞be the time
to hit the unknown optimal exercise boundary 𝑆∞defined as
𝜏∞= min{𝑢−𝑡≥0 : 𝑆𝑢= 𝑆∞}.
From Girsanov’s theorem, under the risk-neutral measure ℚwe have
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.

3.2.2 Time-Independent Options
303
Hence, the perpetual American call option price at time 𝑡is defined as
𝐶(𝑆𝑡) = 𝔼ℚ[
𝑒−𝑟𝜏∞max{𝑆𝜏∞−𝐾, 0}||| ℱ𝑡
]
=
⎧
⎪
⎨
⎪⎩
(𝑆∞−𝐾)𝔼ℚ[
𝑒−𝑟𝜏∞||| ℱ𝑡
]
if 𝑆𝑡< 𝑆∞
𝑆𝑡−𝐾
if 𝑆𝑡≥𝑆∞.
By solving the SDE, for 𝑢> 𝑡we have
𝑆𝑢= 𝑆𝑡exp
[(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡
]
and hence the hitting time 𝜏∞becomes
𝜏∞= min
{
𝑢−𝑡≥0 : 𝑆𝑡exp
[(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡
]
= 𝑆∞}
= min
{
𝑢−𝑡≥0 : 𝑊ℚ
𝑢−𝑡= 1
𝜎log
(
𝑆∞
𝑆𝑡
)
−1
𝜎
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡)
}
= min
{
𝑣≥0 : 𝑊ℚ
𝑣= 1
𝜎log
(
𝑆∞
𝑆𝑡
)
−1
𝜎
(
𝑟−𝐷−1
2𝜎2)
𝑣
}
where 𝑣= 𝑢−𝑡.
Therefore, by setting 𝑎= 1
𝜎log
(
𝑆∞
𝑆𝑡
)
and 𝑏= −1
𝜎
(
𝑟−𝐷−1
2𝜎2)
, the Laplace
transform of the hitting-time distribution becomes
𝔼ℚ[
𝑒−𝑟𝜏∞||| ℱ𝑡
]
= 𝑒−𝑎(𝑏+
√
𝑏2+2𝑟)
= exp
{
−1
𝜎log
(
𝑆∞
𝑆𝑡
) [
−1
𝜎
(
𝑟−𝐷−1
2𝜎2)
+
√
1
𝜎2
(
𝑟−𝐷−1
2𝜎2)2
+ 2𝑟
⎤
⎥
⎥⎦
⎫
⎪
⎬
⎪⎭
=
( 𝑆𝑡
𝑆∞
)𝛼+
where
𝛼+ =
−
(
𝑟−𝐷−1
2𝜎2)
+
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
> 0.

304
3.2.2 Time-Independent Options
Thus,
𝐶(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
(𝑆∞−𝐾)
( 𝑆𝑡
𝑆∞
)𝛼+
if 𝑆𝑡< 𝑆∞
𝑆𝑡−𝐾
if 𝑆𝑡≥𝑆∞
such that lim
𝑆𝑡→0 𝐶(𝑆𝑡) = (𝑆∞−𝐾) lim
𝑆𝑡→0
( 𝑆𝑡
𝑆∞
)𝛼+
= 0.
For the case of a perpetual American put option, let 𝜏∗be the time to hit the unknown
optimal exercise boundary 𝑆∗defined as
𝜏∗= min{𝑢−𝑡≥0 : 𝑆𝑢= 𝑆∗}
and the option price is defined as
𝑃(𝑆𝑡) = 𝔼ℚ[
𝑒−𝑟𝜏∗max{𝐾−𝑆𝜏∗, 0}||| ℱ𝑡
]
=
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑡
if 𝑆𝑡≤𝑆∗
(𝐾−𝑆∗)𝔼ℚ[
𝑒−𝑟𝜏∗||| ℱ𝑡
]
if 𝑆𝑡> 𝑆∗.
Since 𝑆𝑢= 𝑆𝑡exp
[(
𝑟−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡
]
for 𝑢> 𝑡, and using the reflection princi-
ple of the Wiener process, the hitting time 𝜏∗can be written as
𝜏∗= min
{
𝑢−𝑡≥0 : 𝑊ℚ
𝑢−𝑡= 1
𝜎log
(
𝑆∞
𝑆𝑡
)
−1
𝜎
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡)
}
= min
{
𝑢−𝑡≥0 : −𝑊ℚ
𝑢−𝑡= −1
𝜎log
(
𝑆∞
𝑆𝑡
)
+ 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡)
}
= min
{
𝑢−𝑡≥0 : ̃
𝑊ℚ
𝑢−𝑡= −1
𝜎log
(
𝑆∞
𝑆𝑡
)
+ 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡)
}
= min
{
𝑣≥0 : ̃
𝑊ℚ
𝑣= −1
𝜎log
(
𝑆∞
𝑆𝑡
)
+ 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
𝑣
}
where 𝑣= 𝑢−𝑡and ̃
𝑊ℚ
𝑣is a ℚ-standard Wiener process.
By setting 𝑎= −1
𝜎log
(
𝑆∞
𝑆𝑡
)
and 𝑏= 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
, the Laplace transform of
the hitting-time distribution becomes
𝔼ℚ[
𝑒−𝑟𝜏∗||| ℱ𝑡
]
= 𝑒−𝑎(𝑏+
√
𝑏2+2𝑟)
= exp
{
1
𝜎log
(
𝑆∞
𝑆𝑡
) [ 1
𝜎
(
𝑟−𝐷−1
2𝜎2)

3.2.3 Time-Dependent Options
305
+
√
1
𝜎2
(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝑟
⎤
⎥
⎥⎦
⎫
⎪
⎬
⎪⎭
=
( 𝑆𝑡
𝑆∗
)𝛼−
where
𝛼−=
−
(
𝑟−𝐷−1
2𝜎2)
−
√(
𝑟−𝐷−1
2𝜎2
)2
+ 2𝜎2𝑟
𝜎2
< 0.
Hence,
𝑃(𝑆𝑡) =
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑡
if 𝑆𝑡≤𝑆∗
(𝐾−𝑆∗)
( 𝑆𝑡
𝑆∗
)𝛼−
if 𝑆𝑡> 𝑆∗
where lim
𝑆𝑡→∞𝑃(𝑆𝑡) = (𝐾−𝑆∗) lim
𝑆𝑡→∞
( 𝑆𝑡
𝑆∗
)𝛼−
= 0.
3.2.3
Time-Dependent Options
1. Consider an economy which consists of a risk-free asset and a stock, whose values at time
𝑡are 𝐵𝑡and 𝑆𝑡, respectively. Assume that these values evolve according to the following
diffusion processes
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡,
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
such that 𝐷is the continuous dividend yield, 𝑟is the risk-free rate, 𝜇is the stock price
growth rate and 𝜎𝑡is the stock price volatility. In addition, {𝑊𝑡: 𝑡≥0} is the ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ).
Show that the American option 𝑉(𝑆𝑡, 𝑡) satisfies the following inequality
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) ≤0
with constraint
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡)
where Ψ(𝑆𝑡) is the intrinsic value of the American option at time 𝑡.

306
3.2.3 Time-Dependent Options
Solution: We first set up a Δ-hedged portfolio
Π𝑡= 𝑉(𝑆𝑡, 𝑡) −Δ𝑆𝑡
and because during time 𝑑𝑡the stock pays out a continuous dividend 𝐷𝑆𝑡𝑑𝑡we have
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡).
By Taylor’s expansion and subsequently using It̄o’s lemma we can write
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
3!
𝜕3𝑉
𝜕𝑆3
𝑡
(𝑑𝑆𝑡)3 + ⋯
= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
[(𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑑𝑊𝑡
] + 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝑑𝑡
=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡+ 𝜎𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
and
𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡= 𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
By substituting the above expressions into 𝑑Π𝑡we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−Δ𝜇𝑆𝑡
]
𝑑𝑡
+𝜎
[
𝜕𝑉
𝜕𝑆𝑡
−Δ
]
𝑑𝑊𝑡.
To eliminate the random component we set
Δ = 𝜕𝑉
𝜕𝑆𝑡
and hence
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡.
If we assume
𝑑Π𝑡> 𝑟Π𝑡𝑑𝑡
then we would experience an arbitrage since a trader can borrow money at the risk-free
rate and then set up a Δ-hedged portfolio such that the return from the portfolio is greater
than the return from a bank.

3.2.3 Time-Dependent Options
307
Because there are times to exercise the option, the simple arbitrage argument used in the
European options is not valid here. Hence, we can conclude that for an American option
𝑑Π𝑡≤𝑟Π𝑡𝑑𝑡
or
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡≤𝑟
[
𝑉(𝑆𝑡, 𝑡) −𝜕𝑉
𝜕𝑆𝑡
𝑆𝑡
]
𝑑𝑡.
Therefore,
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) ≤0.
Here, for a European option, the inequality would become an equality.
Finally, from Problems 3.2.1.6 (page 276) and 3.2.1.12 (page 279) we can deduce that
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡).
2. Linear Complementarity Problem. We consider the price of an American option 𝑉(𝑆𝑡, 𝑡)
written on an underlying asset 𝑆𝑡at time 𝑡which satisfies the following inequality
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) ≤0
with constraint
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡)
where Ψ(𝑆𝑡) is the option’s intrinsic value, 𝑟is the risk-free interest rate, 𝐷is the contin-
uous dividend yield and 𝜎is the constant volatility.
Show that 𝑉(𝑆𝑡, 𝑡) with its corresponding intrinsic value Ψ(𝑆𝑡) satisfies the linear com-
plementarity problem
𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] ≤0,
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡),
[𝑉(𝑆𝑡, 𝑡) −Ψ(𝑆𝑡)] ⋅𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] = 0
where 𝐵𝑆denotes the differential operator
𝐵𝑆= 𝜕
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
−𝑟.
Solution: Suppose that 𝑉(𝑆𝑡, 𝑡) = Ψ(𝑆𝑡). Then early exercise is optimal and by substitut-
ing 𝑉(𝑆𝑡, 𝑡) = Ψ(𝑆𝑡) into the inequality we have
𝜕Ψ
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2Ψ
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕Ψ
𝜕𝑆𝑡
−𝑟Ψ(𝑆𝑡) < 0
since the option’s intrinsic value does not satisfy the Black–Scholes equation.

308
3.2.3 Time-Dependent Options
Hence,
𝑉(𝑆𝑡, 𝑡) = Ψ(𝑆𝑡),
𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] < 0.
In contrast, if 𝑉(𝑆𝑡, 𝑡) > Ψ(𝑆𝑡) then early exercise is not optimal and therefore
𝑉(𝑆𝑡, 𝑡) > Ψ(𝑆𝑡),
𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] = 0.
Collectively we can write
𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] ≤0,
𝑉(𝑆𝑡, 𝑡) ≥Ψ(𝑆𝑡),
[𝑉(𝑆𝑡, 𝑡) −Ψ(𝑆𝑡)] ⋅𝐵𝑆[𝑉(𝑆𝑡, 𝑡)] = 0.
3. Continuous Limit of Binomial Model for American Options. In a discrete-time Black–
Scholes world, we consider the binomial tree model to calculate the price of an American
option. At time 𝑡, where the current spot price is 𝑆𝑡, we build a tree of possible scenarios
of future stock prices
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆𝑡,
𝑖= 0, 1, … , 𝑁,
𝑗= 0, 1, 2, … , 𝑖
such that 𝑆(0)
0
= 𝑆𝑡, 𝑁is the total number of time periods, 𝑢= 𝑒𝜎
√
Δ𝑡, 𝑑= 𝑒−𝜎
√
Δ𝑡, Δ𝑡=
(𝑇−𝑡)∕𝑁is the binomial time step, 𝑇is the expiry time and 𝜎is the stock price volatility.
The intermediate American option price 𝑉(𝑆(𝑚)
𝑛, 𝑡+ 𝑛Δ𝑡) calculated at the 𝑚-th possible
tree value and at time step 𝑡+ 𝑛Δ𝑡, where 𝑚≤𝑛, 𝑛≤𝑁is defined as
𝑉(𝑆(𝑚)
𝑛, 𝑡+ 𝑛Δ𝑡)
= max
{
Ψ(𝑆(𝑚)
𝑛), 𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑢𝑆(𝑚)
𝑛, 𝑡+ (𝑛+ 1)Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆(𝑚)
𝑛, 𝑡+ (𝑛+ 1)Δ𝑡)
]}
where Ψ(𝑆(𝑚)
𝑛) is the option’s intrinsic value, 𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
is the risk-neutral proba-
bility, 𝑟is the risk-free interest rate and 𝐷is the continuous dividend yield.
Using Taylor’s expansion up to 𝑂(Δ𝑡) show that in the limit Δ𝑡→0 the binomial method
approximates the continuous-time linear complementarity problem of the form
𝐵𝑆[𝑉(𝑆, 𝑡′)] ≤0,
𝑉(𝑆, 𝑡′) ≥Ψ(𝑆),
[𝑉(𝑆, 𝑡′) −Ψ(𝑆)] ⋅𝐵𝑆[𝑉(𝑆, 𝑡′)] = 0
where 𝑆= 𝑆(𝑚)
𝑛, 𝑡′ = 𝑡+ 𝑛Δ𝑡and 𝐵𝑆denotes the differential operator
𝐵𝑆= 𝜕
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕
𝜕𝑆−𝑟.
Solution: By setting 𝑆= 𝑆(𝑚)
𝑛
and 𝑡′ = 𝑡+ 𝑛Δ𝑡, the intermediate American option price
can be written as
𝑉(𝑆, 𝑡′) = max {Ψ(𝑆), 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡)]}

3.2.3 Time-Dependent Options
309
where we either have
𝑉(𝑆, 𝑡′) = Ψ(𝑆) and 𝑉(𝑆, 𝑡′) > 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡)]
or
𝑉(𝑆, 𝑡′) > Ψ(𝑆) and 𝑉(𝑆, 𝑡′) = 𝑒−𝑟Δ𝑡[𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡)] .
By expanding 𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) and 𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) using Taylor’s theorem and using the
same steps as discussed in Problem 2.2.3.8 (page 202), we can write
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′)
=
[
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) + 𝑂(Δ𝑡)
]
Δ𝑡.
Since
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′) = 0 and 𝑉(𝑆, 𝑡′) > Ψ(𝑆)
or
𝜋𝑉(𝑢𝑆, 𝑡′ + Δ𝑡) + (1 −𝜋)𝑉(𝑑𝑆, 𝑡′ + Δ𝑡) −𝑒𝑟Δ𝑡𝑉(𝑆, 𝑡′) < 0 and 𝑉(𝑆, 𝑡′) = Ψ(𝑆)
we have
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) + 𝑂(Δ𝑡) = 0 and 𝑉(𝑆, 𝑡′) > Ψ(𝑆)
or
𝜕𝑉
𝜕𝑡′ + 1
2𝜎2𝑆2 𝜕2𝑉
𝜕𝑆2 + (𝑟−𝐷)𝑆𝜕𝑉
𝜕𝑆−𝑟𝑉(𝑆, 𝑡′) + 𝑂(Δ𝑡) < 0 and 𝑉(𝑆, 𝑡′) = Ψ(𝑆).
Hence, by taking limits Δ𝑡→0
𝐵𝑆[𝑉(𝑆, 𝑡′)] = 0 and 𝑉(𝑆, 𝑡′) > Ψ(𝑆)
or
𝐵𝑆[𝑉(𝑆, 𝑡′)] < 0 and 𝑉(𝑆, 𝑡′) = Ψ(𝑆).
Then we have
𝐵𝑆[𝑉(𝑆, 𝑡′)] ≤0,
𝑉(𝑆, 𝑡′) ≥Ψ(𝑆),
[𝑉(𝑆, 𝑡′) −Ψ(𝑆)] ⋅𝐵𝑆[𝑉(𝑆, 𝑡′)] = 0.

310
3.2.3 Time-Dependent Options
4. Consider a binomial tree model for an underlying asset process {𝑆𝑛: 0 ≤𝑛≤3} where
𝑆0 = 100. Let
𝑆𝑛+1 =
⎧
⎪
⎨
⎪⎩
𝑢𝑆𝑛
with probability 𝜋
𝑑𝑆𝑛
with probability 1 −𝜋
where 𝑢= 𝑒𝜎
√
Δ𝑡and 𝑑= 1∕𝑢where 𝜎is the volatility and Δ𝑡is the binomial time step.
By assuming the risk-neutral interest rate 𝑟= 5%, continuous dividend yield 𝐷= 1% and
volatility 𝜎= 10%, we wish to price an American put option with strike 𝐾= 105 and
expiry time 𝑇= 1 year in a 3-period binomial tree model.
(a) Find the risk-neutral probabilities 𝜋and 1 −𝜋.
(b) Find the price of the American put option.
(c) What is the trading strategy to hedge this option at the initial time period?
Solution:
(a) Given 𝑆0 = 100, 𝐾= 105, 𝑟= 0.05, 𝐷= 0.01, 𝜎= 0.1 and time step Δ𝑡= 1
3, there-
fore
𝑢= 𝑒𝜎
√
Δ𝑡= 𝑒
0.1
√
3 = 1.0594
and
𝑑= 𝑒−𝜎
√
Δ𝑡= 𝑒
−0.1
√
3 = 0.9439.
The risk-neutral probabilities are
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
= 0.6019
and
1 −𝜋= 1 −0.6019 = 0.3981.
(b) The binomial tree in Figure 3.1 shows the price movement of 𝑆0 in a 3-period binomial
model.
By setting
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆0,
𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, … , 𝑖
the American put option price at each of the lattice points is
𝑉(𝑗)
𝑖
= max
{
Ψ(𝑆(𝑗)
𝑖), 𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]}

3.2.3 Time-Dependent Options
311
0∙
2
0
∙
2
0
∙
0
∙
0
∙
0
∙
3
0
∙
2
0
∙
2
0
∙
3
0
∙
Figure 3.1
A 3-period binomial tree model.
such that
Ψ(𝑆(𝑗)
𝑖) = max
{
𝐾−𝑆(𝑗)
𝑖, 0
}
where 𝑖= 0, 1, … , 𝑛and 𝑗= 0, 1, … , 𝑖.
Hence, at time period 𝑛= 3
𝑉(0)
3
= Ψ(𝑆(0)
3 )
= max{𝐾−𝑑3𝑆0, 0}
= max{105 −0.94393 × 100, 0}
= 20.9035
𝑉(1)
3
= Ψ(𝑆(1)
3 )
= max{𝐾−𝑢𝑑2𝑆0, 0}
= max{105 −1.0594 × 0.94392 × 100, 0}
= 10.6131
𝑉(2)
3
= Ψ(𝑆(2)
3 )
= max{𝐾−𝑢2𝑑𝑆0, 0}
= max{105 −1.05942 × 0.9439 × 100, 0}
= 0
𝑉(3)
3
= Ψ(𝑆(3)
3 )
= max{𝐾−𝑢3𝑆0, 0}
= max{105 −1.05943 × 100, 0}
= 0.

312
3.2.3 Time-Dependent Options
At time period 𝑛= 2
𝑉(0)
2
= max
{
Ψ(𝑆(0)
2 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]}
= max
{
max {𝐾−𝑑2𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]}
= max {max {105 −0.94392 × 100, 0} ,
𝑒−0.05
3 [0.6019 × 10.6131 + 0.3981 × 20.9035]
}
= max{15.9053, 14.4666}
= 15.9053
𝑉(1)
2
= max
{
Ψ(𝑆(1)
2 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
3
+ (1 −𝜋)𝑉(1)
3
]}
= max
{
max {𝐾−𝑢𝑑𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
3
+ (1 −𝜋)𝑉(1)
3
]}
= max {max {105 −1.0594 × 0.9439 × 100, 0} ,
𝑒−0.05
3 [0.6019 × 0 + 0.3981 × 10.6131]
}
= max{5.0032, 4.1552}
= 5.0032
𝑉(2)
2
= max
{
Ψ(𝑆(2)
2 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]}
= max
{
max {𝐾−𝑢2𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]}
= max
{
max
{
105 −1.05942 × 100, 0
}
,
𝑒−0.05
3 [0.6019 × 0 + 0.3981 × 0]
}
= max{0, 0}
= 0.
At time period 𝑛= 1
𝑉(0)
1
= max
{
Ψ(𝑆(0)
1 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]}
= max
{
max {𝐾−𝑑𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]}
= max {max {105 −0.9439 × 100, 0} ,
𝑒−0.05
3 [0.6019 × 5.0032 + 0.3981 × 15.9053]
}
= max{10.61, 9.1889}
= 10.61

3.2.3 Time-Dependent Options
313
𝑉(1)
1
= max
{
Ψ(𝑆(1)
1 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]}
= max
{
max {𝐾−𝑢𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]}
= max {max {105 −1.0594 × 100, 0} ,
𝑒−0.05
3 [0.6019 × 0 + 0.3981 × 5.0032]
}
= max{0, 1.9589}
= 1.9589
and finally at time period 𝑛= 0
𝑉(0)
0
= max
{
Ψ(𝑆(0)
0 , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]}
= max
{
max {𝐾−𝑆0, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]}
= max {max {105 −100, 0} ,
𝑒−0.05
3 [0.6019 × 1.9589 + 0.3981 × 10.61]
}
= max{5, 5.3136}
= 5.3136.
Therefore, the price of the American put based on a 3-period binomial model is 𝑉(0)
0
=
5.3136.
(c) At time period 𝑛= 0, let 𝜙0 and 𝜓0 be the unit of the underlying asset 𝑆0 and the
amount of cash invested in the money market, respectively. At time period 𝑛= 1, the
asset price can either be 𝑆(0)
1
= 𝑑𝑆0 or 𝑆1
1 = 𝑢𝑆0 and 𝜓0 will grow to 𝜓0𝑒𝑟Δ𝑡. Thus,
we can write
𝑉(0)
1
= 𝜙0𝑆(0)
1
+ 𝜓0𝑒𝑟Δ𝑡
𝑉(1)
1
= 𝜙0𝑆(1)
1
+ 𝜓0𝑒𝑟Δ𝑡.
Hence,
𝜙0 =
𝑉(1)
1
−𝑉(0)
1
𝑆(1)
1
−𝑆(0)
1
=
𝑉(1)
1
−𝑉(0)
1
𝑢𝑆0 −𝑑𝑆0
and
𝜓0 = 𝑒−𝑟Δ𝑡(𝑉(0)
1
−𝜙0𝑆(0)
1 ).
By substituting 𝑉(0)
1
= 10.61, 𝑉(1)
1
= 1.9589, 𝑆(0)
1
= 𝑑𝑆0 = 94.39, 𝑆(1)
1
= 𝑢𝑆0 =
105.94, 𝑟= 0.05 and Δ𝑡= 1
3 we have
𝜙0 = −0.7490
and
𝜓0 = 79.9642

314
3.2.3 Time-Dependent Options
which implies we need to sell −0.7778 units of the underlying asset 𝑆0 and put
$79.9642 into the money market at 5% interest rate.
5. Smooth-Pasting Condition for an American Call Option. We consider an American call
option, 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾written on an underlying asset priced at 𝑆𝑡at time
𝑡and 𝑇> 𝑡is the option expiry time. Here the option has an unknown optimal exercise
boundary 𝑆∞
𝑡
such that the option should be exercised if 𝑆𝑡≥𝑆∞
𝑡
and held if 𝑆𝑡< 𝑆∞
𝑡.
By assuming 𝑆∞
𝑡
> 𝐾show that the American call option satisfies the “smooth-pasting”
condition
𝜕𝐶
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∞
𝑡
= 1
at the optimal exercise boundary 𝑆∞
𝑡.
Solution: We prove this result via contradiction.
From definition, the value of an American call option can be written as
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑓(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑡< 𝑆∞
𝑡
𝑆𝑡−𝐾
if 𝑆𝑡≥𝑆∞
𝑡
where 𝑓(𝑆𝑡, 𝑡; 𝐾, 𝑇) solves the Black–Scholes equation and 𝜕𝐶
𝜕𝑆𝑡
= 1 for 𝑆𝑡≥𝑆∞
𝑡. For a
graphical interpretation of the American call option see Figure 3.2.
(
;
)
(
;
)
∞
−
Figure 3.2
American call option price.

3.2.3 Time-Dependent Options
315
For 𝑆𝑡< 𝑆∞, suppose 𝜕𝐶
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∞
𝑡
< 1 then
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) < max{𝑆𝑡−𝐾, 0}
which contradicts the fact that 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0}.
Conversely if 𝜕𝐶
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∞
𝑡
> 1 then as the underlying asset price gets closer to 𝑆∞
𝑡
the
value of the American call option can be increased by choosing a larger 𝑆∞
𝑡, which is a
contradiction to the fact that 𝑆∞
𝑡
is the optimal exercise boundary.
Hence, in order to satisfy the optimal exercise strategy of an American call option we
have
𝜕𝐶
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∞
𝑡
= 1
where the two parts of 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) are joined smoothly without any discontinuity at
𝑆𝑡= 𝑆∞
𝑡.
6. Smooth-Pasting Condition for an American Put Option. We consider an American put
option 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾written on an underlying asset priced at 𝑆𝑡at time 𝑡
where 𝑇> 𝑡is the option expiry time. Here the option has an unknown optimal exercise
boundary 𝑆∗
𝑡such that the option should be exercised if 𝑆𝑡≤𝑆∗and held if 𝑆𝑡> 𝑆∗
𝑡.
By assuming 𝑆∗
𝑡< 𝐾show that the American put option satisfies the “smooth-pasting”
condition
𝜕𝑃
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
= −1
at the optimal exercise boundary 𝑆∗
𝑡.
Solution: We prove this result via contradiction.
From definition, the value of an American put option can be written as
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝐾−𝑆𝑡
if 𝑆𝑡≤𝑆∗
𝑡
𝑔(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if 𝑆𝑡> 𝑆∗
𝑡
where 𝑔(𝑆𝑡, 𝑡; 𝐾, 𝑇) solves the Black–Scholes equation and 𝜕𝑃
𝜕𝑆𝑡
= −1 for 𝑆𝑡≤𝑆∗
𝑡. For a
graphical interpretation see Figure 3.3.
Suppose 𝜕𝑃
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
< −1 then for 𝑆𝑡> 𝑆∗
𝑡
𝑃(𝑆𝑡, 𝑡) < max{𝐾−𝑆𝑡, 0}
which contradicts the fact that 𝑃(𝑆𝑡, 𝑡) ≥max{𝐾−𝑆𝑡, 0}.

316
3.2.3 Time-Dependent Options
(
;
)
(
;
)
∗
−
Figure 3.3
American put option price.
Conversely, if 𝜕𝑃
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
> −1 then as the underlying asset price gets closer to 𝑆∗
𝑡the
value of the American put option can be increased by choosing a smaller 𝑆∗
𝑡, which is a
contradiction to the fact that 𝑆∗
𝑡is the optimal exercise boundary.
Hence, in order to satisfy the optimal exercise strategy of an American put option we
have
𝜕𝑃
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
= −1
where the two parts of 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) are joined smoothly without any discontinuity at
𝑆𝑡= 𝑆∗
𝑡.
7. American Call Option Asymptotic Optimal Exercise Boundary. We consider an Ameri-
can call option price 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) written on an underlying asset priced at 𝑆𝑡at time 𝑡
satisfying the following inequality
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤0
with constraints
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝑆𝑡−𝐾, 0},
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the constant
volatility, 𝐾is the strike price and 𝑇> 𝑡is the option expiry time. The option has an

3.2.3 Time-Dependent Options
317
unknown optimal exercise boundary 𝑆∞
𝑡
≥𝐾where the option should be exercised if 𝑆𝑡≥
𝑆∞
𝑡
and held if 𝑆𝑡< 𝑆∞
𝑡.
Show that for 𝐷< 𝑟
lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡≤0,
for 𝐾< lim
𝑡→𝑇𝑆𝑡≤𝑟𝐾
𝐷
and
lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡> 0,
for lim
𝑡→𝑇𝑆𝑡> 𝑟𝐾
𝐷
and hence deduce that lim
𝑡→𝑇𝑆∞
𝑡
= 𝑟𝐾
𝐷.
For 𝐷≥𝑟show that
lim
𝑡→𝑇𝑆∞
𝑡
= 𝐾.
Finally, deduce that lim
𝑡→𝑇𝑆∞
𝑡
= 𝐾max
{ 𝑟
𝐷, 1
}
.
Explain the financial implications if we set 𝐷= 0 or 𝑟= 0.
Solution: By considering the case when the American call option is not optimal to exercise,
then the option price satisfies the Black–Scholes equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with constraint
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) > max{𝑆𝑡−𝐾, 0}.
For case 𝐷< 𝑟we only consider lim
𝑡→𝑇𝑆𝑡> 𝐾such that
lim
𝑡→𝑇𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = lim
𝑡→𝑇𝑆𝑡−𝐾.
We then have
lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡= −lim
𝑡→𝑇
1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
−lim
𝑡→𝑇(𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ lim
𝑡→𝑇𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= −(𝑟−𝐷) lim
𝑡→𝑇𝑆𝑡+ 𝑟(lim
𝑡→𝑇𝑆𝑡−𝐾)
= 𝐷lim
𝑡→𝑇𝑆𝑡−𝑟𝐾.

318
3.2.3 Time-Dependent Options
Suppose lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡> 0, then expanding 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) using Taylor’s theorem for 𝑡→𝑇
gives
lim
𝑡→𝑇𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) + lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡(𝑡−𝑇) + 𝑂((𝑡−𝑇)2)
< 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝑆𝑇−𝐾
which is a contradiction.
Therefore, in order to hold the option we have
lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡≤0,
for 𝐾< lim
𝑡→𝑇𝑆𝑡≤𝑟𝐾
𝐷
and conversely
lim
𝑡→𝑇
𝜕𝐶
𝜕𝑡> 0,
for lim
𝑡→𝑇𝑆𝑡> 𝑟𝐾
𝐷
where the option should be exercised. Hence, the optimal exercise boundary is obtained
by setting
lim
𝑡→𝑇𝑆∞
𝑡
= 𝑟𝐾
𝐷.
For the case 𝐷≥𝑟we assume lim
𝑡→𝑇𝑆∞
𝑡
> 𝐾where early exercise is not optimal for 𝐾<
lim
𝑡→𝑇𝑆𝑡< lim
𝑡→𝑇𝑆∞
𝑡. Given 𝐷≥𝑟and lim
𝑡→𝑇𝑆𝑡> 𝐾therefore, by not exercising the option the
interest earned on the strike is greater than the dividend lost from holding the asset, which
is a contradiction. Hence,
lim
𝑡→𝑇𝑆∞
𝑡
≤𝐾.
Because 𝑆∞
𝑡
≥𝐾, 𝑡< 𝑇we can deduce that
lim
𝑡→𝑇𝑆∞
𝑡
= 𝐾.
In general we can write
lim
𝑡→𝑇𝑆∞
𝑡
=
⎧
⎪
⎨
⎪⎩
𝑟𝐾
𝐷
if 𝐷< 𝑟
𝐾
if 𝐷≥𝑟
= 𝐾max
{ 𝑟
𝐷, 1
}
.

3.2.3 Time-Dependent Options
319
If 𝐷= 0 then
lim
𝑡→𝑇𝑆∞
𝑡
= ∞
which shows that it is never optimal to exercise an American call option before the expiry
time.
In contrast, if 𝑟= 0 then
lim
𝑡→𝑇𝑆∞
𝑡
= 𝐾
which implies that it is always optimal to exercise an American call option whenever the
option is deep in the money.
8. American Put Option Asymptotic Optimal Exercise Boundary. We consider an American
put option price 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) written on an underlying asset priced at 𝑆𝑡at time 𝑡satis-
fying the following inequality
𝜕𝑃
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃
𝜕𝑆𝑡
−𝑟𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≤0
with constraints
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max{𝐾−𝑆𝑡, 0},
𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the constant
volatility, 𝐾is the strike price and 𝑇> 𝑡is the option expiry time. The option has an
unknown optimal exercise boundary 𝑆∗
𝑡≤𝐾where the option should be exercised if 𝑆𝑡≤
𝑆∗
𝑡and held if 𝑆𝑡> 𝑆∞
𝑡.
Show that for 𝐷> 𝑟
lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡≤0,
for 𝑟𝐾
𝐷≤lim
𝑡→𝑇𝑆𝑡< 𝐾
and
lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡> 0,
for lim
𝑡→𝑇𝑆𝑡< 𝑟𝐾
𝐷
and hence deduce that lim
𝑡→𝑇𝑆∗
𝑡= 𝑟𝐾
𝐷.
For 𝐷≤𝑟show that
lim
𝑡→𝑇𝑆∗
𝑡= 𝐾.
Finally, deduce that lim
𝑡→𝑇𝑆∗
𝑡= 𝐾min
{ 𝑟
𝐷, 1
}
.
Explain the financial implications if we set 𝐷= 0 or 𝑟= 0.

320
3.2.3 Time-Dependent Options
Solution: We only consider the case when the American put option is not optimal to exer-
cise where the option price satisfies the Black–Scholes equation
𝜕𝑃
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃
𝜕𝑆𝑡
−𝑟𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with constraint
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) > max{𝐾−𝑆𝑡, 0}.
For case 𝐷≤𝑟we consider lim
𝑡→𝑇𝑆𝑡< 𝐾so that
lim
𝑡→𝑇𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾−lim
𝑡→𝑇𝑆𝑡.
We then have
lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡= −lim
𝑡→𝑇
1
2𝜎2𝑆2
𝑡
𝜕2𝑃
𝜕𝑆2
𝑡
−lim
𝑡→𝑇(𝑟−𝐷)𝑆𝑡
𝜕𝑃
𝜕𝑆𝑡
+ lim
𝑡→𝑇𝑟𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= (𝑟−𝐷) lim
𝑡→𝑇𝑆𝑡−𝑟(lim
𝑡→𝑇𝑆𝑡−𝐾)
= 𝑟𝐾−𝐷lim
𝑡→𝑇𝑆𝑡.
Suppose lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡> 0, then expanding 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) using Taylor’s theorem for 𝑡→𝑇
gives
lim
𝑡→𝑇𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) + lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡(𝑡−𝑇) + 𝑂((𝑡−𝑇)2)
< 𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 𝐾−𝑆𝑇
which is a contradiction.
Therefore, in order to hold the option we have
lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡≤0,
for 𝑟𝐾
𝐷≤lim
𝑡→𝑇𝑆𝑡< 𝐾
and conversely the option should be exercised when
lim
𝑡→𝑇
𝜕𝑃
𝜕𝑡> 0,
for lim
𝑡→𝑇𝑆𝑡< 𝑟𝐾
𝐷.
Hence, the optimal exercise boundary is obtained by setting
lim
𝑡→𝑇𝑆∗
𝑡= 𝑟𝐾
𝐷.

3.2.3 Time-Dependent Options
321
For the case 𝐷≤𝑟we assume lim
𝑡→𝑇𝑆∗
𝑡< 𝐾where early exercise is not optimal for
lim
𝑡→𝑇𝑆∗
𝑡< lim
𝑡→𝑇𝑆𝑡< 𝐾. Given 𝐷≤𝑟and lim
𝑡→𝑇𝑆𝑡< 𝐾therefore, by not exercising the option
the holder assumes the interest lost on the strike is lower than the dividend gained from
holding the asset, which is a contradiction. Hence,
lim
𝑡→𝑇𝑆∗
𝑡≥𝐾.
Because 𝑆∞
𝑡
≤𝐾, 𝑡< 𝑇we can deduce that
lim
𝑡→𝑇𝑆∗
𝑡= 𝐾.
In general, we can write
lim
𝑡→𝑇𝑆∗
𝑡=
⎧
⎪
⎨
⎪⎩
𝑟𝐾
𝐷
if 𝐷> 𝑟
𝐾
if 𝐷≤𝑟
= 𝐾min
{ 𝑟
𝐷, 1
}
.
If 𝐷= 0 then
lim
𝑡→𝑇𝑆∗
𝑡= 𝐾
which implies it is always optimal to exercise an American put option whenever the option
is deep in the money.
If 𝑟= 0 then
lim
𝑡→𝑇𝑆∗
𝑡= 0
which shows that when there is zero interest rate there is no financial gain in holding 𝐾
from early exercise and therefore it is never optimal to exercise an American put option
until expiry time. Thus, it is better to hold on to the option whilst earning dividend 𝐷from
𝑆𝑡till the expiry time.
9. Upper Bound of American Option Price. Let 𝑉(𝑆𝑡, 𝑡) be the price of an American option
on an underlying asset 𝑆𝑡at time 𝑡with terminal payoff Ψ(𝑆𝑇) where 𝑇is the option expiry
time. In addition, let 𝑟be the risk-free interest rate.
Under the risk-neutral measure ℚand conditional on the filtration ℱ𝑡, we can express
the option price as a primal problem
𝑉(𝑆𝑡, 𝑡) = sup
𝑡≤𝜏≤𝑇
𝔼ℚ[
𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏)||| ℱ𝑡
]
where the supremum is taken over all possible stopping times 𝜏, 𝜏∈[𝑡, 𝑇].

322
3.2.3 Time-Dependent Options
For arbitrary martingales 𝑀𝑡, show that
𝑉(𝑆𝑡, 𝑡) ≤inf
𝑀𝔼ℚ
[
max
𝑡≤𝜏≤𝑇
{𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) −𝑀𝜏
}||||
ℱ𝑡
]
+ 𝑀𝑡
where the right-hand side of the inequality is the dual problem.
Hence, show that
𝑉(𝑆𝑡, 𝑡) ≤𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏)
||||
ℱ𝑡
]
.
Solution: For an arbitrary martingale 𝑀𝑡
𝑉(𝑆𝑡, 𝑡) = sup
𝑡≤𝜏≤𝑇
𝔼ℚ[
𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏)||| ℱ𝑡
]
= sup
𝑡≤𝜏≤𝑇
𝔼ℚ[
𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) + 𝑀𝜏−𝑀𝜏||| ℱ𝑡
]
= sup
𝑡≤𝜏≤𝑇
{
𝔼ℚ[
𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) −𝑀𝜏||| ℱ𝑡
]
+ 𝔼ℚ[𝑀𝜏|| ℱ𝑡
]}
= sup
𝑡≤𝜏≤𝑇
𝔼ℚ[
𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) −𝑀𝜏||| ℱ𝑡
]
+ 𝑀𝑡
≤𝔼ℚ
[
max
𝑡≤𝜏≤𝑇
{𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) −𝑀𝜏
}||||
ℱ𝑡
]
+ 𝑀𝑡.
Thus, taking the infimum
𝑉(𝑆𝑡, 𝑡) ≤inf
𝑀𝔼ℚ
[
max
𝑡≤𝜏≤𝑇
{𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏) −𝑀𝜏
}||||
ℱ𝑡
]
+ 𝑀𝑡.
Setting 𝑀𝑡= 0, we have
𝑉(𝑆𝑡, 𝑡) ≤𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)Ψ(𝑆𝜏)||||
ℱ𝑡
]
.
10. Black Approximation. Consider an American call option written on an underlying asset
𝑆𝑡at time 𝑡with strike price 𝐾and option expiry time 𝑇> 𝑡. The asset pays one discrete
dividend 𝛿at time 𝜏, 𝑡< 𝜏< 𝑇. In addition, let 𝜎be the asset volatility and 𝑟be the risk-
free interest rate.
The Black approximation to price an American call option with a single dividend is
given as
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≈max {𝐶𝑏𝑠(𝑆𝑡−𝛿𝑒−𝑟(𝜏−𝑡), 𝑡; 𝐾, 𝑇), 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝜏)}

3.2.3 Time-Dependent Options
323
where it is set as the maximum of two European options that expire at times 𝑇and 𝜏such
that
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑋Φ(𝑑+) −𝑌𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
𝑑± =
log(𝑋∕𝑌) + (𝑟± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
What do the first and second terms of the approximation symbolise?
Is the approximation value an upper or lower bound of the American call option price?
Finally, show that it is never optimal to exercise the American call option with a single
discrete dividend when
𝛿≤𝐾[1 −𝑒−𝑟(𝑇−𝜏)] .
Solution: The first term provides the European call option price value when the probabil-
ity of early exercise is zero, whilst the second term assumes that the probability of early
exercise before the ex-dividend date 𝜏is one.
Since the two terms are sub-optimal values, therefore
𝐶𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) ≥max {𝐶𝑏𝑠(𝑆𝑡−𝛿𝑒−𝑟(𝜏−𝑡), 𝑡; 𝐾, 𝑇), 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝜏)} .
To show that it is never optimal to exercise the American call option with one discrete
dividend when
𝛿≤𝐾[1 −𝑒−𝑟(𝑇−𝜏)]
we first consider the possibility of early exercise prior to the dividend date 𝜏.
If the option is exercised at time 𝜏, the buyer of the call option receives
𝑆𝜏−𝐾.
If the option is not exercised before 𝜏, the asset price will drop to
𝑆𝜏−𝛿.
Because the value of the call option
𝐶𝑎𝑚(𝑆𝜏, 𝜏; 𝐾, 𝑇) ≥𝑆𝜏−𝛿−𝐾−𝑟(𝑇−𝜏)
therefore it is not optimal to exercise at time 𝜏if
𝑆𝜏−𝛿−𝐾𝑒−𝑟(𝑇−𝜏) ≥𝑆𝜏−𝐾

324
3.2.3 Time-Dependent Options
or
𝛿≤𝐾[1 −𝑒−𝑟(𝑇−𝜏)] .
11. Barone-Adesi and Whaley Formula. Let 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of an American put
option on an underlying asset 𝑆𝑡at time 𝑡such that it satisfies the Black–Scholes equation
for 𝑆𝑡> 𝑆∗
𝑡
𝜕𝑃𝑎𝑚
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃𝑎𝑚
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃𝑎𝑚
𝜕𝑆𝑡
−𝑟𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) > max{𝐾−𝑆𝑡, 0}
where 𝑆∗
𝑡≤𝐾is the unknown optimal exercise boundary, 𝐾is the strike price, 𝑟is the
risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the constant volatility and
𝑇> 𝑡is the expiry time.
By writing the American put option price as
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the price of a European put option and 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the early-
exercise premium, show that for 𝑆𝑡> 𝑆∗, 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies
𝜕𝜀
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜀
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜀
𝜕𝑆𝑡
−𝑟𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
lim
𝑆𝑡→0 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾(1 −𝑒−𝑟(𝑇−𝑡)),
lim
𝑆𝑡→∞𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
lim
𝑡→𝑇𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
By setting 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (1 −𝑒−𝑟(𝑇−𝑡))𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) show that for 𝑆𝑡> 𝑆∗
𝑡, 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇)
satisfies
𝜕𝜐
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜐
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜐
𝜕𝑆𝑡
−
𝑟
1 −𝑒−𝑟(𝑇−𝑡) 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
lim
𝑆𝑡→0 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾,
lim
𝑆𝑡→∞𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
lim
𝑡→𝑇𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
By assuming 𝜕𝜐
𝜕𝑡= 0 show that the American put option can be approximated by
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝐴𝑆𝛼
𝑡

3.2.3 Time-Dependent Options
325
where 𝐴is a constant,
𝛼=
−(𝑟−𝐷−1
2𝜎2) −
√(
𝑟−𝐷−1
2
)2
+ 2𝜎̃𝑟
𝜎2
and
̃𝑟=
𝑟
1 −𝑒−𝑟(𝑇−𝑡) .
Finally, using the “smooth-pasting” condition and the solution of 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) at 𝑆𝑡=
𝑆∗
𝑡, show that the constant 𝐴is
𝐴= −
[ Δ∗
𝐸+ 1
𝛼(𝑆∗
𝑡)𝛼−1
]
where Δ∗
𝐸= 𝜕𝑃𝑏𝑠
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
with 𝑆∗
𝑡satisfying the following equation
(Δ∗
𝐸+ 1 −𝛼
𝛼
)
𝑆∗
𝑡+ 𝑃𝑏𝑠(𝑆∗
𝑡, 𝑡; 𝐾, 𝑇) −𝐾= 0.
Solution: For 𝑆𝑡> 𝑆∗
𝑡, both 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfy the Black–
Scholes equation. Therefore, 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) also satisfies
𝜕𝜀
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜀
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜀
𝜕𝑆𝑡
−𝑟𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
Given that
𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
as 𝑆𝑡→0, we have 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) →𝐾and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) →𝐾𝑒−𝑟(𝑇−𝑡).
Thus,
lim
𝑆𝑡→0 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾(1 −𝑒−𝑟(𝑇−𝑡)).
In
contrast,
for
the
case
when
𝑆𝑡→∞,
we
have
𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) →0
and
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) →0. Therefore,
lim
𝑆𝑡→∞𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.

326
3.2.3 Time-Dependent Options
Finally, for 𝑡→𝑇, both 𝑃𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) →max{𝐾−𝑆𝑇, 0} and 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) →
max{𝐾−𝑆𝑇, 0}, and so
lim
𝑡→𝑇𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
By setting 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (1 −𝑒−𝑟(𝑇−𝑡))𝜐(𝑆𝑡, 𝑡) we have
𝜕𝜀
𝜕𝑡= −𝑟𝑒−𝑟(𝑇−𝑡)𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) + (1 −𝑒−𝑟(𝑇−𝑡))𝜕𝜐
𝜕𝑡
𝜕𝜀
𝜕𝑆𝑡
= (1 −𝑒−𝑟(𝑇−𝑡)) 𝜕𝜐
𝜕𝑆𝑡
, 𝜕2𝜀
𝜕𝑆2
𝑡
= (1 −𝑒−𝑟(𝑇−𝑡)) 𝜕2𝜐
𝜕𝑆2
𝑡
and substituting them into the Black–Scholes equation we eventually have
𝜕𝜐
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝜐
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜐
𝜕𝑆𝑡
−
𝑟
1 −𝑒−𝑟(𝑇−𝑡) 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
such that
lim
𝑆𝑡→0 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = lim
𝑆𝑡→0 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇)(1 −𝑒−𝑟(𝑇−𝑡))−1 = 𝐾
lim
𝑆𝑡→∞𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = lim
𝑆𝑡→0 𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇)(1 −𝑒−𝑟(𝑇−𝑡))−1 = 0
and
lim
𝑡→𝑇𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = lim
𝑡→𝑇𝜀(𝑆𝑡, 𝑡; 𝐾, 𝑇)(1 −𝑒−𝑟(𝑇−𝑡))−1 = 0.
By setting 𝜕𝜐
𝜕𝑡= 0, the equation becomes
1
2𝜎2𝑆2
𝑡
𝜕2𝜐
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝜐
𝜕𝑆𝑡
−
𝑟
1 −𝑒−𝑟(𝑇−𝑡) 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
and following the workings of the perpetual American options (see Problem 3.2.2.1, page
292) we can write the general solution as
𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐴𝑆𝛼
𝑡+ 𝐵𝑆𝛽
𝑡
where 𝐴and 𝐵are constants,
𝛼=
−(𝑟−𝐷−1
2𝜎2) −
√(
𝑟−𝐷−1
2
)2
+ 2𝜎̃𝑟
𝜎2
< 0

3.2.3 Time-Dependent Options
327
and
𝛽=
−(𝑟−𝐷−1
2𝜎2) +
√(
𝑟−𝐷−1
2
)2
+ 2𝜎̃𝑟
𝜎2
> 0
such that ̃𝑟=
𝑟
1 −𝑒−𝑟(𝑇−𝑡) . From the initial condition, for 𝑆𝑡→∞, 𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) →0 and
because 𝛽> 0 therefore 𝐵= 0. Hence,
𝜐(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐴𝑆𝛼
𝑡.
Finally, at 𝑆𝑡= 𝑆∗
𝑡(see Problem 3.2.3.6, page 315) we have
𝑃𝑎𝑚(𝑆∗
𝑡, 𝑡; 𝐾, 𝑇) = 𝐾−𝑆∗
𝑡and 𝜕𝑃𝑎𝑚
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
= −1
and by writing Δ∗
𝑏𝑠= 𝜕𝑃𝑏𝑠
𝜕𝑆𝑡
||||𝑆𝑡=𝑆∗
𝑡
we therefore have two equations
𝑃𝑏𝑠(𝑆∗
𝑡, 𝑡; 𝐾, 𝑇) + 𝐴(𝑆∗
𝑡)𝛼= 𝐾−𝑆∗
𝑡
Δ∗
𝑏𝑠+ 𝛼𝐴(𝑆∗
𝑡)𝛼−1 = −1
and by solving them simultaneously
𝐴= −
[ Δ∗
𝑏𝑠+ 1
𝛼(𝑆∗
𝑡)𝛼−1
]
and 𝑆∗
𝑡satisfies
(Δ∗
𝑏𝑠+ 1 −𝛼
𝛼
)
𝑆∗
𝑡+ 𝑃𝑏𝑠(𝑆∗
𝑡, 𝑡; 𝐾, 𝑇) −𝐾= 0.
12. Consider a binomial tree model for an underlying asset process {𝑆𝑛: 0 ≤𝑛≤3} following
the Cox–Ross–Rubinstein model. With the initial asset price 𝑆0 = 100, let
𝑆𝑛+1 =
⎧
⎪
⎨
⎪⎩
𝑢𝑆𝑛
with probability 𝜋
𝑑𝑆𝑛
with probability 1 −𝜋
where 𝑢= 𝑒𝜎
√
Δ𝑡and 𝑑= 1∕𝑢, with 𝜎the volatility and Δ𝑡the binomial time step. Assum-
ing the risk-free interest rate 𝑟= 1%, continuous dividend yield 𝐷= 0.5% and volatility
𝜎= 8%, we wish to price a Bermudan call option with strike 𝐾= 95 and expiry time 𝑇= 1

328
3.2.3 Time-Dependent Options
year in a 3-period binomial tree model. For the Bermudan call option, early exercise is only
allowed in the fourth month of the contract.
(a) Find the risk-neutral probabilities 𝜋and 1 −𝜋.
(b) Find the price of the Bermudan call option.
Solution:
(a) Given 𝑆0 = 100, 𝐾= 95, 𝑟= 0.01, 𝐷= 0.005, 𝜎= 0.08 and time step Δ𝑡= 1
3, then
𝑢= 𝑒𝜎
√
Δ𝑡= 𝑒
0.08
√
3 = 1.0472
and
𝑑= 𝑒−𝜎
√
Δ𝑡= 1
𝑢=
1
1.0472 = 0.9549.
Therefore, the risk-neutral probabilities are
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
= 0.5065
and
1 −𝜋= 1 −0.5065 = 0.4935.
(b) The binomial tree in Figure 3.4 shows the price movement of 𝑆0 in a 3-period binomial
model.
0∙
2
0
∙
2
0
∙
0
∙
0
∙
0
∙
3
0
∙
2
0
∙
2
0
∙
3
0
∙
Figure 3.4
A 3-period binomial tree model.

3.2.3 Time-Dependent Options
329
By setting
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆0,
𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, … , 𝑖
the Bermudan call option price at each of the lattice points is
𝑉(𝑗)
𝑖
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
max
{
Ψ(𝑆(𝑗)
𝑖),
𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]}
early exercise is allowed
𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]
early exercise is not allowed
such that
Ψ(𝑆(𝑗)
𝑖) = max
{
𝑆(𝑗)
𝑖
−𝐾, 0
}
where 𝑖= 0, 1, … , 𝑛and 𝑗= 0, 1, … , 𝑖.
Hence, at time period 𝑛= 3 (i.e., option expiry time 𝑇= 1 year)
𝑉(0)
3
= Ψ(𝑆(0)
3 )
= max{𝑑3𝑆0 −𝐾, 0}
= max{0.95493 × 100 −95, 0}
= 0
𝑉(1)
3
= Ψ(𝑆(1)
3 )
= max{𝑢𝑑2𝑆0 −𝐾, 0}
= max{1.0472 × 0.95492 × 100 −95, 0}
= 0.4873
𝑉(2)
3
= Ψ(𝑆(2)
3 )
= max{𝑢2𝑑𝑆0 −𝐾, 0}
= max{1.04722 × 0.9549 × 100 −95, 0}
= 9.7170
𝑉(3)
3
= Ψ(𝑆(3)
3 )
= max{𝑢3𝑆0 −𝐾, 0}
= max{1.04723 × 100 −95, 0}
= 19.8389.

330
3.2.3 Time-Dependent Options
At time period 𝑛= 2 (i.e., 𝑡= 8 months) where early exercise is not allowed
𝑉(0)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
= 𝑒−0.01
3 [0.5065 × 0.4873 + 0.4935 × 0]
= 0.2460
𝑉(1)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
3
+ (1 −𝜋)𝑉(1)
3
]
= 𝑒−0.01
3 [0.5065 × 9.7170 + 0.4935 × 0.4873]
= 5.1450
𝑉(2)
2
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(3)
3
+ (1 −𝜋)𝑉(2)
3
]
= 𝑒−0.01
3 [0.5065 × 19.8389 + 0.4935 × 9.7170]
= 14.7944.
At time period 𝑛= 1 (i.e., 𝑡= 4 months) where early exercise is allowed
𝑉(0)
1
= max
{
Ψ(𝑆(0)
1 ), 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]}
= max
{
max {𝑑𝑆0 −𝐾, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]}
= max{max{0.9549 × 100 −95, 0},
𝑒−0.01
3 [0.5065 × 5.1450 + 0.4935 × 0.2460]}
= max{0.4900, 2.7183}
= 2.7183
𝑉(1)
1
= max
{
Ψ(𝑆(1)
1 ), 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]}
= max
{
max {𝑢𝑆0 −𝐾, 0} , 𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]}
= max{max{1.0472 × 100 −95, 0},
𝑒−0.01
3 [0.5065 × 14.7944 + 0.4935 × 5.1450]}
= max{9.7200, 9.9990}
= 9.9990
and finally at time period 𝑛= 0 (i.e., 𝑡= 0) where early exercise is not allowed
𝑉(0)
0
= 𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]
= 𝑒−0.01
3 [0.5065 × 9.9990 + 0.4935 × 2.7183]
= 6.3847.

3.2.3 Time-Dependent Options
331
Therefore, the price of the Bermudan call option based on a 3-period binomial model
is 𝑉(0)
0
= 6.3847.
13. One-Touch Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on
the probability space (Ω, ℱ, ℙ) and at time 𝑡, let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
A one-touch call option is an American digital call option 𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) that pays $1
at the expiry time 𝑇if the underlying asset price 𝑆𝑢, 𝑡≤𝑢≤𝑇is above the strike value 𝐾.
If the underlying asset value has not reached the strike price by 𝑇then the option expires
worthless.
As long as the option is not exercised then for 0 < 𝑆𝑡< 𝐾, 𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the
Black–Scholes equation
𝜕𝐶𝑑
𝑎𝑚
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑑
𝑎𝑚
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑑
𝑎𝑚
𝜕𝑆𝑡
−𝑟𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary conditions
𝐶𝑑
𝑎𝑚(0, 𝑡; 𝐾, 𝑇) = 0,
𝐶𝑑
𝑎𝑚(𝐾, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡),
𝐶𝑑
𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 1I{𝑆𝑇≥𝐾}.
By writing the solution of 𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) in the form
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) are the European digital call and put options
satisfying
𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
find the Black–Scholes equation for 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) together with its corresponding bound-
ary conditions for 0 < 𝑆𝑡< 𝐾.
Writing 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝐵(𝑥, 𝜏) where 𝑥= log
(𝑆𝑡
𝐾
)
and 𝜏= 1
2𝜎2(𝑇−𝑡),
show that by setting
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0

332
3.2.3 Time-Dependent Options
where 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 , the Black–Scholes equation for 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) is
reduced to a heat equation of the form
𝜕𝐵
𝜕𝜏= 𝜕2𝐵
𝜕𝑥2
𝐵(𝑥, 0) = 𝑓(𝑥),
𝐵(0, 𝜏) = 0, 𝑥< 0.
Given that the solution of the heat equation is
𝐵(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
0
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧−
1
2
√
𝜋𝜏∫
∞
0
𝑓(−𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧
deduce that for 0 < 𝑆𝑡< 𝐾
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝑃𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where
𝐶𝑑
𝑏𝑠
(𝑋𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log (𝑋𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑
𝑏𝑠
(𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log (𝑌𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
is the standard normal cumulative density.
Solution:
Given
that
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) we can therefore express
𝜕𝐶𝑑
𝑎𝑚
𝜕𝑡
=
𝜕𝐶𝑑
𝑏𝑠
𝜕𝑡
+
𝜕𝑃𝑑
𝑏𝑠
𝜕𝑡
+ 𝜕𝑉
𝜕𝑡
𝜕𝐶𝑑
𝑎𝑚
𝜕𝑆𝑡
=
𝜕𝐶𝑑
𝑏𝑠
𝜕𝑆𝑡
+
𝜕𝑃𝑑
𝑏𝑠
𝜕𝑆𝑡
+ 𝜕𝑉
𝜕𝑆𝑡

3.2.3 Time-Dependent Options
333
and
𝜕2𝐶𝑑
𝑎𝑚
𝜕𝑆2
𝑡
=
𝜕2𝐶𝑑
𝑏𝑠
𝜕𝑆2
𝑡
+
𝜕2𝑃𝑑
𝑏𝑠
𝜕𝑆2
𝑡
+ 𝜕2𝑉
𝜕𝑆2
𝑡
.
By substituting the above expressions into the Black–Scholes equation for 𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and taking note that
𝜕𝐶𝑑
𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑑
𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑑
𝑏𝑠
𝜕𝑆𝑡
−𝑟𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
0 < 𝑆𝑡< 𝐾
and
𝜕𝑃𝑑
𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃𝑑
𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃𝑑
𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
0 < 𝑆𝑡< 𝐾
we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
0 < 𝑆𝑡< 𝐾
with boundary conditions
𝑉(0, 𝑡; 𝐾, 𝑇) = 0,
𝑉(𝐾, 𝑡; 𝐾, 𝑇) = 0,
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = −1I{𝑆𝑇<𝐾}
since
𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
and
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 𝐶𝑎𝑚(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑑
𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝑃𝑑
𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇)
= 1I{𝑆𝑇≥𝐾} −1.
Given that 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝐵(𝑥, 𝜏) where 𝑥= log
(𝑆𝑡
𝐾
)
and 𝜏= 1
2𝜎2(𝑇−𝑡), we
have
𝜕𝑉
𝜕𝑡= 𝜕𝑉
𝜕𝜏⋅𝜕𝜏
𝜕𝑡= −1
2𝜎2𝑒𝛼𝑥+𝛽𝜏[𝜕𝐵
𝜕𝜏+ 𝛽𝐵(𝑥, 𝜏)
]
𝜕𝑉
𝜕𝑆𝑡
= 𝜕𝑉
𝜕𝑥⋅𝜕𝑥
𝜕𝑆𝑡
= 𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[𝜕𝐵
𝜕𝑥+ 𝛼𝐵(𝑥, 𝜏)
]

334
3.2.3 Time-Dependent Options
and
𝜕2𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
{
𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[
𝛼𝐵(𝑥, 𝜏) + 𝜕𝐵
𝜕𝑥
]}
= 𝑒𝛼𝑥+𝛽𝜏
𝑆2
𝑡
[
𝜕2𝐵
𝜕𝑥2 + (2𝛼−1)𝜕𝐵
𝜕𝑥+ 𝛼(𝛼−1)𝐵(𝑥, 𝜏)
]
.
Substituting the above expressions into the Black–Scholes equation for 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) we
eventually have
1
2𝜎2 ( 𝜕𝐵
𝜕𝑥2 −𝜕𝐵
𝜕𝜏
)
+ 𝜕𝐵
𝜕𝑥
[1
2𝜎2(2𝛼−1) + 𝑟−𝐷
]
+𝐵
[1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟
]
= 0
and to eliminate the terms 𝜕𝐵
𝜕𝑥and 𝐵we set
1
2𝜎2(2𝛼−1) + 𝑟−𝐷= 0
1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟= 0.
By solving the equations simultaneously we have
𝛼= −1
2𝑘1
and
𝛽= −1
4𝑘2
1 −𝑘0
where 𝑘1 = 𝑟−𝐷
1
2𝜎2 −1 and 𝑘0 =
𝑟
1
2𝜎2 .
Hence,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−1
2 𝑘1𝑥−( 1
4 𝑘2
1+𝑘0)𝜏𝐵(𝑥, 𝜏)
with boundary conditions
𝐵(𝑥, 0) = 𝑒
1
2 𝑘1𝑥𝑉(𝐾𝑒𝑥, 𝑇; 𝐾, 𝑇) = −𝑒
1
2 𝑘1𝑥,
𝑥< 0
and
𝐵(0, 𝜏) = 0.
By setting 𝑓(𝑥) = −𝑒
1
2 𝑘1𝑥and since
𝐵(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
0
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧−
1
2
√
𝜋𝜏∫
∞
0
𝑓(−𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧

3.2.3 Time-Dependent Options
335
we first let
𝐵1(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
0
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧
= −𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
∫
0
−∞
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑧−(𝑥+𝑘1𝜏)
√
2𝜏
)2
𝑑𝑧
= −𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
∫
−𝑥−𝑘1𝜏
√
2𝜏
−∞
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= −𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
−𝑥−𝑘1𝜏
√
2𝜏
)
.
In contrast,
𝐵2(𝑥, 𝜏) = −
1
2
√
𝜋𝜏∫
∞
0
𝑓(−𝑧)𝑒−(𝑥−𝑧)2∕4𝜏𝑑𝑧
= 𝑒
(𝑥−𝑘1𝜏)2−𝑥2
4𝜏
∫
∞
0
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑧−(𝑥−𝑘1𝜏)
√
2𝜏
)2
𝑑𝑧
= 𝑒
(𝑥−𝑘1𝜏)2−𝑥2
4𝜏
∫
∞
−𝑥−𝑘1𝜏
√
2𝜏
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑒
(𝑥−𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
𝑥−𝑘1𝜏
√
2𝜏
)
.
Thus,
𝐵(𝑥, 𝜏) = 𝐵1(𝑥, 𝜏) + 𝐵2(𝑥, 𝜏)
= −𝑒
(𝑥+𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
−𝑥−𝑘1𝜏
√
2𝜏
)
+ 𝑒
(𝑥−𝑘1𝜏)2−𝑥2
4𝜏
Φ
(
𝑥−𝑘1𝜏
√
2𝜏
)
such that
𝐵(0, 𝜏) = −𝑒𝑘2
1𝜏2Φ
(
−𝑘1𝜏
√
2𝜏
)
+ 𝑒𝑘2
1𝜏2Φ
(
−𝑘1𝜏
√
2𝜏
)
= 0.
Hence,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝐵(𝑥, 𝜏)
= −𝑒𝑘0𝜏Φ
(
−𝑥−𝑘1𝜏
√
2𝜏
)
+ 𝑒−𝑘1𝑥−𝑘0𝜏Φ
(
𝑥−𝑘1𝜏
√
2𝜏
)

336
3.2.3 Time-Dependent Options
= −𝑒−𝑟(𝑇−𝑡)Φ
(−log (𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+
(𝑆𝑡
𝐾
)2𝛼
𝑒−𝑟(𝑇−𝑡)Φ
(−log (𝐾∕𝑆𝑡
) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= −𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝑃𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
.
Therefore, for 0 < 𝑆𝑡< 𝐾the one-touch call option is
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝑃𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
.
N.B. Using the same principles we can also show that for 𝐾< 𝑆𝑡< ∞, the one-touch put
option price is
𝑃𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝐶𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
.
14. One-Touch Option (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and at time 𝑡, let the asset price 𝑆𝑡follow a
GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
A one-touch call option is an American digital call option 𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) that pays $1
at the expiry time 𝑇if the underlying asset price 𝑆𝑢, 𝑡≤𝑢≤𝑇is above the strike value 𝐾.
If the underlying asset value has not reached the strike price by 𝑇then the option expires
worthless.
Show that under the risk-neutral measure ℚ, for 0 < 𝑆𝑡< 𝐾the option price at time 𝑡
can be written as
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)ℚ
(
max
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐾||||
ℱ𝑡
)
where 𝑟is the risk-free interest rate.

3.2.3 Time-Dependent Options
337
By finding the running maximum of 𝑆𝑢, 𝑡≤𝑢≤𝑇show that the one-touch call option
price has a closed-form solution given as
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝑃𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where 0 < 𝑆𝑡< 𝐾, 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
, 𝐶𝑑
𝑏𝑠(𝑋𝑡, 𝑡; 𝐾, 𝑇) and 𝑃𝑑
𝑏𝑠(𝑌𝑡, 𝑡; 𝐾, 𝑇) are the
European digital call and put options defined as
𝐶𝑑
𝑏𝑠
(𝑋𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑
𝑏𝑠
(𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑌𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
is the standard normal cumulative density.
Solution: Since the option is an American digital call with payout at time 𝑇then for non-
early exercise time we would require 0 < 𝑆𝑡< 𝐾. Hence, under the risk-neutral measure
ℚthe one-touch call option price at time 𝑡becomes
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐾}
|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)ℚ
(
max
𝑡≤𝑢≤𝑇𝑆𝑢≥𝐾
||||
ℱ𝑡
)
such that
𝐶𝑑
𝑎𝑚(𝐾, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡).
From Girsanov’s theorem, under the risk-neutral measure ℚwe can easily show that 𝑆𝑡
follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡

338
3.2.3 Time-Dependent Options
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It̄o’s lemma we can
show that for 𝑡< 𝑇
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡= 𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
where ̂
𝑊𝑇−𝑡= 𝜈(𝑇−𝑡) + 𝑊ℚ
𝑇−𝑡and 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2).
By writing
𝑀𝑇−𝑡= max
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡
therefore
max
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆𝑡𝑒𝜎𝑀𝑇−𝑡.
By substituting the above expression into the option price we have
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)ℚ
(
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡≥𝐾||| ℱ𝑡
)
= 𝑒−𝑟(𝑇−𝑡) [
1 −ℚ
(
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡≤𝐾||| ℱ𝑡
)]
= 𝑒−𝑟(𝑇−𝑡)
[
1 −ℚ
(
𝑀𝑇−𝑡≤1
𝜎log
(
𝐾
𝑆𝑡
)|||||
ℱ𝑡
)]
.
From Problem 4.2.2.15 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus we can show that
ℚ
(
𝑀𝑇−𝑡≤1
𝜎log( 𝐾
𝑆𝑡
)||||
ℱ𝑡
)
= Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
−
(𝑆𝑡
𝐾
)−2𝜈
𝜎
Φ
⎛
⎜
⎜
⎜⎝
−1
𝜎log(𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
Hence,
𝐶𝑑
𝑎𝑚(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
[
1 −Φ
(log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
+
(𝑆𝑡
𝐾
)2𝛼
𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
−log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠

3.2.3 Time-Dependent Options
339
= 𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
+
(𝑆𝑡
𝐾
)2𝛼
𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= 𝐶𝑑
𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐾
)2𝛼
𝑃𝑑
𝑏𝑠
(
𝐾2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
15. Immediate-Touch Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and at time 𝑡, let the asset price 𝑆𝑡follow a GBM
with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
An immediate-touch call option is an American digital call option 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) that
immediately pays $1 if the underlying asset price 𝑆𝑢, 𝑡≤𝑢≤𝑇is above the strike value
𝐾where 𝑇is the expiry time. If the underlying asset value has not reached the strike price
by 𝑇then the option expires worthless, that is 𝐶𝑑(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 0, 0 < 𝑆𝑇< 𝐾.
As long as the option is not exercised then for 0 < 𝑆𝑡< 𝐾, 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the
Black–Scholes equation
𝜕𝐶𝑑
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶𝑑
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶𝑑
𝜕𝑆𝑡
−𝑟𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary conditions
𝐶𝑑(0, 𝑡; 𝐾, 𝑇) = 0,
𝐶𝑑(𝐾, 𝑡; 𝐾, 𝑇) = 1.
By writing the solution of 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) in the form
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶∞(𝑆𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝐶∞(𝑆𝑡) satisfies the perpetual call problem
1
2𝜎2𝑆2
𝑡
𝑑2𝐶∞
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝐶∞
𝑑𝑆𝑡
−𝑟𝐶∞(𝑆𝑡) = 0

340
3.2.3 Time-Dependent Options
with boundary conditions
𝐶∞(0) = 0,
𝐶∞(𝐾) = 1
find 𝐶∞(𝑆𝑡) by solving the second-order ODE.
For 0 < 𝑆𝑡< 𝐾find the Black–Scholes equation for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) together with its
corresponding boundary conditions.
Writing 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝐵(𝑥, 𝜏) where 𝑥= log
(𝑆𝑡
𝐾
)
and 𝜏= 1
2𝜎2(𝑇−𝑡) show
that by setting
𝛼= −1
2(𝑘−1)
and
𝛽= −1
4(𝑘+ 1)2 −𝑘′
where 𝑘= 𝑟−𝐷
1
2𝜎2 and 𝑘′ =
𝐷
1
2𝜎2 , the Black–Scholes equation for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) is reduced
to a heat equation of the form
𝜕𝐵
𝜕𝜏= 𝜕2𝐵
𝜕𝑥2
𝐵(𝑥, 0) = 𝑓(𝑥),
𝐵(0, 𝜏) = 0,
𝑥< 0.
Given that the solution of the heat equation with the above boundary conditions is
𝐵(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
0
−∞
𝑓(𝑦)𝑒−(𝑥−𝑦)2∕4𝜏𝑑𝑦−
1
2
√
𝜋𝜏∫
∞
0
𝑓(−𝑦)𝑒−(𝑥−𝑦)2∕4𝜏𝑑𝑦
deduce that for 0 < 𝑆𝑡< 𝐾
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐾
)𝜆−
Φ(𝑑−)
where
𝜆± =
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
𝑑± =
log(𝑆𝑡∕𝐾) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
is the standard normal cdf.

3.2.3 Time-Dependent Options
341
Solution: Given that 𝐶∞(𝑆𝑡) satisfies the perpetual call problem then from Problem 3.2.2.2
(page 294), the solution of the ODE is
𝐶(𝑆𝑡) = 𝐴𝑆𝜆+
𝑡
where 𝜆+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
> 0.
Since 𝐶∞(𝐾) = 1
𝐴= 𝐾−𝜆+
and hence
𝐶∞(𝑆𝑡) =
(𝑆𝑡
𝐾
)𝜆+
.
Since 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶∞(𝑆𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) we can write
𝜕𝐶𝑑
𝜕𝑡
= 𝜕𝐶
𝜕𝑆𝑡
,
𝜕𝐶𝑑
𝜕𝑆𝑡
= 𝑑𝐶∞
𝑑𝑆𝑡
+ 𝜕𝐶
𝜕𝑆𝑡
,
𝜕2𝐶𝑑
𝜕𝑆2
𝑡
= 𝑑2𝐶∞
𝑑𝑆2
𝑡
+ 𝜕2𝐶
𝜕𝑆2
𝑡
and by substituting them into the Black–Scholes equation for 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) and taking
note that
1
2𝜎2𝑆2
𝑡
𝑑2𝐶∞
𝑑𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝑑𝐶∞
𝑑𝑆𝑡
−𝑟𝐶∞(𝑆𝑡) = 0
we have
𝜕𝐶
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0,
0 < 𝑆𝑡< 𝐾
with boundary conditions
𝐶(0, 𝑡; 𝐾, 𝑇) = 0,
𝐶(𝐾, 𝑡; 𝐾, 𝑇) = 0,
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = −
(𝑆𝑇
𝐾
)𝜆+
,
0 < 𝑆𝑇< 𝐾.
Given that 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝛼𝑥+𝛽𝜏𝐵(𝑥, 𝜏) where 𝑥= log
(𝑆𝑡
𝐾
)
and 𝜏= 1
2𝜎2(𝑇−𝑡) we
have
𝜕𝐶
𝜕𝑡= 𝜕𝐶
𝜕𝜏⋅𝜕𝜏
𝜕𝑡= −1
2𝜎2𝑒𝛼𝑥+𝛽𝜏[𝜕𝐵
𝜕𝜏+ 𝛽𝐵(𝑥, 𝜏)
]
𝜕𝐶
𝜕𝑆𝑡
= 𝜕𝐶
𝜕𝑥⋅𝜕𝑥
𝜕𝑆𝑡
= 𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[𝜕𝐵
𝜕𝑥+ 𝛼𝐵(𝑥, 𝜏)
]

342
3.2.3 Time-Dependent Options
and
𝜕2𝐶
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
{
𝑒𝛼𝑥+𝛽𝜏
𝑆𝑡
[
𝛼𝐵(𝑥, 𝜏) + 𝜕𝐵
𝜕𝑥
]}
= 𝑒𝛼𝑥+𝛽𝜏
𝑆2
𝑡
[
𝜕2𝐵
𝜕𝑥2 + (2𝛼−1)𝜕𝐵
𝜕𝑥+ 𝛼(𝛼−1)𝐵(𝑥, 𝜏)
]
.
By substituting the above expressions into the Black–Scholes equation for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
we eventually have
1
2𝜎2 ( 𝜕𝐵
𝜕𝑥2 −𝜕𝐵
𝜕𝜏
)
+ 𝜕𝐵
𝜕𝑥
[1
2𝜎2(2𝛼−1) + 𝑟−𝐷
]
+𝐵
[1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟
]
= 0.
To eliminate the terms 𝜕𝐵
𝜕𝑥and 𝐵we set
1
2𝜎2(2𝛼−1) + 𝑟−𝐷= 0
1
2𝜎2[𝛼(𝛼−1) −𝛽] + 𝛼(𝑟−𝐷) −𝑟= 0.
By solving the equations simultaneously we have
𝛼= −1
2(𝑘−1)
and
𝛽= −1
4(𝑘+ 1)2 −𝑘′
where 𝑘= 𝑟−𝐷
1
2𝜎2 and 𝑘′ =
𝐷
1
2𝜎2 .
Hence,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−1
2 (𝑘−1)𝑥−1
4 (𝑘+1)2𝜏−𝑘′𝜏𝐵(𝑥, 𝜏)
with boundary conditions
𝐵(𝑥, 0) = 𝑒
1
2 (𝑘−1)𝑥𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = −𝑒
1
2 (𝑘−1)𝑥(𝐾𝑒𝑥
𝐾
)𝜆+ = −𝑒
1
2 (𝑘−1+2𝜆+)𝑥,
𝑥< 0
and
𝐵(0, 𝜏) = 0.
By setting 𝑓(𝑥) = −𝑒
1
2 (𝑘−1+2𝜆+) then
𝐵(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
0
−∞
𝑓(𝑦)𝑒−(𝑥−𝑦)2∕4𝜏𝑑𝑦−
1
2
√
𝜋𝜏∫
∞
0
𝑓(−𝑦)𝑒−(𝑥−𝑦)2∕4𝜏𝑑𝑦
= 𝐵1(𝑥, 𝜏) + 𝐵2(𝑥, 𝜏)

3.2.3 Time-Dependent Options
343
where
𝐵1(𝑥, 𝜏) = −
1
2
√
𝜋𝜏∫
0
−∞
𝑒
−1
2
(
𝑥−𝑦
√
2𝜏
)2
+ 1
2 (𝑘−1+2𝜆+)𝑦
𝑑𝑦
and
𝐵2(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
0
𝑒
−1
2
(
𝑥−𝑦
√
2𝜏
)2
−1
2 (𝑘−1+2𝜆+)𝑦
𝑑𝑦.
For the case 𝐵1(𝑥, 𝜏) we have
𝐵1(𝑥, 𝜏) = −
1
2
√
𝜋𝜏∫
0
−∞
𝑒
−1
2
(
𝑥−𝑦
√
2𝜏
)2
+ 1
2 (𝑘−1+2𝜆+)𝑦
𝑑𝑦
= −𝑒
(𝑥+(𝑘−1+2𝜆+)𝜏)2−𝑥2
4𝜏
∫
0
−∞
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑦−(𝑥+(𝑘−1+2𝜆+)𝜏)
√
2𝜏
)2
= −𝑒
1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2
∫
−
(
𝑥+(𝑘−1+2𝜆+)𝜏
√
2𝜏
)
−∞
1
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧
= −𝑒
1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2 (Φ(𝑑+) −1)
where 𝑑+ = 𝑥+ 𝜏(𝑘−1 + 2𝜆+)
√
2𝜏
.
For the case 𝐵2(𝑥, 𝜏), using similar techniques we have
𝐵2(𝑥, 𝜏) =
1
2
√
𝜋𝜏∫
∞
0
𝑒
−1
2
(
𝑥−𝑦
√
2𝜏
)2
−1
2 (𝑘−1+2𝜆+)𝑦
𝑑𝑦
= 𝑒−𝑥2−(𝑥+(𝑘−1+2𝜆+)𝜏)2
4𝜏
∫
∞
0
1
2
√
𝜋𝜏
𝑒
−1
2
(
𝑦−(𝑥−(𝑘−1+2𝜆+)𝜏)
√
2𝜏
)2
𝑑𝑦
= 𝑒−1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2
∫
∞
(𝑘−1+2𝜆+)𝜏−𝑥
√
2𝜏
1
√
2𝜋
𝑒−1
2 𝑧2𝑑𝑧
= 𝑒−1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2Φ(𝑑−)
where 𝑑−= 𝑥−𝜏(𝑘−1 + 2𝜆+)
2
√
𝜏
.

344
3.2.3 Time-Dependent Options
Thus,
𝐵(𝑥, 𝜏) = 𝐵1(𝑥, 𝜏) + 𝐵2(𝑥, 𝜏)
= −𝑒
1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2 (Φ(𝑑+) −1)
+𝑒−1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2Φ(𝑑−)
where
𝐵(0, 𝜏) = −𝑒
1
4 𝜏(𝑘−1+2𝜆+)2
[
Φ
(
(𝑘−1 + 2𝜆+)𝜏
√
2𝜏
)
−1
]
+𝑒
1
4 𝜏(𝑘−1+2𝜆+)2Φ
(
−(𝑘−1 + 2𝜆+)𝜏
√
2𝜏
)
= 0.
Therefore, we can write
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−1
2 (𝑘−1)𝑥−1
4 (𝑘+1)2𝜏−𝑘′𝜏𝐵(𝑥, 𝜏)
= 𝑒−1
2 (𝑘−1)𝑥−1
4 (𝑘+1)2𝜏−𝑘′𝜏[
𝑒−1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2Φ(𝑑−)
]
−𝑒−1
2 (𝑘−1)𝑥−1
4 (𝑘+1)2𝜏−𝑘′𝜏[
𝑒
1
2 𝑥(𝑘−1+2𝜆+)+ 1
4 𝜏(𝑘−1+2𝜆+)2 (Φ(𝑑+) −1)]
= 𝑒−𝑥(𝑘−1+𝜆+)Φ(𝑑−) + 𝑒𝑥𝜆+ (Φ(𝑑+) −1) .
By substituting 𝜆+ =
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
, 𝑥= log
(𝑆𝑡
𝐾
)
, 𝜏=
1
2𝜎2(𝑇−𝑡) and 𝑘= 𝑟−𝐷
1
2𝜎2 we have
𝑑± =
log(𝑆𝑡∕𝐾) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
,
𝑒−𝑥(𝑘−1+𝜆+) =
(𝑆𝑡
𝐾
)𝜆−
and
𝑒𝑥𝜆+ =
(𝑆𝑡
𝐾
)𝜆+
where 𝜆−=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.

3.2.3 Time-Dependent Options
345
Therefore, for 0 < 𝑆𝑡< 𝐾
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+ (Φ(𝑑+) −1) +
(𝑆𝑡
𝐾
)𝜆−
Φ(𝑑−)
and because 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶∞(𝑆𝑡) + 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) thus
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐾
)𝜆−
Φ(𝑑−),
0 < 𝑆𝑡< 𝐾.
N.B. Using similar steps we can also show the immediate-touch put option to be
𝑃𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+
Φ(−𝑑+) +
(𝑆𝑡
𝐾
)𝜆−
Φ(−𝑑−)
for 𝑆𝑡> 𝐾.
16. Immediate-Touch Option (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ) and at time 𝑡, let the asset price 𝑆𝑡
follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
By setting 𝜏= inf{𝑡≥0 : 𝑊𝑡= 𝑎+ 𝑏𝑡} as the first-passage time of hitting the slope
𝑎+ 𝑏𝑡where 𝑎, 𝑏∈ℝ, show that the pdf is
𝑓𝜏(𝑡) =
|𝑎|
𝑡
√
2𝜋𝑡
𝑒−1
2𝑡(𝑎+𝑏𝑡)2.
An immediate-touch call option is an American digital call option 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) that
immediately pays $1 if the underlying asset price 𝑆𝑢, 𝑡≤𝑢≤𝑇is above the strike value
𝐾where 𝑇is the expiry time. If the underlying asset value has not reached the strike price
by 𝑇then the option expires, worthless, that is 𝐶𝑑(𝑆𝑇, 𝑇; 𝐾, 𝑇) = 0, 0 < 𝑆𝑇< 𝐾.
Under the risk-neutral measure ℚshow that
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ∫
𝑇−𝑡
0
𝑒−𝑟𝑣𝑓ℚ
𝜏(𝑣) 𝑑𝑣
where 𝜏= inf {𝑡≥0 : 𝑊ℚ
𝑡
= 𝑤−𝜃𝑡}, 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener
process, 𝑤= 1
𝜎log
(
𝐾
𝑆𝑡
)
, 𝜃= 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
and 𝑓ℚ
𝜏(𝑡) is the pdf of 𝜏under the ℚ
measure.

346
3.2.3 Time-Dependent Options
By setting 𝛼= 𝜎𝜃and 𝛽2 = 𝛼2 + 2𝜎2𝑟show that we can write
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(
𝐾
𝑆𝑡
) 𝛼±𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡±𝛽𝑣
)]
𝑑𝑣.
Taking partial fractions of the form
log (𝐾∕𝑆𝑡
)
𝜎
√
𝑡
=
log (𝐾∕𝑆𝑡
) −𝛽𝑡
2𝜎
√
𝑡
+
log (𝐾∕𝑆𝑡
) + 𝛽𝑡
2𝜎
√
𝑡
and by choosing appropriate integrands, show that for 0 < 𝑆𝑡< 𝐾
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐾
)𝜆−
Φ(𝑑−)
where
𝜆± =
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
𝑑± =
log(𝑆𝑡∕𝐾) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
and
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
is the standard normal cumulative density.
Solution: In order to show that
𝑓𝜏(𝑡) =
|𝑎|
𝑡
√
2𝜋𝑡
𝑒−1
2𝑡(𝑎+𝑏𝑡)2
which is the first-passage time density of a standard Wiener process hitting a slope, see
Problem 4.2.2.16 of Problems and Solutions in Mathematical Finance, Volume 1: Stochas-
tic Calculus.
From Girsanov’s theorem, under the risk-neutral measure ℚthe SDE for the asset price
is
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡

3.2.3 Time-Dependent Options
347
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Hence, using It¯o’s lemma
for 𝑢> 𝑡we can write
𝑆𝑢= 𝑆𝑡𝑒𝜎̂
𝑊𝑢−𝑡
where ̂
𝑊𝑢−𝑡= 𝑊ℚ
𝑢−𝑡+ 𝜃(𝑢−𝑡), 𝜃= 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
.
By definition the immediate-touch call option price is
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ
(
max
𝑡≤𝑢≤𝑇𝑒−𝑟(𝑢−𝑡)1I{𝑆𝑢≥𝐾}
||||
ℱ𝑡
)
= 𝔼ℚ
(
max
𝑡≤𝑢≤𝑇𝑒−𝑟(𝑢−𝑡)1I{𝑆𝑡𝑒𝜎̂
𝑊𝑢−𝑡≥𝐾}
||||
ℱ𝑡
)
= 𝔼ℚ
(
max
𝑡≤𝑢≤𝑇𝑒−𝑟(𝑢−𝑡)1I{̂
𝑊𝑢−𝑡≥1
𝜎log
( 𝐾
𝑆𝑡
)
}
|||||
ℱ𝑡
)
.
Since
{
max
𝑡≤𝑢≤𝑇𝑆𝑢≥𝐾
}
⇔
{
max
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡≥1
𝜎log
(
𝐾
𝑆𝑡
)}
⇔{𝜏≤𝑇}
where
𝜏= inf
{
𝑢≥𝑡: ̂
𝑊𝑢−𝑡= 1
𝜎log
(
𝐾
𝑆𝑡
)}
therefore
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ(
𝑒−𝑟(𝜏−𝑡)1I{𝜏≤𝑇}||| ℱ𝑡
)
= ∫
𝑇
𝑡
𝑒−𝑟(𝑢−𝑡)𝑓ℚ
𝜏(𝑢) 𝑑𝑢
where
𝑓ℚ
𝜏(𝑢) =
𝑤
(𝑢−𝑡)
√
2𝜋(𝑢−𝑡)
𝑒−
1
2(𝑢−𝑡) (𝑤−𝜃(𝑢−𝑡))2
,
𝑤= 1
𝜎log
(
𝐾
𝑆𝑡
)
and
𝜃= 1
𝜎
(
𝑟−𝐷−1
2𝜎2)
.
By letting 𝑣= 𝑢−𝑡we can write
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ∫
𝑇−𝑡
0
𝑒−𝑟𝑣
𝑤
𝑣
√
2𝜋𝑣
𝑒−1
2𝑣(𝑤−𝜃𝑣)2𝑑𝑣.

348
3.2.3 Time-Dependent Options
Thus, by substituting 𝛼= 𝜎𝜃= 𝑟−𝐷−1
2𝜎2, 𝜎𝑤= log
(
𝐾
𝑆𝑡
)
, 𝛽2 = 𝛼2 + 2𝑟𝜎2
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) = ∫
𝑇−𝑡
0
𝑒−𝑟𝑣log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
−𝛼𝑣
]2
𝑑𝑣
=
(
𝐾
𝑆𝑡
) 𝛼
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[{
log
( 𝐾
𝑆𝑡
)}2
+(𝛼2+2𝑟𝜎2)𝑣2
]
𝑑𝑣
=
(
𝐾
𝑆𝑡
) 𝛼
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[{
log
( 𝐾
𝑆𝑡
)}2
+𝛽2𝑣2
]
𝑑𝑣
=
(
𝐾
𝑆𝑡
) 𝛼
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
{[
log
( 𝐾
𝑆𝑡
)
±𝛽𝑣
]2
∓2𝛽𝑣log
( 𝐾
𝑆𝑡
)}
𝑑𝑣
=
(
𝐾
𝑆𝑡
) 𝛼±𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡)
𝜎𝑣
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
±𝛽𝑣
]2
𝑑𝑣.
By setting
log(𝐾∕𝑆𝑡)
𝜎
√
𝑣
= log(𝐾∕𝑆𝑡) −𝛽𝑣
2𝜎
√
𝑣
+ log(𝐾∕𝑆𝑡) + 𝛽𝑣
2𝜎
√
𝑣
we have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(
𝐾
𝑆𝑡
) 𝛼±𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡) −𝛽𝑣
2𝜎
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
±𝛽𝑣
]2
𝑑𝑣
+
(
𝐾
𝑆𝑡
) 𝛼±𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡) + 𝛽𝑣
2𝜎
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
±𝛽𝑣
]2
𝑑𝑣.
Hence, by selecting
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(
𝐾
𝑆𝑡
) 𝛼+𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡) −𝛽𝑣
2𝜎
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
+𝛽𝑣
]2
𝑑𝑣
+
(
𝐾
𝑆𝑡
) 𝛼−𝛽
𝜎2
∫
𝑇−𝑡
0
log(𝐾∕𝑆𝑡) + 𝛽𝑣
2𝜎
√
2𝜋𝑣
𝑒
−
1
2𝜎2𝑣
[
log
( 𝐾
𝑆𝑡
)
−𝛽𝑣
]2
𝑑𝑣
and by setting
𝑥= log(𝐾∕𝑆𝑡) + 𝛽𝑣
2𝜎
√
2𝜋𝑣
and
𝑦= log(𝐾∕𝑆𝑡) −𝛽𝑣
2𝜎
√
2𝜋𝑣

3.2.3 Time-Dependent Options
349
we eventually have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(
𝐾
𝑆𝑡
) 𝛼+𝛽
𝜎2
∫
−log(𝐾∕𝑆𝑡)−𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
−∞
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥
+
(
𝐾
𝑆𝑡
) 𝛼−𝛽
𝜎2
∫
−log(𝐾∕𝑆𝑡)+𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
−∞
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
=
(
𝐾
𝑆𝑡
) 𝛼+𝛽
𝜎2
Φ
(
log(𝑆𝑡∕𝐾) −𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+
(
𝐾
𝑆𝑡
) 𝛼−𝛽
𝜎2
Φ
(
log(𝑆𝑡∕𝐾) + 𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
=
(𝑆𝑡
𝐾
)−
( 𝛼−𝛽
𝜎2
)
Φ
(
log(𝑆𝑡∕𝐾) + 𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+
(𝑆𝑡
𝐾
)−
( 𝛼+𝛽
𝜎2
)
Φ
(
log(𝑆𝑡∕𝐾) −𝛽(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
.
By substituting 𝛼= 𝑟−𝐷−1
2𝜎2 and 𝛽=
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝑟𝜎2 we have, for
0 < 𝑆𝑡< 𝐾
𝐶𝑑(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
(𝑆𝑡
𝐾
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐾
)𝜆−
Φ(𝑑−)
where
𝜆± =
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
and
𝑑± =
log(𝑆𝑡∕𝐾) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
.


4
Barrier Options
In the last two chapters we have concentrated solely on European and American options which
have a fixed strike and expiry date but different styles of exercise rights. In financial circles,
these two types of derivatives are known as vanilla options, with the former also known as
Black–Scholes options. In this chapter we will discuss barrier options, which are one of the
most popular traded options that belong to a family of derivatives known as exotic options.
Basically, an exotic option is a type of option which is neither a European nor an American
option. Although they may have either European or American-style payoffs, exotic options
have additional features that trigger the payoffs. The simplest exotic options are the digital
and asset-or-nothing options which we have come across in Chapter 2. Another important
difference between exotic options and vanilla options is that unlike vanilla options which are
traded on major exchanges such as the Chicago Board Options Exchange, exotic options are
usually traded OTC (i.e., without any supervision of an exchange). Hence these options are
generally negotiated by brokers or dealers of the options’ sellers and buyers, as to how the
trades are to be settled in the future.
In finance, barrier options belong to a class of exotic options that can be terminated or
activated when the threshold or barrier is crossed. These options are usually written on volatile
stocks and given such a feature, barrier options are significantly cheaper than vanilla options.
Hence, by trading such an option, it provides investors with an alternative hedging strategy
without having to pay for the full vanilla price, which they believe is unlikely to occur in the
lifetime of the option contract. By making the barrier be a function of time or paying a rebate
when the barrier is triggered, there is a lot of flexibility for investors to express their view in the
stock price movements within the contract. In addition, the option can also be easily extended
to incorporate early-exercise features, but the solutions to such a problem usually depend on
numerical methods. In this chapter, unless otherwise stated, we only consider European-style
barrier options.
4.1
INTRODUCTION
Conceptually, barrier options are conditional options which are dependent on some barriers
being breached (or triggered) in their contractual lives. As these options are either activated or
deactivated when the asset price crosses a barrier, these options are path-dependent. However,
these options are also known as weakly path-dependent, since we only need to know whether
or not the barrier is triggered and we are not concerned about the asset price path.
Basically, there are two types of barrier options: knock-ins and knock-outs.
For a knock-in:
s If the option is an up-and-in barrier option, then the option is only active if the barrier
is hit from below the barrier. Note that the option remains worthless if the asset price does
not rise above the barrier. If at some point during the life of the option the barrier is hit,
then the option will turn into a European option.

352
4.1 INTRODUCTION
s If the option is a down-and-in barrier option, then the option is only active if the barrier
is hit from above the barrier. Note that the option remains worthless if the asset price does
not fall below the barrier. If at some point during the life of the option the barrier is hit,
then the option will turn into a European option.
For a knock-out:
s If the option is an up-and-out barrier option, then the option is only active if the asset
price is below the barrier. Here, the option becomes worthless if the asset price rises above
the barrier (or the barrier is hit from below).
s If the option is a down-and-out barrier option, then the option is only active if the asset
price is above the barrier. Here, the option becomes worthless if the asset price falls below
the barrier (or the barrier is hit from above).
In–Out Parity
Just like the European and American options have their put–call parities, the barrier options
have the in–out parity
𝑉𝑘∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑘∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where the sum of the knock-in option 𝑉𝑘∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and the knock-out option
𝑉𝑘∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) with the same asset price 𝑆𝑡, strike 𝐾, barrier 𝐵and expiry time 𝑇is the
same as the price of a European (Black–Scholes) option. From the above relationship, given
that knock-ins and knock-outs have positive payoffs and hence positive option price values,
we can immediately deduce that their option price values are less than the value of a European
option. This is not unexpected, since barrier options have fewer rights than European options
and thus they have a lower value.
By incorporating a rebate 𝑅payable at expiry 𝑇, we have the following property
𝑉𝑅
𝑘∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑘∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡)
where 𝑉𝑅
𝑘∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑘∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) are knock-in and knock-out options with
rebate 𝑅, respectively having the same asset price 𝑆𝑡, strike 𝐾, barrier 𝐵, expiry time 𝑇, and
𝑟is the constant risk-free interest rate.
In contrast, if the rebate 𝑅is payable at knock-out or knock-in time, the corresponding
in–out parity is
𝑉𝑅
𝑘∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑘∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅
[(𝑆𝑡
𝐵
)𝜆+
+
(𝑆𝑡
𝐵
)𝜆−]
where
𝜆± =
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.

4.1 INTRODUCTION
353
Barrier Options Pricing
Under the Black–Scholes methodology we can solve the pricing issues of barrier options using
both the probabilistic (martingale pricing) approach and partial differentiation equation (via
the reflection principle) approach.
Probabilistic Approach
In the same vein as the martingale pricing framework of European options, we can also price
barrier options via the risk-neutral expectation strategy. For instance, a knock-in barrier option
payoff can be written as
Ψ𝑘∕𝑖(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
Ψ(𝑆𝑇)1I{max𝑡≤𝑢≤𝑇𝑆𝑢≥𝐵}
up-and-in option
Ψ(𝑆𝑇)1I{min𝑡≤𝑢≤𝑇𝑆𝑢≤𝐵}
down-and-in option
whilst for a knock-out barrier option payoff
Ψ𝑘∕𝑜(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
Ψ(𝑆𝑇)1I{max𝑡≤𝑢≤𝑇𝑆𝑢<𝐵}
up-and-out option
Ψ(𝑆𝑇)1I{min𝑡≤𝑢≤𝑇𝑆𝑢>𝐵}
down-and-out option
where Ψ(𝑆𝑇) is the European option payoff at expiry time 𝑇.
In order to price this option we need to know the probability that the barrier will be triggered
and also the probability that the option is exercised at expiry time. Hence, this requires the joint
distribution of the Wiener process with drift (for the European option payoff) and its running
maximum (for up-and-in and up-and-out options) or running minimum (for down-and-in and
down-and-out options).
Without loss of generality, let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process and if 𝑋𝑡is a
Wiener process with drift 𝜇∈ℝin the form
𝑋𝑡= 𝜇𝑡+ 𝑊𝑡
and by defining
𝑀𝑋
𝑡
= max
0≤𝑠≤𝑡𝑋𝑠
to be the running maximum of the process 𝑋𝑡up to time 𝑡, the cdf of the running maximum
is
ℙ(𝑀𝑋
𝑡
≤𝑥) = Φ
(
𝑥−𝜇𝑡
√
𝑡
)
−𝑒2𝜇𝑥Φ
(
−𝑥−𝜇𝑡
√
𝑡
)
,
𝑥≥0

354
4.1 INTRODUCTION
where Φ(⋅) is the standard normal cdf. The joint density of (𝑀𝑋
𝑡, 𝑋𝑡) of the running maximum
and the Wiener process is
𝑓ℙ
𝑀𝑋
𝑡,𝑋𝑡(𝑥, 𝑦) = 2(2𝑥−𝑦)
𝑡
√
2𝜋𝑡
𝑒𝜇𝑦−1
2 𝜇2𝑡−1
2𝑡(2𝑥−𝑦)2,
𝑥≥0, 𝑥≥𝑦.
As for the running minimum of the process 𝑋𝑡up to time 𝑡,
𝑚𝑋
𝑡= min
0≤𝑠≤𝑡𝑋𝑠
the cdf of the running minimum is
ℙ(𝑚𝑋
𝑡≤𝑥) = Φ
(
𝑥−𝜇𝑡
√
𝑡
)
+ 𝑒2𝜇𝑥Φ
(
𝑥+ 𝜇𝑡
√
𝑡
)
,
𝑥≤0
with the joint density of (𝑚𝑋
𝑡, 𝑋𝑡) of the running minimum and the Wiener process
𝑓ℙ
𝑚𝑋
𝑡,𝑋𝑡(𝑥, 𝑦) = −2(2𝑥−𝑦)
𝑡
√
2𝜋𝑡
𝑒𝜇𝑦−1
2 𝜇2𝑡−1
2𝑡(2𝑥−𝑦)2,
𝑥≤0, 𝑥≤𝑦.
For the derivation of the above formulae, see Problem 4.2.2.14 of Problems and Solutions in
Mathematical Finance, Volume 1: Stochastic Calculus.
Partial Differentiation Equation Approach
In order to find the closed-form solutions of barrier options via the PDE method, we first
consider the reflected solution of the Black–Scholes equation.
Theorem 4.1 Suppose 𝑉(𝑆𝑡, 𝑡) satisfies the Black–Scholes equation (see below) with the asset
𝑆𝑡paying a continuous dividend yield 𝐷,
𝜕𝑉
𝜕𝑆𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
then for any constant 𝐵(representing a barrier)
𝑈(𝑆𝑡, 𝑡) =
(𝑆𝑡
𝐵
)2𝛼
𝑉
(
𝐵2
𝑆𝑡
, 𝑡
)
also satisfies the Black–Scholes equation provided that 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
. Note that 𝑆𝑡and
𝐵2∕𝑆𝑡are on opposite sides of the barrier 𝐵for 𝑆𝑡≠𝐵and coincide when 𝑆𝑡= 𝐵.

4.1 INTRODUCTION
355
Let us begin by focussing on the up-and-out barrier option and note that we can consider only
the knock-out options as the knock-in options’ prices can be obtained easily from the in–out
parity identity. If we consider the Black–Scholes equation for an asset 𝑆𝑡paying a continuous
dividend yield 𝐷, the up-and-out barrier option 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) with strike price 𝐾and
barrier 𝐵satisfies the PDE
𝜕𝑉𝑢∕𝑜
𝜕𝑆𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑢∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑢∕𝑜
𝜕𝑆𝑡
−𝑟𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
provided the following boundary conditions are satisfied
0 < 𝑆𝑡< 𝐵,
𝑡≤𝑇
𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = 0
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the European (Black–Scholes) payoff at expiry time 𝑇.
Given that the up-and-out barrier option has a European payoff at expiry 𝑇but becomes
worthless on the barrier 𝐵, we can deduce that
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
so that ̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the Black–Scholes equation
𝜕̃𝑉𝑢∕𝑜
𝜕𝑆𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̃𝑉𝑢∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̃𝑉𝑢∕𝑜
𝜕𝑆𝑡
−𝑟̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with truncated payoff
0 < 𝑆𝑡< 𝐵,
𝑡≤𝑇
̃𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇).
To account for the barrier, we therefore require ̂𝑉(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) to satisfy
̂𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0
at expiry time 𝑇and
̂𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇)
on the barrier 𝐵.

356
4.1 INTRODUCTION
To
find
the
solution
for
̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
we
note
that
since
(𝑆𝑡
𝐵
)2𝛼
̃𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
with 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
also satisfies the Black–Scholes
equation, we can thus set the solution of an up-and-out barrier option as
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̃𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
Since 𝑆𝑡and 𝐵2∕𝑆𝑡are on opposite sides of the barrier 𝐵for 𝑆𝑡≠𝐵, therefore
(𝑆𝑇
𝐵
)2𝛼
̃𝑉
(
𝐵2
𝑆𝑇
, 𝑡; 𝐾, 𝐵, 𝑇
)
= 0
for all 0 < 𝑆𝑇< 𝐵. Hence, one can easily check that the boundary conditions
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)
and
𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = 0
are satisfied. Using the in–out parity property, the up-and-in barrier option price
𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) at time 𝑡, 𝑡≤𝑇is
𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇).
Following the same arguments, the down-and-out barrier option at time 𝑡is
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̃𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
where ̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the following Black–Scholes equation
𝜕̃𝑉𝑑∕𝑜
𝜕𝑆𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̃𝑉𝑑∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̃𝑉𝑑∕𝑜
𝜕𝑆𝑡
−𝑟̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with truncated payoff
𝑆𝑡> 𝐵,
𝑡≤𝑇
̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇).
Finally, with the application of the in–out parity property, the down-and-in barrier option price
𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) at time 𝑡, 𝑡≤𝑇is
𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇).

4.2.1 Probabilistic Approach
357
4.2
PROBLEMS AND SOLUTIONS
4.2.1
Probabilistic Approach
1. Up-and-Out/Up-and-In Call Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on
the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, let 𝑟be the risk-free interest rate.
We consider a European up-and-out call option at time 𝑡, with expiry at time 𝑇> 𝑡,
strike 𝐾and constant barrier 𝐵> 𝐾.
Explain why, for an up-and-out call option, we require 𝑆𝑡< 𝐵and 𝐵> 𝐾, and show
that the terminal payoff can be written as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
where Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal, show that under the
risk-neutral measure ℚ, the up-and-out call option price at time 𝑡is
𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−[𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
−
(𝑆𝑡
𝐵
)2𝛼{
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
, 𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) and 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the vanilla and digital

358
4.2.1 Probabilistic Approach
call option prices defined as
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑋𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑌𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively. Hence, deduce that the European up-and-in call option price at time 𝑡is
𝐶𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+ (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
(𝑆𝑡
𝐵
)2𝛼[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
.
Solution: Since the option is an up-and-out call we require 𝑆𝑡for all 𝑡to be below the
barrier 𝐵, otherwise it knocks out. Furthermore, we require 𝐵> 𝐾for all time 𝑡, since if
𝐵≤𝐾the option is worthless as no asset path would give a non-zero payoff. Therefore,
the payoff of an up-and-out call option is
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It¯o’s lemma we can
easily show that for 𝑡< 𝑇
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡
= 𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
where ̂
𝑊𝑇−𝑡= 𝜈(𝑇−𝑡) + 𝑊ℚ
𝑇−𝑡and 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2). By writing
𝑀𝑇−𝑡= max
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡

4.2.1 Probabilistic Approach
359
therefore
max
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆𝑡𝑒𝜎𝑀𝑇−𝑡
and we can rewrite the payoff as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
= max
{
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾, 0
}
1I{
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡<𝐵
}
=
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡<𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡>𝐾
}
=
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐾
𝑆𝑡
)}.
Hence, the up-and-out call option price at time 𝑡is
𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐾
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
) ∫
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑚=𝑤
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
where
𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≥0, 𝑚≥𝑤
0
otherwise.
Refer to Problem 4.2.2.14 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus for a derivation of the above density function.

360
4.2.1 Probabilistic Approach
Hence,
𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= −𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
×
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2|||||||
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑚=𝑤
𝑑𝑤
=
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
−
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
= 𝑆𝑡𝐼1 −𝐾𝐼2 −(𝑆𝑡𝐼3 −𝐾𝐼4)
where
𝐼1 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼2 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼3 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
𝐼4 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐵
𝑆𝑡
)
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤.
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]

4.2.1 Probabilistic Approach
361
we have
𝐼1 =
1
√
2𝜋(𝑇−𝑡)
𝑒−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)
∫
1
𝜎log
(
𝐵
𝑆𝑡
)
1
𝜎log
(
𝐾
𝑆𝑡
) 𝑒
(𝜈+𝜎)𝑤−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
= 𝑒−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)+ 1
2 (𝜈+𝜎)2(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −(𝜈+ 𝜎)(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
−Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −(𝜈+ 𝜎)(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
and knowing that 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2), we have
𝐼1 = 𝑒−𝐷(𝑇−𝑡)
[
1 −Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−1 + Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
= 𝑒−𝐷(𝑇−𝑡)
[
Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
.
Similarly we can deduce
𝐼2 =
1
√
2𝜋(𝑇−𝑡)
𝑒−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)
∫
1
𝜎log
(
𝐵
𝑆𝑡
)
1
𝜎log
(
𝐾
𝑆𝑡
) 𝑒
𝜈𝑤−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
= 𝑒−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)+ 1
2 𝜈2(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
−Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)
[
Φ
(log(𝐵∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(log(𝐾∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
= 𝑒−𝑟(𝑇−𝑡)
[
Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
.

362
4.2.1 Probabilistic Approach
𝐼3 =
1
√
2𝜋(𝑇−𝑡)
𝑒
−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)−
2
𝜎2(𝑇−𝑡)
(
log
(
𝐵
𝑆𝑡
))2
× ∫
1
𝜎log
(
𝐵
𝑆𝑡
)
1
𝜎log
(
𝐾
𝑆𝑡
) 𝑒
[
𝜈+𝜎+
2
𝜎(𝑇−𝑡) log
(
𝐵
𝑆𝑡
)]
𝑤−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
= 𝑒
−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)−
2
𝜎2(𝑇−𝑡)
(
log
(
𝐵
𝑆𝑡
))2
+ 1
2
[
𝜈+𝜎+
2
𝜎(𝑇−𝑡) log
(
𝐵
𝑆𝑡
)]2
(𝑇−𝑡)
×
⎡
⎢
⎢
⎢
⎢⎣
Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −
[
𝜈+ 𝜎+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
]
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
−Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −
[
𝜈+ 𝜎+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
]
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
[
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
.
𝐼4 =
1
√
2𝜋(𝑇−𝑡)
𝑒
−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)−
2
𝜎2(𝑇−𝑡)
(
log
(
𝐵
𝑆𝑡
))2
× ∫
1
𝜎log
(
𝐵
𝑆𝑡
)
1
𝜎log
(
𝐾
𝑆𝑡
) 𝑒
[
𝜈+
2
𝜎(𝑇−𝑡) log
(
𝐵
𝑆𝑡
)]
𝑤−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
= 𝑒
−𝑟(𝑇−𝑡)−1
2 𝜈2(𝑇−𝑡)−
2
𝜎2(𝑇−𝑡)
(
log
(
𝐵
𝑆𝑡
))2
+ 1
2
[
𝜈+
2
𝜎(𝑇−𝑡) log
(
𝐵
𝑆𝑡
)]2
(𝑇−𝑡)
×
⎡
⎢
⎢
⎢
⎢⎣
Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −
[
𝜈+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
]
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
−Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −
[
𝜈+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
]
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
[
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
.

4.2.1 Probabilistic Approach
363
Therefore,
𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑆𝑡𝐼1 −𝐾𝐼2 −(𝑆𝑡𝐼3 −𝐾𝐼4)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝐾𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
𝑒−𝐷(𝑇−𝑡)Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
𝑒−𝐷(𝑇−𝑡)Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝐾
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝑒−𝑟(𝑇−𝑡)Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝑒−𝑟(𝑇−𝑡)Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵)𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
(𝐾−𝐵)𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −[𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾)𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
−
(𝑆𝑡
𝐵
)2𝛼{
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾)𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.

364
4.2.1 Probabilistic Approach
In contrast, for an up-and-in call option price its payoff at expiry 𝑇can be written as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢≥𝐵}
= max {𝑆𝑇−𝐾, 0}
(
1 −1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
)
= max {𝑆𝑇−𝐾, 0} −max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.
Hence, under the risk-neutral measure ℚ, the up-and-in call option price at time 𝑡is
𝐶𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝑆𝑇−𝐾, 0}||| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝑆𝑇−𝐾, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
|||||
ℱ𝑡
]
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾)𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼{
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾)𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
.
2. Down-and-Out/Down-and-In Call Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European down-and-out call option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵.
Explain why, for a down-and-out European call, 𝑆𝑡> 𝐵, and show that the terminal
payoff for 𝐵≤𝐾or 𝐵> 𝐾can be written as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]

4.2.1 Probabilistic Approach
365
where Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal, show that under the
risk-neutral measure ℚ, the down-and-out call option price at time 𝑡is
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) + (𝑍−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝑍−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
where
𝑍= max{𝐵, 𝐾},
𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
,
𝑟
is
the
risk-free
interest
rate,
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) and 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the vanilla and digital call option prices defined as
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑋𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑌𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively. Hence, deduce that the European down-and-in call option price at time 𝑡is
𝐶𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −(𝑍−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝑍−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
.
Solution: We consider two cases for the down-and-out call option price when 𝐵≤𝐾and
𝐵> 𝐾.
We require 𝑆𝑡> 𝐵for all 𝑡so as to ensure the option would not knock out at the starting
time 𝑡. Hence, for either 𝐵≤𝐾or 𝐵> 𝐾, the payoff of a down-and-out call option is
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡

366
4.2.1 Probabilistic Approach
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s lemma, for
𝑡< 𝑇
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡
= 𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
where ̂
𝑊𝑇−𝑡= 𝜈(𝑇−𝑡) + 𝑊ℚ
𝑇−𝑡and 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2). By writing
𝑚𝑇−𝑡= min
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡
therefore
min
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆𝑡𝑒𝜎𝑚𝑇−𝑡
and we can rewrite the payoff as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
= max
{
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾, 0
}
1I{
𝑆𝑡𝑒𝜎𝑚𝑇−𝑡>𝐵
}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑆𝑡𝑒𝜎𝑚𝑇−𝑡>𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡>𝐾
}
if 𝐵≤𝐾
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑆𝑡𝑒𝜎𝑚𝑇−𝑡>𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡>𝐵
}
if 𝐵> 𝐾
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐾
𝑆𝑡
)}
if 𝐵≤𝐾
(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)}
if 𝐵> 𝐾.
Case 1: 𝐵≤𝐾
The down-and-out call option price at time 𝑡is
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐾
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤=∞
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
) ∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤

4.2.1 Probabilistic Approach
367
where
𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
−2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≤0, 𝑚≤𝑤
0
otherwise.
(See Problem 4.2.2.14 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus for the derivation of 𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤).)
Thus,
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= −𝑒−𝑟(𝑇−𝑡)
∫
𝑤=∞
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
×
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2|||||||
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑑𝑤
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
−𝑒−𝑟(𝑇−𝑡)
∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
= 𝑆𝑡𝐼1 −𝐾𝐼2 −(𝑆𝑡𝐼3 −𝐾𝐼4)
where
𝐼1 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼2 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼3 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
𝐼4 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤=∞
1
𝜎log
( 𝐾
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤.

368
4.2.1 Probabilistic Approach
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
and following the same steps as described in Problem 4.2.1.1 (page 357), we have
𝐼1 = 𝑒−𝐷(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) + (𝜈+ 𝜎)(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= 𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼2 = 𝑒−𝑟(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼3 = 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
×
⎡
⎢
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −
(
𝜈+ 𝜎+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼4 = 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
×
⎡
⎢
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −
(
𝜈+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
.

4.2.1 Probabilistic Approach
369
Therefore,
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑆𝑡𝐼1 −𝐾𝐼2 −(𝑆𝑡𝐼3 −𝐾𝐼4)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵2∕(𝑆𝑡𝐾)) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Case 2: 𝐵> 𝐾
The down-and-out call option price at time 𝑡is
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡−𝐾
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤=∞
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
) ∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤

370
4.2.1 Probabilistic Approach
where
𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
−2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≤0, 𝑚≤𝑤
0
otherwise.
Using the same steps as described in Case 1, we have
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑆𝑡𝐼1 −𝐾𝐼2 −(𝑆𝑡𝐼3 −𝐾𝐼4)
where
𝐼1 = 𝑒−𝐷(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) + (𝜈+ 𝜎)(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= 𝑒−𝐷(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼2 = 𝑒−𝑟(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑆𝑡∕𝐵) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼3 = 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
×
⎡
⎢
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −
(
𝜈+ 𝜎+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)

4.2.1 Probabilistic Approach
371
𝐼4 = 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
×
⎡
⎢
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐵∕𝑆𝑡) −
(
𝜈+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
Φ
(log(𝐵∕𝑆𝑡) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
.
Therefore,
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Hence, by setting 𝑍= max{𝐵, 𝐾} we can write
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) + (𝑍−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝑍−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
.
For the case of the down-and-in call option price, by definition its payoff at expiry time 𝑇
can be written as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢≤𝐵}
= max {𝑆𝑇−𝐾, 0}
(
1 −1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
)
= max {𝑆𝑇−𝐾, 0} −max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.

372
4.2.1 Probabilistic Approach
Under the risk-neutral measure ℚ, the down-and-in call option price at time 𝑡is
𝐶𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝑆𝑇−𝐾, 0}||| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝑆𝑇−𝐾, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
|||||
ℱ𝑡
]
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
=
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≤𝐾
𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) −(𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
if 𝐵> 𝐾
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −(𝑍−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝑍−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
where 𝑍= max{𝐵, 𝐾}.
3. Up-and-Out/Up-and-In Put Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on
the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European up-and-out put option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵.
Explain why, for an up-and-out European put, 𝑆𝑡< 𝐵, and show that the terminal payoff
for 𝐵≥𝐾or 𝐵< 𝐾can be written as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.

4.2.1 Probabilistic Approach
373
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
where Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal, show that under the
risk-neutral measure ℚ, the up-and-out put option price at time 𝑡is
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) + (𝐾−𝑍) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝐾−𝑍) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
where
𝑍= min{𝐵, 𝐾},
𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
,
𝑟
is
the
risk-free
interest
rate,
𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) and 𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the vanilla and digital put option prices defined as
𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑌𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑋𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively. Hence, deduce that the European up-and-in put option price at time 𝑡is
𝑃𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −(𝐾−𝑍) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
×
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝐾−𝑍) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
.
Solution: We require 𝑆𝑡< 𝐵so as to ensure the up-and-out put option would not knock
out, especially at initiation of the contract.

374
4.2.1 Probabilistic Approach
For 𝐵≥𝐾or 𝐵< 𝐾, the payoff of an up-and-out put option is therefore
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s lemma, for
𝑡< 𝑇
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡
= 𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
where ̂
𝑊𝑇−𝑡= 𝜈(𝑇−𝑡) + 𝑊ℚ
𝑇−𝑡and 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2). By writing
𝑀𝑇−𝑡= max
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡
therefore
max
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆𝑡𝑒𝜎𝑀𝑇−𝑡
and we can rewrite the payoff as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
= max
{
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡, 0
}
1I{
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡<𝐵
}
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡<𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡<𝐾
}
if 𝐵≥𝐾
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑆𝑡𝑒𝜎𝑀𝑇−𝑡<𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡<𝐵
}
if 𝐵< 𝐾
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐾
𝑆𝑡
)}
if 𝐵≥𝐾
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)}
if 𝐵< 𝐾.

4.2.1 Probabilistic Approach
375
Case 1: 𝐵≥𝐾
The up-and-out put option price at time 𝑡is
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐾
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
∫
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑚=𝑤
(𝐾−𝑆𝑡𝑒𝜎𝑤) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
where
𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≥0, 𝑚≥𝑤
0
otherwise.
To derive the expression 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤), see Problem 4.2.2.14 of Problems and Solutions in
Mathematical Finance, Volume 1: Stochastic Calculus.
By switching the limits of the inner integral
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
) −(𝐾−𝑆𝑡𝑒𝜎𝑤) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
= −𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
+𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
−∞
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
= −𝑆𝑡𝐼1 + 𝐾𝐼2 + 𝑆𝑡𝐼3 −𝐾𝐼4

376
4.2.1 Probabilistic Approach
where
𝐼1 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼2 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼3 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
𝐼4 =
1
√
2𝜋(𝑇−𝑡) ∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤=−∞
𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤.
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
and following the same steps as described in Problem 4.2.1.1 (page 357), we have
𝐼1 = 𝑒−𝐷(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −(𝜈+ 𝜎)(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
= 𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼2 = 𝑒−𝑟(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
= 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)

4.2.1 Probabilistic Approach
377
𝐼3 = 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
×Φ
⎛
⎜
⎜
⎜
⎜⎝
1
𝜎log(𝐾∕𝑆𝑡) −
(
𝜈+ 𝜎+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
= 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
×Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼4 = 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
×Φ
⎛
⎜
⎜
⎜
⎜⎝
−1
𝜎log(𝐾∕𝑆𝑡) −
(
𝜈+
2
𝜎(𝑇−𝑡) log(𝐵∕𝑆𝑡)
)
(𝑇−𝑡)
√
𝑇−𝑡
⎞
⎟
⎟
⎟
⎟⎠
= 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
×Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
.
Therefore,
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= −𝑆𝑡𝐼1 + 𝐾𝐼2 + 𝑆𝑡𝐼3 −𝐾𝐼4
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)

378
4.2.1 Probabilistic Approach
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Case 2: 𝐵< 𝐾
The up-and-out put option price at time 𝑡is
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑀𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐵
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑤=−∞
∫
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑚=𝑤
(𝐾−𝑆𝑡𝑒𝜎𝑤) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
where
𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≥0, 𝑚≥𝑤
0
otherwise.
By switching the limits of the inner integral
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑤=−∞
∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤.
Hence, using the same steps as described in Case 1, we have
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = −𝑆𝑡𝐼1 + 𝐾𝐼2 + (𝑆𝑡𝐼3 −𝐾𝐼4)
where
𝐼1 = 𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)

4.2.1 Probabilistic Approach
379
𝐼2 = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼3 = 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝐼4 = 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
.
Therefore,
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Hence, in general we have
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) + (𝐾−𝑍) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝐾−𝑍) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
where 𝑍= min{𝐵, 𝐾}.
For the case of up-and-in put option price, by definition its payoff at expiry time 𝑇can
be written as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢≥𝐵}
= max {𝐾−𝑆𝑇, 0}
(
1 −1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
)
= max {𝐾−𝑆𝑇, 0} −max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}.

380
4.2.1 Probabilistic Approach
Under the risk-neutral measure ℚ, the up-and-in put option price at time 𝑡is
𝑃𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝐾−𝑆𝑇, 0}||| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝐾−𝑆𝑇, 0} 1I{ max
𝑡≤𝑢≤𝑇𝑆𝑢< 𝐵}
|||||
ℱ𝑡
]
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪⎩
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≥𝐾
(𝑆𝑡
𝐵
)2𝛼[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
−(𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
if 𝐵< 𝐾
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝑍, 𝑇) + (𝐾−𝑍) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝑍, 𝑇)
−
(𝑆𝑡
𝐵
)2𝛼[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)
+ (𝐾−𝑍) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝑍, 𝑇
)]
where 𝑍= min{𝐵, 𝐾}.
4. Down-and-Out/Down-and-In Put Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European down-and-out put option at time 𝑡, with expiry at time
𝑇(𝑇> 𝑡), strike 𝐾and constant barrier 𝐵< 𝐾.
Explain why, for a down-and-out put option, 𝑆𝑡> 𝐵and 𝐵< 𝐾, and show that the
terminal payoff can be written as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.

4.2.1 Probabilistic Approach
381
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
where Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal, show that under the
risk-neutral measure ℚ, the down-and-out put option price at time 𝑡is
𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−[𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
−
(𝑆𝑡
𝐵
)2𝛼{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
, 𝑟is the risk-free interest rate, 𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) and
𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the vanilla and digital call option prices defined as
𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑌𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑋𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑(𝑋, 𝑡; 𝑌) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively. Hence, deduce that the European up-and-in put option price at time 𝑡is
𝑃𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
.

382
4.2.1 Probabilistic Approach
Solution: Since the option is a down-and-out put, we require 𝑆𝑡> 𝐵to ensure that the
option would not knock out at the starting time 𝑡. In addition, we require 𝐵< 𝐾for all
time 𝑡, since if 𝐵≥𝐾the option will not pay out either at expiry or at the barrier. Therefore,
the payoff of a down-and-out put option is
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It¯o’s lemma we can
easily show that for 𝑡< 𝑇
𝑆𝑇= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+𝜎𝑊ℚ
𝑇−𝑡
= 𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
where ̂
𝑊𝑇−𝑡= 𝜈(𝑇−𝑡) + 𝑊ℚ
𝑇−𝑡and 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2). By writing
𝑚𝑇−𝑡= min
𝑡≤𝑢≤𝑇
̂
𝑊𝑢−𝑡
therefore
min
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆𝑡𝑒𝜎𝑚𝑇−𝑡
and we can rewrite the payoff as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
= max
{
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡, 0
}
1I{𝑆𝑡𝑒𝜎𝑚𝑇−𝑡>𝐵
}
=
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑆𝑡𝑒𝜎𝑚𝑇−𝑡>𝐵,𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡<𝐾
}
=
(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐾
𝑆𝑡
)}.

4.2.1 Probabilistic Approach
383
Hence, the down-and-out put option price at time 𝑡is
𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[(
𝐾−𝑆𝑡𝑒𝜎̂
𝑊𝑇−𝑡
)
1I{
𝑚𝑇−𝑡> 1
𝜎log
( 𝐵
𝑆𝑡
)
,̂
𝑊𝑇−𝑡< 1
𝜎log
( 𝐾
𝑆𝑡
)}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
) ∫
𝑚=𝑤
𝑚= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝐾−𝑆𝑡𝑒𝜎𝑤) 𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
where
𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
−2(2𝑚−𝑤)
(𝑇−𝑡)
√
2𝜋(𝑇−𝑡)𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
2𝑚−𝑤
√
𝑇−𝑡
)2
𝑚≤0, 𝑚≤𝑤
0
otherwise.
See Problem 4.2.2.14 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus to derive the expression 𝑓ℚ
𝑀,̂
𝑊(𝑚, 𝑤).
By switching the limits of the inner integral
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
) ∫
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
𝑚=𝑤
(𝑆𝑡𝑒𝜎𝑤−𝐾) 𝑓ℚ
𝑚,̂
𝑊(𝑚, 𝑤) 𝑑𝑚𝑑𝑤
= −𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
+𝑒−𝑟(𝑇−𝑡)
∫
𝑤= 1
𝜎log
( 𝐾
𝑆𝑡
)
𝑤= 1
𝜎log
( 𝐵
𝑆𝑡
)
(𝑆𝑡𝑒𝜎𝑤−𝐾)
1
√
2𝜋(𝑇−𝑡)
𝑒
𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
= −𝑆𝑡𝐼1 + 𝐾𝐼2 + (𝑆𝑡𝐼3 −𝐾𝐼4)
where
𝐼1 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐾
𝑆𝑡
)
1
𝜎log
( 𝐵
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤

384
4.2.1 Probabilistic Approach
𝐼2 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐾
𝑆𝑡
)
1
𝜎log
( 𝐵
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
(
𝑤
√
𝑇−𝑡
)2
𝑑𝑤
𝐼3 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐾
𝑆𝑡
)
1
𝜎log
( 𝐵
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜎𝑤+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤
𝐼4 =
1
√
2𝜋(𝑇−𝑡) ∫
1
𝜎log
( 𝐾
𝑆𝑡
)
1
𝜎log
( 𝐵
𝑆𝑡
) 𝑒
−𝑟(𝑇−𝑡)+𝜈𝑤−1
2 𝜈2(𝑇−𝑡)−1
2
⎛
⎜
⎜⎝
2
𝜎log
(
𝐵
𝑆𝑡
)
−𝑤
√
𝑇−𝑡
⎞
⎟
⎟⎠
2
𝑑𝑤.
Using the identity
1
√
2𝜋𝑇∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝑇)2
𝑑𝑤= 𝑒
1
2 𝑎2𝑇
[
Φ
(
𝑈−𝑎𝑇
√
𝑇
)
−Φ
(
𝐿−𝑎𝑇
√
𝑇
)]
and knowing that 𝜈= 1
𝜎(𝑟−𝐷−1
2𝜎2), we have
𝐼1 = 𝑒−𝐷(𝑇−𝑡)
[
Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
𝐼2 = 𝑒−𝑟(𝑇−𝑡)
[
Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
𝐼3 = 𝑒−𝐷(𝑇−𝑡)
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
[
Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
𝐼4 = 𝑒−𝑟(𝑇−𝑡)
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
[
Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
.

4.2.1 Probabilistic Approach
385
Therefore,
𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= −𝑆𝑡𝐼1 + 𝐾𝐼2 + (𝑆𝑡𝐼3 −𝐾𝐼4)
= −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝐾𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐾) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑆𝑡∕𝐵) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡
(𝑆𝑡
𝐵
)−1−2(𝑟−𝐷)
𝜎2
𝑒−𝐷(𝑇−𝑡)Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝐾
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝐵2∕(𝑆𝑡𝐾)) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝐾
(𝑆𝑡
𝐵
)1−2(𝑟−𝐷)
𝜎2
𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝐵∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −[𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵)𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)] −
(𝑆𝑡
𝐵
)2𝛼
×
{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵)𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.

386
4.2.2 Reflection Principle Approach
For the case of the down-and-in put option price, by definition its payoff at expiry time
𝑇can be written as
Ψ(𝑆𝑇) = max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢≤𝐵}
= max {𝐾−𝑆𝑇, 0}
(
1 −1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
)
= max {𝐾−𝑆𝑇, 0} −max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}.
Under the risk-neutral measure ℚ, the down-and-in put option price at time 𝑡is
𝑃𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝐾−𝑆𝑇, 0}||| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼
[
max {𝐾−𝑆𝑇, 0} 1I{ min
𝑡≤𝑢≤𝑇𝑆𝑢> 𝐵}
|||||
ℱ𝑡
]
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵)𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵)𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
.
4.2.2
Reflection Principle Approach
1. Reflection Principle for Black–Scholes Equation. Assume we are in the Black–Scholes
world where at time 𝑡, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎are the drift, continuous dividend yield and volatility, respectively, 𝑊𝑡is
the standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes
equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0

4.2.2 Reflection Principle Approach
387
with
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇> 𝑡.
Show that for a constant 𝐵, the function
𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (𝑆𝑡∕𝐵)2𝛼𝑉𝑏𝑠
(𝐵2∕𝑆𝑡, 𝑡; 𝐾, 𝑇)
satisfies
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ [𝜎2(1 −2𝛼) −(𝑟−𝐷)] 𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
−[𝑟+ 𝛼𝜎2 −2𝛼(𝑟−𝐷+ 𝛼𝜎2)] 𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
Explain the significance of the above PDE if we set 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Solution: By setting 𝜉= 𝐵2∕𝑆𝑡we can write
𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (𝑆𝑡∕𝐵)2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) .
Differentiating 𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) with respect to 𝑡and 𝑆𝑡we have
𝜕𝑈
𝜕𝑡=
(𝑆𝑡
𝐵
)2𝛼𝜕𝑉𝑏𝑠
𝜕𝑡
𝜕𝑈
𝜕𝑆𝑡
= 2𝛼𝑆2𝛼−1
𝑡
𝐵−2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼𝜕𝑉𝑏𝑠
𝜕𝜉
𝜕𝜉
𝜕𝑆𝑡
= 2𝛼𝑆2𝛼−1
𝑡
𝐵−2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼𝜕𝑉𝑏𝑠
𝜕𝜉
(𝑆𝑡
𝐵
)2
= 2𝛼𝑆2𝛼−1
𝑡
𝐵−2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −𝑆2𝛼−1
𝑡
𝐵−2𝛼𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
= 1
𝑆𝑡
(𝑆𝑡
𝐵
)2𝛼[
2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
]

388
4.2.2 Reflection Principle Approach
and finally by differentiating 𝜕𝑈
𝜕𝑆𝑡
with respect to 𝑆𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
= −1
𝑆2
𝑡
(𝑆𝑡
𝐵
)2𝛼[
2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
]
+ 2𝛼
𝑆2
𝑡
(𝑆𝑡
𝐵
)2𝛼[
2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
]
+ 1
𝑆𝑡
(𝑆𝑡
𝐵
)2𝛼[
2𝛼𝜕𝑉𝑏𝑠
𝜕𝜉
𝜕𝜉
𝜕𝑆𝑡
−𝜕𝜉
𝜕𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝜉
−𝜉𝜕2𝑉𝑏𝑠
𝜕𝜉2
𝜕𝜉
𝜕𝑆𝑡
]
=
(
2𝛼−1
𝑆2
𝑡
) (𝑆𝑡
𝐵
)2𝛼[
2𝛼𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
]
−1
𝑆2
𝑡
(𝑆𝑡
𝐵
)2𝛼[
(2𝛼−1)𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
−𝜉2 𝜕2𝑉𝑏𝑠
𝜕𝜉2
]
= 1
𝑆2
𝑡
(𝑆𝑡
𝐵
)2𝛼[
2𝛼(2𝛼−1)𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) −2(2𝛼−1)𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
+ 𝜉2 𝜕2𝑉𝑏𝑠
𝜕𝜉2
]
.
By substituting 𝜕𝑈
𝜕𝑡, 𝜕𝑈
𝜕𝑆𝑡
and 𝜕2𝑈
𝜕𝑆2
𝑡
into
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ [𝜎2(1 −2𝛼) −(𝑟−𝐷)] 𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
−[𝑟+ 𝛼𝜎2 −2𝛼(𝑟−𝐷+ 𝛼𝜎2)] 𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇)
we have
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ [𝜎2(1 −2𝛼) −(𝑟−𝐷)] 𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
−[𝑟+ 𝛼𝜎2 −2𝛼(𝑟−𝐷+ 𝛼𝜎2)] 𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇)
=
(𝑆𝑡
𝐵
)2𝛼{𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝜉2 𝜕2𝑉𝑏𝑠
𝜕𝜉2
+ (𝑟−𝐷)𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
−𝑟𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇)
}
= 0
since 𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝜉2 𝜕2𝑉𝑏𝑠
𝜕𝜉2
+ (𝑟−𝐷)𝜉𝜕𝑉𝑏𝑠
𝜕𝜉
−𝑟𝑉𝑏𝑠(𝜉, 𝑡; 𝐾, 𝑇) = 0.
By setting 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
then 𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) = (𝑆𝑡∕𝐵)2𝛼𝑉𝑏𝑠
(𝐵2∕𝑆𝑡, 𝑡; 𝐾, 𝑇)
satisfies
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑈
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑈
𝜕𝑆𝑡
−𝑟𝑈(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.

4.2.2 Reflection Principle Approach
389
2. In–Out Parity. Assume we are in the Black–Scholes world where at time 𝑡the asset price
𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎are the drift, continuous dividend yield and volatility, respectively, 𝑊𝑡is
the standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes
equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇> 𝑡. Let
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the
European up-and-out/in and European down-and-out/in options with common barrier 𝐵,
strike price 𝐾and expiry time 𝑇. By setting up independent portfolios, show that
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
and
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
Solution: At time 𝑡, we first set up the portfolios Π𝑢(𝑆𝑡, 𝑡) and Π𝑑(𝑆𝑡, 𝑡) with each having
the following options
Π𝑢(𝑆𝑡, 𝑡) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
Π𝑑(𝑆𝑡, 𝑡) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇).
For the case of Π𝑢(𝑆𝑡, 𝑡), at expiry time 𝑇only one of the two barrier options can be active.
If barrier 𝐵is triggered (𝑆𝑇≥𝐵), then
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0 and 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇).
However, if the barrier 𝐵is not triggered (𝑆𝑇< 𝐵), then
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇) and 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0.
In the same vein for Π𝑑(𝑆𝑡, 𝑡), at expiry time 𝑇if the barrier 𝐵is triggered (𝑆𝑇≤𝐵) then
𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0 and 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)

390
4.2.2 Reflection Principle Approach
while if 𝐵is never triggered (𝑆𝑇> 𝐵) then
𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇) and 𝑉𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0.
Hence, at time 𝑇, the portfolios have the values
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇) = 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇)
𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇) = 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇)
and by discounting them back to time 𝑡under the risk-neutral measure ℚ, we have
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇).
3. Up-and-Out/In Barrier Options. Assume we are in the Black–Scholes world where at time
𝑡the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎are the drift, continuous dividend yield and volatility, respectively, 𝑊𝑡is
the standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟.
Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes equa-
tion
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇> 𝑡. Let
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the European up-and-out/in options, respec-
tively with common barrier 𝐵, strike price 𝐾and expiry time 𝑇.
Using the reflection principle, show that the formula for an up-and-out barrier option is
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)

4.2.2 Reflection Principle Approach
391
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
and ̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the following Black–Scholes
equation
𝜕̂𝑉𝑢∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉𝑢∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̂𝑉𝑢∕𝑜
𝜕𝑆𝑡
−𝑟̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with discontinuous payoff
0 < 𝑆𝑡< 𝐵,
𝑡≤𝑇
̂𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇).
Deduce the general solution for the up-and-in barrier option price.
Solution: The up-and-out barrier option 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) with strike price 𝐾and barrier
𝐵satisfies the PDE
𝜕𝑉𝑢∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑢∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑢∕𝑜
𝜕𝑆𝑡
−𝑟𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with the following boundary conditions
0 < 𝑆𝑡< 𝐵,
𝑡≤𝑇
𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = 0
𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the European option (Black–Scholes) payoff at expiry 𝑇. As the up-and-
out barrier option has a European payoff at expiry time 𝑇but becomes worthless on the
barrier 𝐵, we can therefore write its solution as
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
so that ̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the Black–Scholes equation
𝜕̂𝑉𝑢∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉𝑢∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̂𝑉𝑢∕𝑜
𝜕𝑆𝑡
−𝑟̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with discontinuous payoff
0 < 𝑆𝑡< 𝐵,
𝑡≤𝑇
̂𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)

392
4.2.2 Reflection Principle Approach
whilst for ̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) we require on the barrier 𝐵
̃𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇)
and at expiry 𝑇
̃𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0.
From the reflection principle (see Problem 4.2.2.1, page 386), by writing 𝜉𝑡= 𝐵2
𝑆𝑡
̃𝑉𝑢∕𝑜(𝑆, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
=
(
𝐵
𝜉𝑡
)2𝛼
̂𝑉𝑢∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
with 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
also satisfies the Black–Scholes equation
(
𝐵
𝜉𝑡
)2𝛼[
𝜕̂𝑉𝑢∕𝑜
𝜕𝑡
+ 1
2𝜎2𝜉2
𝑡
𝜕2 ̂𝑉𝑢∕𝑜
𝜕𝜉2
𝑡
+ (𝑟−𝐷)𝜉𝑡
𝜕̂𝑉𝑢∕𝑜
𝜕𝜉𝑡
−𝑟̂𝑉𝑢∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
]
= 0
with the following boundary conditions
0 < 𝜉𝑡< 𝐵,
𝑡≤𝑇
(
𝐵
𝜉𝑡
)2𝛼
̂𝑉𝑢∕𝑜(𝜉𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(
𝐵
𝜉𝑡
)2𝛼
Ψ(𝜉𝑇)
or
𝜕̂𝑉𝑢∕𝑜
𝜕𝑡
+ 1
2𝜎2𝜉2
𝑡
𝜕2 ̂𝑉𝑢∕𝑜
𝜕𝜉2
𝑡
+ (𝑟−𝐷)𝜉𝑡
𝜕̂𝑉𝑢∕𝑜
𝜕𝜉𝑡
−𝑟̂𝑉𝑢∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with boundary conditions
0 < 𝜉𝑡< 𝐵,
𝑡≤𝑇
̂𝑉𝑢∕𝑜(𝜉𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝜉𝑇).

4.2.2 Reflection Principle Approach
393
Thus, we can set
̃𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
To test the boundary conditions, we note that at the barrier 𝑆𝑡= 𝐵we have
̃𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝐵
𝐵
)2𝛼̂𝑉𝑢∕𝑜
(
𝐵2
𝐵, 𝑡; 𝐾, 𝐵, 𝑇
)
= ̂𝑉𝑢∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇)
whilst at expiry time 𝑇, we have
̃𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(𝑆𝑇
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑇
, 𝑇; 𝐾, 𝐵, 𝑇
)
=
(𝑆𝑇
𝐵
)2𝛼
Ψ
(
𝐵2
𝑆𝑇
)
1I 𝐵2
𝑆𝑇<𝐵
where for the reflection part, the payoff is only valid for 𝐵2
𝑆𝑇
< 𝐵or 𝑆𝑇> 𝐵.
Therefore, in the range 0 < 𝑆𝑇< 𝐵for an up-and-out option
̃𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(𝑆𝑇
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑇
, 𝑇; 𝐾, 𝐵, 𝑇
)
= 0.
Hence, the general solution of an up-and-out barrier option is
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
By writing the up-and-in barrier option as 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), from the in–out parity
𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the Black–Scholes formula for a European option written on asset
price 𝑆𝑡with strike 𝐾and expiry time 𝑇. Thus, the up-and-in barrier option formula is
𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −̂𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑢∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.

394
4.2.2 Reflection Principle Approach
4. Down-and-Out/In Barrier Options. Assume that at time 𝑡, the asset price 𝑆𝑡follows the
SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎are the drift, continuous dividend yield and volatility, respectively, 𝑊𝑡is
the standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟.
Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes equa-
tion
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇> 𝑡. Let
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the European down-and-out/in options,
respectively with common barrier 𝐵, strike price 𝐾and expiry time 𝑇.
Using the reflection principle, show that the formula for a down-and-out barrier option
is
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
and ̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the following Black–Scholes
equation
𝜕̂𝑉𝑑∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉𝑑∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̂𝑉𝑑∕𝑜
𝜕𝑆𝑡
−𝑟̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with truncated payoff
𝑆𝑡> 𝐵,
𝑡≤𝑇
̂𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇).
Deduce the general solution for the down-and-in barrier option price.

4.2.2 Reflection Principle Approach
395
Solution: By definition, the down-and-out barrier option 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) with strike
price 𝐾and barrier 𝐵satisfies the PDE
𝜕𝑉𝑑∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑑∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑑∕𝑜
𝜕𝑆𝑡
−𝑟𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with the following boundary conditions
𝑆𝑡> 𝐵,
𝑡≤𝑇
𝑉𝑑∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = 0
𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the European option (Black–Scholes) payoff at expiry 𝑇. As the down-
and-out barrier option has a European payoff at expiry time 𝑇but becomes worthless on
the barrier 𝐵, we can therefore write its solution as
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
so that ̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) satisfies the Black–Scholes equation
𝜕̂𝑉𝑑∕𝑜
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2 ̂𝑉𝑑∕𝑜
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕̂𝑉𝑑∕𝑜
𝜕𝑆𝑡
−𝑟̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with discontinuous payoff
𝑆𝑡> 𝐵,
𝑡≤𝑇
̂𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝑆𝑇)
whilst for ̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), we require on the barrier 𝐵
̃𝑉𝑑∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑑∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇)
and at expiry 𝑇
̃𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 0.

396
4.2.2 Reflection Principle Approach
From the reflection principle (see Problem 4.2.2.1, page 386), by writing 𝜉𝑡= 𝐵2
𝑆𝑡
̃𝑉𝑑∕𝑜(𝑆, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
=
(
𝐵
𝜉𝑡
)2𝛼
̂𝑉𝑑∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
with 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
also satisfies the Black–Scholes equation
(
𝐵
𝜉𝑡
)2𝛼[
𝜕̂𝑉𝑑∕𝑜
𝜕𝑡
+ 1
2𝜎2𝜉2
𝑡
𝜕2 ̂𝑉𝑑∕𝑜
𝜕𝜉2
𝑡
+ (𝑟−𝐷)𝜉𝑡
𝜕̂𝑉𝑑∕𝑜
𝜕𝜉𝑡
−𝑟̂𝑉𝑑∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
]
= 0
with the following boundary conditions
𝜉𝑡> 𝐵,
𝑡≤𝑇
(
𝐵
𝜉𝑡
)2𝛼
̂𝑉𝑑∕𝑜(𝜉𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(
𝐵
𝜉𝑡
)2𝛼
Ψ(𝜉𝑇)
or
𝜕̂𝑉𝑑∕𝑜
𝜕𝑡
+ 1
2𝜎2𝜉2
𝑡
𝜕2 ̂𝑉𝑑∕𝑜
𝜕𝜉2
𝑡
+ (𝑟−𝐷)𝜉𝑡
𝜕̂𝑉𝑑∕𝑜
𝜕𝜉𝑡
−𝑟̂𝑉𝑑∕𝑜(𝜉𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 0
with boundary conditions
𝜉𝑡> 𝐵,
𝑡≤𝑇
̂𝑉𝑑∕𝑜(𝜉𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = Ψ(𝜉𝑇).
Thus, we can set
̃𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
To test the boundary conditions, we note that at the barrier 𝑆𝑡= 𝐵we have
̃𝑉𝑑∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇) =
(𝐵
𝐵
)2𝛼̂𝑉𝑑∕𝑜
(
𝐵2
𝐵, 𝑡; 𝐾, 𝐵, 𝑇
)
= ̂𝑉𝑑∕𝑜(𝐵, 𝑡; 𝐾, 𝐵, 𝑇)

4.2.2 Reflection Principle Approach
397
whilst at expiry time 𝑇, we have
̃𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(𝑆𝑇
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑇
, 𝑇; 𝐾, 𝐵, 𝑇
)
=
(𝑆𝑇
𝐵
)2𝛼
Ψ
(
𝐵2
𝑆𝑇
)
1I 𝐵2
𝑆𝑇>𝐵
where for the reflection part, the payoff is only valid for 𝐵2
𝑆𝑇
> 𝐵or 𝑆𝑇< 𝐵.
Therefore, in the range 𝑆𝑇> 𝐵for a down-and-out option
̃𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) =
(𝑆𝑇
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑇
, 𝑇; 𝐾, 𝐵, 𝑇
)
= 0.
Hence, the general solution of a down-and-out barrier option is
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
By writing the down-and-in barrier option as 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), from the in–out parity
𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the Black–Scholes formula for a European option written on asset
price 𝑆𝑡with strike 𝐾and expiry time 𝑇. Thus, the down-and-in barrier option formula
is
𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −̂𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼
̂𝑉𝑑∕𝑜
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝐵, 𝑇
)
.
5. Up-and-Out/Up-and-In Call Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on
the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European up-and-out call option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵> 𝐾.
By constructing a payoff diagram and using the reflection principle, find the up-and-out
call option price.

398
4.2.2 Reflection Principle Approach
Furthermore, deduce the up-and-in call option price using the knock-in and knock-out
parity relationship.
Solution: For the up-and-out barrier call option we know that the option expires worthless
if the barrier 𝐵is reached, and since we are dealing with an up-and-out call option, the
barrier 𝐵must be set above the strike 𝐾, i.e. 𝐵> 𝐾, otherwise the payoff will be knock-out
(see Figure 4.1).
∕(
;
)
−
0
Figure 4.1
Up-and-out call payoff diagram.
The payoff diagram for the up-and-out call option 𝐶𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) can be con-
structed with the following portfolio
Portfolio =
(
Long one call
with strike 𝐾
)
−
[(
Long one call
with strike 𝐵
)
+
(
Long one digital call with
strike 𝐵and payoff (𝐵−𝐾)
)]
which is illustrated in Figure 4.2.
At expiry time 𝑇we can therefore write the up-and-out call option price as
𝐶𝑢∕𝑜
(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑇, 𝑇; 𝐾, 𝑇)
−[𝐶𝑏𝑠
(𝑆𝑇, 𝑇; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑇, 𝑇; 𝐵, 𝑇)] .
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the up-and-out call option at time 𝑡as
𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−[𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
−
(𝑆𝑡
𝐵
)2𝛼{
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.

4.2.2 Reflection Principle Approach
399
−
−
−
−
−
−
−
−
Figure 4.2
Construction of an up-and-out call payoff.

400
4.2.2 Reflection Principle Approach
From the knock-in and knock-out parity relationship
𝐶𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
therefore the up-and-in call option price at time 𝑡is
𝐶𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾)𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼{
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾)𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
.
6. Down-and-Out/Down-and-In Call Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European down-and-out call option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵.
By constructing payoff diagrams for 𝐵≤𝐾and 𝐵> 𝐾, and using the reflection prin-
ciple, find the down-and-out call option prices.
Furthermore, using the knock-in and knock-out parity relationship, deduce the down-
and-in call options.
Solution: From the definition of a down-and-out call option price, the payoff diagrams
𝐵< 𝐾and 𝐵> 𝐾are given in Figure 4.3.
(a)
(b)
Figure 4.3
Down-and-out call payoff diagram for (a) 𝐵≤𝐾and (b) 𝐵> 𝐾.

4.2.2 Reflection Principle Approach
401
For the case when 𝐵≤𝐾, at expiry time 𝑇the down-and-out call option price is the
same as a European call option price
𝐶𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑇, 𝑇; 𝐾, 𝑇) .
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the down-and-out call option at time 𝑡as
𝐶𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
For the case when 𝐵> 𝐾, the payoff diagram for the down-and-out call option price
𝐶𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) can be constructed with the following portfolio
Portfolio =
(
Long one call
with strike 𝐵
)
+
(
Long one digital call with
strike 𝐵and payoff (𝐵−𝐾)
)
where Figure 4.4 graphically illustrates the construction of the payoff.
Hence, at expiry time 𝑇we can write
𝐶𝑑∕𝑜
(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑇, 𝑇; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑇, 𝑇; 𝐵, 𝑇) .
−
−
−
−
Figure 4.4
Down-and-out call payoff diagram for 𝐵> 𝐾.

402
4.2.2 Reflection Principle Approach
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the down-and-out call option for 𝐵> 𝐾as
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
.
Hence,
𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≤𝐾
𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−
(𝑆𝑡
𝐵
)2𝛼[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
if 𝐵> 𝐾.
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡, 𝑡; 𝐵, 𝑇
)]
Since
𝐶𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝐶𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
therefore
𝐶𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪⎩
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≤𝐾
𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−(𝐵−𝐾) 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
if 𝐵> 𝐾.
×
[
𝐶𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐵−𝐾) 𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
7. Up-and-Out/Up-and-In Put Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on
the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡

4.2.2 Reflection Principle Approach
403
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European up-and-out put option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵.
By constructing payoff diagrams for 𝐵< 𝐾and 𝐵≥𝐾, and using the reflection prin-
ciple, find the up-and-out put option prices.
Furthermore, using the knock-in and knock-out parity relationship, deduce the up-and-
in put option price.
Solution: From the definition of an up-and-out put option price, the payoff diagrams for
𝐵≥𝐾and 𝐵< 𝐾are given in Figure 4.5.
(a)
(b)
Figure 4.5
Up-and-out put payoff diagrams for (a) 𝐵≥𝐾and (b) 𝐵< 𝐾.
For the case when 𝐵≥𝐾, at expiry time 𝑇the up-and-out put price is the same as a
European put option price with strike 𝐾and therefore we can simply write
𝑃𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑇, 𝑇; 𝐾, 𝑇) .
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the up-and-out put price as
𝑃𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
(𝑆
𝐵
)2𝛼
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
For the case when 𝐵< 𝐾, the payoff diagram for the up-and-out put option price
𝑃𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) can be constructed with the following portfolio
Portfolio =
(
Long one put
with strike 𝐵
)
+
(
Long one digital put with
strike 𝐵and payoff (𝐾−𝐵)
)
where Figure 4.6 graphically illustrates the construction of the payoff.
Hence, at expiry time 𝑇we can write
𝑃𝑢∕𝑜
(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑇, 𝑇; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑇, 𝑇; 𝐵, 𝑇) .

404
4.2.2 Reflection Principle Approach
−
−
−
−
Figure 4.6
Up-and-out put payoff diagram for 𝐵< 𝐾.
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the up-and-out put option for 𝐵< 𝐾as
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) −
(𝑆𝑡
𝐵
)2𝛼
×
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
.
Therefore,
𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪⎩
𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −
(𝑆
𝐵
)2𝛼
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≥𝐾
𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−
(𝑆𝑡
𝐵
)2𝛼[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
if 𝐵< 𝐾.
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
From the knock-in and knock-out parity relationship
𝑃𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑃𝑢∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)

4.2.2 Reflection Principle Approach
405
the corresponding up-and-in put option price at time 𝑡becomes
𝑃𝑢∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
if 𝐵≥𝐾
𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−(𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
if 𝐵< 𝐾.
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
8. Down-and-Out/Down-and-In Put Options. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. We consider a European down-and-out put option at time 𝑡, with expiry at time
𝑇> 𝑡, strike 𝐾and constant barrier 𝐵< 𝐾.
By constructing a payoff diagram and using the reflection principle, find the down-and-
out put option price.
Furthermore, deduce the down-and-in put option price using the knock-in and knock-out
parity relationship.
Solution: For the down-and-out barrier put option we know that the option expires worth-
less if the barrier 𝐵is triggered, and since we are dealing with a down-and-out put option,
the barrier 𝐵must be set below the strike 𝐾, i.e. 𝐵< 𝐾; otherwise the payoff will be
knock-out (see Figure 4.7).
Figure 4.7
Down-and-out put payoff diagram for 𝐵< 𝐾.

406
4.2.2 Reflection Principle Approach
The payoff for the down-and-out put option 𝑃𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) can be constructed
with the following portfolio
Portfolio =
(
Long one put
with strike 𝐾
)
−
[(
Long one put
with strike 𝐵
)
+
(
Long one digital put with
strike 𝐵and payoff (𝐾−𝐵)
)]
where Figure 4.8 graphically illustrates the construction of the payoff.
At expiry time 𝑇we can therefore write
𝑃𝑑∕𝑜
(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑇, 𝑇; 𝐾, 𝑇)
−[𝑃𝑏𝑠
(𝑆𝑇, 𝑇; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑇, 𝑇; 𝐵, 𝑇)] .
By discounting the entire payoff under the risk-neutral measure ℚand using the reflection
principle, we can write the solution for the down-and-out put option as
𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
−[𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵) 𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
−
(𝑆𝑡
𝐵
)2𝛼{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵) 𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
where 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
From the knock-in and knock-out parity relationship
𝑃𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇)
the corresponding down-and-in put option price at time 𝑡is
𝑃𝑑∕𝑖
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑃𝑑∕𝑜
(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
= 𝑃𝑏𝑠
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + (𝐾−𝐵)𝑃𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
+
(𝑆𝑡
𝐵
)2𝛼{
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐾, 𝑇
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ (𝐾−𝐵)𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]}
.

4.2.2 Reflection Principle Approach
407
−
−
−
−
−
−
−
Figure 4.8
Construction of a down-and-out put payoff diagram for 𝐵< 𝐾.

408
4.2.3 Further Barrier-Style Options
4.2.3
Further Barrier-Style Options
1. In–Out Parity with Rebate at Expiry. Assume we are in the Black–Scholes world where at
time 𝑡< 𝑇, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, continuous dividend yield and volatility, respectively,
𝑊𝑡is the standard Wiener process and there is a risk-free asset which earns interest at a
constant rate 𝑟. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–
Scholes equation
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇.
By incorporating a rebate 𝑅payable at expiry time 𝑇, we define 𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇),
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) as the European up-and-
out, down-and-out, up-and-in and down-and-in options, respectively with common barrier
𝐵, strike price 𝐾, rebate 𝑅and expiry time 𝑇.
Show by setting up independent portfolios that
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡)
and
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡).
Solution: At time 𝑡< 𝑇, we first set up the portfolios Π𝑅
𝑢(𝑆𝑡, 𝑡) and Π𝑅
𝑑(𝑆𝑡, 𝑡) with each
having the following options
Π𝑅
𝑢(𝑆𝑡, 𝑡) = 𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
Π𝑅
𝑑(𝑆𝑡, 𝑡) = 𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇).
First consider Π𝑅
𝑢(𝑆𝑡, 𝑡) where at expiry time 𝑇, only one of the two barrier options can be
active. If barrier 𝐵is triggered (𝑆𝑇≥𝐵), then
𝑉𝑅
𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑅and 𝑉𝑅
𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
where 𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) is the European up-and-in barrier option payoff without rebate.

4.2.3 Further Barrier-Style Options
409
However, if the barrier 𝐵is not triggered (𝑆𝑇< 𝐵), then
𝑉𝑅
𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑅
where 𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) is the European up-and-out barrier option payoff without
rebate.
In the same vein for Π𝑅
𝑑(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇), at expiry time 𝑇if the barrier is triggered (𝑆𝑇≤
𝐵) then
𝑉𝑅
𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑅and 𝑉𝑅
𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
where 𝑉𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) is the European down-and-in barrier option payoff without
rebate.
Finally, if 𝐵is never triggered (𝑆𝑇> 𝐵) then
𝑉𝑅
𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑅
where 𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) is the European down-and-out barrier option payoff without
rebate.
Hence, at expiry time 𝑇we have
𝑉𝑅
𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
+𝑉𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
+𝑅
[
1I𝑆𝑇≥𝐵+ 1I𝑆𝑇<𝐵
]
= 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) + 𝑅
and
𝑉𝑅
𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
+𝑉𝑑∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵, 𝑇)
+𝑅
[
1I𝑆𝑇≤𝐵+ 1I𝑆𝑇>𝐵
]
= 𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) + 𝑅.
By discounting the terminal payoffs back to time 𝑡, we can conclude that
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡)
and
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡).

410
4.2.3 Further Barrier-Style Options
2. Up-and-Out/In with Rebates at Expiry. Assume we are in the Black–Scholes world where
at time 𝑡< 𝑇, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, continuous dividend yield and volatility, respectively,
𝑊𝑡is the standard Wiener process and there is a risk-free asset which earns interest at a
constant rate 𝑟.
Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes equa-
tion
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇.
By incorporating a rebate 𝑅payable at expiry 𝑇, we define 𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) as the European up-and-out and European out-and-in options, respec-
tively with common barrier 𝐵, strike price 𝐾, rebate 𝑅and expiry time 𝑇.
Using the put–call parity for European digital options and the reflection principle, show
that the formula for an up-and-out barrier option incorporating a rebate 𝑅payable at expiry
𝑇is
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[
𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
where 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) is the European up-and-out barrier option without rebate, 𝛼=
1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
, 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) and 𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the European digital call and put
options defined as
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively.

4.2.3 Further Barrier-Style Options
411
Finally, deduce the general solution for the up-and-in barrier option price with a rebate
𝑅payable at expiry 𝑇.
Solution: For the up-and-out case, we can split the option price into two parts
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉
𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
where 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) is the usual European up-and-out barrier option price which
only exists for 𝑆𝑡< 𝐵, whilst when the asset reaches the barrier (i.e. 𝑆𝑡= 𝐵) the option
𝑉
𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) takes the form
𝑉
𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑅𝑒−𝑟(𝑇−𝑡).
From the put–call parity for European digital options we have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) + 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
such that at expiry 𝑇
𝐶𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇) =
{
0
if 𝑆𝑇< 𝐵
1
if 𝑆𝑇≥𝐵
and
𝑃𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇) =
{
1
if 𝑆𝑇≤𝐵
0
if 𝑆𝑇> 𝐵.
Note that 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) ≠0 for 𝑆𝑡≤𝐵, 𝑡≤𝑇but its reflection does vanish such that at
expiry time 𝑇
(𝑆𝑇
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑇
, 𝑇; 𝐵, 𝑇
)
=
(𝑆𝑇
𝐵
)2𝛼
1I{ 𝐵2
𝑆𝑇≤𝐵
}
=
(𝑆𝑇
𝐵
)2𝛼
1I{𝑆𝑇≥𝐵}
where for the reflection part the payoff is only valid for 𝑆𝑇≥𝐵.
Since we only consider the range 0 < 𝑆𝑇< 𝐵for an up-and-out barrier option, we can
set
𝑉
𝑅
𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐵, 𝑇) = 𝑅
[
𝐶𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇) +
(𝑆𝑇
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑇
, 𝑇; 𝐵, 𝑇
)]
.

412
4.2.3 Further Barrier-Style Options
By discounting the entire payoff back to time 𝑡using the risk-free interest rate 𝑟, we have
𝑉
𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑅
[
𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
where for 𝑆𝑡= 𝐵
𝑉
𝑅
𝑢∕𝑜(𝐵, 𝑡; 𝐵, 𝑇) = 𝑅[𝐶𝑑(𝐵, 𝑡; 𝐵, 𝑇) + 𝑃𝑑(𝐵, 𝑡; 𝐵, 𝑇)]
= 𝑅𝑒−𝑟(𝑇−𝑡).
Hence, by adding back the up-and-out barrier option without rebate, the general solution
of an up-and-out barrier option with rebate payable at expiry 𝑇becomes
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[
𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) +
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
.
From the in–out parity for barriers with rebates at expiry
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡)
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the Black–Scholes formula for a European option written on asset
𝑆𝑡with strike 𝐾and expiry time 𝑇. Therefore, the up-and-in barrier option price with a
rebate 𝑅payable at expiry 𝑇is
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅[𝑒−𝑟(𝑇−𝑡) −𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)
−
(𝑆𝑡
𝐵
)2𝛼
𝑃𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)]
.
3. Down-and-Out/In with Rebates at Expiry. Assume we are in the Black–Scholes world
where at time 𝑡< 𝑇, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, continuous dividend yield and volatility, respectively,
𝑊𝑡is the standard Wiener process and there is a risk-free asset which earns interest at a
constant rate 𝑟.

4.2.3 Further Barrier-Style Options
413
Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes equa-
tion
𝜕𝑉𝑏𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉𝑏𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉𝑏𝑠
𝜕𝑆𝑡
−𝑟𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇. By incorporating a
rebate 𝑅payable at expiry 𝑇, let 𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the Euro-
pean up-and-out/in options, respectively with common barrier 𝐵, strike price 𝐾, rebate 𝑅
and expiry time 𝑇.
Using the put–call parity for European digital options and the reflection principle, show
that the formula for an up-and-out barrier option incorporating a rebate 𝑅payable at expiry
𝑇is
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)
]
where 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) is the European down-and-out barrier option without rebate,
𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
, 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) and 𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) are the European digital call and
put options defined as
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and
𝑃𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) −(𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
respectively.
Finally, deduce the general solution for the down-and-in barrier option price with a
rebate 𝑅payable at expiry 𝑇.
Solution: For the down-and-out case, we can split the option price into two parts
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉
𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)

414
4.2.3 Further Barrier-Style Options
where 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) is the usual European up-and-out barrier option price which
only exists for 𝑆𝑡> 𝐵, whilst when 𝑆𝑡= 𝐵the option 𝑉
𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) takes the form
𝑉
𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑅𝑒−𝑟(𝑇−𝑡).
From the put–call parity for European digital options we have
𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) + 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
such that at expiry 𝑇
𝐶𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇) =
{
0
if 𝑆𝑇< 𝐵
1
if 𝑆𝑇≥𝐵
and
𝑃𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇) =
{
1
if 𝑆𝑇≤𝐵
0
if 𝑆𝑇> 𝐵.
Note that 𝐶𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇) ≠0 for 𝑆𝑡≥𝐵, 𝑡≤𝑇but its reflection is where at expiry time
𝑇
(𝑆𝑇
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑇
, 𝑇; 𝐵, 𝑇
)
=
(𝑆𝑇
𝐵
)2𝛼
1I{ 𝐵2
𝑆𝑇≥𝐵
}
=
(𝑆𝑇
𝐵
)2𝛼
1I{𝑆𝑇≤𝐵}
where for the reflection part the payoff is only valid for 𝑆𝑇≤𝐵.
Since we only consider the range 𝑆𝑇> 𝐵, for a down-and-out barrier option we can
set
𝑉
𝑅
𝑑∕𝑜(𝑆𝑇, 𝑇; 𝐵, 𝑇) = 𝑅
[(𝑆𝑇
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑇
, 𝑇; 𝐵, 𝑇
)
+ 𝑃𝑑(𝑆𝑇, 𝑇; 𝐵, 𝑇)
]
.
By discounting the entire payoff back to time 𝑡using the risk-free interest rate 𝑟, we have
𝑉
𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) = 𝑅
[(𝑆𝑡
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)
]
where for 𝑆𝑡= 𝐵
𝑉
𝑅
𝑑∕𝑜(𝐵, 𝑡; 𝐵, 𝑇) = 𝑅[𝐶𝑑(𝐵, 𝑡; 𝐵, 𝑇) + 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
= 𝑅𝑒−𝑟(𝑇−𝑡).

4.2.3 Further Barrier-Style Options
415
Hence, by adding back the down-and-out barrier option without rebate, the general solution
of a down-and-out barrier option with rebate payable at expiry 𝑇becomes
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
+ 𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)
]
.
From the in–out parity for barriers with rebates at expiry
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑅𝑒−𝑟(𝑇−𝑡)
where 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the Black–Scholes formula for a European option written on asset
𝑆𝑡with strike 𝐾and expiry time 𝑇. Therefore, the down-and-in barrier option price with
a rebate 𝑅payable at expiry 𝑇is
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[
𝑒−𝑟(𝑇−𝑡) −
(𝑆𝑡
𝐵
)2𝛼
𝐶𝑑
(
𝐵2
𝑆𝑡
, 𝑡; 𝐵, 𝑇
)
−𝑃𝑑(𝑆𝑡, 𝑡; 𝐵, 𝑇)] .
4. Up-and-Out/In Barrier Options with Immediate Rebates. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ) and assume that we are in the Black–
Scholes world where at time 𝑡< 𝑇, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, and there is
a risk-free asset which earns interest at a constant rate 𝑟. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price
of a European option satisfying the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with
𝑉𝑏𝑠(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇.
By incorporating a rebate 𝑅payable at knock-out/knock-in time 𝜏, 𝑡≤𝜏≤𝑇, let
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the European up-and-out and up-and-in bar-
rier options, respectively with common barrier 𝐵, strike price 𝐾, rebate 𝑅and expiry
time 𝑇.

416
4.2.3 Further Barrier-Style Options
By writing
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇)
where 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) are the European up-and-out and up-
and-in barrier option prices without rebates, respectively, whilst ̃𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇) and
̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇) are the corresponding option prices associated with immediate rebate at
knock-out/knock-in time, show that
̃𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
where 𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) and 𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) are the immediate-touch call and put options,
respectively defined as
𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐵
)𝜆−
Φ(𝑑−)
and
𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)𝜆+
Φ(−𝑑+) +
(𝑆𝑡
𝐵
)𝜆−
Φ(−𝑑−)
such that
𝜆± =
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
𝑑± =
log(𝑆𝑡∕𝐵) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2) + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢
is the cdf of a standard normal.
Finally, verify that
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)𝜆+
+
(𝑆𝑡
𝐵
)𝜆−]
.

4.2.3 Further Barrier-Style Options
417
Solution: At time 𝑡we first set up the portfolio Π𝑅
𝑢(𝑆𝑡, 𝑡) having the following options:
Π𝑅
𝑢(𝑆𝑡, 𝑡) = 𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
where
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇).
At any time 𝜏, 𝑡≤𝜏≤𝑇, only one of the two barrier options can be active. If barrier 𝐵
is triggered, that is max
𝑡≤𝜏≤𝑇𝑆𝜏≥𝐵such that 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) vanishes, then under the
risk-neutral measure ℚthe rebate price is
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
= 𝑅𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)1I𝑆𝜏≥𝐵
||||
ℱ𝑡
]
= 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).
Correspondingly, if max
𝑡≤𝜏≤𝑇𝑆𝜏≥𝐵then the rebate price ̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇) vanishes so that
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝑇).
In contrast, if the barrier is not triggered, max
𝑡≤𝜏≤𝑇𝑆𝜏< 𝐵, then under the risk-neutral mea-
sure ℚ
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
and
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇)
= 𝑅𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)1I𝑆𝜏<𝐵
||||
ℱ𝑡
]
= 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).
Thus, we can conclude that the European up-and-out/in barrier option prices with imme-
diate rebates are
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).

418
4.2.3 Further Barrier-Style Options
Finally, by substituting the values of 𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) and 𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) (see Prob-
lems 3.2.3.15 and 3.2.3.16, pages 339–345) and using the identity of standard normal den-
sity, we can express
𝑉𝑅
𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅[𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + 𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)]
= 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)𝜆+
+
(𝑆𝑡
𝐵
)𝜆−]
.
5. Down-and-Out/In Barrier Options with Immediate Rebates. Let {𝑊𝑡: 𝑡≥0} be a ℙ-
standard Wiener process on the probability space (Ω, ℱ, ℙ) and assume that we are in
the Black–Scholes world where at time 𝑡< 𝑇, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, and there is
a risk-free asset which earns interest at a constant rate 𝑟. Let 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price
of a European option satisfying the Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇. When incorporating
a rebate 𝑅payable at knock-out/knock-in time 𝜏, 𝑡≤𝜏≤𝑇, let 𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) be the European down-and-out and down-and-in options, respectively
with common barrier 𝐵, strike price 𝐾, rebate 𝑅and expiry time 𝑇.
By writing
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇)
where 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) and 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) are the European down-and-out and
down-and-in barrier option prices without rebates, respectively, whilst ̃𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
and ̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇) are the corresponding option prices associated with immediate rebate
at knock-out/knock-in time, show that
̃𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)

4.2.3 Further Barrier-Style Options
419
where 𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) and 𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) are the immediate-touch call and put options,
respectively defined as
𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)𝜆+
Φ(𝑑+) +
(𝑆𝑡
𝐵
)𝜆−
Φ(𝑑−)
and
𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) =
(𝑆𝑡
𝐵
)𝜆+
Φ(−𝑑+) +
(𝑆𝑡
𝐵
)𝜆−
Φ(−𝑑−)
such that
𝜆± =
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
𝑑± =
log(𝑆𝑡∕𝐵) ± (𝑇−𝑡)
√
(𝑟−𝐷−1
2𝜎2) + 2𝜎2𝑟
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢
is the cdf of a standard normal.
Finally, verify that
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)𝜆+
+
(𝑆𝑡
𝐵
)𝜆−]
.
Solution: At time 𝑡we first set up the portfolio Π𝑅
𝑑(𝑆𝑡, 𝑡) having the following options
Π𝑅
𝑑(𝑆𝑡, 𝑡) = 𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
where
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇),
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + ̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇).

420
4.2.3 Further Barrier-Style Options
At any time 𝜏, 𝑡≤𝜏≤𝑇, only one of the two barrier options can be active. If barrier
𝐵is triggered that is max
𝑡≤𝜏≤𝑇𝑆𝜏≤𝐵such that 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) vanishes then under the
risk-neutral measure ℚthe rebate price is
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐵, 𝑇)
= 𝑅𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)1I𝑆𝜏≤𝐵
||||
ℱ𝑡
]
= 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).
Correspondingly, if max
𝑡≤𝜏≤𝑇𝑆𝜏≤𝐵then the rebate price ̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇) vanishes so that
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇).
Conversely if 𝐵is never triggered, max
𝑡≤𝜏≤𝑇𝑆𝜏> 𝐵then under the risk-neutral measure ℚ
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
and
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = ̃𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐵, 𝑇)
= 𝑅𝔼ℚ
[
max
𝑡≤𝜏≤𝑇𝑒−𝑟(𝑇−𝜏)1I𝑆𝜏>𝐵
||||
ℱ𝑡
]
= 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).
Thus, we can conclude that the European down-and-out/in barrier option prices with imme-
diate rebates are
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑅𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑅𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇).
Finally, by subsituting the values of 𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) and 𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) (see Problems
3.2.3.15 and 3.2.3.16, pages 339–345) and using the identity of standard normal density,
we can write
𝑉𝑅
𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑅
𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) = 𝑉𝑑∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) + 𝑉𝑑∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[
𝑃𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇) + 𝐶𝐴𝑚
𝑑
(𝑆𝑡, 𝑡; 𝐵, 𝑇)
]
= 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
+𝑅
[(𝑆𝑡
𝐵
)𝜆+
+
(𝑆𝑡
𝐵
)𝜆−]
.

4.2.3 Further Barrier-Style Options
421
6. Reflection Principle Properties for Black–Scholes Equation. Assume we are in the Black–
Scholes world where at time 𝑡, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, 𝑊𝑡is the
standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟. Let 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) be the price of a European option satisfying the Black–Scholes
equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
where Ψ(𝑆𝑇) is the option payoff for a strike price 𝐾at expiry time 𝑇. Show that
𝑆𝑡𝑒−𝐷(𝑇−𝑡) and 𝐾𝑒−𝑟(𝑇−𝑡) satisfy the Black–Scholes equation. Hence, deduce from the
reflection principle that for a constant 𝐵
𝑆𝑡
(𝑆𝑡
𝐵
)−1−𝑟−𝐷
1
2 𝜎2 𝑒−𝐷(𝑇−𝑡) and 𝐾
(𝑆𝑡
𝐵
)1−𝑟−𝐷
1
2 𝜎2 𝑒−𝑟(𝑇−𝑡)
also satisfy the Black–Scholes equation.
Solution: By setting 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) we have
𝜕𝑉
𝜕𝑡= 𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡), 𝜕𝑉
𝜕𝑆𝑡
= 𝑒−𝐷(𝑇−𝑡) and 𝜕2𝑉
𝜕𝑆2
𝑡
= 0
and substituting the partial derivatives into the Black–Scholes equation we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + (𝑟−𝐷)𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝑟𝑆𝑡𝑒−𝐷(𝑇−𝑡)
= 0.
In contrast, by setting 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡) and taking partial derivatives
𝜕𝑉
𝜕𝑡= 𝑟𝐾𝑒−𝑟(𝑇−𝑡), 𝜕𝑉
𝜕𝑆𝑡
= 0 and 𝜕2𝑉
𝜕𝑆2
𝑡
= 0
and substituting them into the Black–Scholes equation we have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.
Therefore, we can conclude that both 𝑆𝑡𝑒−𝐷(𝑇−𝑡) and 𝐾𝑒−𝑟(𝑇−𝑡) satisfy the Black–Scholes
equation.

422
4.2.3 Further Barrier-Style Options
If 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the Black–Scholes equation then from the reflection principle
for a constant 𝐵, (𝑆𝑡∕𝐵)2𝛼𝑉(𝐵2∕𝑆𝑡, 𝑡; 𝐾, 𝑇) also satisfies the Black–Scholes equation
provided 𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
.
Hence, using the reflection principle
(𝑆𝑡
𝐵
)2𝛼(
𝐵2
𝑆𝑡
)
𝑒−𝐷(𝑇−𝑡) = 𝑆𝑡
(𝑆𝑡
𝐵
)2(𝛼−1)
𝑒−𝐷(𝑇−𝑡) = 𝑆𝑡
(𝑆𝑡
𝐵
)−1−𝑟−𝐷
1
2 𝜎2 𝑒−𝐷(𝑇−𝑡)
and
(𝑆𝑡
𝐵
)2𝛼
𝐾𝑒−𝑟(𝑇−𝑡) = 𝐾
(𝑆𝑡
𝐵
)1−𝑟−𝐷
1
2 𝜎2 𝑒−𝑟(𝑇−𝑡)
would yield an additional two solutions to the Black–Scholes equation.
7. Reflection Principle for Black Equation. Assume we are in the Black–Scholes world where
at time 𝑡, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, 𝑊𝑡is the
standard Wiener process and there is a risk-free asset which earns interest at a constant
rate 𝑟. Recall that the price of a futures contract at delivery time 𝑇on an asset 𝑆𝑡at time
𝑡is 𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and for an option with value 𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) on a futures
𝐹(𝑡, 𝑇) with strike price 𝐾, expiry time 𝜏< 𝑇the corresponding Black formula is
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 0.
Show that if 𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) is a solution to the above equation, then so is
(𝐹(𝑡, 𝑇)∕𝐵)𝑉(𝐵2∕𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
for any constant 𝐵.
Hence, for a constant 𝐵, show that the prices of European call 𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) and
put 𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) options on 𝐹(𝑡, 𝑇) with the same strike 𝐾and expiry 𝜏< 𝑇have
the following relationships
𝐾
𝐵𝐶𝑏𝑠
(
𝐹(𝑡, 𝑇), 𝑡; 𝐵2
𝐾, 𝜏
)
= 𝐹(𝑡, 𝑇)
𝐵
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
and
𝐾
𝐵𝑃𝑏𝑠
(
𝐹(𝑡, 𝑇), 𝑡; 𝐵2
𝐾, 𝜏
)
= 𝐹(𝑡, 𝑇)
𝐵
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
.

4.2.3 Further Barrier-Style Options
423
Solution: Let ̂𝐹(𝑡, 𝑇) =
𝐵2
𝐹(𝑡, 𝑇) and define
̂𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐹(𝑡, 𝑇)
𝐵
𝑉
(
̂𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
.
By differentiating ̂𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) with respect to 𝑡and 𝐹(𝑡, 𝑇) we have
𝜕̂𝑉
𝜕𝑡= 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕𝑡
𝜕̂𝑉
𝜕𝐹= 𝑉( ̂𝐹(𝑡, 𝑇), 𝑡)
𝐵
+ 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕̂𝐹
𝜕̂𝐹
𝜕𝐹
= 𝑉( ̂𝐹(𝑡, 𝑇), 𝑡)
𝐵
+ 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕̂𝐹
(
−
𝐵2
𝐹(𝑡, 𝑇)2
)
= 𝑉( ̂𝐹(𝑡, 𝑇), 𝑡)
𝐵
−
𝐵
𝐹(𝑡, 𝑇)
𝜕𝑉
𝜕̂𝐹
and
𝜕2 ̂𝑉
𝜕𝐹2 = 1
𝐵
𝜕𝑉
𝜕̂𝐹
𝜕̂𝐹
𝜕𝐹+
𝐵
𝐹(𝑡, 𝑇)2
𝜕𝑉
𝜕̂𝐹
−
𝐵
𝐹(𝑡, 𝑇)
𝜕2𝑉
𝜕̂𝐹2
𝜕̂𝐹
𝜕𝐹
= −
𝐵
𝐹(𝑡, 𝑇)2
𝜕𝑉
𝜕̂𝐹
+
𝐵
𝐹(𝑡, 𝑇)2
𝜕𝑉
𝜕̂𝐹
+
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2
=
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2 .
By substituting the above expressions into the Black formula we have
𝜕̂𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2 ̂𝑉
𝜕𝐹2 −𝑟̂𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
= 𝐹(𝑡, 𝑇)
𝐵
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2
(
𝐵
𝐹(𝑡, 𝑇)
)3 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝐹(𝑡, 𝑇)
𝐵
𝑉( ̂𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
= 𝐹(𝑡, 𝑇)
𝐵
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2
(
𝐵
𝐹(𝑡, 𝑇)
)2 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝑉( ̂𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
]
= 𝐹(𝑡, 𝑇)
𝐵
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2 ̂𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝑉( ̂𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
]
= 0
since
𝜕𝑉
𝜕𝑡+ 1
2𝜎2 ̂𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕̂𝐹2 −𝑟𝑉( ̂𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 0.
Hence, for a constant 𝐵, (𝐹(𝑡, 𝑇)∕𝐵)𝑉(𝐵2∕𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) also satisfies the Black
formula.

424
4.2.3 Further Barrier-Style Options
Finally, to show the relationship between the call and put options on 𝐹(𝑡, 𝑇) we note
that at expiry 𝜏< 𝑇
𝐶𝑏𝑠(𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏) = max {𝐹(𝜏, 𝑇) −𝐾, 0}
𝑃𝑏𝑠(𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏) = max {𝐾−𝐹(𝜏, 𝑇), 0} .
Thus,
𝐹(𝜏, 𝑇)
𝐵
𝑃𝑏𝑠
(
𝐵2
𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏
)
= 𝐹(𝜏, 𝑇)
𝐵
max
{
𝐾−
𝐵2
𝐹(𝜏, 𝑇), 0
}
= 𝐹(𝜏, 𝑇)
𝐵
𝐾
𝐹(𝜏, 𝑇) max
{
𝐹(𝜏, 𝑇) −𝐵2
𝐾, 0
}
= 𝐾
𝐵max
{
𝐹(𝜏, 𝑇) −𝐵2
𝐾, 0
}
= 𝐾
𝐵𝐶𝑏𝑠
(
𝐹(𝜏, 𝑇), 𝜏; 𝐵2
𝐾, 𝜏
)
and similarly
𝐹(𝜏, 𝑇)
𝐵
𝐶𝑏𝑠
(
𝐵2
𝐹(𝜏, 𝑇), 𝜏; 𝐾, 𝜏
)
= 𝐹(𝜏, 𝑇)
𝐵
max
{
𝐵2
𝐹(𝜏, 𝑇) −𝐾, 0
}
= 𝐹(𝜏, 𝑇)
𝐵
𝐾
𝐹(𝜏, 𝑇) max
{
𝐵2
𝐾−𝐹(𝜏, 𝑇), 0
}
= 𝐾
𝐵max
{
𝐵2
𝐾−𝐹(𝜏, 𝑇), 0
}
= 𝐾
𝐵𝑃𝑏𝑠
(
𝐹(𝜏, 𝑇), 𝜏; 𝐵2
𝐾, 𝜏
)
.
Hence, for all 𝑡< 𝜏we can deduce that
𝐾
𝐵𝐶𝑏𝑠
(
𝐹(𝑡, 𝑇), 𝑡; 𝐵2
𝐾, 𝜏
)
= 𝐹(𝑡, 𝑇)
𝐵
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
and
𝐾
𝐵𝑃𝑏𝑠
(
𝐹(𝑡, 𝑇), 𝑡; 𝐵2
𝐾, 𝜏
)
= 𝐹(𝑡, 𝑇)
𝐵
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
.
8. Knock-Out and Knock-In Options on Futures. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and assume we are in the Black–Scholes world
where at time 𝑡, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, and there is
a risk-free asset which earns interest at a constant rate 𝑟.

4.2.3 Further Barrier-Style Options
425
Given that the price of a futures contract at delivery time 𝑇on an asset 𝑆𝑡at time 𝑡is
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) and under the risk-neutral measure ℚ, find the European up-and-
out/in and down-and-out/in call and put options on futures at time 𝑡, expiring at time 𝜏≤𝑇
with strike price 𝐾and barrier 𝐵.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
=
(𝜇−𝑟
𝜎
)
𝑡+ 𝑊𝑡is a ℚ-standard Wiener process. For 𝑇> 𝑡and given
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡), from Taylor’s theorem
𝑑𝐹(𝑡, 𝑇) = 𝜕𝐹(𝑡, 𝑇)
𝜕𝑡
𝑑𝑡+ 𝜕𝐹(𝑡, 𝑇)
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝐹(𝑡, 𝑇)
𝜕𝑡2
(𝑑𝑡)2 + ⋯
and by applying It¯o’s lemma we have
𝑑𝐹(𝑡, 𝑇)
𝐹(𝑡, 𝑇) = 𝜎𝑑𝑊ℚ
𝑡.
Hence, for 𝜏≤𝑇the solution to the above SDE is
𝐹(𝜏, 𝑇) = 𝐹(𝑡, 𝑇)𝑒𝜎̂
𝑊𝜏−𝑡
where ̂
𝑊𝜏−𝑡= −1
2𝜎(𝑇−𝑡) + 𝑊ℚ
𝜏−𝑡.
By comparing both the SDEs for an asset price 𝑆𝑡and the futures price 𝐹(𝑡, 𝑇), the
equivalent up-and-out/in and down-and-out/in call and put option prices for futures expir-
ing at 𝜏≤𝑇can by setting 𝑟−𝐷= 0 and replacing 𝑆𝑡with 𝐹(𝑡, 𝑇) so that
𝐶𝑢∕𝑜(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
−[𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏) + (𝐵−𝐾)𝐶𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)]
−𝐹(𝑡, 𝑇)
𝐵
{
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐵−𝐾)𝐶𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏, 𝐵
)]}
𝐶𝑢∕𝑖(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏) + (𝐵−𝐾)𝐶𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
+𝐹(𝑡, 𝑇)
𝐵
{
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
−
[
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐵−𝐾)𝐶𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]}

426
4.2.3 Further Barrier-Style Options
𝐶𝑑∕𝑜(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
−𝐹(𝑡, 𝑇)
𝐵
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
if 𝐵≤𝐾
𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝜏, 𝐵)
+(𝐵−𝐾)𝐶𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
−𝐹(𝑡, 𝑇)
𝐵
[
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
if 𝐵> 𝐾
+(𝐵−𝐾)𝐶𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]
𝐶𝑑∕𝑖(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
𝐹(𝑡, 𝑇)
𝐵
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
if 𝐵≤𝐾
𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
−𝐶𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
−(𝐵−𝐾)𝐶𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
if 𝐵> 𝐾
+𝐹(𝑡, 𝑇)
𝐵
[
𝐶𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐵−𝐾)𝐶𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]
𝑃𝑢∕𝑜(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
−𝐹(𝑡, 𝑇)
𝐵
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
if 𝐵≥𝐾
𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
+(𝐾−𝐵)𝑃𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
−𝐹(𝑡, 𝑇)
𝐵
[
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
if 𝐵< 𝐾
+(𝐾−𝐵)𝑃𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]
𝑃𝑢∕𝑖(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪⎩
𝐹(𝑡, 𝑇)
𝐵
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
if 𝐵≥𝐾
𝐹(𝑡, 𝑇)
𝐵
[
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐾−𝐵)𝑃𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]
if 𝐵< 𝐾
−(𝐾−𝐵)𝑃𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)

4.2.3 Further Barrier-Style Options
427
𝑃𝑑∕𝑜(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏)
−[𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏) + (𝐾−𝐵)𝑃𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)]
−𝐹(𝑡, 𝑇)
𝐵
{
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐾−𝐵)𝑃𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]}
𝑃𝑑∕𝑖(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏) = 𝑃𝑏𝑠(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏) + (𝐾−𝐵)𝑃𝑑(𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏)
+𝐹(𝑡, 𝑇)
𝐵
{
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝜏
)
−
[
𝑃𝑏𝑠
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)
+(𝐾−𝐵)𝐶𝑑
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡; 𝐵, 𝜏
)]}
where 𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝜏) and 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝜏) are the vanilla and digital call options on futures
defined as
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝜏) = 𝑒−𝑟(𝑇−𝑡)
[
𝑋Φ
(log(𝑋∕𝑌) + 1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)
−𝑌Φ
(log(𝑋∕𝑌) −1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)]
and
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝜏) = 𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) −1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)
and 𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝜏) and 𝑃𝑑(𝑋, 𝑡; 𝑌, 𝜏) are the vanilla and digital put options on futures
defined as
𝑃𝑏𝑠(𝑋, 𝑡; 𝑌, 𝜏) = 𝑒−𝑟(𝑇−𝑡)
[
𝑌Φ
(−log(𝑋∕𝑌) + 1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)
−𝑋Φ
(−log(𝑋∕𝑌) −1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)]

428
4.2.3 Further Barrier-Style Options
and
𝑃𝑑(𝑋, 𝑡; 𝑌, 𝜏) = 𝑒−𝑟(𝑇−𝑡)Φ
(−log(𝑋∕𝑌) + 1
2𝜎2(𝜏−𝑡)
𝜎(𝜏−𝑡)
)
respectively. Note that Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
9. Knock-Out Equity Accumulator. Assume we are in the Black–Scholes world where at time
𝑡, the asset price 𝑆𝑡follows the SDE
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where 𝜇, 𝐷and 𝜎> 0 are the drift, dividend yield and volatility, respectively, 𝑊𝑡is the
ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and there is a risk-free asset
which earns interest at a constant rate 𝑟.
An accumulator is a product that accumulates a specific asset at a fixed strike price 𝐾
every day until the contract expires at time 𝑇or the asset price rises above a preset barrier
level 𝐵. Here, 𝐾is set below the asset price 𝑆𝑡at initial time 𝑡< 𝑇and 𝐾< 𝑆𝑡< 𝐵.
By denoting 𝑁as the number of days between 𝑡and 𝑇, show that under the risk-neutral
measure ℚthe present value of this product at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
𝑁
∑
𝑖=1
[𝐶𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖) −𝑃𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖)]
where 𝑡𝑖= 𝑡+
(
𝑖−1
𝑁−1
)
(𝑇−𝑡), 𝑖= 1, 2, … , 𝑁, 𝐶𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖) and 𝑃𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖)
are the up-and-out European call and put options evaluated at time 𝑡with common strike
𝐾, barrier 𝐵and expiry time 𝑡𝑖, respectively.
Solution: From the definition of the equity accumulator, the payoff on date 𝑡𝑖is a futures
contract with a knock-out barrier 𝐵where it can be decomposed into a long up-and-out
European call option and a short up-and-out European put option (see Figure 4.9) for the
construction of the accumulator payoff.
By denoting Ψ(𝑆𝑡𝑖) as the payoff on date 𝑡𝑖, 𝑖= 1, 2, … , 𝑁we can write
Ψ(𝑆𝑡𝑖) = max
{
𝑆𝑡𝑖−𝐾, 0
}
1I{ max
𝑡≤𝑢≤𝑡𝑖
𝑆𝑢< 𝐵}
−max
{
𝐾−𝑆𝑡𝑖, 0
}
1I{ max
𝑡≤𝑢≤𝑡𝑖
𝑆𝑢< 𝐵}
and the total accumulated payoff is therefore
Ψ(𝑆𝑡1, 𝑆𝑡2, … , 𝑆𝑡𝑛) =
𝑁
∑
𝑖=1
Ψ(𝑆𝑡𝑖).

4.2.3 Further Barrier-Style Options
429
−
−
−
−
−
Figure 4.9
Accumulator payoff diagram.
From the risk-neutral measure ℚ, the value of the accumulator contract at time 𝑡is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) =
𝑁
∑
𝑖=1
𝑒−𝑟(𝑡𝑖−𝑡)𝔼ℚ[
Ψ(𝑆𝑡𝑖)||| ℱ𝑡
]
=
𝑁
∑
𝑖=1
𝑒−𝑟(𝑡𝑖−𝑡)𝔼ℚ
[
max
{
𝑆𝑡𝑖−𝐾, 0
}
1I{ max
𝑡≤𝑢≤𝑡𝑖
𝑆𝑢< 𝐵}
|||||
ℱ𝑡
]
−
𝑁
∑
𝑖=1
𝑒−𝑟(𝑡𝑖−𝑡)𝔼ℚ
[
max
{
𝐾−𝑆𝑡𝑖, 0
}
1I{ max
𝑡≤𝑢≤𝑡𝑖
𝑆𝑢< 𝐵}
|||||
ℱ𝑡
]
=
𝑁
∑
𝑖=1
[𝐶𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖) −𝑃𝑢∕𝑜(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑡𝑖)] .
10. Merton Model for Default of a Company II. At time 𝑡, we assume that the asset 𝐴𝑡of a
company satisfies the SDE
𝑑𝐴𝑡
𝐴𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡

430
4.2.3 Further Barrier-Style Options
where 𝜇is the drift parameter, 𝜎> 0 is the volatility and {𝑊𝑡: 𝑡≥0} is a standard Wiener
process on the probability space (Ω, ℱ, ℙ). The risk-free interest rate is denoted by 𝑟. In
financial accounting, the asset 𝐴𝑡is a combination of equity 𝐸𝑡and debt 𝐷𝑡so that
𝐴𝑡= 𝐸𝑡+ 𝐷𝑡
where, if at any time 𝑡≤𝑇, the company will be in default if 𝐴𝑡< 𝐹where 𝐹> 0 is
the face value and the debt holders will receive 𝐴𝑡whilst the equity holders will receive
nothing. In contrast, if the company is not in default by time 𝑡≤𝑇, the debt holders will
receive 𝐹and the equity holders will receive the rest of the value of the company.
By constructing the payoff diagrams for 𝐸𝑇and 𝐷𝑇, and using the reflection principle,
find the values of 𝐸𝑡and 𝐷𝑡for all 𝑡≤𝑇under the Black–Scholes framework.
Solution: Following Problem 2.2.2.30 (page 158) at terminal time 𝑇, the payoff diagram
for equity shareholders is given in Figure 4.10.
Because the company can default at any time 𝑡≤𝑇, we can write 𝐸𝑇as
𝐸𝑇= max{𝐴𝑇−𝐹, 0}1I{ min
𝑡≤𝑢≤𝑇𝐴𝑢> 𝐹}
which is a down-and-out European call option on the assets with strike and barrier equal
to the face value.
By discounting the entire payoff under the risk-neutral measure ℚand using the reflec-
tion principle, we can write 𝐸𝑡as
𝐸𝑡= 𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇) −
(𝐴𝑡
𝐹
)2𝛼
𝐶
(
𝐹2
𝐴𝑡
, 𝑡; 𝐹, 𝑇
)
Figure 4.10
Payment to equity holders at time 𝑇.

4.2.3 Further Barrier-Style Options
431
Figure 4.11
Payment to debt holders at time 𝑇.
where 𝛼= 1
2
(
1 −
𝑟
1
2𝜎2
)
, 𝑟is the risk-free interest rate,
𝐶(𝑋, 𝑡; 𝑌, 𝑇) = 𝑋Φ
(log(𝑋∕𝑌) + (𝑟+ 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑌𝑒−𝑟(𝑇−𝑡)Φ
(log(𝑋∕𝑌) + (𝑟−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
As for payment to the debt holders, the payoff diagram at time 𝑇is given in Figure 4.11.
Given that the debt at terminal time 𝑇is
𝐷𝑇= 𝐴𝑇−𝐸𝑇
by discounting the payoff under the risk-neutral measure ℚand from the results of the
equity holders at time 𝑡
𝐷𝑡= 𝐴𝑡−𝐸𝑡
= 𝐴𝑡−𝐶(𝐴𝑡, 𝑡; 𝐹, 𝑇) +
(𝐴𝑡
𝐹
)2𝛼
𝐶
(
𝐹2
𝐴𝑡
, 𝑡; 𝐹, 𝑇
)
.

432
4.2.3 Further Barrier-Style Options
11. Consider a binomial tree model for an underlying asset process {𝑆𝑛: 0 ≤𝑛≤3} following
the Cox–Ross–Rubinstein model. With the initial asset price 𝑆0 = 100, let
𝑆𝑛+1 =
⎧
⎪
⎨
⎪⎩
𝑢𝑆𝑛
with probability 𝜋
𝑑𝑆𝑛
with probability 1 −𝜋
where 𝑢= 𝑒𝜎
√
Δ𝑡and 𝑑= 1∕𝑢, with 𝜎the volatility and Δ𝑡the binomial time step. Assum-
ing the risk-free interest rate 𝑟= 3%, continuous dividend yield 𝐷= 1% and volatility
𝜎= 4%, find the price of a European-style up-and-out barrier call option at time 𝑡= 0
with strike 𝐾= 95, barrier 𝐵= 102 with expiry time 𝑇= 1 year in a 3-period binomial
tree model.
Solution: Given 𝑆0 = 100, 𝐾= 95, 𝑟= 0.03, 𝐷= 0.01, 𝜎= 0.04 and time step Δ𝑡= 1
3,
we have
𝑢= 𝑒𝜎
√
Δ𝑡= 𝑒
0.04
√
3 = 1.0233
and
𝑑= 𝑒−𝜎
√
Δ𝑡= 1
𝑢=
1
1.0233 = 0.9772.
Therefore, the risk-neutral probabilities are
𝜋= 𝑒(𝑟−𝐷)Δ𝑡−𝑑
𝑢−𝑑
= 0.6390
and
1 −𝜋= 1 −0.6390 = 0.3610.
The binomial tree in Figure 4.12 shows the price movement of 𝑆0 in a 3-period binomial
model.
By setting
𝑆(𝑗)
𝑖
= 𝑢𝑗𝑑𝑖−𝑗𝑆0,
𝑖= 0, 1, … , 𝑛,
𝑗= 0, 1, … , 𝑖
the up-and-out call option price at each of the lattice points is
𝑉(𝑗)
𝑖
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(𝑗+1)
𝑖+1
+ (1 −𝜋)𝑉(𝑗)
𝑖+1
]
if 𝑆(𝑗)
𝑖
< 𝐵
0
if 𝑆(𝑗)
𝑖
≥𝐵
where 𝑖= 0, 1, … , 𝑛and 𝑗= 0, 1, … , 𝑖.

4.2.3 Further Barrier-Style Options
433
Figure 4.12
A 3-period binomial tree model.
At terminal node 𝑖= 𝑛
𝑉(𝑗)
𝑛
= Ψ(𝑆(𝑗)
𝑛) =
⎧
⎪
⎨
⎪⎩
max
{
𝑆(𝑗)
𝑛
−𝐾, 0
}
if 𝑆(𝑗)
𝑛
< 𝐵
0
if 𝑆(𝑗)
𝑛
≥𝐵.
At time period 𝑛= 3 (i.e., option expiry time 𝑇= 1 year)
𝑉(0)
3
= Ψ(𝑆(0)
3 )
=
⎧
⎪
⎨
⎪⎩
max {𝑑3𝑆0 −𝐾, 0}
if 𝑑3𝑆0 < 𝐵
0
if 𝑑3𝑆0 ≥𝐵
= max{0.97723 × 100 −95, 0}
= 0
𝑉(1)
3
= Ψ(𝑆(1)
3 )
=
⎧
⎪
⎨
⎪⎩
max {𝑢𝑑2𝑆0 −𝐾, 0}
if 𝑢𝑑2𝑆0 < 𝐵
0
if 𝑢𝑑2𝑆0 ≥𝐵
= max{1.0233 × 0.97722 × 100 −95, 0}
= 0.27169

434
4.2.3 Further Barrier-Style Options
𝑉(2)
3
= Ψ(𝑆(2)
3 )
=
⎧
⎪
⎨
⎪⎩
max {𝑢2𝑑𝑆0 −𝐾, 0}
if 𝑢2𝑑𝑆0 < 𝐵
0
if 𝑢2𝑑𝑆0 ≥𝐵
= 0
𝑉(3)
3
= Ψ(𝑆(3)
3 )
=
⎧
⎪
⎨
⎪⎩
max {𝑢3𝑆0 −𝐾, 0}
if 𝑢3𝑆0 < 𝐵
0
if 𝑢3𝑆0 ≥𝐵
= 0.
At time period 𝑛= 2
𝑉(0)
2
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
if 𝑑2𝑆0 < 𝐵
0
if 𝑑2𝑆0 ≥𝐵
= 𝑒−0.03
3 [0.6390 × 2.7169 + 0.3610 × 0]
= 1.7188
𝑉(1)
2
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
3
+ (1 −𝜋)𝑉(1)
3
]
if 𝑢𝑑𝑆0 < 𝐵
0
if 𝑢𝑑𝑆0 ≥𝐵
= 𝑒−0.03
3 [0.6390 × 0 + 0.3610 × 2.7169]
= 0.9710
𝑉(2)
2
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
3
+ (1 −𝜋)𝑉(0)
3
]
if 𝑢2𝑆0 < 𝐵
0
if 𝑢2𝑆0 ≥𝐵
= 0.
At time period 𝑛= 1
𝑉(0)
1
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
2
+ (1 −𝜋)𝑉(0)
2
]
if 𝑑𝑆0 < 𝐵
0
if 𝑑𝑆0 ≥𝐵
= 𝑒−0.03
3 [0.6390 × 0.9710 + 0.3610 × 1.7188]
= 1.2286

4.2.3 Further Barrier-Style Options
435
𝑉(1)
1
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(2)
2
+ (1 −𝜋)𝑉(1)
2
]
if 𝑢𝑆0 < 𝐵
0
if 𝑢𝑆0 ≥𝐵
= 0.
Finally, at time period 𝑛= 0
𝑉(0)
0
=
⎧
⎪
⎨
⎪⎩
𝑒−𝑟Δ𝑡[
𝜋𝑉(1)
1
+ (1 −𝜋)𝑉(0)
1
]
if 𝑆0 < 𝐵
0
if 𝑆0 ≥𝐵
= 𝑒−0.03
3 [0.6390 × 0 + 0.3610 × 1.2286]
= 0.4391.
Therefore, the price of the up-and-out call option based on a 3-period binomial model is
𝑉(0)
0
= 0.4391.
12. Table 4.1 shows the up-and-in call option 𝐶𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇) prices on an asset 𝑆𝑡= $30,
strike 𝐾= $35, time to expiry 𝑇−𝑡= 9 months for various barrier values 𝐵.
Table 4.1
European call up-and-in
prices for different barriers.
𝐵
𝐶𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵, 𝑇)
0
1.76119
10
1.76100
20
1.76076
30
1.76061
40
1.66433
50
0.75711
60
0.19322
By considering the following payoff
Ψ(𝑆𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
3 max{𝑆𝑇−𝐾, 0}
if 0 ≤𝑆𝑇< 40
2 max{𝑆𝑇−𝐾, 0}
if 40 ≤𝑆𝑇< 60
0
if 𝑆𝑇≥60
calculate the price of this 9-month 35-strike European “partial barrier” option.
Solution: By setting 𝐵1 = 40 and 𝐵2 = 60, the payoff Ψ(𝑆𝑇) can be constructed by
adding two payoffs Ψ1(𝑆𝑇) = 3 max{𝑆𝑇−𝐾, 0}1I0≤𝑆𝑇<𝐵1 and Ψ2(𝑆𝑇) = 2 max{𝑆𝑇−
𝐾, 0}1I𝐵1≤𝑆𝑇<𝐵2 (see Figure 4.13).

436
4.2.3 Further Barrier-Style Options
Figure 4.13
Construction of payoff Ψ(𝑆𝑇).
For payoff Ψ1(𝑆𝑇) it is essentially a multiple of an up-and-out call option
𝐶𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇) such that
Ψ1(𝑆𝑇) = 3𝐶𝑢∕𝑜(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇)
= 3 [𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇)]
where 𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) is the European call option payoff with strike 𝐾.
In contrast, for payoff Ψ2(𝑆𝑇) it can be constructed as in Figure 4.14.
This is a difference between two multiples of up-and-in call options
Ψ2(𝑆𝑇) = 2 [𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵2, 𝑇)] .
Collectively we can express Ψ(𝑆𝑇) as
Ψ(𝑆𝑇) = Ψ1(𝑆𝑇) + Ψ2(𝑆𝑇)
= 3 [𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇)]
+2 [𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵2, 𝑇)]
= 3𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵1, 𝑇) −2𝐶𝑢∕𝑖(𝑆𝑇, 𝑇; 𝐾, 𝐵2, 𝑇)

4.2.3 Further Barrier-Style Options
437
Figure 4.14
Construction of payoff Ψ2(𝑆𝑇).
and by discounting the payoff back to time 𝑡, the option price is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝐵1, 𝐵2, 𝑇) = 3𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵1, 𝑇)
−2𝐶𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 𝐵2, 𝑇)
= 3 × 1.76110 −1.66433 −2 × 0.19322
= $3.23253
since 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐶𝑢∕𝑖(𝑆𝑡, 𝑡; 𝐾, 0, 𝑇) for barrier 𝐵= 0.


5
Asian Options
In this chapter we look at the pricing of Asian options or average options, which are another
popular variant of exotic options. However, unlike barrier options which are weakly path-
dependent, Asian options are truly path-dependent options as their payoffs depend on the
history of the underlying asset price during its contract period. In the simplest terms, Asian
options have payoffs that depend on the average price of the underlying asset over a prede-
termined period of time as opposed to the options’ expiry time. Given that the average of an
underlying asset price is less volatile than the asset path, Asian options can be cheaper than
their equivalent European or American options.
5.1
INTRODUCTION
In general, an Asian option is an option whose payoff depends on the average of the asset price
over some prespecified period of time and observation frequency during the option contract
time. For an investor, buying Asian options provides a cost-efficient way of hedging cash or
asset flows over extended periods of time as the averaging features make the payoff less sus-
ceptible to large asset price movements, including attempts to manipulate the price just before
expiry.
There are two kinds of averaging techniques used in Asian options
s arithmetic
s geometric
where the average can be measured discretely or continuously, weighted or unweighted. The
majority of Asian options trading in the OTC exchange are mainly arithmetic average prices
with European-style payoffs. However, no closed-form solution exists for these options due to
the fact that the arithmetic average is not lognormally distributed even when all the individual
asset prices follow a lognormal process. As such, the option prices often rely on numerical
techniques or approximation methods. In contrast, although being less common in practice,
geometric averaging with a European-style payoff has a closed-form solution since geometric
averages are also lognormally distributed when all the individual prices follow a lognormal
process.
In the discretely sampled arithmetic average case, it is defined as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
whilst the discretely sampled geometric average is defined as
𝐺𝑛(𝜏, 𝑇) =
𝑛
∏
𝑖=1
(
𝑆𝑡𝑖
) 1
𝑛

440
5.1 INTRODUCTION
where 𝜏≤𝑡1 < 𝑡2 < ⋯< 𝑡𝑛−1 < 𝑡𝑛≤𝑇are the sampling dates over the time period [𝜏, 𝑇] and
𝑆𝑡𝑖, 𝑖= 1, 2, … , 𝑛is the asset price at time 𝑡𝑖.
For the continuously sampled arithmetic average, it is defined as
𝐴(𝜏, 𝑇) =
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
and the corresponding continuous geometric average is defined as
𝐺(𝜏, 𝑇) = 𝑒
1
𝑇−𝜏∫𝑇
𝜏𝑆𝑢𝑑𝑢
where the asset price 𝑆𝑢, 𝑢∈[𝜏, 𝑇] is continuously monitored over the time period [𝜏, 𝑇].
Within the family of Asian option payoffs, we can group them into average rate (fixed strike)
and average strike (floating strike) options payoffs.
Average Rate (Fixed Strike) Option Payoff
For a fixed strike or exercise price 𝐾, the average rate (fixed strike) Asian payoff can be sub-
divided into the following:
s For discretely sampled arithmetic average
Ψ(𝑆𝑇, 𝐴𝑛(𝜏, 𝑇)) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
max
{
1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖−𝐾, 0
}
for call option
max
{
𝐾−1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖, 0
}
for put option.
s For discretely sampled geometric average
Ψ(𝑆𝑇, 𝐺𝑛(𝜏, 𝑇)) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
max
{ 𝑛
∏
𝑖=1
(
𝑆𝑡𝑖
) 1
𝑛−𝐾, 0
}
for call option
max
{
𝐾−
𝑛
∏
𝑖=1
(
𝑆𝑡𝑖
) 1
𝑛, 0
}
for put option.
s For continuously sampled arithmetic average
Ψ(𝑆𝑇, 𝐴(𝜏, 𝑇)) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
max
{
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢−𝐾, 0
}
for call option
max
{
𝐾−
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢, 0
}
for put option.

5.1 INTRODUCTION
441
s For continuously sampled geometric average
Ψ(𝑆𝑇, 𝐺(𝜏, 𝑇)) =
⎧
⎪
⎨
⎪⎩
max
{
𝑒
1
𝑇−𝜏∫𝑇
𝜏𝑆𝑢𝑑𝑢−𝐾, 0
}
for call option
max
{
𝐾−𝑒
1
𝑇−𝜏∫𝑇
𝜏𝑆𝑢𝑑𝑢, 0
}
for put option.
Average Strike (Floating Strike) Option Payoff
With 𝑆𝑇being the asset price at the option expiry time 𝑇, the average strike (floating strike)
Asian payoff can be subdivided into the following:
s For discretely sampled arithmetic average
Ψ(𝑆𝑇, 𝐴𝑛(𝜏, 𝑇)) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
max
{
𝑆𝑇−1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖, 0
}
for call option
max
{
1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖−𝑆𝑇, 0
}
for put option.
s For discretely sampled geometric average
Ψ(𝑆𝑇, 𝐺𝑛(𝜏, 𝑇)) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪⎩
max
{
𝑆𝑇−
𝑛
∏
𝑖=1
(
𝑆𝑡𝑖
) 1
𝑛, 0
}
for call option
max
{ 𝑛
∏
𝑖=1
(
𝑆𝑡𝑖
) 1
𝑛−𝑆𝑇, 0
}
for put option.
s For continuously sampled arithmetic average
Ψ(𝑆𝑇, 𝐴(𝜏, 𝑇)) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
max
{
𝑆𝑇−
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢, 0
}
for call option
max
{
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢−𝑆𝑇, 0
}
for put option.
s For continuously sampled geometric average
Ψ(𝑆𝑇, 𝐺(𝜏, 𝑇)) =
⎧
⎪
⎨
⎪⎩
max
{
𝑆𝑇−𝑒
1
𝑇−𝜏∫𝑇
𝜏𝑆𝑢𝑑𝑢, 0
}
for call option
max
{
𝑒
1
𝑇−𝜏∫𝑇
𝜏𝑆𝑢𝑑𝑢−𝑆𝑇, 0
}
for put option.

442
5.1 INTRODUCTION
Put–Call Parity
Like its counterparts in European options, there are also put–call parity relationships for
European-style Asian options with continuous sampling under the Black–Scholes framework.
At time 𝑡we assume that the asset price 𝑆𝑡has the following SDE under the risk-neutral mea-
sure ℚ
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield, 𝜎is the volatility and
𝑊𝑡is the ℚ-standard Wiener process. In addition, let
𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
and
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
.
By defining 𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) (𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇)) to be the arithmetic average rate call (put)
option price written on 𝑆𝑡with strike price 𝐾and expiry 𝑇, we have the arithmetic average
rate (fixed strike) put–call relation as
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝐷(𝑇−𝜏) −𝑒−𝑟(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
𝑆𝑡+
(
𝐼𝑡
𝑇−𝜏−𝐾
)
𝑒−𝑟(𝑇−𝜏).
Similarly, by defining 𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) (𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇)) to be the arithmetic average strike
call (put) option price written on 𝑆𝑡with floating strike price
𝐼𝑇
𝑇−𝜏and expiry 𝑇, we have the
arithmetic average strike (floating strike) put–call relation as
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇)
= 𝑒−𝐷(𝑇−𝜏) −𝑒−𝑟(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
((𝑟−𝐷)(𝑇−𝜏) −1) 𝑆𝑡+
(
𝑆𝑡−
𝐼𝑡
𝑇−𝜏
)
𝑒−𝑟(𝑇−𝜏).
In contrast, by defining 𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) (𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇)) to be the geometric average
rate call (put) option price written on 𝑆𝑡with strike price 𝐾and expiry 𝑇, we have the geo-
metric average rate (fixed strike) put–call relation as
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡).

5.2.1 Discrete Sampling
443
Finally, by defining 𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) (𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇)) to be the geometric average strike call
(put) option price written on 𝑆𝑡with floating strike price
𝐼𝑇
𝑇−𝜏and expiry 𝑇, we have the
geometric average strike (floating strike) put–call relation as
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡).
5.2
PROBLEMS AND SOLUTIONS
5.2.1
Discrete Sampling
1. Limit of Discrete Arithmetic Average. Let the time interval [𝜏, 𝑇] be partitioned into 𝑛
equal subintervals each of length Δ𝑡= 𝑇−𝜏
𝑛
and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the stock price at
the end of the 𝑖th interval, 𝑖= 1, 2, … , 𝑛. By denoting the discretely measured arithmetic
average of the stock price as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
show that in the limit 𝑛→∞,
lim
𝑛→∞𝐴𝑛(𝜏, 𝑇) =
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢.
Solution: By definition
∫
𝑇
𝜏
𝑆𝑢𝑑𝑢= lim
𝑛→∞
𝑛
∑
𝑖=1
𝑆𝑡𝑖(𝑡𝑖+1 −𝑡𝑖) = lim
𝑛→∞
𝑛
∑
𝑖=1
𝑆𝑡𝑖Δ𝑡= lim
𝑛→∞
𝑇−𝜏
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and hence
lim
𝑛→∞
1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖=
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢.
2. Limit of Discrete Geometric Average. Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal
subintervals each of length Δ𝑡= (𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the stock price at
the end of the 𝑖th interval, 𝑖= 1, 2, … , 𝑛. By denoting the discretely measured geometric
average of the stock price as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛

444
5.2.1 Discrete Sampling
show that in the limit 𝑛→∞,
lim
𝑛→∞𝐺𝑛(𝜏, 𝑇) = 𝑒
1
𝑇−𝜏∫𝑇
𝜏log 𝑆𝑢𝑑𝑢.
Solution: Given 𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
we can write
log 𝐺𝑛(𝜏, 𝑇) = 1
𝑛log
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
)
= 1
𝑛
𝑛
∑
𝑖=1
log 𝑆𝑡𝑖
or
𝐺𝑛(𝜏, 𝑇) = 𝑒
1
𝑛
∑𝑛
𝑖=1 log 𝑆𝑡𝑖.
From Problem 5.2.1.1 (page 443) we can deduce that
lim
𝑛→∞
1
𝑛
𝑛
∑
𝑖=1
log 𝑆𝑡𝑖=
1
𝑇−𝜏∫
𝑇
𝜏
log 𝑆𝑢𝑑𝑢
and hence
lim
𝑛→∞
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
= 𝑒
1
𝑇−𝜏∫𝑇
𝜏log 𝑆𝑢𝑑𝑢.
3. Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length Δ𝑡=
(𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the stock price at the end of the 𝑖th interval, 𝑖=
1, 2, … , 𝑛. By defining the discretely measured arithmetic average as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and the discretely measured geometric average as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
show that
𝐺𝑛(𝜏, 𝑇) ≤𝐴𝑛(𝜏, 𝑇).

5.2.1 Discrete Sampling
445
Solution: From the MacLaurin series expansion of 𝑒𝑥, 𝑥∈ℝ
𝑒𝑥= 1 + 𝑥+ 𝑥2
2! + 𝑥3
3! + …
and because 𝑒𝑥> 0 we can therefore deduce that
𝑒𝑥≥1 + 𝑥,
𝑥∈ℝ.
Let
𝑥𝑖=
𝑆𝑡𝑖
𝐴(𝜏, 𝑇) −1,
𝑖= 1, 2, … , 𝑛
so that
𝑒
𝑆𝑡𝑖
𝐴𝑛(𝜏,𝑇) −1 ≥1 +
𝑆𝑡𝑖
𝐴𝑛(𝜏, 𝑇) −1 =
𝑆𝑡𝑖
𝐴𝑛(𝜏, 𝑇).
Since
𝑆𝑡𝑖
𝐴𝑛(𝜏, 𝑇) ≤𝑒
𝑆𝑡𝑖
𝐴𝑛(𝜏,𝑇) −1
multiplying by the inequality for 𝑖= 1, 2, … , 𝑛yields
𝑆𝑡1
𝐴𝑛(𝜏, 𝑇) ⋅
𝑆𝑡2
𝐴𝑛(𝜏, 𝑇) ⋯
𝑆𝑡𝑛
𝐴𝑛(𝜏, 𝑇) ≤
(
𝑒
𝑆𝑡1
𝐴𝑛(𝜏,𝑇) −1
) (
𝑒
𝑆𝑡2
𝐴𝑛(𝜏,𝑇) −1
)
⋯
(
𝑒
𝑆𝑡𝑛
𝐴𝑛(𝜏,𝑇) −1)
and hence
∏𝑛
𝑖=1 𝑆𝑡𝑖
𝐴𝑛(𝜏, 𝑇)𝑛≤𝑒
∑𝑛
𝑖=1 𝑆𝑡𝑖
𝐴𝑛(𝜏,𝑇) −𝑛= 𝑒
𝑛𝐴𝑛(𝜏,𝑇)
𝐴𝑛(𝜏,𝑇) −𝑛= 1
or
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
≤𝐴𝑛(𝜏, 𝑇).
Since 𝐺𝑛(𝜏, 𝑇) =
(∏𝑛
𝑖=1 𝑆𝑡𝑖
) 1
𝑛, then 𝐺𝑛(𝜏, 𝑇) ≤𝐴𝑛(𝜏, 𝑇).
4. Arithmetic–Geometric Average Rate (Fixed Strike) Identity. Let the asset price 𝑆𝑡follow
the GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) + 𝜎𝑑𝑊𝑡

446
5.2.1 Discrete Sampling
where 𝑊𝑡is the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇, 𝐷and 𝜎
are the drift parameter, continuous dividend yield and volatility, respectively. In addition,
let 𝑟be the risk-free interest rate.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length Δ𝑡=
(𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the stock price at the end of the 𝑖th interval, 𝑖=
1, 2, … , 𝑛. Define the discretely measured arithmetic average as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and the discretely measured geometric average as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
.
At time 𝑡, for a common strike value 𝐾and expiry time 𝑇> 𝑡, let the arithmetic average
rate (fixed strike) Asian call and put options be
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
where the expectation is defined under the risk-neutral measure ℚ.
In contrast, let the corresponding geometric average rate (fixed strike) Asian call and
put options be
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
] .
Show that
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) ≤𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇)
≤𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) + 𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]}
and
𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) −𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]}
≤𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) ≤𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇).
Solution: From Problem 5.2.1.3 (see page 444) we have 𝐺𝑛(𝜏, 𝑇) ≤𝐴𝑛(𝜏, 𝑇), therefore
𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
] ≤𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]

5.2.1 Discrete Sampling
447
or
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) ≤𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇).
In addition, we note that
max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0} = max{𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇) + 𝐺𝑛(𝜏, 𝑇) −𝐾, 0}
≤𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇) + max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}.
Thus,
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
≤𝑒−𝑟(𝑇−𝑇)𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]
+𝑒−𝑟(𝑇−𝑇)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑇) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]}
+𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇).
In contrast, for the average rate put options
𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
] ≤𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
or
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) ≤𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇).
Further, we note that
max{𝐾−𝐴𝑛(𝜏, 𝑇), 0} = max{𝐾−𝐺𝑛(𝜏, 𝑇) + 𝐺𝑛(𝜏, 𝑇) −𝐴𝑛(𝜏, 𝑇), 0}
= max{𝐾−𝐺𝑛(𝜏, 𝑇) −(𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)), 0}
≥max{𝐾−𝐺𝑛(𝜏, 𝑇), 0} −(𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)).
Therefore,
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
≥𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]
= 𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇)
−𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]} .

448
5.2.1 Discrete Sampling
5. Arithmetic–Geometric Average Strike (Floating Strike) Identity. Let the asset price 𝑆𝑡
follow the GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) + 𝜎𝑑𝑊𝑡
where 𝑊𝑡is the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇, 𝐷and 𝜎
are the drift parameter, continuous dividend yield and volatility, respectively. In addition,
let 𝑟be the risk-free interest rate.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length Δ𝑡=
(𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the stock price at the end of the 𝑖th interval, 𝑖=
1, 2, … , 𝑛. Define the discretely measured arithmetic average as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and the discretely measured geometric average as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
.
At time 𝑡, for a common strike value 𝐾and expiry time 𝑇> 𝑡, let the arithmetic average
strike (floating strike) Asian call and put options be
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
]
where the expectation is under the risk-neutral measure ℚ.
In contrast, let the corresponding geometric average strike (floating strike) Asian call
and put options be
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
] .
Show that
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) ≤𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇)
≤𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) + 𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]}
and
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) −𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]}
≤𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) ≤𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇).

5.2.1 Discrete Sampling
449
Solution: Following Problem 5.2.1.3 (see page 444) we have 𝐺𝑛(𝜏, 𝑇) ≤𝐴𝑛(𝜏, 𝑇),
therefore
𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
] ≤𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
or
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇) ≤𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇).
In addition, we note that
max{𝑆𝑇−𝐺𝑛(𝜏, 𝑇), 0} = max{𝑆𝑇−𝐴𝑛(𝜏, 𝑇) + 𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇), 0}
≤max{𝑆𝑇−𝐴𝑛(𝜏, 𝑇), 0} + 𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇).
Thus,
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐺𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
≤𝑒−𝑟(𝑇−𝑇)𝔼ℚ[max{𝑆𝑇−𝐴𝑛(𝜏, 𝑇), 0}|| ℱ𝑡
]
+𝑒−𝑟(𝑇−𝑇)𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]
= 𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇)
+𝑒−𝑟(𝑇−𝑇) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]} .
In contrast, for the average strike put options
𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
] ≤𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
]
or
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) ≤𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇).
In addition, we note that
max{𝐺𝑛(𝜏, 𝑇) −𝑆𝑇, 0} = max{𝐺𝑛(𝜏, 𝑇) −𝐴𝑛(𝜏, 𝑇) + 𝐴𝑛(𝜏, 𝑇) −𝑆𝑇, 0}
= max{𝐴𝑛(𝜏, 𝑇) −𝑆𝑇−(𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)), 0}
≥max{𝐴𝑛(𝜏, 𝑇) −𝑆𝑇, 0} −(𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)).
Therefore,
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
]
≥𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝑆𝑇, 0}|| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]
= 𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝑇)
−𝑒−𝑟(𝑇−𝑡) {𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| ℱ𝑡
] −𝔼ℚ[𝐺𝑛(𝜏, 𝑇)|| ℱ𝑡
]} .

450
5.2.1 Discrete Sampling
6. Discrete Geometric Average Rate (Fixed Strike) Asian Option. Let the asset price 𝑆𝑡follow
the GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) + 𝜎𝑑𝑊𝑡
where 𝑊𝑡is the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇, 𝐷and 𝜎
are the drift parameter, continuous dividend yield and volatility, respectively. In addition,
let 𝑟be the risk-free interest rate.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length
Δ𝑡= (𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the asset price at the end of the 𝑖th
interval, 𝑖= 1, 2, … , 𝑛. We define the discretely measured geometric average of asset
prices as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
and we consider a fixed strike geometric Asian call option at expiry 𝑇> 𝑡> 𝜏with payoff
Ψ(𝑆𝑇, 𝐺𝑛(𝜏, 𝑇)) = max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}
where 𝐾> 0 is the strike price.
Show that if 𝑋∼(𝜇𝑥, 𝜎2
𝑥) then for a constant 𝐾> 0
𝔼[max{𝛿(𝑒𝑋−𝐾), 0}] = 𝛿𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
(
𝛿(𝜇𝑥+ 𝜎2
𝑥−log 𝐾)
𝜎𝑥
)
−𝛿𝐾Φ
(𝛿(𝜇𝑥−log 𝐾)
𝜎𝑥
)
where 𝛿∈{−1, 1} and Φ(⋅) denotes the cdf of a standard normal.
Suppose 𝑆𝑡1, 𝑆𝑡2, …, 𝑆𝑡𝑘, 1 ≤𝑘≤𝑛−1 have been observed and let 𝑡𝑘≤𝑡< 𝑡𝑘+1 where
𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝜖∈[0, 1). Show that under the risk-neutral measure ℚ
𝐺𝑛(𝜏, 𝑇) =
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎡
⎢
⎢⎣
( 𝑆𝑡𝑛
𝑆𝑡𝑛−1
) (𝑆𝑡𝑛−1
𝑆𝑡𝑛−2
)2 (𝑆𝑡𝑛−2
𝑆𝑡𝑛−3
)3
⋯
(𝑆𝑡𝑘+1
𝑆𝑡
)𝑛−𝑘⎤
⎥
⎥⎦
1
𝑛
and deduce that
log 𝐺𝑛(𝜏, 𝑇) ∼(𝑚, 𝑠2)

5.2.1 Discrete Sampling
451
where
𝑚= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
and
𝑠2 = 𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡.
Using the above information show that under the risk-neutral measure ℚ, the discrete geo-
metric average rate Asian call option price at time 𝑡, 𝜏< 𝑡< 𝑇is
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) =
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
𝑒−𝐷𝑛(𝑇−𝑡)Φ(𝑑
(𝑛)
+ ) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑
(𝑛)
−)
where
𝑑
(𝑛)
± =
log
[(∏𝑘
𝑖=1 𝑆𝑡𝑖
) 1
𝑛𝑆
𝑛−𝑘
𝑛
𝑡
]
−log 𝐾+
(
𝑟−𝐷𝑛± 1
2𝜎2
𝑛
)
(𝑇−𝑡)
𝜎𝑛
√
𝑇−𝑡
𝐷𝑛= 𝑟
[𝑛(𝑇−𝑡)
𝑇−𝜏
−(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+𝐷
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+𝜎2
2
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+(𝑛−𝑘)(1 −𝜖)
𝑛
−(𝑛−𝑘)2(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
and
𝜎2
𝑛= 𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡
𝑇−𝑡.
Finally, show that in the limit 𝑛→∞,
lim
𝑛→∞𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇𝑆
𝑇−𝑡
𝑇
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)

452
5.2.1 Discrete Sampling
where
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
.
Solution: For the first part of the results refer to Problem 1.2.2.7 of Problems and Solutions
in Mathematical Finance, Volume 1: Stochastic Calculus.
From Girsanov’s theorem, under the risk-neutral measure ℚ, the asset price 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
is a ℚ-standard Wiener process.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length
Δ𝑡= (𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the asset price at the end of the 𝑖th interval.
Suppose 𝑆𝑡1, 𝑆𝑡2, …, 𝑆𝑡𝑘, 1 ≤𝑘≤𝑛−1 have been observed and let 𝑡𝑘≤𝑡< 𝑡𝑘+1 where
𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝜖∈[0, 1). By definition
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
=
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛(
𝑛
∏
𝑖=𝑘+1
𝑆𝑡𝑖
) 1
𝑛
=
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛(
𝑆𝑡𝑛𝑆𝑡𝑛−1𝑆𝑡𝑛−3 ⋯𝑆𝑡𝑘+2𝑆𝑡𝑘+1
) 1
𝑛
=
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎡
⎢
⎢⎣
( 𝑆𝑡𝑛
𝑆𝑡𝑛−1
) (𝑆𝑡𝑛−1
𝑆𝑡𝑛−2
)2 (𝑆𝑡𝑛−2
𝑆𝑡𝑛−3
)3
⋯
(𝑆𝑡𝑘+1
𝑆𝑡
)𝑛−𝑘⎤
⎥
⎥⎦
1
𝑛
.
From It¯o’s lemma we can easily show for 𝑖= 𝑘+ 2, 𝑘+ 3, … , 𝑛−1, 𝑛
log
( 𝑆𝑡𝑖
𝑆𝑡𝑖−1
)
=
(
𝑟−𝐷−1
2𝜎2)
(𝑡𝑖−𝑡𝑖−1) + 𝜎𝑊ℚ
𝑡𝑖−𝑡𝑖−1
=
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡+ 𝜎𝑊ℚ
𝑡𝑖−𝑡𝑖−1

5.2.1 Discrete Sampling
453
and
log
(𝑆𝑡𝑘+1
𝑆𝑡
)
=
(
𝑟−𝐷−1
2𝜎2)
(𝑡𝑘+1 −𝑡) + 𝜎𝑊ℚ
𝑡𝑘+1−𝑡
=
(
𝑟−𝐷−1
2𝜎2)
(1 −𝜖)Δ𝑡+ 𝜎𝑊ℚ
𝑡𝑘+1−𝑡.
From the independent increment property of the standard Wiener process we can deduce
that
log
( 𝑆𝑡𝑛
𝑆𝑡𝑛−1
)
,
log
(𝑆𝑡𝑛−1
𝑆𝑡𝑛−2
)
,
log
(𝑆𝑡𝑛−2
𝑆𝑡𝑛−3
)
,
… ,
log
(𝑆𝑡𝑘+2
𝑆𝑡𝑘+1
)
,
log
(𝑆𝑡𝑘+1
𝑆𝑡
)
are mutually independent. Thus,
log 𝐺𝑛(𝜏, 𝑇) = log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+1
𝑛
[
log
( 𝑆𝑡𝑛
𝑆𝑡𝑛−1
)
+ 2 log
(𝑆𝑡𝑛−1
𝑆𝑡𝑛−2
)
+3 log
(𝑆𝑡𝑛−2
𝑆𝑡𝑛−3
)
+ … + (𝑛−𝑘) log
(𝑆𝑡𝑘+1
𝑆𝑡
)]
and because
log 𝑆𝑡𝑖∼
[
log 𝑆𝑡𝑖−1 +
(
𝑟−𝐷−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
,
𝑖= 𝑘+ 2, 𝑘+ 3, … , 𝑛
log 𝑆𝑡𝑘+1 ∼
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(1 −𝜖)Δ𝑡, 𝜎2(1 −𝜖)Δ𝑡
]
we have
𝔼ℚ[log 𝐺𝑛(𝜏, 𝑇)] = log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+1
𝑛
(
𝑟−𝐷−1
2𝜎2)
× (1 + 2 + 3 + … + (𝑛−𝑘−1) + (𝑛−𝑘)(1 −𝜖)) Δ𝑡
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡

454
5.2.1 Discrete Sampling
and
Varℚ[log 𝐺𝑛(𝜏, 𝑇)] = 𝜎2
𝑛2
(12 + 22 + 32 + … + (𝑛−𝑘−1)2 + (𝑛−𝑘)2(1 −𝜖)) Δ𝑡
= 𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡.
Thus, using the above information we can deduce that the discrete geometric average rate
Asian call option price at time 𝜏< 𝑡< 𝑇is
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐺𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
= 𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡)Φ(𝑑
(𝑛)
+ ) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑
(𝑛)
−)
where
𝑚= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡,
𝑠2 = 𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡,
𝑑
(𝑛)
+ = 𝑚+ 𝑠2 −log 𝐾
𝑠
and
𝑑
(𝑛)
−= 𝑑(𝑛)
+ −𝑠.
Therefore,
𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡) =
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
𝑒−𝐷𝑛(𝑇−𝑡)
𝑑
(𝑛)
± =
log
[(∏𝑘
𝑖=1 𝑆𝑡𝑖
) 1
𝑛𝑆
𝑛−𝑘
𝑛
𝑡
]
−log 𝐾+
(
𝑟−𝐷𝑛± 1
2𝜎2
𝑛
)
(𝑇−𝑡)
𝜎𝑛
√
𝑇−𝑡

5.2.1 Discrete Sampling
455
where
𝐷𝑛= 𝑟−
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
−𝜎2
2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡
𝑇−𝑡
= 𝑟
[𝑛(𝑇−𝑡)
𝑇−𝜏
−(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+𝐷
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+𝜎2
2
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+(𝑛−𝑘)(1 −𝜖)
𝑛
−(𝑛−𝑘)2(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
and
𝜎2
𝑛= 𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡
𝑇−𝑡.
Thus, we can write the discrete geometric average rate Asian call option price at time 𝑡,
𝜏< 𝑡< 𝑇as
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) =
( 𝑘
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
𝑒−𝐷𝑛(𝑇−𝑡)Φ(𝑑
(𝑛)
+ ) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑
(𝑛)
−).
For the limiting case, we note that since 𝑇= 𝜏+ 𝑛Δ𝑡and 𝑡= 𝑡𝑘+ 𝜖Δ𝑡= 𝜏+ (𝑘+ 𝜖)Δ𝑡,
𝜖∈[0, 1) therefore
lim
𝑛→∞(𝑛−𝑘)Δ𝑡= lim
𝑛→∞(𝑇−𝑡+ 𝜖Δ𝑡) = 𝑇−𝑡
lim
𝑛→∞(𝑛−𝑘−1)Δ𝑡= lim
𝑛→∞(𝑇−𝑡+ (𝜖−1)Δ𝑡) = 𝑇−𝑡
and
lim
𝑛→∞(2𝑛−2𝑘−1)Δ𝑡= lim
𝑛→∞(2(𝑇−𝑡+ 𝜖Δ𝑡) + Δ𝑡) = 2(𝑇−𝑡).

456
5.2.1 Discrete Sampling
By setting 𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢,
lim
𝑛→∞
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
= lim
𝑛→∞
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
lim
𝑛→∞𝑆
𝑛−𝑘
𝑛
𝑡
= lim
𝑛→∞𝑒
1
𝑇−𝜏
∑𝑘
𝑖=1 log 𝑆𝑡𝑖Δ𝑡⋅lim
𝑛→∞𝑆
(𝑛−𝑘)Δ𝑡
𝑛Δ𝑡
𝑡
= 𝑒
1
𝑇−𝜏∫𝑡
𝜏log 𝑆𝑢𝑑𝑢𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
= 𝑒
𝐼𝑡
𝑇𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
lim
𝑛→∞𝐷𝑛= lim
𝑛→∞𝑟
[𝑛(𝑇−𝑡)
𝑇−𝜏
−(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+ lim
𝑛→∞𝐷
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (𝑛−𝑘)(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
+ lim
𝑛→∞
𝜎2
2
[(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
−(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+(𝑛−𝑘)(1 −𝜖)
𝑛
−(𝑛−𝑘)2(1 −𝜖)
𝑛
]
Δ𝑡
𝑇−𝑡
= lim
𝑛→∞𝑟
[
1 −(𝑛−𝑘−1)(𝑛−𝑘)Δ𝑡2
2𝑛Δ𝑡(𝑇−𝑡)
−(𝑛−𝑘)(1 −𝜖)Δ𝑡2
𝑛Δ𝑡(𝑇−𝑡)
]
+ lim
𝑛→∞𝐷
[(𝑛−𝑘−1)(𝑛−𝑘)Δ𝑡2
2𝑛Δ𝑡(𝑇−𝑡)
+ (𝑛−𝑘)(1 −𝜖)Δ𝑡2
𝑛Δ𝑡(𝑇−𝑡)
]
+ lim
𝑛→∞
𝜎2
2
[(𝑛−𝑘−1)(𝑛−𝑘)Δ𝑡2
2𝑛Δ𝑡(𝑇−𝑡)
−(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)Δ𝑡3
6𝑛2Δ𝑡2(𝑇−𝑡)
+(𝑛−𝑘)(1 −𝜖)Δ𝑡2
𝑛Δ𝑡(𝑇−𝑡)
−(𝑛−𝑘)2(1 −𝜖)Δ𝑡2
𝑛Δ𝑡(𝑇−𝑡)
]
= 𝑟
(
1 −
𝑇−𝑡
2(𝑇−𝜏)
)
+ 𝐷
(
𝑇−𝑡
2(𝑇−𝜏)
)
+ 𝜎2
2
[
𝑇−𝑡
2(𝑇−𝜏) + (𝑇−𝑡)2
3(𝑇−𝜏)2
]
= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
and
lim
𝑛→∞𝜎2
𝑛= lim
𝑛→∞𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)
6𝑛2
+ (𝑛−𝑘)2(1 −𝜖)
𝑛2
]
Δ𝑡
𝑇−𝑡
= lim
𝑛→∞𝜎2
[(𝑛−𝑘−1)(𝑛−𝑘)(2𝑛−2𝑘−1)Δ𝑡3
6𝑛2Δ𝑡2(𝑇−𝑡)
+ (𝑛−𝑘)2(1 −𝜖)Δ𝑡3
𝑛2Δ𝑡2(𝑇−𝑡)
]
= 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
.

5.2.1 Discrete Sampling
457
Thus, in the limit 𝑛→∞,
lim
𝑛→∞𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐺𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
and
𝜎2 = 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
.
7. Levy Approximation – Discrete Arithmetic Average Rate (Fixed Strike) Asian Option.
Let the asset price 𝑆𝑡follow the GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝑊𝑡is the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇, 𝐷and 𝜎
are the drift parameter, continuous dividend yield and volatility, respectively. In addition,
let 𝑟be the risk-free interest rate.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length Δ𝑡=
(𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the asset price at the end of the 𝑖th interval, 𝑖=
1, 2, … , 𝑛. We define the discretely measured arithmetic average of asset prices as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and we consider an arithmetic average rate Asian put option with expiry 𝑇> 𝑡> 𝜏and
payoff
Ψ(𝑆𝑇, 𝐴𝑛(𝜏, 𝑇)) = max{𝐾−𝐴𝑛(𝜏, 𝑇), 0}
where 𝐾> 0 is the strike price.
Show that if 𝑋∼(𝜇𝑥, 𝜎2
𝑥) then for a constant 𝐾> 0 and 𝛼∈ℕ,
𝔼(𝑋𝛼) = 𝑒𝛼𝜇𝑥+ 1
2 𝛼2𝜎2
𝑥

458
5.2.1 Discrete Sampling
and
𝔼[max{𝛿(𝑒𝑋−𝐾), 0}] = 𝛿𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
(
𝛿(𝜇𝑥+ 𝜎2
𝑥−log 𝐾)
𝜎𝑥
)
−𝛿𝐾Φ
(𝛿(𝜇𝑥−log 𝐾)
𝜎𝑥
)
where 𝛿∈{−1, 1} and Φ(⋅) denotes the cdf of a standard normal.
Suppose 𝑆𝑡1, 𝑆𝑡2, …, 𝑆𝑡𝑘, 1 ≤𝑘≤𝑛−1 have been observed and let 𝑡𝑘≤𝑡< 𝑡𝑘+1 where
𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝜖∈[0, 1) and
𝐴𝑛(𝜏, 𝑇) = 𝐴𝑛(𝑡1, 𝑡𝑘) + 𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)
where 𝐴𝑛(𝑡1, 𝑡𝑘) = 1
𝑛
𝑘
∑
𝑖=1
𝑆𝑡𝑖and 𝐴𝑛(𝑡𝑘+1, 𝑡𝑛) = 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖. Show that under the risk-
neutral measure ℚ
𝔼ℚ[
𝑆𝑡𝑖
||| 𝑆𝑡
]
= 𝑆𝑡𝑒(𝑟−𝐷)(𝑖−𝑘−𝜖)Δ𝑡
𝔼ℚ[
𝑆𝑡𝑖𝑆𝑡𝑗
||| ℱ𝑡
]
= 𝑆2
𝑡𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘−2𝜖)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘−𝜖)Δ𝑡
where 𝑡𝑖, 𝑡𝑗> 𝑡𝑘.
By assuming
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛) ∻log-(𝑚, 𝑠2)
and using the moment-matching technique up to second order show that
𝑚≈2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] −1
2 log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
and
𝑠2 ≈log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
−2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] .
Find 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] and 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2|| 𝑆𝑡
], and hence show that the discrete
arithmetic average rate Asian put option at time 𝜏< 𝑡< 𝑇can be approximated by
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝑡𝑘+1, 𝑡𝑛), 𝑡; 𝐾, 𝑇) ≈𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑
(𝑛)
−) −𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡)Φ(−𝑑
(𝑛)
+ )
where 𝐾= 𝐾−𝐴𝑛(𝑡1, 𝑡𝑘), 𝑑
(𝑛)
+ = 𝑚+ 𝑠2 −log 𝐾
𝑠
and 𝑑
(𝑛)
−= 𝑑+ −𝑠.
Finally, show that in the limit 𝑛→∞,
lim
𝑛→∞𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] = 𝑆𝑡(𝑒(𝑟−𝐷)(𝑇−𝑡) −1)
(𝑟−𝐷)(𝑇−𝜏)

5.2.1 Discrete Sampling
459
and
lim
𝑛→∞𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
=
𝑆2
𝑡
(𝑟−𝐷)(𝑇−𝜏)2
⎡
⎢
⎢
⎢⎣
2
(
𝑒(𝑟−𝐷+𝜎2)(𝑇−𝑡) −1
)
𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑟−𝐷+ 𝜎2
−
(
𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡) −1
)
𝑟−𝐷+ 1
2𝜎2
⎤
⎥
⎥
⎥⎦
.
Solution: For the first two parts of the results see Problems 1.2.2.7 and 1.2.2.10 of Prob-
lems and Solutions in Mathematical Finance, Volume 1: Stochastic Calculus.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
=
(𝜇−𝑟
𝜎
)
𝑡+ 𝑊𝑡is a ℚ-standard Wiener process. Thus, conditional on 𝑆𝑡for
𝑡𝑖≠𝑡𝑗, 𝑡𝑖, 𝑡𝑗> 𝑡
𝑆𝑡𝑖= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑡𝑖−𝑡)+𝜎𝑊𝑡𝑖−𝑡
𝑆𝑡𝑖𝑆𝑡𝑗= 𝑆2
𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑡𝑖−𝑡+𝑡𝑗−𝑡)+𝜎(𝑊𝑡𝑖−𝑡+𝑊𝑡𝑗−𝑡).
Since 𝑡= 𝑡𝑘+ 𝜖Δ𝑡and 𝑡𝑗= 𝜏+ 𝑗Δ𝑡, 𝑗= 𝑖, 𝑘we have
𝔼ℚ[
𝑆𝑡𝑖
||| 𝑆𝑡
]
= 𝑆𝑡𝑒(𝑟−𝐷)(𝑡𝑖−𝑡) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑡𝑖−𝑡𝑘−𝜖Δ𝑡) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑖−𝑘−𝜖)Δ𝑡.
From Problem 2.2.1.4 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus we can deduce
Cov(𝑊𝑡𝑖−𝑡, 𝑊𝑡𝑗−𝑡) = min{𝑡𝑖−𝑡, 𝑡𝑗−𝑡} = min{𝑡𝑖, 𝑡𝑗} −𝑡
and hence
𝑊𝑡𝑖−𝑡+ 𝑊𝑡𝑗−𝑡∼(0, 𝑡𝑖+ 𝑡𝑗+ 2 min{𝑡𝑖, 𝑡𝑗} −4𝑡).

460
5.2.1 Discrete Sampling
Therefore, conditional on 𝑆𝑡
𝔼ℚ[
𝑆𝑡𝑖𝑆𝑡𝑗
||| 𝑆𝑡
]
= 𝑆2
𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑡𝑖+𝑡𝑗−2𝑡)+ 1
2 𝜎2(𝑡𝑖+𝑡𝑗+2 min{𝑡𝑖,𝑡𝑗}−4𝑡)
= 𝑆2
𝑡𝑒(𝑟−𝐷)(𝑡𝑖+𝑡𝑗−2𝑡)+𝜎2(min{𝑡𝑖,𝑡𝑗}−𝑡)
= 𝑆2
𝑡𝑒(𝑟−𝐷)(𝑡𝑖+𝑡𝑗−2𝑡𝑘−2𝜖Δ𝑡)+𝜎2(min{𝑡𝑖,𝑡𝑗}−𝑡𝑘−𝜖Δ)
= 𝑆2
𝑡𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘−2𝜖)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘−𝜖)Δ𝑡.
Let 𝐴𝑛(𝑡𝑘+1, 𝑡𝑘) = 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖∻log-(𝑚, 𝑠2) and by matching the moments up to second
order we have
𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑘)|| 𝑆𝑡
] ≈𝑒𝑚+ 1
2 𝑠2
and
𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
≈𝑒2𝑚+2𝑠2
or
𝑚+ 1
2𝑠2 ≈log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
]
and
𝑚+ 𝑠2 ≈1
2 log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
.
Solving the approximate equations simultaneously we have
𝑚≈2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] −1
2 log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
and
𝑠2 ≈log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
−2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] .
By definition
𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] = 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝔼ℚ[
𝑆𝑡𝑖
||| 𝑆𝑡
]
= 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑒(𝑟−𝐷)(𝑖−𝑘−𝜖)Δ𝑡
= 𝑆𝑡𝑒−(𝑟−𝐷)(𝑘+𝜖)Δ𝑡
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒(𝑟−𝐷)𝑖Δ𝑡
= 𝑆𝑡𝑒−(𝑟−𝐷)(𝑘+𝜖)Δ𝑡
𝑛
[
𝑒(𝑟−𝐷)(𝑘+1)Δ𝑡(1 −𝑒(𝑟−𝐷)(𝑛−𝑘)Δ𝑡)
1 −𝑒(𝑟−𝐷)Δ𝑡
]
= 𝑆𝑡𝑒(𝑟−𝐷)(1−𝜖)Δ𝑡
𝑛
[
1 −𝑒(𝑟−𝐷)(𝑛−𝑘)Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡
]

5.2.1 Discrete Sampling
461
whilst for
𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
= 1
𝑛2
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝔼ℚ[
𝑆𝑡𝑖𝑆𝑡𝑗
||| 𝑆𝑡
]
=
𝑆2
𝑡𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝜖Δ𝑡
𝑛2
×
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖, 𝑗}−𝑘)Δ𝑡
=
𝑆2
𝑡𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝜖Δ𝑡
𝑛2
(𝐵1 + 𝐵2 + 𝐵3)
where
𝐵1 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖=𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘)Δ𝑡
𝐵2 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖<𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘)Δ𝑡
and
𝐵3 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖>𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘)Δ𝑡.
For the case
𝐵1 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖=𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘)Δ𝑡
=
𝑛
∑
𝑖=𝑘+1
𝑒2(𝑟−𝐷)(𝑖−𝑘)Δ𝑡+𝜎2(𝑖−𝑘)Δ𝑡
= 𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝑘Δ𝑡
⎡
⎢
⎢
⎢⎣
𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑘+1)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡
⎤
⎥
⎥
⎥⎦
=
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡

462
5.2.1 Discrete Sampling
whilst for
𝐵2 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖<𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖, 𝑗}−𝑘)Δ𝑡
=
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑖+1
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(𝑖−𝑘)Δ𝑡
= 𝑒𝜎2Δ𝑡
𝑛
∑
𝑗=𝑘+2
𝑒(𝑟−𝐷)(𝑗−𝑘+1)Δ𝑡+ 𝑒2𝜎2Δ𝑡
𝑛
∑
𝑗=𝑘+3
𝑒(𝑟−𝐷)(𝑗−𝑘+2)Δ𝑡
+𝑒3𝜎2Δ𝑡
𝑛
∑
𝑗=𝑘+4
𝑒(𝑟−𝐷)(𝑗−𝑘+3)Δ𝑡+ … + 𝑒(𝑛−𝑘−1)𝜎2Δ𝑡𝑒(𝑟−𝐷)(2𝑛−2𝑘−1)Δ𝑡
and given each term is a geometric series
𝐵2 = 𝑒𝜎2Δ𝑡
[
𝑒3(𝑟−𝐷)Δ𝑡(1 −𝑒(𝑟−𝐷)(𝑛−𝑘−1)Δ𝑡)
1 −𝑒(𝑟−𝐷)Δ𝑡
]
+𝑒2𝜎2Δ𝑡
[
𝑒5(𝑟−𝐷)Δ𝑡(1 −𝑒(𝑟−𝐷)(𝑛−𝑘−2)Δ𝑡)
1 −𝑒(𝑟−𝐷)Δ𝑡
]
+𝑒3𝜎2Δ𝑡
[
𝑒7(𝑟−𝐷)Δ𝑡(1 −𝑒(𝑟−𝐷)(𝑛−𝑘−3)Δ𝑡)
1 −𝑒(𝑟−𝐷)Δ𝑡
]
+ … + 𝑒(𝑛−𝑘−1)𝜎2Δ𝑡
[
𝑒(𝑟−𝐷)(2𝑛−2𝑘−1)Δ𝑡(1 −𝑒(𝑟−𝐷)Δ𝑡)
1 −𝑒(𝑟−𝐷)Δ𝑡
]
= 𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡+ 𝑒(5(𝑟−𝐷)+2𝜎2)Δ𝑡+ … + 𝑒(2𝑛−2𝑘−1)(𝑟−𝐷)+(𝑛−𝑘−1)𝜎2
1 −𝑒(𝑟−𝐷)Δ𝑡
−𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡+ 𝑒((𝑛−𝑘+3)(𝑟−𝐷)+2𝜎2)Δ𝑡+ … + 𝑒((2𝑛−2𝑘−1)(𝑟−𝐷)+(𝑛−𝑘−1)𝜎2)Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡
=
𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−
𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
.

5.2.1 Discrete Sampling
463
Using similar steps we would eventually have
𝐵3 =
𝑛
∑
𝑖=𝑘+1
𝑛
∑
𝑗=𝑘+1
𝑖>𝑗
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(min{𝑖,𝑗}−𝑘)Δ𝑡
=
𝑛
∑
𝑖=𝑘+1
𝑖−1
∑
𝑗=𝑘+1
𝑒(𝑟−𝐷)(𝑖+𝑗−2𝑘)Δ𝑡+𝜎2(𝑗−𝑘)Δ𝑡
=
𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−
𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
.
Therefore
𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
=
𝑆2
𝑡𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝜖Δ𝑡
𝑛2
⎡
⎢
⎢
⎢⎣
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡
+
2𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−
2𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
⎤
⎥
⎥
⎥⎦
.
Thus, using the above information we can deduce that the discrete arithmetic average rate
Asian put option price at time 𝑡< 𝑇can be approximated by
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖, 0
}||||||
ℱ𝑡
]
≈𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑
(𝑛)
−) −𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡)Φ(−𝑑
(𝑛)
+ )

464
5.2.1 Discrete Sampling
where
𝐾= 𝐾−𝐴𝑛(𝑡1, 𝑡𝑘)
𝑑
(𝑛)
+ = 𝑚+ 𝑠2 −log 𝐾
𝑠
𝑑
(𝑛)
−= 𝑑
(𝑛)
+ −𝑠
𝑚≈2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] −1
2 log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
𝑠2 ≈log 𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
−2 log 𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] .
Since 𝑇= 𝜏+ 𝑛Δ𝑡and 𝑡= 𝑡𝑘+ 𝜖Δ𝑡= 𝜏+ (𝑘+ 𝜖)Δ𝑡, 𝜖∈[0, 1) therefore
lim
𝑛→∞(𝑛−𝑘)Δ𝑡= lim
𝑛→∞(𝑇−𝑡+ 𝜖Δ𝑡) = 𝑇−𝑡
and
lim
𝑛→∞(𝑛−𝑘−1)Δ𝑡= lim
𝑛→∞(𝑇−𝑡+ (𝜖−1)Δ𝑡) = 𝑇−𝑡.
Taking limits 𝑛→∞,
lim
𝑛→∞𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] = lim
𝑛→∞
𝑆𝑡𝑒(𝑟−𝐷)(1−𝜖)Δ𝑡
𝑛
[
1 −𝑒(𝑟−𝐷)(𝑛−𝑘)Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡
]
= lim
𝑛→∞
𝑆𝑡𝑒(𝑟−𝐷)(1−𝜖)Δ𝑡(1 −𝑒(𝑟−𝐷)(𝑛−𝑘)Δ𝑡)
𝑛Δ𝑡
× lim
Δ𝑡→0
Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡
= 𝑆𝑡(1 −𝑒(𝑟−𝐷)(𝑇−𝑡))
𝑇−𝜏
lim
Δ𝑡→0
Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡.
From L’Ĥopital’s rule
lim
Δ𝑡→0
Δ𝑡
1 −𝑒(𝑟−𝐷)Δ𝑡= lim
Δ𝑡→0
1
−(𝑟−𝐷)𝑒(𝑟−𝐷)Δ𝑡= −
1
𝑟−𝐷
and hence
lim
𝑛→∞𝔼ℚ[𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)|| 𝑆𝑡
] = 𝑆𝑡(𝑒(𝑟−𝐷)(𝑇−𝑡) −1)
(𝑟−𝐷)(𝑇−𝜏)
.

5.2.1 Discrete Sampling
465
In contrast,
lim
𝑛→∞𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
= lim
𝑛→∞
𝑆2
𝑡𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝜖Δ𝑡
𝑛2
×
⎡
⎢
⎢
⎢⎣
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡
+
2𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−
2𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
⎤
⎥
⎥
⎥⎦
= lim
𝑛→∞
𝑆2
𝑡𝑒−2(𝑟−𝐷+ 1
2 𝜎2)𝜖Δ𝑡
𝑛2Δ𝑡2
×
⎡
⎢
⎢
⎢⎣
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
Δ𝑡2
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡
+
2𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
Δ𝑡2
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−
2𝑒((𝑛−𝑘+2)(𝑟−𝐷)+𝜎2)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
Δ𝑡2
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
⎤
⎥
⎥
⎥⎦
= 𝐶1 + 𝐶2 −𝐶3
where
𝐶1 = lim
𝑛→∞
𝑆2
𝑡𝑒2(𝑟−𝐷+ 1
2 𝜎2)(1−𝜖)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘)Δ𝑡)
𝑛2Δ𝑡2
× lim
Δ𝑡→0
Δ𝑡2
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡

466
5.2.1 Discrete Sampling
𝐶2 = lim
𝑛→∞
2𝑆2
𝑡𝑒2(𝑟−𝐷+ 1
2 𝜎2)(1−𝜖)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑛−𝑘−1)Δ𝑡)
𝑒(𝑟−𝐷)Δ𝑡
𝑛2Δ𝑡2
× lim
Δ𝑡→0
Δ𝑡2
(1 −𝑒(𝑟−𝐷)Δ𝑡) (
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
and
𝐶3 = lim
𝑛→∞
2𝑆2
𝑡𝑒2(𝑟−𝐷+ 1
2 𝜎2)(1−𝜖)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑛−𝑘−1)Δ𝑡)
𝑒(𝑟−𝐷)(𝑛−𝑘)Δ𝑡
𝑛2Δ𝑡2
× lim
Δ𝑡→0
Δ𝑡2
(1 −𝑒(𝑟−𝐷)Δ𝑡) (1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡).
By taking limits 𝑛→∞and by applying L’Ĥopital’s rule
𝐶1 =
𝑆2
𝑡
(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡))
(𝑇−𝜏)2
lim
Δ𝑡→0
2Δ𝑡
−2
(
𝑟−𝐷+ 1
2𝜎2
)
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡= 0
𝐶2 =
2𝑆2
𝑡
(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡))
(𝑇−𝜏)2
× lim
Δ𝑡→0
2Δ𝑡
⎡
⎢
⎢
⎢⎣
−(𝑟−𝐷)𝑒(𝑟−𝐷)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
−2
(
𝑟−𝐷+ 1
2𝜎2)
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(1 −𝑒(𝑟−𝐷)Δ𝑡)
⎤
⎥
⎥
⎥⎦
=
2𝑆2
𝑡
(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡))
(𝑇−𝜏)2
× lim
Δ𝑡→0
2
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢⎣
−(𝑟−𝐷)2𝑒(𝑟−𝐷)Δ𝑡(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡)
+4(𝑟−𝐷)
(
𝑟−𝐷+ 1
2𝜎2)
𝑒(3(𝑟−𝐷)+𝜎2)Δ𝑡
−4
(
𝑟−𝐷+ 1
2𝜎2)2
𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡(1 −𝑒(𝑟−𝐷)Δ𝑡)
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥⎦
=
𝑆2
𝑡
(
1 −𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡))
(𝑟−𝐷)
(
𝑟−𝐷+ 1
2𝜎2
)
(𝑇−𝜏)2

5.2.1 Discrete Sampling
467
and
𝐶3 =
2𝑆2
𝑡
(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑇−𝑡))
𝑒(𝑟−𝐷)(𝑇−𝑡)
(𝑇−𝜏)2
× lim
Δ𝑡→0
2Δ𝑡
⎡
⎢
⎢
⎢⎣
−(𝑟−𝐷)𝑒(𝑟−𝐷)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
−(𝑟−𝐷+ 𝜎2)𝑒(𝑟−𝐷+𝜎2)
(
1−𝑒(𝑟−𝐷)Δ𝑡)
⎤
⎥
⎥
⎥⎦
=
2𝑆2
𝑡
(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑇−𝑡))
𝑒(𝑟−𝐷)(𝑇−𝑡)
(𝑇−𝜏)2
× lim
Δ𝑡→0
2
⎡
⎢
⎢
⎢
⎢
⎢
⎢⎣
−(𝑟−𝐷)2𝑒(𝑟−𝐷)Δ𝑡(
1 −𝑒(𝑟−𝐷+𝜎2)Δ𝑡)
+2(𝑟−𝐷)(𝑟−𝐷+ 𝜎2)𝑒2(𝑟−𝐷+ 1
2 𝜎2)Δ𝑡
−(𝑟−𝐷+ 𝜎2)𝑒(𝑟−𝐷+𝜎2)Δ𝑡(1 −𝑒(𝑟−𝐷)Δ𝑡)
⎤
⎥
⎥
⎥
⎥
⎥
⎥⎦
=
2𝑆2
𝑡
(
1 −𝑒(𝑟−𝐷+𝜎2)(𝑇−𝑡))
𝑒(𝑟−𝐷)(𝑇−𝑡)
(𝑟−𝐷)(𝑟−𝐷+ 𝜎2)(𝑇−𝜏)2
.
Thus,
lim
𝑛→∞𝔼ℚ[
𝐴𝑛(𝑡𝑘+1, 𝑡𝑛)2||| 𝑆𝑡
]
=
𝑆2
𝑡
(𝑟−𝐷)(𝑇−𝜏)2
⎡
⎢
⎢
⎢⎣
2
(
𝑒(𝑟−𝐷+𝜎2)(𝑇−𝑡) −1
)
𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑟−𝐷+ 𝜎2
−
(
𝑒2(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑡) −1
)
𝑟−𝐷+ 1
2𝜎2
⎤
⎥
⎥
⎥⎦
.
8. Curran Approximation – Discrete Arithmetic Average Rate (Fixed Strike) Asian Option.
Let the asset price 𝑆𝑡follow the GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡

468
5.2.1 Discrete Sampling
where 𝑊𝑡is the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇, 𝐷and 𝜎
are the drift parameter, continuous dividend yield and volatility, respectively. In addition,
let 𝑟be the risk-free interest rate.
Let the time interval [𝜏, 𝑇] be partitioned into 𝑛equal subintervals each of length Δ𝑡=
(𝑇−𝜏)∕𝑛and let 𝑆𝑡𝑖, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡be the asset price at the end of the 𝑖th interval, 𝑖=
1, 2, … , 𝑛. We define the discretely measured arithmetic average of asset prices as
𝐴𝑛(𝜏, 𝑇) = 1
𝑛
𝑛
∑
𝑖=1
𝑆𝑡𝑖
and the discretely measured geometric average of asset prices as
𝐺𝑛(𝜏, 𝑇) =
( 𝑛
∏
𝑖=1
𝑆𝑡𝑖
) 1
𝑛
.
We consider an arithmetic average rate Asian call option with expiry 𝑇> 𝑡> 𝜏and payoff
Ψ(𝑆𝑇, 𝐴𝑛(𝜏, 𝑇)) = max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}
where 𝐾> 0 is the strike price.
Show that if the random variables 𝑋and 𝑌follow a joint normal distribution
(𝑋, 𝑌) ∼2 (𝝁, 𝚺)
where 𝝁=
[𝜇𝑥
𝜇𝑦
]
and 𝚺=
[
Var(𝑋)
Cov(𝑋, 𝑌)
Cov(𝑋, 𝑌)
Var(𝑌)
]
=
[
𝜎2
𝑥
𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜎2
𝑦
]
where
𝜇𝑥, 𝜇𝑦are the means, 𝜎2
𝑥, 𝜎2
𝑦are the variances and 𝜌𝑥𝑦∈(−1, 1) is the correlation coeffi-
cient, then the conditional distribution
𝑋| 𝑌= 𝑦∼
(
𝜇𝑥+ 𝜌𝑥𝑦
𝜎𝑥
𝜎𝑦
(𝑦−𝜇𝑦), (1 −𝜌2
𝑥𝑦)𝜎2
𝑥
)
.
Suppose 𝑆𝑡1, 𝑆𝑡2, …, 𝑆𝑡𝑘, 1 ≤𝑘≤𝑛−1 have been observed and let 𝑡𝑘≤𝑡< 𝑡𝑘+1 where
𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝜖∈[0, 1). Show that under the risk-neutral measure ℚ, for 𝑡𝑖> 𝑡𝑘
log 𝑆𝑡𝑖∼(𝜇𝑖, 𝜎2
𝑖)
log 𝐺𝑛(𝜏, 𝑇) ∼(𝜇𝐺, 𝜎2
𝐺)
where
𝜇𝑖= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑖−𝑘−𝜖)Δ𝑡
𝜎2
𝑖= 𝜎2(𝑖−𝑘−𝜖)Δ𝑡

5.2.1 Discrete Sampling
469
and
𝜇𝐺= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (1 −𝜖)(𝑛−𝑘)
𝑛
]
Δ𝑡
𝜎2
𝐺= 𝜎2
[(𝑛−𝑘)(2(𝑛−𝑘) −1)(𝑛−𝑘−1)
6𝑛2
+ (1 −𝜖)(𝑛−𝑘)2
𝑛2
]
Δ𝑡.
Given the pair of random variables
(
log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)
)
, 𝑡𝑖> 𝑡𝑘show that it has the
covariance matrix
𝚺=
⎡
⎢
⎢⎣
𝜎2
𝑖
𝜎𝑖𝐺
𝜎𝑖𝐺
𝜎2
𝐺
⎤
⎥
⎥⎦
where
𝜎𝑖𝐺= 𝜎2
2𝑛[(𝑖−𝑘−𝜖)(2𝑛−𝑖−𝑘) + (1 −𝜖)(𝑖−𝑘)] Δ𝑡
and
(
log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)
)
follows a bivariate normal distribution.
Hence, deduce that the conditional distribution of log 𝑆𝑡𝑖, 𝑡𝑖> 𝑡𝑘given log 𝐺𝑛(𝜏, 𝑇) is
log 𝑆𝑡𝑖| log 𝐺𝑛(𝜏, 𝑇) = 𝑦∼
(
𝜇𝑖+ (𝑦−𝜇𝐺)𝜎𝑖𝐺
𝜎2
𝐺
, 𝜎2
𝑖−
𝜎2
𝑖𝐺
𝜎2
𝐺
)
.
Show that for any random variable 𝑍under the filtration 𝒢,
0 ≤𝔼(max{𝑍, 0}| 𝒢) −max {𝔼(𝑍| 𝒢) , 0} ≤1
2
√
Var (𝑍| 𝒢).
By defining the arithmetic average rate (fixed strike) call option price at time 𝑡, 𝜏< 𝑡𝑘<
𝑡< 𝑇as
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
and by setting 𝐴𝑛(𝑡1, 𝑡𝑘) = 1
𝑛
∑𝑘
𝑗=1 𝑆𝑡𝑗and using the following tower property
𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
] = 𝔼ℚ[
𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| 𝐺𝑛(𝜏, 𝑇)]||| ℱ𝑡
]

470
5.2.1 Discrete Sampling
show that
𝐶𝑙𝑜𝑤𝑒𝑟≤𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) ≤𝐶𝑢𝑝𝑝𝑒𝑟
where
𝐶𝑙𝑜𝑤𝑒𝑟= 𝑒−𝑟(𝑇−𝑡)
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒𝜇𝑖+ 1
2 𝜎2
𝑖Φ
(
𝜇𝐺−log ̃
𝐾+ 𝜎𝑖𝐺
𝜎𝐺
)
+ (𝐴𝑛(𝑡1, 𝑡𝑘) −𝐾) Φ
(
𝜇𝐺−log ̃
𝐾
𝜎𝐺
)]
𝐶𝑢𝑝𝑝𝑒𝑟= 𝐶𝑙𝑜𝑤𝑒𝑟+ 1
2𝑒−𝑟(𝑇−𝑡)𝔼ℚ
⎡
⎢
⎢⎣
√
√
√
√Var
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
𝐺𝑛(𝜏, 𝑇)
]|||||||
ℱ𝑡
⎤
⎥
⎥⎦
̃
𝐾=
{
𝑧
|||||
𝐴𝑛(𝜏, 𝑡𝑘) + 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒𝜇𝑖+(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺+ 1
2 (𝜎2
𝑖−𝜎2
𝑖𝐺∕𝜎2
𝐺) = 𝐾
}
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2 𝑑𝑢is the cdf of a standard normal.
Solution: If (𝑋, 𝑌) follows a bivariate normal distribution then the joint pdf is given as
𝑓𝑋𝑌(𝑥, 𝑦) =
1
2𝜋𝜎𝑥𝜎𝑦
√
1 −𝜌2
𝑥𝑦
𝑒
−
1
2(1−𝜌2𝑥𝑦)
[( 𝑥−𝜇𝑥
𝜎𝑥
)2
−2𝜌𝑥𝑦
( 𝑥−𝜇𝑥
𝜎𝑥
)(
𝑦−𝜇𝑦
𝜎𝑦
)
+
(
𝑦−𝜇𝑦
𝜎𝑦
)2]
.
The pdf of the conditional distribution
𝑓𝑋|𝑌(𝑥|𝑦) = 𝑓𝑋𝑌(𝑥, 𝑦)
𝑓𝑌(𝑦)
=
1
2𝜋𝜎𝑥𝜎𝑦
√
1−𝜌2𝑥𝑦
𝑒
−
1
2(1−𝜌2𝑥𝑦)
[( 𝑥−𝜇𝑥
𝜎𝑥
)2
−2𝜌𝑥𝑦
( 𝑥−𝜇𝑥
𝜎𝑥
)(
𝑦−𝜇𝑦
𝜎𝑦
)
+
(
𝑦−𝜇𝑦
𝜎𝑦
)2]
1
𝜎𝑦
√
2𝜋𝑒
−1
2
(
𝑦−𝜇𝑦
𝜎𝑦
)2
=
1
√
2𝜋𝜎𝑥
√
1 −𝜌2
𝑥𝑦
𝑒
−
1
2(1−𝜌2𝑥𝑦)
[( 𝑥−𝜇𝑥
𝜎𝑥
)2
−2𝜌𝑥𝑦
( 𝑥−𝜇𝑥
𝜎𝑥
)(
𝑦−𝜇𝑦
𝜎𝑦
)
+𝜌2
𝑥𝑦
(
𝑦−𝜇𝑦
𝜎𝑦
)2]
=
1
√
2𝜋𝜎𝑥
√
1 −𝜌2
𝑥𝑦
𝑒
−1
2
⎡
⎢
⎢⎣
𝑥−
(
𝜇𝑥+𝜌𝑥𝑦
𝜎𝑥
𝜎𝑦(𝑦−𝜇𝑦)
)
𝜎𝑥
√
1−𝜌2𝑥𝑦
⎤
⎥
⎥⎦
2
.

5.2.1 Discrete Sampling
471
Hence, 𝑋| 𝑌= 𝑦∼
(
𝜇𝑥+ 𝜌𝑥𝑦
𝜎𝑥
𝜎𝑦
(𝑦−𝜇𝑦), (1 −𝜌2
𝑥𝑦)𝜎2
𝑥
)
.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
=
(𝜇−𝑟
𝜎
)
𝑡+ 𝑊𝑡is a ℚ-standard Wiener process.
Thus, conditional on 𝑆𝑡for 𝑡𝑖> 𝑡𝑘
𝑆𝑡𝑖= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑡𝑖−𝑡)+𝜎𝑊𝑡𝑖−𝑡
or
log 𝑆𝑡𝑖= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑡𝑖−𝑡) + 𝜎𝑊𝑡𝑖−𝑡
where 𝑊𝑡𝑖−𝑡∼(0, 𝑡𝑖−𝑡). Hence, we can easily deduce that
log 𝑆𝑡𝑖∼(𝜇𝑖, 𝜎2
𝑖)
where 𝜇𝑖= 𝔼ℚ[
log 𝑆𝑡𝑖
||| 𝑆𝑡
]
and 𝜎2
𝑖= Varℚ[
log 𝑆𝑡𝑖
||| 𝑆𝑡
]
.
Since 𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝑡𝑖= 𝜏+ 𝑖Δ𝑡and 𝑡𝑘= 𝜏+ 𝑘Δ𝑡,
𝜇𝑖= 𝔼ℚ[
log 𝑆𝑡𝑖
||| 𝑆𝑡
]
= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑡𝑖−𝑡)
= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑖−𝑘−𝜖)Δ𝑡
and
𝜎2
𝑖= Varℚ[
log 𝑆𝑡𝑖
||| 𝑆𝑡
]
= 𝜎2(𝑡𝑖−𝑡)
= 𝜎2(𝑖−𝑘−𝜖)Δ𝑡.
For the geometric average, since 𝑆𝑡1, 𝑆𝑡2, …, 𝑆𝑡𝑘, 1 ≤𝑘≤𝑛−1 have been observed, by
taking logarithms
log 𝐺𝑛(𝜏, 𝑇) = 1
𝑛log
( 𝑛
∏
𝑗=1
𝑆𝑡𝑗
)
= 1
𝑛
𝑛
∑
𝑗=1
log 𝑆𝑡𝑗
= 1
𝑛
𝑘
∑
𝑗=1
log 𝑆𝑡𝑗+ 1
𝑛
𝑛
∑
𝑗=𝑘+1
log 𝑆𝑡𝑗

472
5.2.1 Discrete Sampling
= 1
𝑛
𝑘
∑
𝑗=1
log 𝑆𝑡𝑗+ 1
𝑛
𝑛
∑
𝑗=𝑘+1
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑡𝑗−𝑡) + 𝜎𝑊𝑡𝑗−𝑡
]
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+ 1
𝑛
(
𝑟−𝐷−1
2𝜎2)
𝑛
∑
𝑗=𝑘+1
(𝑡𝑗−𝑡)
+𝜎
𝑛
𝑛
∑
𝑗=𝑘+1
𝑊𝑡𝑗−𝑡.
Since 𝑊𝑡𝑗−𝑡∼(0, 𝑡𝑗−𝑡) and because the sum of normal variates is also normal, we can
therefore deduce
log 𝐺𝑛(𝜏, 𝑇) ∼(𝜇𝐺, 𝜎2
𝐺)
with 𝜇𝐺= 𝔼ℚ[log 𝐺𝑛(𝜏, 𝑇)|| 𝑆𝑡
] and 𝜎2
𝐺= Varℚ[log 𝐺𝑛(𝜏, 𝑇)|| 𝑆𝑡
].
Since 𝑡= 𝑡𝑘+ 𝜖Δ𝑡, 𝑡𝑗= 𝜏+ 𝑗Δ𝑡and 𝑡𝑘= 𝜏+ 𝑘Δ𝑡,
𝜇𝐺= 𝔼ℚ[log 𝐺𝑛(𝜏, 𝑇)|| 𝑆𝑡
]
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+ 1
𝑛
(
𝑟−𝐷−1
2𝜎2)
𝑛
∑
𝑗=𝑘+1
(𝑡𝑖−𝑡)
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+ 1
𝑛
(
𝑟−𝐷−1
2𝜎2)
𝑛
∑
𝑗=𝑘+1
(𝑖−𝑘−𝜖)Δ𝑡
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) (𝑛−𝑘
𝑛
)
(𝑛−𝑘+ 1 −2𝜖) Δ𝑡
= log
⎡
⎢
⎢
⎢⎣
( 𝑘
∏
𝑗=1
𝑆𝑡𝑗
) 1
𝑛
𝑆
𝑛−𝑘
𝑛
𝑡
⎤
⎥
⎥
⎥⎦
+
(
𝑟−𝐷−1
2𝜎2) [(𝑛−𝑘−1)(𝑛−𝑘)
2𝑛
+ (1 −𝜖)(𝑛−𝑘)
𝑛
]
Δ𝑡
and because
𝑛
∑
𝑘=1
𝑘2 = 1
6𝑛(𝑛+ 1)(2𝑛+ 1)

5.2.1 Discrete Sampling
473
the variance is
𝜎2
𝐺= Varℚ[log 𝐺𝑛(𝜏, 𝑇)|| 𝑆𝑡
]
= Covℚ
(
𝜎
𝑛
𝑛
∑
𝑝=𝑘+1
𝑊𝑡𝑝−𝑡, 𝜎
𝑛
𝑛
∑
𝑞=𝑘+1
𝑊𝑡𝑞−𝑡
)
= 𝜎2
𝑛2
𝑛
∑
𝑝=𝑘+1
𝑛
∑
𝑞=𝑘+1
Covℚ(
𝑊𝑡𝑝−𝑡, 𝑊𝑡𝑞−𝑡
)
= 𝜎2
𝑛2
𝑛
∑
𝑝=𝑘+1
𝑛
∑
𝑞=𝑘+1
min{𝑡𝑝−𝑡, 𝑡𝑞−𝑡}
= 𝜎2
𝑛2
𝑛
∑
𝑝=𝑘+1
[
𝑝
∑
𝑞=𝑘+1
min{𝑡𝑝−𝑡, 𝑡𝑞−𝑡}
+
𝑛
∑
𝑞=𝑝+1
min{𝑡𝑝−𝑡, 𝑡𝑞−𝑡}
]
= 𝜎2
𝑛2
[
𝑛
∑
𝑝=𝑘+1
𝑝
∑
𝑞=𝑘+1
(𝑡𝑞−𝑡) +
𝑛
∑
𝑝=𝑘+1
𝑛
∑
𝑞=𝑝+1
(𝑡𝑝−𝑡)
]
= 𝜎2
𝑛2
[
𝑛
∑
𝑝=𝑘+1
𝑝
∑
𝑞=𝑘+1
(𝑞−𝑘−𝜖)Δ𝑡+
𝑛
∑
𝑝=𝑘+1
𝑛
∑
𝑞=𝑝+1
(𝑝−𝑘−𝜖)Δ𝑡
]
= 𝜎2
𝑛2
[
𝑛
∑
𝑝=𝑘+1
(𝑝−𝑘
2
)
(𝑝−𝑘+ 1 −2𝜖)Δ𝑡
+
𝑛
∑
𝑝=𝑘+1
(𝑛−𝑝)(𝑝−𝑘−𝜖)Δ𝑡
]
= 𝜎2
2𝑛2
[
𝑛
∑
𝑝=𝑘+1
(2(𝑛−𝑘) + 1) (𝑝−𝑘) −
𝑛
∑
𝑝=𝑘+1
(𝑝−𝑘)2
−
𝑛
∑
𝑝=𝑘+1
2(𝑛−𝑘)𝜖
]
Δ𝑡
= 𝜎2
2𝑛2
[(2(𝑛−𝑘) + 1)(𝑛−𝑘)(𝑛−𝑘+ 1)
2
−(2(𝑛−𝑘) + 1)(𝑛−𝑘+ 1)(𝑛−𝑘)
6
−2(𝑛−𝑘)2𝜖
]
Δ𝑡
= 𝜎2
[(2(𝑛−𝑘) + 1)(𝑛−𝑘)(𝑛−𝑘+ 1)
6𝑛2
−(𝑛−𝑘)2𝜖
𝑛2
]
Δ𝑡
= 𝜎2
[(𝑛−𝑘)(2(𝑛−𝑘) −1)(𝑛−𝑘−1)
6𝑛2
+ (1 −𝜖)(𝑛−𝑘)2
𝑛2
]
Δ𝑡.

474
5.2.1 Discrete Sampling
To find the covariance of the random variables (log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)), by definition
Cov
(
log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)
)
= Cov
(
log 𝑆𝑡𝑖, 1
𝑛
𝑛
∑
𝑗=1
log 𝑆𝑡𝑗
)
= Cov
(
log 𝑆𝑡𝑖, 1
𝑛
𝑛
∑
𝑗=𝑘+1
log 𝑆𝑡𝑗
)
= 1
𝑛
𝑛
∑
𝑗=𝑘+1
Cov
(
log 𝑆𝑡𝑖, log 𝑆𝑡𝑗
)
= 1
𝑛
[
𝑖∑
𝑗=𝑘+1
Cov
(
log 𝑆𝑡𝑖, log 𝑆𝑡𝑗
)
+
𝑛
∑
𝑗=𝑖+1
Cov
(
log 𝑆𝑡𝑖, log 𝑆𝑡𝑗
)]
= 1
𝑛
[
𝑖∑
𝑗=𝑘+1
𝜎2 min{𝑡𝑖−𝑡, 𝑡𝑗−𝑡}
+
𝑛
∑
𝑗=𝑖+1
𝜎2 min{𝑡𝑖−𝑡, 𝑡𝑗−𝑡}
]
= 1
𝑛
[
𝜎2
𝑖∑
𝑗=𝑘+1
(𝑡𝑗−𝑡) + 𝜎2(𝑛−𝑖)(𝑡𝑖−𝑡)
]
= 𝜎2
𝑛
[(𝑖−𝑘
2
)
(𝑡𝑘+1 + 𝑡𝑖−2𝑡) + (𝑛−𝑖)(𝑡𝑖−𝑡)
]
= 𝜎2
𝑛
[ (𝑖−𝑘
2
)
(𝑡𝑘+1 + 𝑡𝑖−2(𝑡𝑘+ 𝜖Δ𝑡))
+(𝑛−𝑖)(𝑡𝑖−𝑡𝑘−𝜖Δ𝑡)
]
= 𝜎2
𝑛
[(𝑖−𝑘
2
)
(𝑖−𝑘+ 1 −2𝜖) + (𝑛−𝑖)(𝑖−𝑘−𝜖)
]
Δ𝑡
= 𝜎2
2𝑛[(𝑖−𝑘−𝜖)(2𝑛−𝑖−𝑘) + (1 −𝜖)(𝑖−𝑘)] Δ𝑡.
To show that the pair (log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)) follows a bivariate normal distribution, let
log 𝑆𝑡𝑖= 𝜇𝑖+ 𝜎𝑖𝑍1
log 𝐺𝑛(𝜏, 𝑇) = 𝜇𝐺+ 𝜎𝐺
(
𝜌𝑍1 +
√
1 −𝜌2𝑍2
)
where 𝑍1, 𝑍2 ∼(0, 1), 𝑍1 ⟂⟂𝑍2 and 𝜌= 𝜎𝑖𝐺
𝜎𝑖𝜎𝐺
.

5.2.1 Discrete Sampling
475
From the definition of the moment-generating function, for 𝜃1, 𝜃2 ∈ℝ
𝔼ℚ[
𝑒𝜃1 log 𝑆𝑡𝑖+𝜃2 log 𝐺𝑛(𝜏,𝑇)]
= 𝔼ℚ[
𝑒𝜃1(𝜇𝑖+𝜎𝑖𝑍1)+𝜃2(𝜇𝐺+𝜎𝐺(𝜌𝑍1+
√
1−𝜌2𝑍2))]
= 𝑒𝜃1𝜇𝑖+𝜃2𝜇𝐺𝔼ℚ[
𝑒(𝜃1𝜎𝑖+𝜃2𝜌𝜎𝑖𝐺)𝑍1+(𝜃2𝜎𝑖𝐺
√
1−𝜌2)𝑍2
]
= 𝑒𝜃1𝜇𝑖+𝜃2𝜇𝐺𝔼ℚ[𝑒(𝜃1𝜎𝑖+𝜃2𝜌𝜎𝑖𝐺)𝑍1] 𝔼ℚ[
𝑒(𝜃2𝜎𝑖𝐺
√
1−𝜌2)𝑍2
]
= 𝑒𝜃1𝜇𝑖+𝜃2𝜇𝐺𝑒
1
2 (𝜃1𝜎𝑖+𝜃2𝜌𝜎𝑖𝐺)2𝑒
1
2 𝜃2
2𝜎2
𝑖𝐺(1−𝜌2)
= 𝑒𝜃1𝜇𝑖+𝜃2𝜇𝐺+ 1
2 (𝜃2
1𝜎2
𝑖+2𝜌𝜃1𝜃2𝜎𝑖𝜎𝐺+𝜃2
2𝜎2
𝐺)
which is the moment-generating function of a bivariate normal distribution. Hence
(log 𝑆𝑡𝑖, log 𝐺𝑛(𝜏, 𝑇)) ∼2(𝝁, 𝚺) where 𝝁=
[
𝜇𝑖
𝜇𝐺
]
and 𝚺=
⎡
⎢
⎢⎣
𝜎2
𝑖
𝜎𝑖𝐺
𝜎𝑖𝐺
𝜎2
𝐺
⎤
⎥
⎥⎦
.
By setting 𝜌= 𝜎𝑖𝐺
𝜎𝑖𝜎𝐺
and following the result of the conditional distribution of normal
distribution, we have
log 𝑆𝑡𝑖| log 𝐺𝑛(𝜏, 𝑇) = 𝑦∼
(
𝜇𝑖+ (𝑦−𝜇𝐺)𝜎𝑖𝐺
𝜎2
𝐺
, 𝜎2
𝑖−
𝜎2
𝑖𝐺
𝜎2
𝐺
)
.
To show that for any random variable 𝑍under the filtration 𝒢
0 ≤𝔼(max{𝑍, 0}| 𝒢) −max {𝔼(𝑍| 𝒢) , 0} ≤1
2
√
Var (𝑍| 𝒢)
we note that since max{𝑥, 0} is a non-negative convex function, from the conditional
Jensen’s inequality (see Problem 1.2.3.14 of Problems and Solutions in Mathematical
Finance, Volume 1: Stochastic Calculus)
𝔼(max{𝑍, 0}| 𝒢) ≥max {𝔼(𝑍| 𝒢) , 0} .
For a random variable 𝑈we can set
|𝑈| = max{𝑈, 0} −min{𝑈, 0}
𝑈= max{𝑈, 0} + min{𝑈, 0}.
Thus, we can write
𝔼(|𝑍|| 𝒢) = 𝔼(max{𝑍, 0}| 𝒢) −𝔼(min{𝑍, 0}| 𝒢)
= 𝔼(max{𝑍, 0}| 𝒢) −[𝔼(𝑍| 𝒢) −𝔼(max{𝑍, 0}| 𝒢)]
= 2𝔼(max{𝑍, 0}| 𝒢) −𝔼(𝑍| 𝒢)

476
5.2.1 Discrete Sampling
or
𝔼(max{𝑍, 0}| 𝒢) = 1
2 {𝔼(|𝑍|| 𝒢) + 𝔼(𝑍| 𝒢)} .
Further, we can write
|𝔼(𝑍| 𝒢)| = max {𝔼(𝑍| 𝒢) , 0} −min {𝔼(𝑍| 𝒢) , 0}
𝔼(𝑍| 𝒢) = max {𝔼(𝑍| 𝒢) , 0} + min {𝔼(𝑍| 𝒢) , 0}
and by adding the two equations,
max {𝔼(𝑍| 𝒢) , 0} = 1
2 {|𝔼(𝑍| 𝒢)| + 𝔼(𝑍| 𝒢)} .
Thus,
𝔼(max{𝑍, 0}| 𝒢) −max {𝔼(𝑍| 𝒢) , 0} = 1
2 {𝔼(|𝑍|| 𝒢) −𝔼(𝑍| 𝒢)}
≤1
2𝔼(|𝑍−𝔼(𝑍| 𝒢)|| 𝒢)
≤1
2
√
Var (𝑍| 𝒢) .
From the definition of the average rate call option price at time 𝑡, 𝜏< 𝑡𝑘< 𝑡< 𝑇
𝐶(𝑆𝑡, 𝐴𝑛(𝜏, 𝑇), 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
𝔼ℚ[
max{𝐴𝑛(𝜏, 𝑇) −𝐾, 0}|| 𝐺𝑛(𝜏, 𝑇)
]||| ℱ𝑡
]
.
Using the inequality
max {𝔼(𝑍| 𝒢) , 0} ≤𝔼(max{𝑍, 0}| 𝒢) ≤max {𝔼(𝑍| 𝒢) , 0} + 1
2
√
Var (𝑍| 𝒢)
for a random variable 𝑍, 𝐶𝑙𝑜𝑤𝑒𝑟and 𝐶𝑢𝑝𝑝𝑒𝑟are
𝐶𝑙𝑜𝑤𝑒𝑟= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇)] , 0}||| ℱ𝑡
]
and
𝐶𝑢𝑝𝑝𝑒𝑟= 𝐶𝑙𝑜𝑤𝑒𝑟+ 1
2𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[√
Var [𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇)]||||
ℱ𝑡
]
= 𝐶𝑙𝑜𝑤𝑒𝑟
+1
2𝑒−𝑟(𝑇−𝑡)𝔼ℚ
⎡
⎢
⎢⎣
√
√
√
√Var
[
𝐴𝑛(𝜏, 𝑡𝑘) + 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖−𝐾
|||||
𝐺𝑛(𝜏, 𝑇)
]|||||||
ℱ𝑡
⎤
⎥
⎥⎦
= 𝐶𝑙𝑜𝑤𝑒𝑟+ 1
2𝑒−𝑟(𝑇−𝑡)𝔼ℚ
⎡
⎢
⎢⎣
√
√
√
√Var
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
𝐺𝑛(𝜏, 𝑇)
]|||||||
ℱ𝑡
⎤
⎥
⎥⎦
.

5.2.1 Discrete Sampling
477
By setting 𝑔(𝑧) as the pdf of 𝐺𝑛(𝜏, 𝑇) and because 𝐴𝑛(𝜏, 𝑇) ≥𝐺𝑛(𝜏, 𝑇)
𝐶𝑙𝑜𝑤𝑒𝑟= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇)] , 0}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] , 0} 𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
𝐾
0
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] , 0} 𝑔(𝑧) 𝑑𝑧
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] , 0} 𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
𝐾
0
max {𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] , 0} 𝑔(𝑧) 𝑑𝑧
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
𝐾
̃
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
where
̃
𝐾= {𝑧| 𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] = 𝐾} .
To find ̃
𝐾, we note that
𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] = 𝐴𝑛(𝜏, 𝑡𝑘) + 𝔼ℚ
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
𝐺𝑛(𝜏, 𝑇) = 𝑧
]
= 𝐴𝑛(𝜏, 𝑡𝑘) + 𝔼ℚ
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
log 𝐺𝑛(𝜏, 𝑇) = log 𝑧
]
.
Since
log 𝑆𝑡𝑖| log 𝐺𝑛(𝜏, 𝑇) = 𝑦∼
(
𝜇𝑖+ (𝑦−𝜇𝐺)𝜎𝑖𝐺
𝜎2
𝐺
, 𝜎2
𝑖−
𝜎2
𝑖𝐺
𝜎2
𝐺
)
then
𝑆𝑡𝑖| log 𝐺𝑛(𝜏, 𝑇) = 𝑦∼log −
(
𝜇𝑖+ (𝑦−𝜇𝐺)𝜎𝑖𝐺
𝜎2
𝐺
, 𝜎2
𝑖−
𝜎2
𝑖𝐺
𝜎2
𝐺
)
.

478
5.2.1 Discrete Sampling
Hence,
𝔼ℚ
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
log 𝐺𝑛(𝜏, 𝑇) = log 𝑧
]
= 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒𝜇𝑖+(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺+ 1
2 (𝜎2
𝑖−𝜎2
𝑖𝐺∕𝜎2
𝐺)
and by finding the root of the equation
𝐴𝑛(𝜏, 𝑡𝑘) + 1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒𝜇𝑖+(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺+ 1
2 (𝜎2
𝑖−𝜎2
𝑖𝐺∕𝜎2
𝐺) = 𝐾
we can obtain a value for ̃
𝐾.
Therefore,
𝐶𝑙𝑜𝑤𝑒𝑟= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇) −𝐾|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝔼ℚ[𝐴𝑛(𝜏, 𝑇)|| 𝐺𝑛(𝜏, 𝑇) = 𝑧] 𝑔(𝑧) 𝑑𝑧
−𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
{
𝐴𝑛(𝜏, 𝑡𝑘) + 𝔼ℚ
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
𝐺𝑛(𝜏, 𝑇) = 𝑧
]}
𝑔(𝑧) 𝑑𝑧
−𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝑔(𝑧) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̃
𝐾
𝔼ℚ
[
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑆𝑡𝑖
|||||
𝐺𝑛(𝜏, 𝑇) = 𝑧
]
𝑔(𝑧) 𝑑𝑧
+𝑒−𝑟(𝑇−𝑡) (𝐴𝑛(𝜏, 𝑡𝑘) −𝐾)
∫
∞
̃
𝐾
𝑔(𝑧) 𝑑𝑧.
Since
𝑔(𝑧) =
1
√
2𝜋𝜎𝐺𝑧
𝑒
−1
2
( log 𝑧−𝜇𝐺
𝜎𝐺
)2
therefore
∫
∞
̃
𝐾
𝑔(𝑧) 𝑑𝑧= Φ
(
𝜇𝐺−log ̃
𝐾
𝜎𝐺
)

5.2.1 Discrete Sampling
479
and
∫
∞
̃
𝐾
𝔼ℚ[
𝑆𝑡𝑖
||| 𝐺𝑛(𝜏, 𝑇) = 𝑧
]
𝑔(𝑧) 𝑑𝑧
= ∫
∞
̃
𝐾
𝔼ℚ[
𝑆𝑡𝑖
||| log 𝐺𝑛(𝜏, 𝑇) = log 𝑧
]
𝑔(𝑧) 𝑑𝑧
= ∫
∞
̃
𝐾
𝑒𝜇𝑖+(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺+ 1
2 (𝜎2
𝑖−𝜎2
𝑖𝐺∕𝜎2
𝐺)𝑔(𝑧) 𝑑𝑧
= ∫
∞
̃
𝐾
𝑒𝜇𝑖+(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺+ 1
2 (𝜎2
𝑖−𝜎2
𝑖𝐺∕𝜎2
𝐺) ×
1
√
2𝜋𝜎𝐺𝑧
𝑒
−1
2
( log 𝑧−𝜇𝐺
𝜎𝐺
)2
𝑑𝑧
= 𝑒𝜇𝑖+ 1
2 𝜎2
𝑖∫
∞
̃
𝐾
1
√
2𝜋𝜎𝐺𝑧
𝑒
(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺−1
2
(
(log 𝑧−𝜇𝐺)2+𝜎2
𝑖𝐺
𝜎2
𝐺
)
𝑑𝑧.
By setting
𝑣= log 𝑧−𝜇𝐺−𝜎𝑖𝐺
𝜎𝐺
⇒𝑑𝑣
𝑑𝑧=
1
𝜎𝐺𝑧
therefore
𝑒𝜇𝑖+ 1
2 𝜎2
𝑖∫
∞
̃
𝐾
1
√
2𝜋𝜎𝐺𝑧
𝑒
(log 𝑧−𝜇𝐺)𝜎𝑖𝐺∕𝜎2
𝐺−1
2
(
(log 𝑧−𝜇𝐺)2+𝜎2
𝑖𝐺
𝜎2
𝐺
)
𝑑𝑧
= 𝑒𝜇𝑖+ 1
2 𝜎2
𝑖∫
∞
log ̃
𝐾−𝜇𝐺−𝜎𝑖𝐺
𝜎𝐺
1
√
2𝜋
𝑒−1
2 𝑣2 𝑑𝑣
= 𝑒𝜇𝑖+ 1
2 𝜎2
𝑖Φ
(
𝜇𝐺−log ̃
𝐾+ 𝜎𝑖𝐺
𝜎𝐺
)
.
Thus, the lower bound of the arithmetic average rate call option is
𝐶𝑙𝑜𝑤𝑒𝑟= 𝑒−𝑟(𝑇−𝑡)
{
1
𝑛
𝑛
∑
𝑖=𝑘+1
𝑒𝜇𝑖+ 1
2 𝜎2
𝑖Φ
(
𝜇𝐺−log ̃
𝐾+ 𝜎𝑖𝐺
𝜎𝐺
)
+ (𝐴𝑛(𝜏, 𝑡𝑘) −𝐾) Φ
(
𝜇𝐺−log ̃
𝐾
𝜎𝐺
)}
.

480
5.2.2 Continuous Sampling
5.2.2
Continuous Sampling
1. Black–Scholes Equation for Asian Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and 𝑟denotes the risk-free interest rate.
Let 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) be the exotic path-dependent Asian option price at time 𝑡which depends
on
𝑆𝑡and 𝐼𝑡= ∫
𝑡
𝜏
𝑓(𝑆𝑢, 𝑢) 𝑑𝑢
where the function 𝑓is a function of 𝑆𝑡and 𝑡, so that 𝐼𝑡is the integral of the asset price
function from initial time 𝜏up to time 𝑡. By considering a hedging portfolio involving both
an option 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) which cannot be exercised before its expiry time 𝑇, 𝜏< 𝑡< 𝑇and
an asset price 𝑆𝑡, show that 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) satisfies the PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
−𝑟𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 0.
Solution: At time 𝑡we let the value of a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) −Δ𝑆𝑡
where it involves buying one unit of option 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) and selling Δ units of 𝑆𝑡. Since we
receive 𝐷𝑆𝑡𝑑𝑡for every asset held, the change in portfolio Π𝑡is therefore
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡) = 𝑑𝑉−Δ𝑑𝑆𝑡−Δ𝐷𝑆𝑡𝑑𝑡.
Expanding 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) using Taylor’s series
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 𝜕𝑉
𝜕𝐼𝑡
𝑑𝐼𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
2
𝜕2𝑉
𝜕𝐼2
𝑡
(𝑑𝐼𝑡)2
+ 𝜕2𝑉
𝜕𝑆𝑡𝜕𝐼𝑡
(𝑑𝑆𝑡𝑑𝐼𝑡) + …
and by substituting 𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡, 𝑑𝐼𝑡= 𝑓(𝑆𝑡, 𝑡)𝑑𝑡and applying It¯o’s
lemma we have
𝑑𝑉=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
)
𝑑𝑡+ 𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡.

5.2.2 Continuous Sampling
481
Substituting the above expression into 𝑑Π𝑡and rearranging terms, we have
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
)
𝑑𝑡
+𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡−Δ [(𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡+ 𝐷𝑆𝑡𝑑𝑡]
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
−𝜇Δ𝑆𝑡
)
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
To eliminate the random component we choose
Δ = 𝜕𝑉
𝜕𝑆𝑡
which leads to
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
)
𝑑𝑡.
Under the no-arbitrage condition the return on the amount 𝐼𝑡invested in a risk-free interest
rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡
and hence we can set
𝑟Π𝑡𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
)
𝑑𝑡
𝑟(𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) −Δ𝑆𝑡
) = 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
𝑟
(
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
= 𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
.
Rearranging terms, we finally have the Black–Scholes equation for Asian options given
by
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑓(𝑆𝑡, 𝑡)𝜕𝑉
𝜕𝐼𝑡
−𝑟𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 0.

482
5.2.2 Continuous Sampling
2. Similarity Reduction I. Let {𝑊𝑡: 𝑡≥0} be the ℙ-standard Wiener process on the proba-
bility space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
Let 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) be a path-dependent Asian option price at time 𝑡, 𝜏< 𝑡< 𝑇which
depends on
𝑆𝑡and 𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
where 𝜏is the initial time and the option can only be exercised at expiry time 𝑇. Assume
that 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕𝑉
𝜕𝐼𝑡
−𝑟𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 0
with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = 𝑆𝛼
𝑇𝐹(𝐼𝑇∕𝑆𝑇
)
for some constant 𝛼and function 𝐹. By considering the change of variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝑆𝛼
𝑡𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡∕𝑆𝑡
show that 𝐻(𝑥, 𝑡) satisfies
𝜕𝐻
𝜕𝑡+ 1
2𝜎2𝑥2 𝜕2𝐻
𝜕𝑥2 + [1 + {(1 −𝛼)𝜎2 −(𝑟−𝐷)} 𝑥] 𝜕𝐻
𝜕𝑥
−
[
(1 −𝛼)
(1
2𝛼𝜎2 + 𝑟
)
+ 𝛼𝐷
]
𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑥).
Solution: Based on the change of variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝑆𝛼
𝑡𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡∕𝑆𝑡
we have
𝜕𝑉
𝜕𝑡= 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑡; 𝜕𝑉
𝜕𝐼𝑡
= 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝐼𝑡
= 𝑆𝛼−1
𝑡
𝜕𝐻
𝜕𝑥

5.2.2 Continuous Sampling
483
𝜕𝑉
𝜕𝑆𝑡
= 𝛼𝑆𝛼−1
𝑡
𝐻(𝑥, 𝑡) + 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝑆𝛼−1
𝑡
(
𝛼𝐻(𝑥, 𝑡) −𝑥𝜕𝐻
𝜕𝑥
)
𝜕2𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
[
𝑆𝛼−1
𝑡
(
𝛼𝐻(𝑥, 𝑡) −𝑥𝜕𝐻
𝜕𝑥
)]
= (𝛼−1)𝑆𝛼−2
𝑡
(
𝛼𝐻(𝑥, 𝑡) −𝑥𝜕𝐻
𝜕𝑥
)
+𝑆𝛼−1
𝑡
(
𝛼𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
−𝜕𝑥
𝜕𝑆𝑡
𝜕𝐻
𝜕𝑥−𝑥𝜕2𝐻
𝜕𝑥2
𝜕𝑥
𝜕𝑆𝑡
)
= (𝛼−1)𝑆𝛼−2
𝑡
(
𝛼𝐻(𝑥, 𝑡) −𝑥𝜕𝐻
𝜕𝑥
)
+𝑆𝛼−2
𝑡
(
𝑥2 𝜕2𝐻
𝜕𝑥2 −(𝛼−1)𝑥𝜕𝐻
𝜕𝑥
)
= 𝑆𝛼−2
𝑡
(
𝑥2 𝜕2𝐻
𝜕𝑥2 −2(𝛼−1)𝑥𝜕𝐻
𝜕𝑥+ 𝛼(𝛼−1)𝐻(𝑥, 𝑡)
)
.
By substituting the above expressions into the PDE, we have
𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑡+ 1
2𝜎2𝑆𝛼
𝑡
(
𝑥2 𝜕2𝐻
𝜕𝑥2 −2(𝛼−1)𝑥𝜕𝐻
𝜕𝑥+ 𝛼(𝛼−1)𝐻(𝑥, 𝑡)
)
+(𝑟−𝐷)𝑆𝛼
𝑡
(
𝛼𝐻(𝑥, 𝑡) −𝑥𝜕𝐻
𝜕𝑥
)
+ 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑥−𝑟𝑆𝛼
𝑡𝐻(𝑥, 𝑡) = 0
and taking out 𝑆𝛼
𝑡and rearranging terms we eventually have
𝜕𝐻
𝜕𝑡+ 1
2𝜎2𝑥2 𝜕2𝐻
𝜕𝑥2 + [1 + {(1 −𝛼)𝜎2 −(𝑟−𝐷)} 𝑥] 𝜕𝐻
𝜕𝑥
−
[
(1 −𝛼)
(1
2𝛼𝜎2 + 𝑟
)
+ 𝛼𝐷
]
𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑥)
since 𝑉(𝑆𝑇, 𝐼𝑇, 𝑇) = 𝑆𝛼
𝑇𝐹(𝐼𝑇∕𝑆𝑇) = 𝑆𝛼
𝑇𝐻(𝐼𝑇∕𝑆𝑇, 𝑇) and 𝑥= 𝐼𝑇∕𝑆𝑇.
3. Similarity Reduction II. Let {𝑊𝑡: 𝑡≥0} be the ℙ-standard Wiener process on the proba-
bility space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.

484
5.2.2 Continuous Sampling
Let 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) be a path-dependent Asian option price at time 𝑡, 𝜏< 𝑡< 𝑇which
depends on
𝑆𝑡and 𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
where 𝜏is the initial time and the option can only be exercised at expiry time 𝑇. Assume
that 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ log 𝑆𝑡
𝜕𝑉
𝜕𝐼𝑡
−𝑟𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 0
with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = 𝐹(𝐼𝑇)
where 𝐹is only a function of 𝐼𝑇. By considering the change of variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡
𝑇−𝜏
show that 𝐻(𝑥, 𝑡) satisfies
𝜕𝐻
𝜕𝑡+ 1
2
(𝜎(𝑇−𝑡)
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 +
(
𝑟−𝐷−1
2𝜎2) ( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥−𝑟𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑥(𝑇−𝜏)).
Solution: Using the technique of changing variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡
𝑇−𝜏
we have
𝜕𝑉
𝜕𝑡= 𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑡+ 𝜕𝐻
𝜕𝑡= 𝜕𝐻
𝜕𝑡−log 𝑆𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥
𝜕𝑉
𝜕𝐼𝑡
= 𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝐼𝑡
=
1
𝑇−𝜏
𝜕𝐻
𝜕𝑥

5.2.2 Continuous Sampling
485
𝜕𝑉
𝜕𝑆𝑡
= 𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 1
𝑆𝑡
( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥
𝜕2𝑉
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
[
1
𝑆𝑡
( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥
]
=
( 𝑇−𝑡
𝑇−𝜏
) (
−1
𝑆2
𝑡
𝜕𝐻
𝜕𝑥+ 1
𝑆𝑡
𝜕2𝐻
𝜕𝑥2
𝜕𝑥
𝜕𝑆𝑡
)
=
( 𝑇−𝑡
𝑇−𝜏
) [
1
𝑆2
𝑡
( 𝑇−𝑡
𝑇−𝜏
) 𝜕2𝐻
𝜕𝑥2 −1
𝑆2
𝑡
𝜕𝐻
𝜕𝑥
]
= 1
𝑆2
𝑡
( 𝑇−𝑡
𝑇−𝜏
) [( 𝑇−𝑡
𝑇−𝜏
) 𝜕2𝐻
𝜕𝑥2 −𝜕𝐻
𝜕𝑥
]
.
By substituting the above expressions into the PDE, we have
𝜕𝐻
𝜕𝑡−log 𝑆𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
) [( 𝑇−𝑡
𝑇−𝜏
) 𝜕2𝐻
𝜕𝑥2 −𝜕𝐻
𝜕𝑥
]
+(𝑟−𝐷)
( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥+ log 𝑆𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥−𝑟𝐻(𝑥, 𝑡) = 0
or
𝜕𝐻
𝜕𝑡+ 1
2
(𝜎(𝑇−𝑡)
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 +
(
𝑟−𝐷−1
2𝜎2) ( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥−𝑟𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑥(𝑇−𝜏))
since 𝑉(𝑆𝑇, 𝐼𝑇, 𝑇) = 𝐹(𝐼𝑇) = 𝐻(𝑥, 𝑇) and 𝑥= 𝐼𝑇∕(𝑇−𝜏).
4. Similarity Reduction III. Let {𝑊𝑡: 𝑡≥0} be the ℙ-standard Wiener process on the prob-
ability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
Let 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) be a path-dependent Asian option price at time 𝑡, 𝜏< 𝑡< 𝑇which
depends on
𝑆𝑡
and
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢

486
5.2.2 Continuous Sampling
where 𝜏≥0 is the initial time and the option can only be exercised at expiry time 𝑇.
Assume that 𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ log 𝑆𝑡
𝜕𝑉
𝜕𝐼𝑡
−𝑟𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 0
with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = 𝑆𝛼
𝑇𝐹
(
𝑒𝐼𝑇∕(𝑇−𝜏)
𝑆𝑇
)
for some constant 𝛼and function 𝐹. By considering the change of variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝑆𝛼
𝑡𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡−(𝑡−𝜏) log 𝑆𝑡
𝑇−𝜏
show that 𝐻(𝑥, 𝑡) satisfies
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 −
[
𝑟−𝐷+ 1
2(2𝛼−1)𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)] 𝜕𝐻
𝜕𝑥
+
[1
2𝛼(𝛼−1)𝜎2 + 𝛼(𝑟−𝐷) −𝑟
]
𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑒𝑥).
Solution: Using the change of variables
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡) = 𝑆𝛼
𝑡𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡−(𝑡−𝜏) log 𝑆𝑡
𝑇−𝜏
we have
𝜕𝑉
𝜕𝑡= 𝑆𝛼
𝑡
(𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑡+ 𝜕𝐻
𝜕𝑡
)
= 𝑆𝛼
𝑡
(
𝜕𝐻
𝜕𝑡−log 𝑆𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥
)
𝜕𝑉
𝜕𝐼𝑡
= 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝐼𝑡
=
𝑆𝛼
𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥
𝜕𝑉
𝜕𝑆𝑡
= 𝛼𝑆𝛼−1
𝑡
𝐻(𝑥, 𝑡) + 𝑆𝛼
𝑡
𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝛼𝑆𝛼−1
𝑡
𝐻(𝑥, 𝑡) −𝑆𝛼−1
𝑡
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥

5.2.2 Continuous Sampling
487
and
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝛼(𝛼−1)𝑆𝛼−2
𝑡
𝐻(𝑥, 𝑡) + 𝛼𝑆𝛼−1
𝑡
𝜕𝐻
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
−(𝛼−1)𝑆𝛼−2
𝑡
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥−𝑆𝛼−1
𝑡
( 𝑡−𝜏
𝑇−𝜏
) 𝜕2𝐻
𝜕𝑥2
𝜕𝑥
𝜕𝑆𝑡
= 𝑆𝛼−2
𝑡
[
𝛼(𝛼−1)𝐻(𝑥, 𝑡) −𝛼
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥
−(𝛼−1)
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥+
( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2
]
= 𝑆𝛼−2
𝑡
[( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 −(2𝛼−1)
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥+ 𝛼(𝛼−1)𝐻(𝑥, 𝑡)
]
.
By substituting the above expressions into the PDE, we have
𝑆𝛼
𝑡
(
𝜕𝐻
𝜕𝑡−log 𝑆𝑡
𝑇
𝜕𝐻
𝜕𝑥
)
+ 1
2𝜎2𝑆𝛼
𝑡
[( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2
−(2𝛼−1)
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥+ 𝛼(𝛼−1)𝐻(𝑥, 𝑡)
]
+ 𝛼(𝑟−𝐷)𝑆𝛼
𝑡𝐻(𝑥, 𝑡)
−(𝑟−𝐷)𝑆𝛼
𝑡
( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥+ 𝑆𝛼
𝑡
log 𝑆𝑡
𝑇−𝜏
𝜕𝐻
𝜕𝑥−𝑟𝑆𝛼
𝑡𝐻(𝑥, 𝑡) = 0.
By removing 𝑆𝛼
𝑡and rearranging terms, we have
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 −
[
𝑟−𝐷+ 1
2(2𝛼−1)𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)] 𝜕𝐻
𝜕𝑥
+
[1
2𝛼(𝛼−1)𝜎2 + 𝛼(𝑟−𝐷) −𝑟
]
𝐻(𝑥, 𝑡) = 0
with payoff
𝐻(𝑥, 𝑇) = 𝐹(𝑒𝑥)
since 𝑉(𝑆𝑇, 𝐼𝑇, 𝑇) = 𝑆𝛼
𝑇𝐹
(
𝑒𝐼𝑇∕(𝑇−𝜏)
𝑆𝑇
)
= 𝑆𝛼
𝑇𝐻(𝑥, 𝑇) and 𝑥=
𝐼𝑇
𝑇−𝜏−log 𝑆𝑇.
5. Arithmetic Average Rate (Fixed Strike) Asian Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0}
be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset price
𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.

488
5.2.2 Continuous Sampling
We define
𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
to be the asset running sum from initial time 𝜏≥0 until time 𝑡and consider the arithmetic
average rate call option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝐾, 0
}
where 𝐾> 0 is the strike price and 𝑇is the option expiry time. Assume that the arithmetic
average rate call option price at time 𝑡< 𝑇, 𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) satisfies the PDE
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶(𝑎)
𝑎𝑟
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝐼𝑡
−𝑟𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝐾, 0
}
.
By considering the change of variables
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡),
𝑥= 𝐼𝑡−𝐾(𝑇−𝜏)
𝑆𝑡(𝑇−𝜏)
show that 𝑢(𝑥, 𝑡) satisfies
𝜕𝑢
𝜕𝑡+ 1
2𝜎2𝑥2 𝜕2𝑢
𝜕𝑥2 +
[
1
𝑇−𝜏−(𝑟−𝐷)𝑥
] 𝜕𝑢
𝜕𝑥−𝐷𝑢(𝑥, 𝑡) = 0
with boundary condition
𝑢(𝑥, 𝑇) = max{𝑥, 0}.
By setting
𝑢(𝑥, 𝑡) = 𝑎(𝑡)𝑥+ 𝑏(𝑡)
show that 𝑎(𝑡) and 𝑏(𝑡) satisfy the ODEs
𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0
and
𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −𝑎(𝑡)
𝑇−𝜏.

5.2.2 Continuous Sampling
489
Hence, show that for 𝑥≥0 and 𝑟≠𝐷the arithmetic average rate call option price at time
𝑡, 𝜏< 𝑡< 𝑇is
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) =
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝑟(𝑇−𝑡) +
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡.
What is the solution if 𝑟→𝐷?
Solution: From the change of variables
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡),
𝑥= 𝐼𝑡−𝐾(𝑇−𝜏)
𝑆𝑡(𝑇−𝜏)
we have
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑡
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝐼𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝐼𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑥
1
𝑆𝑡(𝑇−𝜏) =
1
𝑇−𝜏
𝜕𝑢
𝜕𝑥
𝜕𝐶(𝑎)
𝑎𝑟
𝜕𝑆𝑡
= 𝑢(𝑥, 𝑡) + 𝑆𝑡
𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝑢(𝑥, 𝑡) −𝑥𝜕𝑢
𝜕𝑥
𝜕2𝐶(𝑎)
𝑎𝑟
𝜕𝑆2
𝑡
= 𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
−𝑥𝜕2𝑢
𝜕𝑥2
𝜕𝑥
𝜕𝑆𝑡
−𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝑥𝜕2𝑢
𝜕𝑥2
(
𝐼𝑡−𝐾(𝑇−𝜏)
𝑆2
𝑡(𝑇−𝜏)
)
= 𝑥2
𝑆𝑡
𝜕2𝑢
𝜕𝑥2 .
By substituting the above results into the PDE, we have
𝑆𝑡
𝜕𝑢
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
(
𝑥2
𝑆𝑡
)
𝜕2𝑢
𝜕𝑥2 + (𝑟−𝐷)𝑆𝑡
(
𝑢(𝑥, 𝑡) −𝑥𝜕𝑢
𝜕𝑥
)
+
𝑆𝑡
𝑇−𝜏
𝜕𝑢
𝜕𝑥−𝑟𝑆𝑡𝑢(𝑥, 𝑡) = 0
or
𝜕𝑢
𝜕𝑡+ 1
2𝜎2𝑥2 𝜕2𝑢
𝜕𝑥2 +
[
1
𝑇−𝜏−(𝑟−𝐷)𝑥
] 𝜕𝑢
𝜕𝑥−𝐷𝑢(𝑥, 𝑡) = 0
with boundary condition
𝑢(𝑥, 𝑇) = max{𝑥, 0}
since
𝐶(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝐾, 0
}
= 𝑆𝑇max
{𝐼𝑇−𝐾(𝑇−𝜏)
𝑆𝑇(𝑇−𝜏)
, 0
}
= 𝑆𝑇max{𝑥, 0}.

490
5.2.2 Continuous Sampling
Let 𝑢(𝑥, 𝑡) = 𝑎(𝑡)𝑥+ 𝑏(𝑡) so that
𝜕𝑢
𝜕𝑡= 𝑥𝑑𝑎
𝑑𝑡+ 𝑑𝑏
𝑑𝑡;
𝜕𝑢
𝜕𝑥= 𝑎(𝑡);
𝜕2𝑢
𝜕𝑥2 = 0
and by substituting the results into the PDE satisfied by 𝑢(𝑥, 𝑡)
𝑥𝑑𝑎
𝑑𝑡+ 𝑑𝑏
𝑑𝑡+
(
1
𝑇−𝜏−(𝑟−𝐷)𝑥
)
𝑎(𝑡) −𝐷𝑎(𝑡)𝑥−𝐷𝑏(𝑡) = 0
or
𝑥
(𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡)
)
+ 𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) + 𝑎(𝑡)
𝑇−𝜏= 0.
Hence, we can set
𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0
and
𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −𝑎(𝑡)
𝑇−𝜏.
To solve 𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0 we let the integrating factor 𝐼𝑎= 𝑒−∫𝑟𝑑𝑡= 𝑒−𝑟𝑡and therefore
𝑑
𝑑𝑡
(𝑎(𝑡)𝑒−𝑟𝑡) = 0 or 𝑎(𝑡)𝑒−𝑟𝑡= 𝐶1
where 𝐶1 is a constant. Hence, 𝑎(𝑡) = 𝐶1𝑒𝑟𝑡.
In contrast, for 𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −𝑎(𝑡)
𝑇−𝜏we let the integrating factor 𝐼𝑏= 𝑒−∫𝐷𝑑𝑡=
𝑒−𝐷𝑡. Therefore,
𝑑
𝑑𝑡
(𝑏(𝑡)𝑒−𝐷𝑡) = −𝑎(𝑡)
𝑇−𝜏𝑒−𝐷𝑡
𝑏(𝑡)𝑒−𝐷𝑡= −
1
𝑇−𝜏∫𝑎(𝑡)𝑒−𝐷𝑡𝑑𝑡.
Substituting 𝑎(𝑡) = 𝐶1𝑒𝑟𝑡we have
𝑏(𝑡)𝑒−𝐷𝑡= −𝐶1
𝑇−𝜏∫𝑒(𝑟−𝐷)𝑡𝑑𝑡
= −
𝐶1𝑒(𝑟−𝐷)𝑡
(𝑟−𝐷)(𝑇−𝜏) + 𝐶2
where 𝐶2 is a constant. Thus,
𝑢(𝑥, 𝑡) = 𝐶1𝑒𝑟𝑡𝑥−
𝐶1𝑒𝑟𝑡
(𝑟−𝐷)(𝑇−𝜏) + 𝐶2𝑒𝐷𝑡.

5.2.2 Continuous Sampling
491
At the boundary condition for 𝑥≥0, 𝑢(𝑥, 𝑇) = 𝑥we therefore have
𝐶1𝑒𝑟𝑇𝑥−
𝐶1𝑒𝑟𝑇
(𝑟−𝐷)(𝑇−𝜏) + 𝐶2𝑒𝐷𝑇= 𝑥
and by equating coefficients
𝐶1 = 𝑒−𝑟𝑇
and
𝐶2 =
𝑒−𝐷𝑇
(𝑟−𝐷)(𝑇−𝜏)
which leads to
𝑢(𝑥, 𝑡) = 𝑥𝑒−𝑟(𝑇−𝑡) + 𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
.
Thus, for 𝑥≥0 or
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢≥𝐾
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡)
= 𝑆𝑡
(𝐼𝑡−𝐾(𝑇−𝜏)
𝑆𝑡(𝑇−𝜏)
)
𝑒−𝑟(𝑇−𝑡) +
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝑟(𝑇−𝑡) +
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡.
Finally, for the case 𝑟→𝐷and from the application of L’Ĥopital’s rule
lim
𝑟→𝐷𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = lim
𝑟→𝐷
(
1
𝑇−𝜏∫
𝑡
0
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝑟(𝑇−𝑡)
+ lim
𝑟→𝐷
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝐷(𝑇−𝑡) + lim
𝑟→𝐷
−𝑟𝑒−𝑟(𝑇−𝑡)
𝑇−𝜏
𝑆𝑡
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝐷(𝑇−𝑡) −𝐷𝑆𝑡
𝑇−𝜏𝑒−𝐷(𝑇−𝑡)
=
[
1
𝑇−𝜏
(
∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐷𝑆𝑡
)
−𝐾
]
𝑒−𝐷(𝑇−𝑡).
6. Arithmetic Average Strike (Floating Strike) Asian Option (PDE Approach). Let {𝑊𝑡: 𝑡≥
0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset
price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡

492
5.2.2 Continuous Sampling
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
We define
𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
to be the asset running sum from initial time 𝜏≥0 until time 𝑡and consider the arithmetic
average strike put option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
where 𝑇> 𝑡is the option expiry time. Assume that the arithmetic average strike put option
price at time 𝑡, 𝜏< 𝑡< 𝑇, 𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) satisfies the PDE
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃(𝑎)
𝑎𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝐼𝑡
−𝑟𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 0
with boundary condition
𝑃(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
.
By considering the change of variables
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡),
𝑥= 𝐼𝑡−𝑆𝑡(𝑇−𝜏)
𝑆𝑡(𝑇−𝜏)
show that 𝑢(𝑥, 𝑡) satisfies
𝜕𝑢
𝜕𝑡+ 1
2𝜎2(𝑥+ 1)2 𝜕2𝑢
𝜕𝑥2 +
[
1
𝑇−𝜏−(𝑟−𝐷)(𝑥+ 1)
] 𝜕𝑢
𝜕𝑥−𝐷𝑢(𝑥, 𝑡) = 0
with boundary condition
𝑢(𝑥, 𝑇) = max{𝑥, 0}.
By setting
𝑢(𝑥, 𝑡) = 𝑎(𝑡)𝑥+ 𝑏(𝑡)
show that 𝑎(𝑡) and 𝑏(𝑡) satisfy the ODEs
𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0
and
𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −
[
1
𝑇−𝜏−(𝑟−𝐷)
]
𝑎(𝑡).

5.2.2 Continuous Sampling
493
Hence, show that for 𝑥≥0 and 𝑟≠𝐷the arithmetic average strike put option price at time
𝑡, 𝜏< 𝑡< 𝑇is
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) =
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝑆𝑡
)
𝑒−𝑟(𝑇−𝑡)
+
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
) (𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)) 𝑆𝑡.
What is the solution if 𝑟→𝐷?
Solution: From the change of variables
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡),
𝑥= 𝐼𝑡−𝑆𝑡(𝑇−𝜏)
𝑆𝑡(𝑇−𝜏)
we have
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑡
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝐼𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝐼𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑥
1
𝑆𝑡(𝑇−𝜏) =
1
𝑇−𝜏
𝜕𝑢
𝜕𝑥
𝜕𝑃(𝑎)
𝑎𝑠
𝜕𝑆𝑡
= 𝑢(𝑥, 𝑡) + 𝑆𝑡
𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= 𝑢(𝑥, 𝑡) −𝑆𝑡
𝜕𝑢
𝜕𝑥
(
𝐼𝑡
𝑆2
𝑡(𝑇−𝜏)
)
= 𝑢(𝑥, 𝑡) −(𝑥+ 1) 𝜕𝑢
𝜕𝑥
and
𝜕2𝑃(𝑎)
𝑎𝑠
𝜕𝑆2
𝑡
= 𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
−(𝑥+ 1) 𝜕2𝑢
𝜕𝑥2
𝜕𝑥
𝜕𝑆𝑡
−𝜕𝑢
𝜕𝑥
𝜕𝑥
𝜕𝑆𝑡
= (𝑥+ 1) 𝜕2𝑢
𝜕𝑥2
(
𝐼𝑡
𝑆2
𝑡(𝑇−𝜏)
)
= (𝑥+ 1)2
𝑆𝑡
𝜕2𝑢
𝜕𝑥2 .

494
5.2.2 Continuous Sampling
By substituting the above results into the PDE, we have
𝑆𝑡
𝜕𝑢
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
((𝑥+ 1)2
𝑆𝑡
)
𝜕2𝑢
𝜕𝑥2 + (𝑟−𝐷)𝑆𝑡
(
𝑢(𝑥, 𝑡) −(𝑥+ 1) 𝜕𝑢
𝜕𝑥
)
+
𝑆𝑡
𝑇−𝜏
𝜕𝑢
𝜕𝑥−𝑟𝑆𝑡𝑢(𝑥, 𝑡) = 0
or
𝜕𝑢
𝜕𝑡+ 1
2𝜎2(𝑥+ 1)2 𝜕2𝑢
𝜕𝑥2 +
[ 1
𝑇−(𝑟−𝐷)(𝑥+ 1)
] 𝜕𝑢
𝜕𝑥−𝐷𝑢(𝑥, 𝑡) = 0
with boundary condition
𝑢(𝑥, 𝑇) = max{𝑥, 0}
since
𝑃(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
= 𝑆𝑇max
{𝐼𝑇−𝑆𝑇(𝑇−𝜏)
𝑆𝑇(𝑇−𝜏)
, 0
}
= 𝑆𝑇max{𝑥, 0}.
Let 𝑢(𝑥, 𝑡) = 𝑎(𝑡)𝑥+ 𝑏(𝑡) so that
𝜕𝑢
𝜕𝑡= 𝑥𝑑𝑎
𝑑𝑡+ 𝑑𝑏
𝑑𝑡;
𝜕𝑢
𝜕𝑥= 𝑎(𝑡);
𝜕2𝑢
𝜕𝑥2 = 0
and by substituting the results into the PDE satisfied by 𝑢(𝑥, 𝑡) we have
𝑥𝑑𝑎
𝑑𝑡+ 𝑑𝑏
𝑑𝑡+
(
1
𝑇−𝜏−(𝑟−𝐷)(𝑥+ 1)
)
𝑎(𝑡) −𝐷𝑎(𝑡)𝑥−𝐷𝑏(𝑡) = 0
or
𝑥
(𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡)
)
+ 𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) +
(
1
𝑇−𝜏−(𝑟−𝐷)
)
𝑎(𝑡) = 0.
Hence, we can set
𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0
and
𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −
(
1
𝑇−𝜏−(𝑟−𝐷)
)
𝑎(𝑡).
To solve 𝑑𝑎
𝑑𝑡−𝑟𝑎(𝑡) = 0 we let the integrating factor 𝐼𝑎= 𝑒−∫𝑟𝑑𝑡= 𝑒−𝑟𝑡and therefore
𝑑
𝑑𝑡
(𝑎(𝑡)𝑒−𝑟𝑡) = 0 or 𝑎(𝑡)𝑒−𝑟𝑡= 𝐶1

5.2.2 Continuous Sampling
495
where 𝐶1 is a constant. Hence, 𝑎(𝑡) = 𝐶1𝑒𝑟𝑡.
In contrast, for 𝑑𝑏
𝑑𝑡−𝐷𝑏(𝑡) = −
(
1
𝑇−𝜏−(𝑟−𝐷)
)
𝑎(𝑡) we let the integrating factor
𝐼𝑏= 𝑒−∫𝐷𝑑𝑡= 𝑒−𝐷𝑡. Therefore,
𝑑
𝑑𝑡
(𝑏(𝑡)𝑒−𝐷𝑡) = −
(
1
𝑇−𝜏−(𝑟−𝐷)
)
𝑎(𝑡)𝑒−𝐷𝑡
𝑏(𝑡)𝑒−𝐷𝑡= −
(
1
𝑇−𝜏−(𝑟−𝐷)
)
∫𝑎(𝑡)𝑒−𝐷𝑡𝑑𝑡.
Substituting 𝑎(𝑡) = 𝐶1𝑒𝑟𝑡we have
𝑏(𝑡)𝑒−𝐷𝑡= −𝐶1
(
1
𝑇−𝜏−(𝑟−𝐷)
)
∫𝑒(𝑟−𝐷)𝑡𝑑𝑡
= −𝐶1
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑒(𝑟−𝐷)𝑡+ 𝐶2
= −𝐶1
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑒𝑟𝑡+ 𝐶2𝑒𝐷𝑡
where 𝐶2 is a constant. Thus,
𝑢(𝑥, 𝑡) = 𝐶1𝑒𝑟𝑡𝑥−𝐶1
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑒𝑟𝑡+ 𝐶2𝑒𝐷𝑡.
At the boundary condition for 𝑥≥0, 𝑢(𝑥, 𝑇) = 𝑥we therefore have
𝐶1𝑒𝑟𝑇𝑥−𝐶1
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑒𝑟𝑇+ 𝐶2𝑒𝐷𝑇= 𝑥
and by equating coefficients
𝐶1 = 𝑒−𝑟𝑇
and
𝐶2 =
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑒−𝐷𝑇
which leads to
𝑢(𝑥, 𝑡) = 𝑥𝑒−𝑟(𝑇−𝑡) +
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
) (𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡))
and hence
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑢(𝑥, 𝑡)
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝑆𝑡
)
𝑒−𝑟(𝑇−𝑡)
+
(1 −(𝑟−𝐷)(𝑇−𝜏)
(𝑟−𝐷)(𝑇−𝜏)
) (𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)) 𝑆𝑡.

496
5.2.2 Continuous Sampling
Finally, for the case 𝑟→𝐷and using L’Ĥopital’s rule
lim
𝑟→𝐷𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = lim
𝑟→𝐷
(
1
𝑇−𝜏∫
𝑡
0
𝑆𝑢𝑑𝑢−𝑆𝑡
)
𝑒−𝑟(𝑇−𝑡)
+ lim
𝑟→𝐷
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡
−lim
𝑟→𝐷
(𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)) 𝑆𝑡
=
(
1
𝑇−𝜏∫
𝑡
0
𝑆𝑢𝑑𝑢−𝑆𝑡
)
𝑒−𝐷(𝑇−𝑡) −lim
𝑟→𝐷
𝑟𝑒−𝑟(𝑇−𝑡)
𝑇−𝜏𝑆𝑡
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝑆𝑡
)
𝑒−𝐷(𝑇−𝑡) −𝐷𝑆𝑡
𝑇−𝜏𝑒−𝐷(𝑇−𝑡)
=
[
1
𝑇−𝜏
(
∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐷𝑆𝑡
)
−𝑆𝑡
]
𝑒−𝐷(𝑇−𝑡).
7. Put–Call Parity for Arithmetic Average Options (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥
0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset
price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
We define
𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
to be the asset running sum within the time period [𝜏, 𝑡], 0 ≤𝜏< 𝑡and consider the arith-
metic average option with zero-strike call payoff
Ψ(𝑆𝑇, 𝐼𝑇) =
𝐼𝑇
𝑇−𝜏
where 𝑇is the option expiry time. Using the risk-neutral valuation method find the
arbitrage-free arithmetic average option price at time 𝑡, 𝜏< 𝑡< 𝑇.
Consider the payoffs of arithmetic average rate options
𝐶(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝐾, 0
}
𝑃(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{
𝐾−
𝐼𝑇
𝑇−𝜏, 0
}

5.2.2 Continuous Sampling
497
and arithmetic average strike options
𝐶(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{
𝑆𝑇−
𝐼𝑇
𝑇−𝜏, 0
}
𝑃(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{ 𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
.
Show that the put–call relation for the arithmetic average rate and arithmetic average strike
options are
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇)
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝑟(𝑇−𝑡) +
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡
and
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇)
=
(
𝑆𝑡−
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
((𝑟−𝐷)(𝑇−𝜏) −1
(𝑟−𝐷)(𝑇−𝜏)
) (𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)) 𝑆𝑡
respectively.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
Hence, using the risk-neutral valuation method, the price of the option at time 𝑡< 𝑇
with payoff
Ψ(𝑆𝑇, 𝐼𝑇) =
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢

498
5.2.2 Continuous Sampling
is
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇, 𝐼𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
=
1
𝑇−𝜏𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
∫
𝑡
𝜏
𝑆𝑢𝑑𝑢+ ∫
𝑇
𝑡
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
1
𝑇−𝜏𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
∫
𝑇
𝑡
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
1
𝑇−𝜏𝑒−𝑟(𝑇−𝑡)
∫
𝑇
𝑡
𝔼ℚ[𝑆𝑢|| ℱ𝑡
] 𝑑𝑢.
Using It¯o’s lemma we can easily show that for 𝑢> 𝑡
𝑆𝑢= 𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑢−𝑡)+𝜎𝑊ℚ
𝑢−𝑡,
𝑊ℚ
𝑢−𝑡∼(0, 𝑢−𝑡).
Hence, 𝔼ℚ[𝑆𝑢|| ℱ𝑡
] = 𝑆𝑡𝑒(𝑟−𝐷)(𝑢−𝑡) and the option price becomes
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) =
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
1
𝑇−𝜏𝑒−𝑟(𝑇−𝑡)
∫
𝑇
𝑡
𝑆𝑡𝑒(𝑟−𝐷)(𝑢−𝑡) 𝑑𝑢
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
1
𝑇−𝜏𝑆𝑡𝑒−𝑟(𝑇−𝑡)−(𝑟−𝐷)𝑡
[
𝑒(𝑟−𝐷)𝑢
𝑟−𝐷
]𝑇
𝑡
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡) +
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡.
At expiry time 𝑇, the put–call parity for arithmetic average rate options is
𝐶(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑎)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢−𝐾
if
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢> 𝐾
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢−𝐾
if
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢≤𝐾.

5.2.2 Continuous Sampling
499
By discounting the payoffs back to time 𝑡under the risk-neutral measure ℚ, we have
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢−𝐾
|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
−𝐾𝑒−𝑟(𝑇−𝑡)
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡)
+
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡−𝐾𝑒−𝑟(𝑇−𝑡)
=
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−𝐾
)
𝑒−𝑟(𝑇−𝑡)
+
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡.
In contrast, at expiry time 𝑇the put–call parity for arithmetic average strike options is
𝐶(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) −𝑃(𝑎)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑆𝑇−
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
if 𝑆𝑇>
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
𝑆𝑇−
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
if 𝑆𝑇≤
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢.
By discounting the payoffs back to time 𝑡under the risk-neutral measure ℚ, we have
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑆𝑇−
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[𝑆𝑇|| ℱ𝑡
]
−𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
|||||
ℱ𝑡
]
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −
(
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡)
−
(
𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)
(𝑟−𝐷)(𝑇−𝜏)
)
𝑆𝑡

500
5.2.2 Continuous Sampling
=
(
𝑆𝑡−
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢
)
𝑒−𝑟(𝑇−𝑡)
+
((𝑟−𝐷)(𝑇−𝜏) −1
(𝑟−𝐷)(𝑇−𝜏)
)
× (𝑒−𝐷(𝑇−𝑡) −𝑒−𝑟(𝑇−𝑡)) 𝑆𝑡.
8. Geometric Average Rate (Fixed Strike) Asian Option (PDE Approach). Let {𝑊𝑡: 𝑡≥0}
be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset price
𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
We define
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
to be the geometric sum of an asset from initial time 𝜏≥0 until time 𝑡and consider the
geometric average rate call option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝐾, 0
}
where 𝐾> 0 is the strike price and 𝑇is the option expiry time. Assume that the geometric
average rate call option price at time 𝑡, 𝜏< 𝑡< 𝑇, 𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) satisfies the PDE
𝜕𝐶(𝑔)
𝑎𝑟
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝐶(𝑔)
𝑎𝑟
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶(𝑔)
𝑎𝑟
𝜕𝑆𝑡
+ log 𝑆𝑡
𝜕𝐶(𝑔)
𝑎𝑟
𝜕𝐼𝑡
−𝑟𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑔)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝐾, 0
}
.
By considering the change of variables
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡
𝑇−𝜏

5.2.2 Continuous Sampling
501
show that 𝐻(𝑥, 𝑡) satisfies
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 +
(
𝑟−𝐷−1
2𝜎2) ( 𝑇−𝑡
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥−𝑟𝐻(𝑥, 𝑡) = 0
with boundary condition
𝐻(𝑥, 𝑇) = max{𝑒𝑥−𝐾, 0}.
By setting
̂𝑆𝑡= 𝑒𝑥
show that the PDE can be transformed into
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)2 ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
+
[
𝑟−𝐷−1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)] ( 𝑇−𝑡
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝑟𝐻( ̂𝑆𝑡, 𝑡) = 0
with terminal payoff
𝐻( ̂𝑆𝑇, 𝑇) = max{ ̂𝑆𝑇−𝐾, 0}.
Hence, deduce from the European option price formula that the geometric average rate call
option price at time 𝑡, 𝜏< 𝑡< 𝑇is
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
𝜎2 = 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
and Φ(⋅) is the cdf of a standard normal.
Solution: To obtain the PDEs satisfied by 𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) and 𝐻(𝑥, 𝑡), see Problem
5.2.2.3 (page 483).
By setting ̂𝑆𝑡= 𝑒𝑥we can express
𝜕𝐻
𝜕𝑥= 𝜕𝐻
𝜕𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑥= 𝑒𝑥𝜕𝐻
𝜕̂𝑆𝑡
= ̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡

502
5.2.2 Continuous Sampling
𝜕2𝐻
𝜕𝑥2 = 𝜕̂𝑆𝑡
𝜕𝑥
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑥= 𝑒𝑥𝜕𝐻
𝜕̂𝑆𝑡
+ 𝑒𝑥̂𝑆𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
= ̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
.
By substituting the above results into the PDE satisfied by 𝐻(𝑥, 𝑡) we have
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)2 (
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
)
+
(
𝑟−𝐷−1
2𝜎2) ( 𝑇−𝑡
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝑟𝐻( ̂𝑆𝑡, 𝑡) = 0
or
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)2 ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
+
[
𝑟−𝐷−1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)] ( 𝑇−𝑡
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝑟𝐻( ̂𝑆𝑡, 𝑡) = 0
with payoff
𝐻( ̂𝑆𝑇, 𝑇) = max{ ̂𝑆𝑇−𝐾, 0}
which is a Black–Scholes equation with time-dependent dividend yield
̂𝐷(𝑡) =
[
𝑟+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)] ( 𝑡−𝜏
𝑇−𝜏
)
+ 𝐷
( 𝑇−𝑡
𝑇−𝜏
)
and volatility
̂𝜎(𝑡) = 𝜎
( 𝑇−𝑡
𝑇−𝜏
)
.
Hence, we can deduce that
𝐻( ̂𝑆𝑡, 𝑡) = ̂𝑆𝑡𝑒−∫𝑇
𝑡
̂𝐷(𝑢)𝑑𝑢Φ( ̂𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
where
̂𝑑± =
log( ̂𝑆𝑡∕𝐾) + ∫𝑇
𝑡(𝑟−̂𝐷(𝑢) ± 1
2̂𝜎(𝑢)2) 𝑑𝑢
√
∫𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢

5.2.2 Continuous Sampling
503
with
∫
𝑇
𝑡
̂𝐷(𝑢) 𝑑𝑢= ∫
𝑇
𝑡
{[
𝑟+ 1
2𝜎2 (𝑇−𝑢
𝑇−𝜏
)] ( 𝑢−𝜏
𝑇−𝜏
)
+ 𝐷
(𝑇−𝑢
𝑇−𝜏
)}
𝑑𝑢
= ∫
𝑇
𝑡
{𝑟(𝑢−𝜏)
𝑇−𝜏
+ 1
2𝜎2 (𝑇−𝑢
𝑇−𝜏
) ( 𝑢−𝜏
𝑇−𝜏
)
+ 𝐷
(𝑇−𝑢
𝑇−𝜏
)}
𝑑𝑢
= 𝑟(𝑢−𝜏)2
2(𝑇−𝜏) + 𝜎2
2
((𝑇−𝑢)(𝑢−𝜏)2
2
+ (𝑢−𝜏)3
6
)
−𝐷(𝑇−𝑢)2
2(𝑇−𝜏)
|||||
𝑇
𝑡
= 𝑟(𝑇+ 𝑡−2𝜏)(𝑇−𝑡)
2(𝑇−𝜏)
+𝜎2
12
[(𝑇−𝑡)((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2)
(𝑇−𝜏)2
−2(𝑇−𝑡)(𝑡−𝜏)2
(𝑇−𝜏)2
]
+ 𝐷(𝑇−𝑡)2
2(𝑇−𝜏)
=
[
𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
+𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)]
(𝑇−𝑡)
and
∫
𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢= ∫
𝑇
𝑡
𝜎2 (𝑇−𝑢
𝑇−𝜏
)2
𝑑𝑢
= −𝜎2(𝑇−𝑢)3
3(𝑇−𝜏)2
|||||
𝑇
𝑡
= 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
(𝑇−𝑡).
Thus, we can rewrite 𝐻( ̂𝑆𝑡, 𝑡) as
𝐻( ̂𝑆𝑡, 𝑡) = ̂𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log( ̂𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷=
1
𝑇−𝑡∫
𝑇
𝑡
̂𝐷(𝑢) 𝑑𝑢

504
5.2.2 Continuous Sampling
and
𝜎2 =
1
𝑇−𝑡∫
𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢.
By substituting ̂𝑆𝑡= 𝑒𝑥= 𝑒
𝐼𝑡+(𝑇−𝑡) log 𝑆𝑡
𝑇−𝜏
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
, the geometric average rate call option
price is
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
9. Geometric Average Strike (Floating Strike) Asian Option (PDE Approach). Let {𝑊𝑡: 𝑡≥
0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset
price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
We define
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
to be the geometric sum of an asset in the time period [𝜏, 𝑡], 𝜏≥0 and consider the geo-
metric average strike put option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
where 𝑇is the option expiry time. Assume that the geometric average strike put option
price at time 𝑡, 𝜏< 𝑡< 𝑇, 𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) satisfies the PDE
𝜕𝑃(𝑔)
𝑎𝑠
𝜕𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑃(𝑔)
𝑎𝑠
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑃(𝑔)
𝑎𝑠
𝜕𝑆𝑡
+ log 𝑆𝑡
𝜕𝑃(𝑔)
𝑎𝑠
𝜕𝐼𝑡
−𝑟𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 0

5.2.2 Continuous Sampling
505
with boundary condition
𝑃(𝑔)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
.
By considering the change of variables
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝐻(𝑥, 𝑡),
𝑥= 𝐼𝑡−(𝑡−𝜏) log 𝑆𝑡
𝑇−𝜏
show that 𝐻(𝑥, 𝑡) satisfies
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2 𝜕2𝐻
𝜕𝑥2 −
(
𝑟−𝐷+ 1
2𝜎2) ( 𝑡−𝜏
𝑇−𝜏
) 𝜕𝐻
𝜕𝑥−𝐷𝐻(𝑥, 𝑡) = 0
with boundary condition
𝐻(𝑥, 𝑇) = max{𝑒𝑥−1, 0}.
By setting
̂𝑆𝑡= 𝑒𝑥
show that the PDE can be transformed into
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2 ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
−
[
𝑟−𝐷+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)] ( 𝑡−𝜏
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝐷𝐻( ̂𝑆𝑡, 𝑡) = 0
with terminal payoff
𝐻( ̂𝑆𝑇, 𝑇) = max{ ̂𝑆𝑇−1, 0}.
Hence, deduce from the European option price formula that the geometric average strike
put option price at time 𝑡, 𝜏< 𝑡< 𝑇is
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑−)

506
5.2.2 Continuous Sampling
where
𝑑± =
𝐼𝑡
𝑇−𝜏−𝑡−𝜏
𝑇−𝜏log 𝑆𝑡+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2
(𝑇−𝜏)2
)
and Φ(⋅) is the cdf of a standard normal.
Solution: To obtain the PDEs satisfied by 𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) and 𝐻(𝑥, 𝑡), see Problem 5.2.2.4
(page 485).
By setting ̂𝑆𝑡= 𝑒𝑥we can express
𝜕𝐻
𝜕𝑥= 𝜕𝐻
𝜕𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑥= 𝑒𝑥𝜕𝐻
𝜕̂𝑆𝑡
= ̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
𝜕2𝐻
𝜕𝑥2 = 𝜕̂𝑆𝑡
𝜕𝑥
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑥= 𝑒𝑥𝜕𝐻
𝜕̂𝑆𝑡
+ 𝑒𝑥̂𝑆𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
= ̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
.
By substituting the above results into the PDE satisfied by 𝐻(𝑥, 𝑡) we can write
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2
(
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
+ ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
)
−
(
𝑟−𝐷+ 1
2𝜎2) ( 𝑡−𝜏
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝐷𝐻( ̂𝑆𝑡, 𝑡) = 0
or
𝜕𝐻
𝜕𝑡+ 1
2𝜎2 ( 𝑡−𝜏
𝑇−𝜏
)2 ̂𝑆2
𝑡
𝜕2𝐻
𝜕̂𝑆2
𝑡
−
[
𝑟−𝐷+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
)] ( 𝑡−𝜏
𝑇−𝜏
)
̂𝑆𝑡
𝜕𝐻
𝜕̂𝑆𝑡
−𝐷𝐻( ̂𝑆𝑡, 𝑡) = 0
with payoff
𝐻( ̂𝑆𝑇, 𝑇) = max{ ̂𝑆𝑇−1, 0}
which is a Black–Scholes equation with interest rate 𝐷, time-dependent dividend yield
̂𝐷(𝑡) = 𝑟
( 𝑡−𝜏
𝑇−𝜏
)
+ 𝐷
( 𝑇−𝑡
𝑇−𝜏
)
+ 1
2𝜎2 ( 𝑇−𝑡
𝑇−𝜏
) ( 𝑡−𝜏
𝑇−𝜏
)

5.2.2 Continuous Sampling
507
and volatility
̂𝜎(𝑡) = 𝜎(𝑡−𝜏)
𝑇−𝜏.
Hence, we can deduce that
𝐻( ̂𝑆𝑡, 𝑡) = ̂𝑆𝑡𝑒−∫𝑇
𝑡
̂𝐷(𝑢)𝑑𝑢Φ( ̂𝑑+) −𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑−)
with
̂𝑑± =
log ̂𝑆𝑡+ ∫𝑇
𝑡(𝐷−̂𝐷(𝑢) ± 1
2̂𝜎(𝑢)2) 𝑑𝑢
√
∫𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢
where
∫
𝑇
𝑡
̂𝐷(𝑢) 𝑑𝑢= ∫
𝑇
𝑡
𝑟
( 𝑢−𝜏
𝑇−𝜏
)
+ 𝐷
(𝑇−𝑢
𝑇−𝜏
)
+ 1
2𝜎2 (𝑇−𝑢
𝑇−𝜏
) ( 𝑢−𝜏
𝑇−𝜏
)
𝑑𝑢
= 𝑟(𝑢−𝜏)2
2(𝑇−𝜏) −𝐷(𝑇−𝑢)2
2(𝑇−𝜏) + 𝜎2
2
((𝑇−𝑢)(𝑢−𝜏)2
2
+ (𝑢−𝜏)3
6
)|||||
𝑇
𝑡
= 𝑟(𝑇+ 𝑡−2𝜏)(𝑇−𝑡)
2(𝑇−𝜏)
+ 𝐷(𝑇−𝑡)2
2(𝑇−𝜏)
+𝜎2
12
[(𝑇−𝑡)((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2)
(𝑇−𝜏)2
−2(𝑇−𝑡)(𝑡−𝜏)2
(𝑇−𝜏)2
]
=
[ 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)]
(𝑇−𝑡)
and
∫
𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢= ∫
𝑇
𝑡
𝜎2(𝑢−𝜏)2
(𝑇−𝜏)2 𝑑𝑢
= 𝜎2
3
(𝑢−𝜏)3
(𝑇−𝜏)2
|||||
𝑇
𝑡
= 𝜎2
3
((𝑇−𝜏)3 −(𝑡−𝜏)3
(𝑇−𝜏)2
)
= 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2) (𝑇−𝑡)
(𝑇−𝜏)2
.

508
5.2.2 Continuous Sampling
Hence, we can rewrite 𝐻( ̂𝑆𝑡, 𝑡) as
𝐻( ̂𝑆𝑡, 𝑡) = ̂𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝑒−𝐷(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log( ̂𝑆𝑡∕𝐾) +
(
𝐷−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷=
1
𝑇−𝑡∫
𝑇
𝑡
̂𝐷(𝑢) 𝑑𝑢
and
𝜎2 =
1
𝑇−𝑡∫
𝑇
𝑡
̂𝜎(𝑢)2 𝑑𝑢.
By substituting ̂𝑆𝑡= 𝑒𝑥= 𝑒
𝐼𝑡−𝑡log 𝑆𝑡
𝑇
= 𝑒
𝐼𝑡
𝑇𝑆
−𝑡
𝑇
𝑡
, the geometric average strike put option at
time 𝑡< 𝑇is
𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝐻(𝑥, 𝑡)
= 𝑒
𝐼𝑡
𝑇𝑆
𝑇−𝑡
𝑇
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
𝐼𝑡
𝑇−𝜏−𝑡−𝜏
𝑇−𝜏log 𝑆𝑡+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2
(𝑇−𝜏)2
)
.
10. Geometric Average Rate (Fixed Strike) Asian Option (Probabilistic Approach). Let {𝑊𝑡:
𝑡≥0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the
asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.

5.2.2 Continuous Sampling
509
We define
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
to be the geometric sum of the asset in the time period [𝜏, 𝑡], where 𝜏≥0 and consider the
geometric average rate put option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{
𝐾−𝑒
𝐼𝑇
𝑇−𝜏, 0
}
where 𝐾> 0 is the strike price and 𝑇is the option expiry time.
Show that if 𝑋∼(𝜇𝑥, 𝜎2
𝑥) then for a constant 𝐾> 0
𝔼[max{𝛿(𝑒𝑋−𝐾, 0)}] = 𝛿𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
(
𝛿(𝜇𝑥+ 𝜎2
𝑥−log 𝐾)
𝜎𝑥
)
−𝛿𝐾Φ
(𝛿(𝜇𝑥−log 𝐾)
𝜎𝑥
)
where 𝛿∈{−1, 1} and Φ(⋅) denotes the cdf of a standard normal.
Given that 𝑊𝑢−𝑡∼𝑁(0, 𝑢−𝑡), 𝑢> 𝑡show, using integration by parts, that
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢= ∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊𝑢
and deduce that
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢∼
[
0, (𝑇−𝑡)3
3
]
.
By considering 𝑒
𝐼𝑇
𝑇−𝜏and 𝑒
𝐼𝑡
𝑡−𝜏show under the risk-neutral measure ℚthat
𝐼𝑇
𝑇−𝜏follows
a normal distribution with mean
𝔼ℚ
( 𝐼𝑇
𝑇
||||
ℱ𝑡
)
=
1
𝑇−𝜏
{
∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
}
and variance
Varℚ
(
𝐼𝑇
𝑇−𝜏
||||
ℱ𝑡
)
= 𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2 .
Hence, deduce that under the risk-neutral measure ℚthe geometric average rate put option
at time 𝑡< 𝑇is
𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑒
𝐼𝑡
𝑇𝑆
𝑇−𝑡
𝑇
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)

510
5.2.2 Continuous Sampling
where
𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
.
Solution: For the first part of the results refer to Problem 1.2.2.7 of Problems and Solutions
in Mathematical Finance, Volume 1: Stochastic Calculus.
From the stationary increment property of a standard Wiener process
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢= ∫
𝑇
𝑡
(𝑊𝑢−𝑊𝑡) 𝑑𝑢
= ∫
𝑇
𝑡
𝑊𝑢𝑑𝑢−𝑊𝑡∫
𝑇
𝑡
𝑑𝑢
= ∫
𝑇
𝑡
𝑊𝑢𝑑𝑢−𝑊𝑡(𝑇−𝑡).
Using integration by parts
∫
𝑇
𝑡
𝑊𝑢𝑑𝑢= 𝑢𝑊𝑢||
𝑇
𝑡−∫
𝑇
𝑡
𝑢𝑑𝑊𝑢
= 𝑇𝑊𝑇−𝑡𝑊𝑡−∫
𝑇
𝑡
𝑢𝑑𝑊𝑢
and therefore
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢= 𝑇𝑊𝑇−𝑡𝑊𝑡−∫
𝑇
𝑡
𝑢𝑑𝑊𝑢−𝑊𝑡(𝑇−𝑡)
= 𝑇𝑊𝑇−𝑡−∫
𝑇
𝑡
𝑢𝑑𝑊𝑢
= ∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊𝑢.
Using the properties of the standard Wiener process we have
𝔼
[
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
]
= 𝔼
[
∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊𝑢
]
= 0

5.2.2 Continuous Sampling
511
and
𝔼
[(
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)2]
= 𝔼
[
∫
𝑇
𝑡
(𝑇−𝑢)2 𝑑𝑢
]
= −(𝑇−𝑢)3
3
|||||
𝑇
𝑡
= (𝑇−𝑡)3
3
.
Since we can write
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢= ∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊𝑢= lim
𝑛→∞
𝑛−1
∑
𝑖=0
(𝑇−𝑡𝑖)(𝑊𝑡𝑖+1 −𝑊𝑡𝑖)
where 𝑡𝑖= 𝑡+ 𝑖(𝑇−𝑡)∕𝑛, we can see that each term of 𝑊𝑡𝑖+1 −𝑊𝑡𝑖is multiplied by a
deterministic term. Thus, the product is normal and given that the sum of normal variables
is also normal, we can deduce that ∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢∼
[
0, (𝑇−𝑡)3
3
]
.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It¯o’s lemma
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
−1
2𝜎2𝑑𝑡
=
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
and taking integrals for 𝑡< 𝑢< 𝑇we have
∫
𝑢
𝑡
𝑑log 𝑆𝑡= ∫
𝑢
𝑡
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎∫
𝑢
𝑡
𝑑𝑊ℚ
𝑡
or
log 𝑆𝑢= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡.
For 𝑡< 𝑇, let 𝐺𝑡= 𝑒
1
𝑡−𝜏∫𝑡
𝜏log 𝑆𝑢𝑑𝑢= 𝑒
𝐼𝑡
𝑡−𝜏and 𝐺𝑇= 𝑒
1
𝑇−𝜏∫𝑇
𝜏log 𝑆𝑢𝑑𝑢= 𝑒
𝐼𝑇
𝑇−𝜏so that
(𝑡−𝜏) log 𝐺𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢

512
5.2.2 Continuous Sampling
and
(𝑇−𝜏) log 𝐺𝑇= ∫
𝑇
𝜏
log 𝑆𝑢𝑑𝑢.
By subtraction
(𝑇−𝜏) log 𝐺𝑇−(𝑡−𝜏) log 𝐺𝑡= ∫
𝑇
𝜏
log 𝑆𝑢𝑑𝑢−∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
= ∫
𝑇
𝑡
log 𝑆𝑢𝑑𝑢
and substituting log 𝑆𝑢= log 𝑆𝑡+ (𝑟−𝐷−1
2𝜎2)(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡we have
(𝑇−𝜏) log 𝐺𝑇−(𝑡−𝜏) log 𝐺𝑡= ∫
𝑇
𝑡
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡
]
𝑑𝑢
= (𝑇−𝑡) log 𝑆𝑡+ ∫
𝑇
𝑡
(𝑟−𝐷−1
2𝜎2)(𝑢−𝑡) 𝑑𝑢
+𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢
= (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
+𝜎∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊ℚ
𝑢−𝑡.
Since log 𝐺𝑇=
𝐼𝑇
𝑇−𝜏and log 𝐺𝑡=
𝐼𝑡
𝑡−𝜏, therefore
𝐼𝑇= 𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2 + 𝜎∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊ℚ
𝑢−𝑡
or
𝐼𝑇
𝑇−𝜏=
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
+𝜎∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊ℚ
𝑢−𝑡
}
.

5.2.2 Continuous Sampling
513
Since ∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊ℚ
𝑢−𝑡is normally distributed, then conditional on the filtration ℱ𝑡
𝐼𝑇
𝑇−𝜏
||||
ℱ𝑡∼
[
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2}
,
𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
]
.
Using the identity
𝔼[max{𝐾−𝑒𝑋, 0}] = 𝐾Φ
(
−(𝜇𝑥−log 𝐾)
𝜎𝑥
)
−𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
(
−
(𝜇𝑥+ 𝜎2
𝑥−log 𝐾)
𝜎𝑥
)
for 𝑋∼(𝜇𝑥, 𝜎2
𝑥) and 𝛿= −1, under the risk-neutral measure ℚthe geometric average
rate put option price at time 𝑡is
𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−𝑒
𝐼𝑇
𝑇−𝜏, 0
}|||||
ℱ𝑡
]
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡)Φ(−𝑑+)
where
𝑚=
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2}
𝑠2 = 𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
𝑑+ = 𝑚+ 𝑠2 −log 𝐾
𝑠
𝑑−= 𝑑+ −𝑠.
Hence,
𝑒𝑚+ 1
2 𝑠2−𝑟(𝑇−𝑡) = 𝑒
1
𝑇−𝜏
{
𝐼𝑡+(𝑇−𝑡) log 𝑆𝑡+ 1
2 (𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)2}
+ 𝜎2
6
(𝑇−𝑡)3
(𝑇−𝜏)2 −𝑟(𝑇−𝑡)
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)
where 𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
.

514
5.2.2 Continuous Sampling
In contrast,
𝑑+ = 𝑚+ 𝑠2 −log 𝐾
𝑠
=
⎡
⎢
⎢
⎢
⎢⎣
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2}
+𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2 −log 𝐾
⎤
⎥
⎥
⎥
⎥⎦
√
𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
=
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷+ 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
𝑑−= 𝑑+ −𝑠
= 𝑑+ −𝜎
√
𝑇−𝑡
=
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
where 𝜎2 = 𝜎2
3
( 𝑇−𝑡
𝑇−𝜏
)2
.
Hence,
𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑒
𝐼𝑡
𝑇𝑆
𝑇−𝑡
𝑇
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
where 𝑑± =
𝐼𝑡
𝑇−𝜏+
( 𝑇−𝑡
𝑇−𝜏
)
log 𝑆𝑡−log 𝐾+
(
𝑟−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
11. Geometric Average Strike (Floating Strike) Asian Option (Probabilistic Approach). Let
{𝑊𝑡: 𝑡≥0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let
the asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.

5.2.2 Continuous Sampling
515
We define
𝐼𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
to be the geometric sum of the asset in the time period [𝜏, 𝑡], where 𝜏≥0 and consider the
geometric average strike call option with payoff
Ψ(𝑆𝑇, 𝐼𝑇) = max
{
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏, 0
}
where 𝑇is the option expiry time.
Show that if 𝑋∼(𝜇𝑥, 𝜎2
𝑥) and 𝑌∼(𝜇𝑦, 𝜎2
𝑦) have a joint bivariate normal distribu-
tion with correlation coefficient 𝜌𝑥𝑦∈(−1, 1), then
𝔼[max{𝑒𝑋−𝑒𝑌, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑥−𝜇𝑦+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝑒𝜇𝑦+ 1
2 𝜎2
𝑦Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
where Φ(⋅) is the cdf of a standard normal.
Show that the pair of random variables
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
has the covariance matrix
𝚺=
⎡
⎢
⎢
⎢⎣
𝑇−𝑡
1
2(𝑇−𝑡)2
1
2(𝑇−𝑡)2
1
3(𝑇−𝑡)3
⎤
⎥
⎥
⎥⎦
with correlation coefficient
√
3
2
and
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
follows a bivariate normal dis-
tribution.
Using It¯o’s formula show that under the risk-neutral measure, for 𝑡< 𝑇
log 𝑆𝑇= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) + 𝜎𝑊ℚ
𝑇−𝑡
log
( 𝐼𝑇
𝑇−𝜏
)
=
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
+𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢
}
where 𝑊ℚ
𝑡
is a ℚ-standard Wiener process.

516
5.2.2 Continuous Sampling
Finally, deduce that under the risk-neutral measure ℚthe geometric average strike call
option at time 𝑡, 𝜏< 𝑡< 𝑇is
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑−) −𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
where
𝑑± =
𝐼𝑡
𝑇−𝜏−
𝑡
𝑇−𝜏log 𝑆𝑡+
(
𝐷−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2
(𝑇−𝜏)2
)
.
Solution: For the first part of the results see Problem 1.2.2.17 in Problems and Solutions
in Mathematical Finance, Volume 1: Stochastic Calculus.
By definition, the covariance matrix for the pair of random variables (𝑊𝑇−𝑡,
∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢) is
𝚺=
⎡
⎢
⎢
⎢⎣
Var(𝑊𝑇−𝑡)
Cov
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
Cov
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
Var
(
∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
⎤
⎥
⎥
⎥⎦
.
Given that 𝑊𝑇−𝑡∼(0, 𝑇−𝑡) and from Problem 5.2.2.10 (page 508), we have
Var(𝑊𝑇−𝑡) = 𝑇−𝑡
and
Var
(
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
= Var
(
∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑊𝑢
)
= 𝔼
(
∫
𝑇
𝑡
(𝑇−𝑢)2 𝑑𝑢
)
−𝔼
(
∫
𝑇
𝑡
(𝑇−𝑢) 𝑑𝑢
)2
= 1
3(𝑇−𝑡)3.

5.2.2 Continuous Sampling
517
For the case Cov
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
we can write
Cov
(
𝑊𝑇−𝑡, ∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
= 𝔼
(
𝑊𝑇−𝑡∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
−𝔼(𝑊𝑇−𝑡)𝔼
(
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
= 𝔼
(
𝑊𝑇−𝑡∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
= 𝔼
(
∫
𝑇
𝑡
𝑊𝑇−𝑡𝑊𝑢−𝑡𝑑𝑢
)
= ∫
𝑇
𝑡
𝔼
(
𝑊𝑇−𝑡𝑊𝑢−𝑡
)
𝑑𝑢
= ∫
𝑇
𝑡
𝔼[𝑊𝑢−𝑡(𝑊𝑇−𝑡−𝑊𝑢−𝑡) + 𝑊2
𝑢−𝑡
] 𝑑𝑢.
From the independent increment property of a standard Wiener process we have
Cov
(
𝑊𝑇−𝑡, ∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢
)
= ∫
𝑇
𝑡
𝔼(𝑊𝑢−𝑡)𝔼(𝑊𝑇−𝑡−𝑊𝑢−𝑡) 𝑑𝑢
+ ∫
𝑇
𝑡
𝔼(𝑊2
𝑢−𝑡) 𝑑𝑠
= ∫
𝑇
𝑡
𝔼(𝑊2
𝑢−𝑡) 𝑑𝑠
= ∫
𝑇
𝑡
(𝑢−𝑡) 𝑑𝑢
= 1
2(𝑇−𝑡)2.
Therefore, the covariance matrix is
𝚺=
⎡
⎢
⎢
⎢⎣
𝑇−𝑡
1
2(𝑇−𝑡)2
1
2(𝑇−𝑡)2
1
3(𝑇−𝑡)3
⎤
⎥
⎥
⎥⎦
with correlation coefficient
𝜌=
Cov
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
√
Var(𝑊𝑇−𝑡)Var
(
∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
) =
1
2(𝑇−𝑡)2
√
1
3(𝑇−𝑡)4
=
√
3
2 .

518
5.2.2 Continuous Sampling
By expressing
𝑊𝑇−𝑡=
√
𝑇−𝑡𝑍1
∫
𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢=
√
(𝑇−𝑡)3
3
(
𝜌𝑍1 +
√
1 −𝜌2𝑍2
)
where 𝑍1, 𝑍2 ∼(0, 1) and 𝑍1 ⟂⟂𝑍2, for constants 𝜃1 and 𝜃2
𝔼
(
𝑒𝜃𝑊𝑇−𝑡+𝜃2 ∫𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢)
= 𝔼
[
𝑒𝜃1
√
𝑇−𝑡𝑍1+𝜃2
√
(𝑇−𝑡)3∕3(𝜌𝑍1+
√
1−𝜌2𝑍2)]
= 𝔼
[
𝑒(𝜃1
√
𝑇−𝑡+𝜌𝜃2
√
(𝑇−𝑡)3∕3)𝑍1+𝜃2
√
(𝑇−𝑡)3(1−𝜌2)∕3𝑍2
]
= 𝔼
[
𝑒(𝜃1
√
𝑇−𝑡+𝜌𝜃2
√
(𝑇−𝑡)3∕3)𝑍1
]
⋅𝔼
[
𝑒𝜃2
√
(𝑇−𝑡)3(1−𝜌2)∕3𝑍2
]
= 𝑒
1
2 (𝜃1
√
𝑇−𝑡+𝜌𝜃2
√
(𝑇−𝑡)3∕3)2 ⋅𝑒
1
2 𝜃2
2(𝑇−𝑡)3(1−𝜌2)∕3.
By substituting 𝜌=
√
3
2
and setting 𝜽= (𝜃1, 𝜃2)𝑇we therefore have
𝔼
(
𝑒𝜃𝑊𝑇−𝑡+𝜃2 ∫𝑇
𝑡
𝑊𝑢−𝑡𝑑𝑢)
= 𝑒
1
2 𝜃2
1(𝑇−𝑡)+ 1
2 𝜃1𝜃2(𝑇−𝑡)2+ 1
2 𝜃2
2
(𝑇−𝑡)3
3
= 𝑒
1
2𝜽𝑇𝚺𝜽
which is the moment-generating function of a bivariate normal distribution. Hence,
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
follows a bivariate normal distribution.
From Girsanov’s theorem, under the risk-neutral measure
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s formula
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
−1
2𝜎2𝑑𝑡
=
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
and taking integrals for 𝑡< 𝑢< 𝑇we have
∫
𝑢
𝑡
𝑑log 𝑆𝑡= ∫
𝑢
𝑡
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝜎∫
𝑢
𝑡
𝑑𝑊ℚ
𝑡

5.2.2 Continuous Sampling
519
or
log 𝑆𝑢= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡.
For 𝑡< 𝑇, let 𝐺𝑡= 𝑒
1
𝑡−𝜏∫𝑡
𝜏log 𝑆𝑢𝑑𝑢= 𝑒
𝐼𝑡
𝑡−𝜏and 𝐺𝑇= 𝑒
1
𝑇−𝜏∫𝑇
𝜏log 𝑆𝑢𝑑𝑢= 𝑒
𝐼𝑇
𝑇−𝜏so that
(𝑡−𝜏) log 𝐺𝑡= ∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢
and
(𝑇−𝜏) log 𝐺𝑇= ∫
𝑇
𝜏
log 𝑆𝑢𝑑𝑢.
By subtraction
(𝑇−𝜏) log 𝐺𝑇−(𝑡−𝜏) log 𝐺𝑡= ∫
𝑇
𝜏
log 𝑆𝑢𝑑𝑢−∫
𝑡
𝜏
log 𝑆𝑢𝑑𝑢= ∫
𝑇
𝑡
log 𝑆𝑢𝑑𝑢
and substituting log 𝑆𝑢= log 𝑆𝑡+ (𝑟−𝐷−1
2𝜎2)(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡we have
(𝑇−𝜏) log 𝐺𝑇−(𝑡−𝜏) log 𝐺𝑡= ∫
𝑇
𝑡
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡
]
𝑑𝑢
= (𝑇−𝑡) log 𝑆𝑡+ ∫
𝑇
𝑡
(𝑟−𝐷−1
2𝜎2)(𝑢−𝑡) 𝑑𝑢
+𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢
= (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
+𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢.
Since log 𝐺𝑇=
𝐼𝑇
𝑇−𝜏and log 𝐺𝑡=
𝐼𝑡
𝑡−𝜏, therefore
𝐼𝑇= 𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2 + 𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢
or
𝐼𝑇
𝑇−𝜏=
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2
+𝜎∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢
}
.

520
5.2.2 Continuous Sampling
Since 𝑊ℚ
𝑇−𝑡∼(0, 𝑇−𝑡) and ∫
𝑇
𝑡
𝑊ℚ
𝑢−𝑡𝑑𝑢∼
[
0, 1
3(𝑇−𝑡)3]
, conditional on the fil-
tration ℱ𝑡
log 𝑆𝑇|| ℱ𝑡∼
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
and
𝐼𝑇
𝑇−𝜏
||||
ℱ𝑡∼
[
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2}
,
𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
]
.
In addition, since
(
𝑊𝑇−𝑡, ∫𝑇
𝑡𝑊𝑢−𝑡𝑑𝑢
)
follows a bivariate normal we can also deduce that
(
log 𝑆𝑇,
𝐼𝑇
𝑇−𝜏
)
also follows a bivariate normal distribution.
From the identity we have
𝔼[max{𝑒𝑋−𝑒𝑌, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑥−𝜇𝑦+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝑒𝜇𝑦+ 1
2 𝜎2
𝑦Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
for a bivariate normal distribution such that 𝑋∼(𝜇𝑥, 𝜎2
𝑥) and 𝑌∼(𝜇𝑦, 𝜎2
𝑦) with cor-
relation coefficient 𝜌𝑥𝑦∈(−1, 1). By setting
𝑋= log 𝑆𝑇,
𝜇𝑥= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡),
𝜎2
𝑥= 𝜎2(𝑇−𝑡)
𝑌=
𝐼𝑇
𝑇−𝜏,
𝜇𝑦=
1
𝑇−𝜏
[
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2]
𝜎2
𝑦= 𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
and
𝜌𝑥𝑦=
√
3
2

5.2.2 Continuous Sampling
521
we have
𝑒𝜇𝑥+ 1
2 𝜎2
𝑥= 𝑒(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)+ 1
2 𝜎2(𝑇−𝑡)
= 𝑒(𝑟−𝐷)(𝑇−𝑡)
𝑒𝜇𝑦+ 1
2 𝜎2
𝑦= 𝑒
1
𝑇−𝜏[𝐼𝑡+(𝑇−𝑡) log 𝑆𝑡+ 1
2 (𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)2]+ 𝜎2
6
(𝑇−𝑡)3
(𝑇−𝜏)2
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒
𝑟−𝐷
2
(𝑇−𝑡)2
𝑇−𝜏−𝜎2
12
( 𝑇+2𝑡−3𝜏
𝑇−𝜏
) (𝑇−𝑡)2
𝑇−𝜏
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒(𝑟−𝐷)(𝑇−𝑡)
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦= 𝜎2(𝑇−𝑡) −𝜎2(𝑇−𝑡)2
𝑇−𝜏
+ 𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
= 𝜎2
3
[
3 −3(𝑇−𝑡)
𝑇−𝜏+ (𝑇−𝑡)2
(𝑇−𝜏)2
]
(𝑇−𝑡)
= 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2
(𝑇−𝜏)2
)
(𝑇−𝑡)
= 𝜎2(𝑇−𝑡)
where
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
𝜎2 = 𝜎2
3
((𝑇−𝜏)2 + (𝑡−𝜏)(𝑇−𝜏) + (𝑡−𝜏)2
(𝑇−𝜏)2
)
.
In addition,
𝜇𝑥−𝜇𝑦+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦) = 𝜇𝑥−𝜇𝑦+ 1
2(𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦) + 1
2𝜎2
𝑥−1
2𝜎2
𝑦
= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
−
1
𝑇−𝜏
[
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2]
+1
2𝜎2(𝑇−𝑡) + 1
2𝜎2(𝑇−𝑡) −𝜎2
6
(𝑇−𝑡)2
(𝑇−𝜏)2
= −
𝐼𝑡
𝑇−𝜏+ 𝑡−𝜏
𝑇−𝜏log 𝑆𝑡
+
[
𝑟−𝐷
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
+1
2𝜎2]
(𝑇−𝑡)
= −
𝐼𝑡
𝑇−𝜏+ 𝑡−𝜏
𝑇−𝜏log 𝑆𝑡−
(
𝐷−𝐷−1
2𝜎2)
(𝑇−𝑡)

522
5.2.2 Continuous Sampling
and
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥) = 𝜇𝑥−𝜇𝑦−1
2(𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦) + 1
2𝜎2
𝑥−1
2𝜎2
𝑦
= log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
−
1
𝑇−𝜏
[
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2]
−1
2𝜎2(𝑇−𝑡) + 1
2𝜎2(𝑇−𝑡) −𝜎2
6
(𝑇−𝑡)2
(𝑇−𝜏)2
= −
𝐼𝑡
𝑇−𝜏+ 𝑡−𝜏
𝑇−𝜏log 𝑆𝑡
+
[
𝑟−𝐷
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
−1
2𝜎2]
(𝑇−𝑡)
= −
𝐼𝑡
𝑇−𝜏+ 𝑡−𝜏
𝑇−𝜏log 𝑆𝑡−
(
𝐷−𝐷+ 1
2𝜎2)
(𝑇−𝑡).
Hence, under the risk-neutral measure ℚ, the geometric average strike call option price at
time 𝑡is
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏, 0
}|||||
ℱ𝑡
]
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑−) −𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
where 𝑑± =
𝐼𝑡
𝑇−𝜏−
( 𝑡−𝜏
𝑇−𝜏
)
log 𝑆𝑡+
(
𝐷−𝐷± 1
2𝜎2)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
N.B. The same result can also be obtained if we use the exchange option formula (see
Problem 6.2.1.6, page 543).
12. Put–Call Parity for Geometric Average Options (Probabilistic Approach). Let {𝑊𝑡: 𝑡≥
0} be the ℙ-standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset
price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
We define
𝐼𝑡= ∫
𝑡
𝜏
𝑆𝑢𝑑𝑢

5.2.2 Continuous Sampling
523
to be the asset running sum within the time period [𝜏, 𝑡], 𝜏≥0 and consider the geometric
average rate option with zero-strike call payoff
Ψ(𝑆𝑇, 𝐼𝑇) = 𝑒
𝐼𝑇
𝑇−𝜏
where 𝑇is the option expiry time. Using the risk-neutral valuation method find the
arbitrage-free geometric average option price at time 𝑡, 𝜏< 𝑡< 𝑇.
Consider the payoffs of geometric average rate options
𝐶(𝑔)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝐾, 0
}
𝑃(𝑔)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) = max
{
𝐾−𝑒
𝐼𝑇
𝑇−𝜏, 0
}
and geometric average strike options
𝐶(𝑔)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏, 0
}
𝑃(𝑔)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) = max
{
𝑒
𝐼𝑇
𝑇−𝜏−𝑆𝑇, 0
}
.
Show that the put–call relation for the geometric average rate and geometric average strike
options are
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
and
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)
respectively where
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.

524
5.2.2 Continuous Sampling
From Problem 5.2.2.11 (page 514), under the ℚmeasure
𝐼𝑇
𝑇−𝜏
||||
ℱ𝑡∼
[
1
𝑇−𝜏
{
𝐼𝑡+ (𝑇−𝑡) log 𝑆𝑡+ 1
2
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)2}
,
𝜎2
3
(𝑇−𝑡)3
(𝑇−𝜏)2
]
.
Hence, the price of the option at time 𝑡, 𝜏< 𝑡< 𝑇with payoff Ψ(𝑆𝑇, 𝐼𝑇) = 𝑒
𝐼𝑇
𝑇−𝜏is
𝑉(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇, 𝐼𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑒
𝐼𝑇
𝑇−𝜏||||
ℱ𝑡
]
= 𝑒
1
𝑇−𝜏
{
𝐼𝑡+(𝑇−𝑡) log 𝑆𝑡+ 1
2 (𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)2}
+ 𝜎2
6
(𝑇−𝑡)3
(𝑇−𝜏)2 −𝑟(𝑇−𝑡)
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡)
where
𝐷= 𝑟
2
(𝑇+ 𝑡−2𝜏
𝑇−𝜏
)
+ 𝐷
2
( 𝑇−𝑡
𝑇−𝜏
)
+ 𝜎2
12
( 𝑇−𝑡
𝑇−𝜏
) (𝑇+ 2𝑡−3𝜏
𝑇−𝜏
)
.
At option expiry time 𝑇, the put–call parity for the geometric average rate option is
𝐶(𝑔)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) −𝑃(𝑔)
𝑎𝑟(𝑆𝑇, 𝐼𝑇, 𝑇; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑒
𝐼𝑇
𝑇−𝜏−𝐾
if 𝑒
𝐼𝑇
𝐾> 𝐾
𝑒
𝐼𝑇
𝑇−𝜏−𝐾
if 𝑒
𝐼𝑇
𝐾≤𝐾
= 𝑒
𝐼𝑇
𝑇−𝜏−𝐾.
By discounting the payoff back to time 𝑡, under the risk-neutral measure ℚwe have
𝐶(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) −𝑃(𝑔)
𝑎𝑟(𝑆𝑡, 𝐼𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑒
𝐼𝑇
𝑇−𝜏−𝐾||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑒
𝐼𝑇
𝑇−𝜏||||
ℱ𝑡
]
−𝐾𝑒−𝑟(𝑇−𝑡)
= 𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡).

5.2.2 Continuous Sampling
525
In contrast, at expiry time 𝑇the put–call parity for geometric average strike options is
𝐶(𝑔)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) −𝑃(𝑔)
𝑎𝑠(𝑆𝑇, 𝐼𝑇, 𝑇; 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏
if 𝑆𝑇> 𝑒
𝐼𝑇
𝑇−𝜏
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏
if 𝑆𝑇≤𝑒
𝐼𝑇
𝑇−𝜏
= 𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏.
By discounting the payoffs back to time 𝑡< 𝑇under the risk-neutral measure ℚ, and taking
note that log 𝑆𝑇|| ℱ𝑡∼
[
log 𝑆𝑡+
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
, we have
𝐶(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) −𝑃(𝑔)
𝑎𝑠(𝑆𝑡, 𝐼𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑆𝑇−𝑒
𝐼𝑇
𝑇−𝜏||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[𝑆𝑇|| ℱ𝑡
] −𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑒
𝐼𝑇
𝑇−𝜏||||
ℱ𝑡
]
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝑒
𝐼𝑡
𝑇−𝜏𝑆
𝑇−𝑡
𝑇−𝜏
𝑡
𝑒−𝐷(𝑇−𝑡).
13. Symmetry of Average Strike (Floating) and Average Rate (Fixed) Strike in Arithmetic Aver-
age Options. Let {𝑊𝑡: 𝑡≥0} be the ℙ-standard Wiener process on the probability space
(Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from the money-market account.
Under the risk-neutral measure ℚ, we consider the arithmetic average option prices at
time 𝑡< 𝑇
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝑟, 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴(𝑡, 𝑇) −𝐾, 0}| ℱ𝑡
]
𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝑟, 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝐾−𝐴(𝑡, 𝑇), 0}| ℱ𝑡
]
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝜆𝑆𝑇−𝐴(𝑡, 𝑇), 0}|| ℱ𝑡
]
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐴(𝑡, 𝑇) −𝜆𝑆𝑇, 0}|| ℱ𝑡
]
where 𝜆> 0 is a scaling factor, 𝑇is the option expiry and arithmetic average 𝐴(𝑡, 𝑇) is
defined as
𝐴(𝑡, 𝑇) =
1
𝑇−𝑡∫
𝑇
𝑡
𝑆𝑢𝑑𝑢.

526
5.2.2 Continuous Sampling
Show that the following symmetry results
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝐷, 𝜆𝑆𝑡, 𝑇)
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝑟, 𝐾, 𝑇) = 𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝐷, 𝐾∕𝑆𝑡, 𝑇)
hold.
Do the above results hold if the arithmetic average takes the form
𝐴(𝜏, 𝑇) =
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
where 𝜏< 𝑡< 𝑇?
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡takes the form
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+ 𝜇−𝑟
𝜎
𝑡is a ℚ-standard Wiener process.
For a payoff Ψ(𝑆𝑇), under the change of num´eraire
𝑁(1)
𝑡𝔼ℚ(1)
[
Ψ(𝑆𝑇)
𝑁(1)
𝑇
||||||
ℱ𝑡
]
= 𝑁(2)
𝑡𝔼ℚ(2)
[
Ψ(𝑆𝑇)
𝑁(2)
𝑇
||||||
ℱ𝑡
]
where 𝑁(1) and 𝑁(2) are num´eraires (positive non-dividend-paying assets) and ℚ(1) and
ℚ(2) are the measures under which the asset prices discounted by 𝑁(1) and 𝑁(2) are ℚ(1)
and ℚ(2)-martingales, respectively.
For the first result we have
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝜆𝑆𝑇−𝐴(𝑡, 𝑇), 0}|| ℱ𝑡
] .
Under the risk-neutral measure ℚ, we set
𝑁(1)
𝑡
= 𝑒𝑟𝑡
and
𝑁(1)
𝑇
= 𝑒𝑟𝑇
and under the ℚ𝑆measure where 𝑆𝑡𝑒𝐷𝑡is a non-dividend-paying asset we have
𝑁(2)
𝑡
= 𝑆𝑡𝑒𝐷𝑡
and
𝑁(2)
𝑇
= 𝑆𝑇𝑒𝐷𝑇.

5.2.2 Continuous Sampling
527
Hence, using a change of num´eraire
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝜆𝑆𝑇−𝐴(𝑡, 𝑇), 0}|| ℱ𝑡
]
= 𝑒𝑟𝑡𝔼ℚ
[ max{𝜆𝑆𝑇−𝐴(𝑡, 𝑇), 0}
𝑒𝑟𝑇
||||
ℱ𝑡
]
= 𝑆𝑡𝑒𝐷𝑡𝔼ℚ𝑆
[
max{𝜆𝑆𝑇−𝐴(𝑡, 𝑇), 0}
𝑆𝑇𝑒𝐷𝑇
|||||
ℱ𝑡
]
= 𝑒−𝐷(𝑇−𝑡)𝔼ℚ𝑆
[
max
{
𝜆𝑆𝑡−𝑆𝑡𝐴(𝑡, 𝑇)
𝑆𝑇
, 0
}|||||
ℱ𝑡
]
= 𝑒−𝐷(𝑇−𝑡)𝔼ℚ𝑆
[
max {𝜆𝑆𝑡−𝐴∗(𝑡, 𝑇), 0}||| ℱ𝑡
]
where 𝐴∗(𝑡, 𝑇) = 𝑆𝑡𝐴(𝑡, 𝑇)
𝑆𝑇
.
Under the ℚ𝑆measure, the discounted money-market account
𝑋𝑡= (𝑆𝑡𝑒𝐷𝑡)−1 𝑒𝑟𝑡
= 𝑆−1
𝑡𝑒(𝑟−𝐷)𝑡
is a ℚ𝑆-martingale.
From It¯o’s lemma,
𝑑𝑋𝑡= 𝑑
(
𝑆−1
𝑡𝑒(𝑟−𝐷)𝑡)
= (𝑟−𝐷)𝑒(𝑟−𝐷)𝑡𝑆−1
𝑡𝑑𝑡+ 𝑆−1
𝑡𝑒(𝑟−𝐷)𝑡𝑑(𝑆−1
𝑡)
= (𝑟−𝐷)𝑋𝑡𝑑𝑡+ 𝑋𝑡
(
−𝑑𝑆𝑡
𝑆𝑡
+
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
)
= (𝑟−𝐷)𝑋𝑡𝑑𝑡+ 𝑋𝑡
(−(𝑟−𝐷)𝑑𝑡−𝜎𝑑𝑊ℚ
𝑡
+ 𝜎2𝑑𝑡)
= 𝜎2𝑋𝑡𝑑𝑡−𝜎𝑋𝑡𝑑𝑊ℚ
𝑡
= −𝜎𝑋𝑡𝑑𝑊𝑆
𝑡
where 𝑊𝑆
𝑡
= 𝑊ℚ
𝑡
−𝜎𝑡is a ℚ𝑆-standard Wiener process.
Thus, under ℚ𝑆
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎( 𝑑𝑊𝑆
𝑡
+ 𝜎𝑑𝑡)
= (𝑟−𝐷+ 𝜎2)𝑑𝑡+ 𝜎𝑑𝑊𝑆
𝑡.

528
5.2.2 Continuous Sampling
To find the solution of the SDE, we first expand 𝑑log 𝑆𝑡using Taylor’s theorem and by
applying It¯o’s lemma
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷+ 𝜎2)𝑑𝑡+ 𝜎𝑑𝑊𝑆
𝑡
−1
2𝜎2𝑑𝑡
=
(
𝑟−𝐷+ 1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊𝑆
𝑡.
Taking integrals,
∫
𝑇
𝑢
𝑑log 𝑆𝑡= ∫
𝑇
𝑢
(
𝑟−𝐷+ 1
2𝜎2)
𝑑𝑡+ ∫
𝑇
𝑢
𝜎𝑑𝑊𝑆
𝑡
log
(𝑆𝑇
𝑆𝑢
)
=
(
𝑟−𝐷+ 1
2𝜎2)
(𝑇−𝑢) + 𝜎𝑊𝑆
𝑇−𝑢
or
𝑆𝑇= 𝑆𝑢𝑒(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑢)+𝜎𝑊𝑆
𝑇−𝑢.
By substituting 𝑆𝑇into 𝐴∗(𝑡, 𝑇),
𝐴∗(𝑡, 𝑇) =
𝑆𝑡
𝑇−𝑡∫
𝑇
𝑡
𝑆𝑢
𝑆𝑇
𝑑𝑢
=
𝑆𝑡
𝑇−𝑡∫
𝑇
𝑡
𝑒−(𝑟−𝐷+ 1
2 𝜎2)(𝑇−𝑢)−𝜎𝑊𝑆
𝑇−𝑢𝑑𝑢
=
1
𝑇−𝑡∫
𝑇
𝑡
𝑆𝑡𝑒(𝐷−𝑟−1
2 𝜎2)(𝑇−𝑢)−𝜎𝑊𝑆
𝑇−𝑢𝑑𝑢
=
1
𝑇−𝑡∫
𝑇
𝑡
𝑆𝑡𝑒(𝐷−𝑟−1
2 𝜎2)(𝑇−𝑢)+𝜎̃
𝑊𝑆
𝑇−𝑢𝑑𝑢
since the reflected standard Wiener process ̃
𝑊𝑆
𝑡
= −𝑊𝑆
𝑡
is also a ℚ𝑆-standard Wiener
process.
Given that 𝐴∗(𝑡, 𝑇) is an arithmetic average of the price process of lognormal variates
with drift 𝐷−𝑟, therefore
𝐶(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝑒−𝐷(𝑇−𝑡)𝔼ℚ𝑆[max{𝜆𝑆𝑡−𝐴∗(𝑡, 𝑇), 0}|| ℱ𝑡
]
= 𝑃(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝐷, 𝜆𝑆𝑡, 𝑇).
For the second result, we note that using the same steps we can also show
𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝑟, 𝜆, 𝑇) = 𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝐷, 𝜆𝑆𝑡, 𝑇).

5.2.2 Continuous Sampling
529
By substituting 𝐷with 𝑟and 𝜆𝑆𝑡with 𝐾so that 𝜆= 𝐾∕𝑆𝑡, we can deduce
𝐶(𝑎)
𝑎𝑟(𝑆𝑡, 𝑡; 𝑟, 𝐾, 𝑇) = 𝑃(𝑎)
𝑎𝑠(𝑆𝑡, 𝑡; 𝐷, 𝐾∕𝑆𝑡, 𝑇).
Note that the symmetry results do not hold if the arithmetic average takes the form
𝐴(𝜏, 𝑇) =
1
𝑇−𝜏∫
𝑇
𝜏
𝑆𝑢𝑑𝑢
where 𝜏< 𝑡< 𝑇. For example, for an average strike (floating strike) call option payoff
max{𝜆𝑆𝑇−𝐴(𝜏, 𝑇), 0} = max
{
𝜆𝑆𝑇−
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢𝑑𝑢−
1
𝑇−𝜏∫
𝑇
𝑡
𝑆𝑢𝑑𝑢, 0
}
and when we divide it by 𝑆𝑇, the known term
1
𝑇−𝜏∫
𝑡
𝜏
𝑆𝑢
𝑆𝑇
𝑑𝑢will no longer be a constant
value.


6
Exotic Options
In the last two chapters we came across barrier and Asian options, which are the most popular
exotic options traded in the OTC market. In this chapter we continue to discuss other types of
exotic options, which are highly customised options that can be used for hedging or speculative
purposes. Although these options are less traded and some might just be a two-party transac-
tion, their payoffs have unique features which make them a very interesting subject in their
own right. There are many reasons why exotic options are developed in the first place. Most
notably, exotic options enable investors or speculators to focus their view on future market
behaviour (such as the exchange rate risk or corporate/sovereign credit risk rating).
In this chapter, different types of exotic options are presented and their valuations are dis-
cussed in detail. Throughout this chapter, unless otherwise stated, we assume a continuous
dividend yield and the volatility of the asset price and the risk-free interest rate are assumed
to be constants within the life of the option contract. As the majority of the payoffs discussed
in this chapter are based on European-style payoffs, the formulas of many exotic options are
analytical.
6.1
INTRODUCTION
Within the family of exotic options, the options can be either path-independent or path-
dependent-type options.
Path-Independent Options
For exotic options which are path-independent, their payoffs only depend on the terminal value
of the underlying asset price, irrespective of the route taken. Examples of these are the simple
digital and asset-or-nothing options, as the payoffs depend exclusively on the asset price at
option expiry time. More complicated path-independent options may involve two or more
assets, such as exchange options (exchange one asset for another), spread options (difference
between asset prices) and rainbow options (best or worst of asset prices).
Path-Dependent Options
For exotic options which are path-dependent, their payoffs may depend on the whole path of
the underlying asset price rather than just the terminal value. A great majority of exotic options
are path-dependent, such as forward start options (where the option starts at a specified future
date), compound options (where the underlying is another option), chooser options (which
allow the holder of the option to choose at a specified time whether the contract becomes a
European call or a European put) and lookback options (where the maximum or minimum of
the underlying asset is attained over a certain period of time).

532
6.2.1 Path-Independent Options
6.2
PROBLEMS AND SOLUTIONS
6.2.1
Path-Independent Options
1. Capped Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space
(Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest-rate parameter from the money-market account.
We consider a capped call option with terminal payoff
Ψ(𝑆𝑇) = min{max{𝑆𝑇−𝐾, 0}, 𝑀}
at time 𝑇≥𝑡with strike price 𝐾> 0 and 𝑀the cap value. Show that the capped call
option price at time 𝑡is
𝐶𝑐𝑎𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑀, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾+ 𝑀, 𝑇)
where 𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) is the vanilla (or European) call option price defined as
𝐶𝑏𝑠(𝑋, 𝑡; 𝑌, 𝑇) = 𝑋𝑒−𝐷(𝑇−𝑡)Φ (𝑑+
) −𝑌𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)
such that 𝑑± =
log(𝑋∕𝑌) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the
cdf of a standard normal.
Solution: From the definition of a capped call option payoff we can write
Ψ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
0
𝑆𝑇< 𝐾
𝑆𝑇−𝐾
𝐾≤𝑆𝑇< 𝐾+ 𝑀
𝑀
𝑆𝑇≥𝐾+ 𝑀
so that the payoff diagram for the capped call option 𝐶𝑐𝑎𝑝(𝑆𝑇, 𝑇; 𝐾, 𝑀, 𝑇) can be con-
structed with the portfolios in Figure 6.1.
Thus, at expiry time 𝑇we can write the capped call option price as
𝐶𝑐𝑎𝑝
(𝑆𝑇, 𝑇; 𝐾, 𝑀, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑇, 𝑇; 𝐾, 𝑇) −𝐶𝑏𝑠(𝑆𝑇, 𝑇; 𝐾+ 𝑀, 𝑇)
and by discounting the entire payoff under the risk-neutral measure ℚ, we can write the
solution for the capped call option at time 𝑡as
𝐶𝑐𝑎𝑝
(𝑆𝑡, 𝑡; 𝐾, 𝑀, 𝑇) = 𝐶𝑏𝑠
(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾+ 𝑀, 𝑇).

6.2.1 Path-Independent Options
533
Figure 6.1
Capped call payoff diagram.
2. Corridor Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest-rate parameter from the money-market account.
We consider a corridor call option with terminal payoff
Ψ(𝑆𝑇) =
{
1
if 𝐾1 < 𝑆𝑇< 𝐾2
0
otherwise
which pays $1 at expiry time 𝑇≥𝑡if 𝐾1 < 𝑆𝑇< 𝐾2 and nothing if 𝑆𝑇≥𝐾2 or 𝑆𝑇≤𝐾1,
𝐾1 < 𝐾2. Show that the corridor call option price at time 𝑡is
𝐶𝑐𝑜𝑟(𝑆𝑡, 𝑡; 𝐾1, 𝐾2, 𝑇) = 𝐶𝑑(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶𝑑(𝑆𝑡, 𝑡; 𝐾2, 𝑇)
where 𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) is the European digital call option price defined as
𝐶𝑑(𝑋, 𝑡; 𝑌, 𝑇) = 𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)
such that 𝑑−=
log (𝑋∕𝑌) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the
cdf of a standard normal.

534
6.2.1 Path-Independent Options
Figure 6.2
Corridor payoff diagram.
Solution: From the corridor option payoff
Ψ(𝑆𝑇) =
{
1
if 𝐾1 < 𝑆𝑇< 𝐾2
0
otherwise
the payoff diagram for 𝐶𝑐𝑜𝑟(𝑆𝑇, 𝑇; 𝐾1, 𝐾2, 𝑇) can be constructed with the portfolios in
Figure 6.2.
Thus, at expiry time 𝑇we can write the corridor option price as
𝐶𝑐𝑜𝑟
(𝑆𝑇, 𝑇; 𝐾1, 𝐾2, 𝑇) = 𝐶𝑑
(𝑆𝑇, 𝑇; 𝐾1, 𝑇) −𝐶𝑑(𝑆𝑇, 𝑇; 𝐾2, 𝑇)
and by discounting the entire payoff under the risk-neutral measure ℚ, we can write the
solution for the corridor option at time 𝑡as
𝐶𝑐𝑜𝑟
(𝑆𝑡, 𝑡; 𝐾1, 𝐾2, 𝑇) = 𝐶𝑑
(𝑆𝑡, 𝑡; 𝐾1, 𝑇) −𝐶𝑑(𝑆𝑡, 𝑡; 𝐾2, 𝑇).
3. Power Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability space
(Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility param-
eter and let 𝑟be the risk-free interest rate from a money-market account.

6.2.1 Path-Independent Options
535
We define 𝑌𝑡= 𝑆𝑛
𝑡for 𝑛≥1. Using It¯o’s lemma, find the SDE satisfied by 𝑌𝑡and show
that under the risk-neutral measure ℚ
log
(𝑌𝑇
𝑌𝑡
)
∼
[
𝑛
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) , 𝑛2𝜎2(𝑇−𝑡)
]
for 𝑡≤𝑇.
By using the European call price formula, deduce that the call option of a power option
payoff
Ψ(𝑆𝑛
𝑇) = max{𝑆𝑛
𝑇−𝐾, 0}
for strike price 𝐾> 0 is
𝐶(𝑆𝑛
𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑛
𝑡𝑒−𝑛𝐷(𝑇−𝑡)Φ(𝑑∗
+) −𝐾𝑒−𝑛(𝑟+ 1
2 (𝑛−1)𝜎2)(𝑇−𝑡)Φ(𝑑∗
−)
where 𝑑∗
+ =
log(𝑆𝑡∕𝐾
1
𝑛) + (𝑟−𝐷+ (𝑛−1
2)𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and 𝑑∗
−= 𝑑∗
+ −𝑛𝜎
√
𝑇−𝑡.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚwe can write
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
such that 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. By expanding 𝑑(𝑆𝑛
𝑡)
using Taylor’s theorem and subsequently with the application of It¯o’s lemma, we can write
𝑑(𝑆𝑛
𝑡
) = 𝑛𝑆𝑛−1
𝑡
𝑑𝑆𝑡+ 1
2𝑛(𝑛−1)𝑆𝑛−2
𝑡
(𝑑𝑆𝑡
)2 + …
= 𝑛𝑆𝑛
𝑡
(𝑑𝑆𝑡
𝑆𝑡
)
+ 1
2𝑛(𝑛−1)𝑆𝑛
𝑡
(𝑑𝑆𝑡
𝑆𝑡
)2
= 𝑛𝑆𝑛
𝑡
[(𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
] + 1
2𝑛(𝑛−1)𝑆𝑛
𝑡𝜎2𝑑𝑡
= 𝑛𝑆𝑛
𝑡
[(
𝑟−𝐷+ 1
2(𝑛−1)𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
]
or
𝑑𝑌𝑡
𝑌𝑡
= 𝑛
(
𝑟−𝐷+ 1
2(𝑛−1)𝜎2)
𝑑𝑡+ 𝑛𝜎𝑑𝑊ℚ
𝑡.

536
6.2.1 Path-Independent Options
Using It̄o’s lemma on 𝑑(log 𝑌𝑡
) we can write
𝑑(log𝑌𝑡
) = 𝑑𝑌𝑡
𝑌𝑡
−1
2
(𝑑𝑌𝑡
𝑌𝑡
)2
+ …
= 𝑛
(
𝑟−𝐷+ 1
2(𝑛−1)𝜎2)
𝑑𝑡+ 𝑛𝜎𝑑𝑊ℚ
𝑡
−1
2𝑛2𝜎2𝑑𝑡
=
(
𝑛(𝑟−𝐷) + 1
2𝑛(𝑛−1)𝜎2 −1
2𝑛2𝜎2)
𝑑𝑡+ 𝑛𝜎𝑑𝑊ℚ
𝑡
=
(
𝑛(𝑟−𝐷) −1
2𝑛𝜎2)
𝑑𝑡+ 𝑛𝜎𝑑𝑊ℚ
𝑡
= 𝑛
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑡+ 𝑛𝜎𝑑𝑊ℚ
𝑡.
Integrating over time we can write
∫
𝑇
𝑡
𝑑(log𝑌𝑢
) 𝑑𝑢= ∫
𝑇
𝑡
𝑛
(
𝑟−𝐷−1
2𝜎2)
𝑑𝑢+ 𝑛𝜎∫
𝑇
𝑡
𝑑𝑊ℚ
𝑢
log
(𝑌𝑇
𝑌𝑡
)
= 𝑛
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) + 𝑛𝜎(𝑊ℚ
𝑇−𝑊ℚ
𝑡
)
where 𝑊ℚ
𝑇−𝑊ℚ
𝑡
= 𝑊ℚ
𝑇−𝑡∼(0, 𝑇−𝑡). The expectation and variance are given as
𝔼ℚ
[
log
(𝑌𝑇
𝑌𝑡
)]
= 𝑛
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡)
and
Varℚ
[
log
(𝑌𝑇
𝑌𝑡
)]
= 𝑛2𝜎2(𝑇−𝑡)
or
log
(𝑌𝑇
𝑌𝑡
)
∼
[
𝑛
(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡) , 𝑛2𝜎2(𝑇−𝑡)
]
.
To find the European call price for a power option with payoff Ψ(𝑆𝑛
𝑇) = max{𝑆𝑛
𝑇−𝐾, 0}
by comparing the SDEs of
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊ℚ
𝑡
and
𝑑𝑌𝑡= 𝑛
(
𝑟−𝐷+ 1
2(𝑛−1)𝜎2)
𝑌𝑡𝑑𝑡+ 𝑛𝜎𝑌𝑡𝑑𝑊ℚ
𝑡
we can set
𝑑𝑌𝑡
𝑌𝑡
= (𝑟∗−𝐷∗) 𝑑𝑡+ 𝜎∗𝑑𝑊ℚ
𝑡
where 𝑟∗= 𝑛
(
𝑟+ 1
2(𝑛−1)𝜎2)
, 𝐷∗= 𝑛𝐷and 𝜎∗= 𝑛𝜎. Hence, we can deduce that the
call option price at time 𝑡≤𝑇is
𝐶(𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑌𝑡𝑒−𝐷∗(𝑇−𝑡)Φ (𝑑∗
+
) −𝐾𝑒−𝑟∗(𝑇−𝑡)Φ (𝑑∗
−
)

6.2.1 Path-Independent Options
537
where 𝑑∗
± =
log(𝑌𝑡∕𝐾) + (𝑟∗−𝐷∗± 1
2(𝜎∗)2)(𝑇−𝑡)
𝜎∗√
𝑇−𝑡
.
By substituting back 𝑌𝑡= 𝑆𝑛
𝑡we have
𝐶(𝑆𝑛
𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑛
𝑡𝑒−𝑛𝐷(𝑇−𝑡)Φ (𝑑∗
+
) −𝐾𝑒
−𝑛
(
𝑟+ 1
2 (𝑛−1)𝜎2)
(𝑇−𝑡)Φ (𝑑∗
−
)
where
𝑑∗
+ =
log(𝑆𝑛
𝑡∕𝐾) + 𝑛(𝑟−𝐷+ 1
2(𝑛−1)𝜎2 + 1
2𝑛𝜎2)(𝑇−𝑡)
𝑛𝜎
√
𝑇−𝑡
=
log(𝑆𝑡∕𝐾
1
𝑛) + (𝑟−𝐷+ 1
2𝑛𝜎2 −1
2𝜎2 + 1
2𝑛𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
=
log(𝑆𝑡∕𝐾
1
𝑛) + (𝑟−𝐷+ (𝑛−1
2)𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
𝑑∗
−= 𝑑∗
+ −𝑛𝜎
√
𝑇−𝑡.
4. Let {𝑊𝑥
𝑡: 𝑡≥0} and {𝑊𝑦
𝑡: 𝑡≥0} be ℙ-standard Wiener processes on the probability
space (Ω, ℱ, ℙ) and let the asset prices 𝑋𝑡and 𝑌𝑡satisfy the following diffusion processes
𝑑𝑋𝑡= (𝜇𝑥−𝐷𝑥)𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡
𝑑𝑌𝑡= (𝜇𝑦−𝐷𝑦)𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑𝑊𝑦
𝑡
𝑑𝑊𝑥
𝑡⋅𝑑𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where 𝜇𝑥and 𝜇𝑦are the drifts, 𝐷𝑥and 𝐷𝑦are the continuous dividend yields, 𝜎𝑥and 𝜎𝑦
are the volatilities, 𝜌𝑥𝑦is the correlation coefficient such that 𝜌𝑥𝑦∈(−1, 1) and let 𝑟be the
risk-free interest rate from a money-market account.
Using a hedging portfolio, show that a European-style option price 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) which
depends on both 𝑋𝑡and 𝑌𝑡satisfies the following two-dimensional Black–Scholes
equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+ (𝑟−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
+(𝑟−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
−𝑟𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) = 0.

538
6.2.1 Path-Independent Options
Solution: At time 𝑡we let the portfolio Π𝑡be
Π𝑡= 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) −Δ𝑥𝑋𝑡−Δ𝑦𝑌𝑡
where the investor is long one unit of option 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) and short Δ𝑥and Δ𝑦units of 𝑋𝑡
and 𝑌𝑡, respectively. Let the change of portfolio be
𝑑Π𝑡= 𝑑𝑉−Δ𝑥(𝑑𝑋𝑡+ 𝐷𝑥𝑋𝑡𝑑𝑡) −Δ𝑦(𝑑𝑌𝑡+ 𝐷𝑦𝑌𝑡𝑑𝑡)
where the investor receives 𝐷𝑥𝑋𝑡𝑑𝑡and 𝐷𝑦𝑌𝑡𝑑𝑡for holding assets 𝑋𝑡and 𝑌𝑡, respectively.
From Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑋𝑡
𝑑𝑋𝑡+ 𝜕𝑉
𝜕𝑌𝑡
𝑑𝑌𝑡+ 1
2
𝜕2𝑉
𝜕𝑋2
𝑡
(𝑋𝑡)2 + 1
2
𝜕2𝑉
𝜕𝑌2
𝑡
(𝑌𝑡)2
+ 𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
(𝑑𝑋𝑡𝑑𝑌𝑡) + …
and
by
substituting
𝑑𝑋𝑡= (𝜇𝑥−𝐷𝑥)𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡,
𝑑𝑌𝑡= (𝜇𝑦−𝐷𝑦)𝑌𝑡𝑑𝑡+
𝜎𝑦𝑌𝑡𝑑𝑊𝑦
𝑡, 𝑑𝑊𝑥
𝑡⋅𝑑𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡and applying It¯o’s lemma
𝑑𝑉=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+ (𝜇𝑥−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
+(𝜇𝑦−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡+ 𝜎𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
𝑑𝑊𝑥
𝑡+ 𝜎𝑦𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
𝑑𝑊𝑦
𝑡.
Substituting 𝑑𝑉back into 𝑑Π𝑡we eventually have
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+(𝜇𝑥−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝜇𝑥Δ𝑥𝑋𝑡+ (𝜇𝑦−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
−𝜇𝑦Δ𝑦𝑌𝑡
)
𝑑𝑡
+𝜎𝑥𝑋𝑡
(
𝜕𝑉
𝜕𝑋𝑡
−Δ𝑥
)
𝑑𝑊𝑥
𝑡+ 𝜎𝑦𝑌𝑡
(
𝜕𝑉
𝜕𝑌𝑡
−Δ𝑦
)
𝑑𝑊𝑦
𝑡.
To eliminate the random components we set
Δ𝑥= 𝜕𝑉
𝜕𝑋𝑡
and
Δ𝑦= 𝜕𝑉
𝜕𝑌𝑡

6.2.1 Path-Independent Options
539
which leads to
𝑑Π𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
−𝐷𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝐷𝑦𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡.
Under the no-arbitrage condition the return on the amount Π𝑡invested in a risk-free interest
rate 𝑟would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡
and therefore we have
𝑟Π𝑡𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
−𝐷𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝐷𝑦𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡
or
𝑟(𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) −Δ𝑥𝑋𝑡−Δ𝑦𝑌𝑡
) 𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
−𝐷𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝐷𝑦𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡
𝑟
(
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) −𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡=
(
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
−𝐷𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝐷𝑦𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
)
𝑑𝑡.
Finally, by removing 𝑑𝑡and rearranging terms we eventually have
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+ (𝑟−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
+(𝑟−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
−𝑟𝑉(𝑋𝑡, 𝑌𝑡, 𝑡) = 0.

540
6.2.1 Path-Independent Options
5. Exchange Option (PDE Approach). Let {𝑊𝑥
𝑡: 𝑡≥0} and {𝑊𝑦
𝑡: 𝑡≥0} be ℙ-standard
Wiener processes on the probability space (Ω, ℱ, ℙ) and let the asset prices 𝑋𝑡and 𝑌𝑡
satisfy the following diffusion processes
𝑑𝑋𝑡= (𝜇𝑥−𝐷𝑥)𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡
𝑑𝑌𝑡= (𝜇𝑦−𝐷𝑦)𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑𝑊𝑦
𝑡
𝑑𝑊𝑥
𝑡⋅𝑑𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where 𝜇𝑥and 𝜇𝑦are the drifts, 𝐷𝑥and 𝐷𝑦are the continuous dividend yields, 𝜎𝑥and 𝜎𝑦
are the volatilities, 𝜌𝑥𝑦is the correlation coefficient such that 𝜌𝑥𝑦∈(−1, 1) and let 𝑟be the
risk-free interest rate from a money-market account.
We consider the exchange option with payoff
Ψ(𝑋𝑇, 𝑌𝑇) = max{𝑋𝑇−𝑌𝑇, 0}
at expiry time 𝑇≥𝑡where it gives the option holder the right but not the obligation to
exchange asset 𝑌𝑇for another asset 𝑋𝑇.
Show that if 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) is the price of the exchange option at time 𝑡, then it satisfies
the two-dimensional Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+ (𝑟−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
+(𝑟−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
−𝑟𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 0
with boundary condition
𝑉(𝑋𝑇, 𝑌𝑇, 𝑇; 𝑇) = max{𝑋𝑇−𝑌𝑇, 0}.
By setting
𝑍𝑡= 𝑋𝑡
𝑌𝑡
and
𝑈(𝑍𝑡, 𝑡; 𝑇) = 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇)
𝑌𝑡
show that 𝑈(𝑍𝑡, 𝑡) satisfies
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑍2
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
+ (𝐷𝑦−𝐷𝑥)𝑍𝑡
𝜕𝑈
𝜕𝑍𝑡
−𝐷𝑦𝑈(𝑍𝑡, 𝑡; 𝑇) = 0
with boundary condition
𝑈(𝑍𝑇, 𝑇; 𝑇) = max{𝑍𝑇−1, 0}
where 𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦.

6.2.1 Path-Independent Options
541
Hence, deduce that the exchange option price 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) is
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝑌𝑡) + (𝐷𝑦−𝐷𝑥± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: The first part of the solution can easily be derived following Problem 6.2.1.4
(page 537). As for the second part, we let
𝑍𝑡= 𝑋𝑡𝑌−1
𝑡
and
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑈(𝑍𝑡, 𝑡; 𝑇)𝑌𝑡
so that
𝜕𝑉
𝜕𝑡= 𝑌𝑡
𝜕𝑈
𝜕𝑡
𝜕𝑉
𝜕𝑋𝑡
= 𝑌𝑡
𝜕𝑈
𝜕𝑍𝑡
𝜕𝑍𝑡
𝜕𝑋𝑡
= 𝑌𝑡
𝜕𝑈
𝜕𝑍𝑡
𝑌−1
𝑡
= 𝜕𝑈
𝜕𝑍𝑡
𝜕𝑉
𝜕𝑌𝑡
= 𝑈(𝑍𝑡, 𝑡) + 𝑌𝑡
𝜕𝑈
𝜕𝑍𝑡
𝜕𝑍𝑡
𝜕𝑌𝑡
= 𝑈(𝑍𝑡, 𝑡) −𝑋𝑡𝑌−1
𝑡
𝜕𝑈
𝜕𝑍𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
=
𝜕
𝜕𝑋𝑡
(
𝜕𝑈
𝜕𝑍𝑡
)
= 𝜕2𝑈
𝜕𝑍2
𝑡
𝜕𝑍𝑡
𝜕𝑋𝑡
= 𝑌−1
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
= 𝜕𝑈
𝜕𝑍𝑡
𝜕𝑍𝑡
𝜕𝑌𝑡
+ 𝑋𝑡𝑌−2
𝑡
𝜕𝑈
𝜕𝑍𝑡
−𝑋𝑡𝑌−1
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
𝜕𝑍𝑡
𝜕𝑌𝑡
= 𝑋2
𝑡𝑌−3
𝑡
𝜕2𝑈
𝜕𝑋𝑡𝜕𝑌𝑡
=
𝜕
𝜕𝑌𝑡
(
𝜕𝑈
𝜕𝑍𝑡
)
= 𝜕2𝑈
𝜕𝑍2
𝑡
𝜕𝑍𝑡
𝜕𝑌𝑡
= −𝑋𝑡𝑌−2
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
.
Hence, by substituting 𝜕𝑉
𝜕𝑡, 𝜕𝑉
𝜕𝑋𝑡
, 𝜕𝑉
𝜕𝑌𝑡
, 𝜕2𝑉
𝜕𝑋2
𝑡
, 𝜕2𝑉
𝜕𝑌2
𝑡
and
𝜕2𝑈
𝜕𝑋𝑡𝜕𝑌𝑡
into
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 1
2𝜎2
𝑦𝑌2
𝑡
𝜕2𝑉
𝜕𝑌2
𝑡
+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑌𝑡
+(𝑟−𝐷𝑥)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
+ (𝑟−𝐷𝑦)𝑌𝑡
𝜕𝑉
𝜕𝑌𝑡
−𝑟𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 0
in terms of 𝑈(𝑍𝑡, 𝑡; 𝑇) and 𝑍𝑡we eventually have
𝑌𝑡
[
𝜕𝑈
𝜕𝑡+ 1
2(𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦)𝑋2
𝑡𝑌−2
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
+(𝐷𝑦−𝐷𝑥)𝑋𝑡𝑌−1
𝑡
𝜕𝑈
𝜕𝑍𝑡
−𝐷𝑦𝑈(𝑍𝑡, 𝑡; 𝑇)
]
= 0

542
6.2.1 Path-Independent Options
or
𝜕𝑈
𝜕𝑡+ 1
2𝜎2𝑍2
𝑡
𝜕2𝑈
𝜕𝑍2
𝑡
+ (𝐷𝑦−𝐷𝑥)𝑍𝑡
𝜕𝑈
𝜕𝑍𝑡
−𝐷𝑦𝑈(𝑍𝑡, 𝑡; 𝑇) = 0
where 𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦, which is equivalent to a Black–Scholes equation with
volatility = 𝜎
continuous dividend yield = 𝐷𝑥
risk-free interest rate = 𝐷𝑦
and boundary condition
𝑈(𝑍𝑇, 𝑇; 𝑇) = max{𝑋𝑇−𝑌𝑇, 0}𝑌−1
𝑇
= max{𝑋𝑇∕𝑌𝑇−1, 0}
= max{𝑍𝑇−1, 0}
which is the payoff of a European call option with strike price 𝐾= 1. Hence, following
Problem 2.2.2.4 (page 95) we can deduce that
𝑈(𝑍𝑡, 𝑡; 𝑇) = 𝑍𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log 𝑍𝑡+ (𝐷𝑦−𝐷𝑥± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and substituting
𝑈(𝑍𝑡, 𝑡; 𝑇) = 𝑉(𝑋𝑡, 𝑌𝑡, 𝑡)𝑌−1
𝑡
and
𝑍𝑡= 𝑋𝑡𝑌−1
𝑡
we have
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇)
𝑌𝑡
=
(𝑋𝑡
𝑌𝑡
)
𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
or
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝑌𝑡) + (𝐷𝑦−𝐷𝑥± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.

6.2.1 Path-Independent Options
543
6. Exchange Option (Probabilistic Approach). Let {𝑊𝑥
𝑡: 𝑡≥0} and {𝑊𝑦
𝑡: 𝑡≥0} be
ℙ-standard Wiener processes on the probability space (Ω, ℱ, ℙ) and let the asset prices
𝑋𝑡and 𝑌𝑡have the following diffusion processes
𝑑𝑋𝑡= (𝜇𝑥−𝐷𝑥)𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡
𝑑𝑌𝑡= (𝜇𝑦−𝐷𝑦)𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑𝑊𝑦
𝑡
𝑑𝑊𝑥
𝑡⋅𝑑𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where 𝜇𝑥and 𝜇𝑦are the drifts, 𝐷𝑥and 𝐷𝑦are the continuous dividend yields, 𝜎𝑥and 𝜎𝑦
are the volatilities, 𝜌𝑥𝑦is the correlation coefficient such that 𝜌𝑥𝑦∈(−1, 1) and let 𝑟be the
risk-free interest rate from a money-market account.
By defining two new independent standard Wiener processes ̂
𝑊𝑦
𝑡and ̂
𝑊𝑦⊥
𝑡
such that
𝑑̃
𝑊𝑥
𝑡= 𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑̃
𝑊𝑦
𝑡= 𝑑̂
𝑊𝑦
𝑡
𝑑̂
𝑊𝑦
𝑡⋅𝑑̂
𝑊𝑦⊥
𝑡
= 0
where, under the risk-neutral measure ℚ, ̃
𝑊𝑥
𝑡= 𝑊𝑥
𝑡+
(𝜇𝑥−𝑟
𝜎𝑥
)
𝑡and ̃
𝑊𝑦
𝑡= 𝑊𝑦
𝑡+
(𝜇𝑦−𝑟
𝜎𝑦
)
𝑡are ℚ-standard Wiener processes, we define the price of an exchange option
at time 𝑡with payoff
Ψ(𝑋𝑇, 𝑌𝑇) = max{𝑋𝑇−𝑌𝑇, 0}
at expiry time 𝑇≥𝑡as
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝑌𝑇, 0}|| ℱ𝑡
] .
By denoting ℚ𝑌as the new measure where 𝑌𝑡𝑒𝐷𝑦𝑡is the num´eraire and taking note that
the discounted money-market account
(𝑌𝑡𝑒𝐷𝑦𝑡)−1 𝑒𝑟𝑡
is a ℚ𝑌-martingale, show that under ℚ𝑌, 𝑋𝑡and 𝑌𝑡have the following diffusion processes
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦+ 𝜎2
𝑦)𝑑𝑡+ 𝜎𝑦𝑑𝑊
𝑦
𝑡

544
6.2.1 Path-Independent Options
where 𝑊
𝑦
𝑡= ̂
𝑊𝑦
𝑡−𝜎𝑦𝑡. Hence, by finding the diffusion process for 𝑋𝑡∕𝑌𝑡under ℚ𝑌show
that
log
(𝑋𝑇
𝑌𝑇
)
∼
[
log
(𝑋𝑡
𝑌𝑡
)
+
(
𝐷𝑦−𝐷𝑥−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
where 𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦and finally deduce Margrabe’s formula
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝑌𝑡) + (𝐷𝑦−𝐷𝑥± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥𝑑̃
𝑊𝑥
𝑡
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦𝑑̃
𝑊𝑦
𝑡
𝑑̃
𝑊𝑥
𝑡⋅𝑑̃
𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where ̃
𝑊𝑥
𝑡= 𝑊𝑥
𝑡+
(𝜇𝑥−𝑟
𝜎𝑥
)
𝑡and ̃
𝑊𝑦
𝑡= 𝑊𝑦
𝑡+
(𝜇𝑦−𝑟
𝜎𝑦
)
𝑡are ℚ-standard Wiener
processes. By defining
𝑑̃
𝑊𝑥
𝑡= 𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑̃
𝑊𝑦
𝑡= 𝑑̂
𝑊𝑦
𝑡
𝑑̂
𝑊𝑦
𝑡⋅𝑑̂
𝑊𝑦⊥
𝑡
= 0
we have
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦𝑑̂
𝑊𝑦
𝑡
such that
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
⋅𝑑̂
𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡.

6.2.1 Path-Independent Options
545
For a payoff Ψ(𝑋𝑇, 𝑌𝑇) under the change of num´eraire,
𝑁𝑡𝔼ℚ
[ Ψ(𝑋𝑇, 𝑌𝑇)
𝑁𝑇
||||
ℱ𝑡
]
= 𝑀𝑡𝔼ℚ𝑌
[ Ψ(𝑋𝑇, 𝑌𝑇)
𝑀𝑇
||||
ℱ𝑡
]
where 𝑁and 𝑀are num´eraires (positive non-dividend-paying assets) and ℚand ℚ𝑌
are the measures under which the asset prices discounted by 𝑁and 𝑀are ℚand ℚ𝑌-
martingales, respectively.
Under the risk-neutral measure ℚwe have
𝑁𝑡= 𝑒𝑟𝑡and 𝑁𝑇= 𝑒𝑟𝑇
and under the ℚ𝑌measure, where 𝑌𝑡𝑒𝐷𝑦𝑡is a non-dividend-paying asset we have
𝑀𝑡= 𝑌𝑡𝑒𝐷𝑦𝑡and 𝑀𝑇= 𝑌𝑇𝑒𝐷𝑦𝑇.
Using a change of num´eraire, the exchange option at time 𝑡is
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝑌𝑇, 0}|| ℱ𝑡
]
= 𝑒𝑟𝑡𝔼ℚ
[ max{𝑋𝑇∕𝑌𝑇−1, 0}𝑌𝑇
𝑒𝑟𝑇
||||
ℱ𝑡
]
= 𝑌𝑡𝑒𝐷𝑦𝑡𝔼ℚ𝑌
[
max{𝑋𝑇∕𝑌𝑇−1, 0}𝑌𝑇
𝑌𝑇𝑒𝐷𝑦𝑇
|||||
ℱ𝑡
]
= 𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)𝔼ℚ𝑌[max{𝑋𝑇∕𝑌𝑇−1, 0}|| ℱ𝑡
] .
Under ℚ𝑌the discounted money-market account
𝑍𝑡= (𝑌𝑡𝑒𝐷𝑦𝑡)−1 𝑒𝑟𝑡
= 𝑌−1
𝑡
𝑒(𝑟−𝐷𝑦)𝑡
is a ℚ𝑌-martingale and from It¯o’s lemma
𝑑𝑍𝑡= (𝑟−𝐷𝑦)𝑒(𝑟−𝐷𝑦)𝑡𝑌−1
𝑡
𝑑𝑡+ 𝑌−1
𝑡
𝑒(𝑟−𝐷𝑦)𝑡
(
−𝑑𝑌𝑡
𝑌𝑡
+
(𝑑𝑌𝑡
𝑌𝑡
)2
+ …
)
= (𝑟−𝐷𝑦)𝑍𝑡𝑑𝑡+ 𝑍𝑡
(
−(𝑟−𝐷𝑦)𝑑𝑡−𝜎𝑦𝑑̂
𝑊𝑦
𝑡+ 𝜎2
𝑦𝑑𝑡
)
= 𝜎2
𝑦𝑍𝑡𝑑𝑡−𝜎𝑦𝑍𝑡𝑑̂
𝑊𝑦
𝑡
= −𝜎𝑦𝑍𝑡(𝑑̂
𝑊𝑦
𝑡−𝜎𝑦𝑑𝑡)
= −𝜎𝑦𝑍𝑡𝑑𝑊
𝑦
𝑡
where 𝑊
𝑦
𝑡= ̂
𝑊𝑦
𝑡−𝜎𝑦𝑡is a ℚ𝑌-standard Wiener process. Because ̂
𝑊𝑦⊥
𝑡
⟂⟂̂
𝑊𝑦
𝑡, then ̂
𝑊𝑦⊥
𝑡
is also a ℚ𝑌-standard Wiener process.

546
6.2.1 Path-Independent Options
Thus, under ℚ𝑌
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑𝑊
𝑦
𝑡+ 𝜌𝑥𝑦𝜎𝑦𝑑𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
= (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
and
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦𝑑̂
𝑊𝑦
𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦
(
𝑑𝑊
𝑦
𝑡+ 𝜎𝑦𝑑𝑡
)
= (𝑟−𝐷𝑦+ 𝜎2
𝑦)𝑑𝑡+ 𝜎𝑦𝑑𝑊
𝑦
𝑡.
From Taylor’s theorem
𝑑
(𝑋𝑡
𝑌𝑡
)
(𝑋𝑡
𝑌𝑡
) = 𝑌𝑡
𝑋𝑡
[
𝑑𝑋𝑡
𝑌𝑡
−𝑋𝑡
𝑌2
𝑡
𝑑𝑌𝑡+ 1
2!
(
2𝑋𝑡
𝑌3
𝑡
)
(𝑑𝑌𝑡)2 −𝑑𝑋𝑡𝑑𝑌𝑡
𝑌2
𝑡
+ ⋯
]
= 𝑑𝑋𝑡
𝑋𝑡
−𝑑𝑌𝑡
𝑌𝑡
+
(𝑑𝑌𝑡
𝑌𝑡
)2
−
(𝑑𝑋𝑡
𝑋𝑡
) (𝑑𝑌𝑡
𝑌𝑡
)
+ ⋯
and by substituting 𝑑𝑋𝑡∕𝑋𝑡, 𝑑𝑌𝑡∕𝑌𝑡and using It¯o’s lemma
𝑑
(𝑋𝑡
𝑌𝑡
)
(𝑋𝑡
𝑌𝑡
) = (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑦)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
−(𝑟−𝐷𝑦+ 𝜎2
𝑦)𝑑𝑡−𝜎𝑦𝑑𝑊
𝑦
𝑡+ 𝜎2
𝑦𝑑𝑡−𝜌𝑥𝑦𝜎𝑥𝜎𝑦𝑑𝑡
= (𝐷𝑦−𝐷𝑥)𝑑𝑡+ (𝜌𝑥𝑦𝜎𝑥−𝜎𝑦)𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
.
To find the distribution of 𝑋𝑡∕𝑌𝑡we note that
𝑑
(
log
(𝑋𝑡
𝑌𝑡
))
=
𝑑
(𝑋𝑡
𝑌𝑡
)
(𝑋𝑡
𝑌𝑡
) −1
2!
⎡
⎢
⎢
⎢
⎢⎣
𝑑
(𝑋𝑡
𝑌𝑡
)
(𝑋𝑡
𝑌𝑡
)
⎤
⎥
⎥
⎥
⎥⎦
2
+ …
=
(
𝐷𝑦−𝐷𝑥−1
2𝜎2)
𝑑𝑡+ (𝜌𝑥𝑦𝜎𝑥−𝜎𝑦)𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡

6.2.1 Path-Independent Options
547
where 𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦.
Taking integrals
∫
𝑇
𝑡
𝑑
(
log
(𝑋𝑢
𝑌𝑢
))
= ∫
𝑇
𝑡
(
𝐷𝑦−𝐷𝑥−1
2𝜎2)
𝑑𝑢+ ∫
𝑇
𝑡
(𝜌𝑥𝑦𝜎𝑥−𝜎𝑦)𝑑𝑊
𝑦
𝑢
+ ∫
𝑇
𝑡
𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑢
or
log
(𝑋𝑇
𝑌𝑇
)
= log
(𝑋𝑡
𝑌𝑡
)
+
(
𝐷𝑦−𝐷𝑥−1
2𝜎2)
(𝑇−𝑡) + (𝜌𝑥𝑦𝜎𝑥−𝜎𝑦)𝑊
𝑦
𝑇−𝑡
+𝜎𝑥
√
1 −𝜌2
𝑥𝑦̂
𝑊𝑦⊥
𝑇−𝑡.
Because 𝑊
𝑦
𝑇−𝑡, ̂
𝑊𝑦⊥
𝑇−𝑡∼(0, 𝑇−𝑡) and 𝑊
𝑦
𝑇−𝑡⟂⟂̂
𝑊𝑦⊥
𝑇−𝑡, hence
log
(𝑋𝑇
𝑌𝑇
)
∼
[
log
(𝑋𝑡
𝑌𝑡
)
+
(
𝐷𝑦−𝐷𝑥−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
.
Finally, by analogy with a European call price formula, we can deduce
𝑉(𝑋𝑡, 𝑌𝑡, 𝑡; 𝑇) = 𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)𝔼ℚ
[
max
{𝑋𝑇
𝑌𝑇
−1, 0
}|||||
ℱ𝑡
]
= 𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)
[𝑋𝑡
𝑌𝑡
𝑒−(𝐷𝑥−𝐷𝑦)(𝑇−𝑡)Φ(𝑑+) −Φ(𝑑−)
]
= 𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −𝑌𝑡𝑒−𝐷𝑦(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝑌𝑡) + (𝐷𝑦−𝐷𝑥± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
7. Spread Option I. Let {𝑊𝑥
𝑡: 𝑡≥0} and {𝑊𝑦
𝑡: 𝑡≥0} be ℙ-standard Wiener processes on
the probability space (Ω, ℱ, ℙ) and let the asset prices 𝑋𝑡and 𝑌𝑡have the following diffu-
sion processes
𝑑𝑋𝑡= (𝜇𝑥−𝐷𝑥)𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡
𝑑𝑌𝑡= (𝜇𝑦−𝐷𝑦)𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑𝑊𝑦
𝑡
𝑑𝑊𝑥
𝑡⋅𝑑𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where 𝜇𝑥and 𝜇𝑦are the drifts, 𝐷𝑥and 𝐷𝑦are the continuous dividend yields, 𝜎𝑥and 𝜎𝑦
are the volatilities, 𝜌𝑥𝑦is the correlation coefficient such that 𝜌𝑥𝑦∈(−1, 1) and let 𝑟be the
risk-free interest rate from a money-market account.

548
6.2.1 Path-Independent Options
By setting two new independent standard Wiener processes ̂
𝑊𝑦
𝑡and ̂
𝑊𝑦⊥
𝑡
such that
𝑑̃
𝑊𝑥
𝑡= 𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑̃
𝑊𝑦
𝑡= 𝑑̂
𝑊𝑦
𝑡
𝑑̂
𝑊𝑦
𝑡⋅𝑑̂
𝑊𝑦⊥
𝑡
= 0
where, under the risk-neutral measure ℚ, ̃
𝑊𝑥
𝑡= 𝑊𝑥
𝑡+
(𝜇𝑥−𝑟
𝜎𝑥
)
𝑡and ̃
𝑊𝑦
𝑡= 𝑊𝑦
𝑡+
(𝜇𝑦−𝑟
𝜎𝑦
)
𝑡are ℚ-standard Wiener processes, for a strike price 𝐾> 0 we define the price
of a call spread option at time 𝑡with payoff
Ψ(𝑋𝑇, 𝑌𝑇) = max{𝑋𝑇−𝑌𝑇−𝐾, 0}
at expiry time 𝑇≥𝑡as
𝐶𝑠𝑝(𝑋𝑡, 𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝑌𝑇−𝐾, 0}|| ℱ𝑡
] .
For a small strike 𝐾≪𝑌𝑡, show that under the ℚmeasure, the process 𝑍𝑡= 𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
is approximately log normal with the following diffusion
𝑑𝑍𝑡
𝑍𝑡
= (𝑟−𝐷𝑧)𝑑𝑡+ 𝜎𝑧𝑑̂
𝑊𝑦
𝑡
where 𝐷𝑧=
𝐷𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) and 𝜎𝑧=
𝜎𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) are assumed to be constants.
By denoting ℚ𝑍as the new measure where 𝑍𝑡𝑒𝐷𝑧𝑡is the num´eraire and taking note that
the discounted money-market account
(𝑍𝑡𝑒𝐷𝑧𝑡)−1 𝑒𝑟𝑡
is a ℚ𝑍-martingale, show that under ℚ𝑍, 𝑋𝑡and 𝑍𝑡have the following diffusion processes
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑧)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑𝑍𝑡
𝑍𝑡
= (𝑟−𝐷𝑧+ 𝜎2
𝑧)𝑑𝑡+ 𝜎𝑧𝑑𝑊
𝑦
𝑡

6.2.1 Path-Independent Options
549
where 𝑊
𝑦
𝑡= ̂
𝑊𝑦
𝑡−𝜎𝑧𝑡. Therefore, by finding the diffusion process for 𝑋𝑡∕𝑍𝑡under ℚ𝑍
show that
log
(𝑋𝑇
𝑌𝑇
)
∻
[
log
(
𝑋𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)
+
(
𝐷𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) −𝐷𝑥−1
2𝜎2
)
(𝑇−𝑡),
𝜎2(𝑇−𝑡)]
where
𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦
(
𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)
+
(
𝜎𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)2
and
finally
deduce Kirk’s approximation formula
𝐶𝑠𝑝(𝑋𝑡, 𝑌𝑡, 𝑡; 𝐾) ≈𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+) −(𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)) 𝑒
−
(
𝐷𝑦𝑌𝑡
𝑌𝑡+𝐾𝑒−𝑟(𝑇−𝑡)
)
(𝑇−𝑡)
Φ(𝑑−)
where
𝑑± =
log
(
𝑋𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)
+
(
𝐷𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) −𝐷𝑥± 1
2𝜎2
)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and
Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚwe can write
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥𝑑̃
𝑊𝑥
𝑡
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦𝑑̃
𝑊𝑦
𝑡
𝑑̃
𝑊𝑥
𝑡⋅𝑑̃
𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡
where ̃
𝑊𝑥
𝑡= 𝑊𝑥
𝑡+
(𝜇𝑥−𝑟
𝜎𝑥
)
𝑡and ̃
𝑊𝑦
𝑡= 𝑊𝑦
𝑡+
(𝜇𝑦−𝑟
𝜎𝑦
)
𝑡are ℚ-standard Wiener
processes. By defining
𝑑̃
𝑊𝑥
𝑡= 𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
𝑑̃
𝑊𝑦
𝑡= 𝑑̂
𝑊𝑦
𝑡
𝑑̂
𝑊𝑦
𝑡⋅𝑑̂
𝑊𝑦⊥
𝑡
= 0

550
6.2.1 Path-Independent Options
we have
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
𝑑𝑌𝑡
𝑌𝑡
= (𝑟−𝐷𝑦)𝑑𝑡+ 𝜎𝑦𝑑̂
𝑊𝑦
𝑡
such that
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
⋅𝑑̂
𝑊𝑦
𝑡= 𝜌𝑥𝑦𝑑𝑡.
For a small strike 𝐾≪𝑌𝑡, the diffusion process for 𝑍𝑡= 𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) is
𝑑𝑍𝑡= 𝑑𝑌𝑡+ 𝑟𝐾𝑒−𝑟(𝑇−𝑡)𝑑𝑡
= (𝑟−𝐷𝑦)𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑̂
𝑊𝑦
𝑡+ 𝑟𝐾𝑒−𝑟(𝑇−𝑡)𝑑𝑡
= 𝑟(𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)) 𝑑𝑡−𝐷𝑦𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑̂
𝑊𝑦
𝑡
= 𝑟𝑍𝑡𝑑𝑡−𝐷𝑦𝑌𝑡𝑑𝑡+ 𝜎𝑦𝑌𝑡𝑑̂
𝑊𝑦
𝑡
or
𝑑𝑍𝑡
𝑍𝑡
= (𝑟−𝐷𝑧)𝑑𝑡+ 𝜎𝑧𝑑̂
𝑊𝑦
𝑡
where 𝐷𝑧=
𝐷𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) and 𝜎𝑧=
𝜎𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) . By expanding 𝑑(log 𝑍𝑡) using It¯o’s
lemma we have
𝑑(log 𝑍𝑡) = 𝑑𝑍𝑡
𝑍𝑡
−1
2!
(𝑑𝑍𝑡
𝑍𝑡
)2
+ …
=
(
𝑟−𝐷𝑧−1
2𝜎2
𝑧
)
𝑑𝑡+ 𝜎𝑧𝑑̂
𝑊𝑦
𝑡.
By assuming both 𝐷𝑧and 𝜎𝑧to be constants and taking integrals
∫
𝑇
𝑡
𝑑(log 𝑍𝑢) = ∫
𝑇
𝑡
(
𝑟−𝐷𝑧−1
2𝜎2
𝑧
)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑧𝑑̂
𝑊𝑦
𝑢
log
(𝑍𝑇
𝑍𝑡
)
=
(
𝑟−𝐷𝑧−1
2𝜎2
𝑧
)
(𝑇−𝑡) + ∫
𝑇
𝑡
𝜎𝑧𝑑̂
𝑊𝑦
𝑢

6.2.1 Path-Independent Options
551
we can therefore deduce that
log
(
𝑌𝑇+ 𝐾
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)
∻
[(
𝑟−𝐷𝑧−1
2𝜎2
𝑦
)
(𝑇−𝑡), 𝜎2
𝑧(𝑇−𝑡)
]
.
For a payoff Ψ(𝑋𝑇, 𝑌𝑇) under the change of num´eraire
𝑁𝑡𝔼ℚ
[ Ψ(𝑋𝑇, 𝑌𝑇)
𝑁𝑇
||||
ℱ𝑡
]
= 𝑀𝑡𝔼ℚ𝑍
[ Ψ(𝑋𝑇, 𝑌𝑇)
𝑀𝑇
||||
ℱ𝑡
]
where 𝑁and 𝑀are num´eraires (positive non-dividend-paying assets) and ℚand ℚ𝑍
are the measures under which the asset prices discounted by 𝑁and 𝑀are ℚand ℚ𝑍-
martingales, respectively.
Under the risk-neutral, measure ℚwe have
𝑁𝑡= 𝑒𝑟𝑡and 𝑁𝑇= 𝑒𝑟𝑇
and under the ℚ𝑍measure, where 𝑍𝑡𝑒𝐷𝑧𝑡is a non-dividend-paying asset, we have
𝑀𝑡= 𝑍𝑡𝑒𝐷𝑧𝑡and 𝑀𝑇= 𝑍𝑇𝑒𝐷𝑧𝑇.
Using a change of num´eraire, the call spread option at time 𝑡is
𝐶𝑠𝑝(𝑋𝑡, 𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝑌𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒𝑟𝑡𝔼ℚ
⎡
⎢
⎢
⎢
⎢⎣
max
{
𝑋𝑇
𝑌𝑇+ 𝐾−1, 0
}
(𝑌𝑇+ 𝐾)
𝑒𝑟𝑇
|||||||||
ℱ𝑡
⎤
⎥
⎥
⎥
⎥⎦
= (𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡))𝑒𝐷𝑧𝑡
×𝔼ℚ𝑍
⎡
⎢
⎢
⎢
⎢⎣
max
{
𝑋𝑇
𝑌𝑇+ 𝐾−1, 0
}
(𝑌𝑇+ 𝐾)
(𝑌𝑇+ 𝐾)𝑒𝐷𝑧𝑇
|||||||||
ℱ𝑡
⎤
⎥
⎥
⎥
⎥⎦
= (𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡))𝑒−𝐷𝑧(𝑇−𝑡)
×𝔼ℚ𝑍
[
max
{
𝑋𝑇
𝑌𝑇+ 𝐾−1, 0
}|||||
ℱ𝑡
]
= 𝑍𝑡𝑒−𝐷𝑧(𝑇−𝑡)𝔼ℚ𝑍
[
max
{𝑋𝑇
𝑍𝑇
−1, 0
}|||||
ℱ𝑡
]
.

552
6.2.1 Path-Independent Options
Under ℚ𝑍, the discounted money-market account
𝑍𝑡= (𝑍𝑡𝑒𝐷𝑧𝑡)−1 𝑒𝑟𝑡
= 𝑍−1
𝑡𝑒(𝑟−𝐷𝑧)𝑡
is a ℚ𝑍-martingale and from It¯o’s lemma
𝑑𝑍𝑡= (𝑟−𝐷𝑧)𝑒(𝑟−𝐷𝑧)𝑡𝑍−1
𝑡𝑑𝑡+ 𝑍−1
𝑡𝑒(𝑟−𝐷𝑧)𝑡
(
−𝑑𝑍𝑡
𝑍𝑡
+
(𝑑𝑍𝑡
𝑍𝑡
)2
+ …
)
= (𝑟−𝐷𝑧)𝑍𝑡𝑑𝑡+ 𝑍𝑡
(
−(𝑟−𝐷𝑧)𝑑𝑡−𝜎𝑧𝑑̂
𝑊𝑦
𝑡+ 𝜎2
𝑧𝑑𝑡
)
= 𝜎2
𝑧𝑍𝑡𝑑𝑡−𝜎𝑧𝑍𝑡𝑑̂
𝑊𝑦
𝑡
= −𝜎𝑧𝑍𝑡(𝑑̂
𝑊𝑦
𝑡−𝜎𝑧𝑑𝑡)
= −𝜎𝑧𝑍𝑡𝑑𝑊
𝑦
𝑡
where 𝑊
𝑦
𝑡= ̂
𝑊𝑦
𝑡−𝜎𝑧𝑡is a ℚ𝑍-standard Wiener process. Because ̂
𝑊𝑦⊥
𝑡
⟂⟂̂
𝑊𝑦
𝑡, then
therefore ̂
𝑊𝑦⊥
𝑡
is also a ℚ𝑍-standard Wiener process.
Thus, under ℚ𝑍
𝑑𝑋𝑡
𝑋𝑡
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑̂
𝑊𝑦
𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
= (𝑟−𝐷𝑥)𝑑𝑡+ 𝜎𝑥
(
𝜌𝑥𝑦𝑑𝑊
𝑦
𝑡+ 𝜌𝑥𝑦𝜎𝑧𝑑𝑡+
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
)
= (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑧)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
and
𝑑𝑍𝑡
𝑍𝑡
= (𝑟−𝐷𝑧)𝑑𝑡+ 𝜎𝑧𝑑̂
𝑊𝑦
𝑡
= (𝑟−𝐷𝑧)𝑑𝑡+ 𝜎𝑧
(
𝑑𝑊
𝑦
𝑡+ 𝜎𝑧𝑑𝑡
)
= (𝑟−𝐷𝑧+ 𝜎2
𝑧)𝑑𝑡+ 𝜎𝑧𝑑𝑊
𝑦
𝑡.
From Taylor’s theorem
𝑑
(𝑋𝑡
𝑍𝑡
)
(𝑋𝑡
𝑍𝑡
) = 𝑍𝑡
𝑋𝑡
[
𝑑𝑋𝑡
𝑍𝑡
−𝑋𝑡
𝑍2
𝑡
𝑑𝑍𝑡+ 1
2!
(
2𝑋𝑡
𝑍3
𝑡
)
(𝑑𝑍𝑡)2 −𝑑𝑋𝑡𝑑𝑍𝑡
𝑍2
𝑡
+ …
]
= 𝑑𝑋𝑡
𝑋𝑡
−𝑑𝑍𝑡
𝑍𝑡
+
(𝑑𝑍𝑡
𝑍𝑡
)2
−
(𝑑𝑋𝑡
𝑋𝑡
) (𝑑𝑍𝑡
𝑍𝑡
)
+ …

6.2.1 Path-Independent Options
553
and by substituting 𝑑𝑋𝑡∕𝑋𝑡, 𝑑𝑍𝑡∕𝑍𝑡and using It¯o’s lemma
𝑑
(𝑋𝑡
𝑍𝑡
)
(𝑋𝑡
𝑍𝑡
) = (𝑟−𝐷𝑥+ 𝜌𝑥𝑦𝜎𝑥𝜎𝑧)𝑑𝑡+ 𝜌𝑥𝑦𝜎𝑥𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
−(𝑟−𝐷𝑦+ 𝜎2
𝑧)𝑑𝑡−𝜎𝑧𝑑𝑊
𝑦
𝑡+ 𝜎2
𝑧𝑑𝑡−𝜌𝑥𝑦𝜎𝑥𝜎𝑧𝑑𝑡
= (𝐷𝑧−𝐷𝑥)𝑑𝑡+ (𝜌𝑥𝑦𝜎𝑥−𝜎𝑧)𝑑𝑊
𝑦
𝑡+ 𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
.
To find the distribution of 𝑋𝑡∕𝑍𝑡we note that
𝑑
(
log
(𝑋𝑡
𝑍𝑡
))
=
𝑑
(𝑋𝑡
𝑍𝑡
)
(𝑋𝑡
𝑍𝑡
) −1
2!
⎡
⎢
⎢
⎢
⎢⎣
𝑑
(𝑋𝑡
𝑍𝑡
)
(𝑋𝑡
𝑍𝑡
)
⎤
⎥
⎥
⎥
⎥⎦
2
+ …
=
(
𝐷𝑧−𝐷𝑥−1
2𝜎2)
𝑑𝑡+ (𝜌𝑥𝑦𝜎𝑥−𝜎𝑧)𝑑𝑊
𝑦
𝑡
+𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑡
where 𝜎=
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑧+ 𝜎2
𝑧.
Since we are assuming 𝐷𝑧and 𝜎𝑧to be constants and taking integrals
∫
𝑇
𝑡
𝑑
(
log
(𝑋𝑢
𝑍𝑢
))
= ∫
𝑇
𝑡
(
𝐷𝑧−𝐷𝑥−1
2𝜎2)
𝑑𝑢+ ∫
𝑇
𝑡
(𝜌𝑥𝑦𝜎𝑥−𝜎𝑧)𝑑𝑊
𝑦
𝑢
+ ∫
𝑇
𝑡
𝜎𝑥
√
1 −𝜌2
𝑥𝑦𝑑̂
𝑊𝑦⊥
𝑢
or
log
(𝑋𝑇
𝑍𝑇
)
= log
(𝑋𝑡
𝑍𝑡
)
+
(
𝐷𝑧−𝐷𝑥−1
2𝜎2)
(𝑇−𝑡) + (𝜌𝑥𝑦𝜎𝑥−𝜎𝑧)𝑊
𝑦
𝑇−𝑡
+𝜎𝑥
√
1 −𝜌2
𝑥𝑦̂
𝑊𝑦⊥
𝑇−𝑡.
Because 𝑊
𝑦
𝑇−𝑡, ̂
𝑊𝑦⊥
𝑇−𝑡∼(0, 𝑇−𝑡) and 𝑊
𝑦
𝑇−𝑡⟂⟂̂
𝑊𝑦⊥
𝑇−𝑡, hence
log
(𝑋𝑇
𝑍𝑇
)
∻
[
log
(𝑋𝑡
𝑍𝑡
)
+
(
𝐷𝑧−𝐷𝑥−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
.

554
6.2.1 Path-Independent Options
Finally, by analogy with a European call price formula we can deduce Kirk’s approxima-
tion formula
𝐶𝑠𝑝(𝑋𝑡, 𝑌𝑡, 𝑡; 𝐾, 𝑇) = 𝑍𝑡𝑒−𝐷𝑧(𝑇−𝑡)𝔼ℚ𝑍
[
max
{𝑋𝑇
𝑍𝑇
−1, 0
}|||||
ℱ𝑡
]
≈𝑍𝑡𝑒−𝐷𝑧(𝑇−𝑡)
[𝑋𝑡
𝑍𝑡
𝑒−(𝐷𝑥−𝐷𝑧)(𝑇−𝑡)Φ(𝑑+) −Φ(𝑑−)
]
= 𝑋𝑡𝑒−𝐷𝑥(𝑇−𝑡)Φ(𝑑+)
−
(
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡))
𝑒
−
(
𝐷𝑦𝑌𝑡
𝑌𝑡+𝐾𝑒−𝑟(𝑇−𝑡)
)
(𝑇−𝑡)
Φ(𝑑−)
where 𝑑± =
log
(
𝑋𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡)
)
+
(
𝐷𝑦𝑌𝑡
𝑌𝑡+ 𝐾𝑒−𝑟(𝑇−𝑡) −𝐷𝑥± 1
2𝜎2
)
(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
8. Spread Option II. Let {𝑊(1)
𝑡
: 𝑡≥0} and {𝑊(2)
𝑡
: 𝑡≥0} be ℙ-standard Wiener processes
on the probability space (Ω, ℱ, ℙ) and let the asset prices 𝑆(1)
𝑡
and 𝑆(2)
𝑡
follow ABMs of
the form
𝑑𝑆(1)
𝑡
= (𝜇1 −𝐷1)𝑑𝑡+ 𝜎1𝑑𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝜇2 −𝐷2)𝑑𝑡+ 𝜎2𝑑𝑊(2)
𝑡
𝑑𝑊(1)
𝑡
⋅𝑑𝑊(2)
𝑡
= 𝜌𝑑𝑡
where 𝜇1 and 𝜇2 are the drifts, 𝐷1 and 𝐷2 are the continuous dividend yields, 𝜎1 and 𝜎2 are
the volatilities, 𝜌∈(−1, 1) is the correlation coefficient and let 𝑟be the risk-free interest
rate from a money-market account.
Using It¯o’s lemma show that under the risk-neutral measure ℚfor 𝑇> 𝑡, the conditional
distribution of 𝑆(2)
𝑇
−𝑆(1)
𝑇
given 𝑆(1)
𝑡
and 𝑆(2)
𝑡
is
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| 𝑆(1)
𝑡, 𝑆(2)
𝑡
∼(𝑚, 𝑠2)
where
𝑚= 𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡) −𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡)
and
𝑠2 =
𝜎2
1
2(𝑟−𝐷1)
[𝑒2(𝑟−𝐷1)(𝑇−𝑡) −1] +
𝜎2
2
2(𝑟−𝐷2)
[𝑒2(𝑟−𝐷2)(𝑇−𝑡) −1]
−
2𝜌𝜎1𝜎2
2𝑟−𝐷1 −𝐷2
[𝑒(2𝑟−𝐷1−𝐷2)(𝑇−𝑡) −1] .

6.2.1 Path-Independent Options
555
Using the risk-neutral valuation approach show that for a strike price 𝐾> 0, the price of
a call spread option at time 𝑡< 𝑇with payoff
Ψ(𝑆(1)
𝑇, 𝑆(2)
𝑇) = max{𝑆(2)
𝑇
−𝑆(1)
𝑇
−𝐾, 0}
is
𝐶𝑠𝑝(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) =
(
𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡) −𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡))
Φ (𝑑) + 𝜎Φ′(𝑑)
where
𝑑=
𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡) −𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
𝜎
𝜎2 =
𝜎2
1
2(𝑟−𝐷1)
[𝑒−2𝐷1(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)] +
𝜎2
2
2(𝑟−𝐷2)
[𝑒−2𝐷2(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)]
−
2𝜌𝜎1𝜎2
2𝑟−𝐷1 −𝐷2
[𝑒−(𝐷1+𝐷2)(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)]
and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the standard normal cdf.
Solution: Under the risk-neutral measure ℚ,
𝑑𝑆(1)
𝑡
= (𝑟−𝐷1)𝑆(1)
𝑡𝑑𝑡+ 𝜎1𝑑̃
𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝑟−𝐷2)𝑆(2)
𝑡𝑑𝑡+ 𝜎2𝑑̃
𝑊(2)
𝑡
where ̃
𝑊(1)
𝑡
= 𝑊(1)
𝑡
+
(
𝜇1 −𝑟𝑆(1)
𝑡
𝜎1
)
𝑡and ̃
𝑊(2)
𝑡
= 𝑊(2)
𝑡
+
(
𝜇2 −𝑟𝑆(2)
𝑡
𝜎2
)
𝑡are ℚ-
standard Wiener processes (see Problem 4.2.3.7, Problems and Solutions in Mathematical
Finance, Volume 1: Stochastic Calculus).
From Problem 2.2.2.8 (page 109) we can easily show that for 𝑡< 𝑇,
𝑆(1)
𝑇
= 𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡) + 𝜎1 ∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢
and
𝑆(2)
𝑇
= 𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡) + 𝜎2 ∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(2)
𝑢.

556
6.2.1 Path-Independent Options
Thus,
𝔼ℚ(
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| ℱ𝑡
)
= 𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡) −𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡)
and
Varℚ(
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| ℱ𝑡
)
= Varℚ(
𝑆(1)
𝑇
||| ℱ𝑡
)
+ Varℚ(
𝑆(2)
𝑇
||| ℱ𝑡
)
−2Covℚ(
𝑆(1)
𝑇, 𝑆(2)
𝑇
||| ℱ𝑡
)
= 𝜎2
1𝔼ℚ
[(
∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢
)2||||||
ℱ𝑡
]
+𝜎2
2𝔼ℚ
[(
∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(2)
𝑢
)2||||||
ℱ𝑡
]
−2𝜎1𝜎2Covℚ
[
∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢, ∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(2)
𝑢
|||||
ℱ𝑡
]
= 𝜎2
1𝔼ℚ
[
∫
𝑇
𝑡
𝑒2(𝑟−𝐷1)(𝑇−𝑢)𝑑𝑢
|||||
ℱ𝑡
]
+ 𝜎2
2𝔼ℚ
[
∫
𝑇
𝑡
𝑒2(𝑟−𝐷2)(𝑇−𝑢)𝑑𝑢
|||||
ℱ𝑡
]
−2𝜎1𝜎2Covℚ
[
∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢, ∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(2)
𝑢
|||||
ℱ𝑡
]
.
By setting
𝑑̃
𝑊(2)
𝑡
= 𝜌𝑑̃
𝑊(1)
𝑡
+
√
1 −𝜌2𝑑̂
𝑊(1)
𝑡
so that 𝑑̂
𝑊(1)
𝑡
⋅𝑑̃
𝑊(1)
𝑡
= 0, then
Varℚ(
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| ℱ𝑡
)
= 𝜎2
1𝔼ℚ
[
∫
𝑇
𝑡
𝑒2(𝑟−𝐷1)(𝑇−𝑢)𝑑𝑢
|||||
ℱ𝑡
]
+ 𝜎2
2𝔼ℚ
[
∫
𝑇
𝑡
𝑒2(𝑟−𝐷2)(𝑇−𝑢)𝑑𝑢
|||||
ℱ𝑡
]
−2𝜎1𝜎2Covℚ
[
∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢,

6.2.1 Path-Independent Options
557
𝜌∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢
+
√
1 −𝜌2
∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̂
𝑊(1)
𝑢
|||||
ℱ𝑡
]
= 𝜎2
1 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷1)(𝑇−𝑢)𝑑𝑢+ 𝜎2
2 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷2)(𝑇−𝑢)𝑑𝑢
−2𝜌𝜎1𝜎2𝔼ℚ
[
∫
𝑇
𝑡
𝑒(𝑟−𝐷1)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢
⋅∫
𝑇
𝑡
𝑒(𝑟−𝐷2)(𝑇−𝑢)𝑑̃
𝑊(1)
𝑢
|||||
ℱ𝑡
]
= 𝜎2
1 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷1)(𝑇−𝑢)𝑑𝑢+ 𝜎2
2 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷2)(𝑇−𝑢)𝑑𝑢
−2𝜌𝜎1𝜎2𝔼ℚ
[
∫
𝑇
𝑡
𝑒(2𝑟−𝐷1−𝐷2)(𝑇−𝑢)𝑑𝑢
]
= 𝜎2
1 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷1)(𝑇−𝑢)𝑑𝑢+ 𝜎2
2 ∫
𝑇
𝑡
𝑒2(𝑟−𝐷2)(𝑇−𝑢)𝑑𝑢
−2𝜌𝜎1𝜎2 ∫
𝑇
𝑡
𝑒(2𝑟−𝐷1−𝐷2)(𝑇−𝑢)𝑑𝑢.
Solving the integrals, we have
Varℚ(
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| ℱ𝑡
)
=
𝜎2
1
2(𝑟−𝐷1)
[𝑒2(𝑟−𝐷1)(𝑇−𝑡) −1]
+
𝜎2
2
2(𝑟−𝐷2)
[𝑒2(𝑟−𝐷2)(𝑇−𝑡) −1]
−
2𝜌𝜎1𝜎2
2𝑟−𝐷1 −𝐷2
[𝑒(2𝑟−𝐷1−𝐷2)(𝑇−𝑡) −1] .
Since
𝑆(1)
𝑇
||| 𝑆(1)
𝑡
∼
(
𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡),
𝜎2
1
2(𝑟−𝐷1)
[𝑒2(𝑟−𝐷1)(𝑇−𝑡) −1]
)
and
𝑆(2)
𝑇
||| 𝑆(2)
𝑡
∼
(
𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡),
𝜎2
2
2(𝑟−𝐷2)
[𝑒2(𝑟−𝐷2)(𝑇−𝑡) −1]
)
therefore
𝑆(2)
𝑇
−𝑆(1)
𝑇
||| 𝑆(1)
𝑡, 𝑆(2)
𝑡
∼(𝑚, 𝑠2)
where
𝑚= 𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡) −𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡)

558
6.2.1 Path-Independent Options
and
𝑠2 =
𝜎2
1
2(𝑟−𝐷1)
[𝑒2(𝑟−𝐷1)(𝑇−𝑡) −1] +
𝜎2
2
2(𝑟−𝐷2)
[𝑒2(𝑟−𝐷2)(𝑇−𝑡) −1]
−
2𝜌𝜎1𝜎2
2𝑟−𝐷1 −𝐷2
[𝑒(2𝑟−𝐷1−𝐷2)(𝑇−𝑡) −1] .
Using the same steps as described in Problem 2.2.2.8 (page 109), we can easily show that
the call spread option price at time 𝑡< 𝑇is
𝐶𝑠𝑝(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝑆(2)
𝑇
−𝑆(1)
𝑇
−𝐾, 0}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) [
(𝑚−𝐾)Φ
(𝑚−𝐾
𝑠
)
+ 𝑠Φ′ (𝑚−𝐾
𝑠
)]
=
(
𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡) −𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡))
Φ (𝑑)
+𝜎Φ′(𝑑)
where
𝑑=
𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡) −𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
𝜎
and
𝜎2 =
𝜎2
1
2(𝑟−𝐷1)
[𝑒−2𝐷1(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)] +
𝜎2
2
2(𝑟−𝐷2)
[𝑒−2𝐷2(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)]
−
2𝜌𝜎1𝜎2
2𝑟−𝐷1 −𝐷2
[𝑒−(𝐷1+𝐷2)(𝑇−𝑡) −𝑒−2𝑟(𝑇−𝑡)] .
9. Rainbow Option I. Let 𝑋∼(𝜇𝑥, 𝜎2
𝑥) and 𝑌∼(𝜇𝑦, 𝜎2
𝑦) be jointly normally distributed
with correlation coefficient 𝜌𝑥𝑦∈(−1, 1). If 𝑍= min{𝑋, 𝑌} show that the probability
density function (pdf) of 𝑍is
𝑓𝑍(𝑧) = Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) + Φ
⎛
⎜
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑥+
𝜌𝑥𝑦𝜎𝑥
𝜎𝑦
(𝑧−𝜇𝑦)
𝜎𝑥
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟
⎟⎠
𝑓𝑌(𝑧)
where 𝑓𝑋(𝑧) =
1
𝜎𝑥
√
2𝜋
𝑒
−1
2
( 𝑧−𝜇𝑥
𝜎𝑥
)2
, 𝑓𝑌(𝑧) =
1
𝜎𝑦
√
2𝜋
𝑒
−1
2
(
𝑧−𝜇𝑦
𝜎𝑦
)2
and Φ denotes the
cumulative distribution function of a standard normal.

6.2.1 Path-Independent Options
559
Hence, show that
𝔼[max {𝑒𝑍−𝐾, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+𝑒𝜇𝑦+ 1
2 𝜎2
𝑦𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝐾
⎡
⎢
⎢
⎢⎣
𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+ 𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
where 𝐾> 0, 𝔼denotes the expectation with respect to 𝑒𝑍distribution and 𝚽denotes the
cumulative distribution function of a standard bivariate normal distribution given as
𝚽(𝑢, 𝑣, 𝜌𝑢𝑣) = ∫
𝑢
−∞∫
𝑣
−∞
1
2𝜋
√
1 −𝜌2
𝑢𝑣
𝑒
−
1
2(1−𝜌2𝑢𝑣) (𝑥2−2𝜌𝑢𝑣𝑥𝑦+𝑦2)
𝑑𝑦𝑑𝑥
where 𝜌𝑢𝑣∈(−1, 1).
Let the asset prices 𝑆(1)
𝑡
and 𝑆(2)
𝑡
have the following diffusion processes
𝑑𝑆(1)
𝑡
= (𝜇1 −𝐷1)𝑆(1)
𝑡𝑑𝑡+ 𝜎1𝑆(1)
𝑡𝑑𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝜇2 −𝐷2)𝑆(2)
𝑡𝑑𝑡+ 𝜎2𝑆(2)
𝑡𝑑𝑊(2)
𝑡
𝑑𝑊(1)
𝑡
⋅𝑑𝑊(2)
𝑡
= 𝜌𝑑𝑡
where {𝑊(1)
𝑡
: 𝑡≥0} and {𝑊(2)
𝑡
: 𝑡≥0} are ℙ-standard Wiener processes on the proba-
bility space (Ω, ℱ, ℙ), 𝜇1 and 𝜇2 are the drift parameters, 𝐷1 and 𝐷2 are the continuous
dividend yields, 𝜎1 and 𝜎2 are the volatilities, 𝜌∈(−1, 1) is the correlation coefficient and
let 𝑟be the risk-free interest rate from a money market account.
Show that (𝑊(1)
𝑡
, 𝑊(2)
𝑡
) follows a bivariate normal distribution.
Given the payoff of a rainbow call on the minimum option is defined as
Ψ(𝑆(1)
𝑇, 𝑆(2)
𝑇) = max
{
min{𝑆(1)
𝑇, 𝑆(2)
𝑇} −𝐾, 0
}
where 𝐾> 0 is the strike price, 𝑇≥𝑡is the option expiry time, using the above results find
the rainbow call on the minimum option price at time 𝑡under the risk-neutral measure ℚ.

560
6.2.1 Path-Independent Options
Solution: The first part of the results follows from Problem 1.2.2.15 of Problems and
Solutions in Mathematical Finance, Volume 1: Stochastic Calculus.
To calculate the closed-form solution of
𝔼[max {𝑒𝑍−𝐾, 0}]
where 𝑍= min{𝑋, 𝑌}, 𝑋∼(𝜇𝑥, 𝜎2
𝑥), 𝑌∼(𝜇𝑦, 𝜎2
𝑦), 𝐶𝑜𝑣(𝑋, 𝑌) = 𝜌𝑥𝑦𝜎𝑥𝜎𝑦, 𝜌𝑥𝑦∈
(−1, 1) and 𝐾> 0, the expectation can be written as
𝔼[max {𝑒𝑍−𝐾, 0}] = ∫
+∞
−∞
max {𝑒𝑧−𝐾, 0} 𝑓𝑍(𝑧)𝑑𝑧
where 𝑓𝑍(𝑧) is the pdf of 𝑍.
By substituting the pdf of 𝑍we have
𝔼[max {𝑒𝑍−𝐾, 0}] = ∫
+∞
log 𝐾
(𝑒𝑧−𝐾) 𝑓𝑍(𝑧) 𝑑𝑧
= ∫
+∞
log 𝐾
(𝑒𝑧−𝐾) Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) 𝑑𝑧
+ ∫
+∞
log 𝐾
(𝑒𝑧−𝐾) Φ
⎛
⎜
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑥+
𝜌𝑥𝑦𝜎𝑥
𝜎𝑦
(𝑧−𝜇𝑦)
𝜎𝑥
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟
⎟⎠
𝑓𝑌(𝑧) 𝑑𝑧
= 𝐴1 + 𝐴2 −𝐵1 −𝐵2
where
𝐴1 = ∫
+∞
log 𝐾
𝑒𝑧Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) 𝑑𝑧
𝐴2 = ∫
+∞
log 𝐾
𝑒𝑧Φ
⎛
⎜
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑥+
𝜌𝑥𝑦𝜎𝑥
𝜎𝑦
(𝑧−𝜇𝑦)
𝜎𝑥
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟
⎟⎠
𝑓𝑌(𝑧) 𝑑𝑧
𝐵1 = 𝐾∫
+∞
log 𝐾
Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) 𝑑𝑧
𝐵2 = 𝐾∫
+∞
log 𝐾
Φ
⎛
⎜
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑥+
𝜌𝑥𝑦𝜎𝑥
𝜎𝑦
(𝑧−𝜇𝑦)
𝜎𝑥
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟
⎟⎠
𝑓𝑌(𝑧) 𝑑𝑧.

6.2.1 Path-Independent Options
561
For the case
𝐴1 = ∫
+∞
log 𝐾
𝑒𝑧Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) 𝑑𝑧
we let 𝑤= 𝑧−𝜇𝑥
𝜎𝑥
and therefore
𝐴1 = ∫
+∞
𝑤= log 𝐾−𝜇𝑥
𝜎𝑥
𝑒𝜇𝑥+𝑤𝜎𝑥Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑦−𝜇𝑥−𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 𝑤2𝑑𝑤
= ∫
+∞
𝑤= log 𝐾−𝜇𝑥
𝜎𝑥
𝑒𝜇𝑥+ 1
2 𝜎2
𝑥
⎛
⎜
⎜⎝∫
𝑦=
𝜇𝑦−𝜇𝑥−𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
⎞
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 (𝑤−𝜎𝑥)2𝑑𝑤.
Let 𝑣= 𝑤−𝜎𝑥and we then have
𝐴1 = ∫
+∞
𝑣= log 𝐾−𝜇𝑥−𝜎2𝑥
𝜎𝑥
𝑒𝜇𝑥+ 1
2 𝜎2
𝑥
⎛
⎜
⎜⎝∫
𝑦=
𝜇𝑦−𝜇𝑥−(𝑣+𝜎𝑥)(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
1
√
2𝜋
𝑒−1
2 𝑦2 𝑑𝑦
⎞
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 𝑣2𝑑𝑣
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥
∫
𝑣= 𝜇𝑥+𝜎2𝑥−log 𝐾
𝜎𝑥
−∞
∫
𝑦=
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−
𝑣(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
1
2𝜋𝑒−1
2
(𝑦2+𝑣2)
𝑑𝑦𝑑𝑣.
Let 𝑢= 𝑦+
𝑣(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
and by setting 𝜎2 = 𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦we will have
𝐴1 = 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥
∫
𝑣= 𝜇𝑥+𝜎2𝑥−log 𝐾
𝜎𝑥
−∞
∫
𝑢=
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
𝑓(𝑢, 𝑣) 𝑑𝑢𝑑𝑣
such that
𝑓(𝑢, 𝑣) = 1
2𝜋𝑒
−1
2
⎛
⎜
⎜⎝
𝑢2−
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
𝑢𝑣+
(
1+
(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)2
𝜎2𝑦(1−𝜌2𝑥𝑦)
)
𝑣2
⎞
⎟
⎟⎠
= 1
2𝜋𝑒
−1
2
(
𝜎2
𝜎2𝑦(1−𝜌2𝑥𝑦)
)⎛
⎜
⎜
⎜
⎜⎝
𝑢2
(
𝜎2
𝜎2𝑦(1−𝜌2𝑥𝑦)
) −
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)𝜎𝑦
√
1−𝜌2𝑥𝑦
𝜎2
𝑢𝑣+𝑣2
⎞
⎟
⎟
⎟
⎟⎠.

562
6.2.1 Path-Independent Options
By setting ̄𝑢=
𝑢
⎛
⎜
⎜
⎜⎝
𝜎
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
and ̄𝜌𝑥𝑦=
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
𝜎
we have
𝐴1 = 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥
∫
𝑣= 𝜇𝑥+𝜎2𝑥−log 𝐾
𝜎𝑥
−∞
∫
̄𝑢=
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎
−∞
𝑓(̄𝑢, 𝑣) 𝑑̄𝑢𝑑𝑣
where
𝑓(̄𝑢, 𝑣) = 1
2𝜋
⎛
⎜
⎜
⎜⎝
𝜎
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑒
−1
2
⎛
⎜
⎜⎝
𝜎
𝜎𝑦
√
1−𝜌2𝑥𝑦
⎞
⎟
⎟⎠
2(
̄𝑢2−
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎
̄𝑢𝑣+𝑣2)
=
1
2𝜋
√
1 −̄𝜌2
𝑥𝑦
𝑒
−
1
2(1−̄𝜌2𝑥𝑦) (̄𝑢2−2 ̄𝜌𝑥𝑦̄𝑢𝑣+𝑣2)
.
Hence,
𝐴1 = 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥+ 𝜎2
𝑦−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
.
Using the same techniques as discussed above we have
𝐴2 = 𝑒𝜇𝑦+ 1
2 𝜎2
𝑦𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
.
For the case
𝐵1 = 𝐾∫
+∞
log 𝐾
Φ
⎛
⎜
⎜
⎜⎝
−𝑧+ 𝜇𝑦+
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) 𝑑𝑧

6.2.1 Path-Independent Options
563
we let 𝑤= 𝑧−𝜇𝑥
𝜎𝑥
and therefore
𝐵1 = 𝐾∫
+∞
𝑤= log 𝐾−𝜇𝑥
𝜎𝑥
Φ
⎛
⎜
⎜
⎜⎝
𝜇𝑦−𝜇𝑥−𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 𝑤2𝑑𝑤
= 𝐾∫
+∞
𝑤= log 𝐾−𝜇𝑥
𝜎𝑥
⎛
⎜
⎜⎝∫
𝑦=
𝜇𝑦−𝜇𝑥−𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
1
√
2𝜋
𝑒−1
2 𝑦2 𝑑𝑦
⎞
⎟
⎟⎠
1
√
2𝜋
𝑒−1
2 𝑤2𝑑𝑤
= 𝐾∫
𝑤= 𝜇𝑥−log 𝐾
𝜎𝑥
−∞
∫
𝑦=
𝜇𝑦−𝜇𝑥
𝜎𝑦
√
1−𝜌2𝑥𝑦
−
𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
1
2𝜋𝑒−1
2
(𝑦2+𝑤2)
𝑑𝑦𝑑𝑤.
Let 𝑢= 𝑦+
𝑤(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
and by setting 𝜎2 = 𝜎2
𝑥+ 𝜎2
𝑦−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦we will have
𝐵1 = 𝐾∫
𝑤= 𝜇𝑥−log 𝐾
𝜎𝑥
−∞
∫
𝑢=
𝜇𝑦−𝜇𝑥
𝜎𝑦
√
1−𝜌2𝑥𝑦
−∞
𝑔(𝑢, 𝑤) 𝑑𝑢𝑑𝑤
such that
𝑔(𝑢, 𝑤) = 1
2𝜋𝑒
−1
2
⎛
⎜
⎜⎝
𝑢2−
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎𝑦
√
1−𝜌2𝑥𝑦
𝑢𝑤+
(
1+
(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)2
𝜎2𝑦(1−𝜌2𝑥𝑦)
)
𝑤2
⎞
⎟
⎟⎠
= 1
2𝜋𝑒
−1
2
(
𝜎2
𝜎2𝑦(1−𝜌2𝑥𝑦)
)⎛
⎜
⎜
⎜
⎜⎝
𝑢2
(
𝜎2
𝜎2𝑦(1−𝜌2𝑥𝑦)
) −
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)𝜎𝑦
√
1−𝜌2𝑥𝑦
𝜎2
𝑢𝑤+𝑤2
⎞
⎟
⎟
⎟
⎟⎠.
By setting ̄𝑢=
𝑢
⎛
⎜
⎜
⎜⎝
𝜎
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
and ̄𝜌𝑥𝑦=
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
𝜎
we have
𝐵1 = 𝐾∫
𝑤= 𝜇𝑥−log 𝐾
𝜎𝑥
−∞
∫
̄𝑢=
𝜇𝑦−𝜇𝑥
𝜎
−∞
𝑔(̄𝑢, 𝑤) 𝑑̄𝑢𝑑𝑤

564
6.2.1 Path-Independent Options
where
𝑔(̄𝑢, 𝑤) = 1
2𝜋
⎛
⎜
⎜
⎜⎝
𝜎
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑒
−1
2
⎛
⎜
⎜⎝
𝜎
𝜎𝑦
√
1−𝜌2𝑥𝑦
⎞
⎟
⎟⎠
2(
̄𝑢2−
2(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
𝜎
̄𝑢𝑤+𝑤2)
=
1
2𝜋
√
1 −̄𝜌2
𝑥𝑦
𝑒
−
1
2(1−̄𝜌2𝑥𝑦) (̄𝑢2−2 ̄𝜌𝑥𝑦̄𝑢𝑤+𝑤2)
.
Hence,
𝐵1 = 𝐾𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
.
In the same vein, we can also show
𝐵2 = 𝐾𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
.
Hence, by substituting 𝐴1, 𝐴2, 𝐵1 and 𝐵2 back to 𝔼[max {𝑒𝑍−𝐾, 0}] we have
𝔼[max {𝑒𝑍−𝐾, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+𝑒𝜇𝑦+ 1
2 𝜎2
𝑦𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝐾
⎡
⎢
⎢
⎢⎣
𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥−log 𝐾
𝜎𝑥
,
𝜇𝑦−𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+ 𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦−log 𝐾
𝜎𝑦
,
𝜇𝑥−𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
.

6.2.1 Path-Independent Options
565
Since 𝑊(1)
𝑡
, 𝑊(2)
𝑡
∼(0, 𝑡) with Cov(𝑊(1)
𝑡
, 𝑊(2)
𝑡
) = 𝜌𝑡then by expressing
𝑊(1)
𝑡
=
√
𝑡𝑍1
𝑊(2)
𝑡
=
√
𝑡
(
𝜌𝑍1 +
√
1 −𝜌2𝑍2
)
where 𝑍1, 𝑍2 ∼(0, 1) and 𝑍1 ⟂⟂𝑍2, therefore for constants 𝜃1 and 𝜃2,
𝔼
(
𝑒𝜃𝑊(1)
𝑡
+𝜃2𝑊(2)
𝑡
)
= 𝔼
[
𝑒𝜃1
√
𝑡𝑍1+𝜃2
√
𝑡(𝜌𝑍1+
√
1−𝜌2𝑍2)]
= 𝔼
[
𝑒(𝜃1
√
𝑡+𝜌𝜃2
√
𝑡)𝑍1+𝜃2
√
𝑡(1−𝜌2)𝑍2
]
= 𝔼
[
𝑒(𝜃1
√
𝑡+𝜌𝜃2
√
𝑡)𝑍1
]
⋅𝔼
[
𝑒𝜃2
√
𝑡(1−𝜌2)𝑍2
]
= 𝑒
1
2 (𝜃1
√
𝑡+𝜌𝜃2
√
𝑡)2 ⋅𝑒
1
2 𝜃2
2𝑡(1−𝜌2).
By setting 𝜽= (𝜃1, 𝜃2)𝑇and 𝚺=
⎡
⎢
⎢⎣
𝑡
1
2𝜌𝑡
1
2𝜌𝑡
𝑡
⎤
⎥
⎥⎦
we therefore have
𝔼
(
𝑒𝜃𝑊(1)
𝑡
+𝜃2𝑊(2)
𝑡
)
= 𝑒
1
2 𝜃2
1𝑡+𝜌𝜃1𝜃2𝑡+ 1
2 𝜃2
2𝑡
= 𝑒
1
2𝜽𝑇𝚺𝜽
which is the moment generating function of a bivariate normal distribution. Hence,
(𝑊(1)
𝑡
, 𝑊(2)
𝑡
) follows a bivariate normal distribution.
From the definition of a rainbow call on the minimum option at time 𝑡under risk-neutral
measure ℚ, we have
𝐶min(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝑇, 𝐾) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
min{𝑆(1)
𝑇, 𝑆(2)
𝑇} −𝐾, 0
}||||
ℱ𝑡
]
where
𝑑𝑆(1)
𝑡
= (𝑟−𝐷1)𝑆(1)
𝑡𝑑𝑡+ 𝜎1𝑆(1)
𝑡𝑑̃
𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝑟−𝐷2)𝑆(2)
𝑡𝑑𝑡+ 𝜎2𝑆(2)
𝑡𝑑̃
𝑊(2)
𝑡
𝑑̃
𝑊(1)
𝑡
⋅𝑑̃
𝑊(2)
𝑡
= 𝜌𝑑𝑡
such that ̃
𝑊(1)
𝑡
= 𝑊(1)
𝑡
+
(𝜇1 −𝑟
𝜎1
)
𝑡and ̃
𝑊(2)
𝑡
= 𝑊(2)
𝑡
+
(𝜇2 −𝑟
𝜎2
)
𝑡are ℚ-standard
Wiener processes.

566
6.2.1 Path-Independent Options
By setting 𝑆(1)
𝑇
= 𝑒log 𝑆(1)
𝑇and 𝑆(2)
𝑇
= 𝑒log 𝑆(2)
𝑇we can write
𝐶min(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
min
{
𝑒log 𝑆(1)
𝑇, 𝑒log 𝑆(2)
𝑇
}
−𝐾, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑒
min
{
log 𝑆(1)
𝑇,log 𝑆(2)
𝑇
}
−𝐾, 0
}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max {𝑒𝑍−𝐾, 0}||| ℱ𝑡
]
where 𝑍= min{𝑋, 𝑌}, 𝑋= 𝑒log 𝑆(1)
𝑇and 𝑌= 𝑒log 𝑆(2)
𝑇such that (log 𝑆(1)
𝑇, log 𝑆(2)
𝑇) follows
a bivariate normal distribution.
From It¯o’s formula we can show that
log 𝑆(1)
𝑇
∼
[
log 𝑆(1)
𝑡
+
(
𝑟−𝐷1 −1
2𝜎2
1
)
(𝑇−𝑡), 𝜎2
1(𝑇−𝑡)
]
log 𝑆(2)
𝑇
∼
[
log 𝑆(2)
𝑡
+
(
𝑟−𝐷2 −1
2𝜎2
2
)
(𝑇−𝑡), 𝜎2
2(𝑇−𝑡)
]
.
By setting
𝜇𝑥= log 𝑆(1)
𝑡
+
(
𝑟−𝐷1 −1
2𝜎2
1
)
(𝑇−𝑡)
𝜎2
𝑥= 𝜎2
1(𝑇−𝑡)
𝜇𝑦= log 𝑆(2)
𝑡
+
(
𝑟−𝐷2 −1
2𝜎2
2
)
(𝑇−𝑡)
𝜎2
𝑦= 𝜎2
2(𝑇−𝑡)
and after some algebraic manipulations we will have
𝑒𝜇𝑥+ 1
2 𝜎2
𝑥= 𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡)
𝑒𝜇𝑦+ 1
2 𝜎2
𝑦= 𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡)
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
=
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 + 1
2𝜎2
1)(𝑇−𝑡)
𝜎1
√
𝑇−𝑡
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
=
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 + 1
2𝜎2
2)(𝑇−𝑡)
𝜎2
√
𝑇−𝑡
𝜇𝑦−𝜇𝑥−𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(2)
𝑡∕𝑆(1)
𝑡) +
(
𝐷1 −𝐷2 −1
2(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
𝜇𝑥−𝜇𝑦−𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(1)
𝑡∕𝑆(2)
𝑡) +
(
𝐷2 −𝐷1 −1
2(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)

6.2.1 Path-Independent Options
567
𝜎𝑥−𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
𝜎1 −𝜌𝜎2
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
𝜎𝑦−𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
𝜎2 −𝜌𝜎1
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
𝜇𝑥−log 𝐾
𝜎𝑥
=
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 −1
2𝜎2
1)(𝑇−𝑡)
𝜎1(𝑇−𝑡)
𝜇𝑦−log 𝐾
𝜎𝑦
=
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 −1
2𝜎2
2)(𝑇−𝑡)
𝜎2(𝑇−𝑡)
𝜇𝑦−𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(2)
𝑡∕𝑆(1)
𝑡) +
(
𝐷1 −𝐷2 + 1
2(𝜎2
1 −𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
𝜇𝑥−𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(1)
𝑡∕𝑆(2)
𝑡) +
(
𝐷2 −𝐷1 + 1
2(𝜎2
2 −𝜎2
1)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
By setting 𝜎=
√
𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2
and substituting the above expressions into
𝐶min(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇), the rainbow call on the minimum option at time 𝑡, 𝑡< 𝑇is
therefore
𝐶min(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡)𝚽(𝛼(1)
+ , 𝛽+, 𝜌(1)) + 𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡)𝚽(𝛼(2)
+ , 𝛽−, 𝜌(2))
−𝐾𝑒−𝑟(𝑇−𝑡)𝚽(𝛼(1)
−, 𝛾+, 𝜌(1)) −𝐾𝑒−𝑟(𝑇−𝑡)𝚽(𝛼(2)
−, 𝛾−, 𝜌(2))
where
𝛼(1)
± =
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 ± 1
2𝜎2
1)(𝑇−𝑡)
𝜎1
√
𝑇−𝑡
,
𝛽± =
± log(𝑆(2)
𝑡∕𝑆(1)
𝑡) ± (𝐷1 −𝐷2 ∓1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
,
𝛼(2)
± =
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 ± 1
2𝜎2
2)(𝑇−𝑡)
𝜎2
√
𝑇−𝑡
,
𝛾± =
± log(𝑆(2)
𝑡∕𝑆(1)
𝑡) ± (𝐷1 −𝐷2 ± 1
2(𝜎2
1 −𝜎2
2))(𝑇−𝑡)
𝜎
√
𝑇−𝑡
,
𝜌(1) = 𝜎1 −𝜌𝜎2
𝜎
√
𝑇−𝑡
,
𝜌(2) = 𝜎2 −𝜌𝜎1
𝜎
√
𝑇−𝑡
.

568
6.2.1 Path-Independent Options
10. Rainbow Option II. Let 𝑋∼(𝜇𝑥, 𝜎2
𝑥) and 𝑌∼(𝜇𝑦, 𝜎2
𝑦) be jointly normally distributed
with correlation coefficient 𝜌𝑥𝑦∈(−1, 1). If 𝑍= max{𝑋, 𝑌} show that the pdf of 𝑍is
𝑓𝑍(𝑧) = Φ
⎛
⎜
⎜
⎜⎝
𝑧−𝜇𝑦−
𝜌𝑥𝑦𝜎𝑦
𝜎𝑥
(𝑧−𝜇𝑥)
𝜎𝑦
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟⎠
𝑓𝑋(𝑧) + Φ
⎛
⎜
⎜
⎜
⎜⎝
𝑧−𝜇𝑥−
𝜌𝑥𝑦𝜎𝑥
𝜎𝑦
(𝑧−𝜇𝑦)
𝜎𝑥
√
1 −𝜌2
𝑥𝑦
⎞
⎟
⎟
⎟
⎟⎠
𝑓𝑌(𝑧)
where 𝑓𝑋(𝑧) =
1
𝜎𝑥
√
2𝜋
𝑒
−1
2
( 𝑧−𝜇𝑥
𝜎𝑥
)2
, 𝑓𝑌(𝑧) =
1
𝜎𝑦
√
2𝜋
𝑒
−1
2
(
𝑧−𝜇𝑦
𝜎𝑦
)2
and Φ(⋅) denotes the cdf
of a standard normal.
Hence, show that
𝔼[max {𝑒𝑍−𝐾, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
,
−𝜇𝑦+ 𝜇𝑥+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑥+ 𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+𝑒𝜇𝑦+ 1
2 𝜎2
𝑦𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
,
−𝜇𝑥+ 𝜇𝑦+ 𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑦+ 𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝐾
⎡
⎢
⎢
⎢⎣
𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥−log 𝐾
𝜎𝑥
,
−𝜇𝑦+ 𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑥+ 𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+ 𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦−log 𝐾
𝜎𝑦
,
−𝜇𝑥+ 𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑦+ 𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
where 𝐾> 0, 𝔼denotes the expectation with respect to the 𝑒𝑍distribution and 𝚽denotes
the cumulative standard bivariate normal distribution function given as
𝚽(𝑢, 𝑣, 𝜌𝑢𝑣) = ∫
𝑢
−∞∫
𝑣
−∞
1
2𝜋
√
1 −𝜌2
𝑢𝑣
𝑒
−
1
2(1−𝜌2𝑢𝑣) (𝑥2−2𝜌𝑢𝑣𝑥𝑦+𝑦2)
𝑑𝑦𝑑𝑥
where 𝜌𝑢𝑣∈(−1, 1).

6.2.1 Path-Independent Options
569
Let the asset prices 𝑆(1)
𝑡
and 𝑆(2)
𝑡
have the following diffusion processes
𝑑𝑆(1)
𝑡
= (𝜇1 −𝐷1)𝑆(1)
𝑡𝑑𝑡+ 𝜎1𝑆(1)
𝑡𝑑𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝜇2 −𝐷2)𝑆(2)
𝑡𝑑𝑡+ 𝜎2𝑆(2)
𝑡𝑑𝑊(2)
𝑡
𝑑𝑊(1)
𝑡
⋅𝑑𝑊(2)
𝑡
= 𝜌𝑑𝑡
where {𝑊(1)
𝑡
: 𝑡≥0} and {𝑊(2)
𝑡
: 𝑡≥0} are ℙ-standard Wiener processes on the proba-
bility space (Ω, ℱ, ℙ), 𝜇1 and 𝜇2 are the drift parameters, 𝐷1 and 𝐷2 are the continuous
dividend yields, 𝜎1 and 𝜎2 are the volatilities, 𝜌∈(−1, 1) is the correlation coefficient and
let 𝑟be the risk-free interest rate from a money-market account.
Show that (𝑊(1)
𝑡
, 𝑊(2)
𝑡
) follows a bivariate normal distribution.
Given the payoff of a rainbow call on the maximum option is defined as
Ψ(𝑆(1)
𝑇, 𝑆(2)
𝑇) = max
{
max{𝑆(1)
𝑇, 𝑆(2)
𝑇} −𝐾, 0
}
where 𝐾> 0 is the strike price, 𝑇≥𝑡is the option expiry time, using the above results
find the rainbow call on the maximum option price at time 𝑡under the risk-neutral measure
ℚ.
Solution: The first part of the results follows from Problem 1.2.2.15 of Problems and
Solutions in Mathematical Finance, Volume 1: Stochastic Calculus.
Following Problem 6.2.1.9 (page 558), it can easily be shown that for 𝐾> 0
𝔼[max {𝑒𝑍−𝐾, 0}]
= 𝑒𝜇𝑥+ 1
2 𝜎2
𝑥𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
,
−𝜇𝑦+ 𝜇𝑥+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑥+ 𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+𝑒𝜇𝑦+ 1
2 𝜎2
𝑦𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
,
−𝜇𝑥+ 𝜇𝑦+ 𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑦+ 𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
−𝐾
⎡
⎢
⎢
⎢⎣
𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑥−log 𝐾
𝜎𝑥
,
−𝜇𝑦+ 𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑥+ 𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
+ 𝚽
⎛
⎜
⎜
⎜⎝
𝜇𝑦−log 𝐾
𝜎𝑦
,
−𝜇𝑥+ 𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
,
−𝜎𝑦+ 𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
.
To show that (𝑊(1)
𝑡
, 𝑊(2)
𝑡
) follows a bivariate normal distribution, see Problem 6.2.1.9
(page 558).

570
6.2.1 Path-Independent Options
The rainbow call on the maximum option at time 𝑡under the risk-neutral measure ℚis
defined as
𝐶max(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max{𝑆(1)
𝑇, 𝑆(2)
𝑇} −𝐾, 0
}||||
ℱ𝑡
]
where
𝑑𝑆(1)
𝑡
= (𝑟−𝐷1)𝑆(1)
𝑡𝑑𝑡+ 𝜎1𝑆(1)
𝑡𝑑̃
𝑊(1)
𝑡
𝑑𝑆(2)
𝑡
= (𝑟−𝐷2)𝑆(2)
𝑡𝑑𝑡+ 𝜎2𝑆(2)
𝑡𝑑̃
𝑊(2)
𝑡
𝑑̃
𝑊(1)
𝑡
⋅𝑑̃
𝑊(2)
𝑡
= 𝜌𝑑𝑡
such that ̃
𝑊(1)
𝑡
= 𝑊(1)
𝑡
+
(𝜇1 −𝑟
𝜎1
)
𝑡and ̃
𝑊(2)
𝑡
= 𝑊(2)
𝑡
+
(𝜇2 −𝑟
𝜎2
)
𝑡are ℚ-standard
Wiener processes.
By setting 𝑆(1)
𝑇
= 𝑒log 𝑆(1)
𝑇and 𝑆(2)
𝑇
= 𝑒log 𝑆(2)
𝑇we can write
𝐶max(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max
{
𝑒log 𝑆(1)
𝑇, 𝑒log 𝑆(2)
𝑇
}
−𝐾, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑒
max
{
log 𝑆(1)
𝑇,log 𝑆(2)
𝑇
}
−𝐾, 0
}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max {𝑒𝑍−𝐾, 0}||| ℱ𝑡
]
where 𝑍= max{𝑋, 𝑌}, 𝑋= 𝑒log 𝑆(1)
𝑇and 𝑌= 𝑒log 𝑆(2)
𝑇such that (log 𝑆(1)
𝑇, log 𝑆(2)
𝑇) follows
a bivariate normal distribution.
From It¯o’s formula we can easily show that
log 𝑆(1)
𝑇
∼
[
log 𝑆(1)
𝑡
+
(
𝑟−𝐷1 −1
2𝜎2
1
)
(𝑇−𝑡), 𝜎2
1(𝑇−𝑡)
]
log 𝑆(2)
𝑇
∼
[
log 𝑆(2)
𝑡
+
(
𝑟−𝐷2 −1
2𝜎2
2
)
(𝑇−𝑡), 𝜎2
2(𝑇−𝑡)
]
.
By setting
𝜇𝑥= log 𝑆(1)
𝑡
+
(
𝑟−𝐷1 −1
2𝜎2
1
)
(𝑇−𝑡)
𝜎2
𝑥= 𝜎2
1(𝑇−𝑡)
𝜇𝑦= log 𝑆(2)
𝑡
+
(
𝑟−𝐷2 −1
2𝜎2
2
)
(𝑇−𝑡)
𝜎2
𝑦= 𝜎2
2(𝑇−𝑡)

6.2.1 Path-Independent Options
571
and after some algebraic manipulations we have
𝑒𝜇𝑥+ 1
2 𝜎2
𝑥= 𝑆(1)
𝑡𝑒(𝑟−𝐷1)(𝑇−𝑡)
𝑒𝜇𝑦+ 1
2 𝜎2
𝑦= 𝑆(2)
𝑡𝑒(𝑟−𝐷2)(𝑇−𝑡)
𝜇𝑥+ 𝜎2
𝑥−log 𝐾
𝜎𝑥
=
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 + 1
2𝜎2
1)(𝑇−𝑡)
𝜎1
√
𝑇−𝑡
𝜇𝑦+ 𝜎2
𝑦−log 𝐾
𝜎𝑦
=
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 + 1
2𝜎2
2)(𝑇−𝑡)
𝜎2
√
𝑇−𝑡
−𝜇𝑦+ 𝜇𝑥+ 𝜎𝑥(𝜎𝑥−𝜌𝑥𝑦𝜎𝑦)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(1)
𝑡∕𝑆(2)
𝑡) −
(
𝐷1 −𝐷2 −1
2(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
−𝜇𝑥+ 𝜇𝑦+ 𝜎𝑦(𝜎𝑦−𝜌𝑥𝑦𝜎𝑥)
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(2)
𝑡∕𝑆(1)
𝑡) −
(
𝐷2 −𝐷1 −1
2(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
−𝜎𝑥+ 𝜌𝑥𝑦𝜎𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
−𝜎1 + 𝜌𝜎2
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
−𝜎𝑦+ 𝜌𝑥𝑦𝜎𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
−𝜎2 + 𝜌𝜎1
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
𝜇𝑥−log 𝐾
𝜎𝑥
=
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 −1
2𝜎2
1)(𝑇−𝑡)
𝜎1(𝑇−𝑡)
𝜇𝑦−log 𝐾
𝜎𝑦
=
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 −1
2𝜎2
2)(𝑇−𝑡)
𝜎2(𝑇−𝑡)
−𝜇𝑦+ 𝜇𝑥
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(1)
𝑡∕𝑆(2)
𝑡) −
(
𝐷1 −𝐷2 + 1
2(𝜎2
1 −𝜎2
2)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
−𝜇𝑥+ 𝜇𝑦
√
𝜎2
𝑥−2𝜌𝑥𝑦𝜎𝑥𝜎𝑦+ 𝜎2
𝑦
=
log(𝑆(2)
𝑡∕𝑆(1)
𝑡) −
(
𝐷2 −𝐷1 + 1
2(𝜎2
2 −𝜎2
1)
)
(𝑇−𝑡)
√
(𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2)(𝑇−𝑡)
.

572
6.2.1 Path-Independent Options
By setting 𝜎=
√
𝜎2
1 −2𝜌𝜎1𝜎2 + 𝜎2
2 and substituting the above expressions into the
option price 𝐶max(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇), the rainbow call on the maximum option at time 𝑡
is therefore
𝐶max(𝑆(1)
𝑡, 𝑆(2)
𝑡, 𝑡; 𝐾, 𝑇) = 𝑆(1)
𝑡𝑒−𝐷1(𝑇−𝑡)𝚽(𝛼(1)
+ , −𝛽+, −𝜌(1))
+𝑆(2)
𝑡𝑒−𝐷2(𝑇−𝑡)𝚽(𝛼(2)
+ , −𝛽−, −𝜌(2))
−𝐾𝑒−𝑟(𝑇−𝑡)𝚽(𝛼(1)
−, −𝛾+, −𝜌(1))
−𝐾𝑒−𝑟(𝑇−𝑡)𝚽(𝛼(2)
−, −𝛾−, −𝜌(2))
where
𝛼(1)
± =
log(𝑆(1)
𝑡∕𝐾) + (𝑟−𝐷1 ± 1
2𝜎2
1)(𝑇−𝑡)
𝜎1
√
𝑇−𝑡
𝛽± =
± log(𝑆(2)
𝑡∕𝑆(1)
𝑡) ± (𝐷1 −𝐷2 ∓1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛼(2)
± =
log(𝑆(2)
𝑡∕𝐾) + (𝑟−𝐷2 ± 1
2𝜎2
2)(𝑇−𝑡)
𝜎2
√
𝑇−𝑡
𝛾± =
± log(𝑆(2)
𝑡∕𝑆(1)
𝑡) ± (𝐷1 −𝐷2 ± 1
2(𝜎2
1 −𝜎2
2))(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝜌(1) = 𝜎1 −𝜌𝜎2
𝜎
√
𝑇−𝑡
𝜌(2) = 𝜎2 −𝜌𝜎1
𝜎
√
𝑇−𝑡
.
11. Black–Scholes Equation for Cross-Currency Option. Let (Ω, ℱ, ℙ) be a probability space
and let {𝑊𝑠
𝑡: 𝑡≥0} and {𝑊𝑥
𝑡: 𝑡≥0} be ℙ-standard Wiener processes such that 𝑑𝑊𝑠
𝑡⋅
𝑑𝑊𝑥
𝑡= 𝜌𝑑𝑡, 𝜌∈(−1, 1). Suppose that 𝑆𝑡denotes the asset price quoted in foreign cur-
rency having the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑠−𝐷𝑠) 𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠
𝑡
where 𝜇𝑠is the drift parameter, 𝐷𝑠is the continuous dividend yield, 𝜎𝑠is the volatility
parameter and let 𝑟𝑓denote the foreign risk-free interest rate. Let 𝑋𝑡be the foreign-to-
domestic exchange rate having the SDE
𝑑𝑋𝑡
𝑋𝑡
= 𝜇𝑥𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥
𝑡

6.2.1 Path-Independent Options
573
where 𝜇𝑥is the exchange rate drift, 𝜎𝑥is the exchange rate volatility parameter and let
𝑟𝑑be the domestic risk-free interest rate. Here, 𝑋𝑡𝑆𝑡is the foreign asset price quoted in
domestic currency.
By considering a hedging portfolio involving a cross-currency option 𝑉(𝑆𝑡, 𝑋𝑡, 𝑡)
denoted in domestic currency that can only be exercised at expiry time 𝑇, 𝑡≤𝑇, with
asset price 𝑋𝑡𝑆𝑡and exchange rate 𝑋𝑡, show that 𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) satisfies the two-dimensional
PDE
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝑟𝑑−𝑟𝑓)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝑟𝑑𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) = 0.
Solution: To eliminate both asset risk and exchange rate risk, at time 𝑡we let the value of
a portfolio Π𝑡be
Π𝑡= 𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) −Δ1(𝑋𝑡𝑆𝑡) −Δ2𝑋𝑡
where it involves buying one unit of cross-currency option 𝑉(𝑆𝑡, 𝑋𝑡, 𝑡), selling Δ1 units of
foreign assets 𝑋𝑡𝑆𝑡converted into domestic currency and selling Δ2 units of 𝑋𝑡. Since we
receive 𝐷𝑠𝑆𝑡𝑑𝑡for every asset held, and because we hold −Δ1𝑋𝑡𝑆𝑡, our portfolio changes
by an amount −Δ𝐷𝑠𝑋𝑡𝑆𝑡𝑑𝑡. In addition, given that 𝑋𝑡will also grow at the foreign risk-
free rate 𝑟𝑓, the change in portfolio Π𝑡is
𝑑Π𝑡= 𝑑𝑉−Δ1(𝑑(𝑋𝑡𝑆𝑡) + 𝐷𝑠𝑋𝑡𝑆𝑡𝑑𝑡) −Δ2(𝑑𝑋𝑡+ 𝑟𝑓𝑋𝑡𝑑𝑡)
= 𝑑𝑉−Δ1(𝑆𝑡𝑑𝑋𝑡+ 𝑋𝑡𝑑𝑆𝑡+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡𝑑𝑡+ 𝐷𝑠𝑋𝑡𝑆𝑡𝑑𝑡)
−Δ2(𝑑𝑋𝑡+ 𝑟𝑓𝑋𝑡𝑑𝑡)
where 𝑑(𝑋𝑡𝑆𝑡) = 𝑆𝑡𝑑𝑋𝑡+ 𝑋𝑡𝑑𝑆𝑡+ 𝑑𝑋𝑡𝑑𝑆𝑡and from It¯o’s lemma we can write
𝑑𝑋𝑡𝑑𝑆𝑡= 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡𝑑𝑡.
Expanding 𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) using Taylor’s theorem
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 𝜕𝑉
𝜕𝑋𝑡
𝑑𝑋𝑡
+1
2
[
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 𝜕2𝑉
𝜕𝑋2
𝑡
(𝑑𝑋𝑡)2 + 2 𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
(𝑑𝑋𝑡𝑑𝑆𝑡)
]
+ …
and by substituting 𝑑𝑆𝑡= (𝜇𝑠−𝐷𝑠
) 𝑆𝑡𝑑𝑡+ 𝜎𝑠𝑆𝑡𝑑𝑊𝑠
𝑡, 𝑑𝑋𝑡= 𝜇𝑥𝑋𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑑𝑊𝑥
𝑡and
subsequently applying It¯o’s lemma we have
𝑑𝑉=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝜇𝑠−𝐷𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜇𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡+ 𝜎𝑠𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑠
𝑡+ 𝜎𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
𝑑𝑊𝑥
𝑡.

574
6.2.1 Path-Independent Options
Substituting back into 𝑑Π𝑡and rearranging terms, we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ +1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝜇𝑠−𝐷𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜇𝑥𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−Δ1(𝜇𝑥+ 𝜇𝑠+ 𝜌𝜎𝑥𝜎𝑠)𝑋𝑡𝑆𝑡
−Δ2(𝜇𝑥+ 𝑟𝑓)𝑋𝑡
] 𝑑𝑡+ 𝜎𝑠
(
𝜕𝑉
𝜕𝑆𝑡
−Δ1𝑋𝑡
)
𝑆𝑡𝑑𝑊𝑠
𝑡
+𝜎𝑥
(
𝜕𝑉
𝜕𝑋𝑡
−Δ1𝑆𝑡−Δ2
)
𝑋𝑡𝑑𝑊𝑥
𝑡.
To eliminate the 𝑑𝑊𝑠
𝑡and 𝑑𝑊𝑥
𝑡terms we have
Δ1 = 1
𝑋𝑡
𝜕𝑉
𝜕𝑆𝑡
and Δ2 = 1
𝑋𝑡
(
𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
which leads to
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑓𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡.
Under the no-arbitrage condition the return on the amount Π𝑡invested in a risk-free interest
rate in domestic currency would see a growth of
𝑑Π𝑡= 𝑟𝑑Π𝑡𝑑𝑡
= 𝑟𝑑[𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) −Δ1(𝑋𝑡𝑆𝑡) −Δ2𝑋𝑡]𝑑𝑡
= 𝑟𝑑
[
𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) −𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡
and hence we have
𝑟𝑑Π𝑡𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑓𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡
𝑟𝑑
[
𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) −𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑓𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
]
𝑑𝑡

6.2.1 Path-Independent Options
575
and finally
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝑟𝑑−𝑟𝑓)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝑟𝑑𝑉(𝑆𝑡, 𝑋𝑡, 𝑡) = 0
which is a two-dimensional PDE.
12. Cross-Currency Option (PDE Approach). Let (Ω, ℱ, ℙ) be a probability space and let
{𝑊𝑠
𝑡: 𝑡≥0} and {𝑊𝑥
𝑡: 𝑡≥0} be ℙ-standard Wiener processes. Let 𝑆𝑡and 𝑋𝑡denote the
asset price quoted in foreign currency and the foreign-to-domestic exchange rate respec-
tively each having the following SDEs
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠
𝑡
𝑑𝑋𝑡
𝑋𝑡
= 𝜇𝑥𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥
𝑡
𝑑𝑊𝑠
𝑡⋅𝑑𝑊𝑥
𝑡= 𝜌𝑑𝑡,
𝜌∈(−1, 1)
where 𝜇𝑠is the asset drift parameter, 𝐷𝑠is the asset continuous dividend yield, 𝜎𝑠is
the asset volatility parameter, 𝜇𝑥is exchange rate drift, 𝜎𝑥is the exchange rate volatility
parameter and let 𝑟𝑓be the foreign risk-free interest rate and 𝑟𝑑be the domestic risk-free
interest rate.
For a strike price 𝐾> 0 and expiry time 𝑇, let 𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾, 𝑇) be the European-style
call option price at time 𝑡≤𝑇denoted in domestic currency satisfying the two-dimensional
partial differential equation
𝜕𝐶
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝐶
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕2𝐶
𝜕𝑋𝑡𝜕𝑆𝑡
+(𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ (𝑟𝑑−𝑟𝑓)𝑋𝑡
𝜕𝐶
𝜕𝑋𝑡
−𝑟𝑑𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾, 𝑇) = 0.
Using the above partial differentiation equation find the call option price at time 𝑡≤𝑇for
each of the payoffs at expiry time 𝑇:
(a) A Foreign Equity Option Converted to Domestic Currency
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋𝑇max{𝑆𝑇−𝐾𝑠, 0}
(b) A Foreign Equity Option Struck in Domestic Currency (or Compo Option)
Ψ(𝑆𝑇, 𝑋𝑇) = max{𝑋𝑇𝑆𝑇−̂
𝐾, 0}
(c) A Foreign Equity Option Struck in Pre-Determined Domestic Currency (or Quanto
Option)
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋max{𝑆𝑇−𝐾𝑠, 0}

576
6.2.1 Path-Independent Options
(d) An FX Option Denoted in Domestic Currency
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑆𝑇max{𝑋𝑇−𝐾𝑥, 0}
where at expiry time 𝑇, 𝑆𝑇is the asset price in foreign currency, 𝑋𝑇is the foreign-to-
domestic exchange rate, 𝐾𝑠is the strike price in foreign currency, ̂
𝐾is the strike price
in domestic currency, 𝐾𝑥is the strike price on the exchange rate and 𝑋is some pre-
determined fixed exchange rate.
Solution:
(a) For the payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋𝑇max{𝑆𝑇−𝐾𝑠, 0} we can set
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋𝑡𝑓(𝑆𝑡, 𝑡)
where 𝑓(𝑆𝑇, 𝑇) = max{𝑆𝑇−𝐾𝑠, 0}. With a change of variables we have
𝜕𝐶
𝜕𝑡= 𝑋𝑡
𝜕𝑓
𝜕𝑡;
𝜕𝐶
𝜕𝑆𝑡
= 𝑋𝑡
𝜕𝑓
𝜕𝑆𝑡
;
𝜕𝐶
𝜕𝑋𝑡
= 𝑓(𝑆𝑡, 𝑡)
𝜕2𝐶
𝜕𝑆2
𝑡
= 𝑋𝑡
𝜕2𝑓
𝜕𝑆2
𝑡
;
𝜕2𝐶
𝜕𝑋2
𝑡
= 0;
𝜕2𝐶
𝜕𝑋𝑡𝜕𝑆𝑡
= 𝜕𝑓
𝜕𝑆𝑡
and by substituting the above results into the two-dimensional partial differential equa-
tion we have
𝑋𝑡
𝜕𝑓
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡𝑋𝑡
𝜕2𝑓
𝜕𝑆2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕𝑓
𝜕𝑆𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑋𝑡𝑆𝑡
𝜕𝑓
𝜕𝑆𝑡
+(𝑟𝑑−𝑟𝑓)𝑋𝑡𝑓(𝑆𝑡, 𝑡) −𝑟𝑑𝑋𝑡𝑓(𝑆𝑡, 𝑡) = 0
or
𝜕𝑓
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2𝑓
𝜕𝑆2
𝑡
+ (𝑟𝑓−𝐷𝑠)𝑆𝑡
𝜕𝑓
𝜕𝑆𝑡
−𝑟𝑓𝑓(𝑆𝑡, 𝑡) = 0
which is a Black–Scholes equation with volatility 𝜎𝑠, foreign risk-free interest rate
𝑟𝑓and continuous dividend yield 𝐷𝑠. Given that 𝑓(𝑆𝑇, 𝑇) = max{𝑆𝑇−𝐾𝑠, 0} is a
European call option payoff therefore we can deduce that
𝑓(𝑆𝑡, 𝑡) = 𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑓(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑆𝑡∕𝐾𝑠) + (𝑟𝑓−𝐷𝑠± 1
2𝜎2
𝑠)(𝑇−𝑡)
𝜎𝑠
√
𝑇−𝑡
and Φ(⋅) is the cumulative distri-
bution function of a standard normal. Hence, the call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋𝑡
[𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑓(𝑇−𝑡)Φ(𝑑−)] .

6.2.1 Path-Independent Options
577
(b) For payoff Ψ(𝑆𝑇, 𝑋𝑇) = max{𝑋𝑇𝑆𝑇−̂
𝐾, 0} we define ̂𝑆𝑡= 𝑋𝑡𝑆𝑡and we consider
the option price at time 𝑡as
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑔( ̂𝑆𝑡, 𝑡)
where 𝑔( ̂𝑆𝑇, 𝑇) = max{𝑋𝑇𝑆𝑇−̂
𝐾, 0}. From the change of variables we can write
𝜕𝐶
𝜕𝑡= 𝜕𝑔
𝜕𝑡;
𝜕𝐶
𝜕𝑆𝑡
= 𝜕𝑔
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
= 𝑋𝑡
𝜕𝑔
𝜕̂𝑆𝑡
;
𝜕𝐶
𝜕𝑋𝑡
= 𝜕𝑔
𝜕̂𝑆𝑡
𝜕̂𝑆𝑡
𝜕𝑋𝑡
= 𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
𝑋𝑡
𝜕𝑔
𝜕̂𝑆𝑡
)
= 𝑋𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑆𝑡
= 𝑋2
𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
;
𝜕2𝐶
𝜕𝑋2
𝑡
=
𝜕
𝜕𝑋𝑡
(
𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
)
= 𝑆𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
𝜕̂𝑆
𝜕𝑋𝑡
= 𝑆2
𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
𝜕2𝐶
𝜕𝑋𝑡𝜕𝑆𝑡
=
𝜕
𝜕𝑋𝑡
(
𝑋𝑡
𝜕𝑔
𝜕̂𝑆𝑡
)
= 𝜕𝑔
𝜕̂𝑆𝑡
+ 𝑋𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
𝜕̂𝑆𝑡
𝜕𝑋𝑡
= 𝜕𝑔
𝜕̂𝑆𝑡
+ 𝑋𝑡𝑆𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
.
By substituting the above results into the two-dimensional partial differentiation equa-
tion we have
𝜕𝑔
𝜕𝑡+ 1
2𝜎2
𝑠(𝑋𝑡𝑆𝑡)2 𝜕2𝑔
𝜕̂𝑆2
𝑡
+ 1
2𝜎2
𝑥(𝑋𝑡𝑆𝑡)2 𝜕2𝑔
𝜕̂𝑆2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠(𝑋𝑡𝑆𝑡)2 𝜕2𝑔
𝜕̂𝑆2
𝑡
+(𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑋𝑡𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
+ (𝑟𝑑−𝑟𝑓)𝑋𝑡𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
−𝑟𝑑𝑔( ̂𝑆𝑡, 𝑡) = 0
or
𝜕𝑔
𝜕𝑡+ 1
2(𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠) ̂𝑆2
𝑡
𝜕2𝑔
𝜕̂𝑆2
𝑡
+ (𝑟𝑑−𝐷𝑠) ̂𝑆𝑡
𝜕𝑔
𝜕̂𝑆𝑡
−𝑟𝑑𝑔( ̂𝑆𝑡, 𝑡) = 0
which is a Black–Scholes equation with volatility 𝜎𝑔=
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠, domestic
risk-free interest rate 𝑟𝑑and continuous dividend yield 𝐷𝑠. Since
𝐶(𝑆𝑇, 𝑋𝑇, 𝑇; 𝐾𝑥, 𝑇) = 𝑔( ̂𝑆𝑇, 𝑇) = max{ ̂𝑆𝑇−̂
𝐾, 0}

578
6.2.1 Path-Independent Options
is the payoff of a European call option therefore the call option at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; ̂
𝐾, 𝑇) = ̂𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −̂
𝐾𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)
= 𝑋𝑡𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −̂
𝐾𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log((𝑋𝑡𝑆𝑡)∕̂
𝐾) + (𝑟𝑑−𝐷𝑠± 1
2𝜎2
𝑔)(𝑇−𝑡)
𝜎𝑔
√
𝑇−𝑡
and Φ(⋅) is the cumulative dis-
tribution function of a standard normal.
(c) For the payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋max{𝑆𝑇−𝐾𝑠, 0} we can write
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋ℎ(𝑆𝑡, 𝑡)
such that ℎ(𝑆𝑇, 𝑇) = max{𝑆𝑇−𝐾𝑠, 0}. Hence, we can express
𝜕𝐶
𝜕𝑡= 𝑋𝜕ℎ
𝜕𝑡;
𝜕𝐶
𝜕𝑆𝑡
= 𝑋𝜕ℎ
𝜕𝑆𝑡
;
𝜕𝐶
𝜕𝑋𝑡
= 0
𝜕2𝐶
𝜕𝑆2
𝑡
= 𝑋𝜕2𝐶
𝜕𝑆2
𝑡
;
𝜕2𝐶
𝜕𝑋2
𝑡
= 0;
𝜕2𝐶
𝜕𝑋𝑡𝜕𝑆𝑡
= 0.
By substituting the above expressions into the two-dimensional partial differentiation
equation we have
𝑋𝜕ℎ
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡𝑋𝜕2ℎ
𝜕𝑆2
𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡𝑋𝜕ℎ
𝜕𝑆𝑡
−𝑟𝑑𝑋ℎ(𝑆𝑡, 𝑡) = 0
or
𝜕ℎ
𝜕𝑡+ 1
2𝜎2
𝑠𝑆2
𝑡
𝜕2ℎ
𝜕𝑆2
𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡
𝜕ℎ
𝜕𝑆𝑡
−𝑟𝑑ℎ(𝑆𝑡, 𝑡) = 0
which is a Black–Scholes equation with volatility 𝜎𝑠, domestic risk-free interest rate
𝑟𝑑and continuous dividend yield 𝐷ℎ= 𝑟𝑑−𝑟𝑓+ 𝐷𝑠+ 𝜌𝜎𝑥𝜎𝑠. Given that
ℎ(𝑆𝑇, 𝑇) = max{𝑆𝑇−𝐾𝑠, 0}
is a European call option payoff therefore we can deduce that
ℎ(𝑆𝑡, 𝑡) = 𝑆𝑡𝑒−𝐷ℎ(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑆𝑡∕𝐾𝑠) + (𝑟𝑑−𝐷ℎ± 1
2𝜎2
𝑠)(𝑇−𝑡)
𝜎𝑠
√
𝑇−𝑡
and Φ(⋅) is the cumulative distri-
bution function of a standard normal. Hence, the call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋[𝑆𝑡𝑒−𝐷ℎ(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)] .

6.2.1 Path-Independent Options
579
(d) For payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑆𝑇max{𝑋𝑇−𝐾𝑥, 0} we can define
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑥, 𝑇) = 𝑆𝑡𝑢(𝑋𝑡, 𝑡)
where 𝑢(𝑋𝑇, 𝑇) = max{𝑋𝑇−𝐾𝑥, 0}. From the change of variables we can set
𝜕𝐶
𝜕𝑡= 𝑆𝑡
𝜕𝑢
𝜕𝑡;
𝜕𝐶
𝜕𝑆𝑡
= 𝑢(𝑋𝑡, 𝑡),
𝜕𝐶
𝜕𝑋𝑡
= 𝑆𝑡
𝜕𝑢
𝜕𝑋𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
= 0;
𝜕2𝐶
𝜕𝑋2
𝑡
= 𝑆𝑡
𝜕2𝑢
𝜕𝑋2
𝑡
,
𝜕2𝑢
𝜕𝑋𝑡𝜕𝑆𝑡
= 𝜕𝑢
𝜕𝑋𝑡
.
By substituting the above results into the two-dimensional partial differentiation equa-
tion we have
𝑆𝑡
𝜕𝑢
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡𝑆𝑡
𝜕2𝑢
𝜕𝑋2
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑋𝑡𝑆𝑡
𝜕𝑢
𝜕𝑋𝑡
+ (𝑟𝑓−𝐷𝑠−𝜌𝜎𝑥𝜎𝑠)𝑆𝑡𝑢(𝑋𝑡, 𝑡)
+(𝑟𝑑−𝑟𝑓)𝑋𝑡𝑆𝑡
𝜕𝑢
𝜕𝑋𝑡
−𝑟𝑑𝑆𝑡𝑢(𝑋𝑡, 𝑡) = 0
or
𝜕𝑢
𝜕𝑡+ 1
2𝜎2
𝑥𝑋2
𝑡
𝜕2𝑢
𝜕𝑋2
𝑡
+ (𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠) 𝜕𝑢
𝜕𝑋𝑡
−(𝑟𝑑−𝑟𝑓+ 𝐷𝑠+ 𝜌𝜎𝑥𝜎𝑠)𝑢(𝑋𝑡, 𝑡) = 0
which is a Black–Scholes equation with volatility 𝜎𝑥, risk-free interest rate 𝑟𝑢= 𝑟𝑑−
𝑟𝑓+ 𝐷𝑠+ 𝜌𝜎𝑥𝜎𝑠and continuous dividend yield 𝐷𝑠. Since
𝑢(𝑋𝑇, 𝑇) = max{𝑋𝑇−𝐾𝑥, 0}
is the payoff of a European call option therefore
𝑢(𝑋𝑡, 𝑡) = 𝑋𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑥𝑒−𝑟𝑢(𝑇−𝑡)Φ(𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝐾𝑥) + (𝑟𝑢−𝐷𝑠± 1
2𝜎2
𝑥)(𝑇−𝑡)
𝜎𝑥
√
𝑇−𝑡
and Φ(⋅) is the cumulative distri-
bution function of a standard normal. Hence, the call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑥, 𝑇) = 𝑆𝑡
[𝑋𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑥𝑒−𝑟𝑢(𝑇−𝑡)Φ(𝑑−)] .
13. Cross-Currency Option (Probabilistic Approach). Let (Ω, ℱ, ℙ) be a probability space
and let {𝑊𝑠
𝑡: 𝑡≥0} and {𝑊𝑥
𝑡: 𝑡≥0} be ℙ-standard Wiener processes. Let 𝑆𝑡and 𝑋𝑡

580
6.2.1 Path-Independent Options
denote the asset price quoted in foreign currency and the foreign-to-domestic exchange
rate respectively each having the following SDEs
𝑑𝑆𝑡
𝑆𝑡
= (𝜇𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠
𝑡
𝑑𝑋𝑡
𝑋𝑡
= 𝜇𝑥𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥
𝑡
𝑑𝑊𝑠
𝑡⋅𝑑𝑊𝑥
𝑡= 𝜌𝑑𝑡,
𝜌∈(−1, 1)
where 𝜇𝑠is the asset drift parameter, 𝐷𝑠is the asset continuous dividend yield, 𝜎𝑠is
the asset volatility parameter, 𝜇𝑥is exchange rate drift, 𝜎𝑥is the exchange rate volatility
parameter and let 𝑟𝑓be the foreign risk-free interest rate and 𝑟𝑑be the domestic risk-free
interest rate.
Show that under the domestic risk-neutral measure ℚ𝑑, the diffusion processes for the
exchange rate 𝑋𝑡, asset price denominated in foreign currency 𝑆𝑡, asset price denominated
in domestic currency 𝑋𝑡𝑆𝑡are
𝑑𝑋𝑡
𝑋𝑡
= (𝑟𝑑−𝑟𝑓)𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥𝑑
𝑡
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
𝑑(𝑋𝑡𝑆𝑡)
𝑋𝑡𝑆𝑡
= (𝑟𝑑−𝐷𝑠)𝑑𝑡+
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠𝑑𝑊𝑥𝑠𝑑
𝑡
where 𝑊𝑥𝑑
𝑡
, 𝑊𝑠𝑑
𝑡
and 𝑊𝑥𝑠𝑑
𝑡
are ℚ𝑑-standard Wiener processes.
Find the call option price at time 𝑡≤𝑇for each of the payoffs (denominated in domestic
currency) at expiry time 𝑇:
(a) A Foreign Equity Option Converted to Domestic Currency
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋𝑇max{𝑆𝑇−𝐾𝑠, 0}
(b) A Foreign Equity Option Struck in Domestic Currency (or Compo Option)
Ψ(𝑆𝑇, 𝑋𝑇) = max{𝑋𝑇𝑆𝑇−̂
𝐾, 0}
(c) A Foreign Equity Option Struck in Pre-Determined Domestic Currency (or Quanto
Option)
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋max{𝑆𝑇−𝐾𝑠, 0}
(d) An FX Option Denoted in Domestic Currency
Ψ(𝑆𝑇, 𝑋𝑇) = 𝑆𝑇max{𝑋𝑇−𝐾𝑥, 0}
where 𝑆𝑇is the asset price in foreign currency, 𝑋𝑇is the foreign-to-domestic exchange
rate, 𝐾𝑠is the strike price in foreign currency, ̂
𝐾is the strike price in domestic cur-
rency, 𝐾𝑥is the strike price on the exchange rate and 𝑋is some pre-determined fixed
exchange rate.

6.2.1 Path-Independent Options
581
Solution: To show the diffusion processes of 𝑋𝑡and 𝑋𝑡𝑆𝑡under the domestic risk-neutral
measure ℚ𝑑see Problems 4.2.3.15 and 4.2.3.17 of Problems and Solutions of Mathemat-
ical Finance, Volume 1: Stochastic Calculus.
For the case of asset price, let the diffusion process of 𝑆𝑡under ℚ𝑑-measure be
𝑑𝑆𝑡
𝑆𝑡
= 𝜇𝑑
𝑠𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
where 𝜇𝑑
𝑠is the drift and 𝑊𝑠𝑑
𝑡
is the ℚ𝑑-standard Wiener process.
Since under the ℚ𝑑measure
𝑑𝑋𝑡
𝑋𝑡
= (𝑟𝑑−𝑟𝑓)𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥𝑑
𝑡
𝑑(𝑋𝑡𝑆𝑡)
𝑋𝑡𝑆𝑡
= (𝑟𝑑−𝐷𝑠)𝑑𝑡+
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠𝑑𝑊𝑥𝑠𝑑
𝑡
where 𝑊𝑥𝑑
𝑡
and 𝑊𝑥𝑠𝑑
𝑡
are ℚ𝑑-standard Wiener processes, then from It¯o’s lemma,
𝑑(𝑋𝑡𝑆𝑡) = 𝑋𝑡𝑑𝑆𝑡+ 𝑆𝑡𝑑𝑋𝑡+ (𝑑𝑋𝑡)(𝑑𝑆𝑡)
= 𝜇𝑑
𝑠𝑋𝑡𝑆𝑡𝑑𝑡+ 𝜎𝑠𝑋𝑡𝑆𝑡𝑑𝑊𝑠𝑑
𝑡
+(𝑟𝑑−𝑟𝑓)𝑋𝑡𝑆𝑡𝑑𝑡+ 𝜎𝑥𝑋𝑡𝑆𝑡𝑑𝑊𝑥𝑑
𝑡
+ 𝜌𝜎𝑥𝜎𝑠𝑑𝑡
= (𝜇𝑑
𝑠+ 𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠)𝑋𝑡𝑆𝑡𝑑𝑡+
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠𝑋𝑡𝑆𝑡𝑑𝑊𝑥𝑠𝑑
𝑡
where 𝑊𝑥𝑠𝑑
𝑡
=
𝜎𝑥𝑊𝑥𝑑
𝑡
+ 𝜎𝑠𝑊𝑠𝑑
𝑡
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠
is a ℚ𝑑-standard Wiener process.
Hence, by comparing with
𝑑(𝑋𝑡𝑆𝑡)
𝑋𝑡𝑆𝑡
= (𝑟𝑑−𝐷𝑠)𝑑𝑡+
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠𝑑𝑊𝑥𝑠𝑑
𝑡
we can deduce
𝜇𝑑
𝑠= 𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠.
Thus, under the domestic risk-neutral measure ℚ𝑑
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡.
Denoting Φ(⋅) as the cumulative distribution function of a standard normal we note:
(a) For the payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋𝑇max{𝑆𝑇−𝐾𝑠, 0}, and since we can write
𝑋𝑇= 𝑋𝑡𝑒(𝑟𝑑−𝑟𝑓−1
2 𝜎2
𝑥)(𝑇−𝑡)+𝜎𝑥𝑊𝑥𝑑
𝑇−𝑡

582
6.2.1 Path-Independent Options
the call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇)
= 𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑[𝑋𝑇max{𝑆𝑇−𝐾𝑠, 0}|| ℱ𝑡
]
= 𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑
[
𝑋𝑡𝑒(𝑟𝑑−𝑟𝑓−1
2 𝜎2
𝑥)(𝑇−𝑡)+𝜎𝑥𝑊𝑥𝑑
𝑇−𝑡max{𝑆𝑇−𝐾𝑠, 0}
||||
ℱ𝑡
]
= 𝑋𝑡𝑒−𝑟𝑓(𝑇−𝑡)𝔼ℚ𝑑
[
𝑒−1
2 𝜎2
𝑥(𝑇−𝑡)+𝜎𝑥𝑊𝑥𝑑
𝑇−𝑡max{𝑆𝑇−𝐾𝑠, 0}
||||
ℱ𝑡
]
.
We define a new probability measure ̃ℚon the filtration ℱ𝑠, 0 ≤𝑠≤𝑡where we set
the Radon–Nikod´ym derivative as
𝑑̃ℚ
𝑑ℚ𝑑
|||||ℱ𝑡
= 𝑒−∫𝑡
0 (−𝜎𝑥)𝑑𝑊𝑥𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜎𝑥)2𝑑𝑢
where the process ̃
𝑊𝑥
𝑡= 𝑊𝑥𝑑
𝑡
−𝜎𝑥𝑡follows a ̃ℚ-standard Wiener process.
Since we can also write
𝑊𝑥𝑑
𝑡
= 𝜌𝑊𝑠𝑑
𝑡
+
√
1 −𝜌2𝑌𝑑
𝑡
where 𝑊𝑠𝑑
𝑡
and 𝑌𝑑
𝑡are ℚ𝑑-standard Wiener processes and 𝑊𝑠𝑑
𝑡
⟂⟂𝑌𝑑
𝑡, the Radon–
Nikod´ym derivative can be expressed as
𝑑̃ℚ
𝑑ℚ𝑑
|||||ℱ𝑡
= 𝑒−∫𝑡
0 (−𝜎𝑥)𝑑𝑊𝑥𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜎𝑥)2𝑑𝑢
= 𝑒−∫𝑡
0 (−𝜎𝑥)(𝜌𝑑𝑊𝑠𝑑
𝑡
+
√
1−𝜌2𝑑𝑌𝑑
𝑡)−1
2 ∫𝑡
0 (−𝜎𝑥)2𝑑𝑢
= 𝑒−∫𝑡
0 (−𝜌𝜎𝑥)𝑑𝑊𝑠𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜌𝜎𝑥)2𝑑𝑢⋅𝑒−∫𝑡
0 (−
√
1−𝜌2𝜎𝑥)𝑑𝑌𝑑
𝑢−1
2 ∫𝑡
0 (−
√
1−𝜌2𝜎𝑥)2𝑑𝑢
such that from the two-dimension Girsanov’s theorem
̃
𝑊𝑠
𝑡= 𝑊𝑠𝑑
𝑡
−𝜌𝜎𝑥𝑡
and
̃𝑌𝑡= 𝑌𝑑
𝑡−
√
1 −𝜌2𝜎𝑥𝑡
are ̃ℚ-standard Wiener process and ̃
𝑊𝑠
𝑡⟂⟂̃𝑌𝑡.
Thus, under the ̃ℚ-measure, the call option price is
𝑉(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋𝑡𝑒−𝑟𝑓(𝑇−𝑡)𝔼̃ℚ[max{𝑆𝑇−𝐾𝑠, 0}|| ℱ𝑡
]

6.2.1 Path-Independent Options
583
with the dynamics of 𝑆𝑡under the ̃ℚ-measure being
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠
(
𝑑̃
𝑊𝑠
𝑡+ 𝜌𝜎𝑥𝑑𝑡
)
= (𝑟𝑓−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑̃
𝑊𝑠
𝑡.
Hence, the call option price at time 𝑡≤𝑇is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋𝑡𝑒−𝑟𝑓(𝑇−𝑡)𝔼̃ℚ[max{𝑆𝑇−𝐾𝑠, 0}|| ℱ𝑡
]
= 𝑋𝑡
[𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑓(𝑇−𝑡)Φ(𝑑−)]
where
𝑑± =
log(𝑆𝑡∕𝐾𝑠) + (𝑟𝑓−𝐷𝑠± 1
2𝜎2
𝑠)(𝑇−𝑡)
𝜎𝑠
√
𝑇−𝑡
.
(b) For the payoff Ψ(𝑆𝑇, 𝑋𝑇) = max{𝑋𝑇𝑆𝑇−̂
𝐾, 0} which is denominated in domestic
currency, we note that the diffusion process 𝑋𝑡𝑆𝑡under the ℚ𝑑measure is
𝑑(𝑋𝑡𝑆𝑡)
𝑋𝑡𝑆𝑡
= (𝑟𝑑−𝐷𝑠)𝑑𝑡+
√
𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠𝑑𝑊𝑥𝑠𝑑
𝑡
where 𝑊𝑥𝑠𝑑
𝑡
is a ℚ𝑑-standard Wiener process.
Thus, the call option price of the foreign equity option struck in domestic currency
can be easily deduced as
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑
[
max
{
𝑋𝑇𝑆𝑇−̂
𝐾, 0
}||||
ℱ𝑡
]
= 𝑋𝑡𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −̂
𝐾𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log((𝑋𝑡𝑆𝑡)∕̂
𝐾) + (𝑟𝑑−𝐷𝑠± 1
2(𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠))(𝑇−𝑡)
√
(𝜎2
𝑥+ 2𝜌𝜎𝑥𝜎𝑠+ 𝜎2
𝑠)(𝑇−𝑡)
.
(c) For the quanto option payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑋max{𝑆𝑇−𝐾𝑠, 0}, under the domestic
risk-neutral measure ℚ𝑑, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡

584
6.2.1 Path-Independent Options
or
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑑−(𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠+ 𝐷𝑠))𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
= (𝑟𝑑−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
where 𝐷𝑠= 𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠+ 𝐷𝑠and 𝑊𝑠𝑑
𝑡
is a ℚ𝑑-standard Wiener process.
Because 𝑋is a fixed exchange rate, the call option price at time 𝑡can be deduced
as
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑠, 𝑇) = 𝑋𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑[max{𝑆𝑇−𝐾𝑠, 0}|| ℱ𝑡
]
= 𝑋
[
𝑆𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑠𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝑑−)
]
where
𝑑± =
log(𝑆𝑡∕𝐾𝑠) + (𝑟𝑑−𝐷𝑠± 1
2𝜎2
𝑠)(𝑇−𝑡)
𝜎𝑠
√
𝑇−𝑡
.
(d) For the terminal payoff Ψ(𝑆𝑇, 𝑋𝑇) = 𝑆𝑇max{𝑋𝑇−𝐾𝑥, 0} which is denominated in
the domestic currency, under the domestic risk-neutral measure ℚ𝑑, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠)𝑑𝑡+ 𝜎𝑠𝑑𝑊𝑠𝑑
𝑡
where 𝑊𝑠𝑑
𝑡
is the ℚ𝑑-standard Wiener process.
Thus, by solving the SDE for 𝑆𝑡we can write
𝑆𝑇= 𝑆𝑡𝑒(𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠−1
2 𝜎2
𝑥)(𝑇−𝑡)+𝜎𝑠𝑊𝑠𝑑
𝑇−𝑡
and the call option price at time 𝑡is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑥, 𝑇)
= 𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑[𝑆𝑇max{𝑋𝑇−𝐾𝑥, 0}|| ℱ𝑡
]
= 𝑒−𝑟𝑑(𝑇−𝑡)𝔼ℚ𝑑
[
𝑆𝑡𝑒(𝑟𝑓−𝜌𝜎𝑥𝜎𝑠−𝐷𝑠−1
2 𝜎2
𝑥)(𝑇−𝑡)+𝜎𝑠𝑊𝑠𝑑
𝑇−𝑡max{𝑋𝑇−𝐾𝑥, 0}||||
ℱ𝑡
]
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)𝔼ℚ𝑑
[
𝑒−1
2 𝜎2
𝑠(𝑇−𝑡)+𝜎𝑠𝑊𝑠𝑑
𝑇−𝑡max{𝑋𝑇−𝐾𝑥, 0}||||
ℱ𝑡
]
.
where 𝑟= 𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠+ 𝐷𝑠.

6.2.1 Path-Independent Options
585
We define a new probability measure ℚon the filtration ℱ𝑠, 0 ≤𝑠≤𝑡where we set
the Radon–Nikod´ym derivative as
𝑑ℚ
𝑑ℚ𝑑
|||||ℱ𝑡
= 𝑒−∫𝑡
0 (−𝜎𝑠)𝑑𝑊𝑠𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜎𝑠)2𝑑𝑢
where the process 𝑊
𝑠
𝑡= 𝑊𝑠𝑑
𝑡
−𝜎𝑠𝑡follows a ℚ-standard Wiener process.
Since we can also write
𝑊𝑠𝑑
𝑡
= 𝜌𝑊𝑥𝑑
𝑡
+
√
1 −𝜌2𝑍𝑑
𝑡
where 𝑊𝑥𝑑
𝑡
and 𝑍𝑑
𝑡are ℚ𝑑-standard Wiener processes and 𝑊𝑥𝑑
𝑡
⟂⟂𝑍𝑑
𝑡, the Radon–
Nikod´ym derivative can be expressed as
𝑑ℚ
𝑑ℚ𝑑
|||||ℱ𝑡
= 𝑒−∫𝑡
0 (−𝜎𝑠)𝑑𝑊𝑠𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜎𝑠)2𝑑𝑢
= 𝑒−∫𝑡
0 (−𝜎𝑠)(𝜌𝑑𝑊𝑥𝑑
𝑡
+
√
1−𝜌2𝑑𝑍𝑑
𝑡)−1
2 ∫𝑡
0 (−𝜎𝑠)2𝑑𝑢
= 𝑒−∫𝑡
0 (−𝜌𝜎𝑠)𝑑𝑊𝑥𝑑
𝑢
−1
2 ∫𝑡
0 (−𝜌𝜎𝑠)2𝑑𝑢⋅𝑒−∫𝑡
0 (−
√
1−𝜌2𝜎𝑠)𝑑𝑍𝑑
𝑢−1
2 ∫𝑡
0 (−
√
1−𝜌2𝜎𝑠)2𝑑𝑢
such that from the two-dimension Girsanov’s theorem
𝑊
𝑥
𝑡= 𝑊𝑥𝑑
𝑡
−𝜌𝜎𝑠𝑡
and
𝑍𝑡= 𝑍𝑑
𝑡−
√
1 −𝜌2𝜎𝑠𝑡
are ℚ-standard Wiener process and 𝑊
𝑥
𝑡⟂⟂𝑍𝑡.
Thus, under the ℚ-measure, the call option price is
𝑉(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑥, 𝑇) = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝐾𝑥, 0}|| ℱ𝑡
]
with the dynamics of 𝑋𝑡under the ℚ-measure being
𝑑𝑋𝑡
𝑋𝑡
= (𝑟𝑑−𝑟𝑓)𝑑𝑡+ 𝜎𝑥𝑑𝑊𝑥𝑑
𝑡
= (𝑟𝑑−𝑟𝑓)𝑑𝑡+ 𝜎𝑥
(
𝑑𝑊
𝑥
𝑡+ 𝜌𝜎𝑠𝑑𝑡
)
= (𝑟𝑑−𝑟𝑓+ 𝜌𝜎𝑥𝜎𝑠)𝑑𝑡+ 𝜎𝑥𝑑𝑊
𝑥
𝑡
= (𝑟−𝐷𝑠)𝑑𝑡+ 𝜎𝑥𝑑𝑊
𝑥
𝑡.

586
6.2.2 Path-Dependent Options
Hence, the call option price at time 𝑡≤𝑇is
𝐶(𝑆𝑡, 𝑋𝑡, 𝑡; 𝐾𝑥, 𝑇) = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑋𝑇−𝐾𝑥, 0}|| ℱ𝑡
]
= 𝑆𝑡
[
𝑋𝑡𝑒−𝐷𝑠(𝑇−𝑡)Φ(𝑑+) −𝐾𝑥𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
]
where
𝑑± =
log(𝑋𝑡∕𝐾𝑥) + (𝑟−𝐷𝑠± 1
2𝜎2
𝑥)(𝑇−𝑡)
𝜎𝑥
√
𝑇−𝑡
N.B. For terminal payoffs in (a) and (d), we can also express them as exchange option
payoffs and the solutions follow from applying the formula given in Problem 6.2.1.6
(page 543).
6.2.2
Path-Dependent Options
1. Forward Start Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.
A forward start call option gives the holder the right to buy at time 𝑇1 an at-the-money
European call option with an expiry date of 𝑇2 > 𝑇1, where the strike price 𝐾is set as
𝐾= 𝑆𝑇1. Hence, the payoff of this option at 𝑇2 is
Ψ(𝑆𝑇1, 𝑆𝑇2) = max{𝑆𝑇2 −𝑆𝑇1, 0}.
By considering 𝑇1 < 𝑡≤𝑇2, 𝑡= 𝑇1 and 𝑡< 𝑇1, show that the forward call option price is
𝐶𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡) [𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)]
𝑡≤𝑇1
𝑆𝑡𝑒−𝐷(𝑇2−𝑡)Φ(𝑑+) −𝑆𝑇1𝑒−𝑟(𝑇2−𝑡)Φ(𝑑−)
𝑇1 < 𝑡≤𝑇2
where
̄𝑑± =
(𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
, 𝑑± =
log(𝑆𝑡∕𝑆𝑇1) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
and
Φ(⋅) is the cdf of a standard normal.

6.2.2 Path-Dependent Options
587
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
For 𝑇1 < 𝑡≤𝑇2, as 𝑆𝑇1 is known then
𝐶𝑓𝑠
(𝑆𝑡, 𝑡; 𝑇1, 𝑇2
) = 𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
max{𝑆𝑇2 −𝑆𝑇1, 0}||| ℱ𝑡
]
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆𝑇1, 𝑇2)
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)Φ(𝑑+) −𝑆𝑇1𝑒−𝑟(𝑇2−𝑡)Φ(𝑑−)
which is a regular European call option price 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇2) with strike price 𝐾= 𝑆𝑇1
at expiry time 𝑇2 such that 𝑑± =
log(𝑆𝑡∕𝑆𝑇1) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
.
At 𝑡= 𝑇1, 𝑆𝑡= 𝑆𝑇1 and therefore
𝐶𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2) = 𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝑆𝑇1, 𝑇2)
= 𝑆𝑇1𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑆𝑇1𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)
= 𝑆𝑇1
[𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)]
where
̄𝑑± =
log(𝑆𝑇1∕𝑆𝑇1) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
=
(𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
.
Finally, for 𝑡< 𝑇1
𝐶𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2) = 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
𝐶𝑓𝑠(𝑆𝑇1, 𝑇1; 𝑇1, 𝑇2)||| ℱ𝑡
]
= 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
𝑆𝑇1
[𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)]||| ℱ𝑡
]
= 𝑒−𝑟(𝑇1−𝑡) [𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)] 𝔼ℚ[
𝑆𝑇1
||| ℱ𝑡
]
since ̄𝑑+ and ̄𝑑−do not depend on 𝑆𝑇1. From It¯o’s lemma
𝑆𝑇1 = 𝑆𝑡𝑒
(𝑟−𝐷−1
2 𝜎2)(𝑇1−𝑡)+𝜎𝑊ℚ
𝑇1−𝑡
therefore
𝔼ℚ[𝑆𝑇1|ℱ𝑡] = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇1−𝑡)
and hence
𝐶𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2) = 𝑆𝑡𝑒−𝐷(𝑇1−𝑡) [𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)] .

588
6.2.2 Path-Dependent Options
Collectively, we therefore have
𝐶𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡) [𝑒−𝐷(𝑇2−𝑇1)Φ( ̄𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̄𝑑−)]
𝑡≤𝑇1
𝑆𝑡𝑒−𝐷(𝑇2−𝑡)Φ(𝑑+) −𝑆𝑇1𝑒−𝑟(𝑇2−𝑡)Φ(𝑑−)
𝑇1 < 𝑡≤𝑇2.
N.B. Using similar arguments we can also show the forward start put option as
𝑃𝑓𝑠(𝑆𝑡, 𝑡; 𝑇1, 𝑇2)
=
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡) [𝑒−𝑟(𝑇2−𝑇1)Φ(−̄𝑑−) −𝑒−𝐷(𝑇2−𝑇1)Φ(−̄𝑑+)]
𝑡≤𝑇1
𝑆𝑇1𝑒−𝑟(𝑇2−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇2−𝑡)Φ(−𝑑+)
𝑇1 < 𝑡≤𝑇2.
2. Rachet/Cliquet Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, let 𝑟be the risk-free interest rate from a money-market account.
A rachet or cliquet option is a series of forward start options where at the end of a typical
leg, from 𝑇𝑖−1 to 𝑇𝑖the option allows the holder to “lock in” intermediate profits
max{𝑆𝑇𝑖−𝐾𝑖−1, 0} = max{𝑆𝑇𝑖−𝑆𝑇𝑖−1, 0}
which will be paid out at expiry time 𝑇where the strike 𝐾𝑖−1 is reset to the asset price
𝑆𝑇𝑖−1 at time 𝑇𝑖−1, 𝑇𝑖−1 < 𝑇𝑖.
We consider a 3-leg rachet call option with initial strike 𝐾0 at time 𝑇0. At time 𝑇1 > 𝑇0
the strike is reset to 𝐾1 = 𝑆𝑇1, which is the asset price at time 𝑇1. At time 𝑇2 > 𝑇1 the
strike is reset again to 𝐾2 = 𝑆𝑇2, which is the asset price at time 𝑇2. Finally, at the option
expiry time 𝑇> 𝑇2 the holder of the call rachet will receive the call payoff with strike
𝐾2 = 𝑆𝑇2 and “locked-in” amounts of max{𝑆𝑇1 −𝐾0, 0} and {𝑆𝑇2 −𝐾1, 0}.
From the above information
(a) Write down the overall payoff Ψ(𝑆𝑇) noting that the strike is being reset to the spot
price at each reset date.
(b) By working back from the expiry, determine the option price 𝐶𝑟𝑎(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇)
under the risk-neutral measure ℚ, for 𝑇0 < 𝑡≤𝑇1, 𝑇1 < 𝑡≤𝑇2 and 𝑇2 < 𝑡≤𝑇.
Solution:
(a) The overall payoff at expiry time 𝑇is given as
Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾2, 0} + max{𝐾2 −𝐾1, 0} + max{𝐾1 −𝐾0, 0}
= max{𝑆𝑇−𝑆𝑇2, 0} + max{𝑆𝑇2 −𝑆𝑇1, 0} + max{𝑆𝑇1 −𝐾0, 0}.

6.2.2 Path-Dependent Options
589
(b) Under the risk-neutral measure ℚ, the asset price 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑟is the risk-free interest rate and 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is the ℚ-standard
Wiener process.
For 𝑇2 < 𝑡≤𝑇, under the filtration ℱ𝑡the information at 𝑇1 and 𝑇2 is known, there-
fore we can write the option price as
𝐶𝑟𝑎
(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝑆𝑇−𝑆𝑇2, 0}||| ℱ𝑡
]
+𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝑆𝑇2 −𝑆𝑇1, 0}||| ℱ𝑡
]
+𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
max{𝑆𝑇1 −𝐾0, 0}||| ℱ𝑡
]
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆𝑇2, 𝑇) + 𝑒−𝑟(𝑇−𝑡)max{𝑆𝑇2 −𝑆𝑇1, 0}
+𝑒−𝑟(𝑇−𝑡)max{𝑆𝑇1 −𝐾0, 0}
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆𝑇2, 𝑇) is the European call option price with strike 𝑆𝑇2 and expiry
time 𝑇.
For 𝑇1 < 𝑡≤𝑇2, under the filtration ℱ𝑡the information up to 𝑇1 is known, therefore
we can write the payoff as
Ψ(𝑆𝑇2) = 𝐶𝑟𝑎(𝑆𝑇2, 𝑇2; 𝐾0, 𝑇1, 𝑇2, 𝑇)
= 𝐶𝑏𝑠(𝑆𝑇2, 𝑇2; 𝑆𝑇2, 𝑇) + 𝑒−𝑟(𝑇−𝑇2)max{𝑆𝑇2 −𝑆𝑇1, 0}
+𝑒−𝑟(𝑇−𝑇2)max{𝑆𝑇1 −𝐾0, 0}
and the option price at time 𝑇1 < 𝑡≤𝑇2 is
𝐶𝑟𝑎
(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇)
= 𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
Ψ(𝑆𝑇2)||| ℱ𝑡
]
= 𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
𝐶𝑏𝑠(𝑆𝑇2, 𝑇2; 𝑆𝑇2, 𝑇)||| ℱ𝑡
]
+𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
𝑒−𝑟(𝑇−𝑇2)max{𝑆𝑇2 −𝑆𝑇1, 0}||| ℱ𝑡
]
+𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
𝑒−𝑟(𝑇−𝑇2)max{𝑆𝑇1 −𝐾0, 0}||| ℱ𝑡
]
= 𝑒−𝑟(𝑇2−𝑡)𝔼ℚ[
𝑆𝑇2
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))||| ℱ𝑡
]
+𝑒−𝑟(𝑇−𝑇2)𝔼ℚ[
𝑒−𝑟(𝑇2−𝑡)max{𝑆𝑇2 −𝑆𝑇1, 0}||| ℱ𝑡
]
+𝑒−𝑟(𝑇2−𝑡)𝑒−𝑟(𝑇−𝑇2)max{𝑆𝑇1 −𝐾0, 0}

590
6.2.2 Path-Dependent Options
where
𝑑± =
log(𝑆𝑇2∕𝑆𝑇2) + (𝑟± 1
2𝜎2)(𝑇−𝑇2)
𝜎
√
𝑇−𝑇2
=
(𝑟± 1
2𝜎2)(𝑇−𝑇2)
𝜎
√
𝑇−𝑇2
.
Since 𝔼ℚ[
𝑆𝑇2
||| ℱ𝑡
]
= 𝑆𝑡𝑒𝑟(𝑇2−𝑡) and 𝑑± is independent of the filtration ℱ𝑡, we there-
fore have
𝐶𝑟𝑎(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇) = 𝑆𝑡
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))
+𝑒−𝑟(𝑇−𝑇2)𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆𝑇1, 𝑇2)
+𝑒−𝑟(𝑇−𝑡)max{𝑆𝑇1 −𝐾0, 0}
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆𝑇1, 𝑇2) is a European call option price with strike price 𝑆𝑇1 and expiry
time 𝑇2.
Finally, for 𝑇0 < 𝑡≤𝑇1 the payoff is
Ψ(𝑆𝑇1) = 𝐶𝑟𝑎(𝑆𝑇1, 𝑇1; 𝐾0, 𝑇1, 𝑇2, 𝑇)
= 𝑆𝑇1
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))
+𝑒−𝑟(𝑇−𝑇2)𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝑆𝑇1, 𝑇2) + 𝑒−𝑟(𝑇−𝑇1)max{𝑆𝑇1 −𝐾0, 0}
and the option price at time 𝑇0 < 𝑡≤𝑇1 is
𝐶𝑟𝑎
(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇)
= 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
Ψ(𝑆𝑇1)|ℱ𝑡
]
= 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
𝑆𝑇1
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))||| ℱ𝑡
]
+𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
𝑆𝑇1
(𝑒−𝐷(𝑇2−𝑇1)Φ( ̂𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̂𝑑−))||| ℱ𝑡
]
+𝑒−𝑟(𝑇1−𝑡)𝔼ℚ[
𝑒−𝑟(𝑇−𝑇1)max{𝑆𝑇1 −𝐾0, 0}|ℱ𝑡
]
where
̂𝑑± =
log(𝑆𝑇1∕𝑆𝑇1) + (𝑟± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
=
(𝑟± 1
2𝜎2) (𝑇2 −𝑇1
)
𝜎
√
𝑇2 −𝑇1
.

6.2.2 Path-Dependent Options
591
Since both 𝑑± and ̂𝑑± are independent of the filtration ℱ𝑡, and because 𝔼ℚ[
𝑆𝑇1
||| ℱ𝑡
]
=
𝑆𝑡𝑒𝑟(𝑇1−𝑡), therefore
𝐶𝑟𝑎(𝑆𝑡, 𝑡; 𝐾0, 𝑇1, 𝑇2, 𝑇) = 𝑆𝑡
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))
+𝑆𝑡
(𝑒−𝐷(𝑇2−𝑇1)Φ( ̂𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̂𝑑−))
+𝑒−𝑟(𝑇−𝑇1)𝔼ℚ[
𝑒−𝑟(𝑇1−𝑡)max{𝑆𝑇1 −𝐾0, 0}||| ℱ𝑡
]
= 𝑆𝑡
(𝑒−𝐷(𝑇−𝑇2)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑇2)Φ(𝑑−))
+𝑆𝑡
(𝑒−𝐷(𝑇2−𝑇1)Φ( ̂𝑑+) −𝑒−𝑟(𝑇2−𝑇1)Φ( ̂𝑑−))
+𝑒−𝑟(𝑇−𝑇1)𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾0, 𝑇1)
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾0, 𝑇1) is a European call option at time 𝑡with strike price 𝐾0 and
expiry time 𝑇1.
3. Compound Option I. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.
Consider a European call-on-a-call option price with payoff
Ψ(𝑆𝑇1) = max{𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0}
where on the first expiry date 𝑇1, the option holder has the right to buy the underlying
European call option worth
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝑆𝑇1𝑒−𝐷(𝑇2−𝑇1)Φ(𝑑+) −𝐾2𝑒−𝑟(𝑇2−𝑇1)Φ(𝑑−)
𝑑± =
log(𝑆𝑇1∕𝐾2) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
by paying the first strike price 𝐾1. Here the underlying European call option gives the
holder the right but not the obligation to buy the underlying asset by paying the second
strike price 𝐾2 at expiry date 𝑇2 ≥𝑇1.
Using the risk-neutral measure valuation, show that the European call-on-a-call option
price at time 𝑡≤𝑇1 ≤𝑇2 is
𝐶𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(𝛼+, 𝛽+, 𝜌) −𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(𝛼−, 𝛽−, 𝜌)
−𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(𝛼−)

592
6.2.2 Path-Dependent Options
where
𝛼± =
log(𝑆𝑡∕̃𝑆𝑇1) + (𝑟−𝐷± 1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
, 𝛽± =
log(𝑆𝑡∕𝐾2) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
,
𝜌=
√
𝑇1 −𝑡
𝑇2 −𝑡and ̃𝑆𝑇1 satisfies 𝐶𝑏𝑠( ̃𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝐾1, 𝚽(𝑥, 𝑦, 𝜌𝑥𝑦) is the cdf of a stan-
dard bivariate normal with correlation coefficient 𝜌𝑥𝑦∈(−1, 1) and Φ(𝑥) is the cdf of a
standard normal.
Finally, deduce the put-on-a-call option price at time 𝑡≤𝑇1 ≤𝑇2 with payoff
Ψ(𝑆𝑇1) = max{𝐾1 −𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0}.
Solution: Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s lemma we can
easily show for 𝑇> 𝑡
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
with density function
𝑓(𝑆𝑇|𝑆𝑡) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log(𝑆𝑇∕𝑆𝑡)−(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
.
By definition, the call-on-a-call option at time 𝑡≤𝑇1 ≤𝑇2 is
𝐶𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2)
= 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ
[
max
{
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇1−𝑡)
∫
∞
0
max
{
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0
}
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝑒−𝑟(𝑇1−𝑡)
∫
∞
̃𝑆𝑇1
[
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1
]
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝐴1 −𝐴2 −𝐴3

6.2.2 Path-Dependent Options
593
where ̃𝑆𝑇1 satisfies the equation 𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝐾1 and
𝐴1 = 𝑒−𝑟(𝑇1−𝑡)
∫
∞
̃𝑆𝑇1
𝑆𝑇1𝑒−𝐷(𝑇2−𝑇1)Φ(𝑑+)𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
𝐴2 = 𝑒−𝑟(𝑇1−𝑡)
∫
∞
̃𝑆𝑇1
𝐾2𝑒−𝑟(𝑇2−𝑇1)Φ(𝑑−)𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
𝐴3 = 𝐾1𝑒−𝑟(𝑇1−𝑡)
∫
∞
̃𝑆𝑇1
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1.
For the case
𝐴1 = 𝑒−𝑟(𝑇1−𝑡)−𝐷(𝑇2−𝑇1)
× ∫
∞
̃𝑆𝑇1
𝑆𝑇1Φ
(log(𝑆𝑇1∕𝐾2) + (𝑟−𝐷+ 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
)
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
and by setting 𝑥=
log(𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
we have
𝐴1 = 𝑆𝑡𝑒−𝑟(𝑇1−𝑡)−𝐷(𝑇2−𝑇1)+(𝑟−𝐷−1
2 𝜎2)(𝑇1−𝑡)
× ∫
∞
𝛼
Φ
(
𝑚+ 𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 (𝑥2−2𝑥𝜎
√
𝑇2−𝑡)𝑑𝑥
or
𝐴1 = 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
∞
𝛼
Φ
(
𝑚+ 𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 (𝑥−𝜎
√
𝑇1−𝑡)2𝑑𝑥
where
𝛼=
log( ̃𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
and
𝑚= log(𝑆𝑡∕𝐾2) + (𝑟−𝐷+ 1
2𝜎2)(𝑇2 −𝑇1) + (𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡).

594
6.2.2 Path-Dependent Options
By setting 𝑦= −(𝑥−𝜎
√
𝑇1 −𝑡) and from Problem 1.2.2.16 of Problems and Solutions in
Mathematical Finance, Volume 1: Stochastic Calculus we have
𝐴1 = −𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
−∞
𝛼+
Φ
(
𝑚+ 𝜎2(𝑇1 −𝑡) −𝑦𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
𝛼+
−∞
Φ
(
𝑚+ 𝜎2(𝑇1 −𝑡) −𝑦𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
𝛼+
−∞
Φ
(
𝛽+ −𝜌𝑦
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(𝛼+, 𝛽+, 𝜌)
where
𝛼+ =
log(𝑆𝑡∕̃𝑆𝑇1) + (𝑟−𝐷+ 1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
,
𝛽+ =
log(𝑆𝑡∕𝐾2) + (𝑟−𝐷+ 1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
and 𝜌=
√
𝑇1 −𝑡
𝑇2 −𝑡.
In contrast, for
𝐴2 = 𝐾2𝑒−𝑟(𝑇2−𝑡)
× ∫
∞
̃𝑆𝑇1
Φ
(log(𝑆𝑇1∕𝐾2) + (𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
)
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
and by setting 𝑥=
log(𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
we have
𝐴2 = 𝐾2𝑒−𝑟(𝑇2−𝑡)
× ∫
∞
−𝛼−
Φ
(log(𝑆𝑡∕𝐾2) + (𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑡) + 𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥
where 𝛼−=
log(𝑆𝑡∕̃𝑆𝑇1) + (𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
.
Setting 𝑦= −𝑥
𝐴2 = −𝐾2𝑒−𝑟(𝑇2−𝑡)
∫
−∞
𝛼−
Φ
(
𝛽−−𝜌𝑦
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝐾2𝑒−𝑟(𝑇2−𝑡)
∫
𝛼−
−∞
Φ
(
𝛽−−𝜌𝑦
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(𝛼−, 𝛽−, 𝜌)
where 𝛽−=
log(𝑆𝑡∕𝐾2) + (𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
.

6.2.2 Path-Dependent Options
595
Finally, because 𝑊ℚ
𝑇1−𝑡∼(0, 𝑇1 −𝑡) we have
𝐴3 = 𝐾1𝑒−𝑟(𝑇1−𝑡)
∫
∞
̃𝑆𝑇1
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑆𝑇1 > ̃𝑆𝑇1
||| 𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑆𝑡𝑒
(𝑟−𝐷−1
2 𝜎2)(𝑇1−𝑡)+𝜎𝑊ℚ
𝑇1−𝑡> ̃𝑆𝑇1
||||
𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑊ℚ
𝑇1−𝑡>
log( ̃𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
||||||
𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(𝛼−).
Thus, the call-on-a-call option price at time 𝑡≤𝑇1 ≤𝑇2 is
𝐶𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(𝛼+, 𝛽+, 𝜌) −𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(𝛼−, 𝛽−, 𝜌)
−𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(𝛼−).
For the case of a put-on-a-call option, the payoff at time 𝑇1 is
𝑃𝑐(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1) = max{𝐾1 −𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0}
whilst the payoff at time 𝑇1 for a call-on-a-call option is
𝐶𝑐(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1) = max{𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0}.
Hence,
𝐶𝑐(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2) −𝑃𝑐(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2)
=
⎧
⎪
⎨
⎪⎩
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1
if 𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) > 𝐾1
𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1
if 𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) ≤𝐾1
= 𝐶𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1.
By discounting the payoff back to time 𝑡under the risk-neutral measure ℚ, we have
𝐶𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) −𝑃𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾2, 𝑇2) −𝐾1𝑒−𝑟(𝑇1−𝑡)
or
𝑃𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝐶𝑐(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) −𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾2, 𝑇2) + 𝐾1𝑒−𝑟(𝑇1−𝑡).

596
6.2.2 Path-Dependent Options
4. Compound Option II. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.
Consider a European put-on-a-put option price with payoff
Ψ(𝑆𝑇1) = max{𝐾1 −𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0}
where on the first expiry date 𝑇1, the option holder has the right to sell the underlying
European put option
𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝐾2𝑒−𝑟(𝑇2−𝑇1)Φ(−𝑑−) −𝑆𝑇1𝑒−𝐷(𝑇2−𝑇1)Φ(−𝑑+)
𝑑± =
log(𝑆𝑇1∕𝐾2) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
at the first strike price 𝐾1. Here the underlying European put option gives the holder the
right but not the obligation to sell the underlying asset by receiving the second strike price
𝐾2 at expiry date 𝑇2 ≥𝑇1.
Using the risk-neutral measure valuation, show that the European put-on-a-put option
price at time 𝑡≤𝑇1 ≤𝑇2 is
𝑃𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(−𝛼−) −𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(−𝛼−, −𝛽−, 𝜌)
+𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(−𝛼+, −𝛽+, 𝜌)
where
𝛼± =
log(𝑆𝑡∕̂𝑆𝑇1) + (𝑟−𝐷± 1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
, 𝛽± =
log(𝑆𝑡∕𝐾2) + (𝑟−𝐷± 1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
,
𝜌=
√
𝑇1 −𝑡
𝑇2 −𝑡and ̂𝑆𝑇1 satisfies 𝑃𝑏𝑠( ̂𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝐾1, 𝚽(𝑥, 𝑦, 𝜌𝑥𝑦) is the cdf of a stan-
dard bivariate normal with correlation coefficient 𝜌𝑥𝑦∈(−1, 1) and Φ(𝑥) is the cdf of a
standard normal.
Finally, deduce the call-on-a-put option price at time 𝑡≤𝑇1 ≤𝑇2 with option payoff
Ψ(𝑆𝑇1) = max{𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0}.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Using It¯o’s lemma we can
easily show for 𝑇> 𝑡
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]

6.2.2 Path-Dependent Options
597
with density function
𝑓(𝑆𝑇|𝑆𝑡) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log(𝑆𝑇∕𝑆𝑡)−(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
.
By definition the put-on-a-put option at time 𝑡≤𝑇1 ≤𝑇2 is
𝑃𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2)
= 𝑒−𝑟(𝑇1−𝑡)𝔼ℚ
[
max
{
𝐾1 −𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇1−𝑡)
∫
∞
0
max
{
𝐾1 −𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0
}
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝑒−𝑟(𝑇1−𝑡)
∫
̂𝑆𝑇1
0
[
𝐾1 −𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2)
]
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝐵1 −𝐵2 + 𝐵3
where ̂𝑆𝑇1 satisfies the equation 𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) = 𝐾1 and
𝐵1 = 𝐾1𝑒−𝑟(𝑇1−𝑡)
∫
̂𝑆𝑇1
0
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
𝐵2 = 𝑒−𝑟(𝑇1−𝑡)
∫
̂𝑆𝑇1
0
𝐾2𝑒−𝑟(𝑇2−𝑇1)Φ(−𝑑−)𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
𝐵3 = 𝑒−𝑟(𝑇1−𝑡)
∫
̂𝑆𝑇1
0
𝑆𝑇1𝑒−𝐷(𝑇2−𝑇1)Φ(−𝑑+)𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1.
Given 𝑊ℚ
𝑇1−𝑡∼(0, 𝑇1 −𝑡) we have
𝐵1 = 𝐾1𝑒−𝑟(𝑇1−𝑡)
∫
̂𝑆𝑇1
0
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑆𝑇1 < ̂𝑆𝑇1
||| 𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑆𝑡𝑒
(𝑟−𝐷−1
2 𝜎2)(𝑇1−𝑡)+𝜎𝑊ℚ
𝑇1−𝑡< ̂𝑆𝑇1
||||
𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)ℚ
(
𝑊ℚ
𝑇1−𝑡<
log( ̂𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
||||||
𝑆𝑡
)
= 𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(−𝛼−)
where 𝛼−=
log(𝑆𝑡∕̂𝑆𝑇1) + (𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
.

598
6.2.2 Path-Dependent Options
As for the case
𝐵2 = 𝐾2𝑒−𝑟(𝑇2−𝑡)
× ∫
̂𝑆𝑇1
0
Φ
(−log(𝑆𝑇1∕𝐾2) −(𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
)
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
and by setting 𝑥=
log(𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
we have
𝐵2 = 𝐾2𝑒−𝑟(𝑇2−𝑡)
× ∫
−𝛼−
−∞
Φ
(log(𝐾2∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑡) −𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥.
By simplifying the integrands and from Problem 1.2.2.16 of Problems and Solutions in
Mathematical Finance, Volume 1: Stochastic Calculus we can write
𝐵2 = 𝐾2𝑒−𝑟(𝑇2−𝑡)
∫
−𝛼−
−∞
Φ
(
−𝛽−−𝜌𝑥
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑥2𝑑𝑥
= 𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(−𝛼−, −𝛽−, 𝜌)
where 𝛽−=
log(𝑆𝑡∕𝐾2) + (𝑟−𝐷−1
2𝜎2)(𝑇2 −𝑡)
𝜎
√
𝑇2 −𝑡
and 𝜌=
√
𝑇1 −𝑡
𝑇2 −𝑡.
Finally, for the case
𝐵3 = 𝑒−𝑟(𝑇1−𝑡)−𝐷(𝑇2−𝑇1)
× ∫
̂𝑆𝑇1
0
𝑆𝑇1Φ
(log(𝐾2∕𝑆𝑇1) −(𝑟−𝐷+ 1
2𝜎2)(𝑇2 −𝑇1)
𝜎
√
𝑇2 −𝑇1
)
𝑓(𝑆𝑇1|𝑆𝑡) 𝑑𝑆𝑇1
and by setting 𝑥=
log(𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
we have
𝐵3 = 𝑆𝑡𝑒−𝑟(𝑇1−𝑡)−𝐷(𝑇2−𝑇1)+(𝑟−𝐷−1
2 𝜎2)(𝑇1−𝑡)
× ∫
𝛼
−∞
Φ
(
𝑚+ 𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 (𝑥2−2𝑥𝜎
√
𝑇2−𝑡)𝑑𝑥
or
𝐵3 = 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
𝛼
−∞
Φ
(
𝑚−𝑥𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 (𝑥−𝜎
√
𝑇1−𝑡)2𝑑𝑥

6.2.2 Path-Dependent Options
599
where
𝛼=
log( ̃𝑆𝑇1∕𝑆𝑡) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡)
𝜎
√
𝑇1 −𝑡
𝑚= log(𝐾2∕𝑆𝑡) −(𝑟−𝐷+ 1
2𝜎2)(𝑇2 −𝑇1) −(𝑟−𝐷−1
2𝜎2)(𝑇1 −𝑡).
By setting 𝑦= 𝑥−𝜎
√
𝑇1 −𝑡we have
𝐵3 = 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
−𝛼+
−∞
Φ
(
𝑚−𝜎2(𝑇1 −𝑡) −𝑦𝜎
√
𝑇1 −𝑡
𝜎
√
𝑇2 −𝑇1
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)
∫
−𝛼+
−∞
Φ
(
−𝛽+ −𝜌𝑦
√
1 −𝜌2
)
1
√
2𝜋
𝑒−1
2 𝑦2𝑑𝑦
= 𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(−𝛼+, −𝛽+, 𝜌).
Thus, the put-on-a-put option price at time 𝑡≤𝑇1 ≤𝑇2 is
𝑃𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝐾1𝑒−𝑟(𝑇1−𝑡)Φ(−𝛼−) −𝐾2𝑒−𝑟(𝑇2−𝑡)𝚽(−𝛼−, −𝛽−, 𝜌)
+𝑆𝑡𝑒−𝐷(𝑇2−𝑡)𝚽(−𝛼+, −𝛽+, 𝜌).
For the case of a call-on-a-put option, the payoff at time 𝑇1 is
𝐶𝑝(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = max{𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1, 0}
whilst the payoff at time 𝑇1 for a put-on-a-put option is
𝑃𝑝(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = max{𝐾1 −𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2), 0}.
Hence,
𝐶𝑝(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2) −𝑃𝑝(𝑆𝑇1, 𝑇1; 𝐾1, 𝑇1, 𝐾2, 𝑇2)
=
⎧
⎪
⎨
⎪⎩
𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1
if 𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) > 𝐾1
𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1
if 𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) ≤𝐾1
= 𝑃𝑏𝑠(𝑆𝑇1, 𝑇1; 𝐾2, 𝑇2) −𝐾1.
By discounting the payoff back to time 𝑡under the risk-neutral measure ℚ, we have
𝐶𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) −𝑃𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾2, 𝑇2) −𝐾1𝑒−𝑟(𝑇1−𝑡)
or
𝐶𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) = 𝑃𝑝(𝑆𝑡, 𝑡; 𝐾1, 𝑇1, 𝐾2, 𝑇2) + 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾2, 𝑇2) −𝐾1𝑒−𝑟(𝑇1−𝑡).

600
6.2.2 Path-Dependent Options
5. Simple Chooser Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the proba-
bility space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.
A simple chooser option is an option contract whereby it gives the holder of the option
at a fixed time 𝜏, 𝑡≤𝜏≤𝑇the right but not the obligation to decide whether the contract
is a European call or put option with the following payoff
Ψ (𝑆𝜏
) = max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇), 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇)}
where 𝑆𝜏is the stock price at time 𝜏, 𝑇is the chooser option expiry time, 𝐾is the strike
price,
𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) = 𝑆𝜏𝑒−𝐷(𝑇−𝜏)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝜏)Φ(𝑑−)
and
𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) = 𝐾𝑒−𝑟(𝑇−𝜏)Φ(−𝑑−) −𝑆𝜏𝑒−𝐷(𝑇−𝜏)Φ(−𝑑+)
are the European call and put options at time 𝜏, respectively with
𝑑± =
log(𝑆𝜏∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝜏)
𝜎
√
𝑇−𝜏
and Φ(⋅) is the cdf of a standard normal.
Show that 𝑒−𝑟𝑡𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a martingale under the risk-neutral measure ℚ, where
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is the price of a European option at time 𝑡given as
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if payoff Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0}
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
if payoff Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0}.
Given the simple chooser option is valued at time 𝑡, 𝑡≤𝜏show using the put–call parity
that the payoff at intermediate time 𝜏can be expressed as
Ψ(𝑆𝜏) = 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏) max{ ̃
𝐾−𝑆𝜏, 0}
where ̃
𝐾= 𝐾𝑒−(𝑟−𝐷)(𝑇−𝜏).
Hence, show that the simple chooser option price at time 𝑡≤𝜏≤𝑇is
𝑉𝑠𝑐(𝑆𝑡, 𝑡; ̃
𝐾, 𝜏, 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏)𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̃
𝐾, 𝜏).

6.2.2 Path-Dependent Options
601
Solution: Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where
𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡
is
a
ℚ-standard
Wiener
process.
To
show
that
𝑒−𝑟𝑡𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a ℚ-martingale, see Problem 2.2.2.8 (page 109).
From the simple chooser payoff at time 𝜏≤𝑇
Ψ(𝑆𝜏) = max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇), 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇)}
and knowing the put–call parity at time 𝜏is
𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝜏) −𝑆𝜏𝑒−𝐷(𝑇−𝜏)
we can rewrite the payoff as
Ψ(𝑆𝜏) = max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇), 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝐾𝑒−𝑟(𝑇−𝜏) −𝑆𝜏𝑒−𝐷(𝑇−𝜏)}
= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + max{0, 𝐾𝑒−𝑟(𝑇−𝜏) −𝑆𝜏𝑒−𝐷(𝑇−𝜏)}
= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏) max{𝐾𝑒−(𝑟−𝐷)(𝑇−𝜏) −𝑆𝜏, 0}
= 𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏) max{ ̃
𝐾−𝑆𝜏, 0}
where ̃
𝐾= 𝐾𝑒−(𝑟−𝐷)(𝑇−𝜏).
Therefore, the price of a simple chooser option at time 𝑡≤𝜏≤𝑇is
𝑉𝑠𝑐(𝑆𝑡, 𝑡; ̃
𝐾, 𝜏, 𝐾, 𝑇) = 𝑒−𝑟(𝜏−𝑡)𝔼ℚ[Ψ(𝑆𝜏)|ℱ𝑡
]
= 𝑒−𝑟(𝜏−𝑡)
×𝔼ℚ[
𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏) max{ ̃
𝐾−𝑆𝜏, 0}||| ℱ𝑡
]
= 𝑒−𝑟(𝜏−𝑡) ⋅𝑒𝑟(𝜏−𝑡)𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇)
+𝑒−𝐷(𝑇−𝜏) ⋅𝑒−𝑟(𝜏−𝑡)𝔼ℚ[
max{ ̃
𝐾−𝑆𝜏, 0}||| ℱ𝑡
]
= 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑒−𝐷(𝑇−𝜏)𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̃
𝐾, 𝜏)
since 𝔼ℚ[𝑒−𝑟𝜏𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇)|| ℱ𝑡
] = 𝑒−𝑟𝑡𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a ℚ-martingale.
6. Complex Chooser Option. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the prob-
ability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.

602
6.2.2 Path-Dependent Options
A complex chooser option is an option contract whereby it gives the holder of the option
at a fixed time 𝜏, 𝑡≤𝜏≤min{𝑇𝑐, 𝑇𝑝} the right to decide whether the contract is a Euro-
pean call or put option of different time to expiry and strike prices with the following
payoff
Ψ (𝑆𝜏
) = max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐), 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑝, 𝑇𝑝)}
where 𝑆𝜏is the stock price at time 𝜏, 𝑇𝑐is the call option expiry time, 𝑇𝑝is the put option
expiry time, 𝐾𝑐is the call option strike, 𝐾𝑝is the put option strike so that
𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐) = 𝑆𝜏𝑒−𝐷(𝑇𝑐−𝜏)Φ(𝑑𝑐
+) −𝐾𝑐𝑒−𝑟(𝑇𝑐−𝜏)Φ(𝑑𝑐
−)
and
𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾, 𝑇𝑝) = 𝐾𝑝𝑒−𝑟(𝑇𝑝−𝜏)Φ(−𝑑𝑝
−) −𝑆𝜏𝑒−𝐷(𝑇𝑝−𝜏)Φ(−𝑑𝑝
+)
are the European call and put options at time 𝜏, respectively with
𝑑𝑐
± =
log(𝑆𝜏∕𝐾𝑐) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑐−𝜏)
𝜎
√
𝑇𝑐−𝜏
, 𝑑𝑝
± =
log(𝑆𝜏∕𝐾𝑝) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑝−𝜏)
𝜎√𝑇𝑝−𝜏
and Φ(⋅) is the cdf of a standard normal.
Show that under the risk-neutral measure ℚ, the complex chooser option price at time
𝑡≤𝜏is
𝑉𝑐𝑐(𝑆𝑡, 𝑡; 𝜏, 𝐾𝑐, 𝑇𝑐, 𝐾𝑝, 𝑇𝑝) = 𝑆𝑡𝑒−𝐷(𝑇𝑐−𝑡)𝚽(𝛼+, 𝛽+, 𝜌𝑐)
−𝐾𝑐𝑒−𝑟(𝑇𝑐−𝑡)𝚽(𝛼−, 𝛽−, 𝜌𝑐)
+𝐾𝑝𝑒−𝑟(𝑇𝑝−𝑡)𝚽(−𝛼−, −𝛾−, 𝜌𝑝)
−𝑆𝑡𝑒−𝐷(𝑇𝑝−𝑡)𝚽(−𝛼+, −𝛾+, 𝜌𝑝)
where
𝛼± =
log(𝑆𝑡∕𝑋) + (𝑟−𝐷± 1
2𝜎2)(𝜏−𝑡)
𝜎
√
𝜏−𝑡
, 𝛽± =
log(𝑆𝑡∕𝐾𝑐) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑐−𝑡)
𝜎
√
𝑇𝑐−𝑡
,
𝛾± =
log(𝑆𝑡∕𝐾𝑝) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑝−𝑡)
𝜎√𝑇𝑝−𝑡
, 𝜌𝑐=
√
𝜏−𝑡
𝑇𝑐−𝑡, 𝜌𝑝=
√
𝜏−𝑡
𝑇𝑝−𝑡, 𝑋solves the
equation 𝐶𝑏𝑠(𝑋, 𝜏; 𝐾𝑐, 𝑇𝑐) = 𝑃𝑏𝑠(𝑋, 𝜏; 𝐾𝑝, 𝑇𝑝) and 𝚽(𝑢, 𝑣, 𝜌𝑢𝑣) is the cdf of a standard
bivariate normal with correlation coefficient 𝜌𝑢𝑣∈(−1, 1).
Solution: Under the risk-neutral measure ℚ, the asset price 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡

6.2.2 Path-Dependent Options
603
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. From It¯o’s lemma we can
easily show for 𝑇> 𝑡
log
(𝑆𝑇
𝑆𝑡
)
∼
[(
𝑟−𝐷−1
2𝜎2)
(𝑇−𝑡), 𝜎2(𝑇−𝑡)
]
with density function
𝑓(𝑆𝑇|𝑆𝑡) =
1
𝑆𝑇𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
log(𝑆𝑇∕𝑆𝑡)−(𝑟−𝐷−1
2 𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
.
By definition, the complex chooser option price at time 𝑡, 𝑡≤𝜏≤min{𝑇𝑐, 𝑇𝑝} is
𝑉𝑐𝑐(𝑆𝑡, 𝑡; 𝜏, 𝐾𝑐, 𝑇𝑐, 𝐾𝑝, 𝑇𝑝)
= 𝑒−𝑟(𝜏−𝑡)𝔼ℚ[
max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐), 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑝, 𝑇𝑝)}||| ℱ𝑡
]
= 𝑒−𝑟(𝜏−𝑡)
∫
∞
0
max{𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐), 𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑝, 𝑇𝑝)}𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏.
Let 𝑋solve the nonlinear equation 𝐶𝑏𝑠(𝑋, 𝜏; 𝐾𝑐, 𝑇𝑐) = 𝑃𝑏𝑠(𝑋, 𝜏; 𝐾𝑝, 𝑇𝑝), then we can
rewrite
𝑉𝑐𝑐(𝑆𝑡, 𝑡; 𝜏, 𝐾𝑐, 𝑇𝑐, 𝐾𝑝, 𝑇𝑝) = 𝑒−𝑟(𝜏−𝑡)
∫
𝑋
0
𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑝, 𝑇𝑝)𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
+𝑒−𝑟(𝜏−𝑡)
∫
∞
𝑋
𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐)𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏.
From Problem 6.2.2.3 (page 591) we can deduce that
𝑒−𝑟(𝜏−𝑡)
∫
∞
𝑋
𝐶𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑐, 𝑇𝑐)𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
= 𝑒−𝑟(𝜏−𝑡)
∫
∞
𝑋
𝑆𝜏𝑒−𝐷(𝑇𝑐−𝜏)Φ (𝑑𝑐
+
) 𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
−𝑒−𝑟(𝜏−𝑡)
∫
∞
𝑋
𝐾𝑐𝑒−𝑟(𝑇𝑐−𝜏)Φ (𝑑𝑐
−
) 𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
= 𝑆𝑡𝑒−𝐷(𝑇𝑐−𝑡)𝚽(𝛼+, 𝛽+, 𝜌𝑐) −𝐾𝑐𝑒−𝑟(𝑇𝑐−𝑡)𝚽(𝛼−, 𝛽−, 𝜌𝑐)
where 𝛼± =
log(𝑆𝑡∕𝑋) + (𝑟−𝐷± 1
2𝜎2)(𝜏−𝑡)
𝜎
√
𝜏−𝑡
, 𝛽± =
log(𝑆𝑡∕𝐾𝑐) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑐−𝑡)
𝜎
√
𝑇𝑐−𝑡
and 𝜌𝑐=
√
𝜏−𝑡
𝑇𝑐−𝑡.

604
6.2.2 Path-Dependent Options
Furthermore, from Problem 6.2.2.4 (page 596) we can also deduce that
𝑒−𝑟(𝜏−𝑡)
∫
𝑋
0
𝑃𝑏𝑠(𝑆𝜏, 𝜏; 𝐾𝑝, 𝑇𝑝)𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
= 𝑒−𝑟(𝜏−𝑡)
∫
𝑋
0
𝐾𝑝𝑒−𝑟(𝑇𝑝−𝜏)Φ (−𝑑𝑝
−
) 𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
−𝑒−𝑟(𝜏−𝑡)
∫
𝑋
0
𝑆𝜏𝑒−𝐷(𝑇𝑝−𝜏)Φ (−𝑑𝑝
+
) 𝑓(𝑆𝜏|𝑆𝑡) 𝑑𝑆𝜏
= 𝐾𝑝𝑒−𝑟(𝑇𝑝−𝑡)𝚽(−𝛼−, −𝛾−, 𝜌𝑝) −𝑆𝑡𝑒−𝐷(𝑇𝑝−𝑡)𝚽(−𝛼+, −𝛾+, 𝜌𝑝)
where 𝛾± =
log(𝑆𝑡∕𝐾𝑝) + (𝑟−𝐷± 1
2𝜎2)(𝑇𝑝−𝑡)
𝜎√𝑇𝑝−𝑡
and 𝜌𝑝=
√
𝜏−𝑡
𝑇𝑝−𝑡.
Hence, the price of a complex chooser option at time 𝑡≤𝜏is
𝑉𝑐𝑐(𝑆𝑡, 𝑡; 𝜏, 𝐾𝑐, 𝑇𝑐, 𝐾𝑝, 𝑇𝑝) = 𝑆𝑡𝑒−𝐷(𝑇𝑐−𝑡)𝚽(𝛼+, 𝛽+, 𝜌𝑐)
−𝐾𝑐𝑒−𝑟(𝑇𝑐−𝑡)𝚽(𝛼−, 𝛽−, 𝜌𝑐)
+𝐾𝑝𝑒−𝑟(𝑇𝑝−𝑡)𝚽(−𝛼−, −𝛾−, 𝜌𝑝)
−𝑆𝑡𝑒−𝐷(𝑇𝑝−𝑡)𝚽(−𝛼+, −𝛾+, 𝜌𝑝).
7. Black–Scholes Equation for Lookback Option I. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter. In addition, we let 𝑟be the risk-free interest rate.
Consider a European-style lookback option with terminal payoff
𝑉(𝑆𝑇, 𝑀𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑀𝑇)
which depends on the maximum of the stock price 𝑀𝑇reached within the lookback time
period [𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇, 𝑇> 𝑡is the option expiry time.
By defining
𝑀(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
and
𝑀𝑡= max
𝑡0≤𝑢≤𝑡𝑆𝑢
for 𝑛∈ℕ, show that
lim
𝑛→∞𝑀(𝑛)
𝑡
= 𝑀𝑡.

6.2.2 Path-Dependent Options
605
Explain why, when the current stock price equals its current maximum, we would have the
following result
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
By considering a hedging portfolio involving both lookback option 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) and
stock price 𝑆𝑡, show that for 0 < 𝑆𝑡< 𝑀(𝑛)
𝑡, 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
[
𝑀(𝑛)
𝑡
]𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) = 0.
Finally, by taking 𝑛→∞, show that for 0 < 𝑆𝑡< 𝑀𝑡, 𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) = 0
subject to the boundary conditions
𝑉(𝑆𝑇, 𝑀𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑀𝑇)
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
Solution: By definition, for 𝑛∈ℕ
𝑀(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
and
𝑀𝑡= max
𝑡0≤𝑢≤𝑡𝑆𝑢
and because 𝑆𝑡is continuous within the interval [𝑡0, 𝑡], therefore the integral ∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
exists as well as the maximum 𝑀(𝑛)
𝑡
and 𝑀𝑡.
Since 𝑆𝑢≤𝑀𝑡, 𝑡0 ≤𝑢≤𝑡, therefore for any 𝑛∈ℕ
0 < ∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢≤∫
𝑡
𝑡0
𝑀𝑛
𝑡𝑑𝑢= 𝑀𝑛
𝑡(𝑡−𝑡0)
and hence
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
≤(𝑡−𝑡0)
1
𝑛𝑀𝑡.
Taking limits 𝑛→∞
lim
𝑛→∞
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
≤lim
𝑛→∞(𝑡−𝑡0)
1
𝑛𝑀𝑡

606
6.2.2 Path-Dependent Options
we therefore have
lim
𝑛→∞𝑀(𝑛)
𝑡
≤𝑀𝑡.
We next choose a small 𝜖> 0 and define 𝜖(𝑡) to be the set of 𝑢∈[𝑡0, 𝑡] for which
𝑆𝑢≥𝑀𝑡−𝜖,
𝑢∈[𝑡0, 𝑡]
and let
𝜆𝜖(𝑡) = ∫𝜖(𝑡)
𝑑𝑢
be the total length of the interval in which 𝑆𝑢≥𝑀𝑡−𝜖.
Since 𝑆𝑢is continuous for 𝑢∈[𝑡0, 𝑡], 𝜆𝜖(𝑡) > 0 and 𝜆𝜖(𝑡) ≤𝑡−𝑡0 therefore
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢≥∫𝜖(𝑡)
𝑆𝑛
𝑢𝑑𝑢≥∫𝜖(𝑡)
(𝑀𝑡−𝜖)𝑛𝑑𝑢= (𝑀𝑡−𝜖)𝑛𝜆𝜖(𝑡)
and hence
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
≥𝜆𝜖(𝑡)
1
𝑛(𝑀𝑡−𝜖).
Taking limits 𝑛→∞
lim
𝑛→∞𝑀(𝑛)
𝑡
≥𝑀𝑡−𝜖
and thus we have
𝑀𝑡−𝜖≤lim
𝑛→∞𝑀(𝑛)
𝑡
≤𝑀𝑡
and because 𝜖> 0 is a small number we can deduce that
lim
𝑛→∞𝑀(𝑛)
𝑡
= 𝑀𝑡.
To show that 𝜕𝑉
𝜕𝑀𝑡
= 0 on 𝑆𝑡= 𝑀𝑡, we note that if 𝑆𝑡= 𝑀𝑡then
𝑀𝑇= max
𝑡0≤𝑢≤𝑇𝑆𝑢= max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢, max
𝑡≤𝑢≤𝑇𝑆𝑢
}
≥max
𝑡0≤𝑢≤𝑡𝑆𝑢= 𝑀𝑡
and hence ℙ(𝑀𝑇= 𝑀𝑡) = 0, which shows that 𝑀𝑡cannot be the final maximum at option
expiry time 𝑇.

6.2.2 Path-Dependent Options
607
Since 𝑀𝑇≠𝑀𝑡, this implies that the lookback option 𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) at time 𝑡is insensitive
to small changes in 𝑀𝑡. Therefore,
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
To find the PDE satisfied by 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) we first construct a Δ-hedged portfolio having
one option 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) and −Δ number of shares 𝑆𝑡. Thus, the hedged portfolio Π𝑡at
time 𝑡is
Π𝑡= 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) −Δ𝑆𝑡.
From 𝑡to 𝑡+ 𝑑𝑡, and because the holder receives 𝐷𝑆𝑡𝑑𝑡for every asset held, the portfolio
value changes by an amount
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡)
where
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
𝑑𝑀(𝑛)
𝑡
+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
2
𝜕2𝑉
𝜕(𝑀(𝑛)
𝑡)2 (𝑑𝑀(𝑛)
𝑡)2 + …
and
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
Since 𝑀(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
we have
𝑑𝑀(𝑛)
𝑡
= 1
𝑛
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛−1
𝑆𝑛
𝑡𝑑𝑡= 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1 𝑑𝑡.
From It¯o’s lemma
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
[(𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
] + 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
𝑑𝑡
+1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝑑𝑡
=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
+𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡

608
6.2.2 Path-Dependent Options
and by substituting the above equation back into 𝑑Π𝑡and rearranging terms, we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
]
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
To eliminate the random term we set
Δ = 𝜕𝑉
𝜕𝑆𝑡
and hence
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡.
Under the no-arbitrage condition, the return on the amount Π𝑡invested in a risk-free interest
rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡
and therefore
𝑟Π𝑡𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) −Δ𝑆𝑡
)
𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡=
[
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡.
By removing 𝑑𝑡and rearranging terms, we finally have
𝜕𝑉
𝜕𝑡+ 1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) = 0.

6.2.2 Path-Dependent Options
609
If we take the limit 𝑛→∞then lim
𝑛→∞𝑀(𝑛)
𝑡
= 𝑀𝑡and since 𝑆𝑡≤max
𝑡0≤𝑢≤𝑡𝑆𝑢= 𝑀𝑡we have
lim
𝑛→∞
1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1 = 0.
Thus, in the limit 𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) = 0
with boundary conditions
𝑉(𝑆𝑇, 𝑀𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑀𝑇)
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
8. Stop-Loss Option. At time 𝑡, let the asset price 𝑆𝑡follow a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝑊𝑡is a standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇is the drift
parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility parameter. In addition,
let 𝑟be the risk-free interest rate.
Consider a stop-loss option 𝑉(𝑆𝑡, 𝑀𝑡), which is a perpetual barrier lookback option
with a rebate 𝜆𝑀𝑡where 𝜆∈(0, 1) is a fixed proportion of the maximum realised asset
price at time 𝑡, 𝑀𝑡= max
𝑡0≤𝑢≤𝑡𝑆𝑢where 𝑡0 ≥0. By setting a time-dependent barrier 𝐵𝑡= 𝜆𝑀𝑡
such that if 𝑆𝑡≤𝐵𝑡then the option pays the holder 𝐵𝑡, and because the option is time
independent, the option is not triggered until the barrier is hit.
From the above information show that for 𝐵𝑡< 𝑆𝑡< 𝑀𝑡, the stop-loss option price
𝑉(𝑆𝑡, 𝑀𝑡) satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡) = 0
with boundary conditions
𝑉(𝐵𝑡, 𝑀𝑡) = 𝐵𝑡
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
By considering the change of variables
𝑉(𝑆𝑡, 𝑀𝑡) = 𝑀𝑡𝜙(𝜉),
𝜉= 𝑆𝑡∕𝑀𝑡

610
6.2.2 Path-Dependent Options
show that for 𝜆< 𝜉< 1, 𝜙(𝜉) satisfies
1
2𝜎2𝜉2 𝑑2𝜙
𝑑𝜉2 + (𝑟−𝐷)𝜉𝑑𝜙
𝑑𝜉−𝑟𝜙(𝜉) = 0
with boundary conditions
𝜙(𝜆) = 𝜆
and
𝜙(1) = 𝑑𝜙
𝑑𝜉
||||𝜉=1
.
By setting 𝜙(𝜉) = 𝐶𝜉𝑚where 𝐶and 𝑚are constants, show that the stop-loss option price is
𝑉(𝑆𝑡, 𝑀𝑡) = 𝜆𝑀𝑡
[
(1 −𝛽) (𝑆𝑡∕𝑀𝑡
)𝛼−(1 −𝛼) (𝑆𝑡∕𝑀𝑡
)𝛽
(1 −𝛽)𝜆𝛼−(1 −𝛼)𝜆𝛽
]
where
𝛼=
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
and
𝛽=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.
What is the option price if 𝐷= 0?
Solution: Following the steps given in Problem 6.2.1.7 (page 547), we first define
𝑀(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
.
To find the PDE satisfied by 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡) we construct a Δ-hedged portfolio
Π𝑡= 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡) −Δ𝑆𝑡
having one option 𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡) and short Δ number of shares 𝑆𝑡. Using similar steps as
described in Problem 6.2.1.7 (page 547), we can easily show that
1
𝑛
𝑆𝑛
𝑡
(𝑀(𝑛)
𝑡)𝑛−1
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡) = 0.

6.2.2 Path-Dependent Options
611
By taking lim𝑛→∞𝑀(𝑛)
𝑡
= 𝑀𝑡then 𝑉(𝑆𝑡, 𝑀𝑡) will satisfy
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡, 𝑡) = 0
for 𝜆𝑀𝑡< 𝑆𝑡< 𝑀𝑡with boundary conditions
𝑉(𝜆𝑀𝑡, 𝑀𝑡) = 𝜆𝑀𝑡
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
Setting 𝑉(𝑆𝑡, 𝑀𝑡) = 𝑀𝑡𝜙(𝜉) with 𝜉= 𝑆𝑡∕𝑀𝑡we have
𝜕𝑉
𝜕𝑆𝑡
= 𝑀𝑡
𝑑𝜙
𝑑𝜉
𝑑𝜉
𝑑𝑆𝑡
= 𝑑𝜙
𝑑𝜉,
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝑑2𝜙
𝑑𝜉2
𝑑𝜉
𝑑𝑆𝑡
= 1
𝑀𝑡
𝑑2𝜙
𝑑𝜉2
𝜕𝑉
𝜕𝑀𝑡
= 𝜙(𝜉) + 𝑀𝑡
𝑑𝜙
𝑑𝜉
𝑑𝜉
𝑑𝑀𝑡
= 𝜙(𝜉) + 𝑀𝑡
𝑑𝜙
𝑑𝜉
(
−𝑆𝑡
𝑀2
𝑡
)
= 𝜙(𝜉) −𝜉𝑑𝜙
𝑑𝜉
𝑉(𝜆𝑀𝑡, 𝑀𝑡) = 𝜆𝑀𝑡⟹𝑀𝑡𝜙
(𝜆𝑀𝑡
𝑀𝑡
)
= 𝜆𝑀𝑡
or
𝜙(𝜆) = 𝜆
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 𝜙(1) −𝑑𝜙
𝑑𝜉
||||𝜉=1
= 0.
Substituting the above results into the PDE and boundary conditions, and because 𝜉=
𝑆𝑡∕𝑀𝑡, we will eventually arrive at a second-order ODE
1
2𝜎2𝜉2 𝑑2𝜙
𝑑𝜉2 + (𝑟−𝐷)𝜉𝑑𝜙
𝑑𝜉−𝑟𝜙(𝜉) = 0
for 𝜆< 𝜉< 1 with boundary conditions
𝜙(𝜆) = 𝜆
and
𝜙(1) = 𝑑𝜙
𝑑𝜉
||||𝜉=1
.
To solve the ODE we let
𝜙(𝜉) = 𝐶𝜉𝑚

612
6.2.2 Path-Dependent Options
where 𝐶and 𝑚are constants. Substituting
𝜙(𝜉) = 𝐶𝜉𝑚,
𝑑𝜙
𝑑𝜉= 𝑚𝐶𝜉𝑚−1,
𝑑2𝜙
𝑑𝜉2 = 𝑚(𝑚−1)𝐶𝜉𝑚−2
into the ODE we have
1
2𝜎2𝑚(𝑚−1) + (𝑟−𝐷)𝑚−𝑟= 0
or
1
2𝜎2𝑚2 +
(
𝑟−𝐷−1
2𝜎2)
𝑚−𝑟= 0.
Therefore,
𝑚=
−(𝑟−𝐷−1
2𝜎2) ±
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.
Since
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟> (𝑟−𝐷−1
2𝜎2)
the solution of the ODE must be of the form
𝜙(𝜉) = 𝐴𝜉𝛼+ 𝐵𝜉𝛽
where 𝐴and 𝐵are unknown constants,
𝛼=
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
> 0
and
𝛽=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
< 0.
Substituting 𝜙(𝜉) = 𝐴𝜉𝛼+ 𝐵𝜉𝛽into the boundary conditions
𝜙(𝜆) = 𝜆
and
𝜙(1) = 𝜙′(1)
we have
𝐴𝜆𝛼+ 𝐵𝜆𝛽= 𝜆
and
𝐴(𝛼−1) + 𝐵(𝛼−1) = 0.

6.2.2 Path-Dependent Options
613
Solving the two equations simultaneously, we have
𝐴=
(1 −𝛽)𝜆
(1 −𝛽)𝜆𝛼+ (𝛼−1)𝜆𝛽
and
𝐵=
−(1 −𝛼)𝜆
(1 −𝛽)𝜆𝛼+ (𝛼−1)𝜆𝛽
and hence
𝜙(𝜉) = 𝐴𝜉𝛼+ 𝐵𝜉𝛽= (1 −𝛽)𝜆𝜉𝛼−(1 −𝛼)𝜆𝜉𝛽
(1 −𝛽)𝜆𝛼+ (𝛼−1)𝜆𝛽.
Because 𝑉(𝑆𝑡, 𝑀𝑡) = 𝑀𝑡𝜙(𝜉) and 𝜉= 𝑆𝑡∕𝑀𝑡, the stop-loss option price at time 𝑡is
𝑉(𝑆𝑡, 𝑀𝑡) = 𝜆𝑀𝑡
[
(1 −𝛽) (𝑆𝑡∕𝑀𝑡
)𝛼−(1 −𝛼) (𝑆𝑡∕𝑀𝑡
)𝛽
(1 −𝛽)𝜆𝛼−(1 −𝛼)𝜆𝛽
]
.
Finally, if 𝐷= 0 then 𝛼= 1 and 𝛽= 0, and therefore 𝐴= 1 and 𝐵= 0. Thus, 𝜙(𝜉) = 𝜉is
independent of 𝜆and hence the stop-loss option price is
𝑉(𝑆𝑡, 𝑀𝑡) = 𝑀𝑡𝜙(𝜉) = 𝑀𝑡𝜉= 𝑆𝑡
which is equivalent to the underlying stock price 𝑆𝑡.
9. Perpetual American Fixed Strike Lookback Option. At time 𝑡let the asset price 𝑆𝑡follow
a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝑊𝑡is a standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇is the drift
parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility parameter. In addition,
let 𝑟be the risk-free interest rate.
Consider a perpetual American fixed strike lookback option 𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) which gives
the holder the right to buy at the specified fixed strike 𝐾> 0 with the intrinsic payoff
max{𝑀𝑡−𝐾, 0}, 𝑀𝑡= max
𝑡0≤𝑢≤𝑡𝑆𝑢, 𝑡0 ≥0 up to the date chosen by the option holder. Let
𝑆∞< 𝑀𝑡where 𝑆∞> 𝐾is the unknown optimal exercise boundary such that for 𝑆𝑡≥
𝑆∞the option should be exercised whilst for 𝑆𝑡< 𝑆∞the option should be held. Show
that for 0 < 𝑆𝑡< 𝑆∞< 𝑀𝑡, the option price 𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) = 0
with boundary conditions
𝑉(𝑆∞, 𝑀𝑡; 𝐾) = 𝑀𝑡−𝐾
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.

614
6.2.2 Path-Dependent Options
By considering the change of variables
𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) = 𝑀𝑡𝜙(𝜉),
𝜉= 𝑆𝑡∕𝑀𝑡
show that for 0 < 𝜉< 𝜉∞< 1 where 𝜉∞= 𝑆∞∕𝑀𝑡, then 𝜙(𝜉) satisfies
1
2𝜎2𝜉2 𝑑2𝜙
𝑑𝜉2 + (𝑟−𝐷)𝜉𝑑𝜙
𝑑𝜉−𝑟𝜙(𝜉) = 0
with boundary conditions
𝜙(𝜉∞) = 𝑀𝑡−𝐾
𝑀𝑡
,
𝑑𝜙
𝑑𝜉
||||𝜉=𝜉∞= −𝐾
𝑆∞
and
𝜙(1) = 𝑑𝜙
𝑑𝜉
||||𝜉=1
.
By setting 𝜙(𝜉) = 𝐶𝜉𝑚where 𝐶and 𝑚are constants, show that the option price is
𝑉(𝑆𝑡, 𝑀𝑡; 𝐾)
=
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪⎩
1
𝛼−𝛽
{[(𝑀𝑡−𝐾)𝛼+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛽
if 𝑆𝑡< 𝑆∞
−
[(𝑀𝑡−𝐾)𝛽+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛼}
𝑀𝑡−𝐾
if 𝑆𝑡≥𝑆∞
where
𝛼=
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
𝛽=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
and
𝜉∞=
{
(𝛽−1) [(𝑀𝑡−𝐾)𝛼+ 𝐾]
(𝛼−1) [(𝑀𝑡−𝐾)𝛽+ 𝐾]
}
1
𝛽−𝛼
.
What is the option price if 𝐷= 0?
Solution: To show that 𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) = 0
with boundary condition 𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0, see Problem 6.2.2.8 (page 609).

6.2.2 Path-Dependent Options
615
Let 𝐾< 𝑆∞< 𝑀𝑡be the optimal exercise boundary such that 𝑆𝑡≥𝑆∞, then the
perpetual American fixed strike lookback option price is equal to its intrinsic value
𝑉(𝑆∞, 𝑀𝑡; 𝐾) = 𝑀𝑡−𝐾. In contrast, for 𝑆𝑡< 𝑆∞the option should be held. Thus, for
0 < 𝑆𝑡< 𝑆∞< 𝑀𝑡the option problem can be expressed as
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) = 0
with boundary conditions
𝑉(𝑆∞, 𝑀𝑡; 𝐾) = 𝑀𝑡−𝐾
and
𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0.
Using the change of variables
𝑉(𝑆𝑡, 𝑀𝑡; 𝐾) = 𝑀𝑡𝜙(𝜉),
𝜉= 𝑆𝑡∕𝑀𝑡
and
𝜉∞= 𝑆∞∕𝑀𝑡
and following the steps given in Problem 6.2.2.8 (page 609), we can easily show that 𝜙(𝜉)
satisfies
1
2𝜎2𝜉2 𝑑2𝜙
𝑑𝜉2 + (𝑟−𝐷)𝜉𝑑𝜙
𝑑𝜉−𝑟𝜙(𝜉) = 0
for 0 < 𝜉< 𝜉∞< 1.
As for the boundary conditions, we note that for 𝑉(𝑆∞, 𝑀𝑡; 𝐾) = 𝑀𝑡−𝐾
𝑀𝑡𝜙(𝜉∞) = 𝑀𝑡−𝐾
or
𝜙(𝜉∞) = 𝑀𝑡−𝐾
𝑀𝑡
.
In addition, because
𝜕𝑉
𝜕𝑀𝑡
= 𝜙(𝜉) + 𝑀𝑡
𝑑𝜙
𝑑𝜉
𝑑𝜉
𝑑𝑀𝑡
= 𝜙(𝜉) −𝜉𝑑𝜙
𝑑𝜉
therefore 𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑆∞= 1 becomes
𝜙(𝜉∞) −𝜉∞𝑑𝜙
𝑑𝜉
||||𝜉=𝜉∞= 1
or
𝑑𝜙
𝑑𝜉
||||𝜉=𝜉∞= −𝐾
𝑆∞
since 𝜙(𝜉∞) = 𝑀𝑡−𝐾
𝑀𝑡
.
Finally, 𝜕𝑉
𝜕𝑀𝑡
||||𝑆𝑡=𝑀𝑡
= 0 becomes
𝜙(1) −𝑑𝜙
𝑑𝜉
||||𝜉=1
= 0.

616
6.2.2 Path-Dependent Options
Therefore, for 0 < 𝜉< 𝜉∞< 1, 𝜙(𝜉) satisfies
1
2𝜎2𝜉2 𝑑2𝜙
𝑑𝜉2 + (𝑟−𝐷)𝜉𝑑𝜙
𝑑𝜉−𝑟𝜙(𝜉) = 0
with boundary conditions
𝜙(𝜉∞) = 𝑀𝑡−𝐾
𝑀𝑡
,
𝑑𝜙
𝑑𝜉
||||𝜉=𝜉∞= −𝐾
𝑆∞
and
𝜙(1) = 𝑑𝜙
𝑑𝜉
||||𝜉=1
.
By setting 𝜙(𝜉) = 𝐶𝜉𝑚where 𝐶and 𝑚are constants, then following Problem 6.2.2.8
(page 609) the solution of the Cauchy–Euler equation is
𝜙(𝜉) = 𝐴𝜉𝛼+ 𝐵𝜉𝛽
where 𝐴and 𝐵are constants to be determined with
𝛼=
−(𝑟−𝐷−1
2𝜎2) +
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
and
𝛽=
−(𝑟−𝐷−1
2𝜎2) −
√
(𝑟−𝐷−1
2𝜎2)2 + 2𝜎2𝑟
𝜎2
.
Substituting 𝜙(𝜉) = 𝐴𝜉𝛼+ 𝐵𝜉𝛽and 𝜙′(𝜉) = 𝛼𝐴𝜉𝛼−1 + 𝛽𝐵𝜉𝛽−1 into the boundary condi-
tions, we have
𝐴(𝜉∞)𝛼+ 𝐵(𝜉∞)𝛽= 𝑀𝑡−𝐾
𝑀𝑡
𝛼𝐴(𝜉∞)𝛼−1 + 𝛽𝐵(𝜉∞)𝛽−1 = −𝐾
𝑆∞
(𝛼−1)𝐴+ (𝛽−1)𝐵= 0.
By solving
𝐴(𝜉∞)𝛼+ 𝐵(𝜉∞)𝛽= 𝑀𝑡−𝐾
𝑀𝑡
and
𝛼𝐴(𝜉∞)𝛼−1 + 𝛽𝐵(𝜉∞)𝛽−1 = −𝐾
𝑆∞
simultaneously we have
𝐴= (𝑀𝑡−𝐾)𝛽+ 𝐾
𝑀𝑡(𝛽−𝛼)(𝜉∞)𝛼
and
𝐵= (𝑀𝑡−𝐾)𝛼+ 𝐾
𝑀𝑡(𝛼−𝛽)(𝜉∞)𝛽.

6.2.2 Path-Dependent Options
617
By substituting the expressions for 𝐴and 𝐵into 𝛼𝐴(𝜉∞)𝛼−1 + 𝛽𝐵(𝜉∞)𝛽−1 = 0 we have
the identity
(𝛼−1) [(𝑀𝑡−𝐾)𝛽+ 𝐾] (𝜉∞)𝛽= (𝛽−1) [(𝑀𝑡−𝐾)𝛼+ 𝐾] (𝜉∞)𝛼
and hence
𝜉∞=
{
(𝛽−1) [(𝑀𝑡−𝐾)𝛼+ 𝐾]
(𝛼−1) [(𝑀𝑡−𝐾)𝛽+ 𝐾]
}
1
𝛽−𝛼
.
Therefore,
𝜙(𝜉)
= 𝐴𝜉𝛼+ 𝐵𝜉𝛽
=
1
𝑀𝑡(𝛼−𝛽)
{[(𝑀𝑡−𝐾)𝛼+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛽
−
[(𝑀𝑡−𝐾)𝛽+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛼}
and hence the option price for 0 < 𝑆𝑡< 𝑆∞< 𝑀𝑡is
𝑉(𝑆𝑡, 𝑀𝑡; 𝐾)
=
1
𝛼−𝛽
{[(𝑀𝑡−𝐾)𝛼+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛽
−
[(𝑀𝑡−𝐾)𝛽+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛼}
.
Collectively, we can therefore write
𝑉(𝑆𝑡, 𝑀𝑡; 𝐾)
=
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪⎩
1
𝛼−𝛽
{[(𝑀𝑡−𝐾)𝛼+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛽
if 𝑆𝑡< 𝑆∞
−
[(𝑀𝑡−𝐾)𝛽+ 𝐾
𝑀𝑡
] ( 𝜉
𝜉∞
)𝛼}
𝑀𝑡−𝐾
if 𝑆𝑡≥𝑆∞.
When the continuous dividend yield 𝐷= 0 then 𝛼= 1 and 𝛽= −2𝑟
𝜎2 . Thus, 𝜉∞is unde-
fined, which implies that the option price problem does not have a solution. This shows that
it is never optimal to hold such an option unless 𝑆𝑡pays a continuous stream of dividends.
N.B. For the case when 𝐾= 0, the option is known as a Russian option, which pays out
the maximum realised asset price 𝑀𝑡up to the date chosen by the holder.

618
6.2.2 Path-Dependent Options
10. Black–Scholes Equation for Lookback Option II. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
Consider a European-style lookback option with terminal payoff
𝑉(𝑆𝑇, 𝑚𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑚𝑇)
which depends on the minimum of the stock price 𝑚𝑇reached within the lookback time
period [𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇> 𝑡is the option expiry time. By defining
𝑚(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛
and
𝑚𝑡= min
𝑡0≤𝑢≤𝑡𝑆𝑢
for 𝑛∈ℕ, show that
lim
𝑛→∞𝑚(𝑛)
𝑡
= 𝑚𝑡.
Explain why, when the current stock price equals its current minimum, we would have the
following result
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.
By considering a hedging portfolio involving both lookback option 𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) and stock
𝑆𝑡, show that for 𝑆𝑡> 𝑚(𝑛)
𝑡
> 0, 𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) satisfies the following PDE
𝜕𝑉
𝜕𝑡−1
𝑛
[
𝑚(𝑛)
𝑡
]𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑀(𝑛)
𝑡, 𝑡) = 0.
Finally, by taking 𝑛→∞, show that for 𝑆𝑡> 𝑚𝑡> 0, 𝑉(𝑆𝑡, 𝑚𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚𝑡, 𝑡) = 0
subject to the boundary conditions
𝑉(𝑆𝑇, 𝑚𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑚𝑇)
and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.

6.2.2 Path-Dependent Options
619
Solution: By definition, for 𝑛∈ℕ
𝑚(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆𝑛
𝑢𝑑𝑢
] 1
𝑛
and
𝑚𝑡= min
𝑡0≤𝑢≤𝑡𝑆𝑢
and because 𝑆𝑡is continuous within the interval [𝑡0, 𝑡], therefore the integral ∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢
exists as well as the minimum 𝑚(𝑛)
𝑡
and 𝑚𝑡.
Since we can write
𝑚𝑡=
[
max
𝑡0≤𝑢≤𝑡𝑆−1
𝑢
]−1
therefore
𝑚−1
𝑡
= max
𝑡0≤𝑢≤𝑡𝑆−1
𝑢
and for any 𝑛∈ℕ
∫
𝑡
𝑡0
𝑚−𝑛
𝑡𝑑𝑢≥∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢
or
𝑚−𝑛
𝑡(𝑡−𝑡0) ≥∫
𝑡
0
𝑆−𝑛
𝑢
𝑑𝑢
and hence
𝑚𝑡(𝑡−𝑡0)−1
𝑛≤
[
∫
𝑡
0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛
.
Taking limits 𝑛→∞
lim
𝑛→∞𝑚𝑡(𝑡−𝑡0)−1
𝑛≤lim
𝑛→∞
[
∫
𝑡
0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛
we therefore have
𝑚𝑡≤lim
𝑛→∞𝑚(𝑛)
𝑡.
We next choose a small 𝜖> 0 and define 𝜖(𝑡) to be the set of 𝑢∈[𝑡0, 𝑡] for which
𝑆𝑢≤𝑚𝑡+ 𝜖,
𝑢∈[𝑡0, 𝑡]

620
6.2.2 Path-Dependent Options
and let
𝜆𝜖(𝑡) = ∫𝜖(𝑡)
𝑑𝑢
be the total length of the interval in which 𝑆𝑢≤𝑚𝑡+ 𝜖(or 𝑆−1
𝑢
≥(𝑚𝑡+ 𝜖)−1).
Since 𝑆𝑢is continuous for 𝑢∈[𝑡0, 𝑡], 𝜆𝜖(𝑡) > 0 and 𝜆𝜖(𝑡) ≤𝑡−𝑡0 therefore
∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢≥∫𝜖(𝑡)
𝑆−𝑛
𝑢
𝑑𝑢≥∫𝜖(𝑡)
(𝑚𝑡+ 𝜖)−𝑛𝑑𝑢= (𝑚𝑡+ 𝜖)−𝑛𝜆𝜖(𝑡)
and hence
[
∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛
≤𝜆𝜖(𝑡)−1
𝑛(𝑚𝑡+ 𝜖).
Taking limits 𝑛→∞
lim
𝑛→∞𝑚(𝑛)
𝑡
≤𝑚𝑡+ 𝜖
and thus we have
𝑚𝑡≤lim
𝑛→∞𝑀(𝑛)
𝑡
≤𝑚𝑡+ 𝜖
and because 𝜖> 0 is a small number we can deduce that
lim
𝑛→∞𝑚(𝑛)
𝑡
= 𝑚𝑡.
To show that 𝜕𝑉
𝜕𝑚𝑡
= 0 on 𝑆𝑡= 𝑚𝑡we note that if 𝑆𝑡= 𝑚𝑡then
𝑚𝑇= min
𝑡0≤𝑢≤𝑇𝑆𝑢= min
{
min
𝑡0≤𝑢≤𝑡𝑆𝑢, min
𝑡≤𝑢≤𝑇𝑆𝑢
}
≤min
0≤𝑢≤𝑡𝑆𝑢= 𝑚𝑡
and hence ℙ(𝑚𝑇= 𝑚𝑡) = 0, which shows that 𝑚𝑡cannot be the final maximum at option
expiry time 𝑇.
Since 𝑚𝑇≠𝑚𝑡, this implies that the lookback option 𝑉(𝑆𝑡, 𝑚𝑡, 𝑡) at time 𝑡is insensitive
to small changes in 𝑚𝑡. Therefore,
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.
To find the PDE satisfied by 𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) we first construct a Δ-hedged portfolio having
one option 𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) and shorting Δ number of shares 𝑆𝑡. Thus, the hedged portfolio
Π𝑡at time 𝑡is
Π𝑡= 𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) −Δ𝑆𝑡.

6.2.2 Path-Dependent Options
621
From 𝑡to 𝑡+ 𝑑𝑡, and because the holder receives 𝐷𝑆𝑡𝑑𝑡for every asset held, the portfolio
value changes by an amount
𝑑Π𝑡= 𝑑𝑉−Δ(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡)
where
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 𝜕𝑉
𝜕𝑚(𝑛)
𝑡
𝑑𝑚(𝑛)
𝑡
+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
2
𝜕2𝑉
𝜕(𝑚(𝑛)
𝑡)2 (𝑑𝑚(𝑛)
𝑡)2 + …
and
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡.
Since 𝑚(𝑛)
𝑡
=
[
∫
𝑡
𝑡0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛
we have
𝑑𝑚(𝑛)
𝑡
= −1
𝑛
[
∫
𝑡
0
𝑆−𝑛
𝑢
𝑑𝑢
]−1
𝑛−1
𝑆−𝑛
𝑡𝑑𝑡= −1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝑑𝑡.
From It¯o’s lemma
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
[(𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
] −1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
𝑑𝑡
+1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
𝑑𝑡
=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
+𝜎𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑡
and by substituting 𝑑𝑉into 𝑑Π𝑡and rearranging terms, we have
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝜇Δ𝑆𝑡
]
𝑑𝑡
+𝜎𝑆𝑡
(
𝜕𝑉
𝜕𝑆𝑡
−Δ
)
𝑑𝑊𝑡.
To eliminate the random term we set
Δ = 𝜕𝑉
𝜕𝑆𝑡
and hence
𝑑Π𝑡=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡.

622
6.2.2 Path-Dependent Options
Under the no-arbitrage condition, the return on the amount Π𝑡invested in a risk-free interest
rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡
and therefore
𝑟Π𝑡𝑑𝑡=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) −Δ𝑆𝑡
)
𝑑𝑡=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑀(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡
𝑟
(
𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) −𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
)
𝑑𝑡=
[
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
−𝐷𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
𝑑𝑡.
By removing 𝑑𝑡and rearranging terms, we finally have
𝜕𝑉
𝜕𝑡−1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
𝜕𝑉
𝜕𝑚(𝑛)
𝑡
+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚(𝑛)
𝑡, 𝑡) = 0.
If we take the limit 𝑛→∞then lim
𝑛→∞𝑚(𝑛)
𝑡
= 𝑚𝑡, and since 𝑚𝑡= min
𝑡0≤𝑢≤𝑡𝑆𝑢≤= 𝑆𝑡, we have
lim
𝑛→∞
1
𝑛
(𝑚(𝑛)
𝑡)𝑛+1
𝑆𝑛
𝑡
= lim
𝑛→∞
1
𝑛
(
𝑚(𝑛)
𝑡
𝑆𝑡
)𝑛
𝑚(𝑛)
𝑡
= 0.
Thus, in the limit, 𝑉(𝑆𝑡, 𝑚𝑡, 𝑡) satisfies
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚𝑡, 𝑡) = 0
with boundary conditions
𝑉(𝑆𝑇, 𝑚𝑇, 𝑇) = Ψ(𝑆𝑇, 𝑚𝑇)
and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.

6.2.2 Path-Dependent Options
623
11. Perpetual American Floating Strike Lookback Option. At time 𝑡let the asset price 𝑆𝑡follow
a GBM
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝑊𝑡is a standard Wiener process on the probability space (Ω, ℱ, ℙ), 𝜇is the drift
parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility parameter. In addition,
we let 𝑟be the risk-free interest rate.
Consider a perpetual American floating strike lookback option 𝑉(𝑆𝑡, 𝑚𝑡) which gives
the holder the right but not the obligation to buy at the lowest realised asset price with
the intrinsic payoff max{𝑆𝑡−𝑚𝑡, 0}, 𝑚𝑡= min
𝑡0≤𝑢≤𝑡𝑆𝑢, 𝑡0 ≥0 up to the date chosen by the
option holder.
Let 𝑆∗> 𝑚𝑡be the unknown optimal exercise boundary such that for 𝑆𝑡≥𝑆∗the option
should be exercised whilst for 𝑆𝑡< 𝑆∗the option should be held.
Show that for 𝑚𝑡< 𝑆𝑡< 𝑆∗, the option price 𝑉(𝑆𝑡, 𝑚𝑡) satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚𝑡) = 0
with boundary conditions
𝑉(𝑆∗, 𝑚𝑡) = 𝑆∗−𝑚𝑡
and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.
By considering the change of variables
𝑉(𝑆𝑡, 𝑚𝑡) = 𝑆𝑡𝜑(𝜁), 𝜁= 𝑚𝑡∕𝑆𝑡
show that for 0 < 𝜁∗< 𝜁< 1, where 𝜁∗= 𝑚𝑡∕𝑆∗, then 𝜑(𝜁) satisfies
1
2𝜎2𝜁2 𝑑2𝜑
𝑑𝜁2 + (𝐷−𝑟)𝜁𝑑𝜑
𝑑𝜁−𝐷𝜑(𝜁) = 0
with boundary conditions
𝜑(𝜁∗) = 1 −𝜁∗,
𝑑𝜑
𝑑𝜁
||||𝜁=𝜁∗= −1
and
𝜑(1) = 𝑑𝜑
𝑑𝜁
||||𝜁=1
.
By setting 𝜑(𝜁) = 𝐶𝜁𝑚where 𝐶and 𝑚are constants, show that the option price 𝑉(𝑆𝑡, 𝑚𝑡)
is
𝑉(𝑆𝑡, 𝑚𝑡)
=
⎧
⎪
⎪
⎨
⎪
⎪⎩
1
𝛼−𝛽
{
[(1 −𝛼)𝜁∗+ 𝛼] ( 𝜁
𝜁∗
)𝛽
−[(1 −𝛽)𝜁∗+ 𝛽] ( 𝜁
𝜁∗
)𝛼}
if 𝑆𝑡< 𝑆∗
𝑆∗−𝑚𝑡
if 𝑆𝑡≥𝑆∗

624
6.2.2 Path-Dependent Options
where
𝛼=
−(𝐷−𝑟−1
2𝜎2) +
√
(𝐷−𝑟−1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
𝛽=
−(𝐷−𝑟−1
2𝜎2) −
√
(𝐷−𝑟−1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
and 0 < 𝜁∗< 1 satisfies 𝑓(𝜁∗) = 0 where
𝑓(𝜁) = 𝛽(1 −𝛼)𝜁𝛼−𝛽+1 + 𝛼𝛽𝜁𝛼−𝛽−𝛼(1 −𝛽)𝜁−𝛼𝛽.
Show that if 𝐷> 0 then 𝑓(𝜁) = 0 has a unique solution in 𝜁∈(0, 1).
What is the option price when 𝐷= 0?
Solution: To show that 𝑉(𝑆𝑡, 𝑚𝑡) satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚𝑡) = 0
with boundary condition 𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0, see Problem 6.2.2.10 (page 618) and Problem
6.2.2.8 (page 609).
Given that 𝑆∗is the optimal exercise boundary then for 𝑆𝑡≥𝑆∗, the option price is
equal to its intrinsic value 𝑉(𝑆∗, 𝑚𝑡) = 𝑆∗−𝑚𝑡. Therefore, for 𝑚𝑡< 𝑆𝑡< 𝑆∗, 𝑉(𝑆𝑡, 𝑚𝑡)
satisfies
1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑚𝑡) = 0
with boundary conditions
𝑉(𝑆∗, 𝑚𝑡) = 𝑆∗−𝑚𝑡
and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0.
By the change of variables
𝑉(𝑆𝑡, 𝑚𝑡) = 𝑆𝑡𝜑(𝜁),
𝜁= 𝑚𝑡∕𝑆𝑡
and
𝜁∗= 𝑚𝑡∕𝑆∗
we have
𝜕𝑉
𝜕𝑆𝑡
= 𝜑(𝜁) + 𝑆𝑡
𝑑𝜑
𝑑𝜁
𝑑𝜁
𝑑𝑆𝑡
= 𝜑(𝜁) −𝜁𝑑𝜑
𝑑𝜁
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝑑𝜑
𝑑𝜁
𝑑𝜁
𝑑𝑆𝑡
−𝑑𝜁
𝑑𝑆𝑡
𝑑𝜑
𝑑𝜁−𝜁𝑑2𝜑
𝑑𝜁2
𝑑𝜁
𝑑𝑆𝑡
= 𝜁2
𝑆𝑡
𝑑2𝜑
𝑑𝜁2
𝜕𝑉
𝜕𝑚𝑡
= 𝑆𝑡
𝑑𝜑
𝑑𝜁
𝑑𝜁
𝑑𝑚𝑡
= 𝑑𝜑
𝑑𝜁
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 𝑑𝜑
𝑑𝜁
||||𝜁=1
and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑆∗= 𝑑𝜑
𝑑𝜁
||||𝜁=𝜁∗.

6.2.2 Path-Dependent Options
625
Substituting the above results into the PDE and because 𝜁= 𝑚𝑡∕𝑆𝑡, we eventually arrive
at a second-order ODE of the form
1
2𝜎2𝜉2 𝑑2𝜑
𝑑𝜁2 + (𝐷−𝑟)𝜁𝑑𝜑
𝑑𝜁−𝐷𝜑(𝜁) = 0
for 0 < 𝜁∗< 𝜁< 1. As for the boundary conditions, we note that for 𝑉(𝑆∗, 𝑚𝑡) = 𝑆∗−𝑚𝑡
𝑆∗𝜑(𝜁∗) = 𝑆∗−𝑚𝑡
or
𝜑(𝜁∗) = 1 −𝜁∗.
In addition, because
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑆∗= −1 we have 𝑑𝜑
𝑑𝜁
||||𝜁=𝜁∗= −1 and
𝜕𝑉
𝜕𝑚𝑡
||||𝑆𝑡=𝑚𝑡
= 0
becomes 𝑑𝜑
𝑑𝜁
||||𝜁=1
= 0.
Therefore, for 0 < 𝜁∗< 𝜁< 1, 𝜑(𝜁) satisfies
1
2𝜎2𝜉2 𝑑2𝜑
𝑑𝜁2 + (𝐷−𝑟)𝜁𝑑𝜑
𝑑𝜁−𝐷𝜑(𝜁) = 0
with boundary conditions
𝜑(𝜁∗) = 1 −𝜁∗,
𝑑𝜑
𝑑𝜁
||||𝜁=𝜁∗= −1
and
𝑑𝜑
𝑑𝜁
||||𝜁=1
= 0.
By setting 𝜑(𝜁) = 𝐶𝜁𝑛where 𝐶and 𝑛are constants, then following Problem 6.2.2.8
(page 609) the solution of the ODE is
𝜑(𝜁) = 𝐴𝜁𝛼+ 𝐵𝜁𝛽
where 𝐴and 𝐵are constants to be determined with
𝛼=
−(𝐷−𝑟−1
2𝜎2) +
√
(𝐷−𝑟−1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
and
𝛽=
−(𝐷−𝑟−1
2𝜎2) −
√
(𝐷−𝑟−1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
.
Substituting 𝜑(𝜁) = 𝐴𝜁𝛼+ 𝐵𝜁𝛽and 𝜑′(𝜉) = 𝛼𝐴𝜁𝛼−1 + 𝛽𝐵𝜁𝛽−1 into the boundary condi-
tions we have
𝐴(𝜁∗)𝛼+ 𝐵(𝜁∗)𝛽= 1 −𝜁∗
𝛼𝐴(𝜁∗)𝛼−1 + 𝛽𝐵(𝜁∗)𝛽−1 = −1
𝛼𝐴+ 𝛽𝐵= 0.

626
6.2.2 Path-Dependent Options
By solving
𝐴(𝜁∗)𝛼+ 𝐵(𝜁∗)𝛽= 1 −𝜁∗
and
𝛼𝐴(𝜁∗)𝛼−1 + 𝛽𝐵(𝜁∗)𝛽−1 = −1
simultaneously we have
𝐴= (1 −𝛽)𝜁∗+ 𝛽
(𝛽−𝛼)(𝜁∗)𝛼
and
𝐵= (1 −𝛼)𝜁∗+ 𝛼
(𝛼−𝛽)(𝜁∗)𝛽.
By substituting the expressions for 𝐴and 𝐵into 𝛼𝐴+ 𝛽𝐵= 0 we have
𝛽(1 −𝛼)𝜁∗+ 𝛼𝛽
(𝛼−𝛽)(𝜁∗)𝛽
= 𝛼(1 −𝛽)𝜁∗+ 𝛼𝛽
(𝛼−𝛽)(𝜁∗)𝛼
or
𝛽(1 −𝛼)(𝜁∗)𝛼−𝛽+1 + 𝛼𝛽(𝜁∗)𝛼−𝛽−𝛼(1 −𝛽)𝜁∗−𝛼𝛽= 0.
Thus, 0 < 𝜁∗< 1 satisfies 𝑓(𝜁) = 0 where
𝑓(𝜁) = 𝛽(1 −𝛼)𝜁𝛼−𝛽+1 + 𝛼𝛽𝜁𝛼−𝛽−𝛼(1 −𝛽)𝜁−𝛼𝛽.
To show that 𝜁∗∈(0, 1) is unique for 𝐷> 0, we note that
√
(𝐷−𝑟−1
2𝜎2)2 + 2𝜎2𝐷=
√
(𝐷−𝑟)2 −(𝐷−𝑟)𝜎2 + 1
4𝜎4 + 2𝜎2𝐷
=
√
(𝐷−𝑟)2 + (𝐷+ 𝑟)𝜎2 + 1
4𝜎4
>
√
(𝐷−𝑟)2 + (𝐷−𝑟)𝜎2 + 1
4𝜎4
= 𝐷−𝑟+ 1
2𝜎2
and hence
𝛼=
−(𝐷−𝑟−1
2𝜎2) +
√
(𝐷−𝑟+ 1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
> 1
and
𝛽=
−(𝐷−𝑟−1
2𝜎2) −
√
(𝐷−𝑟+ 1
2𝜎2)2 + 2𝜎2𝐷
𝜎2
< 0.
Since
𝑓(0) = −𝛼𝛽> 0
and
𝑓(1) = 𝛽−𝛼< 0
then from the intermediate value theorem, 𝑓must have at least one root in the interval
(0,1).

6.2.2 Path-Dependent Options
627
For 𝜁∈(0, 1) and because
𝛽(1 −𝛼)(𝛼−𝛽+ 1) > 0,
𝛼𝛽(𝛼−𝛽) > 0
and
𝛼−𝛽> 1
therefore
𝑓′(𝜁) = 𝛽(1 −𝛼)(𝛼−𝛽+ 1)𝜁𝛼−𝛽+ 𝛼𝛽(𝛼−𝛽)𝜁𝛼−𝛽−1 −𝛼(1 −𝛽)
< 𝛽(1 −𝛼)(𝛼−𝛽+ 1) + 𝛼𝛽(𝛼−𝛽) −𝛼(1 −𝛽)
= (𝛼−𝛽)(𝛽−1)
< 0.
Thus, 𝑓is a monotonically decreasing function in 𝜁∈(0, 1) which implies that 𝑓(𝜁) = 0
has a unique solution in (0, 1).
Finally, when 𝐷= 0 then
𝛼= 2𝑟
𝜎2 + 1
and
𝛽= 0
and hence 𝜁∗= 0 since 𝑓(𝜁) = −
( 2𝑟
𝜎2 + 1
)
𝜁, which implies that the option problem does
not have a solution. This shows that it is never optimal to hold such an option in the absence
of an asset paying continuous dividend yields.
12. European Fixed Strike Lookback Option I. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
Consider a European-style fixed strike lookback call option with terminal payoff
Ψ(𝑆𝑇) = max
{
max
𝑡0≤𝑢≤𝑇𝑆𝑢−𝐾, 0
}
which depends on the maximum of the asset price reached within the lookback period
[𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇is the expiry time and 𝐾> 0 is the strike price.
By definition, under the risk-neutral measure ℚ, the value of a fixed strike lookback call
option at time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢, max
𝑡≤𝑢≤𝑇𝑆𝑢
}
−𝐾, 0
}|||||
ℱ𝑡
]
where 𝑟is the risk-free interest rate.

628
6.2.2 Path-Dependent Options
By considering two cases max
𝑡0≤𝑢≤𝑡𝑆𝑢≤𝐾and max
𝑡0≤𝑢≤𝑡𝑆𝑢> 𝐾, show that 𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇)
can be written as
𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢−𝐾, 0
}
+ ̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
where ̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max
𝑡≤𝑢≤𝑇𝑆𝑢−̂
𝐾, 0
}|||||
ℱ𝑡
]
such that
̂
𝐾= max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢, 𝐾
}
.
Using the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]
show that
̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [
𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑+) −
(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
]
where 𝐶𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) is the vanilla (or European) call option price defined as
𝐶𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
with
𝑑± =
log(𝑆𝑡∕̂
𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
̂𝑑± =
log(𝑆𝑡∕̂
𝐾) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛼= 𝑟−𝐷
1
2𝜎2 and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
Solution: Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
By writing
max
𝑡0≤𝑢≤𝑡𝑆𝑢= 𝑆max
𝑡−𝑡0,
max
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆max
𝑇−𝑡

6.2.2 Path-Dependent Options
629
hence
𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢, max
𝑡≤𝑢≤𝑇𝑆𝑢
}
−𝐾, 0
}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝐾, 0
}||||
ℱ𝑡
]
.
If 𝑆max
𝑡−𝑡0 ≤𝐾then
max
{
max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝐾, 0
}
= max {𝑆max
𝑇−𝑡−𝐾, 0}
and if 𝑆max
𝑡−𝑡0 > 𝐾then
max
{
max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝐾, 0
}
= 𝑆max
𝑡−𝑡0 −𝐾+ max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}
.
Thus, we can write
max
{
max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝐾, 0
}
= max
{
𝑆max
𝑡−𝑡0 −𝐾, 0
}
+ max
{
𝑆max
𝑇−𝑡−max{𝑆max
𝑡−𝑡0, 𝐾}, 0
}
.
By substituting this back into the fixed strike lookback option price, we have
𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑡−𝑡0 −𝐾, 0
}
+ max
{
𝑆max
𝑇−𝑡−max{𝑆max
𝑡−𝑡0, 𝐾}, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) max
{
𝑆max
𝑡−𝑡0 −𝐾, 0
}
+𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−max{𝑆max
𝑡−𝑡0, 𝐾}, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) max
{
𝑆max
𝑡−𝑡0 −𝐾, 0
}
+ ̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
where ̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−̂
𝐾, 0
}||||
ℱ𝑡
]
, ̂
𝐾= max
{
𝑆max
𝑡−𝑡0, 𝐾
}
.
From It¯o’s lemma we can write
𝑆max
𝑇−𝑡= max
𝑡≤𝑢≤𝑇𝑆𝑢
= max
𝑡≤𝑢≤𝑇𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑢−𝑡)+𝜎𝑊ℚ
𝑢−𝑡
= 𝑆𝑡𝑒𝑀𝑇−𝑡

630
6.2.2 Path-Dependent Options
where 𝑀𝑇−𝑡= max
𝑡≤𝑢≤𝑇𝜈(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡such that 𝜈= 𝑟−𝐷−1
2𝜎2. From Problem
4.2.2.15 of Problems and Solutions in Mathematical Finance, Volume 1: Stochastic
Calculus,
ℚ(𝑀𝑇−𝑡≤𝑥) = Φ
(
𝑥−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑒
2𝜈𝑥
𝜎2 Φ
(
−𝑥−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
,
𝑥≥0
and hence
̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆𝑡𝑒𝑀𝑇−𝑡−̂
𝐾, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̂
𝐾
ℚ(𝑆𝑡𝑒𝑀𝑇−𝑡≥𝑥) 𝑑𝑥
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̂
𝐾
ℚ
(
𝑒𝑀𝑇−𝑡≥𝑥
𝑆𝑡
)
𝑑𝑥
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
̂
𝐾
ℚ
(
𝑀𝑇−𝑡≥log
(
𝑥
𝑆𝑡
))
𝑑𝑥.
By substituting 𝑦= log (𝑥∕𝑆𝑡
) we have
̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
log( ̂
𝐾∕𝑆𝑡)
𝑆𝑡𝑒𝑦ℚ(𝑀𝑇−𝑡≥𝑦) 𝑑𝑦
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
∞
log( ̂
𝐾∕𝑆𝑡)
𝑒𝑦
[
Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+ 𝑒
2𝜈𝑦
𝜎2 Φ
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
𝑑𝑦
= 𝐴1 + 𝐴2
where
𝐴1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
∞
log( ̂
𝐾∕𝑆𝑡)
𝑒𝑦Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦
and
𝐴2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
∞
log( ̂
𝐾∕𝑆𝑡)
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦.

6.2.2 Path-Dependent Options
631
For the case 𝐴1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
∞
log( ̂
𝐾∕𝑆𝑡)
𝑒𝑦Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦and using integration by
parts with
𝑑𝑈
𝑑𝑦= 𝑒𝑦⇒𝑈= 𝑒𝑦
𝑉= Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
⇒𝑑𝑉
𝑑𝑦= −
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
−𝑦+𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
we can write
𝐴1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
⎧
⎪
⎨
⎪⎩
[
𝑒𝑦Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]∞
log( ̂
𝐾∕𝑆𝑡)
+ ∫
∞
log
(
̂
𝐾∕𝑆𝑡
)
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
𝑦−1
2
(
−𝑦+𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
𝑑𝑦
⎫
⎪
⎬
⎪⎭
= −𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log(𝑆𝑡∕̂
𝐾) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)
∫
∞
log
(
̂
𝐾∕𝑆𝑡
)
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 𝜈
𝜎2
)
𝑦−1
2
(
𝑦
𝜎
√
𝑇−𝑡
)2
𝑑𝑦.
From the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]
we have
𝐴1 = −𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log(𝑆𝑡∕̂
𝐾) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)+ 1
2
(
1+ 𝜈
𝜎2
)2
𝜎2(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= −̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log(𝑆𝑡∕̂
𝐾) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒
(
𝜈+ 1
2 𝜎2−𝑟
)
(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕̂
𝐾) +
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.

632
6.2.2 Path-Dependent Options
By substituting 𝜈= 𝑟−𝐷−1
2𝜎2 we obtain
𝐴1 = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
such that 𝑑± =
log(𝑆𝑡∕̂
𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Finally, for the case 𝐴2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
∞
log
(
̂
𝐾∕𝑆𝑡
) 𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
−𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦and
using integration by parts with
𝑑𝑈
𝑑𝑦= 𝑒
(
1+ 2𝜈
𝜎2
)
𝑦⇒𝑈=
(
1 + 2𝜈
𝜎2
)−1
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦
𝑉= Φ
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
⇒𝑑𝑉
𝑑𝑦= −
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
we can write
𝐴2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
⎧
⎪
⎨
⎪⎩
[
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]∞
log( ̂
𝐾∕𝑆𝑡)
+ ∫
∞
log
(
̂
𝐾∕𝑆𝑡
)
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦−1
2
(
−𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
𝑑𝑦
⎫
⎪
⎬
⎪⎭
= −𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log(𝑆𝑡∕̂
𝐾) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
∫
∞
log
(
̂
𝐾∕𝑆𝑡
)
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 𝜈
𝜎2
)
𝑦−1
2
(
𝑦
𝜎
√
𝑇−𝑡
)2
𝑑𝑦.
Using the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]

6.2.2 Path-Dependent Options
633
again we have
𝐴2 = −𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log(𝑆𝑡∕̂
𝐾) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)+ 1
2
(
1+ 𝜈
𝜎2
)2
𝜎2(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
⎡
⎢
⎢
⎢⎣
1 −Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
⎤
⎥
⎥
⎥⎦
= −𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log(𝑆𝑡∕̂
𝐾) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+
(𝜈+ 1
2𝜎2 −𝑟)(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
Φ
⎛
⎜
⎜
⎜⎝
log(𝑆𝑡∕̂
𝐾) +
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
By substituting 𝜈= 𝑟−𝐷−1
2𝜎2 and setting 𝛼= 𝑟−𝐷
1
2𝜎2 we obtain
𝐴2 = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝛼
Φ( ̂𝑑+) −𝑆𝑡𝑒−𝑟(𝑇−𝑡)
𝛼
(𝑆𝑡
̂
𝐾
)−𝛼
Φ( ̂𝑑−)
where ̂𝑑± =
log(𝑆𝑡∕̂
𝐾) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Hence,
̂𝐶𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [
𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑+) −
(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
]
.
By gathering all the results, we finally have
𝐶𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) max
{
𝑆max
𝑡−𝑡0 −𝐾, 0
}
+ 𝐶𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [
𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑+) −
(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
]
where ̂
𝐾= max
{
𝑆max
𝑡−𝑡0, 𝐾
}
.

634
6.2.2 Path-Dependent Options
13. European Fixed Strike Lookback Option II. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener pro-
cess on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with the
following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
We consider a European-style fixed strike lookback put option with terminal payoff
Ψ(𝑆𝑇) = max
{
𝐾−min
𝑡0≤𝑢≤𝑇𝑆𝑢, 0
}
which depends on the minimum of the asset price reached within the lookback period
[𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇is the expiry time and 𝐾> 0 is the strike price.
By definition, under the risk-neutral measure ℚthe value of a fixed strike lookback put
option at time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−min
{
min
𝑡0≤𝑢≤𝑡𝑆𝑢, min
𝑡≤𝑢≤𝑇𝑆𝑢
}
, 0
}|||||
ℱ𝑡
]
where 𝑟is the risk-free interest rate.
By considering two cases min
𝑡0≤𝑢≤𝑡𝑆𝑢≤𝐾and min
𝑡0≤𝑢≤𝑡𝑆𝑢> 𝐾, show that 𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇)
can be written as
𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) max
{
𝐾−min
𝑡0≤𝑢≤𝑡𝑆𝑢, 0
}
+ ̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
where ̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
̂
𝐾−min
𝑡≤𝑢≤𝑇𝑆𝑢, 0
}|||||
ℱ𝑡
]
such that
̂
𝐾= min
{
min
𝑡0≤𝑢≤𝑡𝑆𝑢, 𝐾
}
.
Using the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]
show that
̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ(−̂𝑑−) −𝑒−𝐷(𝑇−𝑡)Φ(−̂𝑑+)
]

6.2.2 Path-Dependent Options
635
where 𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) is the vanilla (or European) put option price defined as
𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = ̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with
𝑑± =
log(𝑆𝑡∕̂
𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
̂𝑑± =
log(𝑆𝑡∕̂
𝐾) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛼= 𝑟−𝐷
1
2𝜎2 and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
Solution: From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process.
By writing
min
𝑡0≤𝑢≤𝑡𝑆𝑢= 𝑆min
𝑡−𝑡0,
min
𝑡≤𝑢≤𝑇𝑆𝑢= 𝑆min
𝑇−𝑡
hence
𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−min
{
min
𝑡0≤𝑢≤𝑡𝑆𝑢, min
𝑡≤𝑢≤𝑇𝑆𝑢
}
, 0
}|||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
, 0
}||||
ℱ𝑡
]
.
If 𝑆min
𝑡−𝑡0 ≤𝐾then
max
{
𝐾−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
, 0
}
= 𝐾−𝑆min
𝑡−𝑡0 + max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}
and if 𝑆min
𝑡−𝑡0 > 𝐾then
max
{
𝐾−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
, 0
}
= max {𝐾−𝑆min
𝑇−𝑡, 0} .

636
6.2.2 Path-Dependent Options
Thus, we can write
max
{
𝐾−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
, 0
}
= max
{
𝐾−𝑆min
𝑡−𝑡0, 0
}
+ max
{
min{𝑆min
𝑡−𝑡0, 𝐾} −𝑆min
𝑇−𝑡, 0
}
.
By substituting this back into the fixed strike lookback option price, we have
𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝐾−𝑆min
𝑡−𝑡0, 0
}
+ max
{
min{𝑆min
𝑡−𝑡0, 𝐾} −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) max
{
𝐾−𝑆min
𝑡−𝑡0, 0
}
+𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
min{𝑆min
𝑡−𝑡0, 𝐾} −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) max
{
𝐾−𝑆min
𝑡−𝑡0, 0
}
+ ̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
where ̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
̂
𝐾−𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
, ̂
𝐾= min
{
𝑆min
𝑡−𝑡0, 𝐾
}
.
From It¯o’s lemma we can write
𝑆max
𝑇−𝑡= min
𝑡≤𝑢≤𝑇𝑆𝑢
= min
𝑡≤𝑢≤𝑇𝑆𝑡𝑒(𝑟−𝐷−1
2 𝜎2)(𝑢−𝑡)+𝜎𝑊ℚ
𝑢−𝑡
= 𝑆𝑡𝑒𝑚𝑇−𝑡
where 𝑚𝑇−𝑡= min
𝑡≤𝑢≤𝑇𝜈(𝑢−𝑡) + 𝜎𝑊ℚ
𝑢−𝑡such that 𝜈= 𝑟−𝐷−1
2𝜎2. From Problem 4.2.2.15
of Problems and Solutions in Mathematical Finance, Volume 1: Stochastic Calculus
ℚ(𝑚𝑇−𝑡≤𝑥) = Φ
(
𝑥−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+ 𝑒
2𝜈𝑥
𝜎2 Φ
(
𝑥+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
,
𝑥≤0.
Hence,
̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
̂
𝐾−𝑆𝑡𝑒𝑚𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
̂
𝐾
−∞
ℚ(𝑆𝑡𝑒𝑚𝑇−𝑡≤𝑥) 𝑑𝑥
= 𝑒−𝑟(𝑇−𝑡)
∫
̂
𝐾
−∞
ℚ
(
𝑒𝑚𝑇−𝑡≤𝑥
𝑆𝑡
)
𝑑𝑥
= 𝑒−𝑟(𝑇−𝑡)
∫
̂
𝐾
−∞
ℚ
(
𝑚𝑇−𝑡≤log
(
𝑥
𝑆𝑡
))
𝑑𝑥.

6.2.2 Path-Dependent Options
637
By substituting 𝑦= log (𝑥∕𝑆𝑡
) we have
̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑆𝑡𝑒𝑦ℚ(𝑚𝑇−𝑡≤𝑦) 𝑑𝑦
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
× ∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑒𝑦
[
Φ
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
+ 𝑒
2𝜈𝑦
𝜎2 Φ
(
𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]
𝑑𝑦
= 𝐵1 + 𝐵2
where
𝐵1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑒𝑦Φ
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦
and
𝐵2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦.
For the case 𝐵1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑒𝑦Φ
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦and using integration by
parts with
𝑑𝑈
𝑑𝑦= 𝑒𝑦⇒𝑈= 𝑒𝑦
𝑉= Φ
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
⇒𝑑𝑉
𝑑𝑦=
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
we can write
𝐵1 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
⎧
⎪
⎨
⎪⎩
[
𝑒𝑦Φ
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]log( ̂
𝐾∕𝑆𝑡)
−∞
−∫
log( ̂
𝐾∕𝑆𝑡)
−∞
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
𝑦−1
2
(
𝑦−𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
𝑑𝑦
⎫
⎪
⎬
⎪⎭
= 𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log( ̂
𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 𝜈
𝜎2
)
𝑦−1
2
(
𝑦
𝜎
√
𝑇−𝑡
)2
𝑑𝑦.

638
6.2.2 Path-Dependent Options
From the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]
we have
𝐵1 = 𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log( ̂
𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)+ 1
2
(
1+ 𝜈
𝜎2
)2
𝜎2(𝑇−𝑡)
Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
= ̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ
(
log( ̂
𝐾∕𝑆𝑡) −𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒
(
𝜈+ 1
2 𝜎2−𝑟
)
(𝑇−𝑡)Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.
By substituting 𝜈= 𝑟−𝐷−1
2𝜎2 we have
𝐵1 = ̂
𝐾𝑒−𝑟(𝑇−𝑡)Φ (−𝑑−
) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (−𝑑+
)
such that 𝑑± =
log(𝑆𝑡∕̂
𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Finally, for the case 𝐵2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
𝑑𝑦and
using integration by parts with
𝑑𝑈
𝑑𝑦= 𝑒
(
1+ 2𝜈
𝜎2
)
𝑦⇒𝑈=
(
1 + 2𝜈
𝜎2
)−1
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦
𝑉= Φ
(
𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
⇒𝑑𝑉
𝑑𝑦=
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
−1
2
(
𝑦+𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2

6.2.2 Path-Dependent Options
639
we can write
𝐵2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
⎧
⎪
⎨
⎪⎩
[
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦Φ
(
𝑦+ 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)]log( ̂
𝐾∕𝑆𝑡)
−∞
−∫
log( ̂
𝐾∕𝑆𝑡)
−∞
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 2𝜈
𝜎2
)
𝑦−1
2
(
𝑦+𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)2
𝑑𝑦
⎫
⎪
⎬
⎪⎭
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log( ̂
𝐾∕𝑆𝑡) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
∫
log( ̂
𝐾∕𝑆𝑡)
−∞
1
𝜎
√
2𝜋(𝑇−𝑡)
𝑒
(
1+ 𝜈
𝜎2
)
𝑦−1
2
(
𝑦
𝜎
√
𝑇−𝑡
)2
𝑑𝑦.
Using the identity
1
√
2𝜋𝜏∫
𝑈
𝐿
𝑒
𝑎𝑤−1
2 ( 𝑤
√
𝜏)2
𝑑𝑤= 𝑒
1
2 𝑎2𝜏
[
Φ
(
𝑈−𝑎𝜏
√
𝜏
)
−Φ
(
𝐿−𝑎𝜏
√
𝜏
)]
once again we have
𝐵2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log( ̂
𝐾∕𝑆𝑡) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−𝑆𝑡𝑒
−
(
𝑟+ 𝜈2
2𝜎2
)
(𝑇−𝑡)+ 1
2
(
1+ 𝜈
𝜎2
)2
𝜎2(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
= 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
(𝑆𝑡
̂
𝐾
)−
(
1+ 2𝜈
𝜎2
)
Φ
(
log( ̂
𝐾∕𝑆𝑡) + 𝜈(𝑇−𝑡)
𝜎
√
𝑇−𝑡
)
−
(𝜈+ 1
2𝜎2 −𝑟)(𝑇−𝑡)
(
1 + 2𝜈
𝜎2
)
Φ
⎛
⎜
⎜
⎜⎝
log( ̂
𝐾∕𝑆𝑡) −
(
1 + 𝜈
𝜎2
)
𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
⎞
⎟
⎟
⎟⎠
.

640
6.2.2 Path-Dependent Options
By substituting 𝜈= 𝑟−𝐷−1
2𝜎2 and setting 𝛼= 𝑟−𝐷
1
2𝜎2 we obtain
𝐵2 = 𝑆𝑡𝑒−𝑟(𝑇−𝑡)
𝛼
(𝑆𝑡
̂
𝐾
)−𝛼
Φ(−̂𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝛼
Φ(−̂𝑑+)
where ̂𝑑± =
log(𝑆𝑡∕̂
𝐾) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
Hence,
̂𝑃𝐹(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ(−̂𝑑−) −𝑒−𝐷(𝑇−𝑡)Φ(−̂𝑑+)
]
.
By gathering all the results, we finally have
𝑃𝐹(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡) max
{
𝐾−𝑆min
𝑡−𝑡0, 0
}
+ 𝑃𝑏𝑠(𝑆𝑡, 𝑡; ̂
𝐾, 𝑇)
+
(𝑆𝑡
𝛼
) [(𝑆𝑡
̂
𝐾
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ(−̂𝑑−) −𝑒−𝐷(𝑇−𝑡)Φ(−̂𝑑+)
]
where ̂
𝐾= min
{
𝑆min
𝑡−𝑡0, 𝐾
}
.
14. European Floating Strike Lookback Option I. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with
the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
We consider a European-style floating strike lookback call option with terminal payoff
Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾min, 0}
where the floating strike price 𝐾min is defined as 𝐾min = min
{
min
𝑡0≤𝑢≤𝑡𝑆𝑢, min
𝑡≤𝑢≤𝑇𝑆𝑢
}
,
which depends on the minimum of the asset price reached within the lookback period
[𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇is the option expiry time.
By definition, under the risk-neutral measure ℚthe value of a floating strike lookback
call option at time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝐶𝑓(𝑆𝑡, 𝑡; 𝐾min, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾min, 0}|| ℱ𝑡
]

6.2.2 Path-Dependent Options
641
where 𝑟is the risk-free interest rate. By setting 𝑆min
𝑡−𝑡0 = min
𝑡0≤𝑢≤𝑡𝑆𝑢, show that
𝐶𝑓(𝑆𝑡, 𝑡; 𝐾min, 𝑇) = 𝑆𝑡−𝑒−𝑟(𝑇−𝑡)𝑆min
𝑡−𝑡0 + ̂𝑃𝐹(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇)
where
̂𝑃𝐹(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇)
+
(𝑆𝑡
𝛼
) [(
𝑆𝑡
𝑆min
𝑡−𝑡0
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ(−̂𝑑−) −𝑒−𝐷(𝑇−𝑡)Φ(−̂𝑑+)
]
such that 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) is the European put option price defined as
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) = 𝑆min
𝑡−𝑡0𝑒−𝑟(𝑇−𝑡)Φ (−𝑑−
) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (−𝑑+
)
with
𝑑± =
log(𝑆𝑡∕𝑆min
𝑡−𝑡0) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
̂𝑑± =
log(𝑆𝑡∕𝑆min
𝑡−𝑡0) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛼= 𝑟−𝐷
1
2𝜎2 and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
Solution: By setting 𝑆min
𝑡−𝑡0 = min
𝑡0≤𝑢≤𝑡𝑆𝑢and 𝑆min
𝑇−𝑡= min
𝑡≤𝑢≤𝑇𝑆𝑢, we can write the payoff as
Ψ(𝑆𝑇) = max {𝑆𝑇−𝐾min, 0}
= max
{
𝑆𝑇−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
, 0
}
=
⎧
⎪
⎨
⎪⎩
max
{
𝑆𝑇−𝑆min
𝑡−𝑡0, 0
}
if 𝑆min
𝑡−𝑡0 ≤𝑆min
𝑇−𝑡
max {𝑆𝑇−𝑆min
𝑇−𝑡, 0}
if 𝑆min
𝑡−𝑡0 > 𝑆min
𝑇−𝑡
=
⎧
⎪
⎨
⎪⎩
𝑆𝑇−𝑆min
𝑡−𝑡0
if 𝑆min
𝑡−𝑡0 ≤𝑆min
𝑇−𝑡
𝑆𝑇−𝑆min
𝑇−𝑡
if 𝑆min
𝑡−𝑡0 > 𝑆min
𝑇−𝑡
= 𝑆𝑇−min
{
𝑆min
𝑡−𝑡0, 𝑆min
𝑇−𝑡
}
= 𝑆𝑇−𝑆min
𝑡−𝑡0 + max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}
.

642
6.2.2 Path-Dependent Options
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Thus, the option price at
time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝐶𝑓(𝑆𝑡, 𝑡; 𝐾min, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
𝑆𝑇−𝑆min
𝑡−𝑡0 + max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
𝑆𝑇−𝑆min
𝑡−𝑡0
||| ℱ𝑡
]
+ 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡) (
𝑆𝑡𝑒𝑟(𝑇−𝑡) −𝑆min
𝑡−𝑡0
)
+ 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
= 𝑆𝑡−𝑒−𝑟(𝑇−𝑡)𝑆min
𝑡−𝑡0 + 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
.
From Problem 6.2.2.13 (page 634) we can write
̂𝑃𝐹(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆min
𝑡−𝑡0 −𝑆min
𝑇−𝑡, 0
}||||
ℱ𝑡
]
where
̂𝑃𝐹(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) = 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇)
+
(𝑆𝑡
𝛼
) [(
𝑆𝑡
𝑆min
𝑡−𝑡0
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ(−̂𝑑−) −𝑒−𝐷(𝑇−𝑡)Φ(−̂𝑑+)
]
such that 𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) is the European put option price defined as
𝑃𝑏𝑠(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇) = 𝑆min
𝑡−𝑡0𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
with
𝑑± =
log(𝑆𝑡∕𝑆min
𝑡−𝑡0) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
̂𝑑± =
log(𝑆𝑡∕𝑆min
𝑡−𝑡0) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and 𝛼= 𝑟−𝐷
1
2𝜎2 .

6.2.2 Path-Dependent Options
643
Hence,
𝐶𝑓(𝑆𝑡, 𝑡; 𝐾min, 𝑇) = 𝑆𝑡−𝑒−𝑟(𝑇−𝑡)𝑆min
𝑡−𝑡0 + ̂𝑃𝐹(𝑆𝑡, 𝑡; 𝑆min
𝑡−𝑡0, 𝑇).
15. European Floating Strike Lookback Option II. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener
process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a GBM with
the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield and 𝜎is the volatility
parameter.
We consider a European-style floating strike lookback put option with terminal payoff
Ψ(𝑆𝑇) = max{𝐾max −𝑆𝑇, 0}
where the floating strike price 𝐾max is defined as 𝐾max = max
{
max
𝑡0≤𝑢≤𝑡𝑆𝑢, max
𝑡≤𝑢≤𝑇𝑆𝑢
}
which depends on the maximum of the asset price reached within the lookback period
[𝑡0, 𝑇], 𝑡0 ≥0 where 𝑇is the option expiry time.
By definition, under the risk-neutral measure ℚthe value of a floating strike lookback
put option at time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝑃𝑓(𝑆𝑡, 𝑡; 𝐾max, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝐾max −𝑆𝑇, 0}|| ℱ𝑡
]
where 𝑟is the risk-free interest rate. By setting 𝑆max
𝑡−𝑡0 = max
𝑡0≤𝑢≤𝑡𝑆𝑢, show that
𝑃𝑓(𝑆𝑡, 𝑡; 𝐾max, 𝑇) = ̂𝐶𝐹(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) + 𝑒−𝑟(𝑇−𝑡)𝑆max
𝑡−𝑡0 −𝑆𝑡
where
̂𝐶𝐹(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇)
+
(𝑆𝑡
𝛼
) [
𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑+) −
(
𝑆𝑡
𝑆max
𝑡−𝑡0
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
]
such that 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) is the European call option price defined as
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (𝑑+
) −𝑆max
𝑡−𝑡0𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)
with
𝑑± =
log(𝑆𝑡∕𝑆max
𝑡−𝑡0) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡

644
6.2.2 Path-Dependent Options
̂𝑑± =
log(𝑆𝑡∕𝑆max
𝑡−𝑡0) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
𝛼= 𝑟−𝐷
1
2𝜎2 and Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢is the cdf of a standard normal.
Solution: By setting 𝑆max
𝑡−𝑡0 = max
𝑡0≤𝑢≤𝑡𝑆𝑢and 𝑆max
𝑇−𝑡= max
𝑡≤𝑢≤𝑇𝑆𝑢, we can write the payoff as
Ψ(𝑆𝑇) = max {𝐾max −𝑆𝑇, 0}
= max
{
max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝑆𝑇, 0
}
=
⎧
⎪
⎨
⎪⎩
max
{
𝑆max
𝑡−𝑡0 −𝑆𝑇, 0
}
if 𝑆max
𝑇−𝑡≤𝑆max
𝑡−𝑡0
max {𝑆max
𝑇−𝑡−𝑆𝑇, 0}
if 𝑆max
𝑇−𝑡> 𝑆max
𝑡−𝑡0
=
⎧
⎪
⎨
⎪⎩
𝑆max
𝑡−𝑡0 −𝑆𝑇
if 𝑆max
𝑇−𝑡≤𝑆max
𝑡−𝑡0
𝑆max
𝑇−𝑡−𝑆𝑇
if 𝑆max
𝑇−𝑡> 𝑆max
𝑡−𝑡0
= max
{
𝑆max
𝑡−𝑡0, 𝑆max
𝑇−𝑡
}
−𝑆𝑇
= max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}
+ 𝑆max
𝑡−𝑡0 −𝑆𝑇.
Under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+
(𝜇−𝑟
𝜎
)
𝑡is a ℚ-standard Wiener process. Hence, the option price at
time 𝑡, 𝑡0 ≤𝑡≤𝑇is
𝑃𝑓(𝑆𝑡, 𝑡; 𝐾max, 𝑇)
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}
+ 𝑆max
𝑡−𝑡0 −𝑆𝑇
||||
ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}||||
ℱ𝑡
]
+ 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
𝑆max
𝑡−𝑡0 −𝑆𝑇||| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}||||
ℱ𝑡
]
+ 𝑒−𝑟(𝑇−𝑡) (
𝑆max
𝑡−𝑡0 −𝑆𝑡𝑒𝑟(𝑇−𝑡))
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}||||
ℱ𝑡
]
+ 𝑒−𝑟(𝑇−𝑡)𝑆max
𝑡−𝑡0 −𝑆𝑡.

6.2.2 Path-Dependent Options
645
From Problem 6.2.2.12 (page 627) we can write
̂𝐶𝐹(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
𝑆max
𝑇−𝑡−𝑆max
𝑡−𝑡0, 0
}||||
ℱ𝑡
]
where
̂𝐶𝐹(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) = 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇)
+
(𝑆𝑡
𝛼
) [
𝑒−𝐷(𝑇−𝑡)Φ( ̂𝑑+) −
(
𝑆𝑡
𝑆max
𝑡−𝑡0
)−𝛼
𝑒−𝑟(𝑇−𝑡)Φ( ̂𝑑−)
]
such that 𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) is the European call option price defined as
𝐶𝑏𝑠(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ (𝑑+
) −𝑆max
𝑡−𝑡0𝑒−𝑟(𝑇−𝑡)Φ (𝑑−
)
with
𝑑± =
log(𝑆𝑡∕𝑆max
𝑡−𝑡0) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
̂𝑑± =
log(𝑆𝑡∕𝑆max
𝑡−𝑡0) ± (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and 𝛼= 𝑟−𝐷
1
2𝜎2 .
Thus,
𝑃𝑓(𝑆𝑡, 𝑡; 𝐾max, 𝑇) = ̂𝐶𝐹(𝑆𝑡, 𝑡; 𝑆max
𝑡−𝑡0, 𝑇) + 𝑒−𝑟(𝑇−𝑡)𝑆max
𝑡−𝑡0 −𝑆𝑡.


7
Volatility Models
Within the framework of the Black–Scholes model, one of the incorrect assumptions of the
model is that the volatility of the underlying asset or stock price is constant. Empirical stud-
ies have found that by equating the theoretical Black–Scholes formula with market-quoted
European option prices, different volatility values are obtained for different strikes and option
expiries. However, this is due to the inherent property of the geometric Brownian motion
model, which tries to fit the log returns of asset prices that do not conform to the normal-
ity assumption as observed in the market. In this chapter we will discuss further developments
beyond the Black–Scholes framework where the volatility takes centre stage.
7.1
INTRODUCTION
In this section we consider different types of volatility which are used by practitioners as a
form of risk measurement.
Historical Volatility
Historical volatility reflects the past price movements of the underlying asset observed in the
market and is also referred to as the asset’s actual, realised or statistical volatility. In general,
historical volatility can also be considered as a standard deviation, which is a measure of the
amount of variation or dispersion for a specified period of asset prices. Thus, a higher disper-
sion value implies a higher risk that future asset prices will be further away from the current
price. To estimate the volatility parameter of a diffusion model, the most systematic way is to
use the maximum-likelihood method.
Suppose we have a sequence of random variables 𝑋1, 𝑋2, … , 𝑋𝑛having a joint density
𝑓𝑋1,𝑋2,…,𝑋𝑛(𝑥1, 𝑥2, … , 𝑥𝑛|| 𝜃) which depends on an unknown parameter 𝜃. Here, 𝜃may be
a vector. Given the observed values 𝑋𝑖= 𝑥𝑖where 𝑖= 1, 2, … , 𝑛, the likelihood of 𝜃as a
function of 𝑥1, 𝑥2, … , 𝑥𝑛is defined as
𝓁(𝜃) = 𝑓𝑋1,𝑋2,…,𝑋𝑛(𝑥1, 𝑥2, … , 𝑥𝑛|| 𝜃).
The maximum-likelihood estimate (mle) of 𝜃is that the value of 𝜃is chosen via optimisation
to maximise the joint density 𝑓𝑋1,𝑋2,…,𝑋𝑛(𝑥1, 𝑥2, … , 𝑥𝑛|| 𝜃).
If the random variables 𝑋1, 𝑋2, … , 𝑋𝑛are assumed to be independent and identically dis-
tributed, their joint density is the product of the marginal densities, and the likelihood becomes
𝓁(𝜃) = 𝑓𝑋1(𝑥1|| 𝜃)𝑓𝑋2(𝑥2|| 𝜃) … 𝑓𝑋𝑛(𝑥𝑛|| 𝜃).

648
7.1 Introduction
In contrast, if 𝑋1, 𝑋2, … , 𝑋𝑛are assumed to follow a Markov process, the joint density can
be represented as a product of conditional densities
𝓁(𝜃) = 𝑓𝑋1(𝑥1|| 𝜃)𝑓𝑋2|𝑋1(𝑥2|| 𝑥1, 𝜃) … 𝑓𝑋𝑛|𝑋𝑛−1(𝑥𝑛|| 𝑥𝑛−1, 𝜃).
For certain probability density functions, rather than maximising the likelihood function, it is
more efficient to maximise the natural logarithm (since the logarithm is a monotone function).
Hence, for an independent and identically distributed sample, the log-likelihood in terms of
marginal densities is
log 𝓁(𝜃) = log 𝑓𝑋1(𝑥1|| 𝜃) + log 𝑓𝑋2(𝑥2|| 𝜃) + … + log 𝑓𝑋𝑛(𝑥𝑛|| 𝜃)
whilst for the conditional densities
log 𝓁(𝜃) = log 𝑓𝑋1(𝑥1|| 𝜃) + log 𝑓𝑋2|𝑋1(𝑥2|| 𝑥1, 𝜃) + … + log 𝑓𝑋𝑛|𝑋𝑛−1(𝑥𝑛|| 𝑥𝑛−1, 𝜃).
In statistics, the maximum-likelihood estimate for a parameter 𝜃is denoted by ̂𝜃, and is
obtained by solving the first-order necessary condition of a local maximiser
𝜕𝓁(𝜃)
𝜕𝜃
||||𝜃=̂𝜃
= 0 or 𝜕log 𝓁(𝜃)
𝜕𝜃
||||𝜃=̂𝜃
= 0.
Implied Volatility
Recall that the Black–Scholes formula for a European option price 𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) at time 𝑡,
written on asset price 𝑆𝑡with strike price 𝐾and expiry 𝑇> 𝑡, is
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
with
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟+ 𝐷± 1
2𝜎2(𝑇−𝑡))
𝜎
√
𝑇−𝑡
, Φ(𝑥) = ∫
𝑥
−∞
1
√
2𝜋
𝑒−1
2 𝑢2𝑑𝑢
where 𝑟is the risk-free interest rate, 𝐷is the continuous dividend yield on the underlying asset
and 𝜎is the asset price volatility which is the only parameter that is not directly observed.
In the simplest terms, the volatility parameter can be estimated from historical price data on
the asset price 𝑆𝑡, and with the calibrated value it can then be used in the Black–Scholes
formula to value any contingent claim written on 𝑆𝑡. In addition, all other options can also be
priced with the same estimated volatility irrespective of the strike price 𝐾and expiry time 𝑇.
Although this approach is feasible and easy to implement, there is no single calculation for
historical volatility. For example, the choice of the number of historical days for the volatility
estimation will have a direct impact on the calculation and hence, the estimated volatility might
be unreliable.

7.1 Introduction
649
Instead of relying on historical price movements of the asset price, an alternate volatility
estimation can be calculated involving the Black–Scholes theoretical formula. As the volatility
𝜎is the only unobservable parameter, and given that the vega of the Black–Scholes formula
of either a call or put option is positive,
𝜕𝑉𝑏𝑠
𝜕𝜎
> 0
for all 𝜎, therefore if we know the market price of the European option 𝑉mkt written on asset
price 𝑆𝑡and traded at time 𝑡with strike 𝐾and expiry 𝑇, then there exists a unique 𝜎= 𝜎imp
known as the implied volatility such that
𝑉𝑏𝑠(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎imp) = 𝑉mkt
provided 𝑉mkt lies between
𝑉mkt ≤
⎧
⎪
⎨
⎪⎩
𝑆𝑡
for call option
𝐾
for put option
and
𝑉mkt ≥
⎧
⎪
⎨
⎪⎩
max {𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}
for call option
max {𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}
for put option.
According to the Black–Scholes assumptions, the implied volatility calculated at time 𝑡should
be a constant value or time dependent across all strike prices 𝐾and option expiries 𝑇. However,
in reality, it shows variations with both strike (known as volatility smile or volatility skew) and
expiry 𝑇(known as term structure of volatility). Given that the implied volatility 𝜎imp(𝐾, 𝑇)
for a certain strike 𝐾and expiry 𝑇has a fixed value, the relation 𝜎imp(𝐾, 𝑇) is called an implied
volatility surface.
Local Volatility
As the calculated implied volatility is not a constant value by varying the strike and option
expiry, the most straightforward strategy is to modify the Black–Scholes model by assuming
the asset price volatility 𝜎(𝑆𝑡, 𝑡) is a function of both the underlying asset price and time. By
doing so, not only will it be able to accommodate the implied volatility for discrete strike prices
and expiry times, but it will also allow us to price options consistently at any moment in time.
In a local volatility model, the underlying asset price 𝑆𝑡follows a modified SDE of the form
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊𝑡

650
7.1 Introduction
where 𝑊𝑡is the standard Wiener process, 𝜇is the drift, 𝐷is the continuous dividend yield and
𝜎(𝑆𝑡, 𝑡) is the local volatility function depending on the asset price 𝑆𝑡and time 𝑡.
By substituting the constant or time-dependent volatility with 𝜎(𝑆𝑡, 𝑡), the Black–Scholes
PDE satisfied by a European-style option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) with strike 𝐾, expiry 𝑇> 𝑡and having
a payoff Ψ(𝑆𝑇),
𝜕𝑉
𝜕𝑡+ 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇)
still remains valid and the option price at time 𝑡,
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
as the present value of the expected payoff under the risk-neutral measure ℚremains the same.
However, given that the volatility is now a function of the underlying asset price and time, the
Black–Scholes analytical solution is not extended for this model.
Given the current asset price 𝑆𝑡, the local volatility function 𝜎(𝑆𝑡, 𝑡) can be obtained
uniquely from market quotes of European call option prices 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) (or put option prices
𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)) across all strikes 𝐾and expiry times 𝑇through the Dupire formula
𝜎(𝐾, 𝑇) =
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪⎩
√
√
√
√
√
√
√
(𝜕𝐶
𝜕𝑇+ (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
)
𝐾2 𝜕2𝐶
𝜕𝐾2
for European call option
√
√
√
√
√
√
√
(𝜕𝑃
𝜕𝑇+ (𝑟−𝐷)𝐾𝜕𝑃
𝜕𝐾+ 𝐷𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
)
𝐾2 𝜕2𝑃
𝜕𝐾2
for European put option.
If we have a sequence of market-quoted European call (or put) option prices 𝐶mkt(𝑆𝑡, 𝑡; 𝐾𝑖, 𝑇𝑗)
(or 𝑃mkt(𝑆𝑡, 𝑡; 𝐾𝑖, 𝑇𝑗)) of different strikes 𝐾𝑖, 𝑖= 1, 2, … , 𝑁and expiries 𝑇𝑗, 𝑗= 1, 2, … , 𝑀,
we can first interpolate and extrapolate these prices to produce a smooth surface. Assuming that
the surface is twice continuously differentiable in 𝐾and 𝑇, we can then subsequently utilise
the Dupire formula to determine the local volatility for any arbitrary strikes and expiries.
In addition, the local volatility function can also be expressed in terms of the implied volatil-
ity 𝜎imp, given as
𝜎(𝐾, 𝑇) =
√
√
√
√
√
√
√
√
√
√
2
(𝜕𝜎imp
𝜕𝑇
+ (𝑟−𝐷)𝐾
𝜕𝜎imp
𝜕𝐾
+ 1
2
𝜎imp
𝑇−𝑡
)
𝐾2 𝜕2𝜎imp
𝜕𝐾2
+
2𝐾𝑑imp
+
𝜎imp
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+
𝐾2𝑑imp
+ 𝑑imp
−
𝜎imp
(𝜕𝜎imp
𝜕𝐾
)2
+
1
𝜎imp
√
𝑇−𝑡

7.1 Introduction
651
such that
𝑑imp
±
=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2
imp)(𝑇−𝑡)
𝜎imp
√
𝑇−𝑡
where, analogous to the Dupire formula, an implied volatility surface is first produced using
the market-quoted European call (or put) option prices for a range of strikes and expiries before
utilising the above formula to calculate the local volatility function for any arbitrary strikes and
expiries.
Stochastic Volatility
As observed in the market, the distribution of the returns of the asset prices shows that it is
highly peaked and fat-tailed, which deviates from the assumption of normality. To resolve this
shortcoming of the Black–Scholes model, we can either choose a jump-diffusion model or
we can assume that the volatility of the underlying asset price is a stochastic process (i.e., a
stochastic volatility model). When modelling the asset price as a jump-diffusion model, we
assume that the prices do not move continuously in time and we can then let the model make
discrete jumps based on a Poisson process. In contrast, when modelling the asset price volatility
as a stochastic process we assume that the volatility is a continuous random variable in order
to describe the fat-tailed distribution of the asset price returns.
In a general stochastic volatility model, the underlying asset price return and its instanta-
neous volatility have the following diffusion processes
𝑑𝑆𝑡
𝑆𝑡
= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡)𝑑𝑊𝑆
𝑡
𝑑𝑌𝑡= 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑊𝑌
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑌
𝑡
= 𝜌𝑑𝑡
where {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑌
𝑡
: 𝑡≥0} are two correlated standard Wiener processes under
the physical measure ℙwith correlation value 𝜌∈(−1, 1), 𝑆𝑡is the underlying asset price,
𝜇(𝑆𝑡, 𝑌𝑡, 𝑡) is the asset price drift and 𝜎(𝑌𝑡, 𝑡) is the asset instantaneous volatility, which is
assumed to be a stochastic process having drift 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡) and volatility (known as vol-of-vol)
𝛽(𝑆𝑡, 𝑌𝑡, 𝑡).
Like the jump-diffusion model, the market we have described above is incomplete since
there is only one traded asset and two sources of uncertainty (Wiener processes 𝑊𝑆
𝑡and 𝑊𝑌
𝑡).
In addition, the modelling of the volatility as a stochastic process is more challenging, since it
is a hidden process and is not directly observable. Thus, the calibration of the model parameters
against existing market data is harder as it contains more parameters to estimate than a simple
Black–Scholes model.

652
7.2.1 Historical and Implied Volatility
7.2
PROBLEMS AND SOLUTIONS
7.2.1
Historical and Implied Volatility
1. Estimation of Geometric Brownian Motion Parameters. Let 𝑆𝑡, 𝑆𝑡+Δ𝑡, 𝑆𝑡+2Δ𝑡, …, 𝑆𝑡+𝑁Δ𝑡
with Δ𝑡= (𝑇−𝑡)∕𝑁be a sequence of discrete values observed at regular time intervals
Δ𝑡> 0 which are assumed to follow a GBM process
𝑑𝑆𝑡= 𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡
where the drift 𝜇and volatility 𝜎are constant parameters and 𝑊𝑡is a standard Wiener
process on the probability space (Ω, ℱ, ℙ).
Using maximum-likelihood estimation or otherwise, calculate the historical estimates
of 𝜇and 𝜎.
Solution: From It¯o’s formula
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
=
(
𝜇−1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊𝑡
and taking integrals
∫
𝑡+Δ𝑡
𝑡
𝑑log 𝑆𝑢= ∫
𝑡+Δ𝑡
𝑡
(
𝜇−1
2𝜎2)
𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎𝑑𝑊𝑢
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
=
(
𝜇−1
2𝜎2)
Δ𝑡+ 𝜎𝑊Δ𝑡
where 𝑊Δ𝑡∼(0, Δ𝑡).
Therefore,
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
∼
[(
𝜇−1
2𝜎2)
Δ𝑡, 𝜎2Δ𝑡
]
.
Maximum-Likelihood Estimation Method
Using the maximum-likelihood method, the likelihood function is the joint density of
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)
, log
(𝑆𝑡+2Δ𝑡
𝑆𝑡+Δ𝑡
)
, … , log
(
𝑆𝑡+𝑁Δ𝑡
𝑆𝑡+(𝑁−1)Δ𝑡
)
which is a product of their marginal
densities
𝓁(𝜇, 𝜎) =
𝑁
∏
𝑖=1
1
𝜎
√
2𝜋Δ𝑡
exp
⎡
⎢
⎢
⎢
⎢
⎢⎣
−1
2
⎛
⎜
⎜
⎜
⎜⎝
log
(
𝑆𝑡+𝑖Δ𝑡
𝑆𝑡+(𝑖−1)Δ𝑡
)
−
(
𝜇−1
2𝜎2)
Δ𝑡
𝜎
√
Δ𝑡
⎞
⎟
⎟
⎟
⎟⎠
2⎤
⎥
⎥
⎥
⎥
⎥⎦
=
𝑁
∏
𝑖=1
1
𝜎
√
2𝜋Δ𝑡
exp
⎡
⎢
⎢
⎢⎣
−1
2
⎛
⎜
⎜
⎜⎝
𝑅𝑖−
(
𝜇−1
2𝜎2)
Δ𝑡
𝜎
√
Δ𝑡
⎞
⎟
⎟
⎟⎠
2⎤
⎥
⎥
⎥⎦

7.2.1 Historical and Implied Volatility
653
where 𝑅𝑖= log
(
𝑆𝑡+𝑖Δ𝑡
𝑆𝑡+(𝑖−1)Δ𝑡
)
, 𝑖= 1, 2, … , 𝑁.
Taking the log-likelihood
log 𝓁(𝜇, 𝜎) = −𝑁log 𝜎−𝑁
2 log(2𝜋Δ𝑡) −
1
2𝜎2Δ𝑡
𝑁
∑
𝑖=1
(
𝑅𝑖−
(
𝜇−1
2𝜎2)
Δ𝑡
)2
and partial differentials with respect to 𝜇and 𝜎,
𝜕log 𝓁
𝜕𝜇
= 1
𝜎2
𝑁
∑
𝑖=1
(
𝑅𝑖−
(
𝜇−1
2𝜎2)
Δ𝑡
)
𝜕log 𝓁
𝜕𝜎
= −𝑁
𝜎+
1
𝜎3Δ𝑡
𝑁
∑
𝑖=1
(
𝑅𝑖−
(
𝜇−1
2𝜎2)
Δ𝑡
)2
−1
𝜎
𝑁
∑
𝑖=1
(
𝑅𝑖−
(
𝜇−1
2𝜎2)
Δ𝑡
)
.
By setting 𝜕log 𝓁
𝜕𝜇
= 0 and 𝜕log 𝓁
𝜕𝜎
= 0, the maximum-likelihood estimates ̂𝜇and ̂𝜎
satisfy
(
̂𝜇−1
2 ̂𝜎2)
Δ𝑡= ̄𝑅
and
−𝑁
̂𝜎+
1
̂𝜎3Δ𝑡
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2 −1
̂𝜎
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅) = 0
where ̄𝑅= 1
𝑁
𝑁
∑
𝑖=1
𝑅𝑖.
Thus, we have
̂𝜇= 1
Δ𝑡
(
̄𝑅+
1
2𝑁
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2
)
and
̂𝜎=
√
√
√
√
1
𝑁Δ𝑡
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2.
Moment-Matching Estimation Method
Since
𝔼ℚ
[
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)|||||
ℱ𝑡
]
=
(
𝜇−1
2𝜎2)
Δ𝑡
Varℚ
[
log
(𝑆𝑡+Δ𝑡
𝑆𝑡
)|||||
ℱ𝑡
]
= 𝜎2Δ𝑡

654
7.2.1 Historical and Implied Volatility
and by setting the logarithm return
𝑅𝑖= log
(
𝑆𝑡+𝑖Δ𝑡
𝑆𝑡+(𝑖−1)Δ𝑡
)
where 𝑅𝑖= 1, 2, … , 𝑁are independent and identically distributed, the estimates of ̂𝜇and
̂𝜎are given by
(
̂𝜇−1
2 ̂𝜎2)
Δ𝑡= ̄𝑅
and
̂𝜎2Δ𝑡=
1
(𝑁−1)Δ𝑡
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2
where ̄𝑅= 1
𝑁
𝑁
∑
𝑖=1
𝑅𝑖. Thus, we have
̂𝜇= 1
Δ𝑡
(
̄𝑅+
1
2(𝑁−1)
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2
)
and
̂𝜎=
√
√
√
√
1
(𝑁−1)Δ𝑡
𝑁
∑
𝑖=1
(𝑅𝑖−̄𝑅)2.
2. Estimation of Ornstein–Uhlenbeck Process Parameters. Let 𝑆𝑡, 𝑆𝑡+Δ𝑡, 𝑆𝑡+2Δ𝑡, …, 𝑆𝑡+𝑁Δ𝑡
with Δ𝑡= (𝑇−𝑡)∕𝑁be a sequence of discrete values observed at regular time intervals
Δ𝑡> 0 which are assumed to follow an Ornstein–Uhlenbeck process
𝑑𝑆𝑡= 𝜅(𝜃−𝑆𝑡)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where the mean-reversion rate 𝜅, long-term mean 𝜃and volatility 𝜎are constant parameters
and 𝑊𝑡is a standard Wiener process on the probability space (Ω, ℱ, ℙ).
Using maximum-likelihood estimation or otherwise, calculate the historical estimates
of 𝜅, 𝜃and 𝜎.
Solution: From the Ornstein–Uhlenbeck process
𝑑𝑆𝑡= 𝜅(𝜃−𝑆𝑡)𝑑𝑡+ 𝜎𝑑𝑊𝑡
and by applying It¯o’s formula on 𝑒𝜅𝑡𝑆𝑡we have
𝑑(𝑒𝜅𝑡𝑆𝑡) = 𝜅𝑒𝜅𝑡𝑆𝑡𝑑𝑡+ 𝑒𝜅𝑡𝑑𝑆𝑡+ 1
2𝜅2𝑒𝜅𝑡𝑆𝑡(𝑑𝑡)2 + …
= 𝜅𝑒𝜅𝑡𝑆𝑡𝑑𝑡+ 𝑒𝜅𝑡(𝜅(𝜃−𝑆𝑡)𝑑𝑡+ 𝜎𝑑𝑊𝑡
)
= 𝜅𝜃𝑒𝜅𝑡𝑑𝑡+ 𝜎𝑒𝜅𝑡𝑑𝑊𝑡.

7.2.1 Historical and Implied Volatility
655
Integrating the above expression,
∫
𝑡+Δ𝑡
𝑡
𝑑(𝑒𝜅𝑢𝑆𝑢) = ∫
𝑡+Δ𝑡
𝑡
𝜅𝜃𝑒𝜅𝑢𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎𝑒𝜅𝑢𝑑𝑊𝑢
𝑆𝑡+Δ𝑡= 𝑆𝑡𝑒−𝜅Δ𝑡+ 𝜃(1 −𝑒−𝜅Δ𝑡) + ∫
𝑡+Δ𝑡
𝑡
𝜎𝑒−𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑊𝑢.
Given that both {𝑊𝑡: 𝑡≥0} and {𝑊2
𝑡−𝑡: 𝑡≥0} are ℙ-martingales, we have
𝔼
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑒−𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑊𝑢
|||||
ℱ𝑡
]
= 0
and
𝔼
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑒−𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑊𝑢
)2||||||
ℱ𝑡
]
= 𝔼
[
∫
𝑡+Δ𝑡
𝑡
𝜎2𝑒−2𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑢
|||||
ℱ𝑡
]
= 𝜎2
2𝜅
(1 −𝑒−2𝜅Δ𝑡)
and following the arguments given in Problem 2.2.2.31 (page 161) we can deduce
𝑆𝑡+Δ𝑡|| 𝑆𝑡∼
(
𝑆𝑡𝑒−𝜅Δ𝑡+ 𝜃(1 −𝑒−𝜅Δ𝑡) , 𝜎2
2𝜅
(1 −𝑒−2𝜅Δ𝑡))
.
To calculate the estimates of 𝜅, 𝜃and 𝜎, we consider two approaches.
Maximum-Likelihood Estimation Method
By setting 𝑠2 = 𝜎2
2𝜅
(1 −𝑒−2𝜅Δ𝑡), the likelihood function is the joint density of 𝑆𝑡, 𝑆𝑡+Δ𝑡,
…, 𝑆𝑡+𝑁Δ𝑡such that
𝓁(𝜅, 𝜃, 𝑠) =
𝑁
∏
𝑖=1
1
𝑠
√
2𝜋
exp
⎡
⎢
⎢⎣
−1
2
(
𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−𝜅Δ𝑡−𝜃(1 −𝑒−𝜅Δ𝑡)
𝑠
)2⎤
⎥
⎥⎦
and taking the log-likelihood
log 𝓁(𝜅, 𝜃, 𝑠) = −𝑁log 𝑠−𝑁
2 log(2𝜋)
−1
2𝑠2
𝑁
∑
𝑖=1
[𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−𝜅Δ𝑡−𝜃(1 −𝑒−𝜅Δ𝑡)]2 .

656
7.2.1 Historical and Implied Volatility
Taking partial differentials with respect to 𝜅, 𝜃and 𝑠,
𝜕log 𝓁
𝜕𝜅
= −1
𝑠2
𝑁
∑
𝑖=1
[𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−𝜅Δ𝑡−𝜃(1 −𝑒−𝜅Δ𝑡)] [𝑆𝑡+(𝑖−1)Δ𝑡−𝜃] Δ𝑡𝑒−𝜅Δ𝑡
= −Δ𝑡𝑒−𝜅Δ𝑡
𝑠2
𝑁
∑
𝑖=1
[(𝑆𝑡+𝑖Δ𝑡−𝜃) (𝑆𝑡+(𝑖−1)Δ𝑡−𝜃) −(𝑆𝑡+(𝑖−1)Δ𝑡−𝜃)2 𝑒−𝜅Δ𝑡]
𝜕log 𝓁
𝜕𝜃
= 1 −𝑒−𝜅Δ𝑡
𝑠2
𝑁
∑
𝑖=1
[𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−𝜅Δ𝑡−𝜃(1 −𝑒−𝜅Δ𝑡)]
𝜕log 𝓁
𝜕𝑠
= −𝑁
𝑠+ 1
𝑠3
𝑁
∑
𝑖=1
[𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−𝜅Δ𝑡−𝜃(1 −𝑒−𝜅Δ𝑡)]2 .
By setting 𝜕log 𝓁
𝜕𝜅
= 0, 𝜕log 𝓁
𝜕𝜃
= 0 and 𝜕log 𝓁
𝜕𝑠
= 0, the maximum-likelihood estimates
̂𝜅, ̂𝜃and ̂𝑠are
̂𝜅= −1
Δ𝑡log
[∑𝑁
𝑖=1(𝑆𝑡+𝑖Δ𝑡−̂𝜃)(𝑆𝑡+(𝑖−1)Δ𝑡−̂𝜃)
∑𝑁
𝑖=1(𝑆𝑡+(𝑖−1)Δ𝑡−̂𝜃)2
]
̂𝜃=
∑𝑁
𝑖=1(𝑆𝑡+𝑖Δ𝑡−𝑆𝑡+(𝑖−1)Δ𝑡𝑒−̂𝜅Δ𝑡)
𝑁(1 −𝑒−̂𝜅Δ𝑡)
̂𝑠2 = 1
𝑁
𝑁
∑
𝑖=1
[𝑆𝑡+𝑖Δ𝑡−̂𝜃−(𝑆𝑡+(𝑖−1)Δ𝑡−̂𝜃)𝑒−̂𝜅Δ𝑡]2 .
Letting
𝑆𝑥=
𝑁
∑
𝑖=1
𝑆𝑡+(𝑖−1)Δ𝑡,
𝑆𝑦=
𝑁
∑
𝑖=1
𝑆𝑡+𝑖Δ𝑡
𝑆𝑥𝑥=
𝑁
∑
𝑖=1
𝑆2
𝑡+(𝑖−1)Δ𝑡,
𝑆𝑦𝑦=
𝑁
∑
𝑖=1
𝑆2
𝑡+𝑖Δ𝑡,
𝑆𝑥𝑦=
𝑁
∑
𝑖=1
𝑆𝑡+(𝑖−1)Δ𝑡𝑆𝑡+𝑖Δ𝑡
we have
̂𝜅= −1
Δ𝑡log
[
𝑆𝑥𝑦−̂𝜃(𝑆𝑥+ 𝑆𝑦) + 𝑁̂𝜃2
𝑆𝑥𝑥−2 ̂𝜃𝑆𝑥+ 𝑁̂𝜃2
]
̂𝜃=
𝑆𝑦−𝑆𝑥𝑒−̂𝜅Δ𝑡
𝑁(1 −𝑒−̂𝜅Δ𝑡)
̂𝑠2 = 1
𝑁
[𝑆𝑦𝑦−2𝑆𝑥𝑦𝑒−̂𝜅Δ𝑡+ 𝑆𝑥𝑥𝑒−2̂𝜅Δ𝑡−2 ̂𝜃(𝑆𝑦−𝑆𝑥𝑒−̂𝜅Δ𝑡)(1 −𝑒−̂𝜅Δ𝑡)
+𝑁̂𝜃2(1 −𝑒−̂𝜅Δ𝑡)2] .

7.2.1 Historical and Implied Volatility
657
Substituting ̂𝜅into ̂𝜃,
𝑁̂𝜃=
𝑆𝑦(𝑆𝑥𝑥−2 ̂𝜃+ 𝑁̂𝜃2) −𝑆𝑥(𝑆𝑥𝑦−̂𝜃𝑆𝑥−̂𝜃𝑆𝑦+ 𝑁̂𝜃2)
𝑆𝑥𝑥−𝑆𝑥𝑦+ ̂𝜃(𝑆𝑦−𝑆𝑥)
=
𝑆𝑦𝑆𝑥𝑥−𝑆𝑥𝑆𝑥𝑦+ ̂𝜃(𝑆2
𝑥−𝑆𝑥𝑆𝑦) + 𝑁̂𝜃2(𝑆𝑦−𝑆𝑥)
𝑆𝑥𝑥−𝑆𝑥𝑦+ ̂𝜃(𝑆𝑦−𝑆𝑥)
or
𝑁̂𝜃(𝑆𝑥𝑥−𝑆𝑥𝑦) + 𝑁̂𝜃2(𝑆𝑦−𝑆𝑥) = 𝑆𝑦𝑆𝑥𝑥−𝑆𝑥𝑆𝑥𝑦+ ̂𝜃(𝑆2
𝑥−𝑆𝑥𝑆𝑦) + 𝑁̂𝜃2(𝑆𝑦−𝑆𝑥)
and hence
̂𝜃=
𝑆𝑦𝑆𝑥𝑥−𝑆𝑥𝑆𝑥𝑦
𝑁(𝑆𝑥𝑥−𝑆𝑥𝑦) −𝑆2
𝑥+ 𝑆𝑥𝑆𝑦
with the maximum-likelihood estimates of mean-reversion rate ̂𝜅and volatility ̂𝜎being
̂𝜅= −1
Δ𝑡log
[
𝑆𝑥𝑦−̂𝜃(𝑆𝑥+ 𝑆𝑦) + 𝑁̂𝜃2
𝑆𝑥𝑥−2 ̂𝜃𝑆𝑥+ 𝑁̂𝜃2
]
and
̂𝜎=
√
2̂𝜅̂𝑠
1 −𝑒−2̂𝜅Δ𝑡
respectively.
Ordinary Least-Squares Method
We let the relationship between consecutive 𝑆𝑡, 𝑆𝑡+Δ𝑡, … , 𝑆𝑡+𝑁Δ𝑡be
𝑆𝑡+Δ𝑡= 𝑚𝑆𝑡+ 𝑐+ 𝜖𝑡, 𝜖𝑡∼(0, 𝜎2
𝜖)
where 𝑚and 𝑐are the regression parameters, 𝜖𝑡is normally distributed and is independent
and identically distributed.
By comparing the relationship between the linear fit and the solution of the Ornstein–
Uhlenbeck process model
𝑆𝑡+Δ𝑡= 𝑆𝑡𝑒−𝜅Δ𝑡+ 𝜃(1 −𝑒−𝜅Δ𝑡) + ∫
𝑡+Δ𝑡
𝑡
𝜎𝑒−𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑊𝑢
where ∫
𝑡+Δ𝑡
𝑡
𝜎𝑒−𝜅(𝑡+Δ𝑡−𝑢)𝑑𝑊𝑢∼
(
0, 𝜎2
2𝜅
(1 −𝑒−2𝜅Δ𝑡))
, the Ornstein–Uhlenbeck
parameters can be equated as
𝜅= −log 𝑚
Δ𝑡,
𝜃=
𝑐
1 −𝑚
and
𝜎= 𝜎𝜖
√
2𝜅
1 −𝑒−2𝜅Δ𝑡.

658
7.2.1 Historical and Implied Volatility
As for estimating the pair (𝑚, 𝑐), we can compute it by solving the following ordinary
least-squares problem
OLS
{
minimise
𝑚,𝑐∈ℝ
𝑁
∑
𝑖=1
(𝑆𝑡+𝑖Δ𝑡−𝑚𝑆𝑡+(𝑖−1)Δ𝑡−𝑐)2 .
By setting 𝑓(𝑚, 𝑐) =
𝑁
∑
𝑖=1
(𝑆𝑡+𝑖Δ𝑡−𝑚𝑆𝑡+(𝑖−1)Δ𝑡−𝑐)2 and taking partial derivatives with
respect to 𝑚and 𝑐,
𝜕𝑓
𝜕𝑚= −2
𝑁
∑
𝑖=1
(𝑆𝑡+𝑖Δ𝑡−𝑚𝑆𝑡+(𝑖−1)Δ𝑡−𝑐) 𝑆𝑡+(𝑖−1)Δ𝑡= −2(𝑆𝑥𝑦−𝑚𝑆𝑥𝑥−𝑐𝑆𝑥)
𝜕𝑓
𝜕𝑐= −2
𝑁
∑
𝑖=1
(𝑆𝑡+𝑖Δ𝑡−𝑚𝑆𝑡+(𝑖−1)Δ𝑡−𝑐) = −2(𝑆𝑦−𝑚𝑆𝑥−𝑐𝑁)
where
𝑆𝑥=
𝑁
∑
𝑖=1
𝑆𝑡+(𝑖−1)Δ𝑡,
𝑆𝑦=
𝑁
∑
𝑖=1
𝑆𝑡+𝑖Δ𝑡
𝑆𝑥𝑥=
𝑁
∑
𝑖=1
𝑆2
𝑡+(𝑖−1)Δ𝑡,
𝑆𝑦𝑦=
𝑁
∑
𝑖=1
𝑆2
𝑡+𝑖Δ𝑡,
𝑆𝑥𝑦=
𝑁
∑
𝑖=1
𝑆𝑡+(𝑖−1)Δ𝑡𝑆𝑡+𝑖Δ𝑡.
By setting the partial derivatives to zero and solving the linear equations simultaneously,
the estimates ̂𝑚and ̂𝑐that minimise 𝑂𝐿𝑆are given as
̂𝑚=
𝑁𝑆𝑥𝑦−𝑆𝑥𝑆𝑦
𝑁𝑆𝑥𝑥−𝑆2
𝑥
,
̂𝑐=
𝑆𝑦−̂𝑚𝑆𝑥
𝑁
with the unbiased estimated standard error ̂𝜎𝜖given as
̂𝜎𝜖=
√
√
√
√
√
√
√
𝑁
∑
𝑖=1
(𝑆𝑡+𝑖Δ𝑡−̂𝑚𝑆𝑡+(𝑖−1)Δ𝑡−̂𝑐)2
𝑁−2
.
Take note that the divisor 𝑁−2 is used instead of 𝑁because two parameters 𝑚and 𝑐
have been estimated, thus giving 𝑁−2 degrees of freedom.
3. Estimation of Geometric Mean-Reverting Process Parameters. Let 𝑆𝑡, 𝑆𝑡+Δ𝑡, 𝑆𝑡+2Δ𝑡, …,
𝑆𝑡+𝑁Δ𝑡with Δ𝑡= (𝑇−𝑡)∕𝑁be a sequence of discrete values observed at regular time
intervals Δ𝑡> 0 which are assumed to follow a geometric mean-reverting process with

7.2.1 Historical and Implied Volatility
659
the following SDE
𝑑𝑆𝑡= 𝜅(𝜃−log 𝑆𝑡)𝑆𝑡𝑑𝑡+ 𝜎𝑆𝑡𝑑𝑊𝑡,
𝑆0 > 0
where the mean-reversion rate 𝜅, long-term mean 𝜃and volatility 𝜎are constant parameters
and 𝑊𝑡is a standard Wiener process on the probability space (Ω, ℱ, ℙ).
Using maximum-likelihood estimation or otherwise, calculate the historical estimates
of 𝜅, 𝜃and 𝜎.
Solution: By expanding log 𝑆𝑡using Taylor’s formula and subsequently applying It¯o’s
formula we have
𝑑(log 𝑆𝑡) = 1
𝑆𝑡
𝑑𝑆𝑡−
1
2𝑆2
𝑡
(𝑑𝑆𝑡
)2 + …
= 𝜅(𝜃−log 𝑆𝑡
) 𝑑𝑡+ 𝜎𝑑𝑊𝑡−1
2𝜎2𝑑𝑡
=
(
𝜅(𝜃−log 𝑆𝑡
) −1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊𝑡
and setting 𝑋𝑡= log 𝑆𝑡we can rewrite the SDE as
𝑑𝑋𝑡=
(
𝜅(𝜃−𝑋𝑡) −1
2𝜎2)
𝑑𝑡+ 𝜎𝑑𝑊𝑡
= 𝜅(𝜗−𝑋𝑡)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜗= 𝜃−𝜎2
2𝜅.
By letting
𝑆𝑥=
𝑁
∑
𝑖=1
log 𝑆𝑡+(𝑖−1)Δ𝑡,
𝑆𝑦=
𝑁
∑
𝑖=1
log 𝑆𝑡+𝑖Δ𝑡𝑆𝑥𝑥=
𝑁
∑
𝑖=1
(log 𝑆𝑡+(𝑖−1)Δ𝑡
)2 ,
𝑆𝑦𝑦=
𝑁
∑
𝑖=1
(log 𝑆𝑡+𝑖Δ𝑡
)2 𝑆𝑥𝑦=
𝑁
∑
𝑖=1
(log 𝑆𝑡+(𝑖−1)Δ𝑡
) (log 𝑆𝑡+𝑖Δ𝑡
)
then from analogy with the Ornstein–Uhlenbeck process estimation of parameters (see
Problem 7.2.1.2, page 654), the maximum-likelihood estimates of 𝜗, 𝜅and 𝜎are
̂𝜗=
𝑆𝑦𝑆𝑥𝑥−𝑆𝑥𝑆𝑥𝑦
𝑁(𝑆𝑥𝑥−𝑆𝑥𝑦) −𝑆2
𝑥+ 𝑆𝑥𝑆𝑦
̂𝜅= −1
Δ𝑡log
[
𝑆𝑥𝑦−̂𝜗(𝑆𝑥+ 𝑆𝑦) + 𝑁̂𝜗2
𝑆𝑥𝑥−2 ̂𝜃𝑆𝑥+ 𝑁̂𝜗2
]
̂𝜎=
√
2̂𝜅̂𝑠
1 −𝑒−2̂𝜅Δ𝑡

660
7.2.1 Historical and Implied Volatility
where
̂𝑠2 = 1
𝑁
[𝑆𝑦𝑦−2𝑆𝑥𝑦𝑒−̂𝜅Δ𝑡+ 𝑆𝑥𝑥𝑒−2̂𝜅Δ𝑡−2 ̂𝜗(𝑆𝑦−𝑆𝑥𝑒−̂𝜅Δ𝑡)(1 −𝑒−̂𝜅Δ𝑡)
+𝑁̂𝜗2(1 −𝑒−̂𝜅Δ𝑡)2] .
Alternatively, using ordinary least squares, the estimates of 𝜗, 𝜅and 𝜎are
̂𝜗=
̂𝑐
1 −̂𝑚,
̂𝜅= −log ̂𝑚
Δ𝑡
and
̂𝜎= ̂𝜎𝜖
√
2̂𝜅
1 −𝑒−2̂𝜅Δ𝑡
where
̂𝑚=
𝑁𝑆𝑥𝑦−𝑆𝑥𝑆𝑦
𝑁𝑆𝑥𝑥−𝑆2
𝑥
̂𝑐=
𝑆𝑦−̂𝑚𝑆𝑥
𝑁
̂𝜎𝜖=
√
√
√
√
√
√
√
𝑁
∑
𝑖=1
(log 𝑆𝑡+𝑖Δ𝑡−̂𝑚log 𝑆𝑡+(𝑖−1)Δ𝑡−̂𝑐)2
𝑁−2
.
From the relationship 𝜗= 𝜃−𝜎2
2𝜅, the estimate ̂𝜃is recovered from
̂𝜃= ̂𝜗+ ̂𝜎2
2̂𝜅.
4. Generalised Historical Volatility. Let 𝑆𝑡, 𝑆𝑡+Δ𝑡, 𝑆𝑡+2Δ𝑡, … , 𝑆𝑡+𝑁Δ𝑡with Δ𝑡= (𝑇−𝑡)∕𝑁
be a sequence of discrete asset prices observed at regular time intervals Δ𝑡> 0. Assume
that the asset prices follow a lognormal model with daily closing prices (i.e., Δ𝑡= 1 trading
day) and let 𝜎sd be the standard deviation of logarithm returns of asset prices.
Assuming 252 trading days per year, find the estimated annualised, monthly and weekly
volatilities.
Solution: Following Problem 7.2.1.1 (page 651) using the maximum-likelihood method,
the biased standard deviation 𝜎sd of the logarithm returns of asset prices can be estimated
as
𝜎sd =
√
√
√
√1
𝑁
𝑁
∑
𝑖=1
(
𝑅𝑖−̄𝑅
)2
where 𝑅𝑖= log
(
𝑆𝑡+𝑖Δ𝑡
𝑆𝑡+(𝑖−1)Δ𝑡
)
, 𝑖= 1, 2, … , 𝑁and ̄𝑅= 1
𝑁
𝑁
∑
𝑖=1
𝑅𝑖.

7.2.1 Historical and Implied Volatility
661
For the case of annualised volatility, we set Δ𝑡=
1
252 and have
𝜎annualised = 𝜎sd
√
Δ𝑡
=
𝜎sd
√
1
252
= 𝜎sd
√
252.
For the case of monthly volatility, we set Δ𝑡= 12
252 and therefore
𝜎monthly = 𝜎sd
√
Δ𝑡
=
𝜎sd
√
12
252
= 𝜎sd
√
252
12 .
Finally, for the case of weekly volatility, we set Δ𝑡= 52
252 and hence
𝜎weekly = 𝜎sd
√
Δ𝑡
=
𝜎sd
√
52
252
= 𝜎sd
√
252
52 .
5. Brenner–Subrahmanyam Approximation. Show that the cdf of a standard normal
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
can be expressed as
Φ(𝑥) = 1
2 +
1
√
2𝜋
(
𝑥−
1
21 ⋅1! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …
)
.
Let the Black–Scholes formula for the value of a European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) be
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cumulative distribution of a standard normal, 𝑆𝑡is the spot price at
time 𝑡< 𝑇, 𝑇is the option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate,
𝐷is the continuous dividend yield and 𝜎is the volatility.

662
7.2.1 Historical and Implied Volatility
By defining ATM as 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡) (i.e., continuously paid dividend stock
price equal to discounted strike price) and taking a linear approximation of the cumu-
lative distribution of a standard normal, show that the implied volatility 𝜎atm
imp of an ATM
option in a forward sense (𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡) = 𝐾) satisfying
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp) = 𝑉mkt
where 𝑉mkt is the market-observed ATM European option price can be approximated as
𝜎atm
imp ≈
𝑉mkt
𝑆𝑡𝑒−𝐷(𝑇−𝑡)
√
2𝜋
𝑇−𝑡.
Solution: Given that 𝑒−1
2 𝑥2 is an even function
Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑢2𝑑𝑢
= 1
2 +
1
√
2𝜋∫
𝑥
0
𝑒−1
2 𝑢2𝑑𝑢
and using Taylor’s expansion of 𝑓(𝑢) = 𝑒−1
2 𝑢2 about 𝑢= 0 so that
𝑓(𝑢) = 𝑓(0) + 𝑓′(0)𝑢+ 1
2!𝑓′′(0)𝑢2 + 1
3!𝑓′′′(0)𝑢3 + …
we have
𝑓′(𝑢) = −𝑢𝑓(𝑢),
𝑓′′(𝑢) = (𝑢2 −1)𝑓(𝑢),
𝑓′′′(𝑢) = (−𝑢3 + 3𝑢)𝑓(𝑢)
𝑓(4)(𝑢) = (𝑢4 −6𝑢2 + 3)𝑓(𝑢),
𝑓(5)(𝑢) = (−𝑢5 + 10𝑢3 −15𝑢)𝑓(𝑢)
𝑓(6)(𝑢) = (𝑢6 −15𝑢4 + 45𝑢2 + 15)𝑓(𝑢),
𝑓(7)(𝑢) = (−𝑢7 + 21𝑢5 −105𝑢3 + 75𝑢)𝑓(𝑢)
⋮
Hence,
∫
𝑥
0
𝑒−1
2 𝑢2𝑑𝑢= ∫
𝑥
0
(
1 −1
2!𝑢2 + 3
4!𝑢4 −15
6! 𝑢6 + …
)
𝑑𝑢
= ∫
𝑥
0
(
1 −1
2!𝑢2 +
1
22 ⋅2!𝑢4 −
1
23 ⋅3!𝑢6 + …
)
𝑑𝑢
= 𝑥−
1
2! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …

7.2.1 Historical and Implied Volatility
663
and therefore
Φ(𝑥) = 1
2 +
1
√
2𝜋
(
𝑥−
1
21 ⋅1! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …
)
.
Setting 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡) so that
𝑑± = ±1
2𝜎
√
𝑇−𝑡
and taking a linear approximation of Φ(𝑑±),
Φ(𝑑±) ≈1
2 ± 1
2𝜎
√
𝑇−𝑡
2𝜋.
By equating the Black–Scholes theoretical price with the European option market price
𝑉mkt = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
where 𝛿∈{−1, 1} and substituting Φ(𝑑±) ≈1
2 ± 1
2𝜎atm
imp
√
𝑇−𝑡
2𝜋, we have
𝑉mkt ≈𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(
𝛿
2 +
𝛿𝜎atm
imp
2
√
𝑇−𝑡
2𝜋
)
−𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(
𝛿
2 −
𝛿𝜎atm
imp
2
√
𝑇−𝑡
2𝜋
)
= 𝜎atm
imp𝑆𝑡𝑒−𝐷(𝑇−𝑡)
√
𝑇−𝑡
2𝜋
since 𝛿2 = 1.
Therefore, the implied volatility can approximated by
𝜎atm
imp ≈
𝑉mkt
𝑆𝑡𝑒−𝐷(𝑇−𝑡)
√
2𝜋
𝑇−𝑡.
6. Li ATM Volatility Approximation. Prove the following trigonometry identity
cos 3𝜃= 4 cos3 𝜃−3 cos 𝜃.
Consider the depressed cubic equation
𝑥3 + 𝑝𝑥+ 𝑞= 0

664
7.2.1 Historical and Implied Volatility
where 𝑝, 𝑞∈ℝ. By setting 𝑥= 2𝑦
√
|𝑝|
3 , show that the cubic equation can be expressed
as
4𝑦3 + 3 sgn(𝑝)𝑦= 𝐶
where 𝐶= −3𝑞
2|𝑝|
√
3
|𝑝|. Hence, if 𝑝< 0 and |𝐶| < 1 then show that the roots of the
depressed cubic equation are
𝑥= 2
√
|𝑝|
3 cos
(1
3 cos−1 𝐶
)
, 2
√
|𝑝|
3 cos
(2𝜋
3 ± 1
3 cos−1 𝐶
)
.
Let the Black–Scholes theoretical price for the value of a European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇)
be
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the volatility.
By taking the third-order approximation of
Φ(𝑥) = 1
2 +
1
√
2𝜋
(
𝑥−
1
21 ⋅1! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …
)
and by considering an ATM option in a forward sense such that 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡),
show that by equating
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp) = 𝑉mkt
where 𝑉mkt is the market-observed ATM European option price, the corresponding ATM
implied volatility 𝜎atm
imp can be approximated as
𝜎atm
imp ≈4
√
2
𝑇−𝑡cos
(2𝜋
3 −1
3 cos−1 𝐶
)

7.2.1 Historical and Implied Volatility
665
where 𝐶= −
3
√
𝜋𝑉mkt
4𝑆𝑡𝑒−𝐷(𝑇−𝑡) .
Solution: For 𝑖=
√
−1, from De Moivre’s formula
(cos 𝜃+ 𝑖sin 𝜃)3 = cos 3𝜃+ 𝑖sin 3𝜃
cos3 𝜃+ 3𝑖cos2 𝜃sin 𝜃−3 cos 𝜃sin2 𝜃−𝑖sin3 𝜃= cos 3𝜃+ 𝑖sin 3𝜃
(cos3 𝜃−3 cos 𝜃sin2 𝜃) + 𝑖(3 cos2 𝜃sin 𝜃−sin3 𝜃) = cos 3𝜃+ 𝑖sin 3𝜃.
By equating the real terms and because cos2 𝜃+ sin2 𝜃= 1, we have
cos 3𝜃= cos3 𝜃−3 cos 𝜃sin2 𝜃
= cos3 𝜃−3 cos 𝜃(1 −cos2 𝜃)
or
cos 3𝜃= 4 cos3 𝜃−3 cos 𝜃.
By substituting 𝑥= 2
√
|𝑝|
3 𝑦into the depressed cubic equation
8|𝑝|
3
√
|𝑝|
3 𝑦3 + 2𝑝
√
|𝑝|
3 𝑦+ 𝑞= 0
4𝑦3 + 3 𝑝
|𝑝|𝑦= −3𝑞
2|𝑝|
√
3
|𝑝|
4𝑦3 + 3 sgn(𝑝)𝑦= −3𝑞
2|𝑝|
√
3
|𝑝|
or
4𝑦3 + 3 sgn(𝑝)𝑦= 𝐶
where 𝐶= −3𝑞
2|𝑝|
√
3
|𝑝|.
For 𝑝< 0 and |𝐶| ≤1 we let 𝑦= cos 𝜃so that the domain of 𝑦∈[−1, 1]. Therefore,
4 cos3 𝜃−3 cos 𝜃= 𝐶
or
cos 3𝜃= 𝐶.
Hence,
3𝜃= cos−1 𝐶, 2𝜋+ cos−1 𝐶, 2𝜋−cos−1 𝐶

666
7.2.1 Historical and Implied Volatility
or
𝜃= 1
3 cos−1 𝐶, 2𝜋
3 + 1
3 cos−1 𝐶, 2𝜋
3 −1
3 cos−1 𝐶.
Thus, the roots of the depressed cubic equation are
𝑥= 2
√
−𝑝
3 cos
(1
3 cos−1 𝐶
)
, 2
√
−𝑝
3 cos
(2𝜋
3 ± 1
3 cos−1 𝐶
)
.
By setting 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡) so that
𝑑± = ±1
2𝜎
√
𝑇−𝑡
and taking the cubic approximation of Φ(𝑑±) we have
Φ(𝑑±) ≈1
2 ±
1
√
2𝜋
𝜉∓
1
6
√
2𝜋
𝜉3
where 𝜁= 1
2𝜎
√
𝑇−𝑡.
Equating the Black–Scholes theoretical price with the European ATM option market
price
𝑉mkt = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
where 𝛿∈{−1, 1} and substituting 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡), Φ(𝑑±) ≈1
2 ±
1
√
2𝜋
𝜉∓
1
6
√
2𝜋
𝜉3, 𝜉= 1
2𝜎atm
imp
√
𝑇−𝑡and because 𝛿2 = 1 we have
𝑉mkt ≈𝛿2𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(
1
2 +
1
√
2𝜋
𝜉−
1
6
√
2𝜋
𝜉3
)
−𝛿2𝑆𝑡𝑒−𝐷(𝑇−𝑡)
(
1
2 −
1
√
2𝜋
𝜉+
1
6
√
2𝜋
𝜉3
)
= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
√
2𝜋
(
2𝜉−1
3𝜉3)
or
𝜉3 −6𝜉+ 3
√
2𝜋𝑉mkt
𝑆𝑡𝑒−𝐷(𝑇−𝑡) ≈0.

7.2.1 Historical and Implied Volatility
667
By setting 𝑝= −6 and 𝑞= 3
√
2𝜋𝑉mkt
𝑆𝑡𝑒−𝐷(𝑇−𝑡) in the depressed cubic equation we have
𝐶= −
3
√
𝜋𝑉mkt
4𝑆𝑡𝑒−𝐷(𝑇−𝑡)
and hence the roots of the cubic equation are
𝜉≈2
√
2 cos
(1
3 cos−1 𝐶
)
, 2
√
2 cos
(2𝜋
3 ± 1
3 cos−1 𝐶
)
.
Since 𝜎atm
imp ∈(0, 1), 𝑉mkt > 0 and 𝑆𝑡𝑒−𝐷(𝑇−𝑡) > 0 we only consider the case when −1 <
𝐶< 0, which implies
−1 < −
3
√
𝜋𝑉mkt
4𝑆𝑡𝑒−𝐷(𝑇−𝑡) < 0
or
𝑉mkt
𝑆𝑡𝑒−𝐷(𝑇−𝑡) <
4
3
√
𝜋
< 1
and thus
𝑉mkt < 𝑆𝑡𝑒−𝐷(𝑇−𝑡)(= 𝐾𝑒−𝑟(𝑇−𝑡))
which is valid for all ATM European call or put options.
As 𝐶∈(−1, 0) then, because 𝜋
2 < cos−1 𝐶< 𝜋, we have
1
2 < cos
(1
3 cos−1 𝐶
)
<
√
3
2
−
√
3
2
< cos
(2𝜋
3 + 1
3 cos−1 𝐶
)
< −1
and
0 < cos
(2𝜋
3 −1
3 cos−1 𝐶
)
< 1
2.
Since 𝜎atm
imp ∈(0, 1), the first two inequalities are inappropriate and we only consider the
root
𝜉≈2
√
2 cos
(2𝜋
3 −1
3 cos−1 𝐶
)
.

668
7.2.1 Historical and Implied Volatility
By equating
1
2𝜎atm
imp
√
𝑇−𝑡≈2
√
2 cos
(2𝜋
3 −1
3 cos−1 𝐶
)
the implied ATM volatility can be estimated as
𝜎atm
imp ≈4
√
2
𝑇−𝑡cos
(2𝜋
3 −1
3 cos−1 𝐶
)
where 𝐶= −
3
√
𝜋𝑉mkt
4𝑆𝑡𝑒−𝐷(𝑇−𝑡) .
7. Li Non-ATM Volatility Approximation. Let the Black–Scholes price for the value of a
European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) be
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
𝛿=
{
+1
for call option
−1
for put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the volatility.
By defining
𝑚= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝐾𝑒−𝑟(𝑇−𝑡)
as the measure of moneyness of an option, show that the Black–Scholes formula can be
expressed as
𝑓(𝑚) = 𝛿𝑚Φ(𝛿𝑑+) −𝛿Φ(𝛿𝑑−)
where 𝑓(𝑚) = 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎)
𝐾𝑒−𝑟(𝑇−𝑡)
, 𝑑± = log 𝑚
2𝜉
± 𝜉and 𝜉= 1
2𝜎
√
𝑇−𝑡.
From the expansion of the normal distribution function
Φ(𝑥) = 1
2 +
1
√
2𝜋
(
𝑥−
1
21 ⋅1! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …
)

7.2.1 Historical and Implied Volatility
669
and taking a quadratic approximation of 𝑓(𝑚) centred at 𝑚= 1, show that
𝑓(𝑚) = 𝛿(𝑚−1)
2
+ 𝑚+ 1
√
2𝜋
𝜉+ (𝑚−1)2
4
√
2𝜋𝜉
+ 𝑂(𝜉(𝑚−1)2).
Equating
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎imp) = 𝑉mkt
where 𝑉mkt is the market-observed European price, show that by ignoring higher terms of
𝜉(𝑚−1)2 the implied volatility 𝜎imp can be approximated as
𝜎imp ≈
√
2𝜋
𝑇−𝑡
1
̄𝑆𝑡+ ̄𝐾
{(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))
+
√(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))2
−( ̄𝑆𝑡−̄𝐾)2
𝜋
(1 + ̄𝑆𝑡∕̄𝐾)
2
⎫
⎪
⎬
⎪⎭
where ̄𝑆𝑡= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) and ̄𝐾= 𝐾𝑒−𝑟(𝑇−𝑡) are the dividend paid stock price and dis-
counted strike price, respectively.
Discuss the limitations of this approximation.
Under what conditions for 𝑉mkt is this approximation valid?
Finally, what is the value of 𝜎imp when 𝑚= 1?
Solution: From the Black–Scholes theoretical price formula, we can rewrite
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎)
𝐾𝑒−𝑟(𝑇−𝑡)
= 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝐾𝑒−𝑟(𝑇−𝑡) Φ(𝛿𝑑+) −𝛿Φ(𝛿𝑑−)
where
𝑑± =
log
(𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝐾𝑒−𝑟(𝑇−𝑡)
)
± 1
2𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
By writing 𝑚= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
𝐾𝑒−𝑟(𝑇−𝑡) , 𝜉= 1
2𝜎
√
𝑇−𝑡and 𝑓(𝑚) = 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎)
𝐾𝑒−𝑟(𝑇−𝑡)
, the Black–
Scholes formula becomes
𝑓(𝑚) = 𝛿𝑚Φ(𝛿𝑑+) −𝛿Φ(𝛿𝑑−)
such that 𝑑± = log 𝑚
2𝜉
± 𝜉.

670
7.2.1 Historical and Implied Volatility
From Taylor’s theorem,
𝑓(𝑚) = 𝑓(1) + 𝑓′(1)(𝑚−1) + 1
2𝑓′′(1)(𝑚−1)2 + 𝑂((𝑚−1)3)
where
𝑓(𝑚) = 𝛿𝑚Φ(𝛿𝑑+) −𝛿Φ(𝛿𝑑−)
𝑓′(𝑚) = 𝛿Φ(𝛿𝑑+) + 𝛿
2𝜉
(𝜕Φ(𝛿𝑑+)
𝜕𝑑+
−1
𝑚
𝜕Φ(𝛿𝑑−)
𝜕𝑑−
)
and
𝑓′′(𝑚) =
𝛿
2𝑚𝜉
(𝜕Φ(𝛿𝑑+)
𝜕𝑑+
+ 1
𝑚
𝜕Φ(𝛿𝑑−)
𝜕𝑑−
)
+
𝛿
4𝑚𝜉2
(
𝜕2Φ(𝛿𝑑+)
𝜕𝑑2
+
−1
𝑚
𝜕2Φ(𝛿𝑑−)
𝜕𝑑2
−
)
.
Since
Φ(𝛿𝑑±) = 1
2 +
𝛿
√
2𝜋
(
𝑑± −1
6𝑑3
± + 1
40𝑑5
± −
1
336𝑑7
± + …
)
𝜕Φ(𝛿𝑑±)
𝜕𝑑±
=
𝛿
√
2𝜋
(
1 −1
2𝑑2
± + 1
8𝑑4
± −1
48𝑑6
± + …
)
𝜕2Φ(𝛿𝑑±)
𝜕𝑑2
±
=
𝛿
√
2𝜋
(
−𝑑± + 1
2𝑑3
± −1
8𝑑5
± + …
)
therefore
Φ(𝛿𝑑±)||𝑚=1 = 1
2 ±
𝛿
√
2𝜋
(
𝜉−1
6𝜉3 + 1
40𝜉5 −
1
336𝜉6 + …
)
𝜕Φ(𝛿𝑑±)
𝜕𝑑±
|||||𝑚=1
=
𝛿
√
2𝜋
(
1 −1
2𝜉2 + 1
8𝜉4 −1
48𝜉6 + …
)
𝜕2Φ(𝛿𝑑±)
𝜕𝑑2
±
|||||𝑚=1
= ±
𝛿
√
2𝜋
(
−𝜉+ 1
2𝜉3 −1
8𝜉5 + …
)
.
Given Φ′(𝑥) −Φ′(−𝑥) = 0, thus
𝑓(1) = 𝛿(Φ(𝛿𝜉) −Φ(−𝛿𝜉))
𝑓′(1) = 𝛿Φ(𝛿𝜉)
𝑓′′(1) = 𝛿
2𝜉
(
𝜕Φ(𝛿𝑑+)
𝜕𝑑+
|||||𝑚=1
+ 𝜕Φ(𝛿𝑑−)
𝜕𝑑−
||||𝑚=1
)
+ 𝛿
4𝜉2
(
𝜕2Φ(𝛿𝑑+)
𝜕𝑑2
+
|||||𝑚=1
−𝜕2Φ(𝛿𝑑−)
𝜕𝑑2
−
|||||𝑚=1
)

7.2.1 Historical and Implied Volatility
671
and hence
𝑓(𝑚) = 𝛿(𝑚Φ(𝛿𝜉) −Φ(−𝛿𝜉)) + 𝛿
4𝜉
(
𝜕Φ(𝛿𝑑+)
𝜕𝑑+
|||||𝑚=1
+ 𝜕Φ(𝛿𝑑−)
𝜕𝑑−
||||𝑚=1
)
(𝑚−1)2
+ 𝛿
8𝜉2
(
𝜕2Φ(𝛿𝑑+)
𝜕𝑑2
+
|||||𝑚=1
−𝜕2Φ(𝛿𝑑−)
𝜕𝑑2
−
|||||𝑚=1
)
(𝑚−1)2 + 𝑂((𝑚−1)3).
Since 𝛿2 = 1, we have
𝛿(𝑚Φ(𝛿𝜉) −Φ(−𝛿𝜉)) = 𝛿(𝑚−1)
2
+
𝜉
√
2𝜋
(𝑚+ 1) + 𝑂(𝜉3)
𝛿
2𝜉
(
𝜕Φ(𝛿𝑑+)
𝜕𝑑+
|||||𝑚=1
+ 𝜕Φ(𝛿𝑑−)
𝜕𝑑−
||||𝑚=1
)
(𝑚−1)2 = (𝑚−1)2
2𝜉
√
2𝜋
−𝜉(𝑚−1)2
4
√
2𝜋
+𝑂(𝜉3(𝑚−1)2)
𝛿
8𝜉2
(
𝜕2Φ(𝛿𝑑+)
𝜕𝑑2
+
|||||𝑚=1
−𝜕2Φ(𝛿𝑑−)
𝜕𝑑2
−
|||||𝑚=1
)
(𝑚−1)2 = −(𝑚−1)2
4𝜉
√
2𝜋
+ 𝜉(𝑚−1)2
8
√
2𝜋
+𝑂(𝜉3(𝑚−1)2)
and hence
𝑓(𝑚) = 𝛿(𝑚−1)
2
+ 𝑚+ 1
√
2𝜋
𝜉+ (𝑚−1)2
4
√
2𝜋𝜉
+ 𝑂(𝜉(𝑚−1)2).
By equating
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎imp) = 𝑉mkt
and setting ̄𝑆𝑡= 𝑆𝑡𝑒−𝐷(𝑇−𝑡),
̄𝐾= 𝐾𝑒−𝑟(𝑇−𝑡) and ignoring higher orders of 𝜉(𝑚−1)2,
we can write
𝑉mkt
̄𝐾
≈𝛿(𝑚−1)
2
+ 𝑚+ 1
√
2𝜋
𝜉+ (𝑚−1)2
4
√
2𝜋𝜉
or
2𝜉2 −𝛼𝜉+ 𝛽≈0
where 𝛼=
√
2𝜋
𝑚+ 1
(2𝑉mkt
̄𝐾
−𝛿(𝑚−1)
)
and 𝛽= 1
2
(𝑚−1)2
𝑚+ 1 .

672
7.2.1 Historical and Implied Volatility
Since 𝜉= 1
2𝜎imp
√
𝑇−𝑡and because 0 < 𝜎imp < 1, we choose
𝜉≈𝛼+
√
𝛼2 −8𝛽
2
or
𝜎imp ≈𝛼+
√
𝛼2 −8𝛽
√
𝑇−𝑡
.
By substituting 𝑚= ̄𝑆𝑡∕̄𝐾, we have
𝛼= 2
√
2𝜋
̄𝑆𝑡+ ̄𝐾
(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))
and
𝛽=
1
2 ̄𝐾
( ̄𝑆𝑡−̄𝐾)2
̄𝑆𝑡+ ̄𝐾
and thus
𝜎imp ≈
√
2𝜋
𝑇−𝑡
1
̄𝑆𝑡+ ̄𝐾
{(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))
+
√(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))2
−( ̄𝑆𝑡−̄𝐾)2
𝜋
(1 + ̄𝑆𝑡∕̄𝐾)
2
⎫
⎪
⎬
⎪⎭
.
On the issue of the limitations of this approximation, one can see that in some cases the
square-root term might not have a real solution.
In order for the approximation to have a real solution, we require
(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))2
−( ̄𝑆𝑡−̄𝐾)2
𝜋
(1 + ̄𝑆𝑡∕̄𝐾)
2
≥0
or
⎡
⎢
⎢⎣
𝑉mkt −( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿−
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
⎤
⎥
⎥⎦
⎡
⎢
⎢⎣
𝑉mkt −( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿+
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
⎤
⎥
⎥⎦
≥0.
Therefore,
𝑉mkt ≥max
⎧
⎪
⎨
⎪⎩
( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿−
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
, ( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿+
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
⎫
⎪
⎬
⎪⎭

7.2.1 Historical and Implied Volatility
673
or
𝑉mkt ≤min
⎧
⎪
⎨
⎪⎩
( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿−
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
, ( ̄𝑆𝑡−̄𝐾) ⎛
⎜
⎜⎝
1
2𝛿+
√
1 + ̄𝑆𝑡∕̄𝐾
2𝜋
⎞
⎟
⎟⎠
⎫
⎪
⎬
⎪⎭
.
Finally, for the case when 𝑚= 1 or ̄𝑆𝑡= ̄𝐾, the implied volatility formula will be reduced
to the Brenner–Subrahmanyam approximation, i.e.
𝜎imp ≈𝑉mkt
̄𝑆𝑡
√
2𝜋
𝑇−𝑡.
8. Corrado–Miller–Hallerbach Approximation. Let the Black–Scholes price for the value of
a European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) be
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)
𝛿=
{
+1
for call option
−1
for put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the volatility.
From the definition
tanh−1 𝑥= 1
2 log
(1 + 𝑥
1 −𝑥
)
,
|𝑥| < 1
show that
log 𝑧= 2
∞
∑
𝑛=0
1
2𝑛+ 1
(𝑧−1
𝑧+ 1
)2𝑛+1
for any real number 𝑧> 0.
By setting
̄𝑆𝑡= 𝑆𝑡𝑒−𝐷(𝑇−𝑡)
and
̄𝐾= 𝐾𝑒−𝑟(𝑇−𝑡)

674
7.2.1 Historical and Implied Volatility
and equating
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎imp) = 𝑉mkt
where 𝑉mkt is the market-observed European price, and by ignoring the third-order and
higher terms of the normal distribution function
Φ(𝑥) = 1
2 +
1
√
2𝜋
(
𝑥−
1
21 ⋅1! ⋅3𝑥3 +
1
22 ⋅2! ⋅5𝑥5 −
1
23 ⋅3! ⋅7𝑥7 + …
)
and taking a linear approximation of log( ̄𝑆𝑡∕̄𝐾), show that the implied volatility 𝜎imp is
approximated by
𝜎imp ≈
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
+
√
√
√
√
√
√
√
√
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
2
−
4
𝑇−𝑡
( ̄𝑆𝑡−̄𝐾
̄𝑆𝑡+ ̄𝐾
)2
.
Solution: Since
tanh−1 𝑥= 1
2 log
(1 + 𝑥
1 −𝑥
)
= 1
2 (log(1 + 𝑥) −log(1 −𝑥))
and from the MacLaurin series
log(1 + 𝑥) = 𝑥−1
2𝑥2 + 1
3𝑥3 −1
4𝑥4 + … , 𝑥∈(−1, 1]
log(1 −𝑥) = −𝑥−1
2𝑥2 −1
3𝑥3 −1
4𝑥4 + … , |𝑥| < 1
we have
tanh−1 𝑥= 𝑥+ 1
3𝑥3 + 1
5𝑥5 + 1
7𝑥7 + … , |𝑥| < 1.
By setting
𝑧= 1 + 𝑥
1 −𝑥

7.2.1 Historical and Implied Volatility
675
and expressing 𝑥in terms of 𝑧,
𝑥= 𝑧−1
𝑧+ 1.
By substituting the above information into tanh−1 𝑥,
log 𝑧= 2 tanh−1 (𝑧−1
𝑧+ 1
)
= 2
(
𝑧−1
𝑧+ 1 + 1
3
(𝑧−1
𝑧+ 1
)3
+ 1
5
(𝑧−1
𝑧+ 1
)5
+ 1
7
(𝑧−1
𝑧+ 1
)7
+ …
)
= 2
∞
∑
𝑛=0
1
2𝑛+ 1
(𝑧−1
𝑧+ 1
)2𝑛+1
for 𝑧> 0.
By equating 𝑉mkt = 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎imp) and taking a linear approximation of Φ(𝛿𝑑±)
such that
𝑑± = log( ̄𝑆𝑡∕̄𝐾)
𝜎imp
√
𝑇−𝑡
± 1
2𝜎
√
𝑇−𝑡
we have
𝑉mkt = 𝛿̄𝑆𝑡Φ(𝛿𝑑+) −𝛿̄𝐾Φ(𝛿𝑑−)
≈𝛿̄𝑆𝑡
(
1
2 +
𝛿
√
2𝜋𝑑+
)
−𝛿̄𝐾
(
1
2 +
𝛿
√
2𝜋𝑑−
)
= 𝛿
( ̄𝑆𝑡−̄𝐾
2
)
+ ( ̄𝑆𝑡−̄𝐾) log( ̄𝑆𝑡∕̄𝐾)
𝜎imp
√
2𝜋(𝑇−𝑡)
+ 1
2
√
𝑇−𝑡
2𝜋( ̄𝑆𝑡+ ̄𝐾)
since 𝛿2 = 1.
Thus,
( ̄𝑆𝑡+ ̄𝐾)(𝑇−𝑡)𝜎2
imp −2
√
2𝜋(𝑇−𝑡)
(
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
))
𝜎imp
+2( ̄𝑆𝑡−̄𝐾) log( ̄𝑆𝑡∕̄𝐾) ≈0

676
7.2.1 Historical and Implied Volatility
and taking the largest root,
𝜎imp ≈
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
+
√
√
√
√
√
√
√
√
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
2
−
2
𝑇−𝑡
( ̄𝑆𝑡−̄𝐾
̄𝑆𝑡+ ̄𝐾
)
log( ̄𝑆𝑡∕̄𝐾).
Taking a linear approximation of log( ̄𝑆𝑡∕̄𝐾) ≈2( ̄𝑆𝑡−̄𝐾)∕( ̄𝑆𝑡+ ̄𝐾),
𝜎imp ≈
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
+
√
√
√
√
√
√
√
√
√
2𝜋
𝑇−𝑡
⎛
⎜
⎜
⎜
⎜⎝
𝑉mkt −𝛿
( ̄𝑆𝑡−̄𝐾
2
)
̄𝑆𝑡+ ̄𝐾
⎞
⎟
⎟
⎟
⎟⎠
2
−
4
𝑇−𝑡
( ̄𝑆𝑡−̄𝐾
̄𝑆𝑡+ ̄𝐾
)2
.
9. We consider the Black–Scholes formula for the value of a European option
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) such that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
with
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the spot volatility.
Show that 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) is a monotonically increasing function in 𝜎over (0, ∞).

7.2.1 Historical and Implied Volatility
677
We define 𝜎∞
imp as the implied volatility such that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉mkt
that is we equate the Black–Scholes theoretical price with the observed European option
price obtained in the market, 𝑉mkt.
Under what conditions does there exist a unique solution 𝜎∞
imp?
Solution: From Problem 2.2.4.6 (page 224), the vega of a European option is
𝜕𝑉
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+.
Since 𝑆𝑡> 0, therefore 𝜕𝑉
𝜕𝜎> 0 for all 𝜎∈(0, ∞). Thus, 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) is a monotonically
increasing function in 𝜎∈(0, ∞).
From Problems 2.2.1.3 (page 74), 2.2.1.4 (page 75), 2.2.1.5 (page 75) and 2.2.1.6 (page
76), 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) ≥
⎧
⎪
⎨
⎪⎩
max{𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡), 0}
for call option
max{𝐾𝑒−𝑟(𝑇−𝑡) −𝑆𝑡𝑒−𝐷(𝑇−𝑡), 0}
for put option
and
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) ≤
⎧
⎪
⎨
⎪⎩
𝑆𝑡
for call option
𝐾
for put option.
If the market price 𝑉mkt lies between the bounded region as described above for either a call
or put option, and from the monotonicity and continuity of 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) in 𝜎∈(0, ∞),
then 𝜎∞
imp exists and is a unique solution of 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉mkt.
10. Manaster–Koehler Method. Consider the Black–Scholes formula for the value of a
European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) such that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
with
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡

678
7.2.1 Historical and Implied Volatility
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the spot volatility.
Show that 𝜕𝑉
𝜕𝜎is maximised at
𝜎max =
√||||
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))||||
and prove that
𝜕2𝑉
𝜕𝜎2 = 𝜕𝑉
𝜕𝜎
(𝑇−𝑡
4𝜎3
) (𝜎4
max −𝜎4)
for all 𝛼∈(0, ∞).
We define 𝜎∞
imp as the implied volatility such that
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉mkt
where 𝑉mkt is the option price obtained in the market. Deduce that 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) is
strictly convex if 𝜎∞
imp < 𝜎max and 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) is strictly concave if 𝛼∞> 𝜎max.
Finally, if the sequence {𝜎𝑛} is generated by the Newton–Raphson method
𝜎𝑛+1 = 𝜎𝑛−
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎𝑛) −𝑉mkt
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
⎫
⎪
⎪
⎬
⎪
⎪⎭
, 𝑛≥0
with initial iterate 𝜎0 = 𝜎max and if 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉mkt has a solution, show that
{𝜎𝑛} converges monotonically to the unique solution 𝜎∞
imp with a quadratic rate of conver-
gence, i.e.
|𝜎𝑛+1 −𝜎∞
imp| = 𝑂(|𝜎𝑛−𝜎∞
imp|2).
Solution: From Problem 2.2.4.6 (page 224), the vega of a European option is
𝜕𝑉
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+.
To find the local extrema of 𝜕𝑉
𝜕𝜎, we first differentiate 𝜕𝑉
𝜕𝜎with respect to 𝜎
𝜕2𝑉
𝜕𝜎2 = −
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑑+
𝜕𝑑+
𝜕𝜎𝑒−1
2 𝑑2
+

7.2.1 Historical and Implied Volatility
679
and since
𝜕𝑑+
𝜕𝜎=
𝜎2(𝑇−𝑡)3∕2 −
(
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)
) √
𝑇−𝑡
𝜎2(𝑇−𝑡)
= −𝑑−
therefore
𝜕2𝑉
𝜕𝜎2 = 𝑑+𝑑−
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
=
(𝑑+𝑑−
𝜎
)
𝜕𝑉
𝜕𝜎.
By setting 𝜕2𝑉
𝜕𝜎2 = 0, we have either 𝑑+ = 0 or 𝑑−= 0, which implies
𝜎2 = −
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + 𝑟−𝐷)
or
𝜎2 =
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + 𝑟−𝐷) .
Taking second derivatives of 𝜕𝑉
𝜕𝜎
𝜕3𝑉
𝜕𝜎3 = −
(𝑑+𝑑−
𝜎
)
𝜕𝑉
𝜕𝜎+ 𝜕𝑑+
𝜕𝜎
(𝑑−
𝜎
)
𝜕𝑉
𝜕𝜎+ 𝜕𝑑−
𝜕𝜎
(𝑑+
𝜎
)
𝜕𝑉
𝜕𝜎+
(𝑑+𝑑−
𝜎
)
𝜕2𝑉
𝜕𝜎2
= −
(𝑑+𝑑−
𝜎
)
𝜕𝑉
𝜕𝜎−
𝑑2
−
𝜎
𝜕𝑉
𝜕𝜎−
𝑑2
+
𝜎
𝜕𝑉
𝜕𝜎+
(𝑑+𝑑−
𝜎
)
𝜕2𝑉
𝜕𝜎2
and substituting 𝜎2 = −
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + 𝑟−𝐷) or 𝜎2 =
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + 𝑟−𝐷)
gives
𝜕3𝑉
𝜕𝜎3 < 0.
Hence,
𝜎max =
√||||
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))||||
is the maximum point of 𝜕𝑉
𝜕𝜎(since 𝜎max is the only extremum point).

680
7.2.1 Historical and Implied Volatility
From
𝜎max =
√||||
2
𝑇−𝑡
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))||||
we can write
𝜎4
max =
4
(𝑇−𝑡)2
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))2
or
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))2 =
𝜎4
max(𝑇−𝑡)2
4
.
Expanding 𝑑+𝑑−,
𝑑+𝑑−=
(
log(𝑆𝑡∕𝐾) + (𝑟−𝐷+ 1
2𝜎2)(𝑇−𝑡)
) (
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2)(𝑇−𝑡)
)
𝜎2(𝑇−𝑡)
=
(log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇−𝑡))2 −1
4𝜎4(𝑇−𝑡)2
𝜎2(𝑇−𝑡)
= 𝑇−𝑡
4𝜎2
(𝜎4
max −𝜎4) .
Therefore,
𝜕2𝑉
𝜕𝜎2 = 𝜕𝑉
𝜕𝜎
(𝑇−𝑡
4𝜎3
) (𝜎4
max −𝜎4)
for all 𝜎∈(0, ∞).
If the implied volatility 𝜎∞< 𝜎max we have 𝜕2𝑉
𝜕𝜎2 > 0, which implies 𝜕𝑉
𝜕𝜎is a monotoni-
cally increasing function in 𝜎∈[𝜎∞
imp, 𝜎max], and hence 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) is strictly convex
in 𝜎∈[𝜎∞
imp, 𝜎max].
In contrast, if 𝜎∞> 𝜎max we have 𝜕2𝑉
𝜕𝜎2 < 0, which implies 𝜕𝑉
𝜕𝜎is a monotonically
decreasing function in 𝜎∈[𝜎∞
imp, 𝜎max], and hence 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) is strictly concave in
𝜎∈[𝜎∞
imp, 𝜎max].
To show that the sequence {𝜎𝑛} is monotonic and bounded, we note that from the
Newton–Raphson formula
𝜎𝑛+1 = 𝜎𝑛−
⎧
⎪
⎪
⎨
⎪
⎪⎩
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎𝑛) −𝑉mkt
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
⎫
⎪
⎪
⎬
⎪
⎪⎭
,
𝑛≥0

7.2.1 Historical and Implied Volatility
681
and by expanding 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎𝑛) at 𝜎∞
imp up to the first order
|||||
𝜎𝑛+1 −𝜎∞
imp
𝜎𝑛−𝜎∞
imp
|||||
=
|||||||||
1 −
(𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎𝑛) −𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp)
𝜎𝑛−𝜎∞
imp
)
1
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
|||||||||
=
||||||
1 −
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗𝑛
) /(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
)||||||
where 𝜎∗
𝑛lies between 𝜎𝑛and 𝜎∞
imp.
For 𝑛= 0
|||||
𝜎1 −𝜎∞
imp
𝜎0 −𝜎∞
imp
|||||
=
||||||
1 −
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
0
) /(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎0
)||||||
and because 𝜎0 = 𝜎max maximises 𝜕𝑉
𝜕𝜎and 𝜕𝑉
𝜕𝜎> 0 for all 𝜎∈(0, ∞), thus
0 < 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
0
< 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎0
and we obtain
|||||
𝜎1 −𝜎∞
imp
𝜎0 −𝜎∞
imp
|||||
< 1.
Assume the result
|||||
𝜎𝑘+1 −𝜎∞
imp
𝜎𝑘−𝜎∞
imp
|||||
< 1
is true for 𝑛= 𝑘such that
0 < 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
𝑘
< 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑘
where 𝜎∗
𝑘is between 𝜎𝑘and 𝜎∞
imp.
For 𝑛= 𝑘+ 1
|||||
𝜎𝑘+2 −𝜎∞
imp
𝜎𝑘+1 −𝜎∞
imp
|||||
=
||||||
1 −
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
𝑘+1
) /(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑘+1
)||||||

682
7.2.1 Historical and Implied Volatility
where 𝜎∗
𝑘+1 is between 𝜎𝑘+1 and 𝜎∞
imp. Because 𝜎0 = 𝜎max is a maximum point of 𝜕𝑉
𝜕𝜎and
𝜕𝑉
𝜕𝜎> 0 for all 𝜎∈(0, ∞), thus
0 < 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
𝑘+1
< 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎0
and
0 < 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑘+1
< 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎0
and hence
|||||
𝜎𝑘+2 −𝜎∞
imp
𝜎𝑘+1 −𝜎∞
imp
|||||
=
||||||
1 −
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
𝑘+1
) /(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑘+1
)||||||
<
||||||
1 −
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎∗
𝑘+1
) /(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎0
)||||||
< 1.
Thus, the result is also true for 𝑛= 𝑘+ 1. Using mathematical induction, we have proved
that
|||||
𝜎𝑛+1 −𝜎∞
imp
𝜎𝑛−𝜎∞
imp
|||||
< 1
for all 𝑛≥0, which shows that the sequence {𝜎𝑛} is monotone and bounded, and therefore
converges to a limit 𝜎∞
imp.
By expanding 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) about 𝜎𝑛using Taylor’s theorem
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎𝑛) + (𝜎∞
imp −𝜎𝑛) 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
+1
2(𝜎∞
imp −𝜎𝑛)2 𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎∗𝑛
where 𝜎∗
𝑛is between 𝜎𝑛and 𝜎∞
imp and substituting it into the Newton–Raphson formula,
and since
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) = 𝑉mkt

7.2.1 Historical and Implied Volatility
683
we have
𝜎𝑛+1 −𝜎∞
imp = 1
2
{(
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎∗𝑛
)/ (
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
)}
(𝜎𝑛−𝜎∞
imp)2.
Taking absolute values on both sides gives
|||𝜎𝑛+1 −𝜎∞
imp
||| =
||||||
1
2
{(
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎∗𝑛
)/ (
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎𝑛
)}||||||
(𝜎𝑛−𝜎∞
imp)2.
Since 𝜕𝑉
𝜕𝜎> 0, 𝜕2𝑉
𝜕𝜎2 = 𝜕𝑉
𝜕𝜎
(𝑇−𝑡
4𝜎3
) (𝜎4
max −𝜎4) is finite and if 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎∞
imp) =
𝑉mkt has a solution (see Problem 7.2.1.9, page 676 for the existence and uniqueness condi-
tions of a solution 𝜎∞
imp) then, with a starting point 𝜎0 = 𝜎max, the sequence {𝜎𝑛} converges
monotonically to a unique solution 𝜎∞
imp with the rate of convergence of the iterates being
quadratic, i.e.
|𝜎𝑛+1 −𝜎∞
imp| = 𝑂(|𝜎𝑛−𝜎∞
imp|2).
11. Chambers–Nawalkha Approximation. Let the Black–Scholes formula for the value of a
European option 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) be
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) =
⎧
⎪
⎨
⎪⎩
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
for call option
𝐾𝑒−𝑟(𝑇−𝑡)Φ(−𝑑−) −𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(−𝑑+)
for put option
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
such that Φ(⋅) is the cdf of a standard normal, 𝑆𝑡is the spot price at time 𝑡< 𝑇, 𝑇is the
option expiry time, 𝐾is the strike price, 𝑟is the risk-free interest rate, 𝐷is the continuous
dividend yield and 𝜎is the spot volatility.
By defining the ATM option as 𝑆𝑡𝑒−𝐷(𝑇−𝑡) = 𝐾𝑒−𝑟(𝑇−𝑡) with the corresponding implied
volatility 𝜎atm
imp, show that by expanding 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) up to second order about 𝜎= 𝜎atm
imp,
the non-ATM volatility 𝜎can be approximated as
𝜎≈𝜎atm
imp +
𝛽−𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp

684
7.2.1 Historical and Implied Volatility
where
𝛽=
√
√
√
√
√
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
)2
−2
(
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
) (
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp) −𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎)
)
.
Solution: Expanding 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) using Taylor’s theorem about 𝜎= 𝜎atm
imp up to second
order
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) ≈𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp) + 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
(𝜎−𝜎atm
imp)
+1
2
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
(𝜎−𝜎atm
imp)2.
Rearranging the terms,
1
2
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
(𝜎−𝜎atm
imp)2 + 𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
(𝜎−𝜎atm
imp) + 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp)
−𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎) ≈0
and solving the quadratic equation,
𝜎−𝜎atm
imp ≈
−𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
± 𝛽
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
where
𝛽=
√
√
√
√
√
(
𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
)2
−2
(
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
) (
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎atm
imp) −𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇, 𝜎)
)
.
Since 𝜎> 0, we choose
𝜎≈𝜎atm
imp +
𝛽−𝜕𝑉
𝜕𝜎
||||𝜎=𝜎atm
imp
𝜕2𝑉
𝜕𝜎2
||||𝜎=𝜎atm
imp
.

7.2.2 Local Volatility
685
7.2.2
Local Volatility
1. Let {𝑊𝑡: 𝑡≥0} be a standard Wiener process on the probability space (Ω, ℱ, ℙ). Suppose
the asset price 𝑆𝑡has the following dynamics
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
where 𝜇, 𝐷are constants and the volatility 𝜎𝑡is a continuous process. In addition, let 𝑟be
the risk-free interest rate from a money-market account.
By considering a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) written at time 𝑡on 𝑆𝑡with strike
price 𝐾and expiry time 𝑇(𝑇> 𝑡), show the following identities
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾𝐶(𝑆𝑡∕𝐾, 𝑡; 1; 𝑇)
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾
𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
= 𝐾2 𝜕2𝐶
𝜕𝐾2 .
By substituting the above identities into the Black–Scholes equation, find the Dupire equa-
tion and payoff satisfied by 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) as a function of strike 𝐾and time 𝑡.
Solution: From the Black–Scholes formula
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝛼2)(𝑇−𝑡)
𝛼
√
𝑇−𝑡
𝛼2 =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
and Φ(⋅) is the cdf of a standard normal.
Thus,
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐾(𝑆𝑡∕𝐾𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) −𝑒−𝑟(𝑇−𝑡)Φ(𝑑−))
= 𝐾𝐶(𝑆𝑡∕𝐾, 𝑡; 1, 𝑇).
To show 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾we note that
𝜕𝐶
𝜕𝑆𝑡
= 𝑒−𝐷(𝑇−𝑡)Φ(𝑑+) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
𝜕𝐶
𝜕𝐾= 𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝐾
−𝑒−𝑟(𝑇−𝑡)Φ(𝑑−) −𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝐾

686
7.2.2 Local Volatility
so that
𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾= 𝐶(𝑆𝑡.𝑡; 𝐾, 𝑇)
+ 𝑆𝑡
(
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
)
+ 𝐾
(
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝐾
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝐾
)
.
From Problem 2.2.4.1 (page 218),
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝑆𝑡
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝑆𝑡
𝑆𝑡𝑒−𝐷(𝑇−𝑡) 𝜕Φ(𝑑+)
𝜕𝐾
= 𝐾𝑒−𝑟(𝑇−𝑡) 𝜕Φ(𝑑−)
𝜕𝐾
.
Hence,
𝐶(𝑆𝑡.𝑡; 𝐾, 𝑇) = 𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾.
To show 𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
= 𝐾2 𝜕2𝐶
𝜕𝐾2 , we first differentiate 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾with
respect to 𝑆𝑡so that
𝜕𝐶
𝜕𝑆𝑡
= 𝜕𝐶
𝜕𝑆𝑡
+ 𝑆𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ 𝐾𝜕2𝐶
𝜕𝑆𝑡𝜕𝐾
or
𝑆𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
= −𝐾𝜕2𝐶
𝜕𝑆𝑡𝜕𝐾.
Multiplying the above expression with 𝑆𝑡and using the identity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ 𝐾𝜕𝐶
𝜕𝐾

7.2.2 Local Volatility
687
we have
𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
= −𝑆𝑡𝐾𝜕2𝐶
𝜕𝑆𝑡𝜕𝐾
= −𝐾𝜕
𝜕𝐾
(
𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
)
= −𝐾𝜕
𝜕𝐾
(
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝜕𝐶
𝜕𝐾
)
= −𝐾𝜕𝐶
𝜕𝐾+ 𝐾
(
𝜕𝐶
𝜕𝐾+ 𝐾𝜕2𝐶
𝜕𝐾2
)
= 𝐾2 𝜕2𝐶
𝜕𝐾2 .
By substituting the identities into the Black–Scholes equation,
𝜕𝐶
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
we have
𝜕𝐶
𝜕𝑡+ 1
2𝜎2
𝑡𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝑟−𝐷)𝑆𝑡
(
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝜕𝐶
𝜕𝐾
)
−𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
or
𝜕𝐶
𝜕𝑡+ 1
2𝜎2
𝑡𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝐷−𝑟)𝐾𝜕𝐶
𝜕𝐾−𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with payoff
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
2. Backward Kolmogorov Equation – Local Volatility Model. Let {𝑊𝑡: 𝑡≥0} be a ℙ-
standard Wiener process on the probability space (Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow
a local volatility model with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎(𝑆𝑡, 𝑡) is the local
volatility function and let 𝑟be the risk-free interest-rate parameter from the money-market
account.

688
7.2.2 Local Volatility
Using Taylor’s series, show for a definite integral of a smooth function 𝑓(𝑥) that
∫
𝑏
𝑎
𝑓(𝑢) 𝑑𝑢= 𝑓
(𝑎+ 𝑏
2
)
(𝑏−𝑎) + 𝑂((𝑏−𝑎)3)
and hence show, under the risk-neutral measure ℚ, that
𝔼ℚ[𝑆𝑡+Δ𝑡−𝑆𝑡|| ℱ𝑡
] = (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)3)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)2||| ℱ𝑡
]
= 𝜎
(
𝑆𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)3||| ℱ𝑡
]
= 𝑂((Δ𝑡)2)
for Δ𝑡> 0.
Let 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) be the transition pdf for the asset price where the asset price is 𝑆𝑡
at time 𝑡given that the asset price is 𝑆𝑇at time 𝑇> 𝑡. From the Chapman–Kolmogorov
equation for Δ𝑡> 0,
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) = ∫
∞
0
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡)𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) 𝑑𝑧
show that by expanding 𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) using Taylor series centred on 𝑆𝑡up to second order
and taking limits Δ𝑡→0, 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) satisfies the backward Kolmogorov equation
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇),
∀𝑡.
Solution: From Taylor’s theorem
𝑓(𝑥) = 𝑓
(𝑎+ 𝑏
2
)
+ 𝑓′ (𝑎+ 𝑏
2
) (
𝑥−1
2(𝑎+ 𝑏)
)
+1
2𝑓′′ (𝑎+ 𝑏
2
) (
𝑥−1
2(𝑎+ 𝑏)
)2
+ 𝑂
((
𝑥−1
2(𝑎+ 𝑏)
)3)

7.2.2 Local Volatility
689
and taking integrals
∫
𝑏
𝑎
𝑓(𝑢) 𝑑𝑢= ∫
𝑏
𝑎
𝑓
(𝑎+ 𝑏
2
)
𝑑𝑢+ ∫
𝑏
𝑎
𝑓′ (𝑎+ 𝑏
2
) (
𝑢−1
2(𝑎+ 𝑏)
)
𝑑𝑢
+ ∫
𝑏
𝑎
1
2 𝑓′′ (𝑎+ 𝑏
2
) (
𝑢−1
2(𝑎+ 𝑏)
)2
𝑑𝑢
+ ∫
𝑏
𝑎
𝑂
((
𝑢−1
2(𝑎+ 𝑏)
)3)
𝑑𝑢
= 𝑓
(𝑎+ 𝑏
2
)
(𝑏−𝑎) + 1
2 𝑓′ (𝑎+ 𝑏
2
) (
𝑢−1
2(𝑎+ 𝑏)
)2|||||
𝑏
𝑎
+ 1
3! 𝑓′ (𝑎+ 𝑏
2
) (
𝑢−1
2(𝑎+ 𝑏)
)3|||||
𝑏
𝑎
+ 𝑂
((
𝑢−1
2(𝑎+ 𝑏)
)4)|||||
𝑏
𝑎
= 𝑓
(𝑎+ 𝑏
2
)
(𝑏−𝑎) + 𝑂((𝑏−𝑎)3) .
From Girsanov’s theorem, under the risk-neutral measure ℚ, 𝑆𝑡follows
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊ℚ
𝑡
where 𝑊ℚ
𝑡
= 𝑊𝑡+ ∫
𝑡
0
𝜇−𝑟
𝜎(𝑆𝑢, 𝑢)𝑑𝑢is a ℚ-standard Wiener process.
By using the risk-neutral dynamics
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑆𝑡𝑑𝑊ℚ
𝑡
and taking integrals we have
∫
𝑡+Δ𝑡
𝑡
𝑑𝑆𝑢= ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
or
𝑆𝑡+Δ𝑡−𝑆𝑡= ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢.
Thus, by taking expectations and using the approximation integration formula as well as
the It¯o calculus property,
𝔼ℚ[𝑆𝑡+Δ𝑡−𝑆𝑡|| ℱ𝑡
] = ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢+ 𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
|||||
ℱ𝑡
]
= ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢
= (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)3)

690
7.2.2 Local Volatility
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)2||| ℱ𝑡
]
= (𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)|||||
ℱ𝑡
]
+𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)2||||||
ℱ𝑡
]
= (𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)|||||
ℱ𝑡
]
+ ∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)2𝑆2
𝑢𝑑𝑢
= 𝜎
(
𝑆𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
and
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)3||| ℱ𝑡
]
= (𝑟−𝐷)3
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)3
+2(𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)|||||
ℱ𝑡
]
+(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)2𝑆2
𝑢𝑑𝑢
)
+(𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)|||||
ℱ𝑡
]
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)2𝑆2
𝑢𝑑𝑢
)
+
(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)2𝑆2
𝑢𝑑𝑢
)
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎(𝑆𝑢, 𝑢)𝑆𝑢𝑑𝑊ℚ
𝑢
)|||||
ℱ𝑡
]
= 𝑂((Δ𝑡)2) .

7.2.2 Local Volatility
691
From the Chapman–Kolmogorov equation we have
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) = ∫
∞
0
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡)𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) 𝑑𝑧
and expanding 𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) using Taylor series centred on 𝑆𝑡up to second order yields
𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) = 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + (𝑧−𝑆𝑡) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
+1
2(𝑧−𝑆𝑡)2 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + 𝑂((𝑧−𝑆𝑡)3).
By substituting the Taylor series into the Chapman–Kolmogorov equation we have
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) = 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) ∫
∞
0
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧
+ 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) ∫
∞
0
(𝑧−𝑆𝑡)𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧
+1
2
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) ∫
∞
0
(𝑧−𝑆𝑡)2𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧
+𝑂
(
∫
∞
0
(𝑧−𝑆𝑡)3𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧
)
.
Since
∫
∞
0
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧= 1
∫
∞
0
(𝑧−𝑆𝑡)𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧= (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
∫
∞
0
(𝑧−𝑆𝑡)2𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧= 𝜎
(
𝑆𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
∫
∞
0
(𝑧−𝑆𝑡)3𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑧, 𝑡) 𝑑𝑧= 𝑂((Δ𝑡)2)
then by taking limits Δ𝑡→0,
lim
Δ𝑡→0
𝑝(𝑆𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) −𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
Δ𝑡
= (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
+1
2 lim
Δ𝑡→0 𝜎
(
𝑆𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + lim
Δ𝑡→0 𝑂((Δ𝑡)2)

692
7.2.2 Local Volatility
we have
−𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
or
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇)
for all 𝑡.
3. Black–Scholes Equation – Local Volatility Model. Under the risk-neutral measure ℚ, let
{̃
𝑊𝑡: 𝑡≥0} be a ℚ-standard Wiener process on the probability space (Ω, ℱ, ℚ) and let
the asset price 𝑆𝑡follow a local volatility model with the following SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑̃
𝑊𝑡
where 𝑟is the risk-free interest-rate parameter from the money-market account, 𝐷is the
continuous dividend yield and 𝜎(𝑆𝑡, 𝑡) is the local volatility function.
Let 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) be the transition pdf of the asset price where the asset price is 𝑆𝑡at
time 𝑡given that the asset price is 𝑆𝑇at time 𝑇> 𝑡. We consider a European option written
on 𝑆𝑡with strike price 𝐾> 0 expiring at time 𝑇> 𝑡with payoff Ψ(𝑆𝑇), where the option
price at time 𝑡under the risk-neutral measure ℚis
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧.
By using the backward Kolmogorov equation, show that 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the Black–
Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇).
From the above PDE and boundary condition, can we price a European option analytically?

7.2.2 Local Volatility
693
Solution: Given
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
by taking first and second-order differentials we have
𝜕𝑉
𝜕𝑡= 𝑟𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧+ 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
= 𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
𝜕𝑉
𝜕𝑆𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
Ψ(𝑧) 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
and from Problem 7.2.2.2 (page 687), the backward Kolmogorov equation satisfied by
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) is
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) + (𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝑇; 𝑆𝑇, 𝑇) = 𝛿(𝑆𝑡−𝑆𝑇)
for all 𝑡.
By multiplying the backward Kolmogorov equation with Ψ(𝑆𝑇) and taking integrals we
have
∫
∞
0
Ψ(𝑧) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧+ 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡∫
∞
0
Ψ(𝑧) 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
+(𝑟−𝐷)𝑆𝑡∫
∞
0
Ψ(𝑧) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧= 0.
Writing the above equation in terms of 𝜕𝑉
𝜕𝑡, 𝜕𝑉
𝜕𝑆𝑡
and 𝜕2𝑉
𝜕𝑆2
𝑡
,
𝑒−𝑟(𝑇−𝑡)
[
𝜕𝑉
𝜕𝑡−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
]
= 0
or
𝜕𝑉
𝜕𝑡+ 1
2𝜎(𝑆𝑡, 𝑡)2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0.

694
7.2.2 Local Volatility
Finally, for the boundary condition we note that
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = ∫
∞
0
Ψ(𝑧)𝑝(𝑆𝑇, 𝑇; 𝑧, 𝑇) 𝑑𝑧
and from the definition of the Dirac delta function
𝑉(𝑆𝑇, 𝑇; 𝐾, 𝑇) = ∫
∞
0
Ψ(𝑧)𝑝(𝑆𝑇, 𝑇; 𝑧, 𝑇) 𝑑𝑧
= ∫
∞
0
Ψ(𝑧)𝛿(𝑆𝑇−𝑧) 𝑑𝑧
= Ψ(𝑆𝑇).
Given that the solution of 𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) depends on the unknown local volatility function,
we cannot rely on the analytical Black–Scholes formula to price a European option. In
general, this PDE has to be solved numerically.
4. Forward Kolmogorov Equation – Local Volatility Model. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard
Wiener process on the probability space (Ω, ℱ, ℙ). We consider an asset price 𝑆𝑡following
a local volatility model SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎(𝑆𝑡, 𝑡) is the local
volatility function and let 𝑟be the risk-free interest-rate parameter.
Using Girsanov’s theorem, show that under the risk-neutral measure ℚ, the above SDE
is
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑̃
𝑊𝑡
where ̃
𝑊𝑡is a ℚ-standard Wiener process.
Let 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) be the transition pdf of the asset price where the asset price is 𝑆𝑡
at time 𝑡given that the asset price is 𝑆𝑇at time 𝑇> 𝑡. From the Chapman–Kolmogorov
equation for Δ𝑇> 0,
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇+ Δ𝑇) = ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) 𝑑𝑧
show that in the limit Δ𝑇→0,
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = −∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑇𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧.

7.2.2 Local Volatility
695
Finally, using the backward Kolmogorov equation, show that 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) satisfies the
forward Kolmogorov equation
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎(𝑆𝑇, 𝑇)2𝑆2
𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)] = 0
with boundary condition
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇),
∀𝑡.
Solution: At time 𝑡, the portfolio Π𝑡is valued as
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
where 𝐵𝑡is the risk-free asset having the following diffusion 𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡. Since the holder
of the portfolio will receive 𝐷𝑆𝑡𝑑𝑡for every stock held, then in differential form
𝑑Π𝑡= 𝜙𝑡
(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡) + 𝜓𝑡𝑑𝐵𝑡
= 𝜙𝑡
(𝜇𝑆𝑡𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑆𝑡𝑑𝑊𝑡
) + 𝜓𝑡𝑟𝐵𝑡𝑑𝑡
= 𝑟Π𝑡𝑑𝑡+ 𝜙𝑡(𝜇−𝑟)𝑆𝑡𝑑𝑡+ 𝜙𝑡𝜎(𝑆𝑡, 𝑡)𝑆𝑡𝑑𝑊𝑡
= 𝑟Π𝑡𝑑𝑡+ 𝜙𝑡𝜎(𝑆𝑡, 𝑡)𝑆𝑡
(𝜆𝑡𝑑𝑡+ 𝑑𝑊𝑡
)
where 𝜆𝑡= 𝜇−𝑟
𝜎(𝑆𝑡, 𝑡).
From the discounted portfolio,
𝑑(𝑒−𝑟𝑡Π𝑡) = −𝑟𝑒−𝑟𝑡Π𝑡𝑑𝑡+ 𝑒−𝑟𝑡𝑑Π𝑡
= 𝑒−𝑟𝑡𝜙𝑡𝜎(𝑆𝑡, 𝑡)𝑆𝑡
(𝜆𝑡𝑑𝑡+ 𝑑𝑊𝑡
)
= 𝜙𝑡𝜎(𝑆𝑡, 𝑡)𝑒−𝑟𝑡𝑑̃
𝑊𝑡
where
̃
𝑊𝑡= 𝑊𝑡+ ∫
𝑡
0
𝜇−𝑟
𝜎(𝑆𝑢, 𝑢)𝑑𝑢.
From Girsanov’s theorem, there exists an equivalent martingale measure or risk-neutral
measure ℚon the filtration ℱ𝑠, 0 ≤𝑠≤𝑡defined by the Radon–Nikod´ym derivative
𝑍𝑠= 𝑒−∫𝑡
0 𝜆2
𝑢𝑑𝑢−1
2 ∫𝑡
0 𝜆𝑢𝑑𝑊𝑢
so that ̃
𝑊𝑡is a ℚ-standard Wiener process. Given that under the risk-neutral measure ℚ,
the discounted portfolio has no 𝑑𝑡term, therefore 𝑒−𝑟𝑡Π𝑡is a ℚ-martingale.

696
7.2.2 Local Volatility
By substituting
𝑑𝑊𝑡= 𝑑̃
𝑊𝑡−𝜇−𝑟
𝜎(𝑆𝑡, 𝑡)𝑑𝑡
into
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊𝑡
the asset price diffusion process under ℚbecomes
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑̃
𝑊𝑡.
From the Chapman–Kolmogorov equation for Δ𝑇> 0,
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇+ Δ𝑇) = ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) 𝑑𝑧
we can write
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
= ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) 𝑑𝑧−𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
= ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) 𝑑𝑧
−∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧
= ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) 𝑑𝑧
−∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝛿(𝑧−𝑆𝑇) 𝑑𝑧.
By dividing the expression with Δ𝑇and taking limits Δ𝑇→0,
lim
Δ𝑇→0
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
Δ𝑇
= lim
Δ𝑡→0 ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇)
Δ𝑇
𝑑𝑧
−lim
Δ𝑇→0 ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝛿(𝑧−𝑆𝑇)
Δ𝑇
𝑑𝑧
= lim
Δ𝑇→0 ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
[𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) −𝛿(𝑧−𝑆𝑇)
Δ𝑇
]
𝑑𝑧
= lim
Δ𝑇→0 ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
[𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) −𝑝(𝑧, 𝑇+ Δ𝑇; 𝑆𝑇, 𝑇+ Δ𝑇)
Δ𝑇
]
𝑑𝑧.

7.2.2 Local Volatility
697
Since
lim
Δ𝑇→0
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
Δ𝑇
= 𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
and
lim
Δ𝑇→0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇+ Δ𝑇) −𝑝(𝑧, 𝑇+ Δ𝑇; 𝑆𝑇, 𝑇+ Δ𝑇)
Δ𝑇
= −𝜕
𝜕𝑇𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
thus
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = −∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑇𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧.
From the backward Kolmogorov equation on 𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) for the local volatility model
𝜕
𝜕𝑡𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑧, 𝑡)2𝑧2 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) + (𝑟−𝐷)𝑧𝜕
𝜕𝑧𝑝(𝑧, 𝑡; 𝑆𝑇, 𝑇) = 0
we have
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
= ∫
∞
0
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
[
(𝑟−𝐷)𝑧𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) + 1
2𝜎(𝑧, 𝑇)2𝑧2 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
]
𝑑𝑧
= ∫
∞
0
(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧
+ ∫
∞
0
1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧.
Integrating by parts for ∫
∞
0
(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧, we let
𝑢= (𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
and
𝑑𝑣
𝑑𝑧= 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑧= 𝜕
𝜕𝑧
[(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]
and
𝑣= 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇).

698
7.2.2 Local Volatility
We then have
∫
∞
0
(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)𝑑𝑧
= (𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)||
∞
0
−∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕
𝜕𝑧
[(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= −∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕
𝜕𝑧
[(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧.
Taking integration by parts for ∫
∞
0
1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧, we let
𝑢= 1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
and
𝑑𝑣
𝑑𝑧= 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑧= 𝜕
𝜕𝑧
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
and
𝑣= 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
and hence
∫
∞
0
1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧
= 1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
||||
∞
0
−∫
∞
0
𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕
𝜕𝑧
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧
= −∫
∞
0
𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕
𝜕𝑧
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧.
Using integration by parts again, we let
𝑢= 𝜕
𝜕𝑧
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
and
𝑑𝑣
𝑑𝑧= 𝜕
𝜕𝑧𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑧= 𝜕2
𝜕𝑧2
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
and
𝑣= 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)

7.2.2 Local Volatility
699
and therefore
∫
∞
0
1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝑧2 𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝑑𝑧
= −𝜕
𝜕𝑧
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇)||||
∞
0
+ ∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕2
𝜕𝑧2
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧
= ∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕2
𝜕𝑧2
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧.
Thus,
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
= −∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕
𝜕𝑧
[
(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧
+ ∫
∞
0
𝑝(𝑧, 𝑇; 𝑆𝑇, 𝑇) 𝜕2
𝜕𝑧2
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧
= ∫
∞
0
{
𝜕2
𝜕𝑧2
[1
2𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
−𝜕
𝜕𝑧
[(𝑟−𝐷)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]}
𝛿(𝑧−𝑆𝑇) 𝑑𝑧
=
𝜕2
𝜕𝑆2
𝑇
[1
2𝜎(𝑆𝑇, 𝑇)2𝑆2
𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)
]
−
𝜕
𝜕𝑆𝑇
[(𝑟−𝐷)𝑆𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)]
and rearranging terms we have the forward Kolmogorov equation
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎(𝑆𝑇, 𝑇)2𝑆2
𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)] = 0
with boundary condition
𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇), ∀𝑡.
5. Dupire Equation. Let {𝑊𝑡: 𝑡≥0} be a ℙ-standard Wiener process on the probability
space (Ω, ℱ, ℙ) and let the stock price 𝑆𝑡follow a local volatility model with the following
SDE
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎(𝑆𝑡, 𝑡)𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎(𝑆𝑡, 𝑡) is the local
volatility function and let 𝑟be the risk-free interest rate.

700
7.2.2 Local Volatility
Let 𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) be the transition pdf of the stock price where the stock is worth
𝑆𝑡at time 𝑡given that the stock price is 𝑆𝑇at time 𝑇> 𝑡. We consider a European
call option written on 𝑆𝑡with strike price 𝐾> 0 expiring at time 𝑇> 𝑡with payoff
Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0} where, under the risk-neutral measure ℚ, the option price at
time 𝑡is
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
max{𝑧−𝐾, 0}𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧.
Show that the following identities are true
𝑧𝜕
𝜕𝐾(𝑧−𝐾) = 𝐾𝜕
𝜕𝐾(𝑧−𝐾) −(𝑧−𝐾)
𝜕
𝜕𝑧(𝑧−𝐾) = −𝜕
𝜕𝐾(𝑧−𝐾)
𝜕2
𝜕𝑧2 (𝑧−𝐾) =
𝜕2
𝜕𝐾2 (𝑧−𝐾).
By using the forward Kolmogorov equation and the above identities or otherwise, show
that 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies the Dupire equation
𝜕𝐶
𝜕𝑇−1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
Explain the significance of this equation.
Finally, deduce that a European put option price 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) written on 𝑆𝑡at time 𝑡,
with payoff Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0} expiring at time 𝑇> 𝑡, satisfies
𝜕𝑃
𝜕𝑇−1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝑃
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝑃
𝜕𝐾+ 𝐷𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}.

7.2.2 Local Volatility
701
Solution: To show the first identity, we can write
𝑧𝜕
𝜕𝐾(𝑧−𝐾) = (𝑧−𝐾+ 𝐾) 𝜕
𝜕𝐾(𝑧−𝐾)
= (𝑧−𝐾) 𝜕
𝜕𝐾(𝑧−𝐾) + 𝐾𝜕
𝜕𝐾(𝑧−𝐾)
= −(𝑧−𝐾) + 𝐾𝜕
𝜕𝐾(𝑧−𝐾)
= 𝐾𝜕
𝜕𝐾(𝑧−𝐾) −(𝑧−𝐾).
As for the second identity, we note that
𝜕
𝜕𝑧(𝑧−𝐾) = 1 = −𝜕
𝜕𝐾(𝑧−𝐾).
Finally,
𝜕2
𝜕𝑧2 (𝑧−𝐾) = 𝜕
𝜕𝑧
[ 𝜕
𝜕𝑧(𝑧−𝐾)
]
= −𝜕
𝜕𝑧
[ 𝜕
𝜕𝐾(𝑧−𝐾)
]
= −𝜕
𝜕𝐾
[ 𝜕
𝜕𝑧(𝑧−𝐾)
]
=
𝜕2
𝜕𝐾2 (𝑧−𝐾).
By definition
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
max{𝑧−𝐾, 0}𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧.
Differentiating 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) with respect to 𝑇and from the forward Kolmogorov equa-
tion
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎(𝑆𝑇, 𝑇)2𝑆2
𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇)] = 0

702
7.2.2 Local Volatility
we have
𝜕𝐶
𝜕𝑇= −𝑟𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾) 𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
= −𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾) 𝜕2
𝜕𝑧2
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
−(𝑟−𝐷)𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾) 𝜕
𝜕𝑧
[𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧.
Integrate by parts for ∫
∞
𝐾
(𝑧−𝐾) 𝜕
𝜕𝑧
[𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧and let
𝑢= (𝑧−𝐾),
𝑑𝑣
𝑑𝑧= 𝜕
𝜕𝑧
[𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]
so that
𝑑𝑢
𝑑𝑧= 𝜕
𝜕𝑧(𝑧−𝐾) = −𝜕
𝜕𝐾(𝑧−𝐾)
and
𝑣= 𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇).
Therefore,
∫
∞
𝐾
(𝑧−𝐾) 𝜕
𝜕𝑧
[𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= (𝑧−𝐾)𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)||
∞
𝐾+ ∫
∞
𝐾
𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝐾(𝑧−𝐾) 𝑑𝑧
= ∫
∞
𝐾
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)𝑧𝜕
𝜕𝐾(𝑧−𝐾) 𝑑𝑧
= ∫
∞
𝐾
[
𝐾𝜕
𝜕𝐾(𝑧−𝐾) −(𝑧−𝐾)
]
𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
= 𝐾∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧−∫
∞
𝐾
(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
and hence
𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾) 𝜕
𝜕𝑧
[𝑧𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= 𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
−𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
= 𝐾𝜕𝐶
𝜕𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇).

7.2.2 Local Volatility
703
For ∫
∞
𝐾
(𝑧−𝐾) 𝜕2
𝜕𝑧2
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧we let
𝑢= (𝑧−𝐾)
and
𝑑𝑣
𝑑𝑧= 𝜕2
𝜕𝑧2
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]
so that
𝑑𝑢
𝑑𝑧= 𝜕
𝜕𝑧(𝑧−𝐾)
and
𝑣= 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]
and therefore
∫
∞
𝐾
(𝑧−𝐾) 𝜕2
𝜕𝑧2
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= (𝑧−𝐾) 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]||||
∞
𝐾
−∫
∞
𝐾
𝜕
𝜕𝑧(𝑧−𝐾) 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= −∫
∞
𝐾
𝜕
𝜕𝑧(𝑧−𝐾) 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧.
To integrate −∫
∞
𝐾
𝜕
𝜕𝑧(𝑧−𝐾) 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧we set
𝑢= 𝜕
𝜕𝑧(𝑧−𝐾)
and
𝑑𝑣
𝑑𝑧= 𝜕
𝜕𝑧
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)]
so that
𝑑𝑢
𝑑𝑧= 𝜕2
𝜕𝑧2 (𝑧−𝐾)
and
𝑣= 𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
and hence
−∫
∞
𝐾
(𝑧−𝐾) 𝜕2
𝜕𝑧2
[𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
= −𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕
𝜕𝑧(𝑧−𝐾)
||||
∞
𝐾
+ ∫
∞
𝐾
𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝑧2 (𝑧−𝐾) 𝑑𝑧
= 𝜎(𝐾, 𝑇)2𝐾2𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑇) + ∫
∞
𝐾
𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝜕2
𝜕𝐾2 (𝑧−𝐾) 𝑑𝑧
= 𝜎(𝐾, 𝑇)2𝐾2𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑇)
since 𝜕
𝜕𝑧(𝑧−𝐾) = 1 and 𝜕2
𝜕𝑧2 (𝑧−𝐾) =
𝜕2
𝜕𝐾2 (𝑧−𝐾) = 0.

704
7.2.2 Local Volatility
Given that
𝜕2𝐶
𝜕𝐾2 =
𝜕
𝜕𝐾
( 𝜕𝐶
𝜕𝐾
)
=
𝜕
𝜕𝐾
[
𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)] 𝑑𝑧
]
= 𝑒−𝑟(𝑇−𝑡)
[
−𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑇) 𝜕
𝜕𝐾(𝑧−𝐾) + ∫
∞
𝐾
𝜕2
𝜕𝐾2 (𝑧−𝐾)𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇) 𝑑𝑧
]
= 𝑒−𝑟(𝑇−𝑡)𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑇)
therefore
1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
(𝑧−𝐾) 𝜕2
𝜕𝑧2
[
𝜎(𝑧, 𝑇)2𝑧2𝑝(𝑆𝑡, 𝑡; 𝑧, 𝑇)
]
𝑑𝑧= 1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝐶
𝜕𝐾2 .
Thus,
𝜕𝐶
𝜕𝑇= −𝑟𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝐶
𝜕𝐾2 −(𝑟−𝐷)
[
𝐾𝜕𝐶
𝜕𝐾−𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
]
or
𝜕𝐶
𝜕𝑇−1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
From the equation, we can write
𝜎(𝐾, 𝑇)2 =
2
(𝜕𝐶
𝜕𝑇+ (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
)
𝐾2 𝜕2𝐶
𝜕𝐾2
such that given the current spot price 𝑆𝑡, the local volatility function 𝜎(𝑆𝑡, 𝑡) can be
obtained from market quotes of call options of arbitrary strikes 𝐾and expiry times 𝑇.
From the put–call parity
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)

7.2.2 Local Volatility
705
we have
𝜕𝐶
𝜕𝑇= 𝜕𝑃
𝜕𝑇−𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝑟𝐾𝑒−𝑟(𝑇−𝑡)
𝜕𝐶
𝜕𝐾= 𝜕𝑃
𝜕𝐾−𝑒−𝑟(𝑇−𝑡)
𝜕2𝐶
𝜕𝐾2 = 𝜕2𝑃
𝜕𝐾2 .
Substituting the above information into the Dupire equation for 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇), we have
𝜕𝑃
𝜕𝑇−𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝑟𝐾𝑒−𝑟(𝑇−𝑡) −1
2𝜎(𝐾, 𝑇)2 𝜕2𝑃
𝜕𝐾2 + (𝑟−𝐷)𝐾
[ 𝜕𝑃
𝜕𝐾−𝑒−𝑟(𝑇−𝑡)]
+𝐷[𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)] = 0
or
𝜕𝑃
𝜕𝑇−1
2𝜎(𝐾, 𝑇)2𝐾2 𝜕2𝑃
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝑃
𝜕𝐾+ 𝐷𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑃(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}.
6. Time-Dependent Volatility. Consider a time-dependent (or term-structure) volatility func-
tion 𝜎(𝑡) and the implied volatility function 𝜎imp(𝑡, 𝑇), which is a function of 𝑡and 𝑇, 𝑇> 𝑡
and assume their relationship is defined by
𝜎2
imp(𝑡, 𝑇) =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2(𝑢) 𝑑𝑢.
For two given expiry times 𝑇1 < 𝑇2, show that
∫
𝑇2
𝑇1
𝜎2(𝑢) 𝑑𝑢= (𝑇2 −𝑡)𝜎2
imp(𝑡, 𝑇2) −(𝑇1 −𝑡)𝜎2
imp(𝑡, 𝑇1).
If the volatility is a piecewise constant over the time interval [𝑇1, 𝑇2], find 𝜎(𝑢), 𝑇1 < 𝑢<
𝑇2.
Solution: By definition
∫
𝑇2
𝑇1
𝜎2(𝑢) 𝑑𝑢= ∫
𝑇2
𝑡
𝜎2(𝑢) 𝑑𝑢−∫
𝑇1
𝑡
𝜎2(𝑢) 𝑑𝑢
= (𝑇2 −𝑡)𝜎2
imp(𝑡, 𝑇2) −(𝑇1 −𝑡)𝜎2
imp(𝑡, 𝑇1).

706
7.2.2 Local Volatility
Assuming
∫
𝑇2
𝑇1
𝜎2(𝑢) 𝑑𝑢= 𝜎2(𝑢)(𝑇2 −𝑇1), 𝑇1 < 𝑢< 𝑇2
and using the above result, we have
𝜎2(𝑢)(𝑇2 −𝑇1) = (𝑇2 −𝑡)𝜎2
imp(𝑡, 𝑇2) −(𝑇1 −𝑡)𝜎2
imp(𝑡, 𝑇1)
or
𝜎(𝑢) =
√
√
√
√(𝑇2 −𝑡)𝜎2
imp(𝑡, 𝑇2) −(𝑇1 −𝑡)𝜎2
imp(𝑡, 𝑇1)
𝑇2 −𝑇1
, 𝑇1 < 𝑢< 𝑇2.
7. Relationship Between Local Volatility and Implied Volatility. Let the relationship between
the market-quoted call prices 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) and their corresponding implied volatilities
𝜎imp(𝑆𝑡, 𝑡; 𝐾, 𝑇) be given by the Black–Scholes formula
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑imp
+ ) −𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑imp
−)
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2
imp)(𝑇−𝑡)
𝜎imp
√
𝑇−𝑡
where Φ(𝑥) =
1
√
2𝜋∫
𝑥
−∞
𝑒−1
2 𝑥2𝑑𝑥is the cdf of a standard normal and 𝜎imp ≡
𝜎imp(𝑆𝑡, 𝑡; 𝐾, 𝑇).
From the Dupire equation, the local volatility 𝜎(𝐾, 𝑇) is extracted from
𝜎(𝐾, 𝑇)2 =
2
(𝜕𝐶
𝜕𝑇+ (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
)
𝐾2 𝜕2𝐶
𝜕𝐾2
.
By writing the Black–Scholes formula in the form
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝑆𝑡𝑁1 −𝐾𝑁2
where 𝑁1 = 𝑒−𝐷(𝑇−𝑡)Φ(𝑑imp
+ ), 𝑁2 = 𝑒−𝑟(𝑇−𝑡)Φ(𝑑imp
−) and using the property
𝑑imp
+
= 𝑑imp
−
+ 𝜎imp(𝑆𝑡, 𝑡; 𝐾, 𝑇)
√
𝑇−𝑡
show that

7.2.2 Local Volatility
707
(a) 𝑆𝑡
𝜕𝑁1
𝜕𝑑imp
+
−𝐾𝜕𝑁2
𝜕𝑑imp
−
= 0
(b)
𝜕𝑑imp
+
𝜕𝑇
−
𝜕𝑑imp
−
𝜕𝑇
=
𝜎imp
2
√
𝑇−𝑡
+
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝑇
(c)
𝜕𝑑imp
+
𝜕𝐾
−
𝜕𝑑imp
−
𝜕𝐾
=
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
(d)
𝜕𝑑imp
−
𝜕𝐾
= −
1
𝐾𝜎imp
√
𝑇−𝑡
−
(
𝑑imp
−
𝜎imp
+
√
𝑇−𝑡
)
𝜕𝜎imp
𝜕𝐾.
Hence, using the above properties or otherwise, show that the local volatility function in
terms of implied volatility is
𝜎(𝐾, 𝑇)2 =
2
(𝜕𝜎imp
𝜕𝑇
+ (𝑟−𝐷)𝐾
𝜕𝜎imp
𝜕𝐾
+ 1
2
𝜎imp
𝑇−𝑡
)
𝐾2 𝜕2𝜎imp
𝜕𝐾2
+
2𝐾𝑑imp
+
𝜎imp
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+
𝐾2𝑑imp
+ 𝑑imp
−
𝜎imp
(𝜕𝜎imp
𝜕𝐾
)2
+
1
𝜎imp
√
𝑇−𝑡
.
Solution:
(a) Using the identity 𝑑imp
+
= 𝑑imp
−
−𝜎imp
√
𝑇−𝑡, from Problem 2.2.4.1 (page 218), we
can easily show that
𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑imp
+
)2 = 𝐾𝑒−𝑟(𝑇−𝑡)𝑒−1
2 (𝑑imp
−
)2
or
𝑆𝑡𝑒−𝐷(𝑇−𝑡)
1
√
2𝜋
𝑒−1
2 (𝑑imp
+
)2 = 𝐾𝑒−𝑟(𝑇−𝑡)
1
√
2𝜋
𝑒−1
2 (𝑑imp
−
)2
which implies
𝑆𝑡
𝜕𝑁1
𝜕𝑑imp
+
= 𝐾𝜕𝑁2
𝜕𝑑imp
−
and hence
𝑆𝑡
𝜕𝑁1
𝜕𝑑imp
+
−𝐾𝜕𝑁2
𝜕𝑑imp
−
= 0.
(b) From 𝑑imp
+
−𝑑imp
−
= 𝜎imp
√
𝑇−𝑡and taking partial derivatives with respect to 𝑇, we
have
𝜕𝑑imp
+
𝜕𝑇
−
𝜕𝑑imp
−
𝜕𝑇
=
𝜎imp
2
√
𝑇−𝑡
+
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝑇
.

708
7.2.2 Local Volatility
(c) From 𝑑imp
+
−𝑑imp
−
= 𝜎imp
√
𝑇−𝑡and taking partial derivatives with respect to 𝐾, we
have
𝜕𝑑imp
+
𝜕𝐾
−
𝜕𝑑imp
−
𝜕𝐾
=
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾.
(d) From 𝑑imp
−
=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷−1
2𝜎2
imp)(𝑇−𝑡)
𝜎imp
√
𝑇−𝑡
and taking partial derivatives with
respect to 𝐾, we have
𝜕𝑑imp
−
𝜕𝐾
=
−𝜎imp
√
𝑇−𝑡
(
1
𝐾+ 𝜎imp
𝜕𝜎imp
𝜕𝐾(𝑇−𝑡)
)
𝜎2
imp(𝑇−𝑡)
−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
(
log(𝑆𝑡∕𝐾) +
(
𝑟−𝐷−1
2𝜎2
imp
)
(𝑇−𝑡)
)
𝜎2
imp(𝑇−𝑡)
= −
1
𝐾𝜎imp
√
𝑇−𝑡
−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
−
𝑑imp
−
𝜎imp
𝜕𝜎imp
𝜕𝐾
= −
1
𝐾𝜎imp
√
𝑇−𝑡
−
(
𝑑imp
−
𝜎imp
+
√
𝑇−𝑡
)
𝜕𝜎imp
𝜕𝐾.
Using the above information,
𝜕𝐶
𝜕𝑇= −𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝑑imp
+ ) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ′(𝑑imp
+ )
𝜕𝑑imp
+
𝜕𝑇
+𝑟𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝑑imp
−) −𝐾𝑒−𝑟(𝑇−𝑡)Φ′(𝑑imp
−)
𝜕𝑑imp
−
𝜕𝑇
= −𝐷𝑆𝑡𝑁1 + 𝑟𝐾𝑁2 + 𝑆𝑡
𝜕𝑁1
𝜕𝑑imp
+
𝜕𝑑imp
+
𝜕𝑇
−𝐾𝜕𝑁2
𝜕𝑑imp
−
𝜕𝑑imp
−
𝜕𝑇
= −𝐷𝑆𝑡𝑁1 + 𝑟𝐾𝑁2 + 𝐾𝜕𝑁2
𝜕𝑑imp
−
(
𝜕𝑑imp
+
𝜕𝑇
−
𝜕𝑑imp
−
𝜕𝑇
)
= −𝐷𝑆𝑡𝑁1 + 𝑟𝐾𝑁2 + 𝐾𝜕𝑁2
𝜕𝑑imp
−
(
𝜎imp
2
√
𝑇−𝑡
+
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝑇
)

7.2.2 Local Volatility
709
(𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾= (𝑟−𝐷)𝐾
[
𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ′(𝑑imp
+ )
𝜕𝑑imp
+
𝜕𝐾
−𝑒−𝑟(𝑇−𝑡)Φ(𝑑imp
−)
−𝐾𝑒−𝑟(𝑇−𝑡)Φ′(𝑑imp
−)
𝜕𝑑imp
−
𝜕𝐾
]
= (𝑟−𝐷)𝐾
[
𝐾𝑒−𝑟(𝑇−𝑡)Φ′(𝑑imp
−)
(
𝜕𝑑imp
+
𝜕𝐾
−
𝜕𝑑imp
−
𝜕𝐾
)
−𝑒−𝑟(𝑇−𝑡)Φ(𝑑imp
−)]
= (𝑟−𝐷)𝐾2 𝜕𝑁2
𝜕𝑑imp
−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
−(𝑟−𝐷)𝐾𝑁2
𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝐷𝑆𝑡𝑁1 −𝐷𝐾𝑁2
and
𝐾2 𝜕2𝐶
𝜕𝐾2 = 𝐾2
[
𝜕
𝜕𝐾
(
𝐾𝜕𝑁2
𝜕𝑑imp
−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
−𝑁2
)]
= 𝐾2
[
𝜕𝑁2
𝜕𝑑−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
−𝐾𝑑imp
−
𝜕𝑁2
𝜕𝑑imp
−
𝜕𝑑imp
−
𝜕𝐾
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+𝐾𝜕𝑁2
𝜕𝑑imp
−
√
𝑇−𝑡
𝜕2𝜎imp
𝜕𝐾2
−𝜕𝑁2
𝜕𝑑imp
−
𝜕𝑑imp
−
𝜕𝐾
]
= 𝐾2 𝜕𝑁2
𝜕𝑑imp
−
[√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
−𝐾
√
𝑇−𝑡𝑑imp
−
𝜕𝑑imp
−
𝜕𝐾
𝜕𝜎imp
𝜕𝐾
+𝐾
√
𝑇−𝑡
𝜕2𝜎imp
𝜕𝐾2
−
𝜕𝑑imp
−
𝜕𝐾
]
= 𝐾2 𝜕𝑁2
𝜕𝑑imp
−
[√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+ 𝐾
√
𝑇−𝑡
𝜕2𝜎imp
𝜕𝐾2
+
(
𝐾𝑑imp
−
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+ 1
) ⎛
⎜
⎜⎝
1
𝐾𝜎imp
√
𝑇−𝑡
+
(
𝑑imp
−
𝜎imp
+
√
𝑇−𝑡
)
𝜕𝜎imp
𝜕𝐾
⎞
⎟
⎟⎠
⎤
⎥
⎥⎦
= 𝐾2 𝜕𝑁2
𝜕𝑑imp
−
[
2
(
𝑑imp
−
𝜎imp
+
√
𝑇−𝑡
)
𝜕𝜎imp
𝜕𝐾
+ 𝐾
√
𝑇−𝑡
𝜕2𝜎imp
𝜕𝐾2
+𝐾𝑑imp
−
√
𝑇−𝑡
(
𝑑imp
−
𝜎imp
+
√
𝑇−𝑡
) (𝜕𝜎imp
𝜕𝐾
)2
+
1
𝐾𝜎imp
√
𝑇−𝑡
⎤
⎥
⎥⎦

710
7.2.3 Stochastic Volatility
= 𝐾2 𝜕𝑁2
𝜕𝑑imp
−
[
2𝑑imp
+
𝜎imp
𝜕𝜎imp
𝜕𝐾
+ 𝐾
√
𝑇−𝑡
𝜕2𝜎imp
𝜕𝐾2
+𝐾
(
𝑑imp
+ 𝑑imp
−
𝜎imp
) √
𝑇−𝑡
(𝜕𝜎imp
𝜕𝐾
)2
+
1
𝐾𝜎imp
√
𝑇−𝑡
⎤
⎥
⎥⎦
= 𝐾𝜕𝑁2
𝜕𝑑−
√
𝑇−𝑡
⎡
⎢
⎢⎣
𝐾2 𝜕2𝜎imp
𝜕𝐾2
+
2𝐾𝑑imp
+
𝜎imp
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+
𝐾2𝑑imp
+ 𝑑imp
−
𝜎imp
(𝜕𝜎imp
𝜕𝐾
)2
+
1
𝜎imp
√
𝑇−𝑡
⎤
⎥
⎥⎦
.
Gathering all this information, we have
𝜎(𝐾, 𝑇)2 =
2
(𝜕𝜎imp
𝜕𝑇
+ (𝑟−𝐷)𝐾
𝜕𝜎imp
𝜕𝐾
+ 1
2
𝜎imp
𝑇−𝑡
)
𝐾2 𝜕2𝜎imp
𝜕𝐾2
+
2𝐾𝑑imp
+
𝜎imp
√
𝑇−𝑡
𝜕𝜎imp
𝜕𝐾
+
𝐾2𝑑imp
+ 𝑑imp
−
𝜎imp
(𝜕𝜎imp
𝜕𝐾
)2
+
1
𝜎imp
√
𝑇−𝑡
.
7.2.3
Stochastic Volatility
1. Generalised Stochastic Volatility Model. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑌
𝑡
: 𝑡≥0} be two cor-
related ℙ-standard Wiener processes on the probability space (Ω, ℱ, ℙ). Suppose we have
a stochastic volatility model having the following diffusion processes
𝑑𝑆𝑡= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝑌𝑡= 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑊𝑌
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑌
𝑡
= 𝜌𝑑𝑡
where 𝑆𝑡is the asset price which pays no dividends, 𝜎(𝑌𝑡, 𝑡) is the volatility process,
𝜇(𝑆𝑡, 𝑌𝑡, 𝑡), 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡) and 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡) are continuous functions and 𝜌∈(−1, 1) is the cor-
relation. In addition, let 𝐵𝑡be a risk-free asset having the following differential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟is a constant risk-free interest rate.
By defining {𝑊𝑡: 𝑡≥0} as a standard Wiener process where 𝑊𝑡⟂⟂𝑊𝑌
𝑡, show that we
can write
𝑊𝑆
𝑡
= 𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡.

7.2.3 Stochastic Volatility
711
Using the two-dimensional Girsanov’s theorem, show that under the risk-neutral measure
ℚ,
𝑑𝑆𝑡= 𝑟𝑆𝑡𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡)𝑆𝑡
(
𝜌𝑑̃
𝑊𝑌
𝑡
+
√
1 −𝜌2𝑑̃
𝑊𝑡
)
𝑑𝑌𝑡= [𝛼(𝑆𝑡, 𝑌𝑡, 𝑡) −𝛾𝑡𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)] 𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑̃
𝑊𝑌
𝑡
where ̃
𝑊𝑡and ̃
𝑊𝑌
𝑡
are ℚ-standard Wiener processes and 𝛾𝑡is the market price of volatility
risk.
Solution: For the first part of the solution, from 𝑊𝑆
𝑡
= 𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡we have
𝔼(𝑊𝑆
𝑡) = 𝔼(𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡) = 𝜌𝔼(𝑊𝑌
𝑡) +
√
1 −𝜌2𝔼(𝑊𝑡) = 0
and
Var(𝑊𝑆
𝑡) = Var(𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡) = 𝜌2Var(𝑊𝑌
𝑡) + (1 −𝜌2)Var(𝑊𝑡) = 𝑡.
Given both 𝑊𝑌
𝑡
∼(0, 𝑡), 𝑊𝑡∼(0, 𝑡) and 𝑊𝑌
𝑡
⟂⟂𝑊𝑡therefore
𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡∼(0, 𝑡).
In addition, using It¯o’s formula and taking note that 𝑊𝑌
𝑡
⟂⟂𝑊𝑡,
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑌
𝑡
= 𝑑(𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡) ⋅𝑑𝑊𝑌
𝑡
= (𝜌𝑑𝑊𝑌
𝑡
+
√
1 −𝜌2𝑑𝑊𝑡) ⋅𝑑𝑊𝑌
𝑡
= 𝜌(𝑑𝑊𝑌
𝑡)2 +
√
1 −𝜌2𝑑𝑊𝑡⋅𝑑𝑊𝑌
𝑡
= 𝜌𝑑𝑡.
Thus, we can write 𝑊𝑆
𝑡
= 𝜌𝑊𝑌
𝑡
+
√
1 −𝜌2𝑊𝑡.
Under the ℙ-measure we have
𝑑𝑆𝑡= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡)𝑆𝑡
(√
1 −𝜌2𝑑𝑊𝑡+ 𝜌𝑑𝑊𝑌
𝑡
)
𝑑𝑌𝑡= 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑊𝑌
𝑡
and by defining
̃
𝑊𝑌
𝑡
= 𝑊𝑌
𝑡
+ ∫
𝑡
0
𝛾𝑢𝑑𝑢
̃
𝑊𝑡= 𝑊𝑡+ ∫
𝑡
0
𝜆𝑢𝑑𝑢
where 𝛾𝑡is the market price of volatility risk and 𝜆𝑡is the market price of asset price risk,
and since 𝑊𝑡⟂⟂𝑊𝑌
𝑡, therefore ̃
𝑊𝑡⟂⟂̃
𝑊𝑌
𝑡.

712
7.2.3 Stochastic Volatility
From the two-dimensional Girsanov’s theorem, there exists a risk-neutral measure ℚon
the filtration ℱ𝑠, 0 ≤𝑠≤𝑡defined by the Radon–Nikod´ym process
𝑑ℚ
𝑑ℙ= 𝑍𝑡= 𝑒−1
2 ∫𝑡
0 𝜆2
𝑢𝑑𝑢−∫𝑡
0 𝜆𝑢𝑑𝑊𝑢⋅𝑒−1
2 ∫𝑡
0 𝛾2
𝑢𝑑𝑢−∫𝑡
0 𝛾𝑢𝑑𝑊𝑌
𝑢
so that ̃
𝑊𝑡and ̃
𝑊𝑌
𝑡
are ℚ-standard Wiener processes and ̃
𝑊𝑡⟂⟂̃
𝑊𝑌
𝑡.
Let 𝑋𝑡= 𝑒−𝑟𝑡𝑆𝑡be the discounted asset price, and from the application of It¯o’s formula
𝑑𝑋𝑡= 𝜕𝑋𝑡
𝜕𝑡𝑑𝑡+ 𝜕𝑋𝑡
𝜕𝑆𝑡
𝑑𝑆𝑡+ 1
2
𝜕2𝑋𝑡
𝜕𝑡2 (𝑑𝑡)2 + 1
2
𝜕2𝑋𝑡
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + …
= −𝑟𝑒−𝑟𝑡𝑆𝑡𝑑𝑡+ 𝑒−𝑟𝑡(
𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑡+
√
1 −𝜌2𝜎(𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑊𝑡
+𝜌𝜎(𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑊𝑌
𝑡
)
= −𝑟𝑋𝑡𝑑𝑡+ 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑋𝑡𝑑𝑡+
√
1 −𝜌2𝜎(𝑌𝑡, 𝑡)𝑋𝑡𝑑𝑊𝑡+ 𝜌𝜎(𝑌𝑡, 𝑡)𝑋𝑡𝑑𝑊𝑌
𝑡
= 𝜎(𝑌𝑡, 𝑡)𝑋𝑡
[(𝜇(𝑆𝑡, 𝑌𝑡, 𝑡) −𝑟
𝜎(𝑌𝑡, 𝑡)
)
𝑑𝑡+
√
1 −𝜌2𝑑𝑊𝑡+ 𝜌𝑑𝑊𝑌
𝑡
]
= 𝜎(𝑌𝑡, 𝑡)𝑋𝑡
[(𝜇(𝑆𝑡, 𝑌𝑡, 𝑡) −𝑟
𝜎(𝑌𝑡, 𝑡)
)
𝑑𝑡+
√
1 −𝜌2
(
𝑑̃
𝑊𝑡−𝜆𝑡𝑑𝑡
)
+𝜌
(
𝑑̃
𝑊𝑌
𝑡
−𝛾𝑡𝑑𝑡
)]
= 𝜎(𝑌𝑡, 𝑡)𝑋𝑡
[{(𝜇(𝑆𝑡, 𝑌𝑡, 𝑡) −𝑟
𝜎(𝑌𝑡, 𝑡)
)
−
√
1 −𝜌2𝜆𝑡−𝜌𝛾𝑡
}
𝑑𝑡
+
√
1 −𝜌2𝑑̃
𝑊𝑡+ 𝜌𝑑̃
𝑊𝑌
𝑡
]
.
To ensure that 𝑒−𝑟𝑡𝑆𝑡is a ℚ-martingale, we therefore set
√
1 −𝜌2𝜆𝑡+ 𝜌𝛾𝑡= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡) −𝑟
𝜎(𝑌𝑡, 𝑡)
.
Using the above relationship and substituting
𝑑𝑊𝑡= 𝑑̃
𝑊𝑡−𝜆𝑡𝑑𝑡
𝑑𝑊𝑌
𝑡
= 𝑑̃
𝑊𝑌
𝑡
−𝛾𝑡𝑑𝑡
into
𝑑𝑆𝑡= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡)𝑆𝑡
(√
1 −𝜌2𝑑𝑊𝑡+ 𝜌𝑑𝑊𝑌
𝑡
)
𝑑𝑌𝑡= 𝛼(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑𝑊𝑌
𝑡

7.2.3 Stochastic Volatility
713
the asset price under the risk-neutral measure ℚbecomes
𝑑𝑆𝑡= 𝜇(𝑆𝑡, 𝑌𝑡, 𝑡)𝑆𝑡𝑑𝑡+
√
1 −𝜌2𝜎(𝑌𝑡, 𝑡)𝑆𝑡
(
𝑑̃
𝑊𝑡−𝜆𝑡𝑑𝑡
)
+𝜌𝜎(𝑌𝑡, 𝑡)𝑆𝑡
(
𝑑̃
𝑊𝑌
𝑡
−𝛾𝑡𝑑𝑡
)
= 𝑟𝑆𝑡𝑑𝑡+
√
1 −𝜌2𝜎(𝑌𝑡, 𝑡)𝑆𝑡𝑑̃
𝑊𝑡+ 𝜌𝜎(𝑌𝑡, 𝑡)𝑆𝑡𝑑̃
𝑊𝑌
𝑡
and the stochastic volatility under the risk-neutral measure ℚis
𝑑𝑌𝑡= [𝛼(𝑆𝑡, 𝑌𝑡, 𝑡) −𝛾𝑡𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)] 𝑑𝑡+ 𝛽(𝑆𝑡, 𝑌𝑡, 𝑡)𝑑̃
𝑊𝑌
𝑡.
2. Backward Kolmogorov Equation – Stochastic Volatility Model. Let {𝑊𝑆
𝑡
: 𝑡≥0} and
{𝑊𝜎
𝑡: 𝑡≥0} be two correlated ℙ-standard Wiener processes on the probability space
(Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a stochastic volatility model with the follow-
ing SDEs
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑆
𝑡
𝑑𝜎𝑡= 𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑𝑊𝜎
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎𝑡is the volatility pro-
cess, 𝛼(𝜎𝑡, 𝑡) and 𝛽(𝜎𝑡, 𝑡) are continuous functions, 𝜌∈(−1, 1) is the correlation parameter,
and let 𝑟be the risk-free interest-rate parameter from the money-market account.
By introducing {𝑍𝑡: 𝑡≥0} as a standard Wiener process, independent of 𝑊𝜎
𝑡, show
that we can write
𝑊𝑆
𝑡
= 𝜌𝑊𝜎
𝑡+
√
1 −𝜌2𝑍𝑡.
Using the two-dimensional Girsanov’s theorem, show that under the risk-neutral measure
ℚ,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
where ̃
𝑊𝑆
𝑡
= 𝜌̃
𝑊𝜎
𝑡+
√
1 −𝜌2 ̃
𝑍𝑡, ̃
𝑊𝜎
𝑡and ̃
𝑍𝑡are ℚ-standard Wiener processes, ̃
𝑊𝜎
𝑡⟂⟂
̃
𝑍𝑡and ̃𝛼(𝜎𝑡, 𝑡) = 𝛼(𝜎𝑡, 𝑡) −𝛾𝑡𝛽(𝜎𝑡, 𝑡) such that 𝛾𝑡is the market price of volatility risk.
Using Taylor’s series, show that for a definite integral of a smooth function 𝑓(𝑥),
∫
𝑏
𝑎
𝑓(𝑢) 𝑑𝑢= 𝑓
(𝑎+ 𝑏
2
)
(𝑏−𝑎) + 𝑂((𝑏−𝑎)3)

714
7.2.3 Stochastic Volatility
and hence show that under the risk-neutral measure ℚ,
𝔼ℚ[𝑆𝑡+Δ𝑡−𝑆𝑡|| ℱ𝑡
] = (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)3)
𝔼ℚ[𝜎𝑡+Δ𝑡−𝜎𝑡|| ℱ𝑡
] = ̃𝛼
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)2||| ℱ𝑡
]
= 𝜎2
𝑡+ 1
2 Δ𝑡𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝜎𝑡+Δ𝑡−𝜎𝑡
)2||| ℱ𝑡
]
= 𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
) (𝜎𝑡+Δ𝑡−𝜎𝑡
)||| ℱ𝑡
]
= 𝜌𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
𝜎𝑡+ 1
2 Δ𝑡𝑆𝑡+ 1
2 Δ𝑡Δ𝑡
+𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)3||| ℱ𝑡
]
= 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)2 (𝜎𝑡+Δ𝑡−𝜎𝑡
)||| ℱ𝑡
]
= 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
) (𝜎𝑡+Δ𝑡−𝜎𝑡
)2||| ℱ𝑡
]
= 𝑂((Δ𝑡)2)
𝔼ℚ[(𝜎𝑡+Δ𝑡−𝜎𝑡
)3||| ℱ𝑡
]
= 𝑂((Δ𝑡)2)
for Δ𝑡> 0.
Let 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) be the transition pdf of the asset price, where the asset price
and volatility are 𝑆𝑡and 𝜎𝑡at time 𝑡, respectively given that the asset price and volatility
are 𝑆𝑇and 𝜎𝑇at time 𝑇> 𝑡, respectively. From the Chapman–Kolmogorov equation for
Δ𝑡> 0,
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡)𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑥𝑑𝑦
show that by expanding 𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) using Taylor series centred on 𝑆𝑡and 𝜎𝑡up to
second order and taking limits Δ𝑡→0, 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) satisfies the backward Kol-
mogorov equation
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + ̃𝛼(𝜎𝑡, 𝑡) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇)𝛿(𝜎𝑡−𝜎𝑇),
∀𝑡.

7.2.3 Stochastic Volatility
715
Note that if {𝑊𝑡: 𝑡≥0} and {𝐵𝑡: 𝑡≥0} are two correlated standard Wiener processes
on the probability space (Ω, ℱ, ℙ) with correlation 𝜌∈(−1, 1), and if 𝑓and 𝑔are simple
processes, then the covariance between the It¯o integrals
𝐼𝑡= ∫
𝑡
0
𝑓(𝑊𝑠, 𝑠) 𝑑𝑊𝑠𝑎𝑛𝑑𝐽𝑡= ∫
𝑡
0
𝑔(𝐵𝑠, 𝑠) 𝑑𝐵𝑠
is
𝔼
[(
∫
𝑡
0
𝑓(𝑊𝑠, 𝑠) 𝑑𝑊𝑠
) (
∫
𝑡
0
𝑔(𝐵𝑠, 𝑠) 𝑑𝐵𝑠
)]
= 𝔼
(
∫
𝑡
0
𝑓(𝑊𝑠, 𝑠)𝑔(𝐵𝑠, 𝑠) 𝑑⟨𝑊, 𝐵⟩𝑠
)
= 𝜌𝔼
(
∫
𝑡
0
𝑓(𝑊𝑠, 𝑠)𝑔(𝐵𝑠, 𝑠) 𝑑𝑠
)
where
⟨𝑊, 𝐵⟩𝑡= lim
𝑛→∞
𝑛−1
∑
𝑖=0
(𝑊𝑡𝑖+1 −𝑊𝑡𝑖)(𝐵𝑡𝑖+1 −𝐵𝑡𝑖)
such that 𝑡𝑖= 𝑖𝑡∕𝑛, 0 = 𝑡0 < 𝑡1 < 𝑡2 < ⋯< 𝑡𝑛−1 < 𝑡𝑛= 𝑡, 𝑛∈ℕ.
Solution: To show that we can set 𝑊𝑆
𝑡
= 𝜌𝑊𝜎
𝑡+
√
1 −𝜌2𝑍𝑡, 𝑍𝑡⟂⟂𝑊𝜎
𝑡, see Problem
7.2.2.1 (page 685).
We define
̃
𝑍𝑡= 𝑍𝑡+ ∫
𝑡
0
𝜆𝑢𝑑𝑢
̃
𝑊𝜎
𝑡= 𝑊𝜎
𝑡+ ∫
𝑡
0
𝛾𝑢𝑑𝑢
where 𝜆𝑡is the market price of asset risk and 𝛾𝑡is the market price of volatility risk. Since
𝑍𝑡⟂⟂𝑊𝜎
𝑡, we can easily deduce that ̃
𝑍𝑡⟂⟂̃
𝑊𝜎
𝑡.
Let the portfolio Π𝑡be defined as
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
where 𝜙𝑡units are invested in risky asset 𝑆𝑡and 𝜓𝑡units are invested in risk-free asset 𝐵𝑡.
Given that the holder of the portfolio will receive 𝐷𝑆𝑡𝑑𝑡for every risky asset held, thus
𝑑Π𝑡= 𝜙𝑡
(
𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡
)
+ 𝜓𝑡𝑑𝐵𝑡
= 𝜙𝑡
(𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
) + 𝜓𝑡
(𝑟𝐵𝑡𝑑𝑡)
= 𝑟Π𝑡𝑑𝑡+ 𝜙𝑡𝑆𝑡
[
(𝜇−𝑟)𝑑𝑡+ 𝜎𝑡
(
𝜌𝑑𝑊𝜎
𝑡+
√
1 −𝜌2𝑑𝑍𝑡
)]
.

716
7.2.3 Stochastic Volatility
By substituting
𝑑𝑊𝜎
𝑡= 𝑑̃
𝑊𝜎
𝑡−𝛾𝑡𝑑𝑡
𝑑𝑍𝑡= 𝑑̃
𝑍𝑡−𝜆𝑡𝑑𝑡
into 𝑑Π𝑡we have
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡
+𝜙𝑡𝑆𝑡
[
(𝜇−𝑟)𝑑𝑡+ 𝜎𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡−𝜌𝛾𝑡𝑑𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡−
√
1 −𝜌2𝜆𝑡𝑑𝑡
)]
= 𝑟Π𝑡𝑑𝑡
+𝜙𝑡𝑆𝑡
[(
𝜇−𝑟−
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝜎𝑡
)
𝑑𝑡+ 𝜎𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)]
.
Since ̃
𝑊𝜎
𝑡and ̃
𝑍𝑡are ℚ-martingales, and in order for the discounted portfolio 𝑒−𝑟𝑡Π𝑡to
be a ℚ-martingale,
𝑑(𝑒−𝑟𝑡Π𝑡) = −𝑟𝑒−𝑟𝑡Π𝑡𝑑𝑡+ 𝑒−𝑟𝑡𝑑Π𝑡
= 𝑒−𝑟𝑡𝜙𝑡𝑆𝑡
[(
𝜇−𝑟−
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝜎𝑡
)
𝑑𝑡
+𝜎𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)]
we set
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡= 𝜇−𝑟
𝜎𝑡
.
Hence, by substituting
𝑑𝑊𝜎
𝑡= 𝑑̃
𝑊𝜎
𝑡−𝛾𝑡𝑑𝑡
𝑑𝑍𝑡= 𝑑̃
𝑍𝑡−𝜆𝑡𝑑𝑡
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡= 𝜇−𝑟
𝜎𝑡
into 𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑𝑊𝜎
𝑡+
√
1 −𝜌2𝑑𝑍𝑡
)
, we have
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡−𝜌𝛾𝑡𝑑𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡−
√
1 −𝜌2𝜆𝑡𝑑𝑡
)
= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
−𝜎𝑡𝑆𝑡
(
𝜌𝛾𝑡+
√
1 −𝜌2𝜆𝑡
)
𝑑𝑡
= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
−𝜎𝑡𝑆𝑡
(𝜇−𝑟
𝜎𝑡
)
𝑑𝑡
= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡.

7.2.3 Stochastic Volatility
717
In contrast, by substituting
𝑑𝑊𝜎
𝑡= 𝑑̃
𝑊𝜎
𝑡−𝛾𝑡𝑑𝑡
into 𝑑𝜎𝑡= 𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑𝑊𝜎
𝑡, the instantaneous volatility under the ℚmeasure
becomes
𝑑𝜎𝑡= 𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)
(
𝑑̃
𝑊𝜎
𝑡−𝛾𝑡𝑑𝑡
)
= (𝛼(𝜎𝑡, 𝑡) −𝛾𝑡𝛽(𝜎𝑡, 𝑡)) 𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
where ̃𝛼(𝜎𝑡, 𝑡) = 𝛼(𝜎𝑡, 𝑡) −𝛾𝑡𝛽(𝜎𝑡, 𝑡).
To show that
∫
𝑏
𝑎
𝑓(𝑢) 𝑑𝑢= 𝑓
(𝑎+ 𝑏
2
)
(𝑏−𝑎) + 𝑂((𝑏−𝑎)3)
for a smooth function 𝑓, see Problem 7.2.2.2 (see page 687).
From
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
𝑑̃
𝑊𝑆
𝑡
⋅𝑑̃
𝑊𝜎
𝑡= 𝜌𝑑𝑡
and taking integrals
∫
𝑡+Δ𝑡
𝑡
𝑑𝑆𝑢= ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
∫
𝑡+Δ𝑡
𝑡
𝑑𝜎𝑢= ∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢
we have
𝑆𝑡+Δ𝑡−𝑆𝑡= ∫
𝑡+Δ𝑡
𝑡
(𝑟−𝐷)𝑆𝑢𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
𝜎𝑡+Δ𝑡−𝜎𝑡= ∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢+ ∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢.
Taking expectations, using the approximate integral formula and It¯o calculus,
𝔼ℚ[𝑆𝑡+Δ𝑡−𝑆𝑡|| ℱ𝑡
] = (𝑟−𝐷) ∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢+ 𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
|||||
ℱ𝑡
]
= (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)3)

718
7.2.3 Stochastic Volatility
𝔼ℚ[𝜎𝑡+Δ𝑡−𝜎𝑡|| ℱ𝑡
] = ∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢+ 𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)𝑑̃
𝑊𝜎
𝑢
|||||
ℱ𝑡
]
= ̃𝛼
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
Δ𝑡+ 𝑂((Δ𝑡)3)
𝔼ℚ[
(𝑆𝑡+Δ𝑡−𝑆𝑡)2||| ℱ𝑡
]
= (𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
|||||
ℱ𝑡
]
+𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
)2||||||
ℱ𝑡
]
= (𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
+ ∫
𝑡+Δ𝑡
𝑡
𝜎2
𝑢𝑆2
𝑢𝑑𝑢
= 𝜎2
𝑡+ 1
2 Δ𝑡𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[
(𝜎𝑡+Δ𝑡−𝜎𝑡)2||| ℱ𝑡
]
=
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)2
+2
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢
|||||
ℱ𝑡
]
+𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢
)2||||||
ℱ𝑡
]
=
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)2
+ ∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)2 𝑑𝑢
= 𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡)(𝜎𝑡+Δ𝑡−𝜎𝑡)|| ℱ𝑡
]
= (𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
+(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢
|||||
ℱ𝑡
]
+
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
|||||
ℱ𝑡
]
+𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑̃
𝑊𝑆
𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑̃
𝑊𝜎
𝑢
)|||||
ℱ𝑡
]
= (𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)

7.2.3 Stochastic Volatility
719
+𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝛽(𝜎𝑢, 𝑢)𝑆𝑢𝑑⟨̃
𝑊𝑆, ̃
𝑊𝜎⟩𝑢
)|||||
ℱ𝑡
]
= (𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
+ 𝜌∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝛽(𝜎𝑢, 𝑢)𝑆𝑢𝑑𝑢
= 𝜌𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
𝜎𝑡+ 1
2 Δ𝑡𝑆𝑡+ 1
2 Δ𝑡Δ𝑡+ 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)3||| ℱ𝑡
]
= (𝑟−𝐷)3
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)3
+3(𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
|||||
ℱ𝑡
]
+3(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝜎2
𝑢𝑆2
𝑢𝑑𝑢
)
+
(
∫
𝑡+Δ𝑡
𝑡
𝜎2
𝑢𝑆2
𝑢𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
|||||
ℱ𝑡
]
= 𝑂((Δ𝑡)2)
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
)2 (𝜎𝑡+Δ𝑡−𝜎𝑡
)||| ℱ𝑡
]
= (𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2 (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
×𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
|||||
ℱ𝑡
]
+
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝜎2
𝑢𝑆2
𝑢𝑑𝑢
)
+(𝑟−𝐷)2
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)2
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
)|||||
ℱ𝑡
]
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
)
×𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
)|||||
ℱ𝑡
]
+
(
∫
𝑡+Δ𝑡
𝑡
𝜎2
𝑢𝑆2
𝑢𝑑𝑢
)
𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
)|||||
ℱ𝑡
]
= 𝑂((Δ𝑡)2)

720
7.2.3 Stochastic Volatility
𝔼ℚ[(𝑆𝑡+Δ𝑡−𝑆𝑡
) (𝜎𝑡+Δ𝑡−𝜎𝑡
)2||| ℱ𝑡
]
= (𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)2
+2(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
×𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
|||||
ℱ𝑡
]
+(𝑟−𝐷)
(
∫
𝑡+Δ𝑡
𝑡
𝑆𝑢𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)2 𝑑𝑢
)
+
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)2
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
|||||
ℱ𝑡
]
+2
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)
×𝔼ℚ
[(
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
)|||||
ℱ𝑡
]
+
(
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)2 𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝜎𝑢𝑆𝑢𝑑𝑊𝑆
𝑢
|||||
ℱ𝑡
]
= 𝑂((Δ𝑡)2)
and
𝔼ℚ[
(𝜎𝑡+Δ𝑡−𝜎𝑡)3||| ℱ𝑡
]
=
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)3
+3
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
)2
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
|||||
ℱ𝑡
]
+3
(
∫
𝑡+Δ𝑡
𝑡
̃𝛼(𝜎𝑢, 𝑢) 𝑑𝑢
) (
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)2 𝑑𝑢
)
+
(
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢)2 𝑑𝑢
)
𝔼ℚ
[
∫
𝑡+Δ𝑡
𝑡
𝛽(𝜎𝑢, 𝑢) 𝑑𝑊𝜎
𝑢
|||||
ℱ𝑡
]
= 𝑂((Δ𝑡)2).
From the Chapman–Kolmogorov equation we have
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) = ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡)𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥

7.2.3 Stochastic Volatility
721
and expanding 𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) using Taylor series centred on 𝑆𝑡and 𝜎𝑡,
𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑥−𝑆𝑡) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑦−𝜎𝑡) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2(𝑥−𝑆𝑡)2 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2(𝑦−𝜎𝑡)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑥−𝑆𝑡)(𝑦−𝜎𝑡)
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+𝑂((𝑥−𝑆𝑡)3) + 𝑂((𝑥−𝑆𝑡)2(𝑦−𝜎𝑡))
+𝑂((𝑥−𝑆𝑡)(𝑦−𝜎𝑡)2) + 𝑂((𝑦−𝜎𝑡)3).
Substituting Taylor’s expansion into the Chapman–Kolmogorov equation yields
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇)
= 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+ 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) ∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+ 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) ∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+1
2
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) ∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+1
2
𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) ∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
× ∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
+𝑂
(
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)3𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
)
+𝑂
(
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)2(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
)
+𝑂
(
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)(𝑦−𝜎𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
)
+𝑂
(
∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)3𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥
)
.

722
7.2.3 Stochastic Volatility
Since
∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 1
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= (𝑟−𝐷)𝑆𝑡+ 1
2 Δ𝑡Δ𝑡
+𝑂((Δ𝑡)3)
∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= ̃𝛼
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
Δ𝑡
+𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝜎2
𝑡+ 1
2 Δ𝑡𝑆2
𝑡+ 1
2 Δ𝑡Δ𝑡
+𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2
Δ𝑡
+𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝜌𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
×𝜎𝑡+ 1
2 Δ𝑡𝑆𝑡+ 1
2 Δ𝑡Δ𝑡
+𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)3𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)2(𝑦−𝜎𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑥−𝑆𝑡)(𝑦−𝜎𝑡)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝑂((Δ𝑡)2)
∫
∞
0
∫
∞
0
(𝑦−𝜎𝑡)3𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑥, 𝑦, 𝑡) 𝑑𝑦𝑑𝑥= 𝑂((Δ𝑡)2)
then by taking limits Δ𝑡→0,
lim
Δ𝑡→0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡−Δ𝑡; 𝑆𝑇, 𝑇) −𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
Δ𝑡
= (𝑟−𝐷) lim
Δ𝑡→0 𝑆𝑡+ 1
2 Δ𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+ lim
Δ𝑡→0 ̃𝛼
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2 lim
Δ𝑡→0 𝜎2
𝑡+ 1
2 Δ𝑡𝑆2
𝑡+ 1
2 Δ𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2 lim
Δ𝑡→0 𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)

7.2.3 Stochastic Volatility
723
+𝜌lim
Δ𝑡→0 𝛽
(
𝜎𝑡+ 1
2 Δ𝑡, 𝑡+ 1
2Δ𝑡
)
𝜎𝑡+ 1
2 Δ𝑡𝑆𝑡+ 1
2 Δ𝑡
𝜕2
𝜕𝑆𝑡𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+ lim
Δ𝑡→0 𝑂(Δ𝑡)
and hence
−𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + ̃𝛼(𝜎𝑡, 𝑡) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
or
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + ̃𝛼(𝜎𝑡, 𝑡) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇)𝛿(𝜎𝑡−𝜎𝑇), ∀𝑡.
3. Black–Scholes Equation – Stochastic Volatility Model. Under the risk-neutral measure ℚ,
let {̃
𝑊𝑆
𝑡
: 𝑡≥0} and {̃
𝑊𝜎
𝑡: 𝑡≥0} be two correlated ℚ-standard Wiener processes on the
probability space (Ω, ℱ, ℚ) with correlation 𝜌∈(−1, 1). Let the asset price 𝑆𝑡under the
ℚmeasure follow a stochastic volatility model with the following dynamics
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
𝑑̃
𝑊𝑆
𝑡
⋅𝑑̃
𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝑟is the risk-free interest-rate parameter from the money-market account, 𝐷is the
continuous dividend yield, 𝜎𝑡is the volatility process, ̃𝛼(𝜎𝑡, 𝑡) and 𝛽(𝜎𝑡, 𝑡) are continuous
functions.
Let 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) be the transition pdf of the asset price, where the asset price
and volatility are 𝑆𝑡and 𝜎𝑡at time 𝑡, respectively, given that the asset price and volatility
are 𝑆𝑇and 𝜎𝑇at time 𝑇> 𝑡, respectively. We consider a European option written on 𝑆𝑡

724
7.2.3 Stochastic Volatility
with strike price 𝐾> 0 expiring at time 𝑇> 𝑡with payoff Ψ(𝑆𝑇), where the option price
at time 𝑡under the risk-neutral measure ℚis
𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑑𝑦𝑑𝑥.
By using the backward Kolmogorov equation, show that 𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) satisfies the
two-dimensional Black–Scholes equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2𝑉
𝜕𝜎2
𝑡
+ 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝜎𝑡𝜕𝑆𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ ̃𝛼(𝜎𝑡, 𝑡)𝜕𝑉
𝜕𝜎𝑡
−𝑟𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑉(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = Ψ(𝑆𝑇).
Solution: Given
𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
by taking first and second-order differentials, we have
𝜕𝑉
𝜕𝑡= 𝑟𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
= 𝑟𝑒−𝑟(𝑇−𝑡)𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇)
+𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
𝜕𝑉
𝜕𝑆𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
𝜕𝑉
𝜕𝜎𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
𝜕2𝑉
𝜕𝑆2
𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
𝜕2𝑉
𝜕𝜎2
𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
𝜕2𝑉
𝜕𝜎𝑡𝜕𝑆𝑡
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
Ψ(𝑥)
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥.

7.2.3 Stochastic Volatility
725
From Problem 7.2.3.2 (page 713), the backward Kolmogorov equation satisfied by the
transition probability 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) is
𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑟−𝐷)𝑆𝑡
𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + ̃𝛼(𝜎𝑡, 𝑡) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 0
with boundary condition
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 𝛿(𝑆𝑡−𝑆𝑇)𝛿(𝜎𝑡−𝜎𝑇)
for all 𝑡.
By multiplying the backward Kolmogorov equation with Ψ(𝑆𝑇) and taking double inte-
grals we have
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝑡𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑑𝑦𝑑𝑥
+1
2𝜎2
𝑡𝑆2
𝑡∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕2
𝜕𝑆2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+1
2𝛽(𝜎𝑡, 𝑡)2
∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕2
𝜕𝜎2
𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡∫
∞
0
∫
∞
0
Ψ(𝑥)
𝜕2
𝜕𝜎𝑡𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+(𝑟−𝐷)𝑆𝑡∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝑆𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+̃𝛼(𝜎𝑡, 𝑡) ∫
∞
0
∫
∞
0
Ψ(𝑥) 𝜕
𝜕𝜎𝑡
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥= 0.
By writing the above equation in terms of 𝜕𝑉
𝜕𝑡, 𝜕𝑉
𝜕𝑆𝑡
, 𝜕𝑉
𝜕𝜎𝑡
, 𝜕2𝑉
𝜕𝑆2
𝑡
, 𝜕2𝑉
𝜕𝜎2
𝑡
and
𝜕2𝑉
𝜕𝜎𝑡𝜕𝑆𝑡
we have
𝑒−𝑟(𝑇−𝑡)
[
𝜕𝑉
𝜕𝑡−𝑟𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2𝑉
𝜕𝜎2
𝑡
+𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝜎𝑡𝜕𝑆𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ ̃𝛼(𝜎𝑡, 𝑡)𝜕𝑉
𝜕𝜎𝑡
]
= 0

726
7.2.3 Stochastic Volatility
or
𝜕𝑉
𝜕𝑡+ 1
2𝜎2
𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝛽(𝜎𝑡, 𝑡)2 𝜕2𝑉
𝜕𝜎2
𝑡
+ 𝜌𝛽(𝜎𝑡, 𝑡)𝜎𝑡𝑆𝑡
𝜕2𝑉
𝜕𝜎𝑡𝜕𝑆𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ ̃𝛼(𝜎𝑡, 𝑡)𝜕𝑉
𝜕𝜎𝑡
−𝑟𝑉(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 0.
Finally, for the boundary condition we note that
𝑉(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = ∫
∞
0
∫
∞
0
Ψ(𝑥)𝑝(𝑆𝑇, 𝜎𝑇, 𝑇; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
and from the definition of the Dirac delta function,
𝑉(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = ∫
∞
0
∫
∞
0
Ψ(𝑥)𝑝(𝑆𝑇, 𝜎𝑇, 𝑇; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
∫
∞
0
Ψ(𝑥)𝛿(𝑆𝑇−𝑥)𝛿(𝜎𝑇−𝑦) 𝑑𝑦𝑑𝑥
= Ψ(𝑆𝑇).
4. Forward Kolmogorov Equation – Stochastic Volatility Model. Let {𝑊𝑆
𝑡
: 𝑡≥0} and
{𝑊𝜎
𝑡: 𝑡≥0} be two correlated ℙ-standard Wiener processes on the probability space
(Ω, ℱ, ℙ) and let the asset price 𝑆𝑡follow a stochastic volatility model with the follow-
ing SDEs
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑆
𝑡
𝑑𝜎𝑡= 𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑𝑊𝜎
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎𝑡is the volatility pro-
cess, 𝛼(𝜎𝑡, 𝑡) and 𝛽(𝜎𝑡, 𝑡) are continuous functions, 𝜌∈(−1, 1) is the correlation parameter,
and let 𝑟be the risk-free interest-rate parameter from the money-market account.
By introducing {𝑍𝑡: 𝑡≥0} as a standard Wiener process, independent of 𝑊𝜎
𝑡, show
that we can write
𝑊𝑆
𝑡
= 𝜌𝑊𝜎
𝑡+
√
1 −𝜌2𝑍𝑡.
Using the two-dimensional Girsanov’s theorem, show that under the risk-neutral measure
ℚ,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
where ̃
𝑊𝑆
𝑡
= 𝜌̃
𝑊𝜎
𝑡+
√
1 −𝜌2 ̃𝑍𝑡, ̃
𝑊𝜎
𝑡and ̃
𝑍𝑡are ℚ-standard Wiener processes, ̃
𝑊𝜎
𝑡⟂⟂
̃
𝑍𝑡and ̃𝛼(𝜎𝑡, 𝑡) = 𝛼(𝜎𝑡, 𝑡) −𝛾𝑡𝛽(𝜎𝑡, 𝑡) such that 𝛾𝑡is the market price of volatility risk.

7.2.3 Stochastic Volatility
727
Let 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) be the transition pdf of the asset price, where the asset price
and volatility are 𝑆𝑡and 𝜎𝑡at time 𝑡, respectively, given that the asset price and volatility
are 𝑆𝑇and 𝜎𝑇at time 𝑇> 𝑡, respectively. From the Chapman–Kolmogorov equation for
Δ𝑇> 0,
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇)
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) 𝑑𝑦𝑑𝑥
show that in the limit Δ𝑇→0,
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝑡; 𝑆𝑇, 𝑇) = −∫
𝑇
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑇𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Finally, using the backward Kolmogorov equation, show that 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) satis-
fies the forward Kolmogorov equation
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎2
𝑇𝑆2
𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−1
2
𝜕2
𝜕𝜎2
𝑇
[𝛽(𝜎𝑇, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−𝜌
𝜕2
𝜕𝜎𝑇𝜕𝑆𝑇
[𝛽(𝜎𝑇, 𝑇)𝜎𝑇𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] +
𝜕
𝜕𝜎𝑇
[̃𝛼(𝜎𝑇, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] = 0
with boundary condition
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 𝛿(𝑆𝑡−𝑆𝑇)𝛿(𝜎𝑡−𝜎𝑇),
∀𝑡.
Solution: To show that under the risk-neutral measure ℚ, the asset price and the volatility
follow the dynamics
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
see Problem 7.2.3.2 (page 713).
From the Chapman–Kolmogorov equation for Δ𝑇> 0,
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇)
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) 𝑑𝑦𝑑𝑥

728
7.2.3 Stochastic Volatility
we can write
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) 𝑑𝑦𝑑𝑥
−𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) 𝑑𝑦𝑑𝑥
−∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) 𝑑𝑦𝑑𝑥
−∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥.
By dividing the expression with Δ𝑇and taking limits Δ𝑇→0,
lim
Δ𝑇→0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
Δ𝑇
= lim
Δ𝑡→0 ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇)
Δ𝑇
𝑑𝑦𝑑𝑥
−lim
Δ𝑇→0 ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇)
Δ𝑇
𝑑𝑦𝑑𝑥
=
lim
Δ𝑇→0 ∫
∞
0
∫
∞
0
{
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
×
[𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇)
Δ𝑇
]}
𝑑𝑦𝑑𝑥
=
lim
Δ𝑇→0 ∫
∞
0
∫
∞
0
{
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
×
[𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝑝(𝑥, 𝑦, 𝑇+ Δ𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇)
Δ𝑇
]}
𝑑𝑦𝑑𝑥.

7.2.3 Stochastic Volatility
729
Since
lim
Δ𝑇→0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
Δ𝑇
= 𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
and
lim
Δ𝑇→0
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇) −𝑝(𝑥, 𝑦, 𝑇+ Δ𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇+ Δ𝑇)
Δ𝑇
= −𝜕
𝜕𝑇𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
thus
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= −∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑇𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
From the backward Kolmogorov equation on 𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) for the stochastic volatil-
ity model
𝜕
𝜕𝑡𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 1
2𝑦2𝑥2 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+1
2𝛽(𝑦, 𝑡)2 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + 𝜌𝛽(𝑦, 𝑡)𝑦𝑥𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
+(𝑟−𝐷)𝑥𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) + ̃𝛼(𝑦, 𝑡) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = 0
we have
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= ∫
∞
0
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
[
(𝑟−𝐷)𝑥𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
+̃𝛼(𝑦, 𝑇) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) + 1
2𝑦2𝑥2 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
+ 1
2𝛽(𝑦, 𝑇)2 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
+𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
]
𝑑𝑦𝑑𝑥

730
7.2.3 Stochastic Volatility
= ∫
∞
0
∫
∞
0
(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Integrating by parts for
∫
∞
0
∫
∞
0
(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
we let
𝑢= (𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and
𝑑𝑣
𝑑𝑥= 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑥= 𝜕
𝜕𝑥
[(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and
𝑣= 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).
Thus, we have
∫
∞
0
∫
∞
0
(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑦
−∫
∞
0
∫
∞
0
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝜕
𝜕𝑥
[(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥
= −∫
∞
0
∫
∞
0
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝜕
𝜕𝑥
[(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥.

7.2.3 Stochastic Volatility
731
For the case of integration by parts for
∫
∞
0
∫
∞
0
̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
we let
𝑢= ̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and
𝑑𝑣
𝑑𝑦= 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑦= 𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and
𝑣= 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).
Hence,
∫
∞
0
∫
∞
0
̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
For the case of
∫
∞
0
∫
∞
0
1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
and solving the integral by parts, we let
𝑢= 1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and
𝑑𝑣
𝑑𝑥= 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑥= 𝜕
𝜕𝑥
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑣= 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).

732
7.2.3 Stochastic Volatility
Hence,
∫
∞
0
∫
∞
0
1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝜕
𝜕𝑥
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑑𝑦𝑑𝑥
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝜕
𝜕𝑥
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑑𝑦𝑑𝑥.
Integrating by parts again, we let
𝑢= 𝜕
𝜕𝑥
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑑𝑣
𝑑𝑥= 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑥= 𝜕2
𝜕𝑥2
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑣= 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).
Thus, we have
∫
∞
0
∫
∞
0
1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑥2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
𝜕
𝜕𝑥
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑦
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑥2
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑥2
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Taking integration by parts of
∫
∞
0
∫
∞
0
1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)𝑑𝑦𝑑𝑥
we let
𝑢= 1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and
𝑑𝑣
𝑑𝑦= 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)

7.2.3 Stochastic Volatility
733
so that
𝑑𝑢
𝑑𝑦= 𝜕
𝜕𝑦
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑣= 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).
Therefore,
∫
∞
0
∫
∞
0
1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
] 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
] 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Integrating by parts again, we let
𝑢= 𝜕
𝜕𝑦
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑑𝑣
𝑑𝑦= 𝜕
𝜕𝑦𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑦= 𝜕2
𝜕𝑦2
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
and
𝑣= 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
and hence
∫
∞
0
∫
∞
0
1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦2 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
𝜕
𝜕𝑦
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)||||
∞
0
𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦2
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦2
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Finally, for
∫
∞
0
∫
∞
0
𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥

734
7.2.3 Stochastic Volatility
we let
𝑢= 𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and
𝑑𝑣
𝑑𝑦=
𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑦= 𝜕
𝜕𝑦
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and
𝑣= 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇).
Therefore,
∫
∞
0
∫
∞
0
𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.
Using integration by parts again, we let
𝑢= 𝜕
𝜕𝑦
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and
𝑑𝑣
𝑑𝑥= 𝜕
𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
so that
𝑑𝑢
𝑑𝑥=
𝜕2
𝜕𝑦𝜕𝑥
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and
𝑣= 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
and therefore,
∫
∞
0
∫
∞
0
𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑦𝜕𝑥𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= −∫
∞
0
𝜕
𝜕𝑦
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇)
||||
∞
0
𝑑𝑦
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦𝜕𝑥
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
= ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦𝜕𝑥
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥.

7.2.3 Stochastic Volatility
735
Thus
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑥
[(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑥2
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦2
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦𝜕𝑥
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑝(𝑥, 𝑦, 𝑇; 𝑆𝑇, 𝜎𝑇, 𝑇) 𝑑𝑦𝑑𝑥
or
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
= −∫
∞
0
∫
∞
0
𝜕
𝜕𝑥
[(𝑟−𝐷)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥
−∫
∞
0
∫
∞
0
𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑥2
[1
2𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦2
[1
2𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
]
𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥
+ ∫
∞
0
∫
∞
0
𝜕2
𝜕𝑦𝜕𝑥
[𝜌𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝛿(𝑥−𝑆𝑇)𝛿(𝑦−𝜎𝑇) 𝑑𝑦𝑑𝑥.
Hence,
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) = −𝜕
𝜕𝑆𝑇
[(𝑟−𝐷)𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−𝜕
𝜕𝜎𝑇
[̃𝛼(𝜎𝑇, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
+ 𝜕2
𝜕𝑆2
𝑇
[1
2𝜎2
𝑇𝑆2
𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
]
+ 𝜕2
𝜕𝜎2
𝑇
[1
2𝛽(𝜎𝑇, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)
]
+
𝜕2
𝜕𝜎𝑇𝜕𝑆𝑇
[𝜌𝛽(𝜎𝑇, 𝑇)𝜎𝑇𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]

736
7.2.3 Stochastic Volatility
and rearranging terms we have the forward Kolmogorov equation for the stochastic volatil-
ity model
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎2
𝑇𝑆2
𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−1
2
𝜕2
𝜕𝜎2
𝑇
[𝛽(𝜎𝑇, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−𝜌
𝜕2
𝜕𝜎𝑇𝜕𝑆𝑇
[𝛽(𝜎𝑇, 𝑇)𝜎𝑇𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] +
𝜕
𝜕𝜎𝑇
[̃𝛼(𝜎𝑇, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] = 0
with boundary condition
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑡) = 𝛿(𝑆𝑡−𝑆𝑇)𝛿(𝜎𝑡−𝜎𝑇)
for all 𝑡.
5. Under the risk-neutral measure ℚ, let {̃
𝑊𝑆
𝑡
: 𝑡≥0} and {̃
𝑊𝜎
𝑡: 𝑡≥0} be two corre-
lated ℚ-standard Wiener processes on the probability space (Ω, ℱ, ℚ) with correlation
𝜌∈(−1, 1). Let the asset price 𝑆𝑡under the ℚmeasure follow a stochastic volatility model
with the following dynamics
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎𝑡= ̃𝛼(𝜎𝑡, 𝑡)𝑑𝑡+ 𝛽(𝜎𝑡, 𝑡)𝑑̃
𝑊𝜎
𝑡
𝑑̃
𝑊𝑆
𝑡
⋅𝑑̃
𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝑟is the risk-free interest-rate parameter from the money-market account, 𝐷is the
continuous dividend yield, 𝜎𝑡is the volatility process, ̃𝛼(𝜎𝑡, 𝑡) and 𝛽(𝜎𝑡, 𝑡) are continuous
functions.
Let 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) be the transition pdf of the asset price, where the asset price
and volatility are 𝑆𝑡and 𝜎𝑡at time 𝑡, respectively, given that the asset price and volatility
are 𝑆𝑇and 𝜎𝑇at time 𝑇> 𝑡, respectively. We consider a European call option written on
𝑆𝑡with strike price 𝐾> 0 expiring at time 𝑇> 𝑡with payoff Ψ(𝑆𝑇) = max{𝑆𝑇−𝐾, 0}
where, under the risk-neutral measure ℚ, the option price at time 𝑡is
𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
max{𝑥−𝐾, 0}𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥.

7.2.3 Stochastic Volatility
737
Show that the following identities are true
𝑥𝜕
𝜕𝐾(𝑥−𝐾) = 𝐾𝜕
𝜕𝐾(𝑥−𝐾) −(𝑥−𝐾)
𝜕
𝜕𝑥(𝑥−𝐾) = −𝜕
𝜕𝐾(𝑥−𝐾)
𝜕2
𝜕𝑧2 (𝑧−𝐾) =
𝜕2
𝜕𝐾2 (𝑧−𝐾).
By using the forward Kolmogorov equation and the above identities or otherwise, show
that 𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) satisfies
𝜕𝐶
𝜕𝑇−1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡
]
𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
Explain the significance of this equation.
Deduce that for a European put option price 𝑃(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) written on 𝑆𝑡at time 𝑡
with payoff Ψ(𝑆𝑇) = max{𝐾−𝑆𝑇, 0} expiring at time 𝑇> 𝑡, 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) satisfies
𝜕𝑃
𝜕𝑇−1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡
]
𝐾2 𝜕2𝑃
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝑃
𝜕𝐾+ 𝐷𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑃(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}.
Under what condition do both the stochastic volatility and local volatility models price
European options equally?
Solution: For the proof of the three identities, see Problem 7.2.2.5 (page 699).
By definition,
𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
0
max{𝑥−𝐾, 0}𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥.

738
7.2.3 Stochastic Volatility
Differentiating 𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) with respect to 𝑇and from the forward Kolmogorov equa-
tion for the stochastic volatility model
𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇) −1
2
𝜕2
𝜕𝑆2
𝑇
[𝜎2
𝑇𝑆2
𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−1
2
𝜕2
𝜕𝜎2
𝑇
[𝛽(𝜎𝑇, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
−𝜌
𝜕2
𝜕𝜎𝑇𝜕𝑆𝑇
[𝛽(𝜎𝑇, 𝑇)𝜎𝑇𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)]
+(𝑟−𝐷) 𝜕
𝜕𝑆𝑇
[𝑆𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] +
𝜕
𝜕𝜎𝑇
[̃𝛼(𝜎𝑇, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇, 𝜎𝑇, 𝑇)] = 0
we have
𝜕𝐶
𝜕𝑇= −𝑟𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
+𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕
𝜕𝑇𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑦𝑑𝑥
= −𝑟𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇)
+1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥
+1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕2
𝜕𝑦2
[𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥
+𝜌𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕2
𝜕𝑦𝜕𝑥
[𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥
−(𝑟−𝐷)𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥
−𝑒−𝑟(𝑇−𝑡)
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥.
Given that the payoff does not depend on 𝜎𝑇, using integration by parts, all partial deriva-
tives with respect to 𝜎𝑇will vanish. Hence,
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕2
𝜕𝑦2
[𝛽(𝑦, 𝑇)2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥= 0
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕2
𝜕𝑦𝜕𝑥
[𝛽(𝑦, 𝑇)𝑦𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥= 0
∫
∞
𝐾
∫
∞
0
(𝑥−𝐾) 𝜕
𝜕𝑦
[̃𝛼(𝑦, 𝑇)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑦𝑑𝑥= 0

7.2.3 Stochastic Volatility
739
and we can rewrite the equation as
𝜕𝐶
𝜕𝑇= −𝑟𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇)
+1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
−(𝑟−𝐷)𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦.
Integrating by parts for the inner integral
∫
∞
𝐾
(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
we let
𝑢= (𝑥−𝐾)
and
𝑑𝑣
𝑑𝑥= 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
so that
𝑑𝑢
𝑑𝑥= 𝜕
𝜕𝑥(𝑥−𝐾) = −𝜕
𝜕𝐾(𝑥−𝐾)
and
𝑣= 𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇).
Therefore,
∫
∞
𝐾
(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
= (𝑥−𝐾)𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)||
∞
𝐾+ ∫
∞
𝐾
𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝐾(𝑥−𝐾) 𝑑𝑥
= ∫
∞
𝐾
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)𝑧𝜕
𝜕𝐾(𝑥−𝐾) 𝑑𝑥
= ∫
∞
𝐾
[
𝐾𝜕
𝜕𝐾(𝑥−𝐾) −(𝑥−𝐾)
]
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑥
= 𝐾∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
−∫
∞
𝐾
(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑥

740
7.2.3 Stochastic Volatility
and hence,
𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑥𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
= 𝐾𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
−𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑥𝑑𝑦
= 𝐾𝜕𝐶
𝜕𝐾−𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇).
For the case of the inner integral
∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑧2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
we let
𝑢= (𝑥−𝐾)
and
𝑑𝑣
𝑑𝑥= 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
so that
𝑑𝑢
𝑑𝑥= 𝜕
𝜕𝑥(𝑥−𝐾)
and
𝑣= 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]
and therefore
∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
= (𝑥−𝐾) 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]||||
∞
𝐾
−∫
∞
𝐾
𝜕
𝜕𝑥(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
= −∫
∞
𝐾
𝜕
𝜕𝑥(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥.
To integrate
−∫
∞
𝐾
𝜕
𝜕𝑥(𝑥−𝐾) 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
we set
𝑢= 𝜕
𝜕𝑥(𝑥−𝐾)
and
𝑑𝑣
𝑑𝑥= 𝜕
𝜕𝑥
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)]

7.2.3 Stochastic Volatility
741
so that
𝑑𝑢
𝑑𝑥= 𝜕2
𝜕𝑥2 (𝑥−𝐾)
and
𝑣= 𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)
and hence
−∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥
= −𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕
𝜕𝑥(𝑥−𝐾)||||
∞
𝐾
+ ∫
∞
𝐾
𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝑥2 (𝑥−𝐾) 𝑑𝑥
= 𝑦2𝐾2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) + ∫
∞
𝐾
𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝜕2
𝜕𝐾2 (𝑥−𝐾) 𝑑𝑥
= 𝑦2𝐾2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇)
since 𝜕
𝜕𝑥(𝑥−𝐾) = 1 and 𝜕2
𝜕𝑥2 (𝑥−𝐾) =
𝜕2
𝜕𝐾2 (𝑥−𝐾) = 0.
Therefore,
1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
= 1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
0
𝑦2𝐾2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) 𝑑𝑦
= 1
2𝐾2
[
𝑒−𝑟(𝑇−𝑡)
∫
∞
0
𝑦2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) 𝑑𝑦
]
.
Given that
𝜕2𝐶
𝜕𝐾2 =
𝜕
𝜕𝐾
( 𝜕𝐶
𝜕𝐾
)
=
𝜕
𝜕𝐾
[
𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
𝜕
𝜕𝐾
[(𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
]
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
[
−𝑝(𝑆𝑡, 𝑡; 𝐾, 𝑇) 𝜕
𝜕𝐾(𝑥−𝐾)
+ ∫
∞
𝐾
𝜕2
𝜕𝐾2 (𝑥−𝐾)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇) 𝑑𝑥
]
𝑑𝑦
= 𝑒−𝑟(𝑇−𝑡)
∫
∞
0
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) 𝑑𝑦
= 𝑒−𝑟(𝑇−𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇= 𝐾, 𝑇)

742
7.2.3 Stochastic Volatility
and from the identity
𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) = 𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇= 𝐾, 𝑇)𝑝(𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡; 𝑦)
we have
1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
0
∫
∞
𝐾
(𝑥−𝐾) 𝜕2
𝜕𝑥2
[𝑦2𝑥2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑥, 𝑦, 𝑇)] 𝑑𝑥𝑑𝑦
= 1
2𝑒−𝑟(𝑇−𝑡)
∫
∞
0
𝑦2𝐾2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) 𝑑𝑦
= 1
2𝐾2
[
𝑒−𝑟(𝑇−𝑡)
∫
∞
0
𝑦2𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑦, 𝑇) 𝑑𝑦
]
= 1
2𝐾2
[
𝑒−𝑟(𝑇−𝑡)𝑝(𝑆𝑡, 𝜎𝑡, 𝑡; 𝑆𝑇= 𝐾, 𝑇) ∫
∞
0
𝑦2𝑝(𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡; 𝑦) 𝑑𝑦
]
= 1
2𝐾2 𝜕2𝐶
𝜕𝐾2 ∫
∞
0
𝑦2𝑝(𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡; 𝑦) 𝑑𝑦
= 1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
𝐾2 𝜕2𝐶
𝜕𝐾2 .
Thus,
𝜕𝐶
𝜕𝑇= −𝑟𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) + 1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
𝐾2 𝜕2𝐶
𝜕𝐾2
−(𝑟−𝐷)
[
𝐾𝜕𝐶
𝜕𝐾−𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇)
]
or
𝜕𝐶
𝜕𝑇−1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
From the PDE expression, we can write
𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
=
2
(𝜕𝐶
𝜕𝑇+ (𝑟−𝐷)𝐾𝜕𝐶
𝜕𝐾+ 𝐷𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇)
)
𝐾2 𝜕2𝐶
𝜕𝐾2

7.2.3 Stochastic Volatility
743
such that given the market prices of call options written on 𝑆𝑡with arbitrary strikes 𝐾and
expiries 𝑇, the expected volatility at time 𝑇can be extracted given that the asset price is
𝑆𝑇= 𝐾at time 𝑇.
From the put–call parity
𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑃(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)
we have
𝜕𝐶
𝜕𝑇= 𝜕𝑃
𝜕𝑇−𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝑟𝐾𝑒−𝑟(𝑇−𝑡)
𝜕𝐶
𝜕𝐾= 𝜕𝑃
𝜕𝐾−𝑒−𝑟(𝑇−𝑡)
𝜕2𝐶
𝜕𝐾2 = 𝜕2𝑃
𝜕𝐾2 .
Substituting the above information into the PDE for 𝐶(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇),
𝜕𝑃
𝜕𝑇−𝐷𝑆𝑡𝑒−𝐷(𝑇−𝑡) + 𝑟𝐾𝑒−𝑟(𝑇−𝑡) −1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
] 𝜕2𝑃
𝜕𝐾2
+(𝑟−𝐷)𝐾
[ 𝜕𝑃
𝜕𝐾−𝑒−𝑟(𝑇−𝑡)]
+ 𝐷[𝑃(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) + 𝑆𝑡𝑒−𝐷(𝑇−𝑡) −𝐾𝑒−𝑟(𝑇−𝑡)] = 0
or
𝜕𝑃
𝜕𝑇−1
2𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
𝐾2 𝜕2𝑃
𝜕𝐾2 + (𝑟−𝐷)𝐾𝜕𝑃
𝜕𝐾+ 𝐷𝑃(𝑆𝑡, 𝜎𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝑃(𝑆𝑇, 𝜎𝑇, 𝑇; 𝐾, 𝑇) = max{𝐾−𝑆𝑇, 0}.
Take note that if the volatility is a function of asset price and time, then
𝔼ℚ[
𝜎2
𝑇
||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
= 𝔼ℚ[
𝜎(𝑆𝑇, 𝑇)2||| 𝑆𝑇= 𝐾, 𝑆𝑡, 𝜎𝑡, 𝑡
]
= 𝜎(𝐾, 𝑇)2
and the PDE becomes the Dupire equation. Thus, a local volatility model and stochastic
volatility model will price a European option equally provided the above relationship is
satisfied.
6. Hull–White Model. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝜎
𝑡: 𝑡≥0} be two independent standard
Wiener processes on the probability space (Ω, ℱ, ℙ). Suppose the asset price 𝑆𝑡and its

744
7.2.3 Stochastic Volatility
instantaneous variance 𝜎2
𝑡have the following diffusion processes
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝜎2
𝑡= 𝛼𝜎2
𝑡𝑑𝑡+ 𝜉𝜎2
𝑡𝑑𝑊𝜎
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝜇, 𝐷, 𝛼and 𝜉are constants. In addition, let 𝐵𝑡be the risk-free asset with the differ-
ential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟is the risk-free interest rate.
By using the two-dimensional Girsanov’s theorem, show that under the risk-neutral mea-
sure ℚ,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎2
𝑡= (𝛼−𝜉𝛾)𝜎2
𝑡𝑑𝑡+ 𝜉𝜎2
𝑡𝑑̃
𝑊𝜎
𝑡
where ̃
𝑊𝑆
𝑡
and ̃
𝑊𝜎
𝑡
are ℚ-standard Wiener processes, ̃
𝑊𝑆
𝑡
⟂⟂̃
𝑊𝜎
𝑡
and 𝛾is the market
price of volatility risk.
Is the market arbitrage free and complete under the ℚmeasure?
By letting ̃𝛼= 𝛼−𝜉𝛾, and conditional on ℱ𝑡and {𝜎𝑢: 𝑡≤𝑢≤𝑇}, show that under the
risk-neutral measure ℚ
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
∼
[(
𝑟−𝐷−1
2𝜎2
RMS(𝑡, 𝑇)
)
(𝑇−𝑡), 𝜎2
RMS(𝑡, 𝑇)(𝑇−𝑡)
]
and conditional on ℱ𝑡show that under the risk-neutral measure ℚ
log
(
𝜎2
𝑇
𝜎2
𝑡
)||||||
ℱ𝑡∼
[(
̃𝛼−1
2𝜉2)
(𝑇−𝑡), 𝜉2(𝑇−𝑡)
]
where
𝜎2
RMS(𝑡, 𝑇) =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
is known as the mean variance over the time interval [𝑡, 𝑇].
Show that
𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
=
𝜎2
𝑡
̃𝛼(𝑇−𝑡)
(
𝑒̃𝛼(𝑇−𝑡) −1
)

7.2.3 Stochastic Volatility
745
and
Varℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
=
𝜎2
𝑡
(𝑇−𝑡)2
⎡
⎢
⎢⎣
2𝑒(2̃𝛼+𝜉2)(𝑇−𝑡)
(̃𝛼+ 𝜉2)(2̃𝛼+ 𝜉2)
+ 2
̃𝛼
(
1
2̃𝛼+ 𝜉2 −𝑒̃𝛼(𝑇−𝑡)
̃𝛼+ 𝜉2
)
−
(𝑒̃𝛼(𝑇−𝑡) −1)2
̃𝛼2
⎤
⎥
⎥⎦
.
We consider a European option price 𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) at time 𝑡written on 𝑆𝑡with expiry
time 𝑇> 𝑡, strike price 𝐾, continuous dividend yield 𝐷and instantaneous variance 𝜎2
𝑡,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
where the payoff
Ψ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝐾, 0}
for call option
max {𝐾−𝑆𝑇, 0}
for put option.
Using the tower property, show that the price of a European option at time 𝑡is
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ[
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)||| ℱ𝑡
]
where 𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) denotes the Black–Scholes formula for a European
option at time 𝑡with spot price 𝑆𝑡, strike price 𝐾, time-dependent (or term-structure) vari-
ance 𝜎2
RMS(𝑡, 𝑇) and option expiry time 𝑇> 𝑡.
By expanding 𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) about its expected value
𝜎2
RMS(𝑡, 𝑇) = 𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
up to second order, show that the option price can be approximated by
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) ≈𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)
+
1
4𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2
× (𝑑RMS
+
𝑑RMS
−
−1) Varℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
where
𝑑RMS
±
=
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2
RMS(𝑡, 𝑇))(𝑇−𝑡)
𝜎RMS(𝑡, 𝑇)
√
𝑇−𝑡
.

746
7.2.3 Stochastic Volatility
Solution: We first define
̃
𝑊𝑆
𝑡
= 𝑊𝑆
𝑡
+ ∫
𝑡
0
𝜆𝑢𝑑𝑢
̃
𝑊𝜎
𝑡= 𝑊𝜎
𝑡+ ∫
𝑡
0
𝛾𝑢𝑑𝑢
where 𝜆𝑡is the market price of asset risk and 𝛾𝑡is the market price of volatility risk. Since
𝑊𝑆
𝑡
⟂⟂𝑊𝜎
𝑡, we can deduce ̃
𝑊𝑆
𝑡
⟂⟂̃
𝑊𝜎
𝑡.
Let the portfolio Π𝑡be defined as
Π𝑡= 𝜙𝑡𝑆𝑡+ 𝜓𝑡𝐵𝑡
where 𝜙𝑡units are invested in risky asset 𝑆𝑡and 𝜓𝑡units are invested in risk-free asset 𝐵𝑡.
Given that the holder of the portfolio will receive 𝐷𝑆𝑡𝑑𝑡for every risky asset held,
𝑑Π𝑡= 𝜙𝑡
(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡) + 𝜓𝑡𝑑𝐵𝑡
= 𝜙𝑡
(𝜇𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
) + 𝜓𝑡
(𝑟𝐵𝑡𝑑𝑡)
= 𝑟Π𝑡𝑑𝑡+ 𝜓𝑡𝑆𝑡
[(𝜇−𝑟)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑆
𝑡
] .
Substituting
𝑑𝑊𝑆
𝑡
= 𝑑̃
𝑊𝑆
𝑡
−𝜆𝑡𝑑𝑡
𝑑𝑊𝜎
𝑡= 𝑑̃
𝑊𝜎
𝑡−𝛾𝑡𝑑𝑡
into 𝑑Π𝑡we have
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡+ 𝜓𝑡𝑆𝑡
[
(𝜇−𝑟)𝑑𝑡+ 𝜎𝑡
(
𝑑̃
𝑊𝑆
𝑡
−𝜆𝑡𝑑𝑡
)]
= 𝑟Π𝑡𝑑𝑡+ 𝜓𝑡𝑆𝑡
[(𝜇−𝑟−𝜆𝑡𝜎𝑡
) 𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑆
𝑡
]
.
Since ̃
𝑊𝑆
𝑡
is a ℚ-martingale, and in order for the discounted portfolio 𝑒−𝑟𝑡Π𝑡to be a ℚ-
martingale,
𝑑(𝑒−𝑟𝑡Π𝑡) = −𝑟𝑒−𝑟𝑡Π𝑡𝑑𝑡+ 𝑒−𝑟𝑡𝑑Π𝑡
= 𝑒−𝑟𝑡𝜓𝑡𝑆𝑡
[(𝜇−𝑟−𝜆𝑡𝜎𝑡
) 𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑆
𝑡
]
we set
𝜆𝑡= 𝜇−𝑟
𝜎𝑡
.

7.2.3 Stochastic Volatility
747
Hence, by substituting
𝑑𝑊𝑆
𝑡
= 𝑑̃
𝑊𝑆
𝑡
−𝜆𝑡𝑑𝑡
into 𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡, the asset price dynamics under the ℚmeasure
becomes
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝑑̃
𝑊𝑆
𝑡
−𝜆𝑡𝑑𝑡
)
= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝑑̃
𝑊𝑆
𝑡
−
(𝜇−𝑟
𝜎𝑡
)
𝑑𝑡
)
or
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡.
As for the case of the instantaneous variance, given that 𝜎2
𝑡is not a traded security, we can
set
𝛾𝑡= 𝛾
where 𝛾is a constant. By substituting
𝑑𝑊𝜎
𝑡= 𝑑̃
𝑊𝜎
𝑡−𝛾𝑑𝑡
into 𝑑𝜎2
𝑡= 𝛼𝜎2
𝑡𝑑𝑡+ 𝜉𝜎2
𝑡𝑑𝑊𝜎
𝑡, the instantaneous variance under the ℚmeasure is
𝑑𝜎2
𝑡= 𝛼𝜎2
𝑡𝑑𝑡+ 𝜉𝜎2
𝑡
(
𝑑̃
𝑊𝜎
𝑡−𝛾𝑑𝑡
)
or
𝑑𝜎2
𝑡= (𝛼−𝜉𝛾) 𝜎2
𝑡𝑑𝑡+ 𝜉𝜎2
𝑡𝑑̃
𝑊𝜎
𝑡.
The market is arbitrage free since we can construct a risk-neutral measure ℚon the filtra-
tion ℱ𝑠, 0 ≤𝑠≤𝑡. However, the market is not complete as ℚis not unique, since 𝜎2
𝑡is not
a traded security.
Expanding 𝑑log 𝑆𝑡and applying It¯o’s lemma,
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑆
𝑡
−1
2𝜎2
𝑡𝑑𝑡
=
(
𝑟−𝐷−1
2𝜎2
𝑡
)
𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑆
𝑡.

748
7.2.3 Stochastic Volatility
Taking integrals,
∫
𝑇
𝑡
𝑑log 𝑆𝑢= ∫
𝑇
𝑡
(
𝑟−𝐷−1
2𝜎2
𝑢
)
𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑆
𝑢
log
(𝑆𝑇
𝑆𝑡
)
=
(
𝑟−𝐷−1
2𝜎2
RMS(𝑡, 𝑇)
)
(𝑇−𝑡) + ∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑆
𝑢
where
𝜎2
RMS(𝑡, 𝑇) =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢.
From the properties of the It¯o integral,
𝔼ℚ
[
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]
=
(
𝑟−𝐷−1
2𝜎2
RMS(𝑡, 𝑇)
)
(𝑇−𝑡)
and
Varℚ
[
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]
= Varℚ
[
∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑆
𝑢
|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]
= 𝔼ℚ
[(
∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑆
𝑢
)2||||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]
−
{
𝔼ℚ
[
∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑆
𝑢
|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]}2
= 𝔼ℚ
[
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]
= 𝜎2
RMS(𝑡, 𝑇)(𝑇−𝑡).
Thus, conditional on ℱ𝑡and {𝜎𝑢: 𝑡≤𝑢≤𝑇}, we can easily deduce that
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
∼
[(
𝑟−𝐷−1
2𝜎2
𝑅𝑀𝑆
)
(𝑇−𝑡), 𝜎2
𝑅𝑀𝑆(𝑇−𝑡)
]
.

7.2.3 Stochastic Volatility
749
In contrast, by expanding 𝑑log 𝜎2
𝑡and applying It¯o’s lemma,
𝑑log 𝜎2
𝑡=
𝑑𝜎2
𝑡
𝜎2
𝑡
−1
2
(
𝑑𝜎2
𝑡
𝜎2
𝑡
)2
+ …
= ̃𝛼𝑑𝑡+ 𝜉𝑑̃
𝑊𝜎
𝑡−1
2𝜉2𝑑𝑡
=
(
̃𝛼−1
2𝜉2)
𝑑𝑡+ 𝜉𝑑̃
𝑊𝜎
𝑡
and taking integrals,
∫
𝑇
𝑡
𝑑log 𝜎2
𝑢= ∫
𝑇
𝑡
(
̃𝛼−1
2𝜉2)
𝑑𝑢+ ∫
𝑇
𝑡
𝜉𝑑̃
𝑊𝜎
𝑢
log
(
𝜎2
𝑇
𝜎2
𝑡
)
=
(
̃𝛼−1
2𝜉2)
(𝑇−𝑡) + 𝜉̃
𝑊𝜎
𝑇−𝑡.
Thus, using It¯o integral properties,
log
(
𝜎2
𝑇
𝜎2
𝑡
)||||||
ℱ𝑡∼
[(
̃𝛼−1
2𝜉2)
(𝑇−𝑡), 𝜉2(𝑇−𝑡)
]
.
To find 𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
we note that
𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
= 𝔼ℚ
[
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
|||||
ℱ𝑡
]
=
1
𝑇−𝑡∫
𝑇
𝑡
𝔼ℚ[
𝜎2
𝑢
||| ℱ𝑡
]
𝑑𝑢
=
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑡𝑒̃𝛼(𝑢−𝑡)𝑑𝑢
=
𝜎2
𝑡
̃𝛼(𝑇−𝑡)
(
𝑒̃𝛼(𝑇−𝑡) −1
)
.
For the case of Varℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
, we first note
𝔼ℚ[
𝜎4
RMS(𝑡, 𝑇)||| ℱ𝑡
]
= 𝔼ℚ
[
1
(𝑇−𝑡)2
(
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
) (
∫
𝑇
𝑡
𝜎2
𝑣𝑑𝑣
)|||||
ℱ𝑡
]
=
1
(𝑇−𝑡)2 ∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑇
𝑣=𝑡
𝔼ℚ[
𝜎2
𝑢𝜎2
𝑣
||| ℱ𝑡
]
𝑑𝑣𝑑𝑢.

750
7.2.3 Stochastic Volatility
Since
𝜎2
𝑢= 𝜎2
𝑡𝑒(̃𝛼−1
2 𝜉2)(𝑢−𝑡)+𝜉̃
𝑊𝜎
𝑢−𝑡
and
𝜎2
𝑣= 𝜎2
𝑡𝑒(̃𝛼−1
2 𝜉2)(𝑣−𝑡)+𝜉̃
𝑊𝜎
𝑣−𝑡
we have
𝜎2
𝑢𝜎2
𝑣= 𝜎4
𝑡𝑒(̃𝛼−1
2 𝜉2)(𝑢+𝑣−2𝑡)+𝜉(̃
𝑊𝜎
𝑢−𝑡+̃
𝑊𝜎
𝑣−𝑡)
where
̃
𝑊𝜎
𝑢−𝑡+ ̃
𝑊𝜎
𝑣−𝑡∼(0, 𝑢+ 𝑣−2𝑡+ 2 min{𝑢−𝑡, 𝑣−𝑡})
since
Cov
(
̃
𝑊𝜎
𝑢−𝑡, ̃
𝑊𝜎
𝑣−𝑡
)
= min{𝑢−𝑡, 𝑣−𝑡}.
Thus,
𝔼ℚ[
𝜎4
RMS(𝑡, 𝑇)||| ℱ𝑡
]
=
𝜎2
𝑡𝑒−2̃𝛼𝑡
(𝑇−𝑡)2 ∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑇
𝑣=𝑡
𝑒̃𝛼(𝑢+𝑣)+𝜉2 min{𝑢−𝑡,𝑣−𝑡} 𝑑𝑣𝑑𝑢
=
𝜎2
𝑡𝑒−2̃𝛼𝑡
(𝑇−𝑡)2 ∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑢
𝑣=𝑡
𝑒̃𝛼(𝑢+𝑣)+𝜉2(𝑣−𝑡) 𝑑𝑣𝑑𝑢
+
𝜎2
𝑡𝑒−2̃𝛼𝑡
(𝑇−𝑡)2 ∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑇
𝑣=𝑢
𝑒̃𝛼(𝑢+𝑣)+𝜉2(𝑢−𝑡) 𝑑𝑣𝑑𝑢
=
𝜎2
𝑡𝑒−(2̃𝛼+𝜉2)𝑡
(𝑇−𝑡)2
∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑢
𝑣=𝑡
𝑒(̃𝛼+𝜉2)𝑣+̃𝛼𝑢𝑑𝑣𝑑𝑢
+
𝜎2
𝑡𝑒−(2̃𝛼+𝜉2)𝑡
(𝑇−𝑡)2
∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑇
𝑣=𝑢
𝑒(̃𝛼+𝜉2)𝑢+̃𝛼𝑣𝑑𝑣𝑑𝑢.
Since
∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑢
𝑣=𝑡
𝑒(̃𝛼+𝜉2)𝑣+̃𝛼𝑢𝑑𝑣𝑑𝑢=
𝑒(2̃𝛼+𝜉2)𝑇
(̃𝛼+ 𝜉2)(2̃𝛼+ 𝜉2) −𝑒̃𝛼𝑇𝑒(̃𝛼+𝜉2)𝑡
̃𝛼(̃𝛼+ 𝜉2)
−
𝑒(2̃𝛼+𝜉2)𝑡
(̃𝛼+ 𝜉2)(2̃𝛼+ 𝜉2) + 𝑒(2̃𝛼+𝜉2)𝑡
̃𝛼(̃𝛼+ 𝜉2)
∫
𝑢=𝑇
𝑢=𝑡
∫
𝑣=𝑇
𝑣=𝑢
𝑒(̃𝛼+𝜉2)𝑢+̃𝛼𝑣𝑑𝑣𝑑𝑢= 𝑒(2̃𝛼+𝜉2)𝑇
̃𝛼(̃𝛼+ 𝜉2) −𝑒(2̃𝛼+𝜉2)𝑇
̃𝛼(2̃𝛼+ 𝜉2) −𝑒̃𝛼𝑇𝑒(̃𝛼+𝜉2)𝑡
̃𝛼(̃𝛼+ 𝜉2)
+ 𝑒(2̃𝛼+𝜉2)𝑡
̃𝛼(2̃𝛼+ 𝜉2)

7.2.3 Stochastic Volatility
751
and after some algebraic manipulations, we eventually arrive at
𝔼ℚ[
𝜎4
RMS(𝑡, 𝑇)||| ℱ𝑡
]
=
𝜎2
𝑡
(𝑇−𝑡)2
[
2𝑒(2̃𝛼+𝜉2)(𝑇−𝑡)
(̃𝛼+ 𝜉2)(2̃𝛼+ 𝜉2)
+ 2
̃𝛼
(
1
2̃𝛼+ 𝜉2 −𝑒̃𝛼(𝑇−𝑡)
̃𝛼+ 𝜉2
)]
.
Thus,
Varℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
= 𝔼ℚ[
𝜎4
RMS(𝑡, 𝑇)||| ℱ𝑡
]
−
{
𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]}2
=
𝜎2
𝑡
(𝑇−𝑡)2
⎡
⎢
⎢⎣
2𝑒(2̃𝛼+𝜉2)(𝑇−𝑡)
(̃𝛼+ 𝜉2)(2̃𝛼+ 𝜉2)
+ 2
̃𝛼
(
1
2̃𝛼+ 𝜉2 −𝑒̃𝛼(𝑇−𝑡)
̃𝛼+ 𝜉2
)
−
(𝑒̃𝛼(𝑇−𝑡) −1)2
̃𝛼2
⎤
⎥
⎥⎦
.
Conditional on ℱ𝑡and {𝜎𝑢: 𝑡≤𝑢≤𝑇}, 𝑆𝑇is log normal with initial value 𝑆𝑡and from
the tower property,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝔼ℚ[𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}]||| ℱ𝑡
]
= 𝔼ℚ[
𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)||| ℱ𝑡
]
where the inner expectation is the Black–Scholes formula with initial value 𝑆𝑡and time-
dependent (or term-structure) variance 𝜎2
RMS(𝑡, 𝑇) =
1
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢. Thus, the option
price under stochastic volatility is the average value over all possible volatility paths.
By expanding 𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) about its expected value
𝜎2
RMS(𝑡, 𝑇) = 𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
up to second order,
𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)
≈𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)
+
𝜕𝑉𝑏𝑠
𝜕(𝜎2
RMS(𝑡, 𝑇))
|||||𝜎2
RMS(𝑡,𝑇)=𝜎2
RMS(𝑡,𝑇)
(
𝜎2
RMS(𝑡, 𝑇) −𝜎2
RMS(𝑡, 𝑇)
)
+
𝜕2𝑉𝑏𝑠
𝜕(𝜎2
RMS(𝑡, 𝑇))2
|||||𝜎2
RMS(𝑡,𝑇)=𝜎2
RMS(𝑡,𝑇)
(
𝜎2
RMS(𝑡, 𝑇) −𝜎2
RMS(𝑡, 𝑇)
)2
.

752
7.2.3 Stochastic Volatility
From Problems 2.2.2.6 (page 105) and 2.2.4.7 (page 226), we have
𝜕𝑉
𝜕𝜎=
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
𝜕2𝑉
𝜕𝜎2 =
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ 𝑑+𝑑−
𝜎
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
.
By setting 𝑣= 𝜎2,
𝜕𝑉
𝜕𝜎2 = 𝜕𝑉
𝜕𝜎
𝜕𝜎
𝜕𝑣
= 1
2𝜎
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
𝜕2𝑉
𝜕(𝜎2)2 = 𝜕
𝜕𝜎
(𝜕𝑉
𝜕𝜎
𝜕𝜎
𝜕𝑣
)
= 𝜕2𝑉
𝜕𝜎2
𝜕𝜎
𝜕𝑣+ 𝜕𝑉
𝜕𝜎
𝜕2𝜎
𝜕𝜎𝜕𝑣
=
1
2𝜎2
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+𝑑+𝑑−
−1
2𝜎2
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+
=
1
2𝜎2
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 𝑑2
+ (𝑑+𝑑−−1) .
Thus,
𝜕𝑉𝑏𝑠
𝜕(𝜎2
RMS(𝑡, 𝑇))
|||||𝜎2
RMS(𝑡,𝑇)=𝜎2
RMS(𝑡,𝑇)
=
1
2𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2
𝜕2𝑉𝑏𝑠
𝜕(𝜎2
RMS(𝑡, 𝑇))2
|||||𝜎2
RMS(𝑡,𝑇)=𝜎2
RMS(𝑡,𝑇)
=
1
2𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2
× (𝑑RMS
+
𝑑RMS
−
−1) .

7.2.3 Stochastic Volatility
753
Therefore,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇)
≈𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)
+
1
2𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2𝔼ℚ[
𝜎2
RMS(𝑡, 𝑇) −𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
+
1
4𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2 (𝑑RMS
+
𝑑RMS
−
−1)
×𝔼ℚ
[(
𝜎2
RMS(𝑡, 𝑇) −𝜎2
RMS(𝑡, 𝑇)
)2||||
ℱ𝑡
]
= 𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇)
+
1
4𝜎2
RMS(𝑡, 𝑇)
√
𝑇−𝑡
2𝜋𝑆𝑡𝑒−𝐷(𝑇−𝑡)𝑒−1
2 (𝑑RMS
+
)2 (𝑑RMS
+
𝑑RMS
−
−1)
×Varℚ[
𝜎2
RMS(𝑡, 𝑇)||| ℱ𝑡
]
.
7. Heston Model. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝜎
𝑡: 𝑡≥0} be two standard Wiener processes on
the probability space (Ω, ℱ, ℙ) with correlation 𝜌∈(−1, 1). Suppose that the asset price
𝑆𝑡and its instantaneous variance 𝜎2
𝑡have the following dynamics
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝜎2
𝑡= 𝜅(𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑𝑊𝜎
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝜇, 𝐷, 𝜅, 𝜃and 𝛼are constants. In addition, let 𝐵𝑡be the risk-free asset with differ-
ential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟is the risk-free interest rate.
By introducing {𝑍𝑡: 𝑡≥0} as a standard Wiener process, independent of 𝑊𝜎
𝑡, show
that we can write
𝑊𝑆
𝑡
= 𝜌𝑊𝜎
𝑡+
√
1 −𝜌2𝑍𝑡.
Using the two-dimensional Girsanov’s theorem, show that under the risk-neutral measure
ℚ,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
𝑑𝜎2
𝑡= (𝜅(𝜃−𝜎2
𝑡) −𝛼𝛾𝑡𝜎𝑡
) 𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡

754
7.2.3 Stochastic Volatility
where ̃
𝑊𝜎
𝑡and ̃
𝑍𝑡are ℚ-standard Wiener processes, ̃
𝑊𝜎
𝑡⟂⟂̃
𝑍𝑡and 𝛾𝑡is the market price
of volatility risk.
Is the market arbitrage free and complete under the ℚmeasure?
By assuming the market price of volatility risk is proportional to the instantaneous
volatility 𝜎𝑡,
𝛾𝑡= 𝑐𝜎𝑡
where 𝑐is a positive constant, show that the dynamics of the model can be described by
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡
(
𝜌𝑑̃
𝑊𝜎
𝑡+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
𝑑𝜎2
𝑡= ̃𝜅( ̃𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
such that ̃𝜅= 𝜅+ 𝛼𝑐and ̃𝜃= 𝜅𝜃(𝜅+ 𝛼𝑐)−1.
Hence, conditional on ℱ𝑡and {𝜎𝑢: 𝑡≤𝑢≤𝑇} show that
log
(𝑆𝑇∕𝜉𝑇
𝑆𝑡∕𝜉𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
∼
[(
𝑟−𝐷−1
2𝜎2
RMS(𝑡, 𝑇)
)
(𝑇−𝑡), 𝜎2
RMS(𝑡, 𝑇)(𝑇−𝑡)
]
where
𝜉𝑠= 𝑒𝜌∫𝑠
0 𝜎𝑢𝑑̃
𝑊𝜎
𝑢−1
2 𝜌2 ∫𝑠
0 𝜎2
𝑢𝑑𝑢
and
𝜎2
RMS(𝑡, 𝑇) = 1 −𝜌2
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢.
We consider a European option price 𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) at time 𝑡written on 𝑆𝑡with expiry
time 𝑇> 𝑡, strike price 𝐾, continuous dividend yield 𝐷and instantaneous variance 𝜎𝑡,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
where the payoff is
Ψ(𝑆𝑇) =
⎧
⎪
⎨
⎪⎩
max {𝑆𝑇−𝐾, 0}
for call option
max {𝐾−𝑆𝑇, 0}
for put option.
Using the tower property, show that the price of a European option at time 𝑡can be
expressed by
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ
[ 𝜉𝑇
𝜉𝑡
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾∕(𝜉𝑇∕𝜉𝑡), 𝑇)||||
ℱ𝑡
]

7.2.3 Stochastic Volatility
755
where 𝑉𝑏𝑠(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) denotes the Black–Scholes formula for a European
option at time 𝑡with spot price 𝑆𝑡, strike price 𝐾, variance 𝜎2
RMS(𝑡, 𝑇) and option expiry
time 𝑇> 𝑡.
Finally, by denoting ℚ𝜉as a new measure where 𝜉𝑡is used as num´eraire, show that
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ𝜉[
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾∕(𝜉𝑇∕𝜉𝑡), 𝑇)||| ℱ𝑡
]
.
Solution: For the first two results, see Problem 7.2.2.2 (page 687).
The market is arbitrage free since we can construct a risk-neutral measure ℚon the
filtration ℱ𝑠, 0 ≤𝑠≤𝑡. However, the market is not complete since 𝜎2
𝑡is not a traded asset
and therefore ℚis not unique. Thus, the risk-neutral measure ℚis an equivalent market
measure.
By setting 𝛾= 𝑐𝜎𝑡,
𝑑𝜎2
𝑡= (𝜅(𝜃−𝜎2
𝑡) −𝛼𝑐𝜎2
𝑡
) 𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
= (𝜅𝜃−(𝜅+ 𝛼𝑐)𝜎2
𝑡
) 𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
= ̃𝜅( ̃𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
such that ̃𝜅= 𝜅+ 𝛼𝑐and ̃𝜃= 𝜅𝜃(𝜅+ 𝛼𝑐)−1.
To show that
log
(𝑆𝑇∕𝜉𝑇
𝑆𝑡∕𝜉𝑡
)|||||
ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
∼
[(
𝑟−𝐷−1
2𝜎2
RMS(𝑡, 𝑇)
)
(𝑇−𝑡), 𝜎2
RMS(𝑡, 𝑇)(𝑇−𝑡)
]
where
𝜉𝑠= 𝑒𝜌∫𝑠
0 𝜎𝑢𝑑̃
𝑊𝜎
𝑢−1
2 𝜌2 ∫𝑠
0 𝜎2
𝑢𝑑𝑢
and
𝜎2
RMS(𝑡, 𝑇) = 1 −𝜌2
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
see Problem 3.2.3.10 of Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus.
Conditional on ℱ𝑡and {𝜎𝑢: 𝑡≤𝑢≤𝑇}, 𝑆𝑇is log normal with initial value 𝑆𝑡𝜉𝑇∕𝜉𝑡and
using the tower property,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝑆𝑇)|| ℱ𝑡
]
= 𝔼ℚ[
𝑒−𝑟(𝑇−𝑡)𝔼ℚ[
Ψ(𝑆𝑇)|| ℱ𝑡, {𝜎𝑢: 𝑡≤𝑢≤𝑇}
]||| ℱ𝑡
]
such that the inner expectation is the Black–Scholes formula with initial value 𝑆𝑡𝜉𝑇∕𝜉𝑡and
term-structure variance 𝜎2
RMS(𝑡, 𝑇) = 1 −𝜌2
𝑇−𝑡∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢.

756
7.2.3 Stochastic Volatility
Thus,
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ
[
𝑉𝑏𝑠
(𝑆𝑡𝜉𝑇
𝜉𝑡
, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇
)|||||
ℱ𝑡
]
.
For a constant value 𝜋> 0, the Black–Scholes formula with a constant or time-dependent
volatility 𝜎has the following identity (see Problem 2.2.2.8, page 109)
𝑉𝑏𝑠
(𝜋𝑆𝑡, 𝜎2, 𝑡; 𝐾, 𝑇) = 𝜋𝑉𝑏𝑠(𝑆𝑡, 𝜎2, 𝑡; 𝐾∕𝜋, 𝑇)
and therefore
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝔼ℚ
[ 𝜉𝑇
𝜉𝑡
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾∕(𝜉𝑇∕𝜉𝑡), 𝑇)||||
ℱ𝑡
]
.
Under the change of num´eraire for a payoff 𝑋𝑇
𝑁(1)
𝑡𝔼ℚ(1)
[
𝑋𝑇
𝑁(1)
𝑇
||||||
ℱ𝑡
]
= 𝑁(2)
𝑡𝔼ℚ(2)
[
𝑋𝑇
𝑁(2)
𝑇
||||||
ℱ𝑡
]
where for 𝑖= 1, 2, 𝑁(𝑖) is a num´eraire and ℚ(𝑖) is the measure under which the asset prices
discounted by 𝑁(𝑖) are ℚ(𝑖)-martingales.
Under the risk-neutral measure ℚwe have
𝑁(1)
𝑡
= 1
and
𝑁(1)
𝑇
= 1
and under the measure ℚ𝜉
𝑁(2)
𝑡
= 𝜉𝑡
and
𝑁(2)
𝑇
= 𝜉𝑇.
By setting 𝑋𝑇= 𝜉𝑇
𝜉𝑡
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾, 𝑇), the option price under the measure ℚ𝜉
is
𝑉(𝑆𝑡, 𝜎2
𝑡, 𝑡; 𝐾, 𝑇) = 𝜉𝑡𝔼ℚ𝜉
[
𝜉𝑇
𝜉𝑡
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾∕(𝜉𝑇∕𝜉𝑡), 𝑇)
𝜉𝑇
|||||
ℱ𝑡
]
= 𝔼ℚ𝜉[
𝑉𝑏𝑠
(𝑆𝑡, 𝜎2
RMS(𝑡, 𝑇), 𝑡; 𝐾∕(𝜉𝑇∕𝜉𝑡), 𝑇)||| ℱ𝑡
]
.
8. Heston Model – Black–Scholes Equation. Let (Ω, ℱ, ℙ) be a probability space and let
{𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑣
𝑡: 𝑡≥0} be two correlated Wiener processes. Suppose that the

7.2.3 Stochastic Volatility
757
asset price 𝑆𝑡and the instantaneous variance 𝑣𝑡follow the diffusion processes
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ √𝑣𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝑣𝑡= 𝜅(𝜃−𝑣𝑡)𝑑𝑡+ 𝜉√𝑣𝑡𝑑𝑊𝑣
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑣
𝑡= 𝜌𝑑𝑡
where 𝜇is the drift, 𝐷is the continuous dividend yield, 𝜅, 𝜃, 𝜉> 0 are constant parameters,
𝜌is the correlation coefficient such that 𝜌∈(−1, 1) and let 𝑟be the risk-free interest rate
from a money-market account.
By considering a hedging portfolio consisting of two European-style options
𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1) and 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2) of different expiry dates 𝑇1 and 𝑇2 and the underlying
asset 𝑆𝑡, show that
𝜕𝑉
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆(𝑆𝑡, 𝑣𝑡)) 𝜕𝑉
𝜕𝑣𝑡
−𝑟𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇) = 0
where 𝜆(𝑆𝑡, 𝑣𝑡) is the market price of volatility risk independent of the expiry time T.
Solution: Let 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇) denote the price of an option at time 𝑡< 𝑇with expiry time
𝑇. By applying It¯o’s lemma, 𝑑𝑉is given by
𝑑𝑉= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
𝑑𝑆𝑡+ 𝜕𝑉
𝜕𝑣𝑡
𝑑𝑣𝑡+ 1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑑𝑆𝑡)2 + 1
2
𝜕2𝑉
𝜕𝑣2
𝑡
(𝑑𝑣𝑡)2
+ 𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
(𝑑𝑆𝑡)(𝑑𝑣𝑡) + …
= 𝜕𝑉
𝜕𝑡𝑑𝑡+ 𝜕𝑉
𝜕𝑆𝑡
((𝜇−𝐷)𝑆𝑡𝑑𝑡+ √𝑣𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
)
+𝜕𝑉
𝜕𝑣𝑡
(𝜅(𝜃−𝑣𝑡)𝑑𝑡+ 𝜉√𝑣𝑡𝑑𝑊𝑣
𝑡
)
+1
2
𝜕2𝑉
𝜕𝑆2
𝑡
(𝑣𝑡𝑆2
𝑡𝑑𝑡) + 1
2
𝜕2𝑉
𝜕𝑣2
𝑡
(𝜉2𝑣𝑡𝑑𝑡) +
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
(𝜌𝜉𝑣𝑡𝑆𝑡𝑑𝑡)
=
(
𝜕𝑉
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉
𝜕𝑣𝑡
)
𝑑𝑡+ √𝑣𝑡𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
𝑑𝑊𝑆
𝑡
+ 𝜉√𝑣𝑡
𝜕𝑉
𝜕𝑣𝑡
𝑑𝑊𝑣
𝑡.
Let the portfolio Π𝑡consist of buying one option with expiry date 𝑇1, 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1), selling
Δ1 units of asset 𝑆𝑡and selling Δ2 units of the option with expiry date 𝑇2, 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2),

758
7.2.3 Stochastic Volatility
where 𝑇1 ≠𝑇2. By setting
𝑉1(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1) = 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1)
𝑉2(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2) = 𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2)
at time 𝑡, the value of the portfolio is
Π𝑡= 𝑉1(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1) −Δ1𝑆𝑡−Δ2𝑉2(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2).
Since we receive 𝐷𝑆𝑡𝑑𝑡for every asset held, the change in portfolio Π𝑡is
𝑑Π𝑡
= 𝑑𝑉1 −Δ1
(𝑑𝑆𝑡+ 𝐷𝑆𝑡𝑑𝑡) −Δ2𝑑𝑉2
=
(
𝜕𝑉1
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉1
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉1
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉1
𝜕𝑆𝑡𝜕𝑣𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉1
𝜕𝑆𝑡
+𝜅(𝜃−𝑣𝑡)𝜕𝑉1
𝜕𝑣𝑡
)
𝑑𝑡−Δ2
(
𝜕𝑉2
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉2
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉2
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉2
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝜇−𝐷)𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉2
𝜕𝑣𝑡
)
𝑑𝑡−Δ1𝜇𝑆𝑡𝑑𝑡
+
(𝜕𝑉1
𝜕𝑆𝑡
−Δ1 −Δ2
𝜕𝑉2
𝜕𝑆𝑡
) √𝑣𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
+
(𝜕𝑉1
𝜕𝑆𝑡
−Δ2
𝜕𝑉2
𝜕𝑣𝑡
)
𝜉√𝑣𝑡𝑑𝑊𝑣
𝑡.
To eliminate both the asset and volatility risk, we have
𝜕𝑉1
𝜕𝑆𝑡
= Δ1 + Δ2
𝜕𝑉2
𝜕𝑆𝑡
and
𝜕𝑉1
𝜕𝑆𝑡
= Δ2
𝜕𝑉2
𝜕𝑣𝑡
or
Δ1 = 𝜕𝑉1
𝜕𝑆𝑡
−
(𝜕𝑉1
𝜕𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
)/ 𝜕𝑉2
𝜕𝑣𝑡
and
Δ2 = 𝜕𝑉1
𝜕𝑆𝑡
/ 𝜕𝑉2
𝜕𝑣𝑡
.
Under the no-arbitrage condition, the return on the portfolio Π𝑡invested in a risk-free
interest rate would see a growth of
𝑑Π𝑡= 𝑟Π𝑡𝑑𝑡

7.2.3 Stochastic Volatility
759
and therefore we have
𝜕𝑉1
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉1
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉1
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉1
𝜕𝑆𝑡𝜕𝑣𝑡
+ (𝜇−𝐷)𝑆𝑡
𝜕𝑉1
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉1
𝜕𝑣𝑡
−
( 𝜕𝑉1
𝜕𝑆𝑡
/ 𝜕𝑉2
𝜕𝑣𝑡
) (
𝜕𝑉2
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉2
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉2
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉2
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝜇−𝐷)𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉2
𝜕𝑣𝑡
)
−
(𝜕𝑉1
𝜕𝑆𝑡
−
(𝜕𝑉1
𝜕𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
)/ 𝜕𝑉2
𝜕𝑣𝑡
)
𝜇𝑆𝑡
= 𝑟
[
𝑉1(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1) −
(𝜕𝑉1
𝜕𝑆𝑡
−
(𝜕𝑉1
𝜕𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
)/ 𝜕𝑉2
𝜕𝑣𝑡
)
𝑆𝑡
−
( 𝜕𝑉1
𝜕𝑆𝑡
/ 𝜕𝑉2
𝜕𝑣𝑡
)
𝑉2(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2)
]
.
By gathering together all 𝑉1 terms on the left-hand side and all 𝑉2 terms on the right-hand
side
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢⎣
𝜕𝑉1
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉1
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉1
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉1
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉1
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉1
𝜕𝑣𝑡
−𝑟𝑉1(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1)
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥⎦
𝜕𝑉1
𝜕𝑣𝑡
=
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢⎣
𝜕𝑉2
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉2
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉2
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉2
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉2
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉2
𝜕𝑣𝑡
−𝑟𝑉2(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇2)
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥⎦
𝜕𝑉2
𝜕𝑣𝑡
.
Since the left-hand side is a function of 𝑇1 and the right-hand side is a function of 𝑇2,
the only way for the equality to hold is for both sides to be equal to a common function
𝜆(𝑆𝑡, 𝑣𝑡) independent of the expiry time 𝑇. By dropping the subscripts we have
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢⎣
𝜕𝑉
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ 𝜅(𝜃−𝑣𝑡)𝜕𝑉
𝜕𝑣𝑡
−𝑟𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇1)
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥⎦
𝜕𝑉
𝜕𝑣𝑡
=
𝜆(𝑆𝑡, 𝑣𝑡).

760
7.2.3 Stochastic Volatility
Thus,
𝜕𝑉
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑉
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝑉
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆(𝑆𝑡, 𝑣𝑡)) 𝜕𝑉
𝜕𝑣𝑡
−𝑟𝑉(𝑆𝑡, 𝑣𝑡, 𝑡; 𝑇) = 0.
9. Heston Model – European Option Price. Let {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝑣
𝑡: 𝑡≥0} be two stan-
dard Wiener processes on the probability space (Ω, ℱ, ℙ) with correlation 𝜌∈(−1, 1). Sup-
pose that the asset price 𝑆𝑡and its instantaneous variance 𝑣𝑡follow
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ √𝑣𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝑣𝑡= 𝜅(𝜃−𝑣𝑡)𝑑𝑡+ 𝜉√𝑣𝑡𝑑𝑊𝑣
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝑣
𝑡= 𝜌𝑑𝑡
where 𝜇is the asset drift, 𝐷is the continuous dividend yield, 𝜅is the variance mean-
reversion rate, 𝜃is the variance long-term mean, 𝜉is the vol-of-vol and 𝜌∈(−1, 1) is the
correlation coefficient. In addition, we let 𝑟be the risk-free interest rate from a money-
market account.
Let 𝐶(𝑆𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) denote the price of a European call option at time 𝑡with strike price
𝐾and expiry time 𝑇> 𝑡, satisfying the Black–Scholes equation
𝜕𝐶
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝐶
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝐶
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆(𝑆𝑡, 𝑣𝑡)) 𝜕𝐶
𝜕𝑣𝑡
−𝑟𝐶(𝑆𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 0
such that 𝜆(𝑆𝑡, 𝑣𝑡) is the market price of volatility risk, with boundary condition
𝐶(𝑆𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
By introducing 𝑥𝑡as the logarithm of the spot price
𝑥𝑡= log 𝑆𝑡
and assuming 𝜆(𝑆𝑡, 𝑣𝑡) = 𝜆𝑣𝑡where 𝜆is a constant value, show that 𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) sat-
isfies the following PDE
𝜕𝐶
𝜕𝑡+ 1
2𝑣𝑡
𝜕2𝐶
𝜕𝑥2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝐶
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡
𝜕2𝐶
𝜕𝑥𝑡𝜕𝑣𝑡
+
(
𝑟−𝐷−1
2𝑣𝑡
) 𝜕𝐶
𝜕𝑥𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆𝑣𝑡
) 𝜕𝐶
𝜕𝑣𝑡
−𝑟𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 0

7.2.3 Stochastic Volatility
761
with boundary condition
𝐶(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = max {𝑒𝑥𝑇−𝐾, 0} .
By analogy with the Black–Scholes formula, let the solution of the call price take the form
𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝑡)𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
where 𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) and 𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) are the risk-neutral probabilities that the call
option is ITM at expiry time 𝑇. By substituting the proposed solution into the PDE, show
that 𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) and 𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) satisfy the PDEs
𝜕𝑃𝑗
𝜕𝑡+ 1
2𝑣𝑡
𝜕2𝑃𝑗
𝜕𝑥2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑃𝑗
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡
𝜕2𝑃𝑗
𝜕𝑥𝑡𝜕𝑣𝑡
+ (𝑟−𝐷+ 𝑢𝑗𝑣𝑡
) 𝜕𝑃𝑗
𝜕𝑥𝑡
+ (𝑎−𝑏𝑗𝑣𝑡
) 𝜕𝑃𝑗
𝜕𝑣𝑡
= 0
for 𝑗= 1, 2 where
𝑢1 = 1
2,
𝑢2 = −1
2,
𝑎= 𝜅𝜃,
𝑏1 = 𝜅+ 𝜆−𝜌𝜉,
𝑏2 = 𝜅+ 𝜆
subject to the boundary condition
𝑃𝑗(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 1I𝑥𝑇≥log 𝐾.
Let ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) be the Fourier transform of 𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇), where
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = ∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝑥𝑡,
𝑗= 1, 2
and show that ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) satisfies
𝜕̂𝑃𝑗
𝜕𝑡+ 1
2𝜉2𝑣𝑡
𝜕2 ̂𝑃𝑗
𝜕𝑣2
𝑡
+ (𝑎−𝑏𝑗𝑣𝑡+ 𝑖𝑚𝜌𝜉𝑣𝑡
) 𝜕̂𝑃𝑗
𝜕𝑣𝑡
+
(
(𝑟−𝐷+ 𝑢𝑗𝑣𝑡)𝑖𝑚−1
2𝑚2𝑣𝑡
)
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
=
0
with boundary condition
̂𝑃𝑗(𝑚, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 𝑒−𝑖𝑚log 𝐾
𝑖𝑚
.

762
7.2.3 Stochastic Volatility
By seeking an exponential affine solution of the form
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝐴(𝑡,𝑇)+𝐵(𝑡,𝑇)𝑣𝑡̂𝑃𝑗(𝑚, 𝑣𝑇, 𝑇; 𝐾, 𝑇)
with 𝐴(𝑇, 𝑇) = 0 and 𝐵(𝑇, 𝑇) = 0, show that
𝜕𝐵
𝜕𝑡= 𝛾(𝐵(𝑡, 𝑇) −𝜋+
) (𝐵(𝑡, 𝑇) −𝜋−
)
𝜕𝐴
𝜕𝑡= 𝛿𝐵(𝑡, 𝑇) + 𝜀
where
𝛼= 1
2𝑚2 −𝑖𝑚𝑢𝑗,
𝛽= 𝑏𝑗−𝑖𝑚𝜌𝜉,
𝛾= −1
2𝜉2
𝛿= −1,
𝜀= −(𝑟−𝐷)𝑖𝑚,
𝜋± = −𝛽±
√
𝛽2 −4𝛼𝛾
2𝛾
.
Solving the two differential equations, show that
𝐴(𝑡, 𝑇) = 𝛿𝜋−
𝜂
[(
̃𝜋−1
̃𝜋
)
log
(
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
1 −̃𝜋
)
−𝜂(𝑇−𝑡)
]
−𝜀(𝑇−𝑡)
𝐵(𝑡, 𝑇) =
𝜋−
(1 −𝑒𝜂(𝑇−𝑡))
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
where
̃𝜋= 𝜋−∕𝜋+
and
𝜂=
√
𝛽2 −4𝛼𝛾.
Finally, by taking the Fourier inversion of ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇),
𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 1
2𝜋∫
∞
−∞
𝑒𝑖𝑚𝑥𝑡̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝑚
show that the European call option at time 𝑡is
𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝑡)𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
where
𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 1
2𝜋∫
∞
−∞
𝑒𝑖𝑚(𝑥𝑡−log 𝐾)+𝐴(𝑡,𝑇)+𝐵(𝑡,𝑇)𝑣𝑡
𝑖𝑚
𝑑𝑚,
𝑗= 1, 2.

7.2.3 Stochastic Volatility
763
Solution: From the PDE satisfied by 𝐶(𝑆𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇),
𝜕𝐶
𝜕𝑡+ 1
2𝑣𝑡𝑆2
𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝐶
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡𝑆𝑡
𝜕2𝐶
𝜕𝑆𝑡𝜕𝑣𝑡
+(𝑟−𝐷)𝑆𝑡
𝜕𝐶
𝜕𝑆𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆(𝑆𝑡, 𝑣𝑡)) 𝜕𝐶
𝜕𝑣𝑡
−𝑟𝐶(𝑆𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 0
such that 𝜆(𝑆𝑡, 𝑣𝑡) is the market price of volatility risk, with boundary condition
𝐶(𝑆𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}
and by substituting 𝜆(𝑆𝑡, 𝑣𝑡) = 𝜆𝑣𝑡and 𝑥𝑡= log 𝑆𝑡, we have
𝜕𝐶
𝜕𝑆𝑡
= 𝜕𝐶
𝜕𝑥𝑡
𝜕𝑥𝑡
𝜕𝑆𝑡
= 1
𝑆𝑡
𝜕𝐶
𝜕𝑥𝑡
𝜕2𝐶
𝜕𝑆2
𝑡
=
𝜕
𝜕𝑆𝑡
(
1
𝑆𝑡
𝜕𝐶
𝜕𝑥𝑡
)
= −1
𝑆2
𝑡
𝜕𝐶
𝜕𝑥𝑡
+ 1
𝑆𝑡
𝜕
𝜕𝑆𝑡
(
𝜕𝐶
𝜕𝑥𝑡
)
= 1
𝑆2
𝑡
(
𝜕2𝐶
𝜕𝑥2
𝑡
−𝜕𝐶
𝜕𝑥𝑡
)
and
𝜕2𝐶
𝜕𝑆𝑡𝜕𝑣𝑡
= 1
𝑆𝑡
𝜕
𝜕𝑣𝑡
(
𝜕𝐶
𝜕𝑥𝑡
)
= 1
𝑆𝑡
𝜕2𝐶
𝜕𝑥𝑡𝜕𝑣𝑡
.
Hence, by substituting the above equations into the Black–Scholes PDE we have
𝜕𝐶
𝜕𝑡+ 1
2𝑣𝑡
𝜕2𝐶
𝜕𝑥2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝐶
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡
𝜕2𝐶
𝜕𝑥𝑡𝜕𝑣𝑡
+
(
𝑟−𝐷−1
2𝑣𝑡
) 𝜕𝐶
𝜕𝑥𝑡
+ (𝜅(𝜃−𝑣𝑡) −𝜆𝑣𝑡
) 𝜕𝐶
𝜕𝑣𝑡
−𝑟𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
𝐶(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = max {𝑒𝑥𝑇−𝐾, 0} = (𝑒𝑥𝑇−𝐾) 1I𝑥𝑇≥log 𝐾.
Setting the solution of the call price in the form
𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝑡)𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇)

764
7.2.3 Stochastic Volatility
we have
𝜕𝐶
𝜕𝑡= 𝐷𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) + 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕𝑃1
𝜕𝑡
−𝑟𝐾𝑒−𝑟(𝑇−𝑡)𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝑡) 𝜕𝑃2
𝜕𝑡
𝜕𝐶
𝜕𝑥𝑡
= 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) + 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕𝑃1
𝜕𝑥𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕𝑃2
𝜕𝑥𝑡
𝜕2𝐶
𝜕𝑥2
𝑡
= 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) + 2𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕𝑃1
𝜕𝑥𝑡
+ 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕2𝑃1
𝜕𝑥2
𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕2𝑃2
𝜕𝑥2
𝑡
𝜕2𝐶
𝜕𝑣𝑡𝜕𝑥𝑡
= 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕𝑃1
𝜕𝑣𝑡
+ 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕2𝑃1
𝜕𝑣𝑡𝜕𝑥𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕2𝑃2
𝜕𝑣𝑡𝜕𝑥𝑡
𝜕𝐶
𝜕𝑣𝑡
= 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕𝑃1
𝜕𝑣𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕𝑃2
𝜕𝑣𝑡
𝜕2𝐶
𝜕𝑣2
𝑡
= 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡) 𝜕2𝑃1
𝜕𝑣2
𝑡
−𝐾𝑒−𝑟(𝑇−𝑡) 𝜕2𝑃2
𝜕𝑣2
𝑡
.
At expiry time 𝑇,
𝐶(𝑆𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = max{𝑒𝑥𝑇−𝐾, 0} = (𝑒𝑥𝑇−𝐾) 1I𝑥𝑇≥log 𝐾
which is equivalent to
𝑒𝑥𝑇𝑃1(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) −𝐾𝑃2(𝑥𝑇, 𝑣𝑇, 𝑇; 𝑘, 𝑇) = 𝑒𝑥𝑇1I𝑥𝑇≥log 𝐾−𝐾1I𝑥𝑇≥log 𝐾.
Hence, the boundary condition becomes
𝑃1(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 1I𝑥𝑇≥log 𝐾
and
𝑃2(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 1I𝑥𝑇≥log 𝐾.
Substituting
the
above
equations
into
the
PDE
satisfied
by
𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇),
𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) will satisfy
𝜕𝑃1
𝜕𝑡+ 1
2𝑣𝑡
𝜕2𝑃1
𝜕𝑥2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑃1
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡
𝜕2𝑃1
𝜕𝑥𝑡𝜕𝑣𝑡
+
(
𝑟−𝐷+ 1
2𝑣𝑡
) 𝜕𝑃1
𝜕𝑥𝑡
+ (𝜅𝜃−(𝜅+ 𝜆−𝜌𝜉)𝑣𝑡
) 𝜕𝑃1
𝜕𝑣𝑡
= 0
with boundary condition
𝑃1(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 1I𝑥𝑇≥log 𝐾.

7.2.3 Stochastic Volatility
765
In contrast, 𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) will satisfy
𝜕𝑃2
𝜕𝑡+ 1
2𝑣𝑡
𝜕2𝑃2
𝜕𝑥2
𝑡
+ 1
2𝜉2𝑣𝑡
𝜕2𝑃2
𝜕𝑣2
𝑡
+ 𝜌𝜉𝑣𝑡
𝜕2𝑃2
𝜕𝑥𝑡𝜕𝑣𝑡
+
(
𝑟−𝐷−1
2𝑣𝑡
) 𝜕𝑃2
𝜕𝑥𝑡
+ (𝜅𝜃−(𝜅+ 𝜆)𝑣𝑡
) 𝜕𝑃2
𝜕𝑣𝑡
= 0
with boundary condition
𝑃2(𝑥𝑇, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = 1I𝑥𝑇≥log 𝐾.
From the definition of the Fourier transform,
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = ∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝑥𝑡,
𝑗= 1, 2
and taking Fourier transforms of the PDE satisfied by 𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇), 𝑗= 1, 2 we have
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑡𝑑𝑥𝑡+ 1
2𝑣𝑡∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑥2
𝑡
𝑑𝑥𝑡+ 1
2𝜉2𝑣𝑡∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑣2
𝑡
𝑑𝑥𝑡
+𝜌𝜉𝑣𝑡∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑥𝑡𝜕𝑣𝑡
𝑑𝑥𝑡+ (𝑟−𝐷+ 𝑢𝑗𝑣𝑡
)
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑥𝑡
𝑑𝑥𝑡
+ (𝑎−𝑏𝑗𝑣𝑡
)
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑣𝑡
𝑑𝑥𝑡= 0.
Using integration by parts for partial derivatives with respect to 𝑥𝑡,
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑥𝑡
𝑑𝑥𝑡= 𝑖𝑚∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝑥𝑡= 𝑖𝑚̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑥2
𝑡
𝑑𝑥𝑡= 𝑖𝑚∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑥𝑡
𝑑𝑥𝑡= −𝑚2 ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑥𝑡𝜕𝑣𝑡
𝑑𝑥𝑡= 𝑖𝑚∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑣𝑡
𝑑𝑥𝑡= 𝑖𝑚
𝜕̂𝑃𝑗
𝜕𝑣𝑡
and since
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑡𝑑𝑥𝑡=
𝜕̂𝑃𝑗
𝜕𝑡,
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕𝑃𝑗
𝜕𝑣𝑡
𝑑𝑥𝑡=
𝜕̂𝑃𝑗
𝜕𝑣𝑡

766
7.2.3 Stochastic Volatility
and
∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑡𝜕2𝑃𝑗
𝜕𝑣2
𝑡
𝑑𝑥𝑡=
𝜕2 ̂𝑃𝑗
𝜕𝑣2
𝑡
by substituting them into the Fourier-transformed PDE, we eventually have
𝜕̂𝑃𝑗
𝜕𝑡+ 1
2𝜉2𝑣𝑡
𝜕2 ̂𝑃𝑗
𝜕𝑣2
𝑡
+ (𝑎−𝑏𝑗𝑣𝑡+ 𝑖𝑚𝜌𝜉𝑣𝑡
) 𝜕̂𝑃𝑗
𝜕𝑣𝑡
+
(
(𝑟−𝐷+ 𝑢𝑗𝑣𝑡)𝑖𝑚−1
2𝑚2𝑣𝑡
)
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 0
with boundary condition
̂𝑃𝑗(𝑚, 𝑣𝑇, 𝑇; 𝐾, 𝑇) = ∫
∞
−∞
𝑒−𝑖𝑚𝑥𝑇1I{𝑥𝑇≥log 𝐾} 𝑑𝑥𝑇
= ∫
∞
log 𝐾
𝑒−𝑖𝑚𝑥𝑇𝑑𝑥𝑇
= −𝑒−𝑖𝑚𝑥𝑇
𝑖𝑚
||||
∞
log 𝐾
= 𝑒−𝑖𝑚log 𝐾
𝑖𝑚
for 𝑗= 1, 2.
Setting the solution of the Fourier-transformed PDE as
̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝐴(𝑡,𝑇)+𝐵(𝑡,𝑇)𝑣𝑡̂𝑃𝑗(𝑚, 𝑣𝑇, 𝑇; 𝐾, 𝑇)
and in order to satisfy the boundary condition, we therefore have
𝐴(𝑇, 𝑇) = 0
and
𝐵(𝑇, 𝑇) = 0.
Substituting
𝜕̂𝑃𝑗
𝜕𝑡=
(𝜕𝐴
𝜕𝑡+ 𝜕𝐵
𝜕𝑡𝑣𝑡
)
̂𝑃𝑗(𝑚, 𝑣𝑇, 𝑇; 𝐾, 𝑇),
𝜕̂𝑃𝑗
𝜕𝑣𝑡
= 𝐵(𝑡, 𝑇) ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇)
and
𝜕2 ̂𝑃𝑗
𝜕𝑣2
𝑡
= 𝐵(𝑡, 𝑇)2 ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇)

7.2.3 Stochastic Volatility
767
into the Fourier-transformed PDE and removing the common factor ̂𝑃𝑗(𝑚, 𝑣𝑡, 𝑡; 𝐾, 𝑇),
𝜕𝐴
𝜕𝑡+ 𝜕𝐵
𝜕𝑡𝑣𝑡+ 1
2𝜉2𝑣𝑡𝐵(𝑡, 𝑇)2 + (𝑎−𝑏𝑗𝑣𝑡+ 𝑖𝑚𝜌𝜉𝑣𝑡
) 𝐵(𝑡, 𝑇)
+(𝑟−𝐷+ 𝑢𝑗𝑣𝑡)𝑖𝑚−1
2𝑚2𝑣𝑡= 0.
Thus, by equating coefficients we have
𝜕𝐵
𝜕𝑡+ 𝑖𝑚𝑢𝑗−1
2𝑚2 + (𝑖𝑚𝜌𝜉−𝑏𝑗)𝐵(𝑡, 𝑇) + 1
2𝜉2𝐵(𝑡, 𝑇)2 = 0
𝜕𝐴
𝜕𝑡+ 𝑎𝐵(𝑡, 𝑇) + (𝑟−𝐷)𝑖𝑚= 0
with boundary conditions
𝐴(𝑇, 𝑇) = 0
and
𝐵(𝑇, 𝑇) = 0.
By setting
𝛼= 1
2𝑚2 −𝑖𝑚𝑢𝑗,
𝛽= 𝑏𝑗−𝑖𝑚𝜌𝜉,
𝛾= −1
2𝜉2
𝛿= −1,
𝜀= −(𝑟−𝐷)𝑖𝑚,
𝜋± = −𝛽±
√
𝛽2 −4𝛼𝛾
2𝛾
the above differential equations can be written as
𝜕𝐵
𝜕𝑡= 𝛼+ 𝛽𝐵(𝑡, 𝑇) + 𝛾𝐵(𝑡, 𝑇)2 = 𝛾(𝐵(𝑡, 𝑇) −𝜋+)(𝐵(𝑡, 𝑇) −𝜋−)
𝜕𝐴
𝜕𝑡= 𝛿𝐵(𝑡, 𝑇) + 𝜀
with boundary conditions
𝐴(𝑇, 𝑇) = 0
and
𝐵(𝑇, 𝑇) = 0.
Solving the differential equation for 𝐵(𝑡, 𝑇),
∫
𝑑𝐵
(𝐵(𝑡, 𝑇) −𝜋+)(𝐵(𝑡, 𝑇) −𝜋−) = ∫𝛾𝑑𝑡
1
𝜋−−𝜋+
[
∫
𝑑𝐵
𝐵−𝜋−
−∫
𝑑𝐵
𝐵−𝜋+
]
= ∫𝛾𝑑𝑡
1
𝜋−−𝜋+
log
(𝐵−𝜋−
𝐵−𝜋+
)
= 𝛾𝑡+ 𝐶
where 𝐶is a constant.

768
7.2.3 Stochastic Volatility
At 𝑡= 𝑇, 𝐵(𝑇, 𝑇) = 0 and so
𝐶=
1
𝜋−−𝜋+
log
(𝜋−
𝜋+
)
−𝛾𝑇.
Thus,
𝐵(𝑡, 𝑇) =
𝜋−
(1 −𝑒(𝜋+−𝜋−)𝛾(𝑇−𝑡))
1 −̃𝜋𝑒(𝜋+−𝜋−)𝛾(𝑇−𝑡)
=
𝜋−
(1 −𝑒𝜂(𝑇−𝑡))
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
where
̃𝜋= 𝜋−∕𝜋+
and
𝜂= (𝜋+ −𝜋−)𝛾=
√
𝛽2 −4𝛼𝛾.
Finally, for the case of 𝐴(𝑡, 𝑇) we can rewrite 𝐵(𝑡, 𝑇) as
𝐵(𝑡, 𝑇) =
𝜋−
(1 −𝑒𝜂(𝑇−𝑡))
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
= 𝜋−
[
𝑒−𝜂(𝑇−𝑡)
𝑒−𝜂(𝑇−𝑡) −̃𝜋−
𝑒𝜂(𝑇−𝑡)
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
]
and solving for 𝐴(𝑡, 𝑇),
∫𝑑𝐴= ∫𝐵(𝑡, 𝑇) 𝑑𝑡+ ∫𝜀𝑑𝑡
= 𝛿𝜋−
[
∫
𝑒−𝜂(𝑇−𝑡)
𝑒−𝜂(𝑇−𝑡) −̃𝜋𝑑𝑡−∫
𝑒𝜂(𝑇−𝑡)
1 −̃𝜋𝑒𝜂(𝑇−𝑡) 𝑑𝑡
]
+ ∫𝜀𝑑𝑡
𝐴(𝑡, 𝑇) = 𝛿𝜋−
𝜂
[
log (𝑒−𝜂(𝑇−𝑡) −̃𝜋) −1
̃𝜋log (1 −̃𝜋𝑒𝜂(𝑇−𝑡))]
+ 𝜀𝑡+ 𝐶
where 𝐶is a constant.
From the boundary condition 𝐴(𝑇, 𝑇) = 0, we have
𝐶= −
{𝛿𝜋−
𝜂
[(
̃𝜋−1
̃𝜋
)
log(1 −̃𝜋)
]
+ 𝜀𝑇
}
and therefore
𝐴(𝑡, 𝑇) = 𝛿𝜋−
𝜂
[(
̃𝜋−1
̃𝜋
)
log
(
1 −̃𝜋𝑒𝜂(𝑇−𝑡)
1 −̃𝜋
)
−𝜂(𝑇−𝑡)
]
−𝜀(𝑇−𝑡).
Hence, for 𝑗= 1, 2,
̃𝑃𝑗(𝑚, 𝑣𝑡.𝑡; 𝐾, 𝑇) = 𝑒𝐴(𝑡,𝑇)+𝐵(𝑡,𝑇)𝑣𝑡−𝑖𝑚log 𝐾
𝑖𝑚

7.2.4 Volatility Derivatives
769
and from the Fourier inversion theorem
𝑃𝑗(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 1
2𝜋∫
∞
−∞
𝑒𝑖𝑚𝑥𝑡̃𝑃𝑗(𝑚, 𝑣𝑡.𝑡; 𝐾, 𝑇) 𝑑𝑚
= 1
2𝜋∫
∞
−∞
𝑒𝑖𝑚(𝑥𝑡−log 𝐾)+𝐴(𝑡,𝑇)+𝐵(𝑡,𝑇)𝑣𝑡
𝑖𝑚
𝑑𝑚, 𝑗= 1, 2
such that the European call option price at time 𝑡is
𝐶(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) = 𝑒𝑥𝑡𝑒−𝐷(𝑇−𝑡)𝑃1(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇) −𝐾𝑒−𝑟(𝑇−𝑡)𝑃2(𝑥𝑡, 𝑣𝑡, 𝑡; 𝐾, 𝑇).
7.2.4
Volatility Derivatives
1. Variance Swap. Let {𝑊𝑡: 𝑡≥0} be a standard Wiener process on the probability space
(Ω, ℱ, ℙ). Suppose that the asset price 𝑆𝑡has the following dynamics
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
where 𝜇, 𝐷are constants and the volatility 𝜎𝑡is a continuous (possibly stochastic) process.
In addition, let 𝑟be the risk-free interest rate from a money-market account.
By considering a European call option 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) written at time 𝑡on 𝑆𝑡with strike
price 𝐾and expiry time 𝑇(𝑇> 𝑡), state the Dupire equation and payoff satisfied by
𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) as a function of strike 𝐾and time 𝑡.
Sketch the call option payoff as a function of strike 𝐾.
Assume that for European call options, all strikes are available and we wish to replicate
a payoff Ψ(𝑆𝑇) by synthesising from the following
Ψ(𝑆𝑇) = ∫
∞
0
𝜙(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
where 𝜙(𝐾) is a density function of European call option payoffs with strike 𝐾.
Show that
𝜙(𝐾) = Ψ
′′(𝐾).
Under what conditions can the payoff Ψ(𝑆𝑇) be synthesised using the above expression?
Hence, deduce that the payoff Ψ(𝑆𝑇) can be constructed using a combination of Euro-
pean put, call, asset and cash of the form
Ψ(𝑆𝑇) = ∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0}𝑑𝐾+ ∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽

770
7.2.4 Volatility Derivatives
where 𝛼, 𝛽and 𝐾0 are constants, 𝜙𝑃(𝐾) and 𝜙𝐶(𝐾) are density functions of European put
and call option payoffs with strike 𝐾, respectively.
Find the replicating portfolio for the payoff Ψ(𝑆𝑇) = log 𝑆𝑇in terms of 𝐾0.
A variance swap is a contract with payoff
Ψ(𝜎𝑇) = ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
in which the constant 𝐾𝑣𝑎𝑟is chosen so that there is no upfront fee to be paid when the
contract is initiated at time 𝑡.
Show that
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢= 2
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
−log(𝑆𝑇
𝑆𝑡
)
]
and using the replicating portfolio for log 𝑆𝑇or otherwise, deduce that this contract can
be replicated with a combination of European call, put, cash and asset.
Solution: The Dupire equation is
𝜕𝐶
𝜕𝑇+ 1
2𝜎2
𝑡𝐾2 𝜕2𝐶
𝜕𝐾2 + (𝐷−𝑟)𝐾𝜕𝐶
𝜕𝐾−𝐷𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 0
with payoff
𝐶(𝑆𝑇, 𝑇; 𝐾, 𝑇) = max{𝑆𝑇−𝐾, 0}.
The call option payoff as a function of strike 𝐾is illustrated in Figure 7.1.
Given that
Ψ(𝑆𝑇) = ∫
∞
0
𝜙(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
Figure 7.1
Call option payoff as a function of strike 𝐾.

7.2.4 Volatility Derivatives
771
by differentiating the expression with respect to 𝑆𝑇,
Ψ′(𝑆𝑇) =
𝜕
𝜕𝑆𝑇∫
∞
0
𝜙(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
=
𝜕
𝜕𝑆𝑇
[
∫
𝑆𝑇
0
𝜙(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+ ∫
∞
𝑆𝑇
𝜙(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
]
=
𝜕
𝜕𝑆𝑇∫
𝑆𝑇
0
𝜙(𝐾)(𝑆𝑇−𝐾) 𝑑𝐾
= ∫
𝑆𝑇
0
𝜙(𝐾) 𝑑𝐾.
Differentiating it again
Ψ′′(𝑆𝑇) =
𝜕
𝜕𝑆𝑇∫
𝑆𝑇
0
𝜙(𝐾) 𝑑𝐾
= 𝜙(𝑆𝑇).
Therefore,
Ψ′′(𝐾) = 𝜙(𝐾).
From the above information, the conditions under which the payoff Ψ(𝑆𝑇) can be synthe-
sised are
s Ψ(𝑆𝑇) has gradient continuity
s Ψ′′(𝑆𝑇) is bounded for small or large 𝑆𝑇values.
If Ψ(𝑆𝑇) has a gradient discontinuity say at 𝑆𝑇= 𝐾0, then
lim
𝑆𝑇→𝐾−
0
Ψ′(𝑆𝑇) ≠
lim
𝑆𝑇→𝐾+
0
Ψ′(𝑆𝑇)
and hence Ψ′(𝑆𝑇) and subsequently Ψ′′(𝑆𝑇) is not continuous at 𝑆𝑇= 𝐾0. Thus, 𝜙(𝑆𝑇)
is also not defined at 𝑆𝑇= 𝐾0.
In contrast, if Ψ′′(𝑆𝑇) is not bounded for small or large 𝑆𝑇, the integral will not converge
(i.e., trading options with unbounded strikes).
Since 𝜙(𝑆𝑇) = Ψ′′(𝑆𝑇) there is a unique 𝜙(𝑆𝑇) corresponding to each Ψ(𝑆𝑇). There-
fore, depending on the position of the arbitrary constant 𝐾0 with respect to 𝑆𝑇, the syn-
thesising portfolio can also accommodate a put option and also a linear function of 𝑆𝑇as

772
7.2.4 Volatility Derivatives
well. To show how this portfolio is synthesised, for a constant 𝐾0 we can set
Ψ′′(𝑆𝑇) = 𝜙(𝑆𝑇)
=
⎧
⎪
⎨
⎪⎩
𝜙𝐶(𝑆𝑇)
for 0 < 𝐾0 < 𝑆𝑇< ∞
𝜙𝑃(𝑆𝑇)
for 0 < 𝑆𝑇< 𝐾0 < ∞
where 𝜙𝐶(𝑆𝑇) and 𝜙𝑃(𝑆𝑇) are density functions of European call and put option payoffs
with strike 𝐾= 𝑆𝑇, respectively.
Taking integrals, we can write it as
Ψ′(𝑆𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾) 𝑑𝐾+ 𝛼
for 0 < 𝐾0 < 𝑆𝑇< ∞
−∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾) 𝑑𝐾+ 𝛼
for 0 < 𝑆𝑇< 𝐾0 < ∞
where 𝛼is a constant.
Integrating again, we can write it as
Ψ(𝑆𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾)(𝑆𝑇−𝐾) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
for 0 < 𝐾0 < 𝑆𝑇< ∞
∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾)(𝐾−𝑆𝑇) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
for 0 < 𝑆𝑇< 𝐾0 < ∞
where 𝛽is a constant.
Hence,
Ψ(𝑆𝑇) =
⎧
⎪
⎪
⎨
⎪
⎪⎩
∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
for 0 < 𝐾0 < 𝑆𝑇< ∞
∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
for 0 < 𝑆𝑇< 𝐾0 < ∞
or in general,
Ψ(𝑆𝑇) = ∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ ∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽.
To find the replicating strategy for Ψ(𝑆𝑇) = log 𝑆𝑇, we consider two cases.

7.2.4 Volatility Derivatives
773
Case 1: 0 < 𝐾0 < 𝑆𝑇< ∞.
Ψ(𝑆𝑇) = ∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ ∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽
= ∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
= ∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾+ ∫
∞
𝑆𝑇
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽
= ∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾)(𝑆𝑇−𝐾) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽.
By setting Ψ(𝑆𝑇) = log 𝑆𝑇and differentiating with respect to 𝑆𝑇up to second order,
Ψ(𝑆𝑇) = log 𝑆𝑇= ∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾)(𝑆𝑇−𝐾) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
Ψ′(𝑆𝑇) = 1
𝑆𝑇
= ∫
𝑆𝑇
𝐾0
𝜙𝐶(𝐾) 𝑑𝐾+ 𝛼
Ψ′′(𝑆𝑇) = −1
𝑆2
𝑇
= 𝜙𝐶(𝑆𝑇).
At 𝑆𝑇= 𝐾0
log 𝐾0 = 𝛼𝐾0 + 𝛽
1
𝐾0
= 𝛼.
Thus,
𝛼= 1
𝐾0
,
𝛽= log 𝐾0 −1
and
𝜙𝐶(𝐾) = −1
𝐾2 .
Case 2: 0 < 𝑆𝑇< 𝐾0 < ∞.
Ψ(𝑆𝑇) = ∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ ∫
∞
𝐾0
𝜙𝐶(𝐾) max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽
= ∫
𝐾0
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽

774
7.2.4 Volatility Derivatives
= ∫
𝑆𝑇
0
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾+ ∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾) max{𝐾−𝑆𝑇, 0} 𝑑𝐾
+𝛼𝑆𝑇+ 𝛽
= ∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾)(𝐾−𝑆𝑇) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽.
By setting Ψ(𝑆𝑇) = log 𝑆𝑇and differentiating with respect to 𝑆𝑇up to second order,
Ψ(𝑆𝑇) = log 𝑆𝑇= ∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾)(𝐾−𝑆𝑇) 𝑑𝐾+ 𝛼𝑆𝑇+ 𝛽
Ψ′(𝑆𝑇) = 1
𝑆𝑇
= −∫
𝐾0
𝑆𝑇
𝜙𝑃(𝐾) 𝑑𝐾+ 𝛼
Ψ′′(𝑆𝑇) = −1
𝑆2
𝑇
= 𝜙𝑃(𝑆𝑇).
At 𝑆𝑇= 𝐾0
log 𝐾0 = 𝛼𝐾0 + 𝛽
1
𝐾0
= 𝛼.
Thus,
𝛼= 1
𝐾0
,
𝛽= log 𝐾0 −1
and
𝜙𝑃(𝐾) = −1
𝐾2 .
Combining case 1 and case 2 results we finally have the replicating formula for log 𝑆𝑇in
terms of 𝐾0
log 𝑆𝑇= −∫
𝐾0
0
1
𝐾2 max{𝐾−𝑆𝑇, 0} 𝑑𝐾−∫
∞
𝐾0
1
𝐾2 max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝑆𝑇
𝐾0
+ log 𝐾0 −1.
Under the risk-neutral measure ℚ,
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑡
where ̃
𝑊𝑡= 𝑊𝑡+ ∫
𝑡
0
𝜇−𝑟
𝜎𝑢
𝑑𝑢is a ℚ-standard Wiener process.

7.2.4 Volatility Derivatives
775
From Taylor’s expansion and subsequently applying It¯o’s lemma,
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑡−1
2𝜎2
𝑡𝑑𝑡
= 𝑑𝑆𝑡
𝑆𝑡
−1
2𝜎2
𝑡𝑑𝑡.
Taking integrals,
∫
𝑇
𝑡
𝑑log 𝑆𝑢= ∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
−1
2 ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
log
(𝑆𝑇
𝑆𝑡
)
= ∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
−1
2 ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
or
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢= 2
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
−log
(𝑆𝑇
𝑆𝑡
)]
.
For the case of a variance swap payoff
Ψ(𝜎𝑇) = ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
let the value of the swap contract at time 𝑡be
𝑉(𝜎𝑡, 𝑡; 𝐾𝑣𝑎𝑟, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
|||||
ℱ𝑡
]
.
Since there is no cash flow at initiation of the contract at time 𝑡,
𝑉(𝜎𝑡, 𝑡; 𝐾𝑣𝑎𝑟, 𝑇) = 0
we can then express
𝐾𝑣𝑎𝑟= 𝔼ℚ
[
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
|||||
ℱ𝑡
]
= 2
{
𝔼ℚ
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
−log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡
]}
= 2
{
𝔼ℚ
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
|||||
ℱ𝑡
]
−𝔼ℚ
[
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡
]}
.

776
7.2.4 Volatility Derivatives
From the dynamics
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+ 𝜎𝑡𝑑̃
𝑊𝑡
then
𝔼ℚ
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
|||||
ℱ𝑡
]
= 𝔼ℚ
[
∫
𝑇
𝑡
(𝑟−𝐷) 𝑑𝑢+ ∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑢
|||||
ℱ𝑡
]
= (𝑟−𝐷)(𝑇−𝑡)
since
𝔼ℚ
[
∫
𝑇
𝑡
𝜎𝑢𝑑̃
𝑊𝑢
|||||
ℱ𝑡
]
= 0.
As for log(𝑆𝑇∕𝑆𝑡), for an arbitrary constant 𝐾0 we can write
log
(𝑆𝑇
𝑆𝑡
)
= log
(𝑆𝑇
𝐾0
)
+ log
(𝐾0
𝑆𝑡
)
and from the results of log 𝑆𝑇,
log
(𝑆𝑇
𝑆𝑡
)
= −∫
𝐾0
0
1
𝐾2 max{𝐾−𝑆𝑇, 0} 𝑑𝐾−∫
∞
𝐾0
1
𝐾2 max{𝑆𝑇−𝐾, 0} 𝑑𝐾
+𝑆𝑇
𝐾0
−1 + log
(𝐾0
𝑆𝑡
)
.
Since
𝔼ℚ[max{𝑆𝑇−𝐾, 0}|| ℱ𝑡
] = 𝑒𝑟(𝑇−𝑡)𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝔼ℚ[max{𝐾−𝑆𝑇, 0}|| ℱ𝑡
] = 𝑒𝑟(𝑇−𝑡)𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇)
𝔼ℚ[𝑆𝑇|| ℱ𝑡
] = 𝑆𝑡𝑒𝑟(𝑇−𝑡)
the parameter 𝐾𝑣𝑎𝑟becomes
𝐾𝑣𝑎𝑟= 2
{
𝔼ℚ
[
∫
𝑇
𝑡
𝑑𝑆𝑢
𝑆𝑢
|||||
ℱ𝑡
]
−𝔼ℚ
[
log
(𝑆𝑇
𝑆𝑡
)|||||
ℱ𝑡
]}
= 2
{
(𝑟−𝐷)(𝑇−𝑡) + 𝔼ℚ
[
∫
𝐾0
0
1
𝐾2 max{𝐾−𝑆𝑇, 0} 𝑑𝐾
|||||
ℱ𝑡
]
+𝔼ℚ
[
∫
𝐾0
0
1
𝐾2 max{𝑆𝑇−𝐾, 0} 𝑑𝐾
|||||
ℱ𝑡
]
−1
𝐾0
𝔼ℚ[𝑆𝑇|| ℱ𝑡
]
−
[
log
(𝐾0
𝑆𝑡
−1
)]}

7.2.4 Volatility Derivatives
777
= 2
{
(𝑟−𝐷)(𝑇−𝑡) + 𝑒(𝑟−𝐷)(𝑇−𝑡)
∫
𝐾0
0
1
𝐾2 𝑃(𝑆𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝐾
+𝑒(𝑟−𝐷)(𝑇−𝑡)
∫
∞
𝐾0
1
𝐾2 𝐶(𝑆𝑡, 𝑡; 𝐾, 𝑇) 𝑑𝐾−𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
𝐾0
−
[
log
(𝐾0
𝑆𝑡
−1
)]}
.
2. Let the asset price 𝑆𝑡and its instantaneous variance 𝜎2
𝑡have the following dynamics
𝑑𝑆𝑡= (𝜇−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑𝑊𝑆
𝑡
𝑑𝜎2
𝑡= 𝜅(𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑𝑊𝜎
𝑡
𝑑𝑊𝑆
𝑡
⋅𝑑𝑊𝜎
𝑡= 𝜌𝑑𝑡
where 𝜇, 𝐷, 𝜅, 𝜃and 𝛼are constants, {𝑊𝑆
𝑡
: 𝑡≥0} and {𝑊𝜎
𝑡: 𝑡≥0} are two standard
Wiener processes on the probability space (Ω, ℱ, ℙ) with correlation 𝜌∈(−1, 1). In addi-
tion, we let 𝐵𝑡be a risk-free asset with the differential equation
𝑑𝐵𝑡= 𝑟𝐵𝑡𝑑𝑡
where 𝑟is the risk-free interest rate.
We consider a variance swap with payoff
Ψ(𝜎𝑇) = ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
where 𝐾𝑣𝑎𝑟is chosen so that no cash flows are exchanged when the contract is initiated at
time 𝑡.
Assuming that the market price of volatility risk is zero, calculate the fair value of 𝐾𝑣𝑎𝑟.
Solution: Following Problem 7.2.3.7 (page 753), it can be shown that under the risk-
neutral measure ℚ,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎2
𝑡= (𝜅(𝜃−𝜎2
𝑡) −𝛼𝛾𝑡𝜎𝑡
) 𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
where ̃
𝑊𝑆
𝑡
= 𝜌̃
𝑊𝜎
𝑡+
√
1 −𝜌2 ̃
𝑍𝑡, ̃
𝑊𝜎
𝑡and ̃
𝑍𝑡are ℚ-standard Wiener processes, ̃
𝑊𝜎
𝑡⟂⟂
̃
𝑍𝑡and 𝛾𝑡is the market price of volatility risk.
By assuming that the market price of volatility risk is zero,
𝑑𝑆𝑡= (𝑟−𝐷)𝑆𝑡𝑑𝑡+ 𝜎𝑡𝑆𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝜎2
𝑡= 𝜅(𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡.

778
7.2.4 Volatility Derivatives
Let the variance swap payoff at expiry time 𝑇be
Ψ(𝜎𝑇) = ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
then under the risk-neutral measure ℚ, the value of the contract at time 𝑡is
𝑉(𝜎𝑡, 𝑡; 𝐾𝑣𝑎𝑟, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ[Ψ(𝜎𝑇)|| ℱ𝑡
]
= 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾𝑣𝑎𝑟
|||||
ℱ𝑡
]
.
Since there is no cash flow when the contract is initiated, we can set
𝑉(𝜎𝑡, 𝑡; 𝐾𝑣𝑎𝑟, 𝑇) = 0
and the fair value of 𝐾𝑣𝑎𝑟is defined as
𝐾𝑣𝑎𝑟= 𝔼ℚ
[
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢
|||||
ℱ𝑡
]
.
From the stochastic volatility model under the risk-neutral measure ℚ,
𝑑𝜎2
𝑡= 𝜅(𝜃−𝜎2
𝑡)𝑑𝑡+ 𝛼𝜎𝑡𝑑̃
𝑊𝜎
𝑡
and taking integrals on both sides we have
∫
𝑇
𝑡
𝑑𝜎2
𝑢= ∫
𝑇
𝑡
𝜅(𝜃−𝜎2
𝑢) 𝑑𝑢+ ∫
𝑇
𝑡
𝛼𝜎𝑢𝑑̃
𝑊𝜎
𝑢
Taking expectations under the filtration ℱ𝑡,
𝔼ℚ
[
∫
𝑇
𝑡
𝑑𝜎2
𝑢
|||||
ℱ𝑡
]
= 𝔼ℚ
[
∫
𝑇
𝑡
𝜅(𝜃−𝜎2
𝑢) 𝑑𝑢
|||||
ℱ𝑡
]
+ 𝔼ℚ
[
∫
𝑇
𝑡
𝛼𝜎𝑢𝑑̃
𝑊𝜎
𝑢
|||||
ℱ𝑡
]
∫
𝑇
𝑡
𝔼ℚ[
𝑑𝜎2
𝑢
||| ℱ𝑡
]
= ∫
𝑇
𝑡
𝔼ℚ[
𝜅(𝜃−𝜎2
𝑢) 𝑑𝑢||| ℱ𝑡
]
since 𝔼ℚ
[
∫
𝑇
𝑡
𝛼𝜎𝑢𝑑̃
𝑊𝜎
𝑢
|||||
ℱ𝑡
]
= 0.
Simplifying further,
∫
𝑇
𝑡
𝑑𝔼ℚ[
𝜎2
𝑢
||| ℱ𝑡
]
= ∫
𝑇
𝑡
[
𝜅𝜃−𝜅𝔼ℚ[
𝜎2
𝑢
||| ℱ𝑡
]]
𝑑𝑢.

7.2.4 Volatility Derivatives
779
By differentiating with respect to 𝑇,
𝑑
𝑑𝑇𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
= 𝜅𝜃−𝜅𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
or
𝑑
𝑑𝑇𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
+ 𝜅𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
= 𝜅𝜃.
To solve the first-order differential equation, we set the particular integral
𝐼= 𝑒∫𝜅𝑑𝑇= 𝑒𝜅𝑇
and multiplying 𝐼with the differential equation
𝑑
𝑑𝑇
[
𝑒𝜅𝑇𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]]
= 𝜅𝜃𝑒𝜅𝑇
and then taking integrals,
𝑒𝜅𝑇𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
= 𝜃𝑒𝜅𝑇+ 𝐶
where 𝐶is a constant.
When the contract is initialised at time 𝑡,
𝔼ℚ[
𝜎2
𝑡
||| ℱ𝑡
]
= 𝜎2
𝑡
so that
𝐶= 𝑒𝜅𝑡(𝜎2
𝑡−𝜃).
Therefore,
𝔼ℚ[
𝜎2
𝑇
||| ℱ𝑡
]
= 𝜃+ 𝑒−𝜅(𝑇−𝑡)(𝜎2
𝑡−𝜃)
and finally the fair value 𝐾𝑣𝑎𝑟takes the form
𝐾𝑣𝑎𝑟= ∫
𝑇
𝑡
𝔼ℚ[
𝜎2
𝑢
||| ℱ𝑡
]
𝑑𝑢
= ∫
𝑇
𝑡
[𝜃+ 𝑒−𝜅(𝑢−𝑡)(𝜎2
𝑡−𝜃)] 𝑑𝑢
= 𝜃(𝑇−𝑡) +
(
𝜎2
𝑡−𝜃
𝜅
)
(1 −𝑒−𝜅(𝑇−𝑡)) .

780
7.2.4 Volatility Derivatives
3. Let {𝑊𝑡: 𝑡≥0} be a standard Wiener process on the probability space (Ω, ℱ, ℙ). Suppose
that the asset price 𝑆𝑡has the following dynamics
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
where 𝜇, 𝐷are constants and the volatility 𝜎𝑡is a continuous (possibly stochastic) process.
In addition, let 𝑟be the risk-free interest rate from a money-market account.
By dividing the time interval [𝑡, 𝑇] into 𝑛equal intervals with corresponding asset price
values 𝑆𝑡0, 𝑆𝑡1, …, 𝑆𝑡𝑛, 𝑡𝑖= 𝑡+ 𝑖Δ𝑡, Δ𝑡= (𝑇−𝑡)∕𝑛, 𝑡= 𝑡0 < 𝑡1 < ⋯< 𝑡𝑛−1 < 𝑡𝑛= 𝑇,
show that the realised integrated variance ∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢and volatility ∫
𝑇
𝑡
𝜎𝑢𝑑𝑢can be
approximated by
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢= lim
𝑛→∞
𝑛−1
∑
𝑖=0
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
and
∫
𝑇
𝑡
𝜎𝑢𝑑𝑢= lim
𝑛→∞
√
𝜋
2
(𝑇−𝑡
𝑛
) 𝑛−1
∑
𝑖=0
|||||
𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
|||||
respectively.
We consider a call option on the realised integrated variance having payoff
Ψ(𝜎𝑇) = max
{
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾, 0
}
.
Explain how to value the call option at time 𝑡as a discretely sampled Asian option.
Solution: From the diffusion process
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷) 𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
and using It¯o’s lemma
(𝑑𝑆𝑡
𝑆𝑡
)2
= [(𝜇−𝐷)𝑑𝑡+ 𝜎𝑡𝑑𝑊𝑡
]2
= (𝜇−𝐷)2(𝑑𝑡)2 + 2(𝜇−𝐷)𝜎𝑡𝑑𝑊𝑡𝑡+ 𝜎2
𝑡(𝑑𝑊𝑡)2
= 𝜎2
𝑡𝑑𝑡.

7.2.4 Volatility Derivatives
781
Thus, for a small time interval Δ𝑡,
𝜎2
𝑡Δ𝑡=
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
and the realised integrated variance is
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢≈
𝑛−1
∑
𝑖=0
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
.
Therefore, as 𝑛→∞,
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢= lim
𝑛→∞
𝑛−1
∑
𝑖=0
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
.
From It¯o’s lemma
𝜎2
𝑡(𝑑𝑊𝑡)2 =
(𝑑𝑆𝑡
𝑆𝑡
)2
we can set
𝜎𝑡|𝑑𝑊𝑡| = ||||
𝑑𝑆𝑡
𝑆𝑡
||||
.
Since |𝑑𝑊𝑡| follows a folded normal distribution |𝑑𝑊𝑡| ∼𝑓(0, 𝑑𝑡) with mean
𝔼(|𝑑𝑊𝑡|) =
√
2𝑑𝑡
𝜋
informally we can write
|𝑑𝑊𝑡| =
√
2𝑑𝑡
𝜋.
For small Δ𝑡,
𝜎𝑡
√
2Δ𝑡
𝜋
=
|||||
𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
|||||
or
𝜎𝑡Δ𝑡=
√
𝜋Δ𝑡
2
|||||
𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
|||||
.

782
7.2.4 Volatility Derivatives
Hence, the realised integrated volatility can be approximated by
∫
𝑇
𝑡
𝜎𝑢𝑑𝑢≈
√
𝜋
2
(𝑇−𝑡
𝑛
) 𝑛−1
∑
𝑖=0
|||||
𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
|||||
and in the limit 𝑛→∞,
∫
𝑇
𝑡
𝜎𝑢𝑑𝑢= lim
𝑛→∞
√
𝜋
2
(𝑇−𝑡
𝑛
) 𝑛−1
∑
𝑖=0
|||||
𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
|||||
.
By definition, the call option price at time 𝑡under the risk-neutral measure ℚis
𝐶𝑣𝑎𝑟(𝜎𝑡, 𝑡; 𝐾, 𝑇) = 𝑒−𝑟(𝑇−𝑡)𝔼ℚ
[
max
{
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢−𝐾, 0
}|||||
ℱ𝑡
]
and since we can approximate
∫
𝑇
𝑡
𝜎2
𝑢𝑑𝑢≈
𝑛−1
∑
𝑖=0
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
the payoff can be written as
Ψ(𝜎𝑇) ≈max
⎧
⎪
⎨
⎪⎩
𝑛−1
∑
𝑖=0
(𝑆𝑡𝑖+1 −𝑆𝑡𝑖
𝑆𝑡𝑖
)2
−𝐾, 0
⎫
⎪
⎬
⎪⎭
.
To value the option as a discretely sampled Asian option, we let
Ψ(𝜎(𝑗)
𝑇) ≈max
⎧
⎪
⎨
⎪⎩
𝑛−1
∑
𝑖=0
⎛
⎜
⎜⎝
𝑆(𝑗)
𝑡𝑖+1 −𝑆(𝑗)
𝑡𝑖
𝑆(𝑗)
𝑡𝑖
⎞
⎟
⎟⎠
2
−𝐾, 0
⎫
⎪
⎬
⎪⎭
,
𝑗= 1, 2, … , 𝑚
where Ψ(𝜎(𝑗)
𝑇) is the 𝑗th realisation of the payoff.

7.2.4 Volatility Derivatives
783
Thus, the call option price at time 𝑡, which is the discounted expected payoff, is approx-
imated by
𝐶𝑣𝑎𝑟(𝜎𝑡, 𝑡; 𝐾, 𝑇) ≈𝑒−𝑟(𝑇−𝑡)
⎡
⎢
⎢
⎢⎣
1
𝑚
𝑚
∑
𝑗=1
max
⎧
⎪
⎨
⎪⎩
𝑛−1
∑
𝑖=0
⎛
⎜
⎜⎝
𝑆(𝑗)
𝑡𝑖+1 −𝑆(𝑗)
𝑡𝑖
𝑆(𝑗)
𝑡𝑖
⎞
⎟
⎟⎠
2
−𝐾, 0
⎫
⎪
⎬
⎪⎭
⎤
⎥
⎥
⎥⎦
= 𝑒−𝑟(𝑇−𝑡) max
⎧
⎪
⎨
⎪⎩
1
𝑚
𝑚
∑
𝑗=1
𝑛−1
∑
𝑖=0
⎛
⎜
⎜⎝
𝑆(𝑗)
𝑡𝑖+1 −𝑆(𝑗)
𝑡𝑖
𝑆(𝑗)
𝑡𝑖
⎞
⎟
⎟⎠
2
−𝐾, 0
⎫
⎪
⎬
⎪⎭
.
4. Timer Option. Under the risk-neutral measure ℚ, let {̃
𝑊𝑆
𝑡
: 𝑡≥0} and {̃
𝑊𝑉
𝑡
: 𝑡≥0} be
two correlated ℚ-standard Wiener processes on the probability space (Ω, ℱ, ℚ) with corre-
lation 𝜌∈(−1, 1). Let the asset price 𝑆𝑡under the ℚmeasure follow a stochastic volatility
model with the following dynamics
𝑑𝑆𝑡
𝑆𝑡
= (𝑟−𝐷)𝑑𝑡+
√
𝑉𝑡𝑑̃
𝑊𝑆
𝑡
𝑑𝑉𝑡= 𝛼(𝑉𝑡, 𝑡)𝑑𝑡+ 𝛽(𝑉𝑡, 𝑡)𝑑̃
𝑊𝑉
𝑡
𝑑̃
𝑊𝑆
𝑡
⋅𝑑̃
𝑊𝑉
𝑡
= 𝜌𝑑𝑡
where 𝑟is the risk-free interest-rate parameter from the money-market account, 𝐷is the
continuous dividend yield,
√
𝑉𝑡is the volatility process, 𝛼(𝑉𝑡, 𝑡) and 𝛽(𝑉𝑡, 𝑡) are continuous
functions.
We denote 𝜏as the random expiry time of a call option written on 𝑆𝑡at time 𝑡with strike
price 𝐾> 0,
𝜏= inf
{
𝑢> 𝑡: ∫
𝑢
𝑡
𝑉𝑠𝑑𝑠= ̃𝑉
}
where it is the first hitting time of the realised integrated variance to the variance budget
̃𝑉.
Show that the timer call option price at time 𝑡is equal to
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) = 𝔼ℚ
[
max
{
𝑆𝑡𝑒−𝐷(𝜏−𝑡)−1
2 ̃𝑉+𝐵̃𝑉−𝐾𝑒−𝑟(𝜏−𝑡), 0
}||||
ℱ𝑡
]
where
𝐵𝑉= ∫
𝜏
𝑡
√
𝑉𝑢
(
𝜌𝑑̃
𝑊𝑉
𝑢+
√
1 −𝜌2𝑑̃
𝑍𝑢
)
such that ̃
𝑍𝑡is a ℚ-standard Wiener process and ̃𝑍𝑡⟂⟂̃
𝑊𝑉
𝑡.
Is there an explicit solution for the above timer call option?

784
7.2.4 Volatility Derivatives
Discuss under what conditions we can expect the timer call option to have closed-form
solutions.
Finally, show that the put–call parity of timer options is
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) −𝑃𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏)
= 𝔼ℚ[
𝑆𝜏𝑒−𝑟(𝜏−𝑡)||| ℱ𝑡
]
−𝐾𝔼ℚ[
𝑒−𝑟(𝜏−𝑡)||| ℱ𝑡
]
where 𝑃𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) is the timer put option written on 𝑆𝑡at time 𝑡with strike price
𝐾and random expiry time 𝜏.
Solution: By expanding 𝑑log 𝑆𝑡using Taylor’s series and subsequently applying It¯o’s
lemma,
𝑑log 𝑆𝑡= 𝑑𝑆𝑡
𝑆𝑡
−1
2
(𝑑𝑆𝑡
𝑆𝑡
)2
+ …
= (𝑟−𝐷)𝑑𝑡+
√
𝑉𝑡𝑑𝑊𝑆
𝑡
−1
2𝑉𝑡𝑑𝑡
=
(
𝑟−𝐷−1
2𝑉𝑡
)
𝑑𝑡+
√
𝑉𝑡𝑑𝑊𝑆
𝑡.
Since we can set
𝑑𝑊𝑆
𝑡
= 𝜌𝑑̃
𝑊𝑉
𝑡
+
√
1 −𝜌2𝑑̃
𝑍𝑡
where ̃
𝑊𝑉
𝑡
⟂⟂̃𝑍𝑡, we can set
𝑑log 𝑆𝑡=
(
𝑟−𝐷−1
2𝑉𝑡
)
𝑑𝑡+
√
𝑉𝑡
(
𝜌𝑑̃
𝑊𝑉
𝑡
+
√
1 −𝜌2𝑑̃
𝑍𝑡
)
.
Taking integrals,
∫
𝜏
𝑡
𝑑log 𝑆𝑢= ∫
𝜏
𝑡
(𝑟−𝐷) 𝑑𝑢−1
2 ∫
𝜏
𝑡
𝑉𝑢𝑑𝑢
+ ∫
𝜏
𝑡
√
𝑉𝑢
(
𝜌𝑑̃
𝑊𝑉
𝑢+
√
1 −𝜌2𝑑̃
𝑍𝑢
)
log
(𝑆𝜏
𝑆𝑡
)
= (𝑟−𝐷)(𝜏−𝑡) −1
2
̃𝑉+ 𝐵̃𝑉
or
𝑆𝜏= 𝑆𝑡𝑒(𝑟−𝐷)(𝜏−𝑡)−1
2 ̃𝑉+𝐵̃𝑉.

7.2.4 Volatility Derivatives
785
Given that the payoff of a timer call option is paid at random time 𝜏, the price of a timer
call option at time 𝑡is
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) = 𝔼ℚ[
𝑒−𝑟(𝜏−𝑡) max {𝑆𝜏−𝐾, 0}||| ℱ𝑡
]
= 𝔼ℚ
[
𝑒−𝑟(𝜏−𝑡) max
{
𝑆𝑡𝑒(𝑟−𝐷)(𝜏−𝑡)+𝐵̃𝑉−1
2 ̃𝑉−𝐾, 0
}||||
ℱ𝑡
]
= 𝔼ℚ
[
max
{
𝑆𝑡𝑒−𝐷(𝜏−𝑡)−1
2 ̃𝑉+𝐵̃𝑉−𝐾𝑒−𝑟(𝜏−𝑡), 0
}||||
ℱ𝑡
]
.
From the timer call option price expression, there is no explicit solution since 𝐵̃𝑉and the
random expiry time 𝜏can be correlated and the conditional distribution of 𝐵̃𝑉
||| 𝜏is not a
normal distribution.
Conditions where we expect the timer call option to have closed-form solutions are as
follows.
(a) 𝐾= 0 and 𝐷= 0
By setting 𝐾= 0 and 𝐷= 0, the timer call option is reduced to a timer share contract
with random expiry time 𝜏.
Hence, we can set
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) = 𝔼ℚ[
𝑒−𝑟(𝜏−𝑡)𝑆𝜏||| ℱ𝑡
]
= 𝑆𝑡
by assuming, under the general stochastic volatility model, that 𝑒𝑟𝑡𝑆𝑡is a martingale
(i.e., putting restrictions on 𝛼(𝑉𝑡, 𝑡) and 𝛽(𝑉𝑡, 𝑡)).
(b) 𝑟= 0 and 𝐷= 0
By setting 𝑟= 0 and 𝐷= 0, we have
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) = 𝔼ℚ
[
max
{
𝑆𝑡𝑒−1
2 ̃𝑉+𝐵̃𝑉−𝐾, 0
}||||
ℱ𝑡
]
.
Note that the difference between the timer option and a European option is only the
expiry time 𝜏, which is random when 𝑟= 𝐷= 0, then the exact date when the cash
flow occurs is no longer applicable. Thus, the timer option is not dependent on 𝜏and
following the Black–Scholes formula we have
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾) = 𝑆𝑡Φ(𝑑+) −𝐾Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) ± 1
2 ̃𝑉
√
̃𝑉
and Φ(⋅) is the cdf of a standard normal.

786
7.2.4 Volatility Derivatives
(c) 𝛽(𝑉𝑡, 𝑡) = 0
When 𝛽(𝑉𝑡, 𝑡) = 0, the instantaneous variance process is deterministic and hence we
know exactly when to exercise the timer call option. By solving the first-order PDE
𝑑𝑉𝑡
𝑑𝑡= 𝛼(𝑉𝑡, 𝑡)
to find the solution 𝑉𝑡, let 𝑇̃𝑉be the time for the realised integrated variance to reach
the variance budget ̃𝑉, i.e.
∫
𝑇̃𝑉
𝑡
𝑉𝑢𝑑𝑢= ̃𝑉.
Thus, the solution of the timer call option reduces to the Black–Scholes formula
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾) = 𝑆𝑡𝑒−𝐷(𝑇̃𝑉−𝑡)Φ(𝑑+) −𝐾𝑒−𝑟(𝑇̃𝑉−𝑡)Φ(𝑑−)
where
𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷)(𝑇̃𝑉−𝑡) ± 1
2 ̃𝑉
√
̃𝑉
and Φ(⋅) is the cdf of a standard normal.
For the put–call parity relationship, from the identity
max{𝑆𝜏−𝐾, 0} −max{𝐾−𝑆𝜏, 0} = 𝑆𝜏−𝐾.
Taking expectations under the risk-neutral measure ℚ,
𝔼ℚ[
𝑒−𝑟(𝜏−𝑡) max{𝑆𝜏−𝐾, 0}||| ℱ𝑡
]
−𝔼ℚ[
𝑒−𝑟(𝜏−𝑡) max{𝑆𝜏−𝐾, 0}||| ℱ𝑡
]
= 𝔼ℚ[
𝑒−𝑟(𝜏−𝑡) (𝑆𝜏−𝐾)||| ℱ𝑡
]
or
𝐶𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏) −𝑃𝑡𝑖𝑚𝑒𝑟(𝑆𝑡, 𝑉𝑡, 𝑡; 𝐾, 𝜏)
= 𝔼ℚ[
𝑒−𝑟(𝜏−𝑡)𝑆𝜏||| ℱ𝑡
]
−𝐾𝔼ℚ[
𝑒−𝑟(𝜏−𝑡)||| ℱ𝑡
]
.
From the put–call parity, we can see that the first term on the right-hand side is the
price of a timer share contract at time 𝑡, whilst the second term is the price of a timer
cash contract at time 𝑡.

Appendix A
Mathematics Formulae
Indices
𝑥𝑎𝑥𝑏= 𝑥𝑎+𝑏,
𝑥𝑎
𝑥𝑏= 𝑥𝑎−𝑏,
(𝑥𝑎)𝑏= (𝑥𝑏)𝑎= 𝑥𝑎𝑏
𝑥−𝑎= 1
𝑥𝑎,
(
𝑥
𝑦
)𝑎
= 𝑥𝑎
𝑦𝑎,
𝑥0 = 1.
Surds
𝑥
1
𝑎=
𝑎√𝑥,
𝑎√𝑥𝑦=
𝑎√
𝑥𝑎√𝑦,
𝑎√
𝑥∕𝑦=
𝑎√
𝑥
𝑎√𝑦
(
𝑎√
𝑥
)𝑎
= 𝑥,
𝑎√
𝑏√
𝑥=
𝑎𝑏√𝑥,
(
𝑎√
𝑥
)𝑏
=
𝑎√
𝑥𝑏= 𝑥
𝑏
𝑎.
Exponential and Natural Logarithm
𝑒𝑥𝑒𝑦= 𝑒𝑥+𝑦,
(𝑒𝑥)𝑦= (𝑒𝑦)𝑥= 𝑒𝑥𝑦,
𝑒0 = 1
log(𝑥𝑦) = log 𝑥+ log 𝑦,
log
(
𝑥
𝑦
)
= log 𝑥−log 𝑦,
log 𝑥𝑦= 𝑦log 𝑥
log 𝑒𝑥= 𝑥,
𝑒log 𝑥= 𝑥,
𝑒𝑎log 𝑥= 𝑥𝑎.
Quadratic Equation
For constants 𝑎, 𝑏and 𝑐, the roots of a quadratic equation 𝑎𝑥2 + 𝑏𝑥+ 𝑐= 0 are
𝑥= −𝑏±
√
𝑏2 −4𝑎𝑐
2𝑎
.
Binomial Formula (
𝑛
𝑘
)
=
𝑛!
𝑘!(𝑛−𝑘)!,
(
𝑛
𝑘
)
+
(
𝑛
𝑘+ 1
)
=
(
𝑛+ 1
𝑘+ 1
)
(𝑥+ 𝑦)𝑛=
𝑛
∑
𝑘=0
(
𝑛
𝑘
)
𝑥𝑛−𝑘𝑦𝑘=
𝑛
∑
𝑘=0
𝑛!
𝑘!(𝑛−𝑘)!𝑥𝑛−𝑘𝑦𝑘.

788
Appendix A
Series
Arithmetic: For initial term 𝑎and common difference 𝑑, the 𝑛th term is
𝑇𝑛= 𝑎+ (𝑛−1)𝑑
and the sum of 𝑛terms is
𝑆𝑛= 1
2𝑛[2𝑎+ (𝑛−1)𝑑] .
Geometric: For initial term 𝑎and common ratio 𝑟, the 𝑛th term is
𝑇𝑛= 𝑎𝑟𝑛−1
the sum of 𝑛terms is
𝑆𝑛= 𝑎(1 −𝑟𝑛)
1 −𝑟
and the sum of infinite terms is
lim
𝑛→∞𝑆𝑛=
𝑎
1 −𝑟,
|𝑟| < 1.
Summation
For 𝑛∈ℤ+,
𝑛
∑
𝑘=1
𝑘= 1
2𝑛(𝑛+ 1),
𝑛
∑
𝑘=1
𝑘2 = 1
6𝑛(𝑛+ 1)(2𝑛+ 1),
𝑛
∑
𝑘=1
𝑘3 =
[1
2𝑛(𝑛+ 1)
]2
.
Let 𝑎1, 𝑎2, … be a sequence of numbers.
s If
∑
𝑎𝑛< ∞⟹lim
𝑛→∞𝑎𝑛= 0.
s If lim
𝑛→∞𝑎𝑛≠0 ⟹
∑
𝑎𝑛= ∞.
Trigonometric Functions
sin(−𝑥) = −sin 𝑥,
cos(−𝑥) = cos 𝑥,
tan 𝑥= sin 𝑥
cos 𝑥
csc 𝑥=
1
sin 𝑥,
sec 𝑥=
1
cos 𝑥,
cot 𝑥=
1
tan 𝑥
cos2 𝑥+ sin2 𝑥= 1,
tan2 𝑥+ 1 = sec2 𝑥,
cot2 𝑥+ 1 = csc2 𝑥
sin(𝑥± 𝑦) = sin 𝑥cos 𝑦± cos 𝑥sin 𝑦

Appendix A
789
cos(𝑥± 𝑦) = cos 𝑥cos 𝑦∓sin 𝑥sin 𝑦
tan(𝑥± 𝑦) = tan 𝑥± tan 𝑦
1 ∓tan 𝑥tan 𝑦
sin(0) = 0,
sin
(𝜋
6
)
= 1
2,
sin
(𝜋
4
)
=
1
√
2
,
sin
(𝜋
3
)
=
√
3
2 ,
sin
(𝜋
2
)
= 1
cos(0) = 1,
cos
(𝜋
6
)
=
√
3
2 ,
cos
(𝜋
4
)
=
1
√
2
,
cos
(𝜋
3
)
= 1
2,
cos
(𝜋
2
)
= 0
tan(0) = 0,
tan
(𝜋
6
)
=
1
√
3
,
tan
(𝜋
4
)
= 1,
tan
(𝜋
3
)
=
√
3,
tan
(𝜋
2
)
= ∞.
Hyperbolic Functions
sinh 𝑥= 𝑒𝑥−𝑒−𝑥
2
,
cosh 𝑥= 𝑒𝑥+ 𝑒−𝑥
2
,
tanh 𝑥= sinh 𝑥
cosh 𝑥= 𝑒𝑥−𝑒−𝑥
𝑒𝑥+ 𝑒−𝑥
csch𝑥=
1
sinh 𝑥,
sech𝑥=
1
cosh 𝑥,
coth 𝑥=
1
tanh 𝑥
sinh(−𝑥) = −sinh 𝑥,
cosh(−𝑥) = cosh 𝑥,
tanh(−𝑥) = −tanh 𝑥
cosh2 𝑥−sinh2 𝑥= 1,
coth2 𝑥−1 = csch2𝑥,
1 −tanh2 𝑥= sech2𝑥
sinh(𝑥± 𝑦) = sinh 𝑥cosh 𝑦± cosh 𝑥sinh 𝑦
cosh(𝑥± 𝑦) = cosh 𝑥cosh 𝑦± sinh 𝑥sinh 𝑦
tanh(𝑥± 𝑦) = tanh 𝑥± tanh 𝑦
1 ± tanh 𝑥tanh 𝑦.
Complex Numbers
Let 𝑤= 𝑢+ 𝑖𝑣and 𝑧= 𝑥+ 𝑖𝑦where 𝑢, 𝑣, 𝑥, 𝑦∈ℝ, 𝑖=
√
−1 and 𝑖2 = −1, then
𝑤± 𝑧= (𝑢± 𝑥) + (𝑣± 𝑦)𝑖,
𝑤𝑧= (𝑢𝑥−𝑣𝑦) + (𝑣𝑥+ 𝑢𝑦)𝑖
𝑤
𝑧=
(𝑢𝑥+ 𝑣𝑦
𝑥2 + 𝑦2
)
+
(𝑣𝑥−𝑢𝑦
𝑥2 + 𝑦2
)
𝑖
̄𝑧= 𝑥−𝑖𝑦,
̄̄𝑧= 𝑧,
𝑤+ 𝑧= ̄𝑤+ ̄𝑧,
𝑤𝑧= ̄𝑤̄𝑧,
(𝑤
𝑧
)
= ̄𝑤
̄𝑧.

790
Appendix A
De Moivre’s Formula: Let 𝑧= 𝑥+ 𝑖𝑦where 𝑥, 𝑦∈ℝand we can write
𝑧= 𝑟(cos 𝜃+ 𝑖sin 𝜃),
𝑟=
√
𝑥2 + 𝑦2,
𝜃= tan−1 (𝑦
𝑥
)
.
For 𝑛∈ℤ
[𝑟(cos 𝜃+ 𝑖sin 𝜃)]𝑛= 𝑟𝑛[cos(𝑛𝜃) + 𝑖sin(𝑛𝜃)] .
Euler’s Formula: For 𝜃∈ℝ
𝑒𝑖𝜃= cos 𝜃+ 𝑖sin 𝜃.
Derivatives
If 𝑓(𝑥) and 𝑔(𝑥) are differentiable functions of 𝑥and 𝑎and 𝑏are constants
Sum Rule:
𝑑
𝑑𝑥(𝑎𝑓(𝑥) + 𝑏𝑔(𝑥)) = 𝑎𝑓′(𝑥) + 𝑏𝑔′(𝑥)
Product/Chain Rule:
𝑑
𝑑𝑥(𝑓(𝑥)𝑔(𝑥)) = 𝑓(𝑥)𝑔′(𝑥) + 𝑓′(𝑥)𝑔(𝑥)
Quotient Rule:
𝑑
𝑑𝑥
(𝑓(𝑥)
𝑔(𝑥)
)
= 𝑓′(𝑥)𝑔(𝑥) −𝑓(𝑥)𝑔′(𝑥)
𝑔(𝑥)2
,
𝑔(𝑥) ≠0
where 𝑑
𝑑𝑥𝑓(𝑥) = 𝑓′(𝑥) and 𝑑
𝑑𝑥𝑔(𝑥) = 𝑔′(𝑥).
If 𝑓(𝑧) is a differentiable function of 𝑧and 𝑧= 𝑧(𝑥) is a differentiable function of 𝑥, then
𝑑
𝑑𝑥𝑓(𝑧(𝑥)) = 𝑓′(𝑧(𝑥))𝑧′(𝑥).
If 𝑥= 𝑥(𝑠), 𝑦= 𝑦(𝑠) and 𝐹(𝑠) = 𝑓(𝑥(𝑠), 𝑦(𝑠)), then
𝑑
𝑑𝑠𝐹(𝑠) = 𝜕𝑓
𝜕𝑥⋅𝜕𝑥
𝜕𝑠+ 𝜕𝑓
𝜕𝑦⋅𝜕𝑦
𝜕𝑠.
If 𝑥= 𝑥(𝑢, 𝑣), 𝑦= 𝑦(𝑢, 𝑣) and 𝐹(𝑢, 𝑣) = 𝑓(𝑥(𝑢, 𝑣), 𝑦(𝑢, 𝑣)), then
𝜕𝐹
𝜕𝑢= 𝜕𝑓
𝜕𝑥⋅𝜕𝑥
𝜕𝑢+ 𝜕𝑓
𝜕𝑦⋅𝜕𝑦
𝜕𝑢, 𝜕𝐹
𝜕𝑣= 𝜕𝑓
𝜕𝑥⋅𝜕𝑥
𝜕𝑣+ 𝜕𝑓
𝜕𝑦⋅𝜕𝑦
𝜕𝑣.

Appendix A
791
Standard Differentiations
If 𝑓(𝑥) and 𝑔(𝑥) are differentiable functions of 𝑥and 𝑎and 𝑏are constants
𝑑
𝑑𝑥𝑎= 0,
𝑑
𝑑𝑥[𝑓(𝑥)]𝑛= 𝑛[𝑓(𝑥)]𝑛−1𝑓′(𝑥)
𝑑
𝑑𝑥𝑒𝑓(𝑥) = 𝑓′(𝑥)𝑒𝑓(𝑥),
𝑑
𝑑𝑥log 𝑓(𝑥) = 𝑓′(𝑥)
𝑓(𝑥) ,
𝑑
𝑑𝑥𝑎𝑓(𝑥) = 𝑓′(𝑥)𝑎𝑓(𝑥) log 𝑎
𝑑
𝑑𝑥sin(𝑎𝑥) = 𝑎cos 𝑥,
𝑑
𝑑𝑥cos(𝑎𝑥) = −𝑎sin(𝑎𝑥),
𝑑
𝑑𝑥tan(𝑎𝑥) = 𝑎sec2 𝑥
𝑑
𝑑𝑥sinh(𝑎𝑥) = 𝑎cosh(𝑎𝑥),
𝑑
𝑑𝑥cosh(𝑎𝑥) = 𝑎sinh(𝑎𝑥),
𝑑
𝑑𝑥tanh(𝑎𝑥) = 𝑎sech2(𝑎𝑥)
where 𝑓′(𝑥) = 𝑑
𝑑𝑥𝑓(𝑥).
Taylor Series
If 𝑓(𝑥) is an analytic function of 𝑥, then for small ℎ
𝑓(𝑥0 + ℎ) = 𝑓(𝑥0) + 𝑓′(𝑥0)ℎ+ 1
2! 𝑓′′(𝑥0)ℎ2 + 1
3! 𝑓′′′(𝑥0)ℎ3 + …
If 𝑓(𝑥, 𝑦) is an analytic function of 𝑥and 𝑦, then for small Δ𝑥, Δ𝑦
𝑓(𝑥0 + Δ𝑥, 𝑦0 + Δ𝑦) = 𝑓(𝑥0, 𝑦0) + 𝜕𝑓(𝑥0, 𝑦0)
𝜕𝑥
Δ𝑥+ 𝜕𝑓(𝑥0, 𝑦0)
𝜕𝑦
Δ𝑦
+ 1
2!
[𝜕2𝑓(𝑥0, 𝑦0)
𝜕𝑥2
(Δ𝑥)2 + 2𝜕2𝑓(𝑥0, 𝑦0)
𝜕𝑥𝜕𝑦
Δ𝑥Δ𝑦+ 𝜕2𝑓(𝑥0, 𝑦0)
𝜕𝑦2
(Δ𝑦)2
]
+ 1
3!
[𝜕3𝑓(𝑥0, 𝑦0)
𝜕𝑥3
(Δ𝑥)3 + 3𝜕3𝑓(𝑥0, 𝑦0)
𝜕𝑥2𝜕𝑦
(Δ𝑥)2Δ𝑦
+3𝜕3𝑓(𝑥0, 𝑦0)
𝜕𝑥𝜕𝑦2
Δ𝑥(Δ𝑦)2 + 𝜕3𝑓(𝑥0, 𝑦0)
𝜕𝑦3
(Δ𝑦)3
]
+ …
Maclaurin Series
Taylor series expansion of a function about 𝑥0 = 0:
1
1 + 𝑥= 1 −𝑥+ 𝑥2 −𝑥3 + … ,
|𝑥| < 1
1
1 −𝑥= 1 + 𝑥+ 𝑥2 + 𝑥3 + … ,
|𝑥| < 1
𝑒𝑥= 1 + 𝑥+ 1
2!𝑥2 + 1
3!𝑥3 + … ,
for all 𝑥

792
Appendix A
𝑒−𝑥= 1 −𝑥+ 1
2!𝑥2 −1
3!𝑥3 + … ,
for all 𝑥
log(1 + 𝑥) = 𝑥−1
2𝑥2 + 1
3𝑥3 −1
4𝑥4 + … ,
𝑥∈(−1, 1]
log(1 −𝑥) = −𝑥−1
2𝑥2 −1
3𝑥3 −1
4𝑥4 + … ,
|𝑥| < 1
sin 𝑥= 𝑥−1
3!𝑥3 + 1
5!𝑥5 −1
7!𝑥7 + … ,
for all 𝑥
cos 𝑥= 1 −1
2!𝑥2 + 1
4!𝑥4 −1
6!𝑥6 + … ,
for all 𝑥
tan 𝑥= 𝑥+ 1
3𝑥3 + 2𝑥5
15 + 17
315𝑥7 + … ,
|𝑥| < 𝜋
2
sinh 𝑥= 𝑥+ 1
3!𝑥3 + 1
5!𝑥5 + 1
7!𝑥7 + … ,
for all 𝑥
cosh 𝑥= 1 + 1
2!𝑥2 + 1
4!𝑥4 + 1
6!𝑥6 + … ,
for all 𝑥
tanh 𝑥= 𝑥−1
3𝑥3 + 2𝑥5
15 −17
315𝑥7 + … ,
|𝑥| < 𝜋
2 .
Landau Symbols and Asymptotics
Let 𝑓(𝑥) and 𝑔(𝑥) be two functions defined on some subsets of real numbers, then as 𝑥→𝑥0
s 𝑓(𝑥) = 𝑂(𝑔(𝑥)) if there exists a constant 𝐾> 0 and 𝛿> 0 such that |𝑓(𝑥)| ≤𝐾|𝑔(𝑥)|
for |𝑥−𝑥0| < 𝛿
s 𝑓(𝑥) = 𝑜(𝑔(𝑥)) if lim
𝑥→𝑥0
𝑓(𝑥)
𝑔(𝑥) = 0
s 𝑓(𝑥) ∼𝑔(𝑥) if lim
𝑥→𝑥0
𝑓(𝑥)
𝑔(𝑥) = 1.
L’Ĥopital’s Rule
Let 𝑓and 𝑔be differentiable on 𝑎∈ℝsuch that 𝑔′(𝑥) ≠0 in an interval around 𝑎, except
possibly at 𝑎itself. Suppose that
lim
𝑥→𝑎𝑓(𝑥) = lim
𝑥→𝑎𝑔(𝑥) = 0
or
lim
𝑥→𝑎𝑓(𝑥) = lim
𝑥→𝑎𝑔(𝑥) = ±∞

Appendix A
793
then
lim
𝑥→𝑎
𝑓(𝑥)
𝑔(𝑥) = lim
𝑥→𝑎
𝑓′(𝑥)
𝑔′(𝑥) .
Indefinite Integrals
If 𝐹(𝑥) is a differentiable function and 𝑓(𝑥) is its derivative, then
∫𝑓(𝑥) 𝑑𝑥= 𝐹(𝑥) + 𝑐
where 𝐹′(𝑥) = 𝑑
𝑑𝑥𝐹(𝑥) = 𝑓(𝑥) and 𝑐is an arbitrary constant.
If 𝑓(𝑥) is a continuous function then
𝑑
𝑑𝑥∫𝑓(𝑥) 𝑑𝑥= 𝑓(𝑥).
Standard Indefinite Integrals
If 𝑓(𝑥) is a differentiable function of 𝑥and 𝑎and 𝑏are constants
∫𝑎𝑑𝑥= 𝑎𝑥+ 𝑐,
∫(𝑎𝑥+ 𝑏)𝑛𝑑𝑥= (𝑎𝑥+ 𝑏)𝑛+1
𝑎(𝑛+ 1)
+ 𝑐,
𝑛≠−1
∫
𝑓′(𝑥)
𝑓(𝑥) 𝑑𝑥= log |𝑓(𝑥)| + 𝑐,
∫𝑒𝑓(𝑥) 𝑑𝑥=
1
𝑓′(𝑥)𝑒𝑓(𝑥) + 𝑐
∫log(𝑎𝑥) 𝑑𝑥= 𝑥log(𝑎𝑥) −𝑎𝑥+ 𝑐,
∫𝑎𝑥𝑑𝑥=
𝑎𝑥
log 𝑎+ 𝑐
∫sin(𝑎𝑥) 𝑑𝑥= −1
𝑎cos(𝑎𝑥) + 𝑐,
∫cos(𝑎𝑥) 𝑑𝑥= 1
𝑎sin(𝑎𝑥) + 𝑐
∫sinh(𝑎𝑥) 𝑑𝑥= 1
𝑎cosh(𝑎𝑥) + 𝑐,
∫cosh(𝑎𝑥) 𝑑𝑥= 1
𝑎sinh(𝑎𝑥) + 𝑐
where 𝑐is an arbitrary constant.
Definite Integrals
If 𝐹(𝑥) is a differentiable function and 𝑓(𝑥) is its derivative and is continuous on a closed
interval [𝑎, 𝑏], then
∫
𝑏
𝑎
𝑓(𝑥) 𝑑𝑥= 𝐹(𝑏) −𝐹(𝑎)
where 𝐹′(𝑥) = 𝑑
𝑑𝑥𝐹(𝑥) = 𝑓(𝑥).

794
Appendix A
If 𝑓(𝑥) and 𝑔(𝑥) are integrable functions then
∫
𝑎
𝑎
𝑓(𝑥) 𝑑𝑥= 0,
∫
𝑏
𝑎
𝑓(𝑥) 𝑑𝑥= −∫
𝑎
𝑏
𝑓(𝑥) 𝑑𝑥
∫
𝑏
𝑎
[𝛼𝑓(𝑥) + 𝛽𝑔(𝑥)] 𝑑𝑥= 𝛼∫
𝑏
𝑎
𝑓(𝑥) 𝑑𝑥+ 𝛽∫
𝑏
𝑎
𝑔(𝑥) 𝑑𝑥,
𝛼, 𝛽are constants
∫
𝑏
𝑎
𝑓(𝑥) 𝑑𝑥= ∫
𝑐
𝑎
𝑓(𝑥) 𝑑𝑥+ ∫
𝑏
𝑐
𝑓(𝑥) 𝑑𝑥,
𝑐∈[𝑎, 𝑏].
Derivatives of Definite Integrals
If 𝑓(𝑡) is a continuous function of 𝑡and 𝑎(𝑥) and 𝑏(𝑥) are continuous functions of 𝑥
𝑑
𝑑𝑥∫
𝑏(𝑥)
𝑎(𝑥)
𝑓(𝑡) 𝑑𝑡= 𝑓(𝑏(𝑥)) 𝑑
𝑑𝑥𝑏(𝑥) −𝑓(𝑎(𝑥)) 𝑑
𝑑𝑥𝑎(𝑥)
𝑑
𝑑𝑥∫
𝑏(𝑥)
𝑎(𝑥)
𝑑𝑡= 𝑑
𝑑𝑥𝑏(𝑥) −𝑑
𝑑𝑥𝑎(𝑥).
If 𝑔(𝑥, 𝑡) is a differentiable function of two variables then
𝑑
𝑑𝑥∫
𝑏(𝑥)
𝑎(𝑥)
𝑔(𝑥, 𝑡) 𝑑𝑡= 𝑔(𝑥, 𝑏(𝑥)) 𝑑
𝑑𝑥𝑏(𝑥) −𝑔(𝑥, 𝑎(𝑥)) 𝑑
𝑑𝑥𝑎(𝑥) + ∫
𝑏(𝑥)
𝑎(𝑥)
𝜕𝑔(𝑥, 𝑡)
𝜕𝑥
𝑑𝑡.
Integration by Parts
For definite integrals
∫
𝑏
𝑎
𝑢(𝑥)𝑣′(𝑥) 𝑑𝑥= 𝑢(𝑥)𝑣(𝑥)
|||||
𝑏
𝑎
−∫
𝑏
𝑎
𝑣(𝑥)𝑢′(𝑥) 𝑑𝑥
where 𝑢′(𝑥) = 𝑑
𝑑𝑥𝑢(𝑥) and 𝑣′(𝑥) = 𝑑
𝑑𝑥𝑣(𝑥).
Integration by Substitution
If 𝑓(𝑥) is a continuous function of 𝑥and 𝑔′ is continuous on the closed interval [𝑎, 𝑏], then
∫
𝑔(𝑎)
𝑔(𝑏)
𝑓(𝑥) 𝑑𝑥= ∫
𝑏
𝑎
𝑓(𝑔(𝑢))𝑔′(𝑢) 𝑑𝑢.

Appendix A
795
Gamma Function
The gamma function is defined as
Γ(𝑧) = ∫
∞
0
𝑡𝑧−1𝑒−𝑡𝑑𝑡
such that
Γ(𝑧+ 1) = 𝑧Γ(𝑧),
Γ
(1
2
)
=
√
𝜋,
Γ(𝑛) = (𝑛−1)! for 𝑛∈ℕ.
Beta Function
The beta function is defined as
𝐵(𝑥, 𝑦) = ∫
1
0
𝑡𝑥−1(1 −𝑡)𝑦−1 𝑑𝑡for 𝑥> 0, 𝑦> 0
such that
𝐵(𝑥, 𝑦) = 𝐵(𝑦, 𝑥),
𝐵(𝑥, 𝑦) = Γ(𝑥)Γ(𝑦)
Γ(𝑥+ 𝑦) .
In addition
∫
𝑢
0
𝑡𝑥−1(𝑢−𝑡)𝑦−1 𝑑𝑡= 𝑢𝑥+𝑦−1𝐵(𝑥, 𝑦).
Convex Function
A set Ω in a vector space over ℝis called a convex set if for 𝑥, 𝑦∈Ω, 𝑥≠𝑦and for any
𝜆∈(0, 1),
𝜆𝑥+ (1 −𝜆)𝑦∈Ω.
Let Ω be a convex set in a vector space over ℝ. A function 𝑓: Ω ⟼ℝis called a convex
function if for 𝑥, 𝑦∈Ω, 𝑥≠𝑦and for any 𝜆∈(0, 1),
𝑓(𝜆𝑥+ (1 −𝜆)𝑦) ≤𝜆𝑓(𝑥) + (1 −𝜆) 𝑓(𝑦).
s If the inequality is strict then 𝑓is strictly convex.
s If 𝑓is convex and differentiable on ℝthen 𝑓(𝑥) ≥𝑓(𝑦) + 𝑓′(𝑦)(𝑥−𝑦).
s If 𝑓is a twice continuously differentiable function on ℝthen 𝑓is convex if and only if
𝑓′′ ≥0. If 𝑓′′ > 0 then 𝑓is strictly convex.
s 𝑓is a (strictly) concave function if −𝑓is a (strictly) convex function.

796
Appendix A
Dirac Delta Function
The Dirac delta function is defined as
𝛿(𝑥) =
{
0
𝑥≠0
∞
𝑥= 0
and for a continuous function 𝑓(𝑥) and a constant 𝑎we have
∫
∞
−∞
𝛿(𝑥) 𝑑𝑥= 1,
∫
∞
−∞
𝑓(𝑥)𝛿(𝑥) 𝑑𝑥= 𝑓(0),
∫
∞
−∞
𝑓(𝑥)𝛿(𝑥−𝑎) 𝑑𝑥= 𝑓(𝑎).
Heaviside Step Function
The Heaviside step function 𝐻(𝑥) is defined as the integral of the Dirac delta function given
as
𝐻(𝑥) = ∫
𝑥
−∞
𝛿(𝑠) 𝑑𝑠=
{
0
𝑥< 0
1
𝑥> 0.
Fubini’s Theorem
Suppose that 𝑓(𝑥, 𝑦) is 𝐴× 𝐵measurable and if ∫𝐴×𝐵
|𝑓(𝑥, 𝑦)| 𝑑(𝑥, 𝑦) < ∞, then
∫𝐴×𝐵
𝑓(𝑥, 𝑦) 𝑑(𝑥, 𝑦) = ∫𝐴
(
∫𝐵
𝑓(𝑥, 𝑦) 𝑑𝑦
)
𝑑𝑥= ∫𝐵
(
∫𝐴
𝑓(𝑥, 𝑦) 𝑑𝑥
)
𝑑𝑦.

Appendix B
Probability Theory Formulae
Probability Concepts
Let 𝐴and 𝐵be events of the sample space Ω with probabilities ℙ(𝐴) ∈[0, 1] and ℙ(𝐵) ∈
[0, 1], then
Complement:
ℙ(𝐴𝑐) = 1 −ℙ(𝐴).
Conditional:
ℙ(𝐴|𝐵) = ℙ(𝐴∩𝐵)
ℙ(𝐵)
.
Independence: The events 𝐴and 𝐵are independent if and only if
ℙ(𝐴∩𝐵) = ℙ(𝐴) ⋅ℙ(𝐵).
Mutually Exclusive: The events 𝐴and 𝐵are mutually exclusive if and only if
ℙ(𝐴∩𝐵) = 0.
Addition:
ℙ(𝐴∪𝐵) = ℙ(𝐴) + ℙ(𝐵) −ℙ(𝐴∩𝐵).
Multiplication:
ℙ(𝐴∩𝐵) = ℙ(𝐴|𝐵)ℙ(𝐵) = ℙ(𝐵|𝐴)ℙ(𝐴).
Partition:
ℙ(𝐴) = ℙ(𝐴∩𝐵) + ℙ(𝐴∩𝐵𝑐) = ℙ(𝐴|𝐵)ℙ(𝐵) + ℙ(𝐴|𝐵𝑐)ℙ(𝐵𝑐).
Bayes’ Rule
Let 𝐴and 𝐵be events of the sample space Ω with probabilities ℙ(𝐴) ∈[0, 1] and ℙ(𝐵) ∈
[0, 1], then
ℙ(𝐴|𝐵) = ℙ(𝐵|𝐴)ℙ(𝐴)
ℙ(𝐵)
.

798
Appendix B
Indicator Function
The indicator function 1I𝐴of an event 𝐴of a sample space Ω is a function 1I𝐴: Ω ⟼ℝ
defined as
1I𝐴(𝜔) =
{
1
if 𝜔∈𝐴
0
if 𝜔∈𝐴𝑐.
Properties: For events 𝐴and 𝐵of the sample space Ω
1I𝐴𝑐= 1 −1I𝐴,
1I𝐴∩𝐵= 1I𝐴1I𝐵,
1I𝐴∪𝐵= 1I𝐴+ 1I𝐵−1I𝐴1I𝐵
𝔼(1I𝐴) = ℙ(𝐴),
Var(1I𝐴) = ℙ(𝐴)ℙ(𝐴𝑐),
Cov(1I𝐴, 1I𝐵) = ℙ(𝐴∩𝐵) −ℙ(𝐴)ℙ(𝐵).
Discrete Random Variables
Univariate Case
Let 𝑋be a discrete random variable whose possible values are 𝑥= 𝑥1, 𝑥2, … and let 𝑃(𝑋= 𝑥)
be the probability mass function.
Total Probability of All Possible Values:
∞
∑
𝑘=1
ℙ(𝑋= 𝑥𝑘) = 1.
Cumulative Distribution Function:
ℙ(𝑋≤𝑥𝑛) =
𝑛
∑
𝑘=1
ℙ(𝑋= 𝑥𝑘).
Expectation:
𝔼(𝑋) = 𝜇=
∞
∑
𝑘=1
𝑥𝑘ℙ(𝑋= 𝑥𝑘).
Variance:
Var(𝑋) = 𝜎2
= 𝔼[(𝑋−𝜇)2]
=
∞
∑
𝑘=1
(𝑥𝑘−𝜇)2ℙ(𝑋= 𝑥𝑘)
=
∞
∑
𝑘=1
𝑥2
𝑘ℙ(𝑋= 𝑥𝑘) −𝜇2
= 𝔼(𝑋2) −[𝔼(𝑋)]2 .

Appendix B
799
Moment-Generating Function:
𝑀𝑋(𝑡) = 𝔼(𝑒𝑡𝑋) =
∞
∑
𝑘=1
𝑒𝑡𝑥𝑘ℙ(𝑋= 𝑥𝑘),
𝑡∈ℝ.
Characteristic Function:
𝜑𝑋(𝑡) = 𝔼(𝑒𝑖𝑡𝑋) =
∞
∑
𝑘=1
𝑒𝑖𝑡𝑥𝑘ℙ(𝑋= 𝑥𝑘),
𝑖=
√
−1 and 𝑡∈ℝ.
Bivariate Case
Let 𝑋and 𝑌be discrete random variables whose possible values are 𝑥= 𝑥1, 𝑥2, … and 𝑦=
𝑦1, 𝑦2, …, respectively, and let 𝑃(𝑋= 𝑥, 𝑌= 𝑦) be the joint probability mass function.
Total Probability of All Possible Values:
∞
∑
𝑗=1
∞
∑
𝑘=1
ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘) = 1.
Joint Cumulative Distribution Function:
ℙ(𝑋≤𝑥𝑛, 𝑌≤𝑦𝑚) =
𝑛
∑
𝑗=1
𝑚
∑
𝑘=1
ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘).
Marginal Probability Mass Function:
ℙ(𝑋= 𝑥) =
∞
∑
𝑘=1
ℙ(𝑋= 𝑥, 𝑌= 𝑦𝑘),
ℙ(𝑌= 𝑦) =
∞
∑
𝑗=1
ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦).
Conditional Probability Mass Function:
ℙ(𝑋= 𝑥|𝑌= 𝑦) = ℙ(𝑋= 𝑥, 𝑌= 𝑦)
ℙ(𝑌= 𝑦)
,
ℙ(𝑌= 𝑦|𝑋= 𝑥) = ℙ(𝑋= 𝑥, 𝑌= 𝑦)
ℙ(𝑋= 𝑥)
.
Conditional Expectation:
𝔼(𝑋|𝑌) = 𝜇𝑥|𝑦=
𝑛
∑
𝑗=1
𝑥𝑗ℙ(𝑋= 𝑥𝑗|𝑌= 𝑦),
𝔼(𝑌|𝑋) = 𝜇𝑦|𝑥=
𝑛
∑
𝑘=1
𝑦𝑘ℙ(𝑌= 𝑦𝑘|𝑋= 𝑥).

800
Appendix B
Conditional Variance:
Var(𝑋|𝑌) = 𝜎2
𝑥|𝑦
= 𝔼
[
(𝑋−𝜇𝑥|𝑦)2||| 𝑌
]
=
∞
∑
𝑗=1
(𝑥𝑗−𝜇𝑥|𝑦)2ℙ(𝑋= 𝑥𝑗|𝑌= 𝑦)
=
∞
∑
𝑗=1
𝑥2
𝑗ℙ(𝑋= 𝑥𝑗|𝑌= 𝑦) −𝜇2
𝑥|𝑦
Var(𝑌|𝑋) = 𝜎2
𝑦|𝑥
= 𝔼
[
(𝑌−𝜇𝑦|𝑥)2||| 𝑋
]
=
∞
∑
𝑘=1
(𝑦𝑘−𝜇𝑦|𝑥)2ℙ(𝑌= 𝑦𝑘|𝑋= 𝑥)
=
∞
∑
𝑘=1
𝑦2
𝑘ℙ(𝑌= 𝑦𝑘|𝑋= 𝑥) −𝜇2
𝑦|𝑥.
Covariance:
For 𝔼(𝑋) = 𝜇𝑥and 𝔼(𝑌) = 𝜇𝑦
Cov(𝑋, 𝑌) = 𝔼[(𝑋−𝜇𝑥)(𝑌−𝜇𝑦)]
=
∞
∑
𝑗=1
∞
∑
𝑘=1
(𝑥𝑗−𝜇𝑥)(𝑦𝑘−𝜇𝑦)ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘)
=
∞
∑
𝑗=1
∞
∑
𝑘=1
𝑥𝑗𝑦𝑘ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘) −𝜇𝑥𝜇𝑦
= 𝔼(𝑋𝑌) −𝔼(𝑋)𝔼(𝑌).
Joint Moment-Generating Function:
For 𝑠, 𝑡∈ℝ
𝑀𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑠𝑋+𝑡𝑌) =
∞
∑
𝑗=1
∞
∑
𝑘=1
𝑒𝑠𝑥𝑗+𝑡𝑦𝑘ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘).
Joint Characteristic Function:
For 𝑖=
√
−1 and 𝑠, 𝑡∈ℝ
𝜑𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑖𝑠𝑋+𝑖𝑡𝑌) =
∞
∑
𝑗=1
∞
∑
𝑘=1
𝑒𝑖𝑠𝑥𝑗+𝑖𝑡𝑦𝑘ℙ(𝑋= 𝑥𝑗, 𝑌= 𝑦𝑘).

Appendix B
801
Independence:
𝑋and 𝑌are independent if and only if
s ℙ(𝑋= 𝑥, 𝑌= 𝑦) = ℙ(𝑋= 𝑥)ℙ(𝑌= 𝑦).
s 𝑀𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑠𝑋+𝑡𝑌) = 𝔼(𝑒𝑠𝑋) 𝔼(𝑒𝑡𝑌) = 𝑀𝑋(𝑠)𝑀𝑌(𝑡).
s 𝜑𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑖𝑠𝑋+𝑖𝑡𝑌) = 𝔼(𝑒𝑖𝑠𝑋) 𝔼(𝑒𝑖𝑡𝑌) = 𝜑𝑋(𝑠)𝜑𝑌(𝑡).
Continuous Random Variables
Univariate Case
Let 𝑋be a continuous random variable whose values 𝑥∈ℝand let 𝑓𝑋(𝑥) be the probability
density function.
Total Probability of All Possible Values:
∫
∞
−∞
𝑓𝑋(𝑥) 𝑑𝑥= 1.
Evaluating Probability:
ℙ(𝑎≤𝑋≤𝑏) = ∫
𝑏
𝑎
𝑓𝑋(𝑥) 𝑑𝑥.
Cumulative Distribution Function:
𝐹𝑋(𝑥) = ℙ(𝑋≤𝑥) = ∫
𝑥
−∞
𝑓𝑋(𝑥) 𝑑𝑥.
Probability Density Function:
𝑓𝑋(𝑥) = 𝑑
𝑑𝑥𝐹𝑋(𝑥).
Expectation:
𝔼(𝑋) = 𝜇= ∫
∞
−∞
𝑥𝑓𝑋(𝑥) 𝑑𝑥.
Variance:
Var(𝑋) = 𝜎2 = ∫
∞
−∞
(𝑥−𝜇)2𝑓𝑋(𝑥) 𝑑𝑥= ∫
∞
−∞
𝑥2𝑓𝑋(𝑥) 𝑑𝑥−𝜇2 = 𝔼(𝑋2) −[𝔼(𝑋)]2 .
Moment-Generating Function:
𝑀𝑋(𝑡) = 𝔼
(
𝑒𝑡𝑋)
= ∫
∞
−∞
𝑒𝑡𝑥𝑓𝑋(𝑥) 𝑑𝑥, 𝑡∈ℝ.

802
Appendix B
Characteristic Function:
𝜑𝑋(𝑡) = 𝔼(𝑒𝑖𝑡𝑋) = ∫
∞
−∞
𝑒𝑖𝑡𝑥𝑓𝑋(𝑥) 𝑑𝑥,
𝑖=
√
−1 and 𝑡∈ℝ.
Probability Density Function of a Dependent Variable:
Let the random variable 𝑌= 𝑔(𝑋). If 𝑔is monotonic then the probability density function of
𝑌is
𝑓𝑌(𝑦) = 𝑓𝑋
(𝑔−1(𝑦)) ||||
𝑑
𝑑𝑦𝑔−1(𝑦)
||||
−1
where 𝑔−1 denotes the inverse function.
Bivariate Case
Let 𝑋and 𝑌be two continuous random variables whose values 𝑥∈ℝand 𝑦∈ℝ, and let
𝑓𝑋𝑌(𝑥, 𝑦) be the joint probability density function.
Total Probability of All Possible Values:
∫
∞
−∞∫
∞
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑥𝑑𝑦= ∫
∞
−∞∫
∞
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥= 1.
Joint Cumulative Distribution Function:
𝐹𝑋𝑌(𝑥, 𝑦) = ℙ(𝑋≤𝑥, 𝑌≤𝑦) = ∫
𝑥
−∞∫
𝑦
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥= ∫
𝑦
−∞∫
𝑥
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑥𝑑𝑦.
Evaluating Joint Probability:
ℙ(𝑥𝑎≤𝑋≤𝑥𝑏, 𝑦𝑎≤𝑌≤𝑦𝑏) = ∫
𝑥𝑏
𝑥𝑎∫
𝑦𝑏
𝑦𝑎
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥
= ∫
𝑦𝑏
𝑦𝑎∫
𝑥𝑏
𝑥𝑎
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑥𝑑𝑦
= 𝐹𝑋𝑌(𝑥𝑏, 𝑦𝑏) −𝐹𝑋𝑌(𝑥𝑏, 𝑦𝑎) −𝐹𝑋𝑌(𝑥𝑎, 𝑦𝑏) + 𝐹𝑋𝑌(𝑥𝑎, 𝑦𝑎).
Joint Probability Density Function:
𝑓𝑋𝑌(𝑥, 𝑦) =
𝜕2
𝜕𝑥𝜕𝑦𝐹𝑋𝑌(𝑥, 𝑦) =
𝜕2
𝜕𝑦𝜕𝑥𝐹𝑋𝑌(𝑥, 𝑦).
Marginal Probability Density Function:
𝑓𝑋(𝑥) = ∫
∞
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦,
𝑓𝑌(𝑦) = ∫
∞
−∞
𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑥.

Appendix B
803
Conditional Probability Density Function:
𝑓𝑋|𝑌(𝑥|𝑦) = 𝑓𝑋𝑌(𝑥, 𝑦)
𝑓𝑌(𝑦)
,
𝑓𝑌|𝑋(𝑦|𝑥) = 𝑓𝑋𝑌(𝑥, 𝑦)
𝑓𝑋(𝑥)
.
Conditional Expectation:
𝔼(𝑋|𝑌) = 𝜇𝑥|𝑦= ∫
∞
−∞
𝑥𝑓𝑋|𝑌(𝑥|𝑦) 𝑑𝑥,
𝔼(𝑌|𝑋) = 𝜇𝑦|𝑥= ∫
∞
−∞
𝑦𝑓𝑌|𝑋(𝑦|𝑥) 𝑑𝑦.
Conditional Variance:
Var(𝑋|𝑌) = 𝜎2
𝑥|𝑦
= 𝔼
[
(𝑋−𝜇𝑥|𝑦)2||| 𝑌
]
= ∫
∞
−∞
(𝑥−𝜇𝑥|𝑦)2𝑓𝑋|𝑌(𝑥|𝑦) 𝑑𝑥
= ∫
∞
−∞
𝑥2𝑓𝑋|𝑌(𝑥|𝑦) 𝑑𝑥−𝜇2
𝑥|𝑦
Var(𝑌|𝑋) = 𝜎2
𝑦|𝑥
= 𝔼
[
(𝑌−𝜇𝑦|𝑥)2||| 𝑋
]
= ∫
∞
−∞
(𝑦−𝜇𝑦|𝑥)2𝑓𝑌|𝑋(𝑦|𝑥) 𝑑𝑦
= ∫
∞
−∞
𝑦2𝑓𝑌|𝑋(𝑦|𝑥) 𝑑𝑦−𝜇2
𝑦|𝑥.
Covariance:
For 𝔼(𝑋) = 𝜇𝑥and 𝔼(𝑌) = 𝜇𝑦
Cov(𝑋, 𝑌) = 𝔼[(𝑋−𝜇𝑥)(𝑌−𝜇𝑦)]
= ∫
∞
−∞∫
∞
−∞
(𝑥−𝜇𝑥)(𝑦−𝜇𝑦)𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥
= ∫
∞
−∞∫
∞
−∞
𝑥𝑦𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥−𝜇𝑥𝜇𝑦
= 𝔼(𝑋𝑌) −𝔼(𝑋)𝔼(𝑌).
Joint Moment-Generating Function:
For 𝑡, 𝑠∈ℝ
𝑀𝑋𝑌(𝑠, 𝑡) = 𝔼
(
𝑒𝑠𝑋+𝑡𝑌)
= ∫
∞
−∞∫
∞
−∞
𝑒𝑠𝑥+𝑡𝑦𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥.

804
Appendix B
Joint Characteristic Function:
For 𝑖=
√
−1 and 𝑡, 𝑠∈ℝ
𝜑𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑖𝑠𝑋+𝑖𝑡𝑌) = ∫
∞
−∞∫
∞
−∞
𝑒𝑖𝑠𝑥+𝑖𝑡𝑦𝑓𝑋𝑌(𝑥, 𝑦) 𝑑𝑦𝑑𝑥.
Independence:
𝑋and 𝑌are independent if and only if
s 𝑓𝑋𝑌(𝑥, 𝑦) = 𝑓𝑋(𝑥)𝑓𝑌(𝑦).
s 𝑀𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑠𝑋+𝑡𝑌) = 𝔼(𝑒𝑠𝑋) 𝔼(𝑒𝑡𝑌) = 𝑀𝑋(𝑠)𝑀𝑌(𝑡).
s 𝜑𝑋𝑌(𝑠, 𝑡) = 𝔼(𝑒𝑖𝑠𝑋+𝑖𝑡𝑌) = 𝔼(𝑒𝑖𝑠𝑋) 𝔼(𝑒𝑖𝑡𝑌) = 𝜑𝑋(𝑠)𝜑𝑌(𝑡).
Joint Probability Density Function of Dependent Variables:
Let the random variables 𝑈= 𝑔(𝑋, 𝑌), 𝑉= ℎ(𝑋, 𝑌). If 𝑢= 𝑔(𝑥, 𝑦) and 𝑣= ℎ(𝑥, 𝑦) can be
uniquely solved for 𝑥and 𝑦in terms of 𝑢and 𝑣with solutions given by, say, 𝑥= 𝑝(𝑢, 𝑣) and
𝑦= 𝑞(𝑢, 𝑣) and the functions 𝑔and ℎhave continuous partial derivatives at all points (𝑥, 𝑦)
such that the determinant
𝐽(𝑥, 𝑦) =
||||||||||
𝜕𝑔
𝜕𝑥
𝜕𝑔
𝜕𝑦
𝜕ℎ
𝜕𝑥
𝜕ℎ
𝜕𝑦
||||||||||
= 𝜕𝑔
𝜕𝑥
𝜕ℎ
𝜕𝑦−𝜕𝑔
𝜕𝑦
𝜕ℎ
𝜕𝑥≠0
then the joint probability density function of 𝑈and 𝑉is
𝑓𝑈𝑉(𝑢, 𝑣) = 𝑓𝑋𝑌(𝑥, 𝑦) |𝐽(𝑥, 𝑦)|−1
where 𝑥= 𝑝(𝑢, 𝑣) and 𝑦= 𝑞(𝑢, 𝑣).
Properties of Expectation and Variance
Let 𝑋and 𝑌be two random variables and for constants 𝑎and 𝑏
𝔼(𝑎𝑋+ 𝑏) = 𝑎𝔼(𝑋) + 𝑏, Var(𝑎𝑋+ 𝑏) = 𝑎2Var(𝑋)
𝔼(𝑎𝑋+ 𝑏𝑌) = 𝑎𝔼(𝑋) + 𝑏𝔼(𝑌),
Var(𝑎𝑋+ 𝑏𝑌) = 𝑎2Var(𝑋) + 𝑏2Var(𝑌) + 2𝑎𝑏Cov(𝑋, 𝑌).
Properties of Moment-Generating and Characteristic Functions
If a random variable 𝑋has moments up to 𝑘th order where 𝑘is a non-negative integer, then
𝔼(𝑋𝑘) = 𝑑𝑘
𝑑𝑡𝑘𝑀𝑋(𝑡)
||||𝑡=0
= 𝑖−𝑘𝑑𝑘
𝑑𝑡𝑘𝜑𝑋(𝑡)
||||𝑡=0
where 𝑖=
√
−1.

Appendix B
805
If the bivariate random variables 𝑋and 𝑌have moments up to 𝑚+ 𝑛= 𝑘where 𝑚, 𝑛and 𝑘
are non-negative integers, then
𝔼(𝑋𝑚𝑌𝑛) =
𝑑𝑘
𝑑𝑠𝑚𝑑𝑡𝑛𝑀𝑋𝑌(𝑠, 𝑡)
||||𝑠=0,𝑡=0
= 𝑖−𝑘
𝑑𝑘
𝑑𝑠𝑚𝑑𝑡𝑛𝜑𝑋𝑌(𝑠, 𝑡)
||||𝑠=0,𝑡=0
where 𝑖=
√
−1.
Correlation Coefficient
Let 𝑋and 𝑌be two random variables with means 𝜇𝑥and 𝜇𝑦and variances 𝜎2
𝑥and 𝜎2
𝑦. The
correlation coefficient 𝜌𝑥𝑦between 𝑋and 𝑌is defined as
𝜌𝑥𝑦=
Cov(𝑋, 𝑌)
√
Var(𝑋)Var(𝑌)
=
𝔼[(𝑋−𝜇𝑥)(𝑌−𝜇𝑦)]
𝜎𝑥𝜎𝑦
.
Important information:
s 𝜌𝑥𝑦measures only the linear dependency between 𝑋and 𝑌.
s −1 ≤𝜌𝑥𝑦≤1.
s If 𝜌𝑥𝑦= 0 then 𝑋and 𝑌are uncorrelated.
s If 𝑋and 𝑌are independent then 𝜌𝑥𝑦= 0. However the converse is not true.
s If 𝑋and 𝑌are jointly normally distributed then 𝑋and 𝑌are independent if and only if
𝜌𝑋𝑌= 0.
Convolution
If 𝑋and 𝑌are independent discrete random variables with probability mass functions ℙ(𝑋=
𝑥) and ℙ(𝑌= 𝑦), respectively, then the probability mass function for 𝑍= 𝑋+ 𝑌is
ℙ(𝑍= 𝑧) =
∑
𝑥
ℙ(𝑋= 𝑥)ℙ(𝑌= 𝑧−𝑥) =
∑
𝑦
ℙ(𝑋= 𝑧−𝑦)ℙ(𝑌= 𝑦).
If 𝑋and 𝑌are independent continuous random variables with probability density functions
𝑓𝑋(𝑥) and 𝑓𝑌(𝑦), respectively, then the probability density function for 𝑍= 𝑋+ 𝑌is
𝑓𝑍(𝑧) = ∫
∞
−∞
𝑓𝑋(𝑥)𝑓𝑌(𝑧−𝑥) 𝑑𝑥= ∫
∞
−∞
𝑓𝑋(𝑧−𝑦)𝑓𝑌(𝑦) 𝑑𝑦.
Discrete Distributions
Bernoulli: A random variable 𝑋is said to follow a Bernoulli distribution, 𝑋∼Bernoulli(𝑝)
where 𝑝∈[0, 1] is the probability of success and the probability mass function is given as
𝑃(𝑋= 𝑥) = 𝑝𝑥(1 −𝑝)1−𝑥,
𝑥= 0, 1

806
Appendix B
where 𝔼(𝑋) = 𝑝and Var(𝑋) = 𝑝−𝑝2. The moment-generating function is
𝑀𝑋(𝑡) = 1 −𝑝+ 𝑝𝑒𝑡,
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) = 1 −𝑝+ 𝑝𝑒𝑖𝑡,
𝑖=
√
−1 and 𝑡∈ℝ.
Geometric: A random variable 𝑋is said to follow a geometric distribution, 𝑋∼Geometric(𝑝)
where 𝑝∈[0, 1] is the probability of success and the probability mass function is given as
ℙ(𝑋= 𝑥) = 𝑝(1 −𝑝)𝑥−1,
𝑥= 1, 2, …
where 𝔼(𝑋) = 1
𝑝and Var(𝑋) = 1 −𝑝
𝑝2 . The moment-generating function is
𝑀𝑋(𝑡) =
𝑝
1 −(1 −𝑝)𝑒𝑡,
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) =
𝑝
1 −(1 −𝑝)𝑒𝑖𝑡,
𝑖=
√
−1 and 𝑡∈ℝ.
Binomial: A random variable 𝑋is said to follow a binomial distribution, 𝑋∼Binomial(𝑛, 𝑝),
𝑝∈[0, 1] where 𝑝∈[0, 1] is the probability of success and 𝑛∈ℕ0 is the number of trials and
the probability mass function is given as
ℙ(𝑋= 𝑥) =
(
𝑛
𝑥
)
𝑝𝑥(1 −𝑝)𝑛−𝑥,
𝑥= 0, 1, 2, … , 𝑛
where 𝔼(𝑋) = 𝑛𝑝and Var(𝑋) = 𝑛𝑝(1 −𝑝). The moment-generating function is
𝑀𝑋(𝑡) = (1 −𝑝+ 𝑝𝑒𝑡)𝑛,
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) = (1 −𝑝+ 𝑝𝑒𝑖𝑡)𝑛,
𝑖=
√
−1 and 𝑡∈ℝ.
Negative Binomial: A random variable 𝑋is said to follow a negative binomial distribution,
𝑋∼NB(𝑟, 𝑝) where 𝑝∈[0, 1] is the probability of success and 𝑟is the number of successes
accumulated and the probability mass function is given as
ℙ(𝑋= 𝑥) =
(
𝑥−1
𝑟−1
)
𝑝𝑟(1 −𝑝)𝑛−𝑟,
𝑥= 𝑟, 𝑟+ 1, 𝑟+ 2, …

Appendix B
807
where 𝔼(𝑋) = 𝑟
𝑝and Var(𝑋) = 𝑟(1 −𝑝)
𝑝2
. The moment-generating function is
𝑀𝑋(𝑡) =
( 1 −𝑝
1 −𝑝𝑒𝑡
)𝑟
,
𝑡< −log 𝑝
and the corresponding characteristic function is
𝑀𝑋(𝑡) =
( 1 −𝑝
1 −𝑝𝑒𝑖𝑡
)𝑟
,
𝑖=
√
−1 and 𝑡∈ℝ.
Poisson: A random variable 𝑋is said to follow a Poisson distribution, 𝑋∼Poisson(𝜆), 𝜆> 0
with probability mass function given as
ℙ(𝑋= 𝑥) = 𝑒−𝜆𝜆𝑥
𝑥!
,
𝑥= 0, 1, 2, …
where 𝔼(𝑋) = 𝜆and Var(𝑋) = 𝜆. The moment-generating function is
𝑀𝑋(𝑡) = 𝑒𝜆(𝑒𝑡−1),
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) = 𝑒𝜆(𝑒𝑖𝑡−1),
𝑖=
√
−1 and 𝑡∈ℝ.
Continuous Distributions
Uniform: A random variable 𝑋is said to follow a uniform distribution, 𝑋∼(𝑎, 𝑏), 𝑎< 𝑏
with probability density function given as
𝑓𝑋(𝑥) =
1
𝑏−𝑎,
𝑎< 𝑥< 𝑏
where 𝔼(𝑋) = 𝑎+ 𝑏
2
and Var(𝑋) = (𝑏−𝑎)2
12
. The moment-generating function is
𝑀𝑋(𝑡) = 𝑒𝑡𝑏−𝑒𝑡𝑎
𝑡(𝑏−𝑎) ,
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) = 𝑒𝑡𝑏−𝑒𝑖𝑡𝑎
𝑖𝑡(𝑏−𝑎) ,
𝑖=
√
−1 and 𝑡∈ℝ.

808
Appendix B
Normal: A random variable 𝑋is said to follow a normal distribution, 𝑋∼(𝜇, 𝜎), 𝜇∈ℝ,
𝜎2 > 0 with probability density function given as
𝑓𝑋(𝑥) =
1
𝜎
√
2𝜋
𝑒
−1
2
( 𝑥−𝜇
𝜎
)2
,
𝑥∈ℝ
where 𝔼(𝑋) = 𝜇and Var(𝑋) = 𝜎2. The moment-generating function is
𝑀𝑋(𝑡) = 𝑒𝜇𝑡+ 1
2 𝜎2𝑡2,
𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋(𝑡) = 𝑒𝑖𝜇𝑡−1
2 𝜎2𝑡2,
𝑖=
√
−1 and 𝑡∈ℝ.
Lognormal: A random variable 𝑋is said to follow a lognormal distribution, 𝑋∼log-(𝜇, 𝜎),
𝜇∈ℝ, 𝜎2 > 0 with probability density function given as
𝑓𝑋(𝑥) =
1
𝑥𝜎
√
2𝜋
𝑒
−1
2
( log(𝑥)−𝜇
𝜎
)2
,
𝑥> 0
where 𝔼(𝑋) = 𝑒𝜇+ 1
2 𝜎2 and Var(𝑋) = (𝑒𝜎2 −1)𝑒2𝜇+𝜎2. The moment-generating function is
𝑀𝑋(𝑡) =
∞
∑
𝑛=0
𝑡𝑛
𝑛!𝑒𝑛𝜇+ 1
2 𝑛2𝜎2,
𝑡≤0
and the corresponding characteristic function is
𝜑𝑋(𝑡) =
∞
∑
𝑛=0
(𝑖𝑡)𝑛
𝑛! 𝑒𝑛𝜇+ 1
2 𝑛2𝜎2,
𝑖=
√
−1 and 𝑡∈ℝ.
Exponential: A random variable 𝑋is said to follow an exponential distribution, 𝑋∼Exp(𝜆),
𝜆> 0 with probability density function
𝑓𝑋(𝑥) = 𝜆𝑒−𝜆𝑥,
𝑥≥0
where 𝔼(𝑋) = 1
𝜆and Var(𝑋) = 1
𝜆2 . The moment-generating function is
𝑀𝑋(𝑡) =
𝜆
𝜆−𝑡,
𝑡< 𝜆
and the corresponding characteristic function is
𝜑𝑋(𝑡) =
𝜆
𝜆−𝑖𝑡,
𝑖=
√
−1 and 𝑡∈ℝ.

Appendix B
809
Gamma: A random variable 𝑋is said to follow a gamma distribution, 𝑋∼Gamma(𝛼, 𝜆),
𝛼, 𝜆> 0 with probability density function given as
𝑓𝑋(𝑥) = 𝜆𝑒−𝜆𝑥(𝜆𝑥)𝛼−1
Γ(𝛼)
,
𝑥≥0
such that
Γ(𝛼) = ∫
∞
0
𝑒−𝑥𝑥𝛼−1𝑑𝑥
where 𝔼(𝑋) = 𝛼
𝜆and Var(𝑋) = 𝛼
𝜆2 . The moment-generating function is
𝑀𝑋(𝑡) =
(
𝜆
𝜆−𝑡
)𝛼
,
𝑡< 𝜆
and the corresponding characteristic function is
𝜑𝑋(𝑡) =
(
𝜆
𝜆−𝑖𝑡
)𝛼
,
𝑖=
√
−1 and 𝑡∈ℝ.
Chi-Square: A random variable 𝑋is said to follow a chi-square distribution, 𝑋∼𝜒2(𝜈), 𝜈∈ℕ
with probability density function given as
𝑓𝑋(𝑥) =
1
2
𝜈
2 Γ
(
𝜈
2
)𝑥
𝜈
2 −1𝑒−𝑥
2 ,
𝑥≥0
such that
Γ
(𝜈
2
)
= ∫
∞
0
𝑒−𝑥𝑥
𝜈
2 −1 𝑑𝑥
where 𝔼(𝑋) = 𝜈and Var(𝑋) = 2𝜈. The moment-generating function is
𝑀𝑋(𝑡) = (1 −2𝑡)−𝜈
2 ,
−1
2 < 𝑡< 1
2
and the corresponding characteristic function is
𝑀𝑋(𝑡) = (1 −2𝑖𝑡)−𝜈
2 ,
𝑖=
√
−1 and 𝑡∈ℝ.
Bivariate Normal: The random variables 𝑋and 𝑌with means 𝜇𝑥, 𝜇𝑦, variances 𝜎2
𝑥, 𝜎2
𝑦and
correlation coefficient 𝜌𝑥𝑦∈(−1, 1) is said to follow a joint normal distribution, (𝑋, 𝑌) ∼

810
Appendix B
2 (𝝁, 𝚺) where 𝝁=
[ 𝜇𝑥
𝜇𝑦
]
and 𝚺=
[
Var(𝑋)
Cov(𝑋, 𝑌)
Cov(𝑋, 𝑌)
Var(𝑌)
]
=
[
𝜎2
𝑥
𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜌𝑥𝑦𝜎𝑥𝜎𝑦
𝜎2
𝑦
]
with
joint probability density function given as
𝑓𝑋𝑌(𝑥, 𝑦) =
1
2𝜋𝜎𝑥𝜎𝑦
√
1 −𝜌2
𝑥𝑦
𝑒
−
1
2(1−𝜌2𝑥𝑦)
[( 𝑥−𝜇𝑥
𝜎𝑥
)2
−2𝜌
( 𝑥−𝜇𝑥
𝜎𝑥
)(
𝑦−𝜇𝑦
𝜎𝑦
)
+
(
𝑦−𝜇𝑦
𝜎𝑦
)2]
, 𝑥, 𝑦∈ℝ.
The moment-generating function is
𝑀𝑋𝑌(𝑠, 𝑡) = 𝑒𝜇𝑥𝑠+𝜇𝑦𝑡+ 1
2 (𝜎2
𝑥𝑠2+2𝜌𝑥𝑦𝜎𝑥𝜎𝑦𝑠𝑡+𝜎2
𝑦𝑡2),
𝑠, 𝑡∈ℝ
and the corresponding characteristic function is
𝜑𝑋𝑌(𝑠, 𝑡) = 𝑒𝑖𝜇𝑥𝑠+𝑖𝜇𝑦𝑡−1
2 (𝜎2
𝑥𝑠2+2𝜌𝑥𝑦𝜎𝑥𝜎𝑦𝑠𝑡+𝜎2
𝑦𝑡2),
𝑖=
√
−1 and 𝑠, 𝑡∈ℝ.
Multivariate Normal: The random vector X = (𝑋1, 𝑋2, … , 𝑋𝑛) is said to follow a multivariate
normal distribution, X ∼𝑛(𝝁, 𝚺) where
𝝁=
⎡
⎢
⎢
⎢⎣
𝔼(𝑋1)
𝔼(𝑋2)
⋮
𝔼(𝑋𝑛)
⎤
⎥
⎥
⎥⎦
and 𝚺=
⎡
⎢
⎢
⎢⎣
Var(𝑋1)
Cov(𝑋1, 𝑋2) … Cov(𝑋1, 𝑋𝑛)
Cov(𝑋1, 𝑋2)
Var(𝑋2)
… Cov(𝑋2, 𝑋𝑛)
⋮
⋮
⋱
⋮
Cov(𝑋1, 𝑋𝑛) Cov(𝑋2, 𝑋𝑛) …
Var(𝑋𝑛)
⎤
⎥
⎥
⎥⎦
with probability density function given as
𝑓X(𝑥1, 𝑥2, … , 𝑥𝑛) =
1
(2𝜋)
𝑛
2 |𝚺|
1
2
𝑒−1
2 X𝑇𝚺−1X.
The moment-generating function is
𝑀X(𝑡1, 𝑡2, … , 𝑡𝑛) = 𝑒𝝁𝑇t+ 1
2 t𝑇𝚺t,
t = (𝑡1, 𝑡2, … , 𝑡𝑛)𝑇
and the corresponding characteristic function is
𝜑X(𝑡1, 𝑡2, … , 𝑡𝑛) = 𝑒𝑖𝝁𝑇t−1
2 t𝑇𝚺t,
t = (𝑡1, 𝑡2, … , 𝑡𝑛)𝑇.
Integrable and Square-Integrable Random Variables
Let 𝑋be a real-valued random variable.
s If 𝔼(|𝑋|) < ∞then 𝑋is an integrable random variable.
s If 𝔼(𝑋2) < ∞then 𝑋is a square-integrable random variable.

Appendix B
811
Convergence of Random Variables
Let 𝑋1, 𝑋2, … , 𝑋𝑛be a sequence of random variables. Then
(a) 𝑋𝑛
𝑎.𝑠
⟶𝑋converges almost surely if
ℙ
(
lim
𝑛→∞𝑋𝑛= 𝑋
)
= 1.
(b) 𝑋𝑛
𝑟
⟶𝑋converges in the 𝑟th mean, 𝑟≥1, if 𝔼(|𝑋𝑟
𝑛|) < ∞and
lim
𝑛→∞𝔼(|𝑋𝑛−𝑋|𝑟) = 0.
(c) 𝑋𝑛
𝑃
⟶𝑋converges in probability, if for all 𝜀> 0,
lim
𝑛→∞ℙ(|𝑋𝑛−𝑋| ≥𝜀) = 0.
(d) 𝑋𝑛
𝐷
⟶𝑋converges in distribution, if for all 𝑥∈ℝ,
lim
𝑛→∞ℙ(𝑋𝑛≤𝑥) = ℙ(𝑋≤𝑥).
Relationship Between Modes of Convergence
For any 𝑟≥1
{
𝑋𝑛
𝑎.𝑠
⟶𝑋
𝑋𝑛
𝑟
⟶𝑋
}
⟹
{
𝑋𝑛
𝑃
⟶𝑋
}
⟹
{
𝑋𝑛
𝐷
⟶𝑋
}
.
If 𝑟> 𝑠≥1 then
{
𝑋𝑛
𝑟
⟶𝑋
}
⟹
{
𝑋𝑛
𝑠
⟶𝑋
}
.
Dominated Convergence Theorem
If 𝑋𝑛
𝑎.𝑠
⟶𝑋and for any 𝑛∈ℕwe have |𝑋𝑛| < 𝑌for some 𝑌such that 𝔼(|𝑌|) < ∞, then
𝔼(|𝑋𝑛|) < ∞and
lim
𝑛→∞𝔼(𝑋𝑛) = 𝔼(𝑋).
Monotone Convergence Theorem
If 0 ≤𝑋𝑛≤𝑋𝑛+1 and 𝑋𝑛
𝑎.𝑠
⟶𝑋for any 𝑛∈ℕthen
lim
𝑛→∞𝔼(𝑋𝑛) = 𝔼(𝑋).

812
Appendix B
The Weak Law of Large Numbers
Let 𝑋1, 𝑋2, … , 𝑋𝑛be a sequence of independent and identically distributed random variables
with common mean 𝜇∈ℝ. Then for any 𝜀> 0,
ℙ
(
lim
𝑛→∞
||||
𝑋1 + 𝑋2 + … + 𝑋𝑛
𝑛
−𝜇
||||
≥𝜀
)
= 0.
The Strong Law of Large Numbers
Let 𝑋1, 𝑋2, … , 𝑋𝑛be a sequence of independent and identically distributed random variables
with common mean 𝜇∈ℝ. Then
ℙ
(
lim
𝑛→∞
𝑋1 + 𝑋2 + … + 𝑋𝑛
𝑛
= 𝜇
)
= 1.
The Central Limit Theorem
Let 𝑋1, 𝑋2, … , 𝑋𝑛be a sequence of independent and identically distributed random variables
with common mean 𝜇∈ℝand variance 𝜎2 > 0 and we denote the sample mean as
𝑋= 𝑋1 + 𝑋2 + … + 𝑋𝑛
𝑛
where 𝔼(𝑋) = 𝜇and Var(𝑋) = 𝜎2
𝑛. By defining
𝑍𝑛= 𝑋−𝔼(𝑋)
√
Var(𝑋)
= 𝑋−𝜇
𝜎∕
√
𝑛
then for 𝑛→∞,
lim
𝑛→∞𝑍𝑛= lim
𝑛→∞
𝑋−𝜇
𝜎∕
√
𝑛
𝐷
⟶(0, 1)
that is 𝑍𝑛follows a standard normal distribution asymptotically.

Appendix C
Differential Equations Formulae
Separable Equations
The form
𝑑𝑦
𝑑𝑥= 𝑓(𝑥)𝑔(𝑦)
has a solution
∫
1
𝑔(𝑦) 𝑑𝑦= ∫𝑓(𝑥) 𝑑𝑥.
If 𝑔(𝑦) is a linear equation and if 𝑦1 and 𝑦2 are two solutions, then 𝑦3 = 𝑎𝑦1 + 𝑏𝑦2 is also a
solution for constant 𝑎and 𝑏.
First-Order Ordinary Differential Equations
General Linear Equation: The general form of a first-order ordinary differential equation
𝑑𝑦
𝑑𝑥+ 𝑓(𝑥)𝑦= 𝑔(𝑥)
has a solution
𝑦= 𝐼(𝑥)−1
∫𝐼(𝑢)𝑔(𝑢) 𝑑𝑢+ 𝐶
where 𝐼(𝑥) = 𝑒∫𝑓(𝑥)𝑑𝑥is the integrating factor and 𝐶is a constant.
Bernoulli Differential Equation: For 𝑛≠1, the Bernoulli differential equation has the form
𝑑𝑦
𝑑𝑥+ 𝑃(𝑥)𝑦= 𝑄(𝑥)𝑦𝑛
which, by setting 𝑤=
1
𝑦𝑛−1 , can be transformed to a general linear ordinary differential equa-
tion of the form
𝑑𝑤
𝑑𝑥+ (1 −𝑛)𝑃(𝑥)𝑤= (1 −𝑛)𝑄(𝑥)

814
Appendix C
with a particular solution
𝑤= (1 −𝑛)𝐼(𝑥)−1
∫𝐼(𝑢)𝑄(𝑢) 𝑑𝑢
where 𝐼(𝑥) = 𝑒(1−𝑛) ∫𝑃(𝑥)𝑑𝑥is the integrating factor. The solution to the Bernoulli differential
equation becomes
𝑦=
{
(1 −𝑛)𝐼(𝑥)−1
∫𝐼(𝑢)𝑄(𝑢) 𝑑𝑢
}−1
𝑛−1
+ 𝐶
where 𝐶is a constant value.
Second-Order Ordinary Differential Equations
General Linear Equation: For a homogeneous equation
𝑎𝑑2𝑦
𝑑𝑥2 + 𝑏𝑑𝑦
𝑑𝑥+ 𝑐𝑦= 0
by setting 𝑦= 𝑒𝑢𝑥the differential equation has a general solution based on the characteristic
equation
𝑎𝑢2 + 𝑏𝑢+ 𝑐= 0
such that 𝑚1 and 𝑚2 are the roots of the quadratic equation, and if
s 𝑚1, 𝑚2 ∈ℝ, 𝑚1 ≠𝑚2 then 𝑦= 𝐴𝑒𝑚1𝑥+ 𝐵𝑒𝑚2𝑥
s 𝑚1, 𝑚2 ∈ℝ, 𝑚1 = 𝑚2 = 𝑚then 𝑦= 𝑒𝑚𝑥(𝐴+ 𝐵𝑥)
s 𝑚1, 𝑚2 ∈ℂ, 𝑚1 = 𝛼+ 𝑖𝛽, 𝑚2 = 𝛼−𝑖𝛽then 𝑦= 𝑒𝛼𝑥[𝐴cos(𝛽𝑥) + 𝐵sin(𝛽𝑥)]
where 𝐴, 𝐵are constants.
Cauchy–Euler Equation: For a homogeneous equation
𝑎𝑥2 𝑑2𝑦
𝑑𝑥2 + 𝑏𝑥𝑑𝑦
𝑑𝑥+ 𝑐𝑦= 0
by setting 𝑦= 𝑥𝑢the Cauchy–Euler equation has a general solution based on the characteristic
equation
𝑎𝑢2 + (𝑏−𝑎)𝑢+ 𝑐= 0
such that 𝑚1 and 𝑚2 are the roots of the quadratic equation, and if
s 𝑚1, 𝑚2 ∈ℝ, 𝑚1 ≠𝑚2 then 𝑦= 𝐴𝑥𝑚1 + 𝐵𝑥𝑚2
s 𝑚1, 𝑚2 ∈ℝ, 𝑚1 = 𝑚2 = 𝑚then 𝑦= 𝑥𝑚(𝐴+ 𝐵log 𝑥)
s 𝑚1, 𝑚2 ∈ℂ, 𝑚1 = 𝛼+ 𝑖𝛽, 𝑚2 = 𝛼−𝑖𝛽then 𝑦= 𝑥𝛼[𝐴cos(𝛽log 𝑥) + 𝐵sin(𝛽log 𝑥)]
where 𝐴, 𝐵are constants.

Appendix C
815
Variation of Parameters: For a general non-homogeneous second-order differential equation
𝑎(𝑥)𝑑2𝑦
𝑑𝑥2 + 𝑏(𝑥)𝑑𝑦
𝑑𝑥+ 𝑐(𝑥) = 𝑓(𝑥)
has the solution
𝑦= 𝑦𝑐+ 𝑦𝑝
where 𝑦𝑐, the complementary function, satisfies the homogeneous equation
𝑎(𝑥)𝑑2𝑦𝑐
𝑑𝑥2 + 𝑏(𝑥)𝑑𝑦𝑐
𝑑𝑥+ 𝑐(𝑥) = 0
and 𝑦𝑝, the particular integral, satisfies
𝑎(𝑥)
𝑑2𝑦𝑝
𝑑𝑥2 + 𝑏(𝑥)
𝑑𝑦𝑝
𝑑𝑥+ 𝑐(𝑥) = 𝑓(𝑥).
Let 𝑦𝑐= 𝐶1𝑦(1)
𝑐(𝑥) + 𝐶2𝑦(2)
𝑐(𝑥) where 𝐶1 and 𝐶2 are constants, then the particular solution to
the non-homogeneous second-order differential equation is
𝑦𝑝= −𝑦(1)
𝑐(𝑥) ∫
𝑦(2)
𝑐(𝑥)𝑓(𝑥)
𝑎(𝑥)𝑊(𝑦(1)
𝑐(𝑥), 𝑦(2)
𝑐(𝑥))
𝑑𝑥+ 𝑦(2)
𝑐(𝑥) ∫
𝑦(1)
𝑐(𝑥) 𝑓(𝑥)
𝑎(𝑥)𝑊(𝑦(1)
𝑐(𝑥), 𝑦(2)
𝑐(𝑥))
𝑑𝑥
where 𝑊(𝑦(1)
𝑐(𝑥), 𝑦(2)
𝑐(𝑥)) is the Wronskian defined as
𝑊(𝑦(1)
𝑐(𝑥), 𝑦(2)
𝑐(𝑥)) =
||||||||||
𝑦(1)
𝑐(𝑥)
𝑦(2)
𝑐(𝑥)
𝑑
𝑑𝑥𝑦(1)
𝑐(𝑥)
𝑑
𝑑𝑥𝑦(2)
𝑐(𝑥)
||||||||||
= 𝑦(1)
𝑐(𝑥) 𝑑
𝑑𝑥𝑦(2)
𝑐(𝑥) −𝑦(2)
𝑐(𝑥) 𝑑
𝑑𝑥𝑦(1)
𝑐(𝑥) ≠0.
Homogeneous Heat Equations
Initial Value Problem on an Infinite Interval: The diffusion equation of the form
𝜕𝑢
𝜕𝑡= 𝛼𝜕2𝑢
𝜕𝑥2 ,
𝛼> 0,
−∞< 𝑥< ∞,
𝑡> 0
with initial condition 𝑢(𝑥, 0) = 𝑓(𝑥) has a solution
𝑢(𝑥, 𝑡) =
1
2
√
𝜋𝛼𝑡∫
∞
−∞
𝑓(𝑧)𝑒−(𝑥−𝑧)2
4𝛼𝑡𝑑𝑧.

816
Appendix C
Initial Value Problem on a Semi-Infinite Interval: The diffusion equation of the form
𝜕𝑢
𝜕𝑡= 𝛼𝜕2𝑢
𝜕𝑥2 ,
𝛼> 0,
0 ≤𝑥< ∞,
𝑡> 0
with
s initial condition 𝑢(𝑥, 0) = 𝑓(𝑥) and boundary condition 𝑢(0, 𝑡) = 0 has a solution
𝑢(𝑥, 𝑡) =
1
2
√
𝜋𝛼𝑡∫
∞
0
𝑓(𝑧)
[
𝑒−(𝑥−𝑧)2
4𝛼𝑡
−𝑒−(𝑥+𝑧)2
4𝛼𝑡
]
𝑑𝑧
s initial condition 𝑢(𝑥, 0) = 𝑓(𝑥) and boundary condition 𝑢𝑥(0, 𝑡) = 0 has a solution
𝑢(𝑥, 𝑡) =
1
2
√
𝜋𝛼𝑡∫
∞
0
𝑓(𝑧)
[
𝑒−(𝑥−𝑧)2
4𝛼𝑡
+ 𝑒−(𝑥+𝑧)2
4𝛼𝑡
]
𝑑𝑧
s initial condition 𝑢(𝑥, 0) = 0 and boundary condition 𝑢(0, 𝑡) = 𝑔(𝑡) has a solution
𝑢(𝑥, 𝑡) =
𝑥
2
√
𝜋𝛼∫
𝑡
0
1
√
𝑡−𝑤
𝑔(𝑤)𝑒−
𝑥2
4𝛼(𝑡−𝑤) 𝑑𝑤.
Stochastic Differential Equations
Suppose that 𝑋𝑡, 𝑌𝑡and 𝑍𝑡are It¯o processes satisfying the following stochastic differential
equations:
𝑑𝑋𝑡= 𝜇(𝑋𝑡, 𝑡)𝑑𝑡+ 𝜎(𝑋𝑡, 𝑡)𝑑𝑊𝑥
𝑡
𝑑𝑌𝑡= 𝜇(𝑌𝑡, 𝑡)𝑑𝑡+ 𝜎(𝑌𝑡, 𝑡))𝑑𝑊𝑦
𝑡
𝑑𝑍𝑡= 𝜇(𝑍𝑡, 𝑡)𝑑𝑡+ 𝜎(𝑍𝑡, 𝑡)𝑑𝑊𝑧
𝑡
where 𝑊𝑥
𝑡, 𝑊𝑦
𝑡and 𝑊𝑧
𝑡are standard Wiener processes.
Reciprocal:
𝑑
(
1
𝑋𝑡
)
(
1
𝑋𝑡
) = −𝑑𝑋𝑡
𝑋𝑡
+
(𝑑𝑋𝑡
𝑋𝑡
)2
.
Product:
𝑑(𝑋𝑡𝑌𝑡)
𝑋𝑡𝑌𝑡
= 𝑑𝑋𝑡
𝑋𝑡
+ 𝑑𝑌𝑡
𝑌𝑡
+ 𝑑𝑋𝑡
𝑋𝑡
𝑑𝑌𝑡
𝑌𝑡
.

Appendix C
817
Quotient:
𝑑
(𝑋𝑡
𝑌𝑡
)
(𝑋𝑡
𝑌𝑡
) = 𝑑𝑋𝑡
𝑋𝑡
−𝑑𝑌𝑡
𝑌𝑡
−𝑑𝑋𝑡
𝑋𝑡
𝑑𝑌𝑡
𝑌𝑡
+
(𝑑𝑌𝑡
𝑌𝑡
)2
.
Product and Quotient I:
𝑑
(𝑋𝑡𝑌𝑡
𝑍𝑡
)
(𝑋𝑡𝑌𝑡
𝑍𝑡
) = 𝑑𝑋𝑡
𝑋𝑡
+ 𝑑𝑌𝑡
𝑌𝑡
−𝑑𝑍𝑡
𝑍𝑡
+ 𝑑𝑋𝑡
𝑋𝑡
𝑑𝑌𝑡
𝑌𝑡
−𝑑𝑋𝑡
𝑋𝑡
𝑑𝑍𝑡
𝑍𝑡
−𝑑𝑌𝑡
𝑌𝑡
𝑑𝑍𝑡
𝑍𝑡
+
(𝑑𝑍𝑡
𝑍𝑡
)2
.
Product and Quotient II:
𝑑
( 𝑋𝑡
𝑌𝑡𝑍𝑡
)
( 𝑋𝑡
𝑌𝑡𝑍𝑡
) = 𝑑𝑋𝑡
𝑋𝑡
−𝑑𝑌𝑡
𝑌𝑡
−𝑑𝑍𝑡
𝑍𝑡
−𝑑𝑋𝑡
𝑋𝑡
𝑑𝑌𝑡
𝑌𝑡
−𝑑𝑋𝑡
𝑋𝑡
𝑑𝑍𝑡
𝑍𝑡
+ 𝑑𝑌𝑡
𝑌𝑡
𝑑𝑍𝑡
𝑍𝑡
.
Black–Scholes Model
Black–Scholes Equation (Continuous Dividend Yield): At time 𝑡, let the asset price 𝑆𝑡follow
a geometric Brownian motion
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility parameter
and 𝑊𝑡is a standard Wiener process. For a European-style derivative 𝑉(𝑆𝑡, 𝑡) written on the
asset 𝑆𝑡, it satisfies the Black–Scholes equation with continuous dividend yield
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑆2
𝑡
𝜕2𝑉
𝜕𝑆2
𝑡
+ (𝑟−𝐷)𝑆𝑡
𝜕𝑉
𝜕𝑆𝑡
−𝑟𝑉(𝑆𝑡, 𝑡) = 0
where 𝑟is the risk-free interest rate. The parameters 𝜇, 𝑟, 𝐷and 𝜎can be either constants,
deterministic functions or stochastic processes.
European Options: For a European option having the payoff
Ψ(𝑆𝑇) = max{𝛿(𝑆𝑇−𝐾), 0}
where 𝛿∈{−1, 1}, 𝐾is the strike price and 𝑇is the option expiry time, and if 𝑟, 𝐷and 𝜎are
constants the European option price at time 𝑡< 𝑇is
𝑉(𝑆𝑡, 𝑡; 𝐾, 𝑇) = 𝛿𝑆𝑡𝑒−𝐷(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟(𝑇−𝑡)Φ(𝛿𝑑−)

818
Appendix C
where 𝑑± =
log(𝑆𝑡∕𝐾) + (𝑟−𝐷± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(⋅) is the cumulative distribution func-
tion of a standard normal.
Reflection Principle: If 𝑉(𝑆𝑡, 𝑡) is a solution of the Black–Scholes equation then for a constant
𝐵> 0, the function
𝑈(𝑆𝑡, 𝑡) =
(𝑆𝑡
𝐵
)2𝛼
𝑉
(
𝐵2
𝑆𝑡
, 𝑡
)
,
𝛼= 1
2
(
1 −𝑟−𝐷
1
2𝜎2
)
also satisfies the Black–Scholes equation.
Black Model
Black Equation: At time 𝑡, let the asset price 𝑆𝑡follow a geometric Brownian motion
𝑑𝑆𝑡
𝑆𝑡
= (𝜇−𝐷)𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝐷is the continuous dividend yield, 𝜎is the volatility parameter
and 𝑊𝑡is a standard Wiener process. Consider the price of a futures contract maturing at time
𝑇> 𝑡on the asset 𝑆𝑡as
𝐹(𝑡, 𝑇) = 𝑆𝑡𝑒(𝑟−𝐷)(𝑇−𝑡)
where 𝑟is the risk-free interest rate. For a European option on futures 𝑉(𝐹(𝑡, 𝑇), 𝑡) written on
a futures contract 𝐹(𝑡, 𝑇), it satisfies the Black equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝐹(𝑡, 𝑇)2 𝜕2𝑉
𝜕𝐹2 −𝑟𝑉(𝐹(𝑡, 𝑇), 𝑡) = 0.
The parameters 𝜇, 𝑟, 𝐷and 𝜎can be either constants, deterministic functions or stochastic
processes.
European Options on Futures: For a European option on futures having the payoff
Ψ(𝐹(𝑇, 𝑇)) = max{𝛿(𝐹(𝑇, 𝑇) −𝐾), 0}
where 𝛿∈{−1, 1}, 𝐾is the strike price and 𝑇is the option expiry time, and if 𝑟and 𝜎are
constants then the price of a European option on futures at time 𝑡< 𝑇is
𝑉(𝐹(𝑡, 𝑇), 𝑡; 𝐾, 𝑇) = 𝛿𝑒−𝑟(𝑇−𝑡) [𝐹(𝑡, 𝑇)Φ(𝛿𝑑+) −𝐾Φ(𝛿𝑑−)]
where 𝑑± =
log (𝐹(𝑡, 𝑇)∕𝐾) ± 1
2𝜎2(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(⋅) is the cumulative distribution function of
a standard normal.

Appendix C
819
Reflection Principle: If 𝑉(𝐹(𝑡, 𝑇), 𝑡) is a solution of the Black equation then for a constant
𝐵> 0 the function
𝑈(𝐹(𝑡, 𝑇), 𝑡) = 𝐹(𝑡, 𝑇)
𝐵
𝑉
(
𝐵2
𝐹(𝑡, 𝑇), 𝑡
)
also satisfies the Black equation.
Garman–Kohlhagen Model
Garman–Kohlhagen Equation: At time 𝑡, let the foreign-to-domestic exchange rate 𝑋𝑡follow
a geometric Brownian motion
𝑑𝑋𝑡
𝑋𝑡
= 𝜇𝑑𝑡+ 𝜎𝑑𝑊𝑡
where 𝜇is the drift parameter, 𝜎is the volatility parameter and 𝑊𝑡is a standard Wiener pro-
cess. For a European-style derivative 𝑉(𝑋𝑡, 𝑡) which depends on 𝑋𝑡, it satisfies the Garman–
Kohlhagen equation
𝜕𝑉
𝜕𝑡+ 1
2𝜎2𝑋2
𝑡
𝜕2𝑉
𝜕𝑋2
𝑡
+ (𝑟𝑑−𝑟𝑓)𝑋𝑡
𝜕𝑉
𝜕𝑋𝑡
−𝑟𝑑𝑉(𝑋𝑡, 𝑡) = 0
where 𝑟𝑑and 𝑟𝑓are the domestic and foreign currencies’ risk-free interest rates. The parame-
ters 𝜇, 𝑟𝑑, 𝑟𝑓and 𝜎can be either constants, deterministic functions or stochastic processes.
European Options: For a European option having the payoff
Ψ(𝑋𝑇) = max{𝛿(𝑋𝑇−𝐾), 0}
where 𝛿∈{−1, 1}, 𝐾is the strike price and 𝑇is the option expiry time, and if 𝑟𝑑, 𝑟𝑓and 𝜎are
constants then the European option price (domestic currency in one unit of foreign currency)
at time 𝑡< 𝑇is
𝑉(𝑋𝑡, 𝑡; 𝐾, 𝑇) = 𝛿𝑋𝑡𝑒−𝑟𝑓(𝑇−𝑡)Φ(𝛿𝑑+) −𝛿𝐾𝑒−𝑟𝑑(𝑇−𝑡)Φ(𝛿𝑑−)
where 𝑑± =
log(𝑋𝑡∕𝐾) + (𝑟𝑑−𝑟𝑓± 1
2𝜎2)(𝑇−𝑡)
𝜎
√
𝑇−𝑡
and Φ(⋅) is the cumulative distribution
function of a standard normal.
Reflection Principle: If 𝑉(𝑋𝑡, 𝑡) is a solution of the Garman–Kohlhagen equation then for a
constant 𝐵> 0, the function
𝑈(𝑋𝑡, 𝑡) =
(𝑋𝑡
𝐵
)2𝛼
𝑉
(
𝐵2
𝑋𝑡
, 𝑡
)
,
𝛼= 1
2
(
1 −
𝑟𝑑−𝑟𝑓
1
2𝜎2
)
also satisfies the Garman–Kohlhagen equation.


Bibliography
Abramovitz, M. and Stegun, I.A. (1970). Handbook of Mathematical Functions: with Formulas, Graphs
and Mathematical Tables. Dover Publications, New York.
Barlow, M.T. (2002). A diffusion model for electricity prices. Mathematical Finance, 12(4), pp. 287–298.
Baz, J. and Chacko, G. (2004). Financial Derivatives: Pricing, Applications and Mathematics. Cam-
bridge University Press, Cambridge.
Bernard, C. and Cui, Z. (2011). Pricing of timer options. Journal of Computational Finance, 15(1),
pp. 69–104.
Black, F. (1975). Fact and fantasy in the use of options. Financial Analysts Journal, Jul/Aug, pp. 36–72.
Black, F. and Scholes, M. (1973). The pricing of options and corporate liabilities. Journal of Political
Economy, 81, pp. 637–654.
Bos, M. and Vandermark, S. (2002). Finessing fixed dividends. Risk Magazine, 15(9).
Bossu, S. (2014). Advanced Equity Derivatives, Volatility and Correlation. John Wiley and Sons, Hobo-
ken, NJ.
Bossu, S. and Henrotte, P. (2012). An Introduction to Equity Derivatives: Theory and Practice, 2nd edn.
John Wiley and Sons, Chichester, UK.
Boyle, P.P. (1988). A lattice framework for option pricing with two state variables. Journal of Financial
and Quantitative Analysis, 23(1), pp. 1–12.
Brenner, M. and Subrahmanyam, M.G. (1988). A simple formula to compute the implied standard devi-
ation. Financial Analyst Journal, 5, pp. 80–83.
Breze´zniak, Z. and Zastawniak, T. (1999). Basic Stochastic Processes. Springer-Verlag, Berlin.
Capi´nski, M., Kopp, E. and Traple, J. (2012). Stochastic Calculus for Finance. Cambridge University
Press, Cambridge.
Carr, P. and Lee, R. (2010). Volatility derivatives. Annual Review of Financial Economics, 1, pp. 319–339.
Carr, P. and Sun, J. (2007). A new approach for option pricing under stochastic volatility. Review of
Derivatives Research, 10, pp. 87–150.
Chambers, D.R. and Nawalkha, S.J. (2001). An improved approach to computing implied volatility. The
Financial Review, 38, pp. 89–100.
Chance, D.M. (1996). Leap into the unknown. Risk, 6, pp. 60–66.
Chance, D.M. (1996). A generalized simple formula to compute the implied volatility. The Financial
Review, 4, pp. 859–867.
Chin, E., Nel, D. and ´Olafsson, S. (2014). Problems and Solutions in Mathematical Finance, Volume 1:
Stochastic Calculus. John Wiley and Sons, Chichester, UK.
Clewlow, S. and Strickland, C. (1999). Valuing energy options in a one factor model fitted to forward
prices. Working Paper, School of Finance and Economics, University of Technology, Sydney, Aus-
tralia.

822
Bibliography
Cont, R. and Tankov, P. (2003). Financial Modelling with Jump Processes. Chapman and Hall/CRC,
London.
Conze, A. and Viswanathan (1991). Path dependent options: The case of lookback options. The Journal
of Finance, XLVI(5), pp. 1893–1907.
Corrado, C.J. and Miller, T.W. Jr. (1994). A note on a simple, accurate formula to compute implied
standard deviations. Journal of Banking & Finance, 20, pp. 595–603.
Cox, J.C. (1996). The constant elasticity of variance option pricing model. The Journal of Portfolio
Management, Special Issue, pp. 15–17.
Cox, J.C., Ingersoll, J.E. and Ross, S.A. (1985). A theory of the term structure of interest rates. Econo-
metrica, 53, pp. 385–407.
Curran, M. (1994). Valuing Asian and portfolio options by conditioning on the geometric mean price.
Management Science, 40(12), pp. 1705–1711.
Dai, M. (2000). A closed-form solution for perpetual American floating strike lookback options. Journal
of Computational Finance, 4(2), pp. 63–68.
Demeterfi, K., Derman, E., Kamal, M. and Zou, J. (1999). More than you ever wanted to know about
volatility swaps. Quantitative Strategies Research Notes, Goldman Sachs.
Dupire, B. (2004). Pricing with a smile. Risk, pp. 1–10.
Fouque, J., Papanicolaou, G., Sircar, R. and Sølna, K. (2011). Multiscale Stochastic Volatility for Equity,
Interest Rate, and Credit Derivatives. Cambridge University Press, Cambridge.
Girsanov, I. (1960). On transforming a certain class of stochastic processes by absolutely
continuous substitution of measures. SIAM Theory of Probability and Applications, 5(3),
pp. 285–301.
Gradshteyn, I.S. and Ryzhik, I.M. (1980). Table of Integrals, Series and Products, A. Jeffrey (ed.). Aca-
demic Press, New York.
Grimmett, G. and Strizaker, D. (2001). Probability and Random Processes, 3rd edn. Oxford University
Press, Oxford.
Hallerbach, W.G. (2004). An improved estimator for Black–Scholes–Merton implied volatility. ERIM
Report Series Research in Management, ERS-2004-054-F&A, Erasmus Universiteit Rotterdam.
Haug, E.G. (2007). The Complete Guide to Option Pricing Formulas, 2nd edn. McGraw-Hill Profes-
sional, New York.
Henderson, V. and Wojakowski, R. (2002). On the equivalence of floating- and fixed-strike Asian options.
Journal of Applied Probability, 39(2), pp. 391–394.
Heston, S.L. (1993). A closed-form solution for options with stochastic volatility with applications to
bond and currency options. The Review of Financial Studies, 6(2), pp. 327–343.
Howison, S., Rafailidis, A. and Rasmussen, H. (2004). On the pricing and hedging of volatility deriva-
tives. Applied Mathematical Finance, 11, pp. 317–348.
Hsu, Y.L., Lin, T.I. and Lee, C.F. (2008). Constant elasticity of variance (CEV) option pricing
model: Integration and detailed derivation. Mathematics and Computers in Simulation, 79(1),
pp. 60–71.
Hull, J. (2014). Options, Futures, and Other Derivatives, 9th edn. Prentice Hall, Englewood Cliffs, NJ.
Hull, J. and White, A. (2003). The pricing of options on assets with stochastic volatilities. The Journal
of Finance, 42(2), pp. 281–300.
It¯o, K. (1951). On stochastic differential equations: Memoirs. American Mathematical Society, 4, pp. 1–
51.
Joshi, M. (2008). The Concepts and Practice of Mathematical Finance, 2nd edn. Cambridge University
Press, Cambridge.
Joshi, M. (2011). More Mathematical Finance. Pilot Whale Press, Melbourne.
Kamrad, B. and Ritchken, P. (1991). Multinomial approximating models for options with k state vari-
ables. Management Science, 37(12), pp. 1640–1652.
Karatzas, I. and Shreve, S.E. (2004). Brownian Motion and Stochastic Calculus, 2nd edn. Springer-
Verlag, Berlin.

Bibliography
823
Knoblock, J. (1988). Xunzi, A Translation and Study of the Complete Works, Volume I, Books 1–6, Stan-
ford University Press, Stanford, CA.
Kou, S.G. (2002). A jump-diffusion model for option pricing. Management Science, 48, pp. 1086–
1101.
Kwok, Y.K. (2008). Mathematical Models of Financial Derivatives, 2nd edn. Springer-Verlag, Berlin.
Leland, H.E. (1985). Option pricing and replication with transactions costs. The Journal of Finance,
40(5), pp. 1283–1301.
Levy, E. (1992). Pricing European average rate currency options. Journal of International Money and
Finance, 11, pp. 474–491.
Li, S. (2003). The estimation of implied volatility from the Black–Scholes model: Some new formulas
and their applications. Discussion Papers in Economics, Finance and International Competitiveness,
No. 14, Queensland University of Technology, Australia.
Li, S. (2005). A new formula for computing implied volatility. Applied Mathematics and Computation,
170(1), pp. 611–625.
Li, M. and Mercurio, F. (2013). Closed-form approximation of timer option prices under general stochas-
tic volatility models. MPRA Paper, No. 47465.
Maller, R.A., M¨uller, G. and Szimayer, A. (2009). Ornstein–Uhlenbeck processes and extensions. Hand-
book of Financial Time Series. Springer-Verlag, Berlin, pp. 421–437.
Manaster, S. and Koehler, G. (1982). The calculation of implied volatility from the Black–Scholes model:
A note. The Journal of Finance, 38(1), pp. 227–230.
Marsaglia, G. (2004). Evaluating the normal distribution. Journal of Statistical Software, 11(4), pp. 1–11.
Merton, R. (1973). The theory of rational option pricing. Bell Journal of Economics and Management
Science, 4, pp. 141–183.
Merton, R. (1976). Option pricing when underlying stock returns are discontinuous. Journal of Financial
Economics, 3, pp. 125–144.
Musiela, M. and Rutkowski, M. (2007). Martingale Methods in Financial Modelling, 2nd edn. Springer-
Verlag, Berlin.
Nielsen, J.A. and Sandmann, K. (2003). Pricing bounds on Asian options. The Journal of Financial
Quantitative Analysis, 38(2), pp. 449–473.
Øksendal, B. (2003). Stochastic Differential Equations: An Introduction with Applications, 6th edn.
Springer-Verlag, Berlin.
Rabinovitch, R. (1989). Pricing stock and bond options when the default-free rate is stochastic. Journal
of Financial and Quantitative Analysis, 24(4), pp. 447–457.
Rebonato, R. (2004). Volatility and Correlation. John Wiley and Sons, Chichester, UK.
Renault, E. and Touzi, N. (1996). Option hedging and implied volatilities in a stochastic volatility model.
Mathematical Finance, 6(4), pp. 279–302.
Rice, J.A. (2007). Mathematical Statistics and Data Analysis, 3rd edn. Duxbury Advanced Series.
Brooks/Cole.
Rogers, L.C.G. and Shi, Z. (1995). The value of an Asian option. Journal of Applied Probability, 32,
pp. 1077–1088.
Romano, M. and Touzi, N. (1997). Contingent claims and market completeness in a stochastic volatility
model. Mathematical Finance, 7(4), pp. 399–410.
Ross, S. (2002). A First Course in Probability, 6th edn. Prentice Hall, Englewood Cliffs, NJ.
Shreve, S.E. (2005). Stochastic Calculus for Finance, Volume I: The Binomial Asset Pricing Models.
Springer-Verlag, New York.
Shreve, S.E. (2008). Stochastic Calculus for Finance, Volume II: Continuous-Time Models. Springer-
Verlag, New York.
Stulz, R.M. (1982). Options on the minimum or the maximum of two risky assets: Analysis and appli-
cations. Journal of Financial Economics, 10, pp. 161–185.
Turnbull, S.M. and Wakeman L.M. (1991). A quick algorithm for pricing European average options.
Journal of Financial and Quantitative Methods, 26(3), pp. 377–389.

824
Bibliography
Whalley, A.E. and Wilmott, P. (1997). An asymptotic analysis of an optimal hedging model for option
pricing with transaction costs. Mathematical Finance, 7(3), pp. 307–324.
Wilmott, P. (1994). Discrete charms. Risk Magazine, 7(3), pp. 48–51.
Wilmott, P. (2006). Paul Wilmott on Quantitative Finance, 2nd edn. John Wiley and Sons, Chichester,
UK.
Wilmott, P., Dewynne, J. and Howison, S. (1993). Option Pricing: Mathematical Models and Computa-
tion. Oxford Financial Press, Oxford.

Notation
SET NOTATION
∈
is an element of
∉
is not an element of
Ω
sample space
ℰ
universal set
∅
empty set
𝐴
subset of Ω
𝐴𝑐
complement of set 𝐴
|𝐴|
cardinality of 𝐴
ℕ
set of natural numbers, {1, 2, 3, …}
ℕ0
set of natural numbers including zero, {0, 1, 2, …}
ℤ
set of integers, {0, ±1, ±2, ±3, …}
ℤ+
set of positive integers, {1, 2, 3, …}
ℝ
set of real numbers
ℝ+
set of positive real numbers, {𝑥∈ℝ: 𝑥> 0}
ℂ
set of complex numbers
𝐴× 𝐵
cartesian product of sets 𝐴and 𝐵, 𝐴× 𝐵= {(𝑎, 𝑏) : 𝑎∈𝐴, 𝑏∈𝐵}
𝑎∼𝑏
𝑎is equivalent to 𝑏
⊆
subset
⊂
proper subset
∩
intersection
∪
union
⧵
difference
△
symmetric difference
sup
supremum or least upper bound
inf
infimum or greatest lower bound
[𝑎, 𝑏]
the closed interval {𝑥∈ℝ: 𝑎≤𝑥≤𝑏}
[𝑎, 𝑏)
the interval {𝑥∈ℝ: 𝑎≤𝑥< 𝑏}
(𝑎, 𝑏]
the interval {𝑥∈ℝ: 𝑎< 𝑥≤𝑏}
(𝑎, 𝑏)
the open interval {𝑥∈ℝ: 𝑎< 𝑥< 𝑏}
ℱ, 𝒢, ℋ
𝜎-algebra (or 𝜎-fields)

826
Notation
MATHEMATICAL NOTATION
𝑥+
max{𝑥, 0}
𝑥−
min{𝑥, 0}
⌊𝑥⌋
largest integer not greater than or equal to 𝑥, max{𝑚∈ℤ|𝑚≤𝑥}
⌈𝑥⌉
smallest integer greater than or equal to 𝑥, min{𝑛∈ℤ|𝑛≥𝑥}
𝑥∨𝑦
max{𝑥, 𝑦}
𝑥∧𝑦
min{𝑥, 𝑦}
𝑖
√
−1
∞
infinity
∃
there exists
∃!
there exists a unique
∀
for all
≈
approximately equal to
𝑝⟹𝑞
𝑝implies 𝑞
𝑝⟸𝑞
𝑝is implied by 𝑞
𝑝⟺𝑞
𝑝implies and is implied by 𝑞
𝑓: 𝑋↦𝑌
𝑓is a function where every element of 𝑋has an image in 𝑌
𝑓(𝑥)
the value of the function 𝑓at 𝑥
lim
𝑥→𝑎𝑓(𝑥)
limit of 𝑓(𝑥) as 𝑥tends to 𝑎
𝛿𝑥, Δ𝑥
increment of 𝑥
𝑓−1(𝑥)
the inverse function of the function 𝑓(𝑥)
𝑓′(𝑥), 𝑓′′(𝑥)
first and second-order derivative of the function 𝑓(𝑥)
𝑑𝑦
𝑑𝑥, 𝑑2𝑦
𝑑𝑥2
first and second-order derivative of 𝑦with respect to 𝑥
∫𝑦𝑑𝑥, ∫
𝑏
𝑎
𝑦𝑑𝑥
the indefinite and definite integral of 𝑦with respect to 𝑥
𝜕𝑓
𝜕𝑥𝑖
, 𝜕2𝑓
𝜕𝑥2
𝑖
first and second-order partial derivative of 𝑓with respect to 𝑥𝑖
where 𝑓is a function on (𝑥1, 𝑥2, … , 𝑥𝑛)
𝜕2𝑓
𝜕𝑥𝑖𝜕𝑥𝑗
second-order partial derivative of 𝑓with respect to 𝑥𝑖and 𝑥𝑗
where 𝑓is a function on (𝑥1, 𝑥2, … , 𝑥𝑛)
log𝑎𝑥
logarithm of 𝑥to the base of 𝑎
log 𝑥
natural logarithm of 𝑥
𝑛
∑
𝑖=1
𝑎𝑖
𝑎1 + 𝑎2 + … + 𝑎𝑛
𝑛
∏
𝑖=1
𝑎𝑖
𝑎1 × 𝑎2 × … × 𝑎𝑛
|𝑎|
modulus of 𝑎
(
𝑛√
𝑎
)𝑚
𝑎
𝑚
𝑛
𝑛!
𝑛factorial
(
𝑛
𝑘
)
𝑛!
𝑘!(𝑛−𝑘)! for 𝑛, 𝑘∈ℤ+

Notation
827
𝛿(𝑥)
Dirac delta function
𝐻(𝑥)
Heaviside step function
Γ(𝑡)
gamma function
𝐵(𝑥, 𝑦)
beta function
a
a vector a
|a|
magnitude of a vector a
a ⋅b
scalar or dot product of vectors a and b
a × b
vector or cross product of vectors a and b
M
a matrix M
M𝑇
transpose of a matrix M
M−1
inverse of a square matrix M
|M|
determinant of a square matrix M
PROBABILITY NOTATION
𝐴, 𝐵, 𝐶
events
1I𝐴
indicator of the event 𝐴
ℙ, ℚ
probability measures
ℙ(𝐴)
probability of event 𝐴
ℙ(𝐴|𝐵)
probability of event A conditional on event 𝐵
𝑋, 𝑌, 𝑍
random variables
X, Y, Z
random vectors
𝑃(𝑋= 𝑥)
probability mass function of a discrete random variable 𝑋
𝑓𝑋(𝑥)
probability density function of a continuous random variable
𝑋
𝐹𝑋(𝑥), ℙ(𝑋≤𝑥)
cumulative distribution function of random variable 𝑋
𝑀𝑋(𝑡)
moment-generating function of a random variable 𝑋
𝜑𝑋(𝑡)
characteristic function of a random variable 𝑋
𝑃(𝑋= 𝑥, 𝑌= 𝑦)
joint probability mass function of discrete variables 𝑋and 𝑌
𝑓𝑋𝑌(𝑥, 𝑦)
joint probability density function of continuous random vari-
ables 𝑋and 𝑌
𝐹𝑋𝑌(𝑥, 𝑦), ℙ(𝑋≤𝑥, 𝑌≤𝑦)
joint cumulative distribution function of random variables 𝑋
and 𝑌
𝑀𝑋𝑌(𝑠, 𝑡)
joint moment generating function of random variables 𝑋and
𝑌
𝜑𝑋𝑌(𝑠, 𝑡)
joint characteristic function of random variables 𝑋and 𝑌
𝑝(𝑥, 𝑡; 𝑦, 𝑇)
transition probability density of 𝑦at time 𝑇starting at time 𝑡
at point 𝑥
∼
is distributed as
≁
is not distributed as
∻
is approximately distributed as
𝑎.𝑠
⟶
converges almost surely
𝑟
⟶
converges in the 𝑟-th mean

828
Notation
𝑃
⟶
converges in probability
𝐷
⟶
converges in distribution
𝑋
𝑑= 𝑌
𝑋and 𝑌are identically distributed random variables
𝑋⟂⟂𝑌
𝑋and 𝑌are independent random variables
𝑋∕⟂⟂𝑌
𝑋and 𝑌are not independent random variables
𝔼(𝑋)
expectation of random variable 𝑋
𝔼ℚ(𝑋)
expectation of random variable 𝑋under the probability mea-
sure ℚ
𝔼[𝑔(𝑋)]
expectation of 𝑔(𝑋)
𝔼(𝑋| ℱ)
conditional expectation of 𝑋
Var(𝑋)
variance of random variable 𝑋
Var(𝑋| ℱ)
conditional variance of 𝑋
Cov(𝑋, 𝑌)
covariance of random variables 𝑋and 𝑌
𝜌𝑥𝑦
correlation between random variables 𝑋and 𝑌
Bernoulli(𝑝)
Bernoulli distribution with mean 𝑝and variance 𝑝(1 −𝑝)
Geometric(𝑝)
geometric distribution with mean 𝑝−1 and variance (1 −𝑝)𝑝−2
Binomial(𝑛, 𝑝)
binomial distribution with mean 𝑛𝑝and variance 𝑛𝑝(1 −𝑝)
BN(𝑛, 𝑟)
negative binomial distribution with mean 𝑟𝑝−1 and variance
𝑟(1 −𝑝)𝑝−2
Poisson(𝜆)
Poisson distribution with mean 𝜆and variance 𝜆
Exp(𝜆)
exponential distribution with mean 𝜆−1 and variance 𝜆−2
Gamma(𝛼, 𝜆)
gamma distribution with mean 𝛼𝜆−1 and variance 𝛼𝜆−2
(𝑎, 𝑏)
uniform distribution with mean 1
2(𝑎+ 𝑏) and variance 1
12(𝑏−
𝑎)2
(𝜇, 𝜎2)
normal distribution with mean 𝜇and variance 𝜎2
log-(𝜇, 𝜎2)
lognormal distribution with mean 𝑒𝜇+ 1
2 𝜎2 and variance (𝑒𝜎2 −
1)𝑒2𝜇+𝜎2
𝜒2(𝑘)
chi-square distribution with mean 𝑘and variance 2𝑘
𝑛(𝜇, Σ)
multivariate normal distribution with 𝑛-dimensional mean
vector 𝜇and 𝑛× 𝑛covariance matrix Σ
Φ(⋅), Φ(𝑥)
cumulative distribution function of a standard normal
𝚽(𝑥, 𝑦, 𝜌𝑥𝑦)
cumulative distribution function of a standard bivariate nor-
mal with correlation coefficient 𝜌𝑥𝑦
𝑊𝑡
standard Wiener process, 𝑊𝑡∼(0, 𝑡)
𝑁𝑡
Poisson process, 𝑁𝑡∼Poisson(𝜆𝑡)

Index
3-period binomial tree models
barrier-style options 432–5
time-dependent options 310–14, 328–31
tree-based methods 211–17
ABM see arithmetic Brownian motion
accumulators 428–9
American options 267–349
asymptotic optimal exercise boundary 316–21
Barone-Adesi and Whaley formula 324–7
basic properties 267, 271–92, 274–6, 276–9,
279–88, 289–91, 290–2
binomial option pricing 270–1
Black approximation 322–4
definition 2
digital options 331–49
early exercise 290–1, 321
free boundary formulation 268–9
linear complementarity 269–70
lookback options 613–17, 623–7
optimal stopping time 268
perpetual options 294–305
pricing formulations 268–70
put-call parity 267, 282–4
smooth pasting condition 314–16
time-dependent options 305–49
time-independent options 292–305
upper bound of price 321–2
approximation integration formula 689, 717
arbitrage 306–7
arbitrage opportunities
American options 272–3, 275–7, 280, 290, 292
discrete dividends 116, 122
European options 65, 74–6, 80, 85, 116, 122
self-financing trading strategy 65
tree-based methods 192–3
arithmetic average options
average rate options 440, 442, 445–7, 457–79,
487–91, 497, 525–9
average strike options 441, 442, 448–9, 491–6,
497, 525–9
continuous sampling 440–1, 487–500, 525–9
discrete sampling 440–1, 457–79
probabilistic approach 496–500
put-call parity 496–500
symmetry of arithmetic average rate/ strike 525–9
arithmetic average rate options 440, 457–79
arithmetic-geometric average rate identity 445–7
PDE approach 487–91
put-call relation 442, 497
symmetry of arithmetic average rate/strike 525–9
arithmetic average strike options 441
arithmetic-geometric average strike identity
448–9
PDE approach 491–6
put-call relation 442, 497
symmetry of arithmetic average rate/strike 525–9
arithmetic averaging 439–41, 443
arithmetic Brownian motion (ABM) 151–5, 554
arithmetic-geometric average rate identity 445–7
arithmetic-geometric average strike identity 448–9
Asian options 439–529
arithmetic averaging 439–41, 443
average rate option payoff 440–1
average strike option payoff 441
continuous sampling 440–1, 480–529
discrete sampling 440–1, 443–79
geometric averaging 439–41, 443–4
put-call parity 442–3, 496–500
volatility derivatives 780, 782
asset risk 573
asset-or-nothing options 139–44
Black–Scholes model 139–44
Greeks 258, 260
PDE approach 139–41
probabilistic approach 141–4
asset-paying dividends 72
assets, non-dividend paying 163–7

830
Index
asymptotic optimal exercise boundaries 316–21
asymptotic property of binomial distribution 207
at-the-money (ATM)
Brenner–Subrahmanyam approximation 662
Chambers–Nawalkha approximation 683
equity derivatives 3, 24
Li ATM volatility approximation 663–8
Li non-ATM volatility approximation 668–73
average options see Asian options
average rate option payoff 440–1
see also arithmetic average rate options;
geometric average rate options
average strike option payoff 441
see also arithmetic average strike options;
geometric average strike options
backward Kolmogorov equation
Black–Scholes equation 724, 725
forward Kolmogorov equation 727, 729
local volatility 687–92, 692–3, 695, 697
stochastic volatility 713–25, 727, 729
Barone-Adesi and Whaley formula 324–7
barrier options 351–437
barrier-style options 408–37
in-out parity 352
lookback options 609
pricing 353–407
probabilistic approach 353–4, 357–86
reflection principle 386–407
bear spreads 8, 37–9
Bermudan options 2, 270–1, 327–31
binomial distribution asymptotic property 207
binomial models
continuous limit of 308–9
continuous-time limit 69–71, 202–4, 308–9
discrete 194
tree-based methods 194, 202–4
see also binomial tree models
binomial option pricing 270–1
binomial tree models 204–17
3-period 211–17, 310–14, 328–31, 432–5
barrier-style options 432–5
continuous limit of 308–9
continuous-time limit of 202–4, 308–9
delta hedging 242–4
time-dependent options 308–14, 327–31
tree-based methods 204–17
bivariate normal distribution
Curran approximation 469–70, 474–5
geometric average strike options 515, 518, 520
rainbow options 559, 565, 566, 568–70
Black approximation 322–4
Black equation 422–4
Black, Fischer 63
see also Black…; Black–Scholes…
Black formula 422–3
Black model 144–6
Black–Scholes differential operator 247, 249, 256
Black–Scholes equation
asset-or-nothing options 140
asymptotic optimal exercise boundaries 317, 320
Barone-Adesi and Whaley formula 324–6
barrier options pricing 354–6
continuous sampling 480–1
continuous-time limit of binomial model 70, 202
cross-currency options 572–9
delta hedging strategy 64
digital options 134–5
discrete dividends 116, 118, 122
down-and-out/in options 394–6, 413, 418
European option pricing 184, 189
European option valuation 95–7
exchange options 542
futures contracts 146–9
geometric average options 502, 506
Greeks 245, 247–9, 252, 254, 256, 260
Heston model 756–60, 763
higher derivatives property 110–12
immediate-touch options 339–42
in-out parity 389, 408
invariance properties 108–9
linear complementarity 307
local volatility 685, 687, 692–4
lookback options 604–9, 618–22
market price of risk 124–5
one-touch options 331–3, 334
reflection principle 386–8, 421–2
self-financing trading strategy 66
smooth pasting condition 314–15
solutions of 111–15
stochastic volatility 723–6, 756–60, 763
stock paying continuous dividend yield 89–92
stock paying discrete dividends 93–5
transaction costs 128
two-dimensional 537–9, 540, 724
up-and-out/in options 390–2, 410, 415
Black–Scholes formula 63
Brenner–Subrahmanyam approximation 661
Chambers–Nawalkha approximation 683–4
down-and-out/in options 415
European options 85, 109–10, 648–9, 676–7
generalised formula 161–3
Greeks 71, 220–4, 226, 228, 230–1, 237
Heston model 755, 756, 761
Hull–White model 745, 751
implied volatility 648–9, 706

Index
831
invariance properties 109–10
Li non-ATM volatility approximation 668
local volatility 685, 706
Manaster–Koehler method 677
reflection principle 393, 397
theoretical 647, 649
timer options 785, 786
up-and-out/in options 412
Black–Scholes framework 430, 442, 647
Black–Scholes inequality 268
Black–Scholes methodology 353
Black–Scholes model 89–190
asset-or-nothing options 139–44
criticisms 73
digital options 134–9
European options 72–3, 89–190
extension of 72–3
local volatility 649–50
stochastic volatility 651
with transaction costs 73, 125–8
Black–Scholes operator 269
Black–Scholes options see European options
Black–Scholes price 668, 673
Black–Scholes theoretical price 663–4, 666–7,
669
Black–Scholes world
delta hedging 237
down-and-out/in options 412, 418
in-out parity with rebate at expiry 408
knock-out equity accumulator 428
knock-out/knock-in options 424
reflection principle 386, 389, 390, 421–2
time-dependent options 308
tree-based methods 202–11
up-and-out/in options 410, 415
bonds see zero-coupon bonds
Bos–Vandermark model 120–1, 233–7
box spreads 39–40
Boyle method 197–9
Boyle–Emmanuel method 260–2
Brenner–Subrahmanyam approximation 661–3, 673
bull spreads 7, 33–6, 39
butterfly spreads 8, 54–8
call-on-a-put options 596, 599
call/put-on-a-call options 591–2, 595
capped options 532–3
Cauchy–Euler equation 616
Chambers–Nawalkha approximation 683–4
Chapman–Kolmogorov equation
backward Kolmogorov equation 714, 720, 721
forward Kolmogorov equation 727
local volatility 688, 691, 694, 696
chooser options 531, 600–4
complex 601–4
simple 600–1
cliquet options 588–91
closed-form solutions
Asian options 439
barrier options pricing 354
one-touch options 337
rainbow options 560
timer options 784, 785
collars 7, 41–4
company defaults 158–61, 429–31
complex chooser options 601–4
compo options 575, 580
compound options 591–9
conditional Jensen’s inequality 475
condor spreads 58–61
contingent claims 2
continuous arithmetic average 440
continuous dividend yield 75–8, 305–6
American options 271, 274, 277, 281, 292, 298,
301, 316, 319
arithmetic average rate options 446, 487, 525
arithmetic average strike options 448, 492, 525
backward Kolmogorov equation 687, 713
Barone-Adesi and Whaley formula 324
binomial tree models 308, 310, 327, 432
Black–Scholes equation 480, 537, 723
Black–Scholes formula 676
Black–Scholes model 72, 89–95
Boyle method 197
Boyle–Emmanuel method 260
Brenner–Subrahmanyam approximation 661
capped options 532
Chambers–Nawalkha approximation 683
chooser options 600, 601
cliquet options 588
compound options 591, 596
Corrado–Miller–Hallerbach approximation 673
corridor options 533
Cox–Ross–Rubinstein method 193
cross-currency options 572, 575–80
Curran approximation 468
delta hedging 237, 245, 248, 250, 253, 255, 258
down-and-out/in options 364, 380, 394, 400, 405,
412
Dupire equation 699
exchange options 540, 543
forward Kolmogorov equation 694, 726
forward start options 586
futures 13–14
geometric average options 446, 448, 450, 500,
504, 508, 514

832
Index
continuous dividend yield (Continued)
Greeks 218, 220–32, 237, 245, 248, 250, 253,
255, 258, 260
Heston model 754, 757, 760
Hull–White model 745
immediate-touch options 339, 345
in-out parity 389, 408
Jarrow–Rudd method 196
Kamrad–Ritchken method 199
Levy approximation 457
local volatility 650–1
lookback options 604, 613, 617–18, 623, 627,
634, 640, 643
one-touch options 331, 336
PDE approach 354
power options 534
put-call parity 442, 496, 522
rachet options 588
rainbow options 559, 569
reflection principle 386
risk-neutral approach 190
self-financing trading strategy 191, 192
similarity reduction 482, 483, 485
spread options 547
stop-loss options 609
time-dependent 72
time-independent options 292, 298, 301
timer options 783
tree-based methods 190–3, 196–7, 199
two-dimensional Black–Scholes equation
537
up-and-out/in options 357, 372, 390, 397, 403,
410
continuous geometric average 440
continuous limit of binomial model 308–9
continuous risk-neutral random walk 194
continuous sampling 440–1, 480–529
arithmetic average options 440–1, 487–96, 525–9
Black–Scholes equation 480–1
geometric average options 441, 500–25
PDE approach 487–96, 500–8
probabilistic approach 496–500, 508–22
put-call parity 496–500, 522–5
similarity reduction 482–7
continuous-time limit of binomial model 69–71,
202–4, 308–9
contradiction 314, 315, 318, 320
Corrado–Miller–Hallerbach approximation 673–6
corridor options 533–4
covered calls 7, 27, 32–3
covered puts 7, 28–30
Cox–Ross–Rubinstein model
barrier-style options 432
time-dependent options 327–31
tree-based methods 193–6
cross-currency options 572–86
Black–Scholes equation 572–9
PDE approach 575–9
probabilistic approach 579–86
cubic equations, depressed 663–7
cumulative standard normal distribution function
237
Curran approximation 467–79
currency see cross-currency options
De Moivre’s formula 665
defaulting companies 158–61, 429–31
delivery date, definition 2
delta 71, 220–3, 260, 264–5
see also delta hedging; Dirac delta function
delta and gamma-neutral portfolios 264–5
delta hedging
Black and Scholes assumptions 63
generalised perpetual American options 292
Greeks 237–60, 262–4
lookback options 607, 610, 620–1
strategy 63–4
time-dependent options 306
depressed cubic equations 663–7
derivatives, volatility 769–86
differential equations see ordinary differential
equations; partial differential equations;
stochastic differential equations
diffusion processes
cross-currency options 580, 581, 583
European option prices 167, 180
exchange options 540, 543–4
generalised Black–Scholes formula 161
generalised perpetual American options 292
generalised stochastic volatility model 710
Greeks 255
Heston model 757
Hull–White model 744
Merton model 132
non-dividend-paying asset price as num´eraire
163–4, 166
rainbow options 559, 569
spread options 547–50
time-dependent options 305
two-dimensional Black–Scholes equation 537
volatility derivatives 780
digital options 134–9
American options 331–49
Black–Scholes model 134–9
corridor options 533
down-and-out/in options 365, 381, 413–14

Index
833
European options 134–9, 331, 337, 410–14
Greeks 253, 258, 259–60
knock-out/knock-in options 427
PDE approach 134–7
probabilistic approach 137–9
up-and-out/in options 357–8, 373, 410–11
Dirac delta function 235, 691, 726
discontinuous jumps 73
discounting, definition 2
discrete arithmetic average rate options 440,
457–79
Curran approximation 467–79
Levy approximation 457–67
discrete arithmetic average strike options 441
discrete arithmetic averaging 439–41, 443
discrete binomial model 194
discrete dividends
American options 273, 274, 278, 281
Black–Scholes model 115–24
Bos–Vandermark model 120–1
escrowed model 115–18
European options 77–8
forward model 118–19
futures 12
yields 121–4
discrete geometric average rate options 440, 450–7
discrete geometric average strike options 441
discrete geometric averaging 439–41, 443–4
discrete sampling 440–1, 443–79
arithmetic-geometric average rate identity 445–7
arithmetic-geometric average strike identity 448–9
Asian options 780, 782
Curran approximation 467–79
discrete arithmetic average rate options 440,
457–79
discrete geometric average rate options 440–1,
450–7
Levy approximation 457–67
limit of discrete arithmetic average 443
limit of discrete geometric average 443–4
dividend yield
discrete 121–4
down-and-out/in options 418
knock-out equity accumulator 428
knock-out/knock-in options 424
reflection principle 421, 422
up-and-out/in options 415
see also continuous dividend yield
dividends
forward model 118–19
futures 11–12, 14–15
see also discrete dividends
domestic risk-neutral measure 580, 581, 583, 584
down-and-out/in barrier options 352
with immediate rebates 418–20
PDE pricing approach 356
probabilistic approach 364–72, 380–6
with rebates at expiry 412–15
reflection principle 394–7, 400–2, 405–7, 413–14
dual delta 222–3
dual gamma 223–4
dual problem 322
Dupire equation 699–705, 706
local volatility 685, 699–705, 706
stochastic volatility 743
variance swaps 769, 770
Dupire formula 650–1
Emmanuel see Boyle–Emmanuel method
equity accumulator, knock-out 428–9
equity derivative theory 1–61
definitions 1–2
forwards 1, 4–5, 8–15, 17–18, 20–1
futures 1, 2, 5–6, 8–15, 10–11
hedging strategies 6–8, 27–61
options 1–4, 15–27
equity options, foreign 575–86
equivalent martingale measure 67–8, 132
escrowed dividend model 115–18
estimation
GBM parameters 652–4
geometric mean-reversion process 658–60
maximum-likelihood 647–8, 652–61
moment-matching 653–4
Ornstein–Uhlenbeck process 654–8
Euler see Cauchy–Euler equation
European options 63–265
American options 271–6, 277–8, 281–2, 284,
291
Barone-Adesi and Whaley formula 324
basic properties 74–89
binomial tree models 432
Black approximation 323
Black–Scholes equation 95–7, 184, 189, 692, 694,
723–4
Black–Scholes formula 648–9, 676, 677
Black–Scholes model 72–3, 89–190
Brenner–Subrahmanyam approximation 661–3
capped options 532
Chambers–Nawalkha approximation 683–4
chooser options 600, 602
cliquet options 589–91
compound options 591, 596
continuous-time limit of binomial model 69–71
Corrado–Miller–Hallerbach approximation 673
corridor options 533

834
Index
European options (Continued)
cross-currency options 576, 578, 579
definition 2
delta hedging strategy 63–4
digital options 331, 337
down-and-out/in options 364–5, 380–1, 394–5,
397, 400–1, 413–15, 418, 420
Dupire equation 699
exchange options 542
forward start options 587
Greeks 71–2, 218–65
Greek values 245
hedging strategies 40–1
Heston model 754–5, 760–9
Hull–White model 745
implied volatility 648–9
in-out parity 352, 389, 408–9
knock-out/knock-in options 425
Li ATM volatility approximation 664, 666–7
Li non-ATM volatility approximation 668–9
local volatility 651, 685
lookback options 627–45
Manaster–Koehler method 677
martingale pricing theory 67–9
Merton model 128–34, 158–61, 430
options theory 21–7
price formula 501, 505, 535–6, 547, 554
prices under stochastic interest rate 167–90
probabilistic approach 101–5, 137–9, 141–4,
353
put-call parity 267, 277–8, 280–1, 283, 284
rachet options 589–91
reflection principle 386, 421, 422
self-financing trading strategy 64–7
stochastic volatility 723–4, 736–7, 743, 745,
754–5, 760–9
time-dependent options 307, 323, 324, 331, 337
timer options 785
tree-based methods 190–217
up-and-in call options 435–6
up-and-out/in options 357–8, 372–3, 390–3, 403,
410–12, 415, 417
valuation 95–105, 131–4
variance swaps 769, 770, 772
European-style options
Asian options 442
cross-currency options 575
Heston model 757
local volatility 650
lookback options 604, 618
exchange options 531, 540–7
formula 522
payoffs 586
PDE approach 540–2
probabilistic approach 543–7
exchange rate risk 573
exercise date, definition 2
exercise price, definition 2
exotic options 531–645
definition 351
path-dependent options 531, 586–645
path-independent options 531–86
see also Asian options; barrier options
expiry date, definition 2
Feynman–Kac formula 67, 101, 169, 174
fixed strike
lookback options 613–17, 640–5
see also average rate…
floating strike
lookback options 623–7, 640–5
see also average strike…
folded normal distribution 781
foreign equity options 575–86
foreign exchange (FX) options 576, 580
foreign-to-domestic exchange rate 572, 575,
580
forward dividend model 118–19
forward Kolmogorov equation 694–9, 700–1,
726–38
forward start options 531, 586–8, 588
forwards 4–5
definition 1
options theory 17–18, 20–1
synthetic 7
Fourier inversion 762, 769
Fourier transforms 761, 765–7
free boundary formulation 268–9
futures 5–6
American options 267
Black model 144–6
Black–Scholes model 144–51
definition 1
initial margin 6
knock out/in options 424–8
knock-out equity accumulator 428
settlement price 6
stock index 2, 10–11
FX see foreign exchange options
gamma 71, 221–4, 244, 248, 252, 264–5
GBM see geometric Brownian motion
generalised Black–Scholes formula 161–3
generalised historical volatility 660–1
generalised perpetual American options
292–4

Index
835
generalised stochastic volatility model 710–13
geometric average options
average rate options 440–3, 450–7, 500–4,
508–14, 522–5
average strike options 441, 443, 504–8, 514–22
continuous sampling 441, 500–25
discrete sampling 440–1, 450–7
probabilistic approach 508–25
put-call parity 522–5
geometric average rate options 440–1, 450–7
PDE approach 500–4
probabilistic approach 508–14, 522–5
put-call relation 442–3
geometric average strike options 441
PDE approach 504–8
probabilistic approach 514–25
put-call relation 443
geometric averaging 439–41, 443–4
geometric Brownian motion (GBM) 155
arithmetic-geometric average rate identity 445
arithmetic-geometric average strike identity 448
asset-or-nothing options 139, 141
Black model 144
Black–Scholes equation 89, 91, 93, 480
Black–Scholes model 125
Boyle method 197
capped options 532
chooser options 600, 601
continuous-time limit of binomial model 69
corridor options 533
Cox–Ross–Rubinstein method 193
Curran approximation 467
delta hedging strategy 64
digital options 134, 137
down-and-out/in options 364, 380, 400, 405
European option price under stochastic interest
rate 179
European option valuation 95, 101
forward start options 586
Greeks 233, 248, 253, 258, 260
immediate-touch options 339, 345
Jarrow–Rudd method 196
Kamrad–Ritchken method 199
Levy approximation 457
lookback options 604, 613, 618, 623, 627, 634,
640, 643
martingale pricing theory 67
Merton model 133, 160
one-touch options 331, 336
parameter estimation 652–4
perpetual American options 301
power options 534
risk-neutral approach 190
stop-loss options 609
tree-based methods 190, 193, 196–7, 199
up-and-out/in options 357, 372, 397, 402
volatility models 647
geometric mean-reversion process 658–60
Girsanov’s theorem 67–8, 156
arithmetic Brownian motion 152
asset-or-nothing options 142
backward Kolmogorov equation 689
compound options 596
cross-currency options 582, 585
digital options 138
discrete geometric average rate Asian option 452
European option valuation 102
European options under stochastic interest rate
168, 171, 177
exchange options 544
forward Kolmogorov equation 694, 695
forward start options 587
geometric average options 452, 518, 523
knock-out/knock-in options 425
lookback options 635
non-dividend-paying asset price as num´eraire 164
perpetual American options 302
power options 535
put-call parity 497, 523
spread options 549
symmetry of arithmetic average rate/strike 526
time-dependent options 337, 346–7
see also two-dimensional Girsanov’s theorem
Greeks 218–65
Bos–Vandermark model 233–7
Boyle–Emmanuel method 260–2
delta 220–3, 260, 264–5
delta hedging 237–60, 262–4
dual delta 222–3
dual gamma 223–4
European options 71–2, 218–65
gamma 221–4, 244, 248, 252, 264–5
psi 231–3
rho 230–1
theta 228–30
vega 224–6, 244, 252
vomma 226–8
Hallerbach see Corrado–Miller–Hallerbach
approximation
heat equations 140, 332, 340
hedge, definition 2
hedging
Boyle–Emmanuel method 260–2
strategies 6–8, 27–61, 310–14
see also delta hedging

836
Index
hedging portfolios
cross-currency options 573
Heston model 757–8
lookback options 605, 607, 610, 618, 620–1
two-dimensional Black–Scholes equation
537
Heston model 753–69
Black–Scholes equation 756–60, 763
European options 754–5, 760–9
higher derivatives property 110–12
historical volatility 647–9, 652–84
Brenner–Subrahmanyam approximation 661–3,
673
Chambers–Nawalkha approximation 683–4
Corrado–Miller–Hallerbach approximation
673–6
GBM parameter estimation 652–4
generalised 660–1
geometric mean-reversion process 658–60
Li ATM volatility approximation 663–8
Li non-ATM volatility approximation 668–73
Manaster–Koehler method 677–83
Ornstein–Uhlenbeck process 654–8
hitting-time distribution 303–4
Hull–White model 743–53
immediate rebates 415–20
immediate-touch options 339–49
American options 268
down-and-out/in options 418
PDE approach 339–45
probabilistic approach 345–9
time-dependent options 339–49
up-and-out/in options 416
implied volatility 648–9, 652–84
Brenner–Subrahmanyam approximation 661–3,
673
Chambers–Nawalkha approximation 683–4
Corrado–Miller–Hallerbach approximation 673–6
GBM parameter estimation 652–4
geometric mean-reversion process 658–60
historical volatility 648–9
Li ATM volatility approximation 663–8
Li non-ATM volatility approximation 668–73
and local volatility 706–10
Manaster–Koehler method 677–83
Ornstein–Uhlenbeck process 654–8
surfaces 649
in-out parity 352
PDE pricing approach 356
with rebate at expiry 408–9, 412
reflection principle 389–90
in-the-money (ITM) 3, 24, 27
independent increment property 453, 517
induction, mathematical 205–6, 682
infimum 322
instantaneous variance 745, 747
integration by parts
Dupire equation 702
forward Kolmogorov equation 697, 698, 730–4
geometric average rate options 509, 510
Heston model 765
lookback options 631, 632, 637, 638
stochastic volatility 730–4, 738–9, 765
interest rates, stochastic 167–90
intermediate value theorem 626
intrinsic value 1, 74–5
invariance properties 108–10
iterative methods/analysis 117, 119
ITM see in-the-money
It¯o calculus 689, 717
It¯o integrals 162, 715, 748, 749
It¯o’s formula
European options 132, 168, 170, 173, 176, 179,
181, 184
GBM parameter estimation 652
generalised stochastic volatility model 711, 712
geometric average strike options 515, 518
geometric mean-reversion process 659
Merton model 132
Ornstein–Uhlenbeck process 654
rainbow options 566, 570
It¯o’s lemma 155–6
arithmetic Brownian motion 151–2
asset-or-nothing options 142
Black model 145
Black–Scholes equation 90, 480, 538
chooser options 603
compound options 596
cross-currency options 573, 581
digital options 138
discrete geometric average rate Asian option 452
down-and-out/in options 366, 382
European option price under stochastic interest
rate 183
European option valuation 102
exchange options 545, 546
forward start options 587
generalised Black–Scholes formula 162
generalised perpetual American options 292
geometric average rate options 511
Heston model 757
Hull–White model 747, 749
knock out/knock in options 425
lookback options 607, 621, 629, 636
martingale property 106

Index
837
Merton model 129
non-dividend-paying asset price as num´eraire
166
power options 535, 536
put-call parity 498
spread options 550, 552–4
symmetry of arithmetic average rate/strike 527
time-dependent options 306, 338, 347
timer options 784
two-dimensional Black–Scholes equation 538
up-and-out/in options 358, 374
variance swaps 775
volatility derivatives 780, 781, 784–5
Jarrow–Rudd method 196–7
Jensen’s inequality, conditional 475
jump diffusion process 132
jump-diffusion models 651
jumps, discontinuous 73
Kac see Feynman–Kac formula
Kamrad–Ritchken method 199–202
Kirk’s approximation 549, 554
knock out/knock in time 415–16, 418
knock-in and knock-out parity relationship 398, 400,
404, 406
knock-out equity accumulator 428–9
knock-out/in barrier options 351–2
futures 424–8
PDE approach 355
probabilistic approach 353
Koehler see Manaster–Koehler method
Kolmogorov see backward Kolmogorov equation;
Chapman–Kolmogorov equation; forward
Kolmogorov equation
Laplace transforms 301–2, 304
lattice approach see binomial…
Levy approximation 457–67
L’Hˆopital’s rule
arithmetic average options 491, 496
binomial tree models 211
Greeks 259
Levy approximation 464, 466
Li ATM volatility approximation 663–8
Li non-ATM volatility approximation 668–73
linear complementarity 269–70, 307–8
local volatility 649–51, 685–710
backward Kolmogorov equation 687–92
Black–Scholes equation 685, 687, 692–4
Dupire equation 685, 699–705, 706
forward Kolmogorov equation 694–9
and implied volatility 706–10
stochastic volatility model 743
time-dependent volatility 705–6
long position 2, 4–5
long side 4
long straddles 44–5
long strangles 47–8
long straps 52–3
long strips 49–51
lookback options 531, 604–45
Black–Scholes equation 604–9, 618–22
European fixed strike 627–40
European floating strike 640–5
perpetual American options 613–17, 623–7
stop-loss options 609–13
MacLaurin series 445, 674
maintenance margin 6
Manaster–Koehler method 677–83
Margrabe’s formula 544
market price of risk 124–5, 185
marking-to-market 6
Markov process 648
Marsaglia’s formula 234–5
martingale pricing 63, 67–9
see also probabilistic approach
martingale property 105–8
martingales
arbitrary 322
backward Kolmogorov equation 716
European option price under stochastic interest
rate 172, 176, 178
exchange options 543, 545
forward Kolmogorov equation 694
generalised stochastic volatility model 712
Heston model 756
Hull–White model 746
non-dividend-paying asset price as num´eraire
166–7
Ornstein–Uhlenbeck process 655
perpetual American options 301
simple chooser options 600, 601
spread options 548, 551, 552
symmetry of arithmetic average rate/strike
526–7
timer options 785
mathematical induction 205–6, 682
maximum-likelihood estimation (mle)
GBM parameter estimation 652–3
generalised historical volatility 660–1
geometric mean-reversion process 659–60
historical volatility 647–8, 660–1
Ornstein–Uhlenbeck process 654, 655–7
mean reversion process, geometric 658–60

838
Index
Merton model
Black–Scholes model 128–34, 158–61
company default 158–61, 429–31
European option valuation 131–4
Miller see Corrado–Miller–Hallerbach
approximation
mle see maximum-likelihood estimation
moment-generating function 475, 518, 565
moment-matching 458, 653–4
money-market accounts 547, 548, 552, 554
monotonicity 627, 648, 676–7, 680
Nawalkha see Chambers–Nawalkha approximation
Newton–Raphson method 678, 680, 682
Nikod´ym see Radon–Nikod´ym derivative/process
no-arbitrage condition
American options 290
Black–Scholes equation 90, 92, 94, 481, 529
cross-currency options 574
discrete dividends 115, 118, 120, 121
European option price under stochastic interest
rate 184
futures contracts 149
Greeks 250, 252, 261
Heston model 758
lookback options 608, 622
two-dimensional Black–Scholes equation 539
non-dividend-paying assets 79–80, 163–7
normal distribution 558, 781
see also bivariate normal distribution
num´eraires
European options 163–7, 169, 178, 179
exchange options 543, 545
Heston model 755, 756
non-dividend-paying asset price 163–7
spread options 548, 551
symmetry of arithmetic average rate/strike
526–7
ODEs see ordinary differential equations
OLS see ordinary least squares method
one-for-two stock splits 110
one-touch options 331–9
PDE approach 331–6
probabilistic approach 336–9
time-dependent options 331–9
optimal stopping theorem 301
optimal stopping time formulation 268
options
definition 1
stock index 1–2
theory 1–4, 15–27
trading 2–4
see also American…; Asian options; barrier
options; European…; exotic options
ordinary differential equations (ODEs)
arithmetic average rate options 488
Black–Scholes equation 113–15
immediate-touch options 340–1
lookback options 611–12, 625
perpetual American options 292–5, 299
ordinary least squares method (OLS) 657–8, 660
Ornstein–Uhlenbeck process 167, 180, 654–8
out-of-the-money (OTM) 3, 24–5, 27
partial differential equations (PDEs)
arithmetic average options 487–96
asset-or-nothing options 139–41
barrier options pricing 354–6
Black–Scholes equation 692, 694
cross-currency options 573, 575–9
digital options 134–7
European option price under stochastic interest
rate 181, 184, 185
European option valuation 95–101
exchange options 540–2
geometric average options 500–8
Greeks 255
Heston model 760–1, 763–7
immediate-touch options 339–45
knock out/in options 355
local volatility 650
lookback options 605, 607, 610, 611, 620, 625
one-touch options 331–6
similarity reduction 482–3, 484, 485, 487
stochastic volatility 742–3, 760–1, 763–7
timer options 786
two-dimensional 573, 575–9
path-dependent options 586–645
Asian options 480, 482, 484, 485
chooser options 600–4
cliquet options 588–91
compound options 591–9
exotic options 531
forward start options 586–8
lookback options 604–45
rachet options 588–91
stop-loss options 609–13
path-independent options 531, 532–86
Black–Scholes equation 537–9, 540, 572–9
capped options 532–3
corridor options 533–4
cross-currency options 572–86
exchange options 531, 540–7
PDE approach 540–2
power options 534–7

Index
839
probabilistic approach 543–7, 579–86
rainbow options 531, 558–75
spread options 531, 547–58
two-dimensional Black–Scholes equation 537–9,
540
payoffs/payoff diagrams
average rate option payoff 440–1
average strike option payoff 441
capped options 532–3
corridor options 533–4
cross-currency options 575–86
definitions of payoff 1–4
down-and-out/in options 400, 401, 405, 407
exotic options 531, 575–86
knock-out equity accumulator 429
Merton model 430–1
path-dependent options 531
path-independent options 531
terminal payoffs 409, 533, 584, 586
up-and-out/in options 398, 399, 403, 404,
434–7
PDEs see partial differential equations
perpetual American options 292–305
Barone-Adesi and Whaley formula 326
call options 294–8, 301–4
generalised 292–4
lookback options 613–17, 623–7
put options 298–305
perpetual barrier lookback options 609
perpetual call problem 339–40
Poisson processes 128, 131
polynomial approximation 238, 240, 241
portfolios
delta and gamma-neutral 264–5
see also hedging portfolios
power options 534–7
price/pricing
American options 268–71, 321–2
barrier options 353–407
binomial option 270–1
Black Scholes price 663–4, 666–9, 673
European options price formula 501, 505, 535–6,
547, 554
European options under stochastic interest rate
167–90
European “partial barrier” option price 435–7
market price of risk 124–5, 185
non-dividend-paying asset price as num´eraire
163–7
settlement price 6
strike/exercise price 2
see also martingale pricing; spot price volatility
primal problems 321
probabilistic approach
arithmetic average options 496–500
asset-or-nothing options 141–4
barrier options 353–4, 357–86
cross-currency options 579–86
digital options 137–9
down-and-out/in options 364–72, 380–6
European option valuation 101–5
exchange options 543–7
geometric average options 508–25
immediate-touch options 345–9
one-touch options 336–9
up-and-out/in options 357–64, 372–80
profit 237, 262–4
protective calls 6–7, 30–1
protective puts 6–7, 32, 33
psi 231–3
purchased collars 41–2
put-call parity
American options 267, 277–8, 280–4
arithmetic average options 496–500
arithmetic Brownian motion 152, 155
Asian options 442–3, 496–500
asset-or-nothing options 142, 144
digital options 137
down-and-out/in options 413–14
Dupire equation 704–5
equity derivatives theory 21–4, 25–7, 39
European options 76–8, 84, 101, 105, 150–2, 155,
161, 267, 277–8, 280–4
futures contracts 150
geometric average options 522–5
Greeks 230, 231, 233, 246
Merton model 161
simple chooser options 600, 601
stochastic volatility 743
timer options 784, 786
up-and-out/in options 410
put-on-a-call options 592, 595
put/call-on-a-put options 596, 597, 599
quanto options 575, 580, 583
rachet options 588–91
Radon–Nikod´ym derivative/process
cross-currency options 582, 585
European option price under stochastic interest
rate 171, 177
forward Kolmogorov equation 694
generalised stochastic volatility model 712
rainbow options 531, 558–75
random walks 194
Raphson see Newton–Raphson method

840
Index
realised integrated variance 780–3, 786
rebates
at expiry 408–15
immediate 415–20
reflection principle 386–407
barrier options pricing 353, 354
Black equation 422–4
Black–Scholes equation 386–8, 421–2
down-and-out/in options 394–7, 400–2, 405–7,
413–14
Merton model 430
reflected standard Wiener process 528
up-and-out/in options 390–3, 397–400, 402–5,
410–11
Wiener process 304
rho 72, 230–1
risk 124–5, 185, 237, 573
risk-neutral approach 190–1, 192–3
risk-neutral expectation strategy 353
risk-neutral measure 155
American options 268, 302
arithmetic average options 497, 499
backward Kolmogorov equation 688, 689, 713,
714
Black–Scholes equation 692, 723, 724
Boyle method 197
capped options 532
chooser options 600–2
cliquet options 589
compound options 592, 595, 596, 599
Cox–Ross–Rubinstein method 193
cross-currency options 580, 581, 583, 584
Curran approximation 468, 471
digital options 138
discrete geometric average rate Asian option
450–2
domestic measure 580, 581, 583, 584
down-and-out/in options 365, 372, 381–2, 386,
401–2, 406, 420
Dupire equation 699
European option valuation 102
European options under stochastic interest rate
168, 172, 174, 176, 178–9
exchange options 543–5
forward Kolmogorov equation 694, 695, 726, 727
forward start options 587
generalised Black–Scholes formula 161–2
generalised stochastic volatility model 711–13
geometric average options 509, 511, 513, 515–16,
518, 522–5
Greeks 259
Heston model 753, 755, 756
Hull–White model 744, 747
in-out parity 390
Jarrow–Rudd method 196
Kamrad–Ritchken method 199–200
knock out/knock in options 425
Levy approximation 458
local volatility 650
lookback options 627, 628, 635, 640–4
martingale pricing theory 69
martingale property 105
Merton model 430–1
non-dividend-paying asset price as num´eraire
163–5
power options 535
put-call parity 442, 497, 499, 523–5
rachet options 589
rainbow options 559, 565, 570
spread options 548–9, 551, 554–5
stochastic volatility 711–14, 723–4, 726–7, 736,
744, 747, 753, 755–6
symmetry of arithmetic average rate/strike 525,
526
time-dependent options 321, 336–7, 345, 346–7
timer options 783, 786
up-and-out/in options 357–8, 364, 373–4, 380,
398, 402, 404, 417
variance swaps 774, 777, 778
volatility derivatives 774, 777–8, 782–3, 786
risk-neutral pricing 163
risk-neutral probability measure 190
risk-neutral valuation
arithmetic average options 497
arithmetic Brownian motion 152
Black–Scholes model 101, 141
compound options 596
put-call parity 497
spread options 555
see also valuation
Ritchken see Kamrad–Ritchken method
Ross see Cox–Ross–Rubinstein method
Rubinstein see Cox–Ross–Rubinstein method
Rudd see Jarrow–Rudd method
Russian options 617
Scholes, Myron 63
see also Black–Scholes…
SDEs see stochastic differential equations
self-financing trading strategy 64–9, 191–3
short position 2, 4–5
short side 4
short straddles 44–6
short strangles 48–9
short straps 53–4
short strips 51–2

Index
841
similarity reduction 482–7
simple chooser options 600–1
smooth functions 688, 713, 717
smooth pasting condition
American options 269, 295, 297–8, 301, 314–16,
325
Barone-Adesi and Whaley formula 325
time-dependent options 314–16
spot price volatility
delta 220
dual delta 223
dual gamma 224
gamma 221
psi 232
rho 230
theta 228
vega 224
vomma 226
spreads 531, 547–58
bear 8, 37–9
box 39–40
bull 7, 33–6, 39
butterfly 8, 54–8
condor 58–61
standard Wiener processes 155–6
arithmetic average options 446, 448, 487, 491,
496, 497
arithmetic Brownian motion 151
arithmetic-geometric average rate identity 446
arithmetic-geometric average strike identity 448
asset-or-nothing options 139, 141, 142
backward Kolmogorov equation 687, 689, 713,
715
Black equation 422
Black model 144
Black–Scholes equation 89, 91, 93, 386, 421, 480,
692, 723
Black–Scholes model with transaction costs 125
capped options 532
chooser options 60, 601, 603
cliquet options 588, 589
compound options 591, 592, 596
corridor options 533
cross-currency options 572, 575, 579, 581–5
Curran approximation 468, 471
digital options 134, 137, 138
discrete geometric average rate Asian option 450,
452–3
down-and-out/in options 364, 366, 380, 382, 394,
400, 405, 412, 418
Dupire equation 699
European option price under stochastic interest
rate 167, 169, 171, 177–80
European option valuation 95, 101–2
exchange options 540, 543–5
forward Kolmogorov equation 694, 695, 726
forward start options 586, 587
GBM parameter estimation 652
generalised Black–Scholes formula 161–2
generalised stochastic volatility model 710–12
geometric average options 446, 448, 450, 452–3,
500, 504, 508, 510–11, 514–15, 517–18, 522–4
Girsanov’s theorem 67–8, 102
Greeks 233, 246, 248, 253, 255, 258, 260
Heston model 753, 754, 760
Hull–White model 743, 744
immediate-touch options 339, 345–7
in-out parity 389, 408
independent increment property 453, 517
knock out/knock in options 424–5
knock-out equity accumulator 428
Levy approximation 457, 459
local volatility 650, 685
lookback options 604, 613, 618, 623, 627–8,
634–5, 640, 642–4
market price of risk 124
martingale property 105
Merton model 128, 131, 430
non-dividend-paying asset price as num´eraire
163–4, 166
one-touch options 331, 336, 338
Ornstein–Uhlenbeck process 654
power options 534, 535
probabilistic approach 353, 357–8, 364, 366, 372,
374, 380, 382
put-call parity 442, 496, 497, 522, 523–4
rachet options 588, 589
rainbow options 559, 565, 569, 570
reflection principle 386, 421, 422
similarity reduction 482, 483, 485
spread options 547–9, 552, 554, 555
stationary increment property 510
stochastic volatility 651, 710–13, 715, 723, 726,
736, 743–4, 753–4, 760
stop-loss options 609
symmetry of arithmetic average rate/strike 525,
526, 527, 528
time-dependent options 305, 331, 336, 338, 339,
345
time-independent options 292, 301, 302, 304
timer options 783
two-dimensional Black–Scholes equation 537
up-and-out/in options 357–8, 372, 374, 390, 397,
402, 410, 415
variance swaps 769, 774, 777
volatility derivatives 769, 774, 777, 780, 783

842
Index
stationary increment property 510
stochastic differential equations (SDEs) 155–6
arithmetic average options 487, 491, 496
arithmetic Brownian motion 151
asset-or-nothing options 139, 141
backward Kolmogorov equation 687, 713
Black equation 422
Black–Scholes equation 89, 91, 93, 421, 480, 692
Black–Scholes model with transaction costs 125
capped options 532
chooser options 600, 601
cliquet options 588
corridor options 533
cross-currency options 572, 575, 580, 584
digital options 134, 137, 138
down-and-out/in options 364, 380, 394, 400, 405,
412, 418
Dupire equation 699
European option price under stochastic interest
rate 174
European option valuation 95, 101
forward Kolmogorov equation 694, 726
forward start options 586
geometric average options 500, 504, 508, 514,
522
geometric mean-reversion process 659
Greeks 233, 246
in-out parity 389
knock out/knock in options 424–5
knock-out equity accumulator 428
local volatility 649
lookback options 627, 634, 640, 643
market price of risk 124
martingale pricing theory 68–9
martingale property 105
Merton model 129, 158, 429
perpetual American options 301, 303
power options 534–6
put-call parity 442, 496, 522
rachet options 588
reflection principle 386, 421, 422
similarity reduction 482, 483, 485
symmetry of arithmetic average rate/strike 525,
528
time-dependent options 331, 336, 339, 345
up-and-out/in options 357, 372, 397, 402, 410,
415
stochastic interest rates 167–90
stochastic processes, delta hedging 64
stochastic volatility 651, 710–69
backward Kolmogorov equation 713–25, 727,
729
Black–Scholes equation 723–6, 756–60, 763
forward Kolmogorov equation 726–36, 737, 738
generalised model 710–13
Heston model 753–69
Hull–White model 743–53
local volatility model 743
timer options 783
variance swaps 778
stock dividend effect 6
stock index futures 2, 10–11
stock index options, definition 1–2
stock split effect 6
stop-loss options 609–13
straddles 8, 44–6, 56–8
strangles 8, 47–9, 56–8
straps 8, 52–4
strike price, definition 2
strips 8, 49–52, 262–4
Subrahmanyam see Brenner–Subrahmanyam
approximation
sum of squares 103, 143
swaps 1, 769–79
symmetry of arithmetic average rate/strike 525–9
synthetic forwards 7
T-forward measure 177–80
Taylor’s expansion/series 156
backward Kolmogorov equation 688, 691,
713–14, 721
binomial tree models 209
Black–Scholes equation 480
Bos–Vandermark model 236
Brenner–Subrahmanyam approximation 662
continuous limit of binomial model 308
continuous-time limit of binomial model 70, 202,
203, 308
generalised perpetual American options 292
self-financing trading strategy 65
time-dependent options 306, 308
timer options 784
variance swaps 775
Taylor’s formula 659
Taylor’s theorem
arithmetic Brownian motion 152
backward Kolmogorov equation 688
Black model 144
Black–Scholes equation 90, 92, 94, 538
Black–Scholes model with transaction costs
126
Chambers–Nawalkha approximation 684
Cox–Ross–Rubinstein method 195
cross-currency options 573
European option price under stochastic interest
rate 183, 184

Index
843
exchange options 546
Greeks 250, 259, 261
knock out/knock in options 425
Li non-ATM volatility approximation 670
Manaster–Koehler method 682
market price of risk 124
Merton model 129
power options 535
spread options 552
time-dependent options 309, 318
two-dimensional Black–Scholes equation
538
term structure of volatility 649, 705
term-structure variance 751
terminal payoffs
corridor options 533
cross-currency options 584, 586
in-out parity 409
theoretical Black-Scholes formula 647, 649
theta 72, 228–30
3-period binomial tree models 211–17, 310–14,
328–31, 432–5
time value, definition 1
time-dependent continuous dividend yield 72
time-dependent options 305–49
American options 305–49
asymptotic optimal exercise boundaries
316–21
Barone-Adesi and Whaley formula 324–7
binomial tree models 308–14, 327–31
Black approximation 322–4
continuous limit of binomial model 308–9
immediate-touch options 339–49
linear complementarity 307–8
one-touch options 331–9
smooth pasting condition 314–16, 325
upper bound of American option price
321–2
time-dependent variance 751
time-dependent volatility 705–6
time-independent options 292–305
see also perpetual American options
timer cash contracts 786
timer options 783–6
timer share contracts 785, 786
tower property
Curran approximation 469
Heston model 754, 755
Hull–White model 745
trading strategies
delta hedging 237, 239
hedging options 310–14
self-financing 64–9, 191–3
transaction costs 73, 125–8
tree-based methods 190–217
binomial tree models 204–17
Boyle method 197–9
Cox–Ross–Rubinstein method 193–6
Jarrow–Rudd method 196–7
Kamrad–Ritchken method 199–202
risk-neutral approach 190–1, 192–3
self-financing strategy 191–3
trinomial models 197, 199, 201
two-dimensional Black–Scholes equation
exchange options 540
path-independent options 537–9, 540
stochastic volatility 724
two-dimensional Girsanov’s theorem 582, 585
backward Kolmogorov equation 713
European option price under stochastic interest
rate 168, 171, 177
forward Kolmogorov equation 726
generalised stochastic volatility model 711,
712
Heston model 753
Hull–White model 744
two-dimensional PDEs 573, 575–9
Uhlenbeck see Ornstein–Uhlenbeck
up-and-out/in barrier options 351, 352
European “partial barrier” option price
435–7
with immediate rebates 415–18
PDE approach 355, 356
probabilistic approach 357–64, 372–80
rebates at expiry 410–12
reflection principle 390–3, 397–400, 402–5,
410–11
upper bound of American option price 321–2
valuation
European options 95–105, 131–4
Merton model 131–4
PDE approach 95–101
probabilistic approach 101–5
see also risk-neutral valuation
Vandermark see Bos–Vandermark model
vanilla options
capped options 532
down-and-out/in options 365, 381
knock out/knock in options 427
lookback options 628, 635
up-and-out/in options 357–8, 373
see also American options; European options
variance swaps 769–79
variation margin 6

844
Index
Vasicek process see Ornstein–Uhlenbeck process
vega 72, 224–6, 244, 252, 678
vol-of-vol 651
volatility
Greeks 262
see also spot price volatility
volatility derivatives 769–86
timer options 783–6
variance swaps 769–79
volatility models 647–786
historical volatility 647–9, 652–84
implied volatility 648–9, 652–84
local volatility 649–51, 685–710
stochastic volatility 651, 710–69
volatility derivatives 769–86
volatility skews 649
volatility smiles 649
vomma 226–8
Whaley see Barone-Adesi and Whaley formula
White see Hull–White model
Wiener processes
Heston model 756
probabilistic approach 353–4
reflection principle 304
see also standard Wiener processes
written collars 42–4
zero-coupon bonds 168–9, 173, 176, 180–2, 184,
187

