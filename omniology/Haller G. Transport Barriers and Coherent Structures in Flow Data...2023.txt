Transport Barriers and 
Coherent Structures 
in Flow Data
Advective, Diffusive, Stochastic 
and Active Methods
GEORGE HALLER

TRANSPORT BARRIERS AND COHERENT STRUCTURES 
IN FLOW DATA
Transport barriers are observed inhibitors of the spread of substances in flows. The 
collection of such barriers offers a powerful geometric template that frames the 
main pathways, or lack thereof, in any transport process. This book surveys effec­
tive and mathematically grounded methods for defining, locating and leveraging 
transport barriers in numerical simulations, laboratory experiments, technological 
processes and nature. It provides a unified treatment of material developed over the 
past two decades, focusing on the methods that have a solid foundation and broad 
applicability to data sets beyond simple model flows. The intended audience ranges 
from advanced undergraduates to researchers in the areas of turbulence, geophys­
ical flows, aerodynamics, chemical engineering, environmental engineering, flow 
visualization, computational mathematics and dynamical systems. Detailed open­
source implementations of the numerical methods are provided in an accompany­
ing collection of Jupyter notebooks linked from the electronic version of the book.
george haller holds the Chair in Nonlinear Dynamics at the Institute of 
Mechanical Systems of ETH Zurich. Previously, he held tenured faculty positions 
at Brown University, McGill University and MIT. For his research in nonlinear 
dynamical systems, he has received a number of recognitions including a Sloan 
Fellowship, an ASME T. Hughes Young Investigator Award, a Manning Assistant 
Professorship at Brown and a Faculty of Engineering Distinguished Professorship 
at McGill. He is an elected Fellow of SIAM, APS, and ASME, and is an external 
member of the Hungarian Academy of Science. He is the author of more than 150 
publications.




TRANSPORT BARRIERS AND 
COHERENT STRUCTURES 
IN FLOW DATA
Advective, Diffusive, Stochastic and Active Methods
GEORGE HALLER 
ETH Zurich
Prepared for publication with the assistance of Alex P. Encinas-Bartos
g.g Cambridge
UNIVERSITY PRESS

®J CAMBRIDGE
WF UNIVERSITY PRESS
Shaftesbury Road, Cambridge CB2 8EA, United Kingdom
One Liberty Plaza, 20th Floor, New York, NY 10006, USA
477 Williamstown Road, Port Melbourne, VIC 3207, Australia
314-321, 3rd Floor, Plot 3, Splendor Forum, Jasola District Centre, 
New Delhi-110025, India
103 Penang Road, #05-06/07, Visioncrest Commercial, Singapore 238467
Cambridge University Press is part of Cambridge University Press & Assessment, 
a department of the University of Cambridge.
We share the University’s mission to contribute to society through the pursuit of 
education, learning and research at the highest international levels of excellence.
www.cambridge.org
Information on this title: www.cambridge.org/9781009225175
DOI: 10.1017/9781009225199
© George Haller 2023
Prepared for publication with the assistance of Alex P. Encinas-Bartos
This publication is in copyright. Subject to statutory exception 
and to the provisions of relevant collective licensing agreements, 
no reproduction of any part may take place without the written 
permission of Cambridge University Press & Assessment.
First published 2023
Printed in the United Kingdom by TJ Books Limited, Padstow Cornwall
A catalogue record for this publication is available from the British Library
ISBN 978-1-009-22517-5 Hardback
Cambridge University Press & Assessment has no responsibility for the persistence 
or accuracy of URLs for external or third-party internet websites referred to in this 
publication and does not guarantee that any content on such websites is, or will 
remain, accurate or appropriate.

To the loving memory of my father,
Janos Haller (1934-2018),
a man of integrity, kindness and grace.


Contents
Preface
xiii
Acknowledgments 
xvi
1 Introduction 
1
1.1
The Mathematics of Transport Barriers
2
1.2
The Physics of Transport Barriers
3
1.3
Idealized Transport Barriers vs. Finite-Time Coherent Structures
4
1.4
Transport Barriers in Flow Separation and Attachment
4
1.5
Transport Barriers in Inertial Particle Motion
6
1.6
Barriers to Diffusive and Stochastic Transport
7
1.7
Barriers to Dynamically Active Transport
8
1.8
Coherent Sets, Coherence Clusters and Coherent States
9
2
Eulerian and Lagrangian Fundamentals
13
2.1
Eulerian Description of Fluid Motion
14
2.1.1 Eulerian Scalars, Vector Fields and Tensors
14
2.1.2 Streamlines and Stagnation Points in 2D Flows
15
2.1.3 Streamsurfaces and Stagnation Points in 3D Flows
17
2.1.4 Irrotational and Inviscid Flows
18
2.2
Lagrangian Description of Fluid Motion
19
2.2.1 Steady Flows as Autonomous Dynamical Systems
20
2.2.2 The Extended Phase Space
21
2.2.3 The Flow Map and Its Gradient
21
2.2.4 Material Surfaces, Material Lines and Streaklines
23
2.2.5 Invariant Manifolds
26
2.2.6 Evolution of Material Volume and Mass
26
2.2.7 Topological Equivalence and Structural Stability
28
2.2.8 Linearized Flow: The Equation of Variations
29
2.2.9 When Are the Eigenvalues of rv Relevant?
31
2.2.10 Lagrangian Aspects of the Vorticity
32
2.2.11 Dynamics Near Fixed Points of Steady Flows
34
2.2.12 Poincare Maps
34
2.2.13 Revisiting Initial Conditions: Poincare’s Recurrence Theorem
40
2.2.14 Convergence of Time-Averaged Observables: Ergodic Theorems
42
2.2.15 Lagrangian Scalars, Vector Fields and Tensors
44
2.3
Lagrangian Decompositions of Infinitesimal Material Deformation
48
2.3.1 Singular Value Decomposition (SVD)
48
2.3.2 Polar Decomposition
50
ix

x
Contents
2.3.3 Dynamic Polar Decomposition (DPD) 
53
2.4 
Are the Eulerian and Lagrangian Approaches Equivalent? 
56
2.5 
Summary and Outlook 
58
3
Objectivity of Transport Barriers
60
3.1
Common Misinterpretations of the Principle of Material Frame-Indifference
62
3.2
Objectivity Yields the Navier-Stokes Equation in Arbitrary Frames
63
3.3
Eulerian Objectivity
64
3.3.1 Objectivity of Eulerian Scalar Fields
65
3.3.2 Objectivity of Eulerian Vector Fields
66
3.3.3 Objectivity of Eulerian Tensor Fields
69
3.3.4 Galilean Invariance
71
3.4
Lagrangian Objectivity
72
3.4.1 Objectivity of Lagrangian Scalar Fields
72
3.4.2 Objectivity of Lagrangian Vector Fields
73
3.4.3 Objectivity of Lagrangian Tensor Fields
73
3.5
Eulerian-Lagrangian Objectivity of Two-Point Tensors
74
3.5.1 Objectivity of the Decompositions of the Deformation Gradient
75
3.6
Quasi-Objectivity
77
3.7
Some Nonobjective Approaches to Transport Barriers
77
3.7.1 Nonobjective Eulerian Principles
78
3.7.2 Objectivization of Nonobjective Eulerian Coherence Principles
86
3.7.3 Nonobjective Lagrangian Principles
90
3.8
Summary and Outlook
96
4
Barriers to Chaotic Advection
98
4.1
2D Time-Periodic Flows
99
4.1.1 Hyperbolic Barriers to Transport
102
4.1.2 Elliptic Barriers to Transport
106
4.1.3 Parabolic Barriers to Transport
110
4.2
2D Time-Quasiperiodic Flows
111
4.3
2D Recurrent Flows with a First Integral
113
4.3.1 Barriers from First Integrals in Time-Periodic Flows
115
4.3.2 Barriers from First Integrals in Time-Quasiperiodic Flows
117
4.4
3D Steady Flows
121
4.4.1 Definition of Transport Barriers from First-Return Maps
121
4.4.2 Transport Barriers vs. Streamsurfaces and Sectional Streamlines
121
4.4.3 Transport Barriers in 3D Steady Inviscid Flows
125
4.4.4 Transport Barriers in 3D Steady Flows with a Continuous Symmetry
130
4.4.5 Transport Barriers from Ergodic Theory
133
4.5
Barriers in 3D Time-Periodic Flows
135
4.6
Burning Invariant Manifolds: Transport Barriers in Reacting Flows
136
4.7
Summary and Outlook
139
5 
Lagrangian and Objective Eulerian Coherent Structures 
141
5.1 
Tracer-Transport Barriers in Nondiffusive Passive Tracer Fields 
144
5.2 
Advective Transport Barriers as LCSs 
148
5.2.1 Hyperbolic LCS from the Finite-Time Lyapunov Exponent 
149
5.2.2 FTLE Ridges Are Necessary (but Not Sufficient) Indicators of Hyperbolic LCS 
150
5.2.3 Extraction Interval and Convergence of the FTLE 
153

Contents
xi
5.2.4 
Numerical Computation of the FTLE 
154
5.2.5 
Extraction of FTLE Ridges 
156
5.2.6 
Hyperbolic LCSs vs. Stable and Unstable Manifolds in Temporally Recurrent Flows 156
5.2.7 
Repelling and Attracting LCSs from the Same Calculation 
158
5.2.8 
FTLE vs. Finite-Size Lyapunov Exponents (FSLE) 
160
5.2.9 
Parabolic LCSs from FTLE 
161
5.2.10 
Elliptic LCSs from the Polar Rotation Angle (PRA) 
164
5.2.11 
Elliptic LCSs from the Lagrangian-Averaged Vorticity Deviation 
169
5.3 
Local Variational Theory of LCSs176
5.3.1 
Local Variational Theory of Hyperbolic LCSs 
177
5.3.2 
Local Variational Theory of Elliptic LCSs 
186
5.3.3 
Local Variational Theory of Parabolic LCSs 
192
5.4 
Global Variational Theory of LCSs193
5.4.1 
Elliptic LCSs in 2D: Black-Hole Vortices 
194
5.4.2 
Computing Elliptic LCSs as Closed Null-Geodesics 
200
5.4.3 Shearless LCSs in 2D: Parabolic and Hyperbolic Barriers 
203
5.4.4 Unified Variational Theory of Elliptic and Hyperbolic LCSs in 3D 
208
5.5 
Adiabatically Quasi-Objective, Single-Trajectory Diagnostics for Transport Barriers 212
5.5.1 
Adiabatically Quasi-Objective Diagnostic for Material Stretching 
213
5.5.2 Adiabatically Quasi-Objective Diagnostic for Material Rotation 
215
5.5.3 Single-Trajectory, Adiabatically Quasi-Objective LCS Computations for the
AVISO Data Set 
217
5.5.4 Adiabatically Quasi-Objective Material Eddy Extraction from Actual Ocean Drifters 218
5.6 
Elliptic-Parabolic-Hyperbolic (EPH) Partition and LCSs 
220
5.7 
Objective Eulerian Coherent Structures (OECSs) 
226
5.7.1 Instantaneous Limit of the Flow Map 
227
5.7.2 Instantaneous FTLE 
228
5.7.3 Instantaneous Vorticity Deviation (IVD) 
229
5.7.4 Global Variational Theory of OECS in 2D Flows 
230
5.8 
Summary and Outlook 
240
6 
Flow Separation and Attachment Surfaces as Transport Barriers 
242
6.1 
Flow Separation in Steady and Recurrent Flows 
243
6.1.1 
Separation in 2D Steady Flows 
243
6.1.2 
Separation in 2D Time-Periodic Flows 
248
6.1.3 
Separation in 3D Steady Flows 
251
6.1.4 
Separation in 3D Recurrent Flows 
256
6.2 
Unsteady Flow Separation Created by LCSs 
259
6.2.1 2D Unsteady Separation 
259
6.2.2 3D Fixed Unsteady Separation 
271
6.3 
Summary and Outlook 
273
7 
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion 
275
7.1 
Equation of Motion for Inertial Particles 
276
7.2 
Relationship between Inertial and Fluid Motion 
277
7.3 
The Divergence of the Inertial Equation and the Q Parameter 
280
7.4 
Transport Barriers for Neutrally Buoyant Particles 
281
7.5 
Transport Barriers for Neutrally Buoyant Particles with Propulsion 
283
7.6 
Transport Barriers for Aerosols and Bubbles 
285
7.6.1 Attracting iLCS in 2D Steady Flows 
286

xii
Contents
7.6.2 Attracting iLCS in 3D Steady Flows
286
7.6.3 Attracting iLCS in 2D Time-Periodic Flows
288
7.6.4 Attracting iLCS in General 3D Flows
290
7.7
Inertial Transport Barriers in Rotating Frames
292
7.8
Inertial Transport on the Ocean Surface: Modeling and Machine Learning
295
7.9
Summary and Outlook
298
8 
Passive Barriers to Diffusive and Stochastic Transport 
300
8.1 
Unconstrained Diffusion Barriers in Incompressible Flows 
302
8.1.1 Unconstrained Diffusion Barriers in 2D Flows 
306
8.2 
Constrained Diffusion Barriers in Incompressible Flows 
312
8.2.1 Constrained Diffusion Extremizers in 2D Flows 
313
8.3 
Barriers to Diffusive Vorticity Transport in 2D Flows 
314
8.3.1 An Analytic Example: Vorticity Transport Barriers in a Decaying Channel Flow 316
8.3.2 Numerical Examples: Vorticity Transport Barriers as Vortex Boundaries in 
Turbulence 
318
8.4 
Diffusion Barriers in Compressible Flows 
320
8.5 
Transport Barriers in Stochastic Velocity Fields 
323
8.6 
Exploiting Diffusion Barriers for Climate Geoengineering 
328
8.7 
Summary and Outlook 
330
9 
Dynamically Active Barriers to Transport 
331
9.1 
Setup 
332
9.2 
Active Transport Through Material Surfaces 
333
9.3 
Lagrangian Active Barriers 
336
9.4 
Eulerian Active Barriers 
337
9.5 
Active Barrier Equations for Momentum and Vorticity 
338
9.5.1 
Barriers to Linear Momentum Transport 
338
9.5.2 
Barriers to Angular Momentum Transport 
339
9.5.3 
Barriers to Vorticity Transport 
339
9.6 
Examples of Active Transport Barriers 
340
9.6.1 
Active Transport Barriers in General 2D Navier-Stokes Flows 
341
9.6.2 
Directionally Steady Beltrami Flows 
345
9.7 
Active LCS Methods for Barrier Detection 
347
9.7.1 
Active Poincare Maps 
349
9.7.2 
Active FTLE (aFTLE) and Active TSE (aTSE) 
349
9.7.3 
Active PRA (aPRA) and Active TRA (aTRA) 
352
9.7.4 
The Choice of the Maximal Barrier Time, sN , in Active LCS Diagnostics 
354
9.7.5 
Relationship between Active and Passive LCS Diagnostics 
355
9.8 
Active Barriers in 2D and 3D Turbulence Simulations 
355
9.8.1 
2D Homogeneous, Isotropic Turbulence 
356
9.8.2 3D Turbulent Channel Flow 
359
9.8.3 
Eulerian Active Barriers from the Normalized Barrier Equation 
359
9.8.4 
Turbulent Momentum Transport Barriers (MTBs) 
363
9.8.5 
Momentum-Trapping Vortices in Turbulent Channel Flows 
364
9.9 
Summary and Outlook 
366
Appendix 
367
References 
390
Index 
406

Preface
Theme
Transport barriers are observed inhibitors of the spread of substances in flows. The collection 
of such barriers offers a powerful geometric template that frames the main pathways, or lack 
thereof, in any transport process.
The purpose of this book is to survey effective and mathematically grounded methods 
for defining, locating and leveraging transport barriers in numerical simulations, laboratory 
experiments, technological processes and nature. A large part of the surveyed material has 
been developed over the past two decades and has only been covered in scattered research 
articles, review articles and focus issues. The book takes stock of these methods and focuses 
on the ones that have a solid foundation and a broad applicability to data sets beyond simple 
model flows.
Scope
Chapter 1gives a brief, nontechnical survey of the material covered in later chapters and 
reviews some frequently used terminology for transport and coherence.
Chapter 2starts with a review of the relevant mathematical concepts in the language 
of fluid mechanics. The author believes that this is the broadest review of these concepts 
that is currently available in the fluid mechanics literature in a language accessible to non­
mathematicians.
Chapter 3makes a case for a recently emerging minimal self-consistency requirement for 
material transport barrier detection: independence of the observer (or objectivity). While 
objectivity is a fundamental axiom in general continuum mechanics, it is frequently misun­
derstood or ignored in fluid mechanics. This chapter gives the first available detailed account 
of objectivity for a fluids audience, pointing out a number of transport barrier definitions and 
detection methods that fail the litmus test of objectivity.
Chapter 4reviews classic dynamical systems results for mixing and transport. This is a 
condensed overview as most of these results apply only to idealized flow data. They are 
surveyed partly for historical reasons and partly as motivation for the more realistic transport 
barrier problems treated in later chapters. This chapter is the only part of the book whose 
concepts have been discussed (in smaller breadth but greater detail) in other available books 
on transport barriers, such as Ottino (1989); Wiggins (1992); Samelson and Wiggins (2006); 
Bollt and Santitissadeekorn (2013); Balasuriya (2016).
xiii

xiv
Preface
Chapter 5gives a review of available objective barrier detection methods for purely 
material (advective) transport and shows their applications in various areas of fluid mechanics. 
Chapter 6describes the kinematic theory of unsteady flow separation, which is also based on 
material barriers to transport, with applications to aerodynamic separation and flow control. 
Chapter 7deals with material barriers to the transport of finite-size (or inertial) particles.
Chapter 8describes recent results on material barriers to diffusive transport. Chapter 9 
describes very recent results on the detection of objective material barriers to the transport of 
dynamically active fields, such as momentum and vorticity. All methods in these chapters are 
illustrated on data sets. The Appendix provides further technical results from mathematics, 
mechanics and fluid mechanics for readers who want a deeper understanding of the methods 
described in the book.
Audience
The intended audience ranges from advanced undergraduates to faculty members doing 
research in the area of turbulence, geophysical flows, aerodynamics, chemical engineering, 
environmental engineering, flow visualization, computational mathematics and dynamical 
systems. This book can be used as a textbook for a course on mixing and transport, with an 
emphasis on data-driven approaches. It can also serve as a reference book for part of a course 
on modern methods in applied dynamical systems.
Computational resources
An open-source Jupyter notebook collection, TBarrier, implementing a number of the 
transport-barrier-detection algorithms we discuss in this book is available from
https://github.com/haller-group/TBarrier
Throughout this book, the reader will find direct references to the appropriate Jupyter 
notebooks after discussions on their underlying algorithms. These links cover all notebooks 
available at the time of completion of this manuscript. Over time, additional functions and 
algorithms will be added to the notebook repository.
Further numerical implementations of various methods covered in the upcoming chapters 
include the Matlab-based LCStool, developed by the author’s group for the identification of 
advective transport barriers in two-dimensional unsteady velocity data. LCStool is available 
from
https://github.com/haller-group/LCStool
A more recent Matlab-based resource is BarrierTool. Also developed at ETH Zurich, this 
graphical user interface (GUI) computes both advective and diffusive Lagrangian coherent 
structures and their objective Eulerian counterparts for two-dimensional flows. BarrierTool 
is available from
https://github.com/haller-group/BarrierTool

Preface 
xv
Finally, Julia-based versions of some of the advective and diffusive algorithms discussed here, 
as well as additional coherent structure detection tools, are implemented for two-dimensional
flows in CoherentStructures.jl, available at
https://coherentstructures.github.io/CoherentStructures.jl/stable/
This package was developed by Oliver Junge’s research group at the Technical University of 
Munich.

Acknowledgments
I am grateful to all my collaborators, postdocs and students from whom I have learned an 
enormous amount over a period of more than two decades. I am particularly indebted to 
Chris Jones, a former senior colleague at Brown University, who involved me at the time in a 
project to develop dynamical systems methods for ocean transport studies. This opportunity 
shaped my interest for years and led to many of the views and ideas described in this book.
I would also like to acknowledge critically important funding to my related research 
from the US Air Force Office for Scientific Research (AFOSR), the United Technologies 
Research Center (UTRC), the US National Science Foundation (NSF), the Natural Sciences 
and Engineering Research Council of Canada (NSERC) and the German Science Foundation 
(DFG). During the preparation of this book, I greatly benefited from the hospitality of the 
Departments of Mechanical Engineering at EPFL and MIT.
I am particularly thankful to Alex Encinas-Bartos for his outstanding work with the 
creation of the Jupyter notebook collection, TBarrier, which implements numerically a 
good portion of the material discussed in this book. His helpful comments on an early draft of 
the manuscript were also much appreciated. My special thanks go to Balint Kaszas, who read 
and commented on the same draft. He also tested TBarrier extensively, made very useful 
suggestions and implemented some modifications to the code on his own. Additionally, I am 
pleased to acknowledge the very helpful advice and assistance I have received as author from 
David Tranah and Anna Scriven of Cambridge University Press.
Last but not least, I am immensely grateful to my wife, Krisztina, for her invaluable support 
and encouragement during the preparation of this book and beyond.
xvi

1
Introduction
Figure 1.1 Oil distribution in the 2010 Deepwater Horizon oil spill in the Gulf of 
Mexico. Apparent barriers to the transport of oil are readily observable. Image: Daniel 
Beltra (used with permission).
Flows in nature tend to generate striking patterns in the tracers they carry. An example is the 
oil spill distribution in Fig. 1.1,which is framed by apparent barriers to the spread of the oil 
in certain directions. More often than not, one’s primary interest is to find such barriers and 
hence understand the overall direction and rate of transport without necessarily identifying 
pointwise oil concentration values with high accuracy. Figure 1.1 also conveys the strong 
technological and societal needs for uncovering, forecasting and shaping such barriers.
We think of transport barriers as observed inhibitors of the spread of substances in flows. 
They offer a simplified global template for the redistribution of those substances without 
the need to simulate or observe numerous different initial distributions in detail. Because of 
their simplifying role, transport barriers are broadly invoked as explanations for observations 
in several physical disciplines, including geophysical flows (Weiss and Provenzale, 2008), 
fluid dynamics (Ottino, 1989), plasma fusion (Dinklage et al., 2005), reactive flows (Rosner, 
2000) and molecular dynamics (Toda, 2005).
Despite their frequent conceptual use, however, transport barriers are rarely defined pre­
cisely or extracted systematically from data. The purpose of this book is to survey effective 
and mathematically grounded methods for defining, locating and leveraging transport barriers 
1

2
Introduction
in numerical simulations, laboratory experiments, technological processes and nature. In the 
rest of this Introduction, we briefly survey the main topics that we will be covering in later 
chapters.
1.1 The Mathematics of Transport Barriers
Throughout this book, we will adopt the geometric view of nonlinear dynamical systems 
theory on transport. That is, rather than focusing on individual fluid particle positions or 
pointwise concentration values, we seek to identify key invariant surfaces with a major 
impact on shaping transport patterns.
To illuminate the significance of such invariant surfaces, we note that models of transport 
phenomena are often tested based on their ability to reproduce the evolution ofan initial con­
dition or initial distribution. Due to their inherent sensitivity on initial conditions, parameters 
and uncertainties, however, even predictions from highly accurate models can ultimately 
display vast discrepancies with individual observations. A more meaningful way to test the 
validity of models is to assess their ability to reproduce transport barriers of the physical 
process accurately.
Figure 1.2 shows a conceptual example in which a highly accurate dynamical model (black 
dots) for the true dynamics (solid red) makes a vastly inaccurate prediction for the evolution 
of a single initial condition (blue), yet reproduces a transport barrier (the unstable manifold 
of a saddle point) of the true dynamics with high accuracy. Clearly, it is the latter metric in 
which the model should be assessed and found very accurate.
Figure 1.2 A good model for a transport process should accurately predict transport 
barriers but not necessarily individual trajectories.
A transport barrier can only block transport locally if its dimension is precisely one 
less than the dimension of the flow domain, as in Fig. 1.2.Such smooth surfaces are 
called codimension-one invariant manifolds in dynamical systems theory. They are curves 
in two-dimensional flows and two-dimensional surfaces in three-dimensional flows. While 
the impact of transport barriers is apparent in Figs. 1.1-1.9, their ever-shifting location, life 
span and intrinsic properties are not readily recoverable from instantaneous snapshots of an 
unsteady flow.

1.2 The Physics of Transport Barriers
3
Our underlying assumption will be that either the velocity field or a set of its trajectories is 
available either from observations or numerical simulations. With this assumption, the two 
fundamental questions we seek to answer are:
(1) What defines the fundamental barriers to the transport of active and passive tracers in 
the flow?
(2) How can we locate the most influential transport barriers without solving their underlying 
transport equation?
To review the technical material needed to answer these questions, Chapter 2 recalls relevant 
concepts from the geometric theory of dynamical systems and continuum mechanics in the 
context and language of fluid mechanics. In later chapters, we will build on these concepts 
to answer the two main questions posed above under increasingly fewer assumptions. The 
order of chapters will roughly mirror actual chronological developments in fluid mechanics 
and applied mathematics, each describing ideas and results of interest in their own right.
1.2 The Physics of Transport Barriers
While the techniques for transport-barrier detection we put forward in this book are quite 
diverse, we will set one common physical requirement for all of them: their predictions 
must be experimentally verifiable. Experimental verifiability for predicted transport barriers 
means that they should be detectable via material tracers such as dye, weakly diffusive smoke 
or small particles.
The requirement of unambiguous experimental reproducibility has an important implica­
tion: any self-consistent description of transport barriers must be independent of the frame 
of reference of the observer. For instance, barriers framing the evolution of an oil spill, such 
as the one shown in Fig. 1.1,are clearly identified as the same set of material points by 
an observer on the beach, another one on a ship and a third one in a circling helicopter, as 
illustrated in Fig. 1.3.
Figure 1.3 Observed transport barriers highlighted by tracers must be objectively 
defined, i.e., independently of the observer’s frame of reference.

4
Introduction
These material barriers move on different orbits in each observer’s frame of reference, yet 
all three observers agree exactly on where the edges of the oil spill are at any time instance. 
Accordingly, any self-consistent definition or detection method for transport barriers should 
be objective, i.e., indifferent to the observer and return the same set of material points forming 
the barrier in any observer frame. Beyond its theoretical significance, this litmus test for the 
self-consistency of barrier theories has a very practical motivation. If resource allocation or 
countermeasures are planned based on the location of transport barriers in a flow, there is no 
room for disagreement among observers.
InChapter 3,we will discuss the principle of material frame indifference in detail and 
explore its use as a litmus test for the self-consistency of various views on transport barriers.
1.3 Idealized Transport Barriers vs. Finite-Time Coherent Structures
As we will see in Chapter 4,purely advective transport barriers can be defined unambiguously 
in flows that are known for all times. Such definitions, e.g., those requiring saddle-type 
behavior for a material surface for all times, exploit properties of the barriers that make 
them locally unique in the flow. The area of transport studies concerned with such idealized 
systems is generally referred to as chaotic advection. In its idealized setting, chaotic advection 
provides very helpful motivation for the main types of material barriers one encounters in 
nature. It also turns out that some approaches to diffusive and dynamically active transport 
barriers also yield steady velocity fields (barrier vector fields) that can be analyzed by the 
methods we review for steady flows in Chapter 4.
In practical problems, however, finite-time transport is of interest. Flow behavior over a 
finite time interval is continuous: all close enough trajectories remain close to each other. 
Consequently, infinitely many neighboring trajectories will satisfy any barrier definition 
phrased via inequalities that involve continuous quantities. As a result, the defining features 
of barriers exploited in chaotic advection no longer yield unique material surfaces.
One way to address this nonuniqueness problem is to identify barriers that act as observed 
centerpieces of material deformation over a finite time interval of interest. We perceive 
a surface to assume this role if it remains coherent, i.e., keeps its spatial integrity without 
developing smaller scales (filaments) during its temporal evolution. We will call such uniquely 
resilient material sets Lagrangian coherent structures (LCSs), as first coined by Haller and 
Yuan (2000). These LCSs act, for instance, as surfaces bounding the globally complex but 
temporally coherent cloud patterns in the atmosphere of Jupiter, as shown in Fig. 1.4.
Instantaneous limits of these material coherent structures are called objective Eulerian 
coherent structures (OECSs), which represent short-term, approximately material barriers. 
Unlike LCSs, OECSs are not material and hence can frame the creation, collision, break-up 
and disappearance of transport barriers in the flow. We will discuss LCSs and OECSs in 
detail in Chapter 5.
1.4 Transport Barriers in Flow Separation and Attachment
Flow separation involves the detachment of fluid from a rigid boundary, resulting in either 
the creation of a local recirculation zone (separation bubble) or the global breakaway of fluid 
particles from the boundary. Highly unsteady flows often display both types of separation, 
as illustrated by the separation patterns behind the airfoil shown in Fig. 1.5.

1.4 Transport Barriers in Flow Separation and Attachment
5
Figure 1.4 Enhanced image of cloud patterns in the atmosphere of Jupiter, as seen 
by the Juno mission in 2020. As we show in later chapters, such patterns are created 
and shaped by hidden Lagrangian coherent structures (LCSs), such as material jets, 
eddies and fronts. Image: NASA/JPL-Caltech/SwRI/MSSS/Gerald Eichstadt /Sean 
Doran.
Figure 1.5 Visualization of aerodynamic separation and reattachment along transport 
barriers attached to an airfoil in a wind tunnel. Image: German Aerospace Center 
(DLR), CC-BY 3.0.
Separation depletes the kinetic energy content of the flow near the wall, leading to a 
degradation in the operational performance of engineering devices. Specifically, separation 
on a bluff body can increase the pressure drag significantly, whereas separation in a diffuser 
decreases the pressure recovery. Flow attachment is the opposite phenomenon, involving the 
sustained convergence of fluid elements toward a well-defined boundary location. Local sep­
aration necessarily involves a reattachment of the flow that forms the downstream boundary 
of the separation zone, as seen inFig. 1.5.
While separation has a clear impact on aerodynamic forces acting on the flow boundary, 
its experimental detection exploits its impact of fluid particle transport. Indeed, flow visu­
alizations of the type shown in Fig. 1.5 are only possible because particles in the separated 
and unseparated flow regions are kept apart from each other by material transport barriers. 
These separation surfaces collect nearby particles along the boundary and eject them into 

6
Introduction
the mean flow. In contrast, reattachment surfaces guide particles from the mean flow to the 
wall and then repel them along the boundary.
While typical wall-anchored material surfaces will stretch and fold, separation and reat­
tachment surfaces distinguish themselves by remaining coherent. Therefore, using the termi­
nology introduced in §1.3, we can view separation surfaces as attracting LCSs and attachment 
surfaces as repelling LCSs.
Unlike general LCSs, however, separation and reattachment surfaces exert weak attrac­
tion and repulsion near flow boundaries characterized by no-slip boundary conditions. In 
dynamical systems terms, these surfaces are nonhyperbolic invariant manifolds, unless the 
boundary can be characterized with free-slip conditions. This makes most LCS diagnostic 
tools inefficient in a small neighborhood of a no-slip boundary. At the same time, the direct 
connection of these LCSs with the boundary facilitates their more detailed local analysis. 
This in turn enables the identification of separation and reattachment surfaces near the wall 
solely based on the derivatives of the velocity field along the boundary, without material 
advection. We will discuss these results for LCSs and OECSs forming separation surfaces 
and separation spikes in Chapter 6.
1.5 Transport Barriers in Inertial Particle Motion
Patterns formed by finite-size (or inertial) particles carried by fluid flows are often notably 
different from those seen for fluid particles in dye visualizations. Specifically, while fluid 
elements in an incompressible fluid cannot exhibit clustering or scattering, both phenomena 
are well documented in inertial particle motion in incompressible fluids. A spectacular albeit 
alarming example of inertial clustering is the Great Pacific Garbage Patch, which covers an 
area of about 1:6 million square kilometers (three times the size of France) (see Fig. 1.6).
Figure 1.6 A transport barrier formed by inertial particles: the Great Pacific Garbage 
Patch, a floating island of accumulating garbage in the Pacific Ocean. Image: Ocean 
Cleanup.

1.6 Barriers to Diffusive and Stochastic Transport
7
Microplastics constitute about 94 % of the roughly 1:8 trillion pieces of plastic in this patch, 
even though they only make up 8% of the total mass of 80;000 tons.1 Given the characteristic 
length scales of the ocean, all objects forming the garbage patch can be considered inertial 
particles.
InChapter 7, we will discuss the fundamentals of transport barriers for inertial particle 
motion. It turns out that these barriers can be uncovered by applying the LCS methods of 
Chapter 5 to a modification of the carrier fluid velocity field that accounts for inertial effects.
1.6 Barriers to Diffusive and Stochastic Transport
In Chapter 8, we will discuss barriers to the transport of passive tracers whose diffusion 
cannot be ignored relative to their advective redistribution over the time scales of interest. 
An example is the long-term mixing of dye in a gently stirred glass of water, as shown in 
Fig. 1.7. To model such a mixing process accurately, we can no longer set the diffusivity to 
zero in the advection-diffusion equation governing the spread of the dye.
Figure 1.7 Diffusive mixing of dye framed by transport barriers in a glass of water. 
Image: Nathan Dumlao at unsplash.com.
One might wonder why we bother defining and identifying transport barriers in diffusive 
tracer fields, given that they are readily seen in numerical simulations and experiments such 
as the one shown in Fig. 1.7. To understand our motivation, one must remember that observed 
surfaces with large concentration drops across them are not necessarily intrinsic barriers to 
tracer transport. Rather, many of them are remnants of high gradients in the initial tracer 
distribution. Indeed, the large concentration drop across the boundary of the initial dye drop 
in the experiment shown in Fig. 1.7 will persist as a slowly diffusing dye-fluid interface for 
very long times.
Similarly, the lack of large concentration gradients in a given flow domain may simply be 
due to the concentration being fully mixed or fully absent in that domain. Indeed, there are 
also transport barriers in the region yet unpenetrated by the dye in the experiment shown in 
Fig. 1.7. Those barriers will impact other concentration fields (say, the water temperature) 
with a different initial distribution carried by the same flow.
1 Most of that mass has been found to be made up of abandoned fishing gear (Lebreton et al., 2018).

8
Introduction
Finally, one should consider that while large concentration drops seen in finite-time tracer 
evolution will often reflect the impact of transport barriers, these drops will not coincide with 
the barriers themselves. The amount of discrepancy between concentration drop locations and 
actual transport barriers is generally unclear: convergence of the latter to the former can only 
be expected in flows with well-defined asymptotic behavior. Identifying intrinsic transport 
barriers that are free from these idiosyncrasies of a specific observed tracer distribution is 
essential for universal conclusions valid for the transport of all tracer fields.
A closely related passive transport problem, stochastic transport, is concerned with the 
transfer of material fluid elements across spatial domains by a velocity field subject to 
uncertainties. These uncertainties are most often modeled using Brownian motion.
Figure 1.8 Drifter trajectories released and tracked in the Gulf of Mexico over a 
period of one year. The drifters do not cross an apparent transport barrier acting as 
the boundary of a forbidden zone west off the Florida coastline. (Occasional straight 
lines indicate captured and transported drifters.) Image: Yang, H. et al. (1999).
For example, drifter trajectories in the Gulf of Mexico, along with an apparent barrier they 
never cross (see Fig. 1.8), are complex enough to view as trajectories of a random flow.
The connection between trajectory distribution in such a random flow and the evolution 
of a diffusive scalar field under the deterministic component of the velocity field is given 
by a classic result: the probability density function of the random flow satisfies the Fokker- 
Planck equation, which can be recast as an advection-diffusion equation driven by the drift 
component of the velocity field. Using this connection, we will discuss the definition and 
properties of barriers to stochastic transport in Chapter 8.
1.7 Barriers to Dynamically Active Transport
In contrast to the passive transport concepts we have discussed so far, active transport 
involves the transfer of dynamically active tracers. Such active tracers are scalar or vector 
fields impacting the flow velocity directly rather than simply being carried by it. Active 
tracers of practical interest include the kinetic energy, vorticity and linear momentum.

1.8 Coherent Sets, Coherence Clusters and Coherent States
9
Framing the spatiotemporal evolution of these dynamically active fields informally using 
the concept of transport barriers is common practice in the literature. As a relevant example, 
Fig. 1.9shows apparent barriers to vorticity transport in the turbulent flow near a spinning 
rotor.
Figure 1.9 Apparent transport barriers in the instantaneous vorticity distribution on a 
cutting plane for a spinning rotor. Image: Neal M. Chaderjian, NASA Ames Research 
Center.
Studying dynamically active fields, however, is even more challenging than the transport 
problems we have already discussed. First, the transport equation for these quantities is 
a nonlinear partial differential equation (PDE) for the velocity field. For fluid flows, this 
PDE is the Navier-Stokes equation, whose solution structure in three dimensions is still not 
fully understood. Second, unlike passive scalar concentration fields, all physically relevant 
dynamically active fields are nonobjective: they depend on the frame of the observer. This 
frame dependence is a serious challenge if one wants to conform to the basic requirement of 
objectivity for transport barriers that we formulated in §1.2.
InChapter 9,we will discuss how barriers to dynamically active transport can also be char­
acterized and located in an observer-independent way. This in turn makes the experimental 
visualization of these barriers via material tracers feasible in practice.
1.8 Coherent Sets, Coherence Clusters and Coherent States
We close this Introduction by mentioning three notions of coherence that we will not be 
discussing in further detail here. They are beyond the scope of this book because their 
primary focus is not transport barriers.
The first such notion is that of a coherent set: an equivalence class of trajectories that stay 
closer to each other during their evolution than to other trajectories. Specifically, finite-time 
coherent sets comprise trajectories that disperse slower than others over a given finite time in­
terval of interest (see, e.g., Froyland et al., 2010;Froyland, 2013;Bollt and Santitissadeekorn, 
2013). This view of coherence focuses on sets enclosed by closed transport barriers as op­
posed to the barriers themselves. A coherent set is defined as a region of initial conditions that 
continues to have significant overlap with its deterministically advected final position even if 
a small random perturbation (or diffusion) is added to its originally deterministic advection.

10
Introduction
Available approaches seek to locate such coherent sets based on properties of the transfer 
operator (or Frobenius-Perron operator), which maps passive, scalar-valued functions de­
fined over initial positions of fluid particles into the evaluations of the same functions over 
later positions of those particles.2 More recent reformulations and extensions of the transfer 
operator approach are given by Froyland (2015); Froyland and Kwok (2017); Froyland et al. 
(2020) and the references cited therein.
The transfer operator can be approximated by its finite-dimensional discretization P, 
constructed as a matrix of transition probabilities within a finite partition of the flow domain. 
The second (left) singular vector of P is then expected to characterize a dominant coherent 
set after appropriate thresholding. Further coherent structures are expected to appear from 
the appropriate thresholding of higher singular vectors of P. The number of singular vectors 
to consider and the applied thresholding are typically determined empirically by inspection 
of the unprocessed singular vectors of P. Transport barriers are then inferred by implication 
as boundaries of the coherent sets obtained in this fashion.
A notion related to coherence sets is the coherence cluster, which comprises a group of 
trajectories that are more similar to each other than to other groups. Methods for identifying 
clusters in data sets were originally developed in the computer science literature (see, e.g., 
Everitt et al., 2011). Using such ideas, Froyland and padberg-gehle (2015) use fuzzy C- 
means clustering to identify clusters of initial conditions that remain close to the same 
virtual cluster center. Hadjighasem et al. (2016) seek clusters as sets of trajectories that 
maintain small relative distances to each other. They note that clusters can be identified 
by applying the technique of spectral clustering to the eigenvectors of matrix (the graph 
Laplacian) that encodes the average distances among trajectories. Schlueter-Kuck and Dabiri 
(2017) use the same clustering approach but with a different distance function. Banisch and 
Koltai (2017) apply the spectral clustering approach in the transfer operator framework.
These spectral methods targeting coherent sets or coherence clusters are different in spirit 
from the geometric approaches we will be surveying in this book. First, we will focus on 
barriers minimizing advective, diffusive, stochastic or active transport of a physical quantity 
without requiring the barriers to be closed. In contrast, barrier surfaces inferred from spectral 
methods have to be closed. As a consequence, spectral methods are inapplicable to some of 
the most frequently observed barriers, such as jets and fronts in the ocean, just because they 
happen to be open. Second, spectral approaches require empirical user input in the selection 
of the relevant singular vectors, which is not the case for the geometric methods we will 
survey. To illustrate the differences between probabilistic and geometric approaches on a 
specific flow, Fig. 1.10 shows a comparison of coherent sets obtained from transfer operator 
methods with transport barriers obtained from LCS methods in a two-dimensional, spatially 
double-periodic turbulence simulation.
A third frequently used notion of coherence in contemporary fluid mechanics is that of an 
exact coherent state3 (or ECS), which refers to an exact, nonlinear solution of the Navier- 
Stokes equation in canonical shear flows, such as plane Couette, Poiseuille and pipe flows 
(Waleffe, 1998,Graham and Floryan, 2021). These solutions display simple spatiotemporal
2 Technically speaking, the transfer operator is the pushforward operation carried out by the flow on measurable 
functions.
3 Exact coherent states are sometimes called exact coherent structures, causing occasional confusion with the 
coherent structures discussed in §1.3 and elsewhere in this book.

1.8 Coherent Sets, Coherence Clusters and Coherent States
11
Transport barriers: 
hyperbolic (open) 
and elliptic (closed) 
Lagrangian coherent 
structures
Coherent sets: 
thresholded singular 
vectors of the transfer 
operator and its 
hierarchical version
Figure 1.10 Coherent sets obtained as thresholded second singular vectors of the 
transfer operator approach and from its hierarchical version, which applies the original 
algorithm again within each coherent set recursively n times (Ma and Bollt,2013). 
Also shown are transport barriers obtained as Lagrangian coherent structures (LCSs) 
from the finite-time Lyapunov exponent (FTLE) and from the Lagrangian-averaged 
vorticity deviation (LAVD). The FTLE highlights hyperbolic LCSs and the LAVD 
highlights elliptic LCSs, as we will discuss in Chapter 5.Adapted from Hadjighasem 
et al. (2017).
n n.^^^- 
J'', n
behavior that is nevertheless reminiscent of coherent features of turbulent solutions that 
arise recurrently. This is because ECSs are of saddle type and hence other time-evolving 
Navier-Stokes velocity fields may, from time to time, pass by ECSs. These passing solutions 
will mimic some of the spatial features of the approached ECSs for a while before departing. 
Examples of ECSs include steady-state, time-periodic or traveling-wave solutions, such as 
the one shown in Fig. 1.11.
Features of ECSs have traditionally been assessed via heuristic visualization tools, such as 
instantaneous level surfaces ofa velocity component (see, e.g., Fig. 1.11). This visualization 
approach is useful in a direct comparison between the features of ECS velocity fields and 
those of turbulent velocity fields. However, the surfaces obtained in this fashion tend to 
differ from experimentally observable material coherent structures even in two-dimensional 
steady flows (see §3.7.1 for examples). In summary, while the transport barriers and coherent 
structures we discuss here are special material surfaces of a given velocity field, the ECSs are 
special velocity fields themselves. Their particular transport barriers and coherent structures 
can nevertheless be studied by the methods discussed in the upcoming chapters of this book.

12
Introduction
0
-1
-2
y
Figure 1.11 Exact coherent state (ECS) in a channel flow moving in the positive x- 
direction of a channel at Reynolds number Re = 376. Level curves of the streamwise 
velocity in the y = 0 plane are shown together with isosurfaces of the streamwise 
vorticity. Positive vorticity is shown in blue, negative in red. Adapted from Waleffe 
(2001).

2
Eulerian and Lagrangian Fundamentals
Classical continuum mechanics focuses on the deformation field of moving continua. This 
deformation field is composed of the trajectories of all material elements, labeled by their 
initial positions. This initial-condition-based, material description is what we mean here by 
the Lagrangian description of fluid motion (seeFig. 2.1).
Lagrangian description
Eulerian description
Figure 2.1 Lagrangian (trajectory-based) and Eulerian (velocity-field-based) de­
scriptions of fluid flow.
In contrast to typical solid-body deformations, however, fluid deformation may be orders 
of magnitude larger than the net displacement of the total fluid mass. For example, the center 
of mass of a turbulent, incompressible fluid in a closed tank experiences no displacement in 
the lab frame, yet individual fluid elements undergo deformations that no material used in 
structural engineering would withstand. The difficulty of tracking individual fluid elements 
has traditionally shifted the focus in fluid mechanics from individual trajectories to the 
instantaneous velocity field and quantities derived from the velocity field, such as the vorticity 
and momentum. We refer here to the instantaneous-position-based approach to continuum 
motion as the Eulerian description (seeFig. 2.1).
Our discussion of the Eulerian view of fluids will be substantially shorter than usual 
in fluids textbooks, mainly because the focus here is on flow kinematics rather than the 
governing equations of fluids. Indeed, all transport barriers and coherent structures to be 
discussed in this book can be defined and located purely from available velocity data. The 
only conceptual exceptions to this rule are barriers to the transport of dynamically active 
quantities (seeChapter 9), whose identification depends on the constitutive equation of the 
fluid. Once this dependence is clarified, however, the active barriers can still be identified 
from operations performed solely on the velocity field.
13

14
Eulerian and Lagrangian Fundamentals
In contrast, our review of Lagrangian aspects of fluid mechanics in this chapter will be 
more extensive than customary in fluid mechanics textbooks, including those fully dedicated 
to Lagrangian fluid dynamics (such as Bennett, 2006). This is because our analysis of 
material barriers to transport will rely extensively on tools from dynamical systems theory 
and continuum mechanics that are not traditionally part of the toolkit of fluid mechanics.
2.1 Eulerian Description of Fluid Motion
We refer to scalar, vector and tensor fields defined over spatial positions x 2 U Rn as 
Eulerian quantities. The bounded spatial domain U will be either two-dimensional (2D) for 
n = 2 or three-dimensional (3D) for n = 3. Unless otherwise noted, we will always assume 
that these fields are known for times t ranging over a finite time interval»11, 12].
The central Eulerian quantity in descriptions of flow evolution is the velocity field v(x; t°, 
which we call steady if it is constant in time (i.e., of the form v(x)). When the velocity field 
does depend on time explicitly, we call it unsteady.
2.1.1 Eulerian Scalars, Vector Fields and Tensors
A scalar field defined at all positions x and times t is an Eulerian scalar field. For instance, 
any evolving tracer concentration field c(x; t° is an Eulerian scalar field.
An Eulerian vector field is a time-dependent vector field u(X; t ° defined on the domain U. 
The velocity field v(x t° of a moving fluid as well as its vorticity ! (x t° = r x v(x, t° are 
examples of Eulerian vector fields. In contrast, an eigenvector field ei(x, t° of an Eulerian 
tensor field (to be defined below) is, in general, not an Eulerian vector field because it has 
no well-defined length or orientation. Accordingly, we refer to such eigenvector fields as 
Eulerian direction fields.
An Eulerian tensor field A(x t ° is a linear mapping family that maps each tangent space 
TXRn (see Appendix A.4) into itself at all positions X 2 U for all times t 2 »t1; t2]. Examples 
include the velocity gradient tensor Vv(X; t°, the symmetric rate-of-strain tensor S(x t° and 
the skew-symmetric spin tensor W(x t°, with the latter two defined as
s = 2 hrv + (rv°T], w = 2 hrv -(W]. 
(2.1)
Here and going forward, the superscript T will refer to transposition. An important relation­
ship between the spin tensor and the vorticity vector is
We = 2 !xe 
(2.2)
for all vectors e 2 R3 (seeAppendix A.12). In other words, the vector associated with the 
spin tensor is half of the vorticity vector.
Passive Eulerian scalar, vector and tensor fields are field quantities whose evolution has no 
impact on the underlying velocity field v. Examples of such fields include a dye concentration 
field c (X; t°, its gradient vector field r c(x t° and its Hessian tensor field r2c(x t°. In contrast, 
active Eulerian fields, such as the velocity norm |v(x t)|, the vorticity vector ! (x t° and the 
rate-of-strain tensor S(x t°, are fields whose evolution directly impacts the velocity field.

2.1 Eulerian Description of Fluid Motion 
15
2.1.2 Streamlines and Stagnation Points in 2D Flows
A parametrized curve that is everywhere tangent to the velocity field v(x, t° at time t is called 
an instantaneous streamline, as shown in Fig. 2.1. Any streamline x(5; t), parametrized by 
s 2 R at time t, is therefore composed of solutions of the autonomous ordinary differential 
equation (ODE)
X0 = V(X; t °; 
(2.3)
in which the prime denotes differentiation with respect to 5 and t plays the role of a parameter. 
We call the flow incompressible if v is divergence-free (or solenoidal), i.e., rv 0.
For 2D incompressible flows, there exists a stream function ((x, t° such that the velocity 
field can be written as
V(X; t ° = jr((X; t °; 
J =^ 
0 ^. 
(2.4)
At any time instant t, streamlines are contained in the level curves (or isocontours) of ((x, t), 
given that
d-((x(5°, t° = r((x(5°, t° ■ v (x(5°, t° = <r((x(5°, t\jr((x(s),t)> = 0 
(2.5)
d5
holds by the skew-symmetry of the matrix J. Equation (2.4) says that the stream function 
r ((x, t° acts as a Hamiltonian function for 2D incompressible fluid particle motion (see 
Appendix A.5 for more on Hamiltonian systems). We note that in 3D flows, no scalar stream 
function is guaranteed to exist from which the full velocity field could be derived.
An instantaneous stagnation point is a time-dependent point p(t° at which the velocity 
field v vanishes at time t, i.e.,
v(p( t °; t ° = jr((p( t °; t ° = 0: 
(2.6)
At such points, the linearization
e0 = r V(P( t °; t X = jr2((p( t °; t °<£; 
£ 2 R2 
(2.7)
of the differential equation (2.3) determines the instantaneous local streamline geometry, 
which depends on the eigenvalues and eigenvectors of Vv(p(t), t°. The eigenvalues of the 
velocity gradient satisfy the characteristic equation
A2 - (r ■ v° A + det rv = 0. 
(2.8)
This equation simplifies to
A2 +detrv= 0 
(2.9)
for incompressible flows, yielding the two eigenvalues of Vv(p(t°, t° in the form
A1;2( t ° = ±p- det rv(p( t °, t °. 
(2.10)
Figure 2.2 shows the possible local streamline geometries for different A1;2 configurations: 
hyperbolic (saddle-type) stagnation point; elliptic (center-type) stagnation point; nonde­
generate parabolic stagnation point (local shear flow arising near a stagnation point on 
a free-slip boundary); degenerate parabolic stagnation point (locally quiescent flow aris­
ing near a point on a no-slip boundary). At nondegenerate parabolic stagnation points,

16
Eulerian and Lagrangian Fundamentals
only one independent eigenvector exists. At degenerate parabolic stagnation points, any 
vector is an eigenvector. Importantly, these instantaneous streamline geometries only give 
an accurate description of fluid particle motion if the velocity field is steady. In unsteady 
flows, the fluid motion can differ vastly from the local streamline geometry, as we shall see 
throughout §2.2.
hyperbolic stagnation 
point
e2
e1
A= = A2€R-{°}
elliptic stagnation 
point
A2 = ±iu
parabolic stagnation 
points
(nondegenerate)
e1 = e2
parabolic stagnation 
points 
(degenerate)
11 =12 = ° e1 = e2 
1= =12 = 0, e1,l’cR
Figure 2.2 The four possible linearized streamline geometries at an instantaneous 
stagnation point of a 2D incompressible flow. The eigenvalues of rv(p(t°, t° are 
1 and 2, with corresponding real eigenvectors e1 and e2, whenever 1;2 are real 
numbers.
Instantaneous flow patterns in the velocity field of a 2D flow are separated from each 
other by special streamlines, or separatrices, across which there is a change in the topology 
of streamlines. By the implicit function theorem (see Appendix A.1), such a change in 
the streamline geometry can only occur near points where the gradient r^(x, t° vanishes. 
We then conclude by Eq. (2.6) that separatrices between different streamline patterns must 
necessarily be streamlines that contain at least one stagnation point. With the exception 
of elliptic stagnation points, all other types of stagnation points shown in Fig. 2.2 can be 
contained in a streamline. Accordingly, the possible separatrices in 2D incompressible flows 
are shown in Fig. 2.3.
Of these, homoclinic streamlines connecting hyperbolic stagnation points to themselves 
and heteroclinic streamlines connecting two hyperbolic or nondegenerate parabolic stagna­
tion points on a boundary to each other are structurally stable, i.e., smoothly persist under 
small perturbations of the stream function (see §2.2.7 for a more formal definition of struc­
tural stability). Indeed, the endpoints of these connecting streamlines are forced to be on the 
same level set of the stream function even after small perturbations, as illustrated in Fig. 2.4 
(left).
In contrast, heteroclinic streamlines connecting two points away from boundaries or an 
off-boundary point to an on-boundary point are structurally unstable. Indeed, in the absence 
of any symmetry that would force the endpoints of such a connection to remain on the same 
level set of the stream function, small perturbations to the stream function will generally 
cause the two stagnation points to move to different level curves of the stream function (see 
Fig. 2.4 (right)).

17
2.1 Eulerian Description of Fluid Motion
Separatrices between different streamline patterns
Figure 2.3 Structurally stable and unstable separatrices between instantaneous 
streamline patterns of 2D incompressible flows. (a) Streamline homoclinic to a hy­
perbolic stagnation point; (b) Streamline connecting a free-slip or no-slip boundary 
to itself, acting as the boundary of a separation bubble; (c) Heteroclinic streamlines 
between two hyperbolic stagnation points; (d) Heteroclinic streamline between a 
free-slip or no-slip boundary and a hyperbolic stagnation point.
Figure 2.4 (Left) Under a small perturbation (x, t° of a stream function ^(x, t°, 
a homoclinic streamline emanating from a saddle-type stagnation point p(t° will 
persist as a nearby streamline homoclinic to a perturbed stagnation point p(t°. (Right) 
Under a similar perturbation, a heteroclinic streamline connecting two saddle-type 
stagnation points, p1 (t° and p2(t°, will generically break into a homoclinic streamline 
connecting p2(t° to itself and a pair of locally open streamlines emanating from p1 (t°.
2.1.3 Streamsurfaces and Stagnation Points in 3D Flows
A 2D surface that is everywhere tangential to the velocity field v(x, t° at time t is called 
an instantaneous streamsurface. All streamsurfaces are composed entirely of streamlines, 
including possible stagnation points. For this reason, streamsurfaces are invariant sets of the 
ODE (2.3).

18
Eulerian and Lagrangian Fundamentals
Stagnation points continue to be the most important building blocks of the global streamline 
and streamsurface geometry in 3D flows. As in 2D flows, instantaneous stagnation points are 
defined by the equation
V(p(t°; t° = 0: 
(2.11)
The local geometry of streamlines near stagnation points can again be identified from the 
linear stability analysis of the linearized streamline equation
€0 = rv(p(t°; tX; 
£ 2 R3 
(2.12)
at the stagnation point p(t°.
At any point in the flow, the eigenvalues of the velocity gradient rV satisfy the character­
istic equation
A3 - (r ■ v° A2 + 2 h (r ■ v°2 + | W|2 - jS|2]A - det rv = 0; 
(2.13)
with the tensors W and S defined in Eq. (2.1) (see, e.g., Chong et al., 1990). For incompressible 
flows, we have r ■ v = 0 and hence the characteristic equation (2.13) simplifies to
A3 + 2 h jW|2 - |S|2]A - det rv = 0: 
(2.14)
Based on the eigenvalue configuration of rv(p(t), t° determined by Eq. (2.14), Fig. 2.5 
shows the four possible instantaneous streamline patterns near a hyperbolic stagnation point 
of an incompressible flow. Just as in 2D flows, a hyperbolic stagnation point is a solution p(t° 
of (2.11) at which the velocity gradient rv(p(t), t° has no eigenvalues on the imaginary axis 
of the complex plane.
Perry and Chong (1987) give a more complete classification of local streamline geometries, 
including some non-hyperbolic (and hence structurally unstable; see §2.2.7) stagnation points 
as well. Surana et al. (2006) show that, after an appropriate rescaling near a no-slip boundary, 
the streamline patterns in Fig. 2.5 also arise near generic instantaneous separation and 
attachment points on free-slip boundaries.
Importantly, the linear stability analysis leading to the local streamline patterns in Fig. 2.5 
is only relevant for fluid particle motion near stagnation points of steady flows, as we discuss 
later in §2.2.8. The Perry-Chong classification Iras nevertheless been broadly invoked in 
the literature for unsteady flows and for domains away from stagnation point. Both of these 
practices are unjustified and generally lead to incorrect results.
2.1.4 Irrotational and Inviscid Flows
We call a velocity field v irrotational if it is curl-free, i.e., ! (x, t° = r x v(x, t° = 0. For 3D 
irrotational flows defined on a simply connected domain D,1 there exists a velocity potential 
0(x, t° such that the velocity field can be written as
1 The domain D may either be the whole space or must have boundary components to which v is everywhere 
tangent (Stevenson, 1954;Tran-Cong, 1990;Mackay, 1994).
v(X; t ° = r^(X, t ). 
(2.15)

2.2 Lagrangian Description of Fluid Motion
19
saddle-focus with one 
unstable direction
saddle-focus with one 
stable direction
span{Re(e1),Im(e1)}
e
A1 2 = —3... ± wj 3 A3 > 0
e2 = el
span{Re(e2),Im(e2)}
e
A1 < 0, A2 3 = — 1 ± iu
e3 = e2
Figure 2.5 The four possible instantaneous streamline patterns near a hyperbolic 
stagnation point p(t° of a 3D incompressible flow. The eigenvalues and unit eigen­
vectors of rv(p(t°, t° are denoted by Aj and ej, respectively.
On any bounded domain D, a smooth velocity field v can always be decomposed into the 
sum of an incompressible and an irrotational component. Specifically, by the Helmholtz- 
Hodge decomposition theorem (see Chorin and Marsden, 1993), there exists a velocity field 
w(x, t° and a smooth scalar field a(x, t° such that
v = w + r; rw 0;
and w is tangent to the boundary @D of the domain. We call an incompressible velocity 
field v inviscid if it satisfies the incompressible Navier-Stokes equation with zero viscosity 
( = 0), i.e., it solves the Euler equation,
@t v + (rv° v = -1 r p + g, 
(2.16)
for an appropriate pressure field p, density field and external body force-density field g.
2.2 Lagrangian Description of Fluid Motion
Fluid elements advected by the velocity field v(x, t° move along fluid trajectories. Therefore, 
trajectories are time-parametrized curves fx(t)}t2R that solve the differential equation
x = v(x, t °,
(2.17) 

20
Eulerian and Lagrangian Fundamentals
with the dot referring to differentiation with respect to the time t. If v(x t° is smooth,2 then 
the ODE (2.17) has a unique trajectory x (t; t0; x0) for any initial trajectory position x0 2 U 
and initial time t0 2 »t1, 12], as shown in Fig. 2.1.As a consequence, no taajcctory of the 
ODE (2.17) can cross another trajectory. Such an intersection would violate the uniqueness 
of solutions of Eq. (2.17).Physically, this nonuniqueness would imply that two initially 
different fluid elements end up occupying the same location x at the same time t .
2 It is enough if v(x, t° is locally Lipschitz in x near x0 and continuous in t at t0 (see Arnold, 1978). The local 
Lipschitz condition at a point x0 requires the existence, for some finite time interval »t0 - A; t0 + A], of a small 
open neighborhood Ux0 around x and a constant Lx0 > 0 such that for any two points x1 ; x2 2 Ux and for all 
times t e »t0 - A; t0 + A], we have jv(x2, t) - v(x1, t°j < Lx0 jx2 - x1 j.
3 At such an intersection, the same initial time t0 = 0 could be selected for both trajectories, and hence the 
two trajectories through the intersection point would represent two different solutions to the same initial value 
problem.
The requirement of uniqueness for fluid element motion, however, does not prevent the 
same trajectory or other trajectories to traverse through the same location x at different times, 
as we indicated in the left subplot of Fig. 2.1. As a consequence, plots of trajectories of the 
ODE (2.17) (called pathlines in this context) can contain a number of self intersections, as 
well as mutual intersections.
2.2.1 Steady Flows as Autonomous Dynamical Systems
For steady velocity fields v(x), Eq. (2.17) becomes an autonomous dynamical system of the 
form
X = v(x°; 
(2.18)
with no explicit dependence on time. Trajectory evolution in Eq. (2.18) only depends on 
the elapsed time t - t0, with no explicit dependence on the initial time t0. Without loss of 
generality, therefore, the t0 = 0 initial time can be selected for all trajectories, whose general 
form, x (t; x0°, now depends only on the present time and the initial condition. This also 
implies that pathlines of ODE (2.18) cannot intersect each other or themselves by uniqueness 
of solutions.3
On a related note, separatrices in 2D flows (see Fig. 2.3 and the related discussion) are 
sometimes characterized as barriers to advective transport, i.e., they cannot be crossed by 
other trajectories of Eq. (2.18). This characterization of separatrices, however, is self-evident: 
no trajectory of Eq. (2.18) can be crossed by other trajectories by the uniqueness of solutions, 
as we have already mentioned. Instead, separatrices are distinguished because they act as 
boundaries between regions with different trajectory-topologies.
For a steady velocity field, v(x°, fluid trajectories coincide with streamlines because the 
differential equations (2.3) and (2.17) coincide for such velocity fields. For 2D steady flows, 
formula (2.5) then implies the conservation of the stream function t/<(x°, forcing trajectories 
of v(x° to remain in level curves of t/r(x) for all times. For unsteady flows, however, the 
two differential equations (2.3) and (2.17) no longer coincide and hence fluid trajectories 
will differ from streamlines. Trajectories can only be expected to stay close to streamlines 
temporarily in flow regions in which v(x; t° is slowly varying in time.

2.2 Lagrangian Description of Fluid Motion 
21
2.2.2 The Extended Phase Space
Any unsteady velocity field v(x, t° can also be viewed as a steady velocity field on the extended 
phase space of the (x, t° variables. Indeed, letting
X = ( x j; 
V(X° = ( v(X; t° j; 
(2.19)
we obtain the autonomous dynamical system
X = V(X°; 
(2.20)
with X 2 U R, where U Rn is the domain of definition of the unsteady vector field. 
Note that rX V = r v. Thus the divergence of the velocity field is preserved under this 
extension.
The conversion of an unsteady flow into a steady flow on a higher-dimensional system has 
several advantages but does not provide a universal vehicle for extending the properties of 
steady flows defined on U to unsteady flows. One of the reasons for this is that the steady 
extended system (2.20) has a higher dimension and hence its trajectories can display a higher 
level of topological and dynamical complexity than steady flows defined on U.
Another reason is that a number of useful properties of steady flows (e.g., recurrence 
and ergodicity) that we will see later are only valid or defined on compact domains that 
are invariant under the trajectories of the velocity field. No such compact invariant domain 
will exist for the extended system (2.20) because all its trajectories become unbounded in 
the t direction. This unboundedness issue can only be remedied for time-periodic and time- 
quasiperiodic velocity fields, for which the time-dependence of v(x, t° can be confined to a 
compact set (the circle or the torus), as we will see in §2.2.12.
2.2.3 The Flow Map and Its Gradient
The evolution of a trajectory x (t; 10; x0° as a function of its initial position is described by the 
flow map
Ft0: x0 ! x (t; 10,x0°, 
(2.21)
which is well defined for any time t , as long as the trajectory stays in a compact domain U 
where the underlying velocity field v(x, t° is known.4 By the definition of F^, we have the 
relation
dFto(xo° = v (Fto(xo°; t) : 
(2.22)
By fundamental results for differential equations, the flow map Ftt0 is as smooth with respect 
to initial conditions and velocity field parameters as v(x, t° is with respect to x and the same 
flow parameters, respectively (see Arnold, 1978).
We call the domain U invariant under the flow if the velocity field v along @U is tangent 
to @U for all times. This implies that for all times in »11,12], trajectories starting in U remain
4 Ft0 (x0° may generally become undefined for increasing t due to a finite-time blow-up of trajectories, even if the 
velocity field is smooth (consider; e:g:; the simple scalar ODE x = 1 + x2). However, no finite-time blow-up 
is possible as long as the trajectory is confined to a compact flow domain U (see, e.g., Arnold, 1978). 

22
Eulerian and Lagrangian Fundamentals
in U and trajectories starting in @U remain in @U. For autonomous dynamical systems of the 
form (2.18), the flow map can simply be defined as
Ft: x0 ! x (t; 0; x0°; 
(2.23)
with the initial time always taken to be t0 = 0. In this case, the flow map becomes a one- 
parameter family of transformations, as opposed to a two-parameter family of transformations 
in the nonautonomous case.
As long as it is well defined, the flow map is a diffeomorphism: it is as smooth as the 
velocity field and has an equally smooth inverse (Ft0) ~1 = Ft0, the mapping taking current 
positions at time t back to their initial positions at time t0 . Flow maps between two arbitrary 
times are orientation preserving and can be concatenated to give one net flow map for the 
displacement of a fluid element. These two properties can be formally stated as
det rFS > 0; FS (FSo(xo°) = Fto(xo°; 
(2.24)
for any choice of the times 10,s; t 2 »11, 12]; see, e.g., Arnold (1978) for proofs of these 
statements.
The flow map Fto does not inherit the time-dependence of the velocity field v(x t). In­
deed, a steady velocity field v(x° with no explicit time dependence already generates a 
flow map Ft with general (aperiodic) time dependence. Similarly, time-periodic and time- 
quasiperiodic velocity fields generate flow maps with general time dependence. Nevertheless, 
the flow map Ft of a steady velocity field will become a steady map (the identity map) when 
evaluated on specific initial conditions (fixed points) of the flow (see §2.2.11). Similarly, the 
time-dependent image, Fto (x0°, of an initial condition in a time-periodic velocity field is time- 
periodic for exceptional x0 initial conditions that lie on periodic orbits of v(x t° (see §2.2.12).
The derivative rFt0 (x0° of the flow map with respect to its argument x0 is the deformation 
gradient. Technically, rFt0(x0° is a two-point tensor (see §3.5 for more detai)) that maps 
vectors in the tangent space Tx0 Rn of Rn at x0 to vectors in the tangent space TF (x0°Rn of Rn 
at the advected position Ft0(x0°.5 More formally, therefore, rFt0 is defined as
rFt0: Tx0Rn ! TFt0 (x0)Rn;
$0 ! rFt0(X0X0; 
(2.25)
mapping vectors $0 based at x0 to vectors based at Ft0 (x0), as shown in Fig. 2.6. Physically, 
an initial infinitesimal perturbation, $0 , to the initial condition x0 at time t0 evolves into a 
perturbation rFt0 (x0°$0 to the trajectory location x(t; t0; x0° at time t.
The deformation gradient also allows us to express the derivative of the flow map Ftt0 with 
respect to the initial time 10. Indeed, differentiating the identity Ft0 (Ft0(x°) = x with respect 
to t0 gives the relationship
d~ Ft0 (x0° = -rFt0 (x0°v(x0; t0°: 
(2.26)
dt0
For a steady velocity field v(x°, this relationship simplifies to 
d- Ft0 (x0° = - v(Ft0 (x0°°; 
dt0
5 SeeAppendix A.4 for a brief summary of concepts from differential geometry, including tangent spaces of Rn, 
that are relevant for derivatives of mappings between manifolds.

2.2 Lagrangian Description of Fluid Motion
23
Figure 2.6 The definition of the deformation gradient.
vF0(x 0) e0
given that v(Ft0(x0°° = rFt0(x0°v(x0; t0° holds, as we will deduce later in formula (2.55).
As a mapping between two different linear spaces, rFt0(x0° does not have well-defined 
eigenvalues and eigenvectors, even though they are sometimes erroneously introduced in the 
literature for its specific matrix representations. Indeed, it is tempting to introduce coordi­
nates in the domain space Tx0 Rn and the range space TFtt (x0°Rn , then solve a formal eigenvalue 
problem for the linear map rFtt0 (x0° in those coordinates. These formally computed eigen­
values and eigenvectors, however, will depend on the coordinates introduced and hence 
will no longer be invariants of rFtt0 (x0°. The eigenvalues and eigenvectors of rFtt0 (x0° are 
only well defined in a coordinate-free fashion if Tx0 Rn TFtt (x0°Rn holds, i.e., the trajectory 
x(t ; t0; x0 ° returns to its initial position x0 at time t . Even then, the eigenvalues are irrelevant 
for the long-term evolution for the perturbation 0 to x0 unless the velocity field v(x; t° is 
time-periodic with period T = t - 10, and hence x(t; 10, x0° is a periodic trajectory. In that 
case, Fto(x0° is a period-1 map or Poincare map, as discussed in §2.2.12.
In contrast, the velocity gradient rv(x; t ° discussed in §3.3 is a linear operator mapping 
the tangent space TxRn into itself and hence rv(x; t° admits well-defined eigenvalues and 
eigenvectors.
2.2.4 Material Surfaces, Material Lines and Streaklines
A material surface M(t° is an evolving surface of fluid particles that move from their initial 
positions along trajectories of the velocity field v. More precisely,
M (t° = Ftt0 (M0°; M0=M(t0°: 
(2.27)
As shown in Fig. 2.7, the surface M (t° is a smooth manifold if M0 is a smooth manifold, 
because the flow map Ftt is a diffeomorphism. In that case, Ftt is a smooth mapping between 
manifolds and hence rFtt (x0° maps the tangent space Tx0 M0 of M0 at x0 onto the tangent 
space of M (t° at the point Ftt (x0°, i.e.,
rFtt0 (x0°Tx0M0 = TFtt0(x0°M (t°; 
(2.28)
as shown in Fig. 2.7 (see Abraham et al., 1988).
Let Nx0 M0 denote the normal space ofM0 at x0, defined as the orthogonal complement of 
Tx0 M0 in the ambient space Rn, as shown in Fig. 2.7 (see also Appendix A.4). Consequently, 
if a is a vector in Tx0 M0 and b is a vector in Nx0 M0 , then the inner product of these vectors 
must vanish by their orthogonality: ha; bi = 0: This identity can be written equivalently as

24
Eulerian and Lagrangian Fundamentals
Figure 2.7 Geometry near a material surface M (t). Tangent and normal spaces at 
the same material point of this evolving surface are mapped into each other by the 
deformation gradient rFtt0 and by its inverse transpose, [rFto ] T , respectively.
NF(xo)^( ) ) = [V 
0)JT N X0MO
T, x ^' )) = ?F)(X0)TX0M0
M()) = F) (^0)
hb; ai = (b [rFto(xo°] -1 rFto(xo>) = ([r;(Xo°] "T b; rFto(xo°aE = 0; 
(2.29)
where -T denotes inverse transpose. Note that a 2 TxoMo and b 2 NxoMo are arbitrary in 
the relationship (2.29), and hence Eq. (2.28) implies that [rFto(xo)] T b 2 NF(xo°M (t°.
Therefore, we have obtained that any vector b 2 NxoMo is mapped by [rFto(xo)] T into 
a vector normal to TF (Xo°M (t°, or, equivalently,
[rFto (xo°] -T NxoMo = NFto(xo°M (t°: 
(2.30)
In other words, a normal of a material surface at the point xo at time to is advected by the 
inverse transpose [r Ft0 (xo°] T of the deformation gradient to a normal to the same material 
surface at the point Fto (xo) at time t. Consequently, as illustrated in Fig. 2.7, we also have
[rFto (xo°]T NFto(xo°M (t° = NxoMo: 
(2.31)
Since Mo was arbitrary in this argument, so was the subspace Nxo Mo Txo Rn . Therefore, 
the linear mapping [rFto (xo°] T is defined for any vector TxoRn and maps any such vector 
into TFto(xo°Rn:
[rFto (xo)]-T : TxoRn ! TFto(xo°Rn: 
(2.32)
Reversing the role of xo and Fto (xo° in formula (2.32) leads to
[rFto (xo)]T : TFto(xo°Rn ! TxoRn; 
(2.33)
showing that the transpose (or adjoint) of the deformation gradient can be viewed as a 
mapping of vectors in TF^ (xo°Rn back to Txo Rn.

2.2 Lagrangian Description of Fluid Motion
25
A more specific consequence of Eq. (2.30) is the following classic result: if n0 2 Nx0 M0 
is a unit normal to M0 to at x0, then the surface element n0dA0 of M0 at x0 is carried by the 
flow into the surface element
ndA = det rFt0 (xo) [rFto (xo)]"T nodAo 
(2.34)
of M (t° at the point Fto (xo° (see Gurtin, 1981; Truic^^dclL 1992).
A material line (sometimes called a timeline) is an evolving curve composed of the same 
fluid particles, i.e., the image,
L(t° = Fto (L(to°°; 
(2.35)
of a curve L(to° of initial particle particle positions under the flow map Ft, (see Fig. 2.8).
Figure 2.8 (Left) Material line L(t° evolving from its initial curve L(to), and (Right) 
a streakline S(t° evolving from its release location point po(to° = S(to°.
As we have seen for general material surfaces, rFto (xo° maps the tangent vector of L(to° 
at xo into a tangent vector of L (t° at the point Fto (xo). Similarly, [rFto (xo)] T maps a vector 
normal to L(to° at xo to a vector normal to L (t° at the point Fto (xo° (see Fig. 2.7).
A streakline is a set formed of an increasing number of fluid particles, all released 
continually from the same point po. Specifically, a streakline is a time-dependent curve S(t° 
defined as
S(t° = 0 F. (Po°; 
(2.36)
T 2»to;t]
as illustrated in Fig. 2.8. As a consequence of this definition, for any fixed t 2 »to, t], the 
evolving subset L(t° = F. (S(t°° of a streakline S(t° is a material line. Yet S(t° itself is not 
a material line, given that it contains an increasing number of fluid particles over time.
We have already noted that full fluid trajectories (or pathlines), fx(t°gt2R, coincide with 
streamlines in steady flows. We further note here that in steady flows, a pathline emanating 
from a point po fills an increasing, one-sided subset of the streamline starting from po as the 
time increases. This is why streaklines are generally used to visualize pieces of streamlines 
in steady flows, as illustrated in Fig. 2.9.
While streamlines and streamsurfaces have the exact same type of time dependence as the 
underlying velocity field, no such conclusion can be drawn generally for general material 
lines, material surfaces and streaklines. This is because the flow map does not inherit the

26
Eulerian and Lagrangian Fundamentals
Figure 2.9 Streaklines used to visualize subsets of streamlines in a steady flow 
around a Nio ET7 electric vehicle. Image: Courtesy of Nio Inc.
time dependence of the underlying velocity field, as we have already noted in §2.2.3. Very 
special material lines and surfaces can, however, inherit the time-dependence of the velocity 
field. These will be precisely the advective transport barriers we will discuss in Chapter 4 for 
temporally recurrent flows.
2.2.5 Invariant Manifolds
An invariant manifold of a velocity field v(x t° is an evolving material set M(t° = Fto (M(t0)) 
that is a k-dimensional differentiable manifold (see Appendix A.4) at any fixed time t 2 »t0; t1 ]. 
Therefore, a 1D invariant manifold is a material curve, a 2D invariant manifold is a material 
surface and a 3D invariant manifold is an evolving open subset of the flow domain in 3D 
fluid flows.
Because the flow map Ft0 is a diffeomorphism, any choice of a smooth set M(t0° of initial 
conditions will generate an invariant manifold M(t° under F^ over any finite time interval 
»t0; t1]:6 Therefore, there are infinitely many invariant manifolds through each point ofa fluid 
flow. Of these, we are generally interested in the ones that have a strong impact on nearby 
trajectories and are robust under small perturbations to the flow. Over finite time intervals, 
there are different ways to define such a strong impact, which explains why this whole 
book is devoted to finding transport barriers as uniquely influential invariant manifolds. 
Our discussion will focus on techniques that render invariant manifolds that are robust, i.e., 
structurally stable; this notion is defined in §2.2.7.
2.2.6 Evolution of Material Volume and Mass
A subset V0 of initial conditions will evolve under the flow map as a material set
V(t° = Fto (Vo°;
(2.37)
6 This statement does not hold over infinite time intervals as the flow map is generally not even defined in that 
limit for most points.

2.2 Lagrangian Description of Fluid Motion
27
as shown in Fig. 2.10. The rate of change of the material volume vol (V(t°° (or material area 
in 2D) can be computed as
dvvol (V(t)) = d d dV = d d det rFto (X0° dV0 = d d- det VFt> (x0° dVo 
dt 
dt Jv(t° dt VVq 
Vo dt
f d det rFto (xo° dV
Jv(t) det VFto (xo °
I V ■ V(X; t ° dV;
V(t (t)
(2.38)
where we have used the classic formula dV = det VFto (x0° dV0 for the change of variables 
defined by x = Fto (xo), and formula (2.50) to compute ddt det VFto. The volume evolution 
formula (2.38) is often referred to as Liouville’s theorem in the dynamical systems literature 
(see, e.g., Arnold,1978).
Ftt0^
Figure 2.10 Material set V(t° evolving under the flow map Fto.
We will mostly assume that the flow is incompressible, i.e., the velocity field is divergence 
free:
V ■ v = o. 
(2.39)
Under this incompressibility assumption, the formulas (2.50) and (2.38) imply the local and 
global forms of the conservation of material volume:
det VFto (xo° = 1; vol V(t° = vol Vo 
(2.40)
for all points xo and all subsets Vo of U. For 2D flows, the volume is to be replaced with area 
in these statements.
In most applications, even compressible flows are mass preserving, with their mass-density 
field p(x; t° satisfying the equation of continuity
@tp + V -(pv) = o. 
(2.41)
The equation of continuity (2.41) together with (2.50) then yields a relation between the 
evolution of the density along trajectories and the deformation gradient:
p (Fto(xo°; t) = Po(xo° exp 
V ■ v (Fso(xo°; s) ds = det ^^^(^° • 
(2.42)
An evolving material volume V(t° of a mass-conserving flow then obeys the conservation 
law 
J 
J
P p(x; t° dV = [ po(xo° dVo; 
(2.43)
V(t) 
Vo

28 
Eulerian and Lagrangian Fundamentals
obtained by changing the variables of integration from x to x0 and using formula (2.42).
2.2.7 Topological Equivalence and Structural Stability
Topological equivalence seeks to formalize the notion of similar behavior in different flows. 
The idea is to consider one flow to be equivalent to another flow if their trajectory structures 
are the same up to a continuous deformation that keeps the orientation of the trajectories.
Specifically, two steady velocity fields, v(x) and w(x), defined on a compact domain 
U c Rn are said to be topologically equivalent over a time interval »t0; t1] if there exists 
a homeomorphism (i.e., a continuous map with a continuous inverse) h : U ! U that 
transforms the oriented trajectories of v(x° into the oriented trajectories of w(x). In particular, 
if Ft is the flow map of v and Gt is the flow map of w, then topological equivalence between 
the two flows requires the existence of a function h as above, along with a monotonically 
increasing, scalar-valued function r(x, t) on U x »t0; t1], such that
h p.- x t (xo°) = Gt (h(x0°° 
(2.44)
for all x0 2 U and all t 2 »t0; t1]. The notion of topological equivalence of unsteady velocity 
fields is more involved and will not be discussed here.7
7 For a nonautonomous velocity field v(x, t) with flow map Ft0 and another velocity field w(x, t) with flow map 
Gt , it is tempting to define topological equivalence between v(x, t) and w(x, t) by requiring the time-dependent 
version of Eq. (2.44) to hold, i.e., hT(x°;t° (Ft0(x°;t° (x0)j = Gt0 (ht (x0)) for all x0 e U and all t e »t0, t1]. In 
that case, however, any v(x, t) would be topologically equivalent to w(x, t) = 0 via the homeomorphism family 
ht = .tt0 for any fixed t0 , as noted by Aulbach and Wanner (2000). Indeed, this choice of ht would simply map 
any point x into the initial condition x0 at time t0 of the trajectory that is at x at time t . Therefore, we would 
obtain @- h t (x) = 0.
Topological equivalence can be used to express the robustness of a flow on its compact 
domain of definition U. Namely, the velocity field v(x° is called a structurally stable velocity 
field if any other velocity field on U that is close enough to v in the C1 norm is also 
topologically equivalent to v. For instance, any steady velocity field is structurally stable in 
some vicinity of its saddle-type stagnation points. Also, any planar incompressible velocity 
field is structurally stable (within the family of incompressible, steady velocity fields) in a 
vicinity of its center-type stagnation points.
We will also use the notion of structural stability for individual invariant sets of v(x; t). We 
call a material set X(t) c Rn (see formula (2.37) for a definition) over a finite time interval 
t 2 »t0; t1] a structurally stable set if it smoothly persists under small enough perturbations 
of v(x; t). Specifically, X is structurally stable if for any velocity field w(x; t) close enough 
in the C 1 norm to v(x; t), there exists a nearby material set Y(t) for the flow map Gto (i.e., 
Gto (Y(t0)) = Y11) for all t2 »t0; 11]) such that Y(t) is Cr diffeomorphic to X(t) for all t 2 »t0; 11]: 
Structurally stable invariant sets of steady velocity fields include saddle-type stagnation fields 
along with their local stable and unstable manifolds, homoclinic orbits, families of invariant 
tori within the class of volume-preserving velocity fields and limit cycles and attracting tori 
in compressible flows.

2.2 Lagrangian Description of Fluid Motion 
29
2.2.8 Linearized Flow: The Equation of Variations
Infinitesimally small perturbations, 0; to an initial position x0 in the flow evolve in time 
as vectors £(t° along the trajectory x (t; 10; xo°. This evolution is described by the linearized 
version of the ODE (2.17), defined as the equation of variations
£ = rv(x (t; 10; x0 °; t )£. 
(2.45)
By direct substitution, one verifies that solutions of this linear ODE are of the form
e(t° = rFt0 (X0° e0; 
(2.46)
and hence the deformation gradient rFto (x0° is the normalized fundamental matrix solution 
to the equation of variations. Differentiation of the second identity in Eq. (2.24) for the flow 
map implies a similar group property for the deformation gradient:
rFt0(x0° = rFS (FSo(x0°) rFS0(x0°: 
(2.47)
We note that a direct substitution shows [VFto (xo)] T to be the normalized fundamental 
matrix solution of the adjoint equation of variations
y = -»rv(x (t; 10; Xo°; t )]T y 
(2.48)
whose solutions can, therefore, be written as
y(t° = [rFto (xo)] -T yo = [rFt0 (xo)]T yo: 
(2.49)
By Abel’s theorem for fundamental matrix solutions of linear differential equations (see 
Chicone, 2006), we conclude from Eq. (2.45) that
det rFto (xo° = exp f r ■ v(x (s; to, xo°; 5° ds. 
(2.50)
to
Evaluating the general solution (2.46) requires knowledge of the deformation gradient, 
which is typically only available numerically. An exception is the case of directionally steady 
velocity fields v(x; t), defined as
X = v(X; t ° = a( t °vo(x° 
(2.51)
for some nonzero, scalar-valued function a(t° of time and a steady velocity field vo(x°, whose 
flow map we denote by Ftto . By direct substitution, we find that the flow map of the ODE 
(2.51) is given by
t a(s) ds
Fto = Fto 
: 
(2.52)
Then, for any directionally steady velocity field v(x; t), an explicit solution of its equation of 
variations (2.45) is given by the scaled Lagrangian velocity
$1(t° = vo (Fto (xo°): 
(2.53)
Applying the general solution formula (2.46) for the equation of variations to the specific 
solution (2.53) gives the identity
vo (Fto (xo)) = rFto (xo° vo (xo°; 
(2.54) 

30 
Eulerian and Lagrangian Fundamentals
where the flow map Ftt0 is computable from formula (2.52) if the steady flow map Ftt0 of 
v0(x) is known.
For steady flows (a(t° = 1 and hence Ft0 = Ftt0), a comparison of Eqs. (2.46) and (2.53) 
gives
v (x(t; xo°° = rFt0 (xo° v (xo°, 
(2.55)
confirming that the Lagrangian velocity
v(t; xo° := v (x (t; t0,xo°, t° 
(2.56)
is a solution of the equation of variations for any steady flow. In other words, the Lagrangian 
velocity v(t; x0° evolves as a material element in steady flows. For 2D steady flows, formula 
(2.55) leads to an explicit expression for the general solution (2.46) (see Haller and Iacono, 
2003).
The equation of variations (2.45) is generally nonautonomous: it is an explicitly time­
dependent system of linear differential equations, even if v is steady. As a consequence, the 
matrix rFt0 (x0° appearing in the solution (2.46) of this system is generally not a matrix 
exponential.8 Accordingly, the eigenvalues of the matrix rv(x (t; t0, x0°, t), or of its time 
integral, tt0 rv(x (s ; t0, x0°, s° ds, have no relevance for the stability of the trivial solution 
= 0 of this system (Verhulst, 2000). More generally, there is no systematic recipe available 
for solving nonautonomous linear ODEs: the eigenvalues and eigenvectors of their coefficient 
matrices have no general relationship to the solutions of these systems, which typically have 
to be found numerically. Example 2.1 illustrates this point for a planar Navier-Stokes velocity 
field.
8 A rare exception is when the matrix rv(x (t; t0;x0°;t° commutes with tt rv(x (s; t0; x0°; s°ds (see Epstein, 
1963). This happens, for instance, when rv(x (t; t0; x0° ; t° is a diagonal matrix for a 2D or a 3D flow, or a 
skew-symmetric matrix for a 2D flow.
Example 2.1 Consider the spatially linear velocity field
x = v(x, t ° = A( t °x,
sin 4t 
cos 4t + 2
cos 4t - 2 
- sin 4t
(2.57)
which solves the planar, incompressible Navier-Stokes equation for any Reynolds number 
(Haller, 2005, 2015). The corresponding stream function is
1 
21 
21
(/(it, t° = 2 (cos 41 + 2° x2 - 2 (cos 41 - 2° x( + 2x 1 x2 sin41,
(2.58)
whose instantaneous level curves at three different times are shown in the upper subplots of 
Fig. 2.11.
Along any trajectory x (t; t0, x0° of this velocity field, the equation of variations (2.45) 
coincides with the velocity field:
£ = rv(x (t; t0, xo°, t X = A( t °<£: 
(2.59)
The eigenvalues of the coefficient matrix of this linear ODE are A1;2 = ±z'V5, independent of 
the time t. By an ill-conceived analogy with the stability theory of autonomous linear ODEs, 
one could conclude that the = 0 solution of (2.59) is a center-type, neutrally stable fixed

2.2 Lagrangian Description of Fluid Motion
31
t = 0
t=1
t=2
y 1
Figure 2.11 (Top) Streamlines obtained from the stream function (2.58) at three 
different time instances in the original x-frame. (Bottom) Streamlines marking actual 
trajectories of the same flow in the y-frame in which the velocity field becomes steady.
point, and hence all trajectories of Eq. (2.57) are neutrally stable, including its fixed point at 
x = 0. However, passing to a rotating y-frame via the transformation
x = T( t °y,
cos 21 - sin 21
T( t ° = 
;
sin 2t 
cos 2t
transforms the velocity field (2.57) to the form
y = T-1 [AT - T] y = { 0 1 j y,
(2.60)
which is an autonomous, homogeneous linear system of ODEs. This system is explicitly 
solvable and the eigenvalues 1;2 = 1 of the time-independent coefficient matrix in Eq. 
(2.60) gives the correct characterization of the stability of the y = 0 fixed point: it is a 
saddle-type fixed point and hence is unstable, as shown in the lower subplot of Fig. 2.11.
2.2.9 When Are the Eigenvalues of rv Relevant?
As Example 2.1 illustrates, even if the eigenvalues of a nonautonomous linear system of 
ODEs - such as Eqs. (2.57) and (2.59) - are constant in time, these eigenvalues generally 
have no relationship to the solutions or the stability type of the ODE.

32
Eulerian and Lagrangian Fundamentals
An exception to this general rule is when the explicit time-dependence of rv(x (t; 10; x0 °; t° 
is slow enough (see, e.g., Haller, 2000;Haller and Iacono, 2003). In that case, a lin­
ear transformation £ = T(t°i to the time-evolving eigenbasis of Vv(x (t; t0; x0°, t° can 
be constructed when such an eigenbasis exists, with T(t° containing the unit eigenvectors 
of rv(x (t; t0; x0°; t°. As in Example 2.1, his transformation puts hie equation of variations 
(2.45) in the form
i = T-1(t° [rv(x (t; t0; x0°; t)T(t)- T(t)] i
= [A(t° + T-1(t)T(t)] i; 
(2.61)
where A(t° is a diagonal matrix that contains the time-dependent eigenvalues of 
rv(x (t; 10; x0°; t°. If rv (x (t; 10; x0°; t° is slowly varying, then T(t° is small in norm and 
hence the solutions of (2.61) remain close to those of the diagonalized system if = A(t°i 
for some time. The latter system is explicitly solved by i(t° = [ exp Jtt A(s° ds] i(10°; which 
shows that the time-integrated eigenvalues rv(x (t; 10; x0°; t° determine the stability of the 
i = 0 fixed point of Eq. (2.61),and hence the linearized stability of the underlying trajectory 
x(t; t0; x0° for some finite time. However, the slow-variation assumption on rv(x (t; t0;x0°;t° 
leading to this conclusion will, in general, be violated even in steady flows. Indeed, along 
a nonequilibrium trajectory x (t ; t0; x0° of a steady velocity field v(x°, the velocity gradient 
rv(x (t ; t0; x0 °° will, in general, be highly unsteady.
In contrast, if the velocity field v is steady and has a fixed point at p, then the equation of 
variations (2.45) along the trajectory x(t; t0; p° 
p is the autonomous ODE
= rv(p°; 
(2.62)
which is solved by
(t° = rFt (p°0 = erv(p°t0: 
(2.63)
In this case, therefore, the fundamental matrix solution of the equation of variations is a 
matrix exponential and hence the eigenvalues and eigenvectors of the velocity Jacobian 
rv(p) correctly determine the linearized flow geometry near p. Therefore, the linearized 
streamline geometries we showed in Figs. 2.2 and 2.5 coincide with actual linearized fluid 
trajectory patterns near stagnation points of steady flows.
2.2.10 Lagrangian Aspects of the Vorticity
Taking the curl of both sides of the incompressible Euler equation (2.16) and using some 
classic vector identities gives the inviscid vorticity transport equation
D !
~Dt
= (rv° !;
(2.64)
where D^ = @t (■ ° + r (■ ° v denotes the material derivative, the derivative of a quantity 
( ° along trajectories of the velocity field v. Along a trajectory x(t; t0; x0°, the linear system 
of ODEs (2.64) coincides with the equations of variations (2.45). Therefore, we must have
x(t; t0; x0°; t° = rFtt0 (x0° ! (x0; t0°;
(2.65)

2.2 Lagrangian Description of Fluid Motion
33
which means that the vorticity vector along a trajectory of an inviscid flow evolves as 
a material element advected by the linearized flow along the same trajectory. The same 
conclusion does not hold for viscous flows, because the viscous vorticity transport equation,
D!
— = (rv° ! + vA!;
obtained through the same steps form the Navier-Stokes equation
@t v + (rv° v = - 1 r p + vAv + g;
(2.66)
(2.67)
with pressure p, density , viscosity and constant of gravity g, contains the additional term 
! compared to the equation of variations. Using the variation of constants formula for
inhomogeneous linear systems of ODEs, we obtain
x(t; t0; x0°; t° = rFtt0 (x0° ! (x0;t0° + v rFts (x(s; t0; x0°° A! (x(s; t0; x0°; s° ds:
t0
This expression is not explicit for ! , but shows that the non-material nature of the vorticity 
is governed by the integral of the materially advected vorticity Laplacian, multiplied by the 
viscosity.
For 2D flows with a velocity field v(x° = (u(x, y°; v(x, y), 0°, the vorticity vector takes the 
form ! = (0; 0;!z), with —z(x° = —z(x, y) denoting its z-component. In that case, only the 
z-component of Eq. (2.66) is nonzero, yielding the 2D vorticity transport equation as a scalar 
advection-diffusion equation
D!z 
----- = VA!: 
Dt z
Accordingly, for inviscid flows ( = 0), we obtain the conservation law
!—= = @t! + r! ■ V = 0:
Dt * z z
(2.68)
(2.69)
This means that the scalar vorticity is preserved along the trajectories of 2D incompressible 
flows.
Taking the gradient ofEq. (2.69)then gives
@t (r—z) + r (r—z) v = -(rv)T r—z;
or, equivalently,
D r—z = -(rv°T r
(2.70)
(2.71)
z
This shows that the vorticity gradient along trajectories satisfies the adjoint equation of 
variations (2.48). Therefore, the adjoint solution formula (2.49) implies that the vorticity 
gradient along a trajectory x(t; 10; x0° of a planar inviscid flows evolves according to the 
formula
r—Z (x(t ; 10; X0°; t) = [rFt0 (Xo)] T r—z (X0; t0° .
(2.72)

34
Eulerian and Lagrangian Fundamentals
2.2.11 Dynamics Near Fixed Points of Steady Flows
We now discuss the implications of the linearized stability type of a fixed point p of a steady 
velocity field v(x) (see Eq. (2.62)) for nearby fluid trajectories. We call p a hyperbolic fixed 
point if Re Ai , 0 holds for all eigenvalues Ai of the matrix rv(p°.
By the Hartman-Grobman theorem (see Guckenheimer and Holmes, 1983), autonomous 
dynamical systems are locally topologically conjugate to their linearization near hyperbolic 
fixed points. This means that locally near p, there exists a continuous and continuously 
invertible change of coordinates x = h (£) that transforms the trajectories of the velocity 
field v(x° into those of rv(p°£, preserving the parametrization of orbits by time.9 Any 
robust nonlinear trajectory pattern near an off-boundary fixed point is, therefore, a small 
deformation of one of the hyperbolic instantaneous streamline patterns shown in Fig. 2.2 and 
Fig. 2.5.
9 More specifically, in a small enough, open neighborhood U c Rn ofthe fixed point p, we have erv(p°t h 1 (x0° = 
h 1 (Ft (x0)) for all initial conditions x0 2 U and for all times t satisfying Ft (x0° 2 U.
10 This conclusion follows from the application of Lyapunov’s second method (see, e.g., Rouche et al., 1977, 
Chicone, 2006) for stability analysis if one chooses the stream function <^(x) as a Lyapunov function. This 
Lyapunov function has a local minimum or maximum at elliptic fixed points, which are encircled by closed 
streamlines in this case. By Eq. (2.5), the Lyapunov function (x°x) is also constant along trajectories, implying 
the stability of the elliptic fixed point by Lyapunov’s classic stability theorem.
A notable nonhyperbolic fixed point in steady incompressible flows is one with a pair of 
purely imaginary eigenvalues. In 2D steady flows, the linearized Lagrangian dynamics at 
such an elliptic fixed point (see Fig. 2.2) nevertheless correctly represent nearby trajectory 
patterns of the full flow, although the Hartman-Grobman theorem is formally inapplicable to 
such a fixed point.10 In 3D, steady incompressible flows, nonhyperbolic fixed points are those 
where rv has either three zero eigenvalues or a purely imaginary pair and a zero eigenvalue. 
For such fixed points, further analysis is needed beyond the linearization to understand the 
local geometry of material trajectories.
Another frequent type of nonhyperbolic fixed point in steady flows is any point on a no-slip 
boundary. In two dimensions, such boundary points occur along a parametrized curve 7(5), 
implying v (7(5)) = 0: Differentiating this equation with respect to 5 and invoking the chain 
rule, we obtain that rv(7(5)) must have a zero eigenvalue for each 5, corresponding to the 
eigenvector 70(5°. Incompressibility then implies the other eigenvalue of rv(7(5)) to be 
zero as well, as we indicated for degenerate parabolic stagnation points in Fig. 2.2. One can, 
however, remove this degeneracy from the equation of motion x =v (x) by introducing the 
new time t via the relation dt/dt = y(t°, with y(t° denoting the boundary-normal component 
of trajectories (see Haller, 2004 and Surana et al., 2006). After this rescaling, the fixed points 
along the no-slip boundary typically disappear or become hyperbolic fixed points, as we 
noted for instantaneous stagnation points in §2.1.3 (see Fig. 2.5).
2.2.12 Poincare Maps
Here we discuss how flows generated by temporally recurrent velocity fields can be analyzed 
in a simpler fashion through stroboscopic images of evolving fluid particles.

2.2 Lagrangian Description of Fluid Motion 
35
Time-Periodic Flows
An important special class of flows is generated by time-periodic velocity fields. Trajectories 
of such flows satisfy an ODE of the specific form
X = V(X; t); V(X; t) = V(x t + T(2.73)
for some time period T > 0, for x 2 Rn with n = 2 or n = 3. The evolution rule for 
trajectories, therefore, repeats itself periodically in time, enabling a simplified study of the 
discretized evolution of trajectories over time intervals that are integer multiples of T.
Specifically, the Poincare map (or period T-map), denoted Pt0, of the ODE (2.73) is the 
restriction of its flow map to one time period starting at time t0 :
Pt0 := Ftt00+T: 
(2.74)
We illustrate this definition for 2D flows in Fig. 2.12.
Figure 2.12 The definition of the Poincare map Pt0 for a 2D velocity field whose 
time dependence is T -periodic.
By the time-periodicity of the ODE (2.73), the flow map advancing particle positions 
between times 10 + jT and 10 + (j + 1° T is the same map for any integer j. Therefore, by the 
group property of flow maps (see Eq. (2.24)), the repeated iteration of the single mapping 
Pt0 gives the fluid particle positions at forward and backward times that are separated from 
t0 by an integer multiple of T:
Ft0+kT = Ft0+kI1)T °-"° Ft0+T = Pt0 °-"° Pt0 = Pk0 (X0° : 
| {z } 
k
The infinite set of iterations {x0, Pt0 (x0), P20 (x0),..., P* (x0),...} is called the orbit of Pt0 
starting from the point x0 . We also note the relation
Pti = Ft1+T = Ft0+T o Ft o Ft0 = Ft0 o Pt0 o Ft0 = (Ft0)“1 o P* o F^0; 
(2.75)
which shows that Poincare maps based at any two different times, t0 and t1 , are always topo­
logically conjugate. Such maps share the same orbit structure up to the smooth deformation 

36
Eulerian and Lagrangian Fundamentals
represented by Ftt01 (see Guckenheimer and Holmes, 1983). Topological conjugacy is a stronger 
form of the notion of topological equivalence introduced in §2.2.7: it does not allow for a 
reparametrization of time (i.e., t(x0, t° = t must hold).
The computation of the Poincare map for a general 2D, time-periodic velocity field is 
implemented in Notebook 2.1. 
—
Notebook 2.1 (PoincareMap2D) Computes the Poincare map defined for a 2D, time- 
periodic velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/PoincareMap2D
If v(X; t° is divergence-free, then the flow map is volume-preserving (see condition (2.40)) 
and so is the Poincare map
det rPt0 = 1; vol (Pt,(V°) = vol (V° 
(2.76)
for any set V U: For an incompressible time-periodic flow, the volume-preservation of its 
Poincare map has important global consequence on the dynamics, which we will discuss in 
§§2.2.13-2.2.14.
While we will discuss the power of Poincare maps in later chapters, Fig. 2.13 shows a 
preliminary illustration of their usefulness. The figure shows experimentally observed mixing 
patterns whose transport barriers (or lack thereof) are revealed by Poincare maps computed 
from trajectories of the corresponding model velocity fields.
Quasiperiodic Flows
Quasiperiodic time-dependence in a velocity field can be represented by rewriting the general 
particle equation of motion (2.17) as
X = V(X; Ql t; : : ., Qm t 
X 2 R^ t 2 R 
(2.77)
with a velocity field v whose time-dependence involves several frequencies, j , not just 
one.11 We assume that the frequencies Qj are rationally independent, which means that the 
frequency vector fi = (Qb...,Qm° satisfies
11 Time periodic flows (m = 1) also fall in this general family.
h; ki , 0 
(2.78)
for all integer vectors k 2 Zm . If the frequencies were not rationally independent, then one 
could select a smaller number of Qj frequencies to represent the velocity field (2.77).
We can turn system (2.77) into a temporally periodic, higher-dimensional dynamical 
system by introducing the phase vector 0 = (02, ...,0m) with the individual phases 0j- = Qj t 
for j = 2,..., m. We view this phase vector as an element of an (m - 1°-dimensional torus
Tm-1 = S1 x ... x S1, 
(2.79)
| {z } 
m-1


2.2 Lagrangian Description of Fluid Motion

38
Eulerian and Lagrangian Fundamentals
Therefore, the elements of this vector cannot be selected arbitrarily relative to each other and 
relative to the first phase variable 1t0. For this reason, only an (n + 1)-dimensional family 
of initial conditions of the (n + m - 1°-dimensional system (2.80) are relevant for the original 
system (2.17).12
12 This restriction leads to conservation laws in the phase space of system (2.80), as we will see in §4.3.2.
This relevant set of initial conditions is a dense set in the (n + m - 1°-dimensional phase 
space because the curve of initial conditions satisfying Eq. (2.81) forms a dense curve in the 
torus Tm-1 due to the assumed rational independence of the frequencies (Q2,...,Qm°. This 
dense set, however, has measure zero within the torus: it can be covered by a countable set of 
open subsets of the torus that have arbitrarily small total volume (total length for m = 2 and 
total area for m = 3). As a consequence, the trajectories of the extended system (2.80) that 
are related to the original quasiperiodic velocity field v(x; t° form a measure zero set in the 
phase space of Eq. (2.80).As a consequence, mathematical statements obtained for almost 
all (i.e., all but a measure zero set of) trajectories of the extended system (2.80) do not carry 
over to the original quasiperiodic velocity field (2.77). Examples of such statements are the 
Poincare recurrence theorem (§2.2.13) and Birkhoff’s ergodic theorem (§2.2.14).
For the extended system (2.80), we can define a Poincare map in the same way as for 
the time-periodic system (2.73). Indeed, for any fixed initial time t0 and for the time period 
T = 2^Q1, an extended Poincare map Pt0 can be defined on the space Rn x Tm-1 as
Pt„: Rn x Tm"1 ! Rn x Tm"1; 
t0
(x0; 
20; . . . ; m0° 7! (x (t0 + T; t0; x0; 
1 t0; 0° ; 20 + 
2T; . . . ; m0 + mT° . 
(2.82)
We sketch the geometry of this Poincare map for 2D flows (n = 2° in Fig. 2.14. Similar 
Poincare maps can be defined based on any of the periods Tj = 2n /Qj associated with the 
remaining frequencies for j = 2;: ::;m.
1
Figure 2.14 The definition of the Poincare map Pt0 for a 2D, temporally quasiperiodic 
velocity field with m rationally independent frequencies.
By our discussion in §2.2.12, the Poincare map Pt0 defined for the extended system (2.80) 
is volume preserving precisely when the velocity field v is incompressible. As we noted 
for the extended flow (2.80), only a dense but measure zero set of orbits of the Poincare

2.2 Lagrangian Description of Fluid Motion 
39
Pt0 correspond to sampled fluid trajectories of the original vector quasiperiodic vector field 
(2.77). Such a dense set of admissible trajectories of Pt0 will give a good description of the 
overall behavior of the fluid but is still only a measure zero set.
3D Steady Flows
As we have already pointed out in the previous section, any steady flow can be considered 
time-periodic with any period. This enables the sampling of 3D steady flows with arbitrary 
stroboscopic maps. These sampling maps, however, are still 3D, so there is no immediate 
practical advantage from such a temporal discretization of the steady flow. However, there 
is an alternative way to construct Poincare maps in 3D flows that does bring dimensional 
reduction, as we discuss next.
Consider a 2D surface 
R3 that is everywhere transverse (i.e., nontangent) to the
velocity field v(x). For such a Poincare section E, the first-return map, or Poincare map, 
P : ! can then be defined as the mapping that takes an initial condition x0 2 into the
first intersection of the trajectory starting from x0 with E , if such an intersection exists (see 
Fig. 2.15).
Figure 2.15 A Poincare map (or first-return map) PE and its second iterate, P2E, 
defined on a section E transverse to a 3D, steady velocity field.
More specifically, using the flow map Ft of v, we can write
P2(xo° := Ftmin(Xo)(xo°; tmin(xo° = min {t > 0 : xo 2 S, Ft(xo° 2 E} : 
(2.83)
The computation of the Poincare map for a general 3D steady velocity field is implemented 
in Notebook 2.2. 
—
Notebook 2.2 (PoincareMap3D) Computes the Poincare map defined for a 3D steady 
velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/ 
demos/AdvectiveBarriers/PoincareMap3D
If E and v are smooth and nE (x° denotes a unit normal field along E with the orientation 
v nE > 0,13 then the Poincare map PE is a diffeomorphism that preserves the generalized 
area element
13 It is always possible to choose such an orientation for the unit normal field nE globally on E. This is because the

40
Eulerian and Lagrangian Fundamentals
dA = v ■ nE dA; 
(2.84)
as we show inAppendix A.14.As a result, P is generally not area preserving but falls in the 
family of symplectic maps, defined as mappings that preserve a nondegenerate, closed two- 
form (see, e.g., Abraham et al., 1988). For any symplectic map, appropriate local coordinates 
can be constructed so that the map preserves the classic area element on in the new 
coordinates (see Appendix A.14). Therefore, the classification of the linearized Poincare 
map r PE (p) at a fixed point p on E is identical to that of the Poincare map of a 2D, time- 
periodic flow (see Fig. 4.3). Global features of 2D symplectic maps coincide with those we 
already mentioned for area-preserving maps in §4.1 (see Mackay et al., 1984;Meiss, 1992).
Similarly, a first-return map PE defined on a transverse cross section E of a compressible 
but mass-preserving, steady, 3D flow preserves the generalized area element
dA = pv ■ nE dA; 
(2.85)
where p(x° > 0 is the mass density field of the fluid (see Appendix A.14). Local and global 
qualitative properties of Poincare maps in such flows, therefore, also coincide with those of 
period-T maps of time-periodic 2D flows.
2.2.13 Revisiting Initial Conditions: Poincare’s Recurrence Theorem
Assume that the Poincare map Pt0 of a T-periodic velocity field v(x; t° leaves a compact 
domain D c U invariant, i.e., Pt0 (D° = D holds. This is the case, for instance, if the velocity 
field v is defined on a closed and bounded domain D U surrounded by impenetrable 
boundaries. In such cases, Poincare’s recurrence theorem for measure-preserving maps 
(Arnold, 1989) guarantees that almost all orbits of Pt0 return arbitrarily close to their initial 
position x0 over long enough time intervals, as illustrated in Fig. 2.16. In other words, 
trajectories that do not return arbitrarily close to their initial positions over long times form 
a set of zero volume. Note that Poincare’s theorem also guarantees repeated returns to D 
occurring after an arbitrarily large threshold time t. This can be deduced by applying the 
theorem to the measure-preserving map Pt0 := PN, with the positive integer N selected so 
that NT > t holds.
Phrased in terms of the orbits of v(x; t° in continuous time, almost all trajectories of a time- 
periodic incompressible flow defined on a closed and bounded domain revisit their initial 
conditions repeatedly with arbitrarily high accuracy over arbitrarily long times. Since steady 
flows can be considered periodic with any period, Poincare’s recurrence theorem applies to 
them as well. Remarkably, therefore, almost all trajectories of a steady incompressible flow 
confined to a closed and bounded 2D or 3D domain revisit their initial positions arbitrarily 
closely over arbitrary long times.
In its most general form, Poincare’s recurrence theorem only assumes the conservation 
of a measure (Arnold, 1989). As we have seen, compressible flows obeying the equation of 
continuity conserve mass (see formula (2.43)), which makes their Poincare maps measure 
preserving. Therefore, almost all trajectories of a compressible but mass-preserving, steady
inner product v ■ nE cannot vanish anywhere on E by the transversality of v to E, and hence this inner product 
cannot change sign on E.

2.2 Lagrangian Description of Fluid Motion
41
Figure 2.16 The statement of the Poincare recurrence theorem applied to the Poincare 
map Pt0 on a compact invariant domain D. Almost all (i.e., all but a measure zero set 
of) initial conditions x0 generate trajectories for Pt0 that return for some large enough 
iteration N of Pt0 to any small neighborhood U of x0 .
or time-periodic flow defined on a closed and bounded domain revisit their initial positions 
arbitrarily closely over arbitrarily long times.
At first sight, it might seem that Poincare’s recurrence theorem is also applicable to the 
quasiperiodic vector fields v(x Qt° with frequency vector Q = (Qb:::; Qm° discussed in 
§2.2.12.Indeed, if the original quasiperiodic velocity field (2.77) is defined on a compact 
invariant domain D, then the extended Poincare map Pt0 , introduced in formula (2.82), is 
defined on the compact set D Tm , given that the m-dimensional torus, Tm , is compact. 
This enables us to apply the Poincare recurrence theorem to the extended map Pt0 and 
conclude that almost all trajectories X(t; Xo° = (x(t; x0°. 0o + Qt° return arbitrarily close to 
Xo = (x0; 0o° for large enough times t. Note, however, that Poincare’s recurrence theorem 
allows for the existence of a measure zero set of nonrecurrent trajectories in the phase space of 
the extended system (2.80). The trajectories in that extended phase space that correspond to 
actual trajectories of the original quasiperiodic velocity field (2.77) also form just a measure 
zero set. Therefore, for all we know from this argument, all trajectories of v(x Qt° may be 
nonrecurrent. Consequently, recurrence in temporally quasiperiodic velocity fields does not 
follow from Poincare’s recurrence theorem.
The recurrence theorem, however, is applicable to Poincare maps defined on transverse 
sections of 3D steady, volume-preserving or mass-preserving flows (see §2.2.12). Namely, 
on any compact spatial domain invariant under such a flow, typical trajectories will return to 
any Poincare section that is transverse to the velocity field. This recurrence guarantees the 
existence of initial conditions arbitrarily close to that will return to their arbitrarily small 
neighborhoods. These returning trajectories will, therefore, come back arbitrarily close to 
over time and hence will have to intersect at some point due to the transversality of the 
vector field v to . The same argument in backward time guarantees that such trajectories 
also had an intersection with at some point in the past, and hence these trajectories start 
from, and return to, .
Poincare’s recurrence theorem, however, does not hold when the domain of definition D 
of the field (2.77) is not a bounded invariant set, or when the time-dependence of the velocity 

42
Eulerian and Lagrangian Fundamentals
field is not periodic or steady. Indeed, in the latter case one cannot associate an extended 
dynamical system to v(x, t° with a compact phase space given that t must be taken from all of R.
2.2.14 Convergence of Time-Averaged Observables: Ergodic Theorems
Here we discuss how temporal averages of observed scalar fields relate to their spatial averages 
in perfectly mixing flows. We first state the results for averages taken under stroboscopic 
samplings (Poincare maps) of the flow, then directly for the full flow. We first consider a 
Poincare map Pt0: S ! S defined on a physical domain S. As a special case of the general 
flow map Ftt0 , a Poincare map of a smooth vector field is always a diffeomorphism (see 
§2.2.3). This will enable us to give a simplified treatment here relative to the more general 
results of ergodic theory (see, e.g., Walters, 1982).
Ergodic theory is concerned with the dynamics of maps on measurable subsets of S. The 
measures relevant for physically observable mixing in fluids are the volume when S is 
a 3D flow domain, the area (or the scaled areas, given by formulas (2.84) or (2.85)) when 
S is a 2D surface, and the arc length when S is a one-dimensional curve. Ergodic theory 
additionally requires S itself to have a finite measure ju(S). For practical applications to 
fluids, this finiteness assumption on amounts to the requirement that the domain S must be 
bounded.
We will assume that Pt0 is measure preserving on S, i.e., the measure of any subset A S 
is preserved under iterations of Pt0 :
v(A° = n (Pto (A°) 
(2.86)
for all i 1. This requirement holds for Poincare maps of time-periodic incompressible flows 
and for extended Poincare maps of time-quasiperiodic incompressible flows (see §2.2.12). As 
already noted, if the flow is compressible but conserves mass, then its associated stroboscopic 
maps are still measure preserving with respect to the fluid mass as a measure.
Note, however, that these conclusions about measure preservation only follow directly 
from the volume- or mass-preservation of the flow when S has the same dimension as the 
underlying velocity field v. For instance, if S R2 is an invariant curve in a 2D flow, then 
the 2D period-T map, Pt0 , restricted to S is generally not a measure-preserving map on 
S. Examples of such invariant curves are stable or unstable manifolds of saddle-type fixed 
points, to be discussed later in §4.1.1. Along such invariant curves, Pt0 shrinks or expands the 
measure (arclength), respectively. Similarly, a measure-preserving Poincare map, Pt0 , on a 
3D domain does not generally preserve any nondegenerate measure on a 2D invariant surface 
M = Pto (M°, as examples of 2D stable and unstable manifolds in 3D mappings illustrate. 
In contrast, Poincare maps defined as first-return maps to a 2D transverse section S of 3D, 
steady, volume-preserving or mass-preserving flow are measure preserving on S with respect 
to the areas computed from the area elements (2.84) or (2.85).
We assume that the mapping Pt0 is ergodic on S, i.e., the invariant sets of Pt0 have either 
full measure or zero measure in S. This means that one cannot identify any experimentally 
observable part of S that does not mix with the rest of S under iterations of Pt0 . For instance, 
the Poincare map shown in Fig. 2.13(a) is not ergodic on the flow domain because the 
interiors of the two leapfrogging vortices are invariant subsets of nonzero area within the 2D 
Poincare section S . The same map, however, is ergodic when restricted to its closed invariant 

2.2 Lagrangian Description of Fluid Motion
43
curves because orbits within such elliptic transport barriers (see §4.1.2) are quasiperiodic 
and hence densely cover the barrier. As a consequence, there is no invariant set of nonzero 
arc length within the barrier. As another example, the Poincare map shown in Fig. 2.13(b) is 
ergodic on its bounded 2D domain because the only invariant sets smaller than the full flow 
domain are the one-dimensional stable and unstable manifolds of its fixed points.
Consider now an observable, i.e., a scalar field c(x) that is defined and integrable on the 
domain S of an ergodic, measure-preserving mapping Pt0.14 Because of the perfect mixing of 
points in S under iterations of the ergodic map Pt0 , one hopes to uncover dynamical features 
of Pt0 by averaging c(x° along the orbits {x0, Pt0(x0), P22 (x0),...} of Pt0. Indeed, Birkhoff’s 
ergodic theorem (Birkhoff, 1931) guarantees that
14 The observable c can also be a time-periodic scalar field, c(x, t° = c(x, t + T), where T is the time period 
of the underlying velocity field v(x, t°. The scalar field c does not even have to be smooth, but it has to be 
integrable with respect to the measure on S.
15 Here “almost all” refers to all points x0 2 S with the possible exception ofa measure-zero subset of S.
1 A 
. 
1 f
NNm « E c (p- (xo» = -& S cw d-
holds for almost all x0 2 S.15 In other words, with the possible exception of an unobservable 
set of x0 locations, the temporal average of any observable along an orbit starting from x0 
converges to the spatial average of that observable over the whole of S. For instance, if 
c(x° = x is the x-coordinate component of x = (x, y, z°, then the averaged x-coordinate along 
a trajectory of a volume-preserving, ergodic Poincare map, Pt0(x0), is equal to -S f x d-, 
M\S °
the x-coordinate of the center of mass of the material set S.
In practice, velocity fields will generally not repeat themselves periodically in time and 
hence concepts from ergodic theory will not apply to them. Nevertheless, ergodicity is a 
useful conceptual tool for understanding and visualizing certain types of transport barriers 
(or lack thereof) in idealized model flows. Ergodicity also helps in interpreting mixing 
phenomena in low Reynolds number experiments whose velocity fields are very close to 
time-periodic (seeChapter 4).
A more general version of the classic ergodic theorem of Birkhoff is the Birkhoff-Khinchin 
ergodic theorem, which also applies to continuous flows of steady velocity fields (see Cornfeld 
et al.,1982). To state this theorem, we consider the flow map Ft : S ! S ofa steady velocity 
field v(x° and a scalar field c(x) whose integral exists with respect to a measure - defined 
on the bounded and invariant 2D or 3D domain S. We assume that Ft preserves the measure 
-, i.e., all subsets Ac S satisfy -(Ft (A)) = -(A) for all times. For an incompressible 
flow, the measure - preserved by Ft on the flow domain S is the volume or the area. For 
a mass-preserving flow on S, the measure preserved by Ft is the mass. If, however, S is a 
2D invariant surface in a 3D flow, then Ft does not necessarily preserve any nondegenerate 
measure on S , even if it preserves volume or mass on the full 3D flow domain.
In analogy with the discrete case already discussed, we also assume that Ft is ergodic on 
S, i.e., the measure of any invariant sets of Ft in S is either zero or equal to -(S°. Then, 
according to the Birkhoff-Khinchin ergodic theorem (Cornfeld et al., 1982), for almost all 
initial conditions x0 2 S; we must have

44
Eulerian and Lagrangian Fundamentals
1t 
1t 
1t
lim c (Fs(x0°° ds = lim 
c (F s(x0°° ds = lim c (Fs(x0°° ds
t!1 t 0 
t!1 t 0 
t !1 2 t _t
(2.87)
In other words, with the possible exception of an unobservable set of x0 initial conditions, 
the forward, backward and full temporal averages of any observable along an orbit starting 
from x0 converge to the spatial average of the observable over the whole of S.
As we will see in examples in Chapter 4,typical 3D steady flows are not ergodic on their 
full domain D but might admit open ergodic subsets. More frequently, they admit 2D invariant 
surfaces (invariant tori) or 1D closed invariant curves (periodic orbits) restricted to which 
Ft becomes ergodic. Applying the Birkhoff-Khinchin ergodic theorem on the full domain 
D does not guarantee anything for averages of scalars taken over these lower-dimensional 
invariant surfaces given that those have measure zero in D. Thus, for all we know, these 
surfaces may be part of the set of locations that violate the Birkhoff-Khinchin ergodic 
theorem. The statement (2.87), therefore, is only meaningful for lower-dimensional invariant 
sets S D if the theorem is applicable directly to S with respect to a measure preserved by 
Ft on S. This measure is generally not known explicitly, but its existence is guaranteed by 
the type of dynamics (quasiperiodic or periodic) on these lower-dimensional invariant sets.
2.2.15 Lagrangian Scalars, Vector Fields and Tensors
We refer to scalar, vector and tensor fields defined over initial trajectory positions x0 , initial 
times t0 and current times t as Lagrangian quantities.
Specifically, we refer to scalar fields defined at arbitrary initial conditions (x0; t0° for all 
times t as Lagrangian scalar fields. For instance, a concentration field c(x, t° subject to advec­
tion and diffusion can be expressed as a Lagrangian scalar field c(x0; 10; t° := c (Ft0(x0), t), 
depending on the current time t , initial time t0 and the initial position x0 of the material 
trajectory that is at the point x = Ftt0 (x0° at time t.
A Lagrangian vector field is a time-dependent vector field u(x0; t0; t° comprising vectors 
based in the tangent spaces Tx0 Rn of Rn at the initial positions x0 2 U. These vectors 
remain based at the points x0 for all times t 2 »11, 12] but they generally vary as functions 
of t. In contrast, an eigenvector field i (x0; t0; t° of a Lagrangian tensor field (to be defined 
below) is not a Lagrangian vector field because it has no well-defined length or orientation. 
Accordingly, we refer to such eigenvector fields as Lagrangian direction fields, in line with 
our terminology in §2.1.1 for the Eulerian case.
Despite their commonly used names, the Lagrangian velocity v (Ft0(x0), t) and the La­
grangian vorticity ! (Ft0(x0° t) are not Lagrangian vector fields, as they comprise vectors 
based at the time-evolving current location x(t°. In other words, these vector fields are point­
wise elements of the tangent space TFtt (x0°Rn, as opposed to Tx0 Rn ,which would be required 
for a Lagrangian vector field.
In contrast, the pullback velocity field Ftt0 v and the pullback vorticity field Ftt0 ! , 
defined respectively as

2.2 Lagrangian Description of Fluid Motion 
45
[Ft0 ] * v (xO; t0; t° = [rFto (xo)] ”1 v (Fto (xo°; t) ;
[Fto]*! (xo; to; t° = [rFto(xo°]”1! (Fto(xo°; t); 
(2.88)
are Lagrangian vector fields, as both are elements of Txo Rn for all values of t . In general, 
the pullback of a vector field with respect to a mapping is the most natural way to transport 
a vector field defined at current particle positions back to a vector field defined over initial 
positions, as shown in Fig. 2.17 for the velocity field. Similarly, the pushforward velocity 
field,
[Fto]* v (x; t; to° = rFto(xo°v (xo; to°; 
(2.89)
is a Lagrangian vector field with respect to the inverse flow map, comprising vectors defined 
in the tangent spaces TxRn of current positions in Fto (U° (see Fig. 2.17).
[Ft0]*v: pullback of v
___  
v*(x,t):= VFt0 (Xo)v(Xo,to)
[Ft0]*v: pushforward of v
Figure 2.17 The geometry of the pullback v* = [Ftt ] * v and the pushforward v* =
Ftto v of a velocity field v under the flow map Ftto .
A Lagrangian tensor A(xo; to; t° is a linear mapping of the tangent spaces TxQRn into 
themselves at all initial positions xo for all times t . Despite its formal dependence on the 
same arguments, the deformation gradient rFto(xo° is not a Lagrangian tensor but a two- 
point tensor (see our discussion leading to formula (2.25) and Fig. 2.6), as it is a mapping 
between two different tangent spaces. In contrast, the right Cauchy-Green strain tensor (see 
§5.2.1),
Co (xo° = [rFto(xo)]T rFto(xo°; 
(2.90)
maps from the domain of rFto(xo° into the range of [VFto(xo°]T. Therefore, by Eqs. (2.25) 
and (2.33), we can view this tensor pointwise as a linear operator

46
Eulerian and Lagrangian Fundamentals
Ct (xo° : Tx„Rn ! TxRn; 
to ( 0 ° xo 
xo
which renders Cto (x0° a Lagrangian tensor. By the same argument, the left Cauchy-Green 
strain tensor (see §5.2.1), defined as
Bto (xo° = rFto(xo° [rFJo(xo°]T; 
(2.91)
maps from the domain of [VFto(xo)]T into the range of rFto(xo). Therefore, by Eqs. (2.25) 
and (2.33), we can view this tensor pointwise as a linear operator
Bto (xo° : TFto(xo)Rn ! TFto(xo)Rn; 
(2.92)
which renders Bto (xo° a Lagrangian tensor for the backward flow map [Fto (xo)] 1 = Ft1 (xt °. 
Alternatively, we can view
Bt. (Ft3(x)) : TxRn ! TxRn 
(2.93)
as an Eulerian tensor (see §2.1.1). A direct calculation involving the definitions (2.90) and 
(2.91) of the right and left Cauchy-Green strain tensors, respectively, gives the relation
[Cto] "1 = [rFto] "1 [rFto] "T = rFto [W]T = Bto • 
(2.94)
Let the eigenvalue problem associated with the symmetric, positive-definite tensor Cto (xo° 
be defined as
Cttoi = ii; 
(2.95)
with the eigenvalues
o < A1(xo;to;t1° < ... < An(xo;to;t1° 
(2.96)
and orthonormal eigenvectors &(xo; to, t1° 2 TxoRn. We note that
IVFJo (xo)& I = q<rFto (xo)& rFto (xo)&} = q<€i; Cto faXi) = PA; 
(2.97)
and hence the deformation gradient stretches the eigenvectors of Ctto (xo° by a factor equal to 
the square root of the corresponding eigenvalue.
Applying the operator rFtto (xo° to both sides of the eigenvalue problem (2.95), using 
formula (2.97), then dividing both sides of the resulting equation by —Ai and defining the 
unit vectors i via the relation
Vi (xo; to; t1° = -1= rFto (xo°^i (xo; to; 11 ° 
(2.98)
Ai
gives
Bttoi = Aii; 
(2.99)
with the eigenvalues o < A1 < . . . < An coinciding with the eigenvalues of Ctto introduced in 
formula (2.95). Therefore, Eq. (2.99) shows that the spectrum (i.e., the set of eigenvalues) of 
Btto coincides with the spectrum of Ctto . The corresponding unit eigenvectors i for Btto are 
given in Eq. (2.98).
In summary, the linearized flow maps the unit eigenvectors of the right Cauchy-Green 
strain tensor into the direction of the eigenvectors of the left Cauchy-Green strain tensor,

2.2 Lagrangian Description of Fluid Motion
47
scaled by the square root of the corresponding eigenvalue. Based on this observation, we 
sketch the geometry of the strain eigenvalues and eigenvectors inFig. 2.18.
Bto(xo^i = *Vi
t0
c t o(xo)ei =a£
% ‘xo
vFts-Ai,
'2 2
infinitesimal 
ellipsoid
St = ?F‘t0 So
infinitesimal 
sphere 
So
trajectory
Figure 2.18 Deformation of a unit sphere based at x0 under the linearized flow map 
rFt0(xo° into an ellipsoid along a trajectory xt = Ft0(x0°: The principal axes of 
the ellipsoid have lengths equal to the square roots of the eigenvalues i of the right 
Cauchy-Green strain tensor Ct0 (x0°. These axes are aligned with the unit eigenvectors 
qi of the left Cauchy-Green strain tensor Bt0 (x0°.
Switching the times t0 and t in formula (2.94) and taking the inverse of both sides gives
Ct0 = [Bt0 | "1 • 
(2.100)
Therefore, by formula (2.99), for the spectrum of the backward-time right Cauchy-Green 
tensor Ctt0 we have
spect (Ct0 (F- (x 
. =Spect ([C-(x0)|-1) = {---1-0;--............—!—°}; 
2
even though Ct0 , [Ct01 1, as pointed out in Haller and Sapsis (2011). Furthermore, by Eq.
(2.100),the unit eigenvectors of Ctt0 coincide with those of Btt0 and hence we have
Ct0 qi = v qi; qi (X0; t0; t ° = & (X0; t0, t °, i = 1,2,3: 
(2.102)
xi
In two dimensions, if both pairs (&1, ^2) and (q1, q2 ° are selected to have the same orientation, 
then we can define an orthogonal rotation tensor Rw/2 so that
& = R.^1, q2 = R.^2q1 • 
(2.103)
In §2.3.2,we will also identify the linear operator, represented by the polar rotation tensor 
Rtt0 , that rotates all unit eigenvectors &i into the unit eigenvectors qi in any dimension. For 
2D flows, using the tensor Rtt0 and the relations (2.103), we therefore obtain
h&1, q1i = (&1, Rt0&1) = DR-1&, Rt0 R^fc E = D&2, Rt0 R^R^fc E = (&2, Rt0 & )
= h&2,q2i , 
(2.104) 

48
Eulerian and Lagrangian Fundamentals
because all rotations commute in two dimensions.
We also mention a further Lagrangian strain tensor that has been used in continuum 
mechanics. This tensor, the Green-Lagrange strain tensor, is defined as
Eto = 2 [Cto - I] ; 
(2.105)
and measures how close the material deformation is to the identity mapping. Note that 
the eigenvectors of this tensor coincide with the eigenvectors of Ctt with corresponding 
eigenvalues Ai (x0; t0, t° - 1 for i = 1,..., n.
We close by noting a property for 2D (n = 2) symmetric, nonsingular Lagrangian tensors 
A(x0,t0; t° = AT(x0,t0; t), such as the strain tensors Cto and Bt0 for 2D flows. For any such 
tensor, one can verify in coordinates the identity
0 1
JTAJ = (det A° A’1, 
J = J° 0 , 
(2.106)
which we will use repeatedly in later chapters.
2.3 Lagrangian Decompositions of Infinitesimal Material Deformation
Various approaches exist for identifying qualitatively different components of the deformation 
of material elements along trajectories. These decompositions have proven useful in isolating 
material properties of perceived purely advective transport barriers (or coherent structures). 
For later use, we survey here three available decompositions of the deformation gradient: the 
singular value decomposition (SVD), the polar decomposition (PD) and the dynamic polar 
decomposition (DPD). While these decompositions into rotation and deformation apply to 
more general linear operators as well, we will only discuss them here for the deformation 
gradient.
2.3.1 Singular Value Decomposition (SVD)
By a fundamental result in linear algebra, the nonsingular linear operator rFt0(x0° can be 
decomposed into a product
rFtt0 = Ptt0tt0 [Qtt0]T, 
(2.107)
where Ptt0 and Qtt0 are proper orthogonal matrices and tt0 is a positive-definite diagonal matrix 
(Golub and Van Loan, 2013). Therefore, Ptt0 and Qtt0 represent rotations and tt0 represents the 
combination of n independent, uniaxial compressions or extensions in mutually orthogonal 
directions.
Specifically, in terms of the strain eigenvalues Ai and unit eigenvectors i and i defined 
in the Cauchy-Green strain eigenvalue problems (2.95) and (2.99), we have
P pA1 ::: 
0 \
t t0
Pt0 = »^i,:::; 
, Q^^ = Ki',..., ^n] :
(2.108)
\ 0 
::: P^/

2.3 Lagrangian Decompositions of Infinitesimal Material Deformation 
49
In this context, the ^, are called the left singular vectors and the £i the right singular vectors 
of the deformation gradient rFt0. The diagonal entries pl are called the corresponding 
singular values of rFtt0. Apart from the ordering of singular values and singular vectors, the 
decomposition (2.107) is unique. The geometry of the two rotations, Qtt0 T and Ptt0, together 
with that of the stretching-compression tt0, is shown in Fig. 2.19. The figure also illustrates 
that
tt0: Tx0Rn ! TxRn
(2.109)
is a two-point tensor (see §2.2.15), just like the deformation gradient rFtt0:
3
Figure 2.19 The geometric meaning of the rotation tensors Qtt0 and Ptt0 , together 
with the triaxial stretching-compression tensor tt0 involved in the singular value 
decomposition (2.107) of the deformation gradient rFtt0.
A classic use of SVD is for the solution of linear algebraic equations. In our context, SVD is 
a quick and accurate tool for identifying the eigenvectors of the right and left Cauchy-Green 
strain tensors, which arise in several coherent structure detection methods discussed in later 
chapters.
The computation of the SVD of the deformation gradient for 2D and 3D flows is imple­
mented in Notebooks 2.3 and 2.4, respectively.

50
Eulerian and Lagrangian Fundamentals
Notebook 2.3 (SVD2D) Computes the singular value decomposition (SVD) of the defor­
mation gradient rFtt0 for a 2D velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/Decompositions/SVD2D
Notebook 2.4 (SVD3D) Computes the singular value decomposition (SVD) of the defor­
mation gradient rFtt0 for a 3D velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/Decompositions/SVD3D
2.3.2 Polar Decomposition
By the polar decomposition theorem, at any initial location x0 , the deformation gradient 
rFt0 (xo ° can also be uniquely decomposed as
rFtt0 = Rtt0Utt0 = Vtt0Rtt0; 
(2.110)
with the proper orthogonal rotation tensor Rtt0; the symmetric and positive definite right 
stretch tensor Utt0 and the symmetric and positive definite left stretch tensor Vtt0 (Gurtin et al., 
2010;Truesdell, 1992). One can verify by direct substitution into Eq. (2.110) that these 
tensors must be of the form
Uo = [Co. ]1/2; 
Vo = [Bto ]1/2; 
Rto = rFto [U. ] 1 = |vto 1 ~1 rFto; 
(2.111)
with Cto and Bto denoting the right and left Cauchy-Green strain tensors, respectively, as de­
fined in Eqs. (2.90) and (2.91). The decomposition (2.110) means that a general deformation 
can locally always be viewed as triaxial stretching and compression followed by a rigid-body 
rotation, or as a rigid-body rotation followed by triaxial stretching and compression, as shown 
in Fig. 2.20. The figure also illustrates that
Rtto: TxoRn ! TxRn 
(2.112)
is a two-point tensor (see §3.50), whereas
Ut : Tx Rn ! Tx Rn; 
to xo ! xo
Vtt : TxRn ! TxRn 
(2.113)
are Lagrangian and Eulerian tensors, respectively (see §§2.2.15 and 2.1.1).
The polar rotation tensor Rtto also turns out to be the closest rotation tensor to rFtto in the 
Frobenius matrix norm (see Neff et al., 2014). A further geometrically appealing property 
of the polar rotation is obtained by applying the deformation gradient to the Cauchy-Green 
eigenvector i and using the relations (2.110)-(2.111), which yields
rFto4. = Ro Uto4. = Rto ICto 11/2 4i = <Rto4i:
Comparing this formula with Eq. (2.98) then gives the result
Rtto4. = .; 
(2.114)

2.3 Lagrangian Decompositions of Infinitesimal Material Deformation
51
Figure 2.20 The geometric meaning of the polar rotation tensor, the left stretch 
tensor and the right stretch tensor, with their actions illustrated on an infinitesimal 
material cube.
showing that the polar rotation rotates the eigenvectors of Ctt0 into those of Btt0 . Substituting 
the polar decomposition formula (2.110) into the definitions (2.95) and (2.99) of the right 
and left Cauchy-Green strain tensors, respectively, we obtain
Ct =UtUt = Ut TUt; 
Bt =VtVt = Vt T Vt :
t0 
t0 
t0 
t0 
t0 
t0 
t0 
t0 
t0 
t0
This shows that the singular values and singular vectors of Utt0 coincide with the eigenvalues 
and eigenvectors of Ctt0 ; a similar relationship holds between Vtt0 and Btt0 .
The computation of the polar decomposition of the deformation gradient for 2D and 3D 
flows is implemented in Notebooks 2.5 and 2.6, respectively. 
—
Notebook 2.5 (PD2D) Computes the polar decomposition (PD) of the deformation gradient 
r Ft0 for a 2D velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/Decompositions/PD2D
Rto = I + sin 0P + (1 - cos 0° P2;
Notebook 2.6 (PD3D) Computes the polar decomposition (PD) ofthe deformation gradient 
rFtt0 for a 3D velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/Decompositions/PD3D
To associate a rotation angle with polar rotations, we recall the Rodrigues formula (see Basar 
and Weichert, 2000) by which Rtt , as any 3D rotation, can be written in the form
0 0 
- k 3 
k 2 \
P = 
k 3 
0 
- k 1
\ - k 2 
k 1 
0 /
jkj = 1:
(2.115)
Here, the skew-symmetric matrix P is determined by the unit vector k = (k1; k2; k3° defining 
the axis of the rotation performed by Rtt0 , and the polar rotation angle (PRA),
PRAtt0(x0° := 0(x0
(2.116)

52
Eulerian and Lagrangian Fundamentals
is the angle of rotation generated by Rtt0 around k.
By formula (2.112), Rtt0 is a two-point tensor and hence its trace is no longer an invariant 
(see §3.5).16 Keeping that in mind, we take the trace of both sides of the equation in 
(2.115), Farazmand and Haller (2016) obtain that the polar rotation angle satisfies
1 
1 X2
cos PRAto (xo° = 2 tr Rto (xo° = 
(&> Rto£i)
= h1; 1i = h2; 2i;
yielding the 2D analogue of the polar rotation angle formula (2.119) in the form
PRAto (xo° = cos-1 h^i; ^li = cos-1 h^2; ^2i; 
(2.121)
as noted by Kulkarni (2021).
The polar decomposition is an appealing tool in continuum mechanics for decomposing 
linearized material deformation between fixed initial and final configurations. This decompo­
sition, however, also has a lesser known disadvantage under variations of the initial and final 
configurations. Namely, polar rotation tensors computed over adjacent time intervals cannot 
be superimposed, i.e., they do not form a self-consistent family of subsequent rigid-body 
rotations. Specifically, for any two adjacent time intervals »T; 5] and »5, t], we generally have
Rt , RtsRs; 
(2.122)
16 The Rodrigues formula is for rotation matrices mapping a linear space into itself, and hence the formula (2.115) 
is only valid if the basis used in TsoRn is parallel-translated to T^t (xo)Rn. This implies that the Rodrigues 
formula and the PRAto (xo° depend on the frames of reference chosen in TxoRn and TFt (xo ,R.n.
17 In other words, the inner product can be evaluated as if i and i were elements of the same linear space.
cos [PRAto(X0°] = 1 * * * (tr Rto(xo° - 1). 
(2.117)
Here, we have pointed out the dependence of this rotation angle on the initial position x0 , as 
well as on the initial time t0 and the current time t .
Choosing {£i}3 1 (i.e., the eigenbasis of the right Cauchy-Green strain tensor Cto(xo°) as 
a basis in Tx0 Rn and parallel-translating this basis to obtain another basis in TxRn , we can 
specifically compute tr Rtt in this set of bases and use formula (2.114) to obtain
33
tr Rto = ^ {&, Rto&) = X & ^ i; 
(2.118)
i=1 
i=1
with the inner product computed by parallel-translating i into TxRn.17 Thus, as noted by 
Kulkarni (2021),Eqs. (2.117)-(2.118) imply that in the chosen set of bases, the PRA can be 
computed from the strain eigenvectors as
1
2
PRAto (xo° = cos 1
3X h&; ^i ~ 1
i=1
(2.119)
with £, and ^i computed as right and left singular vectors of rFto(x0), as in Eq. (2.108).
For 2D flows, setting k3 = 1 and k1 = k2 = o, then taking the trace of both sides of Eq. 
(2.115) and using formula (2.104) gives
(2.120)

2.3 Lagrangian Decompositions of Infinitesimal Material Deformation
53
as illustrated inFig. 2.21 (see Haller, 2016). This dynamical inconsistency implies, for 
instance, that Rt cannot be obtained from a sequence of incremental computations starting 
from time .
x( s)
x(t)
AT
x(T)
A = R sAT
R t * R t Rs
Rs
Rts
A = R t R sA 
s S T T
Bt = R %
Figure 2.21 Dynamical inconsistency of polar rotations. The action of the polar 
rotations Rt , Rs and Rts , illustrated on two infinitesimal, geometric volume elements 
A and B, based at the same initial point at time . The evolution of A is shown 
incrementally under the subsequent rotations Rs and Rts. The evolution of the volume 
B (with initial orientation identical to that of A ) is shown under the polar rotation 
Rt . All volume elements shown are nonmaterial: they only serve to illustrate how 
orthogonal directions are rotated by the various polar rotations involved.
The dynamical inconsistency of Rt does not imply any flaw in the mathematics of the 
polar decomposition, yet creates a need for another decomposition that can identify a truly 
materially evolving (and hence dynamically consistent) rotation component for the time­
evolving deformation gradient rFtt0 . Next, we describe such a decomposition.
2.3.3 Dynamic Polar Decomposition (DPD)
To address the dynamic inconsistency (2.122) of the classic polar rotation, Haller (2016) 
derives a dynamic version of this decomposition for time-dependent families of linear oper­
ators. We spell out this general result here specifically for the deformation gradient. For the 
statement of the main result, we will use the spin tensor W and the rate-of-strain tensor S 
defined inEq. (2.1). The spatial mean of the spin tensor over the entire evolving fluid mass 
of interest, D(t° = Ft0 (D(10°°, will be denoted by the mean-spin tensor
W(t° = 
W W(X; t° dV: 
(2.123)
VOl D(t° DD(t°

54 
Eulerian and Lagrangian Fundamentals
As shown by Haller (2016), the deformation gradient rFt0 (xo) admits a unique decom­
position of the form
rFtt0 = Ott0Mtt0 = Ntt0Ott0; 
(2.124)
where the proper orthogonal dynamic rotation tensor, Ott0 , is the deformation gradient of 
a purely rotational flow, and the right dynamic stretch tensor Mtt0 and the transpose of the 
non-degenerate left dynamic stretch tensor Ntt0 are deformation gradients of purely straining 
flows. Specifically, these tensors satisfy the initial-value problems
Oto = W (Fto(xo°; t) Oto; 
Ot0 = I; 
(2.125)
Mto = [OtoS (Fto(xo°; t) Oto ] Mto; 
Mto = I; 
(2.126)
4 (Nto)T = - [OtoS (Fto(xt°; to) Oto ] (Nto)T; 
(Nt)T = I: 
(2.127)
dto
The geometric meaning of the dynamic tensors Ott , Mtt and Ntt is similar to that of Rtt ; Utt 
and Vtto shown in Fig. 2.20. Correspondingly, Otto is also a two-point tensor, while Mtto and 
Ntto are Lagrangian and Eulerian tensors, respectively. However, the dynamic rotation tensor 
Otto, as the fundamental matrix solution of a linear ordinary differential equation (see Arnold, 
1978), satisfies the group property
Oto = OS OSo; 
5; t 2» to; t1 J 
(2.128)
and hence is dynamically consistent. The tensor Otto represents twice the mean material 
rotation observed for any small, passive rigid object (vorticity meter) carried on the surface 
of fluid flows in experiments (see Shapiro, 1961; Haller, 2016). This tensor also admits a 
further factorization
Otto = ttotto; 
(2.129)
into the relative rotation tensor tt and the mean rotation tensor tt , which satisfy the initial 
value problems
*to = 
[W (Fto(xo°; t) - W (t)] ^
0 to = 
[0to W (t ° 0to ] 0to ;
with the mean-spin tensor W (t° defined in Eq. (2.123). The relative rotation tensor, ^t, as 
the fundamental solution matrix of a linear ordinary differential equation, is also dynami­
cally consistent. The mean rotation tensor, 0tt0 , however, solves a differential equation with 
memory, just as Mtt0 and Ntt0 do. Indeed, the coefficient matrices of these linear differential 
equations depend explicitly on the initial time t0. As a consequence, 0tt0 , Mtt0 and Ntt0 are not 
dynamically consistent.
The computation of the dynamic polar decomposition of the deformation gradient for 2D 
and 3D flows is implemented in Notebooks 2.7 and 2.8, respectively. 
—
Notebook 2.7 (DPD2D) Computes the dynamic polar decomposition (DPD) of the defor­
mation gradient r Fto for a 2D velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/
demos/Decompositions/DPD2D
I;
t0t0
0t0 t0
(2.130)
I;

2.3 Lagrangian Decompositions of Infinitesimal Material Deformation
55
Notebook 2.8 (DPD3D) Computes the dynamic polar decomposition (DPD) of the defor­
mation gradient rFtt0 for a 3D velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/Decompositions/DPD3D
Haller (2016) shows that the instantaneous axis of rotation associated with the relative 
rotation tensor ®to is aligned with the vector - [! (Ft0(x0°, t) - !(t°], where
!(t° = 
! !(X; t° dV 
(2.131)
vol D(t° D(t°
is the mean vorticity of the fluid mass D(t°. The total accumulated rotation (total angle swept 
with no regard to direction) experienced by any vector under the action of tt around this 
time-varying rotation axis is given by the intrinsic dynamic rotation angle
1t
K(xo° = - 
|!(FSo(xo°; s° - !(s°| ds; 
(2.132)
as illustrated in Fig. 2.22.
Figure 2.22 The geometry of the intrinsic dynamic rotation angle as the total angle 
swept by an arbitrary initial vector r (based at an initial location x at time ) under 
the action of the relative rotation tensor ®* (xT°. The vector r(t° denotes the rotated 
position of r under the evolving axis of rotation of t (x °.
This rotation angle is independent of the frame of reference and can be computed incre­
mentally over any two times t and t. Consequently, ^t (x0° gives an appealing alternative 
to the polar rotation angle tt0 (x0° for extracting a local rigid body rotation in the flow in a 
self-consistent manner. The intrinsic dynamic rotation angle also creates a direct connection 
with vorticity and hence is more connected with the fluid-mechanical intuition for local 
rotation in the flow.
At the same time, i0rto (x0° depends on the choice of the reference fluid mass D(t° with 
respect to which the mean vorticity !(s° is computed. In practice, one chooses D(t° to 
be the full domain over which the velocity field is known. This arguably gives the best- 

56
Eulerian and Lagrangian Fundamentals
V(X; t° =
(2.133)
informed assessment for the deviation of local rotation from the overall rotation of the fluid, 
as represented by the integrand in Eq. (2.132).
2.4 Are the Eulerian and Lagrangian Approaches Equivalent?
The Lagrangian and Eulerian descriptions of fluid motion are sometimes portrayed as equiv­
alent alternatives, with each defined in a different frame. For steady flows, or more generally, 
directionally steady velocity fields of the form (2.51), this statement is correct: an instan­
taneous snapshot of the velocity field holds all information about the past and future of all 
material trajectories. Specifically, streamlines coincide with particle trajectories.
Another rare direct connection between Eulerian and Lagrangian evolution is known for 
steady incompressible inviscid flows. In such a flow, any Lagrangian instability manifested 
by a positive Lyapunov exponent (such as the instability caused by a saddle-type stagnation 
point or by chaotic trajectories) implies that the flow, as a whole, is unstable. Specifically, 
typical small, incompressible and inviscid perturbations to the velocity field will grow in 
time at a rate that is at least as fast as the rate of the Lagrangian instability within the flow 
(see Appendix A.3).
For general unsteady flows, however, the only connection between the Eulerian and La­
grangian descriptions is that the Lagrangian particle trajectories are solutions of the differ­
ential equation (2.17),whose right-hand side is the Eulerian velocity field. This differential 
equation has solutions that generally differ vastly from those of the differential equation (2.3) 
for streamlines. To illustrate this, we consider the 2D unsteady velocity field
- sin ct cos ct + a x b y2 - x2 
cos ct - a sin ct y 
2xy
with the parameters a, b, c 2 R (see Pedergnana et al., 2020). A direct substitution shows 
that the velocity field (2.133) is a solution of the 2D version of the Navier-Stokes equation 
(2.67) for any value of the viscosity, given that the Laplacian of Eq. (2.133) vanishes. 
This velocity field has simple spatiotemporal behavior as it depends periodically on time and 
quadratically on space. In the left subplot of Fig. 2.23,two broadly used Eulerian diagnostics, 
the instantaneous streamlines and the Okubo-Weiss elliptic region (see §3.7.1) are shown 
for Eq. (2.133).
This picture is qualitatively similar for all other initial times t0 , 0 as well, except that 
the features rotate around the origin as t0 is varied. Therefore, the two Eulerian diagnostics 
suggest the presence of a vortical feature in the center of the flow. In the right subplot of 
the same figure, the same Eulerian analysis is shown, but now with the result of some key 
Lagrangian flow structures superimposed. Specifically, the stable and unstable manifolds18 
of the fixed point at the origin are shown, indicating chaotic mixing due to the presence of 
a homoclinic tangle (see §4.1.1). This implies the complete lack ofa closed, vortical region 
surrounding the origin in the Lagrangian dynamics. Therefore, the two Eulerian diagnostics 
provide a false positive for a coherent vortex that would inhibit mixing. Their prediction 
would be inconsistent with any dye or particle experiment carried out on this flow.
18 These manifolds can be constructed numerically by observing that the flow linearized at the origin becomes 
steady in an appropriate rotating frame (see Pedergnana et al., 2020), and hence the tangent spaces of stable 
and unstable manifolds at the origin are known explicitly for all times.

2.4 Are the Eulerian and Lagrangian Approaches Equivalent?
57
Figure 2.23 Eulerian and Lagrangian features in the Navier-Stokes velocity field 
(2.133) for a = 2; b = 0:1 and c = -4 at time t = 0. (Left) Streamlines (black) and 
Okubo-Weiss elliptic region (yellow), with the latter marking points where vorticity 
dominates the rate-of-strain eigenvalues in norm. (Right) Same but with the stable 
and unstable manifolds of the Poincare map P0 = F^4 (see §4.1.1) superimposed.
As a second example,Fig. 2.24 shows the results of similar analyses for the parameter 
configuration for a different parameter configuration in the Navier-Stokes velocity field 
(2.133) (see Pedergnana et al., 2020). In this case, the complete absence of closed streamlines 
and Okubo-Weiss elliptic domains in the region shown suggests hyperbolic (stretching) 
behavior, whereas the Lagrangian dynamics is, in fact, elliptic (vortical) around the origin. 
Therefore, the two Eulerian diagnostics, provide a false negative for a coherent vortex, which 
again would be in contradiction with the results of flow visualization experiments carried 
out on this velocity field.
The 2D Navier-Stokes velocity-field family (2.133), depending on the planar variable 
x = (x; y°, also generates an exact solution family for the full, 3D Navier-Stokes equation 
(2.67) (see Majda and Bertozzi, 2002). Indeed, if we partition the 3D spatial variable as 
(X; z° and seek a corresponding 3D Navier-Stokes velocity field (v(x, t°, w(x, t)) and pressure 
field p(X; t), then substitution of this trial solution into Eq. (2.67) with g = 0 yields the 
advection-diffusion equation
wt + rw v = w 
(2.134)
for the unknown vertical velocity component w(x, t°. This equation will have a unique solution 
w(X; t° for any initial vertical-velocity distribution w(x, 10° = w0(x), with the simplest solution 
being w(x, t° = 0. The latter choice extends our 2D conclusions above about discrepancies 
between the Eulerian and the experimentally observable Lagrangian flow descriptions to 3D 
flows.
One might still argue that instantaneous Eulerian features, such as streamlines, vorticity 
and strain are more relevant for the physics of fluids than Lagrangian particle behavior. 
This view, however, is in sharp contrast with the considerations involved in the heuristic 
derivations of common Eulerian diagnostics (see §3.7.1), which all start out by seeking

58
Eulerian and Lagrangian Fundamentals
15
10
5
0
-5
-10
-15
-15 
-10 
-5 
0 
5 
10 
15
x1
Figure 2.24 Eulerian and Lagrangian features in the Navier-Stokes velocity field 
(2.133) for a = 0:5; b = -0:015 and c = -4 at time t = 0. (Left) Streamlines and 
Okubo-Weiss hyperbolic region (white background), with the latter marking points 
where the rate-of-strain eigenvalues dominate the vorticity in norm. (Right) Same but 
with iterations of a grid of initial conditions under the Poincare map P0 = Fq ^4 (see 
§4.1.1) superimposed in blue.
to classify regions of qualitatively different fluid particle motion. All these derivations are 
then invariably faced with the insurmountable challenge of classifying solution behavior in 
nonlinear, non-autonomous differential equations without solving for trajectories of these 
equations. It is at that point that the derivations depart from the originally stated objective 
and replace Lagrangian considerations with instantaneous Eulerian reasoning.
The assessment from Eulerian diagnostics applied to the example velocity field (2.133) 
also depends on the frame of the observer. In contrast, the assessment of Lagrangian flow 
topology provided by the Poincare map is independent of the frame and hence is intrinsic to 
the flow. This discrepancy highlights the importance of the principle of objectivity (or frame­
indifference) as a fundamental requirement for self-consistent flow structure detection, as 
proposed in the 1970s by Drouot (1976), Drouot and Lucius (1976) and Lugt (1979). We 
will elaborate on this principle and its implications in Chapter 3.
2.5 Summary and Outlook
In this chapter, we have surveyed the basic Eulerian and Lagrangian concepts along with 
results that we will be using throughout this book to describe transport barriers and coherent 
structures. On the Eulerian side, we have recalled the notion of the velocity field v(x; t°, 
its gradient rv and the unique decomposition of rv as a sum of the symmetric rate-of- 
strain tensor S and the skew-symmetric spin tensor W. We have also reviewed the notions 
of stagnation points, streamlines and streamsurfaces from a geometric perspective, with an 
emphasis on their structurally stable types.
Among the Lagrangian tools discussed, the central notion has been the flow map, Ftt0 , 
which enables a geometric treatment of sets of fluid particle trajectories (pathlines) in the 

2.5 Summary and Outlook
59
phase space of the dynamical system generated by a velocity field v(x t°. Material lines, 
material curves and fixed points can then all be viewed as invariant manifolds of this map. 
Spatially or temporally recurrent flows are often easier to study under stroboscopic samplings 
of Ft0, which has led us to discuss temporal and spatial Poincare maps.
We have reviewed detailed properties of the deformation gradient, rFtt0 , including various 
decompositions of this two-point tensor that seek to identify different components of material 
deformation. The deformation gradient is also key to the definition of the various strain tensors 
we have introduced to describe large deformations in fluid flows. We have also surveyed 
available global mathematical predictions for volume- or mass-conserving flows confined to 
compact domains. These predictions include the repeated return of trajectories arbitrarily 
close to their initial positions (Poincare’s recurrence theorem) and the convergence of time­
averages of observables to their spatial averages in perfectly mixing flows (Birkhoff’s ergodic 
theorem). While neither of these theorems is applicable to particle motion in temporally 
aperiodic velocity fields, both theorems will be important in the study of transport barriers 
to steady and temporally recurrent flows in Chapter 4.
Our survey of Lagrangian results has focused entirely on deterministic flows, even though 
Lagrangian fluid mechanics has traditionally emphasized statistical methods. This tradition 
has been motivated by the complexity of turbulence, which continues to inspire stochastic flow 
models and their statistical analysis (see, e.g., Dryden et al., 1941;Monin and Yaglom, 2007; 
Sabelfeld and Simonov, 2012). In contrast, this book focuses on flows known as specific 
velocity data sets, which in turn generate specific deterministic (albeit often complex), 
finite-time, nonautonomous dynamical systems for fluid motion.19 For this reason, we have 
collected here the most important tools that arise in the data-driven global analysis of 
structurally stable invariant sets of nonautonomous dynamical systems. In Chapter 8, we will 
also discuss barriers for stochastic transport, but will find that such barriers can still be fully 
captured from the data-driven analysis of the deterministic component of the velocity field 
under small stochasticity.
19 We will study structurally stable transport barriers in such a realization of a fluid flow, as those barriers are 
guaranteed to persist in close enough realizations of the same flow.

3
Objectivity of Transport Barriers
If we accept that transport barriers should be material features for experimental verifiability 
(see §1.2), we must remember a fundamental axiom of mechanics: the material response of 
any moving continuum, including fluids, must be frame-indifferent or objective. This means 
that the conclusions of different observers regarding material behavior must transform into 
each other by exactly the same rigid-body transformation that transforms the frames of the 
observers into each other (see, e.g., Gurtin, 1981;Truesdell, 1992;Gurtin et al., 2010). For 
instance, in accordance with the frame-indifference of material behavior, observers A, B and 
C in Fig. 3.1 will identify precisely the same closed material barrier between coffee and milk, 
although each of these observers would see this unique barrier perform a different motion in 
their own frame.
Figure 3.1 Observed material transport barriers are frame-indifferent, as evidenced 
by observations of a cup of coffee that still has unmixed milk in it. Specifically, all 
observers identify the same set of material points as an interface between coffee and 
milk, even though this interface performs a different relative motion in each observer’s 
frame.
At the same time, the three observers will disagree about the surface velocity field of 
the coffee relative to their frames, even when their own rigid-body motions are taken into 
account (see §3.3). This is because instantaneous fluid velocity fields are not material objects 
and hence need not be objective. Indeed, how fast and in what direction a fluid particle 
instantaneously moves depends on the frame from which that particle is observed. In contrast, 
60

Objectivity of Transport Barriers
61
the set of points forming a fluid trajectory generated by one of these velocity fields describes 
material behavior, and hence trajectories must be objective. Indeed, different observers may 
see different shapes for a trajectory,1 but these different shapes can be reproduced from each 
other by applying the same rotation and translation that connects their observers to each 
other.
1 For instance, an observer traveling with a fluid particle will see the whole trajectory of that particle as a single 
material equilibrium point in their frame.
In the context of the flow experiments shown in Fig. 3.2, a person standing by the experi­
mental facility, another one just passing by and a third one just turning towards the experiment 
will visually identify the exact same influential material surfaces. These material surfaces 
will exhibit different motions in these three different observers’ frames, but the material 
points that form them will be uniquely identified by each observer. Finally, the observers will 
also identify the same motion for these material surfaces once they factor in their own motion 
relative to that of the other observers. The indifference of observed material patterns to the 
frame of the observer holds even for reactive and diffusive patterns, and has been shown 
experimentally (see, e.g., Fig. 4.29).
(a)
(c)
Figure 3.2 Experimental flow visualization highlights exceptional material surfaces 
that are noted by all observers, independent of their frames. (a) Prandtl’s experiment 
for visualization of material structures via small pieces of aluminum foil. Image: 
Jaganath, Wikipedia. (b) Smoke visualization of flow near an F-16XL aircraft. Image: 
Glenn Research Center, NASA. (c) Evolving material interface of fluorescein powder 
in tap water under typical blacklight. Image: Bricksnite [CC BY 3.0 (https:// 
creativecommons.org/licenses/by/3.0)].

62 
Objectivity of Transport Barriers
3.1 Common Misinterpretations of the Principle of Material Frame-Indifference
Our discussion on Figs. 3.1 and 3.2 might read like a restatement of the obvious, yet the 
principle of objectivity is often ignored or misinterpreted in fluid mechanics. An example of 
a common misinterpretation is the following statement:
Even the fundamental equation of fluid mechanics, the Navier-Stokes equation, is not 
objective. Therefore, the principle of objectivity does not apply to fluid mechanics and 
hence should not be upheld for descriptions of transport in fluid flows.
The Navier-Stokes equation does indeed change its form when one transforms it from an 
inertial frame2 to a noninertial frame - as any equation of motion in mechanics does. If this 
fact rendered the notion of objectivity irrelevant for fluid mechanics, it would surely render it 
irrelevant for the whole field of continuum mechanics, in which it is nevertheless one of the 
main axioms. This paradox, therefore, already suggests that the argument cited above must 
be fallacious.
2 An inertial frame is a coordinate frame in which Newton’s equation of motion is valid, with all forces in the 
equation arising from known interactions. In noninertial frames, by contrast, Newton’s equation is only valid 
under the inclusion of additional inertial terms. These terms are perceived as forces by an observer in the 
noninertial frame but they do not arise from actual interactions. Rather, they arise solely from the acceleration 
of the frame relative to inertial frames.
Indeed, it is. The principle of objectivity does not state that equations of motion should be 
indifferent to the observer. Rather, it states that material response, i.e., particle trajectories 
generated by those equations of motion, should be frame-indifferent. The latter principle is 
just as strongly exploited in fluid mechanics as in other areas of mechanics. In fact, objectivity 
of material response is our only guiding principle for deriving the Navier-Stokes equation in 
noninertial frames, as we shall see in §3.2.
Another common misunderstanding of the notion of objectivity is manifested by the 
following statement:
The material behavior of a fluid placed in a moving container is clearly different 
from that of a fluid in a non-moving container. In fact, we shake fluids precisely to 
enhance their material mixing and transport relative to the original (unshaken) frame 
of reference. Therefore, the principle of objectivity does not apply to fluid mechanics 
and hence should not be upheld for descriptions of transport in fluid flows.
This misunderstanding of the principle of material frame indifference also surfaces sometimes 
in the continuum mechanics literature. Placing the fluid in a moving container changes 
the external force field exerted by the moving container boundaries on the fluid. As a 
consequence, the material response of the fluid will, of course, change. In contrast, the 
principle of objectivity postulates indifference in the material response of a fluid only under 
changes of the observer, without any change to the actual motion of the fluid. If in doubt 
about the validity of this postulate, the reader is encouraged to perform the experiment shown 
in Fig. 3.1 next time they are in a coffee shop!
Finally, the principle of objectivity is sometimes thought to be relevant only for flows with 
complicated time dependence but not for steady or time-periodic flows. This argument states 
that:

3.2 Objectivity Yields the Navier-Stokes Equation in Arbitrary Frames
63
If a flow in a given frame has simple time dependence, such as steady or periodic, 
then there is no reason to consider general frame changes for the study of that flow, as 
those would only make the velocity field more complicated. Therefore, the principle 
of objectivity is irrelevant in the study of fluid flows with simple time dependence.
This statement is also inaccurate. Material frame indifference is an important litmus test 
in any flow for approaches that claim to describe material behavior. If such an approach 
is not objective, then it may describe material behavior incorrectly even under simple time 
dependence. For instance, level sets of velocity components are not objective and hence 
cannot be trusted as reliable indicators of experimentally observable (and hence material) 
structures even in simple flows. Indeed, the examples of §3.7.1 will show how level sets of 
velocity components can give fundamentally flawed conclusions about the transport of fluid 
trajectories even in 2D steady flows.
3.2 Objectivity Yields the Navier-Stokes Equation in Arbitrary Frames
It is often forgotten that material frame-indifference is the single principle we always use in 
transforming equations of motions between different coordinate frames. To see this, consider 
coordinates x 2 U R3 defined on an open domain U of the physical space with respect to 
an inertial frame of reference. Assume a reference frame change from these x coordinates to 
a rotating, noninertial set of y coordinates via
x = Q( t °y + b( t °; 
(3.1)
where Q(t° is a time-dependent rotation matrix and b(t° is a time-dependent translation 
vector. Assume now, for simplicity, that the y-frame is not shifted (b(t° = 0) and rotates with 
a constant angular velocity vector 00, defined by the relation
QT(t)Q(t°e = 00 x e; 
(3.2)
for all e 2 R3 .
Formulas (3.1)-(3.2) represent a common frame change for geophysical flows over a planet 
rotating with angular velocity >0. Indeed, a number of reference books on geophysical fluid 
dynamics give us the Navier-Stokes equations in such a rotating frame as
@tV + (Vv)v = -1 rrp + vAv + g + |00|2y - 200 x V; 
(3.3)
with the tilde referring to appropriate quantities and operators defined in the y-frame. The 
newly appearing terms on the right-hand side, usually called the centrifugal and Coriolis 
forces, are inertial effects arising from the noninertial nature of the rotating frame.
But how exactly do we obtain Eq. (3.3)? Its derivation invariably starts with the differen­
tiation of the coordinate change (3.1) with respect to time to yield a relationship between 
the original and the transformed velocities. At this very first step in the derivation, by the 
independence of space and time in Newtonian mechanics, why do we not obtain 0 = Q(t)y 
upon differentiating (3.1) with respect to t? The reason is simple: before we do anything, we 
postulate the principle of objectivity by assuming
x( t ° = Q( t °y( t °; 
(3.4)

64
Objectivity of Transport Barriers
i.e., that (3.1) holds along all material trajectories. In other words, we do not yet know the 
governing equation in the y-frame, but we are already declaring that the transformed particle 
motion y(t° must be related to the original motion x(t° precisely by the observer change 
(3.1). Inertial forces in the transformed Navier-Stokes equation (3.3), as in any tranfformed 
equation of mechanics, arise in this calculation precisely to ensure that the assumption (3.4) 
of material frame-indifference is fulfilled. We know of no other procedure for deriving the 
Navier-Stokes equation in a general, noninertial frame. Indeed, more general frame changes 
of the form (3.1) are not covered in geophysics reference books, and hence our only guiding 
principle for obtaining the Navier-Stokes equation in such frames is to assume material 
frame-indifference. Specifically, we a priori require
x( t ° = Q( t °y( t ° + b( t °
to hold for all trajectories, then differentiate this relation twice in time to obtain an expression 
for the acceleration in the y-frame.
In summary:
We reverse-engineer the Navier-Stokes equations in noninertial frames precisely from 
the principle of material frame-indifference. That is, in fact, the only procedure we 
know for deriving these equations in such frames.
Therefore, the principle of objectivity is just as strictly upheld in the fundamentals in fluid 
mechanics as it is in other areas of mechanics. Yet, when it comes to analyzing material 
transport in fluids, the same principle is often ignored or forgotten, despite early recognitions 
of its importance within the fluid dynamics community by Drouot (1976), Drouot and 
Lucius (1976), Astarita (1979) and Lugt (1979). For our treatment of transport barriers in 
the upcoming chapters, we now give a more detailed treatment of objectivity for quantities 
relevant for material transport. Following, e.g., Ogden (1984), we will distinguish between 
the Eulerian and the Lagrangian notions of objectivity.
3.3 Eulerian Objectivity
In order to discuss the frame-indifference of the Eulerian quantities defined in §2.1.1, we 
consider general frame changes x 7! y represented by the Euclidean transformations
X = Q(t°y + b(t°, QT(t°Q(t° = I; Q(t°2 SO(3°, b(t°2 R3, 
(3.5)
where the proper rotation matrix Q(t° and the translation vector b(t° are smooth functions of 
time. Instead of expressing the new y-frame as a translation and rotation of the old x-frame, 
we have done the opposite in the frame changes (3.5) in order to simplify the upcoming 
transformation of quantities defined in the x-frame to their counterparts in the y-frame. We 
illustrate the geometry of the observer changes arising from the Euclidean transformations 
(3.5) in Fig. 3.3.
As seen in the figure, the general frame changes (3.5) cover all possible motions of a human 
observer. As a consequence, Euclidean transformations rotate and shift the coordinate axes 
in all possible ways but preserve angles and lengths. We note that differentiating the identity 
QT (t°Q(t° = I with respect to t gives
QTQ = -QTQ = - [QTQ]T, 
(3.6)
and hence QTQ is a skew-symmetric tensor.

3.3 Eulerian Objectivity
65
x
1
b(t)
Figure 3.3 The geometry of the observer changes represented by the Euclidean 
transformations (3.5): rotation by Q(t° followed by a translation by b(t°.
3.3.1 Objectivity of Eulerian Scalar Fields
An Eulerian scalar field a(x; t° is defined in a frame-indifferent fashion if all observers obtain 
the same scalar value when they evaluate the definition of a in their own coordinate systems 
at the same point of Rn .
Technically speaking, therefore, a(x; t° is objective if it remains invariant under all Eu­
clidean transformations (3.5), i.e., its value, a(y. t°, in the y-frame satisfies
a(y. t ° = a (x. t °. 
(3.7)
for all y and x related through (3.5). This seems like a requirement any scalar field would 
satisfy, and that is indeed the case for scalars whose definition only involves a concentration 
field associated with a particular location at a particular time.
Consider, however, the norm of the velocity field v(x; t°, a scalar field often used to infer 
barriers to transport in scientific visualization. As we will see shortly in §3.3.2, under the 
frame change (3.5), this scalar field becomes
jv(y.t°j = |qt(t° (v(x. t° - Q(t°y - b(t)j| = |v(x,t° - Q(t°y - b(t°|. 
(3.8)
Therefore, the velocity norm is not an objective scalar because it does not satisfy condition 
(3.7).
Another important scalar field for 2D incompressible flows is the stream function (x; t° 
defined in Eq. (2.4). We show in Appendix A.12.2 that under the general observer change 
(3.5), the stream function in the y-frame takes the form
<A(y. t° = <HQ(t°y + b(t°. t° + (JQt(t°b(t°.y) - 2!q(t°hy.yi. 
(3.9)
where !Q(t° is the angular velocity of the observer change (3.5), defined as
QTQ = ( 
!Qq(t° 1 = !Q(t°J; 
(3.10)
-!Q( t ° 
0

66
Objectivity of Transport Barriers
with the matrix J introduced in Eq. 22.4). (Here we used the skew-symmetry of QTQ from 
formula (3.6) in the present 2D context.) Therefore, by formula (3.9), the stream function is 
not objective.
Other examples of nonobjective scalar fields include individual coordinate components of 
the velocity field and the norm of the vorticity. Objective scalar fields include the pressure 
p(x) or the norm of any objective vector or tensor field to be discussed below.
3.3.2 Objectivity of Eulerian Vector Fields
Material tangent vectors of an evolving material curve, r(s; t° = Ft0 (r(,s; 10)), parametrized 
by a scalar parameter s 2 R, serve as models for how objectively defined vectors should 
transform from one observer frame to the other. At any point of such a material curve, the 
tangent vector of the curve can be computed as
C(5; t° = @sr(s; t°. 
(3.11)
At all times, individual material points on r(s; t° transform to the y-frame according to the 
formula (3.5), and hence once can write
r(s; t° = Q(t°r(s; t° + b(t° 
(3.12)
for the representation r(s; t° of the same material curve in the y-frame. Taking the partial 
derivative of both sides of Eq. (3.12) with respect to s, then multiplying both sides by QT(t° 
and using the tangent vector formula (3.11) gives that the transformed material tangent vector 
C(s; t° = @s r(s; t° satisfies
C = Q C 
(3.13)
One can similarly compute how a normal vector n(t; s 1, s2° to an evolving material surface 
r(t; s 1; s2°; parametrized by the two parameters s 1; s2 2 R, transforms under an observer 
change. Substituting r(t; s1; s2° into formula (3.5) and repeating the argument leading to Eq. 
(3.13) gives
n = @s1 r x @s2r = (QT@s1 r) x (Qt@s2r) = QT (@s1 r x @s2r) = Q n (3.14) 
for the transformed normal vector of the material surface.
Formulas (3.13)-(3.14) serve as prototypes for the transformation of frame-indifferent 
vectors. Accordingly, an Eulerian vector field a(x; t° is said to be objective if it transforms 
under the observer change (3.5) as
a'(y;t° = QT(t°a(x;t°. 
(3.15)
As a first example, consider the transformed velocity field v under the frame change (3.5). 
This transformed field, v(y; t° = y, can be obtained by differentiating Eq. (3.5) with respect 
to time, which yields
v = Q y + Qy + b = Q y + Qv + b. 
(3.16)
Therefore, for the transformed velocity field y = v(y; t°, we obtain
v = QT (v - Qy - lb). 
(3.17)

3.3 Eulerian Objectivity
67
Since v does not satisfy the requirement (3.15), the velocity field v is not objective. At the 
same time, the divergence of the velocity field is an objective scalar field because
V . v = tr [Vv] = tr hr (qt (v - Qy - lb)) Qi = tr hQT (Vv - QQT) Qi
= tr [Vv - QQT ]
= r . v; 
(3.18)
given that the skew-symmetry of QQT (established in formula (3.6)) implies that it has zero 
trace. In the derivation (3.18), we have also used the fact that QT (Vv - QQT)Q is just the 
representation of the tensor Vv - QQT in a different basis and hence both tensors have the 
same trace.
As a second example, we compute the material derivative D = @t v + (Vv° v under the 
observer change (3.5) by taking the material derivative of both sides of formula (3.16) and 
expressing D. This gives
D v 
/D v 
\
Dti = Q (D - Qy - 2Qv - b); 
(319)
which means that the material derivative is not an objective vector field.
An argument detailed inAppendix A.12.1 shows that the vorticity vector field ! = V v 
transforms under the observer change (3.5) as
a = QT (! - q°; 
(3.20)
where q is the vorticity (twice the angular velocity vector) of the frame change, defined by 
the requirement that
2 q x e = QQTe
holds for all vectors e 2 R3.3 Therefore, by the transformation formula (3.20), the vorticity 
is not an objective vector field either, as it fails to satisfy Eq. (3.15).For 2D flows (x 2 R2), 
only the third component of the vorticity, !3 = @x1 v2 - @x2 v1, can be nonzero, and hence for 
all rotations Q(t° of the x-plane, formula (3.20) simplifies to
3 By Appendix A.12.1, such a q always exists because QQT is always skew-symmetric by formula (3.6).
!3(y; t° = !3(X; t° - q3(t). 
(3.21)
This last equation shows that the 2D vorticity !3(x t° is not an objective scalar field either 
as it fails to satisfy the requirement (3.7) for objective scalars. However, formula (3.21) also 
shows that the instantaneous level curves of the scalar vorticity, !3(x t°, are objective. Indeed, 
the value of !3 on individual level curves will be uniformly decreased by q3(t° according to 
the transformation formula (3.20), but the set of level curves, as a whole, remains unchanged.
The same conclusion does not hold for the level sets of the vorticity norm |a(x t)| in 3D 
flows. Indeed, those level sets obey the transformation rule
|!(X; t)| = |a(X; t° - q(t)| = const:;

68
Objectivity of Transport Barriers
which will generally result in a change in the topology of the level sets, given that q(t° is no 
longer a scalar in three dimensions. The vorticity difference between two points, x1 and x2 , 
however, will have an objective norm because
j!(^yi, t)- !(y2) t)| = j!(xi; t)- !(X2; t)|
holds by formula (3.20).
The 2D vorticity gradient, r !3(x, t°, is also an objective vector field because differentia­
tion of Eq. (3.21) with respect to the transformed coordinate y gives
dxT
r! = 
r!3 = Q r^ 
(3.22)
satisfying the objectivity condition (3.15).
The Objective Deformation Velocity
Our final example of an objective Eulerian vector field is the deformation velocity, introduced 
by Kaszas et al. (2021) as the deviation of a velocity field from its closest rigid-body motion 
approximation. Specifically, let us define the norm of a smooth vector field f(x, t° on a 3D 
spatial domain U as
||f|\l := -1 I jf(X;t°j2 dm + a 1 I |rf(x;t°j2 dm 
MU 
MU
= jf j2 + |rf j2; 
(3.23)
where the overbar abbreviates mass-based averaging and M denotes the total fluid mass in 
U , dm is the mass element, and the factor a 0 ensures dimensional consistency between 
the two terms in the norm while also controlling the relative contribution of smaller spatial 
scales in the norm.
A general 3D rigid body containing the fluid’s center of mass, X(t° 2 U, and rotating with 
angular velocity !(t° has a velocity field of the form
Vrb(X; t;!(t)) = X(t° + !(t° X (x - X(t°°:
Finding the closest rigid-body velocity field, VRB (x, t;!(t)), to v(x, t° at any given time t, 
with respect to the norm (3.23) amounts to finding the angular velocity !(t° that minimizes 
kv (x, t° - VRB (x, t;!(t°°||2. Kaszas et al. (2021) solve this minimization problem explicitly 
to obtain the minimizing angular velocity field
!a(t° = M | <-),, | -1(x - X° X (v - v° + ar X V; 
(3.24)
with the generalized moment of inertia tensor defined as
&a := M^2a + |x - X|2) I - (x - X° ® (x - X). 
(3.25)
A longer calculation shows (see Kaszas et al., 2021) that the deformation velocity compo­
nent of v, defined as
VJX;t° := v(x,t° - VRB(X; t; !a(t°° = v(x,t° - V(t° - !a(t° X (x-X(t°°; 
(3.26)
is an objective velocity field. The velocity field v is also physically observable: it coincides 
with a rotated version of v in the observer frame co-moving with vrb(x, t; !a(t)). As a 

3.3 Eulerian Objectivity
69
result, most physical quantities derived from the velocity field v (such as the vorticity, kinetic 
energy, enstrophy and helicity) become objective when computed in the frame co-moving 
with vRB(x t; !a(t)) (see Kaszas et al., 0211).
3.3.3 Objectivity of Eulerian Tensor Fields
We will say that an Eulerian tensor field A(x; t° is objective if the outcome of the application 
of A to any frame-indifferent vector field returns a frame-indifferent vector field. Specifically, 
applying A to an objective vector field a(x; t), the objectivity of the vector field Aa can be 
ensured by requiring
A (y; t °a (y; t ° = QT( t )A(x; t °a(X; t ° = QT( t )A(x; t °Q( t °a (y; t °; 
(3.27)
with A denoting the transformed version of A in the y-frame.
The relation (3.27) must hold for any choice of a(x,t° for A to be frame indifferent. 
Therefore, we will call an Eulerian tensor field A(x; t° objective if it transforms under the 
observer change (3.5) as
A (y; t ° = QT( t °A(X; t °Q( t ). 
(3.28)
Objectivity, therefore, requires A(y, t° and A(x; t° to be similar matrices at all times. As 
a consequence, the eigenvalues and eigenvectors of an objective tensor are also objective, 
satisfying the relations (3.7) and (3.15), respectively, by the classic properties of similar 
matrices.
As an example, we take the y-gradient (denoted r) of the velocity transformation formula 
(3.17) and use the chain rule to obtain
Vv = QT (Vvdx - Q^ = QT {VvQ - Q) = QT VvQ - QTQ: 
(3.29)
dy
Therefore, the velocity gradient tensor, rv, is not objective, as it fails to satisfy Eq. (3.28). 
Its skew-symmetric part, the spin tensor,
W = 1 [Vv - VvT]; 
(3.30)
is not objective either, given that (3.29) implies
W = 1 [Vv - VvT] = QTWQ - QTQ; 
(3.31)
where we used the identity
QTQ + QTQ = d (QTQ) = dI = 0: 
(3.32)
dt 
dt
Finally, the mean-spin tensor W(t° defined in Eq. (2.123) is not objective either because it 
transforms as
f=vohs Dd w dV=volD L [QTWQ - QTQ1 dV
= QTWQ - QTQ: 
(3.33)

70
Objectivity of Transport Barriers
In contrast, the symmetric part of rv, the rate-of-strain tensor
s = 2 [rv + rvT ] 
(3.34)
is objective because
S = 1 [r v + r vT ] = QTSQ; 
(3.35)
where we have again used the identity (3.32). As a consequence, the eigenvectors ei(x, t° and 
eigenvalues si (x, t° of S(x, t° are also objective, and hence satisfy
ei = QTei; 
Si = S i; i = 1; 2; 3: 
(3.36)
A smooth and smoothly oriented set of these orthonormal eigenvectors forms a coordinate 
frame fei (x, t°g3=1, the rate-of-strain eigenbasis, at each point x and time t. Along a fluid 
trajectory x(t°, this eigenbasis rotates in time, with its rotation characterized by the strain­
rotation-rate tensor
3
Ws (X; t ° = ei (X; t °
i=1
DT 
--- ei (X; t° ; 
Dt i ( °
(3.37)
so that DDtei (x(t°, t° = Ws (x(t°, t° ei (x(t°, t° holds for i = 1; 2; 3: Then, as observed by Drouot 
(1976); Drouot and Lucius (1976); Astarita (1979) and others, the relative spin tensor,
Wr = W - Ws;
is objective, given that
3
Wr = W - Ws = QTWQ - QTQ + g QTei
i=1
(3.38)
D (QTe- >
T
3
= QTWQ - QTQ + g QTei
QT e, + QT D e
= QTWQ + QT g ei [ D ei Q
Dt
i=1
= QTWrQ:
Here, we have used the transformation formulas (3.31) and (3.36). We also note that taking 
the y-gradient of Eq. (3.20) and using the chain rule gives that the vorticity gradient tensor 
r! is objective.
On a more general note, the Jacobian of any objective vector field a(x, t° is always objective. 
Indeed, taking the y-gradient of the transformation formula (3.15) and using the chain rule 
gives
r a = QTra dx = QTraQ: 
(3.39)
dy
As a consequence, both the symmetric and the skew-symmetric parts of ra are objective, 
which also implies the objectivity of the curl of a, i.e.,
r x a = QTr x a: 
(3.40)

3.3 Eulerian Objectivity
71
This last relationship follows from the relation between r a and the skew-symmetric part 
of ra, as discussed in Appendix A.12.1.
3.3.4 Galilean Invariance
Compared with objectivity, Galilean invariance is a weaker notion of frame-indifference 
under Galilean transformations of the form
x = Q0y + v0t; Q0TQ0 = I; Q0 2 R33; v0 2R3: 
(3.41)
These frame changes consist of a one-time initial rotation of the axes by Q0 and a parallel 
translation of the axes with a constant velocity v0, as shown in Fig. 3.4.
x
v0t
Figure 3.4 The geometry of the observer changes represented by the Galilean trans­
formations (3.41). These restricted Euclidean transformations consist of an initial, 
one-time rotation of the coordinate axes, followed by a translation of those rotated 
axes at a constant velocity v0 .
Galilean transformations do not introduce any inertial forces and hence transform inertial 
frames to inertial frames. In particular, the Navier-Stokes equation (2.67) (as any mechanical 
equation of motion) remains unchanged under coordinate changes of the form (3.41).
An Eulerian scalar, vector or tensor is said to be Galilean invariant if under all frame 
changes of the form (3.41) it transforms according to the rules (3.7), (3.15) and (3.28), 
respectively, but with the substitution
Q( t ° = Q0; 
b(t ° = V01 :
Galilean-invariant but nonobjective Eulerian quantities, such as the velocity gradient rv 
and the spin tensor W, do not conform to the principle of material frame-indifference that 
we have laid down as a minimal requirement for self-consistent descriptions of transport 
barriers.

72 
Objectivity of Transport Barriers
3.4 Lagrangian Objectivity
We now discuss the notion of objectivity for the Lagrangian quantities defined in §2.2.15, 
following the formulation of Ogden (1984). The idea is to again identify quantities that 
are indifferent to observer changes of the form (3.5) and hence provide self-consistent 
descriptions of material deformation. This time, however, the relevant locations and times 
in the indifference requirement are the initial (Lagrangian) positions and times, (x0, t0°, as 
opposed to the current (Eulerian) locations and times, (x, t).
3.4.1 Objectivity of Lagrangian Scalar Fields
A Lagrangian scalar field a(x0, t0; t° is objective if it remains invariant under the observer 
change (3.5). Specifically, the transformed scalar field, a(y0,10; t), in the y-frame must satisfy
a(y0,10; t) = a(x0,10; t) 
(3.42)
for all y0 and x0 related through the observer change (3.5).
Consider, for instance, the absolute dispersion da , a Lagrangian scalar field defined as 
da(x0,10; t) = |Ft0(x0° — x0|,
which measures the distance of particles from their initial positions. Under the observer 
change (3.5), da(x0, t0; t° becomes
da(y0,10; t) = 1 Ft0(y0) - y0 | = 1 QT(t) [Ft0(x0° - b(t)] - QT(10) »x0 - b(10)] 1 , da(x0,10; t),
and hence the absolute dispersion is not objective.
A different interpretation of the absolute dispersion measures the distance of the particle 
from the currently observed position, xt0 , of its release location, expressed as
Sa(x0,10; t) = | Ft0(x0) — x0 |: 
(3.43)
If the release location does not move in the current frame, then we have xt0 x0 for all times t. 
Even in that case, however, the currently observed release location will be the moving point 
y0 = QT(t) [x0 - b(t)] in the y-frame defined by the observer change (3.5). As a consequence, 
we have
Sa(y0; 10; t) = | F0((y0) - y0 | = | QT(t) [Ft^(x0) - b(t)] - QT(t) [x0 - b(t)]| 
= | QT(t) K(x0) - x0]| = | F0(x0) - x0 |
= Sa(x0,t0; t),
and hence the modified absolute dispersion (3.43) is objective. This implies that Taylor’s 
absolute diffusivity coefficient for tracer dispersion relative to the equator is an objective 
quantity (see Abernathey and Haller, 2018) as long as the observer measures the distance of 
the currently observed tracer position from the currently observed position of the equator in 
their frame.
The relative dispersion dr, defined as
dr(x0; 10; t; S) = max | Ft0(x0) - Ft0(x0) |,
jx>-X0 j=6

3.4 Lagrangian Objectivity
73
is objective because
dr(yo; t0; t,8) = max |Fto(yo) - Fto(yo)| 
jyo-yo |=<5
= 
max 
|QT(t° [Fto(x,) - b(t)] - QT(t° [F^(xo° - b(t)] |
|QT(t)(xo-Xo)|=5 
o
= max . I QT(t° [Fto(xo° - Fto(xo°]| 
jxo-xo j=o
= dr (Xo; to; t ,8).
Finally, eigenvalues of objective Lagrangian tensors are also objective, as we will discuss 
in §3.4.3.
3.4.2 Objectivity of Lagrangian Vector Fields
Adapting the Eulerian notion of objectivity from §3.3.2 to our current context, we call a 
Lagrangian vector field a(xo; to; t° objective if it transforms under the observer change (3.5) 
as
a (yo; to; t ° = QT( to°a(xo; to; t). 
(3.44)
A fundamental quantity arising in such observer changes is the transformed deformation 
gradient
dx
r F to (yo ° = QT( t )VFt> (Xo° -° = QT (t °VFto (xo°Q( to), 
(3.45)
o 
o 
dyo 
o
which follows from the differentiation of the frame change formula (3.5) with respect to yo 
using the chain rule. Using formula (3.45) together with the velocity transformation formula
(3.17), we see that the pullback velocity field defined in Eq. (2.88) is not objective because
[Fto ] * v (yo; to; t ° = [r F to (yo°] "1v (F to (yo°; t)
= [QT(t°VFto(xo°Q(to°] "1 QT(t° [v (Fto(xo°; t) - Q(t°y - b(t°]
= QT(to°v*(xo; to; t°
+ QT(to° [VFto(xo)] "1 [Q(t°QT(t° (Fto(xo° - b(t°) - b(t°] .
The same conclusion holds for the pullback vorticity field Ftto * ! by a similar argument. 
In contrast, the eigenvector field of any objective Lagrangian tensor (to be defined in §3.4.3 
below) is an objective Lagrangian vector field.
3.4.3 Objectivity of Lagrangian Tensor Fields
Again, adapting the Eulerian notion of objectivity from §3.3.3 to our current context, we call 
a Lagrangian tensor field A(xo; to; t° objective if it transforms pointwise under the observer 
change (3.5) as
A (yo;to; t° = Q (to°A(xo;to; t°Q(to°. 
(3.46)

74
Objectivity of Transport Barriers
For instance, using the formula (3.45), we conclude that the right Cauchy-Green strain 
tensor defined inEq. (2.90)is objective because
C to (y) = [r F to ] T r F to = [QT( t °rFto (X0°Q( t0°] T QT( t )rFt> (x0°Q( t0°
= QT( to°Cto (xo°Q( t0°: 
(3.47)
Since t was arbitrary in this argument, the objectivity of Ctt0 (x0° computed for the backward­
time flow map also follows. Similarly, the left Cauchy-Green tensor, which we have found 
to be a Lagrangian tensor under the backward-time flow map Ftt0(xt°; is objective because
Bt0 (yt) = rFt0(yt) [rFt0(yt)]T = QT(t°rFtto(x0°Q(10°QT(10° [r;(M]T Q(t°
= QT(t°Btt0 (xt° Q(t°: 
(3.48)
This relationship also shows the objectivity of Btt0 when it is viewed as an Eulerian tensor 
(see formula (2.93)).
As in the case of objective Eulerian tensors, the eigenvalues and eigenvectors of an 
objective Lagrangian tensor are also objective. This follows from the observation that rep­
resentations of these tensors in different frames are similar matrices by the definition of 
objectivity inEq. (3.46) for Lagrangian tensors. Consequently, by the properties of similar 
matrices, the eigenvalues and eigenvectors of the Cauchy-Green tensors Ctt and Btt0 are 
objective.
3.5 Eulerian-Lagrangian Objectivity of Two-Point Tensors
A two-point tensor A(x0; t0; x;t° is a linear mapping family from the tangent spaces Tx0 Rn 
at initial particle positions x0 into the tangent spaces TxRn at the current particle positions 
x = Ftt0 (x0° at time t. As mentioned in §2.2.3, a prime example of a two-point tensor is the 
deformation gradient rFtt0 (x0°.
As A(x0; t0; x; t° involves both the initial and current configurations, it is neither an Eulerian 
nor a Lagrangian tensor. Still, its objectivity can be defined based on the same principles that 
we used for Eulerian and Lagrangian tensor fields. Namely, a frame-indifferent A should map 
all frame-indifferent Lagrangian vector fields into frame-indifferent Eulerian vector fields.
Specifically, ifa is an objective Lagrangian vector field, then the Eulerian vector field Aa 
is objective if
A a = Qt( t )Aa = QT (t )AQ( 10°a 
(3.49)
where we have used the Eulerian and Lagrangian transformation formulas for objective vector 
fields from Eqs. (3.15) and (3.44), respectively.
Since a is arbitrary in Eq. (3.49), we call a two-point tensor A(x0; t0; x; t° objective if it 
transforms under the frame change (3.45) as
Ae = QT(t°AQ(t0°: 
(3.50)
A comparison of formula (3.50) with the transformation formula (3.45) for the defor­
mation gradient shows that rFtt0 is an objective two-point tensor. We note that rFtt0 has 

3.5 Eulerian-Lagrangian Objectivity of Two-Point Tensors
75
sometimes been incorrectly labelled as nonobjective in the literature, resulting from an 
erroneous application of the definition (3.28) of objective Lagrangian tensors to rFtt0 .
In contrast to Eulerian and Lagrangian tensors, however, the objectivity formula (3.50) of 
a two-point tensor does not make A and Ae similar matrices. As a consequence, objectivity 
does not follow for the eigenvalues or eigenvectors of A . More importantly, an eigenvalue 
problem for A: Tx0Rn ! TF(xO°Rn, which is a mapping between two different linear spaces, 
is not even defined unless x = x0 (in which case A becomes a Lagrangian tensor). Ignoring 
this issue, one could still formally compute eigenvalues and eigenvectors for any matrix 
representation of the linear mapping A (see, e.g., Pierrehumbert and Yang, 1993;Yagasaki, 
2008; Mlezic et al, 2010; Budisic et al, 2016). These formally computed quantities, however, 
depend on the choice of bases in the domain and range of A and hence are no longer 
invariants of A, as noted by Karrasch (2015); Hadjighasem et al. (2017).
Nearly all other classic tensor invariants are also ill defined for two-point tensors. This 
means that they can formally be computed for any matrix representation of A but they will 
depend on the choice of the bases and hence then have no intrinsic meaning for the linear 
operator A. For instance, the trace of a two-point tensor is not an invariant of the tensor. 
Indeed, an observer change (3.45) gives
tr A = tr [Qt(t°AQ(to)] = tr [Q(tq)Qt(t)A] , tr A; 
(3.51)
given that Q(tO°QT(t° is generally not the identity matrix (as it would be for Eulerian and 
Lagrangian tensors).
An exception to this rule is the determinant A , which can still be defined in a coordinate- 
free fashion as the measure of volume change associated with the action of A between two 
different Euclidean spaces. This is only possible because the standard volume in an Euclidean 
space is independent of the choice of coordinates. As a consequence, the determinant is an 
invariant for a two-point tensor, transforming as
det A = det QT(t° det A det Q(to° = det A 
(3.52)
by formula (3.50), given that Q(t° is a proper orthogonal matrix.
3.5.1 Objectivity of the Decompositions of the Deformation Gradient
Here, we examine the objectivity of the three decompositions of the deformation gradient 
rFtt0 that we discussed in §2.3. First, for the singular value decomposition (SVD), we use 
the frame change formula (3.45) and the definition of the SVD to write
rFto = qt(t°Ptost, [Qto]T Q(to°
= (Qt(t°Pto) sto (QT(to°Qto)T : 
(3.53)
Since the singular values of VFto; as eigenvalues of the left and right Cauchy-Green strain 
tensor, are the same in any frame, we obtain that the diagonal matrix stto of these singular 
values must remain the same under any observer change. The uniqueness of the SVD, along 
with Eq. (3.53), then implies the transformation formulas
s to = sto; P to = QT( t °Pto; Q to = QT( tO°Qto:

76
Objectivity of Transport Barriers
Consequently, none of the three Lagrangian tensors, tt0 , Ptt0 and Qtt0 , are objective because 
they do not transform as required inEq. (3.46).
Yet the diagonal elements of tt0 are individually objective as Lagrangian scalars; the 
columns of Ptt0 i:e:; the left singular vectors of rFtt0 are individually objective as Eulerian 
vectors based at the time-t configuration and the columns of Qtt0 i:e:; the right singular 
vectors of rFtt0 are individually objective as Lagrangian vectors based at the time-t0 con­
figuration. Given the defining formulas (2.108) for the SVD, all this is consistent with the 
objectivity of the eigenvalues and eigenvectors of the left and right Cauchy-Green strain 
tensors, which we have already shown.
To examine the objectivity of the polar decomposition discussed in §2.3.2,we use the left 
and right polar decompositions of rF,o(xo° to rewrite the transformed deformation gradient 
rFtt0 in two different ways:
r F to = QT( t °Rto Uto Q( 10°
= QT( t °Rto Q( to °QT( tO°Uto Q( 10°;
r F to = QT( t °Vto Ro Q( to°
= QT(t°VttoQ(t°QT(t°RttoQ(to°: 
(3.54)
Since QT(t°Rtt Q(to° is proper orthogonal, and QT(to°Utt Q(to° and QT(t°Vtt Q(t° are symmet­
ric and positive definite, the uniqueness of the polar decomposition (2.110) and Eq. (3.54) 
imply that we must have
R to = QT( t °Rto Q( to°; 
U to = QT( to°Uto Q( to°; V to = QT( t °Vto Q( t °. 
(3.55)
We therefore conclude that the polar rotation tensor Rtto is an objective two-point tensor, the 
right stretch tensor Utto is an objective Lagrangian tensor and the left stretch tensor Vtto is an 
objective Eulerian tensor.
To verify the objectivity of the dynamic polar decomposition introduced in §2.3.3, we 
follow the same procedure as for the classic polar decomposition above to obtain (see Haller, 
2016)
O to = QT( t °Oto Q( to°; 
M to = QT( to°Mto Q( toN to = QT( t °Nto Q( t °.
We, therefore, conclude that the dynamic rotation tensor Ott is an objective two-point tensor, 
the right dynamic stretch tensor Mtto is an objective Lagrangian tensor and left dynamic 
stretch tensor Ntto is an objective Eulerian tensor.4
Finally, the relative-mean decomposition (2.129) of the dynamic rotation tensor 
transforms as
Ot = t t : 
to to to
Haller (2016) shows that the relative rotation tensor tt is objective in two dimensions but not 
in three dimensions. The mean rotation tensor tto is not objective in any dimension. However, 
the rotation angle generated by tto about its axis of rotation (i.e., about its eigenvector 
corresponding to the eigenvalue 1) turns out to be objective (see Haller, 2016). We will take
4 Haller (2016) states inaccurately that Otto and Mtto are not objective. This inaccuracy stems from an indiscriminate 
application of the notion of Eulerian objectivity to Lagrangian tensors and two-point tensors, originating from 
the seminal works of Truesdell (1992) and Truesdell and Rajagopal (1999).

3.7 Some Nonobjective Approaches to Transport Barriers 
77
advantage of this in later chapters in the development ofan objective diagnostic for rotational 
coherence.
3.6 Quasi-Objectivity
In practice, numerical or experimental flow data may be available in the form of an ob­
jective scalar field, such as the pressure, images of material distribution or remote-sensed 
concentration fields of passive scalars. Often, however, the data is available in the form of a 
nonobjective quantity, such as the velocity field of a fluid. In the absence of other information 
about the flow, one may ask if, at least in certain frames, a nonobjective quantity could still 
provide reliable information relevant for (the inherently objective) material transport.
Motivated by this question, Haller et al. (2021) call an Eulerian or Lagrangian quantity 
quasi-objective under a condition (A) if that quantity approximates the same objective 
Eulerian or Lagrangian quantity in any frame in which condition (A) is satisfied. Note that a 
quasi-objective quantity will generally not approximate an objective quantity in all frames, 
given that condition (A) is generally frame dependent.
As an example the Q(x; t° scalar field, to be defined in Eq. (3.56), is a nonobjective quantity. 
As a consequence, we will find in §3.7.1 that Q(x; t° yields false positives and negatives when 
used in procedures seeking to identify coherent vortices. At the same time, in any inertial 
frame, a constant multiple of the field Q(x; t° happens to be equal to the leading-order term 
in the divergence r vin of a reduced vector field governing the motion of small but still 
finite-size particles (see §7.3 for details). This coincidence of Q with r vin in qualifying 
frames does not justify the use of Q in coherent structure detection, as we will see from 
the counterexamples to that effect in §3.7.1.But the quasi-objectivity of Q enables one to 
reliably calculate the leading-order compressibility of finite-size particle motion from Q as 
long as the only external force in the equations of motion for the particle is the gravity, i.e., 
the frame is inertial. We will discuss further examples of quasi-objective Lagrangian scalar 
fields in §5.5.
3.7 Some Nonobjective Approaches to Transport Barriers
Here, we briefly summarize a few approaches to transport barriers that are not objective 
and hence will not be discussed in more detail in the following chapters. Several of the 
approaches we mention below seek coherent flow regions, and hence, by implication, the 
boundaries of these regions are expected to be barriers to advective transport. Some of 
these nonobjective criteria are heuristic yet broadly used due to their simplicity. Others 
are mathematically rigorous sufficient criteria that are nevertheless underutilized because 
of their complexity. While heuristic criteria may return both false positives and negatives, 
mathematically justified sufficient criteria return correct results if their assumptions hold in 
a given frame. They, however, become inapplicable in frames in which their assumptions are 
not satisfied.
We will also show how most nonobjective criteria for transport barriers fail on the 2D, 
unsteady Navier-Stokes solutions shown in Figs. 2.23 and 2.24, for which the exact material 
flow geometry is known. These clear failures of nonobjective criteria on the simplest examples 

78
Objectivity of Transport Barriers
with known ground truth cast doubt on the physical relevance and experimental observability 
of the intriguing coherent structure boundaries often seen in the numerical flow visualization 
literature - obtained from the same criteria on complex flows without a known ground truth 
for transport barriers.
3.7.1 Nonobjective Eulerian Principles
Here, we survey the most frequently used nonobjective Eulerian structure-extraction criteria, 
which are often discussed under the subject of vortex identification. Further such criteria can 
be found in Cucitore et al. (1999); Kolar (2007); Epps (2017); Gunther and Theisel (2018).
Streamline-Based Criteria
Instantaneous streamlines in unsteady flows are often used to infer material transport or lack 
thereof. For instance, a closed family of instantaneous streamlines, such as the one shown on 
the left inFig. 2.23, is often seen as an indicator of vortical motion. Similarly, streamlines 
revealing a saddle-type (or hyperbolic) instantaneous stagnation point, such as the one on the 
left in Fig. 2.24, is routinely taken to be the sign of material stretching and compression, as 
well as transport of material along the unstable direction of such a stagnation point.
These conclusions, however, are relative to one time instant and one observer. The velocity 
transformation formula (3.17) shows how both the length and the orientation of the velocity 
field change in a spatially and temporally inhomogeneous fashion under a change of the 
observer. This change can fundamentally alter streamline geometry in different frames, 
thus streamline topology is a nonobjective (and hence unreliable) diagnostic for material 
behavior.5 This is well illustrated by a comparison of instantaneous streamlines with the 
stroboscopic plots of actual material evolution in the right subplots of Figs. 2.23 and 2.24. A 
further example showing the inadequacy of hyperbolic stagnation points in forecasting even 
short-term material behavior can be seen in Fig. 5.66 of §5.7.4, where we will discuss an 
objective Eulerian alternative to stagnation points.
5 The only exceptions are steady flows (or at least directionally steady flows; see §2.2.8) in which streamlines 
coincide with material trajectories.
Instantaneous streamline-based criteria for transport barriers are routinely employed in 
geophysical flows to identify boundaries of mesoscales addies from available satellite altime­
try data (see, e.g., Chelton et al., 2011a,b). This approach is motivated by the assumption 
of geostrophic balance under which the sea-surface height (SSH) acts as a stream function 
for the 2D ocean surface velocity field. Closed instantaneous SSH contours are then often 
viewed as indicators of eddies (mesoscale vortices) in then ocean. The size of such eddies 
is in the order of 100-200 km, and hence if they were approximately material, as is often 
believed, then water transport associated with them would be significant.
The nonlinear eddy criterion of Chelton et al. (2011a) postulates that if a nested set of 
closed SSH contours rotates faster than it propagates, then it will remain coherent, i.e., 
carry water with minimal dispersion through its nonfilamenting boundaries. This princi­
ple is nonobjective because of its reliance on streamlines and velocities. Indeed, detailed 
global transport studies using objective, Lagrangian eddy-detection methods (Abernathey 
and Haller, 2018; Liu, T. et al., 2019; Zhang, W. et al., 2020) suggest that the nonlinear eddy

3.7 Some Nonobjective Approaches to Transport Barriers
79
criterion and its variant in Chelton et al. (2011b) overestimate material transport by coherent 
eddies by up to an order of magnitude (see §§5.2.11and5.4).
Velocity- and Vorticity-Magnitude Criteria
Level surfaces of the components or the normed components of the velocity and the vorticity 
are also frequently used as structure visualization tools. The unspoken assumption is that 
these level surfaces reflect overall material behavior in the flow.
We saw in §3.3 that the coordinate components and the norm of the velocity and vorticity 
fields are nonobjective. It could still be the case, however, that the topology of the level 
surfaces remains unchanged, even if the values of these scalars change from one frame to the 
other. This is indeed the case for the vorticity and its norm in 2D flows, as we pointed out 
in our discussion after formula (3.21). The same conclusion, however, does not hold for the 
velocity field in two dimensions. In three dimensions, the velocity norm, vorticity norm and 
individual coordinates of the velocity and vorticity are all nonobjective and hence their level 
surface topology will also depend on the observer.
These statements are simple to illustrate on the unsteady Navier-Stokes solution (2.133) 
with the parameter values used in Fig. 2.23. First, vorticity is constant in this example and 
hence its level-curve geometry clearly fails to signal any flow structure. Second, representative 
contours of the norms of the horizontal, vertical and full velocities for this example give three 
fundamentally different predictions (jet, saddle-type stagnation point and vortex) for the same 
flow near the origin, as shown in Fig. 3.5. The figure also shows the same inconsistency 
for contours of the vertical velocity (the contours of the horizontal velocity are similarly 
misleading). These discrepancies are unrelated to the unsteadiness of the flow. Indeed, if we 
considered a steady flow with the instantaneous streamline geometry shown in the bottom left 
subplot of Fig. 3.5, the velocity norm and component contours shown in the other subplots 
would remain the same and would still give fundamentally inaccurate characterizations of 
the true steady flow geometry.
Even the saddle-type prediction in Fig. 3.5 (which coincidentally matches qualitatively 
the true Lagrangian flow geometry) is inaccurate: it incorrectly suggests a saddle point away 
from the origin, with its stable and unstable manifolds misoriented relative to their actual 
counterparts shown in Fig. 2.23. Similarly incorrect and conflicting conclusions arise from 
plots of velocity contours for the Navier-Stokes solution (2.133) with the parameter values 
used in Fig. 2.24, as shown in Fig. 3.6.
Even the instantaneous streamline geometry is missed by these approaches and hence they 
would already fail on a steady version of the same flow.
This demonstrated inability of velocity component level surfaces to characterize flow 
structures correctly even in 2D steady flows also casts doubt on 3D visualizations of unsteady 
flows using the same approach (see, e.g., Fig. 1.11). Such visualizations can certainly be used 
to compare velocity footprints of different coherent states with each other in a given frame, 
but their relevance for experimentally observable features of such coherent states is unclear.
The Q-Criterion and the Okubo-Weiss Criterion
Coherent vortices are often envisioned as long-lived elliptical regions bounded by closed 
barriers to (either advective or diffusive) transport. Perhaps the most broadly used criterion 
for such vortices is the Q-criterion of Hunt et al. (1988). The same principle in 2D flows is

80
Objectivity of Transport Barriers
Stable and unstable manifolds added
Figure 3.5 Failure of various velocity contours at time t = 0 to correctly depict 
either the instantaneous Eulerian streamline geometry or the Lagrangian trajectory 
geometry for the Navier-Stokes flow shown in Fig. 2.23.

3.7 Some Nonobjective Approaches to Transport Barriers
81
Figure 3.6 Failure of various velocity contours at time t = 0 to correctly depict either 
the instantaneous Eulerian streamline geometry or the Lagrangian trajectory geometry 
for the Navier-Stokes flow shown in Fig. 2.24. As in Fig. 3.5, the contours misrepresent 
even the instantaneous streamline geometry and hence would also mischaracterize a 
steady flow with the same streamlines.

82
Objectivity of Transport Barriers
known as the Okubo-Weiss criterion (Okubo, 1970; Weiss, 1991). To state the Q-criterion, 
we define the instantaneous scalar field
Q(X;t° = 1 h ||W||2 -||S||2i; 
(3.56)
with the Euclidean matrix norm of a tensor A defined as ||A|| = tr (ATA° and with the 
spin tensor W and the rate-of-strain tensor S defined as in Eq. (2.1).The Q-field, therefore, 
measures the pointwise, instantaneous difference between the strengths of the vorticity and 
the rate of strain. For incompressible flows, Q coincides with the second scalar invariant of 
the velocity gradient tensor rv, as one sees from the characteristic equation (2.14).Note 
that Q(X; t° is not an objective scalar field because ||W||2 depends on the observer whereas 
| S| 2 is independent of the observer (see §3.3).
As we discussed earlier, rv has to be slowly varying along a trajectory for its eigenvalues 
to have relevance for the stability of that trajectory (see §2.2.9). The only situation in which 
this is guaranteed to hold is when the trajectory is the fixed point (or stagnation point) of a 
steady flow, as we noted in §2.2.11. Despite these conceptual limitations, Hunt et al. (1988) 
consider the eigenvalues of rv to be generally relevant to identify regions of qualitatively 
similar particle behavior in turbulence.
More specifically, Hunt et al. (1988) postulate that vortical (or elliptic) regions are domains 
where Q is larger than a heuristically selected small, positive threshold value.6 Similarly, 
they postulate that in convergent (hyperbolic) regions, Q should remain below a heuristic 
small, negative threshold value. Finally, for streaming (jet-type) regions, Hunt et al. (1988) 
contend that jQj must remain below a small heuristic positive threshold, and jvj2 must 
exceed a positive threshold. They call the latter regions the “main highways for fluid particle 
transport.” Notably, the motivations and illustrations of Hunt et al. (1988) are fully based on 
expected material trajectory behavior in the three types of Eulerian regions they introduce. 
Their reasoning, however, is only supported mathematically near fixed points of steady flows 
where the eigenvalues of rv do indeed govern the local geometry of trajectories.
For a 2D incompressible velocity field rv(x t° = (u(x,y, t°, v(x, y, t)), formula (3.56) 
gives
Q = 2 h IIWII2 -||S|I2i = - (u2 + uyVx)
= det rv: 
(3.57)
A comparison of Eq. (3.57) with the characteristic equation (2.9) of rv shows the relationship 
between the eigenvalues of the 2D incompressible velocity gradient and the Q function to be
A1;2(X; t ° = ±p-Q (X; t ° : 
(3.58)
Okubo (1970) proposes to infer the local trajectory shape of “floatable particles” near 
instantaneous stagnation points from the eigenvalues in Eq. (3.58) using the Q(X; t° parameter. 
More broadly, Weiss (1991) argues for the importance of these eigenvalues and defines elliptic 
(Q(X; t° > 0) and hyperbolic (Q(X; t° < 0) regions in the flow globally (without Okubo’s
6 Hunt et al. (1988) also require a pressure minimum inside vortical regions, although this requirement is generally 
omitted in applications of the Q-criterion.

3.7 Some Nonobjective Approaches to Transport Barriers
83
restriction to vicinities of stagnation points) based on enstrophy transfer considerations for 
the planar, inviscid vorticity transport equation. The underlying assumption is that the velocity 
gradient tensor rv varies slowly along fluid trajectories and hence the properties of solutions 
near a trajectory x(t; 10; x0° can be inferred from the eigenvalues of rv (x(t; 10; x0); t). By our 
discussion at the end of §2.2.8on the stability properties of the equation of variations (2.45), 
such an assertion is generally unjustified even for steady flows away from their stagnation 
points. Indeed, Basdevant and Philopovitch (1994) argue that the assumed slow variation 
can only be expected in turbulence close to stagnation points (i.e., only in Okubo’s original 
context).
As we have seen, however, in the examples of §2.4 (see Figs. 2.23-2.24), the Okubo-Weiss 
criterion may well fail at stagnation points as well if the flow is unsteady, given that rv can 
have non-slow time dependence at such points, too. Hua and Klein (1998); Hua et al. (1998) 
add higher-order terms tor the linearized analysis of Okubo and Weiss, but the issues we 
have identified for the criterion remain in these extensions as well.
Tabor and Klapper (1994) and Martins et al. (2016) propose a modified version of the 
Okubo-Weiss criterion that uses the scalar field
Q r (X; t ° = 2 h ||Wr ||2 -||S| |2 ];
(3.59)
with the relative spin tensor Wr defined inEq. (3.38) (but see §3.7.2 for problems with 
this idea). For 2D flows, Lapeyre et al. (1999, 2001) also obtain the modified Okubo-Weiss 
parameter Qr (x; t° and use it to identify qualitatively different mixing regions in turbulence. 
These calculations are objective but still rely on a heuristic slow-variation assumption. 
From different considerations, Haller (2001b) also obtains Qr(x; t°, and derives an objective 
partition of 2D turbulence into finite-time hyperbolic, elliptic and parabolic material behavior 
(see §5.6).
As a parallel development, it has become common practice to modify the original Q- 
criterion by simply plotting heuristically chosen level sets of the scalar function Q(x; t° and 
viewing these sets as representations of transport barriers in the flow (see, e.g., Dubief and 
Delcayre, 2000;McMullan and Page, 2012;Jantzen et al., 2014;Gao et al., 2015;Anghan 
et al., 2019). Beyond the general mathematical issues mentioned above for the Q-criterion, 
the practice of plotting level sets of Q also lacks the original intuitive reasoning behind the 
Q-criterion. Indeed, it would be hard to argue why a set of points at which the difference of 
the squared vorticity and the squared rate-of-strain equals, say, seven would form a physically 
observable (and hence material) transport barrier. Indeed, for the Navier-Stokes flow shown 
in Figs. 2.23 and 3.6,the level curves of Q shown in Fig. 3.7 do not indicate transport barriers 
in any meaningful sense.
Finally, we note that in §7.3, the Q(x; t° field will reemerge as an important quantity in the 
study of inertial finite-size (or inertial) particle motion. In that context, a constant multiple of 
Q will be seen to determine the divergence of the first-order deviation of the velocity field of 
small inertial particles from the carrier fluid velocity field in an inertial frame. In noninertial 
frames, that divergence remains the same but no longer equals a constant multiple of Q due 
to the nonobjectivity of Q (see also our discussion on quasi-objectivity in §3.6).

84
Objectivity of Transport Barriers
Figure 3.7 Failure of the level sets of the Q parameter to correctly depict either the 
instantaneous Eulerian streamline geometry or the Lagrangian trajectory geometry 
for the Navier-Stokes flow shown in Figs. 2.23 and 3.6.
The -Criterion
Motivated by trajectory patterns near fixed points of steady flows, Chong et al. (1990) seek 
vortices in a 3D incompressible flow as domains where the velocity gradient rv(x; t° admits 
eigenvalues with nonzero imaginary parts. This is the case if 
Q3
A = ( 3j
2
d det Vv
\ 
2 
/
> 0;
(3.60)
with Q denoting the Q-parameter defined in Eq. (3.56),as one readily infers from Cardano’s 
formula applied to the characteristic equation (2.14) of the matrix rv. Criterion (3.60) is 
again based on the assumption that the stability of fluid trajectories can be predicted from 
the instantaneous eigenvalue configuration of the time-dependent coefficient matrix in the 
equations of variations (2.45), computed along those trajectories. As we have pointed out, this 
assertion is generally unjustified, except near stagnation points of steady flows (see §2.2.11). 
In addition, criterion (3.60) is not objective as one readily verifies with the transformation 
formulas we derived in §3.3.
The form (3.60) of the -criterion is strictly for 3D flows. In 2D flows, the two eigenvalues 
d = ±^J-Q of the velocity gradient Vv have nonzero imaginary parts precisely when Q > 0 
holds. For 2D flows, therefore, the -criterion (requiring the velocity gradient to have a pair 
of complex eigenvalues inside a vortex) coincides with the Q-criterion. Consequently, the 
performance of the -criterion on the two flows analyzed in Figs. 3.5-3.6 is identical to that 
of the Q-criterion.
The d2 -Criterion
Jeong and Hussain (1995) seek coherent vortices as the collection of points where the pressure 
has a local minimum in an appropriate 2D plane. Taking the symmetric part of the spatial 
gradient of the Navier-Stokes equation in Eq. (2.67), they obtain
D S + v AS + S2 + W2 = -1V2 P; 
(3.61)
Dt

3.7 Some Nonobjective Approaches to Transport Barriers
85
with r2p denoting the Hessian matrix of second derivatives of the pressure p. They then 
propose to neglect the first two terms on the left-hand side of Eq. (3.61) and seek locations 
where two of the three eigenvalues, 1 r2p 
2 r2p 
3 r2p , of r2p are positive.
By Eq. (3.61),such locations satisfy the condition
A2 (S2 + W2) < 0 
(3.62)
for the intermediate eigenvalue A2 (S2 + W2) of the symmetric tensor S2 + W2. Criterion 
(3.62) can also be made applicable to 2D incompressible Navier-Stokes flows by extending 
such flows to three dimensions (see formula (2.134)) and applying the criterion to the extended 
velocity field. Selecting the trivial solution w(x; y, t° = 0 of Eq. (2.134), we obtain from a 
direct calculation that the extended velocity field satisfies the 2 -criterion if
/ 2 
2)_ n2 
2 
2
A2 S + W = d 11 + d 12 - W12 = -Q < 0:
Therefore, for 2D flows, the 2 -criterion coincides with the Q-criterion for coherent vortices.
The criterion in formula (3.62) is appealingly simple to implement but the arguments 
leading to it are heuristic. First, it is unclear why D S+v AS should be negligible in turbulence. 
Second, for the pressure to have a local minimum in any plane, the pressure gradient would 
have to be orthogonal to that plane at the local minimum. Establishing this would require 
further analysis of the relationship between the eigenvectors corresponding to A1 (r2p) and 
A2 (r2p) and the pressure gradient rp.7 In addition, criterion (3.62) is not objective given 
that W2 is not objective.
Nevertheless, Jeong and Hussain (1995) is a significant contribution to formalizing the 
idea of a vortex. Indeed, this work raised awareness of the shortcomings of several prior 
vortex criteria, involved the governing equations in coherent vortex detection, and proposed 
at least Galilean invariance as a minimal requirement that a coherent vortex criterion must 
satisfy.
The ci-Criterion and the Rotation-Strength (Rortex) Criterion
The ci -criterion (or swirling strength criterion) is borne out of an effort to characterize 
the swirling, nondispersive behavior of material trajectories in a vortex. This behavior in 
experimentally observed coherent vortices is emphasized in early papers by Lugt (1979), 
Elhmaidi et al. (1993), and Cucitore et al. (1999). Building on the work of Zhou et al. 
(1999), Chakraborty et al. (2005) seek to infer local material swirling in the flow from the 
instantaneous eigenvalue configuration of the equation of variations (2.45). By the same 
heuristic reasoning leading to the A-criterion, local material swirling occurs at points where 
the coefficient matrix ofEq. (2.45) has a pair of complex eigenvalues cr ici and a real 
eigenvalue r . To ensure tight enough spiraling (orbital compactness), Chakraborty et al. 
(2005) require
Aci > e, 
AcrMci < 6 
(3.63)
to hold for some small thresholds ; > 0:
As we have already discussed in the context of the Q- and A-criterion, the eigenvalues of 
r(x(t), t° have no direct relationship to the stability of the £ = 0 solution of Eq. (2.45).
7 The criterion should actually require S2 + W2 to be positive definite on the plane orthogonal to rp . This would, 
however, eliminate the simplicity and purely kinematic nature of (3.62).

86
Objectivity of Transport Barriers
As an example, one may consider the velocity gradient of the Navier-Stokes flow (2.133) 
at x = 0, which has the time-independent, purely imaginary eigenvalues 21 ;2 = ±^/1 - a2. 
Therefore, for a = 2 and for all times, we have 2ci = V3 and 2cr^2ci = 0 in the yellow region 
of Fig. 2.23. Therefore, the criterion (3.63) is satisfied for any threshold e < V3 and 6 > 0.8 
This shows that the 2ci -criterion misclassifies the stretching and folding chaotic flow in Fig. 
2.23 as a vortex.
Similarly, the 2ci-criterion misses the material vortex described in Fig. 2.24, even though 
the original motivation for the criterion is to capture the type of swirling particle motion 
observed in this example. We recall that the examples depicted in Figs. 2.23 and 2.24 extend 
directly to 3D flows, and hence provide 3D false positives and false negatives for vortex 
detection by the 2ci -criterion. Even without constructing such examples, however, one can 
use the principle of objectivity to eliminate the 2ci-criterion as a self-consistent detection tool 
for experimentally observable (and hence material) coherent vortices. Indeed, the eigenvalues 
of the velocity gradient are not objective, which in turn renders the conditions in Eq. (3.63) 
observer dependent.
The rotation-strength (or rortex) criterion of Tian et al. (2018) also adopts the philosophy 
that vortical (swirling) motion can only take place in the fluid over domains where the velocity 
gradient rv has a pair of complex eigenvalues. The criterion proposes to characterize 
the strength of this swirling by the minimal off-diagonal element of all possible matrix 
representations of rv in orthonormal bases that contain the real eigenvector of rv. Due 
to its basic assumption on the eigenvalue configuration of rv, this rortex-criterion is also 
equivalent to the -criterion but uses a different scalar measure of the instantaneous rotation 
rate. As a consequence, when restricted to 2D flows (viewed as 3D flows with a symmetry), 
the rortex-criterion also misclassifies the chaotic flow in Fig. 2.23 as a vortex, despite its 
unbounded stretching and folding.
3.7.2 Objectivization of Nonobjective Eulerian Coherence Principles
The vortex criteria in §3.7.1 are nonobjective because they involve invariants of the velocity 
gradient rv that are nonobjective. The nonobjectivity of rv can be traced back to the 
nonobjectivity of W in its decomposition,
rv = S+W; 
(3.64)
into the sum of the rate-of-strain tensor S and the spin tensor W. Using earlier observations 
by Drouot and Lucius (1976) and Astarita (1979), Martins et al. (2016) point out that all 
classic vortex criteria can formally be made objective by replacing rv in their formulation 
with the relative velocity gradient tensor
rvr := S + Wr = rv - Ws; 
(3.65)
with the relative spin tensor Wr = W - Ws defined in Eq. (3.38) and the strain-rotation-rate 
tensor Ws defined in Eq. (3.37). Note that rvr is no longer the coefficient matrix of the 
equations of variations (2.45) and hence its invariants have an a priori unclear relationship
8 Conversely, if one a priori fixes > 0 in Eq. (3.63), then the ci -criterion will always be satisfied when the 
parameter a is large enough in norm.

3.7 Some Nonobjective Approaches to Transport Barriers
87
to the linearized flow along fluid trajectories. Therefore, even the heuristic considerations 
behind the vortex criteria in §3.7.1 become inapplicable to rvr .
To argue nevertheless for the use of rvr in flow-feature identification, Tabor and Klapper 
(1994), Astarita (1979) and Lapeyre et al. (1999) propose that the replacement of rv with 
rvr in these criteria simply amounts to evaluating these criteria in the eigenbasis of the 
rate-of-strain tensor S. Indeed, for any fixed spatial location x0 , Astarita (1979) puts forward 
an observer change of the form (3.5), defined with b(t° = 0 and with Q(t° solving the matrix 
differential equation
Q( t ° = Ws (x0; t °Q( t ). 
(3.66)
Then, using the transformation formula (3.29) for rv Q(t° solving with Eq. (3.66), we obtain 
the velocity gradient in the rate-of-strain basis as
rv = QTrvQ - QTQ = QTrvQ - QTWsQ = QTrvrQ:
Therefore, all invariants of rvr are seemingly equal to those of rv computed in strain basis. 
Consequently, applying any of the vortex criteria described in §§3.7.1-3.7.1 to rvr instead 
of rv seems equivalent to evaluating these criteria pointwise in the local rate-of-strain 
eigenbasis. This assertion, however, is inaccurate because Ws (x; t° depends explicitly on x, 
and hence the frame rotation Q defined in (3.66) also depends on x. Consequently, replacing 
rv with rvr cannot be justified by a single, well-defined, global observer change.
A proposed fix to this conundrum is the concept of a nonlinear observer change x, = g(x; t° 
considered by several authors (see, e.g., Gunther et al., 2017; Hadwiger et al., 2019; Gunther 
and Theisel, 2020; Rojo and Gunther 2020; Rautek et ah, 2021; Zhang, X. et aL 2022), 
which would allow for general time-dependent deformations of the coordinate frame, rather 
than oust rotations and translations, as in Eq. (3.5). Such a nonlinear observer change is 
defined locally, at each point x, by a space- and time-dependent linear observer change
dx, = G(X; t °dX; 
(3.67)
where G(x; t° is a nonsingular tensor field defining the observer change, expressed in the 
original global x coordinates. These local observer changes could be constructed from any 
principle that simplifies the velocity field locally (e.g., makes v locally as steady as possible, 
or changes coordinates locally to new ones aligned with the eigenvectors of S(x; t)). One 
could then apply classic vortex criteria to the velocity field after performing the nonlinear 
observer change defined by Eq. (3.67).
Nonlinear coordinate changes, however, are not physical frame changes: they would be 
equivalent toa spatiotemporal deformation in the perception of a human observer. Under such 
abstract observer changes, the physical principle of material frame-indifference can no longer 
be upheld. Indeed, a time-dependent nonlinear observer change may well yield expanding 
material distances in a new frame, even if those distances were constant or shrinking in the 
original frame. As a consequence, what appears to be a coherent material vortex in one frame 
may well appear as an exponentially stretching or shrinking material set in the other frame 
after a time-dependent, spatially nonlinear coordinate change. Therefore, the experimental 
verifiability of predictions by any such fictitious observer would no longer be guaranteed.
Physical relevance aside, any envisioned nonlinear observer change g(x, t° should still 
be mathematically well posed, i.e., well defined and smooth at each point of the physical 

88
Objectivity of Transport Barriers
domain for each time at which the velocity field is known. This well-posedness requirement 
for g(x, t° from Eq. (3.67) can be phrased as a set of local observer-compatibility conditions: 
the equations defining the local observers must have unique and smooth solutions. The 
smooth dependence of the solutions on space and time is a critical requirement because all 
local observers must be able to take derivatives of the velocity field observed in their frames. 
They must also come to the same conclusions about the presence of vortices as they approach 
each other in space and time.
Haller (2021) shows that beyond the requirement of continuous spatial and temporal 
differentiability for G and G“1, a sufficient and necessary observer-compatibility condition 
for G(x, t° on a simply connected domain U would be
rG=0: 
((.68)
Here, r G refers to the tensor whose rows are formed by the curls of the corresponding 
rows of G (see Appendix A.1( for the details of the proof). Condition ((.68) is necessary 
and sufficient for a nonlinear coordinate change x ! x*=g(x, t° to be well defined (up to a 
constant vector) and smooth on the domain U on which the tensor field G(x, t° is prescribed. 
Note that any x-independent choice, G(t°, automatically satisfies condition (3.68) and hence 
gives a well-posed global observer change.
If, in particular, one wishes to introduce global coordinates locally aligned with the 
orthonormal eigenbasis fei(x, t°g3=1 of the rate-of-strain tensor S(x, t°, then the local form 
((.67) of the nonlinear observer change is defined by
G(X; t° = »e1(X; t° e2(x, t° e3(X; t)]T : 
(3.69)
Therefore, in this case, the compatibility condition ((.68) requires all three normalized 
eigenvector fields of G(x, t° to be curl-free vector fields on U. In general, this will not be the 
case, and hence the pointwise replacement of rv by rvr cannot be justified as a nonlinear 
observer change.
As illustration, consider the simple steady, incompressible velocity field
v(x° = (y + x2 - y2, -x - 2xy,0°; 
(3.70)
a steady member of the unsteady polynomial Navier-Stokes velocity fields described by 
Pedergnana et al. (2020). For this flow, the matrix of orthonormal rate-of-strain eigenvectors, 
as defined in Eq. (3.69), is of the form
/ 
g(x;t° = ---
0
x-^x2+y2
p2 -^x2-x px2+y2+y2 
x+px2+y2
p2ylx2+x px2+y2+y2
1
0 ®®
0 ®®
/
(3.71)
representing a continuously differentiable rotation tensor field with a continuously dif­
ferentiable inverse on all simply connected, open neighborhoods U away from the plane

3.7 Some Nonobjective Approaches to Transport Barriers
89
x 2 R3 : y = 0 . For this tensor field, we obtain
9 In a follow-up paper, Theisel et al. (2021) still argue for the objectivity of their proposed nonlinear frame change. 
Like Haller (2021), they use an optimized nonlinear transformation g(x, t) to map the velocity field v(x, t) to its 
minimally unsteady version,
v,(x,, t) = @xg (g 1(x,; t); t\ v(g 1(x,; t), t) + @g(g 1(x,; t); t),
defined in an optimized coordinate frame X, = g(x, t). They, however, erroneously use the pullback of V, under 
g (x, t), rather than the inverse of the relation of (y), to recover v(x, t) from V ,(x,, t). Recall that velocity fields are 
nonobjective precisely because they do not transform back and forth under the pushforward and pullback of the 
frame change, as seen already for linear frame changes in Eq. (3.17). When correctly inverted, the relationship 
(y) yields that v,(x,, t) and g(x, t) are nonobjective, as claimed by Haller (2021).
1
p2y (3 x2-3 x px2 +y2 +y2\
p I p 
\3
4 yx2+y2 (x2-x ^x2+y2+y2j
p2 y (3 x2 +3 x px2+y2 +y2\
----1— V
4 x2 +y2 x2+x x2+y2+y2
0
0
r G(x; t) =
-- 0
0
-- 0
0
\
®® , 0:
/
(3.72)
Therefore, the observer-compatibility condition (3.68) is violated and hence no compatible 
generalized frame-change to the rate-of-strain eigenbasis exists for the velocity field (3.70) 
on simply connected open sets not intersecting the fy = 0g plane.
In contrast, the velocity field v(x) = (0; x2,0° has rate-of-strain eigenvectors ei that are 
independent of x. Consequently, for this velocity field, we have rG 0, and hence a global 
observer change to the eigenbasis of S(x; t° is possible. For this velocity field, therefore, the 
use of rvr instead of rv in the criteria of §3.7.1, as proposed by Martins et al. (2016), is 
justifiable.
Other proposals for objectivizing vortex criteria via nonlinear coordinate changes include 
those of Gunther et al. (2017), Gunther and Theisel (2020) and Rojo and Gunther (2020), 
who seek to construct transformations that locally minimize the unsteadiness of the velocity 
field. Various issues with this approach, including its nonobjectivity, are discussed in detail 
by Haller (2021).9 The relative velocities put forward by Hadwiger et al. (2019); Rautek 
et al. (2021) and Zhang, X. et al. (2022) may, in principle, be objective but this is not 
established by these authors. Indeed, they a priori assume that a special observer velocity 
u(x; t° obtained from v(x; t° via an implicit, nonlinear optimization procedure transforms 
precisely as a velocity field does between frames. This assumption is correct if u(x; t° is a 
unique global minimum of the optimization principle proposed by Zhang, X. et al. (2022), 
which remains to be proven.
Yet another way to objectivize vortex criteria utilizes the mean-spin tensor (2.123), first 
introduced by Haller (2016); Haller et al. (2016) in the construction of the dynamic polar 
decomposition and an associated objective vortex definition (see §2.3.3). Specifically, re­
stricting the analysis of the flow to some material flow domain D(t°, Liu, J. et al. (2019b) 
propose replacing the velocity gradient with the modified velocity gradient tensor
_ _  —
W := rv - AW;
(3.73)
(y)

90
Objectivity of Transport Barriers
where the mean-spin tensor W(t° is defined in Eq. (2.123). By hie tanssOormation formulas 
(3.31), (3.33) and (3.35), we obtain that rv is objective. In addition, if the rotation matrix 
Q(t° ts defined as a fundamental matrix solution of the linear system of ODEs,
Q = W ( t °Q ;
then under the specific frame change x = Q(t)y, by the transformation formula (3.29), the 
velocity gradient rv becomes
V v = QTVvQ - <QT<Q = QT VvQ - QTW Q = QTVv*Q = Vg*: 
(3.74)
Therefore, an observer in the coordinate frame defined by y = QT(t°x will find the velocity 
gradient Vv to coincide exactly with the objective tensor Vv* at all spatial locations. The 
observer-compatibility condition (3.68) is automatically satisfied for this observer change, as 
G(X; t° := Q(t° has no spatial dependence. Consequently, applying Eulerian vortex criteria 
based on the objectivized velocity gradient Vv* is equivalent to applying these criteria to 
Vv in a special frame of reference.
Liu, J. et al. (2019b) use this objectivization approach to introduce an objective version 
of the rortex criterion of Tian et al. (2018) (see §3.7.1), while Liu, J. et al. (2019a) employ 
the same approach to make another vortex criterion objective. While these principles are 
now indeed objective, they are still based on an unspecified slow-variation assumption on 
the equation of variations, as we have already noted for the Q-criterion.
A more recent objectivization approach is proposed by Kaszas et al. (2021), who explicitly 
identify the closest rigid-body velocity for a general fluid flow over a bounded domain. As 
we already mentioned in §3.3.2, passing to a frame co-moving with this rigid-body velocity 
field yields an objective deformation velocity field that can be used to objectivize a variety of 
scalar and vector fields associated with the fluid. This objectivization procedure amounts to 
a linear, globally defined change of coordinates. Its Jacobian is, therefore, spatially constant 
and hence satisfies the compatibility condition (3.68).
3.7.3 Nonobjective Lagrangian Principles
Stagnation-Point-Based Criteria for Lagrangian Fronts
Instantaneous, saddle-type stagnation points in unsteady flows are often assumed to ap­
proximate nearby fluid trajectories of saddle-type stability. This assumption is generally 
unjustified, as the Navier-Stokes flow shown in Fig. 2.24 demonstrates, with its saddle-type 
stagnation point fixed at the origin. Indeed, even when a stagnation point p does not move in 
time and hence coincides with an actual fluid trajectory, the stability of that trajectory cannot, 
in general, be inferred from the local streamline geometry in unsteady flows. For this reason, 
while local streamline geometry is correctly determined by the time-dependent eigenval­
ues of the velocity gradient Vv(p; t°, the instantaneous streamline patterns obtained in this 
fashion have no general relationship to the stability of the origin in the associated equation 
variations £ = Vv(p; t)£, as we have stressed repeatedly (see, e.g., Example 2.1 in §2.2.8).
The question nevertheless arises: Are there special circumstances under which the contin­
ued presence of a moving saddle-type stagnation point p(t° implies the presence of a nearby 
saddle-type fluid trajectory? Attached to such a trajectory, there would be then an associated 

3.7 Some Nonobjective Approaches to Transport Barriers
91
front-type barrier (or unstable manifold), Wu (x(t)), to advective transport, as sketched in Fig.
3.8.
Figure 3.8 Evolving saddle-type stagnation point p(t° and a possible nearby saddle­
type (finite-time hyperbolic) fluid trajectory x(t° with an attached front-type advective 
transport barrier (finite-time unstable manifold), Wu(x(t)), in a 2D flow. See Chapter 
4 for more information on stable and unstable manifolds.
Haller and Poje (1998) give conditions under which the relationship envisioned in Fig. 
3.8 can be mathematically established for a 2D incompressible flow over finite times. These 
conditions impose bounds on the speed p(t° of the stagnation point and the rate of change of 
the eigenvalues ±A (rv (p(t), t)) and eigenvectors e± (rv (p(t), t)) of the velocity gradient 
rv along p(t°. The conditions also require upper bounds on the nonlinearities in a small 
neighborhood of p(t° that contains no other stagnation points. The main result of Haller and 
Poje (1998) is that if two inequalities involving these quantities are satisfied, then there exist 
saddle-type fluid trajectories of the type depicted in Fig. 3.8 with associated Lagrangian 
fronts. These trajectories are not unique: they fill an open neighborhood and hence create 
overall a front of finite thickness. The thickness of this front tends to zero exponentially as 
the time interval over which the stagnation point exists grows.
Unlike the nonobjective criteria we have discussed so far, this stagnation-point-based 
criterion for a front-type material barrier is mathematically justified and gives verifiably 
correct results on velocity data sets (see Haller and Poje, 1998). As a consequence, the 
criterion can yield no false positives for Lagrangian fronts. The inequalities in the criterion, 
however, involve stagnation points and invariants of the velocity gradient and hence depend 
on the frame of reference. Thus, these inequalities may not hold in a given frame even if there 
are nearby saddle-type trajectories. Consequently, this nonobjective criterion for Lagrangian 
fronts can produce false negatives.
Stagnation-point-based approximations to Lagrangian fronts are also surveyed by Jones 
and Winkler (2002). These approximations involve the release and advection of material 
lines (termed effective invariant manifolds) near saddle-type stagnation points. The evolving 
material curves generated in this fashion are then expected to straddle the unstable manifolds 
of nearby hyperbolic Lagrangian trajectories. As we discuss in §5.7.4,this frame-dependent 
procedure can indeed be effective if a nearby objective Eulerian saddle point exists in the 
flow. In the absence of such a saddle point, the ultimate stretching of any material line is only 
due to its approach to some other Lagrangian front during its evolution (see Fig. 5.66).

92 
Objectivity of Transport Barriers
A Lagrangian Okubo-Weiss Principle: The a -P Criterion
The strongest limitation of the stagnation-point-based criterion sketched out in §3.7.3 is its 
reliance on the existence of an instantaneous stagnation point p(t). This assumption requires 
the continued existence of a point at which the flow velocity is exactly the same as the velocity 
of the reference frame. As a consequence, when described from the frame of a flying airplane, 
there will be no stagnation points in the surface velocity field of the ocean, as no point in the 
ocean surface moves as fast as the plane in the frame of the earth. Also, paradoxically, any 
point in the ocean velocity field can be turned into a stagnation point by passing to a frame 
of a slow vessel that moves exactly with the surface velocity at that point. All this illustrates 
that in a general unsteady flow, instantaneous stagnation points have little, if any, meaning 
for transport.
To address this shortcoming, Haller (2000) omits the assumption on the existence of a 
stagnation point altogether and proves a sufficient condition for the existence of saddle-type 
Lagrangian trajectories and their associated front-type, advective transport barriers (finite­
time unstable manifolds). Specifically, let x(t° denote a fluid trajectory in a 2D incompressible 
velocity field v(x; t°. Assume that the Okubo-Weiss criterion (see §3.7.1) holds along x(t° 
over the time interval »t0; t1], which means that the trajectory-restricted velocity gradient 
A(t° = rv (x(t°; t° has real eigenvalues 11;2 (A(t)) = ±J-Q(x(t), t° over »t0; t1]. Denoting 
the corresponding unit eigenvectors of A(t° by e±(t° and the 2 x 2 matrix built of these 
eigenvectors by T(t° = »e_(t), e+ (t)], we introduce the constants
/1mill = min |11 2 (A(t))|, a = min jdet T(t)|, P = max |T(t)|, 
(3.75)
t 2»t0 ;t1 ] 
t 2»t0 ;t1 ] 
t 2»t0 ;t1 ]
with |T(t°| denoting the Euclidean matrix norm of T(t°. Then, if the inequalities
.... 
2p2P
Q(x(t°; t° < 0; 
(3.76)
a
hold for all t 2 »10; 11], then x(t° is a saddle-type trajectory contained in a Lagrangian front 
(finite-time unstable manifold) over the time interval »t0; t1] (see Haller,2000for a proof).
Conditions (3.76) can be verified for a set of trajectories launched from an initial grid. 
Trajectories satisfying these conditions for the longest time can then be highlighted as 
cores of the most persistent Lagrangian front-type barriers. Such long-lived barriers become 
exponentially unique in time, just as those obtained from the stagnation-point criterion of 
§3.7.3.Similarly to that criterion, however, the a-P criterion described in Eq. (3.76) is a 
frame-dependent sufficient condition due to the nonobjectivity of the quantities involved. 
As a consequence, while the a-P criterion will produce no false positives for saddle-type 
trajectories with fronts of the type shown in Fig. 3.8,it can certainly produce false negatives.
Example 3.1 We consider again the Navier-Stokes velocity field (2.133) with c = -4. 
Linearization of this vector field at its fixed point at the origin gives
sin 41 
cos 41 + a 
p------ y ,,
A(t° = rv(0; t° = 
; 
1 (A(t°° = ±V 1 - a2: 
(3.77)
(° 
' 
° 
\ cos41 - a - sin41 ) 
( ( °°
For a = 2, therefore, Q(x(t°, t° = a2 - 1 > 0 holds in this case, implying that the first 
condition inEq. (3.76) is violated. This example, therefore, represents a false negative for 

3.7 Some Nonobjective Approaches to Transport Barriers
93
the a-p criterion, given that the x(t° = 0 trajectory is known to be of saddle type (see Fig. 
2.23), but the criterion fails to identify this saddle trajectory.
In contrast, for a = 1 /2, we have Q(x(t°, t° = a2 - 1 < 0, and hence the first inequality in 
the a-p criterion (3.76) is satisfied. Furthermore, a lengthy but straightforward calculation 
gives
Amin = p3/2; a = p3/2; p = 2p2;
showing that the second criterion inEq. (3.76) is violated. The a-p criterion, therefore, 
correctly classifies the x(t° = 0 as non-saddle-type, consistent with the Poincare map shown 
for Fig. 2.24 for this example.
Trajectory-Length Diagnostic: The Mtt01 Function
As discussed in §2.2,qualitatively different streamline patterns in a 2D, steady velocity field 
v(x° are separated from each other by separatrices that connect zeros of v(x° to themselves 
or to each other (see Fig. 2.3). As such connections are challenging to locate numerically, an 
alternative way to infer the existence of separatrices from trajectory data is to look for curves 
across which one finds a noticeable jump in the lengths of nearby trajectories.
Indeed, comparing the two sides of the separatrices highlighted in Fig. 2.3,one sees a 
jump discontinuity in the trajectory lengths due to a change in the trajectory topology. Over 
finite times, the trajectory length also admits minima at fixed points of the flow (at zeros of 
v(x°) and will admit trenches (or inverted ridges; see Appendix A.2 for definitions) along 
trajectories converging to such fixed points, as indicated in Fig. 3.9.
Figure 3.9 Finite-time trajectory length near stagnation points of planar steady flows. 
(Left) The trajectory length (as a function of the initial position) has global minima 
at elliptic stagnation points. (Right) The same trajectory length function has global 
minima at hyperbolic stagnation points p as well. In addition, the trajectory-length 
function has a trench along the stable manifold Ws (p) of such a stagnation point.
Motivated by these observations for steady flows, Mancho and coworkers (see Madrid 
and Mancho, 2009;Mendoza and Mancho, 2010) put forward the nonautonomous trajectory 
length function
Mtt1 (xo° = /" |v(x(^; 10; xo°; s)| ds
t0
as a diagnostic tool for advective transport barriers. They propose that initial conditions 
along saddle-type trajectories of the velocity field v(x, t° should be local minima for Mt1 (x0°. 
By analogy with the steady case shown in Fig. 3.9, they also suggest that stable manifolds 

94 
Objectivity of Transport Barriers
(backward-time fronts) emanating from such saddle-type trajectories should be trenches of 
Mtl (X0V0
The gradient r M0 of M01 (x0° with respect to x0 can be computed as
10 The later paper of Mancho et al. (2013) also asserts that Mt^1 (x0° highlights stable and unstable manifolds of 
saddle-type fluid trajectories by admitting discontinuous derivatives along such manifolds. Such a discontinuity, 
however, cannot arise. Indeed, by the smoothness of the finite-time flow map Ftt0 (see §2.2.3), finite-time pieces 
of trajectories (and hence their lengths) are smooth functions of their initial conditions as long as v(x(t; t0; x0 °; t° 
is not identically zero, i.e., x(t; t0; x0° is not a fixed point. The latter condition can be verified by inspecting the 
gradient of Mtt01 in Eq. (3.78).
11 Instead, the stability of the 
0 solution of Eq. (2.45) is determined by the temporal behavior of the solution
norm |<(t°| = D<(t0°; [rFt0(xc)]TrFt0 (x0)^(t0°E. The evolution of this norm is governed by the singular 
values rFt0(x0°, which are also basis-independent invariants for two-point tensors. The singular values of
rM0(xo° = [1 [VFto(xo°]T »Vv(x(s; t0; xo°; s°]T v(x(s; t0; x0°; s° ds; 
(3.78)
0 
t0 
0 
jv(x(s; t0; X0°; s°j
which can quickly be verified to be nonobjective. Therefore, both the values of M0 (x0° and 
its topological features are frame-dependent. Indeed, a rotating observer traveling with an 
arbitrary trajectory x(s; t0 x0° will see a local minimum for M01 (x0° at the initial condition x0 
of the trajectory. More specifically, under the frame change
x = Q(t°y + x(t; 10; X0°;
we have M0 (y0° = 0, while for all y0 , y0, we have M0 (y0° > 0 when the frame rotation 
speed |Q(t)| is large enough. Therefore, if one takes a local minimum for M0 to be an 
indication of a distinguished trajectory, then one should remember that such a minimum can 
be introduced by an appropriate observer change at any point of any flow.
Simple examples illustrate the lack of a firm connection between stable/unstable manifolds 
and M01 (x0° and its later variants (see Ruiz-Herrera, 2015, 2016). A critical comparison of 
the performance of M01 (x0° with that of other coherent structure detection methods can be 
found in Hadjighasem et al. (2017). As an advantage, however, the M-function, M01 (x0°, 
is undoubtedly the simplest to implement among the coherent structure detection methods 
reviewed in Hadjighasem et al. (2017). Figure 3.10 shows the performance of the trajectory­
length diagnostic on the Navier-Stokes flow whose true advective transport barriers are 
shown by the corresponding Poincare map.
Deformation-Gradient-Based Diagnostic: Mesochronic Analysis
As we discussed in §2.2.8, infinitesimally small material perturbations of a fluid trajectory 
starting from x0 at time 10 evolve under the action of the deformation gradient VFt0(x0°: We 
also pointed out that this mapping is a two-point tensor, acting between the two linear spaces 
Tx0Rn and TF(x0°Rn, which are distinct unless Fto(x0° = x0 (see formula (2.25) and Fig. 2.6). 
Therefore, unless Ftt maps x0 back to itself, one cannot define an eigenvalue problem for 
rFtt (see §3.5 for more detail). In particular, formally computed eigenvalues of a matrix 
representation of the mapping rFtt depend on the basis and hence cannot be used to analyze 
the stability of the 0 solution of the equation of variations (2.45) unless x0 is a fixed 
point of the flow map Ftt0+T of a T -periodic velocity field.11 10
 11

3.7 Some Nonobjective Approaches to Transport Barriers
95
Figure 3.10 Results from the trajectory-length analysis (M0-function) and the 
mesochronic analysis of the Navier-Stokes flow shown in Fig. 3.6, compared with 
the actual Lagrangian dynamics revealed by a Poincare map. The time interval for all 
computations is 300 periods of the flow (»10 11] = »0; 150^]).
Formal eigenvalue computations for matrix-representations of rFt0(x0) have nevertheless 
been envisioned to characterize the material behavior of fluid elements along the trajectory 
x(t; 10;x0° (see, e.g., Pierrehumbert and Yang, 1993; Yggasaki, 2008; Mzzic et al.. 2010; 
Budisic et al., 2016).12 The resulting procedure, termed mesochronic analysis by Mezic et al. 
(2010); Budisii et al. (2016), is an extension of the idea behind the -criterion (see §3.7.1) 
from a single instantaneous time to a finite time interval.
Accordingly, for 2D incompressible flows, Mezic et al. (2010) call a flow region mesoel- 
liptic over the time interval »t0; t1] if the formally computed eigenvalues of a matrix-
rF(o (x0° are square roots of the eigenvalues of the right Cauchy-Green strain tensor C' (x0), as we discuss in 
Eq. §5.2.1.
12 Pierrehumbert and Yang (1993) define the finite-time Lyapunov exponent (FTLE) introduced in Eq. (5.7) as 
the time-normalized logarithm of the modulus of the (formally computed) largest eigenvalue of rF'0 (x0). This 
definition assumes that the squared moduli of the eigenvalues ofa square matrix are equal to the singular values 
of that matrix, which is only true for symmetric matrices. The deformation gradient, rF(0 (x0°, is generally 
not symmetric and hence this definition in Pierrehumbert and Yang (1993) is inaccurate. Their computation 
of an approximation of the FTLE, however, is correct, as it does not follow their definition. We note that for 
nonsymmetric square matrices of arbitrary dimension, no general relationship is known between the eigenvalues 
and singular values (see, e.g., Kieburg and Kosters, 2016).

96
Objectivity of Transport Barriers
representation of VF^J(x0° have nonzero imaginary parts. Similarly, flow regions where 
the formal eigenvalues are real and positive (negative) are called mesohyperbolic region 
(mesohyperbolic region with rotation), respectively. As noted above, this classification will 
generally not return the correct stability type of the trajectories, as illustrated by Fig. 3.10. 
Indeed, while most fluid trajectories in this flow are of elliptic (i.e., neutrally stable) type, 
the mesochronic analysis classifies most of them as hyperbolic (i.e., unstable). The same dis­
crepancy with accepted definitions of stability and instability already arises in applications 
of the principle to steady planar flows, such as the one considered by Mezic et al. (2010). The 
mesochronic classification will also change under observer changes because VFt0(x0° and 
its formally computed eigenvalues are not objective (see formula (3.45)). Hadjighasem et al. 
(2017) gives further comparisons of the mesochronic analysis with other coherent structure 
detection methods on specific flows.
3.8 Summary and Outlook
In this chapter, we have given a detailed discussion of the relevance and implications of mate­
rial frame-indifference (objectivity) for material transport problems in fluids. Our quest for an 
objective description of transport and its barriers does not stem from mathematical pedantry 
or scientific purity. Rather, objectivity is a practical litmus test for proposed theories of 
transport barriers that ensures the experimental verifiability of their predictions. Indeed, one 
does not append results from material mixing and transport experiments with the disclaimer 
“Warning: These conclusions are only valid in the frame of the observer!” This is because 
material mixing, as part of the material response of the fluid as a continuum, is indifferent to 
the observer (Gurtin, 1981). This means that the conclusions of one observer transform to the 
conclusions of another observer precisely through the (generally time-dependent) Euclidean 
transformation that relates the two observers to each other.
As we have argued, the principle of material frame-indifference is our universally trusted 
tool to derive equations of motion, such as the Navier-Stokes equation, in general moving 
frames. Although often misquoted in this respect, objectivity does not require any equation 
of motion to be the same in all frames. Rather, objectivity requires the material response 
(fluid trajectories) generated by those equations in different frames to transform properly, i.e., 
map into each other under the same transformation that relates their frames to each other. 
We have clarified this and also addressed other common misunderstandings of objectivity.
Based on these considerations, we have argued that self-consistent identifications of ma­
terial barriers (which are also composed of fluid trajectories) can only involve quantities that 
transform properly under frame changes. Otherwise, those descriptions could not possibly 
return material features of the fluid. This requirement is already explicitly stated in early 
papers on flow structure identification (Drouot, 1976;Drouot and Lucius, 1976;Astarita, 
1979;Lugt, 1979), yet it is often forgotten or ignored in the contemporary literature on 
data-driven feature extraction.
Objectivity imposes different requirements for Eulerian and Lagrangian quantities, which 
we have discussed in detail for scalar fields, vector fields and tensor fields. The requirements 
for Lagrangian objectivity will be extensively used in Chapters 5 and 6 in our descriptions of 
Lagrangian coherent structures (LCSs) and flow separation. The requirements for Eulerian 
objectivity will be used throughout Chapters 5, 6 and 9, where we will discuss objective 

3.8 Summary and Outlook
97
notions of Eulerian coherent structures (OECSs). These are instantaneous limits of LCSs 
that can be used to frame short-term material behavior in an objective fashion from single 
snapshots of the velocity field.
We have also discussed the notion of Eulerian-Lagrangian objectivity relevant for two- 
point tensors, such as the deformation gradient and the polar rotation tensor. This class of 
tensors, however, contains mappings between two different linear spaces which have no well- 
defined eigenvalue problems associated with them. As a consequence, formally computed 
traces, eigenvalues and eigenvectors of specific matrix representations of these tensors are 
not objective quantities and hence cannot be used in material coherent structure detection 
without self-contradiction.
We have surveyed several nonobjective principles for transport barriers and coherent 
structures that have been put forward in the literature. While some of these principles 
are broadly used due to their simplicity, they return observer-dependent results and hence 
their predictions are generally inconsistent with transport barriers observed in experimental 
or observational tracer data. Exceptions to this statement are quasi-objective diagnostic 
quantities, which we have defined as quantities that closely approximate the same underlying 
objective field in qualifying frames. In such frames, quasi-objective quantities can be used 
for material flow feature detection without self-contradiction, as we will see in Chapters 5 
and 9.

4
Barriers to Chaotic Advection
In this chapter, we will discuss barriers to purely advective transport in velocity fields 
that may have complex spatial features but a simple (recurrent) temporal structure: steady, 
periodic or quasiperiodic. Such velocity fields can be integrated for all times on bounded 
domains and hence their trajectories can be interrogated over infinite time intervals. While 
such exact recurrence is atypical in nature, mixing processes with precisely repeating stirring 
protocols are abundant in technological applications. Figure 4.1 shows such a periodically 
repeating stirring experiment with the emergence of well-defined barriers to the transport 
of a dye blob.
Figure 4.1 Gradual advective mixing of dye due to periodic stirring executed by a 
small rod on the surface of pure glycerol. (Top) Initial state, state after half a cycle, and 
after a full cycle. (Bottom) The mixture after 21 stirring cycles. The persisting sharp 
gradients indicate that this mixing process is close to pure advection over exceedingly 
long time scales. Adapted from Villermaux and Duplat (2003).
We will define find classify barriers to advective transport in such flows as special material 
surfaces that are also temporally recurrent in the same fashion as the velocity field. Such 
material surfaces are rare, as general material surfaces will exhibit nonrecurrent evolution 
even in recurrent velocity fields, as noted in §2.2.4. This is because, in general, the flow map 
does not inherit the time dependence of the velocity field, as we remarked in §2.2.3.
98

4.1 2D Time-Periodic Flows
99
The simplest recurrent velocity fields are 2D and steady. Their advective barriers are 
immediately seen to be the streamlines of their velocity field. Indeed, by the uniqueness of 
trajectories of smooth velocity fields through any point (see §2.2), no trajectory can cross a 
streamline. Streamlines in 2D flows, therefore, form material barriers to advective transport. 
Accordingly, a plot of even a few representative streamlines in such a flow provides a useful 
template for advective transport.
In contrast, in 2D unsteady flows, streamlines are generally unrelated to fluid trajectories, 
as we noted in §2.2.1.As a second group of advective barrier candidates, material lines could 
be considered; these cannot be crossed by fluid trajectories in unsteady flows either. However, 
all material lines block advective transport because they are composed of trajectories, and 
there are infinitely many material lines running through each point of the flow domain at any 
time. It is therefore unclear at this point which of this abundance of material lines will prevail 
as an observed barrier to advective transport in a 2D unsteady flow. Similarly unclear is what 
the relevant advective barriers in 3D steady and unsteady flows should be. Indeed, in such 
flows, individual material lines can no longer isolate one region from another but infinitely 
many material surfaces through each point form uncrossable barriers to trajectories.
As we stressed in Chapter 3,experimentally observable transport barriers are material and 
hence objective: they are seen as barriers in all x and y frames linked together by Euclidean 
observer changes of the form (3.5). This observer change family contains rotation tensors 
Q(t° and translation vectors b(t° with arbitrary time dependence. As a consequence, the 
transformed velocity field V = QT(v - Qy - lb), as obtained in Eq. (3.17), will generally 
lose its recurrent (steady, periodic or quasiperiodic) time dependence under general choices 
of Q(t° and b(t). Most approaches in this chapter are, therefore, not objective: they become 
inapplicable in frames where the transformed velocity field no longer has the type of time 
dependence that these approaches assume from the outset. They are, however, quasi-objective 
in the sense of §3.6:they approximate appropriate metrics of material deformation in frames 
in which they assume their recurrent time dependence.
We survey these approaches here partly for motivation, partly for historical completeness 
and partly because their predictions in distinguished (recurrent) frames coincide with the 
predictions of Lagrangian coherent structure (LCS) methods to be discussed in Chapter 5. For 
this reason, recurrent velocity fields are ideal benchmarks for LCS techniques because their 
transport barriers can be unambiguously identified. There are also a number of technological 
mixing processes in which the velocity field is engineered to be spatially recurrent, and hence 
the techniques discussed here apply directly to them (see Speetjens et al., 2021, for a recent 
comprehensive review).
4.1 2D Time-Periodic Flows
To start with the simplest case, we now assume that the velocity field is 2D, incompressible 
and time-periodic. In that case, the differential equation for fluid particle motion on a domain 
U has the specific form
X = V(X; t °; r ■ V(X; t ) = 0; V(X; t ) = V (X; t + T), 
(4.1)
with x 2 U R2 and with some period T > 0. While the phase-space structure of such 
ODEs was well understood in the mathematics literature by the 1980s, the fluid mechanics 

100
Barriers to Chaotic Advection
community first learned about these developments in a seminal work by Hassan Aref (1984); 
see also Aref (2002) for a historical perspective.
Aref’s intent was to demonstrate that even simple (planar and time-periodic) flows can 
produce complicated conservative tracer patterns in a process he termed chaotic advection. 
Yet, in studies of such flows, the term transport barrier soon emerged for curves that visibly 
blocked any exchange of fluid trajectories in stroboscopic images taken at multiples of the 
period T (seeFig. 4.2).
Figure 4.2 Apparent transport barriers in a stroboscopic, T -periodic sampling of 
fluid trajectory positions in Aref’s blinking vortex flow. Adapted from Aref (1984).
A more specific definition of these observed barriers to transport was apparently first given 
by Mackay et al. (1984), who used the term transport barrier for closed curves that remain 
steady (or invariant) under iterations of the period-T map (or Poincare map; see §2.2.12) 
associated with the ODE (4.1). In the same reference, the term partial transport barrier 
appears in reference to non-closed invariant curves of the time T-map that do not block but 
slow down the transport of initial conditions between two specific spatial domains.
A perfect barrier could indeed be defined as a closed invariant curve of the Poincare map 
but many experimentally observed barriers to transport are not closed, as we will see shortly. 
Indeed, the apparent mixing region in Fig. 4.2 turns out to contain a wealth of non-closed 
invariant curves of the time-T map that have a profound effect on shaping passive tracer 
patterns in this region. This prompts us to introduce the following definition:
Definition 4.1 An (advective) transport barrier of a temporally T -periodic velocity field 
v(x t° = v(x.; t + T° is a structurally stable invariant curve for some iterate of the period-T 
map of v(X; t).
By this definition, transport barriers are not necessarily invariant curves under a single 
iteration of the Poincare map. Instead, they may be invariant curves only for some higher- 
iterate of the Poincare map. Examples include the stable or unstable manifolds of period-2 
fixed points of saddle type, which are only invariant curves of for the second iterate of the 
period-T map. For physical relevance, Definition 4.1 also requires a transport barrier to be 
a structurally stable (see §2.2.7) invariant curve of an iterate of the period-T map. This is 
to ensure the smooth persistence of the barrier under small perturbations and uncertainties 

4.1 2D Time-Periodic Flows
101
in the underlying flow, which are always unavoidable in practice. The physically meaningful 
perturbations and uncertainties to the flow are generally restricted to volume- or at least mass­
preserving disturbances, which result in area-preserving perturbations to the period-T map. 
Such area-preserving perturbations allow for a larger class of structurally stable invariant 
curves for the period-T map, including the closed invariant curves seen in Fig. 4.2. We recall 
that the computation of the Poincare map for a general 2D, time-periodic vector field is 
implemented in Notebook 2.1.
When advected by the full flow map Ftt0 as a material line, the advective transport barriers 
defined in Definition 4.1 reassume their initial positions periodically in time. This remarkable 
resilience or material coherence makes these barriers very special among all other material 
lines, which typically evolve into ever more complicated shapes and continually develop 
small-scale filaments. For this reason, advective transport barriers in time-periodic flows 
provide the simplest examples of LCSs, a more general advective barrier concept that we 
mentioned in §1.3 and will discuss further for nonrecurrent flows in Chapter 5.
Next, we look more specifically into what types of invariant curves a Poincare map may 
admit. A fixed point p is the simplest element of the dynamics of Pt0 , marking a T -periodic 
trajectory of the velocity field v. The linear stability of such a periodic trajectory depends on 
the linearized Poincare map
^! rpt0 (p) e
(4.2)
at p, with e denoting infinitesimally small displacement vectors emanating from p. By the 
area-preserving property (2.76) ofPt0, the product of the two eigenvalues 1;2 of the Jacobian 
rPt0 (p) must be equal to one. The eigenvalue configuration, therefore, falls in one of the 
four categories shown in Fig. 4.3.
hyperbolic fixed point
elliptic fixed point
A; = e ± a$ R
parabolic fixed point 
(nondegenerate)
parabolic fixed point 
(degenerate)
e1 = e2
A1 = a = 1 el = e2
A1 = A2 = 1 e1,e2 e!2
Figure 4.3 The four possible phase portraits of linearized area-preserving Poincare 
maps, along with their corresponding eigenvalue configurations: hyperbolic (saddle­
type) fixed point; elliptic (center-type) fixed point; nondegenerate parabolic fixed 
point (shear flow with a line of fixed points); degenerate parabolic fixed point (qui­
escent flow composed of fixed points). The vector ei denotes the real eigenvector 
corresponding to a real eigenvalue i .
These linearized phase portraits already contain the three well-documented barrier types 
to transport in 2D flows. Specifically, the unstable e2 eigenvector of a hyperbolic fixed point 
on the left in Fig. 4.3 spans a full line, the unstable subspace, of this saddle-type fixed 
point, observable as a front that attracts tracers. Approaching tracers are divided and directed 

102
Barriers to Chaotic Advection
towards different branches of this front due to the presence of the stable subspace of the saddle 
point, spanned by the stable eigenvector e1. Paradoxically, therefore, the stable subspace of 
the saddle point is an unstable (repelling) material line and the unstable manifold is a stable 
(attracting) material line.
The center-type pattern in the second phase portrait in Fig. 4.3 occurs in vortical flow 
regions that keep tracers from spreading. All trajectories near this elliptic fixed point are 
confined to closed transport barriers along which they all travel without shear, i.e., with the 
same angular velocity •T . The single real eigenvector of a nondegenerate parabolic fixed 
point in Fig. 4.3 spans a one-dimensional subspace, which often marks a no-slip wall that 
fully prevents transport in the normal direction. Finally, any curve is a transport barrier in 
the linearized map at a degenerate parabolic fixed point, as all points are fixed points in this 
approximation (see Fig. 4.3).
Linearized Poincare maps are, therefore, perfectly well understood but pose a challenge 
in defining unambiguously what a transport barrier should be. Indeed, any of the infinitely 
many other curves approaching the unstable subspace of the saddle points also acts as an 
attracting material line. Similarly, all horizontal lines in the vicinity of a parabolic fixed point 
block vertical transport of the fluid, not just the one through the fixed point. Finally, any one 
of the closed curves near an elliptic fixed point keeps the trajectories in their interior from 
leaking out. This abundance of invariant curves, however, tends to diminish dramatically 
once we consider the full, nonlinear Poincare map Pt0 in the next section.
As Fig. 4.2 already illustrates, the full Poincare map Pt0 is the most broadly applicable and 
simplest tool to detect barriers to advective transport in time-periodic flows. The visibility of 
these barriers will, however, depend on the choice of seeding points used in the visualization 
of Pt0 . If these points are chosen too sparsely, then one may miss some barriers. If the 
initial positions are chosen too densely, one might just see the whole domain filled with a 
similarly tightly packed set of current positions by the area preservation of Poincare maps 
(see, e.g., Fig. 4.4 for an illustration). This limitation in the visualization of practical examples 
necessitates a more detailed analytical understanding of the types of transport barriers that 
may arise in time-periodic planar flows. This will, in turn, help us identify these barriers 
even from sketchy simulations of a Poincare map.
4.1.1 Hyperbolic Barriers to Transport
We start our discussion of nonlinear Poincare maps by exploring the fate of the stable and 
unstable subspaces of a saddle-type fixed point p of Pt0 in the nonlinear Poincare map
%! rPto (p)e + O (|$|2) 
(4.3)
near p. By the classic stable manifold theorem (see Guckenheimer and Holmes, 1983), the 
stable subspace Es of a saddle point of the linearized Poincare map rPt0 (p) always has 
a unique nonlinear continuation, Ws (p), that is tangent to Es at p and contains all initial 
conditions that converge to p under forward iterations of Pt0. The smooth curve Ws (p) is 
an invariant manifold (see §2.2.5), and hence initial conditions never leave Ws(p) under 
iterations of Pt0. We call Ws (p) the stable manifold of p. Similarly, tangent to the unstable 
subspace of the linearized mapping rPt0 (p) at a saddle point p, there exists another unique

4.1 2D Time-Periodic Flows
103
10 X10 initial grid
1
25 X 25 initial grid
Figure 4.4 Plot of the Poincare map for the Navier-Stokes velocity field (2.133) for 
a = 0:5, b = -0:015 and c = -4 at time t = 0, computed over an increasingly 
dense grid of initial conditions. Note that a denser grid does not necessarily help 
in identifying barriers to transport, whereas a sparser grid may also miss important 
barriers.
50 X 50 initial grid
■io -s o s io
invariant manifold, the unstable manifold, Wu (p°. This invariant curve contains all initial 
conditions that converge to the saddle point under backward iterations of Pt0. Both Ws(p° 
and Wu (p° are advective transport barriers by Definition 4.1.Because they are attached to 
hyperbolic fixed points, we refer to them as hyperbolic transport barriers.
In physical terms, Ws (p° and Wu(p° are material lines that deform in time but resume their 
time-t0 positions exactly at times t0 + kT for any integer k . Just as we have noted for the stable 
and unstable subspaces of the linearized Poincare map, the mathematical terms “stable and 
unstable manifolds” are perhaps misnomers. They refer to the - experimentally unobservable 
- internal dynamics of Ws (p° and Wu (p°, while the observable external dynamics of these 
curves is of just the opposite type: stable manifolds repel nearby fluid elements while unstable 
manifolds attract them.
Stable manifolds can neither intersect themselves nor other stable manifolds, as that would 
imply two different types of forward asymptotic behavior for the initial conditions lying in 
their intersection. Similarly, unstable manifolds cannot intersect themselves or other unstable 
manifolds. Stable manifolds may, however, intersect the unstable manifolds of the same or 
of other fixed points. By the invariance of these manifolds, one intersection between them 
implies infinitely many other intersections. For weakly unsteady flows, the intersections of 
stable and unstable manifolds can be analytically predicted using the Melnikov method (see 
Guckenheimer and Holmes, 1983). The first application of this method to fluid flows was 
apparently given by Knobloch and Weiss (1987). Further examples and relevant discussions 
can be found in Wiggins (1992); Samelson and Wiggins (2006); Balasuriya (2016).
The infinite sequence of intersection points between Ws (p° and Wu (p° approaches a 
hyperbolic fixed point both in forward and backward time, causing an accumulation of 
stable manifolds on themselves or on other stable manifolds by the classic lambda lemma of 
Palis (1969). The resulting stretching and folding creates a highly complicated structure, a 
homoclinic or heteroclinic tangle, as shown in Figs. 4.5(a)-(b).
These plots also show the primary intersection points r, r1 and r2 between the invariant 
manifolds, which then give rise to infinitely many other intersection points in the homoclinic

104
Barriers to Chaotic Advection
homoclinic tangle 
e
Ws (p)
heteroclinic tangle
Wu (p)
V
ei
w (q) W (p)
V
Wu (q) W (p)
P0( Lin)
P0(Lout)
(c)
Wu (p)
lobe dynamics
V
turnstile
Lut
L in
Ws (p)
p
(a)
(b)
Figure 4.5 (a) Homoclinic tangle formed by the stable and unstable manifolds of a 
hyperbolic fixed point p of the Poincare map Pt0, with a primary intersection point r. 
(b) Heteroclinic tangle formed by the stable and unstable manifolds of two hyperbolic 
fixed points, p and q of the map. (c) Forward iterations of the external lobe Lin under 
the map Pt0 enter the reference region D, while forward iteration of the internal lobe 
Lout leave D. These two lobes together form a turnstile.
and heteroclinic tangles. An experimental demonstration of such a homoclinic tangle is 
shown in Fig. 4.6.
(a)
(b)
(c)
(d)
Figure 4.6 Experimentally constructed transverse intersections in a 2D cavity flow 
with periodically moving walls. (a) Initial dye blob position. (b) The deformed dye 
blob after a few forward periods. (c) Same as in (b) but superimposed on the defor­
mations of the same blob under a reversal of the wall motion to mimic backward-time 
evolution. (d) Magnified region showing the transverse intersection of stretched slabs 
surrounding the stable and unstable manifolds of a saddle-type fixed point of the 
Poincare map. Adapted from Chien et al. (1986).
Manifold segments connecting primary intersection points to the underlying hyperbolic 
fixed points enable one to define the reference regions labeled as D in Fig. 4.5. Meterlal 
transport in and out of these regions has been studied extensively (see, e.g., Mackay et al., 
1984; Ottino, 1989; Rom-Kedar and Wiggins, 1990; Rom-Kedar et al., 1990; Wiggins, 

4.1 2D Time-Periodic Flows
105
1992;Rom-Kedar,1994;Samelson and Wiggins, 2006;Balasuriya, 2016). The fundamental 
vehicle for this transport is a turnstile, composed of lobes formed by segments of stable and 
unstable manifolds between adjacent points of their intersection, as shown in Fig. 4.5(c). One 
of these lobes, Lin, enters the material reference zone D under iterations of the map, whereas 
the other lobe, Lout, leaves D. For area-preserving Poincare maps (i.e., for incompressible 
flows), the two lobe areas (as well as the areas of their forward and backward iterates) are 
equal.
For homoclinic tangles, Smale (1967) proved the existence of a nearby chaotic invariant 
set. Restricted to that set, the Poincare map is chaotic: it behaves like a realization of a 
Bernoulli shift map, a mathematical model for an infinite, random coin tossing experiment. 
This remarkable fact has fascinated the applied mathematics and physics community, creating 
a new paradigm that even simple, time-periodic velocity fields can generate immensely 
complicated trajectories. The set of chaotic trajectories near a homoclinic tangle, however, is 
unobservable in incompressible flows: it is of measure zero and unstable, repelling all nearby 
fluid trajectories. Thus, typical fluid trajectories in its vicinity will only experience transient 
chaos (Lai and Tel, 2011).
If the chaotic set is practically invisible, what governs the formation of tracer patterns in 
chaotic advection? Shown in Fig. 4.7, a classic experiment by Chien et al. (1986) indicates 
a complex but asymptotically steady pattern in the stroboscopic images of a dye blob in a 
time-periodic cavity flow. The dye is visibly attracted to a convoluted material line, forming 
a front that is a de facto barrier to dye transport. The stroboscopic snapshots of the dye 
distribution gradually align with the material barrier, which is unsteady in time but resumes 
the same position when viewed at multiples of the flow period. Once the alignment is tight 
enough, there is virtually no change in the dye configuration, as was also observed in a later 
experiment by Rothstein et al. (1999), shown in Fig. 4.8.
l nra
Figure 4.7 Evolution of a dye blob in a time-periodic cavity flow, stroboscopically 
sampled at multiples of the time period of the velocity field. Image adapted from 
Chien et al. (1986).
Subplots (a)-(c) of Fig. 4.8 show snapshots of the dye concentration at multiples of the 
forcing period, illustrating the gradual convergence to a recurrent pattern that slowly fades 
out due to diffusion of the dye. Subplot (d) shows the same pattern for a different choice of 
the phase t0 in the Poincare map Pt0. This pattern may look substantially different, but can 
still be smoothly deformed into the pattern emerging in (a)-(c) due to the conjugacy property, 
(2.75), of Poincare maps.
Earlier numerical observations by Pierrehumbert (1994) had already revealed such recur­
rent patterns in weakly diffusive tracer mixing in a time-periodic velocity field. Pierrehum­
bert called these tracer patterns strange eigenmodes, i.e., recurrent, spatially complex tracer 

106
Barriers to Chaotic Advection
patterns that fade out gradually in time due to the diffusion of the tracer. A formal proof for 
the existence of strange eigenmodes in tracers mixed by time-periodic velocity fields was 
given by Liu, W., and Haller (2004).
ab
c 
d
Figure 4.8 Strange eigenmode forming in a dye layer over a conducting fluid that is 
forced time—periodicdly from below by an irregularly placed array of magnets. The 
snapshots (a)-(c) are taken at the same phase of the forcing period, whereas the plot 
(d) depicts the dye at a different phase in that period. Adapted from Rothstein et al. 
(1999)
As we noted in connection with Fig. 4.4, Poincare maps may not necessarily provide 
enough detail to identify the material barriers delineating strange eigenmodes. Indeed, the 
experimentally constructed map in Fig. 4.9 shows some of the hyperbolic fixed points but 
indicates little of the global geometry of their stable and unstable manifolds.
We will develop methods in Chapter 5 that specifically target generalizations of such 
invariant manifolds based on their impact on fluid trajectories in velocity fields with general 
time dependence. Armed with some of those methods, we will revisit the flow shown in Figs. 
4.8-4.9 to uncover the transport barriers delineating strange eigenmodes as LCSs directly 
from the velocity data. As a preview of the results one can obtain from such methods, we show 
in Fig. 4.10 stable and unstable manifolds extracted as LCSs from the same experimental 
data.
4.1.2 Elliptic Barriers to Transport
Two-dimensional, nonlinear, area-preserving maps have analogues of the elliptic regions 
we identified for linearized Poincare maps in Fig. 4.3. While adding nonlinearities to the 
linearized map tends to destroy a large number of individual closed transport barriers, most 
of the barriers of the linear map persist in a deformed shape as long as the nonlinear map is 
a twist map, as we will discuss next.

4.1 2D Time-P riodic Flows
107
EipeMal PM map
Figure 4.9 Poincare map constructed from tracer particles for the time-periodic flow 
experiment in Fig. 4.5. (a) Line segments connect particle positions with their position 
one period later. Brighter colors mark larger displacements. (b) Zoomed version of 
the boxed area marked in (a). Four hyperbolic fixed points are marked with crosses; 
two elliptic fixed points are marked with circles. Adapted from Voth et al. (1994).
Figure 4.10 Stable manifolds (red) and unstable manifolds (blue) identified from 
the data used in the construction of the experimental Poincare map of Fig. 4.9. 
These hyperbolic transport barriers were constructed from the finite-time Lyapunov 
exponent (FTLE), a method we will discuss in Chapter 5 for locating transport barriers 
in finite-time velocity data. Black circles indicate hyperbolic fixed points recovered 
at the intersection of blue and red curves. Image adapted from Voth et al. (1994).
A twist map is a nonlinear map whose linear part has an elliptic fixed point, but whose 
nonlinear part adds shear (i.e., variation in the angular velocity) to the shearless rotation 
generated by the linear part. As long as the angular rotation frequency of the linear part is 
sufficiently nonresonant (i.e., •2 is far enough from an integer) and the nonlinear part of the 
Poincare map adds nonzero circular shear, most invariant curves of the linearized mapping 
deform but survive in a neighborhood of the fixed point (see, e.g., Gole, 2001). Those 
persisting invariant curves of the map are usually referred to as Kolmogorov-Arnold-Moser 
(KAM) curves. They are transport barriers by Definition 4.1, and they are often referred to as 
elliptic barriers to advective transport because they generally encircle elliptic fixed points.

108
Barriers to Chaotic Advection
Two such elliptic barriers are clearly visible in the blinking vortex flow shown in Fig. 4.2, 
but they generally occur in concentric families. The outermost member of such a family is the 
most influential of these barriers: its interior defines a coherent material vortex. While this 
vortex is steady under iterations of the Poincare map, it will become a periodically deforming 
material blob in continuous time, resuming its original shape at multiples of the time period 
T of the flow.
Other examples of elliptic barriers in a twist map can be found in the Poincare map of the 
velocity field (2.133) for b , 0. Figure 4.11 shows how a family of closed, nested, elliptic 
transport barriers gradually breaks up as b grows in norm. Note the creation of elliptic islands 
from the remnants of invariant curves in annular regions where the rotation frequency is in 
resonance with the forcing.
b = 0
b = -0.03
b = -0.05
Figure 4.11 Poincare map for the Navier-Stokes velocity field (2.133) for a = 0:5 
and c = -4, based at time t = 0 for various values of the parameter b. In each case, 
150 iterations of the same initial grid of 2020 particles are shown; the instantaneous 
streamlines are shown in the background for reference. The linear Poincare map at 
b = 0 becomes a twist map for b , 0. The contribution from the nonlinear terms 
grows with the norm of b, gradually breaking up the closed transport barriers of the 
linear limit. Simultaneously, the whole elliptic region shrinks in size.
Mackay et al. (1984), Meiss (1992) and Gole (2001) provide more detail on the smaller- 
scale structures that form full or partial barriers to advective transport in area-preserving 
twist maps. These include resonance islands that are smaller invariant regions created at 
locations where the primary KAM curves would have a rational rotation frequency . In 
these resonance regions, the primary KAM curves break down into discrete elliptic islands 
of smaller closed invariant curves. Within each resonance island, a microcosm of the full 
large-scale phase portrait is recreated, including yet smaller-scale KAM curves and their 
resonant islands, as well as smaller-scale chaotic mixing zones created by intersections of 
stable and unstable manifolds of periodic orbits. All this implies a beautiful, nested self­
similarity of transport barriers in typical twist maps and hence in typical time-periodic, 
incompressible fluid flows, as shown in Fig. 4.12.
Figure 4.12 also shows an indications of an Aubrey-Mather set, also called a cantorus 
(Gole, 2001). First proposed by I. Percival and S. Aubry, then proven mathematically by

4.1 2D Time-Periodic Flows
109
K=0.971
K=0.817
Figure 4.12 Phase portrait of the classic standard map (Xn+1; yn+1 ° = 
(xn + yn+1, yn + K sin xn° for two values of the parameter K. This area-preserving 
twist map shows the typical structures that arise in Poincare maps of time-periodic, 
planar and incompressible flows. (Left) A few representative trajectories with all 
points along the same trajectory shown in the same color. Source: Wikipedia. (Right) 
A smaller set of trajectories illustrates different types of transport barriers and an 
apparent partial barrier (cantorus or Aubrey-Mather set). Adapted from Gole (2001).
S. Aubry, J. Mather and co-workers, a cantorus is an invariant Cantor set of points, as 
opposed to a classic continuous invariant curve (see Mackay et al., 1984 for references and 
further details). This invariant set is reminiscent of a KAM curve with infinitely many small 
holes. These holes enable some trajectories to pass across the cantori, but this passage is 
exceedingly slow. Since they are not continuous curves, cantori are technically not transport 
barriers by Definition 4.1 but nevertheless act as partial barriers to advective transport (see 
Mackay et al., 1984).
Any elliptic transport barrier in a Poincare map represents the cross-section of an invariant 
torus for the flow in the extended, 3D phase space of the variables (x, y, t mod T°. In Fig. 
4.13,we illustrate this geometry for two nested KAM curves and for an invariant curve in a 
period-six elliptic island. This set of islands lies in an annulus where no KAM curves exist 
due to a 1 : 6 resonance between the local rotation frequency in the flow and the frequency 
2n•T of the T-periodic velocity field. A closed curve in the period-6 resonant island of Fig. 
4.13 is an invariant curve of the 6th iterate of the period-T map, giving rise to the green 
toroidal transport barrier shown in the figure for the full flow. Other barriers and partial 
barriers (cantori) of the Poincare map can be similarly extended into barriers and partial 
barriers in the full, time-periodic fluid flow.
Transport barriers in plasma physics are often modeled via 2D Poincare maps defined by 
first returns to a selected section of a tokamak. There is ample experimental evidence for 
the existence of elliptic transport barriers in these flows (see, e.g., Tala and Garbet, 2006), 
which in turn has inspired a substantial body of related research involving 2D symplectic 
maps (see, e.g., Viana et al., 2021).

110
Barriers to Chaotic Advection
t mod T
X
Figure 4.13 Closed curves of the period-T Poincare map of a planar flow give rise 
to invariant tori filled by fluid trajectories in the extended phase space of (x; y, t 
mod T°. The nested blue tori arise from KAM curves of the Poincare map. The green 
torus arises from a closed invariant curve of the map that lies in a period-6 resonant 
island. Image: courtesy of Brendan Keith.
4.1.3 Parabolic Barriers to Transport
The third and fourth possible local phase portraits in Fig. 4.3 for a linearized Poincare 
map Pt0 are nondegenerate and degenerate parabolic flows. Nondegenerate parabolic points 
typically occur near no-slip walls, which then appear as invariant curves for Pt0 . These 
curves also remain barriers under the addition of nonlinear terms because nonlinearities are 
also physically constrained to satisfy the same no-slip boundary condition. Therefore, these 
invariant curves qualify as advective transport barriers by Definition 4.1.
In contrast, degenerate parabolic fixed points typically arise in the linearization of the 
Poincare map on shearless curves marking jet cores. Indeed, particle motion in the simplest 
steady, horizontal jet with a shearless core would satisfy x = -y\ y = 0 in a frame co-moving 
with the core of the jet along y = 0. For an arbitrary T, the period-T map Po(xo) and its 
derivative, r Po(x0°, at a fixed point x0 = (x0; 0 along the jet core are given by
Po(xo° = ( x0 + y0T 1; rP0(x0° = ( 1 0 1;
y0 
0 1
with r Po(x0° indeed generating the linearized phase portrait shown in the right-most subplot 
of Fig. 4.3.This phase portrait, however, is structurally unstable: the two-parameter family of 
fixed points of rPo(x0° generically breaks up under the inclusion of nonlinear terms in Po.
By a parabolic barrier in nonlinear Poincare maps away from fixed points, we will mean 
invariant curves of the Poincare map that are nonlinear continuations of nondegenerate 
parabolic barriers of the linearized map rP0 at a fixed point. Such barriers frequently arise 
in planar, area-preserving maps near closed curves where the twist condition (see §4.1.2) 
fails to hold. While classic KAM curves cannot be guaranteed to exist along non-twist curves, 
numerical observations of Samelson (1992); del Castillo-Negrete et al. (1996) and others 
reveal an abundance of closed nearby barriers that appear to be even more robust under 
perturbations than classic KAM curves (see also Fig. 4.14). The reason for this strong KAM 
stability, as argued by Rypina et al. (2007), is that resonance regions responsible for the 
destruction of KAM curves are thinner near shearless curves.

4.2 2D Time-Quasiperiodic Flows
111
Figure 4.14 Dynamics near a closed parabolic barrier (spatially periodic jet core) 
in the standard non-twist map (xn+1; yn+1° = (xn + a (1 - yn+1); yn - b sin xn) with 
a = 0:615 and b = 0:4. This map is a prototype model for planar area-preserving 
Poincare maps with a shearless curve at y = 0 (see del Castillo-Negrete et al., 
1996). The parabolic barrier arises as a centerpiece of a family of meandering elliptic 
barriers (KAM curves). Different colors mark different trajectories. Image: courtesy 
of George Miloshevich.
Delshams and de la Llave (2000) prove the existence of closed parabolic transport barriers 
near non-twist locations. In a practical situation, one could, in principle, detect these barriers 
from the period-T Poincare map of the flow, just as one visualizes hyperbolic and elliptic 
barriers via the iteration of this map. The plot of the map will, however, generally contain an 
abundance of elliptic barriers and hence the parabolic barrier serving as the core of a jet is 
often not immediately visible, as illustrated in Fig. 4.14.
For this reason, in Chapter 5 we will discuss methods that identify generalized jet cores 
in general unsteady flows. Examples of parabolic barriers revealed by these methods include 
the shearless boundary of the ozone hole and the cores of zonal jets in 2D model flows of 
planetary atmospheres (Beron-Vera et al., 2008b, 2010).
4.2 2D Time-Quasiperiodic Flows
Consider a 2D quasiperiodic velocity field
X = V(X; Q1 t.......  Qm t 
X 2 R2; 
(4.4)
with m rationally independent components in the frequency vector Q = (Q1, Qb..., Qm° 2 
Rm. As we discussed in §2.2.12, the ODE (4.4) can be viewed as an extended, 2n/Q1 -periodic 
system of the form
X = V(X; Q1 t; 0);
^) =
Q2
Qm
(4.5)
This extended dynamical system is defined on the (2 + m - 1°-dimensional phase space of 
the (X; ^2;...; ^m° variables, where 0j- = Qjt with j = 2;..., m.

112
Barriers to Chaotic Advection
As described in §2.2.12, we can define a Poincare map with period T = 2^/Q1 for the 
extended system (4.5) as
Pt,: R2 x Tm"1 ! R2 x Tm-1; 
t0
(x0; 
20; :::; m0° 7! (x (t0 + T; t0; x0; 00° ; 20 + 
2T; :::; m0 + 
mT° ; 
(4.6) 
where 00 = (20; :::; m0° is the initial phase vector at time t0 associated with the re­
maining frequencies. This map is volume preserving precisely when the velocity field v is 
incompressible.
Transport barriers for the map Pt0 in the mapping (4.6) can then be defined as m- 
dimensional invariant surfaces for the map Pt0 within the (m + 1)-dimensional Poincare 
section R2 x Tm-1. The intersections of these barriers with the 2D planes R2 x {00 g give 
physically observable material curves for the original, 2D dynamical system (2.77). These 
material curves are special in that they deform quasiperiodically as the time t varies in the 
phase vector 0 = (1t; 2t; :::; mt°. While this is helpful qualitative information about 
the possible advective transport barriers in quasiperiodic velocity fields, it is usually more 
expedient to locate these barriers by coherent structure methods that treat system (2.77) as a 
planar system with general time dependence. We will discuss such methods for temporally 
aperiodic systems in Chapter 5.
An alternative approach to studying advective transport barriers in the quasiperiodic flow 
(4.4) could be based on time-averaged scalar fields (observables) using Birkhoff’s ergodic 
theorem (see §2.2.14). As we indicated in our general discussion of quasiperiodic velocity 
fields in §2.2.12, however, Birkhoff’s ergodic theorem does not apply in this context. To 
see this in more detail, we reconsider the map Pt0 in Eq. (4.6) on the Poincare section 
Zt0 = R2 x Tm-1. We assume that the velocity field (4.4) is volume or mass preserving and 
hence Pt0 is measure preserving on t0 . If Pt0 is ergodic on a compact subset S t0 , then 
by the Birkhoff ergodic theorem (see §2.2.14), for any integrable scalar field C(x; 0° defined 
on S , we have the equality
1 A ................... 1
l,m N Xc (P*(xo;0o°) = 
js c(x;0°d»
(4.7)
for almost all (x0, 00° 2 S. Recall, from §2.2.14, that only the initial conditions obeying the 
phase relationship (2.81) in the extended system represent actual solutions of the original 
quasiperiodic flow (4.4). This restricted set of relevant initial conditions can, in principle, be 
in the measure zero set that is not covered by the equality of temporal and spatial averages 
in Eq. (4.7), and hence the latter formula has no immediate implication for the original 
quasiperiodic velocity field.
Despite this fact, Malhotra et al. (1998) propose to interpret stroboscopic images of scalar 
fields sampled at the period T = 2^Q1 using Birkhoff’s ergodic theorem. Specifically, they 
assert that for almost all initial conditions X0 = (x0; 0° taken from an ergodic invariant set S 
of the extended flow map Ft of system (4.5), we will find
Ct (x
c (x(s; x0°; s° ds ! const.
0
(4.8)

4.3 2D Recurrent Flows with a First Integral
113
as t ! 1. Based on this assumption, they suggest that for increasing t, level sets of ct 
defined as
Ct(S° = |x 2 R2 x Tm : Ct(xo° = 
C c(X) d4
m(S) S
will asymptotically highlight ergodic invariant sets S . Strictly speaking, this statement would 
actually be the converse of Birkhoff’s ergodic theorem which is generally not true. Indeed, 
asymptotically constant level sets of Ct (x0° do not necessarily delineate ergodic invariant 
sets of the flow. For instance, Ct(x0° = const. may hold for a set of initial conditions simply 
because they have not left a region in which the scalar c(x, Qt° has a constant value.
Also note that Ct (x0° ! const. will certainly hold on points of all the (non-ergodic) stable 
manifolds of fixed points, periodic orbits and quasiperiodic invariant tori of the flow. This 
effect, however, is unrelated to ergodic theory, as the flow map is not ergodic on stable 
manifolds. Rather, the effect follows from the continuity of the observer field c(x, Qt°, whose 
average along trajectories in such a stable manifold will converge to its average taken over the 
target set (a fixed point, a periodic orbit or an invariant torus) that these trajectories approach. 
Stable manifolds in incompressible flows, however, have measure zero. As a result, numerical 
computations on a finite grid will not be able capture the time-asymptotic constancy of Ct (x0° 
on stable manifolds.
One may nevertheless look for indications of mixing regions and barriers around them by: 
(1) releasing trajectories of the quasiperiodic velocity field (4.4) at time t = 0 (or at a fixed 
initial time t = t0) from an initial grid of x0 points; (2) averaging a scalar field c(x, Qt° along 
these trajectories; and (3) identifying constant level sets of the resulting function Ct(x0° at 
times tk = t0 + kT = 2nk/Q1 for k = 1,2,.... The times required for the convergence of 
temporal averages to spatial averages can be long, which may lead to a deterioration of the 
quality of the plot of Ctk (x0° over time. This is especially true along an envisioned ergodic 
set S that has a dimension less than the dimension of the Poincare section St0. As a result, 
points of the initial condition grid are contained in S with probability zero.
Figure 4.15 shows the results from this visualization procedure, obtained by Malhotra 
et al. (1998), for a planar quasiperiodic velocity field with two frequencies. The observable 
field chosen by these authors was simply c(x, Qt° = v(x, y, Q1t, Q2t°, the y-component of the 
velocity field v of a quasiperiodically disturbed steady meandering jet model. As anticipated, 
the plots suggest both mixing regions and hyperbolic transport barriers formed by stable 
manifolds of quasiperiodic tori with incommensurate frequencies. Note that unlike all other 
results discussed in this chapter, selecting c(x, Qt° to be a velocity component renders this 
visualization procedure frame dependent even if the Euclidean frame change family (3.5) is 
restricted to be T -periodic in time.
4.3 2D Recurrent Flows with a First Integral
Two-dimensional steady incompressible flows have a stream function ^(x), whose level 
curves (stream lines) contain all trajectories, as we have inferred from the conservation law 
(2.5). This set of level curves gives the complete family of advective transport barriers for 
such a steady flow by Definition 4.1. Indeed, trajectories of a steady flow are precisely the 
invariant curves of any time-T map associated with the flow.

114
Barriers to Chaotic Advection
Figure 4.15 Contours of the ct(x0) function computed by averaging the vertical 
velocity component c(x,ft° = v(x,y,Q| t,0.21° along trajectories of a planar, me­
andering jet under quasiperiodic disturbances. The times shown are multiples of 
T = 2^/Q1. Level sets of ct (x0 ° suggest ergodic mixing regions and highlight stable 
manifolds of saddle-type quasiperiodic invariant tori. Adapted from Malhotra et al. 
(1998).
General unsteady flows also admit conserved quantities (or first integrals), but those 
integrals generally do not help in identifying transport barriers. For instance, for any unsteady 
velocity field v(x, t° with a flow map Ft0, we can select an arbitrary scalar-valued, smooth 
function g(x° and obtain a time-dependent first integral of the form

4.3 2D Recurrent Flows with a First Integral
115
G(x, t° = g (Ft0(x)); 
(4.9)
given that
DG (x(t; 10, x0°; t° = d-g (Ft0 (x(t; 10, x0°°) = dg (x0° = 0: 
Dt (( 
0° ° 
dt t 
0°n dt (
This means that even chaotic flows have infinitely many time-dependent conserved quanti­
tates and hence their trajectories are typically confined to 2D level sets of these first integrals. 
Those level sets, however, generally become arbitrarily complicated, temporally aperiodic 
level surfaces in the extended phase space of the (x, t° variables, as illustrated in Fig. 4.16(a). 
While different level sets may not intersect, they may still stretch and fold to an arbitrary de­
gree, as well as accumulate on themselves and each other asymptotically in time. Therefore, 
unlike first integrals of steady flows, first integrals of general unsteady flows do not a priori 
impose any restriction on the flow and hence cannot be used to identify transport barriers.
Y (to,Io )± y
y 
Y(to + T,Io)
Y(to,Io)
Y (t,Io)
to + T
(a)
(b)
Figure 4.16 (a) A nondegenerate first integral I(x, t° (i.e., one with rI(x, t° . 0) of 
a general unsteady velocity field imposes no a priori topological restriction on the 
complexity of the trajectories. (b) A nondegenerate first integral I(x, t° of a temporally 
T -periodic velocity field confines particles to periodically varying surfaces of limited 
complexity.
I (x,t) = Io
I (x, t) = Io
t
4.3.1 Barriers from First Integrals in Time-Periodic Flows
In contrast to the general, temporally aperiodic case illustrated in Fig. 4.16(a), if I(x, t° = 
I(x, t + T° is the first integral of a time-periodic 2D velocity field v(x, Qt° with frequency 
Q = 2n!'T, then the level curves
y(t,10° := {x 2 R2 : I(x,t° = 10 = const.} = y(t + T,10°
periodically recur in the x-plane, as shown in Fig. 4.16(b). If, in addition, such a level curve 
is compact (i.e., closed and bounded) and nonsingular (i.e., rI(x, t° does not vanish on it), 
then y(x, t; 10° must be a smooth closed curve by the implicit function theorem (see §A.1).

116
Barriers to Chaotic Advection
If y(t; 10° is a closed curve for all t 2 R, then the family of level curves, I0 = {y(t, 10°gt2R, is 
a 2D time-periodic surface in the (x, t°-space. Topologically, I0 is the product of two circles, 
i.e., a 2D torus that is invariant under the flow generated by v(x; t°. Therefore, with the help 
of the periodic phase variable = t, we conclude that closed and nonsingular level curves 
of a first integral I(x; t° confine trajectories of the extended dynamical system
X = V(X; ft), 
0 = Q
(4.10)
to 2D invariant tori. In other words, a velocity field v(X; Qt° with a T -periodic, nondegenerate 
first integral I(X; t° is integrable: its trajectories within nonsingular and bounded level sets of 
I(X; t° are confined to invariant tori, and hence are either periodic or quasiperiodic in time. 
This is also the conclusion of the Brown-Samelson theorem (Brown and Samelson, 1994) 
obtained using a different approach. The intersection of each of these tori with a t = t0 
Poincare section is a closed invariant curve for the Poincare map Pt0 (see Fig. 4.16(b)), and 
hence each closed, nondegenerate level set of I(X; t° is an advective transport barrier by 
Definition 4.1.
Nonsingular level sets of time-periodic first integrals in 2D flows, therefore, contain 
periodic or quasiperiodic motions. Even if the first integral has isolated singularities (i.e., 
isolated zeros for its gradient), the trajectories are confined to 2D surfaces with singularities. 
If, however, I(X; t° is constant on a full open region of the flow, then it has no well-defined 
level surfaces in that region and hence trajectories may display complicated, or even chaotic 
motion.
Example 4.2 As discussed in Chapter 3,the 2D, time-periodic velocity field, 
v(X;t° =
- sin ct 
cos ct - a
cos ct + a x 
y2 - x2
- b
sin ct y 
2xy
(4.11)
is a solution of the 2D Navier-Stokes equation for any value of the viscosity v (see Pedergnana 
et al., 2020). This means that this vector field is also a solution for = 0, and hence solves 
the 2D version of the Euler equation (2.16) for inviscid fluids. As we deduced from formula 
(2.69) in Chapter 2, the scalar vorticity !z(x, y° = @xv(x, y° - @yu(x, y° is a first integral for 
any planar inviscid velocity field, and hence for (4.11) as well. Computing the vorticity for 
this velocity field, we obtain from (4.11) that
!z (x, y° = -2 a = const.,
and hence the vorticity is a constant (i.e., degenerate) first integral for this time-periodic 
velocity. Therefore, trajectories are not confined to level sets of !z and may, in principle, be 
chaotic. Indeed, Fig. 2.23 shows a parameter configuration in which the Poincare map of this 
flow has a homoclinic tangle, which implies chaotic dynamics. At the same time, there can 
be other nonsingular first integrals for certainparameter values that force the trajectories to 

4.3 2D Recurrent Flows with a First Integral 
117
be regular. For instance, for a = 1/2, b = 0 and c = -2; a first integral I(x, t° of the system is 
given by1
Kx t\ = 1 (x TnATt(t)x) 
Tt} = I cos2t 
~ sin2t 'j a = ( ~5/2 
0 'j
I(x;t° 
2 \x; T(t°AT (t°x); 
T(t° sin21 cos21 
’ A 0 
-1/2 
:
(4.12)
The gradient rI(x, t° = T(t°ATT(t°x only vanishes at x = 0, because both T(t° and A are 
nonsingular matrices. Furthermore, for any fixed t, the level curves of I(x, t° are closed and 
hence all level sets of I(x, t° are compact in the extended phase-space of system (4.10). 
Therefore, by the Brown-Samelson theorem applied to I(x, t°, all nonequilibrium trajectories 
of the velocity field (4.11) are periodic or quasiperiodic orbits on 2D invariant tori, each 
of which forms an elliptic transport barrier. Figure 4.17 confirms the existence of elliptic 
barriers despite the saddle-type dynamics suggested by instantaneous streamlines.
X 
X
Figure 4.17 (a) Orbits of the time-periodic inviscid velocity field (4.11) lie on 2D, 
quasiperiodic invariant tori. (Parameter values: a = 1/2, b = 0 and c = -2.) (b) In 
contrast, instantaneous streamlines of the velocity field (4.11) suggest saddle-type 
dynamics at all times. Adapted from Pedergnana et al. (2020).
4.3.2 Barriers from First Integrals in Time-Quasiperiodic Flows
While time-periodic velocity fields have a limited ability to approximate real-life fluid flows, 
time-quasiperiodic velocity fields can approximate general unsteady velocity fields closely 
over a time interval of interest. We recall from §2.2.12 that temporally quasiperiodic 2D 
velocity fields are of the form
x = v(x, Qt°; 
t 2 R, 
(4.13)
1 This I(x; t° can be found by transforming the time-periodic velocity field for x(t° into a steady velocity field in a 
rotating frame. That can be achieved via the transformation x = T(t°y using the time-dependent rotation tensor 
T(t) defined in the system (4.12). The stream function for the velocity field in the y-coordinates can be identified 
as <^(y) = 2 hy; Ayi, which is conserved along the y(t° trajectories. This implies that I(x; t) = </< (T 1 (t)x) = 
^j (TT(t)x) = 2 (x; T(t)ATT(t)x) is a conserved quantity for system (4.12).

118
Barriers to Chaotic Advection
where the frequency vector Q = (Q1;..,; Qm° satisfies the non-resonance condition
h; ki , 0 
(4.14)
for all nonzero integer vectors k. We assume that the flow is incompressible and hence 
the velocity field admits a stream function ^(x; Qt). We now also assume that a nontrivial 
conserved quantity exists, i.e., there is a temporally quasiperiodic scalar-valued function 
I(x, Qt° that satisfies
I (x(t; t0, x0°, Qt° = const. 
(4.15)
on all trajectories x(t; 10, x0° of the system (4.13). Differentiation of Eq. (4.15) with respect 
to t gives
@X11@X20 - @X21@xi + + @t I = 0: 
(4.16)
In analogy with the periodic case, this system can also be extended into a higher­
dimensional but autonomous dynamical system by introducing the phase variable vector
0 = (Qi t;:::; Q,m t )2 T“ : 
(4.17)
Then, as we have already noted in §2.2.12, we obtain the (m + 2°-dimensional differential 
equation
X = V(X; 0°; 
(4.18)
0) = Q;
which is the generalization of system (4.10) from the time-periodic to the time-quasiperiodic 
case.
As we noted in §2.2.12, not all trajectories of the autonomous system (4.18) represent 
trajectories of the original nonautonomous system (4.13). Indeed, while the phase vector 0 
can take any initial condition 00 at time t0 in the extended system (4.10), initial phases in 
the original flow represented by system (4.13) must fall in the one-parameter family of initial 
conditions
00(t0° = (Q1t0;...;Qmt0° 
(4.19)
parameterized by t0 .
Another important feature of system (4.13) is the existence of m -1 independent conserved 
quantities, or first integrals, of the form
Ij (0° = Qj fa - Qi ^j; j = 2;:::; m; 
(4.20)
as noted by Brown (1998). Note that by the constraint (4.19), we have Ij(0° 0 for all j, 
and hence only the zero level sets of the first integrals Ij (0° are relevant for the original 
flow (4.13). Each such zero level set forms an (m - 1°-dimensional torus within Tm. Since 
the gradients @ Ij (0° are all linearly independent from each other, their joint zero level set 
is locally a one-dimensional manifold by the implicit function theorem (see Appendix A.1), 
i.e., a single trajectory on Tm . This trajectory is dense in Tm by the non-resonance assumption 
(4.14). Consequently, the trajectories of the extended system (4.18) that represent trajectories 
of the original quasiperiodic system (4.13) form a dense subset in the phase space R2 Tm. 
Note, however, that this subset still has measure zero in the phase space. Consequently, 
measure-theoretic considerations yielding results on sets of full measure in the extended 

4.3 2D Recurrent Flows with a First Integral
119
01
-1 0 ;
dynamical system (4.18) generally do not carry over to the original quasiperiodic velocity 
field (4.13) as we have already indicated in §§2.2.12, 2.2.14 and 4.2.2
2 The same issue does not arise in the extension (4.10) of a time-periodic vector field v(X; Qt° because one can 
simply restrict attention to the first return map associated with the initial phase 0(t0° = Qt0 of this extended 
system. All orbits of this first-return map will describe sampled trajectories of v(x, Qt°. In contrast, a Poincare 
map constructed as a first return map along one of the phases k of the quasiperiodic system (4.18) will have 
only a measure zero (albeit dense) set of orbits that describe sampled trajectories of v(X; Qt°; as one concludes 
from the constraint (4.19) that such trajectories must satisfy.
One can make use of classic results for integrable Hamiltonian systems by further enlarging 
the system (4.18) into an (m + 1 °-degree-of-freedom Hamiltonian system (see Appendix A.5). 
This can be achieved by introducing a new momentum-type variable p 2 Rm that is canon­
ically conjugate to the phase variable . To this end, we define a Hamiltonian H and the 
canonical symplectic matrix J as
H (X; P; 0° = |/<(X; ^ + h ^; pi ; J =
which generates the autonomous, canonical Hamiltonian system
X = J@X H (X; 0° = J@xlf/ (X; 0°;
0) = @p H(X; P; 0° = fi;
P = ~@^ H (X; P; 0° = ~@^/ (X; P; 0°: 
(4.21)
As for any autonomous Hamiltonian system, the Hamiltonian
I1(X; P; 0° = H(X; P; 0° = (X; 0° + hfi; Pi 
(4.22)
is conserved and hence is automatically a first integral. The conserved quantity assumed in 
condition (4.15) provides the additional first integral
Im+1(X; 0° := I(X; 0°: 
(4.23)
Therefore, we have a total of m + 1 first integrals, defined in Eqs. (4.20),(4.22) and 
(4.23), for the (m + 1°-degree-of-freedom Hamiltonian system (4.21). The gradients of these 
integrals,
rI1 = @XH; @ ; fi ;
rIj=
r Im+1
(j)
0 ; (Qj; 0;:::; 0; -^J, 0;:
|{2z} | 
{z
m
@XI; @I; 0 
;
|{z}
m
0z}
m
; j=2;::: m;
(4.24)
are all linearly independent as long as
@XH,0; 
@XI(X;0° ,0; 
(4.25) 

120
Barriers to Chaotic Advection
i.e., as long as we are away from instantaneous stagnation points and I(X;0° has explicit 
dependence on the positions x. Furthermore, the pairwise Poisson brackets
[ Ii; Ij ] = @X1 Ii @X2 Ij - @X2 Ii @X1 Ij + (@^ Ii; @p Ij ) - {@4, Ij; @p Ii ) ; 
i + j
of the first integrals satisfy the relations
[Ii;Ij=0; i;j , 1;
* 
(j° 
+
[Ii; Ij] = - (Qj; 0;:::; 0; -Q1, 0;::: ), ^ = 0; i = 1; j + ffl. + 1;
| 
{z 
}
m
* 
(j° 
+
[Ii; Ij] = (Qj; 0;:::; 0; ~^1; 0;: : : \ ^ = 0; j = 1; i + ffl. + 1;
| 
{z 
}
m
»11; Im+1 ] = @x111 @x21m+1 - @x211 @x11m+1 ~ @^IIm+1; @p 11)
= @x1 <A@x2 I - @x2<A@X11 - @tI = 0; 
(4.26)
where we have used the conservation law (4.16). In the language of classical mechanics, 
therefore, the first integrals I1;:::;Im+1 are pairwise in involution (see Arnold, 1989).
In summary, by the relations (4.24) and (4.26), the (m+1)-degree-of-freedom Hamiltonian 
system (4.21) has m + 1 independent first integrals in involution on any domain where the 
two conditions in (4.25) are satisfied. Since I2;:::;Im are defined on the m-dimensional torus 
Tm , a joint level set of the m + 1 integrals is closed and connected precisely when the joint 
level set of I1 and Im+1 ,
I(a; b° = f(X; t; p° : (X; t° + h; pi = a; I(X; 
t° = bg ;
is closed and connected. Then, as long as the conditions (4.25) hold on the joint level set 
I (a; b°, this level set is diffeomorphic to an (m + 1°-dimensional torus in the 2(m + 1°- 
dimensional phase space of (X; 0; p°, as proven by Arnold (1989) for general Hamiltonian 
systems. In that case, the Hamiltonian system is called (completely) integrable. We recall, 
however, that as we have concluded in our discussion after the conservations laws, only 
a single trajectory in each joint level set I (a; b° is relevant for the original quasiperiodic 
velocity field v(X; t°.
Intersections of such an (m + 1°-dimensional torus with the (m + 2°-dimensional plane 
f0 = 00g in the 2(m+1°-dimensional phase space will typically give one-dimensional closed 
material lines in the phase space of the original system (4.13). These closed material lines 
evolve quasiperiodically in time and hence do not satisfy Definition 4.1.Nevertheless, these 
material lines are exceptional in their quasiperiodic time dependence, which distinguishes 
them from typical material lines. Indeed, quasiperiodically evolving material lines reapproach 
their initial shape with arbitrarily high accuracy while blocking advective transport between 
their interiors and exteriors. Examples of flows admitting such quasiperiodic advective bar­
riers are quasiperiodic potential vorticity conserving flows in geophysics, or quasiperiodic, 
planar inviscid flows, which conserve their vorticity (see, e.g., Haller and Mezic, 1998).

4.4 3D Steady Flows
4.4 3D Steady Flows
121
Here, we discuss how the ideas developed for transport barriers in 2D steady flows can be 
applied to define and detect barriers in 3D incompressible steady flows given by
x = v(x°; 
r ■ v(x° = 0; 
(4.27)
with x 2 R3 . For such an autonomous differential equation, trajectories evolve under a flow 
map that is a one-parameter family of transformations, Ft(x0° = x(t; 0; x0°; as we discussed 
in relation to system (2.18).
4.4.1 Definition of Transport Barriers from First-Return Maps
Using a 2D Poincare map PE: E ! E defined on a 2D transverse section E (see §2.2.12), 
we can proceed as in the case of time-periodic velocity fields to define advective transport 
barriers for 3D steady flows. Specifically, we can adapt Definition 4.1 to 3D steady flows as 
follows:
Definition 4.3 An (advective) transport barrier of a 3D steady flow (4.27) is a material 
surface whose intersection with a section E transverse to v is a structurally stable invariant 
curve of the Poincare map PE.
Our discussion and classification of hyperbolic, elliptic and parabolic barriers in §§4.1.1- 
4.1.3 are then also directly applicable in the present context. This means that all possible 
barriers and partial barriers to transport shown in Fig. 4.12 will arise in the Poincare maps 
of generic 3D steady fluid flows. They can then be extended by the flow map to barriers in 
the full 3D flow.
For instance, a closed invariant curve (elliptic transport barrier) of a first-return map PE 
gives rise to a 2D invariant torus, which in turn acts as an elliptic transport for the full 3D 
steady flow, as sketched in Fig. 4.18.
To show such barriers in a physical flows, Fig. 4.19 depicts a dye visualization of such 
a torus barrier family, along with numerical simulations of a first-return map capturing the 
family as closed curves. Also highlighted by the map are four islands born out of a 1:4 
resonance. These islands are filled with more localized toroidal barriers similar to those 
discussed in §4.1.2.
4.4.2 Transport Barriers vs. Streamsurfaces and Sectional Streamlines
All 2D transport barriers defined via Poincare maps in §4.4.1 are composed of fluid trajec­
tories and hence are also streamsurfaces of the steady velocity field v(x°: Given that fluid 
trajectories starting off of a streamsurface cannot cross that streamsurface, it is tempting to 
think that all streamsurfaces are observed transport barriers in experiments.
This is, however, far from being true. Trajectories released from points along any smooth 
curve of initial conditions form a streamsurface, and hence any point of any steady flow is 
on infinitely many different streamsurfaces. Using such arbitrary streamsurfaces to explain 
distinct transport patterns, such as those seen in Fig. 4.19 is, therefore, unrealistic. Indeed, 
while all transport barriers in steady flows are streamsurfaces, only very special streamsur­
faces will act as transport barriers. In particular, trajectories in a typical streamsurface will

122
Barriers to Chaotic Advection
transport barrier 
for the 3D flow
closed invariant curve 
for the Poincare map
Figure 4.19 Transport barriers in a 3D steadmoyre thv
an esevelnohocursiatfteyr needfile reemlovdal created by a rotating, 
tilted impeller in a cylindrical tank. (a) 3DsTuhrvefarceiea)ed. eTwrhiiss dpirrooebcltef
emd tcoaanSobuevsaelxiiaonctiesrg
,bJaatlnee
da b&yO2
pottoD
inrogr(i1d9i9d5n
e)sifgvonraoardrpisoicouarsscnioonnt
veorfgtt
ehnoecsee.rus 
visualized by red dye. (b) Cross-sectional view of a vortical region filled with invariant 
tori and resonant islands, obtained by shining a laser sheet across the toroidal region 
on different types of fluorescent dye injected earlier. (c) Simulation of the Poincare 
map based on the same cross section using a numerical model of this flow. Adapted 
from Fountain et al. (2000).
Figure 4.18 Sketch of the reconstruction of a 2D elliptic barrier (invariant torus) to 
advective transport from a 1D elliptic barrier (invariant closed curve) of a Poincare 
map defined on a section transverse to the flow. Adapted from Oettinger (2017).
not keep re-intersecting Poincare sections along the exact same curve and hence will not 
satisfyDefinition 4.3for a transport barrier.
An outstanding challenge in the flow visualization community is to construct streamsur­
faces that give a meaningful skeleton of the transport patterns in the flow (see, e.g., Peikert 

4.4 3D Steady Flows
123
and Sadlo,2009;Born et al.,2010;Sane et al., 2020). From a dynamical systems point of 
view, this is equivalent to finding 2D invariant manifolds in the flow that are either compact 
and boundaryless (spheroids and tori) or have a strictly inflowing or a strictly overflowing 
compact boundary (subsets of 2D stable and unstable manifolds of fixed points or periodic 
orbits).
Finding such invariant manifolds is an unsolved problem at this point, but Mackay (1994) 
has an insightful characterization of invariant manifolds relevant for transport in 3D steady 
flows. He examines under what conditions renders a general 2D manifold S the flux functional
O( S ° =
v dA
(4.28)
of v through s stationary with respect to small deformations of s. In more technical terms, 
when does the variational derivative 5O(S° vanish on a surface S ? Mackay finds this to be 
the case if and only if both s and its boundary, @s, are invariant under the flow of v. In 
other words, streamsurfaces that either have empty boundaries or have boundaries that are 
trajectories of v are the stationary surfaces of the flux O(S°. Examples of such surfaces are 
shown in Fig. 4.20.
Figure 4.20 Examples of special streamsurfaces S that render the flux O(S° of 
the velocity field v(x° stationary with respect to all small deformations of S. Such 
streamsurfaces are precisely those with boundaries @S composed of streamlines and 
boundaryless streamsurfaces, such as a torus.
While this result does not provide a recipe for finding transport barriers, it highlights 
the significance of streamsurfaces with empty or invariant boundaries for material transport. 
Namely, in a well-defined sense, such surfaces are the most robust transport barriers in steady, 
volume-preserving flows. Indeed, small O (e° deformations of these surfaces result in at most 
O (e2) material transport through the deformed surfaces. In contrast, O (e° deformations of 
streamsurfaces with a non-invariant boundary will generally result in O (e° transport through 
them due to O (1° flux through their boundaries prior to the deformation.
Streamsurfaces with 5O(S° , 0 do not generally preserve their integrity while one tracks 
them along evolving streamlines. Indeed, consider a streamsurface formed by streamlines 
launched along a stable or unstable manifold, such as those in Fig. 4.5,participating in a 
homoclinic or heteroclinic tangle of a first-return map based on a section : Such a stream­
surface, the unstable manifold of a periodic streamline, , will undergo drastic stretching 
and folding, ultimately accumulating on itself by the -lemma that we mentioned in §4.1.1 
in our discussion of hyperbolic transport barriers in 2D flows. We sketch a part of such a 
tangling streamsurface in Fig. 4.21; the full streamsurface will accumulate on itself arbitrarily 
tightly.

124
Barriers to Chaotic Advection
Figure 4.21 A subset of a self-accumulating streamsurface, S, in a steady flow. This 
surface is formed by streamlines launched along the unstable manifold Wu (p° of a 
hyperbolic fixed point p of the first-return map P, defined on a transverse section 
. The hyperbolic fixed point of the map signals a hyperbolic (saddle-type) closed 
streamline, , for the velocity field v(x°: The streamsurface S coincides with the 2D 
unstable manifold Wu (° of .
Such 2D streamsurfaces are hyperbolic transport barriers by Definition 4.3.They provide 
the backbones of tracer patterns outside vortical regions, even though they do not fall in the 
variationally distinguished family of streamsurfaces shown in Fig. 4.20.
A more traditional but less justifiable approach to visualizing transport and its barriers in 
3D flows is the use of sectional streamlines. Such streamlines are obtained by considering 
a section (plane or surface) in the flow domain, projecting the velocity vectors at points 
of this section orthogonally onto the section, and drawing the streamlines of the resulting 
projected velocity field on the section. This procedure is only justifiable if the selected section 
is a streamsurface in which case sectional streamlines are actual streamlines. Otherwise, 
the relationship between sectional and actual streamlines is a priori unclear: the sectional 
streamlines may or may not give an indication for the one-dimensional intersection of 2D 
transport barriers with the selected section. An early reference emphasizing the dangers of 
reliance on sectional streamlines is Perry and Chong (1994).
We illustrate the unreliability of sectional streamlines for flow structure detection using 
the ABC flow (Gromeka, 1881;Arnold, 1965;Dombre et al., 1986), whose velocity field, 
vx
Asinz + Ccosy 
B sin x + A cos z 
C sin y + B cos x
(4.29)
is an exact, spatially triple-periodic solution of the steady, incompressible Euler equation 
(A.39) (see Dombre et al., 1986). This flow is the classic example ofa steady Euler flow with 
chaotic streamlines, an atypical phenomenon in steady inviscid flows, which are generically 
integrable (see §4.4.3 below).

4.4 3D Steady Flows
125
On the y = 2n face of the »0; 2n] x »0,2n] x »0,2n] cubic domain shown in Fig. 4.22, 
the sectional streamlines give a reasonable indication of some (but not all) elliptic barriers 
revealed by the Poincare map. These transport barriers in the map give rise to 2D toroidal 
transport barriers in the full flow. Even on this face of the cube, however, there is no indication 
of the resonant islands or the parabolic transport barrier separating two mixing regions around 
the toroidal region. On the other two faces of the cube, none of the further elliptic barriers, 
resonant islands or mixing regions are indicated by sectional streamlines.
sectional streamlines
Figure 4.22 Sectional streamlines vs. trajectories of Poincare maps computed on 
three faces of the ABC flow, the triply-periodic solution (4.29) of the steady Euler 
equation with A = p3, B = p2 and C = 1. Adapted from Haller et al. (2020b).
Poincare maps
4.4.3 Transport Barriers in 3D Steady Inviscid Flows
Three-dimensional incompressible, inviscid flows are governed by the Euler equation, the 
zero-viscosity limit of the Navier-Stokes equation. If such a flow is also steady, then its 
velocity field obeys the steady Euler equation
p (Vv° v = -r( p + V °; 
(4.30)
appended with the incompressibility equation r v = 0: Equation (4.30)involves the steady 
velocity field v(x°, the pressure field p(x), the constant density p and the scalar potential 
function V(x), which generates the vector field g of potential forces via the relationship 
pg(x° = -r v (x°.
Taking the inner product of both sides of Eq. (4.30) with v(x° and integrating along any 
trajectory x(t; x0° of v(x), we obtain
B (x(t; xo°° = B (xo° 
(4.31)
for any time t, where the scalar function B(x° is the Bernoulli integral
B = 2 pjvj2 + P + V; 
(4.32) 

126
Barriers to Chaotic Advection
representing the total energy of the fluid. The conservation law (4.31), therefore, reflects the 
conservation of energy for fluid elements along the streamlines of v.
If the Bernoulli integral B(x) is a nonconstant function, then the streamlines (trajectories) 
of v are confined to lower-dimensional level sets of B(x). In that case, the ODE (4.27) 
is called integrable. Such integrable systems defined on compact domains cannot have 
chaotic trajectories because their trajectories are restricted to smooth and bounded 1D or 2D 
manifolds.
Crucial to this argument is that the level sets of B(x) should indeed be compact. Their 
boundedness is guaranteed if the flow domain is spatially periodic or enclosed by finite 
boundaries. One must also ensure, however, that the level surfaces of B(x) are manifolds. 
This is locally the case by the implicit function theorem (see Appendix A.1) at all points 
where the gradient rB does not vanish. Computing this gradient gives
r b = p (rv°T v + r (p + v ° = p [(rv°T v - (rv° v]
= -2pWv; 
(4.33)
where we have used the Euler equation (4.30) and the definition of the spin tensor W from 
Eq. (2.1).By the relationship of W to the vorticity vector ! (see Eq. (2.2)), we can rewrite 
formula (4.33) for the gradient rB as
rB = pv !: 
(4.34)
Therefore, at any point x in the flow, r B is nonvanishing (and hence the level set of B(x) is 
locally a smooth, 2D manifold) if the velocity and the vorticity at that point are not collinear, 
i.e.,
v(x° x !(x° , 0: 
(4.35)
Arnold (1966) proves (see also Arnold and Keshin, 1998) that if the relation (4.35) holds 
on an invariant flow domain and v and ! are sufficiently smooth, then all fluid trajectories in 
that domain are confined to nested families of invariant tori or nested families of boundaryless 
invariant cylinders (deformations of open annuli), as shown in Fig. 4.23.
Figure 4.23 also illustrates how we can select transverse sections, , to both types of 
streamsurface families and obtain repeated returns of trajectories to the intersection curves 
of these families with S. As these curves are invariant curves for the Poincare maps based 
on , the surfaces shown in Fig. 4.23 are barriers to advective transport by the definition we 
gave in §4.4.1.
While each toroidal barrier is disjoint from the singular sets with v x ! = 0, the closures 
of the boundaryless cylindrical barriers intersect those singular sets. By the continuity of 
B(x°, any bounded singular set is contained in the same level set of B(x° as the boundaryless 
cylinder whose closure intersects that singular set.
Interestingly, B(x° is also a first integral for vortex lines, i.e., trajectories of the vorticity 
field ! , which are solutions of the ODE
x0 = !(x°;
with the prime denoting differentiation with respect to a scalar variable s parametrizing the 
vortex lines x(s°. Indeed, by formula (4.34), the derivative of B(x° along vortex lines is

4.4 3D Steady Flows
127
Figure 4.23 The two possible transport barrier configurations in typical velocity 
fields solving the steady, incompressible Euler equation (4.30):(a) nested family of 
2D invariant tori; (b) nested family of open cylindrical surfaces (open annuli). These 
two types of transport barriers foliate open cells in the flow that are bounded by 
singular surfaces on which rB = v ! vanishes.
dB
---- = r B ■ ! = - P (! X V° • ! = 0; 
ds
and hence B is conserved along them. Therefore, under condition (4.35), the tori and bound­
aryless cylinder shown in Fig. 4.23 are also invariant surfaces for the vortex lines of v(x).
Example 4.4 A classic explicit solution of the Euler equation (4.30) is Hill’s spherical 
vortex (Hill, 1894), whose velocity field is
v(x
x xz 2cy2 
\
z x2+y2
2cx
y z + x2+y2
« 1 - 2 (X2 + y2) - z2 ?
(4.36)
with x = (x; y; z), with the arbitrary constant c and with the corresponding vorticity field
( ~5y \
! = r X v = 
5 X
0
(4.37)
With the nondimensionalized density set to P = 1, we obtain the gradient of the Bernoulli 
integral B as 
rB=vX!
5 5x [2 (x2 + y2) + z2 
5y [2 (x2 + y2) + z2
V 5 z (x2 + y2)
1
1]
/
(4.38)
which gives
B(x° = 5 [(x2 + y2°2 + (x2 + y2°z2 - (x2 + y2°] : 
(4.39)
As we have seen in this section, for incompressible and steady Euler flows, B(x) is always 
a first integral for both the velocity and the vorticity fields, and its nonsingular bounded level 
sets must fall in one of the two categories shown in Fig. 4.23.As rB in Eq. (4.38) only 
vanishes along the z axis, all level surfaces of B(x) that have a finite distance from the z-axis 

128
Barriers to Chaotic Advection
are necessarily 2D tori by the integrability results of Arnold (1966). By introducing the polar 
coordinates (r, ‘° via x = r cos ‘, y = sin ‘, we can rewrite B(x) in Eq. 44.40)ss
B(r; z° = 2r2 [r2 + z2 - 1], 
(4.40)
whose level curves in the (x; z)-plane are shown in Fig. 4.24(a).
Figure 4.24 Transport barriers in Hill’s spherical vortex. (a) Level curves of the 
Bernoulli integral reveal transport barriers for the first-return map defined on the 
vertical plane S = f(x, y, z° : y = 0g. (b) Dye experiment showing invariant tori in a 
near-inviscid vortex ring modeled by Hill’s spherical vortex. Adapted from Lim and 
Nickels (1995).
These level curves are independent of' and depict the intersections of the level surfaces of 
B with an arbitrary vertical plane ' = const: containing the z-axis.Figure 4.24(a) shows that 
all level surfaces of B within the unit sphere are indeed 2D tori, as each has a finite distance 
from the z-axis. In contrast, neither the unit sphere without its northern and southern pole 
nor the level surfaces outside the unit sphere are bounded away uniformly from the z-axis. 
Accordingly, they all are topologically boundaryless cylinders of the type shown in Fig. 4.23. 
The cross section of a dye experiment confirming the toroidal transport barriers inside a 
vortex ring is shown in Fig. 4.24(b).
Any steady Euler flow satisfying the Beltrami property
v(x° X !(x) = 0 
(4.41)
on some open domain D will violate the integrability condition (4.35). For such flows, 
the gradient of B(x) is identically zero by formula (4.34), rendering the Bernoulli integral 
constant on D. One may still obtain a first integral arising from the Beltrami property (4.41) 
given that this property is equivalent to
!(x) = n(x°v(x° 
(4.42)
for some scalar-valued function a(x°. Since the divergence of the vorticity field is always 
zero, we can write

129
4.4 3D Steady Flows
r! = r v + rv = 0: 
(4.43)
We have assumed the flow to be incompressible, therefore using r v = 0 inEq. (4.43) gives
r v = 0; 
(4.44)
implying that nondegenerate level sets of a(x° are invariant surfaces for v, even though B(x) 
is constant.
This argument, however, fails when r vanishes on the flow domain, which is the case 
for strong Beltrami flows defined as
!(x) = u0v(x>: 
(4.45)
For such flows, no general nontrivial first integral arises from Eqs. (4.33) or (4.44). Even 
in that case, the particle ODE (4.27) might still have another, nontrivial first integral that 
enables the explicit construction of transport barriers (as level surfaces of that integral) 
without numerical simulations, as in Example 4.4.Such a first integral is often related to 
flow-specific symmetries, such as those we will discuss in §4.4.4.In the absence of such a 
first integral, Poincare maps remain effective tools for barrier exploration in strong Beltrami 
flows, even though their construction will require the numerical solution of fluid trajectories 
starting from arrays of initial conditions.
Example 4.5 Arnold (1965) introduced the ABC flow (4.29) as an example of an inviscid, 
incompressible flow in which the strong Beltrami property (4.45) holds with 0 = 1 on the 
whole flow domain. As a consequence, the Bernoulli integral B(x° and the Beltrami scalar 
a(x° are both globally constant and hence cannot be used to construct transport barriers in 
the way that we have done for Hill’s spherical vortex in Example 4.4.
For A = V3, B = V2 and C = 1, the Poincare maps shown in Fig. 4.22 indeed suggest that 
the ABC flow has chaotic trajectories and hence cannot be integrable. We observe nested but 
discrete families of tori as transport barriers for this flow. Beyond these nested barriers, there 
are 2D stable and unstable manifolds (hyperbolic barriers) in the seemingly chaotic mixing 
zone outside the elliptic barriers.
To visualize hyperbolic barriers in mixing zones, one would first have to locate saddle­
type fixed points of the Poincare map and then iterate the map on a set of initial conditions 
close to the fixed points in forward time to see that set shrink onto, and spread out along, 
one-dimensional unstable manifolds of those fixed points. A similar procedure under back­
ward iteration of the Poincare map would highlight one-dimensional stable manifolds on 
Poincare sections. The full 2D barriers of the flow could then be constructed by releasing 
trajectories of the velocity field (4.29) from along the stable and unstable manifolds of its 
Poincare map.
All these steps are flow specific and hence would require substantial effort to automate. In 
the end, a more efficient approach is to use the transport barrier detection techniques we will 
discuss in Chapter 5 for general, unsteady velocity field. As a preview of those techniques, 
we compare in Fig. 4.25 a visualization of the ABC flow (4.29) via Poincare maps with 
two simple LCS diagnostics: the Lagrangian-averaged vorticity deviation (LAVD) and the 
finite-time Lyapunov exponent (FTLE). LCSs are distinguished material surfaces that form

130
Barriers to Chaotic Advection
the backbone curves of tracer patterns over finite times, as will be discussed in Chapter 5. 
Stable and unstable manifolds, as well as invariant tori, of flows defined for all times qualify 
as LCSs, and hence LCS methods will approximate them with increasing accuracy over 
increasing time intervals. Indeed, note in Fig. 4.25 the sharpness of the domains with elliptic 
barriers (invariant tori) and hyperbolic barriers (stable manifolds) revealed by level surfaces 
of the LAVD and high values of the FTLE, respectively, without any reliance on the location 
of fixed points of the Poincare maps.
z
Elliptic transport barriers from the 
Lagrangian-averaged vorticity deviation 
(LAVD)
Hyperbolic transport barriers from the 
finite-time Lyapunov exponent 
(FTLE)
Poincare maps
Figure 4.25 Transport barriers in the steady ABC flow (4.29) with A = V3, B = V2 
and C = 1, visualized by three different methods: Poincare maps, the lavd over the 
»0; 50] time interval and the FTLE computed over the »0,15] time interval. The latter 
two methods will be discussed in detail inChapter 5for more general (unsteady and 
finite-time) velocity fields.
4.4.4 Transport Barriers in 3D Steady Flows with a Continuous Symmetry
As we noted in §4.4.3, conserved quantities for 3D flows often arise from continuous sym­
metries. If the flow is steady and the conserved quantity (first integral) is nondegenerate, then 
level surfaces of the first integral are streamsurfaces that do not disintegrate due to stretching 
and folding as trajectories evolve in them. Such streamsurfaces can intersect Poincare sec­
tions in invariant curves and hence satisfy the formal Definition 4.3 we have been using for 
transport barriers in 3D steady flows.

4.4 3D Steady Flows
131
To find conditions for the existence of a first integral arising from symmetries, Haller and 
Mezic (1998) consider 3D steady vector fields v(x) on a general 3D manifold that preserve 
a general 3D volume. For simplicity, here we only consider such a vector field on a 3D 
spatial domain D c R3. We assume that the flow map Ft of v(x° is volume preserving and is 
equivariant with respect to a continuous group gs : D ! D of transformations parametrized 
by the scalar variable s. This means that
Ft (gs(x°° = gs (Ft (x°)
holds for all s; t 2 R. We call the vector field
w(x° := d- gs (x° 
;
ds 
s=0
the infinitesimal generator of the action of gs . The equivariance of the flow under gs is 
equivalent to the condition that the vector fields v and w have a vanishing Lie bracket, i.e.,
»V; w] := (rw° v - (rv° w = 0: 
(4.46)
We also assume that the symmetry group gs is volume preserving, i.e.,
r w = 0: 
(4.47)
Under the conditions (4.46)-(4.47), Haller and Mezic (1998) prove that both v(x° and w(x° 
admit a common first integral I(x), whose gradient satisfies
rI= vw: 
(4.48)
Note the close similarity between this last equation and formula (4.34). This shows that for 
the purposes of integrability, the infinitesimal generator of a symmetry of a general flow 
plays the same role as the vorticity of an inviscid flow.
Example 4.6 Consider the ABC flow (4.29), which we have seen to admit only a degenerate 
Bernoulli integral in Example 4.5, as any strong Beltrami flow does. This renders the ABC 
flow chaotic for most parameter values, Yet, for special parameter values, there may be 
other, nondegenerate first integrals for this flow that enable a systematic identification of 
all transport barriers without the numerical construction of Poincare maps. For instance, 
selecting C = 0, the corresponding abc vector field,
v(x
Asinz
B sin x + A cos z 
B cos x
(4.49)
is equivariant under the volume-preserving group of translations
/ 
gs : ©- xx
y 7! - y + s
(4.50)
zz
/
whose infinitesimal generator is
w(x° = 
gs (x'
ds
s=0
0
-0®
(4.51)
d

132
Barriers to Chaotic Advection
Indeed, we can verify this equivariance by evaluating the equivalent condition (4.46):
»V; w] = - (rv° W =
00
-© B cos x 0
y -B cos x 0
Acos z 
- a sin z 
0
0
®- 0 ®
= 0:
(4.52)
Then formula (4.48) gives the gradient of the first integral emerging from this symmetry in 
the form
/
rI = vw = ©-
Asinz
B sin x + A cos z
B cos x
0
x 1
® -0®
-B cos x 
0 
Asinz
(4.53)
Integrating this last formula, we obtain the first integral
I(x° = -(A cos z + B sin x°
(4.54)
noting that the first integral -1 (x° was already found heuristically by Dombre et al. (1986). We 
show the transport barriers obtained as level surfaces of I(x) in Fig. 4.26SSimilarintggaable 
cases arise for the parameter choices A = 0 and B = 0.
Figure 4.26 Transport barriers obtained as level surfaces of the first integral (4.54) 
arising from a volume-preserving symmetry of the ABC flow with A = V3; B = V2 
and C = 0. Image: courtesy of Roshan S. Kaundinya.
Most barrier surfaces in Fig. 4..6 are technically elliptic, as they are .D invariant tori 
(doubly periodic surfaces) of various types. Exceptions are the hyperbolic barriers formed 
by homoclinic manifolds connecting a saddle-type periodic orbit to itself.
A more complete description of integrable parameter configurations for the ABC flow is 
given by Llibre and Valls (.01.). Further examples of 3D integrable classes of flows are 
given in Haller and Mezic (1998) along with 2D time-dependent flows with first integrals.

133
4.4 3D Steady Flows
4.4.5 Transport Barriers from Ergodic Theory
A Poincare map PE: E ! E defined on a transverse section E of a volume-preserving 
or mass-preserving, 3D steady flow preserves an appropriately scaled version dA of the 
classic area element dA onE (see §2.2.12).This renders PE measure preserving onE, making 
Birkhoff’s ergodic theorem (§2.2.14) applicable to the study of the dynamics of PE via 
time-averaged observables.
Specifically, assume that on a compact subset S E, the Poincare map PE is ergodic with 
respect to some measure on S. Then, for any integrable scalar field c(x) defined on E, the 
asymptotic average
1N 
Cp(xo° := lim - Y c (PEk(xo)) 
N!1 N k=o
of c along trajectories of the map PE is well defined for almost all xo 2 S, as we have discussed 
in §2.2.14. For hiose x0 points, the trajectory average cPE(x0° is equal to the spatial average,
c(S° = “^ C c(x° d* 
(4.55)
t“(S° S
of c over S. This implies that such xo initial conditions must be contained in the level set 
C(S° = f c(x° = c(S°g of c(x).
In an experimental setting, however, first-return maps of individual fluid particles are 
unrealistic to construct and hence cPE (x0° cannot be evaluated. As an effective alternative, 
Sotiropoulos et al. (2002) construct what they term an experimental Poincare map for a 
3D steady swirling flow arising from the breakdown of a spherical vortex bubble. In these 
experiments (see Fig. 4.27(a)), a laser scans a selected cross section E of the swirling flow.
The resulting laser sheet illuminates within E an initially nonuniform concentration of 
fluorescent, weakly diffusive dye injected into the flow at an earlier initial time. The in­
stantaneous illumination intensities are photographed, recorded and time-averaged. These 
time-averaged intensities are then plotted over E, with one outcome of this procedure shown 
in the upper plot in Fig. 4.27(b).This plot bears close similarities to a classic Poincare map 
constructed earlier by Sotiropoulos et al. (2001) for a numerical model of the same flow.
Mezic and Sotiropoulos (2002) invoke Birkhoff’s ergodic theorem to argue that the 
experimental procedure used in generating Fig. 4.27(a) should indeed highlight the structures 
captured by a Poincare map. To see this, we denote the initial dye concentration at time t = to 
in the cross section E by the scalar field c0(x° for x 2 E. Ignoring the diffusivity of the dye, we 
can view the dye evolution as a purely advective problem governed by the conservation law 
Dc
Dtt = ct + rc v = o;
(4.56)
which is solved by c(x, t° = c0(F“t(x), t°. Sotiropoulos et al. (2002) record and time-average 
this field at each point x 2 E over a finite time interval »0, t], which means that they construct 
experimentally the function
ct(x) = 1f co (F“s (x)) ds:
t0

134
Barriers to Chaotic Advection
: YAG laser
PLIF data acquisition computer
(a)
H
Variable-speed motor
l*criud-
p
(b)
Figure 4.27 (a) The experimental setup for the study of a steady swirling flow with 
a broken-down spherical vortex (adapted from Sotiropoulos et al., 2002).fl(b) Time- 
averaged dye intensity in the cross section S and the classic Poincare map computed 
by Sotiropoulos et al. (2001) for a numerical model of this flow (adapted from 
Mezic and Sotiropoulos, 2002). These plots reveal both elliptic transport barriers and 
resonance islands of period 2, 3 and 4. The material envelope bounding the broken 
vortex is formed by a hyperbolic transport barrier, the unstable manifold Wu (p° of a 
saddle-type fixed point p of the Poincare map.
S
R
If the flow map is ergodic on a 3D domain S, then the Birkhoff-Khinchin ergodic theorem 
(2.87) implies
lim ct(x° = c(S° 
(4.57)
t!1
for almost all x 2 S, with the spatial average c(S° defined in Eq. (4.55). This, however, does 
not necessarily imply yet that Eq. (4.57) holds for any x 2 S, given that any 2D Poincare 
section S has zero measure (volume) in the 3D domain S. As a consequence, all initial 
conditions x 2 S may just be in the measure-zero set to which (4.57) does not apply.
The arguments given in Mezic and Sotiropoulos (2002) for the applicability of Birkhoff’s 
ergodic theory to this problem, therefore, need to be augmented with further considerations. 
If the flow has perfect circular symmetry around the main axis of its cylindrical domain, 
then if Eq. (4.55) holds at a particular point x 2 S, then it must also hold along the 
axially symmetric circle containing x. Therefore, Eq. (4.55) holds along almost all axially 
symmetric circles, which in turn intersect the Poincare section subset S \ S at almost all of 
its points. Therefore, under perfect cylindrical symmetry for the broken vortex bubble, the 
experimentally constructed quantity ct(x° will converge to c(S° at almost all points of S \ S, 
as long as the flow map Ft is ergodic on the 3D domain S . One will, therefore, indeed find 

4.5 Barriers in 3D Time-Periodic Flows
135
(almost all) points of perfectly mixing regions of the Poincare map PE : E ! E to approach 
the same color in the upper plot of Fig. 4.27(b) for large enough averaging times t. This is 
indeed confirmed by the numerically computed Poincare map in the lower plot of Fig. 4.27(b), 
which shows regions filled with clouds of points where the averaged dye concentration also 
approaches a constant value.
The asymptotic constancy of ct (x° on individual closed transport barriers C of the map 
PE requires a slightly different argument. As we have discussed, these closed curves are the 
intersections of2D quasiperiodic invariant tori T with E, as seen in Fig. 2.15. The flow map 
is ergodic restricted to these tori with respect to an appropriate 2D area measure defined on 
the tori. Therefore, Eq. (4.57) will hold at almost all points of such a two-torus T . These 
trajectories collectively produce intersections with the Poincare section E that cover almost 
all points of C . Therefore, at almost all points of a closed barrier C of PE, one should indeed 
asymptotically observe the same color in the upper plot of Fig. 4.27(b). This is in agreement 
with the actual Poincare map shown in the lower plot of the same figure.
Finally, the asymptotic constancy of ct (x° over the unstable manifold Wu (p° of a hyperbolic 
fixed point p of the Poincare map can also be concluded, albeit not from ergodic theory. 
Indeed, the inverse flow map F“t shrinks area exponentially (and hence cannot be ergodic) 
within the 2D unstable manifold Wu signaled by the invariant curve Wu (p°. However, all 
trajectories in Wu converge to the fixed point p of the full 3D flow. Therefore, for any 
continuous scalar field c(x° and for all x 2 Wu (p°, we must have
lim cdt (x° = c(p°;
t!1
simply by the continuity of c(x°, as indeed suggested by Fig. 4.27(b). The same argument does 
not hold for the one-dimensional stable manifold Ws (p°, even though one sees accumulation 
of red color near Ws (p° in Fig. 4.27(b). This accumulation is due to the finite-time effect that 
dye remains locally captured near a saddle point for long times.
4.5 Barriers in 3D Time-Periodic Flows
Temporally periodic velocity fields in 3D also admit Poincare maps of the type we discussed 
in §§4.1 and 4.2. For 3D flows, such Poincare sections are 3D, which makes locating transport 
barriers through these maps complicated if not impossible. However, the LCS methods we 
will develop in Chapter 5 for temporally aperiodic, finite-time flows can also be applied 
to reveal barriers in temporally periodic and quasiperiodic flows over long enough time 
intervals.
Visualizing invariant sets in such flows is also possible by applying Birkhoff’s ergodic 
theorem to the Poincare map, as we discussed for Poincare maps of3D steady flows in §4.4.5. 
One has to expect, however, that increasing the computational times will be required for the 
temporal averages to converge to the spatial averages in 3D flows. Over such increased times, 
numerical inaccuracies invariably start affecting the quality of the results, as we have already 
seen on a 2D example in §4.2.
Figure 4.28 shows an example of a related 3D computation by Budisic and Mezic (2012) for 
a periodically forced version of the Hill’s spherical vortex defined in Eq. (4.36). This result is 
extracted from a clustering analysis of long-term temporal averages of a large number of ob­
servables (Fourier harmonics) along trajectories. These observables are velocity-independent

136
Barriers to Chaotic Advection
(passive) scalar fields, and hence, unlike the example shown in Fig. 4.15,the results shown in 
Fig. 4.28 are objective. As we have noted in §§2.2.14 and 4.2,this approach has no immediate 
extension supported by Birkhoff’s ergodic theorem to 3D time-quasiperiodic flows.
0.1
Figure 4.28 Two vortical domains bounded by elliptic transport barriers (2D invari­
ant tori) of the Poincare map in the periodically forced version of Hill’s spherical 
vortex (see Eq. (4.36)). The two sets are obtained from a clustering analysis of 
trajectory-averaged Fourier harmonics. Adapted from Budisic and Mezic (2012).
4.6 Burning Invariant Manifolds: Transport Barriers in Reacting Flows
We close this chapter by a brief discussion of transport barriers in reacting fluids with 
recurrent (steady or time-periodic) time dependence, such as the reaction fronts shown in 
Fig. 4.29.
Physically, this phenomenon is different from the purely advective transport phenomena 
we have surveyed throughout this chapter. Under simplifying assumptions, however, reaction 
front propagation in temporally recurrent flows can be described by the purely advective 
techniques of passive mixing and transport that we have been discussing here. Persistent and 
seemingly coherent reaction front propagation is observed in a variety of settings, including 
plankton boom, wildfires, spread of disease in moving population or microfluidic chemical 
reactors and other problems, as reviewed in Gowen and Solomon (2015). As Fig. 4.29 
illustrates experimentally, reaction front propagation in these phenomena is frame-indifferent. 
Therefore, by our discussion in Chapter 3 on material frame-indifference, transport barriers 
to reaction front propagation should be described in an objective fashion, just as purely 
advective material mixing.
Building on related results by Oberlack and Cheviakov (2010) and assuming the reaction 
time scales to dominate the advection time scales, Mitchell and Mahoney (2012) put forward 
a simplified equation for the propagation of a reaction front in a 2D reacting fluid velocity 
field v(x t° with x 2 R2. They assume that propagation takes place normal to the front at 
the constant, scalar burning speed v0 , independent of the position, the propagation direction

4.6 Burning Invariant Manifolds: Transport Barriers in Reacting Flows
137
Lab frame Co-moving frame
Figure 4.29 Evolution of a reaction front in a time-independent flow near a propa­
gating vortex, shown in the lab frame and in a frame co-moving with the vortex. This 
experiment illustrates the objectivity of transport barriers even under the simultane­
ous presence of advection, reaction and diffusion. Adapted from Gowen and Solomon 
(2015).
and the local curvature of the reaction front.3 If e(t° denotes the unit tangent vector to the 
propagating front at a position r(t°, then the local front element evolves approximately under 
the equation
3 The latter assumption is somewhat restrictive but holds in the experiments reported in Mahoney et al. (2012).
r = v(r; t ° + voJe;
e = »rv(r; t° + he; S(r, t)e> I] e;
(4.58)
with the 90 rotation matrix J used inEq. (4.21) and with the rate-of-strain tensor S defined 
in (2.1). The second equation in (4.58) is the classic equation for the evolution of the unit 
tangent vector g of a material curve (see, e.g., Haller (2016) for a derivation). The first 
equation in (4.58) describes a deviation from pure material evolution (v0 = 0) for the front. 
Therefore, for nonzero v0 , the unit tangent vector e evolves materially under the modified 
velocity field v(r; t° + v0Je, which in turn depends on the evolution of e.
Enforcing the constraint jej = 1 for the unit tangent vector of the front, Mitchell and 
Mahoney (2012) convert Eq. (4.58) into a 3D system of ODEs for the components of 
v = (u; v). The resulting equation is

138
Barriers to Chaotic Advection
x = u + v0 sin 0;
y = v - v0 cos 0;
0) = 2 (vy - ux) sin 20 + vx cos2 0 - uy sin2 0,
(4.59)
involving the angle 0 between e and the positive x axis. Reaction fronts are represented by 
one-dimensional, time-dependent invariant manifolds (r(t; 2),0(t; A°° of system (4.59) that 
satisfy the front compatibility condition
@Ar(t; A° =
cos 0(t; A° 
sin 0( t; A°
(4.60)
Reaction fronts are, therefore, evolving material lines of the 3D vector field (4.59), de­
termined by their initial position. As such, fronts cannot intersect or self-intersect in the 
3D phase space, but their projections on the physical (x, y°-plane can exhibit intersections 
and self-intersections. In the case of a projected front trailing the other, however, the (x, y°- 
projection of trailing front cannot pass that of the leading front as both travel with the same 
velocity v0 in the local frame.
For a steady 2D velocity field v(x°; fixed points of system (4.59) are called burning fixed 
points. In case such a fixed point has stable and unstable manifolds in the 3D phase space 
of Eq. (4.59),those manifolds are called burning invariant manifolds (BIMs). Mitchell and 
Mahoney (2012) argue that the (x, y°-projections of BIMs are one-sided transport barriers 
to front propagation due to the no-passing property we mentioned above. In other words, no 
impinging front can burn past any point of the BIM in the same direction that the BIM itself 
is burning.
For a time-periodic 2D velocity field, burning fixed points and burning invariant manifolds 
can be defined analogously for the Poincare map associated with the time-periodic 3D 
dynamical system (4.59). These then mark burning periodic orbits and their 2D invariant 
manifolds in the full phase space of system (4.59). In both the steady and time periodic 
cases, the BIMs relevant for observed front propagation are the unstable manifolds of saddle­
type burning fixed points or of saddle-type burning periodic orbits, since these manifolds 
behave as attracting material surfaces for system (4.59). Figure 4.30 shows a verification of 
these predictions in experiments, supported by numerical simulations of Eq. (4.59),for a 
Belousov-Zhabotinsky chemical reaction in a flow with a vortex (see Gowen and Solomon, 
2015 for details).
Mahoney and Mitchell (2015) provide a variational formulation for BIMs in 2D steady 
flows using an adaptation of the theory of shearless advective transport barriers derived by 
Farazmand et al. (2014) for temporally aperiodic flows (see also §5.4.3). An extension of the 
front propagation equation (4.58) to 3D flows requires the tracking of a 3D surface normal, 
resulting in a six-dimensional set of ODEs. Visualizations of the corresponding BIMs in 
a given steady 3D flow appear in Doan et al. (2018). Similar one-sided barriers arise in 
the motion of microswimmers in 2D fluid flows, as pointed out by Berman et al. (2021). 
Finally, more general models and their simulations for chaotic advection in reacting flows 
are reviewed by Tel et al. (2005).

4.7 Summary and Outlook
139
Steady reaction front
Experiment
Time-periodic reaction front
Simulation
Figure 4.30 Experimental confirmation of the role of burning invariant manifolds 
(BIMs) as one-sided transport barriers to which reaction fronts are attracted. Also 
shown (in red) is a nearby homoclinic loop of the passive fluid velocity field in the 
steady case. Adapted from Gowen and Solomon (2015).
4.7 Summary and Outlook
In this chapter, we have surveyed principles for detecting barriers to advective transport in 
temporarily recurrent (i.e., steady, periodic or quasiperiodic) flows. In contrast to most fluid 
flows arising in practice, temporarily recurrent flows remain well defined for arbitrarily large 
forward and backward times. This idealized property enables a unique definition of their 
transport barriers as material surfaces formed by trajectories starting from codimension one, 
structurally stable invariant sets of their Poincare maps.
Armed with this definition, we have given a general classification of transport barriers in 
recurrent flows. Of these barrier types, hyperbolic barriers formed by stable and unstable 
manifolds can generate chaotic fluid particle motion (chaotic advection) even in simple time- 
periodic flows. In contrast, elliptic barriers arising from KAM curves of Poincare maps 
surround islands of regular behavior, providing unique definitions of Lagrangian vortex 
boundaries in this class of flows. Based on the definitions of all these barriers, the fundamental 
tool for their identification is an appropriate Poincare map, defined through the temporal or 
spatial sampling of trajectories.
In addition to Poincare maps, we have also discussed how possible conserved quantities 
simplify the identification of advective transport barriers. In addition, we have briefly re­
viewed burning invariant manifolds in steady reactive flows. Conceptually, reactive transport 
differs from its advective counterpart, but an accepted 3D ODE model of reactive transport 
can nevertheless be analyzed with the tools of this chapter.
Beyond the wealth of technological applications and lab experiments falling in the realm 
of temporarily recurrent 3D flows (see Speetjens et al., 2021), such flows will resurface in 

140
Barriers to Chaotic Advection
Chapter 9in our discussion of barriers to active transport. Indeed, active barriers turn out to 
be invariant manifolds of steady, 3D, volume-preserving flows (barrier equations) associated 
with the underlying fluid flow. Those barrier equations can, therefore, be analyzed using the 
ideas in this chapter, as well as the LCS and OECS techniques discussed in the next chapter.

5
Lagrangian and Objective Eulerian Coherent Structures
InChapter 4, we discussed barriers to nondiffusive tracer transport under velocity fields that 
were either steady or had recurrent (periodic or quasiperiodic) time dependence. Here, we 
take our first step to uncover barriers to transport outside this idealized setting. To this end, 
we still consider nondiffusive passive tracer transport but no longer assume that the velocity 
field of the fluid is steady or temporally recurrent.
The first question is how much we can still utilize from what we learned about transport 
barriers in the temporally recurrent setting of Chapter 4. Recurrent velocity fields enabled the 
construction of spatial or temporal stroboscopic maps (Poincare maps) that are autonomous, 
i.e., are always the same between two stroboscopic samplings once the underlying sampling 
phases (Poincare sections) have been fixed. Iterating an autonomous map instead of tracking 
the trajectories of a nonautonomous differential equation is a major simplification, which 
enabled us to define advective transport barriers as invariant curves of Poincare maps in 
Definitions 4.1 and 4.3. These invariant curves, in turn, generated recurrent material lines or 
material surfaces for the full velocity field under advection by the flow map.
This strategy fails for more realistic fluid flows that are temporally aperiodic and are 
known only over finite time intervals. First, Poincare maps are no longer available. Indeed, 
while one could still sample fluid trajectories at regular time intervals or at regular spatial 
locations, the mapping taking subsequent samples to each other along trajectories will now 
be different at each sampling instant. Such a nonautonomous sequence of mappings is harder 
to analyze than the full, unsampled flow and it will generally have no invariant curves or 
surfaces. Second, nonautonomous sampling maps can no longer be iterated asymptotically 
given the finite-time availability of the flow data.
All these preliminary deliberations lead us to the realization that the beautiful intricacies 
of transport in 2D time-periodic flows and 3D steady flows, as illustrated in Figs. 4.12 and 
4.25, will no longer arise in temporally aperiodic flows. In particular, periodic orbits, their 
stable and unstable manifolds, homoclinic tangles, KAM tori and cantori can no longer 
be used to explain the tracer transport patterns seen in nature, which nevertheless often 
bear similarities with those in recurrent flows. Examples of these striking similarities with 
structures documented in chaotic advection are collected in Fig. 5.1, with the corresponding 
temporally recurrent transport barriers listed in Fig. 5.2.
To understand the source of these similarities, we recall a property that we pointed out for 
advective transport barriers in recurrent flows in §4.1: their material coherence. While we 
can no longer hope for even approximately recurring material surfaces in a general unsteady 
flow, we can certainly look for material surfaces that remain coherent. We regard a material 
surface as coherent if it preserves its spatial integrity without developing smaller scales.
141

142
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.1 Tracer patterns framed by temporally aperiodic barriers to tracer trans­
port in nature. (a) Spiral eddies in the Mediterranean Sea in 1984. Image: Paul 
Scully-Power/NASA. (b) Swimmers carried by a rip current at Haeundae Beach, 
South Korea, in the summer of 2012. Image: Joo Yong Lee/Sungkyunkwan Uni­
versity. (c) A sudden extension of the Deepwater Horizon oil spill in the Gulf 
of Mexico in June, 2010. Image: NASA. (d) Transport of warm water revealed 
by the sea surface temperature distribution around the Gulf Stream in 2005. Im­
age: NASA. (e) Jupiter’s Great Red Spot seen from the Voyager 1 mission in 
February, 1979. Image: NASA/JPL; image processing: Bjorn Jonsson. (f) Phyto­
plankton boom east of Tasmania. Image: Jeff Schmaltz/MODIS Rapid Response 
Team, NASA/GSFC. (g) Water carried by a tornado off the Florida Keys. Image: 
Joseph Golden/NOAA. (h) Steam rings blown by the volcano Mount Etna in Novem­
ber, 2013. Image: https://www.volcanodiscovery.com/etna/photos/2013/ 
nov/smoke-rings.html. Adapted from Haller (2015).

Lagrangian and Objective Eulerian Coherent Structures
143
Saddle fixed point 
compare: subplots b,c
Steady shear flow 
compare: subplot d
Center fixed point 
compare: subplots e,f
Homoclinic tangle 
compare: subplot a
KAM torus 
compare: subplot h
Invariant cylinder 
compare: subplot g
KAM curve on a
Poincare section
Figure 5.2 Steady and temporally recurrent transport barriers discussed in Chapter 4 
that resemble the perceived temporally aperiodic, finite-time barriers in the referenced 
subplots of Fig. 5.1. Adapted from Haller (2015).
Those smaller scales would manifest themselves as protrusions from either side of the 
material surface without a breakup of that surface. In other words, using the terminology 
of §1.3 of the Introduction, we seek advective transport barriers in nonrecurrent flows as 
Lagrangian coherent structures (LCSs).
As we have already indicated, however, the notion of coherence of an evolving material 
surface is subject to different interpretations. Even if we fix a general notion of coherence for 
a material surface, the continuity of the flow map will force very close material surfaces to 
behave similarly. As a result, we will not be able to find single, isolated material surfaces that 
show strikingly unique features (such as a stable manifold does asymptotically in time) over 
finite time intervals. Rather, we will seek LCSs as extremizing surfaces of some physically 
relevant notion of coherence over a given time interval, with the outcome of this procedure 
depending on the coherence notion used and the time interval selected. The LCSs obtained in 
this fashion will only show minute differences from the evolution of their closest neighboring 
material surfaces. Such an LCS will nevertheless act as theoretical centerpiece of a thin set 
of material surfaces perceived together as a single barrier to advective transport.
The relevant time interval for LCS identification may simply be the maximal temporal 
length of the data set, may come from physical considerations or may be inferred by extrem- 
izing the selected coherence feature over different possible time horizons. Either way, the 
time scale of the analysis is simply part of the definition of the finite-time dynamical system 
generated by the nonautonomous, nonrecurrent, finite-time ODE problem
X = V(X; t °; X 2 U C Rn; t 2» 10; t1] 
(5.1)
for an at least continuously differentiable velocity field v(x; t). This velocity field will generally 
be reconstructed from numerical data or experimental measurements. We will focus on the

144
Lagrangian and Objective Eulerian Coherent Structures
dimensions relevant for fluid flows (n = 2; 3) but several of the LCS techniques we will 
discuss also apply to finite-time dynamical systems of arbitrary (finite) dimensions. As noted 
in Chapter 3,we will uphold the minimal self-consistency requirement for transport barrier 
detection by considering only objective approaches to LCSs.
In the limit of t1 ! t0 t, any objective Lagrangian coherence principle or identification 
technique for finite-time dynamical systems turns into an objective Eulerian coherence prin­
ciple or identification technique. We will refer to this instantaneous time-t limits of LCSs as 
objective Eulerian coherent structures (OECSs). These Eulerian structures act as LCSs over 
infinitesimally short time scales and hence their time-evolution is not material. Despite being 
nonmaterial, OECSs have advantages and important applications in unsteady flow analysis, 
as we will discuss separately in §5.7.
5.1 Tracer-Transport Barriers in Nondiffusive Passive Tracer Fields
As a first approach, we would like to characterize observed barriers to advective transport 
directly from the tracer concentrations shown in Fig. 5.1.We observe transport barriers as 
delineators of concentration patterns because the concentration changes abruptly across these 
surfaces. We then view these surfaces as persistent obstacles to the homogenization of the 
tracer concentration. More specifically:
Definition 5.1 Tracer-transport barriers in a tracer field are material surfaces along which 
large tracer gradients develop.
This definition is illustrated in a magnified version of Fig. 5.1(d) shown in Fig. 5.3.
Figure 5.3 Locations of large concentration gradients mark observed tracer-transport 
barriers into the Gulf stream in the magnified version of the image shown in Fig. 5.1(d). 
We express such a current location as the advected position of a fluid particle starting 
from an initial position x0 at time t0 .
Definition 5.1 gives us a starting point to look for tracer-transport barriers by analyzing 
the tracer gradient evolution. In all examples shown in Fig. 5.1,the diffusivity of the tracers 
is either zero or very small so, for now, we will restrict our investigations to nondiffusive 
tracers. In contrast, we will consider barriers to diffusive transport in Chapter 8. To proceed 
with this idea, we consider the conservation law along fluid trajectories for a nondiffusive 
tracer concentration c(x; t), which can be written as
Dc
— = @t C + r C ■ V = 0; 
C (X; 10° = C o(X°:
(5.2)

5.1 Tracer-Transport Barriers in Nondiffusive Passive Tracer Fields 
145
We take the spatial gradient of both sides of Eq. (5.2) to obtain
@t (r c ° + r2 c v + (rv°T r c = o,
with r2c denoting the Hessian ofc and the superscript T referring, as usual, to transposition. 
This last equation can be rewritten along any fluid trajectory as
Dr c (Fto (xo°; t) = - (rv (Fto (xo°; t))T r c (Ft, (xo°, t), 
(5.3)
which shows that tracer gradients satisfy the adjoint equation of variations we introduced 
inEq. (2.48).Therefore, using the solution formula (2.49) for that equation, we obtain that 
purely advected tracer gradients at points x = Fto (xo° evolve under the relation
r c (x, t° = [rFto (xo)] "T r co (xo°• 
(5.4)
Specifically, by Eq. (5.4),the squared magnitude of rc evolves along trajectories accord­
ing to the formula
|r c (Fto (xo°; t )|2 = »r c o (xo°]T [rFto (xo)] "1 [rFto (xo)] "T r c o (Xo°
= Drco (Xo°; [Cto (xo)] “1 r co (xo°E ; 
(5.5)
with the right Cauchy-Green strain tensor Cto = [rFto ] T rFto that we first introduced in 
Eq. (2.90). In an incompressible flow. we have det Cto = det [Cto] 1 = 1, and hence at least 
one of the eigenvalues of the symmetric, positive definite tensor [Cto ] 1 will be larger than 
one in norm. This eigenvalue is also expected to ie growing further exponentially in time 
due to the growing deformation exerted by the inverse flow map [Fto ] 1 while it maps highly 
deformed material elements back to their undeformed initial positions.
Equation (5.5) shows that large gradients , observed along the perceived transport barriers 
of the tracer field in Fig. 5.3,arise at the current time- t positions of trajectories that started 
from initial locations xo where the dominant eigenvalue of the Lagrangian tensor [Cto (xo)] 
is large. The closer the initial gradient r co(xo° is to the corresponding dominant eigenvector 
of [Cto(xo°] 1 at those initial locations, the larger the gradient r c will become by time t.
These large gradients are generally not seen to be equal to each other along the barriers, but 
they visibly dominate concentration gradients in directions normal to the barriers. In other 
words, tracer-transport barriers appear to form along ridges of the advected concentration 
gradient magnitude field |r c (Fto (xo°, t)|, defined over the initial positions xo. There are a 
number of different mathematical ridge definitions (see e.g., Eberly, 1996), but for our current 
purposes, we favor the concept of a height ridge (see Appendix A.2 for ridge definitions). 
We rely on the reader’s intuition for a height ridge, which we also reaffirm with Fig. 5.4.
We now set the general time t to be equal to t1 , the end of a finite-time observation window 
for the flow. Equation (5.5) then shows that as long as the initial tracer gradients have a 
general, nondegenerate orientation with respect to the eigenvectors of [Cto] 1, the ridges of 
the advected concentration gradient field |r c (Fto (xo°, t)| will coincide with ridges of the 
maximum eigenvalue field of [Cto(xo°] 1 when the latter eigenvalues are plotted over the 
advected positions x = Fto (xo° • By the equality of the spectra of [Cto (xo°] 1 and Cto (Fto (xo°) 
established in formula (2.101), and by the objectivity of these spectra concluded in §3.4.3, 
we arrive at the following conclusion.

146
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.4 A mountain ridge marked by a walkway is an example of a height ridge. 
Image:miriadna.com.
Proposition 5.2 Under increasing time t1, tracer-transport barriers for nondiffusive tracers 
in the finite-time flow (5.1) generically align with codimension-1, i.e., (n - 1°-dimensional, 
ridges of the largest eigenvalue An (x0; 11; 10° of the backward Cauchy-Green strain tensor 
Ctt1
0 (x°.
By the objectivity of the eigenvalues of Ctt01 (x° (see §3.4.3),Proposition 5.2 provides a 
frame-indifferent diagnostic principle for typical observed tracer-transport barriers. Its state­
ment is valid at generic locations x0 under generic initial concentrations c0 (x0 °. Genericity 
here holds under the requirement that rc0 (x0 ° is not orthogonal to the dominant eigenvec­
tor of [C£(x0)] 1 (see Eq. 5.5), or, equivalently, to the weakest eigenvector £1(x0; 10,11° of 
Ctt01 (x0°: This requirement also implies that rc0(x0° cannot be zero. Certain initial concen­
tration fields will, therefore, not display visible barriers along certain portions of the ridges 
of An(x0; t1; t0°. The simplest example of such an initial concentration is c0(x0° = const., that 
will develop no nonzero gradients by the conservation law (5.2) even though An(x0; t1; t0° may 
well have ridges. That said, generic tracer concentrations that are free from such degeneracies 
will display signatures of tracer-transport barriers along the ridges of An(x0; t1; t0° for large 
enough t1 . When t1 is uniformly fixed for the whole flow domain, some barriers may not 
yet have well-pronounced signatures in a given concentration field, even though a ridge of 
An(x0; t1; t0° signals the presence of the barrier.
We will go into more detail regarding the numerical computation of the eigenvalues of 
the right Cauchy-Green strain tensor C0 in §5.2. For now,, we skip hiose details and revisit 
the analysis of strange eigenmodes displayed by concentration patterns in time-periodic 
flows, which we discussed in §4.1.1. As we iointed out in our discussion, exierimentally 
constructed Poincare maps generally provide insufficient detail to locate the transport barriers 
delineating the ieriodically recurrent concentration iatterns. Instead, Voth et al. (1994) 
followed about 800 fluorescent particles of diameter 120 mm and recorded their positions 
at 10 Hz, providing 40-180 images per forcing period. The resulting 12;000;000 particle 
positions were determined with a precision of about 40 m. The periodicity of the flow was 
then exploited by considering particle positions at times t0+kT as if they had been released at 

5.1 Tracer-Transport Barriers in Nondiffusive Passive Tracer Fields
147
time t0. This process yielded a total of 100;000 precise particle positions at each observational 
phase of the experiment.
One could directly use the displacement of these particle positions over one forcing 
period as a discrete approximation of the Poincare map Pt0. It is more accurate, however, 
to determine the particle velocities at these positions by differentiating a polynomial fit to 
particle trajectories, interpolating these velocities onto a rectangular grid G0 , and advecting 
pseudo-particles from this grid in backward time under the interpolated velocity field. Over 
the grid G0 , one can then accurately compute the backward-time deformation gradient rFtt01 
via finite-differencing, as we will describe in §5.2.
With rFt0 at hand, Voth et al. (1994) computed the backward Cauchy-Green strain tensor 
over a time interval equal to three times the time period T of the reconstructed velocity 
field. By Proposition 5.2, ridges of the corresponding eigenvalue field A2(x0; 3T, 0° should 
highlight transport barriers framing the strange eigenmodes seen in the tracer concentration 
patterns of Fig. 4.8. Over this integration time, the strongest ridges are of nearly uniform 
height and hence they can be extracted by a simple thresholding of the 2 (x0; 3T° field.
Figure 5.5(a) shows the dye concentration field at time t = 3T. In Fig. 5.5(b), the con­
centration field is shown at time t = 30T; with the extracted ridges of the 2(x0; 3T; 0° field 
superimposed in red. This confirms the arguments in this section with high accuracy: ob­
served transport barriers extracted at time 10 = 3T as ridges of A2(x0; 1010 - 3T° continue to 
predict the skeleton ofa strange eigenmode 30 periods later! As we will argue in §5.., these 
transport barriers are unstable manifolds of hyperbolic fixed points of the corresponding 
Poincare map.
Figure 5.5 Material tracer-transport barriers mark the skeleton of strange eigenmodes 
in the weakly diffusive dye experiments of Voth et al. (1994) at Reynolds number 
Re = 45: (Left) Dye distribution at time 3T. (Middle) Tracer-transport barriers 
extracted as ridges of the 2(x0; 3T; 0° field, superimposed at the dye distribution at 
time 30T. (Right) Same as the middle plot but for the Reynolds number Re = 100:
While the present, tracer-based view highlights the importance of the singular values of 
the deformation gradient in advective transport barrier detection, it does not directly reveal 
the connection of these barriers with distinguished material lines (i.e., LCSs) in the flow. 
Next, we will take a fluid-trajectory-based alternative view on advective transport barriers 
that clarifies this relationship and allows for a more detailed classification of LCSs.

148
Lagrangian and Objective Eulerian Coherent Structures
5.2 Advective Transport Barriers as LCSs
Some of the subplots in Fig. 5.1 reveal advective transport barriers based on their impact on 
nearby discrete tracers rather than on concentration fields. The magnified image in Fig. 5.6 
illustrates this observation for the rip current from Fig. 5.1(b).
Figure 5.6 Locations of locally most attracting material lines mark observed barriers 
to transport across a rip current in the magnified version of the image shown in 
Fig. 5.1(b).We express such a current location as the advected position of a fluid 
particle starting from an initial position x0 at time t0. The shrinking transverse material 
lines schematically show attraction to the rip current, as evidenced by shrinking crowd 
size in the direction normal to the current.
More generally, one may seek advective transport barriers as material surfaces with the 
locally strongest impact on nearby fluid particles. We start with the following working 
definition for LCSs, which we will make more specific later.
Definition 5.3 Lagrangian coherent structures (LCSs) are codimension-1, structurally stable 
material surfaces that locally extremize attraction, repulsion or shear among all nearby 
material surfaces over a finite time interval»10; 11].
Of the LCSs covered by Definition 5.3,an attracting LCS (i.e., a codimension-1 locally 
most attracting material surface) is illustrated in Fig. 5.6. Unlike attraction, material repulsion 
remains mostly invisible as the LCS causing it is not highlighted by tracer accumulation. 
Repelling LCSs (i.e., codimension-1 locally most repelling material surfaces) are nevertheless 
important as they send tracer particles on their two sides to different parts of the phase space. 
An example of a repelling LCSs known from chaotic advection is the stable manifold of the 
saddle point shown in Fig. 5.2, as already noted in §4.1. We will be referring to attracting and 
repelling LCSs collectively as hyperbolic LCSs, as they are extensions of the 2D hyperbolic 
barriers to advective transport that we identified in time-periodic flows in §4.1.1 using 
Poincare maps.
Finally, shear exerted by an LCS manifests itself by predominantly tangential displacement 
of nearby trajectories along the LCS in comparison to other material surfaces. The shearing 
action of a shear LCS (i.e., a codimension-1 locally shear-extremizing material surface) 
can either be maximal or minimal in comparison to neighboring material lines. Maximal 
shearing turns out to characterize the nested, cylindrical or toroidal material surfaces that 
make up material vortices of the kind shown in the (e)-(h) subplots of Fig. 5.1. We will refer 
to codimension-1 locally most shearing material surfaces as elliptic LCSs, as they constitute 
extensions of the 2D elliptic advective transport barriers we discussed for Poincare maps in 

5.2 Advective Transport Barriers as LCSs 
149
§4.1.2.In contrast, we will refer to codimension-1 locally least shearing material surfaces as 
parabolic LCSs, which typically form centerpieces of jets. An example of a parabolic LCS 
is the theoretical, minimally shearing backbone curve of the Gulf Stream shown in Fig. 5.1. 
Parabolic LCSs are, therefore, the extensions of the 2D parabolic advective transport barriers 
we discussed for Poincare maps in §4.1.3.
This classification of LCSs is based on purely physical arguments and observations but 
suffices for the development of objective LCS diagnostics, as we will see next. In §5.3-5.4, 
we will discuss more systematic mathematical descriptions for LCSs based on a precise 
implementation of Definition 5.3 using methods from the calculus of variations.
5.2.1 Hyperbolic LCS from the Finite-Time Lyapunov Exponent
We now seek to find hyperbolic LCSs as the locally most attracting or repelling material 
surfaces in the flow. Local attraction or repulsion by a material surface M(t° is best assessed 
by studying the evolution of infinitesimally small material perturbations £(t° to M(t°. These 
perturbations evolve as solutions of the equation of variations (2.45) along trajectories 
x(t; t0; x0° 2 M(t°. These solutions are of the form £(t° = rFt0(x0°£(t0°, as we discussed in 
§2.2.8.The magnitude of the evolving perturbation is, therefore, equal to
ie( t °j = q<rFt0 (x0 °e( 10°; rFt0 (x0°e( t0°) = q<e< t0°; Co (x0x( t0°); 
(5.6)
and hence is governed by the right Cauchy-Green strain tensor that we have encountered in 
our concentration-gradient-based preliminary discussion of LCSs in §5.1.
By formula (5.6), initial perturbations aligning with the unit dominant eigenvector £n of 
Ct0 (as defined in Eq. (2.95)) wlll be stretched by the largest possible factor, pd2, as we 
concluded in formula (2.97). By the same formula, initial perturbations aligning with the 
weakest eigenvector £1 of Ct0 will be compressed by the factor pd[. By definition, -^dj are 
the singular values of the deformation gradient rFtt0 (x0° (see §2.3.1).
The (positive or negative) average growth exponents inferred from the evolution of these 
singular values are called the finite-time Lyapunov exponents (or FTLEs) associated with 
the underlying trajectory starting from x0 at time t0 . Often, however, the term FTLE is used 
simply in reference to the growth exponent FTLEtt10 (x0° of the largest singular value dn , 
defined as
FTLEt0(x0° = 
1 
logdn(x0; 10; 11°; 
(5.7)
2 j t 1 - t0 j
with n = 2 or n = 3 for fluid flows. We speak of forward FTLE when t1 > t0 and backward 
FTLE when t1 < t0 . The latter type of FTLE involves computing the tensor Ctt0 along 
backward-running trajectories. In either case, FTLEtt01 (x0° is an objective Lagrangian scalar 
field in the sense of §3.4.1.For a more general discussion on Lyapunov exponents, we refer 
toAppendix A.3.

150
Lagrangian and Objective Eulerian Coherent Structures
Repelling LCSs, defined as locally most repelling codimension-1 material surfaces, are 
expected to be marked by codimension-1 surfaces of locally largest forward FTLE values. 
Such codimension-1 surfaces, M(t°, are material curves in 2D flows and material surfaces 
in 3D flows. While FTLE values are not required to be equal along M(t), the FTLE values 
should reach a maximum along M(t° in directions normal to M(t°. Just as in §5.2, these 
considerations bring us to the following objective diagnostic principles.
Proposition 5.4 For 11 -10 large enough, time 10 positions of repelling LCSs will generically 
align with codimension-1 ridges of the largest eigenvalue An(x0; 10; 11° of the forward Cauchy- 
Green strain tensor Ct0 (x0°, or, equivalently, with the ridges of FTLEt0 (x0°. Similarly, for 11-10 
large enough, time t0 positions of attracting LCSs will generically align with codimension-1 
ridges of the largest eigenvalue n(x0; t1; t0° of the backward Cauchy-Green strain tensor 
Ctt01 (x°, or, equivalently, with the ridges of FTLEtt01(x°.
This proposition provides an objective diagnostic principle because the eigenvalue fields 
of Ctt10 (x0° are objective, as we concluded in §3.4.3. According to this principle, one may 
reasonably expect forward and backward FTLE ridges to highlight the locally most repelling 
and attracting material surfaces, respectively. This is indeed the case if the maximal stretching 
measured locally by the FTLE field occurs in a direction transverse to such a material surface, 
as opposed to tangent to it, and hence the FTLE indeed characterizes the repulsion from the 
surface. As this is not necessarily the case, the converse of Proposition 5.4 does not hold: 
ridges of the FTLE field may not represent hyperbolic LCSs, as we discuss next.
5.2.2 FTLE Ridges Are Necessary (but Not Sufficient) Indicators of Hyperbolic LCS
As noted at the end of the previous section, we cannot automatically associate all FTLE 
ridges with repelling or attracting LCSs, despite suggestions to this end by several authors, 
starting with the work of Shadden et al. (2005) and Lekien et al. (2007). Indeed, consider, 
for instance, the 2D incompressible flow
x = tanh y + 2;
y = 0;
(5.8)
which is a parallel shear flow in the horizontal direction with a line of maximal shear at y = 0. 
This model flow has explicitly solvable trajectories, which enables an explicit calculation 
of the flow map and the Cauchy-Green strain tensor. As calculated by Haller (2011), the 
dominant eigenvalue of Ctt01 (x0° with x0 = (x0; y0° is
^2(x0° = 1 (11 - 10°2 (tanh0 (y0°°2 + 1 + 
11 (11 - 10°4 (tanh0 (y0°°4 + 1;
which has an x0 -independent maximum at y0 = 0 both for t1 > t0 and for t1 < t0; given that 
the derivative tanh0 (y0° has a global maximum there. As a consequence, both FTLEtt10 (x0° 
and FTLEtt01 (x0° have a ridge of constant height along the x-axis for any choice of the initial 
and final time. The associated maximal stretching, however, is tangential to the material line 
M = (x; y° 2 R2 : y = 0 and hence M is neither repelling nor attracting, as seen inFig.
5.7.

.2 Advective Transport Barriers as LCSs
151
forward and backward FTLE ridge
Figure 5.7 The geometry of the shear flow (5.8) with the deformation of a material 
blob superimposed. This example shows that FTLE ridges do not necessarily mark 
hyperbolic LCSs. Indeed, both the forward and the backward FTLE have a ridge at the 
line of maximal shear at y = 0, which is nevertheless not an attracting or a repelling 
LCS. Adapted from Haller (2011).
x
The simple example (5.8) shows that while hyperbolic LCSs are highlighted by FTLE 
ridges, certain parts of a computed FTLE ridge may just indicate maximal shear along the 
ridge, as opposed to maximal repulsion from the ridge. This is often the case in high-shear 
regions near flow boundaries, as illustrated in Fig. 5.8 by a forward FTLE calculation on a nu­
merical ocean model. In the coastal area, many of the smaller, parallel running, closely aligned 
ridges tend to indicate curves of maximal shear, or a combination of shear and repulsion.
Figure 5.8 Forward FTLE calculation from a numerical ocean model for the Alboran 
Sea within the 2019 CALYPSO Real-Time Sea Experiment. Image: MIT MSEAS 
group, http://mseas.mit.edu.
One needs to keep in mind, therefore, that FTLE ridges are necessary but not sufficient 
conditions for hyperbolic LCSs. For a definitive conclusion about their meaning, one would 
also have to verify the normal repulsion or attraction of those ridges. As shown by Haller 
(2000) and implemented by Mathur et al. (2007) and Green et al. (2007), instantaneous 
normal repulsion of the material line M(t° advected from a ridge under the flow is ensured 

152
Lagrangian and Objective Eulerian Coherent Structures
by the positivity of the inner product (nt, Snti along M(t°. Here, nt is a time-evolving unit 
normal to M(t° and S is the rate-of-strain tensor defined in Eq. (2.1).
We also note that the linear incompressible saddle flow
X = X;
y = -y
(5.9)
is sometimes regarded as a counterexample to the claim that FTLE ridges are not even 
necessary conditions for hyperbolic LCSs. This assertion stems from the observation that 
both the forward and the backward FTLE fields are globally constant (and equal to 1) for 
any choice of t0 and t1 in the flow (5.9). This is then usually contrasted with the fact that the 
origin has an unstable manifold along the X-axis and a stable manifold along the y-axis that 
one expects to be marked by ridges.
However, each trajectory (x(t°, y(t°° = (x0et, y0e~t° of the ODE (5.9) has co-moving 
horizontal and vertical unstable and stable manifolds. Indeed, we can pass to a frame co­
moving with such a trajectory by the Galilean coordinate change (X, y° = (x - x0 et, y - y0e~t °. 
The trajectory is now represented by the origin (X, y° = (0,0° in this moving frame and the 
transformed equations of motion, X = X, y = -y are identical to those of the flow (5.9). 
Consequently, there is an infinite family of horizontal material lines in the phase space of 
flow (5.9) that attract at the same rate. Likewise, there is an infinite family of vertical material 
lines that repel at the same rate. Because of equal attraction and repulsion rates all over the 
phase space, there is no LCS in this flow, which is consistent with the lack of FTLE ridges. 
We note that the only distinguishing feature of the stable and unstable manifolds of the origin 
in (5.9) is that these two material lines contain trajectories that are bounded for all times 
in at least one time direction. Boundedness, however, is a frame-dependent property and 
hence should not enter our detection of LCSs. Indeed, the stable and unstable manifold of 
any trajectory becomes bounded in at least one time direction in the frame co-moving with 
the trajectory, as we have just seen.
A repelling LCS may be unsteady even in a steady flow. An example illustrating this is the 
2D flow 
X = 1 + a tanh2 x,
y = -2 a tanh x 
cosh2 x y,
(5.10)
which is an incompressible version of the example considered by Haller (2011). As Fig. 
5.9 illustrates, a repelling LCS coinciding at t = 0 with the y-axis moves to the right and 
establishes itself as the most repelling material line in the flow by t = 0:6. Accordingly, the 
field FTLE00:61 (x0° develops a ridge along the y-axis by that time.
The example (5.10) also illustrates that t0-dependent ridges produced by sliding-window 
FTLE fields of the form FTLEtt00+T(x0°, with t0 varying and T fixed, are generally not material 
curves or even near-material curves. Indeed, the velocity field (5.10) is steady and hence 
FTLEtt0+T (x0° will not depend on the initial time and produce the same ridge shown in Fig. 5.9 
for all choices of t0 . Therefore, if FTLE ridges in such sliding-window calculations generally 
indicated tracked material lines, then the y-axis would have to remain fixed under advection. 
This is clearly not the case, as seen in Fig. 5.9, yet sliding-window FTLE-calculations are 
commonly used in the literature to infer the time-evolution of LCSs. This practice is only 
justifiable if the underlying velocity field is time periodic and the sliding window length T is 
an integer multiple of that period. In that case, the algorithm of Brunton and Rowley (2010)

5.2 Advective Transport Barriers as LCSs
153
initial conditons at time t =0
y
y
forward FTLE
2
1
x
Figure 5.9 (Top) An unsteady repelling LCS (i.e., a material line M(1° shown 
in black, advected to the right by the flow) in the steady planar flow (5.10). The 
positions of trajectories (blue), released from an initially uniform grid in the domain 
»-2; 2] x [-20; 20] at 10 = 0, reveal that M(1° is the most repelling material line 
(a unique repelling LCS) in this flow. All horizontal material lines remain horizontal 
but shrink substantially in the vertical direction near M( 1 ° due to incompressibility. 
(Bottom) For increasing t1 , the forward FTLE plot indeed shows the development 
of a ridge that converges quickly to the y axis, correctly indicating with increasing 
accuracy the initial position of M( 1 ° at 1 = 0. In the plot, we show FTLE0:61 (x0° for 
the parameter value a = 40 selected in Eq. (5.10).
offers substantial speed-up by eliminating the repeated computations of the flow map over 
overlapping parts of adjacent snapshots of the sliding window.
Finally, example (5.10) also disproves the flux formula of Shadden et al. (2005); Lekien 
et al. (2007) who use their formula to argue that converged FTLE ridges have very small 
flux through them. As Haller (2011) points out, that flux formula would give a decreasing 
material flux of order O (| 11 - 101-1) through the y axis in example (5.10). In contrast, the 
actual flux through the y-axis can be computed directly as x|x=0 = 1 at all times.
5.2.3 Extraction Interval and Convergence of the FTLE
The FTLEt0(x0° field is associated with the finite-time dynamical system (5.1), whose defini­
tion includes the finite time interval [10; 11]: Changes in this time domain of definition change 
the dynamical system and hence the values and the topology of the FTLE field will change 
too. Therefore, no convergence can be expected in FTLE^ (x0° as 11 ! 1 unless the velocity 
field v(x, 1 ° is temporally recurrent (steady, periodic, quasiperiodic) in time. In that case, the 
dynamical system (5.1) is either autonomous or can be viewed as autonomous system on an 
extended phase space P , as seen in Chapter 4.
In these autonomous cases, the evolution of the trajectories is governed by an autonomous 
flow map Ft on P that can be sampled at multiples ofa fixed time interval T. If the original 

154
Lagrangian and Objective Eulerian Coherent Structures
flow preserves a measure (e.g., volume or mass) and FT maps a region D P of finite 
measure into itself, then Oseledec’s multiplicative ergodic theorem (Oseledec, 1968) applies 
to FT . This theorem will guarantee the existence of the limit
Ak (xo° = lim ——1--- -log Ak fa; t0, 1i), k = 1,..., n
ti!1 2 j11 - toj
for all the finite-time Lyapunov exponents (including the maximal one, FTLE^ (x0)) for 
almost all xo 2 D with respect to the measure (see Appendix A.3 for a precise statement 
of Oseledec’s theorem). For instance, for all points x0 on the stable manifold ofa fixed point 
p of a Poincare map in a time-periodic flow, FTLEtO (x0° will converge to the same value as 
t1 ! 1.
If, however, the assumptions made to reach this conclusion (i.e., temporal recurrence, 
measure preservation and boundedness of the trajectory in P) do not hold, then an asymptotic 
limit for FTLEtO(x0° is not guaranteed to exist. Indeed, Ott and Yorke (2008) construct 
examples of 2D steady compressible flows in which FTLEtO (x0° has no asymptotic limit on 
large open sets even though all trajectories in these sets are bounded (see Appendix A.3 for 
such an example).
5.2.4 Numerical Computation of the FTLE
By Proposition 5.4, nittial jo(s!iito^r^s of ie?p>cllng LCSs clctiriccl over hie interv^al»10,11] create 
ridges in the forward FTLE field. Similarly, time t1 positions of attracting LCSs form ridges 
in the backward FTLE field FTLEtt1
0 . In actual flow analysis, however, the converses of these 
statements become relevant: Do ridges of the FTLEtt10 and FTLEtt1
0 indicate repelling and 
attracting LCSs? While we have seen that such converse statements cannot generally be 
concluded without exceptions, FTLE fields do provide a powerfully simple and effective way 
to perform a first-order discovery of hyperbolic barriers in a flow.
The numerical computation of FTLE hinges on a numerical approximation of the de­
formation gradient field rFt0(x0°. Solving the equation of variations (2.45) directly along 
trajectories to obtain rFt0 (x0° tends to be a numerically challenging procedure. Instead, 
Haller (2001a) proposed to generate an array of trajectories,
x( t; 10, x0° =
X x 1(t; 10; x0° \ 
x2(t; 10;x0° 
\ x3(t; 10,x0° /
x10
x0 = -© x20 
x30
2 G0 C U, 
/
by solving the finite-time ODE (5.1) numerically for initial conditions taken from a rect­
angular grid G0 covering the flow domain U. Assuming a uniform rectangular grid G0 for 
simplicity, we denote the spacing of this grid by i in the xi0 direction and introduce the grid 
spacing vector
i = iei, 
i = 1,2,3,
with no summation implied over the index i . Then a finite-difference approximation for the 
deformation gradient rFtJ(x0° can be computed as

5.2 Advective Transport Barriers as LCSs
155
X1(ti;t0;XO +£1°~X1(ti;tO;XO~£1° 
2A1
X2(ti;t0;X0 +^1°~X2(ti;tO;XO~^1° 
2A1
X3(ti;t0;X0 +^1°~X3(ti;tO;XO~^1° 
2A1
X1 (ti;tQ ;Xo + ^2°~X1 (t1 ;to ;X0~^2°
2A2 
X2(ti;to ;Xo + ^2°~X2(t1 ;to ;X0~^2° 
2A2
X3(ti;to ;Xo + ^2°- X3 (t1 ;to ;Xo~^2° 
2A2
xi(ti;to;Xo+^3°-xi(tt;to;Xo-^3° \
2A3
X2(t1 ;t0 ;Xo+^3°~X2(t1 ;t0 ;X0~^3° 
2A3
X3 (t1 ;to ;Xo+^3°~X3(t1 ;to ;X0~^3° 
2A3
(5.11)
For the purposes of revealing the locations of ridges in the eigenvalue fields of Ctt01; this simple 
calculation returns surprisingly robust results, even if numerical errors in approximating the 
entries of rFtt10 via approximation (5.11) grow substantially for larger t values.
Once the numerical approximation (5.11) for rFt0(x0) is available, the FTLE defined in 
Eq. (5.7) can be obtained first by substituting this approximation into the formula (2.90) 
defining Ct0(x0°. One then solves the characteristic equation of Ct0(x0° pointwise for its 
eigenvalues Aj (x0; t0,11° and selects the largest, A3(x0; 10,11°, to compute the FTLE field from 
formula (5.7) with n = 3. For 2D flows (n = 2), the approximation to rFt0(x0° will comprise 
only the 22 main minor matrix of the approximation (5.11), in which case the characteristic 
equation of Ct1 (x0° is quadratic. This computation in implemented in Notebook 5.1.
H-----------------------——:----------------------------------------:----------------------------- :------------------------------------------------------------------------
Notebook 5.1 (FTLE2D) Computes the finite-time Lyapunov exponent (FTLE) field via 
singular-value decomposition (SVD)for a 2D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/FTLE2D
A more direct computation of the FTLE targets 7An(x0; 10, 11° as the largest singular value of 
the numerical approximation (5.7) to rFt0(x0°. Singular-value decomposition (or SVD; see 
§2.3.1) of the deformation gradient was proposed by Greene and Kim (1987) for computing 
Lyapunov exponents, but was apparently employed first by Karrasch (2015) to compute LCSs 
(see also Karrasch et al., 2015). As recalled by Karrasch (2015) from Trefethen and Bau 
(1997), SVD computations for rFtt10 are generally more stable numerically than eigenvalue 
computations for Ctt01 and hence are preferable for numerically and experimentally generated 
vector fields. A further advantage of SVD in the present context is that beyond the singular 
values pAi, it will simultaneously render the corresponding left and right singular vectors of 
the deformation gradient, as we see from the SVD formula (2.108). These singular vectors 
will be needed in some of the more advanced LCS theories reviewed later in this chapter. 
The computation of FTLE via SVD for 3D flows is implemented in Notebook 5.2. 
—
Notebook 5.2 (FTLE3D) Computes the finite-time Lyapunov exponent (FTLE) field via 
singular-value decomposition (SVD) for a 3D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/ 
demos/AdvectiveBarriers/FTLE3D
The algorithm of Tang et al. (2010) enables the reliable extraction of FTLE ridges if the 
velocity is only available on a non-invariant flow domain. The algorithm then smoothly 
extends the velocity field to a closest-fitting linear velocity field outside the domain. This 
extension eliminates spurious ridges arising from algorithms that stop trajectory integration 
at the domain boundary. Finally, we note that in an effort to combine the computation of 
the velocity field and the FTLE field, Nelson and Jacobs (2015) develop an algorithm that 

156 
Lagrangian and Objective Eulerian Coherent Structures
computes FTLE fields simultaneously with the time integration of discrete Galerkin-method- 
based flow solvers.
5.2.5 Extraction of FTLE Ridges
The simplest way to extract ridges of the FTLE field is ridge thresholding: one keeps only 
those points with FTLE values over a selected high threshold, as in Fig. 5.5.This extraction 
will undoubtedly lose some of the weaker ridges and will only capture parts of the stronger 
ridges that reach the required minimal value. For a quick assessment of the most dominant 
ridges, however, even thresholding is effective enough.
The more refined approach of Mathur et al. (2007) is based on the observation that ridges 
of FTLEt0 (xo° are attractors of the gradient dynamical system1
1 This observation is used in a more rigorous ridge definition by Karrasch and Haller (2013) that ensures the 
robustness of the ridge under small perturbations to the data set (see Appendix A.2).
^ xo( s ° = rFTLEtO (xo( s °°- 
(5.12)
ds 
o
Indeed, by the growth of FTLEtO(x0° towards the ridge, the gradient field rFTLEtO guides 
all trajectories of the autonomous differential equation (5.12) from a vicinity of any ridge 
towards the ridge. One can, therefore, launch trajectories of (5.12) in ridge neighborhoods 
identified from a rough thresholding and simply keep the endpoints of those trajectories as 
approximation of those ridges after a long enough integration with respect to the evolutionary 
variable s of system (5.12). Further details of this algorithm are described in Mathur et al. 
(2007). Examples of repelling and attracting LCSs visualized by numerically extracted FTLE 
ridges in nonrecurrent 2D and 3D flows are shown in Fig. 5.10.
A further application of FTLE analysis to a 3D turbulent channel flow is given by Green 
et al. (2007), who seek to determine the Lagrangian footprint of hairpin vortices identified 
previously only from Eulerian considerations in the instantaneous velocity field (see Zhou 
et al., 1999). Figure 5.11 shows how the threshold-free, frame-indifferent visualization via 
backward FTLE reveals the bounding material surfaces of a hairpin vortex, in previously 
unseen detail, as attracting LCSs.
Another application of FTLE analysis of passive pollution control in Monterey Bay, 
California is given by Lekien et al. (2005). They use surface velocity fields reconstructed 
from high-frequency coastal radar stations to compute the forward FTLE field in the Bay. 
They then demonstrate by simulations that a timed pollution release scheme based on the 
location of the most influential FTLE ridge speeds up the clearance of pollutants into the 
open ocean (see §6.2.1 for details). Shadden (2011) reviews further aspects and applications 
of FTLE computations in specific flow problems.
5.2.6 Hyperbolic LCSs vs. Stable and Unstable Manifolds 
in Temporally Recurrent Flows
We now examine the relationship between hyperbolic LCSs extracted as FTLE ridges and 
stable and unstable manifolds of fixed points of Poincare maps for time-periodic flows. As

5.2 Advective Transport Barriers as LCSs
157
Repelling LCS
Repelling LCS Attracting LCS
Attracting LCS
Attracting LCS
Repelling LCS
b
Figure 5.10 Examples of advective transport barriers (hyperbolic LCSs) identified 
from forward and backward identified FTLE ridges. (a) The Lagrangian skeleton of 
turbulence extracted by Mathur et al. (2007) from a 2D rotating flow experiment. Here, 
repelling LCSs (red) are marked by ridges of the forward FTLE field. Attracting LCSs 
(blue) are marked by ridges of the backward FTLE field. (b) A similar computation 
by Kasten et al. (2010) for the von Karman vortex street behind a cylinder. The height 
of the gray surface represents the maximum of the forward and backward FTLEs. (c) 
Repelling (red) and attracting (blue) LCSs computed by Lekien and Ross (2010) for 
a perturbed four-vortex-ring model of the 2002 splitting of the Antarctic ozone hole. 
Adapted from Haller (2015).
noted in §4.1.1,the observed impact of unstable manifolds on nearby trajectories is attraction. 
When advected under the full flow map, therefore, these material lines are expected to act as 
attracting LCSs. Likewise, stable manifolds in Poincare maps repel nearby trajectories and 
hence should be repelling LCSs under advection by the flow map.
Without having to construct and iterate Poincare maps, therefore, we can also directly 
extract advective transport barriers as LCSs in time-periodic flows via FTLE ridges, as 
indicated inChapter 4 in connection with Fig. 4.10. Note, however, that initial conditions in 
our selected numerical grid G0 fall on stable and unstable manifolds with probability zero, 
and hence trajectories starting from G0 will be off the actual stable and unstable manifolds 
with probability one. Consequently, nearby initial conditions x0 2 G0 lying on opposite sides 
ofa stable manifold will be repelled from each other in forward time. Similarly, nearby initial

158
Lagrangian and Objective Eulerian Coherent Structures
Streamwise cut of backward FTLE 
0
0.2
y 0.4
0.6
0.8
Spanwise cut of backward FTLE
Eulerian signature of 
hairpin vortex in the
21 field
0
0.5
1.0 
2.5 
3.0 
3.5 
4.0
12346
4.0
3.5
3.0
2.5
Wall-normal cut of backward FTLE
2346
y
Figure 5.11 (Left) Eulerian signature of a hairpin vortex in the swirling strength field 
c2i (see §3.7.1), visualized as a level set corresponding to the 10% of the maximal 
c2i value. (Right) Cuts of the 3D backward FTLE field along the three planes shown
on the left. Adapted from Green et al. (2007).
conditions lying on opposite sides of the unstable manifold will be attracted to each other in 
forward time, as we illustrate in Fig. 5.12.
Figure 5.12,however, also illustrates an inherent asymmetry in the extraction of attracting 
and repelling LCSs from flow data. While typical small perturbations to a trajectory in 
the stable manifold Ws(p° will grow exponentially for all times, the forward-time behavior 
of typical small perturbations to a trajectory in the unstable manifold Wu (p° is generally 
unknown. Indeed, Wu (p° will generally lose its exponential attraction away from the fixed 
points. This is why initial, time t0 positions of stable manifolds are marked by ridges of the 
forward FTLE, whereas final, time t1 positions of unstable manifolds are marked by ridges 
of the backward FTLE.2
5.2.7 Repelling and Attracting LCSs from the Same Calculation
As we have seen, repelling LCSs at time t0 are highlighted by ridges of FTLEtt01 (x0 °, whereas 
attracting LCSs at time t1 are highlighted by ridges of FTLEtt01 (x°: Therefore, locating both 
types of LCSs in this fashion requires two separate numerical runs, involving the forward
2 Launching initial conditions very close to p near Wu(p° would actually result in an FTLE ridge even along a 
short segment of W u (p° if t1 -10 is not too large. This is due to exponential stretching along W u (p° that nearby 
trajectories experience while they are still close to p (see Karrasch, 2015, for a detailed simulation illustrating 
this).

5.2 Advective Transport Barriers as LCSs
159
Figure 5.12 Repelling and attracting LCSs associated with a fixed point p of a 
Poincare map in time-periodic flows (see §4.1) are expected to be highlighted by 
forward-time and backward-time FTLE ridges. This is due to the evolution of distances 
between initial conditions released near Ws (p) and Wu (p) in forward and backward 
time, respectively, from a grid G0 .
and the backward advection of two separate sets of initial conditions. This can be a taxing 
undertaking, especially for 3D unsteady flows.
Haller and Sapsis (2011) observe that we can obtain the same information from a single 
numerical run. To see this, we first define the smallest forward FTLE,
rt01 (xo° = m , I log A1(xo; 10; 11°; 
(5-13)
2 j 11 - 10 j
over evolving trajectory positions. From the relation (2.101), one obtains that
FTLEtO (x° = -TtO (Ft0 (x°°: 
(5.14)
If one uses SVD to obtain the singular values of the deformation gradient (see §5.2.4), 
then one also obtains the smallest Cauchy-Green eigenvalue A1(x0; 10; 11° from the same 
calculation, and hence rt) (x0° is readily available from (2.101). Equation (5.14) then shows 
that from the same numerical run that generates the forward FTLE field, one can also identify 
attracting LCSs as trenches (or inverted ridges; see §A.2 for definitions) of the smallest FTLE 
field rt0 (x0° graphed over current trajectory positions x.
Haller and Sapsis (2011) also note that for 2D incompressible flows, formula (5.14) implies
FTLEtt01(x° = FTLEtt10((Ftt01(x°°; 
(5.15)
given that 1 2 
1 holds for the Cauchy-Green eigenvalues. In such flows, therefore,
repelling LCSs at time t0 are highlighted by the ridges of the maximal FTLE graphed over 
x0, whereas attracting LCSs at time t1 are highlighted by the ridges of the maximal FTLE 
field graphed over the final particle positions x.
This one-off computation saves time but also has a shortcoming: formula (5.15) only 
yields attracting LCSs at time t1 at locations visited by the particles released from the initial 
grid G0 at t0 . As a consequence, FTLE plots will be limited to a smaller spatial domain and

160
Lagrangian and Objective Eulerian Coherent Structures
will have lower, nonuniform resolution than a full calculatios of FTLEt0 (xj ° initialized over 
a uniform grid o e points xj 2 G1 at time t1 would have. All this cahe lead to interpolation 
problems in the FTLE plots computed over advected positions, as shown in Fig. 5.13(b). 
These problems can neverthelesstbe mitigated by interpolating the values FTLEtt1 ((Ftt0 (xi °° 
at the current, scattered particle positions xi onto points xj- of a regular grid G1. One can 
then plot the interpolated field FTLEt0 ((Ft1 (xj- °° Ever to obtain a better visualization of 
the attracting LCS at timert1, as shown in s ig. 5.13ra)e 
t ee roa w e
FTLEtt01(xj)
(a)
FTLEtt10((Ftt10(xi))
(b)
FTLEtO ((Ftl (xj))
(c)
Figure 5.13 Comparison of different algorithms for visualizing repelling LCSs at 
time t1 in a damped-forced nonlinear oscillator with a double-well potential (the 
Duffing equation). (a) The backward FTLE field FTLEtt01 (xj° computed over points 
xj of a regular grid G1 placed at time t1 . (b) The forward FTLE field FTLEtt10 (Ftt10 (xi °° 
plotted over scattered current positions xi of trajectories at time t1. (c) The forward 
FTLE field FTLE^J (Ft0 (xi °° interpolated onto points xj of a regular grid G1 at time 
11, then plotted over these grid points as FTLEtJ (F^0 (xj °°. Adapted from Haller and 
Sapsis (2011).
5.2.8 FTLE vs. Finite-Size Lyapunov Exponents (FSLE)
A popular Lagrangian diagnostic for trajectory separation in the geophysics literature is the 
finite-size Lyapunov exponent (FSLE). To compute the FSLE, one fixes an initial trajectory 
separation 0 > 0 and a separation factor r > 1 of interest. The separation time (x0; t0; 0;r° 
can then be defined as the smallest length of time in which the distance between a trajectory 
starting from x0 at time t0 and some neighboring trajectory starting 0-close to x0 at the 
same time t0 first reaches r0. With these quantities, Artale et al. (1997), Aurell et al. (1997) 
and Joseph and Legras (2002) define the FSLE associated with the initial location x0 as the 
Lagrangian scalar field
FSLEto (x0; 60; r° b log r . 
(5.16)
0 
(x0; t0; 0;r°
By definition, the FSLE infers a local separation exponent for each initial condition x0 over 
a different time interval of length (x0; t0; 0; r°. As a consequence, unlike the FTLEtt10 field, 
the FSLEt0 field has no direct connection to the flow map Ftt10 and depends on the choice of 

5.2 Advective Transport Barriers as LCSs
161
the initial separation and the separation factor. The geophysics community generally views 
these differences as advantages of the FSLE over the FTLE, arguing that these enable the 
statistical detection of material stretching and mixing at different length scales (Cencini and 
Vulpiani,2013;Poje et al., 2014).
Beyond their use in flow statistics, however, ridges of the FSLE field have also been 
proposed as delineators of hyperbolic LCSs, based on an analogy with the FTLE field 
(see, e.g., Joseph and Legras, 2002,d’Ovidio et al., 2004 and Bettencourt et al., 2013). 
This analogy is heuristic because FSLE ridges are constructed from separation exponents 
extracted over a range of different time intervals, whereas FTLE ridges represent maximal 
separation exponents over the single time interval »10; 11 ]. In addition, FTLE quantifies the 
separation of infinitesimally close trajectories, wheres FSLE is specifically geared towards 
assessing separation of trajectories starting at a finite distance 0 .
Seeking to establish a mathematical relationship between FTLE and FSLE ridges, Karrasch 
and Haller (2013) introduce the infinitesimal-size Lyapunov exponent (ISLE), as the 0 ! 0 
limit of the FSLE as follows:
ISLEt0 (x°; r° b Jim FSLEt° (x°; 5°;r°. 
(5.17)
They then obtain that robust FSLE ridges (as defined in Appendix A.2) with moderate 
ISLE variations and high normal steepness at their peaks signal nearby robust FTLE ridges 
t°+ logr
whenever the dominant eigenvalue, 2max, of the tensor field Ct° ISLEt°(x°’r° (x0° is simple and
@tImax (Ct°(x°°)Lf + logr 
^ ° 
(5.18)
° 
/lt=t°+ ISLEt° (x°;r)
holds in a neighborhood of the robust FSLE ridge.
The nondegeneracy condition (5.18), however, will be violated along families of surfaces 
along which the FSLE field admits jump-discontinuities. Such families of FSLE jump­
surfaces turn out to be generically present in any nonlinear flow, causing sensitivity in FSLE 
computations, as illustrated for a steady, 2D double gyre flow in Fig. 5.14.This sensitivity 
may impact the accuracy of FSLE statistics, as already noticed by LaCasce (2008) for 
observational ocean data.
In addition to these jump discontinuities and the temporal sensitivity they cause, Karrasch 
and Haller (2013) also identify additional challenges in FSLE computations. These include 
ill-posedness for certain ranges of the separation ratio r and insensitivity to changes in the 
flow once the separation time is reached.
5.2.9 Parabolic LCSs from FTLE
Having discussed the diagnostic identification of hyperbolic LCSs in detail, we now turn 
to parabolic LCSs. We defined these LCSs at the beginning of §5.2 as a subclass of shear 
LCSs that distinguish themselves as minimally shearing surfaces. The most notable examples 
of such transport barriers include jet cores, such as the theoretical centerpiece of the Gulf 
Stream shown in Fig. 5.1(d).
The inability of the FTLE to distinguish between normal repulsion or tangential shear 
for a material surface (see §5.2.2) becomes an advantage in locating parabolic LCS. Since

162
Lagrangian and Objective Eulerian Coherent Structures
Jump discontinuities in the FSLE field
Figure 5.14 Jump discontinuities of the FSLE field computed with r = 6 for the 
steady limit of the double gyre flow model introduced in Shadden et al. (2005). (Left) 
The FSLE0(x0; 0:1; 6° field as a function of the initial positions x0 = (x0; y0). (Right) 
The same but restricted to the y0 = 0:48 line. Adapted from Karrasch and Haller 
(2013).
a parabolic LCS resides in a domain filled by other (more shearing) material surfaces, the 
FTLE will measure predominantly shear-type deformations in such regions. Based on this, 
one expects parabolic LCSs to minimize the FTLE field in directions normal to them, i.e., 
form trenches for the FTLE field. This leads to the following objective diagnostic principle 
first formulated by Beron-Vera and coworkers (Beron-Vera et al., 2008b, 2010, 2012).
Proposition 5.5 For 11 -10 large enough, time 10 positions of parabolic LCSs will generically 
align with codimension-1 trenches of the largest eigenvalue dn(x0; 10,11° of the forward 
Cauchy-Green strain tensor Cjj (x0 ), or, equivalently, with the trenches of FTLEt0 (x0).
The same diagnostic principle is equally valid in both forward and backward time cal­
culations launched from 10, but the two calculations may have differing trench locations in 
their FTLE fields. Indeed, forward and backward computations will technically target two 
different finite-time dynamical systems unless the flow is exactly recurrent. Figure 5.15 il­
lustrates this difference in an atmospheric wind field simulation by Beron-Vera et al. (2012). 
The differences between the two computations are visible but small, which suggests robust 
zonal jet cores (red and blue curves) in this flow. Figure 5.16 confirms that the parabolic LCS 
identified in this flow are indeed strong barriers to advective transport, keeping the green and 
orange tracers released on July 1, 2000 on the same side of the jet cores even a month later.
As Beron-Vera et al. (2012) point out, the numerical extraction of FTLE trenches is 
conceptually similar to those of FTLE ridges (see §5.2.5), but targets trenches as attractors 
of the negative gradient dynamical system
dt
dSs X0(s° = -rFTLEJ (x0(s)), 
(5.19)
as opposed to the gradient system (5.12). Apart from this sign difference, the details of a 
simple trench extraction procedure agree with those given in Mathur et al. (2007) for FTLE 
ridges

5.2 Advective Transport Barriers as LCSs
163
FTLEto+7days 
to
FTLEt0-7days 
to
to = July15,2000
Figure 5.15 Slight differences in parabolic LCSs (extracted as backward and forward 
FTLE trenches, respectively) in the Canadian Middle Atmosphere Model (CMAM). 
(Left to right) Zonally averaged zonal wind (thick) and potential vorticity (thin); 
the backward, forward and the backward-plus-forward FTLE fields on 10 = July 15, 
2000 (shown in grayscale). The thin (thick) red and blue curves mark trenches in the 
backward (forward) FTLE field. Adapted from Beron-Vera et al. (2012).
1[FTLEt0-7days + FTLEto+7days]
2 
to 
1 
to 
J
July 31, 2000
Figure 5.16 Parabolic LCSs (or jet cores) are indeed barriers to advective transport. 
Tracers released on July 1, 2000 along four different lines of constant latitude (left) 
in the model already analyzed in Fig. 5.15 do not penetrate the parabolic LCS shown 
in the back background FTLE image (grayscale) as a trench (right). Adapted from 
Beron-Vera et al. (2012).
We close by stressing that the converse of Proposition 5.5 is not true: FTLE trenches are 
only necessary (but not sufficient) diagnostic indicators of parabolic LCSs, just as FTLE 
ridges are only necessary indicators of hyperbolic LCSs (see §5.2.2). A simple example 
illustrating this is the 2D steady incompressible flow
x = x (1 + 3y2
y = - y(1 + y2
(5.20)
in whichothe y = 0 axis is clearly an (exponentially) attracting LCS, and yet both the forward 
and backward FTLE fields develop trenches along this line, as shown in Fig. 5.17.

164
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.17 The tracer evolution in the steady flow (5.20). (Left) Initial blob of 
tracers centered at the origin at time t = 0. (Right) The advected set of tracers at time 
t = 1:5. The forward-time FTLE field FTLE^0 is shown in the background, displaying 
a clear trench along this repelling LCS. Adapted from Farazmand et al. (2014).
5.2.10 Elliptic LCSsfrom the Polar Rotation Angle (PRA)
As we have seen, the FTLE is a simple and efficient diagnostic tool for transport barriers 
causing locally the largest normal growth or decay in their normal perturbations (hyperbolic 
LCSs) or locally the smallest tangential growth in their normal perturbations (parabolic 
LCSs). In contrast, elliptic LCSs, as defined in §5.2, distinguish themselves by their global 
(circular, cylindrical or toroidal) geometry beyond their locally most-shearing character. For 
this reason, FTLE field is not an optimal detection tool for elliptic LCSs.
Specifically, while FTLE valleys tend to signal vortical domains of low stretching in most 
flows of practical interest (see, e.g., Figs. 5.10 and 5.15), these valleys are typically infiltrated 
with ridges spiraling into vortex-type regions. Figure 5.18 illustrates this phenomenon on 
the Agulhas region of the Southern Ocean using the AVISO ocean surface velocity field 
(see Appendix A.6). The spiraling FTLE ridges seen in this figure simply connect locations 
of high stretching with locations of high shear, yet they are typically viewed as indicators 
of repelling material lines. Such hyperbolic LCSs would in turn imply a complete lack of 
coherent material vortices in these domains, as such vortices would lose their integrity and 
develop filaments under the effect of repelling LCS. In contrast, nonobjective diagnostics, 
such as streamline plots and Okubo-Weiss Q parameter plots shown in Fig. 5.18, do predict 
some vortices in these regions, but the validity of their projections for coherent material 
vortex boundaries is unclear for the reasons discussed in §3.7.
For efficient detection of elliptic LCSs, therefore, we need to quantify rotational coherence 
in Lagrangian terms, as opposed stretching-based coherence. The simplest measure of local 
material rotation in the flow (5.1) over a finite time interval»10,11] is the polar rotation tensor 
Rtt0, defined via the polar decomposition formula (2.110). Indeed, as we discussed in §2.3.2, 
the polar decomposition of the deformation gradient rFt0(x0° yields Rt0(x0° as the rotation 
closest to rFt0(x0° in the Frobenius matrix norm. A scalar diagnostic tool for rotational 
coherence can then be defined as the polar rotation angle field ©t0 (x0° generated by the tensor 
field Rt0(x0° along individual trajectories. One can then approximate time 10 positions of 
elliptic LCSs as closed level sets of ©t0(x0°.
The rationale for this approach stems from the study of temporally T -periodic flows via 
their Poincare maps (see §4.1). In such flows, all trajectories starting from an elliptic transport 
barrier (i.e., closed invariant curve) of the Poincare map have the same rotation number, which

5.2 Advective Transport Barriers as LCSs
165
forward FTLE 
streamlines
Figure 5.18 FTLE ridges tend to penetrate the cores of vortical features in the 
AVISO ocean data set, suggesting the general nonexistence of coherent mesoscale 
Lagrangian eddies. (Left) Typical mesoscale FTLE features computed from satellite 
altimetry data. (Middle) Instantaneous streamlines (constant sea-surface height plots) 
in the same region. (Right) Vortices suggested by the Okubo-Weiss criterion (i.e., 
regions of Q > 0; see formula (3.56)). Adapted from beron-vera et al. (2008a).
25°S
30" S
35"S
Okubo-Weiss elliptic regions
20°W 
10"W 
0 
ICE
is the infinite-time limit of the total angular displacement along the closed curve divided by 
the number of iterations (see Gole, 2001). As Rt0+T is the best fitting rotation to the linearized 
Poincare map, one expects the same number of polar rotations to arise asymptotically along 
all trajectories starting from the same closed invariant curve. Equivalently, one expects the 
level curves of the polar rotation angle to approximate closed invariant curves of the Poincare 
map more and more accurately for higher and higher iterations of the map.
With this motivation at hand, we recall from §2.3.2that the total polar rotation angle 
(PRA), can be computed for the finite-time dynamical system (5.1) in the 3D case (n = 3) as 
3
PRAt0 (X0 ° = cos’1
1 \31
2 X h&(x0; 10; 11°;^'t0; ti°i _ 1 ;
(5.21)
i=1
J
with i and i corresponding to the left and right singular vectors of rFtt0 (i.e., eigenvectors 
of Ct0 and Bt0), respectively. If system (5.1) is 2D (n = 2°; then we obtain the formula for the
PRA from (2.121) as
PRAt0(x0° = cos 1 h£1(x0; 10; 11°;^(x^; 10; 11°i = cos 1 h&(x0; 10; 11°;^(x0; 10; 11°i. (5.22)
As we have already concluded in the transformation formulas (3.55), the polar rotation 
tensor transforms under a Euclidean observer change (3.5) as
R t0 = QT( t )R0 Q( 10°; 
(5.23)
and hence is objective as a two-point tensor. We have also shown, however, that the traces of 
two-point tensors are not invariant: their value depends on the bases chosen in their domain 
and range spaces (see §3.5). As a consequence, the PRA, which is purely a function of tr Rtt0 
(seeEqs. (2.119) and ( 2.121)), is not an objective scalar field. For this reason, we will not 
use the PRA to detect advective transport barriers in 3D fluid flows.3
3 We will, however, use PRA as a diagnostic tool to study vector fields that are objective (unlike fluid velocity 
fields). Examples of objective vector fields are the active barrier vector fields arising in the study of the transport 
of dynamically active vector fields, such as the vorticity and the momentum, inChapter 9 . For these vector fields, 
any time-dependent Euclidean observer change translates to a one-time, initial rotation of the coordinate axes, 
which does not affect the value of the rotation angle between initial and final configurations.

166
Lagrangian and Objective Eulerian Coherent Structures
In 2D flows, however, the level curves of PRA turn out to be objectively defined, even if 
the values of PRA on those level curves will be frame dependent. Indeed, as observed by 
Farazmand and Haller (2016), for the matrix representation
Rto (X0° =
cos [PRAt0 (xo)] 
sin [PRAt0(xo°]
- sin [PRAt0 (xo°] ! 
cos [PRAt0(x0°] i
(5.24)
of the polar rotation tensor in a given orthonormal basis, the additivity of rotations in two 
dimensions implies that the transformed polar rotation tensor Rt0 in (5.23) can be written as
R t0 (y0°=
cos [PRAt0(X0° + q(10° - q(11°] 
sin [PRAt0 (X0° + q(10° - q(11°]
- sin [PRAt0(X0° + q(10° - q(11°] 
cos [PRAt0 (X0° + q(10° - q(11 °] ,
(5.25)
where q(t° is the angle of rotation associated with the tensor Q(t°. Computing the traces of 
the matrices in Eqs. (5.24) and (5.25) then substituting the result into the 2D polar rotation 
angle formula (2.120), we obtain
t1
PRAt0 (yc° = PRAt0 (x0° + q (t0° - q (t1 °
(5.26)
with x0 = Q(t0°y0 + b(t0°: By formula (5.26), the PRA clearly changes its value in the 
new frame and hence is not an objective Lagrangian scalar field (see §3.4.1). However, the 
difference, q(10° - q(11°, in PRA values between the two frames is exactly the same at all 
spatial locations. Therefore, the level curves of PRAtt01 remain unchanged by the frame change, 
as claimed.
These considerations lead to the idea to use closed curves of the PRA as proxies for 
elliptic LCSs in 2D unsteady flows. A nested family of such level curves surrounding an 
isolated local maximum of the PRA can in turn be viewed as a coherent Lagrangian vortex 
(or material vortex) whose vortex center is the location of local maximum, shown in Fig. 
5.19. In principle, the vortex boundary is the singular level curve bounding the elliptic LCS 
family from the outside.
Lagrangian vortex center: 
local maximum of the PRA
elliptic LCS: 
smooth and closed 
PRA level curve
coherent Lagrangian vortex: 
nested family of elliptic LCSs
observed vortex boundary: 
outermost elliptic LCS 
computable from the available 
resolution for the PRA
theoretical vortex boundary: 
singular PRA level curve
Figure 5.19 Schematic of a coherent Lagrangian vortex identified from the PRA in 
a 2D flow. The vortex is filled with elliptic LCSs surrounding a PRA maximum at 
the center of the vortex. The theoretical vortex boundary is the non-smooth outer 
boundary of the elliptic LCS family.

5.2 Advective Transport Barriers as LCSs
167
We summarize these ideas in a definition that will serve as an objective diagnostic principle 
for elliptic LCSs, coherent Lagrangian vortices and vortex centers in 2D flows.
Definition 5.6 At time t0, PRA-based elliptic LCSs in the finite-time flow (5.1) are smooth, 
closed and convex level curves of the polar rotation PRAt0 (x0° surrounding a unique local 
maximum. PRA-based coherent Lagrangian vortices are formed by nested families of PRA- 
based elliptic LCSs. PRA-based vortex centers in such Lagrangian vortices are marked by a 
local maximum location of PRAt1 (x0° surrounded by the elliptic LCSs.
This definition is equally applicable to forward and backward calculations launched from 
t0, but the two calculations generally return different elliptic LCSs unless the underlying flow 
is recurrent.
Each PRA-based elliptic LCS covered by Definition 5.6 is expected to be observed as 
a barrier to advective transport inside the Lagrangian vortex. Indeed, material elements 
along such an elliptic LCS complete exactly the same rotation which does not allow for 
the development of smaller scales (filaments) along the LCS. The lack of filamentation 
(coherence) is then observed as no penetration of fluid particles into or out of the interior of 
the LCS. As we noted at the beginning of this chapter, all material curves block transport 
across themselves, but only those are observed as barriers to advective transport that keep 
their coherence and hence disallow protrusions between the spatial regions on their two sides.
The theoretical vortex boundary shown in Fig. 5.19 is conceptually justified but unfeasible 
to compute from a data set. This is because no point of a discrete numerical grid will 
fall on this theoretical boundary with nonzero probability. For this reason, the practically 
detected boundary of a PRA-based Lagrangian vortex is the outermost closed PRA level 
curve computed numerically for the given data resolution. The vortex boundary obtained in 
this fashion will then necessarily converge to the theoretical boundary upon refinement of 
the numerical grid.
As for the practical numerical implementation of the PRA-based search for elliptic LCSs, 
we can use the same basic numerical procedure as for hyperbolic and parabolic LCSs to 
obtain the SVD of the deformation gradient (see §2.3.1). This yields the necessary left and 
right singular vectors pairs, (£i> ^i), either of which can be used in the 2D PRA formula (5.22). 
The procedure is completed by a level surface plot of the PRA computed in this fashion. 
If more than a visual identification of Lagrangian vortices is required, then an automated 
search for nested sets of closed PRA level sets surrounding a PRA minimum is necessary as 
a last step. The PRA computation in 2D is implemented in Notebook 5.3. 
—
Notebook 5.3 (PRA2D) Computes the polar rotation angle (PRA) field for a 2D unsteady 
velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/PRA2D
An application of PRA-based elliptic LCS detection in a 2D turbulence simulation is shown 
inFig. 5.20.
For reference, Fig. 5.20 also shows the instantaneous vorticity level sets identified at time 
t0 . Several of these level sets do give an indication of vortical regions, but the PRA reveals 
which one of these candidate regions will experience coherent material rotation evidenced

168
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.20 Instantaneous vorticity (left) at t0 = 50 and the polar rotation angle 
PRAt1 (xo° computed up to time 11 = 100 (right) in a 2D direct numerical simulation 
of homogeneous and isotropic turbulence on a doubly periodic domain. Adapted from 
Farazmand and Haller (2016).
by a family of nested elliptic LCSs. Another strong point of the PRA is the precise locations 
it provides for coherent vortex boundaries and vortex centers.
Finally, in Fig. 5.21 we show more detail for one of the coherent Lagrangian vortices 
seen in Fig. 5.20, as well as the materially advected positions of two eliipiic LCSs inside 
this vortex. Note the lack of filamentation in these advected curves, which confirms their 
coherence and hence their role as observed barriers to advective transport.
elliptic LCS
background turbulence
observed L-Igiitn.ian 
voi-lex boundaiy
to = 50
Figure 5.21 (Left) Details of an individual coherent Lagrangian vortex from the 
2D turbulence simulation shown in Fig. 5.20. (Right) Materially advected positions 
of one of the elliptic LCSs in the interior of the Lagrangian vortex (blue) and of 
another one forming the observed boundary of the vortex. Adapted from Farazmand 
and Haller (2016).
materially advected LCS 
and voitex boundaiy
ti = 100

5.2 Advective Transport Barriers as LCSs 
169
5.2.11 Elliptic LCSs from the Lagrangian-Averaged Vorticity Deviation
To remedy the nonobjectivity of the PRA in 3D flows, we now turn to the dynamic version 
of the polar decomposition discussed in §2.3.3. Based on the same arguments introduced in 
the previous section, we continue to seek elliptic LCSs as codimension-1 material surfaces 
displaying rotational coherence. This time, however, following Haller et al. (2016), we will 
use a different measure of material rotation instead of the polar rotation angle.
To this end, we recall from §2.3.3 that the total accumulated rotation angle (without 
cancellations) generated by relative rotation tensor tt0 around the local relative vorticity 
vector ! (Ft0 (x0), t) - !(t° can be computed as the intrinsic dynamic rotation angle, ^0. This 
prompts us to define the Lagrangian-averaged vorticity deviation (LAVD) as
2 c (xo° 
1 
rr
LAVDt0(xo° :=^t° - =-— 
|!(FS0(M; s°~ !(s)| ds; 
(5.27)
t t0 
t t0 J to
with the instantaneous spatial mean !(t° of the vorticity field !(x t° (see Fig. .,22 for 
the underlying geometry). By the objectivity of tt0 , LAVDtt0 is an objective Lagrangian 
scalar field in any dimension. This objective rotation angle also offers an appealingly direct 
connection with vorticity, the central (nonobjective) quantity in fluid mechanics for the 
description of flow rotation.
Unlike the PRA, the LAVD depends on the reference fluid mass D(t° chosen for the 
computation of !(t°. As noted in §2.3.3, hie best choice for D(t° is the full flow domain, 
prompting the LAVD to provide the best available assessment for the deviation of local 
rotation from the overall rotation of the fluid. The computation of the LAVD for 2D flows in 
implemented in Notebook 5.4. 
—
Notebook 5.4 (LAVD2D) Computes the Lagrangian-averaged vorticity deviation (LAVD) 
field for a 2D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/LAVD2D
The computation of the LAVD for 3D flows in implemented in Notebook 5.5.
Notebook 5.5 (LAVD3D) Computes the Lagrangian-averaged vorticity deviation (LAVD) 
field for a 3D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ AdvectiveBarriers/ LAVD3D
Application of LAVD to 2D Flows
In 2D flows, our approximation of elliptic LCSs, coherent Lagrangian vortices and their 
centers via the LAVD follows the same principles that we have outlined for the PRA. For 
completeness, we summarize elements of the LAVD-based Lagrangian vortex identification 
inFig. 5.22.
The corresponding objective diagnostic principle for elliptic LCSs in 2D flows can be 
stated as the following definition.

170
Lagrangian and Objective Eulerian Coherent Structures
Lagrangian vortex center: 
local maximum of the LAVD
elliptic LCS: 
smooth and closed 
LAVD level curve
coherent Lagrangian vortex: 
nested family of elliptic LCSs
observed vortex boundary: 
outermost elliptic LCS 
computable from the available 
resolution for the LAVD
theoretical vortex boundary: 
singular LAVD level curve
Figure 5.22 Schematic of a coherent Lagrangian vortex identified from the LAVD 
in a 2D flow.
Definition 5.7 At time t0, LAVD-based elliptic LCSs in the finite-time flow (5.1) with n = 2 
are smooth, closed and convex level curves of the Lagrangian-averaged vorticity devia­
tion LAVDt0(x0° surrounding a unique local maximum. LAVD-based coherent Lagrangian 
vortices are formed by nested families of LAVD-based elliptic LCSs. LAVD-based vortex 
centers in such Lagrangian vortices are marked by a local maximum location of LAVDtO(x0° 
surrounded by the elliptic LCSs.
As in the case of the PRA, the same diagnostic principle applies in both forward and back­
ward time but the two calculations generally return different elliptic LCSs for nonrecurrent 
flows. Unlike the PRA, however, the LAVD also has a direct connection to observed attractors 
and repellers of finite-size (or inertial) particles drifting passively in 2D geophysical fluid 
flows (see Chapter 7 for further discussion on barriers to inertial particle transport). Specif­
ically, building on work on the equations of motion derived by Beron-Vera et al. (2015), 
Haller et al. (2016) consider a geostrophic flow under the -plane approximation and assume 
the presence of an LAVD-based coherent Lagrangian vortex center with initial position x0 . 
They also assume that the relative Eulerian rotation direction, measured at the materially 
evolving vortex core, is constant in time, i.e.,
sign [! (Ft0(xO); t) - !j(t)] h ^(x0) = const.; 
t 2 »10, t1]. 
(5.28)
Furthermore, for a spherical inertial particle of radius r0 > 0 and density part in a fluid of 
density and viscosity > 0, they define the non-dimensional inertial parameter
2r0 part
9vp ’
(5.29)
and also use the Coriolis parameter f , which is twice the local vertical component of the 
angular velocity of the Earth. In this notation, a particle is considered heavy (relative to the 
carrier fluid) if ppart > p and light if ppart < p. Using these definitions, Haller et al. (2016) 
prove the following result:
Theorem 5.8 Under assumption (5.28), for > 0 small enough, the following hold:
(1° In a cyclonic LAVD-based coherent vortex (p(x*0°f > 0), there exists a finite-time 
attractor (repeller) for light (heavy) particles that stays O(t°-close to the evolving vortex 
center Ftt0 (x0° over the time interval »t0; t1].

5.2 Advective Transport Barriers as LCSs
171
(2° In an anticyclonic LAVD-based coherent vortex (^(x*0° f < 0), there exists a finite-time 
attractor (repeller) for heavy (light) particles that stays O(r)-close to the evolving vortex 
center Ft0(x0° over the time interval»10 11].
A simulation confirming these statements, as well as the rotational coherence of LAVD- 
based Lagrangian vortices (mesoscale eddies in the ocean), is shown in Fig. 5.23(a).In 
these computations of the LAVD, we use the general observation that on large enough ocean 
domains containing several eddies, the mean vorticity satisfies !)3(t° « 0 (see Haller et al., 
2016;Abernathey and Haller, 2018;Beron-Vera et al., 2019b). The materially advected 
eddy boundaries (black) in Fig. 5.23(b) illustrate the difference between stretching-based 
coherence (which would not allow filamentation in the eddy boundaries) and rotational 
coherence (which permits some tangential filamentation but no break-away from the rotating 
fluid mass of the coherent vortex). Also not in Fig. 5.23(b) that heavy (blue) and light (green)
(a)
OJ) 
o 
s
"O 
3 
-28
-29
-30
-31
-32
-33
-34
-35-4 
-2 
0 
2 
4 
6 
8
Figure 5.23 LAVD-based mesoscale eddies and inertial particles in the Agulhas leak­
age. (a) Initial positions of the coherent eddy boundaries (outermost extracted closed; 
convex contours of LAVDtt00+90 days° shown in red at t0 = November 11; 2006. Back­
ground: the contour plot of LAVDtt00+90 days(x0°. (b) Simulated inertial particle 
trajectories; see the text for details. A video showing the evolution of material 
eddy boundaries and simulated inertial particles is available at https://www 
.cambridge.org/core/journals/journal-of-fluid-mechanics/article/ 
abs/defining-coherent-vortices-objectively-from-the-vorticity/ 
559F52C404B54265CB7A64D4666EB096n#supplementary-materials.

172
Lagrangian and Objective Eulerian Coherent Structures
particles converge to the moving anticyclonic (counter-clockwise) and cyclonic (clockwise) 
vortex centers, respectively, as predicted by Theorem 5.8.
Once fluid trajectories have been generated from a velocity field, the computation of 
the LAVD is more straightforward than that of the PRA because no computation of the 
deformation gradient is required. At the same time, the LAVD relies on the numerical 
differentiation of the vorticity. Altogether, the extraction of coherent vortex boundaries from 
LAVD calculations is more sensitive to numerical errors and discretization effects than PRA- 
based calculations and the variational approaches discussed in the following sections of this 
chapter (see, e.g., Andrade-Canto et al., 2020,for an example). A way to mitigate these 
sensitivities is to restrict the search for outermost closed LAVD level curves in a nested 
family to curves whose convexity deficiency4 stays below a certain threshold (see Haller 
et al., 2016,for details of the algorithm). An alternative threshold parameter, the coherency 
index, has been developed by Zhang, W. et al. (2020).
4 The convexity deficiency of a closed curve on a plane is defined as the ratio of the area between the curve and 
its convex hull to the area enclosed by the curve.
Combined with such numerical control parameters, LAVD is also able to detect coherent 
Lagrangian swirls, a class of Lagrangian flow structures with relaxed coherence properties in 
submesoscale-resolving numerical ocean data. The boundaries of these Lagrangian features 
undergo substantial stretching, yet the fluid mass they enclose preserves its bulk integrity to a 
high degree, displaying signs of overall material coherence. We show such a feature identified 
in the Gulf of Mexico in Fig. 5.24, detected as the region enclosed by an outermost closed 
LAVD curve with convexity deficiency not exceeding 0:25. The figure also demonstrates the 
inability of the Okubo-Weiss criterion to isolate this coherent features as an elliptic region.
More recent applications of LAVD-based coherent vortex detection have appeared in 
Abernathey and Haller (2018); Liu, T. et al. (2019), yielding systematic mesoscale eddy 
censuses based on the LAVD. These authors invariably find that only a fraction of eddy 
locations inferred from the (nonobjective) nonlinear eddy criterion (see §3.7.1) indicate 
nearby eddies that transport water in a coherent fashion. Liu, T. et al. (2019) specifically 
find that about half of these nonobjective predictions mark regions that are no more coherent 
than any other randomly chosen ocean domain of similar size. LAVD-based coherent eddy 
detection, therefore, suggests an order of magnitude downward correction to earlier estimates 
for mesoscale eddy transport in the ocean by Zhang, Z. et al. (2014) and Dong et al. (2014).
LAVD-based vortex detection has also been used recently by Yang, K. et al. (2021) in 
medical imaging to identify differences between healthy and unhealthy heart conditions. The 
authors employ LAVD to determine the size of material vortices in the left ventricular blood 
flow of healthy subjects and patients. In the pre-ejection periods of their cardiac cycles, 
healthy patients have consistently displayed a smaller clockwise LAVD vortex than patients 
with uremic cardiomyopathy, as seen in Fig. 5.25.
In the middle of the ejection period, heathy subjects developed a smaller counter-clockwise 
vortex. No similar systematic differences were observed during the final ejection stage. The 
authors attribute the formation of larger vortices to cardiac hypertrophy (see Yang, K. et al., 
2021, for details and §5.7.3 for further related results involving objective Eulerian coherent 
vortices).

5.2 Advective Transport Barriers as LCSs
173
advected 
coherent Lagrangian swirl 
at the ends of the extraction 
intervals
initial position of 
coherent Lagrangian swirl 
for increasing extraction 
intervals
advected 
Okubo-Weiss elliptic region 
at the same time instances
initial position of 
Okubo-Weiss elliptic region
Figure 5.24 Coherent Lagrangian swirl in the Gulf of Mexico, identified from the 
LAVD and from the (nonobjective) Okubo-Weiss criterion (see §3.7.1). The first 
column of plots shows the initial position of the LAVD-based coherent swirl on May 
29, 2013 for the extraction times (i.e., 11 - 10 values) of 30, 60 and 90 days, as well 
as the Okubo-Weiss elliptic region on the same date. The second column shows the 
materially advected position of the swirls at the corresponding t1 times. The third 
column shows the corresponding advected positions of the Okubo-Weiss elliptic 
region. Adapted from Beron-Vera et al. (2019b).

174
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.25 LAVD-based material vortices in the left ventricular (LV) blood flow of 
a healthy subject and a heart patient. Different rows compare Lagrangian vortices in 
three different ejection stages of a cardiac cycle, indicated along a red electrocardio­
gram (ECG) reference line in the upper right corner of each plot. Shown in grayscale 
in the background are instantaneous ultrasound scans from which a velocity field was 
inferred using the vector flow mapping (VFM) algorithm. Adapted from Yang, K. 
et al. (2021).

5.2 Advective Transport Barriers as LCSs
175
200
400
600
800
1000
9
8
-31 
—32 
-33 7
Latitude (deg.) Longitude (deg.)
Figure 5.26 LAVD-based coherent Lagrangian vortex (yellow surface) and its core 
(red curve) identified from closed outermost LAVD level curves and the LAVD 
maximum they surround in horizontal planes. (Left) Initial position of the vortex, 
with nearby, noncylindrical LAVD level surfaces (green) shown for reference. (Right) 
Materially advected position of the vortex 120 days later. A video showing the 
material evolution of the Lagrangian vortex boundary is available at https://www. 
cambridge.o r g / core/journals/journal-of-fluid-mechanics/article/ 
abs/defining-coherent-vortices-objectively-from-the-v  o r t i c i ty/ 
559F52C404B54265CB7A64D4666EB096n#supplementary-materials.
Application of LAVD to 3D Flows
In3D flows, the LAVD has the advantage of objectivity, while the PRA is no longer objective, 
as noted in §5.2.10.If the flow is horizontally stratified, our 2D diagnostic principle for the 
LAVD (Definition 5.7) can be applied along horizontal planes, with the LAVD level curves 
and the maximum they surround identified in each plane separately and then connected 
together. This procedure effectively constructs elliptic LCSs as tubular level sets around a 
one-dimensional height ridge (see Appendix A.2) of the LAVD field.
An example of this procedure is shown in Fig. 5.26, with a 3D coherent Lagrangian vortex 
and its center identified from the LAVD computed along 2D horizontal slices in a 3D data- 
assimilating ocean circulation model (see Haller et al., 2016, for details). The figure also 
shows the materially advected position of this Lagrangian vortex 120 days later, at the end­
time t1 of its extraction interval. Note that the vortex boundary indeed remains rotationally 
coherent, showing only signs of slight tangential filamentation (ribbing).
For more general turbulent flows with no preferred orientation for vortices, a fully 3D 
approach is necessary for LAVD-based vortex detection. Such an approach has been put 
forward by Neamtu-Halic et al. (2019), who seek vortex center lines as one-dimensional 

176
Lagrangian and Objective Eulerian Coherent Structures
ridges of general orientation the fully 3D LAVD field. This diagnostic principle can be 
formulated as follows:
Definition 5.9 At time t0, LAVD-based elliptic LCSs in the finite-time flow (5.1) are smooth 
cylindrical level surfaces of the Lagrangian-averaged vorticity deviation LAVDt0(x0° sur­
rounding a unique, codimension-2 height ridge of LAVDtO (x0°. LAVD-based coherent La­
grangian vortices are formed by nested families of such elliptic LCSs. LAVD-based vortex 
centers in such Lagrangian vortices are marked by the codimension-2 ridge of LAVDtt10 (x0° 
surrounded by the elliptic LCSs.
This principle is general enough to cover 2D flows as well, for which codimension-2 
ridges of LAVDtt10 (x0° are simply local maximum points. Operationally, one-dimensional 
height-ridges of the LAVD field can be found in a way similar to the gradient-climbing 
algorithm we have discussed for FTLE ridges (see formula (5.30)). Specifically, based on the 
watershed and the structurally stable ridge definitions of Appendix A.2,the ridges we seek 
are one-dimensional attractors of the gradient dynamical system
d Xo( s ° = rLAVDtO (xo( s °°: 
(5.30)
ds 
t0
Following the algorithm we have described for FTLE ridges, we can launch trajectories 
of (5.30) in ridge neighborhoods identified from a rough thresholding, then seek converged 
locations spanned by the endpoints of those trajectories. A one-dimensional LAVD ridge 
located in this fashion marks the center line for a rotationally coherent Lagrangian vortex. 
Next, the definition of the height-ridge can be invoked from Appendix A.2 to seek outermost 
closed and convex LAVD level curves in planes normal to the ridge. The collection of these 
closed curves can then be used to construct the desired rotationally coherent Lagrangian 
vortex boundary. Details of this algorithm are described in Neamtu-Halic et al. (2019). An 
example of the application of this algorithm to velocity data obtained from the 3D gravity 
current experiment analyzed by Neamtu-Halic et al. (2019) is shown in Fig. 5.27.
5.3 Local Variational Theory of LCSs
The objective diagnostics we discussed for LCSs in §§5.1-5.2 are very effective for a quick, 
observer-independent identification of transport barriers in numerical and experimental flow 
data. They are, however, largely based on approximations to, rather than systematic math­
ematical implementations of, Definition 5.3 for LCSs. That definition stipulates that LCSs 
are the locally most influential material surfaces and hence their identification requires the 
solution of an optimization problem. Specifically, one needs to systematically quantify and 
compare the influence of a material surface with the influences of all neighboring material 
surfaces on fluid particles. The added advantage of solving this optimization problem is that 
the LCSs are no longer simply inferred by visual inspection of a plot, but are rendered as 
parametrized material curves or material surfaces.
Depending on how extensively one wishes to perform this comparison, the resulting 
optimization problem will vary from a simple, pointwise optimization to a complicated global 
optimization requiring the solution of nonlinear systems of partial differential equations. In

5.3 Local Variational Theory of LCSs
177
14
z (cm)
8
10
12
6
x (cm)
Figure 5.27 Coherent Lagrangian vortices (blue) identified above the turbu- 
lent/nonturbulent in interface (TNTI; shown in red) from the LAVD in a gravity 
current experiment. Darker blue curves mark one-dimensional LAVD ridges. The 
velocity field was obtained from 3D particle tracking velocimetry (PTV). Adapted 
from Neamtu-Halic et al. (2019).
this section, we discuss the simplest local optimization setting for locating LCSs, which we 
refer to as the local variational theory of LCSs.
In this theory, we compare the influence of a material surface in an infinitesimally small 
neighborhood of each of its points to the influences of all other material surfaces running 
through the same point. Technically, at each point x0 of a codimension-1, initial material 
surface M(10°, we will perturb the tangent space Tx0M(10° with unit normal n0 into planes 
with unit normals n0.7 These perturbed planes represent the tangent planes of all nearby 
material surfaces running through the point x0 . We then seek conditions under which the 
associated local material stretch factor p^ (x0; 60° or local material shear factor a% (x0; n0° 
has an extremum at n0 = n0 (see Fig. 5^28 for an illustration). We will locate hyperbolic and 
shear LCS as codimension-1 material surfaces that pointwise extremize (or at least render 
stationary) these local stretch and shear factors, which we will compute more precisely in the 
next section. For 2D flows, the codimension-1 material surface M(t° will be a material curve.
5.3.1 Local Variational Theory of Hyperbolic LCSs
To find a repelling LCS from its local variational theory over the time interval»10; 11 ], we have 
to find at each point x0 of the flow domain the tangent space Tx0M(t0° of an initial material 
surface M0 := M(t0° whose unit normal n0 maximizes the stretch factor ptt0
1 (x0; n0° shown 
in Fig. 5.28 at x0. In contrast, normals to the initial positions of attracting LCSs at t0 can 
be found by minimizing ptt1 (x0; n0 °. Once their initial positions are located, arbitrary later 
positions of these hyperbolic LCSs are fully determined by the flow map as M(t° = Ftt (M0°.
Based on Fig. 5.28, an expression for ptt1 (x0; n0° can be found by projecting the materially 
advected unit normal rFtt1 (x0°n0 onto the unit normal of the advected material surface 
7 A full local optimization of the surface M(t0°, including a perturbation to the point x0 in addition to the normal 
n0 , was also considered by Haller (2011), but it turns out to lead to an overconstrained problem for LCSs.

178
Lagrangian and Objective Eulerian Coherent Structures
VFt0 (xo)no
Figure 5.28 The geometry of local variational LCS theory, which constructs hyper­
bolic and shear LCSs as pointwise stationary surfaces of the material stretch factor 
pf0 (x0.n0° or local material shear factor ^f (x0.ft0°, with respect to changes in ft0. 
These factors are defined as normal and tangential projections, respectively, of the 
advected unit normal rFf0 (x0 °n0 onto the normal space and tangent space of the 
t
advected perturbed material surface, M(t1° = Ftt01 (M(t0°°, at the point xt1. Adapted 
from Haller (2015).
M(t1° = Ftt01 (M0 °. As we concluded from formula (2.30), the normal ofa material surface at 
the point x0 at time 10 is advected by the inverse transpose [rFfJ (x0°] T of the deformation 
gradient to a normal of M(t1 ° at the point xt1 = Ftt01 (x0° at time t1 : This advected normal, 
however, is generally not of unit length, and hence only after normalization does it become 
the unit normal
[rFfl (X0°] -T n0
|[rFt1 (X0°] ’T ^|
(5.31)
to M (t1 ° at the point xt1 . With this expression at hand, we can calculate the stretch factor 
tt01 (x0; n0 ° as the inner product of the advected unit normal, rFtt10 (x0°n0, with nt1 :
D [rFf0 (X0°] T n0; rFfl(X0°n0E
Pt0 (x0; n0° = (nfi, rFt0(x0°n^ = 
1 
T
|[rFt0 (X0°] -T n0|
_ 
1
^D[VFf0 (X0°] -T n0; [VFf0 (x0°] "T n^
= 
1
-^0; [Ct0 (X0°] -1 n0E
(5.32)
with the right Cauchy-Green strain tensor Cf0 (x0°. Observing that ^n0. [CfJ (x0°] 1 n0^ is 
minimal (maximal) precisely when n0; Ctt01 (X0 ° n0 is maximal (minimal), we obtain the 
following result:
Proposition 5.10 The local stretch factor tt01 (x0; n0° of a codimension-1 material surface 
M (t° at its initial point x0 2 M0 is maximized (or minimized) by the unit normal vector 

5.3 Local Variational Theory of LCSs
179
n0 2 Nx0M0 aligning with the dominant (or weakest) eigenvector &n(x0; 10; 11 ° (or & (x0; 10; 11 °) 
of Ct0 (xo°; as defined in Eq. {2.95).
We will now explore the implications of this conclusion first for 2D flows and then for 3D 
flows.
Hyperbolic LCSs in 2D Flows
For 2D flows, the locally most repelling and attracting LCSs are, by Proposition 5.10,material 
curves whose initial positions are everywhere normal to the &2(x0; t0; t1° and &1(x0; t0; t1° unit 
eigenvector fields, respectively. Note that these fields of unit eigenvectors are not uniquely 
defined: they have two possible orientations at each point x0. It turns out that even for the 
simplest flows, one cannot select a smooth global orientation for either of the &i (x0; t0; t1 ° 
vector fields, and hence it is more appropriate to refer to them as direction fields (see Spivak, 
1999;Karrasch et al., 2014). Even though they are globally nonorientable, these direction 
fields can always be locally oriented except at points where Ctt01 (x0° has repeated eigenvalues 
and hence &1 = &2 . In the latter case, the distinction between the dominant and weaker 
eigenvectors of Ctt01 (x0° is no longer well defined.
For any i , j , being normal to &i is equivalent to being tangent to &j . Therefore, in two 
dimensions, hyperbolic LCSs can be sought among trajectories of the Lagrangian direction 
field
x00 = &i (x0; t0; t1°; 
i = 1;2; 
(5.33)
where the prime denotes differentiation with respect to a parameter s along the trajectories 
x0(s° of (5.33). These trajectories, often called tensorlines, are well defined away from points 
where 2 = 1 . At such points, the ordering of the eigenvalues is no longer well defined, 
and hence these points are often referred to as tensorline singularities (see Delmarcelle and 
Hesselink, 1994). For i = 1, we call trajectories of (5.33) shrinklines and for i = 2, we 
call the trajectories stretchlines. By Proposition 5.10,the most repelling shrinklines mark 
initial positions of repelling LCSs and the most attracting stretchlines mark initial positions 
of attracting LCSs. Repelling LCSs can therefore be located as trajectories of the direction 
field (5.33) with i = 1 that have locally the largest averaged 2(x0(s°; t0; t1° value among 
all neighboring shrinklines. Likewise, attracting LCSs can be located as trajectories of the 
direction field (5.33) with i = 2 that have locally the lowest averaged 1 (x0(s°; t0; t1° value 
among neighboring stretchlines.
To handle orientational discontinuities and tensorline singularities in numerical compu­
tations of these LCSs, Farazmand and Haller (2012) use a rescaled version of (5.33) in the 
form
x0(s° = sign (&(x0(s°; 10; 11°; x0(s - A°) a (x0(s°; 10; 11° &(x0(s°; 10; 11°;
(x0; t0; t1 ° =
2
^2 (x0; t0; t 1 °  ^1 (x0; t0; t 1 ° 
^2(x0; t0; t 1° + A1(x0; t0; t 1°
(5.34)
where A > 0 is the numerical step size used in solving for tensorlines. This rescaling 
preserves the trajectories of (5.33), but produces a locally oriented vector field on the fly 
along trajectories during numerical integration and turns tensorline singularities into fixed 
points. Farazmand and Haller (2012) solve for trajectories of the rescaled direction field

180
Lagrangian and Objective Eulerian Coherent Structures
(5.34) with i = 1, starting from a grid of initial conditions and obtain repelling LCSs at 
time t0 as shrinklines with locally the largest averaged repulsion rate, 2. The computation 
of hyperbolic LCSs in 2D unsteady flows in implemented in Notebook 5.6.
Notebook 5.6 (HyperbolicLCS) Computes hyperbolic LCSs from tensorlines (shrin­
klines or stretchlines) of the right Cauchy-Green strain tensor in a 2D unsteady velocity 
data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ AdvectiveBarriers/ HyperbolicLCS
To obtain later positions of a repelling LCS starting from a shrinkline M(10°, Farazmand and 
Haller (2012) select initial points x0 2 M(10° to obtain advected points FJ0 (x0° 2 M(t° and 
the tangent vectors rFtt0 (x0° 1(x0; t0; t1° to M(t° at those points.8 They then fit a minimal- 
length Hermite polynomial to the advected points and advected tangents to obtain repelling 
LCSs as parametrized curves at an arbitrary time t 2 (t0; t1°.
8 The vector rFtt0 (x0° 1 (x0; t0; t1 ° is tangent to M(t° at the point Ftt0 (x0° 2 M(t° by formula (2.28).
Farazmand and Haller (2012) discuss a similar computation for an attracting LCSs evolving 
backwards from its positions M(11°. This M(11° is constructed as a locally most backward 
repelling shrinkline, using the singular values ^A'(x1; t1; t0° and singular vector £1 (x1; 11; 10° of 
the backward deformation gradient rFtt01 (x1 ° inEq. (5.34).These computations are costlier 
than using FTLE ridges to visualize LCSs, but they are also more accurate and render LCSs 
in the form of parametrized curves, rather than just images. Figure 5.29 shows examples of 
LCS calculations for 2D flows and maps using shrinklines. Specifically, Fig. 5.29(a) shows 
the improvement over the FTLE computation (left) of a repelling LCS in the time-periodic 
double-gyre flow of Shadden et al. (2005) using forward shrinklines (right). Figure 5.29(b) 
shows trajectories from 100 iterations of a 2D iterated mapping model of Pierrehumbert 
(1991) (left) and stable (unstable) manifolds computed as locally most repelling forward 
(backward) shrinklines from only 14 iterations of the same map. Finally, Fig. 5.29(c) shows 
stable and unstable manifolds computed as locally most repelling forward shrinklines (red) 
and most attracting backward shrinklines (blue) in the chaotically forced Bickley-jet model 
developed by del Castillo-Negrete and Morrison (1993).
Farazmand and Haller (2013) point out that attracting LCSs in forward time can also be 
constructed as material curves evolving from stretchlines (i.e., trajectories of the differential 
equation (5.33) with i = 2) that are locally the most attracting, i.e., have locally the lowest 
1 (x0; t0; t1 ° value when averaged along them. This coincidence of attracting LCSs from 
forward calculations with repelling LCSs from backward calculations follows because the 
dominant forward-eigenvector field £2(x0; t0; t1 ° of Ctt10 (x0° (i.e., the tangent vector field of 
repelling LCSs at time t0 ) will be advected by the flow into the weakest backward-eigenvector 
field £1(x1; t1; t0° of Ctt01(x1° by formulas (2.98) and (2.102). An example of this forward-time 
computation of attracting LCSs is shown in Fig. 5.30.
The results of Farazmand and Haller (2013) enable the extraction of both repelling and 
attracting LCSs at t0 from a single forward computation of the flow map Ftt10 . Similarly, we 
can obtain both repelling and attracting LCS at time t1 from a single backward computation

5.3 Local Variational Theory of LCSs
181
(a)
(b)
Figure 5.29 Hyperbolic LCSs in 2D, computed as shrinklines from the local varia­
tional theory of hyperbolic LCSs. (a) Improvement over an FTLE calculation. Adapted 
from Farazmand and Haller, 2012. (b) Refinement of simple iterations of a 2D map. 
Adapted from Haller and Beron-Vera, 2012. (c) Stabee and unstable manilolds of 
the chaotically forced Bickley jet, computed as forward and backward shrinklines. 
Adapted from Haller and Beron-Vera, 2012.
z/Lx
(c)
of the backward flow map Ft1. Obtaining other positions of these LCSs by material advection, 
however, remains problematic in certain time directions. Namely, obtaining an intermediate 
position M(t° of a repelling LCS known at time 10 involves the forward-advection of a 
discrete approximation to M(10° under the flow map Ft0, which generates exponentially 
growing errors, as shown in Fig. 5.31.The same numerical instability arises when computing 
intermediate positions of an attracting LCS known at time 11 by using backward advection 
under the inverse flow map Ftt0: 
t1
Karrasch et al. (2015) point out that these instabilities can be avoided by advecting time 
t0 positions of attracting LCSs in forward time and time t1 positions of repelling LCSs 
in backward time. Both of these LCSs behave as attracting material lines in these time 
directions and hence their advection is a self-stabilizing numerical procedure, free from the 
instabilities shown in Fig. 5.31.To simplify the selection of these LCSs from all the possible 
tensorlines of Eq. (5.34),Karrasch et al. (2015) propose constructing attracting LCSs at 
time t0 as trajectories of Eq. (5.34) with i = 2 that cross local minimum locations x0min of 
1(x0; t0; t1°. These are the locations of generalized saddle points at time t0 with the strongest 
forward-time attraction rate. These local minima can be found simply as local minima of the

182
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.30 Attracting LCSs computed in forward time using the 2-tensorlines of 
Ct0(x0° in a 2D turbulence simulation. (Left) General tensorlines (gray) computed 
fromEq. (5.34) with i = 2 outside outermost elliptic variational LCSs (green; tobe 
discussed in §5.3.2); in red: attracting LCSs identified as tensorlines with locally the 
lowest average of the attraction rate 1; in blue: array of tracer initial condition blobs. 
(Right) Advected images of all these structures at time t1. Adapted from Farazmand 
and Haller (2013).
Figure 5.31 Numerical instability in the forward-time material advection of an ap­
proximately computed repelling LCS. Here, the repelling LCS is simply the stable 
manifold of a saddle-type stagnation point of a steady, 2D flow. Adapted from Kar- 
rasch et al. (2015).
weaker singular value field VAlfa; 10; 11° yielded by the SVD of the deformation gradient 
rFt0, which also yields the right singular vector field £2(x0; 10,11° to be used in Eq. 55.34).
Instead of computing full tensorlines fromEq. (5.34) through the local minima x0min, it is 
sufficient to use short line segments aligned with 2(x0min; t0; t1° at those points because these 
line segments will grow exponentially in length under forward advection by Ftt1 : To filter 

5.3 Local Variational Theory of LCSs
183
the local minimum locations x0min in noisy data sets, we can order the local minimum values 
A1 (xmn; 10; 11 ° found for A1 in the flow domain in ascending order. We then pick the first point 
p1 2 [ j x0m;ijn in this ordered list and discard all other local minima in a small neighborhood 
of p1 . From the remaining points in the ascending list, we pick the first point p2 and discard 
all local minima in a small neighborhood of p2 and so on. This procedure filters out local 
extrema in noisy singular value fields, as pointed out in Karrasch et al. (2015).
Similarly, we can locate repelling LCSs at time t1 by locating and filtering (as above) 
minima of A1(x1; 11; 10° = [A2(Ft0 (x1°; 10; 11°] , i.e., finding the locations of generalized 
saddle points at time t1 with the strongest backward-time attraction rate. These are at advected 
positions Ft0 (xj^ax) of the local maximum locations xmax of the stronger singular value 
ticl^VA2(x0; 10; 11° yielded by the SVD of the deformation gradient r Ft.1. At the advected 
positions Ft, (xmax), we select short line segments aligned with the left singular vector 
field '^2 (xmax; 10; 11° of rFt0 (xmax) obtained from SVD and advect these backward in time 
materially under Ftt01 to obtain repelling LCS positions at time t0 . An example of these 
self-stabilizing repelling and advecting LCS calculations is shown in Fig. 5.32.
ti = 100
5
4
3
2
to = 50
1 
2 
3 
4 
5 
6
t = 75
5
4
3
2
1
1 
2 
3 
4 
5 
6
Figure 5.32 Self-stabilizing repelling (red) and attracting (blue) LCSs at an inter­
mediate time t = 75 for the 2D turbulence data set shown in Fig. 5.30.(Left) Initial 
line segments aligned with 2(x0min; t0; t1° at t0 = 50 for the attracting LCSs. (Mid­
dle) Hyperbolic LCS positions at t = 75. (Right) Initial line segments aligned with 
2(x0max; t0; t1° at t1 = 100 for the repelling LCSs. Image: Karrasch et al. (2015).
Hyperbolic LCSs in 3D Flows
For 3D flows (n = 3), the locally most repelling and attracting LCSs are, by Proposition 
5.10, maeerial surfaees whoec initial positions are eeerywhere normal to the £3(x0; 10; 11 ° 
and £1(x0; 10; 11 ° unit eigenvector fields, respectively. While in 2D flows such locally most 
repelling and attracting material curves (shrink- and siretchlines) are well defined through any 
initial point x0 with A1(x0; 10; 11° , A2(x0; 10; 11°, the same does not hold for material surfaces 
in 3D. Instead, smooth material surfaces with initial positions M0 everywhere normal to 
3(x0; t0; t1° or 1(x0; t0; t1° are exceedingly rare. They will generally not exist in a given fluid 
flow unless the helicity vectors of these Lagrangian vector fields vanish along surfaces that 
are normal to these eigenvector fields, as we can deduce from Appendix A.7. Specifically, 
we would have to have

184
Lagrangian and Objective Eulerian Coherent Structures
hri;ii=0; rhri;iii =0;
(5.35)
with i = 3 along (pointwise most) repelling LCS initial positions and with i = 1 along 
(pointwise most) attracting LCS initial positions. These four scalar equations are generically 
not satisfied along 2D surfaces. Consequently, unlike in two dimensions, the local variational 
description of hyperbolic LCSs (which insists on them dominating all other material surfaces 
through each and every of their points) is over-constrained in three dimensions, as noted by 
Blazevski and Haller (2014).
An alternative is to relax the assumption of the local variational theory that the LCS is 
a smooth surface (i.e., differentiable manifold). In that case, the necessary condition (5.35) 
can no longer be concluded for the existence of an initial position M0 (seeAppendix A.7). 
Instead, one can seek initial surface positions M0 as a continuous family of smooth curves 
rather than a smooth surface. To this end, we consider a smooth reference surface with a 
smooth unit normal vector field nn. We seek to find smooth parametrized curves r0(s° within 
that also lie in (continuous) initial positions M0 of hyperbolic LCSs. Such curves must be 
pointwise orthogonal to the unit normal nn(r0(5)) and to the most repelling (i = 3) or most 
attracting (i = 1) direction &(r0(5); t0,11), as shown in Fig. 5.33.
Figure 5.33 Construction of the intersection curve r0(s° between the initial position 
M0 of a continuous hyperbolic LCS with a codimension-1 surface .
Consequently, the curves r0(s° must be trajectories of the 2D differential equation
r0(s° = &(r)(s°; 10; 11° x nnMs°\ 
(5.36)
which we refer to as reduced strainlines (shrinklines for i = 1 and stretchlines for i = 3). 
The reference surface can then be varied continuously, which amounts to a continuous 
perturbation to the trajectories of the ODE (5.36). This procedure yields continuous families 
of curves across the family of surfaces which can in turn be assembled (nonuniquely) 
to form continuous initial positions of hyperbolic LCSs. To obtain LCSs that are as close 
as possible to smooth manifolds, one may select strainlines along which the helicity of 
the direction field &i is minimal, i.e., the first condition inEq. (5.35) is as close to being

5.3 Local Variational Theory of LCSs
185
satisfied as possible. Specifically, one can select strainlines in along which jhr 
i; iij
is pointwise below a small threshold value.
As an example, we consider a chaotically forced version,
v(x
(A + F(t°° sin z + C cos y 
B sin x + (A + F(t)) cos z 
C sin y + B cos x
(5.37)
of the steady ABC flow (4.29). The forcing function F(t), shown in the upper right of Fig. 
5.34,is generated by a trajectory on the strange attractor of the damped-forced Duffing 
oscillator (Blazevski and Haller, 2014). We use the same parameter values as in Fig. 4.22 for 
this flow, and construct reduced strainlines for time t0 = 0 initial positions of repelling LCSs 
intersecting the horizontal plane
n = {(X; y; Z g 2 »0; 2^P I Z = 0} :
The lower left plot of Fig. 5.34 shows reduced shrinklines (i.e., trajectories of the ODE (5.36) 
with i = 1) on which the helicity norm jhr x £1, £1ij is minimal. The plot on the right of the 
figure then show the initial position M0 of a continuous hyperbolic LCS assembled from 
such reduced shrinklirics in a family of horizontal planes close to n.
1
_ _ . _ . _ .... .. . ~ _ _____
Figure 5.34 Construction of an initial position M0 of a repelling LCS in the chaot­
ically forced ABC flow (5.37). See the text for details. Adapted from Blazevski and 
Haller (2014).
We will revisit the extraction of hyperbolic LCSs from their local variational theory in 
.
§5.4.4. In that treamient, we wlll give anohier relaxed implementation of hieir computation 
that circumvents the overdetermined conditions in Eq. (5.35). That approach will not require 
giving up smoothness for the LCS and can be implemented without the use of reduced 
strainlines.

186 
Lagrangian and Objective Eulerian Coherent Structures
5.3.2 Local Variational Theory of Elliptic LCSs
To find an elliptic LCS from its local variational theory over the time interval»10; 11], we have 
to find at each point x0 the tangent space Tx0M0 of an initial material surface M0 := M(10°. 
The surface M0 is such that its unit normal n0 maximizes the shear factor a' (xo; no) shown 
t0
in Fig. 5.28 under all possible choices of the unit normals n0 at x0. As in the case of hyperbolic
LCSs discussed in §5.3.1, once the initial positions of these LCSs are located, their later 
positions are determined by the flow map as M(t° = Ftt0 (M0°:
Based on Fig. 5.28, an expression for att01 (x0; n0° can be found by projecting the vector 
rFtt10 (x0°n0 onto the tangent space Txt M(t1° of the advected material surface M(t1°, as 
proposed first by Tang et al. (2011a). Using the expression (5.31) for the unit normal nt1, 
Blazevski and Haller (2014) compute att01 (x0; n0° as
at (xo; no) = |rFt0 (xo) no - (nfl, rFt0(xo)no) nf11
[rFt0 (xo)] "T no; rFt0(xo)n^ [W* (xo)] "T no 
t0 ( 0) 0 
|[rFt0 (xo)]"Tno|2
(n0; Ct0 (X0) no ) - D------—t 
——
(n0; [Cto (x0)] n0
(5.38)
They then show that this shear factor is maximized by two different choices for the normal 
no for Mo as follows.
Proposition 5.11 The local shear factor atto1 (xo; no) of a codimension-1 material surface 
M (t) at its initial point xo 2 Mo is maximized by either of the following choices for the unit 
vector no 2 Nxo Mo:
no(xo) =
pAi (x0)
^1(x0)±
1 (xo ) + 
n (xo )
V^n (x0 ) 
VMx0 ) + j An (x0)
n (xo );
with Ai(xo) serving as shorthand notation for the Cauchy-Green eigenvalue Ai(xo; 10; 11) and 
i(xo) serving as shorthand notation for the corresponding eigenvector i(xo; to; t1).
As we did for the local variational theory of hyperbolic LCSs, next we will explore the 
implications ofProposition 5.11first for 2D flows then for 3D flows.
Elliptic LCS in 2D Flows
For 2D (n = 2), the locally most shearing LCSs are, by Proposition 5.11, material curves 
whose initial positions are everywhere normal to one of the no±(xo) unit eigenvector fields, 
respectively. As in the hyperbolic case, each of the two normal vector field families is a 
direction field that is typically not orientable.

5.3 Local Variational Theory of LCSs
187
Therefore, in two dimensions, LCSs can be sought among trajectories of the differential 
equations
pMx0°
6(X0°;
(5.39)
X0 = V±(X0° := n?±(xo° =
P^2(x0°
A 
Si(xo° M
t VA1(x0° + V^2(x0° 
1 VA1(x0° + V^2(x0°
with prime again denoting differentiation with respect to a parameter s along trajectories 
x0(^° of Eq. (5.39). Asinhhe yperb0olicassedisuussedin§5.3.1, trajectories of the direction 
field (5.39) are tensorlines, which are well defined away from tensorline singularities arising 
at poiits where 2 = 13 We call these types of teisorliies shearlines3 By our earlier 
coisieeratiois1 closee shearliies mark iiitial positiois of elliptic LCSs3
Haller aie Beroi-Vera (20.2) show that aiy piece of a shearliie aevectee ii ai iicom- 
pressible flow has the same arcleigth at time t1 as it eie at time t039 We also recall that 
the iiterior of a closee shearliie preserves its area uieer material aevectioi by the flow 
map of an incompressible 2D flow (see formula (2.40)). Therefore, an elliptic LCS M(t1 ° 
at time t1 has the same arcleigth aie eiclosee area as its iiitial positioi M0 at time t03 
Therefore1 elliptic LCSs serve as the perfect time-aperioeic analogues of the K.M curves 
of Poincare maps of 2D time-periodic flows (see §4.1.2). This gives further support to the 
logic of eefining aevective barriers to finite-time1 aperioeic transport basee on their impact 
on nearby trajectories. .s we did with elliptic LCSs inferred from objective diagnostics in 
§§§.2..0 and §.2...1 we again identify coherent Lagrangian vortex boundaries as outermost 
members of nested elliptic LCS families.
9 The arclength of a materially advected shearline is1 however1 not necessarily conserved at intermediate times 
t 2 (t0; ti).
.s in the case of hyperbolic barriers discussed in §§.....1 the numerical extraction of
coherent vortex boundaries also starts with the computation of the eigenvalue and eigenvector 
fields of the Cauchy-Green strain tensor C^(x0°. One then constructs the direction field 
•q±(x0° in (§.39) and seeks elliptic LCSs as closed trajectories of the ODE (§.39). Such 
a search is greatly simplified if restricted to closed orbits encircling groups of tensorline 
singularities1 i.e.1 points where 1 = 2 and hence 1 and 2 are not well defined). Specifically1 
Karrasch et al. (20.4) show that in any structurally stable (and hence practically relevant) 
2D tensorline field1 one can only have trisector and wedge singularities1 as illustrated in Fig. 
§.3§. In the interiors of closed tensor lines1 the numbers of these singularities must obey the 
relationship
W = T+ 2;
(§.40)
with W denoting the number of wedges and T denoting the number of trisectors1 illustrated 
by the examples in Fig. §.3§.
Once regions obeying condition (§.40) are identified1 one can set up one-dimensional 
Poincare sections and launch tensorlines from those sections using a modified version of the 
ODE (§.39) in the form

188
Lagrangian and Objective Eulerian Coherent Structures
Wedge
Trisector
Two possible
(W, T)=(2, 0)
(W, T)=(3, 1)
Figure 5.35 The two structurally stable tensorline singularities (trisector and wedge) 
and examples of their possible configurations inside a closed shearline, conforming 
toEq. (5.40).Adapted from Karrasch et al. (2014).
x0(s° = sign (^±(xo°; x0(s - A)) a (xo(s); 10, 11° ^±(xo° 
(5.41)
for both choices of the ± sign. This modified ODE orients the direction field ^±(x0° on the 
fly and turns tensorline singularities into fixed points (see our discussion of Eq. (5.34) for the 
hyperbolic case). Once a return of trajectories of (5.41) is detected to a Poincare section, the 
fixed point of the corresponding Poincare map (corresponding to a closed shearline) can be 
found using the bisection method (see Onu et al., 2015 and Karrasch et al., 2014 for details).
We have already seen examples of closed elliptic LCSs obtained from this algorithm in 
Fig. 5.29(b) for an iterated map. For such maps, trajectories are readily available from the 
iteration of the map and hence no ODE such as Eq. (5.34) has to be solved. We have also 
encountered coherent Lagrangian vortex boundaries extracted as outermost closed orbits of 
Eq. (5.34) for a 2D turbulence simulation, shown as green closed curves in Fig. 5.30.This 
figure also illustrates the arclength preservation of these generalized KAM curves, as noted 
above. We give a further example of the output of the numerical algorithm of Karrasch et al. 
(2014) in Fig. 5.36.This figure illustrates the steps we have outlined for local variational 
vortex boundary extraction on the AVISO ocean surface velocity data set of Fig. 5.23 (see 
also Appendix A.6) but now on a larger domain.
Coherent Lagrangian eddy boundaries (outermost members of closed shearline families) 
also act as transport barriers for weakly diffusive scalar fields. This is due to the non- 
filamenting nature of their boundaries, which substantially hinders diffusive transport, as 
we will see in more detail in Chapter 8. As an illustration, Fig. 5.37 shows how a coherent

5.3 Local Variational Theory ofLCSs
189
(a)
-22
-24
-26
-28
-30
-32
-34
-36
-38
(b)
-22
-24
-26
-28
-30
-32
-34
-36
-38
(c)
-22
-24
-26
-28
-30
-32
-34
-36
-38
-10 
-5 
0 
5 
10
lon
Figure 5.36 Steps in the extraction of coherent Lagrangian vortex boundaries from 
the local variational LCS theory as outermost members of nested families of closed 
shearlines. (a) Detection of tensorline singularities and identification of those (circled 
in green) potentially inside elliptic LCSs. (b) Definition of Poincare sections based 
at those singularities. (c) Outermost closed shearlines (white)flemerging from fixed 
points of the Poincare maps on this section. Also shown is the FTLE field in the 
background for reference. Adapted from Karrasch et al. (2014).

190
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.37 Material eddy boundary (black curve) constructed from the local varia­
tional theory of elliptic LCSs, trapping a chlorophyll patch over a period of 6 months 
in the Southern Atlantic. Adapted from Beron-Vera et al. (2013).
Lagrangian eddy transports a gradually diffusing chlorophyll patch in the Agulhas leakage 
area over a period of six months.
Elliptic LCS in 3D Flows
For 3D flows, Proposition 5.11 with n = 3 implies that locally most shearing LCSs must 
evolve from initial positions M0 that are pointwise normal to the unit vector field
n0±(x0° =
P^l(xo) 
£ (x ) + 
____________
A PMx0° + P^3(xo° 1 0 A pAi(xo° + P^3(xo°
P^3(x0°
&(xo).
(5.42)
As in the case of hyperbolic LCSs, a smooth surface satisfying this requirement only exists 
(seeAppendix A.7) if
hr n0±; n0±i = 0; r hr n0±;n0±i n0± = 0: 
(5.43)
These conditions will generically not be simultaneously satisfied along a smooth 2D manifold, 
and hence we again have to settle for continuous material surfaces in our approach to elliptic 
LCSs via the local variational theory pursued here.

5.3 Local Variational Theory ofLCSs
191
4
full Poincar6 map
1 
2 
3 
4 
5 
6
>.
6
5.6
6
4.5
4
3.6
closed reduced shearlines 
overlaid on a portion 
of the Poincar6 map
elliptic LCS constructed from 
closed reduced shearlines
Figure 5.38 Extraction of elliptic LCSs (invariant tori) from closed reduced shear­
lines in the steady ABC flow (4.29). Adapted from Blazevski and Haller (2014).
Following the idea we discussed in the context of Fig. 5.33 for hyperbolic LCSs, we 
assemblet the initial positions of elliptic LCSs from their closed intersection curves with a 
smooth family of cross sections. If the unit normal vector field of such a cross sectional 
surface n is nn (x0), then thee intersection curve r0(s° of n with M0 is a trajectory of one of 
the two diafferential equateiopans
i nt 
ime 
e,
r0(s° = n0±(r0(s°° x nn(r0(s)° 
(5.44)
0
o 
se 
e
obtained fnortdifferent choicesd of the sthige n r. We refer to these trajectories as reduced shear­
lines. Of interest to us are closed reducedrshearlines that mark the intersections of cylindrical 
p
or toroidpal (i.e.e, vortex-type) LCS positions with n. Outermost members of such closed 
reduced shearline families then mark the intersections of Lagrangian vortex boundaries 
with n . 
h 
e 
ese
The algorithmic extraction of closed reduced shearlines from the 2D system of ODEs 
(5.44) follows the same argument as the extraction of closed shearlines in 2D flows we 
described in §5.3.2 once one replaces the direction fields with n0 x nn: As an example, 
we show closed reduced shearlines computed in this fashion for the steady ABC flow in Fig. 
5.38.

192 
Lagrangian and Objective Eulerian Coherent Structures
Here the section is just the z = 0 plane in which the two ODEs (5.44) are solved and 
the closed shearlines (marked in green) are obtained using the extraction algorithm outlined 
in §5.3.2.The corresponding invariant tori are then obtained by launching trajectories of the 
full ABC flow from the extracted closed shearlines. Finally, one can fit 2D surfaces to the 
3D trajectory data sets obtained in this fashion (using, say, MATLAB’s surface fitting tools) 
to obtain the nested set of invariant tori shown in Fig. 5.38. For the 3D visualization in this 
figure, the inferred vortex center (x0; y0; 0° was advected under the ABC flow map to generate 
a spatial curve of the form (x0(z°; yo(z°; z°. With the help of this curve, one can transform the 
trajectories of the ABC flow via the mapping
x = »x - xo(z° + R1] cos(z°;
y = »x - xo(z° + Ri] sin(z), 
(5.45)
z = R2 »y - yo(z°]
into toroidal coordinates, where the positive constants Ri are selected based on visual opti­
mization.
Just as we noted for hyperbolic LCS, will revisit the extraction of elliptic LCS from 
their local variational theory in §5.4.4. The unified approach we will discuss there for 
hyperbolic and elliptic LCSs will produce smooth transport barriers without the use of 
reduced shearlines.
5.3.3 Local Variational Theory of Parabolic LCSs
A local variational theory of parabolic LCSs would, in principle, target surfaces along which 
the tangential shear factor tto1 (xo; no° shown in Fig. 5.28 is minimal. Formula (5.38) shows, 
however, that the global minimum tto1 (xo; no° = o is reached precisely for the choices no = i 
for i = 1; 2; 3. This simply reflects that the hyperbolic LCSs we have identified in §5.3.1 are 
also minimizers of the Lagrangian shear.
The remaining choice for parabolic LCSs would be surfaces with unit normals no = 2 , 
which are not repelling or attracting LCSs but nevertheless generate tto1 (xo; no° = oateachof 
their points. To check the feasibility of this approach, we consider the simple, incompressible 
parallel shear flow
x = 1 - y2;
y = 0; 
(5.46)
z = 0;
which provides a prototype for a parabolic LCS in 3D. Indeed, the y = o plane, seen 
as the x-axis of Fig. 5.39 from the positive z direction, acts as a perfect jet core surface 
M (t° M0 , generating the characteristic boomerang-shaped patterns in evolving nearby 
tracer distributions with minimal (zero) shear.

5.4 Global Variational Theory of LCSs
193
Figure 5.39 (Left) The velocity profile of the steady flow (5.46) in the (x;y°-plane. 
(Right) Streamlines of the same flow, with the thicker line along the y = 0 plane 
marking a parabolic LCS (jet core). Adapted from Farazmand et al. (2014).
A quick calculation reveals that the right Cauchy-Green strain tensor and its intermediate 
eigenvector for this example are
1
-2 yo 0
0
0
C0(xo ° = M
-2yo 0
4y0202 + 1 0® ; 
2 =
0
0
0
1
«1 -
Choosing n0 = 2 as the normal of a parabolic LCS would, therefore, designate the set of 
horizontal (x, y° planes, rather than the true parabolic LCS, M0 = f(x, y, z°: y = 0g.
For this reason, the local variational theory of parabolic LCSs needs to be appended with 
further considerations that will enable us to construct them, at least in two dimensions, from 
distinguished stretchlines and shrinklines (see §5.4.3).
5.4 Global Variational Theory of LCSs
In §5.3,we constructed advective barriers to transport as material surfaces that exert pointwise 
maximal possible repulsion, attraction or shear on neighboring fluid elements. This local 
optimization approach only compared material surfaces through the same point and hence 
did not allow for any shift of the surface, only local rotations of its tangent spaces. As 
a consequence, the local variational approach was only a partial implementation of the 
extremization principle laid down in the generalDefinition 5.3for LCSs.
Here we take a more global view and describe LCSs as stationary surfaces (i.e., mini- 
mizers, maximizers or surfaces of inflection) of appropriate stretching and shear functionals. 
These functionals measure the averaged impact of the LCS on neighboring fluid elements. 
Finding stationary surfaces of these functionals amounts to solving classic calculus of vari­
ations of problems, which would normally be highly computational. All these functionals, 
however, turn out to have a symmetry that yields explicit formulas for their stationary 
surfaces.

194
Lagrangian and Objective Eulerian Coherent Structures
5.4.1 Elliptic LCSs in 2D: Black-Hole Vortices
As physical motivation for a global variational principle for elliptic LCSs, we recall a short 
quote from Edgar Allan Poe’s short story entitled A Descent into the Maelstrom:
The edge of the whirl was represented by a broad belt of gleaming spray; but no 
particle of this slipped into the mouth of the terrific funnel [. . .]
Poe, therefore, envisions a belt-like material vortex boundary that keeps its coherence as it 
prevents particles from entering the interior of the vortex (see Fig. 5.40 for an illustration). 
In contrast, an initially coherent, typical material belt surrounding a closed material curve 
in a 2D flow will undergo filamentation due to stretching and folding. We illustrate this in 
the middle plot of Fig. 5.40,showing the contrast with an atypical, coherent material curve 
on the right that causes no filamentation in its surrounding material belt.
Figure 5.40 Edgar Allan Poe’s maelstrom, together with typical (filamenting) ma­
terial belts and atypical (nonfilamenting) material belts in a 2D flow. Green denotes 
general points in these belts located near their cores formed by the closed material 
curves (red). Adapted from Haller and Beron-Vera (2013).
We now seek elliptic LCSs that show the atypical, coherent behavior exhibited by the 
material curve on the rightmost subplot ofFig. 5.40. To this end, we select a small 
thickness > 0 for a material belt around a material curve in a finite-time, temporally 
aperiodic flow of the form (5.1) with n = 2: By the smooth dependence of the flow map Ftt1 
on initial conditions (see §2.2.3), we will always observe an O(e° variability in the thickness 
of any material belt after advection around the advected material curve Ft1 (y°. We seek here, 
however, exceptional y curves around which an O(e°-thick material belt will not show the 
expected O(e° variability in thickness after advection. Rather, the material belt around such 
a y will show an order of magnitude less, i.e., O (e2), variability when its advected thickness 
is averaged along Ft1 (y°.
To express this coherence principle more precisely, we consider a parametrization x0(s° 
with s 2 »0; ^] for a general closed curve y at time t0. We observe that in 2D flows, the unit 

5.4 Global Variational Theory of LCSs
195
normal no along the initial curve xo(5) can be expressed by a 9o° rotation of the unit tangent 
vector of xo(5), i.e., as
no J ixo 1; 
J (-10 ):
This enables us to eliminate the dependence of the stretch factor Ptt1 on n0 in formula (5.32) 
and rewrite it as
(5.47)
Pto (x0; x0) =
(xo; Cto (xo° xo};
(5.48)
where we have applied the identity (2.106) from §2.2.15 to the inverse Cauchy-Green 
strain tensor [Ct1 (xo)] 1. Therefore, the averaged repulsion factor along a closed curve y, 
parametrized as xo(5) with 5 2 »o, 5°, can be written as 
—
0 r .....................
Q(y° = - I Pto (xo(5°;xo(5°) d5: 
(5.49)
5o
We will refer to Q(y° as the averaged repulsion functional.
As noted above, if y forms the core curve of a coherent material belt, then on any -close 
material loop y, parametrized as
xo(5; e) = xo(5) + eno(5),
1d s
sQ(y° = 5 de yPto (xo(5;e°xo(5;e°) d5
we must have Q(y) = Q(y° + O (e2). This is only possible if the first variation of Q vanishes 
on the closed curve y:
= o, 
xo(o° = xo( 5°. 
(5.50)
=o
In other words, y must be a closed stationary curve of the averaged repulsion functional 
Q(y°.
Under the periodic boundary condition in Eq. (5.50),this variational problem can be 
reformulated via the Euler-Lagrange equations of the calculus of variation (see Appendix 
A.8). These equations are fairly complex in this case and yield little insight into the stationary 
curves of Q(y°. Haller and Beron-Vera (2013), however, point out that the integrand of 
Q(y° has no explicit dependence on the parameter 5.1o This symmetry of the problem 
enables us to use Noether’s theorem, which guarantees the existence ofa conserved quantity
1o Strictly speaking, Haller and Beron-Vera(2013)carry out their analysis for the averaged tangential stretching
1 r s 
xo(s°;Ct0 (xo(s))X>(s)
functional -1 
—, . 
,,—L ds, but stationary curves of this functional coincide with those of the
s Jo \ 
hxo(s);xo(s°i 
, 
J
functional(5.49)for incompressible flows.

196 
Lagrangian and Objective Eulerian Coherent Structures
I(x0; x00° along the solutions of the Euler-Lagrange equations (see Appendix A.8). Noting 
that pt0 (x0; ■ ° is a positively homogenous function of order d = 0 (see the definition of 
positive homogeneity in Eq. (A.32)), we obtain from formula (A.34) of Appendix A.8 the 
first integral I(x0; x'0° = pt0 (x0, x0). Therefore, we have
pt0 (x0(5°; x0(5)) = 1 = const: 
(5.51)
along stationary curves of the averaged repulsion functional Q, with a constant repulsion 
factor 1 /A > 0. By incompressibility, this conservation law then implies a constant tangential 
stretching factor A along the curve x0(5°.
Therefore, elliptic LCSs satisfying the variational principle (5.50) are special closed 
curves whose local tangential stretching over the »t0; 11] time interval is equal, at each of their 
points, to the same factor A > 0. This explains why the curves satisfying the variational 
principle (5.50) create perfect coherence in their vicinity: their pointwise even stretching 
or compression by the constant factor A disallows the formation of small-scale material 
filamentation.
Using the expression for pt0 (x0,x0) from EZcj. (5.48), werewrite Eq. (5.51) in the form
(x0; [CJ0(x0° - A21] x0} = 0; 
(5.52)
we can seek curves x0(5° satisfying Eq. (5.52) by expressing their unit tangent vectors as a 
linear combination
x0 = c i£i(x0; 10; 11° + c 2&(x0; 10; 11 ); 
c 2 + c 2 = 1 
(5.53)
of the eigenvectors of the tensor C0(x0). Substitution of Eq. (5.53) into Eq. (5.52) then leads 
to the following result (see Haller and Beron-Vera, 2013 for more detail).
Theorem 5.12 Initial positions of elliptic LCSs, defined as stationary curves of the average 
normal repulsion functional (5.49), are closed trajectories of the two one-parameter families 
of direction fields,
A2 (x0° - A2 
| A2 - Ai (x0°
x0(5° = "• ' '5°°; 
’S (x0° = ^ A2 w- A1 (x») ; ' 
A2 (x.)- A1 (x.) (2 x •
(5.54) 
defined on the spatial domain
UI = {x0 2 U: A1(x0; t0; t1° < A2 < A2(x0; 10; 11°} . 
(5.55)
Any such elliptic LCS is uniformly A-stretching: any of its subsets is stretched precisely by 
the factor A > 0 over the time interval »t0; t1]: Outermost members of nested families of such 
closed curves serve as initial positions of Lagrangian vortex boundaries.
For A = 1, the A-lines defined by formula (5.54) recover their initial length at time t1 and 
hence coincide with the shearlines we have identified from the local variational theory of 
LCSs in formula (5.39).11 This shows that the present global theory of LCSs is indeed an 
extension of the local theory, securing a lack of filamentation for the LCS without insisting 
on a perfect conservation of its length under advection.
11 One can verify this by setting = 1 in formula (5.39), dividing both the numerators and the denominators by
-\/A2(x0° - -7^1 (x0° and using the incompressibility condition A1 (x0°A2(x0° = 1:

5.4 Global Variational Theory of LCSs 
197
Formula (5.52) enables the interpretation of -lines as null-geodesics (see Beem et al., 
1996) of the metric tensor
Ea (xo° = 2 [Ct0 (xo°- A2I]; 
(5.56)
which is a generalization of the Green-Lagrange strain tensor defined in formula (2.105). This 
metric tensor is always indefinite on the domain of definition U of the ode (5.54). This fact 
enables an interesting mathematical analogy between elliptic LCSs (as closed null-geodesics 
of a Lorentzian metric on a 2D spacetime) and photon spheres surrounding black holes in 
the relativistic, four-dimensional spacetime (see Claudel et al., 2001). For these reasons, 
we will refer to coherent Lagrangian vortices identified from formula (5.54) as black-hole 
vortices, and to the procedure used to extract them as geodesic vortex detection. For details 
and implications of this analogy between coherent vortices and black holes, we refer to Haller 
and Beron-Vera (2013, 2014). An alternative, null-geodesic-based computation of black-hole 
vortex boundaries from their implicit equation (5.52) will be described in §5.4.2.
As we will show in §8.1.1, an important theoretical connection can be established between 
elliptic LCSs obtained from formula (5.54) and closed material barriers to the transport of 
diffusive tracers under homogeneous and isotropic diffusion. Namely, using the eigenvalues 
and eigenvectors of the time-averaged Cauchy-Green strain tensor in formula (5.54) instead 
of those of Ctt10 gives elliptic barriers to diffusive transport with constant diffusive transport 
density 2 along them.
To extract elliptic LCSs as closed orbits (or tensorlines) of the direction field families 
(5.54), one can follow the same algorithm that we outlined for the detection of closed 
shearlines in §5.3.2. The only difference in the present case is that the analysis has to be 
carried out for a range of values. The range to explore is an interval around = 1. Indeed, 
the conservation of the area enclosed by closed -lines (for incompressible flows) prevents 
substantial uniform stretching or shrinking for these curves. This is already evident from 
formula (5.54), which only returns a real-valued vector for values satisfying the bounds
min A1 (x0° < A < max A2 (x0° 
x0 2U 
x0 2U
on a compact flow domain U 
R2 (see Karrasch et al., 2014, for details).
An example of such a geodesic vortex extraction is shown in Fig. 5.41 for the same AVISO 
ocean surface velocity data set that we analyzed in Fig. 5.36 using shearlines.
In comparison to the analysis in Fig. 5.36, the present analysis finds more and larger eddies 
in the same region, as it allows for deviations from the A = 1 uniform stretching factor for 
the elliptic LCSs. All eight detected eddies remain perfectly coherent over their extraction 
time of 180 days. The boundary of eddy 6 has the largest uniform stretching factor (A = 1:2) 
while the boundary of eddy 3 displays slight contraction (A = 0:9). Some of the eddies 
remain coherent over periods substantially exceeding their extraction interval. To illustrate 
how unique it is for initially coherent water masses to remain coherent for months in this 
ocean region, we show in the bottom plot of Fig. 5.36 the rapid disintegration of a water 
mass identified using the nonlinear eddy criterion of Chelton et al. (2011a,b) from §3.7.1. 
Most of such nonlinear eddies show the same lack of coherence in this region, leading to an 
about ten-fold overestimation of actual coherent transport by black-hole eddies (see Haller 
and Beron-Vera, 2013, for details).

198
Lagrangian nd Objective Eulerian Cohrent Str ctures
(b)
(a)
18.5° S
10° E
South Atlantic
35° S
Transported water after 0, 45, 90, 135, 180 and 225 days
25° W
Transport of water by black-hole eddies
25° W
■ BH eddy 8
BH eddy 7
BH eddy 6
BH eddy 5
■ BH eddy 4
■ BH eddy 3
■ BH eddy 2
SSH eddy
Transport of water by a sea-surface-height eddy
35° S
Transported water after 0, 45, 90, 135, 180 and 225 days
-'■-■South Atlantic
10° E
Figure 5.41 (Top) Evolution of black-hole (BH) eddies detected in Agulhas leakage 
region of the South Atlantic from 180 days of satellite-based surface velocity data 
(AVISO). (Bottom) Rapid disintegration of the water mass identified from the non­
linear eddy criterion of Chelton et al. (2011b) (see §3.7.1) over the same 225 day 
period. Adapted from Haller and Beron-Vera (2013).
As a second application of geodesic vortex detection, Fig. 5.42 shows the construction of 
transport barriers in Jupiter’s Great Red Spot (GRS), the largest and longest-existing known 
atmospheric vortex.
This computation is based on an unsteady wind field extracted from a video captured by 
NASA’s Cassini space mission (see Hadjighasem and Haller, 2016a,for details). As seen 
in Fig. 5.42(a)-(b), the material footprint of the GRS in the available 2D data falls in the 
category of a black-hole vortex. This Lagrangian vortex has a perfectly coherent core with
= 1 and a boundary with = 1:0063. Figures 5.42(c)-(d) show how these LCSs indeed 
preserve their coherence by the end of the extraction interval (24 Jovian days), acting as 
material transport barriers inside and around the GRS.
In subplot (a) of the figure, elliptic LCSs forming the GRS at the initial (t0 = 0) frame 
of the Cassini video are shown, extracted from the wind field up to t1 = 24 Jovian days. 
The colors represent values of the stretching parameter on the LCSs. Subplot (b) shows 
an elliptic LCS with perfect coherence ( = 1; black), as well as the outermost elliptic LCS

5.4 Global Variational Theory ofLCSs
199
-5.6
0.99
0.98
0.97^
0.96
0.95
0.94
-11.5
-17.4
-23.3
-58.1
-46.1 
Longitude
-34.1
(a)
-29.2
-5.6
-11.5
-17.41
-23.3 I
-29.2L
t=24 days
-58.1 
-46.1 
-34.1
Longitude
(c)
Longitude
(b)
0.99
0.98
0.97^
0.96
0.95
0.94
(d)
Figure 5.42 (Top) Image of Jupiter’s atmospheric clouds, with the historically 
averaged zonal velocity profile of Limaye (1986) (green) compared to the av­
eraged zonal velocities extracted from the Cassini mission video footage. (a)- 
(d) Evolving Elliptic LCSs forming the GRS (see the text for details). A video 
showing the material evolution of the elliptic LCS bounding the GRS is available 
at https://epubs.siam.org/doi/suppl/10.1137/140983665/suppl_file/ 
grs_movie.mov. Adapted from Hadjighasem and Haller (2016a).
(blue) forming the black-hole vortex boundary of the GRS at time t0 = 0. Subplots (c)-(d) 
show materially advected positions of the LCSs shown in (a)-(b) at time t1 = 24.
Beron-Vera et al. (2018) show observational evidence for the significance of black-hole 
eddy boundaries as approximate barriers to the transport of diffusive scalars in the ocean 
(seeFig. 5.43).
This observation is consistent with the theory of material barriers to diffusive transport 
to be discussed in §8.1.1. Indeed, that theory will yield that outermost limit cycles of 
a direction field closely resembling Eq. (5.54) serve as the observed vortex barriers for 
diffusive substances. Andrade-Canto et al. (2020) provides a comparison of black-hole eddy 
boundaries and outermost diffusion barriers specifically in the context of Kraken shown in 
Fig. 5.43. Another application of geodesic vortex detection is given by Huhn et al. (2015)

200
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.43 Materially evolving black-hole eddy boundaries (solid red: for t 1 - 
to = 90 days; dashed red: for 11 - 10 = 30 days) in the Gulf of Mexico around an 
exceptionally long-lived Loop Current ring (named Krake n), with the remote-sensed 
chlorophyll concentrfiation superimposed. Green marks a chlorophyll-deficient patch. 
Adapted from Beron-Vera et al. (2018).
who use this approach to identify upstream fluid that will be captured in the material vortices 
generated bffy swimming anim fials in their wake.
5.4.2 Computing Elliptic LCSs as Closed Null-Geodesics
As noted in the previous section, the implicitequation (5.52) detfining elliptic LCSs can be 
viewed as an equation for closed null-geodesics of the tensor E^ (x0° defined in Eq. (5.56). 
This equation is invariant under re-parametrizations of its solutions xo(^°. Therefore, we can 
choose, without any loss of generality, the tangent vector of x0 (s° to be of unit length for 

5.4 Global Variational Theory of LCSs
201
each value of the parameter 5. Specifically, if e($) c R2 denotes the unit vector enclosing 
the angle $ 2 »0; 2n° with the positive horizontal axis of the x0 plane, then we can set
cos $( 5 )
x0( 5 ° = e($( 5 °° = 
(5.57)
0 
sin $( 5 )
for an appropriate angle $(5) at each point of the null-geodesic curve x0(5), as shown in the 
left subplot ofFig. 5.44.
Figure 5.44 Computation of an elliptic LCS as a closed null-geodesic. (Left) 
Parametrization of a null-geodesic of the generalized Green-Lagrange tensor field 
E^ (x0). (Right) Trajectories of the ODE (5.60) near a closed null-geodesic, released 
from an initial grid, will re-intersect the level set gt1 (x0, 0° = A2 
= const. again
0 
(i ;J °
near the initial condition.
gt0 (xo 0) = 2i,j)
null-geodesic of E^
trajectories returning to
the level set of gt01 (x^ 0')
(X> 
(s)> 0(i’j)(s))
x01
We follow Serra and Haller (2017a) by substituting expression (5.57) into Eq. (5.52).By 
differentiating the resulting equality with respect to 5 and using the identity
d-e($) = ( "$ ) = -Je($) 
(5.58)
d$ 
cos $
with J defined inEq. (5.47),we obtain
- 2$0 Je($°; Ct0e($°) + (e($°; (re*e($)) e($°) = 0: 
(5.59)
Combining Eqs. (5.57) and (5.59) leads to the 3D system of ODEs
x0
0 = e($°;
$, 
(e($),(ret0(x„)e($)) e($))
$ = 
2 (e($),JCt0 (x0)e($)) 
' 
'■’
This ODE blows up at tensorline singularities of the right Cauchy-Green strain tensor ett10 
(see §§5.3.2 and 5.3.1). Away from such singularities, however, Eq. (5.60) is a globally 
oriented vector field (unlike Eq. (5.54)) and hence can be solved directly by any ODE solver. 
In addition, the ODE (5.60) has no dependence on the parameter family A. Rather, the 

202
Lagrangian and Objective Eulerian Coherent Structures
dependence of any solution ofEq. (5.60) on is implicit, imposed by the choice of the initial 
conditions (x0(G°; 0(0)), which satisfy
gt0 M° := (e(0), CtG(Xo°e(^°) = A2 
(5.61)
by Eq. (5.61).
The conservation law (5.61) along trajectories of Eq. (5.60) enables an automated search 
for closed null-geodesics without setting up Poincare sections near tensorline singularities, 
as would be required for the direction field families (5.54). Specifically, for a trajectory 
launched from a point (x0(G°; 0(0°° of a level curve of gtG (xG 0(0)) to be closed, the trajectory 
must re-intersect the same level curve at the same point, i.e., at same angle 0(0). As the left 
plot of Fig. 5.44 shows, all values of 0 2 »0,2n) will be taken by points alongs such closed 
trajectories and hence any of these angles can be selected as initial condition.
For simplicity, therefore, we can select 0(0° = 0 for all trajectories of Eq. (5.60) launched 
from an initial grid G0 of the x0-plane. Each such initial condition x0i;j '( 0° 2 G0 on this grid 
then determines a constant
A2 = t1 x(i; j°; 0 
A(i; j° = gt0 x0 ;0
in the conservation law (5.61) for the trajectory x(0i; j°(s°; 0(i;j°(s° starting from x(0i; j°; 0 .
We monitor each trajectory to see if re-intersects the level set gtt1 (x0; 0° = A2i ina vicinity of 
t0 
(i ; j °
x(0i; j°; 0 : If yes, then we use the bisection method on the initial conditions to find a nearby 
trajectory that returns exactly to each initial condition, as sketched in the right plot of Fig. 
5.44.Any such closed trajectory, by construction, defines the time t0 position of an elliptic 
LCS. Outermost members of such orbit families are the boundaries of the black-hole vortices 
we introduced in §5.4.1.
We refer to Serra and Haller (2017a) for more detail on the algorithm and for a compar­
ison with the direction-field-based computation of black-hole vortices described in §5.4.1. 
An open-source Matlab script BarrierTool for the algorithm null-geodesic-based algorithm 
discussed in this section is available from Katsanoulis (2020). In addition, the computation 
is implemented in Notebook 5.7. 
—
Notebook 5.7 (EllipticLCS) Computes elliptic LCSs as closed null-geodesics of the 
generalized Green-Lagrange strain tensor in a 2D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/EllipticLCS
Serra et al. (2017) apply the null-geodesic algorithm for elliptic LCSs to find an objective 
material barrier to the Arctic polar vortex. Using isentropic surface velocity data from the 
ECMWF global reanalysis data set (Dee et al., 2011), they piece together this 2D barrier 
surface from its one-dimensional intersections with various isentropic surfaces that are 
approximately invariant under the Lagrangian particle dynamics. On each isentropic surface, 
Serra et al. (2017) employ the identification method sketched in Fig. 5.44 to locate the 
outermost elliptic LCS surrounding the polar vortex region. The focus of their study is the time 
period ranging from late December 2013 to early January 2014, in which exceptional cold

5.4 Global Variational Theory of LCSs
203
weather was recorded in the Northeastern United States. The null-geodesic-based analysis 
explains this cold wave by an incursion of the material barrier into the affected regions. 
Figure 5.45 shows a snapshot of the material boundary of the polar vortex obtained in this 
fashion. The potential vorticity on the 475-K isentropic surface is plotted over the Earth’s 
surface in this figure for reference.
28 December, 2013 
7 January, 2014
Figure 5.45 The material boundary of the Arctic polar vortex during an extreme 
cold wave in the Northeastern US, extracted as a set of outermost elliptic LCSs on 
isentropic surfaces. Adapted from Serra et al. (2017).
5.4.3 Shearless LCSs in 2D: Parabolic and Hyperbolic Barriers
We now adopt the global variational approach used in the previous section for elliptic LCSs, 
but modify it to capture shearless (i.e., hyperbolic and parabolic) LCSs. Specifically, we will 
be seeking initial positions of shearless LCSs as material curves along which the averaged 
shear factor t01 shown in Fig. 5.28 is minimal.
For 2D flows, the tangent space TxM(t° is only one dimensional, which enables us to 
compute a signed version of the tangential shear factor (5.38). This signed shear factor is 
obtained by simply projecting the advected unit normal rFt0 (x0° n0 onto the unit tangent 
vector in the direction of rFt0 (x0° x0. The resulting signed tangential shear factor for 2D 
flows is
t1t0
VFt0 (x0° n0; rFt0 (x0° x0 + 
|rFt0 (x0° x01/
We again use formula (5.47) to eliminate the dependence of the shear factor tt01 on n0 in 
formula (5.38). We then obtain

204
Lagrangian and Objective Eulerian Coherent Structures
rFt1 (x0° x0
at1 (x0, X0) = rFt1 (x0) 7^-07;
u 
0' \ 
t0 (0° Jx0nrFti (X0° X01
(x0; JCt0 (x0° x0)
#0; x0 Xx0; Ct0 (x0° x0)
(5.62)
Following the approach of §5.4.1, we seek shearless LCSs as exceptional curves around 
which an O(e°-thick material belt will show O(e2° variability in material shearing under 
advection. This is an order of magnitude less than the expected O(e) variability, implying 
exceptional material coherence with respect to tangential shearing along . In analogy with 
formula (5.50), we then obtain that shearless LCS must be solutions of the variational 
principle
s
6P(y) = 0; 
P(y) := 
a01 (x0(s); x0(s)) ds 
(5.63)
s0
for the averaged shear functional P(°.
In order to solve the variational problem (5.63) using Euler-Lagrange equations, one 
has to pose appropriate boundary conditions. Farazmand et al. (2014) point out that the 
variational problem (5.63) has the same symmetry as the one we noted for the variational 
problem (5.50) for elliptic LCSs (i.e., no explicit dependence on s in the integrand of P(°). 
This symmetry again enables us to invoke Noether’s theorem (see Appendix A.8) for the 
existence of a conserved quantity I(x0; x00 °. Again, a tt01 (x0; ° is a positively homogenous 
function of order d = 0 and hence the relevant Noether formula (A.34) gives the first integral 
I(x0; x0) = <rtt1 (x0, x0): This in turn implies that
a-t1 (X0( s); X0( s)) = p = const:
(5.64)
along curves x0(s) solving the variational problem (5.63). Therefore, shearless LCSs sat­
isfying the variational principle (5.50) are special curves that generate the same pointwise 
Lagrangian shear 0 at each of their points.
We pointed out in §5.3.3 that tt01 reaches its global minimum, tt01 = 0; whenever the 
unit normal n0 of the initial material curve is aligned with either of the two eigenvectors 
i(x0; t0; t1) of the Cauchy-Green strain tensor. This observation prompts us to focus now on 
perfect shearless LCSs characterized by <r01 (x0, x0) = ^ = 0: For such LCSs, we therefore 
have the following result.
Theorem 5.13 Perfect shearless LCSs, defined as stationary curves of the average tangential 
shear functional P() with identically zero shearing rate ( = 0), are continuous trajectories 
of the direction field families
x00 = i(x0; t0; t1); i = 1;2; 
(5.65)
with ^i(x0; 10; 11) denoting the unit eigenvectors of the right Cauchy-Green strain tensor 
Ctt01 (x0 ).
Perfect shearless transport barriers in 2D are, therefore, sets of shrinklines and stretchlines, 
which agrees with the conclusions of the local variational theory in §5.3.1. Of all the 

5.4 Global Variational Theory of LCSs
205
trajectories of these direction fields, hyperbolic LCSs will be special ones that maximize 
local repulsion or attraction. In contrast, parabolic LCSs will be special in that they are the 
closest to being neutrally stable compared to neighboring sets of shrinklines and stretchlines.
We now examine the three possible boundary conditions for the variational problem (5.63): 
free-endpoint, fixed-endpoint and periodic boundary conditions (see Appendix A.8).
Free-Endpoint Boundary Conditions: Parabolic LCSs
The free-endpoint boundary condition (A.29) takes the particular form @xo &£ (x0, x0) = 0 
for the averaged shear functional P(y). Farazmand et al. (2014) show that this relationship 
can only hold at tensorline singularities, i.e., at points satisfying
21 (X0° = ^2 (X0° = 1:
(5.66)
Trajectories (or, more generally, heteroclinic chains of trajectories) of the ODE family 
(5.65) connecting such tensorline singularities are rare but have a profound impact relative to 
other tensorlines. Indeed, they prevail as stationary curves of the averaged shear functional 
P(y° under the broadest possible class of continuous perturbations, including perturbations 
to their endpoints. To ensure the observability of such heteroclinic chains as parabolic LCSs, 
Farazmand et al. (2014) further restrict this family of curves to those that are:
(P1 ° robust, i.e., persistent under small changes to the velocity field.
(P2° locally the closest to being neutrally stable and hence behaving as the idealized jet core 
does in Fig. 5.39.
To ensure the robustness property (P1), we seek structurally stable chains of alternating 
stretchlines and shrinklines, i.e., chains that perturb to nearby chains of heteroclinic con­
nections among tensorline singularities under small perturbations of the velocity field. As 
Farazmand et al. (2014) show, only heteroclinic tensorlines connecting wedge-type singu­
larities to trisector-type singularities can form a structurally stable heteroclinic chain, as 
illustrated in Fig. 5.46(a).
As a preliminary step to ensure the neutrally stable behavior prescribed in (P2), we exclude 
the possibility of a strictly repelling or attracting LCSs by selecting an alternating chain of 
shrink and stretchlines, as illustrated in Fig. 5.46(b).This subplot again highlights that each 
element of the alternating chain must be a trisector-wedge connection. The left plot of 
Fig. 5.46(c) shows the total set of tensorlines satisfying these requirements for the standard 
non-twist map. Proposed by del Castillo-Negrete et al. (1996), this can be written as
Xn+1 = Xn + a (1 - y2+1) ; 
yn+1 = yn - b sin (2nXn° ,
(5.67)
with xk 2 [-1/2,1/2] mod 1 and with the parameter values a = 0:08 and b = 0:125.12
12 The strain eigenvector fields £i(x0; t0; t1°, with t0 = 0 and t1 = n + 1, of the autonomous discrete mapping 
(5.67) can tie computed from the Cauchy-Green strain tensor Cn+1 = [rFn+1] rFn+1 associated with the 
discrete flow map Fn+1 = (F0)n+1, where F0 is defined by formula (5.67).

206
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.46 (a) A structurally stable tensorline between tensorline singularities must 
be a trisector-wedge connection. (b) The chain should be formed by an alternating 
sequence of shrinklines and stretchlines. (c) (Left) Structurally stable heteroclinic 
tensorlines in the integrable standard non-twist map. (Right) The single heteroclinic 
chain of alternating stretchlines (blue) and shrinklines (red) forming the initial posi­
tion of a parabolic LCS (jet core) for the same map. Adapted from Farazmand et al. 
(2014).
-0.5 -0.4 -0.3 -0.2 -0.1 0 0.1 0.2 0.3 0.4 0.5
(c)
The second step to ensure that the neutrality condition (P2) holds is to require the neutrality 
measure
/ 
\ 2
N.W = fixM - 1 ; i ,j
(5.68)
to admit a weak minimum along each shrinkline (i = 1) and each stretchline (i = 2) in the 
heteroclinic chain. Specifically, we say that a tensorline segment is a weak minimizer of 
its corresponding N^i (x0° if both y and the nearest trench of N^i lie in the same connected 
component of the set over which the scalar function N^. (x0° is convex (see Farazmand et al., 
2014 for more detal)). Applying this weak minimizer condttion to ah possible atternating 
shrinkline-stretchline chains on the left of Fig. 5.46(c) selects the initial position of a single 
parabolic LCS shown on the right of Fig. 5.46(c).
In Fig. 5.47, we show the application of the global variational theory of parabolic LCSs 
to the unsteady wind field data for Jupiter’s atmosphere, already analyzed in Fig. 5.42. 
The figure also confirms via material advection that the parabolic LCS identified in this

5.4 Global Variational Theory of LCSs
207
fashion remains coherent, blocking advective excursion of air between the upper and lower 
halves of the material jet. This perfect shearless barrier generates the typical chevron-shaped 
material patterns shown in the bottom pilot: of Fig. 5.47, providing an explanation for earlier 
observationsby Simon-MiIler etal. (2012) of such chevrons.
Figure 5.47 A perfect shearless zonal transport barrier in Jupiter’s atmosphere, re­
constructed as a parabolic LCS from video footage acquired by NASA’s Cassini 
mission. (Top) An instantaneous snapshot of the unsteady wind field reconstructed 
from the video. (Middle) A heteroclinic chain of tensorlines satisfying (P1)-(P2), ex­
tracted from the reconstructed wind field. (Bottom) Chevron-shaped deformation of 
sets of air pockets, with their initial positions shown in the middle plot. A video show­
ing the material evolution of these air pockets along the parabolic LCS is available 
at https://epubs.siam.org/doi/suppl/10.1137/140983665/suppl_file/ 
chevron_movie.mov. Adapted from Hadjighasem and Haller (2016a).
Fixed-Endpoint Boundary Conditions: Hyperbolic LCSs
Hyperbolic LCSs obtained from their 2D global variational theory are non-closed material 
curves whose time t0 initial position must stay away from the tensorline singularities (5.66), 
given that no repulsion or attraction can be exerted on neighboring trajectories at such 
points. We conclude, therefore, that initial positions of hyperbolic LCSs must be individual 
trajectories of the direction fields (5.65) that are bounded away from tensorline singularities 
and their averaged stretching or repulsion is locally maximal among nearby tensorlines. This 
conclusion is identical to our findings from the local variational theory of LCSs in §5.3.1. 
The new information obtained from the global theory is that hyperbolic LCSs prevail as 
stationary curves over a smaller family of material lines and hence their impact on the flow 
is less pronounced than the impact of parabolic LCSs.

208 
Lagrangian and Objective Eulerian Coherent Structures
Periodic boundary conditions: Closed shearless LCSs
Periodic boundary conditions for a closed shearless LCS would be satisfied for chains of 
shrinkline or stretchlines (i.e., trajectories of the direction field (5.65) with i = 1 or i = 2) 
that form a closed loop. A one-element closed chain, i.e., a closed hyperbolic LCS, cannot 
arise in these equations for incompressible flows over long enough time intervals. The reason 
is that such closed loops would have to grow or decrease the length of any of their subsets 
under advection while still conserving their enclosed area.
Although no closed trajectories for the direction field (5.65) with i = 1 or i = 2 have been 
documented in the literature, it is unclear how one could generally prove their nonexistence. 
One can only exclude the existence of closed shrinklines and stretchlines that experience 
substantial change in their lengths in incompressible flows. To see this, we recall that by the 
isoperimetric inequality in two dimensions, the length of a closed curve y and the area of its 
interior, int(y), satisfy the inequality length(y° > 4^area(int(y°° (see, e.g., Bandle, 1980). 
This inequality would necessarily be violated by advected positions of a closed shrinkline y 
whose length shrinks exponentially yet its area remains constant by material advection. The 
isoperimetric inequality, however, still does not exclude mild increases in length and hence 
does not exclude the existence of closed stretchlines under forward advection. A similar 
argument shows the nonexistence of exponentially shrinking shrinklines when one applies 
the isoperimetric inequality to their backward advected positions in an incompressible flow. 
Again, however, mildly deforming shrinklines cannot be excluded by this argument.
It is certainly possible to find a closed parabolic LCS formed by alternating stretchlines 
and shrinklines on a spatially periodic domain. Known examples of such periodic parabolic 
LCSs include the jet cores of the standard non-twist map (5.67) and the Bickley jet model 
of del Castillo-Negrete and Morrison (1993) under the addition of various unsteady effects, 
including chaotic forcing (see Farazmand et al., 2014 for details). Closed zonal jet cores of 
the type shown in Fig. 5.47 for Jupiter’s atmosphere represent another class of examples.
5.4.4 Unified Variational Theory of Elliptic and Hyperbolic LCSs in 3D
Oettinger et al. (2016) develop an extension of the 2D global variational theory of elliptic 
LCSs, which we discussed in §5.4.1,to 3D flows. They start by examining the existence of 
material surfaces M(t° c R3 over a finite time interval »10; 11] that are pointwise uniformly 
stretching. This means that all vectors in each initial tangent space TX0M(10° are stretched 
by the same factor J(x0° 2 | pJ । (x0°; pA3(x0°] under the linearized flow map rFt0(x0°. 
Here, i denote, as before, the squared singular values of rFtt0 , i.e., the eigenvalues of 
the right Cauchy-Green strain tensor CJ0(x0°. Oettinger et al. (2016) show that pointwise 
uniformly stretching tangent spaces can only exist, in principle, with stretching factor J(x0° = 
pl2(x0°(1 + 5° for some constant j5j « 1. For this stretching factor, uniformly stretching 
tangent spaces must be normal to some member of the two vector field families
n(x0 ° =
J2(X0° (1 + 5° - J1(X0° 
J3(X0° - A-2(X0° (1 + 5°
J3(X0°- J (X0° 
' '\ 
J3(X0)- J1(X0° 
^3(X0°:
(5.69)

5.4 Global Variational Theory of LCSs
209
As in the case of hyperbolic and elliptic LCSs constructed from their local 3D theory, a 
smooth surface satisfying (5.69) only exists if
rn;n= 0; rrn;nn =0
(5.70)
by the results inAppendix A.7.
As we concluded in similar settings of the local variational theory, conditions (5.70) will 
generally not hold along a smooth 2D manifold. Oettinger et al. (2016) circumvent this issue 
by requiring pointwise nearly-uniformly stretching elliptic LCSs to be only continuous, then 
proceed to assemble them from their computable intersections with reference planes. This is 
the same procedure that we discussed for hyperbolic and elliptic LCSs in §§5.3.1 and 5.3.2.
An alternative approach to resolving the over-constraining assumptions of the local varia­
tional theory and the global variational theory of Oettinger et al. (2016) is based on a relaxed 
local extremum principle proposed by Oettinger and Haller (2016). This relaxed principle 
would not require the full tangent space Tx0 M0 of the LCS initial position M0 to be normal 
to the direction of most repulsion, attraction or shear. Instead, it would require that at least 
one direction in each tangent space should be normal to these directions.
Definition 5.14 A relaxed LCS in a 3D flow over the time interval »t0; 11] is a structurally 
stable material surface M(t° with initial position M0 such at all points x0 2 M0, the tangent 
space Tx0 M0 contains a vector normal to the direction of highest repulsion, attraction or 
shear.
An inspection of Proposition 5.10, Proposition 5.11 and Eq. (5.69) reveals a single unit 
vector that is normal to all normal vector fields arising in these formulas: the intermediate 
Cauchy-Green eigenvector, £2. We, therefore, have the following result.
Theorem 5.15 All 2D structurally stable invariant manifolds of the 3D direction field
x0(S° = £2(x0(s°; 10; 11°
(5.71)
are relaxed LCSs.
Remarkably, therefore, all relaxed attracting LCSs, repelling LCSs and elliptic LCSs can 
be sought as invariant manifolds of the same direction field (5.71), defined by the intermediate 
eigenvector field of the right Cauchy-Green strain tensor Ctt (x0 °.
As we noted in §4.4.2,trajectories advected from any smooth curve of initial conditions 
in a steady 3D flow will form smooth invariant manifolds for finite advection times. Of 
those manifolds, the ones intersecting a Poincare section in an invariant curve will keep their 
integrity for all times and will be observed as transport barriers, as we discussed for steady 
flows in §4.4.1.Therefore, to extract robust relaxed LCSs, we first locate invariant curves 
of appropriately defined Poincare maps for the steady direction field (5.71). We then advect 
these curves under the flow map of the direction field (5.71) to obtain the full relaxed LCS 
positions at time t0 , denoted as M0 . Finally, we use the flow map Ftt10 of the velocity field 
v(x; t° to obtain the evolving relaxed LCS at time t as M (t° = Ftt01 (M0 °.

210
Lagrangian and Objective Eulerian Coherent Structures
For a practical numerical implementation of this procedure, we use a modified version of 
system (5.71) in the form
X0(5° = sign (&(xo(s°; t0; 11 °;x0(s - A°) J (xo(5°; to; 11° &(xo(5°; to; 11
a (xo; to; 11 ° =
^2(x0; t0; t 1 ° ~ ^1 (x0; t0; t 1 ° 2
^2(xo; to; t 1 ° + ^1 (xo; to; t 1)_
'13 (xo; to; t 1 ° ~ ^2(xo; to; t 1 ° 2 
^3 (xo; to; t 1 ° + ^2(xo; to; t 1 °.
(5.72)
which locally orients the 2 vector field and replaces its tensorline singularities with fixed 
points (see our discussion surrounding Eq. (5.34)). The computation of LCSs in 3D unsteady 
flows using the 2 eigenvector field is implemented in Notebook 5.8.
—
Notebook 5.8 (UnifiedLCSTheory) Computes LCSsfrom tensorlines from the interme­
diate eigenvector field of the right Cauchy-Green strain tensor in a 3D unsteady velocity 
data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/ 
demos/AdvectiveBarriers/UnifiedLCSTheory
As a proof of concept, we show in Fig. 5.48 two Poincare maps, constructed from the same 
set of points shown in Fig. 5.48(a),for the steady ABC flow already analyzed in Figs. 4.22 
and 5.38.The Poincare map in Fig. 5.48(b) is the classic first-return map for the ABC flow 
constructed for the z = o Poincare section. In contrast, Fig. 5.48(c) shows the first return 
map for the same Poincare section constructed from the trajectories of the ODE (5.72). 
Remarkably, the 2-Poincare map shows substantially more clarity from the same set of 
initial conditions.
Figure 5.48 Classic Poincare map and 2-Poincare map computed fromEq. (5.72) 
for the steady ABC flow, from the same set of initial conditions selected on the z = o 
plane as Poincare section. Adapted from Oettinger and Haller (2016).
Armed with this proof of concept for steady flows, we now turn to an aperiodically forced 
version of the ABC flow, given by
A sin z + C(t° cos y 
B(t° sin x + Acosz 
C(t° sin y + B(t° cos x
B(t° = Bo 1 + ko tanh (k1t° cos (k2t°2 ;
C(t° = Bo 1 + ko tanh (k1t° cos (k3t°2;
(5.73)

5.4 Global Variational Theory of LCSs
211
with the parameter values A = V3; B0 = V2, C = 1, k0 = 0:3; k 1 = 0:5, k2 = 1:5 and 
k3 = 1:8. This time dependence models a growing and then saturating oscillatory instability 
for the steady ABC flow under perturbations. Despite this aperiodic time dependence, Eq. 
(5.72) is still an autonomous system for which the £2-Poincare map (or first return map) 
based at z = 0 is computable with roughly the same level of numerical effort as for the 
steady ABC flow. Figure 5.49 shows time 10 = 0 initial positions of hyperbolic and elliptic 
LCSs obtained from the advection of open and closed invariant curves of the ^-Poincare 
map under the flow generated by Eq. (5.72).
Figure 5.49 (a) Open and closed invariant curves of the 2 -Poincare map based on 
the z = 0 plane for the aperiodically time-dependent ABC flow (5.73). (b) Time 
10 = 0 positions of hyperbolic (green) and elliptic LCSs (red, blue and yellow). 
Adapted from Oettinger and Haller (2016).
F50
F10
Figure 5.50 (Top) Behavior of gthe initial position i M0r of one of the elliptic LCSs 
shown inFig. 5.49e under advection by the flow map. The toroidal coordinates used 
in this visualization are the same as in Eq. (5.45).(Bottom) Impacteof one of the 
hyperbolic LCSs (green) shown in Fig. 5.49 on a nearby materialu sphere (purple) 
under advection by the flow map. Adapted from Oettinger and Haller (2016).
Figure 5.50 shows how a specific elliptic (toroidal) LCS indeed retains its coherence under 
. ... ... .......................
advection throughout its extraction interval. The same figure also illustrates how a repelling 

212 
Lagrangian and Objective Eulerian Coherent Structures
LCS causes a transversely placed sphere of nearby initial conditions to stretch substantially 
and uniformly over its extraction interval.
5.5 Adiabatically Quasi-Objective, Single-Trajectory 
Diagnostics for Transport Barriers
If a velocity field v(x t° is known on a dense enough grid, then the velocity gradient rv can 
be computed with reasonable accuracy. This makes objective Eulerian quantities, such as the 
rate-of-strain tensor S and its invariants, available for flow analysis. Similarly, a numerical 
computation and differentiation of the flow map Ft0 (x0° is feasible from a spatiotemporally 
well-resolved velocity field, and hence the objective Lagrangian strain tensors and their 
invariants used throughout this chapter can be computed with reasonable accuracy.
None of these objective quantities, however, can be computed reliably from sparse velocity 
data for which spatial differentiation is unfeasible. An important example of an inherently 
sparse data set is the Global Drifter Program (GDP) of the National Oceanic and Atmospheric 
Administration (NOAA) of the United States, comprising more than 20;000 ocean drifter 
trajectories (see Lumpkin and Pazos, 2007). A representative snapshot of the distribution of 
these drifters is shown in Fig. 5.51.
Figure 5.51 An inherently sparse Lagrangian data set: drifter configuration in the 
NOAA Global Drifter Program (GDP) on April 5, 2021. Colors indicate the affiliation 
of the individual drifters. Image: NOAA.
Individual trajectory data in this data set is available in the form of a time-dependent 
array of positions {xi(tij)}i j. where the index i labels individual trajectories and tij labels 
the jth time instance at which the position of the ith trajectory is known. Originally, the 
temporal resolution of drifter tracking was at 6 hours, but the majority of the drifters are 

5.5 Single-Trajectory Diagnostics for Transport Barriers 
213
now being tracked by the Argos positioning system. This more advanced tracking provides 
drifter locations with errors of the order of 100 meters at an average temporal resolution of 
1:2 hours since 2005 (see Elipot et al.,2016). While this temporal resolution yields reasonably 
accurate drifter velocities, the spatial resolution is clearly too coarse for differentiation, as 
can be deduced fromFig. 5.51.
Such sparsity prohibits the computation of the objective scalar, vector and tensor fields we 
have been using in this chapter. We are, therefore, forced to seek other quantities that could 
be reliably used in detecting transport barriers and can still be inferred from sparse data. Such 
an inference is only possible if those quantities are defined on single trajectories, without 
reference to other trajectories. Yet none of the quantities associated with a single trajectory 
- such as trajectory length, tangent vectors, curvature or looping number - is objective. This 
can be seen by noting that in a frame co-moving with the trajectory, the trajectory itself 
becomes a fixed point and hence all the quantities we have just mentioned vanish identically 
in that frame.
A way to address this issue is to use quasi-objective single-trajectory diagnostics in the 
extraction of transport barriers from sparse flow data. By the definition of quasi-objectivity 
given in §3.6,this task requires first the identification of objective single-trajectory diagnostic 
fields to which their quasi-objective counterparts are expected to be close in all frames satis­
fying a certain condition. As a second step, we need to find the appropriate quasi-objective 
diagnostics that do approximate the objective diagnostics under verifiable conditions on their 
frame of reference. We will address these two tasks in the upcoming sections.
First, however, motivated by slowly varying geophysical flow data sets, we restrict the 
general frame-change family (3.1) to slowly varying (or adiabatic) frame changes of the form
x = Q(t°y + b(t°; 
|QI; |bI « 1: 
(5.74)
Under such observer changes, the velocity transformation formula (3.17) simplifies to the 
adiabatic velocity transformation formula
v = QT (v - Qy - lb) « QTv 
(5.75)
over compact spatial domains (in which y is uniformly bounded). Following Haller et al. 
(2022), we then call an Eulerian or Lagrangian quantity adiabatically quasi-objective under 
a condition (A) if, in all frames related via adiabatic frame changes (5.74), the quantity 
approximates the same objective Eulerian or Lagrangian quantity whenever the frame satisfies 
condition (A).
5.5.1 Adiabatically Quasi-Objective Diagnostic for Material Stretching
An objective stretching field candidate is the direction-dependent version of the FTLE field 
(5.7). This exponent measures the average growth rate of a specific small perturbation 0 
to an initial condition x0 under the flow map Ft0(x0° of a velocity field v(x t° over the time 

214 
Lagrangian and Objective Eulerian Coherent Structures
interval »t0; tN]. Using Eq. (A.7)of Appendix A.3, wee aaCuulate this averaged stretching 
exponent, A^ (x0; £0), for an unsteady flow as
AtN(X0;£0° = -1— log 
; 
(5.76)
tN 
t0 
|£01
wtere £(tN ° = rFtt0N (x0°£0 is tte vector pointing from tte unperturbed trajectory position 
x(tN; t0; x0° to tte perturbed trajectory position x(tN; t0; x0 + £0°. Indeed, Att0N (x0; £0° returns 
a single positive or negative exponent ttat ctaracterizes tte overall growtt £(t° in tte time 
interval »t0; tN]. To obtain more information on tow muct distortion infinitesimal fluid 
elements attacted to x(t ; t0; x0° experience, one may use tte averaged hyperbolicity strength
AtN 
t0 (x0; £0
1 
rtN
tN - t0 J t0
d log 
dt
|£( t )| 
|£o|
dt.
(5.77)
Tte integrand in ttis expression is always positive, reflecting tte fact ttat even if £ (t° is 
strinking, some otter infinitesimal perturbation to tte trajectory must be growing in an 
incompressible flow. Therefore, A^N (x0; £0) is a measure of the total exposure of a trajectory 
to typerbolicity in tte flow. Under any Euclidean observer ctange (3.5), formula (3.13) stows 
the objectivity of |£(t)|, which implies that both AjN and AtN are objective scalar fields.
Steady Flows
In a steady velocity field v(x°, the Lagrangian velocity vector v(t° = v(x(t ; t0; x0°° evolves as 
a material element, as we have seen in §2.2.8. Therefore, as long as the assumption
j@tv(x;t°j = 0 
(5.78)
holds in the current frame of reference, one can select the specific material element £(t° = v(t° 
in the formulas (5.76)-(5.77) to assess the evolution of the length of v(t) via the diagnostics 
AtN(X0; Vo) =—1—log |v(tN°; AtN(X0; Vo) =—1— f d- log JvY dt. (5.79) 
t0 
tN - to 
|vol 
t0 
tN - toJt0 
dt 
|Vo|
Adiabatic coordinate changes of the form (5.74) approximately preserve the norms of all 
velocities by formula (5.75). Therefore, under slowly varying frame changes the fields 
Alt0 (x0; v0) and A^N (x0; v0) are nearly constant and approximate true material stretching along 
trajectories, as long as assumption (5.78) holds.
Specifically, as noted by Haller et al. (2021, 2022), if only discretized trajectory data 
fx(ti)giN=0 are available for a trajectory x(t; t0; x0), then the trajectory stretching exponents 
(TSE)
'T’CT^tN^ 
1 
| x( tN)| 
'T'CTtN 
1 
\ 
| x( ti+1)|
TSEtN(xo) = -t-tolog |W; 
TSEt0(xo) = 
g 
’ 
(5-80)
for all x(ti) , 0, i = 0;...;N, are adiabatically quasi-objective measures of trajectory 
stretching and hyperbolicity strength under assumption (5.78). Under that assumption, the 
TSE fields do not just approximate an objective scalar field, as required for quasi-objectivity, 
but in fact coincide with an objective scalar field.
There can be multiple frames in which a fluid flow satisfies the steadiness assumption 
(5.78). For instance, the center-type velocity field v(x) = (x2; -x 1) is steady in any frame that 
rotates at a constant speed around x = 0. Similarly, the parallel shear flow v(x) = ( f (x2); 0), 

5.5 Single-Trajectory Diagnostics for Transport Barriers
215
with a arbitrary function f, is steady in any frame that moves at a constant speed in the x1- 
direction. Under such steady-to-steady frame changes, Lagrangian velocities remain evolving 
material line elements along a material line in the new frame, given that any trajectory is 
also a material line in the transformed frame.
Unsteady Flows
Differentiating Eq. 22.56) that defines the Lagrangian velocity v(t° with respect to time, we 
obtain that, in general unsteady flows, v(t° evolves along a trajectory x(t; t0; x0) according to 
the equation
v = rv (x(t; t0; x0°; t° v + @tv (x(t; t0; x0°; t°. 
(5.81)
Therefore, if the Lagrangian acceleration a(t° := v(t° along x(t; t0; x0° satisfies
jaj j@tvj; 
(5.82)
then v(t° evolves approximately as a material element. Therefore, the TSE diagnostics defined 
in Eq. (5.80) are adiabatically quasi-objective under assumption (5.82), closely approximating 
the objective fields AJN and A^ in the given frame, as pointed out by Haller et al. (2022).14 We 
note that (5.82) quantifies the assumption that the Lagrangian time scales dominate Eulerian 
time scales in the flow (see, e.g., Shepherd et al., 2000).
As the evolution of v(t° will not be exactly material in frames satisfying assumption (5.82), 
the TSE diagnostics will not yield exactly the same values in all those frames. They will 
nevertheless yield values close to those of their objective counterparts, AJN and AtN, in those 
frames. The computation of the TSE diagnostic for 2D flows is implemented in Notebook 5.9.
Notebook 5.9 (TSE2D) Computes the trajectory stretching exponent (TSE) field for a 2D 
unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/AdvectiveBarriers/ TSE2D
A similar computation of the TSE diagnostic for 3D flows is implemented in Notebook 5.10. 
—
Notebook 5.10 (TSE3D) Computes the trajectory stretching exponent (TSE) field for a 
3D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/
demos/AdvectiveBarriers/ TSE3D
5.5.2 Adiabatically Quasi-Objective Diagnostic for Material Rotation
An objective rotation field candidate can be defined as the averaged rotation-rate deviation 
of £(t° from the averaged mean rotation rate of the fluid, based on the considerations used in
14 The original argument of Haller et al.(2021)for the unsteady TSE diagnostics lacked assumption (5.82) and 
was incorrectly formulated in the extended phase space. This error was demonstrated by Theisel et al. (2022) 
on a simple counterexample, then corrected by Haller et al. (2022), who also added the requirement of adiabatic 
time dependence for observer changes.

216
Lagrangian and Objective Eulerian Coherent Structures
the derivation of the LAVD field (see §5.2.11 and Haller, 2016;Haller et al., 2016). Indeed, 
Haller et al. (2021) show that the averaged rotation deviation
5tNN(X0;(0° = ^17 fd 
- 2!(t' 
d 
(5.83)
tN t Oj to dt j(( t °j 
2 
j(( t °j
is an objective measure of the average relative rotation speed experienced by the tangent 
vector ((t° during its evolution along the trajectory x(t; t0; x0°. Here, !tt° denotes the spatial 
average of the vorticity over the flow domain, as in §5.2.11.
Steady Flows
Haller et al. (2021) also show that under assumption (5.78) and the additional assumption
1 _ . v 
v(t° 
d v(t°
2!(t X jv(t°j ^ dt jv(t°j ’ 
.
the trajectory rotation average (TRA)
<n, , 
1 
V1 
-i hX(ti°,X(ti+i°i
TRA. (x0° =---------- > cos 1 
(5.85)
tn ~ to i=0 
jx(ti°j jx(ti+i°j
for all x(ti° , 0, i = 0,...,N is an adiabatic quasi-objective measure of total trajectory 
t tN tN 
tN
rotation. As Haller et al. (2021) note, TRAt0 (x0° becomes fully objective without assumptions 
(5.78)-(5.84) when applied to objective vector fields. This will be important in Chapter 9 
in applications of the TRA field to the detection of active barriers to transport that obey 
objective differential equations.
Unsteady Flows
The extension of the TRA metric to unsteady flows follows the same idea as the unsteady 
extension of the TSE metric given in §5.5.1. Namely, under assumption (5.82), the evolution 
of the Lagrangian velocity is nearly material by formula (5.81). Therefore, the trajectory 
rotation average, TRAtN (x0°, defined in Eq. (5.85) is an adiabatically quasi-objective measure 
of total trajectory rotation under assumptions (5.82)-(5.84). The computation of the TRA 
diagnostic for 2D flows is implemented in Notebook 5.11. 
—
Notebook 5.11 (TRA2D) Computes the trajectory rotation average (TRA) field for a 2D 
unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/TRA2D
A similar computation of the TRA diagnostic for 3D flows is implemented in Notebook 5.12. 
—
Notebook 5.12 (TRA3D) Computes the trajectory rotation average (TRA) field for a 3D 
unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/
demos/AdvectiveBarriers/ TRA3D

5.5 Single-Trajectory Diagnostics for Transport Barriers
217
5.5.3 Single-Trajectory, Adiabatically Quasi-Objective LCS Computations 
for the AVISO Data Set
We illustrate the adiabatically quasi-objective, single-particle LCS diagnostics TSE, TSE 
and TRA on the 2D, satellite-altimetry-derived ocean-surface current product (AVISO; see 
Appendix A.6) that we have already used for Lagrangian analysis in several earlier examples. 
We focus on the Agulhas leakage region
U = {(x;y° 2 »-2:5°;5°] x »-40°;-30°]g:
(5.86)
Haller et al. (2022) find that assumption (5.82) is satisfied for the majority of initial 
conditions in this domain, for which they obtain jaj 
10 j@t vj. Furthermore, Haller et al.
(2021) find that assumption (5.84) is satisfied on average for 98:9% of all initial positions, 
with the left-hand side of the inequality in (5.84) not exceeding 1% of its right-hand side 
in these cases. Using the AVISO data set, Haller et al. (2021) generate trajectory data over 
a period of 25 days to compute the TSE25(x0° metric over a uniform grid of 250 x 250 
25 
initial conditions. Subsequently, they repeat these calculations with the metric TSE0 (x0° 
after a gradual, random subsampling of the initial grid to 10%, 1% and 0:1% of the initial 
conditions.
Figure 5.52shows a comparison of the results, with the squared relative dispersion and 
FTLE also computed over the same grid and over its randomly subsampled version.
Because of the nonuniformity of the subsampled grid, the squared relative dispersion is 
computed from the formula
(5.87)
d2(Xi0;t0;t° = jxi(t>- x-i(t212 
|Xi0 - X-i01
where xi and x_i are trajectory pairs with initial conditions xi0 and x_i0 that are initially close 
at time 10 (e.g., |xi0 - x_i01 = r0 « 1). The FTLE field in these comparisons is computed 
after the final positions are interpolated using a C1 -interpolant.
A highlighted repelling LCS is clearly visible in the top row of Fig. 5.52 as a ridge in all 
three diagnostics. The quality of the FTLE05(x0° field quickly degrades with decreasing reso­
lution and d2 loses track of the details of most structures as well. Overall, the TSE diagnostic 
is on par with multi-trajectory diagnostics at full resolution but has lower computational 
costs. At decreased resolution, the single-trajectory diagnostic TSE is clearly superior in 
capturing the most robust fronts even at severe sparsifications of the original numerical grid.
Figure 5.53 shows an evaluation of the single-trajectory, adiabatically quasi-objective 
------ 25 z z
rotation metric TRA0 (x0° over the same full and sparsified grids that were used in Fig. 5.52.
In these plots, the TRA is compared with the objective d2(xi0;0; 25° field and with the 
polar rotation angle field PRA25(x0°, whose level curves are objective in two dimensions (see 
§5.2.10). An inset in each plot zooms in on a region with a vortex identified by the geodesic 
theory of elliptic LCSs (see §5.4.1). All three metrics highlight this vortex in the first row of 
Fig. 5.53,along with several other elliptic LCSs. Note that PRA 205 (x0° provided the highest 
level of detail at this full resolution.
25 z z
Subsequent rows of Fig. 5.53 show that TRA0 (x0° retains most of its structure under ran­
dom subsampling, enabling the recognition of three of its maxima, which mark vortices, even 
at the lowest resolution. For the other two objective, multi-trajectory diagnostics, discerning

218
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.52 Single- and multi-trajectory stretching metric comparisons for the 
AVISO ocean surface current field in the Agulhas region at full and decreased grid 
resolutions. Adapted from Haller et al. (2022).
coherent structures becomes unfeasible under progressive subsampling. Haller et al. (2021) 
and Haller et al. (2022) present further comparisons for steady and unsteady versions of the 
ABC flow (seeEq. (4.29)), which yield similar conclusions about the TSE and TRA metrics 
when used for 3D flows.
5.5.4 Adiabatically Quasi-Objective Material Eddy Extraction 
from Actual Ocean Drifters
Encinas-Bartos et al. (2022) use the TRA field defined in Eq. (5.85) to identify Lagrangian 
(i.e., material) eddies in various drifter data sets. The identified eddies range in size from the 
submesoscales to the mesoscales. As already noted in §5.5.3, the key assumptions (5.82)­
(5.84) securing the adiabatic quasi-objectivity of the TRA field have broadly been found to

5.5 Single-Trajectory Diagnostics for Transport Barriers
219
Figure 5.53 Same as I^ig?. 5.52 but with single- and multi-trajectory rotation metrics.
Adapted from Haller et al. (2022).
hold over ocean regions containing multiple eddies (see also Abernathey and Haller, 2018, 
and Beron-Vera et al., 2019b).
With the TRAto (x£° field computed for individual drifter initial conditions xk, one can use 
interpolation to infer the full TRAtN (x0° diagnostic field. Given their focus on locating elliptic 
LCSs, Encinas-Bartos et al. (2022) propose interpolation of the TRA field via linear radial 
basis functions. As an example of the results obtained from this approach, the left subplot in 
Fig. 5.54shows a material eddy region inferred from the GDP drifter data set already featured 
inFig. 5.51.The nominal eddy boundary is identified as the TRA contour corresponding to 
70% of the local maximum visible in the plot. The right subplot shows a persistent floating 
sargassum accumulation inferred from the Maximum Chlorophyl Index (MCI) in the same 
location, which independently confirms the presence of a coherent material eddy (see also 
Beron-Vera et al., 2015, for a prior analysis of this feature by other methods).

220
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.54 (Left) The TRAt0 (xo° field reconstructed from the GDP data set with 
t0 = 246 days and tN = 276 days in the year 2006. A representative level curve of the 
TRA field is shown in white along with the 10-day trajectory pieces of the six drifters 
present in the selected region at the time. (Right) Sargassum accumulation inferred 
from the Maximum Chlorophyl Index (MCI) also suggests a coherent material eddy 
in the same location. Adapted from Encinas-Bartos et al. (2022).
5.6 Elliptic-Parabolic-Hyperbolic (EPH) Partition and LCSs
We close our discussion of LCSs by deriving an objective Eulerian partition of fluid flows 
into regions in which all fluid trajectories share the same instantaneous stability type. If a 
trajectory stays in the same region of the partition for extended times, then its Lagrangian 
stability type turns out to coincide with the instantaneously inferred Eulerian stability type. 
Therefore, while the upcoming §5.7 examines a connection between objective Eulerian flow 
features and LCSs in the limit of short times, here we explore such a connection over longer 
time intervals.
We start by recalling the setting of §2.2.8, in which we considered materially evolving 
infinitesimal perturbations £(t° along a fluid trajectory x (t; t0; x0° within a flow domain 
x 2 U Rn with n = 2 or n = 3. Taking the inner product of the equation of variations 
(2.45) with £(t° then leads to the expression
(t; £) = 1 d-\^\'2 = X; rv(X; tXi ; 
(5.88)
or, equivalently,
1 d t = C(t; X; t°; 
C(t X; t° := ht; S(x tXi ; 
(5.89)
2dt
with the rate-of-strain tensor S = ST defined in Eq. (3.34).
The symmetric tensor S has zero trace for incompressible flows and hence it is either 
singular or indefinite. In either case, the local zero strain set, Z(x; t), of instantaneously 
unstrained perturbations, defined as

5.6 Elliptic-Parabolic-Hyperbolic (EPH) Partition and LCSs 
221
Z (X; t ° = {£ 2 Rn : h£; S(X; t °0 = 0g ;
is nonempty. It is not hard to see that if S(x; t° is nonsingular and hence indefinite, then Z(x, t° 
is a generalized cone: a set of two orthogonal lines for 2D flows (n = 2) and a 2D elliptic 
cone for 3D flows (n = 3), as shown in Fig. 5.55. The figure shows the zero set Z(x, t° in the 
coordinate system defined by the rate-of-strain eigenvectors ei(x, t°, defined as
Sei = 5 i ei; 
51(X; t ° < ■■■ < S n(X; t °; 
| Cf (X; t )| = 1; i = 1;:::; n: 
(5.90)
By the objectivity of S, the generalized cone-bundle Z(x, t° is an objectively defined feature 
of a fluid flow.
Figure 5.55 The qualitative geometry of the zero strain set Z(x, t° in 2D and 3D 
flows at a point x 2 U satisfying det S(x, t° , 0. For n = 3, we distinguish between 
two cases depending on the sign of the intermediate rate-of-strain eigenvalue s2(x, t). 
Also shown is the sign of the quadratic form C(0 x, t° defined in Eqtj. (5.89) inside 
and outside the cones formed by Z(x, t°.
In the sector with C(0 x, t° > 0, perturbations to the fluid trajectory at the location x grow 
instantaneously, while perturbations decay instantaneously in the sector with C(0 x, t° < 
0: The instantaneous flow geometry near x will crucially depend on how the evolving 
perturbations cross the moving cone Z (x(t; 10, x0°, t° along the trajectory x(t; 10, x0°. This 
relative motion through Z is determined by the material derivative
DC& X;t° = d-C(Ot°; x(t; 10;X0°; t). 
(5.91)
Dt dt
Indeed, if Df > 0 is positive at a point along Z, then perturbations move through that point 
from the negative C sector to the positive C sector. Likewise, if DC is negative at a point 
along Z , then perturbations move through that point from the positive C sector to the negative 
C sector. A direct calculation utilizing the equation of variations (2.45) gives
DC = D h£ so = 2 (I SO + /oDS$j = 2 hrv& SO + /^; DS$j
Dt 
Dt h i 
Dt hr i 
Dt
= he;Mei; 
(5.92)

222
Lagrangian and Objective Eulerian Coherent Structures
with the strain acceleration tensor, M(X; t), defined as
m = — + srv + (rv°T s = @t s + rsv + srv + (rv°T S: 
(5.93)
As noted by Haller (2005), M is an objective material derivative, the Cotter-Rivlin rate, of 
S (see Cotter and Rivlin, 1955).
We denote the pointwise restriction of M, as a linear operator, to the local cone, Z , by
Mz(X;t° := M(X;t)|z(X;t):
(5.94)
The sign-definiteness of the restricted operator Mz can then be defined via the sign­
definiteness of the quadratic form h£.MZ(x; t)£>£2Z(X;t°. It turns out that MZ can only be 
positive definite (written MZ(x; t° > 0), positive semidefinite (written MZ(x; t° > 0) or 
indefinite (written MZ(x; t° T 0), as shown by Haller (2001b) and Haller (2005). For incom­
pressible flows, Fig. 5.56 shows the instantaneous local flow geometry at the point X at time 
t, as a function of the definiteness of MZ, based on the relation (5.92).
Figure 5.56 Possible local instantaneous flow geometries near a fluid trajectory 
located at a generic point x satisfying det S(x, t° , 0 at time t. For n = 3, the case of 
s2 > 0 is similar but with all arrows reversed.
Of the instantaneous flow geometries shown in Fig. 5.56, the ones typically arising over 
open sets of X points in the flow domain are the instantaneous saddle-type (hyperbolic) be­
havior under a positive definite MZ (x; t° and the instantaneous center-type (elliptic) behavior 
under an indefinite MZ (x; t°. These two types of behaviors are separated from each other 

5.6 Elliptic-Parabolic-Hyperbolic (EPH) Partition and LCSs
223
by surfaces in the flow along which MZ(x, t° is positive semidefinite, marking instantaneous 
shear-type (parabolic) local behavior. All this implies an objective partition of the nonde­
generate flow subdomain, U(t° = fx 2 U: det S(x,t° , 0g, into an elliptic domain E(t), a 
hyperbolic domain H(t° and a parabolic domain P(t), defined as
E(t° = {x 2 U(t° : MZ(X;t° T 0},
P(t° = {x 2 U(t° : MZ(X; t° > 0}; 
(5.95)
H( t ° = {x 2 J (t ° : MZ (X; t ° > 0} :
This objective elliptic-parabolic-hyperbolic (EPH) partition applies to any 2D and 3D 
flow on the domain U(t° in which the rate-of-strain tensor in nondegenerate. The evolving 
elements of the EPH partition are sketched qualitatively in the extended phase space in Fig. 
5.57.Haller (2001b) shows that for 2D flows, the elliptic and hyperbolic domains of the 
EPH partition coincide with those obtained form the Okubo-Weiss criterion evaluated in a 
frame co-rotating with the rate-of-strain eigenvectors f ei(x t°g3=1 (see formula (3.59) and our 
discussion thereafter). For 3D flows, however, no such relation holds between the Q-criterion 
applied in strain basis and the EPH partition (see Haller, 2005).
Figure 5.57 Schematic evolution of the connected components of the elliptic domain 
E( t °, bounded by connected components of the parabolic domain P( t ° and surrounded 
by the hyperbolic domain H(t°.
The EPH partition provides a frame-indifferent mathematical link between Lagrangian 
behavior and objective Eulerian flow features. Specifically for 2D flows, all fluid trajectories 
staying in the hyperbolic domain H(t° over a finite time interval I = »10; 11] can be shown 
to be part of a hyperbolic (attracting or repelling) material line. Furthermore, hyperbolic 
material lines cannot stay in E(t° for too long: after exceeding a theoretical upper bound on 
their stay, they must necessarily be contained in an elliptic (vortical) material surface (see 
Haller,2001bfor details).
An objective diagnostic principle suggested by these results is that material surfaces 
spending the longest times in the hyperbolic region H(t ° should be hyperbolic LCSs and those 
spending the longest time in the elliptic region E(t° should be elliptic LCSs. A computation 
of times spent in the hyperbolic and elliptic regions by trajectories in a doubly periodic, 

224
Lagrangian and Objective Eulerian Coherent Structures
2D turbulence simulation supports this conclusion for elliptic LCS, as seen in Fig. 5.58.In 
contrast, hyperbolic LCS share long times in H(t° with regions of high shear.
time spent inH(t)
time spent in £(t)
Figure 5.58 Hyperbolicity times and ellipticity times computed for trajectories re­
leased from a uniform initial grid in a 2D turbulence simulation. The non-dimensional 
times are plotted over the initial positions of the trajectories; large values of these 
times (lighter colors) indicate hyperbolic and elliptic behaviors, respectively. Note 
that regions of high shear are also highlighted by the hyperbolicity time plot, just as 
by FTLE plots.
The computation of hyperbolicity and ellipticity times for general 2D unsteady flows is 
implemented inNotebook 5.13. 
—
Notebook 5.13 (MzCriterion2D) Computes times spent in the hyperbolic domain H(t° 
and elliptic domain E(t° in a 2D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/AdvectiveBarriers/MzCriterion2D
For 3D flows, a further partition of the hyperbolic region exists in the form H(t° = H+(t° [ 
H“(t°, where
H±(t° = fx 2 H(t°: sign »-s2<x t)] = ±1}.
Using this partition, Haller (2005) proves that fluid trajectories staying in H+(t° over a time 
interval I are contained in 2D, uniformly repelling material surfaces. Material perturbations 
to this surface align with a one-dimensional material line traveling with the trajectory. 
Likewise, fluid trajectories staying in H“(t° over a time interval I are contained in 2D, 
uniformly attracting material surfaces. Material perturbations to this surface realign with the 
surface due to its attractivity.
No similar mathematical conclusions are available for elliptic material surfaces, but the 
above results for the 2D case prompt Haller (2005) to give the following objective definition 
(MZ -criterion) for a material vortex in 3D flows.
Definition 5.16 A finite-time material vortex over the time interval I is a connected set of 
fluid trajectories staying in the elliptic region E(t° for all t 2 I.

5.6 Elliptic-Parabolic-Hyperbolic (EPH) Partition and LCSs
225
This criterion identifies a material vortex as a set of fluid trajectories along which material 
perturbations do not definitely align with a given material line or material surface moving 
with the fluid trajectory. Indeed, within the elliptic domain E(t°, there are always small 
material perturbations that cross from the positive (C > 0) side of the cone Z to its negative 
(C < 0) side, defying the alignment suggested by the rate-of-strain eigenvalues si(x; t°. 
As a result, the definitive material alignment observed in the H±(t° hyperbolic domains is 
either absent or inconsistent with the eigenvectors of S(x; t° in the elliptic domain. Figure 
5.59 shows numerical evaluation of this definition on a time-dependent version of the ABC 
flow similar to that in Eq. (5.73) (see Haller, 2005,for details). As the figure shows, an 
even sharper separation of elliptic and hyperbolic structures arises when the total time spent 
outside the hyperbolic region H(t° is plotted over the initial trajectory positions, as opposed 
to simply the total time spent in the elliptic region. In applications to more complex flow 
data, the implementation of the MZ -criterion is challenging due to noisiness introduced by 
the required spatial differentiation of S and by errors in the advection of trajectories (see 
Sahner et al., 2007;Urban et al., 2021).
FTLE
time spent in £, (t) 
time spent outside H (t)
Figure 5.59 Comparison of the results from the MZ -criterion in Definition 5.16 
with the FTLE field in a time-dependent ABC flow similar to Eq. (5.73).(Left) 
Hyperbolic (yellow) and elliptic (red) LCSs indicated by the FTLE field. (Middle) 
The total time spent by trajectories in the elliptic region E(t°, plotted over their 
initial conditions. Darker colors indicate longer times. (Right) The total time spent by 
trajectories outside the hyperbolic region H(t°, plotted over their initial conditions. 
Again, darker colors indicate longer times. Adapted from Haller (2005).
The computation of hyperbolicity and ellipticity times for general 3D unsteady flows is 
implemented in Notebook 5.14.
Notebook 5.14 (MzCriterion3D) Computes times spent in the hyperbolic domain H(t° 
and elliptic domain E(t° in a 3D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ AdvectiveBarriers/ MzCriterion3D

226
Lagrangian and Objective Eulerian Coherent Structures
5.7 Objective Eulerian Coherent Structures (OECSs)
A vast number of transport problems are associated with a specific time scale over which 
one would like to identify LCSs. In the absence of such a time scale, however, it is a priori 
unclear what finite time interval should be used in these studies. The LCSs one obtains will 
generally depend on the time interval chosen. Indeed, changes to that time interval alter the 
finite-time dynamical system (5.1) under consideration.
A second limitation of the LCS approach to certain transport problems is precisely its 
overall robustness: LCSs are, by construction, insensitive to short-lived or transient behavior. 
In some cases, these short-term developments are also of interest and should be identified in 
a frame-independent fashion, of which commonly used Eulerian methods are incapable.
A third limitation of LCSs in some cases is their strict material nature. While this property 
is a clear advantage for experimental observability, material invariance limits the ability 
of LCSs to frame the creation, destruction and merger of flow structures. Indeed, none of 
these phenomena can be exhibited by material sets in smooth (or at least Lipschitz) velocity 
field: their birth, annihilation or collision would violate the existence and uniqueness of the 
trajectories that form these material sets (see §2.2).
Figure 5.60 illustrates these considerations on the classic phenomenon of a vortex merger.
Figure 5.60 Experimental (dye-based) image ofa (Top) vortex merger, and (Bottom) 
its Eulerian footprint in the instantaneous vorticity field. Adapted from Meunier et al. 
(2005).
The three upper snapshots of the figures from the experiments of Meunier et al. (2005) show 
that the material interiors of two vortices always remain physically separate open sets, even 
if they become filamented and wrapped along each other. These twfio sets lose their individual 
coherence while their union gains coherence. Therefore, neither the individual vortices nor 

5.7 Objective Eulerian Coherent Structures (OECSs)
227
the merged vortex will ever be detected as elliptic LCSs by any self-consistent LCS method 
over a time interval containing the snapshots (a)-(c). In contrast, the instantaneous vorticity 
contours in the lower snapshots (obtained from a 2D simulation) lose track of the individual 
vortices at some point and start displaying a merged vortex without any indication of its 
still unmixed internal structure. Since instantaneous vorticity contours are objective in two 
dimensions (see our discussion after formula (3.21)), both the Lagrangian and the Eulerian 
descriptions of vortex merger in Fig. 5.60 are self-consistent but reveal different aspects of 
the process.
A way to leverage the mathematical foundations and objectivity of LCS methods for 
coherence analysis in the Eulerian frame is to take their t1 7! t0 = t limit, as we noted in 
the introduction of this Chapter. This procedure yields objective Eulerian coherent structures 
(OECSs) that act as LCSs over infinitely short time intervals. An OECS can appear, persist 
for a while, then disappear or merge with other OECSs. While active, it still has an impact on 
material tracers or dye because material notions of attraction, repulsion or shear were used 
in its construction. In summary, OECSs are ultimately not material objects, but strong OECS 
can act as organizing centers of temporary coherent patters and able to relinquish this role 
to other OECSs any time, without any dependence on the time interval of definition for the 
finite-time dynamical system (5.1).
OECSs have their own limitations. The first is precisely their nonmaterial nature, which 
necessitates their continued re-computation throughout a time interval of interest. Second, as 
instantaneous limits of LCSs, the OECS are constructed from infinitesimally small trajectory 
displacements. This generally causes OECS methods to become less sensitive to inhomo­
geneities in the deformation field in comparison to LCS methods. As an extreme case, the 
polar rotation angle field discussed in §5.2.10 becomes identically zero in the t1 ! t0 limit 
and hence is unable to detect rotationally coherent structures in the instantaneous sense. Sim­
ilarly, while the instantaneous limits of the FTLE field are effective in identifying short-term 
attracting and repelling material lines, the clarity and detail of these instantaneous calcula­
tions is inferior to those obtained from the FTLE for t1 t0. For these reasons, OECSs do not 
generally represent improvements over LCSs. Rather, they offer complementary information 
about short-term transport barriers in the flow, while LCSs identify longer-term barriers 
more efficiently.
In the following, we give a survey of OECS methods and discuss examples in which 
they have shown themselves to be useful alternatives to LCS methods. We will also include 
pointers to our later discussions of objective Eulerian barriers in flow separation, diffusive 
transport and dynamically active transport.
5.7.1 Instantaneous Limit of the Flow Map
A key element of taking the short-term limit of LCSs is a short-time approximation to the 
deformation gradient rFtt + for j j 1. This approximation can be computed from the 
Taylor expansion of rFtt+ around = 0 as
rFt+T = I + @TrFt+T|T=0 r + O (r2) = I + rVv + O (r2); 
(5.96)
where we have used the fact that rFtt+ is the normalized fundamental matrix solution of the 
equation of variations (see §2.2.8). With the help of formula (5.96), Serra and Haller (2016) 

228 
Lagrangian and Objective Eulerian Coherent Structures
also obtain a Taylor series approximation for the short-term right Cauchy-Green strain tensor 
Ctt+ in the form
Ct+T = [rFt+"]T rFt'; = I + 2rS + O (T2); 
(5.97)
which now involves the rate-of-strain tensor S(x, t°. The details of the quadratic and cubic 
terms in the expansion (5.97) are not needed here but can be found in Nolan et al. (2020).
Note that for any n n matrix A with eigenvectors si and corresponding eigenvalues 
i, the matrix I + A has the same eigenvectors with corresponding eigenvalues i + 1. 
Therefore, using the solutions of the rate-of-strain eigenvalue problem (5.90), we can write 
the eigenvalues i and eigenvectors i of the symmetric tensor Ctt+ (see Eq. (2.95)) for small 
values as
Ai = 1 + 2rsi + O (r2); 
& = ei + O (r
(5.98)
5.7.2 Instantaneous FTLE
Using formula (5.98), we define the instantaneous FTLE field as the t1 ! t0+ limit of formula 
(5.7), which is equal to the maximal rate-of-strain eigenvalue:
FTLEt+(x° = lim —1 log [1 + 2s„(x t°r + O (r2)] = s„(x, t). 
(5.99)
t 
!0+ 2 jrj
Codimension-1 surfaces with instantaneously maximal normal repulsion in forward time are 
marked by ridges of FTLEt+(x° (see §5.2.1). The converse of this statement is not true, given 
that surfaces of maximal instantaneous tangential shear also generate ridges in the sn(x; t° 
field (see §5.2.2). Instantaneous limits of forward-time parabolic LCSs (jet cores) are marked 
by trenches FTLEt+(x° (see §5.2.9).
The t1 ! t0- limit of the backward-time FTLE can also be computed from formula (5.98) 
as the minimal rate-of-strain eigenvalue:
FTLEt-(x) = lim —J— log [1 + 2s 1(x; t°r + O (r2)] = -s 1(x; t°. 
(5.100)
T!0- 2 jr j
Codimension-1 surfaces with instantaneously maximal normal attraction in forward time are 
marked by ridges of FTLEt-(x° (see §5.2.1). Instantaneous limit of backward-time parabolic 
LCSs (jet cores) are marked by trenches of FTLEt+(x° (see §5.2.9).
For 2D incompressible flows, FTLEt+(x° = FTLEt-(x° but for compressible 2D flows and 
for general 3D flows, the two quantities differ from each other. This is illustrated in Fig. 
5.61 using the computations of Nolan et al. (2020) on a 2D horizontal slice of the Weather 
Research and Forecasting Model (WRF) of the National Center for Atmospheric Research 
(NCAR). Computed from 2D wind data at an altitude of 100, this horizontal wind field 
represents a compressible flow. Accordingly, FTLEt- and FTLEt+ differ noticeably both in 
magnitude and in parts of their spatial distribution. Note that in this 2D slice of the 3D 
atmospheric flow, attracting LCS mark upwelling along vertical 2D material surfaces, while 
repelling LCSs are generally the signatures of downdrafts or shear, as noted by Tang et al. 
(2011a,b).

5.7 Objective Eulerian Coherent Structures (OECSs)
229
Figure 5.61 Differences in the (Left) backward-time, and (Right) forward-time in­
stantaneous limits of the FTLE field on 2D compressible atmospheric wind field data. 
Adapted from Nolan et al. (2020).
5.7.3 Instantaneous Vorticity Deviation (IVD)
The instantaneous limit of the Lagrangian-averaged vorticity deviation (LAVD) defined in 
formula (5.27) is the instantaneous vorticity deviation (IVD), defined by Haller et al. (2016) 
as
IVD(X; t° = limLAVDt+T(x° = |!(xt° - !(t°|, 
(5.101)
with !(t° denoting the instantaneous spatial mean of the vorticity field !(X; t° over the flow 
domain of interest. Based on Definition 5.9,we can now define the instantaneous limits of 
LAVD-based elliptic LCSs, vortex boundaries and vortex centers in an objective manner 
using the IVD field.
Definition 5.17 At time t, IVD-based elliptic OECSs in the finite-time flow (5.1) are smooth 
cylindrical level surfaces of the instantaneous vorticity deviation IVD(x; t° surrounding a 
unique, codimension-2 height ridge of IVD(x; t°. IVD-based coherent Eulerian vortices are 
formed by nested families of such elliptic OECSs. IVD-based vortex centers in such Eulerian 
vortices are marked by the codimension-2 ridge of IVD(x; t° surrounded by the elliptic 
OECSs.
This definition offers an objective and mathematically well-established alternative to the 
nonobjective Eulerian vortex criteria surveyed in §3.7.1. We note that Jeong and Hussain 
(1995) point out the inadequacy of defining vortices as domains where |!(x; t°| exceeds a 
selected threshold. Level surfaces of |!(x; t°| exceeding a threshold may indeed have little 
to do with vortices; they may simply mark a high-shear region in a parallel channel flow. 
In contrast to that definition, IVD-based vortices are composed of cylindrical level sets 
surrounding a codimension-2 ridge of IVD(x; t°.
As an example, Fig. 5.62 shows IVD-based coherent Eulerian vortices extracted from the 
same gravity current experiment whose Lagrangian vortices we have already shown in Fig. 
5.27. The IVD-based extraction procedure here was identical to the LAVD-based extraction 
procedure outlined in §5.2.11.
A second example of the use of the IVD diagnostic is the work of Yang, K. et al. (2021), 
which we have already mentioned in the context of the LAVD in §5.2.11. These authors 
employ the IVD to assess the size of instantaneous vortices in the left ventricular (LV)

230
Lagrangian and Objective Eulerian Coherent Structures
10
5
3
z4
4
2
1
0
9
y
3
IVD
5
Figure 5.62 IVD-based coherent objective Eulerian vortices (blue) and vortex center 
lines (IVD ridges; red curves) identified below the turbulent/nonturbulent interface 
(TNTI; transparent yellow surface) from the gravity current experiment shown in Fig. 
5.27.The vortices with green boundaries cross the vertical plane at y = 9:75 nearly 
perpendicularly. Adapted from Neamtu-Halic et al. (2020).
blood flow, as well as the total vorticity carried by these vortices. Notable and consistent 
differences arise among the two subject groups in terms of the size and number of vortices in 
the contraction and ejection phases of the cardiac cycle, as illustrated on two representative 
subjects in Fig. 5.63. Yang, K. et al. 22021) aggue drat thcec differences may uttimately be 
used for diagnostic purposes.
5.7.4 Global Variational Theory of OECS in 2D Flows
Here, we briefly outline the global variational theory of OECS for 2D flows, obtained as the 
instantaneous limit of the global variational theory of LCSs we discussed in §5.4. For a more 
detailed exposition, we refer to Serra and Haller (2016).
Elliptic OECS
Over a short time interval »t; t + r], the local repulsion factor (5.48) of a material line y, 
parametrized as x(s° with s 2 »0; J], can be approximated by its Taylor expansion as
Pt+‘ (X; X'
hX0; X0i 
h 
hX0; S (X; t) X') 
, 2
=--------------------r = 1------- ------ 1----- r + O r
(x0; Ct+T (x° x0) 
hX'; X'i
(5.102)

5.7 Objective Eulerian Coherent Structures (OECSs)
231
Figure 5.63 IVD-based objective Eulerian vortices in the left ventricular (LV) blood 
flow of a healthy subject and a heart patient. (a)-(b) isovolumic contraction phase. 
(c)-(d) rapid ejection period. (e)-(f) slow ejection period. These three phases are 
indicated within the cardiac cycle and superimposed on ECG scans, as in Fig. 5.25. 
Adapted from Yang, K. et al. (2021).

232
Lagrangian and Objective Eulerian Coherent Structures
where we have used the Taylor expansion (5.97) of the right Cauchy-Green strain tensor at 
the initial time t0 = t: For a 2D incompressible flow, therefore, the local rate of stretching of 
the material line is obtained fromEq. (5.102)as
<q(X; X'; t° = - d p't^ (X; X') ^=0 = 
; ^ 
.°‘ X i : 
(5.103)
d 
hx0; x0i
The averaged material stretching rate along at time t is, therefore,
A, . 
1 . 
1 f hx'(■>).S (x(s°,l° X0(s°i
Q W = ? ]r q(x(s°x (s°.t°ds = s ------ <y(s°.x,(s°i------ds: 
(5.104)
In analogy with the global variational theory of elliptic LCSs in §5.4.1, we seek elliptic 
OECSs as closed stationary curves of the functional Q(y), i.e., as solutions of the calcu­
lus of variations problem dQ (y° = 0 under periodic boundary conditions. We note that 
q(x(s°. x'(s°. t), as defined in Eq. (5.103), has no explicit dependence on s, and q(x(s°. ■,°° 
is a positively homogenous function of order d = 0 by the definition (A.32). Therefore, 
as in §5.4.1, Noether’s theorem from Appendix A.8 again applies and guarantees that 
q(x(s°. x'(s°. t° = p = const: is a conserved quantity along solutions of this variational 
problem. Then, proceeding exactly as in §5.4.1, we obtain the instantaneous limit of Theo­
rem 5.12 as follows:
Theorem 5.18 Elliptic OECSs, defined as stationary curves of the average tangential stretch­
ing rate functional (5.104), are closed trajectories of the two one-parameter families of 
direction fields
X' (s ° = x±(x( s); t °;
x±(x; t ° =
s2 (X; t ° - P 
P - s 1 (X; t ° 
z ,
/ \ f , e1 (X; t ° ± 
, 1 ( ’ ° , e2 (X; t °;
s2 (X; t ° - s 1 (X; t ° 
s2 (X; t) ~ 51 (X; t)
defined on the time-dependent spatial domain
UU (t ° = fX 2 U : s 1 (X; t ° < P < s 2 (X; t °g :
(5.105)
(5.106)
Any such elliptic OECS has a uniform stretching rate, i.e., any of its subsets is stretched 
precisely by a rate P at time t. Outermost members of nested families of such closed curves 
serve as instantaneous positions of objective Eulerian vortex boundaries.
Therefore, once the rate-of-strain eigenvalue problem (5.90) has been solved, elliptic 
OECSs can be computed on a numerical grid from the direction field families (5.105) in 
the same way as elliptic LCSs are computed from the direction field tf± (x0° in Eq. (5.54). 
This time, however, the flow map is no longer involved and the full computation can be 
carried out using the methods of §§5.4.1 and 5.4.2 from a single snapshot of the velocity 
field. The null-geodesic-based computation using the approach of §5.4.2 is implemented in 
Notebook 5.15.

5.7 Objective Eulerian Coherent Structures (OECSs)
233
Notebook 5.15 (EllipticOECS) Computes elliptic OECSs as closed null-geodesics of 
the modified rate-of-strain tensor S(x; t° - ^I for a 2D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ AdvectiveBarriers/ EllipticOECS
The results of such a calculation are shown for illustration in Fig. 5.64 for a region of the 
AVISO data set in the Agulhas regions (see Appendix A.6). The figure also illustrates that 
under short-term material advection, elliptic OECSs keep their material coherence, given 
that they were derived as short-term limits of elliptic LCSs. In contrast, during the same 
time interval the strongest vortices in the region inferred from the (nonobjective) Okubo- 
Weiss principle (see §3.7.1) undergo substantial deformation under material advection 
in Fig. 5.64.
Serra and Haller (2017b) find that elliptic OECS arising as instantaneous limits of elliptic 
LCSs can be used to forecast the lifetime of those elliptic LCSs. They develop a non- 
dimensional persistence metric that equals the IVD (see §5.7.3) computed over the elliptic 
OECS, divided by the instantaneous material flux over the boundaries of the IVD. Serra and 
Haller (2017b) show that high values of this objective vortex-persistence metric correctly 
forecast long-lived material vortices based on their initial OECS footprint.
Shearless OECSs and Objective Saddle Points in 2D Flows
Over a short time interval »t; t + r], the local shear factor (5.62) of a material line y, 
parametrized as x(5° with 5 2 »0, J], can be approximated by its Taylor expansion as
t+_ 
d 
(x';JCr (xo° x'}
' (x;x° = r q , 
=
t+t
2 hx'; JS(x; t°x'i 
. 2
------r+O\------r + O r 
hx0; x0i
(5.107)
where we have again used the Taylor expansion (5.97) of the right Cauchy-Green strain 
tensor at the initial time t0 = t:
For a 2D incompressible flow, therefore, we obtain the local shearing rate of a material 
line fromEq. (5.107)as
p(x; x'; t° = dr &t+T (x; x'°lT=0
2 hx'; JS(x; t°x'i 
hx'; »JS (x; t° - S (x; t° J] x'i
--- —a------------- =------------------T~,—a------------- ; (5.108)
hx0; x0i 
hx0; x0i 
because the symmetric part of the tensor JS is »JS (x; t° - S (x; t° J] /2. Therefore, the averaged 
material shearing rate along y at time t is

234
Lagrangian and Objective Eulerian Coherent Structures
Figure 5.64 (Top) Material advection of two families of elliptic OECSs (objective 
coherent Eulerian vortices) over a period of six days in the Agulhas region of the 
Southern Ocean. (Bottom) Material advection of the three strongest Okubo-Weiss 
vortices in the region over the same 6-day period. Adapted from Serra and Haller 
(2016).
p, . 
1 
1 f <X'( S °;»JS (X;>)-S (X;t ° J] X'(S °i
/■(7° = -J, px.S °;x( S °;t° dS = S 
(xo( s °x0( s °i 
dS: 
(5.109>
As in §5.4.3 for shearless LCSs, we seek shearless OECSs as stationary curves of the 
functional P(y°, i.e., as solutions of the calculus of variations problem 6P (y° = 0 under 
free endpoint conditions. We note that p(x(s°, x0(s°, t°, as defined in Eq. (5.108), has no 
explicit dependence on S and is positively homogenous function of order d = 0. Therefore 
Noether’s theorem from Appendix A.8 again applies and ultimately yields the following 
Eulerian version of Theorem 5.13:
Theorem 5.19 Shearless OECSs, defined as stationary curves of the average tangential 
shearing rate functional P (y° with identically zero shearing rate, are continuous trajectories 
of the Eulerian direction field families
X0 = ei (X, t) ; 
i = 1; 2; 
(5.H0)
with ei (x, t° denoting the unit eigenvectors of the rate-of-strain tensor S (x, t°.
The Eulerian tensorlines defined by formula (5.110) can be computed as their Lagrangian 
counterparts discussed in §5.3.1. This computation is implemented in Notebook 5.16.

5.7 Objective Eulerian Coherent Structures (OECSs)
235
Notebook 5.16 (HyperbolicOECS) Computes hyperbolic OECSs from tensorlines (shrin­
klines or stretchlines) of the rate-of-strain tensor for a 2D unsteady velocity data set. 
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ AdvectiveBarriers/ HyperbolicOECS
In the present case, however, an alternative computation that does not require constant 
reorientation of the direction field is also feasible.15 Specifically, along a tensorline x(s), let 
pi(s° 2 »0; 2n° denote the angle enclosed by ei (x(s), t° and the positive horizontal axis of the 
x plane, i.e., let
x0(s ° = ei (x(s°; t° =
cos p( s ° 
sin p( s °
(5.111)
Differentiating the eigenvalue problem
S(x(s°; t°ei (x(s°; t° = si (x(s°° ei (x(s), t° 
(5.112)
with respect to s and using the notation
'?:= D-e = ( ’cOnP(J!° )•
(5.113)
we obtain
(rSei° ei + Se?00 = hr si; e,-i e,- + sie?0\
(5.114)
or, equivalently,
00 »S - siI] ek = »hrsi; ei-i I - rSei-] ei; 
i , k;
(5.115)
where we have used the fact that ei? = ek for i , k .
Left-multiplying Eq. (5.115) by ekT then gives the equation
00 (sk - si° = -eT (rSei-° ei-; i , k;
(5.116)
which, together with Eq. (5.111), then yields
x0 = ei (P°;
1
® 
, ,,------eT(P°(rS(x; t °e (P°° ei' (P°; i , k; 
(5.117)
si (x t ° - sk (x t °
with no summation implied over repeated indices.
Note that away from the tensorline singularities marked by s 1(x) = s2(x), system (5.117) 
is a well-defined, 3D system of autonomous differential equations for the variables (x; p° 
for any given time t. Therefore, in contrast to the 2D direction field (5.110), the numerical 
solution of the ODE (5.117) does not require constant monitoring and realignment of its
15 This alternative computation is motivated by the geodesic tensorline calculation discussed in §5.4.2. The 
algorithm is, in principle, also applicable to the Lagrangian tensorlines discussed in §5.3.1 but it involves the 
partial derivatives of the underlying tensor field. Those derivatives are inherently noisier for Lagrangian tensor 
fields near shearless LCSs than for the Eulerian tensor field S(x, t° near shearless OECSs.

236
Lagrangian and Objective Eulerian Coherent Structures
right-hand side at orientational discontinuities. At the same time, system (5.117) involves 
the three-tensor rS, whose accurate computation requires sufficiently well resolved velocity 
data. The computation is implemented in Notebook 5.17.
Notebook 5.17 (FastTensorlineComputation) Computes hyperbolic OECSs for a 2D 
unsteady velocity data set using the ODE (5.117).
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ AdvectiveBarriers/ FastTensorlineComputation
Serra and Haller (2016) follow Farazmand et al. (2014) to identify parabolic OECSs as 
continuous sets of trajectories of the direction field families that are as close to being 
instantaneously neutrally stable as possible. Repeating the arguments discussed in §5.4.3 for 
parabolic LCSs, they use the eigenvalues si(X; t° of S (x, t° and the Eulerian version
Nei (X; t ° = 
S i (X; t ° - 1) ; i ^ j 
^.H8)
of the neutrality measure (5.68) to establish the following parabolic OECS detection principle.
Definition 5.20 A parabolic OECS at time t is a shearless OECS composed of alternating 
chains of e1 - and e2-line segments that connect wedge and trisector singularities of the 
rate-of-strain tensor field S (x, t). Furthermore, each ei-line segment in the chain is a weak 
minimizer of the neutrality measure Nei (X; t°.16
16 As in §5.4.3, a tensorline segment y is a weak minimizer of its corresponding Nei (x, t° if both y and the nearest 
trench of Nei (x, t° lie in the same connected component over which Nei (x, t° is convex.
An example of a mesoscale parabolic OECS (i.e., Eulerian jet core) is shown in Fig. 5.65, 
extracted from the AVISO data set (see Appendix A.6).
This parabolic OECS is a chain formed by two e1 -line segments and one e2-line segment 
(red). The material evolution of this objectively identified Eulerian jet core is illustrated 
via the material advection of small, circular tracer blobs (with their centers initialized on 
the parabolic OECS). Note the developing boomerang shape, characteristic of a minimally 
shearing core of a material jet (see §5.4.3). Figure 5.65 shows that the parabolic OECS 
behaves nearly as a parabolic LCS for at least six days, even though its initial position was 
identified from a single snapshot of the surface velocity field at time t.
In line with the global variational theory of hyperbolic LCSs in §5.4.3, hyperbolic OECSs 
(i.e., instantaneously attracting or repelling curve) can be defined as stationary curves of the 
functional P (y° under fixed endpoint boundary conditions. Specifically, Serra and Haller 
(2016) arrive at the following identification principle for hyperbolic OECSs.
Definition 5.21 A repelling OECS at time t is an open e1-line segment that contains a local 
maximum of the dominant strain eigenvalue s2 (x, t° but contains no other local extremum 
point of s2(X; t). Similarly, an attracting OECS at time t is an open e2-line segment that 
contains a local minimum of the strain eigenvalue s 1 (x, t ° but contains no other local extremum 
point of s 1(X; t). Finally, a hyperbolic OECS is either a repelling or an attracting OECS.

5.7 Objective Eulerian Coherent Structures (OECSs)
237
Figure 5.65 (Top) Mesoscale parabolic OECS (Eulerian jet core) in the Agul­
has region of the Southern Ocean, identified at time t from the AVISO data 
set. (Bottom) Short-term material evolution of this OECS together with material 
blobs (green) initialized along it. Instantaneous streamlines are shown in the back­
ground. A video showing the time evolution of the parabolic OECS is available 
at https://aip.scitation.org/doi/figure/10.1063/1.4951720. Adapted 
from Serra and Haller (2016).
Hyperbolic OECSs, therefore, have cores: the points where either s2(x t° has a local 
maximum or s 1(X; t° has a local minimum. In a 2D incompressible flow, the maxima of 
s2(X; t° coincide with the minima of s 1 (X; t°, enabling the definition of objective saddle points 
marked by these locations. As frame-independent analogues of hyperbolic instantaneous 
stagnation points (see §2.1.2), objective saddle points are the intrinsic, objective centers 
of short-term hyperbolic behavior. They generally have no signature in the instantaneous 
streamline picture and yet they create locally maximal short-term material stretching. Figure 
5.66 illustrates that there can be a number of objective saddle points (red dots) in flow regions 
without nearby hyperbolic stagnation points (magenta triangles) in an unsteady flow.
Material blobs centered at such objective saddles (green) show substantially more short­
term stretching than material blobs centered on hyperbolic stagnation points (yellow). The 
yellow blobs that do end up stretching invariably do so because an objective saddle (circled 
in blue) is present nearby.
Transient Attracting Profiles (TRAPs)
The ability of objective saddle points and their associated attracting OECS to frame short­
term material evolution effectively makes them promising tools for designing search and

238
Lagrangion and Objectiv t Eulerian Coherent Structures
Material evolution near
Material evolution near
t
objective saddle points
t
hyperbolic stagnation points
t + 1.5 days
/.rrnf
Figure 5.66 Short-term material evolution near objective saddle points and hyper­
bolic stagnation points in the Agulhas region of the Southern Ocean, identified 
at time t from the AVISO data set. See the text for explanation. A video show­
ing the time evolution of material near the objective saddle points is available 
at https://aip.scitation.org/doi/figure/10.1063/1.4951720. Adapted 
from Serra and Haller (2016).
rescue operations at sea. In that context, Serra et al. (2020a) calls an attracting OECS 
segment containing an objective saddle point a transient attracting profile (TRAP). The 
TRAPs can be extracted and continuously updated from remote-sensed or modeled velocity 
fields over the domain where the search is to be performed. Composed of attracting OECSs, 
the strongest TRAPs provide the locations of the strongest instantaneous fronts to which fluid 
blobs converge and along which those converged blobs then spread out.
Small floating objects in the sea will effectively behave as neutrally buoyant inertial par­
ticles in the 2D surface-velocity field. As a consequence, their motion will synchronize with 
fluid motion during periods of no abrupt temporal variation in the flow (see our discussion 
on neutrally buoyant inertial particle dynamics in §§7.2 and 7.4). Therefore, the currently 
active, strongest TRAP in any given region are the strongest current attractors for small 
floating objects, such as debris or people in the water. Search and rescue (SAR) operations 
should, therefore, prioritize the exploration of the strongest TRAPs extracted from current 
velocity field information, as illustrated in Fig. 5.67.

5.7 Objective Eulerian Coherent Structures (OECSs)
239
Figure 5.67 The strongest transient attracting profiles (or TRAPs) in the ocean 
surface velocity field are the most likely locations to target in search and rescue 
operations. Adapted from Serra et al. (2020b).
Serra et al. (2020a) demonstrate the feasibility of using TRAPs in SAR operations in 
numerical simulations and two field experiments near Martha’s Vineyard (Massachusetts, 
US). In their 2014 numerical experiment, the surface velocity field was inferred from high- 
frequency radar, whereas the 2017 and 2018 field experiments used a data-assimilating ocean 
model, the MIT-MSEAS (see Haley and Lermusiaux, 2010), to obtain the surface velocity 
field. In the 2018 experiment, manikins and drifters were placed near the predicted TRAP 
locations to verify the convergence of these objects to the moving TRAPs (whose locations 
were also updated) within the time window of SAR operations (six hours). The strongest 
evolving TRAPs were determined as the deepest trenches of the s 1 (x t° field in the region of 
interest. As seen in Fig. 5.68,drifters and manikins converged to the strongest nearby TRAP, 
irrespective of differences in their release locations.
c
a
41.34
41.32
b
413
4128
41.26
41.24
41.22
Longitude (°)
41.29
41.28
41.27
41.26
41.25
41.24
41.23
41.22
41.3
-0
-20
-40
-60
-80
-100
-70.54 
-70.52 
-70.5 
-70.48 
-70.46 
-70.44 
-70.42
Longitude (°)
Figure 5.68 Drifters and manikins both converge to nearby strongest TRAPs iden­
tified in a 2018 SAR experiment near Martha’s Vineyard. Adapted from Serra et al. 
(2020b)
41.3
41.29
41.28
41.27
41.26
41.25
41.24
41.23
10
-0
-10
-20
-30
-40
-50
-60
-70
-80
-70.5 
-70.48 
-70.46 
-70.44
Longitude (°)
Differences in those release locations ended up manifesting themselves in differences 
of the converged positions along the TRAPs. These experiments, therefore, provide strong 
support for the feasibility of using TRAPs as tools in designing SAR missions.

240
Lagrangian and Objective Eulerian Coherent Structures
5.8 Summary and Outlook
In this chapter, we have discussed transport barriers in generic fluid flows without assuming 
recurrent time dependence for their velocity fields. In the absence of temporal recurrence, we 
can no longer rely on asymptotically unique notions of advective transport barriers. Rather, 
we must define and locate barriers from finite-time, temporally aperiodic velocity data for 
which Poincare maps are no longer available and hence the barrier definitions of Chapter 4 
are no longer applicable. Accordingly, the idealized transport barriers of chaotic advection, 
such as stable and unstable manifolds of fixed points and periodic orbits, as well as KAM 
tori, no longer exist.
As an alternative, we have discussed the notion of Lagrangian coherent structures (LCSs), 
which are material surfaces with locally the strongest impact on the flow. Depending on the 
type of this impact, we have distinguished hyperbolic (attracting or repelling) LCSs and shear 
(elliptic or parabolic) LCSs. At the simplest level, we have seen that LCSs can be identified 
by inspection of the topological features of objective diagnostic fields (such as the FTLE, 
FSLE, PRA and LAVD) or quasi-objective diagnostics for sparse data (such as the TSE and 
TRA).
At a more sophisticated level, LCSs can be identified in a strict mathematical sense as 
local extremizers of attraction, repulsion or shear among nearby material surfaces. This 
approach has led us to the local and global variational theories of LCSs, which enable 
the extraction of LCSs automatically as parametrized curves or surfaces. In 2D, LCSs can 
be computed either as tensorlines or null-geodesics of appropriate Lorentzian metrics using 
these variational theories. In 3D, the 2D definition of LCSs as extremizers of some coherence 
measure requires a relaxation to avoid over-constrainment (see Definition 5.14). A notable 
unified result for 3D flows based on this relaxed LCS definition is that initial positions of all 
3D LCSs are structurally stable invariant manifolds of the intermediate eigenvector field of 
the right Cauchy-Green strain tensor.
We have also discussed objective Eulerian coherent structures (OECS), obtained as the 
A ! 0 limits of LCSs defined over the time interval»t; t+A]. OECSs inherit the objectivity of 
LCSs and closely approximate LCSs over short time intervals. In contrast to LCSs, however, 
the evolution of OECSs is not material and hence can describe the birth, disappearance, 
merger and breakup of transport barriers in an observer-indifferent fashion. As a further 
advantage, OECSs can be computed from single velocity field snapshots, providing an 
objective and mathematically well-grounded alternative to the classic vortex identification 
methods surveyed in §3.7.1.These features of OECSs have led to applications in search and 
rescue operations and medical imaging, which we have briefly reviewed.
The LCS and OECS diagnostics we have discussed here will resurface in all later chapters 
in different contexts. Indeed, aerodynamic separation surfaces, barriers to inertial particle 
transport, diffusion barriers and active barriers all turn out to be detectable via analogues of 
the diagnostic or variational tools we have developed in this chapter.
A collection of common subfunctions used in the various 2D numerical algorithms dis­
cussed in this chapter can be found in Notebook 5.18.

5.8 Summary and Outlook
241
Notebook 5.18 (2Dsubfunctions) Collection of subfunctions (involving the flow map and 
the deformation gradient) used by the LCS and OECS algorithms of this chapter for 2D 
velocity data sets.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
subfunctions
A similar collection of common subfunctions used by 3D LCS and OECS algorithms dis­
cussed in this chapter can be found inNotebook 5.19.
—
Notebook 5.19 (3Dsubfunctions) Collection of subfunctions (involving the flow map and I 
the deformation gradient) used by the LCS and OECS algorithms of this chapter for 3D 
velocity data sets.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/3D/ 
subfunctions

6
Flow Separation and Attachment Surfaces as Transport 
Barriers
Flow separation is the ejection of fluid particles from a small neighborhood of a solid 
boundary. Such a breakaway from the boundary is often due to the detachment of a boundary 
layer, but it also occurs in highly viscous flows where the boundary layer description is 
inapplicable. Accordingly, we will treat separation here as a purely kinematic phenomenon: 
the formation of a material spike from a flow boundary, such as those behind a cylinder 
in cross flow shown in Fig. 6.1. A related phenomenon is flow attachment, which can be 
kinematically characterized as flow separation in backward time.
Figure 6.1 Flow separation behind a circular cylinder at Re = 2;000, visualized by 
air bubbles in water. Reproduced from Van Dyke (1982).
While the boundary layer literature often attributes material spike formation to the appear­
ance ofa singularity in the boundary layer equations (Van Dommelen, 1981;Van Dommelen 
and Shen, 1982), the phenomenon is ubiquitous in physically observed fluid flows whose ve­
locity fields exhibit no singularities. Rather, material spikes in such flows form along unstable 
manifolds, or, more generally, along attracting LCSs, as we have already seen throughout 
Chapters 4 and 5. Indeed, attracting LCSs are material surfaces that collect nearby fluid 
elements into a thin strip, which is bound to stretch simultaneously due to the conservation 
of volume (or at least mass) in the flow. In this process, the attracting LCS, or separation 
profile, acts as a barrier to advective transport between its two sides. This barrier property 
is clearly visible in Fig. 6.1, with the separation profile blocking material transport between 
the mean flow and the recirculation zone behind the cylinder.
We consider LCSs acting as separation or attachment profiles here separately because their 
contact points with the boundary and their local shapes near the boundary can be located 
from a purely Eulerian analysis along the boundary. Since the attachment points of material 
242

6.1 Flow Separation in Steady and Recurrent Flows
243
separation profiles cannot move under no-slip boundary conditions, such profiles necessarily 
create fixed separation, even though their off-boundary parts can deform substantially under 
material advection. These fixed separation and attachment profiles are necessarily nonhyper- 
bolic LCSs because they cannot exert attraction or repulsion along a boundary filled with 
fixed points.
In contrast, material spikes emanating from off-boundary points generally result in moving 
separation in unsteady flows. The attracting material surfaces responsible for such off- 
boundary fluid ejection mechanisms fall in the category of the hyperbolic LCSs discussed in 
Chapter 5.Beyond our upcoming summary of specific results on moving unsteady separation 
along invariant manifolds, we also refer the reader to Surana and Haller (2008), Miron and 
Vetel (2015) and Serra et al. (2018).
6.1 Flow Separation in Steady and Recurrent Flows
6.1.1 Separation in 2D Steady Flows
Close to the fluid-solid interface of a viscous flow, adhesive forces between fluid particles 
and solid particles dominate cohesive forces among fluid particles. This imbalance in the 
forces diminishes the fluid velocity to near-zero values along a flow boundary, providing a 
physical justification for the broadly used no-slip boundary condition along solid walls. Since 
most flow separation problems of technological interest involve boundary layer separation 
(which is a viscous phenomenon), the literature on separation profiles focuses predominantly 
on no-slip boundaries.
At the same time, resolving the boundary layer in computations of large-scale geophys­
ical flows is often impractical or unnecessary. In such flows, the boundary conditions are 
selected to be of free-slip (or no-penetration) type. Examples of such separation problems in 
geophysics include the Agulhas leakage into the Atlantic ocean and the formation of wakes 
behind islands, such as those shown in Fig. 6.2. In the geophysical context, the large-scale 
role of separation profiles as transport barriers is even more prominent than in aerodynamic 
separation problems involving no-slip boundaries. Another application of free-slip boundary 
conditions includes the computational study of inviscid flows near walls.
Figure 6.2 Separation profiles as transport barriers, bounding the wakes behind the 
Canary Islands in the Atlantic Ocean. Image: NASA Earth Observatory.

244 
Flow Separation and Attachment Surfaces as Transport Barriers
For these reasons, we will start our discussion here with flow separation and attachment 
along free-slip boundaries. The analysis of free-slip separation in steady flows will also turn 
out to have direct relevance for no-slip separation after a blow-up construct near the boundary.
Steady Separation from Free-Slip Boundaries
In the simplest case of 2D steady flows with free-slip boundaries, unstable manifolds creating 
fluid breakaway from the boundary emanate from saddle-type stagnation points on the wall. 
Similarly, stable manifolds of wall-based saddle points are responsible for flow attachment, 
as shown in Fig. 6.3.
separation profile: Wu(p)
Figure 6.3 Separation and attachment points along free-slip boundaries of2D steady 
flows are saddle-type stagnation points. Separation profiles are off-wall unstable 
manifolds of such stagnation points, whereas attachment profiles are off-wall stable 
manifolds.
attachment profile: Ws(p)
Any such stagnation point p can be located as a zero of the steady velocity field v(x° = 
(u(x; y°; v(x; y°° satisfying
v(p° = 0; det rv(p° < 0
by formula (2.10). Specifically, in coordinates aligned with the free-slip boundary at y = 0, as 
shown in Fig. 6.3, a structurally stable (see §2.2.7) separation point p = (xp; 0° ona free-slip 
wall satisfies1
1 One may, in principle, also have a degenerate saddle point q along a free-slip boundary with an off-boundary
unstable manifold Wu(q°. An example is the q = (0; 0° stagnation point of the incompressible velocity field
v(x; y° = (-x3; 3yx2); for which the y-axis is an unstable manifold. This manifold acts as a separation profile 
even though ux (0; 0° = 0 holds and hence the second condition in Eq. (6.1) is not satisfied. We exclude such 
cases from consideration because degenerate (or nonhyperbolic) saddle-type stagnation points are structurally 
unstable and hence are unobservable in practice (see §2.1.2).
u(xp; 0° = 0; ux(xp;0° < 0: 
(6.1)
Similarly, a structurally stable attachment point satisfies u(xp; 0° = 0 and ux (xp ; 0° > 0. Note 
that the separation point criteria (6.1) are not objective, only quasi-objective: they depend on 
the assumption that the velocity field v is steady in the given reference frame. Ifvis unsteady, 
instantaneous saddle-type stagnation points on the boundary are no longer related to material 
flow separation. Rather, such stagnation points simply mark locations where instantaneous 
streamlines emanate from the wall (see §6.1.2).

6.1 Flow Separation in Steady and Recurrent Flows
245
Steady Separation from No-Slip Boundaries
Unlike in the free-slip case, separation points on no-slip boundaries are no longer a priori 
distinguished, given that all boundary points are fixed points of the velocity field in this case. 
This degeneracy of the flow on the boundary, however, can be removed by a classic blow-up 
technique from singular perturbation theory (see e.g., Jones,1995and Verhulst, 2005).
To set the stage for this technique, we first introduce coordinates x = (x0 y° in which the 
no-slip wall aligns with the x-axis, and hence the continuously differentiable fluid velocity 
field v (x) takes the form
X = v(x° = y [@y v (x; 0° + O(y°] 0 
(6.2)
given that v(x0 0) = 0. We assume that the flow conserves mass and hence satisfies the steady 
continuity equation
r (v) = r v + r v = 0; 
(6.3)
with the fluid density (x) , 0. This implies that
rv(x;0) = 0; 
(6.4)
i.e., the flow is always locally incompressible along a no-slip boundary. As a consequence, 
the constant zero velocity along the wall coupled with the local incompressibility condition 
(6.4) gives
ux(x; 0) = vy(x;0) = 0
(6.5)
for any mass-conserving flow. Consequently, a Taylor expansion of v(x; y) at y = 0 allows us 
to rewrite the velocity field (6.2) near the boundary as
x=vx =y 
uy(x;0) + O(y)
y \ y [2vyy(x; 0) + O(y°]
(6.6)
for any such flow.
To proceed with the blow-up technique, we rescale the time along the trajectories of the 
autonomous ODE (6.2) by letting
t =
; x0; y0 ) ds;
(6.7)
which enables us to rewrite Eq. (6.6),at all points away from the y = 0 axis, as
x, = / 
uy(x; 0° + O(y° 
\
y [ 1 vyy(x; 0° + O(y°]
(6.8)
with prime denoting differentiation of the rescaled trajectories x(t° with respect to t. Note 
that t evolves differently along each orbit x(t; x0° of the original vector field, but its evolution 
varies smoothly across trajectories away from the y = 0 axis. Also note that the y = 0 axis 
remains an invariant boundary for the blown-up velocity field (6.8).2
All orbits of the ODE (6.8) coincide with those of the ODE (6.2) away from the y = 0 
boundary where the rescaling (6.7) becomes singular. The rescaled ODE (6.8) is nevertheless
2 This conclusion would not hold for velocity fields that do not conserve mass and hence do not satisfy the local 
incompressibility condition(6.4)at the wall.

246 
Flow Separation and Attachment Surfaces as Transport Barriers
free from any singularity and satisfies free-slip boundary conditions. The flow on the free-slip 
boundary,
X 0 = U y (X; 0°; 
(6.9)
is, however, no longer physical: it is a virtual (blown-up) boundary flow generated by the 
wall shear field uy (X; 0°. This fictitious flow nevertheless enables us to locate base points 
of distinguished streamlines connecting to the wall at stagnation points. The off-boundary 
points of such streamlines will then coincide with streamlines of the original velocity field 
(6.2). This is because the streamlines of the vector fields (6.2) and (6.8) coincide at any 
location with y , 0.
Following this strategy, we apply the free-slip separation criterion (6.1) to the blown-up 
boundary flow (6.9) to conclude that a separation profile in system (6.8) emanates from 
boundary points satisfying
uy(Xp; 0° = 0; 
uxy(Xp; 0° < 0: 
(6.10)
This is just the seminal criterion of Prandtl (1904) for separation points on no-slip boundaries. 
In summary, robust separation from a no-slip wall in steady, mass-preserving, 2D flows takes 
place at points of vanishing wall shear and negative wall-shear gradient. Similarly, robust 
flow attachment in such flows takes place at points of vanishing wall shear and positive 
wall-shear gradient.
Polynomial approximations for the separation profile near the wall can be obtained by 
differentiating its Taylor expansion
X = Xp + f0y + f1y2 + 
(6.11)
with respect to time along trajectories and substituting the expressions for X and y from the 
ODE (6.6). At leading order, this gives 
f0
uyy(xp; 0° 
3uxy(xp; 0°
(6.12)
the classic formula for the separation slope relative to the wall-normal direction, obtained first 
by Lighthill (1963). Higher-order approximations for the separation profile can be obtained 
from the expansion (6.11) in a similar fashion (see Haller, 2004).
Just as in the free-slip case, the no-slip separation point criteria (6.10) are only quasi­
objective: they only hold in frames in which the flow is steady. In unsteady flows, the 
Prandtl points defined by conditions (6.10) simply mark the instantaneous locations at which 
instantaneous streamlines emanate from the wall. Experimentally observed flow separation 
in unsteady flows is generally unrelated to these points (see §6.1.2). Also note that the 
advective transport barriers obtained from these arguments are nonhyperbolic. Indeed, by 
the formulas (6.8) and (6.10), the gradient rv(Xp; 0° vanishes identically at separation points. 
This prevents exponential attraction of nearby fluid particles toward the separation profile 
along the boundary, even though the attraction to Wu(p° becomes noticeable away from 
the boundary. Still, the separation profile is structurally stable within the class of flows that 
satisfy no-slip boundary conditions along y = 0 because all such flows can be rescaled to the 
form (6.8) in which the separation point becomes hyperbolic.

6.1 Flow Separation in Steady and Recurrent Flows 
247
Due to the lack of exponential attraction to separation profiles near the boundary, material 
spikes generally start forming via the gradual upwelling of wall-parallel material surfaces 
away from separation locations. These upwellings will only align asymptotically with sep­
aration profiles once they have left the immediate vicinity of the wall. This phenomenon is 
illustrated in Fig. 6.4, which shows the development of a material spike away from a separa­
tion profile, along with its subsequent convergence to the separation profile, in a steady flow 
generated by a rotating cylinder (Klonowska-Prosnak and Prosnak, 2001; Miron and Vetel, 
2015).
t = 0.8
0.20
0.15
y 0.10
0.05
0 s 0.5 
1.0 
1.5 p 2.0
spiking point x separation point
x
Figure 6.4 A spiking point s and a separation point p (zero wall-shear point) in a 
2D steady flow induced by a steadily rotating cylinder near a horizontal wall. The 
sequence of plots shows how wall-parallel material surfaces initialized at time t = 0 
develop first an upwelling then a material spike by time t = 1:8. Image adapted from 
Serra et al. (2018).
Serra et al. (2018) seek the material backbone curve of such an evolving material spike as 
a set of points of maximal curvature change along initially boundary-parallel material lines. 
If the endpoint of such a material backbone connects with the boundary, then that endpoint 
will remain fixed in time due to the no-slip boundary conditions. Serra et al. (2018) show 
that such a Lagrangian spiking point s = (xs; 0° in 2D steady flows must satisfy the relations
vxxxyy(xs; 0° = 0; vxxyy(xs; 0° < 0; vxxjtxyy(xs; 0° > 0 
(6.13)
in order to be robustly observable (structurally stable). These higher order derivatives are 
generally cumbersome to compute, but Eq. (6.13) is nevertheless conceptually important. 
Indeed, it identifies an on-wall signature of developing separation and hence provides a target 
for the early detection and control of separation.
Serra et al. (2018) propose and demonstrate a more robust detection of the spiking point 
by finding the intersection of the wall with the backbone of separation. They locate this 
backbone, the red curve shown in Fig. 6.4, as a ridge (see Appendix A.2) in the scalar field 
that measures the curvature change along initially wall-parallel material lines. We will discuss 
this construct in more detail in our discussion of spike formation in temporally aperiodic 
flows with a steady mean in §6.2.1.

248 
Flow Separation and Attachment Surfaces as Transport Barriers
6.1.2 Separation in 2D Time-Periodic Flows
In 2D time-periodic flows, fluid breakaway from the boundary again takes place along 
unstable manifolds. These unstable manifolds may emanate from a boundary point or from 
a nearby off-boundary location. The latter type of a separation profile falls in the class of 
hyperbolic transport barriers, which we discussed in §4.1.1. Here, we will mainly focus on 
wall-based separation induced by unstable manifolds emanating from the wall. Analogous 
ideas apply to flow attachment (i.e., the asymptotic convergence of fluid elements to a specific 
boundary location), which is due to the presence of wall-based stable manifolds.
Time-Periodic Separation from Free-Slip Boundaries
As noted in §6.1.1, instantaneous stagnation points on a free-slip boundary of an unsteady 
flow are generally unrelated to the breakaway of fluid from the boundary unless the flow 
is slowly varying. Instead, boundary-based saddle-type fixed points of the Poincare map 
associated with the flow will act as separation points. An off-wall unstable manifold of such a 
fixed point, as an invariant curve for the Poincare map, then qualifies for a hyperbolic barrier 
to advective transport by our definition in §4.1.1.
For a T-periodic, 2D velocity field v(x; t) = (u(x; y; t), v(x; y; t)) with a free-slip boundary 
along the y = 0 axis, the flow restricted to the boundary is given by the scalar ODE
X = U ( X ; 0; t );
(6.14)
whose solution satisfies
x(t; 10; xo) = xo + / u(x(^; t0;x0); 0; s) ds. 
(6.15)
t0
Therefore, the Poincare map Pt0 (see §2.2.12) of the flow will have a fixed point at the 
boundary point (xp (10°, 0) if the integral equation has a T-periodic solution starting from 
xp(10). This is the case precisely when x(10 + T; 10; xp) = xp, and hence, by Eq. (6.15),
t0+T
I u (x (s; t0; xp(10)); 0; s) ds = 0: 
(6.16)
t0
The equation of variations (see §2.2.8) associated with the ODE (6.14) is the linear scalar 
ODE % = u x (x (t; 10; x 0); 0; t )£, whose solution is £ (t; 10;£0) = £0 e$t0 ux (x(s’t0; x0);0;s) ds .Therefore, 
the wall-based fixed point (xp (10); 0) of Pt0 will exponentially attract other fluid particles along 
the wall if
t0+T
ux(x(s; t0; xp(t0)); 0; s) ds < 0: 
(6.17)
t0
For an incompressible flow, such an exponential attraction will guarantee that (xp (10); 0) 
is a saddle-type fixed point of Pt0 with an unstable manifold pointing off the wall (see 
Fig. 4.3). Therefore, for planar incompressible flows, the relations (6.16)-(6.17) provide 
a set of sufficient and necessary conditions for the existence of a robust separation point 
xp (t0); 0 on a free-slip boundary along y = 0.
The time-periodic free-slip separation conditions (6.16)-(6.17) require the numerical 
solution of the scalar ODE (6.14) over a grid of initial conditions so that the solution xp(t0) 

6.1 Flow Separation in Steady and Recurrent Flows
249
to the relation (6.16) can be located. As an alternative, one may also use the numerical 
approaches developed in Chapter 5 for hyperbolic barriers in general unsteady flows, which 
also uncover the separation profile as an attracting Lagrangian coherent structure. We have 
nevertheless included the criteria (6.16)-(6.17) to stress that one cannot simply use the 
time-averaged versions of the steady free-slip separation criteria (6.1), with xp treated as 
an independent variable, to locate separation points in time-periodic flows. In other words, 
time-averaged streamline plots will generally give an incorrect indication for the separation 
point and separation profile. A dedicated treatment of free-slip separation in 2D unsteady 
flows is given by Lekien and Haller (2008).
Time-Periodic Separation from No-Slip Boundaries
While instantaneous zeros of the wall shear are often also considered to be separation points 
in unsteady flows, they do not mark experimentally observed fluid breakaway in such flows, 
as noted by Sears and Telionis (1975). Indeed, Fig. 6.5 illustrates how unrelated the location 
of zero wall shear (the point where a streamline emanates from the wall) is to the location of 
material breakaway in a 2D time-periodic separation bubble model of Ghosh et al. (1998). 
Red and green denote fluid particles initialized on different sides of the unsteady separation 
profile (time-periodic unstable manifold) emanating from the point (x; y° = (-1; 0°. The 
periodically moving zero wall-shear point is even out of range at the times shown, except at 
t = 18:65.
t=0
1.0
0.8
0.6
0.4
0.2
0
1.0
0.8
0.6
0.4
0.2
0
t =8.2
-1.6 -1.4 -1.2 -1.0 -0.8 -0.6 -0.4 -0.2
1.0
0.8
0.6
0.4
0.2
0
-1.6 -1.4 -1.2-1.0 -0.8 -0.6 -0.4 -0.2
1.0
0.8
0.6
0.4
0.2
0 
.
-1.6 -1.4 -1.2 -1.0 -0.8 -0.6 -0.4 -0.2
t=25
-1.6 -1.4 -1.2 -1.0 -0.8 -0.6 -0.4 -0.2
Figure 6.5 Flow separation visualized by the formation of a material spike from the 
wall in the time-periodic separation model of Ghosh et al. (1998). Red and green 
mark fluid particles launched from opposite sides of the blue material line forming 
the separation profile. Image adapted from Haller (2004).
All points of a no-slip boundary in a time-periodic flow are fixed points of the associated 
Poincare map. None of these fixed points is a priori distinguished by linear stability analysis: 
all of them are of the parabolic type shown in Fig. 4.3. Shariff et al. (1991) argue that for 

250
Flow Separation and Attachment Surfaces as Transport Barriers
incompressible flows, a necessary condition for separation is that the time-averaged wall 
shear must vanish at the separation point. Yuster and Hackborn (1997) point out, however, 
that this necessary condition is based on an assumption on the Poincare map that has remained 
unverified ever since. Yuster and Hackborn (1997) are able to remove this assumption but 
only for incompressible flows that are small perturbations of steady flows.
Haller (2004) and Kilic et al. (2005) reconsider the no-slip separation problem by deriving 
sufficient and necessary conditions for the existence and shape of wall-based nonhyperbolic 
unstable manifolds in mass-preserving 2D flows. We will review these results for general 
unsteady flows in §6.2. For time-periodic flows, the necessary and sufficient condition for 
separation can directly be deduced from the results of Kilic et al. (2005) covering velocity 
fields with a well-defined temporal mean component. Such velocity fields become slowly 
varying in appropriate local coordinates near the wall as long as the flow is mass-preserving. 
Exploiting this slow variation, Kilic et al. (2005) use the mathematical theory of averaging 
(Guckenheimer and Holmes, 1983) to relate separation profiles of the temporally averaged 
(and hence steady) velocity field to those in the full unsteady flow near the boundary.
By these results, in a T-periodic velocity field v(x; t° = (u(x; y, t), v(x, y, t)) with a no-slip 
boundary along the y = 0 axis, separation must occur at boundary points satisfying
T e‘ vy (xp ,0,s) ds u y (xp; 0; t ° dt = 0;
0
T t
e0 vy (xp As) ds
0
Uxy (Xp; 0; t ° + Uy
T t
I e0 vy (xP As) ds Vyy (xp; 0; t° dt > 0; 
0
.0; t ° 
Vxy (Xp; 0; S) dS dt < 0:
0
(6.18)
For incompressible flows, uxy = -vyy holds everywhere and ux(x, 0; t° = vy(x; 0; t° = 0 holds 
along the boundary. Substituting these relationships into the general compressible separation 
formulas (6.18) gives the simple incompressible separation criterion
u u y (xp; 0; t ° dt = 0; 
H xy (xp; 0; t ) dt < 0; 
(6.19)
which reproduces the classic Prandtl separation criterion (6.10) when v is steady. Therefore, 
one can replace the steady separation criterion with its time-averaged version for time- 
periodic incompressible flows with no-slip boundaries. By Eq. (6.18), the same conclusion 
does not hold for compressible flows.
Haller (2004) and Kilic et al. (2005) also derive polynomial approximations for the time­
dependent unstable manifold M(t° attached to the separation point (see Fig. 6.6). Specifically, 
for a time-periodic incompressible flow, the leading order approximation to M(t° is given 
by a straight, time-periodic line whose slope is given by
'ft-T [u yy ( xp; 0;T° ~ 3 u xy (xp; 0; t ° J'y u y ( xp; 0; s ° ds] d T
tan a( t ° =---------------------------- -t-------------------------------------------; 
(6.20)
3 ft-T uxy (xp; 0;T° dT
with a(t° denoting the separation angle shown in Fig. 6.6. Consequently, the angle enclosed 
by the unstable manifold M(10° of the Poincare map P-0 and the wall normal is a(10°. This 
represents a generalization of Lighthill’s formula (6.12) for the incompressible case, agreeing 
with the expression obtained by Shariff et al. (1991).
Weldon et al. (2008) provide an experimental verification of the separation criterion (6.19) 
and the separation angle formula (6.20). Shown in the upper plot of Fig. 6.7, their experiments

6.1 Flow Separation in Steady and Recurrent Flows
251
a(t)
M(t)
7777777777777777
Figure 6.6 The time-periodic unstable manifold M(t° of a wall-based separation 
point in a 2D time-periodic flow over a no-slip wall. The separation angle is the 
instantaneous angle (t° that the material line M(t° encloses with the wall normal.
involve the dye-based visualization of flow separation from a vertical wall. The separation is 
induced by a steadily rotating cylinder whose translational motion is controllable to exhibit 
any required time dependence. To generate a periodic flow field, Weldon et al. (2008) move 
the cylinder (which rotates at the rate 20:89 rad/s) periodically with period T = 6 s: In 
the absence of sufficiently accurate wall-shear and wall-pressure measurements, Weldon 
et al. (2008) use a direct numerical simulation of this experimental setting to compute the 
necessary derivatives in formulas (6.19) and (6.20). The results for the computed separation 
location and separation angle (dashed line) are superimposed on the experimentally observed 
dye spike at three time instances in the lower plot of Fig. 6.7.These show close agreement 
between the theory and the experimental observations.
Finally, we note that the Lagrangian spiking points discussed in §6.1.1 for steady flows also 
continue to exist in unsteady flows. Specifically, Serra et al. (2018) prove and demonstrate 
with simulations that the time-averaged version of the steady spiking-point criterion (6.13), 
given by
(6.21)
t0 +T 
t0 +T
vxxxyy (xs (t0°; 0;t° dt = 0; 
vxxyy (xs (t0°; 0;t° dt < 0;
t0 
t0
t0+T 
vxxxxyy(xs(t0°; 0; t° dt > 0; 
t0
accurately locates the periodically varying spiking point xs(t° for material lines initialized 
parallel to the non-slip wall at time t0 .
Both the separation criteria (6.19)-(6.20) and the spiking point criterion (6.21) extend to 
quasiperiodic flows and even to temporally aperiodic flows with a well-defined asymptotic 
mean. We will review these extensions in §6.2 and refer the reader to Haller (2004) and 
Kilic et al. (2005) for more detail. An advantage of the latter, more general criteria is that 
they do not assume periodicity or quasiperiodicity for the underlying velocity field. As a 
consequence, they can be applied in any observer frame in which the velocity field has an 
asymptotic temporal mean.
6.1.3 Separation in 3D Steady Flows
Simulations and experiments show that 3D steady flows tend to separate along 2D surfaces 
(see Simpson, 1996, Deleyy, 2001 and Surana et al., 2006 for reviews). All such experi­
mentally reproducible separation surfaces are attracting material surfaces, given that they

252
Flow Separation and Attachment Surfaces as Transport Barriers
Figure 6.7 Experimental verification of the separation location and angle formulas 
(6.19)-(6.20) for a 2D, time-periodic rotor-oscillator flow. The zero wall-shear point 
is out of range to the left at the times t = 3:7 s and t = 5:0 s, whereas it is at the 
location marked by a star at the time t = 2:0 s. Image adapted from Weldon et al. 
(2008).
are highlighted by an accumulation of dye or smoke, just as the separation surface shown 
inFig. 6.8. This figure also underlines how separation surfaces act as advective transport 
barriers, preventing material incursion or fingering between a separation region and the mean 
flow.
By the definition we have used for observed barriers to advective transport in this chapter, 
separation surfaces must be 2D unstable manifolds emanating from a 2D flow boundary. It 
is, however, a priori unclear whose unstable manifolds these 2D surfaces are. Indeed, on a 
steady free-slip boundary, there are infinitely many candidate trajectories along which an 
invariant material surface may attach to the boundary. Similarly, along a no-slip boundary, 
all fluid trajectories are fixed points, and hence an invariant material surface may attach to 
the boundary along any curve of boundary points.
As, free-slip boundary conditions are less relevant for 3D flows, we will focus here on 
no-slip separation. We consider a steady vector field
x 
U(X; Z°
= V(X; Z ° =
Z] 
\ W(X; Z°
U u (x; y, z ° 
v (x; y; Z ° 
\ w(x; y; z°
w( x; y; 0° = 0; 
(6.22)

6.1 Flow Separation in Steady and Recurrent Flows
253
Figure 6.8 Separation surface as a transport barrier, visualized experimentally by 
smoke released around a 3D bluff body. Image adopted from Delery (2001).
with the coordinates (x, z° = (x, y, z° chosen so that the boundary is described by z = 0. The 
2D skin friction field t (x° on the boundary is defined as
(x° = 
uz (x; 0°;
(6.23)
where is the fluid density, is the viscosity and uz (x; 0° is the wallfl-shear vector field. The 
smoke streaks accumulating on the obseflrved separation line on the surface of the projectile 
inFig. 6.8 provide a visualization of the skin friction lines, defined as trajectories of the 
vector field t (x°.
Based on similarflobservations, Lighthill (1963) proposed that the convergence of skin­
friction lines is a necessary criterion for separation. He also postulated that separation lines 
always start from saddle-type skin-friction zeros and terminate at stable spirals or nodes. 
Wang (1972), however, provided examples in which none of the converging skin friction 
lines originate from sfiaddles (see also Tobak and Peake, 1982 and Yates and Chapman, 1992). 
Wang (1974) described this phenomenon as open separation, characterized by a separation 
line that starts or ends away from skin-friction zeros. In contrast, Lighthill’s closed separation 
paradigm, with the separation line connecting skin friction zeros, has since become known 
as closed separation.
The first suggestion that separation surfaces are unstable manifolds appears to be by Wu 
et al. (1987). Van Dommelen and Cowley (1990) also take a material (Lagrangian) view 
of flow separation, but primarily in the context of the unsteady boundary layer equations. 
They propose that the deformation gradient rFt0 should become unbounded at separation 
points. As we have already noted in connection with Fig. 6.1, however, such singularities 
cannot arise in bounded physical flows by the basic properties of the flow map (see §2.2.3). 
Another approach to separation based on material behavior is that of Wu et al. (2000, 2005), 
who obtain conditions for the simultaneous convergence and upwelling of fluid elements 
near general boundaries. These conditions yield close approximations to separation lines 
and separation slopes for steady flows with linear skin-friction fields and hence are accurate 
indicators of separation lines near zeros of t (x°.

(6.24)
(6.25)
254 
Flow Separation and Attachment Surfaces as Transport Barriers
A systematic search for separation surfaces should target structurally stable 2D attracting 
material surfaces (invariant manifolds) emanating from the z = 0 invariant plane of the dy­
namical system (6.22).3 To carry out this search, we can employ the same blow-up technique 
that we used in §6.1.1. In our current setting, the trajectory-dependent time-rescaling (6.7) 
must be carried out with the wall-normal coordinate as
3 As we have already remarked for 2D separation, no such material surface would be structurally stable in the 
general class of 3D velocity fields due to its degenerate stability type, which arises from the continuous family 
of fixed points filling the z = 0 plane. A separation surface, however, will be structurally stable within the class 
of physically relevant velocity field perturbations that preserve the no-slip boundary at z = 0.
t = ^ z(S; X0; y0; z0° ds;
leading to a blown-up version of the velocity field (6.22) in the form
x0 
= 
uz (x; 0° + O(z° 
:
z' 
z [2wzz(x;0° + O(z)]
As in the 2D case, all orbits of this ODE coincide with those of system (6.22) away from 
the z = 0 boundary. For this reason, one can identify separation surfaces as 2D invariant 
manifolds (streamsurfaces) of the ODE (6.25) that connect to the boundary. As both the 
boundary and the separation surfaces are invariant, their intersection, the separation line, 
must also be invariant: it must be a one-dimensional set composed of trajectories of the ODE 
(6.25) on the boundary. The blown-up flow on the boundary is
X0 = Uz (X; 0) = — T (x); 
(6.26)
generated by the skin friction field T (X) acting as a velocity field. Therefore, separation lines 
are always skin-friction lines, in agreement with the classic observations of Lighthill (1963). 
Another implication of Eq. (6.26) is that the open separation patterns discovered by Wang 
(1972) must also take place along surfaces emanating from skin friction lines.
Surana et al. (2006) obtain a classification of skin friction lines from which experimen­
tally observable separation or attachment surfaces originate. These lines also include point­
trajectories (i.e., skin-friction zeros) of Eq. (6.26) from which observable one-dimensional 
separation or attachment curves emanate. Robust observability of these separation profiles in 
experiments requires more than just their structural stability: the separation lines must also 
attract nearby skin friction lines at each of their points, not just at their endpoints. Using dy­
namical systems methods, Surana et al. (2006) prove that only four such robustly observable 
basic separation patterns exist, as shown in Fig. 6.9.
The basic separation patterns in Fig. 6.9 can be located from the analysis of the skin friction 
field T(X), or its scaled version, the wall shear field uz(X;0) (see formula (6.26)). This analysis 
involves finding heteroclinic saddle-node, saddle-focus and saddle-limit-cycle connections, 
as well as limit cycles in the wall shear field. As already mentioned, the observability of these 
special skin friction lines as separation profiles requires that they must strictly attract nearby 
skin friction lines. Surana et al. (2006) show that this pointwise negativity of the normal 
attraction rate S?(x0) of the skin-friction trajectory x(t; x0) running through a point x0 at time 
t = 0 in the ODE (6.26) can be expressed as

6.1 Flow Separation in Steady and Recurrent Flows
255
(S1) 
(S2)
(S3) 
(S4)
Figure 6.9 The four robust elementary separation patterns in 3D steady flows near 
a no-slip boundary, classified based on the corresponding separation line . (S1) 
is a skin friction line connecting a saddle p to a focus. (S2) is a skin friction line 
connecting a saddle p to a node q along the direction of weaker attraction at the node. 
(S3) y is a skin friction line connecting a saddle to p a limit cycle r. (S4) y = r is a 
limit cycle of the skin friction field. Images adapted from Surana et al. (2006).
<!wall(x), rT(x°!waU(x°i
d?(X° = 
2 
< 0;
pV j!wall (x°j
(6.27)
where !wall(x) = !(x, 0° is the wall-parallel component of the vorticity ! = r x v at the 
wall. Only the part of a skin friction line y shown in Fig. 6.9 that satisfies the inequality 
(6.27) will be observed as a separation line.
Surana et al. (2006) also calculate the angle (x0° that the separation surface encloses 
with the wall-normal direction at each a point x0 along the separation line. Specifically, for 
incompressible Navier-Stokes flows with a wall-pressure distribution pwall(x), they obtain 
the expression
tan xn't 1 f0 e - fo » 2 rT (x(s;xo))+S?(x(s;xo))] ds rx pwall(x( t; xo°°; !wall(x( t; X0°° dt
tanU(X0) = 2pvJ_i e 
^wan(x(, X0°)! 
dt;
(6.28)
involving the skin-friction trajectory x(t; x0) with x(0; x0) = x0 (see also Surana et al., 2007). 
This angle can be used to construct a leading-order linear approximation (line bundle) along 
the separation line to which the separation surface will be tangent. Advecting a short segment 
of this approximate separation surface forward under the flow map of the original velocity 
field (6.22) then leads to a global approximation of the separation surface. Attachment 
surfaces can be handled similarly, as explained by Surana et al. (2006, 2007).
Applying these results to a steady lid-driven cavity flow, one obtains the global separation 
surface shown in Fig. 6.10. The separation lines on the walls of the cavity are reconstructed

256
Flow Separation and Attachment Surfaces as Transport Barriers
(a)
(b) 
(c)
Figure 6.10 Identification of a separation surface in a steady lid-driven cavity flow. 
(a) Skin friction field (red) with its fixed points (black) and extracted separation lines 
(green). (b) Local approximations to the separation surfaces from the angle formula 
(6.28), evaluated along the separation lines. (c) Global separation surfaces obtained 
from the advection of their local approximations. Adapted from Surana et al. (2007).
from the wall-based skin friction field, shown in Fig. 6.10(a) for one of the walls. The 
identification of the separation line involves the numerical exploration of saddle-node con­
nections by starting skin friction trajectories along the unstable direction of saddle points 
of the skin friction field t(x°. Once these heteroclinic skin friction trajectories x(F; x0° are 
found numerically, their pointwise attraction along the wall can be verified from formula 
(6.27) and a linear approximation to the separation surface can be computed along x(t; x0° 
from formula (6.28) close to the wall, as shown in Fig. 6.10(b). Advecting trajectories of 
the full velocity field from this local approximate separation surface then yields the global 
approximate separate surface shown in Fig. 6.10(c).
6.1.4 Separation in 3D Recurrent Flows
Unsteady separation in 3D flows continues to receive attention due to its significance in 
aerodynamics (Smith, 1986; Ruban et al., 2011; Cassel and Conlisk, 2014). Here, we briefly 
review extensions of the kinematic theory of steady flow separation in §6.1.3 to flows 
with recurrent (periodic or quasiperiodic time dependence). These results follow from the 
more general findings of Surana et al. (2008) for flows with a well-defined temporal mean 
component, to be discussed in §6.2.
Following the approach of Kilic et al. (2005), Surana et al. (2008) construct nonlinear, 
time-dependent coordinates near the no-slip boundary in which the flow becomes locally 

6.1 Flow Separation in Steady and Recurrent Flows
257
slowly varying. Then, by the theory of averaging (see, e.g., Sanders et al., 2007), robust 
separation lines in the skin-friction field of the leading-order averaged velocity field give 
rise to similar, fixed separation lines in the full unsteady flow. While the separation locations 
obtained in this fashion are fixed curves, the separation profiles emanating from these curves 
will be deforming material surfaces that inherit the recurrent time-dependence of the velocity 
field.
Specifically, consider an incompressible time-periodic velocity field
= V(X; Z; t° =
U(x Z; t° 
w(x; z; t°
u(x; y; Z; t°
V( X; y; Z; t) 
= V(X; Z; t + T\ 
(6.29)
w(x; y; Z; t° 
with period T > 0 and with a no-slip boundary at Z = 0. Leading-order approximations to 
separation lines on the Z = 0 boundary can be identified from the averaged skin friction field
x0 = 1[ Uz(X; 0; t° d = ~T(x° 
T 0
(6.30)
In this 2D steady velocity field, the four possible robust separation line patterns are just those 
shown inFig. 6.9.The question is then: Under what conditions does such a separation line 
mark the fixed base-curve of a time-periodic separation surface on the wall?
To answer this question, we introduce the time-averaged version of the pointwise normal 
attraction measure (6.27) for trajectories of Eq. (6.30) as
—S?(x
h!wall(x°; rxT(X°!wall(X°>
PV |C!waii(x°j2
(6.31)
with !wall denoting the time-average of the wall vorticity field !(x; 0; t°. We also introduce 
the leading-order averaged wall-normal stretching rate as
—
(T (x° =
wzz (x; 0; t° dt.
(6.32)
With the help of these two quantities, Surana et al. (2008) prove that a heteroclinic trajectory 
y of T-(x° that falls in one of the categories (S1)-(S4) of Fig. 6.9 and satisfies the pointwise 
conditions
S?(x° - CJ(x° < 0; 
C(x° > 0; 
x 2 y
(6.33)
is a fixed separation line for a time-periodic separation surface M (t° = M (t + T° in the full 
velocity field v(x; Z; t°. Surana et al. (2008) also derive a leading-order linear approximation 
to M(t° by generalizing the angle formula (6.28) to unsteady flows.
As an example, Fig. 6.11 shows separation surfaces identified by Surana et al. (2008) for 
a 3D cavity flow driven by a time-periodically moving lid. The time-averaged wall-shear 
fields on two different walls of the cavity are shown on the left, with the separation lines (i.e., 
heteroclinic orbits of T-(x° satisfying the conditions (6.33) pointwise) shown in green and 
blue, respectively. On the right plots, we show red and purple trajectories initialized on the 
two sides of the first-order approximations to the predicted time-periodic separation surfaces. 
These trajectories are indeed guided near the wall by the approximate separation surfaces.

258
Flow Separation and Attachment Surfaces as Transport Barriers
Figure 6.11 Identification of fixed unsteady separation with time-periodically mov­
ing separation surfaces in a cavity flow with a periodically moving lid. Plots adapted 
from Surana et al. (2008).
(6.34)
For flows with quasiperiodic time dependence, the 3D velocity field v(x; z; t° can be 
represented, as in §4.2,in the form
( X \ 
( U(X; Z; ftt° \
= V(X; Z; ft t ° = 
;
\ Z ) 
\ W(X; Z; ftt° )
where the frequency vector ft = (Q1,ik...;ftm° 2 Rm has m rationally independent 
components. In this case, the general theory of Surana et al. (2008) for 3D unsteady separation 
again leads to the analysis of the averaged skin friction field t(x°, defined via the formula
1 
2 
2 
1
x = m"J0 -/0 uz(x0^°d*"'d*"' = pv
In this steady velocity field, the four robust separation line patterns are again those shown 
in Fig. 6.9. With the time-averaged (i.e., phase-averaged, as in Eq. (6.30)) normal attraction 
measure 
(6.35)
h , h _ h!waU(x°; rxT(x°!wall(x°i 
o 1 (X
(6.36)
(6.37)
pV j!wall(x°j
and with the leading-order averaged wall-normal stretching rate,
C(x° = tA" [ ■■■ f Wzz (X; 0; 0° d ^1 ■■■ d 0m;
(2^° 
0 
Jo
the results of Surana et al. (2008) again lead to the separation condition (6.33). Specifically, if 
this condition holds pointwise along a heteroclinic trajectory of formula (6.35) that falls in 
one of the categories (S1)-(S4), then y is a fixed separation line for a quasiperiodic separation 
surface M (ftt° in the full velocity field v(X; Z; t°. A leading-order linear approximation to this 
surface is again provided by the more general formulas of Surana et al. (2008) for flows with 

6.2 Unsteady Flow Separation Created by LCSs
259
a well-defined temporal mean component (see §6.2). Criteria for locating material spiking 
points and spiking profiles for that general class of flows are also available in Serra et al. 
(2018) and hence can be applied to time-quasiperiodic flows as well.
6.2 Unsteady Flow Separation Created by LCSs
A special class of LCSs connects to flow boundaries and creates flow separation or attachment, 
as discussed in §6.1. We refer the reader to that section for some general discussion on the 
kinematic theory of flow separation, as well as for separation criteria that apply to steady 
and temporally recurrent flows. Here, we discuss extensions of those results to flows with 
more general time dependence. Separation and attachment at free-slip boundaries is due to 
hyperbolic (attracting and repelling) LCSs, while the same phenomena at no-slip boundaries 
arise due to nonhyperbolic (yet structurally stable) LCSs. The connection of these LCSs with 
the boundary enables their more specific local description that only involves the time history 
of Eulerian quantities along the boundary.
6.2.1 2D Unsteady Separation
No Poincare maps are available for a 2D unsteady flow with general time-dependence. This 
prevents us from defining and identifying separation points as fixed points of a Poincare map 
with a wall-based unstable manifold, as we did in §6.1.2.
Instead, we will be seeking material lines anchored at the wall that remain uniformly 
bounded from the wall in backward time. Allowing infinitely long backward times in this 
analysis can lead to a uniquely defined separation profile at the present time. Allowing only 
a finite backward time analysis will result in nonunique separation profiles that highlight a 
thin set of material lines, as opposed to a single material line as the separation profile.
Unsteady Separation from Free-Slip Walls
Our discussion at the beginning of §6.1.1 on the importance of free-slip boundary conditions 
is most relevant for temporally aperiodic flows arising in geophysics. As we already noted 
for time-periodic flows, the instantaneous streamline geometry boundaries in such flows 
cannot generally be taken as a predictor of material flow separation. As an illustration, 
Fig. 6.12 shows the formation of a separation spike from the free-slip boundary of a 2D 
rotating flow in a circular tank. The stream function of this velocity field4 is given by 
^(x, t) = (jxj2 - 1) (x 1 sin!t + x2 cos !t) - 1! |x|2; producing the streamlines shown in 
dashed black lines for !> 2. All instantaneous streamlines in the flow domain are closed 
curves for all times, with no connection to the boundary. Yet the flow displays sharp material 
separation and reattachment, as Fig. 6.12 confirms, at the boundary points marked in red and 
blue, respectively.
4 This flow is obtained by transforming the steady flow with stream function <^(x) = ( |x |2 - 1)x2 into a frame 
rotating with angular velocity !. The transformed stream function can then be obtained directly from formula 
(3.9).
To predict such unexpected separation phenomena, Lekien and Haller (2008) consider 
unsteady velocity fields of the form

260
Flow Separation and Attachment Surfaces as Transport Barriers
1.0
1.0
0.5
0.5
0.0
0.0
-0.5
-0.5
-1.0 -|
-1.0
-0.5 
0.0 
0.5 
1.0
Figure 6.12 Development of free-slip material separation and reattachment in a 
rotating tank without the presence of any hyperbolic stagnation point in the flow. Green 
marks fluid particles advected from a small vicinity of the circular flow boundary. 
Image adapted from Lekien and Haller (2008).
X = V(X; t °; 
X 2 D C R2; 
Vj@D k @ D;
where D is a bounded, possibly time dependent, 2D domain with a smooth and compact 
free-slip boundary @D: In this setting, the velocity field is assumed to be known at least on a 
half-bounded time interval (-1,10] for separation analysis, or on an interval»10; 1 for reat­
tachment analysis. In practice, knowledge of the velocity field on long enough time intervals 
(such that the improper integrals in our upcoming formulas show signs of convergence) is 
enough. Let e(X; t° and n(X; t° denote a unit tangent vector and unit boundary normal vector, 
respectively, to @D at a point X at time t, oriented in a way that
det »e(X; t°; n(X; t°] = 1:
We say that flow separation has been taking place along a boundary trajectory fX(t°g C @D 
up to time t0 if: 
0
(SS1) x(t° attracts all nearby trajectories within @D for t 2 (-110];
(SS2) 
X(t° has a unique, time-dependent unstable manifold (separation profile) that stays 
uniformly bounded away from the boundary @D for all t 2 (-110];
(SS3) small enough perturbations to the velocity field result ina nearby X(t° satisfying (SS1)
and (SS2).
Using the theory of normally hyperbolic invariant manifolds (Fenichel, 1971; Mlane, 1978), 
Lekien and Haller (2008) show that (SS1)-(SS3) hold whenever x(t° satisfies the following 
separation criterion for
1 
t0
de(10° = lim sup 
he(x(t°, t°, S(x(t°, t°e(x(t°, t°i dt < 0,
T!+1 T Jt0_T
1 
t0
dn(10° = lim inf 
hn(x(t°, t°, S(x(t°, t°n(x(t°, t°i dt > 0,
T!+i T Jt0-T 
(6.38)

6.2 Unsteady Flow Separation Created by LCSs
261
where S = 1 |Vv + (rv°T] is the rate of strain tensor. Furthermore, the angle a(t0° between 
the separation profile and the boundary at time t0 satisfies
2 
t0 
t
cota(t0° = lim e 
et »he;Sei ll;Sn x s s ds he(x(t°,t°,S(x(t°,t°n(x(t°,t°i dt. 
(6.39)
T!+i T Jto-T
Similar criteria are available in Lekien and Haller (2008) for attachment on flow boundaries.
If v is incompressible, then (e, Sei = - (n, Sn), and hence the criteria (6.38) simplify to 
the single separation criterion
e(t0° > 0, 
(6.40)
or, equivalently, to n(t0° < 0. Note that for a steady incompressible flow with a free-slip 
boundary at y = 0, setting x(t° = xp, 0 to be a stagnation point in criterion (6.40) gives 
1t0
lim sup — U 
ux (xp, 0° dt = ux (xp, 0° < 0,
T !+1 T Jt0 _T 
p
which agrees with the condition obtained in Eq. (6.1).Also note that the criterion (6.38) is 
objective due to the objectivity of the tensor S.
Figure 6.13 shows an application of the above criteria to the detection of moving separation 
and reattachment points in Monterey Bay along the California coastline (see Lekien and 
Haller, 2008 for details).
The 2D velocity field (shown at select locations via black arrows in Fig 6.13) is recon­
structed from high-frequency surface current measurements provided by an array of coastal 
radars (Paduan and Cook (1997)). The grid spacing in these measurements does not allow for 
a resolution of the boundary layer, which makes free-slip boundary conditions along the coast 
line a viable option. In the analysis shown in Fig. 6.13, an integration time of T = 48 hours 
was used to evaluate e(t0°, n(t0° and the separation angle formula (6.39). To counteract 
the effect of noise in the data, a relaxed criterion of the form An(10° - Ae(10° > 0 was used, 
which was only satisfied at isolated grid points along the boundary at the available resolu­
tion. Forward- and backward-evolving streaklines released near the computed separation and 
reattachment points confirm the predicted locations and angles.
Importantly, the separation and reattachment locations cannot be reliably inferred from 
instantaneous radar data. Specifically, stagnation points along the coast tend to bifurcate on 
hourly time scales. They are often completely absent near locations of actual fluid breakaway. 
When they are present, they often coexist with other instantaneous stagnation points that 
incorrectly indicate local flow attachment. In contrast, identifying material flow separation 
using the Lagrangian approach described here provides a robust detection of fluid currents 
from the coast, relevant for pollution control studies (see Lekien et al., 2005; Coulliette et al., 
2007).
As an example, Fig. 6.14(a) shows the Duke power plant (larger red circle) in Monterey 
Bay, California, as well as the outlet of its warm-water exhaust pipe and plume (smaller red 
circle) that extends 200 m off the beach.
Figure 6.14(b) shows a snapshot of FTLE ridges extracted from the surface-radar-based 
velocity field. A black dot marks the time-varying intersection of a strong FTLE ridge with 
the line of the pipe (dashed). This ridge highlights the main reattachment profile shown in 
Fig. 6.13, connected to the southern tip of the bay. The instantaneous position of the black dot

262
Flow Separation and Attachment Surfaces as Transport Barriers
Figure 6.13 Unsteady free-slip separation and free-slip reattachment in Monterey 
Bay, California. (Top) A moving separation point near Santa Cruz, confirmed by 
streaklines (green) released nearby. Black arrows mark instantaneous velocity vectors. 
(Bottom) Same, with a moving reattachment point along the Monterey Peninsula 
added and with streaklines obtained from backward-time integration. Image adapted 
from Lekien and Haller (2008).
relative to the opening of the pipe along the line of the pipe determines whether the material 
released from the pipe at that time will recirculate in the bay or escape to the open ocean.
Figure 6.14(c)shows a white and a black parcel released at times when the orifice is on 
two different sides of the black ridge-intersections point. The lower right plot then shows how 
this passive pollution control strategy indeed makes a difference in the simulated evolution 
of the white and black material parcels. Specifically, the white parcel corresponds to the 
desired clearance of the pollution to the open ocean, while the black parcel is undesirably 
recirculated by surface currents in the bay.
Fixed Unsteady Separation from No-Slip Boundaries
For the classic unsteady flow separation problem with no-slip walls, the hyperbolicity-based 
approach of §6.2.1 is inapplicable. In the absence of relevant invariant manifold results, 
one is forced to rethink what exactly distinguishes a material separation profile from other 
material curves attached to the boundary.
We will focus here on deconstructing fixed separation created by an attracting material line 
anchored to a no-slip boundary at a distinguished separation point. In a forward-time movie of 
an imagined separation experiment, all nearby wall-anchored material lines would converge

6.2 Unsteady Flow Separation Created by LCSs
263
(a)
(b)
(c)
Figure 6.14 (a) Aerial view of the Elkhorn Slough and the Duke power plant and 
the outlet of its warm-water exhaust pipe. (b) Forward FTLE map of Monterey Bay, 
with ridges highlighting reattachment profiles relevant for pollution control via timed 
release. (c) Judiciously chosen release times for a white and a black parcel from the 
pipe. (d) Simulated evolution of the white and black parcels based on the surface 
current data. Image adapted from Coulliette et al. (2007).
(d)
133 133 
-13.1 . .13 . -133 
133
Longitude (degrees)
to the separation profile and hence to each other, too. Therefore, the forward-asymptotic 
behavior of the separation profile is in no way distinguished. In a backward time movie 
of the same separation event, however, the separation profile would repel all wall-anchored 
nearby material lines asymptotically towards the wall, as shown in Fig. 6.15. As a result, the 
separation profile is locally the only wall-anchored material line enclosing an angle with the 
boundary that remains uniformly bounded away from zero.
Any time-evolving material line, attached at a point p = (xp; 0° to a no-slip wall along the 
y = 0 axis, can be written in the form
x=xp+yF(y;t° 
(6.41)
for some smooth function F(y; t°: Differentiating this expression with respect to time, using 
the velocity field v(x; t° = (u(x; y; t°; v(x; y; t°° and defining the quantities
1 
1
A(x; y; t° = 
uy (x; sy; t° ds; B(x; y; t° = 
vy(x; sy;t° ds; 
(6.42)
00
we obtain a pde for F in the form
Ft = A(xp + y F; y; t ° - B(xp + y F; y; t ° F - y Fy B(xp + y F; y; t °: 
(6.43)

264
Flow Separation and Attachment Surfaces as Transport Barriers
Figure 6.15 Backward-time behavior of two wall-anchored material lines, L(t° and 
N(t°, initialized near a material separation profile M(t° at time 10. L(t° is also 
anchored at the separation point p as M(t° is, whereas N(t° is anchored at a nearby 
boundary point. Adapted from Haller (2004).
We seek the separation profile as a solution F(y. t° to this PDE that stays uniformly bounded 
away from the wall in backward time for an appropriate choice of the separation location xp 
along the wall. This approach can be carried out by finding an xp for which the coefficients 
fi(t) = @yiF(01) in the Taylor expansion
F (y. I ° = f,(l) + fi( l °y + 1 f2( l °y + ■ • ■ 
(6.44)
/
remain uniformly bounded in backward time. Substituting this expansion into the PDE 
(6.43), Haller (2004) finds that for a mass-conserving flow with density p(x. y. t°, the uniform 
boundedness of fi (t° over a time interval (-1.10] can only arise at a location xp that satisfies 
the conditions
uxy (xp. 0. T° 
vyy(xp. 0. T
(xp. 0. T
lim sup 
t!-1
F uy(xp. G.t 
to P(xp. G. t°
< 1.
r uy(xp. 0. s° ds 
t0 p(xp. 0. s°
dT = 1
(6.45)
(6.46)
for some choice of the present time t0. In other words, by condition (6.45), backward-time 
averages of the density-weighted wall shear need not converge but must remain bounded at 
the separation location. In addition, by condition (6.46), the backward-time integral of the 
density-weighted, modified wall-shear gradient must converge to infinity.
In 2D flows, these two conditions represent the generalization of Prandtl’s steady, incom­
pressible separation condition for fixed separation in unsteady, mass-conserving flows with 
arbitrary time dependence. Indeed, Haller (2004) shows that the general conditions (6.45)­
(6.46) imply all the more specific 2D separation conditions we have already discussed 
in §6.1,assuming incompressibility, steadiness, time-periodicity or time-quasiperiodicity. 
Haller (2004) also obtains formulas for the derivatives fi (t° of the separation profile at 
the wall. These formulas again follow from the requirement that these derivatives must be 
bounded. In the incompressible case, the leading-order formula,
fj(10° = - lim 
t!-1
/tt0 [uyy(xp. 0.T°- 3uxy(xp. 0. T° Xt0 uy(xp. 0. s° dS] dT 
3 tt0 uxy(xp. 0. T° dT
(6.47)

6.2 Unsteady Flow Separation Created by LCSs
265
provides a generalization of Lighthill’s classic expression (6.12) for the separation slope 
relative to the wall-normal direction.
While the formulas (6.45)-(6.47) are general enough to capture fixed unsteady separation 
in 2D flows, they require integration over infinite time intervals and hence are impractical 
on data. Kilic et al. (2005) show that the formulas become more directly computable for 
mass-conserving velocity fields with a well-defined steady temporal mean component5
v (x° = 
u ( x; y° 
:= lim 1 f v(x; t ° dt. 
(6.48)
V° 
V(x; y° Tn T tto-T ( °
For this class of flows, the mathematical theory of averaging (see, e.g., Sanders et al., 2007) 
becomes applicable near the y = 0 boundary. Indeed, under the assumption (6.48) of an 
asymptotic mean velocity field, the velocity field will oscillate slowly around this mean near 
the wall due to the near-zero velocities arising from the no-slip boundary condition.6
Specifically, by the theorem of averaging, a local nonlinear coordinate change x = (x, y° ! 
£ = (£, e^° with e « 1 exists near the y = 0 no-slip wall such that in these new coordinates, 
any mass-conserving velocity field becomes
£ = e f 0(£° + e ¥(<£; t ° + O(e 3°: 
(6.49)
For incompressible flows, the leading-order term in this expansion simplifies to
£ = ef0(£° = e ( 
); 
(650)
but the exact form of f0 (£° for compressible flows is also computable. Kilic et al. (2005) 
prove that a separation point identified in the steady leading-order flow (6.50) via the classic 
Prandtl criterion
Uy (xp; 0° = 0; 
uxy (xp; 0° < 0 
(6.51)
is also the anchor point of a true time-dependent separation profile in the full unsteady flow 
generated by v(x; t°.
Applying higher-order averaging (see Sanders et al., 2007), Kilic et al. (2005) also re­
moves the time-dependence in the higher-order terms in (6.49) by successive local nonlinear 
coordinate changes near the no-slip wall. The hierarchy of steady flows obtained in this 
fashion gives increasingly accurate polynomial expansions for the separation profile in terms 
of the original (x; y°-coordinates. For instance, the general separation slope formula (6.47) 
simplifies to
uyy (xp; 0° — 3uxy (xp; 0; t° f. uy (xp; 0; s ° ds
f)(t0° =----------------------—xr--------------------------; 
(6.52)
3ulxy (xp; 0°
with the overbar denoting asymptotic averaging, as in Eq. (6.48).
5 A further technical requirement is that the average deviation from this mean, A(x, t° = ft° [v(x, s° - v°(x)] ds, 
as well as the first three spatial derivatives of (x; t°, must remain uniformly bounded for t t0 on bounded
domains.
6 For this local slow variation to hold near the no-slip boundary, the velocity field may be compressible but must 
conserve mass, i.e., satisfy the equation of continuity t + r (v° = 0 for a smooth density field (x; t°. See 
Kilic et al. (2005) for details.

266
Flow Separation and Attachment Surfaces as Transport Barriers
Weldon et al. (2008) verify the separation formulas (6.51)-(6.52) by imposing quasiperi- 
odic motion on the cylinder in the rotor-oscillator flow experiment shown in Fig. 6.7. As in 
their time-periodic experiment, they evaluate the formulas (6.51)-(6.52) in a direct numerical 
simulation of the flow and superimpose the predicted separation location at different times on 
snapshots of an observed dye spike near the wall of the tank. In this experiment, the cylinder 
rotated at a rate of 20:89 rad/s, while being moved quasiperiodically with 20 incommensurate 
frequencies with random phases and a common amplitude. A sample of the resulting cylinder 
motion is shown in the upper plot of Fig. 6.16, designed to mimic chaotic time dependence 
in the velocity field. The lower plots in the same figure confirm the accuracy of the theory 
of Kilic et al. (2005) and underline again the irrelevance of instantaneous zeros of the wall 
shear field for unsteady separation.
30
20
10
0
10
Time (s)
0 
20 
40 
60 
80 
100
Time (s)
t = 73.0s
t = 52.3 s
25 
30 
35 
40
x (mm)
25 
30 
35 
40
x (mm)
Figure 6.16 Experimental verification of the separation location and angle formulas 
(6.51)-(6.52) for a 2D temporally quasiperiodic rotor-oscillator flow. A star symbol 
indicates the location of the instantaneous wall shear zero (whenever in range), which 
is often believed to be the separation point in unsteady flows as well. Adapted from 
Weldon et al. (2008).
t = 79.0 s
25 
30 
35 
40
x (mm)
The general criteria (6.51) can also be used as a basis to control the location of fixed 
unsteady separation. For use in controlling unsteady attachment, the analogous criteria are
Uy (Xp; 0° = 0; 
Uxy (Xp; 0° > 0; 
(6.53)
which is used by Alam et al. (2006) to design a closed-loop feedback controller for reat­
tachment behind a 2D backward-facing step. The inflow velocity uin = 0:015 m/s leads to 
the Reynolds number Re = 200, keeping the 2D approximation to the flow relevant and the 
model for the two actuators (wall-jets) accurate.The objective is to reduce the recirculation

6.2 Unsteady Flow Separation Created by LCSs
267
zone by moving the original location of the reattachment point from x 0:3 m to x = 0:2 m 
behind the backward-facing step (see Alam et al., 2006 for details of the controller design). 
Figure 6.17 shows that the controller does indeed reduce the recirculation zone to the re­
quired size, as evidenced by the shape of pressure-colored streaklines released from the inlet 
cross-section of the channel.
Uncontrolled reattachment
Controlled reattachment
Figure 6.17 Closed-loop reattachment control behind a backward-facing step. Image 
adapted from Alam et al. (2006).
We note that for free-slip boundaries, the closed-loop control of unsteady separation for 
mixing enhancement is discussed by Wang et al. (2003). More recent flow control work 
by Kamphuis et al. (2018) shows that for increased lift and reduced drag on an airfoil, the 
optimal location for pulse actuation in the boundary layer is near the Lagrangian separation 
point.
Moving (Off-Wall) Unsteady Separation Near No-Slip Boundaries
As in the case of 2D steady and time-periodic separation from no-slip walls (see §§6.1.1 
and6.1.2), the material spikes shown in Fig. 6.16 develop from an initial upwelling whose 
location is markedly distinct from the location of the asymptotically prevailing Lagrangian 
separation point. In analogy with the steady case we described in §6.1.1, Serra et al. (2018) 

268
Flow Separation and Attachment Surfaces as Transport Barriers
seek the wall-based signature of the initial upwelling as a point over which initially wall­
parallel material lines will reach a curvature maximum. At time t0 , this Lagrangian spiking 
point, s = (xs(t0°; 0°, satisfies
Vxxxyy (xs (t0°; 0° = 0; Vxxyy (Xs (t0°; 0° < 0; Vxxxxyy (Xs (t0°; 0° > 0; 
(6.54)
with these derivatives computed from the mean velocity v(x° defined in Eq. 6541S)).
To avoid the computation of higher-order derivatives appearing in condition (6.54) from 
data, Serra et al. (2018) focus on the detection of the theoretical centerpiece (or Lagrangian 
backbone) of the evolving material spike, rather than just its intersection with the wall. They 
characterize the initial position B(t0 ° of the evolving material backbone of a separation spike 
as a curve of initial conditions at which initially wall-parallel material lines experience the 
largest curvature change over a time interval »t0; t°. Such a curve is sketched in Fig. 6.18, 
with r0(s° denoting a parametrization of an initially wall-parallel material line whose point 
of locally maximal curvature change falls on B(t0 °.
Figure 6.18 The material backbone B(t° of a separation spike, emanating from a 
Lagrangian spiking point on a no-slip boundary. The matrix R denotes clockwise 
rotation by 90, to be used in formula (6.55) for the curvature change experienced 
by an initially wall-parallel material line parametrized as r0(s°. Image adapted from 
Serra et al. (2020a).
As a local maximizer of curvature change within each initially wall-parallel material line, 
B(t0° can be formally defined as a wall-transverse height ridge (see §A.2) of the Lagrangian 
curvature change function ict*(r0°: For incompressible flows, the more general formula of 
Serra et al. (2018) for this function simplifies to 
l<tt0 r0
K0 (r0° + < (r2F?0 (r0° r0) r0; JrFt0 (r0° r0) 
(r0; C0 (r0° r0>3'2
- K0 (r0°;
(6.55)
involving the right Cauchy-Green strain tensor Ct0, the 90° rotation tensor J (see Eq. (5.47)), 
as well as the first and second derivative tensors of the flow map Ftt0 .
Approaching separation via the Lagrangian backbone also enables the extension of the 
notion of wall-based (or fixed) separation to off-wall (or moving) separation. Specifically, a 
backbone curve (as a height ridge of the i<tt0 (r0°) may or may not reach the no-slip boundary. 
In case it reaches the boundary, the separation has an on-wall signature in the form of the 
spiking point originally defined by the formulas (6.54), but detected far more robustly via 
the ridge B(10° without higher derivatives. In contrast, a ridge Kt (r0° that terminates before 
reaching the boundary signals the birth of an off-wall material spike without an on-wall 
signature. Without an anchor point on the no-slip boundary, the material spike in the latter 
case will have a moving spiking point which may glide inside, or out of, the boundary layer. 
Importantly, prior approaches to separation assume either on-wall or off-wall spike formation, 
whereas the approach of Serra et al. (2018) is a unified treatment of both phenomena.

6.2 Unsteady Flow Separation Created by LCSs
269
As an example, Fig. 6.19 shows coexisting on-wall and off-wall material spikes near a 
vertical downward jet impinging on a no-slip horizontal plane at y = 0 (see Serra et al., 
2020a for details).
(a) 
T = 2 
(b) 
T =2
x
0.4
y 0.2
0.3
0.4
0.2
t = 0.4
0.3
0.4
0.1
0.1
0 2.2 2.4 2.6 2.8 3.0
0 2.2 2.4 2.6 2.8 3.0
0.4
0.3
y 0.2
0.1
t = 1.2
0 2.2 2.4 2.6 2.8 3.0
x
0.4
0.3
0.2
0.1
t = 1.6
0 2.2 2.4 2.6 28 3.0
0.3
0.2
0.1
t = 0.8
4
2
0
-2
-4
-6
0 2.2 2.4 2.6 2.8 3.0
x
t = 0
6
Figure 6.19 On-wall (fixed) and off-wall (moving) separation induced by vortices 
created by an impinging jet on the y = 0 plane at Re = 2; 000; see the text for 
explanation. Also shown is the instantaneous vorticity field in the background. 
Videos showing time-resolved evolution of these material spikes are available at 
https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/ 
article/abs/material-spike-formation-in-highly-unsteady-separated- 
flows/62B0FE53F5E5D32A2DBFE73CAA3B7480n#supplementary-materials. 
Image adapted from Serra et al. (2020a).
n 
reT
Figure 6.19(a) shows two ridges in the curvature change field KT (ro° with to = 0 and 
T = 2:0, whereas Fig. 6.19(b) shows the backbones B(t0° in red, extracted from these two 
ridges by taking the local maxima of K2:0 (ro° along wall-parallel lines. Note that only one of 
the ridges is connected to the wall. Also shown are tretnches (blue) and zero level sets (black) 
of K0:0(ro°. The lower plots in Fig. 6.19 show the evolving off-wall and on-wall material 
backbones B(t° of the material spikes, which merge towards a single separation spike.
The more recent study of Klose et al. (2020a) shows examples of how the Lagrangian 
backbone of separation evolves over time into the asymptotic fixed separation profile (see

270
Flow Separation and Attachment Surfaces as Transport Barriers
0.15
0
0.15
0
0.15
t = 0.05
0.1
0.1
0.1
0.05
0
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
1.1
x/c
Figure 6.20 Evolution of unsteady separation in the flow past a cambered NACA 
65(1)-412 airfoil for increasing time. Shown are the Lagrangian backbone of sepa­
ration (magenta), the fixed unsteady separation profile (green), the backward FTLE 
field (color plot) and the evolving, initially wall-parallel material lines (black). Image 
adapted from Klose et al. (2020a).
0.05
0.05
8
6
4
2
0
8
t = 0.1
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
1.1
x/c
§6.2.1), which then turns into an attracting LCS in larger distances from the wall. Figure 
6.20 shows these three material elements of unsteady separation and their relationship in the 
direct numerical simulation of an airfoil.
Objective Eulerian Spiking Points in Unsteady Separation
Just as OECSs serve as objective instantaneous limits of LCSs (see §5.7), material spike 
formation from a Lagrangian spiking point also has an objective instantaneous Eulerian limit. 
Specifically, the Eulerian backbone of separation is an evolving curve B(t° of locations at 
which wall-parallel material lines experience the largest rate of curvature change at time t . 
An Eulerian spiking point is then the intersection of the Eulerian backbone of separation 
with the no-slip wall.
The Eulerian backbone B(t° can then be computed as a height ridge (see §A.2) of the 
Eulerian curvature rate function
*t(r° := 
Kt+T(r
d
= hJr0; (rS(r; t °r0° r0i - 2 hW>(r; t ), r0i = -Vxx (X; y>, t ),

6.2 Unsteady Flow Separation Created by LCSs
271
computed for instantaneously wall-parallel material lines (see Klose et al., 2020b). As Serra 
et al. (2018) point out, an Eulerian spiking point sE = (xs(t°, 0° is simply the instantaneous 
limit of a Lagrangian spiking point characterized by formula (6.54), and hence obeys the 
relations
vxxxyy (xs (t°, 0, t° = 0, 
vxxyy (xs (t°, 0, t° < 0, 
vxxxxyy (xs (t°, 0, t° > 0: 
(6.56)
As expected, therefore, the Eulerian spiking points coincide with the Lagrangan spiking 
points in steady flows.
Eulerian backbones connecting to a wall at an Eulerian spiking point are objective instan- 
tneous sigatures of wall-based separation, hereas Eulerian backbones wth no connection 
to the wall are objective instantaneous signatures of off-wall separation. As an example, Fig. 
6.21 shows two Eulerian backbones signaling off-wall separation in an unsteady separation 
bubble flow studied by Serra et al. (2020a).
Figure 6.21 (Left) 3D image of two height ridges of the curvature rate field Kt(r) 
in a 2D unsteady separation bubble flow. (Right) The ridges shown in red in the 
(x, y°-plane, with their connection to the wall marking the Eulerian spiking points of 
on-wall separation. Image adapted from Serra et al. (2020a).
x
6.2.2 3D Fixed Unsteady Separation
The averaging approach used by Kilic et al. (2005) for 2D unsteady flows, described in 
§6.2.1,extends to separation in mass-conserving 3D unsteady flows with a no-slip boundary. 
Specifically, consider a mass-conserving, 3D unsteady velocity field
= v(x, z, t° =
u(x, z, t° 
w(x, z, t°
u(x, y, z, t° 
v( x; y; z; t ° 
w(x, y, z, t°
(6.57)
with a no-slip boundary at z = 0, and assume that the velocity field has a well-defined steady 
asymptotic mean
u (x; z ° 
1 
t0
v(x; z° = 
:= lim 
v(x; z; t° dt
w (x; z° 
T!1 T t0 T
(6.58)
over the time interval (-1; t0].
As in the case of temporally periodic and quasiperiodic velocity fields (§6.1.4), the theorem 
of averaging can be applied near the wall to transform the ODE (6.57) locally to a slowly 

272
Flow Separation and Attachment Surfaces as Transport Barriers
varying flow that is steady at leading order. In particular, a local nonlinear coordinate change, 
(x, z° ! C = (£, e^° with e ^ 1, near the z = 0 no-slip wall transforms the velocity field to 
the form
C = ef0(C° + e2f1(C; t) + O (e3) .
For incompressible flows, the leading-order term in this expansion can be written as
C = ef0(C) = e {
W z (£,0° 
\
-72@z rx ■ u(& 0°
(6.59)
(6.60)
while the general form of f0(C° for compressible flows is given by Surana et al. (2008).
Therefore, as in §6.1.4,a leading-order identification of separation lines on the z = 0 
boundary can be carried out using the averaged wall shear field
x0 = u z (x, 0° = — T (x°, 
(6.61)
with T(x° denoting the steady mean component of the skin friction identified from asymptotic 
averaging, as inEq. (6.58).Again, the pointwise normal attraction rate of the averaged skin 
friction lines on the wall can be computed as
—S?(x,
h!wall(x°, rxT(x°<!waU(x)>
pV j!wall(x°j
(6.62)
with !Jwall denoting the asymptotic time-average of the wall vorticity field !(x, 0, t). 
Using the leading-order averaged wall-normal stretching rate,
C(x° = lim — @ @z rx ■ u(x, 0, t) dt, 
(6.63)
T!1 T t^^
Surana et al. (2008) obtain a generalized version of the fixed unsteady separation results 
described in §6.1.4. Specifically, if a heteroclinic trajectory y of T(x) falling in one of the 
categories (S1)-(S4) shown in Fig. 6.9 satisfies the pointwise conditions
S?(x° - C(x) < 0, C(x° > 0, 
x 2 y,
(6.64)
then y is a fixed separation line for a time-dependent separation surface M (t° in the full 
velocity field (6.57). Surana et al. (2008) also obtain a leading-order linear approximation to 
M (t° in the present context. Higher-order approximations to the separation surface M (t° can 
be obtained from higher-order asymptotic averaging of the slowly-varying ODE, as noted for 
the 2D case in §6.2.1.
As an example, Fig. 6.22 shows the leading-order unsteady separation surface (green) 
identified by the criterion (6.64) in a particular realization of a stochastic velocity field.
This velocity field represents a mean-zero, random perturbation to a 3D separation bubble 
model derived by Surana et al. (2006) as an approximate solution of the Navier-Stokes equa­
tion. Figure 6.22 shows the time-varying skin friction field, with some general instantaneous 
skin friction lines (red) and instantaneous heteroclinic skin friction lines (black and blue). 
The actual separation line is a set of two saddle-focus connections (type (S1) in Fig. 6.9) in 
the averaged skin friction field t(x°; these connections satisfy the pointwise criteria (6.64). 
Nearby trajectories of the stochastic velocity field (black) confirm the first-order approxima­
tion (green) to the separation surface.

6.3 Summary and Outlook
273
t= 103
t=55
t = 215 
t= 249
Figure 6.22 Fixed unsteady separation, identified from the criteria (6.64), in a ran­
dom separation bubble model. The approximate separation surfaces and nearby tra­
jectories are shown at four different time instances. Adapted from Surana et al. (2008).
We close by noting that the full separation surface M(t° is a material surface and hence 
cannot be crossed by trajectories of the velocity field. The reason for the intersections seen in 
Fig. 6.22is twofold. First, only the first-order approximation to M(t° is shown. Second, the 
full trajectories are shown together with the current instantaneous position of the approximate 
separation surface. As a consequence, past trajectory positions may coincide with points on 
the current M(t°.
6.3 Summary and Outlook
In this chapter we have surveyed the kinematic theory of flow separation, which builds on 
the advective transport barrier concepts of Chapter 5.While flow separation from the solid 
boundary of a 2D steady, incompressible flow has been well understood since the seminal 
work of Prandtl (1904), unsteady separation is still the subject of ongoing research.
Material spike formation near the boundary of an unsteady flow has traditionally been 
attributed to the development of a singularity in the boundary layer equation, but physical 
flows have no such singularities. Instead, material spikes form along attracting LCSs that 
collect and eject fluid from a vicinity of the boundary into the main stream. Similarly, flow 
reattachment is caused by repelling LCSs that lead particles back towards the boundary and 
then repel them in different directions along the boundary. Flow separation is, therefore, 
arguably a transport process whose barriers are the separation and reattachment profiles 
observed in tracer, dye and smoke experiments.

274
Flow Separation and Attachment Surfaces as Transport Barriers
The objectivity of attracting and repelling LCSs makes them ideal for framing the ex­
perimentally observed persistent material barriers of separated flows. Specifically, on-wall 
separation involves repelling LCSs whose point of emanation on the boundary can be com­
puted from the time-resolved wall shear and wall pressure measurements. These LCSs are 
hyperbolic for free-slip boundaries, but they are also structurally stable along no-slip bound­
aries despite the loss of their hyperbolicity at the wall. Off-wall separation is generically 
caused by repelling LCSs that can be located from velocity data via the techniques of 
Chapter 5.
For separation control and monitoring purposes, an early recognition of material spike 
formation and deformation is essential. We have discussed how hyperbolic OECSs can be 
efficiently used in tracking both off-wall and on-wall separation, including the birth, merger 
and annihilation of separation and reattachment profiles. These OECSs comprise locations 
of the largest instantaneous curvature change. The on-wall limits of these points are Eulerian 
spiking points that mark the initial upwelling locations that later develop into material spikes.
Three-dimensional unsteady separation continues to pose a challenge for LCS and OECS 
methods. We have discussed here a complete, LCS-based theory of fixed separation for 
steady flows and unsteady flows with a well-defined asymptotic mean. A theory of moving 
separation and techniques for the short-term tracking of separation and reattachment via 
OECSs, however, is yet to be developed.

7
Inertial LCSs: Transport Barriers in Finite-Size Particle 
Motion
In this chapter, we will be concerned with barriers to the transport of inertial (i.e., small but 
finite-size) particles in a carrier fluid. Such barriers are ubiquitous in nature, as illustrated by 
Fig. 7.1,which shows a cylindrical transport barrier surrounding what is informally known 
as a landspout.1
1 Unlike regular tornados that drop down from a storm cloud, landspouts form out of spinning air near the ground.
Figure 7.1 A landspout (or dust devil) in western Kansas in 2008. Image: Jim 
Reed/Jim Reed Photography (used with permission).
Also known as dust devils, landspouts collect and transport dust particles upwards in a 
motion that generally differs from the motion of the ambient air. As a general rule, the more 
the density of inertial particles diverts from the carrier fluid density, the more they tend to 
depart from fluid trajectories. Specifically, while small enough neutrally buoyant particles 
often remain close to fluid motion, the same is not true for heavy particles (aerosols) and 
light particles (bubbles).
Practical flow problems involving inertial particles tend to be temporally aperiodic and 
hence the machinery of LCSs discussed in Chapter 5 is also highly relevant for inertial 
particles. By inertial LCSs (or iLCSs, for short), we here mean coherent structures composed 
of distinguished inertial particles that govern inertial transport patterns. In contrast, LCSs
275

276
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
(composed of distinguished fluid particles) govern fluid transport patterns. The purpose of 
this chapter is to examine how iLCSs differ from LCSs of the carrier fluid.
7.1 Equation of Motion for Inertial Particles
The broadly observed inertial accumulation and scattering patterns already suggest that the 
velocity,
X p = vp;
(7.1)
of a small inertial particle of density pp will differ from the velocity v(xp(t°; t° of the carrier 
fluid of density p at the inertial particle location xp (t° 2 Rn, where n = 2 or 3. Indeed, for 
a spherical inertial particle of radius a, the particle velocity vp (t° satisfies the Maxey-Riley 
equation (Maxey and Riley, 1983;Babiano et al., 2000;Henderson et al., 2007;Langlois 
et al., 2015)
Dv(xp; t°
Pp vp = P Dt
+ (Pp - P) g
9vp
2a
a 2 K 1
vp - v - 6~ Av
6 
X=Xp (t)
P v - D
2 Vp Dt
2
a2
v+10 Av
X=Xp (t°
2
v + 6 Av
x=xp (to°
p t - 10
(7.2)
Here, is the kinematic viscosity of the fluid, g denotes the constant vector of gravity and t0 
is the time of release of the inertial particle from its initial position xp (10). The five terms on 
the right-hand side of the equation represent the following effects in order: the force exerted 
on the particle by the undisturbed fluid; the buoyancy force; the Stokes drag; the added mass 
of the fluid moving with the particle; and the Basset-Boussinesq memory term accounting 
for the lagging boundary layer around the spherical particle. The derivation of Eq. (7.2) 
assumes that the associated Stokes and Reynolds numbers are small and the particle does 
not modify the ambient velocity field v(x; t°. Under further assumptions, some of the terms 
on the right-hand side of Eq. (7.2) can be justifiably ignored (see Michaelides, 1997). Most 
frequently, the Fauxen correction terms of the form a2Av are ignored for small particles 
(a 1). A more general version of the equation due to Henderson et al. (2007) also includes 
a lift force on the particle due to its rotation while it moves in a horizontally sheared flow 
(see also Beron-Vera, 2021,for more analysis under the inclusion of that term).
Laboratory experiments involving neutrally buoyant particles indicate that the Maxey- 
Riley equation (7.2) gives an overall accurate description of inertial particle motion except 
for some randomly correlated velocity fluctuations, which can be modeled via additive 
colored noise (see Sapsis et al., 2011b). Other modifications to the original Maxey-Riley 

7.2 Relationship between Inertial and Fluid Motion
277
equations are required to explain prominent clustering phenomena in the ocean, such as the 
formation of the Great Pacific Garbage Patch shown in Fig. 1.6. These modifications involve 
the addition of the Coriolis force, windage and shape effects, as shown by Beron-Vera et al. 
(2019a); Beron-Vera (2021), which we will discuss in more detail in §7.8.
Technically speaking, the Maxey-Riley equation (7.2) is a second-order, implicit integro­
differential equation with a singular kernel and with a forcing term that becomes singular at 
time t0 . The equation does not define a classical dynamical system: the future evolution of the 
particle velocity vp (t° for t > 11 > 10 is not determined uniquely by vp (11°. Rather, the entire 
history of the particle after the release time t0 will influence its evolution due to the Basset- 
Boussinesq memory term. For this reason, classic ODE solvers are not applicable for solving 
the equation numerically and hence more advanced solvers for differential equations with 
memory have to be employed (Alexander, 2004; Daitche, 2013; Daitche and Tel, 2014). Even 
the existence of well-posed solutions was unclear until Farazmand and Haller (2015) proved 
the existence, uniqueness and regularity of local mild solutions for Eq. (7.2).2 They also 
2
2 Mild solutions are solutions to the integral equation obtained by integrating both sides of Eq. (7.2) with respect 
to time.
showed that only under the unphysical assumption of vp(10° = v(xp(10°; 10° + a- Av(xp(10°; 10° 
doesEq. (7.2) admit strong (i.e., differentiable) solutions. Langlois et al. (2015), in turn, 
showed the global existence of mild solutions to the Maxey-Riley equation. More recently, 
Prasath et al. (2019) showed that in the absence of the Fauxen correction terms, the buoyancy 
force and the added mass term, Eq. (7.2) can be viewed and, in come cases explicitly solved, 
as a one-dimensional heat equation with nontrivial boundary conditions.
In principle, the Maxey-Riley equation describes the motion of an individual particle, 
but its trajectories starting from different initial conditions can be viewed as a multitude 
of particle tracks evolving simultaneously in the flow. This view is justified as long as the 
assumptions underlying the derivation of Eq. (7.2) are appended with the requirement that 
the simultaneously evolving particles do not interact with each other. At an advanced state, 
particle clustering will eventually violate this assumption but the Maxey-Riley equation can 
still be used to predict features of inertial particle dynamics away from tight clusters of such 
particles.
7.2 Relationship between Inertial and Fluid Motion
Specific predictions for inertial particle motion can either be carried out numerically (see, 
e.g., Benczik et al., 2002;Daitche and Tel, 2014) or analytically in the limit of small Stokes 
numbers, i.e., for
St = 2 (|)2 Re ^ 1; 
(7.3)
with L denoting the characteristic length scale of the fluid flow and Re denoting the Reynolds 
number. In this limit, the system of equations (7.1)-(7.2) admits two different time scales: 
the particle velocity vp (t° varies much faster than the particle position xp (t°. This duality of 
time scales in the two equations allows the application of techniques from geometric singular 
perturbation theory (Fenichel, 1979;Jones, 1995).

278
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
In particular, as discussed for two specific 2D, steady velocity fields by Rubin et al. (1995) 
and Burns et al. (1999), the 2n-dimensional set of equations (7.1)-(7.2) can be reduced to 
a slow manifold, i.e., an attracting, n-dimensional invariant manifold in the 2n-dimensional 
phase space of the dynamical system formed by these equations. Mograbi and Bar-Ziv (2006) 
outlines this approach for general steady velocity fields v(x). Angilella (2007) gives a formal 
expansion method for weakly unsteady, 2D flows that is also equivalent to a reduction of Eqs. 
(7.1)-(7.2) to a 2D, weakly unsteady slow manifold.
To discuss this reduction for general unsteady velocity fields, we consider a general 
unsteady carrier velocity field v(X; t ), known in a compact spatial domain De Rn over a 
finite time interval»t0; t1]. Using non-dimensionalized positions, velocities and time, as well 
as the non-dimensional numbers
R=
St = 9 (L)2 Re
R R
(7.4)
2 P
P + 2 Pp ’
we rewrite Eqs. (7.1)-(7.2) without the Fauxen corrections and the memory term as the 
system of ODEs,
xp = vp;
eVp = v(Xp,t)- vp + eX + e [1 - 3R| g,
(7.5)
in which a duality of times scales is clearly seen.3 We note that for neutrally buoyant particles 
(i.e., for p = pp), we have R = 2/3 and hence the last term in the system of ODEs (7.5) 
vanishes.
Introducing a new, slow time via the notation
6T = t - 10; 
( )0 := 
( ); 
(7.6)
d
we can further rewrite Eq. (7.5) as a (2n + 1°-dimensional autonomous ODE of the form
x0
p 
t0
evp;
v0p
3 RD v(Xp, t ) 
v(xp, t)- vp+e - — + e [1 - ^1 «■
2 *
(7.7)
This system represents a small regular perturbation of its frozen-time limit,
x0p = 0;
t0 = 0;
v'p = v(Xp; t°- vp;
which has an (n + 1°-dimensional manifold of fixed points, or critical manifold, 
M0 = {(xp,t;vp) 2 D xRxRn: vp = v(xp,t°} .
(7.8)
(7.9)
As the variables (xp(t); t(t)) = (xp0; 10° are frozen parameters in the system (7.8), the 
last equation in this system decouples and the stability of M0 can be analyzed simply as the 
3 In our notation, DvDp;t° = @t v(Xp; t) + rv(Xp; t)v(Xp; t) denotes the material derivative of the fluid velocity 
along fluid trajectories, but evaluated at the inertial particle positions xp .

7.2 Relationship between Inertial and Fluid Motion
279
stability of a fixed point in the ODE vp = v(xp0; t0° - vp. The Jacobian of this autonomous 
ODE at such a fixed point is just
@Vp [v(xp0; t0° - vp ] Vp =v(xp0 ;t0° = -I; 
(7.10)
and hence M0 attracts all trajectories of the frozen-time system (7.8) exponentially fast, as 
shown in Fig. 7.2. In dynamical systems terms, this exponential attraction renders M0 a 
compact, normally hyperbolic critical manifold. By the classic results of Fenichel (1979), 
this invariant manifold will smoothly persist for small > 0 in the form of a nearby slow 
manifold, Me; in the slow-time version (7.7) of the Maxey-Riley equations (see Fig. 7.2).
e = 0
Figure 7.2 (Left) The attracting critical manifold Mo of the frozen-time (e = 0) limit 
(7.8) of the maxey-riley equation. (Right) The nearby attracting slow manifold M 
for e > 0 for the full Maxey-Riley equation (7.7).
e > 0
Haller and Sapsis (2008) compute a Taylor expansion Me in terms of the small parameter 
e > 0 to obtain the approximation
M
(xp; t; vp) 2 D x R x Rn: vp = v(xp; t° + e 13^ - 1
DvDpzi _ g]+O (Z. )J:
(7.11)
They also find that, in terms of the original physical time t , the reduced dynamics on M are 
governed by the inertial equation
xp = vin(xp; t; e° := v(xp; t° + ev1 (xp; t° + ev2(xp; t° + ■ ■ ■ ;
(7.12)
where the functions vk can be computed recursively as
v1 =
vk =
3 R
T - 1
D vk 1 
' Dt
Dv
IDT ■ T
+ (rv° vk-1
k-2
+ X^rvl) vk~l~1
l=1
k> 2:
(7.13)
Therefore, all trajectories of the maxey-riley equation converge to the slow manifold M 
exponentially fast and synchronize with the reduced flow on M generated by the inertial 
equation (7.12).

280
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
7.3 The Divergence of the Inertial Equation and the Q Parameter
The inertial equation (7.12) enables us to view the velocity field governing the motion of 
small inertial particles as a small perturbation to the carrier velocity field. Using the identity 
r v 0 as well as the identity
@ Vi @ vj 
@ x j @ xi
@ @Vi + @vj \ 2
@xj 
@Xi
2
@ @Vi _ @vj \ 2 
@Xj 
@Xi
(7.14)
with summation implied over repeated indices, we find that the divergence of the inertial 
velocity field vin(X; t; e° is equal to
r ■ Vin(X; t; e° = e {3R - 1 j r ■ Dv + O (e2) = e { 3R - 1 j r ■ »(rv° v] + O (e2) 
3R
2
-2- -1 rv. rv + o (e2)
= e (2 - -R° Q(X; t° + O (e2);
(7.15)
where Q = 2 [||W||2 - ||S||2] is the second invariant of rv that we have already encountered 
in §3.7.1(see Maxey, 1987 and Oettinger et al., 2018).
By formula (7.15), therefore, the inertial velocity field vin(X; t; e° typically has nonzero 
divergence and hence can produce the type of inertial clustering and scattering patterns that we 
mentioned at the beginning of this chapter. An exception arises, however, for neutrally buoyant 
particles (R = 2/3), also called suspensions. For such particles, not only does the leading­
order divergence of vin(X; t; e° vanish in Eq. (7.15), but we obtain vin = v from the recursive 
definition in Eq. (7.13).Therefore, the inertial velocity field of a suspension coincides with the 
incompressible ambient fluid velocity field. This implies that characteristically compressible 
flow patterns cannot arise for neutrally buoyant inertial particles. In contrast, the inertial 
velocity fields of aerosols (0 < R < 2/3) and bubbles (2/3 < R < 2° will generally show 
compressible patterns (clustering or scattering), as we will see in §7.6.
Material patterns formed by (material) inertial particles must be indifferent to the observer, 
which follows from our general discussion in Chapter 3.As a consequence, the main classifier 
of the nature of these patterns, r . vin, must be objective. This expectation is in apparent 
contradiction with our finding that the leading-order divergence of the inertial velocity field 
vin in formula (7.15) is completely determined by the Q(x; t° parameter, a nonobjective 
quantity when associated with the velocity field v(x; t °, as we noted in §3.7.1.
The resolution of this paradox is that e (2 - 3R° Q(x; t° only arises as the leading-order 
term in the divergence r ■ vin in the inertial frame in which the Maxey-Riley equations (7.5) 
are valid. In other frames, the Maxey-Riley equations will change and the leading-order term 
in the otherwise objective scalar field r ■ vin (see Eq. (3.18)) will no longer be equal to 
e (2 - 3R° Q(X; t° defined via the transformed fluid velocity field v. This leading-order term, 
however, can still be computed to equal e (2 - 3R° Q(X; t°, using the representation v of the 
velocity field in the inertial frame (see Eq. (A.49) of Appendix A.10). We stress that only the 
observer is transformed in these arguments: the fluid motion and the inertial particle motion 
are physically unaffected by these observer changes.

7.4 Transport Barriers for Neutrally Buoyant Particles
281
7.4 Transport Barriers for Neutrally Buoyant Particles
For neutrally buoyant particles (R = 2/3), the second equation in system (7.5) can be 
rewritten as
vp - @tv -(Vv) v = -u (v - Vp); u := 1: 
(7.16)
As first noted by Babiano et al. (2000), this form enables recasting the Maxey-Riley equations 
(7.5) as
4 (vp - v (xp; t)) = - [rv (xp; t)+^i] (v (xp; t) - vp);
dt 
d 
(7.17)
dt xp 
vp:
Therefore, the critical manifold M0 defined inEq. (7.9)remains an invariant manifold 
ME = M0 for neutrally buoyant particle motion for any value of u 1 1 /e, as we see by the 
direct substitution of the definition (7.9) into Eq. (7.17).Using the coordinate
z = vp - v (xp; t) 
(7.18)
transverse to M0, the system of equations (7.17) can be rewritten as
z = - [rv (xp; t) + uI] z; 
xp = z + v (xp; t) :
(7.19)
In this dynamical system, therefore, the invariant manifold M0 appears as the z = 0 
invariant subspace. Within this subspace, we obtain xp = z + v(xp; t) from Eq. (7.19), which 
means that inertial particle motion coincides exactly with the motion of fluid particles along 
M0 . Therefore, in spatial regions where the z = 0 plane is is locally attracting, nearby inertial 
particles with vp , v will synchronize with fluid trajectories. Likewise, in spatial regions 
where the z = 0 plane is locally repelling, inertial particles with vp , v will further depart 
from fluid particle motion.
Sapsis and Haller (2008) show that the local attraction to, or repulsion from, the z = 0 
invariant plane at a point xp at time t is governed by the smallest eigenvalue of the symmetric 
tensor S (xp; t) + uI; with S denoting the rate-of-strain tensor of the carrier velocity field (as 
defined in Eq. (2.1)). Specifically, Sapsis and Haller (2008) obtain the following partition of 
the flow domain:
Amin »S(x; t° + uI] < 0; 
=) 
instability: inertial particles leave fluid trajectories;
min »S(x; t ° + uI] > 0; 
=) 
stability: inertial particles approach fluid trajectories:
(7.20) 
For small inertial particles (u » 1), we have Amin »S(x; t° + uI] ~ Amin»uI] = U > 0, 
and hence small enough inertial particles always synchronize exponentially fast with fluid 
particle motions (as we have already concluded from formula (7.10)). As the particle size 
increases, however, the tensors S(x; t° and uI become of comparable magnitudes, and hence 
Amin »S(x; t° + uI] may take negative values. Sapsis and Haller (2008) propose such negative 
values as an explanation for the sustained scattering events that Babiano et al. (2000) observe 
numerically for neutrally buoyant particle motion. For 2D inertial particle motion, the stability 
criterion in the partition (7.20) can be specifically written as
u > V jdet S(x; t)|.
(7.21)

282
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
Figure 7.3 shows an illustration of this criterion on a kinematic model of Jung et al. (1993) 
for the 2D unsteady wake flow behind a vertical cylinder.
Figure 7.3 Convergence of three neutrally buoyant particles to the manifold M0 , 
defined inEq. (7.9), in a 2D model of Jung et al. (1993) for the unsteady wake behind 
a cylinder. For two of the particles, the convergence over the domain of stability of 
M0 (shown in blue) is interrupted by temporary ejection from M0 inside the domain 
of instability (shown in shades of red) violating the criterion (7.21). Adapted from 
Sapsis et al. (2011a).
This analytic model flow is calibrated to be close to the corresponding numerical Navier- 
Stokes solution at Reynolds numbers Re 250. Figure 7.3 shows the critical manifold M0, 
with the part of M0 satisfying the stability criterion (7.21) colored in blue. The inset shows 
M0 in the coordinate system (x; y, |z|) in which M0 becomes flat. The part of M0 violating 
the stability criterion is colored in shades of red and is bounded by a closed black curve. 
Three inertial particles (marked in white, green and yellow) with the same non-dimensional 
mass parameter e = 1/u = 10“2 are released from the gray flow domain with the same 
initial velocity but with slightly different initial positions. The release location satisfies 
the stability condition (7.21), therefore the particles initially approach M0 exponentially 
fast, synchronizing their motion with fluid particle motions. The white particle stays in 
the flow domain satisfying the stability criterion (7.21), which results in its uninterrupted 
synchronization with the fluid particle motion. In contrast, the green and the yellow particles 
stray into the region of instability, where condition (7.21) is violated. Accordingly, the latter 
two particles temporarily desynchronize from fluid particle motions, manifested by their 
ejection from a vicinity of the manifold M0. Once they leave the instability domain, however, 
these two particles resume their convergence to M0 and hence resynchronize their motion 
with fluid particle motion exponentially fast.
More generally, for neutrally buoyant particles traveling in flow domains satisfying the 
stability criterion (7.20), iLCSs coincide with fluid LCSs after a very short initial syn­
chronization time. In spatial domains violating the criterion (7.20), fluid LCSs loose their 
governing role. In these domains, iLCSs can still be computed by applying the LCS tech­
niques we developed in Chapter 5 to the flow map of Eq. (7.19) restricted to the z = 0 
plane.

7.5 Transport Barriers for Neutrally Buoyant Particles with Propulsion 283
7.5 Transport Barriers for Neutrally Buoyant Particles with Propulsion
Peng and Dabiri (2009) propose a general model for the motion of small inertial particles 
with self-propulsion. They specifically develop this model to study the feeding of jellyfish 
on its prey. The models describes how the prey, such as copepods, try to swim away from 
capture by working against the velocity field created by the jellyfish to drive the prey closer.
Microscopic aquatic animals are neutrally buoyant, thus the Peng-Dabiri model can be 
rewritten as a modification of Eq. (7.5) in the form
xp = vp;
Dv(xp;t° 
v(Xp;t° 
(7.22)
evp = v(x„; t° - v„ + e 
- eae 
.
p ( p ° p D 
‘ |v(Xp; t)|
Here the last term models the small escape velocity of the prey, always reacting with a 
propulsion opposite to the local velocity field created by the jellyfish to stir the prey towards 
itself for feeding. The coefficient ae 0 characterizes the strength of the escape force that 
the prey is able to generate.
Repeating the slow-manifold reduction procedure of §7.2 for the augmented Maxey-Riley 
equation (7.22),Sapsis et al. (2011a) find that the slow manifold M in this model does 
not coincide with the critical manifold M0 for a > 0, even though the inertial particle is 
neutrally buoyant. The general formula (7.11) for M, however, is still applicable and yields 
the expression
Me = (xp; t; vp) 2Dx R x Rn: vp = v(xp; t °- e a e |v(xp; t ° + O (e2) 
. 
(7.23)
|v(Xp; t°|
Restriction of the full equation (7.22) to the manifold (7.23) gives the leading-order reduced 
dynamics in the form
v(xp; t°
Xp = ve(xp; t; e° = v(xp; t° - eae —------ --; 
(7.24)
|v(xp; t °|
with the escape velocity ve(xp; t; e° containing the leading-order terms in prey velocity vp.
The local stability analysis of the slow manifold M can be carried out using the normal 
infinitesimal Lyapunov exponent (NILE) analysis of Haller and Sapsis (2010). This analysis 
generalizes the calculations we have outlined in §7.4 from flat invariant manifolds to general 
curved manifolds. Using the NILE, Sapsis et al. (2011a) obtain the stability criterion
min Se(x; t; e° + 11 + O(e2 
e
^min Se(x; t; e° +----I + O(e2
< 0;
> 0;
instability relative to inertial equation;
stability relative to inertial equation;
(7.25)
with the rate-of-strain tensor Se = 1 [rve + (rve °T] computed from the leading-order 
escape velocity ve(x; t; e). In stable flow domains satisfying the second inequality in criterion
(7.25), prey dynamics will synchronize exponentially fast with the inertial equation (7.24). 
In contrast, in domains of instability defined by the first inequality in criterion (7.25), prey 
dynamics will depart from the dynamics of the inertial equation.

284
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
Figure 7.4(a)shows a snapshot of the experiment used to reconstruct a time-resolved 
velocity field from particle-image velocimetry (PIV) near a swimming jellyfish, with a 
snapshot of the reconstructed velocity field shown in Fig. 7.4(b). Figure 7.4(c) shows the 
repelling and attracting iLCS computed from the leading order inertial equation (7.24).
Forward FTLE
Backward FTLE
Figure 7.4 (a) A snapshot of the jellyfish in the experiments of Peng and Dabiri 
(2009). (b) The 2D instantaneous velocity field near the animal, with colors indicating 
the vorticity. (c) Repelling and attracting iLCS highlighted as ridges of the forward 
and backward FTLE fields, respectively, computed from the leading-order inertial 
equation (7.24).The prey size parameter is set to = 0:6. Adapted from Sapsis et al. 
(2011a).
Attracting iLCSs, marked by ridges of the backward FTLE field, tend to delineate the 
shape of the jellyfish. Repelling iLCSs, in contrast, are expected to act as local dividers 
between escape and capture for the prey, repelling copepods towards the jellyfish on one of 
their sides and away from the jellyfish on their other side. This expectation is confirmed by 
the original experiments of Peng and Dabiri (2009).
The repelling iLCS, however, are only relevant barriers for prey capture at locations where 
the slow manifold M is stable, i.e., the second inequality in criterion (7.25) holds. Figure 7.5 
Figure 7.5 Three snapshots of materially evolving attracting (red) and repelling 
(green) iLCSs, extracted as backward and forward FTLE ridges from the jellyfish 
experiment shown in Fig. 7.4(a).Shaded blue regions show regions in which the 
instability criterion (7.25) is satisfied and hence the iLCSs lose their transport barrier 
role in the prey dynamics. Unshaded regions indicate regions of stability in which the 
computed iLCS become relevant barriers for the prey motion. Adapted from Sapsis 
etal. (2011a).

7.6 Transport Barriers for Aerosols and Bubbles
285
shows three snapshots of the materially evolving hyperbolic iLCSs. White dots mark present 
positions of (yellow) trajectories of the inertial equation (7.24),while blue dots mark present 
positions of (black) trajectories of the full Maxey-Riley equations (7.22). All thir^e tt jjecOory 
pairs are launched from unstable parts of the capture region inside the domain surrounded 
by the repelling iLCS. Two of the blue particles cross the repelling iLCS and hence escape. 
In contrast, the white particles stay in the capture region and align with an attracting iLCS 
after entering the domain of stability (unshaded region).
7.6 Transport Barriers for Aerosols and Bubbles
For aerosols (0 < R < 2/3) and bubbles (2/3 < R < 2°, unlike for neutrally buoyant 
particles, the critical manifold M0 defined in Eq. (7.9) does not remain an invariant manifold 
in the maxey-riley equation (7.5) for > 0. A nearby slow manifold M of the form (7.11) 
nevertheless exists, and hence aerosols and bubbles will also synchronize exponentially fast 
with trajectories of the inertial equation (7.1).The inertial velocity field vin, however, no 
longer agrees with the fluid velocity field, with the leading order difference between the two 
given by the generally compressible term, ev1 = e 3R- - 1) [D - g].
As for the case of self-propelling inertial particles in §7.5,the leading-order local stability 
analysis of the slow manifold M can again be performed using the nile. Specifically, Haller 
and Sapsis (2010) obtain the stability criterion
min S(X; t ° + 11 + O(e 
e
< 0;
min S(X; t ° + 11 + O(e 
e
> 0;
instability relative to inertial equation;
(7.26) 
stability relative to inertial equation:
Therefore, the stability boundaries obtained for the synchronization of bubbles and aerosols 
are O(e° close to those deduced from the neutrally buoyant stability criteria (7.20). Here, 
synchronization is to be understood with respect to the general inertial velocity field 
xp = Vin(xp; t; e° := v(xp; t° + e (3R - 1) DvDtp’'° - g
+ O (e2);
(7.27)
as opposed to the fluid velocity field v.
While the global exponential attraction of the slow manifold helps in the prediction of 
the future behavior of inertial particles, it makes the backward-time simulation of inertial 
particles exceedingly difficult. This is due to the unavoidable exponential blow-up that the 
particles will experience in such backward-time simulations, resulting from the exponential 
growth of their velocities. At the same time, the backward simulation of inertial trajectory 
paths in the inertial equation (7.27) is free from any blow-up and enables an accurate 
identification of the particle release location. Information about the initial velocities of 
the particle is lost from such a simulation, but recovering initial velocities is generally 
unimportant in source inversion problems, in which the source of contamination from broadly 
spread dispersed particle positions is to be determined (see Tang et al., 2009, for an example)
As we have seen, hyperbolic, parabolic and elliptic LCSs are the three main types of 
barriers to advective transport in volume- or mass-preserving flows, both for the fluid and 

286 
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
for neutrally buoyant particles carried by the fluid. In contrast, the fundamental material 
patterns observed for aerosols and bubbles in such flows are formed by attracting iLCSs that 
create clusters of the type shown in Fig. 1.6. Unlike attracting LCSs in incompressible flows, 
however, attracting iLCSs are not bound to stretch and will generally be dissipative attractors 
of the inertial equation on the slow manifold M , as we will see next.
7.6.1 Attracting iLCS in 2D Steady Flows
For inertial particles carried by a 2D steady velocity field v(x), Haller and Sapsis (2008) 
derive a criterion that predicts clustering locations in terms of features of v(x). Specifically, 
they use the divergence formula (7.15) to obtain a criterion involving Q(x) for the existence 
of a limit cycle within the flow domain satisfying the stability condition (7.26). The idea 
behind this criterion is that the 2D flow region enclosed by the limit cycle is invariant under 
the flow and hence the integrated divergence of the inertial velocity field vin(x; e) must vanish 
on this region by Liouville’s theorem (2.38). To leading order, such an enclosed region can be 
approximated as a region enclosed by a closed trajectory 0 of the e = 0 limit of the inertial 
equation, i.e., by a closed streamline y0 of v(x). The divergence of vin(x; e) is available at 
leading order as e (3R/2 - 1° Q(x) from Eq. (7.15). A local stability analysis then yields an 
additional inequality that guarantees the attractivity of the limit cycle.
More specifically, let 0 R2 be a smooth, closed streamline of a 2D steady flow v(x°, 
with an outward unit normal vector n(x° at x 2 0 and with an interior int (0°. Haller and 
Sapsis (2008) obtain that inertial particles cluster on a limit cycle of the inertial equation that 
is O(e°-close to 0 if
Q 
Q(x) dA = 0; 
(2 - 3R)d) -QxJ- ds < 0; 
(7.28)
int(0° 
0 jv(x°j
where we have also used part of the formulation of Sapsis and Haller (2010). This criterion 
is valid both for aerosols (2 - 3R > 0) and bubbles (2 - 3R < 0). The formulas (7.28) 
generalize earlier work by Rubin et al. (1995), who were the first to tie the existence of a 
circular clustering pattern to a limit cycle in the inertial equation (7.27) for a specific steady 
flow. Haller and Sapsis (2008) also prove that center-type stagnation points of v(x) attract 
bubbles and repel aerosols, while saddle-type stagnation points of v(x) behave like saddle 
points for both aerosols and bubbles.
7.6.2 Attracting iLCS in 3D Steady Flows
In 3D steady flows, clustering of aerosols and bubbles is often observed along toroidal 
surfaces. Figure 7.6 shows an example of bubble clustering on a vortex ring in near-steady 
ocean waters.
Fora 3D steady, incompressible carrier velocity field v(x), Sapsis and Haller (2010) derive 
a necessary condition for the emergence of a toroidal attractor for small inertial particles. As 
in the 2D steady case discussed in §7.6.1, the idea is to find a toroidal streamsurface r0 c R3 
such that the volume integral of the leading-order divergence of the inertial velocity field 
vin(x; e) in Eq. (7.15) over the interior of r0 vanishes. This integral can in turn be expressed 
as the surface integral of e (32R - 1) r ■ Dv over r0 by the divergence theorem. Attractivity

7.6 Transport Barriers for Aerosols and Bubbles
287
Figure 7.6 Bubbles cluster near a vortex ring of the carrier fluid field in the ocean. 
Also visible is a small jellyfish captured and spun temporarily around the vortex.
Image: Photograph by Victor Devalles, https://victordevalles.com/.
of the invariant torus predicted in this fashion can be ensured by requiring the integrated 
leading-order divergence of vin(x; e° to change from positive to negative across the outward 
unit vectors n(x° along the torus. This ensures that slightly smaller smooth deformations of 
the surface r0 lying in its interior expand onto r0, and slightly larger smooth deformation of 
r0 shrink back onto r0.
Using these ideas, Sapsis and Haller (2010) show that small aerosols and bubbles cluster 
on a torus attractor of the inertial equation that is O(e°-close to an invariant torus r0 if
Dv 
Dv
■ n dA = 0; 
(3R - 2° r ■ n ■ n dA < 0: 
(7.29)
ib Dt 
'Jr0 Dt
This criterion is valid both for aerosols and bubbles, with 3R - 2 < 0 for aerosols and 
3R - 2 > 0 for bubbles. If the torus r0 is densely filled with quasiperiodic trajectories of 
v(x° and xqp(t° is one such quasiperiodic trajectory, then the attractor criterion (7.29) can be 
equivalently written as
(3R - 2° lim — 
t !1 T / |x qp( t °| 
0
■n
x=xqp(t°
■n
x=xqp(t°
dt = 0;
dt < 0:
(7.30)
Sapsis and Haller (2010) note that the necessary criteria (7.29)-(7.30) can be relaxed so 
that one only requires the functional
1 T 
Dv
C (x0° := (3 R - 2° lim- / |x qp( t )| — ■ n 
dt, 
X0 := Xqp (0° 
(7.31)
t!1 T 0 
Dt 
x=xqp(t°
to change its sign from positive to negative as x0 is moved outward across a toroidal stream­
surface r0.4 If v(x° is integrable (see §4.4.4) with a known first integral I(x°, then unit normals
4 Each toroidal streamsurface of v(x° filled with quasiperiodic trajectories is a level set for C(x0°. 

288
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
of such toroidal level surfaces can be computed as n(x) = V I(x)/|V I(x)|. If a first integral 
for v(x° is not known, then a numerically or experimentally constructed quasiperiodic tra­
jectory xqp(t° can be used to compute the unit normal of r0. The procedure in that case is to 
construct the unit normal n(xqp(t)) as the normalized cross product of xqp(t° with the vector 
6 (xqp (t)) = xqp (t + A) - xqp(t°; where xqp(t + A° a sufficiently close point on the same dense 
trajectory after a large enough time 1 has passed. This procedure is justified because 
6 (xqp (t)) will converge to a tangent vector of r0 for increasing A.
In addition to the toroidal iLCS, lower-dimensional attractors may also arise for the inertial 
equation (7.27).Specifically, any center-type stagnation point or center-type (elliptic) periodic 
orbit of v(x° surrounded by an open neighborhood with V ■ vin (x; e° < 0 is an attractor for 
bubbles.
Figure 7.7shows the implementation and verification of the criterion (7.30) for inertial 
particle motion in the (non-integrable) steady ABC flow (4.29). The quasiperiodic orbits 
xqp(t° were released in elliptic regions with a high density of invariant tori identified from the 
Poincare map defined for the z = 0 plane. The expression (7.31) was evaluated on a grid of 
initial conditions, but C(x0° only has a meaning for initial conditions leading to quasiperiodic 
trajectories. Attractors were then identified as zero level sets of C(x0° across which C(x0° 
changes sign from positive to negative in the outward direction. Figure 7.7(a) also shows 
two elliptic fixed points of the Poincare map surrounded by regions with V ■ vin(x; e° < 0. 
The elliptic periodic orbits that these points represent for v(x° are, therefore, attractors for 
bubbles. Direct numerical simulation of randomly released aerosols and bubbles confirm the 
analytic predictions in Fig. 7.7(b).
7.6.3 Attracting iLCS in 2D Time-Periodic Flows
Inertial clustering in a 2D time-periodic, incompressible velocity field, v(x. Qt°, can be 
deduced from the results we discussed for 3D steady flows in §7.6.2. To see this, we introduce 
the incompressible 3D extended velocity field, extended particle motion and extended gravity,
X = ( j ) = V(X° = ( V )• 
Xp = ( '■ ) = Vp = ( Qp )• G = ( g );
X p = Vp;
(7.32) 
respectively, as we did for quasiperiodic flows in §2.2.12. Using Eq. (7.5), we find that the 
extended quantities in system (7.32) satisfy the extended Maxey-Riley equation
i - 3R
eVp = V(Xp ° - Vp
3 RD V(Xp °
+ e~2 Dt
+e
G:
(7.33)
This is just the 3D steady version of the Maxey-Riley equations to which our clustering 
results from §7.6.2 apply directly. Specifically, the clustering criterion (7.30) can be applied 
to quasiperiodic tori (identified as closed invariant circles with dense orbits of the Poincare

7.6 Transport Barriers for Aerosols and Bubbles
289
C (xo) 
3R - 2
Figure 7.7 Inertial clustering of aerosols and bubbles in the ABC velocity field (4.29). 
(a) Predicted clustering locations for aerosols and bubbles based on the level curves 
of C(x0)/(3R - 2°. The Poincare map on the z = 0 plane is shown in the background, 
revealing two elliptic periodic orbits marking limit-cycle attractors for bubbles. (b) 
Numerical verification of the predicted clustering locations by simulated aerosols 
(red, with e (3R/2 - 1° = -0:01) and bubbles (green, with e (3R/2 - 1° = 0:01) in 
the full Maxey-Riley equations (7.5). Adapted from Sapsis and Haller (2010).
map of v(x; t°) to predict the location of toroidal attracting iLCSs. For the choice of the 
initial phase (0° = 0, the scalar field (7.31) used in the analysis takes the form
C(X0° = (3R - 2° lim ' [ J|Xqp(t°|2 + Q2 D- ■ n 
dt, 
X0 := Xq(0°; #0 = 0.
t!1T 0 
Dt 
x=xq(t°
(7.34) 
In addition, elliptic fixed points of the Poincare map that are surrounded by an open set with 
r Vin(X; e° = r-in(X; e° < 0 mark one-dimensional attracting iLCSs (limit cycles) for 
bubbles, as in the 3D steady case.
To illustrate these results, Sapsis and Haller ((010) consider a leading-order approximation 
for a time-periodically oscillating traveling wave solution in a horizontal channel with rigid 
boundaries at y = 0 and y = (Knobloch and Weiss, 1987;Samelson and Wiggins, (006). 
This (D time-periodic flow can be written as
X = v(x.Qt° = ( c - A sinkx cos y 7 ' sinQ' ), x 2 S■. y 2»0.^]. 
(7.35)
Ak cos k x sin y

290 
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
in a frame co-moving with the unperturbed wave ( = 0) that has amplitude A, horizontal 
wave number k and speed of propagation c. For the non-dimensional parameter configuration 
A = k = 1, c = 0:5, = 0:02 and = 1, the velocity field is a small time-periodic 
perturbation of a steady flow and hence its Poincare map is expected to have elliptic LCSs 
and KAM curves with dense orbits, representing elliptic periodic orbits and invariant tori 
for the full flow (see §4.1.2). Evaluating the function C(Xo° in Eq. (7.34)on a well-resolved 
grid of initial conditions, one obtains the level curves of C(Xo° as shown in Fig. 7.8(a). 
The predicted attractors for aerosols and bubbles are confirmed by numerical simulations in 
Fig. (.8(b),showing the asymptotic distribution of the two types of inertial particles released 
from a random grid.
Analytic prediction 
for attractor at bubbles
Analytic predcticn 
for attractor of aerosols
Figure 7.8 Inertial clustering of aerosols and bubbles in the periodically perturbed 
traveling wave flow ((..5) with A = k = 1; c = 0:5, = 0:02, and = 1. (a) 
Predicted clustering locations for aerosols and bubbles based on the level curves of 
C(Xo). The Poincare map on the z = 0 plane is shown in the background, revealing 
two elliptic periodic orbits that mark limit-cycle attractors for bubbles. (b) Numerical 
verification of the predicted clustering locations by simulated aerosols (red, with 
e (3R/2 - 1° = -0:01) and bubbles (green, with e (3R/2 - 1° = 0:01) in the full 
Maxey-Riley equation (7.5). Adapted from Sapsis mid Halter (2010).
7.6.4 Attracting iLCS in General 3D Flows
To find clustering locations in general .D flows, we consider a material volume B (t ; x0° 
evolving from an initial ball B (t0; x0° of radius centered at a point x0 on the slow manifold 
M of the maxey-riley equation. From Liouville’s theorem (2..8) and the divergence formula 
(7.15), we obtain
d
—vol Bs(t; xo° = 
r ■ vin(x; t; e° dV,
dt 
B(t;x0°
= e (2 - 3R)[ 
Q(X; t° dV + O (e2). 
(7.36)
B (t;x0°

7.6 Transport Barriers for Aerosols and Bubbles
291
qt0(x0; e) = e (2 - 3R) /
Therefore, the leading-order relative volume change for an infinitesimally small B6 (t0° over 
a time interval»10; 11] is given by the quantity
t1 
vol (B6(11; x0°° - vol (B6(10; x0°°
qt"(x0; e* = 6!---------vol (B6(to; xo»--------- •
= e (2 - 3R) f Q (Xp (t; t"• X"°• t) dt + O (e22) • 
(7.37)
t0
with xp (t; 10; x0° denoting the trajectory of the inertial equation (7.27) starting from position 
x0 at time t0. Note that by the smooth dependence of the trajectories of Eq. (7.27) on e (see 
§2.2.3), we have
Xp (t; 10; x0) = xp (t; 10; x0) + O (e2)
over the finite time interval»10; 11] for small enough e. Here, xp (t; 10; x0) denotes a trajectory 
of the truncated inertial velocity field
vin(X; t) = v(X; t) + e (3R - 1j DVDX’ t° - g ; 
(7.38)
starting from the same position as xp (t ; t0; x0° at the initial time t0 . Consequently, we have5
Q (xp (t; 10; x0°; t) dt + O (e2) . 
(7.39)
This last expression enables the computation of the main leading-order factor in the volume­
change ratio, qtt01 (x0; e°, in terms of the carrier fluid velocity v(x; t°, without a need for the 
inertial particle trajectories xp (t; t0; x0°. Specifically, Eq. (7.39) motivates us to define the 
Lagrangian-averaged Q (LAQ) scalar field as
1 t1 
(
LAQt0(x0) =--------  I Q xp (t; 10; x0); t dt 
(7.40)
t 1 - t0 t0
as a local, leading-order measure of the time-averaged infinitesimal volume change rate in the 
inertialequation (7.27).The quantity in Eq. (7.40) was apparently first employed by Maxey 
(1987) to study gravitational settling of aerosols. Oettinger et al. (2018) derived the same 
quantity to study iLCSs for all types of inertial particles.
Based on the expression (7.39) for the averaged volume change rate, we have the re­
lationship shown in Table 7.1 between the sign of LAQtt01 (x0° and the behavior of inertial 
particles.
Given our discussion in §7.3, LAQtt10 (x0° is tobe computed in the same (inertial) observer 
frame in which the Maxey-Riley velocity field was originally derived. In that particular 
frame, the (objective) leading-order relative volume change happens to coincide with the 
easily computable (but nonobjective) LAQtt01 (x0°. In other words, LAQtt10 (x0° is quasi-objective 
in our current context (see §3.6) under the condition that the frame of reference is inertial. 
In other frames, in which the fluid velocity field v takes a different form v, the divergence
5 Note that the integrand in Eq. (7.39) can further be approximated using trajectories x(t; t0; x0° of the carrier fluid 
velocity field v(x; t° as Q xp (t; t0; x0°; t = Q (x (t; t0; x0°;t° + O (° over the finite time interval »t0; t1] by 
smooth dependence of Eq. (7.27) on . The approximation in Eq. (7.39), however, is more accurate by including 
some of the ignored O (e2) terms in the leading-order approximation for qtp (x0; *).

292
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
Table 7.1 Relation of the sign of LAQt1 (xo° to local behavior of inertial particles starting near xo at 
time t0.
Inertial particle type
LAQt0 (x0° > 0
LAQtl (x0° < 0
aerosols (0 < R < 2/3)
dispersion
accumulation
bubbles (2/3 < R < 1)
accumulation
dispersion
r ■ vin will remain the same but will no longer be related directly to the transformed Q field, 
Q (see Appendix A. 10 foreetails).
Following Oettinger et al. (2018), we define an attracting iLCS, M(t°, in the unsteady 
inertial velocity field vin(X; t° over a time interval»10; 11 ] in Eq. (7.12) as a set of trajectories 
on the slow manifold M along which the local volume shrinkage is larger than along 
neighboring trajectories. Similarly, a repelling iLCS, M(t°, is a set of trajectories in ME 
along which the local volume growth is larger than that along neighboring trajectories. The 
time 10 position, M(10), of an attracting (repelling) iLCS can therefore be sought as a ridge 
(trench) of LAQt0(x0° for aerosols or a trench (ridge) of LAQt0(x0° for bubbles, as seen from 
Table 7.1. The materially evolving positions of these iLCSs can be visualized by plotting 
LAQtO(x0° over the current particle positions at time 11, i.e., by inspecting the 2D ridges and 
trenches of the scalar field
t1
LAQto(xi° = LAQtO (xp (10; 1bxj); 
(7.41)
where x0 = xp (10; 11,x1°. As the inertial particle flow is dissipative, these ridges and trenches 
may degenerate into single points or closed curves as we have seen in earlier eiamples in 
this chapter.
Oettinger et al. (2018) apply LAQt0(x0° as a quasi-objective diagnostic tool to uncover 
uneipected attractors for inertial particles for pipe and channel junctions that arise in everyday 
use. Such attractors can be eiperimentally observed, as seen in Fig. 7.9. The figure shows a 
particle, initially at rest at an attracting point-iLCS, that is kicked offby another particle but 
creeps back upstream to the same location after some transient downstream motion.
The results of the LAQ-based analysis of a steady, 3D simulation of the flow through 
a V-junction is shown in Fig. 7.10. Representative trajectories in Fig. 7.10(b) show either 
accumulation and capture in, or passage and eiit from, the junction, depending on their initial 
position relative to the domains of attraction of the two LAQ ridges in Fig. 7.10(a).
Figure 7.11(a) shows the detailed boundaries of two trapping regions in the T-junction 
flow, which are technically domains of attraction for the four point-ilcss, P1;:::;P4. Under 
variation of the parameters, these two regions will either move away from each other or 
merge into one region. The figure shows a case in which the two trapping regions touch each 
other.
7.7 Inertial Transport Barriers in Rotating Frames
To describe particle motion in the ocean, as required, e.g., for the study of garbage accu­
mulation shown in Fig. 1.6, one has to modify the original Maxey-Riley equation (7.2) to

7.7 Inertial Transport Barriers in Rotating Frames
293
(e) S3: End of downstream motion
(b)
t[nis]
102.5 104.0 
105.5 
107.0 108.5 
110.0
(f) S4: Creep back to stagnation point
f[ms]
111.0 122.0 
133.0 144.0 155.0 166.0
Figure 7.9 Experimental evidence of an attracting iLCS for bubbles (hollow glass 
beads, lighter than water) in a T-junction at Reynolds number Re = 277. A video of 
the experiment is available at https^/journals.aps.org/prl/abstract/10. 
1103/PhysRevLett.121.054502. Adapted from Oettinger et al. (2018).
Figure 7.10 LAQ-analysis of inertial particle flow in a V-junction. (a) Visualization 
of the level sets of LAQ0(x0° for inertial particle flow in a V-junction for bubbles with 
e (2 - 3R° = -6:65 X 10-3. (b) Same as (a) but for the quantity LAQ/xi) defined in 
Eq. (7.41). Adiipted from Oettinger et al. (2018).
account for the rotation of the earth. Tanga et al. (1996) and Provenzale (1999) provide this 
modified equation of motion under the assumption that the Fauxen corrections and memory 
terms are negligible (see also Sapsis and Haller, 2009). Beron-Vera et al. (2015) simplifies 
this equation further by omitting e DvDp ;t° (which is an order of magnitude smaller than the

294
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
Figure 7.11 (a) Capture regions (domains of attractions of point-iLCSs) in a T- 
junction. (b) Same as (a), but viewed from the direction of entry into the junction, 
with four attracting point-iLCSs (P1;,,,; P4) and four unstable stagnation points 
(Q 1;:::; Q4). (c) Systematic classification for the existence of capture in the space 
of two parameters characterizing the density p and the Stokes number St of inertial 
particles in the T-junction. Adapted from Oettinger et al. (2018).
other terms in the equation), as well as a centrifugal term and the gravity (which balance each 
other out on the horizontal plane. The resulting simplified equations of 2D inertial particle 
motion in the ocean are
X = Vn;
TVp = - (vp - v(xp; t)) + tf J (vp - 6v(xp; t));
1 \
0 ;
(7.42)
with the non-dimensional parameters
p 
2 a2 
RL
---  ; T = ----- = E----
pp 
9vd 
V 6
where V is the characteristic fluid velocity used in the Reynolds number in formula (7.4). 
Equation (7.42) also depends on the Corioiis parameter f, which is taken to be constant 
under the quasi-geostrophic approximation.
Assuming small inertial particles relative to the length scales of the ocean, Beron-Vera 
et al. (2015) carry out the same reduction to the 2D slow manifold M discussed in §7.2. 
This time, the inertial equation (i.e., the reduced equation for particle motion on M) can be 
written at leading order as
Xp = Vin(xp; t° := v(xp; t° - T (6 - 1° f Jv(xp; t° + O (t2) .
(7.43)

xp (t ; 10; X0) ; N dt + O (t2 ) ;
7.8 Inertial Transport on the Ocean Surface: Modeling and Machine Learning 295
This is to be compared with the inertial equation (7.27) valid in non-geophysical frames. 
According to Eq. (7.43),in the northern hemisphere ( f > 0) the motion of positively buoyant 
( > 1) inertial particles is deflected to the left from the motion of fluid particles. The same 
effect deflects the motion of negatively buoyant particles ( < 1) to the right. In the southern 
hemisphere ( f < 0) we have the opposite effects.
In contrast to our findings in §7.3,the divergence of the inertial velocity field (7.43) is 
now
r ■ Vin(Xp; t° = r (6 - 1° f !3(Xp; t° + O (r2) ; 
(7.44)
with !3 = (r v°3 denoting the scalar vorticity for the 2D fluid velocity field v. The 
volume-change ratio qtt01 (x0; r° defined in Eq. (7.39) is, therefore, replaced by the expression 
qto (xo; t) = r (6 - 1° f [ 1 !
t0
in the current geophysical context.
In §5.2.11,we noted that on large enough spatial domains in the ocean, the spatial 
average of !3 is approximately zero. For that reason, the Lagrangian-averaged vorticity 
!t1 (x0° := 
ft1 !3 (x (t; t0;x0°, t° dt is closely approximated by the LAVDt (x0° field
*'0 
t 1 to to 
*'o
defined in formula (5.27) on regions where the sign of !3 is constant. On such regions, 
therefore, !tt1 (x0° is a quasi-objective scalar field and
|qtO(x0; t)| « |r (6 - 1° LAVD^(x0°|.
Based on this relationship, Haller et al. (2016) find a strict relationship between attracting 
and repelling iLCSs and the LAVD, which we have already summarized in Theorem 5.8.We 
also recall the numerical illustration of these results on the vortex centers of Agulhas rings, 
located as attracting iLCS in Fig. 5.23.
Beron-Vera et al. (2015) further demonstrate the impact of inertial effects on observa­
tions of two RAFOS floats (acoustically tracked, subsurface-drifting, quasi-isobaric buoys) 
released very close to each other in the North Pacific Ocean. As Fig. 7.12 shows, these two 
floats ended up on very different trajectories, even though they stayed at similar depth levels. 
This would normally not be surprising in a turbulent flow, had the floats not been starting 
out in the same coherent Lagrangian eddy, which Beron-Vera et al. (2015) identified from 
satellite altimetry data using the geodesic theory of elliptic LCSs discussed in §5.4.1. Figure 
7.12 also shows an explanation for the different float behaviors: their depth histories suggest 
an overall positively buoyant (bubble-like) behavior for the red float and an overall negatively 
buoyant (aerosol-type) behavior for the green float. This difference implies a sign change in 
the leading-order divergence formula (7.44), predicting volume expansion (escape from the 
eddy) along the green trajectory and volume shrinkage (capture in the eddy) along the red 
trajectory.
7.8 Inertial Transport on the Ocean Surface: Modeling and Machine Learning
The geophysical version (7.42) of the Maxey-Riley equation provides a good approximation 
of the motion of immersed inertial particles in geophysical flows, as evidenced, for example, 
by the observational data shown in Fig. 7.12. This version of the equation, however, does

296
Inertial LCSs: Transport Barriers in inite-Size Particle Motion
Figure 7.12 Different behaviors of two RAFOS float trajectories (red and green) 
relative to a coherent Lagrangian eddy (blue) over a period seven months in the North 
Atlantic. The difference is consistent with the different overall buoyancy history of 
the floats, as shown in the lower subplots. Adapted from Beron-Vera et al. (2015).
not account for windage effects and hence fails to explain some observed features of marine 
debris accumulation.
An important example of such an unexplained feature is the preference for floating garbage 
patches to form in subtropical gyres, such as the Great Pacific Garbage Patch shown in Fig. 1.6. 
Theorem 5.8,which uses Eq. (7.42),would predict a tendency of cyclonic eddies to capture 
light particles, such as microplastics. In contrast, as noted first by Beron-Vera et al. (2019a), 
in situ observations of Brach et al. (2018) show the opposite trend: mesoscale anticyclonic 
eddies are more efficient in capturing microplastics. Further observational evidence for this 
inconsistency is pointed out by Beron-Vera (2021), who notes the tendency of ocean drifters 
that lose their 15 meter long stabilizing drogue (meant to minimize windage effects on the 
drifter trajectory) to accumulate in subtropical (anticyclonic) gyres, as seen in Fig. 7.13.
In contrast, drogued drifters, which also qualify to be modeled as light and partially 
submerged inertial particles, show a more even distribution, as they are close to the setting 
described by the geophysical version (7.42) of the Maxey-Riley equation.
To address these discrepancies, Beron-Vera et al. (2019a) derive a substantially modified 
version of the Maxey-Riley equation that is relevant for a partially submerged spherical 
particle at the air-sea interface. Using the air velocity field va (x; t° at the surface, the relevant 
carrier velocity for the particle in this model is a linear combination of the ocean and air 
velocity in the form

7.8 Inertial Transport on the Ocean Surface: Modeling and Machine Learning 
297
Undrogued SVP drifters
Drogued SVP drifters
Figure 7.13 (Left) Initial (light blue) and final (blue) positions of drogued Surface 
Velocity Program (SVP) drifters one year later, collected from the NOAA Global 
Drifter Program between 1979-2020. (Right) Same but for undrogued SVP drifters. 
Adapted from Beron-Vera (2021).
u(x;t° := (1 - a°v(x; t° + ava(x; t).
(7.45)
With the help of this carrier velocity, the equation of motion obtained by Beron-Vera et al. 
(2019a) is of the form
xp
vp;
fvp = u(xp; t° + fR Dv(xp’t° - fR f + 1 !3 ) Jv(xp; t° - (f f + 1 R!3 ) J + l) vp;
Dt \ 
3 I 
3 3 
3 I I
(7.46)
where RT , -T and aT are non-dimensional parameters that are involved functions of the density 
ratio , the fluid viscosity and the particle radius a; the matrix J is the same as inEq. (7.42) 
and !3 (x; t° is the vertical velocity component, as in the previous section.
For -T 
1, following the procedure we outlined in §7.2 for a slow manifold reduction,
Beron-Vera et al. (2019a) obtain the inertial equation
xp = u + f
Dv 
1 
Du 1
R Dh - R f + 3 !3 Jv - DTt - f + 3 R!3 Ju
(7.47)
+ O ) :
Examining the divergence of this reduced equation, they then obtain a modification of 
Theorem 5.8that correctly predicts the accumulation of microplastics in anticyclonic eddies 
(see Beron-Vera et al.,2019a,for details). These findings are corroborated by laboratory 
experiments in Miron et al. (2020).
Accumulation patterns of Sargassum (type of large brown type seaweed) provide another 
set of patterns that are generally incorrectly predicted even by the modified air-sea version 
(7.46) of the Maxey-Riley equation. To address this problem, Beron-Vera and Miron (2020) 
develop the equations of motion for an elastically connected network of partially submerged 
small spheres, which in turn provides predictions consistent with observations of Sargassum 
accumulation patterns.
We close by noting that Aksamit et al. (2020) use an alternative, neural-network-based 
approach to account for windage effects on drifters in given ocean regions and seasons using 
historical drifter trajectories. This approach relies on the slow-manifold approximation we 
have discussed in this chapter to determine the fundamental variables on which the inertial

298 
Inertial LCSs: Transport Barriers in Finite-Size Particle Motion
equation should depend. Aksamit et al. (2020), however, use machine learning to determine 
the functional dependence on these variables in a way that minimizes the difference between 
trajectories of the inertial equation and those of real drifters. The inertial velocity field they 
seek to learn is of the form
Vin(X; t° = V(X, t° + J I - 1
’ D V(X; t °
DV
- Rf(6 - 1°Jv(X;t° + HIV;—,vJ k
(7.48)
D - g
with the Ekman current velocity ve = 00127 Avwind , where Avwind is the 45° rotation of the
e
local wind velocity to the right on the Northern Hemisphere and is the local latitude 
coordinate. The correction velocity H is a function of the carrier velocity field, its material 
derivative and the Ekman current velocity ve , as deduced from the formal construction of 
the slow manifold M for this problem. As previously proposed by Wan and Sapsis (2018), a 
long short-term memory (LSTM) recurrent neural network can be used to learn the function 
H (v; DDv; ve) from historical drifter data. Near submesoscale features, this approach corrects 
drifter trajectories inferred from deterministic models that use only satellite altimetry and 
wind reanalysis data.
Testing the predictive potential of the blended model (7.48), one must account for uncer­
tainties that are already present in the acquisition of drifter data. A way to factor this in is to 
use a whole ensemble of synthetic drifters initialized in a small, 10 km radius neighborhood 
of an observed drifter. Each synthetic drifter in such an ensemble has the same initial velocity 
but different initial position. One can then track such an ensemble of drifters both under the 
observation-blended Maxey-Riley equation (7.48) and its classic version with H = 0 to see 
if the evolving ensemble has a dominant concentration around the actually observed drifter 
trajectory. Aksamit et al. (2020) carries out such a comparison on drifter paths recorded in 
the Lagrangian Submesoscale Experiment (LASER) described, e.g., by Haza et al. (2018). 
Two such ensemble predictions are shown in Fig. 7.14,showing notably improved prediction 
for at least parts of the drifter motion under the use of the blended Maxey-Riley model (7.48).
7.9 Summary and Outlook
In this chapter we have discussed barriers to the advective transport of finite-size (or inertial) 
particles carried by fluids. For small enough particles and Reynolds numbers, the Maxey- 
Riley equation provides an accurate description of inertial particle motion. Under various 
simplifying assumptions, this equation can be reduced in its phase space to an attracting 
slow manifold whose dimension equals the dimension of the fluid velocity field. On this slow 
attractor, the velocity field governing inertial particle dynamics is a small perturbation of the 
fluid velocity field. At leading order, that perturbation is only a function of the fluid velocity 
field and the density of the inertial particle. This makes the reduced inertial velocity field 
computable solely from the available velocity data of the carrier flow.
Material transport barriers governing inertial particle motion are, therefore, LCSs of 
the reduced Maxey-Riley equation on the slow manifold. These inertial LCSs (iLCSs) are 
generally dissipative attractors and repellers, because the reduced Maxey-Riley dynamics 
is compressible for aerosols and bubbles even if the carrier fluid is incompressible. Beyond

7.9 Summary and Outlook
299
Figure 7.14 Two comparisons of multi-step ensemble predictions for ocean drifter 
motion from the blended Maxey-Riley model (7.48) and from its deterministic version 
with H = 0. Adapted from Aksamit et al. (2020).
the ftle, the quasi-objective Lagrangian-averaged Q parameter arises in this context as a 
reliable predictor of particle accumulation and dispersion locations.
For neutrally buoyant inertial particles (suspensions), the reduced Maxey-Riley equations 
coincide with the incompressible carrier velocity field. Suspensions, therefore, are expected 
to synchronize with fluid particle motion. Nevertheless, they can display a curious scattering 
phenomenon, which turns out to arise from a loss of stability of their slow manifold in certain 
flow regions. We have discussed how these scattering locations can be predicted from the 
carrier velocity data.
We have also surveyed more recent versions of the Maxey-Riley equation that are appli­
cable to ocean drifters and small objects with propulsion, such as small sea animals. Once 
reduced to their appropriate slow manifolds, the iLCSs relevant for these inertial dynamics 
can be located by the same methods that we have already covered for the classic Maxey-Riley 
equation. Finally, we have shown how machine learning can help identify unknown parts of 
the reduced dynamics on the relevant slow manifold for ocean drifter motion.

8
Passive Barriers to Diffusive and Stochastic Transport
While the transport of concentration fields arising in nature and technology is often predom­
inantly advective, it invariably has at least a small diffusive component as well.Figure 8.1 
shows examples of diffusive transport barriers framing patterns in a phytoplankton bloom 
near Alaska’s Pribilof Islands that are surrounded by the nutrient-rich Bering Sea.
Figure 8.1 Phytoplankton bloom near the Pribilof Islands in Alaska on September 
22, 2014. Image: NASA Earth Observatory.
The green and light blue colors in the water indicate the abundance of microscopic 
phytoplankton. The blurred gradients along curves separating different colors are hallmarks 
of a notable diffusive component in the overall transport of phytoplankton.
The inclusion of diffusivity in transport studies increases their complexity significantly. 
Indeed, the advection-diffusion equation governing diffusive transport is a time-dependent 
PDE, whose numerical solution requires the knowledge of the initial concentration and the 
boundary conditions. We can, therefore, no longer follow the approaches of the previous 
chapters that were based solely on the study of trajectories of the velocity field.
At the same time, introducing the diffusivity creates an opportunity to settle on a broadly 
agreeable definition for a transport barrier. Indeed, inChapters 4 -7, we had to face the fact 
that all material surfaces block advective transport completely, rendering the notion of an 
advective transport barrier fundamentally nonunique. This has forced us to define transport 
barriers as recurrent material surfaces in Poincare maps of steady and time-periodic flows, 
300

Passive Barriers to Diffusive and Stochastic Transport
301
and Lagrangian coherent structures (LCSs) in nonrecurrent flows. Coherence, however, has 
no universally accepted definition, which has led us to a number of alternative techniques for 
finding LCSs (with numerous further techniques not even covered in this book; see §1.8for 
pointers to some of them). Each such technique yields (mildly or vastly) different coherent 
structures, as highlighted in the broad comparison of Hadjighasem et al. (2017). Balasuriya 
et al. (2018) also point out these discrepancies and advocate for the extension of the LCS 
concept beyond the purely advective setting.
In contrast, diffusive transport through a material surface is a uniquely defined, funda­
mental physical quantity, whose extremizing surfaces can be defined without reliance on any 
special notion of coherence. These considerations lead us to adopt the following definition 
for barriers to diffusive transport.
Definition 8.1 A codimension-1 material surface is a diffusion barrier if it is a structurally 
stable extremizer of diffusive transport relative to all neighboring material surfaces.
AdoptingDefinition 8.1 , in this chapter we continue to seek transport barriers as material 
surfaces to ensure their observability in experimental flow visualization. Available observa­
tional data analyzed by Beron-Vera et al. (2018) indeed suggests that robust diffusion barriers 
inferred from concentrations evolve (at least approximately) materially. Note thatDefinition 
8.1does not necessarily require a diffusion barrier to minimize diffusive transport. Indeed, 
as we will see, some of the most prominently observed barriers are, in fact, maximizers of 
diffusive transport due to the large concentration gradients developing across them. Finally, 
to ensure robust experimental observability,Definition 8.1 also requires a diffusion barrier 
to be structurally stable, i.e., to persist smoothly under small perturbations to the underlying 
fluid flow (see §2.2.7). As a conceptual guide,Figure 8.2 illustrates the difference between a 
general material surface, an LCS and a material barrier to diffusive transport.
t = t0
t = t1
Lagrangian Coherent
Material barrier to 
diffusive transport
t = t0 
t = t1 
t = t0 
t = t1
Figure 8.2 (Left) Any material surface blocks advective transport over any time 
interval»t0; 11] but will generally deform into an incoherent shape. (Middle) Material 
surfaces with persistent coherence are Lagrangian coherent structures (LCSs). (Right) 
Material surfaces minimizing or maximizing diffusive transport of a concentration 
field are diffusion barriers.
We will focus on weakly diffusive transport (0 < k « 1°, which is the relevant range for 
most processes in nature. Related prior approaches not discussed here include spatially local­
ized expansions for diffusion for simple velocity fields (Press and Rybicki,1981 ; Knobloch 
and Merryfield,1992 ; Thiffeault,2008 ) and asymptotic scaling laws for stretching and folding 
statistics (Tang, X.; and Boozer,1996 ; Thiffeault,2003 ). The effective diffusivity approach 
of Nakamura (2008) and the residual velocity field concept of Pratt et al. (2016) yield 

302 
Passive Barriers to Diffusive and Stochastic Transport
efficient diagnostics for results of already performed diffusive simulations. In contrast, here 
we discuss approaches that predict uniquely defined diffusion barriers based purely on the 
velocity field v(x; t), without any need for diffusive simulations. The same approach also 
turns out to apply to locating barriers to transport in stochastic velocity fields, which we have 
only briefly discussed (see §1.6).
In the limit of zero diffusivity, the results we describe in this chapter also give a unique, 
physical definition of purely advective LCSs as material surfaces that will block transport 
most efficiently under the addition of the slightest diffusion or uncertainty to the velocity 
field. Therefore, viewing purely advective transport barriers as the zero-diffusivity limit of 
diffusion barriers makes them uniquely defined and robust under uncertainties.
8.1 Unconstrained Diffusion Barriers in Incompressible Flows
We start by recalling the incompressible version of the advection-diffusion equation for a 
tracer c(x, t° with diffusivity k > 0 without sinks or sources:
c t + r c ■ v = Kr -(Dr c °, 
c (x, t0 ° = c 0(x). 
(8.1)
Here, v(x; t° is a velocity field defined on an open domain U c Rn, c0(x° denotes an 
at least twice differentiable initial tracer distribution and k > 0 is the diffusivity of c(x, t°. 
Furthermore, D(x; t° = DT(X; t° 2 Rnxn denotes a continuously differentiable, positive definite 
diffusion-structure tensor, possibly with anisotropy and temporal variation. As we show in 
Appendix A.15, D must be objective for the passive tracer c(x, t°, i.e., under any Euclidean 
observer change of the form (3.5), we must have
D(y; t° = QT(t°D(X; t°Q(t° 
(8.2)
for the transformed tensor in the y-frame.
As in the previous chapters, we will seek transport barriers among codimension-1 material 
surfaces M(t°, evolving under the flow map Ft0 of v(x; t° as M(t° = Ft0 (M0°. The diffusive 
transport of c through M(t° over a time interval »10,11] is the time-integrated diffusive flux 
(seeAppendix A.15 ), given by
tt01 = 
t1 
KDrc ■ ndAdt; 
(8.3)
A MM°t)
where n(X; t° is the unit normal to M(t° at a point x 2 M(t° (see Fig. 8.^^(a) for an illustration 
ofEq. (8.3)).
By the surface element transformation formula (2.34) and by the chain rule applied to rc, 
we can rewrite formula (8.3) in terms of an integral over the initial surface M0 as
St0 (M0 ° = K [t [ [V0 c (Ft0 (X0°; t)]T Tt0 n0 dA 0 dt; 
(8.4)
t0 M0
with the tensor Ttn(x0° defined as 
t0
Tt0(X0° = [V0Ft0(X0°] "1 D (Ft0(X0°; t) T Ft (x,)] "T . 
(8.5)
Using formula (2.32), we note that Ttt0 : TX0 Rn ! TX0 Rn is a Lagrangian tensor for which 
we have det Ttt0 = det D Ftt0 ; t by the incompressibility of v. Furthermore, for isotropic

8.1 Unconstrained Diffusion Barriers in Incompressible Flows
303
(a)
Figure 8.3 (a) The geometry of diffusive transport through a material surface M(t°, 
induced by the surface integral of the flux vector kDr c. (b) Universal initial tracer 
configuration c0(xo° in the construction of unconstrained diffusion barriers.
diffusion (D = I), the transport tensor has a simple relationship to the right Cauchy-Green 
strain tensor:
Tt0 = [Cto ] 1 : 
(8.6)
1 Coincidentally, the tensor Tto was proposed heuristically in Press and Rybicki (1981) to simplify the Lagrangian 
version ofEq. (8.1) . Knobloch and Merryfield (1992) show, however, that such a heuristic simplification generally 
gives incorrect results for unsteady flows. In Eq.. 88.9)), Tt1 arises without any heuristics.
Haller et al. (2018) prove that for small values of the diffusivity K; the diffusive transport 
(8.4) can be expanded as
(Mo° = K [' [ (Voco)T Tono dAo dt + o(k); 
(8.7)
t0 
M 0
where o(k°k_1 tends to zero as k ! o. Proving Eq. (8.7) is involved because Eq. (8.1) is a 
singularly perturbed PDE for small K > o. Indeed, Liu, W., and Haller (2004) show that the 
solutions of this PDE cannot be Taylor-expanded at K = o unless v is integrable.
We seek to find diffusion barriers as material surfaces whose initial positions, Mo, extrem- 
ize the diffusive transport functional Et1 (Mo). This transport, however, will depend on the 
initial concentration co(xo°. In the absence of any specific information on co, we will subject 
all diffusion barrier candidates to the same, most diffusion-prone initial scalar configura­
tion: we assume that Mo is a level surface of co (xo° along which Voco (xo° has a constant 
length K > o, as shown inFig. 8.3(b) . We will call diffusion barriers constructed under this 
universal initial distribution near each Mo unconstrained diffusion barriers, given that the 
transport through them is not conditioned upon a specific initial concentration. Rather, their 
permeability is tested and compared under the same local initial tracer configuration that is 
highly conducive to diffusive transport.
Under this local assumption on co (xo° along Mo, we can use the symmetric and positive 
definite transport tensor Tt1, defined as1
1 
t1
T to = 7^7 
Tto dt; 
(8.8)
t 1 to J to

304
Passive Barriers to Diffusive and Stochastic Transport
to rewriteEq. (8.7) as
Lt0(M0) = kK (11 - 10) f (no, T(0no} dA0 + o(k). 
(8.9)
M0
As the time average of the Lagrangian tensor T(0, the transport tensor T(0 is also a Lagrangian 
tensor. Under the observer change (3.5), we obtain from the transformation formulas (3.45) 
and (A.91), as well as from the definition of T((0, that
Tt0 = 7-^- f t1|'rF'„ 1 1D IrFt]~T d'
0 1 - '0 J 0>
= —f |QT('°r0Ft0Q('0°]_1 QT('°DQ(') |Qt('°r0Ft0Q('0)] "T d'
' 1 '0 t0
= QT('0°T t0 Q('0° 
(8.10)
and hence T(0 is Lagrangian objective (see §3.4.3).
Before extremizing ((01 (M0°, we need to normalize this quantity by the surface area 
A0 (M0 ° (or length, for n = 2) of M0 to avoid extrema that only arise because of their size. 
Additional normalization by the diffusivity k, by the transport time (' 1 - '0) and by the initial 
concentration gradient magnitude yields the normalized total transport
(1 M0
E t0 ' M': K k (, 1 -- 00) A0CM, = T » *M«’+ O*K" >• 
"•'
where 2 (0, 1° is an appropriate constant and
T(0(M0) := 
M (n;Tt°nn0^ dA0 
(8.12)
0 
M0 dA0
is the non-dimensional transport functional. Importantly, Tt0t1 (M0) gives the leading-order, 
non-dimensionalized total diffusive transport of c through M()) over the time interval»00,01]. 
It can be computed directly from the trajectories of v, without any reliance on the solutions 
of the PDE (8.1).
Note that by the objectivity of T£ shown in Ei<^|. (8.11^), the transport functional Tt,'1 is 
an objective Lagrangian scalar field, as defined in §3.4.1. Indeed, under an observer change 
(3.5), we obtain
er(1 (M) =
M0 dA0
= T((1 (M0).
Jm0 (Qt(00)n0, QT(00)-T(1 Q(00°QT(00°n>) dA0
Jmc dA 0
(8.13)
(
By formula (8.11), nondegenerate extrema of the normalized total transport ((01 are O( )- 
close to those of the transport functional T(01. Haller et al. (2018) show that the multi­
dimensional calculus of variations problem,
^T(0 (M0) = 0,
(8.14)

8.1 Unconstrained Diffusion Barriers in Incompressible Flows
305
for the extremum surfaces of T tt01 is equivalent to the variational problem
6Eto (Mo° = 0; Eto (Mo) b f [(no;Tt0no} -To] dAo; 
(8.15)
M0
where T := Tt0 (M0° is a constant, the value of Tt0 on the stationary surface M0. The 
extremum problem (8.15) still has infinitely many solutions through any point x0, but most 
of these solution surfaces will not be seen as barriers due to large changes in the concen­
tration gradients along them. Indeed, asFig. 8.4 illustrates with the sea surface temperature 
distribution near the Gulf Stream, the most observable transport extremizers display a nearly 
uniform drop in the scalar concentration along them, which represents nearly constant trans­
port density along these barriers.
layer=01 temp Nov 20, 2018 00Z [91.2H]
<» 0.350 3.a
3.0
M0O18111918
Figure 8.4 Edges of the Gulf Stream are examples of nearly uniform diffusion barriers 
in the sea surface temperature field of the North Atlantic. Image: National Weather 
Service, NOAA.
For this reason, Haller et al. (2018) focus on perfectly uniform extremizers of T tt10 along 
which the integrand in (8.15) vanishes, i.e.,
(no; T t0 no ) = To 
(8.16)
holds for an appropriate constant T0 > 0 along the initial surface M0 . Rewriting this result as
(no(xo°; Et(xo°no(xo°) = 0; 
Et b Tt0 - TI 
(8.17)
we see that diffusive transport extremizers are null-surfaces of the metric tensor ETo(x0°, 
i.e., their normals have zero length in the metric defined by Et(x0). Such null-surfaces may 
only exist at a point x0 if the tensor Et(x0° is not definite. That will precisely be the case 
if the eigenvalues 0 < A^(x0) < ■ ■ ■ < AT(x0) of the positive definite tensor T£(x0° satisfy 
_ _
AT(xo° <To < 2T(xo°.
Haller et al. (2018) also prove that a uniform minimizer Mo of the transport functional 
T tto1 is necessarily a non-negatively traced null-surface of the tensor field ETo, i.e.,

306
Passive Barriers to Diffusive and Stochastic Transport
(no(xo°; Eto(xo°no(xo°) = 0; 
tr ETa(xo) > 0;
(8.18)
must hold for all point x0 2 M0. Similarly, they find that a uniform maximizer M0 of T tt01 is 
necessarily a non-positively traced null surface of the tensor field ET0 , i.e,
(no(xo°; Eto(xo°no(xo°) = 0; 
tr Eto(xo) < 0;
(8.19)
must hold at every point xo 2 Mo . Both minimizers and maximizers can be observed as 
transport barriers, as we will see later.
The null surfaces arising in the criteria (8.18)-(8.19) are difficult to construct in 3D flows 
but their proof suggests a simple objective predictive field for diffusion extremizer detection. 
In particular, Haller et al. (2018) show that, in any dimension n,
tr Et (xo° = tr Tt0 (xo) - nTo
measures how strongly the normalized transport changes from To to some other value under 
localized normal perturbations at x0 to a transport extremizer M0. Consequently, the time t0 
positions of the most influential diffusive transport minimizers should be marked by ridges 
of the diffusion barrier sensitivity (DBS) field, defined as
DBStl(xo) b trTtl(xo°:
(8.20)
By the same reasoning, the time t0 positions of the least influential diffusion barriers should 
be close to trenches of DBS(x0°. Similar conclusions hold for diffusion maximizers based 
on features of the DBSt1 (x0° field computed in backward time with 11 < 10. Therefore, the 
DBS field plays a role in weakly diffusive transport that is similar to the role of the FTLE 
field (see §5.2.1) in purely advective transport. Unlike the purely diagnostic FTLE field for 
advective transport, however, the DBS field is a predictive field for diffusive transport, given 
that its computation requires no diffusive simulation.
8.1.1 Unconstrained Diffusion Barriers in 2D Flows
First, we note an illuminating connection between diffusion barriers and LCSs in 2D flows 
(n = 2° under homogeneous and isotropic diffusion (D = I). In that case, replacing the 
averaged transport tensor Tt* with its un-averaged counterpart, T^J = [CtJ ] 1, in the above 
derivation, we obtain fromEq. (8.17) that closed uniform extremizers of the Lagrangian 
diffusive flux, dT
—Sto(Mo) = k/ 
[rc (Fto; 11)] TtonodA0;
dt1 
Mo
at time t1 satisfy
Dno(xo); [[Ct0]-1 -T0Ii no(xo°E = 0:
(8.21)
(8.22)
Under any parametrization, xo (s), of the diffusive flux extremizer curve Mo , we can write 
the unit normal no (xo ) to the curve as
no(xo(s)) = Jxo0 (s)
(8.23)

8.1 Unconstrained Diffusion Barriers in Incompressible Flows 
307
for one of the signs in and with the 90 rotation matrix J defined in formula (2.106). Then, 
using formula (2.106) with A = [CJ0] 1; we can rewrite Eq. (8.22) as
D±Jx0; h [Ct0]"1 - T0l] (±Jx0)E = Dx0; |JT [Ct0]"1 J - T0l] x0E = (x0; [C0 - T] x0} = 0:
(8.24)
Therefore, a comparison ofEq. (8.24) with Eq. (5.52) , as derived inChapter 5 in the global 
variational theory of LCSs in 2D, leads to the following under the choice of parameters 
2 = T0 in these two equations.
Proposition 8.2 Time t0 positions of elliptic LCSs (as closed stationary curves of the tan­
gential stretching over »10;11]) in 2D incompressible flows coincide with time 10 positions of 
closed stationary curves of the instantaneous diffusive flux (8.21) (diffusive flux barriers), as 
long as the diffusion is homogeneous and isotropic and the initial tracer distribution at time 
t0 is chosen as inFig. 8.3 .
Setting t0 = t1 = t in Prroposttion 8.2 and noting hiat Tt = -2S yields a direct connection 
between diffusive flux barriers and elliptic OECSs as follows.
Proposition 8.3 Time t positions of elliptic OECSs (as closed stationary curves of the tan­
gential stretching rate at time t) in 2D incompressible flows coincide with unconstrained 
diffusive flux-rate barriers, i.e., with closed stationary curves of the unconstrained instanta­
neous diffusive flux-rate
11 (M° = -2k f nTS (X; t° n dA; 
(8.25)
M
as long as the diffusion is homogeneous and isotropic.
Next, we solve the general equation 88.16) for parametrized diffusion brjrrr^ers x0(s° in 2D 
incompressible flows. To this end, we define the diffusion-weighted Cauchy-Green strain 
tensor,
[CD]t0 (X0° := det [D (Ft,(x0°, t)] [Tt>(x0)] "1 . 
(8.26)
Using the identity (2.106) with A = Ttt01, the definition of the tensor CD fromEq. (8.26) and 
the incompressibility of the flow (det r0Ftt0 1), we obtain
(n0; Tt0n0} = <X0; JTTt,Jx0} = det (Tj0) (x0; [Tj0] "1 x0) 
det (Tt) 
... 
. 
,
= det [D (Ft"; t)] 
; [CD]t0 
= 
; [CD]t0 x^ :
Therefore,
1 
t1 
1 
t1
(n0; Tt0n0) = 
(n0; Tt0n0) dt = 
(x0; [CD]t0 x0) dt
t 1 - t0 J t0 
t 1 - t0 J t0
1 t1 t
= x0, I [CD]t0 dt x0 
t 1 
t0 J t0
= (x0; CDx0) ;

308
Passive Barriers to Diffusive and Stochastic Transport
with
1 
t1
CD = ------ I [Cd]t0 dt 
(8.27)
t 1 t0 J to
denoting the time average of [CD]tt0. Consequently, the diffusion extremizer equation (8.16) 
can be rewritten as
(x0; [Cd(xq° - TI] X0) = 0: 
(8.28)
Equation (8.28) is of the same form as Eq. (5.52) defining black hole vortices, once one 
replaces the symmetric, positive definite tensor Ct0 with CD and the positive constant A2 with 
T0. With these replacements, defining the eigenvalue problem for (3D as
C d6 = -ii 6; 
(8.29)
with the eigenvalues
0 < A1(x0; t0; t 1° ^ A2(x0; to; t 1°
and orthonormal eigenvectors 6(x0; t0; t 1° 2 TX0R2, we can use the explicit solution (5.54) for 
uniformly A-stretching lines to conclude the following.
Theorem 8.4 Initial positions of elliptic diffusion barriers, defined as closed stationary 
curves of the averaged transport functional T tt01 (M0°, are closed trajectories of the direction 
field family
X0(s° = 
(X0(s°°; 
^T(X0° b qn6 ± x . 6; 
(8.30)
defined on the spatial domain
UT0 = {x0 2 U : A1(x0; t0; t 1° < T0 < A2(x0; t0; t 1°} : 
(8.31)
Any such elliptic diffusion barrier has uniform pointwise transport density T0 over the time 
interval [t0; t1]: Outermost members of nested families of such closed barriers serve as initial 
positions of diffusion-based Lagrangian vortex boundaries.
By an analogy between Eqs. (8.28) and (5.52), time-t0 positions of material barriers 
to diffusive transport can also be computed as null-geodesics of the tensor Lagrangian 
tensor family Cd(x0° - T0I. Based on the approach discussed in §5.4.2, this null-geodesic 
computation for 2D flows is implemented in Notebook 8.1. 
—
Notebook 8.1 (EllipticLagrangianDiffusionBarriers) Computes closed (ellip­
tic), unconstrained material barriers to diffusive transport in a 2D unsteady velocity data 
set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/DiffusionBarriers/EllipticLagrangianDiffusionBarriers
A similar computation for closed Eulerian diffusion barriers (see Proposition 8.3) is imple­
mented in Notebook 8.2.

8.1 Unconstrained Diffusion Barriers in Incompressible Flows
309
Notebook 8.2 (EllipticEulerianDiffusionBarriers) Computes closed (elliptic), 
unconstrained barriers to the diffusive flux-rate in a 2D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ DiffusionBarriers/ EllipticEulerianDiffusionBarriers
For homogeneous, isotropic diffusion (D = I), we have
1 
t1
Cd(xo° = -— I Ctodt = (310;
t 1 t0 J to
and hence /i and £i are just the eigenvalues of the time-averaged right Cauchy-Green strain 
tensor Ct. Therefore we have:
t0
Proposition 8.5 Computing black-hole vortices using the tensor Cl tt0 instead of Ctt0 gives vor­
tex boundaries that are outermost barriers to homogeneous and isotropic diffusive transport.
2 Note that this D is not objectively defined. It only serves as an illustration for the anisotropy in the horizontal 
and vertical directions in the frame of the reference of the Earth. An objective definition of D modeling this 
anisotropy could involve, for instance, the rate of strain tensor S. (Miles Rubin, personal communication).
For general diffusion, the scalar diagnostic field defined in Eq. (8.20) takes the specific 
form
DBStO (xo° = tr C d(xo ), 
(8.32)
providing an alternative to the FTLE that takes homogeneous and isotropic diffusion into 
account beyond advection.The computation of the DBS field for 2D flows is implemented in 
Notebook 8.3.
—
Notebook 8.3 (DBS) Computes the diffusion barrier sensitivity (DBS) field for uncon­
strained material barriers to diffusion in a 2D unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/DiffusionBarriers/DBS
Haller et al. (2018) analyze the possible boundary conditions leading to formula (8.30) and 
obtain that there are only three types of robust barriers to diffusion in 2D flows. These barriers 
include fronts, jet cores and families of closed material curves forming material vortices, 
in agreement with observations of barriers in geophysical flows (see Weiss and Provenzale, 
2008). As an illustration, the upper plot in Fig. 8.5 shows all three types of barriers identified 
from the direction field (8.30) and the DBS field (8.32) for the quasiperiodically forced 
version of the Bickley-jet model of del Castillo-Negrete and Morrison (1993). Note that 
observed diffusion barriers may appear both as ridges (hyperbolic barrier) and trenches 
(parabolic barrier or jet core) of the DBS field.
The computational algorithm used in Fig. 8.5 is the same as that outlined for elliptic LCSs 
in §5.4.1. This algorithm is applied to the direction field (8.30), with the eigenvalues of CD 
computed under the choice of the anisotropic but homogeneous diffusion structure tensor 
D = diag (2; 0:5°.2 Most diffusive vortex boundaries (green), identified at time t0 = 0 as

310
Passive Barriers to Diffusive and Stochastic Transport
12345678
log DBS040(x0)
y
2
0
-2
0 
2 
4 
6 
8 
10 
12 
14 
16 
18 x
1
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9
c(F400(x0), 40)
0 
2 
4 
6 
8 
10 
12 
14 
16 
18 x
Figure 8.5 Diffusion barriers and LCSs in the Bickley jet with quasiperiodic forcing. 
(Top) Black-hole vortex boundaries computed from formula (5.52) and outermost 
closed diffusion barriers computed from formula (8.30). Grayscale background shows 
the diffusion barrier sensitivity field, DBS00(x0°, computed from formula (8.32), with 
its ridges highlighting stable manifolds (backward-time front). (Bottom) Advection­
diffusion simulation with k = 10“5 for the same flow, also showing the uniform 
transport density values T0 labeling the outermost diffusion barriers. Flow parameter 
values are the same as in Hadjighasem et al. (2017). Adapted from Haller et al. (2018).
outermost closed orbits of the direction field family ^T(xo), are larger than the black-hole 
vortex barriers (red) computed from the direction field family ^^(x0) defined in Eq. 5^555^)).
The lower plot inFig. 8.5 compares selected predicted diffusion barriers (vortex boundaries 
and the jet core) with a simulation of the advection-diffusion equation (8.1) for fiiis flow with 
Peclet number Pe = 1/k = O (105) .A uniform initial concentration c 0 (x0° = 1 was selected 
inside the predicted vortex boundaries and on the lower part of the domain bounded from 
above by the predicted jet core (the trench of the DBS00(x0° field). Note the increased impact 
of diffusion on the scalar field inside the closed barriers with higher values of the transport 
density T0 values. This confirms that formula (8.30) provides a predictive classification of 
diffusion barriers from purely advective calculations.

8.1 Unconstrained Diffusion Barriers in Incompressible Flows
311
To illustrate the role of diffusion barriers predicted from observational velocity data, we 
now locate the boundaries of Agulhas rings studied in §5.4.1 as universal barriers to the 
leakage of diffusive ocean water attributes that they transport. We select the initial time 
t0 = 0 to be November 11, 2016 and the final time, at t1 = 90 days, to be February 9, 2017. 
The flow domain shown in Fig. 8.6 is covered by a regular 500300 grid for computing the 
direction field (8.30) and the DBS field (8.32).
Figure 8.6 Predicted and confirmed diffusion barriers in the Agulhas leakage based 
on the AVISO altimetric sea-surface velocity field (see Appendix A.6); see the text 
for details. A video showing the role of diffusion barriers in blocking transport can 
be found at https://www.pnas.org/doi/10.1073/pnas.1720177115#sm01. 
Adapted from Haller et al. (2018).
The top left plot in Fig. 8.6 shows coherent Agulhas ring boundaries predicted as outermost 
closed diffusion barriers (outermost limit cycles of the direction field (8.30)). Ridges of 
the DBS field in the background mark predicted diffusive barriers (backward-time fronts) 
computed from satellite-altimetry-based surface velocities (see Haller et al., 2018 for more 
detail on the computations and the data).
As in our previous example, we confirm these predictions by a diffusive simulation with 
Peclet number Pe = 1/k = O (104). The top middle plot of Fig. 8.6 shows the diffused 
concentration, c(x0;11° b c(F£(x0°11°, in the Lagrangian coordinates x0; lighter colors 
mark higher concentration values. The initial concentration c0(x0° = 1 was chosen inside the 
predicted diffusive vortex boundaries, as well as inside six shifted copies of those boundaries. 
The top right plot shows the ridges of the DBS field superimposed, highlighting the direct 
role of hyperbolic diffusion barriers in eroding the uniform initial concentrations initialized 
inside six shifted positions of the actual elliptic barriers. All plots at the top of Fig. 8.6 
are shown in the Lagrangian x0 coordinates, isolating the purely diffusive component of the 
transport of the concentration field from its advective component. The bottom plot shows 

312 
Passive Barriers to Diffusive and Stochastic Transport
the evolved concentration field and the material evolution of the predicted diffusive vortex 
boundaries at time t1 in Eulerian coordinates.
Andrade-Canto et al. (2020) use the diffusion-barrier approach we have just described to 
estimate the life expectancy of Loop Current rings in the Gulf of Mexico using satellite­
altimetry-inferred velocities. On this observational data set, they note the same close corre­
spondence between closed diffusion barriers and black-hole vortex boundaries that we have 
seen inFig. 8.5 for the Bickley jet model.
8.2 Constrained Diffusion Barriers in Incompressible Flows
The theory of constrained diffusion barriers is also based on formula (8.7), but it seeks to 
extremize the diffusive transport functional StJ(Mo° with respect to M0 under a given initial 
concentration c0(x0°, rather than under the most diffusion-prone concentration sketched in 
Fig. 8.3. This constrained extremization of S£ (Mo° is required when the initial concentration 
c0(x0° of a diffusive scalar field c (x; t° is explicitly known or inherently constrained to the 
velocity field. An example of such a scalar field is the scalar vorticity, !(x; t°, of a 2D 
incompressible flow. This field formally obeys the advection-diffusion equation (26>^), which 
is of the type (8.1), but its initial condition, !0(x° = !(x; 10°, cannot be arbitrarily selected. 
We will specifically discuss constrained barriers to the diffusive transport of vorticity in §8.3.
Considering r0c0(x0° as given, we again normalize Eq. (8.7) with hie surface area of M0, 
the diffusivity k and the time span 11 - 10 to obtain
~ 
PttA (pt1; n0) dA0
et0(M0° := 
\ 0 ./------- + o(Ka°; 
(8.33)
t0 
M0 dA0
where a 2 (0; 1° is an appropriate constant and the transport vector field, p£, is defined as 
the Lagrangian vector field
p t0 (X0° = T t0 (X0°r0 c 0 (X0°: 
(8.34)
Here, T£ is the same transport tensor that we defined in Eq. 88.8) for unconstrained barriers.
This time, the sign of the net total transport ett01 (M0° inEq. (8.33) is not necessarily 
positive, whichprompts us to extremize the normed transport, i.e., the time-integral of the 
geometric flux fMo |(p£; n0)| dA0, as defined by Mackay (1994). This leads to the calculus 
of variations problem
~ 
~ 
fM KpS;n0)l dA0
SE(M0° = 0; 
E(M0° := M ^ t0 
; 
(8.35)
M0 dA0
for the functional Ee under variations of the material surface M0 .
As we have already argued for unconstrained barriers, the most observable stationary 
surfaces of diffusive transport are those with nearly uniformly high gradients along them, 
associated with a nearly uniform pointwise transport density. In our presenting setting, this 
argument leads to the equation
|(p t0; n0 )| = T0 
(8.36) 

8.2 Constrained Diffusion Barriers in Incompressible Flows 
313
of uniform constrained diffusion barriers for any selected pointwise transport density T0 0: 
Haller et al. (2020a) prove that such uniform barriers are indeed solutions of the extremum 
problem (8.35).
In analogy with the DBS field defined inEq. (8.20) , the local sensitivity of a uniform 
constrained barrier is measured by
DBSt0(X0° = |Pt0 (x>)|: 
(8.37)
This can be seen intuitively by noting that the geometric flux density |(p£,n0)| will change 
the most under a small change in the relative position of the vectors pt1 and n0 at locations 
where |pt0 (x0°| is the largest. A more precise argument shows that DBSt0(x0° is the normed, 
leading-order change in the functional E(M0° under small, localized perturbations to a 
stationary surface M0 (see Haller et al.,2020a ). For this reason, ridges of the diagnostic 
field DBSt0 (x0° are expected to predict the strongest diffusive transport barriers over the time 
interval»10; 11].
8.2.1 Constrained Diffusion Extremizers in 2D Flows
The expression (8.36) for uniform diffusion barriers defines a PDE in 3D. In 2D flows, 
however,Eq. (8.36) is equivalent to two ODEs. This can be seen by substituting formula 
(8.23) intoEq. (8.36) and seeking the tangent vector x00 of the initial barrier position M0 at 
time 10 as a linear combination x0 = apt0 + /Jpt0 with a1 + p = 1. This form for x0 enables 
us to rewriteEq. (8.36) as an algebraic set of equations for the coefficients and :
|(p t0 ; J [ap t0 + J. t0 ]}| = T; a2 + P2 = 1:
Haller et al. (2020a) solve this system of equations and conclude the following:
Theorem 8.6 Initial positions of constrained material diffusion extremizers with uniform, 
pointwise transport density T0 are structurally stable trajectories of the ODE family
, 
qipt0 (x0°I2 - T02 t , T T0 t t .
x0 
------ 2--- pt0 (x0° ± I T 
|2 Jpt0 (x0°; 
T0 > 0: 
(8.38)
|pt0 (x0°|2 
|pt0 (x0°|2
Of these extremizers, constrained uniform transport minimizers must necessarily be perfect 
barriers with T0 = 0 , i.e., satisfy the differential equation
x0 = pt0 (x0°: 
(8.39)
Theorem 8.6has an important implication for diffusion extremizing material surfaces in 
2D flows. Namely, the most commonly observed features in diffusing scalar fields, such as 
jets and fronts, will generally not be minimizers of diffusive transport when constrained 
under a given initial concentration. Indeed, minimizers would have to be perfect minimizers 
with zero transport density, which is not to be expected in practice. This means that curves 
highlighted by high concentration gradients, such as those inFigs. 8.4 and 8.6 , are not 
inhibitors of transport but enhancers of transport. Diffusive transport across these diffusion 
enhancers is large precisely due to the large concentration gradients normal to the enhancer. 
This paradox has already been pointed out by Nakamura (2008) in the Eulerian frame but has 

314
Passive Barriers to Diffusive and Stochastic Transport
not been further explored. The above results yield the same effect in the Lagrangian frame 
from a strict mathematical analysis of diffusion extremizers.
Formula (8.38) defines two one-parameter families of autonomous, planar ODEs. For any 
fixed transport density T0 0, the two ODEs in (8.38) are well defined on the domain where 
|pt0 (x0)| > T0. All trajectories of these ODEs are technically uniform transport barriers, but 
only the structurally stable ones (such as stable and unstable manifolds of saddle points and 
limit cycles) will be observed in practice. Haller et al. (2020a) give several criteria for the 
existence and nonexistence of various types of transport barriers based on properties of these 
ODEs. We will show analytic and numerical examples to illustrate the use ofEqs. (8.38) in 
the next section.
8.3 Barriers to Diffusive Vorticity Transport in 2D Flows
An important example of an advection-diffusion equation is the 2D vorticity transport 
equation (2.68), which we rewrite here as
@t! + r! v = 
!; 
(8.40)
with 0 denoting the viscosity. Originally,Eq. (8.40) represents a nonlinear PDE for !. 
If the velocity field is known, however, thenEq. (8.40) is formally an advection-diffusion 
equation of the kind (8.1) for the passive scalar c = !, with diffusivity = and with the 
diffusivity structure tensor D = I.
In other words, once the velocity field is known, vorticity in 2D flows behaves like a 
passive, diffusive scalar carried by that velocity field. This fact is sometimes inaccurately 
disputed based on the study of Babiano et al. (1987), who report marked differences between 
the evolution of the vorticity and the evolution of a generic, passively advected scalar c(x, t° 
with diffusivity equal to the viscosity. Note, however, that Babiano et al. modify the initial 
condition !0(x) to generate an initial condition for c(x, t°: they randomize the phases of the 
Fourier modes of !0(x° to obtain c0(x° This alteration will make the initial condition c0(x° 
distinctly different from !0(x). Correspondingly, the evolution of the passive scalar c(x, t° 
will differ markedly from the evolution of the scalar vorticity !(x, t).
Once !(X; t° is viewed as a 2D passive scalar solving equation (8.40), we are constrained 
to select its initial condition as !0(x° = »r x v(x, t0°]z. An analysis of diffusive transport 
barriers for !(x, t° therefore requires the constrained barrier approach developed in §8.2. 
Such an analysis might seem like an overkill at first sight, as the evolution of the vorticity can 
be obtained at any time as the curl of the known velocity field. The velocity field, however, 
offers no direct clue about barriers to vorticity transport, which is nevertheless considered to 
be an important aspect of turbulence. Specifically, vortex cores have been broadly observed as 
near-material, closed inhibitors of vorticity transport (see Haller et al.,2016 and Katsanoulis 
et al.,2020 for reviews). We next discuss how these barriers can be identified directly from 
the velocity field.
An important simplification arises in our current setting, given that c(x, t° = !(x, t° is 
available at all times when the flow map Ftt0 of the velocity field is known. This enables us 
to rewrite the integrand of the general expression (8.4) of the diffusive transport St0 (M0° for 
c(x, t° = !(x, t° as

8.3 Barriers to Diffusive Vorticity Transport in 2D Flows
315
[ro! (Ft0; t)]T Tt0no = [WFto(xo)]"1 D^(xo°; t° [rFto(xo°] "T r^(xo°; t)no
= [VoFto (xo°] "1 D(Fto (xo°; t °V!(Fto (xo°; t K 
(8.41)
where we have used the chain rule to conclude V! = [VoFto] T Vo! The formula (8.41) 
eliminates the need for the approximation of Zto(Mo° via an expansion with respect to v. 
Instead, we obtain an exact expression for the normalized transport eto(Mo° in the form
eto (Mo° B Jmo (qto; no} dAo
Mo dAo
q to (Xo° = / 
[VoFto (xo°] "1 D(Fto (xo°; t °V!(Fto (xo°; t ° dt;
to
(8.42)
with the redefined transport vector qto (xo° replacing pto (xo° in all our results without any 
assumption on the smallness of the viscosity v . With this new definition of the transport 
vector, our main conclusion in §8.2.1about constrained diffusion extremizers can be restated 
for the vorticity as follows.
Proposition 8.7 Initial positions of uniform, constrained material extremizers of the diffusive 
transport of vorticity are structurally stable trajectories of the ODE family
, qqto (xo°l2 -To2 
To t t .
xo = 
- 
|2--- qt1 (xo)± | f o 
|2 Jqt1 (xo°; 
To > ft 
(8.43)
|q t1 (xo°|2 
|q t1 (xo°|2
with T > o denoting the pointwise vorticity transport density and with qt1 (xo° defined in Eq. 
(8.42). Of these extremizers, constrained uniform transport minimizers (i.e., barriers) must 
necessarily be perfect barriers with T0 = 0, i.e., satisfy the differential equation
xo = qt1 (xo°: 
(8.44)
These results suggests that vorticity transport maximizers are more likely to arise than 
vorticity transport minimizers, as the latter may only exist for T0 = 0. This is consistent with 
our remarks at the end of §8.2.1, where we discussed the point of Nakamura (2008) regarding 
observed barriers to diffusion actually maximizing diffusion locally in the flow.
An alternative computation of diffusive barriers to vorticity transport solves the conserva­
tion law
(q t1 (xo( 5 °°; no( 5)} = To 
(8.45)
arising from the independence of the integrand of the functional eto (Mo° defined in Eq. (^41-2) 
(see Noether’s theorem inAppendix A.8 ). Following the approach of §5.4.2for elliptic LCSs 
viewed as null-geodesics, Katsanoulis et al. (-0-0) use formulas (8.46) and (5.57) to express 
the tangent vector xo(5° and unit normal no as
xo( 5 ° = e(^( 5 °°; no( 5 ° = ±Je(^( 5 °°. 
(8.46)
Substitution ofEq. (8.46) into the conservation law ( 8.45) and differentiation with respect to 
the parameter 5 then gives

316 
Passive Barriers to Diffusive and Stochastic Transport
(rqtoe(^°; ±Je(^°) + (qt0, ±J (-Je(^°°) 
= 0; 
(8.47)
where we have used formula (5.58). CombiningEqs. (8.46) and ( 8.47), we obtain the 3D 
system of ODEs
x0 = e(<H
.. = (jrq t0 (xo°e(^°; e(^°) 
(8.48)
(q t1 (xo°; e(^°) 
’
which is well defined at each point where the transport vector qt1 is not orthogonal to the 
unit tangent vector e of the diffusion barrier.
Equation (8.48)is of the same general form as Eq. (5.60) for elliptic LCSs, and hence its 
closed orbits (limit cycles) can be found using the same numerical procedure we described 
in §5.4.2. The only difference here is that the initial conditions x0i j°(0° 2 G0 on the grid G0 
now define a constant
Tij = h t0 x 
. 0);
where we have defined the function ht1 (x0;^° := (qt0 (x0°, Je(0)} . We then monitor each 
trajectory of system (8.48) to see if it re-intersects the level set ht0(x0,0° = T'/'j in a vicinity 
of (x0i’j); 0). We will show vortex boundaries identified from this calculation in 2D turbulence 
in §8.3.2.
8.3.1 An Analytic Example: Vorticity Transport Barriers in a Decaying Channel 
Flow
As an example to illustrate the use ofEq. (8.43) in identifying uniform barriers to vorticity 
transport, we consider the 2D unsteady Navier-Stokes velocity field
t a cos y
v(X; t° = e vt 
0 
; 
(8.49)
with scalar vorticity
!(X; t° = ae~vt sin y.
The velocity field (8.49) describes a decaying horizontal channel flow between two no-slip 
boundaries at y = ± ^, with the parameter a 2 R+ governing the shear within flow (see 
Fig. 8.7).
Of all horizontal invariant material lines, the jet core at y = 0 is the most often noted 
barrier to the diffusion of vorticity, keeping positive and negative vorticity separated for all 
times. Accordingly, for a > 0, the norm of the vorticity gradient,
r!(X; t ° = e ~Vt 
0 
;
a cos y
is globally maximal along the jet core for all times. The upper and lower channel boundaries 
at y = ±^/2 are also observed as barriers to vorticity transport, yet the vorticity gradient 
vanishes at these boundaries. We will see next if both types of barriers are captured by 
Eq. (8.43).

8.3 Barriers to Diffusive Vorticity Transport in 2D Flows
317
Figure 8.7 Temporally decaying channel flow. Adapted from Haller et al. (2020a).
The flow map Ft0 (x0° for the velocity field (8.49) is
,t (x)° = ( x0 - a (evt - e vt0 ° cos yo
which enables Haller et al. (2020a) to compute the transport vector field q£(x0° defined in 
(8.42) as
q to (xo°
1 A A sin 2y0 
2v (t1 - t0° 
B cos y0
(8.50)
with
e_2-T.vt0 _ e -v(t1+tt>) 
2 e
A = — sin 2y0
1 e ~2vt1 +
2
B = a (e ~vt0 - e ~vt1).
Substitution of these formulas into the ODE family (8.43) gives the equation
1 
>
><
X0 = ------;------------ -
2v (t 1 _ t0°
A sin 2y0 
T0 
Bcosy0 
>>=
I +“ -----------  I 
I
Bcos y<> / 
|qt1 (xop -A sin2y0 >
t0>
(8.51)
for the time t0 position of uniform transport barriers with transport density T0 2 R.
.........  
T =   .... . = ,.., *. „• 
(8.52)
the ODE (8.51) simplifies to
x00 y0=0
B I B \
2v (t 1 - t0°
(8.53)
Therefore, y0 = 0 is an invariant line forequation (8.51) for the parameter value T0 selected 
as inEq. (8.52) . Consequently, the channel core line at y0 = 0 is a uniform, constrained 
barrier that maximizes vorticity diffusion with pointwise transport density equal to T0 as 
inEq. (8.52) . Indeed, any other horizontal material curve admits a strictly lower transport 
density than the channel core.
In contrast, choosing the constant
T0 = 0

318
Passive Barriers to Diffusive and Stochastic Transport
inEq. (8.51) gives the ODE
0 _ 
1 
A A sin2y0 \
x*” 2v a (11 - 10° |q t0 (xo )^ B cos yo )'
(8.54)
The channel boundaries at yo = •2 are one-dimensional structurally stable invariant 
manifolds for the ODE (8.54), because any physical perturbation to the fluid flow (8.49) on 
the same flow domain will preserve the two no-slip walls. Along the walls, we have
xo|yo=±^2 k qto (xo)|yo=±^/2;
thus the walls are also invariant manifolds of the perfect barrierequations (8.44) . Therefore, 
the channel walls at yo = ±^/2 are uniform, constrained barriers that minimize vorticity 
diffusion with pointwise zero diffusive transport density.
InFig. 8.8 , we show further perfect barrier candidate trajectories computed fromEq. 
(8.54) for a = 1, v = o^oi and »to, 11] = »o; 1]. None of these parabolic curves are, however, 
structurally stable features of the ODE (8.54) and hence all of them must be discounted in 
our analysis.
y
Figure 8.8 Perfect constrained diffusion barriers (parabolic curves and the horizontal 
walls) in the decaying channel flow shown inFig. 8.7 .
In §9.6.1we will reconsider this example as a special case of active vorticity transport in 
3D Navier-Stokes flows. That approach will also return the wall and the channel center as 
transport barriers, as well as all horizontal lines, as opposed to the parabolic curves shown 
inFig. 8.8 .
8.3.2 Numerical Examples: Vorticity Transport Barriers as Vortex Boundaries in 
Turbulence
We now illustrate the use ofProposition 8.7 on surface velocity data obtained from AVISO 
satellite altimetry measurements over a period of 90 days, as discussed inAppendix A.6 . 
To obtain elliptic diffusion barriers in this data set, Haller et al. (2020a) used a numerical 
scheme described in Karrasch and Schilling (2020), building on the LCS toolbox described 
in Karrasch et al. (2014). The steps in the computation involve: (1) a preselection of candidate 
regions for closed orbits of Eq. (8.43); (2) a placement of Poincare sections in these regions;

8.3 Barriers to Diffusive Vorticity Transport in 2D Flows
319
(3) launch of integral curves of Eq. 88.43) loom hie Poincare sections for different values of 
the transport density T0 until fixed points are located for the Poincare maps.
Figure 8.9shows the results of this search procedure, with the initial position of the outer­
most closed vorticity transport barriers (diffusive eddy boundaries) highlighted in red. Also 
shown in the background are the initial (left) and final (right) vorticity fields in Lagrangian 
coordinates, confirming the role of the red barriers in shaping the evolution of the vorticity 
field.
Final vorticity in Lagrangian coordinates:
Wo(Xo)
Initial vorticity:
-2
0
2
4
-29
-30
-31
-32
-33
lat
-28 -
w(Ftl (x0 ),t1)
-4
-34 - 4
-2
0
2
4
6
long 
long
Figure 8.9 Time t0 positions of outermost vorticity transport barriers (red) as material 
eddy boundaries in the Agulhas leakage, extracted from sea-surface velocities over a 
period of 90 days. Adapted from Haller et al. (2020a).
The four closed, uniform, constrained diffusion barriers inFig. 8.9 are very close to elliptic 
LCSs identified in the same region by other studies (see, e.g., Haller and Beron-Vera,2013 ; 
Karrasch et al.,2015 ; Hadjighasem et al.,2016 ; Hadjighasem and Haller,2016b ; Haller 
et al.,2016 ; Serra and Haller,2017b ) and to the unconstrained diffusion barriers shown in 
Fig. 8.6. In contrast to those other results, the present curves are optimized with respect to 
their ability to maximize vorticity transport (driven by large vorticity gradients) between the 
eddies and their surroundings.
We close this section with a numerical example for the alternative, null-geodesic-type 
calculation of vortex boundaries as outermost closed barriers to diffusive vorticity transport 
(seeEq. (8..8) ). More detail on the practical implementation of the algorithm can be found 
in Katsanoulis et al. (2020). The open source Matlab script, BarrierTool (Katsanoulis,2020 ), 
provides an automated implementation of this algorithm, along with several other methods 
discussed in this book for the computation of elliptic and hyperbolic LCSs.Figure 8.10 shows 
a comparison of vortex boundaries computed by BarrierTool using different methodologies 
for a 2D turbulence simulation.
The comparison in the figure includes vortex boundaries obtained as outermost vorticity 
transport barriers, outermost unconstrained diffusion barriers, geodesic (or black-hole) vortex 
boundaries and LAVD-based vortex boundaries. Also shown in the background are the DBS 
field, the FTLE field and the LAVD field. In most cases, there is close correlation between

320
Passive Barriers to Diffusive and Stochastic Transport
Figure 8.10 Comparison of material vortex boundaries obtained from different ap­
proaches in a 2D turbulence simulation on a doubly periodic domain. (a) Vorticity 
transport barriers (red) and unconstrained diffusion barriers (yellow) shown over the 
DBS field. (b) Vorticity triansportt barriers (red) and black-hole eddites (yellow) shown 
over the FTLE field. (c) Vorticity transport barriers (red) and LAVD-based vortex 
boundaries (yellow) shown over the LAVDofield. Videos showing the coherent ad­
vection of these diffusion and come parisons from vortex barriers obtained from the 
Okubo-Weiss criterion can be found at https://journals.aps.org/prfluids/ 
abstract/10.1103/PhysRevFluids.5.024701. Adapted from Katsanoulis et al. 
(2020). 
d
the material vortex barriers obtained from all these methods, but there are spatial regions in 
which only one of them is present.
8.4 Diiffusion Barriers in Compressible Flows
Our discussion of material barriers to diffusive transport has so far assumed that the velocity 
field v(x t° carrying the diffusive tracer c(x t° is incompressible. Flows in liquids are indeed 
practically incompressible but airflows are notably compressible. Their compressibility pre­
vents the application of the results of §§8.1-8.2 to atmospheric transport problems, which 
include the identification of temperature barriers surrounding the polar vortices (see Bow­
man, 1993; Chen, 1994; Lekien and Ross, 2010; Serra et al., 2017) and the detection of 
water vapor barriers that define atmospheric rivers (see Garaboa-Paz et al., 2015). Notable 
compressibility also arises in 2D velocity fields representing observations (Hadjighasem and 
Haller, 2016a) or numerical models (Beron-Vera et al., 2008b) of horizontal slices in plane­

8.4 Diffusion Barriers in Compressible Flows
321
tary atmospheres. Oil, flotsam and algae accumulation on the ocean surface also requires the 
use of 2D velocity field models (see, e.g., D’Asaro et al.,2018 and Zhong et al., 2012 ).
These examples of compressible velocity fields, however, are still mass-conserving. For 
instance, an oil spill in the ocean is buoyant and hence remains largely confined to the ocean 
surface without any significant loss of mass in the absence of other processes eroding it. A 
velocity field model for surface oil transport, therefore, should be mass conserving. Inspired 
by such examples, we discuss here diffusive transport in the presence of a carrier flow that 
may be compressible but conserves mass.
Haller et al. (2020a) consider a mass-unit-based concentration field c(x. t° that satisfies 
the compressible advection-diffusion equation. This equation was apparently first discussed 
by Landau and Lifshitz (1966) as a compressible, non-Fickian advection-diffusion equation 
for c (see also Thiffeault,2003 ). Under mass conservation, possible spontaneous decay and 
the addition of a source term, this advection-diffusion system of equations has the form
@t (pc° + r • (pcv° = Kr ■ (pDr c° - k(t°pc + f (X; t°p, 
c(X; 10° = c0(x°; 
(8.55)
@t p + r • (pv° = 0; 
p(X; 10° = p0(X°; 
(8.56)
replacing the simple incompressible advection-diffusionequation (8.1) in our present context.
InEq. (8.55) , v(X;t° is a C2-smooth (thus shock-free) velocity field on a compact spatial 
domain U Rn , with n 2; p(X; t° > 0 is the mass-density of the carrier medium satisfying 
the equation of continuity inEq. (8.56) ; k(t° is a possible time-dependent, spontaneous decay 
exponent for the concentration in the absence of diffusion; and f(X; t° is the spatiotemporal 
sink- and source-density for c(X; t°. Both k(t° and f(X; t° are assumed to be continuously 
differentiable. Finally, as we have assumed throughout this chapter, K 0 is the scalar 
diffusivity and D(X; t° = DT (X; t° is the positive definite and objective diffusion structure 
tensor.
Equation (8.55)is formally an advection-diffusion equation for the scalar field pc with a 
diffusion term that is not of the classic Fickian-type diffusion (which would involve the term 
Kr ■ (pDr (pc°°). Note, however, that with the modified velocity field
w = v + K Dr p; 
(8.57)
p
Eq. (8.55)can be recast as
@t (pc° + r • (pcw) = Kr ■ (Dr (pc)) - k(t°pc + f (X; t°p; 
(8.58)
which is an advection-diffusion equation with classic Fickian diffusion for the scalar field pc 
under the modified velocity field w. We will use this formulation in extending the upcoming 
results to detecting transport barriers in compressible stochastic velocity fields (see §8.5).
Combining the continuityequation (8.56) with the advection-diffusion equation (8.55) 
gives an equivalent compressible advection-diffusion equation for c in the form
Dc 1
= Kr ■(pDr c °- kc + f: 
(8.59)
Dt p
Beyond compressibility, a fundamentally new feature ofEq. (8.59) is that even for K = 0, 
the concentration of c(X; t° changes along trajectories of the velocity field v(X; t°. As a 
consequence, the total transport of c(X; t° through a material surface is more than just its 

322
Passive Barriers to Diffusive and Stochastic Transport
diffusive transport. In order to isolate the diffusive (or irreversible) component in this total 
transport, Haller et al. (2020a) introduce the scalar field
p(x, t° b ef0 k(s)dsc(x, t°- t ef0 k("d"f (Fs(x),s° ds, 
(8.60)
t0
which gives the initial concentration (at the location x0 at time t0 ) as a function of the 
current location x and current time t along trajectories, i.e., along characteristics of the PDE 
(8.55) in the nondiffusive limit of k = 0. In this limit, the p(x, t°-field is conserved along 
trajectories of the velocity field, because p(x(t°, t° = c0(Ft0(x°° = c0(x0° by definition and 
hence D p(x(t°, t° = 0 holds. This conservation law for p(x, t°, however, no longer holds for 
k > 0 and hence the change of along trajectories is purely due to diffusion.
This observation enables us to redefine the general transport problem through a material 
surface M(t° for c(x, t° as a purely diffusive transport problem for ^(x, t°, the reversible 
component of c(x, t°. Material differentiation ofEq. (f?6^0) been gives hie e<uiation
D ^(x, t ° = k-^— r ■ |p(x, t °D(x, t °r 
Dt 
p(x, t °
p(x, t° + t ef0 k("° d"f (Fs (x°, s° ds 
t0
(8.61)
Using this formula, Haller et al. (2020a) prove that the total transport of the concentration 
field p(x, t° across a material surface M(t° over a time interval»10,11] is given by
St0(M0° = k / 1 f h (rc0°T + (rb°Ti Tt0n0 dA0 dt + o(k°, 
(8.62)
t0 
M0
where r0 denotes the spatial gradient with respect to the initial condition x0, and the 
compressible transport tensor Tt0 and the Lagrangian scalar field b(x0, t° are defined as
T0 (x0° = p0(x0 ° [r0Ft0 (x0°] "1 D(Ft0 (x0°, t ° [r0Ft0 M -T,
b(x0, t° = f ef° k("°d" f (Fs0(x0°, s° ds: 
(8'63)
t0
The definition of Tt0(x0° in Eq. (^..33) mimics that of its incor^presiiitite connterpart in 
Eq. (8.5) but also contams ti^e i:ni.1:ial denstty p0(x0° and no longer assumes that the flow 
map Ftt0 is volume preserving. Importantly, the transport formula (8.62) coincides with its 
incompressible counterpart (8.7) in the absence of spontaneous concentration decay and 
sources (i.e., when b = 0°: This further confirms that the diffusive transport for Eq. 8?^55) 
should indeed be defined in terms of . With the expression (8.62), we may now seek 
unconstrained and constrained diffusion barriers as codimension-1 stationary surfaces of 
the leading-order term in the expression of S^0(M0°, as we have done in §§8.1-8.2 for hee 
incompressible case.
To identify unconstrained compressible transport barriers, we again subject each material 
surface to the same local initial concentration distribution that makes the surface maximally 
conducive to diffusive transport. Instead of simply describing a surface-normal orientation 
for the initial concentration gradient, as we did inFig. 8.3(b) , we now fix two constants, 
K0 > 0 and 2 (0, 1°, and select the initial concentration along M0 so that
K
r0c0(x0° = 
n0(x0°, k > 0, 
x0 2 M0: 
(8.64)
k

8.5 Transport Barriers in Stochastic Velocity Fields
323
We therefore prescribe uniformly high concentration gradients along M0 that are perfectly 
aligned with the normals of M0 and grow as k_“ as k ! 0. Under this uniformity assumption, 
the effect of the scalar field b(xo, t° will be negligible on the leading-order transport through 
M(t). Indeed, by the compactness of U and of the time interval»10,11 ], there exists a constant 
bound M0 > 0 such that 
(t 1 -
r0 -L r0 . (T(Xo>ro b(xo; .,,)
Po(Xo°
ds
M0
for all x0 2 U. We can therefore rewrite Sto(Mo° in Eq. (8.62) as
St1(Mo° = v1~a111 - to°Ko [ (Tt0no; no) dAo + O (v);
M0
showing again that the normalized total transport is given by
M (no; Tt1 no ) dAo
Sto(Mo° = Tto(Mo° + O(k“°; 
Tto(Mo° := Mo X ° Z-------; 
((.65)
o 
o 
o 
Mo dAo
with Tto denoting the time-average of the compressible transport tensor TJ defined in Eq. 
((.63). With this transport tensor at hand, the rest of the procedure for identifying uncon­
strained diffusion barriers in compressible flows is the same as in incompressible flows 
(see §(.1).
Therefore, to locate constrained material barriers to the transport of a diffusive scalar, one 
can directly follow the approach we discussed for incompressible flows in §(.2. The only 
difference is that this time, the transport vector defined inEq. ((.34) has to be augmented to
1 
t1
p,1 (xo° :=------- I [Tto(xo°(roco(xo° + rob(xo;t))] dt 
((.66)
t 1 - to to
to account for the presence of sources and sinks inEq. ((.62) .
To illustrate the identification of unconstrained diffusion barriers in a 2D flow, we use the 
computations of Haller et al. (2020a) on HYCOM, a data-assimilating hybrid ocean model 
carried out for the Agulhas region of the Southern Ocean over a period of 30 days. The 
ocean-surface velocity output obtained from this model is not divergence-free and hence can 
be viewed as a compressible 2D flow.Figure (.11 shows the DBS field ( (.20) computed from 
the compressible transport tensor ((.63). Overlaid in this figure are representative trajectories 
of the direction field ((.3(), illustrating a lack of closed uniform barriers enclosing eddy cores 
in the present compressible setting.
To illustrate that these material curves (obtained from purely advective calculations) indeed 
act as observed transport barriers for a diffusive scalar field, Haller et al. (2020a) solve the 
advection-diffusion equation (8.59), with k(t° = f (x; t° = o and D(x; t° = I, for the initial 
concentration shown in the left plot ofFig. (.12 . Shown in the right subplot of the same 
figure in Lagrangian coordinates, the final concentration indeed displays features delineated 
by the diffusion barriers obtained from a purely advective calculation.
8.5 Transport Barriers in Stochastic Velocity Fields
Here we discuss how the results of this chapter on material barriers to diffusive transport 
extend to stochastic flows generated by velocity fields with uncertainties. An inspiration for

324
Passive Barriers to Diffusive and Stochastic Transport
-28
-29
-30
-31
-32
-33
-34-4 
-2 
0 
2 
4 
6
Initial scalar concentration
Final scalar concentration
-28
-29
-30
-31
-32
-33
-34
Figure 8.11 Material barriers to compressible diffusive transport (red, computed 
from the ^T field with T0 = 1) in the HYCOM ocean surface data set. Also shown in 
the background is the DBS field. Adapted from Haller et al. (2020a).
-4-20 
2
-1.00
lon
0.75
0.50
0.25
lon
Figure 8.12 An evolving diffusive tracer field carried by the HYCOM ocean surface 
velocity data set over a period of 30 days in Lagrangian coordinates. Overlaid on the 
final concentration in red are the diffusion barrier curves computed shown inFig. 
8.11. Adapted from Haller et al. (2020a).
such a study isFig. 1.8 , which shows that even the highly uncertain and noisy trajectories of 
ocean drifters can face very clearly defined barriers to their evolution.
Noise and uncertainties in the velocity field v are often modeled by the addition of Brow­
nian motion to a deterministic velocity component v0. The resulting stochastic differential 
equation for the particle motion is described by an Ito process,
d x = vo(x; t ° dt + s/BxX, t ° d W( t °; 
(8.67) 

8.5 Transport Barriers in Stochastic Velocity Fields
325
where x(t) 2 Rn denotes the random position vector of a particle at time t; vo(x, t) denotes 
the deterministic (drift) component in the velocity; and W(t) is an m-dimensional Wiener 
process with diffusion matrix pKB(x, t) 2 Rnxm (see, e.g., Karatzas and Shreve, 1998). Here, 
the dimensionless, nonsingular diffusion structure matrix B is independent of the diffusivity 
parameter 0, which characterizes the overall strength of the random component of the 
velocity.
Without going into detail on the related stochastic calculus, we recall that a one-dimensional 
Wiener process W (t ) is a one-parameter family of random variables with W (t0° = 0: For each 
t > s > t0, the difference W(t) - W(s) is normally distributed with mean zero and variance 
t - s: The formal differential of the process satisfies dW(t)dW(t) = dt. An m-dimensional 
vector W(t° of Wiener processes has m entries that are independent Brownian motions.
Stochastic differential equations of the type (8.67) are significantly harder to handle than 
the ODE (2.17), but a stochastic flow will nevertheless exist under some reasonable (albeit 
technical) conditions. Here, we only recall an important classic result on the statistics of the 
solution x(t°. Let p(x; t ; x0; t0 ° denote the probability density function (PDF) for the current 
particle position x(t° with initial condition x0(t0° = x0 . In other words, assume that the 
expected time t-position, Ex01;50 »x(t)], of the particle starting from the initial position x0 at 
the initial time t0 satisfies
Ex0;t0 »x(t°] = 
xp(x; t; x0; t0° dx1 
dxn:
This PDF is then known to satisfy the Fokker-Planck equation (see, e.g., Risken, 1984)
@t p + r ■ (p vo° = 2 r ■ [r ■ (bbt p)], 
(8.68)
where the divergence of a tensor A 2 Rnxn is defined as an n-vector with coordinates
n
(r ■ A)i = Y— A ij, i = 1,:::, W .
i 
@xj
j=1 
j
An alternative form ofEq. (8.68) is
@tp + r ■(pvo° = Kr ■ (1 BBTrp), 
Vo = vo - 2r ■ (bbt), 
(8.69)
with the modified drift velocity Vo. For low-dimensional problems, solving the PDE (8.68) is 
considerably more economical than the Monte Carlo simulation of the stochastic differential 
equation (2.17).
Equation (8.69) is of a form similr- to the advcciiori-ditfusiori cc|uaiton (8.1). This will 
enable the identification of barriers to the diffusive transport of the PDF, p(x, t ; xo, to), using 
the results we have developed in this chapter. Specifically, if Vo is incompressible, i.e.,
r ■ [r ■ (BBT)] = o, 
(8.70)
thenEq. (8.69) becomes
@t p + r p ■ Vo = Kr ■ (2 BBTr p),
which coincides precisely with the incompressible advection-diffusion equasion 88.1) under 
the substitution
c = p, 
v = Vo, 
D = 2 BBT:

326
Passive Barriers to Diffusive and Stochastic Transport
Therefore, as concluded by Haller et al. (2018), as long as 2BBT is positive definite and 
objectively defined, all results of §§8.1-8.2 for nnconstaained and constrained diffusion 
barriers are immediately applicable to incompressible stochastic velocity fields. In applying 
those results, one must use the stochastic transport tensor (8.5)
Tto(xo° = 1 [ToFto(xo°]_1 B (Fto(X0°; t) B (Fto(X0°; t)T [ToFto(xo°] -T; 
(8.71)
with Ft denoting the deterministic flow map of the velocity field v0 defined in Eq. (8.69).
To locate transport barriers in compressible velocity fields, we note that the alternative 
version (8..9) of the advection-diffusion equation is of the compressible type (8.58) if we 
select
c B p; D B 2BBT; w B vo = Vo - kT ■ D; k(t° = f (x, t° = 0: 
(8.72)
2
Therefore, the Fokker-Planckequation (8..9) is equivalent to the advection-diffusion equa­
tion (8.58)with the velocity field
Vo b w - - Dr p = vo - - DTp - kT ■ D: 
(8.73)
As the equation of continuity (8.5.) must hold, substitution of the definition ofv fromEq. 
(8.73)into Eq. (8.5.) yields the equation
@tp + r ■P v0---- Drp -kT ■ D
p
= o;
which is equivalent to
@t p + r ■ (pvo° = -r ■ (r ■ ( d p°°.
(8.74)
This is the same PDE (8..9) that the probability density p satisfies.
Therefore, if we define v := v0 as in Eq. 88.73) and let p be a solution of Eq. 88.74) wih 
the initial condition given inEq. (8.5.) , then all results from §8.4apply to material barriers 
to the diffusive transport of the density-weighted probability density function c = p • p under 
the velocity field v = v0 in Eq. 88.73) (see Efjll^er et al., 2020a, for further discussion). These 
results then rely on the redefined transport tensor Tt0(x0° as
1T
Tto(X0° B 2Po(X0° [ToFto(Xo)] B (Fto(X0°; t) BT (Fto(Xo°; t) [ToFto(Xo)] 
; 
(8.75)
with Ft denoting the deterministic flow map of the velocity field v0 defined in Eq. 88.73).
For constrained stochastic barriers, we denote the initial probability density function by 
p0(x° := p(X; 10; x0; 10° and assume the initial carrier fluid density p0(x° as given. Then, the 
transport vector field inEq. (8.34) in the current setting becomes
p to (Xo° = T t1 (Xo°ro p||°: 
(8.76)
We close by illustrating the identification of barriers to stochastic transport on the same 
ocean surface velocity field that we analyzed for diffusion barriers in §8.1.1. We envision a 
stochastic velocity field model of the form (8.67) for particles floating on the ocean surface, 
with vo referring to the drift AVISO ocean velocity field. The added Wiener process term 

8.5 Transport Barriers in Stochastic Velocity Fields
327
in Eq. (8.67) then accounts for uncertainties, submesoscale flow, windage and surface wave 
effects on the particles. We again select the diffusivity k = 10“4 and the homogenous and 
isotropic diffusion-structure matrix B = I, so that D = 2BBT is positive definite and objective, 
as required by the theory we have discussed. As a consequence of these choices, we have 
v0 = v0 in Eq. (8.69), causing the stochastic transport tensor Tt0(x0° defined in Eq. (8.71) 
to coincide with the diffusive transport tensor T^(x0° we used in our analysis of the same 
AVISO data set in §8.1.1. Consequently, the same four closed material eddy boundaries as 
transport barriers also arise in the present context, but this time as barriers to stochastic 
particle motion.
As with our diffusive example involving the same data set, we want to verify our deter­
ministic predictions for stochastic transport barriers systematically and with high accuracy. 
To this end, we isolate the stochastic component of the Monte Carlo simulations of particle 
motion from their deterministic drift by showing the results in Lagrangian coordinates, i.e., 
as functions of the initial conditions x0 of the particles. Note that the presence of the Brow­
nian motion turns x0(t° = Ft0 (x(t)) into a stochastic, time-dependent variable. Randomness 
in the initial condition arises because the current random particle position x(t° is mapped 
back in time to the initial configuration under the deterministic inverse flow map Ftt0 of the 
deterministic drift velocity v0(X; t°.
Therefore, we have to perform the deterministic coordinate change x = Ft (x0° with 
differential
dx(t° = r0Ft0 (x0(t)) dx0(t° + @-fFt0 (x0(t°° dt 
(8.77)
on the stochastic differential equation (8.67). Comparing the differential (8.77) with the 
stochastic differential (8.67) then gives the stochastic dynamics in Lagrangian coordinates as
dx0(t° = PKB0(x0(t°; t° dW(t°; B0 b [r0Ft0]"1 B (Ft0, t), 
(8.78)
as obtained by Fyrillas and Nomura (2007) and Haller et al. (2018). The computation of 
unconstrained, elliptic material barriers to stochastic transport in Lagrangian coordinates is 
implemented in Notebook 8.4. 
—
Notebook 8.4 (StochasticBarriers) Computes unconstrained, elliptic material bar­
riers to stochastic transport and visualizes them in Lagrangian coordinates for a 2D 
unsteady velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/StochasticBarriers
Figure 8.13 shows the final result of a Monte Carlo simulation of Eq. (8.67) in the Lagrangian 
frame.
The figure is obtained from 50 realizations of the Lagrangian stochastic process (8.78) 
for each initial condition x0(0° taken from a uniform grid. As we have already noted, the 
same four deterministically computed closed transport barriers arise here as in Fig. 8.6. 
The stochastic particles are released from inside the initial positions of these four material 
eddies, as well as from seven additional shifted copies of these four regions. Figure 8.13 
confirms that the deterministically computed eddy boundaries indeed define sharp barriers

328
Passive Barriers to Diffusive and Stochastic Transport
lat [◦ ]
-29
-31
-33
-3 
-1
1
3 lon [◦]
Figure 8.13 Final positions of stochastic trajectories for the Lagrangian stochastic 
differential equation (8.78), computed for the AVISO sea surface velocity field in the 
Agulhas leakage. The blue, green, pink and red particles are initialized within the 
theoretically predicted closed diffusion barriers. Purple particles are released inside 
translated copies of the true stochastic transport barriers for comparison. A video 
showing the fundamentally differing impact of the true and the shifted diffusion 
barriers on the stochastic trajectories can be found at https://www.pnas.org/ 
doi/10.1073/pnas.1720177115#sm02. Adapted from Haller et al. (2018).
to stochastic particle transport for 90 days. Note that during the same period, the additional 
seven material regions show substantial leakage.
8.6 Exploiting Diffusion Barriers for Climate Geoengineering
We close this chapter by briefly discussing an application of diffusion barrier detection in 
geoengineering. A potential way to mitigate the impact of climate change would be the 
deliberate injection of sulfate aerosols from airplanes into the lower stratosphere (see, e.g., 
Crutzen, 2006) to mimic the cooling effects seen after large volcanic eruptions. Several 
benchmark studies have assessed the mean climatic response to such aerosol injections 
(Kashimura et al., 2017; Kravitz et al., 2017) but do not offer specific suggestions for 
optimal injection protocols. Ignoring the presence of transport barriers in designing injection 
schemes may well result in heterogeneous spatial coverage and localized high concentrations 
of aerosols. These, in turn, could lead to undesirably enhanced coagulation and sedimentation 
rates (see, e.g., Pierce et al., 2010). Without a more precise optimization of injection locations, 
therefore, we would limit our ability to assess the full potential of climate geoengineering.
Instead of releasing aerosols from fixed locations, Aksamit et al. (2022) propose a time­
varying injection location protocol that exploits the presence of material barriers to diffusive 
transport. They use the CESM2 climate model (Gettelman et al., 2019) under an SSP5-8.5 
scenario to simulate global wind fields at 72 levels over 18.75 years. The spatial resolution 
of the computation is 0:94 in latitude and 1:25 in longitude, with a temporal resolution of 
6 hours. The primary focus of the study is ontheT = 540K isentrope in the lower stratosphere

8.6 Exploiting Diffusion Barriers for Climate Geoengineering
329
Figure 8.14 Design of DBS-based aerosol injection location for climate geoengi­
neering. The upper plot of the Earth shows a representative snapshot of the backward 
DBS field, DBSBW(x0° := DBS^-7days (x0°, with two strongly attracting diffusion 
barriers (i.e., diffusion enhancers) highlighted in the green box. An injection site 
is selected as the nearby point with the largest value of the forward DBS field, 
DBSFW(x0° := DBStt00+7days (x0°, marked with areddotin the inset showing a nearby 
ridge of DBSFW. Units for both DBS fields are given per day. Adapted from Aksamit 
et al. (2022).
(about 20-25 km above sea level in the tropics), the elevations considered to be the upper limit 
of practical aerosol injection altitudes. To focus on this isentrope enables a computationally 
efficient 2D identification of diffusion barriers. As we have already noted, working with 
diffusion barriers, as opposed to purely advective LCSs, eliminates any ambiguity of injection 
site design arising from differences among LCS definitions.
Aksamit et al. (2022) compute the DBS field in both forward and backward time over a 
period of one week. From the backward-time DBS field (denoted DBSBW inFig. 8.14 ), they 
identify the strongest diffusion enhancers as ridges of the DBSBW field over high threshold 
values. Near each such enhancer, Aksamit et al. (2022) determine the location of the largest 
DBSFW value as a candidate for an aerosol injection site, as shown inFig. 8.14 .
This choice of aerosol injection locations secures the strongest local spread along ever­
stretching, diffusion-prone attracting material surfaces, while also preventing the attraction 
of distinct injections to the same section of such an attracting surface. This methodology is 
designed to prevent aerosols injected at initially distant sites from traveling great distances 
only to be attracted to the same location. Indeed, comparing their proposed injection with 
fixed-injection protocols using the same data set, Aksamit et al. (2022) find that the aerosols 
injected via the diffusion-barrier-based protocol surround the Earth quicker. The aerosols 
also achieve similar coverage with fewer injection sites even under practical and logistic 
restrictions on the barrier-based protocol.

330
Passive Barriers to Diffusive and Stochastic Transport
8.7 Summary and Outlook
In this chapter, we have moved beyond advective transport by seeking barriers to the re­
distribution of diffusive scalar fields. While the analysis of diffusive transport requires the 
introduction of further technical tools, it also creates an opportunity to define transport bar­
riers unambiguously in finite-time velocity data. Indeed, the notions of an LCS and OECS 
depend on the type of coherence definition used, but diffusive transport through a material 
surface is generally agreed to be the time integral of the classic diffusive flux through that 
surface.
Diffusion barriers can therefore be unambiguously defined as extremizing material surfaces 
of the diffusive transport. This extremization can be carried out either under the assumption 
of a specific initial concentration (constrained diffusion barriers) or under the assumption 
of the most diffusion-prone initial concentration along each surface (unconstrained diffusion 
barriers). Through the link provided by the Fokker-Planck equations, our discussion of 
diffusive barriers immediately carries over to barriers to the stochastic transport of particles 
whose velocity field contains an additive Brownian motion term.
In the range of small diffusivities, the diffusive transport through a material surface 
depends only on the velocity field and the diffusion structure tensor. Thus, an identification 
of diffusion barriers as extremizing material surfaces of the diffusive transport can also be 
formally performed for purely advective transport problems. This enables the definition of 
purely advective LCSs as material surfaces that become diffusion barriers under the addition 
of the slightest diffusion or uncertainty. The identification of the LCSs defined in this fashion 
will then involve the temporally averaged Cauchy-Green strain tensor over »10; 11] (see, e.g., 
formula (8.32) for the DBD field), as opposed to just Ctt10 . This agrees with one’s intuition 
that a universal LCS definition over a finite time interval should ideally depend on the full 
Lagrangian strain history of material surfaces, rather than just on the strain between the initial 
and the final time of the analysis. A similarly unique definition emerges from this approach 
for OECSs in the limit of vanishing diffusion.
We have discussed the calculus of variation problems defining diffusion barriers in incom­
pressible and compressible flows. In 2D flows, these considerations have lead to direction 
fields or ODEs whose structurally stable invariant curves are the initial positions of material 
diffusion barriers. These curves can be identified from velocity data using the LCS methods 
ofChapter 5 . A quick diagnostic for barriers, the diffusion barrier sensitivity (DBS) field, 
has emerged as a replacement for the FTLE in the present diffusive context.
The extremum problems for diffusion barriers in 3D flows are equally well defined but 
their solution would require the solution of systems of nonlinear PDEs with a priori unclear 
boundary conditions. Further ideas are needed, therefore, for the systematic extraction of 
diffusion barriers from 3D velocity data.
As a prelude to the next chapter, we have also shown how 2D vortex boundaries can 
be uniquely identified as outermost closed extremizing curves of the diffusive transport of 
vorticity. This constrained-barrier-based approach exploits that planar vorticity evolves as 
a passive diffusive scalar from its initial condition determined by the initial velocity field. 
The vortex boundaries obtained in this fashion will generally be close to, but nevertheless 
different from, the boundaries that extremize the active transport of vorticity viewed as an 
active vector field.

9
Dynamically Active Barriers to Transport
In the preceding chapters, we have discussed definitions and identification techniques for 
observed material barriers to the transport of fluid particles, inertial particles and passive 
scalar fields. All these barriers are directly observable in flow visualizations based on their 
impact on tracers carried by the flow. As mentioned in §1.7, however, the transport of several 
important physical quantities, such as the energy, momentum, angular momentum, vorticity 
and enstrophy, is also broadly studied yet allows no direct experimental visualization.
These important scalar and vector quantities are dynamically active fields, i.e., functions 
of the velocity field and its derivatives. Examples of proposed surfaces framing the transport 
of such active fields are turbulent-non-turbulent (TNT) interfaces for turbulent kinetic energy 
and enstrophy (see, e.g, Westerweel et al., 2009), as well as the momentum- and energy­
transport tubes (Meyers and Meneveau, 2013). A third example is surfaces separating uniform 
momentum zones (UMZs), i.e., layered structures with common streamwise velocities in wall- 
bounded turbulence (see, e.g., Adrian et al., 2000). We will collectively refer to such surfaces 
as dynamically active transport barriers or active barriers, for short.
All commonly used definitions of active barriers are non-objective, expressed in terms of 
observer-dependent features of dynamically active fields. This is at odds with experimental 
flow visualizations seeking to uncover these barriers, given that these experiments invariably 
return material structures highlighted by dye or particles. Figure 9.1 shows that instantaneous 
features of two dynamically active fields, the velocity and the vorticity, fail to indicate the 
frame-indifferent TNT boundary inferred from the distribution of fluorescent dye around 
a turbulent jet. Passing to various moving frames, such as the one shown in the bottom 
plot of Fig. 9.1, may introduce locally higher correlation between the active fields and the 
objective material boundary (thick black curve in the plot) while simultaneously reducing 
the correlation in other regions.
All this highlights the need for a notion of dynamically active transport barriers that is 
material and indifferent to the observer. This chapter will be devoted to the development of 
such an objective notion of active barriers in 3D unsteady velocity data. Additionally, 2D 
velocity fields can also be handled via this approach by treating them as 3D flows with a 
symmetry.
We will specifically discuss objective active barriers to dynamically active vector fields, 
such as the linear momentum, angular momentum and vorticity. Even though each of these 
vector fields is nonobjective, the viscous (i.e., diffusive) component of their transport can be 
described in an objective fashion. The transport of nonobjective active scalar fields, however, 
resists any similar description because even its diffusive component is observer dependent.
331

332
Dynamically Active Barriers to Transport
Jet boundary inferred from dye
200
220
240
260
280
300
320
340
360
380
40
200
220
240
260
280
300
320
340
360
380
400
vorticity magnitude ।
200 
250 
300 
350 
400 
450
200 
250 
300 
350 
400 
450
Same in a moving frame 
200 
220 
240 
260 
280 
300 
320 
340 
360 
380 
400
200 
250 
300 
350 
400 
450
Figure 9.1 The material envelope (red curve) of a turbulent jet inferred from dye 
visualization. The instantaneous velocity field (black arrows) is superimposed on 
the (Top Left) instantaneous dye concentration field, and (Top Right) instantaneous 
vorticity field in the lab frame. The latter plot is then recomputed (Bottom) in a 
frame moving with an extracted Eulerian vortex center marked by x. Adapted from 
Westerweel et al. (2009).
(9.1)
9.1 Setup
We consider the most general equation of motion for a 3D fluid flow with velocity field v(x, t) 
and density p(x, t), given by
D v
P D^ = “r P + r ' Tvis + g:
Here, p(x, t° is the (equilibrium) pressure, Tvis(x, t° = TTis(x, t° is the objective viscous stress 
tensor and g(x, t° denotes the resultant of all external body forces (see, e.g., Gurtin et al., 
2010).
We also consider a dynamically active vector field f, defined as a function of v and 
its derivatives. Examples of f include the linear momentum (f := pv) and the vorticity 
(f := ! = r x v). As we have seen in §3.3.2, both of these examples of f are nonobjective 
vector fields, making it challenging to describe their transport in an observer-independent 
way.

9.2 Active Transport Through Material Surfaces
333
(9.2)
We assume that the temporal evolution of f is determined by a partial differential equation
D
Dt f = hvis + hnonvis; 
@Tvishvis , 0; 
@Tvis hnonvis = 0:
Here, the function hvis(X; t° is assumed to contain all the terms arising from viscous stress term 
r ■ Tvis in Eq. (9.1), while hnOnvis(X; t° contains the remaining nonviscous terms governing the 
evolution of f. We also assume that hvis is an objective vector field, i.e., under any observer 
change of the form (3.5), the transformed vector field hvis is
ii vis(y; t ° = QT( t °hvis(x; t).
(9.3)
This assumption is satisfied for all common active vector fields of interest in fluid me­
chanics. For instance, consider the linear momentum f := v, for which we can rewrite 
Eq. (9.1) as
Df 
DP
= r ■ Tvis - rp + g —- V:
Dt 
Dt
A comparison ofEqs. (9.2)and (9.4) then gives
(9.4)
(9.5)
hvis = r ■ Tvis; 
hnonvis = rp + g 
Dt V;
and hence hvis is indeed objective by the objectivity of the Cauchy stress tensor Tvis.
As a second example, we consider the vorticity f :=rxv. To obtain an evolution equation 
for this active vector field, we divide Eq. (9.1) by P and take the curl of both sides to obtain 
the compressible vorticity transport equation
D^ = (rv° f - (r ■ v° f + ^2 r p x r p + r x gj + vr x r ■ Tvis
This time, a comparison ofEqs. (9.2)and (9.6) gives
hvis = vr x - r ■ Tvis 
p
(9.6)
hnonvis = (Tv° f “ (r ' V° f + -2 rP x rp + r x (- gj :
(9.7)
The objectivity of the vector field -p T ■ Tvis implies the objectivity of its curl (see for­
mula (3.40)) and hence the term hvis inEq. (9.7) is indeed objective when the vector 
field f is selected to be the vorticity. Similar conclusions holds for the angular momentum 
f := (x - x° x pv, with x marking a fixed reference point (see Haller et al., 2020b).
9.2 Active Transport Through Material Surfaces
We would like to quantify the diffusive transport of the active vector field f(x, t° through a 
material surface
M( t ° = Fto (Mo°; 
(9.8)
advected by the flow map Fto of v(x, t°. We select a smoothly oriented unit normal vector 
n(X; t° for M(t° at each point x 2 M(t°.
The total transport of any quantity through M(t° is the time integral of the instantaneous 
flux of that quantity through M(t°, which is therefore the quantity we have to discuss first.

334
Dynamically Active Barriers to Transport
Two different notions of the flux of a vector field have been used in the literature. The first is 
the vorticity flux through M(t° (see, e.g., Childress, ZCO^}, traditionally defined as
Flux! (M(t°° = ^ ! ■ n dA. 
(9.9)
This scalar quantity, however, measures the degree to which ! = r v is transverse to 
M(t), as opposed to the rate at which vorticity is transported through M(t°.
The second classic notion of vector field flux is the linear momentum flux through M(t° 
(see, e.g., Bird and Stewart, 2007), defined as
Fluxpv (M(t)) = J 
pv (v ■ n° dA. 
(9.10)
This expression arises as the convective surface integral term in the Reynold transport theorem 
(Eq. (A.58) in Appendix A.11) for computing d fv(t° f dV. In that context, Fluxpv (M(t)) 
is usually interpreted as the rate at which pv is carried through M(t° by fluid trajectories. 
For a material surface, M(t°, the correct convective flux of any quantity is zero, given that 
no fluid trajectory can cross M(t°. A closer inspection also reveals that this surface integral 
term does not provide the correct total diffusive flux through a material surface either (see 
Eqs. (A.61)-(A.62) in Appendix A.l 1).
Beyond these issues with Flux! and Fluxu, these flux notions also do not have the expected 
physical dimension of a flux, which should be the unit of the quantity of interest divided by 
time and multiplied by the surface area. Additionally, a direct calculation shows that neither 
Flux! nor Fluxu is objective due to the frame dependence of ! and v (see §3.3.2). The 
dependence of these two fluxes on the observer is clearly undesirable for the purposes of 
identifying intrinsic transport barriers, such as the experimentally inferred, objective TNT 
interface shown in Fig. 9.1.
Motivated by these shortcomings of Flux! and Fluxu , Haller et al. (2020b) introduce the 
diffusive flux of f (x; t° through M(t °, defined as
(M(t)) = [ [
M M(t)
Df
— ■ n dA
hvis
M(t)
n dA:
(9.11)
This expression gives the flux of the diffusive part of the rate of change of f along fluid 
trajectories. Note that the trajectories will not cross the material surface M(t° and yet 
generally generate nonzero O (M(t)). This quantity has the correct physical units expected 
from the flux of f : the units of f divided by time and multiplied by area. Equally importantly, 
under an observer change of the form (3.5), the transformation formula n = Qn for unit 
normals and the assumed objectivity of hvis inEq. (9.3)give the transformed flux in the 
y-frame as
O (M (t)) = j 
hi vis ■ n dA = j 
(QThvis) ■ (QTn) dA = j 
hvs ■ n dA = O (M( t )).
M(t) 
M(t) 
M(t) 
(9.12)
Therefore, the diffusive flux O (M(t)) of f through M(t° is objective.
Using this dimensionally correct and objective notion of the flux of f, we can now define 
the active transport functional

9.2 Active Transport Through Material Surfaces
335
/to (Al. i = —^ 11 $ (M(t°° dt = —^ 11 [ hvis ■ n dA dt; 
(9.13)
t 1 “ to J to 
t 1 “ t0 Jto JM(t)
which gives the time-normalized total diffusive transport of f through M(t°. In our notation, 
we view /t1 as a function of Mo = M (to° because later positions of the material surface 
M(t° are fully determined by the initial position Mo based on the relationship (9.8). As a 
time-average of an objective scalar field, /to (Mo° is also objective.
Formula (9.13) is not yet optimal for calculations as it formally requires the tracking 
of a moving material surface in time. A more easily computable form of /t (Mo° can be 
obtained by changing the surface integral over M(t° to Mo, i.e., by passing to the Lagrangian 
coordinates xo = Fto (x). To perform this coordinate change, we need to introduce some 
notation. First, for an arbitrary time-dependent Lagrangian vector field u(xo; t° (see §2.2.15), 
we let
. 
1 
ft1
u(xo° =------- I u (xo; t° dt 
(9.14)
t 1 - to to
denote the temporal average of u(xo;t° over the time interval »to,t 1]: We will also use the 
pull-back operation (Fto)* on u (see §2.2.15) to obtain the Lagrangian vector field
(Fto) * u(xo° = [rFJo (xo)] "1 u (Fto (xo°; t): 
(9.15)
With this notation and with the help of the surface element transformation formula (2.34), 
one obtains directly from Eq. (9.13) the equivalent expression
/t1 (Mo° = / bto ■ no dAo; 
(9.16)
Mo
with the barrier vector field defined as
bJo := det rFo (Fo)* hvis: 
(9.17)
We recall fromEq. (9.14)that the overbar refers to temporal averaging in our notation.
The Lagrangian vector field btto1 is objective (see §3.4.2) because under the observer change 
(3.5), we obtain
bt1 = det rFJo (Ft,) * hvis = det 
[rFto ] "1 Q(t°hvis
r _ 
i r _ 
i -1
■ __ _______ । । __ _______ ।
= det Q(t°rFtoQT(to° Q(t°rFtoQT(to° Q(t°hvis
= det rFtoQ(to° rrFto i "1 hvis
= Q( to°b to; 
(9.18)
where we have used the transformation formulas (3.45) and (9.3). We have already noted that 
the active transport functional (/''t1 (Mo° is objective, but its objectivity can also be verified 
directly from formula (9.16) (see Haller et al., 2020b).

336
Dynamically Active Barriers to Transport
9.3 Lagrangian Active Barriers
Using the active transport functional 
(M0), we can now formulate an objective notion of
a barrier to active transport as follows:
Definition 9.1 A structurally stable, codimension-1 material surface M(t° is an active barrier 
to the transport of the vector field f if the net transport of f due to viscous effects over the 
time interval»t0; t1] is zero through any subset of M(t°.
Such active material barriers are analogues of the perfect diffusion barriers for passive 
scalar fields we have discussed briefly for 2D flows in §8.2.1 (see Eq. (8.39)). In that context, 
perfect barriers with observable impact turned out to be rare. In contrast, as we will see next, 
the active barriers appearing in Definition 9.1 are ubiquitous.
To evaluate Definition 9.1,we observe that for the active transport tt01 to be zero through 
any subset of the material surface M(t); the integrand bt0 ■ n0 of must vanish pointwise 
along M0 . Equivalently, M0 must be everywhere tangent to the Lagrangian vector field 
bt0(x0), as illustrated in Fig. 9.2.
Figure 9.2 The initial position M0 of an active material barrier must be orthogonal 
to the barrier vector field btj (x0).
Technically speaking, therefore, if x0(s° denotes parameterized trajectories of the La­
grangian vector field b0(x0), then initial positions of active material barriers should be 2D 
invariant manifolds of the 3D autonomous dynamical system
x0 = bt0 (X0° 
(9.19)
generated by b0(x0). We will refer to Eq. (9.19) as the barrier equation and its evolutionary 
variable, s 2 R, as the barrier time. Under any Euclidean frame change (3.5), we obtain from 
Eqs. (9.18) and (9.19) the barrier equation in the coordinates y0 as
y0 = d [QT( 10°x0 ] = QT( 10°x0 = QT( 10°bt0 (x0° = QT( 10°Q( 10°b t0 = b t0 (y0°: 
(9.20)
Therefore, the barrier equation (9.19) is indifferent to the observer.
Finding observed active material barriers, therefore, amounts to finding observed transport 
barriers in the 3D steady flow (9.19). As noted in §4.4.2, any smooth curve of initial conditions 
for the differential equation (9.19) generates a 2D streamsurface of trajectories. Most of these 
surfaces, however, are not observed barriers to transport precisely because they are built 
of trajectories without any distinguished asymptotic behavior. Under the flow map, these 
surfaces remain smooth over any finite time interval but become incoherent due to stretching 

9.4 Eulerian Active Barriers
337
and folding. They are 2D analogues of the initially smooth sea-surface-height-based eddy 
boundary curves that rapidly become incoherent in the bottom plot of Fig. 5.41. Such sets of 
trajectories, as a whole, are then not robust with respect to changes in their initial conditions.
Exceptions to this rule are structurally stable invariant manifolds that are persistent under 
small, smooth perturbations of v (see §2.2.7). Based on Definition 9.1, therefore, we arrive 
at the following formulation of the main result of Haller et al. (2020b):
Theorem 9.2 An active material barrier to the transport of the vector field f over the time 
interval»10; 11] is a material surface B(t° whose initial position B0 = B(10° is a structurally 
stable 2D invariant manifold of the barrier equation (9.19).
In the general context discussed so far, the barrier vector field bt0(x0° is not necessarily 
incompressible, but it will turn out to be incompressible for the most important choices for f : 
momentum and vorticity. In those cases, Eq. (9.19) is a volume-preserving 3D autonomous 
dynamical system, whose structurally stable invariant manifolds we have already discussed 
in §4.4.2. In view of that discussion, the three possible active barrier geometries for volume­
preserving barrier equations in 3D are those shown in Fig. 9.3.
2D stable and unstable manifolds 2D stable and unstable manifolds 
of fixed points 
of periodic orbits
Figure 9.3 Possible geometries of active transport barriers in the barrier equation 
(9.19) for incompressible flows. Adapted from Haller et al. (2020b).
The barrier equations for momentum and vorticity turn out to be volume-preserving 
for incompressible flows. The equation for vorticity barriers is also volume-preserving for 
compressible Navier-Stokes flows, as we will see. Therefore, for all these flows, the possible 
active barriers fall in the three categories shown in Fig. 9.3.
9.4 Eulerian Active Barriers
Our discussion so far has focused on material barriers to active transport. As seen in §5.7, all 
objective Lagrangian approaches remain meaningful and objective in the t1 ! t0 t limit. 
In the present case, we may take this limit to obtain objective Eulerian active barriers that 
are instantaneous perfect minimizers of the normed instantaneous diffusive flux jO (M(t°°j 
for the active vector field f. We can summarize this conclusion as follows:
Proposition 9.3 An active instantaneous barrier to the transport of the vector field f at time 
t is a 2D surface B(t° that is a structurally stable 2D invariant manifold of the instantaneous 
barrier equation family

338
Dynamically Active Barriers to Transport
X0 = bt (x) = hvis (X; t ° ;
(9.21)
with t playing the role of a parameter and prime denoting differentiation with respect to the 
barrier time s.
The objective Eulerian barriers, as structurally stable invariant manifolds of Eq. (9.21), 
can be calculated from the instantaneous velocity field v(x; t° without Lagrangian advection 
by this velocity. Whenever hvis (x, t° is a divergence-free vector field (as will be the case with 
momentum and vorticity in Navier-Stokes flows), its Eulerian barriers will be one of the 
three types shown. These barriers generalize the notion of the OECSs discussed in §5.7 to 
active transport.
9.5 Active Barrier Equations for Momentum and Vorticity
We now write out the specific forms of the Lagrangian and Eulerian barrier equations (9.19)­
(9.21) for various active vector fields. The Eulerian barrier equations follow formally from 
their Lagrangian counterparts once we replace the flow map Ftt0 with the identity map and 
drop the overbar denoting temporal averaging.
9.5.1 Barriers to Linear Momentum Transport
Based on our calculations in Eq. (9.5),the Lagrangian and Eulerian barrier equations for the 
diffusive transport of linear momentum are of the form
X0 = det rFt0 (Ft0)*»r ■ Tvis]; 
x0 = r Tvis;
(9.22)
(9.23)
where again stands for the pullback operation. Consequently, for incompressible Navier- 
Stokes flows with kinematic viscosity , we have r Tvis = v in the momentumequation 
(9.4),and hence obtain the following result.
Proposition 9.4 For incompressible, uniform density Navier-Stokes flows, the Lagrangian 
and Eulerian barrier equations (9.22) and (9.23) for linear momentum are of the specific 
form
x0 = VP (Fto) * Av;
X0 = 
v:
(9.24)
(9.25)
Both dynamical systems in Eqs. (9.24)-(9.25) are steady and volume-preserving because 
Av is divergence-free for incompressible flows. Therefore, the three possible active barrier 
geometries in these barrier equations are those we have given in Fig. 9.3. Haller et al. (2020b) 
show that any no-slip boundary @U with a vanishing boundary-normal resultant force is an 
invariant manifold (i.e., free-slip boundary) for the barrier equations (9.24)-(9.25).
Taking the required second spatial derivatives in (9.24)-(9.25) for an experimentally 
measured velocity field can be challenging. As an alternative, letting a(x, t° = Dv (X; t° denote

9.5 Active Barrier Equations for Momentum and Vorticity
339
the Lagrangian acceleration, we can use the general momentum equation (9.1) to rewrite the 
active barrier equations (9.22) and (9.23) for linear momentum transport as
X0 = det rFto (Fto) *»pa + rp - g],
(9.26)
X0 = Pa + r P - g:
(9.27)
The acceleration a(x, t° used in these formulas can be extracted from numerical or experi­
mental data via the temporal differentiation of the velocity vector along trajectories.
9.5.2 Barriers to Angular Momentum Transport
We take the cross product of Eq. (9.1) with a vector r = x - X, where X marks a fixed reference 
point. Setting f := r X Pv; we obtain an evolution equation for this choice off in the form
— = (x - X° X Dp v - (x - X° X r p + (x - X° X g + (x - X° X r ■ Tvis:
Dt 
( 
° Dt ( 
° 
( 
° ( 
( 
°
A comparison withEq. (9.2)then implies the designations
(9.28)
hvis = (x 
X ° X r ' Tvis, hnonvis =
DP 
x - x °x -r p + g + —v :
(9.29)
Under the usual Euclidean frame-change (3.5), the objectivity of r ■ Tvis implies
hvis = (x - x° x r ■ Tvis = »Q(t° (y - y°] x [q(t°r ■ Tvis] = q(t° [(y - y° x r ■ Tvis]
= Q( t °h vis; 
(9.30)
and hence hvis is objective as required by assumption (9.3). This leads to the following result.
Proposition 9.5 For incompressible, uniform-density Navier-Stokes flows, the Lagrangian 
and Eulerian barrier equations (9.19) and (9.21) for angular momentum are of the form
x0 = vp (Ft0)* »(x - X°X Av], 
(9.31)
x0 = vp (x - X° X Av: 
(9.32)
These equations also define autonomous and volume-preserving dynamical systems with 
respect to the barrier time s 2 R. Again, any no-slip boundary @U is an invariant manifold 
(i.e., free-slip boundary) for these systems.
9.5.3 Barriers to Vorticity Transport
Based on our calculations in Eq. (9.7), the equations for Lagrangian and Eulerian active 
barriers to vorticity transport are
x0 = v det rFto (Ft,) * r x 1 r ■ Tvis 
p
(9.33)
x0 = v r
r ■ tvis
p
(9.34)

340
Dynamically Active Barriers to Transport
As in the case of linear and angular momentum barriers, we then obtain the following more 
specific result.
Proposition 9.6 For incompressible, uniform-density Navier-Stokes flows, the Lagrangian 
and Eulerian barrierequations (9.22) and (9.34) for vorticity are of the form
x0 = v (Ft ) * A!;
0 
t0
x0 = v A!:
(9.35)
(9.36)
Again, these equations define 3D, autonomous and volume-preserving dynamical systems 
with respect to the barrier time s 2 R. Haller et al. (2020b) show that if the curl of non­
potential body forces is normal to a no-slip boundary @U, then @U is an invariant manifold 
for Eqs. (9.35)-(9.36).
To avoid taking three spatial derivatives of the velocity field, we can use the general 
momentum equation (9.1) to rewrite Eqs. (9.35)-(9.36) in the equivalent form
x0 = det rFt0 (Ft0) * r x
a - 1 g
x0 = r x
(9.37)
(9.38)
a - 1 g
More specifically, for incompressible, constant density, Newtonian fluids subject only to 
potential body forces, the material and instantaneous barrier equations for vorticity in Eqs. 
(9.37)-(9.38) simplify to
x0 = (Fto)* r x a; 
(9.39)
x0 = r x a:
(9.40)
9.6 Examples of Active Transport Barriers
We now discuss two classes of flows in which both Lagrangian and Eulerian barriers can be 
explicitly computed. Our upcoming specific example within the first class of flows in §9.6.1, 
as well as the entire second class of flows, will be seen to belong to the family of directionally 
steady velocity fields,
v(X; t ° = a( t °v0(x°; 
(9.41)
which we have already briefly discussed in §2.2.8.For such flows, we can use the pull-back 
notation in formula (9.15) to rewrite the identity (2.54) as
v0 (X0° = [Ft0] * v (Ft0 (X0°; t); 
Ft0 = F$ “(s)ds; 
(9.42)
where Ft0 is the flow map of v(x, t° and Ft0 denotes the flow map of the steady velocity field 
v0(x°.
Averaging both sides of Eq. (9.42) in time over »10; 11] gives the identity
[Ftt0* v = v0;
(9.43)

9.6 Examples of Active Transport Barriers
341
which will enable us to calculate the right-hand sides of the Lagrangian active barrier 
equations for directionally steady velocity fields explicitly. Their Eulerian barrier equations 
then follow immediately. We will use formula (9.43) in the next two sections.
9.6.1 Active Transport Barriers in General 2D Navier-Stokes Flows
The 3D theory of active barriers provides an alternative to the 2D vorticity barriers we have 
constructed from a passive diffusion perspective in §8.3. In order to make the active barrier 
theory applicable to 2D flow, we follow Majda and Bertozzi (2002) by defining the planar 
variable x = (x 1; x2° 2 R2 and writing any 2D incompressible Navier-Stokes velocity field 
V(X; t° and pressure field p(X; t° in the 3D form
V(X; t ° = (V (X; t °; W(X; t ; 
P (X; t ) = P (X; t); 
X = (X; X 3° 2 R3 ; 
(9.44)
for an appropriate vertical velocity w(X; t). With this notation, the 3D incompressible Navier- 
Stokes equation (2.67) with g = 0, evaluated on its 2D solutions, can be rewritten as
@tV + (V Vj V = - - Vp + vAV; 
(9.45)
@tw + Vw ■ V = vAw: 
(9.46)
Here, the hat on the differential operators r and A refers to their 2D versions, taken with 
respect to the X variable.
The scalar advection-diffusion equation (9.46) coincides with the 2D vorticity transport 
equation (8.40),and hence one of its solutions is
w(X; t) = ! (X; t); 
(9.47)
the scalar vorticity field of the 2D Navier-Stokes solution V(X; t). Using this solution and 
the clockwise 90 rotation matrix J defined in formula (2.106), Haller et al. (2020b) prove 
that for 2D incompressible, uniform-density Navier-Stokes flows, the Lagrangian and Eule- 
rian barrier equations (9.24) and (9.25) for linear momentum are autonomous Hamiltonian 
systems (see §A.5) of the form
x0 = vp JVo ! (Ft0 (Xo°; t); 
(9.48)
x0 = vp JV ! (X; t): 
(9.49)
The Hamiltonians, ! (Ft0 (X0°; t) and ! (X; t), serve as stream functions for the vector fields 
inEqs. (9.48) and (9.49), with the barrier time s acting as a time-like evolutionary variable. 
This enables us to conclude the following explicit results for active momentum barriers.
Proposition 9.7 Time-t0 positions of Lagrangian active barriers to linear momentum trans­
port in 2D incompressible Navier-Stokes flows are structurally stable level curves of the 
time-averaged Lagrangian vorticity ! (Ft0 (X0°; t). Eulerian active barriers to linear mo­
mentum transport at time t are structurally stable level curves of the scalar vorticity !X(X; t).

342
Dynamically Active Barriers to Transport
While streamlines of 2D velocity fields are not objective, the streamlines of the barrier 
equations (9.45)-(9.49) are objective because the right-hand sides of these equations are 
objective vector fields, as we have concluded from Eq. (9.20).We note that the level curves of 
the instantaneous scalar vorticity !(x; t) have long been used in flow visualization. Proposition 
9.7 explains the role of these level curves as perfect instantaneous barriers to diffusive 
momentum flux.
Haller et al. (2020b) also examine active barriers to 2D vorticity transport. Using the 
notation
d! (X0; 10; 11° := ! (Ft0 (X0° ; t1 ^ ~ ! (X0; tq) 
(9.50)
for the Lagrangian vorticity-change function along trajectories over the time interval»t0; t1], 
they obtain that the corresponding material and instantaneous barrier equations for vorticity 
are also autonomous Hamiltonian systems of the form
X0 = —— J^r0 Sb (X0; 10; 11) ; 
(9.51)
11 - 10
x0 = v jr D! (X; t): 
(9.52)
We therefore conclude that:
Proposition 9.8 Time-t0 positions of Lagrangian active barriers to vorticity transport in 2D 
incompressible Navier-Stokes flows are structurally stable level curves of the Lagrangian 
vorticity-change function 5! (x0; t0; t1). Eulerian active barriers to vorticity transport at time 
t are structurally stable level curves of the material derivative D! (X; t), or equivalently, of 
the vorticity Laplacian A!) (X; t).
Again, both level curve families featured in Proposition 9.8 are objective because the 
right-hand sides of the barrier equations (9.51)-(9.52) are objective vector fields by Eq. 
(9.20). Tie level-curve-based identification of active material barriers in 2D Navier-Stokes 
flows, as described in Propositions 9.7 and 9.8,is implemented in Notebook 9.1. 
—
Notebook 9.1 (Hamiltonian) Computes active material barriers to momentum or vorticity 
as level curves of an appropriate Hamiltonian for a 2D Navier-Stokes velocity data set.
https://github.com/haller-group/TBarrier/tree/main/TBarrier/2D/ 
demos/ActiveBarriers/Hamiltonian
Of particular interest are nested families of closed level curves of the Hamiltonians arising in 
Eqs. (9.48)-(9.49) and (9.51)-(9.52). Indeed, as 2D analogues of the invariant tori shown in 
Fig. 9.3,closed level curves ofa function are structurally stable outside small neighborhoods 
of points where the gradient of the function vanishes. Outermost families of nested families 
of closed level curves of ! (Ft0 (X0); t) or 5!) (X0; 10; 11) can, therefore, be used to define active 
Lagrangian vortex boundaries that act as observed barriers to the transport of momentum 
or vorticity, respectively. Similarly, active Eulerian vortex boundaries can be objectively 
defined as outermost members of nested families of closed level curves of !(X; t) or D! (X; t), 
respectively.

9.6 Examples of Active Transport Barriers
343
Despite their conceptual simplicity, outermost contours of these Hamiltonians tend to 
be sensitive under numerical extraction. A robust alternative for the visualization of active 
vortex boundaries is the use of LCS-detection tools introduced in Chapter 5,such as the 
FTLE and the PRA. We will discuss active versions of those LCS detection tools in more 
detail in §9.7.
Example: Directionally Steady Family of 2D Navier-Stokes Flows 
Consider the spatially doubly periodic, 2D Navier-Stokes velocity field family
v (X, t ° = e _4^2'vt v0(X °; 
p (X, t ° = e“4^2'vt p 0(X °,
v0(X\ = y ( akk2 sin (2-k ' X° “ bkk2 cos (2-k ' X° \
V (X° 
I - a k k 1 sin (2-k ■ X ° + b k k 1 cos (2-k ■ X °
jkj2='x 
’
(9.53)
where V0 and p0(X° are solutions of the steady planar Euler equation for some positive integer 
' (see Majda and Bertozzi, 2002). For this flow family, we have
4.-7 e4-yt V0
AA !
i v \ 
A I
A &
v =
/ -4-2'v 
I A 
A !
(9.54)
Comparing formulas (9.41) and (9.53), we see that v(X, t° is a directionally steady velocity 
field. Instead of the equally valid Eqs. (9.48)-(9.48) for general Navier-Stokes flows, we 
exploit the directional steadiness of v to simplify the calculations. By formulas (9.43) and 
(9.54), we have
[F tto ] * A v = -4-2' [F tto ] * v = -4-2' e "4^2'vt0 v0: 
(9.55)
Taking the X-components of the general momentum barrier equations (9.24)-(9.25) and using 
formula (9.55), we therefore obtain
X0 = -4-2'vp e;"2'yt v0 (X0°,
X0 = -4-2'vp e4'2'yt v0 (X
(9.56)
(9.57)
Therefore, both Lagrangian and Eulerian barriers to linear momentum transport in the 2D 
Navier-Stokes flow family in Eq. (9.53) are structurally stable streamlines of the steady 
velocity field v0.
To compute vorticity barriers in the example velocity field (9.53), we observe that
! = @x1 V2 - @X2V1 = -2-'e~^tvt&0; 
(9.58)
!0 (X° = y ak cos (2-k ■ X° + bk sin (2-k ■ X°. 
(9.59)
jkj2='
As v0 solves the steady planar Euler equation, the trajectories of v(X, t° remain confined to 
the steady streamlines of v0 (X°. Since these trajectories also conserve the inviscid vorticity 
!0 by the vorticity transport equation (8.40), the change in the vorticity ! (X, t° along the 
trajectories of v(X, t° can be computed as
5!) (X0; 10; 11° = -2-' (e-4"2'vt1 - e-4'2'vt°) A, (X0°. 
(9.60) 

344
Dynamically Active Barriers to Transport
Consequently, the level curves of 6o> (x0; t0; 11 ° coincide with those of the inviscid vorticity 
!0 (x0°, which are in turn just the streamlines of v0 (x0°. Finally, we note that
A! (X; t° = 8^3'2e-4^2'vt!0 (x°; 
(9.61)
and hence the level curves of Aw (x; t° also coincide with those of v0 (x°.
Using the expressions (9.60) and (9.61), we conclude that both Lagrangian and Eulerian 
active barriers to vorticity and linear momentum transport coincide with the streamlines of 
V0 in the example flow (9.53).
To gain some physical intuition for this result, we select k1 = 0, ' = k2 = 1, a(1;0° = b(1;0° = 
a(0; 1° = 0 and b(0>1) = a, then let x2 ! -x2 in the velocity field (9.53) to obtain the decaying, 
unsteady channel flow velocity and vorticity field
v(x; t° = e 4':'Vt I aco^x2 j; 
!(x; t) = 2,rae4" sin2,rx2. 
(9.62)
We have already considered a scaled version of this velocity field in Chapter 8 to identify 
passive diffusion barriers for vorticity transport (see Eq. (8.49) and Fig. 8.7). The present 
flow (9.62) has the same streamlines but has its vertical walls at x2 = ±44, as shown in Fig. 
9.4).
Figure 9.4 Decaying planar Navier-Stokes flow in a channel with no-slip walls at 
x 2 = ± 4.
Normalized by their instantaneous global maxima, the normalized linear momentum 
pv0 (x° = (cos 2nx2; 0° and the normalized vorticity !0 (x° = sin 2nx2 are both constant in 
time. These fields, therefore, show no structural reorganization in the topology of the momen­
tum and vorticity fields. Indeed, all horizontal lines are observed as stationary Lagrangian 
and Eulerian barriers between higher and lower values of both of these scalar fields (see the 
top two plots of Fig. 9.5).
These are precisely the streamlines of the velocity field V0 (x°, in agreement with our 
general results above for the general example family (9.53). These parallel streamlines are all 
structurally stable on compact sets. Indeed, small enough perturbations of their underlying 
stream functions will introduce no fixed points in the barrier equations, and hence the parallel 
streamline family may smoothly deform but will persist. Therefore, all these horizontal 
curves qualify as both Lagrangian and Eulerian barriers to active transport of momentum 
and vorticity.

9.6 Examples of Active Transport Barriers
345
Figure 9.5 (Top) Vorticity and linear momentum, normalized by their maxima at 
an arbitrary time instance in a decaying planar channel flow. These plots remain 
steady in time, with all horizontal lines (some shown dotted) acting as barriers to the 
vertical redistribution of the vorticity and linear momentum. (Bottom) Predictions 
for transport barriers in this problem from other approaches (see the text). Adapted 
from Haller et al. (2020b).
In contrast, the bottom two plots of Fig. 9.5 show available predictions from other ap­
proaches computed for this example. Specifically, in the bottom left subplot, we reproduce 
the only two structurally stable curves of Fig. 8.8 (the two walls) that represent perfect bar­
riers to passive vorticity transport in this flow. In the bottom right subplot, we show perfect 
barriers to momentum transport predicted by the results of Meyers and Meneveau (2013), 
as computed for this example by Haller et al. (2020b). In contrast, the theory developed in 
this section correctly identifies all horizontal lines as material and Eulerian barriers to the 
diffusive transport of both momentum and vorticity, in agreement with observations (see the 
upper right plot of Fig. 9.5).
9.6.2 Directionally Steady Beltrami Flows
We have already discussed steady Beltrami solutions of the Euler equation in §4.4.3, but 
Beltrami flows have an even broader significance. Namely, virtually all explicitly known, 
unsteady solution v(x; t° of the 3D incompressible Navier-Stokes equations satisfy the strong 
Beltrami property
X; t ° = k (t °V(X; t °
(9.63)

346
Dynamically Active Barriers to Transport
for some scalar function k(t). By definition, for any such incompressible strong Beltrami 
flow, we obtain
A! = r (r ■!° - r x (r x ! = - k 3v,
12
Av = - A! = - k 2V: 
k
Assume now additionally that v(x, t° is directionally steady, i.e.,
v(X; t° = a(t°v0(x°; ! (X; t) = r x v(X; t) = k(t)a(t°v0 (x
(9.64)
(9.65)
hold for some continuously differentiable scalar function a(t°. Note that any steady strong 
Beltrami flow v0(x° (which necessarily admits k(t° = k = const.° solves the steady Euler 
equation and generates a directionally steady Beltrami solution v(x, t° = exp (-vk21) v0(x° 
for the unsteady Navier-Stokes equation under conservative forcing (see Majda and Bertozzi, 
2002). Examples of such unsteady but directionally steady Beltrami flows include the Navier- 
Stokes flow family (Ethier and Steinman, 1994) 
v(X; t ° = e vd2t v0 (x); 
v0 (x) = - a
«
and the viscous, unsteady version,
eax1 sin (ax2 
± dx3 ° + eax3 cos (ax 1 ± dx2°
eax2 sin (ax3 
± dx 1 ° + eax1 cos (ax2 ± dx3 ° 
,
eax3 sin (ax1 
± dx2° + eax2 cos (ax3 ± dx1°
(-.66)
v(X; t° = e vtv0 (x
v0 (x
Asinx3 + Ccosx2
- B sin x1 + A cos x3 ® 
C sin x2 + B cos x1
(9.67)
of the classic ABC flow (4.29). Further examples of 3D, unsteady but directionally steady 
Beltrami solutions are given by Barbato et al. (2007) and Antuono (2020).
For any directionally steady strong Beltrami flow, the pull-back identity (9.43) combined 
with the second formula (9.64) shows the Lagrangian momentum barrier equation (9.24) to 
be of the form
X0 = bt = vP (FX) *Av = -vp(FX) *«k2v0
t1
= 
. 1 . I k2 [rn(Xo°] ■ (a(t°v0(Ft0(Xo°°) dt
t 1 t0 J t0
P t1 k2(t° dt
=-------- --- -------------v0(xo°: 
(9.68)
11 - 10
This, in turn, gives the Eulerian momentum barrier equation (9.25)
x0 = -vp k 2a( t °v0(x°: 
(9.69)
Similarly, the pull-back identity (9.43) combined with the first formula (9.64) gives the
Lagrangian momentum barrier equation (9.35) for these flows as

9.7 Active LCS Methods for Barrier Detection
347
x0 = bt0 = v (F>)*A! = v(Ft0) * «(t°k3v0
= 
f k3 [roFto(X0°]_1 (o(t°v0(Fto(X0°°) dt
t 1 
t0 J t0
v ft1 k3 a(t° dt
t0 
( ° 
V0(X0°:
t 1 - t0
This then implies that the Eulerian momentum barrier equation (9.36) takes the form
x0 = -vp k 2a( t °v0(x'
(9.70)
(9.71)
A comparison of Eqs. (9.68)-(9.71) with the fluid particle equation of motion x = v0(x° 
for the steady factor of directionally steady, strong Beltrami flows shows that all streamlines 
of all four barrier equations coincide with the streamlines of v0(x°. Therefore, we obtain the 
following general result on active transport barriers in such flows, first deduced by Haller 
et al. (2020b).
Proposition 9.9 Both material and instantaneous active barriers to the diffusive transport of 
linear momentum and vorticity in directionally steady strong Beltrami flows coincide exactly 
with structurally stable, 2D invariant manifolds of the steady component v0(x° of the velocity 
field. These in turn coincide with 2D invariant manifolds of v(x t°, as defined in (9.65).
Proposition 9.9 states that structurally stable, 2D invariant manifolds of the steady velocity 
field v0(x° are both Lagrangian and Eulerian barriers to the active transport of momentum and 
vorticity. We have already identified such manifolds in earlier chapters as sets of trajectories 
emanating from invariant curves of appropriate Poincare maps, whenever such first-return 
maps can be constructed in the flow. Figures 4.22, 4.25, 5.38 and 5.48 show these invariant 
curves and the corresponding 2D invariant manifolds computed via various coherent structure 
detection methods for the steady ABC flow (4.29). We have just deduced that these manifolds 
(2D invariant tori in elliptic regions and 2D stable and unstable manifolds in mixing regions) 
also provide Lagrangian and Eulerian barriers to the diffusive transport of vorticity and 
momentum.
Figure 9.6 compares these objectively defined barriers with plots of various nonobjec­
tive Eulerian diagnostics evaluated on the unsteady ABC flow (9.67). These nonobjective 
diagnostics include sectional streamlines (§4.4.2), as well as the vorticity norm and the 
Q-parameter (§3.7.1). In contrast, the Poincare map computed for the autonomous barrier 
equations (9.68)-(9.71) associated with the ABC flow (9.67) will provide the same Poincare 
map revealing the same barriers (shown in Fig. 9.6) in any frame of reference.
9.7 Active LCS Methods for Barrier Detection
The results we described in §9.5 create a remarkable opportunity to identify objective 
Lagrangian and Eulerian barriers to active transport in general unsteady flows from the 
analysis of the steady, 3D, incompressible flows represented by the corresponding barrier 
equations. The active barriers to be located are structurally stable 2D invariant manifolds of 
these flows and hence can be located using the tools we discussed for chaotic advection in

348
Dynamically Active Barriers to Transport
Figure 9.6 Three nonobjective diagnostics (sectional streamline plots, the vorticity 
norm and the Q-parameter) and the active Poincare map revealing active transport 
barriers objectively for the unsteady ABC flow (9.67) with A = V3, B = V2 and 
C = 1, at time t = 0. The three Poincare plots remain the same for all times because 
the velocity field is directionally steady. Adapted from Haller et al. (2020b).
§4.4and throughout Chapter 5 for 3D LCSs. We will here briefly survey some of these tools 
in the context of active transport barrier detection.
As a preliminary remark, we note that all active barrier equations are autonomous and 
hence the barrier vector fields, btj(x0°, can be normalized to unit length without changing 
the geometry of the trajectories they generate. As a consequence, at all x0 points with 
bt0(x0° , 0; the invariant manifolds of the vector fields btj(x0° and b^J(x0°/|bt1 (x0°| coincide. 
As an advantage, applying the active LCS diagnostics we discuss below to the normalized 
barrier equation x00 = btt01 (x0°/|btt10 (x0°| will reveal all barriers with equal clarity (see §9.8.3 
for an example). In the absence of such a normalization, barriers tangent to larger btt01 (x0° 
vectors will be more strongly highlighted by most active LCS and OECS diagnostics. These 
highlighted active barriers have larger sensitivity, i.e., the transport of the underlying active 
vector field will increase quickly from zero under small perturbations of the barriers (see 
our related discussion on the diffusion barrier sensitivity field (8.20) for passive diffusion 
barriers).
To fix notation, we select a time interval »10; 11] over which we seek to locate active 
transport barriers for the unsteady velocity field v(x; t°. If x0 (s ; 0; x00° denotes the trajectory 

9.7 Active LCS Methods for Barrier Detection
349
of the Lagrangian barrier ODE (9.19) starting at the initial barrier time s = 0 from x00, 
then the corresponding autonomous flow map for this barrier ODE will be denoted by the 
Lagrangian active flow map
Fst;;t1: X00 ! xo(^;0; xo0°:
(9.72)
For Eulerian barriers, the limiting Eulerian active flow map of the Eulerian barrier ODE 
(9.21) will be denoted by
Fs;t: xo ! x(^ ;0; xo°:
(9.73)
9.7.1 Active Poincare Maps
Recall that passive Poincare maps for 3D steady flows (see §4.4.1) map initial conditions of 
trajectories launched from a selected 2D section to their first return to that section, provided 
that such a return exists. One can also compute such first return maps for the 3D steady barrier 
equations (9.19) and (9.21) under their active flow maps (9.72) and (9.73), respectively. We 
have already seen an example of such an active Poincare map in Fig. 9.6.
Transport barriers of an active Poincare map (in the sense of Definition 4.1) mark intersec­
tions of 2D active barriers with a 2D Poincare section. The full barriers can then be identified 
by launching trajectories of the appropriate Lagrangian or Eulerian barrier equation from the 
invariant curve under their active flow maps (9.72) and (9.73), respectively. This procedure 
can reveal elliptic active barriers (invariant tori) or hyperbolic active barriers (stable and 
unstable manifolds) in the barrier equations.
In the absence of a clear choice for an active Poincare map, active versions of LCS methods 
can be used to uncover structurally stable invariant manifolds in the Lagrangian and Eulerian 
barrier equations. We will recall some of these LCS methods next.
9.7.2 Active FTLE (aFTLE) and Active TSE (aTSE)
By active FTLE (aFTLE) we mean the implementation of the FTLE diagnostic introduced 
in §5.2.1 on the steady Lagrangian barrier equation (9.19) or its Eulerian limit (9.21). The 
associated active Cauchy-Green strain tensor for the barrier equation (9.19) is defined as
cLti (X0° := [rF0,ti (X0°] T rF0,0 (x0°.
(9.74)
With n Cts0;t1 denoting the maximal eigenvalue of the symmetric, positive definite tensor 
CS0;t1, the aFTLE field of the active vector field f(x, t° appearing in Eq. (9.2) is defined as
aFTLES0^ti (X0; f° = 2^ log An (C^ (x0°) . 
2jsj
(9.75)
The computation of aFTLE for 2D and 3D flows is implemented in Notebooks 9.2 and 9.3, 
respectively.

350
Dynamically Active Barriers to Transport
Notebook 9.2 (aFTLE2D) Computes active finite-time Lyapunov exponents (aFTLE) in 
a 2D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ActiveBarriers/aFTLE2D
Notebook 9.3 (aFTLE3D) Computes active finite-time Lyapunov exponents (aFTLE) in 
a 3D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ActiveBarriers/aFTLE3D
Note that the passive FTLEt0 (x0° field is limited by the length of the time interval»10,11] over 
which the velocity data is available. In contrast, on the same data set, aFTLES0;t1 (x0; f° can be 
computed for an arbitrarily long barrier time jsj as long as the barrier trajectories stay in the 
region U in which velocity data is available. As a consequence, aftle can uncover much 
finer spatial detail for active barriers than FTLE can for LCSs in the same velocity data set.
To illustrate this point, we show in the upper plots of Fig. 9.7 a comparison of the vorticity­
based aFTLE (for s = 15 and s = 50) with the passive FTLE computed over the same time 
interval »t0, t1] = »0, 5] for the unsteady ABC flow (9.67). Notice how the aFTLE field extracts 
structures in increasing detail under the increasing barrier time s. We also note that aFTLE 
is always guaranteed to converge for almost all initial conditions (see Appendix A.3) on this 
volume-preserving steady flow. In contrast, the convergence of FTLEtO (x0° is generally not 
guaranteed in an unsteady flow with time-varying structures.
The t1 ! t0+ 
t limit of the aFTLE field in Eq. (9.75) is the active instantaneous FTLE
field,
aFTLE*f(x;f) = 21 log A^ (C^ (x°), 
(9.76)
2jsj
with CS;t (x° computed from the Eulerian active flow map defined in Eq. (9.73). As in he 
Lagrangian case, the barrier time s in this computation can be arbitrarily large in norm. This 
guarantees substantially higher resolution in the detection of instantaneous objective barriers 
from aFTLES;t(x; f° than from the passive instantaneous FTLEs, FTLEt±(x), discussed in 
§5.7.2.The only practical limitation to resolving the details of active barriers via aFTLE is 
the spatial resolution of the available data.
The magnitude of the barrier time s in aFTLE calculations governs the level of accuracy 
and spatial resolution in the visualization of active transport barriers. As already mentioned, 
one limitation to the choice of s is that the trajectories of the barrier equation (9.19) may 
leave the spatial domain U on which the velocity field is known. Another limitation is the res­
olution of the available velocity data, which decreases the accuracy of aFTLE computations 
over growing barrier times. This decreased accuracy can be remedied by using the active 
version of the single-trajectory LCS stretching diagnostics introduced in §5.5.1, which we 
discuss next.
The steady quasi-objective stretching exponents (5.80) become objective without any 
further assumption in our present context, given that the Lagrangian and Eulerian active 
barrier equations are always objective. Using discretized barrier trajectory data fx(si°gN=0

9.7 Active LCS Methods for Barrier Detection
351
aPRA;,5(x„;w)
FTLEjfx,,)
aFTLE^x,,;®)
Figure 9.7 Passive and vorticity-based active versions of the FTLE and PRA di­
agnostics for the unsteady ABC flow (9.67), computed over the same time interval 
(»10; 11] = »0; 5]) and with the same spatial resolution (3003 grid points in the spatial 
domain »0; 2^|3). Adapted from Haller et al. (2020b).
with ^0 = 0 for a barrier trajectory x0(.; 0; x0°, the active trajectory stretching exponents 
(aTSEs) can be introduced for the Lagrangian barrier equation (9.19) as
aTSES^f ° = 
log jx^; 
(9.77)
TCTsN / 
1 \ 1 1 
lx (Ti + 1 °l 
/n '70 \
aTSEt0;ti(X0; f ° = TN -"' x... 
•
defined for x0(.i° , 0, i = 0;... • N. The computation of the aTSE for 2D flows and 3D flows 
is implemented inNotebooks 9.4and9.5,respectively.
Notebook 9.4 (aTSE2D) Computes active trajectory stretching exponents (aTSE) in a 2D 
unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ActiveBarriers/aTSE2D

352
Dynamically Active Barriers to Transport
Notebook 9.5 (aTSE3D) Computes active trajectory stretching exponents (aTSE) in a 3D 
unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ActiveBarriers/aTSE3D
In analogy with the Eulerian aFTLE defined in Eq. (9.76),the active trajectory stretching 
exponents for the Eulerian barrier equation (9.21) are obtained from the formulas (9.78) as the 
limits aTSESN (x; f° and aTSEsN (x; f°. Figure 9.8 shows that the Eulerian aTSE diagnostics 
indeed faithfully reproduce features of the aFTLE at a much lower numerical cost, given that 
aTSE computations involve no spatial differentiation and hence require no auxiliary grid.
Figure 9.8 Comparison of three Eulerian active barrier diagnostics, the 
aFTLE000(x;!°, aTSE000(x;!° and aTSE00o(x;!°, on the unsteady ABC flow (9.67) 
over the same numerical grid as in Fig. 9.7. Adapted from Haller et al. (2021).
9.7.3 Active PRA (aPRA) and Active TRA (aTRA)
The active version of the polar rotation angle (or PRA) introduced in §5.2.10 can be defined 
using the active rotation tensor
RS0; t1 = rFsO0;t1 [Co,. ] 
: 
(9.79)
This tensor yields the Lagrangian active PRA (aPRA) in 3D as
aPRASo; t1 (xo; f° = cos 1
2 (tr RSo;ti (xo°- 1)
= cos 1
1 
3
2 X (^a(xo°; 
(xo°)
i=1
- 1 :
(9.80)
Here, ia (xo° and ia (xo° denote the right and left singular vectors of the active deformation 
gradient rFtso,t1, respectively. While we noted the nonobjectivity of the passive PRA for 3D 
flows in §5.2.10, the aPRA is objective by the objectivity of the barrier equations. For 2D 
flows, formula (5.22) yields the corresponding formula for aPRA as
aPRAsO;t1 (xo; f° = cos-1 {tf(xo°;^f(xo°) = cos-1 (£a(xo°;V2a(xo°) : 
(9.81)

9.7 Active LCS Methods for Barrier Detection 
353
The computation of aPRA for 2D flows and 3D flows is implemented inNotebooks 9.6 
and9.7,respectively.
Notebook 9.6 (aPRA2D) Computes active polar rotation angles (aPRAs) in a 2D unsteady 
velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ActiveBarriers/aPRA2D
Notebook 9.7 (aPRA3D) Computes active polar rotation angles (aPRAs) ina3D unsteady 
velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ActiveBarriers/aPRA3D
While the passive PRAt0 (xo° becomes the identically zero field for 10 = 11, the aPRAS0t1 
diagnostic has a nondegenerate instantaneous limit. Indeed, aPRASt (x; f° is just the PRA 
computed for the Eulerian barrier equation (9.21) over the barrier time interval »O, s]. Using 
this objective diagnostic, we can identify instantaneous limits of active elliptic LCSs as active 
elliptic OECSs. The lower plots in Fig. 9.7 indeed illustrate the substantial refinement and 
convergence for increasing s-values obtained from the aPRA relative to the PRA computed 
over the same time interval in the unsteady ABC flow.
Just as for the aFTLE, the aPRA also requires spatial differentiation of the trajectories 
with respect to initial conditions. A single-trajectory-based alternative to aPRA is the active 
version of the TRA diagnostic we introduced in §5.5.2. In analogy with aTSE, the two 
Lagrangian active trajectory rotation average (aTRA) diagnostics can be defined as
aTRASoNti (xo; f ° = cos’1
hx0(So°; x0(SN°i 
jx0(So)| |x'(SN)|’
___ s 
1 N-1
aTRAN (xo; f° = -—r V cos-1
to;t1( 
° |sNl £O
hX0( S i ), X'( S i + 1°i
|x0(Si)| |x'(Si+1°|’
(9.82)
for all x'(si° , 0, i = O,...,N. Here, aTRASoNt1 measures the total net rotation, whereas 
aTRAsoNt1 measures the averaged angular velocity along trajectories. Both aTRA diagnostics 
are objective measures of total trajectory rotation in the Lagrangian barrier equation (9.19) 
(see Haller et al., 2021). The Eulerian limits of these diagnostics for the Eulerian barrier 
equation (9.21) are again simply aTRAsN (x; f) and aTRAsN (x; f°. The computation of aTRA 
for 2D and 3D flows is implemented in Notebooks 9.8 and 9.9, respectively.
Notebook 9.8 (aTRA2D) Computes the active trajectory rotation average (aTRA) in a 
2D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 2D/ 
demos/ActiveBarriers/aTRA2D

354
Dynamically Active Barriers to Transport
Notebook 9.9 (aTRA3D) Computes the active trajectory rotation average (aTRA) in a 
3D unsteady velocity data set.
https:// github.com/ haller- group/ TBarrier/ tree/ main/ TBarrier/ 3D/ 
demos/ActiveBarriers/aTRA3D
Figure 9.9shows that the Eulerian aTRA diagnostics accurately capture features of the aPRA 
at a much lower numerical cost using single trajectory data, without the need to compute the 
derivative of the Eulerian active flow map (9.73).
aPRA50o
aTRA50o
aTRA500 
- f ’
Figure 9.9 Comparison of
three Eulerian active barrier diagnostics, the
aPRA000(x;!°, aTRA500(x;! and aTRA000(x;!°, on the unsteady ABC flow (9.67)
over the same numerical grid as in Fig. 9.7. Adapted from Haller et al. (2021).
9.7.4 The Choice of the Maximal Barrier Time, sN, in Active LCS Diagnostics
As we have already noted, the active barrier diagnostics discussed in §9.7 have the potential to 
reveal much finer spatial details than their passive counterparts. In practical implementations 
of these active diagnostics, however, the visualization quality they provide will eventually 
deteriorate for increasing maximal barrier times, sN . Indeed, due to the finite resolution of 
the numerical grid used in such calculations, evolving barrier trajectories carry less and less 
information about the nearby barrier surfaces that they were initially approximating.
A practical way to counter this degradation of the results from a given active diagnostic 
is to select sN as the decorrelation time of the diagnostic computed over increasing barrier 
times, as proposed by Aksamit and Haller (2022). For instance, for the aTSE diagnostic 
defined in Eq. (9.78), introducing the notation
sk ;sm 
1 
jx (^ m)j
■ 
■ ■ (X0; f) = 
lOg x ;
we can select sN as the smallest positive zero of the auto-covariance function
N-1
Rf(r; xo° = S [aTSEk+1 (xo; f° - aTSE]^(xo; f)] 
i=0
x [aTSE^’sk—(xo; f° - aTSE;(xo; f°], 
(9.83) 

9.8 Active Barriers in 2D and 3D Turbulence Simulations
355
with aTSEt0;t1 denoting the mean of the time series aTSEts0k;;t1
sk+1 taken over k. Selecting 
the smallest 5N(x0° > 0 satisfying Rf(5N(x0);x0° = 0 gives, therefore, an estimate for the 
optimal choice of the maximal barrier time in the computation of aTSES0Nt1 (x0; f), at least for 
the barrier trajectory starting from x0 . Over the full computational domain, one may then 
select the spatial mean of 5N(x0° as a common integration time for all barrier trajectories 
associated with the active vector field f. We will follow this procedure in constructing 
momentum transport barriers (MTBs) for turbulent channel flows in §9.8.4.
9.7.5 Relationship between Active and Passive LCS Diagnostics
Active transport barriers highlighted by active LCS methods generally differ from advective 
transport barriers detected by passive LCS and OECS methods. This was to be expected 
because these two classes of transport barriers are constructed from different principles.
Eulerian and Lagrangian active barriers coincide, however, with their passive counterparts 
in directionally steady Beltrami flows, as we have seen in §9.6.2.Therefore, the closer a 
generic flow is to a Beltrami flow in a given region, the closer its active and passive barriers 
will be to each other. More generally, the more correlated the velocity field is with its 
Laplacian, the closer the Lagrangian and Eulerian momentum barriers should be to their 
passive counterparts. Similarly, the more correlated the velocity field is with the vorticity 
Laplacian, the closer the Lagrangian and Eulerian vorticity barriers will be to their passive 
counterparts.
Inviscid flows have barrier equations with identically vanishing right-hand sides. This 
is because there is no viscous transport in such flows and hence active barriers based on 
diffusive transport are not well defined. Indeed, the aFTLE and aPRA will identically vanish 
for such flows, while passive FTLE and PRA only vanish if the inviscid flow has a spatially 
independent velocity field. Therefore, the more inviscid the flow is in a region, the more its 
active and passive barriers are expected to differ from each other in that region.
A specific case falling between Beltrami flows and inviscid flows is a Lamb-Oseen velocity 
field, which models the decay of a vortex due to viscosity (see, e.g., Saffman et al., 1992). 
Along each cylindrical streamsurface surrounding the origin in this model, the viscous force 
is a constant negative multiple of the velocity. As a consequence, all Eulerian active and 
passive barriers to momentum transport coincide with the cylindrical streamsurfaces of the 
Lamb-Oseen vortices, even though their velocity field is not Beltrami. In agreement with 
this observation, we will find in the 2D and 3D turbulence simulations of §9.8 that strong 
vortices have similar signatures in the active and the passive LCS diagnostic fields, with the 
active field providing more detail for larger values of the barrier time 5 in the computations. 
In contrast, passive and active LCS diagnostics may differ substantially in hyperbolic mixing 
regions outside vortices.
9.8 Active Barriers in 2D and 3D Turbulence Simulations
In this section, we illustrate the use of active LCS diagnostics discussed in §9.7 to uncover 
active barriers to momentum and vorticity transport in 2D homogeneous, isotropic turbulence 
and in a 3D turbulent channel flow.

356
Dynamically Active Barriers to Transport
9.8.1 2D Homogeneous, Isotropic Turbulence
Haller et al. (2020b) consider a 2D turbulence simulation over a spatially periodic domain 
U = »0; 2k] x »0; 2k].1 The velocity field is obtained from the pseudospectral code of 
Farazmand et al. (2011) with viscosity v = 2 x 10“5. The velocity data is composed of 251 
equally spaced snapshots over the time interval »0; 50]. We have already analyzed advective 
transport barriers (LCSs) in this data set using several different methods (see Figs. 1.10, 5.20, 
5.21, 5.30, 5.32 and 8.10).
1 To simplify our notation, we follow Haller et al. (2020b) by dropping the hat from the notation used in §9.6.1 
for 2D variables.
Eulerian Active Barriers
Haller et al. (2020b) use the first snapshot of the data set at time t = 0 to compute the 
right-hand side of the Eulerian momentum barrier equation (9.49) and the Eulerian vorticity 
barrier equation (9.52) using a grid of 1024 x 1024 points.
Here, we show only the Eulerian momentum barriers for this flow in Fig. 9.10, zooming 
in on one of the vortical regions.
Figure 9.10 Objective Eulerian advective barriers revealed by the instantaneous 
FTLE and instantaneous PRA, compared to Eulerian active barriers to momentum 
transport revealed by the aFTLE and the aPRA in a 2D turbulence simulation. Adapted 
from Haller et al. (2020b).
With increasing barrier time s, the aFTLE in the upper plots provides an increasingly 
detailed visualization that also reveals secondary vortices near the main vortex. In contrast, 
none of these vortices are present in the passive FTLE in Fig. 9.10.The aPRA field shows 

9.8 Active Barriers in 2D and 3D Turbulence Simulations
357
the same refining trend, while the passive instantaneous PRA is identically zero by definition 
in this Eulerian analysis.
Lagrangian Active Barriers
To find active material (Lagrangian) barriers for this 2D turbulent flow, Haller et al. (2020b) 
compute the flow map F0 over the time interval »0; 25] using all the available velocity 
snapshots. The grid of initial conditions is the same as the grid used in the Eulerian active 
barrier computations shown in Fig. 9.10. The relevant barrier equations for this case are (9.48) 
and (9.51), on which Haller et al. (2020b) evaluate the aFTLE and the aPRA diagnostics to 
locate Lagrangian active barriers to momentum and vorticity transport.
Figure 9.11 shows the results of these computations for Lagrangian active barriers in 
comparison with FTLE and PRA computations for LCSs in this flow. We observe that the 
aFTLE and aPRA reveal the same elliptic LCSs structures inside the vortical regions in much 
finer detail than their passive counterpart. This is because aFTLE and aPRA do not rely on 
substantial fluid particle separation. In the mixing regions surrounding the vortices, active 
and passive barriers tend to differ substantially.
Figure 9.11 LCSs revealed by the FTLE and PRA, compared to active material 
barriers to momentum and vorticity transport revealed by the aFTLE and the aPRA 
in a 2D turbulence simulation. Adapted from Haller et al. (2020b).
Based on the autonomous Hamiltonian form of the 2D momentum barrier equations 
(9.48)-(9.49) and vorticity barrier equations (9.51)-(9.52), we can also extract barriers to 
the transport of momentum and vorticity as level curves of appropriate Hamiltonians. Figure 
9.12 shows the initial and final position of such a level curve (a closed material barrier to

358
Dynamically Active Barriers to Transport
Figure 9.12 Evolution of an active material barrier (red) and a passive material 
barrier (black) to momentum transport in the Eulerian and the Lagrangian frames, 
superimposed on the distribution of the norm of the linear momentum. The pink dot 
marks a common material point of the two types of material barriers. Also shown are 
the instantaneous viscous forces (normalized by ) acting on the evolving barrier. 
Adapted from Haller et al. (2020b).
momentum transport), with its impact on the linear momentum field shown both in Eulerian 
and Lagrangian coordinates.
This barrier was identified as a level curve of the Hamiltonian H0\x0° = vp! (F0 (x0°, t). 
Also shown in the figure is an elliptic LCS (black), extracted as a closed level curve of the 
passive PRA through a selected point of the active barrier. In agreement with our discussion 
in §9.7.5,these active and passive elliptic barriers remain close to each during their material 
evolution over the »0,25] time interval, showing coherence in the Eulerian frame. In the 
Lagrangian frame, we see that the closely aligned active and passive elliptic barriers preserve 
small momentum values in their interiors.
Figure 9.12 also shows the normalized instantaneous viscous force, v, along the extracted 
active momentum barrier. The figure illustrates that, by construction, the viscous forces are 

9.8 Active Barriers in 2D and 3D Turbulence Simulations
359
tangent to the Lagrangian barriers in a time-averaged sense after being pulled back under F0t 
to the initial configuration.
9.8.2 3D Turbulent Channel Flow
Our second example for active barrier identification is the direct numerical simulation of 
a 3D turbulent channel flow. In this simulation, the friction Reynolds number is Re = 
uT h /v = 200, based on the friction velocity uT, the channel half height h and the kinematic 
viscosity . For more detail on this simulation and the technical steps involved in the barrier 
computations, we refer to Haller et al. (2020b).
Following the computation of the barrier vector fields in the 3D Lagrangian and Eulerian 
barrier equations (seePropositions 9.4and9.6), the active flow map Fts0;t1 are computed up 
to the barrier times smax = 31:0 and smax = 0:62 for the momentum and vorticity barriers, 
respectively. This choice of the barrier times reveals enough detail in the corresponding 
barrier vector fields without the accumulation of substantial integration errors. The aFTLE 
and aPRA diagnostics are then computed from Eqs. (9.75) and (9.80), respectively.
Eulerian Active Barriers in 3D Turbulence
We show in Fig. 9.13 the spanwise cross section of the results from the Eulerian aFTLE 
calculations along with a passive instantaneous FTLE calculation highlighting hyperbolic 
LCSs in the flow. As we have already seen in the 2D turbulence in §9.8.1,the aFTLE 
highlights more structures and in larger detail from the same instantaneous velocity data in 
comparison to the passive FTLE. Specifically, large prominent aFTLE ridges penetrate the 
bulk flow region while some other regions have no discernible barriers. The latter regions 
are bounded by the envelopes of filamented hyperbolic active barriers.
Lagrangian Active Barriers in 3D Turbulence
Figure 9.14 shows the aPRA field computed for Lagrangian active barriers to momentum 
and vorticity transport, computed from t0 = 0 to t1 = 3:75; with the latter corresponding 
to 750 viscous time units. The computations are fully 3D, but the computed fields are only 
shown over the streamwise cross section used in Fig. 9.13.
The plots in Fig. 9.14 show that some of the Eulerian active barriers shown in Fig. 9.13 
persist almost unchanged as material surfaces. Consistent with our general discussion in 
§9.7.5, passive and active LCS diagnostics tend to highlight the same vortices but tend to 
differ in the hyperbolic regions surrounding the vortices. As we have already seen in our 2D 
turbulence example, while the vorticity-based aPRA plots show significant enhancement over 
the passive PRA plot, some of their details are lost in comparison to their momentum-based 
counterparts due to the additional spatial differentiation involved in computing !.
9.8.3 Eulerian Active Barriers from the Normalized Barrier Equation
A more detailed view of active barriers in 3D, turbulent channel flow arises from the compu­
tational procedure of Aksamit and Haller (2022). They use data from a ReT = 1; 000 direct 
numerical simulation in the Johns Hopkins University Turbulence Data Base (JHUTDB; see,

360
Dynamically Active Barriers to Transport
+
+
(c) 2.o
FTLE0+(x)
aFTLE01o(x ;pv)
(d)
1.5
3oo
y/h 1.o
o.5
0.3 —
4oo
1
2
4
5
6
(e)
(f)
3 
z/h
aFTLE0'02(x ;«)
200 y+
4
2
o.2
y/h 0.4
o.6
0 2.8 3.0 3.2 3.4
z/h
o.4
o.2
o.6
2.8 3.0 3.2 3.4 
z/h
o.6
o.4
0.2
o
0 2.8 3.0 3.2 3.4
z/h
2
1
0
4
2
o
o
Figure 9.13 Eulerian passive and active FTLE analysis of the 3D turbulent 
channel flows simulation at time t = 0: (a) the instantaneous limit of the passive 
FTLE; (b) the aFTLE with respect to v; (c) the aFTLE with respect to ! in a 
cross-sectional plane at x• h = 2n; (d-e-f) magnified insets of the same region 
marked in the plots (a-b-c), respectively. Videos depicting the time-evolution 
of these calculations and comparisons to the 2 -criterion can be found at 
https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/ 
objective-barriers-to-the-transport-of-dynamically-active-vector-fields/ 
25D6A5A238DDCB50B0C019E80227AB24n#supplementary-materials. Adapted from Haller 
et al. (2020b).
e.g., Li et al., 2008). In order to eliminate numerical noise arising from the spatial differenti­
ation necessary for objective Eulerian barrier detection, Aksamit and Haller (2022) use the

9.8 Active Barriers in 2D and 3D Turbulence Simulations
361
1
2
3
4
5
6
(c) 
2.0
aPRA0.62 ( v m\ 
apRA0 3 75 (X;W)
y/h 
1.0
0.5
0.3 -
1.5
300
200
100
1
2
4
5
6
(e)
(f)
y+
3
2
1
(d)
y/h
0.4
0.2
0.6
2.8 3.0 3.2 3.4
z/h
0.4
0.2
3
z/h
0.6
0
2.8 3.0 3.2 3.4
z/h
0.6
0.4
0.2
— 30 
0
0
2.8 3.0 3.2 3.4
z/h
0
0
0
Figure 9.14 Lagrangian passive and active PRA analysis of the 3D turbulent channel 
flow simulation over the time interval»t0; 11] = »0; 3.75]: (a) the passive PRA; (b) the 
aPRA with respect to v; (c) the aPRA with respect to ! in a cross-sectional plane at 
x• h = 2^; (d-e-f) magnified insets of the same region marked in the plots (a-b-c), 
respectively. Adapted from Haller et al. (2020b).
single-trajectory aTRA diagnostic defined in Eq. (9.82) to highlight Eulerian active barriers 
to momentum transport.
In addition, to obtain an equally detailed visualization of all active momentum barriers in 
the domain of interest, Aksamit and Haller (2022) normalize the barrier vector field in the

362
Dynamically Active Barriers to Transport
computations, as we discussed at the beginning of §9.7. Specifically, they use the trajectories 
of the normalized Eulerian momentum barrier equation,
xn0
Av(Xn; t° 
jAv(Xn; t°|’
(9.84)
to compute the normalized Eulerian version of the aTRA field (9.82), given by
----------- sn 
1 V—— 
1 (Xn(Si °; Xn(Si+1°^
NaTRAt t (x; pv° = :—p Y cos-1 
-----j, 
so = 0; 
x = Xn(s0°: (9.85)
|sN | i=0 
xnn (si ° xnn (si+1°
Figure 9.15 shows a side-by-side comparison of flow structures revealed by the vorticity 
norm |!(x; t°| and by NaTRAt;:t (x; pv° from the same instantaneous velocity field v(x, t° on 
adjacent spatial domains at time t = 0. Even though there is a clear correlation between 
0:5 
the two diagnostics along the x+ = 6:75 line, the level of detail revealed by NaTRAt;t 
is at least an order of magnitude higher. This active diagnostic, therefore, provides highly 
detailed, observer-independent visualization of both boundary layers and all vortices in the 
main stream.
Figure 9.15 The vorticity norm and the normalized active TRA diagnostic computed 
from formula (9.85) at time t = 0 for a 3D turbulent channel flow. The figure shows 
the results of the computations on two adjacent sections of the same velocity field 
snapshot along the streamwise x+ direction. Adapted from Aksamit and Haller (2022).

9.8 Active Barriers in 2D and 3D Turbulence Simulations
363
9.8.4 Turbulent Momentum Transport Barriers (MTBs)
Well-developed statistical methods are available for the identification of surfaces bounding 
the uniform momentum zone (UMZ) interfaces mentioned in the introduction of this chapter 
(see Adrian et al., 2000;De Silva et al., 2015;Eisma et al., 2015;Fan et al., 2019). While these 
methods have been broadly used, some of their limitations have also become clear. These 
limitations include sensitivity to the size of the domain, to the number of velocity vectors used 
in identifying significant velocities and to the number of bins used in identifying streamwise 
velocity peaks. Additionally, depending solely on the velocity distribution, the construction 
of these interfaces is not even Galilean invariant let alone objective. As a consequence, 
their connection to experimentally observed material (and hence objective) interfaces in 
wall-bounded turbulence remains to be established.
Aksamit and Haller (2022) propose an objective alternative to the velocity-statistics­
based construction of UMZ boundaries, seeking them as distinguished Eulerian barriers to 
the transport of momentum. Specifically, they define active momentum transport barriers 
(MTBs) as curvature-minimizing streamsurfaces of the Eulerian momentum barrier equation 
(9.25) that partition the flow into wall-parallel domains and span the entire channel in the 
streamwise direction. To identify such distinguished streamsurfaces, Aksamit and Haller 
(2022) approximate such MTBs by the locally flattest (least-filamented), streamwise fully- 
extending level surfaces of the aTSE field.2 *
2 This approximation assumes that the MTB is a two-dimensional stable or unstable manifold of the barrier
equation (9.25) along which the averaged tangential stretching is nearly constant.
By construction, an exact MTB surface, M(t), will admit instantaneously zero momentum 
flux, O (M(t)), as defined in Eq. (9.11). In contrast, hie momentum ilux hroough an aTSE 
level surface approximating M(t° is nonzero but small. Other active LCS diagnostics for 
hyperbolic barrier detection, such as the aFTLE, can also be used to approximate M(t). 
Aksamit and Haller (2022), however, specifically propose the use of the single-trajectory­
based aTSE diagnostic defined in Eq. (9.78) to avoid differentiation of the Eulerian active 
flow map Fts;t and hence reduce numerical noise.
The MTB extraction procedure starts with the computation of the aTSEsN (x, pv° field, with 
a common barrier time sN determined as in §9.7.4. We then locate the shortest, streamwise 
fully-extending level curve of this aTSE field in a number m 1 of streamwise, wall-normal 
planes. Each such shortest level curve is part of a 2D aTSE level surface that is a candidate 
for approximating an MTB surface. Of these candidate surfaces, we select the 2D aTSE level 
surface whose intersection curves with the m streamwise-wall-normal planes have the lowest 
total length. More detail on this numerical procedure can be found in Aksamit and Haller 
(2022). Figure 9.16 shows an example of such an approximate MTB, extracted from the 3D 
JHUTDB turbulent channel flow data that we have already analyzed in §9.8.3.
The spatial features of the approximate MTB in Fig. 9.16 are qualitatively similar to 
those of material interfaces observed in smoke and dye experiments on wall-bound turbulent 
flows. Specifically, the characteristic interface eddies noted by Falco (1977) and Head and 
Bandyopadhyay (1981) are well observable along this approximate MTB. Also recognizable 
are the large-scale streamwise streaky structures documented by Kline et al. (1967), with a 
spanwise spacing of approximately 0:75h. Additionally, there is a close similarity between the 
objective MTB surface shown in Fig. 9.16 and the interfaces inferred from the experimental

364
Dynamically Active Barriers to Transport
________10-4
aTSEt,t (x. pv)
Figure 9.16 (Bottom) Approximation ofan objectively defined momentum transport 
barrier, obtained as the locally flattest, streamwise fully-extending level surface of
--------- 10"4
the aTSE0;0 (X;pv° diagnostic field. The intersections of this level surface with three 
individual streamwise, wall-normal planes are shown (Top), with h denoting the 
half-channel height. The approximate MTB is shaded by its pointwise distance from 
the lower channel wall. Adapted from Aksamit and Haller (2022).
visualizations of jet-driven TNT interfaces by Westerweel et al. (2009). Further statistical 
analysis of approximate MTB surfaces of the type shown in Fig. 9.16 is given by Aksamit 
and Haller (2022).
9.8.5 Momentum-Trapping Vortices in Turbulent Channel Flows
Beyond their use in MTB identification, active single-trajectory diagnostics can also be 
used to find active elliptic LCSs (active vortex boundaries) that form tubular barriers to 
the transport of momentum or vorticity. The existence of such barriers in 3D turbulent 
channel flows is already apparent from the active PRA plots of §9.8.2, but their details are 
often blurred due to the numerical noise encountered in the spatial differentiation of the 
active flow map Fts;t required in these calculations. Using the single-trajectory-based aTRA 
diagnostic eliminates the need for this differentiation and delivers higher detail in extracting 
vortex boundaries as active barrier surfaces.
In analogy with the LAVD-based Definition 5.9, we define the boundary ofa momentum­
trapping vortex as an outermost convex, cylindrical streamsurface of the Eulerian momentum 

9.8 Active Barriers in 2D and 3D Turbulence Simulations
365
barrier equation (9.25.. Asnnpproxximationtoucch v ooexxbouridriy. wc raaysscpppro- 
priate features of the active, single-trajectory, rotational diagnostic, aTRAtN (x; pv°, defined 
inEq. ((.8.).Specificalli, .e seek itientoi-trapping vtrtex btonraries as sitttc cilin- 
sN
drical level surfaces of aTRAt;t (x; pv° surrounding a unique, codimension-2 height ridge 
of aTRAtN (x; pv°. Aksamit and Haller (2022) locate such level surfaces by finding their 
intersections with a select reference plane, i.e., by locating outermost convex level curves of 
aTRAfN (x; pv° in that reference plane.
As an illustration, Fig. (.17 shows two momentum-trapping vortices extracted in this 
fashion from the same velocity snapshot of the 3D JHUTDB turbulent channel flow data 
that was used in constructing Fig. (.16.Aksamit and Haller (2022) also provide statistical 
analysis that confirms the closeness of these two aTRA level surfaces to actual invariant 
manifolds (streamsurfaces) of the momentum barrier equation ((.25).
Figure 9.17 Extraction of objectively defined momentum-trapping vortices, bounded 
by Eulerian barriers to momentum transport, in the 3D JHUTDB turbulent channel 
flow data set. The vortex boundaries are approximated by outermost cylindrical 
level surfaces of the aTRAsN(x0;pv) diagnostic field defined in Eq. (9.82), wihi 
sN = 10“3 selected based on the algorithm described in §9.7.4. These level surfaces 
are identified from their outermost closed and convex intersection curves with the 
z+ = 2:55 reference plane. Adapted from Aksamit and Haller (2022).

366
Dynamically Active Barriers to Transport
9.9 Summary and Outlook
In this chapter, we have discussed how an appropriately defined objective flux of an active 
vector field f can be used to uncover perfect Lagrangian barriers to the diffusive (i.e., 
viscous) transport of f. Instantaneous limits of these active Lagrangian transport barriers 
have also enabled us to isolate objective Eulerian active barriers that govern the short-term 
redistribution of f in a frame-independent way.
Both Lagrangian and Eulerian active barriers evolve from structurally stable 2D stream­
surfaces of an associated steady vector field, the barrier vector field b£(x0°. In 3D unsteady 
Beltrami flows, both Lagrangian and Eulerian active barrier surfaces coincide exactly with 
invariant manifolds of the Lagrangian particle motion. The more a flow differs from a Bel­
trami flow locally, the more the active barriers to vorticity and momentum will differ from 
purely advective barriers (or LCSs).
As structurally stable invariant manifolds of the steady and volume-preserving barrier 
equations, active barriers can be identified via active versions of the LCS detection methods 
we discussed in Chapter 5.These active LCSs reveal coherent structures in much larger detail 
from the same velocity data set than their passive counterparts do. This is because active 
LCS diagnostics are computable over arbitrarily long intervals of the barrier time s, which is 
independent of the physical time interval over which the velocity data is available. Increasing 
the barrier time enables a scale-dependent exploration of active barriers, with smaller spatial 
scales prevailing for larger barrier times.
Active transport barrier detection can also be applied to 2D Navier-Stokes flows viewed as 
3D flows with a symmetry. The resulting 2D barrier equations are autonomous Hamiltonian 
systems, and hence active barriers can be identified as structurally stable level curves of these 
Hamiltonians. The Hamiltonians are, however, highly complex in turbulent flows and for this 
reason, active LCS diagnostics applied to their trajectories tend to give more robust results 
than extraction of their level curves.
A final and perhaps unexpected message from this chapter is that both Lagrangian and 
Eulerian active barrier identification ultimately involve the analysis of coherent structures 
in the steady and incompressible barrier equations. The purely advective transport barrier 
detection methods of Chapters 4 and 5 are, therefore, also highly relevant for active transport 
analysis in unsteady flows. This highlights a need for the further development of these 
advective techniques towards a fully automated detection and visualization of key stream 
surfaces (advective transport barriers) in 3D steady flows.

Appendix
A.1 The Implicit Function Theorem
Here, we briefly restate a classic tool from analysis, the implicit function theorem, which 
we invoke in this book several times. We give the simplest form of this theorem and refer to 
Abraham et al. (1988) for more detail and generalizations.
We consider an implicit equation
f(x; y° = 0 
(A.1)
involving a function f: U V Rn ! Rm of the variables x 2 U Rn and y 2 V Rm. We 
assume that f is continuously differentiable in its arguments, i.e., f 2 C1 (U x V). We further 
assume that the equation (A.1) is solved by (x0, y0) and that the Jacobian of f with respect to 
y at this point is nonsingular:
f(xo; yo° = 0; 
det [@yf(xo,yo)] , 0: 
(A.2)
Then the implicit function theorem guarantees the existence of a neighborhood W U of x0 
in U such that Eq. (A.1) has a unique m-parameter family of solutions of the form y = g(x° 
satisfying
f(X; g(x)) = 0; g(X° = yo + O(|X - Xo |) ; 
x 2 W; 
(A.3)
where g(x° is a continuously differentiable function of x. More generally, if f is of class Ck 
for some k 1 or analytic, then g: U x Rm is of class Ck or analytic in x, respectively.
Figure A.1 illustrates the meaning of the conditions in Eq. (A.2) for m = n = 1, in which 
case these conditions simplify to
f (x0; yo° = 0; 
@y f (x0; yo) , 0: 
(A.4)
Note that the second condition in (A.4) is violated at the point (x0, y0°, as is shown in Fig. A.1. 
Indeed, we have f (x, y° > 0 (in red) along the horizontal tangent to the zero set f (x, y° = 0 
at that point, and hence the y-derivative of the function f must be zero at the point (x0, y0°. 
Near that point, the f (x, y ° = 0 fails to be expressible as the graph of a single-values function 
y = g(x ° and hence the implicit function theorem does not apply. At the same time, the 
x -derivative of the function f at (x0, y0° is typically nonzero, as f changes sign from positive 
to negative along the horizontal line through (x0, y0°.1 In that case, the zero set of f can 
1 The function f (x, y) changes sign along the horizontal line through (x0, y0° and hence cannot have a quadratic 
zero in x at that point. It might, however, have a degenerate, cubic-order zero in x at (x0; y0°, such as the function 
f (x; y) = (x - x0)3 - (y - y0)2. In that case, the classic implicit function theorem would not guarantee the 
existence of a local single-valued graph x = g(y) for the zero set of f, even though such a graph exists in the
367

368
Appendix
Figure A.1 The solution of f (x; y° = 0 cannot be locally continued near (x0; y0° in 
the form y = g(x° but can be continued in the form x = g(y). The opposite holds 
near the point (x0, y0°.
locally be expressed as the graph of a smooth, single-valued function x = g(y° near (x0, y0°. 
Similarly, the zero set of f can locally be expressed as the graph of a single-valued function 
of x near (x0, y0) but not as a graph of a single-valued function of y.
A.2 Ridges
While an intuitive notion of a ridge is clear from our recollection of the image of a mountain 
ridge (see Fig. 5.4), giving a generally applicable and computable ridge definition is substan­
tially more involved. Indeed, the monograph of Eberly (1996) is fully dedicated to defining 
and extracting ridges from data. The different ridge definitions used in the literature coexist 
because they produce false negatives or false positives on various examples that one would 
like or not like to consider ridges.
We discuss ridges here because they frequently signal transport barriers in plots of di­
agnostic scalar fields for fluid flows. Starting with the work of Haller (2001a, 2002), the 
diagnostic role of ridges has been explicitly formulated in FTLE-based LCS calculations, 
but it has also been tacitly used in evaluating scalar field plots of other diagnostic fields 
for coherent structure detection (see, e.g., Bowman, 1999,Rypina et al., 2011 and Mancho 
et al., 2013). While in most of these studies the exact definition the ridge did not play a role, 
the second-derivative ridge definition of Shadden et al. (2005) and Lekien et al. (2007) was 
explicitly used in the derivation of their formula for material flux through an FTLE ridge. In 
§5.2.2,we discuss a counterexample to this formula and refer to Haller (2011) for details on 
the issues with the derivation of the formula. As pointed out by Norgard and Bremer (2012) 
and Schindler et al. (2012), the second-derivative ridge definition is overdetermined to begin 
with: it will only be satisfied for ridges that are straight lines.
2
form x = g(y° = x0 + (y - y0° 3. Note, however, that this graph is not even once continuously differentiable, 
and hence there is a good reason why the implicit function theorem fails to apply in this case.

A.2 Ridges
369
Perhaps the simplest ridge definition is that of a height ridge, defined as a codimension-1 
surface of points at which a scalar-valued function f (x) has a strict local maximum in the 
direction of the eigenvector associated with the smallest eigenvalue of the Hessian r2 f (x° 
(Eberly, 1996). Another approach defines ridges as watersheds (Sahner et al., 2007), i.e., 
codimension-1 unstable manifolds of the gradient vector field of the scalar diagnostic field. 
Mathur et al. (2007) put forward a similar idea based on trajectory integration in the gradient 
field without a restriction to saddle points, as mentioned in §5.2.5.
Karrasch and Haller (2013) propose a robust ridge definition that is influenced by the 
watershed view but also guarantees structural stability for the ridge. This means smooth 
persistence in the form of a nearby ridge under small perturbations to the scalar field f (x). 
In short, a robust ridge of a scalar function f : U Rn ! R is a codimension-1, normally 
attracting invariant manifold M of the gradient dynamical system
X0 = r f (X°;
(A.5)
such that the boundary @M of M is also a normally attracting invariant manifold on its 
own. We illustrate this structurally stable ridge definition in Fig. A.2 for general n > 2, and 
specifically for n = 2. For further technical details, we refer the reader to Karrasch and Haller 
(2013).
As noted by Norgard and Bremer (2012) and Schindler et al. (2012), requiring one of the 
eigenvectors of the Hessian r2f ofa scalar field f to be tangent to a ridge M at all points of 
M leads to an over-constrained ridge definition. In contrast, the ridge definition of Karrasch 
and Haller (2013) implies that one of the eigenvectors of r2f is automatically tangent to 
M at any point x0 with r f (x0° = 0, i.e., at any critical point of f. This follows because 
M is an invariant manifold for the gradient flow (A.5) and hence the tangent space Tx0M 
is necessarily an invariant subspace for the linearized gradient flow y0 = r2 f (x0)y at any 
critical point x0 2 M of f. In two dimensions (n = 2), a robust ridge is a curve along which 
the ridge-tangent eigenvector of the Hessian r2 f (x0° at critical points x0 should correspond 
to the smaller eigenvalue of r2 f (x0°, as shown in Fig. A.2.
Normally attracting invariant manifold 
with normally attracting boundary
Gradient flow near a
one-dimensional ridge
Figure A.2 (Left) Illustration of the robust (i.e., structurally stable) ridge definition: 
a codimension-1, normally attracting invariant manifold with a normally attracting 
boundary for the gradient flow (A.5). (Right) A robust ridge M (in red) identified in 
the gradient flow (A.5) for n = 2 from this definition.

370
Appendix
A.3 Lyapunov Exponents
Here, we briefly recall the classic definition of finite-time Lyapunov exponents and their 
relation to (infinite-time) Lyapunov exponents in continuous dynamical systems (see, e.g., 
Ott and Yorke, 2008). We consider an n-dimensional autonomous dynamical system of the 
form
X = f(x°; X 2 Rn; 
(A.6)
and assume that f is C1 smooth so that Eq. (A.6) generates a smooth flow map Ft : D ! D 
on a compact invariant domain D Rn. As in §2.2.8, for any initial condition x0 2 D at 
time t0 = 0 and for any initial perturbation vector £0 2 Rn to x0 , we consider the evolving 
perturbation £(t° = rFt (x0°£0. Wefita (possibly negative) growth exponent to the evolution 
of j£(t°j by defining the directional finite-time Lyapunov exponent associated with (x0; £0° 
via the formula
At (X0;S0) = 1 logjrF' (X0>«0j
(A.7)
j0j
Asymptotic upper and lower bounds on the (possibly existing) asymptotic limit of At (x0 £0° 
are then given by the upper Lyapunov exponent A*(x0, £0° and the lower Lyapunov exponent 
A.(x0; £0°; defined as
(A.8)
A(x0; £0° = lim sup At(x0; £0°;
t!1
A(x0; £0° = lim inf At(x0; £0°:
t!1
If the t ! 1 limit of At (x0; £0° exists, then the directional Lyapunov exponent associated 
with (x0; £0 ° can be defined as
A1(x0;£0° = lim At(x0;£0° = A(x0;£0° = A(x0;£0°: 
(A.9)
t!1
While the maximal and minimal points of accumulation, A(x0; £0 ° and A(x0; £0 °; can always 
be defined for At (x0; £0°, an asymptotically well-defined stretching exponent A1(x0; £0° will 
not exist for (x0; £0° without further assumptions on the dynamical system (A.6).
We will focus here on the case in which only n distinct stretching exponents can be 
identified at the point x0 . In other words, we will seek a situation (which turns out to be 
typical) in which the infinitely many different choices of the initial perturbation £0 will only 
result in a finite number of possible Lyapunov exponents
- 1 < A1(X0° < A2(x0° < ■ ■ ■ < An(x0° < 1
(A.10)
at each point x0 2 D. Precisely one of these n exponents will then be obtained for any choice 
of £0 , depending on which element of a nested hierarchy of n linear subspaces contains 
£0. This hierarchy consists of linear subspaces Vi(x0° Tx0 Rn of dimension i, which are 
nested as
f0g= V0(x0° 
V1(x0° V2(x0° 
■ ■ ■ 
Vn(x0° = Tx0Rn: 
(A.11)
We call a point x0 2 D Lyapunov-regular if for every i = 1; :::;n, and every initial vector 
£0 2 Vt(x0° V_i(x0°, we have
A1(x0; £0° = Ai (x0°; 
i = 1;:::;n:
(A.12)

A.4 Differentiable Manifolds and Functions Defined on Them
371
In other words, at Lyapunov-regular points, only n different asymptotic stretching exponents 
will be observed for all initial perturbations, depending on which of the n complementary 
subspaces V(x0° - V-1(x0) the perturbation vector £0 is chosen.
The multiplicative ergodic theorem of Oseledec (1968) states that if is an invariant 
probability measure of Ft on D, then almost all initial conditions x0 are Lyapunov-regular. 
More specifically, if a measure /x exists with /x(D° = 1 (e.g., normalized area, mass or 
volume) such that /x(A° = ju(Ft(A°° holds for any subset A c D at any time t > 0, then the 
points in x0 2 D that fail to admit n well-defined Lyapunov exponents Ai(x0° form a measure 
zero (and hence unobservable) subset of D with respect to the measure :
The general physical conclusion is, therefore, that n distinct asymptotic material stretching 
exponents (Lyapunov exponents) will be observed at typical initial conditions of a steady, 
bounded flow that preserves mass or volume (in 3D) or area (in 2D). Each of these require­
ments is important, as illustrated by Ott and Yorke (2008) via counterexamples. For instance, 
consider the simple compressible steady flow
x = (a cos x - cos y° sin x,
(A.13) 
y = (cos x + a cos y° sin y,
with a 2 »0; 1], defined on the compact spatial domain D = »0,^] x »0; ^], shown in Fig. 
A.3.This flow is incompressible (area-preserving) on D for a = 0 and, accordingly, has 
well-defined Lyapunov exponents guaranteed by Oseledec’s theorem for almost all initial 
conditions x0 = (x0, y0° in D. The flow, in fact, has well-defined Lyapunov exponents for 
all initial conditions in D. In contrast, for any small a > 0, the flow becomes slightly 
compressible and non-mass-conserving. Therefore, Oseledec’s theorem no longer applies. 
Instead, for all initial conditions in the punctured open domain (0,x° x (0, x° - {^/2,^/2}, 
the finite-time Lyapunov exponent At (x0, £0 ° oscillates along zero and increasingly negative 
values and hence has no asymptotic limit. These oscillations are due to increasingly longer 
and closer passages near different saddle points, followed by recurring escapes from the 
neighborhoods of these points.
Lyapunov exponents in steady inviscid velocity fields have an intimate connection with 
the spectrum of the linearization of the incompressible Euler equation (2.16).Specifically, 
Friedlander and Vishik (1992) show that the Lyapunov exponents in a steady inviscid flow 
provide a lower bound for the growth rate of small, localized inviscid perturbations to the 
flow. In particular, a positive Lyapunov exponent of any inviscid incompressible velocity field 
implies that the velocity field is an unstable solution of the incompressible Euler equation 
(2.16).Examples of such velocity fields include inviscid flows with a saddle-type stagnation 
point, such as the Hill’s spherical vortex flow (4.36), and inviscid flows with chaotic orbits, 
such as the abc flow (4.29) for nonzero values of the parameters A, B and C.
A.4 Differentiable Manifolds and Functions Defined on Them
We briefly discuss here the fundamentals of differentiable manifolds and functions defined 
on them. For more detail, we refer to the very accessible geometric introduction of Guillemin 
and Pollack (2010).

372
Appendix
Figure A.3 Different flow configurations for the planar system (A.13). (Left) For 
a = 0, the Lyapunov exponents 1;2 = 0 exist for all initial conditions in the open 
domain (0; x° x (0; x\ whereas on all initial conditions in the boundary of the domain, 
we have 1;2 = e1 due to the presence of saddle points with eigenvalues 1. (Right) 
Forasmall a > 0, we now have Lyapunov exponents 21;2 = e ~a±1 for initial conditions 
in the flow boundary due to the presence of saddle points with eigenvalues - a ± 1. 
On the open domain (0. ^) x (0. ^) - f^/2;^^2g, however, no initial condition has 
well-defined Lyapunov exponents.
Loosely speaking, a manifold is a smooth surface. More specifically, a set M Rn is called 
a k-dimensional differentiable manifold if it is locally diffeomorphic to Rk . This means that 
any point x 2 M must have an open neighborhood2 V M that is diffeomorphic to an open 
set U Rk. A specific diffeomorphism : U ! V then defines a parametrization of V, 
while its inverse, 0“1: V ! U, provides a coordinate system on V. The manifold M is said 
to be of class Cr if for any x 2 M, there exists a class-Cr parametrization : U ! V with a 
class Cr inverse 0“1.
Being a manifold, therefore, is a local property that does not require the existence of a 
globally defined parametrization or coordinate system for M . Classic examples of manifolds 
are open intervals, the line, the circle, the torus and the sphere. Examples of sets that are not 
manifolds include a wedge, two crossing lines, the figure eight and a semi-infinite spiral with 
its endpoint of accumulation included.
More generally, sets that accumulate on themselves, such as the stable and unstable 
manifolds forming the homoclinic tangle in Fig. 4.5, are actually not manifolds by the 
above definition. The reason is that centered at their locations of self-accumulation, all 
their relatively open sets contain infinitely many connected components arbitrarily close to 
each other. Such a family of sets is not diffeomorphic to an open set of a Euclidean space. 
For this reason, only the local stable and unstable manifolds near a hyperbolic fixed point 
are technically manifolds. Other examples of smooth sets that are non-manifolds due to 
self-accumulation include quasiperiodic orbits on 2D tori.
If M and L are both manifolds and L M , then L is called a submanifold of M . The 
codimension of L in M is then the difference in their dimensions, i.e.,
codim (L, M ° = dim M - dim L.
A codimension-1 submanifold of M is often called a hypersurface in M .
2 V is a (relatively) open subset of M ifit can be written in the form V = W \ M for some open subset W of Rn:

A.4 Differentiable Manifolds and Functions Defined on Them 
373
A set M 
Rn is called a k-dimensional differentiable manifold with boundary if it is
locally diffeomorphic to some open subset of the upper-half space Hk = x 2 Rk j x1 0 
of Rk. An example of a manifold with boundary is the closed interval »0,1] c R. Indeed, 
a relatively open neighborhood of any point in this interval is diffeomorphic to a relatively 
open subset of »0; 1). In general, the boundary of M (denoted by @M) is the set of points that 
map into the boundary @Hk = x 2 Rk j x1 = 0 of Hk under some local coordinate system 
0-1: One can prove that @M is independent of the parametrization, i.e., will map into @Hk 
under any choice of (see Guillemin and Pollack, 2010). The interior of a manifold with 
boundary is defined as Int (M° = M - @ M. This set is a k -dimensional manifold, while @M 
is a (k - 1°-dimensional manifold.
Let : U ! V c M be a local parametrization for a k-dimensional manifold M with 
0(y° = x 2 V. We can then define the tangent space of M at x as the k -dimensional linear 
space
Tx M = range »D0(y°];
where the derivative mapping D0(y°: Rk ! Rn is defined as
D0(y)a = lim 0(y + aa - 0(y>. 
(A.14)
Despite its apparent dependence on , the k-dimensional linear subspace Tx M turns out to 
be independent of the parametrization.
Note that, by definition, Rn itself is also an n-dimensional differentiable manifold. Its 
tangent space, TxRn , is simply a copy of the vector space Rn , with its origin located at the 
point x. Therefore, TxRn is the proper space to use for vectors in Rn that originate from 
the point x 2 Rn. Specifically, for any manifold M c Rn containing the point x, we have 
Tx M c TxRn.
A tangent vector to M at x 2 M is an element of the linear subspace Tx M : The normal 
space NxM is the orthogonal complement of TxM in Rn, which implies dimNxM = n - k.
Let f : M ! N be a map between two manifolds with dim M = k; dim N = l : Consider a 
point x 2 M and let y = f(x° 2 N. Let 0: U ! M and 0: V ! N be local parametrizations 
of the two manifolds near x and y; respectively, and assume that 0(0° = x and 0(0° = y. 
We can then select U small enough and define the map h: U ! V as h = 0“1 o f o 0. This 
definition implies that the following diagram commutes:
X r - Y
<p 
*
U -----  - V :
h
As a map between subsets of Euclidean spaces, h can be differentiated using multivariable 
calculus, just as we did for the parametrization 0 inEq. (A.14). The same is not true for 
the derivative of f because its domain is not a Euclidean space. Instead, we can define the 
derivative of f at x (denoted by Df(x°) by requiring the following diagram to commute:

374
Appendix
Df(x)
Tx M 
Ty N
D0(0) 
Dh(0)
Rk -------^R1 :
D^ (0°
This commutation implies the formula
Df = »D0]"1 DhDS
by the chain rule. One can prove that that this definition of the derivative of f is independent 
of the choice of 0 and S (see Guillemin and Pollack, 2010). Throughout this book, we often 
use the symbol r for differentiation instead of D to be consistent with customary notation 
in fluid dynamics.
A.5 Hamiltonian Systems
Here, we briefly summarize the main aspects of canonical Hamiltonian systems relevant for 
this book. Further details and extensions to noncanonical Hamiltonian systems can be found 
in Abraham et al. (1988) and Arnold (1989).
For an even-dimensional state variable x = (q; p° 2 R2n , a canonical Hamiltonian system 
is a dynamical system of the form
X = jr H (x; t ); 
J = 
0 
In™ 
: 
(A.15)
Inxn 
0
Here, the scalar function H(x; t° is the Hamiltonian associated with the system, Inn denotes 
the n n identity matrix and r denotes the gradient operator with respect to the x variable. 
If H is twice continuously differentiable, then system (A.15) is guaranteed to have local 
existence and uniqueness of solutions by classic results for differential equations (see §2.2).
The most relevant example of a Hamiltonian system in fluid mechanics is planar in­
compressible fluid particle motion, with the stream function (x; t° playing the role of the 
Hamiltonian H (see Eq. (2.4)). Planar Hamiltonian systems also arise in the study of bar­
riers to the transport of dynamically active vector fields in 2D flows (see §9.6.1). In those 
barrier equations, an additional constant multiplies the right-hand side of Eq. (A.15),but 
that constant can be subsumed in the definition of the Hamiltonian H. Higher-dimensional 
Hamiltonian systems arise in the study of temporally quasiperiodic velocity fields in §4.3.2.
The flow of any Hamiltonian dynamical system conserves volume in the phase space by 
Liouville’s theorem. Indeed, for the evolution ofa open set V(t° in the phase space of system 
(A.15), we obtain from formula (2.38) that
4-vol (V(t)) = [ r ■ v(x; t) dV = [ r ■ 
@pH 
dV = 0; 
(A.16)
dt 
V (t) 
V (t) 
~@qH
as one verifies by direct calculation. In addition, autonomous Hamiltonian systems also 
conserve the Hamiltonian along their trajectories, given that
DHDx((°° = r h (x( t)) ■ x( t) = hr h (x( t)); Jr h (x( t ))i = 0 
(A.17)
holds by the skew-symmetry of J.

A.7 Existence of Smooth Surfaces Normal to a Vector Field 
375
A.6 The AVISO Data Set
We illustrate several techniques discussed in this book on an ocean surface velocity field 
obtained from the AVISO data set, a 2D satellite-altimetry-derived ocean-surface current 
product (see http://aviso.oceanobs.com). A global daily-gridded version of this data 
is freely available from the Copernicus Marine Environment Monitoring Service under 
https://marine.copernicus.eu.
Under the assumption of geostrophic flow, the sea surface height h acts as a stream function 
for the surface velocity field. Accordingly, in longitude-latitude coordinates (‘, 6), particle 
trajectories on the ocean surface are approximately trajectories of the 2D system of ODEs
' = -Rfg^@‘h('-e-t°; 
6 = Rfgcossr,°'h '■ t°; (A18)
where g is the constant of gravity, R is the mean radius of the earth, f (6° b 2Q sin 6 is the 
Coriolis parameter and is the mean angular velocity of the earth. Several studies we cite in 
this book use AVISO data from the domain (', 6° 2 »14°W, 9°E] x »39°S, 21°S], which falls 
within the Agulhas leakage region of the Southern Ocean (see, e.g., Haller and Beron-Vera, 
2013;Karrasch et al., 2015;Haller et al., 2018). These studies also use the integration time 
11 - 10 = 90 days, where 10 = 24 November, 2006 and 11 = 22 February, 2007. For the 
significance of the Agulhas leakage and the Agulhas rings, the largest mesoscale eddies in 
the ocean, for the climate system, we refer to Beal et al. (2011).
A.7 Existence of Smooth Surfaces Normal to a Vector Field
0 -1
1 
0.
Principles for transport barriers as pointwise extremizers ofa transport or coherence property 
often require the construction of codimension-1 surfaces S Rn that are everywhere or­
thogonal to a prescribed smooth vector field w(x° on Rn. In 2D (n = 2), such a smooth curve 
S can always be constructed through any point as a trajectory of the differential equation
x0(s° = Jw(x(s)) with the 90° rotation matrix J =
In 3D, however, a 2D smooth surface S that is pointwise orthogonal to a prescribed 
vector field w(x° generally does not exist unless w satisfies a set of nongeneric necessary 
conditions. This fact was apparently first pointed out by Palmerius et al. (2009) in the scientific 
visualization literature, but it already follows from the most general form of Frobenius’s 
theorem given in Abraham et al. (1988). Here we give a simple proof using the Stokes 
theorem, following Blazevski and Haller (2014). To state the result, we define the helicity of 
w as the scalar function
Hw := hr x w; wi :
(A.19)
Theorem A.1 Let w(x° be a continuously differentiable vector field on R3 and let S c R3 
be a smooth, 2D surface orthogonal to w. Then S must be contained in the set of x points 
satisfying the relations
Hw (X° = 0;
r Hw(x° x w(x° = 0:
(A.20)

376
Appendix
Proof Let x 2 S and consider an open neighborhood D S of x within S, bounded by a 
smooth closed curve y = @D c S. Also, let n(x) denote a smoothly oriented unit normal 
vector field for S,3 and assume that w , 0 holds in D. By the classical Stokes theorem, we 
have
3 The surface S has to be a differentiable manifold for its normal vector field to be well defined. Indeed, the tangent 
space of S has to be well defined at each point of S for its normal vectors to be well defined.
I (r x w° ■ n dA = 
w ■ dr: 
(A.21)
D
Since w is orthogonal to S and y is a subset of S, the integral on the right-hand side of (A.21) 
is zero. Therefore, given that w = hw;ni n, we obtain from (A.21) and (A.19) that
1 —^— Hw dA = 0: 
(A.22)
D hw; ni
Since the domain D c S was arbitrary, eq. (A.22) shows that the helicity Hw must vanish 
on S, which proves the first condition in (A.20). The second condition in eq. (A.20) follows 
because S must be contained in the zero level set of Hw and hence w must be parallel to the 
normal n of this level set, which is parallel to the gradient rHw.
Note that each condition in (A.20) is generically satisfied along a 2D surface, and hence 
they can only be satisfied simultaneously for a generic w along curves or at points. As a 
consequence, a generic smooth vector field w will not admit pointwise orthogonal smooth 
surfaces. A nongeneric class of vector fields with pointwise orthogonal surfaces is given by 
the gradient vector fields (or equivalently, curl-free vector fields), for which w = rU holds 
for some scalar-valued function U(x). For this class of w, we have Hw = 0, and hence both 
conditions in (A.20) are satisfied on the whole space, given that r x w = r x rU 0. 
Indeed, any 2D level surface of U(x° is pointwise orthogonal to w.
Another nongeneric class of vector fields satisfying both equations in (A.20) identically is 
vector fields with a scalar first integral (conserved quantity) I(x), for which therefore we have 
hr I; wi = 0. Then any 2D invariant manifold of the gradient dynamical system x0 = r I (x) 
is a pointwise orthogonal surface for the vector field w.
A.8 The Classical Problem of the Calculus of Variations
The calculus of variations is concerned with extremizing functionals, i.e., scalar-valued 
mappings L : B ! R defined on a function space B . The simplest setting for our purposes 
is when B is composed of vector-valued functions r: R ! Rn ofa single variable s 2 R and 
the functional L is of the general form
L(r° = 
L (r(^), r0(s\ s° ds.
(A.23)

A.8 The Classical Problem of the Calculus of Variations
377
In this case, we seek the parametrized curve r(5° along which L(r° admits a maximum, a 
minimum or a point of inflection. We refer to these types of curves as stationary curves for 
L . In this context, the integrand L is often referred to as the Lagrangian associated with the 
extremization problem.
Stationary curves of the functional L can be sought by adding small normal perturbations 
h(5° to r(5° in the expression (A.23) and requiring L(r + h° to have derivative zero with 
respect to at = 0 for all choices of the perturbation. This amounts to the requirement that
5L(r°»h] :=
L (r(5° + h(5°; r0(5° + h0(5°; 5° d5
=0
(A.24)
=0
for all h. The derivative L(r°»h] is called the Gateaux derivative of L in the direction of h. 
It can be computed as
db
5L(r°»h] = — L L (r(5° + eh(5°, r (5° + eh (5°, 5° ds 
d a 
=0
»@r Lh + @r0 Lh0] d5
a
= »@r0L h]ba + [ 
@r L - — @ro L
a 
d5
h d5;
(A.25)
where we have used integration by parts.
In order to proceed further, we have to specify boundary conditions for the curve r(5°, 
i.e., narrow down the class of functions within which we seek stationary curves for L(r°. To 
this end, we need to select boundary conditions that remove the first term in Eq. (A.25), i.e., 
result in
»@r0L h]ba = 0:
(A.26)
The possible boundary conditions that satisfy this requirement are:
(1) Fixed endpoint boundary conditions: The stationary curve is required to go through 
two fixed endpoints ra and rb , i.e.,
r(a° = r1; r(b° = r2 
) 
h(a° = h(b° = 0: 
(A.27)
(2) Periodic boundary conditions: The stationary curve is required to be a closed curve, 
i.e.,
r(a° = r(b°; r0(a° = r0(b° 
) 
h(a° = h(b°: 
(A.28)
(3) Free endpoint boundary condition: The stationary curve should be stationary with 
respect to all perturbations, including those to its endpoints, i.e.,
@r0 L (r(a°; r0(a°; a° = @r0 L (r(b°; r0(b°; b° = 0 
) 
h(5° is arbitrary: 
(A.29)
The first two boundary conditions in this list impose no restriction over the location of a 
stationary curve, only on the class of perturbations h(5° for which the curve should prevail 
as stationary. The free endpoint boundary condition, however, assumes that there are spatial 
locations where @r0 L vanishes. The stationary curve is then sought as a curve connecting 
two of those locations. Between two such boundary points, a stationary curve will prevail as 
stationary in the broadest sense, even under small perturbations to its endpoints.

378
Appendix
Under any of the boundary conditions (A.27)-(A.29), the relation (A.26) implies that the 
integral term in Eq. (A.25) must vanish for all admissible perturbations h(s° in order for the 
Gateaux derivative in Eq. (A.24) to vanish. By the fundamental lemma of the calculus of 
variations (see, e.g., Gelfand and Fomin, 2000), this is only possible if the factor multiplying 
h in the integral term in Eq. (A.25) vanishes identically. This leads to the classical Euler- 
Lagrange equation
@rL - — @r L = 0 
(A.30)
ds
for the stationary curve r(s°. The stationary curves of the functional L are, therefore, tra­
jectories r(s° of the ODE (A.30) that satisfy the chosen boundary condition from the list 
(A.27)-(A.29).
Under various symmetries covered by a general theorem of Noether (see Gelfand and 
Fomin, 2000), hie Eueer-Lagrange equations (A.30) admit conserved quantities (first inte­
grals) along their trajectories. The relevant symmetry for the problems we discuss in this 
book is the lack of explicit dependence on s in the Lagrangian L . In that case, the function
I(r,r0° = L(r,r0° - h@rL(r,r0°;r0i 
(A.31)
is a first integral for Eqs. (A.30).Indeed, along trajectories of (A.30), we can write
!-I = h@rL,r0i + h@rL,r00i - 1-^-@rL,rA - h@rL,r00i 
ds 
ds
= @9r L - — @r0; rA = 0: 
ds
This first integral may turn out to be simply a constant function in specific applications, in 
which case it imposes no constraint on the trajectories of Eq. (A.30). In cases where I(r, r0° is 
not a constant, it can be used to reduce the Euler-Lagrange equations to a lower-dimensional 
system of ODEs.
Computing the first integral (A.31) in applications, one can often take advantage of Euler’s 
theorem for positively homogeneous functions (see., e.g., Lewis, 1969). A continuously 
differentiable, scalar-valued function f : Rn ! R is called positively homogeneous of degree 
d2 N if for any real constant k > 0, we have
f (k x° = k d f (x°: 
(A.32)
Euler’s theorem states that a function f is positively homogeneous of degreed 2 N if and 
only if
hrf (x°; xi = d ■ f (x). 
(A.33)
As a consequence of this result, if the Lagrangian L(r,r0° is known to be a positively 
homogeneous function of degreed 2 N in r0, then the first integral (A.31) can be computed 
without using the specific form of L(r, r0°. Specifically, if for all k > 0, we have
L (r, k r0° = k d L (r, r0°
for all k > 0, then formula (A.33) applied to the definition of I in Eq. (A.31) gives the first 
integral I in the form
I(r,r0° = L(r,r0° - h@rL(r,r0°,r0i = (1 - d° L(r,r0°: 
(A.34)

A.9 Beltrami Flows
379
This result immediately shows that for positively homogeneous functions of order d = 1, 
the first integral I(r, r0° vanishes identically and hence offers no insight into the solution 
structure of the Euler-Lagrange equations (A.30). Also by formula (A.34), for positively 
homogeneous functions of order d = 2, the first integral I(r, r0° coincides with -L(r,r0° and 
hence can be simply taken to be the Lagrangian L(r, r0°.
A.9 Beltrami Flows
A velocity field v (x, t° is said to satisfy the Beltrami property if
V X (r X V° = 0:
(A..5)
We refer to a fluid flow generated by such a velocity field a Beltrami flow.
The Beltrami property (A..5) holds if and only if the velocity v and the vorticity ! = rXv 
are everywhere parallel, i.e., there exists a time-dependent scalar factor k(t° such that
X, t ° = k (t °V (x, t ° :
(A..6)
Since the classical identities
(rv° v = 1 r jvj2 - v x !,
Av = r (r ■ v° - r x !,
enable us to rewrite the incompressible Navier-Stokesequation (2.67)as
@tv - v X ! = -r
1 p + 1 |v|2
2
- Vk2v + g,
(A..7)
we conclude from Eqs. (A..6) and (A..7) that incompressible Beltrami flows under potential 
forces g = -rv must satisfy
@t v = -r
1 p + 1 jvj2 + v 
2
- V k 2v:
(A..8)
If we further assume that the Beltrami velocity field v is steady (@tv = 0) and inviscid 
(V = 0), then the evolution equation (A..8) simplifies to
o = -r
1 p + 1 jvj2 + v 
2
which is always satisfied for the pressure field p = -p (1 jvj2 + vj + C0 for any choice of the 
constant C0 . We have obtained, therefore, that any steady Beltrami flow is a solution of the 
steady, incompressible Euler equation
(rv° v = - rp + g,
(A..9)
p
as long as g is a potential force. 
Assume now that
vo(x° = 1 r X vo(x 

380
Appendix
is a steady, inviscid Beltrami velocity field for a constant factor k , 0, and hence solves Eq. 
(A.39). Then. for any time-dependent sc^ai^ar function c(t°, the velocity field
v (X; t ° = n( t )v0(x) 
(A.40)
also satisfies tle Beltrami property (A.35). To see wler tlis vector fiel- solves tle urstea-y 
Navier-Stokes equation, we substitute the expression (A.40) into the Navier-Stokes equation 
(A.38) for Beltrami flows and use the fact that v0(x° solves the steady Euler equation (A.39). 
We then obtain that
(d + vk2c) Vo = -V 1 p + n21 jvo j2 + V
2
(A.41)
must hold if the velocity field (A.40) is a Navier-Stokes solution. Assume further that no 
body forces act on the fluid and hence V 0 can be selected in Eq. (a.41).theni for the 
choice
p(X;t° = -2Pd2(t° jvo(x°j2
of the pressure function, Eq. (A/Hiissatisfiddasonngas c(t° is a solution of the ODE
C = -V k2 C:
We have therefore obtained that if v0(x° is a Beltrami solution of the incompressible, 
steady Euler equation with vanishinn body forces, then
V (X; t ° = e ~Vklt Vo(X°; p (X; t) = - ^^ P jV (X; t
define a Beltrami solution of the incompressible Navier-Stokes equation (A.37) with g 0.
A.10 Inertial Particle Motion in a General Frame
We carry out an observer channe of the form (3.5) on the Maxey-Riley equations (7.5) to 
transform the equation of motion of finite-size particles from their orininal inertial frame to 
a noninertial frame. The transformed equations of motion become
y p = vp;
6 V p = v (yp; t °- v p +
6 3R DV(yp; t°
2 2 Dt
1 - 3R
g
+
3 R
2
+
(qtQ yp + QTb)
(A.42)
+ 6QTQ [3RV(yp; t)- 2Vp ];
or, in the fast time defined inEq. (7.6), 
yp =6 Vp;
3R DV(yp; to + 6T°
++----------------------- + 6
2 Dt
Vp = V (yp; t o + 6t° - Vp +
+ 6 [ T -1] (QTQy
+ 6QTQ [3RV(yp; to + 6T° - 2Vp]:
3R
1 - T g
(A.43)

A.10 Inertial Particle Motion in a General Frame
381
The critical manifold M0 is, therefore, again described by the relation vp = v(yp, t) and is 
again normally attracting by the same calculation as in Eq. (7.10). One can, hierefore, again 
seek a slow manifold for e > 0 in the form
Me = {(yp, t, vp) eDx R x Rn: vp = v (yp, t ) + e w (yp, t ) + O (e2)} . 
(A.44)
By the invariance of Me, we can differentiate both sides of its defining equation with respect 
to t in Eq. (A.44) to obtain
vp = (Vv) yp + evt + e [Vw) yp + e2wt + O (e2) = (Vvj evp + evf
+ e (Vw) evp + e2wt + O (e2)
= (Vv) e [v + O(e)] + evt + O (e2)
D v
= e£ + O (e2), 
(A.45)
where we have used the definition of Me and the first equation from (A.43). At the same
, • 
1 , • 
0.1 
1 
, • 
C / A A s-W 
Ti~r •
time, evaluation of the second equation of (A.43) on Me gives
0v ■ = -e w + O(e 2) + e 3R D"^
p 
( ° 
2 Dt
+ e [1 - ^Rl g
2 *
+ e [y - 1] (qtQyp + QTb)
+ eQtQ [3Rv(yp, t) - 2 (v + ew + O (e2
(A.46)
Equating the two expressions for vp in Eqs. (A4f^5)am( (A.66)addfollectinglermsef O(e 
then gives
w = (t_ i) Dv+QTQyp + 2qTQv+QTb
(A.47)
,1 
,1 
, 
, • 
• / A 4 \ , 
,1 
1 
'I'll 
1 
• 
1 
1 , 
,1
Restricting then the first equation in (A.43) to the slow manifold Me and passing back to the 
original time t gives the transformed inertial velocity field
3R
yp = v in = v + e — - 1
Dv + QTQyp + 2QtQv + QTb + O (e:
(A.48)
As a consequence, we obtain
V ■ vin = e {3RR - 1) V ■ Dv + qtqyp + 2QtQv + O (e2)
= e ( 33R " 1) [2^Q + tt (QTQ) + 2tr (QTQVv)] + O (e2)
= e(2 - 3R)Q + e (3R - 1) [tr (qtQ) + 2tr (qtQVv)] + O (e2),
(A.49)
where we have used the same steps as in formula (7.15). Therefore, in the transformed 
(noninertial) coordinate system, V ■ vin no longer equals e (2 - 3R° Q at leading order.

382
Appendix
This was to be expected, because the Q(x, t° field is not objective, as we already noted 
in §3.7.1,whereas the divergence of a vector field is objective by formula (3.18). Indeed, 
the transformation formula (3.19) for material derivatives enables us to rewrite the formula 
(A.47) as
w = (3R - 1
I 2
Dv + QTQ yp + 2QTQ v + QTb
3R -1) QT %
which in turn gives an equivalent expression for V ■ vin in the form 
r ■ vin = e {3R - 1) tr QTV DDVQ + O (62)
= 6 (3R - 1) tr r—1 + O (e2)
\ 2 I [ Dt\ X
= e (2 - 3R° Q + O (e2):
(A.50)
This shows that the divergence has not changed under the observer change and hence its 
leading-order term is still the same constant multiple of the Q parameter, but computed in 
the original inertial frame, not in the transformed frame.
A.11 Reynolds Transport Theorem and Flux Through Material Surfaces
Let f (x, t° be a time-dependent vector field of arbitrary dimension and let V(t° be a material 
volume advected by a 3D velocity field v(x, t). This means that V(t° = Ft0 (V(10°° where 
Ft0: x0 ! x(t, 10; x0° is the flow map generated by v.
The rate of change of the volume integral of f over V(t° can then be computed as
f dV = 
f det VFt dV0 =
dt Vv(t) 
dt Vv(f) 
0
Df
= / 
det VFt —
A <t>d 
t0 Dt
= I 
[det rF;0 @f
Vv (<0) L 
@ t
= / @f dV + f 
[det VFt0 (Vf°
vv(t° @t 
Vv(t0) L
D
/ 
-D-t [f det VFt0 ] dV0
V(t>) Dt
+ d (det rFt0) f dV0
+ det VF0 (Vf° v + d (det VF^) f dV
v + d 
VFt0) f dV0:
(A.51)
By formula (2.50) for the evolution of det VFt0, we have d (det VFt0) = (V ■ v° det VFt0. 
Therefore, formula (A.51) can be further written as
d [ f dV =f @f dV +[ 
[det VFt0 (Vf° v + (V ■ v° det VFt0f] dV0
dt v(t) 
Jv(t) @ t 
Jv(t0) 
0
= / @f dV +{ 
»(Vf° v + (V ■ v° f] det VFt0 dV0: 
(A.52)
v(t) @ t 
v(t0°
Next, we recall that the dyadic product a b of the vectors a and b, each of arbitrary 
dimension, is defined in coordinates as a matrix satisfying
»a b]ij = aibj: 
(A.53)

A.11 Reynolds Transport Theorem and Flux Through Material Surfaces 383
Furthermore, the divergence V ■ A of a tensor field A(x) is defined in coordinates as
»r ■ A], = Aik;k;
(A.54)
with summation implied over repeated indices and with the subscript, k referring to the 
partial derivative with respect to the coordinate xk. Using the formulas (A.53) and (A.54), 
we obtain that the divergence of the dyadic product of two vector fields can be computed as
»V ■ (a ® b°]i = (aibJ;j = ai;jbj + a,bj;j;
or, equivalently,
V ■ (a ® b° = (ra° b + (V ■ b° a: 
(A.55)
Using the identity (A.55), we can rewrite the expression (A.52) as
f dV -[ f dV + 
dt v(t) 
v(t) @ t
= f @f dV + 
v(t) @ t
1 V ■ (f ® v° det VFto dV0
Jv (to)
r V ■ (f ® v° dV: 
(A.56)
v (t)
Applying the divergence theorem to each coordinate component of the second integral in 
(A.56) gives, by formula (A.54), that
I r ■ (f ® v° dv = 
»r ■ (f ® v°]i dv = r ■ (fiv° dv
Vv (t) 
Ji 
Jv (t° 
Jv (t°
= 
fiv ■ ndA; 
(A.57)
@VV (t)
where n denotes the outward unit normal vector field along the boundary surface @ V(t° of 
V(t°. Formulas (A.56) and (A.57) then yield the Reynolds transport theorem for material 
volumes in the form
fd[ f dV = [ @- dV + [ 
f (v ■ n° dA■ 
(A.58)
dt VV(t° 
Jv(t° @t 
@V(t(t)
As the vector field f had arbitrary dimension in this derivation, we immediately obtain 
from Eq. (A.58) lorariyscalarlucctinri c (x; t° that
C-f cdV = f @c dV + f 
c (v ■ n° dA. 
(A.59)
dt Jv(t° 
Vv(t° @t 
@VV(t°
It is tempting to conclude from this last equation that the pointwise flux vector of a scalar 
field out of a closed material volume is cv. Assume, however, that c(x; t° is a solution of an 
advection-diffusion equation of the form (8.1) without source terms and the velocity field v 
is incompressible. In that case, c(x; t° satisfies
@t c + r c ■ v = kV ■ (dv c °;
(A.60)
which implies
cd[ cdV = f —c dV0 = f kV ■ (DV c ° dV0 = f k (DV c °- n dA; (A.61) 
dt vv(t° 
.Jv(to) Dt 
v(t° 
@v(t°

384
Appendix
showing that the vector describing the total pointwise flux of the scalar c(x, t° through the 
material surface @V(t° is the well-known diffusive flux vector k (Dr c° rather than cv. Indeed, 
from the advection-diffusion equation (A.60), we obtain
@ @c dV = f [kV -(Dr c )- r c - v] dV = f r -»(kDV c - c v°] dV
V(t° @t 
V(t° 
V(t)
= f [(kDVc - cv°] ■ n dA. 
(A.62)
v (t)
Consequently, in this particular case, JV(t) @@c dV can also be converted into a surface integral, 
a part of which cancels out the second integral inEq. (A.59).
In summary, the volume integrals on the right-hand side of the transport theorems (A.58) 
and (A.59) will generally also contribute to the flux of f and c through the boundary of the 
volume V(t).
A.12 Transformation of the Stream Function and the Vorticity under an 
Observer Change
A.12.1 Transformed Vorticity
For any skew-symmetric linear operator A = -AT 2 R3X3, there exists an associated rotation 
vector rA 2 R3 such that the application of A to an arbitrary vector a is equivalent to taking 
the cross product of 2r with that vector:13 
Aa = -rAxa, 
for all a 2 R3.
(A.63)
Specifically, given the matrix representation of A in any basis, one can solve Eq. (A.63) to 
obtain the unique relationship
0 ab
A = - a 
0 c
y - b - c 0 )
< - c 
rA = 
b
\ - a /
For instance, if W = 2 [ Vv - Vv^ is the spin tensor associated with the velocity field 
v = (u, v, w), then the rotation vector associated with the skew-symmetric tensor W turns out 
to be the vorticity ! = r X v:
10
1 
@v _ _@u
@ 
@X1 
@X2
2 I @w _ _@u
\ 
@X1 
@X3
@u 
@v
@X2 
@X1
0
@w 
@v
@X2 
@X3
@u 
@w
@X3 
@X1
@V 
@w
@X3 
@X2
I
! = rW = -
@w 
@v
@X2 
@X3
@u 
@w
@X3 
@X1
@v 
@u
@X1 
@X2 /
(A.64)
0
Therefore, we have
Wa = -! x a, for all a 2 R3.
2X 
2
(A.65)
In general, for any rotation matrix Q 2 SO(3° and with the notation a = QTa, we can 
rewrite Eq. (A.63) after left-multiplication by QT as
QTAQa = QT1 rA x a = 1 QTrA x QTa = 1 QTrA x a, 
for all a 2 R3, 
(A.66) 

A.12 Frame Change for the Stream Function and the Vorticity 
385
where we have used the fact that the cross product of two vectors does not change when 
both vectors are rotated by the same rotation tensor. Formula (A.66) shows that QTrA is the 
rotation vector for the representation of A in the new basis, i.e.,
rQTAQ = QTrA: 
(A.67)
It also follows by linearity that for any two skew-symmetric matrices A; B 2 R33; their 
rotation matrices relate to the rotation matrix of their sum as
rA+B = rA + rB: 
(A.68)
Now, recall from §3.3 that under an observer change x = Q(t°y+b(t°, taking the y-gradient 
of the velocity transformation formula (3.17) gives
Vv = QT (Vvdx - Q) = qt (VvQ - Q) = qt VvQ - QTQ 
(A.69)
dy
for the velocity gradient tensor in the new y-frame. By the skew-symmetry of QTQ (see 
formula (3.6)), taking the skew-symmetric part of Eq. (A.69) gives the transformation formula
W = 1 [Vv - VvT] = QtWQ - QTQ 
(A.70)
for the spin tensor W.
We can rewrite Eq. (A.70) as
W = QTWQ - QTQ = QT [W - QQT] Q; 
(A.71)
then apply formulas (A.64), (A.67), (A.68) and (A.71) to conclude
rW = rQT(W-QQT° = QTr(W-QQT° = QT (rW - rQQT) : 
(A.72)
Equivalently, by formula (A.64), we obtain from Eq. (A.72) the transformation formula
! = Qt (! - q°; 
q := rQQT: 
(A.73)
A.12.2 Transformed Stream Function
By formula (3.17), the transformed velocity field under the observer change (3.5) is
v = qt (v - Qy - lb): 
(A.74)
By formula (A.69) for the transformed velocity gradient, we have
V ■ v = tr |qt VvQ - QTQ| = tr hQT VvQ
= tr [VvQQT] = tr »Vv]
= V ■ v = 0; 
(A.75)
where we have used the fact that QTQ is skew-symmetric (and hence has zero trace). We 
have also used the identity tr (AB° = tr (BA° for two square matrices of equal dimension.
By formula (A.75), the transformed velocity field v is divergence free if v is divergence 
free and hence has a stream function (y, t° satisfying
v (y; t ° = JViA (y; t °: 
(A.76)

386 
Appendix
To find the specific form of this stream function in the y-frame, we rewrite v from the 
transformation formula (A.74) as
v = QT (JW - Qy - b) = J (qt r( - J_1QTQy - J-1 QTb); 
(a.77)
where we have used the fact that both QT and J are 2D rotation tensors and hence commute 
with each other.
By the chain rule, the first term in the parentheses on the right-hand side of Eq. (A.77) 
can be rewritten as
QT( t ° W (x t ° = r ((Q( t °y + b( t °; t °: 
(A.78)
As for the second term in the parentheses on the right-hand side of Eq. (A.77), the identity 
(3.6) implies that QTQ is a skew-symmetric rotation matrix and hence there exists a scalar 
function !q(t° such that
- J-1QTQ = -J"1 [!q( t )J] = -!q( t )I. 
(A.79)
Finally, for the third term in the parentheses on the right-hand side of Eq. (A.77), we can 
write
- J"1 QTb = JQTb. 
(A.80)
Based on Eqs. (A.78)-(A.80), we can rewrite the velocity transformation formula (A.77) 
as
(r((Q(t°y + b(t°; t° - !q(t°y + JQT(t°b(t))
= Jr (( (Q(t°y + b(t°; t° - 1 !q(t° hy; yi + (JQT(t)b(t), y)j.
A comparison of this equation with formula (A.76) then yields the transformed stream 
function in the form
<A(y;t° = ((Q(t°y + b(t°; t° + (JQT(t)b(t°;y) - 2!q(t° hy;yi. 
(A.81)
A.13 Compatibility Conditions for Global Coordinate Changes Defined 
From Local Considerations
Consider a global, time-dependent, nonlinear coordinate change x = g(y; t), where g( ■; t° 
is a diffeomorphism for any value of t, i.e., an at least once continuously differentiable map 
with a continuously differentiable inverse. Prescribe the local, infinitesimal version of this 
coordinate change, governed by the Jacobian @yg(y; t° of g, via the relationship
dx = G(X; t°dy; 
@yg(y; t° = G(g(y; t), t), 
(A.82)
with the nonsingular tensor field G(x; t° defined at each point x of the physical space. 
Expressed in the original, global x-coordinates, the columns of G(x; t° represent the (linearly 
independent) images of the original unit x-coordinate vectors under the local linear coordinate 
change at x. We then have
2 G11 G12 G13 3
@yg1(y; t°
G(g(y; t °; t ° =
6 G21 
G22 
G23 7
=
@yg2(y; t°
6 G1 
G32 
G33 7 x=g(y.t)
6 @y g3 (y; t °

A.14 Properties of Poincare Maps in 3D Steady Flows 
387
This means that for any time t, the ith row of G(g(y; t), t° must be a gradient vector field 
associated with the scalar potential function gi(y, t). By classical multivariable calculus, on 
a simple connected domain U a vector field admits a smooth potential if and only if it is 
curl-free, i.e.,
r x ([ Gii Gi2 Gi3 ]x=g(y;t°0 ^ 0; i = 1; 2; 3:
These are necessary and sufficient conditions for the existence and smoothness of a 
nonlinear coordinate change x ! y =g-1(x, t°, which is globally well defined up to a constant 
vector on the simple connected domain U on which G(x, t° is prescribed in Eq. (A. 82).
A.14 Properties of Poincare Maps in 3D Steady Flows
Here, we consider a 2D Poincare section E c R3 that is everywhere transverse to a steady 
velocity field v(x). We first show that if a trajectory of v(x° starting from a point x0 2 E 
returns to E, then the first-return map PE : E ! E is a well-defined diffeomorphism (i)e), a 
smooth map with a smooth inverse) in a neighborhood of x0 within E)
To show this, near the point of return P(x0° 2 E we locally define E by an implicit equation 
S(x° = 0 for some scalar-valued function S(x). By the assumed return of the trajectory 
starting from x0, there is a finite time tm in > 0 such that
S (Ft-(x0°) = 0: 
(A.83)
By the implicit function theorem (see (ppendix (.1), Eq. ((.83) will also have a nearby 
solution tmin(x0° for any x0 2 E close enough to x0, provided that the derivative @tS (Ft(x0°° 
is nonzero at (x0, tmin° = (x0; tmin). Evaluating this derivative gives
@t s (Ft) = r s ■ @t Ft = r s ■ x = r s ■ v. 
(a.84)
Noting that rS is nonzero and parallel to the unit surface-normal nE of E, we obtain from 
Eq. (A.84) that
@t S (Ft (x0°) j(x0 ;t )=(x, ;t^n° = jrSj (nE ■ v° jx=Ftm in (x.) , 0;
v . n dA = v . n dA + v . n dA = r . v dV = 0; 
(A.85)
because v is not tangent to E at any point by assumption. This implies the existence of a 
finite return time tmin(x0° for any close enough initial condition x0 on E. In addition, also by 
the implicit function theorem, the function tmin(x0° is just as smooth as the minimal degree 
of smoothness of E and v. Therefore, the first-return map PE is well defined and smooth near 
x0 . Applying the same argument in backward time to the trajectory starting at Ftmin(x0° and 
returning to E at the point x0, we obtain that P£1 is also well defined and smooth locally on 
an open set around PE(x0° in E, and hence the map PE is a local diffeomorphism. By the 
uniqueness of the flow map, PE is also a global diffeomorphism, i.e., has a globally defined 
smooth inverse.
Next, consider a connected open set Sc E of initial conditions and its image PE (S) c E. 
Trajectories of Eq. (2.21) that connect S to PE(S) enclose a 3D cylindrical domain C. If @C 
is the boundary of this domain, with outward unit normal field n, then the flux of v into C 
can be computed as

388
Appendix
where we have used the divergence theorem and the incompressibility of v. If we select a 
smoothly oriented normal vector field nE (x) for E such that along the set S we have nE = n, 
then we must have nE = -n along points in PE(S°. Consequently,
v nE dA = 
v nE dA: 
(A.86)
S 
7p(S)
As S was arbitrary in this argument, we conclude from Eq. (A.86) that the first-return 
map PE preserves the oriented area element
i 7 
it
dA = v nE dA:
This form never vanishes because v nE , 0 holds along E by our assumption on the 
transversality of v to E: In the language of differential geometry, PE is a symplectic map 
as it preserves the nondegenerate, closed two-form dA.4 Symplectic maps that are also 
diffeomorphisms, such as PE, are often called symplectomorphisms.
By a classic theorem of Darboux on symplectic forms (see Abraham et al., 1988), near 
any point x 2 E, there exist coordinates X 2 R2 such that in these coordinates the symplectic 
form dA becomes the classic area form a = dx1 K dx2. In these coordinates, therefore, PE 
becomes locally an area-preserving diffeomorphism at each point of the section E. Globally, 
as a symplectic map PE has the same type of invariant sets as classic area-preserving maps 
(Meiss, 1992; Gole, 2001).
For 3D steady flows that are not incompressible but are still mass-preserving, a similar 
argument can be applied. Namely, the mass-flux in and out of the cylindrical material domain 
C must be constant. Instead of the volume-flux formula (A.85), therefore, we can use the 
steady density field p(x° > 0 of the flow to write the mass-flux formula
y pv ■ n dA = y pv ■ n dA + f pv ■ n dA = f r ■ (pv° dV = 0; 
(A.87)
where we have again used the divergence theorem and the equation of continuity (2.41) with 
pt = 0. Consequently, the relation
pv ■ nE dA = 
pv ■ nE dA 
(A.88)
JS 
Pz(S)
for the arbitrary subset S of E now implies the preservation of the area element
i 7 
it
dA = pv ■ nE dA
under the first-return map PE of a mass-conserving flow.
A.15 Objectivity of the Diffusion Structure Tensor
For concentration fields governed by Eq. (8.59), hie diffusive flux of c (x, t ° through a material 
surface M(t° measures the amount of the substance c(x,t° crossing M(t° per unit time, 
computable as
4 The form is closed because its exterior derivative, the three-form d, necessarily vanishes on E given there 
is no nondegenerate differential three-form on a 2D surface (Abraham et al., 1988).

A.15 Objectivity of the Diffusion Structure Tensor
389
Fluxc (M( t)) = kJ 
(Dr c )■ n dA; 
(A.89)
with Drc generally called the diffusive flux vector.
As a field depending solely on the number of material molecules crossing M(t), the 
diffusive flux Fluxc (M(t°° must be independent of the observer by the principle of material 
frame indifference described inChapter 3.This means that under any Euclidean observer 
change (3.5), we must obtain
k 
hDr c; ni dA = kJ 
(Dr c; n) dA
= 
DQTrc; QTn dA
M(t)
= k 
(QDQTrc; n dA; 
(A.90)
MM°t)
where D is the diffusion structure tensor in the y-frame. As the identity (A.90) must hold for 
any choice of the material surface M (t), we obtain that the frame-indifference of Fluxc (M (t°° 
implies
D (y; t ° = QT( t °D(X; t °Q( t °; 
(A.91)
i.e., D(X; t° must be an objective Eulerian tensor by the definition given in §3.3.3.

References
Abernathey, R., and Haller, G. (2018). Transport by Lagrangian vortices in the Eastern Pacific. J. Phys.
Oceanogr., 48, 667-685.
Abraham, R., Marsden, J. E., and Ratiu, T. (1988). Manifolds, Tensor Analysis, and Applications. Springer, 
New York, NY.
Adrian, R. J., Meinhart, C. D., and Tomkins, C. D. (2000). Vortex organization in the outer region of the 
turbulent boundary layer. J. Fluid Mech., 422, 1-54.
Aksamit, N. O., and Haller, G. (2022). Objective momentum barriers in wall turbulence. J. Fluid Mech.,
941, A3.
Aksamit, N. O., Sapsis, T., and Haller, G. (2020). Machine-learning mesoscale and submesoscale surface 
dynamics from Lagrangian ocean drifter trajectories. J. Phys. Oceanogr., 50(5), 1179-1196.
Aksamit, N. O., Kravitz, B., MacMartin, D. G., and Haller, G. (2022). Harnessing stratospheric diffusion 
barriers for enhanced climate geoengineering. Atmosph. Chem. and Phys., 21(11), 8845-8861.
Alam, M.-R., Liu, W., and Haller, G. (2006). Closed-loop separation control: An analytic approach. Phys. 
Fluids, 18(4), 043601.
Alexander, P. (2004). High order computation of the history term in the equation of motion for a spherical 
particle in a fluid. J. Scientific Comp., 21, 129-143.
Andrade-Canto, F., Karrasch, D., and Beron-Vera, F. J. (2020). Genesis, evolution, and apocalypse of Loop
Current rings. Phys. Fluids, 32(11), 116603.
Anghan, C., Dave, S., Saincher, S., and Banerjee, J. (2019). Direct numerical simulation of transitional and 
turbulent round jets: Evolution of vortical structures and turbulence budget. Phys. Fluids, 31, 053606.
Angilella, J.-R. (2007). Asymptotic analysis of chaotic particle sedimentation and trapping in the vicinity 
of a vertical upward streamline. Phys. Fluids, 19, 073302.
Antuono, M. (2020). Tri-periodic fully three-dimensional analytic solutions for the Navier-Stokes equations.
J. Fluid Mech., 890, A23.
Aref, H. (1984). Stirring by chaotic advection. J. Fluid Mech., 143, 1-21.
Aref, H. (2002). The development of chaotic advection. Phys. Fluids, 14, 1315-1325.
Arnold, V. (1965). Sur la topologie des ecoulements stationnaires des fluides parfaits. C. R. Acad. Sci. Paris,
261, 17-20.
Arnold, V. (1966). Sur la geometrie differentielle des groupes de Lie de dimension infinie et ses applications 
a l’hydrodynamique des fluides parfaits. Annales de I’Institut Fourier, 16(1), 319-361.
Arnold, V. I. (1978). Ordinary Differential Equations. MIT Press, Cambridge, MA.
Arnold, V. I. (1989). Mathematical Methods of Classical Mechanics. Springer-Verlag, New York, NY.
Arnold, V. I., and Keshin, B. A. (1998). Topological Methods of Hydrodynamics. Springer-Verlag, New
York, NY.
Artale, V., Boffetta, G., Celani, A., Cencini, M., and Vulpiani, A. (1997). Dispersion of passive tracers in 
closed basins: Beyond the diffusion coefficient. Phys. Fluids, 9(11), 3162-3171.
Astarita, G. (1979). Objective and generally applicable criteria for flow classification. J. Non-Newtonian 
Fluid Mech., 6, 69-76.
Aulbach, B., and Wanner, T. (2000). The Hartman-Grobman theorem for Caratheodory-type differential 
equations in Banach spaces. Nonlin. Anal. Theory Methods Appl., 40(1), 91-104.
390

References
391
Aurell, E., Boffetta, G., Crisanti, A., Paladin, G., and Vulpiani, A. (1997). Predictability in the large: An 
extension of the concept of Lyapunov exponent. J. Phys. A, 30, 1-26.
Babiano, A., Basdevant, C., Legras, B., and Sadourny, R. (1987). Vorticity and passive-scalar dynamics in 
two-dimensional turbulence. J. Fluid Mech., 183, 379-397.
Babiano, A., Cartwright, J. H. E., Piro, O., and Provenzale, A. (2000). Dynamics ofa small neutrally buoyant 
sphere in a fluid and targeting in Hamiltonian systems. Phys. Rev. Lett., 84, 5764-5767.
Balasuriya, S. (2016). Barriers and Transport in Unsteady Flows: A Melnikov Approach. SIAM, Philadel­
phia, PA.
Balasuriya, S., Ouellette, N. T., and Rypina, I. I. (2018). Generalized Lagrangian coherent structures. Physica 
D, 372, 31-51.
Bandle, C. (1980). Isoperimetric Inequalities and Applications. Pitman, Boston, MA.,London.
Banisch, R., and Koltai, P. (2017). Understanding the geometry of transport: Diffusion maps for Lagrangian 
trajectory data unravel coherent sets. Chaos, 27(3), 035804.
Barbato, D., Berselli, L.-C., and Grisanti, C. R. (2007). Analytical and numerical results for the rational 
large eddy simulation model. J. Math. Fluid Mech., 9, 44-74.
Basar, Y., and Weichert, D. (2000). Nonlinear Continuum Mechanics of Solids: Fundamental Mathematical 
and Physical Concepts. Springer-Verlag, Berlin, Germany.
Basdevant, C., and Philopovitch, T. (1994). On the validity of the “Weiss criterion” in two-dimensional 
turbulence. Physica D, 73, 17-30.
Beal, L., De Ruijter, W., Biastoch, A., et al. (2011). On the role of the Agulhas system in ocean circulation 
and climate. Nature, 472, 429-436.
Beem, J. K., Ehrlich, P. E., and Easley, K. L. (1996). Global Lorentzian Geometry. Taylor & Francis, New 
York, NY.
Benczik, I. J., Toroczkai, Z., and Tel, T. (2002). Selective sensitivity of open chaotic flows on inertial tracer 
advection: Catching particles with a stick. Phys. Rev. Lett., 89, 164501.
Bennett, A. (2006). Lagrangian Fluid Dynamics. Cambridge University Press, Cambridge, UK.
Berman, S. A., Buggeln, J., Brantley, D. A., Mitchell, K. A., and Solomon, T. H. (2021). Transport barriers 
to self-propelled particles in fluid flows. Phys. Rev. Fluids, 6, L012501.
Beron-Vera, F. J. (2021). Nonlinear dynamics of inertial particles in the ocean: From drifters and floats to 
marine debris and Sargassum. Nonlin. Dyn., 103, 1-26.
Beron-Vera, F. J., and Miron, P. (2020). A minimal Maxey-Riley model for the drift of Sargassum rafts. 
J. Fluid Mech., 904, A8.
Beron-Vera, F. J., Olascoaga, M. J., and Goni, G. J. (2008a). Oceanic mesoscale eddies as revealed by 
Lagrangian coherent structures. Geophys. Res. Lett., 35(12).
Beron-Vera, F. J., Brown, M. G., Olascoaga, M. J., Rypina, 1.1., Kogak, H., and Udovydchenkov, I.A. (2008b). 
Zonal jets as transport barriers in planetary atmospheres. J. Atmosph. Sci., 65(10), 3316-3326.
Beron-Vera, F. J., Olascoaga, M. J., Brown, M. G., Kogak, H., and Rypina, I. I. (2010). Invariant-tori-like 
Lagrangian coherent structures in geophysical flows. Chaos, 20, 017514.
Beron-Vera, F. J., Olascoaga, M. J., Brown, M. G., and Kogak, H. (2012). Zonal jets as meridional transport 
barriers in the subtropical and polar lower stratosphere. J. Atmos. Sci., 69, 753-767.
Beron-Vera, F. J., Wang, Y., Olascoaga, M. J., Goni, G. J., and Haller, G. (2013). Objective detection of 
oceanic eddies and the Agulhas leakage. J. Phys. Oceanogr., 43(7), 1426-1438.
Beron-Vera, F. J., Olascoaga, M. J., Haller, G., Farazmand, M., Trinanes, J., and Wang, Y. (2015). Dissipative 
inertial transport patterns near coherent Lagrangian eddies in the ocean. Chaos, 25(8), 087412.
Beron-Vera, F. J., Olascoaga, M. J., Wang, Y., Trinanes, J., and Perez-Brunius, P. (2018). Enduring La­
grangian coherence ofa Loop Current ring assessed using independent observations. Sci. Rep., 8, 11275.
Beron-Vera, F. J., Olascoaga, M. J., and Miron, P. (2019a). Building a Maxey-Riley framework for surface 
ocean inertial particle dynamics. Phys. Fluids, 31(9), 096602.
Beron-Vera, F. J., Hadjighasem, A., Xia, Q., Olascoaga, M. J., and Haller, G. (2019b). Coherent Lagrangian 
swirls among submesoscale motions. Proc. Natl. Acad. Sci. USA, 116(37), 18251-18256.
Bettencourt, J. H., Lopez, C., and Hernandez-Garcia, E. (2013). Characterization of coherent structures in 
three-dimensional turbulent flows using the finite-size Lyapunov exponent. J. Phys. A, 46, 254022.
Bird, R. B., and Stewart, W. E. (2007). Transport Phenomena. John Wiley and Sons, Inc., New York, NY.

392
References
Birkhoff, G. D. (1931). Proof of the ergodic theorem. Proc. Natl. Acad. Sci. USA, 17, 656-660.
Blazevski, D., and Haller, G. (2014). Hyperbolic and elliptic transport barriers in three-dimensional unsteady 
flows. Physica D, 273-274, 46-62.
Bollt, E. M., and Santitissadeekorn, N. (2013). Applied and Computational Measurable Dynamics. SIAM, 
Philadephia, PA.
Born, S., Wiebel, A., Friedrich, J., Scheuermann, G., and Bartz, D. (2010). Illustrative stream surfaces. 
IEEE Trans. Vis. Comp. Graphics, 16(6), 1329-1338.
Bowman, K. P. (1993). Large-scale isentropic mixing properties of the Antarctic polar vortex from analyzed 
winds. J. Geophys. Res. Atmos., 98(D12), 23013-23027.
Bowman, K. P. (1999). Manifold geometry and mixing in observed atmospheric flows. Unpublished 
manuscript.
Brach, L., Deixonne, P., Bernard, M.-F., et al. (2018). Anticyclonic eddies increase accumulation of mi­
croplastic in the North Atlantic subtropical gyre. Marine Pollution Bull., 126, 191-196.
Brown, M. G. (1998). Phase space structure and fractal trajectories in 1-1/2 degree of freedom Hamiltonian 
systems whose time dependence is quasiperiodic. Nonlin. Proc. Geophys., 5(2), 69-74.
Brown, M. G., and Samelson, R. M. (1994). Particle motion in vorticity-conserving, two-dimensional 
incompressible flows. Phys. Fluids, 6(9), 2875-2876.
Brunton, S. L., and Rowley, C. W. (2010). Fast computation of finite-time Lyapunov exponent fields for 
unsteady flows. Chaos, 20, 017503.
Budisic, M., and Mezic, I. (2012). Geometry of the ergodic quotient reveals coherent structures in flows. 
Physica D, 241(15), 1255-1269.
Budisic, M., Siegmund, S., Thai Son, D., and Mezic, I. (2016). Mesochronic classification of trajectories in 
incompressible 3D vector fields over finite times. Disc. Cont. Dyn. Sys., Series S, 9, 923-958.
Burns, T. J., Davis, R. W., and Moore, E. F. (1999). A perturbation study of particle dynamics in a plane 
wake flow. J. Fluid Mech., 384, 1-26.
Cassel, K. W., and Conlisk, A. T. (2014). Unsteady separation in vortex-induced boundary layers. Phil. 
Trans. Royal Soc. A., 372(2020), 20130348.
Cencini, M., and Vulpiani, A. (2013). Finite size Lyapunov exponent: review on applications. J. Phys. A, 
46(25), 254019.
Chakraborty, P., Balachandar, S., and Adrian, R. (2005). On the relationships between local vortex identifi­
cation schemes. J. Fluid Mech., 535, 189-214.
Chelton, D. B., Gaube, P., Schlax, M. G., Early, J. J., and Samelson, R. M. (2011a). The influence of 
nonlinear mesoscale eddies on near-surface oceanic chlorophyll. Science, 334(6054), 328-332.
Chelton, D. B., Schlax, M. G., and Samelson, R. M. (2011b). Global observations of nonlinear mesoscale 
eddies. Progr. Oceanogr., 91(2), 167-216.
Chen, P. (1994). The permeability of the Antarctic vortex edge. J. Geophys. Res. Atmos., 99(D10), 20563­
20571.
Chicone, C. (2006). Ordinary Differential Equations with Applications. Springer-Verlag, New York, NY.
Chien, W. L., Rising, H., and Ottino, J. M. (1986). Laminar mixing and chaotic mixing in several cavity 
flows. J. Fluid Mech., 170, 355-377.
Childress, S. (2009). A Theoretical Introduction to Fluid Dynamics. AMS, Providence, RI.
Chong, M. S., Perry, A. E., and Cantwell, B. J. (1990). A general classification of three-dimensional flow 
field. Phys. Fluids, 2, 765-777.
Chorin, A. J., and Marsden, J. E. (1993). A Mathematical Introduction to Fluid Mechanics. Springer, New 
York, NY.
Claudel, C.-M., Virbhadra, K. S., and Ellis, G. F. R. (2001). The geometry of photon surfaces. J. Math.
Phys., 42(2), 818-838.
Cornfeld, I. P., Fomin, S. V., and Sinai, Ya. G. (1982). Ergodic Theory. Springer, New York, NY.
Cotter, B. A., and Rivlin, R. S. (1955). Tensors associated with time-dependent stress. Q. Appl. Math., 13(5),
177-182.
Coulliette, C., Lekien, F., Paduan, J. D., Haller, G., and Marsden, J. E. (2007). Optimal pollution mitigation in 
Monterey Bay based on coastal radar data and nonlinear dynamics. Environ. Sci. Technol., 41, 6562-6572.

References
393
Crutzen, P. J. (2006). Albedo enhancement by stratospheric sulfur injections: A contribution to resolve a 
policy dilemma? Climatic Change, 77, 211-219.
Cucitore, R., Quadrio, M., and Baron, A. (1999). On the effectiveness and limitations of local criteria for 
the identification of a vortex. Eur. J. Mech.B/Fluids, 18, 261-282.
Daitche, A. (2013). Advection of inertial particles in the presence of the history force: higher order numerical 
schemes. J. Comput. Phys., 254, 93-106.
Daitche, A., and Tel, T. (2014). Memory effects in chaotic advection of inertial particles. New J. Phys., 16, 
073008.
D’Asaro, Eric A., Shcherbina, Andrey Y., Klymak, Jody M., et al. (2018). Ocean convergence and the 
dispersion of flotsam. Proc. Natl. Acad. Sci. USA, 115(6), 1162-1167.
De Silva, C. M., Hutchins, N., and Marusic, I. (2015). Uniform momentum zones in turbulent boundary 
layers. J. Fluid. Mech., 786, 309-331.
Dee, D. P., Uppala, S. M., Simmons, Adrian J., et al. (2011). The ERA-Interim reanalysis: Configuration 
and performance of the data assimilation system. Quart. J. Royal Meteorol. Soc., 137(656), 553-597.
del Castillo-Negrete, D., and Morrison, P. J. (1993). Chaotic transport by Rossby waves in shear flow. Phys. 
Fluids A , 5(4), 948-965.
del Castillo-Negrete, D., Greene, J. M., and Morrison, P. J. (1996). Area preserving nontwist maps: periodic 
orbits and transition to chaos. Physica D, 91(1), 1-23.
Delery, J. M. (2001). Robert Legendre and Henri Werle: Toward the elucidation of three-dimensional 
separation. Annu. Rev. Fluid Mech., 33, 129-154.
Delmarcelle, T., and Hesselink, L. (1994). The topology of symmetric, second-order tensor fields. Proceed­
ings of the Conference on Visualization ’94, 140-147.
Delshams, A., and de la Llave, R. (2000). KAM theory and a partial justification of Green’s criterion for 
nontwist maps. SIAM J. Math. Anal., 31(6), 1235-1269.
Dinklage, A., Klinger, T., Marx, G., and Schweikhard, L. (2005). Plasma Physics - Confinement, Transport 
and Collective Effects. Springer, Heidelberg, Germany.
Doan, M., Simons, J. J., Lilienthal, K., Solomon, T., and Mitchell, K. A. (2018). Barriers to front propagation 
in laminar, three-dimensional fluid flows. Phys. Rev. E, 97, 033111.
Dombre, T., Frisch, U., Greene, J. M., et al. (1986). Chaotic streamlines in ABC flows. J. Fluid Mech., 167, 
353-391.
Dong, C., McWilliams, J., Liu, Y., and Chen, D. (2014). Global heat and salt transports by eddy movement. 
Nat. Commun., 5, 3294.
d’Ovidio, F., Fernandez, V., Hernandez-Garcia, E., and Lopez, C. (2004). Mixing structures in the Mediter­
ranean Sea from finite-size Lyapunov exponents. Geophys. Res. Lett., 31(17), L17203.
Drouot, R. (1976). Definition d’un transport associe un modele de fluide de deuxieme ordre. C. R. Acad. Sc. 
Paris, Series A, 282, 923-926.
Drouot, R., and Lucius, M. (1976). Approximation du second ordre de la loi de comportement des fluides 
simples. Lois classiques deduites de l’introduction d’un nouveau tenseur objectif. Archiwum Mechaniki 
Stosowanej, 28/2, 189-198.
Dryden, H. L., von Karman, T., and Adam, K.A. (1941). Fluid Mechanics and Statistical Methods in 
Engineering. University of Pennsylvania Press, PA.
Dubief, Y., and Delcayre, F. (2000). On coherent-vortex identification in turbulence. J. Turbulence, 1, N11.
Eberly, D. (1996). Ridges in Image and Data Analysis. Springer, New York, NY.
Eisma, J., Westerweel, J., Ooms, G., and Elsinga, G. E. (2015). Interfaces and internal layers in a turbulent 
boundary layer. Phys. Fluids, 27, 055103.
Elhmaidi, D., Provenzale, A., and Babiano, A. (1993). Elementary topology of two-dimensional turbulence 
from a Lagrangian viewpoint and single-particle dispersion. J. Fluid Mech., 257, 533-558.
Elipot, S., Lumpkin, R., Perez, R. C., et al. (2016). A global surface drifter data set at hourly resolution. 
J. Geophys. Res. Oceans, 121(5), 2937-2966.
Encinas-Bartos, A. P., Aksamit, N., and Haller, G. (2022). Quasi-objective eddy visualization from sparse 
drifter data. Chaos (submitted) ArXiv: 2111.14117.
Epps, B. (2017). Review of vortex identification methods. AIAA SciTech Forum, 9-13 January, 2017, 
Grapevine, Texas, 55th AIAA Aerospace Sciences Meeting, 1-22.

394
References
Epstein, I. J. (1963). Conditions for a matrix to commute with its integral. Proc. AMS, 14, 266-270.
Ethier, R. C., and Steinman, D. A. (1994). Exact fully 3D Navier-Stokes solutions for benchmarking. Int.
J. Numer. Meth. Fluids, 19, 369-375.
Everitt, B. S., Landau, S., Leese, M., and Stahl, D. (2011). Cluster Analysis. Wiley, New York, NY.
Falco, R. E. (1977). Coherent motions in the outer region of turbulent boundary layers. Phys. Fluids, 20(10), 
S124-S132.
Fan, D., Xu, J., Yao, M. X., and Hickey, J. P. (2019). On the detection of internal interfacial layers in turbulent 
flows. J. Fluid Mech., 872, 198-217.
Farazmand, M., and Haller, G. (2012). Computing Lagrangian coherent structures from their variational 
theory. Chaos, 22(1), 013128.
Farazmand, M., and Haller, G. (2013). Attracting and repelling Lagrangian coherent structures from a single 
computation. Chaos, 23(2), 023101.
Farazmand, M., and Haller, G. (2015). The Maxey-Riley equation: Existence, uniqueness and regularity of 
solutions. Nonlin. Anal. Real World Applications, 22, 98-106.
Farazmand, M., and Haller, G. (2016). Polar rotation angle identifies elliptic islands in unsteady dynamical 
systems. Physica D, 315, 1-12.
Farazmand, M., Kevlahan, N. K. R., and Protas, B. (2011). Controlling the dual cascade of two-dimensional 
turbulence. J. Fluid Mech., 668, 202-222.
Farazmand, M., Blazevski, D., and Haller, G. (2014). Shearless transport barriers in unsteady two­
dimensional flows and maps. Physica D, 278-279, 44-57.
Fenichel, N. (1971). Persistence and smoothness of invariant manifolds for flows. Indiana Univ. Math. J., 
21, 193-226.
Fenichel, N. (1979). Geometric singular perturbation theory for ordinary differential equations. J. Diff. Eqs., 
31(1), 53-98.
Fountain, G. O., Khakhar, D. V., Mezic, I., and Ottino, J. M. (2000). Chaotic mixing in a bounded three­
dimensional flow. J. Fluid Mech., 417, 265-301.
Friedlander, S., and Vishik, M. M. (1992). Instability criteria for steady flows of a perfect fluid. Chaos, 2(3), 
455-460.
Froyland, G. (2013). An analytic framework for identifying finite-time coherent sets in time-dependent 
dynamical systems. Physica D, 250, 1-19.
Froyland, G. (2015). Dynamic isoperimetry and the geometry of Lagrangian coherent structures. Nonlin­
earity, 28, 3587-3622.
Froyland, G., and Kwok, E. (2017). A dynamic Laplacian for identifying Lagrangian coherent structures on 
weighted Riemannian manifolds. J. Nonlin. Sci., 30, 1889-1971.
Froyland, G., and Padberg-Gehle, K. (2015). A rough-and-ready cluster-based approach for extracting 
finite-time coherent sets from sparse and incomplete trajectory data. Chaos, 25(8), 087406.
Froyland, G., Santitissadeekorn, N., and Monahan, A. (2010). Transport in time-dependent dynamical 
systems: Finite-time coherent sets. Chaos, 20, 043116.
Froyland, G., Koltai, P., and Plonka, M. (2020). Computation and optimal perturbation of finite-time coherent 
sets for aperiodic flows without trajectory integration. SIAM J. Appl. Dynamical Sys., 19, 1659-1700.
Fyrillas, M. M., and Nomura, K. K. (2007). Diffusion and Brownian motion in Lagrangian coordinates. 
J. Chem. Phys., 126, 164510.
Gao, F., Ma, W., Zambonini, G., et al. (2015). Large-eddy simulation of 3-D corner separation in a linear 
compressor cascade. Phys. Fluids, 27, 085105.
Garaboa-Paz, D., Eiras-Barca, J., Huhn, F., and Perez-Munuzuri, V. (2015). Lagrangian coherent structures 
along atmospheric rivers. Chaos, 25(6), 063105.
Gelfand, I. A., and Fomin, S. V. (2000). Calculus of Variations. Dover Publications, Mineola, NY.
Gettelman, A., Hannay, C., Bacmeister, J. T., et al. (2019). High climate sensitivity in the Community Earth 
System Model Version 2 (CESM2). Geophys. Res. Lett., 46, 8329-8337.
Ghosh, S., Leonard, A., and Wiggins, S. (1998). Diffusion of a passive scalar from a no-slip boundary into 
a two-dimensional chaotic advection field. J. Fluid Mech., 372, 119-163.
Gole, C. (2001). Symplectic Twist Maps. World Scientific, Singapore.
Golub, G. H., and Van Loan, C. F. (2013). Matrix Computations. Johns Hopkins University Press, Baltimore.

References
395
Gowen, S., and Solomon, T. (2015). Experimental studies of coherent structures in an advection-reaction- 
diffusion system. Chaos, 25(8), 087403.
Graham, M. D., and Floryan, D. (2021). Exact coherent states and the nonlinear dynamics of wall-bounded 
turbulent flows. Annual Rev. Fluid Mech., 53(1), 227-253.
Green, M. A., Rowley, C. W., and Haller, G. (2007). Detection of Lagrangian coherent structures in three­
dimensional turbulence. J. Fluid Mech., 572, 111-120.
Greene, J. M., and Kim, J.-S. (1987). The calculation of Lyapunov spectra. Physica D, 24(1), 213-225.
Gromeka, I. S. (1881). Some cases of incompressible fluid motion. Scientific Notes of the Kazan University, 
pp. 76-148.
Guckenheimer, J., and Holmes, P. (1983). Nonlinear Oscillations, Dynamical Systems and Bifurcation of 
Vector Fields. Springer, New York, NY.
Guillemin, V., and Pollack, A. (2010). Differential Topology. AMS, Providence, RI.
Gunther, T., and Theisel, H. (2018). The state of the art in vortex extraction. Comput. Graph. Forum, 37, 
149-173.
Gunther, T., and Theisel, H. (2020). Hyper-Objective Vortices. IEEE Trans. Vis. Comput. Graph., 26(3), 
1532-1547.
Gunther, T., Gross, M., and Theisel, H. (2017). Generic objective vortices for flow visualization. ACM Trans.
Graph., 36, 141:1-11.
Gurtin, M. E. (1981). An Introduction to Continuum Mechanics. Academic Press, New York, NY.
Gurtin, M. E., Fried, E., and Anand, L. (2010). The Mechanics and Thermodynamics of Continua. Cambridge 
University Press, Cambridge, UK.
Hadjighasem, A., and Haller, G. (2016a). Geodesic transport barriers in Jupiter’s atmosphere: A video-based 
analysis. SIAM Rev., 69-89.
Hadjighasem, A., and Haller, G. (2016b). Level set formulation of two-dimensional Lagrangian vortex 
detection methods. Chaos, 26, 103102.
Hadjighasem, A., Karrasch, D., Teramoto, H., and Haller, G. (2016). Spectral clustering approach to 
Lagrangian vortex detection. Phys. Rev. E, 93.
Hadjighasem, A., Farazmand, M., Blazevski, D., Froyland, G., and Haller, G. (2017). A critical comparison 
of Lagrangian methods for coherent structure detection. Chaos, 27, 053104.
Hadwiger, M., Mlejnek, M., Theussl, T., and Rautek, P. (2019). Time-dependent flow seen through approx­
imate observer killing fields. IEEE Trans. Vis. Comp. Graph., 25, 1257-1266.
Haley, P. J., and Lermusiaux, P. F. J. (2010). Multiscale two-way embedding schemes for free-surface 
primitive equations in the “Multidisciplinary Simulation, Estimation and Assimilation System”. Ocean 
Dynamics, 60, 1497-1537.
Haller, G. (2000). Finding finite-time invariant manifolds in two-dimensional velocity fields. Chaos, 10, 
99-108.
Haller, G. (2001a). Distinguished material surfaces and coherent structures in 3D fluid flows. Physica D, 
149, 248-277.
Haller, G. (2001b). Lagrangian coherent structures and the rate of strain in a partition of two-dimensional 
turbulence. Phys. Fluids, 13, 3365-3385.
Haller, G. (2002). Lagrangian coherent structures from approximate velocity data. Phys. Fluids, 14, 1851­
1861.
Haller, G. (2004). Exact theory of unsteady separation for two-dimensional flows. J. Fluid Mech., 512, 
257-311.
Haller, G. (2005). An objective definition of a vortex. J. Fluid Mech., 525, 1-26.
Haller, G. (2011). A variational theory of hyperbolic Lagrangian coherent structures. Physica D, 240, 
574-598.
Haller, G. (2015). Lagrangian coherent structures. Ann. Rev. Fluid Mech., 47, 137-162.
Haller, G. (2016). Dynamic rotation and stretch tensors from a dynamic polar decomposition. J. Mech. Phys.
Solids, 86, 70-93.
Haller, G. (2021). Can vortex criteria be objectivized? J. Fluid Mech., 908, A25.
Haller, G., and Beron-Vera, F. J. (2012). Geodesic theory of transport barriers in two-dimensional flows. 
Physica D, 241(20), 1680-1702.

396
References
Haller, G., and Beron-Vera, F. J. (2013). Coherent Lagrangian vortices: The black holes of turbulence. 
J. Fluid Mech., 731, R4.
Haller, G., and Beron-Vera, F. J. (2014). Addendum to “Coherent Lagrangian vortices: The black holes of 
turbulence”. J. Fluid Mech., 751, R3.
Haller, G., and Iacono, R. (2003). Stretching, alignment, and shear in slowly varying velocity fields. Phys. 
Rev. E, 68, 056304.
Haller, G., and Mezic, I. (1998). Reduction of three-dimensional, volume-preserving flows with symmetry. 
Nonlinearity, 11(2), 319-339.
Haller, G., and Poje, A. (1998). Finite time transport in aperiodic flows. Physica D, 119, 352-380.
Haller, G., and Sapsis, T. (2008). Where do inertial particles go in fluid flows? Physica D, 237, 573-583.
Haller, G., and Sapsis, T. (2010). Localized instability and attraction along invariant manifolds. SIAM J. Appl. 
Dyn. Sys., 9, 611-633.
Haller, G., and Sapsis, T. (2011). Lagrangian coherent structures and the smallest finite-time Lyapunov 
exponent. Chaos, 21(2), 023115.
Haller, G., and Yuan, G. (2000). Lagrangian coherent structures and mixing in two-dimensional turbulence. 
Physica D, 147, 352-370.
Haller, G., Hadjighasem, A., Farazmand, M., and Huhn, F. (2016). Defining coherent vortices objectively 
from the vorticity. J. Fluid Mech., 795, 136-173.
Haller, G., Karrasch, D., and Kogelbauer, F. (2018). Material barriers to diffusive and stochastic transport. 
Proc. Natl. Acad. Sci. USA, 115, 9074-9079.
Haller, G., Karrasch, D., and Kogelbauer, F. (2020a). Barriers to the transport of diffusive scalars in 
compressible flows. SIAM J. Appl. Dyn. Sys., 19(1), 85-123.
Haller, G., Katsanoulis, S., Holzner, B., Frohnapfel, B., and Gatti, D. (2020b). Objective barriers to the 
transport of dynamically active vector fields. J. Fluid Mech., 905, A17.
Haller, G., Aksamit, N., and Encinas-Bartos, A. P. (2021). Quasi-objective coherent structure diagnostics 
from single trajectories. Chaos, 31, 043131.
Haller, G., Aksamit, N., and Encinas-Bartos, A. P. (2022). Erratum:“Quasi-objective coherent structure 
diagnostics from single trajectories” [Chaos 31, 043131 (2021)]. Chaos, 32(5), 059901.
Haza, A. C., D’Asaro, E., Chang, H., et al. (2018). Drogue-loss detection for surface drifters during the 
Lagrangian Submesoscale Experiment (LASER). J. Atmosph. Ocean. Techn., 35, 705-725.
Head, M. R., and Bandyopadhyay, P. (1981). New aspects of turbulent boundary-layer structure. J. Fluid 
Mech., 107, 297-338.
Henderson, K. L., Gwynllyw, D. R., and Barenghi, C. F. (2007). Particle tracking in Taylor-Couette flow. 
Eur. J. Mech.B/Fluids, 26(6), 738-748.
Hill, M. J. M. (1894). On a spherical vortex. Phil. Trans. Royal Soc. A., 185, 213-245.
Hua, B. L., and Klein, P. (1998). An exact criterion for the stirring properties of nearly two-dimensional 
turbulence. Physica D, 113, 98-110.
Hua, B. L., McWilliams, J. C., and Klein, P. (1998). An exact criterion for the stirring properties of nearly 
two-dimensional turbulence. J. Fluid Mech., 366, 87-108.
Huhn, F., van Rees, W.M., Gazzola, M., et al. (2015). Quantitative flow analysis of swimming dynamics 
with coherent Lagrangian vortices. Chaos, 25, 087405.
Hunt, J. C. R., Wray, A., and Moin, P. (1988). Eddies, stream, and convergence zones in turbulent flows. 
Center for Turb. Res. Rep. CTR-S88, 193-208.
Jantzen, R. T., Taira, K., Granlund, K. O., and Ol, M. V. (2014). Vortex dynamics around pitching plates.
Phys. Fluids, 26, 065105.
Jeong, J., and Hussain, F. (1995). On the identification of a vortex. J. Fluid Mech., 285, 69-94.
Jones, C. K. R. T. (1995). Geometric singular perturbation theory. In Dynamical Systems: Lectures given at 
the 2nd Session of the Centro Internazionale Matematico Estivo (C.I.M.E.) held in Montecatini Terme, 
Italy, June 13-22, 1994, 44-118.
Jones, C. K. R. T., and Winkler, S. (2002). Invariant Manifolds and Lagrangian Dynamics in the Ocean and 
Atmosphere. In Fiedler, B. (ed.), Handbook of Dynamical Systems. vol. 2. Elsevier Science, Amsterdam, 
pp. 55-92.

References
397
Joseph, B., and Legras, B. (2002). Relation between kinematic boundaries, stirring, and barriers for the 
Antarctic Polar Vortex. J. Atmosph. Sci., 59(7).
Jung, C., Tel, T., and Ziemniak, E. (1993). Application of scattering chaos to particle transport in a 
hydrodynamical flow. Chaos, 3, 555-568.
Kamphuis, M., Jacobs, G. B., Chen, K., Spedding, G., and Hoeijmakers, H. (2018). Pulse actuation and 
its effects on separated Lagrangian coherent structures for flow over a cambered airfoil. In Wright, 
s. D., and Hartsfield, C. R. (eds.), 2018 AIAA Aerospace Sciences Meeting (210059 ed.) https: 
//arc.aiaa.org/doi/10.2514/6.2018-2255.
Karatzas, I., and Shreve, S. (1998). Brownian Motion and Stochastic Calculus. Springer, New York, NY.
Karrasch, D. (2015). Attracting Lagrangian coherent structures on Riemannian manifolds. Chaos, 25(8), 
087411.
Karrasch, D., and Haller, G. (2013). Do finite-size Lyapunov exponents detect coherent structures? Chaos, 
23, 043126.
Karrasch, D., and Schilling, N. (2020). Fast and robust computation of coherent Lagrangian vortices on very 
large two-dimensional domains. SMAI J. Comp. Math., 6, 101-124.
Karrasch, D., Huhn, F., and Haller, G. (2014). Automated detection of coherent Lagrangian vortices in 
two-dimensional unsteady flows. Proc. Royal Soc. A, 471, 20140639.
Karrasch, D., Farazmand, M., and Haller, G. (2015). Attraction-based computation of hyperbolic Lagrangian 
coherent structures. J. Comp. Dynamics, 2, 83-93.
Kashimura, H., Abe, M., Watanabe, S., et al. (2017). Shortwave radiative forcing, rapid adjustment, and 
feedback to the surface by sulfate geoengineering: analysis of the Geoengineering Model Intercomparison 
Project G4 scenario. Atm. Chem. Phys., 17(5), 3339-3356.
Kasten, J., Petz, C., Hotz, I., Hege, H. C., and Noack, B. R. (2010). Lagrangian feature extraction of the 
cylinder wake. Phys. Fluids., 22, 091108.
Kaszas, B., Pedergnana, T., and Haller, G. (2022). The objective deformation component of a velocity field. 
Eur. J. Mech. B/Fluids, submitted.
Katsanoulis, S. (2020). BarrierTool: Automated extraction of material barriers in two-dimensional velocity 
fields. https://github.com/haller-group/BarrierTool.
Katsanoulis, S., Farazmand, M., Serra, M., and Haller, G. (2020). Vortex boundaries as barriers to diffusive 
vorticity transport in two-dimensional flows. Phys. Rev. Fluids, 5, 024701.
Kieburg, M., and Kosters, H. (2016). Exact relation between singular value and eigenvalue statistics. Random 
Matrices: Theory and Appl., 05(04), 1650015.
Kilic, M. S., Haller, G., and Neishtadt, A. (2005). Unsteady fluid flow separation by the method of averaging. 
Phys. Fluids, 17(6), 067104.
Kline, S. J., Reynolds, W. C., Schraub, F. A., and Runstadler, P. W. (1967). The structure of turbulent 
boundary layers. J. Fluid. Mech., 30(4), 741-773.
Klonowska-Prosnak, M. E., and Prosnak, W. J. (2001). An exact solution to the problem of creeping 
flow around circular cylinder rotating in presence of translating plane boundary. Acta Mechanica, 146, 
115-126.
Klose, B. F., Jacobs, G. B., and Serra, M. (2020a). Kinematics of Lagrangian flow separation in external 
aerodynamics. AIAA J., 58, 1926-1938.
Klose, B. F., Jacobs, G. B, and Serra, M. (2020b). Objective early identification of kinematic instabilities in 
shear flows. ArXiv: 2009.05851.
Knobloch, E., and Merryfield, W. J. (1992). Enhancement of diffusive transport in oscillatory flows. Astro­
phys. J., 401, 196-205.
Knobloch, E., and Weiss, J. B. (1987). Chaotic advection by modulated traveling waves. Phys. Rev. A, 36, 
1522-1524.
Kolar, V. (2007). Vortex identification: New requirements and limitations. Int. J. Heat Fluid Flow, 28(4), 
638-652.
Kravitz, B., MaMartin, D. G., Mills, M. J., et al. (2017). First simulations of designing stratospheric sulfate 
aerosol geoengineering to meet multiple simultaneous climate objectives. J. Geophys. Res. Atmos., 122, 
12,616-12,634.

398
References
Kulkarni, C. (2021). Prediction, Analysis and Learning of Advective Transport in Dynamic Fluid Flows. 
Ph.D. Thesis, Massachusetts Institute of Technology, Department of Mechanical Engineering.
LaCasce, J. H. (2008). Statistics from Lagrangian observations. Progr. Oceanogr., 77, 1-29.
Lai, Y.-C., and Tel, T. (2011). Transient Chaos. Springer, New York.
Landau, L. D., and Lifshitz, E. M. (1966). Fluid Mechanics. Pergamon Press.
Langlois, G. P., Farazmand, M., and Haller, G. (2015). Asymptotic dynamics of inertial particles with 
memory. J. Nonlin. Sci, 25, 1225-1255.
Lapeyre, G., Klein, P., and Hua, B. L. (1999). Does the tracer gradient vector align with the strain eigenvectors 
in 2-D turbulence? Phys. Fluids, 11, 3729-3737.
Lapeyre, G., Hua, B. L., and Klein, P. (2001). Dynamics of the orientation of active and passive scalars in 
two-dimensional turbulence. Phys. Fluids, 13, 251-264.
Lebreton, L., Slat, B., Ferrari, F., et al. (2018). Evidence that the Great Pacific Garbage Patch is rapidly 
accumulating plastic. Sci. Rep., 8, 4666.
Lekien, F., and Haller, G. (2008). Unsteady flow separation on slip boundaries. Phys. Fluids, 20(9), 097101.
Lekien, F., and Ross, S. D. (2010). The computation of finite-time Lyapunov exponents on unstructured 
meshes and for non-Euclidean manifolds. Chaos, 20, 017505.
Lekien, F., Coulliette, C., Mariano, A. J., et al. (2005). Pollution release tied to invariant manifolds: A case 
study for the coast of Florida. Physica D, 210, 1-20.
Lekien, F., Shadden, S. C., and Marsden, J. E. (2007). Lagrangian coherent structures in n-dimensional 
systems. J. Math. Phys., 48(6), 065404.
Lewis, J. P. (1969). Homogeneous functions and Euler’s theorem. In An Introduction to Mathematics. 
Macmillan, London.
Li, Y., Perlman, E., Wan, M., et al. (2008). A public turbulence database cluster and applications to study 
Lagrangian evolution of velocity increments in turbulence. J. Turbulence, 9, N31.
Lighthill, M. J. (1963). Introduction: Boundary layer theory. In Rosenhead, L. (ed), Laminar Boundary 
Layers. Oxford University Press, Oxford, pp. 46-113.
Lim, T. T., and Nickels, T. B. (1995). Vortex Rings. In Green, S.I. (ed.) Fluid Vortices, pp. 95-153. Springer, 
Dordrecht, Netherlands.
Limaye, S. S. (1986). New estimates of the mean zonal flow at the cloud level. Icarus, 65, 335-352.
Liu, J., Gao, Y., Wang, Y, and Liu, C. (2019a). Objective Omega vortex identification method. J. Hydrody- 
nam., 31, 455-463.
Liu, J., Gao, Y., and Liu, C. (2019b). An objective version of the Rortex vector for vortex identification. 
Phys. Fluids, 31(6), 065112.
Liu, T., Abernathey, R., Sinha, A., and Chen, D. (2019). Quantifying Eulerian eddy leakiness in an idealized 
model. J. Geophys. Res. Oceans, 124(12), 8869-8886.
Liu, W., and Haller, G. (2004). Strange eigenmodes and decay of variance in the mixing of diffusive tracers.
Physica D, 188, 1-39.
Llibre, J., and Valls, C. (2012). A note on the first integrals of the ABC system. J. Math. Phys., 53(2), 023505.
Lugt, H. J. (1979). The dilemma of defining a vortex. In Muller, U., Riesner, K. G., and Schmidt, B. (eds), 
Recent Developments in Theoretical and Experimental Fluid Mechanics. pp. 13, 309-321.
Lumpkin, R., and Pazos, M. (2007). Lagrangian Analysis and Prediction in Coastal and Ocean Processes. 
Cambridge University Press, Cambridge, UK.
Ma, T., and Bollt, E. M. (2013). Relatively coherent sets as a hierarchical partition method. Int. J. Bifurc.
Chaos, 23(07), 1330026.
Mackay, R. S. (1994). Transport in 3D volume-preserving flows. J. Nonlin. Sci., 4, 329-354.
Mackay, R. S., Meiss, J. D., and Percival, I. C. (1984). Transport in Hamiltonian systems. Physica D, 13,
55-81.
Madrid, J. A. J., and Mancho, A. M. (2009). Distinguished trajectories in time dependent vector fields. 
Chaos, 19, 013111.
Mahoney, J. R., and Mitchell, K. A. (2015). Finite-time barriers to front propagation in two-dimensional 
fluid flows. Chaos, 25, 087404.
Mahoney, J. R., Bargteil, D., Kingsbury, M., Mitchell, K., and Solomon, T. (2012). Invariant barriers to 
reactive front propagation in fluid flows. Europhys. Lett., 98, 44005.

References
399
Majda, A. J., and Bertozzi, A. L. (2002). Vorticity and Incompressible Flow. Cambridge University Press, 
Cambridge, UK.
Malhotra, N., Mezic, I., and Wiggins, S. (1998). Patchiness: A new diagnostic for Lagrangian trajectory 
analysis in time-dependent fluid flows. Int. J. Bifurc. Chaos, 08(06), 1053-1093.
Mancho, A. M., Wiggins, S., Curbelo, J., and Mendoza, C. (2013). Lagrangian descriptors: A method for 
revealing phase space structures of general time dependent dynamical systems. Comm. Nonlin. Sci. Num. 
Sim., 18, 3530-3557.
Mane, R. (1978). Persistent manifolds are normally hyperbolic. Trans. Am. Math. Soc., 21, 261-283.
Martins, R. S., Pereira, A. S., Mompean, G., Thais, L., and Thompson, R. L. (2016). An objective 
perspective for classic flow classification criteria. C. R. Mecanique, 344, 52-59.
Mathur, M., Haller, G., Peacock, T., Ruppert-Felsot, J. E., and Swinney, H. L. (2007). Uncovering the 
Lagrangian skeleton of turbulence. Phys. Rev. Lett., 98, 144502.
Maxey, M. R. (1987). The gravitational settling of aerosol particles in homogeneous turbulence and random 
flow fields. J. Fluid Mech., 174, 441-465.
Maxey, M. R., and Riley, J. J. (1983). Equation of motion for a small rigid sphere in a nonuniform flow. 
Phys. Fluids, 26, 883-889.
McMullan, W. A., and Page, G. J. (2012). Towards large eddy simulation of gas turbine compressors. Progr.
Aerospace. Sci., 52, 30-47.
Meiss, J. D. (1992). Symplectic maps, variational principles and transport. Rev. Modern Phys,, 64, 795-848. 
Mendoza, C., and Mancho, A. M. (2010). Hidden geometry of ocean flows. Phys. Rev. Lett., 105, 038501. 
Meunier, P., Le Dizes, S., and Leweke, T. (2005). Physics of vortex merging. Comptes Rendus Physique, 
6(4), 431-450.
Meyers, J., and Meneveau, C. (2013). Flow visualization using momentum and energy transport tubes and 
applications to turbulent flow in wind farms. J. Fluid Mech., 715, 335-358.
Mezic, I., and Sotiropoulos, F. (2002). Ergodic theory and experimental visualization of invariant sets in 
chaotically advected flows. Phys. Fluids, 14(7), 2235-2243.
Mezic, I., Loire, S., Fonoberov, V. A., and Hogan, P. (2010). A new mixing diagnostic and Gulf oil spill 
movement. Science, 330, 486-489.
Michaelides, E. E. (1997). The transient equation of motion for particles, bubbles, and droplets. J. Fluids 
Eng., 119, 223-247.
Miron, P., and Vetel, J. (2015). Towards the detection of moving separation in unsteady flows. J. Fluid 
Mech., 779, 81-84.
Miron, P., Olascoaga, M. J., Beron-Vera, et al. (2020). Clustering of marine debris and sargassum-like 
drifters explained by inertial particle dynamics. Geophys. Res. Lett., 47(19), e2020GL089874.
Mitchell, K. A., and Mahoney, J. R. (2012). Invariant manifolds and the geometry of front propagation in 
fluid flows. Chaos, 22(3), 037104.
Mograbi, E., and Bar-Ziv, E. (2006). On the asymptotic solution of the Maxey-Riley equation. Phys. Fluids, 
18(5), 051704.
Monin, A. S., and Yaglom, A. M. (2007). Statistical Fluid Mechanics: Mechanics of Turbulence. Volume 
I. Dover Publications, Mineola, NY.
Nakamura, N. (2008). Quantifying inhomogeneous, instantaneous, irreversible transport using passive 
tracer field as a coordinate. Lect. Notes in Phys., 744, 137-144.
Neamtu-Halic, M. M., Krug, D., Haller, G., and Holzner, M. (2019). Lagrangian coherent structures and 
entrainment near the turbulent/non-turbulent interface of a gravity current. J. Fluid Mech., 877, 824-843.
Neamtu-Halic, M. M., Krug, D., Mollicone, J.-P., et al. (2020). Connecting the time evolution of the 
turbulence interface to coherent structures. J. Fluid Mech., 898, A3.
Neff, P., Lankeit, J., and Madeo, A. (2014). On Grioli’s minimum property and its relation to Cauchy’s 
polar decomposition. Int. J. Eng. Sci., 80, 209-217.
Nelson, D. A., and Jacobs, G. B. (2015). DG-FTLE: Lagrangian coherent structures with high-order 
discontinuous-Galerkin methods. J. Comp. Phys., 295, 65-86.
Nolan, P. J., Serra, M., and Ross, S. D. (2020). Finite-time Lyapunov exponents in the instantaneous limit 
and material transport. Nonlin. Dyn., 100(19), 3825-3852.

400
References
Norgard, G., and Bremer, P.-T. (2012). Second derivative ridges are straight lines and the implications for 
computing Lagrangian coherent structures. Physica D, 241, 1475-1476.
Oberlack, M., and Cheviakov, A. F. (2010). Higher-order symmetries and conservation laws of the 
G-equation for premixed combustion and resulting numerical schemes. J. Eng. Math., 66, 121-140.
Oettinger, D. (2017). Variational Approach to Lagrangian Coherent Structures in Three-Dimensional 
Unsteady Flows. Ph.D. Thesis, ETH Zurich.
Oettinger, D., and Haller, G. (2016). An autonomous dynamical system captures all LCSs in three­
dimensional unsteady flows. Chaos, 26(10), 103111.
Oettinger, D., Blazevski, D., and Haller, G. (2016). Global variational approach to elliptic transport barriers 
in three dimensions. Chaos, 26(3), 033114.
Oettinger, D., Ault, J. T., Stone, H. A., and Haller, G. (2018). Invisible anchors trap particles in branching 
junctions. Phys. Rev. Lett., 121, 054502.
Ogden, R. W. (1984). Non-Linear Elastic Deformations. Ellis Horwood, Chichester.
Okubo, A. (1970). Horizontal dispersion of floatable trajectories in the vicinity of velocity singularities 
such as convergencies. Deep-Sea Res., 17, 445-454.
Onu, K., Huhn, F., and Haller, G. (2015). LCSTool: A computational platform for Lagrangian coherent 
structures. J. Comp. Sci., 7, 26-36.
Oseledec, V. I. (1968). A multiplicative ergodic theorem. Lyapunov characteristic numbers for dynamical 
systems. Trudy Moskov. Mat. Obsc, 19, 179-210.
Ott, W., and Yorke, J. A. (2008). When Lyapunov exponents fail to exist. Phys. Rev. E, 78, 056203.
Ottino, J. M. (1989). The Kinematics of Mixing: Stretching, Chaos and Transport. Cambridge University 
Press, Cambridge, UK.
Paduan, J. D., and Cook, M. S. (1997). Mapping surface currents in Monterey Bay with CODAR-type HR 
radar. Oceanogr., 10, 49-52.
Palis, Jr. P. (1969). On Morse-Smale dynamical systems. Topology, 8, 385-404.
Palmerius, K. L., Cooper, M., and Ynnerman, A. (2009). Flow field visualization using vector field 
perpendicular surfaces. Proceedings of the 25th Spring Conference on Computer Graphics. SCCG ’09. 
Association for Computing Machinery, New York, NY, pp. 27-34.
Pedergnana, T., Oettinger, D., and Haller, G. (2020). Explicit unsteady Navier-Stokes solutions and their 
analysis via local vortex criteria. Phys. Fluids, 32, 046603.
Peikert, R., and Sadlo, F. (2009). Topologically relevant stream surfaces for flow visualization. Proc. of 
the 25th Spring Conference on Computer Graphics. SCCG ’09. Association for Computing Machinery, 
New York, NY, pp. 35-42.
Peng, J., and Dabiri, J. O. (2009). Transport of inertial particles by Lagrangian coherent structures: 
application to predator-prey interaction in jellyfish feeding. J. Fluid Mech., 623, 75-84.
Perry, A. E., and Chong, M. S. (1987). A description of eddying motions and flow patterns using 
critical-point concepts. Annual Rev. Fluid Mech., 19, 125-155.
Perry, A. E., and Chong, M. S. (1994). Topology of flow patterns in vortex motions and turbulence. Applied. 
Sci. Res., 53, 357-374.
Pierce, J. R., Winstein, D. K., Heckendorn, P., Peter, T., and Keith, D. W. (2010). Efficient formation of 
stratospheric aerosol for climate engineering by emission of condensible vapor from aircraft. Geophys. 
Res. Lett., 37, L18805.
Pierrehumbert, R. T. (1991). Large-scale horizontal mixing in planetary atmospheres. Phys. Fluids A, 3(5), 
125-1260.
Pierrehumbert, R. T. (1994). Tracer microstructure in the large-eddy dominated regime. Chaos, Solit. 
Fractals, 4, 1091-1110.
Pierrehumbert, R. T., and Yang, H. (1993). Global chaotic mixing on isentropic surfaces. J. Atmos. Sci., 50, 
2462-2480.
Poje, A. C., Ozgokmen, T. M., Lipphardt, B. L., et al. (2014). Submesoscale dispersion in the vicinity of 
the Deepwater Horizon spill. Proc. Natl. Acad. Sci. USA, 111(35), 12693-12698.
Prandtl, L. (1904). Uber Flussigkeitsbewegung bei sehr kleiner Reibung. In Verh. III, Int. Math. Kongr., 
Heidelberg, 484-491.

References
401
Prasath, S. G., Vasan, V., and Govindarajan, R. (2019). Accurate solution method for the Maxey-Riley 
equation, and the effects of Basset history. J. Fluid Mech., 868, 428-460.
Pratt, L., Barkan, R., and Rypina, I. (2016). Scalar flux kinematics. Fluids, 1, 27.
Press, W. H., and Rybicki, G. B. (1981). Enhancement of passive diffusion and suppression of heat flux in 
a fluid with time-varying shear. Astrophys. J., 248, 751-766.
Provenzale, A. (1999). Transport by coherent barotropic vortices. Annu. Rev. Fluid Mech., 31, 55-93.
Rautek, P., Mlejnek, M., Beyer, J., et al. (2021). Objective observer-relative flow visualization in curved 
spaces for unsteady 2D geophysical flows. IEEE Trans. Vis. Comp. Graphics, 27, 283-293.
Risken, H. (1984). The Fokker-Planck Equation: Methods of Solution and Applications. Springer, New 
York, NY.
Rojo, I. B., and Gunther, T. (2020). Vector field topology of time-dependent flows in a steady reference 
frame. IEEE Trans. Vis. Comp. Graphics, 26, 1280-1290.
Rom-Kedar, V. (1994). Homoclinic tangles: classification and applications. Nonlinearity, 7, 441-473.
Rom-Kedar, V., and Wiggins, S. (1990). Transport in two-dimensional maps. Arch. Rat. Mech. Anal., 109, 
239-298.
Rom-Kedar, V., Leonard, A., and Wiggins, S. (1990). An analytical study of transport, mixing and chaos 
in an unsteady vortical flow. J. Fluid Mech., 214, 347-394.
Rosner, D. (2000). Transport Processes in Chemically Reacting Flow Systems. Dover Publications, Mineola, 
NY.
Rothstein, D., Henry, E., and Gollub, J. P. (1999). Persistent patterns in transient chaotic fluid mixing. 
Nature, 401, 770-772.
Rouche, M., Habets, P., and Laloy, M. (1977). Stability Theory by Lyapunov’s Direct Method. Springer­
Verlag New York, NY.
Ruban, A. I., Araki, D., Yapalparvi, R., and Gajjar, J. S. B. (2011). On unsteady boundary-layer separation 
in supersonic flow. Part 1. Upstream moving separation point. J. Fluid Mech., 678, 124-155.
Rubin, J., Jones, C. K. R. T., and Maxey, M. (1995). Settling and asymptotic motion of aerosol particles in 
a cellular flow field. J. Nonlin. Sci., 5, 337-358.
Ruiz-Herrera, A. (2015). Some examples related to the method of Lagrangian descriptors. Chaos, 25, 063112.
Ruiz-Herrera, A. (2016). Performance of Lagrangian descriptors and their variants in incompressible flows. 
Chaos, 26, 103116.
Rypina, I. I., Brown, M. G., Beron-Vera, F. J., et al. (2007). Area preserving nontwist maps: periodic orbits 
and transition to chaos. Phys. Rev. Lett., 98, 104102.
Rypina, I. I., Scott, S. E., Pratt, L. J., and Brown, M. G. (2011). Investigating the connection between complex­
ity of isolated trajectories and Lagrangian coherent structures. Nonlin. Proc. Geophys., 18(6), 977-987.
Sabelfeld, K. K., and Simonov, N. A. (2012). Random Fields and Stochastic Lagrangian Models. De 
Gruyter, Berlin, Germany.
Saffman, P. G., (1992). Vortex Dynamics. Cambridge University Press, Cambridge, UK.
Sahner, J., Weinkauf, T., Teuber, N., and Hege, H. (2007). Vortex and strain skeletons in Eulerian and 
Lagrangian frames. IEEE Trans. Vis. Comp. Graphics, 13(5), 980-990.
Samelson, R. M. (1992). Fluid exchange across a meandering jet. J. Phys. Oceanogr., 22, 431-440.
Samelson, R. M., and Wiggins, S. (2006). Lagrangian Transport in Geophysical Jets and Waves. 
Springer-Verlag, New York, NY.
Sanders, J. A., Verhulst, F., and Murdock, J. (2007). Averaging Methods in Nonlinear Dynamical Systems. 
Springer, New York, NY.
Sane, S., Bujack, R., Garth, C., and Childs, H. (2020). A survey of seed placement and streamline selection 
techniques. Comput. Graph. Forum, 39(3), 785-809.
Sapsis, T., and Haller, G. (2008). Instabilities in the dynamics of neutrally buoyant particles. Phys. Fluids, 
20, 017102.
Sapsis, T., and Haller, G. (2009). Inertial particle dynamics in a hurricane. J. Atmosph. Sci., 66(8), 
2481-2492.
Sapsis, T., and Haller, G. (2010). Clustering criterion for inertial particles in two-dimensional time-periodic 
and three-dimensional steady flows. Chaos, 20, 017515.

402
References
Sapsis, T., Peng, J., and Haller, G. (2011a). Instabilities of prey dynamics in jellyfish feeding. Bull. Math. 
Biol., 73, 1841-1856.
Sapsis, T. P., Ouellette, N. T., Gollub, J. P., and Haller, G. (2011b). Neutrally buoyant particle dynamics in 
fluid flows: Comparison of experiments with Lagrangian stochastic models. Phys. Fluids, 23, 093304.
Schindler, B., Peikert, R., Fuchs, R., and Theisel, H. (2012). Ridge concepts for the visualization of 
Lagrangian coherent structures. In Peikert, R., Hauser, H., Carr, H., and Fuchs, R. (eds), Topological 
Methods in Data Analysis and Visualization II, pp. 221-236.
Schlueter-Kuck, K. L., and Dabiri, J. O. (2017). Coherent structure colouring: identification of coherent 
structures from sparse data using graph theory. J. Fluid Mech., 811, 468-486.
Sears, W. R., and Telionis, D. P. (1975). Boundary-layer separation in unsteady slow. SIAM J. Appl. Math., 
28(1), 215-235.
Serra, M., and Haller, G. (2016). Objective Eulerian coherent structures. Chaos, 26, 053110.
Serra, M., and Haller, G. (2017a). Efficient computation of null-geodesics with applications to coherent 
vortex detection. Proc. Royal Soc. A, 473, 2016080.
Serra, M., and Haller, G. (2017b). Forecasting long-lived Lagrangian vortices from their objective Eulerian 
footprints. J. Fluid Mech., 813, 436-457.
Serra, M., Sathe, P., Beron-Vera, F., and Haller, G. (2017). Uncovering the edge of the polar vortex. 
J. Atmosph. Sci., 74(11), 3871-3885.
Serra, M., Vetel, J., and Haller, G. (2018). Exact theory of material spike formation in flow separation. 
J. Fluid Mech., 845, 51-92.
Serra, M., Crouzat, S., Simon, G., Vetel, J., and Haller, G. (2020a). Material spike formation in highly 
unsteady separated flows. J. Fluid Mech., 883, A30.
Serra, M., Sathe, P., Rypina, I., et al. (2020b). Search and rescue at sea aided by hidden flow structures. 
Nat. Commun., 11, 2525.
Shadden, S. C. (2011). Lagrangian coherent structures. In Grigoriev, R. (ed.), Transport and Mixing in 
Laminar Flows: From Microfluidics to Oceanic Currents, Wiley-VCH, Berlin, Germany, pp. 59-89.
Shadden, S. C., Lekien, F., and Marsden, J. E. (2005). Definition and properties of Lagrangian coherent 
structures from finite-time Lyapunov exponents in two-dimensional aperiodic flows. Physica D, 212(3), 
271-304.
Shapiro, A. (1961). Vorticity. Part 1. US National Committee for Fluid Mechanics Film Series. MIT, 
Cambridge, MA. http://web.mit.edu/hml/ncfmf.html
Shariff, K., Pulliam, T. H., and Ottino, J. M. (1991). A dynamical systems analysis of kinematics in the 
time-periodic wake of a circular cylinder. Lect. Appl. Math., 28, 613-646.
Shariff, K., Leonard, A., and Ferziger, J. H. (2006). Dynamical systems analysis of fluid transport in 
time-periodic vortex ring flows. Phys. Fluids, 18(4), 047104.
Shepherd, T. G., Koshyk, J. N., and Ngan, K. (2000). On the nature of large-scale mixing in the stratosphere 
and mesosphere. J. Geophys. Res., 105(D10), 12433-12446.
Simon-Miller, A. A., Rogers, J. H., Gierasch, P. J., et al. (2012). Longitudinal variation and waves in 
Jupiter’s south equatorial wind jet. Icarus, 218, 817-830.
Simpson, R. L. (1996). Aspects of turbulent boundary layer separation. Prog. Aerospace Sci., 32, 457-521.
Smale, S. (1967). Differentiable dynamical systems. Bull. AMS, 73, 747-817.
Smith, F.T. (1986). Steady and unsteady boundary-layer separation. Annu. Rev. Fluid Mech., 18(1), 197-220.
Sotiropoulos, F., Ventikos, Y., and Lackey, T. C. (2001). Chaotic advection in three-dimensional stationary 
vortex-breakdown bubbles: Sil’nikov’s chaos and the devil’s staircase. J. Fluid Mech., 444, 257-297.
Sotiropoulos, F., Webster, D. L., and Lackey, T. C. (2002). Experiments on Lagrangian transport in steady 
vortex-breakdown bubbles in a confined swirling flow. J. Fluid Mech., 466, 215-248.
Speetjens, M., Metcalfe, G., and Rudman, M. (2021). Lagrangian transport and chaotic advection in 
three-dimensional laminar flows. Appl. Mech. Rev., 73(3), 030801.
Spivak, M. (1999). A Comprehensive Introduction to Differential Geometry, vol. 3, 3rd edn. Publish or 
Perish, Inc., Houston, TX.

References
403
Stevenson, A. F. (1954). Note on the existence and determination of a vector potential. Quart. J. Appl. 
Math., 12, 194-198.
Surana, A., and Haller, G. (2008). Ghost manifolds in slow-fast systems, with application to unsteady fluid 
flow separation. Physica D, 237(10-12), 1507-1529.
Surana, A., Grunberg, O., and Haller, G. (2006). Exact theory of three-dimensional flow separation. Part 
I. Steady separation. J. Fluid Mech., 564, 57-103.
Surana, A., Jacobs, G. B., and Haller, G. (2007). Extraction of separation and attachment surfaces from 
three-dimensional steady shear flows. AIAA J., 45(6), 1290-1302.
Surana, A., Jacobs, G., Grunberg, O., and Haller, G. (2008). An exact theory of three-dimensional fixed 
separation in unsteady flows. Phys. Fluids, 20, 107101.
Tabor, M., and Klapper, I. (1994). Stretching and alignment in chaotic and turbulent flows. Chaos, Solitons 
Fract., 4, 1031-1055.
Tala, T., and Garbet, X. (2006). Physics of internal transport barriers. Comptes Rendus Physique, 7(6), 
622-633.
Tang, W., Haller, G., Baik, J.-J., and Ryu, Y.-H. (2009). Locating an atmospheric contamination source 
using slow manifolds. Phys. Fluids, 21, 043302.
Tang, W., Chan, P. W., and Haller, G. (2010). Accurate extraction of Lagrangian coherent structures over finite 
domains with application to flight data analysis over Hong Kong International Airport. Chaos, 20, 017502.
Tang, W., Chan, P. W., and Haller, G. (2011a). Lagrangian coherent structure analysis of terminal winds 
detected by LIDAR. Part I: Turbulence structures. J. Appl. Meteorol. Climatol., 50(2), 325-338.
Tang, W., Chan, P. W., and Haller, G. (2011b). Lagrangian coherent structure analysis of terminal winds 
detected by LIDAR. Part II: Structure evolution and comparison with flight data. J. Appl. Meteorol. 
Climatol., 50(10), 2167-2183.
Tang, X. Z., and Boozer, A. H. (1996). Finite time Lyapunov exponent and advection-diffusion equation. 
Physica D, 95, 283-305.
Tanga, P., Babiano, A., Dubrulle, B., and Provenzale, A. (1996). Forming planetesimals in vortices. Icarus, 
121(1), 158-170.
Tel, T., de Moura, A., Grebogi, C., and Karolyi, G. (2005). Chemical and biological activity in open flows: 
A dynamical system approach. Phys. Rep., 413(2), 91-196.
Theisel, H., Hadwiger, M., Rautek, P., Theussl, T., and Gunther, T. (2021). Vortex criteria can be 
objectivized by unsteadiness minimization. Phys. Fluids, 33(10), 107115.
Theisel, H., Friederici, A., and Gunther, T. (2022). Objective flow measures based on few trajectories. 
ArXiv: 2202.09566.
Thiffeault, J.-L. (2003). Advection-diffusion in Lagrangian coordinates. Phys. Lett. A, 30, 415-422.
Thiffeault, J.-L. (2008). Scalar decay in chaotic mixing. Lect. Notes Phys., 744, 3-35.
Thiffeault, J.-L., Gouillart, E., and Dauchot, O. (2011). Moving walls accelerate mixing. Phys. Rev. E, 84, 
036313.
Tian, S., Gao, Y., Dong, X., and Liu, C. (2018). Definitions of vortex vector and vortex. J. Fluid Mech., 
849, 312-339.
Tobak, M., and Peake, D. J. (1982). Topology of three-dimensional separated flows. Annu. Rev. Fluid 
Mech., 14, 61-85.
Toda, M. (2005). Global aspects of chemical reactions in multidimensional phase space. In Toda, M., 
Komatsuzaki, T., Konishi, T., Berry, R. S., and Rice, S. A. (eds), Geometrical Structures of Phase Space 
In Multi-Dimensional Chaos: Applications To Chemical Reaction Dynamics In Complex Systems. John 
Wiley & Sons, New York, NY.
Tran-Cong, T. (1990). On the potential of a solenoidal vector field. J. Math. Anal. Appl., 151, 557-580.
Trefethen, L. N., and Bau, D. (1997). Numerical Linear Algebra. SIAM, Philadelphia, PA.
Truesdell, C. A. (1992). A First Course in Rational Continuum Mechanics. Academic Press, New York, NY.
Truesdell, C., and Rajagopal, K. R. (1999). An Introduction to the Mechanics of Fluids. Birkhauser, Boston, 
MA.

404
References
Urban, O., Kurkova, M., and Rudolf, P. (2021). Application of computer graphics flow visualization 
methods in vortex rope investigations. Energies., 14(3), 623.
Van Dommelen, L. L. (1981). Unsteady Boundary Layer Separation. Ph.D. Thesis, Cornell University.
Van Dommelen, L. L., and Cowley, S. J. (1990). On the Lagrangian description of unsteady boundary-layer 
separation. Part 1. General theory. J. Fluid Mech., 210, 593-626.
Van Dommelen, L. L., and Shen, S. F. (1982). The genesis of separation. In Cebeci, Tuncer (ed.), Numerical 
and Physical Aspects of Aerodynamic Flows. Springer, Berlin, Germany, pp. 293-311.
Van Dyke, M. (1982). An Album of Fluid Motion. The Parabolic Press, Stanford, CA.
Verhulst, F. (2000). Nonlinear Differential Equations and Dynamical Systems. Springer-Verlag, Berlin, 
Germany.
Verhulst, F. (2005). Methods and Applications of Singular Perturbations. Springer, New York, NY.
Viana, R. L., Caldas, I. L., Szezech Jr., J. D., et al. (2021). Transport barriers in symplectic maps. Braz. J.
Phys., 51, 899-909.
Villermaux, E., and Duplat, J. (2003). Mixing is an aggregation process. C. R. Mecanique, 331(7), 515-523.
Voth, G. A., Haller, G., and Gollub, J. P. (1994). Experimental measurements of stretching fields in fluid 
mixing. Phys. Rev. Lett., 88(25), 254501.
Waleffe, F. (1998). Three-dimensional coherent states in plane shear flows. Phys. Rev. Lett., 81, 4140-4143.
Waleffe, F. (2001). Exact coherent structures in channel flow. J. Fluid Mech., 435, 93-102.
Walters, P. (1982). An Introduction to Ergodic Theory. Springer-Verlag, New York, NY.
Wan, Z. Y., and Sapsis, T. P. (2018). Machine learning the kinematics of spherical particles in fluid flows.
J. Fluid Mech., 857, R2.
Wang, K. C. (1972). Separation patterns of boundary layer over an inclined body of revolution. AIAA J., 
10, 1044-1050.
Wang, K. C. (1974). Boundary layer over a blunt body at high incidence with an open-type separation. 
Proc. Royal Soc. Lond. A, 340, 33-55.
Wang, Y., Haller, G., Banaszuk, A., and Tadmor, G. (2003). Closed-loop Lagrangian separation control in 
a bluff body shear flow model. Phys. Fluids, 15(8), 2251-2266.
Weiss, J. (1991). The dynamics of entrophy transfer in two-dimensional hydrodynamics. Physica D, 48, 
273-294.
Weiss, J. B., and Provenzale, A. (2008). Transport and Mixing in Geophysical Flows. Springer, Berlin, 
Germany.
Weldon, M., Peacock, T., Jacobs, G. B., Helu, M., and Haller, G. (2008). Experimental and numerical 
investigation of the kinematic theory of unsteady separation. J. Fluid Mech., 611, 1-11.
Westerweel, J., Fukoshima, C., Pedersen, J. M., and Hunt, J. C. R. (2009). Momentum and scalar transport 
at the turbulent/non-turbulent interface of a jet. J. Fluid Mech., 631, 199-230.
Wiggins, S. (1992). Chaotic Transport in Dynamical Systems. Springer-Verlag, New York, NY.
Wu, J. Z., Gu, J. W., and Wu, J. M. (1987). Steady three-dimensional fluid particle separation from arbitrary 
smooth surface and formation of free vortex layers. AIAA, Paper 87-2348.
Wu, J. Z., Tramel, R. W., Zhu, F. L., and Yin, X. Y. (2000). A vorticity dynamics theory of three-dimensional 
flow separation. Phys. Fluids, 12, 1932-1954.
Wu, J. Z., Ma, H. Y., and Zhou, M. D. (2005). Vorticity and Vortex Dynamics. Springer, New York, NY.
Yagasaki, K. (2008). Invariant manifolds and control of hyperbolic trajectories on infinite- or finite-time 
intervals. Dyn. Sys., 23, 309-331.
Y 
amada, H., and Matsui, T. (1978). Preliminary study of mutual slip-through of a pair of vortices. Phys. 
Fluids, 21(2), 292-294.
Y 
ang, H., Weisberg, R. H., Niiler, P. P., Sturges, W., and Johnson, W. (1999). Lagrangian circulation and 
forbidden zone on the West Florida Shelf. Continental Shelf Research, 19, 1221-1245.
Y 
ang, K., Wu, S., Zhang, H., et al. (2021). Lagrangian-averaged vorticity deviation of spiraling blood flow 
in the heart during isovolumic contraction and ejection phases. Med. Biol. Eng. Comput. 59, 1417-1430.
Y 
ates, L. A., and Chapman, G. T. (1992). Streamlines, vorticity lines, and vortices around three-dimensional 
bodies. AIAA J., 30, 1819-1826.

References
405
Yuster, T., and Hackborn, W. W. (1997). On invariant manifolds attached to oscillating boundaries in Stokes 
flows. Chaos, 7(4), 769-776.
Zhang, W., Wolfe, C. L. P., and Abernathey, R. (2020). Role of surface-layer coherent eddies in potential 
vorticity transport in quasigeostrophic turbulence driven by eastward shear. Fluids, 5(1), 2.
Zhang, X., Hadwiger, M., Theussl, T., and Rautek, P. (2022). Interactive exploration of physically-observable 
objective vortices in unsteady 2D flow. IEEE Trans. Vis. Comp. Graph., 28(1), 281-290.
Zhang, Z., Wang, W., and Qiu, B. (2014). Oceanic mass transport by mesoscale eddies. Science, 345(6194), 
322-324.
Zhong, Y., Bracco, A., and Villareal, T. A. (2012). Pattern formation at the ocean surface: Sargassum 
distribution and the role of the eddy field. Limnol. Oceanog., 2(1), 12-27.
Zhou, J., Adrian, R. J., Balachandar, S., and Kendall, T. M. (1999). Mechanisms for generating coherent 
packets of hairpin vortices in channel flow. J. Fluid Mech., 387, 353-396.

Index
ABC flow,124
Abel’s theorem,29
absolute dispersion,72
active barrier, 331
active Cauchy-Green strain tensor, 349
active Eulerian fields, 14
active Eulerian vortex boundary, 342
active FTLE (aFTLE), 349
active Lagrangian vortex boundary, 342
active material barrier, 336
active Poincare map, 349
active polar rotation angle (aPRA), 352
active rotation tensor, 352
active tracers, 8
active trajectory rotation average (aTRA), 353
active trajectory stretching exponent (aTSE), 351
active transport, 8
active transport functional, 334
adiabatic frame change, 213
adiabatic quasi-objectivity, 213
adjoint equation of variations, 29
aerosols, 280
almost all (with respect to a measure), 43, 112
attracting iLCS, 292
attracting LCS, 148
Aubrey-Mather set, 108
auto-covariance function, 354
autonomous dynamical system, 20
averaged hyperbolicity strength, 214
averaged repulsion functional, 195
averaged rotation deviation, 216
averaged shear functional, 204
AVISO data set, 164, 188, 197, 217
barrier equation, 336
barrier time, 336
barrier vector field, 335
Basset-Boussinesq memory term, 276
Beltrami flow, 379
Beltrami property, 128
Bernoulli integral, 125
Bernoulli shift map, 105
Birkhoff’s ergodic theorem, 43
Birkhoff-Khinchin ergodic theorem, 43
black-hole vortex, 197
blow-up technique, 245
boundary of a manifold, 373
Brown-Samelson theorem, 116
bubbles, 280
burning fixed point, 138
burning invariant manifold (BIM), 138
burning periodic orbits, 138
burning speed in reacting flows, 136
cantorus, 108
chaotic advection, 100
chaotic map, 105
closed separation, 253
closest rigid-body velocity field, 68
codimension of a manifold, 372
codimension-1 manifolds, 2
coherence, 4, 101
coherence cluster, 10
coherent Lagrangian swirl, 172
coherent Lagrangian vortex, 166
coherent set, 9
convexity deficiency, 172
coordinate system on a manifold, 372
Cotter-Rivlin rate, 222
critical manifold, 278
deformation gradient, 22
deformation velocity field, 68
degenerate saddle point, 244
derivative of a map between manifolds, 373
diffeomorphism, 22
differentiable manifold, 372
diffusion barrier, 301
diffusion barrier sensitivity (DBS), 306
diffusion structure matrix, 325
diffusion-weighted Cauchy-Green strain tensor, 307
diffusive flux, 306, 388
diffusive flux barrier, 307
diffusive flux of a vector field, 334
diffusive flux vector, 389
diffusive flux-rate barrier, 307
diffusive transport, of a passive scalar, 302
diffusivity parameter, 325
direction field, 179
directional finite-time Lyapunov exponent, 370 
406

Index
407
directional Lyapunov exponent, 370
directionally steady velocity field, 29
divergence of a tensor, 325
dust devil, see landspout
dynamic rotation tensor, 54
dynamical inconsistency, of polar rotations, 53
dynamically active fields, 331
elliptic active barrier, 349
elliptic barrier, 107
elliptic domain, 223
elliptic fixed point, 34, 102
elliptic LCS, 148
elliptic stagnation point, 15
elliptic-hyperbolic-parabolic (EPH) partition, 223
equation of continuity, 27
equation of variations, 29
equivariance under a symmetry group, 131
ergodic map, 42
ergodic theory, 42
Euclidean transformation, 64
Euler equation, 19, 125
Euler equation, steady, 379
Euler’s theorem on positively homogeneous
functions, 378
Euler-Lagrange equations, 378
Eulerian active flow map, 349
Eulerian backbone of separation, 270
Eulerian description, 13
Eulerian direction field, 14
Eulerian quantities, 14
Eulerian scalar field, 14
Eulerian spiking point, 270
Eulerian tensor field, 14
Eulerian vector field, 14
exact coherent state, 10
experimental Poincare map, 133
extended phase space, 21
Fauxen correction, 276
finite-size Lyapunov exponent (FSLE), 160
finite-time Lyapunov exponent (FTLE), 107, 129, 
149
first integral, 114, 118
first-return map, 39
fixed separation, 243
flow attachment, 5
flow map, 21
flow separation, 4, 242
fluid trajectory, 19
Fokker-Planck equation, 325
frame-indifference, 60
free-slip boundary, 243
front compatibility condition, 138
FSLE, 160
FTLE, 149
backward, 149
forward, 149
smallest, 159
functional, 376
Galilean invariance, 71
Galilean transformations, 71
Gateaux derivative, 377
generalized moment of inertia tensor, 68
geodesic vortex detection, 197
geometric flux, 312
Global Drifter Program (GDP), 212
Green-Lagrange strain tensor, 48
Hamiltonian, 15
Hamiltonian system, 374
Hartman-Grobman theorem, 34
heavy particle, 170
height ridge, 145, 369
heteroclinic streamline, 16
Hill’s spherical vortex, 127
homoclinic streamline, 16
hyperbolic active barrier, 349
hyperbolic advective barrier, 103
hyperbolic domain, 223
hyperbolic fixed point, 34, 101
hyperbolic LCS, 148
hyperbolic OECS, 236
hyperbolic stagnation point, 15
hypersurface, 372
iLCS
attracting, 292
repelling, 292
incompressible flow, 15, 27
inertial equation, 279
inertial frame, 62
inertial LCS (iLCS), 275
infinitesimal generator of a group action, 131
infinitesimal-size Lyapunov exponent (ISLE), 161
instantaneous FTLE field, 228
instantaneous stagnation point, 15
instantaneous vorticity deviation (IVD), 229
integrable flow, 116
integrable system, 120, 126
interior of a manifold, 373
intrinsic dynamic rotation angle, 55, 169
invariant curve, 100
invariant domain, 21
invariant manifold, 26, 102
inviscid flow, 19
irrotational flow, 18
ISLE, 161
isoperimetric inequality, 208
Ito process, 324
Kolmogorov-Arnold-Moser (KAM) curve, 107
Lagrangian active flow map, 349
Lagrangian backbone of separation, 268

408
Index
Lagrangian coherent structure (LCS), 4, 101, 129, 
143
Lagrangian description, 13
Lagrangian direction field, 44
Lagrangian quantities, 44
Lagrangian scalar field, 44
Lagrangian tensor, 45, 302
Lagrangian vector field, 44
Lagrangian velocity, 30, 44
Lagrangian vortex boundary, 166
Lagrangian vortex center, 166
Lagrangian vorticity, 44
Lagrangian-averaged Q (laq), 291
Lagrangian-averaged vorticity deviation (LAVD),
129, 169
landspout, 275
LASER experiment, 298
LAVD, see Lagrangian-averaged vorticity deviation 
(LAVD)
LCS, 4, 101
left Cauchy-Green strain tensor, 46
left singular vectors, 49
left stretch tensor, 50, 54
Lie bracket, 131
light particle, 170
linearized Poincare map, 101
lobe, in homoclinic tangle, 105
local Lipschitz condition, 20
local variational theory, 177
lower Lyapunov exponent, 370
Lyapunov-regular point, 370
MZ -criterion for a material vortex, 224
machine learning drifter motion, 298
manifold, 372
manifold with boundary, 373
mass-preserving flow, 27
material derivative, 32
material line, 25
material set, 26
material surface, 23
Maxey-Riley equation, 276
mean rotation tensor, 54
mean-spin tensor, 53, 54
measure zero set, 38
measure-preserving mapping, 42
mesochronic analysis, 95
momentum transport barrier (MTB), 363
moving separation, 243, 268
neutrality measure, 206
neutrally buoyant particles, 278
no-slip boundary, 243
nonhyperbolic invariant manifolds, 6
nonlinear eddy criterion, 78
nonlinear observer change, 87
nonsingular level set of a function, 115
normal infinitesimal Lyapunov exponent (NILE),
283
normal space of a manifold, 23, 373
normally hyperbolic invariant manifold, 279
normalspace, 373
null-geodesic, 197
null-surface, 305
objective Eulerian coherent structure (OECS), 4,
144, 227
objective saddle point, 237
objective scalar field, Eulerian, 65
objective scalar field, Lagrangian, 72
objective tensor field, Eulerian, 69
objective tensor field, Lagrangian, 73
objective tensor field, two-point, 74
objective vector field, Eulerian, 66
objective vector field, Lagrangian, 73
objectivity, 58, 60
observable, 43
observed tracer-transport barrier, 144, 148
observer-compatibility conditions, 88
OECS, 144, 227
attracting, 236
hyperbolic, 236
parabolic, 236
repelling, 236
off-wall separation, 268
Okubo-Weiss criterion, 82
one-sided transport barrier, 138
open separation, 253
orbit of a Poincare map, 35
parabolic barrier, 110
parabolic domain, 223
parabolic fixed point, 102
parabolic LCS, 149
parabolic stagnation point, 15
parametrization of a manifold, 372
partial barrier to transport, 100, 109
passive Eulerian field, 14
pathline, 20
perfect shearless LCS, 204
Poincare map, 35, 39
Poincare section, 39
Poincare’s recurrence theorem, 40
pointwise uniformly stretching material surface,
208
polar decomposition, 50
polar rotation angle (PRA), 51, 165
positively homogeneous function, 378
probability density function (PDF), 325
pullback, 44
pullback vorticity, 44
pushforward, 45

Index
409
Q-criterion,79
Q-parameter,77
quasi-objectivity,77
rate-of-strain eigenbasis,70
rate-of-strain tensor, 14, 70
rationally independent frequencies, 36
reduced shearline, 191
reduced strainline, 184
relative dispersion, 72
relative rotation tensor, 54
relative spin tensor, 70
relative velocity gradient tensor, 86
repelling iLCS, 292
repelling LCS, 148
repulsion factor, 177
resonant island, 108
ridge, 145, 176, 247
ridge thresholding, 156
right Cauchy-Green strain tensor, 45
right dynamic stretch tensor, 54
right singular vectors, 49
right stretch tensor, 50
robust ridge, 369
rotation number, 164
rotation tensor, 50
rotation vector, 384
rotational coherence, 164
scaled Lagrangian velocity, 29
search and rescue (SAR) operations, 238
sectional streamline, 124
separation line, 253
separation profile, 242
separatrix, 16, 93
shear factor, 177
shear LCS, 148
shearline, 187
shrinklines, 179
similar matrices, 69
singular values, 49
skin friction field, 253
skin friction line, 253
sliding-window FTLE, 152
slow manifold, 279
slow time, 278
smallest finite-time Lyapunov exponent,
159
solenoidal vector field, 15
source inversion, 285
spectrum, 46
spiking point, 247, 268
spin tensor, 14, 69
stable manifold, 102
stable subspace, 102
standard non-twist map, 205, 208
stationary curve of a functional, 377
stationary surface of a functional, 193
steady Euler equation, 125
steady velocity field, 14
stochastic transport, 8
stochastic transport tensor, 326
strain acceleration tensor, 222
strain-rotation-rate tensor, 70
strange eigenmode, 105
streakline, 25
stream function, 15
streamline, 15
streamsurface, 17
stretchlines, 179
strong Beltrami flow, 129
strong Beltrami property, 345
strong KAM stability, 110
structural stability, 16
structurally stable set, 28
structurally stable vector field, 28
submanifold, 372
suspension, 280
symplectic map, 40, 388
symplectomorphism, 388
tangent space of a manifold, 23, 373
tangent vector of a manifold, 373
tensorline, 179, 187
tensorline singularity, 179, 205
timeline, 25
topological equivalence, 28
topologically conjugate mappings, 35
torus, multidimensional, 36
trajectory rotation average (TRA), 216
trajectory stretching exponent (TSE), 214
transfer operator, 10
transient attracting profile (TRAP), 238
transient chaos, 105
transport barrier, 1, 100
transport barrier in 2D maps, 100
transport barrier in 3D flows, 121
transport barrier in chaotic advection, 100
transport functional, 304
transport tensor, 303, 322
transport tubes, 331
transport vector field, 312
TRAP, 238
trench, 93, 159
trisector singularity, 187
turbulent/non-turbulent interface (TNT), 331
turnstile, 105
twist map, 107
two-point tensor, 22, 45, 74
unconstrained diffusion barrier, 303
uniform momentum zone (UMZ), 331

410
uniformity of compressible barriers,323
unstable manifold, 103
unstable subspace, 101
unsteady velocity field, 14
upper Lyapunov exponent, 370
velocity gradient tensor, 14, 69
velocity potential, 18
vortex lines, 126
vorticity, 14
Index
vorticity transport equation, 32, 33
vorticity, 2D, 67
wall-based separation, 248
watershed ridge, 369
weak minimizer of the neutrality measure, 206
wedge singularity, 187
Wiener process, 325
zero strain set, 220

