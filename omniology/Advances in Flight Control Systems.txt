www.ebook3000.com

ADVANCES IN 
FLIGHT CONTROL SYSTEMS
Edited by Agneta Balint

Advances in Flight Control Systems
Edited by Agneta Balint
Copyright © 2017 second Edition
All chapters are Open Access articles distributed under the Creative Commons 
Non Commercial Share Alike Attribution 3.0 license, which permits to copy, 
distribute, transmit, and adapt the work in any medium, so long as the original 
work is properly cited. After this work has been published  authors 
have the right to republish it, in whole or part, in any publication of which they 
are the author, and to make other personal use of the work. Any republication, 
referencing or personal use of the work must explicitly identify the original source.
Statements and opinions expressed in the chapters are these of the individual 
contributors and not necessarily those of the editors or publisher. No responsibility is 
accepted 
for the accuracy of information contained in the published articles. The publisher 
assumes no responsibility for any damage or injury to persons or property arising out 
of the use of any materials, instructions, methods or ideas contained in the book.
First published March, 2011 second - 2017
Printed in India
ISBN-10: 953-307-218-0
ISBN-13: 978-953-307-218-0
www.ebook3000.com


Chapter 1
Chapter 2
Chapter 3
Chapter 4
Chapter 5
Chapter 6
Chapter 7
Chapter 8
Preface IX
Adaptive Fight Control Actuators 
and Mechanisms for Missiles, Munitions 
and Uninhabited Aerial Vehicles (UAVs) 1
Ronald Barrett
Adaptive Backstepping Flight Control 
for Modern Fighter Aircraft 23
L. Sonneveldt, Q.P. Chu and J.A. Mulder
Hybrid Adaptive Flight Control 
with Model Inversion Adaptation 53
Nhan Nguyen
Application of Evolutionary Computing 
in Control Allocation 77
Hammad Ahmad, Trevor Young, Daniel Toal and Edin Omerdic
Fault Tolerant Flight Control, 
a Physical Model Approach 93
Thomas Lombaerts, Ping Chu,
Jan Albert (Bob) Mulder and Olaf Stroosma
Design of Intelligent Fault-Tolerant Flight 
Control System for Unmanned Aerial Vehicles 117
Yuta Kobayashi and Masaki Takahashi
Active Fault Diagnosis and Major Actuator 
Failure Accommodation: Application to a UAV 137
François Bateman, Hassan Noura and Mustapha Ouladsine
Fault-Tolerance of a Transport Aircraft 
with Adaptive Control 
and Optimal Command Allocation 159
Federico Corraro, Gianfranco Morani and Adolfo Sollazzo
Contents
www.ebook3000.com

Contents
VI
Acceleration-based 3D Flight Control for UAVs: 
Strategy and Longitudinal Design 173
Iain K. Peddle and Thomas Jones
Autonomous Flight Control System 
for Longitudinal Motion of a Helicopter 197
Atsushi Fujimori
Autonomous Flight Control 
for RC Helicopter Using a Wireless Camera 217
Yue Bao, Syuhei Saito and Yutaro Koya
Hierarchical Control Design of a UAV Helicopter 239
Ali Karimoddini, Guowei Cai, Ben M. Chen, Hai Lin and Tong H. Lee
Comparison of Flight Control System 
Design Methods in Landing 261
S.H. Sadati, M.Sabzeh Parvar and M.B. Menhaj
Oscillation Susceptibility of an Unmanned Aircraft 
whose Automatic Flight Control System Fails 275
Balint Maria-Agneta and Balint Stefan
Chapter 9
Chapter 10
Chapter 11
Chapter 12
Chapter 13
Chapter 14

www.ebook3000.com

Preface
Nonlinear problems in ﬂ ight control have stimulated cooperation among engineers 
and scientists from a range of disciplines. Developments in computer technology al-
lowed for numerical solutions of nonlinear control problems, while industrial recogni-
tion and applications of nonlinear mathematical models in solving technological prob-
lems is increasing. 
The aim of the book Advances in Flight Control is to bring together reputable research-
ers from diﬀ erent countries in order to provide a comprehensive coverage of advanced 
and modern topics in ﬂ ight control not yet reﬂ ected by other books. This product com-
prises 14 contributions submitt ed by 38 authors from 11 diﬀ erent countries and ar-
eas. It covers most of the currents main streams of ﬂ ight control researches, ranging 
from adaptive ﬂ ight control mechanism, fault tolerant ﬂ ight control, acceleration based 
ﬂ ight control, helicopter ﬂ ight control, comparison of ﬂ ight control systems and funda-
mentals. According to these themes the 14 contributions are grouped in six categories, 
corresponding to six parts of the book.
The ﬁ rst part of the book is a collection of four chapters (1, 2, 3, 4) dedicated to the adap-
tive ﬂ ight control.
In Chapter 1 the purpose is to introduce the technical community to some of the adap-
tive ﬂ ight control mechanisms and structures which have either lead directly to or ac-
tually ﬂ own in various classes of missiles, munitions and unhabited aircraft . Although 
many programs are not open for publication, glimpses of a select ﬂ ow have made it to 
the public arena at various level. This chapter is centered on airing several supersys-
tem-level advances to ﬂ ight-proven missiles, munitions and UAVs. Toward that end, 
basic models were used to lay out proof-of-concept ﬂ ight hardware which was then 
fabricated, bench and/or ground tested and incorporated in ﬂ ight vehicles. In the early 
years the adaptive aircraft  were oft en simply ﬂ own, just to prove the concept worked. 
More recently, aircraft  using adaptive ﬂ ight control mechanisms have been ﬂ own oﬀ  
against conventional benchmark aircraft  so as to demonstrate systematic superiority, 
thereby proving that ﬂ ight control systems employing adaptive aerostructures result 
in some combination of lower power consumption, higher bandwidth, reduction in 
total aircraft  empty weight, greater ﬂ ight-speed, shock resistance, lower part count, 
lower cost etc. On normal occasions, adaptive aerostructures have ever been shown to 
be “enabling” that is, the aircraft  class would not be able to ﬂ y without them. 
In Chapter 2  an integrated, though cascaded Lyapunov-based adaptive backstepping 
approach is taken and used to design a ﬂ ight path controller for nonlinear high-ﬁ delity 

X
Preface
F-16 model. Adaptive backstepping allows assuming that the aerodynamic force and 
moment models may not be known exactly, and even that they may change in ﬂ ight 
due to causes as structural damage and control actuator failness. To simplify the math-
ematical approximation partition the ﬂ ight envelope into multiple connecting operat-
ing regions, called hyperboxes, is proposed. In each hyperbox  a locally valid linear-
in-parameters nonlinear model is deﬁ ned. The coeﬃ  cients of these local models can be 
estimated using the update laws of the adaptive backstepping control laws. The num-
ber and  size of the hyperboxes should be based on a priori information on the physical 
properties of the vehicle on hand, and may be deﬁ ned in terms of state variables as 
Mach number, angle of att ack and engine thrust. To interpolate between the local mod-
els to ensure smooth model transitions B-spline neural networks are used. Numerical 
simulations of various maneuvers with aerodynamic uncertainties in the model and 
actuator failures are presented. The maneuvers are performed at several ﬂ ight condi-
tions to demonstrate that the control laws are valid for the entire ﬂ ight envelope.
In Chapter 3 a hybrid adaptive ﬂ ight control method as another possibility to reduce 
the eﬀ ect of high-gain control, is investigated. The hybrid adaptive control blends both 
direct and indirect adaptive control in a model inversion ﬂ ight control architecture. The 
blending of both direct and indirect adaptive control is sometimes known as composite 
adaptation. The indirect adaptive control is used to update the model inversion con-
troller by two parameter estimation techniques: 1) an indirect adaptive law based on 
the Lyapunov theory and 2) a recursive least-squares indirect adaptive law. The model 
inversion controller generates a command signal using estimates of the unknown plant 
dynamics to reduce the model inversion error. This directly leads to a reduced tracking 
error. Because the direct adaptive control only needs to adapt to a residual uncertainity, 
its adaptive gain can be reduced in order to improve stability robustness. Simulations 
of the hybrid adaptive control for a damaged generic transport aircraft  and a pilot-in-
loop ﬂ ight simulator study show that the proposed method is quite eﬀ ective in provid-
ing improved command tracking performance for a ﬂ ight control system.
In Chapter 4 the purpose is to design a compensator using an evolutionary computing 
technique (i.e. generic algorithms) to compensate the interaction between control al-
location and actuator dynamics.
The interaction of ﬁ rst order actuator dynamics and control allocation and the struc-
ture of the compensator is established for ﬁ rst order and second order actuator dynam-
ics. The tuning of the compensator parameters using generic algorithm is described. 
Simulation and results for tuned compensator are shown for a range of ﬁ rst and second 
order actuator dynamics. At the end conclusions are established.
The second part of this book consists on four chapters (5, 6, 7, 8) dedicated to the fault 
tolerant ﬂ ight control.
In Chapter 5 a physical modular approach, where focus is placed on the use of math-
ematical representation based on ﬂ ight dynamics., is used. All variables and quanti-
ties which appear in the model have a physical meaning and thus are interpretable 
in this approach, and on avoids so called black and grey box models, where the con-
tent has no clear physical meaning. Besides the fact that this is a more transparent 
approach, allowing the designers and engineers to interpret data of each step, it is 
assumed that these physical models will facilitate certiﬁ cation for eventual future real 
www.ebook3000.com

XI
Preface
life applications, since monitoring of data is more meaningfull. Adaptive nonlinear dy-
namic inversion is selected as the preferred adaptive control method in this modular or 
indirect approach. The advantage of dynamic inversion is the absence of any need for 
gain scheduling and an input-output decoupling of all control channels. Adaptation 
of the controller is achieved by providing up-to-date aerodynamic model information 
which is collected in a separate identiﬁ cation module. 
In Chapter 6 an intelligent ﬂ ight control system is presented that can discriminate be-
tween faults and natural disturbances in order to evaluate and deal with the situation. 
In the control system, an evaluator of ﬂ ight conditions is designed on the basis of the 
dynamics of a controlled object. Moreover, to deal with the situation adaptively, a new 
ﬂ ight-path-planning generator is introduced on the basis of the evaluation. In the study 
each system is designed by neural network. The learning based systematical design 
method is developed that uses evaluation functions for the subsystems. A six-degree-
of-freedom nonlinear simulation is carried out.
In Chapter 7 a nonlinear UAV model, which allows simulating asymmetrical control 
surface failures is presented. In fault-free mode, a nominal control law based on an 
Eigenstructure assignment strategy is designed. As the control surface positions are 
not measured, a diagnosis system is performed with a bank of observers able to esti-
mate the unknown inputs. However, as the two ailerons oﬀ er redundant eﬀ ects, isolat-
ing a fault on these actuators requires an active diagnosis method. In the last part, a 
pre-computed F.T.C. strategy, dedicated to accommodate for a ruddervator failure, is 
depicted.  
In Chapter 8 a scheme of a fault-tolerant ﬂ ight control system is proposed. It is com-
posed by the core control laws, based on the DAMF technique, to achieve both robust-
ness and reconﬁ guration capabilities and the CA system, based on the active set meth-
od, to properly allocate the control eﬀ ort on the healthy actuators. Numerical results of 
a case study with a detailed model of a large transport aircraft  are reported to show the 
eﬀ ectiveness of the proposed fault-tolerant control scheme.
The third part of this book consists on one chapter (9) dedicated to the acceleration 
based ﬂ ight control.
In Chapter 9 the manoeuvre autopilot solution presented moves away from the more 
mainstream methods, recently reported in the literature and instead returns to the con-
cept of acceleration control which has been commonly used in missile applications, and 
to a limited extent in aircraft  applications, for a number of decades. However, whereas 
acceleration control has traditionally been used within the framework of linearized 
ﬂ ight control (the aircraft  or missile dynamics are linearized, typically about a straight 
and level ﬂ ight condition), the algorithms and mathematics presented in this chapter 
extend the fundamental acceleration controller for operate equally eﬀ ectively over the 
entire 3D ﬂ ight envelope. The result of this extension is that the aircraft  then reduces to 
a point mass with a steerable acceleration vector from a 3D guidance perspective. This 
abstraction which is now valid over the entire ﬂ ight envelope is the key to signiﬁ cantly 
reducing the complexity involved in solving the manoeuvre ﬂ ight control problem.  
The fourth part of this book consists on three chapters (10, 11, 12) dedicated to helicop-
ter ﬂ ight control.

XII
Preface
In chapter 10 a ﬂ ight control design for the longitudinal motion of helicopter is pre-
sented. The ﬂ ight mission considered here is that a helicopter hovers at a start position, 
moves to goal position with keeping a speciﬁ ed cruise velocity and hovers again at the 
goal. The characteristics of the linearized equation of the helicopter are changed dur-
ing this ﬂ ight mission because the trim values of the equation are widely varied. Gain 
scheduling is one of candidates to stabilize the vehicle for the entire ﬂ ight region. The 
ﬂ ight control system is constructed as a double loop control system, which consists of 
an inner-loop controller and outer-loop controller. The former is needed for stabilizing 
the controlled plant, while the latt er is used for tracking the reference which is given 
to accomplish the ﬂ ight mission. To design the inner-loop controller, the longitudinal 
motion of a helicopter is modelled by a linear interpolative polytopic model whose 
varying parameter is the ﬂ ight velocity. The outer-loop controller is designed by taking 
into consideration the steady-state of the controlled variable. 
In chapter 11 an autonomous ﬂ ight of a RC helicopter with small-wireless camera and 
a simple artiﬁ cial marker which is set on the ground is analyzed. It is thought that a 
more wide-ranging ﬂ ight is possible if the natural feature points are detected from the 
image obtained by the camera on RC.
In chapter 12 an analytical approach to design and analyze the whole system including 
the inner-loop and outer-loop controllers for a small-scale UAV helicopter is presented. 
Here, in the proposed hierarchical structure, the inner-loop is responsible for the in-
ternal stabilization of the UAV in the hovering state and control of the linear velocities 
and heading angle angular velocity whereas the outer-loop is used to drive the system, 
which is already stabilized by the inner-loop, to follow a desired path while keeping 
the system close to the hovering state. This strategy is an intuitive way of controlling 
such a complex system. Another reason that compels to employ such a control system 
is that the UAV model cannot be fully linearized. In practice, the heading angle of 
the UAV cannot be restricted to a small range of variation, it depends on the mission 
and could be in any direction. This imposes nonlinearity, which can be modelled by a 
transformation. To handle this semi-linearized model, the linear and nonlinear parts 
are separated, and then the linear part is controlled by the inner-loop and the nonlinear 
part by the outer-loop. 
The ﬁ ft h part of this book consists on one chapter (13) dedicated to the comparison of 
ﬂ ight control systems.
In chapter 13 an overview concerning conventional, fuzzy logic-based, neural net-
based adaptive control techniques is provided to the reader. Practical control schemes 
applicable in the area of control system design are introduced. The control laws are 
demonstrated on a three-degree-of-freedom simulation with linearized aerodynamic 
and engine models. The chapter is focused on aircraft  landing manoeuvres. This part 
of ﬂ ight needs to be strongly assisted by human pilot.
The sixths part of this book consists on one chapter (14) dedicated to the oscillation 
susceptibility when the control system fails.
In chapter 14 the oscillation susceptibility of an unmanned aircraft  whose automatic 
ﬂ ight control system fails, is analysed. The analysis is focused on the research of os-
cillatory movement around the centre of mass in a longitudinal ﬂ ight with constant 
www.ebook3000.com

XIII
Preface
forward velocity (mainly in the ﬁ nal approach and landing phase). The analysis is 
made in a mathematical model deﬁ ned by a system of three nonlinear ordinary dif-
ferential equations, which govern the aircraft  movement around its centre of mass, in 
such a ﬂ ight. This model is deduced from a set of nine nonlinear diﬀ erential equations, 
governing the movement of the aircraft  around its centre of mass. It is shown that in 
a longitudinal ﬂ ight with constant forward velocity, if the elevator deﬂ ection outruns 
some limits, oscillatory movement appears. This is proved by means of coincidence 
degree theory and Mawhin’s continuation theorem. Numerical results concern an Aero 
Data Model in Research Environment and consist in: identiﬁ cation of the range of the 
elevator deﬂ ection for  which steady state exists; computation of the manifold of steady 
states; identiﬁ cation of stable and unstable steady states; simulation of successful and 
unsuccessful manoeuvres; simulation of oscillatory movements.     
I would like to express my sincere gratitude to all chapter authors for the time and ef-
fort they generously gave to the book. I would like to thank the publisher, InTech Edu-
cation and Publishing, for cooperation in publication. Special thanks go to Ms. Ivana 
Lorkovic, process manager, who initiated this project.
February 26, 2011.
Agneta M. Balint
West University of Timisoara
                                                                                                                  Faculty of Physics
Timisoara, 300223, 
Romania

www.ebook3000.com

1 
Adaptive Fight Control Actuators and 
Mechanisms for Missiles, Munitions and 
Uninhabited Aerial Vehicles (UAVs) 
Ronald Barrett 
The University of Kansas, Lawrence, Kansas  
USA 
1. Introduction 
The purpose of this chapter is to introduce the technical community to some of the adaptive 
flight control mechanisims and structures which have either lead directly to or actually 
flown in various classes of missiles, munitions and uninhabited aircraft. Although many 
programs are not open for publication, glimpses of a select few have made it to the public 
arena at various levels.   
This chapter is centered on airing several supersystem-level advances to flight-proven 
missiles, munitions and UAVs. Toward that end, basic models were typically used to lay out 
proof-of-concept flight hardware which was then fabricated, bench and/or ground tested, 
and incorporated in flight vehicles. In the early years, the adaptive aircraft were often 
simply flown, just to prove the concept worked. More recently, aircraft using adaptive 
flight control mechanisms have been flown off against conventional benchmark aircraft so 
as to demonstrate systemic superiority, thereby proving that flight control systems 
employing adaptive aerostructures result in some combination of lower power 
consumption, higher bandwidth, reduction in total aircraft empty weight, greater flight 
speed, shock resistance, lower part count, lower cost etc. On several occasions, adaptive 
aerostructures have even been shown to be "enabling;" that is, the aircraft class would not 
be able to fly without them.  
Although adaptive materials have been known for more than 120 years, the Aerospace 
industry has only more recently become aware of their basic characteristics. Starting in the 
mid 1980's Ed Crawley's group at MIT laid the foundations of what would become an 
active and vibrant branch of aerospace technology. With simple experiments on bending 
and extension-twist coupled plates, this group demonstrated that airloads on 
aerodynamic surfaces could be actively manipulated by using conventionally attached 
piezoelectric actuators.1-3 Although the structures resulting from these projects were not 
incorporated in flightworthy aircraft, their significance cannot be overstated as they 
introduced the technical community to the possibility of aircraft flight control with 
adaptive aerostructures and by doing so effectively started the entire field. Table 1 
summarizes a collection of programs which have lead directly to a series of flight proven 
adaptive subscale aerospace systems.  

 
Advances in Flight Control Systems 
 
2 
 
Project   p=piezoelectric, s=shape memory alloy 
 
Agency/ 
 c=component testing only   f=flight tested 
 
Sponsor 
 v=entire vehicle configuration tested with adaptive device 
 
 
1 Bending-Twist Coupled Aeroelastic PZT Plate (1985-87) 
c,p 
MIT 
2 Adaptive Flap (1987-89) 
c,p 
MIT 
3 Twist-Active Subsonic DAP Missile Wing (1989-90) 
c,p 
ARO 
4 Twist-Active DAP Rotor (1990-91) 
c,p 
ARO 
5 Aeroservoelastic Twist-Active Wing (1990-92) 
c,p 
Purdue 
6 Twist-Active Supersonic DAP Wing (1991-92) 
c,p 
KU 
7 Constrained Spar Torque-Plate Missile Fin (1991-92) 
c,p 
KU 
8 Free-Spar DAP Torque-Plate Fin (1992-93) 
c,p 
KU 
9 Pitch-Active DAP Torque-Plate Rotor (1992-93) 
c,p 
KU 
10 Subsonic Twist-Active DAP Wing (1993-94) 
c,p 
WL/MNAV 
11 Subsonic Twist-Active SMA Wing (1993-94) 
c,s 
WL/MNAV 
12 Subsonic Camber-Active DAP Wing (1993-94) 
c,p 
WL/MNAV 
13 Subsonic Camber-Active SMA Wing (1993-94) 
c,s 
WL/MNAV 
14 Supersonic Twist-Active DAP Wing (1993-94) 
c,p 
WL/MNAV 
15 Supersonic Twist-Active SMA Wing (1993-94) 
c,s 
WL/MNAV 
16 Supersonic Camber-Active DAP Wing (1993-94) 
c,p 
WL/MNAV 
17 Supersonic Camber-Active SMA Wing (1993-94) 
c,s 
WL/MNAV 
18 UAV with Flexspar Stabilator (Mothra 1993-94) 
v,f,p
AAL 
19 Flexspar TOW-2B Wing (1993-94) 
v,p 
NSF 
20 Solid State Adaptive Rotor (SSAR) (1994-95) 
c,p 
NSF 
21 Aeroservoelastic Flexspar Fin (1994-95) 
c,p 
AAL 
22 UAV with Solid State Adaptive Servopaddle Rotor (95-96) 
v,f,p
NSF 
23 MAV with Flexspar Stabilator (1994-97) 
v,f,p
DoD CDTO 
24 Barrel-Launched Adaptive Munition (1995-97) 
v,p 
AFOSR 
25 Smart Compressed Reversed Adaptive Munition  (1995-97) 
v,p 
WL/MNAV 
26 Rotationally Active Linear Actuator (RALA 1995-97) 
c,p 
WL/Boeing 
27 Pitch-Active Torque-Plate Wing (1997-98) 
c,p 
AAL 
28 Range-Extended Adaptive Munition  (1998-99) 
v,p 
DARPA 
29 Hypersonic Interceptor Test Technology (1998-2000) 
v,p 
SMDC/Schafer 
30 Coleopter MAV with Flexspar Stabilators (1998-2001) 
v,f,p
DARPA 
31 UAVs with Pitch-Active SMA Wings (2000-01) 
v,f,s
AAL 
32 Light Fighter Lethality MicroFlex Actuator (2000-01) 
v,p 
TACOMARDEC 
33 Pitch-Active Curvilinear Fin Actuator (2001-02) 
c,s 
AMCOM 
34 SC Range-Ex Adaptive Munition (SCREAM) (2000-03) 
v,p 
TACOM ARDEC 
35 Thunder Multilaminate RALA Fin (2000-03) 
c,p 
AFRL/MNAV 
36 Centerline Precompression RALA Fin (2000-03) 
c,p 
AFRL/MNAV 
37 Center Pivot Flexspar Fin (2002-03) 
c,p 
ARL 
38 PBP StAB (2003-) 
v,f,p
TU Delft/TNO 
39 Convertible UAV with PBP Grid Fin (2003-) 
v,f,p
TU Delft/KU 
40 Convertible UAV with PBP Turning Vane Flaps(2003-) 
v,f,p
TU Delft/KU 
41 Extended-Range Adaptive Gravity Weapons (2003-) 
v,f,p
AFRL/Boeing 
42 PBP Supersonic  NAV (2004-) 
v,f,p
Lutronix 
43 PBP Morphing Wing UAV (2005-) 
v,f,p
TU Delft/KU 
 
Table 1. Summary of Adaptive Aerostructures Projects with Direct Connections to 
Flightworthy Adaptive Uninhabited Aerial Vehicles 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
3 
 
Fig. 1.1 Historical Overview of Adaptive Aerostructures Projects with Direct Connection to 
UAV Flight 

 
Advances in Flight Control Systems 
 
4 
2. Missile, munition and supersonic Uninhabited Aerial Vehicle (UAV) flight 
control 
In the late 1980's, up through 1990, a series of flight control mechanisms were being 
explored which could drive flaps with piezoelectric bender elements.4 Although these flight 
control devices were tested on a small scale, the goal of the investigators was to eventually 
transition these devices to full-scale, inhabited aircraft.  
In 1990, a paradigm shift took was triggered which lead one branch of adaptive 
aerostructures technology down a large scale/inhabited aircraft path, the other to 
uninhabited aircraft. The driving philosophy behind the split was simple: 
 
• 
Aircraft will benefit the most from this line of technology when adaptive materials can be 
integrated into aircraft primary structure.  
• 
Because there is no current or planned FAA/MilHandbook5 database for materials certification, 
these materials -by law- will not be allowed in primary structure of FAR 23/25, 27/29  
certified aircraft and will not allowed in the primary structure of most inhabited military aircraft 
because structural designers have no A- or B-basis mechanical properties to lay out designs 
 with.  
 
Because this philosophy split occured so long ago, the uninhabited branch of technology has 
had ample time to mature and be demonstrated in flight, thankfully, without the myriad of 
restrictions which begjile their inhabited counterparts. Among the uninhabited aircraft 
which were and still are being robustly pursued in this obscure corner of the adaptive 
aerostructures world are missiles, munitions and UAVs of many sizes. Because funding for 
military research was comparatively easier to obtain, some of the first applications 
development efforts were centered on missile and fin research. These eventually matured 
into system-level designs, bench test and eventually flight tests.  
2.1 Early fin and wing designs 
In 1990, an important advance in piezoelectric actuation was made.5-8 The invention of 
Directionally Attached Piezoelectric (DAP) actuators allowed otherwise isotropic 
piezoelectric elements to behave as if they were highly orthotropic. This was achieved by 
attaching piezoelectric elements along a longitudinal axis, leaving the sides free to expand 
or contract and thereby effectively nulling the lateral stiffness of the element while 
maintaining the longitudinal stiffness. This property was especially important as it allowed 
direct active manipulation of structures in twist, rather than just bending. Eventually, DAP 
actuators were developed with Orthotropy Ratios, OR in excess of 100 which makes them to 
this day one of the preferred actuator classes for twist activation, especially when cost, 
robustness and ease of manufacturing are considered. This high OR allowed both coupled 
and uncoupled structures to be directly manupulated in twist for the first time. If one 
considers an active laminate with an isotropic active material bonded to an uncoupled 
substrate, one can see clearly from laminated plate theory that the shear and twist activation 
terms are zero for CAP elements and non-zero for DAP elements:  
 
 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
5 
Conventionally Attached Piezoelectric Actuators:  
 
N
M
⎧ ⎨ ⎩ 
⎫ ⎬ ⎭ CAP
=
A11
A12
0
B11
B12
0
A12
A11
0
B12
B11
0
0
0
2A66
0
0
2B66
B11
B12
0
D11
D12
0
B12
B11
0
D12
D11
0
0
0
2B66
0
0
2D66
⎡ 
⎣ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎤ 
⎦ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
CAP
Λ
Λ
0
0
0
0
⎧ 
⎨ 
⎪ 
⎪ 
⎪ 
⎩ 
⎪ 
⎪ 
⎪ 
⎫ 
⎬ 
⎪ 
⎪ 
⎪ 
⎭ 
⎪ 
⎪ 
⎪ 
=
A11 + A12
(
)Λ
A11 + A12
(
)Λ
0
B11 + B12
(
)Λ
B11 + B12
(
)Λ
0
⎧ 
⎨ 
⎪ 
⎪ 
⎪ 
⎩ 
⎪ 
⎪ 
⎪ 
⎫ 
⎬ 
⎪ 
⎪ 
⎪ 
⎭ 
⎪ 
⎪ 
⎪ 
CAP   
(1)
 
Directionally Attached Piezoelectric Actuators:  
 
N
M
⎧ ⎨ ⎩ 
⎫ ⎬ ⎭ DAP
=
A11
A12
2A16
B11
B12
2B16
A12
A22
2A26
B12
B22
2B26
A16
A26
2A66
B16
B26
2B66
B11
B12
2B16
D11
D12
2D16
B12
B22
2B26
D12
D22
2D26
B16
B26
2B66
D16
D26
2D66
⎡ 
⎣ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎢ 
⎤ 
⎦ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
⎥ 
DAP
Λ
Λ
0
0
0
0
⎧ 
⎨ 
⎪ 
⎪ 
⎪ 
⎩ 
⎪ 
⎪ 
⎪ 
⎫ 
⎬ 
⎪ 
⎪ 
⎪ 
⎭ 
⎪ 
⎪ 
⎪ 
=
A11 + A12
(
)Λ
A22 + A12
(
)Λ
A16 + A26
(
)Λ
B11 + B12
(
)Λ
B22 + B12
(
)Λ
B16 + B26
(
)Λ
⎧ 
⎨ 
⎪ 
⎪ 
⎪ 
⎩ 
⎪ 
⎪ 
⎪ 
⎫ 
⎬ 
⎪ 
⎪ 
⎪ 
⎭ 
⎪ 
⎪ 
⎪ 
DAP   
(2)
                 
In the late 1980's it was not readily apparent which among the many approaches to adaptive 
flight control would actually work in a real flight environment. Several important papers 
relating aeroelastic tailoring, geometric sweep and aeroelastic coupling were authored, 
comparing CAP and DAP elements.9-11 These papers showed that with aeroelastic coupling, 
small deflections could be aeroelastically magnified to control authority levels which were 
consistent with aircraft flight control.  
Although DAP elements were first integrated into a subscale missile wing in 1989, a new 
design incorporating DAP elements on a torque plate was conceived and reduced to practice 
in 1990.6-8 This approach allowed large rotations of an aerodynamic shell while the loads 
were taken up by a high strength internal structure. Figure 2 shows the Constrained Spar 
DAP Torque-Plate Missile Fin. Because the fin was intended for use in a TOW missile, it was 
capable of ±5° deflections with a corner frequency better than 30Hz and a maximum power 
consumption under 50mW.12-14 During the this program, an important design philosophy 
was evolved that is still seen as critical advice for adaptive aerostructures designers to this 
day:  
i. 
Minimize the amount of work done by adaptive materials on passive structure 
ii. 
Employ aerodynamic and mass balancing principles so that the adaptive structures 
resist only transient external airloads and inertial loads.  
iii. Use coefficient of thermal expansion mismatch to precompress piezoelectric actuator 
elements.  
The US Air Force was generous in its support of this area after the concept was initially 
proven on the bench and the wind tunnel. The first study examining piezoelectric flight 
control for Air Force missiles was centered on low aspect ratio fin and wing manipulation. 
In 1993, Wright Laboratory commissioned a study examining DAP and CAP-activated 
surfaces. This was one of the first times that finite element methods were used to capture the 
behavior of subsonic and supersonic active lifting surfaces. figure 3 shows a FEM model of a 
supersonic double-circular arc camber-active DAP fin and NACA 0012 subsonic twist-active 
DAP fin.15  

 
Advances in Flight Control Systems 
 
6 
 
Fig. 2. Constrained Spar DAP Torque-Plate Missile Fin13 
  
 
Fig. 3. Finitel Element Models of Active Supersonic & Subsonic Fins15 
Although the technology worked, at the time it did not work well enough as the levels of 
manipulation of low aspect ratio aerodynamic surfaces being actuated in twist and camber 
was simply far too low. Still, for higher aspect ratios, the design was shown not only to 
work, but work well. However, because most missiles employ low aspect ratio aerodynamic 
surfaces, a new approach was needed.    
2.2 Flexspar: The first flight enabling adaptive system 
In an effort to dramatically increase control surface deflections of low aspect ratio fins and in 
keeping with principles i. and ii above, a new flight control device was invented and reduced 
to practice. This flight control system would be shown to be one of the most useful and widely 
used in aircraft employing adaptive materials for flight control. Figure 4 shows the general 
layout of the device which was designed around a symmetric, balanced airfoil shell.  
 
 
 
Fig. 4. Flexspar Fin Anatomy 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
7 
 
Fig. 5. Tip-Joint Flexspar Fin Geometric Parameters 
If one examinies the basic construction of a piezoelectric bender element, then a simple 
expression can be laid out which relates laminate curvature, k to cure parameters, material 
characteristics and active free strain levels of the actuator, L. As has been shown over the 
past 20 years, it is important to use thermally induced precompression in all flightworthy 
adaptive aerostructures as shown in Equation 3. Equation 4 is the solution of the bending 
curvature considering a symmetric, balanced laminate composed of two sheets of CAP 
actuator material bonded on either side of an uncoupled substrate. By using the geometry of 
Figure 5, the curvatures commanded can be translated into control surface deflections, d. Of 
course these estimations assume a frictionless, balanced system operating without geometric 
binding (which typically set in on real systems for rotation angles in excess of 15°.  
 
A11 + A12
0
0
D11 + D12
⎡ 
⎣ ⎢ 
⎤ 
⎦ ⎥ lam
ε
κ{}= A11 + A12
0
0
D11 + D12
⎡ 
⎣ ⎢ 
⎤ 
⎦ ⎥ a
αΔT
0{ }a
+
A11 + A12
0
0
D11 + D12
⎡ 
⎣ ⎢ 
⎤ 
⎦ ⎥ s
αΔT
0{ }s
+
0
B11 + B12
B11 + B12
0
⎡ 
⎣ ⎢ 
⎤ 
⎦ ⎥ a
Λ
0{}
 
(3)
 
 
κ =
Ea tsta + 2tbta + ta
2
(
)Λ
Ests
3
12
+ Ea
ts + 2tb
(
)2 ta
2
+ ts + 2tb
(
)ta
2 + 2
3 ta
3
⎛ 
⎝ 
⎜ ⎜ 
⎞ 
⎠ 
⎟ ⎟ 
  
(4)
 
 
δ = 2sin−1
1κ 1−cos κlo
(
)
(
)+ lotot −1κ sin κlo
(
)
(
)
2ll
⎡ 
⎣ 
⎢ 
⎢ 
⎤ 
⎦ 
⎥ 
⎥  
(5)
 
These expressions have been regularly used for more than a decade to predict Flexspar 
actuator deflection levels with experimental and predicted results typically within 5% of 
each other.16-18   

 
Advances in Flight Control Systems 
 
8 
 
Fig. 6. Typical Flexspar Deflection s and Correlation  Levels17 
The Flexspar actuator configuration is still, to this day, one of the more well used actuation 
schemes for flight control. It comes in two major variants: the Tip-Joint Flexspar 
arrangement as shown in Fig. 5. This configuration is particularly well suited to low 
subsonic flight control using symmetric, balanced aerodynamic surfaces. A high moment 
configuration called a Shell-Joint Flexspar actuator is used for high subsonic and faster 
control surfaces. In the Fall of 1994 invention disclosures were submitted to Auburn 
University where the Flexspar was invented. Because the University failed to either file for 
patents or revert the rights to the inventors the Flexspar design can now be used royalty-free 
by one and all. The first missile system to incorporate the Flexspar design was the TOW-2B 
which used the Flexspar to manipulate wing deflections. Figure 7 shows the TOW-2B missle 
mounted in the wind tunnel during testing. Because the Flexspar wings were both 
aerodynamically and inertially balanced and they employed symmetric airfoils, the wing 
pitch deflections were not affected by airspeed.  
 
 
Fig. 7. Flexspar-Equipped TOW-2B Missile in Wind Tunnel 
2.2 Cruise missile and gravity weapon applications 
2.2.1 Smart compressed reversed adaptive munition 
In 1995 the first of the gravity weapons programs was commissioned by the US Air Force 
employing adaptive flight control mechanisms. The program goal was to compress gravity 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
9 
weapons into bays the size of the weapon warheads. The driving factor in weapon 
compression came from the limited size of the F-22 internal weapon bays which were sized 
for AIM-120 air-to-air missiles, but not the existing slate of minimally compressed gravity 
weapons. Because conventionally guided gravity weapons of the time could not fit within 
the bay, a new approach was undertaken. Although a Flexspar configuration would have 
worked well, an antagonistic piezoelectric actuator was selected to drive a fin set as the 
design flight speed ranged from mid subsonic through low supersonic. Because of large 
shifts in position of center of pressure, the transonic flight regime is often the most 
challenging to flight control actuator designers as large rotations at high bandwidth against 
high moments are typically prescribed. 
Because the designers were allowed to rearrange the weapon configuration itself, a new 
configuration was developed which took the most advantage of the 1940's-era Mk83 
warhead design. This configuration called for a reversal in warhead direction such that the 
base of the warhead would fly first. This would allow for a stable bluff-body relase 
(important for weapon egress) and full strakes along the length of the weapon to maintain 
suitable levels of CNa and provide a housing to accommodate the antagonistic piezoelectric 
actuators. The entire weapon design took advantage of other artifacts including more than 
80 in3 of  volume in large fuse well. Extensive bench and wind tunnel testing showed that 
full ±10° fin deflections could be resist all airloads without degradation through the 
transonic flight regime at frequencies in excess of 40Hz. Power consumption studies 
demonstrated that the actuators could be accommodated over the entire flight duration for 
less than 2cc of zinc-air batteries.19,20 Figure 8 shows the weapon configuration and during 
wind tunnel testing.  
 
 
Fig. 8. Smart Compressed Reversed  Adaptive Munition (SCRAM)19,20 
Space constraints prevent the full chronicling of the program, but suffice it to say that this 
effort demonstrated that adaptive aerostructures could be used to increase weapon loadout 
by an order of magnitude.  
2.2.2 Weapon integration and design technology 
In 1997, following the success of the SCRAM program an effort was undertaken to provide 
vernier control for a new family of small penetrator weapons. The canard actuator used a 
modified form of a shell-joint Flexspar actuator called a Rotationally Active Linear Actuator 
(RALA). Although this unclassified program is many years old, details are not yet approved 
for public release.  
The actuator set designed for the GBU-39 was intended to enhance terminal guidance and 
went through extensive bench and wind tunnel testing, showing full deflection capability 
through the transonic and low supersonic flight speeds.22,23 

 
Advances in Flight Control Systems 
 
10 
 
Fig. 9. GBU-39 Small Diameter Bomb with Adaptive Canards21 
2.2.3 Miniature cruise missile airframe technology demonstrator 
Elements of the SCRAM and WIDT programs are currently alive and well in this 
USAF/Boeing project. Started in 2003, this effort is centered on demonstrating various 
advanced technologies including an adaptive on an extended range weapon system. As 
with the GBU-39 WIDT program, technical details have not yet been approved for release.  
 
 
Fig. 10. Boeing/USAF Miniature Cruise Missile with Adaptive Wings24 
2.3 Hard-launched munitions and supersonic Nano Aerial Vehicles (NAVs) 
2.3.1 Barrel-Launched Adaptive Munition (BLAM) program 
In 1995 the Barrel-Launched Adaptive Munition (BLAM) program was initated to enhance 
aerial gunnery by increasing the hit probability and the probability of a kill given a hit in 
close-in aerial gunnery. To do this, a proof-of concept nontactical round was developed. 
Figure 11 shows the general arrangement of the test article.25-28 
The most significant challenges that all hard-launched adaptive munition designs must 
overcome is clearly associated with launch loads. With respect to launch loads, all flight, 
storage and handling loads are trivial. In addition to launch loads, the round must also be 
able to deal with certain environmental factors that are also challenging for aerospace 
systems. The short summary below illustrates some of these challenges. 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
11 
 
Fig. 11. Barrel-Launched Adaptive Munition (BLAM) Configuration 
2.3.1.1 Setback Accelerations 
Setback accelerations strongly influence structural layout and material choices and are the 
driving condition behind length limitations of actuators for hard-launched actuators. 
Although munitions designers use exacting profiles which are specific to a gun, round, 
muzzle velocity and charge type combination to predict peak setback accelerations, some 
basic boundaries can be gleaned from fundamental physics and empirical trends for first-
order design. If one assumes a constant acceleration along the length of a barrel (a traveling-
charge profile), a round starting from 0 and exiting at a finite muzzle velocity, then a lower 
bound below which it is not possible to go:  
 
amin = Vmuzzle
2
2Lbarrel
 
(6) 
Because there is no upper bound which can be obtained by simple physics, generalized 
trends from interior ballistic profiles can be obtained. By examining the acceleration profiles 
of instrumented weapons like the Hypervelocity Weapon System, a rough upper bound can 
be gleaned for initial design purposes.29   
 
apeak ≅1.45Vmuzzle
2
Lbarrel
 
(7) 
For larger caliber rounds which are currently fielded, setback accelerations on the order of 
5,000 – 30,000 g’s are typical. The Navy's ERGM projectile is typical of the current families of 
guided 5” (127mm) cannon shells and is designed for 12,000g’s of setback acceleration while 
the LCCM projectiles withstand 15,000g’s.30  
2.3.1.2 Setforward, Balloting and Ringing 
Although secondary to setback accelerations, setforward accelerations have extremely 
detrimental effects on hard-launch round components and subsystems. Setforward 
accelerations are induced as the supersonic round exits the barrel into comparatively still 
air. This typically causes a large decelration force on most rounds with a pulse of 
approximately one order of magnitude lower than the setback acceleration. Setforward 
accelerations are the principal loads which induce buckling and end crush-out failure modes 
of many families of adaptive actuators. Reference 30 lists the design setforward accelerations 
for the ERGM round to be approximately 2,500g’s. 

 
Advances in Flight Control Systems 
 
12 
2.3.1.3 Rotational Accelerations 
Most of the gun-launched munitions which are in use today are spin stabilized via the 
rifling in the barrel. Such rifling induces acceleration rates of several hundred thousand 
rad/s2. As is the case with acceleration rates, Froude scaling principles hold when arriving 
at estimates for smaller (or larger) rounds, which indicates that lower caliber rounds will 
encounter acceleration levels as the reciprocal of the scale factor.  
2.3.1.4 Thermal Environment 
From Ref. 25 - 28, it can be seen that minimum operational and storage temperatures have a 
strong influence on the design of the actuator elements as they rely upon CTE mismatch to 
precompress actuator elements. Precompression levels at depressed temperatures must be 
carefully matched to thickness ratios and launch accelerations to ensure actuator survival of 
setback accelerations. Actuator material selection must be made with strong consideration of 
the operational and storage temperatures. Ref. 30 lists temperature environments which are 
typical of military munitions as: -40°C (-40°F) to +63°C (145°F)  storage  -9°C (+15°F)  to  
+63°C (145°F) in a tactical/operational environment. References 30 - 36 lay out many other 
daunting environmental considerations which must be taken into account when laying out 
an adaptive munition.    
2.3.1.5 Current Progress 
The forefront of modern guided round research has progressed far beyond the BLAM which 
is now more than a decade old. These rounds range in size from just a few milimeters in 
caliber and up and employ several families of adaptive actuators, guiding rounds with 
control authorities of just over 1g to many tens of g's. Not surprising, these projects are 
proprietary and/or restricted by ITARs and EARs. Several scattered efforts have 
intermittently surfaced, but most projects are still out of the public eye.36  
2.3.2 Supersonic Nano Aerial Vehicles (NAVs) 
The latest international incarnations of hard-launched aircraft comes in the form of supersonic 
Nano Aerial Vehicles (NAVs). Because conventional, subsonic NAVs are highly sensitive to 
the many adverse factors which become more severe with reduced scale, it is only logical that 
many of those problems can be skirted if the NAV is launched supersonically and flown for 
only a few seconds. The missions for these NAVs is nonlethal and primarily centered on 
reconnaissance. Figure 12 shows a CAD model of a supersonic NAV.  
 
 
Fig. 12. Supersonic Nano-Aerial Vehicle (NAV) Design37  
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
13 
The flight control of these aircraft employ some of the latest adaptive actuators. These 
advanced "Post-Buckled Precompressed" (PBP) actuators have been shown to generate 
significantly higher deflections than conventional actuators and are ideal for small aircraft 
like NAVs.37   
3. Uninhabited Aerial Vehicle (UAV) & Micro Aerial Vehicle (MAV) flight 
control 
Subsonic Uninhabited Aerial Vehicle (UAV) and Micro Aerial Vehicle (MAV) flight control 
with adaptive aerostructures draws its lineage back to some early experiments done on 
flight control devices which produced large changes in commanded lift coefficient. 
Although flight control mechanisms in rotary- and fixed-wing subsonic UAVs differ 
sharply, they share some common roots and even took advantage of some of the same 
families of actuators.  
3.1 Fixed-wing UAV beginnings 
As part of a National Science Foundation program investigating flight control with adaptive 
materials, the first fixed-wing aircraft using adaptive materials for all flight control was 
designed, built and flown in September of 1994. Using a Tip-Joint Flexspar configuration 
akin to the configuration shown in Figures 4 and 5, the aircraft executed basic maneuvers 
expected of micro-light aircraft using vertical and horizontal stabilator flight control.16  
 
 
Fig. 13. Mothra, The First UAV  with Flexspar Stabilators for Flight Control 
3.2 Foundations of rotary-wing UAV flight control 
The first serious attempts at achieving high control authority deflections of rotor systems 
was made in 1992. These early efforts employed the same class of torque-plates that drove 
missile fins, but in the roots of rotor blade systems.38 Although the first stages of the Solid 
State Adaptive Rotor (SSAR) was not selected for funding by the US Army, the founding 
experiments that went into the effort were instrumental in proving its feasibility. In 1994 the 
National Science Foundation picked up the project and supported it all the way through 
flight test. Figure 14 shows the earliest incarnation of the SSAR on a hover stand.  
The first rotary-wing aircraft to fly using adaptive aerostructures for all flight control took to 
the air in December of 1996. Space constraints prevent its being chronicled completely, but it 
employed a pair of piezoelectric DAP servopaddles mounted on a teetering rotor system. 
The DAP servopaddles were driven by a brush contact assembly which allowed the rotor 
system to respond to basic cyclic commands at speeds in excess of 2.7/rev. Flight tests were 
conducted against a benchmark aircraft, ultimately demonstrating maneuver authority 
nearly identical to the baseline aircraft. The big difference was that the aircraft shed 40% of 
its flight control system weight, leading to an 8% reduction in total gross weight, a 26% drop 

 
Advances in Flight Control Systems 
 
14 
in parasite drag and a cut in part count from 94 components down to 5. Figure 15 shows the 
SSAR aircraft Gamara in on the bench and during flight test.40 
 
 
Fig. 14. Solid State Adaptive Rotor with Root Torque-Plate Actuator38,39 
  
 
Fig. 15. Gamara, The First Rotary-Wing UAV to Fly with Adaptive Materials for All Flight 
Control,39 
3.3 The DoD's first MAV -- kolibri 
In 1994 the DoD CounterDrug Technology Office commissioned a program that would 
eventually lead to the US Military's first Micro Aerial Vehicle (MAV). In 1995, managers at 
Lutronix Corp. read about the success of the SSAR program in the technical literature and 
decided to fold the adaptive technology used in these various programs into their aircraft. 
The mission specification for the MAV called for a 24hr loiter with acoustic signature levels 
under 65db at 10ft. Accordingly, an electric-tethered configuration was chosen. Because of 
the highly constrained rotor diameter and the limited adaptive materials manufacturing 
techniques of the day, it was decided that instead of a DAP-torque-plate rotor configuration, 
a Flexspar stabilator configuration would be used. These Flexspar stabilators would be 
placed in the rotor wash at the bottom of a graphite-truss frame fuselage counterrotating 
coleopter.  
 
 
Fig. 16. DoD's First MAV -- Kolibri Stabilator, Aircraft & in Flight 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
15 
Because the Kolibri was so severely weight-critical, any opportunity to shed weight was 
taken. Accordingly, the flight control system was a prime target for weight reduction. 
Because the aircraft body times to double amplitude were on the order of several tens of 
miliseconds, extremely fast actuators were a necessity. The conventional servoactuators on 
the open market were simply not fast enough to catch the aircraft and their weights were 
prohibitive. Flexspar actuators on the other hand were extremely lightweight with a mass of 
only 380mg each and exhibited a corner frequency of 47 Hz  -- almost double the bandwidth 
required to maintain flight. So for the first time, adaptive flight control mechanisms were 
not only enhancing technologies, but they actually enabled an entire class of aircraft to take to 
the air. Not surprisingly, the flight control system also included adaptive materials in the 
Tokin DO-16 piezoelectric gyros which were used to sense pitch, roll and yaw accelerations.  
3.4 The first free-flight rotary-wing MAV 
Following the success of the Kolibri, the DoDCDTO handed the program off to DARPA, 
thereby kicking off DARPA's much touted MAV program of the late '90's. Although the 
Kolibri satisfied the 24 hour hover endurance requirement with a tether, there was a strong 
desire to shed the tether. As a result a decision was made to go with an internal combustion 
engine. Although the boost in power was tremendous, the noise and structural vibrations 
were also boosted by an order of magnitude. As with the Kolibri, Flexspar stabilators and 
piezoelectric gyros allowed smooth flight in turbulent atmospheric conditions up through 
18kt gusting winds. Figure 17 shows the aircraft overview and in flight. Ultimately, the 
aircraft was the only one of three finalist MAVs which successfully flew at DARPA's 3-day 
Fly-Off at Quantico Marine Corps Base, Virginia in September of 2000. Fly-offs were also 
conducted in several other locations including MacDill AFB, Florida, again, with the 
LuMAV appearing as the only rotary-wing/VTOL aircraft in the air. The aircraft 
performance specifications included a 15 minute endurance with all-weather capability 
including rain rates in excess of 12" (30cm)/hr, dust and snow capability through 18kt gust 
fields, flight in 100°F, 100% humidity environments and 15g wall-strikes. The aircraft was 
designed to carry a single submicrovideo camera an a GPS navigation suite.44  
 
 
Fig. 17. Lutronix MAV Configuration & Flying at MacDill AFB, Florida 
3.5 The XQ-138 convertible UAV 
As the LuMAV project came to a resoundingly successful conclusion, a follow-on design 
was sought. Although the LuMAV was clearly quite capable and flew circles around 
competitors, it was not selected for follow-on funding by DARPA. Instead, DARPA 
managers recommended approaching Boeing, which in turn recommended a new corporate 
partner on the Future Combat System (FCS) program, Singapore Technologies Engineering. 

 
Advances in Flight Control Systems 
 
16 
A new aircraft configuration was independently conceived and reduced to practice in the 
summer of 2001 which employed the best of the rotary-wing and fixed-wing worlds. 
Impressed with the new aircraft performance and promise, ST Engineering purchased the 
rights to the aircraft and paid for its production. Initially, the XQ-138, a convertible 
coleopter, used conventional flight control actuators in its grid-fin empennage and turning 
vane flaps. Following component development efforts, these actuators were replaced by 
piezoelectric mechanisms. Figure XX18 shows the overall configuration of the XQ-138.45  
 
 
Fig. 18. The 11" Rotor Diameter XQ-138a Overall Configuration 
More than 300 flight tests were conducted in all types of atmospheric conditions including 
gusts through 26 kts, rain at 9"/hr, 100°F (38°C) heat at 100% humidity, winter flights in 
snow at 22°F (-6°C), dust, sand and finally flight in smoke plumes from exploded tanks. 
Figure 19 shows a sequence of photos of the aircraft flying off an FCS prototype on Redstone 
Arsenal, Alabama in April of 2002. These tests were followed by live-fire Battle-Damage 
Assessment (BDA) tests on the Hellfire Range of Eglin AFB in May of 2002. Although all 
variants of the aircraft used piezoelectric gyros at the core of its GNC package, the 
conversion of the aircraft to piezoelectric flight controls lent marked improvements in all 
aspects, eventually leading to a total empty weight savings in excess of 10% which allowed 
the range to be expanded by 30nmi to 100nmi and more than an hour and a half of 
endurance. Variants of the aircraft survive today as Singapore Technologies Engineering's 
FanTail UAV line of aircraft.  
 
 
Fig. 19. The Piezoelectric FCS-Equipped XQ-138 Convertible Coleopter UAV 
3.6 Low and zero net passive stiffness structures 
In 2004 an important innovation was made which dramatically improved the performance 
of adaptive aerostructures. It was discovered how to simultaneously improve both 
deflection and force with minimal weight volume and cost penalties.46 This discovery was 
shown to dramatically improve flight control actuator performance and has been integrated 
into a number of flight control systems.47-53 Several variants of Low Net Passive Stiffness 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
17 
(LNPS), Zero Net Passive Stiffness (ZNPS) as Post-Buckled Precompressed (PBP) actuator 
elements have been built into aircraft which are currently undergoing development.   
4. Nomenclature 
Symbol       Description  
 
 
 
Units 
A,B,D 
in-plane, coupled, bending laminate stiffnesses   
N/m, N, N-m  
B 
actuator width 
 
 
 
 
mm (in) 
Dp 
actuator power density per unit mass, volume, cost    W/g, W/cc, W/$ 
E 
stiffness  
 
 
 
 
GPa (msi) 
F 
applied end force  
 
 
 
N (lbf) 
M 
Mach number  
 
 
 
 
~ 
M 
applied moment vector 
 
 
 
N-m/m (in-lb/in) 
N 
applied force vector 
 
 
 
N/m (lb/in) 
OR 
Orthotropy Ratio = EL/ET  
 
 
~ 
t 
thickness 
 
 
 
 
mm (in) 
y 
out of plane displacement dimension 
 
mm (in) 
z 
through thickness dimension 
 
 
mm (in) 
α 
angle of attack 
 
 
 
 
deg 
δ 
PBP beam angle  
 
 
 
deg 
δo  
PBP end rotation angle 
 
 
 
deg 
ε 
laminate in-plain strain 
 
 
 
µstrain 
κ 
laminate curvature 
 
 
 
rad/m (rad/in) 
Λ 
piezoelectric free element strain  
 
 
µstrain 
σ 
stress 
 
 
 
 
 
GPa (msi) 
Subscripts 
a 
actuator 
b 
bond 
c 
cost 
ex 
external 
l 
laminate 
L 
longitudinal 
m 
mass 
s 
substrate 
t 
thermally induced 
T 
transverse 
v 
volume 
Acronyms 
 
AAL 
The Adaptive Aerostructures Laboratory 
AFOSR US Air Force Office of Scientific Research,  
AFRL 
Air Force Research Lab 
AMCOM  US Army Aviation and Missile Command 
ARO 
US Army Research Office 
DAP 
Directionally Attached Piezoelectric 

 
Advances in Flight Control Systems 
 
18 
DARPA Defense Advanced Research Projects Agency 
DoD CDTO 
Department of Defense CounterDrug Technology Office 
FCS 
Future Combat System 
LAV 
Light Armored Vehicle 
MAV 
micro aerial vehicle 
NAV 
nano aerial vehicle 
NSF 
National Science Foundation 
PZT 
lead zirconate titanate 
SMDC Space and Missile Defense Command 
TACOM-ARDEC    
US 
Army 
Tank-Automotive 
and 
Armaments 
Command/Armament Research, Development and Engineering Center 
TNO 
Toegepast Natuurwetenschappelijk Onderzoek 
TU Delft  The Technical University of Delft, Netherlands 
UAV 
uninhabited aerial vehicle 
WL 
Wright Laboratory 
5. References 
[1] Crawley, E., Lazarus, K. and Warkentin, D., "Embedded Actuation and Processing in 
Intelligent Materials," presented at the 2nd international Workshop on Composite 
Materials and Structures for Rotorcraft, Troy, NY, Sept., 1989.  
[2] Lazarus, K., and Crawley, E., "Multivariable Active Lifting Surface Control using Strain 
Actuation: Analytical and Experimental Results," paper presented at the Third 
International Conference on Adaptive Structures, sponsored by the ASME, 9 - 11 
November, 1992, San Diego.  
[3] Lazarus, K. B., Crawley, E. F., and Bohlmann, J. D., "Static Aeroelastic Control Using 
Strain Actuated Adaptive Structures," Proceedings of the First Joint U.S./Japan 
Conference on Adaptive Structures, Maui, Hawaii, October, 1990.  
[4] Spangler, R. L., and Hall, S. R., "Piezoelectric Actuators for Helicopter Rotor Control," 
Paper presented at the 31st Structures, Structural Dynamics and Materials Conference, 
Long Beach, California, April, 1990.  
[5] Barrett, R., "Intelligent Rotor Blade Actuation through Directionally Attached 
Piezoelectric Crystals,” 46th American Helicopter Society National Conference and 
Forum, Washington, D.C., May, 1990. 
[6] Barrett, R., “Intelligent Rotor Blade and Structures Development using Piezoelectric 
Crystals,” MS Thesis, the University of Maryland, College Park, Maryland 1990.  
[7] Barrett, R., “Method and Apparatus for Sensing and Actuating in a Desired Direction,” 
US Pat. 5,440,193, Aug. 1995.  
[8] Barrett, R., "Actuation Strain Decoupling Through Enhanced Directional Attachment in 
Plates and Aerodynamic Surfaces," proceedings of the First European Conference 
on Smart Structures and Materials, Glasgow, Scotland, 12 - 14 May 1992, IOP 
Publishing, Bristol, UK 1992, pp. 383 - 386.  
[9] Ehlers, S. M., and Weisshaar, T. A., "Static Aeroelastic Behavior of an Adaptive 
Laminated Piezoelectric Composite Wing," AIAA-90-1078-CP, April, 1990, pp. 
1611-1623.  
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
19 
[10] Ehlers, S. M., and Weisshaar, T., "Adaptive Wing Flexural Axis Control," paper 
presented at the Third International Conference on Adaptive Structures, sponsored by 
the ASME, 9 - 11 November, 1992, San Diego.  
[11] Ehlers, S. M., and Weisshaar, T. A., "Effect of Material Properties on Static Aeroelastic 
Control," paper presented at the 33rd Structures, Structural Dynamics and 
Materials Conference, Dallas, Texas, 15 April, 1992.  
[12] Barrett, R., "Active Plate and Missile Wing Development Using EDAP Elements," Journal 
of Smart Materials and Structures, Institute of Physics Publishing, Ltd., Techno 
House, Bristol, UK, Vol. 1, No. 3, pp. 214226, ISSN 096. 
[13] Barrett, R., "Active Plate and Missile Wing Development Using DAP Elements," AIAA 
Journal,March, 1994. 
[14] Barrett, R., "Active Composite Torque-Plate Fins for Subsonic Missiles," paper presented 
at the Dynamic Response of Composite Structures Conference, New Orleans, 
Louisiana, August 30 - September 1, 1993. 
[15] Barrett, R., "Advanced Low-Cost Smart Missile Fin Technology Evaluation," Contractor 
Report to the United States Air Force Armament Directorate, Eglin Air Force Base, 
Florida, Contract No. F0 8630-93-C-0039, BAT, November 1993. 
[16] Barrett, R., Brozoski, F., and Gross, R. S., "Design and Testing of a Subsonic All-Moving 
Adaptive Flight Control Surface," AIAA Journal,  published by the AIAA, Reston, 
VA,Volume 35, No. 7, July 1997, pp. 1217 - 1219.  
[17] Barrett, R. and Brozoski, F., "Missile Flight Control using Active Flexspar Actuators," 
Journal of Smart Materials and Structures, Institute of Physics Publishing, Ltd., 
Techno House, Bristol, UK, Vol. 5, No. 2, March 1996, pp. 121-128. 
[18] Barrett, R., "Active Aeroelastic Tailoring of an Adaptive Flexspar Stabilator," Journal of 
Smart Materials and Structures, Vol. 5, No. 6 December 1996, Techno House, Bristol, 
UK, 1996, pp. 723 – 730.  
[19] SCRAM Report Barrett, R., “Design, Construction and Testing of a Proof-of-Concept 
Smart Compressed Reversed Adaptive Munition,” Final Report to the USAF 
Armament Directorate, Wright Laboratory, Eglin AFB, FL contract no. AF-FO8630-
95-K-0079, September, 1996. 
[20] Barrett, R., and Stutts, J., “Development of a Piezoceramic Flight Control Surface 
Actuator for Highly Compressed Munitions,” proceedings of the 39th Structures, 
Structural Dynamics and Materials Conference 20 - 23 April 1998, Long Beach, CA, 
AIAA, Washington, D.C. 1998, paper no. AIAA-98-2034.  
[21] 
Anon., 
"GBU-39 
SDB 
- 
Small 
Diameter 
Bomb," 
http://www.globalsecurity.org/military/systems/munitions/sdb.htm, 
January 
2006.  
[22] Barrett, R., “Construction and Test Report for the Rotationally Active Linear Actuator 
(RALA) Adaptive Canard, Final Report for McDonnell Douglas, St. Louis, MO 
contract no. FO 8630-95-C-0009, August, 1997.  
[23] Knowles, G., R. Barrett and M. Valentino, “Self-Contained High Authority Control of 
Miniature Flight Control Systems for Area Dominance,” SPIE 11th International 
Symposium on Smart Structures and Materials, San Diego, CA, Mar. 2004.  

 
Advances in Flight Control Systems 
 
20 
[24] 
Avila, 
C.A., 
"Precision 
Engagement," 
http://www.aviationnow.com/ 
conferences/html/ad03/avila_session_4b.pdf January 2006.  
[25] Barrett, R., "Invention and Evaluation of the Barrel Launched Adaptive Munition 
(BLAM)," final report for USAF contract no. F-49620-93-C-0063, USAF Wright 
Laboratory Flight Vehicles Branch, WL/MNAV August, 1995. 
[26] Barrett, R., and Stutts, J. "Barrel-Launched Adaptive Munition BLAM Experimental 
Round Research," final report for USAF contract no. F-49620-C-0063, USAF Wright 
Laboratory Flight Vehicles Branch, WL/MNAV February, 1997. 
[27] Winchenbach, G., "Cone Aerodynamics Test", Aeroballistic Research Facility Ballistic 
Spark Range Technical Report, USAF Wright Laboratory Flight Vehicles Branch, 
WL/MNAV June 1996. 
[28] Barrett, R. and Stutts, J., "Modeling, Design and Testing of a Barrel-Launched Adaptive 
Munition," proceedings of the 4" Annual SPIE Symposium on Smart Structures and 
Materials, San Diego, CA, 3-6 March 1997. 
[29] Anon., "Actual Results and Analysis," Hypervelocity Weapon System (HVWS) Field 
Experiment 1 Final Report, Volume 1 Technical Report, published by Technology 
Gateways, Inc., Niceville, Florida, 1993. 
[30] Hertlein, Robert and Mark Miner, “Extended Range Guided Munition (ERGM) Safe and 
Arm Device and Height-of-Burst Sensor,” paper presented at the NDIA Fuse 
Conference, 
9 
April 
2993, 
New 
Orleans, 
LA. 
(http://www.dtic.mil/ndia/2003fuze/hertlien.pdf 
[31] Pike, J. “Trajectory Correctable Munition (TCM),” published by Global Security.org, 
Alexandria, 
Virginia, 
October, 
2002. 
(http://www.globalsecurity.org/military/systems/munitions/tcm.htm). 
[32] Anon., “M732A2 Proximity Fuse and M782 Multi-Option Fuse for Artillery (MOFA) 
Data Sheets,” published by Alliant Techsystems, Inc. Edina, Minnesota, 2003. 
(http://www.atk.com/productsPrecision/descriptions/products/fuses/ 
artilleryfuzes.htm) 
[33] Lee, Gary, “Range-Extended Adaptive Munition (REAM)” Final Report from Lutronix 
Corporation to the Defense Advanced Research Projects Agency (DARPA), Del 
Mar, California, April 1999.  
[34] Lee, Gary, “40/50 Caliber Range-Extended Adaptive Munition (REAM)” Final Report 
from Lutronix Corporation to the US Army TACOM-ARDEC Del Mar, California, 
May 2000. 
[35] Lee, Gary, “Shipborne Countermeasure Range-Extended Adaptive Munition 
(SCREAM),” Final Report from Lutronix Corporation to the US Army TACOM-
ARDEC, Del  Mar, California, May 2003.  
[36] Rabinovitch, O., and J. R., Vinson, “On the Design of Piezoelectric Smart Fins for Flight 
Vehicles,” Journal of Smart Materials and Structures,” IOP Publishing, Ltd., Techno 
House, Bristol, UK, Vol. 12, No. 5, pp. 686 – 695, Oct., 1993.  
[37] Barrett, R. and P. Tiso, “PBP Adaptive Actuator Device and Embodiments,” 
International Patent Application number PCT/NL2005/000054, via TU Delft, 18 
February 2005. 
www.ebook3000.com

Adaptive Fight Control Actuators and Mechanisms  
for Missiles, Munitions and Uninhabited Aerial Vehicles (UAVs)   
 
21 
[38] Barrett, R., “High Bandwidth Electric Rotor Blade Actuator Study,” Phase I SBIR 
proposal Submitted to the U.S. Army Aviation Systems Command, St. Louis, MO 
27 June 1992.  
[39] Barrett, R. and Stutts, J., “Design and Testing of a 1/12th Scale Solid State Adaptive 
Rotor,” Journal of Smart Materials and Structures, Vol. 6, No. 4 August 1997, Techno 
House, Bristol, UK, 1997, pp. 491 - 497.  
[40] Barrett, R., Frye, P., and Schliesman, M., “Design, Construction and Characterization of 
a Flightworthy Piezoelectric Solid State Adaptive Rotor,” Journal of Smart Materials 
and Structures Vol. 7, No. 3, June 1998, pp. 422–431.  
[41] Lee, G., “Design and Testing of the Kolibri Vertical Take-Off and Landing Micro Aerial 
Vehicle,” final report for the Department of Defense CounterDrug Technology 
Office, November 1997.  
[42] Barrett, R., and Howard, N., “Adaptive Aerostructures for Subscale Aircraft,” refereed 
proceedings of the 20th Southeastern Conference on Theoretical and Applied 
Mechanics,” Pine Mountain, GA, 17 April 2000.   
[43] Barrett, R., Burger, C. and Melián J. P., “Recent Advances in Uninhabited Aerial Vehicle 
(UAV) Flight Control with Adaptive Aerostructures,” 4th European Demonstrators 
Conference, 10 – 15 Dec. 2001, Edinburgh, Scotland.  
[44] Barrett, R. and Lee, G., “Design Criteria, Aircraft Design, Fabrication and Testing of 
Sub-Canopy and Urban Micro-Aerial Vehicles,” AIAA/AHS International Powered 
Lift Conference, Alexandria, Virginia, Nov. 2000.  
[45] Barrett, R., “Convertible Vertical Take-Off and Landing Miniature Aerial Vehicle,” US 
patent 6,502,787, 22 Feb. 2002.  
[46] Barrett, R. and P. Tiso, “PBP Adaptive Actuator Device and Embodiments,” 
International Patent Application number PCT/NL2005/000054, via TU Delft, 18 
February 2005.  
[47] Barrett, R., McMurtry,R., Vos, R., Tiso, P., and De Breuker, R., "Post-Buckled 
Precomprecompressed Piezoelectric Flight Control Acutator Design, Development 
and Demonstration," Journal of Smart Materials and Structures, Vol. 15, No. 5, 
October 2006, pp. 1323 - 1331. 
[48] Vos, R., De Breuker, R., Barrett, R., and Tiso, P., “Morphing Wing Flight Control via 
Postbuckled Precopressed Piezoelectric Actuators, Journal of Aircraft, Vol. 44, No. 4, 
pp. 1060 - 1068, July-August 2007.  
[49] Vos, R., Barrett, R., De Breuker, R. and Tiso, P., "Post-buckled Precompressed Elements: 
A New Class of Control Actuators for Morphing Wing UAVs," Journal of Smart 
Materials and Structures, Vol. 16, No. 3, June 2007, pp. 919 - 926. 
[50] Barrett, R., “Post-Buckled Precompressed (PBP) Subsonic Micro Flight Control 
Actuators," Journal of Smart Materials and Structures, vol. 17, no. 5, 10pp., October 
2008. 
[51] Vos, R., and Barrett, R., "Dynamic Elastic Axis Shifting: An Important Enhancement of 
Piezoelectric Postbuckled Precompressed Actuators," The Journal of the American 
Institute of Aeronautics and Astronautics, Vol. 48, No. 3 March 2010.  

 
Advances in Flight Control Systems 
 
22 
[52] Barrett, R., "Hypermaneuverability and Visual Cloaking; New Adaptive Aerostructures 
Technologies for Uninhabited Aerial Vehicles (UAVs)," The Aeronautical Journal, 
Royal Aeronautical Society, London, UK, Vol. 114, No. 1156, June 2010.  
[53] Vos, R., and Barrett, R., "Post-Buckled Precompressed Techniques In Adaptive 
Aerostructures: An Overview," MD-08-1306 Journal of Mechanical Design, Vol. 132, 
Issue 3, March 2010. 
www.ebook3000.com

2 
Adaptive Backstepping Flight Control for 
Modern Fighter Aircraft 
L. Sonneveldt, Q.P. Chu and J.A. Mulder 
Delft University of Technology 
The Netherlands 
1. Introduction  
 
 
Inertial trajectory control is essential for UAVs which must follow predetermined paths 
through three-dimensional space (Healy and Liebard, 1993, Kaminer et al., 1998, Boyle et al., 
1999, Singh et al., 2003, Tsach et al., 2003, Ren and Beard, 2004, Wegener et al., 2004, Ren and 
Atkins, 2005, No et al., 2005, Clough, 2005, Papadales et al., 2005, Narasimhan et al., 2006, 
Kaminer et al., 2007). Other applications of trajectory control include formation flight, aerial 
refueling, and autonomous landing maneuvers (Pachter et al., 1994, Proud et al., 1999, 
Fujimori et al. 2000, Singh et al., 2000, Pachter et al., 2001, Wang et al., 2008).  
Two different approaches can be distinguished in the design of these trajectory control 
systems. The most popular approach is to separate the guidance and control laws: a given 
reference trajectory is converted by the guidance laws to velocity and attitude commands for 
the autopilot, which in turn generates the actuator signals (Ren and Beard, 2004, Pachter et 
al., 1994, Pachter et al., 2001). Usually, the assumption is made that the autopilot response to 
heading and airspeed commands is first order in nature to simplify the design. 
The other design approach is to integrate the guidance and control laws into one system, in 
order to achieve better stability guarantees and improved performance. Kaminer et al. (1998) 
use an integrated guidance and control approach to trajectory tracking in which the 
trimmed flight conditions along the reference trajectory are the command input to the 
tracking controllers. Singh (2003) uses a combination of sliding-mode control and adaptive 
control. 
In this chapter an integrated, though cascaded Lyapunov-based adaptive backstepping 
(Krstić et al., 1992, Singh and Steinberg 1996) approach is taken and used to design a flight-
path controller for a nonlinear high-fidelity F-16 model. Adaptive backstepping allows 
assuming that the aerodynamic force and moment models may not be known exactly, and 
even that they may change in flight due to causes as structural damage and control actuator 
failures. There is much literature available on adaptive backstepping control system design 
for aircraft and missiles (see, for example, (Singh and Steinberg, 1996, Härkegård, 2003, 
Farrell et al., Kim et al., 2004, Shin and Kim, 2004, Farrell et al., 2005, Sonneveldt, et al., 2006, 
Sonneveldt, et al. 2007)). Most of these designs consider control of the aerodynamic angles μ, 
α, and β. Due to the higher relative degree, however, the design of trajectory controllers as 
discussed here is much more complicated, as the required analytical calculation of the 
derivatives of the intermediate control variables leads to a rapid explosion of terms. This 
phenomenon is the main motivation for the authors of (Singh et al., 2003) to select a sliding-

 
Advances in Flight Control Systems 
 
24 
mode design for the outer feedback loops. Another disadvantage of (adaptive) backstepping 
flight control system design is that the contribution of the control-surface deflections to the 
aerodynamic forces cannot be taken into account. For these reasons, the constrained 
adaptive backstepping approach of (Farrell et al., 2005, Sonneveldt et al., 2007, Yip 1997) is 
used here. This method makes use of command filters to calculate the derivatives of the 
intermediate controls, which greatly simplifies the design. Additionally, these filters can be 
used to enforce magnitude and rate limits on the state and input variables. 
To simplify the mathematical approximation of the unknown aerodynamic force and 
moment characteristics, we propose to partition the flight envelope into multiple connecting 
operating regions called hyperboxes. In each hyperbox a locally valid linear-in-the-
parameters nonlinear model is defined. The coefficients of these local models can be 
estimated using the update laws of the adaptive backstepping control laws. The number and 
size of the hyperboxes should be based on a priori information on the physical properties of 
the vehicle on hand, and may be defined in terms of state variables as Mach number, angle 
of attack and engine thrust. In this study we use B-spline neural networks (Cheng et al., 
1999, Ward et al., 2003) to interpolate between the local models to ensure smooth model 
transitions. Numerical simulations of various maneuvers with aerodynamic uncertainties in 
the model and actuator failures are presented. The maneuvers are performed at several 
flight conditions to demonstrate that the control laws are valid for the entire flight envelope. 
The chapter is outlined as follows. First, the nonlinear dynamics of the aircraft model are 
introduced in Sec. II. In Sec. III the adaptive control system design is presented decomposed 
in four cascaded feedback-loop designs. The aerodynamic model identification process 
including the B-spline neural networks is discussed in Sec. IV. Section V validates the 
performance 
of 
the 
control 
laws 
using 
numerical 
simulations 
performed 
in 
MATLAB/Simulink. A summary of the results and the conclusions are given in Sec. VI. 
Finally, an appendix on the concept of constrained adaptive backstepping is included. 
2. Aircraft model description 
The aircraft model used in this study is that of an F-16 fighter aircraft with geometry and 
aerodynamic data as reported in (Nguyen et al., 1979). The aerodynamic data in tabular 
form have been obtained from wind-tunnel tests and are valid up to Mach 0.6 for the wide 
range of -20 deg 
α
≤
≤90 deg and -30 deg 
β
≤
≤30 deg. The control inputs of the model are 
the elevator, ailerons, rudder, and leading-edge flaps, as well as the throttle setting. The 
leading-edge flaps are not used in the control design. The control-surface actuators are 
modeled as first-order low-pass filters with rate and magnitude limits as given in 
(Sonneveldt et al., 2007). Before giving the equations of motion for the F-16 model, some 
reference frames to describe the aircraft motion are needed. The reference frames used in 
this paper are the Earth-fixed reference frame
E
F , used as the inertial frame; the vehicle-
carried local Earth reference frame
O
F , with its origin fixed in the center of gravity of the 
aircraft, which is assumed to have the same orientation as
E
F ; the wind-axes reference 
frame
W
F , obtained from
O
F by three successive rotations of χ , γ , and μ ; the stability-axes 
reference frame
SF , obtained from
W
F
by a rotation of β
−
; and the body-fixed reference 
frame 
B
F , obtained from
SF by a rotation ofα , as is also indicated in Fig. 1. The body-fixed 
reference frame 
B
F  can also be obtained directly from
O
F by three successive rotations of yaw 
angleψ , pitch angleθ , and roll angleφ . More details and transformation matrices are given 
in, for example, (Lewis and Stevens, 1992, Cook, 1997). 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
25 
 
Fig. 1. Aircraft reference frames 
Assuming that the aircraft has a rigid body, which is symmetric around the X–Z body-fixed 
plane, the relevant nonlinear coupled equations of motion can be described by (Lewis and 
Stevens, 1992): 
 
0
cos
cos
sin
cos
sin
V
X
V
V
χ
γ
χ
γ
γ
⎡
⎤
⎢
⎥
= ⎢
⎥
⎢
⎥
−
⎣
⎦

 
(1) 
 
(
)
(
)
(
)
1
1
cos
cos
sin
1
sin
cos
sin
sin
cos
sin
cos
cos
1
cos
sin
cos
sin
sin
sin
cos
cos
D
T
g
m
X
L
Y
T
mV
g
L
Y
T
mV
V
α
β
γ
μ
μ
α
μ
α
β
μ
γ
μ
μ
α
β
μ
α
μ
γ
⎡
⎤
−
+
−
⎢
⎥
⎢
⎥
⎢
⎥
⎡
⎤
=
+
+
−
⎢
⎣
⎦
⎥
⎢
⎥
⎢
⎥
⎡
⎤
−
+
+
−
⎢
⎥
⎣
⎦
⎣
⎦

 
(2) 
     
2
3
1
cos
sin
0
0
sin
cos sin
tan
cos
tan
cos
cos
cos sin
cos
cos
tan
1
sin
tan
0
cos
cos
sin
0
cos
0
cos cos
sin
X
X
X
α
α
γ
γ
μ
β
μ
β
β
β
γ
μ
μ
α
β
α
β
β
β
α
α
γ
μ
μ
⎡
⎤
⎡
⎤
+
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
= −
−
+
−
−
⎢
⎥
⎢
⎥
⎢
⎥
−
⎢
⎥
⎢
⎥
−
⎣
⎦
⎢
⎥
⎣
⎦

  (3) 
 
(
)
(
)
(
)
(
)
(
)
(
)
1
2
3
4
2
2
3
5
6
7
8
2
4
9
e
e
e
c r
c p q
c L
c
N
h q
X
c pr
c
p
r
c
M
h r
c p
c r q
c L
c
N
h q
⎡
⎤
+
+
+
+
⎢
⎥
⎢
⎥
=
−
−
+
−
⎢
⎥
⎢
⎥
−
+
+
+
⎢
⎥
⎣
⎦

 
(4) 
where 
0
T
X
x
y
z
= ⎡
⎤
⎣
⎦, 
1
T
X
V
χ
γ
= ⎡
⎤
⎣
⎦, 
2
T
X
μ
α
β
= ⎡
⎤
⎣
⎦, 
3
T
X
p
q
r
= ⎡
⎤
⎣
⎦, and the 
definition of the inertia terms 
(
)
1,
,9
ic i =
"
is given in, for example, (Sonneveldt et al., 2007). 

 
Advances in Flight Control Systems 
 
26 
The engine angular momentum 
eh is assumed to be constant. These 12 differential equations 
are sufficient to describe the complete motion of the aircraft; other states such as the attitude 
anglesφ ,θ , and ψ are functions of
3
X , and their dynamics can be expressed as 
 
3
1
sin tan
cos tan
0
cos
sin
sin
cos
0
cos
cos
X
φ
φ
θ
φ
θ
θ
φ
φ
ψ
φ
φ
θ
θ
⎡
⎤
⎡⎤
⎢
⎥
⎢⎥
⎢
⎥
=
−
⎢⎥
⎢
⎥
⎢⎥
⎢
⎥
⎢⎥
⎢
⎥
⎣⎦
⎣
⎦



 
(5) 
The thrust model of (Nguyen et al., 1979) is implemented, which calculates the thrust as a 
function of altitude, Mach number, and throttle setting
tδ . This model is given in tabular 
form. The aerodynamic forces L, Y, and D (expressed in the wind reference frame
W
F
) and 
moments L , M , and N  (expressed in body fixed frame 
B
F ) are summations of the various 
aerodynamic contributions stored in lookup tables. As an example, the pitch moment M is 
given by 
 
(
)
(
)
( )
( )
(
)
( )
(
)
,
,
1
25
1
,
2
25
T
r
LEF
q
q
ds
LEF
LEF
m
e
Z
cg
cg
m
LEF
m
m
m
m
e
T
M
qSc C
C
x
x
C
qc
C
C
C
C
V
δ
α β δ
δ
δ
α
δ
α
δ
α
δ
α δ
⎧
⎛
⎞
=
+
⋅
−
+
−
+
⎨
⎜
⎟
⎝
⎠
⎩
⎫
⎛
⎞
⎪
+
+
−
+
+
⎬
⎜
⎟
⎪
⎝
⎠
⎭
 
(6) 
 
Other aerodynamic forces and moments are given in similar form; for a detailed discussion, 
see (Nguyen et al., 1979). 
3. Adaptive control design 
In this section we aim to develop an adaptive guidance and control system that 
asymptotically tracks a smooth prescribed inertial trajectory
(
)
ref
ref
ref
ref
T
Y
x
y
z
=
with 
position states
(
)
0
T
X
x
y
z
=
. Furthermore, the sideslip angle β has to be kept at zero to 
enable 
coordinated 
turning. 
It 
is 
assumed 
that 
the 
reference 
trajectory 
(
)
ref
ref
ref
ref
T
Y
x
y
z
=
 satisfies 
 
ref
ref
ref
cos
x
V
χ
=

 
(7) 
 
ref
ref
ref
sin
y
V
χ
=

 
(8) 
 
with 
ref
V
, 
ref
χ
, 
ref
z
, and their derivatives continuous and bounded. It also assumed that the 
components of the total aerodynamic forces L, Y, and D and moments L , M and N are 
uncertain, and so these will have to be estimated. The available controls are the control-
surface deflections(
)
T
e
a
r
δ
δ
δ
and the engine thrust T. The Lyapunov-based control 
design based on (Farrell et al., 2005, Sonneveldt et al., 2007) is done in four feedback loops, 
starting at the outer loop. 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
27 
3.1 Inertial position control 
We start the outer-loop feedback control design by transforming the tracking control 
problem into a regulation problem: 
 
(
)
01
ref
0
02
0
03
cos
sin
0
sin
cos
0
0
0
1
z
Z
z
X
Y
z
χ
χ
χ
χ
⎡
⎤
⎡
⎤
⎢
⎥
⎢
⎥
=
= −
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
 
(9) 
 
where we introduce a vehicle carried vertical reference frame with origin in the center of 
gravity and X-axis aligned with the horizontal component of the velocity vector (Ren and 
Beard, 2004, Proud et al., 1999). Differentiating Eq. (9) now gives 
        
(
)
(
)
ref
ref
02
ref
ref
0
01
ref
cos
sin
sin
V
z
V
Z
z
V
z
V
χ
χ
χ
χ
χ
χ
γ
⎡
⎤
+
−
−
⎢
⎥
⎢
⎥
=
−
+
−
⎢
⎥
⎢
⎥
−
⎣
⎦




       
(10) 
 
We want to control the position errors 
0
Z  through the flight-path angles χ and γ , and the 
total airspeed V. However, from Eq. (10) it is clear that it is not yet possible to do something 
about
02
z
in this design step. Now we select the virtual controls 
 
(
)
des,0
ref
ref
01
01
cos
V
V
c z
χ
χ
=
−
−
 
(11) 
 
ref
des,0
03
03
arcsin
,
2
2
c z
z
V
π
π
γ
γ
⎛
⎞
−
=
−
<
<
⎜
⎟
⎝
⎠

 
(12) 
 
where
01
0
c
>
and
03
0
c
>
are the control gains. The actual implementable virtual control 
signals
des
V
and
des
γ
, as well as their derivatives, 
des
V
and 
des
γ
, are obtained by filtering the 
virtual signals with a second-order low-pass filter. In this way, tedious calculation of the 
virtual control derivatives is avoided (Swaroop et al., 1997). An additional advantage is that 
the filters can be used to enforce magnitude or rate limits on the states (Farrell et al., 2003, 
2007). As an example, the state-space representation of such a filter for 
des,0
V
is given by 
 
( )
( )
(
)
2
1
2
des,0
2
1
2
2
2
V
V
V
R
M
V
V
q
q
t
q
t
S
S
V
q
q
ω
ζ ω
ζ ω
⎡
⎤
⎡
⎤
⎢
⎥
⎛
⎞
=
⎛
⎞
⎢
⎥
⎢
⎥
⎡
⎤
−
−
⎜
⎟
⎜
⎟
⎢
⎥
⎢
⎥
⎣
⎦
⎜
⎟
⎣
⎦
⎜
⎟
⎝
⎠
⎢
⎥
⎝
⎠
⎣
⎦


 
(13) 
 
des
1
des
2
V
q
q
V
⎡
⎤
⎡
⎤
=
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦

 
(14) 
where 
( )
M
S
⋅and 
( )
R
S
⋅represent the magnitude and rate limit functions as given in (Farrell 
et al., 2007). These functions enforce the state V to stay within the defined limits. Note that if 

 
Advances in Flight Control Systems 
 
28 
the signal 
des,0
V
is bounded, then
des
V
and
des
V
are also bounded and continuous signals. 
When the magnitude and rate limits are not in effect, the transfer function from 
des,0
V
to 
des
V
is given by 
 
des
2
des,0
2
2
2
V
V
V
V
V
V
s
ω
ζ ω
ω
=
+
+
 
(15) 
and the error
des,0
des
V
V
−
can be made arbitrarily small by selecting the bandwidth of the 
filter to be sufficiently large (Swaroop et al., 1997). 
3.2 Flight-path angle and airspeed control 
In this loop the objective is to steerV and γ to their desired values, as determined in the 
previous section. Furthermore, the heading angle χ has to track the reference signal
ref
χ
, and 
we also have to guarantee that
02
z
is regulated to zero. The available (virtual) controls in this 
step are the aerodynamic angles μ andα , as well as the thrustT . The lift, drag, and side 
forces are assumed to be unknown and will be estimated. Note that the aerodynamic forces 
also depend on the control-surface deflections
T
e
a
r
U
δ
δ
δ
= ⎡
⎤
⎣
⎦. These forces are quite 
small, because the surfaces are primarily moment generators. However, because the current 
control-surface deflections are available from the command filters used in the inner loop, we 
can still take them into account in the control design. The relevant equations of motion are 
given by 
 
(
)
(
)
( )
1
1
1
1
1
2
1
,
,
,
X
A F X U
B G
X U X
H
X
=
+
+

 
(16) 
where 
1
1
1
0
0
sin
cos
cos
0
0
1
cos
1
1
0
0
,
cos
sin
cos
,
0
0
cos
cos
cos
0
sin
0
0
0
1
cos
sin
sin
cos
V
g
V
T
A
H
B
mV
mV
mV
g
T
mV
V
γ
α
β
μ
α
β
μ
γ
γ
γ
μ
α
β
μ
γ
⎡
⎤
⎢
⎥
⎡
⎤
⎡
⎤
−
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
=
=
=
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
−
⎢
⎥
⎣
⎦
⎣
⎦
−
⎢
⎥
⎣
⎦
 
 
are known (matrix and vector) functions, and 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
1
,
,
,
,
sin
sin
,
,
sin
cos
T
L X U
F
Y X U
G
L X U
T
D X U
L X U
T
α
μ
α
μ
⎡
⎤
⎡
⎤
⎢
⎥
⎢
⎥
⎢
⎥
=
=
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
−
⎣
⎦
 
 
are functions containing the uncertain aerodynamic forces. Note that the intermediate 
control variablesα and μ do not appear affine in the
1
X subsystem, which complicates the 
design somewhat. Because the control objective in this step is to track the smooth reference 
signal
(
)
des
des
des
des
1
T
X
V
χ
γ
=
with
(
)
1
T
X
V
χ
γ
=
, the tracking errors are defined as 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
29 
 
11
des
1
12
1
1
13
z
Z
z
X
X
z
⎡
⎤
⎢
⎥
=
=
−
⎢
⎥
⎢
⎥
⎣
⎦
 
(17) 
To regulate
1
Z and
02
z
to zero, the following equation needs to be satisfied (Kanayama et al., 
1990): 
 
(
)
(
)
11
11
ref
des
1
1
2
02
02
12
12
1
1
1
1
13
13
ˆ
ˆ
,
,
sin
c z
B G
X U X
V
c z
c
z
A F
H
X
c z
−
⎡
⎤
⎢
⎥
= −
+
−
−
+
⎢
⎥
⎢
⎥
−
⎣
⎦

 
(18) 
where
1ˆF is the estimate of
1F and 
 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
2
0
0
ˆ
ˆ
ˆ
,
,
,
,
sin
sin
ˆ
ˆ
,
,
sin
cos
T
G
X U X
L
X U
L
X U
T
L
X U
L
X U
T
α
α
α
α
μ
α
α
μ
⎡
⎤
⎢
⎥
⎢
⎥
=
+
+
⎢
⎥
⎢
⎥
+
+
⎢
⎥
⎣
⎦
 
(19) 
with the estimate of the lift force decomposed as (
)
(
)
(
)
0
ˆ
ˆ
ˆ
,
,
,
L X U
L
X U
L
X U
α
α
=
+
 
The estimate of the aerodynamic forces
1ˆF is defined as 
 
(
)
1
1
1ˆ
ˆ
,
T
F
F
F
X U
= Φ
Θ
 
(20) 
where
1
T
F
Φ
is a known (chosen) regressor function and
1
ˆ
F
Θ
is a vector with unknown constant 
parameters. It is assumed that there exists a vector
1
F
Θ
such that 
 
(
)
1
1
1
,
T
F
F
F
X U
= Φ
Θ
 
(21) 
 
This means the estimation error can be defined as
1
1
1
ˆ
F
F
F
Θ
= Θ
−Θ

. We now need to determine 
the desired values
des
α
and
des
μ
. The right-hand side of Eq. (18) is entirely known, and so the 
left-hand side can be determined and the desired values can be extracted. This is done by 
introducing the coordinate transformation 
 
(
)
(
)
(
)
0ˆ
ˆ
,
,
sin
cos
x
L
X U
L
X U
T
α
α
α
μ
≡
+
+
 
(22) 
 
(
)
(
)
(
)
0ˆ
ˆ
,
,
sin
sin
y
L
X U
L
X U
T
α
α
α
μ
≡
+
+
 
(23) 
 
which can be seen as a transformation from the two-dimensional polar coordinates 
(
)
(
)
0ˆ
ˆ
,
,
sin
L
X U
L
X U
T
α
α
α
+
+
 
and μ to Cartesian coordinates x and y. The desired signals 
,0
0
0
T
des
T
y
x
⎡
⎤
⎣
⎦are given by 

 
Advances in Flight Control Systems 
 
30 
 
(
)
des,0
11
11
ref
des
1
0
02
02
12
12
1
1
1
1
0
13
13
ˆ
sin
T
c z
B
y
V
c z
c
z
A F
H
X
x
c z
⎡
⎤
−
⎡
⎤
⎢
⎥
⎢
⎥
= −
+
−
−
+
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
−
⎣
⎦
⎣
⎦

 
(24) 
Thus, the virtual control signals are equal to 
 
(
)
(
)
des,0
2
2
0
0
0
ˆ
ˆ
,
,
sin
L
X U
x
y
L
X U
T
α
α
α
=
+
−
−
 
(25) 
and 
 
(
)
(
)
(
)
0
0
0
0
0
0
0
des,0
0
0
0
0
0
0
0
0
arctan
/
if
0
arctan
/
if
0
and
0
arctan
/
if
0
and
0
/2
if
0
and
0
/2
if
0
and
0
y
x
x
y
x
x
y
y
x
x
y
x
y
x
y
π
μ
π
π
π
⎧
>
⎪
+
<
≥
⎪⎪
=
−
<
<
⎨
⎪
=
>
⎪
⎪
−
=
<
⎩
 
(26) 
Filtering the virtual signals to account for magnitude, rate, and bandwidth limits will give 
the implementable virtual controls
des
α
,
des
μ
and their derivatives. The sideslip-angle 
command was already defined as
ref
0
β
=
, and thus
des
des
des
2
0
T
X
μ
α
⎡
⎤
= ⎣
⎦and its derivative 
are completely defined. However, care must be taken because the desired virtual control 
des,0
μ
is undefined when both
0
x and
0
y are equal to zero, making the system momentarily 
uncontrollable. This sign change of
(
)
(
)
0ˆ
ˆ
,
,
sin
L
X U
L
X U
T
α
α
α
+
+
can only occur at very low 
or negative angles of attack. This situation was not encountered during the maneuvers 
simulated in this study. To solve the problem altogether, the designer could measure the 
rate of change for
0
x and
0
y and devise a rule base set to change sign when these terms 
approach zero. Furthermore, problems will also occur at high angles of attack when the 
control effectiveness term ˆLα will become smaller and eventually change sign. Possible 
solutions include limiting the angle-of-attack commands using the command filters or 
proper trajectory planning to avoid high-angle-of-attack maneuvers. Also note that so far in 
the control design process, we have not taken care of the update laws for the uncertain 
aerodynamic forces; they will be dealt with when the static control design is finalized. 
3.3 Aerodynamic angle control 
Now the reference signal
des
des
des
des
2
[
]T
X
μ
α
β
=
and its derivative have been found and 
we can move on to the next feedback loop. The available virtual controls in this step are the 
angular rates
3
X . The relevant equations of motion for this part of the design are given by 
 
(
)
( )
( )
2
2
1
2
3
2
,
X
A F X U
B
X X
H
X
=
+
+

 
(27) 
where 
2
2
cos
sin
0
tan
tan sin
tan cos
0
cos
cos
1
1
0
0 ,
cos
tan
1
sin
tan
cos
sin
0
cos
0
1
0
A
B
mV
α
α
β
γ
μ
γ
μ
β
β
α
β
α
β
β
α
α
⎡
⎤
⎡
⎤
+
⎢
⎥
⎢
⎥
⎢
⎥
−
⎢
⎥
=
= −
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎢
⎥
⎣
⎦
 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
31 
(
)
2
sin
tan sin
sin
tan
cos
sin
tan cos
tan
cos cos
1
sin
cos cos
cos
cos
cos
cos sin
g
T
V
g
H
T
mV
V
g
T
V
α
γ
μ
α
β
α
β
γ
μ
β
γ
μ
α
γ
μ
β
α
β
γ
μ
⎡
⎤
+
−
−
⎢
⎥
⎢
⎥
⎢
⎥
=
+
⎢
⎥
⎢
⎥
⎢
⎥
−
+
⎢
⎥
⎣
⎦
 
 
are known (matrix and vector) functions. The tracking errors are defined as 
 
des
2
2
2
Z
X
X
=
−
 
(28) 
To stabilize the
2
Z subsystem, a virtual feedback control
des,0
3
X
is defined as 
 
des,0
des
2
3
2
2
2
1
2
2
2
2
ˆ
,
0
T
B X
C Z
A F
H
X
C
C
= −
−
−
+
=
>

 
(29) 
 
The implementable virtual control (i.e., the reference signal for the inner loop)
des
3
X
and its 
derivative are again obtained by filtering the virtual control signal
des,0
3
X
with a second-order 
command-limiting filter. 
3.4 Angular rate control 
In the fourth step, an inner-loop feedback loop for the control of the body-axis angular rates 
3
T
X
p
q
r
= ⎡
⎤
⎣
⎦is constructed. The control inputs for the inner loop are the control-surface 
deflections
T
e
a
r
U
δ
δ
δ
= ⎡
⎤
⎣
⎦. The dynamics of the angular rates can be written as 
 
(
)
( )
(
)
( )
3
3
3
3
3
,
X
A
F X U
B
X U
H
X
=
+
+

 
(30) 
where 
(
)
(
)
(
)
1
2
3
4
2
2
3
7
3
5
6
4
9
8
2
0
0
0 ,
0
c r
c p q
c
c
A
c
H
c pr
c
p
r
c
c
c p
c r q
⎡
⎤
+
⎡
⎤
⎢
⎥
⎢
⎥
=
=
−
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
−
⎣
⎦
⎢
⎥
⎣
⎦
 
are known (matrix and vector) functions, and 
0
3
0
3
0
,
e
a
r
e
a
r
e
a
r
L
L
L
L
F
M
B
M
M
M
N
N
N
N
δ
δ
δ
δ
δ
δ
δ
δ
δ
⎡
⎤
⎡
⎤
⎢
⎥
⎢
⎥
=
=
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
 
are unknown (matrix and vector) functions that have to be approximated. Note that for a 
more convenient presentation, the aerodynamic moments have been decomposed: for 
example, 
 
(
)
(
)
0
,
,
e
a
r
e
a
r
M X U
M
X U
M
M
M
δ
δ
δ
δ
δ
δ
=
+
+
+
 
(31) 

 
Advances in Flight Control Systems 
 
32 
where the higher-order control-surface dependencies are still contained in
(
)
0
,
M
X U . The 
control objective in this feedback loop is to track the reference signal
des
ref
ref
ref
3
[
]T
X
p
q
r
=
 
with the angular rates
3
X . Defining the tracking errors 
 
des
3
3
3
Z
X
X
=
−
 
(32) 
and taking the derivatives results in 
 
(
)
( )
(
)
( )
des
3
3
3
3
3
3
,
Z
A
F X U
B
X U
H
X
X
=
+
+
−


 
(33) 
 
To stabilize the system of Eq. (33), we define the desired control
0
U as 
 
0
des
3
3
3
3
3
3
3
3
3
3
ˆ
ˆ
,
0
T
A B U
C Z
A F
H
X
C
C
= −
−
−
+
=
>

 
(34) 
 
where
3ˆF and
3ˆB are the estimates of the unknown nonlinear aerodynamic moment functions 
3F and
3
B , respectively. The F-16 model is not over-actuated (i.e., the
3
B matrix is square). If 
this is not the case, some form of control allocation would be required (Enns, 1998, Durham, 
1993). The estimates are defined as 
 
(
)
( )
3
3
3
3
3
3
ˆ
ˆ
ˆ
ˆ
,
,
,
for
1,
,3
i
i
i
T
T
F
F
B
B
F
X U
B
X
i
= Φ
Θ
= Φ
Θ
=
"
 
(35) 
 
where
3
T
F
Φ
and
3i
T
B
Φ
are the known regressor functions, 
3
ˆ
F
Θ
and
3
ˆ
i
B
Θ
are vectors with 
unknown constant parameters, and
3ˆ
i
B represents the ith column of
3ˆB . It is assumed that 
there exist vectors
3
F
Θ
and
3i
B
Θ
such that 
 
(
)
( )
3
3
3
3
3
3
,
,
i
i
i
T
T
F
F
B
B
F
X U
B
X
= Φ
Θ
= Φ
Θ
 
(36) 
 
This means that the estimation errors can be defined as
3
3
3
ˆ
F
F
F
Θ
= Θ
−Θ

and
3
3
3
ˆ
i
i
i
B
B
B
Θ
= Θ
−Θ

. 
The actual controlU is found by applying a filter similar to Eq. (13) to
0
U . 
3.5 Update laws and stability properties 
We have now finished the static part of our control design. In this section the stability 
properties of the control law are discussed and dynamic update laws for the unknown 
parameters are derived. Define the control Lyapunov function 
 
(
)
(
)
(
)
(
)
1
1
1
3
3
3
3
3
3
2
2
12
0
0
11
13
2
2
3
3
02
3
1
1
1
1
1
2
2cos
2
1 trace
trace
trace
2
i
i
i
T
T
T
T
T
T
F
F
F
F
F
F
B
B
B
i
z
V
Z Z
z
z
Z Z
Z Z
c
−
−
−
=
⎛
⎞
−
=
+
+
+
+
+
+
⎜
⎟
⎜
⎟
⎝
⎠
+
Θ Γ Θ
+
Θ Γ Θ
+
Θ
Γ
Θ
∑






 
(37) 
 
with the update gains matrices
1
1
3
3
0,
0
T
T
F
F
F
F
Γ
= Γ
>
Γ
= Γ
>
, and
3
3
0
i
i
T
B
B
Γ
= Γ
>
. Taking the 
derivative ofV along the trajectories of the closed-loop system gives 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
33 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
1
1
2
des,0
ref
2
des,0
01
01
02
01
01
02
01
12
03
03
03
2
ref
2
2
12
11
11
12
02
12
13
13
1
1
1
1
2
1
2
02
des,0
1
1
1
2
1
2
2
2
2
2
2
sin
sin
sin
ˆ
sin
sin
ˆ
ˆ
T
T
F
F
T
T
T
F
V
c z
z z
V
V
z
z
z
V
z
c z
V
z
c
c z
V
z z
z
c z
Z
A
B G
X
G
X
c
Z B G
X
G
X
Z C Z
Z A
χ
χ
γ
γ
= −
+
+
−
+
−
+
−
−
−
+
⎛
⎞
−
−
+
−
+
Φ Θ
+
−
+
⎜
⎟
⎜
⎟
⎝
⎠
+
−
−
+
Φ




(
)
(
)
1
3
3
3
3
1
1
1
3
3
3
3
3
3
des,0
2
2
3
3
3
3
3
3
0
1
1
3
3
3
3
3
1
3
1
1
ˆ
ˆ
ˆ
trace
trace
ˆ
trace
i
i
i
i
i
T
T
T
F
T
T
T
T
T
T
F
F
B
B
i
F
F
F
F
F
F
i
T
B
B
B
i
Z B
X
X
Z C Z
Z A
U
Z A B U
U
−
−
=
−
=
Θ
+
−
−
+
⎛
⎞
⎛
⎞
⎛
⎞
+
Φ Θ
+
Φ
Θ
+
−
−
Θ Γ Θ
−
Θ Γ Θ
+
⎜
⎟
⎜
⎟
⎜
⎟
⎝
⎠
⎝
⎠
⎝
⎠
⎛
⎞
−
Θ
Γ
Θ
⎜
⎟
⎝
⎠
∑
∑









(38) 
To cancel the terms in Eq. (38), depending on the estimation errors, we select the update 
laws 
 
(
)
(
)
1
1
1
3
3
3
3
3
3
3
1
1
2
2
3
3
3
3
ˆ
ˆ
ˆ
,
,
proj
i
i
i
i
T
T
T
T
F
F
F
a
F
F
F
B
B
B
B
i
A Z
A Z
A Z
A Z U
Θ
= Γ Φ
+
Θ
= Γ Φ
Θ
=
Γ
Φ



 
(39) 
with
(
)
(
)
(
)
1
1
1
1
1
1
1
1
2
1
2
ˆ
T
T
a
F
F
F
F
A
A
B G
X
G
X
Φ Θ
=
Φ Θ
+
−


 
The update laws for
3ˆB include a projection operator (Ioannou and Sun, 1995) to ensure that 
certain elements of the matrix do not change sign and full rank is maintained always. For 
most elements, the sign is known based on physical principles. Substituting the update laws 
in Eq. (38) leads to 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
2
2
2
ref
2
2
des,0
12
01
01
03
03
11
11
12
13
13
2
2
2
3
3
3
01
02
des,0
des,0
des,0
0
03
1
1
1
2
1
2
2
2
3
3
3
3
3
sin
ˆ
ˆ
sin
sin
T
T
T
T
T
c
V
c z
c z
c z
V
z
c z
Z C Z
Z C Z
V
V
z
c
V
z
Z B G
X
G
X
Z B
X
X
Z A B U
U
γ
γ
= −
−
−
−−
−
−
−
+
−
+
−
−
+
−
+
−
+
−

 (40) 
where the first line is already negative semi-definite, which we need to prove stability in the 
sense of Lyapunov. Because our Lyapunov function V equation (37) is not radially 
unbounded, we can only guarantee local asymptotic stability (Kanayama et al., 1990). This is 
sufficient for our operating area if we properly initialize the control law to 
ensure
12
/2
z
π
≤±
. However, we also have indefinite error terms due to the tracking errors 
and due to the command filters used in the design. As mentioned before, when no rate or 
magnitude limits are in effect, the difference between the input and output of the filters can 
be made small by selecting the bandwidth of the filters to be sufficiently larger than the 
bandwidth of the input signal. Also, when no limits are in effect and the small bounded 
difference between the input and output of the command filters is neglected, the feedback 
controller designed in the previous sections will converge the tracking errors to zero (for 
proof, see (Farrell et al.,  2005, Sonneveldt et al., 2007, Yip, 1997)). 
Naturally, when control or state limits are in effect, the system will in general not track the 
reference signal asymptotically. A problem with adaptive control is that this can lead to 
corruption of the parameter-estimation process, because the tracking errors that are driving 
this process are no longer caused by the function approximation errors alone (Farrell et al., 
2003). To solve this problem we will use a modified definition of the tracking errors in the 
update laws in which the effect of the magnitude and rate limits has been removed, as 
suggested in (Farrell et al., 2005, Sonneveldt et al., 2006). Define the modified tracking errors 

 
Advances in Flight Control Systems 
 
34 
 
1
1
1
2
2
2
3
3
3
,
,
Z
Z
Z
Z
Z
Z
=
−Ξ
=
−Ξ
=
−Ξ



 
(41) 
with the linear filters 
 
(
)
(
)
(
)
(
)
(
)
des,0
1
1
1
1
1
2
1
2
des,0
2
2
2
2
3
3
0
3
3
3
3
3
ˆ
ˆ
,
,
,
,
ˆ
C
B G
X U X
G
X U X
C
B
X
X
C
A B U
U
Ξ = −
Ξ +
−
Ξ = −
Ξ +
−
Ξ = −
Ξ +
−



 
(42) 
The modified errors will still converge to zero when the constraints are in effect, which 
means the robustified update laws look like 
 
(
)
(
)
1
1
1
3
3
3
3
3
3
3
1
1
2
2
3
3
3
3
ˆ
ˆ
ˆ
,
,
proj
i
i
i
i
T
T
T
T
F
F
F
a
F
F
F
B
B
B
B
i
A Z
A Z
A Z
A Z U
Θ
= Γ Φ
+
Θ
= Γ Φ
Θ
=
Γ
Φ



 
(43) 
To better illustrate the structure of the control system, a scheme of the adaptive inner-loop 
controller is shown in Fig. 2.  
4. Model identification 
To simplify the approximation of the unknown aerodynamic force and moment functions, 
thereby reducing computational load, the flight envelope is partitioned into multiple 
connecting operating regions called hyperboxes or clusters. This can be done manually 
using a priori knowledge of the nonlinearity of the system, automatically using nonlinear 
optimization algorithms that cluster the data into hyperplanar or hyperellipsoidal clusters 
(Babuška, 1998) or a combination of both. In each hyperbox a locally valid linear-in-the-
parameters nonlinear model is defined, which can be estimated using the update laws of the 
Lyapunov-based control laws. The aerodynamic model can be partitioned using different 
state variables, the choice of which depends on the expected nonlinearities of the system. In 
this study we use B-spline neural networks (Cheng et al., 1999, Ward et al., 2003) (i.e., radial 
basis function neural networks with B-spline basis functions) to interpolate between the 
local nonlinear models, ensuring smooth transitions. In the previous section we defined 
parameter update laws equation (43) for the unknown aerodynamic functions, which were 
written as 
 
(
)
(
)
( )
1
1
3
3
3
3
1
3
3
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
,
,
,
,
i
i
i
T
T
T
F
F
F
F
B
B
F
X U
F
X U
B
X
= Φ
Θ
= Φ
Θ
= Φ
Θ
 
(44) 
Now we will further define these unknown vectors and known regressor vectors. The total 
force approximations are defined as 
 
(
)
(
)
( )
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
0
0
0
ˆ
ˆ
ˆ
ˆ
ˆ
,
,
,
2
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
,
,
,
,
,
,
2
2
ˆ
ˆ
ˆ
,
,
,
q
e
p
r
a
r
e
L
L
e
L
L
e
Y
e
Y
Y
Y
a
Y
r
D
e
D
e
qc
L
qS C
C
C
C
V
pb
rb
Y
qS C
C
C
C
C
V
V
D
qS C
C
α
δ
δ
δ
δ
α β
β δ
α
α
α β δ
α β δ
α β
α β
α β δ
α β δ
α β δ
α β δ
⎛
⎞
=
+
+
+
⎜
⎟
⎝
⎠
⎛
⎞
=
+
+
+
+
⎜
⎟
⎝
⎠
=
+
 
(45) 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
35 
 
Fig. 2. Inner-loop control system 
and the moment approximations are defined as 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
( )
(
)
(
)
(
)
(
)
(
)
(
)
(
)
0
0
0
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
, ,
,
,
,
,
,
2
2
ˆ
ˆ
ˆ
ˆ
,
,
2
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
, ,
,
,
,
,
,
2
2
p
r
e
a
r
q
e
p
r
e
a
r
e
e
a
r
L
L
L
L
L
L
e
M
M
M
e
e
a
r
N
N
N
N
N
N
pb
rb
L
qS C
C
C
C
C
C
V
V
qc
M
qS C
C
C
V
pb
rb
N
qS C
C
C
C
C
C
V
V
δ
δ
δ
δ
δ
δ
δ
α β δ
α β
α β
α β δ
α β δ
α β δ
α β
α
α β δ
α β δ
α β
α β
α β δ
α β δ
α β δ
⎛
⎞
=
+
+
+
+
+
⎜
⎟
⎝
⎠
⎛
⎞
=
+
+
⎜
⎟
⎝
⎠
⎛
⎞
=
+
+
+
+
+
⎜
⎟
⎝
⎠
 (46) 
Note that these approximations do not account for asymmetric failures that will introduce 
coupling of the longitudinal and lateral motions of the aircraft. If a failure occurs that 
introduces a parameter dependency that is not included in the approximation, stability can 
no longer be guaranteed. It is possible to include extra cross-coupling terms, but this is 
beyond the scope of this paper. The total nonlinear function approximations are divided 
into simpler linear-in-the parameter nonlinear coefficient approximations: for example, 
 
(
)
(
)
0
0
0
ˆ
ˆ
,
,
L
L
T
L
C
C
C
α β
ϕ
α β θ
=
 
(47) 
where the unknown parameter vector
0
ˆ
L
C
θ
contains the network weights (i.e., the unknown 
parameters), and
0
L
C
ϕ
is a regressor vector containing the B-spline basis functions 
(Sonneveldt et al., 2007). All other coefficient estimates are defined in similar fashion. In this 
case a two-dimensional network is used with input nodes forα and β . Different scheduling 
parameters can be selected for each unknown coefficient. In this study we used third-order 
B-splines spaced 2.5 deg and one or more of the selected scheduling variablesα , β and 
eδ . 
Following the notation of Eq. (47), we can write the estimates of the aerodynamic forces and 
moments as 
 
(
)
(
)
(
)
(
)
(
)
(
)
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
,
,
,
,
,
,
,
,
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
,
,
,
,
,
,
,
,
T
T
T
L
e
L
Y
e
Y
D
e
D
T
T
T
e
e
e
L
L
M
M
N
N
L
Y
D
L
M
N
α β δ
α β δ
α β δ
α β δ
α β δ
α β δ
= Φ
Θ
= Φ
Θ
= Φ
Θ
= Φ
Θ
= Φ
Θ
= Φ
Θ
 
(48) 

 
Advances in Flight Control Systems 
 
36 
which is a notation equivalent to the one used in Eq. (44). Therefore, the update laws 
equation (43) can indeed be used to adapt the B-spline network weights. In practice 
nonparametric uncertainties such as 1) un-modeled structural vibrations 2) measurement 
noise, 3) computational round-off errors and sampling delays, and 4) time variations of the 
unknown parameters, can result in parameter drift. One approach to avoiding parameter 
drift taken here is to stop the adaptation process when the training error is very small (i.e. a 
dead zones (Babuška, 1998, Karason and Annaswamy, 1994)).  
5. Simulation results 
This section presents the simulation results from the application of the flight-path controller 
developed in the previous sections to the high-fidelity, six-degree-of-freedom F-16 model of 
Sec. 2. Both the control law and the aircraft model are written as C S-functions in 
MATLAB/Simulink. The simulations are performed at three different starting flight 
conditions with the trim conditions: 1) h= 5000 m, V= 200 m/s, and α=θ=2.774 deg; 2) h=0 m, 
V =250 m/s, and α=θ=2.406 deg; and 3) h= 2500 m, V= 150 m/s, and α=θ=0.447 deg; where h 
is the altitude of the aircraft, and all other trim states are equal to zero. 
Furthermore, two maneuvers are considered: 1) a climbing helical path and 2) a 
reconnaissance and surveillance maneuver. The latter maneuver involves turns in both 
directions and some altitude changes. The simulations of both maneuvers last 300 s. The 
reference trajectories are generated with second-order linear filters to ensure smooth 
trajectories. To evaluate the effectiveness of the online model identification, all maneuvers 
will also be performed with a ±30% deviation in all aerodynamic stability and control 
derivatives used by the controller (i.e., it is assumed that the onboard model is very 
inaccurate). Finally, the same maneuvers are also simulated with a lockup at ±10 deg of the 
left aileron. 
5.1 Control parameter tuning 
We start with the selection of the gains of the static control law and the bandwidths of the 
command filters. Lyapunov stability theory only requires the control gains to be larger than 
zero, but it is natural to select the largest gains of the inner loop. Larger gains will, of course, 
result in smaller tracking errors, but at the cost of more control effort. It is possible to derive 
certain performance bounds that can serve as guidelines for tuning (see, for example, Krstić, 
et al., 1993, Sonneveldt et al., 2007). However, getting the desired closed-loop response is 
still an extensive trial-and-error procedure. The control gains were selected as 
01
0.1
c
=
,  
5
02
10
c
−
=
, 
03
0.5
c
=
, 
11
0.01
c
=
, 
12
2.5
c
=
, 
13
0.5
c
=
, 
(
)
2
diag 1,1,1
C =
, 
(
)
3
diag 2,2,2
C =
. 
The bandwidths of the command filters for the actual control variables
eδ ,
a
δ , and
rδ are 
chosen to be equal to the bandwidths of the actuators, which are given in (Sonneveldt et al., 
2007). The outer-loop filters have the smallest bandwidths. The selection of the other 
bandwidths is again trial and error. A higher bandwidth in a certain feedback loop will 
result in more aggressive commands to the next feedback loop. All damping ratios are equal 
to 1.0. It is possible to add magnitude and rate limits to each of the filters. In this study 
magnitude limits on the aerodynamic roll angle μ and the flight-path angle γ are used to 
avoid singularities in the control laws. Rate and magnitude limits equal to those of the 
actuators are enforced on the actual control variables. 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
37 
The selected command-filter parameters can be found back in Table 1. As soon as the 
controller gains and command-filter parameters have been defined, the update law gains 
can be selected. Again, the theory only requires that the gains should be larger than zero. 
Larger update gains means higher learning rates and thus more rapid changes in the B-
spline network weights. 
5.2 Manoeuvre 1: upward spiral 
In this section the results of the numerical simulations of the first test maneuver, the 
climbing helical path, are discussed. For each of the three flight conditions, five cases are 
considered: nominal, the aerodynamic stability and control derivatives used in the control law 
perturbed with +30% and with -30% with respect to the real values of the model, a lockup of 
the left aileron at +10 deg, and a lockup at -10 deg. No actuator sensor information is used. In 
Fig. 3 the results are plotted of the simulation without uncertainty, starting at flight condition 
1. The maneuver involves a climbing spiral to the left with an increase in airspeed. It can be 
seen that the control law manages to track the reference signal very well and closed-loop 
tracking is achieved. The sideslip angle does not become any larger than ±0.02 deg. The 
aerodynamic roll angle does reach the limit set by the command filter, but this has no 
consequences for the performance. The use of dead zones ensures that the parameter update 
laws are indeed not updating during this maneuver without any uncertainties. The responses 
at the two other flight conditions are virtually the same, although less thrust is needed due to 
the lower altitude of flight condition 2 and the lower airspeed of flight condition 3. The other 
control surfaces are also more efficient. This is illustrated in Tables 2–4, in which the mean 
absolute values (MAVs) of the outer-loop tracking errors, control-surface deflections, and 
thrust can be found. Plots of the parameter-estimation errors are not included. However, the 
errors converge to constant values, but not to zero, as is common with Lyapunov-based 
update laws (Sonneveldt et al., 2007, Page and Steinberg, 1999). 
 
 
Table 1. Command-filter parameters 
 
 
Table 2. Manoeuvre 1 at flight condition 1: mean absolute value of tracking errors and 
control inputs 

 
Advances in Flight Control Systems 
 
38 
 
Table 3. Manoeuvre 1 at flight condition 2: mean absolute value of tracking errors and 
control inputs 
  
 
Table 4. Manoeuvre 1 at flight condition 3: mean absolute value of tracking errors and 
control inputs 
The response of the closed-loop system during the same maneuver starting at flight 
condition 1, but with +30% uncertainties in the aerodynamic coefficients, is shown in Fig. 4. 
It can be observed that the tracking errors of the outer loop are now much larger, but in the 
end, the steady-state tracking error converges to zero. The sideslip angle still remains within 
0.02 deg. Some small oscillations are visible in Fig. 4j, but these stay well within the rate and 
magnitude limits of the actuators. In Tables 2–4 the MAVs of the tracking errors and control 
inputs are shown for all flight conditions. As was already seen in the plots, the average 
tracking errors increase, but the magnitude of the control inputs stays approximately the 
same. The same simulations have been performed for a -30% perturbation in the stability 
and control derivatives used by the control law, and the results are also shown in the tables. 
It appears that underestimated initial values of the unknown parameters lead to larger 
tracking errors than overestimates for this maneuver. Finally, the maneuver is performed 
with the left aileron locked at ±10 deg [i.e., 
(
)
damaged
0.5
10
/180
a
a
δ
δ
π
=
±
]. Figure 5 shows the 
response at flight condition 3 with the aileron locked at -10 deg. 
Except for some small oscillations in the response of roll rate p, there is no real change in 
performance visible; this is confirmed by the numbers of Table 4. However, from Tables 2 
and 3 we observe that aileron and rudder deflections become larger with both locked aileron 
failure cases, whereas tracking performance hardly declines. 
5.3 Manoeuvre 2: reconnaissance 
The second maneuver, called reconnaissance and surveillance, involves turns in both 
directions and altitude changes, but airspeed is kept constant. Plots of the simulation at 
flight condition 3 with -30% uncertainties are shown in Fig. 6. Tracking performance is again 
excellent and the steady-state tracking errors converge to zero. There are some small 
oscillations in the rudder deflection, but these are within the limits of the actuator. We 
compare the MAVs of the tracking errors and control inputs with those for the nominal case 
in Table 5 and observe that the average tracking errors have not increased much for this 
case. The degradation of performance for the uncertainty cases is somewhat worse at the 
other two flight conditions, as can be seen in Tables 6 and 7. The sideslip angle always 
remains within 0.05 deg for all flight conditions and uncertainties. Corresponding with the 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
39 
results of maneuver 1, overestimation of the unknown parameters again leads to smaller 
tracking errors. Simulations of maneuver 2 with the locked aileron are also performed. 
Figure 7 shows the results for flight condition 1 with a locked aileron at _10 deg. Some very 
small oscillations are again visible in the roll rate, aileron, and rudder responses, but 
tracking performance is good and steady-state convergence is achieved. 
Table 6 confirms that the results of the simulations with actuator failure hardly differ from 
the nominal case. There is only a small increase in the use of the lateral control surfaces. The 
same holds at the other flight conditions, as can be seen in Tables 5 and 7. 
 
 
Table 5. Manoeuvre 2 at flight condition 3: mean absolute value of tracking errors and 
control inputs 
 
 
Table 6. Manoeuvre 2 at flight condition 1: mean absolute value of tracking errors and 
control inputs 
 
 
Table 7. Manoeuvre 2 at flight condition 2: mean absolute value of tracking errors and 
control inputs 
6. Conclusions 
In this paper a nonlinear adaptive flight-path control system is designed for a high-fidelity 
F-16 model. The controller is based on a backstepping approach with four feedback loops 
that are designed using a single control Lyapunov function to guarantee stability. The 
uncertain aerodynamic forces and moments of the aircraft are approximated online with B-
spline neural networks for which the weights are adapted by Lyapunov-based update laws. 
Numerical simulations of two test maneuvers were performed at several flight conditions to 
verify the performance of the control law. Actuator failures and uncertainties in the stability 
and control derivatives are introduced to evaluate the parameter-estimation process. The 
results show that trajectory control can still be accomplished with these uncertainties and 
failures, and good tracking performance is maintained. Compared with other Lyapunov-

 
Advances in Flight Control Systems 
 
40 
based trajectory control designs, the present approach is much simpler to apply and the 
online estimation process is more robust to saturation effects. Future studies will focus on 
the actual trajectory generation and the extension to formation-flying control. 
Appendix constraint adaptive backstepping 
Backstepping [21] is a systematic, Lyapunov-based method for nonlinear control design, 
which can be applied to nonlinear systems that can be transformed into lower-triangular 
form, such as the system of Eq. (A.1): 
 
(
)
(
)
1
1
1
2
x
f x
g x
x
=
+

 
(A.1) 
The name “backstepping” refers to the recursive nature of the control law design procedure. 
Using the backstepping procedure, a control law is recursively constructed, along with a 
control Lyapunov function (CLF) to guarantee global stability. For the system Eq. (A.1), the 
aim of the design procedure is to bring the state vector
1
x to the origin. The first step is to 
consider
2
x
 as the virtual control of the scalar
1
x subsystem and to find a desired virtual control 
law
(
)
1
1
x
α
that stabilizes this subsystem by using the control Lyapunov function
(
)
1
1
V
x
: 
 
(
)
2
1
1
1
1
2
V
x
x
=
 
(A.2) 
The time derivative of this CLF is negative definite 
 
(
)
(
)
(
)
(
)
(
)
1
1
1
1
1
1
1
1
1
1
0,
0
V
x
V
x
f x
g x
x
x
x
α
∂
⎡
⎤
=
+
<
≠
⎣
⎦
∂

 
(A.3) 
If only the virtual control law 
 
(
)
2
1
1
x
x
α
=
 
(A.4) 
could be satisfied. The key property of backstepping is that we can now “step back” through 
the system. If the error between
2
x and its desired value is defined as 
 
(
)
2
1
1
z
x
x
α
=
−
 
(A.5) 
the system Eq. (6) can be rewritten in terms of this error state 
 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
1
1
1
1
1
1
1
1
1
1
1
x
f x
g x
x
z
x
z
u
f x
g x
x
z
x
α
α
α
⎡
⎤
=
+
+
⎣
⎦
∂
⎡
⎤
=
−
+
+
⎣
⎦
∂


 
(A.6) 
The control Lyapunov function Eq. (A.2) can now be expanded with a term penalizing the 
error state z  
 
(
)
(
)
2
2
1
1
1
1
,
2
V
x z
V
x
z
=
+
 
(A.7) 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
41 
In simplified notation the time derivative of 
2
V is equal to 
 
(
)
(
)
(
)
1
1
2
1
1
1
1
1
1
1
1
1
1
1
1
V
V
f
g
z
z u
f
g
z
x
x
V
V
f
g
z
g
u
f
g
z
x
x
x
α
α
α
α
α
α
⎛
⎞
∂
∂
⎡
⎤
⎡
⎤
=
+
+
+
−
+
+
⎜
⎟
⎣
⎦
⎣
⎦
∂
∂
⎝
⎠
⎛
⎞
∂
∂
∂
⎡
⎤
=
+
+
+
−
+
+
⎡
⎤
⎜
⎟
⎣
⎦
⎣
⎦
∂
∂
∂
⎝
⎠

 
(A.8) 
which can be rendered negative definite with the control law 
 
(
)
1
1
1
1
1
,
0
V
u
cz
f
g
z
g
c
x
x
α
α
∂
∂
⎡
⎤
= −
+
+
+
−
>
⎣
⎦
∂
∂
 
(A.9) 
This design procedure can also be used for a system with a chain of integrators. The only 
difference is that there will be more virtual states to “backstep” through. Starting with the 
state “farthest” from the actual control, each step of the backstepping technique can be 
broken up into three parts: 1. Introduce a virtual control
1
α and an error state z , and rewrite 
the current state equation in terms of these; 2. choose a CLF for the system, treating it as a 
final stage; 3) choose an equation for the virtual control that makes the CLF stabilizable. 
The CLF is augmented at subsequent steps to reflect the presence of new virtual states, but 
the same three stages are followed at each step. Hence, backstepping is a recursive design 
procedure. 
For systems with parametric uncertainties there exists a method called adaptive 
backstepping (Kannelakopoulos et al., 1991), which achieves boundedness of the closed-
loop states and convergence of the tracking error to zero. 
Consider the parametric strict-feedback system 
 
(
)
(
)
( )
( )
1
2
1
1
1
1
1
1
,
,
T
T
n
n
n
n
T
n
n
x
x
x
x
x
x
x
x
x u
x
−
−
−
=
+
=
+
=
+

#
#
#

"

ϕ
θ
ϕ
θ
β
ϕ
θ
 
(A.10) 
where
( )
0
x
β
≠
for all
n
x ∈\ ,θ is a vector of unknown constant parameters, and
iϕ are 
known (smooth) function vectors. The control objective is to asymptotically track a given 
reference
( )
ry
t  with
1
x . All derivatives of 
( )
ry
t are assumed to be known. 
The adaptive backstepping design procedure is similar to the normal backstepping 
procedure, only this time a control law (static part) and a parameter update law (dynamic 
part) are designed along with a control Lyapunov function to guarantee global stability. The 
control law makes use of a parameter estimate ˆθ , which is constantly adapted by the 
dynamic parameter update law. Furthermore, the control Lyapunov function now contains 
an extra term that penalizes the parameter estimation error
ˆ
θ
θ
θ
=
−

. 
Theorem A.1 (Adaptive Backstepping Method): To stabilize the system Eq. (A.9) an error 
variable is introduced for each state 
 
(
)
1
1
i
i
i
r
i
z
x
y
α
−
−
=
−
−
 
(A.11) 
along with a virtual control law 

 
Advances in Flight Control Systems 
 
42 
(
)
(
)
(
)
( )
1
1
1
1
1
1
1
1
1
1
1
2
ˆ
ˆ
, ,
ˆ
ˆ
i
i
i
k
T
i
i
i
i
i
i
r
i
i
i
i
k
r
i
i
k
k
k
k
k
r
x
y
c z
z
x
y
z
x
y
−
−
−
−
−
−
−
−
+
−
=
=
⎛
⎞
∂
∂
∂
∂
= −
−
−
+
+
+
Γ
+
Γ
⎜
⎟
⎜
⎟
∂
∂
∂
∂
⎝
⎠
∑
∑
α
α
α
α
α
θ
ω θ
τ
ω
θ
θ
 (A.12) 
for
1,2,
,
i
n
=
"
, where the tuning function
iτ and the regressor vectors
i
ω are defined as 
 
(
)
(
)
1
1
ˆ
, ,
i
i
i
r
i
i
i
x
y
z
τ
θ
τ
ω
−
−
=
+
 
(A.13) 
and 
 
(
)
(
)
1
2
1
1
ˆ
, ,
i
i
i
i
i
r
i
k
k
k
x
y
x
−
−
−
=
∂
=
−
∂
∑
α
ω
θ
ϕ
ϕ  
(A.14) 
where
(
)
1
2
,
,
,
i
i
x
x x
x
=
"
,
( )
( )
(
)
,
,
,
i
i
ri
r
r
r
y
y y
y
=
 "
. 
0
ic >
are design constants. With these new 
variables the control and adaptation laws can be defined as 
 
( )
(
)
(
)
( )
1
1
ˆ
, ,
n
n
n
r
r
u
x
y
y
x
α
θ
β
−
⎡
⎤
=
+
⎢
⎥
⎣
⎦ 
(A.15) 
and 
 
(
)
(
)
1
ˆ
ˆ
, ,
n
n
r
x
y
Wz
θ
τ
θ
−
= Γ
= Γ

 
(A.16) 
where
0
T
Γ = Γ >
is the adaptation gain matrix and W the regressor matrix 
 
(
)
(
)
1
ˆ
,
,
,
i
W z θ
ω
ω
=
"
 
(A.17) 
The control law Eq. (A.15) together with the update law Eq. (A.17) renders the derivative of 
the Lyapunov function 
 
2
1
1
1
1
2
2
n
T
i
i
V
z
θ
θ
−
=
=
+
Γ
∑

  
(A.18) 
negative definite and thus this adaptive controller guarantees global boundedness of ( )
x t  
and asymptotically tracking of a given reference 
( )
ry
t with
1
x . 
Proof of this theorem can be found in Sec. 4.3 of (Krstić et al., 1992). 
The standard adaptive backstepping procedure as has been discussed so far has a number of 
drawbacks. 
1. 
The analytic calculation of the virtual control derivatives is tedious, especially for large 
systems; 
2. 
The procedure can only handle systems that can be transformed into a lower-triangular 
form; 
3. 
Constraints on the inputs and states are not taken into account. 
The third drawback can be a major problem when designing for flight control, because the 
actuators of an aircraft have rate, bandwidth, and magnitude constraints. When the control 
signal demanded by the backstepping controller cannot be generated by the actuators, that 
is, the actuators saturate, stability can no longer be guaranteed. The problem becomes worse 
 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
43 
 
 
Fig. 3. Manoeuvre 1: climbing helical path performed at flight condition 1 without any 
uncertainty or actuator failures 

 
Advances in Flight Control Systems 
 
44 
 
 
 
Fig. 4. Manoeuvre 1: climbing helical path performed at flight condition 2 with +30% 
uncertainties in the aerodynamic coefficients 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
45 
 
 
 
Fig. 5. Manoeuvre 1: climbing helical path performed at flight condition 3 with left aileron 
locked at -10 deg 

 
Advances in Flight Control Systems 
 
46 
 
 
 
Fig. 6. Manoeuvre 2: reconnaissance and surveillance performance at flight condition 3 with 
-30% uncertainties in the aerodynamic coefficients 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
47 
 
 
 
Fig. 7. Manoeuvre 2: reconnaissance and surveillance performance at flight condition 1 with 
left aileron locked at +10 deg. 

 
Advances in Flight Control Systems 
 
48 
when online parameter update laws are used, because these tend to be aggressive while 
seeking the desired tracking performance. Because the desired control signal is not achieved 
during saturation, the tracking error will increase. Because this tracking error is not just the 
result from the parameter estimation error, the update law may “unlearn” during these 
saturation periods. 
In (Farrell et al., 2003, 2005) a method is proposed that fits within the recursive adaptive 
backstepping design procedure and deals with the constraints on both the control variables 
and the intermediate states used as virtual controls.An additional advantage of the method 
is that it also eliminates the two other drawbacks of the adaptive backstepping method, that 
is, the time consuming analytic computation of virtual control signal derivatives and the 
restriction to nonlinear systems of a lower-triangular form. 
The proposed method extends the adaptive backstepping framework in two ways. 
1. Command filters are used to eliminate the analytic computation of the time derivatives of 
the virtual controls. The command filters are designed as linear, stable, low-pass filters with 
unity gain from its input to its output. The inputs of these filters are the desired (virtual) 
control signals and the outputs are the actual (virtual) control signal and its time derivative. 
Using command filters to calculate the virtual control derivatives, it is still possible to prove 
stability in the sense of Lyapunov in the absence of constraints on the control input and state 
variables. 
2. A stable parameter estimation process is ensured even when constraints on the control 
variables and states are in effect. During these periods the tracking error may increase 
because the desired control signal cannot be implemented due to these constraints imposed 
on the system. In this case the desired response is too aggressive for the system to be feasible 
and the primary goal is to maintain stability of the online function approximation. The 
command filters keep the control signal and the state variables within their mechanical 
constraints and operating limits, respectively. The effect these constraints have on the 
tracking errors can be estimated and this effect can be implemented in modified tracking 
error definitions. These modified tracking errors are only the result of parameter estimation 
errors as the effect of the constraints on the control input and state variables has been 
removed. These modified tracking errors can thus be used by the parameter update laws to 
ensure a stable estimation process. 
The command filtered adaptive backstepping approach is summarized in the following 
theorem. 
Theorem A.2 (Constrained Adaptive Backstepping Method): For the parameter strict-
feedback system Eq. (15) the tracking errors are again defined as 
 
(
)
1
1
i
i
i
r
i
z
x
y
α
−
−
=
−
−
 
(A.19) 
for
1,2,
,
i
n
=
"
. The nominal or desired virtual control laws can be defined as 
 
0
1
1
1
ˆ
,
1,2,
,
1
T
i
i
i
i
i
i
c z
z
i
n
−
−
+
= −
−
−
+ +
−
=
−

"
α
ϕ θ
α
χ
 
(A20) 
where 
 
1
,
1,2,
,
i
i
i
z
z
i
n
χ
−=
−
=
"
 
(A.21) 
are the modified tracking errors and where 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
49 
 
(
)
0 ,
1,2,
,
1
i
i
i
i
i
c
i
n
χ
χ
α
α
= −
+
−
=
−

"
 
(A.22) 
are the filtered versions of the effect of the state constraints on the tracking errors
iz . The 
nominal virtual control signals
0
i
α are filtered to produce the magnitude, rate, and 
bandwidth limited virtual control signals
i
α and its derivatives
i
α that satisfy the limits 
imposed on the state variables. This command filter can for instance be chosen as (Farrell et 
al., 2005) 
 
(
)
2
1
1
2
0
2
2
1
2
,
2
2
i
n
i
n
R
M
i
n
q
q
q
q
q
S
S
q
q
α
ω
α
ζω
α
ζω
⎡
⎤
⎢
⎥
⎡
⎤
⎡
⎤
⎡
⎤
⎡
⎤
=
=
⎛
⎞
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎡
⎤
−
−
⎢
⎥
⎜
⎟
⎣
⎦
⎣
⎦
⎣
⎦
⎢
⎥
⎜
⎟
⎣
⎦
⎢
⎥
⎝
⎠
⎢
⎥
⎣
⎦
⎣
⎦



 
(A.23) 
where 
( )
M
S
⋅ and
( )
R
S
⋅represent the magnitude and rate limit functions, respectively. These 
saturation functions are defined similarly as 
( )
if
if
if
M
M
x
M
S
x
x
x
M
M
x
M
≥
⎧
⎪
=
<
⎨
⎪−
≤
−
⎩
 
The effect of implementing the achievable virtual control signals instead of the desired ones 
is estimated by the
iχ filters. With these filters the modified tracking errors
iz can be defined. 
It can be seen from Eq. (A.21) that when the limitations on the states are not in effect the 
modified tracking error converges to the tracking error. The nominal control law is defined 
in a similar way as 
 
( )
( )
(
)
0
1
1
1
ˆ
n
T
n
n
n
n
n
r
u
c z
z
y
x
ϕ θ
α
β
−
−
=
−
−
−
+
+

 
(A.24) 
which is again filtered to generate the magnitude, rate, and bandwidth limited control signal 
u. The effect of implementing the limited control law instead of the desired one can again be 
estimated with 
 
(
)
0
n
n
n
c
u
u
χ
χ
β
= −
+
−

 
(A.25) 
Finally, the update law that now uses the modified tracking errors is defined as 
 
1
ˆ
n
i
i
i
z
θ
ϕ
=
= Γ∑

 
(A.26) 
The resulting control law will render the derivative of the control Lyapunov function 
 
2
1
1
1
1
2
2
n
T
i
i
V
z
θ
θ
−
=
=
+
Γ
∑

  
(A.27) 
negative definite, which means that the closed-loop system is asymptotically stable. 
 

 
Advances in Flight Control Systems 
 
50 
7. References 
Clough, B. T. (2005), “Unmanned Aerial Vehicles: Autonomous Control Challenges, a 
Researchers Perspective,” Journal of Aerospace Computing, Information, and 
Communication, Vol. 2, No. 8, pp. 327–347, doi: 10.2514/1.5588. 
Wegener, S., Sullivan, D., Frank, J., and Enomoto, F. (2004), “UAV Autonomous Operations 
for Airborne Science Missions,” AIAA 3rd “Unmanned Unlimited” Technical 
Conference, Workshop and Exhibit, AIAA Paper 2004-6416. 
Papadales, B., and Downing, M. (2005), “UAV Science Missions: A Business Perspective,” 
Infotech@Aerospace, AIAA Paper 2005-6922. 
Tsach, S., Chemla, J., and Penn, D. (2003), “UAV Systems Development in IAI-Past, Present 
and Future,” 2nd AIAA “Unmanned Unlimited” Systems, Technologies, and 
Operations-Aerospace Land, and Sea Conference, AIAA Paper 2003–6535. 
Kaminer, I., Pascoal, A., Hallberg, E., and Silvestre, C. (1998), “Trajectory Tracking for 
Autonomous Vehicles: An Integrated Approach to Guidance and Control,” Journal 
of Guidance, Control, and Dynamics, Vol. 21, No. 1, pp. 29–38, doi:10.2514/2.4229. 
Boyle, D. P., and Chamitof, G. E. (1999), “Autonomous Maneuver Tracking for Self-Piloted 
Vehicles,” Journal of Guidance, Control, and Dynamics, Vol. 22, No. 1, pp. 58–67, 
doi: 10.2514/2.4371. 
Singh, S. N., Steinberg, M. L., and Page, A. B. (2003), “Nonlinear Adaptive and Sliding Mode 
Flight Path Control of F/A-18 Model,” IEEE Transactions on Aerospace and 
Electronic Systems, Vol. 39, No. 4, pp. 1250–1262, doi: 10.1109/TAES.2003.1261125. 
Ren, W., and Beard, R. W. (2004), “Trajectory Tracking for Unmanned Air Vehicles with 
Velocity and Heading Rate Constraints,” IEEE Transactions on Control Systems 
Technology, Vol. 12, No. 5, pp. 706–716, doi:10.1109/TCST.2004.826956. 
Ren, W., and Atkins, E. (2005), “Nonlinear Trajectory Tracking for Fixed Wing UAVs via 
Backstepping and Parameter Adaptation,” AIAA Guidance, Navigation, and 
Control Conference and Exhibit, AIAA Paper 2005-6196. 
No, T. S., Min, B. M., Stone, R. H., and K. C. Wong, J. E. (2005), “Control and Simulation of 
Arbitrary Flight Trajectory-Tracking,” Control Engineering Practice, Vol. 13, No. 5, 
pp. 601–612, doi:10.1016/j.conengprac.2004.05.002. 
Kaminer, I., Yakimenko, O., Dobrokhodov, V., Pascoal, A., Hovakimyan, N., Cao, C., Young, 
A., and Patel, V. (2007), “Coordinated Path Following for Time-Critical Missions of 
Multiple UAVs via L1 Adaptive Output Feedback Controllers,” AIAA Guidance, 
Navigation, and Control Conference and Exhibit, AIAA Paper 2007-6409. 
Pachter, M., D’Azzo, J. J., and J. L. Dargan (1994), “Automatic Formation Flight Control,” 
Journal of Guidance, Control, and Dynamics, Vol. 17, No. 6, pp. 1380–1383. 
Proud, A. W., Pachter, M., and D’Azzo, J. J. (1999), “Close Formation Flight Control,”AIAA 
Guidance, Navigation, and Control Conference, AIAA Paper 1999-4207. 
Fujimori, A., Kurozumi, M., Nikiforuk, P. N., and Gupta, M. M. (2000), “Flight Control 
Design of an Automatic Landing Flight Experiment Vehicle,” Journal of Guidance, 
Control, and Dynamics, Vol. 23, No. 2, pp. 373–376, doi:10.2514/2.4536. 
Singh, S. N., Chandler, P., Schumacher, C., Banda, S., and Pachter, M. (2000), “Adaptive 
Feedback Linearizing Nonlinear Close Formation Control of UAVs,” American 
Control Conference, Inst. of Electrical and Electronics Engineers, Piscataway, NJ, 
pp. 854–858. 
www.ebook3000.com

Adaptive Backstepping Flight Control for Modern Fighter Aircraft   
 
51 
Pachter, M., D’Azzo, J. J., and Proud, A. W. (2001), “Tight Formation Control,” Journal of 
Guidance, Control, and Dynamics, Vol. 24, No. 2, pp. 246–254, doi:10.2514/2.4735. 
Wang, J., Patel, V., Cao, C., Hovakimyan, N., and Lavretsky, E. (2008), “Novel L1 Adaptive 
Control 
Methodology 
for 
Aerial 
Refueling 
with 
Guaranteed 
Transient 
Performance,” Journal of Guidance, Control, and Dynamics, Vol. 31, No. 1, pp. 182–
193, doi:10.2514/1.31199. 
Healy, A., and Liebard, D. (1993), “Multivariable Sliding Mode Control for Autonomous 
Diving and Steering of Unmanned Underwater Vehicles,” IEEE Journal of Oceanic 
Engineering, Vol. 18, No. 3, pp. 327–339, doi:10.1109/JOE.1993.236372. 
Narasimhan, M., Dong, H., Mittal, R., and Singh, S. N. (2006), “Optimal Yaw Regulation and 
Trajectory Control of Biorobotic AUV Using Mechanical Fins Based on CFD 
Parametrization,” Journal of Fluids Engineering, Vol. 128, No. 4, pp. 687–698, 
doi:10.1115/1.2201634. 
Kannelakopoulos, I., Kokotović, P. V., and Morse, A. S. (1991), “Systematic Design of 
Adaptive Controllers for Feedback Linearizable Systems,” IEEE Transactions on 
Automatic Control, Vol. 36, No. 11, pp. 1241–1253, doi:10.1109/9.100933. 
Krstić, M., Kanellakopoulos, I., and Kokotović, P. V. (1992), “Adaptive Nonlinear Control 
Without Overparametrization,” Systems and Control Letters, Vol. 19, pp. 177–185, 
doi:10.1016/0167-6911(92)90111-5. 
Singh, S. N., and Steinberg, M. (1996), “Adaptive Control of Feedback Linearizable 
Nonlinear Systems With Application to Flight Control,” AIAA Guidance, 
Navigation, and Control Conference, AIAA Paper 1996-3771. 
Härkegård, O. (2003), “Backstepping and Control Allocation with Applications to Flight 
Control,” Ph.D. Thesis, Linköping Univ., Linköping, Sweden. 
Farrell, J., Polycarpou, M., and Sharma, M. (2003), “Adaptive Backstepping with Magnitude, 
Rate, and Bandwidth Constraints: Aircraft Longitude Control,” American Control 
Conference, American Control Conference Council, Evanston, IL, pp. 3898–3903. 
Kim, S. H., Kim, Y. S., and Song, C. (2004), “A Robust Adaptive Nonlinear Control 
Approach to Missile Autopilot Design,” Control Engineering Practice, Vol. 12, No. 
2, pp. 149–154, doi:10.1016/S0967-0661(03)00016-9. 
Shin, D. H., and Kim, Y. (2004), “Reconfigurable Flight Control System Design Using 
Adaptive Neural Networks,” IEEE Transactions on Control Systems Technology, 
Vol. 12, No. 1, pp. 87–100, doi:10.1109/TCST.2003.821957. 
Farrell, J., Sharma, M., and Polycarpou, M. (2005), “Backstepping Based Flight Control with 
Adaptive Function Approximation,” Journal of Guidance, Control, and Dynamics, 
Vol. 28, No. 6, pp. 1089–1102, doi:10.2514/1.13030. 
Sonneveldt, L., Chu, Q. P., and Mulder, J. A. (2006), “Constrained Adaptive Backstepping 
Flight Control: Application to a Nonlinear F-16/MATV Model,” AIAA Guidance, 
Navigation, and Control Conference and Exhibit, AIAA Paper 2006-6413. 
Sonneveldt, L., Chu, Q. P., and Mulder, J. A. (2007), “Nonlinear Flight Control Design Using 
Constrained Adaptive Backstepping,” Journal of Guidance, Control, and Dynamics, 
Vol. 30, No. 2, pp. 322–336, doi:10.2514/1.25834. 
Yip, P.-C. P. (1997), “Robust and Adaptive Nonlinear Control Using Dynamic Surface 
Controller with Applications to Intelligent Vehicle Highway Systems,” Ph.D. 
Thesis, Univ. of California at Berkeley, Berkeley, CA. 

 
Advances in Flight Control Systems 
 
52 
Cheng, K. W. E., Wang, H., and Sutanto, D. (1999), “Adaptive B-Spline Network Control for 
Three-Phase PWM AC-DC Voltage Source Converter,” IEEE 1999 International 
Conference on Power Electronics and Drive Systems, Inst. of Electrical and 
Electronics Engineers, Piscataway, NJ, pp. 467–472. 
Ward, D. G., Sharma, M., Richards, N. D., and Mears, M. (2003), “Intelligent Control of Un-
Manned Air Vehicles: Program Summary and Representative Results,” 2nd AIAA 
Unmanned Unlimited Systems, Technologies and Operations Aerospace, Land and 
Sea, AIAA Paper 2003-6641. 
Nguyen, L. T., Ogburn, M. E., Gilbert, W. P., Kibler, K. S., Brown, P. W., and Deal, P. L. 
(1979), “Simulator Study of Stall Post-Stall Characteristics of a Fighter Airplane 
with Relaxed Longitudinal Static Stability,” NASA Langley Research Center, 
Hampton, VA. 
Lewis, B. L., and Stevens, F. L. (1992), Aircraft Control and Simulation, Wiley, New York, 
pp. 1–54, 110–115. 
Cook, M. V. (1997), Flight Dynamics Principles, Butterworth-Heinemann, London, pp. 11–
29. 
Swaroop, D., Gerdes, J. C., Yip, P. P., and Hedrick, J. K. (1997), “Dynamic Surface Control of 
Nonlinear Systems,” Proceedings of the American Control Conference. 
Kanayama, Y. J., Kimura, Y., Miyazaki, F., and Noguchi, T. (1990), “A Stable Tracking 
Control Method for an Autonomous Mobile Robot,” IEEE International Conference 
on Robotics and Automation, Inst. of Electrical and Electronics Engineers, 
Piscataway, NJ, pp. 384–389. 
Enns, D. F. (1998), “Control Allocation Approaches,” AIAA Guidance, Navigation, and 
Control Conference and Exhibit, AIAA Paper 1998-4109. 
Durham, W. C. (1993), “Constrained Control Allocation,” Journal of Guidance, Control, and 
Dynamics, Vol. 16, No. 4, pp. 717–725, doi:10.2514/3.21072. 
Ioannou, P. A., and Sun, J. (1995), Stable and Robust Adaptive Control, Prentice–Hall, 
Englewood Cliffs, NJ, pp. 555–575. 
Babuška, R. (1998), Fuzzy Modeling for Control, Kluwer Academic, Norwell, MA, pp. 49–52. 
Karason, S. P., and Annaswamy, A. M. (1994), “Adaptive Control in the Presence of Input 
Constraints,” IEEE Transactions on Automatic Control, Vol. 39, No. 11, pp. 2325–
2330, doi:10.1109/9.333787. 
Krstić, M., Kokotović, P. V., and Kanellakopoulos, I. (1993), “Transient Performance 
Improvement with a New Class of Adaptive Controllers,” Systems and Control 
Letters, Vol. 21, No. 6, pp. 451–461, doi:10.1016/0167-6911(93)90050-G. 
Sonneveldt, L., van Oort, E. R., Chu, Q. P., and Mulder, J. A. (2007), “Comparison of Inverse 
Optimal and Tuning Functions Designs for Adaptive Missile Control,”  
AIAA Guidance, Navigation, and Control Conference and Exhibit, AIAA Paper 
2007-6675. 
Page, A. B., and Steinberg, M. L. (1999), “Effects of Control Allocation Algorithms on a 
Nonlinear Adaptive Design,” AIAA Guidance, Navigation, and Control 
Conference and Exhibit, AIAA, Reston, VA, pp. 1664–1674; also AIAA Paper 1999-
4282. 
www.ebook3000.com

Nhan Nguyen
NASA Ames Research Center
United States of America
1. Introduction
Adaptive ﬂight control is a potentially promising technology that can improve aircraft stability
and maneuverability. In recent years, adaptive control has been receiving a signiﬁcant amount
of attention. In aerospace applications, adaptive control has been demonstrated in many ﬂight
vehicles. For example, NASA has conducted a ﬂight test of a neural net intelligent ﬂight
control system on board a modiﬁed F-15 test aircraft (Bosworth & Williams-Hayes, 2007).
The U.S. Air Force and Boeing have developed a direct adaptive controller for the Joint
Direct Attack Munitions (JDAM) (Sharma et al., 2006). The ability to accommodate system
uncertainties and to improve fault tolerance of a ﬂight control system is a major selling
point of adaptive control since traditional gain-scheduling control methods are viewed as
being less capable of handling off-nominal ﬂight conditions outside a normal ﬂight envelope.
Nonetheless, gain-scheduling control methods are robust to disturbances and unmodeled
dynamics when an aircraft is operated as intended.
In spite of recent advances in adaptive control research and the potential beneﬁts of
adaptive control systems for enhancing ﬂight safety in adverse conditions, there are several
challenges related to the implementation of adaptive control technologies in ﬂight vehicles
to accommodate system uncertainties. These challenges include but are not limited to: 1)
robustness in the presence of unmodeled dynamics and exogenous disturbances (Rohrs et al.,
1985); 2) quantiﬁcation of performance and stability metrics of adaptive control as related to
adaptive gain and input signals; 3) adaptation in the presence of actuator rate and position
limits; 4) cross-coupling between longitudinal and lateral-directional axes due to failures,
damage, and different rates of adaptation in each axis; and 5) on-line reconﬁguration and
control reallocation using non-traditional control effectors such as engines with different rate
limits.
The lack of a formal certiﬁcation process for adaptive control systems poses a major hurdle
to the implementation of adaptive control in future aerospace systems (Jacklin et al., 2005;
Nguyen & Jacklin, 2010). This hurdle can be traced to the lack of well-deﬁned performance
and stability metrics for adaptive control that can be used for the veriﬁcation and validation
of adaptive control systems. Recent studies by a number of authors have attempted to address
metric evaluation for adaptive control systems (Annaswamy et al., 2008; Nguyen et al., 2007;
Stepanyan et al., 2009; Yang et al., 2009). Thus, the development of veriﬁable metrics for
 
Hybrid Adaptive Flight Control with 
Model Inversion Adaptation 
3

adaptive control will be important in order to mature adaptive control technologies in the
future.
Over the past several years, various model-reference adaptive control (MRAC) methods have
been investigated (Cao & Hovakimyan, 2008; Eberhart & Ward, 1999; Hovakimyan et al., 2001;
Johnson et al., 2000; Kim & Calise, 1997; Lavretsky, 2009; Nguyen et al., 2008; Rysdyk & Calise,
1998; Steinberg, 1999). The majority of MRAC methods may be classiﬁed as direct, indirect,
or a combination thereof. Indirect adaptive control methods are based on identiﬁcation
of unknown plant parameters and certainty-equivalence control schemes derived from the
parameter estimates which are assumed to be their true values (Ioannu & Sun, 1996).
Parameter identiﬁcation techniques such as recursive least-squares and neural networks have
been used in many indirect adaptive control methods (Eberhart & Ward, 1999). In contrast,
direct adaptive control methods adjust control parameters to account for system uncertainties
directly without identifying unknown plant parameters explicitly. MRAC methods based on
neural networks have been a topic of great research interest (Johnson et al., 2000; Kim & Calise,
1997; Rysdyk & Calise, 1998). Feedforward neural networks are capable of approximating a
generic class of nonlinear functions on a compact domain within arbitrary tolerance (Cybenko,
1989), thus making them suitable for adaptive control applications. In particular, Rysdyk
and Calise described a neural net direct adaptive control method for improving tracking
performance based on a model inversion control architecture (Rysdyk & Calise, 1998). This
method is the basis for the intelligent ﬂight control system that has been developed for the
F-15 test aircraft by NASA. Johnson et al. introduced a pseudo-control hedging approach for
dealing with control input characteristics such as actuator saturation, rate limit, and linear
input dynamics (Johnson et al., 2000). Hovakimyan et al. developed an output feedback
adaptive control to address issues with parametric uncertainties and unmodeled dynamics
(Hovakimyan et al., 2001). Cao and Hovakimyan developed an L1 adaptive control method
to address high-gain control (Cao & Hovakimyan, 2008). Nguyen developed an optimal
control modiﬁcation scheme for adaptive control to improve stability robustness under fast
adaptation (Nguyen et al., 2008).
While adaptive control has been used with success in many applications, the possibility of
high-gain control due to fast adaptation can be an issue. In certain applications, fast adaptation
is needed in order to improve the tracking performance rapidly when a system is subject to
large uncertainties such as structural damage to an aircraft that could cause large changes
in aerodynamic characteristics. In these situations, large adaptive gains can be used for
adaptation in order to reduce the tracking error quickly. However, there typically exists a
balance between stability and fast adaptation. It is well known that high-gain control or fast
adaptation can result in high frequency oscillations which can excite unmodeled dynamics
that could adversely affect stability of an MRAC law (Ioannu & Sun, 1996). Recognizing
this, some recent adaptive control methods have begun to address fast adaptation. One such
method is the L1 adaptive control (Cao & Hovakimyan, 2008) which uses a low-pass ﬁlter
to effectively ﬁlter out any high frequency oscillation that may occur due to fast adaptation.
Another approach is the optimal control modiﬁcation that can enable fast adaptation while
maintaining stability robustness (Nguyen et al., 2008).
This study investigates a hybrid adaptive ﬂight control method as another possibility to
reduce the effect of high-gain control (Nguyen et al., 2006). The hybrid adaptive control blends
both direct and indirect adaptive control in a model inversion ﬂight control architecture.
The blending of both direct and indirect adaptive control is sometimes known as composite
adaptation (Ioannu & Sun, 1996). The indirect adaptive control is used to update the model
54
Advances in Flight Control Systems
www.ebook3000.com

inversion controller by two parameter estimation techniques: 1) an indirect adaptive law
based on the Lyapunov theory, and 2) a recursive least-squares indirect adaptive law. The
model inversion controller generates a command signal using estimates of the unknown
plant dynamics to reduce the model inversion error. This directly leads to a reduced tracking
error. Any residual tracking error can then be further reduced by a direct adaptive control
which generates an augmented reference command signal based on the residual tracking
error. Because the direct adaptive control only needs to adapt to a residual uncertainty, its
adaptive gain can be reduced in order to improve stability robustness. Simulations of the
hybrid adaptive control for a damaged generic transport aircraft and a pilot-in-the-loop ﬂight
simulator study show that the proposed method is quite effective in providing improved
command tracking performance for a ﬂight control system.
2. Hybrid adaptive ﬂight control
Consider a rate-command-attitude-hold (RCAH) inner loop ﬂight control design. The
objective of the study is to design an adaptive law that allows an aircraft rate response to
accurately follow a rate command. Assuming that the airspeed is regulated by the engine
thrust, then the rate equation for an aircraft can be written as
˙ω = ˙ω∗+ Δ ˙ω
(1)
where ω =

p q r
⊤is the inner loop angular rate vector, Δ ˙ω is the uncertainty in the plant
model which can include nonlinear effects, and ˙ω∗is the nominal plant model where
˙ω∗= F∗
1 ω + F∗
2 σ + G∗δ
(2)
with F∗
1 , F∗
2 , G∗∈R3×3 as nominal state transition and control sensitivity matrices which
are assumed to be known, σ =

Δφ Δα Δβ
⊤is the outer loop attitude vector which has
slower dynamics than the inner loop rate dynamics, and δ =

Δδa Δδe Δδr
⊤is the actuator
command vector to ﬂight control surfaces.
Fig. 1. Hybrid Adaptive Flight Control Architecture
Figure 1 illustrates the proposed hybrid adaptive ﬂight control. The control architecture
comprises: 1) a reference model that translates a rate command into a desired acceleration
command, 2) a proportional-integral (PI) feedback control for rate stabilization and tracking,
55
Hybrid Adaptive Flight Control with Model Inversion Adaptation

3) a model inversion controller that computes the actuator command using the desired
acceleration command, 4) a neural net direct adaptive control augmentation, and 5) an
indirect adaptive control that adjusts the model inversion controller to match the actual plant
dynamics. The tracking error between the reference trajectory and the aircraft state is ﬁrst
reduced by the model inversion indirect adaptation. The neural net direct adaptation then
further reduces the tracking error by estimating an augmented acceleration command to
compensate for the residual tracking error. Without the model inversion indirect adaptation,
the possibility of a high-gain control can exist with only the direct adaptation in use since
a large adaptive gain needs to be used in order to reduce the tracking error rapidly. A
high-gain control may be undesirable since it can lead to high frequency oscillations in the
adaptive signal that can potentially excite unmodeled dynamics such as structural modes. The
proposed hybrid adaptive control can improve the performance of a ﬂight control system by
incorporating a model inversion indirect adaptation in conjunction with a direct adaptation.
The inner loop rate feedback control is designed to improve aircraft rate response
characteristics such as the short period mode and the dutch roll mode. A second-order
reference model is speciﬁed to provide desired handling qualities with good damping and
natural frequency characteristics as follows:

s2 + 2ζpωps + ω2
p

φm = cpδlat
(3)

s2 + 2ζqωqs + ω2
q

θm = cqδlon
(4)

s2 + 2ζrωrs + ω2
r

rm = crδrud
(5)
where φm, θm, and ψm are reference bank, pitch, and heading angles; δlat, δlon, and δrud are the
lateral stick input, longitudinal stick input, and rudder pedal input; ωp, ωq, and ωr are the
natural frequencies for desired handling qualities in the roll, pitch, and yaw axes; ζp, ζq, and
ζr are the desired damping ratios; and cp, cq, and cr are stick gains.
Let pm = ˙φm, qm = ˙θm, and rm = ˙ψm be the reference roll, pitch, and yaw rates. Then the
reference model can be represented as
˙ωm = −Kpωm −Ki
 t
0 ωmdτ + cδc
(6)
where ωm =

pm qm rm
⊤, Kp = diag

2ζpωp, 2ζqωq, 2ζrωr

, Ki = diag

ω2p, ω2q, ω2r

, c =
diag

cp, cq, cr

, and δc =

δlat δlon δrud
⊤.
A model inversion controller is computed to obtain an estimated control surface deﬂection
command ˆδ to achieve a desired acceleration ˙ωd as
ˆδ = ˆG−1  ˙ωd −ˆF1ω −ˆF2σ

(7)
where ˆF1, ˆF2, and ˆG are the unknown plant matrices to be estimated by an indirect adaptive
law which updates the model inversion controller; and moreover ˆG is ensured to be invertible
by verifying its matrix conditioning number.
56
Advances in Flight Control Systems
www.ebook3000.com

In order for the controller to track the reference acceleration ˙ωm, the desired acceleration ˙ωd is
computed as
˙ωd = ˙ωm + Kpωe + Ki
 t
0 ωedτ −uad
(8)
where ωe = ωm −ω is deﬁned as a rate tracking error, and uad is a direct adaptive signal
designed to reduce the tracking error to small bound away from zero in order to provide
stability robustness.
Because the true plant dynamics are unknown, the model inversion controller incurs a
modeling error equal to
˙ω −˙ωd = ˙ω −˙ωm −Kpωe −Ki
 t
0 ωedτ + uad
(9)
but from Eq. (7) the model inversion controller is also equal to
˙ω −˙ωd = ϵ −
 ˆF1 −F∗
1

ω −
 ˆF2 −F∗
2

σ −
 ˆG −G∗ ˆδ
(10)
where ϵ = Δ ˙ω is the unknown plant model error.
Comparing these two equations, the tracking error equation is formed as
˙e = Ae + Buad + B ˜F1ω + B ˜F2σ + B ˜G ˆδ −Bϵ
(11)
where e =
	 
 t
0 ωedτ ωe
⊤
is the tracking error, ˜F1 = ˆF1 −F∗
1 , ˜F2 = ˆF2 −F∗
2 , ˜G = ˆG −G∗, and
A =

0
I
−Ki −Kp

, B =
 0
I

(12)
The direct adaptive signal uad is computed from a single-layer sigma-pi neural network
uad = W⊤Ψ
(13)
where W ∈Rm×3 is a neural network weight matrix, and Ψ =

C1 C2 C3 C4 C5
⊤∈Rm×1
is a basis function with Ci, i = 1, . . . , 5, as inputs into the neural network consisting of control
commands, sensor feedback, and bias terms; deﬁned as follows
C1 = V2 
ω⊤αω⊤βω⊤
(14)
C2 = V2 
1 α β α2 β2 αβ

(15)
C3 = V2 
δ⊤αδ⊤βδ⊤
(16)
C4 =

pω⊤qω⊤rω⊤
(17)
C5 =

1 θ φ δT

(18)
where δT in C5 is an engine throttle parameter.
These basis functions are designed to model the unknown nonlinearity that exists in the
unknown plant model. For example, the aerodynamic force in the x- axis for an aircraft can be
57
Hybrid Adaptive Flight Control with Model Inversion Adaptation

expressed as
Fx = δTTmax + 1
2 ρV2S

CL0 + CLαα + CLββ + CLωω + CLδδ

α
−1
2ρV2S

CD0 + CDαα + CDβ β + CDωω + CDδδ

(19)
where the engine thrust is replaced by δTTmax and Tmax is the maximum engine thrust.
Thus, C1, C2, and C3 are designed to model the product terms of α, β, ω, and δ in the
aerodynamic and propulsive forces. Similarly, C4 models the cross-coupling terms of the
aircraft rates in the moment equations, and C5 models the effects the gravity and propulsive
force. Alternatively, the basis function Ψ can also be formed from a subset of Ci, i = 1, 2, . . . , 5.
The update law for the neural net weights W is due to Rysdyk and Calise (Rysdyk & Calise,
1998) and is given by
˙W = −Γ

Ψe⊤PB + μ
e⊤PB
 W

(20)
where Γ = Γ⊤> 0 ∈Rm×m is an adaptive gain matrix, μ > 0 ∈R is an e-modiﬁcation
parameter (Narendra & Annaswamy, 1987), ∥.∥is a Frobenius norm, and P = P⊤> 0 ∈R6×6
solves the Lyapunov equation
PA + A⊤P = −Q
(21)
for some positive-deﬁnite matrix Q = Q⊤> 0 ∈R6×6.
The goal is to compute ˆF1, ˆF2, and ˆG by a model inversion indirect adaptive law. The indirect
adaptive law updates the estimates of F1, F2, and G so that the model inversion controller
ˆδ can accommodate as much as possible the effects of the unknown plant dynamics. Two
approaches are considered: 1) an indirect adaptive law based on the Lyapunov’s direct
method, and 2) a recursive least-squares indirect adaptive law for parameter estimation of
the unknown plant model. Both of these approaches are described as follows:
2.1 Lyapunov-Based indirect adaptive law
The hybrid adaptive control with model inversion adaptation can be implemented by the
following indirect adaptive law
˙Φ = −Λ

Θe⊤PB + η
e⊤PB
 Φ

(22)
where Φ⊤=

W⊤
ω W⊤
σ W⊤
δ
 ∈R3×p is a weight matrix, Θ =

ω⊤Ψ⊤
ω σ⊤Ψ⊤
σ ˆδ⊤Ψ⊤
δ
⊤∈
Rp×1 is an input matrix of state and control vectors, Λ = diag (Γω, Γσ, Γδ) > 0 ∈Rp×p is an
adaptive gain matrix, and η = diag (μωI, μσI, μδI) > 0 ∈Rp×p is an e-modiﬁcation parameter
matrix.
Then the estimates of F1, F2, and G can be computed as
ˆF1 = F∗
1 + W⊤
ω Ψω
(23)
ˆF2 = F∗
2 + W⊤
σ Ψσ
(24)
ˆG = G∗+ W⊤
δ Ψδ
(25)
58
Advances in Flight Control Systems
www.ebook3000.com

The basis functions Ψω, Ψσ, and Ψδ are designed to model the nonlinearity in the plant model
error. For example, if the plant model error is given by
ϵ = A1ω + A2αω + A3βω
(26)
then W⊤
ω =

A1 A2 A3

and Ψω =

I αI βI
⊤.
The tracking error then becomes
˙e = Ae + BW⊤Ψ + BΦ⊤Θ −Bϵ
(27)
The indirect adaptive law (22) can be shown to provide a stable estimation of the unknown
plant matrices F1, F2, and G as follows:
Proof: The matrix A is Hurwitz. Let W = W∗+ ˜W and Φ = Φ∗+ ˜Φ where the asterisk
symbol denotes the ideal weight matrices that cancel out the unknown plant model error ϵ
and the tilde symbol denotes the weight deviations. The ideal weight matrices are unknown
but they may be assumed constant and are bounded to stay within a Δ-neighborhood of the
plant model error ϵ, assuming that the input or the command δc ∈L∞is bounded. Then
Δ = sup
ω,σ,δ
W∗⊤Ψ + Φ∗⊤Θ −ϵ

(28)
Choose the following Lyapunov candidate function
V = e⊤Pe + tr

˜W⊤Γ−1 ˜W + ˜Φ⊤Λ−1 ˜Φ

(29)
where tr (.) denotes the trace operation.
The time derivative of the Lyapunov candidate function is computed as
˙V = ˙e⊤Pe + e⊤P ˙e + 2tr

˜W⊤Γ−1 ˙˜W + ˜Φ⊤Γ−1 ˙˜Φ

(30)
which upon substitution yields
˙V = e⊤
PA + A⊤P

e + 2e⊤PB

W⊤Ψ + Φ⊤Θ −ϵ

+ 2tr
	
−˜W⊤
Ψe⊤PB + μ
e⊤PB
 W

−˜Φ⊤
Θe⊤PB + η
e⊤PB
 Φ

(31)
Utilizing the trace operation tr (XY) = YX, where X is a column vector and Y is a row vector,
then
2tr

−˜W⊤Ψe⊤PB

= −2e⊤PB ˜W⊤Ψ
(32)
2tr

−˜Φ⊤Θe⊤PB

= −2e⊤PB ˜Φ⊤Θ
(33)
Completing the square yields
2tr
	
−μ ˜W⊤e⊤PB


W∗+ ˜W

= −2μ
e⊤PB


W∗
2 + ˜W

2
−

W∗
2

2
≤−μ
e⊤PB

 ˜W
2 −∥W∗∥2
(34)
59
Hybrid Adaptive Flight Control with Model Inversion Adaptation

2tr
	
−˜Φ⊤η
e⊤PB


Φ∗+ ˜Φ

≤−2
e⊤PB


λmin (η)

 Φ∗
2 + ˜Φ

2
−λmax (η)

Φ∗
2

2
≤−
e⊤PB

	
λmin (η)
 ˜Φ
2 −λmax (η) ∥Φ∗∥2
(35)
where ∥.∥is a Frobenius norm, and λmin and λmax are the maximum and minimum
eigenvalues, respectively.
Then, substituting back into ˙V gives
˙V ≤−e⊤Qe + 2e⊤PBΔ −μ
e⊤PB

 ˜W
2 −∥W∗∥2
−
e⊤PB

	
λmin (η)
 ˜Φ
2 −λmax (η) ∥Φ∗∥2
(36)
Since ∥B∥= 1, it can be established that
˙V ≤−λmin (Q) ∥e∥2 + ∥P∥∥e∥
	
2 ∥Δ∥−μ
 ˜W
2 −∥W∗∥2
−λmin (η)
 ˜Φ
2 + λmax (η) ∥Φ∗∥2
(37)
which can also be expressed as
˙V ≤−∥e∥

λmin (Q) ∥e∥−∥P∥
	
2 ∥Δ∥+ μ ∥W∗∥2 + λmax (η) ∥Φ∗∥2
+μ ∥P∥
 ˜W
2 + λmin (η) ∥P∥
 ˜Φ
2
(38)
Let S be a compact set deﬁned as
S =

e, ˜W, ˜Φ

: λmin (Q) ∥e∥+ μ ∥P∥
 ˜W
2 + λmin (η) ∥P∥
 ˜Φ
2 ≤r

(39)
where
r = ∥P∥
	
2 ∥Δ∥+ μ ∥W∗∥2 + λmax (η) ∥Φ∗∥2
(40)
Then ˙V ≤0 outside the compact set S. Also there exist functions ϕ1, ϕ2 ∈KR where
ϕ1
∥e∥,
 ˜W
 ,
 ˜Φ
 = λmin (P) ∥e∥2 + λmin

Γ−1  ˜W
2 + λmin

Λ−1  ˜Φ
2
(41)
ϕ2
∥e∥,
 ˜W
 ,
 ˜Φ
 = λmax (P) ∥e∥2 + λmax

Γ−1  ˜W
2 + λmax

Λ−1  ˜Φ
2
(42)
such that
ϕ1
∥e∥,
 ˜W
 ,
 ˜Φ
 ≤V ≤ϕ2
∥e∥,
 ˜W
 ,
 ˜Φ

(43)
Then, according to Theorem 3.4.3 of (Ioannu & Sun, 1996), the solution is uniformly ultimately
bounded. Therefore, the hybrid adaptive control results in stable and bounded tracking error;
i.e., e, ˜W, ˜Φ ∈L∞.
It should be noted that the bounds on ∥e∥,
 ˜W
, and
 ˜Φ
 depends on ∥Δ∥. To improve the
tracking performance, the magnitudes of Δ must be kept small. This is predicated upon how
well the neural network can approximate the nonlinear uncertainty in the plant dynamics.
60
Advances in Flight Control Systems
www.ebook3000.com

Increasing the adaptive gains Γ and Λ improves the tracking performance but at the same
time degrades stability robustness. On the other hand, the values of μ and η must also be kept
sufﬁciently large to ensure stability robustness, but large values of μ and η can degrade the
tracking performance. Thus, there exists a trade-off between performance and robustness in
selecting the adaptive gains Γ and Λ and the e-modiﬁcation parameters μ and η.
To ensure that the indirect adaptive law will result in a convergence of the estimates ˆF1, ˆF2,
and ˆG to their steady state values, the input signals must be sufﬁciently rich to excite all
frequencies of interest in the plant dynamics. This condition is known as a persistent excitation
(PE) (Ioannu & Sun, 1996).
2.2 Recursive Least-squares indirect adaptive law
The tracking error equation (11) can be expressed as
˙e = Ae + Buad + B

Φ⊤Θ −ϵ

(44)
Suppose the plant model error can be written as
ϵ = ˙ˆω −˙ω∗+ Δϵ = Φ⊤Θ
(45)
where Δϵ is the estimation error of Δ ˙ω. Then, the estimated plant model error is
ˆϵ = ˙ˆω −˙ω∗= ˙ˆω −F∗
1 ω −F∗
2 σ −G∗ˆδ
(46)
where ˙ˆω is the estimated acceleration.
The model inversion adaptation using the recursive least-squares indirect adaptive law is
given by
˙Φ =
1
m2 RΘ

ˆϵ⊤−Θ⊤Φ

(47)
˙R = −1
m2 RΘΘ⊤R
(48)
where R = R⊤> 0 ∈Rp×p is a positive deﬁnite covariance matrix and m2 is a normalization
factor
m2 = 1 + Θ⊤RΘ
(49)
The recursive least-squares indirect adaptive law can be derived as follows:
The estimation error can be minimized by considering the following cost function
J (Φ) =
1
2m2
 t
0
ˆϵ⊤−Θ⊤Φ

2
dτ
(50)
To minimize the cost function, the gradient of the cost function with respect to the weight
matrix is computed and set to zero, thus resulting in
∇J⊤
Φ = −1
m2
 t
0 Θ

ˆϵ⊤−Θ⊤Φ

dτ = 0
(51)
Equation (51) is then written as
1
m2
 t
0 ΘΘ⊤dτΦ = 1
m2
 t
0 Θˆϵ⊤dτ
(52)
61
Hybrid Adaptive Flight Control with Model Inversion Adaptation

Let
R−1 = 1
m2
 t
0 ΘΘ⊤dτ > 0
(53)
Differentiating Eq. (53) yields
dR−1
dt
= 1
m2 ΘΘ⊤
(54)
It is noted that
R−1R = I ⇒dR−1
dt
R + R−1 ˙R = 0
(55)
Solving for ˙R yields Eq. (48).
Also, differentiating Eq. (52) yields
R−1 ˙Φ + 1
m2 Θ⊤Φ = 1
m2 Θˆϵ⊤
(56)
Solving for ˙Φ yields the recursive least-squares indirect adaptive law (47) .
The recursive least-squares indirect adaptive law can be shown to provide a stable estimation
of the unknown plant matrices F1, F2, and G as follows:
Proof: The steady state ideal weight matrix Φ∗is assumed to be bounded by a
ΔΦ-neighborhood where
¯Δ = sup
ω,σ,δ
Φ∗⊤Θ −ˆϵ

(57)
The ideal weight matrix W∗is assumed to be bounded inside a neighborhood where
Δ = sup
ω,σ,δ
W∗⊤Ψ + Φ∗⊤Θ −ˆϵ −Δϵ
 ≤sup
ω,σ,δ
W∗⊤Ψ −Δϵ
 + ¯Δ
(58)
Choose the following Lyapunov candidate function
L = e⊤Pe + tr

˜W⊤Γ−1 ˜W + ˜Φ⊤R−1 ˜Φ

(59)
The only difference between L and V is in the last term. Then, the time rate of change of the
Lyapunov candidate function is computed as
˙L = −e⊤Qe + 2e⊤PB

W⊤Ψ + Φ⊤Θ −ˆϵ −Δϵ

−2tr
	
˜W⊤
Ψe⊤PB + μ
e⊤PB
 W

+ tr

2
m2 ˜Φ⊤Θ

ˆϵ⊤−Θ⊤Φ

+ ˜Φ⊤dR−1
dt
˜Φ

(60)
Further simpliﬁcation yields
˙L ≤−e⊤Qe + 2e⊤PBΔ + 2e⊤PB ˜Φ⊤Θ + μ
e⊤PB


∥W∗∥2 −
 ˜W
2
−1
m2 Θ⊤˜Φ ˜Φ⊤Θ + 2
m2

ˆϵ⊤−Θ⊤Φ∗
˜Φ⊤Θ
(61)
62
Advances in Flight Control Systems
www.ebook3000.com

˙L is then bounded by
˙L ≤−λmin (Q) ∥e∥2 + ∥P∥∥e∥

2 ∥Δ∥+ 2
 ˜Φ⊤Θ
 + μ ∥W∗∥2
−μ ∥P∥∥e∥
 ˜W
2 −1
m2
 ˜Φ⊤Θ

2
+ 2
m2
 ˜Φ⊤Θ

 ¯Δ

(62)
which can also be expressed as
˙L ≤−∥e∥
	
λmin (Q) ∥e∥−∥P∥

2 ∥Δ∥+ 2
 ˜Φ⊤Θ
 + μ ∥W∗∥2
+μ ∥P∥
 ˜W
2
−1
m2
 ˜Φ⊤Θ

 ˜Φ⊤Θ
 −2
 ¯Δ


(63)
˙L < 0 if
 ˜Φ⊤Θ
 > 2
 ¯Δ

(64)
and
λmin (Q) ∥e∥+ μ ∥P∥
 ˜W
2 > ∥P∥

2 ∥Δ∥+ 2
 ˜Φ⊤Θ
 + μ ∥W∗∥2
> ∥P∥

2 ∥Δ∥+ 4
 ¯Δ
 + μ ∥W∗∥2
(65)
Let C be a compact set deﬁned as
C =

e, ˜W, ˜Φ

: λmin (Q) ∥e∥+ μ ∥P∥
 ˜W
2 ≤¯r or
 ˜Φ⊤Θ
 ≤2
 ¯Δ


(66)
where
¯r = ∥P∥

2 ∥Δ∥+ 4
 ¯Δ
 + μ ∥W∗∥2
(67)
Then ˙L ≤0 outside the compact set C, and so according to Theorem 3.4.3 of (Ioannu &
Sun, 1996), the solution is uniformly ultimately bounded. Therefore, the hybrid adaptive
control results in stable and bounded tracking error; i.e., e, ˜W, ˜Φ ∈L∞. Thus, the recursive
least-squares indirect adaptive law is stable.
The parameter convergence of the recursive least-squares depends on the persistent excitation
condition on the input signals (Ioannu & Sun, 1996). The update law for the covariance matrix
R has a very similar form to the Kalman ﬁlter with Eq. (48) as the differential Riccati equation
for a zero-order plant dynamics. The recursive least-squares indirect adaptive law can also
be implemented in a discrete time form with various modiﬁcations such as with an adaptive
directional forgetting factor (Bobal et al., 2005) according to
Φi+1 = Φi +
1
m2
i+1
Ri+1Θi
	
ˆϵ⊤
i+1 −Θ⊤
i Φi

(68)
Ri+1 = Ri −

ψ−1
i+1 + ξi+1
−1
RiΘiΘT
i Ri
(69)
where ψ and ξ are deﬁned as
ξi+1 = m2
i+1 −1
(70)
ψi+1 = ϕi+1 −ξ−1
i
(1 −ϕi+1)
(71)
63
Hybrid Adaptive Flight Control with Model Inversion Adaptation

The directional forgetting factor ϕ is calculated as
ϕ−1
i+1 = 1 + (1 + ρ) ln (1 + ξi+1) +
 ηi+1 (1 + ϑi+1)
1 + ξi+1 + ηi+1
−1

ξi+1
1 + ξi+1
(72)
where ρ is a constant, and η and ϑ are parameters with the following update laws
ηi+1 = λ−1
i+1
ˆϵi+1 −Φ⊤
i Θi

2
(73)
ϑi+1 = ϕi+1 (1 + ϑi)
(74)
λk+1 = ϕi+1

λk + (1 + ξi+1)
ˆϵi+1 −Φ⊤
i Θi

2
(75)
3. Flight control simulations
3.1 Generic transport model
To evaluate the hybrid adaptive ﬂight control method, a simulation was conducted using
a NASA generic transport model (GTM) which represents a notional twin-engine transport
aircraft as shown in Fig. 2 (Jordan et al., 2004). An aerodynamic model of the damaged aircraft
is created using a vortex lattice method to estimate aerodynamic coefﬁcients and derivatives.
A damage scenario is modeled corresponding to a 28% loss of the left wing. The damage
causes an estimated C.G. shift mostly along the pitch axis with Δy = 0.0388¯c and an estimated
mass loss of 1.2%. The principal moment of inertia about the roll axis is reduced by 12%, while
changes in the inertia values in the other two axes are not as signiﬁcant. Since the damaged
aircraft is asymmetric, the inertia tensor has all six non-zero elements. This means that all the
three roll, pitch, and yaw axes are coupled together throughout the ﬂight envelope.
Fig. 2. Left Wing Damaged Generic Transport Model
A level ﬂight condition of Mach 0.6 at 4572 m is selected. Upon damage, the aircraft is
re-trimmed with T = 0.0705W, ¯α = 5.9o, ¯φ = −3.2o, ¯δa = 27.3o, ¯δe = −0.5o, ¯δr = −1.3o. The
remaining right aileron is the only roll control effector available. In practice, some aircraft can
control a roll motion with spoilers, which are not modeled in this study. The reference model is
64
Advances in Flight Control Systems
www.ebook3000.com

speciﬁed by ωp = 2.3 rad/sec, ωq = 1.7 rad/sec, ωr = 1.3 rad/sec, and ζp = ζq = ζr = 1/
√
2.
slotine
The state space model of the damaged aircraft is given by
⎡
⎣
˙p
˙q
˙r
⎤
⎦=
⎡
⎣
−1.3568 −0.2651 0.5220
−0.0655 −0.8947 0.0147
0.0836 −0.0042 −0.5135
⎤
⎦
⎡
⎣
p
q
r
⎤
⎦
+
⎡
⎣
0
−10.9985 −8.9435
−0.0007 −2.7041 −0.0064
0
0.1841
2.8822
⎤
⎦
⎡
⎣
Δφ
Δα
Δβ
⎤
⎦
+
⎡
⎣
3.2190 −0.0451 1.3869
0.3391 −3.4656 0.0245
−0.0124 0.0007 −2.2972
⎤
⎦
⎡
⎣
Δδa
Δδe
Δδr
⎤
⎦
(76)
⎡
⎣
Δ ˙φ
Δ ˙α
Δ ˙β
⎤
⎦=
⎡
⎣
1
0
0.1024
−0.0059 0.9723 0.0004
−0.0031 0.0002 −0.9855
⎤
⎦
⎡
⎣
p
q
r
⎤
⎦
+
⎡
⎣
0
0
0
0.0028 −0.4799 0.0235
0.0507 0.0133 −0.1751
⎤
⎦
⎡
⎣
Δφ
Δα
Δβ
⎤
⎦
+
⎡
⎣
0
0
0
0.0240 −0.0700 −0.0011
0.0019 0.0001
0.0588
⎤
⎦
⎡
⎣
Δδa
Δδe
Δδr
⎤
⎦
(77)
0
10
20
30
40
−4
−2
0
2
4
t, sec
q, deg/sec
 
 
0
10
20
30
40
−4
−2
0
2
4
t, sec
q, deg/sec
 
 
0
10
20
30
40
−4
−2
0
2
4
t, sec
q, deg/sec
 
 
0
10
20
30
40
−4
−2
0
2
4
t, sec
q, deg/sec
 
 
No Adaptation
Reference Model
Direct
Reference Model
Hybrid Indirect
Reference Model
Hybrid RLS
Reference Model
Fig. 3. Pitch Rate
The pilot pitch rate command is simulated with a series of ramp input longitudinal stick
command doublets, corresponding to the reference pitch angle between −3.1o and 3.1o.
The tracking performance of the baseline ﬂight control with no adaptation versus the three
65
Hybrid Adaptive Flight Control with Model Inversion Adaptation

0
10
20
30
40
−20
−10
0
10
20
30
t, sec
p, deg/sec
 
 
0
10
20
30
40
−20
−10
0
10
20
30
t, sec
p, deg/sec
 
 
0
10
20
30
40
−20
−10
0
10
20
30
t, sec
p, deg/sec
 
 
Direct
0
10
20
30
40
−20
−10
0
10
20
30
t, sec
p, rad/sec
 
 
No Adaptation
Hybrid Indirect
Hybrid RLS
Fig. 4. Roll Rate
adaptive control methods is compared in Figs. 3 to 6. With no adaptation, there is a signiﬁcant
overshoot in the ability for the baseline ﬂight control system to follow the reference pitch rate
as shown in Fig. 3. The performance progressively improves ﬁrst with the direct adaptive
control alone, then with the hybrid Lyapunov-based indirect adaptive control, and ﬁnally
with the hybrid recursive least-squares (RLS) indirect adaptive control. The Lyapunov-based
indirect adaptive control performs better than the direct adaptive control alone as expected,
since the presence of the Lyapunov-based indirect adaptive law further enhances the ability
for the ﬂight control system to adapt to damage.
0
10
20
30
40
−0.4
−0.2
0
0.2
0.4
t, sec
r, deg/sec
 
 
0
10
20
30
40
−0.4
−0.2
0
0.2
0.4
0.6
t, sec
r, deg/sec
 
 
0
10
20
30
40
−0.4
−0.2
0
0.2
0.4
t, sec
r, deg/sec
 
 
0
10
20
30
40
−0.4
−0.2
0
0.2
0.4
0.6
t, sec
r, deg/sec
 
 
No Adaptation
Hybrid Indirect
Hybrid RLS
Direct
Fig. 5. Yaw Rate
The most drastic improvement is provided by the hybrid RLS indirect adaptive control which
results in a very good tracking performance in all three control axes. In the pitch axis, the
hybrid RLS indirect adaptive control tracks the reference pitch rate very accurately. In the roll
and yaw axes, the roll and yaw rate responses are maintained close to zero. In contrast, both
66
Advances in Flight Control Systems
www.ebook3000.com

0
10
20
30
40
0
10
20
30
t, sec
||ωe||, deg/sec
 
 
0
10
20
30
40
0
10
20
30
t, sec
||ωe||, deg/sec
 
 
0
10
20
30
40
0
10
20
30
t, sec
||ωe||, deg/sec
 
 
0
10
20
30
40
0
10
20
30
t, sec
||ωe||, deg/sec
 
 
Hybrid Indirect
Direct
No Adaptation
Hybrid RLS
Fig. 6. Tracking Error Norm
the direct adaptive control and the hybrid Lyapunov-based indirect adaptive control improve
the roll and yaw rate responses, but the response amplitudes are still signiﬁcant and therefore
can be objectionable particularly in the roll rate.
Figure 6 is the plot of the tracking error norm for all the three angular rates to demonstrate
the effectiveness of the hybrid adaptive control method. The hybrid Lyapunov-based indirect
adaptive control reduces the tracking error by roughly half of that with the direct adaptive
control alone and by a factor of three when there is no adaptation. Moreover, the hybrid
RLS indirect adaptive control drastically reduces the tracking error by more than an order
of magnitude over those with the direct adaptive control and with the baseline ﬂight control.
0
10
20
30
40
−40
−20
0
20
t, sec
φ, deg
 
 
0
10
20
30
40
−40
−20
0
20
φ, deg
t, sec
 
 
0
10
20
30
40
−40
−20
0
20
φ, deg
t, sec
 
 
0
10
20
30
40
−40
−20
0
20
φ, deg
t, sec
 
 
No Adaptation
Direct
Hybrid Indirect
Hybrid RLS
Fig. 7. Bank Angle
The attitude responses of the damaged aircraft are shown in Fig. 7 to 9. When there is
no adaptation, the damaged aircraft exhibits a rather severe roll behavior with the bank
angle ranging from almost −40o to 20o. The direct adaptive control improves the situation
67
Hybrid Adaptive Flight Control with Model Inversion Adaptation

0
10
20
30
40
0
2
4
6
8
10
α, deg
t, sec
 
 
0
10
20
30
40
0
2
4
6
8
10
α, deg
t, sec
 
 
0
10
20
30
40
0
2
4
6
8
10
α, deg
t, sec
 
 
0
10
20
30
40
0
2
4
6
8
10
α, deg
t, sec
 
 
Direct
No Adaptation
Hybrid Indirect
Hybrid RLS
Fig. 8. Angle of Attack
signiﬁcantly and cuts down the bank angle to a range between about −30o and 10o. With the
hybrid RLS indirect adaptive control, the bank angle is essentially maintained at its trim value.
The angle of attack as shown in Fig. 8 is in a reasonable range. The angle of attack when there
is no adaptation goes through a large swing from 1o to 9o, but the hybrid RLS indirect adaptive
control reduces the angle of attack to a range between 3o and 8o.
Figure 9 shows the plot of the sideslip angle. In general, ﬂying with sideslip angle is not a
recommended practice since a large sideslip angle can cause an increase in drag and more
importantly a decrease in the yaw damping. With no adaptation, the largest negative sideslip
angle is about −3o. This is still within a reasonable limit, but the swing from −3o to 1o can
cause objectionable handling qualities. With the hybrid RLS indirect adaptive control, the
sideslip angle is retained virtually at zero.
0
10
20
30
40
−4
−2
0
2
t, sec
β, deg
 
 
0
10
20
30
40
−4
−2
0
2
t, sec
β, deg
 
 
0
10
20
30
40
−4
−2
0
2
t, sec
β, deg
 
 
0
10
20
30
40
−4
−2
0
2
t, sec
β, deg
 
 
No Adaptation
Direct
Hybrid RLS
Hybrid Indirect
Fig. 9. Sideslip Angle
68
Advances in Flight Control Systems
www.ebook3000.com

The control surface deﬂections are plotted in Figs. 10 to 12. Because of the wing damage, the
damaged aircraft has to be trimmed with a rather large aileron deﬂection. This causes the
roll control authority to severely decrease. Any pitch maneuver can potentially run into a
control saturation in the roll axis due to the pitch-roll coupling that exists in a wing damage
scenario. With the maximum aileron deﬂection at 35o, it can be seen clearly that a roll control
saturation is present in all cases, being the worst when there is no adaptation and the best
with the hybrid RLS indirect adaptive control. The range of aileron deﬂection when there
is no adaptation is quite large. As the aileron deﬂection hits the maximum position limit, it
tends to over-compensate in the down swing because of the large pitch rate error produced by
the control saturation. Both the direct adaptive control alone and the hybrid Lyapunov-based
indirect adaptive control alleviate the situation somewhat but the control saturation is still
present. The hybrid RLS indirect adaptive control is apparently very effective in dealing with
the control saturation problem. As can be seen, it results in only a small amount of control
saturation, and the aileron deﬂection does not vary widely. The hybrid RLS indirect adaptive
control essentially enables the aileron to operate almost at its full authority, whereas with the
other control methods, only partial control authority is possible.
0
10
20
30
40
0
10
20
30
40
t, sec
δa, deg
 
 
0
10
20
30
40
0
10
20
30
40
t, sec
δa, deg
 
 
0
10
20
30
40
0
10
20
30
40
t, sec
δa, deg
 
 
0
10
20
30
40
0
10
20
30
40
t, sec
δa, deg
 
 
Direct
No Adaptation
Hybrid Indirect
Hybrid RLS
Fig. 10. Aileron Deﬂection
Figure 11 is the plot of the elevator deﬂection that shows similar elevator deﬂections to be
within a range of few degrees for all the four different controllers. This implies that the roll
control contributes mostly to the response of the damaged aircraft.
The rudder deﬂection is shown in Fig. 12. With no adaptation, the rudder deﬂection is quite
active, going from −5o to 0o. While this appears small, it should be compared relative to the
rudder position limit, which is usually reduced as the airspeed and altitude increase. The
absolute rudder position limit is ±10o but in practice the actual rudder position limit may
be less. Therefore, it is usually desired to keep the rudder deﬂection as small as possible. The
direct adaptive control results in a maximum negative rudder deﬂection of −4o and the hybrid
Lyapunov-based indirect adaptive control further reduces it to −2o. The hybrid RLS indirect
adaptive control produces the smallest rudder deﬂection and keeps it to less than ±0.5o from
the trim value.
69
Hybrid Adaptive Flight Control with Model Inversion Adaptation

0
10
20
30
40
−3
−2
−1
0
1
2
t, sec
δe, deg
 
 
0
10
20
30
40
−3
−2
−1
0
1
2
t, sec
δe, deg
 
 
0
10
20
30
40
−3
−2
−1
0
1
2
t, sec
δe, deg
 
 
Hybrid Indirect
Hybrid RLS
0
10
20
30
40
−3
−2
−1
0
1
2
t, sec
δe, deg
 
 
Direct
No Adaptation
Fig. 11. Elevator Deﬂection
0
10
20
30
40
−6
−4
−2
0
2
t, sec
δr, deg
 
 
0
10
20
30
40
−6
−4
−2
0
2
t, sec
δr, deg
 
 
0
10
20
30
40
−6
−4
−2
0
2
t, sec
δr, deg
 
 
0
10
20
30
40
−6
−4
−2
0
2
t, sec
δr, deg
 
 
No Adaptation
Direct
Hybrid RLS
Hybrid Indirect
Fig. 12. Rudder Deﬂection
3.2 Piloted ﬂight simulator
The Crew-Vehicle System Research Facility (CVSRF) at NASA Ames Research Center houses
two motion-based ﬂight simulators, the Advanced Concept Flight Simulator (ACFS) and the
Boeing 747-400 Flight Simulator for use in human factor and ﬂight simulation research. The
ACFS has a highly customizable ﬂight simulation environment that can be used to simulate a
wide variety of transport-type aircraft. The ACFS employs advanced ﬂy-by-wire digital ﬂight
control systems with modern features that can be found in today’s modern aircraft. The ﬂight
deck includes head-up displays, a customizable ﬂight management system, and modern ﬂight
instruments and electronics. Pilot inputs are provided by a side stick for controlling aircraft in
pitch and roll axes.
Recently, a piloted study has been conducted in the ACFS to evaluate a number of adaptive
control methods (Campbell et al., 2010). A high-ﬁdelity ﬂight dynamic model was developed
70
Advances in Flight Control Systems
www.ebook3000.com

to simulate a medium-range generic transport aircraft. The model includes aerodynamic
models of various aerodynamic surfaces including ﬂaps, slats, and other control surfaces. The
aerodynamic database is based on Reynolds number corrected wind tunnel data obtained
from wind tunnel testing of a sub-scale generic transport model. The ground model with
landing gears as well as ground effect aerodynamic model are also included.
A number of failure and damage emulations were implemented including asymmetric
damage to the left horizontal tail and elevator, ﬂight control faults emulated by scaling the
control sensitivity matrix (B-matrix failures), and combined failures. Eight different NASA
test pilots were requested to participate in the study. For each failure emulation, each pilot
was asked to provide Cooper-Harper Ratings (CHR) for a series of ﬂight tasks, which included
large amplitude attitude capture tasks and cross-wind approach and landing tasks.
Fig. 13. Advanced Concept Flight Simulator at NASA Ames
Seven adaptive control methods were selected for the piloted study that include
e-modiﬁcation (Narendra & Annaswamy, 1987), hybrid adaptive control (Nguyen et al.,
2006), optimal control modiﬁcation (Nguyen et al., 2008), metric-driven adaptive control
using bounded linear stability method (Nguyen et al., 2007), L1 adaptive control (Cao &
Hovakimyan, 2008), adaptive loop recovery (Calise et al., 2009), and composite adaptive
control (Lavretsky, 2009). This is by no means an exhaustive list of new advanced adaptive
control methods that have been developed in the past few years, but this list provides an
71
Hybrid Adaptive Flight Control with Model Inversion Adaptation

Fig. 14. Pilot Evaluation of Adaptive Flight Control
initial set of adaptive control methods that could be implemented under an existing NASA
partnership with the industry and academia sponsored by the NASA Integrated Resilient
Aircraft Control (IRAC) project.
The study generally conﬁrms that adaptive control can clearly provide signiﬁcant beneﬁts
to improve aircraft ﬂight control performance in adverse ﬂight conditions. The study also
provides an insight of the role of pilot interactions with adaptive ﬂight control systems. It
was observed that many favorable pilot ratings were associated with those adaptive control
methods that provide a measure of predictability, which is an important attribute of a ﬂight
control system design. Predictability can be viewed as a measure of how linear the aircraft
response is to a pilot input. Being a nonlinear control method, some adaptive control methods
can adversely affect linear behaviors of a ﬂight control system more than others. Thus, while
these adaptive control methods may appear to work well in a non-piloted simulation, they
may present potential issues with pilot interactions in a realistic piloted ﬂight environment.
Thus, understanding pilot interaction issues is an important consideration in future research
of adaptive ﬂight control.
With respect to pilot handling qualities, among the seven adaptive ﬂight controllers evaluated
in the study, the optimal control modiﬁcation, the adaptive loop recovery, and the composite
adaptive control appeared to perform well over all ﬂight conditions (Campbell et al., 2010).
The hybrid adaptive control also performs reasonably well in most cases. For example, with
the B-matrix failure emulation, the average CHR was 5 for 8 capture tasks with the baseline
dynamic inversion ﬂight controller. The average CHR number was improved to 3 with the
hybrid adaptive control. In only one type of failure emulations that involved cross-coupling
effects in aircraft dynamics, the performance of the hybrid adaptive ﬂight controller fell below
that for the e-modiﬁcation which is used as the benchmark for comparison.
Future NASA research in advancing adaptive ﬂight control will include ﬂight testing of some
of the new promising adaptive control methods. Previously, NASA conducted ﬂight testing
of the Intelligent Flight Control (IFC) on a NASA F-15 aircraft up until 2008 (Bosworth &
72
Advances in Flight Control Systems
www.ebook3000.com

Fig. 15. Cooper-Harper Rating Improvement of Various Adaptive Control Methods
Williams-Hayes, 2007). In January of 2011, NASA has successfully completed a ﬂight test
program on a NASA F-18 aircraft to evaluate a new adaptive ﬂight controller based on the
Optimal Control Modiﬁcation (Nguyen et al., 2008). Initial ﬂight test results indicated that the
adaptive controller was effective in improving aircraft’s performance in simulated in-ﬂight
failures. Flight testing can reveal new observations and potential issues with adaptive control
in various stages of the design implementation that could not be observed in ﬂight simulation
environments. Flight testing therefore is a critical part of validating any new technology such
as adaptive control that will allow such a technology to transition into production systems in
the future.
4. Conclusions
This study presents a hybrid adaptive ﬂight control method that blends both direct and
indirect adaptive control within a model inversion ﬂight control architecture. Two indirect
adaptive laws are presented: 1) a Lyapunov-based indirect adaptive law, and 2) a recursive
least-squares indirect adaptive law. The indirect adaptive laws perform on-line parameter
estimation and update the model inversion ﬂight controller to reduce the tracking error. A
direct adaptive control is incorporated within the feedback loop to correct for any residual
tracking error.
A simulation study is conducted with a NASA wing-damaged transport aircraft model.
The results of the simulation demonstrate that in general the hybrid adaptive control offers
a potentially promising technique for ﬂight control by allowing both direct and indirect
adaptive control to operate cooperatively to enhance the performance of a ﬂight control
system. In particular, the hybrid adaptive control with the recursive least-squares indirect
adaptive law is shown to be highly effective in controlling a damaged aircraft. Simulation
results show that the hybrid adaptive control with the recursive least-squares indirect
adaptive law is able to regulate the roll motion due to a pitch-roll coupling to maintain a
nearly wing-level ﬂight during a pitch maneuver.
73
Hybrid Adaptive Flight Control with Model Inversion Adaptation

The issue of roll control saturation is encountered due to a signiﬁcant reduction in the roll
control authority as a result of the wing damage. The direct adaptive control and the hybrid
adaptive control with the Lyapunov-based indirect adaptive law restore a partial roll control
authority from the control saturation. On the other hand, the hybrid adaptive control with the
recursive least-squares indirect adaptive law restores the roll control authority almost fully.
Thus, the hybrid adaptive control with the recursive least-squares indirect adaptive law can
demonstrate its effectiveness in dealing with a control saturation.
A recent piloted study of various adaptive control methods in the Advanced Concept Flight
Simulator at NASA Ames Research Center conﬁrmed the effectiveness of adaptive control in
improving ﬂight safety. The hybrid adaptive control was among the methods evaluated in the
study. In general, it has been shown to provide an improved ﬂight control performance under
various types of failure emulations conducted in the piloted study.
In summary, the hybrid adaptive ﬂight control is a potentially effective adaptive control
strategy that could improve the performance of a ﬂight control system when an aircraft
operating in adverse events such as with damage and or failures.
5. References
Annaswamy, A.; Jang, J. & Lavretsky, E. (2008). Stability Margins for Adaptive Controllers in
the Presence of Time-Delay, AIAA Guidance, Navigation, and Control Conference,
Honolulu, Hawaii, August 2008, AIAA 2008-6659.
Bobal, V.; BÃ˝uhm, J.; Fessl, J. & MachÃ ˛acek, J. (2005). Digital Self-Tuning Controllers: Algorithms,
Implementation, and Applications, Springer-Verlag, ISBN 1852339802, London,
Bosworth, J. & Williams-Hayes, P. (2007). Flight Test Results from the NF-15B IFCS Project with
Adaptation to a Simulated Stabilator Failure, AIAA Infotech@Aerospace Conference,
Rohnert Park, California, May 2007, AIAA-2007-2818.
Calise, A.; Yucelen, T.; Muse, J. & Yang, B. (2009). A Loop Recovery Method for Adaptive
Control, AIAA Guidance, Navigation, and Control Conference, Chicago, Illinois,
August 2009, AIAA-2009-5967.
Campbell, S.; Kaneshige, J.; Nguyen, N. & Krishnakumar, K. (2010). An Adaptive Control
Simulation Study using Metrics and Pilot Handling Qualities Evaluations, AIAA
Guidance, Navigation, and Control Conference, Toronto, Canada, August 2010,
AIAA-2010-8013.
Cao, C. & Hovakimyan, N. (2008). Design and Analysis of a Novel L1 Adaptive Control
Architecture with Guaranteed Transient Performance. IEEE Transactions on Automatic
Control, Vol. 53, No. 2, March 2008, pp. 586-591.
Cybenko, G. (1989). Approximation by Superpositions of a Sigmoidal Function. Mathematics
of Control Signals Systems, Vol. 2, No. 4, 1989, pp. 303-314.
Eberhart, R. L. & Ward, D. G. (1999). Indirect Adaptive Flight Control System Interactions.
International Journal of Robust and Nonlinear Control, Vol. 9, No. 14, December 1999,
pp. 1013-1031.
Hovakimyan, N.; Kim, N.; Calise, A. J.; Prasad, J.V. R. & Corban, E. J. (2001). Adaptive
Output Feedback for High-Bandwidth Control of an Unmanned Helicopter, AIAA
Guidance, Navigation and Control Conference, Montreal, Canada, August 2001,
AIAA-2001-4181.
Ioannu, P.A. & Sun, J. (1996). Robust Adaptive Control, Prentice-Hall, ISBN 0134391004.
74
Advances in Flight Control Systems
www.ebook3000.com

Jacklin, S. A.; Schumann, J. M.; Gupta, P. P.; Richard, R.; Guenther, K. & Soares, F.
(2005). Development of Advanced Veriﬁcation and Validation Procedures and
Tools for the Certiﬁcation of Learning Systems in Aerospace Applications, AIAA
Infotech@Aerospace Conference, Arlington, VA, September 2005, AIAA-2005-6912.
Johnson, E. N.; Calise, A. J.; El-Shirbiny, H. A. & Rysdyk, R. T. (2000). Feedback Linearization
with Neural Network Augmentation Applied to X-33 Attitude Control, AIAA
Guidance, Navigation, and Control Conference, Denver, Colorado, August 2000,
AIAA-2000-4157.
Jordan, T. L.: Langford, W. M.; Belcastro, Christine M.; Foster, J. M.; Shah, G. H.; Howland, G.
& Kidd, R. (2004). Development of a Dynamically Scaled Generic Transport Model
Testbed for Flight Research Experiments, AUVSI Unmanned Unlimited, Arlington,
VA, 2004
Kim, B. S. & Calise, A. J. (1997). Nonlinear Flight Control Using Neural Networks. AIAA
Journal of Guidance, Control, and Dynamics, Vol. 20, No. 1, 1997, pp. 26-33.
Lavretsky, E. (2009). Combined / Composite Model Reference Adaptive Control, AIAA
Guidance, Navigation, and Control Conference, Chicago, Illinois, August 2009,
AIAA-2009-6065
Narendra, K. S. & Annaswamy, A. M. (1987). A New Adaptive Law for Robust Adaptation
Without Persistent Excitation. IEEE Transactions on Automatic Control, Vol. 32, No. 2,
February 1987, pp. 134-145.
Nguyen, N.; Krishnakumar, K.; Kaneshige, J. & Nespeca, P. (2006). Dynamics and
Adaptive Control for Stability Recovery of Damaged Asymmetric Aircraft, AIAA
Guidance, Navigation, and Control Conference,Keystone, Colorado, August 2006,
AIAA-2006-6049.
Nguyen, N.; Bakhtiari-Nejad, M. & Huang, Y. (2007). Hybrid Adaptive Flight Control
with Bounded Linear Stability Analysis, AIAA Guidance, Navigation, and Control
Conference, Hilton Head, South Carolina, August 2007, AIAA 2007-6422.
Nguyen, N.; Krishnakumar, K. & Boskovic, J. (2008). An Optimal Control Modiﬁcation
to Model-Reference Adaptive Control for Fast Adaptation, AIAA Guidance,
Navigation, and Control Conference, Honolulu, Hawaii, August 2008, AIAA
2008-7283.
Nguyen, N. & Jacklin, S. (2010). Neural Net Adaptive Flight Control Stability, Veriﬁcation
and Validation Challenges, and Future Research, In: Applications of Neural Networks
in High Assurance Systems, Schumann, J. & Liu, Y., (Ed.), pp. 77-107, Springer-Verlag,
ISBN 978-3-642-10689-7, Berlin.
Rohrs, C.E.; Valavani, L.; Athans, M. & Stein, G. (1985). Robustness of Continuous-Time
Adaptive Control Algorithms in the Presence of Unmodeled Dynamics. IEEE
Transactions on Automatic Control, Vol. 30, No. 9, September 1985, pp. 881-889.
Rysdyk, R. T. & Calise, A. J. (1998). Fault Tolerant Flight Control via Adaptive Neural
Network Augmentation, AIAA Guidance, Navigation, and Control Conference,
Boston, Massachusetts, August 1998, AIAA-1998-4483.
Sharma, M.; Lavretsky, E. & and Wise, K. (2006). Application and Flight Testing of an Adaptive
Autopilot On Precision Guided Munitions, AIAA Guidance, Navigation, and Control
Conference, Keystone, Colorado, August 2006, AIAA-2006-6568.
Steinberg, M. L. (1999). A Comparison of Intelligent, Adaptive, and Nonlinear Flight Control
Laws, AIAA Guidance, Navigation, and Control Conference, Portland, Oregon,
August 1999, AIAA-1999-4044.
75
Hybrid Adaptive Flight Control with Model Inversion Adaptation

Stepanyan, V.; Krishnakumar, K.; Nguyen, N. & Van Eykeren, L. (2009). Stability and
Performance Metrics for Adaptive Flight Control, AIAA Guidance, Navigation, and
Control Conference, Chicago, Illinois, August 2009, AIAA-2009-5965.
Yang, B.-J.; Yucelen, T.; Calise, A. J. & Shin, J.-Y. (2009). LMI-based Analysis of Adaptive
Controller, American Control Conference, June 2009.
76
Advances in Flight Control Systems
www.ebook3000.com

4 
Application of Evolutionary Computing in 
Control Allocation 
Hammad Ahmad, Trevor Young, Daniel Toal and Edin Omerdic  
University of Limerick, 
Republic of Ireland 
1. Introduction 
This issue of interaction of control allocation and actuator dynamics and has been dealt with 
by very few researchers. What was not considered in most control allocation algorithms is 
the fact that the control surfaces are manipulated by either hydraulics or electric actuators, 
and constitute a dynamic system which cannot produce infinite accelerations. In other 
words, if a control was initially at rest, and later commanded to move at its maximum rate 
in some direction for a specified amount of time, it would gradually build up speed until it 
reached the commanded rate. The final position of the control would therefore not be the 
same as that calculated using the commanded rate and the time during which it was 
instructed to move (Bolling 1997). In this chapter, a method, which post-processes the 
output of a control allocation algorithm, is developed to compensate for actuator dynamics. 
The method developed is solved for a diagonal matrix of gain corresponding to individual 
actuators. This matrix is then multiplied with the commanded change in control effector 
settings as computed by the control allocator and actuators dynamics interactions. The basic 
premise of this method is to post process the output of the control allocation algorithm to 
overdrive the actuators so that at the end of a sampling interval the actual actuator positions 
are equivalent to the desired actuator positions (Oppenheimer and Doman 2004). The 
overdriving of the actuators is done by multiplying the change in commanded signal with 
the identified gain matrix which is called the compensator. This identification is done by 
using a soft computing technique (i.e. genetic algorithms). The simulation setup including 
control allocator block, compensator and actuator rig makes a non-linear set up. During the 
identification of the compensator using this setup by soft computing technique such as 
genetic algorithms, the likelihood of the solution being a global minimum is high as 
compared to other optimisation techniques. This is why genetic algorithms have been used 
in this analysis rather than other techniques such as linear programming. The main 
contribution is to design a compensator using an evolutionary computing technique (i.e. 
genetic algorithms) to compensate the interaction between control allocation and actuator 
dynamics. It should be mentioned that in this method the model of the actuator does not 
need to be known. The simulation setup consists of excitation signals, the control allocation 
block, the compensator and the actuators rig. 
When designing control allocation typically the actuator dynamics are ignored because the 
bandwidth of the actuators is larger than the frequencies of the rigid body modes of the 
aircraft. Fig. 1 shows a control allocator with actuator dynamics neglected. If there is a case 

Advances in Flight Control Systems 
78
in which actuator frequencies are comparable with the bandwidth of the rigid body modes 
then the actuator dynamics cannot be neglected, as shown in Fig. 2. 
 
 
Fig. 1. Control allocation with actuator dynamics neglected 
 
 
Fig. 2. Control allocation with actuator dynamics 
In this case the output of the control allocator should match the output of the actuator 
dynamics. In reality the output of the control allocation is attenuated due to the presence of 
non-negligible actuator dynamics. The loss of the gain from the CA output signal is 
compensated by the scheme shown in Fig. 3. In the second order dynamics of the actuator 
the rate could be estimated using a Kalman filter if the rate sensing is not available. The 
Kalman filter is an efficient recursive filter that estimates the state of a dynamic system from 
a series of noisy measurements. The matrix of gains as shown in Fig. 3 is tuned offline using 
GA. The structure of the compensator is taken from (Oppenheimer and Doman 2004). 
1.1 Control allocation for aircraft: graphical illustration 
Control allocation is merely a mapping (i.e. linear or non-linear) from total virtual demands 
in terms of body angular accelerations to the control position setting subject to rate and 
position constraints. An illustration of control allocation is given in Fig. 4. 
Section 2 describes the interaction of first order actuator dynamics and control allocation 
and the structure of the compensator is established in this section for first order actuator 
dynamics. Similarly, in section 2.2 the structure of the compensator is established for second  
 
u
u
u
v
u
u
u
d
u
≤
≤
=
−
c
B
to
 
subject
min
Find
2
1
11
~
×
cmd
u
v
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
79 
 
Fig. 3. Structure of compensator with actuator dynamics with diagonal gain matrix M of 
dimension (11X11) 
 
Fig. 4. Control allocation for aircraft: graphical illustration 
order actuator dynamics. In section 3 tuning of the compensator parameters using genetic 
algorithm is described. In section 4 simulation and results for a tuned compensator are 
shown for a range of first and second order actuator dynamics. Finally, in section 5 some 
conclusions are established.  
2. First-order actuator dynamics interaction 
In this section, the effects of first-order actuator on the system are shown in Fig. 2 
(Oppenheimer and Doman 2004). Let the dynamics of a single actuator be represented by a 
continuous time first order transfer function of the form 
 
ݑሺݏሻ
ݑ෤௖௠ௗሺݏሻൌ
ܽ
ݏ൅ܽ 
(1)
 
The discrete time solution to the first-order actuator dynamic equation for one sample 
period is given by 
u
u
u
v
u
u
u
d
u
≤
≤
=
−
c
B
to
 
subject
min
Find
2
cmd
u
u
u
cmd
u
Δ
cmd
u~
v
u

Advances in Flight Control Systems 
80
ݑሺ݇ܶ൅ܶሻൌeି௔Tݑሺ݇ܶሻ൅න
݁ି௔ሺ௞்ା்ିఛሻ
௞்ା்
௞்
ݑ෤௖௠ௗሺ߬ሻ݀߬ 
(2)
 
where ܶ is the sampling time. This result does not depend on the type of hold because ݑ is 
specified in terms of its continuous time history, ݑ෤௖௠ௗሺݐሻ over a sample interval (Franklin et 
al. 1998). The most common hold element is zero-order hold (ZOH) with no delay, i.e. 
 
ݑ෤௖௠ௗሺ߬ሻൌݑ෤௖௠ௗሺ݇ܶሻ, ݇ܶ൑߬൑݇ܶ൅ܶ
(3)
Performing substitution 
 
ߛൌ݇ܶ൅ܶെ߬
(4)
in Eq. (2) yields 
 
ݑሺ݇ܶ൅ܶሻൌeି௔Tݑሺ݇ܶሻ൅න݁ି௔ఊ
்
଴
ݑ෤௖௠ௗሺ݇ܶሻ݀ߛ 
(5)
Defining 
 
Φ ൌeି௔T 
Γ ൌන݁ି௔ఊ
்
଴
݀ߛ 
(6)
 
Eq. (5) can be written as a difference equation of standard form 
 
ݑሺ݇൅1ሻൌΦݑሺ݇ሻ൅Γu෤ୡ୫ୢሺkሻ
(7)
 
The signal ݑ෤௖௠ௗሺ݇ሻ, is held constant over each sampling period. The command to actuator is 
given by 
 
ݑ෤௖௠ௗሺ݇ሻൌΔݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻ
(8)
 
The command increment change in actuator position over one sample as shown in Fig. 5 is 
defined by 
 
Δݑ௖௠ௗሺ݇ሻ؜ ݑ௖௠ௗሺ݇ሻെݑሺ݇ሻ
(9)
 
 
Fig. 5. Command increment change in actuator position with gain matrix M equal to 
Identity matrix I of dimension (11X11) 
where ݑ௖௠ௗ is the actuator command coming from the control allocator. Since the effector 
commands are held constant for one sample period then Δݑ௖௠ௗሺ݇ሻ appear to be a step 
command from the measured position ݑሺ݇ሻ. Substituting Eq. (8) in Eq. (7) gives 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
81 
ݑሺ݇൅1ሻൌΦݑሺ݇ሻ൅ΓሺΔݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻሻ
(10) 
 
If Γ ൏1, the incremental commanded signal from the control allocation algorithm, Δݑ௖௠ௗሺ݇ሻ 
is attenuated by the actuator dynamics, thus ݑሺ݇൅1ሻ്ݑ௖௠ௗ. The objective is to find the 
gain M that changes the output of the control allocation algorithm such that ݑሺ݇൅1ሻൌ
ݑ௖௠ௗൌΔݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻ (Oppenheimer and Doman 2004). Hence  
 
ݑሺ݇൅1ሻൌΦݑሺ݇ሻ൅ΓሺMΔݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻሻ
(11) 
 
The gain M is tuned by using the genetic algorithm in section 3.2. If there is a bank of first 
order actuator dynamics, then the gain M is chosen to be a diagonal matrix ۻ of dimensions 
(11x11), as shown in Fig. 3 and Fig. 5. 
2.1 Example showing effect of first-order actuator dynamics 
Let us consider an example with  
۰܋ൌ10ିଷ൥
െ4.2
 4.2
െ5.0
5.0
0
0
0
0
0
2.6
0.7
െ0.9
െ0.9
െ2.9
െ2.9
െ9.4
െ9.4
െ6.9
െ6.9
െ80.5
െ7.7   
5.8
െ0.2 
0.2
െ0.1
0.1
0
0
0
 0
0
0
0
൩ 
Position in (deg) and rate in (deg/s) constraints are defined as follows: 
 
ݑ௠௜௡ൌሾെ20
െ20
െ12
െ12
െ23
െ23
െ23
െ23
െ12
െ25
െ25ሿ் 
ݑ௠௔௫ൌሾ20
20
15
15
17
17
17
17
3
25
25ሿ் 
 
(12) 
 
ߩሶ௠௜௡ൌሾെ45
െ45
െ45
െ45
െ37
െ37
െ37
െ37
െ0.5
െ50
െ50ሿ் 
ߩሶ௠௔௫ൌሾ45
45
45
45
37
37
37
37
0.5
50
50ሿ்
(13) 
 
 
 
Fig. 6. Block diagram with desired demand produced by the control allocator and compared 
with the actual demand when there is no actuator dynamics included1 
First the time response of control allocation without actuator dynamics is shown in Fig. 6 
and Fig 7. It can be seen that if the actuators are fast enough to cater for the rigid body 
                                                                 
1 cf. (from Latin confer) means compare 
3X1 

Advances in Flight Control Systems 
82
modes, there is no need to consider the actuator dynamics and hence one to one mapping 
between the control allocator and control surfaces is sufficient. This would not be the case 
with the non aerodynamic actuators, so actuator dynamics cannot be ignored. It can be seen 
from the results shown in Fig. 8 and Fig. 9 that how the actuator dynamics affects the 
outcome of the control allocator. It can also be seen that how the control allocator command 
is attenuated. The first-order actuator dynamics used for this example are given as  
 
ݑሺݏሻ
ݑ෤௖௠ௗሺݏሻൌ
0.6128
ݏ൅0.6128 
(14) 
 
Fig. 7. Comparison of results with no dynamics of actuator involved 
 
Fig. 8. Block diagram with desired demand produced by the control allocator and compared 
with the actual demand when there is actuator dynamics included 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
83 
 
Fig. 9. Time responses of desired and actual responses of virtual demand with actuator 
dynamics included 
In the following section the second order actuator dynamics are parameterised for the 
design of the compensator. 
2.2 Second-order model dynamics interaction 
In this section, the effects of second – order actuator on the system is shown in Fig. 2 
(Oppenheimer and Doman 2004). Let the dynamics of a second actuator be represented by a 
continuous time second order function of the form 
 
ݑሺݏሻ
ݑ෤௖௠ௗሺݏሻൌ
݇
ݏଶ൅2ߞ߱௡ݏ൅߱௡ଶ 
(15) 
 
The state space representation of this transfer function is given  
 
൤ݑሶሺݐሻ
ݑሷሺݐሻ൨ൌ൤0
1
െ߱௡ଶ
െ2ߞ߱௡൨൤ݑሺݐሻ
ݑሶሺݐሻ൨൅ቂ0
݇ቃݑ෤௖௠ௗሺݐሻ 
൤ݑሶሺݐሻ
ݑሷሺݐሻ൨ൌۯ ൤ݑሺݐሻ
ݑሶሺݐሻ൨൅۰ݑ෤௖௠ௗሺݐሻ 
 
(16) 
൤ݑሶሺݐሻ
ݑሷሺݐሻ൨ൌቂ1
0
0
1ቃ൤ݑሺݐሻ
ݑሶሺݐሻ൨ൌ۱ ൤ݑሺݐሻ
ݑሶሺݐሻ൨ 
(17) 
 
The discrete time solution to the second-order actuator dynamic Eq. (16) to Eq. (17) for one 
sample period is given by 

Advances in Flight Control Systems 
84
൤ݑሺ݇ܶ൅ܶሻ
ݑሶሺ݇ܶ൅ܶሻ൨ൌeۯT ൤ݑሺ݇ܶሻ
ݑሶሺ݇ܶሻ൨൅න
݁ۯሺ௞்ା்ିఛሻ۰
௞்ା்
௞்
ݑ෤௖௠ௗሺ߬ሻ݀߬ 
(18) 
 
where ܶ is the sampling time. This result does not depend on the type of hold because ݑ෤௖௠ௗ 
is specified in terms of its continuous time history, ݑ෤௖௠ௗሺݐሻ over a sample interval (Franklin 
et al. 1998). A zero-order hold (ZOH) with no delay is given by 
 
ݑ෤௖௠ௗሺ߬ሻൌݑ෤௖௠ௗሺ݇ܶሻ, ݇ܶ൑߬൑݇ܶ൅ܶ
(19) 
 
Performing substitution 
 
ߛൌ݇ܶ൅ܶെ߬
(20) 
In Eq. (18) yields  
 
൤ݑሺ݇ܶ൅ܶሻ
ݑሶሺ݇ܶ൅ܶሻ൨ൌeۯT ൤ݑሺ݇ܶሻ
ݑሶሺ݇ܶሻ൨൅න݁ۯఊ
்
଴
݀ߛ۰ݑ෤௖௠ௗሺ݇ܶሻ 
(21) 
Defining, 
 
઴ൌeۯT ൌ൤Φଵ,ଵ
Φଵ,ଶ
Φଶ,ଵ
Φଶ,ଶ൨ 
ડൌන݁ۯఊ
்
଴
݀ߛ۰ 
 
(22) 
൤ݑሺ݇ܶ൅ܶሻ
ݑሶሺ݇ܶ൅ܶሻ൨ൌ઴൤ݑሺ݇ܶሻ
ݑሶሺ݇ܶሻ൨൅ડݑ෤௖௠ௗሺ݇ܶሻ 
(23) 
 
The first state variable ݑሺ݇ܶ൅ܶሻ equation can be written as 
 
ݑሺ݇൅1ሻൌሾΦଵ,ଵ
Φଵ,ଶሿ൤ݑሺ݇ܶሻ
ݑሶሺ݇ܶሻ൨൅ݑ෤௖௠ௗሺ݇ܶሻන݇Φଵ,ଶ
்
଴
ሺߛሻ݀ߛ 
(24) 
 
Parameterizing Eq. (24) will give 
 
ݑሺ݇൅1ሻൌܥଵݑሺ݇ሻ൅ܥଶݑሶሺ݇ሻ൅ܥଷݑ෤௖௠ௗሺ݇ሻ
(25) 
 
where ܥଵൌΦଵ,ଵ, ܥଶൌΦଵ,ଶ and ܥଷൌ׬ ݇Φଵ,ଶ
்
଴
ሺߛሻ݀ߛ. 
The objective is to find M to modify the Δݑ௖௠ௗሺ݇ሻ,  as shown in Fig. 3 such that ݑሺ݇൅1ሻൌ
ݑ௖௠ௗሺ݇ሻ. 
 
Δݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻൌܥଵݑሺ݇ሻ൅ܥଶݑሶሺ݇ሻ൅ܥଷሺMΔݑ௖௠ௗሺ݇ሻ൅ݑሺ݇ሻሻ
(26) 
 
Solving for M gives (Oppenheimer and Doman 2004) 
 
M ൌΔݑ௖௠ௗሺ݇ሻ൅ሺ1 െܥଷെܥଵሻݑሺ݇ሻെܥଶݑሶሺ݇ሻ
ܥଷΔݑ௖௠ௗሺ݇ሻ
 
(27) 
 
These parameters ܥଵ, ܥଶ and ܥଷ are tuned using genetic algorithm optimisation. Here it is 
assumed that the positions and rate of change of actuators are available. If there is a bank of 
second order actuator dynamics then M is chosen to be a diagonal matrix ۻ of dimension 
(11X11). 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
85 
In the following a stochastic evolutionary algorithm technique was discussed and applied to 
tune the parameters for the compensator design in section 3. 
3. Tuning of compensator to mitigate interaction using GAs 
The idea is to combine the design objective in the form of a cost function that is to be 
optimised using an optimizer such as a Genetic Algorithm. Where the cost function includes 
the time domain objective; the tracking error is transformed into the integrated square of 
error between the commanded signal and actual output u of the actuators. In addition there 
is another design objective, exception handling (e.g. division by zero) and this is also 
included in the cost function. The schematic is shown in Fig. 10. 
 
 
Fig. 10. Cost function error generated by the simulation 
Numerically the cost function for tracking error is given by 
 
ܧ௧௥௔௖௞ൌන
Δݑ௖௠ௗ
ଶ
݀ݐ
௧೐೙೏
଴
 
(28) 
 
where the ݐ௘௡ௗis the simulation run time. 
Numerically the cost function for exception handling is given by 
 
ܧ௘௫௖௘௣ൌ൜penalty ݂݅exception generated
0 ݂݅no exception
 
(29) 
 
In Eq. (29) the penalty is assigned as a large number like 1010 so that the individual 
generating this exception would most likely not be selected in the next generation because of 
having very low fitness value. Numerically the combined cost function is given as 
 
ܬൌܧ௧௥௔௖௞൅ܧ௘௫௖௘௣
(30) 
 
This cost function is then minimised to tune the parameters for the compensator. In the next 
section GA based optimisation details are given. 

Advances in Flight Control Systems 
86
3.1 GA based optimisation 
Genetic Algorithms are a part of Evolutionary Computing which is a rapidly growing area 
of Artificial Intelligence. “GA take up the process of evaluating the relative fitness of the 
individuals of a large population called genes, to select for a new generation, and mimic mutations 
and crossing over (mixing genes from two parent genes to form offspring genes), the so called 
evolution phenomenon” (Lindenberg 2002). Unlike biological evolution, in GA the gene 
controls some other processes like compensator parameters in this work, and is evaluated 
by comparing properties of the process instead of simply computing some function on the 
gene space (Lindenberg 2002). Genes used in GA are encoded as bit strings, and their fitness 
(Lindenberg 2002) is a relation described by a real valued fitness function f on the set of bit 
strings ܪൌሼܾ଴, … … , ܾ௡ିଵ ሽ such that gene ܽ is fitter than gene ܾ if ݂ ሺܾሻ ൏ ݂ ሺܽሻ. 
Optimisation using GA begins with a set of solutions (represented by chromosomes) called 
the population. Solutions from one population (based on some selection criteria) are taken 
and used to form a new population. The flow chart of illustration of GA is shown in Fig. 11. 
After selection of an encoding method (binary encoding for this case) and fitness function 
(cost function value for an underlying gene), the algorithm proceeds in the following steps 
(Lindenberg 2002). 
 
 
Fig. 11. Flow chart explanation of Genetic Algorithms 
• 
Select an initial population indexed by P at random from some subset of ܪ 
• 
Repeat the following 
• 
evaluate the fitness of all the ܾ௉ and use them to assign selection probabilities ݎ௉ to 
ܾ௉ 
• 
select a new population, dropping genes of low fitness and duplicating fit ones, 
keeping index set ܲ (the size of population) 
• 
apply the genetic operators of mutation and crossing over (after forming couples) 
This is repeated until some condition (for instance maximum number of generations or 
improvement of the best solution) is satisfied. The main advantage (Leigh 2004) of GA over 
other optimizers is their parallelism, GA is travelling in a search space using more 
individuals so they are less likely to get stuck in a local minima. The most important 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
87 
attributes of GA are mutation and cross over. A good cross over rate is expected to take 
better parts of parent genes to the next generation. Mutation on the other hand changes the 
individuals and if it is kept to a safe low level it helps the population to avoid falling in local 
minima. This makes GA different from other optimisers, and particularly suitable for non-
convex optimisation problems like the compensator parameter optimisation in this research. 
The main disadvantage linked with GA is the higher computation time and required 
resources, but this can be avoided if there is a possibility to stop the GA anytime in the 
routine. Also with the ever increasing processing power of computers over time this 
constraint diminishes. 
3.2 Optimizing routine using GA 
Numerically the optimizing problem is given as “Find ۻ by minimizing ܬ”. 
 
min
ۻ ܬ
(31) 
 
where ۻ is a diagonal gain matrix of dimension (11X11). The GA optimising routine is 
formulated by using the MATLAB Genetic Algorithm Direct Search Toolbox. A flow chart 
representation of the optimisation routine is shown in Fig. 12. 
 
 
Fig. 12. Flow chart for tuning compensator parameters using GA 

Advances in Flight Control Systems 
88
The complete process shown in Fig. 11 can be summarised as: 
• 
The GA main function calls the evaluation function, giving searched parameters to 
calculate compensator parameters 
• 
The evaluation function calculates compensator parameters and calls the simulation 
model giving the parameters for the compensator 
• 
The simulation model runs the simulation for the given compensator parameter (i.e. 
individual of population) and returns the value of error between ݑ௖௠ௗ and actual ݑ 
• 
The evaluation function calculates the cost function value for given errors and returns 
to the main GA function 
• 
This is repeated for the total number of genes in one generation (population), and then 
one generation completes, and so the remaining generations are iteratively completed 
• 
The above process is repeated until the cost function attains convergence, or the 
maximum number of generations is reached. 
In the next section the simulation results are given to show how the compensator mitigates 
the interaction between the control allocation and actuator dynamics. 
4. Simulation results 
During simulation, a mixture of actuator dynamics was used. In the case of redundant 
control surfaces diagonal gain matrices were tuned by the GA. The control surfaces were 
approximated by the transfer functions as shown in Table 1. 
 
 
 
Control surfaces 
Number of control surfaces 
Transfer functions 
Ailerons 
4 
270
ݏଶ൅22.19ݏ൅270 
Elevators 
4 
0.6128
ݏ൅0.6128 
Stabilizer 
1 
0.0087
ݏ൅0.0087 
Rudders 
2 
270
ݏଶ൅22.19ݏ൅270 
 
 
Table 1. Aerosurfaces actuator dynamics (Esteban and Balas 2003) 
The virtual control signal, ࢜, consists of chirps of amplitude 0.1, 0.15, 0.1 (ݎܽ݀/ݏଶ) in roll, 
pitch and yaw angular accelerations respectively. The frequencies of chirps ranged from 
0.1– 1 ܪݖ in 20 seconds. In the processing of the GA routine exception handling is carried 
out to avoid breaking the GA optimisation process. For example if there is an individual (i.e. 
gains in diagonal matrix) in the population that gives division by zero that would break the 
simulation. This is dealt with in an exception handling block, which will give a penalty to 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
89 
that individual without breaking the simulation. In the next generation that individual 
would not be selected. 
Simulations are done with compensation (Fig. 13 and Fig. 14) and without compensator (Fig. 
15 and Fig 16). As can be seen clearly from the results with no compensation there is serious 
attenuation and mismatch, but as soon as the compensation is turned on, ۰܋࢛ൌ࢜ is 
achieved because sufficient control authority exists. 
Deviations in the case of no compensation case means that the desired control surface 
positions coming out of the control allocator are different from the actual position of control 
surfaces. This interaction between the control allocator and the actuator dynamics results in 
serious consequence if the bandwidths of the actuators are not high or, in other words, the 
actuators are slow. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 13. Implementation scheme for compensator when the compensator is switched on 

Advances in Flight Control Systems 
90
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 14. Desired angular accelerations (࢜) and actual angular acceleration (۰܋࢛) in rad/s2 
when compensation is on 
www.ebook3000.com

Application of Evolutionary Computing in Control Allocation 
91 
 
Fig. 15. Implementation scheme for compensator when the compensator is switched off 
 
 
 
Fig. 16. Desired angular accelerations (ݒ) and actual angular acceleration (Bୡݑ) in rad/s2 
when compensation is off 

Advances in Flight Control Systems 
92
5. Conclusions 
This chapter details the application of genetic algorithms for the design and tuning of a 
compensator to alleviate the effects of control allocation and actuator dynamics interaction. 
The effects of non-negligible actuator dynamics have been investigated first. It was observed 
that, for the Boeing 747-200, the actuator dynamics cannot be ignored if the excitations are in 
the range of 0.1 to 1 Hz, which normally depends on the pilot dynamics. Another 
observation suggests that the bandwidths of the actuators are smaller than the rigid body 
modes of the aircraft and should not be neglected. The benefit of using a soft-computing 
methodology for tuning the compensator gains is to avoid the optimisation converging to a 
local minima and it is seen that the likelihood of the genetic algorithms converging to local 
minima solution is less as compared to other techniques. In this methodology the model of 
the actuator is not needed to be known because this methodology was designed to be used 
on the actuator rig. In the case of the second order actuator, the rates should be either 
measured or observed. GAs are used offline and the band limited chirps signal is used as the 
excitation signal in the simulation. However, in the real system a band limited pseudo-
random binary signal (PRBS) for this type of identification process could be used as an 
excitation signal rather than chirp because the later gives cyclic loading on the actuator, 
which could be problematic. 
6. References 
Bolling, J.G., (1997) Implementation of Constrained Control Allocation Techniques Using an 
Aerodynamic Model of an F-15 Aircraft, MSc. thesis, Virginia Polytechnic Institute 
and State University, Virginia, USA. 
Esteban, A. M., Balas, G.J. (2003) A B747-100/200 aircraft fault tolerant and fault diagnostic 
benchmark, 
AEM-UoM 
2003-1, 
Aerospace 
Engineering 
and 
Mechanics 
Department, University of Minnesota, USA. 
Franklin, G.F., Powell, J.D. and Workman, M. (1998) Digital control of dynamic systems, 3rd 
ed., Addison-Wesley Longman, Inc., California 
Lindenberg, F.M. (2002) Adaptive Compute Systems lecture notes, Technical University 
Hamburg-Harburg Germany. 
Oppenheimer, M.W. and Doman, D.B. (2004) 'Methods for compensating for control 
allocator and actuator interactions', Journal of Guidance, Control, and Dynamics, 
27(5), pp. 922-927. 
www.ebook3000.com

1. Introduction
Safety is of paramount importance in all transportation systems, but especially in civil
aviation. Therefore, in civil aviation, a lot of developments focus on the improvement of safety
levels and reducing the risks that critical failures occur. When one analyses recent aircraft
accident statistics (Civil Aviation Safety Data 1993-2007 (2008); Smaili et al. (2006)), there are two
major categories of accidents which can be attributed to a single primary cause, as illustrated
in ﬁgure 1. The largest category is "collision with ground" (controlled ﬂight into terrain, CFIT)
where a fully functional aircraft hits terrain due to the loss of situational awareness by the
pilot, which counts for as much as 26% of the accidents. This percentage is decreasing over the
years thanks to the continuously evolving amount and manner of cockpit display information.
The second major category is "loss of control in ﬂight", which can be attributed to mistakes
made by the pilot or a technical malfunctioning. This category counts for 16% of all aircraft
accident cases and is not decreasing.
Fig. 1. Accident statistics, source: Civil Aviation Safety Data 1993-2007 (2008)
Thomas Lombaerts, Ping Chu,
Jan Albert (Bob) Mulder and Olaf Stroosma
Delft University of Technology
the Netherlands
 
Fault Tolerant Flight Control, 
a Physical Model Approach 
5

Analysing a major part of the accidents in the latter category has led to a common conclusion:
from a ﬂight dynamics point of view, with the technology and computing power available
at this moment, it might have been possible to recover the aircraft in many accident
situations in this category, on the condition that non-conventional control strategies would
have been available. These non-conventional control strategies involve the so-called concept
of active fault tolerant ﬂight control (FTFC), where the control system is capable to detect
the change in the aircraft behaviour and to adapt itself so that it can handle the perturbed
aircraft dynamics. Earlier research projects in FTFC involve the Self-Repairing Flight Control
System (SRFCS) program (Corvin et al. (1991)), the MD-11 Propulsion Controlled Aircraft
(PCA) (KrishnaKumar & Gundy-Burlet (n.d.)), the Self-Designing Controller for the F-16
VISTA (Ward & Barron (1995)), Reconﬁgurable Systems for Tailless Fighter Aircraft in the
X-36 RESTORE program (Brinker & Wise (1999); Calise et al. (2001)), the NASA Intelligent
Flight Control System (IFCS) F-15 program (Intelligent Flight Control: Advanced Concept
Program (1999)) and Damage Tolerant Flight Control Systems for Unmanned Aircraft by
Athena/Honeywell (Gavrilets (2008)). There are many alternative control approaches to
achieve FTFC. In all these control approaches, there remain some problems and limitations,
varying from the limitation to a restricted number of failure cases to the limitation of the
type and extent of damage which can be compensated for due to ﬁxed model structures for
identiﬁcation. Another frequently encountered issue are convergence problems. Besides, black
box structures like for neural networks reduce the transparency of the approach. Moreover,
for many approaches it is not clear what will happen when the reference model behaviour is
not achievable in post-failure conditions.
The research approach as elaborated in this chapter uses a physical modular approach, where
focus is placed on the use of mathematical representations based on ﬂight dynamics. All
quantities and variables which appear in the model have a physical meaning and thus are
interpretable in this approach, and one avoids so-called black and grey box models where
the content has no clear physical meaning. Besides the fact that this is a more transparent
approach, allowing the designers and engineers to interpret data in each step, it is assumed
that these physical models will facilitate certiﬁcation for eventual future real life applications,
since monitoring of data is more meaningful.
Adaptive nonlinear dynamic inversion has been selected as the preferred adaptive control
method in this modular or indirect approach. The advantages of dynamic inversion are
the absence of any need for gain scheduling, and an effective input-output decoupling
of all control channels. Adaptation of the controller is achieved by providing up-to-date
aerodynamic model information which is collected in a separate identiﬁcation module.
The structure of this chapter is as follows. Section 2 provides information on the high ﬁdelity
RECOVER simulation model which has been used in this research project. A global overview
of the fault tolerant control architecture is given in section 3, and further explanations of some
of the individual modules are added in sections 4 and 5. Simulation results are discussed
in section 4.2 for the aerodynamic model identiﬁcation, section 5.3 for the autopilot and in
section 5.5 for the manual control approach. Finally, section 6 presents some conclusions and
recommendations for future research.
2. The RECOVER benchmark simulation model
The presented work is part of a research project by the Group for Aeronautical Research and
Technology in Europe (GARTEUR). This group has established ﬂight mechanics action group
FM-AG(16) with the speciﬁc goal to investigate the possibilities of fault tolerant control in
aeronautics and to compare the results of different reconﬁguring control strategies applied to
a reference benchmark ﬂight trajectory. That benchmark scenario is inspired by the so-called
94
Advances in Flight Control Systems
www.ebook3000.com

Bijlmermeer disaster of EL AL ﬂight 1862, where a Boeing 747-200 Cargo aircraft of Israel’s
national airline EL AL lost two engines immediately after take-off from Amsterdam airport
Schiphol in the Netherlands and crashed into an apartment building in the neighbourhood
while trying to return to the airport. A detailed simulation model of this damaged aircraft
is available from the Dutch Aerospace Laboratory NLR. This RECOVER (REconﬁgurable
COntrol for Vehicle Emergency Relief) benchmark model is discussed in detail in ref. Smaili
et al. (2008; 2006) and has been used (also in earlier versions) by a number of investigators
and organizations (Maciejowski & Jones (2003); Marcos & Balas (2003); Szaszi et al. (2002)).
More information about the reference benchmark scenario can be found in ref. Lombaerts
et al. (2005; 2006). Other control strategies and results applied to the same benchmark model
as part of the framework of FM-AG(16) can be found in ref. Alwi (2008); Cieslak et al. (2008);
Hallouzi & Verhaegen (2008); Joosten et al. (2007; 2008). Related FDI work can be found in ref.
Varga (2007); Varga & Hecker (2004).
The simulation benchmark for evaluating fault tolerant ﬂight controllers as discussed in ref.
Smaili et al. (2006) contains six benchmark fault scenarios, enumerated in ﬁg. 2(a). These
failure cases have varying criticality. Fig. 2(b) shows the failure modes and structural damage
conﬁguration of the Flight 1862 accident aircraft, which is the most important fault scenario
in the simulation benchmark.
(a) GARTEUR FM-AG(16) RECOVER
benchmark fault scenarios, source:
Smaili et al. (2008)
(b) Failure modes and structural damage conﬁguration
of the Flight 1862 accident aircraft, suffering right wing
engine separation, partial loss of hydraulics and change
in aerodynamics, source: Smaili et al. (2008)
Fig. 2. GARTEUR FM-AG(16) RECOVER benchmark fault scenarios and conﬁguration
The rudder runaway, the vertical tail separation and the EL AL engine separation have been
used as scenarios for this chapter. In the case of a rudder runaway (also called hardover),
the rudder moves quickly to an extreme position. More precisely, the rudder deﬂects to the
left, inducing a yawing tendency of the aircraft to the left. The rudder deﬂection limit in this
scenario depends on the ﬂight speed, since aerodynamic blowdown is taken into account in
the RECOVER simulation model. As a result the maximum rudder deﬂection is slightly below
15◦for an airspeed around 270 knots, and even close to 25◦(the physical maximum deﬂection
limit imposed by the rudder hardware structure) for an airspeed of 165 knots. The vertical tail
separation leads to the loss of all rudder control surfaces as well as the loss of all damping in
the roll and yaw axes. Mind that loss of hydraulics is not considered in this situation. The El
Al engine separation scenario is an accurate simulation of ﬂight 1862, validated by black box
data of the accident, where the loss of hydraulics is taken into account.
95
Fault Tolerant Flight Control, a Physical Model Approach

3. Global overview of the physical modular approach
Globally, the overall architecture of this modular approach consists of three major assemblies,
namely the controlled system, the Fault Detection and Identiﬁcation (FDI) assembly and the
Fault Tolerant Flight Control (FTFC) assembly, as shown in ﬁg. 3. The controlled system
comprises the aircraft model and the actuator hardware. Possible failures in this controlled
system are structural failures and actuator hardware failures in the latter. Sensor failures have
not been considered in this research, since it has been assumed that effects of these failures
can be minor thanks to sensor redundancy and sensor loss detection. However, the latter
mechanism is recommended for future research.
Fig. 3. Overview of the modular physical approach for fault tolerant ﬂight control
The Fault Detection and Identiﬁcation (FDI) architecture consists of several components. The
core of this assembly is the two step method (TSM) module, described in section 4.1. This
module consists of a separate aircraft state estimation step followed by an aerodynamic model
identiﬁcation step, where the latter is a joint structure selection and parameter estimation
(SSPE) procedure. The state estimation step is a nonlinear problem solved by an Iterated
Extended Kalman Filter. The preferred SSPE algorithm is Adaptive Recursive Orthogonal
Least Squares. In case a structural failure occurs (in the aircraft structure or in one of the
control surfaces), re-identiﬁcation is triggered when the average square innovation exceeds
a predeﬁned threshold. For successful identiﬁcation of the control derivatives of every
individual control surface, control effectiveness evaluation is needed after failure. This can
be done by inserting multivariate orthogonal input signals in the actuators. Although this
must be done carefully such that the damaged aircraft cannot be destabilized, it is necessary
in order to obtain sufﬁcient control surface efﬁciency information for the control allocation
module, to be discussed later. A valid approach might be to introduce these evaluation signals
only when strictly needed, i.e. when successful reconﬁguration is not possible due to a lack of
information about this control efﬁciency. The two step method is ideally suited to deal with
structural failures, but for the detection of actuator failures a separate actuator monitoring
algorithm is needed, such as an Actuator Health Monitoring System (AHMS).
96
Advances in Flight Control Systems
www.ebook3000.com

Four other functions can be grouped to form the Fault Tolerant Flight Control (FTFC)
assembly. The core for this group are indirect adaptive control and control allocation. Indirect
adaptive control can be achieved by adaptive nonlinear dynamic inversion (ANDI) described
in section 5.1. In this setup, the control structure consists of three inversion loops, as
elaborated in section 5.2. This control structure relies on the principle of time scale separation.
The advantages of ANDI are that it removes the need for gain scheduling over different
operating conditions and it effectively decouples input-output relationships. Moreover, the
NDI control algorithm automatically involves some form of control allocation, due to the
structure of the control law. This structuring allows a clear separation how different failure
types are dealt with. Structural failures independent of the control surfaces are detected by
the TSM and this damage information is supplied to the ANDI algorithm by means of the
aerodynamic derivatives. On the other hand control surface related failures, aerodynamics or
actuator related, are identiﬁed by the TSM or the actuator monitoring algorithm respectively.
This information is sent to the adaptive control allocation block. The preferred control
allocation approach is found to be the control distributor concept (CDC), (Oppenheimer &
Doman (2006)), combined with the weighted pseudo inverse (WPI). This method assumes
the presence of a large amount of similar control surfaces. This assumption holds for the
type of aircraft considered in this research project, such as the Boeing 747. This approach
ﬁts in the modular setup of the global procedure, where the CDC principle takes into
account aerodynamic changes and the WPI provides the adaptivity with reference to actuator
failures. Furthermore, a reference model deﬁnes the reference signal that the closed loop
conﬁguration has to track. However, this reference model needs to be adaptive such that
its signals are limited based upon the achievable performance of the damaged closed loop
conﬁguration. This reference signal adaptation can be achieved by Pseudo Control Hedging.
This modulation is based upon the difference between the demanded input signal and the
achieved input signal by the actuators. This reference signal adaptation is primarily driven
by saturation effects. Besides, this hedging operation takes into account the updated model
information from the FDI assembly. In this way, one makes sure that no unreachable reference
signals are given to the closed loop conﬁguration. This PCH operation can be considered as
a ﬁrst degree of safe ﬂight envelope enforcement, based upon input saturation effects and
updated model information. Experiments have shown that especially the throttle channel is
prone to saturation effects.
During this research, it has been found that safe ﬂight envelope enforcement is a crucial aspect
in this control setup, and it is part of recommended future research. This protection algorithm,
based upon the achievable performance which can be estimated based upon actuator status,
aerodynamic derivatives and control derivatives, should contribute on two levels. On one
hand, it has to assist the PCH algorithm by limiting the reference model output appropriately.
Moreover, the output of the control allocation block, and thus the input to the actuators,
should be limited based upon this reachable ﬂight envelope information. A tabular overview
of the preferred method for every component in the global overview of the fault tolerant ﬂight
control setup can be found in table 1.
In the following sections, further explanations will be given about some of the individual
modules.
4. Fault detection and identiﬁcation
4.1 Two step method
The identiﬁcation method considered in this study is the so-called two step method (Chu
(2007); Chu et al. (1994); Laban (1994); Mulder (1986); Mulder et al. (1999)). There are
many other identiﬁcation algorithms mentioned in the literature like maximum likelihood
97
Fault Tolerant Flight Control, a Physical Model Approach

component
preferred method
aircraft state estimation
Iterated Extended Kalman Filter
aerodynamic model
Adaptive Recursive
identiﬁcation
Orthogonal Least Squares
identiﬁcation triggering
average square innovation & threshold
control effectiveness evaluation
multivariate orthogonal input functions
control allocation
Control Distributor Concept
& Weighted Pseudo Inverse
indirect adaptive control
triple layer Adaptive
Nonlinear Dynamic Inversion
actuator monitoring
Actuator Health Monitoring System
reference signal adaptation
Pseudo Control Hedging
Table 1. Preferred methods for FTFC modules
identiﬁcation (MLI) and other one step identiﬁcation routines, but not all of them are
applicable on line. One of the few procedures which can be implemented in real time is the
so-called ﬁltering method developed at German Aerospace Centre DLR, see ref. Jategaonkar
(2006). This is a joint state and parameter estimation algorithm, but very complex. Another
algorithm can be found in ref. Morelli (2000), which is frequency based. The advantage of
the two step method is that it is easier to implement on-line. The aim is to update an a
priori aerodynamic model (obtained by means of windtunnel tests and CFD calculations)
by means of on-line ﬂight data. The ﬁrst step is called the Aircraft State Estimation phase,
where the second one is the Aerodynamic Model Identiﬁcation step. In the Aircraft State
Estimation procedure, an Iterated Extended Kalman Filter is used to determine the aircraft
states, by making use of the redundant but perturbed information from all sensors (air data,
inertial, magnetic and GPS measurements). By means of this state information, it is possible
to construct the combined aerodynamic and thrust forces and moments acting on the aircraft.
Mass and inertia are considered as known constants in these calculations. In the absence of
a structural failure, real time mass and inertia can be calculated by integrating fuel ﬂow and
subtracting it from the total take off values. Future research is aimed at taking into account
changing masses and inertia in the presence of structural failures. Finally the aerodynamic
derivatives can be deduced in the second step by means of structure selection and parameter
estimation.
This second step involves the aerodynamic properties of the aircraft. Thanks to the separation
of the kinematics, these aerodynamics become linear in the parameters. Model structure
determination is the ﬁrst concern, and a regression method can be applied in order to estimate
the so-called aerodynamic model parameters. Simultaneous recursive structure selection and
parameter estimation is performed in this phase, by means of so-called Adaptive Recursive
Orthogonal Least Squares (AROLS), (Lombaerts et al. (2010c)). This method determines the
model structure by means of an orthogonal QR-decomposition, which is extended recursively
to make the method suitable for online applications. Special monitoring criteria verify
continuously when the structure needs to be extended. For a detailed discussion of these
criteria see ref. Lombaerts et al. (2010c).
The model structure selection procedure considers a set of candidate regressors based upon a
Taylor series expansion with respect to the aircraft states and control inputs (control surface
deﬂections and engine settings) relevant for the aerodynamic forces and moments. The
candidate regressors are shown in table 2.
98
Advances in Flight Control Systems
www.ebook3000.com

dependent
candidate regressors
variable
1, α, α2 (X only), q ¯c
V , δei , ih, δspi, δfi, Ti
X; Z; M
{β,
pb
2V ,
rb
2V , αm, α qc
V , αδe, αβ, αβ2, α2β, αβ3, α2β3
m = 3, . . . , 8}
{α pb
2V , α rb
2V , α2 pb
2V , α2, rb
2V , βn
n = 2, . . . , 5}
1, β, pb
2V , rb
2V , δai , δri, δspi, {α,
q ¯c
V , Ti}
Y; L; N
{αm, α qc
V , αδe, αβ, αβ2, α2β, αβ3, α2β3
m = 2, . . . , 8}
{α pb
2V , α rb
2V , α2 pb
2V , α2, rb
2V , βn
n = 2, . . . , 5}
Table 2. States and control inputs which inﬂuence forces and moments
β
p
r
δa
δr
CYβ < 0
CYp ≈0
CYr > 0
CYδa ≈0
CYδr > 0
nominal
Y
CYβ ≪0
CYp ≈0
CYr > 0
CYδa ≈0
CYδr > 0
engine separation
CYβ ≤0
CYp ≈0
CYr ≥0
CYδa ≈0
CYδr = 0
tail loss
Clβ < 0
Clp < 0
Clr > 0
Clδa < 0
Clδr > 0
nominal
L
Clβ < 0
Clp ≤0
Clr ≫0
Clδa < 0
Clδr > 0
engine separation
Clβ ≤0
Clp < 0
Clr > 0
Clδa < 0
Clδr = 0
tail loss
Cnβ > 0
Cnp < 0
Cnr < 0
Cnδa > 0
Cnδr < 0
nominal
N
Cnβ ≫0
Cnp < 0
Cnr < 0
Cnδa > 0
Cnδr < 0
engine separation
Cnβ ≤0
Cnp < 0
Cnr ≤0
Cnδa > 0
Cnδr = 0
tail loss
Table 3. Predicted lateral aerodynamic derivative changes for asymmetric failure scenarios
studied
In table 2, {. . .} indicate regressor candidates for AROLS related to aerodynamic cross
coupling effects in case of aircraft asymmetries as well as higher order aerodynamic effects,
for example due to structural failures. The identiﬁed parameters contain valuable information
about the physical state of the aircraft. For example, the parameters Cmα and Cnβ represent
measures for static stability. In fact, Cnβ is also known as Weathercock stability. The derivatives
Cmδe , Clδa and Cnδr represent “elevator-”, “aileron-” and “rudder-effectiveness” respectively.
A structural failure will result in changing aerodynamic derivatives. Based upon ﬂight
dynamics theory (Mulder et al. (January 2006)), it is possible to predict the changes in the
aerodynamic derivatives in the engine separation and tail loss scenarios, as illustrated in table
3. Each parameter is an aerodynamic derivative, e.g. CYβ represents the change in lateral force
Y caused by a change in sideslip angle β. In the engine separation scenario for example, wing
sweep combined with the loss of the leading edge results in a larger negative Y-force caused
by a positive sideslip angle β.
Various validation tests by means of a posteriori batch process identiﬁcation, least squares
residual analysis and reconstruction of velocity and angular rate components have shown
that this method works well and can in fact be used for identiﬁcation purposes of damaged
aircraft. Identiﬁcation of component as well as structural failures is possible in this setting, see
ref Lombaerts et al. (2007) for a more elaborate discussion of validation methods and results.
4.2 Applications
Two application examples are considered here. First, a static directional stability analysis
is performed for the tail loss scenario. Thereafter, the model structure of the dimensionless
99
Fault Tolerant Flight Control, a Physical Model Approach

aerodynamic force coefﬁcient CZ is elaborated and its parameter values are estimated at the
same moment in the engine separation scenario.
4.2.1 Tail loss
A natural consequence of the tail loss scenario is the huge reduction in directional static
stability. This can be seen in the behaviour of the aerodynamic derivative Cnβ, as shown in ﬁg.
4. A positive value for Cnβ indicates static directional stability. From ﬁg. 4, it is clear that, while
the nominal aircraft is stable, the damaged aircraft is observed to be directionally statically
unstable.
0
10
20
30
40
50
60
−0.02
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
 
 
nominal
loss of vertical tail
Cnβ
time, [s]
Fig. 4. Comparison of Weathercock stability derivative for undamaged and damaged aircraft
with loss of vertical tail
4.2.2 Engine separation
In this example, the dimensionless aerodynamic force coefﬁcient CZ is considered in the
engine separation scenario. Applying the AROLS routine to this stretch of simulation data
leads to the results as shown in ﬁg. 5. Fig. 5(a) shows the results prior to failure, while ﬁg.
5(b) focuses on the post-failure situation. As can be seen in this ﬁgure, the ﬁt is accurate in
both cases. The optimal residual, which is updated over the entire time history at every time
step, is minimal. The real residual, which is not updated a posteriori, gives an indication of the
reduction in the residual over the time interval. Fig. 5(a) reveals the initial large residual due to
initialization. Fig. 5(b) shows the initial large residual caused by the failure. This is minimized
in very short term, but starts increasing thereafter due to slow dynamics which become
dominant. Between 55s and 60s, the residual is again minimized, thanks to the incorporation
of these slow dynamics in the aerodynamic model.
The parameter estimation results, together with their standard deviations, can be found in
table 4. These results highlight the difference between the situations before and after failure.
Because there is no anomaly before the failure, the important independent variables for the
vertical force are the conventional ones, namely a constant, the angle of attack α and pitch
rate qc
V . However, after the failure a violent roll-dive manoeuvre follows. The inﬂuence of the
damage on the change in aerodynamics is represented by additional contributions by sideslip
β and roll rate pb
2V . These are a consequence of the asymmetric damage, as a result of which
100
Advances in Flight Control Systems
www.ebook3000.com

0
5
10
15
20
25
30
35
40
45
50
−0.6
−0.5
−0.4
−0.3
−0.2
CZ & CZ
est
 
 
measured
reconstructed
0
5
10
15
20
25
30
35
40
45
50
−0.02
0
0.02
0.04
optimal residual
0
5
10
15
20
25
30
35
40
45
50
−0.2
−0.1
0
0.1
0.2
actual residual
time [s]
(a)
AROLS
structure
selection
and
parameter estimation result for CZ prior
to failure
50
55
60
65
70
75
−0.2
−0.1
0
0.1
0.2
CZ & CZ
est
 
 
measured
reconstructed
50
55
60
65
70
75
−0.04
−0.02
0
0.02
optimal residual
50
55
60
65
70
75
−0.2
0
0.2
0.4
0.6
actual residual
time [s]
(b)
AROLS
structure
selection
and
parameter estimation result for CZ after
failure
Fig. 5. AROLS structure selection and parameter estimation results for CZ before and after
the failure
the decoupling of longitudinal and lateral regressors does not hold anymore in this scenario.
The standard deviations give an indication of the accuracy of the results.
prior failure
post failure
estimated
(σ)
estimated
(σ)
1
−0.1583
(1%)
−0.4131
(2%)
α
−4.4016
(≈0%)
4.9047
(1%)
qc
V
−1.6124
(22%)
105.1966
(1%)
β
−
−
4.2319
(1%)
pb
2V
−
−
9.4708
(≈0%)
rb
2V
−
−
−
−
all others
−
−
−
−
Table 4. SSPE results for CZ for engine separation scenario, before and after failure
A more elaborate discussion of this example can be found in ref. Lombaerts et al. (2010c).
5. Fault Tolerant Control method
Fault Tolerant Flight Control is achieved by making use of a triple layered adaptive
nonlinear dynamic inversion algorithm. First, the basics of the control approach are explained.
Thereafter, each of the three individual control loops is described. Finally, some application
examples on a selection of failure scenarios will show the failure handing capabilities of this
fault tolerant control setup.
5.1 Control approach: Adaptive nonlinear dynamic inversion
A major advantage of dynamic inversion is its ability to naturally handle changes of operating
condition, which removes the need for gain scheduling, e.g. as is the case for classical control
methods. This is especially advantageous for control of space re-entry vehicles, due to their
extreme and wide operating conditions which include hypersonic speed during re-entry and
subsonic regions during the terminal glide approach phase to the runway. Another advantage
is its natural property of decoupling the control axes, i.e. no coupling effects remain between
101
Fault Tolerant Flight Control, a Physical Model Approach

steering channels and the different degrees of freedom. NDI control has been implemented in
the Lockheed F-35 Lightning II, (Balas (2003); Walker & Allen (2002)).
Nonlinear dynamic inversion considers original nonlinear systems of the afﬁne form:
˙x = a (x) + b (x) u
(1)
and provides a solution for the physical control input u by introducing an outerloop virtual
control input ν :
u = b−1 (x) [ν −a (x)]
(2)
which results in a closed-loop system with a decoupled linear input-output relation:
˙x = ν
(3)
A linear outer loop control law is sufﬁcient to enforce exponentially stable tracking dynamics,
where the control gains can be determined by the required closed loop characteristics.
Dynamic inversion is a popular control method for ﬂight control and aircraft guidance, (Balas
et al. (1992); Campa et al. (2005); da Costa et al. (2003); Ramakrishna et al. (2001); Reiner et al.
(1996); van Soest et al. (2006)) as well as reconﬁguring control, (Ganguli et al. (2005; 2006);
Oppenheimer & Doman (2006); Ostroff & Bacon (2002)).
The main assumption in NDI is that the plant dynamics are assumed to be perfectly known
and therefore can be cancelled exactly. However, in practice this assumption is not realistic,
not only with respect to system uncertainties but especially to unanticipated failures for the
purpose of fault tolerant ﬂight control. In order to deal with this issue, one can make use of
robust control methods as outer loop control to minimize or suppress undesired behaviour
due to plant uncertainties which cause imperfect plant dynamic cancellation. Other control
methods such as neural networks also have been proposed in the literature, in order to
augment the control signal as a compensation for the non-inverted dynamics, as explained
previously. However, another solution to the weakness of classical NDI, namely its sensitivity
to modelling errors, is the use of a real time identiﬁcation algorithm, which supplies updated
model information to the dynamic inversion controller. These augmented structures are called
adaptive nonlinear dynamic inversion (ANDI). The latter procedure is the method of choice
for this research which led to the results presented in this paper.
5.2 Autopilot control loops
Three consecutive inversion loops have been implemented, namely a body angular rate loop,
an aerodynamic angle loop and a navigation loop. The developed control laws are described
below.
5.2.1 Body angular rate loop
Consider the dynamic equation of an aircraft:
˙ω = I−1Ma −I−1ω × Iω
(4)
where ω =
p q rT are the rotational rates and Ma =
La Ma Na
T the aerodynamic
moments acting on the aircraft. The inertia matrix I stands for:
I =
⎡
⎣
Ixx
−Ixy
−Ixz
−Iyx
Iyy
−Iyz
−Izx
−Izy
Izz
⎤
⎦
(5)
102
Advances in Flight Control Systems
www.ebook3000.com

where the moments of inertia Ixy, Iyx, Iyz and Izy are assumed to be zero.
Fig. 6. NDI rate control inner loop
Rewriting the aircraft dynamics into the form of eq. (2):
⎡
⎣
δa
δe
δr
⎤
⎦
=
⎡
⎣
b ˜Clδa
0
b ˜Clδr
0
c ˜Cmδe
0
b ˜Cnδa
0
b ˜Cnδr
⎤
⎦
−1
·
	1
2ρV2S

−1
⎛
⎝I
⎡
⎣
νp
νq
νr
⎤
⎦+
⎡
⎣
p
q
r
⎤
⎦× I
⎡
⎣
p
q
r
⎤
⎦
⎞
⎠−
⎡
⎣
bClstates
cCmstates
bCnstates
⎤
⎦
⎫
⎬
⎭
(6)
where the virtual inputs

νp
νq
νr
T are the time derivatives of the rotational rates of the
aircraft. All control and state derivatives in this expression are estimated via the real time
identiﬁcation procedure.
5.2.2 Aerodynamic angle loop
The middle loop quantities are roll angle φ, angle of attack α and sideslip angle β:
⎡
⎣
p
q
r
⎤
⎦
=
⎡
⎢⎢⎣
1
sin φ tan θ
cos φ tan θ
−
vb
√
V2−w2
b
ub
√
V2−w2
b
0
wb
√
V2−v2
b
0
−ub
√
V2−v2
b
⎤
⎥⎥⎦
−1
·
⎧
⎪
⎪
⎨
⎪
⎪
⎩
⎡
⎣
ν ˙φ
ν˙α
ν ˙β
⎤
⎦−
⎡
⎢⎢⎣
0
−
1
√
V2−w2
b
(Az + g cos θ cos φ)
1
√
V2−v2
b

Ay + g cos θ sin φ

⎤
⎥⎥⎦
⎫
⎪
⎪
⎬
⎪
⎪
⎭
(7)
5.2.3 Navigation loop
The procedure used in this step is inspired by the method used in ref. Holzapfel (2004),
although the application for this study implies some important deviations compared to the
conventional method, since an adaptive model needs to be taken into account. Main crux in
this deviating approach is that this inversion loop consists of two separate steps. First, the
103
Fault Tolerant Flight Control, a Physical Model Approach

kinematics based virtual inputs are transformed towards the roll angle and the symmetric
aerodynamic forces through a physically interpretable nonlinear mapping. Consequently,
the aforementioned force components are translated into commanded angle of attack and
dimensionless thrust values via a classical NDI-setup as used before, which involves a local
gradient determination step.
The kinematics based inversion is as follows:
FAX
=
m
 ˙V + g sin γ

(8)
FAZ
=
−cos γ



m2
	
g + V ˙γ
cos γ

2
+ (V ˙χ)2

−
	 FAY
cos γ

2
(9)
μ
=
arctan

˙χ cos γ
˙γ + g cos γ
V
 
(10)
where FAZ corresponds to |Frequired| and μ is in fact μrequired.
The subsequent aerodynamic forces based inversion is as follows:
	
α
TC

=
⎛
⎜
⎝
FAXα
FAXTc
FAYα
FAYTc
FAZα
FAZTc
⎞
⎟
⎠
† ⎡
⎢⎣
⎛
⎝
FAXcomm
FAY
FAZcomm
⎞
⎠−
⎛
⎜
⎝
FAX0
FAY0
FAZ0
⎞
⎟
⎠
⎤
⎥⎦
(11)
where the symbol † denotes the left inverse.
More information about how these control laws have been derived in detail can be found in
ref. Lombaerts (2010); Lombaerts et al. (2010b). Summarizing, the global setup of the third
dynamic inversion loop can be found in ﬁgure 7.
Fig. 7. Third NDI autopilot loop, featuring VTAS, γ and χ control. LGD stands for local
gradient determination. TSM represents the two step method model identiﬁcation block
elaborated in section 4.
Linear controllers act on each separate NDI loop, as indicated by "LC" in ﬁg. 6 and 7. These
linear controllers involve proportional and proportional-integral control, and gains have been
selected to ensure favourable ﬂying qualities by means of damping ratio ζ and natural
frequency ωn while complying with the time scale separation principle. Optimization of
these gain values has been achieved by means of multi-objective parameter synthesis (MOPS)
optimization, see ref. Lombaerts (2010); Looye (2007); Looye & Joos (2006).
104
Advances in Flight Control Systems
www.ebook3000.com

5.3 Evaluations of autopilot experiments on RECOVER
Implementation of these control laws results in the controller performance illustrated in the
following simulation results. Besides the unfailed scenario the following failures have been
investigated: vertical tail loss and engine separation. In each scenario, the failure occurs
exactly at t = 50s.
5.3.1 Nominal unfailed
A complex manoeuvre is performed to evaluate the performance of the fault tolerant
controller. Three joint commands are given, more precisely a course change of Δχ = 160◦
at t = 70s, an altitude change towards h = 5000m at t = 80s and a velocity change of
ΔV = 50m/s around t = 110s. This scenario allows to evaluate the performance as well as
eventual inadvertent couplings between the different channels. The tracking of the reference
signals is satisfactory and couplings are minimal to even non-existent, as can be seen in ﬁg.
8. In the control surface deﬂection time histories in ﬁgures 9 and 10(a), it can be seen that the
elevators compensate ﬁrst for the vertical lift component loss induced by the turn, and then
initiate the altitude change. Ailerons and rudders cooperate in order to achieve a coordinated
turn. It can be seen that the spoilers assist the ailerons to set the turn up. The speciﬁc forces in
ﬁg. 10(b) indicate an acceptable behaviour. The responses of the unfailed aircraft will serve as
a comparison basis to evaluate the performance of the controller in failed situations.
0
100
200
300
400
500
−200
0
200
χ [°]
tracking quantities
0
100
200
300
400
500
−10
0
10
γ [°]
0
100
200
300
400
500
100
150
200
Vtas [m/s]
0
100
200
300
400
500
0
5000
10000
h [m]
time [s]
(a) tracking quantities
0
200
400
600
−0.1
0
0.1
pbody     
States
0
200
400
600
−1
01
phi       
0
200
400
600
−0.1
0
0.1
qbody     
0
200
400
600
0
0.1
0.2
theta     
0
200
400
600
−0.050
0.05
rbody     
0
200
400
600
−505
psi       
0
200
400
600
100
150
200
VTAS      
0
200
400
600
0
5000
10000
he        
0
200
400
600
0
0.1
0.2
alpha     
0
200
400
600
−5
05
x 10
4
xe        
0
200
400
600
−5
05
x 10
−3
beta      
0
200
400
600
0
24
x 10
4
ye        
(b) states
Fig. 8. Tracking quantities and states for the unfailed scenario
0
100
200
300
400
500
−5
0
5
10
15
 
 
inner elevator right
inner elevator left
outer elevator right
outer elevator left
0
100
200
300
400
500
−2
−1.5
−1
−0.5
0
0.5
 
 
stabilizer angle
upper rudder
lower rudder
(a) deﬂections of elevators, stabilizer and
rudders
0
100
200
300
400
500
−5
0
5
 
 
inner aileron right
inner aileron left
outer aileron right
outer aileron left
0
100
200
300
400
500
−1
−0.5
0
0.5
1
 
 
outer flaps
inner flaps
(b) deﬂections of ailerons and ﬂaps
Fig. 9. Deﬂections of elevators, stabilizer, rudders, ailerons and ﬂaps for the unfailed scenario
105
Fault Tolerant Flight Control, a Physical Model Approach

0
100
200
300
400
500
0
0.5
1
1.5
2
 
 
spoiler #1
spoiler #2
spoiler #3
spoiler #4
spoiler #5
spoiler #6
0
100
200
300
400
500
0
1
2
3
4
5
 
 
spoiler #7
spoiler #8
spoiler #9
spoiler #10
spoiler #11
spoiler #12
(a) deﬂections of spoilers
0
100
200
300
400
500
−2
0
2
4
Specific forces in body axes
Axb [m/s2]
0
100
200
300
400
500
−0.1
0
0.1
Ayb [m/s2]
0
100
200
300
400
500
−15
−10
−5
Azb [m/s2]
(b) speciﬁc forces
Fig. 10. Deﬂections of spoilers and speciﬁc forces for the unfailed scenario
5.3.2 Vertical tail loss
For this failure scenario, the reference signals have been slightly adapted. No speed change
is requested here, because this makes it more demanding for the control surfaces. When the
speed increase is maintained, the increasing aerodynamic damping reduces the disturbing
effect of the failure. The altitude capture has been changed accordingly to 1500m, in order to
prevent throttle saturation. Aerodynamic damping is the very reason why, in practice, control
laws actually work with calibrated airspeed CAS, in this way the control actions are related to
the dynamic pressure and control surface efﬁciency is maintained.
Figure 12(b) reveals the compensating behaviour of the ailerons which takes into account the
loss of the vertical tail and the cessation of rudder functioning after failure, as can be seen
in ﬁg. 12(a). It can be observed that the ailerons effectively take over the function of yaw
damper, assisted by the spoilers in ﬁg. 13(a), since the rudders are lost. Figure 13(b) shows
that the oscillation in the lateral speciﬁc force Ay is only damped in the longer term, which
can be explained by the fact that ailerons and spoilers have no direct inﬂuence on the yawing
moment, but on the rolling moment.
0
100
200
300
400
500
−200
0
200
χ [°]
tracking quantities
0
100
200
300
400
500
−10
0
10
γ [°]
0
100
200
300
400
500
120
130
140
Vtas [m/s]
0
100
200
300
400
500
0
1000
2000
h [m]
time [s]
(a) tracking quantities
0
200
400
600
−0.1
0
0.1
pbody     
States
0
200
400
600
−0.5
0
0.5
phi       
0
200
400
600
−0.1
0
0.1
qbody     
0
200
400
600
0
0.2
0.4
theta     
0
200
400
600
−0.050
0.05
rbody     
0
200
400
600
−505
psi       
0
200
400
600
120
130
140
VTAS      
0
200
400
600
0
1000
2000
he        
0
200
400
600
0
0.1
0.2
alpha     
0
200
400
600
−5
05
x 10
4
xe        
0
200
400
600
−0.2
0
0.2
beta      
0
200
400
600
0
24
x 10
4
ye        
(b) states
Fig. 11. Tracking quantities and states for the tail loss scenario
5.3.3 Engine separation
The engine separation scenario is a very sensitive situation to combine commands in
heading, altitude and speed simultaneously. Crucial in this context is to avoid engine throttle
saturation. Therefore, in this experiment only a heading change has been considered, as shown
106
Advances in Flight Control Systems
www.ebook3000.com

0
100
200
300
400
500
−5
0
5
10
15
 
 
inner elevator right
inner elevator left
outer elevator right
outer elevator left
0
100
200
300
400
500
−2
−1.5
−1
−0.5
0
0.5
 
 
stabilizer angle
upper rudder
lower rudder
(a) deﬂections of elevators, stabilizer and
rudders
0
100
200
300
400
500
−20
−10
0
10
20
 
 
inner aileron right
inner aileron left
outer aileron right
outer aileron left
0
100
200
300
400
500
−1
−0.5
0
0.5
1
 
 
outer flaps
inner flaps
(b) deﬂections of ailerons and ﬂaps
Fig. 12. Deﬂections of elevators, stabilizer, rudders, ailerons and ﬂaps for the tail loss scenario
0
100
200
300
400
500
0
5
10
15
 
 
spoiler #1
spoiler #2
spoiler #3
spoiler #4
spoiler #5
spoiler #6
0
100
200
300
400
500
0
5
10
15
 
 
spoiler #7
spoiler #8
spoiler #9
spoiler #10
spoiler #11
spoiler #12
(a) deﬂections of spoilers
0
100
200
300
400
500
−2
0
2
4
Specific forces in body axes
Axb [m/s2]
0
100
200
300
400
500
−2
−1
0
1
Ayb [m/s2]
0
100
200
300
400
500
−15
−10
−5
Azb [m/s2]
(b) speciﬁc forces
Fig. 13. Deﬂections of spoilers and speciﬁc forces for the tail loss scenario
in ﬁg. 14(a). Moreover, a limited maximum roll angle has been imposed, due to the restricted
safe ﬂight envelope as explained in section 3. It has been found that altitude and speed
changes are also feasible separately, but these are not discussed in this section.
The time histories of the states in ﬁg. 14(b) reveal that the aircraft in post failure conditions ﬂies
with a small nonzero roll angle and sideslip angle, due to the asymmetric damage, despite a
zero commanded sideslip angle. The control surface deﬂections in ﬁgures 15 and 16(a) conﬁrm
the cessation of functioning of the control surfaces which are powered by the hydraulic circuits
connected to engines number 3 and 4, as illustrated in ﬁg. 2(b). The remaining operative
surfaces are successful in keeping the aircraft in equilibrium and under control, although
with restricted authority. The nonzero lateral speciﬁc force in ﬁg. 16(b) is a consequence of
the sideslipping ﬂight.
Two additional interesting quantities to investigate are the throttle setting and the average
square innovation, which triggers the re-identiﬁcation routine as explained in ref. Lombaerts
et al. (2009; 2010a). Figure 17(a) conﬁrms that the throttle setting does not saturate, however
the remaining control margins in order to remain inside the safe ﬂight envelope are severely
restricted. This is due to the asymmetric thrust which needs to be compensated by the
control surfaces. The spike at t = 50s is caused by the feedforward path in the controller,
which is needed to compensate for the instantaneous speed loss of the two dead engines.
Figure 17(b) depicts the values for the average square innovation for each force and moment
channel separately. At t = 50s, it can be seen that the threshold for ΔX is exceeded, and a
107
Fault Tolerant Flight Control, a Physical Model Approach

0
100
200
300
400
500
0
100
200
χ [°]
tracking quantities
0
100
200
300
400
500
−5
0
5
γ [°]
0
100
200
300
400
500
120
130
140
Vtas [m/s]
0
100
200
300
400
500
580
600
620
h [m]
time [s]
(a) tracking quantities
0
200
400
600
−0.05
0
0.05
pbody     
States
0
200
400
600
−0.2
0
0.2
phi       
0
200
400
600
−0.10
0.1
qbody     
0
200
400
600
0
0.1
0.2
theta     
0
200
400
600
−0.020
0.02
rbody     
0
200
400
600
−505
psi       
0
200
400
600
120
130
140
VTAS      
0
200
400
600
580
600
620
he        
0
200
400
600
0
0.1
0.2
alpha     
0
200
400
600
−5
05
x 10
4
xe        
0
200
400
600
−0.05
0
0.05
beta      
0
200
400
600
0
24
x 10
4
ye        
(b) states
Fig. 14. Tracking quantities and states for the engine separation scenario
0
100
200
300
400
500
−5
0
5
10
15
 
 
inner elevator right
inner elevator left
outer elevator right
outer elevator left
0
100
200
300
400
500
−5
0
5
10
 
 
stabilizer angle
upper rudder
lower rudder
(a) deﬂections of elevators, stabilizer and
rudders
0
100
200
300
400
500
−20
−10
0
10
20
 
 
inner aileron right
inner aileron left
outer aileron right
outer aileron left
0
100
200
300
400
500
−1
−0.5
0
0.5
1
 
 
outer flaps
inner flaps
(b) deﬂections of ailerons and ﬂaps
Fig. 15. Deﬂections of elevators, stabilizer, rudders, ailerons and ﬂaps for the engine
separation scenario
0
100
200
300
400
500
0
5
10
15
20
 
 
spoiler #1
spoiler #2
spoiler #3
spoiler #4
spoiler #5
spoiler #6
0
100
200
300
400
500
0
0.1
0.2
0.3
0.4
 
 
spoiler #7
spoiler #8
spoiler #9
spoiler #10
spoiler #11
spoiler #12
(a) deﬂections of spoilers
0
100
200
300
400
500
−2
0
2
4
Specific forces in body axes
Axb [m/s2]
0
100
200
300
400
500
−0.5
0
0.5
1
Ayb [m/s2]
0
100
200
300
400
500
−15
−10
−5
Azb [m/s2]
(b) speciﬁc forces
Fig. 16. Deﬂections of spoilers and speciﬁc forces for the engine separation scenario
108
Advances in Flight Control Systems
www.ebook3000.com

re-identiﬁcation procedure is triggered for CX. It has become necessary to include the sideslip
angle β, which has become signiﬁcant due to the sideslipping ﬂight, as an additional regressor
in the identiﬁcation procedure. This leads to a successful new identiﬁcation procedure which
is performed extremely quickly as can be seen in this ﬁgure. This result conﬁrms the beneﬁcial
contribution from the identiﬁcation routine in this fault tolerant ﬂight control setup.
0
100
200
300
400
500
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
time [s]
Tc [−]
throttle behaviour
(a) throttle behaviour
0
100
200
300
400
500
0
2
4
6
8
10
12
time [s]
average square innovation Δ
average square innovation as trigger for re−identification 
 
 
ΔX
ΔZ
Δm
ΔY
Δl
Δn
(b) average square innovation as trigger for
re-identiﬁcation
Fig. 17. Spoilers and speciﬁc forces for the engine separation scenario
5.4 Manual control loops
A manual variant of this fault tolerant controller has been developed as well. This variant
consists of the body angular rate inner loop as described in section 5.2.1, augmented by the
sideslip β coordination axis only from the aerodynamic angle middle loop as explained in
section 5.2.2. Throttle control is by the conventional autothrottle. As a result, the pilot steers
roll rate p by means of the control wheel, pitch rate q with the control columns, and ﬁnally
the pedals can be used for creating a nonzero sideslipping ﬂight, although this is rarely used.
Since dynamic inversion is used in all control loops, these steering channels are effectively
decoupled.
5.5 Simulator evaluation of manual controller
This manual control setup has been applied in the SIMONA (SImulation, MOtion and
NAvigation) Research Simulator (SRS), see ﬁg.18(a). It is a pilot-in-the-loop ﬂight simulator
developed, built and operated by Delft University of Technology. It provides researchers with
a ﬂexible powerful tool that can be adapted to various uses, see ref. Stroosma et al. (2003).
The simulator’s ﬂexible software architecture and high-ﬁdelity cueing environment allows
the integration of a variety of aircraft simulation models, such as the aforementioned Boeing
747 benchmark simulation model from ref. Smaili et al. (2006). Its inputs and outputs were
standardized to ﬁt the SRS software environment and the SIMULINKTM simulation model
as well as NDI-controller were converted to C code using Real-Time Workshop. Finally the
models were integrated with the pilot controls, aircraft instruments (Figure 18(b)) and other
cueing devices of the SRS (i.e. outside visual and motion systems). On the ﬂight deck of
the SRS the evaluation pilot was presented with ﬂight instruments representative of a large
transport aircraft, a control column with large transport aircraft feel system dynamics, a
central pedestal with dual engine controls and a wide collimated view on a virtual outside
world. The simulator’s motion system was tuned to give the pilot realistic inertial motion
109
Fault Tolerant Flight Control, a Physical Model Approach

cues in nominal and failure conditions. The test pilots were four Boeing 747 captains (one
retired) and one other wide body captain on Airbus A330 and Boeing 767. All were familiar
with the research simulator practices used for this investigation.
(a) outside view
(b) cockpit view
Fig. 18. The SIMONA (SImulation, MOtion and NAvigation) Research Simulator (SRS) at
Delft University of Technology, photo by Joost Ellerbroek
The adaptive NDI control system has been validated on two failure scenarios, namely the
engine separation failure and the rudder runaway scenarios. Fig. 19 shows the evaluation
trajectory during the piloted simulation runs in SIMONA. The trajectory consists of four
main phases, namely altitude capture, bank angle capture, localizer intercept and glideslope
intercept. For every phase, required and adequate performance speciﬁcations have been
deﬁned for the relevant longitudinal as well as lateral quantities. The scheme presented in
ﬁg. 20 assists the pilot in rating the handling qualities (Cooper & Harper (1969)) of the aircraft
while taking into account the performance of the aircraft with respect to the aforementioned
requirements. Fig. 21 shows the time histories of a selection of the most important aircraft
states. These conﬁrm the evaluation trajectory as shown in ﬁg. 19. Moreover, altitude and roll
angle plots show altitude and roll angle captures which have been executed by the test pilot
in order to evaluate the post-failure handling qualities of the aircraft.
The handling qualities results for the algorithm show that, especially for the El Al Flight
1862 scenario, conventional ﬂight control was restored to acceptable levels while physical
and mental workload were reduced signiﬁcantly. This is illustrated in Figure 22 where an
example is given of lateral handling quality pilot ratings for the localizer capture task.
It can be seen that, for this task, both the baseline and fault-tolerant ﬂy-by-wire (FBW)
aircraft were rated Level 1 (Rating 1-3). After separation of the right-wing engines (Figure
22), lateral handling qualities degraded to Level 2 for the conventional aircraft with the
classical control system. The reconﬁgured aircraft (FBW) shows about Level 1 handling
qualities after incurring signiﬁcant damage due to the loss of the right-wing engines. This
was substantiated by measured pilot control activities, representative of workload, indicating
no pilot compensation after reconﬁguration. For the rudder runaway failure, however, Level
2 handling qualities remained after reconﬁguration despite the fact that no sustained pilot
compensation was required. The difference was most probably caused by the fact that this
initial setup is a rate control and hold loop instead of a rate control attitude hold type. As a
consequence, angular rate disturbances are corrected for automatically by the controller but
subsequent disturbances from the equilibrium attitude had to be compensated for by the pilot
himself. The use of a rate control attitude hold setup will solve this issue.
Figure 23 illustrates the physical workload analysis results by depicting the average pilot
forces. In the graph, a distinction is made between roll, pitch and yaw channel, as illustrated
110
Advances in Flight Control Systems
www.ebook3000.com

Fig. 19. Trajectory of the piloted simulation runs in SIMONA.
by the three graphs separated vertically. In each control channel, six cases have been studied,
namely unfailed, engine separation and rudder runaway, each time with classical and fault
tolerant control. In each case, the workload ﬁgure of each of the ﬁve pilots is represented
individually by means of bar plots, after which the mean and standard deviations are
superimposed on these bar plots for every case, in order to facilitate mutual comparisons.
First of all, the unfailed conditions conﬁrm that this is a good comparison basis between classic
and FTFC, since both have the same ratings. Comparing classic control with FTFC for failed
conﬁgurations shows that overall values for average manual control forces over all pilots
decrease for FTFC in the failure scenarios. In addition, in the failure scenarios the standard
deviations also reduce from classic control towards FTFC. At ﬁrst sight this seems not the
case for the pedal forces. Closer inspection of the experimental data, however, reveals that
this is caused by the deviating performance of pilot no 2 (probably due to misconception of
the control principle within the fault tolerant controller). Finally, searching for overlap of the
errorbars between classic and FTFC shows that this overlap does not occur. This observation
makes the trends signiﬁcant, despite the limited number of experiment subjects.
As a global conclusion, which is supported by the graphs above, it can be stated that this fault
tolerant ﬂight controller improves the handling qualties and reduces physical pilot workload
considerably in failure conditions.
6. Conclusions and future work
Summarizing, it can be stated that, following numerous experiments, fault tolerant ﬂight
control using a physical modular approach is successful in recovering damaged aircraft.
The designed methods are capable to accommodate the damage scenarios which have been
investigated in this project. It has been found that the engine separation scenario, based upon
111
Fault Tolerant Flight Control, a Physical Model Approach

Fig. 20. Cooper Harper Handling Qualities Rating Scale, source: Cooper & Harper (1969)
0
200
400
600
800
1000
1200
1400
0
0.2
0.4
pitch [rad]
Selection of aircraft states rudder runaway scenario
0
200
400
600
800
1000
1200
1400
0
0.1
0.2
angle of attack [rad]
0
200
400
600
800
1000
1200
1400
−0.5
0
0.5
angle of sideslip [rad]
time [s]
0
200
400
600
800
1000
1200
1400
−0.2
0
0.2
flight path angle [rad]
time [s]
 
 
classic
FTFC
0
200
400
600
800
1000
1200
1400
0
500
1000
altitude [m]
Selection of aircraft states rudder runaway scenario
0
200
400
600
800
1000
1200
1400
−5
0
5
heading [rad]
0
200
400
600
800
1000
1200
1400
50
100
150
true airspeed [m/s]
time [s]
0
200
400
600
800
1000
1200
1400
−1
0
1
roll angle [rad]
time [s]
 
 
classic
FTFC
Fig. 21. Comparison of a selection of aircraft states for the rudder runaway scenario
112
Advances in Flight Control Systems
www.ebook3000.com

(a) classical control
(b) fault tolerant control
Fig. 22. Localizer capture task handling qualities ratings for classical control and fault
tolerant control
0
2
4
6
classic
no failure
FTFC
no failure
classic
engine
separation
FTFC
engine
separation
classic
rudder
runaway
FTFC
rudder
runaway
roll force [Nm]
Average exerted pilot force during complete simulation run
0
10
20
30
40
classic
no failure
FTFC
no failure
classic
engine
separation
FTFC
engine
separation
classic
rudder
runaway
FTFC
rudder
runaway
pitch force [Nm]
0
100
200
300
yaw force [N]
 
 
classic
no failure
FTFC
no failure
classic
engine
separation
FTFC
engine
separation
classic
rudder
runaway
FTFC
rudder
runaway
pilot 1
pilot 2
pilot 3
pilot 4
pilot 5
mean
Fig. 23. Total average manual control forces during the simulation runs
El Al ﬂight 1862, is survivable with adaptive control techniques. Experiments have also shown
that the two step method is successful for real time identiﬁcation of damaged aircraft models,
including a real time static stability analysis. Autopilot control based upon adaptive nonlinear
dynamic inversion shows good failure handling capabilities.
An important aspect which has not been considered in this research is sensor loss detection.
Despite the presence of redundant sensors, recent aircraft accidents (Lombaerts (2010)) have
shown that sensor loss detection cannot be avoided and current monitoring techniques are not
always sufﬁcient. More elaborate ﬂight envelope protection algorithms, taking into account
a.o. minimum control airspeed limits, are another important topic for future research. Finally,
an important next step in the development of fault tolerant ﬂight control technologies is to
validate them in real ﬂight on board of manned as well as unmanned research aircraft. This is
one of the major challenges for the future.
113
Fault Tolerant Flight Control, a Physical Model Approach

7. References
Alwi, H. (2008). Fault Tolerant Sliding Mode Control Schemes with Aerospace Applications, PhD
thesis, University of Leicester.
Balas, G. (2003). Flight control law design: An industry perspective, European Journal of Control,
special issue 9(2–3): 207–226.
Balas, G., Garrard, W. & Reiner, J. (1992). Robust dynamic inversion control laws for aircraft
control, Proceedings of the AIAA Guidance, Navigation and Control Conference, AIAA,
Washington, DC, pp. 192–205.
Brinker, J. & Wise, K. (1999).
Nonlinear simulation analysis of a tailless advanced ﬁghter
aircraft reconﬁgurable ﬂight control law, AIAA Guidance, Navigation and Control
Conference and Exhibit, number AIAA-99-4040, Portland, OR.
Calise, A. J., Lee, S. & Sharma, M. (2001). Development of a reconﬁgurable ﬂight control law
for the x-36 tailless ﬁghter aircraft, AIAA Journal of Guidance, Control and Dynamics
24(5): 896–902.
Campa, G., Seanor, B., Gu, Y. & Napolitano, M. R. (2005). Nldi guidance control laws for close
formation ﬂight, American Control Conference, Portland, OR, USA.
Chu, Q. (2007). Lecture Notes AE4-394, Modern Flight Test Technologies and System Identication,
Delft University of Technology, Faculty of Aerospace Engineering.
Chu, Q., Mulder, J. & Sridhar, J. (1994).
Decomposition of aircraft state and parameter
estimation problems, Proceedings of fhe 10th IFAC Sympium on System Identiation, Vol.
Vol. 3, pp. pp. 61–66.
Cieslak, J., Henry, D., Zolghadri, A. & Goupil, P. (2008).
Development of an active
fault-tolerant ﬂight control strategy, AIAA Journal of Guidance, Control and Dynamics
31: 135–147.
Civil Aviation Safety Data 1993-2007 (2008). Technical report, Civil Aviation Authority of the
Netherlands (CAA-NL).
Cooper, G. & Harper, R. J. (1969). The use of pilot rating in the evaluation of aircraft handling
qualities, Technical Report TN D-5153, NASA.
Corvin, J. H., Havern, W. J., Hoy, S. E., Norat, K. F., Urnes, J. M. & Wells, E. A. (1991).
Self-repairing ﬂight control systems, volume i: Flight test evaluation on an f-15
aircraft, Final Report WL-TR-91-3025.
da Costa, R., Chu, Q. P. & Mulder, J. A. (2003). Re-entry ﬂight controller design using nonlinear
dynamic inversion, Journal of Spacecraft and Rockets 40(1): 64–71.
Ganguli, S., Papageorgiou, G., Glavaski, S. & M., E. (2005).
Piloted simulation of fault
detection, isolation and reconﬁguration algorithms for a civil transport aircraft, AIAA
Guidance, Navigation and Control Conference and Exhibit, number AIAA-2005-5936, San
Francisco, CA.
Ganguli, S., Papageorgiou, G., Glavaski, S. & M., E. (2006).
Aircraft fault detection,
isolation and reconﬁguration in the presence of measurement errors, AIAA Guidance,
Navigation and Control Conference and Exhibit, number AIAA-2006-6551, Keystone, Co.
Gavrilets, V. (2008). Damage tolerant ﬂight control systems for unmanned aircraft, ICAS/ATIO
Conference.
Hallouzi, R. & Verhaegen, M. (2008). Fault-tolerant subspace predictive control applied to a
boeing 747 model, AIAA Journal of Guidance, Control and Dynamics 31: 873–883.
Holzapfel, F. (2004). Nichtlineare adaptive Regelung eines unbemannten Fluggerätes, PhD thesis,
Lehrstuhl für Flugmechanik und Flugregelung, Technische Universität München.
Intelligent Flight Control: Advanced Concept Program (1999). Final Report BOEING-STL 99P0040,
The Boeing Company.
114
Advances in Flight Control Systems
www.ebook3000.com

Jategaonkar, R. (2006). Flight Vehicle System Identication: A Time Domain Methodology, Vol. 216
of Progress in Astronautics and Aeronautics Series, ﬁrst edn, AIAA.
Joosten, D., van den Boom, T. & Lombaerts, T. (2007).
Effective control allocation in
fault-tolerant ﬂight control with mpc and feedback linearization, Proceedings of the
European Conference on Systems and control, Kos, Greece, pp. 3552–3559.
Joosten, D., van den Boom, T. & Lombaerts, T. (2008). Fault-tolerant control using dynamic
inversion and model-predictive control applied to an aerospace benchmark, the
Proceedings of the 17th IFAC world congress, Vol. 17, pp. 12030–12035.
KrishnaKumar, K. & Gundy-Burlet, K. (n.d.).
Intelligent control approaches for aircraft
applications, Technical report, NeuroEngineering Laboratory, NASA Ames Research
Center.
Laban, M. (1994). Online aircraft aerodynamic model identication, PhD thesis, Delft University
of Technology.
Lombaerts, T. (2010). Fault Tolerant Flight Control. A Physical Model Approach, PhD thesis, Delft
University of Technology.
Lombaerts, T., Breeman, J., Joosten, D., van den Boom, T., Chu, Q., Mulder, J. & Verhaegen, M.
(2005). Speciﬁcations modelling document for Garteur AG16 fault tolerant control,
Technical report, Delft University of Technology.
Lombaerts, T., Chu, Q., Mulder, J. & Joosten, D. (2007). Real time damaged aircraft model
identiﬁcation for reconﬁguring control, Proceedings of the AIAA AFM Conference and
Exhibit, number AIAA-2007-6717, Hilton Head, SC.
Lombaerts, T., Chu, Q.-P., Mulder, J. A. & Joosten, D. (2009). Flight control reconﬁguration
based on a modular approach, Proceedings of the 7th IFAC SAFEPROCESS Symposium
on Fault Detection, Supervision and Safety of Technical Processes, pp. 259–264.
Lombaerts, T., Chu, Q.-P., Mulder, J. A. & Joosten, D. (2010a). Flight control reconﬁguration
based on a modular approach, Control Engineering Practice . under review.
Lombaerts, T., Joosten, D., J.H.Breemand, Smaili, H., Chu, Q., van den Boom, T., Mulder,
J. & Verhaegen, M. (2006).
Assessment criteria as speciﬁcations for reconﬁguring
control, proceedings of the AIAA Guidance, Navigation, and Control Conference and
Exhibit, number AIAA-2006-6331, Keystone, CO.
Lombaerts, T., Looye, G., Chu, Q. P. & Mulder, J. A. (2010b). Pseudo control hedging and its
application for safe ﬂight envelope protection, AIAA Guidance, Navigation and Control
Conference and Exhibit.
Lombaerts, T., Van Oort, E., Chu, Q. P., Mulder, J. A. & Joosten, D. (2010c). Online aerodynamic
model structure selection and parameter estimation for fault-tolerant control, Journal
of Guidance, Control and Dynamics . to be published.
Looye, G. (2007). An Integrated Approach to Aircraft Modelling and Flight Control Law Design,
PhD thesis, Delft University of Technology.
Looye, G. & Joos, H.-D. (2006). Design of autoland controller functions with multiobjective
optimization, AIAA Journal of Guidance, Control and Dynamics 29(2): 475–484.
Maciejowski, J. & Jones, C. N. (2003).
Mpc fault-tolerant ﬂight control case study: Flight
1862, Proceedings of the 5th IFAC Symposium on Fault Detection, Supervision and Safety of
Technical Processes SAFEPROCESS, Washington DC, USA, pp. 121–126.
Marcos, A. & Balas, G. (2003). A boeing 747 ˝U100/200 aircraft fault tolerant and diagnostic
benchmark, Technical Report AEM UUoM U2003 U1, Department of Aerospace and
Engineering Mechanics, University of Minnesota.
Morelli, E. (2000).
Real-time parameter estimation in the frequency domain, Journal of
Guidance, Control and Dynamics 23(5): 812–818.
115
Fault Tolerant Flight Control, a Physical Model Approach

Mulder, J. (1986). Design and evaluation of dynamic ight test manoeuvers, PhD thesis, TU Delft,
Faculty of Aerospace Engineering.
Mulder, J., Chu, Q., Sridhar, J., Breeman, J. & Laban, M. (1999). Non-linear aircraft ﬂight path
reconstruction review and new advances, Progress in Aerospace Sciences 35(7): 673–726.
Mulder, J., van Staveren, W., van der Vaart, J. & de Weerdt, E. (January 2006). Lecture Notes
AE3-302, Flight Dynamics, Delft University of Technology, Faculty of Aerospace
Engineering, Delft, The Netherlands.
Oppenheimer, M. & Doman, D. (2006). Efﬁcient reconﬁguration and recovery from damage
for air vehicles, Proceedings of the AIAA Guidance, Navigation and Control Conference
and Exhibit, number AIAA-2006-6552.
Ostroff, A. J. & Bacon, B. J. (2002). Enhanced ndi strategies for reconﬁgurable ﬂight control,
Proceedings of the American Control Conference, Anchorage, AK.
Ramakrishna, V., Hunt, L. & Meyer, G. (2001). Parameter variations, relative degree, and stable
inversion, Automatica 37: 871–880.
Reiner, J., Balas, G. J. & Garrard, W. L. (1996). Flight control design using robust dynamic
inversion and time-scale separation, Automatica 32(11): 1493–1504.
Smaili, H., Breeman, J. & Lombaerts, T. (2008).
A simulation benchmark for aircraft
survivability assessment, Proceedings of the International Congress of Aeronautical
Sciences, number 2008-9.3.2.
Smaili, M., Breeman, J., Lombaerts, T. & Joosten, D. (2006).
A simulation benchmark for
integrated fault tolerant ﬂight control evaluation, Proceedings of the AIAA Modelling
and Simulation Technologies Conference and Exhibit, number AIAA-2006-6471.
Stroosma, O., van Paassen, M. & Mulder, M. (2003).
Using the simona research simulator
for human-machine interaction research, AIAA Modeling and Simulation Technologies
Conference.
Szaszi, I., Ganguli, S., Marcos, A., Balas, G. J. & Bokor, J. (2002).
Application of fdi to a
nonlinear boeing 747 aircraft, 10th Mediterranean Conference on Control and Automation,
Lisbon, Portugal.
van Soest, W., Chu, Q. P. & Mulder, J. A. (2006). Combined feedback linearization and model
predictive control for re-entry ﬂight, AIAA Journal of Guidance, Control and Dynamics
29(2): 427–434.
Varga, A. (2007). Design of least order residual generators for fault detection and isolation with
application to monitoring actuator/surface faults for a boeing 747-100/200 aircraft,
Technical report, German Aerospace Center (DLR).
Varga, A. & Hecker, S. (2004). Methods for threshold selection for robust residual evaluation,
Technical report, German Aerospace Center (DLR).
Walker, G. & Allen, D. (2002).
X-35b stovl ﬂight control law design and ﬂying qualities,
Proceedings of the Biennial International Powered Lift Conference and Exhibit, number
AIAA-2002-6018.
Ward, D. & Barron, R. (1995).
A self-designing receding horizon optimal ﬂight controller,
Proceedings of the American Control Conference, Seattle, Washington.
116
Advances in Flight Control Systems
www.ebook3000.com

6 
Design of Intelligent Fault-Tolerant 
Flight Control System 
for Unmanned Aerial Vehicles 
Yuta Kobayashi and Masaki Takahashi 
Keio University 
Japan 
1. Introduction 
Recently, unmanned aerial vehicles (UAVs) have gained worldwide attention. Because the 
safety of people on board does not need to be considered, small UAVs can easily be made 
for low-cost. Therefore, a UAV can be used to observe disasters, to surveil for a long time, 
and so on. However, it also has several disadvantages such as unreliability and worse 
performance in unexpected situations. Because small UAVs must be easily made for low-
cost, adding a redundant on-board actuator or sensor in order to deal with unexpected 
situations is unsuitable. Thus, several researchers have proposed a flight control system 
using a software redundancy approach. 
For fault detection, methods using multiple-model adaptive estimation (MMAE) (Guillaume 
Ducard & Hans P. Geering, 2008), and system parameters (Mohammad Azam et al, 2005) have 
been proposed. However, because these methods design a model or parameters for only each 
assumed fault in designing, unexpected faults cannot be detected. On the other hand, another 
method discriminates between faults and natural disturbances like gusts of wind. (Jovan D. 
Boskobic et al, 2005) However, this is not easy because the expected disturbances are assumed 
in designing. Currently, the demand for a UAV flight control system is to discriminate 
between faults and natural disturbances fundamentally with a simple algorithm. 
In this research, an intelligent flight control system was developed that can discriminate 
between faults and natural disturbances in order to evaluate and deal with the situation. In 
the proposed control system, an evaluator of flight conditions was designed on the basis of 
the dynamics of a controlled object. Moreover, to deal with the situation adaptively, a new 
flight-path-planning generator was introduced on the basis of the evaluation. In this study, 
each subsystem was designed by a neural network. Moreover, the learning-based 
systematical design method was developed that uses evaluation functions for the 
subsystems. To verify the effectiveness of the proposed flight control system, a six-degree-
of-freedom nonlinear simulation was carried out. 
2. Aircraft motion 
The UAV treated in this research is a double-delta-wing UAV shown in Fig. 1. The coordinate 
system is defined in Table 1. The motion equation of an aircraft is derived from Newtonian 
dynamics. Six-degree-of-freedom nonlinear equation of motion is shown in Eq. (1).  

 
Advances in Flight Control Systems 
 
118 
1
el
δ
2
el
δ
1
er
δ
2
er
δ
CG
,
P L
,
Q M
,
R N
x
y
z
U
V
W
Vc
rδ
1
el
δ
2
el
δ
1
er
δ
2
er
δ
CG
,
P L
,
Q M
,
R N
x
y
z
U
V
W
Vc
rδ
 
Fig. 1. Body axis 
 
(
)
(
)
(
)
(
)
(
) (
)
(
)
2
2
sin
cos
sin
cos
cos
x
xz
z
y
xz
y
x
z
xz
z
xz
y
x
xz
X
m U
QW
VR
g
Y
m V
UR
PW
g
Z
m W
PV
UQ
g
L
PI
RJ
QR I
I
PQJ
M
QI
PR I
I
P
R
J
N
RI
PJ
PQ I
I
QRJ
=
+
−
+
Θ
=
+
−
−
Θ
Φ
=
+
−
−
Θ
Φ
=
−
+
−
−
=
+
−
+
−
=
−
+
−
+








 
(1) 
In Eq. (1), X, Y, and Z indicate each axis’s external force term except for gravitational force 
(including aerodynamic force, thrust force). In addition, 
and 
Φ,Θ,
Ψ  indicate Euler angle of 
each axis. The proper nonlinear model shown in Eq. (1) is used in the numerical simulation. 
In contrast, the linearized model based on Eq. (1) is used to design the controller. Many of 
parameters of motion equation are decided on the basis of the wind-tunnel experiment. The 
parameters that cannot be acquired in the experiment are estimated by the method using 
nonlinear function. (Kato et al, 1982)  
Each elevon steerage angle of the double-delta-wing UAV is expressed in Eq. (2) by using 
elevator steerage angle 
e
δ and aileron steerage angle 
a
δ . 
 
(
)
(
)
1
2
1
2
12
12
el
el
e
a
er
er
e
a
δ
δ
δ
δ
δ
δ
δ
δ
=
=
+
=
=
−
 
(2) 
3. Fault-tolerant system 
The block diagram of the proposed intelligent fault-tolerant flight control system is shown 
in Fig. 2. It is composed of fault detection, fault identification, and fault accommodation 
(FDIA). In this section, the brief summary of each system is represented. 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
119 
 
Velocity & 
Angular velocity 
External force & 
Moment 
Distance 
Forward 
U 
X 
x 
Starboard 
V 
Y 
y 
Down 
W 
Z 
z 
Roll 
P 
L 
 
Pitch 
Q 
M 
 
Yaw 
R 
N 
 
Table 1. Coordinate system and symbol 
 
Control
MDM/MDP
Distributor
Actuator
Flight
Model
Navigation
Kalman
Filter
Sensor
GPS
IMU
Estimator
NN
Detector
NN
Identifier
NN
Guidance
MDM/MDP
Flight Path
Generator
NN
Actuator 
Observed 
Value
Actuator command
Estimate Value
Observed 
Value
Guidance command
Flight Condition , Failure Position
Control
MDM/MDP
Distributor
Actuator
Flight
Model
Navigation
Kalman
Filter
Sensor
GPS
IMU
Estimator
NN
Detector
NN
Identifier
NN
Guidance
MDM/MDP
Flight Path
Generator
NN
Actuator 
Observed 
Value
Actuator command
Estimate Value
Observed 
Value
Guidance command
Flight Condition , Failure Position
 
Fig. 2. Block diagram of proposed flight control system 
3.1 Fault detection 
Fault detection is to distinguish faults from natural phenomena like gusts of wind. To 
achieve this, this research focused on how each influence on the dynamics of an aircraft, and 
then an estimator and a detector were designed. The estimator can estimate the ideal state of 
an UAV. The detector evaluates the flight conditions of an UAV by using the error 
information between the observed and estimated values. 
3.2 Fault identification 
Fault identification is to locate a broken actuator. To achieve this, an identifier was designed. 
Generally, to identify a fault, a method is used that sets a threshold value of error 

 
Advances in Flight Control Systems 
 
120 
information between an actuator command and a steerage value. However, this method 
depends on designer’s thought, and inevitably the design work gets into trial and error. By 
contrast, this research focused on the nonlinear mapping ability of a neural network to 
flexibly respond to changes. 
3.3 Fault accommodation 
Fault accommodation is to stabilize the flight conditions of an UAV when a fault emerges.  
To achieve this, a distributor and a flight path generator were designed. The distributor 
switches the distribution matrix that sends a control command to actuators on the basis of 
the location of a broken actuator. This countermeasure results in the maximum application 
of the remaining actuators. The flight path generator generates a new flight path which 
automatically takes account of both flight stability and following capability of mission 
trajectory on the basis of the evaluation result. 
4. Specific design of each component 
4.1 Guidance and control 
In this research, a coupled motion between longitudinal and lateral-directional is controlled. 
This is because the roll angular velocity is controlled by limiting the derivative value of the 
bank angle command. Therefore, the motion of UAV can be separated into longitudinal and 
lateral-directional motions. In the guidance and control system, longitudinal guidance, 
lateral-directional guidance, longitudinal control, and lateral-directional control were 
designed separately. The guidance and control laws were designed by multiple delay model 
and multiple design point (MDM/MDP) method. The block diagram of longitudinal 
guidance, lateral-directional guidance, longitudinal control, and lateral-directional control 
are shown in Figs. 3 to 6. 
4.2 Estimator 
The estimator achieves nonlinear dynamics of the UAV approximately by using nonlinear 
mapping ability of feedforward-type neural network. It estimates next state vectors of the 
UAV from previous state vectors and actuator steerage commands. 
The structure is three-layer neural network shown in Fig. 7. Input layer has 15 neurons, 
hidden layer has 18, and output layer has 9. In Fig. 4, the index of “obs” means the observed 
value, the index of “cmd” means the actuator steerage command, and the index of “est” 
 
1/s
1/s
Feedback/
Feedforward
Gain
Pitch
rate
δt
Pitch
rate*
δt*
dh/dt
Height
Ground
speed
Height
command
Ground speed
command
Delay
Model
Delay
Model
Longitudinal
Motion
Point Mass
Approximation
1/s
1/s
Feedback/
Feedforward
Gain
Pitch
rate
δt
Pitch
rate*
δt*
dh/dt
Height
Ground
speed
Height
command
Ground speed
command
Delay
Model
Delay
Model
Longitudinal
Motion
Point Mass
Approximation
 
Fig. 3. Block diagram of longitudinal guidance system 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
121 
 
1/s
Feedback/
Feedforward
Gain
Bank
angle
Bank
angle*
y
command
y
dy/dt
Sideslip angle = 0
Delay
Model
Lateral-
directionl
Motion
Point Mass
Approximation
1/s
Feedback/
Feedforward
Gain
Bank
angle
Bank
angle*
y
command
y
dy/dt
Sideslip angle = 0
Delay
Model
Lateral-
directionl
Motion
Point Mass
Approximation
 
Fig. 4. Block diagram of lateral-directional guidance system 
 
 
1/s
Feedback/
Feedforward
Gain
δe
Pitch rate 
command 
Delay
Model
Short-
1/s
Feedback/
Feedforward
Gain
δe
δe *
Pitch rate 
command 
Pitch rate
Normal 
Delay
Model
Longitudinal
Motion
Mode
Short-period
Approximation
acceleration 
 
Fig. 5. Block diagram of longitudinal control system 
 
 
1/s
1/s
Feedback/
Feedforward
Gain
Lateral -
directional
Motion
δa
δr
δ *
δr *
Yaw rate 
Bank angle 
command 
Sideslip angle 
command 
Delay
Model
Delay
Model
1/s
1/s
Feedback/
Feedforward
Gain
δa
δr
a
Roll rate
Bank angle 
Sideslip angle 
Bank angle 
command 
Sideslip angle 
command 
Delay
Model
Delay
Model
 
Fig. 6. Block diagram of lateral-directional control system 
 
cmd
tδ
obs
φ
obs
θ
obs
ψ
obs
p
obs
q
obs
r
obs
w
obs
v
obs
u
est
φ
est
θ
est
ψ
est
p
est
q
est
r
est
w
est
v
est
u
1cmd
er
δ
2cmd
er
δ
cmd
r
δ
1cmd
el
δ
2cmd
el
δ
cmd
tδ
obs
φ
obs
θ
obs
ψ
obs
p
obs
q
obs
r
obs
w
obs
v
obs
u
est
φ
est
θ
est
ψ
est
p
est
q
est
r
est
w
est
v
est
u
1cmd
er
δ
2cmd
er
δ
cmd
r
δ
1cmd
el
δ
2cmd
el
δ
 
Fig. 7. Structure of estimator neural network 

 
Advances in Flight Control Systems 
 
122 
means the estimated value. The transfer functions of each layer are shown in Eqs. (3) to (5), 
where each “tansig” and “purelin” means tangent-sigmoid function, linear function shown 
in Eqs. (6) and (7) respectively. In Eqs. (3) to (5), neti, netj, and netk mean the input of input 
layer, hidden layer, and output layer respectively. 
In addition, back propagation (BP) is applied for the learning of neural network. The flight 
data acquired with the six-degree-of-freedom nonlinear simulation is used as a teach signal. 
 
(
)
tansig
i
i
f
net
=
 
(3) 
 
(
)
tansig
j
j
f
net
=
 
(4) 
 
(
)
purelin
k
k
f
net
=
 
(5) 
 
( )
(
)
2
1
1
exp
2
f x
x
=
−
+
−⋅
 
(6) 
 
( )
f x
x
=
 
(7) 
4.3 Detector 
The detector discriminates the influence of fault on the UAV from that of natural 
disturbance such as gusts of wind by focusing on the impact on the dynamics of the UAV. It 
uses the error between observed value and estimated value as the information about the 
dynamics of the UAV. Moreover, the error between actuator steerage command and the real 
actuator steerage angle is used for the evaluation of the flight condition. The derivative of 
bank angle is also used. 
Because input-output characteristic is unknown, the structure of the detector is three-layer 
neural network shown in Fig. 8. Input layer has 10 neurons, hidden layer has 20, and output 
layer has 1. The transfer functions of each layer are shown in Eqs. (8) to (10). 
 
obs
φ
est
obs
p
p
−
cmd
obs
φ
φ
−
cmd
φ
est
obs
q
q
−
est
obs
r
r
−
est
obs
u
u
−
est
obs
v
v
−
est
obs
w
w
−
cmd
obs
q
q
−
Flight 
Condition
obs
φ
est
obs
p
p
−
cmd
obs
φ
φ
−
cmd
φ
est
obs
q
q
−
est
obs
r
r
−
est
obs
u
u
−
est
obs
v
v
−
est
obs
w
w
−
cmd
obs
q
q
−
Flight 
Condition
 
Fig. 8. Structure of detector neural network 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
123 
 
(
)
purelin
i
i
f
net
=
 
(8) 
 
(
)
tansig
j
j
f
net
=
 
(9) 
 
(
)
purelin
k
k
f
net
=
 
(10) 
Because there is no explicit teach signal, a genetic algorithm (GA) was applied for the 
learning of neural network. In GA, 50 individuals that encode the connection weight of a 
neural network were prepared. Both fitness proportionate and elite selection strategies were 
used. Moreover, with repeating random crossover and mutation, the individual that had the 
highest fitness was acquired. 3 cases about gust in different directions and 9 cases about left 
elevon-1 fault in different angles are used as the simulation case. Both gusts of wind and 
fault are occurred in horizontal flight. The fitness function is shown in Eq. (11), where 
dt  is 
the detection time, 
failure
t
 is the initiation time of fault, and 
da  is the constant value of 
detector for evaluation. In the evaluation, to detect the fault more quickly has higher score. 
In addition, in the gusts of wind cases, when the detector did false detection, the value of 
fitness function becomes zero. 
 
(
)
(
)
(
) (
)
0
exp
d
failure
d
d
failure
d
failure
t
t
J
a
t
t
t
t
⎧
<
⎪
= ⎨
⎪
−
⋅
−
≥
⎩
 
(11) 
4.4 Identifier 
The identifier locates where the broken actuator is by using the information of both actuator 
steerage command and actuator steerage angle. Neural network shown in Fig. 9 is located in 
each actuator and the location of broken actuator is identified by the outputs of each neural 
network.  
Because input-output characteristic is unknown, the structure of the identifier is three-layer 
neural network. Input layer has 3 neurons, hidden layer has 18, and output layer has 1. The 
 
obs
δ
cmd
obs
δ
δ
−
cmd
δ
Identifier Value
obs
δ
cmd
obs
δ
δ
−
cmd
δ
Identifier Value
 
Fig. 9. Structure of identifier neural network 

 
Advances in Flight Control Systems 
 
124 
transfer functions of each layer are shown in Eqs. (12) to (14). GA is applied for the learning 
of neural network. As the simulation case, 9 cases about left elevon-1 fault in different 
angles happened in horizontal flight are used. Equation (15) is the fitness function, where it  
is the identification time, 
failure
t
 is the initiation time of fault, and 
ia  is the constant value of 
identifier for evaluation. In the evaluation, to identify the location of broken actuator more 
quickly has higher score. 
 
(
)
purelin
i
i
f
net
=
 
(12) 
 
(
)
tansig
j
j
f
net
=
 
(13) 
 
(
)
purelin
k
k
f
net
=
 
(14) 
 
(
)
(
)
(
) (
)
0
exp
i
failure
i
i
failure
i
failure
t
t
J
a
t
t
t
t
⎧
<
⎪
= ⎨
⎪
−
⋅
−
≥
⎩
 
(15) 
4.5 Distributor 
The distributor switches the distribution matrix by using the outputs of the detector and the 
identifier. When the distribution matrix was changed, the elevator, aileron, and rudder 
commands from the control system are divided into 5 actuator commands (left elevon-1, left 
elevon-2, right elevon-1, right elevon-2, and rudder) to separate the broken actuator. The 
switching algorithm is to change the command for the broken actuator to zero and to realize 
the maximum use of the remaining actuators. The structure of the distributor is shown in 
Fig. 10. 
 
 
Fig. 10. Structure of distributor 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
125 
4.6 Flight path generator 
The flight path generator is located in parallel with the guidance system. It generates a new 
flight path which considers both flight stability and following capability of mission 
trajectory under the condition where the elevon fault is occurred.  
In general, there are two turning methods. One is to use a bank angle and the other a 
sideslip angle. To assure robustness against the rudder fault, the turning method using the 
bank angle was adopted in the guidance system. On the other hand, to assure robustness 
against the elevon fault, the turning method using the sideslip was adopted in the flight 
path generator. 
Generally, because drag increases when the sideslip angle is allowed to changes in the 
turning flight, too much energy is used. However, the emergency situation such as an 
elevon fault is an exception because keeping the flight stable is more important than saving 
energy. Therefore, the flight path generator has been designed that enables the sideslip 
angle to change.  
The flight path generator calculates the desired sideslip angle command by using Eq. (16), 
where 
standard
ref
β
is the standard sideslip angle command which achieves the turning flight in 
mission trajectory. To generate a new flight path by changing the radius adaptively, the 
flight path generator calculates Kβ  depending on the fault level. 
 
standard
ref
ref
Kβ
β
β
′ =
⋅
 
(16) 
Because input-output characteristic is unknown, the structure of the flight path generator is 
three-layer neural network shown in Fig.11. Input layer has 6 neurons, hidden layer has 1, 
and output layer has 1. The input signals of the flight path generator are the signals from 
both the detector and the identifier which are integrated in a given time. The transfer 
functions of each layer are shown in Eqs. (17) to (19), where 
i
shift  is the width of parallel 
shift. Equation (17) is the symmetric double sigmoid function. (Akihiko Shimura & Kazuo 
Yoshida, 2001)  
 
 C
Flight
ondition
　
1
 
el
Identifier Valueδ
Kβ
∫
∫
∫
∫
∫
∫
2
 
el
Identifier Valueδ
1
 
er
Identifier Valueδ
2
 
er
Identifier Valueδ
 
r
Identifier Valueδ
 C
Flight
ondition
　
1
 
el
Identifier Valueδ
Kβ
∫
∫
∫
∫
∫
∫
2
 
el
Identifier Valueδ
1
 
er
Identifier Valueδ
2
 
er
Identifier Valueδ
 
r
Identifier Valueδ
 
Fig. 11. Structure of flight path generator 

 
Advances in Flight Control Systems 
 
126 
 
(
)
(
)
{
}
1 tansig
-
tansig
2
i
i
i
i
i
f
net
shift
net
shift
=
+
+
 
(17) 
 
(
)
exp
j
j
f
net
=
 
(18) 
 
(
)
purelin
k
k
f
net
=
 
(19) 
GA is applied for the learning of neural network. As the simulation case, 7 cases about 
conducting the turning flight after left elevon-1 fault in different angles happened in 
horizontal flight are used.  The termination conditions of each simulation case are as 
follows.  
(A) 120
[deg]
300
[m]
500
x
ψ
<
<
< −
∩
 
(B) 
0.18
height <
 
(C) 
[deg]
4.9
29
[deg]
α
α
< −
<
∪
 
(D) 
[deg]
9.9
9.9
[deg]
β
β
< −
<
∪
 
Equation (20) is the fitness function, where 
1
ref
a
 and 
2
ref
a
 are the constant value for the 
following capability of mission trajectory. 
ref
Y
 is the y-direction target value of mission 
trajectory. 
ref
Y′  is the y-direction target value generated by the flight path generator. time , 
failure
time
, and 
stable
time
are respectively the simulation time,  the initiation time of fault , and 
the time when the error value between the real height and that of mission trajectory is 
controlled within the constant value. In the evaluation, both the following capability of 
mission trajectory and the flight stability are evaluated. 
In addition to Eq. (20), the termination conditions are also evaluated. When the simulation 
was stopped because of the termination condition except for (A), the value of fitness 
function becomes zero because the stability is lost.  
 
(
)
(
)
1
2
exp
exp
-
ref
ref
ref
ref
stable
J
a
a
Y
Y
time
time failure time
′
=
⋅
−
⋅
−
⎛
⎞
⎜
⎟
+
⎜
⎟
⎜
⎟
⎝
⎠
 
(20) 
5. Numerical simulation 
5.1 Simulation condition 
The effectiveness of the proposed intelligent fault-tolerant flight control system was verified 
with the six-degree-of-freedom nonlinear simulation. The airframe model, external 
environment model, and guidance/control law were considered as a mathematical model in 
the simulation. In the airframe model, the actuator characteristic was expressed using the 
second order time delay model with restrictions of position and velocity. In addition, the 
characteristic of sensor was assumed to be ideal that there were no errors in both static and 
dynamic conditions. As the external environment model, only wind was used. The constant 
wind model was constructed by using the MIL-F-9490D method applied to the ALFLEX 
simulation. (NAL/NASDA ALFLEX Group, 1994) It considered the difference of the 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
127 
airframe size by multiplying the scale-dependent constant value. The actuator-fixed fault 
such as Lock-in-place, Hard-over and Float was adopted as the actuator fault model. (Jovan 
D. Boskobic et al, 2005)  
As the mission trajectory, turning above devastated district in constant height to observe 
was applied. It is shown in Fig. 12. In this mission, the UAV flaw at the height of 30m in the 
velocity of 20m/s and the constant wind was from +x direction. The gusts of wind was 
expressed by changing the scale-dependent constant value of constant wind in 3 seconds. 
(Kohichiroh Yoshida et al, 1994)  In addition, not only the learned fault, left elevon-1 fault, 
but also non-learned fault, rudder fault, was considered. The conditions of fault and gust are 
represented in Table 2.  
In the simulation, the proposed intelligent fault-tolerant flight control system and the flight 
control system designed by MDM/MDP method were compared. 
 
 
Fig. 12. Mission trajectory 
 
Condition 
Time 
Direction 
Gust1 
15s 
From y minus 
Failure 
30s 
 
Gust2 
90s 
From x plus 
Table 2. Conditions of disturbance 
5.2 Simulation results 
In this section, the simulation results under the condition shown in section 5.1 are 
represented. 
First, Figs. 13 to 19 respectively show the results under the conditions where the left elevon-
1 was fixed at 9 degree for the flight trajectory, the time history of bank angle, sideslip angle, 
and actuator steerage. In addition, Table 3 shows the effective area. 
Second, the results for detection, identification, and accommodation are shown. The output 
of the detector and the identifier are respectively shown in Figs. 20 and 21. Figure 22 shows 
the relationship between the fixed angle of broken elevon and the y-direction target value 

 
Advances in Flight Control Systems 
 
128 
generated by the flight path generator. Moreover, the coherence functions between the 
observed value and the estimated value for velocity u and angular velocity q are compared 
under the conditions of a fault and gust of wind in Figs. 23 and 24. 
Finally, Figs. 25 and 26 show the results under the condition where the rudder was fixed at -
8 degree for the flight trajectory and the time history of actuator steerage. 
5.3 Evaluation 
From the results in Figs. 13 to 19, we confirmed how each method deals with the fault in 
which the elevon is fixed at the angle. 
The conventional system generates a bank angle command and achieves a turning flight by 
using an elevon. On the other hand, the proposed flight control system stabilizes the 
airframe by using redundant elevon in horizontal flight as soon as the fault happens. After 
that, it generates a sideslip angle command and achieves a turning flight by using a rudder. 
 
  
-1000 0
1000
2000
-1000
0
1000
20000
20
40
y [m]
x [m]
-z [m]
Proposed System
Normal System
Proposed System
Normal System
 
Fig. 13. Flight trajectory (left elevon-1 fault) 
 
0
50
100
150
200
250
300
350
-10
0
10
20
time [s]
bank angle [deg]
 
 
obs
cmd
Gust Failure
Gust
Turning
Straight
Straight
 
Fig. 14. Time history of bank angle (normal system)  
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
129 
 
0
50
100
150
200
250
300
350
-10
0
10
20
time [s]
bank angle [deg]
 
 
obs
cmd
Gust Failure
Gust
Turning
Straight
Straight
Straight
Turning
 
Fig. 15. Time history of bank angle (proposed system) 
 
0
50
100
150
200
250
300
350
-10
-5
0
5
10
time [s]
sideslip angle [deg]
 
 
obs
cmd
Gust Failure
Gust
Turning
Straight
Straight
 
Fig. 16. Time history of sideslip angle (normal system) 
 
Gust Failure
Gust
0
50
100
150
200
250
300
350
-10
-5
0
5
10
time [s]
sideslip angle [deg]
 
 
obs
cmd
Turning
Straight
Straight
Straight
Turning
 
Fig. 17. Time history of sideslip angle (proposed system) 

 
Advances in Flight Control Systems 
 
130 
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
0
5
10
15
time[s]
350obs
cmd
Gust Failure Gust
 
Fig. 18. Time history of actuator steerage (normal system) 
 
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
0
5
10
15
time[s]
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
350obs
cmd
Gust Failure Gust
 
Fig. 19. Time history of actuator steerage (proposed system) 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
131 
0
10
20
30
40
50
60
0
1
2
3
time[s]
Flight Condition
Gust
Failure
 
Fig. 20. Output of detector neural network 
Gust
Failure
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
1
el
δ
2
el
δ
1
er
δ
2
er
δ
rδ
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
1
el
δ
2
el
δ
1
er
δ
2
er
δ
rδ
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
1
el
δ
2
el
δ
1
er
δ
2
er
δ
rδ
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
0
10
20
30
40
50
60
-2
2
time[s]
1
el
δ
2
el
δ
1
er
δ
2
er
δ
rδ
 
Fig. 21. Output of identifier neural network 
 
-10
-5
0
5
10
800
1000
1200
1400
degree of the locked angle[deg]
Target Value of Y direction [m]
-10
-5
0
5
10
800
1000
1200
1400
degree of the locked angle[deg]
Target Value of Y direction [m]
Proposed System
Normal System
Proposed System
Normal System
 
Fig. 22. Target value generated by flight path generator 

 
Advances in Flight Control Systems 
 
132 
 
0
10
20
30
40
50
0
0.5
1
Frequency [Hz]
Coherence Function
 
 
Fault
Gust
 
 
Fig. 23. Coherence function, u 
 
0
10
20
30
40
50
0
0.5
1
Frequency [Hz]
Coherence Function
 
 
Fault
Gust
 
 
Fig. 24. Coherence function, q 
 
-1000 0
1000
2000
-1000
0
1000
20000
20
40
y [m]
x [m]
-z [m]
 
 
Fig. 25. Flight trajectory (rudder fault) 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
133 
 
 
 
 
 
 
 
 
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
-10
0
10
0
50
100
150
200
250
300
350
0
5
10
15
time[s]
350obs
cmd
Gust Failure Gust
 
 
 
 
 
 
 
 
Fig. 26. Time history of actuator steerage (rudder fault) 
 
 
Fault position 
Elevon 
Rudder 
Range of movement [deg] 
-13～13 
-8～8 
Effective area[deg] 
-13～9 
-8～8 
 
Table 3. Effective area of proposed system 

 
Advances in Flight Control Systems 
 
134 
The results in Figs. 13, 15, 17, and 19, confirm that the vibration motion is generated in the 
horizontal flight after turning flight by using the proposed method. This vibration frequency 
is about 0.067 Hz. This is because the resonation with the vibration occurs at the 
longitudinal short cycle mode and the lateral-directional dutchroll mode when the turning 
flight is changed to the horizontal flight in order to deal with the fault. However, this 
vibration fits into the stable area of both an attack angle and a sideslip angle that is 
established when designed and shown in section 4.6 as the termination conditions. 
Therefore, the vibration is considered to be an allowable range. 
From the results in Figs. 25 and 26, we confirmed that the proposed flight control system 
generates a bank angle command and achieves a turning flight by using an elevon when a 
rudder fault happens.  
These results confirm that the proposed system can detect, identify and accommodate both 
learned and non-learned faults. 
From the simulation results, we confirmed that the proposed flight control system can 
stabilize the airframe in fault situations shown in Table 3. 
Figure 20 shows the output of a detector which means the evaluation value of a flight 
condition. We confirmed that the detector can distinguish the fault from the gust of wind. 
The flight control system can distinguish between the fault and the gusts from various 
directions because a number of directional gusts are considered in the learning of neural 
network. Figures 23 and 24 show that the gust has a wider range of frequency where the 
coherence function takes the value of approximately 1 than the fault. If the disturbance is 
estimated, the motion of the system is the same as the model assumed when the control 
system is designed. On the other hand, the motion of the system with the fault is different 
from the assumed model. Therefore, the proposed model-based detector can accurately 
detect faults. 
Figure 21 shows the output of an identifier which means the evaluation value of the fault 
position. It was confirmed that the proposed identifier can identify the fault position 
because only the broken actuator indicates the abnormal value. 
Figure 22 shows the performance of a flight path generator. The horizontal axis indicates a 
fixed angle of a broken elevon and the vertical axis indicates a new target value of y 
direction that is calculated by the flight path generator. The results confirm that the higher 
the level of a fault, the gentler the turning based on a new target value generated by the 
flight path generator. In this research, the actuator error between the stable and the broken 
conditions means the fault level. Moreover, the error from a mission trajectory is considered 
in the evaluation function. Therefore, the proposed flight control system can generate a 
suitable target value of turning in accordance with the situation. 
The proposed flight control system focuses on the change in dynamics caused by a fault. It is 
designed by considering the elevon fault that enormously influences the airframe because 
an elevon plays the roles of both an aileron and an elevator. The simulation results confirm 
the proposed system can perform well in both learned and non-learned fault situations. 
6. Conclusion 
This research aimed at proposing an intelligent fault-tolerant flight control system for an 
unmanned aerial vehicle (UAV). In particular, the flight control system was developed that 
www.ebook3000.com

Design of Intelligent Fault-Tolerant Flight Control System for Unmanned Aerial Vehicles   
 
135 
has estimator, detector, identifier, distributor, and flight path generator. The proposed 
system distinguishes a fault from a disturbance like a gust of wind and automatically 
generates a new flight path suited to the fault level. To verify the effectiveness of the 
proposed method, a six-degree-of-freedom nonlinear simulation was carried out. In the 
simulation, we assumed that the fault in left elevon-1, which was learned in designing each 
neural network, or the fault in the rudder, which was not learned, would be generated in a 
horizontal flight. The simulation results confirm that the proposed flight control system can 
detect, identify and accommodate the fault and keep a flight stable. Moreover, the proposed 
system can distinguish a fault from a gust and keep a flight stable automatically. It is 
expected that the proposed design method can be used in broader flight areas by expanding 
the learning area. 
7. References 
Akihiko Shimura and Kazuo Yoshida, Non-Linear Neuro Control for Active Steering for 
Various Road Condition, The Japan Society of Mechanical and Engineers, Vol. 67, No. 
654(2001), pp. 407-413. 
Brian L. Steavens and Frank L. Lewis, Aircraft Control and Simulation 2nd Edition, JOHN 
WILEY & SONS, INC. (2003) 
Guillaume Ducard and Hans P. Geering, Efficient Nonlinear Actuator Fault Detection and 
Isolation System for Unmanned Aerial Vehicles, AIAA, Journal of Guidance, Control, 
and Dynamics, Vol. 31, No.1 (2008), pp. 225-237. 
Jovan D. Boskovic, Sarah E. Bergstrom ,and Raman K. Mehra, Robust Integrated  
Flight 
Control 
Design 
Under 
Failures, 
Damage, 
and 
State-Depenndent 
Disturbances, AIAA, Journal of Guidance, Control, and Dynamics, Vol. 28, No.5 (2005), 
pp. 902-916. 
Kanichiro Kato, Akio Oya, and Kenzi Karasawa, Introduction of Aircraft Dynamics, 
University of Tokyo Press, (1982). 
Kohichiroh Yoshida, kazumichi Mototsuna and Yasushi Kumakura, Elementary knowledge 
of marine technology, Seizandou,(1994) 
Masaki Takahashi, Teruma Narukawa and Kazuo Yoshida, Robustness and Fault-Tolerance 
of Cubic Neural Network Intelligent Control Method : Comparison with Sliding 
Mode Control, The Japan Society of Mechanical and Engineers, Vol. 69, No. 682(2003), 
pp. 1579-1586. 
Mohammad Azam, Krishana Pattipati, Jeffrey Allanach, Scott Poll, and Ann Patterson-Hine,  
In-flight Fault Detection and Isolation in Aircraft Flight Control Systems, Aerospace 
Conference, 2005 IEEE, (2005), pp. 3555- 3565. 
NAL/NASDA ALFLEX Group, Flight simulation model for Automatic Landing Flight 
Experiment (Part I : Free Flight and Ground Run Basic Model), Technical Report of 
National Aerospace Laboratory, Vol. 1252 (1994). 
Taro Tsukamoto, Masaaki Yanagihara, and Takanobu Suito, Feasibility Study of 
Lateral/Directional Control of Winged Re-entry Vehicle with Split Elevons, 
Technical Report of National Aerospace Laboratory, Vol. 1379 (1999). 

 
Advances in Flight Control Systems 
 
136 
Toshinari Shiotsuka, Kazusige Ohta, Kazuo Yoshida and Akio Nagamatsu, Identification 
and Control of Four-Wheel-Steering Car by Neural Network, The Japan Society of 
Mechanical and Engineers, Vol. 59, No. 559(1993), pp. 708-713. 
Tsuyoshi Hatake, Junichiro Kawaguchi, and Tatsushi Izumi, Control in Aerospace, 
CORONA PUBLISHING CO., LTD. (1999). 
www.ebook3000.com

François Bateman1, Hassan Noura2 and Mustapha Ouladsine3
1French Air Force Academy, Salon de Provence
2United Arab Emirates University, Al-Ain
3Paul Cezanne University, Marseille
1,3France
2United Arab Emirates
1. Introduction
Interest in Unmanned Aerial Vehicles (UAVs) is growing worldwide. Nevertheless there are
numerous issues that must be overcome as a precondition to their routine and safe integration
in military and civilian airspaces. Chief among these are absence of certiﬁcation standards and
regulations addressing UAV systems, poor reliability record of UAV systems and operations.
Standards and regulations for airworthiness certiﬁcation and ﬂight operations in the military
and civilian airspaces are being studied (Brigaud, 2006). In this respect, the USAR standard
suggests a mishap rate of one catastrophic mishap per one million hours (Brigaud, 2006). To
reach such performances, upcoming technologies have the promise of signiﬁcantly improving
the reliability of UAVs.
In this connection, a detailed study (OSD, 2003) shows that most of the breakdowns are due
to system failures such as propulsion, data link and Flight Control Systems (FCS). These
latter include all systems contributing to the aircraft stability and control such as avionics,
air data system, servo-actuators, control surfaces/servos, on-board software, navigation, and
other related subsystems. As regards FCS, it is recommended in (OSD, 2003) to incorporate
emerging technologies such as Self-Repairing Flight Control Systems (SRFCS) which have the
capability to diagnose and to repair malfunctions.
In this respect, Fault-tolerant control (FTC) are control systems that have the ability to
accommodate failures automatically in order to maintain system stability and a sufﬁcient
level of performance. FTC are classiﬁed into passive and active methods. The analytical
fault-tolerant control operation can be achieved passively by the use of a control law designed
to guarantee an acceptable degree of performance in fault-free case and to be insensitive to
some faults. However, the passive methods are unsuitable to deal with a signiﬁcant number
of faults. In particular, for an aircraft, it may be tricky to design an a priori controller able
to accommodate the whole of the faults affecting the control surfaces. By contrast, an active
FTC consists of adjusting the controllers on-line according to the fault magnitude and type, in
order to maintain the closed-loop performance of the system. To do so, a fault detection and
isolation (FDI) module which provides information about the fault is required (Noura et al.,
2009). Active FTC mechanisms may be implemented either via pre-computed control laws or
via on-line automatic redesign.
 
Active Fault Diagnosis and Major Actuator 
Failure Accommodation: Application to a UAV 
7

In this respect, FDI and FTC applied to aeronautical systems have received considerable
attention in the literature. However, regarding the control surface failures, some problematics
tackled in this chapter are underlined:
•
severe failures are considered and the control surfaces may abruptly lock in any position
in their deﬂection range,
•
each control surface being driven indenpendently,
an actuator failure produces
aerodynamical couplings between the longitudinal and the lateral axis,
•
the UAV is equipped with an autopilot which masks the failure effects,
•
the aircraft studied is a small UAV and the control surface positions are not measured,
which makes the fault detection difﬁcult,
•
the control surfaces have redundant effects, which complicates the fault isolation,
•
the FTC must take into account the bounds existing on the control surface deﬂections and
the ﬂight envelope.
In this chapter, a nonlinear UAV model which allows to simulate assymetrical control surface
failures is presented (Bateman et al., 2009). In fault-free mode, a nominal control law based
on an Eigenstructure Assignment (EA) strategy is designed. As the control surface positions
are not measured, a diagnosis system is performed with a bank of observers able to estimate
the unkown inputs. However, as the two ailerons offert redundant effects, isolating a fault on
these actuators requires an active diagnosis method (Bateman et al., 2008a). In the last part,
a precomputed FTC strategy dedicated to accommodate for a ruddervator failure is depicted
(Bateman et al., 2008b).
All the models can be simulated with MATLAB-SIMULINK. Files and tutorial can be
downloaded at http://www.lsis.org/bateman/UAV.zip.
2. Aircraft model
The aircraft studied in this paper and shown in Fig.1 is an inverted V-tail UAV. It is assumed
that its controls are fully indenpendent: δx is the throttle, δar, δal, δfr, δf l, δer, δel control the
right and left ailerons, the right and left ﬂaps, the right and left inverted V tail control surfaces
respectively. These latter controls are named ruddervators because they combine the tasks
of the elevators and rudder. In the fault-free mode, the ailerons and the ruddervators are
known as the primary control surfaces, they produce the roll, the pitch and the yaw. As far as
the ﬂaps are concerned, in the fault-free mode, they are only used to produce a lift increment
during takeoff and a drag increment during landing. They are known as the secondary control
surfaces.
It is assumed that each one of the primary control surfaces may lock at any arbitrary position
on its deﬂection range.
To compensate for the fault, the FTC exploits the redundancies
provided by the remaining control surfaces. In this pespective, the UAV model has to consider
the aerodynamic effects produced by each control surface.
The following dynamic model of the aircraft is presented in the case of a rigid-body aircraft,
the weight m is constant and the centre of gravity c.g. is ﬁxed position. Let RE = (O, xE, yE, zE)
be a right-hand inertial frame such that zE is the vertical direction downwards the earth, ξ =
(x, y, z) denotes the position of c.g. in RE. Let Rb = (c.g., xb, yb, zb) be a right-hand body ﬁxed
frame for the UAV, at t = 0 RE and Rb coincide. The linear velocities μ = (u, v, w) and the
angular velocities Ω = (p, q, r) are expressed in the body frame Rb where p, q, r are roll, pitch
and yaw respectively. The orientation of the rigid body in RE is located with the bank angle
138
Advances in Flight Control Systems
www.ebook3000.com

Fig. 1. The RQ7A Shadow 200 UAV
φ, the pitch angle θ and the heading angle ψ. The transformation from Rb to RE is given by a
transformation matrix TbE:
TbE =
⎛
⎝
cos θ cos ψ sin φ sin θ cos ψ −cos φ sin ψ cos φ sin θ cos ψ + sin φ sin ψ
cos θ sin ψ sin φ sin θ sin ψ + cos φ cos ψ cos φ sin θ sin ψ −sin φ cos ψ
−sin θ
sin φ cos θ
cos φ cos θ
⎞
⎠
(1)
Forces FRb
x , FRb
y , FRb
z
acting on the aircraft are expressed in Rb, they originate in gravity Fgrav,
propulsion Fprop, and aerodynamic effects Faero. According to Newton’s second law:
⎛
⎝
˙u
˙v
˙w
⎞
⎠= 1
m
⎛
⎜
⎝
FRb
x
FRb
y
FRb
z
⎞
⎟
⎠−
⎛
⎝
p
q
r
⎞
⎠∧
⎛
⎝
u
v
w
⎞
⎠
(2)
where ∧denotes the cross product. Let Rw = (c.g., xw, yw, zw) be the wind reference frame
where xw is aligned with the true airspeed V. The orientation of the body reference frame
in the wind reference frame is located with the angle of attack α and the sideslip β. The
transformation from Rb to Rw is given by a transformation matrix Tbw:
Tbw =
⎛
⎝
cos α cos β sin β
sin α cos β
−cos α sin β cos β −sin α sin β
−sin α
0
cos α
⎞
⎠
(3)
Furthermore, the aerodynamic state variables (V, α, β) and their time derivatives can be
formulated using Tbw from μ (Rauw, 1993).
V =

u2 + v2 + w2
α = arctan
	 w
u

(4)
β = arctan

v
√
u2 + w2

For the sake of clarity, the forces are written in the reference frame where their expressions are
the simplest. They are transformed into the desired frame by means of the matrices TbE and
139
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

Tbw or their inverse.
FgravRE =

0 0 g
T
FpropRb =

kρ(z)
V
δx 0 0
T
(5)
FaeroRw = ¯qS
−CD Cy −CL
T
The model of the engine propeller is given in (Boifﬁer, 1998), ρ is the air density, k is a constant
characteristic of the propeller engine, ¯q = 1
2ρV2 and S denote the aerodynamic pressure and
a reference surface. The aerodynamic force coefﬁcients are expressed as linear combination
of the state elements and control inputs. The values of these aerodynamic coefﬁcients can be
found in the attached MATLAB ﬁles.
CD = CD0 +
S
πb2 C2
L + CDδar|δar| + CDδal|δal| + CDδf r|δfr| + CDδf l|δf l| + CDδer|δer| + CDδel|δel|
Cy = Cyββ + Cyδarδar + Cyδalδal + Cyδf rδfr + Cyδf lδf l + Cyδerδer + Cyδelδel
(6)
CL = CL0 + CLαα + CLδarδar + CLδalδal + CLδf rδfr + CLδf lδf l + CLδerδer + CLδelδel
The relationships between the angular velocities, their derivatives and the moments MRb
x ,
MRb
y , MRb
z
applied to the aircraft originate from the general moment equation. J is the inertia
matrix.
⎛
⎝
˙p
˙q
˙r
⎞
⎠= J−1
⎡
⎢⎣
⎛
⎜
⎝
MRb
x
MRb
y
MRb
z
⎞
⎟
⎠−
⎛
⎝
p
q
r
⎞
⎠∧J
⎛
⎝
p
q
r
⎞
⎠
⎤
⎥⎦
(7)
The moments are expressed in Rb, they are due to aerodynamic effects and are modeled as
follows:
	
MRb
x
MRb
y
MRb
z

= ¯qS

bCl ¯cCm bCn

(8)
where ¯c and b are the mean aerodynamic chord and the wing span. The aerodynamic moment
coefﬁcients are expressed as a linear combination of state elements and control inputs as
Cl = Clββ + Clp
bp
2V + Clr
br
2V + Clδarδar + Clδalδal + Clδerδer + Clδelδel + Clδf rδfr + Clδf lδf l
(9)
Cm = Cm0 + Cmαα + Cmq
¯cq
2V + Cmδarδar + Cmδalδal + Cmδerδer + Cmδelδel + Cmδf rδfr + Cmδf lδf l
Cn = Cnββ + Cnp
bp
2V + Cnr
br
2V + Cnδarδar + Cnδalδal + Cnδerδer + Cnδelδel + Cnδf rδfr + Cnδf lδf l
Equations (6) and (9) make obvious the aerodynamic forces and moments produced by each
control surface. This is useful to model the fault effects and the redundancies provided by the
healthy control surfaces.
The FDI/FTC problem is ﬁrst an attitude control problem, thus the heading angle ψ, the x and
y coordinates are not studied in the sequel.
With regard to the kinematic relations, the bank angle and the pitch angle time derivatives are
(Boifﬁer, 1998):
˙φ = p + q sin φ tan θ + r cos φ tan θ
˙θ = q cos φ −r sin φ
(10)
140
Advances in Flight Control Systems
www.ebook3000.com

The relationship between the time derivative of the position of the aircraft’s centre of gravity
ξ, the transformation matrix TbE and the linear velocities μ allows to write:
˙z = −u sin θ + v sin φ cos θ + w cos φ cos θ
(11)
Let X
=
(φ θ V α β p q r z)T the state vector and U
=
(δx δar δal δfr δf l
δer δel)T the control vector. All the state vector is measured and Y is the measure vector.
From above, the model of the UAV can be written as a nonlinear model afﬁne in the control
˙X = f (X) + g(X)U
(12)
Y = CX
Practically, the nonlinear aircraft model has been implemented with MATLAB in a sfunction.
In the fault-free mode, for a given operating point {Xe0, Ue0}, where Ue0 denotes the trim
positions of the controls, the linearized model of the aircraft can be written as
˙x = Ax + Bu
(13)
y = Cx
(14)
2.1 Fault model
In the fault-free mode, the control surface deﬂections are constrained: asymmetrical aileron
deﬂections produce the roll control, pitch is achieved through deﬂecting both ruddervators
in the same direction and yaw is achieved through deﬂecting both ruddervators in opposite
direction. As for the ﬂaps, their deﬂection is symmetrical.
The faults considered are stuck control surfaces.
For t ≥t f, the faulty control vector
Uf(t) = U f, where t f is the fault-time and U f are the stuck control surface positions. For
the simulations, a fault is modeled as a rate limiter response to a step. The slew rate is chosen
equal to the maximum speed of the actuators. Let Uh be the remaining surfaces, then the state
equation (12) in faulty mode becomes:
˙X = f (X) + g f (X)Uf + gh(X)Uh
(15)
3. The nominal controller
A linear state feedback controller with reference tracking is designed.
It is based on an
EA method which allows to set the aircraft handling qualities (Magni et al., 1997).
This
method allows to set the modes of the closed-loop (CL) aircraft with respect to the standards
(MIL-HDBK-1797, 1997) and to decouple some state and control variables from some modes.
The design is based on the fault-free linearized model (13) which modal analysis shows that
the spiral mode is open-loop (OL) unstable.
Let ˜Y =

φ β V z

the tracked vector and ˜Yref the reference vector. The autopilot is depicted
in ﬁgure 2 and the nominal control law is:
u = Lζ + Kx
(16)
where ˙ζ = ˜Yref −˜Y augments the state vector with the state variables which have to be tracked
to zero and
˙ζ =
εφ εβ εV εz
T
(17)
141
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

-
-
-
-
6
6
-
+
−

+
−

K
L
m
?
?
+ −Xe0
Ue0
X
UAV
- ˜C
˜Yre f
˜Y
x
Fig. 2. The UAV control law
For a straight and level ﬂight stage, Table 1 illustrates the EA strategy. A 0 means that the
mode and the state variable or the control are decoupled. On the contrary, an × means that
they are coupled.
In the fault-free mode, the ruddervators produce the pitch and the yaw, thus the longitudinal
and the lateral axis are coupled.
To take this into account, the autopilot is designed by
considering the complete linearized model of the aircraft (13). For example, a coupling has
been set between the spiral mode and the angle of attack which are a lateral mode and a
longitudinal state variable respectively. This is illustrated by the highlighted cells in Table 1.
This approach signiﬁcantly differs from the classical method which consists in designing two
autopilots, one for the longitudinal axis, another one for the lateral axis. However, from the
FTC point of view, a control surface failure upsets the equilibrium of forces and moments
and produce signiﬁcant couplings between longitudinal and lateral axis. Because of this, the
method adopted to design the nominal autopilot could be used to design the fault-tolerant
controllers. From (13), (16) and (17)
˙x
˙ζ

=
A + BK BL
−˜C
0
 x
ζ

+
0
I
  ˜Yre f

(18)
with ˜C ∈R4×9 and ˜C(i, j) = 1 for {i, j} = {1, 1}, {2, 5}, {3, 3}, {4, 9} else ˜C(i, j) = 0.
Matrices K ∈R7×9 and L ∈R7×4 are computed in order to set the state space matrix’s
eigenvalues and eigenvectors in (18). These latter deﬁne the aircraft’s modes. The state space
matrix in (18) also writes:
 A 0
−˜C 0

+
B
0
 
K L
 = F + G

K L

(19)
Let λi the ith eigenvalue (or closed-loop pole) corresponding to the eigenvector −→
v i ∈R13,
next

F + G

K L
 −→
v i = λi−→
v i
(20)
let
−→
w i =

K L
 −→
v i ∈R7
(21)
then

F −λiI G
 −→
v i
−→
w i

= −→
0
(22)
142
Advances in Flight Control Systems
www.ebook3000.com

mode
short period
phugoid
throttle
roll
dutchroll
spiral,εφ
εβ
εV,εz
OL poles
−4.2 ± 9.6i −0.03 ± 0.5i −0.0002 −21 −1.7 ± 5.6i
0.073
CL poles
−10 ± 10i
−2 ± 2i
−1
−100
−5 ± 5i
−1 ± .25i −1.5 −1 ± .5i
eigenvector
−→
v 1,2
−→v 3,4
−→
v 5
−→
v 6
−→
v 7,8
−→
v 9,10
−→
v 11
−→
v 12,13
φ
0
0
0
×
×
×
×
×
θ
×
×
×
0
0
×
0
×
V
×
×
×
0
0
0
0
×
α
×
×
×
0
0
×
0
×
β
0
0
0
×
×
×
×
×
p
0
0
0
×
×
×
×
0
q
×
×
×
0
0
×
0
×
r
0
0
0
×
×
×
×
0
z
×
×
×
×
×
0
×
×
εΦ
×
×
×
×
×
×
×
×
εβ
×
×
×
×
×
0
×
×
εV
×
×
×
×
×
×
×
×
εz
×
×
×
×
×
×
×
×
δx
×
×
×
×
×
×
×
×
δar
0
0
0
×
×
×
×
0
δal
0
0
0
×
×
×
×
0
δf r
0
0
0
0
0
0
0
0
δf l
0
0
0
0
0
0
0
0
δer
×
×
×
×
×
0
×
×
δel
×
×
×
×
×
0
×
×
Table 1. Eigenstructure assignment strategy, airspeed 25ms−1, height 200m

F −λiI G

is a 13 × 20 matrix and the size of its null space is equal to the number of control
inputs, here seven. In order to set the eigenvector structure (Table 1) while reducing the
solution space, some constraints are added. To hide the ith mode to the jth state variable
or control input, a mask is introduced such that
maski =
1
0 · · · 0
j
1 0 · · ·
20
0

(23)
In order to ﬁnd a unique solution vector, for each eigenvalue λi, six masks are deﬁned and the
system to solve writes
⎛
⎜
⎜
⎝
F −λiI G
maski1
. . .
maski6
⎞
⎟
⎟
⎠
−→
v i
−→
w i

= −→
0
(24)
Let P =
−→
v 1 . . . −→
v 13
and Q =
−→
w 1 . . . −→
w 7
, then according to (21), matrices K and L write:

K L
 = QP−1
(25)
Fig. 4 shows the nominal autopilot functionning in the [0s, 16s] fault-free time interval.
4. Fault diagnosis
The class of faults addressed here are stuck control surfaces. However, the proposed diagnosis
system can also deal with actuator the loss of efﬁciency.
143
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

To process for the faults, the diagnosis system could be realized by measuring the actuator
positions.
This approach which requires potentiometers, wiring and acquisition board is
complex to implement and induces an increase of weight. Without these measurements, the
control inputs appear as unknown inputs which have to be estimated. This can be achieved
by the use of observers able to estimate the unknown inputs of a system.
In this connection, the problem of unknown, constant or slowy varying input estimation using
banks of Kalman ﬁlters is discussed in (Kobayashi & Simon, 2003), (Ducard & Geering, 2008).
The unknown inputs are declared as state variables, under the condition that the system is
observable, the problem consists in estimating an augmented state vector.
However, to catch for the actuator fault transients, the observer has to estimate time varying
inputs. Such an estimation is possible if these inputs are observable. The input observability
problem was addressed by Patton in (Hou & Patton, 1998) who gave some necessary and
sufﬁcient conditions to prove input observability for linear time invariant systems with
unknown initial conditions.
As far as the observer is concerned, Xiong (Xiong & Saif, 2003) proposed an Unknown Input
Decoupled Functionnal Observer (UIDFO) which has no boundedness conditions as for time
varying inputs and does not require differentiation of the measured outputs.
The fact remains that control surfaces offer redundancies that make aileron failures not
isolable. In these conditions, an active diagnosis strategy has to be considered.
Input observability of the UAV is studied in subsection 4.1, the UIDFO is brieﬂy described in
subsection 4.2 and a diagnosis system based on a bank of UIDFO is detailed in subsection 4.3.
The active diagnosis strategy is presented in subsection 4.4.
4.1 Input observability
Given, the linearized model (13).
Deﬁnition 1. The input u(t) is said to be observable if y(t) = 0 for t ≥0 implies u(t) = 0 for t > 0
(Hou & Patton, 1998).
Let λ ∈C, Σsys and ΣAC refer to the system matrix and the observability pencil respectively,
they write:
Σsys =
A B
C D

−λ
I 0
0 0

and ΣAC =
A
C

−λ
I
0

(26)
Kroenecker’s theory of singular pencils shows that any pencil λM −N with dimension m × n
can be brought into the canonical quasidiagonal form:
P(λM −N)Q =
⎛
⎜
⎜
⎝
λMc −Nc
×
×
×
λI −Nf
×
×
λM∞−I
×
λMr −Nr
⎞
⎟
⎟
⎠
(27)
•
P and Q are nonsingular constant matrices with dimensions m × m and n × n.
•
the ﬁnite eigenvalues are in the square and regular pencil λI −Jf and Jf is in Jordan
canonical form. It is built with Jordan blocks Jfi with dimension i × i.
•
the inﬁnite eigenvalues are in the square and regular pencil λJ∞−I and J∞is compound
with Jordan blocks J∞i of size i × i.
•
λMr −Nr is a singular pencil and has a block diagonal structure, each block takes the form
λMri −Nri = λ
 I
0T

−

0T
I

with dimension ri+1 × ri. 0 stands for zero vector and 0T
denotes its transpose. The ri are called Kroenecker’s row indices.
144
Advances in Flight Control Systems
www.ebook3000.com

•
λMc −Nc is a singular pencil and has a block diagonal structure, each block takes the form
: λMcj −Ncj = λ

I 0
 −

0 I

. The cj × cj+1 are called Kroenecker’s column indices.
This decomposition is applied to Σsys and ΣAC. The following theorem contains a numerically
effective test for input observability:
Theorem 1. System (13) is input observable if and only if the block λMcsys −Ncsys vanishes in
equation (27) and dim(Jfsys)=dim(JfAC) (Hou et Patton)(Hou & Patton, 1998).
Nevertheless, due to the numerical unreliability of the computation, this form is not suitable
and the staircase form, computed with the GUPTRI algorithm, is used to exhibit the
Kroenecker form (Demmel & Kågstrom, 1993).
All the state vector is measured and theorem 1 is applied to assess the ruddervator
observability. For this outpout vector, the matrix system and the observability pencil have
the following structures:
•
ΣAC has no ﬁnite eigenvalue, nine singular pencils with Kronecker raw indice equal to
one,
•
Σsys has no ﬁnite eigenvalue, seven singular pencils with Kronecker raw indice equal to
one and two 2 × 2 jordan blocks containing inﬁnite eigenvalues.
According to theorem 1 the ruddervator positions are observable. With the same measured
outputs, theorem 1 is applied to assess the aileron observability. The matrix system and the
observability pencil have the following structure:
•
ΣAC is unchanged
•
Σsys has no ﬁnite eigenvalue, one singular pencil with Kronecker column indice equal to
one, eight singular pencils with Kronecker raw indice equal to one and one 2 × 2 jordan
block containing inﬁnite eigenvalues.
Due to the presence of the singular pencil with Kronecker column equal to one, the aileron
positions are not both observable. Thus, if one of the ailerons breaks down, the faulty control
is not isolable. This is depicted in Fig. 3 where a down lock position of the left aileron has the
same effects as a top lock position of the right aileron. In this case, an active diagnosis must
be used to discriminate the faulty control surface.
-
?
m
−→
y
−→z


p > 0
p > 0
δer
δel
δar
δal
δer
δel
δar
δal
Fig. 3. Aerodynamic effects induced by right and left aileron failures
145
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

4.2 The unknown input decoupled functional observer
In this part, results established in (Xiong & Saif, 2003) are recalled. The following dynamic
system driven by both known and unknown inputs is considered
˙x = Ax + Bu + Gd
(28)
y = Cx
where x ∈Rn is the state vector, u ∈Rm is the known input vector, d ∈Rℓis the unknown
input vector and y ∈Ro is the output vector. A, B, G and C are matrices with appropriate
dimensions, C and G are assumed to be full rank.
The UIDFO detailed in (Xiong & Saif, 2003) provides an estimation ˆd of the unknown input
d and an estimation z of linear combination of state Tx.
Theoretically, no boundedness
conditions are required for the unknown inputs and their derivatives.
˙z = Fz + Hy + TBu + TG ˆd
(29)
ˆd = γ(Wy −Ez) with γ ∈R∗+
Matrices F, H, T, W and E are all design parameters.
in order to satisfy the following
conditions
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
FT −TA + HC = 0
F is stable,
E = (TG)TP
with P solution of: PF + FTP = −Q
and Q, a semi-positive deﬁnite matrix,
ET = GTTTPT = WC
rank(TG) = rank(G) = ℓ
(30)
These matrices exist if and only if
(i) rank(CG) = rank(G),
(ii) all unstable transmission zeros of system (A, G, C) are unobservable modes of (A, C).
To prove their existence and to calculate them, system (28) is transformed into "Special
Coordinate Basis" (SCB) (X.Liu et al., 2005).
4.3 Diagnosis system performed with a bank of UIDFO
The right aileron, the left aileron, the right ruddervator and the left ruddervator positions
are unknown. In order to estimate each one of these unknown input positions, a bank of
four UIDFOs is implemented. However, it has been proven above that the ailerons are not
both input observable. It means that, if one of these two controls is faulty, one of the two
estimations is wrong whereas the other is right, but in any case it is impossible to know which
one is which.
Let ˆδar, ˆδal, ˆδer and ˆδel the positions estimated by each UIDFO, δar, δal, δer and δel the known
control inputs computed by the nominal controller and ¯δar, ¯δal, ¯δer and ¯δel the unknown
actual control surface positions. In the fault-free mode, the actual control surface positions are
equal to those computed by the controller and to their estimations. When an actuator breaks
down, the faulty actual control surface position is equal to its estimation but differs from that
computed by the controller. Residuals are obtained by processing the differences between the
positions computed by the controller with the estimated positions. The fault detection and
isolation process consists in monitoring residuals by comparing them with thresholds.
146
Advances in Flight Control Systems
www.ebook3000.com

The ﬁrst UIDFO estimates the unknown right aileron actual position ¯δar by processing the
measurement vector y and the known input u1 = (δal, δer, δel)T. Let bδi the column of the
control matrix B associated with the δi control input, then B1 = (bδal, bδer, bδel)T and G1 =
(bδar),
˙z1 = F1z1 + H1y + T1B1(δal, δer, δel)T + T1G1 ˆδar
(31)
ˆδar = γ1(W1y −E1z1)
The other three ones UIDFO equations write
˙z2 = F2z2 + H2y + T2B2(δar, δer, δel)T + T2G2 ˆδal
(32)
ˆδal = γ2(W2y −E2z2)
with B2 = (bδar, bδer, bδel)T and G2 = (bδal),
˙z3 = F3z3 + H3y + T3B3(δar, δal, δel)T + T3G3 ˆδer
(33)
ˆδer = γ3(W3y −E3z3)
with B3 = (bδar, bδal, bδel)T and G3 = (bδer),
˙z4 = F4z4 + H4y + T4B4(δar, δal, δer)T + T4G4 ˆδel
(34)
ˆδel = γ4(W4y −E4z4)
with B4 = (bδar, bδal, bδer)T and G4 = (bδel).
For all the UIDFOs, condition (i) is assessed and condition (ii) is checked by computing the
staircase forms of the system matrices (A, Gj, C, 0) with j = {1, . . . , 4} and the observability
pencil (A, C) with the GUPTRI algorithm.
Error signals are generated by comparison between the control positions δi and the estimated
positions ˆδi where δi ∈{δar, δal, δer, δel}. In order to avoid false alarm that may arise from the
transient behavior, these signals are integrated on a duration τ to produce residuals rδi such
that
rδi =

 t+τ
t
ˆδi(θ) −δi(θ)dθ

(35)
Let σδi the corresponding threshold and μδi a logical state such that μδi = 1 if rδi > σδi else
μδi = 0. Then, to detect and to partially isolate the faulty control surface, an incidence matrix
is deﬁned as follows:
Faulty control
μδar μδel μδal μδer
right aileron
1
0
1
0
left aileron
1
0
1
0
right ruddervator
0
0
0
1
left ruddervator
0
1
0
0
Table 2. The incidence matrix
This matrix reveals that fault on right aileron and fault on left aileron are not isolable.
In order to illustrate the above-mentioned concepts, three failure scenarios are studied: a
non critical ruddervator loss of efﬁciency 50%, a catastrophic ruddervator locking and a non
critical aileron locking. For the three cases, the fault occurs at faulty time t f = 16s whereas
the UAV is turning and changing its airspeed (see Fig.4, Fig.7, Fig.10). These two manoeuvres
involve both ailerons and ruddervators.
147
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

4.3.1 Ruddervator loss of efﬁciency
For the right ruddervator, a 50% loss of efﬁciency is simulated. The nominal controller is
robust enough to accommodate for the fault as it is depicted in Fig.4. The actual control
surface positions and their estimations are shown in Fig. 5. As far as the right ruddervator is
concerned, after time t f , its control signal differs from its estimated position and this difference
renders the fault obvious. The residuals are depicted in Fig. 6, with respect to (35) and to the
incidence matrix Tab. 2, the right ruddervator is declared to be faulty.
4.3.2 Ruddervator locking
At time t f, the right ruddervator is stuck at position 0◦. As it is illustrated in Fig.7, the nominal
controller cannot accommodate for the fault and the UAV is lost. The actual control surface
positions and their estimations are shown in Fig.8, As regards the right ruddervator, its control
signal differs from its estimated position and the residual analysis Fig.9 allows to declare this
control surface to be faulty. However, the control and measurement vectors diverge quickly,
thus the signal acquisition of the estimated positions has to be sampled fast.
4.3.3 Aileron locking
In the event of an aileron failure, the nominal controller is robust enough to accommodate for
the fault. However, the incidence matrix shows that faults on right and left ailerons cannot be
isolated. This is due to the redundancies offered by these control surfaces that are not input
observable. This aspect is depicted in Fig. 10, 11, 12 where the left aileron locks at position
+5◦at time t f = 16s. Fig.10 shows that this fault is non critical (it is naturally accommodated
by the right aileron). However, as it is shown in Fig. 11, both estimations of aileron positions
are consistent and the corresponding residuals exceed the thresholds. As a consequence, it is
not possible to isolate the faulty aileron.
4.4 Active diagnosis
To overcome this problem, an active fault diagnosis strategy is proposed. It consists in exciting
one of the aileron (here the right aileron) with a small-amplitude sinusoidal signal. If the
left aileron is stuck, the measures contain a sinusoidal component which is detected with a
selective ﬁlter. If the right aileron is stuck, the sinusoidal excitation cannot affect the state
vector and the measures do not contain the sinusoidal components. This point is depicted in
Fig. 13, a fault is simulated on the left aileron next to the right aileron. In the ﬁrst case, the
left aileron is stuck at −5◦, after the fault has been detected, the right aileron is excited with
a 1◦sin(20t) signal. This component distinctly appears in the estimation of the left aileron
position and allows to declare the left aileron faulty. In the second case, the right aileron
is stuck at +5◦, after the fault has been detected, the right aileron is excited with the same
sinusoidal signal. As this control surface is stuck, the sinusoidal signal does not appear in
the estimation of the right aileron position and this control surface is declared faulty. Note
that this method allows only to detect stuck ailerons. To deal with a loss of efﬁciency, three
control surfaces are excited: the right aileron, the right and the left ﬂaps. The excitation signals
are such that they little affect the state and the measurement vectors. This is achieved by
choosing the amplitudes of these excitations in the nullspace of the (bδar, bδf r, bδf l) matrix or if
the nullspace does not exist, the excitation vector can be chosen as the right singular vector
corresponding with the smallest singular value of the (bδar, bδf r, bδf l) matrix. If the right aileron
is faulty, the excitation is not fulﬁlled and the measures contain a sinusoidal component. On
the contrary, if the left aileron is faulty, the right aileron and the ﬂaps fulﬁll the exctitation
148
Advances in Flight Control Systems
www.ebook3000.com

0
5
10
15
20
25
30
−20
0
20
40
Bank angle (°)
0
5
10
15
20
25
30
24.5
25
25.5
26
26.5
Airspeed (m/s)
0
5
10
15
20
25
30
199.9
199.95
200
200.05
200.1
height (m)
time (s)
Fig. 4. Right ruddervator loss of efﬁciency: the tracked state variables
0
10
20
30
−2
−1
0
1
2
3
Right aileron positions (°)
0
10
20
30
−3
−2
−1
0
1
2
Left aileron positions (°)
0
10
20
30
−10
−5
0
5 Right ruddervator positions (°)
time (s)
 
 
actual
control
estimation
0
10
20
30
−10
−8
−6
−4
−2
0
Left ruddervator positions (°)
time (s)
 
 
actual
control
estimation
Fig. 5. Right ruddervator failure: the estimation process
5
10
15
20
25
30
0
0.05
0.1
0.15
0.2
0.25
0.3
Right aileron residual
5
10
15
20
25
30
0
0.05
0.1
0.15
0.2
0.25
0.3
Left aileron residual
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
Right ruddervator residual
time (s)
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
Left ruddervator residual
time (s)
Fig. 6. Right ruddervator failure: the fault detection and isolation process
149
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

0
2
4
6
8
10
12
14
16
18
−150
−100
−50
0
50
Bank angle (°)
0
2
4
6
8
10
12
14
16
18
24.5
25
25.5
26
26.5
Airspeed (m/s)
0
2
4
6
8
10
12
14
16
18
197
198
199
200
201
height (m)
time (s)
Fig. 7. Right ruddervator stuck: the tracked state variables
10
12
14
16
−1
0
1
2
3
4
Right aileron positions (°)
10
12
14
16
−4
−3
−2
−1
0
1
Left aileron positions (°)
10
12
14
16
−10
−5
0
5 Right ruddervator positions (°)
time (s)
 
 
actual
control
estimation
10
12
14
16
−15
−10
−5
0
Left ruddervator positions (°)
time (s)
 
 
actual
control
estimation
Fig. 8. Right ruddervator failure: the estimation process
10
12
14
16
0
0.05
0.1
0.15
0.2
0.25
0.3
Right aileron residual
10
12
14
16
0
0.1
0.2
0.3
0.4
0.5
Left aileron residual
10
12
14
16
0
0.5
1
1.5
Right ruddervator residual
time (s)
10
12
14
16
0
0.5
1
1.5
Left ruddervator residual
time (s)
Fig. 9. Right ruddervator failure: the fault detection and isolation process
150
Advances in Flight Control Systems
www.ebook3000.com

0
2
4
6
8
10
12
14
16
18
20
−20
0
20
40
Bank angle (°)
0
2
4
6
8
10
12
14
16
18
20
24.5
25
25.5
26
26.5
Airspeed (m/s)
0
2
4
6
8
10
12
14
16
18
20
199.9
199.95
200
200.05
200.1
height (m)
time (s)
Fig. 10. Left aileron stuck: the tracked state variables
0
5
10
15
20
−10
−5
0
5
10
15
Right aileron positions (°)
0
5
10
15
20
−15
−10
−5
0
5
10
Left aileron positions (°)
0
5
10
15
20
−10
−5
0
5 Right ruddervator positions (°)
time (s)
 
 
actual
control
estimation
0
5
10
15
20
−10
−8
−6
−4
−2
0
Left ruddervator positions (°)
time (s)
 
 
actual
control
estimation
Fig. 11. Left aileron failure: the estimation process
14
14.5
15
15.5
16
16.5
0
0.5
1
1.5
2
Right aileron residual
14
14.5
15
15.5
16
16.5
0
0.5
1
1.5
2
Left aileron residual
14
14.5
15
15.5
16
16.5
0
0.05
0.1
0.15
0.2
0.25
Right ruddervator residual
time (s)
14
14.5
15
15.5
16
16.5
0
0.05
0.1
0.15
0.2
0.25
Left ruddervator residual
time (s)
Fig. 12. Left aileron failure: the fault detection and isolation process
151
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

14
15
16
17
18
0
0.005
0.01
0.015
0.02
time (s)
Left aileron failure,  residual
14
15
16
17
18
−6
−4
−2
0
2
4
6
Left aileron positions (°)
 
 
14
15
16
17
18
−4
−2
0
2
4
6
Right aileron positions (°)
 
 
14
15
16
17
18
0
0.002
0.004
0.006
0.008
0.01
0.012
0.014 Right aileron failure,  residual
time (s)
actual
control
estimation
actual
control
estimation
Fig. 13. Left or right aileron stuck: the active diagnosis method
signals, as these latter have no effect on the state vector, the measures do not contain sinusoidal
components.
5. Fault-tolerant control
The faults considered are asymmetric stuck control surfaces. When one or several control
surfaces are stuck, the balance of forces and moments is broken, the UAV moves away from
the fault-free mode operating point and there is a risk of losing the aircraft. This risk is all the
more so critical that it affects the ruddervators, these latter producing the pitch and the yaw
moments.
So a fault may be accommodated only if an operating point exists and the design of the FTC
follows this scheme.
1. It is assumed that the faulty control surface and the fault magnitude are known. This
information is provided by the fault diagnosis system described above.
2. The deﬂection constraints of the remaining control surfaces are released e.g symmetrical
deﬂections for ﬂaps, asymmetrical deﬂections for ailerons.
3. For the considered faulty actuator and its fault position, a new operating point is
computed.
4. For this new operating point a linear state feedback controller is designed with an EA
strategy. This controller aims to maintain the aircraft handling qualities at their fault-free
values.
5. The accommodation is achieved by implementing simultaneously the new operating point
and the fault-tolerant controller.
5.1 Operating point computation
The operating point exists if the healthy controls offer sufﬁcient redundancies and its value
depends on:
•
the considered ﬂight stage,
152
Advances in Flight Control Systems
www.ebook3000.com

•
the faulty control surface,
•
the fault magnitude.
In the following {Xe, Ue} denote the operating point in faulty mode, Uhe the trim positions
of the remaining controls and Uf the faulty controls. According to (15) and when k control
surfaces are stuck, computing an operating point is equivalent to solve the algebraic equation:
0 = f (Xe) + gh(Xe)Uh
e + g f (Xe)Uf
(36)
To take into account the ﬂight stage envelope and the remaining control surface deﬂections,
the operating point computation is achieved with an optimization algorithm. This latter aims
at minimizing the cost function:
J = qV(V −Ve0)2 + qα(α −αe0)2 + qβ(β −βe0)2
(37)
under the following equality and inequality constraints:
•
a control surface is stuck
Uf = U f
(38)
•
the ﬂight envelope and the healthy control deﬂections are bounded:
 Xmin ≤X ≤
Xmax
Uh
min ≤Uh ≤Uhmax
(39)
•
according to the desired ﬂight stage, some equality constraints are added
–
ﬂight level
 ˙φ = ˙θ = ˙V = ˙α = ˙β = ˙p = ˙r = ˙q = ˙z = 0
φ = p = q = r = 0
(40)
–
climb or descent with a ﬂight path equal to γ
 ˙φ = ˙θ = ˙V = ˙α = ˙β = ˙p
= ˙r = ˙q = 0
φ = p = q = r = 0 ,
θ −α = γ
(41)
–
turn
 ˙φ = ˙θ = ˙V = ˙α = ˙β = ˙p = ˙r = ˙q = ˙z = 0
p = q = 0 ,
φ = φe ,
r = re
(42)
This strategy aims at keeping the operating point in faulty mode the closest to its fault-free
value. As the linearized model i.e. the state space and the control matrices strongly depends
of the operating point, the open-loop poles (and consequently the open-loop handling
qualities) are little modiﬁed.
The computation of an operating point for a faulty ruddervator is described in the sequel.
The right ruddervator is stuck on its whole deﬂection range [−20◦, +20◦] and the remaining
controls are trimmed in order to maintain the UAV ﬂight level with an airspeed close to 25m/s
and an height equal to 200m. The results of the computation are illustrated in Fig 14. They
show that an operating point exists in the [−13◦, +3◦] interval. However, for some fault
positions, the actuator positions are close to their saturation positions. This will drastically
limit the aircraft performance. For example, a fault in the 1◦position can be compensated
with a throttle trimmed at 90%. It is obvious that this value will limit the turning performance.
153
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

Indeed, during the turn, due to the bank angle, the lift force decreases and to keep a constant
height, increasing the throttle control is necessary. As the throttle range is limited, the bank
angle variations will be reduced. This is all the more critical that the aircraft has a lateral
unstable mode. Note that, from now on, there are couplings between the longitudinal and the
lateral axes. Indeed, to obtain these faulty operating points, the longitudinal and the lateral
state variables are coupled e.g. the sideslip angle must differ from zero to achieve a ﬂight level
stage.
For each fault position in the [−13◦, +3◦] interval, the operating point and the related
linearized model are computed. The root locus is depicted in Fig. 15 and shows that the
open-loop poles are little scattered.
To complete this work, similar studies should be conducted for the left ruddervator, the right
and left ailerons.
−10
−5
0
0.4
0.6
0.8
1
δer stuck on [−13°,3°]
δX
e
 (%)
−10
−5
0
−40
−20
0
20
δar
e
 (°)
δer stuck on [−13°,3°]
−10
−5
0
−40
−20
0
20
δal
e
 (°)
δer stuck on [−13°,3°]
−10
−5
0
−20
0
20
40
δfr
e
 (°)
δer stuck on [−13°,3°]
−10
−5
0
−20
0
20
40
δfl
e
 (°)
δer stuck on [−13°,3°]
−10
−5
0
−20
−10
0
10
δel
e
 (°)
δer stuck on [−13°,3°]
 
 
trims in faulty mode
trims in fault−free mode
Fig. 14. Right ruddervator stuck, the remaining control trim positions
−20
−15
−10
−5
0
−10
−8
−6
−4
−2
0
2
4
6
8
20
17.5
15
12.5
10
7.5
5
2.5
0.988
0.95
0.89
0.8
0.7
0.54
0.38
0.18
0.988
0.95
0.89
0.8
0.7
0.54
0.38
0.18
 
 
spiral mode
dutch−roll mode
short−period mode
spiral mode
phugoid mode
propulsion mode
Fig. 15. Right ruddervator stuck, the poles’s map
154
Advances in Flight Control Systems
www.ebook3000.com

5.2 Fault-tolerant controller design
Fault-tolerant control (FTC) strategy has received considerable attention from the control
research community and aeronautical engineering in the last two decades (Steinberg, 2005).
An exhaustive and recent bibliographical review for FTC is presented in (Zhang & Jiang,
2008). Even though different methods use different design strategies, the design goal for
reconﬁgurable control is in fact the same. That is, the design objective of reconﬁgurable control
is to design a new controller such that post-fault closed-loop system has, in certain sense the
same or similar closed-loop performance to that of the pre-fault system (Zhang & Jiang, 2006).
In this work, the FTC objective consists in keeping the faulty UAV handling qualities identical
to those existing in fault-free mode. Moreover, the tracked outputs (φ, β, V, z) should have
the same dynamics that in fault-free mode. As the computation of the faulty operating point
induced couplings between the longitudinal and the lateral axes, and as each healthy actuator
is driven separately, FTC controllers identical to the nominal controller are kept, i.e. linear state
feedback fault-tolerant controllers which design is based on an EA strategy. This is illustrated
in Tab. 3 where the proposed EA strategy aims at accommodating a right ruddervator failure.
Note that with respect to Tab. 1, the closed-loop poles are unchanged, but the eigenvectors
are modiﬁed, particularly to decouple the modes from the faulty control. The design of the
mode
short period phugoid throttle
roll
dutchroll spiral,εφ
εβ
εV,εz
CL poles
−10 ± 10i
−2 ± 2i
−1
−100 −5 ± 5i −1 ± .25i −1.5 −1 ± .5i
eigenvector
−→
v 1,2
−→
v 3,4
−→
v 5
−→
v 6
−→
v 7,8
−→
v 9,10
−→
v 11
−→
v 12,13
φ
×
0
×
×
×
×
×
×
θ
×
×
×
0
×
×
0
×
V
×
×
×
0
0
0
0
×
α
×
×
×
0
×
×
×
×
β
0
0
0
×
×
×
×
×
p
0
0
0
×
×
×
×
0
q
×
×
×
0
×
×
0
×
r
0
0
0
×
×
×
×
0
z
×
×
×
×
0
0
×
×
εΦ
×
×
×
×
×
×
×
×
εβ
×
×
×
×
×
×
×
×
εV
×
×
×
×
×
×
×
×
εz
×
×
×
×
×
×
×
×
δx
0
×
×
×
×
×
×
×
δar
×
0
0
×
×
×
×
0
δal
×
0
0
×
×
×
×
0
δf r
0
×
×
0
0
0
0
×
δf l
×
×
×
0
0
0
0
0
δer
0
0
0
0
0
0
0
0
δel
×
×
0
×
×
×
×
×
Table 3. Fault-tolerant controller, EA strategy for a ruddervator failure
FTC is similar to those presented in section 3. Similar studies could be conducted for the other
control surfaces.
5.3 Fault-tolerant controller implementation
A fault is described by the type of control surface and its fault magnitude. This information is
provided by the FDI system studied above. For a given fault, a new operating point and a FTC
controller must be theoretically computed. As far as the operating points are concerned, they
155
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

are precomputed, tabulated and selected with respect to the fault. In the same way, a FTC
should be designed for each operating point and its corresponding linearized model. This
method has been adopted to compensate for right ruddervator failures. Practically, it enables
to accommodate for them in the [−5◦, 0◦] interval with a 1◦step study. Consequently, six
fault-tolerant controllers should be designed.
In order to reduce this number and for the six faulty linearized models, a single fault-tolerant
controller is kept, the one which minimizes the scattering of the poles. For a right ruddervator
failure, this fault-tolerant controller is the one designed for a −2◦fault position.
Outside this interval, the faults are too severe to be accommodated.
5.4 Results of simulations
Results of simulations are depicted in Fig. 16. The right ruddervator is stuck in the 0◦position
at time t f = 16s. This case is similar to the one studied in the paragraph 4.3.2. After time t f ,
the fault is detected, isolated and its magnitude is estimated, then the fault-tolerant controller
efﬁciently compensates for the fault and the aircraft can continue to ﬂy and to maneuver.
However, for the reasons explained in subsection 5.1, the bank angle cannot exceed 10◦and
the nonlinear effects due to the throttle saturation (see. Fig. 16) affects the dynamics of the
airspeed.
The same fault-tolerant controller is tested for various stuck positions simulated in the
[−5◦, 0◦] interval and occuring at time t f = 16s. As it is shown in Fig. 18, all these faults
are accommodated with this unique fault-tolerant controller.
0
20
40
60
80
100
120
−10
0
10
Bank angle (°)
0
20
40
60
80
100
120
24
25
26
27
Airspeed (m/s)
0
20
40
60
80
100
120
199.5
200
200.5
height (m)
time (s)
0
20
40
60
80
100
120
−2
0
2
Sideslip angle (°)
 
 
Fig. 16. Right ruddervator stuck, the tracked state variables
6. Conclusion
A UAV model has been designed to deal with asymmetrical control surfaces failures that upset
the equilibrium of moments and produce couplings between the longitudinal and the lateral
axes. The nominal controller aims at setting the UAV handling qualities and it is based on an
eigenstructure assignment strategy. Control surface positions are not measured and, in order
to diagnose faults on these actuators, input observability has been studied. It has proven that
faults on the ailerons are not isolable. Next, a bank of Unknown Input Decoupled Functional
156
Advances in Flight Control Systems
www.ebook3000.com

0
20
40
60
80
100
120
0
50
100
Throttle (%)
0
20
40
60
80
100
120
−10
0
10
20
Right and left ailerons (°)
 
 
0
20
40
60
80
100
120
−10
0
10
20
Right and left flaps (°)
 
 
0
20
40
60
80
100
120
−10
−5
0
5
Right and left ruddervators (°)
time (s)
 
 
right aileron
left aileron
right flap
 left flap
right ruddervator
left ruddervator
Fig. 17. Right ruddervator stuck, the controls
0
5
10
15
20
25
30
35
40
45
50
−20
0
20
Bank angle (°)
 
 
0
10
20
30
40
50
60
70
80
24
25
26
27
Airspeed (m/s)
0
20
40
60
80
100
120
199.9
200
200.1
Height (m)
12
14
16
18
20
22
24
26
−2
0
2
Sideslip angle (°)
time (s)
0°
reference
−1°
−2°
−3°
−4°
−5°
Fig. 18. Right ruddervator stuck, the ruddervator actual position, estimation, control position
and the residual
Observers has been implemented in order to detect, isolate and estimate faults. To process
with the faulty ailerons, an isolation method based on a signal processing method has been
presented. Future works should also take into account the redundancies provided by the right
and left ﬂaps. The fault accommodation consists in computing a new operating and a related
fault-tolerant controller. For this latter, the objectives of the settings are identical to those
pursued in the fault-free mode. However, the results of simulations show the importance
of actuator saturations, especially in faulty mode, where to compensate for the fault, the
remaining actuator strokes may be signiﬁcantly reduced and may affect the control stability.
Our present works deal with FTC designs which aim at setting the handling qualities while
sizing the stability domain with respect to the ﬂight envelope by considering the actuator
saturations.
157
Active Fault Diagnosis and Major Actuator Failure Accommodation: Application to a UAV

The ﬁrst author would like to acknowledge Pr.
T. Hermas for proofreading the initial
manuscript.
7. References
Bateman, F., Noura, H. & Ouladsine, M. (2008a). An active fault tolerant procedure for an uav
equipped with redundant control surfaces, 16th Mediterranean Conference on Control
and Automation, Ajaccio, France.
Bateman, F., Noura, H. & Ouladsine, M. (2008b).
A fault tolerant control strategy for an
unmanned aerial vehicle based on a sequential quadratic programming algorithm,
Conference on Decision and Control, Cancun, Mexico.
Bateman, F., Noura, H. & Ouladsine, M. (2009).
Fault tolerant control strategy for an
unmanned aerial vehicle, 7th IFAC SafeProcess, Barcelona, Spain.
Boifﬁer, J. (1998). The dynamics of ight, Wiley.
Brigaud, R. (2006). Working towards a usar stanag, Euro UAV, Paris, France.
Demmel, J. & Kågstrom, B. (1993).
The generalized schur decomposition of an arbitrary
pencil a - zb: robust software with error bounds and applications, ACM Transaction
on Mathematical Software 19(2): 175–201.
Ducard, G. & Geering, H. (2008). Efﬁcient nonlinear actuator fault detection and isolation for
unmanned aerial vehicles, Journal of Guidance, Control and Dynamlics 31(1): 225–237.
Hou, M. & Patton, R. (1998).
Input observability and input reconstruction, Automatica
34(6): 789–794.
Kobayashi, T. & Simon, D. (2003). Application of a bank of kalman ﬁlters for aircraft engine
fault diagnostics, Technical Report NASA Report 212526, NASA.
Magni, J. F., Bennami, S. & Terlouw, J. (1997). Robust Flight Control, a design challenge, Springer.
MIL-HDBK-1797 (1997).
U.s. military handbook mil-hdbk-1797, Technical report, U.S
Department Of Defense.
Noura, H., Theilliol, D., Ponsart, J. & Chamsedinne, A. (2009). Fault-tolerant Flight Control
Systems, Springer.
OSD (2003). Unmanned aerial vehicle reliability study, Technical report, Ofﬁce of the Secretary
of Defense.
Rauw, M. (1993). A Simulink environment for ight dynamics and control analysis, PhD thesis,
Delft University of Technology, Faculty of Aerospace Engineering.
Steinberg, M. (2005). Historical review of research in reconﬁgurable ﬂight control, Journal of
Aerospace Engineering 219(4): 263–275.
Xiong, Y. & Saif, M. (2003). Unknown disturbance inputs estimation based on state functional
observer design, Automatica 39: 1390–1398.
X.Liu, Chen, B. & Lin, Z. (2005). Linear system toolkit in matlab : structural decomposition
and their applications, Journal of Control, theory and application 3: 287–294.
Zhang, Y. & Jiang, J. (2006). Issues on integration of fault diagnosis and reconﬁgurable control
in active fault-tolerant control systems, IFAC Safe Process, Beijing, China.
Zhang, Y. & Jiang, J. (2008). Bibliographical Review on Reconﬁgurable Fault Tolernat Control,
Annual Reviews in Control 32(2): pp. 229–252.
158
Advances in Flight Control Systems
www.ebook3000.com

8 
Fault-Tolerance of a Transport Aircraft  
with Adaptive Control and  
Optimal Command Allocation 
Federico Corraro, Gianfranco Morani and Adolfo Sollazzo 
Italian Aerospace Research Centre (CIRA) 
Italy 
1. Introduction 
How to achieve high performance and reliability against various unforeseen events, 
uncertainties and other changes in plant dynamics has been a very challenging issue for 
control system design in recent years. Reconfigurable flight controls aim to guarantee 
greater survivability in all the cases in which the systems to be controlled may be poorly 
modelled or the parameters of the systems may be subjected to large variations with respect 
to the operating environment. A suitable approach to the problem of flight control 
reconfiguration consists in redesigning its own structure and/or re-computing control gains 
in the case of unexpected events or large model and environmental uncertainties. A number 
of different approaches have been proposed and developed in the past years (Patton, 1997). 
In this chapter a Direct Adaptive Model Following (DAMF) algorithm has been used for 
reconfiguration purposes. It is possible to find in literature a great amount of proposed 
techniques to implement (Bodson & Groszkiewicz, 1997; Calise et al., 2001; Boskovic & 
Mehra, 2002; Kim et al., 2003; Tandale & Valasek, 2003). The Lyapunov theory described in 
(Kim et al., 2003; Tandale & Valasek, 2003) has very attractive features both in terms of 
effectiveness and implementation and it has been used to develop the fault-tolerant scheme 
described in this chapter. 
Another important matter in flight control reconfiguration is the Control Allocation (CA) 
problem. It concerns the possibility to exploit actuators redundancy with respect to the 
variables to be controlled in order to redistribute the control effort among the available 
control effectors. In this way the control commands needed to attain the desired moments 
can be computed even in presence of actuator failures, while also dealing with position and 
rate limits of the control effectors. A great amount of techniques for control allocation are 
available in literature (Virnig & Bodden, 2000; Enns, 1998; Buffington & Chandler, 1998; 
Durham & Bordignon, 1995; Burken et al., 2001). The technique used in this chapter is the 
one introduced by Harkegard (Harkegard, 2002) based on active set methods, which is very 
effective for real-time applications and converge in a finite number of steps. 
Therefore in this chapter a scheme of a fault-tolerant flight control system is proposed. It is 
composed by the core control laws, based on the DAMF technique, to achieve both 
robustness and reconfiguration capabilities, and the CA system, based on the active set 
method, to properly allocate the control effort on the healthy actuators. Numerical results of 

 
Advances in Flight Control Systems 
 
160 
a case study with a detailed model of a large transport aircraft are reported to show the 
effectiveness of the proposed fault-tolerant control scheme. 
The chapter is organized as follows. Sec. 2 explains the proposed flight control system 
architecture and all its features. Sec. 3 and 4 report detailed descriptions of each element 
composing the Flight Control System (FCS). Sec. 5 contains the most meaningful results of 
the numerical evaluation. Finally, Sec. 6 reports the main outcomes and the conclusions 
about the current results of the research project. 
2. The fault-tolerant flight controller scheme 
The logical scheme of the full fault-tolerant flight controller is reported in Fig. 1. The picture 
shows four main elements, the autopilot (A/P), the actuators health monitor, the Stability 
and Controllability Augmentation System (SCAS), based on the DAMF, and the Control 
Allocation module. The last two elements represent the Fault-Tolerant Control System 
(FTCS) that is the object of this chapter. 
 
 
Fig. 1. The first layer scheme of the full Flight Control System 
Although adaptive control exhibits great reconfiguration capabilities, in case of in-flight 
faults, abrupt and dramatic changes in control effectiveness and/or plant dynamics may 
occur, such that the adaptive controller may not be able to recover the vehicle. Therefore, an 
adaptive controller could take advantage of a control allocation module to ensure the 
generation of the demanded moments by the optimal control system, both in healthy and 
faulty conditions of the actuation system.  
The remaining two elements are not the focus of this work and they are developed with 
classic techniques. In details, the A/P is designed by means of the classic sequential loop 
closures, implementing the typical guidance modes for the aircraft (see Table. 1). 
 
Longitudinal 
Lateral 
Altitude Hold/Select 
Heading Hold/Select 
GlideSlope Intercept 
Localizer Intercept 
Approach Lon 
Approach Lat 
Table 1. List of Autopilot modes 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
161 
Also the health monitoring of actuators is a very trivial system based on the comparison 
between the input and the output of each actuators. In the numerical validation it is 
supposed to use a monitoring system with the capability to detect an actuator fault within 
10 seconds, and to pass the binary information healthy/faulty to the control allocation 
system. In the following two sections the elements of the FTCS are briefly recalled. 
3. Adaptive control system 
The core module of the whole flight control system is the SCAS that is in charge of 
guaranteeing vehicle attitude control and stability. As already said, the proposed algorithm 
for this module has been designed using a Direct Adaptive Model-Following method 
(Boskovic & Mehra, 2002; Kim et al., 2003; Tandale & Valasek, 2003), having the advantage 
of strong robustness against model parameter uncertainty, and a good capability of reacting 
to system parameters’ variation. Moreover, the model following strategy lets the designer to 
define in a clear and simple way the reference dynamics for the system, thus making this 
control strategy very attractive among other available robust control techniques. In the 
following some recalls about the DAMF are given. 
3.1 Theoretical recalls 
DAMF is a Model Reference Control Strategies and it earns its robustness properties by 
means of a direct adaptation of control loop gains to asymptotically reach two objectives. 
The first is a null error between the output of the reference model and the one of real plant. 
The second objective is to minimize the control effort. As already said, the proposed 
adaptation algorithm is based on the Lyapunov theory. A mathematical description of the 
method, fully reported in (Kim et al., 2003), follows. Let us consider the linear model of a 
plant: 
 
Cx
y
d
Bu
Ax
x
=
+
+
=

 
(1) 
with x ∈ ℜn the state vector, y ∈ ℜl the output vector, u ∈ ℜm the control vector, A ∈ ℜnxn, 
B ∈ ℜnxm, C ∈ ℜlxn and the term d represents the trim data. The reference system dynamics is 
written in term of desired input-output behaviour: 
 
r
B
y
A
y
m
m
m
m
+
=

 
(2) 
where ym is the desired output for the plant, r is the given demand, Am and Bm represent the 
reference linear system. The control laws structure is defined as follows: 
 
(
)
m
y
K
r
x
G
C
u
0
0
0
+
+
+
=
ν
 
(3) 
where G0, C0 and v are proper terms generated by the adaptation rules, instead K0 is a feed-
forward gain matrix off-line computed. It is now possible to calculate the error function as 
follows: 
 
m
y
y
e
−
=
 
(4) 
and to evaluate the error dynamics, in terms of the plant parameters and the reference 
system dynamics: 

 
Advances in Flight Control Systems 
 
162 
 
(
)
r
B
y
A
Cd
y
K
CBC
CBC
r
CBC
x
G
CBC
CA
e
m
m
m
m
−
−
+
+
+
+
+
=
0
0
0
0
0
0
ν

 
(5) 
Assuming a desired error system dynamics, expressed as: 
 
Φ
+
=
e
A
e
e

 
(6) 
where Ae is a stable and properly chosen matrix, and Φ represents a bounded forcing 
function, it is possible to write the following identities: 
 
e
m
m
e
A
A
K
CBC
Cd
CBC
B
CBC
C
A
G
CBC
CA
−
=
−
=
=
=
+
0
*
0
*
*
0
*
0
*
0
*
0
ν
 
(7) 
Equations 7 allow to write the expressions of the optimal terms G0*, C0*, v* and K0 to obtain a 
perfect model inversion that guarantees the asymptotical stability of the closed loop system 
and the asymptotical null error. 
 
(
)
(
)
(
)
e
m
m
m
m
e
m
A
A
B
K
Cd
B
B
CB
C
CA
C
A
B
G
−
=
−
=
=
−
=
−
−
−
−
1
0
1
*
1
*
0
1
*
0
ν
 
(8) 
In order to evaluate the left hand terms (the gains of the controller), Equations 8 require 
matrix Bm to be invertible and CB matrix to be pseudo-invertible. While the former is a 
design parameter, the latter, called high frequency gain, is a structural characteristic of the 
plant. Anyway, modern aircrafts have typically a sufficient redundancy order for the control 
surfaces, thus ensuring not to lose rank order even in the case of single and often double 
actuators failure. Concerning the C matrix, no sensor failure cases are addressed in this 
chapter, anyway the device redundancy or several techniques, available in literature (f.i. 
Kalman filtering), may ensure a full state feedback, even though each signal may lose 
accuracy in case of sensor failure. 
It should be anyway noted that the control parameters of Equation 8 do not take into 
account the system parameters variation. However, the system parameters uncertainties can 
be modelled by a proper variation of the matrices in Equation 1. Finally, a set of adaptation 
rules is necessary to react to the system parameters variation and uncertainty, Lyapunov 
theory furnishes a very efficient solution. First of all, let us define the differences between 
the actual adaptive parameters and the optimal ones: 
 
*
0
0
1
0
1
*
0
*
0
0
ν
ν
ν
−
=
Δ
−
=
ΔΨ
−
=
Δ
−
−
C
C
G
G
G
 
(9) 
After some manipulations (Kim et al., 2003), here left out for the sake of brevity, it is now 
possible to write the real expression of the error dynamics taking into account a parameters 
variation: 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
163 
 
ν
Δ
+
⋅
ΔΨ
+
⋅
Δ
+
=
m
m
m
e
B
u
B
x
G
B
e
A
e
 
(10) 
It is allowed to impose the Lyapunov stability condition for the error system. So, let us 
consider the Lyapunov candidate function: 
 
3
2
1
γ
ν
ν
γ
γ
Δ
Δ
+
⎭
⎬
⎫
⎩
⎨
⎧
ΔΨ
ΔΨ
+
⎭
⎬
⎫
⎩
⎨
⎧
Δ
Δ
+
=
T
T
T
T
tr
G
G
tr
Pe
e
V
 
(11) 
where P is the matrix solution of Lyapunov equation: 
 
Q
PA
P
A
e
T
e
−
=
+
 
(12) 
with Q is a positive definite weighting matrix. By calculating the time derivative of the 
Lyapunov candidate function and by casting it to get null, the following conditions can be 
found, that represent the adaptation rules for the control laws parameters. 
 
Pe
B
C
Peu
B
C
C
Pex
B
G
T
m
T
T
T
T
m
m
3
0
0
0
2
0
1
0
γ
ν
γ
γ
−
=
−
=
−
=



 
(13) 
Moreover by taking into account the Equations 10, 11 and 13 it is possible to demonstrate 
the non-positiveness of Lyapunov candidate function derivative: 
 
0
≤
−
=
Pe
e
V
T

 
(14) 
which assures the asymptotical stability for the error dynamic system. 
3.2 Implementation of the SCAS module 
The SCAS module is made of two nested sub-modules, taking advantage of the dynamics 
separation principle, being the angular rate dynamics sufficiently faster than those of the 
attitude ones. This two modules architecture also leads to a relevant reduction of the overall 
complexity (in terms of states number) of the adaptive algorithm. The detailed structure of 
each Multi Input Multi Output (MIMO) controller is reported in Fig. 2. The design of both 
inner and outer loops consists in tuning some parameters. First of all, the matrices Am and 
Bm, representing the dynamics of the Reference Model, must be selected with the limitation 
that the former must trivially be chosen with negative eigenvalues and the latter must be 
chosen invertible. These two matrices actually define the control system performance 
requirements. For both attitude and rates regulators, a couple of very simple reference 
models made of two diagonal systems (1st order and decoupled systems) have been chosen. 
The desired error dynamics are chosen through the matrix Ae by which, it is also possible to 
modify the system capability to reject noise and disturbances. 
The matrix Q, used in the Equation 12 for the calculation of P, has the meaning of a 
weighting matrix. By fine tuning this matrix, it is possible to give more or less relevance to 
the tracking requirement of one or more output variables with respect to the others. Finally, 
the three parameters γ1, γ2 and γ3(evaluated by means of a trial and error procedure) are used 
to regulate the adaptive capability. As a reminder, in Table 2 all the design parameters are 
reported. 

 
Advances in Flight Control Systems 
 
164 
 
Fig. 2. SCAS sub-module logical architecture 
 
 
Am, Bm 
Ae 
Q 
γ1, γ2, γ3 
Inner 
Loops 
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
−
−
−
1
0
0
0
1
0
0
0
1
,
1
0
0
0
1
0
0
0
1
 
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
−
−
−
5.4
0
0
0
5.4
0
0
0
5.4
 
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
1
0
0
0
2.1
0
0
0
8.0
 
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
1.0
1.0
06
.0
 
Outer 
Loops 
⎥⎦
⎤
⎢⎣
⎡
⎥⎦
⎤
⎢⎣
⎡
−
−
5.0
0
0
5.0
,
5.0
0
0
5.0
 
⎥⎦
⎤
⎢⎣
⎡
−
−
75
.0
0
0
5.1
 
⎥⎦
⎤
⎢⎣
⎡
5.0
0
0
1
 
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
2.0
01
.0
01
.0
 
Table 2. SCAS module parameters 
4. The control allocation module 
As mentioned in the introduction a control allocation algorithm can be very useful for 
control reconfiguration purposes due to its ability of managing actuator redundancy, so to 
redistribute control effort after a failure event. Moreover, it may be a great support for an 
optimal control strategy, such as the DAMF that works well in the case of limited faults (i.e. 
the plant dynamics do not change dramatically) and in any case it does not take into account 
the limited range and limited rate of the control variables. 
4.1 Theoretical background 
In this section the control allocation problem is briefly introduced. Given a control vector 
up ∈ ℜm as computed by the control system (see Equation 3), a desired moment vector 
vdes ∈ ℜl can be defined as: 
 
p
des
CBu
v
=
 
(15) 
where the matrix product CB is the high frequency gain of the healthy system (no faults). In 
the event of one or more faults, system defined in Equation 1 becomes: 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
165 
 
Cx
y
d
Bu
u
B
Ax
x
lock
fault
=
+
+
+
=

 
(16) 
where Bfault is the control matrix of the failed plant which can be expressed as: 
 
Π
= B
Bfault
 
(17) 
where Π is a diagonal matrix with the elements πi = 0 for i-th actuator failed and πi = 1 for a 
healthy actuator. This matrix accounts for the fact that failed actuators cannot be used 
anymore to change the system’s dynamics. The term Bulock accounts for a residual moment 
due to an actuator locked in a fixed position, so we set ulock(j) = 0 if j-th actuator is healthy 
and ulock(j) = uj if j-th actuator is locked at uj. After this setting, the residual moment to be 
attained by the failed system is defined as 
 
lock
des
CBu
v
v
−
=
Δ
 
(18) 
which is the moment to be attained with the failed high frequency gain matrix Bfault. 
Therefore the goal of control allocation is to find a control ū ∈ ℜm such that CBfaultū =Δv. The 
new control vector shall also satisfy the constraints on maximum and minimum values, 
which can be computed at each instant depending on the actual position and rate limits, that 
is,  umin≤ū≤ umax. 
Generally speaking a solution to the above problem may not exist or it may be not unique 
depending on the rank of matrix CBfault. If there are more solutions, the exceeding control 
authority can be exploited to choose the solution which is the nearest to a reference control 
vector up ∈ ℜm (for example the one computed by the control system). A common approach 
to solve the control allocation problem is based on the following weighted least square 
formulation (Harkegard, 2002): 
 
(
)
(
)
2
2
max
min
min
v
u
CB
W
u
u
W
u
fault
v
p
u
u
u
u
w
Δ
−
+
−
=
≤
≤
γ
 
(19) 
where ║·║2 is the L2-norm, up is a reference control vector, Wu and Wv are non-singular 
weighting matrices. The first term of the above minimization problem allows to choose, 
among all the feasible control vectors which minimize the L2-norm of the error CBfaultu-Δv, 
the one minimizing the norm of (u-up). The weighting factor γ defines the relative degree of 
importance between the moments error CBfaultu-Δv and the control error (u-up). Obviously γ 
should be chosen large enough to ensure the minimization of the error in attaining the 
desired moments. 
In this chapter we will address the problem of control allocation with the use of a technique 
based on the active set method and described in (Harkegard, 2002). Active set methods are 
very common in constrained quadratic programming. They only consider active constraints 
(equality constraints) and disregard inactive constraints. Therefore active set algorithms 
move on the surface defined by the set of the active constraints (named Working Set) to get 
an improved solution. The working set is continuously updated during the execution of the 
algorithm. In fact, whenever a new constraint is violated, it is added to the current working 
set. On the other hand, if a feasible solution has been found by the algorithm, but a 
Lagrange multiplier related to the current working set is negative, the corresponding active 
constraint is dropped in order to get an improved solution. An exhaustive description of the 

 
Advances in Flight Control Systems 
 
166 
control allocation algorithm used in this chapter can be found in (Harkegard, 2002). Some 
recalls are given in the section below. 
4.2 Control allocation algorithm 
For each iteration step of the algorithm the following optimization problem is solved: 
 
(
)
⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
=
⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
=
∈
=
−
+
p
u
v
u
v
k
i
k
p
u
W
v
W
b
W
B
W
A
W
i
p
b
u
p
A
γ
γ
  ,
        
,
  ,0
;
min
2
 
(20) 
where uk is the starting solution at the iteration step k, the set Wk is the current working set, 
that is, the set containing the active constraints (i.e. saturated controls) which are expressed 
through the equality pi=0, while the remaining inequality constraints are disregarded. 
Solution to the least square problem of Equation 21 consists of finding the optimal 
perturbation p which can be obtained by using a simple pseudo inversion method 
(Harkegard, 2002). Once the constraints on actuator limits have been set 
 
⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
−
+
=
⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
−
+
=
≥
min
max
  ,
;
u
u
U
I
I
C
U
Cu
 
(21) 
(Imxm is the identity matrix), if the solution uk+p is feasible, the Lagrange multipliers λi 
associated with the active constraints are computed. If they are non-negative, the optimum 
solution is obtained otherwise the i-th constraint is dropped from the active set because a 
better solution can be found according to the meaning of Lagrange multipliers (Luenberger, 
1989). In the case that uk+p is not feasible, the maximum step α is calculated such that uk+αp 
is still feasible and a new constraint is added to the working set. This iterative procedure is 
then repeated until a suitable solution and a working set with negative related Lagrange 
multiplier are found. 
4.3 Remarks 
As above described control allocation algorithm has the aim of redistribute the control effort 
among the “healthy” surfaces to achieve the moments needed to keep the system along 
reference trajectory. In view of these considerations we argue that control allocation can be 
very useful, when used in conjunction with a direct adaptive control in those critical failure 
scenarios which can be hardly handled by the only use of the adaptive controller. 
Nevertheless, in order to be effective for reconfiguration purposes, control allocation needs a 
Fault Detection (FD) system, which gives information about the health of the surfaces’ 
actuators. This aspect could make unfeasible the use of a CA scheme. Anyway, in the 
following sections it will be shown that, in order to obtain a satisfactory performance of the 
CA module, only limited failure information are needed. In fact, also a very simple 
monitoring algorithm, based on the actuator model and on the surface actual position, can 
be sufficient to establish whether an actuator is failed or not. The results show that the use of 
a CA scheme allows significant improvements of the control system performances also in 
the event of very critical failures and it only needs limited information about actuators’ 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
167 
health. These features make the proposed control architecture very appealing for 
reconfiguration purposes. 
5. Numerical validation 
The FCS has been applied in a case study with a large transport aircraft. The works has been 
performed within the GARTEUR Action Group 16, project focused on Fault-Tolerant 
Control. In that project a benchmark environment (Smaili et al., 2006) has been developed 
modelling a bunch of surface actuators faulty conditions. A brief summary of all these 
conditions is given in Table 3, while a detailed explanation of the benchmark can be found 
in (Smaili et al., 2006). 
Several manoeuvres are considered in the benchmark to be accomplished in the various 
faulty conditions. The test results are here shown both in terms of time histories of the state 
variables and with a visual representation of the trajectories performed by the airplane. 
 
Stuck Ailerons: 
Both inboard and outboard ailerons are stuck. 
 
Stuck Elevators: 
Both inboard and outboard elevators are stuck. 
 
Stabilizer Runaway: 
The stabilizer goes at the maximum speed toward 
the maximum deflection. 
 
Rudder Runaway: 
The upper and lower rudders go at the maximum 
speed toward the maximum deflection. 
 
Loss of Vertical Tail: 
The vertical tail separates from the aircraft. 
 
  
 
Table 3. Failures considered in the test campaign 
Only the most meaningful conditions are here reported and discussed. To better 
demonstrate the improvement of fault-tolerance achieved by adopting the adaptive control 
in conjunction with the Control Allocation, comparison is made between three versions of 
the FCS, the first is a baseline SCAS developed with classic control techniques. The two 
remaining FCS are based on the adaptive SCAS with and without the CA respectively. As 
above said, only limited FD information are supposed to be provided, that is, the 
information about whether an actuator is failed or not but the current position of the failed 
actuator will be considered as unknown. The CA parameters have been set to: 
 
3
3
3
3
6
10
×
×
=
=
=
I
W
I
W
v
u
γ
 
(22) 

 
Advances in Flight Control Systems 
 
168 
5.1 Straight flight with stabilizer failure 
In this condition, while in straight and levelled flight, the aircraft experiences a stabilizer 
runaway to maximum defection that generates a pitching down moment. The initial flight 
condition data are summarized in Table 4.  
 
Altitude 
[m] 
True Airspeed 
[m/s] 
Heading 
[deg] 
Mass 
[kg] 
Flaps 
[deg] 
600 
92.6 
180 
263,000 
20 
Table 4. Flight condition data 
 
 
(a) Trajectories 
 
(b) Time plots 
Fig. 3. Straight flight with stabilizer runaway with classic technique (dotted line), DAMF 
(solid line) and DAMF+CA (dashed line) 
Fig. 3 (a) shows the great improvement achieved thanks to the adoption of the control 
allocation. Note that the classic technique, for this failure condition, shows adequate 
robustness. This is caused by its structure. In fact, the longitudinal control channel (PI for 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
169 
pitch-angle above proportional pitch-rate SAS) affects only the elevators, while the stabilizer is 
supposed to be operated by the pilot separately. In this way, the stabilizer runway results to be 
a strong, but manageable disturbance. Instead, the DAMF tries to recover the attitude 
lavishing stronger control effort on the faulty stabilizer, the most effective surface, with bad 
results. The awareness of the fault on the stabilizer gives the chance to the CA technique to 
compensate by moving the control effort from this surface to the elevators, thus achieving the 
same results of the classical technique. As it is also evident in the time plots of Fig. 3 (b) when 
the failure is detected and isolated (here it is supposed to be done in 10 sec after the failure 
occurs), the aircraft recovers a more adequate attitude to carry out properly the manoeuvre. 
5.2 Right turn and localizer intercept with rudder runaway 
This manoeuvre consists in the interception of the localizer beam, parallel to initial flight 
path, but opposite in versus. So, in the early stage of the manoeuvre, a right turn is 
performed, and then the capture and the tracking of the localizer beam are carried out. The 
fault, instead, consists in a runaway of both upper and lower rudder surfaces, so giving a 
strong yawing moment opposite to the desired turn. The initial flight condition data are 
summarized in Table 4. 
In this failure case, a classical technique is totally inadequate to face such a failure, so 
leading the aircraft to crash into the ground. Instead, the DAMF shows to be robust enough 
to deal with this failure condition and it makes the aircraft to accomplish the manoeuvre, 
even though with reduced performance. The control allocation technique, instead, shows a 
sensible improvement of the robustness (see Fig. 4), if compared to the DAMF technique. 
The awareness of the fault (detected 10 sec after it actually occurs) allows the control laws to 
fully exploit all the efficient effectors, thus accomplishing the manoeuvre smoothly. It is 
worth noting that in this case the DAMF without CA is robust enough to accomplish the 
manoeuvre, even though with degraded performances. 
5.3 Right turn and localizer intercept with loss of vertical tail 
The manoeuvre, here considered, is the same described in the previous subsection, but the 
failure scenario consists in the loss of the vertical tail (Smaili et al., 2006). The initial flight 
condition data are summarized in Table 4. This is both a structural and actuation failure, in 
fact, the loss of the rudders strongly affects the lateral-directional aerodynamics and stability, 
compromising the possibility to damp the rotations about the roll and yaw axes. In this case 
(see Fig. 5), the classical technique is not able to reach lateral stability. Instead, no significant 
differences are evidenced between the two versions of the adaptive FCS (with and without 
CA). In fact, the information about the efficiency of the differential thrust is already available 
to the DAMF, due to the linear model of the bare Aircraft. Thus, as the tracking errors increase, 
the core control laws raise the control effort for both the rudders (failed) and the differential 
thrust. The latter is efficient enough to ensure the manoeuvrability. 
6. Conclusions 
In this chapter a fault-tolerant FCS architecture has been proposed. It exploits the main 
features of two different techniques, the adaptive control and the control allocation. The 
contemporaneous usage of these two techniques, the former for the robustness, and the 
latter for the explicit actuators failure treatment, has shown significant improvements in 
terms of fault-tolerance if compared to a simple classical controller and to the only adaptive  
 

 
Advances in Flight Control Systems 
 
170 
 
 
 
(a) Trajectories 
 
 
 
(b) Time plots 
Fig. 4. Right turn and localizer intercept with rudder runaway with classic technique (dotted 
line), DAMF (solid line) and DAMF+CA (dashed line) 
www.ebook3000.com

Fault-Tolerance of a Transport Aircraft with Adaptive Control and Optimal Command Allocation   
 
171 
 
 
 
(a) Trajectories 
 
 
(b) Time plots 
Fig. 5. Loss of vertical tail failure scenario, while performing a right turn & localizer intercept 
runaway with classic technique (dotted line), DAMF (solid line) and DAMF+CA (dashed line) 

 
Advances in Flight Control Systems 
 
172 
controller. The ability of the DAMF to on-line re-compute the control gains guarantees both 
robustness and performance, as shown in the proposed test cases. However, the 
contemporary usage of a control allocation scheme allowed improving significantly the 
fault-tolerance capabilities, at the only expense of requiring some limited information about 
the vehicle actuators’ health. Therefore the proposed fault-tolerant scheme appears to be 
very promising to deal with drastic off-nominal conditions as the ones induced by severe 
actuators failure and damages thus improving the overall adaptive capabilities of a 
reconfigurable flight control system. 
7. References 
Bodson, M. & Groszkiewicz, J. E. (1997). Multivariable Adaptive Algorithms for 
Reconfigurable Flight Control, IEEE Transaction on Control Systems Technology, Vol. 
5, No. 2, pp. 217-229. 
Boskovic, J. D. & Mehra, R. K. (2002), Multiple-Model Adaptive Flight Control Scheme for 
Accommodation of Actuator Failures, Journal of Guidance, Control, and Dynamics, 
Vol. 25, No. 4, pp. 712-724. 
Buffington, J. & Chandler, P. (1998), Integration of on-line system identification and 
optimization-based control allocation, Proceedings of AIAA Guidance, Navigation, and 
Control Conference and Exhibit, Boston, MA. 
Burken, J. J., Lu, P., Wu, Z. & Bahm, C. (2001), Two Reconfigurable Flight-Control Design 
Methods: Robust Servomechanism and Control Allocation, Journal of Guidance, 
Control, and Dynamics, Vol. 24, No. 3, pp. 482-493.  
Calise, A. J., Hovakimyan, N. & Idan, M. (2001). Adaptive output feedback control of 
nonlinear systems using neural networks, Automatica, Vol. 37, No. 8, pp. 1201–1211. 
Durham, W. C. & Bordignon, K. A. (1995), Closed-Form Solutions to Constrained Control 
Allocation Problem, Journal of Guidance, Control and Dynamics, Vol. 18, No. 5, pp. 
1000-1007. 
Enns, D. (1998), Control Allocation Approaches, Proceedings of the AIAA Guidance, Navigation 
and Control Conference, Boston, MA. 
Harkegard, O. (2002), Efficient Active Set Algorithms for Solving Constrained Least squares 
Problems in Aircraft Control Allocation, Proceedings. of the 41st IEEE Conference on 
Decision  and Control, Vol. 2, pp. 1295-1300. 
Kim, K. S., Lee, K. J. & Kim, Y. (2003), Reconfigurable Flight Control System Design Using Direct 
Adaptive Method, Journal of Guidance, Control, and Dynamics, Vol. 26, No. 4, pp. 543-550. 
Luenberger, D. G. (1989), Linear and Nonlinear Programming, 2nd ed., Addison-Welsey, 1989, 
Chapter 11. 
Patton, R. J. (1997). Fault-Tolerant Control Systems: The 1997 Situation, Proceedings of the 
IFAC Symposium on Fault Detection, Supervision and Safety for Technical Processes, Vol. 
2, pp. 1033–1055. 
Smaili, M. H., Breeman, J., Lombaerts, T. J. & Joosten, D. A. (2006), A Simulation Benchmark 
for Integrated Fault Tolerant Flight Control Evaluation, Proceedings of AIAA 
Modeling and Simulation Technologies Conference and Exhibit, Keystone, CO. 
Tandale, M. & Valasek, J. (2003), Structured Adaptive Model Inversion Control to 
Simultaneously Handle Actuator failure and Actuator Saturation, Proceedings. of the 
AIAA Guidance, Navigation and Control Conference, Austin, TX.  
Virnig, J. & Bodden, D. (2000), Multivariable Control Allocation and Control Law 
Conditioning when Control Effector Limit, Proceedings of the AIAA Guidance, 
Navigation and Control Conference, Denver, CO. 
www.ebook3000.com

9 
Acceleration-based 3D Flight Control for UAVs: 
Strategy and Longitudinal Design 
Iain K. Peddle and Thomas Jones 
Stellenbosch University 
South Africa 
1. Introduction  
 
 
 
The design of autopilots for conventional flight of UAVs is a mature field of research. Most 
of the published design strategies involve linearization about a trim flight condition and the 
use of basic steady state kinematic relationships to simplify control law design (Blakelock,  
1991);(Bryson, 1994). To ensure stability this class of controllers typically imposes significant 
limitations on the aircraft’s allowable attitude, velocity and altitude deviations. Although 
acceptable for many applications, these limitations do not allow the full potential of most 
UAVs to be harnessed. For more demanding UAV applications, it is thus desirable to 
develop control laws capable of guiding aircraft though the full 3D flight envelope. Such an 
autopilot will be referred to as a manoeuvre autopilot in this chapter. 
A number of manoeuvre autopilot design methods exist. Gain scheduling (Leith &. 
Leithead, 1999) is commonly employed to extend aircraft velocity and altitude flight 
envelopes (Blakelock, 1991), but does not tend to provide an elegant or effective solution for 
full 3D manoeuvre control. Dynamic inversion has recently become a popular design 
strategy for manoeuvre flight control of UAVs and manned aircraft (Bugajski & Enns, 1992); 
(Lane & Stengel, 1998);(Reiner et al., 1996);(Snell et al., 1992) but suffers from two major 
drawbacks. The first is controller robustness, a concern explicitly addressed in (Buffington et 
al., 1993) and (Reiner et al., 1996), and arises due to the open loop nature of the inversion 
and the inherent uncertainty of aircraft dynamics. The second drawback arises from the 
slightly Non Minimum Phase (NMP) nature of most aircraft dynamics, which after direct 
application of dynamic inversion control, results in not only an impractical controller with 
large counterintuitive control signals (Hauser et al., 1992) (Reiner et al., 1996), but also in 
undesired internal dynamics whose stability must be investigated explicitly (Slotine & Li, 
1991). Although techniques to address the latter drawback have been developed (Al-
Hiddabi & McClamroch, 2002);(Hauser et al., 1992), dynamic inversion is not expected to 
provide a very practical solution to the 3D flight control problem and should ideally only be 
used in the presence of relatively certain minimum phase dynamics. 
Receding Horizon Predictive Control (RHPC) has also been applied to the manoeuvre flight 
control problem (Bhattacharya et al., 2002);(Miller & Pachter, 1997);(Pachter et al., 1998), and 
similarly to missile control (Kim et al., 1997). Although this strategy is conceptually very 
promising the associated computational burden often makes it a practically infeasible 
solution for UAVs, particularly for lower cost UAVs with limited processing power. 

 
Advances in Flight Control Systems 
 
174 
The manoeuvre autopilot solution presented in this chapter moves away from the more 
mainstream methods described above and instead returns to the concept of acceleration 
control which has been commonly used in missile applications, and to a limited extent in 
aircraft applications, for a number of decades (see (Blakelock, 1991) for a review of the major 
results). However, whereas acceleration control has traditionally been used within the 
framework of linearised flight control (the aircraft or missile dynamics are linearised, 
typically about a straight and level flight condition), the algorithms and mathematics 
presented in this chapter extend the fundamental acceleration controller to operate equally 
effectively over the entire 3D flight envelope. The result of this extension is that the aircraft 
then reduces to a point mass with a steerable acceleration vector from a 3D guidance 
perspective. This abstraction which is now valid over the entire flight envelope is the key to 
significantly reducing the complexity involved in solving the manoeuvre flight control 
problem. 
The chapter thus begins by presenting the fundamental ideas behind the design of gross 
attitude independent specific acceleration controllers. It then highlights how these inner 
loop controllers simplify the design of a manoeuvre autopilot and motivates that they lead 
to an elegant, effective and robust solution to the problem. Next, the chapter presents the 
detailed design and associated analysis of the acceleration controllers for the case where the 
aircraft is constrained to the vertical plane. A number of interesting and useful novel results 
regarding aircraft dynamics arise from the aforementioned analysis. The 2D flight envelope 
illustrates the feasibility of the control strategy and provides a foundation for development 
to the full 3D case.  
2. Autopilot design strategy for 3D manoeuvre flight 
For most UAV autopilot design purposes, an aircraft is well modelled as a six degree of 
freedom rigid body with specific and gravitational forces and their corresponding moments 
acting on it. The specific forces typically include aerodynamic and propulsion forces and 
arise due to the form and motion of the aircraft itself. On the other hand the gravitational 
force is universally applied to all bodies in proportion to their mass, assuming an 
equipotential gravitational field. The sum of the specific and gravitational forces determines 
the aircraft’s total acceleration. It is desirable to be able to control the aircraft’s acceleration 
as this would leave only simple outer control loops to regulate further kinematic states. 
Of the total force vector, only the specific force component is controllable (via the 
aerodynamic and propulsion actuators), with the gravitational force component acting as a 
well modelled bias on the system. Thus, with a predictable gravitational force component, 
control of the total force vector can be achieved through control of the specific force vector. 
Modelling the specific force vector as a function of the aircraft states and control inputs is an 
involved process that introduces almost all of the uncertainty into the total aircraft model. 
Thus, to ensure robust control of the specific force vector a pure feedback control solution is 
desirable. Regulation techniques such as dynamic inversion are thus avoided due to the 
open loop nature of the inversion and the uncertainty associated with the specific force 
model. 
Considering the specific force vector in more detail, the following important observation is 
made from an autopilot design simplification point of view. Unlike the gravitational force 
vector which remains inertially aligned, the components that make up the specific force 
vector tend to remain aircraft aligned. This alignment occurs because the specific forces arise 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
175 
as a result of the form and motion of the aircraft itself. For example, the aircraft’s thrust 
vector acts along the same aircraft fixed action line at all times while the lift vector tends to 
remain close to perpendicular to the wing depending on the specific angle of attack. The 
observation is thus that the coordinates of the specific force vector in a body fixed axis 
system are independent of the gross attitude of the aircraft. This observation is important 
because it suggests that if gross attitude independent measurements of the specific force 
vector’s body axes coordinates were available, then a feedback based control system could 
be designed to regulate the specific force vector independently of the aircraft’s gross 
attitude. Of course, appropriately mounted accelerometers provide just this measurement, 
normalized to the aircraft’s mass, thus practically enabling the control strategy through 
specific acceleration instead. 
With gross attitude independent specific acceleration controllers in place, the remainder of a 
full 3D flight autopilot design is greatly simplified. From a guidance perspective the aircraft 
reduces to a point mass with a fully steerable acceleration vector. Due to the acceleration 
interface, the guidance dynamics will be purely kinematic and the only uncertainty present 
will be that associated with gravitational acceleration. The highly certain nature of the 
guidance dynamics thus allows among others, techniques such as dynamic inversion and 
RHPC to be effectively implemented at a guidance level. In addition to the associated 
autopilot simplifications, acceleration based control also provides for a robust autopilot 
solution. All aircraft specific uncertainty remains encapsulated behind a wall of high 
bandwidth specific acceleration controllers. Furthermore, high bandwidth specific 
acceleration controllers would be capable of providing fast disturbance rejection at an 
acceleration level, allowing action to be taken before the disturbances manifest themselves 
into position, velocity and attitude errors. 
With the novel control strategy and its associated benefits conceptually introduced the 
remainder of this chapter focuses on the detailed development of the inner loop specific 
acceleration controllers for the case where the aircraft’s motion is constrained to the 2D 
vertical plane. No attention will be given to outer guidance level controllers in the 
knowledge that control at this level is simplified enormously by the inner loop controllers. 
The detailed design of the remaining specific acceleration controllers to complete the set of 
inner loop controllers for full 3D flight are presented in (Peddle, 2008). 
3. Modelling 
To take advantage of the potential of regulating the specific acceleration independently of 
the aircraft’s gross attitude requires writing the equations of motion in a form that provides 
an appropriate mathematical hold on the problem. Conceptually, the motion of the aircraft 
needs to be split into the motion of a reference frame relative to inertial space (to capture the 
gross attitude and position of the aircraft) and the superimposed rotational motion of the 
aircraft relative to the reference frame. With this mathematical split, it is expected that the 
specific acceleration coordinates in the reference and body frames will remain independent 
of the attitude of the reference frame. An obvious and appropriate choice for the reference 
frame is the commonly used wind axis system (axial unit vector coincides with the velocity 
vector). Making use of this axis system, the equations of motion are presented in the desired 
form below. The dynamics are split into the point mass kinematics (motion of the wind axis 
system through space), 

 
Advances in Flight Control Systems 
 
176 
 
(
)
cos
W
W
W
C
g
V
Θ
= −
+
Θ

 
(1) 
 
sin
W
W
V
A
g
=
−
Θ

 
(2) 
 
cos
N
W
P
V
=
Θ

 
(3) 
 
sin
D
W
P
V
= −
Θ

 
(4) 
and the rigid body rotational dynamics (attitude of the body axis system relative to the wind 
axis system), 
 
yy
Q
M I
=

 
(5) 
 
(
)
cos
W
W
Q
C
g
V
α =
+
+
Θ

 
(6) 
with, 
W
Θ
 the flight path angle, V  the velocity magnitude, 
N
P  and 
D
P  the north and down 
positions, g  the gravitational acceleration, Q  the pitch rate, M  the pitching moment, 
yy
I
 the 
pitch moment of inertia, α  the angle of attack and 
W
A
 and 
W
C
 the axial and normal specific 
acceleration coordinates in wind axes respectively. Note that the point mass kinematics 
describe the aircraft’s position, velocity magnitude and gross attitude over time, while the 
rigid body rotational dynamics describes the attitude of the body axis system with respect to 
the wind axis system (through the angle of attack) as well as how the torques on the aircraft 
affect this relative attitude. It must be highlighted that the particular form of the equations of 
motion presented above is in fact readily available in the literature (Etkin, 1972), albeit not 
appropriately rearranged. However, presenting this particular form within the context of the 
proposed manoeuvre autopilot architecture and with the appropriate rearrangements will be 
seen to provide a novel perspective on the form that explicitly highlights the manoeuvre 
autopilot design concepts. Expanding now the specific acceleration terms with a commonly 
used pre-stall flight aircraft specific force and moment model yields, 
 
(
)
cos
W
A
T
D
m
α
=
−
 
(7) 
 
(
)
sin
W
C
T
L
m
α
= −
+
 
(8) 
with, 
 
T
C
T
T
T
T
τ
τ
= −
+

 
(9) 
 
L
L
qSC
=
 
(10) 
 
D
D
qSC
=
 
(11) 
 
m
M
qSC
=
 
(12) 
where m  is the aircraft’s mass, 
T
τ  the thrust time constant, S  the area of the wing, 
L
C , 
D
C  
and 
m
C  the lift, drag and pitching moment coefficients respectively and, 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
177 
 
2 2
q
V
ρ
=
 
(13) 
the dynamic pressure. Expansion of the aerodynamic coefficients for pre-stall flight (Etkin & 
Reid, 1995) yields, 
 
(
)
0
2
Q
E
L
L
L
L
L
E
C
C
C
C
c
V Q
C
α
δ
α
δ
=
+
+
+
 
(14) 
 
0
2
D
D
L
C
C
C
Ae
π
=
+
 
(15) 
 
(
)
0
2
Q
E
m
m
m
m
m
E
C
C
C
C
c
V Q
C
α
δ
α
δ
=
+
+
+
 
(16) 
where A  is the aspect ratio, e  the Oswald efficiency factor and standard non-dimensional 
stability derivative notation is used. Note that it is assumed in this chapter that the non-
dimensional stability derivatives above are independent of both the point mass and rigid 
body rotational dynamics states. Although in reality the derivatives do change somewhat 
with the system states, for many UAVs operating under pre-stall flight conditions this 
change is small. Furthermore, with the intention being to design a feedback based control 
system to regulate specific acceleration, the adverse effect of the modelling errors will be 
greatly reduced thus further justifying the assumption. 
 
Rigid Body Rotational Dynamics
T
E
δ
[
]
T
Q
α
m
yy
I
W
A
W
C
Point mass kinematics
T
W
N
D
V
P
P
⎡
⎤
Θ
⎣
⎦
W
Θ
V
N
P
D
P
cos
W
g
Θ
(
)
D
f P
ρ =
V
cos
W
g
Θ
ρ
g
 
Fig. 1. Split between the rigid body rotational dynamics and the point mass kinematics. 
Figure 1 provides a graphical overview of the particular form of the dynamics presented 
here. The dash-dotted vertical line in the figure highlights a natural split in the aircraft 
dynamics into the aircraft dependent rigid body rotational dynamics on the left and the 
aircraft independent point mass kinematics on the right. It is seen that all of the aircraft 
specific uncertainty resides within the rigid body rotational dynamics, with gravitational 
acceleration being the only inherent uncertainty in the point mass kinematics. Of course left 

 
Advances in Flight Control Systems 
 
178 
unchecked, the aircraft specific uncertainty in the rigid body rotational dynamics would 
leak into the point mass kinematics via the axial and normal specific acceleration, thus 
motivating the design of feedback based specific acceleration controllers. 
Continuing to analyze Figure 1, the point mass kinematics are seen to link back into the 
rigid body rotational dynamics via the velocity magnitude, air density (altitude) and flight 
path angle. If it can be shown that the aforementioned couplings do not strongly influence 
the rigid body rotational dynamics, then the rigid body rotational dynamics would become 
completely independent of the point mass kinematics and thus the gross attitude of the 
aircraft. This in turn would provide the mathematical platform for the design of gross 
attitude independent specific acceleration controllers. 
Investigating the feedback couplings, the velocity magnitude and air density couple into the 
rigid body rotational dynamics primarily through the dynamic pressure, which is seen in 
equations (10) through (12) to scale the magnitude of the aerodynamic forces and moments. 
However, the dynamics of most aircraft are such that the angle of attack and pitch rate 
dynamics operate on a timescale much faster than that of the velocity magnitude and air 
density dynamics. Thus, assuming that a timescale separation either exists or can be 
enforced through feedback control, the dynamic coupling is reduced to a static dependence 
where the velocity magnitude and air density are treated as parameters in the rigid body 
rotational dynamics. 
The flight path angle is seen to couple only into the angle of attack dynamics, via 
gravitational acceleration. The flight path angle coupling term in equation (6) represents the 
tendency of the wind axis system to rotate under the influence of the component of 
gravitational acceleration normal to the velocity vector. The rotation has the effect of 
changing the relative attitude of the body and wind axis system as modelled by the angle of 
attack dynamics. However, the normal specific acceleration (shown in parenthesis next to 
the gravity term in equation (6)) will typically be commanded by an outer loop guidance 
controller to cancel the gravity term and then further to steer the aircraft as desired in 
inertial space. Thus, the effect of the flight path coupling on the angle of attack dynamics is 
expected to be small. However, to fully negate this coupling, it will be assumed that a 
dynamic inversion control law can be designed to reject it, the details of which will be 
discussed in a following section. Note however, that dynamic inversion will only be used to 
reject the arguably weak flight path angle coupling, with the remainder of the control 
solution to be purely feedback based. 
With the above timescale separation and dynamic inversion assumptions in place, the rigid 
body rotational dynamics become completely independent of the point mass kinematics and 
thus provide the mathematical platform for the design of gross attitude independent specific 
acceleration controllers. With all aircraft specific uncertainty encapsulated within the inner 
loop specific acceleration controllers and disturbance rejection occurring at an acceleration 
level, the design is argued to provide a robust solution to the manoeuvre flight control 
problem. The remainder of this article focuses of the design and simulation of the axial and 
normal specific acceleration controllers, as well as the associated conditions for their 
implementation. 
4. Decoupling the axial and normal dynamics 
Control of the axial and normal specific acceleration is dramatically simplified if the rigid 
body rotational dynamics can be decoupled into axial and normal dynamics. This 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
179 
decoupling would allow the axial and normal specific acceleration controllers to be 
designed independently. To this end, consider equations (7) and (8), and notice that for 
small angles of attack and typical lift to drag ratios, the equations can be well approximated 
as follows, 
 
(
)
W
A
T
D
m
≈
−
 
(17) 
 
W
C
L m
≈−
 
(18) 
With these simplifying assumptions, the thrust no longer couples into the normal dynamics 
whose states and controls include the angle of attack, pitch rate and elevator deflection. On 
the other hand, the normal dynamics states still drive into the axial dynamics through the 
drag coupling of equation (17). However, through proper use of the bandwidth-limited 
thrust actuator the drag coupling can be rejected up to some particular frequency. Assuming 
that effective low frequency disturbance rejection can be achieved up to the open loop 
bandwidth of the thrust actuator, then only drag disturbance frequencies beyond this 
remain of concern from a coupling point of view. 
Considering now the point mass kinematics, it is clear from equation (2) that the axial 
specific acceleration drives solely into the velocity magnitude dynamics. Thus 
uncompensated high frequency drag disturbances will result in velocity magnitude 
disturbances which in turn will couple back into the rest of the rigid body rotational 
dynamics both kinematically and through the dynamic pressure. However, the natural 
integration process of the velocity magnitude dynamics will filter the high frequency part of 
the drag coupling. Thus, given acceptable deviations in the velocity magnitude, the thrust 
actuator need only reject enough of the low frequency portion of the drag disturbance for its 
total effect on the velocity magnitude to be acceptable. By acceptable it is meant that the 
velocity magnitude perturbations are small enough to result in a negligible coupling back 
into the rigid body rotational dynamics. 
To obtain a mathematical hold on the above arguments, consider the closed loop transfer 
function from the normalized drag input to the axial specific acceleration output, 
 
( )
( )
( )
W
D
A
s
S
s
D s m
≡
 
(19) 
Through proper control system design, the gain of the sensitivity transfer function above 
can be kept below a certain threshold within the controller bandwidth. The bandwidth of 
the axial specific acceleration controller will however typically be limited to that of the 
thrust actuator for saturation reasons. For frequencies above the controller bandwidth, the 
sensitivity transfer function will display some form of transient and then settle to unity gain. 
Considering the velocity magnitude dynamics of equation (2), the total transfer function of 
the normalized drag input to velocity magnitude is then, 
 
( )
( )
( )
D
V s
S
s
D s m
s
=
 
(20) 
Note that the integrator introduced by the natural velocity dynamics will result in 
diminishing high frequency gains. Equation (20) can be used to determine whether drag 

 
Advances in Flight Control Systems 
 
180 
perturbations will result in acceptable velocity magnitude perturbations. Conversely, given 
the expected drag perturbation spectrum and the acceptable level of velocity magnitude 
perturbations, the specifications of the sensitivity transfer function can be determined. To 
ease the process of determining acceptable levels of velocity magnitude perturbations and 
expected levels of drag perturbations, it is convenient to write these both in terms of normal 
specific acceleration. The return disturbance in normal specific acceleration due to a normal 
specific acceleration perturbation can then be used to specify acceptable coupling levels. 
Relating first normalized drag to normal specific acceleration, use of equation (18) provides 
the following result, 
 
1
W
LD
D m
C
R
= −
 
(21) 
where use has been made of the fact that lift is related to drag through the lift to drag ratio 
LD
R
. Then, equation (18) can be used to capture the dominant relationship between velocity 
perturbations and the resulting normal specific acceleration perturbations. Partially 
differentiating equation (18) with respect to the velocity magnitude yields the desired result, 
 
2
L
W
L
W
qSC
C
VSC
C
m
m
V
V
V
ρ
−
∂
∂
−
=
≈
=
∂
∂
 
(22) 
Combining equations (20) to (22) yields the return disturbance sensitivity function, 
 
( )
( )
( )
1
2
( )
W
W
C
W
W
D
LD
D m
C
V s
S
s
D s m
C
V
C
S
s
s
VR
∂
≡
⋅
⋅
∂
⎛
⎞
= −
⎜
⎟
⎜
⎟
⎝
⎠
 
(23) 
Given an acceptable return disturbance level, the specifications of the sensitivity function of 
equation (19) can be determined for a particular flight condition. With the velocity 
magnitude and lift to drag ratio forming part of the denominator of equation (23), the 
resulting constraints on the sensitivity function are mild for low operating values of normal 
specific acceleration. Only during very high acceleration manoeuvres, does the sensitivity 
specification become more difficult to practically realize. This is illustrated through an 
example calculation at the end of section 5. 
Given the above arguments, the drag coupling into the axial specific acceleration dynamics 
can be ignored if the associated sensitivity function constraint is adhered to when designing 
the axial specific acceleration controller. With the coupling of the drag term ignored, the 
axial dynamics become independent of the normal dynamics allowing the controllers to be 
designed separately. Furthermore, note that the axial dynamics also become independent of 
the velocity magnitude and the air density. Thus, unlike the normal specific acceleration 
controller, there is no need for the axial specific acceleration controller to operate on a 
timescale much faster than these variables. This greatly improves the practical viability of 
designing an axial specific acceleration control system since most thrust actuators are 
significantly bandwidth limited. The axial and normal dynamics can thus be decoupled as 
follows, 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
181 
Axial Dynamics: 
 
1
1
T
T
C
T
T
T
τ
τ
= −
+
⎡
⎤
⎡
⎤
⎣
⎦
⎣
⎦

 
(24) 
 
1
W
A
m T
D m
=
+ −
⎡
⎤
⎡
⎤
⎣
⎦
⎣
⎦ 
(25) 
Normal Dynamics: 
 
0
0
cos
1
E
E
Q
W
E
Q
yy
yy
yy
yy
L
L
g
L
L
mV
mV
mV
V
mV
M
M
M
M
Q
Q
I
I
I
I
δ
α
δ
α
α
α
δ
⎡
⎤
⎡
⎤
Θ
⎡
⎤
−
−
−
−
⎢
⎥
⎢
⎥
⎢
⎥
⎡
⎤
⎡
⎤
⎢
⎥
⎢
⎥
⎢
⎥
=
+
+
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎣
⎦


 
(26) 
 
0
E
Q
W
E
L
L
L
L
C
Q
m
m
m
m
δ
α
α
δ
⎡
⎤
⎡
⎤
⎡
⎤
⎡
⎤
= −
−
+ −
+ −
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦⎣
⎦
⎣
⎦
 
(27) 
where dimensional stability and control derivative notation has been used to remove clutter. 
Finally, notice that the normal dynamics are simply the classical short period mode 
approximation (Etkin & Reid, 1995) but have been shown here to be valid for all point mass 
kinematics states (i.e. all gross attitudes) with the flight path angle coupling term acting as a 
disturbance input. Intuitively this makes sense since the physical phenomena that manifest 
themselves into what is classically referred to as the short period mode are not dependent 
on the gross attitude of the aircraft. Whether an aircraft is flying straight and level, inverted 
or climbing steeply, its short period motion remains unchanged. 
5. Axial specific acceleration controller 
In this section a controller capable of regulating the axial specific acceleration is designed. 
Attention will also be given to the closed loop sensitivity function constraint of equation (23) 
for a specific return disturbance level. With reference to the axial dynamics of equations (24) 
and (25) define the following Proportional-Integrator (PI) control law with enough degrees 
of freedom to allow for arbitrary closed loop pole placement, 
 
c
A
W
E
A
T
K A
K E
= −
−
 
(28) 
 
R
A
W
W
E
A
A
=
−

 
(29) 
where 
R
W
A
 is the reference axial specific acceleration command. The integrator in the 
controller is essential for robustness towards uncertain steady state drag and thrust actuator 
offsets. It is straightforward to show that given the desired closed loop characteristic 
equation, 
 
2
1
0
( )
c s
s
s
α
α
α
=
+
+
 
(30) 
the feedback gains that will fix the closed loop poles are, 
 
(
)
1
1
A
T
K
m τ α
=
−
 
(31) 

 
Advances in Flight Control Systems 
 
182 
 
0
E
T
K
mτ α
=
 
(32) 
These simple, closed form solution gains will ensure an invariant closed loop axial specific 
acceleration dynamic response as desired. The controller design freedom is reduced to that 
of selecting appropriate closed loop poles bearing in mind factors such as actuator 
saturation and the sensitivity function constraint of the previous section. Investigation of the 
closed loop sensitivity function for this particular control law yields the following result, 
 
0
2
0
1
0
1
( )
1
T
D
T
s
s
S
s
s
s
τ
α
τ α
α
α
⎛
⎞
+
= −
⎜
⎟
⎜
⎟
+
+
⎝
⎠
 
(33) 
For actuator saturation reasons the closed loop axial dynamics bandwidth is typically 
limited to being close to that of the open loop thrust actuator and thus for reasonable closed 
loop damping ratios the second order term in parenthesis above can be well approximated 
by a first order model to simplify the sensitivity function as follows, 
 
0
1
( )
1
D
T
A
s
S
s
s
τ α τ
≈−
+
 
(34) 
Here, 
(
)
0
1
A
T
τ
τ α
=
 is the approximating time constant calculated to match the high 
frequency sensitivity function asymptotes. Substituting equation (34) into equation (23) 
yields the return disturbance transfer function, 
 
0
1
( )
2
1
W
W
C
A
LD T
C
S
s
s
VR
τ
τ α
=
+
 
(35) 
Given the maximum allowable gain of the return disturbance transfer function γ , a lower 
bound constraint on the natural frequency (
n
ω ) of the closed loop axial control system is 
calculated by satisfying the inequality 
 
max
2
n
W
T
T
LD
C
VR
ω
τ
ω
γ
⎡
⎤
≥
⎢
⎥
⎣
⎦
 
(36) 
where, 
1
T
T
ω
τ
=
 is the open loop bandwidth of the thrust actuator and the subscript max 
denotes the maximum value of the term in parenthesis. The following example illustrates 
the practical feasibility of adhering to the sensitivity function constraint. Consider a UAV 
that is to fly with a minimum velocity of 20 m/s, with a maximum normal specific 
acceleration of 4 g  and a minimum lift to drag ratio of 10. Then, for more than 20 dB of 
return disturbance rejection, the natural frequency of the closed loop system should have 
the following relationship to the open loop thrust bandwidth, 
 
2
n
T
T
ω
ω
τ
≥
 
(37) 
For this specific example, thrust actuators with a bandwidth of below 4 rad/s (time constant 
of greater than 0.25 s) will require that the closed loop natural frequency is greater than that 
of the thrust actuator. Despite the fairly extreme nature of this example (low velocity 
magnitude, high  acceleration and low lift to drag ratio), thrust time constants on the order 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
183 
of 0.25 s are still practically feasible for UAVs. The deduction is thus that the axial specific 
acceleration controller will be practically applicable to most UAVs. 
6. Normal specific acceleration controller 
This section presents the design and associated analysis of a closed form normal specific 
acceleration controller that yields an invariant dynamic response for all point mass 
kinematics states. The design is based on the linear normal dynamics of equations (26) and 
(27) with the velocity magnitude and air density considered parameters and the flight path 
angle coupling rejected using dynamic inversion. To consider the velocity magnitude and 
air density as parameters requires a timescale separation to exist between these two 
quantities and the normal dynamics. Therefore, it is important to investigate any upper 
limits on the allowable bandwidth of the normal dynamics as this will in turn clamp the 
upper bandwidth of the velocity magnitude and the air density (altitude) dynamics. 
Furthermore, it is important to investigate the eligibility of the normal dynamics for 
effective dynamic inversion of the flight path angle coupling term. Thus, before continuing 
with the normal specific acceleration controller design, the natural normal dynamics are 
analyzed in detail. 
6.1 Natural normal specific acceleration dynamics 
Consider the dynamics from the elevator control input to the normal specific acceleration 
output. The direct feed-through term in the normal specific acceleration output implies that 
the associated transfer function has as many zeros as it does poles. The approximate 
characteristic equation for the poles is easily be shown to be, 
 
2
( )
Q
Q
yy
yy
yy
M
M
L
L
M
p s
s
s
I
I
I
mV
mV
α
α
α
⎛
⎞
⎛
⎞
⎜
⎟
⎜
⎟
=
+
−
−
+
⎜
⎟
⎜
⎟
⎝
⎠
⎝
⎠
 
(38) 
where use has been made of the commonly used simplifying assumption (Etkin & Reid, 
1995), 
 
1
Q
L
mV 
 
(39) 
Considering equation (38) it is important to note that the normal dynamics poles are not 
influenced by the lift due to pitch rate or elevator deflection. The importance of this will be 
made clear later on in this section. The zeros from the elevator input to the normal specific 
acceleration output can be shown, after some manipulation, to be well approximated by the 
roots of the characteristic equation, 
 
(
)
(
)
2
0
Q
T
D
yy
T
N
yy
s
L
l
l
I
s
L
l
l
I
α
−
−
−
−
=
 
(40) 
with the following characteristic lengths defined, 
 
Nl
M
L
α
α
≡−
 
(41) 
 
E
E
Tl
M
L
δ
δ
≡−
 
(42) 

 
Advances in Flight Control Systems 
 
184 
 
D
Q
Q
l
M
L
≡−
 
(43) 
where, 
Nl  is the length to the neutral point, Tl  is the effective length to the tail-plane and 
Dl  
is the effective damping arm length. Note that only the simplifying assumption of equation 
(39) has been used in obtaining the novel characteristic equation for the zeros above. 
Completing the square to find the roots of equation (40) gives, 
 
(
)
(
)
(
)
2
2
2
2
Q
T
D
yy
Q
T
D
yy
T
N
yy
s
L
l
l
I
L
l
l
I
L
l
l
I
α
⎡
⎤
⎡
⎤
−
−
=
−
+
−
⎣
⎦
⎣
⎦
 
(44) 
For most aircraft the effective length to the tail-plane and effective damping arm lengths are 
very similar. This is because most of the damping arises from the tail-plane which is also 
typically home to the elevator control surface. Thus the moment arm lengths for pitch rate 
and elevator deflection induced forces are very similar. As a result, the first term on the 
right hand side of equation (44) is most often negligibly small and to a good approximation, 
the zeros from elevator to normal specific acceleration are, 
 
(
)
(
)
1,2
2
Q
T
D
yy
T
N
yy
z
L
l
l
I
L
l
l
I
α
≈
−
±
−
 
(45) 
Analysis of equation (45) reveals that the only significant effect of the lift due to pitch rate 
derivative on the zeros is that of producing an offset along the real axis. As previously 
argued, the effective tail-plane and damping arm lengths are typically very similar and as a 
result, even this effect is usually small. Thus, it can be seen that to a good approximation, 
the lift due to pitch rate plays no role in determining the elevator to normal specific 
acceleration dynamics. 
On the other hand, the effective length to the tail-plane and the length to the neutral point 
typically differ significantly. With this difference scaled by the lift due to angle of attack 
(which is usually far greater than the lift due to pitch rate) it can be seen that the second 
term in equation (45) will dominate the first in determining the zero positions. Thus al-
though the lift due to elevator deflection played no role in determining the system poles, it 
plays a large role in deter-mining the zeros. Knowing the position of the zeros is important 
from a controller design point of view because not only do they affect the dynamic response 
of the system but they also impose controller independent limitations on the system’s 
practically achievable dynamic response. These limitations are mathematically described by 
Bode’s sensitivity and complementary sensitivity integrals as discussed in (Freudenberg & 
Looze, 1985); (Goodwin et al., 2001). 
Expanding on the above point, it is noted that for most aircraft the effective length to the 
tail-plane is far greater than the length to the neutral point and so the zeros are real and of 
opposite sign. The result, as intuitively expected, is that the dynamics from the elevator to 
normal specific acceleration are NMP since a Right Half Plane (RHP) zero exists. A RHP 
zero places severe, controller independent restrictions on the practically attainable upper 
bandwidth of the closed loop normal specific acceleration dynamics. Furthermore, 
designing a dynamic inversion control law in a system with NMP dynamics, particularly 
when the NMP nature of the system is weak, tends to lead to an impractical solution with 
internal dynamics that may or may not be stable (Hauser et al., 1992); (Hough, 2007). 
Since this NMP dynamics case is by far the most common for aircraft, the limits imposed by it 
shall be investigated further in the following subsection. The goal of the investigation is to seek 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
185 
a set of conditions under which the effects of a RHP zero become negligible, equivalently 
allowing the NMP nature of a system to be ignored. With these conditions identified and 
satisfied, the design of the normal specific acceleration controller can continue based on a set of 
simplified dynamics that do not capture the NMP nature of the system. 
6.2 Analysis of the NMP dynamics case 
Ignoring the typically negligible real axis offset term in equation (45), the transfer function 
from the elevator to normal specific acceleration is of the form, 
 
2
0
2
2
0
( )
2
n
n
n
z
s
G s
k s
s
z
ω
ζω
ω
−
=
+
+
 
(46) 
where 
0z  is the RHP zero position. Note that the effect of the left half plane zero has been 
neglected because it is most often largely negated through pole-zero cancellation by un-
modelled dynamics such as those introduced through servo lag. The transfer function of 
equation (46) can be written as follows, 
 
0
( )
( )
( )
n
n
G s
G s
G s s z
=
−
 
(47) 
where, 
 
2
2
2
( )
2
n
n
n
n
G s
k s
s
ω
ζω
ω
=
+
+
 
(48) 
is a nominal second order system with no zeros. Equation (48) makes it clear that as the 
position of the zero tends towards infinity, so the total system transfer function converges 
towards 
( )
n
G s . The purpose of the analysis to follow is to investigate more precisely, the 
conditions under which 
( )
G s  can be well approximated by 
( )
n
G s . To this end, a time 
response analysis method is employed. Consider the Laplace transform of the system’s step 
response, 
 
0
( )
( )
( )
n
n
Y s
G s
s
G s
z
=
−
 
(49) 
 
Equation (49) makes it clear that the total step response is the nominal system step response 
less the impulse response of the system scaled by the inverse of the RHP zero frequency. 
Since the nominal response gradient is always zero at the time of the step, the system must 
exhibit undershoot. The level of undershoot will depend of the damping, speed of response 
of the system and the zero frequency. If the level of undershoot is small relative to unity 
then it is equivalent to saying that the second term of equation (47) has a negligible effect. 
Thus, by investigating the undershoot further, conditions can be developed under which the 
total system response is well approximated by the nominal system response. 
A closed form solution for the exact level of undershoot experienced in response to a step 
command for a system of the form presented in equation (46) is provided below, 
 
(
)
(
) tan
min
1
sin
sin
y
k
e
θ φ
θ
θ
φ
−
−
⎡
⎤
=
−
⎣
⎦ 
(50) 
where, 

 
Advances in Flight Control Systems 
 
186 
 
( )
1
cos
θ
ζ
−
=
 
(51) 
 
(
)
(
)
1
2
tan
1
r
φ
ζ
ζ
−
=
−
+
 
(52) 
 
0
n
r
z
ω
=
 
(53) 
Derivation of this novel result involves inverse Laplace transforming equation (49) and 
finding the time response minima through calculus. The above equations make it clear that 
the undershoot is only a function of the ratio between the system’s natural frequency and 
the zero frequency ( r ) and the system’s damping ratio (ζ ). Figure 2 below provides a plot 
of the maximum percentage undershoot as a function of 
1
r− for various damping ratios. 
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
10
20
30
40
50
60
70
80
90
100
RHP zero frequency normalised to the natural frequency
Maximum percentage undershoot
 
 
ζ = 0.7
ζ = 0.5
ζ = 0.2
 
Fig. 2. Maximum undershoot of a 2nd order system as a function of normalized RHP zero 
frequency for various damping ratios. 
It is clear from Figure 2 that for low percentage undershoots, the damping ratio has little 
influence. Thus, the primary factor determining the level of undershoot is the ratio of the 
system’s natural frequency to that of the zero frequency. Furthermore, it is clear that for less 
than 5% maximum undershoot, the natural frequency should be at least three times lower 
than that of the zero. With only 5% undershoot the response of the total system will be well 
approximated by the response of the nominal system with no zero. Thus by making use of 
the maximum undershoot as a measure of the NMP nature of a system the following novel 
frequency domain design rule is developed, 
 
0 3
n
z
ω <
 
(54) 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
187 
for the NMP nature of the system to be considered negligible. This rule implies that the 
system poles must lie within a circle of radius 
0 3
z
 in the s-plane. Thus, an upper bound is 
placed on the natural frequency of the system if its NMP nature is to be ignored. 
6.3 Frequency bounds on the normal specific acceleration controller 
Given the results of the previous two subsections, the upper bound on the natural frequency 
of the normal specific acceleration controller becomes, 
 
(
)
3
n
T
N
yy
L
l
l
I
α
ω <
−
 
(55) 
where the typically negligible offset in the zero positions in equation (45) has been ignored. 
Adhering to this upper bound will allow the NMP nature of the system to be ignored and 
will thus ensure both practically feasible dynamic inversion of the flight path angle coupling 
and no large sensitivity function peaks (Goodwin et al., 2001) in the closed loop system. 
Note that given the physical meaning of the characteristic lengths defined in equations (41) 
through (43), the approximate zero positions and thus upper frequency bound can easily be 
determined by hand for a specific aircraft. 
It is important to note that the upper bound applies to both the open loop and closed loop 
normal specific acceleration dynamics. If the open loop poles violate the condition of 
equation (55) then moving them through control application to within the acceptable 
frequency region will require taking into account the effect of the system zeros. Thus, for an 
aircraft to be eligible for the normal specific acceleration controller of the next subsection, its 
open loop normal dynamics poles must at least satisfy the bound of equation (55). If they do 
not then an aircraft specific normal specific acceleration controller would have to be 
designed. However, most aircraft tend to satisfy this bound in the open loop because open 
loop poles outside the frequency bound of equation (55) would yield an aircraft with poor 
natural flying qualities i.e. the aircraft would be too statically stable and display significant 
undershoot and lag when performing elevator based manoeuvres. Interestingly, the 
frequency bound can thus also be utilized as a design rule for determining the most forward 
centre of mass position of an aircraft for good handling qualities. 
In term of lower bounds, the normal dynamics must be timescale separated from the 
velocity magnitude and air density (altitude) dynamics. Of these two signals, the velocity 
magnitude typically has the highest bandwidth and is thus considered the limiting factor. 
Given the desired velocity magnitude bandwidth (where it is assumed here that the given 
bandwidth is achievable with the available axial actuator), then as a practical design rule the 
normal dynamics bandwidth should be at least five times greater than this for sufficient 
timescale separation. Note that unlike in the upper bound case, only the closed loop poles 
need satisfy the lower bound constraint. However, if the open loop poles are particularly 
slow, then it will require a large amount of control effort to meet the lower bound constraint 
in the closed loop. This may result in actuator saturation and thus a practically infeasible 
controller. However, for typical aircraft parameters the open loop poles tend to already 
satisfy the timescale separation lower bound. 
With the timescale separation lower bound and the NMP zero upper bound, the natural 
frequency of the normal specific acceleration controller is constrained to lying within a 
circular band in the s-plane as shown in Figure 3 (poles would obviously not be selected in 
the RHP for stability reasons). The width of the circular band in Figure 3 is an indication of 

 
Advances in Flight Control Systems 
 
188 
the eligibility of a particular airframe for the application of the normal specific acceleration 
controller to be designed in the following subsection. 
For most aircraft this band is acceptably wide and the control system to be presented can be 
directly applied. For less conventional aircraft, the band can become very narrow and the 
two constraint boundaries may even cross. In this case, the generic control system to be 
presented cannot be directly applied. One solution to this problem is to design an aircraft 
specific normal specific acceleration controller. However, this solution is typically not 
desirable since the closeness of the bounds suggests that the desired performance of the 
particular airframe will not easily be achieved practically. Instead, redesign of the airframe 
and/or reconsideration of the outer loop performance bandwidths will constitute a more 
practical solution. 
s-plane
Timescale separation
lower bound
NMP upper bound
Feasible pole
placement region
Re(s)
Im(s)
 
Fig. 3. NMP upper bound and timescale separation lower bound outlining feasible pole 
placement region. 
6.4 Normal specific acceleration controller design 
Assuming that the frequency bounds of the previous section are met, the design of a 
practically feasible normal specific acceleration controller can proceed based on the 
following reduced normal dynamics, 
 
0
0
cos
0
1
E
W
E
Q
yy
yy
yy
yy
L
g
L
mV
V
mV
M
M
M
M
Q
Q
I
I
I
I
α
δ
α
α
α
δ
⎡
⎤
Θ
⎡
⎤
⎡
⎤
−
−
⎢
⎥
⎢
⎥
⎡
⎤
⎡
⎤
⎢
⎥
⎢
⎥
⎢
⎥
=
+
+
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎣
⎦


 
(56) 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
189 
 
0
0
0
W
E
L
L
C
Q
m
m
α
α
δ
⎡
⎤
⎡
⎤
⎡
⎤
= −
+
+ −
⎡⎤
⎢
⎥
⎣⎦
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎣
⎦
 
(57) 
The simplifications in the dynamics above arise from the analysis of subsection 6.1 where it 
was shown that to a good approximation, the lift due to pitch rate and elevator deflection 
only play a role in determining the zeros from elevator to normal specific acceleration. 
Under the assumption that the upper bound of equation (55) is satisfied, the zeros 
effectively move to infinity and correspondingly these two terms become zero. Thus, the 
simplified normal dynamics above will yield identical approximated poles to those of 
equation (38), but will display no finite zeros from elevator to normal specific acceleration. 
To dynamically invert the effect of the flight path angle coupling on the normal specific 
acceleration dynamics requires differentiating the output of interest until the control input 
appears in the same equation. The control can then be used to directly cancel the 
undesirable terms. Differentiating the normal specific acceleration output of equation (57) 
once with respect to time yields, 
 
cos
W
W
W
L g
L
L
C
C
Q
m
mV
mV
α
α
α
Θ
⎡
⎤
⎡
⎤
⎡
⎤
= −
+ −
+ −
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎣
⎦

 
(58) 
where the angle of attack dynamics of equation (6) have been used in the result above. 
Differentiating the normal specific acceleration a second time gives, 
 
0
0
cos
sin
E
Q
Q
W
W
W
yy
yy
yy
Q
E
W
W
W
yy
yy
yy
yy
M
L M
L
M
C
C
C
I
I
mV
mVI
L M
M
L g
L M
L M
mI
mI
mI
I
mV
α
α
α
α
δ
α
α
α
δ
⎡
⎤
⎡
⎤
=
−
+
+
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎡
⎤
⎡
⎤
⎡
⎤
⎛
⎞
⎢
⎥
⎜
⎟
+ −
+
−
+
Θ
+ Θ
Θ
⎢
⎥
⎢
⎥
⎜
⎟
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎝
⎠
⎣
⎦



 
(59) 
where use has been made of equations (56) to (58) in obtaining the result above. The elevator 
control input could now be used to cancel the effect of the flight path angle coupling terms 
on the normal specific acceleration dynamics. However, the output feedback control law to 
be implemented will make use of pitch rate feedback. Upon analysis of equation (6), it is 
clear that pitch rate feedback will reintroduce flight path angle coupling terms into the 
normal specific acceleration dynamics. Thus, the feedback control law is first defined and 
substituted into the dynamics, and then the dynamic inversion is carried out. A PI control 
law with enough degrees of freedom to place the closed loop poles arbitrarily and allow for 
dynamic inversion (through 
DI
E
δ
) is defined below, 
 
DI
E
Q
C
W
E
C
E
K Q
K C
K E
δ
δ
= −
−
−
+
 
(60) 
 
R
C
W
W
E
C
C
=
−

 
(61) 
with 
R
W
C
 the reference normal specific acceleration command. The integral action of the 
control law is introduced to ensure that the normal specific acceleration is robustly tracked 
with zero steady state error. Offset disturbance terms such as those due to static lift and 
pitching moment can thus be ignored in the design to follow. It is best to remove the effect 

 
Advances in Flight Control Systems 
 
190 
of terms such as these with integral control since they are not typically known to a high 
degree of accuracy and thus cannot practically be inverted along with the flight path angle 
coupling. Upon substitution of the control law above into the normal specific acceleration 
dynamics of equation (59), the closed loop normal dynamics become, 
 
E
E
E
E
Q
W
E
C
Q
W
yy
yy
yy
Q
C
Q
W
yy
yy
yy
yy
L M
M
M
L
C
K
E
K
C
mI
I
I
mV
L M
L M
L M
M
K
K
C
I
mI
mVI
mVI
α
δ
δ
α
α
δ
α
δ
α
α
⎡
⎤
⎡
⎤
=
+
−
−
⎢
⎥
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
⎡
⎤
+
+
+
−
⎢
⎥
⎢
⎥
⎣
⎦


 
(62) 
 
R
C
W
W
E
C
C
=
−

 
(63) 
when, 
 
cos
sin
DI
E
E
yy
Q
E
Q
W
W
W
I
M
g
K
M
M
V
δ
δ
δ
⎡
⎤
⎛
⎞
⎛
⎞
⎢
⎥
=
⎜
−
⎟
Θ
+ ⎜
Θ
⎟
Θ
⎜
⎟
⎜
⎟
⎢
⎥
⎝
⎠
⎝
⎠
⎣
⎦

 
(64) 
and the static offset terms are ignored. Note that the dynamic inversion part of the control 
law is still a function of the yet to be determined pitch rate feedback gain. Given the desired 
closed loop characteristic equation for the normal dynamics, 
 
( )
3
2
2
1
0
c s
s
s
s
α
α
α
α
=
+
+
+
 
(65) 
the closed form solution feedback gains can be calculated by matching characteristic 
equation coefficients to yield, 
 
2
E
yy
Q
Q
yy
I
M
L
K
M
I
mV
α
δ
α
⎛
⎞
⎜
⎟
=
+
−
⎜
⎟
⎝
⎠
 
(66) 
 
1
2
E
yy
C
yy
mI
M
L
L
K
L M
I
mV
mV
α
α
α
α
δ
α
α
⎛
⎞
⎛
⎞
⎜
⎟
= −
+
−
−
⎜
⎟
⎜
⎟
⎝
⎠
⎝
⎠
 
(67) 
 
0
E
yy
E
mI
K
L M
α
δ
α
= −
 
(68) 
Substituting the pitch rate feedback gain into equation (64) gives, 
 
2
cos
cos
sin
DI
E
yy
W
W
E
W
W
I
g
C
g
L
M
V
mV
V
α
δ
δ
α
⎡
⎤
+
Θ
⎛
⎞
⎛
⎞
=
−
Θ
−
Θ
⎢
⎥
⎜
⎟
⎜
⎟
⎝
⎠
⎝
⎠
⎣
⎦
 
(69) 
where use has been made of equation (1) to remove the flight path angle derivative. The 
controller design freedom is reduced to that of placing the three poles that govern the closed 
loop normal dynamics. The control system will work to keep these poles fixed for all point 
mass kinematics states and in so doing yield a dynamically invariant normal specific 
acceleration response at all times. 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
191 
7. Simulation 
To verify the controller designs of the previous subsections, they are applied to an off-the-
shelf scale model aerobatic aircraft, the 0.90 size CAP232, used for research purposes at 
Stellenbosch University. In the simulations and analysis to follow, the aircraft is operated 
about a nominal velocity magnitude of 30 m/s and a nominal sea level air density of 1.225 
kg/m3. The modelling parameters for the aircraft are listed in the table below and were 
obtained from (Hough, 2007). 
 
5.0 kg
m =
 
5.97
A =
 
0
0.0
L
C
=
 
0
0.0
m
C
=
 
2
0.36 kgm
yy
I
=
 
0.25 s
T
τ
=
 
5.1309
L
C
α =
 
0.2954
m
C
α = −
 
0.30 m
c =
 
0.85
e =
 
7.7330
Q
L
C
=
 
10.281
Q
m
C
= −
 
2
0.50 m
S =
 
0
0.02
D
C
=
 
0.7126
E
L
C
δ =
 
1.5852
E
m
C
δ = −
 
Table 1. Model parameters for the Stellenbosch University aerobatic UAV 
Given that the scenario described in the example at the end of section 5 applies to the aerobatic 
UAV in question, the closed loop natural frequency of the axial specific acceleration controller 
should be greater than or equal to the bandwidth of the thrust actuator (4 rad/s) for a return 
disturbance of -20 dB. Selecting the closed loop poles at {-4±3i}, provides a small buffer for 
uncertainty in the actuator lag, without overstressing the thrust actuator. Figure 4 provides a 
Bode plot of the actual and approximated return disturbance transfer functions for this design, 
i.e. equation (23), with the actual and approximated sensitivity functions of equations (33) and 
(34) substituted respectively. Also plotted are the actual and approximated sensitivity 
functions themselves as well as the term in parenthesis in equation (23), i.e. the normalized 
drag to normalized velocity perturbation transfer function. Figure 4 clearly illustrates the 
greater than 20 dB of return disturbance rejection obtained over the entire frequency band due 
to the appropriate selection of the closed loop poles. The figure also shows how the return 
disturbance rejection is contributed towards by the controller at low frequencies and the 
natural velocity magnitude dynamics at high frequencies. The plot thus verifies the 
mathematics of the decoupling analysis done in section 4. 
Open loop analysis of the aircraft’s normal dynamics reveals the actual and approximated 
poles (shown as crosses) in Figure 5 and the actual and approximated elevator to normal 
specific acceleration zeros of {54.7, -46.7} and {54.5, -46.6} respectively. The closeness of the 
poles in Figure 5 and the similarity of the numerical values above verify equations (38) and 
(40). The approximate zero positions are used in equation (55) to determine the upper NMP 
frequency bound shown in Figure 5. The lower timescale separation bound arises as a result 
of a desired velocity magnitude bandwidth of 1 rad/s (a feasible user selected value). Notice 
both the large feasible pole placement region and the fact that the open loop poles naturally 
satisfy the NMP frequency constraint, implying good open loop handling qualities. 
The controller of subsection 6.4 is then applied to the system with desired closed loop 
complex poles selected to have a constant damping ratio of 0.7 as shown in Figure 5. The 
desired closed loop real pole is selected equal to the real value of the complex poles. The 
corresponding actual closed loop poles are illustrated in Figure 5. Importantly, the locus of 
actual closed loop poles is seen to remain similar to that of the desired poles while the upper 
NMP frequency bound is adhered to. Outside the bound the actual poles are seen to diverge 
quickly from the desired values. 

 
Advances in Flight Control Systems 
 
192 
10
-1
10
0
10
1
10
2
-50
-40
-30
-20
-10
0
10
20
Magnitude (dB)
 
 
Frequency  (rad/sec)
Actual sensitivity function
Approximated sensitivity function
Normalised drag to velocity transfer
Actual return disturbance
Approximated return disturbance
 
Fig. 4. NMP upper bound and timescale separation lower bound outlining feasible pole 
placement region. 
-20
-10
0
10
20
-20
-15
-10
-5
0
5
10
15
20
 
 
Real Axis [rad/s]
Imaginary Axis [rad/s]
Desired CL Poles
Actual CL Poles
Frequency Bounds
 
Fig. 5. Actual and approximated open loop (CL) poles, actual and desired closed loop poles 
and upper and lower frequency bounds. 
The controller of subsection 6.4 is then applied to the system with desired closed loop 
complex poles selected to have a constant damping ratio of 0.7 as shown in Figure 5. The 
desired closed loop real pole is selected equal to the real value of the complex poles. The 
corresponding actual closed loop poles are illustrated in Figure 5. Importantly, the locus of 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
193 
actual closed loop poles is seen to remain similar to that of the desired poles while the upper 
NMP frequency bound is adhered to. Outside the bound the actual poles are seen to diverge 
quickly from the desired values. 
Figure 6 shows the corresponding feedback gains plotted as a function of the RHP zero 
position normalized to the desired natural frequency (
1
r−). The feedback gains are 
normalized such that their maximum value shown is unity. Again, it is clear from the plot 
that the feedback gains start to grow very quickly, and consequently start to become 
impractical, when the RHP zero is less than 3 times the desired natural frequency. The 
results of Figures 5 and 6 verify the design and analysis of section 6. 
Given the analysis above, the desired normal specific acceleration closed loop poles are 
selected at {-10±8i, -10}. The desired closed loop natural frequency is selected close to that of 
the open loop system in an attempt to avoid excessive control effort. With the axial and 
normal specific acceleration controllers designed, a simulation based on the full, nonlinear 
dynamics of section 3 was set up to test the controllers. Figure 7 provides the simulation 
results. 
The top two plots on the left hand side of the figure show the commanded (solid black line), 
actual (solid blue line) and expected/desired (dashed red line) axial and normal specific 
acceleration signals during the simulation. The normal specific acceleration was switched 
between -1 and -2  g ’s (negative sign implies ‘pull up’ acceleration) during the simulation 
while the axial specific acceleration was set to ensure the velocity magnitude remained 
within acceptable bounds at all times. 
2
4
6
8
10
12
-1
-0.5
0
0.5
1
RHP zero frequency normalised to the natural frequency
Normalised feedback gains
 
 
KQ
KC
KE
 
Fig. 6. Normalized controller feedback gains as a function of the RHP zero position 
normalized to the desired natural frequency. 
Importantly, note how the axial and normal specific acceleration remain regulated as 
expected regardless of the velocity magnitude and flight path angle, the latter of which 
varies dramatically over the course of the simulation. As desired, the specific acceleration 
controllers are seen to regulate their respective states independently of the aircraft’s velocity 

 
Advances in Flight Control Systems 
 
194 
magnitude and gross attitude. The angle of attack, pitch rate, elevator deflection and 
normalized thrust command are shown on the right hand side of the figure. The angle of 
attack remains within pre-stall bounds and the control signals are seen to be practically 
feasible.  
Successful practical results of the controllers operating on the aerobatic research aircraft and 
other research aircraft at Stellenbosch University have recently been obtained. These results 
will be made available in future publications. 
0
2
4
6
8
10
-0.5
0
0.5
1
AW - [g's]
0
2
4
6
8
10
-2
-1
CW - [g's]
0
2
4
6
8
10
20
30
40
V - [m/s]
0
2
4
6
8
10
-100
0
100
200
300
Time - [s]
θW - [deg]
0
2
4
6
8
10
0
4
8
α - [deg]
0
2
4
6
8
10
-50
0
50
100
Q - [deg/s]
0
2
4
6
8
10
-4
-2
0
δE - [deg]
0
2
4
6
8
10
0
0.5
1
Time - [s]
TC/mg - [g's]
 
Fig. 7. Simulation results illustrating gross attitude independent regulation of the axial and 
normal specific acceleration. 
8. Conclusion and future work 
An acceleration based control strategy for the design of a manoeuvre autopilot capable of 
guiding an aircraft through the full 3D flight envelope was presented. The core of the 
strategy involved the design of dynamically invariant, gross attitude independent specific 
acceleration controllers. Adoption of the control strategy was argued to provide a practically 
feasible, robust and effective solution to the 3D manoeuvre flight control problem and the 
non-iterative nature of the controllers provides for a computationally efficient solution. 
The analysis and design of the specific acceleration controllers for the case where the 
aircraft’s flight was constrained to the 2D vertical plane was presented in detail. The aircraft 
dynamics were shown to split into aircraft specific rigid body rotational dynamics and 
aircraft independent point mass kinematics. With a timescale separation and a dynamic 
inversion condition in place the rigid body rotational dynamics were shown to be 
dynamically independent of the point mass kinematics, and so provided a mathematical 
foundation for the design of the gross attitude independent specific acceleration controllers. 
Under further mild conditions and a sensitivity function constraint the rigid body rotational 
www.ebook3000.com

Acceleration-based 3D Flight Control for UAVs: Strategy and Longitudinal Design   
 
195 
dynamics were shown to be linear and decouple into axial and normal dynamics. The 
normal dynamics were seen to correspond to the classical Short Period mode approximation 
dynamics and illustrated the gross attitude independent nature of this mode of motion. 
Feedback based, closed form pole placement control solutions were derived to regulate both 
the axial and normal specific accelerations with invariant dynamic responses. Before 
commencing with the design of the normal specific acceleration controller, the elevator to 
normal specific acceleration dynamics were investigated in detail. Analysis of these 
dynamics yielded a novel approximating equation for the location of the zeros and revealed 
the typically NMP nature of this system. Based on a time domain analysis a novel upper 
frequency bound condition was developed to allow the NMP nature of the system to be 
ignored, thus allowing practically feasible dynamic inversion of the flight path angle 
coupling. 
Analysis and simulation results using example data verified the functionality of the specific 
acceleration controllers and validated the assumptions upon which their designs were 
based. Future research will involve extending the detailed control system design to the full 
3D flight envelope case based on the autopilot design strategy presented in section 2. 
Intelligent selection of the closed loop poles will also be the subject of further research. 
Possibilities include placing the closed loop poles for maximum robustness to parameter 
uncertainty as well as scheduling the closed loop poles with flight condition to avoid 
violation of the NMP frequency bound constraint.  
9. References 
Al-Hiddabi,  S.A. & McClamroch, N.H. (2002). Aggressive longitudinal aircraft trajectory 
tracking using nonlinear control. Journal of Guidance, Control and Dynamics, Vol. 25, 
No. 1, January 2002, pp. 26–32, ISSN 07315090. 
Bhattacharya, R.; Balas, G.J.; Kaya, M.A. & Packard, A (2002). Nonlinear receding horizon 
control of an F-16 aircraft. Journal of Guidance, Control and Dynamics, Vol. 25, No. 5, 
September 2002, pp. 924–931, ISSN 07315090. 
Blakelock, J.H. (1991). Automatic Control of Aircraft and Missiles (2nd Ed.), John Wiley and 
Sons, ISBN 0471506516, New York. 
Buffington, J.; Adams, R. & Banda, S. (1993). Robust, nonlinear, high angle-of-attack control 
design for a super-manoeuvrable vehicle, Proceedings of the AIAA Guidance, 
Navigation and Control Conference, pp. 690–700, Monterey, August 1993. 
Bugajski, D.J. & Enns, D.F. (1992). Nonlinear control law with application to high angle-of-
attack flight. Journal of Guidance, Control and Dynamics, Vol. 15, No. 3, May 1992, pp. 
761–767, ISSN 07315090. 
Etkin, B. (1972). Dynamics of Atmospheric Flight, John Wiley and Sons, ISBN-10 0471246204, 
New York. 
Etkin, B. & Reid, L.D. (1995). Dynamics of Flight Stability and Control (3rd Ed.), John Wiley and 
Sons, ISBN 0471034185, New York. 
Freudenberg, J.S. & Looze, D.P. (1985). Right-half plane poles and zeros and design tradeoffs 
in feedback systems. IEEE Transactions on Automatic Control, Vol. 30, No. 6, June 
1985, pp. 555-565, ISSN 00189286. 
Goodwin, G.C.; Graebe, S.F. & Salgado, M.E. (2001). Control System Design, Prentice Hall, 
ISBN-10 0139586539, Upper Saddle River. 

 
Advances in Flight Control Systems 
 
196 
Hauser, J.; Sastry, S. & Meyer, G. (1992). Nonlinear control design for slightly non-minimum 
phase systems: Application to V/STOL aircraft. Automatica, Vol. 28, No. 4, April 
1992, pp. 665–679, ISSN 00051098. 
Hough, W.J. (2007). Autonomous Aerobatic Flight of a Fixed Wing Unmanned Aerial Vehicle, 
Masters thesis, Stellenbosch University. 
Kim, M.J.; Kwon, W.H.; Kim, Y.H. & Song, C. (1997). Autopilot design for bank-to-turn 
missiles using receding horizon predictive control scheme. Journal of Guidance, 
Control and Dynamics, Vol. 20, No. 6, November 1997, pp. 1248–1254, ISSN 
07315090. 
Lane, S.H. & Stengel, R.F. (1988). Flight control design using non-linear inverse dynamics. 
Automatica, Vol. 24, No. 4, April 1988, pp. 471–483, ISSN 00051098. 
Leith, D.J. & Leithead, W.E. (2000). Survey of gain scheduling analysis & design, 
International Journal of Control, Vol. 73, No. 11, July 2000, pp. 1001-1025, ISSN 
00207179. 
Miller, R.B. & Pachter, M. (1997). Manoeuvring flight control with actuator constraints. 
Journal of Guidance, Control and Dynamics, Vol. 20, No. 4, July 1997, pp. 729–734, 
ISSN 07315090. 
Pachter, M.; Chandler P.R. & Smith, L. (1998). Manoeuvring flight control. Journal of 
Guidance, Control and Dynamics, Vol. 21, No. 3, May 1998, pp. 368–374, ISSN 
07315090. 
Peddle, I.K. (2008). Acceleration Based Manoeuvre Flight Control System for Unmanned Aerial 
Vehicles, PhD thesis, Stellenbosch University. 
Reiner, J.; Balas, G.J. & Garrard, W.L. (1996). Flight control design using robust dynamic 
inversion and time-scale separation. Automatica, Vol. 32, No. 11, November 1996, 
pp. 1493–1504, ISSN 00051098. 
Slotine, J.E. & Li, W. (1991). Applied Nonlinear Control, Prentice Hall, ISBN-10 0130408905, 
Upper Saddle River. 
Snell, S.A.; Enns, D.F. & Garrard, W.L. (1992). Nonlinear inversion flight control for a super-
manoeuvrable aircraft. Journal of Guidance, Control and Dynamics, Vol. 15, No. 4, July 
1992, pp. 976–984, ISSN 07315090. 
www.ebook3000.com

Atsushi Fujimori
University of Yamanashi
Japan
1. Introduction
Recently, unmanned aerial vehicles (UAVs) have been developed for the purposes of scientiﬁc
observations, detecting disasters, surveillance of trafﬁc and army objectives (Wilson, 2007;
Langelaan & Rock, 2005; Cho et al., 2005). This paper presents an autonomous ﬂight control
design to give insights for developing helicopter-type UAVs.
A Helicopter is generally an unstable aircraft. Once it is stalled, it is not easy to recover
its attitude. A control system is therefore needed to keep the vehicle stable during ﬂight
(Bramwell, 1976; Padﬁeld, 1996; Johnson & Kannan, 2005). This paper presents a ﬂight
control design for the longitudinal motion of helicopter to establish autopilot techniques of
helicopters. The ﬂight mission considered in this paper is that a helicopter hovers at a start
position, moves to a goal position with keeping a speciﬁed cruise velocity and hovers again at
the goal. The characteristics of the linearized equation of the helicopter is changed during this
ﬂight mission because the trim values of the equation are widely varied. Gain scheduling (GS)
is one of candidates to stabilize the vehicle for the entire ﬂight region. In this paper, a ﬂight
control system is designed as follows. The ﬂight control system is constructed as a double
loop control system (Fujimori et al., 1999; Fujimori et al., 2002) which consists of an inner-loop
controller and an outer-loop controller. The former is needed for stabilizing the controlled
plant, while the latter is used for tracking the reference which is given to accomplish the
ﬂight mission. To design the inner-loop controller, the longitudinal motion of a helicopter is
ﬁrst modeled by a linear interpolative polytopic model whose varying parameter is the ﬂight
velocity. A GS state feedback law is then designed by linear matrix inequality (LMI) (Boyd
et al., 1994; Fujimori et al., 2007) so as to stabilize the polytopic model for the entire ﬂight
region. On the other hand, the outer-loop controller is designed by taking into consideration
the steady-state of the controlled variable.
The rest of this paper is organized as follows. Section 2 shows equations of the longitudinal
motion of helicopter. Section 3 gives a ﬂight mission and shows a double loop control system
adopted in this paper. The details of the controller designs are presented in Section 4. Section
5 shows computer simulation in Matlab/Simulink to evaluate the proposed ﬂight control
system. Concluding remarks are given in Section 6.
 
Autonomous Flight Control System 
for Longitudinal Motion of a Helicopter 
10

tip path plane
horizontal plane
control plane
x
z
V
u
w
−θ
ε
−θ
V
αd
θc
x
a1
αc
Fig. 1. Helicopter in forward ﬂight
2. Equation of longitudinal motion of helicopter
Figure 1 shows a helicopter considered in this paper. The angular velocity of the main rotor
is Ω. The main rotor produces the thrust T which is needed for not only lifting the vehicle
against the gravity but also moving transitionally and rotationally. It depends on the tilting
angle of the control plane.
(x, y, z) represent the body-ﬁxed-axes whose origin is located at the center of gravity of the
vehicle. The forward velocity is V whose x- and z-axes elements are u and w, respectively.
The longitudinal motion of helicopter consists of the transitional motion with respect to x-
and z-axes and the rotational motion around y-axis; that is, the pitch angle denoted as θ and
its derivative q(= ˙θ). It is represented as the following equations (Bramwell, 1976; Padﬁeld,
1996):
m( ˙u + qw) = X −mg sin θ
(1)
m( ˙w −qu) = Z + mg cos θ
(2)
Iyy ˙q = M
(3)
where m and Iyy are respectively the mass and the moment of inertia of the vehicle. g is the
gravity acceleration. The external forces X, Z and the moment M are given by
X = T sin(θc −a1) −D cos ε
(4)
Z = −T cos(θc −a1) −D sin ε
(5)
M = −ThR sin(θc −a1)
(6)
where ε is deﬁned as ε tan. θc is the cyclic pitch angle which is one of the control inputs for
the longitudinal motion of the helicopter. a1 is the angle between the control plane and the tip
path plane. hR is the distance of the hub from the center of gravity. D is the drag of the vehicle
and is given by
D = 1
2ρV2SCD
(7)
198
Advances in Flight Control Systems
www.ebook3000.com

where ρ is the atmospheric density, S the representative area and CD the drag coefﬁcient. The
thrust T can be calculated by integrating the lift over the whole blade. This results in the
following expression for the thrust coefﬁcient:
CT
△=
T
ρ(ΩR)2πR2 = Nc
4πR Clα{(2
3 + μ2)θ0 −λc −λi}
(8)
where
μ
△=
V
ΩR cos αc,
λc
△=
V
ΩR sin αc,
λi
△=
vi
ΩR
(9)
αc
△= θc −ε
(10)
R is the radius of the rotor blades, c the chord length, N the number of the blades and Clα the
lift slope of the blades. vi is the induced velocity through the rotor. θ0 is the collective pitch
angle which is another control input. According to Van Hoydonck (2003), the dimensionless
induced velocity λi through the rotor is approximated by
τ ˙λi = CT −CTGl
(11)
where CTGl is the thrust coefﬁcient which is given by Glauert’s hypotheses. τ is a time constant
of λi.
Summarizing the above equations, deﬁne the state and the input vectors as
xp
△= [u w q θ λi]T ∈ℜ5,
up
△= [θ0 θc]T ∈ℜ2.
(12)
The equation of the longitudinal motion of the helicopter is then written as
˙xp = fp(xp, up).
(13)
Equation (13) is referred as the nonlinear plant Pnl hereafter.
Letting xe and he be horizontal and the vertical positions of the helicopter from the start, they
are given by
˙xe = u cos θ + w sin θ
(14)
˙he = u sin θ −w cos θ.
(15)
Deﬁning ξp as ξp
△= [xe he]T, they are compactly given as
˙ξp = gp(xp).
(16)
In this paper, numerical values of the Eurocopter Deutschland Bo105 (Padﬁeld, 1996) were
used in simulation. They are listed in Table 1. Since this paper considers hovering and forward
ﬂight, the trim condition is given in level ﬂight. Letting ¯xp and ¯up be the state and the input
in trim, respectively, f ( ¯xp, ¯up) = 0 holds. Figure 2 shows variations of ¯xp and ¯up with respect
to the ﬂight velocity V. It is seen that all trim values are changed in the range of V ∈[0, 60]
[m/s].
199
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

0
20
40
60
0
20
40
60
u [m/s]
0
20
40
60
−10
−8
−6
−4
−2
0
w [m/s]
0
20
40
60
−10
−8
−6
−4
−2
0
θ  [deg]
V [m/s]
0
20
40
60
0
0.02
0.04
0.06
λi
V [m/s]
(a) States in trim ¯xp
0
20
40
60
6
7
8
9
10
θ0 [deg]
V [m/s]
0
20
40
60
0
1
2
3
4
5
θc [deg]
V [m/s]
(b) Inputs in trim ¯up
Fig. 2. Trim values with respect to forward velocity V
200
Advances in Flight Control Systems
www.ebook3000.com

parameter value
unit
Clα
6.113 [1/rad]
c
0.27
[m]
m
2200
[kg]
Ibl
231.7 [kgm2]
Iyy
4973.0 [kgm2]
R
4.91
[m]
Ω
44.4
[rad/s]
N
4
[-]
CDS
1.5
[m2]
hR
1.48
[m]
Table 1. Parameters of Bo105 (Padﬁeld, 1996)
Vc1
0
tc1
tc3
tc2
tc4
t
Vc2
Vr
tc5
Fig. 3. Flight velocity proﬁle Vr
3. Construction of ﬂight control system
Let the start position be the origin of the coordinates (xe, he). A ﬂight mission considered in
this paper is to navigate the helicopter from the start (0,0) to the goal, denoted as (xr, hr),
with keeping its attitude stable. To design a control system, the followings are assumed to be
satisﬁed:
(i) The motion in y-axis direction is not taken into account.
(ii) xp is measurable.
(iii) The trim values ¯xp and ¯up are known in advance.
To realize the ﬂight mission, this paper constructs a tracking control system whose controlled
variable is the ﬂight velocity. The ﬂight region is divided into six phases with respect to the
ﬂight velocity as shown in Fig. 3. They are referred as follows.
201
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

    
Pnl
[E -F]
Kout
Kp
gp
Kin
zp
up
v
zr
ξp
ξr
xp
+
-
-
+
+
+
Fig. 4. Flight control system
0 ≤t < tc1 :
initial hovering phase
tc1 ≤t < tc2 : acceleration phase
tc2 ≤t < tc3 : cruise phase
tc3 ≤t < tc4 : deceleration phase
tc4 ≤t < tc5 : low speed phase
tc5 ≤t :
approach phase
From the initial hovering phase to the low speed phase, the reference of the ﬂight velocity
is given by Vr shown in Fig. 3. In this paper, the total time of the ﬂight is not cared. But the
integrated value of Vr for t ∈[0, tc5] must be less than xr not to overtake the goal before the
approach phase. In the approach phase, the reference is generated to meet the position of the
helicopter ξp = [xe he]T with the goal ξr = [xr hr]T.
Taking into consideration the above, a double loop control system (Fujimori et al., 1999;
Fujimori et al., 2002) is used as a ﬂight control system in this paper. It is shown in Fig. 4. Pnl
represents the nonlinear helicopter dynamics given by Eq. (13), Kin is the inner-loop controller,
Kout is the outer-loop controller and Kp is a gain. The controlled variable from the initial
hovering phase to the low speed phase is given by zp
△= [u w]T and its reference is given
by zr
△= [ur wr]T. In the approach phase, another loop is added outside of (zr −zp)-loop,
where ξp
△= [xe he]T is the controlled variable and ξr
△= [xr hr]T is its reference.
Kin consists of
Kin = [E −F]
(17)
where E is a feedforward gain for tracking the reference, while F is a feedback gain
for stabilizing the plant. Since the trim values are widely varied as shown in Fig. 2, the
characteristics of the linearized plant is also varied. Then, F is designed by a GS technique
in terms of LMI formulation (Boyd et al., 1994).
The reference zr from the initial hovering phase to the low speed phase is generated by the
ﬂight velocity proﬁle shown in Fig. 3, and zr in the approach phase is derived from the
positional error ξr −ξp. The switch of the reference is done at t = tc5.
4. Design of control system
4.1 Linear interpolative polytopic model
The objective of ﬂight control in this paper is that the controlled variable is regulated to the
speciﬁed trim condition. Linearized models along with the trim is therefore used for controller
design. Letting ¯xp(V), ¯up(V) be respectively the state and the input in trim where the ﬂight
202
Advances in Flight Control Systems
www.ebook3000.com

velocity is V, the perturbed state and the input are deﬁned as
δxp(t)
△= xp(t) −¯xp(V),
δup(t)
△= up(t) −¯up(V)
(18)
The linearized equation of Eq. (13) is then given as
δ ˙xp(t) = Ap(V)δxp(t) + Bp(V)δup(t)
(19)
where
Ap(V)
△= ∂fp( ¯xp, ¯up)
∂xTp
,
Bp(V)
△= ∂fp( ¯xp, ¯up)
∂uTp
.
(20)
Although matrices Ap and Bp are functions with respect to V, it is hard to get their explicit
representations because of complicated dependence of V as described in Section 2. Then, Ap
and Bp are approximated by interpolating multiple linearized models in the trim condition.
For the range of the ﬂight velocity V ∈[0, Vu], r points {V1, · · · , Vr}, called the operating
points, are chosen as
0 ≤V1 < · · · < Vr ≤Vu.
(21)
The linearized model for V = Vi is a local LTI model representing the plant near the i-th
operating point. Linearly interpolating them, a global model over the entire range of the ﬂight
velocity is constructed as
⎧
⎨
⎩
δ ˙xp(t) = Ap(V)δxp(t) + Bp(V)δup(t)
zp(t) = Cpδxp(t) + ¯zp(V)
(22)
where
Ap(V) =
r
∑
i=1
μi(V)Api,
Bp(V) =
r
∑
i=1
μi(V)Bpi,
Cp =
⎡
⎣1 0 0 0 0
0 1 0 0 0
⎤
⎦.
(23)
μi(V) satisﬁes the following relations.
0 ≤μi(V) ≤1
(i = 1, · · · , r)
(24)
r
∑
i=1
μi(V) = 1
(25)
Equation (22) with Eq. (23) is called the linear interpolative polytopic model in this paper.
4.2 Design of Kin
Under assumption (ii), consider a state feedback law
δup(t) = −F(V)δxp(t) + E(V)v(t)
(26)
203
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

where v is a feedforward input for tracking zr and is given by v = zr −¯zp when designing
Kin. The closed-loop system combining Eq. (26) with Eq. (22) is given by
⎧
⎨
⎩
δ ˙xp(t) = AF(V)δxp(t) + Bp(V)E(V)v(t)
zp(t) = Cp(V)δxp(t) + Dp(V)E(V)v(t) + ¯zp(V)
(27)
AF(V)
△= Ap(V) −Bp(V)F(V).
The steady-state controlled variable is given by
zp(∞) = −CpA−1
F BpEv + ¯zp.
(28)
v is then given so as to meet zp(∞) with the reference zr; that is, zp(∞) →zr. E is designed as
E = −(CpA−1
F Bp)−1.
(29)
Next, F(V) is designed so that the closed-loop system is stable over the entire ﬂight range and
H2 cost is globally suppressed (Fujimori et al., 2007). The controlled plant is newly given by
⎧
⎨
⎩
δ ˙xp(t) = Ap(V)δxp(t) + Bp(V)δup(t) + B1(V)w1(t)
z1(t) = C1(V)δxp(t) + D1(V)δup(t)
(30)
where z1 and w1 are respectively the input and the output variable for evaluating H2 cost.
B1(V), C1(V) and D1(V) are matrices corresponding to z1 and w1. Substituting Eq. (26)
without v into Eq. (30), the closed-loop system is
⎧
⎨
⎩
δ ˙xp(t) = AF(V)δxp(t) + B1(V)w1(t)
z1(t) = C1F(V)δxp(t)
(31)
C1F(V)
△= C1(V) −D1(V)F(V).
In this paper, F(V) is designed so as to minimize the integration of H2 cost over V ∈[0, Vu].
That is, the objective is to ﬁnd F(V) such that (Boyd et al., 1994).
inf
F,P,W
	 Vu
0
trW(V)dV
subject to
⎡
⎣P(V) P(V)B1(V)
(⋆)
W(V)
⎤
⎦> 0,
(32a)
⎡
⎣He(P(V)AF(V)) + ˙V dP
dV (⋆)
C1F(V)
−Iq
⎤
⎦< 0
(32b)
He(A) is deﬁned as He(A)
△= A + AT where (⋆) means the transpose of the element located
at the diagonal position. P(V) > 0 is the parameter dependent Lyapunov variable. To derive
ﬁnite number of inequalities from Eq. (32), the following procedures are performed. First
deﬁne new variables X(V)
△= P−1(V) and M(V)
△= F(V)X(V). Ap(V) and Bp(V) are given
204
Advances in Flight Control Systems
www.ebook3000.com

by the polytopic forms Eq. (23). B1(V), C1(V), D1(V), X(V), M(V) and W(V) are also given
by similar polytopic forms. The range of ˙V
△= aV is given as aV ∈[aV,
aV]. Furthermore,
dP/dV are approximated as
dP
dV = −X−1 dX
dV X−1
(33)
dX
dV ≃Xi+1 −Xi
Vi+1 −Vi
△= ΔXi
ΔVi
(34)
Pre- and post-multiplying diag{X, I} to Eq. (32) and using the polytopic forms, the following
LMIs are derived as a sufﬁcient condition.
inf
Mi,Xi,Wi
r−1
∑
i=1
tr(WiΔVi) subject to
⎡
⎣Xi B1i
(⋆) Wi
⎤
⎦> 0
(i = 1, · · · , r),
(35a)
⎡
⎣He(ApiXi −BpiMi) −aV
ΔXi
ΔVi (⋆)
C1iXiD1iMi
−Iq
⎤
⎦< 0,
(35b)
⎡
⎣He(ApjXj −BpjMj) −aV
ΔXi
ΔVi (⋆)
C1jXjD1jMj
−Iq
⎤
⎦< 0,
(35c)
⎡
⎢⎢⎢⎢⎢⎣
He(ApiXj −BpiMj
+ApjXi −BpjMi) −2aV
ΔXi
ΔVi
(⋆)
C1iXj −D1iMj
+C1jXi −D1jMi
−2Iq
⎤
⎥⎥⎥⎥⎥⎦
< 0
(35d)
(i = 1, · · · , r −1, j = i + 1), aV = aV, aV
If Mi, Xi and Wi (i = 1, · · · , r) satisfying the above LMIs, F(V) is given by
F(V) =

r
∑
i=1
μi(V)Mi
 
r
∑
i=1
μi(V)Xi
−1
.
(36)
4.3 Design of Kout
Since v in Eq. (26) is a feedforward input from the ﬂight velocity reference, the tracking error
will be occurred by model uncertainties and/or disturbances. Let us evaluate this in the LTI
representation. Let Tzpv(s) be a transfer function from v to zp. zp converges to a constant zr if
there are no model uncertainties in Tzpv(s) because Tzpv(0) = I. If Tzpv(0) is varied as Tzpv(0) =
I + Δ due to model uncertainties, we have the following steady-state error:
e0
△= zr −zp(∞) = −Δzr
(37)
205
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

Model
Vi [m/s]
GS-SF
Ppoly−1
{ 0, 50 }
Fgs−1
Ppoly−2
{ 0, 25, 50 }
Fgs−2
Ppoly−3 { 0, 10, 15, 40, 50 } Fgs−3
Table 2. Operating points of polytopic models
Model Vd [m/s] Fixed-SF
Plti−1
0
Ff ix−1
Plti−2
25
Ff ix−2
Plti−3
50
Ff ix−3
Table 3. Design points of LTI models
To reduce the error, a feedback from zp; that is, an outer-loop is added as shown in Fig. 4. The
transfer function from zr to zp is given by
Tzpzr(s) = (I + Tzpv(s)Kout(s))−1Tzpv(s)(I + Kout(s))
(38)
The steady-state error is then
e1
△= zr −zp(∞) = zr −lim
s→0 sTzpzr(s)1
s zr
= −(I + Tzpv(0)Kout(0))−1Δzr.
(39)
This means that the steady-state error e1 with the outer-loop is reduced by (I +
Tzpv(0)Kout(0))−1. Summarizing the above, the design requirements of Kout are given as
follows:
(i) Kout must stabilize Tzpv.
(ii) The amplitude of (I + Tzpv(jω)Kout(jω))−1 should be small in the low frequency region.
5. Simulation
To
evaluate
the
proposed
ﬂight
control
system,
a
ﬂight
simulator
was
built
on
MATLAB/Simulink. For design and discussion hereafter, the notations about plant models are
given as follows: Plpv(V) is a linear parameter varying (LPV) model obtained by linearizing
Pnl. Ppoly(V) is the linear interpolative polytopic model given by Eq. (22) with Eq. (23). Plti(Vd)
is an LTI model where the ﬂight velocity is ﬁxed at Vd.
Two cases of ﬂight control system with respect to the state feedback gain F were compared in
simulation. One is that F was designed by GS where the plant model was Ppoly(V). Another
is that F was designed by LQR where the plant model was Plti(Vd). The former is referred to
as GS-SF, while the latter is referred to as Fixed-SF. The parameter values of the ﬂight velocity
proﬁle in Fig. 3 were given as follows:
(xr, hr) = (3000, 0) [m],
Vc1 = 50,
Vc2 = 15 [m/s],
tc1 = 5,
tc2 = 30,
tc3 = 60,
tc4 = 80,
tc5 = 100 [s].
206
Advances in Flight Control Systems
www.ebook3000.com

0
10
20
30
40
50
0
0.2
0.4
0.6
0.8
1
V [m/s]
ν−gap metric between Plti and Plpv
Plti−1
Plti−2
Plti−3
(a) LTI models
0
10
20
30
40
50
0
0.1
0.2
0.3
0.4
0.5
V [m/s]
ν−gap metric between Ppoly and Plpv
Ppoly−1
Ppoly−2
Ppoly−3
(b) polytopic models
Fig. 5. ν-gap metric
207
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

0
10
20
30
40
50
1.7
1.8
1.9
2
2.1
2.2
2.3
2.4
H2 cost
V [m/s]
Ffix−3
Fgs−1
Fgs−2
Fgs−3
Fig. 6. H2 cost
5.1 Evaluation of design models
According to Section 4.1, three linear interpolative polytopic models were obtained. Table 2
shows the operating points chosen for the models. While, the design points Vd of three LTI
models are shown in Table 3. The ν-gap metric is one of criteria measuring the model error
in the frequency domain. It had been introduced in robust control theories associated with
the stability margin (Vinnicombe, 2001). The ν-gap metric between two LTI models, P1(s) and
P2(s), is deﬁned as
δν(P1, P2)
△= ∥(I + P2P∗
2 )−1/2(P1 −P2)(I + P1P∗
1 )−1/2∥∞
(40)
The range is δν ∈[0, 1]. A large δν means that the model error is large. The ν-gap metric is used
for evaluating the model Ppoly(V) and Plti(Vd). Figure 5 shows ν-gap metric between Plti(Vd)
and Plpv(V) and between Ppoly(V) and Plpv(V). δν(Plti(V), Plpv(Vd)) was rapidly increased
when V was shifted from Vd. On the other hand, the maximum of δν(Ppoly(V), Plpv(V))
was reduced according to the number of the operating points. It was seen that Ppoly(V)
appropriately approximated Plpv(V) over the entire range of the ﬂight velocity.
5.2 Design of F and H2 cost
The design parameters for designing F in Eq. (30) were given as follows.
B1 =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎣
−6.039
10.977
−154.03
49.188
3.954
−7.187
0
0
0.38495 −0.12395
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎦
,
C1 =
⎡
⎣0.001I5
02×5
⎤
⎦,
D1 =
⎡
⎣05×2
I2
⎤
⎦
208
Advances in Flight Control Systems
www.ebook3000.com

0
50
100
150
−20
0
20
40
60
u  [m/s]
Fixed−SF 1
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
Fixed−SF 1
t  [s]
xe  [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 7. Time responses using Ff ix−1
209
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

0
50
100
150
−20
0
20
40
60
u  [m/s]
Fixed−SF 2
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
Fixed−SF 2
t  [s]
xe  [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 8. Time responses using Ff ix−2
210
Advances in Flight Control Systems
www.ebook3000.com

0
50
100
150
−20
0
20
40
60
u  [m/s]
Fixed−SF 3
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
Fixed−SF 3
t  [s]
xe [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 9. Time responses using Ff ix−3
211
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

0
50
100
150
−20
0
20
40
60
u  [m/s]
GS−SF 1
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
GS−SF 1
t  [s]
xe  [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 10. Time responses using Fgs−1
212
Advances in Flight Control Systems
www.ebook3000.com

0
50
100
150
−20
0
20
40
60
u  [m/s]
GS−SF 2
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
GS−SF 2
t  [s]
xe  [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 11. Time responses using Fgs−2
213
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

0
50
100
150
−20
0
20
40
60
u  [m/s]
GS−SF 3
0
50
100
150
−30
−20
−10
0
10
w  [m/s]
0
50
100
150
5
10
15
20
25
t  [s]
θ0  [deg]
0
50
100
150
−2
0
2
4
6
t  [s]
θc  [deg]
u
ur
w
wr
(a) Controlled variables and inputs
0
20
40
60
80
100
120
140
0
1000
2000
3000
GS−SF 3
t  [s]
xe  [m]
0
20
40
60
80
100
120
140
−300
−200
−100
0
100
t  [s]
he  [m]
(b) Positions
Fig. 12. Time responses using Fgs−3
214
Advances in Flight Control Systems
www.ebook3000.com

They were used for both of GS-SF and Fixed-SF. Three GS-SF gains denoted as Fgs−i (i =
1, 2, 3) were designed according to Section 4.2, while three Fixed-SF gains denoted as Ff ix−i
(i = 1, 2, 3) were designed by LQR technique in which the weights of the quadratic index
were given by CT
1 C1 and DT
1 D1.
Figure 6 shows the H2 cost of the closed-loop system which the designed F is combined with
Eq. (30). The H2 cost by Ff ix−3 was minimized at V = 40 [m/s] which was near the design
point Vd = 50 [m/s], but was increased in the low ﬂight velocity region. The H2 cost by Ff ix−1
and Ff ix−2 showed the similar result. On the other hand, the H2 cost by Fgs−2 and Fgs−3 was
kept small over the entire ﬂight region. The H2 cost by Fgs−1 was small in the middle ﬂight
velocity region but was increased in the low and the high ﬂight velocity regions.
5.3 Tracking evaluation
The ﬂight mission given in Fig. 3 was performed in Simulink. Figures 7 - 12 show the time
histories of the closed-loop system with the three GS-SF and three Fixed-SF gains. In the case
of Ff ix−1 shown in Fig. 7, the controlled variables u and w tracked their references until the
acceleration phase (5 ≤t < 30 [s]) but they were diverged in the cruise phase (30 ≤t < 60
[s]). In the deceleration phase (60 ≤t < 80 [s]), the closed-loop system was stabilized again
but it was de-stabilized in the approach phase (t ≥100 [s]). Although the closed-loop system
remained stable for the entire ﬂight region in the case of Ff ix−2 shown in Fig. 8, oscillatory
responses were observed in the cruise and approach phases. The responses using Ff ix−3
shown in Fig. 9 were better than those using Ff ix−2.
On the other hand, the three GS-SF gains provided stable responses as shown in Figs. 10 -
12, In particular, The responses by Fgs−3 showed improved tracking and settling properties
compared to other cases.
Summarizing the simulation in MATLAB/Simulink, polytopic model Ppoly−3 made the ν-gap
metric smaller than other models for the entire ﬂight region. Fgs−3 designed by using Ppoly−3
showed better control performance.
6. Concluding remarks
This paper has presented an autonomous ﬂight control design for the longitudinal motion of
helicopter to give insights for developing autopilot techniques of helicopter-type UAVs. The
characteristics of the equation of helicopter was changed during a speciﬁed ﬂight mission
because the trim values of the equation were widely varied. In this paper, gain scheduling
state feedback (GS-SF) was included in the double loop ﬂight control system to keep the
vehicle stable for the entire ﬂight region. The effectiveness of the proposed ﬂight control
system was evaluated by computer simulation in MATLAB/Simulink. The model error of
the polytopic model was smaller than that of LTI models which were obtained at speciﬁed
ﬂight velocity. Flight control systems with GS-SF showed better control performances than
those with ﬁxed-gain state feedback. The double loop ﬂight control structure was useful for
accomplishing ﬂight mission considered in this paper.
7. References
[1] Boyd, S.; Ghaoui, L. E.; Feron, E. & Balakrishnan, V. (1994). Linear Matrix Inequalities in
System and Control Theory, SIAM, Vol. 15, Philadelphia.
[2] Bramwell, A. R. S. (1976). Helicopter Dynamics, Edward Arnold, London, 1976.
215
Autonomous Flight Control System for Longitudinal Motion of a Helicopter

[3] Cho, S.-J.; Jang, D.-S. & Tahk, M.-L. (2005). Application of TCAS-II for Unmanned Aerial
Vehicles, Proc. CD-ROM of JSASS 19th International Sessions in 43rd Aircraft Symposium,
Nagoya, 2005
[4] Fujimori, A.; Kurozumi, M.; Nikiforuk, P. N. & Gupta, M. M. (1999). A Flight Control
Design of ALFLEX Using Double Loop Control System, AIAA Paper, 99-4057-CP,
Guidance, Navigation and Control Conference, 1999, pp. 583-592.
[5] Fujimori, A.; Nikiforuk, P. N. & Gupta, M. M. (2001). A Flight Control Design of
a Reentry Vehicle Using Double Loop Control System with Fuzzy Gain-Scheduling,
IMechE Journal of Aerospace Engineering, Vol. 215, No. G1, 2001, pp. 1-12.
[6] Fujimori, A.; Miura, K. & Matsushita, H. (2007). Active Flutter Suppression of a
High-Aspect-Ratio Aeroelastic Using Gain Scheduling, Transactions of The Japan Society
for Aeronautical and Space Sciences, Vol. 55, No. 636, 2007, pp. 34-42.
[7] Johnson, E. N. & Kannan, S. K. (2005). Adaptive Trajectory Control for Autonomous
Helicopters, Journal of Guidance, Control and Dynamics, Vol. 28, No. 3, 2005, pp. 524-538.
[8] Langelaan, J. & Rock, S. (2005). Navigation of Small UAVs Operating in Forests, Proc.
CD-ROM of AIAA Guidance, Navigation, and Control Conference, San Francisco, 2005.
[9] Padﬁeld, G. D. (1996). Helicopter Dynamics: The Theory and Application of Flying Qualities
and Simulation Modeling, AIAA, Reston, 1996.
[10] Van Hoydonck, W. R. M. (2003). Report of the Helicopter Performance, Stability and Control
Practical AE4-213, Faculty of Aerospace Engineering, Delft University of Technology,
2003.
[11] Vinnicombe, G. (2001). Uncertainty and Feedback (H∞loop-shaping and the ν-gap metric),
Imperial College Press, Berlin.
[12] Wilson, J. R. (2007). UAV Worldwide Roundup 2007, Aerospace America, May, 2007, pp.
30-38.
216
Advances in Flight Control Systems
www.ebook3000.com

11 
Autonomous Flight Control for 
 RC Helicopter Using a Wireless Camera 
Yue Bao1, Syuhei Saito2 and Yutaro Koya1 
1Tokyo City University, 
2Canon Inc. 
Japan 
1. Introduction 
In recent years, there are a lot of researches on the subject of autonomous flight control of a 
micro radio control helicopter. Some of them are about flight control of unmanned 
helicopter (Sugeno et al., 1996) (Nakamura et al., 2001). The approach using the fuzzy 
control system which consists of IF-Then control rules is satisfying the requirements for the 
flight control performance of an unmanned helicopter like hovering, takeoff, rotating, and 
landing. It is necessary to presume three dimensional position and posture of micro RC 
helicopter for the autonomous flight control. 
A position and posture presumption method for the autonomous flight control of the RC 
helicopter using GPS (Global Positioning System), IMU (Inertial Measurement Unit), Laser 
Range Finder (Amida et al., 1998), and the image processing, etc. had been proposed. 
However, the method using GPS cannot be used at the place which cannot receive the 
electric waves from satellites. Therefore, it is a problem that it cannot be used for the flight 
control in a room. Although the method which uses various sensors, such as IMU and Laser 
Range Finder, can be used indoors, you have to arrange many expensive sensors or 
receivers in the room beforehand. So, these methods are not efficient. On the other hand, the 
method using an image inputted by a camera can be used in not only outdoors but also 
indoors, and is low price. However, this method needs to install many artificial markers in 
the surroundings, and it is a problem that the speed of the image inputting and image 
processing cannot catch up the speed of movement or vibration of a RC helicopter. A 
method presuming the three dimensional position and posture of a RC helicopter by the 
stereo measurement with two or more cameras installed in the ground was also proposed. 
In this case, the moving range of the RC helicopter is limited in the place where two or more 
cameras are installed. Moreover, there is a problem for which a high resolution camera must 
be used to cover a whole moving range. (Ohtake et al., 2009) 
Authors are studying an autonomous flight of a RC helicopter with a small-wireless camera 
and a simple artificial marker which is set on the ground. This method doesn’t need to set 
the expensive sensors, receivers, and cameras in the flight environment. And, we thought 
that a more wide-ranging flight is possible if the natural feature points are detected from the 
image obtained by the camera on the RC helicopter. This chapter contains the following 
contents. 

 
Advances in Flight Control Systems 
 
218 
a. 
Input method of image from a small, wireless camera which is set on a RC helicopter. 
b. 
Extraction method of feature points from an image of flight environment taken with a 
camera on RC helicopter. 
c. 
Calculation method of three dimensional position and posture of RC helicopter by 
image processing. 
d. 
Experiment of autonomous flight of a RC helicopter using fuzzy logic control. 
2. Composition of system 
The overview of a micro RC helicopter with coaxial counter-rotating blades used in our 
experiment is shown in Fig.1. Since this RC helicopter can negate a running torque of a body 
by a running torque between an up propeller and a down propeller, it has the feature that it 
can fly without being shakier than the usual RC helicopter. The composition of our 
experiment system for automatic guidance of RC helicopter is shown in Fig.2. A small 
wireless camera is attached on the RC helicopter as shown in Fig.3, and the image of the 
ground is acquired with this camera, and this image is sent to the receiver on ground, and 
then sent to the computer through a video capture. The position and posture of the RC 
 
 
Fig. 1. Micro RC helicopter with the coaxial contra-rotating rotors 
 
 
Fig. 2. Composition of automatic guidance system 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
219 
 
Fig. 3. RC helicopter equipped with a micro wireless camera 
 
 
Fig. 4. An artificial marker 
 
Fig. 5. Coordinate axes and attitude angles 

 
Advances in Flight Control Systems 
 
220 
helicopter are computed with image processing by the computer set on the ground, and, this 
image processing used the position and shape of an artificial marker in the camera image 
like Fig.4. The three dimensional position of the RC helicopter ( ( ), ( ), ( ))
x t y t z t
 and the 
changing speed of the position ( ( ), ( ), ( ))
x t y t z t



 and the attitude angles 
( )t
ψ
 and changing 
speed of attitude angles 
( )t
ψ
 can be obtained by this calculation. Fig.5 shows the relation 
between these coordinate axes and attitude angles. 
This micro RC helicopter is controlled by four control signals, such as Aileron, Elevator, 
Rudder, and Throttle, and, the control rule of fuzzy logic control is decided by using 
measurement data mentioned above. The control signals are sent to micro RC helicopter 
through the digital-analog converter. 
3. Image processing 
3.1 Image input 
The micro wireless camera attached on the RC helicopter takes an image by interlaces 
scanning. If the camera takes an image during RC helicopter flying, since the vibration of the 
RC helicopter is quicker than the frame rate of the camera, the image taken by the camera 
will be a blurred image resulting from an interlace like Fig.6. We devised a method skipping 
the odd number line (or, even number line) of input image to acquire an clear input image 
while the RC helicopter is flying. 
 
 
 
 
Fig. 6. A blurring image acquired by wireless camera 
3.2 Feature point extraction 
Feature point detection is defined in terms of local neighborhood operations applied to an 
image such as an edge and corner. Harris operator (Harris and Stephens, 1988) (Schmid et 
al., 1998) and SUSAN operator (Smith and Brady, 1997) are well known as common feature 
detectors. The methods (Neumann and You, 1999) (Bao and Komiya, 2008) to estimate 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
221 
position and attitude by using natural feature points or marker in the input image are 
proposed too. Our prototype experiment system used the Harris operator which can extract 
the same feature points in higher rate more than other feature point extraction methods 
(Schmid et al., 1998). First, we obtain a grayscale image from camera. Let us consider taking 
an image patch over an area (u , v ) from an image I and shifting it by (x, y). The Harris 
matrix M can be found by taking the second derivative of the sum of squared differences 
between these two patches around (x , y ) = (0, 0). M is given by: 
 
σ
σ
σ
σ
2
2
2
2
I
I
I
G
G
x y
x
M
I
I
I
G
G
x y
y
⎛
⎞
⎛
⎞
⎛
⎞
∂
∂∂
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
∂∂
∂
⎜
⎟
⎝
⎠
⎝
⎠
= ⎜
⎟
⎛
⎞
⎛
⎞
∂∂
∂
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
∂∂
∂
⎝
⎠
⎝
⎠
⎝
⎠
 
 (1) 
 
Let the standard deviation of G in the equation be σ with Gaussian function for performing 
smoothing with Gaussian filter. The strength of a corner is decided by second derivative. 
Here, the eigenvalue of M is 
1
2
(
,
)
λ λ
, and the value of eigenvalue can be got from the 
following inference. 
• 
If 
1
0
λ ≈
 and 
2
0
λ ≈
, then there are no features at this pixel (x , y). 
• 
If either 
1
λ or 
2
λ is large positive value, then an edge is found. 
• 
If 
1
λ and 
2
λ are both large positive values, then a corner is found. 
Because the exact calculation of eigenvalue by the method of Harris will increase 
computational amount, the following functions R were proposed instead of those 
calculation methods. 
 
2
det(
)
( (
))
R
M
k tr M
=
−
 
 (2) 
 
2
1 2
1
2
(
)
R
k
λ λ
λ
λ
=
−
+
 
 (3) 
The det expresses a determinant and tr expresses the sum of the diagonal element of a 
matrix, and k is a value decided experientially.  
The kanade-Tomasi corner detector (Shi and Tomasi, 1994) uses min (λ1λ2) as measure of 
feature point. For example, Fig.7 shows a feature point detection using Harris operator for 
photographed image. The Harris operator detects the corner point mainly from the image as 
a feature point. 
The position of feature point is estimate able by related position information of an artificial 
marker to feature point from camera image after coordinate transformation. The flight 
control area of RC helicopter can be expanded(see Fig.8) by using the information of natural 
feature points around an artificial marker. Harris operator is suitable for detecting natural 
points. Our system saves the areas including the natural feature points as templates when 
the artificial marker is detected. In the range that can take the image of the artificial marker, 
the system uses the position information of the artificial marker. If the system can't take the 
image of an artificial marker, the position of the helicopter is estimated by template 
matching between the area of natural feature points and the template area. 

 
Advances in Flight Control Systems 
 
222 
 
 
 
Fig. 7. Feature point extraction by a Harris operator 
 
 
Fig. 8. The expansion of flight area 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
223 
3.3 Detection of a marker 
 
 
Fig. 9. The flow chart of marker detection 
The image of the marker photographed with the wireless camera on micro RC helicopter is 
shown in Fig.4. The yaw angle can be calculated by the center of the marker and a position 
of a cut of triangle of the marker, and the angle of the pitch and the angle of roll can be 
acquired by coordinate transformation between a camera coordinate system and a world 
coordinate system. The flow chart about the image processing for the marker extraction and 
the calculation of position and posture are shown in Fig.9. First, a binarization processing is 
performed at the input image from the camera installed on the micro RC helicopter. Then, 
the marker in the image is searched, and the outline of the marker is extracted. If the outline 
cannot be extracted, an image is acquired from the camera again and a marker is searched again. 
A marker center is searched after the outline of a marker is extracted. The method of search 
is shown in Fig.10. The maximum values and the minimum values about the x-coordinate 
and y-coordinate are searched from of the extracted outline, and their middle values are 
given as the coordinates of the marker center. A length of major axis and a length of minor 
axis of the marker are calculated by the distance between the center coordinates of the 
marker and the pixel on the outline of the marker. The calculation method of the major axis 
and a minor axis is shown in Fig.11. When the center coordinate is defined as 
(
,
)
C
C
P x
y
, and 
the coordinate of the pixel which is on the outline is defined as I(x,y), the distance PI from 
the center to the pixel of the outline is calculated by equation (4). 
 
2
2
(
)
(
)
c
c
PI
x
x
y
y
=
−
+
−
 
 (4) 
For obtaining the maximum value 
1
G  of PI and the minimum value 
2
G  of PI, all pixels on 
the outline are calculated. And the segment of 
1
G  is defined as the major axis PO , and the 
segment of 
2
G  is defined as a minor axis PQ . The position and posture of the micro RC 
helicopter are calculated by the method shown in Section 4. 

 
Advances in Flight Control Systems 
 
224 
 
P (xc,yc)
X
Y
xmax
xmin
ymin
ymax
ymax-ymin
2
xmax-xmin
2
 
Fig. 10. The marker center 
 
 
P (xc,yc)
X
Y
I(x,y)
PI
O
Q
G1
G2
 
Fig. 11. The calculation method of the major axis and the minor axis of the marker 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
225 
Since the vibration of the RC helicopter is quicker than the frame rate of the camera, when 
the camera which attached on the micro RC helicopter takes the image, the taken image has 
become a blurred image resulting from the interlace like Fig.6. Therefore, an exact result 
cannot be obtained by a usual image processing. The image processing that we devised 
scans with skipping the odd (or even) number lines only about y axial direction at pixel 
scanning. The method of scanning is shown in Fig.12. If the pixels processed are on odd 
lines, the even number lines are skipped only about y axial direction. About x axial 
direction, the system scans 1 pixel at a time like the usual pixel scanning. By this method, a 
stable profile tracking can be performed without being blurred by interlace. 
 
even-numbered line
odd-numbered line
attention pixel
edge pixel
 
Fig. 12. The method of outline tracking 
4. Calculation of position and posture 
4.1 Calculation of the position coordinates of RC helicopter 
In order to measure the position of the RC helicopter, it is necessary to calculate the focal 
distance of the wireless camera on the RC helicopter first. If the size of marker and the 
location of z axial direction of RC helicopter are got, the focal distance f of the wireless 
camera can be calculated easily. The three-dimensional coordinates of a moving RC 
helicopter are calculated by using the focal distance, a center of gravity and the value of 
radius of the marker. The image formation surface of the camera and the circular marker 
surface are parallel if RC helicopter is hovering above the circular marker like Fig.13. 
Let’s consider that a marker is in the center of the photographed image. The radius of 
circular marker in the camera image is defined as 
1
D  , and the center coordinates of the 
circle marker are defined as 
1
1
(
,
)
C
C
x
y
. The radius of the actual marker is defined as d1, and 
the center coordinates of the actual marker in a world coordinate system are defined as 
1
1
1
(
,
,
)
x
y
z
. Then, the focal distance f of a camera can be calculated from the following two 
equations from parallel relation. 
 
1
1
1
:
:
z
d
f
D
=
 
 (5) 
 
1
1
1
z
D
f
d
⋅
=
 
 (6) 

 
Advances in Flight Control Systems 
 
226 
When the RC-helicopter is in moving, the radius of the marker in the image after moving is 
defined as 
2
D  , the center coordinates of the marker after moving are defined as 
2
2
(
,
)
C
C
x
y
, 
and the center coordinates of actual marker is defined as 
2
2
2
(
,
,
)
x
y
z
. Then, the following 
equation is acquired. 
 
2
1
2
:
:
z
d
f
D
=
 
 (7) 
Here, since the focal distance f and the radius 
1
d  of actual marker are not changing, the 
following relation is obtained from equation (5) and equation (7). 
 
1
2
2
1
:
:
D
D
z
z
=
 
 (8) 
2z  can be acquired by the following equation. Moreover, 
2
x  and 
2
y  can be calculated by 
the following equations from parallel relation. Therefore, the coordinate of the helicopter 
after moving is computable by using equation (9), equation (10), and equation (11), using the 
focal distance of the camera. 
 
1
1
2
2
D
z
z
D
⋅
=
 
 (9) 
 
2
2
2
X
z
x
f
⋅
=
 
 (10) 
 
2
2
2
Y
z
y
f
⋅
=
 
 (11) 
 
 
z
x
y
X
Y
z1
(Xc1,Yc1)
D1
Camera coordinate
World coordinate
(x1,y1)
f
d1
 
y
z
x
Y
(Xc2,Yc2)
X
z2
D2
Camera coordinate
World coordinate
(x1,y1)
f
(x2,y2)
(Xc1,Yc1)
D1
d1
 
Fig. 13. The location calculation method of RC helicopter 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
227 
4.2 Calculation of the attitude angle of RC helicopter 
The relation between an angle of RC helicopter and an image in the camera coordinate 
system is shown in Fig.14. When RC helicopter is hovering above a circular marker, the 
circular marker image in the camera coordinate system is a right circle like an actual marker. 
If RC helicopter leans, the marker in a camera coordinate system becomes an ellipse. To 
calculate the attitude angle, first, the triangular cut part of the circular marker is extracted as 
a direction feature point. Then the deformation of the marker image is corrected for 
calculating a yaw angle using the relation between the center of the circular marker and the 
location of the direction feature point of the circular marker. The pitch angle and the roll 
angle are calculated performing coordinate transformation from the camera coordinate 
system to the world coordinate by using the deformation rate of the marker in the image 
from the wireless camera. 
 
Camera 
coordinate
RC 
helicopter
Ground
Marker
 
Fig. 14. Relation between attitude angle of RC helicopter and image in wireless camera. 
Calculation of a yaw angle 
The value of yaw angle can be calculated using the relation of positions between the center 
of circular marker image and the direction feature point of the circular marker image. 
However, when the marker image is deforming into the ellipse, an exact value of the yaw 
angle cannot be got directly. The yaw angle has to be calculated after correcting the 
deformation of the circular marker. Since the length of the major axis of the ellipse does not 
change before and after the deformation of marker, the angle α  between x axis and the 
major axis can be correctly calculated even if the shape of the marker is not corrected. 
As shown in Fig.15, the center of a marker is defined as point P , the major axis of a marker 
is defined as PO , and the intersection point of the perpendicular and x axis which were 
taken down from Point O to the x axis is defined as C . The following equation is got if 
∠OPC is defined as α'. 
 
'
arctan OC
PC
α
⎛
⎞
=
⎜
⎟
⎝
⎠
 
 (12) 
Here, when the major axis exists in the 1st quadrant like Fig.15(a), α  is equal to the value of 
α', and when the major axis exists in the 2nd quadrant, α is calculated by subtracting α' 

 
Advances in Flight Control Systems 
 
228 
from 180 degrees like Fig.15(b). If the x -coordinate of Point O is defined as xO, the value of 
α is calculated by the following equation. 
 
(
0)
180
(
0)
o
o
x
x
α
α
α
′
≥
⎧
= ⎨
′
−
<
⎩
 
 (13) 
 
Fig. 15. An angle between the major axis and coordinate axes 
Next, the angle γ between the major axis and the direction of direction feature point is 
calculated. When taking a photograph from slant, a circular marker transforms and becomes 
an ellipse-like image, so the location of the cut part has shifted compared with the original 
location in the circular image. The marker is corrected to a right circle from an ellipse, and 
the angle is calculated after acquiring the location of original direction feature point. First, 
the value for deforming an ellipse into a right circle on the basis of the major axis of an 
ellipse is calculated. The major axis of an ellipse is defined as PO like Fig.16, and a minor 
axis is defined as PQ. The ratio R of the major axis to a minor axis is calculated by the 
following equation. 
 
1
2
PO
G
R
PQ
G
=
=
  
(14) 
If this ratio multiplies along the direction of a minor axis, an ellipse can be transformed to a 
circle. The direction feature point of the marker in the ellipse is defined as a, and the point of 
intersection formed by taking down a perpendicular from Point a to the major axis PO is 
defined as S . If the location of the feature point on the circle is defined as A, point A is on 
the point of intersection between the extended line of the segment aS and a right circle. 
Because aS is a line segment parallel to a minor axis, the length of a line segment aS is 
calculated by the following equations. 
 
AS
aS
R
=
×
 
 (15) 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
229 
When the line segment between Point A and the center of the marker is defined as PA , the 
angle γ  which the line segment PA and the major axis PO make is calculated by the 
following equations. 
 
γ
arctan AS
PS
=
 
 (16) 
Finally, a yaw angle is calculable by adding α  to γ. 
 
P
O
X
Y
a
γ
A
Q
α
S
G2
G1
 
Fig. 16. An angle between the direction feature point and the major axis 
Calculation of pitch angle and roll angle 
By using the deformation rate of the marker in an image, a pitch angle and a roll angle can 
be calculated by performing coordinate transformation from a camera coordinate system to 
a world coordinate system. In order to get the pitch angle and rolling angle, we used a weak 
perspective projection for the coordinate transformation (Bao et al., 2003). 
Fig.17 shows the principle of the weak perspective projection. The image of a plane figure 
which photographed the plane figure in a three-dimensional space by using a camera is 
defined as I, and the original configuration of the plane figure is defined as T. The relation 
between I and T is obtained using the weak perspective projection transformation by the 
following two steps projection. 
a. 
T' is acquired by a parallel projection of T to P paralleled to camera image surface C. 
b. 
I is acquired by a central projection of T ' to C . 
The attitude angle β' is acquired using relation between I and T. The angle β' shown in 
Fig.18 expresses the angle between original marker and the marker in the camera coordinate 
system. In that case, the major axis 
1
G  of the marker image and a minor axis 
2
G  of the 
marker image can show like Fig.19. 

 
Advances in Flight Control Systems 
 
230 
x
y
z
p
m’
P
M
m
o
O
Camera imaging surface C
3-dimensional space
Two dimension image T
p
Two dimension image T’
Photography image I
 
Fig. 17. The conceptual diagram of weak central projection 
 
Y
X
β
G1
P
O
G2
Q
 
Fig. 18. The schematic diagram of the attitude angle β' 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
231 
Camera
Ground
β
G2
G1
L
U
S
T
P
Q
β’
 
Fig. 19. Calculation of an attitude angle 
Fig. 19 shows the calculation method of β’. PQ is transformed into LP if along optical axis of 
a camera an inverse parallel projection is performed to the minor axis PQ. Since the original 
configuration of a marker is a right circle, LP becomes equal to the length 
1
G  of the major 
axis in a camera coordinate system. β’ is calculated by the following equation. 
 
2
1
'
arcsin G
G
β
⎛
⎞
=
⎜
⎟
⎝
⎠
 
 (17) 
To get the segment TU, SU is projected orthogonally on the flat surface parallel to PQ . PQ 
and TU are in parallel relationship and LP and SU are also in parallel relationship. 
Therefore, the relation between β’ and β can be shown by equation (18), and the inclination 
β’ of the camera can be calculated by the equation (19). 
 
'
β
β
=
 
 (18) 
 
2
1
arcsin G
G
β
⎛
⎞
=
⎜
⎟
⎝
⎠
 
 (19) 
5. Control of RC helicopter 
Control of RC helicopter is performed based on the position and posture of the marker 
acquired by Section 4. When RC helicopter is during autonomous hovering flight, the position 

 
Advances in Flight Control Systems 
 
232 
data of RC helicopter are obtained by tracking the marker from definite height. The fuzzy rule 
of the Throttle control input signal during the autonomous flying is defined as follows. 
• 
If ( )
z t  is PB and ( )
z t

 is PB, Then Throttle is NB 
• 
If ( )
z t  is PB and ( )
z t

 is ZO, Then Throttle is NS 
• 
If ( )
z t  is PB and ( )
z t

 is NB, Then Throttle is ZO 
• 
If ( )
z t  is ZO and ( )
z t

 is PB, Then Throttle is NS 
• 
If ( )
z t  is ZO and ( )
z t

 is ZO, Then Throttle is ZO 
• 
If ( )
z t  is ZO and ( )
z t

 is NB, Then Throttle is PS 
• 
If ( )
z t  is NB and ( )
z t

 is PB, Then Throttle is ZO 
• 
If ( )
z t  is NB and ( )
z t

 is ZO, Then Throttle is PS 
• 
If ( )
z t  is NB and ( )
z t

 is NB, Then Throttle is PB 
The fuzzy rule design of Aileron, Elevator, and Rudder used the same method as Throttle. 
Each control input u(t) is acquired from a membership function and a fuzzy rule. The 
adaptation value 
i
ω  and control input u(t) of a fuzzy rule are calculated from the following 
equations. 
 
1
(
)
n
i
Aki
k
k
x
ω
μ
=
=∏
 
 (20) 
 
1
1
( )
r
i i
i
r
i
i
c
u t
ω
ω
=
=
= ∑
∑
 
 (21) 
Here, i is the number of a fuzzy rule, n is the number of input variables, r is the quantity of a 
fuzzy rule, 
Aki
μ
 is the membership function, 
k
x  is the adaptation variable of a membership 
function, and 
ic  is establishment of an output value (Tanaka, 1994) (Wang et al., 1997). 
6. Experiments 
In order to check whether parameter of a position and a posture can be calculated correctly, 
we compared actual measurement results with the calculation results by several 
experiments. The experiments were performed indoors. In the first experiment, a wireless 
camera shown in Fig.20 is set in a known three-dimensional position, and a marker is put on 
the ground like Fig.21. 
The marker is photographed by this wireless camera. A personal computer calculated the 
position and the posture of this wireless camera and compared the calculated parameters 
with the actual parameters. 
Table 1 shows the specification of the wireless camera and Table 2 shows the specification of 
the personal computer. A marker of 19cm radius is used in experiments because it is 
considered that the marker of this size can be got easily when this type of wireless camera 
which has the resolution of 640x480 pixels photographs it at a height between 1m and 2m. 
Table 3 shows experimental results of z axis coordinates. Table 4 shows experimental results 
of moving distance. Table 5 shows experimental results of yaw angle (β’ +γ). Table 6 shows 
experimental results of β’ angle. According to the experimental results, although there are 
some errors in these computed results, these values are close to actual measurement. 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
233 
 
Fig. 20. The wireless camera 
 
 
Fig. 21. The first experiment 
 
Maker 
RF SYSTEM lab. 
Part number 
Micro Scope RC-12 
Image sensor 
270,000pixel , 1/4 inch , color CMOS 
Lens 
φ0.8mm Pin lens 
Scan mode 
Interlace 
Effective distance 
30m 
Time of charging battery 
About 45 minutes 
Size 
15×18×35(mm) 
Weight 
14.7g 
Table 1. The specification of the wireless camera 
 
Maker 
Hewlett Packard 
Model name 
Compaq nx 9030 
OS 
Windows XP 
CPU 
Intel Pentium M 1.60GHz 
Memory 
768MB 
Table 2. The specification of PC 

 
Advances in Flight Control Systems 
 
234 
Actual distance (mm) 
800 
1000 
1200 
1400 
Calculated value 
785 
980 
1225 
1372 
Table 3. The experimental results of z axis coordinates 
 
Actual moving distance (mm) 
50 
-50 
100 
-100 
Computed value of x axis coordinates 
31 
-33 
78 
-75 
Computed value of y axis coordinates 
29 
-33 
101 
-89 
Table 4. The experimental results of moving distance 
 
Actual degree (degree) 
45 
135 
225 
315 
Calculated value 
64 
115 
254 
350 
Table 5. The experimental results of yaw angle (α angle＋γ angle) 
 
Actual degree (degree) 
0 
10 
20 
40 
Calculated value 
12 
28 
36 
44 
Table 6. The experimental results of β angle 
In next experiment, we attached the wireless camera on RC helicopter, and checked if 
parameters of a position and a posture would be calculated during the flight. Table 7 shows 
the specification of RC helicopter used for the experiment. A ground image like Fig.22 is 
photographed with the wireless camera attached at RC helicopter during the flight. The 
marker is detected by the procedures of Fig.9 using image processing program. A 
binarization was performed to the inputted image from the wireless camera and the outline 
on the marker was extracted like Fig. 23. The direction feature point was detected from the 
image of the ground photographed by the wireless camera like Fig.24. 
Fig. 25 shows the measurement results on the display of a personal computer used for the 
calculation. The measurement values in Fig.25 were x-coordinate=319, y-coordinate=189,  
z-coordinate = 837, angle α =10.350105, angle γ = -2.065881, and angle β '=37.685916. Since 
our proposal image input method which can improve blurring was used, the position and 
the posture were acquirable during flight. However, since the absolute position and posture 
of the RC helicopter were not measureable by other instrument during the flight. We 
confirmed that by the visual observation the position and the posture were acquirable 
almost correctly. 
 
Length 
360mm(Body) , 62mm(Frame) 
Width 
90mm 
Height 
160mm 
Gross load 
195g 
Diameter of a main rotor 
350mm 
Gear ratio 
9.857:1 
Motor 
XRB Coreless Motor 
Table 7. The specification of RC helicopter 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
235 
 
Fig. 22. An image photographed by the wireless camera 
 
 
Fig. 23. The result of marker detection 
 
 
Fig. 24. The result of feature point extraction 

 
Advances in Flight Control Systems 
 
236 
 
Fig. 25. The measurement results during flight 
At the last, the autonomous flight control experiment of the RC helicopter was performed by 
detecting the marker ,calculating the position and the posture,and fuzzy control. Fig. 26 
shows a series of scenes of a hovering flight of the RC helicopter. The results of image 
processing can be checked on the display of the personal computer. From the experimental 
results, the marker was detected and the direction feature point was extracted correctly 
during the autonomous flight. However, when the spatial relation of the marker and the RC 
helicopter was unsuitable, the detection of position and posture became unstable, then the 
autonomous flight miscarried. We will improve the performance of the autonomous flight 
control for RC helicopter using stabilized feature point detection and stabilized position 
estimation. 
7. Conclusion 
This Chapter described an autonomous flight control for micro RC helicopter to fly indoors. 
It is based on three-dimensional measuring by a micro wireless camera attached on the 
micro RC helicopter and a circular marker put on the ground. First, a method of measuring 
the self position and posture of the micro RC helicopter simply was proposed. By this 
method, if the wireless camera attached on the RC helicopter takes an image of the circular 
marker, a major axis and a minor axis of the circular marker image is acquirable. Because 
this circular marker has a cut part, the direction of the circular marker image can be 
 
www.ebook3000.com

Autonomous Flight Control for RC Helicopter Using a Wireless Camera   
 
237 
 
 
                                Time 1                                                                     Time 2 
 
 
                                 Time 3                                                                    Time 4 
Fig. 26. The experiment of autonomous flight 
acquired by extracting the cut part as a direction feature point of the circular marker. 
Therefore, the relation between the circular marker image and the actual circular marker can 
be acquired by a coordinate transform using the above data. In this way, the three-
dimensional self position and posture of the micro RC helicopter can be acquired with 
image processing and weak perspective projection. Then, we designed a flight control 
system which can perform fuzzy control based on the three-dimensional position and 
posture of the micro RC helicopter. The micro RC helicopter is controlled by tracking the 
circle marker with a direction feature point during the flight. 
In order to confirm the effectiveness of our proposal method, in the experiment, the position 
and the posture were calculated using an image photographed with a wireless camera fixed 
in a known three-dimensional position. By the experiment results, the calculated values near 
the actually measuring values were confirmed. An autonomous flight control experiment 
was performed to confirm that if our proposal image input method is effective when using a 
micro wireless camera attached on the micro RC Helicopter. By results of the autonomous 
flight control experiment of the RC helicopter, the marker was detected at real-time during 
the flight, and it was confirmed that the autonomous flight of the micro RC helicopter is 
possible. However, when the spatial relation of the marker and the RC helicopter was 

 
Advances in Flight Control Systems 
 
238 
unsuitable, the detection of position and posture became unstable and then the autonomous 
flight miscarried. We will improve the performance of autonomous flight control of the RC 
helicopter to more stable. We will improve the system so that the performance of the 
autonomous flight control of the RC Helicopter may become stability more. 
8. Reference 
Amida, O.; Kanade, T. & Miller, J.R. (1998). Vision-Based Autonomous Helicopter Research 
at Carnegie Mellon Robotics Institute 1991-1997, American Helicopter Society 
International Conf. Heli, Japan. 
Harris, C. & Stephens, M. (1988). A Combined Corner and Edge Detecter, Proc. 4th Alvey 
Vision Conf., pp.147-151. 
Nakamura, S.; Kataoka, K. & Sugeno, M. (2001). A Study on Autonomous Landing of an 
Unmanned Helicopter Using Active Vision and GPS, J.RSJ Vol.18, No.2, pp.252-260. 
Neumann, U. & You, S. (1999). Natural Feature Tracking for Augmented-reality, IEEE 
Transactions on Multimedia, Vo.1, No.1, pp.53-64. 
Ohtake, H.; Iimura, K. & Tanaka, K. (2009). Fuzzy Control of Micro RC Helicopter with 
Coaxial Counter-rotating Blades, journal of Japan Society for Fuzzy Theory and 
Intelligent Informatics, Vol.21, No.1, pp.100-106. 
Schmid, C.; Mohr, R. & Bauckhage, C. (1998). Comparing and Evaluating Interest Points, 
Proc. 6th Int. Conf. on Computer Vision, pp.230-235. 
Shi, J. & Tomasi, C. (1994). Good Features to Track, Proc. IEEE Conf. Comput. Vision Patt. 
Recogn., pp.593-600. 
Smith, S. M.; & Brady, J. M. (1997). SUSAN - A New Approach to Low Level Image 
Processing, Int. J. Comput. Vis., vol.23, no.1, pp.45-78. 
Sugeno, M. et al. (1996). Inteligent Control of an Unmanned Helicopter based on Fuzzy 
Logic., Proc. of American Helicopter Society 51st Annual Forum., Texas. 
Tanaka, K. (1994). Advanced Fuzzy Control, Kyoritsu Shuppan Co.,LTD, Japan. 
Wang, G.; Fujiwara, N. & Bao, Y. (1997). Automatic Guidance of Vehicle Using Fuzzy 
Control. (1st Report). Identification of General Fuzzy Steering Model and 
Automatic Guidance of Cars., Systems, Control and Information, Vol.10, No.9, pp.470- 
479. 
Bao, Y.; Takayuki, N. & Akasaka, H. (2003). Weak Perspective Projection Invariant Pattern 
Recognition without Gravity Center Calculation, journal of IIEEJ, Vol.32, No.5, 
pp.659--666 
Bao, Y. & Komiya, M. (2008). An improvement Moravec Operator for rotated image, Proc. of 
the ADVANTY 2008 SYMPOSIUM , pp.133-138. 
www.ebook3000.com

Ali Karimoddini, Guowei Cai, Ben M. Chen, Hai Lin, Tong H. Lee
Graduate School for Integrative Sciences and Engineering (NGS) and Department of
Electrical and Computer Engineering, National University of Singapore
Singapore
1. Introduction
Nowadays, control design of Unmanned Aerial Vehicles (UAVs) has emerged as an attractive
research area, due to the wide range of UAV applications in various military and civilian
areas such as terrain and utility inspections, coordinated surveillance, search and rescue
missions, disaster monitoring, rapid emergency response, aerial mapping, trafﬁc monitoring,
and reconnaissance missions (see, e.g., (Metni et al., 2007), (Kuroki et al., 2010 ), (Campbell
& Campbell, 2010 )). They can also be used as complex test-bed dynamic systems for
implementation and veriﬁcation of the control schemes for different research purposes (Kim
& Sukkarieh, 2007), (Saripalli et al., 2003), (Bortoff, 1999). Several research groups are involved
in the modeling and control of UAVs (Bortoff, 1999), (Gavrilets et al., 2000), (Cai et al., 2006).
The control methods such as the neural network approach (Enns & Si, 2003), the differential
geometry method (Isidori et al., 2003), feedback control with decoupling approach (Peng et
al., 2009), and the model predictive approach (Shim et al., 2003) have been applied for the
ﬂight control of the UAV helicopters. In this chapter, however, we have used an analytical
approach to design and analyze the whole system including the inner-loop and the outer-loop
controllers for a small-scale UAV helicopter. Here, in the proposed hierarchical structure, the
inner-loop is responsible for the internal stabilization of the UAV in the hovering state and
control of the linear velocities and heading angle angular velocity whereas the outer-loop is
used to drive the system, which is already stabilized by the inner-loop, to follow a desired path
while keeping the system close to the hovering state. This hierarchical strategy is an intuitive
way of controlling such a complex system. However, there is another reason that compels us
to employ such a control structure. Indeed, the UAV model cannot be fully linearized, since,
in practice, we cannot expect the heading angle of the UAV to be restricted to a small range
of variation as depending on the mission, the heading of the UAV could be in any direction.
This will impose some kind of nonlinearity on the system, which can be modeled by a simple
transformation. To handle this semi-linearized model of the UAV, we can separate the linear
and nonlinear parts, and then control the linear part in the inner-loop and the nonlinear part
in the outer-loop.
In this hierarchy, for the inner-loop, we have used an H∞controller to both stabilize the system
and suboptimally achieve the desired performance of the UAV attitude control. Assuming
that the inner-loop has already been stabilized by an H∞controller, a proportional feedback
controller combined with a nonlinear compensator block have been used in the outer-loop to
bring the UAV into the desired position with desired heading angle.
 
Hierarchical Control Design of a UAV Helicopter 
12

Although designing a proportional feedback controller for SISO systems is straightforward,
the situation for MIMO systems is different. This is because, in MIMO systems, it is not easy
to use the popular tools, such as the Nyquist stability theorem or the root-locus approach,
that are well-established for the SISO systems. The current approaches employed for MIMO
systems are rather complicated and are mostly extensions of the existing results for SISO
systems (Wang et al., 2007). In this chapter, we propose a design method of a decentralized
P-controller for MIMO systems that, although conservative, can be effectively used in practical
problems, particularly for the case that the system is close to a decoupled system. The
approach is an extension of the Nyquist theorem to MIMO systems, and its application to
the NUS UAV system provides a successful ﬂight controlled system.
The test-bed is Helion (Fig. 1), the ﬁrst developed UAV helicopter in our NUS UAV research
group (Peng et al., 2007). In (Cai et al., 2008a), a systematic procedure for the construction of
a small-scale UAV helicopter is described, and in (Cai et al., 2005), the hardware parts of the
NUS UAV, including both the avionic system and the ground station, are illustrated in detail.
Fig. 1. The NUS UAV helicopter.
The remaining parts of this chapter are organized as follows. In Section II, the model and
the structure of the NUS UAV is described. The UAV model consists of two decoupled
subsystems. In Section III, a hierarchical controller, including an inner-loop and an outer-loop
controller, is designed for both subsystems. Actual ﬂight tests are presented in Section IV, and
the chapter is concluded in Section V. For the convenience of the reader, a nomenclature part
is provided at the end of this chapter.
2. Modeling and structure of the UAV helicopter
A typical UAV helicopter consists of several parts: physical parts such as engine and fuselage;
ground station to monitor the ﬂight situation and collect realtime ﬂight data, and the avionic
system to implement the control strategy to have an autonomous ﬂight control. Among these
elements, the avionic part is in the center of our interest in this chapter and we will focus on
the control structure which is embedded in the airborne computer system. Here, the avionic
240
Advances in Flight Control Systems
www.ebook3000.com

system consists of an airborne computer system which can be extended modularly by some
extension boards such as A\D card, DC-DC convertor card, and serial communication board.
In addition, the avionic system has been equipped with some analog and digital sensors to
collect the information of the current state of the UAV. The major sensor used in the avionic
system, is the NAV-IMU sensor. The IMU sensor provides three axis velocities, acceleration
and angular rates in the body frame, as well as longitude, latitude, relative height and heading,
pitch and roll angles. Moreover, the avionic system has a fuel level sensor as well as a magnetic
RPM sensor to measure the speed of the rotor. Furthermore, it comprises ﬁve servo actuators
that could manipulate the helicopter to move forward and backward, up and down, to turn
left and right, to regulate the nose angle and ﬁnally to control the spinning speed of the
rotor. All of these servos are controlled by a servo board as a local controller. In addition,
the servo board gives the ability of driving the servo system into either the manual mode or
the automatic mode. In the manual mode, a pilot can drive the helicopter by a radio controller
which is useful in the emergency situations; however, in the automatic mode the helicopter is
under the control of the computer system and all control signals are generated by the avionic
system and the computer board, autonomously.
Using some basic physical principles, we can obtain a general nonlinear UAV model. These
principles will result in several equations that represent the effects of different factors such
as gravity, the main rotor, and tail rotor forces and moments. The model equations will be
obtained in two coordinate systems: the body frame and the ground frame. The body frame
is centered at the center of gravity of the UAV, and the ground frame is an NED (North - East
- Down) coordinate system (Stevens & Lewis, 1992) with a ﬁxed origin at the starting point
of the UAV ﬂight. Clearly, the UAV dynamic equations should be derived in the body frame,
while the position of the UAV is considered in the ground frame.
Neglecting the gyroscopic effect of the engine-driven train, the equations of the helicopter
motion in the body frame are obtained as follows:
˙⃗Vb = −⃗ωb × ⃗Vb + Bb⃗g + m−1⃗F
(1)
˙⃗ωb = −J−1ωb × J⃗ωb + J−1 ⃗M
(2)
where in these equations, × denotes the cross product of the vectors, and the concatenation
of two matrices or vectors represents the normal matrix multiplication. Moreover, ⃗F and ⃗M
are the resultant force and moment in the body frame, including those generated from the
main rotor, the tail rotor and the fuselage. Other symbols’ deﬁnition can be found in the
nomenclature part provided at the end of this chapter.
The Euler angles that show the orientation of the body frame relative to the ground frame are
as follows:
⎡
⎣
˙φ
˙θ
˙ψ
⎤
⎦=
⎡
⎣
1 tan θ sinφ tan θ cosφ
0
cosφ
−sinφ
0
sin φ
cos θ
cos φ
cos θ
⎤
⎦˙⃗ωb
(3)
where

φ θ ψ
′ is a vector that contains the Euler angles to describe the attitude of the
helicopter with respect to the NED frame.
The relation between the UAV position in the ground frame and the UAV velocity in the body
frame is:
˙⃗Pg = ´Bb⃗Vb
(4)
241
Hierarchical Control Design of a UAV Helicopter

where Bb is the transformation matrix from the ground frame to the body frame, which has
the following form:
Bb =
⎡
⎣
cos θ cosψ
cos θ sinψ
−sin θ
−cos φ sinψ + sin φsin θ cosψ
cos φ cosψ + sin φsin θ sinψ
sin φ cosθ
sin φ sinψ + cos φsin θ cosψ −sin φ cosψ + cos φsin θ cosψ cos φ cosθ
⎤
⎦
(5)
The details of this UAV model are described in (Peng et al., 2007). From the above model
description, it can be seen that the UAV model is nonlinear. Furthermore, the main problem
encountered in the modeling of our UAV is that the process of buying a radio-control
helicopter from the market and upgrading it to an autonomous ﬂying vehicle leaves us with
many unknown parameters and aerodynamic data. Therefore, for practical reasons, we need
to linearize the UAV model and then, identify the resulting linearized model through the
recorded in-ﬂight data. The in-ﬂight data can be collected through the manual mode and by
injecting perturbed input signals to the ﬂying helicopter. We have obtained a linearized model
at the hovering state as it has been presented in (Cai et al., 2006). By hovering, we mean that
⃗V0 = 0, ⃗ω0 = 0, θ0 = 0, φ0 = 0 . The obtained linearized model is as follows:
˙x = Ax + Bu + Ew
(6)
where the state variable x includes 11 variables as x = [ Vzb(m/s) ωzb(rad/s) wz f (rad/s)
Vxb(m/s) Vyb(m/s) ωxb(rad/s) ωyb(rad/s) φ(rad) θ(rad) ˜as(rad) ˜bs(rad) ]′. These parameters
are shown in Fig. 2. wz f is the yaw rate feedback, which is related to δpedal by a ﬁrst-order
differential equation (Cai et al., 2008b).
Furthermore, the control input u includes commands to the servos embedded for the control
of the helicopter blades as u = [ δcol(rad) δpedal(rad) δroll(rad) δpitch(rad) ]′.
Matrices A, B, and E are obtained as follows:
A =
 A1 03×8
08×3
A2
	
, B =
 B1
03×2
08×2
B2
	
, E =
 E1
03×2
08×1
E2
	
where
A1 =
⎡
⎣
−0.6821 −0.1070
0
−0.1446 −5.5561 −36.6740
0
2.7492 −11.1120
⎤
⎦, B1 =
⎡
⎣
15.6491
0
1.6349 −58.4053
0
0
⎤
⎦,
E1 =
⎡
⎣
−0.5995
−1.3832
0
⎤
⎦, B2 =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
0
0
0
0
0
0
0
0
0
0.0496 2.6224
2.4928 0.1740
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
, E2 =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
−0.1778
0
0
−0.3104
−0.3326 −0.2051
0.0802 −0.2940
0
0
0
0
0
0
0
0
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
,
A2 =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
−0.1778
0
0
0
0
−9.7807 −9.7808
0
0
−0.3104 0
0 9.7807
0
0
9.7807
−0.3326 −0.5353 0
0
0
0
75.7640
343.86
−0.1903 −0.2940 0
0
0
0
172.620 −59.958
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0 −1
0
0
−8.1222 4.6535
0
0
−1 0
0
0
−0.0921 −8.1222
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
.
Remark 1. In the linearized model described by (6), the saturation level for the servos is |δ⋆max| = 0.5.
We need to provide a control law such that the resulting control signals always remain within the linear
unsaturated range.
242
Advances in Flight Control Systems
www.ebook3000.com

Fig. 2. Helicopter states in the body frame.
Although (6) describes the relation between the control input and the state variable x, it still
does not describe the whole dynamics of the system, and particularly, ⃗P and ϕ are not reﬂected
in the model. Thus, considering (2) and (4), a more complete model containing ⃗P and ϕ is as
follows:
⎧
⎪
⎨
⎪
⎩
˙x = Ax + Bu + Ew
˙ψ = ωzb
˙⃗Pg = ´Bb⃗Vb
(7)
Remark 2. Matrix Bb includes some time-dependent terms. Therefore, matrix Bb can not be considered
as a constant term and it is not simple to integrate both sides of (7) in order to obtain the position in
the ground frame. This is due to the fact that the body frame is a moving coordinate system. Hence, to
obtain the displacement, it is necessary to ﬁrst obtain the velocities in a ﬁxed coordinate system such as
the ground frame. Then, the displacement can be calculated by integrating of the velocity vector in the
ﬁxed coordinate system.
The presence of nonlinear terms of Bb, in the third equation of (7), makes it difﬁcult to design a
controller for the system; however, we can further simplify the model. Indeed, matrix Bb in (5),
which introduces some nonlinear terms to the model, can be linearized at the hovering state.
In practice, the heading angle of the helicopter can take any arbitrary value; however, the roll
and pitch angles are usually kept close to the hovering condition. Therefore, linearizing matrix
Bb at the hovering state will result in:
Bb =
⎡
⎣
cos ψ sin ψ 0
−sin ψ cos ψ 0
0
0
1
⎤
⎦=

R
02×1
01×2
1
	
(8)
The physical interpretation is that by keeping ⃗θ and ⃗φ close to zero, the Euler rotation in a
three-dimensional space will be converted into a simple rotation in a two-dimensional space
243
Hierarchical Control Design of a UAV Helicopter

with respect to ψ. In this case, the rotation matrix is:
R =
 cos ψ sin ψ
−sin ψ cos ψ
	
(9)
In the following section, as we design the outer-loop controller, it will be shown that this new
formulation of Bb helps us to keep the system decoupled, even after using the outer-loop
controller.
The semi-linearized UAV model, presented in (7) can be controlled in separate parts: the linear
part in the inner-loop and the nonlinear part in the outer-loop, as described in the following
section.
3. Controller design
We use a hierarchical approach to design a controller for the UAV (Fig. 3). In this framework,
the system is stabilized in the inner-loop, and then it is driven to track a desired trajectory in
the outer-loop. Besides this rational strategy, there is another reason that compels us to select
this particular architecture. As mentioned previously, we need to derive the model equations
in two coordinate systems: the velocities and accelerations should be obtained in the body
coordinate system as a moving frame, whereas the displacement must be derived by the
integration of the velocities in a ﬁxed frame. The velocity transformation from the body frame
to the ground frame, modeled by matrix Bb, imposes some kind of nonlinearity as described
in (7). This nonlinearity can be handled in the outer-loop. Using this control strategy, we have
separated the nonlinear term from the linear part and put it in the outer-loop.
-
-
-
-
-
Control Law
Outer-loop
Control Law
Helicopter
Inner-loop
Pre f
ui
Fig. 3. Schematic diagram of the ﬂight control system.
In this control architecture, the references for the inner-loop controller, ui, are the linear
velocities (Vxb, Vyb, and Vzb) and the yaw rate, ωzb, which should all be provided by the
outer-loop. The outer-loop, however, is responsible for the control of the position and heading
angle of the UAV and will guide the UAV to follow a desired trajectory. Therefore, the
references for the outer-loop are the position (Xr, Yr, Zr) and the yaw angle ψr. In other words,
the UAV will follow the generated path by the position and the yaw angle control in the
outer-loop, and the linear velocity and the angular rate control in the inner-loop.
looking at matrices A, B, and E in (6), we can see that, the system has been already decoupled
into two independent parts. Therefore, (6) can be rewritten into two separate subsystems as
follows:
˙x1 = A1x1 + B1u1 + E1w
(10)
˙x2 = A2x2 + B2u2 + E2w
(11)
where x1 = [ Vzb(m/s) ωzb(rad/s) wz f (rad/s) ]′, u1 = [ δcol δpedal ]′, x2 = [ Vxb(m/s) Vyb(m/s)
ωxb(rad/s) ωyb(rad/s) φ(rad) θ(rad) ˜as(rad) ˜bs(rad) ]′, and u2 = [ δroll(rad) δpitch(rad) ]′.
244
Advances in Flight Control Systems
www.ebook3000.com

Considering (7), (8), (10), and (11), the above-mentioned hierarchical control strategy can be
implemented for the decoupled model of our UAV, as shown in Fig. 4 and Fig. 5. In these
ﬁgures, subscripts g, b, and r stand for ground frame, body frame, and reference, respectively.
Moreover, matrices C1 and C2 are:
C1 =

1 0 0
0 1 0
	
, C2 =

1 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0
	
(12)
Fig. 4. Control schematic for Subsystem 1.
Fig. 5. Control schematic for Subsystem 2.
Due to the special structure of the linearized form of Bb, Subsystem 1 is a fully linearized
model. However, in the outer-loop of Subsystem 2, the term R−1 appears as a nonlinear
element, and thus Subsystem 2 is more complicated than Subsystem 1. In the following parts,
we will describe the control design for both subsystems.
3.1 Controller for subsystem 1
Subsystem 1 is a fully linearized model so that linear design tools can be applied to the system.
We will use the H∞control design technique for the inner-loop and a P-controller for the
outer-loop.
3.1.1 Inner-loop controller
Using an H∞controller for the inner-loop, both robust stability and proper performance of the
system can be achieved simultaneously. To design the H∞controller, using notation analogous
with (Chen, 2000), we deﬁne the measurement output simply as the state feedback in the form
of y1 = C11x with C11 = I. Since our primary task is to design a control law to internally
stabilize the system, and to achieve a good response of the state variables that are directly
related and linked to the outer-loop, while considering the constraints on the inputs and some
state variables, we deﬁne the controlled output h1 in the form of h1 = C12x + D12u, where
C12 =
⎡
⎢⎢⎣
02×3
3.1623
0
0
0
3.1623
0
0
0
1.7321
⎤
⎥⎥⎦, D12 =
⎡
⎣
44.7214
0
0
28.2843
03×2
⎤
⎦
(13)
245
Hierarchical Control Design of a UAV Helicopter

The nonzero entries of C12 and D12 are used for tuning the controller, and here, are determined
experimentally to achieve the desired performance. Meanwhile, the H∞design guarantees
internal stability and robustness of the system. Indeed, H∞control design minimizes the effect
of the wind gust disturbance, i.e., minimizes the H∞norm of the closed-loop transfer function
from the disturbance w to the controlled output h1, denoted by T1. The H∞norm of the transfer
function T1 is deﬁned as follows:
∥T1∥∞=
sup
0≤ω<∞
σmax[T1(jω)]
(14)
where σmax[.] denotes the maximum singular value of the matrix.
It should be highlighted that the H∞norm is the worst case gain in T1(s). Therefore,
minimization of the H∞norm of T1 is equivalent to the minimization of the disturbance
effect from the disturbance w to the controlled output h1 in the worst case situation. Having
the matrix C12 and D12, one can ﬁnd the γ∗∞which is the optimal H∞performance for the
closed-loop system from the disturbance input w to the controlled output h1 over all the
possible controllers that internally stabilize the system. As practically, γ∗∞is not achievable,
we will try to reach γ∞which is slightly larger than γ∗∞.
With this choice of the control parameters, D11 and D12 are full rank and the quadruples
(A1, B1, C12, D12) and (A1, E1, C11, D11) are left invertible and are free of invariant zeros.
Therefore, we have a so-called regular problem, for which we can use well-established H∞
control theory (Chen, 2000). The resulting closed loop system suboptimality minimizes the
H∞norm of the transfer function from the disturbance w to the controlled output h1. To design
this controller we consider the control law in the following form:
u1 = F1x1 + G1r1
(15)
where r1 = (Vzr, ωzr)′ is the reference signal generated by the outer-loop controller, G1 =
−(C1(A1 + B1F1)−1B1)−1 is the feedforward gain, and F1 is the H∞control gain that can be
achieved as follows:
F1 = −(D′
12D12)−1(D′
12C12 + B′
1P1))
(16)
where matrix P1 is the positive semi-deﬁnite solution of the following H∞algebraic Riccati
equation:
A′
1P1 + P1A1 + C′
12C12 + P1E1E′
1P1/γ2 −
(P1B1 + C′
12D12)(D′
12D12)−1(D′
12C12 + B′
1P1) = 0
(17)
For this system and these control parameters values, the value of γ∗∞is 1.4516. Hence, we
select γ∞= 1.4616. Therefore, matrices F1 and G1 are obtained as follows:
F1 =
 −0.0935 −0.0005 0.0027
0.0008
0.0364 −0.0481
	
, G1 =

0.1371
0.0066
−0.0020 −0.2748
	
(18)
To evaluate the controller performance and its effect on the disturbance attenuation, we
simulated the closed loop system with an initial state of x1(0) = [1.5 0 0]′, and also we injected
wind gust disturbance for 20 sec (Fig. 6). The injected disturbance has a maximum amplitude
of 3 m/s along the z axis (the other directions do not affect the dynamics of Subsystem 1). The
controlled system reaches the steady hovering state after 3.5 sec, and the disturbance effect is
reduced to less than 0.25%. The control inputs are within the unsaturated region.
246
Advances in Flight Control Systems
www.ebook3000.com

0
5
10
15
20
25
30
35
40
0
2
4
Wind gust (m/s)
0
5
10
15
20
25
30
35
40
−2
0
2
Vz
b
 (m/s)
 
 
0
5
10
15
20
25
30
35
40
−0.5
0
0.5
ωz
b
 (rad/s)
 
 
0
5
10
15
20
25
30
35
40
−0.2
0
0.2
Inputs
Time(s)
 
 
δcol
δped
Fig. 6. Simulation of the inner-loop of Subsystem 1.
3.1.2 Outer-loop controller
In the outer-loop of Subsystem 1, we use a P-controller KP1 (Fig. 7). We can redraw this system
as shown in Fig. 8, in which Gin1 = 1
S C1(SI −(A1 + B1F1))−1B1G1. It can be shown that Gin1 is
a 2×2 multi-variable system. Unfortunately, in general, designing a P-controller for an MIMO
system is difﬁcult. However, if we consider Kp1 in diagonal form as Kp1 = kp1I2×2, we can
apply the generalized Nyquist theorem (Postlethwaite & MacFarlane, 1979) to design kp1 such
that it stabilizes the system as described in the following part.
g
g
?-
-
-
-
-

6
-
-
kp
G1
˙X1 = A1X1 + B1u1
C1
1/s
F
+
+
+
-

Zr
ψr

VZr
ωZr

Zg
ψg
Fig. 7. Control structure of Subsystem 1.
j -
- ?
-
kp1
Gin1
+
-

Zg
ψg

VZr
ωZr

Zr
ψr
+
Fig. 8. Redrawing the control structure of Subsystem 1.
3.1.3 Stability analysis
The characteristic loci of Gin1 are shown in Fig. 9, where the dash-dot lines correspond to the
inﬁnite values. In Subsystem 1, Fig. 8, the inner-loop has already been stabilized, using an H∞
247
Hierarchical Control Design of a UAV Helicopter

controller. Therefore, due to the presence of the integral term, Gin1 has two poles at the origin
and the remaining poles are in the LHP plane. Hence, Gin1 has no pole in the Nyquist contour.
It follows from the form of the characteristic loci of Gin1 in Fig. 9, that kp1 ∈(0 , ∞) will keep
the entire system stable. However, in practice, we are subjected to the selection of small values
of kp1 to avoid saturation of the actuators. kp1 = 1.5 is a typical value.
Fig. 9. Characteristic loci of Gin1.
3.1.4 Tuning the controller
With the above outer-loop controller, the stability of the whole system has been achieved;
however, the controller in the form of Kp1 = kp1 × I2×2 with only one control parameter is
not an appropriate choice. We need to have more degrees of freedom to tune the controller
and achieve better performance. By considering the proportional feedback gain Kp1
=
diag{Kp11, Kp12} as a diagonal matrix, we have more degrees of freedom and can control each
of the output channels in a decentralized manner, while keeping the system decoupled.
Uncertainty analysis usually is used to investigate the effect of the plant uncertainty. Here,
we borrow this idea to analyze the effect of deviation of the diagonal entries of the matrix
Kp1 = kp1 I2×2 in the controller part. Alternatively, one can deﬁne Kp1 as follows:
Kp1 =
 Kp11
0
0
KP12
	
= kp1 I2×2 +

ΔKp11
0
0
ΔKP12

(19)
The objective is to design Δ = diag

ΔKp11, ΔKp12

such that it does not affect the stability of
the system. In fact, △is the tuning range (Fig. 10).
Following from Fig. 10, one can extract the internal model of the system as:

y = Gin1kp1(I + Gin1kp1)−1v + (I + Gin1kp1)−1Gin1z
x = (I + Gin1kp1)−1v −(I + Gin1kp1)−1Gin1z
(20)
To simplify the notation, (20) can be rewritten as:

y = G11v + G12z
x = G21v + G22z
(21)
248
Advances in Flight Control Systems
www.ebook3000.com



n
-
-
-
-
-
6
?
v
+
-
+
kp1 I
△
Gin1
e
y
z
x
+
Fig. 10. Tuning the controller using uncertainty analysis.
k
k
-
-
-
-
-
-





6
B
B
B
B
B
BBN
-
-
6
v
z
y
x
G11
G21
G12
G22
+
+
△
Fig. 11. Redrawing Subsystem 1 for uncertainty analysis.
Therefore, Fig. 10 can be redrawn as it is shown in Fig. 11. In the new diagram, since the
nominal system with Δ = 0 is stable, all Gij are stable. G11, G12, and G21 are outside the
uncertain loop and cannot be affected by block △; however, the loop includes G22 and △may
affect the internal stability of the system due to perturbations of the elements of △. Since G22
and △are stable, according to the generalized Nyquist theorem, the characteristic loci of the
loop transfer function should not encircle the point (-1+j0), or equivalently, |λi(−G22Δ)| < 1.
To satisfy this condition, since |λi(G22Δ)| ≤¯σ(G22Δ) ≤sup
ω
(¯σ(G22Δ)) = ∥G22Δ∥∞, it is
sufﬁcient that ∥G22Δ∥∞< 1. Using norm properties, we have:
∥G22Δ∥∞≤∥G22∥∞∥Δ∥∞
(22)
Therefore, the sufﬁcient condition for the stability of the system is:
∥G22∥∞∥Δ∥∞< 1
(23)
For these values of the controller and plant and for a frequency range of (0, 10000), we obtain
∥G22∥∞= 0.6986. Therefore, the perturbation of Kp1 should be such that ∥Δ∥∞≤1.4315.
Recall that △has a diagonal structure, and hence, all diagonal entries of Kp1 should have less
than a 1.4315-unit deviation from their nominal value. In fact, using this approach, we ﬁrst
249
Hierarchical Control Design of a UAV Helicopter

obtained a nominal controller that provides the stability of the system, and then, we attempted
to tune the controller to improve the performance, while keeping the system stable. After
tuning the controller, the value of Kp1 = diag{0.5, 0.7} was selected as an appropriate value
that satisﬁes the above mentioned condition and gives a satisfactory performance. The method
is conservative as Δ is structured and real, but applying to the UAV plant it has provided
sufﬁcient degree of freedom for tuning the controller and improving the performance.
To simulate the resulting system, let the outer-loop reference be (Zr, ψr) = (−2, 0.5) and the
current position and heading angle be (Zg, ψg) = (0, 0). The system will reach its target after
approximately 8 sec as shown in Fig. 12.
0
10
20
30
40
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Zg(m)
Time(s)
0
10
20
30
40
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
ψ (rad)
Time(s)
Fig. 12. Simulation of the outer-loop of Subsystem 1.
3.2 Designing the controller for subsystem 2
3.2.1 Inner-loop controller
For Subsystem 2, described by (11), we use an
H∞
controller for the inner-loop
controller design, similar to Subsystem 1. Analogous with Subsystem 1, we deﬁne h2
as h2 = C22x2 + D22u2, where
C22 =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
02×8
0.3162
0
0
0
0 0 0 0
0
0.3162
0
0
0 0 0 0
0
0
0.3162
0
0 0 0 0
0
0
0
0.3162 0 0 0 0
0
0
0
0
1 0 0 0
0
0
0
0
0 1 0 0
0
0
0
0
0 0 1 0
0
0
0
0
0 0 0 1
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
250
Advances in Flight Control Systems
www.ebook3000.com

D22 =
⎡
⎣
5.4772
0
0
5.4772
08×2
⎤
⎦
With these parameters, we obtain γ∗∞= 0.0731, and choosing γ∞= 0.0831, we have:
F2 =

0.0017 −0.1683 −0.0486 0.0081 −1.9336 −0.1974 −0.3227 −2.1444
0.0815 −0.0461 −0.0087 −0.0535 −0.3908 −1.0690 −1.1712 −0.4659
	
Moreover, G2 = −(C2(A2 + B2F2)−1B2)−1, is the feedforward gain for Subsystem 2 and can
be calculated as:
G2 =

−0.0029 0.2335
−0.0978 0.0632
	
The simulation of the system is shown in Fig. 13. In this ﬁgure, the initial state of the system
is x2(0) = [1.5 0 0 0 0.17 0 0 0]′. The injected disturbance has a maximum amplitude of 10
m/s along the x and y axes (the z direction does not affect the dynamics of Subsystem 2). The
controlled system reaches the steady hovering state after 3.5 sec, and the disturbance effect is
reduced to less than 0.25%. In addition, the control inputs are within the unsaturated region.
0
5
10
15
20
25
30
35
40
−10
0
10
Wind gust 
(m/s)     
 
 
X−axis
Y−axis
0
5
10
15
20
25
30
35
40
−5
0
5
Velocity 
(m/s)    
 
 
Vx
b
Vy
b
0
5
10
15
20
25
30
35
40
−1
0
1
Ang. Velocity 
(rad/s)       
 
 
ωx
b
ωy
b
0
5
10
15
20
25
30
35
40
−0.5
0
0.5
angle
(rad)
 
 
φ
θ
0
5
10
15
20
25
30
35
40
−0.5
0
0.5
Inputs
Time(s)
 
 
δrol
δpitch
Fig. 13. Simulation of the inner-loop of Subsystem 2.
3.2.2 Outer-loop controller
Although the outer-loop of Subsystem 2 is similar to the outer-loop of Subsystem 1, the main
difference lies in the presence of the nonlinear term, R−1, in the outer-loop of Subsystem 2, as
shown in Fig. 4. In this structure, it can be seen that the error signal is the difference between
the actual position and the reference position, which both are in the ground frame. Therefore,
the resulting control signal, which is the reference for the inner-loop, will be obtained in the
ground frame; however, the inner-loop is in the body frame. Hence, it is reasonable that
251
Hierarchical Control Design of a UAV Helicopter

we transform the control signal to the body frame before delivering it to the inner-loop as
the reference to be tracked. To implement this idea, we can use the transformation term,
R, to obtain a control signal in the body frame. The new structure is shown in Fig. 14, in
which Gin2 = C2(SI −(A2 + B2F2))−1B2G2 is a 2 × 2 multi-variable system. In Fig. 15, it is
shown that the inner-loop block Gin2 is very close to a decoupled system with equal diagonal
elements. Indeed, Subsystem 2 corresponds to the dynamics of the helicopter for the x −y
plane movement. In practice, we expect the dynamics of the UAV in the x and y directions
to be similar and decoupled, since the pilot can easily drive the UAV in either of directions
independently. Using this concept, we can take the block Gin2 out so that the two rotation
matrices R and R−1 will cancel each other.
Fig. 14. Control diagram of Subsystem 2.
10
−1
10
0
10
1
10
2
−100
−80
−60
−40
−20
0
G11
Magnitude (dB)
Frequency  (rad/sec)
10
−1
10
0
10
1
10
2
−100
−80
−60
−40
−20
0
G12
 
 
Frequency  (rad/sec)
10
−2
10
0
10
2
−100
−80
−60
−40
−20
0
G21
Magnitude (dB)
Frequency  (rad/sec)
10
−1
10
0
10
1
10
2
−100
−80
−60
−40
−20
0
G22
Frequency  (rad/sec)
Fig. 15. Bode plot of entries of Gin2
252
Advances in Flight Control Systems
www.ebook3000.com

The remaining job is simple, and we can repeat the procedure of designing the outer-loop
controller for Subsystem 1 and design a P-controller in the form of Kp2 = diag{Kp21 , KP22}
that stabilizes Gin2 (Fig. 16). As an appropriate choice of control parameters, we can select
Kp2 = diag{0.3 , 0.3}. Rationally, Kp21 and KP22 should be the same, since we expect a similar
behavior of the UAV system in the x and y directions.
Fig. 16. Redrawing the control diagram of Subsystem 2.
For an outer-loop reference at (xr, yr) = (2, 2) and the current UAV position at (xg, yg) =
(0, 0), the simulation results are shown in Fig. 17, in which the UAV reaches to the desired
position after approximately 10 sec, smoothly and without overshooting.
0
10
20
30
40
0
0.5
1
1.5
2
2.5
Xg(m)
Time(s)
0
10
20
30
40
0
0.5
1
1.5
2
2.5
Yg(m)
Time(s)
Fig. 17. Simulation of the outer-loop of Subsystem 2.
4. Experimental results
Before using the designed controller in an actual ﬂight test, we ﬁrst evaluate it through a
hardware-in-the-loop simulation platform (Cai et al., 2009). In this platform, the nonlinear
dynamics of the UAV has been replaced with its nonlinear model, and all software and
hardware components that are involved in a real ﬂight test remain active during the
253
Hierarchical Control Design of a UAV Helicopter

simulation. Using the hardware-in-the-loop simulation environment, the behavior of the
system is very close to the real experiments.
Then, we conducted actual ﬂight tests to observe the in-ﬂight behavior of the helicopter. First,
we used the UAV in the hovering state for 80 sec. Figure 18 shows the state variables in the
hovering experiment at (x, y, z, ψ) = (−16, −34, 10, −1.5). To evaluate the hovering control
performance, the position of the UAV is depicted in a 2D x −y plane in Fig. 19. As can be seen,
the position of the UAV has at most a 1-meter deviation from the desired hovering position,
which is quite satisfactory. The control inputs are also shown in Fig. 20. All of the control
inputs are within the unsaturated region.
Next, we used the UAV to follow a circle with a diameter of 20 meters as a given
trajectory. This trajectory determines the reference (x(t), y(t), z(t), ψ(t)) for the system. With
this trajectory, the UAV should complete the circle within 63 sec, while keeping a ﬁxed
altitude. Then, it will hover for 7 sec. In Fig. 21, it is shown that the UAV is able to
follow this trajectory successfully. The UAV path tracking in the x −y plane is shown
in Fig. 22. Moreover, to have a better insight of the system behavior, all of the states of
the UAV and the control inputs are represented in Fig. 23 and Fig. 24, respectively. These
results show that the UAV is able to track the desired trajectory in situations close to the
hovering state. The small deviations in the hovering mode or path tracking mode could
be due to environmental effects such as wind disturbances or the GPS signal inaccuracy
as with the installed sensors the measurable steady accuracy of the heading angle is 2.5o
and the positioning accuracy of the GPS is 3m(1σ). Videos of the hovering experiment
and circle path tracking are available at http://uav.ece.nus.edu.sg/video/hover.mpg and
http://uav.ece.nus.edu.sg/video/circle.mpg , respectively.
0
10
20
30
40
50
60
70
−40
−20
0
20
Position (m)
All state variables
 
 
Xg
Yg
Zg
0
10
20
30
40
50
60
70
−2
0
2
Velocity (m/s)
 
 
Vx
b
Vy
b
Vz
b
0
10
20
30
40
50
60
70
−2
−1
0
1
Angular position 
(rad)
 
 
φ
θ
ψ
0
10
20
30
40
50
60
70
−2
−1
0
1
Time (s)
Angular velocity
 (rad/s)
 
 
ωx
b
ωy
b
ωz
b
Fig. 18. State variables of the UAV for the hovering.
254
Advances in Flight Control Systems
www.ebook3000.com

−17.2
−17
−16.8
−16.6
−16.4
−16.2
−16
−15.8
−15.6
−15.4
−15.2
−38
−37
−36
−35
−34
−33
−32
−31
−30
x−y plane
x (m)
y (m)
Fig. 19. UAV position in x −y plane at hovering
5. Conclusion
In this chapter, we presented a systematic approach for the ﬂight control design of a
small-scale UAV helicopter in a hierarchical manner. In this structure, the lower level aims
at stabilization of the system, and the upper level focuses on the reference tracking. For
the disturbance attenuation and stabilization of the UAV, we used an H∞controller in the
inner-loop of the system. Due to the presence of some nonlinear terms in the outer-loop of
the system, we ﬁrst compensated for the nonlinearity by an inverse rotation; then, we used a
decentralized P-controller to enable the UAV to follow a desired trajectory. We also proposed
a new method of designing a P-controller for MIMO systems that was successfully applied
to the UAV system. The simulations and actual ﬂight tests show the efﬁcacy of the control
structure. In the future, we will use this structure to accomplish more complex missions
such as formation control (Karimoddini et al., 2010). Such missions will require an embedded
decision-making unit to support the tasks and to switch between the controllers. This concept
will guide us in designing a hybrid supervisory controller in the path planner level of the UAV
to comprehensively analyze the reactions between the continuous dynamics of the system and
discrete switching between the controllers (Karimoddini et al., 2009).
6. Acknowledgments
The authors gratefully acknowledge the technical support of Mr. Dong Xiangxu and Mr. Lin
Feng during the implementations and ﬂight tests.
255
Hierarchical Control Design of a UAV Helicopter

0
10
20
30
40
50
60
70
80
0
0.05
0.1
δrol
0
10
20
30
40
50
60
70
80
0
0.05
0.1
δpitch
0
10
20
30
40
50
60
70
80
−0.3
−0.2
−0.1
δcol
0
10
20
30
40
50
60
70
80
−0.01
0
0.01
δped
time (s)
Fig. 20. Control signals at hovering
0
10
20
30
40
50
60
70
−50
−40
−30
−20
Xg (m)
 
 
0
10
20
30
40
50
60
70
−30
−20
−10
0
Yg (m)
 
 
0
10
20
30
40
50
60
70
−15
−10
−5
0
Zg (m)
 
 
0
10
20
30
40
50
60
70
−5
0
5
Time (s)
ψ (rad)
 
 
Actual
Reference
Fig. 21. Tracking a desired path.
256
Advances in Flight Control Systems
www.ebook3000.com

−60
−55
−50
−45
−40
−35
−30
−25
−20
−15
−10
−40
−35
−30
−25
−20
−15
−10
−5
0
5
x−y plane
x (m)
y (m)
 
 
Actual
Reference
Fig. 22. Circle path tracking in x −y plane.
10
20
30
40
50
60
70
−60
−40
−20
0
Position (m)
All state variables
 
 
Xg
Yg
Zg
10
20
30
40
50
60
70
−2
0
2
Velocity (m/s)
 
 
Vx
b
Vy
b
Vz
b
10
20
30
40
50
60
70
−2
0
2
4
Angular position
 (rad)
 
 
φ
θ
ψ
10
20
30
40
50
60
70
−2
0
2
Time (s)
Angular velocity
 (rad/s)
 
 
ωx
b
ωy
b
ωz
b
Fig. 23. States of the UAV in the circle path tracking behavior.
257
Hierarchical Control Design of a UAV Helicopter

0
10
20
30
40
50
60
70
−0.1
0
0.1
δrol
0
10
20
30
40
50
60
70
−0.1
0
0.1
δpitch
0
10
20
30
40
50
60
70
−0.4
−0.2
0
δcol
0
10
20
30
40
50
60
70
−0.04
−0.02
0
δped
time (s)
Fig. 24. Control inputs in the circle path tracking behavior.
Nomenclature
A
= system matrix
as
= longitudinal blade angle
B
= control input matrix
Bb
= transformation matrix from the ground to the body frame
bs
= lateral blade angle
E
= disturbance matrix
⃗F
= resultant force in the body frame
⃗g
= acceleration due to gravity, ⃗g = [0, 0, g]′
J
= inertia matrix
⃗M
= resultant moment in the body frame
⃗P
= position of the UAV, ⃗P = (X, Y, Z)′
u
= control input vector
⃗V
= linear velocity vector of the UAV, ⃗V = (Vx, Vy, Vz)′
⃗ω
= angular velocity vector of the UAV, ⃗ω = (ωx, ωy, ωz)′
w
= wind gust disturbance in the body frame, w = (wx, wy, wz)′
θ
= pitch angle
φ
= roll angle
ψ
= yaw angle
δroll
= roll channel input
δpitch = pitch channel input
δpedal = pedal channel input
δcol
= collective channel input
⋆g
= the value of ⋆in the ground frame
⋆b
= the value of ⋆in the body frame
⋆r
= the value of ⋆as control reference
258
Advances in Flight Control Systems
www.ebook3000.com

7. References
Bortoff, S. (1999). The university of toronto rc helicopter: a test bed for nonlinear control,
Proceedings of the IEEE International Conference on Control Applications, IEEE, Vol. 1,
pp. 333–338.
Cai, G., Peng, K., Chen, B. M. & Lee, T. H. (2005). Design and assembling of a uav helicopter
system, International Conference on Control and Automation, Vol. 2, pp. 697–702.
Cai, G., Chen, B. M., Peng, K., Dong, M. & Lee, T. H. (2006). Modeling and control system
design for a uav helicopter, 14th Mediterranean Conference on Control and Automation,
pp. 1–6.
Cai, G., Feng, L., Chen, B. M. & Lee, T. H. (2008a). Systematic design methodology and
construction of uav helicopters, Mechatronics, 18(10): 545–558.
Cai, G., Chen, B. M., Peng, K., Dong, M. & Lee, T. H.(2008b). Comprehensive modeling
and control of the yaw channel of a UAV helicopter, IEEE Transactions on Industrial
Electronics, 55(9): 3426–3434.
Cai, G., Chen, B. M., Lee, T. H. & Dong, M. (2009). Design and implementation
of a hardware-in-the-loop simulation system for small-scale UAV helicopters,
Mechatronics, 19(7): 1057–1066.
Campbell, M. E. & Wheeler, M. (2010). Vision-Based Geolocation Tracking System for
Uninhabited Aerial Vehicles, AIAA Journal of Guidance, Control, and Dynamics, 33(2):
521–532.
Chen, B. M. (2000). Robust and H∞Control, Springer, London.
Dong, M., Chen, B. M., Cai, G. & Peng, K. (2007). Development of a real-time onboard and
ground station software system for a UAV helicopter, AIAA Journal of Aerospace
Computing, Information, and Communication, 4(8): 933–955.
Enns, R. & Si, J. (2003). Helicopter trimming and tracking control using direct neural dynamic
programming, IEEE Transactions on Neural Networks, IEEE, Vol. 14, pp. 929-939, 2003.
Gavrilets, V., Shterenberg, A., Dahleh, M. & Feron, E. (2000). Avionics system for a small
unmanned helicopter performing aggressive maneuvers, Proceedings of the 19th
Digital Avionics Systems Conferences, Vol. 1, pp. 1E2/1–1E2/7.
Isidori, A., Marconi, L. & Serrani, A.(2003) Robust nonlinear motion control of a helicopter,
IEEE Transactions on Automatic Control, IEEE, Vol. 48, pp. 413–426, 2003.
Karimoddini, A., Lin, H., Chen, B.M. & Lee, T.H. (2009) Developments in hybrid modeling
and control of unmanned aerial vehicles, Proceedings of the 7th IEEE International
Conference on Control and Automation, Christchurch, New Zealand, pp. 228–233.
Karimoddini, A., Lin, H., Chen, B.M. & Lee, T.H. (2010) Hybrid formation control of the
Unmanned Aerial Vehicles, Mechatronics, doi:10.1016/ j.mechatronics.2010.09.007.
Kim, J. & Sukkarieh, S. (2007). Real-time implementation of airborne inertial-SLAM, Journal of
Robotics and Autonomous Systems, 55(1): 62–71.
Kuroki, Y., Young, G.S. & Haupt, S.E. (2010). UAV navigation by an expert system for
contaminant mapping with a genetic algorithm, Journal of Expert Systems with
Applications, 37(6 ): 4687–4697.
Metni, N. & Hamel, T. (2007). A UAV for bridge inspection: Visual servoing control law with
orientation limits, Journal of Automation in Construction, 17(1): 3–10.
Peng, K., Dong, M., Chen, B. M., Cai, G., Lum, K. Y. & Lee, T. H. (2007). Design and
implementation of a fully autonomous ﬂight control system for a uav helicopter,
Chinese Control Conference, pp. 662–667.
259
Hierarchical Control Design of a UAV Helicopter

Peng, K. , Cai, G., Chen, B. M., Dong, M., Lum, K. Y. & Lee, T. H. (2009). Design
and implementation of an autonomous ﬂight control law for a UAV helicopter,
Automatica, 45(10), pp. 2333–2338.
Postlethwaite, I. & MacFarlane, A. G. I. (1979). A Complex Variable Approach to the Analysis of
Linear Multivariable Feedback Systems, in Lecture Notes in Control and Information
Sciences, Vol. 12/1979, Springer, Berlin, pp. 58–76.
Saripalli, S., Montgomery, J. & Sukhatme, G. (2003). Visually guided landing of an unmanned
aerial vehicle, IEEE Transactions on Robotics and Automation, 19(3): 371–380.
Shaferman, V. & Shima, T. (2008). Unmanned Aerial Vehicles Cooperative Tracking of Moving
Ground Target in Urban Environments, AIAA Journal of Guidance, Control, and
Dynamics, 31(5): 1360–1371.
Shim, D. H., Kim, H. J. & Sastry, S. (2003). Decentralized nonlinear model predictive control of
multiple ﬂying robots, Proceedings of the 42nd IEEE Conference on Decision and Control,
IEEE, Hawaii, pp. 3621–3626.
Stevens, B. L. & Lewis, F. L. (1992). Aircraft control and simulation, Wiley, New York.
Wang, Q.G., Lin, C., Ye, Z., Wen, G., He, Y. & Hang, C. C. (2007). A quasi-lmi approach
to computing stabilizing parameter ranges of multi-loop pid controllers, Journal of
Process Control, 17(1): 59–72.
260
Advances in Flight Control Systems
www.ebook3000.com

13 
Comparison of Flight Control System Design 
Methods in Landing 
S.H. Sadati, M.Sabzeh Parvar and M.B. Menhaj 
Aerospace Engineering Department, 
Amir Kabir University, Hafez Ave., Tehran, 
Iran 
1. Introduction 
The development and application of most present-day systems and control theory were 
spurred on by the need to resolve aerospace problems. This is roughly the problem of 
analyzing and designing flight control systems for tactical missiles or aircraft. The control 
laws used in current tactical missile or aircraft are mainly based on classical control design 
techniques. These control laws were developed in the 1950s and have evolved into fairly 
standard design procedures [1].  
Current autopilot design processes contain time-and resource-consuming trial-and-error 
approaches. Especially late changes in the flight control laws contribute to high cost and 
delay of first delivery. The automatic landing mode development is a good example of a 
process with trial-and-error design phases, because of the many parameters the system has 
to be robust against. These parameters originate from different runway, terrain, ILS and 
weather characteristics, and from aircraft uncertainties like configuration and landing 
weight. Additional uncertainties arise from uncertain aerodynamic parameters, actuator 
model uncertainties, etc. The autonomous aircraft landing is an issue that implies three main 
aspects: the performance of equipment, the process models and the ethics. Generally, the 
landing is not a standard flight task as it could be thinking. We consider it a nonstandard 
flight stage because it has a very high sensitivity versus environment perturbation and to 
the psychological factors.  
In the last three decades, optimality-based designs have been considered to be the most 
effective way for a guided missile engaging the target [2-4]. However, it is also known from 
the optimal control theory that a straightforward solution to the optimal trajectory shaping 
problem leads to a two point boundary-value problem [2], which is too complex for real-
time onboard implementation. Based on the reasons given above, advanced control theory 
must be applied to a control system to improve its performance. One of the best ways to 
solve this problem is to approach the artificial intelligence modeling technology based on 
fuzzy logic and neural network [5]. 
Intelligent control is a control technology that replaces the human mind in making 
decisions, planning control strategies, and learning new functions whenever the 
environment does not allow or does not the presence of a human operator. Artificial neural 
networks and fuzzy logic are two potential tools for use in applications in intelligent control 
engineering. Artificial neural networks offer the advantage of performance improvement 

 
Advances in Flight Control Systems 
 
262 
through learning by means of parallel and distributed processing. Many neural control 
schemes with back propagation training algorithms, which have been proposed to solve the 
problems of identification and control of complex nonlinear systems, exploit the nonlinear 
mapping abilities of neural networks [6,7]. Recently, adaptive neural network algorithms 
have also been used to solve highly nonlinear flight control problems. A fuzzy logic-based 
design that can resolve the weaknesses of conventional approaches has been cited above. 
The use of fuzzy logic control is motivated by the need to deal with highly nonlinear flight 
control and performance robustness problems. It is well known that fuzzy logic is much 
closer to human decision making than traditional logical systems. Fuzzy control based on 
fuzzy logic provides a new design paradigm such that a controller can be designed for 
complex, ill-defined processes without knowledge of quantitative data regarding the input-
output relations, which are otherwise required by conventional approaches [8-11]. An 
overview of neural and fuzzy control designs for dynamic systems was presented by Dash 
et al.[12].  
2. Aircraft model 
Aircraft landing process enhanced several phases that define the so-called standard landing 
trajectory. The landing operation concerning two controlled maneuvers: first for guiding the 
aircraft  in  the  horizontal  plane,  in  order  to  align  it  onto  the  axe  of  the  runway  and  
the second, for aircraft guiding in the vertical plane in order to do the approaching of 
runway surface. Basically, the automatic landing systems provide the information for 
instrument navigation along the standard trajectory. In this paper only control about the 
longitudinal axis is considered. With this restriction, the equations of motion describing the 
aircraft take the form [13]: 
 
(
)
sin
bal
g
V
T
D
g
W
γ
=
−
−

 
(1) 
 
(
cos )
g
L
V W
γ
γ
=
−

 
(2) 
 
(
)
m
y
qSC
q
C
I
=

 
(3) 
 
sin
h
V
γ
=

 
(4) 
 
cos
x
V
γ
=

 
(5) 
 
q
θ =

 
(6) 
The state variables are V = airspeed, γ = flight path angle,θ = pitch  angle, and q = pitch rate,  
h is the altitude, T is the engine thrust force. The aerodynamic and propulsive forces are 
assumed to have the following form: 
 
0
q
e
f
m
m
m
m
m
e
m
f
C
C
C
q
C
C
C
α
δ
δ
α
δ
δ
=
+
+
+
+
 
(7) 
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
263 
 
2
2
cos
bal
gl
L
l
mg
C
SV
γ
ρ
=
 
(8) 
 
0
b
L
L
bal
L
C
C
C
α
α
−
=
 
(9) 
 
2
(
)
sin
2
Lbal
l
bal
D C
gl
V S
T
C
mg
ρ
γ
=
+
 
(10) 
 
0
(
)/
f
e
bal
m
m
bal
m
f
m
C
C
C
C
α
δ
δ
δ
α
δ
= −
+
+
 
(11) 
 
2
0
1
2
( )
D
C
B
B
B
α
α
α
=
+
+
 
(12) 
 
0
1
2
0
1
2
,
( )
,
L
C
C
C
C
C
C
α
α
α
α
+
⎧
⎫
⎪
⎪
= ⎨
⎬
+
+
⎪
⎪
⎩
⎭
,
*
*
max
α
α
α
α
α
≤
⎧
⎫
⎪
⎪
⎨
⎬
≤
≤
⎪
⎪
⎩
⎭
 
(13) 
The model parameter data given in Table 1 refer to a Boeing B727 aircraft powered by three 
JT8D-17 turbofan engines [13]. 
3. Conventional design methods 
Generally, the controller is in a form of proportional-integral-derivative (PID) parameters, 
and the control gains are determined by using classical control theory, such as the root locus 
method, Bode method or Nyquist stability criterion [14-16]. Modern control theory has been 
used extensively to design the flight control system, such as in the linear quadratic 
techniques [17,18], generalized singular linear quadratic technique [19], H∞ design 
technique and μ synthesis technique [20]. 
A. Optimal Control 
The optimization of dynamic processes frequently requires the solution of an optimal 
control problem. That is, given a process model in terms of differential equations for the 
state variables, find the vector of control functions that minimizes some performance index, 
subject to boundary conditions and possibly additional equality or inequality constraints on 
the state and controls. Application of the necessary condition for optimal control of systems 
defined by ordinary differential equations results in a two-point boundary value problem. A 
suitable Method to solve such problems is the well-known Multiple Shooting Method [21]. 
The method reduces the boundary value problem to the solution of a set of algebraic 
equations and initial value problems with partially unknown initial conditions that are solve 
by Newton iteration. Based upon this method, this boundary value problem is solved 
numerically by the Multiple Shooting code BNDSCO [22]. The optimal trajectory problem 
consists of minimizing [2] 
 
2
*
2
( )
[(
)
(
) ]
bal
e
e
J u
H
H
dt
δ
δ
=
−
+
−
∫
 
(14) 
with boundary conditions are, 

 
Advances in Flight Control Systems 
 
264 
 
0
0
0
0
0
0,
(0)
,
(0)
,
(0)
(0)
, (
)
(0)
(0)
, (
)
f
f
f
f
V
V
q
q
h
h
h t
h
X
X  
t
γ
γ
θ
θ
θ
θ
=
=
=
=
=
=
=
=
 
(15) 
and the final time 
ft  is free 
The variational Hamiltonian is formed by adjoining the right-hand sides of the system of 
state differential Eqs. (1-6) with the costate variables  
 
2
*
2
(
)
(
)
(
(
)
sin )
(
(
cos ))
(
)
(
sin )
(
cos )
( )
b
e
e
V
b
q
m
h
x
y
H
H
H
g
g
L
T
D
g
W
V W
qSC C
V
V
q
I
γ
θ
δ
δ
λ
γ
λ
γ
λ
λ
γ
λ
γ
λ
=
−
+
−
+
−
−
+
−
+
+
+
+
 
(16) 
The costate variables are defined by differential equation 
 
v
d
H
dt
v
λ
∂
= −∂
  , 
, , , , ,
v
V
q h x
γ
θ
=
 
(17) 
 
2
[
(
)]
(
cos )
sin
cos
v
m
V
V
v
q
h
x
y
g
g
q CSC
L
D
W
W
I
V
γ
λ
λ
λ
γ
λ
λ
γ
λ
γ
=
+
−
−
−
−

 
(18) 
 
sin
cos
cos
sin
V
h
x
g
g
V
V
V
γ
γ
γ
λ
λ
γ
λ
λ
γ
λ
γ
=
−
−
+

 
(19) 
 
q
m
q
q
y
qCSC
I
θ
λ
λ
λ
= −
−

 
(20) 
 
*
2(
)
h
H
H
λ =
−

 
(21) 
 
0
x
λ =

 
(22) 
 
0
θ
λ =

 
(23) 
Solving these equations with the appropriate boundary conditions is a two-point boundary-
value problem (TPBVP). Generally, at the initial point, all six states are specified and the 
costates are free; whereas, at the final time, the 
,
H θ  is fix and the remaining four states are 
free. Thus, at the final time all costates are free. The free final time 
ft can be considered as an 
additional variable of the problem and, by the standard transformation  
f
t
t ξ
=
 
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
265 
 
/
/
f
d
d
t d
dt
ξ =
 
(24) 
The equations are transformed into a system with the independent variable ξ  ranging in 
the interval 0
1
ξ
≤
≤
. Further, the additional trivial differential equation 
 
0
f
d t
dξ
=
 
(25) 
is added to the system. At the final time, the transversality condition requires that 
(
)
0
f
H t
=
 
The optimal control function is obtained by means of the minimum principle. With respect 
to the elevator, we find the relation 
 
2
e
b
m
e
e
q
y
qCSC
I
δ
δ
δ
λ
=
−
 
(26) 
Result of optimal trajectory for the selected B-727 is presented in Fig (3) through (8). The 
costate variable
q
λ , which is responsible for the determination of the extermal controller, is 
shown in Fig.8. 
B. Pole Placement Method  
An alternative and very powerful method for designing feedback gains for autostabilization 
systems is the pole placement method. The method is based on the manipulation of the 
equations of motion in state space form and makes full use of the appropriate computational 
tools in the analytical process. Practical application of the method to airplanes is limited 
since it assumes that all state variables are available for use in an augmentation system, 
which is not usually the case. The open loop state equation may then be written  
 
X
AX
BU & Y
CX
=
+
=

 
(27) 
 
0.04436
29.988
0
32.1629
0
-0.001458
0.53075
1
0.007357
0
0
0.4914
0.431
0
0
A
0
0
1
0
0
0
210
0
210
0
−
−
⎡
⎤
⎢
⎥
−
⎢
⎥
⎢
⎥
−
−
=
⎢
⎥
⎢
⎥
⎢
⎥
−
⎣
⎦
 & 
0
0
-0.5849
B
0
0
⎡
⎤
⎢
⎥
⎢
⎥
⎢
⎥
=
⎢
⎥
⎢
⎥
⎢
⎥
⎣
⎦
 
(28) 
To track the target successfully, the closed-loop tracking system must be fast enough. To 
improve the flying qualities of this airplane more short-period damping is needed. A short 
period mode damping ratio of 0.7 was chosen to have gives a good margin of stability. 
Therefore, the pole placement method is employed to give the augmented aircraft the 
following closed loop characteristic polynomial  
2
2
( )
(
0.00019)(
11.2
64)(
0.12
0.0684)
aug s
s
s
s
s
s
Δ
=
+
+
+
+
+
. The feedback gain matrix required 
to give the augmented aircraft the characteristic polynomial was determined 
[
]
K
0.1411
85.6292
17.6339
14.6896
0.0004
=
−
−
−
−
 

 
Advances in Flight Control Systems 
 
266 
4. Intelligent control techniques 
Intelligent control achieves automation via the emulation of biological intelligence. It either 
seeks to replace a human who performs a control task or it borrows ideas from how 
biological systems solve problems and applies them to the solution of control problems. In 
this section we will provide an overview of several techniques used for intelligent control 
and discuss challenging industrial application domains where these methods may provide 
particularly useful solutions. The objective here is not to provide a comprehensive 
treatment. We only seek to present the basic ideas to give a favor of the approaches. 
A. Neural Net-based Control Design 
Artificial 
neural 
networks 
are 
circuits, 
computer 
algorithms, 
or 
mathematical 
representations loosely inspired by the massively connected set of neurons that form 
biological neural networks. The success of neural networks is mainly attributed to their 
unique features: 
1. 
Parallel structures with distributed storage and processing of massive amounts of 
information.  
2. 
Learning ability made possible by adjusting the network interconnection weights and 
biases based on certain learning algorithms. 
The neural flight control architecture is based upon the augmented model inversion 
controller, developed by Rysdyk and Calise [23]. The NN adaptation rule results from 
nonlinear stability analysis, which ensures that the error signals and network weights are 
bounded. One of the common methods for controlling nonlinear dynamical systems is based 
on approximate feedback linearization [24]. The form that is employed in each control 
channel depends on the relative degree of the controlled variable. To simplify our 
discussion, we assume that the system has full relative degree, where each controlled 
variable (element of the state vector x) has a relative degree of two 
 
 
( , , )
x
f x x δ
=


 
(29) 
In the case of aircraft, typically ,
x
R
δ ∈
, where the element of x correspond to the pitch attitude 
angle. A variant of this form arises in which angular rate is controlled. Here, the equation of 
motion for that degree of freedom is expressed in first order form [25]. A pseudo-control ν is 
defined such that the dynamic relation between it and the system state is linear 
 
( , , )
v
f x x δ
=

 
(30) 
Ideally, the actual controls δ are obtained by inverting Eq. (30). The total pseudo control 
signal is constructed of three components  
 
rm
pd
ad
ν
ν
ν
ν
=
+
−
 
(31) 
where 
rm
ν
the pseudo-control component is generated by the reference model, 
pd
ν
is the 
output of the linear compensator, and 
ad
ν
is generated by the adaptive element introduced 
to compensate for the model inversion error. The linear compensator is designed so that the 
error dynamics are stabilized. This is most often achieved using standard proportional-
derivative (PD) controllers, although additional integral action can be incorporated to 
improve steady state performance. For the second order system, PD compensation is 
expressed by 
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
267 
 
[
]
pd
P
D
K
K
e
ν
=
 
(32) 
The compensator gain matrices 
,
P
D
K
K
R
∈
are chosen so that the tracking error dynamics 
given by 
 
[
]
ad
e
Ae
B v
=
+
−Δ

 
(33) 
 
0
0
,
P
D
I
A
B
K
K
I
⎡
⎤
⎡⎤
=
=
⎢
⎥
⎢⎥
−
−
⎣
⎦
⎣⎦
 
(34) 
are stable, i.e., the eigenvalues of A are prescribed. It is evident from Eq. (33) that the role of 
the adaptive component
ad
v
 is to cancel Δ .The adaptive signal is chosen to be the output of 
a single hidden layer [26]. 
 
(
)
T
T
ad
W
V x
ν
σ
=
 
(35) 
where V and W are the input and output weighting matrices, respectively, and σ is a 
sigmoid activation function.  Although ideal weighting matrices are unknown and usually 
cannot be computed, they can be adapted in real time using the following NN weights 
training rules [27]: 
 
(
)
T
T
W
W
V x e PB
e W
σ
σ
κ
⎡
⎤
′
= −
−
+
Γ
⎣
⎦

 
(36) 
 
T
T
V
V
xe PBW
e V
κ
⎡
⎤
= −Γ
+
⎣
⎦

 
(37) 
where 
,
W
V
Γ
Γ and 
,
W
V
Γ
Γ are the positive definite learning rate matrices, and κ is the e-
modification parameter. Here, P is a positive definite solution of the Lyapunov equation 
0
T
A P
PA
Q
+
+
=
for any positive definite Q . 
B. Fuzzy Logic-Based Control Design 
The existing applications of fuzzy control range from micro-controller based systems in 
home applications to advanced flight control systems. The main advantages of using fuzzy 
are as follows:  
1. 
It is implemented based on human operator’s expertise which does not lend itself to 
being easily expressed in conventional proportional integral-derivative parameters of 
differential equations, but rather in action rules.  
2. 
For an ill-conditioned or complex plant model, fuzzy control offers ways to implement 
simple but robust solutions that cover a wide range of system parameters and, to some 
extent, can cope with major disturbances. 
The aircraft landing procedures admit a linguistic describing. This is practiced, for example, 
in case of guiding for landing in non-visibility conditions or in piloting learning. This 
approach permits to build a model for landing control based on the reasoning rules using 
the fuzzy logic. The process requires the control of the following parameters: the current 
altitude to runway surface (H), the aircraft's vertical speed and aircraft flight speed. The goal 
of the control is formulated as follow: the aircraft should touch the runway (H becomes 0) at 
the conventional point of landing with admitted vertical touch speed and the recommended 

 
Advances in Flight Control Systems 
 
268 
landing speed. The input of FLC normally includes the error between the state variable and 
its set point, (
)
d
e
x
x
=
−
 and the first derivative of the error, e . A typical form of the 
linguistic rules is represented as  
Rule i Th: If e  is 
i
A  and e  is 
i
B  then 
*
u  is 
i
C  
Where 
i
i
A ,B , and 
i
C  are the fuzzy sets for the error, the error rate, and the controller 
output at rule i, respectively, and 
*
u  is the controller output. 
The resulting rule base of FLC is shown in Table 2. The abbreviations representing the fuzzy 
sets N, Z, P, S, and B in linguistic form stand for negative, zero, positive, small, and big, 
respectively, for example negative big (NB). Five fuzzy sets in triangular membership 
functions are used for FLC input variables, e  and e , and FLC output, 
*
u . For the fuzzy 
inference or rule firing, Mamdani-type min-max composition is employed. In the 
defuzzification stage, by adopting the method of center of gravity, the deterministic control 
u  is obtained. The membership functions have been designed for input and output diagram 
using the trapezoidal shapes, as shown in Figures 1, 2. The fuzzy control system design with 
a simple longitudinal aircraft model given by Eqs. (1-6).  
Advantages over Conventional Designs 
1. 
Fuzzy guidance and control provides a new design paradigm such that a control 
mechanism based on expertise can be designed for complex, ill-defined flight dynamics 
without knowledge of quantitative data regarding the input-output relations, which are 
required by conventional approaches.  A fuzzy logic control scheme can produce a higher 
degree of automation and offers ways to implement simple but robust solutions that cover 
a wide range of aerodynamic parameters and can cope with major external disturbances.  
2. 
Artificial Neural networks constitute a promising new generation of information 
processing systems that demonstrate the ability to learn, recall, and generalize from 
training patterns or data. This specific feature offers the advantage of performance 
improvement for ill-defined flight dynamics through learning by means of parallel and 
distributed processing. Rapid adaptation to environment change makes them 
appropriate for guidance and control systems because they can cope with aerodynamic 
changes during flight.  
5. Simulation results and discussion 
Simulations are performed at sea level, airspeed of 210 ft/s, corresponding to the flare 
maneuver configuration of the Boeing 727. The simulation results are presented in Figs 3 to 
8. Figure 3, which depicts the flight speed variation, demonstrates that the engines can 
regulate slight speed until that is compromised for attitude rate control. Time histories of the 
controls are shown in Fig. 4. The time response of pitch angle is shown in fig.5. A 
comparison between the commanded altitude profile and the actual aircraft response is 
presented in Fig. 6, it shows that the difference between the actual and desired trajectory 
(the fuzzy logic, neural net-based adaptive and optimal controls) is kept less than about 6ft. 
This figure, so shows that the sink rate (the rate of descent) is reduced to less than 1.0 ft/sec, 
which is small enough to achieve a smooth landing. The fuzzy logic, neural net-based 
adaptive and optimal control approaches do the flare maneuver well, while the Pole 
Placement Method has substantially large error. Neural network adaptation signal vad for 
compensate inversion error is presented in Fig. 7. Summarizing the results presented so far, 
the nonlinear controller performance for this maneuver has been found very good. 
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
269 
-5
0
5
10
15
0
0.2
0.4
0.6
0.8
1
Height
Degree of membership
NB
NS
Z
PS
PB
 
Fig. 1. Altitude Membership Functions 
 
-20
-15
-10
-5
0
5
0
0.2
0.4
0.6
0.8
1
Force
Degree of membership
NB
NS
Z
PS
PB
 
Fig. 2. Force Membership Functions 

 
Advances in Flight Control Systems 
 
270 
0
1
2
3
4
5
6
7
8
204
205
206
207
208
209
210
211
Speed (ft/s)
Time
NN
optimal
fuzzy
poleplace
 
Fig. 3. Time response of the airspeed 
 
0
1
2
3
4
5
6
7
8
-12
-10
-8
-6
-4
-2
0
de (deg)
Time
NN
optimal
fuzzy
poleplace
 
Fig. 4. Time response of the elevator 
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
271 
0
1
2
3
4
5
6
7
8
8
8.5
9
9.5
10
10.5
11
11.5
12
pitch angle (deg)
Time
NN
optimal
fuzzy
poleplace
 
Fig. 5. Time response of the pitch angle 
 
0
1
2
3
4
5
6
7
8
-10
-5
0
5
10
15
20
25
30
35
Altitude (m)
Time
NN
NN
optimal
fuzzy
fuzzy
poleplace
poleplace
command
 
Fig. 6. Desired and actual flare trajectories 

 
Advances in Flight Control Systems 
 
272 
0
1
2
3
4
5
6
7
8
-0.08
-0.06
-0.04
-0.02
0
0.02
0.04
ouput neural network
Time
neural network(NN)
 
Fig. 7. NN adaptation signal 
ad
ν
 
 
0
1
2
3
4
5
6
7
8
-0.07
-0.06
-0.05
-0.04
-0.03
-0.02
-0.01
0
0.01
Lambda q
Time
optimal
 
Fig. 8. Time response of the 
q
λ  
www.ebook3000.com

Comparison of Flight Control System Design Methods in Landing   
 
273 
6. Conclusions  
It has been the general focus of this paper to summarize the basic knowledge about 
intelligent control structures for the development of control systems. For completeness, 
conventional, adaptive neural net-based, fuzzy logic-based, control techniques have been 
briefly summarized. Our particular goal was to demonstrate the potential intelligent control 
systems for high precision maneuvers required by aircraft landing. The proposed model 
reveals the functional aspect for realistic simulation data. The method does not require the 
existing controller to be designed based on a linear model.  
 
*
α
12deg
=
 
max
α
17.2
=
 
6
yI
3
10
=
×
 
2
g
32.2ft
=
 
0
B
0.1552
=
 
0
C
0.7125
=
 
4
2
S
0.156
10 ft
=
×
 
1
1
B
0.12369rad−
=
 
W
150000Ib
=
 
2
2
B
2.4203rad−
=
 
1
1
C
6.0877rad−
=
 
2
2
C
9.0277rad−
= −
 
Table 1. model parameter data B-727 
 
Fuzzy set, e  
PB 
PS 
Z 
NS 
NB 
Fuzzy set, e 
NS 
PS 
PS 
PB 
PB 
NB 
NB 
NS 
PS 
PS 
PB 
NS 
NB 
NS 
Z 
PS 
PB 
Z 
NB 
NS 
NS 
PS 
PB 
PS 
NB 
NB 
NS 
NS 
PS 
PB 
Table 2. Rule base for FLC 
7. References 
[1] Chicago, IL, U.S.A. Locke, A. S., Guidance, D. Van Nostrand Co., Princeton, NJ, U.S.A (1955). 
[2] Bryson, A. E., Jr. and Y. C. Ho, Applied Optimal Control., Blaisdell, Waltham, MA, U.S.A 
(1969). 
[3] Lin, C. F., Modern Navigation, Guidance, and Control Processing, Prentice-Hall, Englewood 
Cliffs, NJ, U.S.A (1991). 
[4] Zarchan, P., Tactical and Strategic Missile Guidance, 2nd Ed., AIAA, Inc., Washington, D.C., 
U.S.A (1994). 
[5] Bezdek, J., "Fuzzy Models: What are they and Why," IEEE Trans. Fuzzy Syst., Vol.1 No.1, 
pp, 1-6 (1993).  
[6] Miller, W. T., R. S. Sutton, and P. J. Werbos., Neural Networks for Control., MIT Press, 
Cambridge, MA, U.S.A. Mishra (1991). 
[7] Narendra, K. S. and K. Parthasarthy., Identification and control of dynamical systems using 
neural networks. IEEE Trans. Neural Networks, 1(1), 4-27 (1990). 

 
Advances in Flight Control Systems 
 
274 
[8] Mamdani, E. H. and S. Assilian., An experiment in linguistic synthesis with a fuzzy logic 
controller. Int. J. Man Machine Studies, 7(1), 1-13 (1975). 
[9] Lee, C. C., Fuzzy logic in control systems: fuzzy logic controller part I. IEEE Trans. Syst. 
Man and Cyb., 20(2), 404-418 (1990). 
[10] Lee, C. C., Fuzzy logic in control systems: fuzzy logic controller part II. IEEE Trans. Syst. 
Man and Cyb., 20(2), 419-435 (1990). 
[11] Driankov, D., H. Hellendoorn, and M. Reinfrank., "An Introduction to Fuzzy Control". 
Springer, Berlin, Germany. Driankov (1993). 
[12] Dash, P. K., S. K. Panda, T. H. Lee and J. X. Xu., Fuzzy and neural controllers for dynamic 
systems: an overview. Proc. Int. Conf. Power Electronics, Drives and Energy Systems, 
Singapore (1997). 
[13] BULIRSCH,R., F. Montone, and H. Pesch, "Abort Landing in the Presence of Windshear 
as a minimax optimal Control Problem, Part 1: Necessary Conditions", J. Opt. 
Theory Appl., Vol. 70,pp. 1-23 (1991). 
[14] Price, C. F. and R. S. Warren, "Performance Evaluation o f Homing Guidance Laws for 
Tactical Missiles," TASC Tech (1973). 
[15] Nesline, F. W., B. H. Wells, and P. Zarchan, "Combined optimal/classical approach to 
robust missile autopilot design," AIAA J. Guid. Contr., Vol.4,No.3, pp.316-322 (1981). 
[16] Nesline, F.W. and M.L. Nesline, “How Autopilot Requirements Constrain the 
Aerodynamic Design of Homing Missiles,” Proc. Amer. Contr. Conf., San Diego, CA, 
USA, pp.176-730 (1984). 
[17] Stallard, D. V., "An Approach to Autopilot Design for Homing Interceptor Missiles," 
AIAA Paper 91-2612, AIAA, Washington, D.C., U.S.A, pp. 99-113 (1991). 
[18] Lin, C.F., J. Cloutier, and J. Evers, “Missile Autopilot Design Using a Generalized 
Hamiltonian Formulation,” Proc. IEEE 1st Conf. Aero. Contr. Syst., Westlake Village, 
CA, USA, pp. 715-723 (1993). 
[19] Lin, C. F. and S. P. Lee, "Robust missile autopilot design using a generalized singular 
optimal control technique," J. Guid., Contr., Dyna., Vol. 8, No. 4, pp.  498-507 (1985). 
[20] Lin, C. F. Advanced Control System Design. Prentice- Hall, Englewood Cliffs, NJ, U.S.A (1994). 
[21] Stoer J. and R. Burlisch, Introduction to Numerical Analysis, Springer Verlag, New York, (1980).  
[22] Oberle, H.J, "BNDSCO-A Program for the Numerical Solution of Optimal Control 
Problems," Internal Report No.515-89/22, Institute for Flight Systems Dynamics, 
DLR, Oberpfaffenhofen, Germany (1989). 
[23] Rysdyk, R., B. Leonhardt, and A.J. Calise, “Development of an Intelligent Flight 
Propulsion Control System: Nonlinear Adaptive Control,” AIAA- 2000-3943, Proc. 
Guid. Navig. Contr. Conf., Denver, CO, USA (2000). 
[24] Isodori, A., Nonlinear Control Systems, Springer Verlag, Berlin (1989). 
[25] Calise, A. J., S. Lee, and M. Sharma, "Development of a reconfigurable flight control law 
for the X-36 tailless fighter aircraft," Proc. AIAA Guid. Navig. Contr. Conf., Denver, 
CO, USA., AIAA-2000-3940 (2000). 
[26] Hornik, K., M. Stinchcombe, M. and H. White, “Multilayer Feedforward Networks are 
Universal Approximators,” Neural Networks, Vol. 2, pp. 359-366 (1989). 
[27] Johnson, E. and A.J. Calise, “Neural Network Adaptive Control of Systems with Input 
Saturation,” Proc. Amer. Contr. Conf., pp. 3527–3532. (2001). 
www.ebook3000.com

14 
Oscillation Susceptibility of an  
Unmanned Aircraft whose Automatic  
Flight Control System Fails  
Balint Maria-Agneta and Balint Stefan  
West University of Timisoara 
Romania   
1. Introduction   
 
 
 
Interest in oscillation susceptibility of an aircraft was generated by crashes of high 
performance fighter airplanes such as the YF-22A and B-2, due to oscillations that were not 
predicted during the aircraft development. Flying qualities and oscillation prediction, based 
on linear analysis, cannot predict the presence or the absence of oscillations, because of the 
large variety of nonlinear interactions that have been identified as factors contributing to 
oscillations. Pilot induced oscillations have been analyzed extensively in many papers by 
numerical means. 
Interest in oscillation susceptibility analysis of an unmanned aircraft, whose flight control 
system fails, was generated by the need to elaborate an alternative automatic flight control 
system for the Automatic Landing Flight Experiment (ALFLEX) reentry vehicle for the case 
when the existing automatic flight control system of the vehicle fails.  
The purpose of this chapter is the analysis of the oscillation susceptibility of an unmaned 
aircraft whose automatic flight control system fails. The analysis is focused on the research 
of oscillatory movement around the center of mass in a longitudinal flight with constant 
forward velocity (mainly in the final approach and landing phase). The analysis is made in a 
mathematical model defined by a system of three nonlinear ordinary differential equations, 
which govern the aircraft movement around its center of mass, in such a flight. This model 
is deduced in the second paragraph, starting with the set of 9 nonlinear ordinary differential 
equations governing the movement of the aircraft around its center of mass.In the third 
paragraph it is shown that in a longitudinal flight with constant forward velocity, if the 
elevator deflection outruns some limits, oscillatory movement appears. This is proved by 
means of coincidence degree theory and Mawhin's continuation theorem. As far as we 
know, this result was proved and published very recently by the authors of this chapter 
(research supported by CNCSIS-–UEFISCSU, project number PNII – IDEI 354 No. 7/2007) 
and never been included in a book concerning the topic of flight control.The fourth 
paragraph of this chapter presents mainly numerical results. These results concern an Aero 
Data Model in Research Environment (ADMIRE) and consists in: the identification of the range 
of the elevator deflection for which steady state exists; the computation of the manifold of 
steady states; the identification of stable and unstable steady states; the simulation of 
successful and unsuccessful maneuvers; simulation of oscillatory movements.  

 
Advances in Flight Control Systems 
 
276 
2. The mathematical model 
Frequently, we describe the evolution of real phenomena by systems of ordinary differential 
equations. These systems express physical laws, geometrical connections, and often they are 
obtained by neglecting some influences and quantities, which are assumed insignificant 
with respect to the others. If the obtained simplified system correctly describes the real 
phenomenon, then it has to be topologically equivalent to the system in which the small 
influences and quantities (which have been neglected) are also included. Furthermore, the 
simplified system has to be structurally stable. Therefore, when a simplified model of a real 
phenomenon is build up, it is desirable to verify the structural stability of the system. This 
task is not easy at all. What happens in general is that the results obtained in simplified 
model are tested against experimental results and in case of agreement the simplified model 
is considered to be authentic. This philosophy is also adapted in the description of the 
motion around the center of gravity of a rigid aircraft. According to Etkin & Reid, 1996; 
Cook, 1997, the system of differential equations, which describes the motion around the 
center of gravity of a rigid aircraft, with respect to an xyz body-axis system, where xz is the 
plane of symmetry, is: 
 
cos
cos
cos
sin
sin
cos
sin
sin
cos
sin
sin
cos
sin
cos
cos
cos
sin
cos
sin
cos
sin
sin
cos
cos
sin
cos
cos
cos
cos
V
r
q
V
g
X
V
m V
g
V
Y
p
r
V
V
m V
V
p
q
V
g
V
α
β
β
α
β
α
α
β
β
α
β
θ
β
β
β
α
β
α
β
ϕ
θ
α
β
β
α
β
α
α
β
β
α
β
ϕ
⋅
⋅
−
⋅
⋅
−
⋅
⋅
=
⋅
−
⋅
⋅
−
⋅
+
⋅
⋅
+
⋅
=
⋅
⋅
−⋅
⋅
+
⋅
⋅
+
⋅
⋅
⋅
−
⋅
⋅
+
⋅
⋅
= −⋅
+
⋅
⋅
+
⋅
⋅
D
D
D
D
D
D
D
D
(
)
(
)
(
)
(
)
2
2
sin
tan
cos
tan
cos
sin
sin
cos
cos
x
xz
y
z
xz
y
z
x
xz
z
xz
x
y
xz
Z
m V
I
p
I
r
I
I
q r
I
p q
L
I
q
I
I
p r
I
p
r
M
I
r
I
p
I
I
p q
I
q r
N
p
q
r
q
r
q
r
θ
ϕ
ϕ
θ
ϕ
θ
θ
ϕ
ϕ
ϕ
ϕ
ψ
θ
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
+
⎪
⋅
⎪⎨
⋅−
⋅
=
−
⋅⋅+
⋅
⋅
+
⎪
⎪
⎪
⋅
=
−
⋅
⋅−
⋅
−
+
⎪
⎪
⎪
⋅−
⋅
=
−
⋅
⋅
−
⋅⋅+
⎪
⎪
=
+
⋅
⋅
+ ⋅
⋅
⎪
⎪
⎪
=
⋅
−⋅
⎪
⋅
+ ⋅
⎪
=
⎪
⎪
⎪⎩
D
D
D
D
D
D
D
D
 
(1)
     
The state parameters of this system are: forward velocity  V, angle of attack α, sideslip angle 
β, roll rate p, pitch rate q, yaw rate r, Euler roll angle φ, Euler pitch angle θ and Euler yaw 
angle ψ. The constants Ix , Iy and Iz -moments of inertia about the x, y and z-axis, respectively;  
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
277 
Ixz - product of inertia, g -gravitational acceleration; and m - mass of the vehicle. The aero 
dynamical forces X, Y, Z and moments L, M, N are functions of the state parameters and the 
control parameters:  δa - aileron deflection;  δe - elevator deflection; and δr - rudder deflection 
(the body flap, speed break, δc, δca are available as additional controls but, for simplicity, 
they are set to 0 in the analysis to follow). When the automatic flight control system is in 
function, then the control parameters are functions of the state parameters, describing how 
the flight control system works. When the automatic flight control system fails, then the 
control parameters are constant. This last situation will be analyzed in this chapter. 
A flight with constant forward velocity V is defined as a flight for which V = const (i.e. 
0
V =
D
). 
 In a flight with constant forward velocity V the following equalities hold: 
cos
sin
sin
cos
sin
sin
cos
sin
cos
sin
cos
cos
cos
sin
cos
sin
sin
cos
cos
sin
cos
cos
cos
cos
g
X
r
q
V
m V
g
Y
p
r
V
m V
g
Z
p
q
V
m V
β
α
β
α
α
β
β
α
β
θ
β
β
α
β
α
β
ϕ
θ
β
α
β
α
α
β
β
α
β
ϕ
θ
⎧−⋅
⋅
−
⋅
⋅
=
⋅
−
⋅
⋅
−
⋅
+
⎪
⋅
⎪
⎪⋅
=
⋅
⋅
−⋅
⋅
+
⋅
⋅
+
⎨
⋅
⎪
⎪−⋅
⋅
+
⋅
⋅
= −⋅
+
⋅
⋅
+
⋅
⋅
+
⎪
⋅
⎩
D
D
D
D
D
 
(2)  
Replacing V
D
by 0 in the system (1), the equalities(2) are obtained.   
If in a flight with constant forward velocity V one has 
(
)
2
1
2
n
π
β ≡
+
⋅
, then the following 
equalities hold: 
 
(
)
(
)
1
1
sin
0
sin
cos
0
1
cos
cos
0
n
n
g
X
r
V
m V
g
Y
V
m V
g
Z
p
V
m V
θ
ϕ
θ
ϕ
θ
+
⎧−
⋅−
⋅
+
≡
⎪
⋅
⎪
⎪
⋅
⋅
+
≡
⎨
⋅
⎪
⎪−
⋅
+
⋅
⋅
+
≡
⎪
⋅
⎩
 
(3)          
Replacing 
0
β =
D
and 
(2
1)
2
n
π
β ≡
+
⋅
in (2), the equalities (3) are obtained.   
If in a flight with constant forward velocity V one has 
(
)
2
1
2
n
π
β ≠
+
⋅
, then the following equality 
holds: 
 
      
sin
sin
cos
cos
cos
sin
sin
cos
cos
cos
sin
cos
cos
sin
cos
0
Y
g
m
X
Z
m
m
β
ϕ
θ
α
β
θ
α
β
ϕ
θ
β
α
β
α
β
⋅
⋅
−
⋅
⋅
+
⋅
⋅
⋅
+
⋅
+
⎡
⎤
⎣
⎦
+
⋅
⋅
+
⋅
⋅
≡
 
(4)        
Equation (4) is the solvability (compatibility) condition, with respect to 
,
α β
D
D
, of the system 
(2) when 
(
)
2
1
2
n
π
β ≠
+
⋅
.   

 
Advances in Flight Control Systems 
 
278 
If 
(
)
2
1
2
n
π
β ≠
+
⋅
 and equality (4) holds, then the system (2) can be solved with respect to 
,
α β
D
D
,  
obtaining in this way the explicit system of differential equations, which describes the motion around 
the center of mass of the aircraft in a flight, with constant forward velocityV: 
 
(
)
(
)
2
cos
tan
sin
tan
cos
cos
cos
cos
1
sin
sin
cos
sin
cos
1
1
sin
cos
sin
cos
cos
cos
x
xz
y
z
xz
y
z
x
xz
g
q
p
r
V
Z
X
m V
m V
g
Y
p
r
V
m V
I
p
I
r
I
I
q r
I
p q
L
I
q
I
I
p r
I
p
r
α
α
β
α
β
ϕ
θ
α
β
θ
α
α
α
β
β
α
α
ϕ
θ
β
β
=
−
⋅
⋅
−⋅
⋅
+
⋅
⋅
⋅
+
⎡⎣
⋅
⎡
⎤
+
⋅
+
⋅
⋅
−
⋅
⎤⎦
⎢
⎥
⋅
⋅
⎣
⎦
=
⋅
−⋅
+
⋅
⋅
⋅
+
⋅
⋅
⋅−
⋅
=
−
⋅⋅+
⋅
⋅
+
⋅
=
−
⋅
⋅−
⋅
−
D
D
D
D
D
(
)
(
)
2
sin
tan
cos
tan
cos
sin
sin
cos
cos
z
xz
x
y
xz
M
I
r
I
p
I
I
p q
I
q r
N
p
q
r
q
r
q
r
ϕ
ϕ
θ
ϕ
θ
θ
ϕ
ϕ
ϕ
ϕ
ψ
θ
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪⎪
+
⎨
⎪
⎪
⋅−
⋅
=
−
⋅
⋅
−
⋅⋅+
⎪
⎪
⎪
=
+
⋅
⋅
+ ⋅
⋅
⎪
⎪
=
⋅
−⋅
⎪
⎪
⋅
+ ⋅
=
⎪
⎪
⎪
⎪⎩
D
D
D
D
D
 
(5) 
System (5) is obtained solving system (2) with respect to α
D
, β
D
 and replacing in system (1) 
the equations (1)1, (1)2 , (1)3 with the obtained α
D
and β
D
.  
A longitudinal flight is defined as a flight for which the following equalities hold: 
 
0
p
r
β
ϕ
ψ
≡
≡
≡
≡
≡
 and 
0
a
r
δ
δ
=
=
. 
(6) 
A longitudinal flight is possible if and only if 
0
Y
L
N
=
=
=
 for 
0
p
r
β
ϕ
ψ
=
=
=
=
=
 and 
0
a
r
δ
δ
=
=
. 
This result is obtained from (1) taking into account the definition of a longitudinal flight.   
The explicit system of differential equations which describes the motion of the aircraft in a 
longitudinal flight is: 
 
(
)
sin(
)
cos
sin
cos
sin
cos
y
X
Z
V
g
m
m
g
X
Z
q
V
m V
m V
M
q
I
q
α
θ
α
α
α
θ
α
α
α
θ
⎧
=
⋅
−
+
⋅
+
⋅
⎪
⎪
⎪
=
+
⋅
−
−
⋅
+
⋅
⎪⎪
⋅
⋅
⎨
⎪=
⎪
⎪
⎪
=
⎪⎩
D
D
D
D
 
(7) 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
279 
This result is obtained from (1) taking into account the definition of a longitudinal flight.   
In system (7) X, Z, M depend only on 
, ,q
α
θ  and 
e
δ . These dependences are obtained 
replacing in the general expression of the aerodynamic forces and moments: 
0
p
r
β
ϕ
ψ
=
=
=
=
=
 and 
0
a
r
δ
δ
=
=
. 
The explicit system of differential equations which describes the motion around the center of gravity 
of the aircraft in a longitudinal flight with constant forward velocity V is: 
 
(
)
cos
sin
cos
y
g
X
Z
q
V
m V
m V
M
q
I
q
α
θ
α
α
α
θ
⎧
=
+
⋅
−
−
⋅
+
⋅
⎪
⋅
⋅
⎪
⎪=
⎨
⎪
⎪
⎪
=
⎩
D
D
D
 
(8)                          
This system is obtained from (7) taking into account 
0
V =
D
.  
A longitudinal flight with constant forward velocity is possible if the following equalities hold: 
 
0
0
0
a
r
Y
L
N
for
p
r
and
β
ϕ
ψ
δ
δ
=
=
=
=
=
=
=
=
=
=
 
(9) 
 
(
)
sin
cos
sin
0
X
Z
g
m
m
α
θ
α
α
⋅
−
+
⋅
+
⋅
=
 
 (10) 
This result is obtained from system (7), taking into account the fact that V
D
is equal to zero.   
In (8)
,
,
X Z M depend on 
, ,
,
e
q
α
θ δ and V . Taking into account (10), the system (8) can be 
written as: 
 
(
)
(
)
1
cos
sin
tan
cos
y
g
g
Z
q
V
V
m V
M
q
I
q
α
θ
α
θ
α
α
α
θ
⎧
=
+
⋅
−
−
⋅
−
⋅
+
⋅
⎪
⋅
⎪
⎪⎪=
⎨
⎪
⎪
⎪
=
⎪⎩
D
D
D
 
 (11) 
The system (11) describes the motion around the center of gravity of an aircraft in a 
longitudinal flight with constant forward velocity V and defines the general nonlinear 
model. 
In system (11) the functions 
( , , ;
,
)
e
Z
Z
q
V
α
θ δ
=
 and 
( , , ;
,
)
e
M
M
q
V
α
θ δ
=
 are considered 
known. When the automated flight control system fails, 
e
δ  and V are parameters. 
Frequently, in a research environment for the description of the movement around the 
center of the gravity of some types of aircrafts in a flight with constant forward velocity V, 
the explicit system of differential equations (12) is employed by Balint et al., 2009a,b,c; 
2010a,b; Kaslik & Balint, 2007; Goto & Matsumoto, 2000.  
The model defined by equations (12) is called Aero Data Model In a Research Environment  
(ADMIRE). 

 
Advances in Flight Control Systems 
 
280 
System (12) can be obtained from (5) substituting the general aero dynamical forces and moments 
(see for example section 4), assuming that α  and β are small and making the  approximations (13). 
Due to the approximations (13), the ADMIRE model defined by (12) is also called the 
simplified  ADMIRE model.  
The simplified system which governs the longitudinal flight with constant forward velocity V of the 
ADMIRE aircraft is (14). 
System (14) is obtained from (12) for 
0
p
r
β
ϕ
=
=
=
=
, 
0
a
r
c
ca
δ
δ
δ
δ
=
=
=
=
 and defines the 
simplified nonlinear model of the motion around the center of gravity of the aircraft in a 
longitudinal flight with constant forward velocity V.   
In system (14) 
2
2
,
,
,
,
,
,
,
,
, ,
e
e
q
g V z
z
m
m
m
c
a
a m
α
α
δ
α
δ
D
are considered constants (see Section 4). 
 
 
2
1
cos
cos
( ,
)
( )
sin
cos
( ,
)
( )
( )
( )
a
e
r
a
e
r
a
r
p
r
a
e
r
p
r
a
e
r
p
r
a
r
g
q
p
z
y
y
p
y
r
V
y
z
y
g
p
r
z
y
y
p
y
r
V
y
z
y
p
i
q r
l
l
p
l
r
l
l
α
β
δ
δ
δ
α
β
δ
δ
δ
β
δ
δ
α
β
θ
ϕ
α
β
α β
β
β
β
β δ
δ
β δ
β
α
ϕ
θ
α β
β
α β
β
δ
β δ
δ
α
β
α
δ
δ
=
−
⋅
+
⋅
⋅
+
⋅
+
⋅
+
⋅⋅
+
⋅⋅
+
+
⋅
⋅
+
⋅
+
⋅
⋅
=
⋅
−+
⋅
⋅
−
⋅
⋅
+
⋅
−
⋅
−
⋅+
+
⋅
−
⋅
⋅
+
⋅
= −
⋅⋅+
⋅
+
⋅
+
⋅+
⋅
+
⋅
D
D
D
2
2
2
2
3
( )
cos
cos
sin
( ,
)
( ,
)
( )
(
sin
cos )
a
c
e
r
a
ca
r
q
p
r
a
c
e
r
p
r
a
ca
r
q
i
p r
m
m
q
m
p
y
p
y
y
r
g
c
m
a
y
m
V
a
m
y
r
i
p q
n
n
p
n
r
n
n
n
p
q
r
α
β
α
δ
δ
α
δ
δ
β
δ
δ
δ
α
β
β
β
β
β
θ
ϕ
θ
β δ
δ
δ
β δ
β
α β
α β
δ
α
δ
δ
φ
ϕ
ϕ
=
⋅⋅+
⋅
+
⋅−
⋅⋅
+
⋅⋅
+
⋅
+
⋅⋅
+
⎛
⎞
+
⋅
⋅
⋅
−
⋅
⋅
+
⋅
⋅
+
⋅
+
⎜
⎟
⎝
⎠
+
⋅
+
⋅
⋅
= −
⋅⋅+
⋅
+
⋅
+
⋅+
⋅
+
⋅
+
⋅
=
+
⋅
+ ⋅
D
D
D
D
D
tan
cos
sin
sin
cos
cos
q
r
q
r
θ
θ
ϕ
ϕ
ϕ
ϕ
ψ
θ
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪⎪⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⋅
⎪
⎪
=
⋅
−⋅
⎪
⎪
⋅
+ ⋅
⎪
=
⎪⎩
D
D
 
(12) 
 
 
(
)
(
)
(
)
(
)
1
2
2
1
2
2
2
3
2
2
(5)
cos
1;
cos
tan
;
sin
tan
0; cos
1; sin
0
(5)
cos
1
0;
;
0;
;
0;
xz
x
z
y
y
z
z
xz
xz
y
x
z
xz
x
z
xz
xz
x
y
x
xz
y
z
xz
x
z
xz
x
z
xz
in
p
p
r
in
I
I
I
I
I
I
I
I
I
i
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
i
I
I
I
I
I
I
β
α
β
β
α
β
α
α
β
≈
−
⋅
⋅
≈−⋅
−⋅
⋅
≈
≈
≈
⎧
⎪
≈
⎪
⎪
⋅
+
−
−
⋅
−
⎪
≈
≈−
≈
⎨
⋅
−
⋅
−
⎪
⎪
+
−
⋅
⋅
−
−
⎪
≈−
≈
⎪
⋅
−
⋅
−
⎩
 (13) 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
281 
 
2
2
cos
cos
sin
e
e
e
q
e
g
q
z
z
V
g
c
q
m
m
q
m
a
m
V
a
q
α
α
δ
α
δ
α
θ
α
δ
α
θ
θ
δ
θ
⎧
=
+
⋅
+
⋅
+
⋅
⎪
⎪
⎪
⎛
⎞
=
⋅
+
⋅
+
⋅
⋅
−
⋅
⋅
+
⋅
⎨
⎜
⎟
⎝
⎠
⎪
⎪
=
⎪
⎩
D
D
D
D
 
 (14) 
3. Theoretical proof of the existence of oscillatory movements 
Interest in oscillation susceptibility of an aircraft is generated by crashes of high 
performance fighter airplanes such as the YF-22A and B-2, due to oscillations that were not 
predicted during the aircraft development (Mehra & Prasanth, 1998).Flying qualities and 
oscillation prediction are based on linear analysis and their quasi-linear extensions. These 
analyses cannot, in general, predict the presence or the absence of oscillations, because of the 
large variety of nonlinear interactions that have been identified as factors contributing to 
oscillations. The effects of some of these factors have been reported by Mehra et al., 1977; 
Shamma & Athans, 1991; Kish et al., 1997; Klyde et al., 1997.  The oscillation susceptibility 
analysis in a nonlinear model involves the computation of nonlinear phenomena including 
bifurcations, which lead sometimes to large changes in the stability of the aircraft. 
Interest in oscillation susceptibility analysis of an unmanned aircraft, whose flight control 
system fails, was generated by the elaboration of an alternative automatic flight control for 
the case when the existing automatic flight control system of the aircraft fails Goto & 
Matsumoto, 2000. Numerical results concerning this problem for the ALFLEX unmanned 
reentry vehicle, considered by Goto & Matsumoto, 2000, for the final approach and landing 
phase are reported by Kaslik et al., 2002; 2004 a; 2004 b; 2005 a; 2005 b; 2005 c; Caruntu et al., 
2005. 
A theoretical proof of the existence of oscillatory solutions of the ALFLEX unmanned 
reentry vehicle in a longitudinal flight with constant forward velocity and decoupled flight 
control system is reported Kaslik & Balint, 2010. Numerical results related to oscillation 
susceptibility analysis along the path of the longitudinal flight equilibriums of a simplified 
ADMIRE-model, when the automated flight control system fails are reported by Balint et al., 
2009 a; 2009 b; 2009 c; 2010 a. 
In this section we give a theoretical proof of the existence of oscillatory solutions in 
longitudinal flight in the simplified ADMIRE model of an unmanned aircraft, when the 
flight control system fails. This result was established by Balint et al., 2010b. 
The simplified system of differential equations which governs the motion around the center 
of mass in a longitudinal flight with constant forward velocity of a rigid aircraft, when the 
automatic flight control system fails, is given by (see Balint et al., 2010b): 
 
2
2
cos
cos
sin
e
e
e
q
e
g
z
q
z
V
g
c
q
m
m
q
m
a
m
V
a
q
α
δ
α
α
δ
α
α
θ
δ
α
θ
θ
δ
θ
⎧
=
⋅
+
+
⋅
+
⋅
⎪
⎪
⎪
⎛
⎞
=
⋅
+
⋅
+
⋅
⋅
−
⋅
⋅
+
⋅
⎨
⎜
⎟
⎝
⎠
⎪
⎪
=
⎪⎩
D
D

D
 
(15) 

 
Advances in Flight Control Systems 
 
282 
In this system, the state parameters are: angle of attack α , pitch rate q  and Euler pitch 
angle θ . The control parameter is the elevator angle 
e
δ . V is the forward velocity of the 
aircraft, considered constant and g  is the gravitational acceleration.  
The aero dynamical data appearing in (15) are given in section 4. 
The following proposition (Balint et al., 2010b) addresses the existence of equilibrium states 
for the system (15). 
Proposition 1. (
)
,
T
q
α
θ
 is an equilibrium state of the system (15) corresponding to 
e
δ  if and only 
if α is a solution of the equation: 
 
2
2
0
e
e
A
B
C
D
α
δ
α
δ
⋅
+
⋅
⋅
+
⋅
+
=
 
(16) 
q  is equal to zero and θ  is a solution of the equation: 
 
cos
e
e
V z
z
g
α
δ
θ
α
δ
⎡
⎤
= −
⋅
+
⋅
⎣
⎦ 
(17) 
where A, B, C, D are given by: 
 
(
)
(
) (
)
(
)
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
e
e
e
e
e
e
c
A
m
m
z
a
z
a
c
B
m
m
z
m
m
z
a
z
z
a
c
C
m
m
z
a
z
a
g
c
D
a
V
a
α
α
α
α
α
α
α
δ
α
δ
α
δ
δ
α
δ
δ
=
−
⋅
+
⋅
⋅
=
⋅
−
⋅
⋅
−
⋅
+
⋅
⋅
⋅
⋅
=
−
⋅
+
⋅
⋅
= −
⋅
⋅




  
(18) 
Proof. By computation.   
Proposition 2. Equation (16) has real solutions if and only if  
e
δ  satisfies: 
 
2
4
4
e
A D
B
A C
δ
⋅
⋅
≤
−
⋅
⋅
 
(19) 
Proof. By computation.   
Proposition 3. If  
0
zα <
 and α is a real solution of Eq.(16), then Eq.(17) has a solution if and only 
if for α  the following inequality holds: 
 
1
1
e
e
e
e
g
g
z
z
z
V
z
V
δ
δ
α
α
δ
α
δ
⎡
⎤
⎡
⎤
⋅
−
⋅
≤
≤−
⋅
+
⋅
⎢
⎥
⎢
⎥
⎣
⎦
⎣
⎦
 
 (20) 
Proof. By computation.   
Remark. For 
0
e
δ =
 the solutions of Eq.(16) are: 
 
(
)
2
2
2
2
2
2
2
2
2
2
2
2
2
2
g
c
a
V
a
c
a
z
m
m
z
a
α
α
α
α
α
⋅
⋅
= ±
⋅
⋅
+
−
⋅

 
(21) 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
283 
and both verify (20) for 
0
zα <
. 
In the following assume that 
0
zα <
 and consider 
e
δ , 
e
δ  defined as follows: 
{
}
inf
0,
.(16)
(20)
e
e
e
a real solution of eq
for which
holds
δ
δ
δ
=
<
∃
 
{
}
sup
0,
.(16)
(20)
e
e
e
a real solution of eq
for which
holds
δ
δ
δ
=
>
∃
 
Let I be the closed interval 
[
,
]
e
e
I
δ δ
=
. 
Proposition 4. 
a. If 
e
I
δ ∈, then for the system (15) there exists a countable infinity of equilibriums corresponding to 
e
δ , namely for any n
Z
∈
 
      
(
)
(
)
2
2
2
1,2
1,2
1
4
;
0;
2
2
2
arccos
e
e
e
e
n
e
B
B
A
C
D
q
A
A
V
n
z
z
g
α
δ
α
δ
δ
δ
θ
π
α
δ
±
⎛
= −
⋅
±
⋅
⋅
−
⋅
⋅
⋅
+
=
⎜
⋅
⋅
⎝
⎞
⎡
⎤
=
⋅
⋅
±
⋅−
⋅
−
⋅
⎟
⎢
⎥⎟
⎣
⎦⎠
 
b. If 
{
}
,
e
e
e
I
δ
δ
δ
∈∂=
, then the equilibriums corresponding to 
e
δ  are saddle-node bifurcation points. 
c. If 
e
I
δ ∈, then for the system (15) there are no equilibriums corresponding to 
e
δ .  
Proof. By computation.   
Proposition 4 translates into the following necessary and sufficient condition for the 
existence of equilibrium states for (15): 
,
e
e
e
I
δ
δ
δ
⎡
⎤
∈= ⎣
⎦. At 
,
e
e
δ
δ
δ
=
 saddle-node 
bifurcation occurs. 
It can be easily verified that the following proposition is valid. 
Proposition 5.  
a. If (
)
( ), ( ), ( ) T
t
q t
t
α
θ
is a solution of the system (15), then 
( )t
θ
is a solution of the third  order 
differential equation: 
 
(
)
(
)
2
2
2
2
sin
cos
cos
sin
e
e
q
q
e
g
c
z
m
z
m
m
m
a
V
a
g
g
c
m
z
m
z
a
m
z
z
m
V
V
a
α
α
α
α
α
α
α
α
δ
α
δ
α
θ
θ
θ
θ
θ
θ
θ
δ
⎡
⎤
⎛
⎞
−
+
⋅
+
⋅
−
+
⋅
⋅
+
⋅
⋅
⋅
=
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦
⎛
⎞
=
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
+
⋅
−
⋅
⋅
⎜
⎟
⎝
⎠
D




 
(22) 
b. If ( )t
θ
 is a solution of (22), then  
2
2
1
( )
cos
sin
( )
( )
( )
( )
e
q
e
g
c
t
m
m
a
m
m
V
a
q t
t
t
t
α
δ
α
α
θ
θ
θ
θ
δ
θ
θ
θ
⎡
⎤
⎛
⎞
=
⋅
−
⋅
−
⋅
⋅
−
⋅
⋅
−
⋅
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦
=
=




 
is a solution of the system (15). 
Proof. By computation.   

 
Advances in Flight Control Systems 
 
284 
A solution 
( )t
θ
of Eq.(22) is called monotonic oscillatory solution if the derivative 
( )t
θ
 is a 
strictly positive or a strictly negative periodic function. 
Proposition 6. a. If there exists an increasing oscillatory solution 
( )t
θ
of Eq.(22)and 
0
T >
is the 
period of 
( )t
θ
, then there exists 
*
n
N
∈
 such that 
(
)
( )
2
t
T
t
n
θ
θ
π
+
=
+
and there exists a 2nπ - 
periodic solution ( )
x s of the equation: 
 
(
)
(
)
2
2
2
2
3
2
2
"
2( ')
'
sin
cos
cos
sin
e
e
x
x
q
q
x
e
g
c
x
x
z
m
x e
z
m
m
m
s
a
s
e
V
a
g
g
c
m
z
m
s
z
a
s
m
z
z
m
e
V
V
a
α
α
α
α
α
α
α
α
δ
α
δ
α
δ
⎡
⎤
⎛
⎞
=
+
+
⋅
⋅
+
⋅
−
+
⋅
⋅
+
⋅
⋅
⋅
−
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦
⎡
⎤
⎛
⎞
−
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
+
⋅
−
⋅
⋅
⋅
⎜
⎟
⎢
⎥
⎝
⎠
⎣
⎦
D

 
(23) 
satisfying  
 
2
( )
0
n
x s
e
ds
T
π
⋅
=
∫
 
(24) 
b. If for 
*
n
N
∈
 there exists a 2nπ - periodic solution ( )
x s of Eq.(23), then there exists an increasing 
oscillatory solution ( )t
θ
of Eq.(22) satisfying (
)
( )
2
t
T
t
n
θ
θ
π
+
=
+
, where T is given by (24). 
Proof. See Balint et al., 2010b. 
In order to prove that Eq.(22) has an increasing oscillatory solution, it is sufficient to prove 
that there exists a 2nπ - periodic solution of the Eq.(23). 
Denoting 
1
x
x
=
 and 
2
2
(
)
'
x
x
q
x
z
m
e
x e
α
−
−
= −
+
⋅
−
⋅
, eq.(23) is replaced by the system: 
 
(
)
(
)
1
1
1
2
1
2
2
2
2
2
2
'
(
)
'
cos
sin
sin
cos
e
e
x
x
q
x
e
q
x
z
m
e
x
e
g
g
c
x
z
m
m
z
m
z
m
s
z
a
s
e
V
V
a
g
c
z
m
m
m
s
a
s
V
a
α
α
δ
α
δ
α
α
α
α
α
α
α
δ
= −
+
⋅
−
⋅
⎡
⎤
=
−
⋅
+
⋅
⋅
+
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
⋅
−
⎢
⎥
⎣
⎦
⎡
⎤
⎛
⎞
−
⋅
−
+
⋅
⋅
+
⋅
⋅
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦


 (25) 
Proposition 7. a. If there exists a decreasing oscillatory solution ( )t
θ
of (22) and 
0
T >
 is the period 
of  
( )t
θ
, then there exists 
*
n
N
∈
such that 
(
)
( )
2
t
T
t
n
θ
θ
π
+
=
−
and there exists a 2nπ - periodic 
solution ( )
x s of the equation: 
 
(
)
(
)
2
2
2
2
3
2
2
"
2( ')
'
sin
cos
cos
sin
(
)
e
x
x
q
q
x
e
e
g
c
x
x
z
m
x e
z
m
m
m
s
a
s
e
V
a
g
g
c
m
z
m
s
z
a
s
m
z
m
e
V
V
a
α
α
α
α
α
α
α
α
α
α
δ
δ
δ
⎡
⎤
⎛
⎞
=
−
+
⋅
⋅
+
⋅
−
+
⋅
⋅
+
⋅
⋅
⋅
+
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦
⎡
⎤
+
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
+
⋅
−
⋅
⋅
⋅
⎢
⎥
⎣
⎦


 
(26) 
satisfying 
 
2
( )
0
n
x s
T
e
ds
π
=
⋅
∫
 
(27) 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
285 
b. If for 
*
n
N
∈
, there exists a 2nπ - periodic solution 
( )
x s of(26), then there exists a decreasing 
oscillatory solution ( )t
θ
of (22), satisfying (
)
( )
2
t
T
t
n
θ
θ
π
+
=
−
with T given by (27). 
Proof. See Balint et al., 2010b. 
It follows that in order to prove that Eq.(22) has a decreasing oscillatory solution, it is 
sufficient to prove that there exists a 2nπ - periodic solution of the Eq.(26). 
Denoting by 
1
x
x
=
 and 
2
2
(
)
'
x
x
q
x
z
m
e
x e
α
−
−
=
+
⋅
+
⋅
 Eq.(26) is replaced by the system: 
 
(
)
(
)
1
1
1
2
1
2
2
2
2
2
2
'
(
)
'
cos
sin
sin
cos
e
e
x
x
q
x
e
q
x
z
m
e
x
e
g
g
c
x
z
m
m
z
m
z
m
s
z
a
s
e
V
V
a
g
c
z
m
m
m
s
a
s
V
a
α
α
δ
α
δ
α
α
α
α
α
α
α
δ
=
+
⋅
+
⋅
⎡
⎤
=
−
⋅
+
⋅
⋅
+
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
⋅
⎢
⎥
⎣
⎦
⎡
⎤
⎛
⎞
+
⋅
−
+
⋅
⋅
+
⋅
⋅
⎢
⎥
⎜
⎟
⎝
⎠
⎣
⎦


 
(28) 
Hence, in order to show the existence of a decreasing oscillatory solution of Eq.(22) it is 
sufficient to show the existence of a 2nπ - periodic solution of (28). 
For a continuous 2nπ periodic function we define: 
0, 2
max
( )
M
s
n
f
f s
π
∈⎡
⎤
⎣
⎦
=
                
0, 2
min
( )
L
s
n
f
f s
π
∈⎡
⎤
⎣
⎦
=
 
Proposition 8. If f  is a smooth 2nπ periodic function, then 
2
0
1
( )
2
n
M
L
f
f
f s
ds
π
≤
+
⋅
⋅
∫

. 
Proof. See Balint et al., 2010b. 
Let 
,
X Y be two infinite dimensional Banach spaces. A linear operator 
:
L DomL
X
Y
⊂
→
is 
called a Fredholm operator if Ker L has finite dimension and ImL is closed and has finite 
codimension. 
The 
index 
of 
a 
Fredholm 
operator 
L is 
the 
integer 
( )
dim
dimIm
i L
KerL
co
L
=
−
. 
In the following, consider 
:
L DomL
X
Y
⊂
→
a Fredholm operator of index zero, which is 
not 
injective. 
Let 
:
P X
X
→
and 
:
Q Y
Y
→
be 
continuous 
projectors, 
such 
that 
Im , Im
,
KerQ
L
P
KerL X
KerL
KerP
=
=
=
⊕
 
and 
Im
Im
Y
L
Q
=
⊕
. 
The 
operator 
:
Im
P
DomL
KerP
L
L
DomL
KerP
L
∩
=
∩
→
 
is 
an 
isomorphism. 
Consider 
the 
operator 
:
PQ
K
Y
X
→
 defined by 
1(
)
PQ
P
K
K
I
Q
−
=
−
. Let 
X
Ω ⊂
be an open bounded set and 
:
N
Y
Ω →
 be a continuous nonlinear operator. We say that N  is L  compact if 
PQ
K
N is 
compact, QN is continuous and 
(
)
QN Ω is a bounded set in Y . Since ImQ is isomorphic to 
KerL , there exists an isomorphism 
: Im
I
Q
KerL
→
. 
Mawhin, 1972; Gaines & Mawhin, 1977 established the Mawhin’s continuation theorem : Let 
X
Ω ⊂
 be an open bounded set, let L be a Fredholm operator of index zero and let N be L −compact 
on Ω . Assume: 
a.   Lx
Nx
λ
≠
 for any 
(
)
0, 1
λ ∈
and x
DomL
∈∂Ω ∩
. 
b.   QNx ≠ 0 for any x
KerL
∈
∩∂Ω . 

 
Advances in Flight Control Systems 
 
286 
c.  Brouwer degree deg (
,
, 0)
0
B IQN
KerL
Ω ∩
≠
. 
Then Lx
Nx
=
has at least one solution in DomL ∩Ω . 
Consider the Eq.(22) and denote by: 
 
(
)
(
)
2
2
2
2
(
)
sin
cos
sin
e
e
q
q
e
z
m
g
c
z
m
m
m
a
V
a
g
c
m
z
z
m
z
a
V
a
g
m
z
m
V
α
α
α
α
α
δ
α
δ
α
α
α
α
τ
δ
θ
θ
γ
δ
θ
ε
= −
+
⎛
⎞
=
⋅
−
+
⋅
⋅
+
⋅
⋅
⎜
⎟
⎝
⎠
=
⋅
−
⋅
⋅
+
⋅
⋅
⋅
⋅
= −
⋅
−
⋅


 
 (29) 
With these notations Eq.(22) can be written as: 
 
cos
θ
τ θ
δ θ
γ
ε
θ
+
⋅
+
⋅
=
−
⋅



 
 (30) 
As concerns the quantities ,
,
τ δ γ , we make the following assumptions: 
 
0,
0
τ
δ
>
>
 and  
2
4
τ
δ
>
 
(31) 
Remark that the above inequalities can be assured as follows: 
 
(
)
(
)
(
)
2
2
2
2
2
2
2
2
2
2
2
2
2
2
0
0
0
4
(
)
4 (
)
4
q
q
q
q
z
m
g
c
z
m
m
m
a
V
a
g
c
z
m
z
m
m
m
a
V
a
α
α
α
α
α
α
α
α
τ
δ
τ
δ
+
<
⇔
>
⋅
−
>
⋅
+
⋅
⇒
>
+
>
⋅
⋅
−
+
⋅
+
⋅
⇒
>


 
(32)                          
Remark also that since 
0
zα <
 for γ the following inequality holds:  
 
 (
)
(
)
2
2
2
2
e
e
e
e
e
e
g
g
c
c
m
z
z
m
z
a
m
z
z
m
z
a
V
a
V
a
α
δ
α
δ
α
α
δ
α
δ
α
δ
γ
δ
⋅
−
⋅
⋅
−
⋅
⋅
⋅
≥
≥
⋅
−
⋅
⋅
+
⋅
⋅
⋅
 (33)                          
In terms of ,
,
,
τ δ γ ε  the systems (25) and (28) can be written in the forms: 
 
1
1
1
2
1
2
2
'
'
( )
cos
( )
x
x
x
x
e
x
e
x
s
s
e
s
τ
γ
ε
δ
⎧
=
⋅
−
⋅
⎪⎨
=
−
⋅
⋅
−
⎡
⎤
⎪
⎣
⎦
⎩
 
(34) 
and  
 
1
1
1
2
1
2
2
'
'
( )
cos
( )
x
x
x
x
e
x
e
x
s
s
e
s
τ
γ
ε
δ
⎧
= −⋅
+
⋅
⎪⎨
=
−
⋅
⋅
+
⎡
⎤
⎪
⎣
⎦
⎩
 
(35) 
respectively. 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
287 
Theorem 1. If the inequalities (32) hold and 
 
(
)
2
2
e
e
e
g
c
m
z
z
m
z
a
V
a
α
δ
α
δ
α
δ
ε
⋅
−
⋅
⋅
+
⋅
⋅
⋅
>
 
(36) 
then for any 
*
n
N
∈
 the system (2.20) has at least one 2nπ -periodic solution. 
Proof. See Balint et al., 2010b. 
Theorem 2. If inequalities (32) hold and 
 
(
)
2
2
e
e
e
g
c
m
z
z
m
z
a
V
a
α
δ
α
δ
α
δ
ε
⋅
−
⋅
⋅
−
⋅
⋅
⋅
< −
 
(37) 
then for any
*
n
N
∈
the system  (2.21) has at least one 2nπ -periodic solution.  
Proof. See Balint et al., 2010b. 
The conclusion of this section can be summarized as: 
Theorem 3. If inequalities (32) and (36) hold, then for any 
*
n
N
∈
equation (22) has at least one 
solution 
( )t
θ
, such that its derivative ( )t
θ
 is a positive 2nπ -periodic function (i.e. 
( )t
θ
is an 
increasing oscillatory solution). 
If inequalities (32) and (37) hold, then for any 
*
n
N
∈
 equation (22) has at least one solution ( )t
θ
, 
such that its derivative 
( )t
θ
is a negative periodic function (i.e. 
( )t
θ
 is a decreasing oscillatory 
solution). 
4. Numerical examples 
To describe the flight of ADMIRE (Aero Data Model in a Research Environment) aircraft 
with constant forward velocity V , the system of differential equations (12) is employed: 
where: 
( )
( )
e
r
e
r
r
N
y
r
y
y
N
z
a C
z
a C
y
a C
y
a C
y
a C
δ
δ
α
β
α
δ
β
δ
β
β
=
⋅
=
⋅
=
⋅
=
⋅
=
⋅
( ,
)
( ,
)
a
a
p
y
p
y
y
a C
y
a C
δ
δ
α β
α β
=
⋅
=
⋅
2
1
2
m
N
T
m
N
m
a
C
c
C
c
a C
C
a C
α
α
α
α
α
α
⎛
⎞
=
⋅
−
⋅
+
⋅⋅
+
⋅⋅
⎜
⎟
⎝
⎠
D
  
(
)
2
1
e
e
e
e
m
m
N
N
m
a
C
c
C
C
a C
δ
δ
δ
α
δ =
⋅
−
⋅
+
⋅⋅
 
2
2
2
c
c
q
m
q
m
m
m
m
a
C
m
a
C
C
m
a
C
δ
α
α
δ
α
⎛
⎞
=
⋅
=
⋅
+
=
⋅
⎜
⎟
⎝
⎠
D
D
D
 
1
1
1
1
1
( )
( )
( )
( )
r
a
r
a
p
r
p
r
l
l
l
l
l
l
a
C
l
a
C
l
a
C
l
a
C
l
a
C
δ
δ
β
β
δ
δ
α
α
α
α
=
⋅
=
⋅
=
⋅
=
⋅
=
⋅
 
(
)
3
3
n
y
n
a
C
c
C
β
β
β =
⋅
+
⋅
 
(
)
(
)
3
3
( ,
)
( ,
)
,
p
p
p
n
y
n
a
C
c
C
α β
α β
α β
=
⋅
+
⋅
  
3
3
( )
( )
ca
ca
n
n
a
c
Cδ
δ
α
α
=
⋅
⋅
 
( )
(
)
3
3
( ,
)
( ,
)
r
r
r
n
y
n
a
C
c
C
α β
α β
β
=
⋅
+
⋅
  
(
)
3
3
r
r
r
n
y
n
a
C
c
C
δ
δ
δ =
⋅
+
⋅
  
(
)
3
3
a
a
a
n
y
n
a
C
c
C
δ
δ
δ =
⋅
+
⋅
   
( )
(
)
2
2
2
2
2
2
,
p
r
y
r
y
p
y
y
a
c
a C
y
a
c
a C
y
a
c
a C
β
β
β
α β
=
⋅
⋅⋅
=
⋅
⋅⋅
=
⋅
⋅⋅
 
2
2
2
2
r
a
r
a
y
y
y
a
c
a C
y
a
c
a C
δ
δ
δ
δ
=
⋅
⋅⋅
=
⋅
⋅⋅
   
1
1
0.157[
]
0.28[
]
p
T
l
C
rad
C
rad
α
−
−
= −
= −
 
( )
1
1
3.295[
]
(0.344
0.02)[
]
r
N
l
C
rad
C
rad
α
α
α
−
−
=
=
⋅
+
    
1
1.074[
]
e
N
C
rad
δ
−
=
 
1
0.0907[
]
n
C
rad
β
−
=
     
1
1
0.267[
]
0.0846[
]
r
m
n
C
rad
C
rad
δ
α
−
−
=
= −
 
1
0.426[
]
e
m
C
rad
δ
−
= −
 
1
0.051[
]
a
n
C
rad
δ
−
=
       
( )
1
0.2[
]
0.49
0.0145[
]
c
ca
m
n
C
rad
C
rad
δ
δ
α
α
−
=
= −
⋅
+
  

 
Advances in Flight Control Systems 
 
288 
1
1
0.44[
]
1.45[
]
q
m
m
C
rad
C
rad
α
−
−
= −
= −
D
  
2
1 ( )
0.896
0.47
0.04 [
]
C
rad
β α
α
α
=
⋅
−
⋅
−
 
( )
1
1
1
2
0.804[
]
0.185[
]
0.122[
]
2.725
[
]
r
a
r
y
y
y
y
C
rad
C
rad
C
rad
C
rad
δ
δ
β
β
β
−
−
−
=
= −
=
=
⋅
(
)
(
)
2
3
,
6.796
0.315
(0.237
0.498) 10
[
]
p
y
C
rad
α β
α
β
α
−
=
⋅
+
⋅
+
⋅
−
⋅
 
(
) (
)
2
2
,
1.572
0.368
1.07
0.005[
]
r
n
C
rad
α β
α
α
β
=
⋅
−
⋅
−
⋅
−
 
(
)
(
)
2
0.024[
];
0.192[
];
,
2.865
0.3
[
]
r
a
p
n
l
l
C
rad
C
rad
C
rad
δ
δ
α β
α
β
=
=
=
⋅
+
⋅
 
500[
]
0.25
H
m
M
=
=
   
1
3
338[
]
1.16[
]
sa
m s
kg m
ρ
−
−
=
⋅
=
⋅
  
2
1
9.81[
]
84.5[
]
s
g
m s
V
M a
m s
−
−
=
⋅
=
⋅
=
⋅
       
1
/
0.116[
]
g
V
s−
=
 
2
45[
]
5.2[
]
10[
]
S
m
c
m
b
m
=
=
=
  
9100[
]
1.3[
]
0.15
G
e
m
kg
x
m
z
=
=
= −
 
2
2
2
21000[
]
81000[
]
101000[
]
x
y
z
I
kg m
I
kg m
I
kg m
=
⋅
=
⋅
=
⋅
 
1
1
1
1
1
2
3
0.485[
]
88.743[
]
11.964[
]
18.45[
]
a
s
a
s
a
s
a
s
−
−
−
−
= −
=
=
=
1
2
3
0.25
0.029
0.13
c
c
c
=
= −
=
   1
2
3
0.952
0.987
0.594
i
i
i
=
=
=
   
All the other derivatives are equal to zero. 
 The system which governs the longitudinal flight with constant forward velocity V of the 
ADMIRE aircraft, when the automatic flight control fails, is: 
 
2
2
cos
cos
sin
e
e
e
q
e
g
q
z
z
V
g
c
q
m
m
q
m
a
m
V
a
q
α
α
δ
α
δ
α
θ
α
δ
α
θ
θ
δ
θ
⎧
=
+
⋅
+
⋅
+
⋅
⎪
⎪
⎪
⎛
⎞
=
⋅
+
⋅
+
⋅
⋅
−
⋅
⋅
+
⋅
⎨
⎜
⎟
⎝
⎠
⎪
⎪
=
⎪
⎩
D
D
D
D
 
(38)                          
When the automatic flight control system is in function, then 
e
δ  in (38) is given by: 
 
e
q
p
k
k
q
k
α
δ
α
θ
=
⋅
+
⋅
+
⋅
 
 (39) 
with 
0.401;
kα = −
 
284
.1
−
=
qk
and 
1
8
p
k =
÷
. 
System (38) is obtained from the system (12) for
0
0
a
r
c
ca
p
r
β
ϕ
δ
δ
δ
δ
=
=
=
=
=
=
=
=
.  
The equilibriums of (38) are the solutions of the nonlinear system of equations: 
 
2
2
cos
0
cos
sin
0
0
e
e
e
q
e
g
q
z
z
V
g
c
m
m
q
m
a
m
V
a
q
α
δ
α
δ
θ
α
δ
α
θ
θ
δ
α
•
⎧+
⋅
+
⋅
+
⋅
=
⎪
⎪
⎛
⎞
⎪
⋅
+
⋅
+
⋅
⋅
−
⋅
⋅
+
⋅
=
⎨
⎜
⎟
⎝
⎠
⎪
⎪=
⎪⎩
 
(40) 
System (40) defines the equilibriums manifold of the longitudinal flight with constant 
forward velocity V of the ADMIRE aircraft. 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
289 
It is easy to see that (40) implies: 
 
2
2
0
e
e
A
B
C
D
α
δ
α
δ
⋅
+
⋅
⋅
+
⋅
+
=
 
 (41) 
where A,B,C,D are given by: 
(
)
(
) (
)
(
)
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
e
e
e
e
e
e
c
A
m
m
z
a
z
a
c
B
m
m
z
m
m
z
a
z
z
a
c
C
m
m
z
a
z
a
g
c
D
a
V
a
α
α
α
α
α
δ
δ
α
δ
δ
δ
δ
α
α
α
α
•
•
•
•
=
−
⋅
+
⋅
⋅
=
⋅
−
⋅
⋅
−
⋅
+
⋅
⋅
⋅
⋅
=
−
⋅
+
⋅
⋅
= −
⋅
⋅
 
Solving Eq.(41) two solutions α1 = α1(δe) and α2 = α2(δe) are obtained. Replacing in (17) α1 = 
α1(δe) and α2 = α2(δe) the corresponding θ1 =θ1(δe)+2kπ and θ2 =θ2(δe) +2kπ  are obtained (
)
k
Z
∈
. 
Hence a part of the equilibrium manifold MV (
0)
k =
is the union of the following two 
pieces: 
P1 =
(
)
(
)
(
)
{
}
1
1
,0,
e
e
e
I
α
δ
θ
δ
δ ∈
#
;              P2 =
(
)
(
)
(
)
{
}
2
2
,0,
e
e
e
I
α
δ
θ
δ
δ ∈
#
. 
The interval I where 
e
δ varies follows from the condition that the angles 
1(
)
e
α δ
 and 
2(
)
e
α
δ
 
have to be real. 
Using the numerical values of the parameters for the ADMIRE model aircraft and the 
software MatCAD Professional it was found that:  
e
δ = -0.04678233231992 [rad] and  
e
δ = 0.04678233231992[rad]. 
The computed 
1(
)
e
α δ
, 
1(
)
e
θ δ
, 
2(
)
e
α
δ
, 
2(
)
e
θ δ
 are represented on Fig.1, 2. 
Fig.1 shows that 
( )
( )
( )
( )
1
2
1
2
,
e
e
e
e
α
δ
α
δ
α
δ
α
δ
=
=
and 
(
)
(
)
1
2
e
e
α
δ
α
δ
>
 for 
(
)
,
e
e
e
δ
δ δ
∈
. 
Fig.2 shows that 
( )
( )
( )
( )
1
2
1
2
,
e
e
e
e
θ
δ
θ
δ
θ
δ
θ
δ
=
=
 and 
(
)
(
)
1
2
e
e
θ
δ
θ
δ
<
 for 
(
)
,
e
e
e
δ
δ δ
∈
. 
The eigenvalues of the matrix 
(
)
e
A δ
are: λ1= - 22.6334;   λ2= - 1.5765;   λ3= 1.0703 x 10-8 
0
≈
 . 
For 
e
e
δ
δ
>
the equilibriums of P1 are exponentially stable and those of P2 are unstable. These 
facts were deduced computing the eigenvalues of 
(
)
e
A δ
. 
More precisely, it was obtained that the eigenvalues of 
(
)
e
A δ
 are negative at the 
equilibriums of P1 and two of the eigenvalues are negative and the third is positive at the 
equilibriums of P2. Consequently, 
e
δ is a turning point. Maneuvers on P1 are successful and 
on P2  are not successful, Fig.3, 4. 
Moreover, numerical tests show that when 
(
)
',
"
,
e
e
e
e
δ
δ
δ δ
∈
, the maneuver 
'
"
e
e
δ
δ
→
  
transfers the ADMIRE aircraft from the state in which it is at the moment of the maneuver in 
the asymptotically stable equilibrium 
(
)
(
)
(
)
1
1
" ,0,
"
e
e
α
δ
θ
δ
. 

 
Advances in Flight Control Systems 
 
290 
 
Fig. 1. The α1(δe) and  α2(δe) coordinates of the equilibriums on the manifold MV. 
 
 
Fig. 2. The θ1(δe)+2kπ  and  θ2(δe)+2kπ  coordinates of the equilibriums on the manifold MV. 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
291 
 
Fig. 3. A successful maneuver on P1 : 
α11 = 0.078669740237840  [rad]; q11= 0 [rad/s] ; θ11= 0.428832005303479 [rad] → 
 α12 = 0.065516737567037  [rad]; q12= 0 [rad/s] ; θ12= - 0.698066723826469 [rad]  
 
 
Fig. 4. An unsuccessful maneuver on  P2 :  
α 21 = 0.064883075974905 [rad]; q21= 0 [rad/s] ; θ21= 0.767462467841413 [rad] →  
α12 = 0.065516737567037  [rad]; q12= 0 [rad/s] ; θ12= 0.698066723826469 [rad] instead of  
α 21 = 0.064883075974905 [rad]; q21= 0 [rad/s] ; θ21= 0.767462467841413 [rad] → 
α 22 = 0.046845089090947 [rad]; q22= 0 [rad/s] ; θ22= 1.036697186364400 [rad]. 

 
Advances in Flight Control Systems 
 
292 
 
 
 
 
Fig. 5. Oscillation when 
e
δ = - 0.05 [rad] and the starting point is : 
α 1 = 0.086974288419088 [rad]; q1 = 0 [rad/sec]; θ1= 0.159329728679884[rad]. 
 
 
 
 
Fig. 6. Oscillation when 
e
δ =  0.048 [rad] and the starting point is : 
α 1 = 0.086974288419088 [rad]; q1 = 0 [rad/sec]; θ1= 0.159329728679884[rad]. 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
293 
 
The behavior of the ADMIRE aircraft changes when the maneuver 
'
"
e
e
δ
δ
→
 is so that 
(
)
'
,
e
e
e
δ
δ δ
∈
 and 
(
)
"
,
e
e
e
δ
δ δ
∉
 . Computation shows that after such a maneuver α and q 
oscillate with the same period and θ tends to +∞or −∞. (Figs.5, 6) 
The oscillation presented in Figs. 5,6 is a non catastrophic bifurcation, because if 
e
δ is reset,  
then equilibrium is recovered, as it is illustrated in Fig.7. 
 
 
 
 
 
Fig. 7. Resetting 
0.048[
]
e
eo
rad
δ
δ
=
<
 after 3000 [s] of oscillations to 
e
eo
δ
δ
=
, equilibrium is 
recovered. 
7. Conclusion 
For an unmanned aircraft whose automatic flight control system during a longitudinal flight 
with constant forward velocity fails, the following statements hold: 
1. 
If the elevator deflection is in the range given by formula (19), then the movement 
around the center of mass is stationary or tends to a stationary state. 
2. 
If the elevator deflection exceeds the value given by formula (36), then the movement 
around the center of mass becomes oscillatory decreasing and when the elevator 

 
Advances in Flight Control Systems 
 
294 
deflection is less than the value given by formula (37), then the movement around the 
center of mass becomes oscillatory increasing. 
3. 
This oscillatory movement is not catastrophic, because if the elevator deflection is reset 
in the range given by (19), then the movement around the center of mass becomes 
stationary. 
4. 
Numerical investigation of the oscillation susceptibility (when the automatic flight 
control system fails) in the general non linear model of the longitudinal flight with 
constant forward velocity reveals similar behaviour as that which has been proved 
theoretically and numerically in the framework of the simplified model. As far as we 
know, in the general non linear model of the longitudinal flight with constant forward 
velocity the existence of the oscillatory solution never has been proved theoretically. 
5. 
A task for a new research could be the proof of the existence of the oscillatory solutions 
in the general model.  
8. References 
Balint, St.; Balint, A.M. &  Ionita, A. (2009a). Oscillation susceptibility along the path of the 
longitudinal flight equilibriums in ADMIRE model. J. Aerospace Eng. 22, 4 (October 
2009) 423-433 ISSN 0893-1321. 
Balint, St.; Balint, A.M. &  Ionita, A. (2009b). Oscillation susceptibility analysis of the 
ADMIRE aircraft along the path of longitudinal flight equilibrium.  Differential 
Equations and Nonlinear Mechanics 2009. Article ID 842656 (June 2009) 1-26 . ISSN: 
1687-4099 
Balint, St.; Balint, A.M. & Kaslik, E. (2010b) Existence of oscillatory solutions along the path 
of longitudinal flight equilibriums of an unmanned aircraft, when the automatic 
flight control system fails J. Math. Analysis and Applic., 363, 2(March 2010) 366-382. 
ISSN 0022-247X.  
Balint, St.; Kaslik E.; Balint A.M. & Ionita A. (2009c). Numerical analysis of the oscillation 
susceptibility along the path of the longitudinal flight equilibria of a reentry 
vehicle. Nonlinear Analysis:Theory, Methods and applic., 71, 12 (Dec.2009) e35-e54. 
ISSN: 0362-546X 
Balint, St.; Kaslik, E. & Balint, A.M. (2010a). Numerical analysis of the oscillation 
susceptibility along the path of the longitudinal flight equilibria of a reentry 
vehicle. Nonlinear Analysis: Real World Applic., 11, 3 (June 2010)1953-1962.ISSN: 
1468-1218 
Caruntu, B.; Balint, St. & Balint, A.M. (2005). Improved estimation of an asymptotically 
stable equilibrium-state of the ALFLEX reentry vehicle Proceedings of the 5th 
International Conference on Nonlinear Problems in Aviation and Aerospace Science, 
pp.129-136, ISBN: 1-904868-48-7, Timisoara, June 2-4, 2004, Cambridge Scientific 
Publishers, Cambridge.  
Cook, M. (1997). Flight dynamics principles, John Wiley & Sons, ISBN-10: 047023590X, ISBN-
13: 978-0470235904 , New York. 
Etkin, B. & Reid, L. (1996). Dynamics of flight: Stability and Control, John Wiley & Sons, ISBN: 
0-471-03418-5, New York. 
www.ebook3000.com

Oscillation Susceptibility of an Unmanned Aircraft whose Automatic Flight Control System Fails   
 
295 
Gaines, R.&  Mawhin J. (1977). Coincidence Degree and Nonlinear Differential Equations, 
Springer, ISBN: 3-540-08067-8, Berlin – New York.  
Goto, N. & Matsumoto, K.(2000). Bifurcation analysis for the control of a reentry vehicle. 
Proceedings of the 3rd International Conference on Nonlinear Problems in Aviation and 
Aerospace Science,pp.167-175 ISBN 0 9526643 2 1 Daytona Beach, May 10-12, 2000 
Cambridge Scientific Publishers, Cambridge  
Kaslik, E. & Balint, St.. (2007).  Structural stability of simplified dynamical system governing 
motion of ALFLEX reentry vehicle, J. Aerospace Engineering, 20, 4 (Oct. 2007) 215-
219. ISSN 0893-1321. 
Kaslik, E.;  Balint, A.M.; Chilarescu, C. & Balint, St. (2002). The control of rolling maneuver 
Nonlinear Studies, 9,4, (Dec.2002) 331-360. ISSN: 1359-8678 (print) 2153-4373  
(online)   
Kaslik, E.; Balint, A.M.; Grigis, A. & Balint, St. (2004a).  The controllability of the “path 
capture” and “steady descent flight of ALFLEX. Nonlinear Studies, 11,4, (Dec.2004)  
674-690. ISSN: 1359-8678 (print) 2153-4373 (online) 
Kaslik, E.; Balint, A.M.; Birauas, S. & Balint, St. (2004 b). On the controllability of the roll rate 
of the ALFLEX reentry vehicle, Nonlinear Studies 11, 4 (Dec.2004) 543-564. ISSN: 
1359-8678 (print) 2153-4373 (online) 
Kaslik, E.; Balint, A.M.; Grigis, A. & Balint, St. (2005a). On the set of equilibrium states 
defined by a simplified model of the ALFLEX reentry vehicle Proceedings of the 5th 
International Conference on Nonlinear problems in aviation and aerospace science, pp.359-
372.  ISBN: 1-904868-48-7, Timisoara, June 2-4 , 2004, Cambridge Scientific 
Publishers, Cambridge   
Kaslik, E.; Balint, A.M.; Grigis, A. & Balint, St. (2005b) Considerations concerning  
the controllability of a hyperbolic equilibrium state. Proceedings of the 5th 
International Conference on Nonlinear problems in aviation and aerospace science, pp.383-
389 ISBN: 1-904868-48-7, Timisoara, June 2-4 , 2004, Cambridge Scientific 
Publishers, Cambridge   
Kaslik, E.; Balint, A.M.; Grigis, A. & Balint, St. (2005c) Control procedures using domains  
of attraction, Nonlinear Analysis, 63, 5-7, (Nov.-Dec.2005) e2397-e2407 ISSN: 0362-
546X 
Kaslik, E.& Balint, St. (2010). Existence of oscillatory solutions in longitudinal  
flight dynamics. Int. J. Nonlinear Mechanics, 45(2) (March 2010) 159-168. ISSN: 0020-
7462 
Kish, B.A. ; Mosle, W.B. & Remaly, A.S. (1997) A limited flight test investigation of pilot-
induced oscillation due to rate limiting. Proceedings of the AIAA Guidance, 
Navigation, and Control Conference AIAA-97-3703 New Orleans (August 1997) 
1332-1341 
Klyde, D.H.; McRuer, D.T.; & Myers, T.T. (1997). Pilot-induced oscillation analysis and 
prediction with actuator rate limiting. J. Guidance, Control and Dynamics, 20,1, 
(Jan.1997) 81-89 ISSN 0731-5090 
Mawhin, J. (1972). Equivalence theorems for nonlinear operator equations and coincidence 
degree theory, Journal of Differential Equations 12, 3, 610-636 (Nov. 1972). ISSN: 0022-
0396 

 
Advances in Flight Control Systems 
 
296 
Mehra, R.K. & Prasanth, R.K. (1998). Bifurcation and limit cycle analysis of nonlinear pilot 
induced oscillations, (1998) AIAA Paper98-4249 AIIA Atmosphere Flight Mechanics 
Conf., 10-12, August 1998, Boston, MA. 
Mehra, R.K. ; Kessel, W.C. & Carroll, J.V.  (1977). Global stability and control analysis of 
aircraft at high angles of attack. ONR-CR215-248, vol.1-4 (June 1977) 81-153.  
Shamma,I. & Athans, M. (1991). Guaranted properties of gain scheduled control for linear 
parameter varying plants Automatica, 27,3, 559-564 (May 1991), ISSN: 0005-1098. 
www.ebook3000.com

