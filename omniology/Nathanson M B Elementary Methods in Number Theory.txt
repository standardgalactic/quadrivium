Elementary Methods in 
Number Theory
Melvyn B. Nathanson
Springer





To Paul Erd˝os,
1913–1996,
a friend and collaborator for 25 years, and a
master of elementary methods in number theory.

Preface
Arithmetic is where numbers run across your mind looking for
the answer.
Arithmetic is like numbers spinning in your head faster and
faster until you blow up with the answer.
KABOOM!!!
Then you sit back down and begin the next problem.
Alexander Nathanson [99]
This book, Elementary Methods in Number Theory, is divided into three
parts.
Part I, “A ﬁrst course in number theory,” is a basic introduction to el-
ementary number theory for undergraduate and graduate students with
no previous knowledge of the subject. The only prerequisites are a little
calculus and algebra, and the imagination and perseverance to follow a
mathematical argument. The main topics are divisibility and congruences.
We prove Gauss’s law of quadratic reciprocity, and we determine the moduli
for which primitive roots exist. There is an introduction to Fourier anal-
ysis on ﬁnite abelian groups, with applications to Gauss sums. A chapter
is devoted to the abc conjecture, a simply stated but profound assertion
about the relationship between the additive and multiplicative properties
of integers that is a major unsolved problem in number theory.
The “ﬁrst course” contains all of the results in number theory that are
needed to understand the author’s graduate texts, Additive Number Theory:
The Classical Bases [104] and Additive Number Theory: Inverse Problems
and the Geometry of Sumsets [103].

viii
Preface
The second and third parts of this book are more diﬃcult than the “ﬁrst
course,” and require an undergraduate course in advanced calculus or real
analysis.
Part II is concerned with prime numbers, divisors, and other topics in
multiplicative number theory. After deriving properties of the basic arith-
metic functions, we obtain important results about divisor functions, and
we prove the classical theorems of Chebyshev and Mertens on the distribu-
tion of prime numbers. Finally, we give elementary proofs of two of the most
famous results in mathematics, the prime number theorem, which states
that the number of primes up to x is asymptotically equal to x/ log x, and
Dirichlet’s theorem on the inﬁnitude of primes in arithmetic progressions.
Part III, “Three problems in additive number theory,” is an introduction
to some classical problems about the additive structure of the integers. The
ﬁrst additive problem is Waring’s problem, the statement that, for every
integer k ≥2, every nonnegative integer can be represented as the sum
of a bounded number of kth powers. More generally, let f(x) = akxk +
ak−1xk−1 + · · · + a0 be an integer-valued polynomial with ak > 0 such that
the integers in the set A(f) = {f(x) : x = 0, 1, 2, . . .} have no common
divisor greater than one. Waring’s problem for polynomials states that
every suﬃciently large integer can be represented as the sum of a bounded
number of elements of A(f).
The second additive problem is sums of squares. For every s ≥1 we
denote by Rs(n) the number of representations of the integer n as a sum
of s squares, that is, the number of solutions of the equation
n = x2
1 + · · · + x2
s
in integers x1, . . . , xs. The shape of the function Rs(n) depends on the
parity of s. In this book we derive formulae for Rs(n) for certain even
values of s, in particular, for s = 2, 4, 6, 8, and 10.
The third additive problem is the asymptotics of partition functions.
A partition of a positive integer n is a representation of n in the form
n = a1 + · · · + ak, where the parts a1, . . . , ak are positive integers and
a1 ≥· · · ≥ak. The partition function p(n) counts the number of partitions
of n. More generally, if A is any nonempty set of positive integers, the
partition function pA(n) counts the number of partitions of n with parts
belonging to the set A. We shall determine the asymptotic growth of p(n)
and, more generally, of pA(n) for any set A of integers of positive density.
This book contains many examples and exercises. By design, some of
the exercises require old-fashioned manipulations and computations with
pencil and paper. A few exercises require a calculator. Number theory, after
all, begins with the positive integers, and students should get to know and
love them.
This book is also an introduction to the subject of “elementary methods
in analytic number theory.” The theorems in this book are simple state-
ments about integers, but the standard proofs require contour integration,

Preface
ix
modular functions, estimates of exponential sums, and other tools of com-
plex analysis. This is not unfair. In mathematics, when we want to prove a
theorem, we may use any method. The rule is “no holds barred.” It is OK
to use complex variables, algebraic geometry, cohomology theory, and the
kitchen sink to obtain a proof. But once a theorem is proved, once we know
that it is true, particularly if it is a simply stated and easily understood
fact about the natural numbers, then we may want to ﬁnd another proof,
one that uses only “elementary arguments” from number theory. Elemen-
tary proofs are not better than other proofs, nor are they necessarily easy.
Indeed, they are often technically diﬃcult, but they do satisfy the aesthetic
boundary condition that they use only arithmetic arguments.
This book contains elementary proofs of some deep results in number
theory. We give the Erd˝os-Selberg proof of the prime number theorem,
Linnik’s solution of Waring’s problem, Liouville’s still mysterious method
to obtain explicit formulae for the number of representations of an integer
as the sum of an even number of squares, and Erd˝os’s method to obtain
asymptotic estimates for partition functions. Some of these proofs have not
previously appeared in a text. Indeed, many results in this book are new.
Number theory is an ancient subject, but we still cannot answer the
simplest and most natural questions about the integers. Important, easily
stated, but still unsolved problems appear throughout the book. You should
think about them and try to solve them.
Melvyn B. Nathanson1
Maplewood, New Jersey
November 1, 1999
1Supported in part by grants from the PSC-CUNY Research Award Program and the
NSA Mathematical Sciences Program. This book was completed while I was visiting the
Institute for Advanced Study in Princeton, and I thank the Institute for its hospitality.
I also thank Jacob Sturm for many helpful discussions about parts of this book.

Notation and Conventions
We denote the set of positive integers (also called the natural numbers) by
N and the set of nonnegative integers by N0. The integer, rational, real,
and complex numbers are denoted by Z, Q, R, and C, respectively. The
absolute value of z ∈C is |z|. We denote by Zn the group of lattice points
in the n-dimensional Euclidean space Rn.
The integer part of the real number x, denoted by [x], is the largest
integer that is less than or equal to x. The fractional part of x is denoted
by {x}. Then x = [x] + {x}, where [x] ∈Z, {x} ∈R, and 0 ≤{x} < 1. In
computer science, the integer part of x is often called the ﬂoor of x, and
denoted by ⌊x⌋. The smallest integer that is greater than or equal to x is
called the ceiling of x and denoted by ⌈x⌉.
We adopt the standard convention that an empty sum of numbers is
equal to 0 and an empty product is equal to 1. Similarly, an empty union
of subsets of a set X is equal to the empty set, and an empty intersection
is equal to X.
We denote the cardinality of the set X by |X|. The largest element in a
ﬁnite set of numbers is denoted by max(X) and the smallest is denoted by
min(X).
Let a and d be integers. We write d|a if d divides a, that is, if there exists
an integer q such that a = dq. The integers a and b are called congruent
modulo m, denoted by a ≡b
(mod m), if m divides a −b.
A prime number is an integer p > 1 whose only divisors are 1 and p.
The set of prime numbers is denoted by P, and pk is the kth prime. Thus,
p1 = 2, p2 = 3, . . . , p11 = 31, . . . . Let p be a prime number. We write pr∥n

xii
Notation and Conventions
if pr is the largest power of p that divides the integer n, that is, pr divides
n but pr+1 does not divide n.
The greatest common divisor and the least common multiple of the inte-
gers a1, . . . , ak are denoted by (a1, . . . , ak) and [a1, . . . , ak], respectively. If
A is a nonempty set of integers, then gcd(A) denotes the greatest common
divisor of the elements of A.
The principle of mathematical induction states that if S(k) is some state-
ment about integers k ≥k0 such that S(k0) is true and such that the truth
of S(k−1) implies the truth of S(k), then S(k) holds for all integers k ≥k0.
This is equivalent to the minimum principle: A nonempty set of integers
bounded below contains a smallest element.
Let f be a complex-valued function with domain D, and let g be a
function on D such that g(x) > 0 for all x ∈D. We write f ≪g or
f = O(g) if there exists a constant c > 0 such that |f(x)| ≤cg(x) for
all x ∈D. Similarly, we write f ≫g if there exists a constant c > 0
such that |f(x)| ≥cg(x) for all x ∈D. For example, f ≫1 means that
f(x) is uniformly bounded away from 0, that is, there exists a constant
c > 0 such that |f(x)| ≥c for all x ∈D. We write f ≪k,ℓ,... g if there
exists a positive constant c that depends on the variables k, ℓ, . . . such that
|f(x)| ≤cg(x) for all x ∈D. We deﬁne f ≫k,ℓ,... g similarly. The functions
f and g are called asymptotic as x approaches a if limx→a f(x)/g(x) = 1.
Positive-valued functions f and g with domain D have the same order of
magnitude if f ≪g ≪f, or equivalently, if there exist positive constants c1
and c2 such that c1 ≤f(x)/g(x) ≤c2 for all x ∈D. The counting function
of a set A of integers counts the number of positive integers in A that do
not exceed x, that is,
A(x) =

a∈A
1≤a≤x
1.
Using the counting function, we can associate various densities to the set
A. The Shnirel’man density of A is
σ(A) = inf
n→∞
A(n)
n
.
The lower asymptotic density of A is
dL(A) = lim inf
n→∞
A(n)
n
.
The upper asymptotic density of A is
dU(A) = lim sup
n→∞
A(n)
n
.
If dL(A) = dU(A), then d(A) = dL(A) is called the asymptotic density of
A, and
d(A) = lim
n→∞
A(n)
n
.

Notation and Conventions
xiii
Let A and B be nonempty sets of integers and d ∈Z. We deﬁne
the sumset
A + B = {a + b : a ∈A, b ∈B},
the diﬀerence set
A −B = {a −b : a ∈A, b ∈B},
the product set
AB = {ab : a ∈A, b ∈B},
and the dilation
d ∗A = {d}A = {da : a ∈A}.
The sets A and B eventually coincide, denoted by A ∼B, if there exists
an integer n0 such that n ∈A if and only if n ∈B for all n ≥n0.
We use the following arithmetic functions:
vp(n)
the exponent of the highest power of p that divides n
ϕ(n)
Euler phi function
µ(n)
M¨obius function
d(n)
the number of divisors of n
σ(n)
the sum of the divisors of n
π(x)
the number of primes not exceeding x
ϑ(x), ψ(x)
Chebyshev’s functions
ℓ(n)
log n if n is prime and 0 otherwise
ω(n)
the number of distinct prime divisors of n
Ω(n)
the total number of prime divisors of n
L(n)
log n, the natural logarithm of n
Λ(n)
von Mangoldt function
Λ2(n)
generalized von Mangoldt function
1(n)
1 for all n
δ(n)
1 if n = 1 and 0 if n ≥2
A ring is always a ring with identity. We denote by R× the multiplicative
group of units of R. A commutative ring R is a ﬁeld if and only if R× =
R \ {0}. If f(t) is a polynomial with coeﬃcients in the ring R, then N0(f)
denotes the number of distinct zeros of f(t) in R. We denote by Mn(R) the
ring of n × n matrices with coeﬃcients in R.
In the study of Liouville’s method, we use the symbol
{f(ℓ)}n=ℓ2 =
 0
if n is not a square,
f(ℓ)
if n = ℓ2, ℓ≥0.

Contents
Preface
vii
Notation and conventions
xi
I
A First Course in Number Theory
1
Divisibility and Primes
3
1.1
Division Algorithm . . . . . . . . . . . . . . . . . . . . . . .
3
1.2
Greatest Common Divisors
. . . . . . . . . . . . . . . . . .
10
1.3
The Euclidean Algorithm and Continued Fractions . . . . .
17
1.4
The Fundamental Theorem of Arithmetic . . . . . . . . . .
25
1.5
Euclid’s Theorem and the Sieve of Eratosthenes . . . . . . .
33
1.6
A Linear Diophantine Equation . . . . . . . . . . . . . . . .
37
1.7
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
2
Congruences
45
2.1
The Ring of Congruence Classes
. . . . . . . . . . . . . . .
45
2.2
Linear Congruences . . . . . . . . . . . . . . . . . . . . . . .
51
2.3
The Euler Phi Function . . . . . . . . . . . . . . . . . . . .
57
2.4
Chinese Remainder Theorem
. . . . . . . . . . . . . . . . .
61
2.5
Euler’s Theorem and Fermat’s Theorem . . . . . . . . . . .
67
2.6
Pseudoprimes and Carmichael Numbers . . . . . . . . . . .
74
2.7
Public Key Cryptography . . . . . . . . . . . . . . . . . . .
76

xvi
Contents
2.8
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
3
Primitive Roots and Quadratic Reciprocity
83
3.1
Polynomials and Primitive Roots . . . . . . . . . . . . . . .
83
3.2
Primitive Roots to Composite Moduli
. . . . . . . . . . . .
91
3.3
Power Residues . . . . . . . . . . . . . . . . . . . . . . . . .
98
3.4
Quadratic Residues . . . . . . . . . . . . . . . . . . . . . . .
100
3.5
Quadratic Reciprocity Law
. . . . . . . . . . . . . . . . . .
109
3.6
Quadratic Residues to Composite Moduli
. . . . . . . . . .
116
3.7
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
120
4
Fourier Analysis on Finite Abelian Groups
121
4.1
The Structure of Finite Abelian Groups . . . . . . . . . . .
121
4.2
Characters of Finite Abelian Groups . . . . . . . . . . . . .
126
4.3
Elementary Fourier Analysis . . . . . . . . . . . . . . . . . .
133
4.4
Poisson Summation . . . . . . . . . . . . . . . . . . . . . . .
140
4.5
Trace Formulae on Finite Abelian Groups . . . . . . . . . .
144
4.6
Gauss Sums and Quadratic Reciprocity
. . . . . . . . . . .
151
4.7
The Sign of the Gauss Sum . . . . . . . . . . . . . . . . . .
160
4.8
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
169
5
The abc Conjecture
171
5.1
Ideals and Radicals . . . . . . . . . . . . . . . . . . . . . . .
171
5.2
Derivations
. . . . . . . . . . . . . . . . . . . . . . . . . . .
175
5.3
Mason’s Theorem . . . . . . . . . . . . . . . . . . . . . . . .
181
5.4
The abc Conjecture . . . . . . . . . . . . . . . . . . . . . . .
185
5.5
The Congruence abc Conjecture . . . . . . . . . . . . . . . .
191
5.6
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
196
II
Divisors and Primes in Multiplicative Number
Theory
6
Arithmetic Functions
201
6.1
The Ring of Arithmetic Functions
. . . . . . . . . . . . . .
201
6.2
Mean Values of Arithmetic Functions . . . . . . . . . . . . .
206
6.3
The M¨obius Function
. . . . . . . . . . . . . . . . . . . . .
217
6.4
Multiplicative Functions . . . . . . . . . . . . . . . . . . . .
224
6.5
The mean value of the Euler Phi Function . . . . . . . . . .
227
6.6
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
229
7
Divisor Functions
231
7.1
Divisors and Factorizations
. . . . . . . . . . . . . . . . . .
231
7.2
A Theorem of Ramanujan . . . . . . . . . . . . . . . . . . .
237
7.3
Sums of Divisors . . . . . . . . . . . . . . . . . . . . . . . .
240

Contents
xvii
7.4
Sums and Diﬀerences of Products . . . . . . . . . . . . . . .
246
7.5
Sets of Multiples . . . . . . . . . . . . . . . . . . . . . . . .
255
7.6
Abundant Numbers
. . . . . . . . . . . . . . . . . . . . . .
260
7.7
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
265
8
Prime Numbers
267
8.1
Chebyshev’s Theorems . . . . . . . . . . . . . . . . . . . . .
267
8.2
Mertens’s Theorems
. . . . . . . . . . . . . . . . . . . . . .
275
8.3
The Number of Prime Divisors of an Integer . . . . . . . . .
282
8.4
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
287
9
The Prime Number Theorem
289
9.1
Generalized Von Mangoldt Functions . . . . . . . . . . . . .
289
9.2
Selberg’s Formulae . . . . . . . . . . . . . . . . . . . . . . .
293
9.3
The Elementary Proof . . . . . . . . . . . . . . . . . . . . .
299
9.4
Integers with k Prime Factors . . . . . . . . . . . . . . . . .
313
9.5
Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
320
10 Primes in Arithmetic Progressions
325
10.1 Dirichlet Characters
. . . . . . . . . . . . . . . . . . . . . .
325
10.2 Dirichlet L-Functions . . . . . . . . . . . . . . . . . . . . . .
330
10.3 Primes Modulo 4 . . . . . . . . . . . . . . . . . . . . . . . .
338
10.4 The Nonvanishing of L(1, χ) . . . . . . . . . . . . . . . . . .
341
10.5 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
350
III
Three Problems in Additive Number Theory
11 Waring’s Problem
355
11.1 Sums of Powers . . . . . . . . . . . . . . . . . . . . . . . . .
355
11.2 Stable Bases . . . . . . . . . . . . . . . . . . . . . . . . . . .
359
11.3 Shnirel’man’s Theorem . . . . . . . . . . . . . . . . . . . . .
361
11.4 Waring’s Problem for Polynomials
. . . . . . . . . . . . . .
367
11.5 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
373
12 Sums of Sequences of Polynomials
375
12.1 Sums and Diﬀerences of Weighted Sets . . . . . . . . . . . .
375
12.2 Linear and Quadratic Equations
. . . . . . . . . . . . . . .
382
12.3 An Upper Bound for Representations . . . . . . . . . . . . .
387
12.4 Waring’s Problem for Sequences of Polynomials . . . . . . .
394
12.5 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
398
13 Liouville’s Identity
401
13.1 A Miraculous Formula . . . . . . . . . . . . . . . . . . . . .
401
13.2 Prime Numbers and Quadratic Forms
. . . . . . . . . . . .
404
13.3 A Ternary Form
. . . . . . . . . . . . . . . . . . . . . . . .
411

xviii
Contents
13.4 Proof of Liouville’s Identity . . . . . . . . . . . . . . . . . .
413
13.5 Two Corollaries . . . . . . . . . . . . . . . . . . . . . . . . .
419
13.6 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
421
14 Sums of an Even Number of Squares
423
14.1 Summary of Results
. . . . . . . . . . . . . . . . . . . . . .
423
14.2 A Recursion Formula . . . . . . . . . . . . . . . . . . . . . .
424
14.3 Sums of Two Squares
. . . . . . . . . . . . . . . . . . . . .
427
14.4 Sums of Four Squares
. . . . . . . . . . . . . . . . . . . . .
431
14.5 Sums of Six Squares . . . . . . . . . . . . . . . . . . . . . .
436
14.6 Sums of Eight Squares . . . . . . . . . . . . . . . . . . . . .
441
14.7 Sums of Ten Squares . . . . . . . . . . . . . . . . . . . . . .
445
14.8 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
453
15 Partition Asymptotics
455
15.1 The Size of p(n)
. . . . . . . . . . . . . . . . . . . . . . . .
455
15.2 Partition Functions for Finite Sets
. . . . . . . . . . . . . .
458
15.3 Upper and Lower Bounds for log p(n)
. . . . . . . . . . . .
465
15.4 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
473
16 An Inverse Theorem for Partitions
475
16.1 Density Determines Asymptotics . . . . . . . . . . . . . . .
475
16.2 Asymptotics Determine Density . . . . . . . . . . . . . . . .
482
16.3 Abelian and Tauberian Theorems . . . . . . . . . . . . . . .
486
16.4 Notes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
495
References
497
Index
509

Part I
A First Course in Number
Theory

1
Divisibility and Primes
1.1
Division Algorithm
Divisibility is a fundamental concept in number theory. Let a and d be
integers. We say that d is a divisor of a, and that a is a multiple of d, if
there exists an integer q such that
a = dq.
If d divides a, we write
d|a.
For example, 1001 is divisible by 7 and 13. Divisibility is transitive: If a
divides b and b divides c, then a divides c (Exercise 14).
The minimum principle states that every nonempty set of integers bounded
below contains a smallest element. For example, a nonempty set of nonneg-
ative integers must contain a smallest element. We can see the necessity of
the condition that the nonempty set be bounded below by considering the
example of the set Z of all integers, positive, negative, and zero.
The minimum principle is all we need to prove the following important
result.
Theorem 1.1 (Division algorithm) Let a and d be integers with d ≥1.
There exist unique integers q and r such that
a = dq + r
(1.1)
and
0 ≤r ≤d −1.
(1.2)

4
1. Divisibility and Primes
The integer q is called the quotient and the integer r is called the re-
mainder in the division of a by d.
Proof. Consider the set S of nonnegative integers of the form
a −dx
with x ∈Z. If a ≥0, then a = a −d · 0 ∈S. If a < 0, let x = −y, where
y is a positive integer. Since d is positive, we have a −dx = a + dy ∈S
if y is suﬃciently large. Therefore, S is a nonempty set of nonnegative
integers. By the minimum principle, S contains a smallest element r, and
r = a −dq ≥0 for some q ∈Z. If r ≥d, then
0 ≤r −d = a −d(q + 1) < r
and r −d ∈S, which contradicts the minimality of r. Therefore, q and r
satisfy conditions (1.1) and (1.2).
Let q1, r1, q2, r2 be integers such that
a = dq1 + r1 = dq2 + r2
and
0 ≤r1, r2 ≤d −1.
Then
|r1 −r2| ≤d −1
and
d(q1 −q2) = r2 −r1.
If q1 ̸= q2, then
|q1 −q2| ≥1
and
d ≤d|q1 −q2| = |r2 −r1| ≤d −1,
which is impossible. Therefore, q1 = q2 and r1 = r2. This proves that the
quotient and remainder are unique. 2
For example, division of 16 by 7 gives the quotient 2 and the remainder
2, that is,
16 = 7 · 2 + 2.
Division of −16 by 7 gives the quotient −3 and the remainder 5, that is,
−16 = 7(−3) + 5.
A simple geometric way to picture the division algorithm is to imagine
the real number line with dots at the positive integers. Let q be a positive
integer, and put a large dot on each multiple of q. The integer a either
lies on one of these large dots, in which case a is a multiple of q, or a lies
on a dot strictly between two large dots, that is, between two successive

1.1 Division Algorithm
5
multiples of q, and the distance r between a and the largest multiple of q
that is less than a is a positive integer no greater than q −1. For example,
if q = 7 and a = ±16, we have the following picture.
p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p p
r
r
r
r
r
r
r
b
b
-21
-14
-7
0
7
14
21
-16
16
The principle of mathematical induction states that if S(k) is some state-
ment about integers k ≥k0 such that S(k0) is true and such that the truth
of S(k−1) implies the truth of S(k), then S(k) holds for all integers k ≥k0.
Another form of the principle of mathematical induction states that if S(k0)
is true and if the truth of S(k0), S(k0 + 1), . . . , S(k −1) implies the truth
of S(k), then S(k) holds for all integers k ≥k0. Mathematical induction is
equivalent to the minimum principle (Exercise 18).
Using mathematical induction and the division algorithm, we can prove
the existence and uniqueness of m-adic representations of integers.
Theorem 1.2 Let m be an integer, m ≥2. Every positive integer n can
be represented uniquely in the form
n = a0 + a1m + a2m2 + · · · + akmk,
(1.3)
where k is the nonnegative integer such that
mk ≤n < mk+1
and a0, a1, . . . , ak are integers such that
1 ≤ak ≤m −1
and
0 ≤ai ≤m −1
for i = 0, 1, 2, . . . , k −1.
This is called the m-adic representation of n. The integers ai are called
the digits of n to base m. Equivalently, we can write
n =
∞

i=0
aimi,
where 0 ≤ai ≤m −1 for all i, and ai = 0 for all suﬃciently large integers
i.
Proof. For k ≥0, let S(k) be the statement that every integer in the
interval mk ≤n < mk+1 has a unique m-adic representation. We use
induction on k. The statement S(0) is true because if 1 ≤n < m, then
n = a0 is the unique m-adic representation.

6
1. Divisibility and Primes
Let k ≥1, and assume that the statements S(0), S(1), . . . , S(k −1) are
true. We shall prove S(k). Let mk ≤n < mk+1. By the division algorithm,
we can divide n by mk and obtain
n = akmk + r,
where 0 ≤r < mk.
Then
0 < mk −r ≤n −r = akmk ≤n < mk+1.
Dividing this inequality by mk, we obtain 0 < ak < m. Since m and ak are
integers, it follows that
1 ≤ak ≤m −1.
If r = 0, then n = akmk is an m-adic representation. If r ≥1, then
mk′ ≤r < mk′+1 for some nonnegative integer k′ ≤k−1. By the induction
assumption, S(k′) is true and r has a unique m-adic representation of the
form
r = a0 + a1m + · · · + ak−1mk−1
with 0 ≤ai ≤m −1 for i = 0, 1, . . . , k −1. It follows that n has the m-adic
representation
n = a0 + a1m + · · · + ak−1mk−1 + akmk.
We shall show that this representation is unique. Let
n = b0 + b1m + · · · + bℓmℓ
be another m-adic representation of n, where 0 ≤bj ≤m −1 for all
j = 0, 1, . . . , ℓand bℓ≥1. If ℓ≥k + 1, then
n < mk+1 ≤bℓmℓ≤n,
which is impossible. If ℓ≤k −1, then the inequalities bj ≤m −1 imply
that
n
=
b0 + b1m + · · · + bℓmℓ
≤
(m −1) + (m −1)m + · · · + (m −1)mℓ
=
mℓ+1 −1
<
mk
≤
n,
which is also impossible. Therefore, k = ℓ. If ak < bk, then
n
=
a0 + a1m + · · · + ak−1mk−1 + akmk
≤
(m −1) + (m −1)m + · · · + (m −1)mk−1 + akmk
=
(mk −1) + akmk
<
(ak + 1)mk
≤
bkmk
≤
n,

1.1 Division Algorithm
7
which again is impossible. Therefore, bk ≤ak. By symmetry, we have ak ≤
bk and so ak = bk. Then
n −akmk
=
a0 + a1m + a2m2 + · · · + ak−1mk−1
=
b0 + b1m + b2m2 + · · · + bk−1mk−1
<
mk.
By the induction assumption, ai = bi for i = 0, 1, . . . , k −1. Thus, the
m-adic representation of n exists and is unique, and S(k) is true. By math-
ematical induction, S(k) holds for all k ≥0. 2
For example, the 2-adic representation of 100 is
100 = 1 · 22 + 1 · 25 + 1 · 26,
and the 3-adic representation of 100 is
100 = 1 + 2 · 32 + 1 · 34.
The 10-adic representation of 217 is
217 = 7 + 1 · 101 + 2 · 102.
Exercises
1. Find all divisors of 20.
2. Find all divisors of 29,601.
3. Find all divisors of 1.
4. Find the quotient and remainder for a divided by d when
(a) a = 281 and d = 23.
(b) a = 281 and d = 12.
(c) a = 291 and d = 23.
(d) a = 291 and d = 12.
5. Find the quotient and remainder for 10k + 1 divided by 11 for k =
1, 2, 3, 4, 5.
6. Compute the m-adic representation of 526 for m = 2, 3, 7, and 9.
7. Compute the 100-adic representation of 783,614,955.
8. Prove that n is even, then n2 is divisible by 4.

8
1. Divisibility and Primes
9. Prove that n is odd, then n2 −1 is divisible by 8.
10. Prove that n3 −n is divisible by 6 for every integer n.
11. Prove that if d divides a, then dk divides ak for every positive integer
k.
12. Prove that if d divides a and d divides b, then d divides ax + by for
all integers x and y.
13. Prove that if a and d are integers such that d divides a and |a| < d,
then a = 0.
14. Prove that divisibility is transitive, that is, if a divides b and b divides
c, then a divides c.
15. Prove by induction that n ≤2n−1 for all positive integers n.
16. Prove by induction that
1 + 2 + · · · + n = n(n + 1)
2
for all positive integers n.
17. Prove by induction that
13 + 23 + · · · + n3 = (1 + 2 + · · · + n)2
for all positive integers n, that is, the sum of the cubes of the ﬁrst n
integers is equal to the square of the sum of the ﬁrst n integers.
18. Prove that the principle of mathematical induction is equivalent to
the minimum principle.
19. Let a and d be integers with d ≥1. Prove that there exist unique
integers q′ and r′ such that
a = dq′ + r′
and
−d
2 < r′ ≤d
2.
20. For integers n and k with n ≥1 and 0 ≤k ≤n, we deﬁne the binomial
coeﬃcient
n
k

= n(n −1) · · · (n −k + 1)
k!
.
Deﬁne
0
0

= 1. Prove that for all n ≥1,
n
0

=
n
n

= 1

1.1 Division Algorithm
9
and
n
k

=
n −1
k

+
n −1
k −1

for 1 ≤k ≤n −1.
21. Prove that the product of any k consecutive integers is always divis-
ible by k!.
Hint: Use induction on n to show that
n
k

is an integer.
22. Let m0, m1, m2, . . . be a strictly increasing sequence of positive inte-
gers such that m0 = 1 and mi divides mi+1 for all i ≥0. Prove that
every positive integer n can be represented uniquely in the form
n =
∞

i=0
aimi,
where
0 ≤ai ≤mi+1
mi
−1
for all i ≥0
and mi = 0 for all but ﬁnitely many integers i.
23. Prove that every positive integer n can be represented uniquely in
the form
n =
∞

k=0
akk!,
where
0 ≤ak ≤k.
24. Prove that every positive integer n can be uniquely represented in
the form
n = b0 + b13 + b232 + · · · + bk−13k−1 + 3k,
where bi ∈{0, 1, −1} for i = 0, 1, 2, . . . , k −1.
25. Let Nk denote the set of all k-tuples of positive integers. We deﬁne the
lexicographic order on Nk as follows. For (a1, . . . , ak), (b1, . . . , bk) ∈
Nk, we write
(a1, . . . , ak) ⪯(b1, . . . , bk)
if either ai = bi for all i = 1, . . . , k, or there exists an integer j such
that ai = bi for i < j and aj < bj. Prove that
(a) The relation ⪯is reﬂexive in the sense that if (a1, . . . , ak) ⪯
(b1, . . . , bk) and (b1, . . . , bk) ⪯(a1, . . . , ak), then (a1, . . . , ak) =
(b1, . . . , bk).

10
1. Divisibility and Primes
(b) The relation ⪯is transitive in the sense that if (a1, . . . , ak) ⪯
(b1, . . . , bk) and (b1, . . . , bk) ⪯(c1, . . . , ck), then (a1, . . . , ak) ⪯
(c1, . . . , ck).
(c) The relation ⪯is total in the sense that if (a1, . . . , ak), (b1, . . . , bk) ∈
Nk, then (a1, . . . , ak) ⪯(b1, . . . , bk) or (b1, . . . , bk) ⪯(a1, . . . , ak).
A relation that is reﬂexive and transitive is called a partial order.
A partial order that is total is called a total order. Thus, the lex-
icographic order is a total order on the set of k-tuples of positive
integers.
26. Prove that Nk with the lexicographic order satisﬁes the following
minimum principle: Every nonempty set of k-tuples of positive inte-
gers contains a smallest element.
1.2
Greatest Common Divisors
Algebra is a natural language to describe many results in elementary num-
ber theory.
Let G be a nonempty set, and let G × G denote the set of all ordered
pairs (x, y) with x, y ∈G. A binary operation on G is a map from G × G
into G. We denote the image of (x, y) ∈G × G by x ∗y ∈G.
A group is a set G with a binary operation that satisﬁes the following
three axioms:
(i) Associativity: For all x, y, z ∈G,
(x ∗y) ∗z = x ∗(y ∗z).
(ii) Identity element: There exists an element e ∈G such that for all
x ∈G,
e ∗x = x ∗e = x.
The element e is called the identity of the group.
(iii) Inverses: For every x ∈G there exists an element y ∈G such that
x ∗y = y ∗x = e.
The element y is called the inverse of x.
The group G is called abelian or commutative
if the binary operation
also satisﬁes the axiom
(iv) Commutativity: For all x, y ∈G,
x ∗y = y ∗x.

1.2 Greatest Common Divisors
11
We can use additive notation and denote the image of the ordered pair
(x, y) ∈G × G by x + y. We call x + y the sum of x and y. In an additive
group, the identity is usually written 0, the inverse of x is written −x, and
we deﬁne x −y = x + (−y). We can also use multiplicative notation and
denote the image of the ordered pair (x, y) ∈G × G by xy. We call xy the
product of x and y. In a multiplicative group, the identity is usually written
1 and the inverse of x is written x−1.
Examples of abelian groups are the integers Z, the rational numbers Q,
the real numbers R, and the complex numbers C, with the usual operation
of addition. The nonzero rational, real, and complex numbers, denoted
by Q×, R×, and C×, respectively, are also abelian groups, with the usual
multiplication as the binary operation. For every positive integer m, the
set of complex numbers
Γm = {e2πik/m : k = 0, 1, . . . , m −1}
is a multiplicative group. The elements of Γm are called mth roots of unity,
since ωm = 1 for all ω ∈Γm. An example of a nonabelian group is the set
GL2(C) of 2 × 2 matrices with complex coeﬃcients and nonzero determi-
nant, and with the usual matrix multiplication as the binary operation.
A subgroup of a group G is a nonempty subset of G that is also a group
under the same binary operation as G. If H is a subgroup of G, then H is
closed under the binary operation in G, H contains the identity element of
G, and the inverse of every element of H belongs to H. For example, the
set of even integers is a subgroup of Z. A nonempty subset H of an additive
abelian group G is a subgroup if and only if x −y ∈H for all x, y ∈H
(Exercise 20).
For every integer d, the set of all multiples of d is a subgroup of Z. We
denote this subgroup by dZ. If a1, . . . , ak ∈Z, then the set of all numbers
of the form a1x1 + · · · + akxk with x1, . . . , xk ∈Z is also a subgroup of Z.
The set Q of rational numbers is a subgroup of the additive group R. The
set R+ of positive real numbers is a subgroup of the multiplicative group
R×. Let T = {z ∈C : |z| = 1} denote the set of complex numbers of
absolute value 1, that is, the unit circle in the complex plane. Then T is a
subgroup of the multiplicative group C×, and Γm is a subgroup of T.
If G is a group, written multiplicatively, and g ∈G, then gn ∈G for all
n ∈Z (Exercise 21), and {gn : n ∈Z} is a subgroup of G.
The intersection of a family of subgroups of a group G is a subgroup of G
(Exercise 22). Let S be a subset of a group G. The subgroup of G generated
by S is the smallest subgroup of G that contains S. This is simply the
intersection of all subgroups of G that contain S (Exercise 23). For example,
the subgroup of Z generated by the set {d} is dZ.
Theorem 1.3 Let H be a subgroup of the integers under addition. There
exists a unique nonnegative integer d such that H is the set of all multiples

12
1. Divisibility and Primes
of d, that is,
H = {0, ±d, ±2d, . . .} = dZ.
Proof. We have 0 ∈H for every subgroup H. If H = {0} is the zero
subgroup, then we choose d = 0 and H = 0Z. Moreover, d = 0 is the unique
generator of this subgroup.
If H ̸= {0}, then there exists a ∈H, a ̸= 0. Since −a also belongs to H,
it follows that H contains positive integers. By the minimum principle, H
contains a least positive integer d. By Exercise 21, dq ∈H for every integer
q, and so dZ ⊆H.
Let a ∈H. By the division algorithm, we can write a = dq + r, where q
and r are integers and 0 ≤r ≤d −1. Since dq ∈H and H is closed under
subtraction, it follows that
r = a −dq ∈H.
Since 0 ≤r < d and d is the smallest positive integer in H, we must have
r = 0, that is, a = dq ∈dZ and H ⊆dZ. It follows that H = dZ.
If H = dZ = d′Z, where d and d′ are positive integers, then d′ ∈dZ
implies that d′ = dq for some integer q, and d ∈d′Z implies that d = d′q′
for some integer q′. Therefore,
d = d′q′ = dqq′,
and so qq′ = 1, hence q = q′ = ±1 and d = ±d′. Since d and d′ are positive,
we have d = d′, and d is the unique positive integer that generates the
subgroup H. 2
For example, if H is the subgroup consisting of all integers of the form
35x + 91y, then 7 = 35(−5) + 91(2) ∈H and H = 7Z.
Let A be a nonempty set of integers, not all 0. If the integer d divides a
for all a ∈A, then d is called a common divisor of A. For example, 1 is a
common divisor of every nonempty set of integers. The positive integer d
is called the greatest common divisor of the set A, denoted by d = gcd(A),
if d is a common divisor of A and every common divisor of A divides d.
We shall prove that every nonempty set of integers has a greatest common
divisor.
Theorem 1.4 Let A be a nonempty set of integers, not all zero. Then A
has a unique greatest common divisor, and there exist integers a1, . . . , ak ∈
A and x1, . . . , xk such that
gcd(A) = a1x1 + · · · + akxk.
Proof. Let H be the subset of Z consisting of all integers of the form
a1x1 + · · · + akxk
with a1, . . . , ak ∈A and x1, . . . , xk ∈Z.

1.2 Greatest Common Divisors
13
Then H is a subgroup of Z and A ⊆H. By Theorem 1.3, there exists
a unique positive integer d such that H = dZ, that is, H consists of all
multiples of d. In particular, every integer a ∈A is a multiple of d, and so d
is a common divisor of A. Since d ∈H, there exist integers a1, . . . , ak ∈A
and x1, . . . , xk such that
d = a1x1 + · · · + akxk.
It follows that every common divisor of A must divide d, hence d is a
greatest common divisor of A.
If the positive integers d and d′ are both greatest common divisors, then
d|d′ and d′|d, and so d = d′. It follows that gcd(A) is unique. 2
If A = {a1, . . . , ak} is a nonempty, ﬁnite set of integers, not all 0, we
write gcd(A) = (a1, . . . , ak). For example,
(35, 91) = 7 = 35(−5) + 91(2).
Theorem 1.5 Let a1, . . . , ak be integers, not all zero. Then (a1, . . . , ak) =
1 if and only if there exist integers x1, . . . , xk such that
a1x1 + · · · + akxk = 1.
Proof. This follows immediately from Theorem 1.4. 2
The integers a1, . . . , ak are called relatively prime if their greatest com-
mon divisor is 1, that is, (a1, . . . , ak) = 1. The integers a1, . . . , ak are called
pairwise relatively prime if (ai, aj) = 1 for i ̸= j. For example, the three in-
tegers 6, 10, 15 are relatively prime but not pairwise relatively prime, since
(6, 10, 15) = 1 but (6, 10) = 2, (6, 15) = 3, and (10, 15) = 5.
Let G and H be groups, and denote the group operations by ∗. A map
f : G →H is called a group homomorphism if f(x ∗y) = f(x) ∗f(y) for
all x, y ∈G. Thus, a homomorphism f from an additive group G into a
multiplicative group H is a map such that f(x + y) = f(x)f(y) for all
x, y ∈G. For example, if R is the additive group of real numbers and R+
is the multiplicative group of positive real numbers, then the exponential
map exp : R →R+ deﬁned by exp(x) = ex is a homomorphism.
A group homomorphism f : G →H is called an isomorphism if f is
one-to-one and onto. Groups G and H are called isomorphic, denoted by
G ∼= H, if there exists an isomorphism between them. For example, let 2Z
denote the additive group of even integers. The map f : Z →2Z deﬁned
by f(n) = 2n is an isomorphism between the group of integers and the
subgroup of even integers.

14
1. Divisibility and Primes
Exercises
1. Compute (935, 1122).
2. Compute (168, 252, 294).
3. Find integers x and y such that 13x + 15y = 1.
4. Construct four relatively prime integers a, b, c, d such that no three
of them are relatively prime.
5. Prove that (n, n + 2) = 1 is n is odd and (n, n + 2) = 2 is n is even.
6. Prove that 2n + 5 and 3n + 7 are relatively prime for every integer n.
7. Prove that 3n + 2 and 5n + 3 are relatively prime for every integer n.
8. Prove that n!+1 and (n+1)!+1 are relatively prime for every positive
integer n.
9. Let a, b, and d be positive integers. Prove that if (a, b) = 1 and d
divides a, then (d, b) = 1.
10. Let a and b be positive integers. Prove that (a, b) = a if and only if a
divides b.
11. Let a, b, c be positive integers. Prove that
(ac, bc) = (a, b)c.
12. Let a, b, and c be positive integers. Prove that
((a, b), c) = (a, (b, c)) = (a, b, c).
13. Let A be a nonempty set of integers. Prove that the greatest common
divisor of A is the largest integer that divides every element of A.
14. Let a, b, c, d be integers such that ad −bc = 1. For integers u and v,
deﬁne
u′ = au + bv
and
v′ = cu + dv.
Prove that (u, v) = (u′, v′).
Hint: Express u and v in terms of u′ and v′.

1.2 Greatest Common Divisors
15
15. Let S = Qn+1 \ {(0, 0, . . . , 0)} denote the set of all nonzero (n + 1)-
tuples of rational numbers. If t is a nonzero rational number and
(x0, x1, . . . , xn) ∈S, then we deﬁne
t(x0, x1, . . . , xn) = (tx0, tx1, . . . , txn) ∈S.
We introduce a relation ∼on S as follows: If (x0, x1, . . . , xn) and
(y0, y1, . . . , yn) are in S, then (x0, x1, . . . , xn) ∼(y0, y1, . . . , yn) if
there exists a nonzero rational number t such that t(x0, x1, . . . , xn) =
(y0, y1, . . . , yn). Prove that this is an equivalence relation, that is,
prove that ∼is reﬂexive (x ∼x for all x ∈S), symmetric (if x ∼y,
then y ∼x), and transitive (if x ∼y and y ∼z, then x ∼z). The set
of equivalence classes of this relation is called n-dimensional projec-
tive space over the ﬁeld of rational numbers, and denoted by Pn(Q).
16. Consider
 25
6 , −5, 10
3

∈Q3. Find all triples (a0, a1, a2) of relatively
prime integers such that
(a0, a1, a2) ∼
25
6 , −5, 10
3

.
17. Let
(x0, x1, . . . , xn) ∈S = Qn+1 \ {(0, 0, . . . , 0)}.
Let [(x0, x1, . . . , xn)] denote the equivalence class of (x0, x1, . . . , xn)
in Pn(Q). Prove that there exist exactly two elements (a0, a1, . . . , an)
and (b0, b1, . . . , bn) in S such that the numbers a0, a1, . . . , an are rel-
atively prime integers, the numbers b0, b1, . . . , bn are relatively prime
integers, and
[(x0, x1, . . . , xn)] = [(a0, a1, . . . , an)] = [(b0, b1, . . . , bn)] ∈Pn(Q).
Moreover,
(b0, b1, . . . , bn) = −(a0, a1, . . . , an).
18. Prove that the set of all rational numbers of the form a/2k, where
a ∈Z and k ∈N0, is an additive subgroup of Q.
19. Let G = {2Z, 1 + 2Z}, where 2Z denotes the set of even integers and
1 + 2Z the set of odd integers. Deﬁne addition of elements of G by
2Z + 2Z = (1 + 2Z) + (1 + 2Z) = 2Z
and
2Z + (1 + 2Z) = (1 + 2Z) + 2Z = 1 + 2Z.
Prove that G is an additive abelian group.

16
1. Divisibility and Primes
20. Let H be a nonempty subset of an additive abelian group G. Prove
that H is a subgroup if and only if x −y ∈H for all x, y ∈H.
21. Prove that if G is a group, written multiplicatively, and g ∈G, then
gn ∈G for all n ∈Z. (If G is an additive group, then ng ∈G for all
n ∈Z.)
22. Prove that the intersection of a family of subgroups of a group G is
a subgroup of G.
23. Let S be a nonempty subset of an additive abelian group G. Prove
that the subgroup of G generated by S is the intersection of all sub-
groups of G that contain S.
24. Prove that every nonzero subgroup of Z is isomorphic to Z.
25. Let G be the set of all matrices of the form

1
a
0
1

,
with a ∈Z and matrix multiplication as the binary operation. Prove
that G is an abelian group isomorphic to Z.
26. Let H3(Z) be the set of all matrices of the form


1
a
c
0
1
b
0
0
1

,
with a, b, c ∈Z and matrix multiplication as the binary operation.
Prove that H3(Z) is a nonabelian group. This group is called the
Heisenberg group.
27. Let R be the additive group of real numbers and R+ the multi-
plicative group of positive real numbers. Let exp : R →R+ be the
exponential map exp(x) = ex. Prove that the exponential map is a
group isomorphism.
28. Let G and H be groups with e the identity in H. Let f : G →H be
a group homomorphism. The kernel of f is the set
f −1(e) = {x ∈G : f(x) = e ∈H} ⊆G.
The image of f is the set
f(G) = {f(x) : x ∈G} ⊆H.
Prove that the kernel of f is a subgroup of G, and the image of f is
a subgroup of H.

1.3 The Euclidean Algorithm and Continued Fractions
17
29. Deﬁne the map f : Z →Z by f(n) = 3n. Prove that f is a group
homomorphism and determine the kernel and image of f.
30. Let Γm denote the multiplicative group of mth roots of unity. Prove
that the map f : Z →Γm deﬁned by f(k) = e2πik/m is a group
homomorphism. What is the kernel of this homomorphism?
31. Let G = [0, 1) be the interval of real numbers x such that 0 ≤x < 1.
We deﬁne a binary operation x ∗y for numbers x, y ∈G as follows:
x ∗y =

x + y
if x + y < 1,
x + y −1
if x + y ≥1.
Prove that G is an abelian group with this operation. This group is
denoted by R/Z.
Deﬁne the map f : R →R/Z by f(t) = {t}, where {t} denotes the
fractional part of t. Prove that f is a group homomorphism. What is
the kernel of this homomorphism?
1.3
The Euclidean Algorithm and Continued
Fractions
Let a and b be integers with b ≥1. There is a simple and eﬃcient method
to compute the greatest common divisor of a and b and to express (a, b)
explicitly in the form ax + by. Deﬁne r0 = a and r1 = b. By the division
algorithm, there exist integers q0 and r2 such that
r0 = r1q0 + r2
and
0 ≤r2 < r1.
If an integer d divides r0 and r1, then d also divides r1 and r2. Similarly,
if an integer d divides r1 and r2, then d also divides r0 and r1. Therefore,
the set of common divisors of r0 and r1 is the same as the set of common
divisors of r1 and r2, and so
(a, b) = (r0, r1) = (r1, r2).
If r2 = 0, then a = bq0 and (a, b) = b = r1. If r2 > 0, then we divide r2 into
r1 and obtain integers q1 and r3 such that
r1 = r2q1 + r3,
where
0 ≤r3 < r2 < r1

18
1. Divisibility and Primes
and
(a, b) = (r1, r2) = (r2, r3).
Moreover, q1 ≥1 since r2 < r1. If r3 = 0, then (a, b) = r2. If r3 > 0, then
there exist integers q2 and r4 such that
r2 = r3q2 + r4,
where q2 ≥1 and
0 ≤r4 < r3 < r2 < r1
and
(a, b) = (r2, r3) = (r3, r4).
If r4 = 0, then (a, b) = r3.
Iterating this process k times, we obtain an integer q0, a sequence of
positive integers q1, q2, . . . , qk−1, and a strictly decreasing sequence of non-
negative integers r1, r2, . . . , rk+1 such that
ri−1 = riqi−1 + ri+1
for i = 1, 2, . . . , k, and
(a, b) = (r0, r1) = (r1, r2) = · · · = (rk, rk+1).
If rk+1 > 0, then we can divide rk by rk+1 and obtain
rk = rk+1qk + rk+2,
where 0 ≤rk+2 < rk+1. Since a strictly decreasing sequence of nonnegative
integers must be ﬁnite, it follows that there exists an integer n ≥1 such
that rn+1 = 0. Then we have an integer q0, a sequence of positive inte-
gers q1, q2, . . . , qn−1, and a strictly decreasing sequence of positive integers
r1, r2, . . . , rn with
(a, b) = (rn, rn+1) = rn.
The n applications of the division algorithm produce n equations
r0
=
r1q0 + r2
r1
=
r2q1 + r3
r2
=
r3q2 + r4
...
rn−2
=
rn−1qn−2 + rn
rn−1
=
rnqn−1.
Since rn < rn+1, it follows that qn−1 ≥2.
This procedure is called the Euclidean algorithm. We call n the length
of the Euclidean algorithm for a and b. This is the number of divisions

1.3 The Euclidean Algorithm and Continued Fractions
19
required to ﬁnd the greatest common divisor. The sequence q0, q1, . . . , qn−1
is called the sequence of partial quotients. The sequence r2, r3, . . . , rn is
called the sequence of remainders.
Let us use the Euclidean algorithm to ﬁnd (574, 252) and express it as a
linear combination of 574 and 252. We have
574
=
252 · 2 + 70,
252
=
70 · 3 + 42,
70
=
42 · 1 + 28,
42
=
28 · 1 + 14,
28
=
14 · 2,
and so
(574, 252) = 14.
The sequence of partial quotients is (2, 3, 1, 1, 2) and the sequence of partial
remainders is (70, 42, 28, 14). The Euclidean algorithm for 574 and 252 has
length 5. Note that 574 = 14 · 41 and 252 = 14 · 18, and that 41 and 18 are
relatively prime. Working backwards through the Euclidean algorithm to
express 14 as a linear combination of 574 and 252, we obtain
14
=
42 −28 · 1
=
42 −(70 −42 · 1) · 1 = 42 · 2 −70 · 1
=
(252 −70 · 3) · 2 −70 · 1 = 252 · 2 −70 · 7
=
252 · 2 −(574 −252 · 2) · 7 = 252 · 16 −574 · 7.
Let a0, a1, . . . , aN be real numbers with ai > 0 for i = 1, . . . , N. We
deﬁne the ﬁnite simple continued fraction
⟨a0, a1, . . . , aN⟩= a0 +
1
a1 +
1
a2+
1
...
1
aN−1+
1
aN
.
Another notation for a continued fraction is
⟨a0, a1, . . . , aN⟩= a0 +
1
a1+
1
a2+ · · · 1
aN
.
The numbers a0, a1, . . . , aN are called the partial quotients of the continued
fraction. For example,
⟨2, 1, 1, 2⟩= 2 +
1
1 +
1
1+ 1
2
= 13
5 .
We can write a ﬁnite simple continued fraction as a rational function in
the variables a0, a1, . . . , aN. For example,
⟨a0⟩= a0,

20
1. Divisibility and Primes
⟨a0, a1⟩= a0a1 + 1
a1
,
and
⟨a0, a1, a2⟩= a0a1a2 + a0 + a2
a1a2 + 1
.
If N ≥1, then (Exercise 5)
⟨a0, a1, . . . , aN⟩= a0 +
1
⟨a1, . . . , aN⟩.
We can use the Euclidean algorithm to write a rational number as a ﬁnite
simple continued fraction with integral partial quotients. For example, to
represent 574/274, we have
574
252
=
2 + 70
252
=
2 +
1
3 + 42
70
=
2 +
1
3 +
1
1+ 28
42
=
2 +
1
3 +
1
1+
1
1+ 14
28
=
2 +
1
3 +
1
1+
1
1+ 1
2
=
⟨2, 3, 1, 1, 2⟩.
Notice that the partial quotients in the Euclidean algorithm are the partial
quotients in the continued fraction.
Theorem 1.6 Let a and b be integers with b ≥1. If the Euclidean algo-
rithm for a and b has length n with sequence of partial quotients q0, q1, . . . , qn−1,
then
a
b = ⟨q0, q1, . . . , qn−1⟩.
Proof. Let r0 = a and r1 = b. The proof is by induction on n. If n = 1,
then
r0 = r1q0
and
a
b = r0
r1
= q0 = ⟨q0⟩.
If n = 2, then
r0
=
r1q0 + r2,
r1
=
r2q1,

1.3 The Euclidean Algorithm and Continued Fractions
21
and
a
b = r0
r1
= q0 + r2
r1
= q0 + 1
r1
r2
= q0 + 1
q1
= ⟨q0, q1⟩.
Let n ≥2, and assume that the theorem is true for integers a and b ≥1
whose Euclidean algorithm has length n. Let a and b ≥1 be integers
whose Euclidean algorithm has length n + 1 and whose sequence of partial
quotients is ⟨q0, q1, . . . , qn⟩. Let
r0
=
r1q0 + r2
r1
=
r2q1 + r3
...
rn−1
=
rnqn−1 + rn+1
rn
=
rn+1qn.
be the n + 1 equations in the Euclidean algorithm for a = r0 and b = r1.
The Euclidean algorithm for the positive integers r1 and r2 has length n
with sequence of partial quotients q1, . . . , qn. It follows from the induction
hypothesis that
r1
r2
= ⟨q1, . . . , qn⟩
and so
a
b = r0
r1
= q0 + 1
r1
r2
= q0 +
1
⟨q1, . . . , qn⟩= ⟨q0, q1, . . . , qn⟩.
This completes the proof. 2
It is also true that the representation of a rational number as a ﬁnite
simple continued fraction is essentially unique (Exercise 8).
Exercises
1. Use the Euclidean algorithm to compute the greatest common divisor
of 35 and 91, and to express (35, 91) as a linear combination of 35
and 91. Compute the simple continued fraction for 91/35.
2. Use the Euclidean algorithm to write the greatest common divisor of
4534 and 1876 as a linear combination of 4534 and 1876. Compute
the simple continued fraction for 4534/1876.
3. Use the Euclidean algorithm to compute the greatest common divisor
of 1197 and 14280, and to express (1197, 14280) as a linear combina-
tion of 1197 and 14280.

22
1. Divisibility and Primes
4. Compute the simple continued fraction ⟨2, 1, 2, 1, 1, 4⟩to 4 decimal
places, and compare this number to e.
5. Prove that
⟨a0, a1, . . . , aN⟩= a0 +
1
⟨a1, . . . , aN⟩.
6. Let N ≥1. Prove that
⟨a0, a1, . . . , aN−2, aN−1, 1⟩= ⟨a0, a1, . . . , aN−2, aN−1 + 1⟩.
7. Let x = ⟨a0, a1, . . . , aN⟩be a ﬁnite simple continued fraction whose
partial quotients ai are integers, with N ≥1 and aN ≥2. Let [x]
denote the integer part of x and {x} the fractional part of x. Prove
that
[x] = a0
and
{x} =
1
⟨a1, . . . , aN⟩.
8. Let a
b be a rational number that is not an integer. Prove that there
exist unique integers a0, a1, . . . , aN such that ai ≥1 for i = 1, . . . , N−
1, aN ≥2, and
a
b = ⟨a0, a1, . . . , aN−1, aN⟩.
Hint: By Exercise 7, if
x = ⟨a0, a1, . . . , aN⟩= ⟨b0, b1, . . . , bM⟩
with ai, bj ∈Z and aN, bM ≥2, then a0 = [x] = b0.
9. Prove that
⟨a0, a1, . . . , aN, aN+1⟩= ⟨a0, a1, . . . , aN +
1
aN+1
⟩.
10. Let ⟨a0, a1, . . . , aN⟩be a ﬁnite simple continued fraction. Deﬁne
p0 = a0,
p1 = a1a0 + 1,
and
pn = anpn−1 + pn−2
for n = 2, . . . , N.
Deﬁne
q0 = 1,
q1 = a1,

1.3 The Euclidean Algorithm and Continued Fractions
23
and
qn = anqn−1 + qn−2
for n = 2, . . . , N.
Prove that
⟨a0, a1, . . . , an⟩= pn
qn
for n = 0, 1, . . . , N. The continued fraction ⟨a0, a1, . . . , an⟩is called
the nth convergent of the continued fraction ⟨a0, a1, . . . , aN⟩.
11. Compute the convergents pn/qn of the simple continued fraction
⟨1, 2, 2, 2, 2, 2, 2⟩. Compute p6/q6 to 5 decimal places, and compare
this number to
√
2.
12. Let ⟨a0, a1, . . . , aN⟩be a ﬁnite simple continued fraction, and let pn
and qn be the numbers deﬁned in Exercise 10. Prove that
pnqn−1 −pn−1qn = (−1)n−1
and for n = 1, . . . , N. Prove that if ai ∈Z for i = 0, 1, . . . , N, then
(pn, qn) = 1 for n = 0, 1, . . . , N.
13. Let ⟨a0, a1, . . . , aN⟩be a ﬁnite simple continued fraction, and let pn
and qn be the numbers deﬁned in Exercise 10. Prove that
pnqn−2 −pn−2qn = (−1)nan
for n = 2, . . . , N.
14. Let x = ⟨a0, a1, . . . , aN⟩be a ﬁnite simple continued fraction, and
let pn and qn be the numbers deﬁned in Exercise 10. Prove that
the even convergents are strictly increasing, the odd convergents are
strictly decreasing, and every even convergent is less than every odd
convergent, that is,
p0
q0
< p2
q2
< p4
q4
< · · · ≤x ≤· · · p5
q5
< p3
q3
< p1
q1
.
15. We deﬁne a sequence of integers as follows:
f0
=
0,
f1
=
1,
fn
=
fn−1 + fn−2
for n ≥2.
The integer fn is called the nth Fibonacci number. Compute the Fi-
bonacci numbers fn for n = 2, 3, . . . , 12. Prove that (fn, fn+1) = 1
for all nonnegative integers n.
In Exercises 16–23, fn denotes the nth Fibonacci number.

24
1. Divisibility and Primes
16. Compute the convergents pn/qn of the simple continued fraction
⟨1, 1, 1, 1, 1, 1, 1⟩. Observe that
pn
qn
= fn+1
fn
for n = 0, 1, . . . , 6.
17. Prove that
f1 + f2 + · · · + fn = fn+2 −1
for all positive integers n.
18. Prove that
fn+1fn−1 −f 2
n = (−1)n
for all positive integers n.
19. Prove that
fn = fk+1fn−k + fkfn−k−1
for all k = 0, 1, . . . , n. Equivalently,
fn
=
fn−1 + fn−2 = 2fn−2 + fn−3
=
3fn−3 + 2fn−4 = 5fn−4 + 3fn−5 · · · .
20. Prove that fn divides fℓn for all positive integers ℓ.
21. Prove that, for n ≥1,

fn+1
fn
fn
fn−1

=

1
1
1
0
n
.
22. Let
α = 1 +
√
5
2
and
β = 1 −
√
5
2
.
Prove that
fn = αn −βn
√
5
for all n ≥0.
Prove that
fn ∼αn
√
5
as n →∞
and
fn ≥αn−2
for n ≥2.

1.4 The Fundamental Theorem of Arithmetic
25
23. (Lam´e’s theorem) Let a and b be positive integers with a > b. The
length of the Euclidean algorithm for a and b, denoted by E(a, b), is
the number of divisions required to ﬁnd the greatest common divisor
of a and b. Prove that
E(a, b) ≤log b
log α + 1,
where α = (1 +
√
5)/2.
Hint: Let n = E(a, b). Set r0 = a and r1 = b. For i = 1, . . . , n, let
ri−1 = riqi−1 + ri+1,
where the positive integers q0, q1, . . . , qn−1 are the partial quotients
and r2, . . . , rn−1, rn are the remainders in the Euclidean algorithm.
Then
r0 > r1 > · · · > rn−1 > rn ≥1
and (a, b) = (r0, r1) = rn. Let fn be the nth Fibonacci number. Since
rn ≥1 = f2 and rn−1 ≥2 = f3, it follows that
rn−2
=
rn−1qn−2 + rn ≥f3 + f2 = f4,
rn−3
=
rn−2qn−3 + rn−1 ≥f4 + f3 = f5,
and, by induction on k,
rn−k ≥fk+2
for k = 0, 1, . . . , n. In particular,
b = r1 ≥fn+1 ≥αn−1.
1.4
The Fundamental Theorem of Arithmetic
A prime number is an integer p greater than 1 whose only positive divisors
are 1 and p. A positive integer greater than 1 that is not prime is called
composite. If n is composite, then it has a divisor d such that 1 < d < n,
and so n = dd′, where also 1 < d′ < n. The primes less than 100 are the
following:
2
3
5
7
11
13
17
19
23
29
31
37
41
43
47
53
59
61
67
71
73
79
83
89
97.
If d is a positive divisor of n, then d′ = n/d is called the conjugate divisor
to d. If n = dd′ and d ≤d′, then d ≤√n.

26
1. Divisibility and Primes
We shall prove that every positive integer can be written as the product
of prime numbers (with the convention that the empty product is equal to
1), and that this representation is unique except for the order in which the
prime factors are written. This result is called the fundamental theorem of
arithmetic.
Theorem 1.7 (Euclid’s lemma) Let a, b, c be integers. If a divides bc
and (a, b) = 1, then a divides c.
Proof. Since a divides bc, we have bc = aq for some integer q. Since a
and b are relatively prime, Theorem 1.5 implies that there exist integers x
and y such that
1 = ax + by.
Multiplying by c, we obtain
c = acx + bcy = acx + aqy = a(cx + qy),
and so a divides c. This completes the proof. 2
Theorem 1.8 Let k ≥2, and let a, b1, b2, . . . , bk be integers. If (a, bi) = 1
for all i = 1, . . . , k, then (a, b1b2 · · · bk) = 1.
Proof. The proof is by induction on k. Let k = 2 and d = (a, b1b2). We
must show that d = 1. Since d divides a and (a, b1) = 1, it follows that
(d, b1) = 1. Since d divides b1b2, Euclid’s lemma implies that d divides b2.
Therefore, d is a common divisor of a and b2, but (a, b2) = 1 and so d = 1.
Let k ≥3, and assume that the result holds for k −1. Let a, b1, . . . , bk
be integers such that (a, bi) = 1 for i = 1, . . . , k. The induction assumption
implies that (a, b1 · · · bk−1) = 1. Since we also have (a, bk) = 1, it follows
from the case k = 2 that (a, b1 · · · bk−1bk) = 1. This completes the proof.
2
Theorem 1.9 If a prime number p divides a product of integers, then p
divides one of the factors.
Proof. Let b1, b2, . . . , bk be integers such that p divides b1 · · · bk. By The-
orem 1.8, we have (p, bi) > 1 for some i. Since p is prime, it follows that p
divides bi. 2
Theorem 1.10 (Fundamental theorem of arithmetic) Every positive
integer can be written uniquely (up to order) as the product of prime num-
bers.

1.4 The Fundamental Theorem of Arithmetic
27
Proof. First we prove that every positive integer can be written as a
product of primes. Since an empty product is equal to 1, we can write 1
as the empty product of primes. Let n ≥2. Suppose that every positive
integer less than n is a product of primes. If n is prime, we are done. If
n is composite, then n = dd′, where 1 < d ≤d′ < n. By the induction
hypothesis, d and d′ are both products of primes, and so n = dd′ is a
product of primes.
Next we use induction to prove that this representation is unique. The
representation of 1 as the product of the empty set of primes is unique.
Let n ≥2 and assume that the statement is true for all positive inte-
gers less than n. We must show that if n = p1 · · · pk = p′
1 · · · p′
ℓ, where
p1, . . . , pk, p′
1, . . . , p′
ℓare primes, then k = ℓand there is a permutation σ
of 1, . . . , k such that pi = p′
σ(i) for i = 1, . . . , k. By Theorem 1.9, since pk
divides p′
1 · · · p′
ℓ, there exists an integer j0 ∈{1, . . . , ℓ} such that pk divides
p′
j0, and so pk = p′
j0 since p′
j0 is prime. Therefore,
n
pk
= p1 · · · pk−1 =
ℓ

j=1
j̸=j0
p′
j < n.
It follows from the induction hypothesis that k −1 = ℓ−1, and there is
a one-to-one map σ from {1, . . . , k −1} into {1, . . . , k} \ {j0} such that
pi = p′
σ(i) for i = 1, . . . , k −1. Let σ(k) = j0. This deﬁnes the permutation
σ, and the proof is complete. 2
For any nonzero integer n and prime number p, we deﬁne vp(n) as the
greatest integer r such that pr divides n. Then vp(n) is a nonnegative
integer, and vp(n) ≥1 if and only if p divides n. If vp(n) = r, then we say
that the prime power pr exactly divides n, and write pr∥n. The standard
factorization of n is
n =

p|n
pvp(n).
Since every positive integer is divisible by only a ﬁnite number of primes,
we can also write
n =

p
pvp(n),
where the product is an inﬁnite product over the set of all prime numbers,
and vp(n) = 0 and pvp(n) = 1 for all but ﬁnitely many primes p. The
function vp(n) is called the p-adic value of n. It is completely additive in
the sense that vp(mn) = vp(m) + vp(n) for all positive integers m and n
(Exercise 13). For example, since n! = 1 · 2 · 3 · · · n, we have
vp(n!) =
n

m=1
vp(m).

28
1. Divisibility and Primes
The standard factorizations of the ﬁrst 60 integers are
1 = 1
21 = 3 · 7
41 = 41
2 = 2
22 = 2 · 11
42 = 2 · 3 · 7
3 = 3
23 = 23
43 = 43
4 = 22
24 = 23 · 3
44 = 22 · 11
5 = 5
25 = 52
45 = 32 · 5
6 = 2 · 3
26 = 2 · 13
46 = 2 · 23
7 = 7
27 = 33
47 = 47
8 = 23
28 = 22 · 7
48 = 24 · 3
9 = 32
29 = 29
49 = 72
10 = 2 · 5
30 = 2 · 3 · 5
50 = 2 · 52
11 = 11
31 = 31
51 = 3 · 17
12 = 22 · 3
32 = 25
52 = 22 · 13
13 = 13
33 = 3 · 11
53 = 53
14 = 2 · 7
34 = 2 · 17
54 = 2 · 33
15 = 3 · 5
35 = 5 · 7
55 = 5 · 11
16 = 24
36 = 22 · 32
56 = 23 · 7
17 = 17
37 = 37
57 = 3 · 19
18 = 2 · 32
38 = 2 · 19
58 = 2 · 29
19 = 19
39 = 3 · 13
59 = 59
20 = 22 · 5
40 = 23 · 5
60 = 22 · 3 · 5.
Let a1, . . . , ak be nonzero integers. An integer m′ is called a common
multiple of a1, . . . , ak if it is a multiple of ai for all i = 1, . . . , k, that is,
every integer ai divides m′. The least common multiple of a1, . . . , ak is a
positive integer m such that m is a common multiple of a1, . . . , ak, and m
divides every common multiple of a1, . . . , ak. For example, 910 is a common
multiple of 35 and 91, and 455 is the least common multiple. We shall show
that there is a unique least common multiple for every ﬁnite set of nonzero
integers. We denote by [a1, . . . , ak] the least common multiple of a1, . . . , ak.
Theorem 1.11 Let a1, . . . , ak be positive integers. Then
(a1, . . . , ak) =

p
pmin{vp(a1),...,vp(ak)}
and
[a1, . . . , ak] =

p
pmax{vp(a1),...,vp(ak)}.
Proof. This follows immediately from the fundamental theorem of arith-
metic. 2
Let x be a real number. Recall that the integer part of x is the greatest
integer not exceeding x, that is, the unique integer n such that n ≤x <

1.4 The Fundamental Theorem of Arithmetic
29
n+1. We denote the integer part of x by [x]. For example,
 4
3

= 1, [
√
7] = 2,
and

−4
3

= −2. The fractional part of x is the real number
{x} = x −[x] ∈[0, 1).
Thus,
 4
3

= 1
3 and

−4
3

= 2
3. We can use the greatest integer function
to compute the standard factorization of factorials.
Theorem 1.12 For every positive integer n and prime p,
vp(n!) =
[
log n
log p ]

r=1
 n
pr

.
Proof. Let 1 ≤m ≤n. If pr divides m, then pr ≤m ≤n and r ≤
log n/ log p. Since r is an integer, we have r ≤[log n/ log p] and
vp(m) =
[
log n
log p ]

r=1
pr|m
1.
The number of positive integers not exceeding n that are divisible by pr is
exactly [n/pr], and so
vp(n!)
=
n

m=1
vp(m) =
n

m=1
[
log n
log p ]

r=1
pr|m
1
=
[
log n
log p ]

r=1
n

m=1
pr|m
1 =
[
log n
log p ]

r=1
 n
pr

.
This completes the proof. 2
We shall use Theorem 1.12 to compute the standard factorization of 10!.
The primes not exceeding 10 are 2, 3, 5, and 7, and
v2(10!) =
10
2

+
10
4

+
10
8

= 5 + 2 + 1 = 8,
v3(10!) =
10
3

+
10
9

= 4,
v5(10!) =
10
5

= 2,
v7(10!) =
10
7

= 1.

30
1. Divisibility and Primes
Therefore,
10! = 2834527.
For every nonzero integer m, the radical of m, denoted by rad(m), is the
product of the distinct primes that divide m, that is,
rad(m) =

p|m
p =

vp(m)≥1
p.
For example, rad(15) = rad(−45) = rad(225) = 15 and rad(pr) = p for p
prime and r ≥1.
Theorem 1.13 Let m and a be nonzero integers. There exists a positive
integer k such that m divides ak if and only if rad(m) divides rad(a).
Proof. We know that m divides ak if and only if vp(m) ≤vp(ak) =
kvp(a) for every prime p (Exercise 14). If there exists an integer k such
that m divides ak, then vp(a) > 0 whenever vp(m) > 0, and so every prime
that divides m also divides a. This implies that rad(m) divides rad(a).
Conversely, if rad(m) divides rad(a), then vp(a) > 0 for every prime p
such that vp(m) > 0. Since only ﬁnitely many primes divide m, it follows
that there exists a positive integer k such that vp(ak) = kvp(a) ≥vp(m)
for all primes p, and so m divides ak. 2
Exercises
1. Factor 51, 948 into a product of primes.
2. Factor 10k + 1 into a product of primes for k = 1, 2, 3, 4, 5.
3. Find the greatest common divisor and least common multiple of a =
2338712132 and b = 365511213.
4. Compute the least common multiple of the integers 1, 2, 3, . . . , 15.
5. Compute the standard factorization of 15!.
6. Prove that n, n + 2, n + 4 are all primes if and only if n = 3.
7. Prove that n, n + 4, n + 8 are all primes if and only if n = 3.
8. Let n ≥2. Prove that (n + 1)! + k is composite for k = 2, . . . , n + 1.
This shows that there exist arbitrarily long intervals of composite
numbers.
9. Prove that n5 −n is divisible by 30 for every integer n.
10. Find all primes p such that 29p + 1 is a square.

1.4 The Fundamental Theorem of Arithmetic
31
11. The prime numbers p and q are called twin primes if |p −q| = 2. Let
p and q be primes. Prove that pq + 1 is a square if and only if p and
q are twin primes.
12. Prove that if p and q are twin primes greater than 3, then p + q is
divisible by 12.
13. Let m, n, and k be positive integers. Prove that
vp(mn) = vp(m) + vp(n)
and
vp(mk) = kvp(m).
14. Let d and m be nonzero integers. Prove that d divides m if and only
if vp(d) ≤vp(m) for all primes p.
15. Let m = k
i=1 pri
i , where p1, . . . , pk are distinct primes, k ≥2, and
ri ≥1 for i = 1, . . . , k. Let mi = mp−ki
i
for i = 1, . . . , k. Prove that
(m1, . . . , mk) = 1.
16. Let a, b, and c be positive integers. Prove that (ab, c) = 1 if and only
if (a, c) = (b, c) = 1.
17. Prove that if 6 divides m, then there exist integers b and c such that
m = bc and 6 divides neither b nor c.
18. Prove the following statement or construct a counterexample: If d is
composite and d divides m, then there exist integers b and c such
that m = bc and d divides neither b nor c.
19. Let a and b be positive integers. Prove that (a, bc) = (a, b)(a, c) for
every positive integer c if and only if (a, b) = 1.
20. Let m1, . . . , mk be pairwise relatively prime positive integers, and let
d divide m1 · · · mk. Prove that for each i = 1, . . . , k there exists a
unique divisor di of mi such that d = d1 · · · dk.
21. Let n ≥2. Prove that the equation yn = 2xn has no solution in
positive integers.
22. Let n ≥2, and let x be a rational number. Prove that
n√x is rational
if and only if x = yn for some rational number y.
23. Let m1, . . . , mk be positive integers and m = [m1, . . . , mk]. Prove
that there exist positive integers d1, . . . , dk such that di is a divisor
of mi for i = 1, . . . , k, (di, dj) = 1 for 1 ≤i < j ≤n, and m =
[d1, . . . , dk] = d1 · · · dk.
24. Prove that for any positive integers a and b,
[a, b] =
ab
(a, b).

32
1. Divisibility and Primes
25. Let a and b be positive integers with (a, b) = d. Prove that
a
d, b
d

= [a, b]
d
.
26. Prove that for any positive integers a, b, c,
[a, b, c] =
abc(a, b, c)
(a, b)(b, c)(c, a).
27. Let a1, . . . , ak be positive integers. Prove that [a1, . . . , ak] = a1 · · · ak
if and only if the integers a1, . . . , ak are pairwise relatively prime.
28. Let a and b be positive integers and p a prime. Prove that if p divides
[a, b] and p divides a + b, then p divides (a, b).
29. Let a and b be positive integers such that
a + b = 57
and
[a, b] = 680.
Find a and b.
Hint: Show that a and b are relatively prime. Then a(57 −a) = ab =
[a, b].
30. Let aZ = {ax : x ∈Z} denote the set of all multiples of a. Prove that
for any integers a1, . . . , ak,
k
i=1
aiZ = [a1, . . . , ak]Z.
31. A positive integer is called square-free if it is the product of dis-
tinct prime numbers. Prove that every positive integer can be written
uniquely as the product of a square and a square-free integer.
32. Prove that the set of all rational numbers of the form a/b, where
a, b ∈Z and b is square-free, is an additive subgroup of Q.
33. A powerful number is a positive integer n such that if a prime p
divides n, then p2 divides n. Prove that every powerful number can
be written as the product of a square and a cube. Construct examples
to show that this representation of powerful numbers is not unique.
34. Prove that m is square-free if and only if rad(m) = m.
35. Prove that rad(mn) = rad(m)rad(n) if and only if (m, n) = 1.

1.5 Euclid’s Theorem and the Sieve of Eratosthenes
33
36. Let H = {1, 5, 9, . . .} be the arithmetic progression of all positive
integers of the form 4k+1. Elements of H are called Hilbert numbers.
Show that H is closed under multiplication, that is, x, y ∈H implies
xy ∈H. An element x of H will be called a Hilbert prime if x ̸= 1 and
x cannot be written as the product of two strictly smaller elements
of H. Compute all the Hilbert primes up to 100. Prove that every
element of H can be factored into a product of Hilbert primes, but
that unique factorization does not hold in H.
Hint: Find two essentially distinct factorizations of 441 into a product
of Hilbert primes.
37. For n ≥1, consider the rational number
hn = 1 + 1
2 + 1
3 + · · · + 1
n.
Prove that hn is not an integer for any n ≥2.
Hint: Let 2a be the largest power of 2 not exceeding n. Let P be the
product of the odd positive integers not exceeding n. Consider the
number 2a−1Phn.
1.5
Euclid’s Theorem and the Sieve of
Eratosthenes
How many primes are there? The fundamental theorem of arithmetic tells
us that every number is uniquely the product of primes, but it does not
give us the number of primes. Euclid proved that the number of primes is
inﬁnite. The following proof is also due to Euclid. It has retained its power
for more than two thousand years.
Theorem 1.14 (Euclid’s theorem) There are inﬁnitely many primes.
Proof. Let p1, . . . , pn be any ﬁnite set of prime numbers. Consider the
integer
N = p1 · · · pn + 1.
Since N > 1, it follows from the fundamental theorem of arithmetic that N
is divisible by some prime p. If p = pi for some i = 1, . . . , n, then p divides
N −p1 · · · pn = 1, which is absurd. Therefore, p ̸= pi for all i = 1, . . . , n.
This means that, for any ﬁnite set of primes, there always exists a prime
that does not belong to the set, and so the number of primes is inﬁnite. 2
Let π(x) denote the number of primes not exceeding x. Then π(x) = 0
for x < 2, π(x) = 1 for 2 ≤x < 3, π(x) = 2 for 3 ≤x < 5, and so on.

34
1. Divisibility and Primes
Euclid’s theorem says that there are inﬁnitely many prime numbers, that
is,
lim
x→∞π(x) = ∞,
but it does not tell us how to determine them. We can compute all the
prime numbers up to x by using a beautiful and eﬃcient method called the
sieve of Eratosthenes. The sieve is based on a simple observation. If the
positive integer n is composite, then n can be written in the form n = dd′,
where 1 < d ≤d′ < n. If d > √n, then
n = dd′ > √n√n = n,
which is absurd. Therefore, if n is composite, then n has a divisor d such
that 1 < d ≤√n. In particular, every composite number n ≤x is divisible
by a prime p ≤√x.
To ﬁnd all the primes up to x, we write down the integers between 1
and x, and eliminate numbers from the list according to the following rule:
Cross out 1. The ﬁrst number in the list that is not eliminated is 2; cross
out all multiples of 2 that are greater than 2. The iterative procedure is as
follows: Let d be the smallest number on the list whose multiples have not
already been eliminated. If d ≤√x, then cross out all multiples of d that
are greater than d. If d > √x, stop. This algorithm must terminate after
at most √x steps. The prime numbers up to x are the numbers that have
not been crossed out.
We shall demonstrate this method to ﬁnd the prime numbers up to 60.
We must sieve out by the prime numbers less than
√
60, that is, by 2, 3, 5,
and 7. Here is the list of numbers up to 60:
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
We cross out 1 and all multiples of 2 beginning with 4:
̸ 1
2
3
̸ 4
5
̸ 6
7
̸ 8
9
̸ 10
11
̸ 12
13
̸ 14
15
̸ 16
17
̸ 18
19
̸ 20
21
̸ 22
23
̸ 24
25
̸ 26
27
̸ 28
29
̸ 30
31
̸ 32
33
̸ 34
35
̸ 36
37
̸ 38
39
̸ 40
41
̸ 42
43
̸ 44
45
̸ 46
47
̸ 48
49
̸ 50
51
̸ 52
53
̸ 54
55
̸ 56
57
̸ 58
59
̸ 60

1.5 Euclid’s Theorem and the Sieve of Eratosthenes
35
Next we cross out all multiples of 3 beginning with 6:
̸ 1
2
3
̸ 4
5
̸ 6
7
̸ 8
̸ 9
̸ 10
11
̸ 12
13
̸ 14
̸ 15
̸ 16
17
̸ 18
19
̸ 20
̸ 21
̸ 22
23
̸ 24
25
̸ 26
̸ 27
̸ 28
29
̸ 30
31
̸ 32
̸ 33
̸ 34
35
̸ 36
37
̸ 38
̸ 39
̸ 40
41
̸ 42
43
̸ 44
̸ 45
̸ 46
47
̸ 48
49
̸ 50
̸ 51
̸ 52
53
̸ 54
55
̸ 56
̸ 57
̸ 58
59
̸ 60
Next we cross out all multiples of 5 beginning with 10:
̸ 1
2
3
̸ 4
5
̸ 6
7
̸ 8
̸ 9
̸ 10
11
̸ 12
13
̸ 14
̸ 15
̸ 16
17
̸ 18
19
̸ 20
̸ 21
̸ 22
23
̸ 24
̸ 25
̸ 26
̸ 27
̸ 28
29
̸ 30
31
̸ 32
̸ 33
̸ 34
̸ 35
̸ 36
37
̸ 38
̸ 39
̸ 40
41
̸ 42
43
̸ 44
̸ 45
̸ 46
47
̸ 48
49
̸ 50
̸ 51
̸ 52
53
̸ 54
̸ 55
̸ 56
̸ 57
̸ 58
59
̸ 60
Finally, we cross out all multiples of 7 beginning with 14:
̸ 1
2
3
̸ 4
5
̸ 6
7
̸ 8
̸ 9
̸ 10
11
̸ 12
13
̸ 14
̸ 15
̸ 16
17
̸ 18
19
̸ 20
̸ 21
̸ 22
23
̸ 24
̸ 25
̸ 26
̸ 27
̸ 28
29
̸ 30
31
̸ 32
̸ 33
̸ 34
̸ 35
̸ 36
37
̸ 38
̸ 39
̸ 40
41
̸ 42
43
̸ 44
̸ 45
̸ 46
47
̸ 48
̸ 49
̸ 50
̸ 51
̸ 52
53
̸ 54
̸ 55
̸ 56
̸ 57
̸ 58
59
̸ 60
The numbers that have not been crossed out are:
2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59.
These are the prime numbers up to 60.
Exercises
1. Use the sieve of Eratosthenes to ﬁnd the prime numbers up to 210.
Compute π(210).
2. Let N = 210. Prove that N −p is prime for every prime p such that
N/2 < p < N. Find a prime number q < N/2 such that N −q is
composite.
3. Let N = 105. Show that N −2n is prime whenever 2 ≤2n < N. This
statement is also true for N = 7, 15, 21, 45, and 75. It is not known
whether N = 105 is the largest integer with this property.
4. Let N = 199. Show that N −2n2 is prime whenever 2n2 < N. It is
not known whether N = 199 is the largest integer with this property.

36
1. Divisibility and Primes
5. Let a and n be positive integers. Prove that an −1 is prime only
if a = 2 and n = p is prime. Primes of the form Mp = 2p −1
are called Mersenne primes. Compute the ﬁrst ﬁve Mersenne primes.
The largest known primes are Mersenne primes. It is an unsolved
problem to determine whether there are inﬁnitely many Mersenne
primes. There is a list of all known Mersenne primes in the Notes at
the end of this chapter.
6. Let k be a positive integer. Prove that if 2k +1 is prime, then k = 2n.
The integer
Fn = 22n + 1
is called the nth Fermat number. Primes of the form 22n +1 are called
Fermat primes. Show that Fn is prime for n = 1, 2, 3, 4.
7. Prove that F5 is divisible by 641, and so F5 is composite.
Hint: Observe that
F5 = 225 −1 = (232 + 54 · 228) −(54 · 228 −1)
and
641 = 24 + 54 = 5 · 27 + 1.
Prove that 641 divides both 54 · 228 + 232 and 54 · 228 −1.
It is an unsolved problem to determine whether there are inﬁnitely
many Fermat primes. Indeed, we do not know whether Fn is prime
for any n > 4.
8. Modify the proof of Theorem 1.14 to prove that there are inﬁnitely
many prime numbers whose remainder is 3 when divided by 4.
Hint: Let p1, p2, . . . , pn be primes of the form 4k + 3, pi ̸= 3. Let
N = 4p1p2 · · · pn + 3. Show that N must be divisible by some prime
q of the form 4k + 3.
9. Show that every prime number except 2 and 3 has a remainder of 1
or 5 when divided by 6. Prove that there are inﬁnitely many prime
numbers whose remainder is 5 when divided by 6.
10. Prove that π(n) ≤n/2 for n ≥8.
11. Prove that π(n) ≤n/3 for n ≥33.
Hint: Prove the following assertions. (i) If n0 ≥3, then there are
at most two primes among the 6 consecutive integers n0 + 1, n0 +
2, . . . , n0 + 6. (ii) Suppose that n0 ≥3 and π(n0) ≤n0/3. Let
n = n0 + 6k for some positive integer k. Then π(n) ≤n/3. (iii)
Show (by computation) that π(32) > 32/3 but π(n0) ≤n0/3 for
n0 = 33, 34, . . . , 38. (iv) Show that every integer n ≥33 can be
written in the form n0 + 6k for some nonnegative integer k and
n0 ∈{33, 34, . . . , 38}.

1.6 A Linear Diophantine Equation
37
12. Let n0 ≥6. Prove that if π(n0) ≤4n0/15 and n = n0 + 30k, then
π(n) ≤4n/15.
13. Let 2 = p1 < p2 < · · · be the sequence of primes in increasing order.
Prove that
pn ≤22n−1
for all n ≥1.
Hint: Show that the method used to prove Euclid’s theorem (Theo-
rem 1.14) also proves that pn+1 ≤p1 · · · pn + 1.
14. Let log2 x denote the logarithm of x to the base 2. Prove that
π(x) > log2 log2 x
for all x > 1.
Hint: Exercise 14.
15. Let p1, . . . , pk be a ﬁnite set of prime numbers. Prove that the num-
ber of positive integers n ≤x that can be written in the form
n = pr1
1 · · · prk
k is at most
k

i=1
 log x
log pi
+ 1

.
Prove that if x is suﬃciently large, then there are positive integers
n ≤x that cannot be represented in this way. Use this to give another
proof that the number of primes is inﬁnite.
1.6
A Linear Diophantine Equation
A diophantine equation is an equation of the form
f(x1, . . . , xk) = b
that we want to solve in rational numbers, integers, or nonnegative integers.
This means that the values of the variables x1, . . . , xk will be rationals,
integers, or nonnegative integers. Usually the function f(x1, . . . , xk) is a
polynomial with rational or integer coeﬃcients.
In this section we consider the linear diophantine equation
a1x1 + · · · + akxk = b.
We want to know when this equation has a solution in integers, and when
it has a solution in nonnegative integers. For example, the equation
3x1 + 5x2 = b

38
1. Divisibility and Primes
has a solution in integers for every integer b, and a solution in nonnegative
integers for b = 0, 3, 5, 6, and all b ≥8 (Exercise 1).
Theorem 1.15 Let a1, . . . , ak be integers, not all zero. For any integer b,
there exist integers x1, . . . , xk such that
a1x1 + · · · + akxk = b
(1.4)
if and only if b is a multiple of (a1, . . . , ak). In particular, the linear equa-
tion (1.4) has a solution for every integer b if and only if the numbers
a1, . . . , ak are relatively prime.
Proof. Let d = (a1, . . . , ak). If equation (1.4) is solvable in integers xi,
then d divides b since d divides each integer ai. Conversely, if d divides
b, then b = dq for some integer q. By Theorem 1.4, there exist integers
y1, . . . , yk such that
a1y1 + · · · + akyk = d.
Let xi = yiq for i = 1, . . . , k. Then
a1x1 + · · · + akxk = a1(y1q) + · · · + ak(ykq) = dq = b
is a solution of (1.4). It follows that (1.4) is solvable in integers for every b
if and only if (a1, . . . , ak) = 1. 2
Theorem 1.16 Let a1, . . . , ak be positive integers such that
(a1, . . . , ak) = 1.
If
b ≥(ak −1)
k−1

i=1
ai,
then there exist nonnegative integers x1, . . . , xk such that
a1x1 + · · · + akxk = b.
Proof. By Theorem 1.15, there exist integers z1, . . . , zk such that
a1z1 + · · · + akzk = b.
Using the division algorithm, we can divide each of the integers z1, . . . , zk−1
by ak so that
zi = akqi + xi
and
0 ≤xi ≤ak −1

1.6 A Linear Diophantine Equation
39
for i = 1, . . . , k −1. Let
xk = zk +
k−1

i=1
aiqi.
Then
b
=
a1z1 + · · · + ak−1zk−1 + akzk
=
a1(akq1 + x1) + · · · + ak−1(akqk−1 + xk−1) + akzk
=
a1x1 + · · · + ak−1xk−1 + ak

zk +
k−1

i=1
aiqi

=
a1x1 + · · · + ak−1xk−1 + akxk
≤
(ak −1)
k−1

i=1
ai + akxk,
where xk is an integer, possibly negative. However, if
b ≥(ak −1)
k−1

i=1
ai,
then akxk ≥0 and so xk ≥0. This completes the proof. 2
Let a1, . . . , ak be relatively prime positive integers. Since every suﬃ-
ciently large integer can be written as a nonnegative integral linear combi-
nation of a1, . . . , ak, it follows that there exists a smallest integer
G(a1, . . . , ak)
such that every integer b ≥G(a1, . . . , ak) can be represented in the form (1.4),
where the variables x1, . . . , xk are nonnegative integers. The example above
shows that
G(3, 5) = 8.
The linear diophantine problem of Frobenius is to determine G(a1, . . . , ak)
for all ﬁnite sets of relatively prime positive integers a1, . . . , ak. This is a
diﬃcult open problem, but there are some special cases where the solution
is known. The following theorem solves the Frobenius problem in the case
k = 2.
Theorem 1.17 Let a1 and a2 be relatively prime positive integers. Then
G(a1, a2) = (a1 −1)(a2 −1).

40
1. Divisibility and Primes
Proof. We saw in the proof of Theorem 1.15 that for every integer b
there exist integers x1 and x2 such that
b = a1x1 + a2x2
and
0 ≤x1 ≤a2 −1.
(1.5)
If we have another representation
b = a1x′
1 + a2x′
2,
and
0 ≤x′
1 ≤a2 −1,
then
a1(x1 −x′
1) = a2(x′
2 −x2).
Since a2 divides a1(x1−x′
1) and (a1, a2) = 1, Euclid’s lemma (Theorem 1.7)
implies that a2 divides x1 −x′
1. Then x1 = x′
1, since |x1 −x′
1| ≤a2 −1. It
follows that x2 = x′
2, and so the representation (1.5) is unique.
If the integer b cannot be represented as a nonnegative integral combina-
tion of a1 and a2, then we must have x1 ≤−1 in the representation (1.5).
This implies that
b = a1x1 + a2x2 ≤a1(a2 −1) + a2(−1) = (a1 −1)(a2 −1) −1,
and so G(a1, a2) ≤(a1 −1)(a2 −1). On the other hand, since
a1(a2 −1) + a2(−1) = a1a2 −a1 −a2 < a1a2,
it follows that if
a1a2 −a1 −a2 = a1x1 + a2x2
for any nonnegative integers x1 and x2, then 0 ≤x1 ≤a2 −1. By the
uniqueness of the representation (1.5), we must have x1 = a2 −1 and
x2 = −1. Therefore, the integer a1a2 −a1 −a2 cannot be represented as a
nonnegative integral linear combination of a1 and a2, and so G(a1, a2) =
(a1 −1)(a2 −1). 2
Exercises
1. Prove that the equation
3x1 + 5x2 = b
has a solution in integers for every integer b, and a solution in non-
negative integers for b = 0, 3, 5, 6 and all b ≥8.
2. Find all solutions in nonnegative integers x1 and x2 of the linear
diophantine equation
2x1 + 7x2 = 53.

1.6 A Linear Diophantine Equation
41
3. Find all solutions in nonnegative integers x1 and x2 of the linear
diophantine equation
28x1 + 35x2 = 136.
4. Let a1 and a2 be relatively prime positive integers. Let N(a1, a2)
denote the number of nonnegative integers that cannot be represented
in the form
a1x1 + a2x2
with x1, x2 nonnegative integers. Compute N(3, 10) and N(3, 10)/G(3, 10).
5. Compute N(7, 8) and N(7, 8)/G(7, 8).
6. Find all nonnegative integers that cannot be represented by the form
3x1 + 10x2 + 14x3
with x1, x2, x3 nonnegative integers. Compute G(3, 10, 14).
7. Let a1 and a2 be relatively prime positive integers. Let M be the set of
all integers n such that 0 ≤n ≤a1a2−a1−a2 and n can be written in
the form n = a1x1 + a2x2, where x1 and x2 are nonnegative integers.
Let N be the set of all integers n such that 0 ≤n ≤a1a2 −a1 −a2
and n cannot be written in the form n = a1x1 + a2x2, where x1 and
x2 are nonnegative integers. Then |N| = N(a1, a2) and |M| + |N| =
(a1 −1)(a2 −1). Let n ∈[0, a1a2 −a1 −a2], and write n in the form
n = a1x1 + a2x2,
where 0 ≤x1 ≤a2 −1.
This representation is unique. Deﬁne the function f by
f(n) = a1a2 −a1 −a2 −n = a1(a2 −1 −x1) −a2(x2 + 1).
Prove that f is an involution that maps M onto N and N onto M,
and so
|M| = |N| = (a1 −1)(a2 −1)
2
and
N(a1, a2)
G(a1, a2) = 1
2.
8. Find all solutions in nonnegative integers x1, x2, and x3 of the linear
diophantine equation
6x1 + 10x2 + 15x3 = 30.

42
1. Divisibility and Primes
9. Find all solutions in integers x1, x2, and x3 of the system of linear
diophantine equations
3x1 + 5x2 + 7x3 = 560,
9x1 + 25x2 + 49x3 = 2920.
10. Find all solutions of the Ramanujan-Nagell diophantine equation
x2 + 7 = 2n
with x ≤1000.
11. Find all solutions of the Ljunggren diophantine equation
x2 −2y4 = −1
with x ≤1000.
12. When is the sum of a geometric progression equal to a power? Equiva-
lently, what are the solutions of the exponential diophantine equation
1 + x + x2 + · · · + xm = yn
(1.6)
in integers x, m, y, n greater than 2? Check that
1 + 3 + 32 + 33 + 34 = 112,
1 + 7 + 72 + 73 = 202,
and
1 + 18 + 182 = 73.
These are the only known solutions of (1.6).
1.7
Notes
I can hardly do better than go back to the Greeks. I will state
and prove two of the famous theorems of Greek mathematics.
They are ‘simple’ theorems, simple both in idea and in execu-
tion, but there is no doubt at all about their being theorems of
the highest class. Each is as fresh and signiﬁcant as when it was
discovered—two thousand years have not written a wrinkle on
either of them.
G. H. Hardy [51, p. 92]

1.7 Notes
43
Number theory is an ancient subject. The famous theorems to which Hardy
refers are the theorems that there are inﬁnitely many primes (Theorem 1.14)
and that
√
2 is irrational (Exercise 22 in Section 1.4). These appear in Eu-
clid’s Elements [61, Book IX, Proposition 20, and Book X, Proposition 9].
The Euclidean algorithm also appears in Euclid [61, Book VII, Proposi-
tion 2]. For fragments of number theory in Babylonian mathematics, see
Neugebauer [110] and van der Waerden [147].
There are many excellent introductions to elementary number theory.
My favorite is Number Theory for Beginners by Andr´e Weil [152]. Two
classic works are Hardy and Wright [60] and Landau [87]. Other inter-
esting books are Davenport [22], Hua [68], Kumanduri and Romero [85]
and Ireland and Rosen [72]. There are beautiful introductions to algebraic
number theory by Borevich and Shafarevich [13], Hecke [63, 64], Lang [90],
and Neukirch [111], and to analytic number theory by Apostol [3], Dav-
enport [21], Rademacher [119], and Serre [131, 132]. An excellent survey
volume is Manin and Panchishkin, Introduction to Number Theory [96].
The best history is Weil, Number Theory: An Approach through History.
From Hammurapi to Legendre [153]. There is also Leonard Eugene Dick-
son’s encyclopedic but unreadable three-volume History of the Theory of
Numbers [25].
Guy’s Unsolved Problems in Number Theory [45] is a nice survey of un-
usual problems and results in elementary number theory.
For a reﬁnement of Theorem 1.16, see Nathanson [101].
Lang’s Algebra [89] is the standard reference for the algebra used in this
book.
In October, 1999, only 38 Mersenne primes had been discovered. The list
of these primes is as follows:
22 −1
23 −1
25 −1
27 −1
213 −1
217 −1
219 −1
231 −1
261 −1
289 −1
2107 −1
2127 −1
2521 −1
2607 −1
21279 −1
22203 −1
22281 −1
23217 −1
24253 −1
24423 −1
29689 −1
29941 −1
211213 −1
219937 −1
221701 −1
223209 −1
244497 −1
286243 −1
2110503 −1
2132049 −1
2216091 −1
2756839 −1
2859433 −1
21257787 −1
21398269 −1
22976221 −1
23021377 −1
26972593 −1.
The largest prime known in October, 1999 was the Mersenne prime M6972593.
An Internet site devoted to Mersenne primes and related problems in num-
ber theory is www.mersenne.org.

2
Congruences
2.1
The Ring of Congruence Classes
Let m be a positive integer. If a and b are integers such that a−b is divisible
by m, then we say that a and b are congruent modulo m, and write
a ≡b
(mod m).
Integers a and b are called incongruent modulo m if they are not congruent
modulo m. For example, −12 ≡43
(mod 5) and −12 ≡43
(mod 11),
but −12 ̸≡43
(mod 7). Every even integer is congruent to 0 modulo 2,
and every odd integer is congruent to 1 modulo 2. If x is not divisible by
3, then x2 ≡1
(mod 3).
Congruence modulo m is an equivalence relation, since for all integers
a, b, and c we have
(i) Reﬂexivity: a ≡a
(mod m),
(ii) Symmetry: If a ≡b
(mod m), then b ≡a
(mod m), and
(iii) Transitivity: If a ≡b
(mod m) and b ≡c
(mod m), then a ≡c
(mod m).
Properties (i) and (ii) follow immediately from the deﬁnition of congruence.
To prove (iii), we observe that if a ≡b
(mod m) and b ≡c
(mod m),
then there exist integers x and y such that a −b = mx and b −c = my.
Since
a −c = (a −b) + (b −c) = mx + my = m(x + y),

46
2. Congruences
it follows that a ≡c
(mod m). The equivalence class of an integer a under
this relation is called the congruence class of a modulo m, and written
a+mZ. Thus, a+mZ is the set of all integers b such that b ≡a
(mod m),
that is, the set of all integers of the form a + mx for some integer x. If
(a + mZ) ∩(b + mZ) ̸= ∅, then a + mZ = b + mZ. We denote by Z/mZ
the set of all congruence classes modulo m.
A congruence class modulo m is also called a residue class modulo m.
By the division algorithm, we can write every integer a in the form
a = mq + r, where q and r are integers and 0 ≤r ≤m −1. Then a ≡r
(mod m), and r is called the least nonnegative residue of a modulo m.
If a ≡0
(mod m) and |a| < m, then a = 0, since 0 is the only integral
multiple of m in the open interval (−m, m). This implies that if a ≡b
(mod m) and |a−b| < m, then a = b. In particular, if r1, r2 ∈{0, 1, . . . , m−
1} and if a ≡r1
(mod m) and a ≡r2
(mod m), then r1 = r2. Thus,
every integer belongs to a unique congruence class of the form r + mZ,
where 0 ≤r ≤m −1, and so
Z/mZ = {mZ, 1 + mZ, . . . , (m −1) + mZ}.
The integers 0, 1, . . . , m −1 are pairwise incongruent modulo m.
A set of integers R = {r1, . . . , rm} is called a complete set of residues
modulo m if r1, . . . , rm are pairwise incongruent modulo m and every in-
teger x is congruent modulo m to some integer ri ∈R. For example, the
set {0, 2, 4, 6, 8, 10, 12} is a complete set of residues modulo 7. The set
{0, 3, 6, 9, 12, 15, 18, 21} is a complete set of residues modulo 8. The set
{0, 1, 2, . . . , m −1} is a complete set of residues modulo m for every posi-
tive integer m.
There is a natural way to deﬁne addition, subtraction, and multiplication
of congruence classes. If
a1 ≡a2
(mod m)
and
b1 ≡b2
(mod m),
then
a1 + b1 ≡a2 + b2
(mod m),
a1 −b1 ≡a2 −b2
(mod m),
and
a1b1 ≡a2b2
(mod m).
These statements are consequences of the identities
(a1 + b1) −(a2 + b2) = (a1 −a2) + (b1 −b2) ≡0
(mod m),
(a1 −b1) −(a2 −b2) = (a1 −a2) −(b1 −b2) ≡0
(mod m)

2.1 The Ring of Congruence Classes
47
and
a1b1 −a2b2 = a1(b1 −b2) + (a1 −a2)b2 ≡0
(mod m).
Addition, subtraction, and multiplication in Z/mZ are well-deﬁned if we
deﬁne the sum, diﬀerence, and product of congruence classes modulo m by
(a + mZ) + (b + mZ) = (a + b) + mZ,
(a + mZ) −(b + mZ) = (a −b) + mZ,
and
(a + mZ) · (b + mZ) = ab + mZ.
Addition of congruence classes is associative and commutative, since
((a + mZ) + (b + mZ)) + (c + mZ)
=
((a + b) + mZ) + (c + mZ)
=
((a + b) + c) + mZ
=
(a + (b + c)) + mZ
=
(a + mZ) + ((b + c) + mZ)
=
(a + mZ) + ((b + mZ) + (c + mZ))
and
(a + mZ) + (b + mZ)
=
(a + b) + mZ
=
(b + a) + mZ
=
(b + mZ) + (a + mZ).
The congruence class mZ is a zero element for addition, since mZ + (a +
mZ) = a + mZ for all a + mZ ∈Z/mZ, and the additive inverse of the
congruence class a + mZ is −a + mZ, since
(a + mZ) + (−a + mZ) = (a −a) + mZ = mZ.
From these identities we see that the set of congruence classes modulo m
is an abelian group under addition.
We have also deﬁned multiplication in Z/mZ. Multiplication is associa-
tive and commutative, since
((a + mZ)(b + mZ))(c + mZ)
=
(ab)c + mZ
=
a(bc) + mZ
=
(a + mZ)((b + mZ)(c + mZ))
and
(a + mZ)(b + mZ) = ab + mZ = ba + mZ = (b + mZ)(a + mZ).

48
2. Congruences
The congruence class 1 + mZ is an identity for multiplication, since
(1 + mZ)(a + mZ) = a + mZ
for all a + mZ ∈Z/mZ. Finally, multiplication of congruence classes is
distributive with respect to addition in the sense that
(a + mZ)((b + mZ) + (c + mZ))
=
a(b + c) + mZ)
=
(ab + mZ) + (ac + mZ)
=
(a + mZ)(b + mZ) + (a + mZ)(c + mZ)
for all a + mZ, b + mZ, c + mZ ∈Z/mZ.
A ring is a set R with two binary operations, addition and multiplication,
such that R is an abelian group under addition with additive identity 0,
and multiplication satisﬁes the following axioms:
(i) Associativity: For all x, y, z ∈R,
(xy)z = x(yz).
(ii) Identity element: There exists an element 1 ∈R such that for all
x ∈R,
1 · x = x · 1 = x.
The element 1 is called the multiplicative identity of the ring.
(iii) Distributivity: For all x, y, z ∈R,
x(y + z) = xy + xz.
The ring R is commutative if multiplication also satisﬁes the axiom
(iv) Commutativity: For all x, y ∈R,
xy = yx.
The integers, rational numbers, real numbers, and complex numbers are
examples of commutative rings. The set M2(C) of 2 × 2 matrices with
complex coeﬃcients and the usual matrix addition and multiplication is a
noncommutative ring.
Let R and S be rings with multiplicative identities 1R and 1S, respec-
tively. A map f : R →S is called a ring homomorphism if f(x + y) =
f(x) + f(y) and f(xy) = f(x)f(y) for all x, y ∈R, and f(1R) = 1S.
An element a in the ring R is called a unit if there exists an element
x ∈R such that ax = xa = 1. If a is a unit in R and x ∈R and y ∈R are
both inverses of a, then x = x(ay) = (xa)y = y, and so the inverse of a is

2.1 The Ring of Congruence Classes
49
unique. We denote the inverse of a by a−1. The set R× of all units in R is
a multiplicative group, called the group of units in the ring R. A ﬁeld is a
commutative ring in which every nonzero element is a unit. For example,
the rational, real, and complex numbers are ﬁelds. The integers form a ring
but not a ﬁeld, and the only units in the ring of integers are ±1.
The various properties of sums and products of congruence classes that
we proved in this section are equivalent to the following statement.
Theorem 2.1 For every integer m ≥2, the set Z/mZ of congruence
classes modulo m is a commutative ring.
Exercises
1. Compute the least nonnegative residue of 10k + 1 modulo 13 for k =
1, 2, 3, 4.
2. Compute the least nonnegative residue of 522 modulo 23.
3. Construct the multiplication table for the ring Z/5Z.
4. Construct the multiplication table for the ring Z/6Z.
5. Prove that every integer is congruent modulo 9 to one of the even
integers 0, 2, 4, 6, . . . , 16.
6. Let m be an odd positive integer. Prove that every integer is congru-
ent modulo m to one of the even integers 0, 2, 4, 6, . . . , 2m −2.
7. Prove that every integer is congruent modulo 9 to a unique integer r
such that −4 ≤r ≤4.
8. Let m = 2q + 1 be an odd positive integer. Prove that every integer
is congruent modulo m to a unique integer r such that −q ≤r ≤q.
9. Let m = 2q be an even positive integer. Prove that every integer is
congruent modulo m to a unique integer r such that −(q−1) ≤r ≤q.
10. Prove that a3 ≡a
(mod 6) for every integer a.
11. Prove that a4 ≡1
(mod 5) for every integer a that is not divisible
by 5.
12. Prove that if a is an odd integer, then a2 ≡1
(mod 8).
13. Let d be a positive integer that is a common divisor of a, b, and m.
Prove that
a ≡b
(mod m)
if and only if
a
d ≡b
d
(mod m
d ).

50
2. Congruences
14. Prove that if x, y, z are integers such that x2 + y2 = z2, then xyz ≡0
(mod 60).
15. Prove that a1 ≡a2
(mod m) implies ak
1 ≡ak
2
(mod m) for all
k ≥1. Prove that if f(x) is a polynomial with integer coeﬃcients and
a1 ≡a2
(mod m), then f(a1) ≡f(a2)
(mod m).
16. (A criterion for divisibility by 9.) Prove that a positive integer n is
divisible by 9 if and only if the sum of its decimal digits is divisible by
9. (For example, the sum of the decimal digits of 567 is 5+6+7 = 18.)
Hint: Prove that 10k ≡1
(mod 9) for every nonnegative integer k.
17. (A criterion for divisibility by 11.) Prove that a positive integer n is
divisible by 11 if and only if the alternating sum of its decimal digits
is divisible by 11. (For example, the alternating sum of the decimal
digits of 80, 729 is −9 + 2 −7 + 0 −8 = −22.)
Hint: Prove that 10k ≡(−1)k
(mod 11) for every nonnegative inte-
ger k.
18. Prove that if x1, . . . , xm is a sequence of m not necessarily distinct
integers, then there is a subsequence of consecutive terms whose sum
is divisible by m, that is, there exist integers 1 ≤k ≤ℓ≤m such
that
ℓ

i=k
xi ≡0
(mod m).
Hint: Consider the m+1 integers 0, x1, x1 +x2, x1 +x2 +x3, . . . , x1 +
x2 + · · · + xm.
19. Let m ≥2 and let d be a positive divisor of m −1. Let n = a0 +
a1m+· · ·+akmk be the m-adic representation of n. Prove that n ≡0
(mod d) if and only if a0 + a1 + · · · + ak ≡0
(mod d).
20. Let n be a positive integer such that n ≡3
(mod 4). Prove that n
cannot be written as the sum of two squares.
21. Prove that every integer belongs to at least one of the following 6
congruence classes:
0
(mod 2)
0
(mod 3)
1
(mod 4)
3
(mod 8)
7
(mod 12)
23
(mod 24).

2.2 Linear Congruences
51
22. Let p be prime, m ≥1, and 0 ≤k ≤p −1. Prove that
N =
mp + k
p

≡m
(mod p).
Hint: Consider the integer (p −1)!N modulo p.
23. Let G be the subset of M2(C) consisting of the four matrices

1
0
0
1

,

0
−1
1
0

,

−1
0
0
−1

,

0
1
−1
0

.
Prove that G is a multiplicative group isomorphic to the additive
group of congruence classes Z/4Z.
2.2
Linear Congruences
The following theorem is one of the most useful and important tools in
elementary number theory.
Theorem 2.2 Let m, a, b be integers with m ≥1. Let d = (a, m) be the
greatest common divisor of a and m. The congruence
ax ≡b
(mod m)
(2.1)
has a solution if and only if
b ≡0
(mod d).
If b ≡0
(mod d), then the congruence (2.1) has exactly d solutions in in-
tegers that are pairwise incongruent modulo m. In particular, if (a, m) = 1,
then for every integer b the congruence (2.1) has a unique solution modulo
m.
Proof. Let d = (a, m). Congruence (2.1) has a solution if and only if
there exist integers x and y such that
ax −b = my,
or, equivalently,
b = ax −my.
By Theorem 1.15, this is possible if and only if b ≡0
(mod d).
If x and x1 are solutions of (2.1), then
a(x1 −x) ≡ax1 −ax ≡b −b ≡0
(mod m),
and so
a(x1 −x) = mz

52
2. Congruences
for some integer z. If d is the greatest common divisor of a and m, then
(a/d, m/d) = 1 and
a
d

(x −x1) =
m
d

z.
By Euclid’s lemma (Theorem 1.7), m/d divides x1 −x, and so
x1 = x + im
d
for some integer i, that is,
x1 ≡x
(mod m
d ).
Moreover, every integer x1 of this form is a solution of (2.1). An integer x1
congruent to x modulo m/d is congruent to x + im/d modulo m for some
integer i = 0, 1, . . . d−1, and the d integers x+im/d with i = 0, 1, . . . , d−1
are pairwise incongruent modulo m. Thus, the congruence (2.1) has exactly
d pairwise incongruent solutions. This completes the proof. 2
Theorem 2.3 If p is a prime, then Z/pZ is a ﬁeld.
Proof. If a + pZ ∈Z/pZ and a + pZ ̸= pZ, then a is an integer not
divisible by p. By Theorem 2.2, there exists an integer x such that ax ≡1
(mod p). This implies that
(a + pZ)(x + pZ) = 1 + pZ,
and so a + pZ is invertible. Thus, every nonzero congruence class in Z/pZ
is a unit and Z/pZ is a ﬁeld. 2
Here are some examples of linear congruences. The congruence
7x ≡3
(mod 5)
has a unique solution modulo 5 since (7, 5) = 1. The solution is x ≡4
(mod 5). The congruence
35x ≡−14
(mod 91)
(2.2)
is solvable since (35, 91) = 7 and
−14 ≡0
(mod 7).
Congruence (2.2) is equivalent to the congruence
5x ≡−2
(mod 13),
(2.3)

2.2 Linear Congruences
53
which has the unique solution x ≡10
(mod 13). Every solution of (2.2)
satisﬁes
x ≡10
(mod 13)
and so a complete set of solutions that are pairwise incongruent modulo 91
is {10, 23, 36, 49, 62, 75, 88}.
Lemma 2.1 Let p be a prime number. Then x2 ≡1
(mod p) if and only
if x ≡±1
(mod p).
Proof. If x ≡±1
(mod p), then x2 ≡1
(mod p). Conversely, if x2 ≡1
(mod p), then p divides x2 −1 = (x −1)(x + 1), and so p must divide x −1
or x + 1. 2
Theorem 2.4 (Wilson) If p is prime, then
(p −1)! ≡−1
(mod p).
Proof. This is true for p = 2 and p = 3, since 1! ≡−1
(mod 2)
and 2! ≡−1
(mod 3). Let p ≥5. By Theorem 2.2, to each integer a ∈
{1, 2, . . . , p −1} there is a unique integer a−1 ∈{1, 2, . . . , p −1} such that
aa−1 ≡1
(mod p). By Lemma 2.1, a = a−1 if and only if a = 1 or a =
p−1. Therefore, we can partition the p−3 numbers in the set {2, 3, . . . , p−2}
into (p −3)/2 pairs of integers {ai, a−1
i } such that aia−1
i
≡1
(mod p) for
i = 1, . . . , (p −3)/2. Then
(p −1)!
≡
1 · 2 · 3 · · · (p −2)(p −1)
≡
(p −1)
(p−3)/2

i=1
aia−1
i
≡
p −1
≡
−1
(mod p).
This completes the proof. 2
For example,
4! ≡24 ≡−1
(mod 5)
and
6! ≡720 ≡−1
(mod 7).
The converse of Wilson’s theorem is also true (Exercise 7).
Theorem 2.5 Let m and d be positive integers such that d divides m. If a
is an integer relatively prime to d, then there exists an integer a′ such that
a′ ≡a
(mod d) and a′ is relatively prime to m.

54
2. Congruences
Proof. Let m = k
i=1 pri
i and d = k
i=1 psi
i , where ri ≥1 and 0 ≤si ≤ri
for i = 1, . . . , k. Let m′ be the product of the prime powers that divide m
but not d. Then
m′ =
k

i=1
si=0
pri
i
and
(m′, d) = 1.
By Theorem 2.2, there exists an integer x such that
dx ≡1 −a
(mod m′).
Then
a′ = a + dx ≡1
(mod m′)
and so
(a′, m′) = 1.
Also,
a′ ≡a
(mod d).
If (a′, m) ̸= 1, there exists a prime p that divides both a′ and m. However,
p does not divide m′ since (a′, m′) = 1. It follows that p divides d, and
so p divides a′ −dx = a, which is impossible since (a, d) = 1. Therefore,
(a′, m) = 1. 2
If a ≡b
(mod m), then a = b + mx for some integer x. An integer d is
a common divisor of a and m if and only if d is a common divisor of b and
m, and so (a, m) = (b, m). In particular, if a is relatively prime to m, then
every integer in the congruence class of a + mZ is relatively prime to m.
A congruence class modulo m is called relatively prime to m if some (and,
consequently, every) integer in the class is relatively prime to m.
We denote by ϕ(m) the number of congruence classes in Z/mZ that are
relatively prime to m. The function ϕ(m) is called the Euler phi function.
Equivalently, ϕ(m) is the number of integers in the set 0, 1, 2, . . . , m −1
that are relatively prime to m. The Euler phi function is also called the
totient function.
A set of integers {r1, . . . , rϕ(m)} is called a reduced set of residues modulo
m if every integer x such that (x, m) = 1 is congruent modulo m to some
integer ri. For example, the sets {1, 2, 3, 4, 5, 6} and {2, 4, 6, 8, 10, 12} are
reduced sets of residues modulo 7. The sets {1, 3, 5, 7} and {3, 9, 15, 21} are
reduced sets of residues modulo 8.
An integer a is called invertible modulo m or a unit modulo m if there
exists an integer x such that
ax ≡1
(mod m).

2.2 Linear Congruences
55
By Theorem 2.2, a is invertible modulo m if and only if a is relatively prime
to m. Moreover, if a is invertible and ax ≡1
(mod m), then x is unique
modulo m. The congruence class a + mZ is called invertible if there exists
a congruence class x + mZ such that
(a + mZ)(x + mZ) = 1 + mZ.
We denote the inverse of the congruence class a + mZ by (a + mZ)−1 =
a−1+mZ. The invertible congruence classes are the units in the ring Z/mZ.
We denote the group of units in Z/mZ by
(Z/mZ)× .
If R = {r1, . . . , rϕ(m)} is a reduced set of residues modulo m, then
(Z/mZ)× = {r + mZ : r ∈R}
and
(Z/mZ)× = ϕ(m).
For example,
(Z/6Z)× = {1 + 6Z, 5 + 6Z}
and
(Z/7Z)× = {1 + 7Z, 2 + 7Z, 3 + 7Z, 4 + 7Z, 5 + 7Z, 6 + 7Z}.
If a + mZ is a unit in Z/mZ, then (a, m) = 1 and we can apply the
Euclidean algorithm to compute (a + mZ)−1. If we can ﬁnd integers x and
y such that
ax + my = 1,
then
(a + mZ)(x + mZ) = 1 + mZ,
and x + mZ = (a + mZ)−1.
For example, to ﬁnd the inverse of 13 + 17Z, we use the Euclidean algo-
rithm to obtain
17
=
13 · 1 + 4,
13
=
4 · 3 + 1,
4
=
1 · 4.
This gives
1 = 13 −4 · 3 = 13 −(17 −13 · 1)3 = 13 · 4 −17 · 3,
and so
13 · 4 ≡1
(mod 17).
Therefore,
(13 + 17Z)−1 = 4 + 17Z.

56
2. Congruences
Exercises
1. Find all solutions of the congruence 4x ≡9
(mod 11).
2. Find all solutions of the congruence 12x ≡3
(mod 45).
3. Find all solutions of the congruence 28x ≡35
(mod 42).
4. Find all solutions of the system of congruences
5x + 7y ≡3
(mod 17)
2x + 3y ≡−2
(mod 17).
5. Find all solutions of the system of congruences
8x + 5y ≡1
(mod 13)
4x + 3y ≡3
(mod 13).
6. Find the inverse of each nonzero congruence class modulo 13.
7. Prove that if m is composite and m ̸= 4, then (m−1)! ≡0
(mod m).
This is the converse of Wilson’s theorem.
8. Prove that if p ≥5 is an odd prime, then
6(p −4)! ≡1
(mod p).
9. Let m and a be integers such that m ≥1 and (a, m) = 1. Prove
that if {r1, . . . , rϕ(m)} is a reduced set of residues modulo m, then
{ar1, . . . , arϕ(m)} is also a reduced set of residues modulo m.
10. We say that an integer a is nilpotent modulo m if there exists a pos-
itive integer k such that ak ≡0
(mod m). Prove that a is nilpotent
modulo m if and only if a ≡0
(mod rad(m)).
11. For n ≥1, consider the rational number
hn =
n

k=1
1
k = un
vn
,
where un and vn are positive integers. Prove that if p is an odd prime,
then the numerator up−1 of hp−1 is divisible by p.
Hint: Write hp−1 as a fraction with denominator (p −1)!, and apply
Wilson’s theorem.

2.3 The Euler Phi Function
57
12. (A criterion for divisibility by 7.) Let n be a positive integer, and
let dkdk−1 . . . d1d0 be the usual 10-adic representation of n. Deﬁne
f(n) = dkdk−1 . . . d1 −2d0. (For example, if n = 203, then d0 = 3,
d1 = 0, d2 = 2, and f(203) = 20−6 = 14.) Prove that n is divisible by
7 if and only if f(n) is divisible by 7. Use this criterion to determine
if 7875 is divisible by 7.
Hint: Prove that 10v + u ≡0
(mod 7) if and only if v −2u ≡0
(mod 7).
13. Let k ≥3. Find all solutions of the congruence
x2 ≡1
(mod 2k).
2.3
The Euler Phi Function
An arithmetic function is a function deﬁned on the positive integers. The
Euler phi function ϕ(m) is the arithmetic function that counts the number
of integers in the set 0, 1, 2, . . . , m −1 that are relatively prime to m. We
have
ϕ(1)
=
1,
ϕ(6)
=
2,
ϕ(2)
=
2,
ϕ(7)
=
6,
ϕ(3)
=
3,
ϕ(8)
=
4,
ϕ(4)
=
2,
ϕ(9)
=
6,
ϕ(5)
=
4,
ϕ(10)
=
4.
If p is a prime number, then (a, p) = 1 for a = 1, . . . , p−1, and ϕ(p) = p−1.
If pr is a prime power and 0 ≤a ≤pr −1, then (a, pr) > 1 if and only if a
is a multiple of p. The integral multiples of p in the interval [0, pr −1] are
the pr−1 numbers 0, p, 2p, 3p, . . . , (pr−1 −1)p, and so
ϕ(pr) = pr −pr−1 = pr

1 −1
p

.
In this section we shall obtain some important properties of the Euler phi
function.
Theorem 2.6 Let m and n be relatively prime positive integers. For every
integer c there exist unique integers a and b such that
0 ≤a ≤n −1,
0 ≤b ≤m −1,
and
c ≡ma + nb
(mod mn).
(2.4)
Moreover, (c, mn) = 1 if and only if (a, n) = (b, m) = 1 in the representa-
tion (2.4).

58
2. Congruences
Proof. If a1, a2, b1, b2 are integers such that
ma1 + nb1 ≡ma2 + nb2
(mod mn),
then
ma1 ≡ma1 + nb1 ≡ma2 + nb2 ≡ma2
(mod n).
Since (m, n) = 1, it follows that
a1 ≡a2
(mod n),
and so a1 = a2. Similarly, b1 = b2. It follows that the mn integers ma + nb
are pairwise incongruent modulo mn. Since there are exactly mn distinct
congruence classes modulo mn, the congruence (2.4) has a unique solution
for every integer c.
Let c ≡ma + nb
(mod mn). Since (m, n) = 1, we have
(c, m) = (ma + nb, m) = (nb, m) = (b, m)
and
(c, n) = (ma + nb, n) = (ma, n) = (a, n).
It follows that (c, mn) = 1 if and only if (c, m) = (c, n) = 1 if and only if
(b, m) = (a, n) = 1. This completes the proof. 2
For example, we can represent the congruence classes modulo 6 as linear
combinations of 2 and 3 as follows:
0
≡
0 · 2 + 0 · 3
(mod 6),
1
≡
2 · 2 + 1 · 3
(mod 6),
2
≡
1 · 2 + 0 · 3
(mod 6),
3
≡
0 · 2 + 1 · 3
(mod 6),
4
≡
2 · 2 + 0 · 3
(mod 6),
5
≡
1 · 2 + 1 · 3
(mod 6).
A multiplicative function is an arithmetic function f(m) such that f(mn) =
f(m)f(n) for all pairs of relatively prime positive integers m and n. If
f(m) is multiplicative, then it is easy to prove by induction on k that if
m1, . . . , mk are pairwise relatively prime positive integers, then f(m1 · · · mk) =
f(m1) · · · f(mk).
Theorem 2.7 The Euler phi function is multiplicative. Moreover,
ϕ(m) = m

p|m

1 −1
p

.

2.3 The Euler Phi Function
59
Proof. Let (m, n) = 1. There are ϕ(mn) congruence classes in the ring
Z/mnZ that are relatively prime to mn. By Theorem 2.6, every congruence
class modulo mn can be written uniquely in the form ma + nb + mnZ,
where a and b are integers such that 0 ≤a ≤n −1 and 0 ≤b ≤m −1.
Moreover, the congruence class ma + nb + mnZ is prime to mn if and only
if (b, m) = (a, n) = 1. Since there are ϕ(n) integers a ∈[0, n −1] that are
relatively prime to n, and ϕ(m) integers b ∈[0, m −1] relatively prime
to m, it follows that ϕ(mn) = ϕ(m)ϕ(n), and so the Euler phi function is
multiplicative. If m1, . . . , mk are pairwise relatively prime positive integers,
then ϕ(m1 · · · mk) = ϕ(m1) · · · ϕ(mk). In particular, if m = pr1
1 · · · prk
k
is
the standard factorization of m, where p1, . . . , pk are distinct primes and
r1, . . . , rk are positive integers, then
ϕ(m) =
k

i=1
ϕ (pri
i ) =
k

i=1
pri
i

1 −1
pi

= m

p|m

1 −1
p

.
This completes the proof. 2
For example, 7875 = 32537 and
ϕ(7875) = ϕ(32)ϕ(53)ϕ(7) = (9 −3)(125 −25)(7 −1) = 3600.
Theorem 2.8 For every positive integer m,

d|m
ϕ(d) = m.
Proof. We ﬁrst consider the case where m = pt is a power of a prime p.
The divisors of pt are 1, p, p2, . . . , pt, and

d|pt
ϕ(d) =
t

r=0
ϕ(pr) = 1 +
t

r=1

pr −pr−1
= pt.
Next we consider the general case where m has the standard factorization
m = pt1
1 pt2
2 · · · ptk
k ,
where p1, . . . , pk are distinct prime numbers and t1, . . . , tk are positive in-
tegers. Every divisor d of m is of the form
d = pr1
1 pr2
2 · · · prk
k ,
where 0 ≤ri ≤ti for i = 1, . . . , k. By Theorem 2.7, ϕ(d) is multiplicative,
and so
ϕ(d) = ϕ(pr1
1 )ϕ(pr2
2 ) · · · ϕ(prk
k ).

60
2. Congruences
Therefore,

d|m
ϕ(d)
=
t1

r1=0
· · ·
tk

rk=0
ϕ (pr1
1 · · · prk
k )
=
t1

r1=0
· · ·
tk

rk=0
ϕ(pr1
1 )ϕ(pr2
2 ) · · · ϕ(prk
k )
=
k

i=1
ti

ri=0
ϕ (pri
i )
=
k

i=1
pti
i
=
m.
This completes the proof. 2
For example,

d|12
ϕ(d)
=
ϕ(1) + ϕ(2) + ϕ(3) + ϕ(4) + ϕ(6) + ϕ(12)
=
1 + 1 + 2 + 2 + 2 + 4
=
12
and

d|45
ϕ(d)
=
ϕ(1) + ϕ(3) + ϕ(5) + ϕ(9) + ϕ(15) + ϕ(45)
=
1 + 2 + 4 + 6 + 8 + 24
=
45.
Exercises
1. Compute ϕ(6993).
2. Represent the congruence classes modulo 12 in the form 3a + 4b with
0 ≤a ≤3 and 0 ≤b ≤2.
3. Let m = 15. Compute ϕ(d) for every divisor d of m, and check that

d|m ϕ(d) = m. Repeat this exercise for m = 16, 17, and 18.
4. Prove that ϕ(m) is even for all m ≥3.
5. Prove that ϕ(mk) = mk−1ϕ(m) for all positive integers m and k.

2.4 Chinese Remainder Theorem
61
6. Prove that m is prime if and only if ϕ(m) = m −1.
7. Prove that ϕ(m) = ϕ(2m) if and only if m is odd.
8. Prove that if m divides n, then ϕ(m) divides ϕ(n).
9. Find all positive integers n such that ϕ(n) is not divisible by 4.
10. Find all positive integers n such that ϕ(5n) = 5ϕ(n).
11. Let f(n) = ϕ(n)/n. Prove that ϕ(pk) = ϕ(p) for all primes p and all
positive integers k.
12. This problem gives an alternative proof of Theorem 2.8. Let m ≥1,
and let S be the set of fractions k/m with k = 0, 1, . . . , m −1. Write
each fraction in lowest terms: k/m = a/d, where d is a divisor of m
and (a, d) = 1. For example, 0/m = 0/1. Show that for each divisor d
of m there are exactly ϕ(d) fractions k/m ∈S that have denominator
d when reduced to lowest terms. Deduce that 
d|m ϕ(d) = m.
13. Let Nm(x) denote the number of positive integers not exceeding x
that are relatively prime to m. Prove that
lim
x→∞
Nm(x)
x
= ϕ(m)
m
.
This result can be expressed as follows: The probability that a random
integer is prime to m is ϕ(m)/m.
2.4
Chinese Remainder Theorem
Theorem 2.9 Let m and n be positive integers. For any integers a and b
there exists an integer x such that
x ≡a
(mod m)
(2.5)
and
x ≡b
(mod n)
(2.6)
if and only if
a ≡b
(mod (m, n)).
If x is a solution of congruences (2.5) and (2.6), then the integer y is also
a solution if and only if
x ≡y
(mod [m, n]).

62
2. Congruences
Proof. If x is a solution of congruence (2.5), then x = a + mu for some
integer u. If x is also a solution of congruence (2.6), then
x = a + mu ≡b
(mod n),
that is,
a + mu = b + nv
for some integer v. It follows that
a −b = nv −mu ≡0
(mod (m, n)).
Conversely, if a −b ≡0
(mod (m, n)), then by Theorem 1.15 there exist
integers u and v such that
a −b = nv −mu.
Then
x = a + mu = b + nv
is a solution of the two congruences.
An integer y is another solution of the congruences if and only if
y ≡a ≡x
(mod m)
and
y ≡b ≡x
(mod n),
that is, if and only if x−y is a common multiple of m and n, or, equivalently,
x −y is divisible by the least common multiple [m, n]. This completes the
proof. 2
For example, the system of congruences
x
≡
5
(mod 21),
x
≡
19
(mod 56),
has a solution, since
(56, 21) = 7
and
19 ≡5
(mod 7).
The integer x is a solution if there exists an integer u such that
x = 5 + 21u ≡19
(mod 56),
that is,
21u ≡14
(mod 56),

2.4 Chinese Remainder Theorem
63
3u ≡2
(mod 8),
or
u ≡6
(mod 8).
Then
x = 5 + 21u = 5 + 21(6 + 8v) = 131 + 168v
is a solution of the system of congruences for any integer v, and so the set
of all solutions is the congruence class 131 + 168Z.
Theorem 2.10 (Chinese remainder theorem) Let k ≥2. If a1, . . . , ak
are integers and m1, . . . , mk are pairwise relatively prime positive integers,
then there exists an integer x such that
x ≡ai
(mod mi)
for all i = 1, . . . , k.
If x is any solution of this set of congruences, then the integer y is also a
solution if and only if
x ≡y
(mod m1 · · · mk).
Proof. We prove the theorem by induction on k. If k = 2, then [m1, m2] =
m1m2, and this is a special case of Theorem 2.9.
Let k ≥3, and assume that the statement is true for k −1 congruences.
Then there exists an integer z such that z ≡ai
(mod mi) for i = 1, . . . , k−
1. Since m1, . . . , mk are pairwise relatively prime integers, we have
(m1 · · · mk−1, mk) = 1,
and so, by the case k = 2, there exists an integer x such that
x
≡
z
(mod m1 · · · mk−1),
x
≡
ak
(mod mk).
Then
x ≡z ≡ai
(mod mi)
for i = 1, . . . , k −1.
If y is another solution of the system of k congruences, then x −y is
divisible by mi for all i = 1, . . . , k. Since m1, . . . , mk are pairwise relatively
prime, it follows that x −y is divisible by m1 · · · mk. This completes the
proof. 2
For example, the system of congruences
x
≡
2
(mod 3),
x
≡
3
(mod 5),
x
≡
5
(mod 7),
x
≡
7
(mod 11)

64
2. Congruences
has a solution, since the moduli are pairwise relatively prime. The solution
to the ﬁrst two congruences is the congruence class
x ≡8
(mod 15).
The solution to the ﬁrst three congruences is the congruence class
x ≡68
(mod 105).
The solution to the four congruences is the congruence class
x ≡1118
(mod 1155).
There is an important application of the Chinese remainder theorem to
the problem of solving diophantine equations of the form
f(x1, . . . , xk) ≡0
(mod m),
where f(x1, . . . , xk) is a polynomial with integer coeﬃcients in one or sev-
eral variables. This equation is solvable modulo m if there exist integers
a1, . . . , ak such that
f(a1, . . . , ak) ≡0
(mod m).
The Chinese remainder theorem allows us to reduce the question of the
solvability of this congruence modulo m to the special case of prime power
moduli pr. For simplicity, we consider polynomials in only one variable.
Theorem 2.11 Let
m = pr1
1 · · · prk
k
be the standard factorization of the positive integer m. Let f(x) be a poly-
nomial with integral coeﬃcients. The congruence
f(x) ≡0
(mod m)
is solvable if and only if the congruences
f(x) ≡0
(mod pri
i )
are solvable for all i = 1, . . . , k.
Proof. If f(x) ≡0
(mod m) has a solution in integers, then there exists
an integer a such that m divides f(a). Since pri
i
divides m, it follows that
pri
i divides f(a), and so the congruences f(x) ≡0
(mod pri
i ) are solvable
for i = 1, . . . , k.
Conversely, suppose that the congruences f(x) ≡0
(mod pri
i ) are solv-
able for i = 1, . . . , k. Then for each i there exists an integer ai such that
f(ai) ≡0
(mod pri
i ).

2.4 Chinese Remainder Theorem
65
Since the prime powers pr1
1 , . . . , prk
k are pairwise relatively prime, the Chi-
nese remainder theorem tells us that there exists an integer a such that
a ≡ai
(mod pri
i )
for all i. Then
f(a) ≡f(ai) ≡0
(mod pri
i )
for all i. Since f(a) is divisible by each of the prime powers pri
i , it is also
divisible by their product m, and so f(a) ≡0
(mod m). This completes
the proof. 2
For example, consider the congruence
f(x) = x2 −34 ≡0
(mod 495).
Since 495 = 32 · 5 · 11, it suﬃces to solve the congruences
f(x) = x2 −34 ≡x2 + 2 ≡0
(mod 9),
f(x) = x2 −34 ≡x2 + 1 ≡0
(mod 5),
and
f(x) = x2 −34 ≡x2 −1 ≡0
(mod 11).
These congruences have solutions
f(5) ≡0
(mod 9),
f(2) ≡0
(mod 5),
and
f(1) ≡0
(mod 11).
By the Chinese remainder theorem, there exists an integer a such that
a
≡
5
(mod 9),
a
≡
2
(mod 5),
a
≡
1
(mod 11).
Solving these congruences, we obtain
a ≡122
(mod 495).
We can check that
f(122) = 1222 −34 = 14, 850 = 30 · 495,
and so
f(122) ≡0
(mod 495).

66
2. Congruences
Exercises
1. Find all solutions of the system of congruences
x
≡
4
(mod 5),
x
≡
5
(mod 6).
2. Find all solutions of the system of congruences
x
≡
5
(mod 12),
x
≡
8
(mod 9).
3. Find all solutions of the system of congruences
x
≡5
(mod 12),
x
≡8
(mod 10).
4. Find all solutions of the system of congruences
2x
≡1
(mod 5),
3x
≡4
(mod 7).
5. Find all integers that have a remainder of 1 when divided by 3, 5,
and 7.
6. Find all integers that have a remainder of 2 when divided by 4 and
that have a remainder of 3 when divided by 5.
7. Find all solutions of the congruence
f(x) = 5x3 −93 ≡0
(mod 231).
8. (Bhaskara, sixth century) A basket contains n eggs. If the eggs are
removed 2, 3, 4, 5, or 6 at a time, then the number of eggs that remain
in the basket is 1, 2, 3, 4, or 5, respectively. If the eggs are removed
7 at a time, then no eggs remain. What is the smallest number n of
eggs that could have been in the basket at the start of this procedure?
Hint: The ﬁrst condition implies that n ≡1
(mod 2).
9. Let f be a polynomial with integer coeﬃcients. For m ≥1, let Nf(m)
denote the number of pairwise incongruent solutions of f(x) ≡0
(mod m). Prove that the function Nf(m) is multiplicative, that is,
Nf(m1m2) = Nf(m1)Nf(m2) if (m1, m2) = 1.

2.5 Euler’s Theorem and Fermat’s Theorem
67
10. Let m1, . . . , mk be pairwise relatively prime positive integers and m =
m1 · · · mk. Deﬁne the map
f : (Z/mZ)× →(Z/m1Z)× × · · · × (Z/mkZ)×
by
f(a + mZ) = (a + m1Z, . . . , a + mkZ) .
Use the Chinese remainder theorem to show directly that this map
is one-to-one and onto.
2.5
Euler’s Theorem and Fermat’s Theorem
Euler’s theorem and its corollary, Fermat’s theorem, are fundamental re-
sults in number theory, with many applications in mathematics and com-
puter science. In the following sections we shall see how the Euler and
Fermat theorems can be used to determine whether an integer is prime or
composite, and how they are applied in cryptography.
Theorem 2.12 (Euler) Let m be a positive integer, and let a be an inte-
ger relatively prime to m. Then
aϕ(m) ≡1
(mod m).
Proof. Let {r1, . . . , rϕ(m)} be a reduced set of residues modulo m. Since
(a, m) = 1, we have (ari, m) = 1 for i = 1, . . . , ϕ(m). Consequently, for
every i ∈{1, . . . , ϕ(m)} there exists σ(i) ∈{1, . . . , ϕ(m)} such that
ari ≡rσ(i)
(mod m).
Moreover, ari ≡arj
(mod m) if and only if i = j, and so σ is a permuta-
tion of the set {1, . . . , ϕ(m)} and {ar1, . . . , arϕ(m)} is also a reduced set of
residues modulo m. It follows that
aϕ(m)r1r2 · · · rϕ(m)
≡
(ar1)(ar2) · · · (arϕ(m))
(mod m)
≡
rσ(1)rσ(2) · · · rσ(ϕ(m))
(mod m)
≡
r1r2 · · · rϕ(m)
(mod m).
Dividing by r1r2 · · · rϕ(m), we obtain
aϕ(m) ≡1
(mod m).
This completes the proof. 2
The following corollary is sometimes called Fermat’s little theorem.

68
2. Congruences
Theorem 2.13 (Fermat) Let p be a prime number. If the integer a is not
divisible by p, then
ap−1 ≡1
(mod p).
Moreover,
ap ≡a
(mod p)
for every integer a.
Proof. If p is prime and does not divide a, then (a, p) = 1, ϕ(p) = p −1,
and
ap−1 = aϕ(p) ≡1
(mod p)
by Euler’s theorem. Multiplying this congruence by a, we obtain
ap ≡a
(mod p).
If p divides a, then this congruence also holds for a. 2
Let m be a positive integer and let a be an integer that is relatively
prime to m. By Euler’s theorem, aϕ(m) ≡1
(mod m). The order of a
with respect to the modulus m is the smallest positive integer d such that
ad ≡1
(mod m). Then 1 ≤d ≤ϕ(m). We denote the order of a modulo
m by ordm(a). We shall prove that ordm(a) divides ϕ(m) for every integer
a relatively prime to p.
Theorem 2.14 Let m be a positive integer and a an integer relatively
prime to m. If d is the order of a modulo m, then ak ≡aℓ
(mod m)
if and only if k ≡ℓ
(mod d). In particular, an ≡1
(mod m) if and only
if d divides n, and so d divides ϕ(m).
Proof. Since a has order d modulo m, we have ad ≡1
(mod m). If
k ≡ℓ
(mod d), then k = ℓ+ dq, and so
ak = aℓ+dq = aℓ
adq ≡aℓ
(mod m).
Conversely, suppose that ak ≡aℓ
(mod m). By the division algorithm,
there exist integers q and r such that
k −ℓ= dq + r
and
0 ≤r ≤d −1.
Then
ak = aℓ+dq+r = aℓ
adq ar ≡akar
(mod m).
Since (ak, m) = 1, we can divide this congruence by ak and obtain
ar ≡1
(mod m).

2.5 Euler’s Theorem and Fermat’s Theorem
69
Since 0 ≤r ≤d−1, and d is the order of a modulo m, it follows that r = 0,
and so k ≡ℓ
(mod d).
If an ≡1 ≡a0
(mod m), then d divides n. In particular, d divides
ϕ(m), since aϕ(m) ≡1
(mod m) by Euler’s theorem. 2
For example, let m = 15 and a = 7. Since ϕ(15) = 8, Euler’s theorem
tells us that
78 ≡1
(mod 15).
Moreover, the order of 7 with respect to 15 is a divisor of 8. We can compute
the order as follows:
71
≡
7
(mod 15),
72
≡
49 ≡4
(mod 15),
73
≡
28 ≡13
(mod 15),
74
≡
91 ≡1
(mod 15),
and so the order of 7 is 4.
We shall give a second proof of Euler’s theorem and its corollaries. We
begin with some simple observations about groups. We deﬁne the order of
a group as the cardinality of the group.
Theorem 2.15 (Lagrange’s theorem) If G is a ﬁnite group and H is
a subgroup of G, then the order of H divides the order of G.
Proof. Let G be a group, written multiplicatively, and let X be a
nonempty subset of G. For every a ∈G we deﬁne the set
aX = {ax : x ∈X}.
The map f : X →aX deﬁned by f(x) = ax is a bijection, and so |X| =
|aX| for all a ∈G. If H is a subgroup of G, then aH is called a coset
of H. Let aH and bH be cosets of the subgroup H. If aH ∩bH ̸= ∅,
then there exist x, y ∈H such that ax = by, or, since H is a subgroup,
b = axy−1 = az, where z = xy−1 ∈H. Then bh = azh ∈aH for all h ∈H,
and so bH ⊆aH. By symmetry, aH ⊆bH, and so aH = bH. Therefore,
cosets of a subgroup H are either disjoint or equal. Since every element
of G belongs to some coset of H (for example, a ∈aH for all a ∈G), it
follows that the cosets of H partition G. We denote the set of cosets by
G/H. If G is a ﬁnite group, then H and G/H are ﬁnite, and
|G| = |H||G/H|.
In particular, we see that |H| divides |G|. 2
Let G be a group, written multiplicatively, and let a ∈G. Let H = {ak :
k ∈Z}. Then 1 = a0 ∈H ⊆G. Since akaℓ= ak+ℓfor all k, ℓ∈Z, it follows

70
2. Congruences
that H is a subgroup of G. This subgroup is called the cyclic subgroup
generated by a, and written ⟨a⟩. Cyclic subgroups are abelian.
The group G is cyclic if there exists an element a ∈G such that G = ⟨a⟩.
In this case, the element a is called a generator of G. For example, the group
(Z/7Z)× is a cyclic group of order 6 generated by 3 + 7Z. The congruence
class 5 + 7Z is another generator of this group.
If ak ̸= aℓfor all integers k ̸= ℓ, then the cyclic subgroup generated by
a is inﬁnite. If there exist integers k and ℓsuch that k < ℓand ak = aℓ,
then aℓ−k = 1. Let d be the smallest positive integer such that ad = 1.
Then the group elements 1, a, a2, . . . , ad−1 are distinct. Let n ∈Z. By the
division algorithm, there exist integers q and r such that n = dq + r and
0 ≤r ≤d −1. Since
an = adq+r =

adq ar = ar,
it follows that
⟨a⟩= {an : n ∈Z} = {ar : 0 ≤r ≤d −1},
and the cyclic subgroup generated by a has order d. Moreover, ak = aℓif
and only if k ≡ℓ
(mod d).
Let G be a group, and let a ∈G. We deﬁne the order of a as the cardi-
nality of the cyclic subgroup generated by a.
Theorem 2.16 Let G be a ﬁnite group, and a ∈G. Then the order of the
element a divides the order of the group G.
Proof. This follows immediately from Theorem 2.15, since the order of
a is the order of the cyclic subgroup that a generates. 2
Let us apply these remarks to the special case when G = (Z/mZ)× is
the group of units in the ring of congruence classes modulo m. Then G is a
ﬁnite group of order ϕ(m). Let (a, m) = 1 and let d be the order of a+mZ
in G, that is, the order of the cyclic subgroup generated by a + mZ. By
Theorem 2.16, d divides ϕ(m), and so
aϕ(m) + mZ = (a + mZ)ϕ(m) =

(a + mZ)dϕ(m)/d = 1 + mZ.
Equivalently,
aϕ(m) ≡1
(mod m).
This is Euler’s theorem.
Theorem 2.17 Let G be a cyclic group of order m, and let H be a subgroup
of G. If a is a generator of G, then there exists a unique divisor d of m
such that H is the cyclic subgroup generated by ad, and H has order m/d.

2.5 Euler’s Theorem and Fermat’s Theorem
71
Proof. Let S be the set of all integers u such that au ∈H. If u, v ∈S,
then au, av ∈H. Since H is a subgroup, it follows that auav = au+v ∈H
and au(av)−1 = au−v ∈H. Therefore, u±v ∈S, and S is a subgroup of Z.
By Theorem 1.3, there is a unique nonnegative integer d such that S = dZ,
and so H is the cyclic subgroup generated by ad. Since am = 1 ∈H, we
have m ∈S, and so d is a positive divisor of m. It follows that H has order
m/d. 2
Theorem 2.18 Let G be a cyclic group of order m, and let a be a generator
of G. For every integer k, the cyclic subgroup generated by ak has order
m/d, where d = (m, k), and ⟨ak⟩= ⟨ad⟩. In particular, G has exactly ϕ(m)
generators.
Proof. Since d = (k, m), there exist integers x and y such that d =
kx + my. Then
ad = akx+my =

akx (am)y =

akx ,
and so ad ∈⟨ak⟩and ⟨ad⟩⊆⟨ak⟩. Since d divides k, there exists an integer
z such that k = dz. Then
ak =

adz ,
and so ak ∈⟨ad⟩and ⟨ak⟩⊆⟨ad⟩. Therefore, ⟨ak⟩= ⟨ad⟩and ak has
order m/d. In particular, ak generates G if and only if d = 1 if and only
if (m, k) = 1, and so G has exactly ϕ(m) generators. This completes the
proof. 2
We can now give a group theoretic proof of Theorem 2.8. Let G be a
cyclic group of order m. For every divisor d of m, the group G has a unique
cyclic subgroup of order d, and this subgroup has exactly ϕ(d) generators.
Since every element of G generates a cyclic subgroup, it follows that
m =

d|m
ϕ(d).
Voil`a!
Exercises
1. Prove that
3512 ≡1
(mod 1024).
2. Find the remainder when 751 is divided by 144.
3. Find the remainder when 2108 is divided by 31.

72
2. Congruences
4. Compute the order of 2 with respect to the prime moduli 3, 5, 7, 11,
13, 17, and 19.
5. Compute the order of 10 with respect to the modulus 7.
6. Let ri denote the least nonnegative residue of 10i
(mod 7). Compute
ri for i = 1, . . . , 6. Compute the decimal expansion of the fraction 1/7
without using a calculator. Can you ﬁnd where the numbers r1, . . . , r6
appear in the process of dividing 7 into 1?
7. Compute the order of 10 modulo 13. Compute the period of the frac-
tion 1/13.
8. Let p be prime and a an integer not divisible by p. Prove that if
a2n ≡−1
(mod p), then a has order 2n+1 modulo p.
9. Let m be a positive integer not divisible by 2 or 5. Prove that the
decimal expansion of the fraction 1/m is periodic with period equal
to the order of 10 modulo m.
10. Prove that the decimal expansion of 1/m is ﬁnite if and only if the
prime divisors of m are 2 and 5.
11. Prove that 10 has order 22 modulo 23. Deduce that the decimal ex-
pansion of 1/23 has period 22.
12. Prove that if p is a prime number congruent to 1 modulo 4, then there
exists an integer x such that x2 ≡−1
(mod p).
Hint: Observe that
(p −1)!
≡
(p−1)/2

j=1
j(p −j) ≡
(p−1)/2

j=1
(−j2)
≡
(−1)(p−1)/2


(p−1)/2

j=1
j


2
(mod p),
and apply Theorem 2.4.
13. Prove that if n ≥2, then 2n −1 is not divisible by n.
Hint: Let p be the smallest prime that divides n. Consider the con-
gruence 2n ≡1
(mod p).
14. Prove that if p and q are distinct primes, then
pq−1 + qp−1 ≡1
(mod pq).

2.5 Euler’s Theorem and Fermat’s Theorem
73
15. Prove that if m and n are relatively prime positive integers, then
mϕ(n) + nϕ(m) ≡1
(mod mn).
16. Let p be an odd prime. By Euler’s theorem, if (a, p) = 1, then
fp(a) = ap−1 −1
p
∈Z.
Prove that if (ab, p) = 1, then
fp(ab) ≡fp(a) + fp(b)
(mod p).
17. Let f(x) and g(x) be polynomials with integer coeﬃcients. We say
that f(x) is equivalent to g(x) modulo p if
f(a) ≡g(a)
(mod p)
for all integers a.
Prove that the polynomials x9+5x7+3 and x3−2x+24 are equivalent
modulo 7. Prove that every polynomial is equivalent modulo p to a
polynomial of degree at most p −1.
Hint: Use Fermat’s theorem.
18. Let G be the group (Z/7Z)×. Determine all the cyclic subgroups of
G.
19. Prove that the group (Z/11Z)× is cyclic, and ﬁnd a generator.
20. Let G be a group with subgroup H. Deﬁne a relation ∼on G as
follows: a ∼b if b−1a ∈H. Prove that this is an equivalence relation
(that is, reﬂexive, symmetric, and transitive). Prove that a ∼b if and
only if aH = bH, and so the equivalence classes of this relation are
the cosets in G/H.
21. Let G be an abelian group with subgroup H. Let G/H be the set of
cosets of H in G. Deﬁne multiplication of congruence classes by
aH · bH = abH.
Prove that if aH = a′H and bH = b′H, then abH = a′b′H, and so
multiplication of cosets is well-deﬁned. Prove that G/H is an abelian
group with this multiplication. This is called the quotient group of G
by H.
22. Let G be a group and let H and K be subgroups of G. For a ∈G,
we deﬁne the double coset HaK = {hak : h ∈H, k ∈K}. Prove that
if a, b ∈G and HaK ∩HbK ̸= ∅, then HaK = HbK.

74
2. Congruences
2.6
Pseudoprimes and Carmichael Numbers
Suppose we are given an odd integer n ≥3, and we want to determine
whether n is prime or composite. If n is “small,” we can simply divide n
by all odd integers d such that 3 ≤d ≤√n. If some d divides n, then n
is composite; otherwise, n is prime. If n is “big,” however, this method is
time-consuming and impractical. We need to ﬁnd other primality tests.
Fermat’s theorem can be applied to this problem. By Fermat’s theorem,
if n is an odd prime, then 2n−1 ≡1
(mod n). Therefore, if n is odd and
2n−1 ̸≡1
(mod n), then n must be composite. In general, we can choose
any integer b that is relatively prime to n. By Fermat’s theorem, if n is
prime, then bn−1 ≡1
(mod n). It follows that if bn−1 ̸≡1
(mod n),
then n must be composite. Thus, for every base b, Fermat’s theorem gives
a primality test, that is, a necessary condition for an integer n to be prime.
Suppose we want to know whether n = 851 is prime or composite. We
shall compute 2850
(mod 851). An eﬃcient method is to use the 2-adic
representation of 850:
850 = 2 + 24 + 26 + 28 + 29.
Since 22n =

22n−12
, we have
22 ≡4
(mod 851),
222 ≡16
(mod 851),
223 ≡256
(mod 851),
224 ≡9
(mod 851),
225 ≡81
(mod 851),
226 ≡604
(mod 851),
227 ≡588
(mod 851),
228 ≡238
(mod 851),
229 ≡478
(mod 851).
Then
2850
≡
22224226228229
(mod 851)
≡
4 · 9 · 604 · 238 · 478
(mod 851)
≡
169 ̸≡1
(mod 581),
and so 851 is composite. To factor 851, we observe that 851 + 49 = 900,
and so
851 = 900 −49 = 302 −72 = (30 −7)(30 + 7) = 23 · 37.

2.6 Pseudoprimes and Carmichael Numbers
75
(To understand this factoring method, see Exercise 2.)
This test can prove that an integer is composite, but it cannot prove
that an integer is prime. For example, consider the composite number n =
341 = 11 · 31, Choosing base b = 2, we have
210 ≡1
(mod 11),
and so
2340 ≡

21034 ≡1
(mod 11).
Similarly,
25 ≡1
(mod 31),
and so
2340 ≡

2568 ≡1
(mod 31).
Since 2340 −1 is divisible by both 11 and 31, it is divisible by their product,
that is,
2340 ≡1
(mod 341).
A composite number n is called a pseudoprime to the base b if (b, n) = 1
and bn−1 ≡1
(mod n). Thus, 341 is a pseudoprime to base 2.
We can show that 341 is composite by choosing the base b = 7. Since
73 = 343 ≡2
(mod 341)
and
210 = 1024 ≡1
(mod 341),
it follows that
7340
=
7

73113
≡
7 · 2113
(mod 341)
≡
7 · 23 
21011
(mod 341)
≡
56
(mod 341)
̸≡
1
(mod 341).
Can every composite number be proved composite by some primality
test based on Fermat’s theorem? It is a surprising fact that the answer is
“no.” There exist composite numbers n that cannot be proved composite
by any congruence of the form bn−1
(mod n) with (b, n) = 1. For example,
561 = 3 · 11 · 17 is composite. Let b be an integer relatively prime to 561.
Then
b2 ≡1
(mod 3),
and so
b560 =

b2280 ≡1
(mod 3).

76
2. Congruences
Similarly,
b10 ≡1
(mod 11),
and so
b560 =

b1056 ≡1
(mod 11).
Finally,
b16 ≡1
(mod 17),
and so
b560 =

b1635 ≡1
(mod 17).
Since b560 −1 is divisible by 3, 11, and 17, it is also divisible by their
product, hence
b560 ≡1
(mod 561).
This proves that 561 is a pseudoprime to base b for every b such that
(b, n) = 1.
A Carmichael number is a positive integer n such that n is composite
but bn−1 ≡1
(mod n) for every integer b relatively prime to n. Thus, 561
is a Carmichael number.
Exercises
1. Prove that 589 is composite by computing the least nonnegative
residue of 2588
(mod 589).
2. Let n be an odd integer, n ≥3. Prove that there exists a nonnegative
integer u such that n+u2 = (u+1)2. Prove that n is composite if and
only if there exist nonnegative integers u and v such that v > u + 1
and n + u2 = v2. Use this method to factor 589.
3. Prove that 645 is a pseudoprime to base 2.
4. Prove that 1729 is a pseudoprime to bases 2, 3, and 5.
5. Prove that 1105 is a Carmichael number.
6. Let n be a product of distinct primes. Prove that if p−1 divides n−1
for every prime p that divides n, then n is a Carmichael number.
7. Prove that 6601 is a Carmichael number.
2.7
Public Key Cryptography
Cryptography is the art and science of sending secret messages. The message
that we want to send is called the plaintext. The sender uses a key to
encipher, or encrypt, it into ciphertext, and the ciphertext is transmitted

2.7 Public Key Cryptography
77
to the receiver, who uses another key to decipher, or decrypt, it back into
plaintext. By writing letters and punctuation marks as numbers, we can
assume that the plaintext is a positive integer P, and that it is encrypted
as a diﬀerent positive integer C. The problem is to invent keys that make
it impossible or computationally infeasible for an enemy to decipher an
intercepted message. Cryptanalysis is the art and science of deciphering an
intercepted message without knowledge of the decrypting key.
Classically, cryptography uses secret keys that are known only to sender
and receiver. If the enemy discovers the encrypting key and intercepts the
ciphertext, then he might be able to compute the decrypting key and re-
cover the plaintext.
Here is an example of a secret key cryptosystem. Let p be an odd prime,
and let e be an integer such that (e, p −1) = 1. Suppose that the plaintext
P is an integer such that 0 < P < p. Let the ciphertext C be the least
nonnegative residue of P e modulo p, that is, we construct C by the rule
C ≡P e
(mod p)
and
0 < C < p.
The encrypting key for this cipher consists of the prime number p and the
integer e. To decrypt this cipher, we use elementary number theory. Since
(e, p −1) = 1, there exists an integer d such that ed ≡1
(mod p −1). It
is easy to compute d. We can use the Euclidean algorithm, for example.
The decrypting key consists of the prime p and the integer d. Since ed =
1 + (p −1)k for some integer k, and since P p−1 ≡1
(mod p) by Fermat’s
theorem, it follows that
Cd ≡P ed ≡P 1+(p−1)k ≡P(P p−1)k ≡P
(mod p).
Thus, we can decrypt the ciphertext C by computing the least nonnegative
residue of Cd modulo p. An enemy who learns the encrypting key will break
the cipher.
For example, if p = 17 and e = 3, then the plaintext P = 10 is encrypted
as
P 3 = 103 ≡14
(mod 17),
and so the ciphertext is C = 14. Since 3 · 11 ≡1
(mod 16), it follows that
d = 11 is a decrypting key. We observe that
C11 = 1411 ≡10 = P
(mod 17).
There is a more sophisticated idea in cryptography that produces secure
ciphers even if the encrypting key is known. Indeed, the encrypting key can
be made public, so that anyone can encrypt and send a message, but the
decrypting key cannot be computed from knowledge of the encrypting key.

78
2. Congruences
This is called a public key cryptosystem. Here is an example. We choose
two diﬀerent large primes p and q, and let
m = pq.
Since we know p and q, it is easy to calculate ϕ(m) = (p−1)(q−1). Pick an
integer e that is relatively prime to ϕ(m). We publish the numbers m and e.
The plaintext must be a positive integer P that is less than m and relatively
prime to m If m is a large number, then almost all positive integers less
than m are relatively prime to m (Exercise 4), so we can assume that
(P, m) = 1. The ciphertext will be the unique integer C such that
C ≡P e
(mod m)
and
0 < C < m.
It is important to note that we disclose neither ϕ(m) nor the prime factors
p and q of m. These are kept secret. However, since we know ϕ(m), it is
easy, by using the Euclidean algorithm, for example, to compute an integer
d such that
ed ≡1
(mod ϕ(m)),
that is,
ed = 1 + ϕ(m)k
for some integer k. To decrypt the ciphertext C, we simply compute the
least nonnegative residue of
Cd
(mod m).
Since (P, m) = 1, Euler’s theorem tells us that
Cd ≡P ed ≡P 1+ϕ(m)k ≡P
(mod m).
The decryption key requires the integers d and m. It is not enough to
know e and m. To compute d, one must know both e and ϕ(m). Since
ϕ(m) = (p −1)(q −1), this requires a knowledge of the primes p and q
such that m = pq, that is, we must be able to factor m. If the primes p
and q are large (such as several thousand digits each), then it is impossible
with state-of-the-art computer hardware and our current knowledge about
factoring large numbers to ﬁnd the prime factors of m in a reasonable time,
for example, a million years. We know the prime factors p and q, and so we
can compute ϕ(m), but an opponent who wants to intercept and decrypt
the message will fail, since he does not know the primes and cannot factor
m. Indeed, the following result shows that knowing ϕ(m) is equivalent to
knowing the prime factors of m.

2.7 Public Key Cryptography
79
Theorem 2.19 Let m be an integer that is the product of two prime num-
bers. The prime divisors of m are the roots of the quadratic equation
x2 −(m + 1 −ϕ(m))x + m = 0,
and so ϕ(m) determines the prime factors of m.
Proof. If m = pq, then
ϕ(m) = (p −1)(q −1) = pq −p −q + 1 = m −p −m
p + 1,
and so
p −(m + 1 −ϕ(m)) + m
p = 0.
Equivalently, p and q are the solutions of the quadratic equation
x2 −(m + 1 −ϕ(m))x + m = 0.
This completes the proof. 2
For example, if m = 221 and ϕ(m) = 192, then the quadratic equation
x2 −30x + 221 = 0
has solutions x = 13 and x = 17, and 221 = 13 · 17.
This method, known as the RSA cryptosystem, is called a public key cryp-
tosystem, since the encryption key is made available to everyone, and the
encrypted message can be transmitted through public channels. Only the
possessor of the prime factors of m can decrypt the message. RSA is simple,
but useful, and is the basis of many commercially valuable cryptosystems.
Exercises
1. Consider the secret key cryptosystem constructed from the prime
p = 947 and the encoding key e = 167. Encipher the plaintext P = 2.
Find a decrypting key and decipher the ciphertext C = 3.
2. Consider the primes p = 53 and q = 61. Let m = pq. Prove that
e = 7 is relatively prime to ϕ(m). Find a positive integer d such that
ed ≡1
(mod ϕ(m)).
3. The integer 6059 is the product of two distinct primes, and ϕ(6059) =
5904. Use Theorem 2.19 to compute the prime divisors of 6059.
4. The probability that an integer chosen at random between 1 and n is
relatively prime to n is ϕ(n)/n. Let n = pq, where p and q are distinct
primes greater than x. Prove that the probability that a randomly
chosen positive integer up to x is relatively prime to n is greater than
(1 −1/x)2. If x = 200, this probability is greater than 0.99.

80
2. Congruences
2.8
Notes
Si numerus a numerorum b, c diﬀerentiam metitur, b et c secun-
dum a congrui dicuntur, sin minus, incongrui: ipsum a modu-
lum appellamus. Uterque numerorum b, c priori in casu alterius
residuum, in posteriori vero nonresiduum vocatur.
C. F. Gauss [37]
This is the ﬁrst paragraph in the ﬁrst section of Gauss’s Disquisitiones
Arithmeticae, a seminal book on number theory that was published in 1801.
The translation, with slight changes in notation, is the ﬁrst paragraph of
this chapter. Gauss introduced the idea of congruence, and proved many
of the results on congruences that we obtain in this book. This is classical
mathematics that every student of mathematics should learn.
Carmichael conjectured in 1912 that the number of Carmichael numbers
is inﬁnite. Alford, Granville, and Pomerance [1] conﬁrmed this in 1994.
They proved that if C(x) is the number of Carmichael numbers less than x,
then C(x) > x2/7 for all suﬃciently large x. Erd˝os has made the stronger
conjecture that for every ε > 0 there exists a number x0(ε) such that
C(x) > x1−ε for all x ≥x0(ε). For an expository article on primality
testing and Carmichael numbers, see Granville [40].
There is a vast literature on applications of number theory to cryptogra-
phy, but it is hard to assign credit for discoveries in this ﬁeld, because much
of the research is carried out in secret at government agencies responsible
for communications security, and not published in unclassiﬁed scientiﬁc
journals. For example, the idea of public key cryptography ﬁrst appeared
in the public domain in work of Diﬃe, Hellman, and Merkle [26, 65] in 1976.
The RSA cryptosystem was invented and published by Rivest, Shamir, and
Adleman[123] in 1978. Singh [135] has reported, however, that both the
concept of public key cryptography and the RSA cryptosystem were dis-
covered earlier by three British government cryptographers, James Ellis,
Cliﬀord Cocks, and Malcolm Williamson, working at Government Com-
munications Headquarters (GCHQ) in Cheltenham, England. It is possible
that government cryptographers in other countries also independently dis-
covered these methods.
Boneh [12] is a recent survey of the status of the RSA cryptosystem.
In 1997, Shor [133] described an algorithm based on ideas from quantum
mechanics that would factor large integers in “polynomial time,” that is,
much faster than is now possible with classical algorithms and comput-
ers. If it becomes possible to build quantum computers, then cryptography
based on the diﬃculty of factoring large integers would become insecure
and unreliable. For a review of classical computing, quantum computing,
and Shor’s factoring algorithm, see Manin [95]. Information on quantum

2.8 Notes
81
computing is available on the internet from the University of Oxford’s Cen-
ter for Quantum Computing (www.qubit.org).
A good text on number theoretic cryptography is Koblitz, A Course in
Number Theory and Cryptography [83].

3
Primitive Roots and Quadratic
Reciprocity
3.1
Polynomials and Primitive Roots
Let m be a positive integer greater than 1, and a an integer relatively
prime to m. The order of a modulo m, denoted by ordm(a), is the smallest
positive integer d such that ad ≡1
(mod m). By Theorem 2.14, ordm(a)
is a divisor of the Euler phi function ϕ(m). The order of a modulo m is
also called the exponent of a modulo m.
We investigate the least nonnegative residues of the powers of a modulo
m. For example, if m = 7 and a = 2, then
20
≡
1
(mod 7),
21
≡
2
(mod 7),
22
≡
4
(mod 7),
23
≡
1
(mod 7),
and 2 has order 3 modulo 7. If m = 7 and a = 3, then
30
≡
1
(mod 7),
31
≡
3
(mod 7),
32
≡
2
(mod 7),
33
≡
6
(mod 7),
34
≡
4
(mod 7),
35
≡
5
(mod 7),
36
≡
1
(mod 7),

84
3. Primitive Roots and Quadratic Reciprocity
and 3 has order 6 modulo 7. The powers of 3 form a reduced residue system
modulo 7.
The integer a is called a primitive root modulo m if a has order ϕ(m). In
this case, the ϕ(m) integers 1, a, a2, . . . , aϕ(m)−1 are relatively prime to m
and are pairwise incongruent modulo m. Thus, they form a reduced residue
system modulo m. For example, 3 is a primitive root modulo 7. Similarly,
3 is a primitive root modulo 10, since ϕ(10) = 4 and
30
≡1
(mod 10),
31
≡3
(mod 10),
32
≡9
(mod 10),
33
≡7
(mod 10),
34
≡1
(mod 10).
Some moduli do not have primitive roots. There is no primitive root
modulo 8, for example, since ϕ(8) = 4, but
12 ≡32 ≡52 ≡72 ≡1
(mod 8),
(3.1)
and no integer has order 4 modulo 8.
In this section we prove that every prime p has a primitive root. In
Section 3.2 we determine all composite moduli m for which there exist
primitive roots.
We begin with some remarks about polynomials. Let R be a commutative
ring with identity. A polynomial with coeﬃcients in R is an expression of
the form
f(x) = amxm + am−1xm−1 + · · · + a1x + a0,
where a0, a1, . . . , am ∈R. The element ai is called the coeﬃcient of the
term xi. The degree
of the polynomial f(x), denoted by deg(f), is the
greatest integer n such that an ̸= 0, and an is called the leading coeﬃcient.
If deg(f) = n, we deﬁne ai = 0 for i > n. Nonzero constant polynomials
f(x) = a0 ̸= 0 have degree 0. The zero polynomial f(x) = 0 has no degree.
A monic polynomial is a polynomial whose leading coeﬃcient is 1.
We deﬁne addition and multiplication of polynomials in the usual way:
If f(x) = n
i=0 aixi and g(x) = m
j=0 bjxj, then
(f + g)(x) =
max(m,n)

k=0
(ak + bk)xk
and
fg(x) =
mn

k=0
ckxk,

3.1 Polynomials and Primitive Roots
85
where
ck =

i+j=k
0≤i≤n
0≤j≤m
aibj =
k

i=0
aibk−i.
With this addition and multiplication, the set R[x] of all polynomials with
coeﬃcients in R is a commutative ring. Moreover,
deg(f + g) ≤max(deg(f), deg(g)).
If f, g ∈F[x] for some ﬁeld F, then
deg(fg) = deg(f) + deg(g),
and the leading coeﬃcient of fg is ambn.
For every α ∈R, the evaluation map Θα : R[x] →R deﬁned by
Θα(f) = f(α) = anαn + an−1αn−1 + · · · + a1α + a0
is a ring homomorphism, that is, (f + g)(α) = f(α) + g(α) and (fg)(α) =
f(α)g(α). The element α is called a zero or a root of the polynomial f(x)
if Θα(f) = f(α) = 0.
We say that the polynomial d(x) divides the polynomial f(x) if there
exists a polynomial q(x) such that f(x) = d(x)q(x).
Theorem 3.1 (Division algorithm for polynomials) Let F be a ﬁeld.
If f(x) and d(x) are polynomials in F[x] and if d(x) ̸= 0, then there exist
unique polynomials q(x) and r(x) such that f(x) = d(x)q(x) + r(x) and
either r(x) = 0 or the degree of r(x) is strictly smaller than the degree of
d(x).
Proof. Let d(x) = bmxm + · · · + b1x + b0, where bm ̸= 0 and deg(d) =
m. If d(x) does not divide f(x), then f −dq ̸= 0 and deg(f −dq) is a
nonnegative integer for every polynomial q(x) ∈F[x]. Choose q(x) such
that ℓ= deg(f −dq) is minimal, and let
r(x) = f(x) −d(x)q(x) = cℓxℓ+ · · · + c1x + c0 ∈F[x],
where cℓ̸= 0. We shall prove that ℓ< m.
Since F is a ﬁeld, b−1
m ∈F. If ℓ≥m, then
d(x)b−1
m cℓxℓ−m
is a polynomial of degree ℓwith leading coeﬃcient cℓ. Then
Q(x) = q(x) + b−1
m cℓxℓ−m ∈F[x],

86
3. Primitive Roots and Quadratic Reciprocity
and
R(x)
=
f(x) −d(x)Q(x)
=
f(x) −d(x)

q(x) + b−1
m cℓxℓ−m
=
r(x) −d(x)b−1
m cℓxℓ−m
is a polynomial of degree at most ℓ−1. This contradicts the minimality of
ℓ, and so ℓ< m.
Next we prove that the polynomials q(x) and r(x) are unique. Suppose
that
f(x) = d(x)q1(x) + r1(x) = d(x)q2(x) + r2(x),
where q1(x), q2(x), r1(x), r2(x) are polynomials in F[x] such that ri(x) = 0
or deg(ri) < deg(d) for i = 1, 2. Then
d(x)(q1(x) −q2(x)) = r2(x) −r1(x).
If q1(x) ̸= q2(x), then
deg(d) ≤deg(d(q1 −q2)) = deg(r2 −r1) < deg(d),
which is absurd. Therefore, q1(x) = q2(x), and so r1(x) = r2(x). This
completes the proof. 2
Theorem 3.2 Let f(x) ∈F[x], f(x) ̸= 0, and let N0(f) denote the number
of distinct zeros of f(x) in F. Then N0(f) does not exceed the degree of
f(x), that is,
N0(f) ≤deg(f).
Proof. We use the division algorithm for polynomials. Let α ∈F. Di-
viding f(x) by x −α, we obtain
f(x) = (x −α)q(x) + r(x),
where r(x) = 0 or deg(r) < deg(x−α) = 1, that is, r(x) = r0 is a constant.
Letting x = α, we see that r0 = f(α), and so
f(x) = (x −α)q(x) + f(α)
for every α ∈F. In particular, if α is a zero of f(x), then x −α divides
f(x).
We prove the theorem by induction on n = deg(f). If n = 0, then f(x)
is a nonzero constant and N0(f) = 0. If n = 1, then f(x) = a0 + a1x
with a1 ̸= 0, and N0(f) = 1 since f(x) has the unique zero α = −a−1
1 a0.
Suppose that n ≥2 and the theorem is true for all polynomials of degree

3.1 Polynomials and Primitive Roots
87
at most n −1. If N0(f) = 0, we are done. If N0(f) ≥1, let α ∈F be a zero
of f(x). Then
f(x) = (x −α)q(x),
and
deg(q) = n −1.
If β is a zero of f(x) and β ̸= α, then
0 = f(β) = (β −α)q(β),
and so β is a zero of q(x). Since deg(q) = n −1, the induction hypothesis
implies that
N0(f) ≤1 + N0(q) ≤1 + deg(q) = n.
This completes the proof. 2
Theorem 3.3 Let G be a ﬁnite subgroup of the multiplicative group of a
ﬁeld. Then G is cyclic.
Proof. Let |G| = m. By Theorem 2.15, if a ∈G, then the order of a
is a divisor of m. For every divisor d of m, let ψ(d) denote the number
of elements of G of order d. If ψ(d) ̸= 0, then there exists an element a
of order d, and every element of the cyclic subgroup ⟨a⟩generated by a
satisﬁes ad = 1. By Theorem 3.2, the polynomial f(x) = xd −1 ∈F[x] has
at most d zeros, and so every zero of f(x) belongs to the cyclic subgroup
⟨a⟩. In particular, every element of G of order d must belong to ⟨a⟩. By
Theorem 2.18, a cyclic group of order d has exactly ϕ(d) generators, where
ϕ(d) is the Euler phi function. Therefore, ψ(d) = 0 or ψ(d) = ϕ(d) for
every divisor d of m. Since every element of G has order d for some divisor
d of m, it follows that

d|m
ψ(d) = m.
By Theorem 2.8,

d|m
ϕ(d) = m,
and so ψ(d) = ϕ(d) for every divisor d of m. In particular, ψ(m) = ϕ(m) ≥
1, and so G is a cyclic group of order m. 2
Theorem 3.4 For every prime p, the multiplicative group of the ﬁnite ﬁeld
Z/pZ is cyclic. This group has ϕ(p −1) generators. Equivalently, for every
prime p, there exist ϕ(p −1) pairwise incongruent primitive roots modulo
p.

88
3. Primitive Roots and Quadratic Reciprocity
Proof. This follows immediately from Theorem 3.3, since |(Z/pZ)×| =
p −1. 2
The following table lists the primitive roots for the ﬁrst six primes.
p
ϕ(p −1)
primitive roots
2
1
1
3
1
2
5
2
2, 3
7
2
3, 5
11
4
2, 6, 7, 8
13
4
2, 6, 7, 11
Let p be a prime, and let g be a primitive root modulo p. If a is an integer
not divisible by p, then there exists a unique integer k such that
a ≡gk
(mod p)
and
k ∈{0, 1, . . . , p −2}.
This integer k is called the index of a with respect to the primitive root g,
and is denoted by
k = indg(a).
If k1 and k2 are any integers such that k1 ≤k2 and
a ≡gk1 ≡gk2
(mod p),
then
gk2−k1 ≡1
(mod p),
and so
k1 ≡k2
(mod p −1).
If a ≡gk
(mod p) and b ≡gℓ
(mod p), then ab ≡gkgℓ= gk+ℓ
(mod p),
and so
indg(ab) ≡k + ℓ≡indg(a) + indg(b)
(mod p −1).
The index map indg is also called the discrete logarithm to the base g
modulo p.
For example, 2 is a primitive root modulo 13. Here is a table of ind2(a)
for a = 1, . . . , 12:
a
ind2(a)
a
ind2(a)
1
0
7
11
2
1
8
3
3
4
9
8
4
2
10
10
5
9
11
7
6
5
12
6

3.1 Polynomials and Primitive Roots
89
By Theorem 2.18, if g is a primitive root modulo p, then gk is a primitive
root if and only if (k, p−1) = 1. For example, for p = 13 there are ϕ(12) = 4
integers k such that 0 ≤k ≤11 and (k, 12) = 1, namely, k = 1, 5, 7, 11, and
so the four pairwise incongruent primitive roots modulo 13 are
21
≡
2
(mod 13),
25
≡
6
(mod 13),
27
≡
11
(mod 13),
211
≡
7
(mod 13).
Exercises
1. Find a primitive root modulo 23.
2. Find a primitive root modulo 41.
3. Prove that 2 is a primitive root modulo 101.
4. Compute ind2(27) modulo 101.
5. Compute ind2(19) modulo 101.
6. What is the order of 3 modulo 101? Is 3 a primitive root modulo 101?
7. Prove that 2 is a primitive root modulo 53.
8. Find all solutions of the congruence 2x ≡22
(mod 53).
9. Compute ind2(a) for all a not divisible by 53.
10. Let p be an odd prime, and let g be a primitive root modulo p. Prove
that
(p −1)! ≡g(p−2)(p−1)/2 ≡−1
(mod p).
Hint: Observe that
(p −1)! ≡1 · g · g2 · · · gp−2
(mod p)
and
(p −2)(p −1)
2
= p(p −1)
2
−(p −1).
This gives another proof of Wilson’s theorem (Theorem 2.4).
11. Prove that if m has one primitive root, then there are exactly ϕ(ϕ(m))
pairwise incongruent primitive roots modulo m.
12. Let g and r be primitive roots modulo p. Prove that
indr(a) ≡indg(a)indr(g)
(mod p −1)
for every integer a relatively prime to p.

90
3. Primitive Roots and Quadratic Reciprocity
13. Let g be a primitive root modulo the odd prime p. Prove that g(p−1)/2 ≡
−1
(mod p).
14. Let g be a primitive root modulo the odd prime p. Prove that −g is
a primitive root modulo p if and only if p ≡1
(mod 4).
15. Let f(x) = n
i=0 aixi and g(x) = n
i=0 bixi be polynomials with
integer coeﬃcients. Then f(x) and g(x) are called congruent modulo
m, written f(x) ≡g(x)
(mod m), if ai ≡bi
(mod m) for i =
0, 1, . . . , n. Let p be an odd prime, and let
f(x) = xp−1 −1
and
g(x) = (x −1)(x −2) · · · (x −(p −1)).
Prove the following statements:
(a) The polynomial f(x) −g(x) has degree p −2.
(b)
f(c) ≡g(c) ≡0
(mod p)
for c = 1, 2, . . . , p −1.
(c)
f(x) ≡g(x)
(mod p).
Hint: Apply Theorem 3.2.
16. Prove that Exercise (15c) implies Wilson’s theorem,
(p −1)! ≡−1
(mod p).
17. Prove that for every prime p ≥5,

1≤i<j≤p−1
ij ≡0
(mod p)
and

1≤i<j<k≤p−1
ijk ≡0
(mod p).
Hint: Exercise (15c).
18. Let R be a commutative ring with identity. An ideal of R is an additive
subgroup I ⊆R such that, if a ∈I and r ∈R, then ar ∈I. Prove
that if I ̸= {0} is an ideal of the polynomial ring F[x], where F is a
ﬁeld, then there is a unique monic polynomial d(x) ∈I such that I
consists of all multiples of d(x), that is,
I = {q(x)d(x) : q(x) ∈F[x]}.
Hint: If I ̸= {0}, choose d(x) ∈I of minimal degree. The proof is
similar to the proof of Theorem 1.3.

3.2 Primitive Roots to Composite Moduli
91
19. Prove that the intersection of a family of ideals is an ideal. This means
that if {Ij}j∈J is a family of ideals in the ring R, then I = 
j∈J Ij
is an ideal in R.
20. Let F[x] be the ring of polynomials with coeﬃcients in the ﬁeld F,
and let f(x), g(x) ∈F[x]. Prove that there exists a unique monic
polynomial d(x) ∈F[x] such that d(x) divides both f(x) and g(x),
and every common divisor of f(x) and g(x) divides d(x). The poly-
nomial d(x) is called the greatest common divisor of f(x) and g(x).
Hint: Consider the ideal I generated by f(x) and g(x), that is, the
set
I = {u(x)f(x) + v(x)g(x) : u(x), v(x) ∈F[x]},
and apply Exercise 18.
21. Let f : R →S be a ring homomorphism. Prove that the kernel of f,
that is, the set
f −1(0) = {r ∈R : f(r) = 0}
is an ideal of R.
22. Let α ∈F, and let I(α) be the set of all polynomials f(x) ∈F[x]
such that f(α) = 0. Prove that I(α) is the kernel of the evaluation
map Θα and that I(α) is an ideal of F[x].
23. Let A be a nonempty subset of F, and let I(A) be the set of all
polynomials f(x) ∈F[x] such that f(α) = 0 for all α ∈A. Prove that
I(A) is an ideal of F[x], and
I(A) =

α∈A
I(α).
3.2
Primitive Roots to Composite Moduli
In the previous section we proved that primitive roots exist for every prime
number. We also observed that primitive roots do not exist for every mod-
ulus. For example, congruence (3.1) shows that there is no primitive root
modulo 8. The goal of this section is to prove that an integer m ≥2 has a
primitive root if and only if m = 2, 4, pk, or 2pk, where p is an odd prime
and k is a positive integer.
Theorem 3.5 Let m be a positive integer that is not a power of 2. If m
has a primitive root, then m = pk or 2pk, where p is an odd prime and k
is a positive integer.

92
3. Primitive Roots and Quadratic Reciprocity
Proof. Let a and m be integers such that (a, m) = 1 and m ≥3. Suppose
that
m = m1m2,
where (m1, m2) = 1 and m1 ≥3, m2 ≥3.
(3.2)
Then (a, m1) = (a, m2) = 1. The Euler phi function ϕ(m) is even for m ≥3
(Exercise 4 in Section 2.2). Let
n = ϕ(m)
2
= ϕ(m1)ϕ(m2)
2
.
By Euler’s theorem,
aϕ(m1) ≡1
(mod m1),
and so
an =

aϕ(m1)ϕ(m2)/2
≡1
(mod m1).
Similarly,
an =

aϕ(m2)ϕ(m1)/2
≡1
(mod m2).
Since (m1, m2) = 1 and m = m1m2, we have
an ≡1
(mod m),
and so the order of a modulo m is strictly smaller than ϕ(m). Consequently,
if we can factor m in the form (3.2), then there does not exist a primitive
root modulo m. In particular, if m is divisible by two distinct odd primes,
then m does not have a primitive root. Similarly, if m = 2ℓpk, where ℓ≥2,
then m does not have a primitive root. Therefore, the only moduli m ̸= 2ℓ
for which primitive roots can exist are of the form m = pk or m = 2pk for
some odd prime p. 2
To prove the converse of Theorem 3.5, we use the following result about
the exponential increase in the order of an integer modulo prime powers.
Theorem 3.6 Let p be an odd prime, and let a ̸= ±1 be an integer not
divisible by p. Let d be the order of a modulo p. Let k0 be the largest integer
such that ad ≡1
(mod pk0). Then the order of a modulo pk is d for
k = 1, . . . , k0 and dpk−k0 for k ≥k0.
Proof. There exists an integer u0 such that
ad = 1 + pk0u0
and
(u0, p) = 1.
(3.3)
Let 1 ≤k ≤k0, and let e be the order of a modulo pk. If ae ≡1
(mod pk),
then ae ≡1
(mod p), and so d divides e. By (3.3), we have ad ≡1
(mod pk), and so e divides d. It follows that e = d.

3.2 Primitive Roots to Composite Moduli
93
Let j ≥0. We shall show that there exists an integer uj such that
adpj = 1 + pj+k0uj
and
(uj, p) = 1.
(3.4)
The proof is by induction on j. The assertion is true for j = 0 by (3.3).
Suppose we have (3.4) for some integer j ≥0. By the binomial theorem,
there exists an integer vj such that
adpj+1
=

1 + pj+k0uj
p
=
1 + pj+1+k0uj +
p

i=2
p
i

pi(j+k0)ui
j
=
1 + pj+1+k0uj + pj+2+k0vj
=
1 + pj+1+k0(uj + pvj)
=
1 + pj+1+k0uj+1,
and the integer uj+1 = uj + pvj is relatively prime to p. Thus, (3.4) holds
for all j ≥0.
Let k ≥k0 + 1 and j = k −k0 ≥1. Suppose that the order of a modulo
pk−1 is dpj−1. Let ek denote the order of a modulo pk. The congruence
aek ≡1
(mod pk)
implies that
aek ≡1
(mod pk−1),
and so dpj−1 divides ek. Since
adpj−1 = 1 + pk−1uj−1 ̸≡1
(mod pk),
it follows that dpj−1 is a proper divisor of ek. On the other hand,
adpj = 1 + pkuj ≡1
(mod pk),
and so ek divides dpj. It follows that the order of a modulo pk is exactly
ek = dpj = dpk−k0. This completes the proof. 2
Theorem 3.7 Let p be an odd prime. If g is a primitive root modulo p,
then either g or g + p is a primitive root modulo pk for all k ≥2. If g is a
primitive root modulo pk and g1 ∈{g, g + pk} is odd, then g1 is a primitive
root modulo 2pk.
Proof. Let g be a primitive root modulo p. The order of g modulo p
is p −1. Let k0 be the largest integer such that pk0 divides gp−1 −1. By

94
3. Primitive Roots and Quadratic Reciprocity
Theorem 3.6, if k0 = 1, then the order of g modulo pk is (p−1)pk−1 = ϕ(pk),
and g is a primitive root modulo pk for all k ≥1.
If k0 ≥2, then
gp−1 = 1 + p2v
for some integer v. By the binomial theorem,
(g + p)p−1
=
p−1

i=0
p −1
i

gp−1−ipi
≡
gp−1 + (p −1)gp−2p
(mod p2)
≡
1 + p2v + gp−2p2 −gp−2p
(mod p2)
≡
1 −gp−2p
(mod p2)
̸≡
1
(mod p2).
Then g + p is a primitive root modulo p such that
(g + p)p−1 = 1 + pu0
and
(u0, p) = 1.
Therefore, g + p is a primitive root modulo pk for all k ≥1.
Next we prove that primitive roots exist for all moduli of the form 2pk. If
g is a primitive root modulo pk, then g +pk is also a primitive root modulo
pk. Since pk is odd, it follows that one of the two integers g and g + pk is
odd, and the other is even. Let g1 be the odd integer in the set {g, g + pk}.
Since (g + pk, pk) = (g, pk) = 1, it follows that (g1, 2pk) = 1. The order of
g1 modulo 2pk is not less than ϕ(pk), which is the order of g1 modulo pk,
and not greater than ϕ(2pk). However, since p is an odd prime, we have
ϕ(2pk) = ϕ(pk),
and so g1 has order ϕ(2pk) modulo 2pk, that is, g1 is a primitive root
modulo 2pk. This completes the proof. 2
For example, 2 is a primitive root modulo 3. Since 3 is the greatest power
of 3 that divides 22 −1, it follows that 2 is a primitive root modulo 3k for
all k ≥1, and 2 + 3k is a primitive root modulo 2 · 3k for all k ≥1.
Finally, we consider primitive roots modulo powers of 2.
Theorem 3.8 There exists a primitive root modulo m = 2k if and only if
m = 2 or 4.
Proof. We note that 1 is a primitive root modulo 2, and 3 is a primitive
root modulo 4. We shall prove that if k ≥3, then there is no primitive root
modulo 2k. Since ϕ(2k) = 2k−1, it suﬃces to show that
a2k−2 ≡1
(mod 2k)
(3.5)

3.2 Primitive Roots to Composite Moduli
95
for a odd and k ≥3. We do this by induction on k. The case k = 3 is
congruence (3.1). Let k ≥3, and suppose that (3.5) is true. Then
a2k−2 −1
is divisible by 2k. Since a is odd, it follows that
a2k−2 + 1
is even. Therefore,
a2k−1 −1 =

a2k−2 −1
 
a2k−2 + 1

is divisible by 2k+1, and so
a2k−1 ≡1
(mod 2k+1).
This completes the induction and the proof of theorem. 2
Let k ≥3. By Theorem 3.8, there is no primitive root modulo 2k, that
is, there does not exist an odd integer whose order modulo 2k is 2k−1.
However, there do exist odd integers of order 2k−2 modulo 2k.
Theorem 3.9 For every positive integer k,
52k ≡1 + 3 · 2k+2
(mod 2k+4).
Proof. The proof is by induction on k. For k = 1 we have
521 = 25 ≡1 + 3 · 23
(mod 25).
Similarly, for k = 2 we have
522 = 625 = 1 + 48 + 576 ≡1 + 3 · 24
(mod 26).
If the theorem holds for k ≥1, then there exists an integer u such that
52k = 1 + 3 · 2k+2 + 2k+4u = 1 + 2k+2(3 + 4u).
Since 2k + 4 ≥k + 5, we have
52k+1
=

52k2
=

1 + 2k+2(3 + 4u)
2
≡
1 + 2k+3(3 + 4u)
(mod 22k+4)
≡
1 + 3 · 2k+3
(mod 2k+5).
This completes the proof. 2

96
3. Primitive Roots and Quadratic Reciprocity
Theorem 3.10 If k ≥3, then 5 has order 2k−2 modulo 2k. If a ≡1
(mod 4), then there exists a unique integer i ∈{0, 1, . . . , 2k−2 −1} such
that
a ≡5i
(mod 2k).
If a ≡3
(mod 4), then there exists a unique integer i ∈{0, 1, . . . , 2k−2−1}
such that
a ≡−5i
(mod 2k).
Proof. In the case k = 3, we observe that 5 has order 2 modulo 8, and
1
≡
50
(mod 8),
3
≡
−51
(mod 8),
5
≡
51
(mod 8),
7
≡
−50
(mod 8).
Let k ≥4. By Theorem 3.9, we have
52k−2
≡
1 + 3 · 2k
(mod 2k+2)
≡
1
(mod 2k)
and
52k−3
≡
1 + 3 · 2k−1
(mod 2k+1)
≡
1 + 3 · 2k−1
(mod 2k)
̸≡
1
(mod 2k).
Therefore, 5 has order exactly 2k−2 modulo 2k, and so the integers 5i are
pairwise incongruent modulo 2k for i = 0, 1, . . . , 2k−2 −1. Since 5i ≡1
(mod 4) for all i, and since exactly half, that is, 2k−2, of the 2k−1 odd
numbers between 0 and 2k are congruent to 1 modulo 4, it follows that the
congruence
5i ≡a
(mod 2k)
is solvable for every a ≡1
(mod 4). If a ≡3
(mod 4), then −a ≡1
(mod 4) and so the congruence
−a ≡5i
(mod 2k),
or, equivalently,
a ≡−5i
(mod 2k),
is solvable. This completes the proof. 2
In algebraic language, Theorem 3.10 states that for all k ≥3,
(Z/2kZ)× = ⟨−1⟩× ⟨5⟩∼= Z/2Z × Z/2k−2Z,
where ⟨a⟩denotes the cyclic subgroup of (Z/2kZ)× generated by a for
a = −1 and a = 5.

3.2 Primitive Roots to Composite Moduli
97
Exercises
1. Find an integer g that is a primitive root modulo 5k for all k ≥1.
Find a primitive root modulo 10. Find a primitive root modulo 50.
2. For k ≥1, let ek be the order of 5 modulo 3k. Prove that
ek = 2 · 3k−1.
3. Prove that p divides the binomial coeﬃcient
p
i

for i = 1, 2, . . . , p−1.
4. Prove that if g is a primitive root modulo p2, then g is a primitive
root modulo pk for all k ≥2.
5. Let p be an odd prime. Prove that
(1 + px)pk ≡1 + pk+1x
(mod pk+2)
for every integer x and every nonnegative integer k.
6. (Nathanson [100]; see also Wagstaﬀ[151]) Let p be an odd prime,
and let a ̸= ±1 be an integer not divisible by p. Let d be the order
of a modulo p, and let k0 be the largest integer such that ad ≡
1
(mod pk0). Prove that if k ≥k0 is a solution of the exponential
congruence
ak ≡1
(mod pk),
(3.6)
then
pk
k < ad
d ,
and so congruence (3.6) has only ﬁnitely many solutions.
Hint: Apply Theorem 3.6.
7. Use Exercise 6 to prove that the exponential congruence
9k ≡1
(mod 7k)
has no solutions.
8. Find all solutions of the exponential congruence
17k ≡1
(mod 15k).
9. Find all solutions of the exponential congruence
3k ≡1
(mod 2k).

98
3. Primitive Roots and Quadratic Reciprocity
10. Let {x} denote the fractional part of x. Compute
3
2
n
for n = 1, . . . , 10. Let rn be the least nonnegative residue of 3n modulo
2n. Show that
3
2
n
= rn
3n .
Remark. It is an important unsolved problem in number theory to
understand the distribution of the fractional parts of the powers of
3/2 in the interval [0, 1).
3.3
Power Residues
Let m, k, and a be integers such that m ≥2, k ≥2, and (a, m) = 1. We
say that a is a kth power residue modulo m if there exists an integer x such
that
xk ≡a
(mod m).
If this congruence has no solution, then a is called a kth power nonresidue
modulo m.
Let k = 2 and (a, m) = 1. If the congruence x2 ≡a
(mod m) is solv-
able, then a is called a quadratic residue modulo m. Otherwise, a is called a
quadratic nonresidue modulo m. For example, the quadratic residues mod-
ulo 7 are 1, 2, and 4; the quadratic nonresidues are 3, 5, and 6. The only
quadratic residue modulo 8 is 1, and the quadratic nonresidues modulo 8
are 3, 5, 4 and 7.
Let k = 3 and (a, m) = 1. If the congruence x3 ≡a
(mod m) is solvable,
then a is called a cubic residue modulo m. Otherwise, a is called a cubic
nonresidue modulo m. For example, the cubic residues modulo 7 are 1 and
6; the cubic nonresidues are 2, 3, 4, and 5. The cubic residues modulo 5
are 1, 2, 3, and 4; there are no cubic nonresidues modulo 5.
In this and the next two sections we investigate power residues modulo
primes. In Section 3.6 we consider quadratic residues to composite moduli.
Theorem 3.11 Let p be prime, k ≥2, and d = (k, p −1). Let a be an
integer not divisible by p. Let g be a primitive root modulo p, Then a is a
kth power residue modulo p if and only if
indg(a) ≡0
(mod d)
if and only if
a(p−1)/d ≡1
(mod p).

3.3 Power Residues
99
If a is a kth power residue modulo p, then the congruence
xk ≡a
(mod p)
(3.7)
has exactly d solutions that are pairwise incongruent modulo p. Moreover,
there are exactly (p −1)/d pairwise incongruent kth power residues modulo
p.
Proof. Let ℓ= indg(a), where g is a primitive root modulo p. Congru-
ence (3.7) is solvable if and only if there exists an integer y such that
gy ≡x
(mod p)
and
gky ≡xk ≡a ≡gℓ
(mod p).
This is equivalent to
ky ≡ℓ
(mod p −1).
(3.8)
This linear congruence in y has a solution if and only if
indg(a) = ℓ≡0
(mod d),
where d = (k, p −1). Thus, the kth power residues modulo p are precisely
the integers in the (p−1)/d congruence classes gid+pZ for i = 0, 1, . . . , (p−
1)/d −1. Moreover,
a(p−1)/d ≡g(p−1)ℓ/d ≡1
(mod p)
if and only if
(p −1)ℓ
d
≡0
(mod p −1)
if and only if
indg(a) = ℓ≡0
(mod d).
Finally, if the linear congruence (3.8) is solvable, then by Theorem 2.2
it has exactly d solutions y that are pairwise incongruent modulo p −1,
and so (3.7) has exactly d solutions x = gy that are pairwise incongruent
modulo p. This completes the proof. 2
For example, let p = 19 and k = 3. Then d = (k, p−1) = (3, 18) = 3. We
can check that 2 is a primitive root modulo 19, and so a is a cubic residue
modulo 19 if and only if 3 divides ind2(a). Since −1 ≡29
(mod 3) and
ind2(−1) = 9, it follows that −1 is a cubic residue modulo 19. The solutions
of the congruence x3 ≡−1
(mod 19) are of the form x ≡2y
(mod 19),
where 0 ≤y ≤17 and 3y ≡9
(mod 18). Then y ≡3
(mod 6), and so

100
3. Primitive Roots and Quadratic Reciprocity
y = 3, 9, and 15. These give the following three cube roots of −1 modulo
19:
8 ≡23
(mod 19),
18 ≡29
(mod 19),
and
12 ≡215
(mod 19).
Corollary 3.1 Let p be an odd prime, and let k ≥2 be an integer such
that (k, p −1) = 1. If (a, p) = 1, then a is a kth power residue modulo p,
and the congruence xk ≡a
(mod p) has a unique solution modulo p.
Exercises
1. Find all cubic residues modulo 19.
2. Find all solutions of the congruence x3 ≡8
(mod 19).
3. Deﬁne the map f : (Z/19Z)× →(Z/19Z)× by f(x + 19Z) = x3 +
19Z. Prove that f is a homomorphism of the multiplicative group
(Z/19Z)×, and compute its kernel.
4. Find all ﬁfth power residues modulo 11.
5. Find all sixth power residues modulo 11.
6. Deﬁne the map f : (Z/23Z)× →(Z/23Z)× by f(x+23Z) = x3+23Z.
Prove that f is a isomorphism of the multiplicative group (Z/23Z)×,
that is, prove that f is a homomorphism that is one-to-one and onto.
7. Let xa be the least nonnegative integer such that x3
a ≡a
(mod 11).
Compute xa for a = 1, 2, . . . , 10.
8. Prove that if p ≡2
(mod 3), then every integer not divisible by p is
a cubic residue modulo p.
9. Prove that if p ≡1
(mod 6), then the product of the (p−1)/3 cubic
residues modulo p is congruent to −1 modulo p.
3.4
Quadratic Residues
Let p be an odd prime and a an integer not divisible by p. Then a is called
a quadratic residue modulo p if there exists an integer x such that
x2 ≡a
(mod p).
(3.9)

3.4 Quadratic Residues
101
If this congruence has no solution, then a is called a quadratic nonresidue
modulo p. Thus, an integer a is a quadratic residue modulo p if and only
if (a, p) = 1 and a has a square root modulo p. By Theorem 3.11, exactly
half the congruence classes relatively prime to p have square roots modulo
p.
We deﬁne the Legendre symbol for the odd prime p as follows: For any
integer a,
a
p

=



1
if (a, p) = 1 and a is a quadratic residue modulo p,
−1
if (a, p) = 1 and a is a quadratic nonresidue modulo p,
0
if p divides a.
The solvability of congruence (3.9) depends only on the congruence class
of a
(mod p), that is,
a
p

=
 b
p

if a ≡b
(mod p),
and so the Legendre symbol is a well-deﬁned function on the congruence
classes Z/pZ.
We observe that if p is an odd prime, then, by Theorem 3.2, the only
solutions of the congruence x2 ≡1
(mod p) are x ≡±1
(mod p). More-
over, if ε, ε′ ∈{−1, 0, 1} and ε ≡ε′
(mod p), then p divides ε −ε′, and so
ε = ε′. In particular, if

a
p

≡ε
(mod p), then

a
p

= ε.
Theorem 3.12 Let p be an odd prime. For every integer a,
a
p

≡a(p−1)/2
(mod p).
Proof. If p divides a, then both sides of the congruence are 0. If p does
not divide a, then, by Fermat’s theorem,

a(p−1)/22
≡ap−1 ≡1
(mod p),
and so
a(p−1)/2 ≡±1
(mod p).
Applying Theorem 3.11 with k = 2, we have
a(p−1)/2 ≡1
(mod p)
if and only if
a
p

= 1,
and so
a(p−1)/2 ≡−1
(mod p)
if and only if
a
p

= −1.

102
3. Primitive Roots and Quadratic Reciprocity
This completes the proof. 2
For example, 3 is a quadratic residue modulo the primes 11 and 13, and
a quadratic nonresidue modulo the primes 17 and 19, because
 3
11

≡35 ≡1
(mod 11),
 3
13

≡36 ≡1
(mod 13),
 3
17

≡38 ≡−1
(mod 17),
 3
19

≡39 ≡−1
(mod 19).
The next result states that the Legendre symbol is a completely multi-
plicative arithmetic function.
Theorem 3.13 Let p be an odd prime, and let a and b be integers. Then
ab
p

=
a
p
  b
p

.
Proof. If p divides a or b, then p divides ab, and
ab
p

= 0 =
a
p
  b
p

.
If p does not divide ab, then, by Theorem 3.12,
ab
p

≡
(ab)(p−1)/2
(mod p)
≡
a(p−1)/2b(p−1)/2
(mod p)
≡
a
p
  b
p

(mod p).
The result follows immediately from the observation that each side of this
congruence is ±1. 2
Theorem 3.13 implies that the Legendre symbol

·
p

is completely de-
termined by its values at −1, 2, and odd primes q. If a is an integer not
divisible by p, then we can write
a = ±2r0qr1
1 qr2
2 · · · qrk
k ,

3.4 Quadratic Residues
103
where q1, . . . , qk are distinct odd primes not equal to p. Then
a
p

=
±1
p
 2
p
r0 q1
p
r1
· · ·
qk
p
rk
.
We shall ﬁrst determine the set of primes p for which −1 is a quadratic
residue. By the following result, this depends only on the congruence class
of p modulo 4.
Theorem 3.14 Let p be an odd prime number. Then
−1
p

=

1
if
p ≡1
(mod 4),
−1
if
p ≡3
(mod 4).
Equivalently,
−1
p

= (−1)(p−1)/2.
Proof. We observe that
(−1)(p−1)/2 =

1
if
p ≡1
(mod 4),
−1
if
p ≡3
(mod 4).
Applying Theorem 3.12 with a = −1, we obtain
−1
p

≡(−1)(p−1)/2
(mod p).
Again, the theorem follows immediately from the observation that both
sides of this congruence are ±1. 2
Let p be an odd prime, and let S be a set of (p −1)/2 integers. We call
S a Gaussian set modulo p if S ∪−S = S ∪{−s : s ∈S} is a reduced
system of residues modulo p. Equivalently, S is a Gaussian set if for every
integer a not divisible by p, there exist s ∈S and ε ∈{1, −1} such that
a ≡εs
(mod p). Moreover, s and ε are uniquely determined by a. For
example, the sets {1, 2, . . . , (p −1)/2} and {2, 4, 6, . . . , p −1} are Gaussian
sets modulo p for every odd prime p. If S is a Gaussian set, s, s′ ∈S, and
s ≡±s′
(mod p), then s = s′.
Theorem 3.15 (Gauss’s lemma) Let p be an odd prime, and a an in-
teger not divisible by p. Let S be a Gaussian set modulo p. For every s ∈S
there exist unique integers ua(s) ∈S and εa(s) ∈{1, −1} such that
as ≡εa(s)ua(s)
(mod p).
Moreover,
a
p

=

s∈S
εa(s) = (−1)m,
where m is the number of s ∈S such that εa(s) = −1.

104
3. Primitive Roots and Quadratic Reciprocity
Proof. Since S is a Gaussian set, for every s ∈S there exist unique
integers ua(s) ∈S and εa(s) ∈{1, −1} such that
as ≡εa(s)ua(s)
(mod p).
Let s, s′ ∈S. If ua(s) = ua(s′), then
as′
≡
εa(s′)ua(s′) ≡εa(s′)ua(s)
(mod p)
≡
εa(s′)εa(s)εa(s)ua(s)
(mod p)
≡
±as
(mod p).
Dividing by a, we obtain
s′ ≡±s
(mod p),
and so s′ = s. It follows that the map ua : S →S is a permutation of S,
and so

s∈S
s =

s∈S
ua(s).
Therefore,
a(p−1)/2 
s∈S
s
≡

s∈S
as
(mod p)
≡

s∈S
εa(s)ua(s)
(mod p)
≡

s∈S
εa(s)

s∈S
ua(s)
(mod p)
≡

s∈S
εa(s)

s∈S
s
(mod p).
Dividing by 
s∈S s, we obtain
a
p

≡a(p−1)/2 ≡

s∈S
εa(s)
(mod p).
The proof is completed by the observation that the right and left sides of
this congruence are ±1. 2
We shall use Gauss’s lemma to compute the Legendre symbol
 3
11

. Let
S be the Gaussian set {2, 4, 6, 8, 10}. We have
3 · 2
≡
6
(mod 11),
3 · 4
≡
(−1)10
(mod 11),
3 · 6
≡
(−1)4
(mod 11),
3 · 8
≡
2
(mod 11),
3 · 10
≡
8
(mod 11).

3.4 Quadratic Residues
105
The number of s ∈S with ε3(s) = −1 is m = 2, and so
 3
11

= (−1)2 = 1,
that is, 3 is a quadratic residue modulo 11. Indeed,
52 ≡62 ≡3
(mod 11),
and so 5 and 6 are the square roots of 3 modulo 11.
Theorem 3.16 Let p be an odd prime. Then
2
p

=

1
if p ≡±1
(mod 8),
−1
if p ≡±3
(mod 8).
Equivalently,
2
p

= (−1)(p2−1)/8.
Proof. We apply Gauss’s lemma (Theorem 3.15) to the Gaussian set
S = {1, 2, 3, . . . , (p −1)/2}. Then
{2s : s ∈S} = {2, 4, 6, . . . , p −1},
and
2
p

= (−1)m,
where m is the number of integers s ∈S such that ε2(s) = −1. If 1 ≤2s ≤
(p −1)/2, then 2s ∈S, and so u2(s) = 2s and ε2(s) = 1. If (p + 1)/2 ≤
2s ≤p −1, then 1 ≤p −2s ≤(p −1)/2, and so p −2s ∈S. Since
2s ≡−(p −2s)
(mod p),
it follows that u2(s) = p −2s and ε2(s) = −1. Therefore, m is the number
of integers s ∈S such that (p + 1)/2 ≤2s ≤p −1, or, equivalently,
p + 1
4
≤s ≤p −1
2
.
(3.10)
Since every odd prime p is congruent to 1, 3, 5, or 7 modulo 8, there are
four cases to consider.
(i) If p ≡1
(mod 8), then p = 8k + 1, and s ∈S satisﬁes (3.10) if and
only if
2k + 1
2 ≤s ≤4k,
and so m = 2k and

2
p

= (−1)2k = 1.
(ii) If p ≡3
(mod 8), then p = 8k + 3, and s ∈S satisﬁes (3.10) if and
only if
2k + 1 ≤s ≤4k + 1,
and so m = 2k + 1 and

2
p

= (−1)2k+1 = −1.

106
3. Primitive Roots and Quadratic Reciprocity
(iii) If p ≡5
(mod 8), then p = 8k + 5, and s ∈S satisﬁes (3.10) if and
only if
2k + 1 + 1
2 ≤s ≤4k + 2,
and so m = 2k + 1 and

2
p

= (−1)2k+1 = −1.
(iv) If p ≡7
(mod 8), then p = 8k + 7, and s ∈S satisﬁes (3.10) if and
only if
2k + 2 ≤s ≤4k + 3,
and so m = 2k + 2 and

2
p

= (−1)2k+2 = 1.
Finally, we observe that
p2 −1
8
≡0
(mod 2)
if p ≡1 or 7
(mod 8)
and
p2 −1
8
≡1
(mod 2)
if p ≡3 or 7
(mod 8).
This completes the proof. 2
Exercises
1. Find all solutions of the congruences x2 ≡2
(mod 47) and x2 ≡2
(mod 53).
2. Prove that S = {3, 4, 5, 9, 10} is a Gaussian set modulo 11. Apply
Gauss’s lemma to this set to compute the Legendre symbols
 3
11

and
 7
11

3. Let p be an odd prime. Prove that {2, 4, 6, . . . , p −1} is a Gaussian
set modulo p.
4. Use Theorem 3.14 and Theorem 3.16 to ﬁnd all primes p for which
−2 is a quadratic residue.
5. Use Gauss’s lemma to ﬁnd all primes p for which −2 is a quadratic
residue.
6. Use Gauss’s lemma to ﬁnd all primes p for which 3 is a quadratic
residue.
7. Find all primes p for which 4 is a quadratic residue.

3.4 Quadratic Residues
107
8. Let p be an odd prime. Prove that the Legendre symbol is a homo-
morphism from the multiplicative group (Z/pZ)× into {±1}. What
is the kernel of this homomorphism?
9. For every odd prime p, deﬁne the Mersenne number
Mp = 2p −1.
A prime number of the form Mp is called a Mersenne prime (see
Exercise 5 in Section 1.5).
Let q be a prime divisor of Mp.
(a) Prove that 2 has order p modulo q, and so p divides q −1.
Hint: Fermat’s theorem.
(b) Prove that p divides (q −1)/2, and so
q ≡1
(mod 2p)
and
2(q−1)/2 ≡1
(mod q).
Hint: Both p and q are odd.
(c) Prove that

2
q

= 1, and so q ≡±1
(mod 8).
10. For every positive integer n, deﬁne the Fermat number
Fn = 22n + 1.
A prime number of the form Fn is called a Fermat prime (see Exer-
cise 7 in Section 1.5).
Let n ≥2, and let q be a prime divisor of Fn.
(a) Prove that 2 has order 2n+1 modulo q.
Hint: Exercise 8 in Section 2.5.
(b) Prove that
q ≡1
(mod 2n+1).
(c) Prove that there exists an integer a such that
a2n+1 ≡−1
(mod q).
Hint: Observe that

2
q

= 1, and so 2 ≡a2
(mod q).
(d) Prove that
q ≡1
(mod 2n+2).

108
3. Primitive Roots and Quadratic Reciprocity
Remark. By Exercise 7 in Section 1.5, the Fermat number F5 is di-
visible by the prime 641, and 641 ≡1
(mod 27).
11. A binary quadratic form is a polynomial
f(x, y) = ax2 + bxy + cy2,
where a, b, c are integers.
The discriminant of this form is the integer d = b2 −4ac. Show that
4af(x, y) = (2ax + by)2 −dy2.
12. Let p be an odd prime, and let f(x, y) = ax2 + bxy + cy2 be a
binary quadratic form with a ̸≡0
(mod p). We say that f(x, y)
has a nontrivial solution modulo p if there exist integers x and y
not both divisible by p such that f(x, y) ≡0
(mod p). Prove that
f(x, y) has a nontrivial solution modulo p if and only if either d ≡0
(mod p) or d is a quadratic residue modulo p.
13. Prove that the binary quadratic form
f(x, y) = 2x2 −15xy + 27y2
has a nontrivial solution modulo p for all primes p. Find a nontrivial
solution of the congruence
f(x, y) ≡0
(mod 11).
14. Let p and q be distinct odd prime numbers. Prove that

x1+···+xq≡q
(mod p)
1≤xi≤p−1
x1 · · · xq
p

≡1
(mod q),
where the sum is over all ordered q-tuples of integers (x1, . . . , xq) such
that x1 + · · · + xq ≡q
(mod p) and 1 ≤xi ≤p −1 for i = 1, . . . , q.
Hint: If qx ≡q
(mod p), then x ≡1
(mod p). If the q-tuple
(x1, . . . , xq) contains k distinct integers y1, . . . , yk such that integer
yj appears uj times in the q-tuple, so that k
j=1 ujyj ≡q
(mod p)
and k
j=1 uj = q, then the number of permutations of this q-tuple is
the multinomial coeﬃcient

q
u1!···uk!

. Show that

q
u1! · · · uk!

≡0
(mod q).

3.5 Quadratic Reciprocity Law
109
3.5
Quadratic Reciprocity Law
Let p and q be distinct odd primes. If q is a quadratic residue modulo p,
then the congruence
x2 ≡q
(mod p)
is solvable. Similarly, if p is a quadratic residue modulo q, then the congru-
ence
x2 ≡p
(mod q)
is solvable. There is no obvious connection between these two congruences.
One of the great discoveries of eighteenth-century mathematics is that there
is, in fact, a subtle and powerful relation between them that depends only
on the congruence classes of the primes p and q modulo 4. This is expressed
in Gauss’s celebrated law of quadratic reciprocity.
Theorem 3.17 (Quadratic reciprocity) Let p and q be distinct odd primes.
If p ≡1
(mod 4) or q ≡1
(mod 4), then p is a quadratic residue modulo
q if and only if q is a quadratic residue modulo p. If p ≡q ≡3
(mod 4),
then p is a quadratic residue modulo q if and only if q is a quadratic non-
residue modulo p. Equivalently,
p
q
 q
p

= (−1)
p−1
2
q−1
2 .
Proof. Let
S = {1, 2, . . . , (p −1)/2}
and
T = {1, 2, . . . , (q −1)/2}.
Then S is a Gaussian set for the prime p, and T is a Gaussian set for the
prime q. Let
S × T = {(s, t) : s ∈S, t ∈T}.
This is a rectangle of lattice points in R2 of cardinality
|S × T| = p −1
2
q −1
2
.
We shall count the number m of lattice points (s, t) in this rectangle that
lie in the strip deﬁned by the inequality
1 ≤pt −qs ≤p −1
2
.
(3.11)
(To understand this proof, it is helpful to choose small primes, for example,
p = 17, q = 13, and draw pictures of the rectangle S × T and the regions
deﬁned by inequalities.)

110
3. Primitive Roots and Quadratic Reciprocity
If s ∈S, t1, t2 ∈T, and the lattice points (s, t1) and (s, t2) both sat-
isfy (3.11), then
p|t1 −t2| = |(pt1 −qs) −(pt2 −qs)| < p −1
2
< p,
and so t1 = t2. It follows that for every s ∈S there exists at most one
t ∈T that satisﬁes (3.11). If this inequality holds for some t ∈T, then
pt −qs = s′ ∈S, and
qs ≡−s′
(mod p).
Using the notation in Gauss’s lemma (Theorem 3.15), we have uq(s) = s′
and εq(s) = −1.
Conversely, if s ∈S and εq(s) = −1, then
qs ≡−uq(s)
(mod p),
and there exists an integer t such that
qs = −uq(s) + pt.
Since
0 < pt = qs + uq(s) ≤q(p −1)
2
+ p −1
2
= (q + 1)(p −1)
2
,
it follows that
1 ≤t ≤(q + 1)(p −1)
2p
< q + 1
2
.
The prime q is odd, and so
1 ≤t ≤q −1
2
.
Therefore, t ∈T, and the lattice point (s, t) ∈S × T satisﬁes inequal-
ity (3.11). Thus, the number m of lattice points (s, t) ∈S × T that satisfy
inequality (3.11) is equal to the number of s ∈S such that εq(s) = −1. By
Gauss’s lemma,
q
p

= (−1)m.
Similarly,
p
q

= (−1)n,
where n is the number of lattice points (s, t) ∈S × T such that
1 ≤qs −pt ≤q −1
2
,

3.5 Quadratic Reciprocity Law
111
or, equivalently,
−q −1
2
≤pt −qs ≤−1.
(3.12)
Since pt −qs ̸= 0 for all s ∈S and t ∈T, it follows that
p
q
 q
p

= (−1)m+n,
where m + n is the number of lattice points (s, t) ∈S × T such that
−q −1
2
≤pt −qs ≤p −1
2
.
(3.13)
Let M denote the number of lattice points (s, t) ∈S × T such that
pt −qs > p −1
2
and let N denote the number of lattice points (s, t) ∈S × T such that
pt −qs < −q −1
2
.
Then
m + n + M + N = |S × T| = p −1
2
q −1
2
.
We deﬁne a map from the set S × T to itself by reﬂection:
(s, t) →(s′, t′),
where
s′ = p + 1
2
−s
and
t′ = q + 1
2
−t.
This map is a bijection, since
p + 1
2
−s′ = s
and
q + 1
2
−t′ = t.
If (s, t) ∈S × T and
pt −qs > p −1
2
,

112
3. Primitive Roots and Quadratic Reciprocity
then (s′, t′) ∈S × T and
pt′ −qs′
=
p
q + 1
2
−t

−q
p + 1
2
−s

=
p
2 −pt −q
2 + qs
=
−(pt −qs) + p −1
2
−q −1
2
<
−q −1
2
.
Therefore, M ≤N. Similarly, if (s, t) ∈S × T and
pt −qs < −q −1
2
,
then (s′, t′) ∈S × T and
pt′ −qs′ > p −1
2
,
and so M ≥N. Therefore, M = N and
p
q
 q
p

=
(−1)m+n = (−1)m+n+2M
=
(−1)m+n+M+N = (−1)
p−1
2
q−1
2 .
This completes the proof. 2
The quadratic reciprocity law provides an eﬀective method to calculate
the value of the Legendre symbol. For example, since 7 ≡59 ≡3
(mod 4)
and 59 ≡3
(mod 7), we have
 7
59

=
−
59
7

= −
3
7

=
7
3

=
1
3

=
1.
Similarly, since 51 = 3 · 17 and 97 ≡17 ≡1
(mod 4), we have
51
97

=
 3
97
 17
97

=
97
3
 97
17

=
1
3
 12
17

=
12
17


3.5 Quadratic Reciprocity Law
113
=
 4
17
  3
17

=
 3
17

=
17
3

=
2
3

=
−1.
Quadratic reciprocity also allows us to determine all primes p for which a
given integer a is a quadratic residue. Here are some examples. If a = 5,
then
5
p

=
p
5

=

1
if p ≡1, 4
(mod 5),
−1
if p ≡2, 3
(mod 5).
Let a = 7. If p ≡1
(mod 4), then
7
p

=
p
7

=

1
if p ≡1, 2, 4
(mod 7),
−1
if p ≡3, 5, 6
(mod 7).
If p ≡3
(mod 4), then
7
p

= −
p
7

=

1
if p ≡3, 5, 6
(mod 7),
−1
if p ≡1, 2, 4
(mod 7).
Equivalently,
7
p

=

1
if p ≡1, 3, 9, 19, 25, 27
(mod 28),
−1
if p ≡5, 11, 13, 15, 17, 23
(mod 28).
Let a = 35. Then
35
p

= 1
if and only if
p ≡1, 4
(mod 5)
and
p ≡1, 3, 9, 19, 25, 27
(mod 28)
or
p ≡2, 3
(mod 5)
and
p ≡5, 11, 13, 15, 17, 23
(mod 28).
This is equivalent to a set of congruence classes modulo 140.
Exercises
1. Let p = 11 and q = 7. Using the notation in the proof of the law
of quadratic reciprocity (Theorem 3.17), we have m + n + M + N =
|S × T| = 15. Compute the numbers m, n, M, and N. Check that
 7
11

= (−1)m and
 11
7

= (−1)n.
2. Use quadratic reciprocity to compute
 7
43

. Find an integer x such
that x2 ≡7
(mod 43).

114
3. Primitive Roots and Quadratic Reciprocity
3. Use quadratic reciprocity to compute
 19
101

. Find an integer x such
that x2 ≡19
(mod 101).
4. Prove that the congruence
(x2 −2)(x2 −17)(x2 −34) ≡0
(mod p)
has a solution for every prime number p.
5. Use quaratic reciprocity to ﬁnd all primes p for which −2 is a quadratic
residue.
6. Use quaratic reciprocity to ﬁnd all primes p for which 3 is a quadratic
residue.
7. Find all primes for which −3 is a quadratic residue.
8. Find all primes for which 5 is a quadratic residue.
9. Find all primes for which −5 is a quadratic residue.
10. Find all primes p for which the binary quadratic form f(x, y) = x2 +
xy + y2 has a nontrivial solution modulo p.
Hint: Apply Exercise 11 in Section 3.4.
11. In Exercises 11–17 we derive properties of the Jacobi symbol, which
is a generalization of the Legendre symbol to composite moduli. Let
m be an odd positive integer, and let
m =
r

i=1
pki
i
be the factorization of m into the product of powers of distinct prime
numbers. For any nonzero integer a, we deﬁne the Jacobi symbol
 a
m

as follows:
 a
m

=
r

i=1
 a
pi
ki
.
(a) Prove that if a ≡b
(mod m), then
 a
m

=
 b
m

.
(b) For any integers a and b, prove that
ab
m

=
 a
m
  b
m

.

3.5 Quadratic Reciprocity Law
115
(c) Prove that
 a
m

= 0 if and only if (a, m) > 1.
12. Compute the Jacobi symbol
 38
165

.
13. Let m be an odd positive integer, and let (a, m) = 1. The integer a is
called a quadratic residue modulo m if there exists an integer x such
that
x2 ≡a
(mod m)
and a quadratic nonresidue modulo m if this congruence has no solu-
tion. Prove that if
 a
m

= −1, then a is a quadratic nonresidue modulo
m. Prove that a is not necessarily a quadratic residue modulo m if
 a
m

= 1.
Hint: Consider m = 21 and a = −1.
14. Let m = pk, where p is an odd prime and k ≥1. Prove that
m −1
2
≡k(p −1)
2
(mod 2).
Hint: Use the binomial theorem to expand m = ((p −1) + 1)k.
15. Let m be an odd positive integer with standard factorization m =
r
i=1 pki
i . Prove that
m −1
2
≡
r

i=1
ki(pi −1)
2
(mod 2).
Hint: Use induction on r.
Prove that
−1
m

= (−1)(m−1)/2.
16. Let m be an odd positive integer with standard factorization m =
r
i=1 pki
i . Prove that
m2 −1
8
≡
r

i=1
ki(p2
i −1)
8
(mod 8)
and
 2
m

= (−1)(m2−1)/8.
17. Let m and n be relatively prime odd positive integers with standard
factorizations
m =
r

i=1
pki
i

116
3. Primitive Roots and Quadratic Reciprocity
and
n =
s

j=1
qℓj
j .
Prove that
m −1
2
n −1
2
≡
r

i=1
s

j=1
kiℓj
pi −1
2
 qj −1
2

(mod 2)
and
 n
m
 m
n

= (−1)
m−1
2
n−1
2 .
3.6
Quadratic Residues to Composite Moduli
Let m be an odd positive integer and a an integer relatively prime to m.
We shall prove that a is a quadratic residue modulo m if and only if a is a
quadratic residue modulo p for every prime p that divides m. The Chinese
remainder theorem (see Theorem 2.11) implies that it suﬃces to consider
congruences modulo prime powers.
We begin with Hensel’s lemma, an important result that gives a suﬃcient
condition that a polynomial congruence solvable modulo a prime p will also
be solvable modulo pk for every positive integer k.
Let
f(x) = anxn + an−1xn−1 + · · · + a1x + a0
be a polynomial with coeﬃcients in a ring R. The derivative of f(x) is the
polynomial
f ′(x) = nanxn−1 + (n −1)an−1xn−2 + · · · + a1.
If f(x) is a polynomial of degree n ≥1 with coeﬃcients in the ring Z,
then the derivative f ′(x) has degree n −1 and leading coeﬃcient nan. For
example, if f(x) = x3 −5x + 1, then f ′(x) = 3x2 −5. Moreover,
f(x + h)
=
(x + h)3 −5(x + h) + 1
=
(x3 + 3x2h + 3xh2 + h3) −(5x + 5h) + 1
=
(x3 −5x + 1) + (3x2 −5)h + (3x + h)h2
=
f(x) + f ′(x)h + r(x, h)h2,
where r(x, h) = 3x + h.
Theorem 3.18 Let R be a ring and f(x) = n
i=0 aixi a polynomial with
coeﬃcients in R. Then
f(x + h) = f(x) + f ′(x)h + r(x, h)h2.
where r(x, h) is a polynomial in the two variables x and h with coeﬃcients
in R.

3.6 Quadratic Residues to Composite Moduli
117
Proof. This is a standard calculation. Expanding f(x + h) by the bino-
mial theorem, we obtain
f(x + h)
=
n

i=0
ai(x + h)i
=
n

i=0
ai
i

j=0
i
j

xi−jhj
=
n

j=0
n

i=j
i
j

aixi−jhj
=
n

i=0
aixi +
n

i=1
iaixi−1h +
n

j=2
n

i=j
i
j

aixi−jhj
=
f(x) + f ′(x)h + r(x, h)h2,
where
r(x, h) =
n

j=2
n

i=j
i
j

aixi−jhj−2
is a polynomial in x and h with coeﬃcients in R. 2
Theorem 3.19 (Hensel’s lemma) Let p be prime, and let f(x) be a
polynomial of degree n with integer coeﬃcients and leading coeﬃcient not
divisible by p. If there exists an integer x1 such that
f(x1) ≡0
(mod p)
and
f ′(x1) ̸≡0
(mod p),
then for every k ≥2 there exists an integer xk such that
f(xk) ≡0
(mod pk)
(3.14)
and
xk ≡xk−1
(mod pk−1).
(3.15)
Proof. The proof is by induction on k. We begin by constructing x2.
There exist integers u1 and v1 such that f(x1) = u1p and f ′(x1) = v1 ̸≡0
(mod p). We shall prove that there exists an integer y1 such that f(x1 +
y1p) ≡0
(mod p2).
By Theorem 3.18, there exists a polynomial r(x, h) with integer coeﬃ-
cients such that
f(x1 + y1p)
=
f(x1) + f ′(x1)y1p + r(x1, y1p)p2
=
u1p + v1y1p + r(x1, y1p)p2
≡
u1p + v1y1p
(mod p2).

118
3. Primitive Roots and Quadratic Reciprocity
Therefore, there exists an integer y1 such that
f(x1 + y1p) ≡0
(mod p2)
if and only if the linear congruence
v1y ≡−u1
(mod p)
is solvable. We see that this congruence does have a solution y1 because
(v1, p) = 1. Let
x2 = x1 + y1p.
Then
f(x2) ≡0
(mod p)
and
x2 ≡x1
(mod p).
Let k ≥3, and assume that we have constructed integers x2, . . . , xk−1
such that
f(xi) ≡0
(mod pi)
and
xi ≡xi−1
(mod pi−1)
for i = 2, . . . , k −1. There exists an integer uk−1 such that
f(xk−1) = uk−1pk−1.
Let f ′(xk−1) = vk−1. Since xk−1 ≡x1
(mod p), it follows that
vk−1 = f ′(xk−1) ≡f ′(x1) ̸≡0
(mod p).
Applying Theorem 3.18 with t = xk−1 and h = yk−1pk−1, we obtain
f

xk−1 + yk−1pk−1
=
f (xk−1) + f ′(xk−1)yk−1pk−1 + r(xk−1, yk−1pk−1)y2
k−1p2k−2
≡
uk−1pk−1 + vk−1yk−1pk−1
(mod pk).
It follows that
f

xk−1 + yk−1pk−1
≡0
(mod pk)
if and only if there exists an integer yk−1 such that
vk−1yk−1 ≡−uk−1
(mod p).
This last congruence is solvable, since (vk−1, p) = 1, and the integer xk =
xk−1 + yk−1pk−1 satisﬁes conditions (3.14) and (3.15). 2
Theorem 3.20 Let p be an odd prime, and let a be an integer not divisible
by p. If a is a quadratic residue modulo p, then a is a quadratic residue
modulo pk for every k ≥1.

3.6 Quadratic Residues to Composite Moduli
119
Proof. Consider the polynomial f(x) = x2 −a and its derivative f ′(x) =
2x. If a is a quadratic residue modulo p, then there exists an integer x1 such
that x1 ̸≡0
(mod p) and x2
1 ≡a
(mod p). Then f(x1) ≡0
(mod p)
and f ′(x1) ̸≡0
(mod p). By Hensel’s lemma, the polynomial congruence
f(x) ≡0
(mod pk) is solvable for every k ≥1, and so a is a quadratic
residue modulo pk for every k ≥1. 2
Exercises
1. Let x1 = 3. Costruct integers xk such that x2
k ≡2
(mod 7k) and
xk ≡xk−1
(mod 7k−1) for k = 2, 3, 4.
2. Let p be a prime, p ̸= 3, and let a be an integer not divisible by p.
Prove that if a is a cubic residue modulo p, then a is a cubic residue
modulo pk for every k ≥1.
3. Denote the derivative of the polynomial f(x) by D(f)(x) = f ′(x).
We deﬁne
D(0)(f)(x)
=
f(x),
D(k)(f)(x)
=
D

D(k−1)(f)

(x)
for k ≥1.
The polynomial D(k)(f) is called the kth derivative of f. Prove that
if f(x) is a polynomial with integer coeﬃcients, then D(k)(f)(x) = 0
if and only if the degree of f(x) is at most k −1.
4. Let f(x) and g(x) be polynomials. Prove the Leibniz formula
D(f · g)(x) = f(x) · D(g)(x) + D(f)(x) · g(x).
5. Let f(x) be a polynomial of degree n. Prove Taylor’s formula
f(x + h) =
n

k=0
D(k)(x)
k!
hk.
6. This exercise generalizes Hensel’s lemma (Theorem 3.19). Let p be a
prime, and f(x) a polynomial of degree n with integer coeﬃcients and
leading coeﬃcient not divisible by p. Let ℓbe a nonnegative integer.
If there exists an integer x1 such that
f(x1)
≡
0
(mod p2ℓ+1),
f ′(x1)
≡
0
(mod pℓ),

120
3. Primitive Roots and Quadratic Reciprocity
and
f ′(x1) ̸≡0
(mod pℓ+1),
then for every k ≥2 there exists an integer xk such that
f(xk) ≡0
(mod p2ℓ+k)
and
xk ≡xk−1
(mod pℓ+k−1).
Hint: Prove by induction on k. To begin the induction, ﬁnd an integer
y1 such that f(x1 + y1pℓ+1) ≡0
(mod p2ℓ+2) and let x2 = x1 +
y1pℓ+1.
3.7
Notes
Primitive roots and quadratic reciprocity are classical topics in number
theory and a standard part of an introductory course in the subject.
There are still many simple questions about primitive roots that we can-
not answer. For example, we cannot determine the prime numbers for which
2 is a primitive root. We do not even know if the number of such primes is
ﬁnite or inﬁnite. Gauss conjectured that 10 is a primitive root for inﬁnitely
many primes. This would imply, by Exercise 9 in Section 2.5, there are
inﬁnitely many primes p such that the decimal expansion of the fraction
1/p has period p −1. We do not, in fact, know even one integer that is a
primitive root for inﬁnitely many primes. There is an amazing result due to
Gupta and Murty [44] and Heath-Brown [62] that states that every prime
number, with at most two exceptions, is a primitive root for inﬁnitely many
primes. It follows that at least one of the numbers 2, 3, and 5 is a primitive
root for inﬁnitely many primes, but we do not know which one.
Let a be an integer that is not a square and a ̸= −1. A conjecture of
Artin [5, page viii] states that there exist inﬁnitely many primes for which
a is a primitive root. Moreover, Artin has a conjectured density for the set
of primes for which a is a primitive root. Murty [98] is a nice survey paper
of Artin’s conjecture and its generalizations. Erd˝os asked the following: For
every suﬃciently large prime p, does there exist a prime q < p such that q
is a primitive root modulo p?

4
Fourier Analysis on Finite Abelian
Groups
4.1
The Structure of Finite Abelian Groups
This chapter introduces analysis on ﬁnite abelian groups and their char-
acters. We begin by using elementary number theory to determine the
structure of ﬁnite abelian groups.
Let G be an abelian group, written additively, and let A1, . . . , Ak be
subsets of G. The sum of these sets is the set
A1 + · · · + Ak = {a1 + · · · + ak : ai ∈Ai for i = 1, . . . , k}.
If G1, . . . , Gk are subgroups of G, then the sumset G1 + · · · + Gk is a
subgroup of G (Exercise 2). We say that G is the direct sum of the subgroups
G1, . . . , Gk, written G = G1⊕· · ·⊕Gk, if every element g ∈G can be written
uniquely in the form g = g1 + · · · + gk, where gi ∈Gi for i = 1, . . . , k. If
G = G1 ⊕· · · ⊕Gk, then |G| = |G1| · · · |Gk| (Exercise 3).
The order of an element g in an additive group is the smallest positive
integer d such that dg = 0. By Theorem 2.16, the order of an element of a
ﬁnite group divides the order of the group.
Let p be a prime number. A p-group is a group each of whose elements
has an order that is a power of p. For every prime number p, let G(p)
denote the set of all elements of G whose order is a power of p. Then G(p)
is a subgroup of the abelian group G (Exercise 6).
Theorem 4.1 Let G be a ﬁnite abelian group, written additively, and let
|G| = m. For every prime number p, let G(p) be the set of all elements

122
4. Fourier Analysis on Finite Abelian Groups
g ∈G whose order is a power of p. Then
G =

p|m
G(p).
Proof. Let m = k
i=1 pri
i
be the standard factorization of m, and let
mi = mp−ri
i
for i = 1, . . . , k. Then (m1, . . . , mk) = 1 by Exercise 15 in
Section 1.4, and so there exist integers u1, . . . , uk such that
m1u1 + · · · + mkuk = 1.
Let g ∈G, and deﬁne gi = miuig ∈G for i = 1, . . . , k. Since pri
i gi =
muig = 0, it follows that gi ∈G(p). Moreover,
g
=
(m1u1 + · · · + mkuk)g = m1u1g + · · · + mkukg
=
g1 + · · · + gk ∈G(p1) + · · · + G(pk),
and so
G = G(p1) + · · · + G(pk).
Suppose that
g1 + · · · + gk = 0,
where gi ∈G(pi) for i = 1, . . . , k. There exist nonnegative integers r1, . . . , rk
such that gi has order pri
i for i = 1, . . . , k. Let
dj =
k

i=1
i̸=j
pri
i .
If gj ̸= 0, then djgj ̸= 0. Since djgi = 0 for i = 1, . . . , k, i ̸= j, it follows
that
0 = dj(g1 + · · · + gk) = djgj,
and so gj = 0 for all j = 1, . . . , k. Thus, 0 has no nontrivial representation
in G = G(p1)+· · ·+G(pk). By Exercise 4, we conclude that G is the direct
sum of the subgroups G(pi). 2
Lemma 4.1 Let G be a ﬁnite abelian p-group. Let g1 ∈G be an element
of maximum order pr1, and let G1 = ⟨g1⟩be the cyclic subgroup generated
by g1. Consider the quotient group G/G1. Let h ∈G. If h + G1 ∈G/G1
has order pr, then there exists an element g ∈G such that g +G1 = h+G1
and g has order pr in G.
Proof. If h + G1 has order pr in G/G1, then the order of h in G is
at most pr1 (since pr1 is the maximum order in G) and at least pr (by

4.1 The Structure of Finite Abelian Groups
123
Exercise 7). Since G1 = pr(h + G1) = prh + G1, it follows that prh ∈G1,
and so prh = ug1 for some positive integer u ≤pr1 (since g1 has order pr1).
Write u = psv, where (p, v) = 1 and 0 ≤s ≤r1. Then vg1 also has order
pr1, and so psvg1 has order pr1−s in G. Then prh = psvg1 has order pr1−s
in G, and so h has order pr1+r−s ≤pr1. It follows that r ≤s, and
prh = psvg1 = pr(ps−rvg1) = prg′
1,
where
g′
1 = ps−rvg1 ∈G1.
Let
g = h −g′
1.
Then
g + G1 = h + G1.
Moreover, prg = prh −prg′
1 = 0, and so the order of g is at most pr. On
the other hand, g + G1 has order pr in the quotient group G/G1, and so
the order of g is at least pr. Therefore, g has order pr. 2
Theorem 4.2 Every ﬁnite abelian p-group is a direct sum of cyclic groups.
Proof. The proof is by induction on the cardinality of G. Let G be a
ﬁnite abelian p-group. If G is cyclic, we are done. If G is not cyclic, let
g1 ∈G be an element of maximum order pr1, and let G1 be the cyclic
subgroup generated by g1. The quotient group G/G1 is a ﬁnite abelian
p-group, and
1 < |G/G1| = |G|
pr1 < |G|.
Therefore, the induction hypothesis holds for G/G1, and so
G/G1 = H2 ⊕· · · ⊕Hk,
where Hi is a cyclic subgroup of G/G1 of order pri for i = 2, . . . , k. More-
over,
|G|
pr1 = |G/G1| =
k

i=2
pri.
By Lemma 4.1, for each i = 2, . . . , k there exists an element gi ∈G such
that gi + G1 generates Hi and gi has order pri in G. Let Gi be the cyclic
subgroup of G generated by gi. Then |Gi| = pri for i = 1, . . . , k. We shall
prove that G = G1 ⊕· · · ⊕Gk.
We begin by showing that G = G1 + · · · + Gk. If g ∈G, then g + G1 ∈
G/G1, and there exist integers u2, . . . , uk such that
0 ≤ui ≤pri −1
for i = 2, . . . , k

124
4. Fourier Analysis on Finite Abelian Groups
and
g + G1 = u2(g2 + G1) ⊕· · · ⊕uk(gk + G1) = (u2g2 + · · · + ukgk) + G1.
It follows that
g −(u2g2 + · · · + ukgk) = u1g1 ∈G1
for some integer u1 such that
0 ≤u1 ≤pr1 −1,
and so
g = u1g1 + u2g2 + · · · + ukgk ∈G1 + · · · + Gk.
Therefore, G = G1 + · · · + Gk. Since
|G| = |G1 + · · · + Gk| ≤|G1| · · · |Gk| =
k

i=1
pri = |G|,
it follows that every element of G has a unique representation as an element
in the sumset G1 +· · ·+Gk, and so G = G1 ⊕+ · · ·+⊕Gk. This completes
the proof. 2
Theorem 4.3 Every ﬁnite abelian group is a direct sum of cyclic groups.
Proof. This follows immediately from Theorem 4.1 and Theorem 4.2.
2
Let G1, . . . , Gk be abelian groups, written additively. Their direct product
is the group
G1 × · · · × Gk = {(g1, . . . , gk) : gi ∈Gi for i = 1, . . . , k},
with addition deﬁned by
(g1, . . . , gk) + (g′
1, . . . , g′
k) = (g1 + g′
1, . . . , gk + g′
k).
If G1, . . . , Gk are subgroups of an abelian group G and if G = G1⊕· · ·⊕Gk,
then G ∼= G1 × · · · × Gk (Exercise 5).
Let G1, . . . , Gk be abelian groups, written multiplicatively. Their direct
product is the group G1 × · · · × Gk consisting of all k-tuples (g1, . . . , gk)
with gi ∈Gi for i = 1, . . . , k and multiplication deﬁned coordinate-wise by
(g1, . . . , gk)(g′
1, . . . , g′
k) = (g1g′
1, . . . , gkg′
k).

4.1 The Structure of Finite Abelian Groups
125
Exercises
1. Let G = Z/12Z be the additive group of congruence classes modulo
12. Compute G(2) and G(3) and show explicitly that G(2) ∼= Z/4Z,
G(3) ∼= Z/3Z, and
Z/12Z ∼= Z/4Z ⊕Z/3Z.
2. Let G be an abelian group, written additively, and let G1, . . . , Gk be
subgroups of G. Prove that G1 + · · · + Gk is a subgroup of G.
3. Let G be an abelian group, written additively, and let G1, . . . , Gk
be subgroups of G such that G = G1 + · · · + Gk. Prove that |G| ≤
|G1| · · · |Gk|. Prove that G = G1 ⊕· · · ⊕Gk if and only if |G| =
|G1| · · · |Gk|.
4. Let G be an abelian group, written additively, and let G1, . . . , Gk
be subgroups of G such that G = G1 + · · · + Gk. Prove that G =
G1 ⊕· · · ⊕Gk if and only if the only representation of 0 in the form
0 = g1 + · · · + gk with gi ∈Gi is g1 = · · · = gk = 0.
5. Let G1, . . . , Gk be subgroups of an abelian group G such that G =
G1 ⊕· · · ⊕Gk. Prove that G ∼= G1 × · · · × Gk.
6. Let G be an additive abelian group. For every prime number p, let
G(p) denote the set of all elements of G whose order is a power of p.
Prove that G(p) is a subgroup of G.
7. Let f : G →H be a group homomorphism, and let g ∈G. Prove that
the order of f(g) in H divides the order of g in G. Prove that if G is
a p-group and f is surjective, then H is a p-group.
8. Let G be a ﬁnite abelian p-group. If r1, . . . , rk are positive integers
with r1 ≥· · · ≥rk, then we say that G is of type (pr1, . . . , prk)
if G ∼= G1 ⊕· · · ⊕Gk, where Gi is a cyclic group of order pri for
i = 1, . . . , k. We shall prove that every ﬁnite abelian p-group has a
unique type.
Let pG = {pg : g ∈G}.
(a) Prove that pG is a subgroup of G.
(b) Prove that if G is of type (pr1, . . . , prk) with rj ≥2 and rj+1 =
· · · rk = 1, then pG is of type (pr1−1, . . . , prj−1).
(c) Prove that
|G| = pk|pG|.
(d) Prove that if G is of type (pr1, . . . , prk) and also of type (ps1, . . . , psℓ),
then k = ℓ.

126
4. Fourier Analysis on Finite Abelian Groups
(e) Prove that if the ﬁnite abelian p-group G is of type (pr1, . . . , prk)
and of type (ps1, . . . , psk), then ri = si for i = 1, . . . , k.
Hint: Use induction on the cardinality of G. Let j and ℓbe
the greatest integers such that rj ≥2 and sℓ≥2, respectively.
Apply the induction hypothesis to pG to show that j = ℓand
ri = si for i = 1, . . . , j.
4.2
Characters of Finite Abelian Groups
Let G be a ﬁnite abelian group, written additively. A group character is
a homomorphism χ : G →C×, where C× is the multiplicative group of
nonzero complex numbers. Then χ(0) = 1 and χ(g1 + g2) = χ(g1)χ(g2) for
all g1, g2 ∈G.
If χ is a character of a multiplicative group G, then χ(1) = 1 and
χ(g1g2) = χ(g1)χ(g2) for all g1, g2 ∈G.
We deﬁne the character χ0 on G by χ0(g) = 1 for all g ∈G.
If G is an additive group of order n and if g ∈G has order d, then
χ(g)d = χ(dg) = χ(0) = 1,
and so χ(g) is a dth root of unity. By Theorem 2.16, d divides n and χ(g)
is an nth root of unity for every g ∈G. We have |χ(g)| = 1 for all g ∈G.
We deﬁne the product of two characters χ1 and χ2 by
χ1χ2(g) = χ1(g)χ2(g)
for all g ∈G. This product is associative and commutative. The character
χ0 is a multiplicative identity, since
χ0χ(g) = χ0(g)χ(g) = χ(g)
for every character χ and g ∈G.
The inverse of the character χ is the character χ−1 deﬁned by
χ−1(g) = χ(−g),
since
χχ−1(g)
=
= χ(g)χ−1(g) = χ(g)χ(−g)
=
χ(g −g) = χ(0) = 1
=
χ0(g),
and so χχ−1 = χ0.
The complex conjugate of a character χ is the character χ deﬁned by
χ(g) = χ(g).

4.2 Characters of Finite Abelian Groups
127
Since |χ(g)| = 1 for all g ∈G, we have
(χχ)(g) = χ(g)χ)(g) = |χ(g)|2 = 1 = χ0(g),
and so
χ−1(g) = χ(g)
for every character χ and all g ∈G.
It follows that the set of all characters of a ﬁnite abelian group G is an
abelian group, called the dual group or character group of G, and denoted
by  G.
We shall prove that G ∼=  G for every ﬁnite abelian group G. We
begin with ﬁnite cyclic groups.
Lemma 4.2 The dual of a cyclic group of order n is also a cyclic group
of order n.
Proof. We introduce the exponential functions
e(x) = e2πix
and
en(x) = e(x/n) = e2πix/n.
The nth roots of unity are the complex numbers en(a) for a = 0, 1, . . . , n−1.
Let G be a ﬁnite cyclic group of order n with generator g0. Then G =
{jg0 : j = 0, 1, . . . , n −1}. For every integer a, we deﬁne ψa ∈ G by
ψa(jg0) = en(aj).
(4.1)
By Exercise 3, we have ψaψb = ψa+b, ψ−1
a
= ψ−a, ψa = ψb if and only if
a ≡b
(mod n). It follows that
ψa = ψa
1
for every integer a. If χ is a character in  G, then χ is completely determined
by its value on g0. Since χ(g0) is an nth root of unity, we have χ(g0) = en(a)
for some integer a = 0, 1, . . . , n−1, and so χ(jg0) = en(aj) for every integer
j. Therefore, χ = ψa and
 G = {ψa : a = 0, 1, . . . , n −1} = {ψa
1 : a = 0, 1, . . . , n −1}
is also a cyclic group of order n, that is, G ∼=  G. 2
It is a simple but critical observation that if g is a nonzero element of a
cyclic group G, then ψ1(g) ̸= 1 (Exercise 4).

128
4. Fourier Analysis on Finite Abelian Groups
Lemma 4.3 Let G be a ﬁnite abelian group and let G1, . . . , Gk be sub-
groups of G such that G = G1 ⊕· · · ⊕Gk. For every character χ ∈ G there
exist unique characters χi ∈!
Gi such that if g ∈G and g = g1 + · · · + gk
with gi ∈Gi for i = 1, . . . , k, then
χ(g) = χ1(g1) · · · χk(gk).
(4.2)
Moreover,
 G ∼= !
G1 × · · · × !
Gk.
Proof. If χi ∈!
Gi for i = 1, . . . , k, then we can construct a map χ : G →
C× as follows. Let g ∈G. There exist unique elements gi ∈Gi such that
g = g1 + · · · + gk. Deﬁne
χ(g) = χ(g1 + · · · + gk) = χ1(g1) · · · χk(gk).
Then χ is a character in  G, and this construction induces a map
Ψ : !
G1 × · · · × !
Gk → G.
(4.3)
By Exercise 5, the map Ψ is a one-to-one homomorphism. We shall show
that the map Ψ is onto. Let χ ∈ G. We deﬁne the function χi on Gi by
χi(gi) = χ(gi)
for all gi ∈Gi.
Then χi is a character in !
Gi. If g ∈G and g = g1 + · · · + gk with gi ∈Gi,
then
χ(g) = χ(g1 + · · · + gk) = χ(g1) · · · χ(gk) = χ1(g1) · · · χk(gk).
It follows that
Ψ(χ1, . . . , χk) = χ,
and so Ψ is onto. 2
Theorem 4.4 Let G be a ﬁnite abelian group. If g is a nonzero element
of G, then there is a character χ ∈ G such that χ(g) ̸= 1.
Proof. We write G = G1 ⊕· · · ⊕Gk as a direct product of cyclic groups.
If g ̸= 0, then there exist g1 ∈G1, . . . , gk ∈Gk such that g = g1 + · · · + gk,
and gj ̸= 0 for some j. Since the group Gj is cyclic, there is a character
χj ∈!
Gj such that χj(gj) ̸= 1. For i = 1, . . . , k, i ̸= j, let χi ∈!
Gi be the
character deﬁned by χi(g1) = 1 for all gi ∈Gi. If χ = Ψ(χ1, . . . , χk) ∈ G,
then χ(g) = χj(gj) ̸= 1. 2

4.2 Characters of Finite Abelian Groups
129
Theorem 4.5 A ﬁnite abelian group G is isomorphic to its dual, that is,
G ∼=  G.
Proof. By Lemma 4.2, the dual of a ﬁnite cyclic group of order n is also
a ﬁnite cyclic group of order n. By Theorem 4.3, a ﬁnite abelian group G
has cyclic subgroups G1, . . . , Gk such that
G = G1 ⊕· · · ⊕Gk.
By Lemma 4.3 and Exercise 5 in Section 4.1,
 G ∼= !
G1 × · · · × !
Gk ∼= G1 × · · · × Gk ∼= G1 ⊕· · · ⊕Gk = G.
This completes the proof. 2
Let G be a ﬁnite abelian group of order n. There is a pairing ⟨, ⟩from
G ×  G into the group of nth roots of unity deﬁned by
⟨a, χ⟩= χ(a).
This map is nondegenerate in the sense that ⟨a, χ⟩= 1 for all group elements
a ∈G if and only if χ = χ0, and ⟨a, χ⟩= 1 for all characters χ ∈ G if and
only if a = 0 (by Theorem 4.4).
For each a ∈G, the function ⟨a, ⟩is a character of the dual group  G, that
is, ⟨a, ⟩∈  G. The map ∆: G →  G deﬁned by a −→⟨a, ⟩or, equivalently,
∆(a)(χ) = ⟨a, χ⟩= χ(a),
(4.4)
is a homomorphism of the group G into its double dual   G. Since the pairing
is nondegenerate, this homomorphism is one-to-one. Since |G| = |  G| = |  G|,
it follows that ∆is a natural isomorphism of G onto   G.
Theorem 4.6 (Orthogonality relations) Let G be a ﬁnite abelian group
of order n, and let  G be its dual group. If χ ∈ G, then

a∈G
χ(a) =

n
if χ = χ0,
0
if χ ̸= χ0.
If a ∈G, then

χ∈ 
G
χ(a) =

n
if a = 0,
0
if a ̸= 0.

130
4. Fourier Analysis on Finite Abelian Groups
Proof. For χ ∈ G, let
S(χ) =

a∈G
χ(a).
If χ = χ0, then S(χ0) = |G| = n. If χ ̸= χ0, then χ(b) ̸= 1 for some b ∈G,
and
χ(b)S(χ)
=
χ(b)

a∈G
χ(a)
=

a∈G
χ(ba)
=

a∈G
χ(a)
=
S(χ),
and so S(χ) = 0.
For a ∈G, let
T(a) =

χ∈ 
G
χ(a).
If a = 0, then T(a) = |  G| = n. If a ̸= 0, then χ′(a) ̸= 1 for some χ′ ∈ G
(by Theorem 4.4), and
χ′(a)T(a)
=
χ′(a)

χ∈ 
G
χ(a)
=

χ∈ 
G
χ′χ(a)
=

χ∈ 
G
χ(a)
=
T(a),
and so T(a) = 0. This completes the proof. 2
Theorem 4.7 (Orthogonality relations) Let G be a ﬁnite abelian group
of order n, and let  G be its dual group. If χ1, χ2 ∈ G, then

a∈G
χ1(a)χ2(a) =

n
if χ1 = χ2,
0
if χ1 ̸= χ2.
If a, b ∈G, then

χ∈ 
G
χ(a)χ(b) =

n
if a = b,
0
if a ̸= b.

4.2 Characters of Finite Abelian Groups
131
Proof. These identities follow immediately from Theorem 4.6, since
χ1(a)χ2(a) = χ1χ−1
2 (a)
and
χ(a)χ(b) = χ(a −b).
This completes the proof. 2
The character table for a group has one column for each element of the
group and one row for each character of the group. For example, if C4 is
the cyclic group of order 4 with generator g0, then the characters of C4 are
the functions
ψa(jg0) = e4(aj) = iaj
for a = 0, 1, 2, 3, and the character table is the following.
0
g0
2g0
3g0
ψ0
1
1
1
1
ψ1
1
i
−1
−i
ψ2
1
−1
1
−1
ψ3
1
−i
−1
i
Note the that sum of the numbers in the ﬁrst row is equal to the order
of the group, and the sum of the numbers in each of the other rows is 0.
Similarly, the sum of the numbers in the ﬁrst column is the order of the
group, and the sum of the numbers in each of the other columns is 0. This
is a special case of the orthogonality relations.
Exercises
1. Let C2 be the cyclic group of order 2.
(a) Compute the character table for C2.
(b) Compute the character table for the group C2 × C2.
2. Compute the character table for the cyclic group of order 6.
3. Let G be a ﬁnite cyclic group of order n. Deﬁne the characters ψa on
G by (4.1). Prove that
(a) ψaψb = ψa+b,

132
4. Fourier Analysis on Finite Abelian Groups
(b) ψ−1
a
= ψ−a,
(c) ψa = ψb if and only if a ≡b
(mod n).
4. Prove that if G is cyclic and g ∈G, g ̸= 0, then ψ1(g) ̸= 1.
5. Prove that the map Ψ deﬁned by 4.3 is a one-to-one homomorphism.
6. Consider the map ⟨
,
⟩: G ×  G →C× deﬁned by
⟨g, χ⟩= χ(g).
Prove that
⟨g + g′, χ⟩= ⟨g, χ⟩⟨g′, χ⟩
and
⟨g, χχ′⟩= ⟨g, χ⟩⟨g, χ′⟩
for all g′g′ ∈G and χ, χ′ ∈ G.
7. Let G = Z/mZ × Z/mZ. For integers a and b, we deﬁne the function
ψa,b on G by
ψa,b(x + mZ, y + mZ) = e2πi(ax+by)/m = em(ax + by).
(a) Prove that ψa,b is well-deﬁned.
(b) Prove that ψa,b = ψc,d if and only if a ≡c
(mod m) and b ≡d
(mod m).
(c) Prove that ψa,b is a character of the group G.
(d) Prove that  G = {ψa,b : a, b = 0, 1, . . . , m −1}.
8. Let p be a prime number, and let G = (Z/pZ)× be the multiplicative
group of units in the ﬁeld Z/pZ. Let g be a primitive root modulo p.
For every integer a, deﬁne the function χa : G →C× as follows: If
(x, p) = 1 and x ≡gy
(mod p), then
χa(x + pZ) = e2πay/(p−1) = ep−1(ay).
(a) Prove that χa is a character, that is, χa ∈ G.
(b) Prove that χa = χb if and only if a ≡b
(mod p −1).
(c) Prove that  G = {χa : a = 0, 1, . . . , p −2}.
9. Let G be a ﬁnite abelian group. For every integer r, let
Gr = {rg : g ∈G}
and
 Gr = {χ ∈ G : χr = χ0}.
(a) Prove that Gr is a subgroup of G and  Gr is a subgroup of  G.

4.3 Elementary Fourier Analysis
133
(b) Let d = (r, n). Prove that Gr = Gd and  Gr =  Gd.
(c) Let χ ∈ G. Prove that χ ∈ Gr if and only if χ(a) = 1 for all
a ∈Gr.
(d) Let χ ∈ Gr. Deﬁne the function χr on the quotient group G/Gr
by
χr(a + Gr) = χ(a).
Prove that χr is well-deﬁned. Prove that χr ∈
"
G/Gr and that
the map from  Gr to
"
G/Gr deﬁned by χ →χr is a group isomor-
phism.
10. Let G be a ﬁnite abelian group and Gr = {rg : g ∈G}. Let [G : Gr]
be the index of the subgroup Gr in G. Prove that

χ∈ 
Gr
χ(a) =

[G : Gr]
if a ∈Gr
0
if a ̸∈Gr.
Hint: Consider the quotient group G/Gr, and note that
!
Gr
 =
 "
G/Gr
 = [G : Gr].
4.3
Elementary Fourier Analysis
Let G be a ﬁnite abelian group of order n, and let L2(G) denote the n-
dimensional vector space of complex-valued functions f on G. The complex
conjugate of f ∈L2(G) is the function f ∈L2(G) deﬁned by
f(x) = f(x)
for all x ∈G.
For a ∈G, we deﬁne the function δa ∈L2(G) by
δa(x) =

1
if x = a,
0
if x ̸= a.
If f ∈L2(G), then
f =

a∈G
f(a)δa,
and the set of n functions {δa : a ∈G} is a basis for the vector space L2(G).
We deﬁne a function µ on the subsets of G by
µ(U) = |U|
for all U ⊆G. Then µ(G) = n, and µ is additive in the sense that, if U1 and
U2 are disjoint subsets of G, then µ(U1∪U2) = µ(U1)+µ(U2). The function

134
4. Fourier Analysis on Finite Abelian Groups
µ is also translation invariant, since µ(a + U) = µ(U) for all U ⊆G and
a ∈G. We call µ a Haar measure on the group G.1
Using the measure µ, we deﬁne the integral of f ∈L2(G) as
#
G
f =
#
G
f(x)dx =

x∈G
f(x).
We deﬁne an inner product on the space L2(G) by
(f1, f2) =
#
G
f1f2 =

x∈G
f1(x)f2(x).
Then
(δa, δb) =

x∈G
δa(x)δb(x) =

1
if a = b,
0
if a ̸= b,
and so the set of functions {δa : a ∈G} is an orthonormal basis for L2(G).
Moreover, for all f ∈L2(G) and a ∈G, we have
(f, δa) =

x ∈Gf(x)δa(x) = f(a).
The L2-norm of a function f ∈L2(G) deﬁned by
∥f∥2 = (f, f)1/2 =

x∈G
|f(x)|2
1/2
.
The Cauchy-Schwarz inequality states that
|(f1, f2)| ≤∥f1∥2∥f2∥2
(4.5)
for all functions f1, f2 ∈L2(G) (Exercise 5).
A character is a complex-valued function on G, and so  G ⊆L2(G). We
shall show that  G is also a basis for L2(G).
If χ1, χ2 are characters of G, then the orthogonality relations (Theo-
rem 4.7) imply that
(χ1, χ2)
=
#
G
χ1χ2
=

a∈G
χ1(a)χ2(a)
=

n
if χ1 = χ2
0
if χ1 ̸= χ2,
1We can also deﬁne a measure µ on G by µ(U) = |U|/n. This has the advantage that
µ(G) = 1, but it is not the traditional choice in elementary number theory.

4.3 Elementary Fourier Analysis
135
and so the n characters in the dual group  G are orthogonal in the vector
space L2(G). Since |  G| = |G| = dimC L2(G) = n, it follows that  G is a
basis for L2(G).
There are an analogous Haar measure and inner product on the dual
group  G. If  f,  f2 ∈L2(  G), then
(  f1,  f2) =
#
 
G
 f1  f2 =

χ∈ 
G
 f1(χ)  f2(χ).
Let   G denote the double dual of G, that is, the group of characters of the
dual group  G. For a ∈G, we deﬁned ∆(a) ∈  G by
∆(a)(χ) = χ(a),
and we proved that every character in   G is of the form ∆(a) for some a ∈G.
By the orthogonality relations (Theorem 4.7), for every a, b ∈G we have
(∆(a), ∆(b)) 
G
=

χ∈ 
G
∆(a)(χ)∆(b)(χ)
=

χ∈ 
G
χ(a)χ(b)
=

n
if a = b
0
if a ̸= b.
The Fourier transform is a linear transformation from L2(G) to L2(  G)
that sends the function f ∈L2(G) to the function  f ∈L2(  G), where
 f(χ) = (f, χ) =

g∈G
f(g)χ(g).
(4.6)
For example, the Fourier transform of the function δa ∈L2(G) is
 δa(χ) =

g∈G
δa(g)χ(g) = χ(a) = χ(−a).
The process of recovering f from its Fourier transform  f is called Fourier
inversion.
Theorem 4.8 (Fourier inversion) Let G be a ﬁnite abelian group of or-
der n with dual group  G. If f ∈L2(G), then
f = 1
n

χ∈ 
G
 f(χ)χ,
(4.7)

136
4. Fourier Analysis on Finite Abelian Groups
and (4.7) is the unique representation of f as a linear combination of char-
acters of G.
Let ∆: G →  G be the isomorphism deﬁned by ∆(a)(χ) = χ(a) for all
χ ∈ G. If f ∈L2(G), then   f ∈L2

  G

, and, for every a ∈G,
  f(∆(a)) = nf(−a).
(4.8)
Proof. This is a straightforward calculation. Let a ∈G. Deﬁning the
Fourier transform by (4.6), we have
1
n

χ∈ 
G
 f(χ)χ(a)
=
1
n

χ∈ 
G

b∈G
f(b)χ(b)

χ(a)
=

b∈G
f(b)

1
n

χ∈ 
G
χ(a)χ(b)


=
f(a),
by the orthogonality relations (Theorem 4.7). This proves (4.7). The unique-
ness of the series (4.7) is Exercise 2.
To prove (4.8), we have
  f(∆(a))
=

χ∈ 
G
 f(χ)∆(a)(χ)
=

χ∈ 
G

g∈G
f(g)χ(g)χ(a)
=

g∈G
f(g)

χ∈ 
G
χ(g + a)
=
nf(−a).
This completes the proof. 2
The sum (4.7) is called the Fourier series for the function f.
Theorem 4.9 (Plancherel’s formula) If G is a ﬁnite abelian group of
order n and f ∈L2(G), then
∥ f∥2 = √n∥f∥2.
Proof. We have
∥ f∥2
2
=
(  f,  f)

4.3 Elementary Fourier Analysis
137
=

χ∈ 
G
 f(χ)  f(χ)
=

χ∈ 
G

b∈G
f(b)χ(b)
 
a∈G
f(a)χ(a)

=

a∈G

b∈G
f(a)f(b)


χ∈ 
G
χ(a)χ(b)


=
n

a∈G
|f(a)|2
=
n∥f∥2
2.
This completes the proof. 2
Let G be a ﬁnite abelian group of order |G| = n, and let f ∈L2(G). The
support of f is the set
supp(f) = {a ∈G : f(a) ̸= 0}.
We deﬁne the L∞-norm of a function f ∈L2(G) by
∥f∥∞= max{|f(a)| : a ∈G}.
For every function f ∈L2(G) we have the elementary inequality
∥f∥2
2 = (f, f) =

a∈G
|f(a)|2 ≤∥f∥2
∞|supp(f)|.
(4.9)
The uncertainty principle in Fourier analysis states that if f ∈L2(G) is
a function with Fourier transform  f ∈L2(  G), then the sets supp(f) and
supp(  f) cannot be simultaneously small. This has the following quantitative
formulation.
Theorem 4.10 (Uncertainty principle) If G is a ﬁnite abelian group
and f ∈L2(G), f ̸= 0, then
|supp(f)||supp(  f)| ≥|G|.
Proof. Let a ∈G. By Theorem 4.8,
f(a) = 1
n

χ∈ 
G
 f(χ)χ(a).
Since |χ(a)| = 1 for all χ ∈ G, it follows that
|f(a)| ≤1
n

χ∈ 
G
|  f(χ)| = 1
n

χ∈supp( 
f)
|  f(χ)|

138
4. Fourier Analysis on Finite Abelian Groups
and so
∥f∥∞≤1
n

χ∈supp( 
f)
|  f(χ)|.
Applying the Cauchy-Schwarz inequality (4.5) with f1 =  f(χ) and with f2
the characteristic function of the set supp

 f

, we have




χ∈supp( 
f)
|  f(χ)|



2
=

χ∈supp( 
f)
|  f(χ)|2|supp(  f)|.
Using Plancherel’s formula (Theorem 4.9), and inequality (4.9), we obtain
∥f∥2
∞
≤
1
n2




χ∈supp( 
f)
|  f(χ)|



2
≤
1
n2

χ∈supp( 
f)
|  f(χ)|2|supp(  f)|
=
1
n2 ∥ f∥2
2|supp(  f)|
=
1
n∥f∥2
2|supp(  f)|
≤
1
n∥f∥2
∞|supp(f)||supp(  f)|.
Since f ̸= 0, we have ∥f∥∞> 0 and so
|supp(f)||supp(  f)| ≥n = |G|.
This completes the proof. 2
If f ∈L2(G) and |supp(f)| = 1, then the uncertainty principle implies
that |supp(  f)| = |G|, that is,  f(χ) ̸= 0 for all χ ∈ G. Here is an example.
Let a ∈G and f = δa ∈L2(G). Then δa(x) ̸= 0 if and only if x = a, and so
|supp(δa)| = 1. We have  δa(χ) = χ(a) ̸= 0 for all χ ∈ G. This shows that
the lower bound in the uncertainty principle is best possible.
Exercises
In these exercises, G is a ﬁnite abelian group.
1. Let f, g ∈L2(G). Prove that
(g, f) = (f, g).

4.3 Elementary Fourier Analysis
139
2. Let f ∈L2(G). Prove that if c ∈L2(  G) and f = (1/n) 
χ∈ 
G c(χ)χ,
then c(χ) =  f(χ).
3. Prove that the Haar measure on G is unique, that is, there exists
a unique function µ on the subsets of G such that µ is additive,
translation invariant, and µ(G) = n.
4. Let U : L2(G) →L2(  G) be a linear transformation such that U(δa)(χ) =
χ(a) for all χ ∈ G. Prove that U is the Fourier transform, that is,
U(f) =  f for all f ∈L2(G).
5. (Cauchy-Schwarz inequality) Let f, g ∈L2G. Prove that
|(f, g)| ≤∥f∥2∥g∥2.
Hint: If λ ∈C, then ∥f −λg∥2
2 ≥0. For g ̸= 0, apply this inequality
with λ = (f, g)/(g, g).
6. Prove that if f, g ∈L2(G), then
∥f + g∥2 ≤∥f∥2 + ∥g∥2.
7. Let χ1, χ2 ∈ G. Prove that
!
χ1(χ2) =

n
if χ1 = χ2
0
if χ1 ̸= χ2.
8. Use the uncertainty principle to prove that the Fourier transform is
one-to-one.
Hint: Prove that if f ∈L2(G) and f ̸= 0, then  f ̸= 0.
9. For a ∈G and f ∈L2(G), we deﬁne the translation operator Ta on
L2(G) by Ta(f)(x) = f(x −a). Prove that
"
Ta(f) = χ(a)  f.
10. For functions f1, f2 ∈L2(G), we deﬁne the convolution f1∗f2 ∈L2(G)
by
f1 ∗f2(a) =
#
G
f1(a −x)f2(x)dx =

a∈G
f1(a −x)f2(x).
(a) Prove that
f1 ∗f2(a) =

x+y=a
f1(x)f2(y).
(b) Prove that convolution is commutative, that is,
f1 ∗f2 = f2 ∗f1.

140
4. Fourier Analysis on Finite Abelian Groups
(c) Prove that convolution is associative, that is,
(f1 ∗f2) ∗f3 = f1 ∗(f2 ∗f3).
(d) Prove that, if f1, . . . , fk ∈L2(G), then
f1 ∗· · · ∗fk(a) =

x1+···+xk=a
f1(x1) · · · fk(xk).
11. Let χ ∈ G. Prove that
χ ∗· · · ∗χ
&
'(
)
k times
(a) =

x1+x2+···+xk=a
χ(x1 + x2 + · · · + xk).
12. Let p be a prime number, and deﬁne ℓp ∈L2(Z/pZ) by
ℓp(a + pZ) =
a
p

,
where

·
p

is the Legendre symbol. Prove that
ℓp ∗· · · ∗ℓp
&
'(
)
k times
(a + pZ) =

x1+x2+···+xk=a
1≤xi≤p−1
x1x2 · · · xk
p

.
13. Let f1, f2, . . . , fk ∈L2(G). Prove that a product of Fourier transforms
is the convolution of the product in the sense that
 f1 ·  f2 =
"
f1 ∗f2
and
 f1 ·  f2 · · ·  fk =
"
f1 ∗f2 ∗· · · ∗fk.
14. Prove that δa ∗f = Ta(f) for all f ∈L2(G). Use this to give another
proof of Exercise 9.
4.4
Poisson Summation
Let G be a ﬁnite abelian group with subgroup H, and let L2(G)H be the
vector space of complex-valued functions on G that are constant on cosets
in G/H, that is,
L2(G)H = {f ∈L2(G) : f(x + h) = f(x) for all x ∈G and h ∈H}.
Let  GH be the group of characters of G that are trivial on H, that is,
 GH = {χ ∈ G : χ(h) = 1 for all h ∈H}.

4.4 Poisson Summation
141
Lemma 4.4 Let G be a ﬁnite abelian group with subgroup H. Then
 GH =  G ∩L2(G)H.
Proof. If χ ∈ GH ⊆ G, then χ(x + h) = χ(x)χ(h) = χ(x) for all x ∈G
and h ∈H, and so χ ∈ G ∩L2(G/H). Conversely, if χ ∈ G ∩L2(G/H),
then χ(h) = χ(0 + h) = χ(0) = 1 for all h ∈H, and χ ∈ GH. 2
Lemma 4.5 Let G be a ﬁnite abelian group with subgroup H, and let π :
G →G/H be the natural map onto the quotient group. For f ♯∈L2(G/H),
deﬁne the map π♯(f ♯) ∈L2(G) by
π♯(f ♯)(x) = f ♯π(x) = f ♯(x + H)
for all x ∈G. Then π♯is a vector space isomorphism from L2(G/H) onto
L2(G)H. Moreover,
π♯ "
G/H

⊆ GH,
and the map
π♯: "
G/H → GH
is a group isomorphism.
Proof. Let f ♯∈L2(G/H). If x ∈G and h ∈H, then
π♯(f ♯)(x + h) = f ♯π(x + h) = f ♯π(x) = π♯(f ♯)(x),
and so π♯maps L2(G/H) into L2(G)H. It is easy to check that π♯is linear.
Moreover, π♯is onto, since if f ∈L2(G)H, then there is a well-deﬁned map
f ♯∈L2(G/H) given by f ♯(x + H) = f(x), and π♯(f ♯)(x) = f ♯(x + H) =
f(x) for all x ∈G. Finally, π♯is one-to-one since π♯(f ♯)(x) = 0 for all
x ∈G if and only if f ♯(x + H) = 0 for all x + H ∈G/H, that is, if and
only if f ♯= 0. This proves that π♯is an isomorphism.
If χ♯∈"
G/H, then
π♯(χ♯)(x + y)
=
χ♯(π(x + y))
=
χ♯(x + y + H)
=
χ♯(x + H)χ♯(y + H)
=
π♯(χ♯)(x)π♯(χ♯)(y),
and so
π♯(χ♯) ∈ G ∩L2(G)H =  GH.
It is left as an exercise to prove that π♯: "
G/H → GH is a group isomor-
phism (Exercise 2). 2

142
4. Fourier Analysis on Finite Abelian Groups
Theorem 4.11 (Poisson summation formula) Let G be a ﬁnite abelian
group and H a subgroup of G. If f ∈L2(G), then
1
|H|

y∈H
f(y) =
1
|G|

χ∈ 
GH
 f(χ).
Proof. Let f ∈L2(G) and χ ∈ GH. We deﬁne the function f ♯∈
L2(G/H) by
f ♯(x + H) =

y∈H
f(x + y).
We deﬁne the character χ♯∈"
G/H by χ♯(x+H) = χ(x). If π♯: "
G/H → GH
is the isomorphism constructed in Lemma 4.5, then π♯(χ♯) = χ, and the
Fourier transform of f ♯is
 f ♯(χ♯)
=

x+H∈G/H
f ♯(x + H)χ♯(x + H)
=

x+H∈G/H

y∈H
f(x + y)χ(x)
=

x+H∈G/H

y∈H
f(x + y)χ(x + y)
=

x∈G
f(x)χ(x)
=
 f(χ).
It follows that the Fourier series for f ♯is
f ♯(x + H)
=
1
|G/H|

χ♯∈"
G/H
 f ♯(χ♯)χ♯(x + H)
=
|H|
|G|

χ∈ 
GH
 f(χ)χ(x).
Equivalently, for x ∈G,
1
|H|

y∈H
f(x + y) =
1
|G|

χ∈ 
GH
 f(χ)χ(x).
This is the Poisson summation formula. 2

4.4 Poisson Summation
143
Exercises
In these exercises, G is a ﬁnite abelian group and H is a subgroup of G.
1. Let  GH denote the set of all characters χ of G such that χ(h) = 1 for
all h ∈H. Prove that  GH is a subgroup of  G.
2. Let π♯: "
G/H → GH be the map constructed in Lemma 4.5. Prove
that π♯is a group homomorphism. Deﬁne λ :  GH →"
G/H by λ(χ)(x+
H) = χ(x). Prove that λ is a well-deﬁned group homomorphism, and
that λ−1 = π♯.
3. Prove that G contains a subgroup isomorphic to G/H.
Hint:
G/H ∼= "
G/H ∼=  GH ⊆ G ∼= G.
4. To each character χ ∈ G there is a corresponding character χ′ ∈ H
deﬁned by restriction:
χ′(h) = χ(h)
for h ∈H.
Prove that this deﬁnes a homomorphism ρ :  G → H with kernel  GH.
This induces a one-to-one homomorphism of ˜ρ :  G/  GH → H. Prove
that ˜ρ is surjective, and so
 G/  GH ∼=  H.
Hint: These two groups have the same cardinality.
5. Let f ∈L2(G), and deﬁne f ♯∈L2(G) by
f ♯(x) =

h∈H
f(x + h).
Prove that f ♯∈L2(G)H and
#
G
f =
1
|H|
#
G
f ♯.
6. Let G1 and G2 be ﬁnite abelian groups. Let f ∈L2(G1 × G2). For
x1 ∈G1, deﬁne the function fx1 ∈L2(G2) by fx1(x2) = f(x1, x2).
Show that Poisson summation applied to the group G = G1 ×G2 and
subgroup H = G1 × {0} gives

x1∈G1
fx1(0) =
1
|G2|

x1∈G1

χ2∈!
G2
!
fx1(χ2).

144
4. Fourier Analysis on Finite Abelian Groups
7. Let f ∈L2(G × G). Use Poisson summation to prove that

x∈G
f(x, x) =
1
|G|

χ∈ 
G

(x,y)∈G×G
f(x, y)χ(x)χ(y).
Note that this identity is also an immediate consequence of the or-
thogonality relations.
8. This is another example that shows that the lower bound in the uncer-
tainty principle (Theorem 4.10) is best possible. Let H be a subgroup
of G, and deﬁne δH ∈L2(G) by
δH(x) =

1
if x ∈H
0
if x ̸∈H.
(a) Prove that
supp(δH) = H.
(b) Prove that if χ ∈ G, then
!
δH(χ) =
*
|H|
if χ ∈ GH
0
if χ ̸∈ GH.
(c) Prove that
supp(δH)supp

!
δH

= |G|.
4.5
Trace Formulae on Finite Abelian Groups
We recall some facts from linear algebra. Let A = (aij) be an n×n matrix.
The trace of A is the sum of the diagonal elements of A, that is,
tr(A) =
n

i=1
aii.
Let B = (bij) be another n × n matrix. The simplest trace formula (Exer-
cise 1) states that
tr(AB) = tr(BA).
(4.10)
Every result in this section follows from this fundamental identity.
Let V be an n-dimensional vector space, and let B = {v1, . . . , vn} be a
basis for V . If T : V →V is a linear operator, and
T(vj) =
n

i=1
aijvi,

4.5 Trace Formulae on Finite Abelian Groups
145
then the n×n matrix A = (aij) = [T]B is called the matrix of the operator
T with respect to the basis B.
Let B′ = {v′
1, . . . , v′
n} be another basis for V , and let
T(v′
j) =
n

i=1
a′
ijv′
i.
(4.11)
Then A′ = (a′
ij) = [T]B′ is the matrix of T with respect to the basis B.
Each vector v′
j ∈B′ is a linear combination of the vectors in the basis B,
v′
j =
n

i=1
rijvi,
(4.12)
and each vector vj ∈B is a linear combination of the vectors in the basis
B′,
vj =
n

i=1
sijv′
i.
(4.13)
Consider the n × n matrices R = (rij) and S = (sij). Then S = R−1
(Exercise 2). We have
T(v′
j)
=
T
 n

ℓ=1
rℓjvℓ

=
n

ℓ=1
rℓjT(vℓ)
=
n

ℓ=1
rℓj
n

k=1
akℓvk
=
n

ℓ=1
rℓj
n

k=1
akℓ
n

i=1
sikv′
i
=
n

i=1
 n

k=1
n

ℓ=1
sikakℓrℓj

v′
i.
Comparing this with (4.11), we obtain
a′
ij =
n

k=1
n

ℓ=1
sikakℓrℓj
for all i, j = 1, . . . , n, and so
A′ = SAR = R−1AR.
Identity (4.10) implies that
tr(A′) = tr(R−1AR) = tr(ARR−1) = tr(A).

146
4. Fourier Analysis on Finite Abelian Groups
It follows that we can deﬁne the trace of a linear operator T on a vector
space V as the trace of the matrix of T with respect to some basis for V ,
and that this deﬁnition does not depend on the choice of basis.
The vector v′ ∈V is called an eigenvector for the operator T with eigen-
value λ if v′ ̸= 0 and T(v′) = λv′. The operator T is diagonalizable if there
exists a basis for V consisting of eigenvectors, that is, there exist nonzero
vectors v′
1, . . . , v′
n ∈V and numbers λ1, . . . , λn such that B′ = {v′
1, . . . , v′
n}
is a basis for V and T(v′
i) = λiv′
i for i = 1, . . . , n. In this case, the matrix
for T with respect to the basis B′ is the diagonal matrix
D =







λ1
0
0
· · ·
0
0
0
λ2
0
· · ·
0
0
0
0
λ3
· · ·
0
0
...
...
0
0
0
0
0
λn







,
and so
n

i=1
aii = tr(A) = tr(D) =
n

i=1
λi.
We restate this important identity as a theorem.
Theorem 4.12 (Elementary trace formula) Let T be a linear opera-
tor on an n-dimensional vector space V , let B be a basis for V , and let
A = (aij) be the matrix of T with respect to B. If T is diagonalizable,
then V has a basis B = {v′
1, . . . , v′
n} of eigenvectors with T(vi) = λivi for
i = 1, . . . , n, and the trace of A is equal to the sum of the eigenvalues of T,
that is,
n

i=1
aii =
n

i=1
λi.
We shall show that both the Fourier inversion theorem and the Poisson
summation formula are consequences of this elementary trace formula.
Let G be a ﬁnite abelian group of order n, and let L2(G) be the n-
dimensional vector space of complex-valued functions on G. For every a ∈G
there is a linear operator Ta on L2(G) deﬁned by Ta(f)(x) = f(x−a). The
operator Ta is called translation by a.
Another class of operators on L2(G) are integral operators. A function
K ∈L2(G × G) induces a linear operator ΦK on the vector space L2(G)
as follows: For f ∈L2(G), let
ΦK(f)(x) =
#
G
K(x, y)f(y)dy =

y∈G
K(x, y)f(y).
The map ΦK is called an integral operator on L2(G) with kernel K(x, y).

4.5 Trace Formulae on Finite Abelian Groups
147
Let G = {x1, . . . , xn}. Associated to the kernel K is a matrix A = (aij) ∈
Mn(C) deﬁned by
aij = K(xi, xj).
(4.14)
Conversely, to every matrix A = (aij) ∈Mn(C) there is a function K(x, y) ∈
L2(G × G) deﬁned by (4.14), and an associated integral operator ΦK.
Theorem 4.13 Let G = {x1, . . . , xn} be an abelian group of order n. Let
K ∈L2(G × G) and let ΦK be the associated integral operator on L2(G).
The matrix of ΦK with respect to the orthonormal basis {δxi : i = 1, . . . , n}
is (K(xi, xj)), and the trace of ΦK is
tr(ΦK) =
n

i=1
K(xi, xi).
(4.15)
Proof. The matrix of the operator ΦK is (cij), where cij is deﬁned by
ΦK(δxj) =
n

i=1
cijδxi.
Then
cij = ΦK(δxj)(xi) =

y∈G
K(xi, y)δxj(y) = K(xi, xj).
This completes the proof. 2
Theorem 4.14 Let G be a ﬁnite abelian group. Let K ∈L2(G × G) with
ΦK the associated integral operator on L2(G). The operator ΦK commutes
with all translations Ta, that is,
TaΦK(f) = ΦKTa(f)
for all a ∈G and f ∈L2(G), if and only if there exists a function h ∈L2(G)
such that K(x, y) = h(x−y) for all x, y ∈G. In this case, ΦK is convolution
by h, that is,
ΦK(f)(x) = h ∗f(x) =
#
G
h(x −y)f(y)dy,
and the trace of ΦK is
tr(ΦK) = nh(0).
Proof. Let f, h ∈L2(G). We deﬁne the convolution operator Ch on
L2(G) by
Ch(f)(x) = h ∗f(x) =
#
G
h(x −y)f(y)dy =

y∈G
h(x −y)f(y).

148
4. Fourier Analysis on Finite Abelian Groups
(See Exercise 10 in Section 4.3.) Deﬁne K(x, y) ∈L2(G × G) by K(x, y) =
h(x −y). Then
ΦK(f)(x) =
#
G
K(x, y)f(y)dy =
#
G
h(x −y)f(y)dy = Ch(f)(x),
and ΦK is convolution by h. For a, x ∈G, we have
TaCh(f)(x)
=
Ch(f)(x −a)
=

y∈G
h(x −a −y)f(y)
=

y∈G
h(x −y)f(y −a)
=

y∈G
h(x −y)Ta(f)(y)
=
ChTa(f)(x),
and so TaCh = ChTa, that is, convolution commutes with translations.
Conversely, let K(x, y) ∈L2(G × G). For a, x ∈G and f ∈L2(G), we
have
TaΦK(f)(x) = ΦK(f)(x −a) =

y∈G
K(x −a, y)f(y)
and
ΦKTa(f)(x)
=

y∈G
K(x, y)Ta(f)(y)
=

y∈G
K(x, y)f(y −a)
=

y∈G
K(x, a + y)f(y).
If ΦK commutes with translations, then TaΦK = ΦKTa, and

y∈G
K(x −a, y)f(y) =

y∈G
K(x, a + y)f(y).
Applying this identity to the function
f(x) = δ0(x) =

1
if x = 0
0
if x ̸= 0.
we obtain K(x −a, 0) = K(x, a) for all a, x ∈G. Deﬁne the function
h ∈L2(G) by
h(x) = K(x, 0).

4.5 Trace Formulae on Finite Abelian Groups
149
Then
K(x, y) = K(x −y, 0) = h(x −y)
for all x, y ∈G, and the operator ΦK is convolution by h(x). Moreover,
tr(ΦK) = nh(0) by (4.15). This completes the proof. 2
Theorem 4.15 (Trace formula) For h ∈L2(G), let Ch be the convolu-
tion operator on L2(G), that is, Ch(f) = h ∗f for f ∈L2(G). The dual
group  G is a basis of eigenvectors for Ch. If χ is a character in  G, then χ
has eigenvalue  h(χ), that is,
Ch(χ) =  h(χ)χ,
and
nh(0) =

χ∈ 
G
 h(χ).
Proof. This is a straightforward calculation. For x ∈G, we have
Ch(χ)(x)
=
h ∗χ(x) = χ ∗h(x)
=

y∈G
χ(x −y)h(y)
=


y∈G
h(y)χ(y)

χ(x)
=
 h(χ)χ(x),
and so χ is an eigenvector of the convolution Ch with eigenvalue  h(χ). By
Theorem 4.12, since  G is a basis for L2(G), the trace of Ch is the sum of
the eigenvalues, that is,
tr(Ch) =

χ∈ 
G
 h(χ).
By Theorem 4.14, we also have
tr(Ch) = nh(0).
This completes the proof. 2
We can immediately deduce the Fourier inversion formula (Theorem 4.8)
from Theorem 4.15. If f ∈L2(G), then
f(0) = 1
n

χ∈ 
G
 f(χ).
(4.16)

150
4. Fourier Analysis on Finite Abelian Groups
This trace formula can also be obtained by computing the Fourier series
for f at x = 0. On the other hand, if we simply apply (4.16) to the function
T−a(f) and use Exercise 9 in Section 4.3, then we obtain
f(a)
=
T−a(f)(0)
=
1
n

χ∈ 
G
"
T−a(f)(χ)
=
1
n

χ∈ 
G
 f(χ)χ(a).
This is the Fourier inversion formula.
Next, we derive the Poisson summation formula (Theorem 4.11) from
the elementary trace formula.
Let H be a subgroup of G, and let π : G →G/H be the natural map. For
x ∈G, deﬁne x♯= π(x) = x + H ∈G/H. There is an orthonormal basis
for the vector space L2(G/H) that consists of the functions δx♯, where
δx♯(y♯) =

1
if x♯= y♯
0
if x♯̸= y♯.
For f ∈L2(G), deﬁne the function f ♯∈L2(G/H) by
f ♯(x + H) =

y∈H
f(x + y).
Let Cf ♯be convolution by f ♯on L2(G/H). The operator Cf ♯has matrix

f ♯(x♯−y♯)

, with respect to the basis {δx♯}. By Theorem 4.14, the trace
of Cf ♯is
tr(Cf ♯) = |G/H|f ♯(0♯) = |G|
|H|

y∈H
f(y).
By Theorem 4.15, the character group "
G/H is a basis of eigenvectors for
the convolution operator Cy♯. If χ♯∈"
G/H and χ = π♯(χ♯) ∈ GH, then
Cf ♯(χ♯) =  f ♯(χ♯)χ♯,
with eigenvalue
 f ♯(χ♯)
=

x♯∈G/H
f ♯(x♯)χ♯(x♯)
=

x♯∈G/H

y∈H
f(x + y)χ(x)
=

x♯∈G/H

y∈H
f(x + y)χ(x + y)
=

x∈G
f(x)χ(x).

4.6 Gauss Sums and Quadratic Reciprocity
151
It follows that
tr(Cf ♯) =

χ♯∈"
G/H
 f ♯(χ♯) =

χ∈ 
GH

x∈G
f(x)χ(x), =

χ∈ 
GH
 f(χ),
and so
1
|H|

y∈H
f(y) =
1
|G|

χ∈ 
GH
 f(χ).
This is the Poisson summation formula.
Exercises
In these exercises, G is a ﬁnite abelian group of order n.
1. Let A = (aij) and B = (bij) be n × n matrices. Prove that tr(AB) =
tr(BA).
2. Deﬁne the matrices R and S by (4.12) and (4.13). Prove that S =
R−1.
3. Let G = {x1, . . . , xn}. To every matrix A = (aij) ∈Mn(C) we as-
sociate a function KA ∈L2(G × G) by KA(xi, xj) = aij. Prove that
the map A →KA is a vector space isomorphism of Mn(C) onto
L2(G × G).
4. For a ∈G and h ∈L2(G), we have operators Ta and Ch on L2(G),
where Ta is translation by a and Ch is convolution by h. Prove that
Ch(δa) = Ta(h).
4.6
Gauss Sums and Quadratic Reciprocity
Let m be a positive integer, and Z/mZ the ring of congruence classes
modulo m. An additive character modulo m is a character of the additive
group Z/mZ. Since this group is cyclic, the additive characters are the
functions ψa deﬁned by
ψa(k + mZ) = e2πiak/m = em(ak)
for a = 0, 1, . . . , m −1, and the map from Z/mZ to
"
Z/mZ that sends the
congruence class a + mZ to the character ψa is an isomorphism of additive
groups.
A multiplicative character modulo m is a character of the multiplicative
group of units (Z/mZ)×. The principal character χ0 is deﬁned by χ0(a +

152
4. Fourier Analysis on Finite Abelian Groups
mZ) = 1 if (a, m) = 1. If χ is a multiplicative character of Z/mZ, then we
extend χ to a function on Z/mZ by deﬁning χ(a + mZ) = 0 if (a, m) ̸= 1.
Then χ ∈L2(Z/mZ). The Fourier transform of χ is  χ ∈L2  "
Z/mZ

,
where
 χ(ψa)
=

k+mZ∈Z/mZ
χ(k + mZ)ψa(k + mZ)
=
m−1

k=1
(k,m)=1
χ(k + mZ)em(−ak).
For every integer a and multiplicative character χ, we deﬁne the Gauss sum
τ(χ, a) as the Fourier transform of χ evaluated at the additive character
ψ−a, that is,
τ(χ, a)
=
 χ(ψ−a) =
m−1

k=1
(k,m)=1
χ(k + mZ)em(ak)
(4.17)
=
m−1

k=0
χ(k + mZ)em(ak).
(4.18)
In this section we study multiplicative characters and Gauss sums only for
odd prime moduli p.
Theorem 4.16 Let χ be a nonprincipal multiplicative character modulo
the odd prime p. Then
τ(χ, a) = χ(a + pZ)τ(χ, 1).
Proof. If p divides a, then ep(ak) = 1 for all k, and
τ(χ, a) =
p−1

k=1
χ(k + pZ)ep(ak) =
p−1

k=1
χ(k + pZ) = 0
by the orthogonality relations (Theorem 4.6).
If p does not divide a, then |χ(a+pZ)| = 1, the set {ak : k = 1, . . . , p−1}
is a reduced set of residues modulo p, and
τ(χ, a)
=
p−1

k=1
χ(k + pZ)ep(ak)
=
p−1

k=1
χ(a + pZ)χ(a + pZ)χ(k + pZ)ep(ak)
=
χ(a + pZ)
p−1

k=1
χ(ak + pZ)ep(ak)

4.6 Gauss Sums and Quadratic Reciprocity
153
=
χ(a + pZ)
p−1

k=1
χ(k + pZ)ep(k)
=
χ(a + pZ)τ(χ, 1).
This completes the proof. 2
Let p be an odd prime number, and let

.
p

be the Legendre symbol
modulo p. We deﬁne the function ℓp ∈L2(Z/pZ) by
ℓp(a + pZ) =
a
p

=



1
if a is a quadratic residue modulo p,
−1
if a is a quadratic nonresidue modulo p,
0
if p divides a.
Then ℓp is a real-valued multiplicative character of Z/pZ, and
τ(ℓp, a) =  ℓp(ψ−a) =
p−1

k=1
k
p

ep(ak).
The classical Gauss sum is
τ(p) = τ(ℓp, 1).
By Theorem 4.16,
τ(ℓp, a) =
a
p

τ(p).
(4.19)
For example,
τ(3)
=
τ(ℓ3, 1) =
1
3

e3(1) +
2
3

e3(2)
=
e3(1) −e3(2) =

−1 + i
√
3
2

−

−1 −i
√
3
2

=
i
√
3
and
τ(ℓ3, 2) =
2
3

τ(3) = −i
√
3.
Theorem 4.17 If p is an odd prime and (a, p) = 1, then
τ(ℓp, a) =
p−1

x=0
ep(ax2).
In particular,
τ(p) =
p−1

x=0
e2πix2/p.

154
4. Fourier Analysis on Finite Abelian Groups
Proof. The set R = {k ∈{1, . . . , p −1} : ℓp(k + pZ) = 1} is a set of
representatives of the congruence classes of quadratic residues modulo p,
and N = {k ∈{1, . . . , p−1} : ℓp(k+pZ) = −1} is a set of representatives of
the congruence classes of quadratic nonresidues modulo p. We have |R| =
|N| = (p −1)/2. If x2 ≡k
(mod p), then also (p −x)2 ≡k
(mod p). Let
x ̸≡0
(mod p). Since p is odd, x ̸≡p −x
(mod p), and
p−1

x=1
ep(ax2) = 2

k∈R
ep(ak).
It follows that
τ(ℓp, a)
=
p−1

k=1
k
p

ep(ak)
=

k∈R
ep(ak) −

k∈N
ep(ak)
=
2

k∈R
ep(ak) −

k∈R∪N
ep(ak)
=
1 + 2

k∈R
ep(ak) −
p−1

k=0
ep(ak)
=
1 +
p−1

x=1
ep(ax2)
=
p−1

x=0
ep(ax2).
This completes the proof. 2
Theorem 4.18 If p is prime and (a, p) = 1, then
τ(ℓp, a)2 =
−1
p

p = (−1)
p−1
2 p.
Proof. If p does not divide a, then
τ(ℓp, a)2
=
p−1

x=1
x
p

ep(ax)
p−1

y=1
y
p

ep(ay)
=
p−1

x=1
p−1

y=1
xy
p

ep(a(x + y)).

4.6 Gauss Sums and Quadratic Reciprocity
155
Let (x, p) = 1. Then {x, 2x, . . . , (p−1)x} is a reduced set of residues modulo
p,

x2
p

= 1, and
p−1

y=1
xy
p

ep(−a(x + y))
=
p−1

y=1
x(xy)
p

ep(−a(x + xy))
=
p−1

y=1
x2y
p

ep(−ax(1 + y))
=
p−1

y=1
x2
p
 y
p

ep(−ax(1 + y))
=
p−1

y=1
y
p

ep(−ax(1 + y)).
Since
p−1

x=1
ep(−ax(1 + y)) =

p −1
if y ≡p −1
(mod p),
−1
if y ̸≡p −1
(mod p),
it follows that
τ(ℓp, a)2
=
p−1

x=1
p−1

y=1
xy
p

ep(a(x + y))
=
p−1

y=1
y
p
 p−1

x=1
ep(−ax(1 + y))
=
−1
p

(p −1) −
p−2

y=1
y
p

=
−1
p

p −
p−1

y=1
y
p

=
−1
p

p
=
(−1)
p−1
2 p,
by Theorem 3.14. 2
Theorem 4.19 Let p and q be distinct odd prime numbers. If (a, p) = 1,
then
τ(ℓp, a)q−1 ≡(−1)
p−1
2
q−1
2
p
q

(mod q).

156
4. Fourier Analysis on Finite Abelian Groups
Proof. By Theorem 4.18 and Theorem 3.12,
τ(ℓp, a)q−1
=

τ(ℓp, a)2 q−1
2
=

(−1)
p−1
2 p
 q−1
2
=
(−1)
p−1
2
q−1
2 p
q−1
2
≡
(−1)
p−1
2
q−1
2
p
q

(mod q).
This completes the proof. 2
Recall that if G is a ﬁnite abelian group, then the map ∆: G →  G
deﬁned by
∆(a)(χ) = χ(a)
is an isomorphism.
Theorem 4.20 If p and q are distinct odd primes, then
"

 ℓp
q
(∆(−q + pZ)) = pτ(p)q−1
q
p

.
Proof. The function on the left side of the equation is a bit complicated.
Let G = Z/pZ. Since ℓp ∈L2(G), it follows that the Fourier transform
 ℓp ∈L2(  G), and also its qth power  ℓp
q ∈L2 
 G

. The Fourier transform
of this function is !
 ℓp
q ∈L2

  G

, and so its domain is   G = {∆(a + pZ) :
a + pZ ∈G}. We have
"

 ℓp
q
(∆(−q + pZ))
=
p−1

x=0
 ℓp
q(ψx)∆(−q + pZ)(ψx)
=
p−1

x=0

 ℓp(ψx)
q
∆(−q + pZ)(ψx)
=
p−1

x=0
τ(ℓp, −x)qψx(−q + pZ)
=
p−1

x=1
−x
p

τ(p)
q
ψx(q + pZ)
=
τ(p)q
p−1

x=1
−x
p

ep(qx)

4.6 Gauss Sums and Quadratic Reciprocity
157
=
−q
p

τ(p)q
p−1

x=1
qx
p

ep(qx)
=
−q
p

τ(p)q
p−1

x=1
x
p

ep(x)
=
−q
p

τ(p)q+1
=
−q
p
 −1
p

pτ(p)q−1
=
pτ(p)q−1
q
p

,
by Theorem 4.18. This completes the proof. 2
Theorem 4.21 If p and q are distinct odd primes, then
"

 ℓp
q
(∆(−q + pZ)) = p

x1+...+xq≡q
(mod p)
1≤xi≤p−1
x1 · · · xq
p

.
Proof. Let k be a positive integer. By Exercise 10 in Section 4.3, a
product of Fourier transforms is the Fourier transform of the convolution,
and so
 ℓp
k =  ℓp ∗· · · ∗ ℓp
&
'(
)
k times
=
"
ℓp ∗· · · ∗ℓp
&
'(
)
k times
.
By (4.8) of Theorem 4.8, for every integer a we have
"

 ℓp
k
(∆(−a + pZ))
=
"
"
ℓp ∗· · · ∗ℓp
&
'(
)
k times
(∆(−a + pZ))
=
p ℓp ∗· · · ∗ℓp
&
'(
)
k times
(a + pZ).
By Exercise 12 in Section 4.3,
ℓp ∗· · · ∗ℓp
&
'(
)
k times
(a + pZ) =

x1+···+xk≡a
(mod p)
1≤xi≤p−1
x1 · · · xk
p

.
If k = a = q, then
"

 ℓp
q
(∆(−q + pZ)) = p

x1+···+xq≡q
(mod p)
1≤xi≤p−1
x1 · · · xq
p

.

158
4. Fourier Analysis on Finite Abelian Groups
This completes the proof. 2
We can now give a second proof of the quadratic reciprocity law. Let p
and q be distinct odd primes. By Theorem 4.20 and Theorem 4.21,
pτ(p)q−1
q
p

= p

x1+...+xq≡q
(mod p)
1≤xi≤p−1
x1 · · · xq
p

.
By Exercise 14 in Section 3.4,

x1+···+xq≡q
(mod p)
1≤xi≤p−1
x1 · · · xq
p

≡1
(mod q),
and so
τ(p)q−1
q
p

≡1
(mod q).
By Theorem 4.19,
τ(p)q−1 ≡(−1)
p−1
2
q−1
2
p
q

(mod q),
and so
(−1)
p−1
2
q−1
2
p
q
 q
p

≡1
(mod q).
It follows that
p
q
 q
p

= (−1)
p−1
2
q−1
2 .
This is the quadratic reciprocity law.
Exercises
1. Show that
τ(5) = 2

cos π
5 + cos 2π
5

.
2. Show that
τ(7) = i2

sin 2π
7 + sin 4π
7 −sin π
7

.
3. Let p be an odd prime and χ0 the principal character modulo p. Prove
that if p divides a, then τ(a, χ0) = p −1.

4.6 Gauss Sums and Quadratic Reciprocity
159
4. Let g be a primitive root modulo the prime p. Prove that, for every
integer b, the function χb deﬁned by
χb(gj + pZ) = e2πibj/(p−1) = ep−1(bj)
(4.20)
is a multiplicative character modulo p.
Hint: Every congruence class in (Z/pZ)× is uniquely of the form
gj+pZ for j = 0, 1, . . . , p−2, and the map from (Z/pZ)× to Z/(p−1)Z
deﬁned by gj + pZ →j + (p −1)Z is an isomorphism.
5. Prove that the dual group of (Z/pZ)× is the set of functions χb deﬁned
by (4.20) for b = 0, 1, . . . , p −2.
6. Prove that
χ−1
b
= χb = χp−1−b
for b = 0, 1, . . . , p −2.
7. Prove that
χb(−1 + pZ) = (−1)b
for b = 0, 1, . . . , p −2.
8. Let p be an odd prime number, and g a primitive root modulo p.
Deﬁne the multiplicative characters χb by (4.20). Prove that
ℓp = χ(p−1)/2.
9. Let χ be a multiplicative character modulo m, and let a and b be
integers relatively prime to m. Prove that
χ(a) χ(ψa) = χ(b) χ(ψb).
10. Let χ be a multiplicative character modulo m. Prove that
χ = 1
m
m−1

a=0
τ(χ, −a)ψa.
11. Let ψ be an additive character modulo m and χ a multiplicative
character modulo m. Prove that
 χ(ψ−1) =  ψ(χ−1).

160
4. Fourier Analysis on Finite Abelian Groups
4.7
The Sign of the Gauss Sum
For the odd prime number p, we consider the Gauss sum
τ(p) = τ(ℓp, 1) =
p−1

k=1
k
p

ep(k) =
p−1

x=0
e2πix2/p.
By Theorem 4.18,
τ(p)2 =

p
if p ≡1
(mod 4),
−p
if p ≡3
(mod 4),
and so
τ(p) =

±√p
if p ≡1
(mod 4),
±i√p
if p ≡3
(mod 4).
In this section we determine the sign of τ(p). We shall prove that
τ(p) =
 √p
if p ≡1
(mod 4),
i√p
if p ≡3
(mod 4).
Recall that for the cyclic group G = Z/nZ of order n, the character
group  G consists of all functions of the form
ψa(x + nZ) = en(ax).
Moreover, the map from G to  G deﬁned by a + nZ →ψa is a group
isomorphism. If λ ∈L2(  G), then there is a function λ♯∈L2(G) deﬁned by
λ♯(a + nZ) = λ(ψa).
The map λ →λ♯is a vector space isomorphism from L2(  G) onto L2(G).
The Fourier transform is a a vector space isomorphism from L2(G) onto
L2(  G). Deﬁne F : L2(G) →L2(G) as the composition of the Fourier trans-
form with the ♯map. If f ∈L2(G), then
F(f)(a + nZ)
=

 f
♯
(a + nZ)
=
 f(ψa)
=
n−1

x=0
f(x + nZ)ψa(x + nZ)
=
n−1

x=0
f(x + nZ)ω−ax,
where
ω = en(1) = e2πi/n.
The linear operator F is also called the Fourier transform.

4.7 The Sign of the Gauss Sum
161
Theorem 4.22 For all functions f ∈L2(Z/nZ),
F2(f)(a + nZ) = nf(−a + nZ).
Proof. This is similar to the proof of (4.8) in Theorem 4.8. Writing
F(f) = g, we have
g(x + nZ) =
n−1

y=0
f(y + nZ)ω−xy
and
F2(f)(a + nZ)
=
F(g)(a + nZ)
=
n−1

x=0
g(x + nZ)ω−ax
=
n−1

x=0
n−1

y=0
f(y + nZ)ω−xyω−ax
=
n−1

y=0
f(y + nZ)
n−1

x=0
ω−x(a+y)
=
nf(−a + nZ).
This completes the proof. 2
The vector space L2(G) has a basis {δk}n−1
k=0, where the delta function δk
is deﬁned by
δk(x + nZ) =

1
if x ≡k
(mod n),
0
if x ̸≡k
(mod n).
We shall compute the matrix of the linear operator F with respect to this
basis. We have
F(δk)(j + nZ) =
n−1

x=0
δk(x + nZ)ω−jx = ω−jk,
and so
F(δk) =
n−1

j=0
ω−jkδj.
Therefore, the matrix of F with respect to the basis {δk}n−1
k=0 is
M(F) =

ω−jkn−1
j,k=0 .
(4.21)

162
4. Fourier Analysis on Finite Abelian Groups
For any positive integer n we deﬁne the Gauss sum
τ(n) =
n−1

k=0
e2πik2/n.
By Theorem 4.17, this is consistent with our previous deﬁnition of τ(p) for
p prime. Since ω−k = ωk for all integers k, it follows that the trace of the
matrix M(F) is
tr(M(F)) =
n−1

k=0
ω(−k2) =
n−1

k=0
ω(k2) = τ(n).
Since the determinant and trace of a linear operator on a ﬁnite-dimensional
vector space are independent of the choice of basis for the vector space, it
follows that the trace of the Fourier transform F on the group Z/nZ is the
complex conjugate of the Gauss sum τ(n).
Theorem 4.23 Let n be an odd positive integer and G = Z/nZ the cyclic
group of order n. Then the determinant of the Fourier transform F on
L2(G) is
det(F) =

(−1)knn/2
if n = 4k + 1,
(−1)kinn/2
if n = 4k + 3.
Proof. We shall compute the determinant of the matrix M(F) in two
ways. Let ω = e2πi/n. The square of M(F) is the matrix B = (bjk)n−1
j,k=0,
where
bjk =
n−1

ℓ=0
ω−jℓω−ℓk =
n−1

ℓ=0
ω−(j+k)ℓ=
 n
if j + k ≡0
(mod n),
0
if j + k ̸≡0
(mod n),
and so (by Exercise 4)
det(M(F))2 = det(B) = (−1)(n−1)/2nn = in−1nn.
Then
det(M(F)) = ±i(n−1)/2nn/2.
(4.22)
The determinant of M(F) is also a Vandermonde determinant (Nathanson [103,
pp. 78–81]), whose value is
det(F)
=

0≤j<k≤n−1

ω−k −ω−j
=

0≤j<k≤n−1
ω−(j+k)/2 
ω−(k−j)/2 −ω(k−j)/2
=

0≤j<k≤n−1
ω−(j+k)/2

−2i sin
(k −j)π
n


4.7 The Sign of the Gauss Sum
163
=

0≤j<k≤n−1
ω−(j+k)/2

0≤j<k≤n−1

−2i sin
(k −j)π
n

=
ω
−
0≤j<k≤n−1(j+k)/2(−i)n(n−1)/2

0≤j<k≤n−1
2 sin
(k −j)π
n

.
We can compute the exponent of ω as follows:

0≤j<k≤n−1
j + k
2
=
1
2
n−1

k=1
k−1

j=0
(j + k)
=
1
2
n−1

k=1
k(k −1)
2
+ k2

=
1
4
n−1

k=1

3k2 −k

=
n
n −1
2
2
,
by Exercise 6. Since n is odd, it follows that

0≤j<k≤n−1
j + k
2
≡0
(mod n),
and so
ω
−
0≤j<k≤n−1(j+k)/2 = 1.
If 0 ≤j < k ≤n−1, then 0 < (k−j)π
n
) < π and sin

(k−j)π
n

> 0. Therefore,
det(M(F)) = (−i)n(n−1)/2

0≤j<k≤n−1
2 sin
(k −j)π
n

,
(4.23)
where

0≤j<k≤n−1
2 sin
(k −j)π
n

> 0.
Comparing (4.22) and (4.23), we obtain
det(F) = (−i)n(n−1)/2nn/2.
By Exercise 7,
(−i)n(n−1)/2 =
 (−1)k
if n = 4k + 1,
(−1)ki
if n = 4k + 3.
This completes the proof. 2

164
4. Fourier Analysis on Finite Abelian Groups
Theorem 4.24 Let p be an odd prime and G = Z/pZ the cyclic group of
order p. Then the determinant of the Fourier transform F on L2(G) is
det(F) = p
p−2

b=1
τ(χb, 1),
where χb is the multiplicative character modulo p deﬁned by (4.20) for
b = 0, 1, . . . , p −2.
Proof. The p −1 functions χ0, χ1, . . . , χp−2 are orthogonal in L2(G),
since
(χa, χb) =
p−1

x=0
χa(x + pZ)χb(x + pZ) =

p −1
if a = b,
0
if a ̸= b
by Theorem 4.7. Let δ0 be the delta function at 0, that is,
δ0(x + pZ) =

1
if x ≡0
(mod p),
0
if x ̸≡0
(mod p).
Then
(δ0, δ0) = 1
and
(χb, δ0) =
p−1

x=0
χb(x + pZ)δ0(x + pZ) = χb(pZ) = 0.
It follows that the set {δ0, χ0, χ1, . . . , χp−2} is an orthogonal set of p func-
tions in L2(G), and so is a basis for L2(G). This basis is called the basis
of multiplicative characters for L2(G). We shall compute the matrix of the
Fourier transform F with respect to this basis.
For every congruence class a + pZ ∈G we have
F(δ0)(a + pZ)
=
 δ0(ψa)
=
p−1

x=0
δ0(x + pZ)ψa(x + pZ)
=
ψa(pZ)
=
1
=
δ0(a + pZ) + χ0(a + pZ),
where χ0 is the principal multiplicative character modulo p. Therefore,
F(δ0) = δ0 + χ0.

4.7 The Sign of the Gauss Sum
165
Similarly,
F(χ0)(a + pZ)
=
!
χ0(ψa)
=
p−1

x=0
χ0(x + pZ)ψa(x + pZ)
=
p−1

x=1
ψa(x + pZ)
=
p−1

x=0
ψ−a(x + pZ) −1
=

p −1
if a ≡0
(mod p)
−1
if a ̸≡0
(mod p)
=
(p −1)δ0(a + pZ) −χ0(a + pZ),
and so
F(χ0) = (p −1)δ0 −χ0.
By Theorem 4.16, and by Exercises 6 and 7 in Section 4.6, if b ̸≡0
(mod p −1), then
F(χb)(a + pZ)
=
!
χb(ψa)
=
τ(χb, −a)
=
τ(χb, 1)χb(−a + pZ)
=
τ(χb, 1)χp−1−b(−a + pZ)
=
(−1)bτ(χb, 1)χp−1−b(a + pZ),
and so
F(χb) = (−1)bτ(χb, 1)χp−1−b.
(4.24)
This determines the matrix of F with respect to the basis of multiplicative
characters. For example, if p = 5, this matrix is






1
4
0
0
0
1
−1
0
0
0
0
0
0
0
−τ(χ3, 1)
0
0
0
τ(χ2, 1)
0
0
0
−τ(χ1, 1)
0
0






.
By Exercise 4, the determinant of this matrix is
det(F)
=
−p(−1)(p−3)/2
p−2

b=1
(−1)bτ(χb, 1)
=
p(−1)(p−1)/2
p−2

b=1
(−1)b
p−2

b=1
τ(χb, 1)

166
4. Fourier Analysis on Finite Abelian Groups
=
p
p−2

b=1
τ(χb, 1).
This completes the proof. 2
We can now determine the sign of the classical Gaussian sum.
Theorem 4.25 If p is an odd prime, then
τ(p) =
p−1

x=1
e2πix2/p =
 √p
if p ≡1
(mod 4),
i√p
if p ≡3
(mod 4).
Proof. By (4.24), we have
F(χb) = (−1)bτ(χb, 1)χp−1−b
and so
F2(χb)
=
F

(−1)bτ(χb, 1)χp−1−b

=
(−1)bτ(χb, 1)F (χp−1−b)
=
(−1)bτ(χb, 1)(−1)p−1−bτ(χp−1−b, 1)χb
=
τ(χb, 1)τ(χp−1−b, 1)χb.
On the other hand, applying Fourier inversion (Theorem 4.22), we obtain
F2(χb)(a + pZ)
=
pχb(−a + pZ)
=
χb(−1 + pZ)pχb(a + pZ)
=
(−1)bpχb(a + pZ),
and so
F2(χb) = (−1)bpχb.
It follows that
τ(χb, 1)τ(χp−1−b, 1) = (−1)bp.
Let r = (p −1)/2. It follows from Exercise 8 in Section 4.6 that ℓp = χr
and τ(p) = τ(χr, 1). By Theorem 4.24,
det(F)
=
p
p−2

b=1
τ(χb, 1)
=
pτ(p)
r−1

b=1
τ(χb, 1)τ(χp−1−b, 1)
=
pτ(p)
r−1

b=1

(−1)bp

=
(−1)r(r−1)/2p(p−1)/2τ(p).

4.7 The Sign of the Gauss Sum
167
By Theorem 4.23,
det(F) =

(−1)kpp/2
if p = 4k + 1,
(−1)kipp/2
if p = 4k + 3.
If p = 4k + 1, then r = 2k and
(−1)r(r−1)/2p(p−1)/2τ(p)
=
(−1)k(2k−1)p(p−1)/2τ(p)
=
(−1)kp(p−1)/2τ(p)
=
(−1)kpp/2,
and so
τ(p) = √p.
If p = 4k + 3, then r = 2k + 1 and
(−1)r(r−1)/2p(p−1)/2τ(p)
=
(−1)k(2k+1)p(p−1)/2τ(p)
=
(−1)kp(p−1)/2τ(p)
=
(−1)kipp/2,
and so
τ(p) = i√p.
This completes the proof. 2
Exercises
1. Prove that
2

cos π
5 + cos 2π
5

=
√
5.
and
2

sin 2π
7 + sin 4π
7 −sin π
7

=
√
7.
Hint: Consider the Gauss sums τ(5) and τ(7).
2. Prove that
τ(ℓp, a) =















√p
if p ≡1
(mod 4) and

a
p

= 1,
−√p
if p ≡1
(mod 4) and

a
p

= −1,
i√p
if p ≡3
(mod 4) and

a
p

= 1,
−i√p
if p ≡3
(mod 4) and

a
p

= −1.

168
4. Fourier Analysis on Finite Abelian Groups
3. Let ω = e2πi/3. Compute the trace and determinant of the matrix
M =


1
1
1
1
ω2
ω
1
ω
ω2


4. Let A = (aj,k)n−1
j,k=1 be an n −1 × n −1 matrix such that aj,k = 0 if
j + k ̸≡0
(mod n). For example, if n = 4, then


0
0
a1,3
0
a2,2
0
a3,1
0
0

.
Prove that
det(A) =
*
(−1)(n−1)/2 n−1
j=1 aj,n−j
if n is odd,
(−1)(n−2)/2 n−1
j=1 aj,n−j
if n is even.
Let B = (bj,k)n−1
j,k=0 be an n × n matrix such that bj,k = n if j + k ≡0
(mod n) and bj,k = 0 if j + k ̸≡0
(mod n). For example, if n = 4,
then




4
0
0
0
0
0
0
4
0
0
4
0
0
4
0
0



.
Prove that
det(B) =

(−1)(n−1)/2nn
if n is odd,
(−1)(n−2)/2nn
if n is even.
5. Let In denote the n × n identity matrix. Prove that M(F)4 = n2In
and so
det(F)4 = n2n.
6. Prove that for every positive integer n,
n−1

k=1

3k2 −k

= n (n −1)2 .
7. Let n be an odd integer. Prove that
(−i)n(n−1)/2 =

(−1)k
if n = 4k + 1,
(−1)ki
if n = 4k + 3.
8. Prove that the Legendre symbol is an eigenvector of the Fourier trans-
form with eigenvalue (−1)(p−1)/2τ(p).
Hint: Exercise 8 in Section 4.6.

4.8 Notes
169
4.8
Notes
A comprehensive survey of analysis and trace formulae on ﬁnite abelian
and nonabelian groups is Terras, Fourier Analysis on Finite Groups and
Applications [141]. Our proof of the sign of the Gauss sum uses an argument
of Schur [126] that appears Landau [87, pp. 207–212] and Auslander and
Tolimieri [7]. See Berndt and Evans [8] for a review of Gauss sums, and
Berndt, Evans, and Williams, Gauss and Jacobi Sums [9] for an exhaustive
monograph.
For much more sophisticated studies of harmonic analysis in algebraic
number theory, see Ramakrishnan and Valenza, Fourier Analysis on Num-
ber Fields [120], and Weil’s classic Basic Number Theory [154].

5
The abc Conjecture
5.1
Ideals and Radicals
In this chapter a ring is always a commutative ring with identity. An addi-
tive subgroup I of a ring R is called an ideal if ar ∈I for every a ∈I and
r ∈R. Both R and {0} are ideals in R. The set of even integers is an ideal
in the ring Z. Indeed, every additive subgroup of Z is an ideal in Z. The
set of polynomials with constant term equal to 0 is an ideal in the ring R[t]
of polynomials with coeﬃcients in the ring R. The intersection of a family
of ideals is an ideal (Exercise 19 in Section 3.1).
If A is a nonempty subset of the ring R, then the set of all ﬁnite linear
combinations of the form a1r1 + · · · + akrk with ai ∈A and ri ∈R is an
ideal of R, denoted by ⟨A⟩and called the ideal generated by the set A.
An ideal generated by one element a ∈R is called a principal ideal and
denoted by
⟨a⟩= aR = {ar : r ∈R}.
A principal ring is a ring in which every ideal is principal. For example,
Z is a principal ring by Theorem 1.3, and Z/mZ is a principal ring by
Theorem 5.2.
An ideal I in the ring R is called a prime ideal if I ̸= R and ab ∈I
implies a ∈I or b ∈I for all a, b ∈R. The spectrum of the ring R, denoted
by Spec(R), is the set of all prime ideals of R.
Theorem 5.1 The spectrum of the ring of integers is
Spec(Z) = {pZ : p is prime or p = 0}.

172
5. The abc Conjecture
Proof. Since Z is principal, every ideal is of the form dZ for some non-
negative integer d. If d = 0, then dZ = {0}, and the zero ideal is prime,
since ab = 0 if and only if a = 0 or b = 0. Let d ≥1. If d = p is prime and
ab ∈pZ, then p divides ab. By Euclid’s lemma, p divides a or p divides b,
and so a ∈pZ or b ∈pZ. Therefore, pZ is a prime ideal for every prime
number p.
If d is composite, then we can write d = ab, where 1 < a ≤b < d. If
a ∈dZ, then a = dk = abk for some positive integer k, and so 1 = bk, which
is absurd. Therefore, a /∈dZ and, similarly, b /∈dZ. Since d = ab ∈dZ, it
follows that dZ is not a prime ideal. Thus, the prime ideals in the ring Z
are the ideals of the form pZ, where p is a prime number or p = 0. 2
An element x in a ring R is called nilpotent if there exists a positive inte-
ger k such that xk = 0. For example, the additive identity 0 is a nilpotent
element of every ring, and the multiplicative identity 1 is never nilpotent.
The congruence class 6+27Z is a nilpotent element in the ring Z/27Z. The
set of all nilpotent elements in R is called the radical of the ring R, and
denoted by N(R). Thus, the radical of the ring Z is {0}. By Exercise 6,
the radical of a ring is a proper ideal in the ring. By Exercise 9, the radical
of a ring is the intersection of the prime ideals in the ring.
We shall compute the radical of the ring of congruence classes Z/mZ.
Recall that the radical of the nonzero integer m is the product of the distinct
prime numbers that divide m, that is,
rad(m) =

p|m
p.
For example, rad(72) = 6, rad(30) = 30, and rad(−1) = 1.
Theorem 5.2 For m ≥2, let Z/mZ be the ring of congruence classes
modulo m. Then
(i) Z/mZ is principal, and the ideals of Z/mZ are the ideals generated
by the congruence classes d + mZ, where d is a divisor of m;
(ii) the prime ideals of Z/mZ are the ideals generated by the congruence
classes p + mZ, where p is a prime divisor of m; and
(iii) the radical of Z/mZ is the ideal generated by the congruence class
rad(m) + mZ.
Proof. Let J be an ideal in the ring R = Z/mZ. Consider the union of
congruence classes
I =
,
a+mZ∈J
(a + mZ).
The set I is an ideal in Z. Since Z is principal, I = dZ for some positive
integer d ∈I. Since m ∈mZ ⊆I, it follows that d is a divisor of m.

5.1 Ideals and Radicals
173
Moreover, d + mZ ∈J, and so the principal ideal generated by d + mZ in
Z/mZ is contained in J. If a+mZ ∈J, then a ∈a+mZ ⊆I, and so a = dr
for some integer r. It follows that a + mZ = (d + mZ)(r + mZ) belongs
to the principal ideal generated by d + mZ. Therefore, J is the principal
ideal generated by d + mZ, and a + mZ ∈J if and only if d divides a. (See
Exercise 3 for a diﬀerent proof.)
Next we compute the spectrum of the ring Z/mZ. Let J be the principal
ideal generated by d + mZ, where d divides m and d ≥2. If d = p is prime
and
(a + mZ)(b + mZ) = ab + mZ ∈J,
then p divides ab and so p divides a or p divides b, that is, a + mZ ∈J or
b + mZ ∈J, and J is a prime ideal.
If d = ab is composite, where 1 < a ≤b < d, then a+mZ /∈J, b+mZ /∈J,
but (a + mZ)(b + mZ) = d + mZ ∈J, and so J is not a prime ideal. Thus,
the prime ideals of the ring Z/mZ are the ideals of the form p+mZ, where
p is a prime divisor of m.
Finally, the congruence class a + mZ is nilpotent in R if and only if
(a + mZ)k = ak + mZ = mZ for some positive integer k. Equivalently,
a + mZ is nilpotent if and only if m divides ak for some positive integer k.
By Theorem 1.13, this is possible if and only if a is divisible by rad(m), and
so N(Z/mZ) is the ideal generated by the congruence class rad(m) + mZ.
2
Theorem 5.3 The ring C[t] of polynomials with coeﬃcients in the ﬁeld C
of complex numbers is a principal ring.
Proof. This is a special case of Exercise 18 in Section 3.1. 2
Let f(t) ∈C[t] be a polynomial of degree n. If α1, . . . , αr are the distinct
zeros of f(t), then we can factor f(t) into a product of linear terms of the
form f(t) = cn
r
i=1(t −αi)mi, where the leading coeﬃcient cn ̸= 0 and
m1 + · · · + mr = n. The radical of the polynomial f(x) is deﬁned by
rad(f) =
r

i=1
(t −αi).
The zero set of the polynomial f(t) is the ﬁnite set
Z(f) = {α ∈C : f(α) = 0} = {α1, . . . , αr}.
Let N0(f) denote the number of distinct zeros of f, that is, N0(f) =
|Z(f)| = r. The degree of the radical of f(t) is the number of distinct
zeros of f(t), that is,
deg rad(f) = N0(f).

174
5. The abc Conjecture
Theorem 5.4 Let f(t) ∈C[t] and R = C[t]/I, where I = ⟨f(t)⟩is the
principal ideal generated by f(t). The radical of R is the principal ideal
generated by rad(f) + I.
Proof. This follows immediately from the observation that if f(t) and
g(t) are polynomials with complex coeﬃcients, then there exists a positive
integer k such that f(t) divides g(t)k if and only if rad(f) divides g(t). 2
Exercises
1. Determine rad(3n) and rad(n!) for all n ≥0.
2. Let m and n be nonzero integers. Prove that rad(mn) ≤rad(m)rad(n).
Prove that rad(mn) = rad(m)rad(n) if and only if (m, n) = 1.
3. Let f : R →S be a surjective ring homomorphism. Prove that if the
ring R is principal, then the ring S is also principal. Apply this to
the map f : Z →Z/mZ deﬁned by f(a) = a + mZ.
4. Prove that a unit in a ring R ̸= {0} is never nilpotent.
5. Let R be an integral domain, that is, a ring with the property that
if x1, x2 ∈R and x1x2 = 0, then x1 = 0 or x2 = 0. Prove that if
x1, . . . , xk ∈R and x1 · · · xk = 0, then xi = 0 for some i. Prove that
0 is the only nilpotent element in an integral domain.
6. Let R be a ring and let N(R) denote the set of all nilpotent elements
in R. Prove that N(R) is an ideal.
Hint: Prove that if x is nilpotent, then xr is nilpotent for every r ∈
R. Use the binomial theorem to show that if xk = yℓ= 0, then
(x + y)k+ℓ−1 = 0.
7. Prove that if x is nilpotent, then x is contained in every prime ideal
of R, and so
N(R) ⊆

I∈Spec(R)
I.
8. Prove that if x is not nilpotent, then there exists a prime ideal of R
that does not contain x.
Hint: Let S = {xk : k = 1, 2, . . .}. Let I be the set of all ideals
in R that do not contain any element of S. If x is not nilpotent,
then 0 /∈S and {0} ∈I. Use Zorn’s lemma to prove that the set I
contains a maximal element I, and that I is a prime ideal in R. such
that I ∩S = ∅.

5.2 Derivations
175
9. Prove that the radical of the ring R is the intersection of all prime
ideals of R, that is,
N(R) =

I∈Spec(R)
I.
10. Let a1, . . . , ak be divisors of m, and let [a1, . . . , ak] be their least
common multiple. Let ⟨ai +mZ⟩denote the principal ideal generated
by the congruence class ai + mZ in the ring R = Z/mZ. Prove that
k
i=1
⟨ai + mZ⟩= ⟨[a1, . . . , ak] + mZ⟩.
Hint: Observe that ⟨ai + mZ⟩= aiZ and apply Exercise 30 in Sec-
tion 1.4.
11. Use Exercises 9 and 10 to prove that
N(Z/mZ) = ⟨rad(m) + mZ⟩.
12. Let I and J be ideals in a ring R. The product IJ is the ideal of R
generated by the set of all elements of the form xy with x ∈I and
y ∈J. In the ring Z, prove that the product of the principal ideals
aZ and bZ is the ideal abZ.
13. Let I and J be ideals in the ring R. We say that I divides J if I
contains J, that is, J ⊂I. Prove that if P is a prime ideal in R and
if P divides the product ideal IJ, then P divides I or P divides J.
14. Let I and J be ideals in Z. Prove that if I divides J, then there exists
an ideal K in Z such that IK = J. Prove that every ideal in Z is
uniquely a product of prime ideals.
5.2
Derivations
A derivation on a ring R is a map D : R →R such that
D(x + y) = D(x) + D(y)
(5.1)
and
D(xy) = D(x)y + xD(y)
(5.2)
for all x, y ∈R. Condition (5.1) says that D is a homomorphism of the
additive group structure of R. Condition (5.2) implies (Exercise 1) that
D(1) = 0 and that, if x ∈R is invertible, then
D(x−1) = −D(x)
x2 .

176
5. The abc Conjecture
Moreover, it follows by induction (Exercise 2) that
D(x1 · · · xn) =
n

i=1
x1 · · · xi−1D(xi)xi+1 · · · xn
for all x1, . . . , xn ∈R.
The next result shows that the derivative is a derivation on a polynomial
ring.
Theorem 5.5 Let R be a ring and R[t] the ring of polynomials with coef-
ﬁcients in R. Deﬁne D : R[t] →R[t] by
D
 m

i=0
aiti

=
m

i=1
iaiti−1.
Then D is a derivation on R[t].
Proof. Let f = f(t) = m
i=0 aiti and g = g(t) = n
j=0 bjtj. It is imme-
diate that D(f + g) = D(f) + D(g), and so D is a homomorphism of the
additive group of polynomials. Since
f(t)g(t) =
m

i=0
n

j=0
aitibjtj =
m+n

k=0

i+j=k
aibjtk,
we have
D(fg)
=
m+n

k=1
k

i+j=k
aibjtk−1
=
m+n

k=1

i+j=k
(i + j)aibjti+j−1
=
m+n

k=1

i+j=k
iaiti−1bjtj +
m+n

k=1

i+j=k
aitijbjtj−1
=
m

i=1
n

j=0
iaiti−1bjtj +
m

i=0
n

j=1
aitijbjtj−1
=
D(f)g + fD(g).
Therefore, D is a derivation on R[t]. 2
An integral domain is a ring R such that if b1, b2 ∈R with b1 ̸= 0 and
b2 ̸= 0, then b1b2 ̸= 0. Corresponding to every integral domain is a ﬁeld,
called the quotient ﬁeld of R. It consists of all fractions of the form a/b,

5.2 Derivations
177
where a, b ∈R and b ̸= 0, and a1/b1 = a2/b2 if and only if a1b2 = a2b1.
Addition and multiplication of fractions are deﬁned in the usual way: If
a1, a2, b1, b2 ∈R with b1 ̸= 0 and b2 ̸= 0, then b1b2 ̸= 0 and
a1
b1
+ a2
b2
= a1b2 + a2b1
b1b2
and
a1
b1
· a2
b2
= a1a2
b1b2
.
The quotient ﬁeld of Z is Q. If F[t] is the ring of polynomials with coeﬃ-
cients in a ﬁeld F, then the quotient ﬁeld of F[t] is the ﬁeld F(t) of rational
functions with coeﬃcients in F. A careful construction of quotient ﬁelds
can be found in the Exercises.
Theorem 5.6 Let R be an integral domain with quotient ﬁeld F, and let
D be a derivation on R. There exists a unique derivation DF on F such
that DF (x) = D(x) for all x ∈R.
Proof. Suppose that there exists a derivation DF on F such that DF (a) =
D(a) for all a ∈R. Let x ∈F, x ̸= 0. There exist a, b ∈R with b ̸= 0 and
x = a/b. Since a = bx ∈R, it follows that
D(a) = DF (a) = DF (bx) = DF (b)x + bDF (x) = D(b)x + bDF (x),
and so
DF
a
b

= DF (x) = D(a) −D(b)x
b
= D(a)b −aD(b)
b2
.
(5.3)
Thus, the derivation DF on F is uniquely determined by the derivation D
on R. In Exercise 3 we prove that (5.3) deﬁnes a derivation on the quotient
ﬁeld RF . 2
Let D be a derivation on the ﬁeld F. For x ∈F ×, we deﬁne the logarith-
mic derivative L(x) by
L(x) = D(x)
x
.
If x, y ∈F ×, then
L(xy) = D(xy)
xy
= D(x)y + xD(y)
xy
= D(x)
x
+ D(y)
y
= L(x) + L(y)
and
L
x
y

= D(x)
x
+ D(y−1)
y−1
= D(x)
x
−D(y)
y
= L(x) −L(y)
by Exercise 1.
We now consider polynomials with complex coeﬃcients. A ﬁeld F is
called algebraically closed if every nonconstant polynomial with coeﬃcients

178
5. The abc Conjecture
in F has at least one zero in F. By the fundamental theorem of algebra,
the ﬁeld C is algebraically closed. Let f(t) ∈C[t], and let N0(f) denote the
number of distinct zeros of f(t). If f(t) has degree n with leading coeﬃcient
an, then f(t) factors uniquely in the form
f(t) = an
N0(f)

i=1
(t −αi)ni,
where α1, . . . , αN0(f) are the distinct zeros of f, the positive integer ni is
the multiplicity of the zero αi, and n1 + · · · + nN0(f) = n. If D is the
derivation on C[t] deﬁned in Theorem 5.5, then, by Exercise 2,
D(f) = an
N0(f)

i=1
ni(t −αi)ni−1
N0(f)

j=1
j̸=i
(t −αj)nj
and
L(f) = D(f)
f
=
N0(f)

i=1
ni
t −αi
.
Let g(t) = bm
N0(g)
j=1 (t −βj)mj be a nonzero polynomial in C[t], and con-
sider the rational function f/g ∈C(t). Then
L
f
g

= L(f) −L(g) =
N0(f)

i=1
ni
t −αi
−
N0(g)

j=1
mj
t −βj
.
(5.4)
This algebraic identity will be used in the next section to prove Mason’s
theorem.
Exercises
1. Let D be a derivation on a ring R. Prove that D(1) = 0 and that, if
x ∈R is invertible, then
D(x−1) = −D(x)
x2 .
2. Let D be a derivation on the ring R. Prove that
D(x1 · · · xn) =
n

i=1
x1 · · · xi−1D(xi)xi+1 · · · xn
for all x1, . . . , xn ∈R.
3. Let R be an integral domain with quotient ﬁeld F. Let D be a deriva-
tion on R, and deﬁne the function DF on F by (5.3). We shall prove
that DF is a derivation on the quotient ﬁeld F.

5.2 Derivations
179
(a) Prove that DF is well deﬁned, that is, if a1/b1 = a2/b2, then
DF (a1/b1) = DF (a2/b2).
(b) Prove that
DF
a1
b1
+ a2
b2

= DF
a1
b1

+ DF
a2
b2

.
(c) Prove that
DF
a1
b1
· a2
b2

= DF
a1
b1
 a2
b2
+ a1
b1
DF
a2
b2

.
4. Let R be a commutative ring with identity. A multiplicatively closed
subset of R is a subset S such that 1 ∈S and if s1, s2 ∈S, then
s1s2 ∈S. We consider the set of ordered pairs of the form (r, s) with
r ∈R and s ∈S. Deﬁne a relation on this set as follows:
(r, s) ∼(r′, s′)
if
s′′(s′r −sr′) = 0 for some s′′ ∈S.
Prove that this is an equivalence relation.
5. Let S−1R be the set of equivalence classes of the relation deﬁned in
Exercise 4. We denote the equivalence class of (r, s) by the fraction
r/s. We also denote the equivalence class (r, 1) by r. Deﬁne multipli-
cation of fractions as follows:
r1
s1
· r2
s2
= r1r2
s1s2
.
(a) Prove that this multiplication is well deﬁned, that is, if (r1, s1) ∼
(r′
1, s′
1) and (r2, s2) ∼(r′
2, s′
2), then (r1r2, s1s2) ∼(r′
1r′
2, s′
1s′
2).
(b) Prove that multiplication in S−1R is associative and commuta-
tive, and that the equivalence class of (1, 1) is a multiplicative
identity.
(c) Prove that the equivalence class of (s, 1) is invertible in S−1R
for every s ∈S.
(d) Prove that
a
s = s′a
s′s
for all a ∈R and s, s′ ∈S.
6. Deﬁne addition of fractions in S−1R as follows:
r1
s1
+ r2
s2
= s2r1 + s1r2
s1s2
.

180
5. The abc Conjecture
(a) Prove that this addition is well deﬁned, that is, if (r1, s1) ∼
(r′
1, s′
1) and (r2, s2) ∼(r′
2, s′
2), then (s2r1 +s1r2, s1s2) ∼(s′
2r′
1 +
s′
1r′
2, s′
1s′
2).
(b) Prove that addition in S−1R is associative and commutative,
and that multiplication distributes over addition. Prove that the
equivalence class of (0, 1) is an additive identity.
7. (Localization) In Exercises 4–6 we proved that S−1R is a ring. This
ring is called the ring of fractions of R by S. We also say that S−1R
is constructed by localizing R at S.
(a) Prove that if 0 ∈S, then S−1R = {0}.
(b) Prove that if R is an integral domain and 0 ̸∈S, then S−1R is
an integral domain.
(c) Prove that if R is an integral domain and S is the set of all
nonzero elements of R, then S−1R is a ﬁeld. This ﬁeld is called
the quotient ﬁeld of the integral domain R.
8. Deﬁne ϕS : R →S−1R by ϕS(r) = r/1 = r.
(a) Prove that ϕS is a ring homomorphism.
(b) Prove that if R is an integral domain and 0 ̸∈S, then ϕR is
one-to-one.
(c) Prove that if R is an integral domain and S = R×, then S−1R
is isomorphic to R.
Hint: If S is a multiplicative subset of R and s ∈S ∩R×, then
(r, s) ∼(s−1r, 1) for all r ∈R.
9. Let S = {1, 2, 4, 8, . . .} be the multiplicative subset of Z consisting
of the powers of 2. Describe the ring of fractions S−1Z. What is the
group of units in this ring?
10. Let S = {±1, ±3, ±5, ±7, . . .} be the multiplicative subset of Z con-
sisting of the odd integers.
(a) Describe the ring of fractions S−1Z.
(b) Describe the principal ideal generated by 2 in this ring.
(c) Prove that every element of the ring not in this ideal is a unit
in S−1Z, and so ⟨2⟩is a maximal ideal in S−1Z.
11. Let p be a prime number and let S be the set of all integers not divis-
ible by p. Prove that S is a multiplicative subset of Z, and describe
the ring of fractions S−1Z. Prove that the principal ideal generated
by p is a maximal ideal in S−1Z.

5.3 Mason’s Theorem
181
12. Let F[t] be the polynomial ring with coeﬃcients in the ﬁeld F. Let
S = {1, t, t2, t3, . . .} be the multiplicative subset of F[t] consisting
of the powers of t. Prove that S−1F[t] is isomorphic to the ring of
Laurent polynomials with coeﬃcients in F, that is, the ring consisting
of all expressions of the form n
i=m aiti, where ai ∈F, and m and n
are integers with m ≤n, and addition and multiplication are deﬁned
in the usual way.
13. We consider the ring R = Z/12Z, and denote the congruence class
a + 12Z by a
(a) Prove that S = {1, 3, 9} is a multiplicative subset of R.
(b) Let ϕS : R →S−1R be the ring homomorphism constructed
in Exercise 8. Prove that ϕS(a) = ϕS(b) if and only if a ≡b
(mod 4).
(c) Prove that 1/3 = 3 in S−1R.
(d) Prove that S−1R ∼= Z/4Z.
14. Let m ≥2. We consider the ring R = Z/mZ, and denote the congru-
ence class a + mZ by a. Let S be a multiplicative subset of R such
that 0 ̸∈S.
(a) Prove that we can factor m uniquely in the form m = m0m1,
where (m0, m1) = 1, and if p is a prime number that divides m,
then p divides m0 if and only if there is a congruence class s ∈S
such that p divides s. Show that (s, m1) = 1 for all s ∈S.
(b) Prove that there is a congruence class s0 ∈S such that m0
divides s0.
(c) Let ϕS : R →S−1R be the ring homomorphism constructed
in Exercise 8. Prove that ϕS(a) = ϕS(b) if and only if a ≡b
(mod m1).
(d) Prove that for every s ∈S there exists r ∈R such that 1/s = r
in S−1R.
Hint: If s ∈S, then there exists an integer r such that rs ≡1
(mod m1).
(e) Prove that S−1R ∼= Z/m1Z.
5.3
Mason’s Theorem
This is an important diophantine inequality for polynomials.

182
5. The abc Conjecture
Theorem 5.7 (Mason) If a, b, c ∈C[t] are nonzero, relatively prime poly-
nomials, not all constant, and if
a + b = c,
then
max{deg(a), deg(b), deg(c)} ≤N0(abc) −1 = deg(rad(abc)) −1,
where N0(abc) denotes the number of distinct zeros of the polynomial abc,
and rad(abc) is the radical of abc.
Since Mason’s theorem is symmetric in a, b, and c, we could also write
the equation in the form a + b + c = 0.
Proof. Let D be the unique derivation deﬁned on the rational function
ﬁeld C(t) by Theorems 5.5 and 5.6, and let L be the logarithmic derivative.
We introduce the nonzero rational functions u = a/c and v = b/c in C(t).
Then u + v = 1, and
uL(u) + vL(v)
=
u
D(u)
u

+ v
D(v)
v

=
D(u) + D(v) = D(u + v) = D(1)
=
0.
Since L(v) ̸= 0 (by Exercise 1), we have
b
a = v
u = −L(u)
L(v).
(5.5)
We write the standard factorizations of the polynomials a, b, and c as fol-
lows:
a
=
a(t) = an
N0(a)

i=1
(t −αi)ni,
b
=
b(t) = bm
N0(b)

i=1
(t −βi)mi,
c
=
c(t) = cr
N0(c)

i=1
(t −γi)ri.
Applying (5.4), we obtain
L(u) = L
a
c

=
N0(a)

i=1
ni
t −αi
−
N0(c)

j=1
rk
t −γk

5.3 Mason’s Theorem
183
and
L(v) = L
b
c

=
N0(b)

j=1
mj
t −βj
−
N0(c)

j=1
rk
t −γk
.
Since the polynomials a, b, and c are relatively prime, the radical of the
product abc is
q = rad(abc) =
N0(a)

i=1
(t −αi)
N0(b)

i=1
(t −βi)
N0(c)

i=1
(t −γi),
and
deg(q) = deg(rad(abc)) = N0(a) + N0(b) + N0(c).
Moreover, qL(u) and qL(v) are polynomials of degree at most deg(q) −1.
By (5.5),
b
a = −L(u)
L(v) = −qL(u)
qL(v),
and so
a(qL(u)) = −b(qL(v)).
Since the polynomials a and b are relatively prime, it follows that a divides
qL(v), and so
deg(a) ≤deg(qL(v)) ≤deg(q) −1 = deg(rad(abc)) −1.
Similarly,
deg(b) ≤deg(qL(u)) ≤deg(q) −1 = deg(rad(abc)) −1
and
deg(c) ≤deg(rad(abc)) −1.
This completes the proof. 2
Fermat’s last theorem states that if n ≥3, then the Fermat equation
xn + yn = zn
has no solutions in positive integers. The Fermat equation has solutions in
polynomials for n = 2, for example,
(1 −t2)2 + (2t)2 = (1 + t2)2.
We shall use Mason’s theorem to prove Fermat’s last theorem for polyno-
mials for n ≥3.
Theorem 5.8 If n ≥3, then the Fermat equation xn + yn = zn has no
solution in nonzero, relatively prime polynomials, not all constant.

184
5. The abc Conjecture
Proof. Let n ≥3, and suppose that x, y, and z are nonzero, relatively
prime polynomials, not all constant, such that xn + yn = zn. We apply
Mason’s theorem with a = xn, b = yn, and c = zn. Then
rad(abc) = rad(xnynzn) = rad(xyz).
Since deg(xn) = n deg(x), we obtain
n deg(x)
≤
n max(deg(x), deg(y), deg(z))
=
max(deg(xn), deg(yn), deg(zn))
=
max(deg(a), deg(b), deg(c))
≤
deg(rad(abc)) −1
=
deg(rad(xyz)) −1
≤
deg(xyz) −1
=
deg(x) + deg(y) + deg(z) −1.
It follows that
n(deg(x) + deg y + deg(z))
≤
3(deg(x) + deg y + deg(z)) −3
≤
n(deg(x) + deg y + deg(z)) −3.
This is impossible. 2
Exercises
1. Prove that L(v) ̸= 0 in the proof of Theorem 5.7.
2. Let n ≥3. Prove that the equation xn + yn = 1 has no solution in
nonconstant rational functions x, y ∈C(t).
3. (Nathanson [102]) The Catalan equation is the equation
xm −yn = 1,
where m and n are integers greater than 1. Prove that this equation
has no solution in nonconstant polynomials x, y ∈C[t] and integers
m ≥2 and n ≥2.
4. (Davenport [20]) Let f and g be nonconstant, relatively prime poly-
nomials in C[t]. Prove that
deg(f 3 −g2) ≥1
2 deg(f) + 1.

5.4 The abc Conjecture
185
5. Let
f
=
t6 + 4t4 + 10t2 + 6
g
=
t9 + 6t7 + 21t5 + 35t3 + 63
2 t.
Check that
f 3 −g2 = 27t4 + 351
4 t2 + 216.
This example shows that the lower bound in Davenport’s theorem
(Exercise 4) is best possible.
5.4
The abc Conjecture
The abc conjecture is a simple but powerful assertion about the relationship
between the additive and multiplicative properties of integers. Recall that
the radical of a nonzero integer m is the largest square-free divisor of m,
that is,
rad(m) =

p|m
p.
The abc conjecture states that for every ε > 0 there exists a number K(ε)
such that, if a, b, and c are nonzero, relatively prime integers and
a + b = c,
then
max(|a|, |b|, |c|) ≤K(ε)rad(abc)1+ε.
Since the inequality is symmetric in a, b, and c, the equation can also be
written in the form a + b + c = 0. To prove or disprove this conjecture is
an important unsolved problem in number theory.
From the abc conjecture it is possible to deduce many theorems and still
unproven propositions in number theory. Here are some examples.
Fermat’s last theorem states that, for n ≥3, the Fermat equation
xn + yn = zn
(5.6)
has no solution in positive integers. Note that if x, y, z is a solution of (5.6)
in positive integers and if a prime number p divides x and y, then p also
divides z, and x/p, y/p, z/p is another solution of the equation. It follows
that if the Fermat equation has a solution in integers, then it has a solution
in relatively prime integers.
Theorem 5.9 (Asymptotic Fermat theorem) The abc conjecture im-
plies that there exists an integer n0 such that the Fermat equation has no
solution in relatively prime integers for any exponent n ≥n0.

186
5. The abc Conjecture
Proof. Let x, y, and z be relatively prime positive integers such that
xn + yn = zn.
We note that
rad(xnynzn) = rad(xyz) ≤xyz ≤z3.
If n ≥2, then z ≥3. Applying the abc conjecture with ε = 1 and K1 =
max(1, K(1)), we obtain
zn = max(xn, yn, zn) ≤K1rad(xnynzn)2 < K1z6,
and so
n < 6 + log K1
log z
≤6 + log K1
log 3 .
This completes the proof. 2
The Catalan conjecture asserts that 8 and 9 are the only consecutive
powers. Equivalently, it states that the only solution of the Catalan equation
xm −yn = 1
in integers x, y, m, n all greater than 1 is
32 −23 = 1.
It is known that the diophantine equation xm −y2 = 1 has no solution in
positive integers, and that the only solution of the equation x2 −yn = 1 in
positive integers is x = n = 3 and y = 2. Therefore, it suﬃces to consider
the Catalan equation only for min(m, n) ≥3.
Theorem 5.10 (Asymptotic Catalan theorem) The abc conjecture im-
plies that the Catalan equation has only ﬁnitely many solutions.
Proof. Let (x, y, m, n) be a solution of the Catalan equation with min(m, n) ≥
3. Then x and y are relatively prime. It follows from the abc conjecture with
ε = 1/4 that there exists a constant K2 = K(1/4) such that
yn < xm ≤K2rad(xmyn)5/4 = K2rad(xy)5/4 ≤K2(xy)5/4,
and so
m log x ≤log K2 + 5
4 (log x + log y)
and
n log y < log K2 + 5
4 (log x + log y) .
It follows that
m log x + n log y < 2 log K2 + 5
2 (log x + log y) ,

5.4 The abc Conjecture
187
and so

m −5
2

log x +

n −5
2

log y < 2 log K2.
(5.7)
Since x ≥2 and y ≥2, we have
m + n < 2 log K2
log 2
+ 5.
Thus, there are only ﬁnitely many pairs of exponents (m, n) for which
the Catalan equation is solvable. For ﬁxed exponents m ≥3 and n ≥3,
equation (5.7) has only only ﬁnitely many solutions in positive integers x
and y. This completes the proof. 2
For every odd prime p we have 2p−1 ≡1
(mod p), that is, p divides
2p−1 −1. The question of the divisibility of 2p−1 −1 by p2 arose in the
study of Fermat’s last theorem. An odd prime p such that
2p−1 ̸≡1
(mod p2)
is called a Wieferich prime. For example, 3, 5, and 7 are Wieferich primes,
since 22 ̸≡1
(mod 9), 24 ̸≡1
(mod 25), and 26 ̸≡1
(mod 49). It is
not known whether inﬁnitely many Wieferich primes exist, nor is is known
whether there are inﬁnitely many primes that are not Wieferich primes.
Let W be the set of Wieferich primes. We shall show that the abc con-
jecture implies that W is inﬁnite. We begin with a simple lemma.
Lemma 5.1 Let p be an odd prime. If there exists a positive integer n such
that 2n ≡1
(mod p) but 2n ̸≡1
(mod p2), then p is a Wieferich prime.
Proof. Let d be the order of 2 modulo p. Then d divides n. Since 2n ̸≡1
(mod p2), it follows that 2d ̸≡1
(mod p2). Then 2d = 1 + kp, where
(k, p) = 1. Moreover, d divides p −1, since 2p−1 ≡1
(mod p), and so
p −1 = de for some integer e such that 1 ≤e ≤p −1. Then (ek, p) = 1 and
2p−1 = (2d)e = (1 + kp)e ≡1 + ekp ̸≡1
(mod p2),
and p is a Wieferich prime. 2
A powerful number is a positive integer v such that if a prime p divides
v, then p2 divides v. For example, 72 is powerful but 192 is not. If v is
powerful, then rad(v) ≤v1/2.
Theorem 5.11 The abc conjecture implies that there exist inﬁnitely many
Wieferich primes.

188
5. The abc Conjecture
Proof. Let W be the set of Wieferich primes. For every positive integer
n, we write
2n −1 = unvn,
where vn is the maximal powerful divisor of 2n−1. Then un is a square-free
integer,
un =

p|n
vp(n)=1
p,
and
vn =

p|n
vp(n)≥2
pvp(n).
If p divides un, then
2n ≡1
(mod p)
but
2n ̸≡1
(mod p2).
It follows from Lemma 5.1 that p ∈W, and so un is a square-free integer
divisible only by Wieferich primes.
If the set W is ﬁnite, then there exist only ﬁnitely many square-free
integers whose prime divisors all belong to W, and so the set {un : n =
1, 2, 3, . . .} is ﬁnite. It follows that the set {vn : n = 1, 2, 3, . . .} is inﬁnite,
and, consequently, unbounded. Since vn is powerful, we have
rad(vn) ≤v1/2
n .
Let 0 < ε < 1. Applying the abc conjecture to the identity
(2n −1) + 1 = 2n,
we obtain
vn
<
2n
≤
K(ε)rad(2n(2n −1))1+ε
≤
K(ε)rad(2unvn)1+ε
≤
K(ε)(2un)1+εrad(vn)1+ε
≪
v(1+ε)/2
n
.
This implies that the numbers vn are bounded, which is absurd. This com-
pletes the proof. 2

5.4 The abc Conjecture
189
Exercises
1. For a ﬁxed exponent n ≥4, prove that the Fermat equation xn+yn =
zn has at most a ﬁnite number of solutions in positive integers x, y, z.
Does this argument show that the cubic Fermat equation x3+y3 = z3
has at most ﬁnitely many solutions?
Hint: Apply the abc conjecture with ε = 1/6.
2. An integer n is powerful if vp(n) ̸= 1 for all primes p. Compute the
powerful numbers up to 100.
3. Let n ≥2 be an integer. Deﬁne the power of n by
power(n) =
log n
log rad(n).
Prove that power(n) = 1 if and only if n is square-free. Prove that
if n is powerful, then power(n) ≥2. Prove that if n is a kth power,
then power(n) ≥k.
4. (Granville) Prove that the abc conjecture implies that there exist only
ﬁnitely many triples of consecutive powerful numbers.
Hint: Suppose that n −1, n, n + 1 are three consecutive powerful
numbers. Apply the abc conjecture to the equation (n2 −1)+1 = n2.
Observe that
rad(n2(n2 −1))
=
rad((n −1)n(n + 1))
≤
-
(n −1)n(n + 1) < n3/2.
5. Let
U =
∞
,
k=3
{xk : x ∈N} = {ui}∞
i=1
be the set of nonsquare powers of the positive integers, where ui <
ui+1 for i = 1, 2, . . . . Prove that the abc conjecture implies
lim
i→∞(ui+1 −ui) = ∞.
6. Prove that the abc conjecture implies that the diophantine equation
n! + 1 = m2
has only ﬁnitely many solutions.
Hint: Apply the inequalities

p≤n
p < 4n

190
5. The abc Conjecture
(Theorem 8.1) and
1
n
n
e
n
< n! <
n
e
n
(Exercise 1 in Section 6.2).
7. Prove that the abc conjecture is false if we omit the condition (a, b, c) =
1.
Hint: Consider the equation 3k + 2 · 3k = 3k+1.
8. In this exercise we construct an example to show that the abc con-
jecture would be false if we replaced the exponent 1 + ε with 1.
(a) Prove that for every positive integer n there exists a positive
integer un such that
2nun + 1 = 32n−1.
Hint: Euler’s theorem.
(b) Let an = 2nun, bn = 1, and cn = 32n−1. Prove that
rad(anbncn) = rad (6un) < 6 · 32n−1
2n
.
(c) Let K(0) > 0. Prove that if n is suﬃciently large, then
K(0)rad(anbncn) < 6K(0)cn
2n
< cn = max(an, bn, cn).
Since an + bn = cn, this is the desired counterexample.
9. Let a and b be relatively prime positive integers. We deﬁne c = a + b
and
L(a, b) =
log c
log rad(abc) =
log(a + b)
log rad(ab(a + b)).
It is hard to ﬁnd relatively prime integers a and b for which L(a, b)
is large. Use the equation
2 + 310109 = 235
to compute L(2, 310109). In October,1999, this was the largest known
value for L(a, b).
10. Compute L(a, b) for a = 1 and b = 2 · 37.
11. Compute L(a, b) for a = 112 and b = 32 · 56 · 73.

5.5 The Congruence abc Conjecture
191
12. For n ≥1, deﬁne the positive integer tn by
9n = 1 + 8tn.
Prove that L(1, 8tn) > 1 and so
lim sup
(a,b)=1
L(a, b) ≥1.
It can be shown that the abc conjecture is equivalent to
lim sup
(a,b)=1
L(a, b) = 1.
5.5
The Congruence abc Conjecture
Let m ≥2. The congruence abc conjecture for m states that for every ε > 0
there exists a number K(m, ε) such that, if a, b, c are nonzero, relatively
prime integers with
abc ≡0
(mod m)
and
a + b = c,
then
max(|a|, |b|, |c|) ≤K(m, ε)rad(abc)1+ε.
This a weaker assertion than the abc conjecture, which is unrestricted by
any congruence condition. However, we shall prove that if the congruence
abc conjecture is true for some modulus m, then the unrestricted abc con-
jecture is also true.
We begin with some simple observations about triples (a, b, c) of integers
such that a + b = c. First, at least one of the integers a, b, or c must be
even, and so abc ≡0
(mod 2). Therefore, the congruence abc conjecture
for m = 2 is the same as the abc conjecture, and we need to consider only
moduli m ≥3. Second, if (a, b, c) = 1, then either c is odd and b −a is
odd, or c is even, both a and b are odd, and b −a is even. Third, if a, b, c
are distinct nonzero integers, then, by a permutation, we can assume that
they are positive and a < b < c.
Lemma 5.2 Let a, b, c be relatively prime positive integers such that
a < b < c
and
a + b = c.

192
5. The abc Conjecture
Let n ≥2. If c is odd, deﬁne
An
=
(b −a)n,
Bn
=
cn −(b −a)n,
Cn
=
cn.
If c is even, deﬁne
An
=
b −a
2
n
,
Bn
=
 c
2
n
−
b −a
2
n
,
Cn
=
 c
2
n
.
Then An, Bn, Cn are distinct, relatively prime positive integers such that
An + Bn = Cn.
If m ≥3 and n = ϕ(m), then
AnBnCn ≡0
(mod m).
Proof. It is left to the reader to show that An, Bn, Cn are distinct,
relatively prime positive integers such that An + Bn = Cn (Exercises 1, 2,
and 3).
Let m ≥3 and n = ϕ(m). Then n ≥2. We must prove that
AnBnCn ≡0
(mod m).
It suﬃces to prove that if p is a prime and pr divides m, then
AnBnCn ≡0
(mod pr).
(5.8)
Note that if p is a prime and pr divides m, then (p −1)pr−1 divides n, and
so
r ≤2r−1 ≤(p −1)pr−1 ≤n.
Suppose that p is an odd prime. If p divides c, then pn divides cn and pn
divides Cn. Since r ≤n, it follows that Cn ≡0
(mod pr). Similarly, if p
divides b−a, then An ≡0
(mod pr). If p divides neither c nor b−a, then,
by Theorem 2.12,
c(p−1)pr−1 ≡1
(mod pr)
and
(b −a)(p−1)pr−1 ≡1
(mod pr).
Since (p −1)pr−1 divides n, we have
cn ≡(b −a)n ≡1
(mod pr),

5.5 The Congruence abc Conjecture
193
and so Bn ≡0
(mod pr). This proves (5.8) for odd primes p.
Finally, we consider the prime 2. If 2r divides m, then 2r−1 divides n and
r ≤n. If c is even, then b −a is even and exactly one of the integers c and
b −a is divisible by 4 (Exercise 4). It follows that either cn or (b −a)n is
divisible by 4n, and so either Cn or An is divisible by 2n, which is divisible
by 2r.
If c is odd, then b −a is odd and
c2r−1 ≡(b −a)2r−1 ≡1
(mod 2r).
Since 2r−1 divides n, we have
Bn = cn −(b −a)n ≡0
(mod 2r).
This proves (5.8) for the prime 2. 2
Theorem 5.12 Let m ≥3. If the congruence abc conjecture is true for m,
then the abc conjecture is true.
Proof. Let 0 < ε < 1. For triples a, b, c of distinct, relatively prime
positive integers such that a + b = c, we deﬁne the function
Φε(a, b, c) = log c −(1 + ε) log rad(abc).
Then
log rad(a, b, c) = log c −ε log c
1 + ε −Φε(a, b, c)
1 + ε
.
Let A, B, C be distinct, relatively prime positive integers such that ABC ≡
0
(mod m) and A + B = C. If the congruence abc conjecture is true for
m, then there exists a constant K(m, ε) > 0 such that
C ≤K(m, ε)rad(ABC)1+ε,
or, equivalently,
Φε(A, B, C) ≤log K(m, ε) = K∗(m, ε).
Let a, b, c be relatively prime positive integers such that a < b < c and
a + b = c. Let
n = ϕ(m).
Then n is even, by Exercise 4 in Section 2.3. Deﬁne the integers An, Bn, Cn
as in Lemma 5.2. Then AnBnCn ≡0
(mod m) and An + Bn = Cn.
Moreover,
Φε(An, Bn, Cn) ≤K∗(m, ε).

194
5. The abc Conjecture
The integer n is even, since m ≥3, and so, by Exercise 5,
Bn
=
cn −(b −a)n
=
(b + a)n −(b −a)n
=
4ab

(b + a)n−2 + (b + a)n−4(b −a)2 + · · · + (b −a)n−2
≤
4ab
n
2

(b + a)n−2
=
2abncn−2.
Since
AnBnCn = (b −a)n
Bn
ab

abcn,
it follows that
rad(AnBnCn)
=
rad

(b −a)n
Bn
ab

abcn

=
rad

(b −a)
Bn
ab

abc

≤
rad(b −a)rad
Bn
ab

rad(abc)
≤
(b −a)
Bn
ab

rad(abc)
≤
(b −a)

2ncn−2
rad(abc)
≤
2ncn−1rad(abc).
Therefore,
log rad(AnBnCn)
≤
(n −1) log c + log rad(abc) + log 2n
=
n log c −ε log c
1 + ε −Φε(a, b, c)
1 + ε
+ log 2n
=

1 −
ε
(1 + ε)n

log cn −Φε(a, b, c)
1 + ε
+ log 2n
≤

1 −
ε
(1 + ε)n

(log Cn + n log 2) −Φε(a, b, c)
1 + ε
+ log 2n
≤
n + (n −1)ε
(1 + ε)n

log Cn −Φε(a, b, c)
1 + ε
+ 2n log n.
Equivalently,
Φε(a, b, c)
≤
n + (n −1)ε
n
 
log Cn −

(1 + ε)n
n + (n −1)ε

log rad(AnBnCn)

+ 2(1 + ε)n log 2
<
2

log Cn −

(1 + ε)n
n + (n −1)ε

log rad(AnBnCn)

+ 4n log 2
=
2 (log Cn −(1 + ε′) log rad(AnBnCn)) + 4n log 2,

5.5 The Congruence abc Conjecture
195
where
ε′ =
(1 + ε)n
n + (n −1)ε −1 =
ε
ϕ(m) + (ϕ(m) −1)ε.
Since
log Cn −(1 + ε′) log rad(AnBnCn) = Φε′(An, Bn, Cn) ≤K∗(ε′, m),
it follows that
Φε(a, b, c) < 2K∗(ε′, m) + 4ϕ(m) log 2.
Thus, for every ε > 0, the function Φε(a, b, c) is bounded above, and this
is equivalent to the abc conjecture. This completes the proof. 2
Exercises
1. Let a, b, c positive integers such that (a, b, c) = 1 and a+b = c. Prove
that (a, b) = (a, c) = (b, c) = 1. Prove that a = b only if a = 1 and
c = 2.
2. Let a, b, c be relatively prime positive integers such that c is odd,
a < b < c, and
a + b = c.
For every positive integer n, deﬁne
An
=
(b −a)n,
Bn
=
cn −(b −a)n,
Cn
=
cn.
Prove that An, Bn, and Cn are distinct, relatively prime positive
integers such that
An + Bn = Cn.
3. Let a, b, and c be relatively prime positive integers such that c is
even, a < b < c, and
a + b = c.
For every positive integer n, deﬁne
An
=
b −a
2
n
,
Bn
=
 c
2
n
−
b −a
2
n
,
Cn
=
 c
2
n
.

196
5. The abc Conjecture
Prove that An, Bn, and Cn are distinct, relatively prime positive
integers such that
An + Bn = Cn.
4. Let a, b, c be relatively prime integers such that a + b = c. Prove if c
is even, then exactly one of the integers c and b −a is divisible by 4.
5. Prove that if n is even, then
(b+a)n−(b−a)n = 4ab

(b + a)n−2 + (b + a)n−4(b −a)2 + · · · + (b −a)n−2
.
5.6
Notes
One of the most fruitful analogies in mathematics is that be-
tween the integers Z and the ring of polynomials F[t] over a
ﬁeld F.
S. Lang [89, p. 196]
There are beautiful survey articles on the abc conjecture by Lang, “Old
and new conjectured diophantine inequalities” [88], Nitaj, “La conjecture
abc’ [113], and Brzezi´nski, “The abc-conjecture” [15]. Part of Lang’s article
appears in his Algebra [89, pages 194–200], which is a highly recommended
reference for all matters algebraical.
The abc conjecture was motivated in part by Mason’s theorem, which is
a polynomial analogue of the abc conjecture (see Mason [97]), and in part
by a conjecture of Szpiro on the discriminants of elliptic curves (Lang [88]).
According to Oesterl´e [114, pp. 167–169], Szpiro had discussed this conjec-
ture in a lecture in Hanover in 1983; the abc conjecture arose in a discussion
between Masser and Oesterl´e in 1985.
Browkin and Brzezi´nski [14] contains considerable data on the values of
the function L(a, b), discussed in Exercises (9)–(12), as well as a conjectured
generalization of the abc conjecture to equations of the form a1 +a2 +· · ·+
an = 0. The proof that the congruence abc conjecture implies the abc
conjecture is due to Ellenberg [27].
Fermat’s last theorem was proved by Taylor and Wiles [139, 156] in
1995. For a diﬀerent proof of Fermat’s last theorem for polynomials, see
Greenleaf [41]. For a proof that the Catalan equation has no solution in
polynomials or rational functions, see Nathanson [102].
V. A. Lebesgue [91] proved that the diophantine equation xm = y2 + 1
has no solution in positive integers. Chao Ko [82] proved that the only
solution of x2 = ym + 1 in positive integers is x = m = 3 and y = 2.
Silverman [134] applied the abc conjecture to Wieferich primes (Theo-
rem 5.11). Wieferich [155] proved that if p is an odd prime such that the

5.6 Notes
197
Fermat equation
xp + yp = zp
has a solution in integers x, y, z with (p, xyz) = 1, then
2p−1 ≡1
(mod p2).
Computations [17] suggest that such primes are rare, and that “most”
primes are Wieferich primes. Indeed, 1093 and 3511 are the only primes p ≤
4 · 1022 that are not Wieferich primes. It is an open problem to determine
whether there exists a prime p that satisﬁes the following two congruences:
2p−1 ≡1
(mod p2)
and
3p−1 ≡1
(mod p2).

Part II
Divisors and Primes in
Multiplicative Number
Theory

6
Arithmetic Functions
6.1
The Ring of Arithmetic Functions
An arithmetic function is a complex-valued function whose domain is the
set of positive integers. For example, the divisor function d(n) and the Euler
phi function ϕ(n) are arithmetic functions.
The pointwise sum f + g of the arithmetic functions f and g is deﬁned
by
(f + g)(n) = f(n) + g(n).
(6.1)
There are two natural ways to multiply arithmetic functions f and g. The
ﬁrst is the pointwise product f · g, deﬁned by
f · g(n) = f(n)g(n).
The second is the Dirichlet convolution f ∗g, deﬁned by
(f ∗g)(n) =

d|n
f(d)g(n/d) =

dd′=n
f(d)g(d′),
(6.2)
where the sum is over all positive divisors d of n. Dirichlet convolution
occurs frequently in multiplicative problems in elementary number theory.
We deﬁne the arithmetic function δ(n) by
δ(n) =

1
if n = 1,
0
if n ≥2,
and the zero function 0(n) by 0(n) = 0 for all n.

202
6. Arithmetic Functions
Theorem 6.1 The set of all complex-valued arithmetic functions, with ad-
dition deﬁned by pointwise sum and multiplication deﬁned by Dirichlet con-
volution, is a commutative ring with additive identity 0(n) and multiplica-
tive identity δ(n).
Proof. It is easy to check that the set of arithmetic functions is an
additive abelian group with the zero function as the additive identity.
We shall prove that Dirichlet convolution is commutative, associative,
and distributes over addition, that is,
f ∗g = g ∗f,
(f ∗g) ∗h = f ∗(g ∗h),
and
f ∗(g + h) = f ∗g + f ∗h
for all arithmetic functions f, g, and h. These are straightforward calcula-
tions. We have
f ∗g(n) =

d|n
f(d)g(n/d) =

d|n
g(n/d)f(d) =

d|n
g(d)f(n/d) = g ∗f(n)
and
((f ∗g) ∗h)(n)
=

d|n
(f ∗g)(d)h
n
d

=

dm=n
(f ∗g)(d)h(m)
=

dm=n

kℓ=d
f(k)g(ℓ)h(m)
=

kℓm=n
f(k)g(ℓ)h(m)
=

k|n
f(k)

ℓm=n/k
g(ℓ)h(m)
=

k|n
f(k)

ℓ|(n/k)
g(ℓ)h
 n
kℓ

=

k|n
f(k)(g ∗h)
n
k

=
(f ∗(g ∗h))(n).
Similarly,
f ∗(g + h)(n)
=

d|n
f(d)(g(n/d) + h(n/d))

6.1 The Ring of Arithmetic Functions
203
=

d|n
f(d)g(n/d) +

d|n
f(d)h(n/d)
=
f ∗g(n) + f ∗h(n).
Finally, we observe that
δ ∗f(n) =

d|n
δ(d)f(n/d) = f(n)
for every arithmetic function f, and so the arithmetic functions form a
commutative ring with multiplicative identity δ(n). This completes the
proof. 2
Recall that a derivation on a ring R is an additive homomorphism D :
R →R such that
D(xy) = D(x)y + xD(y)
for all x, y ∈R.
Theorem 6.2 Consider the arithmetic function L(n) deﬁned by
L(n) = log n
for all n ≥1.
Pointwise multiplication by L(n) is a derivation on the ring of arithmetic
functions.
Proof. Observe that if d is a positive divisor of n, then
L(n) = L(d) + L(n/d).
We must prove that
L · (f ∗g) = (L · f) ∗g + f ∗(L · g)
for all arithmetic functions f and g. We have
L · (f ∗g)(n)
=
L(n)

d|n
f(d)g(n/d)
=

d|n
L(n)f(d)g(n/d)
=

d|n
(L(d) + L(n/d))f(d)g(n/d)
=

d|n
L(d)f(d)g(n/d) +

d|n
f(d)L(n/d)g(n/d)
=
(L · f) ∗g + f ∗(L · g).
This completes the proof. 2

204
6. Arithmetic Functions
Exercises
1. Deﬁne the arithmetic function 1(n) by 1(n) = 1 for all n. Prove that
1 ∗1(n) = d(n).
2. For every positive integer k, let dk(n) denote the number of k-tuples
of positive integers (a1, a2, . . . , ak) such that n = a1a2 · · · ak. Prove
that
dk(n) = 1 ∗1 ∗· · · ∗1
&
'(
)
k times
(n).
3. Let f and g be arithmetic functions. Prove that f ∗g = 0 if and only
if f = 0 or g = 0. It follows that the ring of arithmetic functions is
an integral domain.
4. Let A be the ring of complex-valued arithmetic functions. An arith-
metic function f is called a unit in A if there exists an arithmetic
function g such that f ∗g = δ. Prove that f ∈A is a unit if and only
if f(1) ̸= 0.
5. For every positive integer N, let IN be the set of all arithmetic func-
tions f(n) such that f(n) = 0 for all n ≤N. Prove that IN is an
ideal in the ring of arithmetic functions.
6. Let f and g be arithmetic functions. Prove that
Ln(f ∗g) =
n

k=0
n
k

Ln−kf ∗Lkg.
7. Let J be the additive abelian semigroup consisting of all sequences
J = {ji}∞
i=1 of nonnegative integers such that ji = 0 for all suﬃciently
large i. Addition of elements in J is deﬁned coordinate-wise.
Let t1, t2, . . . be an inﬁnite sequence of variables. For every J ∈J we
deﬁne the monomial
tJ =

ji≥1
tji
i .
If J is the sequence with ji = 0 for all i, then tJ = 1. Let R be the
set of all expressions of the form

J∈J
aJtJ,
where the coeﬃcients aj are complex numbers. We deﬁne the sum
and product of elements of R by

J∈J
aJtJ +

J∈J
bJtJ =

J∈J
(aJ + bJ)tJ

6.1 The Ring of Arithmetic Functions
205
and
 
J1∈J
aJ1tJ1
  
J2∈J
bJ2tJ2

=

J1,J2∈J
aJ1bJ2tJ1+J2.
Prove that R is an integral domain, that is, a commutative ring with
no zero divisors.
Remark. This ring is called the ring of formal power series in in-
ﬁnitely many variables t1, t2 . . . with coeﬃcients in C. It is denoted
by C[[t1, t2, . . .]].
8. Let P = {p1, p2, p3, . . .} be the sequence of primes in ascending order,
that is, p1 = 2, p2 = 3, p3 = 5, . . . . By the fundamental theorem of
arithmetic, to every positive integer n we can associate a sequence
Jn ∈J as follows: If
n =
∞

i=1
p
vpi(n)
i
,
then
Jn = {vpi(n)}∞
i=1.
Prove that this is a bijection between N and J .
9. Let A be the ring of complex-valued arithmetic functions. For every
arithmetic function f ∈A we deﬁne the formal power series
Φ(f) =

n∈N
f(n)tJn ∈C[[t1, t2, . . .]],
where Jn ∈J is the sequence constructed in Exercise 8. Prove that
the map
Φ : A →C[[t1, t2, . . .]]
is a ring isomorphism.
Remark. Since the ring of formal power series in inﬁnitely many vari-
ables is a unique factorization domain, it follows that the ring of
complex-valued arithmetic functions is also a unique factorization
domain.
10. For arithmetic functions f and g, deﬁne the product f ⋆g by
f ⋆g(n) =
n−1

k=1
f(k)g(n −k).
Is this product commutative? Is it associative? What is f ⋆δ?

206
6. Arithmetic Functions
6.2
Mean Values of Arithmetic Functions
We deﬁne the mean value F(x) of an arithmetic function f(n) by
F(x) =

n≤x
f(n),
where the sum is over all positive integers n ≤x. In particular, F(x) = 0
for x < 1. The function F(x) is also called the sum function of f. We
shall describe two simple but powerful tools for estimating sum functions in
number theory. The ﬁrst is integration and the second is partial summation.
The integer part of the real number x, denoted by [x], is the unique
integer n such that n ≤x < n + 1. The fractional part of x is the real
number {x} = x −[x] ∈[0, 1). For example,

−5
3

= −2 and

−5
3

= 1
3.
Every real number x can be written uniquely in the form x = [x] + {x}.
A function f(t) is unimodal on an interval I if there exists a number
t0 ∈I such that f(t) is increasing for t ≤t0 and decreasing for t ≥t0. For
example, the function f(t) = logk t/t is unimodal on the interval [1, ∞)
with t0 = ek.
It is proved in real analysis that every function that is monotonic or
unimodal on a closed interval [a, b] is integrable.
Theorem 6.3 Let a and b be integers with a < b, and let f(t) be a function
that is monotonic on the interval [a, b]. Then
min(f(a), f(b)) ≤
b

n=a
f(n) −
# b
a
f(t)dt ≤max(f(a), f(b)).
(6.3)
Let x and y be real numbers with y < [x], and let f(t) be a nonnegative
monotonic function on [y, x]. Then


y<n≤x
f(n) −
# x
y
f(t)dt

≤max(f(y), f(x)).
(6.4)
If f(t) is a nonnegative unimodal function on [1, ∞), then
F(x) =

n≤x
f(n) =
# x
1
f(t)dt + O(1).
(6.5)
Proof. If f(t) is increasing on [n, n + 1], then
f(n) ≤
# n+1
n
f(t)dt ≤f(n + 1).
If f(t) is increasing on the interval [a, b], then
f(a) +
# b
a
f(t)dt ≤
b

n=a
f(n) ≤f(b) +
# b
a
f(t)dt.

6.2 Mean Values of Arithmetic Functions
207
Similarly, if f(t) is decreasing on the interval [n, n + 1], then
f(n + 1) ≤
# n+1
n
f(t)dt ≤f(n).
If f(t) is decreasing on the interval [a, b], then
f(b) +
# b
a
f(t)dt ≤
b

n=a
f(n) ≤f(a) +
# b
a
f(t)dt.
This proves (6.3).
Let f(t) be nonnegative and monotonic on the interval [y, x]. Let a =
[y] + 1 and b = [x]. We have y < a ≤b ≤x. If f(t) is increasing, then

y<n≤x
f(n)
=

a≤n≤b
f(n)
≤
# b
a
f(t)dt + f(b)
≤
# x
y
f(t)dt + f(x).
Since
f(a) ≥
# a
y
f(t)dt
and
f(x) ≥
# x
b
f(t)dt,
it follows that

y<n≤x
f(n)
≥
# b
a
f(t)dt + f(a)
≥
# x
y
f(t)dt −
# x
b
f(t)dt + f(a) −
# a
y
f(t)dt
≥
# x
y
f(t)dt −f(x).
Therefore,


y<n≤x
f(n) −
# y
x
f(t)dt

≤f(x).
If f(t) is decreasing, then

y<n≤x
f(n)
=

a≤n≤b
f(n)

208
6. Arithmetic Functions
≤
# b
a
f(t)dt + f(a)
≤
# x
y
f(t)dt + f(y).
Since
f(b) ≥
# x
b
f(t)dt
and
f(y) ≥
# a
y
f(t)dt,
it follows that

y<n≤x
f(n)
≥
# b
a
f(t)dt + f(b)
≥
# x
y
f(t)dt + f(b) −
# x
b
f(t)dt −
# a
y
f(t)dt
≥
# x
y
f(t)dt −f(y)
and


y<n≤x
f(n) −
# y
x
f(t)dt

≤f(y).
This proves (6.4).
If the function f(t) is nonnegative and unimodal on [1, ∞), then f(t) is
bounded and (6.5) follows from (6.4). 2
Theorem 6.4 For x ≥2,

n≤x
log n = x log x −x + O (log x) .
Proof. The function f(t) = log t is increasing on [1, x]. By Theorem 6.3,
# x
1
log tdt ≤

n≤x
log n ≤
# x
1
log tdt + log x,
and so

n≤x
log n = x log x −x + O(log x).
This completes the proof. 2

6.2 Mean Values of Arithmetic Functions
209
Theorem 6.5 Let r be a nonnegative integer. For x ≥1,

n≤x
logr n
n
=
1
r + 1 logr+1 x + O(1),
where the implied constant depends only on r.
Proof. The function f(t) = logr t/t is nonnegative and unimodal on
[1, ∞) with maximum value (r/e)r at t0 = er. By Theorem 6.3,

n≤x
logr n
n
=
# x
1
logr tdt
t
+ O(1) =
1
r + 1 logr+1 x + O(1).
This completes the proof. 2
Theorem 6.6 Let k be a nonnegative integer. For x ≥1,

n≤x
logk(x/n)
n
=
1
k + 1 logk+1 x + O(logk x),
where the implied constant depends only on k.
Proof. The idea is to expand logk(x/n) by the binomial theorem and
apply Theorem 6.5. We have

n≤x
logk(x/n)
n
=

n≤x
(log x −log n)k
n
=

n≤x
1
n
k

r=0
k
r

(−1)r logk−r x logr n
=
k

r=0
k
r

(−1)r logk−r x

n≤x
logr n
n
=
k

r=0
k
r

(−1)r logk−r x

1
r + 1 logr+1 x + O(1)

=
k

r=0
k
r
(−1)r
r + 1 logk+1 x + O
 k

r=0
k
r

logk−r x

=
1
k + 1 logk+1 x + O(logk x),
since
k

r=0
(−1)r
r + 1
k
r

=
1
k + 1

210
6. Arithmetic Functions
by Exercise 8. 2
Theorem 6.7 Let k be a positive integer. Then

n1···nk≤x
1
n1 · · · nk
= 1
k! logk x + O(logk−1 x),
where 
n1···nk≤x denotes the sum over all k-tuples of positive integers
(n1, . . . , nk) such that n1 · · · nk ≤x.
Proof. By induction on k. For k = 1, we set r = 0 in Theorem 6.5 and
obtain

n1≤x
1
n1
= log x + O(1).
Assume that the result holds for the positive integer k. Then

n1···nknk+1≤x
1
n1 · · · nknk+1
=

nk+1≤x
1
nk+1

n1···nk≤x/nk+1
1
n1 · · · nk
=

nk+1≤x
1
nk+1
 1
k! logk(x/nk+1) + O(logk−1(x/nk+1))

=

nk+1≤x
1
k!nk+1
(log x −log nk+1)k
+ O

logk−1 x

nk+1≤x
1
nk+1


=

n≤x
1
k!n (log x −log n)k + O

logk x

.
We use the binomial theorem and Theorem 6.5 to compute the main term.

n≤x
1
k!n (log x −log n)k
=

n≤x
1
k!n
k

r=0
(−1)r
k
r

logk−r x logr n
=
k

r=0
(−1)r
k!
k
r

logk−r x

n≤x
logr n
n
=
k

r=0
(−1)r
k!
k
r

logk−r x

1
r + 1 logr+1 x + O(1)


6.2 Mean Values of Arithmetic Functions
211
=
1
k! logk+1 x
k

r=0
(−1)r
r + 1
k
r

+ O

logk x

=
1
(k + 1)! logk+1 x + O

logk x

,
by Exercise 8. 2
Theorem 6.8 (Partial summation) Let f(n) and g(n) be arithmetic func-
tions. Consider the sum function
F(x) =

n≤x
f(n).
Let a and b be nonnegative integers with a < b. Then
b

n=a+1
f(n)g(n)
=
F(b)g(b) −F(a)g(a + 1)
−
b−1

n=a+1
F(n)(g(n + 1) −g(n)).
(6.6)
Let x and y be nonnegative real numbers with [y] < [x], and let g(t) be a
function with a continuous derivative on the interval [y, x]. Then

y<n≤x
f(n)g(n) = F(x)g(x) −F(y)g(y) −
# x
y
F(t)g′(t)dt.
(6.7)
In particular, if x ≥2 and g(t) is continuously diﬀerentiable on [1, x], then

n≤x
f(n)g(n) = F(x)g(x) −
# x
1
F(t)g′(t)dt.
(6.8)
Proof. Identity (6.6) is a straightforward calculation:
b

n=a+1
f(n)g(n)
=
b

n=a+1
(F(n) −F(n −1))g(n)
=
b

n=a+1
F(n)g(n) −
b−1

n=a
F(n)g(n + 1)
=
F(b)g(b) −F(a)g(a + 1) −
b−1

n=a+1
F(n)(g(n + 1) −g(n)).

212
6. Arithmetic Functions
If the function g(t) is continuously diﬀerentiable on [y, x], then
g(n + 1) −g(n) =
# n+1
n
g′(t)dt.
Since F(t) = F(n) for n ≤t < n + 1, it follows that
F(n) (g(n + 1) −g(n)) =
# n+1
n
F(t)g′(t)dt.
Let a = [y] and b = [x]. Since a ≤y < a + 1 ≤b ≤x < b + 1, we have

y<n≤x
f(n)g(n)
=
b

n=a+1
f(n)g(n)
=
F(b)g(b) −F(a)g(a + 1) −
b−1

n=a+1
F(n)(g(n + 1) −g(n))
=
F(x)g(b) −F(y)g(a + 1) −
b−1

n=a+1
# n+1
n
F(t)g′(t)dt
=
F(x)g(x) −F(y)g(y) −F(x)(g(x) −g(b)) −F(y)(g(a + 1) −g(y))
−
# b
a+1
F(t)g′(t)dt
=
F(x)g(x) −F(y)g(y) −
# x
y
F(t)g′(t)dt.
This proves (6.7).
If x ≥2 and g(t) is continuously diﬀerentiable on [1, x], then

n≤x
f(n)g(n)
=
f(1)g(1) +

1<n≤x
f(n)g(n)
=
f(1)g(1) + F(x)g(x) −F(1)g(1) −
# x
1
F(t)g′(t)dt
=
F(x)g(x) −
# x
1
F(t)g′(t)dt.
This proves (6.8). 2
Letting r = 0 in Theorem 6.5, we obtain 
n≤x 1/n = log x+O(1). Using
partial summation, we can obtain a more precise result.

6.2 Mean Values of Arithmetic Functions
213
Theorem 6.9 For x ≥1,

n≤x
1
n = log x + γ + r(x),
where
0 < γ = 1 −
# ∞
1
{t}
t2 dt < 1
and
|r(x)| < 1
x.
The number γ = 0.577 . . . is called Euler’s constant. A famous unsolved
problem in number theory is to determine whether γ is rational or irra-
tional.
Proof. Since 0 ≤{t} < 1 for all t, we have
0 <
# ∞
1
{t}
t2 dt <
# ∞
1
1
t2 dt = 1,
and so γ ∈(0, 1).
We apply partial summation to the functions f(n) = 1 and g(t) = 1/t.
Then F(t) = 
n≤t 1 = [t] and

n≤x
1
n
=

n≤x
f(n)g(n)
=
[x]
x +
# x
1
[t]
t2 dt
=
1 −{x}
x
+
# x
1
1
t dt −
# x
1
{t}
t2 dt
=
log x +

1 −
# ∞
1
{t}
t2 dt

+
# ∞
x
{t}
t2 dt −{x}
x
=
log x + γ + r(x),
where
r(x) =
# ∞
x
{t}
t2 dt −{x}
x .
Moreover, |r(x)| < 1/x since 0 ≤{x}/x < 1 and
0 <
# ∞
x
{t}
t2 dt <
# ∞
x
1
t2 dt = 1
x.
2

214
6. Arithmetic Functions
Theorem 6.10 Let A = {ai}∞
i=1 be an inﬁnite set of positive integers with
a1 < a2 < a3 < · · ·. If
A(x) =

ai≤x
1 = O

x
log2 x

for x ≥2, then the series
∞

i=1
1
ai
converges.
Proof. Let χA(n) be the characteristic function of A, that is,
χA(n) =

1
if n ∈A,
0
if n ̸∈A.
There exists a number c such that
A(x) =

n≤x
χA(n) ≤
cx
log2 x
for all x ≥2, and A(x) ≤1 for 1 ≤x < 2. Applying partial summation, we
obtain

ai≤x
1
ai
=

n≤x
χA(n)
n
=
A(x)
x
+
# x
1
A(t)dt
t2
≤
c
log2 x + 1
2 + c
# x
2
dt
t log2 t
=
c
log2 x + 1
2 + c
# log x
log 2
du
u2
<
∞.
This completes the proof. 2
Theorem 6.11 For x ≥2,

n≤x
log2 n = x log2 x −2x log x + 2x + O

log2 x

.

6.2 Mean Values of Arithmetic Functions
215
Proof. We use partial summation with f(n) = 1 and g(t) = log2 t. Then
F(t) = [t] and g′(t) = 2 log t/t. Then

n≤x
log2 n
=
[x] log2 x −2
# x
1
[t] log t
t
dt
=
(x −{x}) log2 x −2
# x
1
(t −{t}) log t
t
dt
=
x log2 x + O(log2 x) −2
# x
1
log tdt + 2
# x
1
{t} log t
t
dt
=
x log2 x −2x log x + 2x + O(log2 x).
This completes the proof. 2
Theorem 6.12 For x ≥2,

n≤x
log2 x
n = 2x + O

log2 x

.
Proof. From Theorem 6.4 and Theorem 6.11, we obtain

n≤x
log2 x
n
=

n≤x
(log x −log n)2
=

n≤x
(log2 x −2 log x log n + log2 n)
=
[x] log2 x −2 log x

n≤x
log n +

n≤x
log2 n
=
x log2 x −2 log x(x log x −x) + x log2 x −2x log x + 2x + O

log2 x

=
2x + O

log2 x

.
This completes the proof. 2
Exercises
1. Prove that
e
n
e
n
< n! < en
n
e
n
.
Hint: Use partial summation to estimate log n!.
2. Let f(n) be an arithmetic function such that
F(x) =

n≤x
f(n) = O(x).

216
6. Arithmetic Functions
Prove that

n≤x
f(n)
n
= O(log x).
3. Prove that

n≤x
1
n1/2 = 2x1/2 −

1 +
# ∞
1
{t}
2t3/2 dt

+ O

x−1/2
.
4. For 0 < a < 1, let
γ(a) =
a
1 −a + a
# ∞
1
{t}
ta+1 dt.
Prove that

n≤x
1
na = x1−a
1 −a −γ(a) + O

x−a
.
5. Prove that

n≤x
logk n = x logk x + O(x logk−1 x)
for all positive integers k.
6. Prove that

n≤x
log x
n = x + O(log x).
7. Prove that

n≤x
logk x
n = k!x + O(logk x)
for all positive integers k.
8. Prove that for every nonnegative integer k,
k

r=0
(−1)r
r + 1
k
r

=
1
k + 1.
9. Prove that for every positive integer j,
r

n=1
nj = rj+1
j + 1 + O(rj).

6.3 The M¨obius Function
217
10. Let a, b and k be positive integers, with a < b and k ≥2. Prove that
b

n=a
1
n2 =
1
b −1
a

+ O
 1
a2

.
Prove that
b

n=a
1
nk =
1
k −1

1
bk−1 −
1
ak−1

+ O
 1
ak

.
11. Prove that

n≤x
1
1 + n log n = O(log log x).
6.3
The M¨obius Function
The M¨obius function µ(n) is deﬁned as follows:
µ(n) =



1
if n = 1,
(−1)k
if n is the product of k distinct primes,
0
if n is divisible by the square of a prime.
We have
µ(1)
=
1,
µ(6)
=
1,
µ(2)
=
−1,
µ(7)
=
−1,
µ(3)
=
−1,
µ(8)
=
0,
µ(4)
=
0,
µ(9)
=
0,
µ(5)
=
−1,
µ(10)
=
1.
An integer is called square-free if it is not divisible by the square of a prime.
Thus, µ(n) ̸= 0 if and only if n is square-free.
Recall that an arithmetic function f(n) is multiplicative if f(mn) =
f(m)f(n) whenever (m, n) = 1.
Theorem 6.13 The M¨obius function µ(n) is multiplicative, and

d|n
µ(d) =

1
if n = 1,
0
if n > 1.
(6.9)
Proof. Multiplicativity follows immediately from the deﬁnition of the
M¨obius function, since if m and n are relatively prime square-free integers
with k and ℓprime factors, respectively, then mn is square-free with k + ℓ
factors, and
µ(m)µ(n) = (−1)k(−1)ℓ= (−1)k+ℓ= µ(mn).

218
6. Arithmetic Functions
Next we prove the convolution formula (6.9). If n = 1, then

d|n
µ(d) = µ(1) = 1.
For n ≥2, let
n = pr1
1 · · · prk
k
be the standard factorization of the integer n. Then r ≥1. Recall that the
radical of n is the largest square-free divisor of n, that is,
rad(n) = p1 · · · pr
is the product of the distinct primes dividing n. Let m = rad(n). If d divides
n and µ(d) ̸= 0, then d is square-free, and so d divides m. Since m is the
product of k primes, it follows that there are exactly
k
i

divisors of m that
can be written as the product of i distinct primes, that is, the number of
divisors d of m such that ω(d) = i is
k
i

. Therefore,

d|n
µ(d)
=

d|m
µ(d)
=
k

i=0

d|m
ω(d)=i
µ(d)
=
k

i=0

d|m
ω(d)=i
(−1)i
=
k

i=0
k
i

(−1)i
=
(1 −1)k
=
0.
This completes the proof.
We deﬁned the arithmetic function 1(n) by 1(n) = 1 for all n. Using the
Dirichlet convolution, we can restate Theorem 6.13 as follows:
µ ∗1 = δ,
and so the M¨obius function µ is a unit with inverse 1.
Theorem 6.14 (M¨obius inversion) If f is any arithmetic function, and
g is the arithmetic function deﬁned by
g(n) =

d|n
f(d),

6.3 The M¨obius Function
219
then
f(n) =

d|n
µ
n
d

g(d).
Similarly, if g is any arithmetic function, and f is the arithmetic function
deﬁned by
f(n) =

d|n
µ
n
d

g(d),
then
g(n) =

d|n
f(d).
Proof. We use Theorem 6.13 and the commutativity and associativity
of Dirichlet convolution. The deﬁnition
g(n) =

d|n
f(d)
is equivalent to
g = f ∗1.
Then
g ∗µ = (f ∗1) ∗µ = f ∗(1 ∗µ) = f ∗δ = f.
Similarly, if
f = g ∗µ,
then
f ∗1 = (g ∗µ) ∗1 = g ∗(µ ∗1) = g ∗δ = g.
This completes the proof. 2
The following result gives a useful identity for sum functions of arithmetic
functions. The proof can be described geometrically as a sum over the
lattice points (m, d) under the hyperbola v = x/u in the positive quadrant
of the uv-plane.
Theorem 6.15 Let f(n) be an arithmetic function and
F(x) =

n≤x
f(n).
Then

m≤x
F
 x
m

=

d≤x
f(d)
.x
d
/
=

n≤x

d|n
f(d).

220
6. Arithmetic Functions
Proof. We have

m≤x
F
 x
m

=

m≤x

d≤x/m
f(d) =

dm≤x
f(d)
=

d≤x
f(d)

m≤x/d
1 =

d≤x
f(d)
.x
d
/
.
=

n≤x

d|n
f(d).
Also,

m≤x
F
 x
m

=

dm≤x
f(d) =

n≤x

d|n
f(d).
This completes the proof. 2
Theorem 6.16

n≤x
µ(n)
n
= O(1).
Proof. Applying Theorem 6.15 with f(n) = µ(n) and
M(x) =

n≤x
µ(n),
we obtain

m≤x
M
 x
m

=

d≤x
µ(d)
.x
d
/
=

n≤x

d|n
µ(d) = 1,
by Theorem 6.13. Since

d≤x
µ(d)
.x
d
/
= x

d≤x
µ(d)
d
−

d≤x
µ(d)
0x
d
1
= x

d≤x
µ(d)
d
+ O(x),
it follows that
x

d≤x
µ(d)
d
+ O(x) = 1.
Therefore,
x

d≤x
µ(d)
d
= O(x),
and so

d≤x
µ(d)
d
= O(1).

6.3 The M¨obius Function
221
This completes the proof. 2
Theorem 6.17

n≤x
µ(n)
n2
= 6
π2 + O
 1
x

.
Proof. The Riemann zeta function
ζ(s) =
∞

n=1
1
ns
converges absolutely for s > 1. Similarly, the function
G(s) =
∞

n=1
µ(n)
ns
converges absolutely for s > 1. Therefore,
ζ(s)G(s)
=
∞

k=1
1
ks
∞

d=1
µ(d)
ds
=
∞

k=1
∞

d=1
µ(d)
(kd)s
=
∞

n=1
1
ns

d|n
µ(d)
=
1,
by Theorem 6.13, and so
1
ζ(s) =
∞

n=1
µ(n)
ns
for s > 1. Since
ζ(2) =
∞

n=1
1
n2 = π2
6 ,
it follows that
1
ζ(2) =
∞

n=1
µ(n)
n2
= 6
π2 ,
and so


n≤x
µ(n)
n2
−6
π2

=


n>x
µ(n)
n2
 <

n>x
1
n2 ≪1
x.
This completes the proof. 2

222
6. Arithmetic Functions
Exercises
1. Compute µ(n) for 11 ≤n ≤30.
2. Let f(n) be an arithmetic function, and deﬁne g(n) = 
d|n f(d). Use
M¨obius inversion to write f(30) as a sum and diﬀerence of values of
the arithmetic function g.
3. Let d(n) be the divisor function. Prove that

k|n
d(k)µ
n
k

= 1
for every positive integer n.
Hint: Problem 1 in Section 6.1.
4. Let σ(n) denote the sum of the positive divisors of n, that is,
σ(n) =

k|n
k.
Prove that

k|n
σ(k)µ
n
k

= n
for every positive integer n.
5. Let f(x) be a function on the set of real numbers x ≥1. Deﬁne the
function g(x) by
g(x) =

n≤x
f
x
n

.
Prove that
f(x) =

n≤x
µ(n)g
x
n

.
6. Let g(x) be a function on the set of real numbers x ≥1. Deﬁne the
function f(x) by
f(x) =

n≤x
µ(n)g
x
n

.
Prove that
g(x) =

n≤x
f
x
n

.
7. Let α > 0. Let f(x) be a function on the set of real numbers x ≥1.
Deﬁne the function g(x) by
g(x) =

n≤x1/α
1
nα f
 x
nα

.

6.3 The M¨obius Function
223
Prove that
f(x) =

n≤x1/α
µ(n)
nα g
 x
nα

.
8. Let α > 0. Let g(x) be a function on the set of real numbers x ≥1.
Deﬁne the function f(x) by
f(x) =

n1/α≤x
µ(n)
nα g
 x
nα

.
Prove that
g(x) =

n≤x1/α
1
nα f
 x
nα

.
9. Prove that every positive integer n can be written uniquely in the
form n = k2ℓ, where k and ℓare positive integers and ℓis square-
free. Prove that
µ2(n) =

d2|n
µ(d).
10. Prove that the density of the square-free integers is 6/π2. Equiva-
lently, let Q(x) denote the number of square-free integers not exceed-
ing x. Prove that
lim
x→∞
Q(x)
x
= 6
π2 .
Hint: n is square-free if and only if µ2(n) = 1, and
Q(x) =

n≤x
µ2(n) =

d2≤x
µ(d)
. x
d2
/
= 6x
π2 + O(√x).
11. Deﬁne the von Mangoldt function
Λ(n) =

log p
if n = pk is a prime power,
0
otherwise.
Let
L(n) = log n.
Prove that
L = 1 ∗Λ
and
Λ(n) = −

d|n
µ(d) log d.

224
6. Arithmetic Functions
6.4
Multiplicative Functions
In this section we prove some general properties about multiplicative arith-
metic functions.
Theorem 6.18 If f is a multiplicative function, then
f([m, n])f((m, n)) = f(m)f(n)
for all positive integers m and n.
Proof. Let p1, . . . , pr be the prime numbers that divide m or n. Then
n =
r

i=1
pki
i
and
m =
r

i=1
pℓi
i ,
where k1, . . . , kr, ℓ1, . . . , ℓr are nonnegative integers. Then
[m, n] =
r

i=1
pmax(ki,ℓi)
i
and
(m, n) =
r

i=1
pmin(ki,ℓi)
i
.
Since
{max(ki, ℓi), min(ki, ℓi)} = {ki, ℓi}
and since f is multiplicative, it follows that
f([m, n])f((m, n))
=
r

i=1
f

pmax(ki,ℓi)
i

r

i=1
f

pmin(ki,ℓi)
i

=
r

i=1
f(pki
i )
r

i=1
f(pℓi
i )
=
f(m)f(n).
This completes the proof. 2
Theorem 6.19 Let f be a multiplicative function with f(1) = 1. Then

d|n
µ(d)f(d) =

p|n
(1 −f(p)).

6.4 Multiplicative Functions
225
Proof. The identity holds for n = 1. For n ≥2, let m = rad(n) be
the product of the distinct primes dividing n. Since µ(d) = 0 if d is not
square-free, it follows that

d|n
µ(d)f(d) =

d|m
µ(d)f(d) =

p|m
(1 −f(p)) =

p|n
(1 −f(p)).
This completes the proof. 2
The sequence of prime powers is the sequence
2, 3, 4, 5, 7, 8, 9, 11, 13, 16, 17, 19, 23, 25, 27, . . . .
The smallest power that is not a prime power is 36.
Theorem 6.20 Let f(n) be a multiplicative function. If
lim
pk→∞f(pk) = 0
as pk runs through the sequence of all prime powers, then
lim
n→∞f(n) = 0.
Proof. Since limpk→∞f(pk) = 0, it follows that there exist only ﬁnitely
many prime powers pk such that |f(pk)| ≥1, and so we can deﬁne
A =

|f(pk)|≥1
|f(pk)|.
Then A ≥1.
Let 0 < ε < 1. There exist only ﬁnitely many prime powers pk such that
|f(pk)| ≥ε/A, and so there are only ﬁnitely many integers n such that
|f(pk)| ≥ε
A
for every prime power pk that exactly divides n. Therefore, if n is suﬃciently
large, then n is divisible by at least one prime power pk such that |f(pk)| <
ε/A, and so n can be written in the form
n =
r

i=1
pki
i
r+s

i=r+1
pki
i
r+s+t

i=r+s+1
pki
i ,
where p1, . . . , pr+s+t are distinct prime numbers such that
|f(pki
i | ≥1
for i = 1, . . . , r,

226
6. Arithmetic Functions
ε
A ≤|f(pki
i | < 1
for i = r + 1, . . . , r + s,
|f(pki
i | < ε
A
for i = r + s + 1, . . . , r + s + t,
and
t ≥1.
Since f is multiplicative,
|f(n)| =
r

i=1
|f(pki
i )|
r+s

i=r+1
|f(pki
i )|
r+s+t

i=r+s+1
|f(pki
i )| < A(ε/A)t ≤ε.
This completes the proof. 2
Exercises
1. Let f be a multiplicative function. Prove that if f(1) = 0, then f is
identically equal to 0, that is, f(n) = 0 for all n. Prove that if f is
not identically equal to 0, then f(1) = 1.
2. Prove that a multiplicative function is completely determined by its
values on prime powers pk.
3. Prove that if f and g are multiplicative functions, then f ∗g is also
multiplicative.
4. Deﬁne the arithmetic functions ω(n) and Ω(n) as follows: If
n = pk1
1 · · · pkr
r
is the standard factorization of the positive integer n, then
ω(n) = r
is the number of distinct prime divisors of n, and
Ω(n) = k1 + · · · + kr
is the total number of prime factors of n. Prove that n is square-free if
and only if ω(n) = Ω(n). Prove that the arithmetic function (−1)ω(n)
is multiplicative.
5. An arithmetic function f is called completely multiplicative if f(mn) =
f(m)f(n) for all positive integers m and n. Prove that Liouville’s
function
λ(n) = (−1)Ω(n)

6.5 The mean value of the Euler Phi Function
227
is completely multiplicative. Prove that

d|n
λ(d) =

1
if n is a square,
0
otherwise.
6. Prove that for every δ > 0,
lim
n→∞
ϕ(n)
n1−δ = ∞.
Hint: Apply Theorem 6.20 to the multiplicative function f(n) =
n1−δ/ϕ(n). Observe that
0 <
pk(1−δ)
pk(1 −p−1) ≤
2
pkδ .
7. Prove that

p|n

1 −1
p2

≥
n

k=2

1 −1
k2

> 1
2.
Hint: Consider the identity
n

k=2

1 −1
k2

=
n

k=2
k −1
k

n

k=2
k + 1
k

.
8. Prove that
1
2 < ϕ(n)σ(n)
n2
< 1.
Hint: Observe that for every prime power pk,
ϕ(pk)σ(pk)
p2k
= 1 −
1
pk+1 ≥1 −1
p2 .
9. Prove that
n < σ(n) ≪n1+δ
for every δ > 0.
Hint: Apply Exercise 6 and Exercise 8.
6.5
The mean value of the Euler Phi Function
The Euler phi function is
ϕ(n) = n

p|n

1 −1
p

= n

d|n
µ(d)
d
=

d′d=n
d′µ(d).
(6.10)
We shall ﬁnd an asymptotic formula for the mean value of the Euler phi
function.

228
6. Arithmetic Functions
Theorem 6.21 For x ≥1,
Φ(x) =

n≤x
ϕ(n) = 3x2
π2 + O (x log x) .
Proof. We have
Φ(x)
=

n≤x
ϕ(n)
=

n≤x

d′d=n
d′µ(d)
=

d≤x
µ(d)

d′≤x/d
d′
=
1
2

d≤x
µ(d)
.x
d
/ .x
d
/
+ 1

=
1
2

d≤x
µ(d)
x
d
2
+ O
x
d

=
x2
2

d≤x
µ(d)
d2
+ O

x

d≤x
1
d


=
x2
2
∞

d=1
µ(d)
d2
−x2
2

d>x
µ(d)
d2
+ O (x log x)
=
3x2
π2 + O (x log x) .
This completes the proof. 2
Theorem 6.22 The probability that two positive integers are relatively
prime is 6/π2.
Proof. Let N ≥1. The number of ordered pairs of positive integers
(m, n) such that 1 ≤m ≤n ≤N is N +
N
2

= N(N + 1)/2. The number
of positive integers m ≤n that are relatively prime is ϕ(n), and so the
number of pairs of positive integers (m, n) such that 1 ≤m ≤n ≤N and
m and n are relatively prime is

n≤N
ϕ(n) = 3N 2
π2 + O (N log N) .
Therefore, the frequency of relatively prime pairs of positive integers not
exceeding N is
3N 2
π2 + O (N log N)
N(N + 1)/2
= 6
π2 + O
log N
N

−→6
π2

6.6 Notes
229
as N →∞. This completes the proof.
Exercises
1. Use M¨obius inversion to prove identity (6.10):
ϕ(n) = n

d|n
µ(d)
d
.
2. Prove that
lim sup
n→∞
ϕ(n)
n
= 1.
Hint: Consider ϕ(n) for n = p prime.
6.6
Notes
Everything in this chapter is classical number theory. For other elementary
results on arithmetic functions, see Hardy and Wright [60].
There is a vast literature on the distribution of values of arithmetic func-
tions. For a comprehensive survey of this ﬁeld, see Elliott, Probabilistic
Number Theory I, II [28, 29].

7
Divisor Functions
7.1
Divisors and Factorizations
The divisor function d(n) counts the number of positive divisors of n. Thus,
d(1)
=
1,
d(6)
=
4,
d(2)
=
2,
d(7)
=
2,
d(3)
=
2,
d(8)
=
4,
d(4)
=
3,
d(9)
=
3,
d(5)
=
2,
d(10)
=
4.
We can write down an explicit formula for d(n) in terms of the prime powers
that exactly divide n. Let
n =

p|n
pvp(n).
Every divisor d of n is of the form
d =

p|n
pap,
where ap is an integer such that
0 ≤ap ≤vp(n).
Since each exponent ap can be chosen in vp(n) + 1 ways, it follows that
d(n) =

p|n
(vp(n) + 1).

232
7. Divisor Functions
Theorem 7.1 The divisor function d(n) is multiplicative.
Proof. Let m and n be relatively prime integers,
m =

p|m
pvp(m)
and
n =

q|n
qvq(n).
Since (m, n) = 1, the set of primes that divide m and the set of primes that
divide n are disjoint. Therefore,
mn =

p|m
pvp(m) 
q|n
qvq(n)
is the standard factorization of mn, and
d(mn) =

p|m
(vp(m) + 1)

q|n
(vq(n) + 1) = d(m)d(n).
This completes the proof. 2
Theorem 7.2 For every ε > 0,
d(n) ≪ε nε.
Proof. Let ε > 0. The function f(n) = d(n)/nε is multiplicative. There-
fore, by Theorem 6.20, it suﬃces to prove that
lim
pk→∞f(pk) = 0
for every prime p. We observe that
k + 1
2kε/2
is bounded for k ≥1, and so
f(pk)
=
d(pk)
pkε
=
k + 1
pkε
=
k + 1
pkε/2
 
1
pkε/2

≤
k + 1
2kε/2
 
1
pkε/2

≪
1
pkε/2 .

7.1 Divisors and Factorizations
233
This completes the proof. 2
Theorem 7.3 For x ≥1,
D(x) =

n≤x
d(n) = x log x + (2γ −1)x + O(√x).
The problem of estimating the sum function D(x) is called Dirichlet’s
divisor problem.
Proof. We can interpret the divisor function d(n) and the sum function
D(x) geometrically. A lattice point in the plane is a point whose coordinates
are integers. A positive lattice point in the plane is a point whose coordinates
are positive integers. In the uv-plane,
d(n) =

d|n
1 =

n=uv
1
counts the number of lattice points (u, v) on the rectangular hyperbola
uv = n that lie in the quadrant u > 0, v > 0. The sum function D(x)
counts the number of lattice points in this quadrant that lie on or under
the hyperbola uv = x, that is, the number of positive lattice points (u, v)
such that 1 ≤u ≤x and 1 ≤v ≤x/u. These lattice points can be divided
into three pairwise disjoint classes:
(i)
1 ≤u ≤√x
and
1 ≤v ≤√x,
(ii)
1 ≤u ≤√x
and
√x < v ≤x/u,
(iii)
√x < u ≤x
and
1 ≤v ≤x/u.
The third class consists of the lattice points (u, v) such that
1 ≤v ≤√x
and
√x < u ≤x/v.
It follows from Theorem 6.9 that
D(x)
=
√x
2 +

1≤u≤√x
.x
u
/
−
√x

+

1≤v≤√x
.x
v
/
−
√x

=
√x
2 + 2

1≤u≤√x
.x
u
/
−
√x


234
7. Divisor Functions
=
2

1≤u≤√x
.x
u
/
−
√x
2
=
2

1≤u≤√x
x
u −
0x
u
1
−
√x −
√x
2
=
2x

1≤u≤√x
1
u −2

1≤u≤√x
0x
u
1
−x + O(√x)
=
2x

log √x + γ + O
 1
√x

−x + O(√x)
=
x log x + (2γ −1)x + O(√x).
This completes the proof. 2
Theorem 7.4 For x ≥1,
∆(x) =

n≤x
(log n −d(n) + 2γ) = O

x1/2
.
Proof. By Theorem 7.3 we have

n≤x
d(n) = x log x + (2γ −1)x + O

x1/2
.
By Theorem 6.4 we have

n≤x
log n = x log x −x + O(log x).
Subtracting the ﬁrst equation from the second, we obtain

n≤x
(log n −d(n) + 2γ) = O

x1/2
−2γ{x} + O(log x) = O

x1/2
.
2
An ordered factorization of the positive integer n into exactly ℓfactors
is an ℓ-tuple (d1, . . . , dℓ) such that n = d1 · · · dℓ. The divisor function d(n)
counts the number of ordered factorizations of n into exactly two factors,
since each factorization n = dd′ is completely determined by the ﬁrst factor
d. For every positive integer ℓ, we deﬁne the arithmetic function dℓ(n) as
the number of factorizations of n into exactly ℓfactors. Then d1(n) = 1
and d2(n) = d(n) for all n.

7.1 Divisors and Factorizations
235
Theorem 7.5 For every ℓ≥1, the function dℓ(n) is multiplicative, and
dℓ(pa) =
a + ℓ−1
ℓ−1

for all prime powers pa.
Proof. Let (m, n) = 1. For every ordered factorization of mn into ℓ
factors we can construct ordered factorizations of m and n into ℓparts, as
follows. If mn = d1 · · · dℓis an ordered factorization of mn into ℓparts,
then, by Exercise 20 in Section 1.4, for each i = 1, . . . , ℓthere exist unique
integers ei and fi such that ei divides m, fi divides n, and di = eifi.
Then m = e1 · · · eℓand n = f1 · · · fℓare ordered factorizations of m and n,
respectively. This construction is reversible, and so establishes a bijection
between ordered factorizations of mn and pairs of ordered factorizations of
m and n. It follows that dℓ(mn) = dℓ(m)dℓ(n), and so the divisor function
dℓis multiplicative.
An ordered factorization of the prime power pa can be written uniquely
in the form pa = pb1 · · · pbℓ, where (b1, . . . , bℓ) is an ordered ℓ-tuple of
nonnegative integers such that b1 + · · · + bℓ= a. It follows that dℓ(pa) is
exactly the number of ordered partitions of a into exactly ℓnonnegative
parts. Imagine a sequence of a+ℓ−1 red squares. If we choose ℓ−1 of these
squares and color them blue, then the remaining a red squares are divided
into exactly ℓsubsequences (possibly empty) of consecutive red squares,
separated by blue squares. Every ordered partition of a into ℓnonnegative
parts can be uniquely constructed in this way, and so dℓ(pa) is the number
of ways to choose ℓ−1 squares from a set of a + ℓ−1 squares, that is,
dℓ(pa) =
a + ℓ−1
ℓ−1

.
This completes the proof. 2
Theorem 7.6 For ℓ≥2,
Dℓ(x) =

n≤x
dℓ(n) =
1
(ℓ−1)!x logℓ−1 x + O

x logℓ−2 x

.
Proof. The proof is by induction on ℓ. By Theorem 7.3, D2(x) = x log x+
O(x). Now assume that the result holds for some integer ℓ≥2. The nota-
tion 
d1···dℓmeans a sum over all ordered ℓ-tuples (d1, . . . , dℓ) of positive
integers. Applying Theorem 6.7, we obtain
Dℓ+1(x)
=

n≤x
dℓ+1(n)

236
7. Divisor Functions
=

n≤x

d1···dℓ+1=n
1
=

n≤x

d1···dℓ|n
1
=

d1···dℓ≤x

x
d1 · · · dℓ

=
x

d1···dℓ≤x
1
d1 · · · dℓ
+ O



d1···dℓ≤x
1


=
x logℓx
ℓ!
+ O

x logℓ−1 x

+ O(Dℓ(x))
=
x logℓx
ℓ!
+ O

x logℓ−1 x

.
This completes the proof. 2
Exercises
1. Compute d(n) for 11 ≤n ≤20.
2. Prove that n is prime if and only if d(n) = 2.
3. Prove that d(n) is prime if and only if n = pq−1, where p and q are
prime numbers.
4. Prove that d(mn) ≤d(m)d(n) for all positive integers m and n.
5. Prove that

d|n
d = nd(n)/2.
6. Prove that

n≤x
d2(n) ≫x log2 x.
Hint: Apply the Cauchy–Schwarz inequality to D2(x).
Remark. In Theorem 7.8 we obtain an asymptotic formula for 
n≤x d2(n).
7. Let ω(n) denote the number of distinct prime divisors of n, and let
Ω(n) denote the total number of prime divisors of n. Prove that
2ω(n) ≤d(n) ≤2Ω(n).
Prove that d(n) = 2ω(n) if and only if n is square-free.

7.2 A Theorem of Ramanujan
237
8. Let δ > 0 and x ≥ee. Prove that the number of positive integers
n ≤x with d(n) ≥(log x)1+δ is O(x(log x)−δ).
Hint: D(x) = O(x log x).
9. Let r > 1 and x ≥ee. Prove that the number of positive integers
n ≤x with ω(n) ≥r log log x is O

x(log x)1−r log 2
.
10. Find all positive integers k ≤10 such that 4k + 1 and 6k + 1 are
simultaneously prime. Let nk = 12k + 2. Prove that if 4k + 1 and
6k + 1 are simultaneously prime, then d(nk) = d(nk + 1).
Remark. It is an unsolved problem to determine whether there are
inﬁnitely many integers n such that d(n) = d(n + 1).
11. Prove that
dℓ(n) =

p|n
vp(n) + ℓ−1
ℓ−1

for all positive integers ℓand n.
12. Let ℓ≥1. Prove that

n≤x
dℓ+1(n)
n
=

d≤x
1
d

n≤x/d
dℓ(n)
n
.
13. Prove that

n≤x
d(n)
n
= log2 x
2
+ O(log x).
14. Let 0 < α < 1. Prove that

n≤x
d(n)
nα
= x1−α log x
1 −α
+ O(x1−α).
15. Let α > 1. Prove that

n≤x
d(n)
nα
= O(1).
7.2
A Theorem of Ramanujan
In Theorem 7.3 we computed the mean value of the divisor function d(n). In
this section we shall determine the mean value of the square of the divisor
function. We begin with an alternative representation for d2(n).

238
7. Divisor Functions
Theorem 7.7
d2(n) =

δ2|n
µ(δ)d4
 n
δ2

.
Proof. Deﬁne the arithmetic function ˜µ as follows:
˜µ(n) =

µ(√n)
if n is a square,
0
otherwise.
By Exercise 1, the function ˜µ is multiplicative. Since the Dirichlet convolu-
tion of multiplicative functions is multiplicative (Exercise 3 in Section 6.4),
the function ˜µ ∗d4 is multiplicative, and
˜µ ∗d4(n)
=

d|n
˜µ(d)d4
n
d

=

δ2|n
µ(δ)d4
 n
δ2

.
We shall prove that ˜µ ∗d4(pa) = (a + 1)2 for every prime power pa. By
Theorem 7.5,
d4(pa) =
a + 3
3

,
and so
˜µ ∗d4(p) =

δ2|p
µ(δ)d4
 p
δ2

= d4(p) =
4
3

= 4.
If a ≥2, then
˜µ ∗d4(pa)
=

δ2|pa
µ(δ)d4
pa
δ2

=
d4 (pa) −d4

pa−2
=
a + 3
3

−
a + 1
3

=
(a + 1)2.
Since d(pa) = a + 1, it follows that
d2(pa) = (a + 1)2 = ˜µ ∗d4(pa)
for all prime powers pa. The functions d2 and ˜µ∗d4 are both multiplicative.
Since multiplicative functions are completely determined by their values on
prime powers (Exercise 2 in Section 6.4), it follows that
d2(n) = ˜µ ∗d4(n)
for all positive integers n. 2

7.2 A Theorem of Ramanujan
239
Theorem 7.8 (Ramanujan)

n≤x
d2(n) ∼1
π2 x(log x)3
as x →∞.
Proof. Applying Theorem 7.6 with ℓ= 4, we obtain
D4(x) = x log3 x
6
+ O(x log2 x).
By Theorem 7.7 we have

n≤x
d2(n)
=

n≤x

δ2|n
µ(δ)d4
 n
δ2

=

δ2k≤x
µ(δ)d4(k)
=

δ≤√x
µ(δ)

k≤x/δ2
d4(k)
=

δ≤√x
µ(δ)D4
 x
δ2

=

δ≤√x
µ(δ)
 x
6δ2 log3 x
δ2 + O
 x
δ2 log2 x
δ2

=
x
6

δ≤√x
µ(δ)
δ2
log3 x
δ2 + O

x

δ≤√x
1
δ2 log2 x
δ2

.
We estimate these sums separately. The ﬁrst term is
x
6

δ≤√x
µ(δ)
δ2
log3 x
δ2
=
x
6
3

i=0
3
i

(−1)i 
δ≤√x
µ(δ)
δ2
log3−i x logi δ2
=
x
6 log3 x

δ≤√x
µ(δ)
δ2
+ O

x log2 x

δ≤√x
log3 δ
δ2


=
x
6
 6
π2 + O
 1
√x

log3 x + O

x log2 x

δ≤√x
log3 δ
δ2


=
x log3 x
π2
+ +O

x log2 x

,

240
7. Divisor Functions
by Theorem 6.17. Similarly,
x

δ≤√x
1
δ2 log2 x
δ2 ≤x log2 x

δ≤√x
1
δ2 ≪x log2 x.
This completes the proof of Ramanujan’s theorem. 2
Exercise
1. Prove that the function ˜µ is multiplicative.
7.3
Sums of Divisors
The arithmetic function σ(n) is deﬁned as the sum of the positive divisors
of n. Thus,
σ(1)
=
1
=
1,
σ(6)
=
1 + 2 + 3 + 6
=
12,
σ(2)
=
1 + 2
=
3,
σ(7)
=
1 + 7
=
8,
σ(3)
=
1 + 3
=
4,
σ(8)
=
1 + 2 + 4 + 8
=
15,
σ(4)
=
1 + 2 + 4
=
7,
σ(9)
=
1 + 3 + 9
=
13,
σ(5)
=
1 + 5
=
6,
σ(10)
=
1 + 2 + 5 + 10
=
18.
If n ≥2, then σ(n) ≥n + 1. We can use the standard factorization of n
to compute σ(n). We begin with an example. Consider 180 = 22325. Every
divisor d of 180 is of the form d = 2a3b5c, where 0 ≤a ≤2, 0 ≤b ≤2, and
0 ≤c ≤1. We have
σ(180)
=

d|180
d
=
1 + 2 + 3 + 4 + 5 + 6 + 9 + 10 + 12
+15 + 18 + 20 + 30 + 36 + 45 + 60 + 90 + 180
=
(1 + 2 + 4)(1 + 3 + 9)(1 + 5)
=
546.
We can compute σ(n) in this way for any positive integer n. If d divides n,
then
d =

p|n
pap,
where
0 ≤ap ≤vp(n),

7.3 Sums of Divisors
241
and
σ(n)
=

d|n
d
=

p|n
vp(n)

ap=0
pap
=

p|n
pvp(n)+1 −1
p −1
.
This formula expresses σ(n) in terms of the standard factorization of n.
Theorem 7.9 The arithmetic function σ(n) is multiplicative.
Proof. Let m and n be relatively prime positive integers. Since no prime
divides both m and n, we have
σ(mn)
=

p|mn
pvp(mn)+1 −1
p −1
=

p|m
pvp(m)+1 −1
p −1

p|n
pvp(n)+1 −1
p −1
=
σ(m)σ(n).
This completes the proof. 2
The ancient Greeks divided the positive integers into three classes, de-
termined by the sum of the divisors of the integer. They called a number
perfect if σ(n) = 2n. A number is called abundant if σ(n) > 2n. A number
is called deﬁcient if σ(n) < 2n. The smallest perfect numbers are
6
=
2 · 3
=
21(22 −1),
28
=
4 · 7
=
22(23 −1),
496
=
16 · 31
=
24(25 −1),
8128
=
64 · 127
=
26(27 −1).
Theorem 7.10 (Euler) An even integer n is perfect if and only if there
exist prime numbers p and q such that
q = 2p −1
and
n = 2p−1q.

242
7. Divisor Functions
Proof. If n is of this form, then q is odd and 2n = 2pq. It follows that
σ(n)
=
σ(2p−1)σ(q)
=
(2p −1)(q + 1)
=
2pq + (2p −q −1)
=
2n,
and so n is perfect.
Conversely, if n is an even perfect number, then σ(n) = 2n. Writing n in
the form
n = 2k−1m,
where m is odd and k ≥2 (since n is even), we have
2km = 2n = σ(n) = σ(2k−1m) = σ

2k−1
σ(m) = (2k −1)σ(m).
Since 2k−1 divides 2km and 2k−1 is relatively prime to 2k, Euclid’s lemma
implies that 2k −1 divides m, and so
m =

2k −1

ℓ
for some odd integer ℓ. Then
2k 
2k −1

ℓ=

2k −1

σ

2k −1

ℓ

.
If ℓ> 1, then 1, ℓ, and (2k −1)ℓare distinct divisors of (2k −1)ℓ, and
2kℓ= σ

2k −1

ℓ

≥1 + ℓ+ (2k −1)ℓ= 2kℓ+ 1,
which is impossible. Therefore, ℓ= 1 and
2k = σ(2k −1) = 1 + (2k −1) +

d|(2k−1)
1<d<2k−1
d,
it follows that 2k−1 has no proper divisors, that is, 2k−1 is a prime number.
If the exponent k were composite, then k = k1k2 with 1 < k1 ≤k2 < k,
and
2k −1 =

2k1k2 −1 =

2k1 −1
 
1 + 2k1 + 22k1 + · · · + 2k1(k2−1)
would be composite, which is false. Therefore, k = p is also prime, and
m = q = 2p −1. This completes the proof. 2
A prime number of the form 2p −1 is called a Mersenne prime. (Ex-
ercise 5 in Section 1.5 and Exercise 9 in Section 3.4 are about Mersenne

7.3 Sums of Divisors
243
primes.) By Theorem 7.10, every even perfect number is uniquely associ-
ated with a Mersenne prime. Only ﬁnitely many Mersenne primes have
been discovered, so we know only ﬁnitely many even perfect numbers. A
list of all Mersenne primes known in October, 1999, appears in the Notes
at the end of Chapter 1.
It is an unsolved problem to decide whether there exist inﬁnitely many
even perfect numbers. We know almost nothing about odd perfect numbers,
and it is an unsolved problem to decide whether even one odd perfect
number exists.
Let
σ∗(n) = σ(n) −n =

d|n
d<n
d.
We deﬁne σ∗(0) = 0. A pair (m, n) of positive integers is called an amicable
pair if
σ∗(n) = m
and
σ∗(m) = n.
Equivalently, (m, n) is an amicable pair if σ(m) = σ(n) = m + n. For
example, the pair (220, 284) is amicable, since
σ∗(220) = 284
and
σ∗(284) = 220.
It is not known whether there exist inﬁnitely many amicable pairs.
For every positive integer n and nonnegative integer k, there is an integer
Sk(n) obtained by iterating the function σ∗as follows:
S0(n)
=
n,
S1(n)
=
σ∗(n),
S2(n)
=
σ∗(S1(n)) = σ∗(σ∗(n)) ,
...
Sk+1(n)
=
σ∗(Sk(n)),
for all positive integers k. The sequence {Sk(n)}∞
k=0 is called the aliquot
sequence of n. Since there exist abundant, perfect, and deﬁcient numbers, it
can happen that Sk+1(n) > Sk(n), Sk+1(n) = Sk(n), or Sk+1(n) < Sk(n),
and so the aliquot sequence can oscillate up and down. Computations indi-
cate, however, that for small n the aliquot sequence always becomes even-
tually periodic. For example, the aliquot sequence for 12 is
12, 16, 15, 9, 4, 3, 1, 0, 0, . . . .

244
7. Divisor Functions
If n is a perfect number, then Sk(n) = n for all k, and the sequence
{Sk(n)}∞
k=0 is constant. If (m, n) is an amicable pair of integers, then
S0(n)
=
n,
S1(n)
=
m,
S2(n)
=
n,
S3(n)
=
m,
and so on. Thus, the aliquot sequence for an integer in an amicable pair
oscillates with period 2. It is an unsolved problem to determine if, for every
positive integer n, the sequence {Sk(n)}∞
k=0 is eventually periodic. This is
called the Catalan–Dickson problem.
There is a natural generalization of the “sum of the divisors” function.
For any real or complex number α, we can deﬁne the arithmetic function
σα(n) =

d|n
d≥1
dα.
Then σ0(n) is the divisor function d(n), and σ1(n) = σ(n). The function
σα(n) is multiplicative for every number α (Exercise 8).
Exercises
1. Compute σ(n) for 11 ≤n ≤20.
2. Prove that (17296, 18416) is an amicable pair.
Hint: 17296 = 24 × 23 × 47 and 18416 = 24 × 1151.
3. Prove that (9, 363, 584, 9, 437, 056) is an amicable pair.
Hint: 9, 363, 584 = 27 × 191 × 383 and 9, 437, 056 = 27 × 73727.
4. Let A be a set of positive integers, and let A(x) denote the number
of elements a ∈A such that a ≤x. The set A has asymptotic density
α if limx→∞A(x)/x = α. Prove that the set of even perfect numbers
has asymptotic density zero.
5. Prove that σ(n) = nσ−1(n) for every positive integer n.
6. Prove that
0 ≤

d|n
log d
d
≤σ−1(n) log n.
7. Prove that for every number α,

d|n
logα d
d
= o (σ−1(n) logα n) .

7.3 Sums of Divisors
245
Hint: Observe that for any ε > 0,

d|n
logk d
d
≤

d|n
d≤nε
ε logk n
d
+

d|n
d>nε
logk d
nε
≤εσ−1(n) logk n+d(n) logk n
nε
and apply Theorem 7.2.
8. Prove that the function σα(n) is multiplicative for every real or com-
plex number α.
9. Let α > 1. Prove that
nα ≤σα(n) ≤ζ(α)nα
for all positive integers n.
Hint: 
d|n dα = 
d|n(n/d)α.
10. Let α ≥1. Prove that
σα(n)
nα
<

p|n

1 + 2
pα

for every integer n ≥2.
11. Prove that
lim inf
n→∞
σ(n)
n
= 1.
12. Let x ≥2 and n = 
p≤x p. Prove that
σ(n)
n
>

p≤x
1
p.
Remark. Theorem 8.7 implies that lim supn→∞σ(n)/n = ∞.
13. Consider the numbers
a0
=
12, 496
=
24 × 11 × 71
a1
=
14, 288
=
24 × 19 × 47
a2
=
15, 472
=
24 × 967
a3
=
14, 536
=
23 × 23 × 79
a4
=
14, 264
=
23 × 1783.
Prove that if r ∈{0, 1, 2, 3, 4} and k ≡r
(mod 5), then
Sk(12, 496) = ar,
and so the aliquot sequence for 12, 496 is periodic with period 5,
14. Compute the aliquot sequences {Sk(n)}∞
k=0 for n = 28, 29, 30, 31, 32.

246
7. Divisor Functions
7.4
Sums and Diﬀerences of Products
In this section we prove two theorems of Ingham about sums and diﬀerences
of divisor functions. These results have beautiful interpretations in terms
of the number of solutions of diophantine equations in positive integers.
Let V (n) denote the number of representations of n as a sum of products
of two positive integers. The function V (n) counts the number of solutions
in positive integers of the diophantine equation
n = ab + cd.
(7.1)
Let cd = k. Then 1 ≤k ≤n −1 and n −k = ab. Since the number of
solutions of k = cd is d(k) and the number of solutions of n −k = ab is
d(n −k), it follows that the number of solutions of (7.1) with cd = k is
d(k)d(n −k), and so
V (n) =
n−1

k=1
d(k)d(n −k).
Consider the diophantine equation
ℓ= ab −cd.
(7.2)
For every positive integer k, the number of solutions of (7.2) with cd = k
and ab = k + ℓis d(k)d(k + ℓ). Let Uℓ(n) denote the number of solutions
of (7.2) in positive integers with cd = k ≤n. Then
Uℓ(n) =
n

k=1
d(k)d(k + ℓ).
We need the following lemma.
Lemma 7.1 For every x ≥1,

uv≤x
(u,v)=1
1
uv = 3
π2 log2 x + O(log x).
Proof. We deﬁne
f(x) =

uv≤x
(u,v)=1
1
uv
(7.3)
and
g(x) =

st≤x
1
st =

n≤x
d(n)
n .

7.4 Sums and Diﬀerences of Products
247
If st ≤x and r is a common divisor of s and t, then r2 ≤st ≤x, and so
r ≤√x and
g(x)
=

st≤x
1
st
=

r≤x1/2

st≤x
(s,t)=r
1
st
=

r≤x1/2
1
r2

uv≤x/r2
(u,v)=1
1
uv
=

r≤x1/2
1
r2 f
 x
r2

.
Applying M¨obius inversion (Exercise 7 of Section 6.3 with α = 2), we obtain
f(x)
=

r≤x1/2
µ(r)
r2 g
 x
r2

=

r≤x1/2
µ(r)
r2

n≤x/r2
d(n)
n
=

nr2≤x
µ(r)d(n)
nr2
=

n≤x
d(n)
n

r≤(x/n)1/2
µ(r)
r2
=

n≤x
d(n)
n
 6
π2 + O
n
x
1/2
=
6
π2

n≤x
d(n)
n
+ O

1
x1/2

n≤x
d(n)
n1/2


by Theorem 6.17. Since

n≤x
d(n)
n
= log2 x
2
+ O(log x)
and

n≤x
d(n)
n1/2 = 2x1/2 log x + O(x1/2)
by Exercises 13 and 14 of Section 7.1, it follows that
f(x) = 3
π2 log2 x + O (log x) .

248
7. Divisor Functions
This completes the proof. 2
Theorem 7.11
V (n) =
n−1

k=1
d(k)d(n −k) ∼6
π2 σ(n) log2 n.
Proof. The arithmetic function V (n) is the number of solutions of the
equation n = ab + cd in positive integers. If (a, b, c, d) is a solution of this
equation, then
ac · bd = (ab + cd)2
4
−(ab −cd)2
4
≤n2
4 ,
and so ac ≤n/2 or bd ≤n/2. Let P denote the number of solutions with
ac ≤n/2, let Q denote the number of solutions with bd ≤n/2, and let R
denote the number of solutions with both ac ≤n/2 and bd ≤n/2. Since
(a, b, c, d) is a solution if and only if (b, a, d, c) is a solution, it follows that
P = Q and
V (n) = P + Q −R = 2P −R.
We ﬁrst compute P. For ﬁxed positive integers a and c, let Φ(a, c, n)
denote the number of solutions of the equation ab + cd = n in positive
integers b and d. Then
P =

ac≤n/2
Φ(a, c, n).
Let r = (a, c) denote the greatest common divisor of a and c. If r does not
divide n, then Φ(a, c, n) = 0. Therefore, we can assume that r divides n, and
there exist positive integers α, γ, and η such that a = rα, c = rγ, n = rη,
and (α, γ) = 1. Moreover, Φ(a, c, n) = Φ(α, γ, η).
Since (α, γ) = 1, there exist integers b0 and d0 such that αb0 + γd0 = η,
and every solution of the equation ab + cd = n is of the form b = b0 + γh
and d = d0 −αh for some integer h. It follows that every solution of the
equation ab + cd = n is of the form b = b0 + γh and d = d0 −αh for some
integer h. If b > 0 and d > 0, then
−b0
γ < h < d0
α ,
and so
Φ(a, c, n) = Φ(α, γ, η) = b0
γ + d0
α + ϑ = αb0 + γd0
αγ
+ ϑ =
n
rαγ + ϑ,

7.4 Sums and Diﬀerences of Products
249
where |ϑ| ≤1 (Exercise 2). We have
P
=

ac≤n/2
Φ(a, c, n)
=

r|n

ac≤n/2
(a,c)=r
Φ(a, c, n)
=

r|n

αγ≤n/2r2
(α,γ)=1
Φ(α, γ, η)
=

r|n

αγ≤n/2r2
(α,γ)=1
 n
rαγ + ϑ

=
n

r|n
1
r

αγ≤n/2r2
(α,γ)=1
1
αγ + O


ac≤n/2
1


=
n

r|n
1
r
 3
π2

log n
2r2
2
+ O

log n
2r2

+ O


k≤n/2
d(k)


=
3n
π2

r|n
1
r

log n
2r2
2
+ O (nσ−1(n) log n) + O (n log n)
=
3n
π2

r|n
1
r

log n
2r2
2
+ O (σ(n) log n)
=
3
π2 nσ−1(n) log2 n + o

nσ−1(n) log2 n

+ O (σ(n) log n)
=
3
π2 σ(n) log2 n + o

σ(n) log2 n

,
by Lemma 7.1, Theorem 7.3, and Exercises 5 and 7 in Section 7.3.
Next we compute R. For ﬁxed integers a and c, the linear diophantine
equation ab + cd = n is solvable in integers if and only if n is divisible by
r = (a, c). Again we write a = rα, c = rγ, and n = rη, where (α, γ) = 1. If
the integers b0 and d0 solve the equation ab + cd = n, then every solution
is of the form
b = b0 + hγ
and
d = d0 −hα
for some integer h.
Let a and c be positive integers with ac ≤n/2. Let Ψ(a, c, n) denote the
number of solutions of the equation ab + cd = n in positive integers b and
d with
bd ≤n
2 .

250
7. Divisor Functions
Then Ψ(a, c, n) = Ψ(α, γ, η) counts the number of integers h such that
b0 + hγ > 0
and
d0 −hα > 0,
(7.4)
and
(b0 + hγ)(d0 −hα) ≤n
2 .
(7.5)
We deﬁne the rational number
u = a(b0 + γh)
n
.
Then
1 −u = c(d0 −αh)
n
.
Inequalities (7.4) imply that
0 < u < 1.
Inequality (7.5) implies that
u(1 −u) ≤ac
2n ≤1
4.
Solving this quadratic inequality, we obtain
0 < u ≤1 −v
2
(7.6)
and
1 + v
2
≤u < 1,
(7.7)
where
v =
2
1 −2ac
n .
Note that 0 ≤v < 1, since 0 < ac ≤n/2. Inequality (7.6) is equivalent to
−b0
γ < h ≤(1 −v)nr
2ac
−b0
γ ,
and inequality (7.7) implies
0 < 1 −u ≤1 −v
2
,
which is equivalent to
d0
α −(1 −v)nr
2ac
≤h < d0
α .

7.4 Sums and Diﬀerences of Products
251
Both of these intervals have length
(1 −v)nr
2ac
= (1 −v2)nr
(1 + v)2ac ≤(1 −v2)nr
2ac
= r.
It follows that if a and c are positive integers with (a, c) ≤n/2 and (a, c) =
r, then
Ψ(a, c, n) = (1 −v)nr
ac
+ O(1) ≤2r + O(1).
Therefore,
R
=

ac≤n/2
Ψ(a, c, n)
=

r|n

ac≤n/2
(a,c)=r
Ψ(a, c, n)
≤

r|n

αγ≤n/(2r2)
(α,γ)=1
(2r + O(1))
=
2

r|n
r

αγ≤n/(2r2)
1 +

ac≤n/2
O(1)
≪

r|n
r

k≤n/(2r2)
d(k) +

k≤n/2
d(k)
≪

r|n
r
n log n
r2

+ n log n
≪
nσ−1(n) log n
=
σ(n) log n.
We have
V (n)
=
2P −R
=
6
π2 σ(n) log2 n + o(σ(n) log2 n) + O(σ(n) log n)
∼
6
π2 σ(n) log2 n.
This completes the proof. 2
Theorem 7.12 For every positive integer ℓ,
Uℓ(n) =
n

k=1
d(k)d(k + ℓ) ∼6
π2 σ−1(ℓ)n log2 n.

252
7. Divisor Functions
Proof. Let x be the geometric mean of n and n + ℓ, that is,
x =
-
n(n + ℓ) = n + θ,
where
0 < θ < ℓ
2.
We have x = O(n).
The function Uℓ(n) counts the number of 4-tuples (a, b, c, d) of positive
integers such that
ab −cd = ℓ
and
cd ≤n.
(7.8)
If (a, b, c, d) satisﬁes (7.8), then
ac · bd ≤n(n + ℓ) = x2,
and so ac ≤x or bd ≤x. Let P be the number of solutions of (7.8) with
ac ≤x, Q the number of solutions of (7.8) with bd ≤x, and R the number
of solutions of (7.8) with both ac ≤x and bd ≤x. The symmetry of
equation (7.8) implies that P = Q, and so
Uℓ(n) = P + Q −R = 2P −R.
We shall ﬁnd asymptotic formulae for P and R by the same method used
in the proof of Theorem 7.11.
We ﬁrst compute P. For ﬁxed positive integers a and c, let Φℓ(a, c, n)
denote the number of solutions of the equation ab −cd = ℓin positive
integers b and d with cd ≤n. Let r = (a, c) denote the greatest common
divisor of a and c. The integer r must divide ℓ, and so there exist positive
integers α, γ, and λ such that a = rα, c = rγ, ℓ= rλ, and (α, γ) = 1. If
cd ≤n, then γd ≤n/r. If ab −cd = ℓ, then αb −γd = λ. If ac ≤x, then
αγ ≤x/r2. Therefore, Φℓ(a, c, n) = Φλ(α, γ, n/r) and
P =

ac≤x
Φℓ(a, c, n) =

r|ℓ

αγ≤x/r2
(α,γ)=1
Φλ(α, γ, n/r).
Since (α, γ) = 1, there exist integers b0 and d0 such that αb0 −γd0 = λ,
and every solution of the equation αb −γd = λ is of the form b = b0 + γh
and d = d0 + αh for some integer h. It follows that every solution of the
equation ab −cd = ℓis of the form b = b0 + γh and d = d0 + αh for some
integer h. If d > 0 and cd ≤n, then b > 0 and
−d0
α < h ≤n
αc −d0
α =
n
rαγ −d0
α .
(7.9)
Conversely, if h satisﬁes (7.9), then b and d are positive integers with cd ≤n.
Therefore,
Φℓ(a, c, n) = Φλ(α, γ, n/r) =
n
rαγ + θ,

7.4 Sums and Diﬀerences of Products
253
where |ϑ| ≤1. We have
P
=

r|ℓ

αγ≤x/r2
(α,γ)=1
Φλ(α, γ, n/r)
=

r|ℓ

αγ≤x/r2
(α,γ)=1
 n
rαγ + ϑ

=
n

r|ℓ
1
r

αγ≤x/r2
(α,γ)=1
1
αγ + O


ac≤x
1


=
n

r|ℓ
1
r
 3
π2

log n
r2
2
+ O

log n
r2

+ O


k≤x
d(k)


=
3n
π2

r|ℓ
1
r

log n
r2
2
+ O (nσ−1(n) log n) + O (x log x)
=
3n
π2

r|ℓ
1
r

log n
r2
2
+ O (σ(n) log n)
=
3
π2 nσ−1(n) log2 n + o

nσ−1(n) log2 n

+ O (σ(n) log n)
=
3
π2 σ(n) log2 n + o

σ(n) log2 n

,
by Lemma 7.1, Theorem 7.3, and Exercises 5 and 7 in Section 7.3.
Next we compute R, which is the number of solutions of (7.8) with both
ac ≤x and bd ≤x. For ﬁxed positive integers a and c, we let Ψ(a, c, ℓ)
denote the number of ordered pairs (b, d) of positive integers such that
ab −cd = ℓand
0 < d ≤n
c
and
bd ≤x.
If r = (a, c), then a = rα and c = rγ, where α and γ are relatively prime
positive integers. If r does not divide ℓ, then Ψ(a, c, ℓ) = 0. If r does divide
ℓ, then ℓ= rλ and Ψ(a, c, ℓ) = Ψ(α, γ, λ). Since (α, γ) = 1, there exist
integers b0 and d0 such that
αb0 −γd0 = λ,
and every integral solution of the linear diophantine equation αb −γd = λ
is of the form
b = b0 + γh
and
d = d0 + αh
for some integer h. Every solution in integers of ab −cd = ℓis of the form
b = b0 + γh
and
d = d0 + αh

254
7. Divisor Functions
for some integer h. The inequality 0 < cd ≤n implies that
−d0
α < h ≤n
αc −d0
α .
Since
b0
γ −d0
α = αb0 −γd0
αγ
= λ
αγ > 0,
it follows that
0 < d0
α + h < b0
γ + h.
If bd = (b0 + γh)(d0 + αh) ≤x, then
d0
α + h
2
<
b0
γ + h
 d0
α + h

≤x
αγ ,
and so
0 < d0
α + h ≤
2 x
αγ .
Therefore,
Ψ(a, c, ℓ) ≤
2 x
αγ + 1 ≤2
2 x
αγ
and
R
=

ac≤x
Ψ(a, c, ℓ)
=

r|ℓ

ac≤x
(a,c)=r
Ψ(a, c, ℓ)
≤
2

r|ℓ

αγ≤x/r2
(α,γ)=1
2 x
αγ
≤
2√x

r|ℓ

αγ≤x/r2
2 1
αγ
=
2√x

r|ℓ

n≤x/r2
d(n)
√n
≪
√x

r|ℓ
2 x
r2 log x
r2
≪
x log x,
by Exercise 14 in Section 7.1. This completes the proof. 2

7.5 Sets of Multiples
255
Exercises
1. Prove that the diophantine equation (7.2) has inﬁnitely many solu-
tions in positive integers.
2. Let x and y be real numbers with x < y. Prove that the number of
integers in the open interval (x, y) is y −x + θ, where |θ| ≤1.
7.5
Sets of Multiples
Let A be a nonempty set of positive integers. The set of multiples M(A)
consists of all positive multiples of elements of A, that is,
M(A) = {ma : a ∈A and m ∈N}.
The set B is called a set of multiples if B = M(A) for some set A. For
example, if A = {2}, then M(A) is the set of positive even integers. If P is
the set of prime numbers, then M(P) is the set of all integers n > 1.
A nonempty set A of positive integers is called primitive if no element of
A divides another element of A, that is, if a, a′ ∈A and a divides a′, then
a = a′. If A1 and A2 are nonempty sets of positive integers and A1 is a
subset of A2, then M(A1) is a subset of M(A2). If A2 is primitive and A1
is a proper subset of A2, then, by Exercise 4, M(A1) is a proper subset of
M(A2).
We shall prove that if B is a set of multiples, then there exists a unique
primitive set A∗such that B = M(A∗).
Lemma 7.2 Let A be a nonempty set of positive integers, and let A∗be
the subset of A consisting of all integers a ∈A not divisible by any other
element of A. Then A∗is a primitive set, and
M(A) = M(A∗).
Proof. The primitivity of the set A∗follows immediately from the deﬁ-
nition.
If b ∈M(A), then b is a multiple of a for some integer a ∈A. If a ̸∈A∗,
then a has a proper divisor that belongs to A. Let a′ be the smallest element
of A that divides a. Then a′ ∈A∗, and b is a multiple of a′. This completes
the proof. 2
Lemma 7.3 If A1 and A2 are nonempty sets of positive integers such that
M(A1) = M(A2), then M(A1 ∩A2) = M(A1).

256
7. Divisor Functions
Proof. By Exercise 4, M(A1∩A2) is a subset of M(A1). If M(A1∩A2) is
a proper subset of M(A1), then there exists a smallest integer b ∈M(A1)\
M(A1 ∩A2). Since b ∈M(A1) = M(A2), we have
b = m1a1 = m2a2
for positive integers m1, m2, a1, a2 with a1 ∈A1, a2 ∈A2. Moreover, a1 ̸=
a2 since b ̸∈M(A1 ∩A2). Suppose a1 < a2. Since a1 ∈M(A1) and
a1 < a2 ≤m2a2 = b,
the minimality of b implies that a ∈M(A1 ∩A2). Then a1 = ma for some
a ∈A1 ∩A2, and so b = m1a1 = m1ma ∈M(A1 ∩A2), which is absurd. It
follows that M(A1) = M(A1 ∩A2). 2
Theorem 7.13 Let B be a set of multiples. There exists a unique primitive
set A∗such that B = M(A∗).
Proof. Let B = M(A) for some set A, and let A∗be the primitive subset
of A constructed in Lemma 7.2. Then B = M(A∗). Let A′ be any set of
positive integers such that B = M(A′). By Lemma 7.3,
B = M(A′) = M(A′ ∩A∗) = M(A∗).
Since A′∩A∗is a subset of A∗, it follows from Exercise 4 that A′∩A∗= A∗.
Thus, A∗is a subset of every set A′ such that M(A′) = B, and so A∗is
the primitive set uniquely deﬁned by
A∗=

A′⊆N
M(A′)=B
A′.
This completes the proof. 2
Let A be a set of integers. The counting function A(x) of the set A counts
the number of positive elements of A not exceeding x, that is,
A(x) =

a∈A
1≤a≤x
1.
The lower asymptotic density of A is
dL(A) = lim inf
x→∞
A(x)
x
.
The upper asymptotic density of A is
dU(A) = lim sup
x→∞
A(x)
x
.

7.5 Sets of Multiples
257
The set A has asymptotic density d(A) = α if dL(A) = dU(A) = α, or,
equivalently,
d(A) = lim
x→∞
A(x)
x
.
The set of multiples of a ﬁnite set of positive integers always has an asymp-
totic density (Exercise 6), but it is possible to construct an inﬁnite set A
such that M(A) does not have an asymptotic density. The following result
gives a suﬃcient condition for the set of multiples of an inﬁnite set to have
asymptotic density.
Theorem 7.14 If A is an inﬁnite set of positive integers such that

a∈A
1
a < ∞,
then the set of multiples of A has an asymptotic density.
Proof. Let A = {ai}∞
i=1, where a1 < a2 < · · ·, and let B = M(A). For
every positive integer k, let Bk denote the set of all positive integers that
are divisible by ak but not divisible by ai for all i < k. The sets Bk are
pairwise disjoint, and B = ∪∞
k=1Bk. It follows that
B(x) =
∞

k=1
Bk(x)
and
B(x)
x
=
∞

k=1
Bk(x)
x
for all x ≥1. There are [x/ak] positive integers not exceeding x that are
divisible by ak, and so
0 ≤Bk(x) ≤
 x
ak

≤x
ak
.
Equivalently,
0 ≤Bk(x)
x
≤1
ak
for all x > 0. Let ε > 0, and choose K1 = K1(ε) such that
∞

k=K1+1
1
ak
< ε.
Then
0 ≤B(x)
x
−
K1

k=1
Bk(x)
x
=
∞

k=K1+1
Bk(x)
x
≤
∞

k=K1+1
1
ak
< ε.

258
7. Divisor Functions
By Exercise 8, the set Bk has an asymptotic density, that is, there exists a
number βk ≥0 such that
d(Bk) = lim
x→∞
Bk(x)
x
= βk.
Moreover, β1 = d(B1) = 1/a1 > 0. For every positive integer ℓ, the density
of the set of integers divisible by at least one of the integers a1, . . . , aℓis
β1 + · · · + βℓ, and so
0 <
ℓ

k=1
βk ≤1.
Therefore, the inﬁnite series ∞
k=1 βk converges to some number β > 0.
We shall prove that the set of multiples M(A) has density β, that is,
lim
x→∞
B(x)
x
= β.
For every ε > 0 there exists an integer K2 = K2(ε) such that
∞

k=K2+1
βk < ε.
Let K = max{K1, K2}. We can choose a number x0 = x0(ε) such that

Bk(x)
x
−βk
 < ε
K
for all x ≥x0 and k = 1, . . . , K. Then

B(x)
x
−β

=

∞

k=1
Bk(x)
x
−β

<

K

k=1
Bk(x)
x
−
K

k=1
βk
 + 2ε
≤
K

k=1

Bk(x)
x
−βk
 + 2ε
<
3ε.
This completes the proof. 2
The following result will be used in Section 7.6 to prove that the set of
abundant numbers has an asymptotic density.

7.5 Sets of Multiples
259
Theorem 7.15 If A is an inﬁnite set of integers with counting function
A(x) = O

x
log2 x

for x ≥2, then the set of multiples M(A) has an asymptotic density.
Proof. By Theorem 6.10, the inﬁnite series 
a∈A a−1 converges. It fol-
lows from Theorem 7.14 that the set of multiples M(A) has an asymptotic
density. 2
Exercises
1. Prove that if 1 ∈A, then M(A) = N.
2. For every positive integer n, prove that the set {n + 1, n + 2, . . . , 2n}
is primitive.
3. Let Ω(n) denote the total number of prime factors of n. For every
r ≥1, prove that the set {n ≥1 : Ω(n) = r} is primitive.
4. Prove that if A1 and A2 are nonempty sets of positive integers and
A1 ⊆A2, then M(A1) ⊆M(A2). Prove that if A2 is primitive and A1
is a proper subset of A2, then M(A1) is a proper subset of M(A2).
5. Prove that if A is a primitive set, then A has upper asymptotic density
dU(A) ≤1/2.
Hint: Let A = {ai}∞
i=1, where a1 < a2 < a3 < · · ·. Prove that each
ai can be written uniquely in the form ai = 2uivi, where ui ≥0 and
vi is an odd positive integer. Prove that the numbers vi are distinct,
since the set A is primitive.
6. Let x ≥1. Let A = {a1, . . . , ak} consist of k distinct positive integers.
For every subset A′ = {ai1, . . . , aij} ⊆A, let N(x, A′) denote the
number of integers up to x divisible by every element of A′. Prove
that
N(x, A′) =

x
lcm(A′)

,
where lcm(A) = [ai1, . . . , aij] is the least common multiple of the
integers in A′. Prove that the number of integers up to x that are
divisible by no element of A is
k

j=0
(−1)j 
A′⊆A
|A′|=j
N(x, A′) =
k

j=0
(−1)j 
A′⊆A
|A′|=j

x
lcm(A′)

.

260
7. Divisor Functions
Let B = M(A) and let B(x) be the counting function of B. Prove
that
B(x)
=
k

j=1
(−1)j−1 
A′⊆A
|A′|=j

x
lcm(A′)

=
x
k

j=1
(−1)j−1 
A′⊆A
|A′|=j
1
lcm(A′) + O(1).
Deduce that the set of multiples M(A) has asymptotic density
d(M(A)) =
k

j=1
(−1)j−1 
A′⊆A
|A′|=j
1
lcm(A′).
7. Let A = {a1, . . . , ak} consist of k pairwise relatively prime positive
integers. Prove that
d(M(A)) = 1 −
k

i=1

1 −1
ai

.
8. Let A = {a1, . . . , ak} consist of k distinct positive integers, and let
Bk be the set of positive integers divisible by ak but not divisible
by ai for all i < k. Prove that the set Bk has an asymptotic density
d(Bk), and compute d(Bk).
7.6
Abundant Numbers
In this section we consider the set of perfect and abundant numbers. For
simplicity, we modify our previous terminology and call the elements of
this set abundant. Now a positive integer n is abundant if σ(n) ≥2n. By
Exercise 2, if n is abundant, then every multiple of n is also abundant.
An integer n is called a primitive abundant number if n is abundant but
no proper divisor of n is abundant, that is, σ(n) ≥2n but σ(d) < 2d for
every proper divisor d of n. The set of abundant numbers consists of all
multiples of the primitive abundant numbers (Exercise 3). We shall prove
that the set of abundant numbers possesses an asymptotic density.
An integer n will be called a k-abundant number if σ(n) ≥kn. Let Ak
be the set of all k-abundant numbers.
A primitive k-abundant number is a positive integer n such that σ(n) ≥
kn, but σ(d) < kd for every proper divisor d of n. Let PAk denote the set of
primitive k-abundant numbers. Then Ak = M(PAk), that is, Ak is the set of

7.6 Abundant Numbers
261
multiples of PAk. We shall prove that the set Ak has an asymptotic density
for every integer k ≥2. By Theorem 7.15, Ak will have an asymptotic
density if the counting function of the set PAk of primitive k-abundant
numbers is O(x log−2 x).
We begin with some lemmas about prime divisors. The ﬁrst result states
that it is rare for an integer to be divisible by a large prime power.
Lemma 7.4 The number of positive integers n ≤x divisible by some prime
power pr ≥log4 x with r ≥2 is O(x log−2 x).
Proof. If p is a prime such that p ≥log2 x and p2 divides n, then n is
divisible by a prime power pr ≥log4 x with r ≥2. The number of such
integers n ≤x is [x/p2].
If p < log2 x, let up be the least integer such that pup ≥log4 x. The
number of integers n ≤x divisible by a prime power pr ≥log4 x is [x/pup].
Let N1(x) denote the number of integers n ≤x divisible by a prime
power pr ≥log4 x. Then
N1(x)
≤

p≥log2 x
 x
p2

+

p<log2 x
 x
pup

≤
x

p≥log2 x
1
p2 +

x
log4 x


p<log2 x
1
≤
x

n≥log2 x
1
n2 +

x
log4 x

log2 x
≪
x
log2 x.
This completes the proof. 2
The next result states that it is rare for a number to have many distinct
prime divisors or to have only small prime divisors. Let ω(n) denote the
number of distinct primes that divide n. Let P(n) denote the greatest prime
divisor of n.
Lemma 7.5 Let x ≥ee and y = log log x. The number of positive integers
n ≤x such that either ω(n) ≥5y or P(n) ≤x1/(6y) is O(x log−2 x) for all
suﬃciently large x.
Proof. Let N2(x) denote the number of positive integers n ≤x with
ω(n) ≥5y. By Exercise 9 in Section 7.1,
N2(x) ≪
x
(log x)5 log 2−1 ≤
x
log2 x.

262
7. Divisor Functions
Let p be a prime. If pr ≤x, then 0 ≤r ≤log x/ log p ≤log x/ log 2, and so
the number of prime powers pr ≤x with p ≤x1/(6y) does not exceed

1 + log x
log 2

x1/(6y) ≪x1/(6y) log x.
Let N3(x) denote the number of integers n ≤x such that ω(n) < 5y and
P(n) ≤x1/(6y). Then
N3(x) ≪

x1/(6y) log x
5y
≪
x
log2 x
for all suﬃciently large x. 2
Combining Lemma 7.4 and Lemma 7.5, we obtain the following result.
Lemma 7.6 There are only O(x log−2 x) integers n ≤x that fail to satisfy
all of the following three conditions:
(i) If pr divides n and r ≥2, then pr < log4 x.
(ii) ω(n) < 5y.
(iii) P(n) > x1/(6y).
Lemma 7.7 Let n ≤x be a primitive k-abundant number satisfying con-
ditions (i), (ii), and (iii) of Lemma 7.6. Then n is divisible by a prime p
such that
log4 x ≤p ≤x1/(13y).
(7.10)
Proof. If not, then we can write n = ab, where a is a product of primes
less than log4 x, and b is a product of primes greater than x1/(13y). Since
x1/(13y) < x1/(6y), condition (iii) implies that b > 1.
By condition (ii), ω(b) ≤ω(n) < 5y. Then
σ(b)
b
<

p|b

1 + 1
p + 1
p2 + · · ·

≤

p|b

1 + 2
p

<

1 +
2
x1/(13y)
ω(b)
<

1 +
2
x1/(13y)
5y
<
1 +
20y
x1/(13y)

7.6 Abundant Numbers
263
if x is suﬃciently large (by Exercise 4 with c = 2). Every prime that
divides a is less than log4 x, and, by condition (i), every prime power that
divides n, and hence a, is also less than log4 x. Since ω(a) ≤ω(n) < 5y by
condition (ii), it follows that
1 ≤a < (log4 x)5y = (log x)20y.
By condition (iii), b > 1, and so a < n. Since a is a proper divisor of the
primitive k-abundant number n, we have
σ(a) < ka.
Since k is an integer, we have
σ(a) ≤ka −1,
and so
σ(a)
a
≤k −1
a < k −
1
(log x)20y .
Since σ(n) is multiplicative and n = ab with (a, b) = 1, we have, for x
suﬃciently large,
σ(n)
n
=
σ(a)
a
σ(b)
b
<

k −
1
(log x)20y
 
1 +
20y
x1/(13y)

<
k +
20ky
x1/(13y) −
1
(log x)20y
<
k,
which is impossible, since the integer n is k-abundant. Therefore, n must
be divisible by a prime p in the interval (7.10). 2
Lemma 7.8 If x is suﬃciently large and n ≤x is a primitive k-abundant
number satisfying conditions (i), (ii), and (iii) of Lemma 7.6, then
k ≤σ(n)
n
< k +
k
x1/(6y) .
Proof. By condition (iii), the integer n is divisible by a prime p such
that
p ≥P(n) > x1/(6y).
Since p2 > x1/(3y) > log4 x for x suﬃciently large, condition (i) implies that
p2 does not divide n. Therefore n = mp, where (m, p) = 1 and σ(m) < km
since n is primitive k-abundant. It follows that
σ(n)
n
= σ(m)
m
σ(p)
p
< k

1 + 1
p

< k +
k
x1/(6y) .

264
7. Divisor Functions
This completes the proof. 2
Theorem 7.16 For every integer k ≥2, let PAk(x) denote the number of
primitive k-abundant numbers not exceeding x. Then
PAk(x) ≪
x
log2 x
and the set Ak of k-abundant numbers possesses an asymptotic density
Proof. By Lemma 7.6 there are only O(x log−2 x) primitive k-abundant
integers that fail to satisfy conditions (i), (ii), and (iii) of Lemma 7.6.
Let t be the number of primitive k-abundant integers n ≤x that do
satisfy these three conditions. We denote these numbers by n1, . . . , nt. By
Lemma 7.7, corresponding to each integer ni there is a prime pi such that
pi exactly divides ni and
log4 x ≤pi ≤x1/(13y).
Let ni = pimi. Then (pi, mi) = 1 and
1 ≤mi ≤
x
log4 x.
It suﬃces to prove that the integers mi are distinct.
Suppose that mi = mj for some i ̸= j. Then pi ̸= pj. Since
σ(ni)
ni
= (pi + 1)
pi
σ(mi)
mi
and
σ(nj)
nj
= (pj + 1)
pj
σ(mi)
mi
,
it follows that
σ(ni)nj
niσ(nj) = (pi + 1)pj
pi(pj + 1).
Since pi and pj are distinct primes, it follows that (pi + 1)pj ̸= pi(pj + 1).
We can assume that (pi + 1)pj > pi(pj + 1), and so
σ(ni)nj
niσ(nj)
=
(pi + 1)pj
pi(pj + 1)
≥
1 +
1
pi(pj + 1)
≥
1 +
1
x1/(13y)(x1/(13y) + 1)
≥
1 +
1
2x2/(13y) .

7.7 Notes
265
By Lemma 7.8,
σ(ni)nj
niσ(nj) <

k +
k
x1/(6y)
 1
k < 1 +
1
x1/(6y) .
This is a contradiction, since
2x2/(13y) < x1/(6y)
for all suﬃciently large x. It follows that the numbers m1, . . . , mt are dis-
tinct, and so t ≤x log−4 x. This completes the proof. 2
Exercises
1. Prove that 120 is a 3-abundant number.
2. Prove that σ(rn) > rσ(n) for every r ≥2.
3. Prove that every abundant number is a multiple of a primitive abun-
dant number. Prove that every k-abundant number is a multiple of a
primitive k-abundant number.
4. Prove that for every c > 1 there exists a number δ0(c) > 0 such that
for all u > 0 and v > 0 with uv < δ0(c),
(1 + u)v < 1 + cuv.
7.7
Notes
Ramanujan stated Theorem 7.8 in [121]. Wilson [157] published a proof
of this result. Ingham [69] proved Theorems 7.11 and 7.12. Johnson [75]
generalized Theorem 7.11 to sums of any ﬁnite number of products. He
proved that for any integer s ≥2, the number of solutions in positive
integers of the diophantine equation
n = x1y1 + · · · + xsys
is asymptotic to
ds−1(n) logs n
(s −1)!ζ(s) ,
where ζ(s) is the Riemann zeta function.
Besicovitch [10] constructed the ﬁrst example of a set of multiples that
does not have asymptotic density.

266
7. Divisor Functions
Theorem 7.16 on the asymptotic density of the abundant numbers was
proved independently by Chowla [16], Erd˝os [31], and Davenport [19]. The
proof in this book is due to Erd˝os. For reﬁnements and generalizations of
this result, see Elliott, Probabilistic Number Theory I [28, Theorem 5.6].
There are excellent research monographs on many of the topics in this
chapter, for example, Halberstam and Roth, Sequences [48, Chapter 5],
Hall, Sets of Multiples [49], and Hall and Tenenbaum, Divisors [50]. Dick-
son [25, Vol. I, Chapter I] is a historical catalog of results on perfect, abun-
dant, deﬁcient, and amicable numbers.

8
Prime Numbers
8.1
Chebyshev’s Theorems
Let π(x) denote the number of prime numbers not exceeding x, that is,
π(x) =

p≤x
1
is the counting function for the set of primes. Euclid proved that there are
inﬁnitely many primes, or, equivalently,
lim
x→∞π(x) = ∞.
A classical problem in number theory is to understand the distribution of
prime numbers. This problem is still fundamentally unsolved, even though
we know many beautiful results about the growth of π(x) as x tends to
inﬁnity. In this chapter we shall show that the order of magnitude of π(x)
is x/ log x. In Chapter 9 we shall prove the prime number theorem, which
states that π(x) is asymptotic to x/ log x, that is,
lim
x→∞
π(x) log x
x
= 1.
We introduce the Chebyshev functions
ϑ(x) =

p≤x
log p = log

p≤x
p

268
8. Prime Numbers
and
ψ(x) =

pk≤x
log p.
For example,
ϑ(10) = log 2 + log 3 + log 5 + log 7
and
ψ(10) = 3 log 2 + 2 log 3 + log 5 + log 7.
The functions ϑ(x) and ψ(x) count the primes p ≤x and prime powers
pk ≤x, respectively, with weights log p. Clearly,
ϑ(x) ≤ψ(x).
If pk ≤x, then k ≤[log x/ log p], and so
ψ(x)
=

pk≤x
k≥1
log p =

p≤x




pk≤x
k≥1
1


log p =

p≤x
log x
log p

log p
≤

p≤x
log x = π(x) log x.
Chebyshev proved that the functions ϑ(x) and ψ(x) have order of magni-
tude x and that π(x) has order of magnitude x/ log x.
Before proving these theorems, we need two results about binomial co-
eﬃcients. The ﬁrst lemma states that for ﬁxed n, the sequence of binomial
coeﬃcients
n
k

is unimodal in the sense that it is increasing for k ≤n/2 and
decreasing for k ≥n/2. In the second lemma we apply the binomial theo-
rem to obtain upper and lower bounds for the middle binomial coeﬃcient
2n
n

.
Lemma 8.1 Let n ≥1 and 1 ≤k ≤n. Then

n
k −1

<
n
k

if and only if k < n+1
2 ,

n
k −1

>
n
k

if and only if k > n+1
2 ,

n
k −1

=
n
k

if and only if n is odd and k = n+1
2 .
Proof. Consider the ratio
r(k) =
n
k

 n
k−1
 =
n!
k!(n−k)!
n!
(k−1)!(n−k+1)!
= (k −1)!(n −k + 1)!
k!(n −k)!
= n −k + 1
k
.
Then r(k) > 1 if and only if k < (n + 1)/2, and r(k) < 1 if and only if
k > (n + 1)/2. 2

8.1 Chebyshev’s Theorems
269
Lemma 8.2 For all positive integers n,
22n
2n ≤
2n
n

< 22n.
Proof. By the binomial theorem,
22n = (1 + 1)2n =
2n

k=0
n
k

>
2n
n

.
By Lemma 8.1, the middle binomial coeﬃcient
2n
n

is the largest binomial
coeﬃcient in the expansion of (1 + 1)2n. Therefore,
22n
=
2n

k=0
2n
k

= 1 +
2n−1

k=1
2n
k

+ 1
≤
2 + (2n −1)
2n
n

≤
2n
2n
n

.
This completes the proof. 2
Theorem 8.1 For every positive integer n,

p≤n
p < 4n.
(8.1)
Equivalently, for every real number x ≥1
ϑ(x) < x log 4.
(8.2)
Proof. Let m ≥1. We consider the binomial coeﬃcients
M
=
2m + 1
m

=
2m + 1
m + 1

=
(2m + 1)2m(2m −1)(2m −2) · · · (m + 2)
m!
.
This is an integer, since M is a binomial coeﬃcient. Moreover,
2M
=
2m + 1
m

+
2m + 1
m + 1

<
2m+1

k=0
2m + 1
k

=
22m+1,

270
8. Prime Numbers
and so
M < 4m.
If p is a prime number such that m + 2 ≤p ≤2m + 1, then p divides the
product
(2m + 1)2m(2m −1)(2m −2) · · · (m + 2),
but p does not divide m!. It follows that p divides M, and so

m+2≤p≤2m+1
p
divides M. Therefore,

m+2≤p≤2m+1
p ≤M < 4m
(8.3)
for all positive integers m.
We shall prove inequality (8.1) by induction on n. This inequality holds
for n = 1 and n = 2, since 1 < 41 and 2 < 42, respectively. Let n ≥3, and
assume that (8.1) holds for all positive integers m < n. If n is even, then

p≤n
p =

p≤n−1
p < 4n−1 < 4n.
If n is odd, then n = 2m + 1 for some m ≥1, and

p≤n
p =

p≤m+1
p

m+2≤p≤2m+1
p.
By the induction hypothesis we have

p≤m+1
p < 4m+1.
(8.4)
It follows from (8.3) and (8.4) that

p≤n
p =

p≤m+1
p

m+2≤p≤2m+1
p < 4m+14m = 42m+1 = 4n.
This proves (8.1).
Inequality (8.2) follows from (8.1) as follows. If x ≥1, then n = [x] ≥1
and
ϑ(x) = ϑ(n) = log

p≤n
p < n log 4 ≤x log 4.
The proof that (8.2) implies (8.1) is similar. 2
We can now prove Chebyshev’s theorem that the functions ϑ(x), ψ(x),
and π(x) log x all have order of magnitude x.

8.1 Chebyshev’s Theorems
271
Theorem 8.2 (Chebyshev) There exist positive constants A and B such
that
Ax ≤ϑ(x) ≤ψ(x) ≤π(x) log x ≤B
(8.5)
for all x ≥2. Moreover,
lim inf
x→∞
ϑ(x)
x
= lim inf
x→∞
ψ(x)
x
= lim inf
x→∞
π(x) log x
x
≥log 2
and
lim sup
x→∞
ϑ(x)
x
= lim sup
x→∞
ψ(x)
x
= lim sup
x→∞
π(x) log x
x
≤log 4.
Proof. Theorem 8.1 gives the upper bound ϑ(x) < x log 4, and so
lim sup
x→∞
ϑ(x)
x
≤log 4.
We shall compute a lower bound for ψ(x). Let n be a positive integer, and
consider the middle binomial coeﬃcient N =
2n
n

. Applying Theorem 1.12,
we write N as a product of prime powers as follows:
N =
2n
n

= (n + 1)(n + 2) · · · 2n
n!
= (2n)!
n!2
=

p≤2n
pvp((2n)!)−2vp(n!),
where
vp((2n)!) −2vp(n!) =
[log 2n/ log p]

k=1
2n
pk

−2
 n
pk

.
By Exercise 7, [2t] −2[t] = 0 or 1 for all real numbers t, it follows that
0 ≤vp((2n)!) −2vp(n!) ≤
log 2n
log p

.
By Lemma 8.2,
22n
2n ≤N =

p≤2n
pvp((2n)!)−2vp(n!) ≤

p≤2n
p[
log 2n
log p ],
and so
2n log 2 −log 2n ≤

p≤2n
log 2n
log p

log p = ψ(2n).
Let x ≥2 and n = [x/2]. Then
2n ≤x < 2n + 2
and
ψ(x)
≥
ψ(2n) ≥2n log 2 −log 2n
>
(x −2) log 2 −log x = x log 2 −log x −2 log 2.

272
8. Prime Numbers
Therefore,
lim inf
x→∞
ψ(x)
x
≥log 2.
We obtain a lower bound for ϑ(x) in terms of π(x) log x as follows. If
0 < δ < 1,
then
ϑ(x)
≥

x1−δ<p≤x
log p
≥

x1−δ<p≤x
(1 −δ) log x
=
(1 −δ)

π(x) −π(x1−δ)

log x
≥
(1 −δ)π(x) log x −x1−δ log x,
and so
ϑ(x)
x
≥(1 −δ)π(x) log x
x
−log x
xδ .
It follows that
lim inf
x→∞
ϑ(x)
x
≥(1 −δ) lim inf
x→∞
π(x) log x
x
.
This holds for all δ > 0, and so
lim inf
x→∞
ϑ(x)
x
≥lim inf
x→∞
π(x) log x
x
.
(8.6)
Similarly,
lim sup
x→∞
ϑ(x)
x
≥lim sup
x→∞
π(x) log x
x
.
(8.7)
The inequality
ϑ(x) ≤ψ(x) ≤π(x) log x
implies that
lim inf
x→∞
ϑ(x)
x
≤lim inf
x→∞
ψ(x)
x
≤lim inf
x→∞
π(x) log x
x
(8.8)
and
lim sup
x→∞
ϑ(x)
x
≤lim sup
x→∞
ψ(x)
x
≤lim sup
x→∞
π(x) log x
x
.
(8.9)
Inequalities (8.6) and (8.8) give
lim inf
x→∞
ϑ(x)
x
= lim inf
x→∞
ψ(x)
x
= lim inf
x→∞
π(x) log x
x
≥log 2.

8.1 Chebyshev’s Theorems
273
Combining (8.7) and (8.9), we obtain
lim sup
x→∞
ϑ(x)
x
= lim sup
x→∞
ψ(x)
x
= lim sup
x→∞
π(x) log x
x
≤log 4.
This completes the proof. 2
Theorem 8.3 Let pn denote the nth prime number. There exist positive
constants a and b such that
an log n ≤pn ≤bn log n
for all n ≥2.
Proof. By Chebyshev’s inequality (8.5), there exist positive constants A
and B such that
Apn ≤π(pn) log pn = n log pn ≤Bpn.
Let a = B−1 > 0. Since pn ≥n, we have
pn ≥B−1n log pn ≥an log n.
Similarly,
pn ≤A−1n log pn.
For n suﬃciently large,
log pn
≤
log n + log log pn −log A
≤
log n + 2 log log pn
≤
log n + (1/2) log pn,
and so
log pn ≤2 log n.
Therefore, there exists an integer n0 ≥2 such that
pn ≤A−1n log pn ≤2A−1n log n
for all n ≥n0. Since pn/n log n is bounded for 2 ≤n ≤n0, there exists a
constant b such that pn ≤bn log n for all n ≥2. This completes the proof.
2
There is a useful notation for describing the order of magnitude of func-
tions. Let f be a complex-valued function with domain D, and let g be a

274
8. Prime Numbers
function on D such that g(x) > 0 for all x ∈D. The domain D can be a
set of real numbers or of integers. We write
f = O(g)
or
f ≪g
if there exists a constant c such that
|f(x)| ≤cg(x)
for all x ∈D.
For example, Chebyshev’s theorem states that
ϑ(x) = O(x).
If D ⊆R and lim sup D = ∞, that is, if D contains arbitrarily large real
numbers, then we write
f = o(g)
if
lim
x→∞
x∈D
f(x)
g(x) = 0.
It follows from Chebyshev’s theorem that
π(x) = o(x).
We also denote by O(g) (resp. o(g)) any function f such that f = O(g)
(resp. f = o(g)). For example, ex = 1 + O(x) on every interval [1, x0],
sin x = O(x) for all x, and log x = o(xa) for every a > 0.
We say that the function f is asymptotic to g, written
f ∼g,
if
lim
x→∞
x∈D
f(x)
g(x) = 1.
The prime number theorem states that π(x) ∼x/ log x. Since limx→∞f(x) =
a if and only if lim infx→∞f(x) = lim supx→∞f(x) = a, Theorem 8.2 im-
plies that the following asymptotic formulae are equivalent:
π(x)
∼
x
log x
ϑ(x)
∼
x
ψ(x)
∼
x.

8.2 Mertens’s Theorems
275
Exercises
1. Compute the asymptotic density of the set of prime numbers.
2. Compute the asymptotic density of the set of prime powers.
Hint: Let Π(x) denote the number of prime powers pk ≤x. Show that
Π(x) = Π(√x) + (Π(x) −Π(√x)) ≪π(x).
3. Compute the asymptotic density of the set of integers divisible by at
least two distinct primes.
4. Prove that
ψ(x) = ϑ(x) + O(√x).
5. Prove that ψ(x) = log N, where N is the least common multiple of
the positive integers not exceeding x.
6. Prove that there exist positive real numbers α and β such that
nαn <
n

i=1
pi < nβn.
7. Prove that [kt] −k[t] ∈{0, 1, . . . , k −1} for all positive integers k and
real numbers t.
8. Prove that there exists a constant c such that, for all x suﬃciently
large, there exists a prime p such that x < p < (1 + c)x.
9. The prime number theorem states that ϑ(x) ∼x. Prove that the
prime number theorem implies that for every δ > 0 there is a number
x0(δ) such that, for all x ≥x0(δ), there exists a prime p such that
x < p < (1 + δ)x.
8.2
Mertens’s Theorems
We begin by describing two arithmetic functions whose values are loga-
rithms of primes.
We deﬁne the function ℓ(n) by
ℓ(n) =

log p
if n = p is a prime power,
0
otherwise.
Chebyshev’s function ϑ(x) is the sum function of the ℓ-function, since

n≤x
ℓ(n) =

p≤x
log p = ϑ(x).

276
8. Prime Numbers
The von Mangoldt function Λ(n) is deﬁned by
Λ(n) =

log p
if n = pk is a prime power,
0
otherwise.
Chebyshev’s function ψ(x) is the sum function of the von Mangoldt func-
tion, since

n≤x
Λ(n) =

pk≤x
log p = ψ(x).
Moreover,

d|n
Λ(d) = log n.
Theorem 8.4 For x ≥2,

m≤x
ψ
 x
m

=

d≤x
Λ(d)
.x
d
/
= x log x −x + O(log x).
Proof. With f(n) = Λ(n) in Theorem 6.15, we have
F(x) =

n≤x
Λ(n) = ψ(x),
and so

m≤x
ψ
 x
m

=

d≤x
Λ(d)
.x
d
/
=

n≤x

d|n
Λ(d)
=

n≤x
log n
=
x log x −x + O(log x).
The last identity comes from Theorem 6.4. 2
Theorem 8.5 (Mertens) For x ≥1,

n≤x
Λ(n)
n
= log x + O(1)
(8.10)
and

p≤x
log p
p
= log x + O(1).
(8.11)

8.2 Mertens’s Theorems
277
Proof. Since ψ(x) = O(x) by Chebyshev’s theorem, we have
x log x −x + O(log x)
=

d≤x
Λ(d)
.x
d
/
=

d≤x
Λ(d)
x
d −
0x
d
1
=
x

d≤x
Λ(d)
d
−

d≤x
Λ(d)
0x
d
1
=
x

d≤x
Λ(d)
d
+ O(ψ(x))
=
x

d≤x
Λ(d)
d
+ O(x).
We obtain equation (8.10) by dividing by x.
Next, we observe that

n≤x
Λ(n)
n
−

p≤x
log p
p
=

pk≤x
k≥2
log p
pk
≤

p≤x
log p
∞

k=2
1
pk
≤

p≤x
log p
p(p −1)
≪
1.
This proves (8.11). 2
Theorem 8.6

n≤x
ϑ(n)
n2
= log x + O(1).
Proof. We begin with the convergent series

k≤x
ℓ(k)
k2
≤
∞

k=1
ℓ(k)
k2
<
∞

k=1
log k
k2
< ∞.
By Theorem 6.3 applied to the function f(t) = 1/t2, we have

n≤x
ϑ(n)
n2
=

n≤x

k≤n
ℓ(k)
n2

278
8. Prime Numbers
=

k≤x
ℓ(k)

k≤n≤x
1
n2
=

k≤x
ℓ(k)
1
k −1
x + O
 1
k2

=

k≤x
ℓ(k)
k
−ϑ(x)
x
+ O


k≤x
ℓ(k)
k2


=

p≤x
log p
p
+ O(1)
=
log x + O(1),
by Theorem 8.5. 2
Theorem 8.7 (Mertens) There exists a constant b1 such that

p≤x
1
p = log log x + b1 + O

1
log x

for x ≥2.
Proof. We can write

p≤x
1
p =

p≤x
log p
p
1
log p =

2≤n≤x
f(n)g(n),
where
f(n) =

log p
p
if n = p,
0
otherwise,
and
g(t) =
1
log t
for t > 1.
Let
F(t) =

n≤t
f(n) =

p≤t
log p
p
.
Then F(t) = 0 for t < 2. By Theorem 8.5,
F(t) = log t + r(t),
where r(t) = O(1).
Therefore, the integral
# ∞
2
r(t)
t(log t)2 dt

8.2 Mertens’s Theorems
279
converges absolutely, and
# ∞
x
r(t)dt
t(log t)2 = O

1
log x

.
By partial summation, we obtain

p≤x
1
p
=

n≤x
f(n)g(n)
=
F(x)g(x) −
# x
2
F(t)g′(t)dt
=
log x + r(x)
log x
+
# x
2
log t + r(t)
t(log t)2 dt
=
1 + O

1
log x

+
# x
2
1
t log tdt +
# x
2
r(t)
t(log t)2 dt
=
log log x + 1 −log log 2 +
# ∞
2
r(t)
t(log t)2 dt
−
# ∞
x
r(t)
t(log t)2 dt + O

1
log x

=
log log x + b1 + O

1
log x

,
where
b1 = 1 −log log 2 +
# ∞
2
r(t)
t(log t)2 dt.
(8.12)
This completes the proof. 2
Theorem 8.8 (Mertens’s formula) There exists a constant γ such that
for x ≥2,

p≤x

1 −1
p
−1
= eγ log x + O(1).
Remark. See Nathanson [2, pp. 162–165] for a proof that γ is Euler’s
constant, constructed in Theorem 6.9.
Proof. We begin with two observations. First, the series 
p
∞
k=2 p−k/k
converges, since

p
∞

k=2
1
kpk <

p
∞

k=2
1
pk =

p
1
p(p −1) <
∞

n=2
1
n(n −1) < ∞.
Let
b2 =

p
∞

k=2
1
kpk > 0.

280
8. Prime Numbers
Second, for x ≥2,
0 <

p>x
∞

k=2
1
kpk
<

p>x
1
p(p −1) <

n>x
1
n(n −1)
=
∞

n=[x]+1

1
n −1 −1
n

= 1
[x]
≤
2
x.
From the Taylor series
−log(1 −t) =
∞

k=1
tk
k
for |t| < 1
and Theorem 8.7 we obtain
log

p≤x

1 −1
p
−1
=

p≤x
log

1 −1
p
−1
=

p≤x
∞

k=1
1
kpk
=

p≤x
1
p +

p≤x
∞

k=2
1
kpk
=
log log x + b1 + O

1
log x

+ b2 −

p>x
∞

k=2
1
kpk
=
log log x + b1 + b2 + O

1
log x

+ O
 1
x

=
log log x + b1 + b2 + O

1
log x

.
Let γ = b1 + b2. Then

p≤x

1 −1
p
−1
= eγ log x exp

O

1
log x

.
Since exp(t) = 1 + O(t) for t in any bounded interval [0, t0], and since
O (1/ log x) is bounded for x ≥2, we have
exp

O

1
log x

= 1 + O

1
log x

.

8.2 Mertens’s Theorems
281
Therefore,

p≤x

1 −1
p
−1
=
eγ log x exp

O

1
log x

=
eγ log x

1 + O

1
log x

=
eγ log x + O(1).
This is Mertens’s formula. 2
Exercises
1. Prove that 1 ∗Λ = L, or, equivalently,

d|n
Λ(d) = log n.
Prove that Λ = µ ∗L.
2. Prove that

x<p≤2x
log p
p
= O(1).
3. Prove that

p≤x
log2 p
p
= 1
2 log2 x + O(log x).
Hint: Observe that

p≤x
log2 p
p
=

n≤x
ℓ(n)
n

log n,
and use partial summation.
4. Prove that

p≤x
logk p
p
= 1
k logk x + O(logk−1 x)
for every positive integer k.
Hint: Use induction on k.
5. Prove that

n≤x
ℓ∗ℓ(n)
n
=

pq≤x
log p log q
pq
= 1
2 log2 x + O(log x).

282
8. Prime Numbers
Hint: Observe that

pq≤x
log p log q
pq
=

p≤x
log p
p

q≤x/p
log q
q
,
and use Mertens’s formula (8.11).
6. Prove that

n≤x
ℓ∗ℓ(n)
n log n =

pq≤x
log p log q
pq log pq = log x + O(log log x).
Hint: Use partial summation and the previous exercise.
7. Prove that
lim sup
n→∞
σ(n)
n
= ∞.
Hint: Use Exercise 12 in Section 7.3.
8.3
The Number of Prime Divisors of an Integer
The arithmetic function ω(n) counts the number of distinct prime divisors
of the positive integer n, that is,
ω(n) =

p|n
1.
We have
ω(1)
=
0,
ω(6)
=
2,
ω(2)
=
1,
ω(7)
=
1,
ω(3)
=
1,
ω(8)
=
1,
ω(4)
=
1,
ω(9)
=
1,
ω(5)
=
1
ω(10)
=
2.
The arithmetic function Ω(n) counts the total number of primes whose
product is n, that is,
Ω(n) =

pr∥n
r.
We have
Ω(1)
=
0,
Ω(6)
=
2,
Ω(2)
=
1,
Ω(7)
=
1,
Ω(3)
=
1,
Ω(8)
=
3,
Ω(4)
=
2,
Ω(9)
=
2,
Ω(5)
=
1
Ω(10)
=
2.
If
n = pr1
1 pr2
2 · · · prk
k

8.3 The Number of Prime Divisors of an Integer
283
is the standard factorization of n as a product of powers of distinct primes,
then
ω(n) = k
and
Ω(n) = r1 + r2 + · · · + rk.
We shall prove that almost all integers up to x have log log x distinct prime
factors. We begin with estimates for the mean value and mean-squared
value of ω(n)
Theorem 8.9 For x ≥2,

n≤x
ω(n) = x log log x + b1x + O

x
log x

,
where b1 is the positive real number deﬁned by (8.12).
Proof. Applying Chebyshev’s theorem (Theorem 8.2) and Mertens’s the-
orem (Theorem 8.7), we obtain

n≤x
ω(n)
=

n≤x

p|n
1 =

p≤x

n≤x
p|n
1
=

p≤x
x
p

=

p≤x
x
p + O (π(x))
=
x

p≤x
1
p + O

x
log x

=
x

log log x + b1 + O

1
log x

+ O

x
log x

=
x log log x + b1x + O

x
log x

.
2
Theorem 8.10 For x ≥2,

n≤x
ω(n)2 = x(log log x)2 + O(x log log x).
Proof. We have
ω(n)2
=


p|n
1


2
=


p1|n
1




p2|n
1


=

p1p2|n
p1̸=p2
1 +

p|n
1 =

p1p2|n
p1̸=p2
1 + ω(n).

284
8. Prime Numbers
By Theorem 8.9,

n≤x
ω(n)2
=

n≤x

p1p2|n
p1̸=p2
1 +

n≤x
ω(n)
=

p1p2≤x
p1̸=p2

n≤x
p1p2|n
1 + x log log x + O(x)
=

p1p2≤x
p1̸=p2
 x
p1p2

+ O(x log log x)
=

p1p2≤x
p1̸=p2
x
p1p2
+ O




p1p2≤x
p1̸=p2
1


+ O(x log log x)
=
x

p1p2≤x
p1̸=p2
1
p1p2
+ O(x log log x),
since, by the Fundamental Theorem of Arithmetic, there are at most 2x
ordered pairs (p1, p2) of distinct primes such that p1p2 ≤x. From Theo-
rem 8.7, we obtain

p1p2≤x
p1̸=p2
1
p1p2
≤


p≤x
1
p


2
=
(log log x + O(1))2
=
(log log x)2 + O(log log x)
and

p1p2≤x
p1̸=p2
1
p1p2
≥


p≤√x
1
p


2
−

p≤√x
1
p2
=
(log log √x + O(1))2 + O(1)
=
(log log x)2 + O(log log x).
Therefore,

n≤x
ω(n)2 = x(log log x)2 + O(x log log x).
This completes the proof. 2
We also need the following result, which is essentially Chebyshev’s in-
equality in probability theory.

8.3 The Number of Prime Divisors of an Integer
285
Theorem 8.11 (Chebyshev’s inequality) Let S be a ﬁnite set of inte-
gers, and let f be a real-valued function deﬁned on S. Let µ and t be real
numbers with t > 0. Then the number of integers n ∈S such that
|f(n) −µ| ≥t
does not exceed
1
t2

n∈S
(f(n) −µ)2.
Proof. If |f(n) −µ| ≥t, then
1 ≤(f(n) −µ)2
t2
and
card{n ∈S : |f(n) −µ| ≥t}
=

n∈S
|f(n)−µ|≥t
1
≤

n∈S
|f(n)−µ|≥t
(f(n) −µ)2
t2
≤
1
t2

n∈S
(f(n) −µ)2.
2
Now we prove that ω(n) has “normal order” log log n in the sense that
ω(n) is close to log log n for almost all n.
Theorem 8.12 (Hardy–Ramanujan) For every δ > 0, the number of
integers n ≤x such that
|ω(n) −log log n| ≥(log log x)
1
2 +δ
is o(x).
Proof. (Tur´an [143]) Let S be the set of positive integers n not exceeding
x, f(n) = ω(n), and µ = log log x. Applying Chebyshev’s inequality, we
see that for any t > 0, the number of integers n ≤x such that |ω(n) −
log log x| ≥t is at most
1
t2

n≤x
(ω(n) −log log x)2.

286
8. Prime Numbers
We use Theorem8.9 and Theorem8.10 to evaluate this sum as follows:

n≤x
(ω(n) −log log x)2
=

n≤x
ω(n)2 −2 log log x

n≤x
ω(n) +

n≤x
(log log x)2
=
x(log log x)2 + O(x log log x) −2 log log x(x log log x + O(x))
+ x(log log x)2 + O((log log x)2)
=
O(x log log x).
Let δ > 0 and t = (log log x)
1
2 +δ −1. Then
t2
>
(log log x)1+2δ −2(log log x)
1
2 +δ
=
(log log x)1+δ 
(log log x)δ −2(log log x)−1/2
≥
(log log x)1+δ
for x suﬃciently large. Therefore, if
T = {n ∈S : |ω(n) −log log x| ≥(log log x)
1
2 +δ −1},
then
|T|
≪
x log log x

(log log x)
1
2 +δ −1
2
<
x log log x
(log log x)1+δ
=
x
(log log x)δ
=
o(x).
Let x > ee. If
x1/e ≤n ≤x,
then
0 < log log x −1 ≤log log n ≤log log x.
If
|ω(n) −log log n| ≥(log log x)
1
2 +δ,
then
|ω(n) −log log x|
≥
|ω(n) −log log n| −| log log x −log log n|
≥
(log log x)
1
2 +δ −1
=
t.

8.4 Notes
287
Therefore, if
U = {n ∈S : |ω(n) −log log n| ≥(log log x)
1
2 +δ},
then U ⊆T and so
|U| ≤x1/e + |T| = o(x).
This completes the proof. 2
Exercises
1. Compute ω(n) and Ω(n) for 11 ≤n ≤20.
2. Prove that there exists a constant b3 such that for x ≥2,
1
x

n≤x
Ω(n) = log log x + b3 + O

1
log x

.
8.4
Notes
There are many beautiful open problems about prime numbers. Here are
some examples.
1. Do there exist inﬁnitely many primes p of the form p = n2 + 1. For
example, 5 = 22 + 1, 17 = 42 + 1, and 101 = 102 + 1. The best result
is due to Iwaniec [73], who proved that there exist inﬁnitely many
integers n such that n2 + 1 is either prime or the product of two
primes.
2. The twin prime conjecture states that there exist inﬁnitely many
primes p such that p+2 is also prime. For example, {11, 13}, {29, 31},
and {101, 103} are twin primes.
3. The Goldbach conjecture states that every even number n ≥4 can be
written as the sum of two primes. For example, 4 = 2 + 2, 8 = 3 + 5,
and 100 = 17 + 83.
4. A polynomial f(t) with integer coeﬃcients has prime divisor p if p
divides f(t) for every integer t. We say that f(t) represents a prime
p if there is an integer n such that f(n) = p. Dirichlet’s theorem
(Theorem 10.9) states that if m and a are relatively prime integers
with m ≥1, then the polynomial f(t) = mt + a represents inﬁnitely
many primes. These linear polynomials are the only polynomials that
are known to represent inﬁnitely many primes.

288
8. Prime Numbers
It is conjectured that if f(t) is any irreducible polynomial with integer
coeﬃcients and positive leading coeﬃcient, and if f(t) has no prime
divisor, then the polynomial f(t) represents inﬁnitely many primes.
An even more general conjecture, called Schinzel’s Hypothesis H [124,
125], states that if f1(t), . . . , fr(t) are irreducible polynomials with
positive leading coeﬃcients, and if the polynomial f1(t) · · · fr(t) has
no prime divisor, then there exist inﬁnitely many n such that the
r numbers f1(n), . . . , fr(n) are simultaneously prime. Many classi-
cal problems are special cases of this conjecture. For example, the
problem about primes of the form n2 + 1 is the case r = 1 and
f1(t) = t2 + 1. The twin prime conjecture is the case r = 2, f1(t) = t,
and f2(t) = t + 2.
5. A conjecture of Schinzel and Sierpi´nski [125] asserts that every pos-
itive rational number x can be represented as a quotient of shifted
primes, that is, x = (p + 1)/(q + 1) for primes p and q. It is known
that the set of shifted primes {p + 1 : p ∈P} generates a subgroup
of the multiplicative group of positive rational numbers of index at
most 3 (Elliott [30]).
6. Let f1(t), . . . , fr(t) be irreducible polynomials with integer coeﬃ-
cients and positive leading coeﬃcients. Let g(t) be a polynomial with
integer coeﬃcients. Suppose that there exist inﬁnitely many posi-
tive integers N such that N −g(t) is irreducible and the product
f1(t) · · · fr(t)(N −g(t)) has no prime divisor. Schinzel’s Hypothesis
HN asserts that if N is suﬃciently large, then there exists an integer n
such that N −g(n) is prime and fi(n) is prime for all i = 1, . . . , r. The
Goldbach conjecture is the special case when N is even, r = 1 and
f1(t) = g(t) = t. Note that if N is odd, then f1(t)(N −g(t)) = t(N −t)
has the prime divisor 2.
7. Do there exist arbitrarily long ﬁnite arithmetic progressions of primes?
Erd˝os asked the following more general question: If A is an inﬁnite
set of positive integers such that the series 
a∈A a−1 diverges, then
must A contain arbitrarily long ﬁnite arithmetic progressions? If the
answer is yes, this would immediately imply the existence of long
arithmetic progressions of prime numbers, since 
p∈P p−1 diverges
(Theorem 8.7).
All these conjectures are still open, but important techniques, espe-
cially sieve methods and the circle method, have been developed to attack
them, and some deep results have been obtained. More information can
be found in the following books: Halberstam and Richert’s Sieve Meth-
ods [47], Nathanson’s Additive Number Theory: The Classical Bases [2],
and Vaughan’s The Hardy-Littlewood Method [148].

9
The Prime Number Theorem
9.1
Generalized Von Mangoldt Functions
The function π(x) counts the number of prime numbers not exceeding x.
Euclid proved that limx→∞π(x) = ∞. The prime number theorem (PNT),
conjectured independently around 1800 by Gauss and Legendre, states that
π(x) is asymptotic to x/ log x, that is,
lim
x→∞
π(x) log x
x
= 1.
In this chapter we shall give an elementary proof of this theorem, where
“elementary” means that we do not use contour integrals, Cauchy’s the-
orem, or other results from analytic function theory, but only basic facts
about arithmetic functions and the distribution of prime numbers that we
proved in Chapters 6 and 8.
Recall that the von Mangoldt function Λ(n) is equal to log p if n is a
positive power of the prime p, and 0 otherwise. Let L(n) = log n. Then
L = 1 ∗Λ,
where 1(n) = 1 for all n. By M¨obius inversion, we have
Λ = µ ∗L,
and so
Λ(n)
=
(µ ∗L)(n)

290
9. The Prime Number Theorem
=

d|n
µ(d)L(n/d)
=
L(n)

d|n
µ(d) −

d|n
µ(d)L(d)
=
−

d|n
µ(d)L(d).
The divisor function d(n) counts the number of positive divisors of n. Since
d = 1 ∗1, from M¨obius inversion we obtain 1 = µ ∗d, and so
Λ −1 = µ ∗L −µ ∗d = µ ∗(L −d).
For every nonnegative integer r we deﬁne the generalized von Mangoldt
function Λr by
Λr = µ ∗Lr.
Then Λ0 = µ ∗1 = δ, and Λ1 = µ ∗L = Λ is the usual von Mangoldt
function. The elementary proof of the prime number theorem makes use of
the generalized von Mangoldt function Λ2. We have
Λ2(1)
=
0,
Λ2(6)
=
2 log 2 log 3,
Λ2(2)
=
log2 2,
Λ2(7)
=
log2 7,
Λ2(3)
=
log2 3,
Λ2(8)
=
5 log2 2,
Λ2(4)
=
3 log2 2,
Λ2(9)
=
3 log2 3,
Λ2(5)
=
log2 5,
Λ2(10)
=
2 log 2 log 5.
Theorem 9.1 For every positive integer n,
Λ2(n) = Λ(n) log n + Λ ∗Λ(n).
Proof. Recall that pointwise multiplication by the logarithm function
L(n) is a derivation on the ring of arithmetic functions (Theorem 6.2).
Multiplying the identity L = 1 ∗Λ by L, we obtain
L2
=
L · L
=
L · (1 ∗Λ)
=
1 ∗(L · Λ) + (L · 1) ∗Λ
=
1 ∗(Λ · L) + L ∗Λ.
Therefore,
Λ2 = µ ∗L2 = µ ∗1 ∗(Λ · L) + µ ∗L ∗Λ = Λ · L + Λ ∗Λ,
which is the formula we want. 2

9.1 Generalized Von Mangoldt Functions
291
We can compute the function Λ2 = µ∗L2 explicitly. Let ω(n) denote the
number of distinct prime divisors of n. If ω(n) = 0, then n = 1 and
Λ2(1) = µ(1)L(1)2 = 0.
If ω(n) = 1, then n = pk, where p is prime, k is a positive integer, and so
Λ2(pk)
=
µ(1)L2(pk) + µ(p)L2 
pk−1
=
(k log p)2 −((k −1) log p)2
=
(2k −1) log2 p.
If ω(n) = 2, then n = pkqℓ, where p and q are distinct primes, k and ℓare
positive integers, and
Λ2(pkqℓ)
=
µ(1)L2(pkqℓ) + µ(p)L2(pk−1qℓ) + µ(q)L2(pkqℓ−1)
+ µ(pq)L2(pk−1qℓ−1)
=
L2(pkqℓ) −L2(pk−1qℓ) −L2(pkqℓ−1) + L2(pk−1qℓ−1)
=
2 log p log q.
Let ω(n) ≥3. If n = dk, then either d or k is divisible by at least two distinct
primes, and so Λ(d)Λ(k) = 0. Moreover, Λ(n) = 0. Applying Theorem 9.1,
we have
Λ2(n) = L(n)Λ(n) +

dk=n
Λ(d)Λ(k) = 0.
The support of an arithmetic function f(n) is the set of all positive inte-
gers n such that f(n) ̸= 0. We have just shown that the support of Λ2(n)
is the set of all integers n with ω(n) = 1 or 2.
Exercises
1. Compute Λ2(30) directly from the deﬁnition Λ2(n) = µ ∗L2.
2. Prove that
Λ ∗Λ = −µL ∗L.
3. Prove that
L3 = L2 ∗Λ + 2L ∗LΛ + 1 ∗L2Λ
and
Λ3 = Λ2 ∗Λ + LΛ2.
Prove that the support of Λ3 is the set of all integers n such that
1 ≤ω(n) ≤3.

292
9. The Prime Number Theorem
4. Prove that
Lr+1 =
r

k=0
r
k

Lr−k ∗LkΛ
for all r ≥0.
Hint: Use L = 1 ∗Λ and Exercise 6 in Section 6.1.
5. Prove that
Λr+1 = LΛr + Λ ∗Λr
for all r ≥0.
6. Let r ≥1. Prove that the support of Λr is the set of all positive
integers n such that 1 ≤ω(n) ≤r.
7. For a positive number x and positive integers d and n, deﬁne
λ(d) = λx(d) = µ(d) log2 x
d
and
θ(n) = θx(n) = 1 ∗λ(n) =

d|n
λ(d).
Prove that:
(i)
θ(1) = 0.
(ii) If u ≥1, then
θ(pu) = log p log x2
p .
(iii) If u, v ≥1, then
θ(puqv) = 2 log p log q.
(iv) If m is the product of the distinct primes dividing n, then
θ(n) = θ(m).
(v) If n is square-free and p divides n, then
θx(n) = θx
n
p

−θx/p
n
p

.
(vi) If n is divisible by three or more primes, then
θ(n) = 0.
Hint: Reduce to the case of square-free integers n, and use in-
duction on the number of prime factors of n.

9.2 Selberg’s Formulae
293
9.2
Selberg’s Formulae
The elementary proof of the prime number theorem begins with a formula
of Atle Selberg for a sum over products of primes not exceeding x. We give
several versions of this formula.
Theorem 9.2 (Selberg’s formula) For x ≥1, the mean value of the
generalized von Mangoldt function Λ2 is

n≤x
Λ2(n) = 2x log x + O(x).
(9.1)
Proof. We begin with a computation that uses the estimates in Theo-
rems 6.9, 6.11, 6.12, and 6.16.

n≤x
Λ2(n)
=

n≤x
µ ∗L2(n)
=

dk≤x
µ(d) log2 k
=

d≤x
µ(d)

k≤x/d
log2 k
=

d≤x
µ(d)
x
d

log x
d
2
−2x
d log x
d + 2x
d + O

log2 x
d

=
x

d≤x
µ(d)
d
log x
d

log x
d −2

+ 2x

d≤x
µ(d)
d
+ O


d≤x
log2 x
d


=
x

d≤x
µ(d)
d
log x
d

log x
d −2

+ O(x)
=
x

d≤x
µ(d)
d
log x
d


m≤x/d
1
m −γ −2 + O
d
x

+ O(x)
=
x

d≤x
µ(d)
d
log x
d

m≤x/d
1
m −(γ + 2)x

d≤x
µ(d)
d
log x
d + O(x).
We estimate these two sums separately. The ﬁrst sum gives the main term
in Selberg’s formula:
x

d≤x
µ(d)
d
log x
d

m≤x/d
1
m
=
x

dm≤x
µ(d)
dm log x
d

294
9. The Prime Number Theorem
=
x

n≤x
1
n

d|n
µ(d) log x
d
=
x log x

n≤x
1
n

d|n
µ(d) −x

n≤x
1
n

d|n
µ(d) log d
=
x log x + x

n≤x
Λ(n)
n
=
2x log x + O(x),
by Mertens’s formula (8.10). Finally, using Theorem 6.16, we obtain

d≤x
µ(d)
d
log x
d
=

d≤x
µ(d)
d


m≤x/d
1
m −γ + O
d
x


=

dm≤x
µ(d)
dm −γ

d≤x
µ(d)
d
+ O(1)
=

n≤x
1
n

d|n
µ(d) + O(1)
=
O(1).
This completes the proof. 2
Notation. By 
pq≤x we denote the sum over all ordered pairs of primes
(p, q) such that pq ≤x. For example,

pq≤8
log p log q
=
log 2 log 2 + log 2 log 3 + log 3 log 2
=
log2 2 + 2 log 2 log 3.
In the elementary proof of the prime number theorem we shall use the
following equivalent forms of Theorem 9.2.
Theorem 9.3 (Selberg’s formulae) For x ≥1,

p≤x
log2 p +

pq≤x
log p log q
=
2x log x + O(x),
(9.2)
ϑ(x) log x +

p≤x
log p ϑ
x
p

=
2x log x + O(x),
(9.3)

p≤x
log p +

pq≤x
log p log q
log pq
=
2x + O

x
1 + log x

.
(9.4)

9.2 Selberg’s Formulae
295
Proof. By Theorem 9.1,

n≤x
Λ2(n) =

n≤x
Λ(n) log n +

n≤x
Λ ∗Λ(n).
We consider the last two sums separately. The ﬁrst sum is

n≤x
Λ(n) log n =

p≤x
log2 p +

pk≤x
k≥2
k log2 p.
If pk ≤x and k ≥2, then p ≤√x, and so

pk≤x
k≥2
k log2 p
=

p≤√x
log2 p
[
log x
log p]

k=2
k
≤

p≤√x
log2 p
log x
log p
2
≤
√x log2 x
≪
x.
Therefore,

n≤x
Λ(n) log n =

p≤x
log2 p + O(x).
For the second sum, we have

n≤x
Λ ∗Λ(n)
=

n≤x

n=uv
Λ(u)Λ(v)
=

pkqℓ≤x
k,ℓ≥1
log p log q
=

pq≤x
log p log q +

pkqℓ≤x
k,ℓ≥1
k+ℓ≥3
log p log q.
We apply Chebyshev’s theorem to estimate the remainder term.

pkqℓ≤x
k+ℓ≥3
k,ℓ≥1
log p log q
≤

pkqℓ≤x
k≥2
ℓ≥1
log p log q +

pkqℓ≤x
ℓ≥2
k≥1
log p log q
=
2

pkqℓ≤x
k≥2
ℓ≥1
log p log q

296
9. The Prime Number Theorem
=
2

pk≤x
k≥2
log p

qℓ≤x/pk
ℓ≥1
log q
=
2

pk≤x
k≥2
log p ψ
 x
pk

≪

pk≤x
k≥2
x log p
pk
≪
x

p≤x
log p
∞

k=2
1
pk
≪
x

p≤x
log p
p(p −1)
≪
x.
Therefore,

n≤x
Λ ∗Λ(n) =

pq≤x
log p log q + O(x).
It follows from Theorem 9.2 that

n≤x
Λ2(n)
=

n≤x
Λ(n) log n +

n≤x
Λ ∗Λ(n)
=

p≤x
log2 p +

pq≤x
log p log q + O(x)
=
2x log x + O(x).
This proves (9.2).
Recall the arithmetic function
ℓ(n) =
 log n
if n is prime, and
0
otherwise.
We have ϑ(x) = 
n≤x ℓ(n), where ϑ(x)/x = O(1) by Chebyshev’s theorem.
Applying partial summation, we have

p≤x
log2 p
=

n≤x
ℓ(n) log n
=
ϑ(x) log x −
# x
1
ϑ(t)
t
dt
=
ϑ(x) log x + O(x).
Also,

pq≤x
log p log q =

p≤x
log p

q≤x/p
log q =

p≤x
log p ϑ
x
p

.

9.2 Selberg’s Formulae
297
Inserting these two identities into (9.2), we obtain (9.3).
Consider the function f(n) = ℓ(n) log n + ℓ∗ℓ(n). We can restate for-
mula (9.2) as follows:
F(x)
=

n≤x
f(n)
=

n≤x
(ℓ(n) log n + ℓ∗ℓ(n))
=

p≤x
log2 p +

pq≤x
log p log q
=
2x log x + O(x).
Also, F(x) = 0 for x < 2. Applying partial summation, we obtain

p≤x
log p +

pq≤x
log p log q
log pq
=

2≤n≤x
ℓ(n) log n + ℓ∗ℓ(n)
log n
=

3/2<n≤x
f(n)
log n
=
F(x)
log x +
# x
2
F(t)
t log2 tdt
=
2x log x + O(x)
log x
+
# x
2
2t log t + O(t)
t log2 t
dt
=
2x + O

x
log x

,
by Exercise 1. If x ≥e, then
x
log x ≤
2x
1 + log x,
and so
O

x
log x

= O

x
1 + log x

.
If 1 ≤x ≤e, then
x
1 + log x ≥1
and
0 ≤

p≤x
log p +

pq≤x
log p log q
log pq
≤log 2,
and so

x −

p≤x
log p +

pq≤x
log p log q
log pq

≪1 ≪
x
1 + log x.

298
9. The Prime Number Theorem
This completes the proof of (9.3). 2
Exercises
1. Let x ≥2 and k ≥1. Use integration by parts to prove that
# x
2
dt
logk t
=
x
logk x
−
2
logk 2
+ k
# x
2
dt
logk+1 t
.
Prove that
# x
2
dt
logk+1 t
= Ok

x
logk+1 x

,
where the implied constant depends on k.
Hint: Divide the interval of integration [2, x] into two subintervals
[2, √x] and [√x, x].
2. Let x ≥2 and n ≥1. The logarithmic integral is the function
li(x) =
# x
2
dt
log t.
Prove that
li(x) =
n

k=1
(k −1)!x
logk x
+ On

x
logn+1 x

,
where the implied constant depends on n.
Prove that
li(x) ∼
x
log x.
3. Show that formula (9.4) implies formula (9.3).
4. Deﬁne the positive real numbers A and a by
lim sup
x→∞
ϑ(x)
x
= A
and
lim inf
x→∞
ϑ(x)
x
= a.
Observe that a ≤A and that the prime number theorem is equivalent
to the statement that A = a = 1. Use Selberg’s formula (9.3) to prove
that
A + a ≤2.
Hint: Note that ϑ(x) ≥(a −ε)x for all x suﬃciently large. Choose a
sequence of real numbers xi such that xi goes to inﬁnity and ϑ(xi) ≥
(A −ε)xi for xi suﬃciently large. Use Theorem 8.5.

9.3 The Elementary Proof
299
5. Use Selberg’s formula (9.3) to prove that
A + a ≥2.
Conclude that A + a = 2, and that the prime number theorem is
equivalent to A = a.
9.3
The Elementary Proof
We deﬁne the remainder term R(x) for Chebyshev’s function ϑ(x) by
R(x) = ϑ(x) −x.
We shall prove the prime number theorem in the form ϑ(x) ∼x, or,
equivalently, R(x) = o(x). More precisely, we shall prove that there ex-
ist sequences of positive real numbers {δm}∞
m=1 and {um}∞
m=1 such that
limm→∞δm = 0 and
|R(x)| < δmx
for all x ≥um.
The argument is technically elementary, but delicate.
We need the following estimate.
Lemma 9.1 For x > e,

p≤x
log p
p

1 + log x
p
 ≪log log x.
Proof. By Mertens’s theorem (Theorem 8.5), for every positive integer
j we have

x
ej <p≤
x
ej−1
log p
p
=

log
x
ej−1 + O(1)

−

log x
ej + O(1)

= O(1).
Moreover, if
x
ej < p ≤
x
ej−1 ,
then
j ≤1 + log x
p < j + 1,
and so

x
ej <p≤
x
ej−1
log p
p

1 + log x
p
 ≤1
j

x
ej <p≤
x
ej−1
log p
p
≪1
j .

300
9. The Prime Number Theorem
Therefore,

p≤x
log p
p

1 + log x
p

=
[log x]+1

j=1

x
ej <p≤
x
ej−1
log p
p

1 + log x
p

≪
[log x]+1

j=1
1
j
≪
log log x.
This completes the proof. 2
Theorem 9.4 For x ≥1,
|R(x)| ≤
1
log x

n≤x
R
x
n
 + O
x log log x
log x

.
Proof. Replacing ϑ(x) by x + R(x) in Selberg’s formula (9.3), we obtain
2x log x + O(x)
=
ϑ(x) log x +

p≤x
log p ϑ
x
p

=
(x + R(x)) log x +

p≤x
log p
x
p + R
x
p

=
x log x + R(x) log x + x

p≤x
log p
p
+

p≤x
R
x
p

log p
=
R(x) log x +

p≤x
R
x
p

log p + 2x log x + O(x).
This gives
R(x) log x = −

p≤x
R
x
p

log p + O(x).
(9.5)
We denote prime numbers by p, q, and r. Let p ≤x. From (9.4) we have

q≤x/p
log q +

qr≤x/p
log q log r
log qr
= 2x
p + O


x
p

1 + log x
p


.
Then

pq≤x
log p log q
=

p≤x
log p

q≤x/p
log q

9.3 The Elementary Proof
301
=
2x

p≤x
log p
p
−

pqr≤x
log p log q log r
log qr
+ O

x

p≤x
log p
p

1 + log x
p



=
2x(log x + O(1)) −

qr≤x
log q log r
log qr

p≤x/qr
log p
+ O

x

p≤x
log p
p

1 + log x
p



=
2x log x −

qr≤x
log q log r
log qr
ϑ
 x
qr

+ O(x log log x),
where the error term comes from Lemma 9.1. Inserting this expression for

pq≤x log p log q into Selberg’s formula (9.2), we obtain

p≤x
log2 p =

pq≤x
log p log q
log pq
ϑ
 x
pq

+ O(x log log x).
Therefore,
ϑ(x) log x =

pq≤x
log p log q
log pq
ϑ
 x
pq

+ O(x log log x).
(9.6)
Replacing ϑ(x) by x + R(x) in (9.6), we obtain
(x + R(x)) log x
=

pq≤x
log p log q
log pq
 x
pq + R
 x
pq

+ O(x log log x)
=
x

pq≤x
log p log q
pq log pq +

pq≤x
log p log q
log pq
R
 x
pq

+ O(x log log x).
By Exercise 6 in Section 8.2,

pq≤x
log p log q
pq log pq = log x + O(log log x),
and so
R(x) log x =

pq≤x
log p log q
log pq
R
 x
pq

+ O(x log log x).
(9.7)

302
9. The Prime Number Theorem
Adding formulas (9.5) and (9.7), we obtain
2|R(x)| log x
≤

p≤x
log p
R
x
p
 +

pq≤x
log p log q
log pq
R
 x
pq

+ O(x log log x)
=

n≤x
ℓ(n)
R
x
n
 +

n≤x
ℓ∗ℓ(n)
log n
R
x
n

+ O(x log log x)
=

n≤x

ℓ(n) + ℓ∗ℓ(n)
log n
 R
x
n
 + O(x log log x).
We can write the partial summation formula (6.6) with a = 0 and b = [x]
as follows:

n≤x
f(n)g(n) =

n≤x−1
F(n)(g(n) −g(n + 1)) + F(x)g([x]).
Let
f(n) = ℓ(n) + ℓ∗ℓ(n)
log n
and g(n) = |R(x/n)|. By Selberg’s formula (9.4),
F(x) =

n≤x
f(n) =

n≤x

ℓ(n) + ℓ∗ℓ(n)
log n

= 2x + O

x
1 + log x

.
Then

n≤x

ℓ(n) + ℓ∗ℓ(n)
log n
 R
x
n

=

n≤x−1

2n + O

n
1 + log n
 R
x
n
 −
R

x
n + 1


+

2x + O

x
1 + log x
 R
 x
[x]
 .
We evaluate these terms separately. The main term is
2

n≤x−1
n
R
x
n
 −
R

x
n + 1


=
2

n≤x−1
n
R
x
n
 −2

n≤x−1
n
R

x
n + 1

=
2

n≤x−1
n
R
x
n
 −2

2≤n≤x
(n −1)
R
x
n


9.3 The Elementary Proof
303
=
2

n≤x
R
x
n
 −2[x]
R
 x
[x]

=
2

n≤x
R
x
n
 + O(x),
since 1 ≤x/[x] < 2 for all x ≥1, and so ϑ(x/[x]) = 0 and R(x/[x]) = O(1).
To evaluate the second term, we begin by observing that
R
x
n
 −
R

x
n + 1

=
ϑ
x
n

−x
n
 −
ϑ

x
n + 1

−
x
n + 1

≤
ϑ
x
n

−ϑ

x
n + 1

−
x
n −
x
n + 1

≤
ϑ
x
n

−ϑ

x
n + 1
 +

x
n −
x
n + 1

=
ϑ
x
n

−ϑ

x
n + 1

+ x
n −
x
n + 1
<
ϑ
x
n

−ϑ

x
n + 1

+ x
n2 .
Therefore,

n≤x−1

n
1 + log n
 R
x
n
 −
R

x
n + 1


≤

n≤x−1

n
1 + log n
 
ϑ
x
n

−ϑ

x
n + 1

+ x

n≤x−1
1
n(1 + log n).
We have

n≤x−1

n
1 + log n
 
ϑ
x
n

−ϑ

x
n + 1

=

n≤x−1

n
1 + log n

ϑ
x
n

−

2≤n≤x

n −1
1 + log(n −1)

ϑ
x
n

=
ϑ(x) +

2≤n≤x−1

n
1 + log n −
n −1
1 + log(n −1)

ϑ
x
n

≤
ϑ(x) +

2≤n≤x−1

n
1 + log n −
n −1
1 + log n

ϑ
x
n

=
ϑ(x) +

2≤n≤x−1

1
1 + log n

ϑ
x
n


304
9. The Prime Number Theorem
≪
x + x

2≤n≤x−1
1
n(1 + log n)
≪
x log log x,
since

n≤x−1
1
n(1 + log n) = O(log log x)
by Exercise 11 of Section 6.2.
The third term is simply

2x + O

x
1 + log x
 R
 x
[x]
 = O(x).
Combining these results, we obtain
2|R(x)| log x ≤2

n≤x
R
x
n
 + O(x log log x).
Dividing this inequality by 2 log x completes the proof of Theorem 9.4. 2
Lemma 9.2 Let 0 < δ < 1. There exist numbers c0 ≥1 and x1(δ) ≥4
such that if x ≥x1(δ), then there exists an integer n such that
x < n ≤ec0/δx
and
|R(n)| < δn.
The constant c0 does not depend on δ.
Proof. By Theorem 6.9,

n≤x
1
n = log x + γ + r(x) = log x + O(1),
where |r(x)| < 1/x. If 1 ≤x < x′, then

x<n≤x′
1
n = log x′
x + r′(x),
where |r′(x)| < 2/x. By Theorem 8.6,

n≤x
ϑ(n)
n2
= log x + O(1).

9.3 The Elementary Proof
305
Then

n≤x
R(n)
n2
=

n≤x
ϑ(n) −n
n2
=
(log x + O(1)) −(log x + O(1))
=
O(1),
and so


x<n≤x′
R(n)
n2

= O(1)
for all 1 ≤x < x′. Choose c0 ≥1 such that


x<n≤x′
R(n)
n2

< c0
2
(9.8)
for all 1 ≤x < x′.
Let 0δ < 1 and ρ = ec0/δ. Then ρx > ex. Choose x1(δ) ≥4 such that
log x < δx for all x ≥x1(δ). We must prove that if x ≥x1(δ), then there
exists an integer n ∈(x, ρx] with |R(n)| < δn. There are two cases.
In the ﬁrst case, we assume that either R(n) ≥0 for all integers n ∈
(x, ρx], or R(n) ≤0 for all integers n ∈(x, ρx]. Then


x<n≤ρx
R(n)
n2

=

x<n≤ρx
|R(n)|
n2
=

x<n≤ρx
|R(n)|
n
 1
n.
If
m∗= min
|R(n)|
n
: n ∈(x, ρx]

,
then
c0
2
>

x<n≤ρx
|R(n)|
n
 1
n
≥
m∗

x<n≤ρx
1
n
>
m∗

log ρx
x −2
x

≥
m∗
c0
δ −1
2

≥
c0m∗
2δ ,

306
9. The Prime Number Theorem
and so
0 ≤m∗< δ.
There exists an integer n ∈(x, ρx] with |R(n)|/n = m∗, and so
|R(n)| < δn.
In the second case, there exist integers n−1 and n in the interval (x, ρx]
such that R(n −1) ̸= R(n) and R(n −1)R(n) ≤0. Moreover, n −1 > x ≥
x1(δ) ≥4, and so n ≥6. For every integer n ≥2 we have
R(n) −R(n −1)
=
ϑ(n) −ϑ(n −1) −1
=

log n −1
if n is prime,
−1
if n is composite.
It follows that if R(n) < R(n −1), then R(n) −R(n −1) = −1. Since
R(n) ≤0 ≤R(n−1), we have |R(n)| ≤1 < log n ≤δn. If R(n−1) < R(n),
then R(n −1) ≤0 ≤R(n) and
0 ≤R(n) ≤R(n) −R(n −1) = log n −1 < log n < δn.
In all cases, there exists an integer n ∈(x, ρx] such that |R(n)| < δn. This
completes the proof. 2
Lemma 9.3 Let c0 ≥1 be the number constructed in Lemma 9.2. and let
0 < δ < 1. There exists a number x2(δ) such that if x ≥x2(δ), then the
interval (x, ec0/δx] contains a subinterval (y, eδ/2y] such that
|R(t)| < 4δt
for all t ∈(y, eδ/2y].
Proof. We begin with Selberg’s formula in the form (9.4). For x ≥1,

p≤x
log p +

pq≤x
log p log q
log pq
= 2x + O

x
1 + log x

.
For 1 < u ≤t we have
0
≤

u<p≤t
log p
≤

u<p≤t
log p +

u<pq≤t
log p log q
log pq
=
2(t −u) + O

t
1 + log t

+ O

u
1 + log u

=
2(t −u) + O

t
1 + log t

,

9.3 The Elementary Proof
307
since the function t/(1 + log t) is increasing for t ≥1. Moreover,

u<p≤t
log p = ϑ(t) −ϑ(u) = t −u + R(t) −R(u),
and so
−(t −u) ≤R(t) −R(u) ≤t −u + O

t
1 + log t

.
It follows that if 1 < u ≤t, then
|R(t) −R(u)| ≤t −u + O

t
1 + log t

≤t −u + O

t
log t

.
If 1 < t ≤u ≤2t, then
|R(t) −R(u)|
≤
u −t + O

u
1 + log u

≤
|t −u| + O

2t
1 + log 2t

≤
|t −u| + O

t
log t

.
In particular, if u > 4 and t/2 ≤u ≤2t, then
|R(t)| ≤|R(u)| + |t −u| + O

t
log t

.
(9.9)
By Lemma 9.2, there is a number c0 ≥1 such that if 0 < δ < 1 and
x ≥x1(δ) ≥4, then there exists an integer
n ∈

x, ec0/δx
/
with
|R(n)| < δn.
If t is a real number in the interval [n/2, 2n], then t/2 ≤n ≤2t. Since
n > x ≥4, we have
log t ≥log(n/2) > log(x/2) ≥(log x)/2,
and
|R(t)|
≤
|R(n)| + |t −n| + O

t
log t

<
δn + |t −n| + O

t
log x

=
t
δn
t +

t
n −1
 + O

1
log x

≤
t

2δ +

t
n −1
 +
c2
log x


308
9. The Prime Number Theorem
for some constant c2 > 0. If x ≥x2(δ) = max

x1(δ), ec2/δ
, then
|R(t)| < t

3δ +

t
n −1


.
Choose t in the interval
e−δ/2n ≤t ≤eδ/2n.
Then t ∈(n/2, 2n) since eδ/2 < e1/2 < 2. If t/n ≥1, then

t
n −1
 = t
n −1 ≤eδ/2 −1 < δ,
since eδ/2 < 1 + δ for 0 < δ < 1. If t/n < 1, then

t
n −1
 = 1 −t
n ≤1 −e−δ/2 < eδ/2 −1 < δ.
Therefore,
|R(t)| < 4δt.
We deﬁne the number y as follows. If eδ/2n ≤ec0/δx, let y = n. If
eδ/2n > ec0/δx, let y = e−δ/2n. Then
y = e−δ/2n > e−δec0/δx = e(c0/δ)−δx > x,
since c0/δ > c0 ≥1 > δ. In both cases,
(y, eδ/2y] ⊆(x, ec0/δx]
and |R(t)| < 4δt for all t ∈(y, eδ/2y]. This completes the proof. 2
Theorem 9.5 (Prime number theorem) For Chebyshev’s function ϑ(x),
ϑ(x) ∼x
as x →∞.
Proof. By Theorem 8.1,
lim sup
x→∞
R(x)
x
= lim sup
x→∞
ϑ(x)
x
−1 ≤log 4 −1 < 0.4.
By Theorem 8.2,
lim inf
x→∞
R(x)
x
= lim inf
x→∞
ϑ(x)
x
−1 ≥log 2 −1 > −0.4.

9.3 The Elementary Proof
309
It follows that there exist numbers M and u1 such that
|R(x)| < Mx
for all x ≥1,
and
|R(x)| < δ1x
for all x ≥u1,
where
δ1 = 0.4.
We shall construct sequences of positive real numbers {δm}∞
m=1 and
{εm}∞
m=1, such that
δ1 > δ2 > δ3 > · · ·
and
lim
m→∞εm = 0.
(9.10)
Let m ≥1, and suppose that we have constructed the number δm. Let
c0 ≥1 be the number deﬁned in Lemma 9.2. Choose εm such that
0 < εm < 1/m
and
(1 + εm)

1 −
δ2
m
256c0

< 1.
We deﬁne
δm+1 = (1 + εm)

1 −
δ2
m
256c0

δm.
(9.11)
Then 0 < δm+1 < δm. This determines the sequences {δm}∞
m=1 and {εm}∞
m=1
inductively.
We shall prove that for every m there exists a number um such that
|R(x)| < δmx
for all x ≥um.
(9.12)
Let us show that this suﬃces to prove the prime number theorem. The
sequence {δm}∞
m=1 is a strictly decreasing sequence of positive real numbers,
so the sequence converges to some nonnegative number δ < 1. Then (9.10)
and (9.11) imply that
δ =

1 −
δ2
256c0

δ = 0.
Inequality (9.12) implies that R(x) = o(x), which is equivalent to the prime
number theorem.
We construct the numbers um inductively. There exists u1 such that
|R(x)| < δ1x for x ≥u1. Suppose that um has been determined. We shall
prove that there exists a number um+1 such that |R(x)| < δm+1x for all
x ≥um+1.

310
9. The Prime Number Theorem
Deﬁne
δ′
m = δm
8
and
ρ = ec0/δ′
m.
Let x2(δ′
m) be the number constructed in Lemma 9.3, and let
x3(m) = max (x2(δ′
m), um) .
If
x ≥x3(m) ≥x2(δ′
m),
then by Lemma 9.3, every interval (x, ρx] contains a subinterval

y, eδ′
m/2y
/
such that
|R(t)| < 4δ′
mt = δmt
2
for all t ∈

y, eδ′
m/2y
/
. Let k be the greatest integer such that ρk ≤
x/x3(m). Then
k ≤log x/x3(m)
log ρ
< k + 1,
and so
k
=
log(x/x3(m))
log ρ
+ O(1)
=
δ′
m log(x/x3(m))
c0
+ O(1)
=
δm log x
8c0
+ O(1).
By Theorem 9.4,
|R(x)|
≤
1
log x

n≤x
R
x
n
 + o(x)
=
1
log x

n≤ρk
R
x
n
 +
1
log x

ρk<n≤x
R
x
n
 + o(x)
≤
1
log x

n≤ρk
R
x
n
 + Mx
log x

ρk<n≤x
1
n + o(x)
≤
1
log x

n≤ρk
R
x
n
 + o(x),
since

ρk<n≤x
1
n ≤

x/(ρx3(m))<n≤x
1
n = log(ρx3(m)) + O(1/x) = O(1).

9.3 The Elementary Proof
311
If 1 ≤n ≤ρk, then
x
n ≥x
ρk ≥x3(m) ≥um
and
R
x
n
 < δmx
n ,
by the deﬁnition of um.
For j = 1, . . . , k, we have
x
ρj ≥x
ρk ≥x3(m) ≥x2(δ′
m),
and so each interval

x
ρj ,
x
ρj−1
/
contains a subinterval Ij =

yj, eδ′
m/2yj
/
such that
|R(t)| < 4δ′
mt = δmt
2
for all t ∈Ij.
Therefore,

n∈(ρj−1,ρj]
R
x
n

=

n∈(ρj−1,ρj]\Ij
R
x
n
 +

n∈Ij
R
x
n

<
δmx

n∈(ρj−1,ρj]\Ij
1
n + δmx
2

n∈Ij
1
n
=
δmx

n∈(ρj−1,ρj]
1
n −δmx
2

n∈Ij
1
n.
Then

n≤ρk
R
x
n

=
R(x) +
k

j=1

n∈(ρj−1,ρj]
R
x
n

≤
δmx +
k

j=1

δmx

n∈(ρj−1,ρj]
1
n −δmx
2

n∈Ij
1
n


=
δmx

n≤ρk
1
n −δmx
2
k

j=1

n∈Ij
1
n.
We have
δmx

n≤ρk
1
n
=
δmx

k log ρ + O
 1
ρk

=
δmx log x + O(x).

312
9. The Prime Number Theorem
Moreover,

n∈Ij
1
n =

n∈(yj,eδ′m/2yj]
1
n = δ′
m
2 + O
 1
yj

= δ′
m
2 + O
ρj
x

,
and so
k

j=1

n∈Ij
1
n
=
δ′
mk
2
+ O


k

j=1
ρj
x


=
δ′
m
2
δm log x
8c0
+ O(1)

+ O(1)
=
δ2
m log x
128c0
+ O(1),
since
k

j=1
ρj
x = ρ(ρk −1)
x(ρ −1) < 2ρk
x
≤
2
x3(m) = O(1).
Therefore,
δmx
2
k

j=1

n∈Ij
1
n = δ3
mx log x
256c0
+ O(x).
Combining these results, we obtain, for x ≥x3(m),

n≤ρk
R
x
n

≤
(δmx log x + O(x)) −
δ3
mx log x
256c0
+ O(x)

=

1 −
δ2
m
256c0

δmx log x + O(x),
and
|R(x)|
≤
1
log x

n≤ρk
R
x
n
 + o(x)
=

1 −
δ2
m
256c0

δmx + o(x).
We choose um+1 suﬃciently large that for all x ≥um+1 we have
o(x) < εm

1 −
δ2
m
256c0

δmx.
Then
|R(x)| < (1 + εm)

1 −
δ2
m
256c0

δmx = δm+1x.
This completes the proof of the prime number theorem. 2

9.4 Integers with k Prime Factors
313
Exercises
1. Let pn denote the nth prime number. Prove that pn ∼n log n.
2. Prove that
lim
n→∞
pn+1
pn
= 1.
3. Let δ > 0. Prove that
ϑ((1 + δ)x) −ϑ(x) ∼δx.
This implies that there is a prime between x and (1 + δ)x for all
suﬃciently large x.
4. Prove that
π((1 + δ)x) −π(x) ∼
δx
log x.
5. Prove that
π(2x) −π(x) ∼π(x).
6. Let pn denote the nth prime number, so that p1 = 2, p2 = 3, . . . .
Prove that the asymptotic formula pn ∼n log n implies the prime
number theorem.
7. Deduce Selberg’s formula (9.3) from the prime number theorem.
8. Let δ1 = 2. For every m ≥1 deﬁne
δm+1 = δm

1 −
δ2
m
256c0

.
Prove that
0 < δm ≪
1
√m.
9.4
Integers with k Prime Factors
For any positive integer n, the arithmetic functions ω(n) and Ω(n) are
deﬁned as follows: ω(n) = k if n is divisible by exactly k diﬀerent primes,
and Ω(n) = ℓif n is the product of ℓnot necessarily distinct primes. If
n = pa1
1 · · · pak
k , where p1, . . . , pk are pairwise distinct prime numbers and
a1, . . . , ak are positive integers, then ω(n) = k and Ω(n) = a1 + · · · + ak.
Let πk(x) denote the number of positive integers n not exceeding x that
can be written as the product of exactly k distinct primes,
πk(x) =

n≤x
ω(n)=Ω(n)=k
1.

314
9. The Prime Number Theorem
Let π∗
k(x) denote the number of positive integers n not exceeding x that
can be written as the product of exactly k not necessarily distinct prime
numbers,
π∗
k(x) =

n≤x
Ω(n)=k
1.
Our goal is the following asymptotic estimate for the number of integers
with exactly k prime divisors:
πk(x) ∼π∗
k(x) ∼x(log log x)k−1
(k −1)! log x .
This is a generalization of the prime number theorem, since π1(x) = π∗
1(x) =
π(x) ∼x/ log x.
Let P = {2, 3, 5, . . .} be the set of prime numbers, and let Pk be the set
of all ordered k-tuples of primes. Let rk(n) denote the number of represen-
tations of n as an ordered product of k primes, that is,
rk(n) =

(p1,...,pk)∈Pk
p1···pk=n
1.
Since every positive integer is uniquely (up to order) a product of primes,
we have
0 ≤rk(n) ≤k!
for all n ≥1.
Moreover, rk(n) = k! if and only if ω(n) = Ω(n) = k, and 0 < rk(n) < k! if
and only if ω(n) < Ω(n) = k.
Theorem 9.6 For k ≥1, let
Π∗
k(x) =

n≤x
rk(n) =

(p1,...,pk)∈Pk
p1···pk≤x
1.
Then
k!πk(x) ≤Π∗
k(x) ≤k!π∗
k(x) ≪x.
For k ≥2,
0 ≤π∗
k(x) −πk(x) ≤Π∗
k−1(x).
Proof. We have
Π∗
k(x) =

n≤x
rk(n) ≤k!

n≤x
rk(n)>0
1 = k!π∗
k(x) ≤k!x ≪x
and
Π∗
k(x) =

n≤x
rk(n) ≥k!

n≤x
rk(n)=k!
1 = k!πk(x).

9.4 Integers with k Prime Factors
315
Let k ≥2. The function π∗
k(x) −πk(x) counts the number of positive
integers n ≤x that can be written as a product of k primes but not as
a product of k distinct primes. Every such integer is of the form n =
p1 · · · pk−2p2
k−1. Therefore,
π∗
k(x) −πk(x)
≤

(p1,...,pk−1)∈Pk−1
p1···p2
k−1≤x
1
≤

(p1,...,pk−1)∈Pk−1
p1···pk−1≤x
1
=
Π∗
k−1(x).
This completes the proof. 2
Theorem 9.7 Let S0(x) = 1. For k ≥1, let
Sk(x) =

(p1,...,pk)∈Pk
p1···pk≤x
1
p1 · · · pk
=

n≤x
rk(n)
n
.
Then
Sk(x) ∼(log log x)k
and
Sk(x) =

p≤x
1
pSk−1
x
p

.
Proof. By Theorem 8.7,
S1(x) =

p≤x
1
p ∼log log x
and so
S1(x1/k) ∼log log x1/k ∼log log x
for all k ≥1. Since

S1

x1/kk
=


p≤x1/k
1
p


k
=

(p1,...,pk)∈Pk
pi≤x1/k
1
p1 · · · pk
≤

(p1,...,pk)∈Pk
p1···pk≤x
1
p1 · · · pk
= Sk(x)
≤


p≤x
1
p


k
= S1(x)k,

316
9. The Prime Number Theorem
it follows that
Sk(x) ∼(log log x)k.
Also,
Sk(x)
=

(p1,...,pk−1,pk)∈Pk
p1···pk−1pk≤x
1
p1 · · · pk−1pk
=

pk≤x
1
pk

(p1,...,pk−1)∈Pk−1
p1···pk−1≤x/pk
1
p1 · · · pk−1
=

pk≤x
1
pk
Sk−1
 x
pk

.
This completes the proof. 2
Theorem 9.8 For k ≥1, let
ϑk(x) =

(p1,...,pk)∈Pk
p1···pk≤x
log p1 · · · pk.
Then
ϑk(x) ∼kx(log log x)k−1.
Proof. For j = 1, . . . , k + 1, let
p1 · · · ˆpj · · · pk+1 =
k+1

i=1
i̸=j
pi.
Then
k+1

j=1
log p1 · · · ˆpj · · · pk+1 = log(p1 · · · pk+1)k = k log p1 · · · pk+1,
and so, by Exercise 4,
kϑk+1(x)
=

(p1,...,pk+1)∈Pk+1
p1···pk+1≤x
k log p1 · · · pk+1
=

(p1,...,pk+1)∈Pk+1
p1···pk+1≤x
k+1

j=1
log p1 · · · ˆpj · · · pk+1

9.4 Integers with k Prime Factors
317
=

(p1,...,pk+1)∈Pk+1
p1···pk+1≤x
(k + 1) log p1 · · · pk
=
(k + 1)

pk+1≤x

(p1,...,pk)∈Pk
p1···pk≤x/pk+1
log p1 · · · pk
=
(k + 1)

p≤x
ϑk
x
p

.
For k ≥1, let
Fk(x) = ϑk(x) −kxSk−1(x).
Then
kFk+1(x)
=
kϑk+1(x) −k(k + 1)xSk(x)
=
(k + 1)

p≤x
ϑk
x
p

−k(k + 1)

p≤x
x
p Sk−1
x
p

=
(k + 1)

p≤x

ϑk
x
p

−kx
p Sk−1
x
p

=
(k + 1)

p≤x
Fk
x
p

.
We shall prove by induction that
Fk(x) = o

x(log log x)k−1
.
(9.13)
For k = 1,
F1(x) = ϑ(x) −x = o(x)
is the prime number theorem. Suppose that (9.13) is true for some k ≥1.
Let ε > 0. There exists x0(ε) such that
|Fk(x)| ≤εx(log log x)k−1
for all x ≥x0 = x0(ε), and so

p≤x/x0
Fk
x
p

≤εx(log log x)k−1

p≤x/x0
1
p ≤2εx(log log x)k
for x ≥x1 = x1(ε) ≥x0. Since the functions ϑk(x) and Sk−1(x) are
nonnegative and increasing for x ≥1, it follows that Fk(x) is bounded on
any ﬁnite interval, and so there exists a constant M1 = M1(ε) such that
|Fk(x)| ≤M1
for 1 ≤x ≤x1.

318
9. The Prime Number Theorem
Therefore,
kFk+1(x)
=
(k + 1)

p≤x
Fk
x
p

=
(k + 1)

p≤x/x0
Fk
x
p

+ (k + 1)

x/x0<p≤x
Fk
x
p

≤
2(k + 1)εx(log log x)k + (k + 1)M1π(x)
≤
4kεx(log log x)k + 2kM1x.
Dividing by k, we obtain
Fk+1(x) ≪εx(log log x)k
for all suﬃciently large x. This proves (9.13). It follows that
ϑk(x)
=
kxSk−1(x) + Fk(x)
=
kx(log log x)k−1 + o

x(log log x)k−1
∼
kx(log log x)k−1.
This completes the proof. 2
Theorem 9.9 For k ≥1,
πk(x) ∼π∗
k(x) ∼x(log log x)k−1
k log x
.
Proof. This follows from Theorem 9.8 by partial summation. We have
ϑk(x) =

(p1,...,pk)∈Pk
p1···pk≤x
log p1 · · · pk =

n≤x
rk(n) log n,
and, by Theorem 9.6, the arithmetic function rk(n) has mean value
Π∗
k(x) =

n≤x
rk(n) = O(x).
Then
ϑk(x)
=
Π∗
k(x) log x −
# x
1
Π∗
k(t)dt
t
=
Π∗
k(x) log x + O(x).
It follows that
Π∗
k(x) = ϑk(x)
log x + O

x
log x

∼kx(log log x)k−1
log x
.

9.4 Integers with k Prime Factors
319
For k ≥2,
Π∗
k−1(x) = o (Π∗
k(x)) .
By Theorem 9.6,
Π∗
k(x) ≤k!π∗
k(x) ≤k!πk(x) + k!Π∗
k−1(x) ≤Π∗
k(x) + k!Π∗
k−1(x),
and so
π∗
k(x) ∼πk(x) ∼Π∗
k(x)
k!
∼x(log log x)k−1
(k −1)! log x .
This completes the proof. 2
Exercises
1. For every positive integer n, let rk(n) denote the number of k-tuples
of prime numbers (p1, . . . , pk) such that n = p1 · · · pk. Compute r3(n)
for n ≤50.
2. Compute r4(n) for n ≤100.
3. Let σ > 1. Prove that
∞

n=1
rk(n)
nσ
=


p∈P
1
pσ


k
.
4. Prove that

(p1,...,pk+1)∈Pk+1
p1···pk+1≤x
k+1

j=1
log p1 · · · ˆpj · · · pk+1
=

(p1,...,pk+1)∈Pk+1
p1···pk+1≤x
(k + 1) log p1 · · · pk.
5. Let xk be the smallest number such that πk(xk) > 0. Prove that for
every ε > 0 there exists an integer k0 = k0(ε) such that if k ≥k0,
then
k(1−ε)k < xk < k(1+ε)k.

320
9. The Prime Number Theorem
9.5
Notes
In a lecture delivered to the Mathematical Society of Copenhagen in 1921,
Hardy said,
No elementary proof of the prime number theorem is known,
and one may ask whether it is reasonable to expect one. Now
we know that the theorem is roughly equivalent to a theorem
about an analytic function, the theorem that Riemann’s zeta
function has no roots on a certain line. A proof of such a theo-
rem, not fundamentally dependent upon the ideas of the theory
of functions, seems to me extraordinarily unlikely. It is rash to
assert that a mathematical theorem cannot be proved in a par-
ticular way; but one thing seems quite clear. We have certain
views about the logic of the theory; we think that some theo-
rems, as we say “lie deep” and others nearer to the surface. If
anyone produces an elementary proof of the prime number the-
orem, he will show that these views are wrong, that the subject
does not hang together in the way we have supposed, and that
it is time for the books to be cast aside and for the theory to
be rewritten.
G. H. Hardy, quoted in Bohr [11]
In 1949, in a review of the Erd˝os and Selberg elementary proofs of the
prime number theorem, Ingham wrote,
What Selberg and Erd˝os do is to deduce the PNT directly
. . . without the explicit intervention of the analytical fact . . . .
How far the practical eﬀects of this revolution of ideas will pen-
etrate into the structure of the subject, and how much of the
theory will ultimately have to be rewritten, it is too early to
say.
A. E. Ingham [71]
The prime number theorem was proved independently in 1896 by J.
Hadamard [46] and C.-J. de la Vall´ee Poussin[23]. Their proofs applied
complex function theory to the Riemann zeta function. Ingham’s classic
monograph, The Distribution of Prime Numbers [70], published in 1932,
contains an analytic proof of the prime number theorem.
The elementary proof of the prime number theorem was discovered in
1948 at the Institute for Advanced Study in Princeton. In March 1948,
Selberg discovered his famous formula (Theorems 9.2 and 9.3) and gave an
elementary proof of Dirichlet’s theorem on primes in arithmetic progres-
sions (Theorem 10.9). By April 1948, he knew that A + a = 2 (Exercises 4

9.5 Notes
321
and 5 in Section 9.2), and that the prime number theorem is equivalent
to A = a = 1. In a letter to H. Weyl that is dated September 16, 1948,
Selberg1 wrote:
In May I wrote down a sketch to the paper on Dirichlet’s theo-
rem, during June I did nothing except preparations to the trip
to Canada. Then around the beginning of July, Tur´an asked me
if I could give him my notes on the Dirichlet theorem so he could
see it, he was going away soon, and probably would have left
when I returned from Canada. I not only agreed to do this, but
as I felt very much attached to Tur´an I spent some days going
through the proof with him. In this connection I mentioned the
fundamental theorem to him. . . . However, I did not tell him the
proof of the formula, nor about the consequences it might have
and my ideas in this connection. . . . I then left for Canada and
returned after 9 days just as Tur´an was leaving. It turned out
that Tur´an had given a seminar on my proof of the Dirichlet
theorem where Erd˝os, Chowla, and Straus had been present, I
had of course no objection to this, since it concerned something
that was already ﬁnished from my side, though it was not pub-
lished. In connection with this Tur´an had also mentioned, at
least to Erd˝os, the fundamental formula. . . .
In a letter to D. Goldfeld that is dated January 6, 1988, Selberg wrote:
July 14, 1948 was a Wednesday, and on Thursday, July 15 I met
Erd˝os and heard that he was trying to prove pn+1/pn →1. . . .
Friday evening or it may have been Saturday morning, Erd˝os
had his proof ready and told me about it. Sunday afternoon
(July 18) I used his result (which was stronger than pn+1/pn →
1, he had proved that between x and x(1 + δ)there are more
that c(δ)x/ log x primes for x > x0(δ), the weaker result would
not have been suﬃcient for me) to get my ﬁrst proof of PNT.
I told Erd˝os about it the next morning (Monday, July 19). He
then suggested that we should talk about it that evening in the
seminar room in Fuld Hall. . . .
Erd˝os records the history of the ﬁrst elementary proof of the prime number
theorem in the same way:
In the course of several important researches in elementary
number theory A. Selberg proved some months ago the follow-
1This and the following extract from Selberg’s correspondence appear in Goldfeld’s
historical note [38]

322
9. The Prime Number Theorem
ing important asymptotic formula:

p≤x
(log p)2 +

pq≤x
log p log q = 2x log x + O(x),
(9.14)
where p and q run over the primes. . . .
Using (9.14) I proved that pn+1/pn →1 as n →∞. In fact I
proved the following slightly stronger result: To every c there
exists a positive δ(c), so that for x suﬃciently large we have
π[x(1 + c)] −π(x) > δ(c)x/ log x
(9.15)
where π(x) is the number of primes not exceeding x.
I communicated this proof of (9.15) to Selberg, who, two days
later, using (9.14), (9.15) and the ideas of the proof of (9.15),
deduced the prime number theorem. . . .
Erd˝os [34, pp. 374–375]
Both Erd˝os [34] and Selberg [128] subsequently gave independent ele-
mentary proofs of the prime number theorem. These proofs all use Sel-
berg’s original formula, as well as ideas that Erd˝os introduced in his proof
of (9.15).
Number theorists of Hardy’s and Ingham’s generation believed that there
could be no elementary proof of the prime number theorem. They were also
convinced that if, by some miracle, an elementary proof were discovered,
then the ideas in that proof would lead to tremendous progress in our
knowledge of the distribution of prime numbers and the zeros of the zeta
function. Both statements are false. Erd˝os and Selberg produced elementary
proofs, but their beautiful method has not led to any extraordinary new
discoveries in number theory or analysis.
The elementary proof has so far not produced the exciting in-
novations in number theory that many of us expected to follow.
So, what we witnessed in 1948, may in the course of time prove
to have been a brilliant but somewhat incidental achievement
without the historic signiﬁcance it then appeared to have. My
own inclination is to believe that it was the beginning of impor-
tant new ideas not yet fully understood and that its importance
will grow over the years.
E. G. Straus [136]
The elementary proof of the prime number theorem that appears in this
chapter is the proof in Selberg’s original paper [128]. Postnikov and Ro-
manov [115, 116] give a similar elementary proof in terms of the M¨obius

9.5 Notes
323
function. Daboussi [18] and Hildebrand [67] obtained elementary proofs of
the prime number theorem that do not depend on Selberg’s formula. Di-
amond [24] has written a careful survey of elementary methods in prime
number theory.
For more recent developments in prime number theory, see Tenenbaum
and Mend`es-France, The Prime Numbers and Their Distribution [140]. D.
J. Newman has recently published a simple analytic proof (Newman [112],
Zagier [159]).
The asymptotic formula for the number of integers with exactly k prime
factors is based on work of E. M. Wright (see Hardy and Wright [60,
pp. 368–370]).
The most important unsolved problem in mathematics is the Riemann
hypothesis. It can be expressed in terms of the distribution of prime num-
bers. By Exercise 2 in Section 9.2, the logarithmic integral li(x) is asymp-
totic to x/ log x, and so the prime number theorem can be restated in the
form
π(x) ∼li(x).
The Riemann hypothesis is an assertion about the size of the error term in
the prime number theorem, namely, that
π(x) = li(x) + O

x1/2+ε
for every ε > 0.

10
Primes in Arithmetic Progressions
10.1
Dirichlet Characters
Dirichlet’s theorem states that if m ≥1 and a are relatively prime integers,
then the arithmetic progression mk + a contains inﬁnitely many primes,
that is, there exist inﬁnitely many primes p of the form p = mk + a.
Equivalently, the congruence class a
(mod m) contains inﬁnitely many
prime numbers. For example, there are inﬁnitely many primes p such that
p ≡3
(mod 4), and there are inﬁnitely many primes p such that p ≡5
(mod 6), by Exercises 8 and 9 in Section 1.5.
We begin by constructing a class of periodic functions called Dirichlet
characters whose domain is the set of integers.
Let m be a positive integer and let Z/mZ be the ring of congruence
classes modulo m. The additive group of this ring is cyclic of order m, and
its dual group is also cyclic of order m. A character of the additive group
Z/mZ is called an additive character modulo m.
Let ζ be a primitive mth root of unity. If ψ is an additive character
modulo m, then there exists a unique integer a ∈{0, 1, 2, . . . , m −1} such
that
ψ(k + mZ) = ζak.
Choosing the primitive mth root of unity ζ = exp(2πi/m), we have
ψa(k + mZ) = exp
2πiak
m

= em(ak).

326
10. Primes in Arithmetic Progressions
Associated to the additive character ψa is a complex-valued function ψ′
a on
the integers that is deﬁned by
ψ′
a(k) = ψa(k + mZ).
We let ψa denote both the additive character modulo m and its associated
function on the integers.
The group of units in the ring of integers modulo m is the multiplicative
group (Z/mZ)× of order ϕ(m), where ϕ(m) is the Euler ϕ-function. A
character of this group is called a multiplicative character modulo m. The
principal character χ0 modulo m is the multiplicative character deﬁned by
χ0(a + mZ) = 1 for all a + mZ ∈(Z/mZ)×.
For every multiplicative character χ, we have
χ(−1 + mZ)2 = χ(1 + mZ) = 1,
and so
χ(−1 + mZ) = ±1.
The character χ is called even if χ(−1+mZ) = 1 and odd if χ(−1+mZ) =
−1.
A multiplicative character modulo m is called real
if it is real-valued.
Since the only real roots of unity are ±1, it follows that if χ is a real
character, then χ(a + m/Z) = ±1 for all (a, m) = 1. The character χ is
called complex if χ(a + mZ) is not real for some congruence class a + mZ.
Let χ be a multiplicative character modulo m. We extend χ to the
nonunits of the ring Z/mZ by setting χ(a + mZ) = 0 whenever (a, m) = 1.
For every odd prime p, the Legendre symbol

·
p

deﬁnes a real multi-
plicative character χ modulo p by
χ(a + pZ) =
a
p

=



1
if a is a quadratic residue modulo p,
−1
if a is a quadratic nonresidue modulo p,
0
if (a, p) > 1.
By Theorem 3.14, this character is even if p ≡1
(mod 4) and odd if p ≡3
(mod 4).
Corresponding to every multiplicative character χ modulo m there is a
complex-valued function χ′ on the integers deﬁned by
χ′(a) = χ(a + mZ).
The function χ′ : Z →C is called a Dirichlet character modulo m.
A Dirichlet character χ′ modulo m has the following properties:
(i) The function χ′ has period m, that is, if a ≡b
(mod m), then
χ′(a) = χ′(b).

10.1 Dirichlet Characters
327
(ii) The support of χ′ is the set of integers relatively prime to m, that is,
χ′(a) ̸= 0 if and only if (a, m) = 1.
(iii) χ′ is completely multiplicative, that is, χ′(ab) = χ′(a)χ′(b) for all
integers a and b.
Conversely, every complex-valued function χ′ on the integers that satisﬁes
properties (i), (ii), and (iii) is a Dirichlet character modulo m, and the
multiplicative character χ modulo m that corresponds to χ′ is deﬁned by
χ(a + mZ) = χ′(a).
From now on, we shall use χ to denote both a multiplicative character
modulo m and the corresponding Dirichlet character modulo m.
The principal Dirichlet character χ0 modulo m is deﬁned by χ0(a) = 1 if
(a, m) = 1 and χ0(a) = 0 if (a, m) ≥2. In particular, the principal Dirichlet
character modulo 1 satisﬁes χ0(a) = 1 for all integers a.
A Dirichlet character modulo m is called real, complex, even, or odd
precisely when the corresponding multiplicative character modulo m is real,
complex, even, or odd, respectively.
We can state the orthogonality relations for Dirichlet characters as fol-
lows.
Theorem 10.1 (Orthogonality relations) Let 
a
(mod m) denote the
sum over a complete set of residue classes modulo m, and let 
χ
(mod m)
denote the sum over the ϕ(m) Dirichlet characters modulo m. If χ is a
Dirichlet character modulo m, then

a
(mod m)
χ(a) =

ϕ(m)
if χ = χ0,
0
if χ ̸= χ0.
If a is an integer, then

χ
(mod m)
χ(a) =

ϕ(m)
if a ≡1
(mod m),
0
if a ̸≡1
(mod m).
Proof. This is simply Theorem 4.6 applied to the multiplicative group
(Z/mZ)×. 2
Theorem 10.2 (Orthogonality relations) Let 
a
(mod m) denote the
sum over a complete set of residue classes modulo m, and let 
χ
(mod m)
denote the sum over the ϕ(m) Dirichlet characters modulo m. If χ1 and χ2
are Dirichlet characters modulo m, then

a
(mod m)
χ1(a)χ2(a) =

ϕ(m)
if χ1 = χ2,
0
if χ1 ̸= χ2.

328
10. Primes in Arithmetic Progressions
If a and b are integers, then

χ
(mod m)
χ(a)χ(b) =

ϕ(m)
if (a, m) = (b, m) = 1 and a ≡b
(mod m),
0
otherwise.
Proof. This is Theorem 4.7 applied to the multiplicative group (Z/mZ)×.
2
Let d and m be positive integers such that d divides m. There is a natural
ring homomorphism
π : Z/mZ →Z/dZ
deﬁned by
π(a + mZ) = a + dZ.
If (a, m) = 1, then (a, d) = 1 and so π induces a group homomorphism
π : (Z/mZ)× →(Z/dZ)× on the unit groups of these rings. Let λ be a
multiplicative character modulo d. The composition of the maps
(Z/mZ)×
π
−→(Z/dZ)×
λ
−→C×
induces a multiplicative character χ modulo m deﬁned by
χ = λπ,
and so
χ(a + mZ) = λ(a + dZ).
This character is called an induced character. A character χ modulo m is
called a primitive character if it is not induced from a character modulo d
for any proper divisor d of m.
Alternatively, we can deﬁne induced characters by means of Dirichlet
characters modulo m. Let d and m be positive integers such that d divides
m. If λ is a Dirichlet character modulo d, then we can deﬁne a Dirichlet
character χ modulo m by the formula
χ(a)
=
 λ(a)
if (a, m) = 1,
0
if (a, m) ̸= 1.
Let d, k, and m be positive integers such that d divides k and k divides
m, and let λ, σ, and χ be Dirichlet (or multiplicative) characters modulo
d, k, and m, respectively. If the character λ induces σ and the character σ
induces χ, then λ induces χ.
There is a unique Dirichlet character modulo 1; it is the constant function
λ(a) = 1 for all integers a. For every m ≥2, the character λ induces the
principal character χ0 modulo m.

10.1 Dirichlet Characters
329
Exercises
1. Construct all of the Dirichlet characters modulo 5.
2. Prove that the nontrivial Dirichlet character modulo 6 is induced by
a primitive Dirichlet character modulo 3.
3. Construct all Dirichlet characters modulo 4 and modulo 8. Find the
primitive characters.
4. Let m and d be positive integers such that d divides m. Let λ be
a Dirichlet character modulo d, and let χ be the Dirichlet character
modulo m induced by λ. Prove that χ(a) = λ(a)χ0(a), where χ0 is
the principal character modulo m.
5. Let χ be the principal Dirichlet character modulo m. Prove that
b

n=a
χ(n) ≥
b −a + 1
m

ϕ(m)
for all integers a and b.
6. Let χ be a nonprincipal Dirichlet character modulo m. Prove that
b

n=a
χ(n) < ϕ(m)
for all integers a and b.
7. Prove that for every integer a,

χ
χ(a) =

ϕ(m)
if a ≡1
(mod m),
0
if a ̸≡1
(mod m),
where the summation runs over all of the Dirichlet characters modulo
m.
8. Let ϕ∗(m) denote the number of primitive characters modulo m.
Prove that
ϕ(m) =

d|m
ϕ∗(d),
where ϕ(m) is the Euler phi function.
9. Prove that ϕ∗(m) is a multiplicative function and that
ϕ∗(m) =

d|m
µ
m
d

ϕ(d).
10. Prove that
ϕ∗(m) = m

p∥m

1 −2
p
 
p2|m

1 −1
p
2
.

330
10. Primes in Arithmetic Progressions
10.2
Dirichlet L-Functions
We begin by introducing a class of functions that are analytic on half-
planes of the complex plane. The proof of Dirichlet’s theorem, however,
involves only routine partial summations of the inﬁnite series and inﬁnite
product representations of these functions on the positive real axis. We do
not use complex function theory, and, indeed, it would suﬃce to consider
the L-functions only for σ > 0.
Let χ be a Dirichlet character modulo m. The Dirichlet L-function as-
sociated with χ is the function
L(s, χ) =
∞

n=1
χ(n)
ns ,
where
s = σ + it
is a complex number with real part ℜ(s) = σ and imaginary part ℑ(s) = t.
For example, if χ0 is the principal character modulo 3, then
L(s, χ0) = 1 + 1
2s + 1
4s + 1
5s + 1
7s + 1
8s + · · · .
If χ3 is the nonprincipal character modulo 3, then
L(s, χ3) = 1 −1
2s + 1
4s −1
5s + 1
7s −1
8s + · · · .
We shall prove that if χ0 is the principal character modulo m, then
L(s, χ0) is analytic in the half-plane σ > 1, and if χ is a nonprincipal
character modulo m, then L(s, χ) is analytic in the half-plane σ > 0 and,
moreover, L(1, χ) ̸= 0. We shall see that this implies Dirichlet’s theorem
on primes in arithmetic progressions.
Theorem 10.3 Let χ be a Dirichlet character modulo m, and let s be a
complex number with ℜ(s) = σ > 1. The function L(s, χ) is analytic and
has the Euler product
L(s, χ) =

p

1 −χ(p)
ps
−1
.
Moreover, L(s, χ) ̸= 0 and
log L(s, χ) =

p
χ(p)
ps
+ O(1).
(10.1)

10.2 Dirichlet L-Functions
331
Proof. Since

χ(n)
ns
 ≤1
nσ
and
∞

n=1
1
nσ
converges for σ > 1, it follows that the series L(s, χ) converges uniformly
and absolutely in the half-plane σ ≥1+δ for every δ > 0. Similarly, for ev-
ery prime p, the series ∞
k=0 χ(pk)p−ks converges uniformly and absolutely
in the half-plane σ > 1, and
∞

k=0
χ(pk)
pks
=

1 −χ(p)
ps
−1
Since the character χ is completely multiplicative, the Fundamental Theo-
rem of Arithmetic implies that

p≤x
 ∞

k=0
χ(pk)
pks

=

n∈N (x)
χ(n)
ns ,
where N(x) denotes the set of all positive integers n divisible only by primes
p ≤x. In particular, if n ≤x and p divides n, then p ≤x, and so n ∈N(x).
For every ε > 0 there exists a number x0(ε) such that, if x ≥x0(ε), then

n>x
1
nσ < ε.
It follows that for x ≥x0(ε) we have

L(s, χ) −

p≤x

1 −χ(p)
ps
−1

=

∞

n=1
χ(n)
ns
−

n∈N (x)
χ(n)
ns

≤

n>x

χ(n)
ns

≤

n>x
1
nσ
<
ε,
and so the inﬁnite product converges to the L-function, that is,
L(s, χ) =

p

1 −χ(p)
ps
−1
.
This product is called the Euler product of L(s, χ).

332
10. Primes in Arithmetic Progressions
We shall prove directly that L(s, χ) is nonzero for σ > 1. Each factor of
the Euler product is nonzero, since

χ(p)
ps
 ≤1
pσ < 1
2,
and so it suﬃces to prove that

p>x0

1 −χ(p)
ps
−1
̸= 0
for some number x0. The inequality

∞

k=1
χ(p)
pks
 ≤
∞

k=1
1
pkσ =
1
pσ −1 < 2
pσ
implies that


1 −χ(p)
ps
−1
=
1 +
∞

k=1
χ(p)
pks

≥
1 −

∞

k=1
χ(p)
pks

>
1 −2
pσ .
Choose x0 such that

p>x0
2
pσ < 1
2.
It follows that for x ≥x0 we have


x0<p≤x

1 −χ(p)
ps
−1

=

x0<p≤x


1 −χ(p)
ps
−1
≥

x0<p≤x

1 −2
pσ

≥
1 −

x0<p≤x
2
pσ
>
1
2,
and so


p>x0

1 −χ(p)
ps
−1 ≥1
2.

10.2 Dirichlet L-Functions
333
Therefore,
L(s, χ) =

p

1 −χ(p)
ps
−1
̸= 0.
For |z| < 1, the principal value of the logarithm has the power series
log
1
1 −z = −log(1 −z) =
∞

n=1
zn
n .
Applying this to the Dirichlet L-function for σ > 1, we obtain
log L(s, χ)
=
log

p

1 −χ(p)
ps
−1
=
−

p
log

1 −χ(p)
ps

=

p
∞

n=1
χ(pn)
npns
=

p
χ(p)
ps
+

p
∞

n=2
χ(pn)
npns
=

p
χ(p)
ps
+ O(1),
since


p
∞

n=2
χ(pn)
npns

≤

p
∞

n=2
1
npnσ
<

p
∞

n=2
1
pn
=

p
1
p(p −1)
≪
1.
This completes the proof. 2
For example, if χ0 and χ3 are the principal and nonprincipal characters
modulo 3, respectively, then
L(s, χ0) =

p≥3

1 −p−s−1

334
10. Primes in Arithmetic Progressions
and
L(s, χ3) =

p≡1
(mod 3)

1 −p−s−1

p≡2
(mod 3)

1 + p−s−1 .
Theorem 10.4 Let χ be a nonprincipal character modulo m. The Dirichlet
L-function L(s, χ) is analytic in the half-plane σ > 0. Let K be a compact
set in the half-plane σ > 0. For s ∈K and x ≥1,
L(s, χ) =

n≤x
χ(n)
ns
+ O

x−σ
,
(10.2)
where the implied constant depends on m and K.
Proof. To prove that L(s, χ) is analytic in σ > 0, it suﬃces to prove that
the series ∞
n=1 χ(n)n−s converges uniformly on every compact subset of
the right half-plane σ > 0.
Let K be a compact subset of the right half-plane. There exist positive
constants δ and ∆such that σ ≥δ and |s| ≤∆for every s = σ + it ∈K.
We use partial summation (Theorem 6.8) with
f(n) = χ(n)
and
g(t) = 1
ts .
By Exercise 6 in Section 10.1, F(t) = 
n≤t χ(n) ≪1 and

N<n≤M
χ(n)
ns
=

N<n≤M
f(n)g(n)
=
F(M)g(M) −F(N)g(N) −
# M
N
F(t)g′(t)dt
=
F(M)
M s
−F(N)
N s
+ s
# M
N
F(t)
ts+1 dt
≪
1
M σ +
1
N σ + |s|
# M
N
1
tσ+1 dt
≪
1
N σ +
|s|
σN σ
≪

1 + ∆
δ
 1
N σ
≪
1
N δ ,
where the implied constants depend on the modulus m and the compact
set K. It follows that the partial sums of the series L(s, χ) are uniformly

10.2 Dirichlet L-Functions
335
Cauchy on K, and so L(s, χ) converges uniformly on K and is analytic in
the right half-plane.
Since

N<n≤M
χ(n)
ns
≪
1
N σ
for all M > N, it follows that
L(s, χ) −
N

n=1
χ(n)
ns
=
∞

n=N
χ(n)
ns
≪
1
N σ .
This completes the proof. 2
The analytic nature of Dirichlet L-functions is diﬀerent for principal
and nonprincipal characters. In the special case where χ0 is the principal
character modulo 1, we have χ0(n) = 1 for all integers n, and the Dirichlet
L-function L(s, χ0) for σ > 1 is the Riemann zeta function
ζ(s) =
∞

n=1
1
ns =

p

1 −1
ps
−1
.
Theorem 10.5 Let χ0 be the principal character modulo m. For σ > 1,
L(s, χ0) = ζ(s)

p|m

1 −1
ps

and
lim
σ→1+(σ −1)L(σ, χ0) =

p|m

1 −1
p

.
For 1 < σ < 2,
log L(σ, χ0) = log

1
σ −1

+ O(1).
Proof. The Riemann zeta function is not analytic at s = 1, since for
σ > 1 and n ≥1 we have
# n+1
n
dx
xσ < 1
nσ <
# n
n−1
dx
xσ ,
and so
0 <
1
σ −1 =
# ∞
1
dx
xσ < ζ(σ) < 1 +
# ∞
1
dx
xσ =
σ
σ −1.
Therefore,
1 < (σ −1)ζ(σ) < σ

336
10. Primes in Arithmetic Progressions
and
lim
σ→1+(σ −1)ζ(σ) = 1.
(10.3)
If 1 < σ < 2, then
log

1
σ −1

< log ζ(σ) < log

1
σ −1

+ log σ < log

1
σ −1

+ log 2,
and so
log ζ(σ) = log

1
σ −1

+ O(1).
(10.4)
If χ0 is the principal character modulo m, then
L(s, χ0)
=

p

1 −χ0(p)
ps
−1
=

(p,m)=1

1 −1
ps
−1
=

p

1 −1
ps
−1 
p|m

1 −1
ps

=
ζ(s)

p|m

1 −1
ps

.
Let 1 < σ < 2. Then
(σ −1)L(σ, χ0) = (σ −1)ζ(σ)

p|m

1 −1
pσ

,
and (10.3) implies that
lim
σ→1+(σ −1)L(σ, χ0) =

p|m

1 −1
p

.
Moreover,
log L(σ, χ0)
=
log ζ(σ) + log

p|m

1 −1
pσ

=
log

1
σ −1

+ O(1),
by (10.4). 2

10.2 Dirichlet L-Functions
337
Exercises
1. Compute the four Dirichlet L-functions modulo 8.
2. A Dirichlet series is a function of the form
F(s) =
∞

n=1
an
ns ,
where {an}∞
n=1 is a sequence of complex numbers. Prove that if an =
O(nα), then the series F(s) converges in the half-plane σ > 1+α and
uniformly in the half-plane σ ≥1 + α + δ for every δ > 0.
3. A Dirichlet polynomial is a function of the form
F(s) =
N

n=1
an
ns ,
where {an}N
n=1 is a ﬁnite sequence of complex numbers. Find the
zeros of the Dirichlet polynomial

d|m
µ(d)
ds
=

p|m

1 −p−s
.
4. Let χ0 be the principal character modulo 3, and let χ3 be the non-
principal character modulo 3. Prove that
L(s, χ0) + L(s, χ3) = 2
∞

n=1
n≡1
(mod 3)
1
n3 .
5. Let m ≥4, and let  G be the group of Dirichlet characters modulo m.
Prove that

χ∈ 
G
L(s, χ) = ϕ(m)

n=1
n≡1
(mod m)
1
ns .
6. Let k and n be positive integers such that k divides n, let χ∗be a
Dirichlet character modulo k, and let χ be the Dirichlet character
modulo m induced by χ∗. Prove that
L(s, χ) = L(s, χ∗)

p|m

1 −χ∗(p)
ps

.
7. Let
f(s) =
∞

n=1
(−1)n−1
ns
.
(10.5)
Prove that

338
10. Primes in Arithmetic Progressions
(a) f(s) is analytic in the half-plane σ > 0,
(b) 0 < f(σ) < 1 for σ > 0.
8. Let
g(s) = 1 −21−s.
(10.6)
Prove that
(a) g(s) is analytic in the entire complex plane.
(b) g(s) = 0 if and only if s = 1 −2πik/ log 2 for k ∈Z.
(c) g′(1 −2πik/ log 2) = log 2.
(d) g(σ) < 0 for 0 < σ < 1.
(e)

1 −21−s−1 is meromorphic in the complex plane except for
simple poles at s = 1 −2πik/ log 2 with residues 1/ log 2.
9. Deﬁne the functions f(s) and g(s) by (10.5) and (10.6), respectively.
Prove that for σ > 1,
f(s) = g(s)ζ(s),
or, equivalently,
ζ(s) =

1 −21−s−1
∞

n=1
(−1)n−1
ns
.
Show that the right side of this equation is meromorphic in the half-
plane σ > 0. This determines the meromorphic continuation of the
Riemann zeta function to the half-plane σ > 0. Prove that
ζ(σ) < 0
for 0 < σ < 1.
Use (10.3) to prove that
∞

n=1
(−1)n−1
n
= log 2.
10.3
Primes Modulo 4
In this section we show that there are inﬁnitely many primes p such that p ≡
1
(mod 4), and also inﬁnitely many primes p such that p ≡3
(mod 4).
This is Dirichlet’s theorem for modulus 4. The proof is easier than the
general case, and shows clearly the use of Dirichlet characters and Dirichlet
L-functions.

10.3 Primes Modulo 4
339
There are two Dirichlet characters modulo 4. Let χ0 be the principal
Dirichlet character. Then
χ0(n) =

1
if n is odd,
0
if n is even.
The L-function L(s, χ0) converges in the half-plane σ > 1, where
L(s, χ0)
=
∞

n=1
1
(2n −1)s = 1 + 1
3s + 1
5s + 1
7s + · · ·
=

p̸=2

1 −1
ps
−1
=

1 −1
2s

ζ(s),
but the inﬁnite series
L(1, χ0) = 1 + 1
3 + 1
5 + 1
7 + · · ·
diverges.
Let χ4 be the nonprincipal character modulo 4. Then
χ4(n) =



1
if n ≡1
(mod 4),
−1
if n ≡3
(mod 4),
0
if n is even.
The L-function L(s, χ0) converges in the half-plane σ > 0, where
L(s, χ4)
=
∞

n=1
(−1)n−1
(2n −1)s = 1 −1
3s + 1
5s −1
7s + · · ·
=

p≡1
(mod 4)

1 −1
ps
−1

p≡3
(mod 4)

1 + 1
ps
−1
.
The inﬁnite series
L(1, χ4) = 1 −1
3 + 1
5 −1
7 + · · ·
converges, and L(1, χ4) > 0. Indeed,
L(1, χ4)
=

1 −1
3

+
1
5 −1
7

+
1
9 −1
11

+ · · ·
>
0.744

340
10. Primes in Arithmetic Progressions
and
L(1, χ4)
=
1 −
1
3 −1
5

−
1
7 −1
9

−· · ·
<
0.835.
(Using the power series expansion of the inverse tangent, one can prove
Leibniz’s formula L(1, χ4) = π/4 = 0.785....)
Theorem 10.6 For 1 < σ < 2,

p≡1
(mod 4)
1
pσ = 1
2 log
1
σ −1 + O(1)
and

p≡3
(mod 4)
1
pσ = 1
2 log
1
σ −1 + O(1).
In particular, there exist inﬁnitely many primes p ≡1
(mod 4) and in-
ﬁnitely many primes p ≡3
(mod 4).
Proof. Since L(s, χ4) is continuous for σ > 0, it follows that
log L(σ, χ4) = O(1)
for 1 ≤σ ≤2.
Let 1 < σ < 2. By (10.1) of Theorem 10.3, we have
log L(σ, χ0) =

p≥3
1
pσ + O(1)
and
log L(σ, χ4) =

p≥3
(−1)(p−1)/2
pσ
+ O(1).
Therefore,

p≡1
(mod 4)
1
pσ
=
1
2 (log L(σ, χ0) + log L(σ, χ4)) + O(1)
=
1
2 log L(σ, χ0) + O(1)
=
1
2 log
1
σ −1 + O(1),
by Theorem 10.5. Since
lim
σ→1+ log
1
σ −1 = ∞,

10.4 The Nonvanishing of L(1, χ)
341
it follows that there exist inﬁnitely many primes congruent to 1 modulo 4.
Similarly,

p≡3
(mod 4)
1
pσ = 1
2 log
1
σ −1 + O(1),
and there exist inﬁnitely many primes congruent to 3 modulo 4. 2
Exercises
1. Let χ0 be the principal Dirichlet character modulo 6, and let χ6 be
the nonprincipal Dirichlet character modulo 6. Prove that

p≡1
(mod 6)
1
pσ = 1
2 (log L(σ, χ0) + log L(σ, χ6)) + O(1)
and

p≡5
(mod 6)
1
pσ = 1
2 (log L(σ, χ0) −log L(σ, χ6)) + O(1).
2. Prove that there exist inﬁnitely many primes p ≡1
(mod 6) and
inﬁnitely many primes p ≡5
(mod 6).
3. Compute L(1, χ6) with an error of at most 0.01.
10.4
The Nonvanishing of L(1, χ)
In this section we prove that L(1, χ) ̸= 0 for every nonprincipal character
χ.
Lemma 10.1 Let χ0 be the principal character modulo m. Then

n≤x
χ0(n)Λ(n)
n
= log x + O(1).
Proof. Observe that

n≤x
(n,m)>1
Λ(n)
n
=

p|m

pk≤x
k≥1
Λ(pk)
pk
<

p|m
∞

k=1
log p
pk

342
10. Primes in Arithmetic Progressions
=

p|m
log p
p −1
=
O(1).
By Mertens’s theorem (Theorem 8.5), we have

n≤x
χ0(n)Λ(n)
n
=

n≤x
(n,m)=1
Λ(n)
n
=

n≤x
Λ(n)
n
−

n≤x
(n,m)>1
Λ(n)
n
=
log x + O(1).
This completes the proof. 2
Lemma 10.2 Let χ be a nonprincipal character modulo m. If L(1, χ) ̸= 0,
then

n≤x
χ(n)Λ(n)
n
= O(1).
Proof. Recall that F(t) = 
k≤t χ(k) ≪1 (Exercise 6 in Section 10.1).
By partial summation, we have

k≤x
χ(k) log k
k
=
F(x) log x
x
−
# x
1
F(t)(1 −log t)
t2
dt
≪
log x
x
+
# ∞
1
1 + log t
t2
dt
≪
1.
By Theorem 10.4, we have
L(1, χ) =

d≤x/n
χ(d)
d
+ O
n
x

.
Using the identity log k = 
n|k Λ(n), we obtain

k≤x
χ(k) log k
k
=

k≤x
χ(k)
k

n|k
Λ(n)
=

nd≤x
χ(nd)Λ(n)
nd

10.4 The Nonvanishing of L(1, χ)
343
=

n≤x
χ(n)Λ(n)
n

d≤x/n
χ(d)
d
=

n≤x
χ(n)Λ(n)
n

L(1, χ) + O
n
x

=
L(1, χ)

n≤x
χ(n)Λ(n)
n
+

n≤x
χ(n)Λ(n)
n
O
n
x

=
L(1, χ)

n≤x
χ(n)Λ(n)
n
+ O(1),
since

n≤x
χ(n)Λ(n)
n
O
n
x

≪1
x

n≤x
Λ(n) = ψ(x)
x
≪1
by Chebyshev’s theorem (Theorem 8.2). Therefore,
L(1, χ)

n≤x
χ(n)Λ(n)
n
= O(1).
If L(1, χ) ̸= 0, then

n≤x
χ(n)Λ(n)
n
= O(1).
This completes the proof. 2
Lemma 10.3 Let χ be a nonprincipal character modulo m. If L(1, χ) = 0,
then

n≤x
χ(n)Λ(n)
n
= −log x + O(1).
Proof. Since
Λ(n) = −

d|n
µ(d) log d,
we have

n≤x
χ(n)Λ(n)
n
= −

n≤x
χ(n)
n

d|n
µ(d) log d.
From the identity
log x =

n≤x
χ(n)
n

d|n
µ(d) log x,

344
10. Primes in Arithmetic Progressions
we have
log x +

n≤x
χ(n)Λ(n)
n
=

n≤x
χ(n)
n

d|n
µ(d) log x
d
=

dk≤x
χ(dk)µ(d)
dk
log x
d
=

d≤x
χ(d)µ(d)
d
log x
d

k≤x/d
χ(k)
k
=

d≤x
χ(d)µ(d)
d
log x
d

L(1, χ) + O
d
x

=
L(1, χ)

d≤x
χ(d)µ(d)
d
log x
d +

d≤x
O
d
x
 χ(d)µ(d)
d
log x
d
=
L(1, χ)

d≤x
χ(d)µ(d)
d
log x
d + O(1),
since

d≤x
O
d
x
 χ(d)µ(d)
d
log x
d ≪1
x

d≤x
log x
d ≪1
by Theorem 6.4. If L(1, χ) = 0, then

n≤x
χ(n)Λ(n)
n
= −log x + O(1).
This completes the proof. 2
Theorem 10.7 Let χ be a complex character modulo m. Then L(1, χ) ̸= 0.
Proof. Let N denote the number of nonprincipal characters modulo
m such that L(1, χ) = 0. We shall prove that N = 0 or 1. By Lem-
mas 10.1, 10.2, and 10.3, and the orthogonality relations for Dirichlet char-
acters (Theorem 10.1), we have
ϕ(m)

n≤x
n≡1
(mod m)
Λ(n)
n
=

n≤x
Λ(n)
n

χ
(mod m)
χ(n)
=

χ
(mod m)

n≤x
χ(n)Λ(n)
n

10.4 The Nonvanishing of L(1, χ)
345
=

n≤x
χ0(n)Λ(n)
n
+

χ̸=χ0

n≤x
χ(n)Λ(n)
n
=
log x −N log x + O(1)
=
(1 −N) log x + O(1).
Since Λ(n)/n ≥0 for all n ≥1, it follows that both sides of this equation
are nonnegative for large x, and so N ≤1. Therefore, L(1, χ) = 0 for at
most one nonprincipal character χ.
If χ is a complex character modulo m, then χ is also a complex character
and χ ̸= χ. We have
L(1, χ) =
∞

n=1
χ(n)
n
=
∞

n=1
χ(n)
n
= L(1, χ),
and so L(1, χ) = 0 if and only if L(1, χ) = 0. Since N ≤1, we must have
L(1, χ) ̸= 0 for every complex character χ. This completes the proof. 2
Theorem 10.8 Let χ be a real nonprincipal character modulo m. Then
L(1, χ) ̸= 0.
Proof. Since the character χ is real, we have χ(n) = ±1 for every integer
n. Consequently, for every prime power pr,
r

j=0
χ(pj) = 1 + χ(p) + χ(p)2 + · · · + χ(p)r ≥0
and
r

j=0
χ(pj) ≥1
if r is even.
The character χ is multiplicative, and so the convolution
t(k) = 1 ∗χ(k) =

d|k
χ(d)
is also a multiplicative function. It follows that
t(k) =

pr∥k
t(pr) =

pr∥k
r

j=0
χ(pj) ≥0
and
t(k) ≥1
if k = m2 is a square.

346
10. Primes in Arithmetic Progressions
Using the asymptotic formula in Theorem 6.9 for the partial sums of the
harmonic series, we obtain for large x the lower bound
T(x)
=

k≤x
t(k)
k1/2 ≥

m2≤x
t(m2)
m
≥

m≤x1/2
1
m > log x
2
.
Applying the L-function estimate (10.2) in Theorem 10.4 with s = 1 and
s = 1/2, we have

n≤x
χ(n)
n
= L(1, χ) + O

x−1
and

n≤x
χ(n)
n1/2 = L(1/2, χ) + O

x−1/2
.
Let x ≥1 and y = x1/2. By Exercise 6, the set of all lattice points (n, d)
such that n and d are positive and nd ≤x can be partitioned into two
disjoint sets as follows: The ﬁrst set consists of all lattice points (n, d) such
that 1 ≤n ≤x1/2 and 1 ≤d ≤x/n, and the second set consists of all lattice
points (n, d) such that 1 ≤d < x1/2 and x1/2 < n ≤x/d. If d = x1/2, then
x/d = x1/2 and there is no integer n such that x1/2 < n ≤x/d. Therefore,
the second set can also be described as the set of all lattice points (n, d)
such that 1 ≤d ≤x1/2 and x1/2 < n ≤x/d. We have
T(x)
=

k≤x
t(k)
k1/2
=

k≤x
1
k1/2

n|k
χ(n)
=

nd≤x
χ(n)
(nd)1/2
=

n≤x1/2

d≤x/n
χ(n)
(nd)1/2 +

d≤x1/2

x1/2<n≤x/d
χ(n)
(nd)1/2
=

n≤x1/2
χ(n)
n1/2

d≤x/n
1
d1/2 +

d≤x1/2
1
d1/2

x1/2<n≤x/d
χ(n)
n1/2 .
We shall estimate these sums separately. By Exercise 7,

d≤x
1
d1/2 = 2x1/2 −c + O

x−1/2
.

10.4 The Nonvanishing of L(1, χ)
347
The ﬁrst sum is

n≤x1/2
χ(n)
n1/2

d≤x/n
1
d1/2
=

n≤x1/2
χ(n)
n1/2
2x1/2
n1/2 −c + O
n1/2
x1/2

=
2x1/2

n≤x1/2
χ(n)
n
−c

n≤x1/2
χ(n)
n1/2 + O


n≤x1/2
1
x1/2


=
2x1/2 
L(1, χ) + O

x−1/2
−cL(1/2, χ) + O

x−1/4
+ O(1)
=
2L(1, χ)x1/2 + O(1).
The second sum is

d≤x1/2
1
d1/2

x1/2<n≤x/d
χ(n)
n1/2
=

d≤x1/2
1
d1/2

L(1/2, χ) + O
d1/2
x1/2

−

L(1/2, χ) + O

x−1/4
=

d≤x1/2
1
d1/2

O
d1/2
x1/2

+ O

x−1/4
≪
1 +
1
x1/4

d≤x1/2
1
d1/2
≪
1 +
1
x1/4

x1/4 + 1

≪
1.
Therefore,
T(x) = 2L(1, χ)x1/2 + O(1).
However, we also have
T(x) > log x
2
for suﬃciently large x, which is impossible if L(1, χ) = 0. Therefore, L(1, χ) ̸=
0 for all nonprincipal real characters χ. 2
We can now prove Dirichlet’s theorem.
Theorem 10.9 (Dirichlet) Let m and a be relatively prime positive in-
tegers. For 1 < σ < 2,

p≡a
(mod m)
1
pσ =
1
ϕ(m) log

1
σ −1

+ O(1)

348
10. Primes in Arithmetic Progressions
In particular, there exist inﬁnitely primes p such that p ≡a
(mod m).
Proof. Let 1 < σ < 2. Using the orthogonality relations for Dirich-
let characters (Theorem 10.2) and the estimate (10.1) for log L(s, χ) from
Theorem 10.3, we obtain

χ
(mod m)
χ(a) log L(σ, χ)
=

χ
(mod m)

p
χ(a)χ(p)
pσ
+ O(1)
=

p
1
pσ

χ
(mod m)
χ(a)χ(p) + O(1)
=
ϕ(m)

p≡a
(mod m)
1
pσ + O(1).
By Theorem 10.5, the term on the left corresponding to the principal char-
acter χ0 is
χ0(a) log L(σ, χ0) = log

1
σ −1

+ O(1),
and so
ϕ(m)

p≡a
(mod m)
1
pσ = log

1
σ −1

+

χ̸=χ0
χ(a) log L(σ, χ) + O(1).
If χ is a nonprincipal character modulo m, then L(1, χ) ̸= 0 by Theo-
rem 10.7 and Theorem 10.8, and so log L(σ, χ) = O(1) for 1 ≤σ ≤2. This
proves that

p≡a
(mod m)
1
pσ =
1
ϕ(m) log

1
σ −1

+ O(1).
Therefore, the series 
p≡a
(mod m) p−σ diverges as σ →1+, and so it must
have inﬁnitely many terms, that is, there must exist inﬁnitely primes p such
that p ≡a
(mod m). This completes the proof of Dirichlet’s theorem. 2
Finally, we obtain a generalization of Mertens’s theorem (Theorem 8.5)
to sums of Λ(n)/n over an arithmetic progression.
Theorem 10.10 Let m ≥1 and a be relatively prime integers. Then

n≤x
n≡a
(mod m)
Λ(n)
n
= log x
ϕ(m) + O(1).
Proof. For the principal character χ0 we have

n≤x
χ0(n)Λ(n)
n
= log x + O(1)

10.4 The Nonvanishing of L(1, χ)
349
by Lemma 10.1. For every nonprincipal character χ modulo m, we have
L(1, χ) ̸= 0 by Theorems 10.7 and 10.8, and so

n≤x
χ(n)Λ(n)
n
= O(1)
by Lemma 10.2. Since χ0(a) = 1, it follows that

χ
(mod m)
χ(a)

n≤x
χ(n)Λ(n)
n
= χ(a) log x + O(1) = log x + O(1).
On the other hand, by Theorem 10.2,

χ
(mod m)
χ(a)

n≤x
χ(n)Λ(n)
n
=

n≤x
Λ(n)
n

χ
(mod m)
χ(a)χ(n)
=
ϕ(m)

n≤x
n≡a
(mod m)
Λ(n)
n
.
This completes the proof. 2
Exercises
1. Let χ4 be the nonprincipal character modulo 4. Prove that
L(1, χ4) = 2
∞

n=1
1
(4n −2)2 −1 = 1 −2
∞

n=2
1
16n2 −1.
2. Let χ3 be the nonprincipal character modulo 3. Prove that
L(1, χ3) = 2
∞

n=0
1
(3n + 1)(3n + 2).
3. Let χ be the Dirichlet character modulo 8 deﬁned by χ(3) = χ(5) =
−1. Show that
L(1, χ) = 2
∞

k=0
85k + 32
(8k + 1)(8k + 3)(8k + 5)(8k + 7).
4. Let χ1 be the real primitive character modulo 5. Prove that L(1, χ) >
0. Let χ2 be the complex character modulo 5 deﬁned by χ2(2) = i.
Prove that the real and imaginary parts of L(1, χ2) are positive.

350
10. Primes in Arithmetic Progressions
5. Let m and a be relatively prime positive integers. Prove that

p≤x
p≡a
(mod m)
log p
p
= log x
ϕ(m) + O(1).
6. Prove that the set of all lattice points (n, d) such n and d are positive
and nd ≤x can be partitioned into two disjoint sets as follows: The
ﬁrst set consists of all lattice points (n, d) such that 1 ≤n ≤y and
1 ≤d ≤x/n, and the second set consists of all lattice points (n, d)
such that 1 ≤d < x/y and y < n ≤x/d.
7. Compute the constant c such that

d≤x
1
d1/2 = 2x1/2 −c + O(x−1/2).
Hint. Partial summation.
10.5
Notes
Our proof of Dirichlet’s theorem is “elementary” in the sense that it does
not use complex analysis. Selberg [127] gave a diﬀerent proof that is, he
wrote, “more elementary in the respect that we do not use the complex
characters mod k, and also in that we consider only ﬁnite sums.”
Let m and a be relatively prime positive integers. We denote by π(x; m, a)
the number of prime numbers p ≤x such that p ≡a
(mod m). By the
prime number theorem,
π(x) =
m

a=1
(a,m)=1
π(x; m, a) +

p|m
1 ∼x.
The prime number theorem for arithmetic progressions states that for every
integer m ≥3 the prime numbers are uniformly distributed in the ϕ(m)
congruence classes relatively prime to m, that is, if (a, m) = (b, m) = 1,
then
π(x; m, a) ∼π(x; m, b).
Equivalently, if (a, m) = 1, then
π(x; m, a) ∼
x
ϕ(m) log x.
Selberg [129] also gave an elementary proof of this result. Granville [39]
reviews elementary proofs of the prime number theorem for arithmetic
progressions. For an analytic proof, see Davenport [21].

10.5 Notes
351
For moduli m ≥3 we can describe the comparative prime number race as
follows. There are ϕ(m) runners, one for each congruence class a relatively
prime to m. For every positive integer x, the position of runner a
(mod m)
at time x is π(x; m, a). A runner wins the mod m race if it is eventually
ahead of all the others. Does some congruence class win, or does the lead
oscillate inﬁnitely often between some or all of the competitors? In the
case m = 4, Littlewood [94, 54] proved that π(x; 4, 1) −π(x; 4, 3) changes
sign inﬁnitely often, so no class wins the “mod 4” race. More generally,
we can ask the following question: Is it true that for every permutation
a1, . . . , aϕ(m) of the ϕ(m) congruence classes relatively prime to m, we
have
π(x; m, a1) < π(x; m, a2) < · · · < π(x; m, aϕ(m))
for inﬁnitely many integers x? This is an open problem in comparative
prime number theory. For some results on this topic, see Tur´an [144].
In the Notes at the end of Chapter 9, we stated the Riemann hypothesis
in the form
π(x) = li(x) + O

x1/2+ε
for every ε > 0. In Exercise 9 of Section 10.2 we constructed the meromor-
phic continuation of the Riemann zeta function to the half-plane σ > 0.
We can now state the Riemann hypothesis in its usual form: If ζ(s) = 0
with s = σ + it and σ > 0, then σ = 1/2.

Part III
Three Problems in
Additive Number Theory

11
Waring’s Problem
11.1
Sums of Powers
Lagrange proved that every number is the sum of four squares. This means
that for every nonnegative integer n there exist nonnegative integers x1,
x2, x3, x4 such that
n = x2
1 + x2
2 + x2
3 + x2
4.
Similarly, Wieferich proved that every number is the sum of nine cubes,
that is, for every nonnegative integer n there exist nonnegative integers
x1, . . . , x9 such that
n = x3
1 + x3
2 + · · · + x3
9.
These are special cases of Waring’s problem, one of the most famous prob-
lems in number theory. Waring’s problem states that for every integer k ≥2
there exists a number h such that every nonnegative integer can be written
as the sum of exactly h kth powers. The smallest such integer h is usually
denoted by g(k). Since 7 cannot be written as the sum of three squares,
and 23 cannot be written as the sum of 8 cubes, we can restate Lagrange’s
theorem as g(2) = 4, and Wieferich’s theorem as g(3) = 9.
In 1909, the German mathematician David Hilbert proved Waring’s
problem for all exponents k. The British mathematicians G. H. Hardy and
J. E. Littlewood subsequently devised a diﬀerent proof, and their method
was simpliﬁed and improved by the Soviet mathematician I. M. Vinogradov.
These proofs involve sophisticated techniques of real and complex analy-
sis, even though the statement of Waring’s problem is purely arithmetic.
In 1943, another Soviet mathematician, Yu. V. Linnik, devised a proof of

356
11. Waring’s Problem
Waring’s problem that uses only elementary number theory. In this and
the following chapter we give Linnik’s proof of Waring’s problem.
There is a natural generalization of Waring’s problem to polynomials.
Let f(x) be a polynomial of degree k that is integer-valued, that is, f(x)
is an integer for every integer x. Every polynomial with integer coeﬃcients
is integer-valued. There are also polynomials with rational coeﬃcients that
are integer-valued. For example, the binomial polynomial
bk(x) =
x
k

= x(x −1) · · · (x −k + 1)
k!
is integer-valued, and every integral linear combination of binomial poly-
nomials is integer-valued. Moreover, every integer-valued polynomial f(x)
of degree k can be expressed uniquely in the form
f(x) =
k

i=0
uibi(x) =
k

i=0
ui
x
i

,
where u0, u1, . . . , uk are integers and uk ̸= 0 (by Exercise 4). This is the
standard representation of an integer-valued polynomial.
If f(x) is an integer-valued polynomial of degree k ≥1 with positive
leading coeﬃcient, then there exists a nonnegative integer m such that
f(m) ≥0 and f(x) is strictly increasing for x ≥m. Let fm(x) = f(x + m).
Then fm(x) is an integer-valued polynomial such that
A(fm) = {fm(i)}∞
i=0
is a strictly increasing sequence of nonnegative integers. The polynomials
f(x) and fm(x) have the same degrees and the same leading coeﬃcients
(by Exercise 9). Replacing f(x) with fm(x), we can assume that f(x) is an
integer-valued polynomial such that
A(f) = {f(i)}∞
i=0
is a strictly increasing sequence of nonnegative integers.
Waring’s problem for polynomials states that if the greatest common
divisor of the set A(f) is 1, then every suﬃciently large integer can be
written as the sum of a bounded number of elements of A(f). If also 0, 1 ∈
A(f), then there exists an integer h such that every nonnegative integer can
be written as the sum of exactly h elements of A(f). The classical Waring’s
problem is the special case f(x) = xk. We shall also prove Waring’s problem
for polynomials by Linnik’s method.
In the next chapter we obtain a generalization of Waring’s problem for
ﬁnite sequences of polynomials.
Exercises
In this set of exercises we characterize integer-valued polynomials.

11.1 Sums of Powers
357
1. Deﬁne b0(x) = 1. For every integer k ≥1, deﬁne the kth binomial
polynomial
bk(x) =
x
k

= x(x −1) · · · (x −k + 1)
k!
.
Compute bk(x) for k = 0, 1, 2, 3. Prove that if k ≥1 and n ≥1, then
bk(−n) = (−1)kbk(n + k −1).
Prove that if f(x) is a polynomial of degree k with complex coeﬃ-
cients, then there exist unique complex numbers u0, u1,. . . , uk with
uk ̸= 0 such that
f(x) =
k

i=0
uibi(x) =
k

i=0
ui
x
i

.
(11.1)
2. For any function f(x), deﬁne the diﬀerence operator
∆f(x) = f(x + 1) −f(x).
Prove that ∆b0(x) = 0 and that
∆bk(x) = bk−1(x)
for all k ≥1. If
f(x) =
k

i=0
ui
x
i

,
prove that
∆f(x) =
k−1

i=0
ui+1
x
i

.
3. A polynomial f(x) is called integer-valued if f(n) is an integer for
every integer n, that is, if f(Z) ⊆Z. Prove that bk(x) is an integer-
valued polynomial of degree k for every k ≥0. Prove that if u0, u1,. . . ,
uk are integers and uk ̸= 0, then
f(x) =
k

i=0
ui
x
i

is an integer-valued polynomial of degree k.
4. Let f(x) be a polynomial of degree k with complex coeﬃcients. Prove
that if f(x) is an integer for all suﬃciently large integers x, then there
exist unique integers u0, u1, . . . , uk with uk ̸= 0 such that
f(x) =
k

i=0
ui
x
i

.

358
11. Waring’s Problem
Hint: Observe that if k ≥1 and f(x) is integer-valued for all suﬃ-
ciently large x, then ∆f(x) is also integer-valued for all suﬃciently
large x. Represent f(x) in the form (11.1) and use induction on k.
5. Let f(x) be a polynomial of degree k with complex coeﬃcients. Prove
that if f(x) is an integer for all suﬃciently large integers x, then f(x)
is an integer for all integers x.
6. Prove that if f(x) is an integer-valued polynomial of degree k with
leading coeﬃcient ak, then
|ak| ≥1
k!.
7. Let f(x) be an integer-valued polynomial, and deﬁne
d = gcd{f(x) : x ∈N0}
and
d′ = gcd{f(x) : x ∈Z}.
Let u0, u1, . . . , uk be integers such that
f(x) =
k

i=0
ui
x
i

.
Prove that
d = d′ = (u0, u1, . . . , uk).
8. Prove that if
f(x) =
k

i=0
ui
x
i

,
then
f1(x) = f(x + 1) = uk
x
k

+
k−1

i=0
(ui + ui+1)
x
i

.
Prove that
gcd(u0, u1, . . . , uk−1, uk)
=
gcd(u0 + u1, u1 + u2, . . . , uk−1 + uk, uk).
9. Let f(x) be an integer-valued polynomial and let m ∈Z. We deﬁne
the polynomial fm(x) = f(x + m). Prove that f(x) and fm(x) are
polynomials of the same degree and with the same leading coeﬃcient.
Let A(f) = {f(i)}∞
i=0. Prove that gcd(A(f)) = gcd(A(fm)).

11.2 Stable Bases
359
11.2
Stable Bases
A set A of nonnegative integers is called a basis of order h if every positive
integer can be written as the sum of exactly h elements of A. The set A
is called a basis of ﬁnite order if A is a basis of order h for some h. For
example, by Lagrange’s theorem the set of squares is a basis of order four.
Waring’s problem states that for every k ≥2, the set of nonnegative kth
powers is a basis of ﬁnite order.
Let A = {ai}∞
i=0 be an inﬁnite set of nonnegative integers such that
a0 < a1 < a2 · · ·. The counting function of A, denoted by A(n), counts the
number of positive elements of A that do not exceed n, that is,
A(n) =

ai∈A
1≤ai≤n
1.
The Shnirel’man density of the set A is
σ(A)
=
inf
A(n)
n
: n = 1, 2, . . .

=
sup

α : A(n)
n
≥α for all n = 1, 2, . . .

.
Then 0 ≤σ(A) ≤1 for every set A. If σ(A) = α, then A(n) ≥αn for every
n ≥1.
Let B = {bi}∞
i=0 be a set of nonnegative integers such that 0 = b0 < b1 <
b2 < · · ·. We construct the subset AB ⊆A as follows:
AB = {abi}∞
i=0.
Then
a0 = ab0 < ab1 < ab2 < · · · .
For example, AN0 = A.
If the Shnirel’man density of B is positive, then AB is called a subset
of A of positive Shnirel’man density. The set A is called a stable basis if
every subset of A of positive Shnirel’man density is a basis of ﬁnite order.
Shnirel’man proved that the set of kth powers is a stable basis for every
k ≥1. We shall also prove this generalization of Waring’s problem.
A set A of nonnegative integers is called an asymptotic basis of order
h if every suﬃciently large positive integer can be written as the sum of
exactly h elements of A. We call A an asymptotic basis of ﬁnite order if A is
an asymptotic basis of order h for some h. Let gcd(A) denote the greatest
common divisor of the elements of the set A. If gcd(A) = d, then every sum
of elements of A is divisible by d. It follows that the set A is an asymptotic
basis only if gcd(A) = 1.

360
11. Waring’s Problem
The lower asymptotic density of the set A is
dL(A) = lim inf
A(n)
n
: n = 1, 2, . . .

.
Then 0 ≤dL(A) ≤1 for every set A. Let B = {bi}∞
i=0 be a strictly in-
creasing sequence of nonnegative integers. If the lower asymptotic density
of B is positive, then the set AB is called a subset of A of positive lower
asymptotic density. An asymptotically stable basis is a set A that satisﬁes
the following condition: If dL(B) > 0 and gcd(AB) = d, then there exists
an integer h = h(B) such that every suﬃciently large multiple of d can be
written as the sum of at most h elements of AB. In particular, AB is an
asymptotic basis of ﬁnite order for every set B such that dL(B) > 0 and
gcd(AB) = 1.
We shall also prove that the set of kth powers is an asymptotically stable
basis for every k ≥1.
Exercises
1. Let A be a set of nonnegative integers. Prove that if σ(A) > 0, then
1 ∈A.
2. Let m ≥2. Let Ar be the set of all nonnegative integers a such that
a ≡r
(mod m). Compute the Shnirel’man density of Ar and the
lower asymptotic density of Ar for r = 0, 1, . . . , m −1.
3. For k ≥2, let A(k) = {nk : n ∈N0} be the set of the kth powers of
the nonnegative integers. Compute the Shnirel’man density of A(k).
4. Let A(∞) = ∪∞
k=2A(k), where A(k) is the set of kth powers. Compute
the Shnirel’man density of A(∞).
5. Let P be the set of prime numbers and let P′ = P ∪{1}. Compute
the Shnirel’man density of P′.
6. Recall that [x] denotes the integer part of the real number x. Let
L0 = {[log n] : n = 1, 2, 3, . . .}. Compute the Shnirel’man density of
L0.
7. Compute the Shnirel’man density of the set L1 = {[n log n] : n =
1, 2, 3, . . .}.
8. For 0 < a < 1, let La = {[na log n] : n = 1, 2, 3, . . .}. Compute the
Shnirel’man density of the set La.
9. Let A = {ai}∞
i=1 be a set of positive integers with 1 = a1 < a2 <
a3 < · · ·. Prove that σ(A) > 0 if lim supi→∞(ai+1 −ai) < ∞.

11.3 Shnirel’man’s Theorem
361
10. Let A = {ai}∞
i=1 be a set of positive integers with 1 = a1 < a2 <
a3 < · · ·. Prove that σ(A) = 0 if limi→∞(ai+1 −ai) = ∞.
11. Construct a set A = {ai}∞
i=0 of positive integers such that σ(A) > 0
and lim supi→∞(ai+1 −ai) = ∞.
12. Let A = {ai}∞
i=0 and B = {bi}∞
i=0 be inﬁnite sets of nonnegative
integers with
0
=
a0 < a1 < a2 < · · · ,
0
=
b0 < b1 < b2 < · · · ,
and counting functions A(n) and B(n), respectively. Let AB(n) be
the counting function of the set AB = {abi}∞
i=0. Prove that
AB(n)
=
B(A(n)),
σ(AB)
≥
σ(A)σ(B),
and
dL(AB) ≥dL(A)dL(B).
11.3
Shnirel’man’s Theorem
Let A and B be nonempty sets of integers. The sumset A + B is the set
consisting of all integers of the form a + b, where a ∈A and b ∈B. The
diﬀerence set A −B consists of all integers of the form a −b, where a ∈A
and b ∈B.
If A1, A2, . . . , Ah are h sets of integers, then
A1 + A2 + · · · + Ah
denotes the sumset consisting of all integers of the form a1 + a2 + · · · + ah,
where ai ∈Ai for i = 1, 2, . . . , h. If Ai = A for all i = 1, 2, . . . , h, we let
hA = A + · · · + A
&
'(
)
h times
.
Then A is a basis of order h if N0 ⊆hA, that is, if the sumset hA contains
every nonnegative integer. The set A is an asymptotic basis of order h if
hA contains every suﬃciently large integer.
Let A be a set of integers. If A contains every positive integer, then
A(n) = n for all n ≥1 and A has Shnirel’man density σ(A) = 1. If n /∈A
for some n ≥1, then A(n) ≤n −1 and
σ(A) ≤A(n)
n
≤1 −1
n < 1.

362
11. Waring’s Problem
Thus, σ(A) = 1 if and only if A contains every positive integer.
Shnirel’man density is an important additive measure of the size of a
set of integers. In particular, the set A is a basis of order h if and only if
σ(hA) = 1, and the set A is a basis of ﬁnite order if and only if σ(hA) = 1
for some h ≥1. Shnirel’man made the simple but extraordinarily powerful
discovery that if A is any set of integers that contains 0 and has positive
Shnirel’man density, then A is a basis of ﬁnite order. It follows that if
σ(A) = 0 but σ(h1A) > 0 for some integer h1, then the sumset h1A is a
basis of ﬁnite order, and so A is also a basis of ﬁnite order. This is a key
idea in our proof of Waring’s problem. Although the set A(k) of nonnegative
kth powers has Shnirel’man density zero, we shall prove that there exists
an integer h1 such that the set h1A(k) of all sums of h1 nonnegative kth
powers has positive Shnirel’man density.
Lemma 11.1 Let A and B be sets of integers such that 0 ∈A and 0 ∈B.
If A(n) + B(n) ≥n, then n ∈A + B.
Proof. If n ∈A, then n = n + 0 ∈A + B. Similarly, if n ∈B, then
n = 0 + n ∈A + B.
Suppose that n ̸∈A ∪B. Deﬁne sets A′ and B′ by
A′ = {n −a : a ∈A, 1 ≤a ≤n −1}
and
B′ = B ∩[1, n −1].
Then |A′| = A(n), since n ̸∈A, and |B′| = B(n), since n ̸∈B. Moreover,
A′ ∪B′ ⊆[1, n −1].
Since
|A′| + |B′| = A(n) + B(n) ≥n,
it follows that
A′ ∩B′ ̸= ∅.
Therefore, n −a = b for some a ∈A and b ∈B, and so n = a + b ∈A + B.
2
Lemma 11.2 Let A and B be sets of integers such that 0 ∈A and 0 ∈B.
If σ(A) + σ(B) ≥1, then N0 ⊆A + B.
Proof. We have 0 = 0 + 0 ∈A + B. If n ≥1, then
A(n) + B(n) ≥(σ(A) + σ(B))n ≥n,
and Lemma 11.1 implies that n ∈A + B. 2

11.3 Shnirel’man’s Theorem
363
Lemma 11.3 Let A be a set of integers such that 0 ∈A and σ(A) ≥1/2.
Then A is a basis of order 2.
Proof. This follows immediately from Lemma 11.2 with A = B. 2
Theorem 11.1 (Shnirel’man) Let A and B be sets of integers such that
0 ∈A and 0 ∈B. Let σ(A) = α and σ(B) = β. Then
σ(A + B) ≥α + β −αβ.
(11.2)
Proof. Let n ≥1. Let a0 = 0 and let
1 ≤a1 < · · · < ak ≤n
be the k = A(n) positive elements of A that do not exceed n. Since 0 ∈B,
it follows that ai = ai + 0 ∈A + B for i = 1, . . . , k. For i = 0, . . . , k −1, let
1 ≤b1 < · · · < bri ≤ai+1 −ai −1
be the ri = B(ai+1 −ai −1) positive integers in B that are less than
ai+1 −ai. Then
ai < ai + b1 < · · · < ai + bri < ai+1
and
ai + bj ∈A + B
for j = 1, . . . , ri. Let
1 ≤b1 < · · · < brk ≤n −ak
be the rk = B(n −ak) positive integers in B that do not exceed n −ak.
Then
ak < ak + b1 < · · · < ak + brk ≤n
and
ak + bj ∈A + B
for j = 1, . . . , rk. It follows that
(A + B)(n)
≥
A(n) +
k

i=0
ri
=
A(n) +
k−1

i=0
B(ai+1 −ai −1) + B(n −ak)
≥
A(n) + β
k−1

i=0
(ai+1 −ai −1) + β(n −ak)

364
11. Waring’s Problem
=
A(n) + βn −βk
=
(1 −β)A(n) + βn
≥
(1 −β)αn + βn
=
(α + β −αβ)n,
and so
(A + B)(n)
n
≥α + β −αβ
for all positive integers n. Therefore,
σ(A + B) = inf
(A + B)(n)
n
: n = 1, 2, . . .

≥α + β −αβ.
This completes the proof. 2
Inequality (11.2) can be expressed as follows:
1 −σ(A + B) ≤(1 −σ(A))(1 −σ(B)).
(11.3)
We can generalize this inequality to the sum of any ﬁnite number of sets
of integers.
Theorem 11.2 Let h ≥1, and let A1, . . . , Ah be sets of integers with
0 ∈Ai for i = 1, . . . , h. Then
1 −σ(A1 + · · · + Ah) ≤
h

i=1
(1 −σ(Ai)).
Proof. This is by induction on h. Let σ(Ai) = αi for i = 1, . . . , h. For
h = 1, there is nothing to prove, and for h = 2 the inequality is equivalent
to (11.3).
Let h ≥3, and assume that the theorem holds for h −1 sets. Let
A1, . . . , Ah be h sets of integers such that 0 ∈Ai for all i. Let B =
A1 + · · · + Ah−1. We have the induction hypothesis
1 −σ(B) = 1 −σ(A1 + · · · + Ah−1) ≤
h−1

i=1
(1 −σ(Ai)),
and so
1 −σ(A1 + · · · + Ah)
=
1 −σ(B + Ah)
≤
(1 −σ(B)(1 −σ(Ah))
≤
h−1

i=1
(1 −σ(Ai))(1 −σ(Ah)
=
h

i=1
(1 −σ(Ai)).

11.3 Shnirel’man’s Theorem
365
This completes the proof. 2
Theorem 11.3 Let 0 < α ≤1. There exists an integer h = h(α) such that
if A1, . . . , Ah are sets of nonnegative integers with 0 ∈Ai and σ(Ai) ≥α
for all i = 1, . . . , h, then
A1 + · · · + Ah = N0.
Proof. Since 0 ≤1 −α < 1, there exists a positive integer h1 such that
0 ≤(1 −α)h1 ≤1
2.
Let h = 2h1, and let A1, . . . , Ah be sets of nonnegative integers with 0 ∈Ai
and σ(Ai) ≥α for i = 1, . . . , h. We deﬁne A = A1 + · · · + Ah1 and B =
Ah1+1 + · · · + A2h1. By Theorem 11.2,
σ(A) = σ(A1 + · · · + Ah1) ≥1 −
h1

i=1
(1 −σ(Ai)) ≥1 −(1 −α)h1 ≥1
2.
Similarly,
σ(B) = σ(Ah1+1 + · · · + A2h1) ≥1
2.
Applying Lemma 11.3, we obtain
A1 + · · · + Ah = A + B = N0.
This completes the proof. 2
Theorem 11.4 (Shnirel’man) Let A be a set of nonnegative integers
such that 0 ∈A and σ(A) > 0. Then A is a basis of ﬁnite order.
Proof. Let α = σ(A). The result follows from Theorem 11.3 with Ai = A
for i = 1, . . . , h(α).
Theorem 11.5 Let A be a set of nonnegative integers with 0 ∈A such
that σ(h1A) > 0 for some positive integer h1. Then A is a basis of ﬁnite
order.
Proof. If σ(h1A) > 0, then there exists an integer h2 such that h1A is a
basis of order h2, that is, every nonnegative integer is a sum of h2 elements
of h1A. Since
h2(h1A) = (h1h2)A,
the set A is a basis of order h = h1h2. 2

366
11. Waring’s Problem
Theorem 11.6 Let B be a set of nonnegative integers with 0 ∈B and
gcd(B) = 1. If dL(B) > 0, then B is an asymptotic basis of ﬁnite order.
Proof. The set A = B ∪{1} has positive Shnirel’man density (by Ex-
ercise 1), and so A is a basis of order h1 for some positive integer h1. It
follows that every nonnegative integer can be written in the form u + j,
where 0 ≤j ≤h1 and u is a sum of h1 −j elements of B. Since 0 ∈B,
u ∈(h1 −j)B ⊆h1B.
If B is any set of relatively prime positive integers, then, by Theorem 1.16,
there exists an integer n0 = n0(B) such that every integer n ≥n0 can be
represented as a sum of elements of B. Since 0 ∈B and gcd(B) = 1, there
exists a positive integer h2 such that
n0 + j ∈h2B
for j = 0, 1, . . . , h1. Let h = h1 + h2. If n ≥n0, then n −n0 ≥0 and we
can write n −n0 in the form u + j, where u ∈h1B and 0 ≤j ≤h1. Then
n = u + (n0 + j) ∈h1B + h2B = hB,
and so B is an asymptotic basis of ﬁnite order. 2
Theorem 11.7 Let B be a set of nonnegative integers with gcd(B) = d.
If dL(B) > 0, then every suﬃciently large multiple of d is the sum of a
bounded number of elements of B.
Proof. The set d−1 ∗B = {b/d : b ∈B} consists of nonnegative integers,
and
A = {0} ∪d−1 ∗B
is a set of nonnegative integers with 0 ∈A and gcd(A) = 1. By Theo-
rem 11.6, every suﬃciently large integer can be represented as the sum of
exactly h elements of A, and so every suﬃciently large multiple of d can be
represented as the sum of at most h elements of B. 2
Exercises
1. Let A be a set of nonnegative integers. Prove that σ(A) > 0 if and
only if 1 ∈A and dL(A) > 0.
2. Let h1 and h2 be positive integers with h1 < h2, and let A be a
nonempty set of integers. Prove that
h1A + h2A = (h1 + h2)A.

11.4 Waring’s Problem for Polynomials
367
Prove that
h1A −h2A = (h1 −h2)A
if and only if |A| = 1.
3. Let A be a set of nonnegative integers such that 0 ∈A and
0 < σ(A) ≤1
2.
Prove that
σ(2A) ≥3
2σ(A).
Use this to give another proof of Theorem 11.4.
4. Let A be a set of nonnegative integers such that 0 ∈A, A ̸= {0}, and
hA = (h + 1)A for some positive integer h.
(a) Prove that hA = ℓA for all ℓ≥h.
(b) Prove that hA is periodic, that is, there exists a positive integer
m such that if b ∈hA, then b + m ∈hA.
(c) Let d = gcd(A). Prove that hA ∼d∗N0, that is, the sumset hA
eventually coincides with the set of all multiples of d.
11.4
Waring’s Problem for Polynomials
Let f(x) be an integer-valued polynomial of degree k such that
A(f) = {f(i)}∞
i=0
is a strictly increasing sequence of nonnegative integers. Let d be the great-
est common divisor of A(f). By Exercises 5 and 7 in Section 11.1, the
polynomial f(x)/d is also integer-valued of degree k, and the greatest com-
mon divisor of A(f(x)/d) is 1. Without loss of generality, we can assume
that f(x) is an integer-valued polynomial with gcd(A(f)) = 1.
Let NSE denote “the number of solutions of the equation.” We deﬁne
representation functions rf,s(n) and Rf,s(N) for the polynomial f(x) by
rf,s(n) = NSE {f(x1) + · · · + f(xs) = n : x1, . . . , xs ∈N0}
and
Rf,s(N) =

0≤n≤N
rf,s(n).

368
11. Waring’s Problem
Lemma 11.4 Let f(x) = k
i=0 aixi be an integer-valued polynomial of
degree k with leading coeﬃcient ak > 0. Let
x∗(f) = 2(|ak−1| + |ak−2| + · · · + |a0|)
ak
.
(11.4)
If x > x∗(f) is an integer, then
akxk
2
< f(x) < 3akxk
2
.
(11.5)
If N is suﬃciently large, then
Rf,s(N) > 1
2
 2N
3aks
s/k
.
(11.6)
Proof. Since
f(x) = akxk

1 + ak−1
akx + ak−2
akx2 + · · · +
a0
akxk

,
it follows for x > x∗(f) that

f(x)
akxk −1

=

ak−1
akx + ak−2
akx2 + · · · +
a0
akxk

≤
|ak−1|
akx
+ |ak−2|
akx2 + · · · + |a0|
akxk
≤
|ak−1| + |ak−2| + · · · + |a0|
akx
=
x∗(f)
2x
<
1
2.
This proves (11.5).
If x1, . . . , xs are integers such that
x∗(f) < xj ≤
 2N
3aks
1/k
for j = 1, . . . , s, then
0 < akxk
j
2
< f(xj) < 3akxk
j
2
≤N
s
and
0 < f(x1) + · · · + f(xs) < N.

11.4 Waring’s Problem for Polynomials
369
The number of integers in the interval

x∗(f),
 2N
3aks
1/k3
is greater than
 2N
3aks
1/k
−x∗(f) −1,
and so
Rf,s(N) >
 2N
3aks
1/k
−x∗(f) −1
s
≥1
2
 2N
3aks
s/k
for N suﬃciently large. This proves (11.6). 2
Lemma 11.5 Let f(x) = k
i=0 aixi be an integer-valued polynomial of
degree k such that
A(f) = {f(i)}∞
i=0
is a strictly increasing sequence of nonnegative integers. Deﬁne x∗(f) by (11.4)
and let
N(f) = x∗(f)k
2k!
.
(11.7)
For N ≥N(f), if x1, . . . , xs are nonnegative integers with
s

j=1
f(xj) ≤N,
then
0 ≤xj ≤(2k!N)1/k
for j = 1, . . . , s.
Proof. Recall that k!ak ≥1 by Exercise 6 in Section 11.1. If N ≥N(f)
and xj > (2k!N)1/k ≥x∗(f), then
f(xj) > akxk
j
2
≥k!akN ≥N,
and so
s

i=1
f(xi) ≥f(xj) > N.
This completes the proof. 2
A critical part of Linnik’s solution of Waring’s problem is the following
result, which is a special case of Theorem 12.3.

370
11. Waring’s Problem
Theorem 11.8 Let {s(k)}∞
k=1 be the sequence of integers deﬁned recur-
sively by s(1) = 1 and
s(k) = 8k2[log2 s(k−1)]
for k ≥2.
Let c ≥1 and P ≥1. If
f(x) =
k

i=0
aixi
is an integer-valued polynomial of degree k such that
|ai| ≤cP k−i
for i = 0, 1, . . . , k,
then for every integer n,
NSE
 s(k)
j=1 f(xj) = n
with xj ∈Z
and |xj| ≤cP for j = 1, . . . , s(k)

≪k,c P s(k)−k.
Proof. Let c = c1 and fj(x) = f(x) for j = 1, . . . , s(k) in Theorem 12.3.
2
Theorem 11.9 Let f(x) = k
i=0 aixi be an integer-valued polynomial of
degree k with ak > 0 and gcd(A(f)) = 1. Then A(f)∪{0} is an asymptotic
basis of ﬁnite order, that is, for some h and every suﬃciently large integer n
there exists a positive integer hn ≤h and nonnegative integers x1, . . . , xhn
such that
f(x1) + · · · + f(xhn) = n.
Proof. Deﬁne N(f) by (11.7), and let s = s(k) be the integer constructed
in Theorem 11.8. Let W = sA(f) be the set consisting of all sums of s
integers of the form f(x) with x ∈N0. We shall prove that the sumset W
has lower asymptotic density dL(W) > 0.
Let W(N) be the counting function of W. Choose c ≥(2k!)1/k and choose
N ≥N(f) suﬃciently large that for P = N 1/k,
|ai| ≤cP k−i
for i = 0, 1, . . . , k.
Then 0 < ak ≤c. By Lemma 11.5, if x1, . . . , xs are nonnegative integers
such that s
j=1 f(xj) ≤N, then
0 ≤xj ≤(2k!N)1/k ≤cP
for j = 1, . . . , s.
We get upper bounds for rf,s(n) and Rf,s(N) as follows: If 0 ≤n ≤N,
then
rf,s(n)
=
NSE {f(x1) + · · · + f(xs) = n : xi ∈N0}
≤
NSE {f(x1) + · · · + f(xs) = n : |xj| ≤cP}
≪k,c
P s−k

11.4 Waring’s Problem for Polynomials
371
by Theorem 11.8, and so
Rf,s(N)
=

0≤n≤N
rf,s(n)
=

0≤n≤N
rf,s(n)≥1
rf,s(n)
≪k,c
W(N)P s−k
≪k,c
W(N)
N

P s.
We can apply Lemma 11.4 to obtain a lower bound for Rk,s(N). For N
suﬃciently large,
Rf,s(N) > 1
2
 2N
3aks
s/k
≥1
2
2N
3cs
s/k
≫k,c P s.
Therefore,
P s ≪k,c Rf,s(N) ≪k,c
W(N)
N

P s,
and so W(N)/N ≫k,c 1. It follows that
dL(sA(f)) = dL(W) > 0,
and the result follows immediately from Theorem 11.7. 2
Theorem 11.10 Let f(x) be an integer-valued polynomial of degree k with
leading coeﬃcient ak > 0. If 0, 1 ∈A(f) = {f(x) : x ∈N0}, then A(f) is
a basis of ﬁnite order.
Proof. This is a consequence of Theorem 11.9. 2
Theorem 11.11 (Waring–Hilbert) For every k ≥2, the set of nonneg-
ative kth powers is a basis of ﬁnite order.
Proof. This is the special case of Theorem 11.10 applied to the polyno-
mial f(x) = xk. 2
Theorem 11.12 Let f(x) be an integer-valued polynomial of degree k with
leading coeﬃcient ak > 0 and gcd(A(f)) = 1. Then A(f) ∪{0} is an
asymptotically stable asymptotic basis of ﬁnite order.

372
11. Waring’s Problem
Proof. This requires only minor modiﬁcations of the proof of Theo-
rem 11.9. Let A(f) = {f(i)}∞
i=0, and let B be a set of nonnegative integers
of lower asymptotic density dL(B) = β > 0. Then
AB = {f(b) : b ∈B}.
Let s = s(k) be the integer constructed in Theorem 11.8. The sumset
Ws = sAB consists of all sums of s integers of the form f(b) with b ∈B.
Let Ws(N) be the counting function of the sumset Ws. Let r(B)
f,s (n) denote
the number of solutions of the equation
f(b1) + · · · + f(bs) = n
with b1, . . . , bs ∈B, and let
R(B)
f,s (N) =
N

n=0
r(B)
f,s (n).
We shall again compute upper and lower bounds for R(B)
f,s (n).
Choose real numbers c ≥(2k!)1/k and N ≥N(f) such that for P = N 1/k,
|ai| ≤cP k−i
for i = 1, . . . , k.
By Theorem 11.8, we have the upper bound
R(B)
k,s (N)
=
N

n=0
r(B)
k,s (n)≥1
r(B)
k,s (n) ≤
N

n=0
r(B)
k,s (n)≥1
rk,s(n)
≪k,c
WB(N)P s−k
≪k,c
WB(N)
N

P s
for all suﬃciently large N.
To obtain a lower bound, we observe that the number of integers b ∈B
such that
x∗(f) < b ≤
 2N
3aks
1/k
(11.8)
is
B
 2N
3aks
1/k
−B(x∗(f)) ≥
β
2
  2N
3aks
1/k
−B(x∗(f)) ≫k,c P
for suﬃciently large N. By Lemma 11.4, if b ∈B satisﬁes inequality (11.8),
then
0 ≤f(b) ≤N
s ,

11.5 Notes
373
and so
R(B)
f,s (N) ≫k,c P s.
It follows that WB(N)/N ≫k,c 1, and so WB = sAB has positive lower
asymptotic density. The result now follows from Theorem 11.7. 2
Theorem 11.13 Let f(x) be an integer-valued polynomial of degree k with
leading coeﬃcient ak > 0. If 0, 1 ∈A(f) = {f(x) : x ∈N0}, then A(f) is
a stable basis of ﬁnite order.
Proof. This follows from Theorem 11.12. 2
Theorem 11.14 (Waring–Shnirel’man) For every k ≥2, the set of
nonnegative kth powers is a stable basis of ﬁnite order and an asymptotically
stable asymptotic basis of ﬁnite order.
Proof. This follows from Theorem 11.12. 2
Exercises
1. Prove that every multiple of 6 can be written as the sum of a bounded
number of integers of the form x(x −1)(x −2) with x ∈N0.
2. Prove that for every k ≥1 there is an integer h(k) such that every
positive integer can be written as the sum of at most h(k) kth powers
of odd numbers.
11.5
Notes
Nathanson’s Additive Number Theory: The Classical Bases [104] contains
proofs of Lagrange’s theorem that every number is the sum of four squares,
and Wieferich’s theorem that every number is the sum of nine cubes. A
proof of Lagrange’s theorem that depends on the geometry of numbers
appears in Nathanson [103]. Jacobi’s formula for the number of representa-
tions of an integer as the sum of four squares is Theorem 14.4 in Chapter 14
of this book.
In 1909 Hilbert [66] gave the ﬁrst proof of Waring’s problem for all expo-
nents k ≥2. Hardy and Littlewood [55, 56] developed a diﬀerent method
of proof and obtained an asymptotic formula for rk,s(n). Vinogradov [150]
simpliﬁed and improved the circle method of Hardy and Littlewood, and

374
11. Waring’s Problem
obtained new results on Waring’s problem. Nathanson’s book [104] gives
Hilbert’s proof of Waring’s problem and also a proof of the Hardy–Littlewood
asymptotic formula. Vaughan [148] is the standard reference on the circle
method.
This chapter contains Linnik’s elementary proof of Waring’s problem.
Linnik [93] published this proof in 1943. An exposition of Linnik’s proof
also appears in Khinchin [78]. Rieger [122] reﬁned Linnik’s method to obtain
an upper bound for the smallest integer g(k) such that every nonnegative
integer is the sum of g(k) kth powers. This upper bound is much larger
than the upper bound obtained by the circle method.
Kamke [76] proved Waring’s problem for polynomials. Nechaev [109] has
applied classical analytic techniques, that is, exponential sums and the
circle method, to Waring’s problem for polynomials. Kuzel’ [86] observed
that Linnik’s method for the classical Waring’s problem also applies to
Waring’s problem for polynomials.

12
Sums of Sequences of Polynomials
12.1
Sums and Diﬀerences of Weighted Sets
In this chapter we complete our study of Waring’s problem by Linnik’s
method. We shall derive a fundamental upper bound for the number of
representations of an integer as a sum of polynomials. In Chapter 11 we
applied a special case of this result to solve Waring’s problem for a single
polynomial. In Section 12.4 we shall use the full strength of this upper
bound to obtain a generalization of Waring’s problem to sequences of poly-
nomials.
We begin with the deﬁnition of a weighted set. A weighted set is a pair
(A, wA), where A is a set and wA is a function (called the weight function)
deﬁned on A. In this chapter weighted sets are always ﬁnite sets of integers,
and the range of the weight functions is the set of nonnegative integers, that
is, wA(a) ∈N0 for all a ∈A. Thus, we can think of a weighted set as a
set with multiplicities, that is, a set in which the element a occurs or is
counted wA(a) times.
There are natural ways to generate weighted sets. If (A, wA) is a weighted
set and A is a subset of A∗, then we can deﬁne the weighted set (A∗, wA∗)
by
wA∗(a) =

wA(a)
if a ∈A,
0
if a ∈A∗\ A.
(12.1)
Let (A1, wA1), . . . , (Ah, wAh) be weighted sets. The product set A1 ×
· · · × Ah consists of all htuples (a1, . . . , ah) with ai ∈Ai for i = 1, . . . , h.

376
12. Sums of Sequences of Polynomials
We deﬁne a weight function on the product set by
wA1×···×Ah(a1, . . . , ah) = wA1(a1) · · · wAh(ah).
Let f : A1 × · · · × Ah →B be a function deﬁned on the product set. We
deﬁne a weight function w(f)
B
on B as follows:
w(f)
B (b)
=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=b
wA1×···×Ah(a1, . . . , ah)
=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=b
wA1(a1) · · · wAh(ah).
We can think of w(f)
B (b) as counting the weighted number of solutions of
the equation f(a1, . . . , ah) = b.
For example, if A1, . . . , Ah are weighted sets of integers, then the sumset
S = A1 + · · · + Ah
is the image of the function σ(a1, . . . , ah) = a1 + · · · + ah deﬁned on the
weighted product set A1 × · · · × Ah. The weight of an element s ∈S is
w(σ)
S (s) =

(a1,...,ah)∈A1×···×Ah
a1+···+ah=s
wA1(a1) · · · wAh(ah).
If wAi(ai) = 1 for all i = 1, . . . , h and ai ∈Ai, then w(σ)
S (s) is simply the
number of representations of s in the form a1 + · · · + ah. Similarly, if we
deﬁne δ : A1 × A2 →A1 −A2 by δ(a1, a2) = a1 −a2, then the diﬀerence
set
D = A1 −A2 = {a1 −a2 : a1 ∈A1, a2 ∈A2}
is a weighted set of integers such that the weight of d ∈D is
w(δ)
D (d) =

(a1,a2)∈A1×A2
a1−a2=d
wA1(a1)wA2(a2).
Let NSE denote “the number of solutions of the equation.” If f is a
function from the product set A1 × · · · × Ah into a set B, then
NSE
 f(a1, . . . , ah) = b
with ai ∈Ai for i = 1, . . . , h

=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=b
1.
If (A1, wA1), . . . , (Ah, wAh) are weighted sets with wAi(ai) = 1 for all i =
1, . . . , h and ai ∈Ai, then
w(f)
B (b) = NSE
 f(a1, . . . , ah) = b
with ai ∈Ai for i = 1, . . . , h

.

12.1 Sums and Diﬀerences of Weighted Sets
377
If w∗
i is an upper bound for the weight function wAi, that is, if wAi(ai) ≤w∗
i
for all i = 1, . . . , h and ai ∈Ai, then
w(f)
B (b)
=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=b
wA1(a1) · · · wAh(ah)
≤

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=b
w∗
1 · · · w∗
h
=
w∗
1 · · · w∗
h NSE

f(a1, . . . , ah) = b
with ai ∈Ai for i = 1, . . . , h

.
For brevity, we shall often refer to the weighted set (A, wA) as the
weighted set A.
Let A1, A2, and A3 be weighted sets. We can form the weighted sumsets
S1 = A1 + A2 and S2 = A2 + A3, and from these the weighted sumsets
S1 +A3 and A1 +S2. We also have the weighted sumset S = A1 +A2 +A3.
By the associativity of set addition we have S = S1 +A3 = A1 +S2 as sets.
In fact, these sets are also equal as weighted sets, that is, for every s ∈S
we have
wS(s) = wS1+A3(s) = wA1+S2(s).
(12.2)
This is a special case of the following theorem, which shows that weights
constructed by composition of functions are well-deﬁned.
Theorem 12.1 For ℓ≥2, let h, r0, r1 . . . , rℓbe integers such that
0 = r0 < r1 < · · · < rℓ= h.
Let (A1, wA1), . . . , (Ah, wAh) be weighted sets and let B1, . . . , Bℓ, and C be
sets. For i = 1, . . . , ℓ, let
fi : Ari−1+1 × · · · × Ari →Bi
be a function deﬁned on the weighted product set Ari−1+1 × · · · × Ari. Then
fi induces a weight function w(fi)
Bi
on the set Bi, and these weight functions
determine a weight function on the product set B1 × · · · × Bℓ. Let
g : B1 × · · · × Bℓ→C
be a function deﬁned on the weighted product set B1 × · · · × Bℓ. Then g
induces a weight function w(g)
C
on C. Deﬁne the function
f : A1 × · · · × Ah →C
by
f(a1, . . . , ah)
=
g(f1(a1, . . . , ar1), f2(ar1+1, . . . , ar2), . . . , fℓ(arℓ−1+1, . . . , arℓ).

378
12. Sums of Sequences of Polynomials
Then f induces a weight function w(f)
C
on C. For all c ∈C we have
w(f)
C (c) = w(g)
C (c),
that is,

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=c
wA1×···×Ah(a1, . . . , ah)
=

(b1,...,bℓ)∈B1×···×Bℓ
g(b1,...,bℓ)=c
wB1×···×Bℓ(b1, . . . , bℓ).
Proof. This is a straightforward calculation. We have
w(g)
C (c)
=

(b1,...,bℓ)∈B1×···×Bℓ
g(b1,...,bℓ)=c
wB1×···×Bℓ(b1, · · · , bℓ)
=

(b1,...,bℓ)∈B1×···×Bℓ
g(b1,...,bℓ)=c
w(f1)
B1 (b1) · · · w(fℓ)
Bℓ(bℓ)
=

(b1,...,bℓ)∈B1×···×Bℓ
g(b1,...,bℓ)=c





(a1,...,ar1 )∈A1×···×Ar1
f1(a1,...,ar1 )=b1
r1

i=1
wAi(ai)



× · · ·
×






(arℓ−1+1,...,arℓ)∈Arℓ−1+1×···×Arℓ
fℓ(arℓ−1+1,...,arℓ)=bℓ
rℓ

i=rℓ−1+1
wAi(ai)





=

(b1,...,bℓ)∈B1×···×Bℓ
g(b1,...,bℓ)=c

(a1,...,ar1 )∈A1×···×Ar1
f1(a1,...,ar1 )=b1
· · ·

(arℓ−1+1,...,arℓ)∈Arℓ−1+1×···×Arℓ
fℓ(arℓ−1+1,...,arℓ)=bℓ
h

i=1
wAi(ai)
=

(a1,...,ah)∈A1×···×Ah
g(f1(a1,...,ar1 ),...,fℓ(arℓ−1+1,...,arℓ))=c
h

i=1
wAi(ai)
=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=c
h

i=1
wAi(ai)
=

(a1,...,ah)∈A1×···×Ah
f(a1,...,ah)=c
wA1×···×Ah(a1, . . . , ah)

12.1 Sums and Diﬀerences of Weighted Sets
379
=
w(f)
C (c).
This completes the proof. 2
Lemma 12.1 Let B1 and B2 be weighted sets of integers. Deﬁne the ad-
dition map σ : B1 × B2 →B1 + B2 by σ(b1, b2) = b1 + b2 and the diﬀerence
maps δi : Bi ×Bi →Bi −Bi by δi(bi, b′
i) = bi −b′
i for i = 1, 2. Consider the
weighted sumset S = B1+B2 and the weighted diﬀerence sets D1 = B1−B1
and D2 = B2 −B2. Then for all integers n,
w(σ)
S (n) ≤1
2

w(δ1)
D1 (0) + w(δ2)
D2 (0)

.
Proof. For i = 1, 2 we have
w(δi)
Di (0) =

(bi,b′
i)∈Bi×Bi
bi−b′
i=0
wBi(bi)wBi(b′
i) =

bi∈Bi
wBi(bi)2.
To each b1 ∈B1 there exists at most one b2 ∈B2 such that b1 + b2 = n.
Applying the elementary inequality
xy ≤1
2

x2 + y2
for x, y ∈R,
we obtain
w(σ)
S (n)
=

(b1,b2)∈B1×B2
b1+b2=n
wB1(b1)wB2(b2)
≤

(b1,b2)∈B1×B2
b1+b2=n
1
2

wB1(b1)2 + wB2(b2)2
≤
1
2
 
b1∈B1
wB1(b1)2 +

b2∈B2
wB2(b2)2

=
1
2

w(δ1)
D1 (0) + w(δ2)
D2 (0)

.
This completes the proof. 2
Lemma 12.2 For t ≥1, let B1, . . . , B2t be weighted sets of integers, and
let S be the weighted sumset
S = B1 + · · · + B2t

380
12. Sums of Sequences of Polynomials
with weight function determined by the addition map σ : B1 × · · · × B2t →
B1 + · · · + B2t. For i = 1, . . . , 2t, consider the weighted diﬀerence sets
Di = 2t−1Bi −2t−1Bi = 2t−1(Bi −Bi)
with weight functions deﬁned by the maps
δi : Bi × · · · × Bi →Di,
δi(bi,1, . . . , bi,2t) = (bi,1 + · · · + bi,2t−1) −(bi,2t−1+1 + · · · + bi,2t).
Then for all integers n,
w(σ)
S (n) ≤1
2t
2t

i=1
w(δi)
Di (0).
(12.3)
Let B be a weighted set with weighted sumset S = 2tB and weighted diﬀer-
ence set D = 2t−1B −2t−1B. Then
w(σ)
S (n) ≤w(δ)
D (0)
(12.4)
for all integers n ∈S.
Proof. The proof of (12.3) is by induction on t. The case t = 1 is
Lemma 12.1.
Let t ≥2, and assume that the lemma holds for t −1. Consider the
weighted sumsets
S1 = B1 + · · · + B2t−1
and
S2 = B2t−1+1 + · · · + B2t
with weights w(σ1)
S1
and w(σ2)
S2 , respectively, and the weighted diﬀerence sets
T1 = S1 −S1
and
T2 = S2 −S2
with weights w(∆1)
T1
and w(∆2)
T2
, respectively. Since
S = S1 + S2,
we can deﬁne an addition map σ′ : S1 × S2 →S. By Theorem 12.1,
w(σ)
S (s) = w(σ′)
S
(s)
for all s ∈S. (Indeed, Theorem 12.1 implies that all of the weight functions
constructed in this proof are well-deﬁned.)

12.1 Sums and Diﬀerences of Weighted Sets
381
By Lemma 12.1,
w(σ)
S (s) ≤1
2

w(∆1)
T1
(0) + w(∆2)
T2
(0)

for all s ∈S. For i = 1, . . . , 2t, we deﬁne the weighted diﬀerence sets
B′
i = Bi −Bi.
Then
T1
=
S1 −S1
=
(B1 + · · · + B2t−1) −(B1 + · · · + B2t−1)
=
(B1 −B1) + · · · + (B2t−1 −B2t−1)
=
B′
1 + · · · + B′
2t−1.
Similarly,
T2 = S2 −S2 = B′
2t−1+1 + · · · + B′
2t.
For i = 1, . . . , 2t, we deﬁne the weighted diﬀerence sets
D′
i = 2t−2B′
i −2t−2B′
i
with weight functions w(δ′
i)
D′
i . By induction, the lemma holds for sums of
2t−1 weighted sets. Therefore, we have
w(∆1)
T1
(0) ≤
1
2t−1
2t−1

i=1
w(δ′
i)
D′
i (0)
and
w(∆2)
T2
(0) ≤
1
2t−1
2t

i=2t−1+1
w(δ′
i)
D′
i (0),
and so
w(σ)
S (n) ≤1
2(w(∆1)
T1
(0) + w(∆2)
T2
(0)) = 1
2t
2t

i=1
w(δ′
i)
D′
i (0).
Since
D′
i
=
2t−2B′
i −2t−2B′
i
=
2t−2(Bi −Bi) −2t−2(Bi −Bi)
=
2t−1Bi −2t−1Bi
=
Di,
it follows that
w(σ)
S (n) ≤1
2t
2t

i=1
w(δi)
Di (0).
Inequality (12.4) follows immediately from (12.3). 2

382
12. Sums of Sequences of Polynomials
Exercises
1. Let A = {0, 1, 3, 4} be a weighted set with weight function wA(a) = 1
for all a ∈A. Compute the weight functions of the weighted sumset
2A and the weighted diﬀerence set A −A.
2. Let A = {0, 1, 3, 4} be a weighted set with weight function wA(a) = a
for all a ∈A. Compute the weight functions of the weighted sumset
2A and the weighted diﬀerence set A −A.
3. Let A = {1, 2, 3, 4, 5} be a weighted set with wA(a) = 1 for all a ∈A.
Deﬁne f : A →A by f(1) = f(2) = 3 and f(3) = f(4) = f(5) = 2.
Compute w(f)
A (a).
4. Let (A, wA) be a weighted set, let f : A →B be a function, and let
w(f)
B
be the weight function induced on B by f. Prove that

a∈A
wA(a) =

b∈B
w(f)
B (b).
5. Let A = {1, 2, 3, . . . , n} and let wA be a weight function on A. Let
Sn be the group of all permutations of A. If τ ∈Sn, then τ : A →A
induces a weight function w(τ)
A
on A. Prove that w(τ)
A (a) = wA(a) for
all τ ∈Sn and a ∈A if and only if wA is a constant function.
6. Prove that Theorem 12.1 implies equation (12.2).
7. Let A be a weighted set. Prove the weighted set identity
(A −A) −(A −A) = 2A −2A.
8. Let A be a set of integers of cardinality k. Prove that
|A + A| ≤k2 + k
2
and
|A −A| ≤k2 −k + 1.
For every positive integer k, construct a set A such that |A| = k,
|A + A| = (k2 + k)/2, and |A −A| = k2 −k + 1.
12.2
Linear and Quadratic Equations
In this section we obtain upper bounds for certain linear and quadratic
diophantine equations.

12.2 Linear and Quadratic Equations
383
Lemma 12.3 Let Q ≥1. Let u1, . . . , uk be relatively prime integers such
that
U = max{|u1|, . . . , |uk|} ≤Q.
For every integer m,
NSE

u1v1 + · · · + ukvk = m
with |v1|, . . . , |vk| ≤Q

≤(k −1)!(3Q)k−1
U
.
(12.5)
Equivalently, for i = 1, . . . , k we can deﬁne the weighted sets Ai = {v ∈
Z : |v| ≤Q} with weights wAi(v) = 1 for all v ∈Ai. Let B be the range
of the function f(v1, . . . , vk) = u1v1 + · · · + ukvk. The lemma asserts that
w(f)
B (m) ≤(k −1)!(3Q)k−1/U.
If we choose any k −1 numbers v1, . . . , vk−1, then there exists at most
one number vk that satisﬁes the equation u1v1 +· · ·+ukvk = m. This gives
the trivial upper bound (2Q + 1)k−1 ≤(3Q)k−1 for (12.5). A nontrivial
assertion of the lemma is the denominator U in Qk−1/U.
Proof. The proof is by induction on k. If k = 1, then gcd(u1) = 1 and
U = |u1| = 1. The number of solutions of the equation u1v1 = m with
|v1| ≤Q is at most
1 = 0!(3Q)0
U
.
Let k = 2 and U = max{|u1|, |u2|} = |u2|. If
u1v1 + u2v2 = m,
(12.6)
then
u1v1 ≡m
(mod U).
Since (u1, u2) = (u1, U) = 1, we have
v1 ≡u−1
1 m
(mod U).
The number of integers v1 in the congruence class u−1
1 m
(mod U) with
|v1| ≤Q is at most
2Q
U + 1 ≤3Q
U
(since U ≤Q).
For each such integer v1 there is at most one integer v2 that satisﬁes the
linear equation (12.6). Therefore,
NSE {u1v1 + u2v2 = m
with |v1|, |v2| ≤Q} ≤3Q
U .
Let k ≥3, and assume that the lemma holds for k −1. Let
U = max{u1, . . . , uk} = |uk|.

384
12. Sums of Sequences of Polynomials
If ui = 0 for i = 1, . . . , k −1, then 1 = (u1, . . . , uk−1, uk) = |uk| = U, and
the number of solutions of (12.5) is at most
(2Q + 1)k−1 ≤(3Q)k−1 ≤(k −1)!(3Q)k−1
U
.
If ui ̸= 0 for some i ≤k −1, then
d = (u1, . . . , uk−1) ≥1.
In this case, we deﬁne
u′
i = ui
d
for i = 1, . . . , k −1,
and
U ′ = max{|u′
1|, . . . , |u′
k−1|} ≤U
d .
Then (u′
1, . . . , u′
k−1) = 1. Consider the linear equation
u′
1v1 + · · · + u′
k−1vk−1 = m′.
(12.7)
By the induction hypothesis,
NSE

u1v1 + · · · + uk−1vk−1 = dm′
with |v1|, . . . , |vk−1| ≤Q

=
NSE {(12.7)
with |v1|, . . . , |vk−1| ≤Q}
≤
(k −2)!(3Q)k−2
U ′
.
If the integer m′ can be represented in the form (12.7) with |vi| ≤Q, then
|m′| ≤(k −1)U ′Q.
Since (d, uk) = (u1, . . . , uk−1, uk) = 1 and max{d, |uk|} = |uk| = U, it
follows that
NSE
 u1v1 + · · · + ukvk = m
with |v1|, . . . , |vk| ≤Q

≤
NSE

u1v1 + · · · + uk−1vk−1 = dm′
with |v1|, . . . , |vk−1| ≤Q

× NSE
 dm′ + ukvk = m
with
|m′|, |vk| ≤(k −1)U ′Q

≤
(k −2)!(3Q)k−2
U ′
× 3(k −1)U ′Q
U
=
(k −1)!(3Q)k−1
U
.
This completes the proof. 2

12.2 Linear and Quadratic Equations
385
Theorem 12.2 Let k ≥3 and let P, Q, and c be real numbers such that
1 ≤P ≤Q ≤cP k−1.
Consider the quadratic equation
u1v1 + · · · + ukvk = 0
(12.8)
in 2k variables u1, . . . , uk, v1, . . . , vk. Then
NSE



u1v1 + · · · + ukvk = 0
with |ui| ≤P and |vi| ≤Q
for i = 1, . . . k


≪k,c (PQ)k−1.
Proof. If u1 = · · · = uk = 0, then the number of solutions of (12.8) with
|vi| ≤Q is at most
(2Q + 1)k
≤
(3Q)k = 3Q(3Q)k−1
≤
3cP k−1(3Q)k−1 = 3kc(PQ)k−1
≪k,c
(PQ)k−1.
Suppose that ui ̸= 0 for some i. Then
1 ≤U = max{|u1|, . . . , |uk|} ≤P.
There exists a unique nonnegative integer m such that
P
2m+1 < U ≤P
2m .
(12.9)
The number of equations of the form (12.8) with |ui| ≤U ≤P/2m does
not exceed
2P
2m + 1
k
≤
3P
2m
k
.
If
(u1, . . . , uk) = 1,
then by Lemma 12.3, the number of solutions of each such equation with
|vi| ≤Q is at most
(k −1)!(3Q)k−1
U
< (k −1)!2m+1(3Q)k−1
P
.
Therefore, the number of solutions of all equations (12.8) with (u1, . . . , uk) =
1 and U in the interval (12.9) is less than
(k −1)!2m+1(3Q)k−1
P
3P
2m
k
= 6(k −1)!(9PQ)k−1
2(k−1)m
.

386
12. Sums of Sequences of Polynomials
Summing over m, we obtain
NSE



u1v1 + · · · + ukvk = 0
with |ui| ≤P, |vi| ≤Q,
and (u1, . . . , uk) = 1



<
∞

m=0
6(k −1)!(9PQ)k−1
2(k−1)m
≤
8(k −1)!(9PQ)k−1.
If (u1, . . . , uk) = d, we deﬁne u′
i = ui/d for i = 1, . . . , k. The integers
u′
1, . . . , u′
k are relatively prime, and |u′
i| ≤P/d. The integers v1, . . . , vk are
a solution of equation (12.8) with |ui| ≤P if and only if (v1, . . . , vk) is a
solution of the equation
u′
1v1 + · · · + u′
kvk = 0
with |u′
i| ≤P/d.
Therefore,
NSE



u1v1 + · · · + ukvk = 0
with |ui| ≤P, |vi| ≤Q,
and (u1, . . . , uk) = d



<
8(k −1)!

9
P
d

Q
k−1
=
8(k −1)!(9PQ)k−1
dk−1
.
For k ≥3 we have
∞

d=1
1
dk−1 < 1 +
# ∞
1
dx
xk−1 = k −1
k −2 ≤2.
Summing over d, we obtain
NSE



u1v1 + · · · + ukvk = 0
with |ui| ≤P, |vi| ≤Q,
and ui ̸= 0 for some i



<
∞

d=1
8(k −1)!(9PQ)k−1
dk−1
≤
16(k −1)!(9PQ)k−1.
Therefore,
NSE
 u1v1 + · · · + ukvk = 0
with |ui| ≤P and |vi| ≤Q

<
3kc(PQ)k−1 + 16(k −1)!(9PQ)k−1
≪k,c
(PQ)k−1.
This completes the proof. 2

12.3 An Upper Bound for Representations
387
Exercises
1. Find all solutions of the linear diophantine equation
6v1 + 10v2 + 15v3 = 0
with |v1|, |v2|, |v3| ≤10.
Compare the number of solutions with the upper bound obtained
from Lemma 12.3.
2. Find all solutions of the linear diophantine equation
6v1 + 10v2 + 15v3 = 1
with |v1|, |v2|, |v3| ≤10.
3. Find all solutions of the quadratic equation
u1v1 + u2v2 + u3v3 = 0
with |ui| ≤1 and |vi| ≤1 for i = 1, 2, 3. Compare the number of
solutions with the upper bound obtained from Theorem 12.2.
12.3
An Upper Bound for Representations
We can now prove Theorem 12.3, which gives the fundamental upper bound
for the number of representations of an integer as the sum of a bounded
number of values of polynomials of degree k. We need the following standard
result about polynomials.
Lemma 12.4 Let
f(x) =
k

i=0
aixi
be a polynomial of degree k with complex coeﬃcients. Then
f(x + u) −f(x) = ugu(x),
where
gu(x) =
k−1

i=0
a′
i(u)xi
is a polynomial of degree k −1 with coeﬃcients
a′
i(u) =
k

j=i+1
j
i

ajuj−i−1.
For any positive number P, if
|x|
≤
c1P,
|u|
≤
2c1P,

388
12. Sums of Sequences of Polynomials
and
|ai| ≤cP k−i
for i = 0, 1, . . . , k,
then
|a′
i(u)| ≤c(4c1)kkP k−1−i
for i = 0, 1, . . . , k −1
and
|gu(x)| ≤c(2c1)2kk2P k−1
(12.10)
Proof. This is a purely formal calculation. We have
f(x + u) −f(x)
=
k

j=0
aj(x + u)j −
k

j=0
ajxj
=
k

j=1
aj
j−1

i=0
j
i

xiuj−i
=
u
k−1

i=0


k

j=i+1
j
i

ajuj−i−1

xi
=
ugu(x).
If |ai| ≤cP k−i and |u| ≤2c1P, then
|a′
i(u)|
≤
k

j=i+1
j
i

|aj||u|j−i−1 ≤
k

j=i+1
2jcP k−j(2c1P)j−i−1
≤
c(4c1)kkP k−1−i.
If also |x| ≤c1P, then
|gu(x)|
≤
k−1

i=0
|a′
i(u)||x|i
≤
k−1

i=0
c(4c1)kkP k−1−i(c1P)i
≤
c(2c1)2kk2P k−1.
This completes the proof. 2
Theorem 12.3 Let {s(k)}∞
k=1 be the sequence of integers deﬁned recur-
sively by s(1) = 1 and
s(k) = 8k2[log2 s(k−1)]
for k ≥2.
(12.11)

12.3 An Upper Bound for Representations
389
Let c ≥1. For j = 1, . . . , s(k), let
fj(x) =
k

i=0
aijxi
be a sequence of polynomials with complex coeﬃcients such that
|akj| ≤c
for j = 1, . . . , s(k).
Choose P ≥1 such that
|aij| ≤cP k−i
for i = 0, 1, . . . , k −1 and j = 1, . . . , s(k).
(12.12)
Let c1 ≥1. For every complex number z,
NSE
 s(k)
j=1 fj(xj) = z
with xj ∈Z
and |xj| ≤c1P for j = 1, . . . , s(k)

≪k,c,c1 P s(k)−k.
(12.13)
Proof. The proof is by induction on the degree k of the polynomials.
For k = 1 we have s(1) = 1 and f1(x) = a11x + a01. For any number z,
there exists at most one integer x1 such that f1(x1) = z, and so
NSE

f1(x1) = z
with x1 ∈Z
and |x1| ≤c1P

≤1 = P s(1)−1.
Let k ≥2, and assume that the theorem holds for s′ = s(k −1) polyno-
mials of degree k −1. Deﬁne
t = t(k) = [log2 s′] + 2
and
s = s(k) = 2k2t = 8k2[log2 s(k−1)].
Since [x] ≤x < [x] + 1 for every real number x, we have
s′ = 2log2 s′ < 2[log2 s′]+1 = 2t−1.
Consider the weighted set (X, wX)), where
X = {x ∈Z : |x| ≤c1P}
and wX(x) = 1 for all x ∈X. For j = 1, . . . , s we have the weighted sets
Fj = {fj(x) : x ∈X} = {fj(x) : |x| ≤c1P}
with weights
w(fj)
Fj (z) = NSE {fj(x) = z : |x| ≤c1P}.

390
12. Sums of Sequences of Polynomials
Let S be the weighted sumset
S = F1 + · · · + Fs.
Then
wS(z) = NSE



s

j=1
fj(xj) = z
with |xj| ≤c1P


.
For
m = s
2 = k2t,
we consider the weighted sumsets
B1 = F1 + · · · + Fm
and
B2 = Fm+1 + · · · + F2m,
and the weighted diﬀerence sets
D1 = B1 −B1 =



m

j=1
(fj(yj) −fj(xj)) : |xj|, |yj| ≤c1P



and
D2 = B2 −B2 =



2m

j=m+1
(fj(yj) −fj(xj)) : |xj|, |yj| ≤c1P


.
Applying Lemma 12.1 to S = B1 + B2, we obtain
wS(z) ≤1
2 (wD1(0) + wD2(0)) .
For j = 1, . . . , s, let
fj(x + u) −fj(x) = ugj,u(x),
where gj,u(x) is the polynomial of degree k −1 constructed in Lemma 12.4.
We can use our result on quadratic equations and weighted sets (Theo-
rem 12.2) to obtain upper bounds for the weights wD1(0) and wD2(0). If
|xj|, |yj| ≤c1P and uj = yj −xj, then |uj| ≤|xj| + |yj| ≤2c1P. It follows
that
wD1(0)
=
NSE
 m
j=1(fj(yj) −fj(xj)) = 0
with |xj|, |yj| ≤c1P

≤
NSE
 m
j=1(fj(xj + uj) −fj(xj)) = 0
with |xj| ≤c1P and |uj| ≤2c1P

=
NSE
 m
j=1 ujgj,uj(xj) = 0
with |xj| ≤c1P and |uj| ≤2c1P

=

|u1|,...,|um|≤2c1P
NSE
 m
j=1 ujgj,uj(xj) = 0
with
|xj| ≤c1P for j = 1, . . . , m

.

12.3 An Upper Bound for Representations
391
Similarly,
wD2(0) ≤

|um+1|,...,|u2m|≤2c1P
NSE
 2m
j=m+1 ujgj,uj(xj) = 0
with
|xj| ≤c1P for j = m + 1, . . . , 2m

.
For j = 1, . . . , m, we ﬁx integers uj with |uj| ≤2c1P, and consider the
weighted sets
Gj = {gj,uj(x) : |x| ≤c1P}
and
G′
j = uj ∗{gj,uj(x) : |x| ≤c1P} = {ujgj,uj(x) : |x| ≤c1P},
with weights
wGj(z) = wG′
j(ujz) = NSE {gj,uj(x) = z : |x| ≤c1P}.
Recall that m = k2t. For q = 1, . . . , 2t, we deﬁne the weighted sets
B′
q
=
G′
(q−1)k+1 + G′
(q−1)k+2 + · · · + G′
qk,
D′
q
=
2t−1B′
q −2t−1B′
q,
and
S′
1 =
m

j=1
G′
j =
2t

q=1
B′
q.
Then
wS′
1(0) = NSE



m

j=1
ujgj,uj(xj) = 0
with |xj| ≤c1P


.
By Lemma 12.2,
wS′
1(0) ≤1
2t
2t

q=1
wD′
q(0).
We can express the diﬀerence set D′
q as follows:
D′
q
=
2t−1B′
q −2t−1B′
q
=
2t−1
k

r=1
G′
(q−1)k+r −2t−1
k

r=1
G′
(q−1)k+r
=
k

r=1
u(q−1)k+r ∗

2t−1G(q−1)k+r −2t−1G(q−1)k+r

=
k

r=1
u(q−1)k+r ∗V(q−1)k+r,

392
12. Sums of Sequences of Polynomials
where
V(q−1)k+r = 2t−1G(q−1)k+r −2t−1G(q−1)k+r.
Let v ∈V(q−1)k+r. By Lemma 12.4, if |x| ≤c1P, then
|g(q−1)k+r,u(q−1)k+r(x)| ≤c(2c1)2kk2P k−1,
and so
|v| ≤c(2c1)2kk22tP k−1.
(12.14)
We shall use the induction hypothesis for polynomials of degree k −1 to
obtain an upper bound for the weight of v. Let
gu(x) = g(q−1)k+r,u(q−1)k+r(x) =
k−1

i=0
a′
i(u)xi.
By Lemma 12.4, we have
|a′
i(u)| ≤c(4c1)kkP k−1−i
for i = 0, 1, . . . , k −1. Since s′ = s(k −1), for every number z′ we have
NSE
* s′
j=1 g(xj) = z′
with |xj| ≤c1P for j = 1, . . . , s′
7
≪k,c,c1 P s′−k+1.
Since s′ < 2t−1, we obtain the following upper bound for the weight of v:
wV(q−1)k+r(v) = NSE
*
v = 2t−1
q=1 gu(xq) −2t−1
q=1 gu(x′
q)
with |xq|, |x′
q| ≤c1P for q = 1, . . . , 2t−1
7
=
NSE





s′
q=1 gu(xq) =
v + 2t−1
q=1 gu(x′
q) −2t−1
q=s′+1 gu(xq)
with |xq|, |x′
q| ≤c1P for q = 1, . . . , 2t−1





=

|x′
1|,...,|x′
2t−1 |,
|xs′+1|,...,|x2t−1 |≤c1P
NSE





s′
q=1 gu(xq) = v+
2t−1
q=1 gu(x′
q) −2t−1
q=s′+1 gu(xq)
with |xq| ≤c1P for q = 1, . . . , s′





≪k,c,c1

|x′
1|,...,|x′
2t−1 |,
|xs′+1|,...,|x2t−1 |≤c1P
P s′−(k−1)
≪k,c,c1
P 2t−s′P s′−k+1
≪k,c,c1
P 2t−k+1.
Therefore, there exists a constant c′ = c(k, c, c1) such that wVj(v) ≤
c′P 2t−k+1 for all j = 1, . . . , m and v ∈Vj.

12.3 An Upper Bound for Representations
393
Let U be the weighted set of all integers u such that |u| ≤2c1P and
wU(u) = 1 for all u ∈U. Let V be the weighted set of all integers v that
satisfy inequality (12.14) and have constant weight wV (v) = cP 2t−k+1. We
can now ﬁnd an upper bound for the weights wD1(0) and wD2(0):
wD1(0) ≤

|u1|,...,|um|≤2c1P
wS′
1(0)
≤

|u1|,...,|um|≤2c1P
1
2t
2t

q=1
wD′
q(0)
≤

|u1|,...,|um|≤2c1P
1
2t
×
2t

q=1

c′P 2t−k+1k
NSE
 k
r=1 u(q−1)k+rv(q−1)k+r = 0
with v(q−1)k+r ∈V(q−1)k+r

≪k,c.c1
P m−k2+k
2t
×
2t

q=1

u1,...,um∈U
NSE
 k
r=1 u(q−1)k+rv(q−1)k+r = 0
with v(q−1)k+r ∈V

=
P m−k2+k
2t
×
2t

q=1

u1,...,u(q−1)k,
uqk+1,...,um∈U
NSE



k
r=1 u(q−1)k+rv(q−1)k+r = 0
with v(q−1)k+r ∈V and
u(q−1)k+1, . . . , uqk ∈U



≪k,c,c1
P m−k2+kP m−k
2t
×
2t

q=1
NSE



k
r=1 u(q−1)k+rv(q−1)k+r = 0
with v(q−1)k+r ∈V(q−1)k+r and
u(q−1)k+1, . . . , uqk ∈U



≪k,c,c1
P s−k2NSE
 k
r=1 urvr = 0
with vr ∈V and ur ∈U

≪k,cc1
P s−k2(P k)k−1
(by Theorem 12.2)
≪k,c,c1
P s−k.
Similarly,
wD2(0) ≪k,c,c1 P s−k.
Therefore,
wS(n) ≤1
2(wD1(0) + wD2(0)) ≪k,c,c1 P s−k.

394
12. Sums of Sequences of Polynomials
This completes the proof. 2
Exercises
1. Compute s(k) for k = 1, 2, 3, 4, 5.
2. Prove that
4k−1k! < s(k) ≤8k−1k!
for k ≥2.
12.4
Waring’s Problem for Sequences of
Polynomials
In Chapter 11 we applied a special case of Theorem 12.3 to prove Waring’s
problem for a polynomial. In this section we show how the full strength
of Theorem 12.3 yields a generalization of Waring’s problem to ﬁnite se-
quences of polynomials. Let c ≥1. For j = 1, . . . , s, let fj(x) be an integer-
valued polynomial of degree k whose leading coeﬃcient akj satisﬁes the
inequality 0 < akj ≤c. We consider the sequence
F = {fj(x)}s
j=1.
We shall prove that there exist integers s(k) and h(k) and a positive number
δ(k, c) such that if s ≥s(k), then the set
S = {f1(x1) + · · · + fs(xs) : x1, . . . , xs ∈N0}
has lower asymptotic density dL(S) ≥δ(k, c) > 0, and if s ≥h(k), then S
is eventually coincides with a union of congruence classes.
We deﬁne the representation functions rF(n) and RF(N) by
rF(n) = NSE
 f1(x1) + · · · + fs(xs) = n
with x1, . . . , xs ∈N0

and
RF(N) =

0≤n≤N
rF(n).
Lemma 12.5 Let c ≥1. Let F = {fj(x)}s
j=1 be a sequence of integer-
valued polynomials of degree k, and let akj be the leading coeﬃcient of
fj(x). We assume that
0 < akj ≤c

12.4 Waring’s Problem for Sequences of Polynomials
395
for j = 1, . . . , s. If N is suﬃciently large, then
RF(N) > 1
2
2N
3cs
s/k
.
(12.15)
Proof. Deﬁne x∗(fj) by (11.4) for j = 1, . . . , s. If the integers xj satisfy
the inequalities
x∗(fj) ≤xj ≤
2N
3cs
1/k
,
then, by Lemma 11.4,
0 ≤fj(xj) ≤3akjxk
j
2
≤3c
2
2N
3cs

= N
s
and
0 ≤f1(x1) + · · · + fs(xs) ≤N.
Therefore,
RF(N) >
2N
3cs
1/k
−x∗(f) −1
s
≥1
2
2N
3cs
s/k
for N suﬃciently large. This proves (12.15). 2
Lemma 12.6 Let F = {fj(x)}s
j=1 be a sequence of integer-valued polyno-
mials of degree k, and let akj be the leading coeﬃcient of fj(x). Let c ≥1.
We assume that
0 < akj ≤c
and that A(fj) = {fj(x) : x ∈N0} is a strictly increasing sequence of
nonnegative integers for j = 1, . . . , s. There exists a number N1(F) such
that if N ≥N1(F) and x1, . . . , xs are nonnegative integers with
s

j=1
f(xj) ≤N,
then
xj ≤(4k!N)1/k
for j = 1, . . . , s.
Proof. The proof is the same as the proof of Lemma 11.5. Recall that
k!akj ≥1 by Exercise 6 in Section 11.1. Deﬁne x∗(fj) by (11.4) for j =
1, . . . , s, and x∗(F) = max{x∗(f1), . . . , x∗(fs)}. Let
N1(F) = x∗(F)k
2k!
.
(12.16)

396
12. Sums of Sequences of Polynomials
If N ≥N1(F), 1 ≤ℓ≤s, and xℓ> (2k!N)1/k ≥x∗(F) ≥x∗(fℓ), then
fℓ(xℓ) ≥akℓxk
ℓ
2
> k!akN ≥N,
and so
s

j=1
f(xj) ≥f(xℓ) ≥f(xℓ) > N.
It follows that if x1, . . . , xs are nonnegative integers such that
s

j=1
f(xj) ≤N,
then
xj ≤(2k!N)1/k
for j = 1, . . . , s.
This completes the proof. 2
Theorem 12.4 For any positive integer k and real number c ≥1, there
exists a number δ(k, c) > 0 with the following property: If s = s(k) is the
integer deﬁned by (12.11), and if F = {fj(x)}s
j=1 is a sequence of integer-
valued polynomials of degree k whose leading coeﬃcients akj satisfy
0 < akj ≤c,
then the sumset
B = {f1(x1) + · · · + fs(xs) : x1, . . . , xs ∈N0}
has lower asymptotic density
dL(B) ≥δ(k, c) > 0.
Proof. Replacing the polynomial fj(x) with fj(x + x0) for a suﬃciently
large integer x0, we can assume that {fj(x) : x ∈N0} is a strictly increasing
sequence of nonnegative integers for j = 1, . . . , s.
Deﬁne N1(F) by (12.16). Choose N2(F) suﬃciently large that for N ≥
N2(F) and P = N 1/k, we have
|aij| ≤cP k−i
for i = 0, 1, . . . , k −1,
and so Theorem 12.3 applies to the polynomials in the sequence F.
Let N(F) = max{N1(F), N2(F)) and c1 = (2k!)1/k. By Lemma 12.6, if
N ≥N(F) and x1, . . . , xs are nonnegative integers such that
f1(x1) + · · · + fs(xs) ≤N,

12.4 Waring’s Problem for Sequences of Polynomials
397
then xj ≤c1P for j = 1, . . . , s. Therefore, if 0 ≤n ≤N, then
rF(n)
=
NSE

f1(x1) + · · · + fs(xs) = n
with xj ∈N0 for j = 1, . . . , s(k)

=
NSE

f1(x1) + · · · + fs(xs) = n
with 0 ≤xj ≤c1P for j = 1, . . . , s(k)

≪k,c
P s−k
by Theorem 12.3. Let B(n) be the counting function of the set B. We have
RF(N)
=
N

n=0
rF(n) =
N

n=0
n∈B
rF(n)
≪k,c
B(N)P s−k = B(N)P s
N
.
By Lemma 12.5,
RF(N) > 1
2
 2
3cs
s/k
P s.
It follows that B(N)/N ≫k,c 1. This completes the proof. 2
We say that sets of integers A and B eventually coincide if there exists
a number n0 such that n ∈A if and only if n ∈B for all n ≥n0. By
Theorem 12.4, the set of sums of s(k) integer-valued polynomials of degree
k has positive lower asymptotic density, but not necessarily a rich arith-
metic structure. For example, sets of positive density can have arbitrarily
large gaps between consecutive elements. We shall prove that there exists
a number h = h(k, c) such that the set of sums of h(k, c) integer-valued
polynomials of degree k with positive leading coeﬃcients not exceeding c
has bounded gaps, and, moreover, eventually coincides with a union of con-
gruence classes. The proof of this result requires a deus ex machina in the
form of a theorem of Kneser on the asymptotic density of sumsets. We do
not prove Kneser’s theorem in this book, but this application of Kneser’s
theorem gives a generalization of Waring’s problem that is too beautiful to
resist.
For i = 1, . . . , d, let Bi be a set of integers with lower asymptotic density
dL(Bi) = βi, and let S = B1 + · · · + Bd. Kneser’s theorem states that if
dL(S) < β1 +· · ·+βd, then there is a modulus m ≥1 such that the sumset
S eventually coincides with a union of congruence classes modulo m.
Theorem 12.5 Let k be a positive integer and c ≥1. There exists a posi-
tive integer h = h(k, c) with the following property: Let F = {fj(x)}h
j=1 be
a sequence of integer-valued polynomials of degree k such that the leading

398
12. Sums of Sequences of Polynomials
coeﬃcient akj of fj(x) satisﬁes the inequality 0 < akj ≤c for j = 1, . . . , h.
There exists a positive integer m such that the sumset
S = {f1(x1) + · · · + fh(xh) : xj ∈N0
for j = 1, . . . , h}
eventually coincides with a union of congruence classes modulo m.
Proof. Let s = s(k) be the positive integer constructed in Theorem 12.3
and let δ = δ(k, c) be the positive number constructed in Theorem 12.4.
We deﬁne
d =
1
δ

+ 1
and
h = h(k, c) = ds.
Let F = {fj(x)}h
j=1 be a sequence of integer-valued polynomials of degree
k whose leading coeﬃcients are positive and not greater than c. For i =
1, . . . , d, let Fi = {f(i−1)s+j(x)}s
j=1. By Theorem 12.4, the sumset
Bi =



s

j=1
f(i−1)s+j(xj) : xj ∈N0



has lower asymptotic density dL(Bi) ≥δ > 0. Since
S = B1 + · · · + Bd =



h

j=1
fj(xj) : xj ∈N0



and
d

i=1
dL(Bi) ≥δd = δ
1
δ

+ 1

> 1 ≥dL(S),
Kneser’s theorem implies that S eventually coincides with a union of con-
gruence classes modulo m for some positive integer m. 2
12.5
Notes
This proof, so exquisitely elementary, will undoubtedly seem
very complicated to you. But it will take you only two to three
weeks’ work with pencil and paper to understand and digest it
completely. It is by conquering diﬃculties of just this sort, that
the mathematician grows and develops.

12.5 Notes
399
A. Ya. Khinchin [78]
The proof to which Khinchin refers is Linnik’s elementary proof of War-
ing’s problem. It is the “third pearl” in Khinchin’s famous book Three
Pearls of Number Theory [78]. The quotation is the last paragraph in the
book.
Theorem 12.3 generalizes a result of Linnik for sums of one polynomial
to sums of a sequence of polynomials. Linnik’s result provides the essential
upper bound in his solution of Waring’s problem.
Often, theorems in number theory and, in particular, variants of Waring’s
problem, are ﬁrst proved analytically, and only later are elementary proofs
discovered. Theorem 12.4, due to Nathanson, is an unusual example of a
result that was ﬁrst proved by elementary methods.
For a proof of Kneser’s theorem [79] on the asymptotic density of sumsets,
see Halberstam and Roth [48] and Nathanson [108].

13
Liouville’s Identity
13.1
A Miraculous Formula
In a series of eighteen papers published between 1858 and 1865, Liouville
introduced a strange and powerful method into elementary number theory.
In this chapter we prove an important identity of Liouville. We shall apply
it in Chapter 14 to obtain theorems about the number of representations
of an integer as a sum of an even number of squares. This is our second
problem in additive number theory.
Recall that a function f(x) is called even if f(−x) = f(x) for all x. A
function f(x) is called odd if f(−x) = −f(x) for all x. If f(x) is odd, then
f(0) = −f(0), and so f(0) = 0.
The function F(x, y, z) is odd in the variable x if F(−x, y, z) = −F(x, y, z),
and even in the pair of variables (y, z) if F(x, −y, −z) = F(x, y, z). If
F(x, y, z) is odd in the variable y and also odd in the variable z, then
F(x, y, z) is even in the pair of variables (y, z). For example, the function
F(x, y, z) = xyz is odd in the variable x and even in the pair of variables
(y, z).
In this and the following chapter, u, v, and w denote integers, and d, δ,
and ℓdenote positive integers. The notation

u2+dδ=n

402
13. Liouville’s Identity
means the sum over all ordered triples (u, d, δ) such that u2 + dδ = n. For
example,

u2+dδ=3
G(u, d, δ)
=
G(0, 1, 3) + G(0, 3, 1) + G(1, 1, 2)
+ G(1, 2, 1) + G(−1, 1, 2) + G(−1, 2, 1).
We deﬁne the symbol {T(ℓ)}n=ℓ2 as follows:
{T(ℓ)}n=ℓ2 =

0
if n is not a square,
T(ℓ)
if n is a square and n = ℓ2.
Liouville’s fundamental identity is the following.
Theorem 13.1 (Liouville) Let F(x, y, z) be a function deﬁned on the set
of all triples (x, y, z) of integers such that F(x, y, z) is odd in the variable
x and even in the pair of variables (y, z). For every positive integer n,
2

u2+dδ=n
F(δ −2u, u + d, 2u + 2d −δ)
=

u2+dδ=n
F(d + δ, u, d −δ) + {2T1(ℓ) −T2(ℓ)}n=ℓ2,
where
T1(ℓ) =
2ℓ−1

j=1
F(j, ℓ, j)
and
T2(ℓ) =
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j).
For example, there are six triples (u, d, δ) such that u2+dδ = 3. Liouville’s
formula for n = 3 asserts that
2(F(3, 1, −1) + F(1, 3, 5) + F(0, 2, 2) + F(−1, 3, 5) + F(4, 0, −2) + F(3, 1, 1))
=
F(4, 0, 2) + F(4, 0, −2) + F(3, 1, 1) + F(3, 1, −1) + F(3, −1, 1)
+ F(3, −1, −1).
It is easy to check this identity using only the parity properties of the
function F(x, y, z).
We shall prove Theorem 13.1 in Section 13.4.
Liouville’s identity is very general, and we can specialize it in many ways.
Here is an example.
Theorem 13.2 Let f(y) be an odd function. For every positive integer n,

u2+dδ=n
δ≡1
(mod 2)
(−1)uf(u + d) =

(−1)ℓ−1ℓf(ℓ)

n=ℓ2 .

13.1 A Miraculous Formula
403
Proof. We deﬁne the function
F(x, y, z) =
 0
if x or z is even,
(−1)(x+z)/2f(y)
if x and z are odd.
Then F(x, y, z) is an odd function of each of the variables x, y, and z, hence
an even function of the pair of variables (y, z). If x, y, z are integers and δ
is even, then δ −2x is even, and so F(δ −2x, y, z) = 0.
We shall apply Theorem 13.1 to the function F(x, y, z). The left side of
Liouville’s identity is
2

u2+dδ=n
F(δ −2u, u + d, 2u + 2d −δ)
=
2

u2+dδ=n
δ≡1
(mod 2)
F(δ −2u, u + d, 2u + 2d −δ)
=
2

u2+dδ=n
δ≡1
(mod 2)
(−1)df(u + d)
=
2

u2+dδ=n
δ≡1
(mod 2)
(−1)dδf(u + d)
=
2

u2+dδ=n
δ≡1
(mod 2)
(−1)n−u2f(u + d)
=
2(−1)n

u2+dδ=n
δ≡1
(mod 2)
(−1)uf(u + d).
The right side of Liouville’s identity is

u2+dδ=n
F(d + δ, u, d −δ) + {2T1(ℓ) −T2(ℓ)}n=ℓ2.
If u2 + dδ = n, then also (−u)2 + dδ = n, and the map
(u, d, δ) →(−u, d, δ)
(13.1)
is an involution1 on the set of solutions of the equation u2 + dδ = n. Then

u2+dδ=n
F(d + δ, u, d −δ)
=

u2+dδ=n
F(d + δ, −u, d −δ)
=
−

u2+dδ=n
F(d + δ, u, d −δ),
1An involution on a set X is a map α : X →X such that α2 is the identity map.

404
13. Liouville’s Identity
since F(x, y, z) is an odd function of y. Therefore,

u2+dδ=n
F(d + δ, u, d −δ) = 0.
If n = ℓ2, then
T1(ℓ)
=
2ℓ−1

j=1
F(j, ℓ, j) =

1≤j≤2ℓ−1
j≡1
(mod 2)
F(j, ℓ, j)
=
ℓ

i=1
F(2i −1, ℓ, 2i −1) = −
ℓ

j=1
f(ℓ)
=
−ℓf(ℓ)
and
T2(ℓ) =
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j) = 0.
Therefore,
2

u2+dδ=n
δ≡1
(mod 2)
(−1)uf(u + d)
=
(−1)n{−ℓf(ℓ)}n=ℓ2
=
{(−1)ℓ−1ℓf(ℓ)}n=ℓ2.
This completes the proof.
Exercises
1. Let F(x, y, z) be a function that is odd in x and even in (y, z). Write
out Liouville’s formula in the case n = 4, and conﬁrm it directly using
only the parity properties of F(x, y, z).
2. Prove that for every positive integer n the diophantine equation
u2 + vw = n
has inﬁnitely many solutions in integers u, v, w, but only ﬁnitely many
solutions in integers with v ≥1 and w ≥1.
13.2
Prime Numbers and Quadratic Forms
A quadratic form is a homogeneous polynomial of degree two. The quadratic
form Q(x, y, . . . , z) represents the integer n if there exist integers a, b, . . . , c

13.2 Prime Numbers and Quadratic Forms
405
such that Q(a, b, . . . , c) = n. A binary quadratic form is a quadratic form in
two variables. A ternary quadratic form is a quadratic form in three vari-
ables. In this section we apply Theorem 13.2 to obtain classical theorems
about the representation of prime numbers by the binary quadratic forms
x2 + y2 and x2 + 2y2.
We begin with some results about divisors. Recall that a positive integer
d is called a divisor of the positive integer n if there exists an integer δ
such that n = dδ. The integer δ is called the conjugate divisor of d. The
divisor function σ(n) is the sum of the divisors of n, that is, the arithmetic
function deﬁned by
σ(n) =

d|n
d.
We denote by σ∗(n) the sum of the divisors of n whose conjugate divisors
are odd. For example, σ(10) = 1+2+5+10 = 17 and σ∗(10) = 2+10 = 12.
If p is an odd prime, then σ(p) = σ∗(p) = p + 1.
Lemma 13.1 Let n be an odd positive integer. Then σ(n) is odd if and
only if n is a square.
Proof. Let
n =

p|n
pvp
be the unique factorization of n as a product of odd prime numbers. The
positive integer d divides n if and only if d can be written in the form
d =

p|n
pup,
where
0 ≤up ≤vp,
and so
σ(n)
=

p|n
vp

up=0
pup
≡

p|n
(up + 1)
(mod 2)
≡
1
(mod 2)
if and only if up is even for all p, that is, up = 2wp and
n =

p|n
pvp =


p|n
pwp


2
is a square. This completes the proof.

406
13. Liouville’s Identity
Lemma 13.2 If n = 2km, where k ≥0 and m is odd, then σ∗(n) =
2kσ(m). If σ∗(n) is odd, then n is the square of an odd integer.
Proof. Let d be a divisor of n. If the conjugate divisor δ = n/d is odd,
then 2k must divide d, and so d = 2kd′ for some integer d′. Then
2km = n = dδ = 2kd′δ,
and d′ is a divisor of m. Conversely, if d′ is any divisor of m, then 2kd′ is
a divisor of n whose conjugate divisor m/d′ is odd. Therefore,
σ∗(n) = 2k 
d′|m
d′ = 2kσ(m).
If σ∗(n) is odd, then k = 0 and n = m is odd. It follows that σ∗(n) =
σ(m) = σ(n) is odd, and so n is a square by Lemma 13.1. This completes
the proof.
Lemma 13.3 For every positive integer n,
σ∗(n) = 2

1≤u<√n
(−1)u−1σ∗(n −u2) + {(−1)n−1n}n=ℓ2.
Proof. We apply Theorem 13.2 to the odd function f(y) = y. If n = ℓ2,
the right side of the identity is
(−1)ℓ−1ℓf(ℓ) = (−1)n−1ℓ2 = (−1)n−1n.
To obtain the left side of the identity, we recall the involution (13.1) on
triples (u, d, δ) such that u2 + dδ = n and δ is odd, and obtain

u+dδ=n
δ≡1
(mod 2)
(−1)uu = 0.
Then

u+dδ=n
δ≡1
(mod 2)
(−1)uf(u + d)
=

u+dδ=n
δ≡1
(mod 2)
(−1)u(u + d)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)uu +

u2+dδ=n
δ≡1
(mod 2)
(−1)ud
=

u2+dδ=n
δ≡1
(mod 2)
(−1)ud
=

u2<n
(−1)u

n−u2=dδ
δ≡1
(mod 2)
d
=

|u|<√n
(−1)uσ∗(n −u2).

13.2 Prime Numbers and Quadratic Forms
407
Therefore,

|u|<√n
(−1)uσ∗(n −u2) = {(−1)n−1n}n=ℓ2.
This completes the proof.
Theorem 13.3 (Fermat) An odd prime number p can be represented by
the quadratic form x2 + y2 if and only if p ≡1
(mod 4).
Proof. Since every square is congruent to 0 or 1 modulo 4, it follows
that a sum of two squares must be congruent to 0, 1, or 2 modulo 4, and
so no integer congruent to 3 modulo 4 can be represented as the sum of
two squares.
Let p be an odd prime number. Then p is certainly not a square. By
Lemma 13.3,
σ∗(p) = 2σ∗(p −1) −2σ∗(p −4) + 2σ∗(p −9) −· · · .
Since σ∗(p) = p + 1, we have
p + 1
2
= σ∗(p −12) −σ∗(p −22) + σ∗(p −32) −· · · .
If p ≡1
(mod 4), then (p + 1)/2 is an odd integer, and so at least one
of the terms on right side of this equation must be odd. Thus, there exists
a positive integer b < √n such that σ∗(p −b2) is odd. By Lemma 13.2,
p −b2 = a2 for some odd integer a. This completes the proof.
Theorem 13.4 If p is a prime number such that p ≡1
(mod 4), then
there exist unique positive integers a and b such that a is odd, b is even,
and p = a2 + b2.
Proof. Let
p = a2
1 + b2
1 = a2
2 + b2
2,
where a1 and a2 are positive odd integers and b1 and b2 are positive even
integers. We must prove that a1 = a2 and b1 = b2.
If a1 < a2, then b1 > b2 and there exist positive integers x and y such
that
a2 = a1 + 2x
and
b2 = b1 −2y.
Then
p
=
a2
2 + b2
2
=
(a1 + 2x)2 + (b1 −2y)2
=
a2
1 + 4a1x + 4x2 + b2
1 −4b1y + 4y2
=
p + 4a1x + 4x2 −4b1y + 4y2,

408
13. Liouville’s Identity
and so
x(a1 + x) = y(b1 −y).
Let (x, y) = d. Deﬁne the positive integers X and Y by x = dX and
y = dY . Then
X(a1 + x) = Y (b1 −y).
Since (X, Y ) = 1, it follows that there exists a positive integer r such that
rY = a1 + x = a1 + dX
and
rX = b1 −y = b1 −dY.
Then r2 + d2 ≥2 and x2 + y2 ≥2, and
p = a2
1 + b2
1 = (rY −dX)2 + (rX + dY )2 = (r2 + d2)(X2 + Y 2),
which is impossible, since p is prime and not composite. Therefore, a1 = a2
and b1 = b2, and the representation of a prime p ≡1
(mod 4) as a sum
of two squares is essentially unique.
Theorem 13.5 An odd prime number p can be represented by the quadratic
form x2 + 2y2 if and only if p ≡1 or 3
(mod 8).
Proof. Since every square is congruent to 0, 1, or 4 modulo 8, it follows
that an odd integer n is of the form a2 + 2b2 only if n ≡1 or 3
(mod 8).
Let a be a positive integer, a < √n. By Lemma 13.3, for every positive
integer n we have
σ∗(n) = 2

1≤u<√n
(−1)u−1σ∗(n −u2) + {(−1)n−1n}n=ℓ2.
(13.2)
Let 1 ≤u < √n. Applying Lemma 13.3 to n −u2, we have
σ∗(n−u2) = 2

1≤v2<n−u2
(−1)v−1σ∗(n−u2−v2)+{(−1)n−u−1(n−u2)}n−u2=ℓ2
u.
Inserting this into (13.2), we obtain
σ∗(n)
=
4

u,v≥1
u2+v2<n
(−1)u+vσ∗(n −u2 −v2)
+ 2(−1)n

1≤u<√n
{n −u2}n−u2=ℓ2
u + {(−1)n−1n}n=ℓ2.

13.2 Prime Numbers and Quadratic Forms
409
If u ̸= v and u2 + v2 = n, then v2 + u2 = n and the pairs (u, v) and (v, u)
both appear in the ﬁrst sum. Considering congruences modulo 8, we obtain
4

u,v≥1
u2+v2<n
(−1)u+vσ∗(n −u2 −v2)
=
8

1≤u<v
u2+v2<n
(−1)u+vσ∗(n −u2 −v2) + 4

u≥1
2u2<n
σ∗(n −2u2)
≡
4

u≥1
2u2<n
σ∗(n −2u2)
(mod 8).
Therefore,
σ∗(n)
≡
4

u≥1
2u2<n
σ∗(n −2u2) + 2(−1)n 
u≥1
u2<n
{n −u2}n−u2=ℓ2
u
+ {(−1)n−1n}n=ℓ2
(mod 8).
Let p ≡3
(mod 8). The prime number p is not a square, and, by The-
orem 13.3, p is also not the sum of two squares. Therefore,
{(−1)p−1p}p=ℓ2 = {p −u2}p−u2=ℓ2
u = 0
for all u, and so
4

u≥1
2u2<n
σ∗(n −2u2) ≡σ∗(p) = p + 1 ≡4
(mod 8).
Dividing this congruence by 4, we obtain

u≥1
2u2<n
σ∗(n −2u2) ≡p + 1
4
≡1
(mod 2),
and so σ∗(n −2b2) is odd for some integer b. Then n −2b2 = a2 for some
odd number a, and n = a2 + 2b2.
Let p ≡1
(mod 8). Then
σ∗(p) = p + 1 ≡2
(mod 8).
By Theorems 13.3 and 13.4, there exist unique positive integers a and b
such that p = a2 + b2, where a is odd and b is even. This implies that

u≥1
u2<p
{(p −u2)}p−u2=ℓ2
u = {p −a2}p−a2=b2 + {p −b2}p−b2=a2 = b2 + a2 = p,

410
13. Liouville’s Identity
and so
2
≡
σ∗(p)
(mod 8)
≡
4

u≥1
2u2<p
σ∗(p −2u2) + 2(−1)p

1≤u2<p
{(p −u2)}p−u2=ℓ2
u
(mod 8)
≡
4

u≥1
2u2<p
σ∗(p −2u2) −2p
(mod 8)
≡
4

u≥1
2u2<p
σ∗(p −2u2) −2
(mod 8).
Therefore,
4

u≥1
2u2<p
σ∗(p −2u2) −2 ≡2
(mod 8),
and

u≥1
2u2<p
σ∗(p −2u2) ≡1
(mod 2).
It follows that σ∗(p−2b2) is odd for some positive integer b, and so p−2b2 =
a2 for some odd integer a. This completes the proof.
Exercises
1. Prove that σ∗(n) = 1 if and only if n = 2k for some nonnegative
integer k.
2. Let d(n) denote the number of positive divisors of n. Prove that d(n)
is odd if and only if n is a square.
3. Prove that n is a sum of two squares if and only if 2n is a sum of two
squares. Hint: Consider the identity 2(x2 + y2) = (x + y)2 + (x −y)2.
Let n = 2km, where k ≥0 and m is odd. Prove that n is a sum of
two squares if and only if m is a sum of two squares.
4. Verify the polynomial identity
(x2
1 + y2
1)(x2
2 + y2
2) = (x1x2 −y1y2)2 + (x1y2 + y1x2)2.
Deduce that if each of the integers n1 and n2 can be represented as
a sum of two squares, then their product n1n2 is also a sum of two
squares.
5. Let k ≥2 and let n1, . . . , nk be positive integers. Prove that if each
integer ni is a sum of two squares, then the product n1n2 · · · nk is a
sum of two squares.

13.3 A Ternary Form
411
6. For every prime p and positive integer n, let vp(n) denote the highest
power of p that divides n. Prove that if vp(n) is even for every prime
p ≡3
(mod 4), then n can be represented as a sum of two squares.
7. Let a and b be relatively prime integers, and let p be an odd prime.
Prove that if p divides a2 +b2, then p ≡1
(mod 4). Hint: Show that
(ab−1)2 ≡−1
(mod p), and so

−1
p

= 1, where

a
p

is the Legen-
dre symbol. Recall that

−1
p

= 1 if and only if p ≡1
(mod 4).
8. Let p be a prime number, p ≡3
(mod 4), and let a and b be integers.
Prove that if pc exactly divides a2+b2 (that is, pc is the highest power
of p that divides a2 + b2, then c is even. Hint: Let d = (a, b), and let
pγ exactly divide d. Let a = dA and b = dB, and consider the highest
power of p that divides A2 + B2.
9. Prove that if n can be represented as a sum of two squares, then vp(n)
is even for every prime p ≡3
(mod 4).
13.3
A Ternary Form
We begin with the ternary quadratic form
Q(x, y, z) = x2 + yz.
A representation of n by the quadratic form Q(x, y, z) is an ordered triple
of integers (x, y, z) such that Q(x, y, z) = n. We denote by R(n) the set of
all representations of n by the quadratic form Q, that is,
R(n) = {(x, y, z) : Q(x, y, z) = n}.
We introduce six bijections from the set R(n) to itself. The simplest are
the involutions
ρ(x, y, z)
=
(x, z, y),
σ(x, y, z)
=
(−x, y, z),
and
τ(x, y, z) = (x, −y, −z).
Let
α(x, y, z) = (z −x, 2x + y −z, z).
(13.3)
If (x, y, z) ∈R(n), then
Q(α(x, y, z))
=
Q(z −x, 2x + y −z, z)

412
13. Liouville’s Identity
=
(z −x)2 + (2x + y −z)z
=
z2 −2xz + x2 + 2xz + yz −z2
=
x2 + yz
=
n,
and so α(x, y, z) ∈R(n). Moreover,
α2(x, y, z) = α(z −x, 2x + y −z, z) = (x, y, z),
and so α is also an involution on the set R(n).
Let
β(x, y, z) = (x + y, y, −2x −y + z).
(13.4)
If (x, y, z) ∈R(n), then
Q(β(x, y, z))
=
Q(x + y, y, −2x −y + z)
=
(x + y)2 + y(−2x −y + z)
=
x2 + 2xy + y2 −2xy −y2 + yz
=
x2 + yz
=
n,
and so β(x, y, z) ∈R(n).
Let
γ(x, y, z) = (x −y, y, 2x −y + z).
(13.5)
If (x, y, z) ∈R(n), then
Q(γ(x, y, z))
=
Q(x −y, y, 2x −y + z)
=
(x −y)2 + y(2x −y + z)
=
x2 −2xy + y2 + 2xy −y2 + yz
=
x2 + yz
=
n,
and so γ(x, y, z) ∈R(n). Moreover,
γβ(x, y, z)
=
γ(x + y, y, −2x −y + z)
=
(x + y −y, y, 2(x + y) −y + (−2x −y + z))
=
(x, y, z).
Similarly,
βγ(x, y, z) = (x, y, z).
Therefore, β, γ : R(n) →R(n) are bijections with γ = β−1.
Finally, we state the following simple lemma, which will be used in the
proof of Liouville’s formula.

13.4 Proof of Liouville’s Identity
413
Lemma 13.4 Let S and S′ be ﬁnite sets, and let ϑ : S →S′ be a bijection
with inverse ϑ−1 : S′ →S. If G(s) is a function deﬁned for all s ∈S, then

s∈S
G(s) =

s′∈S′
G(ϑ−1(s′)).
Proof. This follows instantly from the fact that ϑ−1(S′) = S.
Exercises
1. Prove that σβσ = γ and ρβσρ = α.
2. Prove that βσ is an involution.
3. Prove that
βn(x, y, z) = (x + ny, y, z −2nx −n2y).
4. Compute γn(x, y, z).
5. Consider the 3 × 3 matrix
A =


1
0
0
0
0
1
2
0
1
2
0

.
Let v denote the column vector
v =


x
y
z

.
Its transpose is vT = (x, y, z). Show that
Q(x, y, z) = vT Av.
6. Let Q1(x, y, z) = x2 + y2 −z2. Check that Q(x, y + z, y −z) =
Q1(x, y, z) and Q1 (x, (y + z)/2, (y −z)/2) = Q(x, y, z).
13.4
Proof of Liouville’s Identity
In this section we prove Theorem 13.1.
For every positive integer n, we let S(n) be the set of all triples (u, d, δ)
such that
Q(u, d, δ) = u2 + dδ = n,

414
13. Liouville’s Identity
where u is an integer and d and δ are positive integers. Then S(n) is a
ﬁnite subset of R(n). Using this notation, we have

u2+dδ=n
=

(u,d,δ)∈S(n)
.
Partition S(n) into three sets S1(n), S−1(n), and S0(n) as follows:
S1(n) = {(u, d, δ) ∈S(n) : 2u + d −δ ≥1},
S0(n) = {(u, d, δ) ∈S(n) : 2u + d −δ = 0},
and
S−1(n) = {(u, d, δ) ∈S(n) : 2u + d −δ ≤−1}.
Let α be the map on S(n) deﬁned by (13.3). If (u, d, δ) ∈S(n), then d and
δ are positive integers. If (u, d, δ) ∈S1(n), then 2u + d −δ ≥1, and so
(u′, d′, δ′) = α(u, d, δ) = (δ −u, 2u + d −δ, δ) ∈S(n).
Since
2u′ + d′ −δ′ = 2(δ −u) + (2u + d −δ) −δ = d ≥1,
it follows that α(u, d, δ) ∈S1(n), and so α is an involution on S1(n). More-
over,
δ′ −2u′
=
δ −2(δ −u) = −(δ −2u),
u′ + d′
=
(δ −u) + (2u + d −δ) = u + d,
and
2u′ + 2d′ −δ′ = 2(δ −u) + 2(2u + d −δ) −δ = 2u + 2d −δ.
Let F(x, y, z) be a function that is odd in x and even in the pair (y, z).
We deﬁne the function
G(x, y, z) = F(z −2x, x + y, 2x + 2y −z).
If (u, d, δ) ∈S1(n) and α(u, d, δ) = (u′, d′, δ′), then
G(u, d, δ) + G(u′, d′, δ′)
=
F(δ −2u, u + d, 2u + 2d −δ) + F(δ′ −2u′, u′ + d′, 2u′ + 2d′ −δ′)
=
F(δ −2u, u + d, 2u + 2d −δ) + F(−(δ −2u), u + d, 2u + 2d −δ)
=
0,

13.4 Proof of Liouville’s Identity
415
since the function F(x, y, z) is odd in its ﬁrst variable x. From Lemma 13.4
with S = S′ = S1(n) and ϑ = ϑ−1 = α, we obtain

(u,d,δ)∈S1(n)
F(δ −2u, u + d, 2u + 2d −δ)
=

(u,d,δ)∈S1(n)
G(u, d, δ)
=

(u,d,δ)∈S1(n)
G(u′, d′, δ′)
=
−

(u,d,δ)∈S1(n)
G(u, d, δ)
=
0.
Next we consider triples (u, d, δ) ∈S0(n). Since
2u + d −δ = 0,
it follows that
u = δ −d
2
and
n = u2 + dδ =
δ −d
2
2
+ dδ =
d + δ
2
2
= ℓ2,
where
ℓ= d + δ
2
≥1.
Therefore, the set S0(n) is nonempty only if n is a square. Moreover, the
integers d and δ are positive, and so
1 ≤d = 2ℓ−δ ≤2ℓ−1.
Conversely, if 1 ≤d ≤2ℓ−1, we set δ = 2ℓ−d and u = ℓ−d. Then
u2 + dδ
=
(ℓ−d)2 + d(2ℓ−d) = ℓ2 = n,
2u + d −δ
=
0,
and
(u, d, δ) ∈S0(n).
It follows that if n = ℓ2 with ℓ≥1, then
S0(n) = {(d −ℓ, d, 2ℓ−d) : 1 ≤d ≤2ℓ−1}
and

(u,d,δ)∈S0(n)
F(δ −2u, u + d, 2u + 2d −δ) =
2ℓ−1

d=1
F(d, ℓ, d) = T1(n).

416
13. Liouville’s Identity
To analyze the sum

(u,d,δ)∈S(n)
F(d + δ, u, d −δ),
we construct a second partition of S(n). Deﬁne the three sets S′
1(n), S′
−1(n),
and S′
0(n)(n) as follows:
S′
1(n)
=
{(u, d, δ) ∈S(n) : 2u −d + δ ≥1},
S′
−1(n)
=
{(u, d, δ) ∈S(n) : 2u −d + δ ≤−1},
and
S′
0(n) = {(u, d, δ) ∈S(n) : 2u −d + δ = 0}.
We shall prove that

(u,d,δ)∈S−1(n)
F(δ −2u, u + d, 2u + 2d −δ)
=

(u,d,δ)∈S′
1(n)
F(d + δ, u, d −δ)
=

(u,d,δ)∈S′
−1(n)
F(d + δ, u, d −δ)
and

(u,d,δ)∈S′
0(n)
F(d + δ, u, d −δ) = {T2(n)}n=ℓ2.
Let β be the map on S(n) deﬁned by (13.4). If (u, d, δ) ∈S−1(n), then
2u + d −δ ≤−1, and so −2u −d + δ ≥1 and
(u′, d′, δ′) = β(u, d, δ) = (u + d, d, −2u −d + δ) ∈S(n).
Moreover,
2u′ −d′ + δ′ = 2(u + d) −d + (−2u −d + δ) = δ ≥1,
and so
β : S−1(n) →S′
1(n).
Let γ be the map on S(n) deﬁned by (13.5). If (u′, d′, δ′) ∈S′
1(n), then
2u′ −d′ + δ′ ≥1 and
(u, d, δ) = γ(u′, d′, δ′) = (u′ −d′, d′, 2u′ −d′ + δ′) ∈S(n).
Moreover,
2u + d −δ = 2(u′ −d′) + d′ −(2u′ −d′ + δ′) = −δ′ ≤−1,

13.4 Proof of Liouville’s Identity
417
and so (u, d, δ) ∈S−1(n). Therefore, the map
γ : S′
1(n) →S−1(n)
is a bijection, and γ = β−1.
Applying Lemma 13.4, we obtain

(u,d,δ)∈S−1(n)
F(δ −2u, u + d, 2u + 2d −δ)
=

(u,d,δ)∈S−1(n)
G(u, d, δ)
=

(u′,d′,δ′)∈β(S−1(n))
G(γ(u′, d′, δ′))
=

(u′,d′,δ′)∈S′
1(n)
G(u′ −d′, d′, 2u′ −d′ + δ′)
=

(u′,d′,δ′)∈S′
1(n)
F(d′ + δ′, u′, d′ −δ′).
Let ψ be the map on S(n) deﬁned by ψ(u, d, δ) = (−u, δ, d). Then ψ is
an involution since ψ = ρσ. If (u, d, δ) ∈S′
1(n), then 2u −d + δ ≥1, and
so −2u −δ + d ≤−1 and
ψ(u, d, δ) = (−u, δ, d) ∈S′
−1(n).
Similarly, if (u, d, δ) ∈S′
−1(n), then 2u −d + δ ≥1, and so −2u −δ + d ≥1
and
ψ(u, d, δ) = (−u, δ, d) ∈S′
1(n).
Therefore,
ψ : S′
1(n) →S′
−1(n)
is a bijection with ψ−1 = ψ. Let
H(x, y, z) = F(y + z, x, y −z).
By Lemma 13.4,

(u,d,δ)∈S′
1(n)
F(d + δ, u, d −δ)
=

(u,d,δ)∈S′
1(n)
H(u, d, δ)
=

(u,d,δ)∈S′
−1(n)
H(ψ(u, d, δ))
=

(u,d,δ)∈S′
−1(n)
H(−u, δ, d)
=

(u,d,δ)∈S′
−1(n)
F(δ + d, −u, −δ −d)
=

(u,d,δ)∈S′
−1(n)
F(d + δ, u, d + δ),

418
13. Liouville’s Identity
since the function F(x, y, z) is even in the pair of variables (y, z).
If (u, d, δ) ∈S′
0(n), then
2u −d + δ
=
0,
u
=
d −δ
2
,
and
n = u2 + dδ =
d −δ
2
2
+ dδ =
d + δ
2
2
= ℓ2,
where
ℓ= d + δ
2
.
Therefore, the set S′
0(n) is nonempty only if n is a square. Since the integers
d and δ are positive, it follows that
1 ≤d = 2ℓ−δ ≤2ℓ−1.
Conversely, if 1 ≤d ≤2ℓ−1, we set δ = 2ℓ−d and u = d −ℓ. Then
u2 + dδ
=
(d −ℓ)2 + d(2ℓ−d) = ℓ2 = n,
2u −d + δ
=
0,
and
(u, d, δ) ∈S′
0(n).
It follows that if n = ℓ2 with ℓ≥1, then
S′
0(n) = {(d −ℓ, d, 2ℓ−d) : 1 ≤d ≤2ℓ−1}
and

(u,d,δ)∈S′
0(n)
F(d + δ, u, d −δ)
=
2ℓ−1

d=1
F(2ℓ, d −ℓ, 2d −2ℓ)
=
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j)
=
T2(n).
Therefore,

(u,d,δ)∈S(n)
F(d + δ, u, d −δ)
=
2

(u,d,δ)∈S′
1(n)
F(d + δ, u, d −δ) + {T2(n)}n=ℓ2

13.5 Two Corollaries
419
=
2

(u,d,δ)∈S−1(n)
F(δ −2u, u + d, 2u + 2d −δ) + {T2(n)}n=ℓ2
=
2

(u,d,δ)∈S−1(n)
F(δ −2u, u + d, 2u + 2d −δ) +
2

(u,d,δ)∈S1(n)
F(δ −2u, u + d, 2u + 2d −δ) + {T2(n)}n=ℓ2
=
2

(u,d,δ)∈S(n)
F(δ −2u, u + d, 2u + 2d −δ)
−2{T1(n)}n=ℓ2 + {T2(n)}n=ℓ2.
This completes the proof of Theorem 13.1.
13.5
Two Corollaries
In this section we derive two additional identities that we use in the next
chapter.
Theorem 13.6 If F(x, y, z) is a function that is odd in each of the vari-
ables x, y, and z, and if F(x, y, z) = 0 for every even integer x, then

(u,d,δ)∈S(n)
δ≡1
(mod 2)
F(δ −2u, u + d, 2u + 2d −δ) = {T0(ℓ)}n=ℓ2,
where
T0(ℓ) =
ℓ

j=1
F(2j −1, ℓ, 2j −1).
Proof. Since the function F(x, y, z) is odd in the variable y, we have
F(x, 0, z) = 0 for all x and z, and

(u,d,δ)∈S(n)
F(d + δ, u, d −δ)
=

(u,d,δ)∈S(n)
u≥1
F(d + δ, u, d −δ) +

(u,d,δ)∈S(n)
u≤−1
F(d + δ, u, d −δ)
=

(u,d,δ)∈S(n)
u≥1
F(d + δ, u, d −δ) +

(u,d,δ)∈S(n)
u≥1
F(d + δ, −u, d −δ)
=

(u,d,δ)∈S(n)
u≥1
F(d + δ, u, d −δ) −

(u,d,δ)∈S(n)
u≥1
F(d + δ, u, d −δ)
=
0.

420
13. Liouville’s Identity
Since F(x, y, z) = 0 for all even integers x, we have

(u,d,δ)∈S(n)
F(δ−2u, u+d, 2u+2d−δ) =

(u,d,δ)∈S(n)
δ≡1
(mod 2)
F(δ−2u, u+d, 2u+2d−δ).
If n = ℓ2, then
T1(ℓ) =
2ℓ−1

j=1
F(j, ℓ, j) =
ℓ

j=1
F(2j −1, ℓ, 2j −1)
and
T2(ℓ) =
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j) = 0.
The result follows immediately from Theorem 13.1.
Theorem 13.7 Let f(x, y) be a function that is odd in each of the variables
x and y. For every positive integer n,

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2f(δ −2u, u + d) = {T0(ℓ)}n=ℓ2,
where
T0(ℓ) =
ℓ

j=1
(−1)j+ℓf(2j −1, ℓ).
Proof. We deﬁne the function F(x, y, z) as follows:
F(x, y, z) =
 0
if x or z is even,
(−1)y+ z+1
2 f(x, y)
if x and z are odd.
Then F(x, y, z) is a function that is odd in each of the variables x, y, and
z, and F(x, y, z) = 0 for every even integer x. By Theorem 13.6, we have

u2+dδ=n
δ≡1
(mod 2)
F(δ −2u, u + d, 2u + 2d −δ)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2f(δ −2u, u + d)
=
{T0(ℓ)}n=ℓ2,
where
T0(ℓ)
=
ℓ

j=1
F(2j −1, ℓ, 2j −1)
=
ℓ

j=1
(−1)j+ℓf(2j −1, ℓ).

13.6 Notes
421
This completes the proof.
13.6
Notes
Liouville’s papers contain the statements of many theorems, but no proofs.
Dickson’s History of the Theory of Numbers [25], Volume II, Chapter XI,
“Liouville’s series of eighteen articles,” contains a detailed summary of
Liouville’s assertions and references to papers by other mathematicians
who have provided proofs of Liouville’s results.
Uspensky and Heaslet [145] and Venkov [149] present careful accounts of
Liouville’s method and proofs of many of his results.

14
Sums of an Even Number of Squares
The problem of the representation of an integer n as the sum of a
given number k of integral squares is one of the most celebrated
in the theory of numbers. . . . Almost every arithmetician of note
since Fermat has contributed to the solution of the problem, and
it has its puzzles for us still.
G. H. Hardy [52, p. 132]
14.1
Summary of Results
For every positive integer s and nonnegative integer n, we let Rs(n) denote
the number of ordered s-tuples of integers (x1, . . . , xs) such that
n = x2
1 + · · · + x2
s.
The integers xi can be positive, negative, or 0. For every s ≥1 we have
Rs(0) = 1,
since 0 = 02 +· · ·+02 is the unique representation of 0 as a sum of squares.
We shall apply Liouville’s identities to obtain explicit formulae for the
number of representations of a positive integer as the sum of s squares,
where s = 2, 4, 6, 8, and 10. Representing an integer n as the sum of s
squares is a problem in additive number theory, but the solution, for even

424
14. Sums of an Even Number of Squares
values of s, always involves a sum over the divisors of n, a fundamental
topic in multiplicative number theory.
In this chapter, d and δ always denote positive integers, and 
d|n and

n=dδ denote the sum over the positive divisors of n.
We write the positive integer n in the form n = 2am, where a ≥0 and
m is odd. We shall prove the following formulae:
R2(n)
=
4

d|m
(−1)(d−1)/2,
R4(n)
=
 8 
d|n d
if n is odd,
24 
d|m d
if n is even,
R6(n)
=
4

4a+1 −(−1)(m−1)/2 
m=dδ
(−1)(δ−1)/2d2,
R8(n)
=
 16 
d|n d3
if n is odd,
(16/7)(8a+1 −15) 
d|m d3
if n is even,
R10(n)
=
4
5

16a+1 + (−1)(m−1)/2 
m=dδ
(−1)(δ−1)/2d4
+16
5

n=v2+w2

v4 −3v2w2
.
14.2
A Recursion Formula
Our proofs depend on the following recursion formula for Rs(n).
Theorem 14.1 For all positive integers s and n,

|u|≤√n

n −(s + 1)u2
Rs(n −u2) = 0.
(14.1)
Proof. If
n = x2
1 + · · · + x2
s + x2
s+1,
then x2
s+1 ≤n and so
|xs+1| ≤√n.
For j = 1, . . . , Rs+1(n), let
n =
s+1

i=1
x2
i,j
denote the Rs+1(n) representations of n as a sum of s + 1 squares. For
i = 1, . . . , s, we deﬁne the map τi on the set of (s + 1)-tuples by
τi(x1, . . . , xi−1, xi, xi+1, . . . , xs, xs+1) = (x1, . . . , xi−1, xs+1, xi+1, . . . , xs, xi).

14.2 A Recursion Formula
425
This is an involution on the set of the Rs+1(n) representations of n as a
sum of s + 1 squares, and so
Rs+1(n)

j=1
x2
s+1,j =
Rs+1(n)

j=1
x2
i,j
for i = 1, . . . , s.
Summing over all representations of n, we obtain
nRs+1(n)
=
Rs+1(n)

j=1
s+1

i=1
x2
i,j
=
s+1

i=1
Rs+1(n)

j=1
x2
i,j
=
(s + 1)
Rs+1(n)

j=1
x2
s+1,j
=
(s + 1)

|u|≤√n
u2Rs(n −u2),
since for every integer u with |u| ≤√n there are Rs(n−u2) representations
n = s+1
i=1 x2
i,j with xs+1,j = u. This also implies that
Rs+1(n) =

|u|≤√n
Rs(n −u2).
Then
nRs+1(n) = n

|u|≤√n
Rs(n −u2),
and

|u|≤√n

n −(s + 1)u2
Rs(n −u2) = 0.
This completes the proof.
Theorem 14.2 Let Φ(n) be a function deﬁned for all nonnegative integers
n such that
Φ(0) = 1
and

|u|≤√n

n −(s + 1)u2
Φ(n −u2) = 0
for n ≥1. Then
Φ(n) = Rs(n)
for all n ≥0.

426
14. Sums of an Even Number of Squares
Proof. This follows immediately from Theorem 14.1.
The recursion formula (14.1) enables us to compute Rs(n) for all positive
integers s and n. We have
nRs(n)
=
−

1≤|u|≤√n

n −(s + 1)u2
Rs(n −u2)
=
2

1≤u≤√n

(s + 1)u2 −n

Rs(n −u2),
and so
Rs(n) = 2

1≤u≤√n
(s + 1)u2
n
−1

Rs(n −u2).
(14.2)
For example, for s = 3 we have
R3(1)
=
2

4·12
1
−1

R3(1 −12)
=
6
,
R3(2)
=
2

4·12
2
−1

R3(2 −12)
=
12
,
R3(3)
=
2

4·12
3
−1

R3(3 −12)
=
8
,
R3(4)
=
2

4·12
4
−1

R3(4 −12) +

4·22
4
−1

R3(4 −22)

=
6
,
R3(5)
=
2

4·12
5
−1

R3(5 −12) +

4·22
5
−1

R3(5 −22)

=
24
,
R3(6)
=
2

4·12
6
−1

R3(6 −12) +

4·22
6
−1

R3(6 −22)

=
24
,
R3(7)
=
2

4·12
7
−1

R3(7 −12) +

4·22
7
−1

R3(7 −22)

=
0
,
R3(8)
=
2

4·12
8
−1

R3(8 −12) +

4·22
8
−1

R3(8 −22)

=
12
.
Exercises
1. Prove that Rs(n) < Rs+1(n) for all positive integers s and n.
2. Use induction on s to prove (without using Theorem 14.1) that Rs(n)
is even for all positive integers s and n.
3. Use the recursion formula (14.2) to compute R2(n) and R4(n) for
n ≤8.
4. For positive integers k and s, let Rk,s(n) denote the number of s-
tuples of integers such that
xk
1 + · · · + xk
s = n.
Then Rs(n) = R2,s(n) and R2k,s(0) = 1. Prove that

|u|≤n1/2k

n −(s + 1)u2k
R2k,s(n −u2k) = 0
for every positive integer n.

14.3 Sums of Two Squares
427
5. Let k and s be positive integers. Prove that
R2k,s(1) = 2s.
6. Let k and s be positive integers, and let 0 ≤n < 4k. Prove that
R2k,s(n) = 2n
s
n

.
7. Let s ≥3. Show that R3,s(n3) = ∞for every integer n.
8. For positive integers k and s, let rk,s(n) denote the number of s-tuples
of nonnegative integers such that
xk
1 + · · · + xk
s = n.
Prove that rk,s(0) = 1 and

0≤u≤n1/k

n −(s + 1)uk
rk,s(n −uk) = 0
for every positive integer n.
14.3
Sums of Two Squares
Recall that S(n) is the set of all triples (u, d, δ) of integers with d, δ ≥1
and u2 + dδ = n.
If k1 and k2 are odd integers, then the function f(x, y) = xk1yk2 is odd
in each of the variables x and y. Applying Theorem 13.7, we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)k1(d + u)k2
=


ℓk2
ℓ

j=1
(−1)ℓ−j(2j −1)k1



n=ℓ2
.
(14.3)
We shall use this identity for various values of k1 and k2. We can simplify the
sum on the left by noticing that (u, d, δ) ∈S(n) if and only if (−u, d, δ) ∈
S(n). This implies that if k is an odd integer and g(d, δ) is any function,
then

u2+dδ=n
δ≡1
(mod 2)
ukg(d, δ) = 0.
(14.4)

428
14. Sums of an Even Number of Squares
Since (u, d, δ) ∈S(n) if and only if (u, δ, d) ∈S(n), it also follows that if
ε(d, δ) = ε(δ, d), then

u2+dδ=n
ε(d, δ)(d −δ)h(u) = 0
(14.5)
for any function h(u).
In this section we shall obtain a formula for the number of representations
of an integer as the sum of two squares. By Theorem 14.2, it suﬃces to
construct a function Φ(n) such that Φ(0) = 1 and

|x|≤√n

n −3x2
Φ(n −x2) = 0
for every positive integer n.
Theorem 14.3
R2(n) = 4

d|n
(−1)(d−1)/2 = 4




d|n
d≡1
(mod 4)
1 −

d|n
d≡3
(mod 4)
1


.
Proof. The function f(x, y) = xy is odd in each of the variables x and
y. The left side of identity (14.3) is

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2f(δ −2u, d + u)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)(d + u)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ −2u2 + δu −2du)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ −2u2),
by (14.4) with k = 1.
If n = ℓ2, then (by Exercise 1) the right side of the identity (14.3) is
T0(ℓ)
=
ℓ
ℓ

j=1
(−1)ℓ−j(2j −1)
=
ℓ2
=
n.

14.3 Sums of Two Squares
429
Therefore,

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ −2u2) = {T0(ℓ)}n=ℓ2.
If d and δ are positive integers and
n = u2 + dδ,
then
|u| < √n
and
dδ −2u2 = n −3u2.
Therefore,

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ −2u2)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(n −3u2)
=

|u|<n
(n −3u2)

δ|(n−u2)
δ≡1
(mod 2)
(−1)(δ−1)/2.
Deﬁne the function Φ(n) by Φ(0) = 1 and, for every positive integer n,
Φ(n) = 4

δ|n
δ≡1
(mod 2)
(−1)(δ−1)/2.
Then

|u|<√n
(n −3u2)Φ(n −u2) = {4n}n=ℓ2.
If n is not a square, then

|u|≤√n
(n −3u2)Φ(n −u2) =

|u|<√n
(n −3u2)Φ(n −u2) = {4n}n=ℓ2 = 0.
If n = ℓ2 is a square, then

|u|≤√n
(n −3u2)Φ(n −u2)
=

|u|<√n
(n −3u2)Φ(n −u2)
+(n −3m2)Φ(0) + (n −3(−m)2)Φ(0)
=
{4n}n=ℓ2 −2n −2n
=
0.
Therefore,
R2(n) = Φ(n)
for all positive integers n. This completes the proof.

430
14. Sums of an Even Number of Squares
Exercises
1. Prove that for every positive integer ℓ,
ℓ

j=1
(−1)ℓ−j(2j −1) = ℓ.
2. Let p be a prime number such that p ≡1
(mod 4). Prove that
R2(pk) = 4(k + 1).
3. Let p be a prime number such that p ≡3
(mod 4). Prove that
R2(pk) =

4
if k is even,
0
if k is odd.
4. Deﬁne the divisor functions
d1(n) =

d|n
d≡1
(mod 4)
1
and
d3(n) =

d|n
d≡3
(mod 4)
1.
Prove that d1(n) ≥d3(n) for every positive integer n.
5. Let p be a prime number, p ≡3
(mod 4). Prove that if n = p2k−1m,
where (p, m) = 1, then
d1(n) = kd1(m) + kd3(m)
and
d3(n) = kd1(m) + kd3(m).
Deduce that n cannot be written as the sum of two squares.
6. An arithmetic function f(n) is called multiplicative if
f(n1n2) = f(n1)f(n2)
for all positive integers n1 and n2 such that (n1, n2) = 1. Deﬁne the
function χ(n) by
χ(n) =



0
if n is even,
1
if n ≡1
(mod 4),
−1
if n ≡3
(mod 4).

14.4 Sums of Four Squares
431
Prove that χ(n) is multiplicative.
Prove that
R2(n) =

d|n
χ(n).
Prove that R2(n) is multiplicative.
Hint: If (n1, n2) = 1 and d is a divisor of n1n2, then there exist unique
divisors d1 of n1 and d2 of n2 such that d = d1d2.
7. The divisor function counts the number of positive divisors of n, that
is,
d(n) =

d|n
1.
Prove that d(n) is a multiplicative function, and that
R2(n) ≤4d(n)
for all positive integers n.
Hint: Since R2(n) and d(n) are both multiplicative functions, it suf-
ﬁces to to check the inequality for prime powers.
8. Prove that lim infn→∞R2(n) = 0.
9. Prove that lim supn→∞R2(n) = ∞.
14.4
Sums of Four Squares
In this section we prove Jacobi’s formula for the number of representations
of an integer as the sum of four squares.
Theorem 14.4 (Jacobi) For every positive integer n,
R4(n) = 8

d|n
d
if n is odd,
and
R4(n) = 24

d|n
d≡1
(mod 2)
d
if n is even.
Proof. By Theorem 13.1, if F(x, y, z) is a function of integer variables
x, y, z that is odd in x and even in the pair (y, z), then
2

u2+dδ=n
F(δ −2u, u + d, 2u + 2d −δ) −

u2+dδ=n
F(d + δ, u, d −δ)
=


2
2ℓ−1

j=1
F(j, ℓ, j) −
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j)



n=ℓ2
.

432
14. Sums of an Even Number of Squares
The function (−1)xF(x, y, z) is also odd in x and even in the pair (y, z).
Applying Theorem 13.1 to the function (−1)xF(x, y, z), we obtain
2

u2+dδ=n
(−1)δF(δ −2u, u + d, 2u + 2d −δ)
−

u2+dδ=n
(−1)d+δF(d + δ, u, d −δ)
=


2
2ℓ−1

j=1
(−1)jF(j, ℓ, j) −
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j)



n=ℓ2
.
Adding these identities gives
4

u2+dδ=n
δ≡0
(mod 2)
F(δ −2u, u + d, 2u + 2d −δ)
−2

u2+dδ=n
d≡δ
(mod 2)
F(d + δ, u, d −δ)
=





4

1≤j≤2ℓ−1
j≡0
(mod 2)
F(j, ℓ, j) −2
ℓ−1

j=−ℓ+1
F(2ℓ, j, 2j)





n=ℓ2
. (14.6)
Subtracting these identities gives
4

u2+dδ=n
δ≡1
(mod 2)
F(δ −2u, u + d, 2u + 2d −δ)
−2

u2+dδ=n
d≡−δ
(mod 2)
F(d + δ, u, d −δ)
=





4

1≤j≤2ℓ−1
j≡1
(mod 2)
F(j, ℓ, j)





n=ℓ2
.
(14.7)
The function
G(x, y, z) =
 0
if x or z is odd,
(−1)(x+z)/2F(x, y, z)
if x and z are even
is also odd in the variable x and even in the pair of variables y, z. Applying
identity (14.6) to the function G(x, y, z), we obtain
4

u2+dδ=n
δ≡0
(mod 2)
(−1)dF(δ −2u, u + d, 2u + 2d −δ)

14.4 Sums of Four Squares
433
−2

u2+dδ=n
d≡δ
(mod 2)
(−1)dF(d + δ, u, d −δ)
=





4

1≤j≤2ℓ−1
j≡0
(mod 2)
F(j, ℓ, j) −2
ℓ−1

j=−ℓ+1
(−1)ℓ+jF(2ℓ, j, 2j)





n=ℓ2
.
(14.8)
Subtracting (14.7) from (14.8) and dividing by 2, we obtain the important
identity
2

u2+dδ=n
ε(d, δ)

F(δ −2u, u + d, 2u + 2d −δ) −1
2F(d + δ, u, d −δ)

=


2
2ℓ−1

j=1
(−1)j−1F(j, ℓ, j) −
ℓ−1

j=−ℓ+1
(−1)ℓ+jF(2ℓ, j, 2j)



n=ℓ2
,
(14.9)
where
ε(d, δ)
=

1
if d and δ are even,
−1
if d or δ is odd.
The formula for R4(n) follows immediately from applying this identity to
the function
F(x, y, z) = xy2.
We obtain on the left side
2

u2+dδ=n
ε(d, δ)

(δ −2u)(u + d)2 −1
2(d + δ)u2

=
2

u2+dδ=n
ε(d, δ)

d2δ + 2dδu + 1
2δu2 −2u3 −9
2du2 −2d2u

=
2

u2+dδ=n
ε(d, δ)

d(n −u2) + 1
2δu2 −9
2du2

(by (14.4))
=
2

u2+dδ=n
ε(d, δ)d(n −5u2) −

u2+dδ=n
ε(d, δ)(d −δ)u2
=

u2<n
(n −5u2)2

n−u2=dδ
ε(d, δ)d
(by (14.5)).
If n = ℓ2, the right side of (14.9) is
2ℓ2
2ℓ−1

j=1
(−1)j−1j −2ℓ
ℓ−1

j=−ℓ+1
(−1)ℓ+jj2
=
2ℓ3 −4ℓ
ℓ−1

j=1
(−1)ℓ−1−jj2
=
2ℓ3 −4ℓ2(ℓ−1)
2
=
2n,

434
14. Sums of an Even Number of Squares
and so

u2<n
(n −5u2)8

n−u2=dδ
ε(d, δ)d = {8n}n=ℓ2.
Deﬁne Φ(0) = 1 and
Φ(n) = 8

n=dδ
ε(d, δ)d
for n ≥1. If n is not a square, then

u2≤n
(n −5u2)Φ(n) =

u2<n
(n −5u2)Φ(n) = 0.
If n is a square and n = ℓ2, then

u2≤n
(n −5u2)Φ(n)
=

u2<n
(n −5u2)Φ(n) +

u=±ℓ
(n −5u2)Φ(n)
=

u2<n
(n −5u2)Φ(n) −8n
=
0.
Therefore,
R4(n) = 8

n=dδ
ε(d, δ)d
for all positive integers n.
If n is odd and n = dδ, then ε(d, δ) = 1 and
R4(n) = 8

d|n
d.
If n is even, then n = 2am, where a ≥1 and m is odd. Every divisor of
n can be written uniquely in the form 2bd, where 0 ≤b ≤a and m = dδ.
Then
R4(n)
=
8

m=dδ
a

b=0
ε(2bd, 2a−bδ)2bd
=
8

m=dδ
ε(d, 2aδ)d + 8

m=dδ
ε(2ad, δ)2ad
+ 8

m=dδ
a−1

b=1
ε(2bd, 2a−bδ)2bd
=
8

m=dδ
d + 8

m=dδ
2ad −8

m=dδ
a−1

b=1
2bd

14.4 Sums of Four Squares
435
=
8

m=dδ
d + 8

m=dδ
2ad −8(2a −2)

m=dδ
d
=
24

m=dδ
d
=
24

d|n
d≡1
(mod 2)
d.
This completes the proof.
Exercises
1. Prove that R4(2k) = 24 for all k ≥1. Find all representations of 2k
as a sum of four squares.
2. Prove that
lim inf
n→∞
R4(n)
nε
= 0
for all ε > 0.
3. Compute R4(pk) for all odd primes p and k ≥1.
4. Prove that
lim sup
n→∞
R4(n)
n
≥8.
5. Prove that
R4(n) < 24n log n
for n ≥2.
6. Prove that for every positive integer ℓ,
ℓ

j=1
(−1)ℓ−jj =
ℓ+ 1
2

,
and so
2ℓ−1

j=1
(−1)j−1j = ℓ.
7. Prove that for every positive integer ℓ,
ℓ

j=1
(−1)ℓ−jj2 = ℓ(ℓ+ 1)
2
,
and so
2ℓ−1

j=1
(−1)j(ℓ−j)2 = ℓ−ℓ2.

436
14. Sums of an Even Number of Squares
14.5
Sums of Six Squares
In this section we obtain an explicit formula for R6(n). The idea is to apply
identity (14.3) to the monomials x3y and xy3, and to manipulate the results
so that we can ﬁnd a function Φ(n) that satisﬁes the recursion formula

|x|≤√n

n −7x2
Φ(n −x2) = 0.
Theorem 14.5 Let n be a positive integer,
n = 2am,
where a ≥0 and m is odd. Then
R6(n) = 4

4a+1 −(−1)(m−1)/2 
m=dδ
(−1)(δ−1)/2d2.
As an example, we shall describe the representations of 5 as a sum of
six squares. There are 256
5

= 192 representations as a sum of ﬁve terms
(±1)2. There are 226
1
5
1

= 120 representations as a sum of (±1)2 and
(±2)2. Thus, there are 312 representations of 5 as a sum of six squares.
We can also compute this number by applying Theorem 14.5 with a = 0
and m = 5. Then
R6(5) = 4

41 −(−1)(5−1)/2
(52 + 1) = 4 · 3 · 26 = 312.
Proof. The function f(x, y) = x3y is odd in each of the variables x and
y, and so we can apply (14.3) with k1 = 3 and k2 = 1. The left side of this
identity is

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)3(u + d)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(uδ3 −6u2δ2 + 12u3δ −8u4 + dδ3 −6udδ2
+ 12u2dδ −8u3d)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ3 −6u2δ2 + 12u2dδ −8u4)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ2(n −7u2) + 4u2(3n −5u2)).
If n = ℓ2, then (by Exercise 3) the right side of the identity is
T0(ℓ)
=
(−1)ℓ−1ℓ
ℓ

k=1
(−1)k−1(2k −1)3

14.5 Sums of Six Squares
437
=
(−1)ℓ−1ℓ(−1)ℓ−1(4ℓ3 −3ℓ)
=
4ℓ4 −3ℓ2
=
4n2 −3n.
Therefore,

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ2(n −7u2) + 4u2(3n −5u2)) = {4n2 −3n}n=ℓ2.
(14.10)
Next we apply (14.3) to the function f(x, y) = xy3. The left side of the
identity is

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)(u + d)3
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(u3δ + 3u2dδ + 3ud2δ + d3δ −2u4 −6u3d
−6u2d2 −2ud3)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(d3δ −6u2d2 + 3u2dδ −2u4)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(d2(n −7u2) + u2(3n −5u2)).
If n = ℓ2, then (by Exercise 1) the right side of the identity is
T0(ℓ)
=
(−1)ℓ−1ℓ3
ℓ

k=1
(−1)k−1(2k −1)
=
ℓ4
=
n2.
Multiplying by 4, we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(4d2(n−7u2)+4u2(3n−5u2)) = {4n2}n=ℓ2. (14.11)
Subtracting equation (14.10) from equation (14.11), we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(n −7u2)(4d2 −δ2)
=

|u|<n
(n −7u2)

dδ=n−u2
δ≡1
(mod 2)
(−1)(δ−1)/2(4d2 −δ2)
=
{3n}n=ℓ2.

438
14. Sums of an Even Number of Squares
Let Φ(0) = 1. For every positive integer n, deﬁne
Φ(n) = 4

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(4d2 −δ2).
If n is not a square, then

|u|≤n
(n −7u2)Φ(n −u2) =

|u|<n
(n −7u2)Φ(n −u2) = 0.
If n = ℓ2 is a square, then

|u|≤n
(n −7u2)Φ(n −u2)
=

|u|<n
(n −7u2)Φ(n −u2) + (n −7ℓ2)Φ(0) + (n −7(−ℓ)2)Φ(0)
=
12n −12n
=
0.
Therefore,
R6(n) = Φ(n) = 4

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(4d2 −δ2).
We rewrite this equation as follows. Let n = 2am, where a ≥0 and m is
odd. Then δ is an odd divisor of n if and only if there exists a divisor d1 of
m such that d = 2ad1 and m = d1δ. Therefore,

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/24d2
=
4

d1δ=m
(−1)(δ−1)/2(2ad1)2
=
4a+1 
d1δ=m
(−1)(δ−1)/2d2
1.
By Exercise 4, if m is odd and d1δ = m, then
(−1)(d−1)/2(−1)(δ−1)/2 = (−1)(m−1)/2.
It follows that

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2δ2
=

d1δ=m
(−1)(δ−1)/2δ2
=

dδ=m
(−1)(d−1)/2d2
=
(−1)(m−1)/2 
dδ=m
(−1)(δ−1)/2d2.

14.5 Sums of Six Squares
439
Therefore,
R6(n) = Φ(n) = 4

4a+1 −(−1)(m−1)/2 
dδ=m
(−1)(δ−1)/2d2.
This completes the proof.
Theorem 14.6 For all positive integers n,
3n2
2
< R6(n) < 40n2.
Proof. Let n = 2am, where a ≥0 and m is odd. The inﬁnite series
ζ(2) = ∞
k=1 k−2 converges, and ζ(2) < 2 by Exercise 5. Then

dδ=m
(−1)(δ−1)/2d2
=
m2 
dδ=m
(−1)(δ−1)/2
δ2
≤
m2 
dδ=m
1
δ2
<
m2
∞

k=1
1
k2
<
2m2
and
4a+1 −(−1)(m−1)/2
≤
4 · 4a + 1
≤
5 (2a)2 .
Therefore,
R6(n)
=
4

4a+1 −(−1)(m−1)/2 
dδ=m
(−1)(δ−1)/2d2
≤
4 · 5 (2a)2 2m2
=
40n2.
This gives the upper bound.
To obtain a lower bound, we have

dδ=m
(−1)(δ−1)/2d2
=
m2 
dδ=m
(−1)(δ−1)/2
δ2
≥
m2


1 −

δ|m
δ>1
1
δ2



>
m2

1 −
∞

k=1
1
(2k + 1)2

>
m2
2

440
14. Sums of an Even Number of Squares
by Exercise 6. Also,
4a+1 −(−1)(m−1)/2
≥
4 · 4a −1
≥
3 (2a)2 .
Therefore,
R6(n)
=
4

4a+1 −(−1)(m−1)/2 
dδ=m
(−1)(δ−1)/2d2
≥
3 (2a)2 m2
2
=
3n2
2 .
This completes the proof.
Exercises
1. Find all representations of 6 as a sum of 6 squares.
2. Find all representations of 10 as a sum of 6 squares.
3. Prove that for every positive integer m,
ℓ

j=1
(−1)ℓ−j(2j −1)3 = (4ℓ3 −3ℓ).
4. Prove that if m is odd and dδ = m, then
(−1)(d−1)/2(−1)(δ−1)/2 = (−1)(m−1)/2.
5. Prove that
ζ(2) =
∞

k=1
1
k2 < 2.
Hint: k−2 <
8 k
k−1 x−2dx for k ≥2.
6. Prove that
∞

k=1
1
(2k + 1)2 < 1
2.
Hint: 4(2k + 1)−2 < k−2.
7. Use the fact that ζ(2) = π2/6 to prove that
∞

k=1
1
(2k + 1)2 = π2
24 −1 = 0.23 . . . .

14.6 Sums of Eight Squares
441
14.6
Sums of Eight Squares
Theorem 14.7 Let n be a positive integer. If n is odd, then
R8(n) = 16

d|n
d3.
If n is even and n = 2am, where a ≥1 and m is odd, then
R8(n) = 16(8a+1 −15)
7

d|m
d3.
Proof. We shall apply Liouville’s identity (Theorem 13.1) to the three
polynomials (−1)yxy4, (−1)yxy3(2y −z), and (−1)yxy2.
Inserting (−1)yxy4 into Liouville’s identity, we ﬁnd that the ﬁrst term
on the left is
2

u2+dδ=n
(−1)u+d(δ −2u)(u + d)4
=
2

u2+dδ=n
(−1)u+d 
d4δ −8u2d3 + u4δ −8u4d + 6u2d2δ

=
2

u2+dδ=n
(−1)u+d 
d3(n −9u2) + u4(δ −14d) + 6nu2d

.
The second term on the left side of the identity is

u2+dδ=n
(−1)u(d + δ)u4 = 2

u2+dδ=n
(−1)udu4.
If n = ℓ2, then
2T1(ℓ) = (−1)ℓ2ℓ4
2ℓ−1

j=1
j = (−1)ℓ(4ℓ6 −2ℓ5)
by Exercise 2, and
T2(ℓ)
=
2ℓ
ℓ−1

j=−ℓ+1
(−1)jj4 = 4ℓ
ℓ−1

j=1
(−1)jj4
=
(−1)ℓ−1 
2ℓ5 −4ℓ4 + 2ℓ2
,
and so the right side of Liouville’s identity is
2T1(ℓ) −T2(ℓ) = (−1)ℓ(4ℓ6 −4ℓ4 + 2ℓ2) = (−1)n(4n3 −4n2 + 2n).

442
14. Sums of an Even Number of Squares
Dividing by 2, we obtain

u2+dδ=n
(−1)u+dd3(n −9u2) +

u2+dδ=n
(−1)uu4 
(−1)d(δ −14d) −d

+ 6n

u2+dδ=n
(−1)u+ddu2 = {(−1)n(2n3 −2n2 + n)}n=ℓ2.(14.12)
Next we consider the polynomial (−1)yxy3(2y−z). The ﬁrst term on the
left side of Liouville’s formula is
2

(u,d,δ)∈S(n)
(−1)u+d(δ −2u)(u + d)3δ
=
2

(u,d,δ)∈S(n)
(−1)u+d 
3dδ2u2 + d3δ2 −2δu4 −6d2δu2
=
2

(u,d,δ)∈S(n)
(−1)u+d(3δu2(n −u2) + d(n −u2)2
−2δu4 −6du2(n −u2))
=
2

(u,d,δ)∈S(n)
(−1)u+d 
nu2(3δ −8d) + u4(7d −5δ) + n2d

.
The second term on the left is

u2+dδ=n
(−1)u(d + δ)u3(2u −d + δ)
=
2

u2+dδ=n
(−1)u(d + δ)u4
=
4

u2+dδ=n
(−1)udu4.
If n = ℓ2, then
2T1(ℓ)
=
2
2ℓ−1

j=1
(−1)ℓjℓ3(2ℓ−j)
=
(−1)ℓ4ℓ4
2ℓ−1

j=1
j −(−1)ℓ2ℓ3
2ℓ−1

j=1
j2
=
(−1)n2(4n3 −n2)
3
and
T2(ℓ) = 0.

14.6 Sums of Eight Squares
443
Therefore,
2

u2+dδ=n
(−1)u+d 
nu2(3δ −8d) + u4(7d −5δ) + n2d

−4

u2+dδ=n
(−1)udu4
=
(−1)n2(4n3 −n2)
3

n=ℓ2
,
or, equivalently,
3

u2+dδ=n
(−1)uu4 
(−1)d(7d −5δ) −2d

+ 3n

u2+dδ=n
(−1)u+du2(3δ −8d) + 3n2

u2+dδ=n
(−1)u+dd
=

(−1)n(4n3 −n2)

n=ℓ2 .
(14.13)
For every positive integer n we have

u2+dδ=n
(−1)uu4 
(−1)d(δ −14d) −d

+ 3

u2+dδ=n
(−1)uu4 
(−1)d(7d −5δ) −2d

=
7

u2<n
(−1)uu4

n−u2=dδ

(−1)d(d −2δ) −d

=
0
by Exercise 3. Adding equations (14.12) and (14.13), we obtain

u2+dδ=n
(−1)u+dd3(n −9u2) + 9n

u2+dδ=n
(−1)u+du2(δ −2d)
+ 3n2

u2+dδ=n
(−1)u+dd = {(−1)n(6n3 −3n2 + n)}n=ℓ2.(14.14)
Finally, we consider the polynomial (−1)yxy2. The left side of Liouville’s
identity is
2

u2+dδ=n
(−1)u+d(δ −2u)(u + d)2 −

u2+dδ=n
(−1)u(d + δ)u2
=
2

u2+dδ=n
(−1)u+d(u2(δ −5d) + nd) −2

u2+dδ=n
(−1)udu2.
If n = ℓ2, then
2T1(ℓ) −T2(ℓ) = (−1)ℓ(4ℓ4 −2ℓ2) = (−1)n(4n2 −2n).

444
14. Sums of an Even Number of Squares
Multiplying by 3n/2, we obtain
3n

u2+dδ=n
(−1)uu2 
(−1)d(δ −5d) −d

+ 3n2

u2+dδ=n
(−1)u+dd
=
9n

u2+dδ=n
(−1)u+du2(δ −2d) + 3n2

u2+dδ=n
(−1)u+dd
=
{(−1)n(6n3 −3n2)}n=ℓ2,
(14.15)
since

n−u2=dδ

(−1)d(δ −5d) −d

= 3

n−u2=dδ
(−1)d(δ −2d)
by Exercise 3. Subtracting (14.15) from (14.14), we obtain

u2+dδ=n
(−1)u+dd3(n −9u2) = {(−1)nn}n=ℓ2.
We deﬁne the function Φ(n) as follows:
Φ(0) = 1
and
Φ(n) = 16(−1)n 
d|n
(−1)dd3
for every positive integer n. If n is not a square, then

u2≤n
(n −9u2)Φ(n −u2)
=

u2<n
(n −9u2)Φ(n −u2)
=
16

u2<n
(n −9u2)(−1)n−u2

n−u2=dδ
(−1)dd3
=
16(−1)n 
u2<n
(n −9u2)(−1)u 
n=dδ
(−1)dd3
=
0.
If n = ℓ2, then

u2≤n
(n −9u2)Φ(n −u2)
=

u2<n
(n −9u2)Φ(n −u2) +

u=±ℓ
(n −9u2)Φ(n −u2)
=
16(−1)n 
u2<n
(n −9u2)(−1)u

n−u2=dδ
(−1)dd3 −16n
=
16(−1)n{(−1)nn}n=ℓ2 −16n
=
0.

14.7 Sums of Ten Squares
445
The recursion formula (14.2) implies that
R8(n) = Φ(n).
We can rewrite the expression for R8(n) as follows. Let n = 2am, where
a ≥0 and m is odd. The odd divisors of n are precisely the divisors of m.
The even divisors of n are the numbers of the form 2bd, where 1 ≤b ≤a
and d is a divisor of m. Then
Φ(n)
=
16(−1)n 
n=dδ
(−1)dd3
=
16(−1)n


a

b=1

d|m
(2bd)3 −

d|m
d3


=
16(−1)n
 a

b=1
8b −1
 
d|m
d3
=
16(−1)n
8a+1 −15
7
 
d|m
d3.
This completes the proof.
Exercises
1. Prove that for every positive integer n,
16n3 < R8(n) <
128ζ(3)
7

n3,
where ζ(3) = ∞
k=1 k−3.
2. Prove that for every positive integer ℓ,
ℓ−1

j=1
(−1)jj4 = (−1)ℓ−1
ℓ4 −2ℓ3 + ℓ
2

.
3. Prove that

n=dδ

(−1)d(d −2δ) −d

= 0
for every positive integer n.
14.7
Sums of Ten Squares
We shall determine the number of representations of an integer as a sum
of ten squares. In this case the formula for R10(n) contains two terms. The

446
14. Sums of an Even Number of Squares
ﬁrst is a divisor function, that is, a sum over divisors of n, and the second
is a sum over representations of n as a sum of two squares.
Theorem 14.8 Let n be a positive integer,
n = 2am,
where a ≥0 and m is odd. Then
R10(n)
=
4
5

16a+1 + (−1)(m−1)/2 
m=dδ
(−1)(δ−1)/2d4
+ 16
5

n=v2+w2

v4 −3v2w2
.
As an example, we list the representations of 5 as a sum of ten squares.
There are 2510
5

= 32 · 252 = 8064 representations as a sum of ﬁve terms
of the form (±1)2. There are 2210
1
9
1

= 360 representations as a sum
of the integers (±1)2 and (±2)2. Thus, there are 8424 representations. By
Theorem 14.8, with n = m = 5 and a = 0, we have
R10(5)
=
4
5 (16 + 1) (54 + 1) + 16
5

5=x2+y2

x4 −3x2y2
=
42568
5
+ 16
5 (4(24 −3 · 22) + 4(14 −3 · 22))
=
42568
5
−448
5
=
8424.
Proof. By Theorem 14.2, it suﬃces to ﬁnd a function Φ(n) such that
Φ(0) = 1 and

|x|≤√n

n −11x2
Φ(n −x2) = 0
for every positive integer n.
We begin by applying identity (14.3) to each of the monomials x5y, x3y3,
and xy5. With f(x, y) = x5y, we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)5(u + d)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2
×




0≤k≤5
k≡1
(mod 2)
5
k

(−2)kδ5−kuk+1 +

0≤k≤5
k≡0
(mod 2)
5
k

(−2)kdδ5−kuk




14.7 Sums of Ten Squares
447
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(dδ5 −10δ4u2 + 40dδ3u2 −80δ2u4
+ 80dδu4 −32u6)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ4(n −u2) −10δ4u2 + 40δ2u2(n −u2)
−80δ2u4 + 16u4(5n −5u2) −32u6)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ4(n −11u2) + 40δ2u2(n −3u2)
+ 16u4(5n −7u2))
=


ℓ
ℓ

j=1
(−1)ℓ−j(2j −1)5



n=ℓ2
=

16n3 −40n2 + 25n

n=ℓ2
by Exercise 4.
Applying (14.3) with f(x, y) = x3y3, we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)3(u + d)3
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(3dδ3u2 + 12d3δu2 −6δ2u4 −24d2u4 + d3δ3
−18d2δ2u2 + 36dδu4 −8u6)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2((3δ2u2 + 12d2u2)(n −u2)
−(3δ2u2 + 12d2u2)2u2(dδ −2u2)((dδ −2u2)2 −12dδu2))
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2((3δ2u2 + 12d2u2)(n −3u2)
+ (n −3u2)3 −12u2(n −u2)(n −3u2))
=


ℓ3
ℓ

j=1
(−1)ℓ−j(2j −1)3



n=ℓ2
=

4n3 −3n2
n=ℓ2
by Exercise 3 in Section 14.5.
Applying (14.3) with f(x, y) = xy5, we obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ −2u)(u + d)5

448
14. Sums of an Even Number of Squares
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(d5δ −10d4u2 + 10d3δu2 −20d2u4
+ 5dδu4 −2u6)
=

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(d4(n −11u2) + 10d2u2(n −3u2)
+ u4(5n −7u2))
=


ℓ5
ℓ

j=1
(−1)ℓ−j(2j −1)



n=ℓ2
=
{n3}n=ℓ2
by Exercise 1 in Section 14.3.
The upshot of this analysis is the following three identities:

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(δ4(n −11u2) + 40δ2u2(n −3u2)
+ 16u4(5n −7u2)) =

16n3 −40n2 + 25n

n=ℓ2 ,
(14.16)

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2((3δ2u2 + 12d2u2)(n −3u2) + (n −3u2)3
−12u2(n −u2)(n −3u2)) =

4n3 −3n2
n=ℓ2 ,
(14.17)

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(d4(n −11u2) + 10d2u2(n −3u2)
+ u4(5n −7u2)) = {n3}n=ℓ2.
(14.18)
We shall eliminate the terms

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2d2u2(n −3u2)
and

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2δ2u2(n −3u2)
from these equations as follows: Multiply equation (14.18) by 16 and add
to equation (14.16), then multiply equation (14.17) by 40/3 and subtract.
We obtain

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(n −11u2)(16d4 + δ4) +

u2+dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2

14.7 Sums of Ten Squares
449
×

160u2(n −u2)(n −3u2) + 32u4(5n −7u2)40
3 (n −3u2)3

=

25n −64n3
3

n=ℓ2 .
Let P(n) denote the ﬁrst sum in this equation, and let Q(n) denote the
second sum. Then
P(n) −{25n}n=ℓ2 + Q(n) +
64n3
3

n=ℓ2
= 0.
For positive integers n we deﬁne the function ϕ(n) by
ϕ(n) =

n=dδ
d,δ≥1
δ≡1
(mod 2)
(−1)(δ−1)/2(16d4 + δ4).
Let
ϕ(0) = 5
4.
Then
P(n)
=

n=u2+dδ
δ≡1
(mod 2)
(−1)(δ−1)/2(n −11u2)(16d4 + δ4)
=

u2<n
(n −11u2)

n=dδ
δ≡1
(mod 2)
(−1)(δ−1)/2(16d4 + δ4)
=

u2<n
(n −11u2)ϕ(n −u2).
If n = ℓ2 is a square, then

u=±ℓ
(n −11u2)ϕ(n −u2)
=
(n −11ℓ2)ϕ(0) + (n −11(−ℓ)2)ϕ(0)
=
(−20n)5
4
=
−25n,
and so
P(n) −{25n}n=ℓ2 =

u2≤n
(n −11u2)ϕ(n −u2).
Recall the formula for the number of representations of an integer as the
sum of two squares:
R2(n) = 4

δ|n
δ≡1
(mod 2)
(−1)(δ−1)/2.


14.7 Sums of Ten Squares
451
=

n=u2+v2+w2
32u6
3
−10v6
3
−10w6
3

+

n=u2+v2+w2
120u2v2w2
+

n=u2+v2+w2

60u4v2 −80u2v4 + 60u4w2 −80u2w4 −10v4w2 −10v2w4
=
4

n=u2+v2+w2

u6 −15u4v2 + 30u2v2w2
.
The simple form of the last equation arises from a symmetry argument: If
h(u, v, w) is any function and σ is any permutation of u, v, and w, then

n=u2+v2+w2
h(u, v, w) =

n=u2+v2+w2
h(σ(u), σ(v), σ(w)).
For every nonnegative integer n we deﬁne the function
ψ(n) =

n=v2+w2
(v4 −3v2w2).
Then ψ(0) = 0, ψ(1) = 2, ψ(2) = −8,. . . , and

u2≤n
(n −11u2)ψ(n −u2)
=

u2≤n
(n −11u2)

n−u2=v2+w2
(v4 −3v2w2)
=

n=u2+v2+w2
(n −11u2)(v4 −3v2w2)
=

n=u2+v2+w2
(v2 + w2 −10u2)(v4 −3v2w2)
=

n=u2+v2+w2
(v6 −2v4w2 −3v2w4 −10u2v4 + 30u2v2w2)
=

n=u2+v2+w2
(u6 −15u4v2 + 30u2v2w2)
by (14.5).
Therefore,
Q(n) +
64n3
3

n=ℓ2
=
4

u2≤n
(n −11u2)ψ(n −u2).
We deﬁne
Φ(n) = 4(ϕ(n) + 4ψ(n))
5
.
Then
Φ(0) = 1

452
14. Sums of an Even Number of Squares
and

u2≤n
(n −11u2)Φ(n −u2) = 0
for all positive integers n. It follows that
R10(n)
=
4
5 (ϕ(n) + 4ψ(n))
=
4
5

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2(16d4 + δ4) + 16
5

n=v2+w2
(v4 −3v2w2).
Let n = 2am, where m is odd and a ≥0. Since n = dδ with δ odd if and
only if d is of the form d = 2ad1, where d1 is a divisor of m, then it follows
that

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/216d4 = 16a+1 
d1δ=m
(−1)(δ−1)/2d4
1.
Moreover, if m = d1δ, then
(−1)(m−1)/2 = (−1)(d1−1)/2(−1)(δ−1)/2
and

dδ=n
δ≡1
(mod 2)
(−1)(δ−1)/2δ4
=

d1δ=m
(−1)(δ−1)/2δ4
=

d1δ=m
(−1)(d1−1)/2d4
1
=
(−1)(m−1)/2 
d1δ=m
(−1)(δ−1)/2d4
1.
This completes the proof.
Exercises
1. Compute R10(n) for n = 1, . . . , 10.
2. Find all representations of 10 as a sum of 10 squares.
3. Find all representations of 6 as a sum of 10 squares.
4. Prove that for every positive integer ℓ,
ℓ

j=1
(−1)ℓ−j(2j −1)5 = 16ℓ5 −40ℓ3 + 25ℓ.

14.8 Notes
453
5. Evaluate the sum
ℓ

j=1
(−1)ℓ−j(2j −1)2.
6. Evaluate the sum
ℓ

j=1
(−1)ℓ−j(2j −1)4.
7. A Gaussian integer is a complex number v + wi, where v and w
are ordinary integers. The norm of the Gaussian integer v + wi is
N(v + wi) = v2 + w2. Prove that

n=v2+w2
(v4 −3v2w2) = 1
2

N(v+wi)=n
(v + wi)4.
14.8
Notes
Liouville’s identity, applied to “appropriate” polynomials and rearranged,
gives formulae for the number of representations of an integer as the sum of
an even number of squares. Our manipulations evolved the old-fashioned
way, by hand with pencil and paper, but almost certainly it is possible
today to do this more eﬃciently with human-assisted computer algebra
systems. It would be a useful exercise to derive formulae for Rs(n) for even
numbers s ≥12 using software such as Maple or Mathematica.
The proofs in this chapter are based on Venkov’s exposition [149] of
Liouville’s method. Analytic proofs of these results can be found in the
books of Grosswald [43], Knopp [81], and Rademacher [119]. An interest-
ing discussion of the problem of sums of squares appears in Hardy’s book
Ramanujan [52, Chapter IX].
Iwaniec [74] considers the more general problem of the number of repre-
sentations of an integer n by a positive deﬁnite quadratic form Q(x1, . . . , xs).
We denote the representation number by rQ(n). This is the Fourier coeﬃ-
cient of the theta function
θQ(z) =

(x1,...,xs)∈Zs
e2πiQ(x1,...,xs)z =
∞

n=0
rQ(n)e2πinz,
and
θQ(z) = EQ(z) + FQ(z),
(14.19)
where EQ(z) is an Eisenstein series and FQ(z) is a cusp form.
In this chapter we considered the positive deﬁnite quadratic form
Q(x1, . . . , xs) = x2
1 + · · · + x2
s.

454
14. Sums of an Even Number of Squares
If s is even and s ≤8, then the cusp form in (14.19) is zero and rs(n) is
the coeﬃcient of an Eisenstein series. If s is even and s ≥10, then the cusp
form in (14.19) is nonzero, and the main term in rs(n) is the coeﬃcient
of an Eisenstein series and the remainder term is the coeﬃcient of a cusp
form. In this case, Liouville’s formulae might provide a method to compute
the coeﬃcients of cusp forms.

15
Partition Asymptotics
15.1
The Size of p(n)
A partition of n is a representation of n as a sum of positive integers. The
order of the summands does not matter. We often write the partition in
the form
n = a1 + a2 + · · · + ak,
where
a1 ≥a2 ≥· · · ≥ak ≥1.
For example, the partitions of 5 are
5,
4 + 1,
3 + 2,
3 + 1 + 1,
2 + 2 + 1,
2 + 1 + 1 + 1,
1 + 1 + 1 + 1 + 1.
The unrestricted partition function p(n) counts the number of partitions of
the positive integer n. Thus, p(5) = 7. This function is strictly increasing,
and satisﬁes the asymptotic formula
p(n) ∼ec0
√n
(4
√
3)n,
(15.1)

456
15. Partition Asymptotics
where
c0 = π
2
2
3 = 2
2
π2
6 = 2.565 . . . .
It follows that
log p(n) ∼c0
√n.
(15.2)
Hardy and Ramanujan [58] and Uspensky [146] independently discovered
this result; their proofs used complex variables and modular functions.
Erd˝os later found an elementary proof of (15.1). The idea of Erd˝os’s proof
is simply to apply induction to the recursion formula (Theorem 15.1)
np(n) =

kv≤n
k,v≥1
vp(n −kv).
(15.3)
The proof, however, is diﬃcult; it is “elementary” only in the technical sense
that it does not require complex analysis. We shall use Erd˝os’s method to
obtain (15.2). The determination of the asymptotics of partition functions
is our third problem in additive number theory.
Let A be a nonempty set of positive integers, and let d = gcd(A). For
every positive integer n, the partition function pA(n) counts the number
of partitions of n into parts belonging to A. We deﬁne pA(0) = 1 for all
sets A. We would like to understand the asymptotic behavior of pA(n). For
example, if A is the set of odd positive integers, then pA(n) is the number
of partitions of n into odd parts, and log pA(n) ∼π
-
n/3.
If d = gcd(A) > 1, we consider the set A′ = {a/d : a ∈A}. Then
gcd(A′) = 1, and
pA(n) =
 0
if n ̸≡0
(mod d),
pA′ (n/d)
if n ≡0
(mod d).
Thus, it suﬃces to consider only partition functions for sets A such that
gcd(A) = 1.
We do this in two signiﬁcant cases. In the ﬁrst, A is a ﬁnite set of integers
with |A| = k and gcd(A) = 1. We shall prove that
pA(n) =

1

a∈A a

nk−1
(k −1)! + O

nk−2
.
In the second, A is a set of integers of positive density d(A) = α with
gcd(A) = 1. We shall prove that
log pA(n) ∼c0
√αn.
(15.4)
We shall also prove an inverse theorem: If A is a set of positive integers
whose partition function satisﬁes (15.4) for some α > 0, then gcd(A) = 1
and A has density α.
We begin by proving the recursion formula (15.3).

15.1 The Size of p(n)
457
Theorem 15.1 For every positive integer n,
np(n) =

kv≤n
k,v≥1
vp(n −kv).
Proof. The parts in a partition of n are positive integers v not exceeding
n. The number of partitions of n with at least one part equal to v is p(n−v).
For any positive integer k, the number of partitions of n with at least k
parts equal to v is p(n −kv), and so the number of partitions of n with
exactly k parts equal to v is p(n −kv) −p(n −(k + 1)v). Therefore, the
number of parts equal to v that occur in all partitions of n is

k≥1
k(p(n −kv) −p(n −(k + 1)v)) =

k≥1
p(n −kv).
We list the p(n) partitions of n as follows:
n
=
a1,1 + a1,2 + · · · + a1,k1,
n
=
a2,1 + a2,2 + · · · + a2,k2,
n
=
a3,1 + a3,2 + · · · + a3,k3,
...
n
=
ap(n),1 + ap(n),2 + · · · + ap(n),kp(n).
Adding the p(n) rows of this array, we obtain
np(n)
=
p(n)

i=1
ki

j=1
ai,j
=
n

v=1
v

ai,j=v
1
=
n

v=1
v

k≥1
p(n −kv)
=

kv≤n
k,v≥1
vp(n −kv).
This completes the proof. 2
Exercises
1. Compute p(n) for n = 1, 2, 3, 4.

458
15. Partition Asymptotics
2. Let q(n) denote the number of partitions of n into distinct parts. Let
A be the set of odd numbers and pA(n) the number of partitions
of n into not necessarily distinct odd parts. Compute p(6), q(6), and
pA(6).
3. Compute p(7), q(7), and pA(7).
4. Use the recursion formula (15.3) to compute p(8).
5. Let A = {1} ∪{2n : n ≥1}. Prove that
pA(2n) = pA(2n + 1)
for all nonnegative integers n.
6. Prove that if pA(n) ≥1 and pA(n0) ≥1, then pA(n) ≤pA(n + n0).
7. Let A be a nonempty set of positive integers, and let a1 ∈A. Prove
that the partition function pA(n) is increasing in every congruence
class modulo a1, that is,
pA(n) ≤pA(n + a1)
for every positive integer n.
Prove that for every real number x ≥a1 there exists an integer u
such that
x −a1 < u ≤x
and
max{pA(n) : 0 ≤n ≤x} = pA(u).
15.2
Partition Functions for Finite Sets
Theorem 15.2 Let A be a nonempty ﬁnite set of relatively prime positive
integers, with |A| = k. Let pA(n) denote the number of partitions of n into
parts belonging to A. Then
pA(n) =

1

a∈A a

nk−1
(k −1)! + O

nk−2
.
Proof. The proof is by induction on k. If k = 1, then A = {1} and
pA(n) = 1, since every positive integer has a unique partition into a sum
of 1’s.
Let k ≥2, and assume that the theorem holds for k −1. Let A =
{a1, . . . , ak}. Then gcd(A) = (a1, . . . , ak) = 1. If d = (a1, . . . , ak−1), then
(d, ak) = 1. For i = 1, . . . , k −1 we set
a′
i = ai
d .

15.2 Partition Functions for Finite Sets
459
Then gcd(a′
1, . . . , a′
k−1) = 1, and
A′ = {a′
1, . . . , a′
k−1}
is a set of k −1 relatively prime positive integers. Since the induction
assumption holds for A′, we have
pA′(n) =

1
k−1
i=1 a′
i

nk−2
(k −2)! + O

nk−3
for all nonnegative integers n.
Let n ≥(d −1)ak. Since (d, ak) = 1, there exists a unique integer u such
that 0 ≤u ≤d −1 and
n ≡uak
(mod d).
Then
m = n −uak
d
is a nonnegative integer, and
0 ≤m ≤n.
If v is any nonnegative integer such that
n ≡vak
(mod d),
then vak ≡uak
(mod d), and so v ≡u
(mod d), that is, v = u + ℓd for
some nonnegative integer ℓ. If
n −vak = n −(u + ℓd)ak ≥0,
then
0 ≤ℓ≤
 n
dak
−u
d

=
 m
ak

= r ≤m.
Let π be a partition of n into parts belonging to A. If π contains exactly v
parts equal to ak, then n−vak ≥0 and n−vak ≡0
(mod d), since n−vak
is a sum of elements in {a1, . . . , ak−1} and each of the elements in this set
is divisible by d. Therefore, v = u + ℓd, where 0 ≤ℓ≤r. Consequently,
we can divide the partitions of n with parts in A into r + 1 classes, where,
for each ℓ= 0, 1, . . . , r, a partition belongs to class ℓif it contains exactly
u + ℓd parts equal to ak. The number of partitions of n with exactly u + ℓd
parts equal to ak is exactly the number of partitions of n −(u + ℓd)ak into
parts belonging to the set {a1, . . . , ak−1}, or, equivalently, the number of
partitions of
n −(u + ℓd)ak
d
= m −ℓak

460
15. Partition Asymptotics
into parts belonging to A′, which is exactly pA′(m −ℓak). Therefore,
pA(n)
=
r

ℓ=0
pA′(m −ℓak)
=

1
k−1
i=1 a′
i

r

ℓ=0
(m −ℓak)k−2
(k −2)!
+ O(mk−3)

=

dk−1
k−1
i=1 ai

r

ℓ=0
(m −ℓak)k−2
(k −2)!
+ O(nk−2).
We evaluate the sum as follows. Since
r

ℓ=0
ℓj =
rj+1
(j + 1) + O(rj)
by Exercise 5, and since
k−2

j=0
(−1)j
k −1
j + 1

= −
k−1

j=1
(−1)j
k −1
j

= 1,
we have
r

ℓ=0
(m −ℓak)k−2
(k −2)!
=
1
(k −2)!
r

ℓ=0
k−2

j=0
k −2
j

mk−2−j(−ℓak)j
=
1
(k −2)!
k−2

j=0
k −2
j

mk−2−j(−ak)j
r

ℓ=0
ℓj
=
1
(k −2)!
k−2

j=0
k −2
j

mk−2−j(−ak)j
 rj+1
j + 1 + O(rj)

=
1
(k −2)!
k−2

j=0
k −2
j

mk−2−j(−ak)j

mj+1
aj+1
k
(j + 1)
+ O(mj)

=
mk−1
ak
k−2

j=0
k −2
j

(−1)j
(k −2)!(j + 1) + O(mk−2)
=
mk−1
ak
k−2

j=0
(−1)j
(k −2 −j)!j!(j + 1) + O(mk−2)
=
mk−1
ak
k−2

j=0
(−1)j
(k −1 −(j + 1))!(j + 1)! + O(mk−2)

15.2 Partition Functions for Finite Sets
461
=
mk−1
ak(k −1)!
k−2

j=0
(−1)j
k −1
j + 1

+ O(mk−2)
=
mk−1
ak(k −1)! + O(mk−2).
Therefore,
pA(n)
=

dk−1
k−1
i=1 ai

r

ℓ=0
(m −ℓak)k−2
(k −2)!
+ O(nk−2)
=

dk−1
k−1
i=1 ai
 
mk−1
ak(k −1)! + O(mk−2)

+ O(nk−2)
=

1
k
i=1 ai

(n −uak)k−1
(k −1)!
+ O(nk−2)
=

1
k
i=1 ai

nk−1
(k −1)! + O(nk−2).
This completes the proof. 2
Corollary 15.1 Let pk(n) denote the number of partitions of n into at
most k parts. Then
pk(n) ∼
nk−1
k!(k −1)! + O(nk−2).
Proof. We know that pk(n) is also equal to the number of partitions of n
into parts no greater than k. The result follows from Theorem 15.2 applied
to the set A = {1, 2, . . . , k}. 2
Corollary 15.2 Let A be an inﬁnite set of positive integers with gcd(A) =
1. Then
lim
n→∞
log pA(n)
log n
= ∞.
Proof. For every suﬃciently large integer k there exists a subset Fk of
A of cardinality k such that gcd(Fk) = 1. By Theorem 15.2,
pA(n) ≥pFk(n) =
nk−1
(k −1)! 
a∈Fk a + O

nk−2
,
and so there exists a positive constant ck such that
pA(n) ≥cknk−1

462
15. Partition Asymptotics
for all suﬃciently large integers n. Then
log pA(n) ≥log pFk(n) ≥(k −1) log n + log ck.
Dividing by log n, we obtain
lim inf
n→∞
log pA(n)
log n
≥k −1.
This is true for all suﬃciently large k, and so
lim
n→∞
log pA(n)
log n
= ∞.
This completes the proof. 2
We can also use generating functions to compute partition functions of
ﬁnite sets. For example, let A = {1, 2, 4}. By Theorem 15.2, we have
pA(n) ∼n2
16 + O(n).
Using the partial fraction decomposition of the generating function, we can
obtain an exact formula for pA(n) that is stronger than this asymptotic
estimate. We have
∞

n=0
pA(n)xn
=
1
(1 −x)(1 −x2)(1 −x4)
=
1
(1 −x)3(1 + x)2(1 + x2)
=
9
32(1 −x) +
1
4(1 −x)2 +
1
8(1 −x)3
+
5
32(1 + x) +
1
16(1 + x)2 +
1 + x
8(1 + x2).
We write each partial fraction as a power series:
9
32(1 −x)
=
∞

n=0
9
32xn
1
4(1 −x)2
=
∞

n=0
(n + 1)
4
xn
1
8(1 −x)3
=
∞

n=0
(n + 2)(n + 1)
16
xn
5
32(1 + x)
=
∞

n=0
(−1)n5
32
xn

15.2 Partition Functions for Finite Sets
463
1
16(1 + x)2
=
∞

n=0
(−1)n(n + 1)
16
xn
1 + x
8(1 + x2)
=
∞

n=0
(−1)n(1 + x)
8
x2n
=
∞

n=0
(−1)n
8
x2n +
∞

n=0
(−1)n
8
x2n+1
=
∞

n=0
(−1)[n/2]
8
xn.
Therefore,
pA(n)
=
9
32 + n + 1
4
+ (n + 2)(n + 1)
16
+ (−1)n5
32
+ (−1)n(n + 1)
16
+ (−1)[n/2]
8
=
n2 + (7 + (−1)n)n
16
+ 21 + (−1)n7 + (−1)[n/2]4
32
.
If n is even, then
pA(n)
=
n2 + 8n + 16
16
+ (−1)[n/2] −1
8
=
*
(n+4)2
16
if n ≡0
(mod 4),
(n+4)2
16
−1
4
if n ≡2
(mod 4).
If n is odd, then
pA(n)
=
n2 + 6n + 9
16
+ (−1)[n/2] −1
8
=
*
(n+3)2
16
if n ≡1
(mod 4),
(n+3)2
16
−1
4
if n ≡3
(mod 4).
Exercises
1. Let p2(n) denote the number of partitions of n into at most 2 parts.
Prove that
p2(n) =
.n
2
/
+ 1.
2. Let a ≥2 and A = {1, a}. Prove that
pA(n) =
.n
a
/
+ 1.

464
15. Partition Asymptotics
3. Let A = {2, 3}. Prove that
pA(n) =
  n
6

+ 1
if n is even and n ≥2,
 n−3
6

+ 1
if n is odd and n ≥3.
4. Let A = {2, a}, where a is an odd integer, a ≥3. Compute pA(n).
5. Prove that
r

ℓ=0
ℓj =
rj+1
(j + 1) + O(rj).
6. Let A = {1, 2, 3}. Let ρ = (−1 + i
√
3)/2. Conﬁrm the partial fraction
decomposition
∞

n=1
pA(n)xn
=
1
(1 −x)(1 −x2)(1 −x3)
=
1
(1 −x)3(1 + x)(1 −ρx)(1 −ρ2x)
=
1
6(1 −x)3 +
1
4(1 −x)2 +
17
72(1 −x)
+
1
8(1 + x) +
1
9(1 −ρx) +
1
9(1 −ρ2x).
Show that this implies that
pA(n)
=
(n + 2)(n + 1)
12
+ n + 1
4
+ 17
72 + (−1)n
8
+ 1
9(ρn + ρ2n)
=
(n + 3)2
12
−7
72 + (−1)n
8
+ 1
9(ρn + ρ2n)
=
(n + 3)2
12
+ r(n),
where
|r(n)| < 1
2.
Conclude that pA(n) is equal to the integer closest to (n + 3)2/12.
7. Let pk(n) denote the number of partitions of n into at most k parts.
Show that the average number of parts in a partition of n is
p(n) =
1
p(n)
n

k=1
k (pk(n) −pk−1(n)) .
Remark. Erd˝os and Lehner [35] proved that p(n) ∼c−1
0
√n log n.

15.3 Upper and Lower Bounds for log p(n)
465
15.3
Upper and Lower Bounds for log p(n)
In this section we give Erd˝os’s elementary proof that log p(n) ∼c0
√n. We
begin with some estimates for exponential functions.
Deﬁne p(0) = 1 and p(−n) = 0 for all n ≥1.
Lemma 15.1 If 0 < ℓ≤n, then
√n −
ℓ
2√n −
ℓ2
2n3/2 ≤
√
n −ℓ< √n −
ℓ
2√n.
Proof. If 0 < x ≤1, then
1 −x
2 −x2
2 ≤(1 −x)1/2 < 1 −x
2 .
The result follows by letting x = ℓ/n. 2
Lemma 15.2 If x > 0, then
e−x
(1 −e−x)2 < 1
x2 .
If 0 < x ≤1, then
e−x
(1 −e−x)2 > 1
x2 −2.
Proof. The power series expansion for ex gives
ex/2 −e−x/2
=
2
∞

k=0
1
(2k + 1)!
x
2
2k+1
=
x + x3
∞

k=1
x2k−2
(2k + 1)!22k .
If x > 0, then
ex/2 −e−x/2 > x,
and so
e−x
(1 −e−x)2 =
1

ex/2 −e−x/22 < 1
x2 .
If 0 < x ≤1, then
ex/2 −e−x/2 < x + x3
∞

k=1
1
22k < x + x3 <
x
1 −x2 ,

466
15. Partition Asymptotics
and so
e−x
(1 −e−x)2 =
1

ex/2 −e−x/22 >
 1
x −x
2
> 1
x2 −2.
2
Lemma 15.3 Let c be a positive real number and let n be a positive integer.
Then
∞

k=1
e−
ck
2√n
(1 −e−
ck
2√n )2 < 2π2n
3c2 .
If n ≥c2/4, then
∞

k=1
e−
ck
2√n
(1 −e−
ck
2√n )2 > 2π2n
3c2 −8√n
c
.
Proof. Let k be a positive integer and
x =
ck
2√n.
By Lemma 15.2,
e−
ck
2√n
(1 −e−
ck
2√n )2 =
e−x
(1 −e−x)2 < 1
x2 = 4n
c2k2 ,
and so
∞

k=1
e−
ck
2√n
(1 −e−
ck
2√n )2 < 4n
c2
∞

k=1
1
k2 = 4π2n
6c2
= 2π2n
3c2 .
If √n ≥c/2 and 1 ≤k ≤2√n/c, then 0 < x ≤1 and, by Lemma 15.2,
e−
ck
2√n
(1 −e−
ck
2√n )2 > 1
x2 −2 = 4n
c2k2 −2.
Therefore,
∞

k=1
e−
ck
2√n
(1 −e−
ck
2√n )2
>

k≤2√n/c
e−
ck
2√n
(1 −e−
ck
2√n )2
>

k≤2√n/c
 4n
c2k2 −2


15.3 Upper and Lower Bounds for log p(n)
467
≥
4n
c2


∞

k=1
1
k2 −

k>2√n/c
1
k2

−4√n
c
=
2π2n
3c2 −4n
c2
∞

k=[2√n/c]+1
1
k2 −4√n
c
.
For k ≥1 we have
1
k2 <
1
k2 −1/4 =
# k+1/2
k−1/2
dt
t2 ,
and so
4n
c2
∞

k=[2√n/c]+1
1
k2
<
4n
c2
# ∞
[2√n/c]+1/2
dt
t2 = 4n
c2
1
[2√n/c] + 1/2
<
4n
c2
1
2√n/c −1/2 ≤4√n
c
.
In the last inequality we used the fact that √n ≥c/2. Therefore,
∞

k=1
e−
ck
2√n
(1 −e−
ck
2√n )2 > 2π2n
3c2 −8√n
c
.
2
Lemma 15.4 Let 0 ≤t < 1. Then
∞

v=1
vtv =
t
(1 −t)2
and
∞

v=1
v3tv = t3 + 4t2 + t
(1 −t)4
≤
6t
(1 −t)4 .
Proof. Diﬀerentiating the power series
1
1 −t =
∞

v=0
tv,
we obtain
1
(1 −t)2
=
∞

v=1
vtv−1,

468
15. Partition Asymptotics
2
(1 −t)3
=
∞

v=2
v(v −1)tv−2,
6
(1 −t)4
=
∞

v=3
v(v −1)(v −2)tv−3
=
∞

v=3
(v3 −3v(v −1) −v)tv−3,
and so
∞

v=3
v3tv =
6t3
(1 −t)4 + 3t2
∞

v=3
v(v −1)tv−2 + t
∞

v=3
vtv−1.
Then
∞

v=1
v3tv
=
6t3
(1 −t)4 + 3t2
∞

v=2
v(v −1)tv−2 + t
∞

v=1
vtv−1
=
6t3
(1 −t)4 +
6t2
(1 −t)3 +
t
(1 −t)2
=
t3 + 4t2 + t
(1 −t)4
≤
6t
(1 −t)4 .
2
Theorem 15.3
log p(n) ∼c0
√n.
Proof. We shall use induction to obtain upper and lower bounds on p(n).
First we prove that
p(n) ≤ec0
√n
(15.5)
for all nonnegative integers n. This is clearly true for n = 0 and n = 1. Let
n ≥2, and assume that the inequality holds for all integers strictly smaller
than n. The notation 
kv≤n means the sum over all positive integers k
and v such that kv ≤n. We have
np(n)
=

kv≤n
vp(n −kv) ≤

kv≤n
vec0
√n−kv
≤

kv≤n
vec0
√n−c0kv
2√n
(by Lemma 15.1)

15.3 Upper and Lower Bounds for log p(n)
469
≤
ec0
√n
∞

k=1
∞

v=1
v

e−c0k
2√n
v
=
ec0
√n
∞

k=1
e−c0k
2√n

1 −e−c0k
2√n
2
(by Lemma 15.4)
<
2π2
3c2
0

nec0
√n
(by Lemma 15.3)
=
nec0
√n.
This gives the upper bound (15.5).
Next we shall prove that for every ε with
0 < ε < c0
there exists a constant A = A(ε) > 0 such that
p(n) ≥Ae(c0−ε)√n
(15.6)
for all positive integers n. We begin by letting A = e−c0. Then (15.6) holds
for n = 1, since p(1) = 1 > e−ε = Aec0−ε.
Let n ≥2, and assume that (15.6) holds for all integers less than n. Then
np(n)
=

kv≤n
vp(n −kv)
≥
A

kv≤n
ve(c0−ε)√n−kv
≥
A

kv≤n
ve(c0−ε)√n−
kv
2√n −k2v2
2n3/2

(by Lemma 15.1)
=
Ae(c0−ε)√n 
kv≤n
ve−(c0−ε)
kv
2√n + k2v2
2n3/2

.
We shall show that

kv≤n
ve−(c0−ε)
kv
2√n + k2v2
2n3/2

≥n.
Since e−x ≥1 −x, we have
e−
(c0−ε) k2v2
2n3/2

≥1 −(c0 −ε)k2v2
2n3/2
,
and so

kv≤n
ve−(c0−ε)
kv
2√n + k2v2
2n3/2


470
15. Partition Asymptotics
≥

kv≤n
ve−(c0−ε)kv
2√n
−(c0 −ε)
2n3/2

kv≤n
k2v3e−(c0−ε)kv
2√n
=
S1(n) −(c0 −ε)
2n3/2 S2(n).
We shall estimate the sums S1(n) and S2(n).
If kv > n, then
(c0 −ε)kv
2√n
> (c0 −ε)√n
2
> (c0 −ε)
2
> 0.
Since
e−t ≪t−6
for t ≥(c0 −ε)/2,
we have

kv>n
ve−(c0−ε)kv
2√n
≪

kv>n
v
(c0 −ε)kv
2√n
−6
≪
n3 
kv>n
1
k6v5
≪
n3 
kv>n
1
(kv)7/2k5/2v3/2
<
1
√n
∞

k=1
1
k5/2
∞

v=1
1
v3/2
≪
1
√n.
Then
S1(n)
=

kv≤n
ve−(c0−ε)kv
2√n
=
∞

k=1
∞

v=1
ve−(c0−ε)kv
2√n
−

kv>n
ve−(c0−ε)kv
2√n
=
∞

k=1
e−(c0−ε)k
2√n

1 −e−(c0−ε)k
2√n
2 + O
 1
√n

(by Lemma 15.4)
>
2π2n
3(c0 −ε)2 + O(√n)
(by Lemma 15.3)
>

1 + 2ε
c0

n + O(√n),

15.3 Upper and Lower Bounds for log p(n)
471
since
2π2
3(c0 −ε)2
=

c0
c0 −ε
2
=

1 +
ε
c0 −ε
2
>
1 +
2ε
c0 −ε > 1 + 2ε
c0
.
We estimate the sum S2(n) as follows:
S2(n)
=

kv≤n
k2v3e−(c0−ε)kv
2√n
≤
n

k=1
k2
∞

v=1
v3e−(c0−ε)kv
2√n
≤
6
n

k=1
k2e−(c0−ε)k
2√n

1 −e−(c0−ε)k
2√n
4
(by Lemma 15.4)
=
6
n

k=1
e−(c0−ε)k
2√n

1 −e−(c0−ε)k
2√n
2
k2

1 −e−(c0−ε)k
2√n
2
<
6
n

k=1

4n
(c0 −ε)2k2

k2

1 −e−(c0−ε)k
2√n
2
(by Lemma 15.2)
≪
n
n

k=1
1

1 −e−(c0−ε)k
2√n
2 .
Let
x = (c0 −ε)k
2√n
.
If 1 ≤k ≤√n, then 0 < x < c0/2 and
1 −e−x =
# x
0
e−tdt ≥xe−x > xe−c0/2,
and so

1 −e−(c0−ε)k
2√n
2
=

1 −e−x2 > x2e−c0 = e−c0(c0 −ε)2k2
4n
.
Therefore,

1≤k≤√n
1

1 −e−(c0−ε)k
2√n
2 <
4ec0n
(c0 −ε)2

1≤k≤√n
1
k2 ≪n.

472
15. Partition Asymptotics
If k > √n, then

√n<k≤n
1

1 −e−(c0−ε)k
2√n
2 <

√n<k≤n
1

1 −e−(c0−ε)
2
2 ≪n.
Therefore,
S2(n) ≪n2.
Since
S1(n) > 0
and
S2(n) > 0,
we have
S1(n) −(c0 −ε)
2n3/2 S2(n)
≥

1 + 2ε
c0

n + O(√n) −(c0 −ε)
2n3/2 O(n2)
>

1 + 2ε
c0

n −c1
√n
for some positive constant c1. Then
np(n)
≥
Ae(c0−ε)√n

S1(n) −(c0 −ε)k
2n3/2
S2(n)

≥
Ane(c0−ε)√n + A√ne(c0−ε)√n
2ε√n
c0
−c1

>
Ane(c0−ε)√n
if we choose A > 0 small enough that (15.6) holds for all n ≤(c0c1/2ε)2.
It follows from (15.5) and (15.6) that for every ε > 0 there exists a
constant A such that
(c0 −ε)√n + log A < log p(n) < c0
√n
for all positive integers n, and so log p(n) ∼c0
√n. This completes the proof
of the theorem. 2
Exercises
1. Prove that the recursion formula (15.3) is equivalent to
np(n) =
∞

ν=1
σ(ν)p(n −ν).

15.4 Notes
473
15.4
Notes
In 1918 Hardy and Ramanujan [59, 58] published the asymptotic formula
for the partition function. Uspensky [146] obtained the same result indepen-
dently in 1920. Both papers used complex variables and modular functions
to deduce the asymptotic estimate p(n) ∼(4n
√
3)−1ec0
√n. In their 1918
paper, Hardy and Ramanujan wrote,
it is equally possible to prove [log p(n) ∼c0
√n] by reasoning of
a more elementary, though more special character; we have a
proof, for example, based on the identity
np(n) =
∞

ν=1
σ(ν)p(n −ν),
(15.7)
where σ(ν) is the sum of the divisors of ν, and a process of
induction.
Many years later, however, Hardy wrote in his book Ramanujan [52, p.
114],
It is actually true that log p(n) ∼π
-
(2n/3) . . . , but we cannot
prove this very simply.
Hardy and Ramanujan clearly had no elementary proof of the asymptotic
formula (15.1); in their 1918 paper they wrote that
we are at present unable to obtain, by any method which does
not depend upon Cauchy’s theorem, a result as precise as [p(n) ∼
ec0
√n/(4
√
3)n], a result, that is to say, which is “vraiment asymp-
totique.”
Erd˝os’s proof of the asymptotic formula for p(n), published in 1942 in [32],
is a tour de force of elementary methods in number theory. This proof is
not as famous nor as controversial as the elementary proof of the prime
number theorem, but it is impressive in its depth and technical diﬃculty.
It shows that the asymptotic formula for p(n) is simply a consequence of
the elementary recursion formula (15.7), and is independent of any deep
analytic properties of modular functions.
Knessl and Keller [80] develop Erd˝os’s method and apply the recursion
formula for the partition function to derive formal asymptotic expansions.
Grosswald [42] and Hua [68] have presented Erd˝os’s elementary proof
of (15.2). There is a diﬀerent elementary proof of the upper bound log p(n) <
π
-
2n/3 in unpublished lectures of Siegel on analytic number theory; Siegel’s
proof appears in Knopp [81, pp. 88–90]. Analytic proofs of (15.1) can be
found in Apostol [4], Knopp [81], and Rademacher [119].
The standard proof of Theorem 15.2 uses the partial fraction decomposi-
tion of a generating function. The proof in this book is due to Nathanson [107].

474
15. Partition Asymptotics
Let Pk(n) = pk(n) −pk−1(n) denote the number of partitions of n into
exactly k parts. Erd˝os [33] proved that for ﬁxed n, the maximum value of
Pk(n) occurs for k0 ∼c−1
0 n1/2 log n. This had been conjectured by Auluck,
Chowla, and Gupta [6]. Using hard analysis, Szekeres [137, 138] proved that
for suﬃciently large n, the ﬁnite sequence Pk(n) is unimodal in the sense
that there exists an integer k0 such that Pk−1(n) ≤Pk(n) for 1 ≤k ≤k0
and Pk−1(n) ≥Pk(n) for k0 + 1 ≤k ≤n. It would be very interesting
to have an elementary proof of the unimodality of the partition function
Pk(n).
Rademacher [117, 118] obtained a convergent series for p(n) of the form
p(n) =
1
π
√
2
∞

k=1
k1/2Ak(n) d
dn
sinh

πλn
k
9
2
3

λn
.
After studying the original paper of Hardy and Ramanujan, Selberg (un-
published) independently proved the same formula. Many years later he
wrote [130], “I am inclined to believe that Rademacher and I were the only
ones to have studied this paper thoroughly since the time it was written.”

16
An Inverse Theorem for Partitions
16.1
Density Determines Asymptotics
Let A be a set of integers, and let A(x) denote the number of positive
elements of A that do not exceed x. Recall that A(x) is called the counting
function of A. Then 0 ≤A(x) ≤x, and so 0 ≤A(x)/x ≤1 for all x. The
set A has asymptotic density α if
lim
x→∞
A(x)
x
= α.
For example, the set of all positive integers has density 1, and every ﬁnite
set has density 0. The set of even integers has density 1/2. By Chebyshev’s
theorem (Theorem 8.2), the set of prime numbers has density 0.
If A has density α, then for every ε > 0 there exists a number x0(ε) such
that for all x ≥x0(ε),

A(x)
x
−α
 < ε,
or, equivalently,
(α −ε)x < A(x) < (α + ε)x.
(16.1)
There exists an integer k0(ε) such that if ak ∈A and k ≥k0(ε), then
ak ≥x0(ε). Setting x = ak in inequality (16.1), we obtain
(α −ε)ak < k < (α + ε)ak,
and so
k
α + ε < ak <
k
α −ε.

476
16. An Inverse Theorem for Partitions
In Chapter 15 we proved that log p(n) ∼c0
√n. In this section we shall
prove that if A is any set of integers of density α > 0 and gcd(A) = 1, then
log pA(n) ∼c0
√αn.
(16.2)
In Section 16.2 we prove the converse: If A is any set of positive integers
whose partition function pA(n) satisﬁes (16.2) for some α > 0, then A has
asymptotic density α.
A set of positive integers is coﬁnite if it contains all but ﬁnitely many
positive integers. We begin with a simple result about partition functions
of coﬁnite sets.
Lemma 16.1 Let A be a coﬁnite set of positive integers. Then
log pA(n) ∼c0
√n.
Proof. If A is coﬁnite, then A contains all suﬃciently large integers.
Choose a positive integer ℓ> 1 such that A contains all integers greater
than ℓ, that is,
B = {n ≥ℓ+ 1} ⊆A.
Then
pB(n) ≤pA(n) ≤p(n).
Since log p(n) ∼c0
√n, it suﬃces to prove that log pB(n) ∼c0
√n.
Consider the ﬁnite set F = {1, 2, . . . , ℓ}. Since gcd(F) = 1, Theorem 15.2
implies that there exists a constant c ≥1 such that pF (n) ≤cnℓ−1 for all
positive integers n. Each part of an unrestricted partition of n belongs to F
or to B, and so every partition of n is uniquely of the form n = (n−m)+m,
where n −m is a sum of elements of F and m is a sum of elements of B.
By Exercise 4, the partition function pB(n) is increasing for n ≥1, and so
p(n)
=
n

m=0
pF (n −m)pB(m)
≤
cnℓ−1
n

m=0
pB(m)
≤
2cnℓpB(n)
≤
2cnℓp(n).
Taking logarithms and dividing by c0
√n, we have
log p(n)
c0
√n
≤
log 2c + ℓlog n
c0
√n
+ log pB(n)
c0
√n
≤
log 2c + (ℓ−1) log n
c0
√n
+ log p(n)
c0
√n .
Letting n go to inﬁnity, we obtain log pB(n) ∼c0
√n. This completes the
proof.

16.1 Density Determines Asymptotics
477
Theorem 16.1 Let A be a set of positive integers. If A has density α > 0
and gcd(A) = 1, then the partition function pA(n) satisﬁes the asymptotic
equation
log pA(n) ∼c0
√αn.
Proof. Let A = {ak}∞
k=1, where a1 < a2 < · · ·. Let 0 < ε < α. Since
d(A) = α and gcd(A) = 1, there exists an integer ℓ0 = ℓ0(ε) such that
gcd{ak : 1 ≤k ≤ℓ0} = 1 and
k
α + ε < ak <
k
α −ε
(16.3)
for all k > ℓ0.
We begin by deriving the upper bound
lim sup
n→∞
log pA(n)
c0
√αn
≤1.
Let F = {a1, a2, . . . , aℓ0} and B = {ak ∈A : k ≥ℓ0 + 1}. Let m be a
positive integer, m ≤n, and let
m = ak1 + ak2 + · · · + akr
be a partition of m with parts in B. To this partition of m we associate
the partition
n′ = k1 + k2 + · · · + kr.
By (16.3) we have ki < (α + ε)aki, and so
n′
<
(α + ε)ak1 + (α + ε)ak2 + · · · + (α + ε)akr
=
(α + ε)m
≤
(α + ε)n.
This establishes a one-to-one mapping from partitions of m with parts in
B to partitions of integers n′ less than (α + ε)n. Since the unrestricted
partition function p(n) is increasing, we have
pB(m)
≤

1≤n′≤(α+ε)n
p(n′)
≤
(α + ε)np([(α + ε)n])
<
2np([(α + ε)n]).
Recall that A = F ∪B, where F consists of ℓ0 relatively prime positive
integers. By Theorem 15.2, there exists a constant c such that
pF (n) ≤cnℓ0−1

478
16. An Inverse Theorem for Partitions
for every positive integer n. Every partition of n with parts in A decomposes
uniquely into a partition of m with parts in B and a partition of n −m
with parts in F for some nonnegative integer m ≤n. Then
pA(n)
=
n

m=0
pF (n −m)pB(m)
≤
cnℓ0−1
n

m=0
pB(m)
≤
cnℓ0−1
n

m=0
2np([(α + ε)n])
≤
4cnℓ0+1p([(α + ε)n]).
Since log p(n) ∼c0
√n, it follows that for every ε > 0 there exists an integer
n0(ε) such that
log p([(α + ε)n]) < (1 + ε)c0
-
[(α + ε)n]
for n ≥n0(ε). Therefore,
log pA(n)
≤
log 4c + (ℓ0 + 1) log n + log p([(α + ε)n])
<
log 4c + (ℓ0 + 1) log n + (1 + ε)c0
-
(α + ε)n
for n ≥ℓ0(ε). Dividing by c0
√αn, we obtain
log pA(n)
c0
√αn
≤log 4c + k0 log n
c0
√αn
+ (1 + ε)
2
1 + ε
α,
and so
lim sup
n→∞
log pA(n)
c0
√αn
≤(1 + ε)
2
1 + ε
α.
This inequality is true for all ε > 0, and so
lim sup
n→∞
log pA(n)
c0
√αn
≤1.
Next we obtain the lower bound
lim inf
n→∞
log pA(n)
c0
√αn
≥1.
Since gcd(A) = 1, Theorem 1.16 implies that pA(n) ≥1 for all suﬃciently
large n. For 0 < ε < α, there exists a positive integer ℓ0 = ℓ0(ε) such that
gcd{ak : 1 ≤k ≤ℓ0} = 1 and
k
α + ε < ak <
k
α −ε

16.1 Density Determines Asymptotics
479
for all k > ℓ0.
Let p′(n) denote the number of partitions of n into parts greater than
ℓ0. To every partition
n = k1 + · · · + kr
with k1 ≥· · · ≥kr > ℓ0,
we associate the partition
m = ak1 + · · · + akr.
Inequality (16.3) implies that
m <
n
α −ε.
This is a one-to-one mapping from partitions of n with parts greater than
ℓ0 to partitions of integers m < n/(α −ε) with parts in A. Therefore,
p′(n)
≤

m<
n
α−ε
pA(m)
<
n
α −ε max

pA(m) : m ≤
n
α −ε

≤
npA(un)
α −ε ,
where, by Exercise 7 of Section 15.1, un is an integer in the bounded interval
n
α −ε −a1 < un ≤
n
α −ε.
The sequence {un}∞
n=1 is not necessarily increasing, but
lim
n→∞un = ∞.
Let d be the unique positive integer such that
0 < (α −ε)a1 ≤d < (α −ε)a1 + 1.
For every i, j ≥1,
u(i+j)d −uid >
(i + j)d
α −ε
−a1

−
id
α −ε =
jd
α −ε −a1 ≥(j −1)a1.
It follows that u(i+1)d > uid, and so the sequence {uid}∞
i=1 is strictly in-
creasing. Similarly,
u(i+j)d −uid < (i + j)d
α −ε −

id
α −ε −a1

=
jd
α −ε +a1 < (j +1)a1 +
j
α −ε.

480
16. An Inverse Theorem for Partitions
Choose N0 such that pA(n) ≥N0 for all n ≥N0. Let i0 be the unique
integer such that
N0
a1
+ 1 ≤i0 < N0
a1
+ 2.
Then
uid −u(i−i0)d > (i0 −1)a1 ≥N0
for all i ≥i0. For every integer n ≥i0d there exists an integer i ≥i0 such
that
uid ≤n < u(i+1)d.
Then
n −u(i−i0)d < u(i+1)d −u(i−i0)d < (i0 + 2)d + i0 + 1
α −ε
and
n −u(i−i0)d ≥uid −u(i−i0)d > N0.
Therefore,
pA(n −u(i−i0)d) ≥1.
By Exercise 6 of Section 15.1,
pA(n) ≥pA(u(i−i0)d) > (α −ε)p′((i −i0)d)
(i −i0)d
.
Since
n < u(i+1)d ≤(i + 1)d
α −ε ,
it follows that
(i −i0)d > (α −ε)n −(i0 + 1)d
and
pA(n) > (α −ε)p′((α −ε)n −(i0 + 1)d)
(i −i0)d
.
Since p′(n) is the partition function of a coﬁnite subset of the positive
integers, Lemma 16.1 implies that for n suﬃciently large,
log pA(n)
>
log p′((α −ε)n −(i0 + 1)d)) + log(α −ε) −log(i −i0)d
>
(1 −ε)c0
-
(α −ε)n −(i0 + 1)d + log(α −ε) −log(i −i0)d.
Dividing by c0
√αn, we obtain
lim inf
n→∞
log pA(n)
c0
√αn
≥(1 −ε)
-
1 −ε/α.
This inequality holds for 0 < ε < α, and so
lim inf
n→∞
log pA(n)
c0
√αn
≥1.
This completes the proof.

16.1 Density Determines Asymptotics
481
Exercises
1. Prove that the set {2k : k ≥0} has density 0. Prove that the set
{2k3ℓ: k, ℓ≥0} has density 0.
2. Let A be a set of positive integers, and let B = N \ A be the set of
positive integers not in A. Prove that if d(A) = α, then d(B) = 1−α.
3. In this exercise we construct a set A that does not have a density.
We denote by (x, y] the set of integers n such that x < n ≤y. Let
N1 < N2 < N3 < · · · be a strictly increasing sequence of positive
integers such that limr→∞Nr+1/Nr = ∞, and let
A =
∞
,
r=1
(N2r−1, N2r].
Prove that
lim
r→∞
A(N2r)
N2r
= 1
and
lim
r→∞
A(N2r+1)
N2r+1
= 0.
Since lim supx→∞A(x)/x = 1 and lim infx→∞A(x)/x = 0, the set A
does not have an asymptotic density.
Hint: Show that A(N2r) ≥N2r −N2r−1 and A(N2r+1) ≤N2r.
4. We say that a partition a1 + a2 + · · · + ar has a unique largest part if
a1 > a2 ≥· · · ≥ar. Let n0 be a positive integer, and let A be the set
of all integers greater than or equal to n0. Show that pA(n) = 1 for
n0 ≤n < 2n0. Let n ≥n0. To every partition π of n we can associate
a partition of n + 1 by adding 1 to the largest part of π. Show that
this map is a bijection between partitions of n and partitions of n+1
with a unique largest part. Deduce that pA(n) is increasing for n ≥1,
and strictly increasing for suﬃciently large n.
5. Let a1, . . . , aℓ, and m be integers such that
1 ≤a1 < · · · < aℓ≤m
and
(a1, . . . , aℓ, m) = 1.
Let A be the set of all positive integers a such that a ≡ai
(mod m)
for some i = 1, . . . , ℓ. Prove that
log pA(n) ∼c0
2
ℓn
m .

482
16. An Inverse Theorem for Partitions
6. Prove that if the set A of positive integers has positive density, then
d(A) = lim
n→∞
log pA(n)
log p(n)
2
.
7. Let A be a set of positive integers. The upper asymptotic density of
A is
dU(A) = lim sup
n→∞
A(n)
n
.
Prove that if gcd(A) = 1 and dU(A) ≤α, then
lim sup
n→∞
log pA(n)
c0
√n
≤√α.
8. Let A be a set of positive integers. The lower asymptotic density of
A is
dL(A) = lim inf
n→∞
A(n)
n
.
Prove that if gcd(A) = 1 and dL(A) ≥α, then
lim inf
n→∞
log pA(n)
c0
√n
≥√α.
9. Let A be a set of positive integers with gcd(A) = 1. Prove that if
d(A) = 0, then log pA(n) = o(√n).
16.2
Asymptotics Determine Density
The goal of this section is an inverse theorem for partitions. We shall prove
that the asymptotics of the partition function pA(n) determines the density
of the set A.
We begin with some remarks about generating functions. If a is a positive
integer and |x| < 1, then the geometric progression
(1 −xa)−1 = 1 + xa + x2a + x3a + · · ·
converges absolutely. If A is a ﬁnite set of positive integers, then

a∈A
(1 −xa)−1
=

a∈A

1 + xa + x2a + x3a + · · ·

=
∞

n=0
pA(n)xn,
where pA(n) is the partition function for A.

16.2 Asymptotics Determine Density
483
If A is an inﬁnite set of positive integers and |x| < 1, then the inﬁnite
product

a∈A
(1 −xa)−1
converges absolutely, since

a∈A
|x|a ≤
∞

a=1
|x|a =
|x|
1 −|x| < ∞
and
f(x) =

a∈A
(1 −xa)−1 =
∞

n=0
pA(n)xn.
This function is called the generating function for the partition function
pA(n).
Theorem 16.2 Let A be a set of positive integers with gcd(A) = 1. Let
pA(n) denote the number of partitions of n with parts in A. If there exists
a number α > 0 such that
log pA(n) ∼c0
√αn,
then the set A has density α.
Proof. The proof uses an Abelian theorem (Theorem 16.3) and a Taube-
rian theorem (Theorem 16.4) that we prove in the next section. The gen-
erating function
f(x) =
∞

n=1
pA(n)xn =

a∈A
(1 −xa)−1
converges for |x| < 1. Since
log pA(n) ∼c0
√αn = 2
2
π2αn
6
,
Theorem 16.3 immediately implies that
log f(x) ∼
π2α
6(1 −x).
Applying the Taylor series
−log(1 −x) =
∞

k=1
xk
k

484
16. An Inverse Theorem for Partitions
for |x| < 1, we have
log f(x) = −

a∈A
log(1 −xa) =

a∈A
∞

k=1
xak
k
=
∞

n=1
bnxn,
where
bn =

a∈A
n=ak
1
k =

a∈A
a|n
a
n ≥0.
By Theorem 16.4,
SB(x) =

n≤x
bn ∼π2αx
6
.
We deﬁne the remainder function r(x) by
SB(x) = π2αx
6
(1 + r(x)).
The function SB(x) is an increasing, nonnegative function such that
SB(x) = 0 for x < 1 and
SB(x)
=

n≤x

a∈A
n=ak
1
k
=

k≤x
1
k

a∈A
ak≤x
1
=

k≤x
1
k A
x
k

,
where A(x) is the counting function of the set A. By M¨obius inversion
(Exercise 7 in Section 6.3), we have
A(x) =

k≤x
µ(k)
k
SB
x
k

.
For every ε > 0 there exists a number x0 = x0(ε) such that the remainder
function r(x) satisﬁes the inequality |r(x)| < ε for all x ≥x0. If k ≤x/x0,
then x/k ≥x0 and |r (x/k)| < ε. If k > x/x0, then x/k < x0 and 0 ≤
SB(x/k) ≤SB(x0). Therefore,
A(x)
=

k≤x
µ(k)
k
SB
x
k

=

k≤x/x0
µ(k)
k
π2αx
6k

1 + r
x
k

+

x/x0<k≤x
µ(k)
k
SB
x
k


16.2 Asymptotics Determine Density
485
=
π2αx
6

k≤x/x0
µ(k)
k2
+ π2αx
6

k≤x/x0
µ(k)
k2 r
x
k

+

x/x0<k≤x
µ(k)
k
SB
x
k

.
We estimate these three terms separately. By Theorem 6.17,

k≤x/x0
µ(k)
k2
= 6
π2 −

k>x/x0
µ(k)
k2
= 6
π2 + O
x0
x

,
and so
π2αx
6

k≤x/x0
µ(k)
k2
= αx + O (x0) .
Similarly,

π2αx
6

k≤x/x0
µ(k)
k2 r
x
k


≤π2αεx
6

k≤x/x0
1
k2 = O(εx).
The third term is bounded independently of x, since


x/x0<k≤x
µ(k)
k
SB
x
k


≤
SB(x0)

x/x0<k≤x
1
k
≤
2SB(x0) log x0
=
O(x0).
Therefore,
A(x) = αx + O(εx) + O(x0) ∼αx.
This completes the proof.
Exercises
We can use the Taylor series for the generating function for the unre-
stricted partition function p(n) to obtain a simple proof of the upper bound
log p(n) < c0
√n.
1. For 0 < x < 1, let
f(x) =
∞

n=1
(1 −xn)−1 =
∞

n=0
p(n)xn.
Prove that
log p(n) + n log x < log f(x) =
∞

k=1
xk
k(1 −xk).

486
16. An Inverse Theorem for Partitions
2. Prove that if 0 < x < 1, then
1 −xk > kxk−1(1 −x)
and
log f(x) <
π2x
6(1 −x).
3. Prove that if 0 < x < 1, then
−log x < 1 −x
x
,
and so
log p(n) <
π2x
6(1 −x) + n(1 −x)
x
.
4. Prove that log p(n) < c0
√n.
Hint: Choose x ∈(0, 1) such that
π2x
6(1 −x) = n(1 −x)
x
.
16.3
Abelian and Tauberian Theorems
In this section we derive the two results about power series with nonnegative
coeﬃcients that were used to deduce Theorem 16.2. The proofs require only
advanced calculus. To the sequence B = {bn}∞
n=0 of real numbers we can
associate the power series f(x) = ∞
n=0 bnxn. We shall assume that the
power series converges for |x| < 1. We think of the function f(x) as a kind
of average over the sequence B. In rough language, an Abelian theorem
asserts that if the sequence B has some property, then the function f(x)
has some related property. Conversely, a Tauberian theorem asserts that if
the function f(x) has some property, then the sequence B has a related
property.
The following result is an Abelian theorem.
Theorem 16.3 Let B = {bn}∞
n=0 be a sequence of nonnegative numbers
such that the power series f(x) = ∞
n=0 bnxn converges for |x| < 1. If
log bn ∼2√αn
as n →∞,
(16.4)
then
log f(x) ∼
α
1 −x
as x →1−.
(16.5)

16.3 Abelian and Tauberian Theorems
487
Proof. Let 0 < ε < 1. The asymptotic formula (16.4) implies that there
exists a positive integer N0 = N0(ε) such that
e2(1−ε)√αn < bn < e2(1+ε)√αn
for all n ≥N0.
The series f(x) converges for |x| < 1 (by the root test), but diverges for
x = 1. For 0 < x < 1 we let x = e−t, where t = t(x) = −log x > 0, and t
decreases to 0 as x increases to 1.
First, we derive the lower bound
lim inf
x→1−(1 −x) log f(x) ≥α.
For n ≥N0,
bnxn > e2(1−ε)√αne−tn = e2(1−ε)√αn−tn.
Completing the square in the exponent, we obtain
2(1 −ε)√αn −tn = (1 −ε)2α
t
−t
√n −(1 −ε)√α
t
2
,
and so
bnxn > e
(1−ε)2α
t
e−t√n−(1−ε)√α
t
2
.
Choose t0 > 0 such that
(1 −ε)√α
t0
2
> N0 + 1,
and let x0 = e−t0 ∈(0, 1). Let x0 < x < 1. If x = e−t, then 0 < t < t0. Let
nx =
:(1 −ε)√α
t
23
.
Then
N0 <
(1 −ε)√α
t
2
−1 < nx ≤
(1 −ε)√α
t
2
and
(1 −ε)√α
t
−1 <
;(1 −ε)√α
t
2
−1 < √nx ≤(1 −ε)√α
t
.
It follows that
√nx −(1 −ε)√α
t
2
< 1,
and so
bnxxnx > e
(1−ε)2α2
t
e−t√nx−(1−ε)√α
t
2
> e
(1−ε)2α2
t
−t.

488
16. An Inverse Theorem for Partitions
Since bnxn ≥0 for all n ≥0, we have
f(x) =
∞

n=0
bnxn ≥bnxxnx > e
(1−ε)2α
t
−t.
Therefore,
log f(x) > (1 −ε)2α
t
−t
and
t log f(x) > (1 −ε)2α −t2.
By Exercise 1,
t = −log x ∼1 −x
as x →1−,
and so
lim inf
x→1−(1 −x) log f(x)
=
lim inf
x→1−t log f(x)
≥
lim inf
t→0+

(1 −ε)2α −t2
=
(1 −ε)2α.
This is true for 0 < ε < 1, and so
lim inf
x→1−(1 −x) log f(x) ≥α.
Next we derive the upper bound
lim sup
x→1−(1 −x) log f(x) ≤α.
We have
f(x)
=
∞

n=0
bnxn
<
N0−1

n=0
bnxn +
∞

n=N0
e2(1+ε)√αn−tn
≤
c1(ε) + e
(1+ε)2α
t
∞

n=N0
e−t√n−(1+ε)√α
t
2
,
where
0 ≤
N0−1

n=0
bnxn ≤
N0−1

n=0
bn = c1(ε).
Let
N1 = N1(t) =
16α
t2

.

16.3 Abelian and Tauberian Theorems
489
Then
4α
t < t(N1 + 1)
4
.
If n > N1, then
√n > 4√α
t
> 2(1 + ε)√α
t
and
√n −(1 + ε)√α
t
>
√n
2 .
It follows that
e−t√n−(1+ε)√α
t
2
< e−t √n
2
2
= e−tn
4 ,
and so, as t →0+,
∞

n=N1+1
e−t√n−(1+ε)√α
t
2
<
∞

n=N1+1
e−tn/4
=
e−t(N1+1)/4
1 −e−t/4
<
e−4α/t
1 −e−t/4
<
8e−4α/t
t
=
o(1),
since 1 −t/4 < e−t/4 < 1 −t/8 for 0 < t < 1. Also,
N1

n=N0
e−t√n−(1+ε)√α
t
2
< N1 ≤16α
t2 .
Consequently,
f(x)
≤
c1(ε) + e
(1+ε)2α
t
16α
t2
+ o(1)

≤
c2(ε)e
(1+ε)2α
t
t2
.
Therefore,
log f(x) ≤(1 + ε)2α
t
+ log c2(ε)
t2
and
t log f(x) ≤(1 + ε)2α + t log c2(ε)
t2
.

490
16. An Inverse Theorem for Partitions
Then
lim sup
x→1−(1 −x) log f(x) = lim sup
t→0+ t log f(x) ≤(1 + ε)2α.
This is true for every ε > 0, and so
lim sup
x→1−(1 −x) log f(x) ≤α.
This completes the proof.
Next we prove a Tauberian theorem about power series with real, non-
negative coeﬃcients.
Theorem 16.4 Let B = {bn}∞
n=0 be a sequence of nonnegative real num-
bers. If the power series
f(x) =
∞

n=0
bnxn
converges for |x| < 1 and if
f(x) ∼
1
1 −x
as x →1−,
then
n

k=0
bk ∼n.
Proof. We begin by showing that for every polynomial p(x) we have
lim
x→1−(1 −x)
∞

n=0
bnxnp(xn) =
# 1
0
p(x)dx.
(16.6)
Since both sides are linear in p(x), it suﬃces to prove this for p(x) = xk.
We have
(1 −x)
∞

n=0
bnxnp(xn)
=
(1 −x)
∞

n=0
bnxnxkn
=
1 −x
1 −xk+1 (1 −xk+1)
∞

n=0
bnx(k+1)n
=
1
1 + x + · · · + xk (1 −xk+1)
∞

n=0
bn(xk+1)n,
and so
lim
x→1−(1 −x)
∞

n=0
bnxnp(xn)

16.3 Abelian and Tauberian Theorems
491
=
lim
x→1−
1
1 + x + · · · + xk lim
x→1−(1 −xk+1)
∞

n=0
bn

xk+1n
=
1
k + 1 =
# 1
0
xkdx.
This proves (16.6).
Next we use the Weierstrass approximation theorem: If f(x) is a con-
tinuous function on the interval [0, 1] and if ε > 0, then there exists a
polynomial p(x) such that
|f(x) −p(x)| < ε
for all x ∈[0, 1].
Let f +(x) = f(x) + ε/2, and let p+(x) be a polynomial such that
|f +(x) −p+(x)| < ε/2
for all x ∈[0, 1].
Then
f(x) < p+(x) < f(x) + ε
for all x ∈[0, 1]
and
# 1
0
f(x)dx <
# 1
0
p+(x)dx <
# 1
0
f(x)dx + ε.
Similarly, there exists a polynomial p−(x) such that
f(x) −ε < p−(x) < f(x)
for all x ∈[0, 1]
and
# 1
0
f(x)dx −ε <
# 1
0
p−(x)dx <
# 1
0
f(x)dx.
Consider the function
g(x) =
 0
for 0 ≤x < e−1,
1
x
for e−1 ≤x ≤1.
Then
# 1
0
g(x)dx =
# 1
e−1
dx
x = 1.
The function g(x) is continuous for all x ∈[0, 1] except for x = e−1, where
it has a jump discontinuity, and so we cannot apply Weierstrass’s theorem
directly to approximate g(x) from above and below by polynomials. We
circumvent this diﬃculty in the following way. Let 0 < ε < e−1. Deﬁne the
function f +(x) as follows:
f +(x) =



ε
2
for 0 ≤x ≤e−1 −ε,
ℓ+(x)
for e−1 −ε ≤x ≤e−1,
1
x + ε
2
for e−1 ≤x ≤1,

492
16. An Inverse Theorem for Partitions
where ℓ+(x) is the straight line with end points (e−1 −ε, ε/2) and (e−1, e+
ε/2). Then f +(x) is a continuous function on the interval [0, 1], and so
there exists a polynomial p+(x) such that
g(x) < f +(x) < p+(x) < f +(x) + ε
2
for all x ∈[0, 1]. Then
0 < p+(x) <



ε
for 0 ≤x ≤e−1 −ε,
e + ε
for e−1 −ε ≤x ≤e−1,
1
x + ε
for e−1 ≤x ≤1,
and so
1
=
# 1
0
g(x)dx
<
# 1
0
p+(x)dx
=
# e−1−ε
0
p+(x)dx +
# e−1
e−1−ε
p+(x)dx +
# 1
e−1 p+(x)dx
<
ε(e−1 −ε) + (e + ε)ε + 1 + ε(1 −e−1)
=
1 + (e + 1)ε.
Similarly, we deﬁne the function f −(x) as follows:
f −(x) =



−ε
2
for 0 ≤x ≤e−1
ℓ−(x)
for e−1 ≤x ≤e−1 + ε
1
x −ε
2
for e−1 + ε ≤x ≤1,
where ℓ−(x) is the straight line with end points (e−1, −ε/2) and (e−1 +
ε, 1/(e−1 −ε/2). Then f −(x) is a continuous function on the interval [0, 1],
and there exists a polynomial p−(x) such that
f −(x) −ε
2 < p−(x) < f −(x) < g(x)
for all x ∈[0, 1]. It follows that
1
=
# 1
0
g(x)dx
>
# 1
0
p−(x)dx
>
# e−1+ε
0
(−ε)dx +
# 1
e−1+ε
 1
x −ε

dx
=
−ε(e−1 + ε) −log(e−1 + ε) −ε(1 −e−1 −ε)
=
1 −ε −log(1 + eε)
>
1 −(e + 1)ε.

16.3 Abelian and Tauberian Theorems
493
The inequality p−(x) < g(x) < p+(x) implies that for 0 < x < 1,
(1 −x)
∞

n=0
bnxnp−(xn)
<
(1 −x)
∞

n=0
bnxng(xn)
<
(1 −x)
∞

n=0
bnxnp+(xn).
By (16.6),
1 −(e + 1)ε
<
# 1
0
p−(t)dt
=
lim
x→1−(1 −x)
∞

n=0
bnxnp−(xn)
≤
lim inf
x→1−(1 −x)
∞

n=0
bnxng(xn)
≤
lim sup
x→1−(1 −x)
∞

n=0
bnxng(xn)
≤
lim
x→1−(1 −x)
∞

n=0
bnxnp+(xn)
=
# 1
0
p+(x)dx
<
1 + (e + 1)ε.
These inequalities hold for all suﬃciently small ε, and so
lim
x→1−(1 −x)
∞

k=0
bkxkg(xk) = 1.
Let
x = e−1/n.
Then 0 < x < 1, and
e−1 ≤xk = e−k/n ≤1
if and only if
k = 0, 1, . . . , n.
It follows from the deﬁnition of the function g(x) that
∞

k=0
bkxkg(xk) =
n

k=0
bkxkg(xk) =
n

k=0
bk,

494
16. An Inverse Theorem for Partitions
and so
lim
n→∞(1 −e−1/n)
n

k=0
bk = 1,
that is,
n

k=0
bk ∼
1
1 −e−1/n .
From the inequality
1 −x < e−x < 1 −x + x2
2
with x = 1/n, we obtain
1
n

1 −1
2n

< 1 −e−1/n < 1
n,
and so
1
1 −e−1/n ∼n
as n →∞. Therefore,
n

k=0
bk ∼n.
This completes the proof.
Exercises
1. Prove that
−log x ∼1 −x
as x →1−.
2. Let B = {bn}∞
n=0 be a sequence of real, nonnegative numbers such
that the power series f(x) = ∞
n=0 bnxn converges for |x| < 1. Prove
that if
lim inf
n→∞
log bn
2√n ≥√α,
then
lim inf
x→1−(1 −x) log f(x) ≥α.
3. Let B = {bn}∞
n=0 be a sequence of real, nonnegative numbers such
that the power series f(x) = ∞
n=0 bnxn converges for |x| < 1. Prove
that if
lim sup
n→∞
log bn
2√n ≤√α,
then
lim sup
x→1−(1 −x) log f(x) ≤α.

16.4 Notes
495
16.4
Notes
Theorem 16.1 and Theorem 16.2 show that a set A with gcd(A) = 1 has
positive density α if and only if log pA(n) ∼c0
√αn. Erd˝os states these
results, with a sketch of a proof, in his paper [32], where Theorem 16.3 is
also stated and applied. The proofs in this book appear in Nathanson [105,
106].
Theorem 16.4 is a famous Tauberian theorem of Hardy and Littlewood [53];
the proof in this book is due to Karamata [77]. Titchmarsh [142, Chapter
7] discusses this and many related results.
Using hard analytic machinery, Freiman [36], Kohlbecker [84], and Yang [158]
have obtained other inverse theorems for partitions.
We know the asymptotics of partition functions for certain sets of integers
of zero density. For example, Hardy and Ramanujan [57] proved that if A(k)
is the set of kth powers of positive integers, then
log pA(k)(n) ∼(k + 1)
1
k Γ
1
k + 1

ζ
1
k + 1
k/(k+1)
n1/(k+1),
where Γ(s) is the gamma function and ζ(s) is the Riemann zeta function.
This gives (15.2) in the special case k = 1. In the same paper, they also
proved that if P is the set of prime numbers, then
log pP(n) ∼2π
2
n
3 log n,
and if P(k) is the set of kth powers of primes, then
log pP(k)(n) ∼(k + 1)

Γ
1
k + 2

ζ
1
k + 1
k/(k+1) 
n
(log n)k
1/(k+1)
.

References
[1] W. R. Alford, A. Granville, and C. Pomerance. There are inﬁnitely
many Carmichael numbers. Annals Math., 139:703–722, 1994.
[2] N. Alon, M. B. Nathanson, and I. Ruzsa. The polynomial method and
restricted sums of congruence classes. J. Number Theory, 56:404–417,
1996.
[3] T. M. Apostol. Introduction to Analytic Number Theory. Undergrad-
uate Texts in Mathematics. Springer-Verlag, New York, 1976.
[4] T. M. Apostol. Modular Forms and Dirichlet Series in Number The-
ory, volume 41 of Graduate Texts in Mathematics. Springer-Verlag,
New York, 2nd edition, 1989.
[5] E. Artin. Collected Papers. Springer-Verlag, New York, 1965.
[6] F. C. Auluck, S. Chowla, and H. Gupta. On the maximum value
of the number of partitions of n into k parts. J. Indian Math. Soc.
(N.S.), 6:105–112, 1942.
[7] L. Auslander and R. Tolimieri. Ring structure and the Fourier trans-
form. Math. Intelligencer, 7(3):49–52, 54, 1985.
[8] B. C. Berndt and R. J. Evans. The determination of Gauss sums.
Bull. Amer. Math. Soc., 5:107–129, 1981.
[9] B. C. Berndt, R. J. Evans, and K. S. Williams. Gauss and Jacobi
Sums. John Wiley & Sons, New York, 1998.

498
References
[10] A. S. Besicovitch. On the density of the sum of two sequences of
integers. Math. Annalen, 110:336–341, 1934.
[11] H. Bohr. Address of Professor Harald Bohr. In Proceedings of the
International Congress of Mathematicians (Cambridge, 1950), vol-
ume 1, pages 127–134, Providence, 1952. Amer. Math. Soc.
[12] D. Boneh. Twenty years of attacks on the RSA cryptosystem. Notices
Amer. Math. Soc., 46:203–213, 1999.
[13] Z. I. Borevich and I. R. Shafarevich.
Number Theory.
Academic
Press, New York, 1966.
[14] J. Browkin and J. Brzezi´nski. Some remarks on the abc-conjecture.
Math. Comp., 62:931–939, 1994.
[15] J. Brzezi´nski. The abc-conjecture. Preprint, 1999.
[16] S. Chowla. On abundant numbers. J. Indian Math. Soc. (2), 1:41–44,
1934.
[17] R. Crandall, K. Dilcher, and C. Pomerance. A search for Wieferich
and Wilson primes. Math. Comp., 66:433–449, 1997.
[18] H. Daboussi. Sur le th´eor`eme des nombres premiers. Comptes Ren-
dus Acad. Sci. Paris, S´er. A, 298:161–164, 1984.
[19] H. Davenport. ¨Uber numeri abundantes. Sitzungsbericht Aka. Wiss.
Berlin, 27:830–837, 1933.
[20] H. Davenport. On f 3(t)−g2(t). Norske Vid. Selsk. Forrh., 38:86–87,
1965.
[21] H. Davenport. Multiplicative Number Theory, volume 74 of Graduate
Texts in Mathematics. Springer-Verlag, New York, 2nd edition, 1980.
[22] H. Davenport. The Higher Arithmetic. Cambridge University Press,
Cambridge, 6th edition, 1992.
[23] C.-J. de la Vall´ee Poussin. Recherches analytiques sur la th´eorie des
nombres; Premi`ere partie: La function ζ(s) de Riemann et les nom-
bres premiers en g´en´eral. Annales de la Soc. scientiﬁque de Bruxelles,
20:183–256, 1896.
[24] H. G. Diamond. Elementary methods in the study of the distribution
of prime numbers. Bull. Am. Math. Soc., 7:553–589, 1982.
[25] L. E. Dickson. History of the Theory of Numbers. Carnegie Institute
of Washington, Washington, 1919, 1920, 1923; reprinted by Chelsea
Publishing Company in 1971.

References
499
[26] W. Diﬃe and M. Hellman. New directions in cryptography. IEEE
Transactions on Information Theory, IT–22:644–654, 1976.
[27] J. S. Ellenberg. Congruence ABC implies ABC. Preprint, 1999.
[28] P. T. D. A. Elliott. Probabilistic Number Theory I: Mean Value The-
orems. Springer-Verlag, New York, 1979.
[29] P. T. D. A. Elliott. Probabilistic Number Theory II: Central Limit
Theorems. Springer-Verlag, New York, 1980.
[30] P. T. D. A. Elliott. The multiplicative group of rationals generated
by the shifted primes, I. J. reine angew. Math., 463:169–216, 1995.
[31] P. Erd˝os. On the density of the abundant numbers. J. London Math.
Soc., 9:278–282, 1934.
[32] P. Erd˝os. On an elementary proof of some asymptotic formulas in
the theory of partitions. Annals Math., 43:437–450, 1942.
[33] P. Erd˝os. On some asymptotic formulas in the theory of partitions.
Bull. Amer. Math. Soc., 52:185–188, 1946.
[34] P. Erd˝os.
On a new method in elementary number theory which
leads to an elementary proof of the prime number theorem. Proc.
Nat. Acad. Sci. U.S.A., 35:374–384, 1949.
[35] P. Erd˝os and J. Lehner. The distribution of the number of summands
in the partitions of a positive integer. Duke Math. J., 8:335–345, 1941.
[36] G. A. Freiman. Inverse problems of the additive theory of numbers.
Izv. Akad. Nauk SSSR, 19:275–284, 1955.
[37] C. F. Gauss.
Disquisitiones Arithmeticae.
Springer-Verlag, New
York, 1986. Translated by A. A. Clarke and revised by W. C. Wa-
terhouse.
[38] D. Goldfeld. The elementary proof of the prime number theorem: An
historical perspective. Preprint, 1998.
[39] A. Granville. On elementary proofs of the Prime Number Theorem
for arithmetic progressions, without characters. In Proceedings of the
AmalﬁConference on Analytic Number Theory, September 25–29,
1989, pages 157–195, Salerno, Italy, 1992. Universit´a di Salerno.
[40] A. Granville.
Primality testing and Carmichael testing.
Notices
Amer. Math. Soc., 39:696–700, 1992.
[41] N. Greenleaf. On Fermat’s equation in C(t). Am. Math. Monthly,
76:808–809, 1969.

500
References
[42] E. Grosswald. Topics from the Theory of Numbers. Macmillan, New
York, 1966.
[43] E. Grosswald.
Representations of Integers as Sums of Squares.
Springer-Verlag, New York, 1985.
[44] R. Gupta and M. R. Murty. A remark on Artin’s conjecture. Inven-
tiones Math., 78:127–130, 1984.
[45] R. K. Guy. Unsolved Problems in Number Theory. Springer-Verlag,
New York, 2 edition, 1994.
[46] J. Hadamard. Sur la distribution des z´eros de la fonction ζ(s) et
ses cons´equences arithm´etiques. Bulletin de la Soc. math. de France,
24:199–220, 1896.
[47] H. Halberstam and H.-E. Richert. Sieve Methods. Academic Press,
London, 1974.
[48] H. Halberstam and K. F. Roth. Sequences, volume 1. Oxford Univer-
sity Press, Oxford, 1966. Reprinted by Springer-Verlag, Heidelberg,
in 1983.
[49] R. R. Hall. Sets of Multiples. Number 118 in Cambridge Tracts in
Mathematics. Cambridge University Press, Cambridge, 1996.
[50] R. R. Hall and G. Tenenbaum.
Divisors.
Number 90 in Cam-
bridge Tracts in Mathematics. Cambridge University Press, Cam-
bridge, 1988.
[51] G. H. Hardy.
A Mathematician’s Apology.
Cambridge University
Press, Cambridge, 1940. Reprinted in 1967.
[52] G. H. Hardy. Ramanujan. Twelve Lectures on Subjects Suggested by
his Life and Work. Cambridge University Press, Cambridge, 1940.
Reprinted by Chelsea Publishing Company, New York, in 1959.
[53] G. H. Hardy and J. E. Littlewood.
Tauberian theorems concern-
ing power series and Dirichlet’s series whose coeﬃcients are positive.
Proc. London Math. Soc., 13:174–191, 1914.
[54] G. H. Hardy and J. E. Littlewood. Contributions to the theory of the
Riemann zeta-function and the theory of the distribution of primes.
Acta Math., 41:119–196, 1918.
[55] G. H. Hardy and J. E. Littlewood. A new solution of Waring’s prob-
lem. Q. J. Math., 48:272–293, 1919.

References
501
[56] G. H. Hardy and J. E. Littlewood. Some problems of “Partitio Nu-
merorum.” A new solution of Waring’s problem. G¨ottingen Nach.,
pages 33–54, 1920.
[57] G. H. Hardy and S. Ramanujan. Asymptotic formulae for the distri-
bution of integers of various types. Proc. London Math. Soc., 16:112–
132, 1917.
[58] G. H. Hardy and S. Ramanujan. Asymptotic formulae in combina-
tory analysis. Proc. London Math. Soc., 17:75–115, 1918.
[59] G. H. Hardy and S. Ramanujan. Une formule asymptotique pour le
nombres des partitions de n. Comptes Rendus Acad. Sci. Paris, S´er.
A, 2 Jan. 1917.
[60] G. H. Hardy and E. M. Wright. An Introduction to the Theory of
Numbers. Oxford University Press, Oxford, 5th edition, 1979.
[61] T. L. Heath. The Thirteen Books of Euclid’s Elements. Dover Pub-
lications, New York, 1956.
[62] D. R. Heath-Brown. Artin’s conjecture for primitive roots. Quart.
J. Math. Oxford, 37:22–38, 1986.
[63] E. Hecke. Vorlesungen ¨uber die Theorie der Algebraischen Zahlen.
Akademische Verlagsgesellschaft, Leipzig, 1923.
Reprinted by
Chelsea Publishing Company, New York, in 1970.
[64] E. Hecke. Lectures on the Theory of Algebraic Numbers, volume 77
of Graduate Texts in Mathematics. Springer-Verlag, New York, 1981.
[65] M. E. Hellman. The mathematics of public-key cryptography. Sci-
entiﬁc American, 241:130–139, 1979.
[66] D. Hilbert. Beweis f¨ur die Darstellbarkeit der ganzen Zahlen durch
eine feste Anzahl nter Potenzen (Waringsches Problem). Mat. An-
nalen, 67:281–300, 1909.
[67] A. Hildebrand.
The Prime Number Theorem via the large sieve.
Mathematika, 33:23–30, 1986.
[68] L. K. Hua. Introduction to Number Theory. Springer-Verlag, Berlin,
1982.
[69] A. E. Ingham. Some asymptotic formulae in the theory of numbers.
J. London Math. Soc., 2:202–208, 1927.
[70] A. E. Ingham. The Distribution of Prime Numbers. Number 30 in
Cambridge Tracts in Mathematics and Mathematical Physics. Cam-
bridge University Press, Cambridge, 1932. Reprinted in 1992.

502
References
[71] A. E. Ingham. Review of the papers of Selberg and Erd˝os. Math.
Reviews, 10(595b, 595c), 1949. Reprinted in [92, vol. 4, pages 191–
193, N20–3].
[72] K. Ireland and M. Rosen. A Classical Introduction to Modern Num-
ber Theory, volume 84 of Graduate Texts in Mathematics. Springer-
Verlag, New York, 2nd edition, 1990.
[73] H. Iwaniec.
Almost-primes represented by quadratic polynomials.
Inventiones Math., 47:171–188, 1978.
[74] H. Iwaniec. Topics in Classical Automorphic Forms, volume 17 of
Graduate Studies in Mathematics. Amer. Math. Soc., Providence,
1997.
[75] S. M. Johnson.
On the representations of an integer as a sum of
products. Trans. Amer. Math. Soc., 76:177–189, 1954.
[76] E. Kamke.
Verallgemeinerung des Waring-Hilbertschen Satzes.
Math. Annalen, 83:85–112, 1921.
[77] J. Karamata.
¨Uber die Hardy–Littlewoodschen Umkehrungen des
Abelschen Stetigkeitssatzes. Math. Zeit., 32:319–320, 1930.
[78] A. Ya. Khinchin. Three Pearls of Number Theory. Dover Publica-
tions, Mineola, NY, 1998. This translation from the Russian of the
second (1948), revised edition was published originally by Graylock
Press in 1952.
[79] M. Kneser. Absch¨atzungen der asymptotischen Dichte von Summen-
mengen. Math. Z., 58:459–484, 1953.
[80] C. Knessl and J. B. Keller. Partition asymptotics for recursion equa-
tions. SIAM J. Applied Math., 50:323–338, 1990.
[81] M. I. Knopp.
Modular Functions in Analytic Number Theory.
Markham Publishing Co., Chicago, 1970. Reprinted by Chelsea Pub-
lishing Company in 1993.
[82] Chao Ko. On the diophantine equation x2 = yn +1, xy ̸= 0. Scientia
Sinica, 14:457–460, 1964.
[83] N. Koblitz. A Course in Number Theory and Cryptography, volume
114 of Graduate Texts in Mathematics. Springer-Verlag, New York,
2nd edition, 1994.
[84] E. E. Kohlbecker. Weak asymptotic properties of partitions. Trans.
Amer. Math. Soc., 88:346–375, 1958.

References
503
[85] R. Kumanduri and C. Romero. Number Theory with Computer Ap-
plications. Prentice Hall, Upper Saddle River, New Jersey, 1998.
[86] A. V. Kuzel’. Elementary solution of Waring’s problem for polynomi-
als by the method of Yu. B. Linnik. Uspekhi Mat. Nauk, 11:165–168,
1956.
[87] E. Landau. Elementary Number Theory. Chelsea Publishing Com-
pany, New York, 1966.
[88] S. Lang. Old and new conjectured diophantine inequalities. Bull.
Amer. Math. Soc., 23:37–75, 1990.
[89] S. Lang. Algebra. Addison-Wesley, Reading, Mass., 3rd edition, 1993.
[90] S. Lang. Algebraic Number Theory, volume 110 of Graduate Texts in
Mathematics. Springer-Verlag, New York, 2nd edition, 1994.
[91] V. A. Lebesgue. Sur l’impossibilit´e, en nombres entiers, de l’´equation
xm = y2 + 1. Nouv. Ann. Math. (1), 9:178–181, 1850.
[92] W. J. LeVeque.
Reviews in Number Theory.
Amer. Math. Soc.,
Providence, 1974.
[93] Yu. V. Linnik.
An elementary solution of Waring’s problem by
Shnirel’man’s method. Mat. Sbornik NS, 12 (54):225–230, 1943.
[94] J. E. Littlewood. Sur la distribution des nombres premiers. C. R.
Acad. Sci. Paris, S´er. A, 158:1869–1872, 1914.
[95] Yu. I. Manin. Classical computing, quantum computing, and Shor’s
factorization algorithm. In S´eminaire Bourbaki, 51`eme ann´ee, 1998–
99, pages 862–1—862–30. UFR de Math´ematiques de l’Universit´e
Paris VII — Denis Diderot, Paris, 1999.
[96] Yu. I. Manin and A. A. Panchishkin. Number Theory I. Introduc-
tion to Number Theory, volume 49 of Encyclopedia of Mathematical
Sciences. Springer-Verlag, Berlin, 1995.
[97] R. C. Mason. Diophantine Equations over Function Fields, volume 96
of London Mathematical Society Lecture Notes Series.
Cambridge
University Press, Cambridge, 1984.
[98] M. R. Murty. Artin’s conjecture for primitive roots. Math. Intelli-
gencer, 10(4):59–67, 1988.
[99] A. P. Nathanson. “Arithmetic”. Poem written in D’Ann Ippolito’s
third grade class at Far Brook School, 1998.

504
References
[100] M. B. Nathanson.
An exponential congruence of Mahler.
Amer.
Math. Monthly, 79:55–57, 1972.
[101] M. B. Nathanson.
Sums of ﬁnite sets of integers.
Amer. Math.
Monthly, 79:1010–1012, 1972.
[102] M. B. Nathanson. Catalan’s equation in K(t). Amer. Math. Monthly,
81:371–373, 1974.
[103] M. B. Nathanson. Additive Number Theory: Inverse Problems and
the Geometry of Sumsets, volume 165 of Graduate Texts in Mathe-
matics. Springer-Verlag, New York, 1996.
[104] M. B. Nathanson.
Additive Number Theory: The Classical Bases,
volume 164 of Graduate Texts in Mathematics. Springer-Verlag, New
York, 1996.
[105] M. B. Nathanson. On Erd˝os’s elementary method in the asymptotic
theory of partitions. Preprint, 1998.
[106] M. B. Nathanson. Asymptotic density and the asymptotics of parti-
tion functions. Acta Math. Hungar., 87(1–2), 2000.
[107] M. B. Nathanson. Partitions with parts in a ﬁnite set. Proc. Amer.
Math. Soc., 2000. To appear.
[108] M. B. Nathanson. Additive Number Theory: Addition Theorems and
the Growth of Sumsets. In preparation, 2001.
[109] V. I. Nechaev.
Waring’s Problem for Polynomials.
Izdat. Akad.
Nauk SSSR, Moscow, 1951.
[110] O. Neugebauer. The Exact Sciences in Antiquity. Brown Univ. Press,
Providence, 2nd edition, 1957. Reprinted by Dover Publications in
1969.
[111] J. Neukirch.
Algebraic Number Theory.
Springer-Verlag, Berlin,
1999.
[112] D. J. Newman. Simple analytic proof of the prime number theorem.
Amer. Math. Monthly, 87:693–696, 1980.
[113] A. Nitaj. La conjecture abc. Enseignement Math., 42:3–24, 1996.
[114] J. Oesterl´e.
Nouvelles approches du “Th´eor`eme” de Fermat.
In
S´eminaire Bourbaki, Volume 1987/88, Expos´es 686–699, volume 161–
162 of Ast´erisque. Soci´et´e Math´ematique de France, Paris, 1988.
[115] A. G. Postnikov. A remark on an article by A. G. Postnikov and N.
P. Romanov. Uspehki Mat. Nauk, 24(5(149)):263, 1969.

References
505
[116] A. G. Postnikov and N. P. Romanov. A simpliﬁcation of A. Selberg’s
elementary proof of the asymptotic law of distribution of prime num-
bers. Uspehki Mat. Nauk (N.S.), 10(4(66)):75–87, 1955.
[117] H. Rademacher. A convergent series for the partition function p(n).
Proc. Nat. Acad. Sci., 23:78–84, 1937.
[118] H. Rademacher. On the partition function p(n). Proc. London Math.
Soc., 43:241–254, 1937.
[119] H. Rademacher.
Topics in Analytic Number Theory.
Springer-
Verlag, New York, 1973.
[120] D. Ramakrishnan and R. J. Valenza.
Fourier Analysis on Num-
ber Fields, volume 186 of Graduate Texts in Mathematics. Springer-
Verlag, New York, 1999.
[121] S. Ramanujan.
Some formulæ in the analytic theory of numbers.
Messenger of Mathemtics, 45:81–84, 1916.
[122] G. J. Rieger.
Zu Linniks L¨osung des Waringschen Problems: Ab-
sch¨atzung von g(n). Math. Zeit., 60:213–239, 1954.
[123] R. L. Rivest, A. Shamir, and L. M. Adleman. A method for obtaining
digital signatures and public-key cryptosystems. Communications of
the ACM, 21:120–126, 1978.
[124] A. Schinzel. Remarks on the paper “Sur certaines hypoth`eses con-
cernant les nombres premiers”. Acta Arith., 7:1–8, 1961/62.
[125] A. Schinzel and W. Sierpi´nski. Sur certaines hypoth`eses concernant
les nombres premiers.
Acta Arith., 4:185–208, 1958.
Erratum 5
(1959), 259.
[126] I. Schur.
¨Uber die Gaußschen Summen.
Nachrichten k. Gesell.
G¨ottingen, Math.-Phys. Klasse, pages 147–153, 1921. Reprinted in
Gesammelte Abhandlungen, Band II, Springer-Verlag, Berlin, 1973.
[127] A. Selberg. An elementary proof of Dirichlet’s theorem about primes
in an arithmetic progression. Annals Math., 50:297–304, 1949. In
Collected Papers, volume I, pages 371–378, Springer-Verlag, Berlin,
1989.
[128] A. Selberg. An elementary proof of the prime-number theorem. An-
nals Math., 50:305–313, 1949. In Collected Papers, volume I, pages
379–387, Springer-Verlag, Berlin, 1989.
[129] A. Selberg. An elementary proof of the prime-number theorem for
arithmetic progressions. Canadian J. Math., 2:66–78, 1950. In Col-
lected Papers, volume I, pages 398–410, Springer-Verlag, Berlin, 1989.

506
References
[130] A. Selberg. Reﬂections around the Ramanujan centenary. In Col-
lected Papers, volume I, pages 695–706. Springer-Verlag, Berlin, 1989.
[131] J.-P. Serre. Cours d’Arithm´etique. Presses Universitaires de France,
Paris, 1970.
[132] J.-P. Serre. A Course in Arithmetic, volume 7 of Graduate Texts in
Mathematics. Springer-Verlag, New York, 1973.
[133] P. Shor.
Polynomial-time algorithms for prime factorization and
discrete logarithms on a quantum computer.
SIAM J. Comput.,
26:1484–1509, 1997.
[134] J. H. Silverman.
Wieferich’s criterion and the abc conjecture.
J.
Number Theory, 30:226–237, 1988.
[135] S. Singh.
The Code Book: The Evolution of Secrecy from Mary,
Queen of Scots to Quantum Cryptography. Doubleday, New York,
1999.
[136] E. G. Straus. The elementary proof of the Prime Number Theorem.
Undated, unpublished manuscript.
[137] G. Szekeres.
An asymptotic formula in the theory of partitions.
Quarterly. J. Math. Oxford, 2:85–108, 1951.
[138] G. Szekeres. Some asymptotic formulae in the theory of partitions
(II). Quarterly. J. Math. Oxford, 4:96–111, 1953.
[139] R. Taylor and A. Wiles. Ring-theoretic properties of certain Hecke
algebras. Annals Math., 141:533–572, 1995.
[140] G. Tenenbaum and M. Mend`es-France.
The Prime Numbers and
Their Distribution. Amer. Math. Soc., Providence, 1999.
[141] A. Terras.
Fourier Analysis on Finite Groups and Applications.
Number 43 in London Mathematical Society Student Texts. Cam-
bridge University Press, Cambridge, 1999.
[142] E. C. Titchmarsh.
The Theory of Functions.
Oxford University
Press, Oxford, 2nd edition, 1939.
[143] P. Tur´an. On a theorem of Hardy and Ramanujan. J. London Math.
Soc., 9:274–276, 1934.
[144] P. Tur´an. On a New Method of Analysis and its Applications. Wiley-
Interscience, New York, 1984.
[145] J. V. Uspensky and M. A. Heaslet.
Elementary Number Theory.
McGraw-Hill, New York, 1939.

References
507
[146] Ya. V. Uspensky. Asymptotic expressions of numerical functions oc-
curring in problems concerning the partition of numbers into sum-
mands. Bull. Acad. Sci. de Russie, 14(6):199–218, 1920.
[147] B. L. van der Waerden. Science Awakening. Science Editions, John
Wiley & Sons, New York, 2nd edition, 1963.
[148] R. C. Vaughan. The Hardy–Littlewood Method. Cambridge Univer-
sity Press, Cambridge, 2nd edition, 1997.
[149] B. A. Venkov. Elementary Number Theory. Wolters-Noordhof Pub-
lishing, Groningen, the Netherlands, 1970.
[150] I. M. Vinogradov. On Waring’s theorem. Izv. Akad. Nauk SSSR,
Otd. Fiz.-Mat. Nauk, (4):393–400, 1928. English translation in Se-
lected Works, pages 101–106, Springer-Verlag, Berlin, 1985.
[151] S. S. Wagstaﬀ.
Solution of Nathanson’s exponential congruence.
Math. Comp., 33:1097–1100, 1979.
[152] A. Weil. Number Theory for Beginners. Springer-Verlag, New York,
1979.
[153] A. Weil. Number Theory: An Approach through History. From Ham-
murapi to Legendre. Birkh¨auser, Boston, 1984.
[154] A. Weil. Basic Number Theory. Classics in Mathematics. Springer-
Verlag, Berlin, 1995. Reprint of the 3rd edition, published in 1974.
[155] A. Wieferich. Zum letzten Fermat’schen Satz. J. reine angew. Math.,
136:293–302, 1909.
[156] A. Wiles. Modular elliptic curves and Fermat’s last theorem. Annals
Math., 141:443–531, 1995.
[157] B. M. Wilson. Proofs of some formulæ enunciated by Ramanujan.
Proc. London Math. Soc., 21:235–255, 1922.
[158] Y. Yang. Inverse problems for partition functions. Preprint, 1998.
[159] D. Zagier.
Newman’s short proof of the prime number theorem.
Amer. Math. Monthly, 104:705–708, 1997.

Index
abc conjecture, 185
abelian group, 10
abelian theorem, 486
abundant number, 241, 260
k-abundant, 260
primitive, 260
additive basis, 359
additive character, 325
additive set function, 133
algebraically closed ﬁeld, 177
aliquot sequence, 243
arithmetic function, 57, 201
asymptotic basis, 359
asymptotic density, 244, 257,
360, 475
lower, 256, 482
upper, 256, 482
asymptotically stable basis, 360
basis, 359
asymptotic, 359
asymptotically stable, 360
of ﬁnite order, 359
of order h, 359
stable, 359
binary operation, 10
binary quadratic form, 108, 405
binomial coeﬃcient, 8, 268
binomial polynomial, 357
Carmichael number, 76
Catalan conjecture, 186
Catalan equation, 184, 186
Catalan–Dickson problem, 244
Cauchy-Schwarz inequality, 139
ceiling function, xi
character, 126
additive character, 325
complex character, 326
Dirichlet character, 326
even character, 326
induced, 328
multiplicative character, 326
odd character, 326
primitive, 328
principal character, 326
real character, 326
character group, 127
character table, 131
Chebyshev functions, 267

510
Index
Chebyshev’s theorem, 271
ciphertext, 76
classical Gauss sum, 153
coﬁnite, 476
common divisor, 12
common multiple, 28
commutative group, 10
commutative ring, 48
comparative prime number
theory, 351
complete set of residues, 46
completely additive, 27
completely multiplicative, 226
complex character, 326
composite number, 25
congruence abc conjecture, 191
congruence class, 46
congruent, 45
congruent polynomials, 90
conjugate divisor, 25, 405
continued fraction, 19
convergent, 23
convolution, 139
coset, 69
counting function, 256, 359, 475
cryptanalysis, 77
cryptography, 76
cusp form, 453
cyclic group, 70
deﬁcient number, 241
degree of polynomial, 84
density, 256, 475
asymptotic, 360
Shnirel’man, 359
derivation, 175, 203
derivative, 116
diagonalizable operator, 146
diﬀerence operator, 357
diﬀerence set, 361
diophantine equation, 37
direct product of groups, 124
direct sum, 121
Dirichlet L-function, 330
Dirichlet character, 325, 326
Dirichlet convolution, 201
Dirichlet polynomial, 337
Dirichlet series, 337
Dirichlet’s divisor problem, 233
Dirichlet’s theorem, 347
discrete logarithm, 88
discriminant, 108
division algorithm, 3
divisor, 3
divisor function, 231, 405, 431
double coset, 73
double dual, 129
dual group, 127
eigenvalue, 146
eigenvector, 146
Eisenstein series, 453
equivalent polynomials, 73
Euclid’s lemma, 26
Euclid’s theorem, 33
Euclidean algorithm, 18
length, 18
Euler phi function, 54, 57, 227
Euler product, 330
Euler’s constant, 213
Euler’s theorem, 67
evaluation map, 85
even character, 326
even function, 401
eventually coincide, 397
exactly divide, 27
exponent, 83
exponential congruence, 97
factorization, 234
Fermat prime, 36, 107
Fermat’s last theorem, 183, 185
Fermat’s little theorem, 68
Fermat’s theorem, 407
Fibonacci numbers, 23
ﬁeld, 49
ﬂoor function, xi
formal power series, 205
Fourier transform, 135, 160
fractional part, 29, 206

Index
511
Frobenius problem, 39
fundamental theorem of
arithmetic, 26
Gauss sum, 152
classical, 153
Gauss’s lemma, 103
Gaussian integer, 453
Gaussian set, 103
generalized von Mangoldt
function, 290
generating function, 483
generator, 70
greatest common divisor, 12
polynomial, 91
group, 10
group character, 126
group of units, 49
Haar measure, 134
Heisenberg group, 16
Hensel’s lemma, 116
homomorphism
group, 13
ring, 48
Hypothesis H, 288
ideal, 90, 171
image, 16
incongruent, 45
integer part, xi, 28, 206
integer-valued polynomial, 356,
357
integral domain, 174
integral operator, 146
invertible class, 55
involution, 403
isomorphism, 13
Jacobi symbol, 114
Jacobi’s theorem, 431
k-abundant number, 260
kernel, 16
Kneser’s theorem, 397
L-function, 330
ℓ-function, 275
Lagrange’s theorem, 69, 355
Lam´e’s theorem, 25
lattice point, 233
Laurent polynomial, 181
leading coeﬃcient, 84
least common multiple, 28
least nonnegative residue, 46
Legendre symbol, 101, 153
Leibniz formula, 119
lexicographic order, 9
linear diophantine equation, 39
Liouville’s formulae, 402, 419,
420
Liouville’s function, 226
Ljunggren equation, 42
localization, 180
logarithmic derivative, 177
logarithmic integral, 298
lower asymptotic density, 256,
360, 482
m-adic representation, 5
mathematical induction, xii, 5
mean value, 206
Mersenne prime, 36, 107, 242
Mertens’s formula, 279
Mertens’s theorem, 276
middle binomial coeﬃcient, 268
minimum principle, 3
multiple, 3
multiplicative character, 326
multiplicative function, 58, 217,
224, 430
multiplicatively closed, 179
M¨obius function, 217
M¨obius inversion, 218
nilpotent, 56, 172
norm
L2, 134
L∞, 137
NSE, 367, 376
odd character, 326

512
Index
odd function, 401
order, 68
group, 69
group element, 70
lexicographic, 9
partial, 10
total, 10
order modulo m, 83
order of magnitude, xii, 273
orthogonality relations, 129, 130,
327
p-adic value, 27
p-group, 121
pairing, 129
pairwise relatively prime, 13
partial fractions, 462
partial order, 10
partial quotients, 19
partial summation, 211
partition, 455
partition function, 455
perfect number, 241
plaintext, 76
pointwise product, 201
pointwise sum, 201
polynomial, 84
congruent, 90
degree, 84
derivative, 116
monic, 84
root, 85
zero, 85
power, 189
power residue, 98
powerful number, 32, 187
prime ideal, 171
prime number, 25
prime number race, 351
prime number theorem, 274, 289
primitive abundant number, 260
primitive root, 84
primitive set, 255
principal character, 151, 326
principal ideal, 171
principal ring, 171
product ideal, 175
projective space, 15
pseudoprime, 75
public key cryptosystem, 76, 78
quadratic form, 108, 404
quadratic nonresidue, 98, 101
quadratic reciprocity law, 109
quadratic residue, 98, 100
quotient, 4
quotient ﬁeld, 176, 180
quotient group, 73
radical, 30, 172, 218
of a polynomial, 173
of an integer, 172
radical ideal, 172
Ramanujan-Nagell equation, 42
real character, 326
reduced set of residues, 54
reﬂexive relation, 9
relatively prime, 13
remainder, 4
representation function, 367
residue class, 46
Riemann hypothesis, 323, 351
Riemann zeta function, 221, 335
ring, 48
ring of formal power series, 205
ring of fractions, 180
root of unity, 11
RSA cryptosystem, 79
secret key cryptosystem, 77
Selberg’s formula, 293, 294
set of multiples, 255
Shnirel’man density, 359
Shnirel’man’s addition theorem,
363
sieve of Eratosthenes, 34
simple continued fraction, 19
spectrum, 171
square-free integer, 32, 217
stable basis, 359

Index
513
standard factorization, 27
subgroup, 11
sum function, 206
sumset, 121, 361
support, 137, 291
tauberian theorem, 486
Taylor’s formula, 119
ternary quadratic form, 405
theta function, 453
total order, 10
totient function, 54
trace of a matrix, 144
transitive relation, 10
translation invariant, 134
translation operator, 139, 146
twin primes, 31, 287
unimodal, 206, 268, 474
unit, 48
upper asymptotic density, 256,
482
von Mangoldt function, 223, 276
generalized, 290
Waring’s problem, 355
for polynomials, 356
weight function, 375
weighted set, 375
Wieferich prime, 187
Wieferich’s theorem, 355
Wilson’s theorem, 53
zero set, 173




