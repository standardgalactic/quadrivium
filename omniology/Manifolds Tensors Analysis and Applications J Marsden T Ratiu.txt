Page iii
Preface
The purpose of this book is to provide core material in nonlinear analysis for mathematicians, physicists,
engineers, and mathematical biologists. The main goal is to provide a working knowledge of manifolds,
dynamical systems, tensors and diﬀerential forms. Some applications to Hamiltonian mechanics, ﬂuid me-
chanics, electromagnetism, plasma dynamics and control theory are given in Chapter 8, using both invariant
and index notation.
Throughout the text supplementary topics are noted that may be downloaded from the internet from
http://www.cds.caltech.edu/~marsden. This device enables the reader to skip various topics without
disturbing the main ﬂow of the text. Some of these provide additional background material intended for
completeness, to minimize the necessity of consulting too many outside references.
Philosophy.
We treat ﬁnite and inﬁnite-dimensional manifolds simultaneously. This is partly for eﬃciency
of exposition. Without advanced applications, using manifolds of mappings (such as applications to ﬂuid
dynamics), the study of inﬁnite-dimensional manifolds can be hard to motivate. Chapter 8 gives an intro-
duction to these applications. Some readers may wish to skip the inﬁnite-dimensional case altogether. To
aid in this, we have separated some of the technical points peculiar to the inﬁnite-dimensional case into sup-
plements, either directly in the text or on-line. Our own research interests lean toward physical applications,
and the choice of topics is partly shaped by what has been useful to us over the years.
We have tried to be as sympathetic to our readers as possible by providing ample examples, exercises, and
applications. When a computation in coordinates is easiest, we give it and do not hide things behind com-
plicated invariant notation. On the other hand, index-free notation sometimes provides valuable geometric
and computational insight so we have tried to simultaneously convey this ﬂavor.
Prerequisites and Links.
The prerequisites required are solid undergraduate courses in linear algebra
and advanced calculus along with the usual mathematical maturity. At various points in the text contacts are
made with other subjects. This provides a good way for students to link this material with other courses. For
example, Chapter 1 links with point-set topology, parts of Chapters 2 and 7 are connected with functional
analysis, Section 4.3 relates to ordinary diﬀerential equations and dynamical systems, Chapter 3 and Section
7.5 are linked to diﬀerential topology and algebraic topology, and Chapter 8 on applications is connected
with applied mathematics, physics, and engineering.
Use in Courses.
This book is intended to be used in courses as well as for reference. The sections are,
as far as possible, lesson sized, if the supplementary material is omitted. For some sections, like 2.5, 4.2, or

iv
Preface
7.5, two lecture hours are required if they are to be taught in detail. A standard course for mathematics
graduate students could omit Chapter 1 and the supplements entirely and do Chapters 2 through 7 in one
semester with the possible exception of Section 7.4. The instructor could then assign certain supplements
for reading and choose among the applications of Chapter 8 according to taste.
A shorter course, or a course for advanced undergraduates, probably should omit all supplements, spend
about two lectures on Chapter 1 for reviewing background point set topology, and cover Chapters 2 through
7 with the exception of Sections 4.4, 7.4, 7.5 and all the material relevant to volume elements induced by
metrics, the Hodge star, and codiﬀerential operators in Sections 6.2, 6.4, 6.5, and 7.2.
A more applications oriented course could skim Chapter 1, review without proofs the material of Chapter
2 and cover Chapters 3 to 8 omitting the supplementary material and Sections 7.4 and 7.5. For such a
course the instructor should keep in mind that while Sections 8.1 and 8.2 use only elementary material,
Section 8.3 relies heavily on the Hodge star and codiﬀerential operators, and Section 8.4 consists primarily
of applications of Frobenius’ theorem dealt with in Section 4.4.
The notation in the book is as standard as conﬂicting usages in the literature allow. We have had to
compromise among utility, clarity, clumsiness, and absolute precision. Some possible notations would have
required too much interpretation on the part of the novice while others, while precise, would have been so
dressed up in symbolic decorations that even an expert in the ﬁeld would not recognize them.
History and Credits.
In a subject as developed and extensive as this one, an accurate history and
crediting of theorems is a monumental task, especially when so many results are folklore and reside in
private notes. We have indicated some of the important credits where we know of them, but we did not
undertake this task systematically. We hope our readers will inform us of these and other shortcomings of
the book so that, if necessary, corrected printings will be possible. The reference list at the back of the book
is conﬁned to works actually cited in the text. These works are cited by author and year like this: deRham
[1955].
Acknowledgements.
During the preparation of the book, valuable advice was provided by Malcolm
Adams, Morris Hirsch, Sameer Jalnapurkar, JeﬀMess, Charles Pugh, Clancy Rowley, Alan Weinstein, and
graduate students in mathematics, physics and engineering at Berkeley, Santa Cruz, Caltech and Lausanne.
Our other teachers and collaborators from whom we learned the material and who inspired, directly and
indirectely, various portions of the text are too numerous to mention individually, so we hereby thank them
all collectively. We have taken the opportunity in this edition to correct some errors kindly pointed out by
our readers and to rewrite numerous sections. We thank Connie Calica, Dotty Hollinger, Anne Kao, Marnie
MacElhiny and Esther Zack for their excellent typesetting of the book. We also thank Hendra Adiwidjaja,
Nawoyuki Gregory Kubota, Robert Kochwalter and Wendy McKay for the typesetting and ﬁgures for this
third edition.
Jerrold E. Marsden and Tudor S. Ratiu
January, 2001

0
Preface

Page 1
1
Topology
The purpose of this chapter is to introduce just enough topology for later requirements. It is assumed that
the reader has had a course in advanced calculus and so is acquainted with open, closed, compact, and
connected sets in Euclidean space (see for example Marsden and Hoﬀman [1993]). If this background is
weak, the reader may ﬁnd the pace of this chapter too fast. If the background is under control, the chapter
should serve to collect, review, and solidify concepts in a more general context. Readers already familiar
with point set topology can safely skip this chapter.
A key concept in manifold theory is that of a diﬀerentiable map between manifolds. However, manifolds
are also topological spaces and diﬀerentiable maps are continuous. Topology is the study of continuity
in a general context, so it is appropriate to begin with it. Topology often involves interesting excursions
into pathological spaces and exotic theorems that can consume lifetimes. Such excursions are deliberately
minimized here. The examples will be ones most relevant to later developments, and the main thrust will
be to obtain a working knowledge of continuity, connectedness, and compactness. We shall take for granted
the usual logical structure of analysis, including properties of the real line and Euclidean space
1.1
Topological Spaces
The notion of a topological space is an abstraction of ideas about open sets in Rn that are learned in
advanced calculus.
1.1.1 Deﬁnition.
A topological space is a set S together with a collection O of subsets of S called open
sets such that
T1.
∅∈O and S ∈O;
T2.
if U1, U2 ∈O, then U1 ∩U2 ∈O;
T3.
the union of any collection of open sets is open.
The Real Line and n-space.
For the real line with its standard topology, we choose S = R, with
O, by deﬁnition, consisting of all sets that are unions of open intervals. Here is how to prove that this is a
topology: As exceptional cases, the empty set ∅∈O and R itself belong to O. Thus, T1 holds. For T2, let

2
1. Topology
U1 and U2 ∈O; to show that U1 ∩U2 ∈O, we can suppose that U1 ∩U2 ̸= ∅. If x ∈U1 ∩U2, then x lies
in an open interval ]a1, b1[ ⊂U1 and also in an interval ]a2, b2[ ⊂U2. We can write ]a1, b1[ ∩]a2, b2[ = ]a, b[
where a = max(a1, a2) and b = min(b1, b2). Thus x ∈]a, b[ ⊂U1 ∩U2. Hence U1 ∩U2 is the union of such
intervals, so is open. Finally, T3 is clear by deﬁnition.
Similarly, Rn may be topologized by declaring a set to be open if it is a union of open rectangles. An
argument similar to the one just given for R shows that this is a topology, called the standard topology
on Rn.
The Trivial and Discrete Topologies.
The trivial topology on a set S consists of O = {∅, S}. The
discrete topology on S is deﬁned by O = { A | A ⊂S }; that is, O consists of all subsets of S.
Closed Sets.
Topological spaces are speciﬁed by a pair (S, O); we shall, however, simply write S if there
is no danger of confusion.
1.1.2 Deﬁnition.
Let S be a topological space. A set A ⊂S will be called closed if its complement S\A
is open. The collection of closed sets is denoted C.
For example, the closed interval [0, 1] ⊂R is closed because it is the complement of the open set ]−∞, 0[∪
]1, ∞[.
1.1.3 Proposition.
The closed sets in a topological space S satisfy:
C1.
∅∈C and S ∈C;
C2.
if A1, A2 ∈C then A1 ∪A2 ∈C;
C3.
the intersection of any collection of closed sets is closed.
Proof.
Condition C1 follows from T1 since ∅= S\S and S = S\∅. The relations
S\(A1 ∪A2) = (S\A1) ∩(S\A2)
and
S\

i∈I
Bi

=

i∈I
(S\Bi)
for {Bi}i∈I a family of closed sets show that C2 and C3 are equivalent to T2 and T3, respectively.
■
Closed rectangles in Rn are closed sets, as are closed balls, one-point sets, and spheres. Not every set is
either open or closed. For example, the interval [0, 1[ is neither an open nor a closed set. In the discrete
topology on S, any set A ⊂S is both open and closed, whereas in the trivial topology any A ̸= ∅or S is
neither.
Closed sets can be used to introduce a topology just as well as open ones. Thus, if C is a collection
satisfying C1–C3 and O consists of the complements of sets in C, then O satisﬁes T1–T3.
Neighborhoods.
The idea of neighborhoods is to localize the topology.
1.1.4 Deﬁnition.
An open neighborhood of a point u in a topological space S is an open set U such
that u ∈U. Similarly, for a subset A of S, U is an open neighborhood of A if U is open and A ⊂U. A
neighborhood of a point (or a subset) is a set containing some open neighborhood of the point (or subset).
Examples of neighborhoods of x ∈R are ]x−1, x+3], ]x−ϵ, x+ϵ[ for any ϵ > 0, and R itself; only the last
two are open neighborhoods. The set [x, x + 2[ contains the point x but is not one of its neighborhoods. In
the trivial topology on a set S, there is only one neighborhood of any point, namely S itself. In the discrete
topology any subset containing p is a neighborhood of the point p ∈S, since {p} is an open set.

1.1 Topological Spaces
3
First and Second Countable Spaces.
1.1.5 Deﬁnition.
A topological space is called ﬁrst countable if for each u ∈S there is a sequence
{U1, U2, . . . } = {Un} of neighborhoods of u such that for any neighborhood U of u, there is an integer n such
that Un ⊂U. A subset B of O is called a basis for the topology, if each open set is a union of elements in
B. The topology is called second countable if it has a countable basis.
Most topological spaces of interest to us will be second countable. For example Rn is second countable
since it has the countable basis formed by rectangles with rational side length and centered at points all of
whose coordinates are rational numbers. Clearly every second-countable space is also ﬁrst countable, but
the converse is false. For example if S is an inﬁnite non-countable set, the discrete topology is not second
countable, but S is ﬁrst countable, since {p} is a neighborhood of p ∈S. The trivial topology on S is second
countable (see Exercises 1.1-9 and 1.1-10 for more interesting counter-examples).
1.1.6 Lemma (Lindel¨of’s Lemma).
Every covering of a set A in a second countable space S by a family
of open sets Ua (i.e., ∪aUa ⊃A) contains a countable subcollection also covering A.
Proof.
Let B = {Bn} be a countable basis for the topology of S. For each p ∈A there are indices n and α
such that p ∈Bn ⊂Uα. Let B′ = { Bn | there exists an α such that Bn ⊂Uα }. Now let Uα(n) be one of the
Uα that includes the element Bn of B′. Since B′ is a covering of A, the countable collection {Uα(n)} covers
A.
■
Closure, Interior, and Boundary.
1.1.7 Deﬁnition.
Let S be a topological space and A ⊂S. The closure of A, denoted cl(A) is the
intersection of all closed sets containing A. The interior of A, denoted int(A) is the union of all open sets
contained in A. The boundary of A, denoted bd(A) is deﬁned by
bd(A) = cl(A) ∩cl(S\A).
By C3, cl(A) is closed and by T3, int(A) is open. Note that as bd(A) is the intersection of closed sets,
bd(A) is closed, and bd(A) = bd(S\A).
On R, for example,
cl([0, 1[) = [0, 1],
int([0, 1[) = ]0, 1[,
and
bd([0, 1[) = {0, 1}.
The reader is assumed to be familiar with examples of this type from advanced calculus.
1.1.8 Deﬁnition.
A subset A of S is called dense in S if cl(A) = S, and is called nowhere dense if
S\ cl(A) is dense in S. The space S is called separable if it has a countable dense subset. A point u in S
is called an accumulation point of the set A if each neighborhood of u contains a point of A other than
itself. The set of accumulation points of A is called the derived set of A and is denoted by der(A). A point
of A is said to be isolated if it has a neighborhood in A containing no other points of A than itself.
The set A = [0, 1[ ∪{2} in R has the element 2 as its only isolated point, its interior is int(A) = ]0, 1[,
cl(A) = [0, 1] ∪{2}, and der(A) = [0, 1]. In the discrete topology on a set S, int{p} = cl{p} = {p}, for any
p ∈S.
Since the set Q of rational numbers is dense in R and is countable, R is separable. Similarly Rn is separable.
A set S with the trivial topology is separable since cl{p} = S for any p ∈S. But S = R with the discrete
topology is not separable since cl(A) = A for any A ⊂S. Any second-countable space is separable, but the
converse is false; see Exercises 1.1-9 and 1.1-10.
1.1.9 Proposition.
Let S be a topological space and A ⊂S. Then
(i) u ∈cl(A) iﬀfor every neighborhood U of u, U ∩A ̸= ∅;
(ii) u ∈int(A) iﬀthere is a neighborhood U of u such that U ⊂A;

4
1. Topology
(iii) u ∈bd(A) iﬀfor every neighborhood U of u, U ∩A ̸= ∅and U ∩(S\A) ̸= ∅.
Proof.
(i) u ̸∈cl(A) iﬀthere exists a closed set C ⊃A such that u ̸∈C. But this is equivalent to the
existence of a neighborhood of u not intersecting A, namely S\C. (ii) and (iii) are proved in a similar
way.
■
1.1.10 Proposition.
Let A, B and Ai, i ∈I be subsets of S. Then
(i) A ⊂B implies int(A) ⊂int(B), cl(A) ⊂cl(B), and der(A) ⊂der(B);
(ii) S\ cl(A) = int(S\A), S\ int(A) = cl(S\A), and cl(A) = A ∪der(A);
(iii) cl(∅) = int(∅) = ∅, cl(S) = int(S) = S, cl(cl(A)) = cl(A), and int(int(A)) = int(A);
(iv) cl(A ∪B) = cl(A) ∪cl(B), der(A ∪B) = der(A) ∪der(B), and int(A ∪B) ⊃int(A) ∪int(B);
(v) cl(A ∩B) ⊂cl(A) ∩cl(B), der(A ∩B) ⊂der(A) ∩der(B), and int(A ∩B) = int(A) ∩int(B);
(vi) cl(
i∈I Ai) ⊃
i∈I cl(Ai), cl(
i∈I Ai) ⊂
i∈I cl(Ai),
int(
i∈I Ai) ⊃
i∈I int(Ai), and int(
i∈I Ai) ⊂
i∈I int(Ai).
Proof.
(i), (ii), and (iii) are consequences of the deﬁnition and of Proposition 1.1.9. Since for each i ∈I,
Ai ⊂
i∈I Ai, by (i) cl(Ai) ⊂cl(
i∈I Ai) and hence 
i∈I cl(Ai) ⊂cl(
i∈I Ai). Similarly, since 
i∈I Ai ⊂
Ai ⊂cl(Ai) for each i ∈I, it follows that 
i∈I(Ai) is a subset of the closet set 
i∈I cl(Ai); thus by (i)
cl

i∈I
Ai

⊂cl

i∈I
cl(Ai)

=

i∈I
(cl(Ai)) .
The other formulas of (vi) follow from these and (ii). This also proves all the other formulas in (iv) and (v)
except the ones with equalities. Since cl(A) ∪cl(B) is closed by C2 and A ∪B ⊂cl(A) ∪cl(B), it follows by
(i) that cl(A ∪B) ⊂cl(A) ∪cl(B) and hence equality by (vi). The formula int(A ∩B) = int(A) ∩int(B) is a
corollary of the previous formula via (ii).
■
The inclusions in the above proposition can be strict. For example, if we let A = ]0, 1[ and B = [1, 2[ ,
then one ﬁnds that
cl(A) = der(A) = [0, 1], cl(B) = der(B) = [1, 2], int(A) = ]0, 1[,
int(B) = ]1, 2[, A ∪B = ]0, 2[, and A ∩B = ∅,
and therefore
int(A) ∪int(B) = ]0, 1[ ∪]1, 2[ ̸= ]0, 2[ = int(A ∪B),
and
cl(A ∩B) = ∅̸= {1} = cl(A) ∩cl(B).
Let An = ]−1/n, 1/n[, n = 1, 2, . . . , then

n≥1
An = {0},
int(An) = An
for all n, and
int
 
n≥1
An
	
= ∅̸= {0} =

n≥1
int(An).

1.1 Topological Spaces
5
Dualizing this via (ii) gives

n≥1
cl(R\An) = R\{0} ̸= R = cl
 
n≥1
(R\An)
	
.
If A ⊂B, there is, in general, no relation between the sets bd(A) and bd(B). For example, if A = [0, 1] and
B = [0, 2], A ⊂B, yet we have bd(A) = {0, 1} and bd(B) = {0, 2}.
Convergence and Limit Points.
The notion of a convergent sequence carries over from calculus in a
straightforward way.
1.1.11 Deﬁnition.
Let S be a topological space and {un} a sequence of points in S. The sequence is said
to converge if there is a point u ∈S such that for every neighborhood U of u, there is an N such that
n ≥N implies un ∈U. We say that un converges to u, or u is a limit point of {un}.
For example, the sequence {1/n} ∈R converges to 0. It is obvious that limit points of sequences un of dis-
tinct points are accumulation points of the set {un}. In a ﬁrst countable topological space any accumulation
point of a set A is a limit of a sequence of elements of A. Indeed, if {Un} denotes the countable collection
of neighborhoods of a ∈der(A) given by Deﬁnition 1.1.5, then choosing for each n an element an ∈Un ∩A
such that an ̸= a, we see that {an} converges to a. We have proved the following.
1.1.12 Proposition.
Let S be a ﬁrst-countable space and A ⊂S. Then u ∈cl(A) iﬀthere is a sequence
of points of A that converges to u (in the topology of S).
Separation Axioms.
It should be noted that a sequence can be divergent and still have accumulation
points. For example {2, 0, 3/2, −1/2, 4/3, −2/3, . . . } does not converge but has both 1 and −1 as accumula-
tion points. In arbitrary topological spaces, limit points of sequences are in general not unique. For example,
in the trivial topology of S any sequence converges to all points of S. In order to avoid such situations
several separation axioms have been introduced, of which the three most important ones will be mentioned.
1.1.13 Deﬁnition.
A topological space S is called Hausdorﬀif each two distinct points have disjoint
neighborhoods (i.e., with empty intersection). The space S is called regular if it is Hausdorﬀand if each
closed set and point not in this set have disjoint neighborhoods. Similarly, S is called normal if it is
Hausdorﬀand if each two disjoint closed sets have disjoint neighborhoods.
Most standard spaces that we meet in geometry and analysis are normal. The discrete topology on any
set is normal, but the trivial topology is not even Hausdorﬀ. It turns out that “Hausdorﬀ” is the necessary
and suﬃcient condition for uniqueness of limit points of sequences in ﬁrst countable spaces (see Exercise
1.1-5). Since in Hausdorﬀspace single points are closed (Exercise 1.1-6), we have the implications: normal
=⇒regular =⇒Hausdorﬀ. Counterexamples for each of the converses of these implications are given in
Exercises 1.1-9 and 1.1-10.
1.1.14 Proposition.
A regular second-countable space is normal.
Proof.
Let A and B be two disjoint closed sets in S. By regularity, for every point p ∈A there are disjoint
open neighborhoods Up of p and UB of B. Hence cl(Up) ∩B = ∅. Since { Up | p ∈A } is an open covering
of A, by the Lindel¨of lemma 1.1.6, there is a countable collection { Uk | k = 1, 2, . . . } covering A. Thus

k≥1 Uk ⊃A and cl(Uk) ∩B = ∅.
Similarly, ﬁnd a family {Vk} such that 
k≥0 Vk ⊃B and cl(Vk) ∪A = ∅. Then the sets Gn deﬁned
inductively by G0 = U0 and
Gn+1 = Un+1\

k=0,1,...,n
cl(Vk),
Hn = Vn\

k=0,1,...,n
cl(Uk)
are open and G = 
n≥0 Gn ⊃A, H = 
n≥0 Hn ⊃B are also open and disjoint.
■
In the remainder of this book, Euclidean n-space Rn will be understood to have the standard topology
unless explicitly stated to the contrary.

6
1. Topology
Some Additional Set Theory.
For technical completeness we shall present the axiom of choice and an
equivalent result. These notions will be used occasionally in the text, but can be skipped on a ﬁrst reading.
Axiom of choice.
If S is a collection of nonempty sets, then there is a function
χ : S →

S∈S
S
such
that
χ(S) ∈S for every S ∈S.
The function χ, called a choice function, chooses one element from each S ∈S. Even though this
statement seems self-evident, it has been shown to be equivalent to a number of nontrivial statements, using
other axioms of set theory. To discuss them, we need a few deﬁnitions. An order on a set A is a binary
relation, usually denoted by “≤” satisfying the following conditions:
a ≤a
(reﬂexivity),
a ≤b and b ≤a implies a = b
(antisymmetry), and
a ≤b and b ≤c implies a ≤c
(transitivity).
An ordered set A is called a chain if for every a, b ∈A, a ̸= b we have a ≤b or b ≤a. The set A is said
to be well ordered if it is a chain and every nonempty subset B has a ﬁrst element; i.e., there exists an
element b ∈B such that b ≤x for all x ∈B.
An upper bound u ∈A of a chain C ⊂A is an element for which c ≤u for all c ∈C. A maximal
element m of an ordered set A is an element for which there is no other a ∈A such that m ≤a, a ̸= m; in
other words x ≤m for all x ∈A that are comparable to m.
We state the following without proof.
Theorem.
Given other axioms of set theory, the following statements are equivalent:
(i) The axiom of choice.
(ii) Product Axiom. If {Ai}i∈I is a collection of nonempty sets then the product space

i∈I
Ai = { (xi) | xi ∈Ai }
is nonempty.
(iii) Zermelo’s Theorem. Any set can be well ordered.
(iv) Zorn’s Theorem. If A is an ordered set for which every chain has an upper bound (i.e., A is inductively
ordered), then A has at least one maximal element.
Exercises
⋄1.1-1.
Let A = { (x, y, z) ∈R3 | 0 ≤x < 1 and y2 + z2 ≤1 }. Find int(A).
⋄1.1-2.
Show that any ﬁnite set in Rn is closed.
⋄1.1-3.
Find the closure of the set { 1/n | n = 1, 2, . . . } in R.
⋄1.1-4.
Let A ⊂R. Show that sup(A) ∈cl(A) where sup(A) is the supremum (least upper bound) of A.
⋄1.1-5.
Show that a ﬁrst countable space is Hausdorﬀiﬀall sequences have at most one limit point.
⋄1.1-6.
(i) Prove that in a Hausdorﬀspace, single points are closed.
(ii) Prove that a topological space is Hausdorﬀiﬀthe intersection of all closed neighborhoods of a point
equals the point itself.

1.1 Topological Spaces
7
⋄1.1-7.
Show that in a Hausdorﬀspace S the following are equivalent;
(i)
S is regular;
(ii)
for every point p ∈S and any of its neighborhoods U, there exists a closed neighborhood V of p such
that V ⊂U;
(iii)
for any closed set A, the intersection of all of the closed neighborhoods of A equals A.
⋄1.1-8.
(i) Show that if V(p) denotes the set of all neighborhoods of a point p ∈S, a topological space,
then the following are satisﬁed:
V1.
if A ⊃U and U ∈V(p), then A ∈V(p);
V2.
every ﬁnite intersection of elements in V(p) is an element of V(p);
V3.
p belongs to all elements of V(p);
V4.
if V ∈V(p) then there is a set U ∈V(p), U ⊂V such that for all q ∈U, U ∈V(q).
(ii) If for each p ∈S there is a family V(p) of subsets of S satisfying V1–V4, prove that there is a unique
topology O on S such that for each p ∈S, the family V(p) is the set of neighborhoods of p in the
topology O.
Hint: Prove uniqueness ﬁrst and then deﬁne elements of O as being subsets A ⊂S satisfying: for
each p ∈A, we have A ∈V(p).
⋄1.1-9.
Let S = { p = (x, y) ∈R2 | y ≥0 } and denote the usual ε-disk about p in the plane R2 by
Dε(p) = { q | ∥q −p∥< e }. Deﬁne
Bε(p) =

Dε(p) ∩S,
if p = (x, y) with y > 0;
{ (x, y) ∈Dε(p) | y > 0 } ∪{p},
if p = (x, 0).
Prove the following:
(i) V(p) = { U ⊂S | there exists Bε(p) ⊂U } satisﬁes V1–V4 of Exercise 1.1-8. Thus S becomes a
topological space.
(ii) S is ﬁrst countable.
(iii) S is Hausdorﬀ.
(iv) S is separable.
Hint: The set { (x, y) ∈S | x, y ∈Q, y > 0 } is dense in S.
(v) S is not second countable.
Hint: Assume the contrary and get a contradiction by looking at the points (x, 0) of S.
(vi) S is not regular.
Hint: Try to separate the point (x0, 0) from the set { (x, 0) | x ∈R }\{(x0, 0)}.
⋄1.1-10.
With the same notations as in the preceding exercise, except changing Bε(p) to
Bε(p) =

Dε(p) ∩S,
if p = (x, y) with y > 0;
{ (x, y) ∈Dε(p) | y > 0 } ∪{p},
if p = (x, 0),
show that (i)–(v) of Exercise 1.1-9 remain valid and that

8
1. Topology
(vi) S is regular;
Hint: Use Exercise 1.1-7.
(vii) S is not normal.
Hint: Try to separate the set { (x, 0) | x ∈Q } from the set { (x, 0) | x ∈R\Q }.
⋄1.1-11.
Prove the following properties of the boundary operation and show by example that each inclusion
cannot be replaced by equality.
Bd1.
bd(A) = bd(S\A);
Bd2.
bd(bd(A) ⊂bd(A);
Bd3.
bd(A ∪B) ⊂bd(A) ∪bd(B) ⊂bd(A ∪B) ∪A ∪B;
Bd4.
bd(bd(bd(A))) = bd(bd(A)).
Properties Bd1–Bd4 may be used to characterize the topology.
⋄1.1-12.
Let p be a polynomial in n variables z1, . . . , zn with complex coeﬃcients. Show that p−1(0) has
open dense complement.
Hint: If p vanishes on an open set of Cn, then all its derivatives also vanish and hence all its coeﬃcients
are zero.
⋄1.1-13.
Show that a subset B of O is a basis for the topology of S if and only if the following three
conditions hold:
B1.
∅∈B;
B2.
∪B∈BB = S;
B3.
if B1, B2 ∈B, then B1 ∩B2 is a union of elements of B.
1.2
Metric Spaces
One of the common ways to form a topological space is through the use of a distance function, also called
a (topological) metric. For example, on Rn the standard distance
d(x, y) =
 n

i=1
(xi −yi)2
1
2
between x = (x1, . . . , xn) and y = (y1, . . . , yn) can be used to construct the open disks and from them the
topology. The abstraction of this proceeds as follows.
1.2.1 Deﬁnition.
Let M be a set. A metric (also called a topological metric) on M is a function
d : M × M →R such that for all m1, m2, m3 ∈M,
M1.
d(m1, m2) = 0 iﬀm1 = m2 (deﬁniteness);
M2.
d(m1, m2) = d(m2, m1) (symmetry); and
M3.
d(m1, m3) ≤d(m1, m2) + d(m2, m3) (triangle inequality).
A metric space is the pair (M, d); if there is no danger of confusion, just write M for (M, d).
Taking m1 = m3 in M3 shows that d(m1, m2) ≥0. It is proved in advanced calculus courses (and is
geometrically clear) that the standard distance on Rn satisﬁes M1–M3.

1.2 Metric Spaces
9
The Topology on a Metric Space.
The topology determined by a metric is deﬁned as follows.
1.2.2 Deﬁnition.
For ε > 0 and m ∈M, the open ε-ball (or disk) about m is deﬁned by
Dε(m) = { m′ ∈M | d(m′, m) < ε } ,
and the closed ε−ball is deﬁned by
Bε(m) = { m′ ∈M | d(m′, m) ≤ε } .
The collection of subsets of M that are unions of open disks deﬁnes the metric topology of the metric
space (M, d).
Two metrics on a set are called equivalent if they induce the same metric topology.
1.2.3 Proposition.
(i) The open sets deﬁned in the preceding deﬁnition is a topology.
(ii) A set U ⊂M is open iﬀfor each m ∈U there is an ε > 0 such that Dε(m) ⊂U.
Proof.
(i) T1 and T3 are clearly satisﬁed. To prove T2, it suﬃces to show that the intersection of two
disks is a union of disks, which in turn is implied by the fact that any point in the intersection of two
disks sits in a smaller disk included in this intersection. To verify this, suppose that p ∈Dε(m)∩Dδ(n)
and let 0 < r < min(ε −d(p, m), δ −d(p, n)). Hence Dr(p) ⊂Dε(m) ∩Dδ(n), since for any x ∈Dr(p),
d(x, m) ≤d(x, p) + d(p, m) < r + d(p, m) < ε,
and similarly d(x, n) < δ.
(ii) By deﬁnition of the metric topology, a set V is a neighborhood of m ∈M iﬀthere exists a disk
Dε(m) ⊂V. Thus the statement in the theorem is equivalent to U = int (U).
■
Notice that every set M can be made into a metric space by the discrete metric deﬁned by setting
d(m, n) = 1 for all m ̸= n. The metric topology of M is the discrete topology.
Pseudometric Spaces.
A pseudometric on a set M is a function d : M × M →R that satisﬁes M2,
M3, and
PM1.
d(m, m) = 0 for all m.
Thus the distance between distinct points can be zero for a pseudometric. The pseudometric topology is
deﬁned exactly as the metric space topology. Any set M can be made into a pseudometric space by the
trivial pseudometric: d(m, n) = 0 for all m, n ∈M; the pseudometric topology on M is the trivial
topology. Note that a pseudometric space is Hausdorﬀiﬀit is a metric space.
Metric Spaces are Normal.
To show that metric spaces are normal, it will be useful to have the notion
of the distance from a point to a set. If M is a metric space (or pseudometric space) and u ∈M, A ⊂M,
we deﬁne
d(u, A) = inf { d(u, v) | v ∈A }
if A ̸= ∅, and d(u, ∅) = ∞. The diameter of a set A ⊂M is deﬁned by
diam(A) = sup { d(u, v) | u, v ∈A } .
A set is called bounded if its diameter is ﬁnite.
Clearly metric spaces are ﬁrst-countable and Hausdorﬀ; in fact:

10
1. Topology
1.2.4 Proposition.
Every metric space is normal.
Proof.
Let A and B be closed, disjoint subsets of M, and let
U = { u ∈M | d(u, A) < d(u, B) } and V = { v ∈M | d(v, A) > d(v, B) } .
It is veriﬁed that U and V are open, disjoint and A ⊂U, B ⊂V.
■
Completeness.
We learn in calculus the importance of the notion of completeness of the real line. The
general notion of a complete metric space is as follows.
1.2.5 Deﬁnition.
Let M be a metric space with metric d and {un} a sequence in M. Then {un} is a
Cauchy sequence if for all real ε > 0, there is an integer N such that n, m ≥N implies d(un, um) < ε.
The space M is called complete if every Cauchy sequence converges.
We claim that a sequence {un} converges to u iﬀfor every ε > 0 there is an integer N such that n ≥N
implies d(un, u) < ε. This follows readily from the Deﬁnitions 1.1.11 and 1.2.2.
We also claim that a convergent sequence {un} is a Cauchy sequence. To see this, let ε > 0 be given.
Choose N such that n ≥N implies d(un, u) < ε/2. Thus, n, m ≥N implies
d(un, um) ≤d(un, u) + d(u, um) < ε
2 + ε
2 = ε
by the triangle inequality. Completeness requires that, conversely, every Cauchy sequence converges. A basic
fact about Rn is that with the standard metric, it is complete. The proof is found in any textbook on
advanced calculus.
Contraction Maps.
A key to many existence theorems in analysis is the following.
1.2.6 Theorem (Contraction Mapping Theorem).
Let M be a complete metric space and f : M →M a
mapping. Assume there is a constant k, where 0 ≤k < 1 such that
d(f(m), f(n)) ≤k d(m, n),
for all m, n ∈M; such an f is called a contraction. Then f has a unique ﬁxed point; that is, there exists
a unique m∗∈M such that f(m∗) = m∗.
Proof.
Let m0 be an arbitrary point of M and deﬁne recursively mi+1 = f(mi), i = 0, 1, 2, . . . . Induction
shows that
d(mi, mi+1) ≤ki d(m0, m1),
so that for i < j,
d(mi, mj) ≤(ki + · · · + kj−1) d(m0, m1).
For 0 ≤k < 1, 1 + k + k2 + k3 + . . . is a convergent series, and so
ki + ki+1 + · · · + kj−1 →0
as i, j →∞. This shows that the sequence {mi} is Cauchy and thus by completeness of M it converges to
a point m∗. Since
d(m∗, f(m∗)) ≤d(m∗, mi) + d(mi, f(mi)) + d(f(mi), f(m∗))
≤(1 + k) d(m∗, mi) + ki d(m0, m1)
is arbitrarily small, it follows that m∗= f(m∗), thus proving the existence of a ﬁxed point of f. If m′ is
another ﬁxed point of f, then
d(m′, m∗) = d(f(m′), f(m∗)) ≤k d(m′, m∗),
which, by virtue of 0 ≤k < 1, implies d(m′, m∗) = 0, so m′ = m∗. Thus we have uniqueness.
■

1.2 Metric Spaces
11
The condition k < 1 is necessary, for if M = R and f(x) = x + 1, then k = 1, but f has no ﬁxed point
(see also Exercise 1.5-5).
At this point the true signiﬁcance of the contraction mapping theorem cannot be demonstrated. When
applied to the right spaces, however, it will yield the inverse function theorem (Chapter 2) and the basic
existence theorem for diﬀerential equations (Chapter 4). A hint of this is given in Exercise 1.2-9.
Exercises
⋄1.2-1.
Let d((x1, y1), (x2, y2)) = sup(|x1 −x2|, |y1 −y2|). Show that d is a metric on R2 and is equivalent
to the standard metric.
⋄1.2-2.
Let f(x) = sin(1/x), x > 0. Find the distance between the graph of f and (0, 0).
⋄1.2-3.
Show that every separable metric space is second countable.
⋄1.2-4.
Show that every metric space has an equivalent metric in which the diameter of the space is 1.
Hint: Consider the new metric d1(m, n) = d(m, n)/[1 + d(m, n)].
⋄1.2-5.
In a metric space M, let V(m) = { U ⊂M | there exists ε > 0 such that Dε(m) ⊂U }. Show that
V(m) satisﬁes V1–V4 of Exercise 1.1-8. This shows how the metric topology can be deﬁned in an alternative
way starting from neighborhoods.
⋄1.2-6.
In a metric space show that cl(A) = { u ∈M | d(u, A) = 0 }.
Exercises 1.2-7–1.2-9 use the notion of continuity from elementary calculus (see Section 1.3).
⋄1.2-7.
Let M denote the set of continuous functions f : [0, 1] →R on the interval [0, 1]. Show that
d(f, g) =
 1
0
|f(x) −g(x)| dx
is a metric.
⋄1.2-8.
Let M denote the set of all continuous functions f : [0, 1] →R. Set
d(f, g) = sup { |f(x) −g(x)| | 0 ≤x ≤1 }
(i) Show that d is a metric on M.
(ii) Show that fn →f in M iﬀfn converges uniformly to f.
(iii) By consulting theorems on uniform convergence from your advanced calculus text, show that M is a
complete metric space.
⋄1.2-9.
Let M be as in the previous exercise and deﬁne T : M →M by
T(f)(x) = a +
 x
0
K(x, y) f(y) dy,
where a is a constant and K is a continuous function of two variables. Let
k = sup
  x
0
|K(x, y)|dy
 0 ≤x ≤1

and suppose k < 1. Prove the following:
(i) T is a contraction.
(ii) Deduce the existence of a unique solution of the integral equation
f(x) = a +
 x
0
K(x, y) f(y) dy.
(iii) Taking a special case of (ii), prove the “existence of ex.”

12
1. Topology
1.3
Continuity
Deﬁnition of Continuity.
We learn about continuity in calculus. Its general setting in topological spaces
is as follows.
1.3.1 Deﬁnition.
Let S and T be topological spaces and ϕ : S →T be a mapping. We say that ϕ is
continuous at u ∈S if for every neighborhood V of ϕ(u) there is a neighborhood U of u such that
ϕ(U) ⊂V . If, for every open set V of T, ϕ−1(V ) = { u ∈S | ϕ(u) ∈V } is open in S, ϕ is continuous.
(Thus, ϕ is continuous if ϕ is continuous at each u ∈S.) If the map ϕ : S →T is a bijection (i.e.,
one-to-one and onto), and both ϕ and ϕ−1 are continuous, ϕ is called a homeomorphism and S and T
are said to be homeomorphic.
For example, notice that any map from a discrete topological space to any topological space is continuous.
Similarly, any map from an arbitrary topological space to the trivial topological space is continuous. Hence
the identity map from the set S topologized with the discrete topology to S with the trivial topology is
bijective and continuous, but its inverse is not continuous, hence it is not a homeomorphism.
Properties of Continuous Maps.
It follows from Deﬁnition 1.3.1, by taking complements and using
the set theoretic identity S\ϕ−1(A) = ϕ−1(T\A), that ϕ : S →T is continuous iﬀthe inverse image of every
closed set is closed. Here are additional properties of continuous maps.
1.3.2 Proposition.
Let S, T be topological spaces and ϕ : S →T. The following are equivalent:
(i) ϕ is continuous;
(ii) ϕ(cl(A)) ⊂cl(ϕ(A)) for every A ⊂S;
(iii) ϕ−1(int(B)) ⊂int(ϕ−1(B)) for every B ⊂T.
Proof.
If ϕ is continuous, then ϕ−1(cl(ϕ(A))) is closed. But
A ⊂ϕ−1(cl(ϕ(A))),
and hence
cl(A) ⊂ϕ−1(cl(ϕ(A))),
that is, ϕ(cl(A)) ⊂cl(ϕ(A)). Conversely, let B ⊂T be closed and A = ϕ−1(B). Then
cl(A) ⊂ϕ−1(B) = A,
so A is closed. A similar argument shows that (ii) and (iii) are equivalent.
■
This proposition combined with Proposition 1.1.12 (or a direct argument) gives the following.
1.3.3 Corollary.
Let S and T be topological spaces with S ﬁrst countable and ϕ : S →T. The map ϕ is
continuous iﬀfor every sequence {un} converging to u, {ϕ(un)} converges to ϕ(u), for all u ∈S.
1.3.4 Proposition.
The composition of two continuous maps is a continuous map.
Proof.
If ϕ1 : S1 →S2 and ϕ2 : S2 →S3 are continuous maps and if U is open in S3, then (ϕ2◦ϕ1)−1(U) =
ϕ−1
1 (ϕ−1
2 (U)) is open in S1 since ϕ−1
2 (U) is open in S2 by continuity of ϕ2 and hence its inverse image by
ϕ1 is open in S1, by continuity of ϕ1.
■
1.3.5 Corollary.
The set of all homeomorphisms of a topological space to itself forms a group under
composition.

1.3 Continuity
13
Proof.
Composition of maps is associative and has for identity element the identity mapping. Since the
inverse of a homeomorphism is a homeomorphism by deﬁnition, and since for any two homeomorphisms
ϕ1, ϕ2 of S to itself, the maps ϕ1 ◦ϕ2 and (ϕ1 ◦ϕ2)−1 = ϕ−1
2
◦ϕ−1
1
are continuous by Proposition 1.3.4, the
corollary follows.
■
1.3.6 Proposition.
The space of continuous maps f : S →R forms an algebra under pointwise addition
and multiplication. That is, if f and g are continuous, then so are f + g and fg.
Proof.
Let s0 ∈S be ﬁxed and ε > 0. By continuity of f and g at s0, there exists an open set U in S such
that
|f(s) −f(s0)| < ε
2,
and
|g(s) −g(s0)| < ε
2
for all s ∈U. Then
|(f + g)(s) −(f + g)(s0)| ≤|f(s) −f(s0)| + |g(s) −g(s0)| < ε.
Similarly, for ε > 0, choose a neighborhood V of s0 such that
|f(s) −f(s0)| < δ,
|g(s) −g(s0)| < δ
for all s ∈V , where δ is any positive number satisfying
(δ + |f(s0)|)δ + |g(s0)|δ < ε.
Then
|(fg)(s) −(fg)(s0)| ≤|(f(s)| |g(s) −g(s0)| + |f(s) −f(s0)| |g(s0)|
< (δ + |f(s0)|)δ + δ|g(s0)| < ε.
Therefore, f + g and fg are continuous at s0.
■
Open and Closed Maps.
Continuity is deﬁned by requiring that inverse images of open (closed) sets
are open (closed). In many situations it is important to ask whether the image of an open (closed) set is
open (closed).
1.3.7 Deﬁnition.
A map ϕ : S →T, where S and T are topological spaces, is called open (resp., closed)
if the image of every open (resp., closed) set in S is open (resp., closed) in T.
Thus, a homeomorphism is a bijective continuous open (closed) map.
An example of an open map that is not closed is
ϕ : ]0, 1[ →R,
x →x,
the inclusion map. An example of a closed map that is not open is
ϕ : R →R,
deﬁned by x →x2
which maps ]−1, 1[ to [0, 1[. An example of a map that is neither open nor closed is the map
ϕ : ]−1, 1[→R,
deﬁned by x →x2.
Finally, note that the identity map of a set S topologized with the trivial and discrete topologies on the
domain and range, respectively, is not continuous but is both open and closed.

14
1. Topology
Continuous Maps between Metric Spaces.
For these spaces, continuity may be expressed in terms
of ε’s and δ’s familiar from calculus.
1.3.8 Proposition.
Let (M1, d1) and (M2, d2) be metric spaces, and ϕ : M1 →M2 a given mapping.
Then ϕ is continuous at u1 ∈M1 iﬀfor every ε > 0 there is a δ > 0 such that d1(u1, u′
1) < δ implies
d2(ϕ(u1), ϕ(u′
1)) < ε.
Proof.
Let ϕ be continuous at u1 and consider D2
ε(ϕ(u1)), the ε-disk at ϕ(u1)) in M2. Then there is a
δ-disk D1
δ(u1) in M1 such that
ϕ(D1
δ(u1)) ⊂D2
ε(ϕ(u1))
by Deﬁnition 1.3.1; that is, (u1, u′
1) < δ implies
d2(ϕ(u1), ϕ(u′
1)) < ε.
Conversely, assume this latter condition is satisﬁed and let V be a neighborhood of ϕ(u1) in M2. Choosing
an ε-disk D2
ε(ϕ(u1)) ⊂V there exists δ > 0 such that ϕ(D1
δ(u1)) ⊂D2
ε(ϕ(u1)) by the foregoing argument.
Thus ϕ is continuous at u1.
■
Uniform Continuity and Convergence.
In a metric space we also have the notions of uniform conti-
nuity and uniform convergence.
1.3.9 Deﬁnition.
(i) Let (M1, d1) and (M2, d2) be metric spaces and ϕ : M1 →M2. We say ϕ
is uniformly continuous if for every ε > 0 there is a δ > 0 such that d1(u, v) < δ implies
d2(ϕ(u), ϕ(v)) < ε.
(ii) Let S be a set, M a metric space, ϕn : S →M, n = 1, 2, . . . , and ϕ : S →M be given mappings. We
say ϕn →ϕ uniformly if for every ε > 0 there is an N such that d(ϕn(u), ϕ(u)) < ε for all n ≥N
and all u ∈S.
For example, a map satisfying d(ϕ(u), ϕ(v)) ≤Kd(u, v) for a constant K is uniformly continuous. Uniform
continuity and uniform convergence ideas come up in the construction of a metric on the space of continuous
maps. This is considered next.
1.3.10 Proposition.
Let M be a topological space and (N, d) a complete metric space. Then the collection
C(M, N) of all bounded continuous maps ϕ : M →N forms a complete metric space with the metric
d0(ϕ, ψ) = sup{ d(ϕ(u), ψ(u)) | u ∈M }.
Proof.
It is readily veriﬁed that d0 is a metric. Convergence of a sequence fn ∈C(M, N) to f ∈C(M, N) in
the metric d0 is the same as uniform convergence, as is readily checked. (See Exercise 1.2-8.) Now, if {fn}
is a Cauchy sequence in C(M, N), then {fn(x)} is Cauchy for each x ∈M since d(fn(x), fm(x)) ≤d0(fn, fm).
Thus fn converges pointwise, deﬁning a function f(x). We must show that fn →f uniformly and that f is
continuous. First, given ε > 0, choose N such that d0(fn, fm) < ε/2 if n, m ≥N. Second, for any x ∈M,
pick Nx ≥N so that
d(fm(x), f(x)) < ε
2
if m ≥Nx. Thus with n ≥N and m ≥Nx,
d(fn(x), f(x)) ≤d(fn(x), fm(x)) + d(fm(x), f(x)) < ε
2 + ε
2 = ε,
so fn →f uniformly. The reader can similarly verify that f is continuous (see Exercise 1.3-6; look in any
advanced calculus text such as Marsden and Hoﬀman [1993] for the case of Rn if you get stuck).
■

1.4 Subspaces, Products, and Quotients
15
Exercises
⋄1.3-1.
Show that a map ϕ : S →T between the topological spaces S and T is continuous iﬀfor every set
B ⊂T, cl(ϕ−1(B)) ⊂ϕ−1(cl(B)). Show that continuity of ϕ does not imply any inclusion relations between
ϕ(int(A)) and int(ϕ(A)).
⋄1.3-2.
Show that a map ϕ : S →T is continuous and closed if for every subset U ⊂S, ϕ(cl(U)) = cl(ϕ(U)).
⋄1.3-3.
Show that compositions of open (closed) mappings are also open (closed) mappings.
⋄1.3-4.
Show that ϕ : ]0, ∞[ →]0, ∞[ deﬁned by ϕ(x) = 1/x is continuous but not uniformly continuous.
⋄1.3-5.
Show that if d is a pseudometric on M, then the map d(·, A) : M →R, for A ⊂M a ﬁxed subset,
is continuous.
⋄1.3-6.
If S is a topological space, T a metric space, and ϕn : S →T a sequence of continuous functions
uniformly convergent to a mapping ϕ : S →T, then ϕ is continuous.
1.4
Subspaces, Products, and Quotients
This section concerns the construction of new topological spaces from old ones.
Subset Topology.
The ﬁrst basic operation of this type we consider is the formation of subset topologies.
1.4.1 Deﬁnition.
If A is a subset of a topological space S with topology O, the relative topology on A
is deﬁned by OA = {U ∩A | U ∈O} .
In other words, the open subsets in A are declared to be those subsets that are intersections of open sets
in S with A. The following identities show that OA is indeed a topology:
(i) ∅∩A = ∅, S ∩A = A;
(ii) (U1 ∩A) ∩(U2 ∩A) = (U1 ∩U2) ∩A; and
(iii) 
α(Uα ∩A) = (
α Uα) ∩A.
Example.
The topology on the n −1-dimensional sphere Sn−1 = { x ∈Rn | d(x, 0) = 1 } is the relative
topology induced from Rn; that is, a neighborhood of a point x ∈Sn−1 is a subset of Sn−1 containing the
set Dε(x) ∩Sn−1 for some ε > 0. Note that an open (closed) set in the relative topology of A is in general
not open (closed) in S. For example, Dε(x) ∩Sn−1 is open in Sn−1 but it is neither open nor closed in Rn.
However, if A is open (closed) in S, then any open (closed) set in the relative topology is also open (closed)
in S.
If ϕ : S →T is a continuous mapping, then the restriction ϕ|A : A →T is also continuous in the relative
topology. The converse is false. For example, the mapping ϕ : R →R deﬁned by ϕ(x) = 0 if x ∈Q and
ϕ(x) = 1 if x ∈R\Q is discontinuous, but ϕ|Q : Q →R is a constant mapping and is thus continuous.
Products.
We can build up larger spaces by taking products of given ones.
1.4.2 Deﬁnition.
Let S and T be topological spaces and
S × T = { (u, v) | u ∈S and v ∈T }.
The product topology on S × T consists of all subsets that are unions of sets which have the form U × V,
where U is open in S and V is open in T. Thus, these open rectangles form a basis for the topology.

16
1. Topology
Products of more than two factors can be considered in a similar way; it is straightforward to verify that
the map ((u, v), w) →(u, (v, w)) is a homeomorphism of (S × T) × Z onto S × (T × Z). Similarly, one sees
that S × T is homeomorphic to T × S. Thus one can take products of any number of topological spaces
and the factors can be grouped in any order; we simply write S1 × · · · × Sn for such a ﬁnite product. For
example, Rn has the product topology of R × · · · × R (n times). Indeed, using the maximum metric
d(x, y) = max
1≤i≤n(|xi −yi|),
which is equivalent to the standard one, we see that the ε-disk at x coincides with the set
]x1 −ε, x1 + ε[ × · · · × ]xn −ε, xn + ε[.
For generalizations to inﬁnite products see Exercise 1.4-11, and to metric spaces see Exercise 1.4-14.
1.4.3 Proposition.
Let S and T be topological spaces and denote by p1 : S × T →S and p2 : S × T →T
the canonical projections: p1(s, t) = s and p2(s, t) = t. Then
(i) p1 and p2 are open mappings; and
(ii) a mapping ϕ : X →S×T, where X is a topological space, is continuous iﬀboth the maps p1◦ϕ : X →S
and p2 ◦ϕ : X →T are continuous.
Proof.
(i) follows directly from the deﬁnitions.
(ii) ϕ is continuous iﬀϕ−1(U × V ) is open in X, for U ⊂S and V ⊂T open sets. Since
ϕ−1(U × V ) = ϕ−1(U × T) ∩ϕ−1(S × V )
= (p1 ◦ϕ)−1(U) ∩(p2 ◦ϕ)−1(V ),
the assertion follows.
■
In general, the maps pi, i = 1, 2, are not closed. For example, if S = T = R the set A = { (x, y) | xy =
1, x > 0 } is closed in S × T = R2, but p1(A) = ]0, ∞[ which is not closed in S.
1.4.4 Proposition.
A topological space S is Hausdorﬀiﬀthe diagonal which is deﬁned by ∆S = { (s, s) |
s ∈S } ⊂S × S is a closed subspace of S × S, with the product topology.
Proof.
It is enough to remark that S is Hausdorﬀiﬀfor every two distinct points p, q ∈S there exist
neighborhoods Up, Uq of p, q, respectively, such that (Up × Uq) ∩∆S = ∅.
■
Quotient Spaces.
In a number of places later in the book we are going to form new topological spaces
by collapsing old ones. We deﬁne this process now and give some examples.
1.4.5 Deﬁnition.
Let S be a set. An equivalence relation ∼on S is a binary relation such that for all
u, v, w ∈S,
(i) u ∼u
(reﬂexivity);
(ii) u ∼v iﬀv ∼u
(symmetry); and
(iii) u ∼v and v ∼w implies u ∼w
(transitivity).
The equivalence class containing u, denoted [u] , is deﬁned by
[u] = { v ∈S | u ∼v }.
The set of equivalence classes is denoted S/∼, and the mapping π : S →S/∼deﬁned by u →[u] is called
the canonical projection.

1.4 Subspaces, Products, and Quotients
17
Note that S is the disjoint union of its equivalence classes. The collection of subsets U of S/∼such that
π−1(U) is open in S is a topology because
(i) π−1(∅) = ∅, π−1(S/∼) = S;
(ii) π−1(U1 ∩U2) = π−1(U1) ∩π−1(U2); and
(iii) π−1(
α Uα) = 
α π−1(Uα).
1.4.6 Deﬁnition.
Let S be a topological space and ∼an equivalence relation on S. Then the collection of
sets { U ⊂S/∼| π−1(U) is open in S } is called the quotient topology on S/∼.
1.4.7 Examples.
A. The Torus.
Consider R2 and the relation ∼deﬁned by
(a1, a2) ∼(b1, b2)
if a1 −b1 ∈Z and a2 −b2 ∈Z
(Z denotes the integers). Then T2 = R2/∼is called the 2-torus. In addition to the quotient topology, it
inherits a group structure by setting [(a1, a2)] + [(b1, b2)] = [(a1, a2) + (b1, b2)]. The n-dimensional torus Tn
is deﬁned in a similar manner.
The torus T2 may be obtained in two other ways. First, let □be the unit square in R2 with the subspace
topology. Deﬁne ∼by x ∼y iﬀany of the following hold:
(i) x = y;
(ii) x1 = y1, x2 = 0, y2 = 1;
(iii) x1 = y1, x2 = 1, y2 = 0;
(iv) x2 = y2, x1 = 0, y1 = 1; or
(v) x2 = y2, x1 = 1, y1 = 0,
as indicated in Figure 1.4.1. Then T2 = □/∼. Second, deﬁne T2 = S1 × S1, also shown in Figure 1.4.1.
Figure 1.4.1. A torus
B. The Klein bottle.
The Klein bottle is obtained by reversing one of the orientations on □, as indicated
in Figure 1.4.2. Then K = □/∼(the equivalence relation indicated) is the Klein bottle. Although it is
realizable as a subset of R4, it is convenient to picture it in R3 as shown. In a sense we will make precise
in Chapter 6, one can show that K is not “orientable.” Also note that K does not inherit a group structure
from R2, as did T2.

18
1. Topology
Figure 1.4.2. A Klein bottle
C. Projective Space.
On Rn\{0} deﬁne x ∼y if there is a nonzero real constant λ such that x = λy.
Then (Rn\{0})/∼is called real projective (n −1)-space and is denoted by RPn−1. Alternatively, RPn−1
can be deﬁned as Sn−1 (the unit sphere in Rn) with antipodal points x and −x identiﬁed. (It is easy to
see that this gives a homeomorphic space.) One deﬁnes complex projective space CPn−1 in an analogous
way where now λ is complex.
♦
Continuity of Maps on Quotients.
The following is a convenient way to tell when a map on a quotient
space is continuous.
1.4.8 Proposition.
Let ∼be an equivalence relation on the topological space S and π : S →S/∼the
canonical projection. A map ϕ : S/∼→T, where T is another topological space, is continuous iﬀϕ ◦π :
S →T is continuous.
Proof.
ϕ is continuous iﬀfor every open set V ⊂T, ϕ−1(V ) is open in S/∼, that is, iﬀthe set (ϕ◦π)−1(V )
is open in S.
■
1.4.9 Deﬁnition.
The set Γ = { (s, s′) | s ∼s′ } ⊂S ×S is called the graph of the equivalence relation ∼.
The equivalence relation is called open (closed) if the canonical projection π : S →S/∼is open (closed).
We note that ∼is open (closed) iﬀfor any open (closed) subset A of S the set π−1(π(A)) is open (closed).
As in Proposition 1.4.8, for an open (closed) equivalence relation ∼on S, a map ϕ : S/∼→T is open
(closed) iﬀϕ ◦π : S →T is open (closed). In particular, if ∼is an open (closed) equivalence relation on S
and ϕ : S/∼→T is a bijective continuous map, then ϕ is a homeomorphism iﬀϕ ◦π is open (closed).
1.4.10 Proposition.
If S/∼is Hausdorﬀ, then the graph Γ of ∼is closed in S × S. If the equivalence
relation ∼is open and Γ is closed (as a subset of S × S), then S/∼is Hausdorﬀ.
Proof.
If S/∼is Hausdorﬀ, then ∆S/∼is closed by Proposition 1.4.4 and hence Γ = (π × π)−1(∆S/∼) is
closed on S × S, where
π × π : S × S →(S/∼) × (S/∼)
is given by (π × π)(x, y) = ([x], [y]).
Assume that Γ is closed and ∼is open. If S/∼is not Hausdorﬀthen there are distinct points [x], [y] ∈S/∼
such that for any pair of neighborhoods Ux and Uy of [x] and [y], respectively, we have Ux ∩Uy ̸= ∅. Let Vx
and Vy be any open neighborhoods of x and y, respectively. Since ∼is an open equivalence relation,
π(Vx) = Ux
and
π(Vy) = Uy

1.4 Subspaces, Products, and Quotients
19
are open neighborhoods of [x] and [y] in S/∼. Since Ux ∩Uy ̸= ∅, there exist x′ ∈Vx and y′ ∈Vy such that
[x′] = [y′]; that is, (x′, y′) ∈Γ. Thus (x, y) ∈cl(Γ) by Proposition 1.1.9(i). As Γ is closed, (x, y) ∈Γ, that is,
[x] = [y], a contradiction.
■
Exercises
⋄1.4-1.
Show that the sequence xn = 1/n in the topological space ]0, 1] (with the relative topology from
R) does not converge.
⋄1.4-2.
If f : S →T is continuous and T is Hausdorﬀ, show that the graph of f, Γf = { (s, f(s)) | s ∈S }
is closed in S × T.
⋄1.4-3.
Let X and Y be topological spaces with Y Hausdorﬀ. Show that for any continuous maps f, g :
X →Y , the set { x ∈X | f(x) = g(x) } is closed in X.
Hint: Consider the mapping x →(f(x), g(x)) and use Proposition 1.4.4. Thus, if f(x) = g(x) at all points
of a dense subset of X, then f = g.
⋄1.4-4.
Deﬁne a topological manifold to be a space locally homeomorphic to Rn. Find a topological
manifold that is not Hausdorﬀ.
Hint: Consider R with “extra origins.”
⋄1.4-5.
Show that a mapping ϕ : S →T is continuous iﬀthe mapping s →(s, f(s)) of S to the graph
Γf = { (s, f(s)) | s ∈S } ⊂S × S is a homeomorphism of S with Γf (give Γf the subspace topology induced
from the product topology of S × T).
⋄1.4-6.
Show that every subspace of a Hausdorﬀ(resp., regular) space is Hausdorﬀ(resp., regular). Con-
versely, if each point of a topological space has a closed neighborhood that is Hausdorﬀ(resp., regular) in
the subspace topology, then the topological space is Hausdoﬀ(resp., regular).
Hint: use Exercises 1.1-6 and 1.1-7.
⋄1.4-7.
Show that a product of topological spaces is Hausdorﬀiﬀeach factor is Hausdorﬀ.
⋄1.4-8.
Let S, T be topological spaces and ∼, ≈be equivalence relations on S and T, respectively. Let
ϕ : S →T be continuous such that s1 ∼s2 implies ϕ(s1) ≈ϕ(s2). Show that the induced mapping
ˆϕ : S/∼→T/≈is continuous.
⋄1.4-9.
Let S be a Hausdorﬀspace and assume there is a continuous map σ : S/ ∼
→S such that
π ◦σ = iS/∼, the identity. Show that S/∼is Hausdorﬀand σ(S/∼) is closed in S.
⋄1.4-10.
Let M and N be metric spaces, N complete, and ϕ : A →N be uniformly continuous (A with the
induced metric topology). Show that ϕ has a unique extension ϕ : cl(A) →N that is uniformly continuous.
⋄1.4-11.
Let S be a set, Tα a family of topological spaces, and ϕα : S →Tα a family of mappings. Let B
be the collection of ﬁnite intersections of sets of the form ϕ−1
α (Uα) for Uα open in Tα. The initial topology
on S given by the family ϕα : S →Tα has as basis the collection B. Show that this topology is characterized
by the fact that any mapping ϕ : R →S from a topological space R is continuous iﬀall ϕα ◦ϕ : R →Tα
are continuous. Show that the subspace and product topologies are initial topologies. Deﬁne the product of
an arbitrary inﬁnite family of topological spaces and describe the topology.
⋄1.4-12.
Let T be a set and ϕα : Sα →T a family of mappings, Sα topological spaces with topologies Oα.
Let O = { U ⊂T | ϕ−1
α (U) ∈O for each α }. Show that O is a topology on T, called the ﬁnal topology on
T given by the family ϕα : Sα →T. Show that this topology is characterized by the fact that any mapping
ϕ : T →R is continuous iﬀϕ ◦ϕα : Sα →R are all continuous. Show that the quotient topology is a ﬁnal
topology.
⋄1.4-13.
Show that in a complete metric space a subspace is closed iﬀit is complete.
⋄1.4-14.
Show that a product of two metric spaces is also a metric space by ﬁnding at least three equivalent
metrics. Show that the product is complete if each factor is complete.

20
1. Topology
1.5
Compactness
Some basic theorems of calculus, such as “every real valued continuous function on [a, b] attains its maximum
and minimum” implicitly use the fact that [a, b] is compact.
Deﬁnition of Compactness.
The general deﬁnition of compactness is rather unintuitive at the beginning.
In fact, the general formulation of compactness and the realization of it as a useful tool is one of the excellent
achievements of topology. But one has to be patient to see the rewards of formulating the deﬁnition the way
it is done.
1.5.1 Deﬁnition.
Let S be a topological space. Then S is called compact if for every covering of S by
open sets Uα (i.e., 
α Uα = S) there is a ﬁnite subcollection of the Uα also covering S. A subset A ⊂S is
called compact if A is compact in the relative topology. A subset A is called relatively compact if cl(A)
is compact. A space is called locally compact if it is Hausdorﬀand each point has a relatively compact
neighborhood.
Properties of Compactness.
We shall soon see the true power of this notion, but lets work up to this
with some simple observations.
1.5.2 Proposition.
(i) If S is compact and A ⊂S is closed, then A is compact.
(ii) If ϕ : S →T is continuous and S is compact, then ϕ(S) is compact.
Proof.
(i) Let {Uα} be an open covering of A. Then {Uα, S\A} is an open covering of S and hence
contains a ﬁnite subcollection of this covering also covering S. The elements of this collection, except
S\A, cover A.
(ii) Let {Uα} be an open covering of ϕ(S). Then {ϕ−1(Uα)} is an open covering of S and thus by compact-
ness of S a ﬁnite subcollection { ϕ−1(Uα(i)) | i = 1, . . . , n }, covers S. But then {Uα(i)}, i = 1, . . . , n
covers ϕ(S) and thus ϕ(S) is compact.
■
In a Hausdorﬀspace, compact subsets are closed (exercise). Thus if S is compact, T is Hausdorﬀand ϕ
is continuous, then ϕ is closed; if ϕ is also bijective, then it is a homeomorphism.
Compactness of Products.
It is a basic fact that the product of compact spaces is compact.
1.5.3 Proposition.
A product space S × T is compact iﬀboth S and T are compact.
Proof.
In view of Proposition 1.5.2 all we have to show is that if S and T are compact, so is S × T. Let
{Aα} be a covering of S × T by open sets. Each Aα is the union of sets of the form U × V with U and V
open in S and T, respectively. Let {Uβ × Vβ} be a covering of S × T by open rectangles. If we show that
there exists a ﬁnite subcollection of Uβ × Vβ covering S × T, then clearly also a ﬁnite subcollection of {Aα}
will cover S × T.
A ﬁnite subcollection of {Uβ × Vβ} is found in the following way. Fix s ∈S. Since the set {s} × T is
compact, there is a ﬁnite collection
US × Vβ1, . . . , US × Vβi(s)
covering it. If US = 
j=1,...,i(s) Uβj, then Us is open, contains s, and
Us × Vβ1, . . . , US × Vβi(s)

1.5 Compactness
21
covers {s} × T. Let Ws = Us × T; then the collection {Ws} is an open covering of S × T and if we show
that only a ﬁnite number of these Ws cover S × T, then since
Ws =

j=1,...,i(s)
(Us × Vβj),
it follows that a ﬁnite number of Uβ × Vβ will cover S × T. Now look at S × {t}, for t ∈T ﬁxed. Since this
is compact, a ﬁnite subcollection Ws1, . . . , Wsk covers it. But then

j=1,...,k
Wsi = S × T,
(1.5.1)
which proves the result.
■
As we shall see shortly in Theorem 1.5.9, [−1, 1] is compact. Thus T1 is compact. It follows from Proposition
1.5.3 that the torus T2, and inductively Tn, are compact. Thus, if π : R2 →T2 is the canonical projection
we see that T2 is compact without R2 being compact; that is, the converse of Proposition 1.5.2(ii) is false.
Nevertheless it sometimes occurs that one does have a converse; this leads to the notion of a proper map
discussed in Exercise 1.5-10.
Bolzano–Weierstrass Theorem.
This theorem links compactness with convergence of sequences.
1.5.4 Theorem (Bolzano–Weierstrass Theorem).
If S is a compact ﬁrst countable Hausdorﬀspace, then
every sequence has a convergent subsequence.1 The converse is also true in metric and second-countable
Hausdorﬀspaces.
Proof.
Suppose S is compact and {un} contains no convergent subsequences. We may assume that the
points of the sequence are distinct. Then cl({un}) = {un} is compact and since S is ﬁrst countable, each un
has a neighborhood Un that contains no other um, for otherwise un would be a limit of a subsequence. Thus
{Un} is an open covering of the compact subset {un} which contains no ﬁnite subcovering, a contradiction.
Let S be second countable, Hausdorﬀ, and such that every sequence has a convergent subsequence. If
{Uα} is an open covering of S, by the Lindel¨of lemma there is a countable collection { Un | n = 1, 2 . . . } also
covering S. Thus we have to show that { Un | n = 1, 2, . . . } contains a ﬁnite collection covering S. If this is
not the case, the family consisting of sets of the form
S\

i=1,...,n
Ui
consists of closed nonempty sets and has the property that
S\

i=1,...,n
Ui ⊃S\

i=1,...,m
Ui
for m ≥n. Choose
pn ∈S\

i=1,...,n
Ui.
If { pn | n = 1, 2, . . . } is inﬁnite, by hypothesis it contains a convergent subsequence; let its limit point be
denoted p. Then
p ∈S\

i=1,...,n
Ui
1There are compact Hausdorﬀspaces in which there are sequences with no convergent subsequences. See page 69 of Sims
[1976] for more information.

22
1. Topology
for all n, contradicting the fact that { Un | n = 1, 2, . . . } covers S. Thus, { pn | n = 1, 2, . . . } must be a ﬁnite
set; that is, for all n ≥N, pn = pN. But then again
pN ∈S\

i=1,...,n
Ui
for all n, contradicting the fact that { Un | n = 1, 2, . . . } covers S. Hence S is compact.
Let S be a metric space such that every sequence has a convergent subsequence. If we show that S
is separable, then since S is a metric space it is second countable (Exercise 1.2-3), and by the preceding
paragraph, it will be compact. Separability of S is proved in two steps.
First we show that for any ε > 0 there is a ﬁnite set of points {p1, . . . , pn} such that S = 
i=1,...,n Dε(pi).
If this were false, there would exist an ε > 0 such that no ﬁnite number of ε-disks cover S. Let p1 ∈S be
arbitrary. Since Dε(p1) ̸= S, there is a point p2 ∈S\Dε(p1). Since
Dε(p1) ∪Dε(p2) ̸= S,
there is also a point
p3 ∈S\(Dε(p1) ∪Dε(p2)),
etc. The sequence { pn | n = 1, 2, . . . } is inﬁnite and d(pi, pj) ≥ε. But this sequence has a convergent
subsequence by hypothesis, so this subsequence must be Cauchy, contradicting d(pi, pj) ≥ε for all i, j.
Second, we show that the existence for every ε > 0 of a ﬁnite set {p1, . . . , pn(ε)} such that
S =

i=1,...,n(ε)
Dε(pi)
implies S is separable. Let An denote this ﬁnite set for ε = 1/n and let
A =

n≥0
An.
Thus A is countable and it is easily veriﬁed that cl(A) = S.
■
Total Boundedness.
A property that came up in the preceding proof turns out to be important.
1.5.5 Deﬁnition.
Let S be a metric space. A subset A ⊂S is called totally bounded if for any ε > 0
there exists a ﬁnite set {p1, . . . , pn} in S such that
A ⊂

i=1,...,n
Dε(pi).
1.5.6 Corollary.
A metric space is compact iﬀit is complete and totally bounded. A subset of a complete
metric space is relatively compact iﬀit is totally bounded.
Proof.
The previous proof shows that compactness implies total boundedness. As for compactness im-
plying completeness, it is enough to remark that in this context, a Cauchy sequence having a convergent
subsequence is itself convergent. Conversely, if S is complete and totally bounded, let { pn | n = 1, 2, . . . } be
a sequence in S. By total boundedness, this sequence contains a Cauchy subsequence, which by complete-
ness, converges. Thus S is compact by the Bolzano–Weierstrass theorem. The second statement now readily
follows.
■
1.5.7 Proposition.
In a metric space compact sets are closed and bounded.

1.5 Compactness
23
Proof.
This is a particular case of the previous corollary but can be easily proved directly. If A is compact,
it can be ﬁnitely covered by ε-disks:
A =

i=1,...,n
Dε(pi).
Thus,
diam(A) ≤
n

i=1
diam(Dε(pi)) = 2nε.
■
From Proposition 1.5.2 and Proposition 1.5.7, we conclude that
1.5.8 Corollary.
If S is compact and ϕ : S →R is continuous, then ϕ is bounded and attains its sup and
inf.
Indeed, since S is compact, so is ϕ(S) and so ϕ(S) is closed and bounded. Thus (see Exercise 1.1-4) the
inf and sup of this set are ﬁnite and are members of this set.
Heine–Borel Theorem.
This result makes it easy to spot compactness in Euclidean spaces.
1.5.9 Theorem (Heine–Borel Theorem).
In Rn a closed and bounded set is compact.
Proof.
By Proposition 1.5.2(i) it is enough to show that closed bounded rectangles are compact in Rn,
which in turn is implied via Proposition 1.5.3 by the fact that closed bounded intervals are compact in R. To
show that [−a, a], a > 0 is compact, it suﬃces to prove (by Corollary 1.5.6) that for any given ε > 0, [−a, a]
can be ﬁnitely covered by intervals of the form ]p −ε, p + ε[, since we are accepting completeness of R. Let
n be a positive integer such that a < nε. Let t ∈[−a, a] and k be the largest (positive or negative) integer
satisfying kε ≤t. Then −n ≤k ≤n and kε ≤t < (k + 1)ε. Thus any point t ∈[−a, a] belongs to an interval
of the form ]kε −ε, kε + ε[, where k = −n, . . . , 0, . . . , n and hence { ]kε −ε, kε + ε[ | k = 0, ±1, . . . , ±n } is a
ﬁnite covering of [−a, a].
■
This theorem is also proved in virtually every textbook on advanced calculus.
Uniform Continuity.
As is known from calculus, continuity of a function on an interval [a, b] implies
uniform continuity. The generalization to metric spaces is the following.
1.5.10 Proposition.
A continuous mapping ϕ : M1 →M2, where M1 and M2 are metric spaces and M1
is compact, is uniformly continuous.
Proof.
The metrics on M1 and M2 are denoted by d1 and d2. Fix ε > 0. Then for each p ∈M1, by
continuity of ϕ there exists δp > 0 such that if d1(p, q) < δp, then d2(ϕ(p), ϕ(q)) < ε/2. Let
Dδ1/2(p1), . . . , Dδn/2(pn)
cover the compact space M1 and let δ = min{δ1/2, . . . , δn/2}. Then if p, q ∈M1 are such that d1(p, q) < δ,
there exists an index i, 1 ≤i ≤n, such that d1(p, pi) < δi/2 and thus
d1(pi, q) ≤d1(pi, p) + d1(p, q) < δi
2 + δ ≤δi.
Thus,
d2(ϕ(p), ϕ(q)) ≤d2(ϕ(p), ϕ(pi)) + d2(ϕ(pi)), ϕ(q)) < ε.
■

24
1. Topology
Equicontinuity.
A useful application of Corollary 1.5.6 concerns relatively compact sets in C(M, N), for
metric spaces (M, dM) and (N, dN) with M compact and N complete. Recall from §1.3 that we put a metric
on C(M, N) and that in this metric, convergence is the same as uniform convergence.
1.5.11 Deﬁnition.
A subset F ⊂C(M, N) is called equicontinuous at m0 ∈M, if given ε > 0, there
exists δ > 0 such that whenever dM(m, m0) < δ, we have dN(ϕ(m), ϕ(m0)) < ε for every ϕ ∈F (δ is
independent of ϕ). F is called equicontinuous, if it is equicontinuous at every point in M.
1.5.12 Theorem (Arzela–Ascoli Theorem).
Let (M, dM) and (N, dN) be metric spaces, and assume that
M is compact and N is complete. A set F ⊂C(M, N) is relatively compact iﬀit is equicontinuous and all
the sets F(m) = { ϕ(m) | ϕ ∈F } are relatively compact in N.
Proof.
If F is relatively compact, it is totally bounded and hence so are all the sets F(m). Since N is
complete, by Corollary 1.5.6 the sets F(m) are relatively compact. Let {ϕ1, . . . , ϕn} be the centers of the
ε-disks covering F. Then there exists δ > 0 such that if dM(m, m′) < δ, we have dN(ϕi(m), ϕi(m′)) ≤ε/3,
for i = 1, . . . , n and hence if ϕ ∈F is arbitrary, ϕ lies in one of the ε-disks whose center, say, is ϕi, so that
dN(ϕ(m), ϕ(m′)) ≤dN(ϕ(m), ϕi(m)) + dN(ϕi(m), ϕi(m′))
+dN(ϕi(m′), ϕ(m′)) < ε.
This shows that F is equicontinuous.
Conversely, since C(M, N) is complete, by Corollary 1.5.6 we need only show that F is totally bounded.
For ε > 0, ﬁnd a neighborhood Um of m ∈M such that for all m′ ∈Um, dN(ϕ(m), ϕ(m′)) < ε/4 for all ϕ ∈F
(this is possible by equicontinuity). Let Um(1), . . . , Um(n) be a ﬁnite collection of these neighborhoods covering
the compact space M. By assumption each F(m) is relatively compact, hence F(m(1)) ∪· · · ∪F(m(n)) is
also relatively compact, and thus totally bounded. Let Dε/4(x1), . . . , De/4(xk) cover this union. If A denotes
the set of all mappings α : {1, . . . , n} →{1, . . . , k}, then A is ﬁnite and
F =

a∈A
Fα,
where Fα = { ϕ ∈F | dN(ϕ(m(i)), xα(i)) < ε/4 for all i = 1, . . . , n }. But if ϕ, ψ ∈Fα and m ∈M, then
m ∈Dε/4(xi) for some i, and thus
dN(ϕ(m), ψ(m)) ≤dN(ϕ(m), ϕ(m(i)) + dN(ϕ(m(i)), xα(i))
+dN(xα(i), ψ(m(i))) + dN(ψ(m(i)), ψ(m)) < ε;
that is, the diameter of Fα is ≤ε, so F is totally bounded.
■
Combining this with the Heine–Borel theorem, we get the following.
1.5.13 Corollary.
If M is a compact metric space, a set F ⊂C(M, Rn) is relatively compact iﬀit is
equicontinuous and uniformly bounded (i.e., ∥ϕ(m)∥≤constant for all ϕ ∈F and m ∈M).
The following example illustrates one way to use the Arzela–Ascoli theorem.
Example.
Let fn : [0, 1] →R be continuous and be such that |fn(x)| ≤100 and the derivatives f ′
n exist
and are uniformly bounded on ]0, 1[. Prove fn has a uniformly convergent subsequence.
We verify that the set {fn} is equicontinuous and bounded. The hypothesis is that |f ′
n(x)| ≤M for a
constant M. Thus by the mean-value theorem,
|fn(x) −fn(y)| ≤M|x −y|,
so given ε we can choose δ = ε/M, independent of x, y, and n. Thus {fn} is equicontinuous. It is bounded
because
∥fn∥= sup
0≤x≤1
|fn(x)| ≤100.
♦

1.5 Compactness
25
Exercises
⋄1.5-1.
Show that a topological space S is compact iﬀevery family of closed subsets of S whose intersection
is empty contains a ﬁnite subfamily whose intersection is empty.
⋄1.5-2.
Show that every compact metric space is separable.
Hint: Use total boundedness.
⋄1.5-3.
Show that the space of Exercise 1.1-9 is not locally compact.
Hint: Look at the sequence (1/n, 0).
⋄1.5-4.
(i) Show that every closed subset of a locally compact space is locally compact.
(ii) Show that S × T is locally compact if both S and T are locally compact.
⋄1.5-5.
Let M be a compact metric space and T : M →M a map satisfying d(T(m1), T(m2)) < d(m1, m2)
for m1 ̸= m2. Show that T has a unique ﬁxed point.
⋄1.5-6.
Let S be a compact topological space and ∼an equivalence relation on S, so that S/∼is compact.
Prove that the following conditions are equivalent (cf. Proposition 1.4.10):
(i) The graph C of ∼is closed in S × S;
(ii) ∼is a closed equivalence relation;
(iii) S/∼is Hausdorﬀ.
⋄1.5-7.
Let S be a Hausdorﬀspace that is locally homeomorphic to a locally compact Hausdorﬀspace (i.e.,
for each u ∈S, there is a neighborhood of u homeomorphic, in the subspace topology, to an open subset of
a locally compact Hausdorﬀspace). Show that S is locally compact. In particular, Hausdorﬀspaces locally
homeomorphic to Rn are locally compact. Is the conclusion true without the Hausdorﬀassumption?
⋄1.5-8.
Let M3 be the set of all 3 × 3 matrices with the topology obtained by regarding M3 as R9. Let
SO(3) = { A ∈M3 | A is orthogonal and det A = 1 } .
(i) Show that SO(3) is compact.
(ii) Let P = { Q ∈SO(3) | Q is symmetric } and let ϕ : RP2 →SO(3) be given by ϕ(ℓ) = the rotation by
π about the line ℓ⊂R3. Show that ϕ maps the space RP2 homeomorphically onto P\{Identity}.
⋄1.5-9.
Let fn : [a, b] →R be uniformly bounded continuous functions. Set
Fn(x) =
 x
a
fn(t) dt,
a ≤x ≤b.
Prove that Fn has a uniformly convergent subsequence.
⋄1.5-10.
Let X and Y be topological spaces, Y be ﬁrst countable, and f : X →Y be a continuous map. The
map f is called proper, if f(xn) →y implies the existence of a convergent subsequence {xn(i)}, xn(i) →x
such that f(x) = y .
(i) Show that f is a closed map.
(ii) Show that if Y is locally compact, f is proper if and only if the inverse image by f of every compact
set in Y is a compact set in X.
(iii) Show that if f is proper and Y is locally compact, then X is also locally compact. (We have deﬁned
properness only when Y is ﬁrst countable. The same deﬁnition and properties of proper maps hold for
general Y if in the deﬁnition “sequence” is replaced by “net.”)
(iv) Show that the composition of two proper maps is again proper.
(v) Show that any continuous map deﬁned on a compact space is proper.

26
1. Topology
1.6
Connectedness
Three types of connectedness treated in this section are arcwise connectedness, connectedness, and simple
connectedness.
Arcwise Connectedness.
We begin with the most intuitive notion of connectedness.
1.6.1 Deﬁnition.
Let S be a topological space and I = [0, 1] ⊂R. An arc ϕ in S is a continuous mapping
ϕ : I →S. If ϕ(0) = u, ϕ(1) = v, we say ϕ joins u and v; S is called arcwise connected if every two
points in S can be joined by an arc in S. A space S is called locally arcwise connected if for each point
x ∈S and each neighborhood U of x, there is a neighborhood V of x such that any pair of points in V can
be joined by an arc in U.
For example, Rn is arcwise and locally arcwise connected: any two points of Rn can be joined by the
straight line segment connecting them. A set A ⊂Rn is called convex if this property holds for any two of
its points. Thus, convex sets in Rn are arcwise and locally arcwise connected. A set with the trivial topology
is arcwise and locally arcwise connected, but in the discrete topology it is neither (unless it has only one
point).
Connected Spaces.
Less intuitive is the basic notion of connectedness.
1.6.2 Deﬁnition.
A topological space S is connected if ∅and S are the only subsets of S that are both
open and closed. A subset of S is connected if it is connected in the relative topology. A component A of
S is a nonempty connected subset of S such that the only connected subset of S containing A is A itself; S is
called locally connected if each point has a connected neighborhood. The components of a subset T ⊂S
are the components of T in the relative topology of T in S.
For example, Rn and any convex subset of Rn are connected and locally connected. The union of two
disjoint open convex sets is disconnected but is locally connected; its components are the two convex sets. The
trivial topology is connected and locally connected, whereas the discrete topology is neither: its components
are all the one-point sets.
Connected spaces are characterized by the following.
1.6.3 Proposition.
The following are equivalent:
(i) S is not connected;
(ii) there is a nonempty proper subset of S that is both open and closed;
(iii) S is the disjoint union of two nonempty open sets; and
(iv) S is the disjoint union of two nonempty closed sets.
The sets in (iii) or (iv) are said to disconnect S.
Proof.
To prove that (i) implies (ii), assume there is a nonempty proper set A that is both open and
closed. Then S = A∪(S\A) with A, S\A open and nonempty. Conversely, if S = A∪B with A, B open and
nonempty, then A is also closed, and thus A is a proper nonempty set of S that is both open and closed.
The equivalences of the remaining assertions are similarly checked.
■
Behavior under Mappings.
Connectedness is preserved by continuous maps, as is shown next.
1.6.4 Proposition.
If f : S →T is a continuous map of topological spaces and S is connected (resp.,
arcwise connected) then so is f(S).

1.6 Connectedness
27
Proof.
Let S be arcwise connected and consider f(s1), f(s2) ∈f(S) ⊂T. If c : I →S, c(0) = s1, c(1) = s2
is an arc connecting s1 to s2, then clearly f ◦c : I →T is an arc connecting f(s1) to f(s2); that is, f(S) is
arcwise connected. Let S be connected and assume f(S) ⊂U ∪V , where U and V are open and U ∩V = ∅.
Then f −1(U) and f −1(V ) are open by continuity of f,
f −1(U) ∪f −1(V ) = f −1(U ∪V ) ⊃f −1(f(S)) = S,
and f −1(U) ∩f −1(V ) = f −1(∅) = ∅, thus contradicting connectedness of S by Proposition 1.6.3. Hence
f(S) is connected.
■
Arcwise Connected Spaces are Connected.
We shall use the following.
1.6.5 Lemma.
The only connected sets of R are the intervals (ﬁnite, inﬁnite, open, closed, or half-open).
Proof.
Let us prove that [a, b[ is connected; all other possibilities have identical proofs. If not, [a, b[ = U ∪V
with U, V nonempty disjoint closed sets in [a, b[. Assume that a ∈U. If x = sup(U), then x ∈U since U is
closed in [a, b[, and x < b since V ̸= ∅. But then ]x, b[ ⊂V and, since V is closed, x ∈V . Hence x ∈U ∩V ,
a contradiction.
Conversely, let A be a connected set of R. We claim that [x, y] ⊂A whenever x, y ∈A, which implies that
A is an interval. If not, there exists z ∈[x, y] with z ̸∈A . But in this case ]−∞, z[ ∪A and ]z, ∞[ ∪A are
open nonempty sets disconnecting A.
■
1.6.6 Proposition.
If S is arcwise connected then it is connected.
Proof.
If not, there are nonempty, disjoint open sets U0 and U1 whose union is S. Let x0 ∈U0 and x1 ∈U1
and let ϕ be an arc joining x0 to x1. Then V0 = ϕ−1(U0) and V1 = ϕ−1(U1) disconnect [0, 1].
■
A standard example of a space that is connected but is not arcwise connected nor locally connected, is

(x, y) ∈R2 | x > 0 and y = sin(1/x)

∪{ (0, y) | −1 < y < 1 } .
1.6.7 Proposition.
If a space is connected and locally arcwise connected, it is arcwise connected. In
particular, a space locally homeomorphic to Rn is connected iﬀit is arcwise connected.
Proof.
Fix x ∈S. The set
A = { y ∈S | y can be connected to x by an arc }
is nonempty and open since S is locally arcwise connected. For the same reason, S\A is open. Since S is
connected we must have S\A = ∅; thus, A = S, that is, S is arcwise connected.
■
Intermediate Value Theorem.
Connectedness provides a general context for this theorem learned in
calculus.
1.6.8 Theorem (Intermediate Value Theorem).
Let S be a connected space and f : S →R be continuous.
Then f assumes every value between any two values f(u) and f(v).
Proof.
Suppose f(u) < a < f(v) and f does not assume the value a. Then the set U = { u0 | f(u0) < a }
is both open and closed.
■
An alternative proof uses the fact that f(S) is connected in R and therefore is an interval.

28
1. Topology
Miscellaneous Properties of Connectedness.
1.6.9 Proposition.
Let S be a topological space and B ⊂S be connected.
(i) If B ⊂A ⊂cl(B), then A is connected.
(ii) If Bα is a family of connected subsets of S and Bα ∩B ̸= ∅, then
B ∪

α
Bα

is connected.
Proof.
If A is not connected, A is the disjoint union of U1 ∩A and U2 ∩A where U1 and U2 are open in
S. Then from Proposition 1.1.9(i), U1 ∩B ̸= ∅and U2 ∩B ̸= ∅, so B is not connected. We leave (ii) as an
exercise.
■
1.6.10 Corollary.
The components of a topological space are closed. Also, S is the disjoint union of its
components. If S is locally connected, the components are open as well as closed.
1.6.11 Proposition.
Let S be a ﬁrst countable compact Hausdorﬀspace and {An} a sequence of closed,
connected subsets of S with An ⊂An−1. Then A = 
n≥1 An is connected.
Proof.
As S is normal, if A is not connected, A lies in two disjoint open subsets U1 and U2 of S. If
An ∩(S\U1)∩(S\U2) ̸= ∅for all n, then there is a sequence un ∈An ∩(S\U1)∩(S\U2) with a subsequence
converging to u. As An, S\U1, and S\U2 are closed sets, u ∈A ∩(S\U1) ∩(S\U2), a contradiction. Hence
some An is not connected.
■
Simple Connectivity.
This notion means, intuitively, that loops can be continuously shrunk to points.
1.6.12 Deﬁnition.
Let S be a topological space and c : [0, 1] →S a continuous map such that c(0) =
c(1) = p ∈S. We call c a loop in S based at p. The loop c is called contractible if there is a continuous
map H : [0, 1] × [0, 1] →S such that H(t, 0) = c(t) and H(0, s) = H(1, s) = H(t, 1) = p for all t ∈[0, 1].
(See Figure 1.6.1.)
Figure 1.6.1. The loop c is contractible
We think of cs(t) = H(t, s) as a family of arcs connecting c0 = c to c1, a constant arc; see Figure 1.6.1.
Roughly speaking, a loop is contractible when it can be shrunk continuously to p by loops beginning and
ending at p. The study of loops leads naturally to homotopy theory. In fact, the loops at p can, by successively
traversing them, be made into a group called the fundamental group; see Exercise 1.6-6.

1.6 Connectedness
29
1.6.13 Deﬁnition.
A space S is simply connected if S is connected and every loop in S is contractible.
In the plane R2 there is an alternative approach to simple connectedness, by way of the Jordan curve the-
orem; namely, that every simple (nonintersecting) loop in R2 divides R2 (divides means that its complement
has two components). The bounded component of the complement is called the interior, and a subset A of
R2 is simply connected iﬀthe interior of every loop in A lies in A.
Alexandroﬀ’s Theorem.
We close this section with an optional theorem sometimes used in Riemannian
geometry (to show that a Riemannian manifold is second countable) that illustrates the interplay between
various notions introduced in this chapter.
1.6.14 Theorem (Alexandroﬀ’s Theorem).
An arcwise connected locally compact metric space is separa-
ble and hence is second countable.
Proof (Pﬂuger [1957]).
Since the metric space M is locally compact, each m ∈M has compact neighbor-
hoods that are disks. Denote by r(m) the least upper bound of the radii of such disks. If r(m) = ∞, since
every metric space is ﬁrst countable, M can be written as a countable union of compact disks. But since
each compact metric space is separable (Exercise 1.5-2), these disks and also their union will be separable,
and so the proposition is proved in this case. If r(m0) < ∞, since r(m) ≤r(m0) + d(m, m0), we see that
r(m) < ∞for all m ∈M. By the preceding argument, if we show that M is a countable union of compact
sets, the proposition is proved. Then second countability will follow from Exercise 1.2-3.
To show that M is a countable union of compact sets, deﬁne the set Gm by
Gm = { m′ ∈M | d(m′, m) ≤r(m)/2 }.
These Gm are compact neighborhoods of m. Fix m(0) ∈M and put A0 = Gm(0), and, inductively, deﬁne
An+1 =

{ Gm | m ∈An }.
Since M is arcwise connected, every point m ∈M can be connected by an arc to m(0), which in turn is
covered by ﬁnitely many Gm. This shows that
M =

n≥0
An.
Since A0 is compact, all that remains to be shown is that the other An are compact. Assume inductively
that An is compact and let {m(i)} be an inﬁnite sequence of points in An+1. There exists m(i)′ ∈An such
that m(i) ∈Gm(i)′. Since An is assumed to be compact there is a subsequence m(ik)′ that converges to a
point m′ ∈An. But
d(m(i), m′) ≤d(m(i), m(i)′) + d(m(i)′, m′)
≤r(m(i)′)
2
+ d(m(i)′, m′)
≤r(m′)
2
+ 3d(m(i)′, m′)
2
.
Hence for ik big enough, all m(ik) are in the compact set
{ n ∈M | d(n, m′) ≤3r(m′)/2 },
so m(ik) has a subsequence converging to a point m. The preceding inequality shows that m ∈An+1. By
the Bolzano–Weierstrass theorem, An+1 is compact.
■

30
1. Topology
Exercises
⋄1.6-1.
Let M be a topological space and H : M →R continuous. Suppose e ∈Int H(M). Then show
H−1(e) divides M; that is, M\H−1(e) has at least two components.
⋄1.6-2.
Let O(3) be the set of orthogonal 3 × 3 matrices. Show that O(3) is not connected and that it has
two components.
⋄1.6-3.
Show that S × T is connected (locally connected, arcwise connected, locally arcwise connected) iﬀ
both S and T are.
Hint: For connectedness write
S × T =

t∈T
[(S × {t}) ∪({s0} × T)]
for s0 ∈S ﬁxed and use Proposition 1.6.9(ii).
⋄1.6-4.
Show that S is locally connected iﬀevery component of an open set is open.
⋄1.6-5.
Show that the quotient space of a connected (locally connected, arcwise connected) space is also
connected (locally connected, arcwise connected).
Hint: For local connectedness use Exercise 1.6-4 and show that the inverse image by π of a component of
an open set is a union of components.
⋄1.6-6.
(i) Let S and T be topological spaces. Two continuous maps f, g : T →S are called homotopic
if there exists a continuous map F : [0, 1] × T →S such that F(0, t) = f(t) and F(1, t) = g(t) for all
t ∈T. Show that homotopy is an equivalence relation.
(ii) Show that S is simply connected if and only if any two continuous paths c1, c2 : [0, 1] →S satisfying
c1(0) = c2(0), c1(1) = c2(1) are homotopic, via a homotopy which preserves the end points, that is,
F(s, 0) = c1(0) = c2(0) and F(s, 1) = c1(1) = c2(1).
(iii) Deﬁne the composition c1 ∗c2 of two paths c1, c2 : [0, 1] →S satisfying c1(1) = c2(0) by
(c1 ∗c2)(t) =



c1(2t)
if t ∈[1, 1/2];
c2(2t −1)
if t ∈[1/2, 1].
Show that this composition, when deﬁned, induces an associative operation on endpoints preserving
homotopy classes of paths.
(iv) Fix s0 ∈S and consider the set π1(S, s0) of endpoint ﬁxing homotopy classes of paths starting and
ending at s0. Show that π1(S, s0) is a group: the identity element is given by the class of the constant
path equal to s0 and the inverse of c is given by the class of c(1 −t) .
(v) Show that if S is arcwise connected, then π1(S, s0) is isomorphic to π1(S, s) for any s ∈S. π1(S) will
denote any of these isomorphic groups.
(vi) Show that if S is arcwise connected, then S is simply connected iﬀπ1(S) = 0.
1.7
Baire Spaces
The Baire condition on a topological space is fundamental to the idea of “genericity” in diﬀerential topology
and dynamical systems; see Kelley [1975] and Choquet [1969] for additional information.

1.7 Baire Spaces
31
1.7.1 Deﬁnition.
Let X be a topological space and A ⊂X a subset. Then A is called residual if A is the
intersection of a countable family of open dense subsets of X. A space X is called a Baire space if every
residual set is dense. A set B ⊂X is called a ﬁrst category set if
B ⊂

n≥1
Cn,
where Cn is closed with int(Cn) = ∅. A second category set is a set which is not of the ﬁrst category.
A set B ⊂X is called nowhere dense if int(cl(B)) = ∅, so that X\A is residual iﬀA is the union of a
countable collection of nowhere dense closed sets, that is, iﬀX\A is of ﬁrst category. Clearly, a countable
intersection of residual sets is residual.
In a Baire space X, if
X =

n≥1
Cn,
where Cn are closed sets, then int(Cn) ̸= ∅for some n. For if all int(Cn) = ∅, then On = X\Cn are open,
dense, and we have

n≥1
On = X\

n≥1
Cn = ∅
contradicting the deﬁnition of Baire space. In other words, Baire spaces are of second category.
1.7.2 Proposition.
Let X be a locally Baire space; that is, each point x ∈X has a neighborhood U
such that cl(U) is a Baire space. Then X is a Baire space.
Proof.
Let A ⊂X be residual, A = 
n≥1 On, where cl(On) = X . Then if U is an open set for which
cl(U) is a Baire space, from the equality A ∩cl(U) = 
n≥1(On ∩cl(U)) and the density of On ∩cl(U) in
cl(U) (if u ∈cl(U) and u ∈O, O open in X, then O ∩U ̸= ∅, and therefore O ∩U ∩On ̸= ∅), it follows
that A ∩cl(U) is residual in cl(U) hence dense in cl(U), that is, cl(A) ∩cl(U) = cl(U) so that cl(U) ⊂cl(A).
Therefore X = cl(A).
■
1.7.3 Theorem (Baire Category Theorem).
Complete pseudometric and locally compact spaces are Baire
spaces.
Proof.
Let X be a complete pseudometric space. Let U ⊂X be open and
A =

n≥1
On
be residual. We must show U ∩A ̸= ∅. Since cl(On) = X,
U ∩On ̸= ∅
and so we can choose a disk of diameter less than one, say V1, such that cl(V1) ⊂U ∩O1. Proceed inductively
to obtain
cl(Vn) ⊂U ∩On ∩Vn−1,
where Vn has diameter < 1/n. Let xn ∈cl(Vn). Clearly {xn} is a Cauchy sequence, and by completeness
has a convergent subsequence with limit point x. Then
x ∈

n≥1
cl(Vn)
and so
U ∩


n≥1
On

̸= ∅;

32
1. Topology
that is, A is dense in X. If X is a locally compact space the same proof works with the following modiﬁcations:
Vn are chosen to be relatively compact open sets, and {xn} has a convergent subsequence since it lies in the
compact set cl(V1).
■
To get a feeling for this theorem, let us prove that the set of rationals Q cannot be written as a countable
intersection of open sets. For suppose Q = 
n≥1 On. Then each On is dense in R, since Q is, and so
Cn = R\On is closed and nowhere dense. Since
R ∪


n≥1
Cn


is a complete metric space (as well as a locally compact space), it is of second category, so Q or some Cn
should have nonempty interior. But this is impossible.
The notion of category can lead to interesting restrictions on a set. For example in a nondiscrete Hausdorﬀ
space, any countable set is ﬁrst category since the one-point set is closed and nowhere dense. Hence in such
a space every second category set is uncountable. In particular, nonﬁnite complete pseudometric and locally
compact spaces are uncountable.
Exercises
⋄1.7-1.
Let X be a Baire space. Show that
(i) X is a second category set;
(ii) if U ⊂X is open, then U is Baire.
⋄1.7-2.
Let X be a topological space. A set is called an Fσ if it is a countable union of closed sets, and is
called a Gδ if it is a countable intersection of open sets. Prove that the following are equivalent:
(i) X is a Baire space;
(ii) any ﬁrst category set in X has a dense complement;
(iii) the complement of every ﬁrst category Fσ-set is a dense Gδ-set;
(iv) for any countable family of closed sets {Cn} satisfying
X =

n≥1
Cn,
the open set

n≥1
int(Cn)
is dense in X.
Hint: First show that (ii) is equivalent to (iv). For (ii) implies (iv), let Un = Cn\ int(Cn) so that

n≥1 Un is a ﬁrst category set and therefore X\ 
n≥1 Un is dense and included in 
n≥1 int(Cn). For
the converse, assume X is not Baire so that A = 
n≥1 Un is not dense, even though all Un are open
and dense. Then
X = cl(A) ∪{ X\Un | n = 1, 2, . . . }.
Put
F0 = cl(A),
Fn = X\Un,
and show that int(Fn) = int(cl(A)) which is not dense.

1.7 Baire Spaces
33
⋄1.7-3.
Show that there is a residual set E in the metric space C([0, 1], R) such that each f ∈E is not
diﬀerentiable at any point. do this by following the steps below.
(i) Let Eε denote the set of all f ∈C([0, 1], R) such that for every x ∈[0, 1],
diam
 f(x + h) −f(x)
h

ε
2 < |h| < ε

> 1
for ε > 0. Show that Eε is open and dense in C([0, 1], R).
Hint: For any polynomial p ∈C([0, 1], R), show that p + δ cos(kx) ∈Eε for δ small and δk large.
(ii) Show that E = 
n≥1 E1/n is dense in C([0, 1], R).
Hint: Use the Baire category theorem.
(iii) Show that if f ∈E, then f has no derivative at any point.
⋄1.7-4.
Prove the following: In a complete metric space (M, d) with no isolated points, no countable dense
set is a Gδ-set.
Hint: Suppose E = {x1, x2, . . . } is dense in M and is also a Gδ set, that is, E = 
n>0 Vn with Vn open,
n = 1, 2, . . . . Conclude that Vn is dense in M. Let Wn = Vn\{x1, . . . , xn}. Show that Wn is dense in M and
that 
n>0 Wn = ∅. This contradicts the Baire property.

Page 35
2
Banach Spaces and Diﬀerential Calculus
Manifolds have enough structure to allow diﬀerentiation of maps between them. To set the stage for these
concepts requires a development of diﬀerential calculus in linear spaces from a geometric point of view. The
goal of this chapter is to provide this perspective.
Perhaps the most important theorem for later use is the Implicit Function Theorem. A fairly detailed
exposition of this topic will be given with examples appropriate for use in manifold theory. The basic
language of tangents, the derivative as a linear map, and the chain rule, while elementary, are important for
developing geometric and analytic skills needed in manifold theory.
The main goal is to develop the theory of ﬁnite-dimensional manifolds. However, it is instructive and eﬃ-
cient to do the inﬁnite-dimensional theory simultaneously. To avoid being sidetracked by inﬁnite-dimensional
technicalities at this stage, some functional analysis background and other topics special to the inﬁnite-
dimensional case are presented in supplements. With this arrangement readers who wish to concentrate on
the ﬁnite-dimensional theory can do so with a minimum of distraction.
2.1
Banach Spaces
It is assumed the reader is familiar with the concept of a real or complex vector space. Banach spaces are
vector spaces with the additional structure of a norm that deﬁnes a complete metric space. While most of
this book is concerned with ﬁnite-dimensional spaces, much of the theory is really no harder in the general
case, and the inﬁnite-dimensional case is needed for certain applications. Thus, it makes sense to work in the
setting of Banach spaces. In addition, although the primary concern is with real Banach spaces, the basic
concepts needed for complex Banach spaces are introduced with little extra eﬀort.
Normed Spaces.
We begin with the notion of a normed space; that is, a space in which one has a length
measure for vectors.
2.1.1 Deﬁnition.
A norm on a real (complex) vector space E is a mapping from E into the real numbers,
∥· ∥: E →R; e →∥e∥, such that
N1.
∥e∥≥0 for all e ∈E and ∥e∥= 0 implies e = 0 (positive deﬁniteness);
N2.
∥λe∥= |λ| ∥e∥for all e ∈E and λ ∈R (homogeneity);

36
2. Banach Spaces and Diﬀerential Calculus
N3.
∥e1 + e2∥≤∥e1∥+ ∥e2∥for all e1, e2 ∈E (triangle inequality).
The pair (E, ∥· ∥) is sometimes called a normed space. If there is no danger of confusion, we sometimes
just say “E is a normed space.” To distinguish diﬀerent norms, diﬀerent notations are sometimes used, for
example,
∥· ∥E, ∥· ∥1, ||| · |||, etc.,
for the norm.
Example.
Euclidean space Rn with the standard norm
∥x∥= (x2
1 + · · · + x2
n)
1/2,
where x = (x1, . . . , xn), is a normed space. Proving that this norm satisﬁes the triangle inequality is probably
easiest to do using properties of the inner product, which are considered below. Another norm on the same
space is given by
|||x||| =
n

i=1
|xi|,
as may be veriﬁed directly.
The triangle inequality N3 has the following important consequence:
| ∥e1∥−∥e2∥| ≤∥e1 −e2∥
for all e1, e2 ∈E,
which is proved in the following way:
∥e2∥= ∥e1 + (e2 −e1)∥≤∥e1∥+ ∥e1 −e2∥,
∥e1∥= ∥e2 + (e1 −e2)∥≤∥e2∥+ ∥e1 −e2∥,
so that both ∥e2∥−∥e1∥and ∥e1∥−∥e2∥are smaller than or equal to ∥e1 −e2∥.
Seminormed Spaces.
If N1 in Deﬁnition 2.1.1 is replaced by
N1′.
∥e∥≥0 for all e ∈E,
the mapping ∥· ∥: E →R is called a seminorm. For example, the function deﬁned on R2 by ∥(x, y)∥= |x|
is a seminorm.
Inner Product Spaces.
These are spaces in which, roughly speaking, one can measure angles between
vectors as well as their lengths.
2.1.2 Deﬁnition.
An inner product on a real vector space E is a mapping ⟨·, ·⟩: E × E →R, which we
denote (e1, e2) →⟨e1, e2⟩such that
I1.
⟨e, e1 + e2⟩= ⟨e, e1⟩+ ⟨e, e2⟩;
I2.
⟨e, αe1⟩= α ⟨e, e1⟩;
I3.
⟨e1, e2⟩= ⟨e2, e1⟩;
I4.
⟨e, e⟩≥0 and ⟨e, e⟩= 0 iﬀe = 0.
The standard inner product on Rn is
⟨x, y⟩=
n

i=1
xiyi,
and I1–I4 are readily checked.
For vector spaces over the complex numbers, the deﬁnition is modiﬁed slightly as follows.

2.1 Banach Spaces
37
2.1.2′ Deﬁnition.
A complex inner product or a Hermitian inner product on a complex vector
space E is a mapping
⟨·, ·⟩: E × E →C
such that the following conditions hold:
CI1.
⟨e, e1 + e2⟩= ⟨e, e1⟩+ ⟨e, e2⟩;
CI2.
⟨αe, e1⟩= α ⟨e, e1⟩;
CI3.
⟨e1, e2⟩= ⟨e2, e1⟩(so ⟨e, e⟩is real);
CI4.
⟨e, e⟩≥0 and ⟨e, e⟩= 0 iﬀe = 0.
These properties are to hold for all e, e1, e2 ∈E and α ∈C; z denotes the complex conjugate of the
complex number z. Note that CI2 and CI3 imply that ⟨e1, αe2⟩= α ⟨e1, e2⟩. Properties CI1–CI3 are also
known in the literature under the name sesquilinearity. As is customary, for a complex number z we shall
denote by
Re z = z + z
2
,
Im z = z −z
2i
,
|z| = (zz)1/2
its real and imaginary parts and its absolute value. The standard inner product on the product space
Cn = C × · · · × C is deﬁned by
⟨z, w⟩=
n

i=1
ziwi,
and CI1–CI4 are readily checked. Also Cn is a normed space with
∥z∥2 =
n

i=1
|zi|2.
In Rn or Cn, property N3 is a little harder to check directly. However, as we shall show in Proposition 2.1.4,
N3 follows from I1–I4 or CI1–CI4.
In a (real or complex) inner product space E, two vectors e1, e2 ∈E are called orthogonal and we write
e1 ⊥e2 provided ⟨e1, e2⟩= 0. For a subset A ⊂E, the set A⊥deﬁned by
A⊥= { e ∈E | ⟨e, x⟩= 0 for all x ∈A }
is called the orthogonal complement of A. Two sets A, B ⊂E are called orthogonal and we write A ⊥B
if ⟨A, B⟩= 0; that is, e1 ⊥e2 for all e1 ∈A and e2 ∈B.
Cauchy–Schwartz Inequality.
This inequality will be a critical way to estimate inner products in terms
of lengths.
2.1.3 Theorem (Cauchy–Schwartz Inequality).
In a (real or complex) inner product space,
|⟨e1, e2⟩| ≤⟨e1, e1⟩1/2⟨e2, e2⟩1/2.
Equality holds iﬀe1, e2 are linearly dependent.
Proof.
It suﬃces to prove the complex case. If α, β ∈C, then
0 ≤⟨αe1 + βe2, αe1 + βe2⟩= |α|2 ⟨e1, e1⟩+ 2 Re(αβ ⟨e1, e2⟩) + |β|2 ⟨e2, e2⟩.

38
2. Banach Spaces and Diﬀerential Calculus
If we set α = ⟨e2, e2⟩, and β = −⟨e1, e2⟩, then this becomes
0 ≤⟨e2, e2⟩2 ⟨e1, e1⟩−2 ⟨e2, e2⟩|⟨e1, e2⟩|2 + |⟨e1, e2⟩|2 ⟨e2, e2⟩,
and so
⟨e2, e2⟩|⟨e1, e2⟩|2 ≤⟨e2, e2⟩2 ⟨e1, e1⟩.
If e2 = 0, equality results in the statement of the proposition and there is nothing to prove. If e2 ̸= 0, the term
⟨e2, e2⟩in the preceding inequality can be cancelled since ⟨e2, e2⟩̸= 0 by CI4. Taking square roots yields the
statement of the proposition. Finally, equality results if and only if αe1+βe2 = ⟨e2, e2⟩e1−⟨e1, e2⟩e2 = 0.
■
2.1.4 Proposition.
Let (E, ⟨·, ·⟩) be a (real or complex) inner product space and set ∥e∥= ⟨e, e⟩1/2. Then
(E, ∥· ∥) is a normed space.
Proof.
N1 and N2 are straightforward veriﬁcations. As for N3, the Cauchy–Schwartz inequality and the
obvious inequality
Re(⟨e1, e2⟩) ≤|⟨e1, e2⟩|
imply
∥e1 + e2∥2 = ∥e1∥2 + 2 Re(⟨e1, e2⟩) + ∥e2∥2 ≤∥e1∥2 + 2|⟨e1, e2⟩| + ∥e2∥2
≤∥e1∥2 + 2∥e1∥∥e2∥+ ∥e2∥2 = (∥e1∥+ ∥e2∥)2
■
Polarization and the Parallelogram Law.
Some other useful facts about inner products are given
next.
2.1.5 Proposition.
Let (E, ⟨·, ·⟩) be an inner product space and ∥· ∥the corresponding norm. Then
(i) (Polarization)
4 ⟨e1, e2⟩= ∥e1 + e2∥2 −∥e1 −e2∥2.
for E real, while
4 ⟨e1, e2⟩= ∥e1 + e2∥2 −∥e1 −e2∥2 + i∥e1 + ie2∥2 −i∥e1 −ie2∥2,
if E is complex.
(ii) (Parallelogram law)
2∥e1∥2 + 2∥e2∥2 = ∥e1 + e2∥2 + ∥e1 −e2∥2.
Proof.
(i) In the complex case, we manipulate the right-hand side as follows
∥e1 + e2∥2 −∥e1 −e2∥2 + i∥e1 + ie2∥2 −i∥e1 −ie2∥2
= ∥e1∥2 + 2 Re(⟨e1, e2⟩) + ∥e2∥2
−∥e1∥2 + 2 Re(⟨e1, e2⟩) −∥e2∥2
+ i∥e1∥2 + 2i Re(⟨e1, ie2⟩) + i∥e2∥2
−i∥e1∥2 + 2i Re(⟨e1, ie2⟩) −i∥e2∥2
= 4 Re(⟨e1, e2⟩) + 4i Re(−i ⟨e1, e2⟩)
= 4 Re(⟨e1, e2⟩) + 4i Im(⟨e1, e2⟩)
= 4 ⟨e1, e2⟩.
The real case is proved in a similar way.

2.1 Banach Spaces
39
(ii) We manipulate the right hand side:
∥e1 + e2∥2 + ∥e1 −e2∥2 = ∥e1∥2 + 2 Re(⟨e1, e2⟩) + ∥e2∥2 + ∥e1∥2
−2 Re(⟨e1, e2⟩) + ∥e2∥2
= 2∥e1∥2 + 2∥e2∥2
■
Not all norms come from an inner product. For example, the norm
|||x||| =
n

i=1
|xi|
is not induced by any inner product since this norm fails to satisfy the parallelogram law (see Exercise 2.1-1
for a discussion).
Normed Spaces are Metric Spaces.
We have seen that inner product spaces are normed spaces. Now
we show that normed spaces are metric spaces.
2.1.6 Proposition.
Let (E, ∥·∥) be a normed (resp. a seminormed) space and deﬁne d(e1, e2) = ∥e1−e2∥.
Then (E, d) is a metric (resp. pseudometric) space.
Proof.
The only non-obvious veriﬁcation is the triangle inequality for the metric. By N3, we have
d(e1, e3) = ∥e1 −e3∥= ∥(e1 −e2) + (e2 −e3)∥≤∥e1 −e2∥+ ∥e2 −e3∥
= d(e1, e2) + d(e2, e3).
■
Thus we have the following hierarchy of generality:
More General →
inner
product
spaces
⊂
normed
spaces
⊂
metric
spaces
⊂
topological
spaces
←More Special
Since inner product and normed spaces are metric spaces, we can use the concepts from Chapter 1. In a
normed space, N1 and N2 imply that the maps (e1, e2) →e1+e2, (α, e) →αe of E×E →E, and C×E →E,
respectively, are continuous. Hence for e0 ∈E, and α0 ∈C (α0 ̸= 0) ﬁxed, the mappings e →e0 +e, e →α0e
are homeomorphisms. Thus, U is a neighborhood of the origin iﬀe+U = { e+x | x ∈U } is a neighborhood
of e ∈E. In other words, all the neighborhoods of e ∈E are sets that contain translates of disks centered at
the origin. This constitutes a complete description of the topology of a normed vector space (E, ∥· ∥) .
Finally, note that the inequality |∥e1∥−∥e2∥| ≤∥e1 −e2∥implies that the norm is uniformly continuous
on E. In inner product spaces, the Cauchy–Schwartz inequality implies the continuity of the inner product
as a function of two variables.
Banach and Hilbert Spaces.
Now we are ready to add the crucial assumption of completeness.
2.1.7 Deﬁnition.
Let (E, ∥· ∥) be a normed space. If the corresponding metric d is complete, we say
(E, ∥·∥) is a Banach space. If (E, ⟨·, ·⟩) is an inner product space whose corresponding metric is complete,
we say (E, ⟨·, ·⟩) is a Hilbert space.

40
2. Banach Spaces and Diﬀerential Calculus
For example, it is proven in books on advanced calculus that Rn is complete. Thus, Rn with the standard
norm is a Banach space and with the standard inner product is a Hilbert space. Not only is the standard
norm on Rn complete, but so is the nonstandard one
|||x||| =
n

i=1
|xi|.
However, it is equivalent to the standard one in the following sense.
2.1.8 Deﬁnition.
Two norms on a vector space E are equivalent if they induce the same topology on E.
2.1.9 Proposition.
Two norms ∥· ∥and ||| · ||| on E are equivalent iﬀthere is a constant M such that,
for all e ∈E,
1
M |||e||| ≤∥e∥≤M|||e|||.
Proof.
Let
B1
r(x) = { y ∈E | ∥y −x∥≤r } ,
B2
r(x) = { y ∈E | |||y −x||| ≤r }
denote the two closed disks of radius r centered at x ∈E in the two metrics deﬁned by the norms ∥· ∥and
||| · |||, respectively. Since neighborhoods of an arbitrary point are translates of neighborhoods of the origin,
the two topologies are the same iﬀfor every R > 0, there are constants M1, M2 > 0 such that
B2
M1(0) ⊂B1
R(0) ⊂B2
M2(0).
The ﬁrst inclusion says that if |||x||| ≤M1, then ∥x∥≤R, that is, if |||x||| ≤1, then ∥x∥≤R/M1. Thus, if
e ̸= 0, then

e
|||e|||
 = ∥e∥
|||e||| ≤R
M1
,
that is, ∥e∥≤(R/M1)|||e||| for all e ∈E. Similarly, the second inclusion is equivalent to the assertion that
(M2/R)|||e||| ≤∥e∥for all e ∈E. Thus the two topologies are the same if there exist constants N1 > 0,
N2 > 0 such that
N1|||e||| ≤∥e∥≤N2|||e|||
for all e ∈E. Taking M = max(N2, 1/N1) gives the statement of the proposition.
■
Products of Normed Spaces.
If E and F are normed vector spaces, the map
∥· ∥: E × F →R
deﬁned by
∥(e, e′)∥= ∥e∥+ ∥e′∥
is a norm on E × F inducing the product topology. Equivalent norms on E × F are
(e, e′) →max(∥e∥, ∥e′∥)
and
(e, e′) →(∥e∥2 + ∥e′∥2)
1/2.
The normed vector space E × F is usually denoted by E ⊕F and called the direct sum of E and F. Note
that E ⊕F is a Banach space iﬀboth E and F are. These statements are readily checked.

2.1 Banach Spaces
41
Finite Dimensional Spaces.
In the ﬁnite dimensional case equivalence and completeness are automatic.
2.1.10 Proposition.
Let E be a ﬁnite-dimensional real or complex vector space. Then
(i) there is a norm on E;
(ii) all norms on E are equivalent;
(iii) all norms on E are complete.
Proof.
Let e1, . . . , en denote a basis of E, where n is the dimension of E.
(i) A norm on E is given, for example, by
∥e∥=
n

i=1
|ai|,
where e =
n

i=1
aiei.
(ii) Let ∥· ∥′ be any other norm on E. If
e =
n

i=1
aiei
and
f =
n

i=1
biei,
the inequality
| ∥e∥′ −∥f∥′| ≤∥e −f∥′ ≤
n

i=1
|ai −bi| ∥ei∥′
≤max
1≤i≤n

∥ei∥′
|||(a1, . . . , an) −(b1, . . . , bn)|||
shows that the map
(x1, . . . , xn) ∈Cn →

n

i=1
xiei

′
∈[0, ∞[
is continuous with respect to the ||| · |||-norm on Cn (Use Rn in the real case). Since the set S = { x ∈Cn |
|||x||| = 1 } is closed and bounded, it is compact. The restriction of this map to S is a continuous, strictly
positive function, so it attains its minimum M1 and maximum M2 on S; that is,
0 < M1 ≤

n

i=1
xiei

′
≤M2
for all (x1, . . . , xn) ∈Cn such that |||(x1, . . . , xn)||| = 1. Thus,
M1|||(x1, . . . , xn)||| ≤

n

i=1
xiei

′
≤M2|||(x1, . . . , xn)|||,
that is, M1∥e∥≤∥e∥′ ≤M2∥e∥, where
e =
n

i=1
xiei.
Taking M = max(M2, 1/M1), Proposition 2.1.9 shows that ∥· ∥and ∥· ∥′ are equivalent.
(iii) It is enough to observe that
(x1, . . . , xn) ∈Cn →
n

i=1
xiei ∈E
is a norm-preserving map (i.e., an isometry) between (Cn, ||| · |||) and (E, ∥· ∥).
■

42
2. Banach Spaces and Diﬀerential Calculus
x
x
x
y
y
y
max(x,y)
|x| + |y|
x2+y2
Figure 2.1.1. The unit spheres for various norms
The unit spheres for the three common norms on R2 are shown in Figure 2.1.1.
The foregoing proof shows that compactness of the unit sphere in a ﬁnite-dimensional space is crucial.
This fact is exploited in the following supplement.
Supplement 2.1A
A Characterization of Finite-Dimensional Spaces
2.1.11 Proposition.
A normed vector space is ﬁnite dimensional iﬀit is locally compact iﬀthe closed
unit disk is compact.
Proof.
If E is ﬁnite dimensional, the proof of Proposition 2.1.10(iii) shows that E is locally compact.
Conversely, assume the closed unit disk B1(0) ⊂E is compact. Since it is compact, there is a ﬁnite covering
of B1(0), by open discs of radius 1/2, say { D1/2(xi) | i = 1, . . . , n }. Let F = span{x1, . . . , xn}. Since F is
ﬁnite dimensional, it is homeomorphic to Ck (or Rk) for some k ≤n, and thus complete. Being a complete
subspace of the metric space (E, ∥· ∥), it is closed. We claim that F = E.
If not, there would exist v ∈E, v ̸∈F. Since F = cl(F), the number d = inf{ ∥v −e∥| e ∈F } is
strictly positive. Let r > 0 be such that Br(v) ∩F ̸= ∅. The set Br(v) ∩F is closed and bounded in the
ﬁnite-dimensional space F, so is compact. Since inf{ ∥v −e∥| e ∈F } = inf{ ∥v −e∥| e ∈Br(v) ⊂F } and
the continuous function deﬁned by e ∈Br(v) ∩F →∥v −e∥∈]0, ∞[ attains its minimum, there is a point
e0 ∈Br(v) ∩F such that d = ∥v −e0∥. But then there is a point xi such that

v −e0
∥v −e0∥−xi
 < 1
2,
so that
∥v −e0 −(∥v −e0∥)xi∥< 1
2∥v −e0∥= d
2
Since e0 + ∥v −e0∥xi ∈F, we get ∥v −e0 −(∥v −e0∥)xi∥≥d, which is a contradiction.
■
2.1.12 Examples.
A.
Let X be a set and F a normed vector space. Deﬁne the set
B(X, F) =

f : X →F
 sup
x∈X
∥f(x)∥< ∞

.

2.1 Banach Spaces
43
Then B(X, F) is easily seen to be a normed vector space with respect to the sup-norm,
∥f∥∞= supx∈X ∥f(x)∥.
We prove that if F is complete, then B(X, F) is a Banach space. Let {fn} be a Cauchy sequence in B(X, F),
that is,
∥fn −fm∥∞< ε
for n, m ≥N(ε).
Since for each x ∈X, ∥f(x)∥≤∥f∥∞, it follows that {fn(x)} is a Cauchy sequence in F, whose limit
we denote by f(x). In the inequality ∥fn(x) −fm(x)∥< ε for all n, m ≥N(ε), let m →∞and get
∥fn(x) −f(x)∥≤ε for n ≥N(ε), that is, ∥fn −f∥∞≤ε for n ≥N(ε). This shows that fn −f ∈B(X, F),
that is, that f ∈B(X, F), and that ∥fn −f∥∞→0 as n →∞. As a particular case, we get the Banach
space cb consisting of all bounded real sequences {an} with the norm, also called the sup-norm,
∥{an}∥∞= supn |an|.
B.
If X is a topological space, the space
CB(X, F) = { f : X →F | f is continuous, f ∈B(X, F) }
is closed in B(X, F). Thus, if F is Banach, so is CB(X, F). In particular, if X is a compact topological space
and F is a Banach space, then
C(X, F) = { f : X →F | f continuous },
is a Banach space. For example, the vector space
C([0, 1], R) = { f : [0, 1] →R | f is continuous }
is a Banach space with the norm ∥f∥∞= sup{ |f(x)| | x ∈[0, 1] }.
C.
(For readers with some knowledge of measure theory.) Consider the space of real valued square inte-
grable functions deﬁned on an interval [a, b] ⊂R, that is, functions f that satisfy
	 b
a
|f(x)|2dx < ∞.
The function
∥· ∥: f →

	 b
a
|f(x)|2dx
1/2
is, strictly speaking, not a norm on this space; for example, if
f(x) =

0
for x ̸= a,
1
for x = a,
then ∥f∥= 0, but f ̸= 0. However, ∥· ∥does become a norm if we identify functions which diﬀer only on
a set of measure zero in [a, b], that is, which are equal almost everywhere. The resulting vector space of
equivalence classes [f] will be denoted L2[a, b]. With the norm of the equivalence class [f] deﬁned as
∥[f]∥=

	 b
a
|f(x)|2dx
1/2
,

44
2. Banach Spaces and Diﬀerential Calculus
L2[a, b] is an (inﬁnite-dimensional) Banach space. The only nontrivial part of this assertion is the complete-
ness; this is proved in books on measure theory, such as Royden [1968]. As is customary, [f] is denoted
simply by f. In fact, L2[a, b] is a Hilbert space with
⟨f, g⟩=
	 b
a
f(x)g(x) dx.
If we use square integrable complex-valued functions we get a complex Hilbert space L2([a, b], C) with
⟨f, g⟩=
	 b
a
f(x)g(x) dx.
D.
The space Lp([a, b]) may be deﬁned for each real number p ≥1 in an analogous fashion to L2[a, b].
Functions f : [a, b] →R satisfying
	 b
a
|f(x)|pdx < ∞
are considered equivalent if they agree almost everywhere. Lp([a, b]) is then deﬁned to be the vector space
of equivalence classes of functions equal almost everywhere.
∥· ∥p : Lp[a, b] →R
given by
[f] →

	 b
a
|f(x)|pdx
1/p
deﬁnes a norm, called the Lp –norm, which makes Lp[a, b] into an (inﬁnite-dimensional) Banach space.
E.
Denote by C([a, b], R) the set of continuous real valued functions on [a, b]. With the L1-norm, C([a, b], R)
is not a Banach space. For example, the sequence of continuous functions fn shown in Figure 2.1.2 is a Cauchy
sequence in the L1-norm on C([0, 1], R) but does not have a continuous limit function. On the other hand,
with the sup norm
∥f∥= sup
x∈[0,1]
|f(x)|,
C([0, 1]) is complete, that is, it is a Banach space, as in Example B.
♦
1/2
1/2 + 1/n
y = fn(x)
y
x
1
Figure 2.1.2. fn converges in L1, but not in C.

2.1 Banach Spaces
45
Quotients.
As in the case of both topological spaces and vector spaces, quotient spaces of normed vector
spaces play a fundamental role.
2.1.13 Proposition.
Let E be a normed vector space, F a closed subspace, E/F the quotient vector space,1
and π : E →E/F the canonical projection deﬁned by π(e) = [e] = e + F ∈E/F.
(i) The mapping ∥· ∥: E/F →R,
∥[e]∥= inf{ ∥e + v∥| v ∈F }
deﬁnes a norm on E/F.
(ii) π is continuous and the topology on E/F deﬁned by the norm coincides with the quotient topology. In
particular, π is open.
(iii) If E is a Banach space, so is E/F.
Proof.
(i) Clearly ∥[e]∥≥0 for all [e] ∈E/F and
∥[0]∥= inf{ ∥v∥| v ∈F } = 0.
If ∥[e]∥= 0, then there is a sequence {vn} ⊂F such that
lim
n→∞∥e + vn∥= 0.
Thus limn→∞vn = −e and since F is closed, e ∈F; that is, [e] = 0. Thus N1 is veriﬁed and the
necessity of having F closed becomes apparent. N2 and N3 are straightforward veriﬁcations.
(ii) Since ∥[e]∥≤∥e∥, it is obvious that limn→∞en = e implies
lim
n→∞π(en) = lim
n→∞[en] = [e]
and hence π is continuous. Translation by a ﬁxed vector is a homeomorphism. Thus to show that
the topology of E/F is the quotient topology, it suﬃces to show that if [0] ∈U and π−1(U) is a
neighborhood of zero in E, then U is a neighborhood of [0] in E/F. Since π−1(U) is a neighborhood
of zero in E, there exists a disk Dr(0) ⊂π−1(U). But then π(Dr(0)) ⊂U and π(Dr(0)) = { [e] | e ∈
Dr(0) } = { [e] | ∥[e]∥< r }, so that U is a neighborhood of [0] in E/F.
(iii) Let {[en]} be a Cauchy sequence in E/F. We may assume without loss of generality that ∥[en] −
[en+1]∥≤1/2n. Inductively, we ﬁnd points e′
n ∈[en] such that ∥e′
n −e′
n+1∥< 1/2n. Thus {e′
n} is
Cauchy in E so it converges to, say, e ∈E. Continuity of π implies that limn→∞[en] = [e].
■
The codimension of F in E is deﬁned to be the dimension of E/F. We say F is of ﬁnite codimension if
E/F is ﬁnite dimensional.
2.1.14 Deﬁnition.
The closed subspace F of the Banach space E is said to be split, or complemented,
if there is a closed subspace G ⊂E such that E = F ⊕G.
The relation between split subspaces and quotients is simple: the projection map of E to G induces, in
a natural way, a Banach space isomorphism of E/F with G. We leave this as a veriﬁcation for the reader.
One should note, however, that the quotient E/F is deﬁned independent of any choice of split subspace and
that, accordingly, the choice of G is not unique.
1This quotient is the same as the quotient in the sense discussed in Chapter 1, with the equivalence relation being u ∼v iﬀ
u −v ∈F, so that the equivalence class of u is the set u + F.

46
2. Banach Spaces and Diﬀerential Calculus
Supplement 2.1B
Split Subspaces
Deﬁnition 2.1.14 implicitly asks that the topology of E coincide with the product topology of F ⊕G. We
shall show in Supplement 2.2C that this topological condition can be dropped; that is, F is split iﬀE is the
algebraic direct sum of F and the closed subspace G.
As we noted above, if E = F ⊕G then G is isomorphic to E/F. However, F need not split for E/F to
be a Banach space, as we proved in Proposition 2.1.13. In ﬁnite-dimensional spaces, any subspace is closed
and splits; however, in inﬁnite dimensions this is false. For example, let E = Lp(S1) and let
F = { f ∈E | f(n) = 0 for n < 0 },
where
f(n) = 1
2π
	 π
−π
f(θ)e−inθdθ
is the nth Fourier coeﬃcient of f. Then F is closed in E, splits in E for 1 < p < ∞by a theorem of M.
Riesz (Theorem 17.26 of Rudin [1966]) but does not split in E for p = 1 (Example 5.19 of Rudin [1973]).
The same result holds if E = C0(S1, C) and F has the same deﬁnition.
Another example worth mentioning is E = ℓ∞, the Banach space of all bounded sequences, and F = c0, the
subspace of ℓ∞consisting of all sequences convergent to zero. The subspace F = c0 is closed in E = ℓ∞, but
does not split. However, c0 splits in any separable Banach space which contains it isomorphically as a closed
subspace by a theorem of Sobczyk; see Veech [1971]. If every subspace of a Banach space is complemented, the
space must be isomorphic to a Hilbert space by a result of Lindenstrauss and Tzafriri [1971]. Supplement
2.2B gives some general criteria useful in nonlinear analysis for a subspace to be split. But the simplest
situation occurs in Hilbert spaces.
2.1.15 Proposition.
If E is a Hilbert space and F a closed subspace, then E = F⊕F⊥. Thus every closed
subspace of a Hilbert space splits.
The proof of this theorem is done in three steps, the ﬁrst two being important results in their own rights.
2.1.16 Theorem (Minimal Norm Elements in Closed Convex Sets).
If
C is a closed convex set in E, that is, x, y ∈C and 0 ≤t ≤1 implies
tx + (1 −t)y ∈C,
then there exists a unique e0 ∈C such that
∥e0∥= inf{ ∥e∥| e ∈C }.
Proof.
Let
√
d = inf{ ∥e∥| e ∈C } . Then there exists a sequence {en} satisfying the inequality d ≤
∥en∥2 < d+1/n; hence ∥en∥2 →d. Since (en+em)/2 ∈C, C being convex, it follows that ∥(en+em)/2∥2 ≥d.
By the parallelogram law,

en −em
2

2
= 2
en
2

2
+ 2
em
2

2
−

en + em
2

2
< d
2 + 1
2n + d
2 + 1
2m −d = 1
2
 1
n + 1
m

;
that is, {en} is a Cauchy sequence in E. Let limn→∞en = e0. Continuity of the norm implies that
√
d =
limn→∞∥en∥= ∥e0∥, and so the existence of an element of minimum norm in C is proved.

2.1 Banach Spaces
47
Finally, if f0 is such that ∥e0∥= ∥f0∥=
√
d, the parallelogram law implies

e0 −f0
2

2
= 2
e0
2
 + 2

f0
2

2
−

e0 + f0
2

2
≤d
2 + d
2 −d = 0;
that is, e0 = f0.
■
2.1.17 Lemma.
Let F ⊂E, F ̸= E be a closed subspace of E. Then there exists a nonzero element e0 ∈E
such that e0 ⊥F.
Proof.
Let e ∈E, e ̸∈F. The set e −F = { e −v | v ∈F } is convex and closed, so by the previous lemma
it contains a unique element e0 = e −v0 ∈e −F of minimum norm. Since F is closed and e ̸∈F, it follows
that e0 ̸= 0. We shall prove that e0 ⊥F.
Since e0 is of minimal norm in e −F, for any v ∈F and λ ∈C (resp., R), we have
∥e0∥= ∥e −v0∥≤∥e −v0 + λv∥= ∥e0 + λv∥,
that is, 2 Re(λ ⟨v, e0⟩) + |λ|2∥v∥2 ≥0.
If λ = a ⟨e0, v⟩, a ∈R, a ̸= 0, this becomes
a|⟨v, e0⟩|2(2 + a∥v∥2) ≥0
for all v ∈F, and a ∈R, a ̸= 0. This forces ⟨v, e0⟩= 0 for all v ∈F, since if −2/∥v∥2 < a < 0, the preceding
expression is negative.
■
Proof of Proposition 2.1.15.
It is easy to see that F⊥is closed (Exercise 2.1-3). We now show that
F ⊕F⊥is a closed subspace. If
{en + e′
n} ⊂F ⊕F⊥,
{en} ⊂F,
{e′
n} ⊂F⊥,
the relation
∥(en + e′
n) −(em + e′
m)∥2 = ∥en −e′
n∥2 + ∥em −e′
m∥2
shows that {en + e′
n} is Cauchy iﬀboth {en} ⊂F and {e′
n} ⊂F⊥are Cauchy. Thus if {en + e′
n} converges,
then there exist e ∈F, e′ ∈F⊥such that limn→∞en = e, limn→∞e′
n = e′. Thus
lim
n→∞(en + e′
n) = e + e′ ∈F ⊕F⊥.
If F ⊕F⊥̸= E, then by the previous lemma there exists e0 ∈E, e0 ̸∈F ⊕F⊥, e0 ̸= 0, e0 ⊥(F ⊕F⊥).
Hence e0 ∈F⊥and e0 ∈F so that ⟨e0, e0⟩= ∥e0∥2 = 0; that is, e0 = 0, a contradiction.
■
Exercises
⋄2.1-1.
Show that a normed space is an inner product space iﬀthe norm satisﬁes the parallelogram law.
Conclude that if n ≥2, |||x||| =  |xi| on Rn does not arise from an inner product.
Hint: Use the polarization identities over R and C to guess the corresponding inner-products.
⋄2.1-2.
Let c0 be the space of real sequences {an} such that an →0 as n →∞. Show that c0 is a closed
subspace of the space cb of bounded sequences (see Example 2.1.12A) and conclude that c0 is a Banach
space.

48
2. Banach Spaces and Diﬀerential Calculus
⋄2.1-3.
Let E1 be the set of all C1 functions f : [0, 1] →R with the norm
∥f∥= sup
x∈[0,1]
|f(x)| + sup
x∈[0,1]
|f ′(x)|.
(i) Prove that E1 is a Banach space.
(ii) Let E0 be the space of C0 maps f : [0, 1] →R, as in Example 2.1.12. Show that the inclusion map
E1 →E0 is compact; that is, the unit ball in E1 has compact closure E0.
Hint: Use the Arzela–Ascoli theorem.
⋄2.1-4.
Let (E, ⟨·, ·⟩) be an inner product space and A, B subsets of E. Deﬁne the sum of A and B by
A + B = { a + b | a ∈A, b ∈B }. Show that:
(i) A ⊂B implies B⊥⊂A⊥;
(ii) A⊥is a closed subspace of E;
(iii) A⊥= (cl(span(A)))⊥, (A⊥)⊥= cl(span(A));
(iv) (A + B)⊥= A⊥∩B⊥; and
(v) (cl(span(A)) ∩cl(span(B)))⊥= A⊥+ B⊥(not necessarily a direct sum).
⋄2.1-5.
A sequence {en} ⊂E, where E is an inner product space, is said to be weakly convergent to
e ∈E iﬀall the numerical sequences ⟨v, en⟩converge to ⟨v, e⟩for all v ∈E. Let
ℓ2(C) =

{an}
 an ∈C and
∞

n=1
|an|2 < ∞

and put
⟨{an} , {bn}⟩=
∞

n=1
anbn.
Show that:
(i) in any inner product space, convergence implies weak convergence;
(ii) ℓ2(C) is an inner product space;
(iii) the sequence (1, 0, 0, . . . ), (0, 1, 0, . . . ), (0, 0, 1, . . . ), . . . is not convergent but is weakly convergent to 0
in ℓ2(C).
Note: ℓ2(C) is in fact complete, so it is a Hilbert space. The ambitious reader can attempt a direct proof
or consult a book on real analysis such as Royden [1968].
⋄2.1-6.
Show that a normed vector space is a Banach space iﬀevery absolutely convergent series is conver-
gent. (A series ∞
n=1 xn is called absolutely convergent if ∞
n=1 ∥xn∥converges.)
⋄2.1-7.
Let E be a Banach space and F1 ⊂F2 ⊂E be closed subspaces such that F2 splits in E. Show
that F1 splits in E iﬀF1 splits in F2.
⋄2.1-8.
Let F be closed in E of ﬁnite codimension. Show that if G is a subspace of E containing F, then
G is closed.
⋄2.1-9.
Let E be a Hilbert space. A set {ei}i∈I is called orthonormal if ⟨ei, ej⟩= δij, the Kronecker delta.
An orthonormal set {ei}i∈I is a Hilbert basis if cl(span{ei}i∈I) = E.

2.2 Linear and Multilinear Mappings
49
(i) Let {ei}i∈I be an orthonormal set and {ei(1), . . . , ei(n)} be any ﬁnite subset. Show that
n

j=1

e, ei(j)
2 ≤∥e∥2
for any e ∈E.
Hint:
e′ = e −

j=1,...,n

e, ei(j)

ei(j)
is orthogonal to all { ei(j) | j = 1, . . . , n }.
(ii) Deduce from (i) that for any positive integer n, the set { i ∈I | |⟨e, ei⟩| > 1/n } has at most n∥e∥2
elements. Hence at most countably many i ∈I satisfy ⟨e, ei⟩̸= 0, for any e ∈E.
(iii) Show that any Hilbert space has a Hilbert basis.
Hint: Use Zorn’s lemma and Lemma 2.1.17.
(iv) If {ei}i∈I is a Hilbert basis in E, e ∈E, and {ei(j)} is the (at most countable) set such that

e, ei(j)

̸= 0,
show that
∞

j=1

e, ei(j)
2 = ∥e∥2.
Hint: If
e′ =

j=1,...,∞

e, ei(j)

ei(j),
show that
⟨ei, e −e′⟩= 0
for all i ∈I
and then use maximality of {ei}i∈I.
(v) Show that E is separable iﬀany Hilbert basis is at most countable.
Hint: For the “if” part, show that the set

n

k=1
αnen
 αk = ak + ibk, where ak and bk are rational

is dense in E. For the “only if” part, show that since ∥ei −ej∥2 = 2, the disks of radius 1/
√
2 centered
at ei are all disjoint. )
(vi) If E is a separable Hilbert space, it is algebraically isomorphic either with Cn or ℓ2(C) (Rn or ℓ2(R)),
and the algebraic isomorphism can be chosen to be norm preserving.
2.2
Linear and Multilinear Mappings
This section deals with various aspects of linear and multilinear maps between Banach spaces. We begin
with a study of continuity and go on to study spaces of continuous linear and multilinear maps and some
related fundamental theorems of linear analysis.

50
2. Banach Spaces and Diﬀerential Calculus
Continuity and Boundedness.
We begin by showing for a linear map, the equivalence of continuity
and possessing a certain bound.
2.2.1 Proposition.
Let A : E →F be a linear map of normed spaces. Then A is continuous if and only
if there is a constant M > 0 such that
∥Ae∥F ≤M∥e∥E
for all e ∈E.
Proof.
Continuity of A at e0 ∈E means that for any r > 0, there exists ρ > 0 such that
A(e0 + Bρ(0E)) ⊂Ae0 + Br(0F)
(0E denotes the zero element in E and Bs(0E) denotes the closed disk of radius s centered at the origin in
E). Since A is linear, this is equivalent to: if ∥e∥E ≤ρ, then ∥Ae∥F ≤r. If M = r/ρ, continuity of A is thus
equivalent to the following: ∥e∥E ≤1 implies ∥Ae∥F ≤M, which in turn is the same as: there exists M > 0
such that ∥Ae∥F ≤M∥e∥E, which is seen by choosing the vector e/∥e∥E in the preceding implication.
■
Because of this proposition one says that a continuous linear map is bounded.
2.2.2 Proposition.
If E is ﬁnite dimensional and A : E →F is linear, then A is continuous.
Proof.
Let {e1, . . . , en} be a basis for E. Letting
M1 = max (∥Ae1∥, . . . , ∥Aen∥)
and setting e = a1e1 + · · · + anen, we see that
∥Ae∥= ∥a1Ae1 + · · · + anAen∥
≤|a1| ∥Ae1∥+ · · · + |an| ∥Aen∥≤M1(|a1| + · · · + |an|).
Since E is ﬁnite dimensional, all norms on it are equivalent. Since |||e||| =  |ai| is a norm, it follows that
|||e||| ≤C∥e∥for a constant C. Let M = M1C and use Proposition 2.2.1.
■
Operator Norm.
The bound on continuous linear maps suggests a norm for such maps.
2.2.3 Deﬁnition.
If E and F are normed spaces and A : E →F is a continuous linear map, let the
operator norm of A be deﬁned by
∥A∥= sup
 ∥Ae∥
∥e∥
 e ∈E, e ̸= 0

(which is ﬁnite by Proposition 2.2.1). Let L(E, F) denote the space of all continuous linear maps of E to F.
If F = C (resp., R), then L(E, C) (resp., L(E, R)) is denoted by E∗and is called the complex (resp., real)
dual space of E. (It will always be clear from the context whether L(E, F) or E∗means the real or complex
linear maps or dual space; in most of the work later in this book it will mean the real case.)
A straightforward veriﬁcation gives the following equivalent deﬁnitions of ∥A∥:
∥A∥= inf{ M > 0 | ∥Ae∥≤M∥e∥for all e ∈E }
= sup{ ∥Ae∥| ∥e∥≤1 } = sup{ ∥Ae∥| ∥e∥= 1 }.
In particular, ∥Ae∥≤∥A∥∥e∥.
If A ∈L(E, F) and B ∈L(F, G), where E, F, and G are normed spaces, then
∥(B ◦A)(e)∥= ∥B(A(e))∥≤∥B∥∥Ae∥≤∥B∥∥A∥∥e∥,
and so
∥(B ◦A)∥≤∥B∥∥A∥.
Equality does not hold in general. A simple example is obtained by choosing E = F = G = R2, A(x, y) =
(x, 0), and B(x, y) = (0, y), so that B ◦A = 0 and ∥A∥= ∥B∥= 1 .

2.2 Linear and Multilinear Mappings
51
2.2.4 Proposition.
L(E, F) with the norm just deﬁned is a normed space. It is a Banach space if F is.
Proof.
Clearly ∥A∥≥0 and ∥0∥= 0. If ∥A∥= 0, then for any e ∈E, ∥Ae∥≤∥A∥∥e∥= 0, so that A = 0
and thus N1 (see Deﬁnition 2.1.1) is veriﬁed. N2 and N3 are also straightforward to check.
Now let F be a Banach space and {An} ⊂L(E, F) be a Cauchy sequence. Because of the inequality
∥Ane −Ame∥≤∥An −Am∥∥e∥for each e ∈E, the sequence {Ane} is Cauchy in F and hence is convergent.
Let Ae = limn→∞Ane. This deﬁnes a map A : E →F, which is evidently linear. It remains to be shown
that A is continuous and ∥An −A∥→0.
If ε > 0 is given, there exists a natural number N(ε)such that for all m, n ≥N(ε) we have ∥An−Am∥< ε.
If ∥e∥≤1, this implies
∥Ane −Ame∥< ε,
and now letting m →∞, it follows that ∥Ane −Ae∥≤ε for all e with ∥e∥≤1. Thus An −A ∈L(E, F),
hence A ∈L(E, F) and ∥An −A∥≤ε for all n ≥N(ε); that is, ∥An −A∥→0.
■
If a sequence {An} converges to A in L(E, F) in the sense that
∥An −A∥→0,
that is,
if An →A
in the norm topology, we say An →A in norm. This phrase is necessary since other topologies on L(E, F)
are possible. For example, we say that An →A strongly if Ane →Ae for each e ∈E. Since ∥Ane −Ae∥≤
∥An −A∥∥e∥, norm convergence implies strong convergence. The converse is false as the following example
shows. Let
E = ℓ2(R) =

{an}

∞

n=1
a2
n < ∞

with inner product
⟨{an} , {bn}⟩=
∞

n=1
anbn.
Let
en = (0, . . . , 0, 1, 0, . . . ) ∈E,
F = R,
and
An = ⟨en, ·⟩∈L(E, F),
where the 1 in en is in the nth slot. The sequence {An} is not Cauchy in the operator norm since ∥An −
Am∥=
√
2, but if e = {am}, An(e) = ⟨en, e⟩= an →0, that is, An →0 strongly. If both E and F
are ﬁnite dimensional, strong convergence implies norm convergence. (To see this, choose a basis e1, . . . , en
of E and note that strong convergence is equivalent to Akei →Aei as k →∞for i = 1, . . . , n. Hence
maxi ∥Aei∥= |||A||| is a norm yielding strong convergence. But all norms are equivalent in ﬁnite dimensions.)
Supplement 2.2A
Dual Spaces
Riesz Representation Theorem.
Recall from elementary linear algebra that the dual space of a ﬁnite
dimensional vector space of dimension n also has dimension n and so the space and its dual are isomorphic.
For general Banach spaces this is no longer true. However, it is true for Hilbert space.

52
2. Banach Spaces and Diﬀerential Calculus
2.2.5 Theorem (Riesz Representation Theorem).
Let E be a real (resp., complex) Hilbert space. The map
e →⟨·, e⟩is a linear (resp., antilinear) norm-preserving isomorphism of E with E∗; for short, E ∼= E∗. (A
map A : E →F between complex vector spaces is called antilinear if we have the identities A(e + e′) =
Ae + Ae′, and A(αe) = αAe.)
Proof.
Let fe = ⟨·, e⟩. Then ∥fe∥= ∥e∥and thus fe ∈E∗. The map A : E →E∗, Ae = fe is clearly linear
(resp. antilinear), norm preserving, and thus injective. It remains to prove surjectivity.
Let f ∈E∗and ker(f) = { e ∈E | f(e) = 0 }. ker(f) is a closed subspace in E. If ker(f) = E, then f = 0
and f = A(0) so there is nothing to prove. If ker(f) ̸= E, then by Lemma 2.1.17 there exists e ̸= 0 such that
e ⊥ker(f). Then we claim that f = A(f(e)e/∥e∥2). Indeed, any v ∈E can be written as
v = v −f(v)
f(e)e + f(v)
f(e)e
and
v −f(v)
f(e)e ∈ker(f).
■
Thus, in a real Hilbert space E every continuous linear function ℓ: E →R can be written
ℓ(e) = ⟨e0, e⟩
for some e0 ∈E and ∥ℓ∥= ∥e0∥.
In a general Banach space E we do not have such a concrete realization of E∗. However, one should
not always attempt to identify E and E∗, even in ﬁnite dimensions. In fact, distinguishing these spaces is
fundamental in tensor analysis.
Reﬂexive Spaces.
We have a canonical map i : E →E∗∗deﬁned by
i(e)(ℓ) = ℓ(e).
Pause and look again at this strange but natural formula: i(e) ∈E∗∗= (E∗)∗, so i(e) is applied to the
element ℓ∈E∗. It is easy to check that i is norm preserving. One calls E reﬂexive if i is onto. Hilbert
spaces are reﬂexive, by Theorem 2.2.5. For example, let V = L2(Rn) with inner product
⟨f, g⟩=
	
Rn f(x)g(x) dx,
and let α : L2(Rn) →R be a continuous linear functional. Then the Riesz representation theorem guarantees
that there exists a unique g ∈L2(Rn) such that
α(f) =
	
Rn g(x)f(x) dx = ⟨g, f⟩
for all f ∈L2(Rn).
In general, if E is not a Hilbert space and we wish to represent a linear functional α in the form of
α(f) = ⟨g, f⟩, we must regard g(x) as an element of the dual space E∗. For example, let E = C0(Ω, R),
where Ω⊂Rn. Each x ∈Ωdeﬁnes a linear functional Ex : C0(Ω, R) →R; f →f(x). This linear functional
cannot be represented in the form Ex(f) = ⟨g, f⟩and, indeed, is not continuous in the L2 norm. Nevertheless,
it is customary and useful to write such linear maps as if ⟨, ⟩were the L2 inner product. Thus one writes,
symbolically,
Ex0(f) =
	
Ω
δ(x −x0)f(x) dx,
which deﬁnes the Dirac delta function at x0; that is, g(x) = δ(x −x0).

2.2 Linear and Multilinear Mappings
53
Linear Extension Theorem.
Next we shall discuss integration of vector valued functions. We shall
require the following.
2.2.6 Theorem (Linear Extension Theorem).
Let E, F, and G be normed vector spaces where
(i) F ⊂E;
(ii) G is a Banach space; and
(iii) T ∈L(F, G).
Then the closure cl(F) of F is a normed vector subspace of E and T can be uniquely extended to a map
T ∈L(cl(F), G). Moreover, we have the equality ∥T∥= ∥T ∥.
Proof.
The fact that cl(F) is a linear subspace of E is easily checked. Note that if T exists it is unique by
continuity. Let us prove the existence of T . If e ∈cl(F), we can write e = limn→∞en, where en ∈F, so that
∥Ten −Tem∥≤∥T∥∥en −em∥,
which shows that the sequence {Ten} is Cauchy in the Banach space G. Let T e = limn→∞Ten. This limit
is independent of the sequence {en}, for if e = lim e′
n, then
∥Ten −Te′
n∥≤∥T∥(∥en −e∥+ ∥e −e′
n∥),
which proves that limn→∞(Ten) = limn→∞(Te′
n). It is simple to check the linearity of T . Since Te = T e
for e ∈F (because e = limn→∞e), T is an extension of T. Finally,
∥T e∥=
 lim
n→∞(Ten)
 = lim
n→∞∥Ten∥≤∥T∥lim
n→∞∥en∥= ∥T∥∥e∥
shows that T ∈L(cl(F), G) and ∥T ∥≤∥T∥. The inequality ∥T∥≤∥T ∥is obvious since T extends T.
■
Integration of Banach Space Valued Functions.
As an application of the preceding lemma we deﬁne
a Banach space valued integral that will be of use later on. Fix the closed interval [a, b] ⊂R and the Banach
space E. A map f : [a, b] →E is called a step function if there exists a partition a = t0 < t1 < · · · < tn = b
such that f is constant on each interval [ti, ti+1[. Using the standard notion of a reﬁnement of a partition, it
is clear that the sum of two step functions and the scalar multiples of step functions are also step functions.
Thus the set S([a, b], E) of step functions is a vector subspace of B([a, b], E), the Banach space of all bounded
functions (see Example 2.1.12). The integral of a step function f is deﬁned by
	 b
a
f =
n

i=0
(ti+1 −ti)f(ti).
It is easily veriﬁed that this deﬁnition is independent of the partition. Also note that

	 b
a
f
 ≤
	 b
a
∥f∥≤(b −a) ∥f∥∞,
where ∥f∥∞= supa≤t≤b |f(t)|; that is,
	 b
a
: S([a, b], E) →E
is continuous and linear. By the linear extension theorem, it extends to a continuous linear map
	 b
a
∈L(cl(S([a, b], E)), E).

54
2. Banach Spaces and Diﬀerential Calculus
2.2.7 Deﬁnition.
The extended linear map
 b
a is called the Cauchy–Bochner integral.
Note that

	 b
a
f
 ≤
	 b
a
∥f∥≤(b −a) ∥f∥∞.
The usual properties of the integral such as
	 b
a
f =
	 c
a
f +
	 b
c
f
and
	 b
a
f = −
	 a
b
f
are easily veriﬁed since they clearly hold for step functions.
The space cl(S([a, b], E) contains enough interesting functions for our purposes, namely
C0([a, b], E) ⊂cl(S([a, b], E)) ⊂B([a, b], E).
The ﬁrst inclusion is proved in the following way. Since [a, b] is compact, each f ∈C0([a, b], E) is uniformly
continuous. For ε > 0, let δ > 0 be given by uniform continuity of f for ε/2. Then take a partition
a = t0 < · · · < tn = b such that |ti+1 −t1| < δ and deﬁne a step function g by g|[ti, ti+1[ = f(ti) . Then the
ε-disk Dε(f) in B([a, b], E) contains g.
Finally, note that if E and F are Banach spaces, A ∈L(E, F), and f ∈cl(S([a, b], E)), we have A ◦f ∈
cl(S([a, b], F)) since
∥A ◦fn −A ◦f∥≤∥A∥∥fn −f∥∞,
where fn are step functions in E. Moreover,
	 b
a
A ◦f = A

	 b
a
f

since this relation is obtained as the limit of the same (easily veriﬁed) relation for step functions. The reader
versed in Riemann integration should notice that this integral for E = R is less general than the Riemann
integral; that is, the Riemann integral exists also for functions outside of cl(S([a, b], R)). For purposes of this
book, however, this integral will suﬃce.
Multilinear Mappings.
If E1, . . . , Ek and F are linear spaces, a map
A : E1 × · · · × Ek →F
is called k-multilinear if A(e1, . . . , ek) is linear in each argument separately. Linearity in the ﬁrst argument
means that
A(λe1 + µf1, e2, . . . , ek) = λA(e1, e2, . . . , ek) + µA(f1, e2, . . . , ek).
We shall study multilinear mappings in detail in our study of tensors. They also come up in the study of
diﬀerentiation, and we shall require a few facts about them for that purpose.
2.2.8 Deﬁnition.
The space of all continuous k-multilinear maps from E1 × · · · × Ek to F is denoted
L(E1, . . . , Ek; F). If Ei = E, 1 ≤i ≤k, this space is denoted Lk(E, F).
As in Deﬁnition 2.1.1, a k-multilinear map A is continuous if and only if there is an M > 0 such that
∥A(e1, . . . , ek)∥≤M∥e1∥· · · ∥ek∥

2.2 Linear and Multilinear Mappings
55
for all ei ∈Ei, 1 ≤i ≤k. We set
∥A∥= sup
 ∥A(e1, . . . , ek)∥
∥e1∥· · · ∥ek∥
 e1, . . . , ek ̸= 0

,
which makes L(E1, . . . , Ek; F) into a normed space that is complete if F is. Again ∥A∥can also be deﬁned
as
∥A∥= inf{ M > 0 | ∥A(e1, . . . , en)∥≤M∥e1∥· · · ∥en∥}
= sup{ ∥A(e1, . . . , en)∥| ∥e1∥≤1, . . . , ∥en∥≤1 }
= sup{ ∥A(e1, . . . , en)∥| ∥e1∥= · · · = ∥en∥= 1 }.
2.2.9 Proposition.
There are (natural) norm-preserving isomorphisms
L(E1, L(E2, . . . , Ek; F)) ∼= L(E1, . . . , Ek; F)
∼= L(E1, . . . , Ek−1; L(Ek, F))
∼= L(Ei1, . . . , Eik; F)
where (i1, . . . , ik) is a permutation of (1, . . . , k).
Proof.
For A ∈L(E1, L(E2, . . . , Ek; F)), deﬁne A′ ∈L(E1, . . . , Ek; F) by
A′(e1, . . . , ek) = A(e1)(e2, . . . , ek).
The association A →A′ is clearly linear and ∥A′∥= ∥A∥. The other isomorphisms are proved similarly.
■
In a similar way, we can identify L(R, F) (or L(C, F) if F is complex) with F: to A ∈L(R, F) we associate
A(1) ∈F; again ∥A∥= ∥A(1)∥. As a special case of Proposition 2.2.9 note that L(E, E∗) ∼= L2(E, R) (or
L2(E; C), if E is complex). This isomorphism will be useful when we consider second derivatives.
Permutations.
We shall need a few facts about the permutation group on k elements. The information
we cite is obtainable from virtually any elementary algebra book. The permutation group on k elements,
denoted Sk, consists of all bijections σ : {1, . . . , k} →{1, . . . , k} together with the structure of a group under
composition. Clearly, Sk has order k!, that is, Sk has k! elements.
One of the more subtle but very useful properties of permutations is the notion of the sign of a permutation.
Letting (R, ×) denote R\{0} with the multiplicative group structure, the sign is a homomorphism
sign : Sk →(R, ×).
Being a homomorphism means that for σ, τ ∈Sk,
sign(σ ◦τ) = (sign σ)(sign τ).
The image of “sign” is the subgroup {−1, 1}, while its kernel consists of the subgroup of even permutations.
Thus, a permutation σ is even when sign σ = +1 and is odd when sign σ = −1.
The sign of a permutation is perhaps easiest to understand in terms of transpositions. A transposition is
a permutation that swaps two elements of {1, . . . , k}, leaving the remainder ﬁxed. An even (odd) permutation
can be written as the product of an even (odd) number of transpositions.
The group Sk acts on the space Lk(E; F); that is, each σ ∈Sk deﬁnes a map σ : Lk(E; F) →Lk(E; F)
by
(σA)(e1, . . . , ek) = A(eσ(1), . . . , eσ(k)).
Note that (τσ)A = τ(σA) for all τ, σ ∈Sk. Accordingly, A ∈Lk(E, F) is called symmetric (antisymmet-
ric) if for any permutation σ ∈Sk, σA = A (resp., σA = (sign σ)A.)

56
2. Banach Spaces and Diﬀerential Calculus
2.2.10 Deﬁnition.
Let E and F be normed vector spaces. Let Lk
s(E; F) and Lk
a(E; F) denote the subspaces
of symmetric and antisymmetric elements of Lk(E; F). Write S0(E, F) = F and
Sk(E, F) = { p : E →F | p(e) = A(e, . . . , e) for some A ∈Lk(E; F) }.
We call Sk(E, F) the space of homogeneous polynomials of degree k from E to F.
Note that Lk
s(E; F) and Lk
a(E; F) are closed in Lk(E; F); thus if F is a Banach space, so are Lk
s(E; F) and
Lk
a(E; F). The antisymmetric maps Lk
a(E; F) will be studied in detail in Chapter 7. For technical purposes
later in this chapter we will need a few facts about Sk(E, F) which are given in the following supplement.
Supplement 2.2B
Homogeneous Polynomials
2.2.11 Proposition.
(i)
Sk(E, F) is a normed vector space with respect to the following norm:
∥f∥= inf{ M > 0 | ∥f(e)∥≤M∥e∥k } = sup{ ∥f(e)∥| ∥e∥≤1 }
= sup{ ∥f(e)∥| ∥e∥= 1 }.
It is complete if F is.
(ii) If f ∈Sk(E, F) and g ∈Sn(F, G), then g ◦f ∈Skn(E, G) and ∥g ◦f∥≤∥g∥∥f∥.
(iii) (Polarization.) The mapping
′ : Lk(E, F) →Sk(E, F) deﬁned by A′(e) = A(e, . . . , e) restricted to
Lk
s(E; F) has an inverse `: Sk(E, F) →Lk
s(E, F) given by
`f(e1, . . . , ek) = 1
k!
∂k
∂t1 · · · ∂tk

t=0
f(t1e1 + · · · + tkek).
(Note that f(t1e1 + · · · + tkek) is a polynomial in t1, . . . , tk, so there is no problem in understanding
what the derivatives on the right hand side mean.)
(iv) For A ∈Lk(E, F), ∥A′∥≤∥A∥≤(kk/k!)∥A′∥, which implies the maps ′ and`are continuous.
Proof.
(i) and (ii) are proved exactly as for L(E, F) = S1(E, F).
(iii) For A ∈Lk
s(E; F) we have
A′(t1e1 + · · · + tkek)
=

a1+···+aj=k
k!
a1! · · · aj! ta1
1 · · · taj
j A(e1, . . . , e1, . . . , ej, . . . , ej),
where each ei appears ai times, and
∂k
∂t1 · · · ∂tk

t=0
ta1
1 · · · taj
j
=

1,
if k = j,
0,
if k ̸= j.
It follows that
A(e1, . . . , ek) = 1
k!
∂k
∂t1 · · · ∂tk
A′(t1e1 + · · · + tkek),

2.2 Linear and Multilinear Mappings
57
and for j ̸= k,
∂j
∂t1 · · · ∂tj
A′(t1e1 + · · · + tkek) = 0
This means that`(A′) = A for any A ∈Lk
s(E, F).
Conversely, if f ∈Sk(E, F), then
(`f)′(e) =`f(e, . . . , e) = 1
k!
∂k
∂t1 · · · ∂tk

t=0
f(t1e + · · · + tke)
= 1
k!
∂k
∂t1 · · · ∂tk

t=0
(t1 + · · · + tk)kf(e) = f(e).
(iv) ∥A′(e)∥= ∥A(e, . . . , e)∥≤∥A∥∥e∥k, so ∥A′∥≤∥A∥. To prove the other inequality, note that if A ∈
Lk
s(E; F), then
A(e1, . . . , ek) =
1
k!2k

ε1 · · · εk A′(ε1e1 + · · · + εkek),
where the sum is taken over all the 2k possibilities ε1 = ±1, . . . , εk = ±1. Put ∥e1∥= · · · = ∥ek∥= 1 and
get
∥A′(ε1e1 + · · · + εkek)∥≤∥A′∥∥ε1e1 + · · · + εkek∥k
≤∥A′∥(|ε1| ∥e1∥+ · · · + |εk| ∥ek∥)k = ∥A′∥kk,
whence
∥A(e1, . . . , ek)∥≤kk
k! ∥A′∥,
that is,
∥A∥≤kk
k! ∥A′∥.
■
Let E = Rn, F = R, and e1, . . . , en be the standard basis in Rn. For f ∈Sk(Rn, R), set
ca1···an = f(e1, . . . , e1, . . . , en, . . . , en),
where each ei appears ai times. If e = t1e1 + · · · + tnen, the proof of (iii) shows that
f(e) =`f(e, . . . , e) =

a1+···+an=k
ca1...anta1
1 · · · tan
n ,
that is, f is a homogeneous polynomial of degree k in t1, . . . , tn in the usual algebraic sense.
The constant kk/k! in (iv) is the best possible, as the following example shows. Write elements of Rk as
x = (x1, . . . , xk) and introduce the norm
|||(x1, . . . , xk)||| = |x1| + · · · + |xk|.
Deﬁne A ∈Lk
s(Rk, R) by
A(x1, . . . , xk) = 1
k!

x1
i1 . . . xk
ik,
where xi = (x1
i , . . . , xk
i ) ∈Rk and the sum is taken over all permutations of {1, . . . , k}. It is easily veriﬁed that
∥A∥= 1/k! and ∥A′∥= 1/kk; that is, ∥A∥= (kk/k!)∥A′∥. Thus, except for k = 1, the isomorphism ′ is not
norm preserving. (This is a source of annoyance in the theory of formal power series and inﬁnite-dimensional
holomorphic mappings.)

58
2. Banach Spaces and Diﬀerential Calculus
Supplement 2.2C
The Three Pillars of Linear Analysis
The three fundamental theorems of linear analysis are the Hahn–Banach theorem, the open mapping theorem,
and the uniform boundedness principle. See, for example, Banach [1932] and Riesz and Sz.-Nagy [1952] for
further information. This supplement gives the classical proofs of these three fundamental theorems and
derives some corollaries that will be used later. In ﬁnite dimensions these corollaries are all “obvious.”
Hahn–Banach Theorem.
This basic result guarantees a rich supply of continuous linear functionals.
2.2.12 Theorem (Hahn–Banach Theorem).
Let E be a real or complex vector space, ∥· ∥: E →R a
seminorm, and F ⊂E a subspace. If f ∈F∗satisﬁes |f(e)| ≤∥e∥for all e ∈F, then there exists a linear
map f ′ : E →R (or C) such that f ′|F = f and |f ′(e)| ≤∥e∥for all e ∈E.
Proof.
Real Case.
First we show that f ∈F∗can be extended with the given property to F⊕span{e0},
for a given e0 ̸∈F. For e1, e2 ∈F we have
f(e1) + f(e2) = f(e1 + e2) ≤∥e1 + e2∥≤∥e1 + e0∥+ ∥e2 −e0∥,
so that
f(e2) −∥e2 −e0∥≤∥e1 + e0∥−f(e1),
and hence
sup{ f(e2) −∥e2 −e0∥| e2 ∈F } ≤inf{ ∥e1 + e0∥−f(e1) | e1 ∈F }.
Let a ∈R be any number between the sup and inf in the preceding expression and deﬁne f ′ : F⊕span {e0} →
R by f ′(e+te0) = f(e)+ta. It is clear that f ′ is linear and that f ′|F = f. To show that |f ′(e+te0)| ≤∥e+te0∥,
note that by the deﬁnition of a,
f(e2) −∥e2 −e0∥≤a ≤∥e1 + e0∥−f(e1),
so that by multiplying the second inequality by t ≥0 and the ﬁrst by t < 0, we get the desired result.
Second, one veriﬁes that the set S = { (G, g) | F ⊂G ⊂E, G is a subspace of E, g ∈G∗, g|F = f, and
|g(e)| ≤∥e∥for all e ∈G } is inductively ordered with respect to the ordering
(G1, g1) ≤(G2, g2)
iﬀ
G1 ⊂G2 and g2|G1 = g1.
Thus by Zorn’s lemma there exists a maximal element (F0, f0) of S.
Third, using the ﬁrst step and the maximality of (F0, f0), one concludes that F0 = E.
Complex Case.
Let f = Re f + i Im f and note that complex linearity implies that (Im f)(e) =
−(Re f)(ie) for all e ∈F. By the real case, Re f extends to a real linear continuous map (Re f) : E →R,
such that |(Re f)′(e)| ≤∥e∥for all e ∈E. Deﬁne f ′ : E →C by f ′(e) = (Re f)′(e) −i(Re f)′(ie) and note
that f is complex linear and f ′|F = f.
To show that |f ′(e)| ≤∥e∥for all e ∈E, write f ′(e) = |f ′(e)| exp(iθ), so complex linearity of f ′ implies
f ′(e · exp(−iθ)) ∈R, and hence
|f ′(e)| = f ′(e · exp(−iθ)) = (Re f)′(e · exp(−iθ)) ≤∥e · exp(−iθ)∥= ∥e∥.
■

2.2 Linear and Multilinear Mappings
59
2.2.13 Corollary.
Let (E, ∥· ∥) be a normed space, F ⊂E a subspace, and f ∈F∗(the topological dual).
Then there exists f ′ ∈E∗such that f ′|F = f and ∥f ′∥= ∥f∥.
Proof.
We can assume f ̸= 0. Then |||e||| = ∥f∥∥e∥is a norm on E and |f(e)| ≤∥f∥∥e∥= |||e||| for
all e ∈F . Applying the preceding theorem we get a linear map f ′ : E →R (or C) with the properties
f ′|F = f and |f ′(e)| ≤|||e||| for all e ∈E. This says that ∥f ′∥≤∥f∥, and since f ′ extends f, it follows that
∥f∥≤∥f ′∥; that is, ∥f ′∥= ∥f∥and f ′ ∈E∗.
■
Applying the corollary to the linear function ae →a, for e ∈E a ﬁxed element, we get the following.
2.2.14 Corollary.
Let E be a normed vector space and e ̸= 0. Then there exists f ∈E∗such that f(e) ̸= 0.
In other words if f(e) = 0 for all f ∈E∗, then e = 0; that is, E∗separates points of E.
Open Mapping Theorem.
This result states that surjective linear maps are open.
2.2.15 Theorem (Open Mapping Theorem of Banach–Schauder).
Let E and F be Banach spaces and
suppose A ∈L(E, F) is onto. Then A is an open mapping.
Proof.
To show A is an open mapping, it suﬃces to prove that the set A(cl(D1(0))) contains a disk
centered at zero in F. Let r > 0. Since
E =

n≥1
Dnr(0),
it follows that
F =

n≥1
(A(Dnr(0)))
and hence

n≥1
cl(A(Dnr(0))) = F.
Completeness of F implies that at least one of the sets cl(A(Dnr(0))) has a nonempty interior by the Baire
category theorem 1.7.3. Because the mapping e ∈E →ne ∈E is a homeomorphism, we conclude that
cl(A(Dr(0))) contains some open set V ⊂F. We shall prove that the origin of F is in int{cl[A(Dr(0))]} for
some r > 0. Continuity of (e1, e2) ∈E × E →e1 −e2 ∈E assures the existence of an open set U ⊂E such
that
U −U = { e1 −e2 | e1, e2 ∈U } ⊂Dr(0).
Choose r > 0 such that Dr(0) ⊂U. Then
cl(A(Dr(0))) ⊃cl(A(U) −A(U)) ⊃cl(A(U)) −cl(A(U)) ⊃V −V.
But
V −V =

e∈V
(V −e)
is open and clearly contains 0 ∈F. It follows that there exists a disk Dt(0) ⊂F such that Dt(0) ⊂
cl(A(Dr(0))).
Now let ε(n) = 1/2n+1, n = 0, 1, 2, . . . , so that 1 = 
n≥0 ε(n). By the foregoing result for each n there
exists an η(n) > 0 such that Dη(n)(0) ⊂cl(A(Dε(n)(0))). Clearly η(n) →0. We shall prove that Dη(0) ⊂
A(cl(D1(0))). For v ∈Dη(0)(0) ⊂cl(A(Dε(0)(0))) there exists e0 ∈Dε(0)(0) such that ∥v −Ae0∥< η(1)
and thus v −Ae0 ∈cl(A(Dε(1)(0))), so there exists e1 ∈Dε(1)(0) such that ∥v −Ae0 −Ae1∥< η(2), etc.

60
2. Banach Spaces and Diﬀerential Calculus
Inductively one constructs a sequence en ∈Dη(n) such that ∥v −Ae0 −· · · −Aen∥< η(n + 1). The series

n≥0 en is convergent because

m

i=n+1
ei
 ≤
m

i=n+1
1
2i+1 ,
∞

n=0
1
2n+1 = 1,
and E is complete. Let e = 
n≥0 en ∈E. Thus,
Ae =
∞

n=0
Aen = v,
and
∥e∥≤
∞

n=0
∥en∥≤
∞

n=0
1
2n+1 = 1;
that is, v ∈Dη(0)(0) implies v = Ae, ∥e∥≤1. Therefore,
Dη(0)(0) ⊂A(cl(D1(0))).
■
An important consequence is the following.
2.2.16 Theorem (Banach’s Isomorphism Theorem).
A continuous linear isomorphism of Banach spaces
is a homeomorphism.
Thus, if F and G are closed subspaces of the Banach space E and E is the algebraic direct sum of F and G,
then the mapping (e, e′) ∈F × G →e + e′ ∈E is a continuous isomorphism, and hence a homeomorphism;
that is, E = F ⊕G; this proves the comment at the beginning of Supplement 2.1B.
Closed Graph Theorem.
This result characterizes continuity by closedness of the graph of a linear map.
2.2.17 Theorem (Closed Graph Theorem).
Suppose that E and F are Banach spaces. A linear map A :
E →F is continuous iﬀits graph
ΓA = { (e, Ae) ∈E × F | e ∈E }
is a closed subspace of E ⊕F.
Proof.
It is readily veriﬁed that ΓA is a linear subspace of E ⊕F. If A ∈L(E, F), then ΓA is closed
(see Exercise 1.4-2). Conversely, if ΓA is closed, then it is a Banach subspace of E ⊕F, and since the
mapping (e, Ae) ∈ΓA →e ∈E is a continuous isomorphism, its inverse e ∈E →(e, Ae) ∈ΓA is also
continuous by Theorem 2.2.16. Since (e, Ae) ∈ΓA →Ae ∈F is clearly continuous, so is the composition
e →(e, Ae) →Ae.
■
The Closed graph theorem is often used in the following way. To show that a linear map A : E →F is
continuous for E and F Banach spaces, it suﬃces to show that if en →0 and Aen →e′, then e′ = 0.
2.2.18 Corollary.
Let E be a Banach space and F a closed subspace of E. Then F is split iﬀthere exists
P ∈L(E, E) such that P ◦P = P and F = { e ∈E | Pe = e }.
Proof.
If such a P exists, then clearly ker(P) is a closed subspace of E that is an algebraic complement
of F; any e ∈E is of the form e = e −Pe + Pe with e −Pe ∈ker(P) and Pe ∈F.
Conversely, if E = F ⊕G, deﬁne P : E →E by P(e) = e1, where e = e1 + e2, e1 ∈F, e2 ∈G. P is
clearly linear, P 2 = P, and F = { e ∈E | Pe = e }, so all there is to show is that P is continuous. Let
en = e1n + e2n →0 and P(en) = e1n →e′; that is, −e2n →e′, and since F and G are closed this implies
that e′ ∈F ∩G = {0}. By the closed graph theorem, P ∈L(E, E).
■

2.2 Linear and Multilinear Mappings
61
2.2.19 Theorem (Fundamental Isomorphism Theorem).
Let A ∈L(E,
F) be surjective where E and F are Banach spaces. Then E/ ker A and F are isomorphic Banach spaces.
Proof.
The map [e] →Ae is bijective and continuous (since its norm is ≤∥A∥), so it is a homeomorphism.
■
A sequence of maps
· · · →Ei−1
Ai
→Ei
Ai+1
→Ei+1 →· · ·
of Banach spaces is said to be split exact if for all i, ker Ai+1 = range Ai and both ker Ai and range Ai split.
With this terminology, Theorem 2.2.19 can be reformulated in the following way: If 0 →G →E →F →0
is a split exact sequence of Banach spaces, then E/G is a Banach space isomorphic to F (thus F ∼= G⊕F).
Uniform Boundedness Principle.
Next we prove the uniform boundedness principle of Banach
and Steinhaus, the third pillar of linear analysis.
2.2.20 Theorem.
Let E and F be normed vector spaces, with E complete, and let {Ai}i∈I ⊂L(E, F). If
for each e ∈E the set {∥Aie∥}i∈I is bounded in F, then {∥Ai∥}i∈I is a bounded set of real numbers.
Proof.
Let ϕ(e) = sup{ ∥Aie∥| i ∈I } and note that
Sn = { e ∈E | ϕ(e) ≤n } =

i∈I
{ e ∈E | ∥Aie∥≤n }
is closed and 
n≥1 Sn = E. Since E is a complete metric space, the Baire category theorem 1.7.3 says
that some Sn has nonempty interior; that is, there exist r > 0 and e0 ∈E such that ϕ(e) ≤M, for all
e ∈cl(Dr(e0)), where M > 0 is come constant.
For each i ∈I and ∥e∥= 1, we have ∥Ai(re + e0)∥≤ϕ(re + e0) ≤M, so that
∥Aie∥=1
r ∥Ai(re + e0 −e0)∥≤1
r ∥Ai(re + e0)∥+ 1
r ∥Aie0∥
≤1
r (M + ϕ(e0)),
that is, ∥Ai∥≤(M + ϕ(e0))/r for all i ∈I.
■
2.2.21 Corollary.
If {An} ⊂L(E, F) is a strongly convergent sequence (i.e., limn→∞Ane = Ae exists
for every e ∈E), then A ∈L(E, F).
Proof.
A is clearly a linear map. Since {Ane} is convergent, it is a bounded set for each e ∈E, so that by
Theorem 2.2.20, {∥An∥} is bounded by, say, M > 0. But then
∥Ae∥= lim
n→∞∥Ane∥≤lim
n→∞sup ∥An∥∥e∥≤M∥e∥;
that is, A ∈L(E, F).
■
Exercises
⋄2.2-1.
If E = Rn and F = Rm with the standard norms, and A : E →F is a linear map, show that
(i) ∥A∥is the square root of the absolute value of the largest eigenvalue of AAT , where AT is the transpose
of A, and

62
2. Banach Spaces and Diﬀerential Calculus
(ii) if n, m ≥2, this norm does not come from an inner product.
Hint: Use Exercise 2.1-1.
⋄2.2-2.
Let E = F = Rn with the standard norms and A, B ∈L(E, F). Let ⟨A, B⟩= trace(ABT ). Show
that this is an inner product on L(E, F).
⋄2.2-3.
Show that the map
L(E, F) × L(F, E) →R;
(A, B) →trace(AB)
gives a (natural) isomorphism L(E, F)∗∼= L(F, E).
⋄2.2-4.
Let E, F, G be Banach spaces and D ⊂E a linear subspace. A linear map A : D →F is called
closed if its graph ΓA, the set of (x, Ax) where x ∈D is a closed subset of E × F. If A : D ⊂E →F,
and B : D ⊂E →G are two closed operators with the same domain D, show that there are constants
M1, M2 > 0 such that
∥Ae∥≤M1(∥Be∥+ ∥e∥)
and
∥Be∥≤M2(∥Ae∥+ ∥e∥)
for all e ∈E.
Hint: Norm E ⊕G by ∥(e, g)∥= ∥e∥+ ∥g∥and deﬁne T : ΓB →G by T(e, Be) = Ae. Use the closed graph
theorem to show that T ∈L(ΓB, G).
⋄2.2-5 (Linear transversality).
Let E, F be Banach spaces, F0 ⊂F a closed subspace, and T ∈L(E, F). T
is said to be transversal to F0, if T −1(F0) splits in E and T(E) + F0 = { Te + f | e ∈E, f ∈F } = F.
Prove the following.
(i) T is transversal to F0 iﬀπ ◦T ∈L(E, F/F0) is surjective with split kernel; here π : F →F/F0 is the
projection.
(ii) If π ◦T ∈L(E, F/F0) is surjective and F0 has ﬁnite codimension, then ker(π ◦T) has the same
codimension and T is transversal to F0.
Hint: Use the algebraic isomorphism T(E)/(F0 ∩T(E)) ∼= (T(E) + F0)/F0 to show E/ ker(π ◦T) ∼=
F/F0; now use Corollary 2.2.18.
(iii) If π ◦T ∈L(E, F/F0) is surjective and if ker T and F0 are ﬁnite dimensional, then ker(π ◦T) is ﬁnite
dimensional and T is transversal to F0.
Hint: Use the exact sequence 0 →ker T →ker(π ◦T) →F0 ∩T(E) →0.
⋄2.2-6.
Let E and F be Banach spaces. Prove the following.
(i) If f ∈cl(S([a, b], L(E, F))) and e ∈E, then
	 b
a
f(t)e dt =

	 b
a
f(t) dt

(e)
Hint: T →Te is in L(L(E, F), F).
(ii) If f ∈cl(S([a, b], R) and v ∈F, then
	 b
a
f(t)v dt =

	 b
a
f(t) dt

(v)
Hint: t →multiplication by t in F is in L(R, L(F, F)); apply (i).

2.2 Linear and Multilinear Mappings
63
(iii) Let X be a topological space and f : [a, b] × X →E be continuous. Then the mapping
g : X →E,
g(x) =
	 b
a
f(t, x)dt
is continuous.
Hint: For t ∈R, x′ ∈X and ε > 0 given,
∥f(s, x) −f(t, x′)∥< ε
if (s, x) ∈U1 × Ux′,t;
use compactness of [a, b] to ﬁnd Ux′ as a ﬁnite intersection and such that ∥f(t, x) −f(t, x′)∥< ε for
all t ∈[a, b], x ∈Ux′.
⋄2.2-7.
Show that the Banach isomorphism theorem is false for normed incomplete vector spaces in the
following way. Let E be the space of all polynomials over R normed as follows:
∥a0 + a1 x + · · · + anxn∥= max{|a0|, . . . , |an|}.
(i) Show that E is not complete.
(ii) Deﬁne A : E →E by
A

 n

i=0
aixi

= a0 +
n

i=1
ai
i xi
and show that A ∈L(E, E). Prove that A−1 : E →E exists.
(iii) Show that A−1 is not continuous.
⋄2.2-8.
Let E and F be Banach spaces and A ∈L(E, F). If A(E) has ﬁnite codimension, show that it is
closed.
Hint: If F0 is an algebraic complement to A(E) in F, show there is a continuous linear isomorphism
E/ ker A ∼= F/F0; compose its inverse with E/ ker A →A(E).
⋄2.2-9 (Symmetrization operator).
Deﬁne
Symk : Lk(E, F) →Lk(E, F),
by
Symk A = 1
k!

a∈Sk
σA,
where (σA)(e1, . . . , ek) = A(eσ(1), . . . , eσ(k)). Show that:
(i) Symk(Lk(E, F)) = Lk
s(E, F).
(ii) (Symk)2 = Symk.
(iii) ∥Symk ∥≤1.
(iv) If F is Banach, then Lk
s(E, F) splits in Lk(E, F).
Hint: Use Corollary 2.2.18.
(v) (Symk A)′ = A′.

64
2. Banach Spaces and Diﬀerential Calculus
⋄2.2-10.
Show that a k-multilinear map continuous in each argument separately is continuous.
Hint: For k = 2: If ∥e1∥≤1, then ∥A(e1, e2)∥≤∥A(·, e2)∥, which by the uniform boundedness principle
implies the inequality ∥A(e1, ·)∥≤M for ∥e1∥≤1.
⋄2.2-11.
(i) Prove the Mazur-Ulam Theorem following the steps below (see Mazur and Ulam [1932],
Banach [1932, p. 166]): Every isometric surjective mapping ϕ : E →F such that ϕ(0) = 0 is a linear
map. Here E and F are normed vector spaces; ϕ being isometric means that ∥ϕ(x)−ϕ(y)∥= ∥x−y∥
for all x, y ∈E.
(a) Fix x1, x2 ∈E and deﬁne
H1 =

x
 ∥x −x1∥= ∥x −x2∥= 1
2 ∥x1 −x2∥

,
Hn =

x ∈Hn−1
 ∥x −z∥≤1
2 diam(Hn−1), z ∈Hn−1

.
Show that
diam(Hn) ≤
1
2n−1 diam(H1) ≤
1
2n−1 ∥x1 −x2∥.
Conclude that if 
n≥1 Hn ̸= ∅, then it consists of one point only.
(b) Show by induction that if x ∈Hn, then x1 + x2 −x ∈Hn.
(c) Show that (x1 + x2)/2 = 
n≥1 Hn.
Hint: Show inductively that (x1 + x2)/2 ∈Hn using (b).
(d) From (c) deduce that
ϕ
1
2(x1 + x2)

= 1
2(ϕ(x1) + ϕ(x2)).
Use ϕ(0) = 0 to conclude that ϕ is linear.
(ii) (Chernoﬀ, 1970). The goal of this exercise is to study the Mazur–Ulam theorem, dropping the assump-
tion that ϕ is onto, and replacing it with the assumption that ϕ is homogeneous: ϕ(tx) = tϕ(x) for all
t ∈R and x ∈E.
(a) A normed vector space is called strictly convex if equality holds in the triangle inequality only
for colinear points. Show that if F is strictly convex, then ϕ is linear.
Hint:
∥ϕ(x) −ϕ(y)∥=
ϕ(x) −ϕ
x + y
2
 +
ϕ(y) −ϕ
x + y
2

and
ϕ(x) −ϕ
x + y
2
 =
ϕ(y) −ϕ
x + y
2
 .
Show that
ϕ
x + y
2

= 1
2(ϕ(x) + ϕ(y)).

2.2 Linear and Multilinear Mappings
65
(b) Show that, in general, the assumption on ϕ being onto is necessary by considering the following
counterexample. Let E = R2 and F = R3, both with the max norm. Deﬁne ϕ : E →F by
ϕ(a, b) = (a, b,
√
ab),
a, b > 0;
ϕ(−a, b) = (−a, b, −
√
ab),
a, b > 0;
ϕ(a, −b) = (a, −b, −
√
ab),
a, b > 0;
ϕ(−a, b) = (−a, −b, −
√
ab),
a, b > 0.
Show that ϕ is not linear, ϕ is homogeneous, ϕ is an isometry, and ϕ(0, 0) = (0, 0, 0).
Hint: Prove the inequality
|αβ −γδ| ≤max(|α2 −γ2|, |β2 −δ2|).
⋄2.2-12.
Let E be a complex n-dimensional vector space.
(i) Show that the set of all operators A ∈L(E, E) which have n distinct eigenvalues is open and dense in
E.
Hint: Let p be the characteristic polynomial of A, that is, p(λ) = det (A −λI), and let µ1, . . . , µn−1
be the roots of p′. Then A has multiple eigenvalues iﬀp(µ1) · · · p(µn−1) = 0. The last expression is a
symmetric polynomial in µ1, . . . , µn−1, and so is a polynomial in the coeﬃcients of p′ and therefore is
a polynomial q in the entries of the matrix of A in a basis. Show that q−1(0) is the set of complex n×n
matrices which have multiple eigenvalues; q−1(0) has open dense complement by Exercise 1.1-12.
(ii) Prove the Cayley–Hamilton Theorem: If p is the characteristic polynomial of A ∈L(E, E), then
p(A) = 0 .
Hint: If the eigenvalues of A are distinct, show that the matrix of A in the basis of eigenvectors
e1, . . . , en is diagonal. Apply A, A2, . . . , An−1. Then show that for any polynomial q the matrix of
q(A) in the same basis is diagonal with entries q(λi), where λi are the eigenvalues of A. Finally, let
q = p. If A is general, apply (i).
⋄2.2-13.
Let E be a normed real (resp. complex) vector space.
(i) Show that λ : E →R (resp., C) is continuous if and only if ker λ is closed.
Hint: Let e ∈E satisfy λ(e) = 1 and choose a disk D of radius r centered at e such that D∩(e+ker λ) =
∅. Then λ(x) ̸= 1 for all x ∈D. Show that if x ∈D then λ(x) < 1. If not, let α = λ(x), |α| > 1. Then
∥x/α∥< r and λ(x/α) = 1.
(ii) Show that if F is a closed subspace of E and G is a ﬁnite dimensional subspace, then G + F is closed.
Hint: Assume G is one dimensional and generated by g. Write any x ∈G + F as x = λ(x)g + f and
use (i) to show λ is continuous on G + F.
⋄2.2-14.
Let F be a Banach space.
(i) Show that if E is a ﬁnite dimensional subspace of F, then E is split.
Hint: Deﬁne P : F →F by
P(x) =

i=1,...,n
ei(x)ei,
where {e1, . . . , en} is a basis of E and {e1, . . . , en} is a dual basis, that is, ei(ej) = δij. Then use
Corollary 2.2.18.
(ii) Show that if E is closed and ﬁnite codimensional, then it is split.

66
2. Banach Spaces and Diﬀerential Calculus
(iii) Show that if E is closed and contains a ﬁnite-codimensional subspace G of F, then it is split.
(iv) Let λ : F →R be a linear discontinuous map and let E = ker λ. Show that the codimension of E is 1
and that E is not closed. Thus ﬁnite codimensional subspaces of F are not necessarily closed. Compare
this with (i) and (ii), and with Exercise 2.2-8.
⋄2.2-15.
Let E and F be Banach spaces and T ∈L(E, F). Deﬁne T ∗: F∗→E∗by ⟨T ∗β, e⟩= ⟨β, Te⟩for
e ∈E, β ∈F∗. Show that:
(i) T ∗∈L(F∗, E∗) and T ∗∗|E = T.
(ii) ker T ∗= T(E)o := { β ∈F∗| ⟨β, Te⟩= 0 for all e ∈E } and ker T = (T ∗(F∗))o := { e ∈E | ⟨T ∗β, e⟩=
0 for all β ∈F∗}.
(iii) If T(E) is closed, then T ∗(F∗) = (ker T)o.
Hint: The induced map E/ ker T →T(E) is a Banach space isomorphism; let S be its inverse. If
λ ∈(ker T)o, deﬁne the element µ ∈(E/ ker T)∗by µ([e]) = λ(e). Let ν ∈F∗denote the extension of
S∗(µ) ∈(T(E))∗to ν ∈F∗with the same norm and show that T ∗(ν) = λ.
(iv) If T(E) is closed, then ker T ∗is isomorphic to (F/T(E))∗and (ker T)∗is isomorphic to E∗/T ∗(F∗).
2.3
The Derivative
Deﬁnition of the Derivative.
For a diﬀerentiable function f : U ⊂R →R, the usual interpretation of
the derivative at a point u0 ∈U is the slope of the line tangent to the graph of f at u0. To generalize this,
we interpret Df(u0) = f ′(u0) as a linear map acting on the vector (u −u0).
2.3.1 Deﬁnition.
Let E, F be normed vector spaces, U be an open subset of E and let f : U ⊂E →F a
given maping. Let u0 ∈U. We say that f is diﬀerentiable at the point u0 provided there is a bounded linear
map Df(u0) : E →F such that for every ϵ > 0, there is an δ > 0 such that whenever 0 < ∥u −u0∥< δ, we
have
∥f(u) −f(u0) −Df(u0) · (u −u0)∥
∥u −u0∥
< ϵ,
where ∥· ∥represents the norm on the appropriate space and where the evaluation of Df(u0) on e ∈E is
denoted Df(u0) · e.
This deﬁnition can also be written as
lim
u→u0
f(u) −f(u0) −Df(u0) · (u −u0)
∥u −u0∥
= 0.
We shall shortly show that the derivative is unique if it exists and embark on relating this notion to
ones that are perhaps more familiar to the reader in Euclidean space; we shall also develop many familiar
properties of the derivative. However, it is useful to rephrase the deﬁnition slightly ﬁrst. We shall do this in
terms of the notion of tangency.
Tangency of Maps.
An alternative way to think of the derivative in one variable calculus it to say that
Df(u0) is the unique linear map from R into R such that the mapping g : U →R given by
u →g(u) = f(u0) + Df(u0) · (u −u0)
is tangent to f at u0, as in Figure 2.3.1.

2.3 The Derivative
67
f
g
u0
U
R
R
Figure 2.3.1. Derivative of a function of one variable
2.3.2 Deﬁnition.
Let E, F be normed vector spaces, with maps f, g : U ⊂E →F where U is open in E.
We say f and g are tangent at the point u0 ∈U if f(u0) = g(u0) and
lim
u→u0
∥f(u) −g(u)∥
∥u −u0∥
= 0,
where ∥· ∥represents the norm on the appropriate space.
2.3.3 Proposition.
For f : U ⊂E →F and u0 ∈U there is at most one L ∈L(E, F) such that the map
gL : U ⊂E →F given by gL(u) = f(u0) + L(u −u0) is tangent to f at u0.
Proof.
Let L1 and L2 ∈L(E, F) satisfy the conditions of the proposition. If e ∈E, ∥e∥= 1, and u = u0+λe
for λ ∈R (or C), then for λ ̸= 0, small u ∈U, and we have
∥L1e −L2e∥= ∥L1(u −u0) −L2(u −u0)∥
∥u −u0∥
≤∥f(u) −f(u0) −L1(u −u0)∥
∥u −u0∥
+∥f(u) −f(u0) −L2(u −u0)∥
∥u −u0∥
.
As λ →0, the right hand side approaches zero so that ∥(L1 −L2)e∥= 0 for all e ∈E satisfying ∥e∥= 1;
therefore, ∥L1 −L2∥= 0 and thus L1 = L2.
■
We can thus rephrase the deﬁnition of the derivative this way: If, in Proposition 2.3.3, there is such an
L ∈L(E, F), then f is diﬀerentiable at u0, and the derivative of f at u0 is Df(u0) = L. Thus, the derivative,
if it exists, is unique.
2.3.4 Deﬁnition.
If f is diﬀerentiable at each u0 ∈U, the map
Df : U →L(E, F);
u →Df(u)
is called the derivative of f. Moreover, if Df is a continuous map (where L(E, F) has the norm topology),
we say f is of class C1 (or is continuously diﬀerentiable). Proceeding inductively we deﬁne
Drf := D(Dr−1f) : U ⊂E →Lr(E, F)
if it exists, where we have identiﬁed L(E, Lr−1(E, F)) with Lr(E, F) (see Proposition 2.2.9). If Drf exists
and is norm continuous, we say f is of class Cr.

68
2. Banach Spaces and Diﬀerential Calculus
Basic Properties of the Derivative.
We shall reformulate the deﬁnition of the derivative with the aid
of the somewhat imprecise but very convenient Landau symbol : o(ek) will denote a continuous function
of e deﬁned in a neighborhood of the origin of a normed vector space E, satisfying lime→0(o(ek)/∥e∥k) = 0.
The collection of these functions forms a vector space. Clearly f : U ⊂E →F is diﬀerentiable at u0 ∈U iﬀ
there exists a linear map Df(u0) ∈L(E, F) such that
f(u0 + e) = f(u0) + Df(u0) · e + o(e).
Let us use this notation to show that if Df(u0) exists, then f is continuous at u0:
lim
e→0 f(u0 + e) = lim
e→0(f(u0) + Df(u0) · e + o(e)) = f(u0).
2.3.5 Proposition (Linearity of the Derivative).
Let f, g : U ⊂E →F be r times diﬀerentiable mappings
and a a real (or complex) constant. Then af and f + g : U ⊂E →F are r times diﬀerentiable with
Dr(f + g) = Drf + Drg
and
Dr(af) = aDrf.
Proof.
If u ∈U and e ∈E, then
f(u + e) = f(u) + Df(u) · e + o(e) and
g(u + e) = g(u) + Dg(u) · e + o(e),
so that adding these two relations yields
(f + g)(u + e) = (f + g)(u) + (Df(u) + Dg(u)) · e + o(e).
The case r > 1 follows by induction. Similarly,
af(u + e) = af(u) + aDf(u) · e + ao(e) = af(u) + aDf(u) · e + o(e).
■
2.3.6 Proposition (Derivative of a Cartesian Product).
Let fi : U ⊂E →Fi, 1 ≤i ≤n, be a collection
of r times diﬀerentiable mappings. Then f = f1 × · · · × fn : U ⊂E →F1 × · · · × Fn deﬁned by f(u) =
(f1(u), . . . , fn(u)) is r times diﬀerentiable and
Drf = Drf1 × · · · × Drfn.
Proof.
For u ∈U and e ∈E, we have
f(u + e) = (f1(u + e), . . . , fn(u + e))
= (f1(u) + Df1(u) · e + o(e), . . . , fn(u) + Dfn(u) · e + o(e))
= (f1(u), . . . , fn(u)) + (Df1(u), . . . , Dfn(u)) · e
+(o(e), . . . , o(e))
= f(u) + Df(u) · e + o(e),
the last equality follows using the sum norm in F1 × · · · × Fn:
∥(o(e), . . . , o(e))∥= ∥o(e)∥+ · · · + ∥o(e)∥,
so (o(e), . . . , o(e)) = o(e).
■
Notice from the deﬁnition that for L ∈L(E, F), DL(u) = L for any u ∈E. It is also clear that the
derivative of a constant map is zero.
Usually all our spaces will be real and linearity will mean real-linearity. In the complex case, diﬀerentiable
mappings are the subject of analytic function theory, a subject we shall not pursue in this book (see Exercise
2.3-6 for a hint of why there is a relationship with analytic function theory).

2.3 The Derivative
69
Jacobian Matrices.
In addition to the foregoing approach, there is a more traditional way to diﬀerentiate
a function f : U ⊂Rn →Rm. We write out f in component form using the following notation:
f(x1, . . . , xn) = (f 1(x1, . . . , xn), . . . , f m(x1, . . . , xn))
and compute partial derivatives, ∂f j/∂xi for j = 1, . . . , m and i = 1, . . . , n, where the symbol ∂f j/∂xi
means that we compute the usual derivative of f j with respect to xi while keeping the other variables
x1, . . . , xi−1, xi+1, . . . , xn
ﬁxed.
For f : R →R, Df(x) is just the linear map “multiplication by df/dx,” that is, df/dx = Df(x) · 1. This
fact, which is obvious from the deﬁnitions, can be generalized to the following theorem.
2.3.7 Proposition.
Suppose that U ⊂Rn is an open set and that f : U →Rm is diﬀerentiable. Then the
partial derivatives ∂f j/∂xi exist, and the matrix of the linear map Df(x) with respect to the standard bases
in Rn and Rm is given by


∂f 1
∂x1
∂f 1
∂x2
· · ·
∂f 1
∂xn
∂f 2
∂x1
∂f 2
∂x2
· · ·
∂f 2
∂xn
...
...
...
∂f m
∂x1
∂f m
∂x2
· · ·
∂f m
∂xn


,
where each partial derivative is evaluated at x = (x1, . . . , xn). This matrix is called the Jacobian matrix
of f.
Proof.
By the usual deﬁnition of the matrix of a linear mapping from linear algebra, the (j, i)th matrix
element aj
i of Df(x) is given by the jth component of the vector Df(x)·ei, where e1, . . . , en is the standard
basis of Rn. Letting y = x + hei, we see that
∥f(y) −f(x) −Df(x)(y −x)∥
∥y −x∥
= 1
|h|
f(x1, . . . , xi + h, . . . , xn) −f(x1, . . . , xn) −hDf(x)ei

approaches zero as h →0, so the jth component of the numerator does as well; that is,
lim
h→0
1
|h|
f j(x1, . . . , xi + h, . . . , xn) −f j(x1, . . . , xn) −haj
i
 = 0,
which means that aj
i = ∂f j/∂xi.
■
In computations one can usually compute the Jacobian matrix easily, and this proposition then gives Df.
In some books, Df is called the diﬀerential or the total derivative of f.
2.3.8 Example.
Let f : R2 →R3, f(x, y) = (x2, x3y, x4y2). Then Df(x, y) is the linear map whose
matrix in the standard basis is


∂f 1
∂x
∂f 1
∂y
∂f 2
∂x
∂f 2
∂y
∂f 3
∂x
∂f 3
∂y


=


2x
0
3x2y
x3
4x3y2
2x4y

,

70
2. Banach Spaces and Diﬀerential Calculus
where f 1(x, y) = x2, f 2(x, y) = x3y, f 3(x, y) = x4y2.
♦
One should take special note when m = 1, in which case we have a real–valued function of n variables.
Then Df has the matrix
 ∂f
∂x1 · · · ∂f
∂xn

and the derivative applied to a vector e = (a1, . . . , an) is
Df(x) · e =
n

i=1
∂f
∂xi ai.
The Gradient and Diﬀerential.
It should be emphasized that Df assigns a linear mapping to each
x ∈U and the deﬁnition of Df(x) is independent of the basis used. If we change the basis from the standard
basis to another one, the matrix elements will of course change. If one examines the deﬁnition of the matrix
of a linear transformation, it can be seen that the columns of the matrix relative to the new basis will be
the derivative Df(x) applied to the new basis in Rn with this image vector expressed in the new basis in
Rm. Of course, the linear map Df(x) itself does not change from basis to basis. In the case m = 1, Df(x)
is, in the standard basis, a 1 × n matrix. The vector whose components are the same as those of Df(x) is
called the gradient of f, and is denoted grad f or ∇f. Thus for f : U ⊂Rn →R,
grad f =
 ∂f
∂x1 , · · · , ∂f
∂xn

(Sometimes it is said that grad f is just Df with commas inserted!) The formation of gradients makes sense
in a general inner product space as follows.
2.3.9 Deﬁnition.
(i)
Let E be a normed space and f : U ⊂E →R be diﬀerentiable so that Df(u) ∈
L(E, R) = E∗. In this case we sometimes write df(u) for Df(u) and call df the diﬀerential of f.
Thus df : U →E∗.
(ii)
If E is a Hilbert space, the gradient of f is the map
grad f = ∇f : U →E
deﬁned by ⟨∇f(u), e⟩= df(u) · e,
where df(u) · e means the linear map df(u) applied to the vector e.
Note that the existence of ∇f(u) requires the Riesz representation theorem (see Theorem 2.2.5). The
notation δf/δu instead of (grad f)(u) = ∇f(u) is also in wide use, especially in the case in which E is a
space of functions. See Supplement 2.4C below.
2.3.10 Example.
Let (E, ⟨, ⟩) be a real inner product space and let f(u) = ∥u∥2. Since ∥u∥2 = ∥u0∥2 +
2 ⟨u0, u −u0⟩+ ∥u −u0∥2, we obtain df(u0) · e = 2 ⟨u0, e⟩and thus ∇f(u) = 2u. Hence f is of class C1. But
since Df(u) = 2 ⟨u, ·⟩∈E∗is a continuous linear map in u ∈E, it follows that D2f(u) = Df ∈L(E, E∗)
and thus Dkf = 0 for k ≥3. Thus f is of class C∞. The mapping f considered here is a special case of a
polynomial mapping (see Deﬁnition 2.2.10).
♦
Fundamental Theorem.
We close this section with the fundamental theorem of calculus in real Banach
spaces. First a bit of notation. If ϕ : U ⊂R →F is diﬀerentiable, then Dϕ(t) ∈L(R, F). The space L(R, F)
is isomorphic to F by A →A(1), 1 ∈R; note that ∥A∥= ∥A(1)∥. We denote
ϕ′ = dϕ
dt = Dϕ(t) · 1,
1 ∈R
ϕ′(t) = lim
h→0
ϕ(t + h) −ϕ(t)
h
and ϕ is diﬀerentiable iﬀϕ′ exists.

2.3 The Derivative
71
2.3.11 Theorem (Fundamental Theorem of Calculus).
(i)
If g : [a, b] →F is continuous, where F is a real normed space, then the map
f : ]a, b[ →F
deﬁned by f(t) =
	 t
a
g(s) ds
is diﬀerentiable and we have f ′ = g.
(ii)
If f : [a, b] →F is continuous, is diﬀerentiable on ]a, b[ and f ′ extends to a continuous map on [a, b],
then
f(b) −f(a) =
	 b
a
f ′(s) ds.
Proof.
(i)
Let t0 ∈]a, b[. Since the integral is linear and continuous,
∥f(t0 + h) −f(t0) −hg(t0)∥=

	 t0+h
t0
(g(s) −g(t0))ds
 ≤|h|Lg,h,
where Lg,h = sup{ ∥g(s) −g(t0)∥| t0 ≤s ≤t0 + h }. However, Lg,h →0 as |h| →0 by continuity of g
at t0.
(ii)
Let the function h(t) be deﬁned by
h(t) =
	 t
a
f ′(s) ds

−f(t),
By (i), h′(t) = 0 on ]a, b[ and h is continuous on [a, b]. If for some t ∈[a, b], h(t) ̸= h(a), then by
the Hahn–Banach theorem there exists α ∈F∗such that (α ◦h)(t) ̸= (α ◦h)(a). Moreover, α ◦h is
diﬀerentiable on ]a, b[ and its derivative is zero (Exercise 2.3-4). Thus by elementary calculus, α ◦h is
constant on [a, b], a contradiction. Hence h(t) = h(a) for all t ∈[a, b]. In particular, h(a) = h(b).
■
Exercises
⋄2.3-1.
Let B : E × F →G be a continuous bilinear map of normed spaces. Show that B is C∞and that
DB(u, v)(e, f) = B(u, f) + B(e, v).
⋄2.3-2.
Show that the derivative of a map is unaltered if the spaces are renormed with equivalent norms.
⋄2.3-3.
If f ∈Sk(E, F), show that for, i = 1, . . . , k,
Dkf(0)(e1, . . . , ek) =
∂k
∂t1 · · · ∂tk
f(t1e1 + · · · + tkek)

ti=0
and
Dif(0) = 0
for i = 1, . . . , k −1.
⋄2.3-4.
Let f : U ⊂E →F be a diﬀerentiable (resp., Cr) map and A ∈L(F, G). Show that A ◦f : U ⊂
E →G is diﬀerentiable (resp., Cr) and Dr(A ◦f)(u) = A ◦Drf(u).
Hint: Use induction.

72
2. Banach Spaces and Diﬀerential Calculus
⋄2.3-5.
Let f : U ⊂E →F be r times diﬀerentiable and A ∈L(G, E). Show that
Di(f ◦A)(v) · (g1, . . . , gi) = Dif(Av) · (Ag1, . . . , Agi)
exists for all i ≤r, where v ∈A−1(U), and g1, . . . , gi ∈G. Generalize to the case where A is an aﬃne map.
⋄2.3-6.
(i)
Show that a complex linear map A ∈L(C, C) is necessarily of the form A(z) = λz, for some
λ ∈C.
(ii)
Show that the matrix of A ∈L(C, C), when A is regarded as a real linear map in L(R2, R2), is of the
form

a
−b
b
a

.
Hint: λ = a + ib.
(iii)
Show that a map f : U ⊂C →C, f = g + ih, g, h : U ⊂R2 →R is complex diﬀerentiable iﬀthe
Cauchy–Riemann equations
∂g
∂x = ∂h
∂y
,
∂g
∂y = −∂h
∂x
are satisﬁed.
Hint: Use (ii) and Proposition 2.3.7.
⋄2.3-7.
Let (E, ⟨, ⟩) be a complex inner product space. Show that the map f(u) = ∥u∥2 is not diﬀerentiable.
Contrast this with Example 2.3.10.
Hint: Df(u), if it exists, should equal 2 Re(⟨u, ·⟩).
⋄2.3-8.
Show that the matrix of D2f(x) ∈L2(Rn, R) for f : U ⊂Rn →R, is given by


∂2f
∂x1∂x1
∂2f
∂x1∂x2
· · ·
∂2f
∂x1∂xn
...
...
...
∂2f
∂xn∂x1
∂2f
∂xn∂x2
· · ·
∂2f
∂xn∂xn


.
Hint: Apply Proposition 2.3.7. Recall that the matrix of a bilinear mapping B ∈L(Rn, Rm; R) has the
entries B(ei, fj) (ﬁrst index = row index, second index = column index), where {e1, . . . , en} and {f1, . . . , fm}
are ordered bases of Rn and Rm, respectively.
2.4
Properties of the Derivative
In this section some of the fundamental properties of the derivative are developed. These properties are
analogues of rules familiar from elementary calculus.
Diﬀerentiability implies Lipschitz.
Let us begin by strengthening the fact that diﬀerentiability implies
continuity.
2.4.1 Proposition.
Suppose U ⊂E is open and f : U →F is diﬀerentiable on U. Then f is continuous.
In fact, for each u0 ∈U there is a constant M > 0 and a δ0 > 0 with the property that ∥u−u0∥< δ0 implies
∥f(u) −f(u0)∥≤M∥u −u0∥. (This is called the Lipschitz property.)

2.4 Properties of the Derivative
73
Proof.
Using the general inequality |∥e1∥−∥e2∥| ≤∥e1 −e2∥, we get
| ∥f(u) −f(u0)∥−∥Df(u0) · (u −u0)∥|
≤∥f(u) −f(u0) −Df(u0) · (u −u0)∥
= ∥o(u −u0)∥≤∥u −u0∥
for ∥u −u0∥≤δ0, where δ0 is some positive constant depending on u0; this holds since
lim
u→u0
o(u −u0)
∥u −u0∥= 0.
Thus,
∥f(u) −f(u0)∥≤∥Df(u0) · (u −u0)∥+ ∥u −u0∥
≤(∥Df(u0)∥+ 1)∥u −u0∥
for ∥u −u0∥≤δ0.
■
Chain Rule.
Perhaps the most important rule of diﬀerential calculus is the chain rule. To facilitate its
statement, the notion of the tangent of a map is introduced. The text will begin conceptually distinguishing
points in U from vectors in E. At this point it is not so clear that the distinction is important, but it will
help with the transition to manifolds in Chapter 3.
2.4.2 Deﬁnition.
Suppose f : U ⊂E →F is of class C1. Deﬁne the tangent of f to be the map
Tf : U × E →F × F
given by Tf(u, e) = (f(u), Df(u) · e),
where we recall that Df(u) · e denotes Df(u) applied to e ∈E as a linear map. If f is of class Cr, deﬁne
T rf = T(T r−1f) inductively.
From a geometric point of view, Tf is a more “natural” object than D. The reasons for this will become
clearer as we proceed, but roughly speaking, the essence is this: we think of (u, e) as a vector with base
point u, and vector part e then (f(u), Df(u) · e) is the image vector with its base point f(u), as in Figure
2.4.1. Another reason for this is the simple and elegant behavior of T under composition, as given in the
next theorem.
E
F
f
u
e
f (u)
Df(u).e
Figure 2.4.1. The geometry of the tangent map
2.4.3 Theorem (Cr Composite Mapping Theorem).
Suppose f : U ⊂E →V ⊂F and g : V ⊂F →G
are diﬀerentiable (resp., Cr) maps. Then the composite g ◦f : U ⊂E →G is also diﬀerentiable (resp., Cr)
and
T(g ◦f) = Tg ◦Tf,

74
2. Banach Spaces and Diﬀerential Calculus
(resp., T r(g ◦f) = T rg ◦T rf). The formula T(g ◦f) = Tg ◦Tf is equivalent to the chain rule in terms of
D:
D(g ◦f)(u) = Dg(f(u)) ◦Df(u).
Proof.
Since f is diﬀerentiable at u ∈U and g is diﬀerentiable at f(u) ∈V , we have
f(u + e) = f(u) + Df(u) · e + o(e)
for e ∈E
and for v = f(u) we have g(v + w) = g(v) + Dg(v) · w + o(w). Thus,
(g ◦f)(u + e) = g(f(u) + Df(u) · e + o(e))
= (g ◦f)(u) + Dg(f(u)) · (Df(u) · e)
+Dg(f(u))(o(e)) + o(Df(u) · e + o(e)).
For e in a neighborhood of the origin,
∥Df(u) · e + o(e)∥
∥e∥
≤

∥Df(u)∥+ ∥o(e)∥
∥e∥

≤M
for some constant M > 0, and
∥Dg(f(u)) · o(e)∥≤∥Dg(f(u))∥∥o(e)∥.
Therefore,
∥o(Df(u) · e + o(e))∥
∥e∥
= ∥(o(Df(u) · e + o(e)))∥
∥Df(u) · e + o(e)∥
· ∥Df(u) · e + o(e)∥
∥e∥
≤M ∥(o(Df(u) · e + o(e)))∥
∥Df(u) · e + o(e)∥
.
Hence, we conclude that
Dg(f(u)) · (o(e)) + o(Df(u) · e + o(e)) = o(e)
and thus
D(g ◦f)(u) · e = Dg(f(u)) · (Df(u) · e).
Denote by ϕ : L(F, G) × L(E, F) →L(E, G) the bilinear mapping ϕ(B, A) = B ◦A and note that
ϕ ∈L(L(F, G), L(E, F); L(E, G)) since ∥B ◦A∥≤∥B∥∥A∥; that is, ∥ϕ∥≤1. Let (Dg ◦f) × Df : U →
L(F, G) × L(E, F) be deﬁned by
[(Dg ◦f) × Df](u) = (Dg(f(u)), Df(u));
notice that this map is continuous if f and g are of class C1. Therefore the composite function
ϕ ◦((Dg ◦f) × Df) = D(g ◦f) : U →L(E, G)
is continuous if f and g are C1, that is, g ◦f is C1. Inductively suppose f and g are Cr. Then Dg is Cr−1,
so Dg ◦f is Cr−1 and thus the map (Dg ◦f) × Df is Cr−1 (see Proposition 2.3.6). Since ϕ is C∞(Exercise
2.3-1), again the inductive hypothesis forces ϕ ◦((Dg ◦f) × Df) = D(g ◦f) to be Cr−1; that is, g ◦f is Cr.
The formula T r(g ◦f) = T rg ◦T rf is a direct veriﬁcation for r = 1 using the chain rule, and the rest
follows by induction.
■

2.4 Properties of the Derivative
75
If E = Rm, F = Rn, G = Rp, and f = (f 1, . . . , f n), g = (g1, . . . , gp), where f i : U →R and gj : V →R,
by Proposition 2.3.7 the chain rule becomes


∂(g ◦f)1(x)
∂x1
· · ·
∂(g ◦f)1(x)
∂xm
...
...
∂(g ◦f)p(x)
∂x1
· · ·
∂(g ◦f)p(x)
∂xm


=


∂g1(f(x))
∂y1
· · ·
∂g1(f(x))
∂yn
...
...
∂gp(f(x))
∂y1
· · ·
∂gp(f(x))
∂yn


·


∂f 1(x)
∂x1
· · ·
∂f 1(x)
∂xm
...
...
∂f n(x)
∂x1
· · ·
∂f n(x)
∂xm


which, when read componentwise, becomes the usual chain rule from calculus:
∂(g ◦f)j(x)
∂xi
=
n

k=1
∂gj(f(x))
∂yk
∂f k(x)
∂xi
,
i = 1, . . . , m.
Product Rule.
The chain rule applied to B ∈L(F1, F2; G) and f1 × f2 : U ⊂E →F1 × F2 yields the
following.
2.4.4 Theorem (The Leibniz or Product Rule).
Let fi : U ⊂E →Fi, i = 1, 2, be diﬀerentiable (resp.,
Cr) maps and B ∈L(F1, F2; G). Then the mapping B(f1, f2) = B ◦(f1 × f2) : U ⊂E →G is diﬀerentiable
(resp., Cr) and
D(B(f1, f2))(u) · e = B(Df1(u) · e, f2(u)) + B(f1(u), Df2(u) · e).
In the case F1 = F2 = R and B is multiplication, Theorem 2.4.4 reduces to the usual product rule for
derivatives. Leibniz’ rule can easily be extended to multilinear mappings (Exercise 2.4-3).
Directional Derivatives.
The ﬁrst of several consequences of the chain rule involves the directional
derivative.
2.4.5 Deﬁnition.
Let f : U ⊂E →F and let u ∈U. We say that f has a derivative in the direction
e ∈E at u if
d
dtf(u + te)

t=0
exists. We call this element of F the directional derivative of f in the direction e at u.
Sometimes a function all of whose directional derivatives exist is called Gˆateaux diﬀerentiable, whereas
a function diﬀerentiable in the sense we have deﬁned is called Fr´echet diﬀerentiable. The latter is stronger,
according to the following. (See also Exercise 2.4-10.)
2.4.6 Proposition.
If f is diﬀerentiable at u, then the directional derivatives of f exist at u and are given
by
d
dtf(u + te)

t=0
= Df(u) · e.

76
2. Banach Spaces and Diﬀerential Calculus
Proof.
A path in E is a map from I into E, where I is an open interval of R. Thus, if c is diﬀerentiable,
for t ∈I we have Dc(t) ∈L(R, E), by deﬁnition. Recall that we identify L(R, E) with E by associating
Dc(t) with Dc(t) · 1 (1 ∈R). Let
dc
dt (t) = Dc(t) · 1.
For f : U ⊂E →F of class C1 we consider f ◦c, where c : I →U. It follows from the chain rule that
d
dt(f(c(t))) = D(f ◦c)(t) · 1 = Df(c(t)) · dc
dt
The proposition follows by choosing c(t) = u+te, where u, e ∈E, I = ]−λ, λ[, and λ is suﬃciently small.
■
For f : U ⊂Rn →R, the directional derivative is given in terms of the standard basis {e1, . . . , en} by
Df(u) · e = ∂f
∂x1 x1 + · · · + ∂f
∂xn xn,
where e = x1e1 + · · · + xnen. This follows from Proposition 2.3.7 and Proposition 2.4.6.
The formula in Proposition 2.4.6 is sometimes a convenient method for computing Df(u)·e. For example,
let us compute the diﬀerential of a homogeneous polynomial of degree 2 from E to F. Let f(e) = A(e, e),
where A ∈L2(E; F). By the chain and Leibniz rules,
Df(u) · e = d
dtA(u + te, u + te)

t=0
= A(u, e) + A(e, u).
If A is symmetric, then Df(u) · e = 2A(u, e).
Mean Value Inequality.
One of the basic tools for ﬁnding estimates is the following.
2.4.7 Proposition.
Let E and F be real Banach spaces, f : U ⊂E →F a C1-map, x, y ∈U, and c a C1
arc in U connecting x to y; that is, c is a continuous map c : [0, 1] →U, which is C1 on ]0, 1[, c(0) = x,
and c(1) = y. Then
f(y) −f(x) =
	 1
0
Df(c(t)) · c′(t) dt.
If U is convex and c(t) = (1 −t)x + ty, then
f(y) −f(x) =
	 1
0
Df((1 −t)x + ty) · (y −x) dt
=
	 1
0
Df((1 −t)x + ty) dt

· (y −x).
Proof.
If g(t) = (f ◦c)(t), the chain rule implies g′(t) = Df(c(t)) · c′(t) and the fundamental theorem of
calculus gives
g(1) −g(0) =
	 1
0
g′(t) dt,
which is the ﬁrst equality. The second equality for U convex and c(t) = (1 −t)x + ty is Exercise 2.2-6(i).
■

2.4 Properties of the Derivative
77
2.4.8 Proposition (Mean Value Inequality).
Suppose U ⊂E is convex and f : U ⊂E →F is C1. Then
for all x, y ∈U
∥f(y) −f(x)∥≤

sup
0≤t≤1
∥Df((1 −t)x + ty)∥

∥y −x∥.
Thus, if ∥Df(u)∥is uniformly bounded on U by a constant M > 0, then for all x, y ∈U
∥f(y) −f(x)∥≤M∥y −x∥.
If F = R, then f(y) −f(x) = Df(c) · (y −x) for some c on the line joining x to y.
Proof.
The inequality follows directly from Proposition 2.4.7. The last assertion follows from the inter-
mediate value theorem as in elementary calculus.
■
2.4.9 Corollary.
Let U ⊂E be an open set; then the following are equivalent:
(i)
U is connected;
(ii)
every diﬀerentiable map f : U ⊂E →F satisfying Df = 0 on U is constant.
Proof.
If U = U1 ∪U2 and U1 ∩U2 = ∅, where U1 and U2 are open, then the mapping
f(u) =

0,
if u ∈U1;
e,
if u ∈U2,
where e ∈F, e ̸= 0 is a ﬁxed vector, has Df = 0, yet is not constant.
Conversely, assume that U is connected and Df = 0. Then f is in fact C∞. Let u0 ∈U be ﬁxed and
consider the set S = { u ∈U | f(u) = f(u0) }. Then S ̸= ∅(since u0 ∈S), S ⊂U, and S is closed since f
is continuous. We shall show that S is also open. If u ∈S, consider v ∈Dr(u) ⊂U and apply Proposition
2.4.8 to get
∥f(u) −f(v)∥≤sup{ ∥Df((1 −t)u + tv)∥| t ∈[0, 1] } ∥u −v∥= 0;
that is, f(v) = f(u) = f(u0) and hence Dr(u) ⊂S. Connectedness of U implies S = U.
■
If f is Gˆateaux diﬀerentiable and the Gˆateaux derivative is in L(E, F); that is, for each u ∈V there exists
Gu ∈L(E, F) such that
d
dtf(u + te)

t=0
= Gue,
and if u →Gu is continuous, we say f is C1-Gˆateaux. The mean value inequality holds, replacing C1
everywhere by “C1-Gˆateaux” and the identical proofs work. When studying diﬀerentiability the following
is often useful.
2.4.10 Corollary.
If f : U ⊂E →F is C1-Gˆateaux then it is C1 and the two derivatives coincide.
Proof.
Let u ∈U and work in a disk centered at u. Proposition 2.4.7 gives
∥f(u + e) −f(u) −Gue∥=

	 1
0
(Gu+te −Gu) dt

e

≤sup{ ∥Gu+te −Gu∥| t ∈[0, a] } ∥e∥
and the sup converges to zero as, e →0, by uniform continuity of the map t ∈[0, 1] →Gu+te ∈L(E, F).
This says that Df(u) · e exists and equals Gue.
■

78
2. Banach Spaces and Diﬀerential Calculus
Partial Derivatives.
We shall discuss only functions of two variables, the generalization to n variables
being obvious.
2.4.11 Deﬁnition.
Let f : U →F be a mapping deﬁned on the open set U ⊂E1 ⊕E2 and let u0 =
(u01, u02) ∈U. The derivatives of the mappings v1 →f(v1, u02), v2 →f(u01, v2), where v1 ∈E1 and
v2 ∈E2, if they exist, are called partial derivatives of f at u0 ∈U and are denoted by D1f(u0) ∈L(E1, F),
D2f(u0) ∈L(E2, F).
2.4.12 Proposition.
Let U ⊂E1 ⊕E2 be open and f : U →F.
(i)
If f is diﬀerentiable, then the partial derivatives exist and are given by
D1f(u) · e1 = Df(u) · (e1, 0)
and
D2f(u) · e2 = Df(u) · (0, e2).
(ii)
If f is diﬀerentiable, then
Df(u) · (e1, e2) = D1f(u) · e1 + D2f(u) · e2.
(iii)
f is of class Cr iﬀDif : U →L(Ei, F), i = 1, 2 both exist and are of class Cr−1.
Proof.
(i)
Let j1
u : E1 →E1 ⊕E2 be deﬁned by j1
u(v1) = (v1, u2), where u = (u1, u2) . Then j1
u is C∞
and Dj1
u(u1) = J1 ∈L(E1, E1 ⊕E2) is given by J1(e1) = (e1, 0). By the chain rule,
D1f(u) = D(f ◦j1
u)(u1) = Df(u) · J1,
which proves the ﬁrst relation in (i). One similarly deﬁnes j2
u, J2, and proves the second relation.
(ii)
Let Pi(e1, e2) = ei, i = 1, 2 be the canonical projections. Then compose the relation J1 ◦P1 +J2 ◦P2 =
identity on E1 ⊕E2 with Df(u) on the left and use (i).
(iii)
Let
Φi ∈L(L(E1 ⊕E2, F), L(Ei, F))
and
Ψi ∈L(L(Ei, F), L(E1 ⊕E2, F))
be deﬁned by Φi(A) = A ◦Ji and Ψi(Bi) = Bi ◦Pi, i = 1, 2. Then (i) and (ii) become
Dif = Φi ◦Df
Df = Ψ1 ◦D1f + Ψ2 ◦D2f.
This shows that if f is diﬀerentiable, then f is Cr iﬀD1f and D2f are Cr−1. Thus to conclude the proof
we need to show that if D1f and D2f exist and are continuous, then Df exists. By Proposition 2.4.7 applied
consecutively to the two arguments, we get
f(u1 + e1, u2 + e2) −f(u1, u2) −D1f(u1, u2) · e1 −D2f(u1, u2) · e2
= f(u1 + e1, u2 + e2) −f(u1, u2 + e2) −D1f(u1, u2) · e1
+ f(u1, u2 + e2) −f(u1, u2) −D2f(u1, u2) · e2
=
	 1
0
(D1f(u1 + te1, u2 + e2) −D1f(u1, u2)) dt

· e1
+
	 1
0
(D2f(u1, u2 + te2) −D2f(u1, u2)) dt

· e2

2.4 Properties of the Derivative
79
Taking norms and using in each term the obvious inequality ∥e1∥≤∥e1∥+ ∥e2∥≡∥(e1, e2)∥, we see that
∥f(u1 + e1, u2 + e2) −f(u1, u2) −D1f(u1, u2) · e1 −D2f(u1, u2) · e2∥
≤

sup
0≤t≤1
∥D1f(u1 + te1, u2 + e2) −D1f(u1, u2 + e2)∥
+ sup
0≤t≤1
∥D2f(u1, u2 + te2) −D2f(u1, u2)∥

∥(e1, e2)∥.
Both sups in the parentheses converge to zero as (e1, e2) →(0, 0) by continuity of the partial derivatives.
■
Higher Derivatives.
If E1 = E2 = R and {e1, e2} is the standard basis in R2 we see that
∂f
∂x(x, y) = lim
h→0
f(x + h, y) −f(x, y)
h
= D1f(x, y) · e1 ∈F.
Similarly, (∂f/∂y)(x, y) = D2f(x, y) · e2 ∈F. Deﬁne inductively higher derivatives
∂2f
∂x2 = ∂
∂x
∂f
∂x

,
∂2f
∂x∂y = ∂
∂y
∂f
∂x

,
etc.
2.4.13 Example.
As an application of the formalism just introduced we shall prove that for f : U ⊂
R2 →R
D2f(u) · (v, w) = v1w1 ∂2f
∂x2 (u) + v1w2 ∂2f
∂y∂x(u) + v2w1 ∂2f
∂x∂y (u)
+ v2w2 ∂2f
∂y2 (u),
= (v1, v2)


∂2f
∂x2 (u)
∂2f
∂y ∂x(u)
∂2f
∂x ∂y (u)
∂2f
∂y2 (u)



w1
w2

,
where u ∈U, v, w ∈R2, v = v1e1 + v2e2, w = w1e1 + w2e2, and {e1, e2} is the standard basis of R2. To
prove this, note that by deﬁnition,
D2f(u) · (v, w) = D((Df)(·) · w)(u) · v.
Applying the chain rule to Df(·) · w = Tw : A ∈L(R2, F) →A · w ∈F, the above
D(Df(·) · w)(u) · v
= D(D1f(·) · w1e1 + D2f(·) · w2e2)(u) · v
(by Prop. 2.4.12(ii))
= D

w1 ∂f
∂x + w2 ∂f
∂y

(u) · v
= w1

D1
∂f
∂x

(u) · v1e1 + D2
∂f
∂x

(u) · v2e2

(2.4.1)
+ w2

D1
∂f
∂y

(u) · v1e1 + D2
∂f
∂y

(u) · v2e2

= v1w1 ∂2f
∂x2 (u) + v2w1 ∂2f
∂x∂y (u) + v1w2 ∂2f
∂y∂x(u) + v2w2 ∂2f
∂y2 (u).
♦

80
2. Banach Spaces and Diﬀerential Calculus
For computation of higher derivatives, note that by repeated application of Proposition 2.4.6,
Drf(u) · (e1, . . . , er) = d
dtr
· · · d
dt1

f

u +
r

i=1
tiei

t1=···=tr=0
In particular, for f : U ⊂Rm →Rn the components of Drf(u) in terms of the standard basis are
∂rf
∂xi1 · · · ∂xir ,
0 ≤ik ≤r.
Thus, f is of class Cr iﬀall its r-th order partial derivatives exist and are continuous.
Symmetry of Higher Derivatives.
Equality of mixed partials is of course a fundamental property we
learn in calculus. Here is the general result.
2.4.14 Proposition (L. Euler).
If f : U ⊂E →F is Cr, then Drf(u) ∈Lr
s(E, F); that is, Drf(u) is
symmetric.
Proof.
First we prove the result for r = 2. Let u ∈U, v, w ∈E be ﬁxed; we want to show that D2f(u) ·
(v, w) = D2f(u) · (w, v). To this, deﬁne the linear map a : R2 →E by a(e1) = v, and a(e2) = w, where e1
and e2 are the standard basis vectors of R2. For (x, y) ∈R2, then a(x, y) = xv + yw. Now deﬁne the aﬃne
map A : R2 →E by A(x, y) = u + a(x, y). Since
D2(f ◦A)(x, y) · (e1, e2) = D2f(u) · (v, w)
(Exercise 2.3-5), it suﬃces to prove this formula:
D2(f ◦A) · (x, y) · (e1, e2) = D2(f ◦A)(x, y) · (e2, e1);
that is,
∂2(f ◦A)
∂x∂y
= ∂2(f ◦A)
∂y∂x
(see Example 2.4.13). Let g = f ◦A : V = A−1(U) ⊂R2 →F. Since for any λ ∈F∗, ∂2(λ ◦g)/∂x∂y =
λ(∂2g/∂x∂y), using the Hahn–Banach theorem 2.2.12, it suﬃces to prove that
∂2ϕ
∂x∂y = ∂2ϕ
∂y∂x,
where ϕ = λ ◦g : V ⊂R2 →R, which is a standard result from calculus. For the sake of completeness we
recall the proof. Applying the mean value theorem twice, we get
Sh,k = [ϕ(x + h, y + k) −ϕ(x, y + k)] −[ϕ(x + h, y) −ϕ(x, y)]
=
∂ϕ
∂x (ch,k, y + k) = ∂ϕ
∂x (ch,k, y)

k
= ∂2ϕ
∂x∂y (ch,k, dh,k)hk.
for some ch,k, dh,k lying between x and x+h, and y and y +k, respectively. By interchanging the two middle
terms in Sh,k we can derive in the same way that
Sh,k = ∂2ϕ
∂y∂x(γh,k, δh,k)hk.

2.4 Properties of the Derivative
81
Equating these two formulas for Sh,k, canceling h, k, and letting h →0, k →0, the continuity of D2ϕ gives
the result.
For general r, proceed by induction:
Drf(u) · (v1, v2, . . . , vn) = D2(Dr−2f)(u) · (v1, v2) · (v3, . . . , vn)
= D2(Dr−2f)(u) · (v2, v1) · (v3, . . . , vn)
= Drf(u) · (v2, v1, v3, . . . , vn).
Let σ be any permutation of {2, . . . , n}, so by the inductive hypothesis
Dr−1f(u)(v2, . . . , vn) = Dr−1f(u)(vσ(2), . . . , vσ(n)).
Take the derivative of this relation with respect to u ∈U keeping v2, . . . , vn ﬁxed and get (Exercise 2.4-6):
Drf(u)(v1, . . . , vn) = Drf(u)(v1, vσ(2), . . . , vσ(n)).
Since any permutation can be written as a product of the transposition {1, 2, 3, . . . , n} →{2, 1, 3, . . . , n} (if
necessary) and a permutation of the set {2, . . . , n}, the result follows.
■
Taylor’s Theorem.
Suppose U ⊂E is an open set. Since + : E × E →E is continuous, there exists an
open set ˜U ⊂E × E with these three properties:
(i)
U × {0} ⊂˜U,
(ii)
u + ξh ∈U for all (u, h) ∈˜U and 0 ≤ξ ≤1, and
(iii)
(u, h) ∈˜U implies u ∈U.
For example let
˜U = {(+)−1(U)} ∩(U × E).
Let us call such a set ˜U a thickening of U. See Figure 2.4.2.
                                                                      U
U = thickening of U
~
E
E
Figure 2.4.2. A thickened neighborhood
2.4.15 Theorem (Taylor’s Theorem).
A map f : U ⊂E →F is of class Cr iﬀthere are continuous
mappings
ϕp : U ⊂E →Lp
s(E, F),
p = 1, . . . , r,
and
R : ˜U →Lr
s(E, F),

82
2. Banach Spaces and Diﬀerential Calculus
where ˜U is some thickening of U such that for all (u, h) ∈˜U,
f(u + h) = f(u) + ϕ1(u)
1!
· h + ϕ2(u)
2!
· h2 + · · · + ϕr(u)
r!
· hr + R(u, h) · hr,
where hp = (h, . . . , h) (p times) and R(u, 0) = 0. If f is Cr then necessarily ϕp = Dpf and
R(u, h) =
	 1
0
(1 −t)r−1
(r −1)! (Drf(u + th) −Drf(u)) dt.
Proof.
We shall prove the “only if” part. The converse is proved in Supplement 2.4B. Leibniz’ rule gives
the following integration by parts formula. If [a, b] ⊂U ⊂R and ψi : U ⊂R →Ei, i = 1, 2 are C1
mappings and B ∈L(E1, E2; F) is a bilinear map of E1 × E2 to F, then
	 b
a
B(ψ′
1(1), ψ2(t)) dt = B(ψ1(b), ψ2(b)) −B(ψ1(a), ψ2(a))
−
	 b
a
B(ψ1(t), ψ′
2(t)) dt.
Assume f is a Cr mapping. If r = 1, then by Proposition 2.4.7
f(u + h) = f(u) +
	 1
0
Df(u + th) dt

· h
= f(u) + Df(u) · h +
	 1
0
(Df(u + th) −Df(u)) dt

· h
and the formula is proved. For general k ≤r proceed by induction choosing in the integration by parts
formula E1 = R, E2 = E, B(s, e) = se, ψ2(t) = Dkf(u + th) · hk, and ψ1(t) = −(1 −t)k/k!, and taking into
account that
	 1
0
(1 −t)k
k!
dt =
1
(k + 1)!.
Since Dkf(u) ∈Lk
s(E, F) by Proposition 2.4.14, Taylor’s formula follows.
■
Note that R(u, h)·hr = o(hr) since R(u, h) →0 as h →0. If f is Cr+1 then the mean value inequality and
a bound on Dr+1f gives R(u, h) · hr = o(hr+1). See Exercise 2.4-13 for the diﬀerentiability of R. The proof
also shows that Taylor’s formula holds if f is (r −1) times diﬀerentiable on U and r times diﬀerentiable
at u. The estimate R(u, h) · hr = o(hr) is proved directly by induction; for r = 1 it is the deﬁnition of the
Fr´echet derivative.
If f is C∞(i.e., is Cr for all r) then we may be able to extend Taylor’s formula into a convergent power
series. If we can, we say f is of class Cω, or analytic. A standard example of a C∞function that is not
analytic is the following function from R to R (Figure 2.4.3)
θ(x) =

exp
 
−
1
1−x2
!
,
|x| < 1;
0,
|x| ≥1.
This function is C∞, and all derivatives are 0 at x = ±1. (To see this note that for |x| < 1,
f (n)(x) = Qn(x)(1 −x2)−2n exp

−1
1 −x2

,
where Qn(x) are polynomials given recursively by
Q0(x) = 1,
Qn+1(x) = (1 −x2)2Q′
n(x) + 2x(2n −1 −2nx2)Qn(x).)
Hence all coeﬃcients of the Taylor series around these points vanish. Since the function is not identically 0
in any neighborhood of ±1, it cannot be analytic there.

2.4 Properties of the Derivative
83
1
–1
x
y
Figure 2.4.3. A bump function
2.4.16 Example (Diﬀerentiating Under the Integral).
Let U ⊂E be open and f : [a, b] × U →F. For
t ∈[a, b], deﬁne g(t) : U →F by g(t)(u) = f(t, u). If, for each t, g(t) is of class Cr and if the maps
(t, u) ∈[a, b] × U →Dj(g(t))(u) ∈Lj
s(E, F)
are continuous, then h : U →F, deﬁned by
h(u) =
	 b
a
f(t, u) dt =
	 b
a
g(t)(u) dt
is Cr and
Djh(u) =
	 b
a
Dj
uf(t, u) dt,
j = 1, . . . , r,
where Du means the partial derivative in u. For r = 1, write
h(u + e) −h(u) −
	 b
a
D(g(t))(u) · e dt

=

	 b
a
	 1
0
(D(g(t))(u + se) · e −D(g(t))(u) · e) ds

dt

≤(b −a)∥e∥
sup
a≤t≤b,0≤t≤1
∥D(g(t))(u + se) −D(g(t))(u)∥= o(e).
For r > 1 one can also use an argument like this, but the converse to Taylor’s theorem also yields the result
rather easily. Indeed, if R(t, u, e) denotes the remainder for the Cr Taylor expansion of g(t), then with
ϕp = Dph =
	 b
a
Dp[g(t)] dt,
the remainder for h is clearly R(u, e) =
 b
a R(t, u, e) dt. But R(t, u, e) dt →0 as e →0 uniformly in t, so
R(u, e) is continuous and R(u, 0) = 0. Thus h is Cr.
♦
Supplement 2.4A
The Leibniz and Chain Rules
Here the explicit formulas are given for the kth order derivatives of products and compositions. The proofs
are straightforward but quite messy induction arguments, which will be left to the interested reader.

84
2. Banach Spaces and Diﬀerential Calculus
The Higher Order Leibniz Rule.
Let E, F1, F2, and G be Banach spaces, U ⊂E an open set,
f : U →F1 and g : U →F2 of class Ck and B ∈L(F1, F2; G). Let f ×g : U →F1 ×F2 denote the mapping
(f × g)(e) = (f(e), g(e)) and let B(f, g) = B ◦(f × g). Thus B(f, g) is of class Ck and by Leibniz’ rule,
DB(f, g)(p) · e = B(Df(p) · e, g(p)) + B(f(p), Dg(p) · e).
Higher derivatives of f and g are maps
Dif : U →Li(E; F1),
Dk−ig : U →Lk−i(E; F2),
where
D0f = f,
D0g = g,
L0(E; F1) = F1,
L0(E; F2) = F2.
Denote by
λi,k−i ∈L(Li(E; F1), Lk−i(E, F2); Lk(E; G)),
the bilinear mapping deﬁned by
[λi,k−i(A1, A2)](e1, . . . , ek) = B(A1(e1, . . . , ei), A2(ei+1, . . . , ek))
for A1 ∈Li(E; F1), A2 ∈Lk−i(E; F2), and e1, . . . , ek ∈E. Then
λi,k−i(Dif, Dk−ig) : U →Lk(E; G)
is deﬁned by
λi,k−i(Dif, Dk−ig)(p) = λi,k−i(Dif(p), Dk−ig(p))
for p ∈U. Leibniz’ rule for kth derivatives is
DkB(f, g) = Symk ◦
k

i=0

k
i

λi,k−i(Dif, Dk−ig),
where Symk : Lk(E; G) →Lk
s(E; G) is the symmetrization operator, given by (see Exercise 2.2-9):
(Symk A)(e1, . . . , ek) = 1
k!

σ∈Sk
A(eσ(1), . . . , e(k)),
where Sk is the group of permutations of {1, . . . , k}. Explicitly, taking advantage of the symmetry of higher
order derivatives, this formula is
DkB(f, g)(p) · (e1, . . . , ek) =

σ
k

i=0

k
i

B(Dif(p) · (eσ(1), . . . , eσ(i)), Dk−ig(p)(eσ(i+1), . . . , eσ(k))),
(2.4.2)
where the outer sum is over all permutations σ ∈Sk such that
σ(1) < · · · < σ(i)
and
σ(i + 1) < · · · < σ(k).

2.4 Properties of the Derivative
85
The Higher Order Chain Rule.
Let E, F, and G be Banach spaces and U ⊂F and V ⊂F be open
sets. Let f : U →V and g : V →G be maps of class Ck. By the usual chain rule, g ◦f : U →G is of class
Ck and
D(g ◦f)(p) = Dg(f(p)) ◦Df(p)
for p ∈U. For every tuple (i, j1, . . . , ji), where i > 1, and j1 + · · · + ji = k, deﬁne the continuous multilinear
map
λi,j1,...,ji : Li(F; G) × Lj1(E; F) × · · · × Lji(E; F) →Lk(E; G)
by
λi,j1,...,ji(A, B1, . . . , Bi) · (e1, . . . , ek)
= A(B1(ei, . . . , ej1), . . . , Bi(eji+···+j1−1+1, . . . , ek))
for
A ∈Li(F; G),
Bℓ∈Ljℓ(E; F),
ℓ= 1, . . . , i and ei, . . . , ek ∈E.
Since Djℓf : U →Ljℓ(E; F), we can deﬁne
λi,j1,...,ji ◦(Dig ◦f × Dj1f × · · · × Dji) : U →Lk(E; G)
by
p →λi,j1,...,ji(Dig(f(p)), Dj1f(p), . . . , Djif(p)).
With these notations, the kth order chain rule is
Dk(g ◦f) = Symk ◦
k

i=1

ji+···+j1=k
k!
j1! · · · ji!λi,j1,...,ji
◦(Dig ◦f × Dj1f × · · · × Djif),
where Symk : Lk(E; G) →Lk
s(E; G) is the symmetrization operator. Taking into account the symmetry of
higher order derivatives, the explicit formula at p ∈U and e1, . . . , ek ∈E, is
Dk(g ◦f)(p) · (e1, . . . , ek)
=
k

i=1

j1+···+ji=k

Dig(f(p))(Dj1f(p) · (eℓ1, . . . , eℓj1), . . . ,
Djif(p) · (eℓj1+···+ji−1+1, . . . , eℓk))
where the third sum is taken for ℓ1 < · · · < ℓj1 < · · · < ℓj1+···+ji−1+1 < · · · < ℓk.
Supplement 2.4B
The Converse to Taylor’s Theorem
This theorem goes back to Marcinkiewicz and Zygmund [1936], Whitney [1943a], and Glaeser [1958]. The
proof of the converse that we shall follow is due to Nelson [1969]. Assume the formula in the theorem holds

86
2. Banach Spaces and Diﬀerential Calculus
where ϕp = Dpf, 1 ≤p ≤r, and that R(u, h) has the desired expression. If r = 1, the formula reduces
to the deﬁnition of the derivative. Hence ϕ1 = Df, f is C1, and thus R(u, h) has the desired form, using
Proposition 2.4.7. Inductively assume the theorem is true for r = p −1. Thus ϕj = Djf, for 1 ≤j ≤p −1.
Let h, k ∈E be small in norm such that u + h + k ∈U. Write the formula in the theorem for f(u + h + k)
in two diﬀerent ways:
f(u + h + k) = f(u + h) + Df(u + h) · k + · · ·
+
1
(p −1)!Dp−1f(u + h) · kp−1
+ 1
p!ϕp(u + h) · kp + R1(u + k, k) · kp;
f(u + h + k) = f(u) + Df(u) · (h + k) + · · ·
+
1
(p −1)!Dp−1f(u) · (h + k)p−1
+ 1
p!ϕp(u) · (h + k)p + R2(u, h + k) · (h + k)p.
Subtracting them and collecting terms homogeneous in kj we get:
g0(h) + g1(h) · k + · · · + gp−1(h) · kp−1 + gp(h) · kp
= R1(u + h, k) · kp −R2(u, h + k) · (h + k)p,
where gj(h) ∈Lj(E; F), gj(0) = 0 is given by
gj(h) = 1
j!
"
Djf(u + h) −Djf(u) −
p−1−j

i=1
1
i!Dj+1f(u) · hi
−
1
(p −j)!ϕp(u) · hp−j
#
,
where 0 ≤j ≤p −2;
gp−1(h) =
1
(p −1)!
$
Dp−1f(u + h) −Dp−1f(u) −ϕp(u) · h
%
;
and
gp(h) = 1
p! [ϕp(u + h) −ϕp(u)] .
Let ∥k∥satisfy (1/4)∥h∥≤∥k∥≤(1/2)∥h∥. Since
∥R1(u + h, k) · kp −R2(u, h + k) · (h + k)p −gp(h) · kp∥
≤(∥R1(u + h, k)∥+ ∥gp(h)∥) ∥k∥p + ∥R2(u, h + k)∥(∥h∥+ ∥k∥)p
≤{∥R1(u + h, k)∥+ ∥gp(h)∥+ ∥R2(u, h + k)∥} (1 + 3p)∥h∥p/2p
and the quantity in braces {} →0 as h →0, it follows that
R1(u + h, k) · kp −R2(u, h + k) · (h + k)p −gp(h) · kp = o(hp).
Hence
g0(h) + g1(h) · k + · · · + gk−1(h) · kp−1 = o(hp).

2.4 Properties of the Derivative
87
We claim that subject to the condition (1/4)∥h∥≤∥k∥≤(1/2)∥h∥, each term of this sum is o(hp). If
λ1, . . . , λp are distinct numbers, replace k by λjk in the foregoing, and get a p × p linear system in the
unknowns g0(h), . . . , gp−1(h) · kp−1 with Vandermonde determinant Πi<j(λi −λj) ̸= 0 and right-hand side
a column vector all of whose entries are o(hp). Solving this system we get the result claimed. In particular,
(Dp−1f(u + k) −Dp−1f(u) −ϕp(u) · h) · kp−1 = gp−1(h) · kp−1 = o(hp).
Using polarization (see Supplement 2.2B) we get
∥Dp−1f(u + h) −Dp−1f(u) −ϕp(u) · h∥
≤(p −1)p−1
(p −1)!
(Dp−1f(u + h) −Dp−1f(u) −ϕp(u) · h)′

= (p −1)p−1
(p −1)!
sup
∥e∥≤1
(Dp−1f(u + h) −Dp−1f(u)
−ϕp(u) · h) · ep−1

= (p −1)p−1
(p −1)!
sup
∥k∥≤∥h∥/2
(Dp−1f(u + h) −Dp−1f(u)
−ϕp(u) · h) ·
 2k
∥h∥
p−1
= (2(p −1))p−1
(p −1)!∥h∥p−1
sup
∥k∥≤∥h∥/2
(Dp−1f(u + h) −Dp−1f(u)
−ϕp(u) · h) · kp−1

= (2(p −1))p−1
(p −1)!∥h∥p−1 o(hp)
Since o(hp)/∥h∥p →0 as h →0, this relation proves that Dp−1f is diﬀerentiable and Dpf(u) = ϕp(u). Thus
f is of class Cp, ϕp being continuous, and the formula for R follows by subtracting the given formula for
f(u + h) from Taylor’s expansion.
The converse of Taylor’s theorem provides an alternative proof that Drf(u) ∈Lr
s(E; F). Observe ﬁrst
that in the proof of Taylor’s expansion for a Cr map f the symmetry of Djf(u) was never used, so if one
symmetrizes the Djf(u) and calls them ϕj, the same expansion holds. But then the converse of Proposition
2.4.12 says that ϕj = Djf.
We shall consider here simple versions of two theorems from global analysis, which shall be used in
Supplement 4.1C, namely the smoothness of the evaluation mapping and the “omega lemma.”
The Evaluation Map.
Let I = [0, 1] and E be a Banach space. The vector space Cr(I; E) of Cr-maps
(r > 0) of I into E is a Banach space with respect to the norm
∥f∥k = max
1≤i≤k sup
t∈I
∥Dif(t)∥
(see Exercise 2.4-8). If U is open in E, then the set
Cr(I; U) = { f ∈Cr(I; E) | f(I) ⊂U }
is checked to be open in Cr(I; E).

88
2. Banach Spaces and Diﬀerential Calculus
2.4.17 Proposition.
The evaluation map deﬁned by:
ev : Cr(I; U) × ]0, 1[ →U
deﬁned by
ev(f, t) = f(t)
is Cr and its kth derivative is given by
Dk ev(f, t) · ((g1, s1), . . . , (gk, sk))
= Dkf(t) · (s1, . . . , sk) +
k

i=1
Di−1gi(t) · (s1, . . . , si−1, si+1, . . . , sk)
where
(gi, si) ∈Cr(I; E) × R,
i = 1, . . . , k.
Proof.
For (g, s) ∈Cr(I; E) × R, deﬁne the norm ∥(g, s)∥= max(∥g∥k, |s|). Note that the right-hand
side of the formula in the statement is symmetric in the arguments (gi, si), i = 1, . . . , k. We shall let this
right-hand side be denoted
ϕk : Cr(I; U) × ]0, 1[ →Lk
s(Cr(I; E) × R; E).
Note that ϕ0(f, t) = f(t) and that the proposition holds for r = 0 by uniform continuity of f on I since
∥f(t) −g(s)∥≤∥f(t) −f(s)∥+ ∥f −g∥0.
Since
lim
(g,s)→(0,0)
Drg(t) · sr
∥(g, s)∥r
= 0
for all t ∈]0, 1[, by Taylor’s theorem for g we get
ev(f + g, t + s) = f(t + s) + g(t + s)
=
r

i=0
1
i!(Dif(t) · si + Dig(t) · si) + R(t, s) · sr
= f(t) +
r

i=0
1
i!ϕi(f, t) · (g, s)i + R((f, t), (g, s)) · (g, s)r,
where
R((f, t), (g, s)) · ((g1, s1), . . . , (gr, sr)) = R(t, s) · (s1, . . . , sr)
+
r

i=1
Drgi(t) · (s1, . . . , sr),
which is symmetric in its arguments and R((f, t), (0, 0)) = 0. By the converse to Taylor’s theorem, the
proposition is proved if we show that every ϕi, 1 ≤i ≤r, is continuous. Since
∥Dk−1gi(t) −Dk−1gi(s)∥≤|t −s| sup
u∈I
∥Dkgi(u)∥≤|t −s| ∥gi∥r

2.4 Properties of the Derivative
89
by the mean value theorem, the inequality
∥(ϕk(f, t) −ϕk(g, s)) · ((g1, s1), . . . , (gk, sk))∥
≤∥Dkf(t) −Dkg(s)∥|s1| · · · |sk|
+
k

i=1
∥Dk−1gi(t) −Dk−1gi(s)∥|s1| · · · |si−1| |si+1| · · · |sk|
implies
∥ϕk(f, t) −ϕk(g, s)∥≤∥Dkf(t) −Dkg(s)∥+ k|t −s|
≤∥Dkf(t) −Dkf(s)∥+ ∥Dkf(s) −Dkg(s)∥
+ k|t −s|
≤∥Dkf(t) −Dkf(s)∥+ 2k∥(f, t) −(g, s)∥.
Thus the uniform continuity of Dkf on I implies the continuity of ϕk at (f, t).
■
Omega Lemma.
(This is terminology of Abraham [1963]. Various results of this type can be traced back
to earlier works of Sobolev [1939] and Eells [1958].)
Let M be a compact topological space and E, F be Banach spaces. With respect to the norm
∥f∥= sup
m∈M
∥f(m)∥,
the vector space C0(M, E) of continuous E-valued maps on M, is a Banach space. If U is open in E, it is
easy to see that
C0(M, U) = { f ∈C0(M, E) | f(M) ⊂U }
is open.
2.4.18 Lemma (Omega Lemma).
Let g : U →F be a Crmap, r > 0. The map
Ωg : C0(M, U) →C0(M, F)
deﬁned by Ωg(f) = g ◦f
is also of class Cr. The derivative of Ωg is
DΩg(f) · h = [(Dg) ◦f] · h
that is,
[DΩg(f) · h](x) = Dg(f(x)) · h(x).
The formula for DΩg is quite plausible. Indeed, we have
[DΩg(f) · h](x) = d
dεΩg(f + εh)(x)

ε=0
= d
dεg(f(x) = εh(x))

ε=0
By the chain rule this is Dg(f(x))·h(x). This shows that if Ωg is diﬀerentiable, then DΩg must be as stated
in the proposition.
Proof.
Let f ∈C0(M, U). By continuity of g and compactness of M,
∥Ωg(f) −Ωg(f ′)∥= sup
m∈M
∥g(f(m)) −g(f ′(m))∥

90
2. Banach Spaces and Diﬀerential Calculus
is small as soon as ∥f −f ′∥is small; that is, Ωg is continuous at each point f. Let
Ai : C0(M, Li
s(E; F)) →Li
s(C0(M, E); C0(M, F))
be given by
Ai(H)(h1, . . . , hi)(m) = H(m)(h1(m), . . . , hi(m))
for H ∈C0(M, Li(E; F)), h1, . . . , hi ∈C0(M, E) and m ∈M. The maps Ai are clearly linear and are
continuous with ∥Ai∥≤1. Since Dig : U →Li
s(E; F) is continuous, the preceding argument shows that the
maps
ΩDig : C0(M, U) →Li
s(C0(M, E); C0(M, F))
are continuous and hence
Ai ◦ΩDig : C0(M, U) →Li
s(C0(M, E); C0(M, F))
is continuous. The Taylor theorem applied to g yields
g(f(m) + h(m)) = g(f(m)) +
r

i=1
1
i!Dig(f(m)) · h(m)i
+ R(f(m), h(m)) · h(m)i
so that deﬁning
[(Dig ◦f) · hi](m) = Dig(f(m)) · h(m)i,
and
[R(f, h) · (h1, . . . , hr)](m) = R(f(m), h(m)) · (h1(m), . . . , hr(m))
we see that R is continuous, R(f, 0) = 0, and
Ωg(f + h) = g ◦(f + h) = g ◦f +
r

i=1
1
i!(Dig ◦f) · hi + R(f, h) · hi
= Ωg(f) +
r

i=1
1
i!(Ai ◦ΩDig)(f) · hi + R(f, h) · hi.
Thus by the converse of Taylor’s theorem, DiΩg = Ai ◦ΩDig and Ωg is of class Cr.
■
This proposition can be generalized to the Banach space Cr(I, E), I = [a, b], equipped with the norm
∥· ∥r given by the maximum of the norms of the ﬁrst r derivatives; that is,
∥f∥r = max
0≤i≤r sup
t∈I
∥f (i)(t)∥.
If g is Cr+q, then Ωg : Cr(I, E) →Cr−k(I, F) is Cq+k. Readers are invited to convince themselves that the
foregoing proof works with only trivial modiﬁcations in this case. This version of the omega lemma will be
used in Supplement 4.1C.
For applications to partial diﬀerential equations, the most important generalizations of the two previous
propositions is to the case of Sobolev maps of class Hs; see for example Palais [1968], Ebin and Marsden
[1970], and Marsden and Hughes [1983] for proofs and applications.

2.4 Properties of the Derivative
91
Supplement 2.4C
The Functional Derivative and the Calculus of Variations
Diﬀerential calculus in inﬁnite dimensions has many applications, one of which is to the calculus of variations.
We give some of the elementary aspects here. We shall begin with some notation and a generalization of the
notion of the dual space.
Duality and Pairings.
Let E and F be Banach spaces. A continuous bilinear functional ⟨, ⟩: E×F →R
is called E-non-degenerate if ⟨x, y⟩= 0 for all y ∈F implies x = 0. Similarly, it is F-non-degenerate if
⟨x, y⟩= 0 for all x ∈E implies y = 0. If it is both, we just say ⟨, ⟩is non-degenerate. Equivalently, the
two linear maps of E to F∗and F to E∗deﬁned by x →⟨x, ·⟩and y →⟨·, y⟩, respectively, are one to one.
If they are isomorphisms, ⟨, ⟩is called E- or F-strongly non-degenerate. A non-degenerate bilinear form
⟨, ⟩thus represents certain linear functionals on F in terms of elements in E. We say E and F are in duality
if there is a non-degenerate bilinear functional ⟨, ⟩: E × F →R, also called a pairing of E with F. If the
functional is strongly non-degenerate, we say the duality is strong.
2.4.19 Examples.
A.
Let E = F∗. Let ⟨, ⟩: F∗× F →R be given by ⟨ϕ, y⟩= ϕ(y) so the map E →F∗is the identity.
Thus, ⟨, ⟩is E-strongly non-degenerate by the Hahn–Banach theorem. It is easily checked that ⟨, ⟩is F-non-
degenerate. (If it is F∗strongly non-degenerate, F is called reﬂexive.)
B.
Let E = F and ⟨, ⟩: E × E →R be an inner product on E. Then ⟨, ⟩is non-degenerate since ⟨, ⟩
is positive deﬁnite. If E is a Hilbert space, then ⟨, ⟩is a strongly non-degenerate pairing by the Riesz
representation theorem.
♦
Functional Derivatives.
We now deﬁne the functional derivative which uses the pairing similar to how
one deﬁnes the gradient.
2.4.20 Deﬁnition.
Let E and F be normed spaces and ⟨, ⟩be an E-weakly non-degenerate pairing. Let
f : F →R be diﬀerentiable at the point α ∈F. The functional derivative df/dα of f with respect to α is
the unique element in E, if it exists, such that
Df(α) · β =
&δf
δα, β
'
for all β ∈F.
(2.4.3)
Likewise, if g : E →R and ⟨, ⟩is F-weakly degenerate, we deﬁne the functional derivative δg/δv ∈F, if
it exists, by
Dg(v) · v′ =
&
v′, δf
δv
'
for all v′ ∈E
Often E and F are spaces of mappings, as in the following example.
2.4.21 Example.
Let Ω∈Rn be an open bounded set and consider the space E = C0(D), of continuous
real valued functions on D where D = cl(Ω). Take F = C0(D) = E. The L2-pairing on E × F is the bilinear
map given by
⟨, ⟩: C0(D) × C0(D) →R,
⟨f, g⟩=
	
Ω
f(x)g(x) dnx.
Let r be a positive integer and deﬁne f : E →R by
f(ϕ) = 1
2
	
Ω
[ϕ(x)]r dnx.

92
2. Banach Spaces and Diﬀerential Calculus
Then using the calculus rules from this section, we ﬁnd
Df(ϕ) · ψ =
	
Ω
r[ϕ(r)]r−1ψ(s) dnx.
Thus, δf
δϕ = rϕr−1.
♦
Suppose, more generally, that f is deﬁned on a Banach space E of functions ϕ on a region Ωin Rn. The
functional derivative (δf/δϕ) of f with respect to ϕ is the unique element (δf/δϕ) ∈E, if it exists, such
that
Df(ϕ) · ψ =
&δf
δϕ, ψ
'
=
	
Ω
δf
δϕ

(x)ψ(x) dnx
for all ψ ∈E.
The functional derivative may be determined in examples by
	
Ω
δf
δϕ(x)ψ(x) dnx = d
dε

ε=0
f(ϕ + εψ).
(2.4.4)
Criterion for Extrema.
A basic result in the calculus of variations is the following.
2.4.22 Proposition.
Let E be a space of functions, as above. A necessary condition for a diﬀerentiable
function f : E →R to have an extremum at ϕ is that
δf
δϕ = 0.
Proof.
If f has an extremum at ϕ, then for each ψ, the function h(ε) = f(ϕ + εψ) has an extremum
at ε = 0. Thus, by elementary calculus, h′(0) = 0. Since ψ is arbitrary, the result follows from equation
(2.4.4).
■
Suﬃcient conditions for extrema in the calculus of variations are more delicate. See, for example, Bolza
[1904] and Morrey [1966].
2.4.23 Examples.
A.
Suppose that Ω⊂R is an interval and that f, as a functional of ϕ ∈Ck(Ω), k ≥1, is of the form
f(ϕ) =
	
Ω
F

x, ϕ(x), dϕ
dx

dx
(2.4.5)
for some smooth function F : Ω× R × R →R, so that the right hand side of equation (2.4.5) is deﬁned.
We call F the density associated with f. It can be shown by using the results of the preceding supplement
that f is smooth. Using the chain rule,
	
Ω
δf
δϕ(x)ψ(x) dx = d
dε

ε=0
	
Ω
F

x, ϕ + εψ, d(ϕ + εψ)
dx

dx
=
	
Ω
D2F

x, ϕ(x), dϕ
dx

ψ(x) dx
+
	
Ω
D3F

x, ϕ(x), dϕ
dx
 dψ
dx dx,
where
D2F = ∂f
∂ϕ
and
D3F =
∂F
∂(∂ϕ/∂x)

2.4 Properties of the Derivative
93
denote the partial derivatives of F with respect to its second and third arguments. Integrating by parts, this
becomes
	
Ω
D2F

x, ϕ(x), dϕ
dx

ψ(x) dx −
	
Ω
 d
dxD3F

x, ϕ(x), dϕ
dx

ψ(x) dx
+
	
∂Ω
D3F

x, ϕ(x), dϕ
dx

ψ(x) dx.
Let us now restrict our attention to the space of ψ’s which vanish on the boundary ∂Ωof Ω. In that case
we get
δf
δϕ = D2F −d
dxD3F.
Rewriting this according to the designation of the second and third arguments of F as ϕ and dϕ/dx,
respectively, we obtain
δf
δϕ = ∂F
∂ϕ −d
dx
∂F
∂(dϕ/dx).
(2.4.6)
By a similar argument, if Ω⊂Rn, equation (2.4.6) generalizes to
δf
δϕ = ∂F
∂ϕ −
d
dxk
∂F
∂(dϕ/dxk).
(2.4.7)
(Here, a sum on repeated indices is assumed.) Thus, f has an extremum at ϕ only if
∂F
∂ϕ −
d
dxk
∂F
∂(∂ϕ/∂xk) = 0.
This is called the Euler–Lagrange equation in the calculus of variations.
B.
Assume that in Example A, the density F associated with f depends also on higher derivatives, that
is, F = F(x, ϕ(x), ϕx, ϕxx, . . . ), where ϕx = dϕ/dx, ϕxx = d2ϕ/dx2, etc. Therefore
f(ϕ) =
	
Ω
F(x, ϕ(x), ϕx, ϕxx, . . . ) dx.
By an analogous argument, formula (2.4.6) generalizes to
δf
δϕ = ∂F
∂ϕ −d
dx
 ∂F
∂ϕx

+ d2
dx2
 ∂F
∂ϕxx

−· · ·
(2.4.8)
C.
Consider a closed curve γ in R3 such that γ lies above the boundary ∂Ωof a region Ωin the xy-plane,
as in Figure 2.4.4.
Consider diﬀerentiable surfaces in R3 (i.e., two-dimensional manifolds of R3) that are graphs of Ck func-
tions ϕ : Ω⊂R2 →R, so that (x, y, ϕ(x, y)) are coordinates on the surface. What is the surface of least
area whose boundary is γ? From elementary calculus we know that the area as a function of ϕ is given by
A(ϕ) =
	
Ω
(
1 + ϕ2x + ϕ2y dx dy.
From equation (2.4.7), a necessary condition for ϕ to minimize A is that
δA
δϕ = −ϕxx(1 + ϕ2
y) −2ϕxϕyϕxy + ϕyy(1 + ϕ2
x)
(1 + ϕ2x + ϕ2y)exc:3.2−27
= 0,
(2.4.9)

94
2. Banach Spaces and Diﬀerential Calculus
x
z
y
Ω
∂Ω
γ
Figure 2.4.4. A curve γ lying over ∂Ω
for (x, y) ∈Ω. We relate this to the classical theory of surfaces as follows. A surface has two principal
curvatures κ1 and κ2; the mean curvature κ is deﬁned to be their average: that is, κ = (κ1 + κ2)/2. An
elementary theorem of geometry asserts that κ is given by the formula
κ = ϕxx(1 + ϕ2
y) −2ϕxϕyϕxy + ϕyy(1 + ϕ2
x)
(1 + ϕ2x + ϕ2y)1/2
.
(2.4.10)
If the surface represents a sheet of rubber, the mean curvature represents the net force due to internal
stretching. Comparing equations (2.4.9) and (2.4.10) we ﬁnd the well-known result that a minimal surface,
that is, a surface with minimal area, has zero mean curvature.
♦
Total Functional Derivative.
Now consider the case in which f is a diﬀerentiable function of n variables,
that is f is deﬁned on a product of n function spaces Fi, i = 1, . . . , n; f : F1 × · · · × Fn →R and we have
pairings ⟨, ⟩i : Ei × Fi →R.
2.4.24 Deﬁnition.
The i-th partial functional derivative δf/δϕi of f with respect to ϕi ∈Fi is deﬁned by
& δf
δϕi
, ψi
'
i
= d
dε

ε=0
f(ϕ1, . . . , ϕi + εψi, . . . , ϕn)
= Dif(ϕ1, . . . , ϕn) · ψi = Df(ϕ1, . . . , ϕn)(0, . . . , ψi, . . . , 0).
(2.4.11)
The total functional derivative is given by
&
δf
δ(ϕ1, . . . , ϕn), (ψ1, . . . , ψn)
'
= Df(ϕ1, . . . , ϕn) · (ψ1, . . . , ψn)
=
n

i=1
Dif(ϕ1, . . . , ϕn)(0, . . . , ψi, . . . , 0)
=
n

i=1
& δf
δϕi
, ψi
'
i
.
2.4.25 Examples.
A.
Suppose that f is a function of n functions ϕi ∈Ck(Ω), where Ω⊂Rn, and their ﬁrst partial derivatives,
and is of the form
f(ϕ1, . . . , ϕn) =
	
Ω
F

x, ϕi, ∂ϕi
∂xi

dnx.

2.4 Properties of the Derivative
95
It follows that
δf
δϕi
= ∂F
∂ϕi
−
∂
∂xk
∂F
∂
 ∂ϕi
∂xk

(sum on k)
(2.4.12)
B. Classical Field Theory.
As discussed in Goldstein [1980, Section 12], Lagrange’s equations for a ﬁeld
η = η(x, t) with components ηa follow from Hamilton’s variational principle. When the Lagrangian L is given
by a Lagrangian density £, that is, L is of the form
L(η) =
		
Ω⊂R3 £

xj, ηa, ∂ηa
∂xj , ∂ηa
∂t

dnx dt
(2.4.13)
the variational principle states that η should be a critical point of L. Assuming appropriate boundary
conditions, this results in the equations of motion
0 = δL
δηa = d
dt
∂£
∂(∂ηa/∂t) −∂£
∂ηa +
∂
∂xk
∂£
∂(∂ηa/∂xk)
(2.4.14)
(sum on k is understood). Regarding L as a function of ηa and ˙ηa = ∂ηa/∂t, the equations of motion take
the form:
d
dt
δL
δ ˙ηa = δL
δηa
(2.4.15)
C.
Let Ω⊂Rn and let Ck
∂(Ω) stand for the Ck functions vanishing on ∂Ω. Let f : Ck
∂(Ω) →R be given
by the Dirichlet integral
f(ϕ) = 1
2
	
Ω
⟨∇ϕ, ∇ϕ⟩dnx.
Using the standard inner product ⟨, ⟩in Rn, we may write
f(ϕ) = 1
2
	
Ω
⟨∇ϕ, ∇ϕ⟩dnx.
Diﬀerentiating with respect to ϕ:
Df(ϕ) · ψ = d
dε

ε=0
1
2
	
Ω
⟨∇(ϕ + εψ), ∇(ϕ + εψ)⟩dnx
=
	
Ω
⟨∇ϕ, ∇ψ⟩dnx
= −
	
Ω
∇2ϕ(x) · ψ(x) dnx
(integrating by parts).
Thus δf/δϕ = −∇2ϕ, the Laplacian of ϕ.
D. The Stretched String.
Consider a string of length ℓand mass density σ, stretched horizontally under
a tension τ, with ends fastened at x = 0 and x = ℓ. Let u(x, t) denote the vertical displacement of the string
at x, at time t. We have u(0, t) = u(ℓ, t) = 0. The potential energy V due to small vertical displacements is
shown in elementary mechanics texts to be
V =
	 ℓ
0
1
2τ
∂u
∂x
2
dx,

96
2. Banach Spaces and Diﬀerential Calculus
and the kinetic energy T is
T =
	 ℓ
0
1
2σ
∂u
∂t
2
dx.
From the deﬁnitions, we get
δV
δu = −τ ∂2u
∂x2
and
δT
δ ˙u = σ ˙u.
Then with the Lagrangian L = T −V , the equations of motion (2.4.15) become the wave equation
σ ∂2u
∂t2 −τ ∂2u
∂x2 = 0.
♦
Next we formulate a chain rule for functional derivatives. Let ⟨, ⟩: E×F →R be a weakly nondegenerate
pairing between E and F. If A ∈L(F, F), its adjoint A∗∈L(E, E), if it exists, is deﬁned by ⟨A∗v, α⟩=
⟨v, Aα⟩for all v ∈E and α ∈F.
Let ϕ : F →F be a diﬀerentiable map and f : F →R be diﬀerentiable at α ∈F. From the chain rule,
D(f ◦ϕ)(α) · β = Df(ϕ(α)) · (Dϕ(α) · β),
for β ∈F.
Hence assuming that all functional derivatives and adjoints exist, the preceding relation implies
&δ(f ◦ϕ)
δα
, β
'
=
&δf
δγ , Dϕ(α) · β
'
=
&
Dϕ(α)∗· δf
δγ , β
'
where γ = ϕ(α), that is,
δ(f ◦ϕ)
δα
= Dϕ(α)∗· δf
δγ .
(2.4.16)
Similarly if ψ : R →R is diﬀerentiable then for α, β ∈F,
D(ψ ◦f)(α) · β = Dψ(f(α)) · (Df(α) · β)
where the ﬁrst dot on the right hand side is ordinary multiplication by Dψ(f(a)) ∈R. Hence
&δ(ψ ◦f)
δα
, β
'
= Dψ(f(α)) ◦
&δf
δα, β
'
=
&
ψ′(f(α))δf
δα, β
'
that is,
δ(ψ ◦f)
δα
= ψ′(f(α))δf
δα.
(2.4.17)
Extrema for Real Valued Functions on Banach Spaces.
Much of this theory proceeds in a manner
parallel to calculus.
2.4.26 Deﬁnition.
Let f : U ⊂E →R be a continuous function, U open in E. We say f has a local
minimum (resp., maximum at u0 ∈U, if there is a neighborhood V of u0, V ⊂U such that f(u0) ≤f(u)
(resp., f(u0) ≥f(u)) for all u ∈V . If the inequality is strict, u0 is called a strict local minimum
(resp., maximum). The point u0 is called a global minimum (resp., maximum) if f(u0) ≤f(u) (resp.,
f(u0) ≥f(u)) for all u ∈U. Local maxima and minima are called local extrema.

2.4 Properties of the Derivative
97
2.4.27 Proposition.
Let f : U ⊂E →R be a continuous function diﬀerentiable at u0 ∈U. If f has a
local extremum at u0, then Df(u0) = 0.
Proof.
If u0 is a local minimum, then there is a neighborhood V of U such that f(u0 + th) −f(u0) ≥0
for all h ∈V . Therefore, the limit of [f(u0 + th) −f(u0)]/t as t →0, t ≥0 is ≥0 and as t →0, t ≤0 is ≤0.
Since both limits equal Df(u0), it must vanish.
■
This criterion is not suﬃcient as the elementary calculus example f : R →R, f(x) = x3 shows. Also, if U
is not open, the values of f on the boundary of U must be examined separately.
2.4.28 Proposition.
Let f : U ⊂E →R be twice diﬀerentiable at u0 ∈U.
(i)
If u0 is a local minimum (maximum), then D2f(u0) · (e, e) ≥0 (≤0) for all e ∈E.
(ii)
If u0 is a non-degenerate critical point f, that is, Df(u0) = 0 and D2f(u0) deﬁnes an isomorphism
of E with E∗, and if D2f(u0) · (e, e) > 0 (< 0) for all e ̸= 0, e ∈E, then u0 is a strict local minimum
(maximum) of f.
Proof.
(i)
By Taylor’s formula, in a neighborhood V of U0,
0 ≤f(u0 + h) −f(u0) = 1
2Df(u0)(h, h) + o(h2)
for all h ∈V . If e ∈E is arbitrary, for small t ∈R, te ∈V , so that
0 ≤1
2D2f(u0)(te, te) + o(t2e2)
implies
D2f(u0)(e, e) + 2
t2 o(t2e2) ≥0.
Now let t →0.
(ii)
Denote by T : E →E∗the isomorphism deﬁned by e →D2f(u0) · (e, ·), so that there exists a > 0
such that
a∥e∥≤∥Te∥= sup
∥e′∥=1
|⟨Te, e′⟩| = sup
∥e′∥=1
|D2f(u0) · (e, e′)|.
By hypothesis and symmetry of the second derivative,
0 < D2f(u0) · (e + se′, e + se′)
= s2D2f(u0) · (e′, e′) + 2sD2f(u0) · (e, e′) + D2f(u0) · (e, e)
which is a quadratic form in s. Therefore its discriminant must be negative, that is,
|D2f(u0) · (e, e′)|2 < D2f(u0) · (e′, e′)D2f(u0) · (e, e)
≤∥D2f(u0)∥D2f(u0) · (e, e),
and we get
a∥e∥≤sup
∥e′∥=1
|D2f(u0) · (e, e′)| ≤∥D2f(u0)∥1/2[D2f(u0) · (e, e)]1/2.
Therefore, letting m = a2/∥D2f(u0)∥, the following inequality holds for any e ∈E:
D2f(u0) · (e, e) ≥m∥e∥2.

98
2. Banach Spaces and Diﬀerential Calculus
Thus, by Taylor’s theorem we have
f(u0 + h) −f(u0) = 1
2D2f(u0) · (h, h) + o(h2) ≥m∥h∥2
2
+ o(h2).
Let ε > 0 be such that if ∥h∥< ε, then |o(h2)| ≤m∥h∥2/4, which implies f(u0 + h) −f(u0) ≥
m∥h∥2/4 > 0 for h ̸= 0, and thus u0 is a strict local minimum of f.
■
The condition in (i) is not suﬃcient for f to have a local minimum at u0. For example, f : R2 →R,
f(x, y) = x2 −y4 has f(0, 0) = 0, Df(0, 0) = 0, D2f(0, 0) · (x, y)2 = 2x2 ≥0 and in any neighborhood of
the origin, f changes sign. The conditions in (ii) are not necessary for f to have a strict local minimum at
u0. For example f : R →R, f(x) = x4 has f(0) = f ′(0) = f ′′(0) = f ′′′(0) = 0, f (4)(0) > 0 and 0 is a strict
global minimum for f. On the other hand, if the conditions in (ii) hold and u0 is the only critical point
of a diﬀerentiable function f : U →R, then u0 is a strict global minimum of f. For if there was another
point u1 ∈U with f(u1) ≤f(u0) on the straight line segment (1 −t)u0 + tu1, t ∈[0, 1] there exists a point
u2 such that f(u2) > f(u0) ≥f(u1) since by (ii) u0 is a strict local minimum. Therefore, there exists u3
on this segment, u3 ̸= u0, u1 such that f(u3) = f(u0). But then by the mean value theorem (Proposition
2.4.8) there exists u4 ̸= u0, u3 such that Df(u4) = 0 which contradicts uniqueness of the critical point.
Finally, care has to be taken with the statement in (ii): non-degeneracy holds in the topology of E. If E is
continuously embedded in another Banach space F and D2f(u0) is non-degenerate in F only, u0 need not
even be a minimum. For example, consider the smooth map
f : L4([0, 1]) →R,
f(u) = 1
2
	 1
0
(u(x)2 −u(x)4) dx
and note f(0) = 0, Df(0) = 0, and
D2f(0)(v, v) =
	 1
0
v(x)2 dx > 0
for v ̸= 0,
and that D2f(0) deﬁnes an isomorphism of L4([0, 1]) with Lexc:4.3−27([0, 1]). Alternatively, D2f(0) is non-
degenerate on L2([0, 1]) not on L4([0, 1]). Also note that in any neighborhood of 0 in L4([0, 1]), f changes
sign: f(1/n) = (n2 −1)/2n4 ≥0 for n ≥2, but f(un) = −12/n < 0 for n ≥1 if
un =

2,
on [0, 1/n];
0,
elsewhere
and both 1/n, un converge to 0 in L4([0, 1]). Thus, even though D2f(0) is positive, 0 is not a minimum of
f. (See Ball and Marsden [1984] for more sophisticated examples of this sort.)
Exercises
⋄2.4-1.
Show that if g : U ⊂E →L(F, G) is Cr, then f : U × F →G, deﬁned by f(u, v) = (g(u))(v),
u ∈U, v ∈F is also Cr.
Hint: Apply the Leibniz rule with L(F, G) × F →G the evaluation map.
⋄2.4-2.
Show that if f : U ⊂E →L(F, G), g : U ⊂E →L(G, H) are Cr mappings then so is h : U ⊂
E →L(F, H), deﬁned by h(u) = g(u) ◦f(u).
⋄2.4-3.
Extend Leibniz’ rule to multilinear mappings and ﬁnd a formula for the derivative.
⋄2.4-4.
Deﬁne a map f : U ⊂E →F to be of class T 1 if it is diﬀerentiable, its tangent map T f : U × E →
F × F is continuous and ∥Df(x)∥is locally bounded.

2.4 Properties of the Derivative
99
(i)
For E and F ﬁnite dimensional, show that this is equivalent to C1.
(ii)
(Project.) Investigate the validity of the chain rule and Taylor’s theorem for T r maps .
(iii)
(Project.) Show that the function developed in Smale [1964] is T 2 but is not C2.
⋄2.4-5.
Suppose that f : E →F (where E, F are real Banach spaces) is homogeneous of degree k (where
k is a nonnegative integer). That is, f(te) = tkf(e) for all t ∈R, and e ∈E.
(i)
Show that if f is diﬀerentiable, then Df(u) · u = kf(u).
Hint: Let g(t) = f(tu) and compute dg/dt.
(ii)
If E = Rn and F = R, show that this relation is equivalent to
n

i=1
xi
∂f
∂xi
= kf(x)
Show that maps multilinear in k variables are homogeneous of degree k. Give other examples.
(iii)
If f is Ck show that f(e) = (1/k!)Dkf(0) · ek, that is, f may be regarded as an element of Sk(E, F)
and thus it is C∞.
Hint: f(0) = 0; inductively applying Taylor’s theorem and replacing at each step h by th, show that
f(h) = 1
k!Dkf(0) · hk + 1
tk o(tkhk).
⋄2.4-6.
Let e1, . . . , en−1 ∈E be ﬁxed and f : U ⊂E →F be n times diﬀerentiable. Show that the map
g : U ⊂E →F deﬁned by g(u) = Dn−1f(u) · (e1, . . . , en−1) is diﬀerentiable and
Dg(u) · e = Dnf(u) · (e, e1, . . . , en−1).
⋄2.4-7.
(i) Prove the following reﬁnement of Proposition 2.4.14. If f is C1 and D1D2f(u) exists and is
continuous in u, then D2D1f(u) exists and these are equal.
(ii) The hypothesis in (i) cannot be weakened: show that the function
f(x, y) =

xy(x2−y2)
x2+y2
,
if (x, y) ̸= (0, 0);
0,
if (x, y) = (0, 0)
is C1, has ∂2f/∂x∂y, ∂2f/∂y∂x continuous on R2/{(0, 0)}, but that ∂2f(0, 0)/∂x∂y ̸= ∂2f(0, 0)/∂y∂x.
⋄2.4-8.
For f : U ⊂E →F, show that the second tangent map is given as follows:
T 2f : (U × E) × (E × E) →(F × F) × (F × F)(u, e1, e2, e3)
→(f(u), Df(u) · e1, Df(u) · e2,
D2f(u) · (e1, e2) + Df(u) · e3).
⋄2.4-9.
Let f : R2 →R be deﬁned by f(x, y) = 2x2y/(x4 + y2) if (x, y) ̸= (0, 0) and 0 if (x, y) = (0, 0).
Show that
(i) f is discontinuous at (0, 0), hence is not diﬀerentiable at (0, 0);
(ii) all directional derivatives exist at (0, 0); that is, f is Gˆateaux diﬀerentiable.

100
2. Banach Spaces and Diﬀerential Calculus
⋄2.4-10 (Diﬀerentiating sequences).
Let fn : U ⊂E →F be a sequence of Cr maps, where E and F are
Banach spaces. If {fn} converges pointwise to f : U →F and if {Djfn}, 0 ≤j ≤r, converges locally
uniformly to a map gj : U →Lj
s(E, F), then show that f is Cr, Djf = gj and {fn} converges locally
uniformly to f.
Hint: For r = 1 use the mean value inequality and continuity of g1 to conclude that
∥f(u + h) −f(u) −g1(u) · h∥≤∥f(u + h) −fn(u + h) −[f(u) −fn(u)]∥
+ ∥fn(u + h) −fn(u) −Dfn(u) · h∥
+ ∥Dfn(u) · h −g1(u) · h∥
≤e∥h∥.
For general r use the converse to Taylor’s theorem.
⋄2.4-11 (α Lemma).
In the context of Lemma 2.4.18 let α(g) = g ◦f. Show that α is continuous linear and
hence is C∞.
⋄2.4-12.
Consider the map Φ : C1([0, 1]) →C0([0, 1]) given by Φ(f)(x) = exp[f ′(x)]. Show that Φ is C∞
and compute DΦ.
⋄2.4-13 ( Whitney [1943a]).
Let f : U ⊂E →F be of class Ck+p with Taylor expansion
f(b) = f(a) + Df(a) · (b −a) + · · · + 1
k!Dkf(a) · (b −a)k
+
	 1
0
(1 −t)k−1
(k −1)! [Dkf((1 −t)a + tb) −Dkf(a)] dt

· (b −a)k.
(i)
Show that the remainder Rk(a, b) is Ck+p for b ̸= a and Cp for a, b ∈E. If E = F = R, Rk(a, a) = 0,
and
lim
b→a(|b −a|iDi+pRk(a, b)) = 0,
1 ≤i ≤k.
(For generalizations to Banach spaces, see Tuan and Ang [1979].)
(ii)
Show that the conclusion in (i) cannot be improved by considering f(x) = |x|k+p+1/2.
⋄2.4-14 ( Whitney [1943b]).
Let f : R →R be an even (resp., odd) function; that is, f(x) = f(−x) (resp.,
f(x) = −f(−x)).
(i)
Show that f(x) = g(x2) (resp., f(x) = xg(x2)) for some g.
(ii)
Show that if f is C2k (resp., C2k+1) then g is Ck
Hint: Use the converse to Taylor’s theorem.
(iii)
Show that (ii) is still true if k = ∞.
(iv)
Let f(x) = |x|2k+1+1/2 to show that the conclusion in (ii) cannot be sharpened.
⋄2.4-15 (Buchner, Marsden, and Schecter [1983b]).
Let E = L4([0, 1]) and let ϕ : R →R be a C∞function
such that ϕ′(λ) = 1, if −1 ≤λ ≤1 and ϕ′(λ) = 0, if |λ| ≥2. Assume ϕ is monotone increasing with ϕ = −M
for λ ≤−2 and ϕ = M for λ ≥2. Deﬁne the map h : E →R by
h(u) = 1
3
	 1
0
ϕ([u(x)]3) dx.

2.5 The Inverse and Implicit Function Theorems
101
(i)
Show that h is C3 using the converse to Taylor’s theorem.
Hint: Let ψ(λ) = ϕ(λ3), write out Taylor’s theorem for r = 3 for ψ(λ), and plug in u(x) for λ.
(ii)
The formal L2 gradient of h (i.e., the functional derivative δh/δu) is given by
∇h(u) = 1
3ψ′(u),
where ψ(λ) = ϕ(λ3). Show that ∇h : E →E is C0 but is not C1.
Hint: Its derivative would be v →ψ′′(u)v/3. Let a ∈[0, 1] be such that ϕ′′(a)/3 ̸= 0 and let un = a
on [0, 1/n], un = 0 elsewhere; vn = nexc:1.4−27 on [0, 1/n], vn = 0 elsewhere. Show that in L4([0, 1]),
un →0, ∥vn∥= 1, ψ′′(un) · vn does not converge to 0, but ψ′′(0) = 0. Using the same method, show h
is not C4 on L4([0, 1]).
(iii)
Show: if q is a positive integer and E = Lq([0, 1]), then h is Cq−1 but is not Cq.
(iv)
Let
f(u) = 1
2
	 1
0
|u(x)|2 dx + h(u)
Show that on L4([0, 1]), f has a formally non-degenerate critical point at 0 (i.e., D2f(0) deﬁnes an
isomorphism of L2([0, 1])), yet this critical point is not isolated.
Hint: Consider the function un = −1 on [0, 1/n]; 0 on ]1/n, 1]. This exercise is continued in Exer-
cise 5.4-8.
⋄2.4-16.
Let E be the space of maps A : R3 →R3 with A(x) →0 as x →0 suﬃciently rapidly. Let
f : E →R and show
δ
δAf(curl A) = curl δf
δA.
Hint: Specify whatever smoothness and fall-oﬀhypotheses you need; use A·curl B−B·curl A = div(B×A),
the divergence theorem, and the chain rule.
⋄2.4-17.
(i)
Let E = { B | B is a vector ﬁeld on R3 vanishing at ∞and such that div B = 0 } and pair E
with itself via ⟨B, B′⟩=

B(x)·B′(x) dx. Compute δF/δB, where F is deﬁned by F = (1/2)

∥B∥2d3x.
(ii)
Let E = { B | B is a vector ﬁeld on R3 vanishing at ∞such that B = ∇× A for some A } and let
F = { A′ | A′ is a vector ﬁeld on R3, div A′ = 0 }
with the pairing ⟨B, A′⟩=

A·A′d3x. Show that this pairing is well deﬁned. Compute δF/δB, where
F is as in (i) . Why is your answer diﬀerent?
2.5
The Inverse and Implicit Function Theorems
The inverse and implicit function theorems are pillars of nonlinear analysis and geometry, so we give them
special attention in this section. Throughout, E, F, . . . , are assumed to be Banach spaces. In the ﬁnite-
dimensional case these theorems have a long and complex history; the inﬁnite-dimensional version is appar-
ently due to Hildebrandt and Graves [1927].

102
2. Banach Spaces and Diﬀerential Calculus
The Inverse Function Theorem.
This theorem states that if the linearization of the equation f(x) = y
is uniquely invertible, then locally so is f; that is, we can uniquely solve f(x) = y for x as a function of y.
To formulate the theorem, the following terminology is useful.
2.5.1 Deﬁnition.
A map f : U ⊂E →V ⊂F, where U and V are open subsets of E and F respectively,
is a Cr diﬀeomorphism if f is of class Cr, is a bijection (i.e., f is one-to-one and onto from U to V ),
and f −1 is also of class Cr.
The example f(x) = x3 shows that a map can be smooth and bijective, but its inverse need not be smooth.
A theorem guaranteeing a smooth inverse is the following.
2.5.2 Theorem (Inverse Mapping Theorem).
Let f : U ⊂E →F be of class Cr, r ≥1, x0 ∈U, and
suppose that Df(x0) is a linear isomorphism. Then f is a Cr diﬀeomorphism of some neighborhood of x0
onto some neighborhood of f(x0) and, moreover, the derivative of the inverse function is given by
Df −1(y) = [Df(f −1(y))]−1
for y in this neighborhood of f(x0).
Although our immediate interest is the ﬁnite-dimensional case, for Banach spaces it is good to keep in
mind the Banach isomorphism theorem: If T : E →F is linear, bijective, and continuous, then T −1 is
continuous. (See Theorem 2.2.19.)
Proof of the Inverse Function Theorem.
To prove the theorem, we assemble a few lemmas. First
recall the contraction mapping principle from §1.2.
2.5.3 Lemma.
Let M be a complete metric space with distance function d : M ×M →R. Let F : M →M
and assume there is a constant λ, 0 ≤λ < 1, such that for all x, y ∈M,
d(F(x), F(y)) ≤λd(x, y).
Then F has a unique ﬁxed point x0 ∈M; that is, F(x0) = x0.
This result is the basis of many important existence theorems in analysis. The other fundamental ﬁxed
point theorem in analysis is the Schauder ﬁxed point theorem, which states that a continuous map of a
compact convex set (in a Banach space, say) to itself, has a ﬁxed point—not necessarily unique, however.
2.5.4 Lemma.
The set GL(E, F) of linear isomorphisms from E to F is open in L(E, F).
Proof.
We can assume E = F. Indeed, if ϕ0 ∈GL(E, F), the linear map ψ →ϕ−1
0
◦ψ from L(E, F) to
L(E, E) is continuous and GL(E, F) is the inverse image of GL(E, E). Let
∥α∥= sup
e∈E
∥e∥=1
∥α(e)∥
be the operator norm on L(E, F) relative to given norms on E and F. For ϕ ∈GL(E, E), we need to prove
that ψ suﬃciently near ϕ is also invertible. We will show that
∥ψ −ϕ∥< ∥ϕ−1∥−1
implies ψ ∈GL(E, E). The key is that ∥· ∥is an algebra norm. That is,
∥β ◦α∥≤∥β∥∥α∥
for α ∈L(E, E) and β ∈L(E, E) (see §2.2). Since
ψ = ϕ ◦(I −ϕ−1 ◦(ϕ −ψ)),

2.5 The Inverse and Implicit Function Theorems
103
ϕ is invertible, and our norm assumption shows that
∥ϕ−1 ◦(ϕ −ψ)∥< 1,
it is suﬃcient to show that I −ξ is invertible whenever ∥ξ∥< 1. (I is the identity operator.) Consider the
following sequence called the Neumann series:
ξ0 = I,
ξ1 = I + ξ,
ξ2 = I + ξ + ξ ◦ξ,
...
ξn = I + ξ + ξ ◦ξ + · · · + (ξ ◦ξ ◦· · · ◦ξ).
Using the triangle inequality and ∥ξ∥< 1, we can compare this sequence to the sequence of real numbers,
1, 1 + ∥ξ∥, 1 + ∥ξ∥+ ∥ξ∥2, . . . , which is a Cauchy sequence since the geometric series ∞
n=0 ∥ξ∥n converges.
Because L(E, E) is complete, ξn is a convergent sequence. The limit, say ρ, is the inverse of I −ξ because
(I −ξ)ξn = I −(ξ ◦ξ ◦· · · ◦ξ), so letting n →∞, we get (I −ξ)ρ = I.
■
2.5.5 Lemma.
Let I : GL(E, F) →GL(F, E) be given by ϕ →ϕ−1. Then I is of class C∞and
DI(ϕ) · ψ = −ϕ−1 ◦ψ ◦ϕ−1.
(For DrI, see Supplement 2.5E.)
Proof.
We may assume GL(E, F) ̸= ∅. We claim that I is diﬀerentiable and that DI(ϕ) · ψ = −ϕ−1 ◦
ψ ◦ϕ−1, then it will follow from Leibniz’ rule that I is of class C∞. Indeed DI = B(I, I) where B ∈
L2(L(F, E); L(L(E, F), L(F, E))) is deﬁned by B(ψ1, ψ2)(A) = −ψ1 ◦A ◦ψ2, where ψ1, ψ2 ∈L(F, E) and
A ∈L(E, F), which shows inductively that if I is Ck then it is Ck+1.
To show our claim that I is diﬀerentiable, we use the deﬁnition of diﬀerentiability. Since the map ψ →
−ϕ−1 ◦ψ ◦ϕ−1 is linear (ψ ∈L(E, F)), we must show that
lim
ψ→ϕ
∥ψ−1 −(ϕ−1 −ϕ−1 ◦ψ ◦ϕ−1 + ϕ−1 ◦ϕ ◦ϕ−1)∥
∥ψ −ϕ∥
= 0.
Note that
ψ−1 −(ϕ−1 −ϕ−1 ◦ψ ◦ϕ−1 + ϕ−1 ◦ϕ ◦ϕ−1)
= ψ−1 −2ϕ−1 + ϕ−1 ◦ψ ◦ϕ−1
= ψ−1 ◦(ψ −ϕ) ◦ϕ−1 ◦(ψ −ϕ) ◦ϕ−1.
Again, using ∥β ◦α∥≤∥α∥∥β∥for α ∈L(E, F) and β ∈L(F, G), we get
∥ψ−1 ◦(ψ −ϕ) ◦ϕ−1 ◦(ψ −ϕ) ◦ϕ−1∥≤∥ψ−1∥∥ψ −ϕ∥2∥ϕ−1∥2.
With this inequality, the limit is clearly zero.
■
Proof of the Inverse Mapping Theorem.
We claim that it is enough to prove it under the simplifying
assumptions x0 = 0, f(x0) = 0, E = F, and Df(0) is the identity. Indeed, replace f by
h(x) = Df(x0)−1 ◦[f(x + x0) −f(x0)].
Let g(x) = x−f(x) so Dg(0) = 0. Choose r > 0 so that ∥x∥≤r implies ∥Dg(x)∥≤1/2, which is possible
by continuity of Dg. Thus, by the mean value inequality, ∥x∥≤r implies ∥g(x)∥≤r/2. Let
Bε(0) = { x ∈E | ∥x∥≤e }.

104
2. Banach Spaces and Diﬀerential Calculus
For y ∈Br/2(0), let gy(x) = y + g(x). If y ∈Br/2(0) and x1, x2 ∈Br(0), then ∥y∥≤r/2 and ∥g(x)∥≤r/2,
so
∥gy(x)∥≤∥y∥+ ∥g(x)∥≤r,
(i)
and, by the mean value inequality,
∥gy(x1) −gy(x2)∥≤∥x1 −x2∥
2
.
(ii)
This shows that for y in the ball of radius r/2, gy maps the closed ball (a complete metric space) of radius
r to itself and is a contraction. Thus by the contraction mapping theorem (Lemma 2.5.3), gy has a unique
ﬁxed point x in Br(0). This point x is the unique solution of f(x) = y. Thus f has an inverse
f −1 : V0 = Dr/2(0) →U0 = f −1(Dr/2(0)) ⊂Dr(0).
From (ii) with y = 0, we have ∥(x1 −f(x1)) −(x2 −f(x2))∥≤∥x1 −x2∥/2, and so
∥x1 −x2∥−∥f(x1) −f(x2)∥≤∥x1 −x2∥
2
,
that is,
∥x1 −x2∥≤2∥f(x1) −f(x2)∥.
Thus we have
∥f −1(y1) −f −1(y2)∥≤2∥y1 −y2∥,
(iii)
so f −1 is continuous.
From Lemma 2.5.4 we can choose r small enough so that Df(x)−1 exists for x ∈Dr(0). Moreover, by
continuity, ∥Df(x)−1∥≤M for some M and all x ∈Dr(0) can be assumed as well. If y1, y2 ∈Dr/2(0),
x1 = f −1(y1), and x2 = f −1(y2), then
∥f −1(y1) −f −1(y2) −Df(x2)−1 · (y1 −y2)∥
= ∥x1 −x2 −Df(x2)−1 · [f(x1) −f(x2)]∥
= ∥Df(x2)−1 · {Df(x2) · (x1 −x2) −f(x1) + f(x2)}∥
≤M∥f(x1) −f(x2) −Df(x2) · (x1 −x2)∥.
This, together with (iii), shows that f −1 is diﬀerentiable with derivative Df(x)−1 at f(x); that is, D(f −1) =
I ◦Df ◦f −1 on V0 = Dr/2(0). This formula, the chain rule, and Lemma 2.5.5 show inductively that if f −1
is Ck−1 then f −1 is Ck for 1 ≤k ≤r.
■
This argument also proves the following: if f : U →V is a Cr homeomorphism where U ⊂E and V ⊂F
are open sets, and Df(u) ∈GL(E, F) for u ∈U, then f is a Cr diﬀeomorphism.
For a Lipschitz inverse function theorem see Exercise 2.5-11.
Supplement 2.5A
The Size of the Neighborhoods
in the Inverse Mapping Theorem
An analysis of the preceding proof also gives explicit estimates on the size of the ball on which f(x) = y is
solvable. Such estimates are sometimes useful in applications. The easiest one to use in examples involves
estimates on the second derivative.2
2We thank M. Buchner for his suggestions concerning this supplement.

2.5 The Inverse and Implicit Function Theorems
105
2.5.6 Proposition.
Suppose f : U ⊂E →F is of class Cr, r ≥2, x0 ∈U, and Df(x0) is an isomorphism.
Let
L = ∥Df(x0)∥
and
M = ∥Df(x0)−1∥.
Assume
∥D2f(x)∥≤K
for ∥x −x0∥≤R and BR(x0) ⊂U.
Let
P = min

1
2KM , R

,
Q = min

1
2NL, P
M , P

,
and
S = min

1
2KM , Q
2L, Q

.
Here N = 8M 3K. Then f maps an open set G ⊂DP (x0) diﬀeomorphically onto DP/2M(y0) and f −1 maps
an open set H ⊂DQ(y0) diﬀeomorphically onto DQ/2L(x0). Moreover, BQ/2L(x0) ⊂G ⊂DP (x0) and
BS/2M(y0) ⊂H ⊂DQ(y0) ⊂DP/2M(y0). See Figure 2.5.1.
Proof.
We can assume x0 = 0 and f(x0) = 0. From
Df(x) = Df(0) =
	 1
0
D(Df(tx)) · x dt
= Df(0) ·

I + [Df(0)]−1 ·
	 1
0
D2f(tx) · x dt

and the fact that
∥(I + A)−1∥≤1 + ∥A∥+ ∥A∥2 + · · · =
1
1 −∥A∥
for ∥A∥< 1 (see the proof of Lemma 2.5.5), we get
∥Df(x)−1∥≤2M
if ∥x∥≤R and ∥x∥≤
1
2MK ,
that is, if ∥x∥≤P.
As in the proof of the inverse function theorem, let gy(x) = [Df(0)]−1 · (y + Df(0)x −f(x)). Write
ϕ(x) = Df(0) · x −f(x)
=
	 1
0
Dϕ(sx) · x ds
= −
	 1
0
	 1
0
D2f(tsx) · (sx, x) dt ds
to obtain gy(x) = [Df(0)−1] · (y + ϕ(x)), ∥ϕ(x)∥≤K∥x∥2 if ∥x∥≤P, and
∥gy(x)∥≤M(∥y∥+ K∥x∥2).

106
2. Banach Spaces and Diﬀerential Calculus
G
H
DP (x0)
DQ/2L(x0)
DP/2M(y0)
DQ(y0)
DS/2M(y0)
x0
y0
Figure 2.5.1. Regions for the proof of the inverse mapping theorem
Hence for ∥y∥≤P/2M, gy maps BP (0) to BS(0). Similarly we get ∥gy(x1) −gy(x2)∥≤∥x1 −x2∥/2 from
the mean value inequality and the estimate
∥Dgy(x)∥= ∥Df(0)−1∥

	 1
0
D2f(tx)x dt


≤M(K∥x∥) ≤1
2
if ∥x∥≤P. Thus, as in the previous proof, f −1 : BP/2M(0) →BP (0) is deﬁned and there exists an open set
G ⊂BP (0) diﬀeomorphic via f to the open ball DP/2M(0).
Taking the second derivative of the relation f −1 ◦f = identity on G, we get
D2f −1(f(x))(Df(x) · u1, Df(x) · u2) + Df −1(f(x)) · D2f(x)(u1, u2) = 0
for any u1, u2 ∈E. Let vi = Df(x) · ui, i = 1, 2, so that
D2f −1(f(x)) · (v1, v2) = −Df −1(f(x)) · D2f(x)(Df(x)−1 · v1,
Df(x)−1 · v2)
and hence
D2f −1(f(x))(v1, v2)
 ≤
Df −1(f(x))
3 D2f(x)
 ∥v1∥∥v2∥
≤8M 3K ∥v1∥∥v2∥
since x ∈G ⊂DP (0) and on BP (0) we have the inequality ∥Df(x)−1∥≤2M. Thus on BP/2M(0) the
following estimate holds:
∥D2f −1(y)∥≤8M 3K.
By the previous argument with f replaced by f −1, R by P/2M, L by M, and K by N = 8M 3K, it follows
that there is an open set H ⊂DQ(0), Q = min{1/2KM, Q/2L, Q} such that f −1 : H →DQ/2L(0) is a
diﬀeomorphism. Since f −1 is a diﬀeomorphism on BQ(0) and H is one of its open subsets, it follows that
BQ/2L(0) ⊂G.
Finally, replacing R by Q/2L, we conclude the existence of a ball BS/2M(0), where S = min{1/2KM, Q/2L, Q},
on which f −1 is a diﬀeomorphism. Therefore BS/2M(0) ⊂H.
■

2.5 The Inverse and Implicit Function Theorems
107
Implicit Function Theorem.
In the study of manifolds and submanifolds, the argument used in the
following is of central importance.
2.5.7 Theorem (Implicit Function Theorem).
Let U ⊂E, V ⊂F be open and f : U × V →G be Cr,
r ≥1. For some x0 ∈U, y0 ∈V assume the partial derivative in the second slot D2f(x0, y0) : F →G,
is an isomorphism. Then there are neighborhoods U0 of x0 and W0 of f(x0, y0) and a unique Cr map
g : U0 × W0 →V such that for all (x, w) ∈U0 × W0,
f(x, g(x, w)) = w.
Proof.
Deﬁne the map
Φ : U × V →E × G
by (x, y) →(x, f(x, y)). Then DΦ(x0, y0) is given by
DΦ(x0, y0) · (x1, y1) =

I
0
D1f(x0, y0)
D2f(x0, y0)
 
x1
y1

which is an isomorphism of E × F with E × G. Thus, Φ has a unique Cr local inverse, say Φ−1 : U0 × W0 →
U × V , (x, w) →(x, g(x, w)). The g so deﬁned is the desired map.
■
Applying the chain rule to the relation f(x, g(x, w)), one can compute the derivatives of g:
D1g(x, w) = −[D2f(x, g(x, w))]−1 ◦D1f(x, g(x, w)),
D2g(x, w) = [D2f(x, g(x, w))]−1.
2.5.8 Corollary.
Let U ⊂E be open and f : U →F be Cr, r ≥1. Suppose Df(x0) is surjective and
ker Df(x0) is complemented. Then f(U) contains a neighborhood of f(x0).
Proof.
Let E1 = kerDf(x0) and E = E1 ⊕E2. Then D2f(x0) : E2 →F is an isomorphism, so the
hypotheses of Theorem 2.5.7 are satisﬁed and thus f(U) contains W0 provided by that theorem.
■
Local Surjectivity Theorem.
Since in ﬁnite-dimensional spaces every subspace splits, the foregoing
corollary implies that if f : U ⊂Rn →Rm, n ≥m, and the Jacobian of f at every point of U has rank m,
then f is an open mapping. This statement generalizes directly to Banach spaces, but it is not a consequence
of the implicit function theorem anymore, since not every subspace is split. This result goes back to Graves
[1950]. The proof given in Supplement 2.5B follows Luenberger [1969].
2.5.9 Theorem (Local Surjectivity Theorem).
If f : U ⊂E →F is C1 and Df(u0) is onto for some
u0 ∈U, then f is locally onto; that is, there exist open neighborhoods U1 of u0 and V1 of f(u0) such that
f|U1 : U1 →V1 is onto. In particular, if Df(u) is onto for all u ∈U, then f is an open mapping.
Supplement 2.5B
Proof of the Local Surjectivity Theorem
Proof.
Recall from §2.1 that E/ ker Df(u0) = E0 is a Banach space with norm ∥[x]∥= inf{ ∥x + u∥| u ∈
kerDf(u0) }, where [x] is the equivalence class of x. To solve f(x) = y we set up an iteration scheme in E0
and E simultaneously. Now Df(u0) induces an isomorphism T : E0 →F, so T −1 ∈L(F, E0) exists by the
Banach isomorphism theorem. Let x = u0 + h and write f(x) = y as
T −1(y −f(u0 + h)) = 0.

108
2. Banach Spaces and Diﬀerential Calculus
To solve this equation, deﬁne a sequence Ln ∈E/ ker Df(u0) (so the element Ln is a coset of ker Df(u0))
and hn ∈Ln ⊂E inductively by L0 = ker Df(u0), h0 ∈L0 small, and
Ln = Ln−1 + T −1(y −f(u0 + hn−1)),
(2.5.1)
and selecting hn ∈Ln such that
∥hn −hn−1∥≤2∥Ln −Ln−1∥.
(2.5.2)
The latter is possible since
∥Ln −Ln−1∥= inf{ ∥h −hn−1∥| h ∈Ln }.
Since hn−1 ∈Ln−1, Ln−1 = T −1(Df(u0) · hn−1), so
Ln = T −1(y −f(u0 + hn−1) + Df(u0) · hn−1).
Subtracting this from the expression for Ln−1 gives
Ln −Ln−1 = −T −1(f(u0 + hn−1) −f(u0 + hn−2)
−Df(u0) · (hn−1 −hn−2)).
For ε > 0 given, there is a neighborhood U of u0 such that
∥Df(u) −Df(u0)∥< ε
for u ∈U, since f is C1. Assume inductively that u0 + hn−1 ∈U and u0 + hn−2 ∈U. Then from the mean
value inequality,
∥Ln −Ln−1∥≤ε∥T −1∥∥hn−1 −hn−2∥.
(2.5.3)
By equation (2.5.2),
∥hn −hn−1∥≤2∥Ln −Ln−1∥≤2ε∥T −1∥∥hn−1 −hn−2∥.
Thus if ε is small,
∥hn −hn−1∥≤1
2∥hn−1 −hn−2∥.
Starting with h0 small and ∥h1 −h0∥< (1/2)∥h0∥, u0 + hn remain inductively in U since
∥hn∥≤∥h0∥+ ∥h1 −h0∥+ ∥h2 −h1∥+ · · · + ∥hn −hn−1∥
≤

1 + 1
2 + · · · +
1
2n−1

∥h0∥≤2∥h0∥.
It follows that hn is a Cauchy sequence, so it converges to some point, say h. Correspondingly, Ln converges
to L and h ∈L. Thus from equation (2.5.1), 0 = T −1(y −f(u0 + h)) and so y = f(u0 + h).
■
The local surjectivity theorem shows that for y near y0 = f(u0), f(x) = y has a solution. If there is a
solution g(y) = x which is C1, then Df(x0) ◦Dg(y0) = I and so range Dg(y0) is an algebraic complement
to ker Df(x0). It follows that if range Dg(y0) is closed, then ker Df(x0) is split.
In many applications to nonlinear partial diﬀerential equations, methods of functional analysis and elliptic
operators can be used to show that ker Df(x0) does split, even in Banach spaces. Such a splitting theorem
is called the Fredholm alternative. For illustrations of this idea in geometry and relativity, see Fischer and
Marsden [1975, 1979], and in elasticity, see Chapter 6 of Marsden and Hughes [1983]. For such applications,
Corollary 2.5.8 often suﬃces.

2.5 The Inverse and Implicit Function Theorems
109
Local Injectivity Theorem.
The locally injective counterpart of this theorem is the following.
2.5.10 Theorem (Local Injectivity Theorem).
Let f : U ⊂E →F be a C1 map, Df(u0)(E) be closed
in F, and Df(u0) ∈GL(E, Df(u0)(E)). Then there exists a neighborhood V of u0, V ⊂U, on which f is
injective. The inverse f −1 : f(V ) →U is Lipschitz continuous.
Proof.
Since (Df(u0))−1 ∈L(Df(u0)(E), E), there is a constant M > 0 such that ∥Df(u0) · e∥≥M∥e∥
for all e ∈E. By continuity of Df, there exists r > 0 such that ∥Df(u) −Df(u0)∥< M/2 whenever
∥u −u0∥< 3r. By the mean value inequality, for e1, e2 ∈Dr(u0)
∥f(e1) −f(e2) −Df(u0)(e1 −e2)∥
≤sup
t∈[0,1]
∥Df(e1 + t(e2 −e1)) −Df(u0)∥∥e1 −e2∥
≤M∥e1 −e2∥
2
since ∥u0 −e1 −t(e2 −e1)∥< 3r. Thus
M∥e1 −e2∥≤∥Df(u0) · (e1 −e2)∥≤∥f(e1) −f(e2)∥+ M
2 ∥e1 −e2∥;
that is,
M
2 ∥e1 −e2∥≤∥f(e1) −f(e2)∥,
which proves that f is injective on Dr(u0) and that f −1 : f(Dr(u0)) →U is Lipschitz continuous.
■
Notice that this proof is done by direct estimates, and not by invoking the inverse or implicit function
theorem. If, however, the range space Df(u0)(E) splits, one could alternatively prove results like this by
composing f with the projection onto this range and applying the inverse function theorem to the compo-
sition. In the following paragraphs on local immersions and submersions, we examine this point of view in
detail.
Application to Diﬀerential Equations.
We now give an example of the use of the implicit function
theorem to prove an existence theorem for diﬀerential equations. For this and related examples, we choose
the spaces to be inﬁnite dimensional. In fact, E, F, G, · · · will be suitable spaces of functions. The map f
will often be a nonlinear diﬀerential operator. The linear map Df(x0) is called the linearization of f about
x0. (Phrases like “ﬁrst variation,” “ﬁrst-order deformation,” and so forth are also used.)
2.5.11 Example.
Let E be the space of all C1-functions f : [0, 1] →R with the norm
∥f∥1 = sup
x∈[0,1]
|f(x)| + sup
x∈[0,1]

df(x)
dx

and F the space of all C0-functions with the norm ∥f∥0 = supx∈[0,1] |f(x)|. These are Banach spaces (see
Exercise 2.1-3). Let Φ : E →F be deﬁned by Φ(f) = df/dx + f 3. It is easy to check that Φ is C∞and
DΦ(0) = d/dx : E →F. Clearly DΦ(0) is surjective (fundamental theorem of calculus). Also ker DΦ(0)
consists of E1 = all constant functions. This is complemented because it is ﬁnite dimensional; explicitly, a
complement consists of functions with zero integral. Thus, Corollary 2.5.8 yields the following:
There is an ε > 0 such that if g : [0, 1] →R is a continuous function with |g(x)| < ε, then there is a C1
function f : [0, 1] →R such that
df
dx + f 3(x) = g(x).
♦

110
2. Banach Spaces and Diﬀerential Calculus
Supplement 2.5C
An Application of the Inverse Function Theorem
to a Nonlinear Partial Diﬀerential Equation
Let Ω⊂Rn be a bounded open set with smooth boundary. Consider the problem
∇2ϕ + ϕ3 = f
in Ω,
ϕ + ϕ7 = g
on ∂Ω
for given f and g. We claim that for f and g small, this problem has a unique small solution. For partial
diﬀerential equations of this sort one can use the Sobolev spaces Hs(Ω, R) consisting of maps ϕ : Ω→R
whose ﬁrst s distributional derivatives lie in L2. (One uses Fourier transforms to deﬁne this space if s is not
an integer.) In the Sobolev spaces E = Hs(Ω, R), F = Hs−2(Ω, R) × Hs−1/2(∂Ω, R), if s > n/2 the map
Φ : E →F,
ϕ →(∇2ϕ + ϕ3, (ϕ + ϕ7)|∂Ω)
is C∞(use Supplement 2.4B) and the linear operator
DΦ(0) · ϕ = (∇2ϕ, ϕ|∂Ω)
is an isomorphism. The fact that DΦ(0) is an isomorphism is a result on the solvability of the Dirichlet
problem from the theory of elliptic linear partial diﬀerential equations. See, for example, Friedman [1969].
(In the Ck spaces, DΦ(0) is not an isomorphism.) The result claimed above now follows from the inverse
function theorem.
Local Immersions and Submersions.
The following series of consequences of the inverse function
theorem are important technical tools in the study of manifolds. The ﬁrst two results give, roughly speaking,
suﬃcient conditions to “straighten out” the range (respectively, the domain) of f in a neighborhood of a
point, thus making f look like an inclusion (respectively, a projection).
2.5.12 Theorem (Local Immersion Theorem).
Let f : U ⊂E →F be of class Cr, r ≥1, u0 ∈U and
suppose that Df(u0) is one-to-one and has a closed split image F1 with closed complement F2. (If E = Rm
and F = Rn, assume only that Df(u0) has trivial kernel.) Then there are two open sets U ′ ⊂F and
V ⊂E ⊕F2, where f(u0) ∈U ′ and a Cr diﬀeomorphism ϕ : U ′ →V such that (ϕ ◦f)(e) = (e, 0) for all
e ∈V ∩(E × {0}) ⊂E.
The intuition for E = F1 = R2, F2 = R (i.e., m = 2, n = 3 ) is given in Figure 2.5.2. The function
ϕ ﬂattens out the image of f. Notice that this is intuitively correct; we expect the range of f to be an
m-dimensional “surface” so it should be possible to ﬂatten it to a piece of Rm. Note that the range of a
linear map of rank m is a linear subspace of dimension exactly m, so this result expresses, in a sense, a
generalization of the linear case. Also note that Theorem 2.5.10, the local injectivity theorem, follows from
the more restrictive hypotheses of Theorem 2.5.12.
Proof.
Deﬁne g : U ×F2 ⊂E×F2 →F = F1 ⊕F2 by g(u, v) = f(u)+(0, v) and note that g(u, 0) = f(u).
Now
Dg(u0, 0) = (Df(u0), IF2) ∈GL(E ⊕F2, F)
by the Banach isomorphism theorem. Here, IF2 denotes the identity mapping of F2 and for A ∈L(E, F)
and B ∈L(E′, F′), the element (A, B) ∈L(E ⊕E′, F ⊕F′) is deﬁned by (A, B)(e, e′) = (Ae, Be′). By the
inverse function theorem there exist open sets U ′ and V such that (u0, 0) ∈V ⊂E ⊕F2, and g(u0, 0) =
f(u0) ∈U ′ ⊂F and a Cr diﬀeomorphism ϕ : U ′ →V such that ϕ−1 = g|V . Hence for (e, 0) ∈V ,
(ϕ ◦f)(e) = (ϕ ◦g)(e, 0) = (e, 0).
■

2.5 The Inverse and Implicit Function Theorems
111
E
F1
E
U
u0
F2
F2
V
U'
f(u0)
f
ϕ
Figure 2.5.2. The local immersion theorem
2.5.13 Theorem (Local Submersion Theorem).
Let f : U ⊂E →F be of class Cr, r ≥1, u0 ∈U and
suppose Df(u0) is surjective and has split kernel E2 with closed complement E1. (If E = Rm and F = Rn,
assume only that rank (Df(u0)) = n.) Then there are open sets U ′ and V such that u0 ∈U ′ ⊂U ⊂E and
V ⊂F ⊕E2 and a Cr diﬀeomorphism ψ : V →U ′ with the property that (f ◦ψ)(u, v) = u for all (u, v) ∈V .
                                                  F
E1
F
E2
E2
f
U'
f = constant
u0
ψ
V
f ˚ ψ = constant
Figure 2.5.3. A submersion theorem
The intuition for the special case E1 = E2 = F = R is given in Figure 2.5.3, which should be compared
to Figure 2.5.2. Note that this theorem implies the results of Theorem 2.5.9, the local surjectivity theorem,
but the hypotheses are more stringent.
Proof.
By the Banach isomorphism theorem (§2.2), D1f(u0) ∈GL(E1, F). Deﬁne the map
g : U ⊂E1 ⊕E2 →F ⊕E2
by g(u1, u2) = (f(u1, u2), u2) and note that
Dg(u0) · (e1, e2) =

D1f(u0)
D2f(u0)
0
IE2
 
e1
e2


112
2. Banach Spaces and Diﬀerential Calculus
so that Dg(u0) ∈GL(E, F ⊕E2). By the inverse function theorem there are open sets U ′ and V such that
u0 ∈U ′ ⊂U ⊂E, V ⊂F ⊕E2 and a Cr diﬀeomorphism ψ : V →U ′ such that ψ−1 = g|U ′. Hence if
(u, v) ∈V ,
(u, v) = (g ◦ψ)(u, v) = (f(ψ(u, v)), ψ2(u, v)),
where ψ = ψ1 × ψ2; that is, ψ2(u, v) = v and (f ◦ψ)(u, v) = u.
■
Local Representation and Rank Theorems.
We now give two results that extend the above results
on the local structure of maps.
2.5.14 Theorem (Local Representation Theorem).
Let f : U ⊂E →F be of class Cr, r ≥1, u0 ∈U
and suppose Df(u0) has closed split image F1 with closed complement F2 and split kernel E2 with closed
complement E1. (If E = Rm, F = Rn, assume that rank(Df(u0)) = k, k ≤n, k ≤m, so that F2 = Rn−k,
F1 = Rk, E1 = Rk, E2 = Rm−k.) Then there are open sets U ′ and V with the property that u0 ∈U ′ ⊂U ⊂E,
V ⊂F1 ⊕E2 and a Cr diﬀeomorphism ψ : V →U ′ such that (f ◦ψ)(u, v) = (u, η(u, v)), where η : V →F2
is a Cr map satisfying Dη
)
ψ−1(u0)
*
= 0.
Proof.
Write f = f1 × f2, where fi : U →Fi, i = 1, 2. Then f1 satisﬁes the conditions of Theorem 2.5.13,
and thus there exists a Cr diﬀeomorphism ψ : V ⊂F1 ⊕E2 →U ′ ⊂E such that the composition f1 ◦ψ is
given by (f1 ◦ψ)(u, v) = u. Let η = f2 ◦ψ.
■
To use Theorem 2.5.12 (or Theorem 2.5.13) in ﬁnite dimensions, we must have the rank of Df equal to the
dimension of its domain space (or the range space). However, we can also use the inverse function theorem
to tell us that if Df(x) has constant rank k in a neighborhood of x0, then we can straighten out the domain
of f with some invertible function ψ such that f ◦ψ depends only on k variables. Then we can apply the
local immersion theorem (Theorem 2.5.12). This is the essence of the following theorem.
Roughly speaking, in ﬁnite dimensions, the rank theorem says that if Df has constant rank k on an open
set in Rm, then m −k variables are redundant and can be eliminated. As a simple example, if f : R2 →R is
deﬁned by setting f(x, y) = x−y, then Df has rank 1, and indeed, we can express f using just one variable,
namely, let ψ(x, y) = (x + y, y) so that (f ◦ψ)(x, y) = x, which depends only on x.
2.5.15 Theorem (Rank Theorem).
Let f : U ⊂E →F be of class Cr, r ≥1, u0 ∈U and suppose
Df(u0) has closed split image F1 with closed complement F2 and split kernel E2 with closed complement
E1. In addition, assume that for all u in a neighborhood of u0 ∈U, Df(u)(E) is a closed subspace of F and
Df(u)|E1 : E1 →Df(u)(E) is a Banach space isomorphism. (In case E = Rm and F = Rn, assume only
that rank(Df(u)) = k for u in a neighborhood of u0.) Then there exist open sets
U1 ⊂F1 ⊕E2,
U2 ⊂E,
V1 ⊂F,
and
V2 ⊂F
and there are Cr diﬀeomorphisms ϕ : V1 →V2 and ψ : U1 →U2 such that (ϕ ◦f ◦ψ)(x, e) = (x, 0).
The intuition is given by Figure 2.5.4 for E = R2, F = R2, and k = 1.
Remark.
It is clear that the theorem implies E1 ⊕ker(Df(u)) = E and Df(u)(E) ⊕F2 = F for u in a
neighborhood of u0 in U, because ϕ ◦f ◦ψ has these properties. These seemingly stronger conditions can
in fact be shown directly to be equivalent to the hypotheses in the theorem by the use of the openness of
GL(E, E) in L(E, E).
♦
Proof.
By the local representation theorem there is a Cr diﬀeomorphism ψ : U1 ⊂F1 ⊕E2 →U2 ⊂E
such that f(x, y) := (f ◦ψ)(x, y) = (x, η(x, y)). Let P1 : F →F1 be the projection. Since
Df(x, y) · (w, e) = (w, Dη(x, y) · (w, e)),

2.5 The Inverse and Implicit Function Theorems
113
f = constant
f
F1
V1
F2
F1
F2
F1
E2
E2
E1
ψ
ϕ ° f ° ψ
ϕ
V2
V1
U2
range of f
u0
f(u0)
Figure 2.5.4. The rank theorem
it follows that P1 ◦Df(x, y)(w, e) = (w, 0), for w ∈F1 and e ∈E2. In particular P1 ◦Df(x, y)|F1 ×{0} = I1,
the identity on F1, which shows that
Df(x, y)|F1 × {0} : F1 × {0} →Df(x, y)(F1 ⊕E2)
is injective. In ﬁnite dimensions this implies that it is an isomorphism, since dim(F1) = dim(Df(x, y)(F1 ⊕
E2)). In inﬁnite dimensions this is our hypothesis. Thus, we get
Df(x, y) ◦P1|Df(x, y)(F1 ⊕E2) = identity.
Let (w, Dη(x, y)(w, e)) ∈Df(x, y)(F1 ⊕E2). Since
(Df(x, y) ◦P1)(w, Dη(x, y) · (w, e)) = Df(x, y) · (w, 0)
= (w, Dη(x, y) · (w, 0))
= (w, D1η(x, y) · w),
we must have Dη(x, y)·e = 0 for all e ∈E2; that is, D2η(x, y) = 0. However, D2f(x, y)·e = (0, D2η(x, y)·e),
which says that D2f(x, y) = 0; that is, f does not depend on the variable y ∈E2. Deﬁne
f(x) = f(x, y) = (f ◦y)(x, y),
so f : P ′
1(V ) ⊂F1 →F where P ′
1 : F1 ⊕E2 →F1 is the projection. Now f satisﬁes the conditions of
Theorem 2.5.12 at P ′
1(ψ−1(u0)) and hence there exists a Cr diﬀeomorphism ϕ : V1 →V2, where V1, V2 ⊂F,
such that (ϕ ◦f)(z) = (z, 0); that is, we have (ϕ ◦f ◦ψ)(x, y) = (x, 0).
■
2.5.16 Example (Functional Dependence).
Let U ⊂Rn be an open set and let the functions f1, . . . , fn :
U →R be smooth. The functions f1, . . . , fn are said to be functionally dependent at x0 ∈U if there

114
2. Banach Spaces and Diﬀerential Calculus
is a neighborhood V of the point (f1(x0), . . . , fn(x0)) ∈Rn and a smooth function F : V →R such that
DF ̸= 0 on a neighborhood of (f1(x0), . . . , fn(x0)), and
F(f1(x), . . . , fn(x)) = 0
for all x in some neighborhood of x0. Show:
(i)
If f = (f1, · · · , fn) and f1, · · · , fn are functionally dependent at x0, then the determinant of Df,
denoted
Jf = ∂(f1, . . . , fn)
∂(x1, . . . , x1),
vanishes at x0.
(ii)
If
∂(f1, . . . , fn−1)
∂(x1, . . . , xn−1) ̸= 0
and
∂(f1, . . . , fn)
∂(x1, . . . , xn) = 0
on a neighborhood of x0, then f1, . . . , fn are functionally dependent, and fn = G(f1, . . . , fn−1) for
some G.
Solution.
(i) We have F ◦f = 0, so
DF(f(x)) ◦Df(x) = 0.
Now if Jf(x0) ̸= 0, Df(x) would be invertible in a neighborhood of x0, implying DF(f(x)) = 0. By the
inverse function theorem, this implies DF(y) = 0 on a whole neighborhood of f(x0).
(ii) The conditions of (ii) imply that Df has rank n −1. Hence by the rank theorem, there are mappings ϕ
and ψ such that
(ϕ ◦f ◦ψ)(x1, . . . , xn) = (x1, . . . , xn−1, 0).
Let F be the last component of ϕ . Then F(f1, . . . , fn) = 0. Since ϕ is invertible, DF ̸= 0.
It follows from the implicit function theorem that we can locally solve F(f1, . . . , fn) = 0 for fn =
G(f1, . . . , fn−1), provided we can show ∆= ∂F/∂yn ̸= 0. As we saw before, DF(f(x)) ◦Df(x) = 0,
or, in components with y = f(x),
 ∂F
∂y1
· · · ∂F
∂yn



∂f1
∂x1
· · ·
∂f1
∂xn
...
...
∂fn
∂x1
· · ·
∂fn
∂xn


= (0, 0, . . . , 0).
If ∂F/∂yn = 0, we would have
 ∂F
∂y1
, . . . ,
∂F
∂yn−1



∂f1
∂x1
· · ·
∂f1
∂xn−1
...
...
∂fn−1
∂x1
· · ·
∂fn−1
∂xn−1


= (0, 0, . . . , 0)

2.5 The Inverse and Implicit Function Theorems
115
i.e.,
 ∂F
∂y1
, . . . ,
∂F
∂yn−1

= (0, 0, . . . , 0)
since the square matrix is invertible by the assumption that
∂(f1, . . . , fn−1)
∂(x1, . . . , xn−1) ̸= 0.
This implies Df = 0, which is not true. Hence ∂F/∂yn ̸= 0, and we have the desired result.
♦
Note the analogy between linear dependence and functional dependence, where rank or determinant
conditions are replaced by the analogous conditions on the Jacobian matrix.
Supplement 2.5D
The Hadamard–Levy Theorem
This supplement gives suﬃcient conditions which together with the hypotheses of the inverse function
theorem guarantee that a Ck map f between Banach spaces is a global diﬀeomorphism. To get a feel for
these supplementary conditions, consider a Ck function f : R →R, k ≥1, satisfying 1/|f ′(x)| < M for
all x ∈R. Then f is a local diﬀeomorphism at every point of R and thus is an open map. In particular,
f(R) is an open interval ]a, b[. The condition |f ′(x)| > 1/M implies that f is either strictly increasing or
strictly decreasing. Let us assume that f is strictly increasing. If b < +∞, then the line y = b is a horizontal
asymptote of the graph of f and therefore we should have limx→∞f ′(x) = 0 contradicting |f ′(x)| > 1/M.
One similarly shows that a = −∞and the same proof works if f ′(x) < −1/M. The theorem below generalizes
this result to the case of Banach spaces.
2.5.17 Theorem (The Hadamard–Levy Theorem).
Let f : E →F be a Ck map of Banach spaces, k ≥1.
If Df(x) is an isomorphism of E with F for every x ∈E and if there is a constant M > 0 such that
∥Df(x)−1∥< M for all x ∈E, then f is a diﬀeomorphism.
The key to the proof of the theorem consists of a homotopy lifting argument. If X is a topological space,
a continuous map ϕ : X →F is said to lift to E through f, if there is a continuous map ψ : X →E
satisfying f ◦ψ = ϕ.
2.5.18 Lemma.
Let X be a connected topological space, ϕ : X →F a continuous map and let f : E →F
be a C1 map with Df(x) an isomorphism for every x ∈E. Fix u0 ∈E, v0 ∈F, and x0 ∈X satisfying
f(u0) = v0 and ϕ(x0) = v0. Then if a lift ψ of ϕ through f with ϕ(x0) = u0 exists, it is unique.
Proof.
Let ψ′ be another lift and deﬁne the sets
X1 = { x ∈X | ϕ(x) = ψ′(x) }
and
X2 = { x ∈X | ψ(x) ̸= ψ′(x) },
so that X = X1 ∪X2 and X1 ∩X2 = ∅. We shall prove that both X1, X2 are open. Since x0 ∈X1,
connectedness of X implies X2 = ∅and the lemma will be proved.
If x ∈X1, let U be an open neighborhood of ψ(x) = ψ′(x) on which f is a diﬀeomorphism. Then
ψ−1(U) ∩ϕ′−1(U) is an open neighborhood of x contained in X1.
If x ∈X2, let U (resp., U ′) be an open neighborhood of the point ψ(x) (resp. of ψ′(x)) on which f is a
diﬀeomorphism and such that U ∩U ′ = ∅. Then the set ψ−1(U) ∩ψ′−1(U ′) is an open neighborhood of x
contained in X2.
■

116
2. Banach Spaces and Diﬀerential Calculus
A path γ : [0, 1] →G, where G is a Banach space, is called C1 if γ|]0, 1[ is uniformly C1 and the extension
by continuity of γ′ to [0, 1] has the values γ′(0), γ′(1) equal to
γ′(0) = lim
h↓0
γ(h) −γ(0)
h
,
γ′(1) = lim
h↓0
γ(1) −γ(1 −h)
h
.
2.5.19 Lemma (Homotopy Lifting Lemma).
Under the hypotheses of Theorem 2.5.17, let H(t, s) be a
continuous map of [0, 1] × [0, 1] into F such that for each ﬁxed s ∈[0, 1] the path t →H(t, s) is C1.
In addition, assume that H ﬁxes endpoints, that is, H(0, s) = y0 and H(1, s) = y1, for all s ∈[0, 1]. If
y0 = f(x0) for some x0 ∈E, there exists a unique lift K of H through f which is C1 in t for every s. See
Figure 2.5.5.
Proof.
Uniqueness follows by Lemma 2.5.18. By the inverse function theorem, there are open neighbor-
hoods U of x0 and V of y0 such that f|U : U →V is a diﬀeomorphism. Since the open set H−1(U) contains
the closed set {0} × [0, 1], there exists ε > 0 such that [0, ε[ × [0, 1] ⊂H−1(U). Let K : [0, ε[ × [0, 1] →E be
given by K = f −1 ◦H. Consider the set A = { δ ∈[0, 1] | H : [0, δ[ × [0, 1] →F can be lifted through f to
E } which contains the interval [0, ε[. If α = sup A we shall show ﬁrst that α ∈A and second that α = 1.
This will prove the existence of the lifting K.
E
[0, 1] × [0, 1]
F
H
f
K
✟✟✟✟✟✟
✯
✲
✻
Figure 2.5.5. The homotopy lifting lemma
To show that α ∈A, note that for 0 ≤t < α we have f ◦K = H and thus Df(K(1, s)) ◦∂K/t = ∂H/∂t,
which implies that

∂K
∂t
 ≤M
sup
t,s∈[0,1]

∂H
∂t
 = N.
Thus by the mean value inequality, if {tn} is an increasing sequence in A converging to a,
∥K(tn, s) −K(tm, s)∥≤N|tn −tm|,
which shows that {K(tn, s)} is a Cauchy sequence in E, uniformly in s ∈[0, 1]. Let
K(α, s) = lim
tn↑α K(tn, s).
By continuity of f and H we have
f(K(α, s)) = lim
tn↑α f(K(tn, s)) = lim
tn↑α H(tn, s) = H(α, s),
which proves that α ∈A.
Next we show that α = 1. If α < 1 consider the curves s →K(α, s) and s →H(α, s) = f(K(α, s)). For
each s ∈[0, 1] choose open neighborhoods Us of K(α, s) and Vs of H(α, s) such that f|Us : Us →Vs is a
diﬀeomorphism. By compactness of the path K(α, s) in s, that is, of the set { K(α, s) | s ∈[0, 1] }, ﬁnitely

2.5 The Inverse and Implicit Function Theorems
117
many of the Us, say U1, . . . , Un, cover it. Therefore the corresponding V1, . . . , Vn cover { H(α, s) | s ∈[0, 1] }.
Since H−1(Vi) contains the point (α, si), there exists ε > 0 such that
]α −εi, α + εi[ × ]si −δi, si + δi[ ⊂H−1(Vi),
where ]si −δi, si + δi[ = H(α, ·)−1(Vi) and in particular ]si −δi, si + δi[, i = 1, . . . , n cover [0, 1]. Let
ε = min{e1, . . . , en} and deﬁne K : [0, α + ε[ × [0, 1] →E by
K(t, s) =

K(t, s),
if (t, s) ∈[0, α[ × {(0, 1)};
(f|Ui)−1(H(t, s)),
if (t, s) ∈[α, α + ε[ × ]si −δi, si + δi[,
where i = 1, . . . , n. By Lemma 2.5.18, K is a lifting of H, contradicting the deﬁnition of α.
Finally, K is C1 in t for each s by the chain rule:
∂K
∂t = Df(K(t, s))−1 ◦∂H
∂t .
■
Proof of Theorem 2.5.17.
Let y0, y ∈F and consider the path γ(t) = (1 −t)y0 + ty. Regarding γ as
deﬁned on [0, 1] × [0, 1], independent of the second variable, the homotopy lifting lemma guarantees the
existence of a C1 path δ : [0, 1] →E lifting γ, that is, f ◦δ = γ. In particular, f(δ(1)) = γ(1) = y and thus
f is surjective.
To show that f is injective, assume x1 ̸= x2, f(x1) = f(x2), and consider the path δ(t) = (1 −t)x1 + tx2.
Then γ(t) = f(δ(t)). By the homotopy lifting lemma, there exists a lift K of H through f. From f ◦K = H
it follows that the continuous curve s →K(0, s) is mapped by f to the point f(x1), thus contradicting the
inverse function theorem.
Therefore f is a bijective map which is a local diﬀeomorphism around every point, that is, f is a diﬀeo-
morphism of E with F.
■
Remarks.
(i)
The uniform bound on ∥Df(x)−1∥can be replaced by properness of the map, that is,
if f(xn) →y there exists a convergent subsequence {xm}, xm →x with f(x) = y (see Exercise
1.5-10). Indeed, the only place where the uniform bound on ∥Df(x)−1∥was used is in the homotopy
lifting lemma in the argument that α = sup A ∈A. If f is proper, this is shown in the following
way. Let {t(n)} be an increasing sequence in A converging to α. Then H(t(n), s) →H(α, s) and from
f ◦K = H on [0, α[ × [0, 1], it follows that f(K(t(m), s)) →H(α, s) uniformly in s ∈[0, 1]. Thus, by
properness of f, there is a subsequence {t(m)} such that K(t(m), s) is convergent for every s. Put
K(α, s) = limt(m)↑α K(t(n), s) and proceed as before.
(ii)
If E and F are ﬁnite dimensional, properness of f is equivalent to: the inverse image of every compact
set in F is compact in E (see Exercise 1.5-10).
(iii)
Conditions on f like the one in (ii) or in the theorem are necessary as the following counterexample
shows. Let f : R2 →R2 be given by (ex, ye−x) so that f(R2) is the right open half plane and in
particular f is not onto. However
Df(x, y) =

ex
0
−ye−x
e−x

is clearly an isomorphism for every (x, y) ∈R2. But f is neither proper nor does the norm ∥Df(x, y)−1∥
have a uniform bound on R2. For example, the inverse image of the compact set [0, 1]×{0} is ]−∞, 0]×
{0} and ∥Df(x, y)−1∥= C[e−2x + e2x + y2e−2x]1/2, which is unbounded x →+∞.
(iv)
See Wu and Desoer [1972] and Ichiraku [1985] for useful references to the theorem and applications. ♦

118
2. Banach Spaces and Diﬀerential Calculus
Lax–Milgram Theorem.
If E = F = H is a Hilbert space, then the Hadamard–Levy theorem has an
important consequence. We have seen that in the case of f : R →R with a uniform bound on 1/|f ′(x)|, the
strong monotonicity of f played a key role in the proof that f is a diﬀeomorphism.
2.5.20 Deﬁnition.
Let H be a Hilbert space. A map f : H →H is strongly monotone if there exists a > 0
such that
⟨f(x) −f(y), x −y⟩≥a∥x −y∥2.
As in calculus, for diﬀerentiable maps strong monotonicity takes on a familiar form.
2.5.21 Lemma.
Let f : H →H be a diﬀerentiable map of the Hilbert space H onto itself. Then f is
strongly monotone if and only if
⟨Df(x) · u, u⟩≥a∥u∥2
for some a > 0.
Proof.
If f is strongly monotone, ⟨f(x + tu) −f(x), tu⟩≥at2∥u∥2 for any x, u ∈H, t ∈R. Dividing by
t2 and taking the limit as t →0 yields the result.
Conversely, integrating both sides of ⟨Df(x + tu) · u, u⟩≥a∥u∥2 from 0 to 1 gives the strong monotonicity
condition.
■
2.5.22 Lemma (Lax–Milgram Lemma).
Let H be a real Hilbert space and A ∈L(H, H) satisfy the esti-
mate ⟨Ae, e⟩≥a∥e∥2 for all e ∈H. Then A is an isomorphism and ∥A−1∥≤1/a.
Proof.
The condition clearly implies injectivity of A. To prove A is surjective, we show ﬁrst that A(H)
is closed and then that the orthogonal complement A(H)⊥is {0}. Let fn = A(en) be a sequence which
converges to f ∈H. Since ∥Ae∥≥a∥e∥by the Schwarz inequality, we have
∥fn −fm∥= ∥A(en −em)∥≥a∥en −em∥,
and thus {en} is a Cauchy sequence in H. If e is its limit we have Ae = f and thus f ∈A(H).
To prove A(H)⊥= {0}, let u ∈A(H)⊥so that 0 = ⟨Au, u⟩≥a∥u∥2 whence u = 0.
By Banach’s isomorphism theorem 2.2.16, A is a Banach space isomorphism of H with itself. Finally,
replacing e by A−1f in ∥Ae∥≥a∥e∥yields ∥A−1f∥≤∥f∥/a, that is, ∥A−1∥≤1/a.
■
Lemmas 2.5.21, 2.5.22, and the Hadamard–Levy theorem imply the following global inverse function
theorem on the real Hilbert space.
2.5.23 Theorem.
Let H be a real Hilbert space and f : H →H be a strongly monotone Ck mapping
k ≥1. Then f is a Ck diﬀeomorphism.
Supplement 2.5E
The Inversion Map
Let E and F be isomorphic Banach spaces and consider the inversion map I : GL(E, F) →GL(F, E);
I(ϕ) = ϕ−1. We have shown that I is C∞and
DI(ϕ) · ψ = −ϕ−1 ◦ψ ◦ϕ−1

2.5 The Inverse and Implicit Function Theorems
119
for ϕ ∈GL(E, F) and ψ ∈L(E, F). We shall give below the formula for DkI. The proof is straightforward
and done by a simple induction argument that will be left to the reader. Deﬁne the map
αk+1 : L(F, E) × · · · × L(F, E) {there are k + 1 factors}
→Lk(L(E, F); L(F, E))
by
αk+1 (χ1, . . . , χk+1) · (ψ1, . . . , ψk)
= (−1)kχ1 ◦ψ1 ◦χ2 ◦ψ2 ◦· · · ◦χk ◦ψk ◦χk+1,
where χi ∈L(F, E), i = 1, . . . , k + 1 and ψj ∈L(E, F), j = 1, ..., k. Let I × · · · × I {with k + 1 factors} be
the mapping of GL(E, F) to GL(F, E) × · · · × GL(F, E) with {k + 1 factors} deﬁned by (I × · · · × I)(ϕ) =
(ϕ−1, . . . , ϕ−1). Then
DkI = k! Symk ◦αk+1 ◦(I × · · · × I),
where Symk denotes the symmetrization operator. Explicitly, for
ϕ ∈GL(E, E)
and
ψ1, . . . , ψk ∈L(E, F),
this formula becomes
DkI(ϕ) · (ψ1, . . . , ψk) = (−1)k 
σ∈Sk
ϕ−1 ◦ψσ(1) ◦ϕ−1 · · · ◦ϕ−1 ◦ψσ(k) ◦ϕ−1,
where Sk is the group of permutations of {1, . . . , k} (see Supplements 2.2B and 2.4A).
Exercises
⋄2.5-1.
Let f : R4 →R2 be deﬁned by
f(x, y, u, v) = (u3 + vx + y, uy + v3 −x).
At what points can we solve f(x, y, u, v) = (0, 0) for (u, v) in terms of (x, y)? Compute ∂u/∂x.
⋄2.5-2.
(i)
Let E be a Banach space. Using the inverse function theorem, show that each A in a neigh-
borhood of the identity map in GL(E, E) has a unique square root.
(ii)
Show that for A ∈L(E, E) the series
B = 1 −1
2(I −A) −
1
222!(I −A)2 −· · ·
−1 · 3 · 5 · · · (2n −3)
2nn!
(I −A)n −· · ·
is absolutely convergent for ∥I −A∥< 1. Check directly that B2 = A.
⋄2.5-3.
(i)
Let A ∈L(E, E) and let
eA =
∞

n=0
An
n! .
Show this series is absolutely convergent and ﬁnd an estimate for ∥eA∥, A ∈L(E, E).

120
2. Banach Spaces and Diﬀerential Calculus
(ii)
Show that if AB = BA, then eA+B = eAeB = eBeA. Conclude that (eA)−1 = e−A; that is, eA ∈
GL(E, E).
(iii)
Show that e(·) : L(E, E) →GL(E, E) is analytic.
(iv)
Use the inverse function theorem to conclude that A →eA has a unique inverse around the origin.
Call this inverse A →log A and note that log I = 0.
(v)
Show that if ∥I −A∥< 1, the function log A is given by the absolutely convergent power series
log A =
∞

n=1
(−1)n−1
n
(A −I)n.
(vi)
If ∥I −A∥< 1, ∥I −B∥< 1, and AB = BA, conclude that log (AB) = log A + log B. In particular,
log A−1 = −log A.
⋄2.5-4.
Show that the implicit function theorem implies the inverse function theorem.
Hint: Apply the implicit function theorem to g : U × F →F, g(u, v) = f(u) −v, for f : U ⊂E →F.
⋄2.5-5.
Let f : R2 →R2 be C∞and satisfy the Cauchy–Riemann equations (see Exercise 2.3-6):
∂f1
∂x = ∂f2
∂y ,
∂f1
∂y = −∂f2
∂x .
Show that Df(x, y) = 0 iﬀdet(Df(x, y)) = 0. Show that the local inverse (where it exists) also satisﬁes the
Cauchy–Riemann equations. Give a counterexample for the ﬁrst statement, if f does not satisfy Cauchy–
Riemann.
⋄2.5-6.
Let f : R →R be given by
f(x) = x + x2 cos 1
x
if x ̸= 0,
and
f(0) = 0.
Show that
(i)
f is continuous;
(ii)
f is diﬀerentiable at all points;
(iii)
the derivative is discontinuous at x = 0;
(iv)
f ′(0) ̸= 0;
(v)
f has no inverse in any neighborhood of x = 0. (This shows that in the inverse function theorem the
continuity hypothesis on the derivative cannot be dropped.)
⋄2.5-7.
It is essential to have Banach spaces in the inverse function theorem rather than more general
spaces such as topological vector spaces or Fr´echet spaces. (The following example of the failure of Theorem
2.5.2 in Fr´echet spaces is due to M. McCracken.)
Let H(∆) denote the set of all analytic functions on the open unit disk in C, with the topology of uniform
convergence on compact subsets. Let F : H(∆) →H(∆) be deﬁned by
∞

n=0
anzn →
∞

n=0
a2
nzn.
Show that F is C∞and that
DF

 ∞

n=0
anzn

·

 ∞

n=1
bnzn

=
∞

n=1
2 anbnzn.

2.5 The Inverse and Implicit Function Theorems
121
(Deﬁne the Fr´echet derivative in H(∆) as part of your answer.) If a0 = 1 and an = 1/n, n ̸= 1, then
DF

 ∞

n=1
zn
n

is a bounded linear isomorphism. However, since
F

z + z2
2 + · · · + zk−1
k −1 −zk
k + zk+1
k + 1 + · · ·

= F

 ∞

n=1
zn
n

conclude that F is not locally injective. (Schwartz [1967], Sternberg [1969], and Hamilton [1982] for more
sophisticated versions of the inverse function theorem valid in Fr´echet spaces.)
⋄2.5-8 (Generalized Lagrange Multiplier Theorem; Luenberger [1969]).
Let f : U ⊂E →F and g : U ⊂E →G be C1 and suppose Dg(u0) is surjective. Suppose f has a
local extremum (maximum or minimum) at u0 subject to the constraint g(u) = 0. Then prove
(i)
Df(u0) · h = 0 for all h ∈ker Dg(u0), and
(ii)
there is a λ ∈G∗such that Df(u0) = λDg(u0).
(See Supplement 3.5A for the geometry behind this result).
⋄2.5-9.
Let f : U ⊂Rm →Rn be a C1 map.
(i)
Show that the set Gr = { x ∈U | rank Df(x) ≥r } is open in U.
Hint: If x0 ∈Gr, let M(x0) be a square block of the matrix of Df(x0) in given bases of Rm and Rn
of size ≥r such that det M(x0) ̸= 0. Using continuity of the determinant function, what can you say
about det M(x) for x near x0?
(ii)
We say that R is the maximal rank of Df(x) on U if
R = sup
x∈U
(rank Df(x)).
Show that VR = { x ∈U | rank Df(x) = R } is open in U. Conclude that if rank Df(x0) is maximal
then rank Df(x) stays maximal in a neighborhood of x0.
(iii)
Deﬁne Oi = int{ x ∈U | rank Df(x) = i } and let R be the maximal rank of Df(x), x ∈U. Show that
O0 ∪· · · ∪OR is dense in U.
Hint: Let x ∈U and let V be an arbitrary neighborhood of x. If Q denotes the maximal rank of
Df(x) on x ∈V , use (ii) to argue that V ∩OQ = { x ∈V | rank Df(x) = Q } is open and nonempty
in V .
(iv)
Show that if a C1 map f : U ⊂Rm →Rn is injective (surjective onto an open set), then m ≤n
(m ≥n).
Hint: Use the rank theorem and (ii).
⋄2.5-10 (Uniform Contraction Principle; Hale [1969], Chow and Hale [1982]).
(i)
Let T : cl(U) × V →E be a Ck map, where U ⊂E and V ⊂F are open sets. Suppose that for ﬁxed
y ∈V , T(x, y) is a contraction in x, uniformly in y. If g(y) denotes the unique ﬁxed point of T(x, y),
show that g is Ck.
Hint: Proceed directly as in the proof of the inverse mapping theorem.
(ii)
Use (i) to prove the inverse mapping theorem.

122
2. Banach Spaces and Diﬀerential Calculus
⋄2.5-11 (Lipschitz Inverse Function Theorem; Hirsch and Pugh [1970]).
(i)
Let (Xi, di) be metric spaces and f : X1 →X2. The map f is called Lipschitz if there exists a constant
L such that d2(f(x), f(y)) ≤Ld1(x, y) for all x, y ∈X1. The smallest such L is the Lipschitz constant
L(f). Thus, if X1 = X2 and L(f) < 1, then f is a contraction. If f is not Lipschitz, set L(f) = ∞.
Show that if g : (X2, d2) →(X3, d3), then L(g ◦f) ≤L(g)L(f). Show that if X1, X2 are normed vector
spaces and f, g : X1 →X2, then
L(f + g) ≤L(f) + L(g),
L(f) −L(g) ≤L(f −g).
(ii)
Let E be a Banach space, U an open set in E such that the closed ball Br(0) ⊂U. Let f : U →E be
given by f(x) = x+ϕ(x), where ϕ(0) = 0 and ϕ is a contraction. Show that f(Dr(0)) ⊃Dr(1−L(ϕ))(0),
that f is invertible on f −1(Dr(1−L(ϕ))(0)), and that f −1 is Lipschitz with constant L(f −1) ≤1/(1 −
L(ϕ)).
Hint: If ∥y∥< r(1 −L(ϕ)), deﬁne F : U →E by F(x) = y −ϕ(x). Apply the contraction mapping
principle in Br(0) and show that the ﬁxed point is in Dr(0). Finally, note that
(1 −L(ϕ))∥x1 −x2∥≤∥x1 −x2∥−∥ϕ(x1) −ϕ(x2)∥
≤∥f(x1) −f(x2)∥.
(iii)
Let U be an open set in the Banach space E, V be an open set in the Banach space F, x0 ∈U, Br(x0) ⊂
U. Let α : U →V be a homeomorphism. Assume that α−1 : V →U is Lipschitz and let ψ : U →F be
another Lipschitz map. Assume L(ψ)L(α−1) < 1 and deﬁne f = α + ψ : U →F. Denote y0 = f(x0).
Show that f(α−1(Dr(x0))) ⊃Dr(1−L(ψ)L(α−1))(y0), that f is invertible on f −1(Dr(1−L(ψ)L(α−1))(y0),
and that f −1 is Lipschitz with constant
L(f −1) ≤
1
L(α−1)−1 −L(ψ).
Hint: Replacing ψ by the map x →ψ(x)−ψ(x0) and V by V +{ψ(x0)}, we can assume that ψ(x0) = 0
and f(x0) = α(x0) = y0. Next, replace this new f by x →f(x + x0) −f(x0), U by U −{x0}, and the
new V by V + {y0}; thus we can assume that
x0 = 0,
y0 = 0,
ψ(0) = 0,
and
α(0) = 0.
Then
f ◦α−1 = I + ψ ◦α−1,
(ψ ◦α−1)(0) = 0,
L(ψ ◦α−1) ≤L(ψ)L(α−1) < 1,
so (ii) is applicable.
(iv)
Show that |L(f −1) −L(α−1)| →0 as L(ψ) →0. Let α : R →R be the homeomorphism deﬁned
by α(x) = x if x ≤0 and α(x) = 2x if x ≥0. Show that both α and α−1 are Lipschitz. Let
ψ(x) = c = constant. Show that L(ψ) = 0 and if c ̸= 0, then L(f −1 −α−1) ≥1/2. Prove, however,
that if α, f are diﬀeomorphisms, then L(f −1 −α−1) →0 as L(ψ) →0.
⋄2.5-12.
Use the inverse function theorem to show that simple roots of polynomials are smooth functions of
their coeﬃcients. Conclude that simple eigenvalues of operators of Rn are smooth functions of the operator.
Hint: If p(t) = antn + an−1tn−1 + · · · + a0, deﬁne a smooth map F : Rn+2 →R by F(an, . . . , a0, λ) = p(λ)
and note that if λ0 is a simple eigenvalue, ∂F(λ0)/∂λ ̸= 0.

2.5 The Inverse and Implicit Function Theorems
123
⋄2.5-13.
Let E, F be Banach spaces, f : U →V a Cr bijective map, r ≥1, between two open sets U ⊂E,
V ⊂F. Assume that for each x ∈U, Df(x) has closed split image and is one-to-one.
(i)
Use the local immersion theorem to show that f is a Cr diﬀeomorphism.
(ii)
What fails for y = x3?
⋄2.5-14.
Let E be a Banach space, U ⊂E open and f : U →R a Cr map, r ≥2. We say that u ∈U is
a critical point of f, if Df(u) = 0. The critical point u is called strongly non-degenerate if D2f(u)
induces a Banach space isomorphism of E with its dual E∗. Use the Inverse Function Theorem on Df to
show that strongly non-degenerate points are isolated, that is, each strongly non-degenerate point is unique
in one of its neighborhoods. (A counter-example, if D2f is only injective, is given in Exercise 2.4-15.)
⋄2.5-15.
For u : S1 →R, consider the equation
du
dθ + u2 −1
2π
	 2π
0
u2 dθ = ε sin θ
where θ is a 2π-periodic angular variable and ε is a constant. Show that if ε is suﬃciently small, this equation
has a solution.
⋄2.5-16.
Use the implicit function theorem to study solvability of
∇2ϕ + ϕ3 = f in Ω
and
∂ϕ
∂n = g on ∂Ω,
where Ωis a region in Rn with smooth boundary, as in Supplement 2.5C.
⋄2.5-17.
Let E be a ﬁnite dimensional vector space.
(i)
Show that det(exp A) = etraceA.
Hint: Show it for A diagonalizable and then use Exercise 2.2-12(i).
(ii)
If E is real, show that exp(L(E, F)) ∩{ A ∈GL(E) | det A < 0 } = ∅. This shows that the exponential
map is not onto.
(iii)
If E is complex, show that the exponential map is onto. For this you will need to recall the following facts
from linear algebra. Let p be the characteristic polynomial of A ∈L(E, E), that is, p(λ) = det(A−λI).
Assume that p has m distinct roots λ1, . . . , λm such that the multiplicity of λi is ki. Then
E =
m
+
i=1
ker(A −λiI)ki
and
dim(ker(A −λiI)ki) = ki
Thus, to prove the exponential is onto, it suﬃces to prove it for operators S ∈GL(E) for which the
characteristic polynomial is (λ −λ0)k.
Hint: Since S is invertible, λ0 ̸= 0, so write λ0 = ez, z ∈C. Let N = λ−1
0 S −I and
A =
k−1

i=1
(−1)i−1N i
i
.
By the Cayley–Hamilton theorem (see Exercise 2.2-12(ii)), N k = 0, and from the fact that exp(log(1+
w)) = 1 + w for all w ∈C, it follows that exp(A + zI) = λ0 exp A = λ0(I + N) = S.

124
2. Banach Spaces and Diﬀerential Calculus

Page 125
3
Manifolds and Vector Bundles
We are now ready to study manifolds and the diﬀerential calculus of maps between manifolds. Manifolds
are an abstraction of the idea of a smooth surface in Euclidean space. This abstraction has proved useful
because many sets that are smooth in some sense are not presented to us as subsets of Euclidean space. The
abstraction strips away the containing space and makes constructions intrinsic to the manifold itself. This
point of view is well worth the geometric insight it provides.
3.1
Manifolds
Charts and Atlases.
The basic idea of a manifold is to introduce a local object that will support
diﬀerentiation processes and then to patch these local objects together smoothly. Before giving the formal
deﬁnitions it is good to have an example in mind. In Rn+1 consider the n-sphere Sn; that is, the set of
x ∈Rn+1 such that ∥x∥= 1 (∥· ∥denotes the usual Euclidean norm). We can construct bijections from
subsets of Sn to Rn in several ways. One way is to project stereographically from the south pole onto a
hyperplane tangent to the north pole. This is a bijection from Sn, with the south pole removed, onto Rn.
Similarly, we can interchange the roles of the poles to obtain another bijection. (See Figure 3.1.1.)
With the usual relative topology on Sn as a subset of Rn+1, these maps are homeomorphisms from their
domain to Rn. Each map takes the sphere minus the two poles to an open subset of Rn. If we go from Rn
to the sphere by one map, then back to Rn by the other, we get a smooth map from an open subset of Rn
to Rn. Each map assigns a coordinate system to Sn minus a pole. The union of the two domains is Sn, but
no single homeomorphism can be used between Sn and Rn; however, we can cover Sn using two of them.
In this case they are compatible; that is, in the region covered by both coordinate systems, the change of
coordinates is smooth. For some studies of the sphere, and for other manifolds, two coordinate systems will
not suﬃce. We thus allow all other coordinate systems compatible with these. For example, on S2 we want
to allow spherical coordinates (θ, ϕ) since they are convenient for many computations.
3.1.1 Deﬁnition.
Let S be a set. A chart on S is a bijection ϕ from a subset U of S to an open subset
of a Banach space. We sometimes denote ϕ by (U, ϕ), to indicate the domain U of ϕ. A Ck atlas on S is
a family of charts A = { (Ui, ϕi) | i ∈I } such that
MA1.
S = { Ui | i ∈I }.

126
3. Manifolds and Vector Bundles
N
S
P
S2
ϕ(P)
R2
                                                                                                                   @@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@





ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
                                                                                                                        @@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@





ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
ÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ
                                                                                                                   yyyyyyyyyyyyyyyyyyyyyyy
yyyyyyyyyyyyyyyyyyyyyyy
yyyyyyyyyyyyyyyyyyyyyyy
yyyyyyyyyyyyyyyyyyyyyyy
yyyyyyyyyyyyyyyyyyyyyyy
Figure 3.1.1. The two-sphere S2.
MA2.
Any two charts in A are compatible in the sense that the overlap maps between members of A
are Ck diﬀeomorphisms: for two charts (Ui, ϕi) and (Uj, ϕj) with Ui ∩Uj ̸= ∅, we form the
overlap map: ϕji = ϕj ◦ϕ−1
i |ϕi(Ui∩Uj), where ϕ−1
i |ϕi(Ui∩Uj) means the restriction of ϕ−1
i
to the set ϕi(Ui∩Uj). We require that ϕi(Ui∩Uj) is open and that ϕji be a Ck diﬀeomorphism.
(See Figure 3.1.2.)
Uj
Ui
ϕi
ϕj
ϕij
ϕi
ϕi(Ui     Uj)
⊃
Fi
Fj
Figure 3.1.2. Charts πi and πj on a manifold
3.1.2 Examples.
A.
Any Banach space F admits an atlas formed by the single chart (F, identity).
B.
A less trivial example is the atlas formed by the two charts of Sn discussed previously. More explicitly,
if N = (1, 0, . . . , 0) and S = (−1, . . . , 0, 0) are the north and south poles of Sn, the stereographic projections
from N and S are
ϕ1 : Sn\{N} →Rn,
ϕ1(x1, . . . , xn+1) =

x2
1 −x1 , . . . , xn+1
1 −x1

,

3.1 Manifolds
127
and
ϕ2 : Sn\{S} →Rn,
ϕ2(x1, . . . , xn+1) =

x2
1 + x1 , . . . , xn+1
1 + x1

and the overlap map ϕ2 ◦ϕ−1
1
: Rn\{0} →Rn\{0} is given by the mapping (ϕ2 ◦ϕ−1
1 )(z) = z/∥z∥2,
z ∈Rn\{0}, which is clearly a C∞diﬀeomorphism of Rn\{0} to itself.
♦
Deﬁnition of a Manifold.
We are now ready for the formal deﬁnition of a manifold.
3.1.3 Deﬁnition.
Two Ck atlases A1 and A2 are equivalent if A1 ∪A2 is a Ck atlas. A Ck diﬀeren-
tiable structure D on S is an equivalence class of atlases on S. The union of the atlases in D,
AD =

{ A | A ∈D }
is the maximal atlas of D, and a chart (U, ϕ) ∈AD is an admissible local chart. If A is a Ck atlas
on S, the union of all atlases equivalent to A is called the Ck diﬀerentiable structure generated by A. A
diﬀerentiable manifold M is a pair (S, D), where S is a set and D is a Ck diﬀerentiable structure on S.
We shall often identify M with the underlying set S for notational convenience. If a covering by charts takes
their values in a Banach space E, then E is called the model space and we say that M is a Ck Banach
manifold modeled on E.
If we make a choice of a Ck atlas A on S then we obtain a maximal atlas by including all charts whose
overlap maps with those in A are Ck. In practice it is suﬃcient to specify a particular atlas on S to determine
a manifold structure for S.
3.1.4 Example.
An alternative atlas for Sn has the following 2(n + 1) charts: (U ±
i , ψ±
i ), i = 1, . . . , n + 1,
where U ±
i = { x ∈Sn | ±xi > 0 } and ψ±
i : U ±
i →{ y ∈Rn | ∥y∥< 1 } is deﬁned by
ψ±
i (x1, . . . , xn+1) = (x1, . . . , xi−1, xi+1, . . . , xn+1);
ψ±
i
projects the hemisphere containing the pole (0, . . . , ±1, . . . , 0) onto the open unit ball in the tangent
space to the sphere at that pole. It is veriﬁed that this atlas and the one in Example 3.1.2B with two charts
are equivalent. The overlap maps of this atlas are given by

ψ±
j ◦

ψ±
i
−1	 
y1, . . . , yn
=

y1, . . . , yj−1, yj+1, . . . , yi−1, ±

1 −∥y∥2, yi, . . . , yn	
,
where j > 1.
♦
Topology of a Manifold.
We now deﬁne the open subsets in a manifold, which will give us a topology.
3.1.5 Deﬁnition.
Let M be a diﬀerentiable manifold. A subset A ⊂M is called open if for each a ∈A
there is an admissible local chart (U, ϕ) such that a ∈U and U ⊂A.
3.1.6 Proposition.
The open sets in M deﬁne a topology.
Proof.
Take as basis of the topology the family of ﬁnite intersections of chart domains.
■
3.1.7 Deﬁnition.
A diﬀerentiable manifold M is an n-manifold when every chart has values in an n-
dimensional vector space. Thus for every point a ∈M there is an admissible local chart (U, ϕ) with a ∈U
and ϕ(U) ⊂Rn. We write n = dim M. An n-manifold will mean a Hausdorﬀ, diﬀerentiable n-manifold in
this book. A diﬀerentiable manifold is called a ﬁnite-dimensional manifold if its connected components

128
3. Manifolds and Vector Bundles
are all n-manifolds (n can vary with the component). A diﬀerentiable manifold is called a Hilbert manifold
if the model space is a Hilbert space.1
No assumption on the connectedness of a manifold has been made. In fact, in some applications the manifolds
are disconnected (see Exercise 3.1-3). Since manifolds are locally arcwise connected, their components are
both open and closed.
3.1.8 Examples.
A.
Every discrete topological space S is a 0-manifold, the charts being given by the pairs ({s}, ϕs), where
ϕs : s →0 and s ∈S.
B.
Every Banach space is a manifold; its diﬀerentiable structure is given by the atlas with the single
identity chart.
C.
The n-sphere Sn with a maximal atlas generated by the atlas with two charts described in Examples
3.1.2B or 3.1.4 makes Sn into an n-manifold. The reader can verify that the resulting topology is the same
as that induced on Sn as a subset of Rn+1.
D.
A set can have more than one diﬀerentiable structure. For example, R has the following incompatible
charts:
(U1, ϕ1) : U1 = R,
ϕ1(r) = r3 ∈R;
and
(U2, ϕ2) : U2 = R,
ϕ2(r) = r ∈R.
They are not compatible since ϕ2 ◦ϕ−1
1
is not diﬀerentiable at the origin. Nevertheless, these two structures
are “diﬀeomorphic” (Exercise 3.2-8), but structures can be “essentially diﬀerent” on more complicated sets
(e.g., S7). That S7 has two nondiﬀeomorphic diﬀerentiable structures is a famous result of Milnor [1956].
Similar phenomena have been found on R4 by Donaldson [1983]; see also Freed and Uhlenbeck [1984].
E.
Essentially the only one-dimensional paracompact connected manifolds are R and S1. This means that
all others are diﬀeomorphic to R or S1 (diﬀeomorphic will be precisely deﬁned later). For example, the circle
with a knot is diﬀeomorphic to S1. (See Figure 3.1.3.) See Milnor [1965] or Guillemin and Pollack [1974] for
proofs.
S1
=
Figure 3.1.3. The knot and circle are diﬀeomorphic
F.
A general two-dimensional compact connected manifold is the sphere with “handles” (see Figure 3.1.4).
This includes, for example, the torus, whose precise deﬁnition will be given in the next section. This classi-
ﬁcation of two-manifolds is described in Massey [1991] and Hirsch [1976].
1One can similarly form a manifold modeled on any linear space in which one has a theory of diﬀerential calculus. For
example mathematicians often speak of a “Fr´echet manifold,” a “LCTVS manifold,” etc. We have chosen to stick with Banach
manifolds here primarily to avail ourselves of the inverse function theorem. See Exercise 2.5-7.

3.1 Manifolds
129
S
2 + handles
Figure 3.1.4. The sphere with handles
G. Grassmann Manifolds.
Let Gn(Rm), where m ≥n denote the space of all n-dimensional subspaces
of Rm. For example, G1(R3), also called projective 2-space, is the space of all lines in Euclidean three space.
The goal of this example is to show that Gn(Rm) is a smooth compact manifold. In fact, we shall develop,
with little extra eﬀort, an inﬁnite dimensional version of this example.
Let E be a Banach space and consider the set G(E) of all split subspaces of E. For F ∈G(E), let G
denote one of its complements, that is, E = F ⊕G, let
UG = { H ∈G(E) | E = H ⊕G },
and deﬁne
ϕF,G : UG →L(F, G)
by
ϕF,G(H) = πF(H, G) ◦πG(H, F)−1,
where πF(G) : E →G, πG(F) : E →F denote the projections induced by the direct sum decomposition
E = F ⊕G, and
πF(H, G) = πF(G)|H, πG(H, F) = πG(F)|H.
The inverse appearing in the deﬁnition of ϕF,G exists as the following argument shows. If H ∈UG, that
is, if E = F ⊕G = H ⊕G, then the maps πG(H, F) ∈L(H, F) and πG(F, H) ∈L(F, H) are invertible
and one is the inverse of the other, for if h = f + g, then f = h −g, for f ∈F, g ∈G, and h ∈H, so
that (πG(F, H) ◦πG(H, F))(h) = πG(F, H)(f) = h, and (πG(H, F) ◦πG(F, H))(f) = πG(H, F)(h) = f. In
particular, ϕF,G has the alternative expression
ϕF,G = πF(H, G) ◦πG(F, H).
Note that we have shown that H ∈UG implies πG(H, F) ∈L(H, F) is an isomorphism. The converse is also
true, that is, if πG(H, F) is an isomorphism for some split subspace H of E then E = H ⊕G. Indeed, if
x ∈H ∩G, then πG(H, F)(x) = 0 and so x = 0, that is, H ∩G = {0}. If e ∈E, then we can write
e = (πG (H, F))−1 ◦πG(F)e + [e −(πG (H, F) ◦πG(F)) (e)]
with the ﬁrst summand an element of H. Since πG(F)◦(πG(H, F))−1 is the identity on F, we have πG(F)[e−
(πG(F, H)◦πG(F))(e)] = 0, that is, the second summand is an element of G, and thus E = H+G. Therefore
E = H ⊕G and we have the alternative deﬁnition of UG as
UG = { H ∈G(E) | πG(H, F) is an isomorphism of H with F }.
Let us next show that ϕF,G : UG →L(F, G) is bijective. For α ∈L(F, G) deﬁne the graph of α by
ΓF,G(α) = { f + α(f) | f ∈F } which is a closed subspace of E = F ⊕G. Then E = ΓF,G(α) ⊕G, that is,

130
3. Manifolds and Vector Bundles
ΓF,G(α) ∈UG, since any e ∈E can be written as e = f + g = (f + α(f)) + (g −α(f)) for f ∈F and g ∈G,
and also ΓF,G(α) ∩G = {0} since f + α(f) ∈G for f ∈F iﬀf ∈F ∩G = {0}. We have
ϕF,G(ΓF,G(α)) = πF(ΓF,G(α), G) ◦πG(F, ΓF,G(α))
where
f = (f + α(f)) −α(f) →πF(ΓF,G(α), G)(f + α(f)) →α(f)
that is, ϕF,G ◦ΓF,G = identity on L(F, G), and
ΓF,G(πF(H, G) ◦πG(F, H))ΓF,G(π)
= { f + (πF(H, G) ◦πG(F, H))(f) | f ∈F }
= { f + πF(H, G)(h) | f ∈F, f = h + g, h ∈H, and g ∈G }
= { f −g | f ∈F, f = h + g, h ∈H, and g ∈G } = H,
that is, ΓF,G ◦ϕF,G = identity on UG. Thus, ϕF,G is a bijective map which sends H ∈UG to an element of
L(F, G) whose graph in F ⊕G is H. We have thus shown that (UG, ϕF,G) is a chart on G(E).
To show that { (UG, ϕF,G) | E = F ⊕G } is an atlas on G(E), note that

F∈G(E)

G
UG = G(E),
where the second union is taken over all G ∈G(E) such that
E = H ⊕G = F ⊕G
for some H ∈G(E). Thus, MA1 is satisﬁed. To prove MA2, let (UG′, ϕF′,G′) be another chart on G(E)
with UG ∩UG′ ̸= ∅. We need to show that ϕF,G(UG ∩UG′ ) is open in L(F, G) and that ϕF,G ◦ϕ−1
F′,G′ is
a C∞diﬀeomorphism of L(F′, G′) to L(F, G).
Step 1.
Proof of the openness of
ϕF,G(UG ∩UG′).
Let α ∈ϕF,G(UG ∩UG′) ⊂L(F, G) and let H = ΓF,G(α). Then E = H ⊕G = H ⊕G′. Assume for the
moment that we can show the existence of an ε > 0 such that if β ∈L(H, G) and ∥β∥< ε, then ΓH,G(β) ⊕
G′ = E. Then if α′ ∈L(F, G) is such that ∥α′∥< ε/∥πG(H, F)∥, we get ΓH,G(α′ ◦πG(H, F))⊕G′ = E. We
shall prove that ΓF,G(α + α′) = ΓH,G(α′ ◦πG(H, F)). Indeed, since the inverse of πG(H, F) ∈GL(H, F) is
I + α, where I is the identity mapping on F, for any h ∈H,
πG(H, F)(h) + ((α + α′) ◦πG(H, F))(h)
= [(I + α) ◦πG(H, F)](h) + (α′ ◦πG(H, F))(h)
= h + (α′ ◦πG(H, F))(h),
whence the desired equality between the graphs of α + α′ in F ⊕G and α′ ◦πG(H, F) in H ⊕G. Thus we
have shown that ΓF,G(α+α′)⊕G′ = E. Since we always have ΓF,G(α+α′)⊕G = E (since ΓF,G is bijective
with range UG), we conclude that α + α′ ∈ϕF,G(UG ∩UG′) thereby proving openness of ϕF,G(UG ∩UG′).
To complete the proof of Step 1 we therefore have to show that if E = H ⊕G = H ⊕G′ then there
is an ε > 0 such that for all β ∈L(H, G) satisfying ∥β∥< ε, we have ΓH,G(β) ⊕G′ = E. This in turn
is a consequence of the following statement: if E = H ⊕G = H ⊕G′ then there is an ε > 0 such for all
β ∈L(H, G) satisfying ∥β∥< ε, we have πG′(ΓH,G(β), H) ∈GL(ΓH,G(β), H). Indeed, granted this last
statement, write e ∈E as e = h + g′, for some h ∈H and g′ ∈G′, use the bijectivity of πG′(ΓH,G(β), H)

3.1 Manifolds
131
H
x
h
e
ΓH,G(β)
G′
G
g′
1
g′
Figure 3.1.5. Grassmannian charts
to ﬁnd an x ∈ΓH,G(β) such that h = πG′(ΓH,G(β), H)(x), and note that πG′(H)(h −x) = 0, that is,
h −x = g′
1 ∈G′; see Figure 3.1.5. Therefore e = x + (g′
1 + g′) ∈ΓH,G(β) + G′. In addition, we also have
ΓH,G(β) ∩G′ = {0}, for if z ∈ΓH,G(β) ∩G′, then πG′(ΓH,G(β), H)(z) = 0, whence z = 0 by injectivity of
the mapping πG′(ΓH,G(β), H); thus we have shown E = ΓH,G(β) ⊕G′.
Finally, assume that E = H ⊕G = H ⊕G′. Let us prove that there is an ε > 0 such that if β ∈L(H, G),
satisﬁes ∥β∥< ε, then πG′(ΓH,G(β), H) ∈GL(ΓH,G(β), H). Because of the identity πG(H, ΓH,G(β)) = I+β,
where I is the identity mapping on H, we have
∥I −πG′(H) ◦πG(H, ΓH,G(β))∥= ∥I −πG′(H) ◦(I + β)∥
= ∥πG(H′) ◦(I −(I + β))∥
≤∥πG′(H)∥∥β∥< 1
provided that ∥β∥< ε = 1/∥πG′(H)∥. Therefore, we get
I −(I −πG′(H) ◦πG(H, ΓH,G(β))) = πG′(H) ◦πG(H, ΓH,G(β)) ∈GL(H, H).
Since πG(H, ΓH,G(β)) ∈GL(H, ΓH,G(β)) has inverse πG(ΓH,G(β), H), we obtain
πG′(ΓH,G(β), H) = πG′(H)|ΓH,G(β)
= [πG′(H) ◦πG(H, (ΓH,G(β))]
◦πG(ΓH,G(β), H) ∈GL(ΓH,G(β), H).
Step 2.
Proof that the overlap maps are C∞. Let
(UG, ϕF,G), (UG′, ϕF′,G′)
be two charts at the points F, F′ ∈G(E) such that UG ∩UG′ ̸= ∅. If α ∈ϕF,G(UG ∩UG′), then I + α ∈
GL(F, ΓF,G(α)), where I is the identity mapping on F, and πG′(ΓF,G(α), F′) ∈GL(ΓF,G(α), F′) since
ΓF,G(α) ∈UG ∩UG′. Therefore πG′(F′) ◦(I + α) ∈GL(F, F′) and we get
(ϕF′,G′ ◦ϕ−1
F,G)(α) = ϕF′,G′(ΓF,G(α))
= πF′(ΓF,G(α), G′) ◦πG′(F′, ΓF,G(α))
= πF′(ΓF,G(α), G′) ◦πG′(F′, ΓF,G(α)) ◦πG′(F′)
◦(I + α) ◦[πG′(F′) ◦(I + α)]−1
= πF′(G′) ◦(I + α) ◦[πG′(F′) ◦(I + α)]−1

132
3. Manifolds and Vector Bundles
which is a C∞map from ϕF,G(UG ∩UG′) ⊂L(F, G) to
ϕF′,G′(UG ∩UG′) ⊂L(F′, G′).
Since its inverse is
β ∈L(F′, G′) →πF(G) ◦(I′ + β) ◦[πG(F) ◦(I′ + β)]−1 ∈L(F, G),
where I′ is the identity mapping on F′, it follows that the maps ϕF′,G′ ◦ϕ−1
F,G are diﬀeomorphisms.
Thus, G(E) is a C∞Banach manifold, locally modeled on L(F, G).
Let Gn(E) (resp., Gn(E)) denote the space of n-dimensional (resp. n-codimensional) subspaces of E.
From the preceding proof we see that Gn(E) and Gn(E) are connected components of G(E) and so are
also manifolds. The classical Grassmann manifolds are Gn(Rm), where m ≥n (n-planes in m space).
They are connected n(m −n)-manifolds. Furthermore, Gn(Rm) is compact. To see this, consider the set
Fn,m of orthogonal sets of n unit vectors in Rm. Since Fn,m is closed and bounded in Rm × · · · × Rm (n
times), Fn,m is compact. Thus Gn(Rm) is compact, since it is the continuous image of Fn,m by the map
{e1, . . . , en} →span {e1, . . . , en}.
H. Projective spaces
Let RPn = G1(Rn+1) = the set of lines in Rn+1. Thus from the previous example,
RPn is a compact connected real n-manifold. Similarly CPn, the set of complex lines in Cn, is a compact
connected (complex) n-manifold. There is a projection π : Sn →RPn deﬁned by π(x) = span(x), which is a
diﬀeomorphism restricted to an open hemisphere. Thus, any chart for Sn produces one for RPn as well.
♦
Exercises
⋄3.1-1.
Let S = { (x, y) ∈R2 | xy = 0 }. Construct two “charts” by mapping each axis to the real line by
(x, 0) →x and (0, y) →y. What fails in the deﬁnition of a manifold?
⋄3.1-2.
Let S = ]0, 1[×]0, 1[ ⊂R2 and for each s, 0 ≤s ≤1 let Vs = {s}×]0, 1[ and ϕs : Vs →R, (s, t) →t.
Does this make S into a one-manifold?
⋄3.1-3.
Let S = { (x, y) ∈R2 | x2 −y2 = 1 }. Show that the two charts ϕ1 : { (x, y) ∈S | ±x > 0 } →R,
ϕ±(x, y) = y deﬁne a manifold structure on the disconnected set S.
⋄3.1-4.
On the topological space M obtained from [0, 2π] × R by identifying the point (0, x) with (2π, −x),
x ∈R, consider the following two charts:
(i)
(]0, 2π[ × R, identity), and
(ii)
(([0, π[ ∪]π, 2π[) × R, ϕ), where ϕ is deﬁned by ϕ(θ, x) = (θ, x) if 0 ≤θ < π and ϕ(θ, x) = (θ −2π, −x)
if π < θ < 2π. Show that these two charts deﬁne a manifold structure on M. This manifold is called
the M¨obius band (see Figure 3.4.3 and Example 3.4.10C for an alternative description). Note that
the chart (ii) joins 2π to 0 and twists the second factor R, as required by the topological structure of
M.
(iii)
Repeat a construction like (ii) for K, the Klein bottle.
⋄3.1-5 (Compactiﬁcation of Rn).
Let {∞} be a one point set and let Rn
c = Rn ∪{∞}. Deﬁne the charts
(U, ϕ) and (U∞, ϕ∞) by U = Rn, ϕ = identity on Rn, U∞= Rn
c \{0}, ϕ∞(x) = x/∥x∥2, if x ̸= ∞, and
ϕ∞(x) = 0, if x = ∞.
(i)
Show that the atlas Ac = {(U, ϕ), (U∞, ϕ∞)} deﬁnes a smooth manifold structure on Rn
c .
(ii)
Show that with the topology induced by Ac, Rn
c becomes a compact topological space. It is called the
one-point compactiﬁcation of Rn.

3.2 Submanifolds, Products, and Mappings
133
(iii)
Show that if n = 2, the diﬀerentiable structure of R2
c = Cc can be alternatively given by the chart
(U, ϕ) and the chart (U∞, ψ∞), where ψ∞(z) = z−1, if z ̸= ∞and ψ∞(z) = 0, if z = ∞.
(iv)
Show that stereographic projection induces a homeomorphism of Rn
c with Sn.
⋄3.1-6.
(i)
Deﬁne an equivalence relation ∼on Sn by x ∼y if x = ±y. Show that Sn/∼is homeomorphic
with RPn.
(ii)
Show that
(a)
eiθ ∈S1 →e2iθ ∈S1, and
(b)
(x, y) ∈S1 →(xy−1, if y ̸= 0 and ∞, if y = 0) ∈Rc ∼= S2 (see Exercise 3.1-5) induce homeomor-
phisms of S1 with RP1.
(iii)
Show that neither Sn nor RPn can be covered by a single chart.
⋄3.1-7.
(i)
Deﬁne an equivalence relation on S2n+1 ⊂C2(n+1) by x ∼y if y = eiθx for some θ ∈R. Show
S2n+1/∼is homeomorphic to CPn.
(ii)
Show that
(a)
(u, v) ∈S3 ⊂C2 →4(−u¯v, |v|2 −|u|2) ∈S2, and
(b)
(u, v) ∈S3 ⊂C2 →(uv−1, if v ̸= 0, and ∞, if v = 0) ∈R2
c ∼= S2 (see Exercise 3.1-5) induce
homeomorphisms of S2 with CP1. The map in (a) is called the classical Hopf ﬁbration; it will
be studied further in §3.4.
⋄3.1-8 (Flag manifolds).
Let F n denote the set of sequences of nested linear subspaces V1 ⊂V2 ⊂· · · ⊂
Vn−1 in Rn (or Cn), where dim Vi = i. Show that F n is a compact manifold and compute its dimension.
(Flag manifolds are typiﬁed by F n and come up in the study of symplectic geometry and representations of
Lie groups.)
Hint: Show that F n is in bijective correspondence with the quotient space GL(n)/upper triangular matrices.
3.2
Submanifolds, Products, and Mappings
A submanifold is the nonlinear analogue of a subspace in linear algebra. Likewise, the product of two
manifolds, producing a new manifold, is the analogue of a product vector space. The analogue of linear
transformations are the Cr maps between manifolds, also introduced in this section. We are not yet ready
to diﬀerentiate these mappings; this will be possible after we introduce the tangent bundle in §3.3.
Submanifolds.
If M is a manifold and A ⊂M is an open subset of M, the diﬀerentiable structure of M
naturally induces one on A. We call A an open submanifold of M. For example, Gn(E), Gn(E) are open
submanifolds of G(E) (see Example 3.1.8G). We would also like to say that Sn is a submanifold of Rn+1,
although it is a closed subset. To motivate the general deﬁnition we notice that there are charts in Rn+1 in
which a neighborhood of Sn becomes part of the subspace Rn. Figure 3.2.1 illustrates this for n = 1.
3.2.1 Deﬁnition.
A submanifold of a manifold M is a subset B ⊂M with the property that for each
b ∈B there is an admissible chart (U, ϕ) in M with b ∈U which has the submanifold property, namely,
that ϕ has the form
SM.
ϕ : U →E × F,
and
ϕ(U ∩B) = ϕ(U) ∩(E × {0}).
An open subset V of M is a submanifold in this sense. Here we merely take F = {0}, and for x ∈V use
any chart (U, ϕ) of M for which x ∈U.

134
3. Manifolds and Vector Bundles
                  S1
U
R2
R2
ϕ
Figure 3.2.1. Submanifold charts for S1
3.2.2 Proposition.
Let B be a submanifold of a manifold M. Then B itself is a manifold with diﬀeren-
tiable structure generated by the atlas:
{ (U ∩B, ϕ|U ∩B) | (U, ϕ) is an admissible chart in M
having property SM for B }.
Furthermore, the topology on B is the relative topology.
Proof.
If Ui ∩Uj ∩B ̸= ∅, and (Ui, ϕi) and (Uj, ϕj) both have the submanifold property, and if we write
ϕi = (αi, βi) and ϕj = (αj, βj), where αi : Ui →E, αj : Uj →E, βi : Ui →F, and βj : Uj →F, then the
maps
αi|Ui ∩B : Ui ∩B →ϕi(Ui) ∩(E × {0})
and
αj|Uj ∩B : Uj ∩B →ϕj(Uj) ∩(E × {0})
are bijective. The overlap map (ϕj|Uj ∩B) ◦(ϕi|Ui ∩B)−1 is given by (e, 0) →((αj ◦α−1
i )(e), 0) = ϕji(e, 0)
and is C∞, being the restriction of a C∞map. The last statement is a direct consequence of the deﬁnition
of relative topology and Deﬁnition 3.2.1.
■
If M is an n-manifold and B a submanifold of M, the codimension of B in M is deﬁned by codim B =
dim M −dim B. Note that open submanifolds are characterized by having codimension zero.
In §3.5 methods are developed for proving that various subsets are actually submanifolds, based on the
implicit function theorem. For now we do a case “by hand.”
3.2.3 Example.
To show that Sn ⊂Rn+1 is a submanifold, it is enough to observe that the charts in
the atlas {(U ±
i , ψ±
i )}, i = 1, . . . , n + 1 of Sn come from charts of Rn+1 with the submanifold property (see
Example 3.1.4): the 2(n + 1) maps
χ±
i : { x ∈Rn+1 | ±xi > 0 }
→{ y ∈Rn+1 | (yn+1 + 1)2 > (y1)2 + · · · + (yn)2 }
given by
χ±
i (x1, . . . , xn+1) = (x1, . . . , xi−1, xi+1, . . . , xn+1, ∥x∥−1)
are C∞diﬀeomorphisms, and charts in an atlas of Rn+1. Since
(χ±
i |U ±
i )(x1, . . . , xn+1) = (x1, . . . , xi−1, xi+1, . . . , xn+1, 0),
they have the submanifold property for Sn.
♦

3.2 Submanifolds, Products, and Mappings
135
Products of Manifolds.
Now we show how to make the product of two manifolds into a manifold.
3.2.4 Deﬁnition.
Let (S1, D1) and (S2, D2) be two manifolds. The product manifold (S1 ×S2, D1 ×D2)
consists of the set S1 × S2 together with the diﬀerentiable structure D1 × D2 generated by the atlas { (U1 ×
U2, ϕ1 × ϕ2) | (Ui, ϕi) is a chart of (Si, Di), i = 1, 2 }.
That the set in this deﬁnition is an atlas follows from the fact that if ψ1 : U1 ⊂E1 →V1 ⊂F1
and ψ2 : U2 ⊂E2 →V2 ⊂F2, then ψ1 × ψ2 is a diﬀeomorphism iﬀψ1 and ψ2 are, and in this case
(ψ1 × ψ2)−1 = ψ−1
1
× ψ−1
2 . It is clear that the topology on the product manifold is the product topology.
Also, if S1, S2 are ﬁnite dimensional, dim(S1 × S2) = dim S1 + dim S2. Inductively one deﬁnes the product
of a ﬁnite number of manifolds. A simple example of a product manifold is the n-torus Tn = S1 × · · · × S1
(n times).
Mappings between Manifolds.
The following deﬁnition introduces two important ideas: the local rep-
resentative of a map and the concept of a Cr map between manifolds.
3.2.5 Deﬁnition.
Suppose f : M →N is a mapping, where M and N are manifolds. We say f is of class
Cr, (where r is a nonnegative integer), if for each x in M and admissible chart (V, ψ) of N with f(x) ∈V ,
there is a chart (U, ϕ) of M satisfying x ∈U, and f(U) ⊂V , and such that the local representative of f,
fϕψ = ψ ◦f ◦ϕ−1, is of class Cr. (See Figure 3.2.2.)
M
N
V
U
fϕψ
f
ϕ
ψ
Figure 3.2.2. A local representative of a map
For r = 0, this is consistent with the deﬁnition of continuity of f, regarded as a map between topological
spaces (with the manifold topologies).
3.2.6 Proposition.
Let f : M →N be a continuous map of manifolds. Then f is Cr iﬀthe local repre-
sentatives of f relative to a collection of charts which cover M and N are Cr.
Proof.
Assume that the local representatives of f relative to a collection of charts covering M and N are
Cr. If (U, ϕ) and (U, ϕ′) are charts in M and (V, ψ), (V, ψ′) are charts in N such that fϕψ is Cr, then the
composite mapping theorem and condition MA2 of Deﬁnition 3.1.1 show that fϕ′ψ′ = (ψ′ ◦ψ−1) ◦fϕψ ◦
(ϕ′ ◦ϕ−1)−1 is also Cr. Moreover, if ϕ′′ and ψ′′ are restrictions of ϕ and ψ to open subsets of U and V , then
fϕ′′ψ′′ is also Cr. Finally, note that if f is Cr on open submanifolds of M, then it is Cr on their union. That
f is Cr now follows from the fact that any chart of M can be obtained from the given collection by change
of diﬀeomorphism, restrictions, and/or unions of domains, all three operations preserving the Cr character
of f. This argument also demonstrates the converse.
■

136
3. Manifolds and Vector Bundles
Any map from (open subsets of) E to F which is Cr in the Banach space sense is Cr in the sense of
Deﬁnition 3.2.5. Other examples of C∞maps are the antipodal map x →−x of Sn and the translation map
by (θ1, . . . , θn) on Tn given by
(exp(ir1), . . . , exp(irn)) →(exp(i(r1 + θ1)), . . . , exp(i(rn + θn))).
From the previous proposition and the composite mapping theorem, we get the following.
3.2.7 Proposition.
If f : M →N and g : N →P are Cr maps, then so is g ◦f.
3.2.8 Deﬁnition.
A map f : M →N, where M and N are manifolds, is called a Cr diﬀeomorphism
if f is of class Cr, is a bijection, and f −1 : N →M is of class Cr. If a diﬀeomorphism exists between two
manifolds, they are called diﬀeomorphic.
It follows from Proposition 3.2.7 that the set Diﬀr (M) of Cr diﬀeomorphisms of M forms a group under
composition. This large and intricate group will be encountered again several times in the book.
Exercises
⋄3.2-1.
Show that
(i)
if (U, ϕ) is a chart of M and ψ : ϕ(U) →V ⊂F is a diﬀeomorphism, then (U, ψ ◦ϕ) is an admissible
chart of M, and
(ii)
admissible local charts are diﬀeomorphisms.
⋄3.2-2.
A C1 diﬀeomorphism that is also a Cr map is a Cr diﬀeomorphism.
Hint: Use the comments after the proof of Theorem 2.5.2.
⋄3.2-3.
Show that if Ni ⊂Mi are submanifolds, i = 1, ..., n, then N1 × · · · × Nn is a submanifold of
M1 × · · · × Mn.
⋄3.2-4.
Show that every submanifold N of a manifold M is locally closed in M; that is, every point n ∈N
has a neighborhood U in M such that N ∩U is closed in U.
⋄3.2-5.
Show that fi : Mi →Ni, i = 1, . . . , n are all Cr iﬀ
f1 × · · · × fn : M1 × · · · × Mn →N1 × · · · × Nn
is Cr.
⋄3.2-6.
Let M be a set and {Mi}i∈I a covering of M, each Mi being a manifold. Assume that for every pair
of indices (i, j), Mi ∩Mj is an open submanifold in both Mi and Mj. Show that there is a unique manifold
structure on M for which the Mi are open submanifolds. The diﬀerentiable structure on M is said to be
obtained by the collation of the diﬀerentiable structures of Mi.
⋄3.2-7.
Show that the map F →F0 = { u ∈F∗| u|F = 0 } of G(E) into G(E∗) is a C∞map. If E = E∗∗
(i.e., E is reﬂexive) it restricts to a C∞diﬀeomorphism of Gn(E) onto Gn(E∗) for all n = 1, 2, . . . . Conclude
that RPn is diﬀeomorphic to Gn(Rn+1).
⋄3.2-8.
Show that the two diﬀerentiable structures of R deﬁned in Example 3.1.8D are diﬀeomorphic.
Hint: Consider the map x →x1/3.
⋄3.2-9.
(i)
Show that S1 and RP1 are diﬀeomorphic manifolds (see Exercise 3.1-6(b)).

3.2 Submanifolds, Products, and Mappings
137
(ii)
Show that CP1 is diﬀeomorphic to S2 (see Exercise 3.1-7(b)).
⋄3.2-10.
Let Mλ = { (x, |x|λ) | x ∈R }, where λ ∈R. Show that
(i)
if λ ≤0, Mλ is a C∞submanifold of R2;
(ii)
if λ > 0 is an even integer, Mλ is a C∞submanifold of R2;
(iii)
if λ > 0 is an odd integer or not an integer, then Mλ is a C[λ] submanifold of R2 which is not C[λ]+1,
where [λ] denotes the smallest integer ≥λ, that is, [λ] ≤λ < [λ] + 1;
(iv)
in case (iii), show that Mλ is the union of three disjoint C∞submanifolds of R2.
⋄3.2-11.
Let M be a Ck submanifold. Show that the diagonal ∆= { (m, m) | m ∈M } is a closed Ck
submanifold of M × M.
⋄3.2-12.
Let E be a Banach space. Show that the map x →Rx(R2 −∥x∥2)−1/2 is a diﬀeomorphism of
the open ball of radius R with E. Conclude that any manifold M modeled on E has an atlas {(Ui, ϕi)} for
which ϕi(Ui) = E.
⋄3.2-13.
If f : M →N is of class Ck and S is a submanifold of M, show that f|S is of class Ck.
⋄3.2-14.
Let M and N be Cr manifolds and f : M →N be a continuous map. Show that f is of class Ck,
1 ≤k ≤r if and only if for any open set U in N and any Ck map g : U →E, E a Banach space, the map
g ◦f : f −1(U) →E is Ck.
⋄3.2-15.
Let π : Sn →RPn denote the projection. Show that f : RPn →M is smooth iﬀthe map
f ◦π : Sn →M is smooth; here M denotes another smooth manifold.
⋄3.2-16 (Covering Manifolds).
Let M and N be smooth manifolds and let p : M →N be a smooth map.
The map p is called a covering, or equivalently, M is said to cover N, if p is surjective and each point
n ∈N admits an open neighborhood V such that p−1(V ) is a union of disjoint open sets, each diﬀeomorphic
via p to V .
(i)
Path lifting property.
Suppose p : M →N is a covering and p(m0) = n0, where n0 ∈N and
m0 ∈M. Let c : [0, 1] →N be a Ck path, k ≥0, starting at n0 = c(0). Show that there is a unique
Ck path d : [0, 1] →M, such that d(0) = m0 and p ◦d = c.
Hint: Partition [0, 1] into a ﬁnite set of closed intervals [ti, ti+1], i = 0, . . . , n −1, where t0 = 0
and tn = 1, such that each of the sets c([ti, ti+1]) lies entirely in a neighborhood Vi guaranteed
by the covering property of p. Let U0 be the open set in the union p−1(V0) containing m0. Deﬁne
d0 : [0, t1] →U0 by d0 = p−1 ◦c|[0, t1]. Let V1 be the open set containing c([t1, t2]) and U1 be the open
set in the union p−1(V1) containing d(t1). Deﬁne the map d1 : [t1, t2] →U1 by d1 = p−1 ◦c|[t1, t2]. Now
proceed inductively. Show that d so obtained is Ck if c is and prove the construction is independent
of the partition of [0, 1].
(ii)
Homotopy lifting property.
In the hypotheses and notations of (i), let H : [0, 1]×[0, 1] →N be a
Ck map, k ≥0 and assume that H(0, 0) = n0. Show that there is a unique Ck-map K : [0, 1]×[0, 1] →
M such that K(0, 0) = m0 and p ◦K = H.
Hint: Apply the reasoning in (i) to the square [0, 1] × [0, 1].
(iii)
Show that if two curves in N are homotopic via a homotopy keeping the endpoints ﬁxed, then the
lifted curves are also homotopic via a homotopy keeping the endpoints ﬁxed.
(iv)
Assume that pi : Mi →N are coverings of N with Mi connected, i = 1, 2. Show that if M1 is simply
connected, then M1 is also a covering of M2.

138
3. Manifolds and Vector Bundles
Hint: Choose points n0 ∈N, m1 ∈M1, m2 ∈M2 such that pi(mi) = n0, i = 1, 2. Let x ∈M1 and let
c1(t) be a Ck-curve (k is the diﬀerentiability class of M1, M2, and N) in M1 such that c1(0) = m1,
c1(1) = x. Then c(t) = (p ◦c1)(t) is a curve in N connecting n0 to p1(x). Lift this curve to a curve
c2(t) in M2 connecting m2 to y = c2(1) and deﬁne q : M1 →M2 by q(x) = y. Show by (iii) that q is
well deﬁned and Ck. Then show that q is a covering.
(v)
Show that if pi : Mi →N, i = 1, 2 are coverings with M1 and M2 simply connected, then M1 and M2
are Ck-diﬀeomorphic. This is why a simply connected covering of N is called the universal covering
manifold of N.
⋄3.2-17 (Construction of the universal covering manifold).
Let N be a connected (hence arcwise connected)
manifold and ﬁx n0 ∈N. Let M denote the set of homotopy classes of paths c : [0, 1] →N, c(0) = n0,
keeping the endpoints ﬁxed. Deﬁne p : M →N by p([c]) = c(1), where [c] is the homotopy class of c.
(i)
Show that p is onto since N is arcwise connected.
(ii)
For an open set U in N deﬁne U[c] = { [c ∗d] | d is a path in U starting at c(1) }. (See Exercise 1.6-6
for the deﬁnition of c ∗d.) Show that B = { ∅, U[c] | c is a path in N starting at n0 and U is open in
N } is a basis for a topology on M. Show that if N is Hausdorﬀ, so is M. Show that p is continuous.
(iii)
Show that M is arcwise connected.
Hint: A continuous path
ϕ : [0, 1] →M,
ϕ(0) = [c] and ϕ(1) = [d]
is given by ϕ(s) = [cs], for s ∈[0, 1/2], and ϕ(s) = [ds], for s ∈[1/2, 1], where
cs(t) = c((1 −2s)t),
ds(t) = d((2s −1)t).
(iv)
Show that p is an open map.
Hint: If n ∈p(U[c]) then the set of points in U that can be joined to n by paths in U is open in N
and included in p(U[c]).
(v)
Use (iv) to show that p : M →N is a covering.
Hint: Let U be a contractible chart domain of N and show that
p−1(U) =

U[c],
where the union is over all paths c with p([c]) = n, n a ﬁxed point in U.
(vi)
Show that M is simply connected.
Hint: If ψ : [0, 1] →M is a loop based at [c], that is, ψ is continuous and ψ(0) = ψ(1) = [c], then
H : [0, 1] × [0, 1] →M given by H(·, s) = [cs], cs(t) = c(ts) is a homotopy of [c] with the constant path
[c(0)].
(vii)
If (U, ϕ) is a chart on N whose domain is such that p−1(U) is a disjoint union of open sets in M each
diﬀeomorphic to U (see (v)), deﬁne ψ : V →E by ψ = ϕ ◦p|V . Show that the atlas deﬁned in this
way deﬁnes a manifold structure on M. Show that M is locally diﬀeomorphic to N.

3.3 The Tangent Bundle
139
3.3
The Tangent Bundle
Recall that for f : U ⊂E →V ⊂F of class Cr+1 we deﬁne the tangent of f, Tf : TU →TV by setting
TU = U × E, TV = V × F, and
Tf(u, e) = (f(u), Df(u) · e)
and that the chain rule reads
T(g ◦f) = Tg ◦Tf.
If for each open set U in some vector space E, τU : TU →U denotes the projection, the diagram
TU
TV
U
V
Tf
f
τU
τV
✲
✲
❄
❄
is commutative, that is, f ◦τU = τV ◦Tf.
The tangent operation T can now be extended from this local context to the context of diﬀerentiable
manifolds and mappings. During the deﬁnitions it may be helpful to keep in mind the example of the family
of tangent spaces to the sphere Sn ⊂Rn+1.
A major advance in diﬀerential geometry occurred when it was realized how to deﬁne the tangent space
to an abstract manifold independent of any embedding in Rn.2 Several alternative ways to do this can be
used according to taste as we shall now list; see Spivak [1979] for further information.
Coordinates.
Using transformation properties of vectors under coordinate changes, one deﬁnes a tangent
vector at m ∈M to be an equivalence class of triples (U, ϕ, e), where ϕ : U →E is a chart and e ∈E, with
two triples identiﬁed if they are related by the tangent of the corresponding overlap map evaluated at the
point corresponding to m ∈M.
Derivations.
This approach characterizes a vector by specifying a map that gives the derivative of a
general function in the direction of that vector.
Ideals.
This is a variation of alternative 2. Here TmM is deﬁned to be the dual of I(0)
m /I(1)
m , where I(j)
m is
the ideal of functions on M vanishing up to order j at m.
Curves.
This is the method followed here. We abstract the idea that a tangent vector to a surface is the
velocity vector of a curve in the surface.
If [a, b] is a closed interval, a continuous map c : [a, b] →M is said to be diﬀerentiable at the endpoint
a if there is a chart (U, ϕ) at c(a) such that
lim
t↓a
(ϕ ◦c)(t) −(ϕ ◦c)(a)
t −a
exists and is ﬁnite; this limit is denoted by (ϕ ◦c)′(a). If (V, ψ) is another chart at c(a) and we let v =
(ϕ ◦c)(t) −(ϕ ◦c)(a), then in U ∩V we have
(ψ ◦ϕ−1)((ϕ ◦c)(t)) −(ψ ◦ϕ−1)((ϕ ◦c)(a))
= D(ψ ◦ϕ−1)((ϕ ◦c)(a)) · v + o(∥v∥),
2The history is not completely clear to us, but this idea seems to be primarily due to Riemann, Weyl, and Levi-Civit`a and
was “well known” by 1920.

140
3. Manifolds and Vector Bundles
whence
(ψ ◦c)(t) −(ψ ◦c)(a)
t −a
= D(ψ ◦ϕ−1)(ϕ ◦c)(a) · v
t −a
+ o(∥v∥)
t −a .
Since
lim
t↓a
v
t −a = (ϕ ◦c)′(a)
and
lim
t↓a
o(∥v∥)
t −a = 0
it follows that
lim
t↓a
[(ψ ◦c)(t) −(ψ ◦c)(a)]
t −a
= D(ψ ◦ϕ−1)((ϕ ◦c)(a)) · (ϕ ◦c)′(a)
and therefore the map c : [a, b] →M is diﬀerentiable at a in the chart (U, ϕ) iﬀit is diﬀerentiable at a
in the chart (V, ψ). In summary, it makes sense to speak of diﬀerentiability of curves at an endpoint of a
closed interval. The map c : [a, b] →M is said to be diﬀerentiable if c|]a, b[ is diﬀerentiable and if c is
diﬀerentiable at the endpoints a and b. The map c : [a, b] →M is said to be of class C1 if it is diﬀerentiable
and if (ϕ ◦c)′ : [a, b] →E is continuous for any chart (U, ϕ) satisfying U ∩c([a, b]) ̸= ∅, where E is the
model space of M.
3.3.1 Deﬁnition.
Let M be a manifold and m ∈M. A curve at m is a C1 map c : I →M from an
interval I ⊂R into M with 0 ∈I and c(0) = m. Let c1 and c2 be curves at m and (U, ϕ) an admissible
chart with m ∈U. Then we say c1 and c2 are tangent at m with respect to ϕ if and only if (ϕ◦c1)′(0) =
(ϕ ◦c2)′(0).
Thus, two curves are tangent with respect to ϕ if they have identical tangent vectors (same direction and
speed) in the chart ϕ; see Figure 3.3.1.
0
I
c1
c2
m
ϕ
F
U
R
U ′
Figure 3.3.1. Tangent curves
The reader can safely assume in what follows that I is an open interval; the use of closed intervals
becomes essential when deﬁning tangent vectors to a manifold with boundary at a boundary point; this will
be discussed in Chapter 7.
3.3.2 Proposition.
Let c1 and c2 be two curves at m ∈M. Suppose (Uβ, ϕβ) are admissible charts with
m ∈Uβ, β = 1, 2. Then c1 and c2 are tangent at m with respect to ϕ1 if and only if they are tangent at m
with respect to ϕ2.
Proof.
By taking restrictions if necessary we may suppose that U1 = U2. Since we have the identity
ϕ2◦ci = (ϕ2◦ϕ−1
1 )◦(ϕ1◦ci), the C1 composite mapping theorem in Banach spaces implies that (ϕ2◦c1)′(0) =
(ϕ2 ◦c2)′(0) iﬀ(ϕ1 ◦c1)′(0) = (ϕ1 ◦c2)′(0).
■

3.3 The Tangent Bundle
141
This proposition guarantees that the tangency of curves at m ∈M is a notion that is independent of the
chart used. Thus we say c1, c2 are tangent at m ∈M if c1, c2 are tangent at m with respect to ϕ, for any
local chart ϕ at m. It is evident that tangency at m ∈M is an equivalence relation among curves at m. An
equivalence class of such curves is denoted [c]m, where c is a representative of the class.
3.3.3 Deﬁnition.
For a manifold M and m ∈M the tangent space to M at m is the set of equivalence
classes of curves at m:
TmM = { [c]m | c is a curve at m }.
For a subset A ⊂M, let
TM|A =

m∈A
TmM
(disjoint union).
We call TM = TM|M the tangent bundle of M. The mapping τM : TM →M deﬁned by τM([c]m) = m
is the tangent bundle projection of M.
Let us show that if M = U, an open set in a Banach space E, TU as deﬁned here can be identiﬁed with
U × E. This will establish consistency with our usage of T in §2.3.
3.3.4 Lemma.
Let U be an open subset of E, and c be a curve at u ∈U. Then there is a unique e ∈E
such that the curve cu,e deﬁned by cu,e(t) = u + te (with t belonging to an interval I such that cu,e(I) ⊂U)
is tangent to c at u.
Proof.
By deﬁnition, Dc(0) is the unique linear map in L(R, E) such that the curve g : R →E given by
g(t) = u + Dc(0) · t is tangent to c at t = 0. If e = Dc(0) · 1, then g = cu,e.
■
Deﬁne a map i : U × E →T(U) by i(u, e) = [cu,e]u. The preceding lemma says that i is a bijection and
thus we can deﬁne a manifold structure on TU by means of i.
The tangent space TmM at a point m ∈M has an intrinisic vector space structure. This vector space
structure can be deﬁned directly by showing that addition and scalar multiplication can be deﬁned by the
corresponding operations in charts and that this deﬁnition is independent of the chart. This idea is very
important in the general study of vector bundles and we shall return to this point below.
Tangents of Mappings.
It will be convenient to deﬁne the tangent of a mapping before showing that
TM is a manifold. The idea is simply that the derivative of a map can be characterized by its eﬀect on
tangents to curves.
3.3.5 Lemma.
Suppose c1 and c2 are curves at m ∈M and are tangent at m. Let f : M →N be of class
C1. Then f ◦c1 and f ◦c2 are tangent at f(m) ∈N.
Proof.
From the C1 composite mapping theorem and the remarks prior to Deﬁnition 3.3.1, it follows that
f ◦c1 and f ◦c2 are of class C1. For tangency, let (V, ψ) be a chart on N with f(m) ∈V . We must show
that (ψ ◦f ◦c1)′(0) = (ψ ◦f ◦c2)′(0). But ψ ◦f ◦cα = (ψ ◦f ◦ϕ−1) ◦(ϕ ◦cα), where (U, ϕ) is a chart on M
with f(U) ⊂V . Hence the result follows from the C1 composite mapping theorem.
■
Now we are ready to consider the intrinsic way to look at the derivative.
3.3.6 Deﬁnition.
If f : M →N is of class C1, we deﬁne Tf : TM →TN by
Tf([c]m) = [f ◦c]f(m).
We call Tf the tangent of f.

142
3. Manifolds and Vector Bundles
The map Tf is well deﬁned, for if we choose any other representative from [c]m, say c1, then c and c1
are tangent at m and hence f ◦c and f ◦c1 are tangent at f(m), that is, [f ◦c]f(m) = [f ◦c1]f(m). By
construction the following diagram commutes.
TM
TN
M
N
Tf
f
τM
τN
✲
✲
❄
❄
The basic properties of T are summarized in the following.
3.3.7 Theorem (Composite Mapping Theorem).
(i)
Suppose f : M →N and g : N →K are Cr maps of manifolds. Then g ◦f : M →K is of class Cr
and
T(g ◦f) = Tg ◦Tf.
(ii)
If h : M →M is the identity map, then Th : TM →TM is the identity map.
(iii)
If f : M →N is a diﬀeomorphism, then Tf : TM →TN is a bijection and (Tf)−1 = T(f −1).
Proof.
(i)
Let (U, ϕ), (V, ψ), (W, ρ) be charts of M, N, K, with f(U) ⊂V and g(V ) ⊂W. Then the local
representatives are
(g ◦f)ϕρ = ρ ◦g ◦f ◦ϕ−1 = ρ ◦g ◦ψ−1 ◦ψ ◦f ◦ϕ−1 = gψρ ◦fϕψ.
By the composite mapping theorem in Banach spaces, this, and hence g ◦f, is of class Cr. Moreover,
T(g ◦f)[c]m = [g ◦f ◦c](g◦f)(m)
and
(Tg ◦Tf)[c]m = Tg([f ◦c]f(m)) = [g ◦f ◦c](g◦f)(m).
Hence T(g ◦f) = Tg ◦Tf.
Part (ii) follows from the deﬁnition of T. For (iii), f and f −1 are diﬀeomorphisms with f ◦f −1 the identity
of N, while f −1 ◦f is the identity on M. Using (i) and (ii), Tf ◦Tf −1 is the identity on TN while Tf −1 ◦Tf
is the identity on TM. Thus (iii) follows.
■
Next, let us show that in the case of local manifolds, Tf as deﬁned in §2.4, which we temporarily denote
f ′, coincides with Tf as deﬁned here.
3.3.8 Lemma.
Let U ⊂E and V ⊂F be local manifolds (open subsets) and f : U →V be of class C1.
Let i : U × E →TU be the map deﬁned following Lemma 3.3.4. Then the diagram
U × E
V × F
TU
TV
f ′
Tf
i
i
✛
✛
❄
❄
commutes; that is, Tf ◦i = i ◦f ′.

3.3 The Tangent Bundle
143
Proof.
For (u, e) ∈U × E, we have (Tf ◦i)(u, e) = Tf · [cu,e]u = [f ◦cu,e]f(u). Also, we have the identities
(i ◦f ′)(u, e) = i(f(u), Df(u) · e) = [cf(u),D f(u)·e]f(u). These will be equal provided the curves t →f(u + te)
and t →f(u) + t(Df(u) · e) are tangent at t = 0. But this is clear from the deﬁnition of the derivative and
the composite mapping theorem.
■
This lemma states that if we identify U ×E and TU by means of i then we should correspondingly identify
f ′ and Tf. Thus we will just write Tf and suppress the identiﬁcation. Theorem 3.3.7 implies the following.
3.3.9 Lemma.
If f : U ⊂E →V ⊂F is a Cr diﬀeomorphism, then Tf : U × E →V × F is a Cr−1
diﬀeomorphism.
The Manifold Structure on TM.
For a chart (U, ϕ) on a manifold M, we deﬁne Tϕ : TU →T(ϕ(U))
by Tϕ([c]u) = (ϕ(u), (ϕ ◦c)′(0)). Then Tϕ is a bijection, since ϕ is a diﬀeomorphism. Hence, on TM we can
regard (TU, Tϕ) as a local chart.
3.3.10 Theorem.
Let M be a Cr+1 manifold and A an atlas of admissible charts. Then TA = { (TU, Tϕ) |
(U, ϕ) ∈A } is a Cr atlas of TM called the natural atlas.
Proof.
Since the union of chart domains of A is M, the union of the corresponding TU is TM. To verify
MA2, suppose we have TUi ∩TUj ̸= ∅. Then Ui ∩Uj ̸= ∅and therefore the overlap map ϕi ◦ϕ−1
j
can be
formed by restriction of ϕi ◦ϕ−1
j
to ϕj(Ui ∩Uj). The chart overlap map Tϕi ◦(Tϕj)−1 = T(ϕi ◦ϕ−1
j ) is a
Cr diﬀeomorphism by Lemma 3.3.9.
■
Hence TM has a natural Cr manifold structure induced by the diﬀerentiable structure of M. If M is n-
dimensional, Hausdorﬀ, and second countable, TM will be 2n-dimensional, Hausdorﬀ, and second countable.
Since the local representative of τM is (ϕ◦τM ◦Tϕ−1)(u, e) = u, the tangent bundle projection is a Cr map.
Let us next develop some of the simplest properties of tangent maps. First of all, let us check that tangent
maps are smooth.
3.3.11 Proposition.
Let M and N be Cr+1 manifolds, and let f : M →N be a map of class Cr+1. Then
Tf : TM →TN is a map of class Cr.
Proof.
It is enough to check that Tf is a Cr map using the natural atlas. For m ∈M choose charts (U, ϕ)
and (V, ψ) on M and N so that m ∈U, f(m) ∈V and fϕψ = ψ ◦f ◦ϕ−1 is of class Cr+1. Using (TU, Tϕ)
for TM and (TV, Tψ) for TN, the local representative (Tf)T ϕ,T ψ = Tψ ◦Tf ◦Tϕ−1 = Tfϕψ is given by
Tfϕψ(u, e) = (u, Dfϕψ(u) · e), which is a Cr map.
■
Higher Order Tangents.
Now that TM has a manifold structure we can form higher tangents. For
mappings f : M →N of class Cr, deﬁne T rf : T rM →T rN inductively to be the tangent of T r−1f :
T r−1M →T r−1N. Induction shows: If f : M →N and g : N →K are Cr mappings of manifolds, then
g ◦f is of class Cr and T r(g ◦f) = T rg ◦T rf.
Let us apply the tangent construction to the manifold TM and its projection. This gives the tangent
bundle of TM, namely τT M : T(TM) →TM. In coordinates, if (U, ϕ) is a chart in M, then (TU, Tϕ) is a
chart of TM, (T(TU), T(Tϕ)) is a chart of T(TM), and thus the local representative of τT M is (Tϕ ◦τT M ◦
T(Tϕ−1)) : (u, e, e1, e2) →(u, e). On the other hand, taking the tangent of the map τM : TM →M, we get
TτM : T(TM) →TM. The local representative of TτM is
(Tϕ ◦TτM ◦T(Tϕ−1))(u, e, e1, e2) = T(ϕ ◦τM ◦Tϕ−1)(u, e, e1, e2)
= (u, e1).
Applying the commutative diagram for Tf following Deﬁnition 3.3.6 to the case f = τM, we get what is
commonly known as the dual tangent rhombic:

144
3. Manifolds and Vector Bundles
T(TM)
M
TM
TM
τT M
TτM
τM
τM




✠
❅
❅
❅
❅
❘
❅
❅
❅
❅
❘




✠
Tangent Bundles of Product Manifolds.
Here and in what follows, tangent vectors will often be
denoted by single letters such as v ∈TmM.
3.3.12 Proposition.
Let M1 and M2 be manifolds and pi : M1 × M2 →Mi, i = 1, 2, the two canonical
projections. The map
(Tp1, Tp2) : T(M1 × M2) →TM1 × TM2
deﬁned by (Tp1, Tp2)(v) = (Tp1(v), Tp2(v)) is a diﬀeomorphism of the tangent bundle T(M1 ×M2) with the
product manifold TM1 × TM2.
Proof.
The local representative of this map is
(u1, u2, e1, e2) ∈U1 × U2 × E1 × E2
→((u1, e1) , (u2, e2)) ∈(U1 × E1) × (U2 × E2) ,
which clearly is a local diﬀeomorphism.
■
Partial Tangents.
Since the tangent is just a global version of the derivative, statements concerning
partial derivatives might be expected to have analogues on manifolds. To eﬀect these analogies, we globalize
the deﬁnition of partial derivatives.
Let M1, M2, and N be manifolds, and f : M1 × M2 →N be a Cr map. For (p, q) ∈M1 × M2, let
ip : M2 →M1 × M2 and iq : M1 →M1 × M2 be given by
ip(y) = (p, y),
iq(x) = (x, q),
and deﬁne T1f(p, q) : TpM1 →Tf(p,q)N and T2f(p,q) : TqM2 →Tf(p,q)N by
T1f(p, q) = Tp(f ◦iq),
T2f(p, q) = Tq(f ◦ip).
With these notations the following proposition giving the behavior of T under products is a straightforward
veriﬁcation using the deﬁnition and local diﬀerential calculus.
In the following proposition we will use the important fact that each tangent space TmM to a manifold
at m ∈M, has a natural vector space structure consistent with the vector space structure in local charts.
We will return to this point in detail in §3.4.
3.3.13 Proposition.
Let M1, M2, N, and P be manifolds, gi : P →Mi, i = 1, 2, and f : M1 × M2 →N
be Cr maps, r ≥1. Identify T(M1 × M2) with TM1 × TM2. Then the following statements hold.
(i)
T(g1 × g2) = Tg1 × Tg2.

3.3 The Tangent Bundle
145
(ii)
Tf(up, vq) = T1f(p, q)(up) + T2f(p, q)(vq), for up ∈TpM1 and vq ∈TqM2.
(iii) (Implicit Function Theorem.) If T2f(p, q) is an isomorphism, then there exist open neighborhoods U
of p in M1, W of f(p, q) in N, and a unique Cr map g : U ×W →M2 such that for all (x, w) ∈U ×W,
f(x, g(x, w)) = w.
In addition,
T1g(x, w) = −(T2f(x, g(x, w)))−1 ◦(T1f(x, g(x, w)))
and
T2g(x, w) = (T2f(x, g(x, w)))−1.
3.3.14 Examples.
A. The tangent bundle TS1 of the circle.
Consider the atlas with the four charts { (U ±
i , ψ±
i ) | i =
1, 2 } of
S1 = { (x, y) ∈R2 | x2 + y2 = 1 }
from Example 3.1.4. Let us construct the natural atlas for
TS1 = { ((x, y), (u, v)) ∈R2 × R2 | x2 + y2 = 1, ⟨(x, y), (u, v)⟩= 0 }.
Since the map
ψ+
1 : U +
1 = { (x, y) ∈S1 | x > 0 } →]−1, 1[
is given by ψ+
1 (x, y) = y, by deﬁnition of the tangent we have
T(x,y)ψ+
1 (u, v) = (y, v),
Tψ+
1 : TU +
1 →]−1, 1[×R.
Proceed in the same way with the other three charts. Thus, for example, T(x,y)ψ−1
2 (u, v) = (x, u) and hence
for x ∈]−1, 0[,
(Tψ−
2 ◦T(ψ+
1 )−1)(y, v) =

1 −y2, −
yv

1 −y2

.
This gives a complete description of the tangent bundle. But more can be said. Thinking of S1 as the
multiplicative group of complex numbers with modulus 1, we shall show that the group operations are
C∞: the inversion I : s →s−1 has local representative (ψ±
1 ◦I ◦(ψ±
1 )−1)(x) = −x and the composition
C : (s1, s2) →s1s2 has local representative
(ψ1 ◦C ◦(ψ±
1 × ψ±
1 )−1)(x1, x2) = x1

1 −x2
2 + x2

1 −x2
1
(here ± can be taken in any order). Thus for each s ∈S1, the map Ls : S1 →S1 deﬁned by Ls(s′) = ss′,
is a diﬀeomorphism. This enables us to deﬁne a map λ : TS1 →S1 × R by λ(vs) = (s, TsL−1
s (vs)), which is
easily seen to be a diﬀeomorphism. Thus, TS1 is diﬀeomorphic to S1 × R. See Figure 3.3.2.
B. The tangent bundle TTn to the n-torus.
Since Tn = S1 × · · · × S1 (n times) and TS1 ∼= S1 × R,
it follows that TTn ∼= Tn × Rn.

146
3. Manifolds and Vector Bundles
Non trivial tangent bundle
Trivial tangent bundle
S1
S1
s
TsS1
S2
p
TpS2
R
Figure 3.3.2. Trivial and nontrivial tangent bundles
C. The tangent bundle TS2 to the sphere.
The previous examples yielded trivial tangent bundles.
In general this is not the case, the tangent bundle to the two-sphere being a case in point, which we now
describe. Choose the atlas with six charts { (U ±
i , ψ±
i ) | i = 1, 2, 3 } of S2 that were given in Example 3.1.4.
Since
ψ±
1 : U +
1 = { (x1, x2, x3) ∈S2 | x1 > 0 }
→D1(0) = { (x, y) ∈R2 | x2 + y2 < 1 },
ψ+
1 (x1, x2, x3) = (x2, x3),
we have
T(x1,x2,x3)ψ+
1 (v1, v2, v3) = (x2, x3, v2, v3),
where x1v1 + x2v2 + x3v3 = 0. Similarly, construct the other ﬁve charts. For example, one of the twelve
overlap maps for x2 + y2 < 1, and y < 0, is
(Tψ−
3 ◦(Tψ+
1 )−1)(x, y, u, v)
=

1 −x2 −y2, x,
−ux

1 −x2 −y2 −
vy

1 −x2 −y2 , u

.
One way to see that TS2 is not trivial is to use the topological fact that any vector ﬁeld on S2 must
vanish somewhere. We shall prove this fact in §7.5.
♦
Exercises
⋄3.3-1.
Let M and N be manifolds and f : M →N.

3.3 The Tangent Bundle
147
(i)
Show that
(a)
if f is C∞, then graph (f) = { (m, f(m)) ∈M × N | m ∈M } is a C∞submanifold of M × N
and
(b)
T(m,f(m))(M × N) ∼= T(m,f(m))(graph(f)) ⊕Tf(m)N for all m ∈M.
(c)
Show that the converse of (a) is false.
Hint: x ∈R →x1/3 ∈R.
(d)
Show that if (a) and (b) hold, then f is C∞.
(ii)
If f is C∞show that the canonical projection of graph(f) onto M is a diﬀeomorphism.
(iii)
Show that T(m,f(m))(graph(f)) ∼= graph(Tmf) = { (vm, Tmf(vm)) | vm ∈TmM } ⊂TmM × Tf(m)N.
⋄3.3-2.
(i)
Show that there is a map sM : T(TM) →T(TM) such that sM ◦sM = identity and the
diagram
τM
T(TM)
T(TM)
τT M
TτM
sM
✛
✲
sM
❅
❅
❅
❅
❘




✒
commutes.
Hint: In a chart, sM(u, e, e1, e2) = (u, e1, e, e2).)
One calls sM the canonical involution on M and says that T(TM) is a symmetric rhombic.
(ii)
Verify that for f : M →N of class C2, T 2f ◦sM = sN ◦T 2f.
(iii)
If X is a vector ﬁeld on M, that is, a section of τM : TM →M, show that TX is a section of
TτM : T 2M →TM and X1 = sM ◦TX is a section of τT M : T 2M →TM. (A section σ of a map
f : A →B is a map σ : B →A such that f ◦σ = identity on B.)
⋄3.3-3.
(i)
Let S(S2) = { (v) ∈TS2 | ∥(v) ∥= 1 } be the circle bundle of S2. Prove that S(S2) is a
submanifold of TS2 of dimension three.
(ii)
Deﬁne f : S(S2) →RP3 by f(x, y, (v)) = the line through the origin in R4 determined by the vector
with components (x, y, v1, v2). Show that f is a diﬀeomorphism.
⋄3.3-4.
Let M be an n-dimensional submanifold of RN. Deﬁne the Gauss map Γ : M →Gn,N−n by
Γ(m) = TmM −m, that is, Γ(m) is the n-dimensional subspace of RN through the origin, which, when
translated by m, equals TmM. Show that Γ is a smooth map.
⋄3.3-5.
Let f : T2 →R be a smooth map. Show that f has at least four critical points (points where Tf
vanishes).
Hint: Parametrize T2 using angles θ, ϕ and locate the maximum and minimum points of f(θ, ϕ) for ϕ ﬁxed,
say (θmax(ϕ), ϕ) and (θmin(ϕ), ϕ); now maximize and minimize f as ϕ varies. How many critical points must
f : S2 →R have?

148
3. Manifolds and Vector Bundles
3.4
Vector Bundles
Roughly speaking, a vector bundle is a manifold with a vector space attached to each point. During the
formal deﬁnitions we may keep in mind the example of the tangent bundle to a manifold, such as the n-sphere
Sn. Similarly, the collection of normal lines to Sn form a vector bundle.
Deﬁnition of a Vector Bundle.
The deﬁnitions will follow the pattern of those for a manifold. Namely,
we obtain a vector bundle by smoothly patching together local vector bundles. The following terminology
for vector space products and maps will be useful.
3.4.1 Deﬁnition.
Let E and F be Banach spaces with U an open subset of E. We call the Cartesian
product U ×F a local vector bundle. We call U the base space, which can be identiﬁed with U ×{0}, the
zero section. For u ∈U, {u} × F is called the ﬁber of u, which we endow with the vector space structure
of F. The map π : U × F →U given by π(u, f) = u is called the projection of U × F. (Thus, the ﬁber over
u ∈U is π−1(u). Also note that U × F is an open subset of E × F and so is a local manifold.)
Next, we introduce the idea of a local vector bundle map. The main idea is that such a map must map a
ﬁber linearly to a ﬁber.
3.4.2 Deﬁnition.
Let U × F and U ′ × F′ be local vector bundles. A map ϕ : U × F →U ′ × F′ is called
a Cr local vector bundle map if it has the form ϕ(u, f) = (ϕ1(u), ϕ2(u) · f) where ϕ1 : U →U ′ and
ϕ2 : U →L(F, F′) are Cr. A local vector bundle map that has an inverse which is also a local vector bundle
map is called a local vector bundle isomorphism. (See Figure 3.4.1.)
F
F'
U1
U
ϕ2(U)
ϕ1
Figure 3.4.1. A vector bundle
A local vector bundle map ϕ : U × F →U ′ × F′ maps the ﬁber {u} × F into the ﬁber {ϕ1(u)} × F′ and
so restricted is linear. By Banach’s isomorphism theorem it follows that a local vector bundle map ϕ with
ϕ1 a local diﬀeomorphism is a local vector bundle isomorphism iﬀϕ2(u) is a Banach space isomorphism for
every u ∈U.
Supplement 3.4A
Smoothness of Local Vector Bundle Maps
In some examples, to check whether a map ϕ is a C∞local vector bundle map, one is faced with the rather
unpleasant task of verifying that ϕ2 : U →L(F, F′) is C∞. It would be nice to know that the smoothness
of ϕ as a function of two variables suﬃces. This is the context of the next proposition. We state the result
for C∞, but the proof contains a Cr result (with an interesting derivative loss) which is discussed in the
ensuing Remark A.

3.4 Vector Bundles
149
3.4.3 Proposition.
A map ϕ : U × F →U ′ × F′ is a C∞local vector bundle map iﬀϕ is C∞and is of
the form ϕ(u, f) = (ϕ1(u), ϕ2(u) · f), where ϕ1 : U →U ′ and ϕ2 : U →L(F, F′).
Proof (Craioveanu and Ratiu [1976]).
The evaluation map ev : L(F, F′) × F →F′; ev(T, f) = T(f) is
clearly bilinear and continuous. First assume ϕ is a Cr local vector map, so ϕ2 : U →L(F, F′) is Cr. Now
write
ϕ2(u) · f = (ev ◦(ϕ2 × I))(u, f).
By the composite mapping theorem, it follows that ϕ2 is Cr as a function of two variables. Thus ϕ is Cr by
Proposition 2.4.12(iii).
Conversely, assume ϕ(u, f) = (ϕ1(u), ϕ2(u) · f) is C∞. Then again by Proposition 2.4.12(iii), ϕ1(u) and
ϕ2(u) · f are C∞as functions of two variables. To show that ϕ2 : U →L(E, F′) is C∞, it suﬃces to prove
the following: if h : U × F →F′ is Cr, r ≥1, and such that h(u, ·) ∈L(F, F′) for all u ∈U, then the map
h′ : U →L(F, F′), deﬁned by h′(u) = h(u, ·) is Cr−1. This will be shown by induction on r.
If r = 1 we prove continuity of h′ in a disk around u0 ∈U in the following way. By continuity of Dh,
there exists ε > 0 such that for all u ∈Dε(u0) and v ∈Dε(0), ∥D1h(u, v)∥≤N for some N > 0. The mean
value inequality yields
∥h(u, v) −h(u′, v)∥≤N∥u −u′∥
for all u, u′ ∈Dε(u0) and v ∈Dε(0). Thus
∥h′(u) −h′(u′)∥= sup
∥v∥≤1
∥h(u, v) −h(u′, v)∥< N
ε ∥u −u′∥,
proving that h′ is continuous.
Let r > 1 and inductively assume that the statement is true for r −1. Let S : L(F, L(E, F′)) →
L(E, L(F, F′)) be the canonical isometry: S(T)(e) · f = T(f) · e. We shall prove that
Dh′ = S ◦(D1h)′,
(3.4.1)
where (D1h)′(u) · v = D1h(u, v). Thus, if h is Cr, D1h is Cr−1, by induction (D1h)′ is Cr−2, and hence by
equation (3.4.1), Dh′ will be Cr−2. This will show that h′ is Cr−1.
For equation (3.4.1) to make sense, we ﬁrst show that
D1h(u, ·) ∈L(F, L(E, F′)).
Since
D1h(u, v) · w =
lim
t→0[h′(u + tw) −h′(u)] · v
t
= lim
n→∞Anv,
for all v ∈F, where
An = n

h′

u + 1
nw

−h′(u)

∈L(F, F′),
it follows by the uniform boundedness principle (or rather its Corollary 2.2.21) that D1h(u, ·)·w ∈L(F, F′).
Thus (v, w) →D1h(u, v)·w is linear continuous in each argument and hence is bilinear continuous (Exercise
2.2-10), and consequently v →D1h(u, v) ∈L(E, F′) is linear and continuous.
Relation (3.4.1) is proved in the following way. Fix u0 ∈U and let ε and N be positive constants such
that
∥D1h(u, v) −D1h(u′, v)∥≤N∥u −u′∥
(3.4.2)

150
3. Manifolds and Vector Bundles
for all u, u′ ∈D2ε(u0) and v ∈Dε(0). Apply the mean value inequality to the Cr−1 map
g(u) = h(u, v) −D1h(u′, v) · u
for ﬁxed u′ ∈D2ε(u0) and v ∈Dε(0) to get
∥h(u + w, v) −h(u, v) −D1h(u′, v) · w∥
= ∥g(u + w) −g(u)∥
≤∥w∥sup
t∈[0,1]
∥Dg(u + tw)∥
= ∥w∥sup
t∈[0,1]
∥D1h(u + tw, v) −D1h(u′, v)∥
for w ∈Dε(u0). Letting u′ →u and taking into account equation (3.4.2) we get
∥h(u + w, v) −h(u, v) −D1h(u, v) · w∥≤N∥w∥2;
that is,
∥h′(u + w) · v −h′(u) · v −[(S ◦(D1h)′)(u) · w](v)∥≤N∥w∥2
for all v ∈Dε(0), and hence
∥h′(u + w) −h′(u) −(S ◦(D1h)′) · w∥≤N
ε ∥w∥2
thus proving equation (3.4.1).
■
Remarks
A.
If F is ﬁnite dimensional and if h : U × F →F′ is Cr, r ≥1, and is such that h(u, ·) ∈L(F, F′) for all
u ∈U, then h′ : U →L(F, F′) given by h′(u) = h(u, ·) is also Cr. In other words, Proposition 3.4.3 holds
for Cr-maps. Indeed, since F = Rn for some n, L(F, F′) ∼= F′ × · · · × F′ (n times) so it suﬃces to prove the
statement for F = R. Thus we want to show that if h : U × R →F′ is Cr and h(u, 1) = g(u) ∈F′, then
g : U →F′ is also Cr. Since h(u, x) = xg(u) for all (u, x) ∈U × R by linearity of h in the second argument,
it follows that h′ = g is a Cr map.
B.
If F is inﬁnite dimensional the result in the proof of Proposition 3.4.3 cannot be improved even if r = 0.
The following counterexample is due to A.J. Tromba. Let h : [0, 1] × L2[0, 1] →L2[0, 1] be given by
h(x, ϕ) =
 1
0
sin
2πt
x

ϕ(t) dt
if x ̸= 0, and h(0, ϕ) = 0. Continuity at each x ̸= 0 is obvious and at x = 0 it follows by the Riemann–
Lebesque lemma (the Fourier coeﬃcients of a uniformly bounded sequence in L2 relative to an orthonormal
set converge to zero). Thus h is C0. However, since
h

x, sin
2πt
x

= 1
2 −x
4π sin 4π
x ,
we have h(1/n, sin 2πnt) = 1/2 and therefore its L2-norm is 1/
√
2; this says that ∥h′(1/n)∥≥1/
√
2 and
thus h′ is not continuous.
♦

3.4 Vector Bundles
151
Any linear map A ∈L(E, F) deﬁnes a local vector bundle map
ϕA : E × E →E × F
by ϕ(u, e) = (u, Ae).
Another example of a local vector bundle map was encountered in §2.4: if the map f : U ⊂E →V ⊂F is
Cr+1, then Tf : U × E →V × F is a Cr local vector bundle map and
Tf(u, e) = (f(u), Df(u) · e).
Using these local notions, we are now ready to deﬁne a vector bundle.
3.4.4 Deﬁnition.
Let S be a set. A local bundle chart of S is a pair (W, ϕ) where W ⊂S and ϕ : W ⊂
S →U × F is a bijection onto a local bundle U × F; U and F may depend on ϕ. A vector bundle atlas
on S is a family B = {(Wi, ϕi)} of local bundle charts satisfying:
VB1.
= MA1 of Deﬁnition 3.1.1: B covers S; and
VB2.
for any two local bundle charts (Wi, ϕi) and (Wj, ϕj) in B with Wi ∩Wj ̸= ∅, ϕi(Wi ∩Wj) is
a local vector bundle, and the overlap map ψji = ϕj ◦ϕ−1
i
restricted to ϕi(Wi ∩Wj) is a C∞
local vector bundle isomorphism.
If B1 and B2 are two vector bundle atlases on S, we say that they are VB-equivalent if B1 ∪B2 is a
vector bundle atlas. A vector bundle structure on S is an equivalence class of vector bundle atlases. A
vector bundle E is a pair (S, V), where S is a set and V is a vector bundle structure on S. A chart in an
atlas of V is called an admissible vector bundle chart of E. As with manifolds, we often identify E with
the underlying set S.
The intuition behind this deﬁnition is depicted in Figure 3.4.2.
E
B
U1
U2
W
F′
1
E′
1
E′
2
F′
2
ϕ1
ϕ2
Eb,ϕ
ψ1,2
Figure 3.4.2. Vector bundle charts
As in the case of manifolds, if we make a choice of vector bundle atlas B on S then we obtain a maximal
vector bundle atlas by including all charts whose overlap maps with those in B are C∞local vector bundle

152
3. Manifolds and Vector Bundles
isomorphisms. Hence a particular vector bundle atlas suﬃces to specify a vector bundle structure on S.
Vector bundles are special types of manifolds. Indeed VB1 and VB2 give MA1 and MA2 in particular,
so V induces a diﬀerentiable structure on S.
3.4.5 Deﬁnition.
For a vector bundle E = (S, V) we deﬁne the zero section (or base) by
B =

e ∈E | there exists (W, ϕ) ∈V and u ∈U with e = ϕ−1(u, 0)

,
that is, B is the union of all the zero sections of the local vector bundles (identifying W with a local vector
bundle via ϕ : W →U × F).
If (U, ϕ) ∈V is a vector bundle chart, and b ∈U with ϕ(b) = (u, 0), let Eb,ϕ denote the subset ϕ−1({u}×F)
of S together with the structure of a vector space induced by the bijection ϕ.
The next few propositions derive basic properties of vector bundles that are sometimes included in the
deﬁnition.
3.4.6 Proposition.
(i)
If b lies in the domain of two local bundle charts ϕ1 and ϕ2, then
Eb,ϕ1 = Eb,ϕ2,
where the equality means equality as topological spaces and as vector spaces.
(ii)
For v ∈E, there is a unique b ∈B such that v ∈Eb,ϕ, for some (and so all) (U, ϕ).
(iii)
B is a submanifold of E.
(iv)
The map π, deﬁned by π : E →B, π(e) = b [in (ii)] is surjective and C∞.
Proof.
(i) Suppose ϕ1(b) = (u1, 0) and ϕ2(b) = (u2, 0). We may assume that the domains of ϕ1 and ϕ2
are identical, for Eb,ϕ is unchanged if we restrict ϕ to any local bundle chart containing b. Then α = ϕ1◦ϕ−1
2
is a local vector bundle isomorphism. But we have
Eb,ϕ1 = ϕ−1
1 ({u1} × F1) = (ϕ−1
2
◦α−1)({u1} × F1)
= ϕ−1
2 ({u2} × F2) = Eb,ϕ2.
Hence Eb,ϕ1 = Eb,ϕ2 as sets, and it is easily seen that addition and scalar multiplication in Eb,ϕ1 and Eb,ϕ2
are identical as are the topologies.
For (ii) note that if v ∈E,
ϕ1(v) = (u1, f1), ϕ2(v) = (u2, f2), b1 = ϕ−1
1 (u1, 0), and b2 = ϕ−1
2 (u2, 0),
then ψ21(u2, f2) = (u1, f1), so ψ21 gives a linear isomorphism {u2} × F2 →{u1} × F1, and therefore
ϕ1(b2) = ψ21(u2, 0) = (u1, 0) = ϕ1(b1), or b2 = b1.
To prove (iii) we verify that for b ∈B there is an admissible chart with the submanifold property. To
get such a manifold chart, we choose an admissible vector bundle chart (W, ϕ), b ∈W. Then ϕ(W ∩B) =
U × {0} = ϕ(W) ∩(E × {0}).
Finally, for (iv), it is enough to check that π is C∞using local bundle charts. But this is clear, for such a
representative is of the form (u, f) →(u, 0). That π is onto is clear.
■
The ﬁbers of a vector bundle inherit an intrinsic vector space structure and a topology independent of the
charts, but there is no norm that is chart independent. Putting particular norms on ﬁbers is extra structure
to be considered later in the book. Sometimes the phrase Banachable space is used to indicate that the
topology comes from a complete norm but we are not nailing down a particular one.
The following summarizes the basic properties of a vector bundle.

3.4 Vector Bundles
153
3.4.7 Theorem.
Let E be a vector bundle. The zero section (or base) B of E is a submanifold of E
and there is a map π : E →B (sometimes denoted πBE : E →B) called the projection that is of class
C∞, and is surjective (onto). Moreover, for each b ∈B, π−1(b), called the ﬁber over b, has a Banachable
vector space structure induced by any admissible vector bundle chart, with b the zero element.
Because of these properties we sometimes write “the vector bundle π : E →B” instead of “the vector
bundle (E, V).” Fibers are often denoted by Eb = π−1(b). If the base B and the map π are understood, we
just say “the vector bundle E.”
Tangent Bundle as a Vector Bundle.
A commonly encountered vector bundle is the tangent bundle
τM : TM →M of a manifold M. To see that the tangent bundle, as we deﬁned it in the previous section,
is a vector bundle in the sense of this section, we use the following lemma.
3.4.8 Lemma.
If f : U ⊂E →V ⊂F is a diﬀeomorphism of open sets in Banach spaces, then Tf :
U × E →V × F is a local vector bundle isomorphism.
Proof.
Since Tf(u, e) = (f(u), Df(u) · e), Tf is a local vector bundle mapping. But as f is a diﬀeo-
morphism, (Tf)−1 = T(f −1) is also a local vector bundle mapping, and hence Tf is a vector bundle
isomorphism.
■
Let A = {(U, ϕ)} be an atlas of admissible charts on a manifold M that is modeled on a Banach space
E. In the previous section we constructed the atlas TA = {(TU, Tϕ)} of the manifold TM. If Ui ∩Uj ̸= ∅,
then the overlap map
Tϕi ◦Tϕ−1
j
= T(ϕi ◦ϕ−1
j ) : ϕj(Ui ∩Uj) × E →ϕi(Ui ∩Uj) × E
has the expression
(u, e) →((ϕi ◦ϕ−1
j )(u), D(ϕi ◦ϕ−1
j )(u) · e).
By Lemma 3.4.8, T(ϕi ◦ϕ−1
j ) is a local vector bundle isomorphism. This proves the ﬁrst part of the following
theorem.
3.4.9 Theorem.
Let M be a manifold and A = {(U, ϕ)} be an atlas of admissible charts.
(i)
Then TA = {(TU, Tϕ)} is a vector bundle atlas of TM, called the natural atlas.
(ii)
If m ∈M, then τ −1
M (m) = TmM is a ﬁber of TM and its base B is diﬀeomorphic to M by the map
τM|B : B →M.
Proof.
(ii)
Let (U, ϕ) be a local chart at m ∈M, with ϕ : U →ϕ(U) ⊂E and ϕ(m) = u. Then
Tϕ : TM|U →ϕ(u) × E is a natural chart of TM, so that
Tϕ−1({u} × E) = Tϕ−1{ [cu,e]u | e ∈E }
by deﬁnition of Tϕ, and this is exactly TmM. For the second assertion, τM|B is obviously a bijection, and its
local representative with respect to Tϕ and ϕ is the natural identiﬁcation determined by ϕ(U)×{0} →ϕ(U),
a diﬀeomorphism.
■
Thus, TmM is isomorphic to the Banach space E, the model space of M, M is identiﬁed with the zero
section of TM, and τM is identiﬁed with the bundle projection onto the zero section. It is also worth recalling
that the local representative τM is (ϕ ◦τM ◦Tϕ−1)(u, e) = u, that is, just the projection of ϕ(U) × E to
ϕ(U).
3.4.10 Examples.
A.
Any manifold M is a vector bundle with zero-dimensional ﬁber, namely M × {0}.

154
3. Manifolds and Vector Bundles
B.
The cylinder E = S1 × R is a vector bundle with π : E →B = S1 the projection on the ﬁrst
factor (Figure 3.4.3). This is a trivial vector bundle in the sense that it is a product. The cylinder is
diﬀeomorphic to TS1 by Example 3.3.14A.
π = projection
base = S1
Fiber = R
b
Eb = π-1(b)
Figure 3.4.3. The cylinder as a vector bundle
C.
The M¨obius band is a vector bundle π : M →S1 with one-dimensional ﬁber obtained in the following
way (see Figure 3.4.4). On the product manifold R×R, consider the equivalence relation deﬁned by (u, v) ∼
(u′, v′) iﬀu′ = u+k, v′ = (−1)kv for some k ∈Z and denote by p : R×R →M the quotient topological space.
Since the graph of this relation is closed and p is an open map, M is a Hausdorﬀspace. Let [u, v] = p(u, v)
and deﬁne the projection π : M →S1 by π[u, v] = e2πiu. Let
V1 = ]0, 1[ × R, V2 = ](−1/2), (1/2)[ × R, U1 = S1\{1}, and U2 = S1\{−1}
and then note that p|V1 : V1 →π−1(U1) and p|V2 : V2 →π−1(U2) are homeomorphisms and that M =
π−1(U1) ∪π−1(U2). Let {(U1, ϕ1), (U2, ϕ2)} be an atlas with two charts for S1 (see Example 3.1.2). Deﬁne
ψj : π−1(Uj) →R × R
by ψj = χj ◦(p|Vj)−1
and
χj : Vj →R × R
by χj(u, v) = (ϕj(e2πiu), (−1)j+1v), j = 1, 2
and observe that χj and ψj are homeomorphisms. Since the composition ψ2 ◦ψ−1
1
: (R × R)\({0} × R) →
(R × R)\({0} × R) is given by the formula
(ψ2 ◦ψ−1
1 )(x, y) = ((ϕ2 ◦ϕ−1
1 )(x), −y),
we see that {(π−1(U1), ψ1), (π−1(U2), ψ2)} forms a vector bundle atlas of M.

3.4 Vector Bundles
155
Figure 3.4.4. The M¨obius band
D. The Grassmann bundles (universal bundles).
We now deﬁne vector bundles
γn(E) →Gn(E),
γn(E) →Gn(E),
and
γ(E) →G(E),
which play an important role in the classiﬁcation of isomorphism classes of vector bundles (see for example
Hirsch [1976]). The deﬁnition of the projection ρ : γn(E) →Gn(E) is the following (see Example 3.1.8G for
notations): recalling γn(E) = { (F, v) | F is an n-dimensional subspace of E and v ∈F }, we set ρ(F, v) = F.
The charts (ρ−1(UG), ψFG), where E = F ⊕G,
ψFG(H, v) = (ϕFG(H), πG(H, F)(v)),
and
ψFG : ρ−1(UG) →L(F, G) × F,
deﬁne a vector bundle structure on γn(E) since the overlap maps are

ψF′G′ ◦ψ−1
FG

(T, f) =

(ϕF′G′ ◦ϕ−1
FG)(T) ,
(πG′(graph(T), F′) ◦πG(graph(T), F)−1)(f)

.
where T ∈L(F, G), f ∈F, and graph(T) denotes the graph of T in E × F; smoothness in T is shown as in
Example 3.1.8G. The ﬁber dimension of this bundle is n. A similar construction holds for Gn(E) yielding
γn(E); the ﬁber codimension in this case is also n. Similarly γ(E) →G(E) is obtained with not necessarily
isomorphic ﬁbers at diﬀerent points of G(E).
♦
Vector Bundle Maps.
Now we are ready to look at maps between vector bundles.
3.4.11 Deﬁnition.
Let E and E′ be two vector bundles. A map f : E →E′ is called a Cr vector bundle
mapping (local isomorphism) when for each v ∈E and each admissible local bundle chart (V, ψ) of E′
for which f(v) ∈V , there is an admissible local bundle chart (W, ϕ) with f(W) ⊂W ′ such that the local
representative fϕψ = ψ ◦f ◦ϕ−1 is a Cr local vector bundle mapping (local isomorphism). A bijective local
vector bundle isomorphism is called a vector bundle isomorphism.
This deﬁnition makes sense only for local vector bundle charts and not for all manifold charts. Also,
such a W is not guaranteed by the continuity of f, nor does it imply it. However, if we ﬁrst check that f
is ﬁber preserving (which it must be) and is continuous, then such an open set W is guaranteed. This
ﬁber–preserving character is made more explicit in the following.
3.4.12 Proposition.
Suppose f : E →E′ is a Cr vector bundle map, r ≥0. Then:
(i)
f preserves the zero section: f(B) ⊂B′;
(ii)
f induces a unique mapping fB : B →B′ such that the following diagram commutes:

156
3. Manifolds and Vector Bundles
E
E′
B
B′
f
fB
π
π′
✲
✲
❄
❄
that is, π′ ◦fB = fB ◦π. (Here, π and π′ are the projection maps.) Such a map f is called a vector
bundle map over fB.
(iii)
A C∞map g : E →E′ is a vector bundle map iﬀthere is a C∞map gB : B →B′ such that
π′ ◦g = gB ◦π and g restricted to each ﬁber is a linear continuous map into a ﬁber.
Proof.
(i)
Suppose b ∈B. We must show f(b) ∈B′. That is, for a vector bundle chart (V, ψ) with
f(b) ∈V we must show ψ(f(b)) = (v, 0). Since we have a chart (W, ϕ) such that b ∈W, f(W) ⊂V , and
ϕ(b) = (u, 0), it follows that ψ(f(b)) = (ψ ◦f ◦ϕ−1)(u, 0) which is of the form (v, 0) by linearity of fϕψ on
each ﬁber.
For (ii), let fB = f|B : B →B′. With the notations above,
ψ|B′ ◦π′ ◦f ◦ϕ−1 = π′
ψ,ψ|B′ ◦fϕψ
and
ψ|B′ ◦fB ◦π ◦ϕ−1 = (fB)ϕ|B,ψ|B′ ◦πϕ,ϕ|B
which are equal by (i) and because the local representatives of π and π′ are projections onto the ﬁrst factor.
Also, if fϕψ = (α1, α2), then (fB)ϕψ = α1, so fB is Cr.
One half of (iii) is clear from (i) and (ii). For the converse we see that in local representation, g has the
form
gϕψ(u, f) = (ψ ◦g ◦ϕ−1)(u, f) = (α1(u), α2(u) · f),
which deﬁnes α1 and α2. Since g is linear on ﬁbers, α2(u) is linear. Thus, the local representatives of g with
respect to admissible local bundle charts are local bundle mappings by Proposition 3.4.3.
■
We also note that the composition of two vector bundle mappings is again a vector bundle mapping.
3.4.13 Examples.
A.
Let M and N be Cr+1 manifolds and f : M →N a Cr+1 map. Then Tf : TM →TN is a Cr vector
bundle map of class Cr. Indeed the local representative of Tf, (Tf)T ϕ,T ψ = T(fϕψ) is a local vector bundle
map, so the result follows from Proposition 3.3.11.
B.
The proof of Proposition 3.3.13 shows that T(M1 × M2) and TM1 × TM2 are isomorphic as vector
bundles over the identity of M1 × M2. They are usually identiﬁed.
C.
To get an impression of how vector bundle maps work, let us show that the cylinder S1 × R and the
M¨obius band M are not vector bundle isomorphic. If ϕ : M →S1 × R were such an isomorphism, then the
image of the curve c : [0, 1] →M, c(t) = [t, 1] by ϕ would never cross the zero section in S1 × R, since [s, 1]
is never zero in all ﬁbers of M; that is, the second component of (ϕ ◦c)(t) ̸= 0 for all t ∈[0, 1]. But
c(1) = [1, 1] = [0, −1] = −[0, 1] = −c(0)
so that the second components of ϕ ◦c at t = 0 and t = 1 are in absolute value equal and of opposite sign,
which, by the intermediate value theorem, implies that the second component of ϕ ◦c vanishes somewhere.

3.4 Vector Bundles
157
D.
It is shown in diﬀerential topology that for any vector bundle E with an n-dimensional base B and
k-dimensional ﬁber there exists a vector bundle map ϕ : E →B × Rp, where p ≥k + n, with ϕB = IB and
which, when restricted to each ﬁber, is injective (Hirsch [1976]). Write ϕ(v) = (π(v), F(v)) so F : E →Rp
is linear on ﬁbers. With the aid of this theorem, analogous in spirit to the Whitney embedding theorem,
we can construct a vector bundle map Φ : E →γk(Rp) by Φ(v) = (F(Eb), F(v)) where v ∈Eb. Note
that ΦB : B →Gk(Rp) maps b ∈B to the k-plane F(Eb) in Rp. Furthermore, note that E is vector bundle
isomorphic to the pull-back bundles Φ∗(γk(Rp)) (see Exercise 3.4-15 for the deﬁnition of pull–back bundles).
It is easy to check that ϕ →Φ is a bijection. Mappings f : B →Gk(Rp) such that f ∗(γk(Rp)) is isomorphic
to E are called classifying maps for E; they play a central role in diﬀerential topology since they convert
the study of vector bundles to homotopy theory (see Hirsch [1976] and Husemoller [1966]).
♦
Sections of Vector Bundles.
A second generalization of a local Cr mapping, f : U ⊂E →F, globalizes
not f but rather its graph mapping λf : U →U × F; u →(u, f(u)).
3.4.14 Deﬁnition.
Let π : E →B be a vector bundle. A Cr local section of π is a Cr map ξ : U →E,
where U is open in B, such that for each b ∈U, π(ξ(b)) = b. If U = B, ξ is called a Cr global section, or
simply a Cr section of π. Let Γr(π) denote the set of all Cr sections of π, together with the obvious real
(inﬁnite-dimensional) vector space structure.
The condition on ξ says that ξ(b) lies in the ﬁber over b. The Cr sections form a linear function space
suitable for global linear analysis. As will be shown in later chapters, this general construction includes
spaces of vector and tensor ﬁelds on manifolds. The space of sections of a vector bundle diﬀers from the
more general class of global Cr maps from one manifold to another, which is a nonlinear function space.
(See, for example, Eells [1958], Palais [1968], Elliasson [1967], or Ebin and Marsden [1970] for further details.)
Subbundles.
Submanifolds were deﬁned in the preceding section. There are two analogies for vector
bundles.
3.4.15 Deﬁnition.
If π : E →B is a vector bundle and M ⊂B a submanifold, the restricted bundle
πM : EM = E|M →M is deﬁned by
EM =

m∈M
Em,
πM = π|EM.
The restriction πM : EM →M is a vector bundle whose charts are induced by the charts of E in the
following way. Let (V, ψ1), ψ1 : V →V ′ ⊂E′ × {0}, be a chart of M induced by the chart (U, ϕ1) of B with
the submanifold property, where (π−1(U), ϕ) (with ϕ(e) = (ϕ1(π(e)), ϕ2(e)), ϕ : π−1(U) →U ′ × F, and
U ′ ⊂E′ × E′′ = E) is a vector bundle chart of E. Then
ψ : π−1
M (V ) →V ′ × F,
ψ(e) = (ψ1(π(e)), ϕ2(e))
deﬁnes a vector bundle chart of EM. It can be easily veriﬁed that the overlap maps satisfy VB2.
For example the restriction of any vector bundle to a chart domain of the base deﬁned by a vector bundle
chart gives a bundle isomorphic to a local vector bundle.
3.4.16 Deﬁnition.
Let π : E →B be a vector bundle. A subset F ⊂E is called a subbundle if for each
b ∈B there is a vector bundle chart (π−1(U), ϕ) of E where b ∈U ⊂B and ϕ : π−1(U) →U ′ × F, and a
split subspace G of F such that ϕ(π−1(U) ∩F) = U ′ × (G × {0}).
These induced charts are veriﬁed to form a vector bundle atlas for π|F : F →B. Note that subbundles
have the same base as the original vector bundle. Intuitively, the restriction cuts the base keeping the ﬁbers
intact, while a subbundle has the same base but smaller ﬁber, namely Fb = F ∩Eb. Note that a subbundle
F is a closed submanifold of E.
For example γk(Rn) is a subbundle of both γk(Rn+1) and γk+1(Rn+1), the canonical inclusions being
given by (F, x) →(F × {0}, (x, 0)) and (F, x) →(F × R, (x, 0)), respectively.

158
3. Manifolds and Vector Bundles
Quotients, Kernels, and Ranges.
We now consider some additional basic operations with vector bun-
dles and maps.
3.4.17 Proposition.
Let π : E →B be a vector bundle and F ⊂E a subbundle. Consider the following
equivalence relation on E : v ∼v′ if there is a b ∈B such that v, v′ ∈Eb and v −v′ ∈Fb. The quotient set
E/∼has a unique vector bundle structure for which the canonical projection p : E →E/∼is a vector bundle
map over the identity. This vector bundle is called the quotient E/F and has ﬁbers (E/F)b = Eb/Fb.
Proof.
Since F ⊂E is a subbundle there is a vector bundle chart ϕ : π−1(U) →U ′×F and split subspaces
F1, F2, F1 ⊕F2 = F, such that
ϕ|π−1(U) ∩∗F : (π|F)−1(U) →U ′ × (F1 × {0})
is a vector bundle chart for F. The map π induces a unique map Π : E/∼→B such that Π◦p = π. Similarly
ϕ induces a unique map Φ : Π−1(U) →U ′ × ({0} × F2) by the condition Φ ◦p = ϕ|ϕ−1(U ′ × ({0} × F2)),
which is seen to be a homeomorphism. One veriﬁes that the overlap map of two such Φ is a local vector
bundle isomorphism, thus giving a vector bundle structure to E/∼, with ﬁber Eb/Fb, for which p : E →E/∼
is a vector bundle map. From the deﬁnition of Φ it follows that the structure is unique if p is to be a vector
bundle map over the identity.
■
3.4.18 Proposition.
Let π : E →B and ρ : F →B be vector bundles over the same manifold B and
f : E →F a vector bundle map over the identity. Let fb : Eb →Fb be the restriction of f to the ﬁber over
b ∈B and deﬁne the kernel of f by
ker(f) =

b∈B
ker(fb)
and the range of f by
range(f) =

b∈B
range(fb).
(i)
ker(f) and range(f) are subbundles of E and F respectively iﬀfor every b ∈B there are vector bundle
charts (π−1(U), ϕ) of E and (ρ−1(U), ψ) of F such that the local representative of f has the form
fϕψ : U ′ × (F1 × F2) →U ′ × (G1 × G2),
where
fϕψ(u, (f1, f2)) = (u, (χ(u) · f2, 0)),
and χ(u) : F2 →G1 is a continuous linear isomorphism.
(ii)
If E has ﬁnite-dimensional ﬁber, the condition in (i) is equivalent to the local constancy of the rank of
the linear map fb : Eb →Fb.
Proof.
(i) It is enough to prove the result for local vector bundles. But there it is trivial since ker(fϕψ)u =
F1 and range(fϕψ)u = G1.
(ii) Fix u ∈U ′ and put (fϕψ)u(F) = G1. Then since G1 is closed and ﬁnite dimensional in G, it splits; let
G = G1 ⊕G2. Let F1 = ker(fϕψ)u; F is ﬁnite dimensional and hence F = F1 ⊕F2. Then (fϕψ)u : F2 →G1
is an isomorphism. Write
(fϕψ)u′ =

a(u′)
b(u′)
c(u′)
d(u′)

:

F1
F2

→

G1
G2

for u′ ∈U ′ and note that b(u′) is an isomorphism. Therefore b(u′) is an isomorphism for all u′ in a neigh-
borhood of u by Lemma 2.5.4. We can assume that this neighborhood is U ′, by shrinking U ′ if necessary.

3.4 Vector Bundles
159
Note also that a(u) = 0, c(u) = 0, d(u) = 0. The rank of (fϕψ)u′ is constant in a neighborhood of u, so
shrink U ′ further, if necessary, so that (fϕψ)u′ has constant rank for all u′ ∈U ′. Since b(u′) is an isomor-
phism, a(u′)(F1) + b(u′)(F2) = G1 and since the rank of (fϕψ)u′ equals the dimension of G1, it follows that
c(u′) = 0 and d(u′) = 0 for all u′ ∈U ′. Then
λu′ =

I
0
−b(u′)−1a(u′)
I

∈GL(F1 ⊕F2, F1 ⊕F2)
and
(fϕψ)u′ ◦λu′ =

0
b(u′)
0
0

which yields the form of the local representative in (i) after ﬁberwise composing ϕu′ with λ−1
u′ .
■
3.4.19 Deﬁnition.
A sequence of vector bundle maps over the identity E
f→F
g→G is called exact at F
if range(f) = ker(g). It is split ﬁber exact if ker(f), range(g), and range(f) = ker(g) split in each ﬁber.
It is bundle exact if it is split ﬁber exact and ker(f), range(g), and range(f) = ker(g) are subbundles.
3.4.20 Proposition.
Let E, F, and G be vector bundles over a manifold B and let
E
f
−→F
g
−→G
be a split ﬁber exact sequence of smooth bundle maps. Then the sequence is bundle exact; that is, ker(f),
range(f) = ker(g), and range(g) are subbundles of E, F, and G respectively.
Proof.
Fixing b ∈B, set A = ker(fb), B = ker(gb) = range(fb), C = range(gb), and let D be a complement
for C in Gb, so Eb = A × B, Fb = B × C, and Gb = C × D. Let ϕ : U →U ′ be a chart on B at b, ϕ(b) = 0,
deﬁning vector bundle charts on E, F, and G. Then the local representatives
f ′ : U ′ × A × B →U ′ × B × C,
g′ : U ′ × B × C →U ′ × C × D
of f and g respectively are the identity mappings on U ′ and can be written as matrices of operators
f ′
u′ =

z
w
x
y

:

A
B

→

B
C

and
g′
u′ =

β
γ
α
δ

:

B
C

→

C
D

depending smoothly on u′ ∈U ′. Now since w0 and γ0 are isomorphisms by Banach’s isomorphism theorem,
shrink U and U ′ such that wu′ and γu′ are isomorphisms for all u′ ∈U ′. By exactness, g′
u′ ◦f ′
u′ = 0, which
in terms of the matrix representations becomes
x = −γ−1 ◦β ◦z,
y = −γ−1 ◦β ◦w,
α = −δ ◦y ◦w−1,
that is,
x = y ◦w−1 ◦z
and
α = δ ◦γ−1 ◦β.
Extend f ′
u′ to the map hu′ : A × B × C →A × B × C depending smoothly on u′ ∈U ′ by
hu′


I
0
0
z
w
0
x
y
I

.

160
3. Manifolds and Vector Bundles
We ﬁnd maps a, b, c, d, k, m, n, p such that


I
0
0
0
a
b
0
c
d

hu′


k
p
0
m
n
0
0
0
I

= I,
which can be accomplished by choosing
k = I,
d = I,
p = 0,
b = 0,
a = w−1,
n = I,
m = −w−1 ◦z,
c = −y ◦w−1,
and taking into account that x = y ◦w−1 ◦z. This procedure gives isomorphisms
λ =

a
b
c
d

=

w−1
0
−y ◦w−1
I

:

B
C

→

B
C

µ =

k
p
m
n

=

I
0
−w−1 ◦z
I

:

A
B

→

A
B

depending smoothly on u′ ∈U such that
λ ◦f ′
u′ ◦µ =

0
I
0
0

:

A
B

→

B
C

.
Proposition 3.4.18(ii) shows that ker(f) and range(f) are subbundles. The same procedure applied to g′
u′
proves that ker(g) and range(g) are subbundles and thus the ﬁber split exact sequence
E
f→F
g→G
is bundle exact.
■
As a special case note that 0 →F
g→G is split ﬁber exact when gb is injective and has split range.
Here 0 is the trivial bundle over B with zero-dimensional ﬁber and the ﬁrst arrow is injection to the zero
section. Similarly, taking G = 0 and g the zero map, the sequence E
f→F →0 is split ﬁber exact when
fb is surjective with split kernel. In both cases range(g) and ker(f) are subbundles by Proposition 3.4.20.
In Proposition 3.4.20, and these cases in particular, we note that if the sequences are split ﬁber exact at b,
then they are also split ﬁber exact in a neighborhood of b by the openness of GL(E, E) in L(E, E).
A split ﬁber exact sequence of the form
0 −→E
f
−→F
g→G →0
is called a short exact sequence. By Proposition 3.4.20 and Proposition 3.4.17, any split ﬁber exact
sequence
E
f
−→F
g
−→G
induces a short exact sequence
0 −→E/ ker(f)
[f]
−→F
g→range(g) →0
where [f]([e]) = f(e) for e ∈E.
3.4.21 Deﬁnition.
A short exact sequence
0 −→E
f
−→F
g
−→G −→0
is said to be split exact if there is a split ﬁber exact sequence 0 →G
h→F such that g ◦h is the identity on
G

3.4 Vector Bundles
161
Products and Tensorial Constructions.
The geometric meaning of this concept will become clear after
we introduce a few additional constructions with vector bundles.
3.4.22 Deﬁnition.
If π : E →B and π′ : E′ →B′ are two vector bundles, the product bundle π × π′ :
E × E′ →B × B′ is deﬁned by the vector bundle atlas consisting of the sets π−1(U) × π′−1(U ′), and the
maps ϕ × ψ where (π−1(U), ϕ), U ⊂B and (π′−1(U ′), ψ), U ′ ⊂B′ are vector bundle charts of E and E′,
respectively.
It is straightforward to check that the product atlas veriﬁes conditions VB1 and VB2 of Deﬁnition 3.4.4.
Below we present a general construction, special cases of which are used repeatedly in the rest of the book.
It allows the transfer of vector space constructions into vector bundle constructions. The abstract procedure
will become natural in the context of examples given below in 3.4.25 and later in the book.
3.4.23 Deﬁnition.
Let I and J be ﬁnite sets and consider two families E = (Ek)k∈I∪J, and E′ =
(E′
k)k∈I∪J of Banachable spaces. Let
L(E, E′) =

i∈I
L(Ei, E′
i) ×

j∈J
L(E′
j, Ej)
and let
(Ak) ∈L(E, E′);
that is, Ai ∈L(Ei, E′
i), i ∈I, and Aj ∈L(E′
j, Ej), j ∈J. An assignment Ωtaking any family E to a Banach
space ΩE and any sequence of linear maps (Ak) to a linear continuous map Ω(Ak) ∈L(ΩE, ΩE′) satisfying
Ω(IEk) = IΩE,
Ω((Bk) ◦(Ak)) = Ω((Bk)) ◦Ω((Ak))
(composition is taken componentwise) and is such that the induced map Ω: L(E, E′) →L(ΩE, ΩE′) is C∞,
will be called a tensorial construction of type (I, J).
3.4.24 Proposition.
Let Ωbe a tensorial construction of type (I, J) and E = (Ek)k∈I∪J be a family of
vector bundles with the same base B. Let
ΩE =

b∈B
ΩEb,
where Eb = (Ek
b )k∈I∪J.
Then ΩE has a unique vector bundle structure over B with (ΩE)b = ΩEb and π : ΩE →B sending ΩEb
to b ∈B, whose atlas is given by the charts (π−1(U), ψ), where ψ : π−1(U) →U ′ × Ω((Fk)) is deﬁned as
follows. Let
(π−1
k (U), ϕk),
ϕk : π−1
k (U) →U ′ × Fk,
ϕk(ek) = (ϕ1(πk(ek)), ϕk
2(ek))
be vector bundle charts on Ek inducing the same manifold chart on B. Deﬁne
ψ(x) = (ϕ1(π(x)), Ω(ψπ(x))(x))
by ψπ(x) = (ψk
π(x))
where ψi
π(x) = (ϕi
2)−1, for i ∈I and ψj
π(x) =

ϕj
2
	
for j ∈J.
Proof.
We need to show that the overlap maps are local vector bundle isomorphisms. We have
(ψ′ ◦ψ−1)(u, e) = ((ϕ′
1 ◦ϕ−1
1 )(u), Ω((ϕ′k
2 ◦(ϕk
2)−1(u)) · e)),
the ﬁrst component of which is trivially C∞. The second component is also C∞since each ϕk is a vector
bundle chart by the composite mapping theorem, and by the fact that Ωis smooth.
■

162
3. Manifolds and Vector Bundles
3.4.25 Examples.
A. Whitney sum.
Choose for the tensorial construction the following: J = ∅, I = {1, . . . , n}, and ΩE is
the single Banach space E1 × · · · × En. Let Ω((Ai)) = A1 × · · · × An. The resulting vector bundle is denoted
by E1 ⊕· · · ⊕En and is called the Whitney sum. The ﬁber over b ∈B is just the sum of the component
ﬁbers.
B. Vector bundles of bundle maps.
Let E1, E2 be two vector bundles. Choose for the tensorial con-
struction the following: I, J are one–point sets I = {1}, J = {2},
Ω(E1, E2) = L(E2, E1),
Ω(A1, A2) · S = A1 ◦S ◦A2
for S ∈L(E1, E1). The resulting bundle is denoted by L(E2, E1). The ﬁber over b ∈B consists of the linear
maps of (E2)b to (E1)b.
C. Dual bundle.
This is a particular case of Example B for which E = E2 and E1 = B×R. The resulting
bundle is denoted E∗; the ﬁber over b ∈B is the dual E∗
b . If E = TM, then E∗is called the cotangent
bundle of M and is denoted by T ∗M.
D. Vector bundle of multilinear maps.
Let E0, E1, . . . , En be vector bundles over the same base. The
space of n-multilinear maps (in each ﬁber) L(E1, . . . , En; E0) is a vector bundle over B by the choice of the
following tensorial construction: I = {0}, J = {1, . . . , n},
Ω(E0, . . . , En) = Ln(E1, . . . , En; E0),
Ω(A0, A1, . . . , An) · S = A0 ◦S ◦(A1 × · · · × An)
for S ∈Ln(E1, . . . , En; E0). One may similarly construct Lk
s(E; E0) and Lk
a(E; E0), the vector bundle of
symmetric and antisymmetric k-linear vector bundle maps of E × E × · · · × E to E0.
♦
3.4.26 Proposition.
A short exact sequence of vector bundles
0 −→E
f
−→F
g→G →0
is split if and only if there is a vector bundle isomorphism ϕ : F →E ⊕G such that ϕ ◦f = i and p ◦ϕ = g,
where i : E →E ⊕G is the inclusion u →(u, 0) and p : E ⊕G →G is the projection (u, w) →w.
Proof.
Note that
0 →E
i→E ⊕G
p→G →0
is a split exact sequence; the splitting is given by w ∈G →(0, w) ∈E ⊕G. If there is an isomorphism
ϕ : F →E ⊕G as in the statement of the proposition, deﬁne h : G →F by h(w) = ϕ−1(0, w). Since ϕ is an
isomorphism and G is a subbundle of E ⊕G, it follows that 0 →G
h→F is split ﬁber exact. Moreover
(g ◦h)(w) = (g ◦ϕ−1)(0, w) = p(0, w) = w.
Conversely, assume that
0 −→G
h
−→F
is a splitting of
0 −→E
f
−→F
g
−→G −→0,
that is, g ◦h = identity on G. Then range(h) is a subbundle of F (by Deﬁnition 3.4.19) which is isomorphic
to G by h. Since g ◦h = identity, it follows that range(h) ∩ker(g) = 0. Moreover, since any v ∈F can be
written in the form v = (v −h(g(v))) + h(g(v)), with h(g(v)) ∈range(h) and v −h(g(v)) ∈ker(g), it follows
that F = ker(g) ⊕range(h). Since the inverse of ϕ is given by (u, v) →(f(u), h(v)), it follows that the map
ϕ is a smooth vector bundle isomorphism and that the identities ϕ ◦f = i, p ◦ϕ = g hold.
■

3.4 Vector Bundles
163
Fiber Bundles.
We next give a brief account of a useful generalization of vector bundles, the locally
trivial ﬁber bundles.
3.4.27 Deﬁnition.
A Ck ﬁber bundle, where k ≥0, with typical ﬁber F (a given manifold) is a Ck
surjective map of Ck manifolds π : E →B which is locally a product, that is, the Ck manifold B has an
open atlas {(Uα, ϕα)}α∈A such that for each α ∈A there is a Ck diﬀeomorphism χα : π−1(Uα) →Uα × F
such that pα ◦χα = π, where pα : Uα × F →Uα is the projection. The Ck manifolds E and B are called the
total space and base of the ﬁber bundle, respectively. For each b ∈B, π−1(b) = Eb is called the ﬁber over
b. The Ck diﬀeomorphisms χα are called ﬁber bundle charts. If k = 0, E, B, F are required to be only
topological spaces and {Uα} an open covering of B.
Each ﬁber Eb = π−1(b), for b ∈B, is a closed Ck submanifold of E, which is Ck diﬀeomorphic to F via
χα|Eb. The total space E is the disjoint union of all of its ﬁbers. By the local product property, the Ck
manifold structure of E is given by an atlas whose charts are products, that is, any chart on E contains a
chart of the form
ραβ = (ϕα × ψβ) ◦χα : χ−1
α (Uα × Vβ) →ϕα(Uα) × ψβ(Vβ),
where (Uα, ϕα) is a chart on B satisfying the property of the deﬁnition and thus giving rise to χα, and
(Vβ, ψβ) is any chart on F. Note that the maps χαb = χα|Eb : Eb →F are Ck diﬀeomorphisms. If (Uα′, ϕα′)
and χα′ are as in Deﬁnition 3.4.27 with Uα ∩Uα′ ̸= ∅, then the diﬀeomorphism
χα′ ◦χ−1
α
: (Uα ∩Uα′) × F →(Uα ∩Uα′) × F
is given by
(χα′ ◦χ−1
α )(u, f) = (u, (χα′u ◦χ−1
αu)(f))
and therefore χα′u ◦χ−1
αu : F →F is a Ck diﬀeomorphism. This proves the uniqueness part in the following
proposition.
3.4.28 Proposition.
Let E be a set, B and F be Ck manifolds, and let π : E →B be a surjective map.
Assume that
(i)
there is a Ck atlas {(Uα, ϕα)} of B and a family of bijective maps χα : π−1(Uα) →Uα × F satisfying
pα ◦χα = π, where pα : Uα × F →Uα is the projection, and that
(ii)
the maps χα′ ◦χ−1
α
: Uα × F →Uα′ × F are Ck diﬀeomorphisms whenever Uα′ ∩Uα ̸= ∅.
Then there is a unique Ck manifold structure on E for which π : E →B is a Ck locally trivial ﬁber bundle
with typical ﬁber F.
Proof.
Deﬁne the atlas of E by (χ−1
α (Uα×Vβ), ραβ), where (Uα, ϕα) is a chart in the atlas of B given in (i),
χα : π−1(Uα) →Uα×F is the bijective map given in (i), (Vβ, ψβ) is any chart on F, and ραβ = (ϕα×ψβ)◦χα.
If (Uα′, ϕα′) is another chart of the atlas of B in (i) and (Vβ′, ψβ′) is another chart on F such that Uα∩Uα′ ̸= ∅
and Vβ ∩Vβ′ ̸= ∅, then the overlap map
ρα′β′ ◦ρ−1
αβ = (ϕα′ × ψβ′) ◦χα′ ◦χ−1
α ◦(ϕ−1
α × ψ−1
β )
is Ck by (i). Thus {(χ−1
α (Uα×Vβ), ραβ)} is a Ck atlas on E relative to which π : E →B is a Ck locally trivial
ﬁber bundle by (i). The diﬀerentiable structure on E is unique by the remarks preceding this proposition.
■
Many of the concepts introduced for vector bundles have generalizations to ﬁber bundles. For instance,
local and global sections are deﬁned as in Deﬁnition 3.4.14. Given a ﬁber bundle π : E →B, the restricted
bundle πM : EM = E|M →M, for M a submanifold of B is deﬁned as in Deﬁnition 3.4.15. A locally trivial
subbundle of π : E →F with typical ﬁber G, a submanifold of F, is a submanifold E′ of E such that

164
3. Manifolds and Vector Bundles
the map π′ = π|E′ : E′ →B is onto and satisﬁes the following property: if χα : π−1(Uα) →Uα × F is
a local trivialization of E, then χ′
α = χα|π′−1(Uα) →Uα × G are local trivializations. Thus π′ : E′ →B
is a locally trivial ﬁber bundle in its own right. Finally, locally trivial ﬁber bundle maps, or ﬁber
bundle morphisms are deﬁned in the following way. If π′ : E′ →B′ is another locally trivial ﬁber bundle
with typical ﬁber F ′, then a smooth map f : E →E′ is called ﬁber preserving if π(e1) = π(e2) implies
(π′◦f)(e1) = (π′◦f)(e2), for e1, e2 ∈E. Thus f determines a map fB : B →B′ satisfying π′◦f = π◦fB. The
map fB is smooth since for any chart (Uα, ϕα) of B inducing a local trivialization χα : π−1(Uα) →Uα × F,
the map fB can be written as fB(b) = (π ◦f ◦χ−1
α )(b, n), for any ﬁxed n ∈F. The pair (f, fB) is called
a locally trivial ﬁber bundle map or ﬁber bundle morphism. An invertible ﬁber bundle morphism is
called a ﬁber bundle isomorphism.
3.4.29 Examples.
A.
Any manifold is a locally trivial ﬁber bundle with typical ﬁber a point.
B.
Any vector bundle π : E →B is a locally trivial ﬁber bundle whose typical ﬁber is the model of the
ﬁber Eb. Indeed, if ϕ : W →U ′ × F, where U ′ open in E, is a local vector bundle chart, by Proposition
3.4.6, ϕ|ϕ−1(U × {0}) : U →U ′ ⊂E, U = W ∩B, is a chart on the base B and χ : π−1(U) →U × F deﬁned
by χ(e) = (π(e), (p2 ◦ϕ)(e)), where p2 : U ′ × F →F is the projection, is a local trivialization of E. In fact,
any locally trivial ﬁber bundle π : E →B whose typical ﬁber F is a Banach space is a vector bundle, iﬀthe
maps χαb : Eb →F induced by the local trivializations χα : π−1(Uα) →Uα × F, are linear and continuous.
Indeed, under these hypotheses, the vector bundle charts are given by (ϕα × idF) ◦χα : π−1(Uα) →Uα × F,
where idF is the identity mapping on F.
C.
Many of the topological properties of a vector bundle are determined by its ﬁber bundle structure. For
example, a vector bundle π : E →B is trivial if and only if it is trivial as a ﬁber bundle. Clearly, if E is a
trivial vector bundle, then it is also a trivial ﬁber bundle. The converse is also true, but requires topological
ideas beyond the scope of this book. (See, for instance, Steenrod [1957].)
D.
The Klein bottle K (see Figure 1.4.2) is a locally trivial ﬁber bundle π : K →S1 with typical ﬁber S1.
The space K is deﬁned as the quotient topological space of R2 by the relation (a, b) ∼(a + k, (−1)kb + n)
for all k, n ∈Z. Let p : R2 →K be the projection p(a, b) = [a, b] and deﬁne the surjective map π : K →S1
by π([a, b]) = e2πia. Let { (Uj, ϕj) | j = 1, 2 } be the atlas of S1 given in Example 3.1.2, that is,
ϕj : S1\{(0, (−1)j+1)} →R,
ϕj(x, y) =
y
1 −(−1)jx,
which satisfy (ϕ2 ◦ϕ−1
1 )(z) = 1/z, for z ∈R\{0}. Deﬁne
χj : π−1(Uj) →Uj × S1
by χj([a, b]) = (e2πia, e2πib)
and note that pj ◦χj = π, where pj : Uj × S1 →Uj is the projection. Since
χ2 ◦χ−1
1
: (S1\{(0, 1)}) × S1 →(S1\{(0, −1)}) × S1
is the identity, Proposition 3.4.28 implies that K is a locally trivial ﬁber bundle with typical ﬁber S1. Further
topological results show that this bundle is nontrivial; see Exercise 3.4-16. (Later we will prove that K is
non-orientable—see Chapter 7.)
E.
Consider the smooth map πn : Sn →RPn which associates to each point of Sn the line through the
origin it determines. Then πn : Sn →RPn is a locally trivial ﬁber bundle whose typical ﬁber is a two-point
set. This is easily seen by taking for each pair of antipodal points two small antipodal disks and projecting
them to an open set U in RPn; thus π−1
n (U) consists of the disjoint union of these disks and the ﬁber bundle
charts simply send this disjoint union to itself. This bundle is not trivial since Sn is connected and two
disjoint copies of RPn are disconnected. These ﬁber bundles are also called the real Hopf ﬁbrations.

3.4 Vector Bundles
165
F.
This example introduces the classical Hopf ﬁbration h : S3 →S2 which is the ﬁbration with the
lowest dimensional total space and base among the series of complex Hopf ﬁbrations κn : S2n+1 →CPn
with typical ﬁber S1 (see Exercise 3.4-21). To describe h : S3 →S2 it is convenient to introduce the division
algebra of quaternions H.
For x ∈R4 write x = (x0, x) ∈R × R3 and introduce the product
(x0, x)(y0, y) = (x0y0 −x · y, x0y + y0x + x × y).
Relative to this product and the usual vector space structure, R4 becomes a non-commutative ﬁeld denoted
by H and whose elements are called quaternions. The identity element in H is (1, 0), the inverse of (x0, x)
is (x0, x)−1 = (x0, −x)/∥x∥2, where ∥x∥2 = (x0)2 +(x1)2 +(x2)2 +(x3)2. Associativity of the product comes
down to the vector identity a × (b × c) = b(a · c) −c(a · b). Alternatively, the quaternions written as linear
combinations of the form x0 + ix1 + jx2 + kx3, where
i = (0, i),
j = (0, j),
k = (0, k)
obey the multiplication rules
ij = k,
jk = i,
ki = j,
i2 = j2 = k2 = −1.
Quaternions with x0 = 0 are called pure quaternions and the conjugation x →x∗given by i∗= −i,
j∗= −j, k∗= −k is an automorphism of the R-algebra H. Then ∥x∥2 = xx∗and ∥xy∥= ∥x∥∥y∥for all
x, y ∈H. Finally, the dot product in R4 and the product of H are connected by the relation xz·yz = (x·y)∥z∥2,
for all x, y, z ∈H.
Fix y ∈H. The conjugation map cy : H →H deﬁned by cy(x) = yxy−1 is norm preserving and hence
orthogonal. Since it leaves the vector (x0, 0) invariant, it deﬁnes an orthogonal transformation of R3. A
simple computation shows that this orthogonal transformation of R3 is given by
x →x +
2
∥y∥[(x · y)y −y0(x × y) −(y · y)x]
from which one can verify that its determinant equals one, that is, it is an element of SO(3). Let π :
S3 →SO(3) denote its restriction to the unit sphere in R4. Choosing x ∈R3, deﬁne ρx : SO(3) →S2 by
ρx(A) = Ax so that by composition we get hx = ρx ◦π : S3 →S2. It is easily veriﬁed that the inverse
image of any point under hx is a circle. Taking for x = −k, minus the third standard basis vector in R3, hx
becomes the standard Hopf ﬁbration h : S3 →S2,
h(y0, y1, y1, y3) = (−2y1y3 −2y0y2, 2y0y1 −2y2y3,
(y1)2 + (y2)2 −(y0)2 −(y3)2)
which, by substituting w1 = y0 + iy3, w2 = y2 + iy1 ∈C takes the classical form
H(w1, w2) = (−2w1w2, |w2|2 −|w1|2).
Interestingly enough, the Hopf ﬁbration enters into a number of problems in classical mechanics from rigid
body dynamics to the dynamics of coupled oscillators (see Marsden and Ratiu [1994], for instance—in fact,
the map h above is an example of the important notion of what is called a momentum map).
G. The Hopf ﬁbration is nontrivial.
A rigorous proof of this fact is not so elementary and historically
was what led to the introduction of the Hopf invariant, a precursor of characteristic classes (Hopf [1931] and
Hilton and Wylie [1960]). We shall limit ourselves to a geometric description of this bundle which exhibits its
non-triviality. In fact we shall describe how each pair of ﬁbers are linked. Cut S2 along an equator to obtain

166
3. Manifolds and Vector Bundles
the closed northern and southern hemispheres, each of which is diﬀeomorphic to two closed disks DN and DS.
Their inverse images in S3 are two solid tori S1 × DN and S1 × DS. We think of S3 as the compactiﬁcation
of R3 and as the union of two solid tori glued along their common boundary by a diﬀeomorphism which
identiﬁes the parallels of one with meridians of the other and vice-versa. The Hopf ﬁbration on S3 is then
obtained in the following way. Cut each of these two solid tori along a meridian, twist them by 2π and glue
each one back together. The result is still two solid tori but whose embedding in R3 is changed: they have
the same parallels but twisted meridians; each two meridians are now linked (see Figure 3.4.5). Now glue
the two twisted solid tori back together along their common boundary by the diﬀeomorphism identifying
the twisted meridians of one with the parallels of the other and vice-versa, thereby obtaining the total space
S3 of the Hopf ﬁbration.
♦
Figure 3.4.5. Linked circles in the Hopf ﬁbration
Topological properties of the total space E of a locally trivial ﬁber bundle are to a great extent determined
by the topological properties of the base B and the typical ﬁbers F. We present here only some elementary
connectivity properties; other results can be found in Supplement 5.5C and §7.5.
3.4.30 Theorem (Path Lifting Theorem).
Let π : E →B be a locally trivial C0 ﬁber bundle and let
c : [0, 1] →B be a continuous path starting at c(0) = b. Then for each c0 ∈π−1(b0), there is a unique
continuous path ˜c : [0, 1] →E such that ˜c(0) = c0 and π ◦˜c = c.
Proof.
Cover the compact set c([0, 1]) by a ﬁnite number of open sets Ui, i = 0, 1, . . . , n −1 such that
each χi : π−1(Ui) →Ui × F is a ﬁber bundle chart. Let 0 = t0 < t1 < · · · < tn = 1 be a partition of [0, 1]
such that c([ti, ti+1]) ⊂Ui, i = 0, . . . , n −1. Let χ0(e0) = (b0, f0) and deﬁne
c0(t) = χ−1
0 (c(t), f0)
for t ∈[0, t0].
Then ˜c0 is continuous and π ◦˜c0 = c|[0, t0]. Let χ1(˜c0(t1)) = (c(t1), f1) and deﬁne
˜c1(t) = χ−1
1 (c(t), f1)
for t ∈[t1, t2].
Then ˜c1 is continuous and π ◦˜c1 = c|[t1, t2]. In addition, if e1 = χ−1
0 (c(t1), f0) then
lim
t↑t1 ˜c0(t) = e1
and
lim
t↓t1 ˜c1(t) = χ−1
1 (c(t1), f1) = ˜c0(t1) = e1,
that is, the map [0, t2] →E which equals ˜c0 on [0, t1] and ˜c1 on [t1, t2] is continuous. Now proceed similarly
on U2, . . . , Un−1.
■
Note that if π : E →B is a Ck locally trivial ﬁber bundle and c : [0, 1] →B is a piecewise Ck-map, the
above construction yields a Ck piecewise lift ˜c : [0, 1] →E.

3.4 Vector Bundles
167
3.4.31 Corollary.
Let π : E →B be a Ck locally trivial ﬁber bundle k ≥0, with base B and typical
ﬁber F pathwise connected. Then E is pathwise connected. If k ≥1, only connectivity of B and F must be
assumed.
Proof.
Let e0, e1 ∈E, b0 = π(e0), b1 = π(e1) ∈B. Since B is pathwise connected, there is a continuous
path c : [0, 1] →B, c(0) = b0, c(1) = b1. By Theorem 3.4.30, there is a continuous path ˜c : [0, 1] →E with
˜c(0) = e0. Let ˜c(1) = e′
1. Since the ﬁber π−1(b1) is connected there is a continuous path d : [1, 2] →π−1(b1)
with d(1) = e′
1 and d(2) = e1. Thus γ deﬁned by
γ(t) = ˜c(t), if t ∈[0, 1]
and
γ(t) = d(t), if t ∈[1, 2],
is a continuous path with γ(0) = e0, γ(2) = e1. Thus E is pathwise connected.
■
In Supplement 5.5C we shall prove that if π : E →B is a C0 locally trivial ﬁber bundle over a paracompact
simply connected base with simply connected typical ﬁber F, then E is simply connected.
Supplement 3.4B
Fiber Bundles over Contractible Spaces
This supplement proves that any C0 ﬁber bundle π : E →B over a contractible base B is trivial.
3.4.32 Lemma.
Let π : E →B × [0, 1] be a C0 ﬁber bundle. If { Vi | i = 1, . . . , n } is a ﬁnite cover of
[0, 1] by open intervals such that E|B × Vi is a trivial C0 ﬁber bundle, then E is trivial.
Proof.
By induction it suﬃces to prove the result for n = 2, that is, prove that if E|B×[0, t] and E|B×[t, 1]
are trivial, then E is trivial. If F denotes the typical ﬁber of E, by hypothesis there are C0 trivializations
over the identity ϕ1 : E|B × [0, t] →B × [0, t] × F and ϕ2 : E|B × [t, 1] →B × [t, 1] × F. The map
ϕ2 ◦ϕ−1
1
: B × {t} × F →B × {t} × F
is a homeomorphism of the form (b, t, f) →(b, t, αb(f)), where αb : F →F is a homeomorphism depending
continuously on b. Deﬁne the homeomorphism χ : (b, s, f) ∈B × [t, 1] × F →(b, s, α−1
b (f)) ∈B × [t, 1] × F.
Then the trivialization χ ◦ϕ2 : E|B × [t, 1] →B × [t, 1] × F sends any e ∈π−1(B × {t}) to ϕ1(e). Therefore,
the map that sends e to the element of B × [0, 1] × F given by ϕ1(e), if π(e) ∈B × [0, t] and (χ ◦ϕ2)(e), if
π(e) ∈B × [t, 1] is a continuous trivialization of E.
■
3.4.33 Lemma.
Let π : E →B × [0, 1] be a C0 ﬁber bundle. Then there is an open covering {Ui} of B
such that E|Ui × [0, 1] is trivial.
Proof.
There is a covering of B × [0, 1] by sets of the form W × V where W is open in B and V is open in
[0, 1], such that E|W ×V is trivial. For each b ∈B consider the family Φb of sets W ×V for which b ∈W. By
compactness of [0, 1], there is a ﬁnite subcollection V1, . . . , Vn of the V ’s which cover [0, 1]. Let W1, . . . , Wn
be the corresponding W’s in the family Φb and let Ub = W1 ∩· · · ∩Wn. But then E|Ub × Wi, i = 1, . . . , n are
all trivial and thus by Lemma 3.4.32, E|Ub × [0, 1] is trivial. Then { Ub | b ∈B } is the desired open covering
of B.
■
3.4.34 Lemma.
Let π : E →B × [0, 1] be a C0 ﬁber bundle such that E|B × {0} is trivial. Then E is
trivial.

168
3. Manifolds and Vector Bundles
Proof.
By Lemma 3.4.33, there is an open cover {Ui} of B such that E|Ui × [0, 1] is trivial; let ϕi be
the corresponding trivializations. Denote by ϕ : E|B × {0} →B × {0} × F the trivialization guaranteed
in the hypothesis of the lemma, where F is the typical ﬁber of E. We modify all ϕi in such a way that
ϕi : E|Ui × {0} →Ui × {0} × F coincides with ϕ : E|Ui × {0} →Ui × {0} × F in the following way.
The homeomorphism
ϕi ◦ϕ−1 : Ui × {0} × F →Ui × {0} × F
is of the form (b, 0, f) →(b, 0, αi
b(f)) for αi
b : F →F a homeomorphism depending continuously on b ∈B.
Deﬁne
χi : Ui × [0, 1] × F →Ui × [0, 1] × F
by χi(b, s, f) = (b, s, (αi
b)−1(f)).
Then ψi = χi ◦ϕi : E|Ui × [0, 1] →Ui × [0, 1] × F maps any e ∈π−1(B × {0}) to ϕ(e).
Assume each ϕi on E|Ui × {0} equals ϕ on E|Ui × {0}. Deﬁne
λi : E|Ui × [0, 1] →Ui × {0} × F
to be the composition of the map (b, s, f) ∈Ui × [0, 1] × F →(b, 0, f) ∈Ui × {0} × F with ϕi. Since
each ϕi coincides with ϕ on E|Ui × {0}, it follows that whenever Ui ∩Uj ̸= ∅, λi and λj coincide on
E|(Ui ∩Uj) × [0, 1], so that the collection of all {λi} deﬁne a ﬁber bundle map λ : E →B × {0} × F over
the map χ : (b, s) ∈B × [0, 1] →(b, 0) ∈B × {0}. By the ﬁber bundle version 3.4-23 of Exercise 3.4-15(i)
and (iii), E equals the pull-back χ∗(B × {0} × F). Since the bundle B × {0} × F →B × {0} is trivial, so is
its pull-back E.
■
3.4.35 Theorem.
Let π : E →B be any C0 ﬁber bundle over a contractible space B. Then E is trivial.
Proof.
By hypothesis, there is a homotopy h : B × [0, 1] →B such that h(b, 0) = b0 and h(b, 1) = b for
any b ∈B, where b0 ∈B is a ﬁxed element of B. Then the pull-back bundle h∗E is a ﬁber bundle over
B × [0, 1] whose restrictions to B × {0} and B × {1} equals the trivial ﬁber bundle over {b0} and E over
B × {1}, respectively. By Lemma 3.4.34, h∗E is trivial over B × [0, 1] and thus E, which is isomorphic to
E|B × {1}, is also trivial.
■
All previous proofs go through without any modiﬁcations to the Ck-case, once manifolds with boundary
are deﬁned (see §7.1).
Exercises
⋄3.4-1.
Let N ⊂M be a submanifold. Show that TN is a subbundle of TM|N and thus is a submanifold
of TM.
⋄3.4-2.
Find an explicit example of a ﬁber-preserving diﬀeomorphism between vector bundles that is not a
vector bundle isomorphism.
⋄3.4-3.
Let ρ : R × Sn →Sn and σ : Rn+1 × Sn →Sn be trivial vector bundles. Show that
TSn ⊕(R × Sn) ∼= (Rn+1 × Sn).
Hint : Realize ρ as the vector bundle whose one-dimensional ﬁber is the normal to the sphere.
⋄3.4-4.
(i)
Let π : E →B be a vector bundle. Show that TE|B is vector bundle isomorphic to E ⊕TB.
Conclude that E is isomorphic to a subbundle of TE.
Hint: The short exact sequence 0 →E →TE|B
T π
→TB →0 splits via Ti, where i : B →E is the
inclusion of B as the zero section of E; apply Proposition 3.4.26.

3.4 Vector Bundles
169
(ii)
Show that the isomorphism ϕE found in (i) is natural, that is, if π′ : E′ →B′ is another vector bundle,
f : E →E′ is a vector bundle map over fB : B →B′, and ϕE′ : TE′|B →E′ ⊕TB′ is the isomorphism
in (i) for π′ : E′ →B′, then
ϕE′ ◦Tf = (f ⊕TfB) ◦ϕE.
⋄3.4-5.
Show that the mapping s : E ⊕E →E, s(e, e′) = e + e′ (ﬁberwise addition) is a vector bundle
mapping over the identity.
⋄3.4-6.
Write down explicitly the charts in Examples 3.4.25 given by Proposition 3.4.24.
⋄3.4-7.
(i)
A vector bundle π : E →B is called stable if its Whitney sum with a trivial bundle over B
is trivial. Show that TSn is stable, but the M¨obius band M is not.
(ii)
Two vector bundles π : E →B, ρ : E →B are called stably isomorphic if the Whitney sum of
E with some trivial bundle over B is isomorphic with the Whitney sum of F with (possibly another)
trivial vector bundle over B. Let KB be the set of stable isomorphism classes of vector bundles with
ﬁnite dimensional ﬁber over B. Show that the operations of Whitney sum and of tensor product induce
on KB a ring structure. Find a surjective ring homomorphism of KB onto Z.
⋄3.4-8.
A vector bundle with one-dimensional ﬁbers is called a line bundle. Show that any line bundle
which admits a global nowhere vanishing section is trivial.
⋄3.4-9.
Generalize Example 3.4.25B to vector bundles with diﬀerent bases. If π : E →M and ρ : F →N
are vector bundles, show that the set 
(m,n)∈M×N L(Em, Fn) is a vector bundle with base M ×N. Describe
the ﬁber and compute the relevant dimensions in the ﬁnite dimensional case.
⋄3.4-10.
Let N be a submanifold of M. The normal bundle ν(N) of N is deﬁned to be ν(N) =
(TM|N)/TN. Assume that N has ﬁnite codimension k. Show that ν(N) is trivial iﬀthere are smooth
maps Xi : N →TM, i = 1, . . . , k such that Xi(n) ∈TnM and { Xi(n) | i = 1, . . . , k } span a subspace Vn
satisfying TnM = TnN ⊕Vn for all n ∈N. Show that ν(Sn) is trivial.
⋄3.4-11.
Let N be a submanifold of M. Prove that the conormal bundle deﬁned by µ(N) = { α ∈
T ∗
nM | ⟨α, u⟩= 0 for all u ∈TnN and all n ∈N } in a subbundle of T ∗M|N which is isomorphic to the
normal bundle ν(N) deﬁned in Exercise 3.4-10. Generalize the constructions and statements of 3.4-10 and
the current exercise to an arbitrary vector subbundle F of a vector bundle E.
⋄3.4-12.
(i)
Use the fact that S3 is the unit sphere in the associative division algebra H to show that
TS3 is trivial.
(ii)
Cayley numbers.
Consider on R8 = H ⊕H the usual Euclidean inner product ⟨, ⟩and deﬁne a
multiplication in R8 by (a1, b1)(a2, b2) = (a1a2 −b∗
2b1, b2a1 + b1a∗
2) where ai, bi ∈H, i = 1, 2, and the
multiplication on the right hand side is in H. Prove the relation
⟨α1β1, α2β2⟩+ ⟨α2β1, α1β2⟩= 2 ⟨α1, α2⟩⟨β1, β2⟩
where ⟨α, β⟩denotes the dot product in R8. Show that if one deﬁnes the conjugate of (a, b) by (a, b)∗=
(a∗, −b), then ∥(a, b)∥2 = (a, b)[(a, b)∗]. Prove that ∥αβ∥= ∥α∥∥β∥for all α, β ∈R8. Use this relation
to show that R8 is a nonassociative division algebra over R, C, and H. R8 with this algebraic structure
is called the algebra of Cayley numbers or algebra of octaves; it is denoted by O.
(iii)
Show that O is generated by 1 and seven symbols e1, . . . , e7 satisfying the relations
e2
i = −1,
eiej = −ejei,
e1e2 = e3,
e1e4 = e5,
e1e6 = −e7,
e2e5 = e7,
e2e4 = e6,
e3e4 = e7,
e3e5 = −e6,

170
3. Manifolds and Vector Bundles
together with 14 additional relations obtained by cyclic permutations of the indices in the last 7
relations.
Hint: The isomorphism is given by associating 1 to the element (1, 0, . . . , 0) ∈R8 and to ei the vector
in R8 having all entries zero with the exception of the (i + 1)st which is 1.
(iv)
Show that any two elements of O generate an associative algebra isomorphic to a subalgebra of H.
Hint: Show that any element of O is of the form a + be4 for a, b ∈H.
(v)
Since S7 is the unit sphere in O, show that TS7 is trivial.
⋄3.4-13.
(i)
Let π : E →B be a locally trivial ﬁber bundle. Show that V = ker(Tπ) is a vector subbundle
of TE, called the vertical bundle. A vector subbundle H of TE such that V ⊕H = TE is called
a horizontal subbundle. Show that Tπ induces a vector bundle map H →TE over π which is an
isomorphism on each ﬁber.
(ii)
If π : E →M is a vector bundle, show that each ﬁber Vv of V , v ∈E is naturally identiﬁed with Eb,
where b = π(v). Show that there is a natural isomorphism of T0E with TbB ⊕Eb, where 0 is the zero
vector in Eb. Argue that there is in general no such natural isomorphism of TvE for v ̸= 0.
⋄3.4-14.
Let En be the trivial vector bundle RPn × Rn+1.
(i)
Show that Fn = { ([x], λx) | x ∈Rn+1, λ ∈R } is a line subbundle of En.
Hint: Deﬁne
f : En →RPn × Rn+1
by f([x], y) =

[x], y −(x · y)
x
∥x∥2

and show that f is a vector bundle map having the restriction to each ﬁber a linear map of rank n.
Apply Proposition 3.4.18.
(ii)
Show that Fn is isomorphic to γ1(Rn+1).
(iii)
Show that F1 is isomorphic to the M¨obius band M.
(iv)
Show that Fn is the quotient bundle of the normal bundle ν(Sn) to Sn by the equivalence relation
which identiﬁes antipodal points and takes the outward normal to the inward normal. Show that the
projection map ν(Sn) →Fn is a 2 to 1 covering map.
(v)
Show that Fn is nontrivial for all n ≥1.
Hint: Use (iv) to show that any section σ of Fn vanishes somewhere; do this by considering the
associated section σ∗of the trivial normal bundle to Sn and using the intermediate value theorem.
(vi)
Show that any line bundle over S1 is either isomorphic to the cylinder S1 × R or the M¨obius band M.
⋄3.4-15.
(i)
Let π : E →B be a vector bundle and f : B′ →B a smooth map. Deﬁne the pull-back
bundle f ∗π : f ∗E →B′ by
f ∗E = { (v, b′) | π(v) = f(b′) },
f ∗π(v, b′) = b′
and show that it is a vector bundle over B′, whose ﬁbers over b′ equal Ef(b′). Show that h : f ∗E →E,
h(e, b) = e, is a vector bundle map which is the identity on every ﬁber. Show that the pull-back bundle
of a trivial bundle is trivial.
(ii)
If g : B′′ →B′ show that (f ◦g)∗π : (f ◦g)∗E →B′′ is isomorphic to the bundles g∗f ∗π : g∗f ∗E →B′′.
Show that isomorphic vector bundles have isomorphic pull-backs.

3.4 Vector Bundles
171
(iii)
If ρ : E′ →B′ is a vector bundle and g : E′ →E is a vector bundle map inducing the map f : B′ →B
on the zero sections, then prove there exists a unique vector bundle map g∗: E′ →f ∗E inducing the
identity on B′ and is such that h ◦g∗= g.
(iv)
Let σ : F →B be a vector bundle and u : F →E be a vector bundle map inducing the identity on
B. Show that there exists a unique vector bundle map f ∗u : f ∗F →f ∗E inducing the identity on B′
and making the diagram
F
f ∗E
F
E
f ∗u
u
✲
✲
❄
❄
(v)
If π : E →B, π′ : E′ →B are vector bundles and if ∆: B →B × B is the diagonal map b →(b, b),
show that E ⊕E′ ∼= ∆∗(E × E′).
(vi)
Let π : E →B and π′ : E′ →B be vector bundles and denote by π : B × B →B, i = 1, 2 the
projections. Show that E × E′ ∼= p∗
1(E) ⊕p∗
2(E′) and that the following sequences are split exact:
0 →E →E ⊕E′ →E′ →0.
0 →E′ →E ⊕E′ →E →0.
0 →p∗
1(E) →E × E′ →p∗
2(E′) →0.
0 →p∗
2(E′) →E × E′ →p∗
1(E) →0.
⋄3.4-16.
(i)
Show that Gk(Rn) is a submanifold of Gk+1(Rn+1). Denote by i : Gk(Rn) →Gk+1(Rn+1),
i(F) = F × R the canonical inclusion map.
(ii)
If ρ : R × Gk(Rn) →Gk(Rn) is the trivial bundle, show that the pull-back bundle i∗(γk+1(Rn+1)) is
isomorphic to γk(Rn) ⊕(R × Gk(Rn)).
⋄3.4-17.
Show that
T(M1 × M2) ∼= p∗
1(TM1) ⊕p∗
2(TM2)
where pi : M1 × M2 →Mi, i = 1, 2 are the canonical projections and p∗
i (TMi) denotes the pull-back bundle
deﬁned in Exercise 3.4-15.
⋄3.4-18.
(i)
Let π : E →B be a vector bundle. Show that there is a short exact sequence
0 −→π∗E −→T
f
−→E
g
−→π∗(TB) −→0
where
f(v, v′) = d
dt

t=0
(v + tv′)
and
g(vv) = (Tvπ(uv), π(v))
(ii)
Show that ker(Tπ) is a subbundle of TE, called the vertical subbundle of TE. Any subbundle
H ⊂TE such that TE = ker(Tπ) ⊕H, is called a horizontal subbundle of TE. Show that Tπ
induces an isomorphism of H with π∗(TB).

172
3. Manifolds and Vector Bundles
(iii)
Show that if TE admits a horizontal subbundle then the sequence in (i) splits.
⋄3.4-19.
Let π : E →B, ρ : F →C be vector bundles and let f : B →C be a smooth map. Deﬁne
Lf(E, F) = Γ∗
fL(E, F), where Γf : b ∈B →(b, f(b)) ∈B × C is the graph map deﬁned by f. Show that
sections of Lf(E, F) coincide vector bundle maps E →F over f.
⋄3.4-20.
Let M be an n-manifold. A frame at m ∈M is an isomorphism α : TmM →Rn. Let
F(M) = { (m, α) | α is a frame at m }.
Deﬁne π : F(M) →M by π(m, α) = m.
(i)
Let (U, ϕ) be a chart on M. Show that (m, α) ∈π−1(U) →(m, Tmϕ ◦α−1) ∈U × GL(Rn) is a
diﬀeomorphism. Prove that these diﬀeomorphisms as (U, ϕ) vary over a maximal atlas of M deﬁne by
collation a manifold structure on F(M). Prove that π : F(M) →M is a locally trivial ﬁber bundle
with typical ﬁber GL(n).
(ii)
Prove that the sequence
0 −→ker(Tπ)
i
−→TF(M)
π∗τ
−→π∗(TM) −→0
is short exact, where i is the inclusion and π∗τ is the vector bundle projection π∗(TM) →F(M)
induced by the tangent bundle projection τ : TM →M.
(iii)
Show that ker(Tπ) and π∗(TM) are trivial vector bundles.
(iv)
A splitting 0 →π∗(TM)
h→TF(M) of the short sequence in (ii) is called a connection on M. Show
that if M has a connection, then TF(M) = ker(Tπ) ⊕H, where H is a subbundle of TF(M) whose
ﬁbers are isomorphic by Tπ to the ﬁber of TM.
⋄3.4-21.
(i)
Generalize the Hopf ﬁbration to the complex Hopf ﬁbrations κn : S2n+1 →CPn with
ﬁber S1.
(ii)
Replace in (i) C by the division algebra of quaternions H. Generalize (i) to the quaternionic Hopf
ﬁbrations χn : S4n+3 →HPn with ﬁber S3. HPn is the quaternionic space deﬁned as the set of one
dimensional vector subspaces over H in Hn+1. Is anything special happening when n = 1? Describe.
⋄3.4-22.
(i)
Try to deﬁne OPn, where O are the Cayley numbers. Show that the proof of transitivity of
the equivalence relation in On+1 requires associativity.
(ii)
Deﬁne p′(a, b) = ab−1 if b ̸= 0 and p′(a, b) = ∞if b = 0, where S8 is thought of as the one-point
compactiﬁcation of R8 = O (see Exercise 3.1-5). Show p′ is smooth and prove that p = p′|S15 is onto.
Proceed as in Example 3.4.29D and show that p : S15 →S8 is a ﬁber bundle with typical ﬁber S7
whose bundle structure is given by an atlas with two ﬁber bundle charts.
⋄3.4-23.
Deﬁne the pull-back of ﬁber bundles and prove properties analogous to those in Exercise 3.4-15.
3.5
Submersions, Immersions, and Transversality
The notions of submersion, immersion, and transversality are geometric ways of stating various hypotheses
needed for the inverse function theorem, and are central to large portions of calculus on manifolds. One
immediate beneﬁt is easy proofs that various subsets of manifolds are actually submanifolds.
3.5.1 Theorem (Local Diﬀeomorphisms Theorem).
Suppose that M and N are manifolds, f : M →N
is of class Cr, r ≥1 and m ∈M. Suppose Tf restricted to the ﬁber over m ∈M is an isomorphism. Then
f is a Cr diﬀeomorphism from some neighborhood of m onto some neighborhood of f(m).

3.5 Submersions, Immersions, and Transversality
173
Proof.
In local charts, the hypothesis reads: (Dfϕψ)(u) is an isomorphism, where ϕ(m) = u. Then the
inverse function theorem guarantees that fϕψ restricted to a neighborhood of u is a Cr diﬀeomorphism.
Composing with chart maps gives the result.
■
The local results of Theorems 2.5.9 and 2.5.13 give the following:
3.5.2 Theorem (Local Onto Theorem).
Let M and N be manifolds and f : M →N be of class Cr, where
r ≥1. Suppose Tf restricted to the ﬁber TmM is surjective to Tf(m)N. Then
(i)
f is locally onto at m; that is, there are neighborhoods U of m and V of f(m) such that f|U : U →V
is onto; in particular, if Tf is surjective on each tangent space, then f is an open mapping;
(ii)
if, in addition, the kernel ker(Tmf) is split in TmM there are charts (U, ϕ) and (V, ψ) with m ∈U,
f(U) ⊂V , ϕ : U →U ′ × V ′, ϕ(m) = (0, 0), ψ : V →V ′, and fϕψ : U ′ × V →V ′ is the projection onto
the second factor.
Proof.
It suﬃces to prove the results locally, and these follow from Theorems 2.5.9 and 2.5.13.
■
Submersions.
The notions of submersion and immersion correspond to the local surjectivity and injec-
tivity theorems from §2.5. Let us ﬁrst examine submersions, building on the preceding theorem.
3.5.3 Deﬁnition.
Suppose M and N are manifolds with f : M →N of class Cr, r ≥1. A point n ∈N is
called a regular value of f if for each m ∈f −1({n}), Tmf is surjective with split kernel. Let Rf denote the
set of regular values of f : M →N; note N\f(M) ⊂Rf ⊂N. If, for each m in a set S, Tmf is surjective
with split kernel, we say f is a submersion on S. Thus n ∈Rf iﬀf is a submersion on f −1({n}). If Tmf
is not surjective, m ∈M is called a critical point and n = f(m) ∈N a critical value of f.
3.5.4 Theorem (Submersion Theorem).
Let f : M →N be of class C∞and n ∈Rf. Then the level set
f −1(n) = { m | m ∈M, f(m) = n }
is a closed submanifold of M with tangent space given by Tmf −1(n) = ker Tmf.
Proof.
First, if B is a submanifold of M, and b ∈B, we need to clarify in what sense TbB is a subspace of
TbM. Letting i : B →M be the inclusion, Tbi : TbB →TbM is injective with closed split range. Hence TbB
can be identiﬁed with a closed split subspace of TbM. If f −1(n) = ∅the theorem is clearly valid. Otherwise,
for m ∈f −1(n) we ﬁnd charts (U, ϕ), (V, ψ) as described in Theorem 3.5.2. Because
ϕ(U ∩f −1(n)) = f −1
ϕψ(0) = U ′ × {0},
we get the submanifold property. (See Figure 3.5.1.) Since fϕψ : U ′ × V ′ →V ′ is the projection onto the
second factor, where U ′ ⊂E and V ′ ⊂F, we have
Tu(f −1
ϕψ(0)) = TuU ′ = E = ker(Tufϕψ)
for u ∈U ′,
which is the local version of the second statement.
■
If N is ﬁnite dimensional and n ∈Rf, observe that codim(f −1(n)) = dim N, from the second statement of
Theorem 3.5.4. (This makes sense even if M is inﬁnite dimensional.) Sard’s theorem, discussed in the next
section, implies that Rf is dense in N.
3.5.5 Examples.
A.
We shall use the preceding theorem to show that Sn ⊂Rn+1 is a submanifold. Indeed, let f : Rn+1 →R
be deﬁned by f(x) = ∥x∥2, so Sn = f −1(1). To show that Sn is a submanifold, it suﬃces to show that 1

174
3. Manifolds and Vector Bundles
n
V ′
f −1(n)
f
ψ
U ′ × V ′
Uϕψ
ϕ
Figure 3.5.1. Submersion theorem
is a regular value of f. Suppose f(x) = 1. Identifying TRn+1 = Rn+1 × Rn+1, and the ﬁber over x with
elements of the second factor, we get
(Txf)(v) = Df(x) · v = 2 ⟨x, v⟩.
Since x ̸= 0, this linear map is not zero, so as the range is one-dimensional, it is surjective. The same
argument shows that the unit sphere in Hilbert space is a submanifold.
B. Stiefel Manifolds.
Deﬁne
St(m, n; k) = { A ∈L(Rm, Rn) | rank A = k },
where k ≤min(m, n).
Using the preceding theorem we shall prove that St(m, n; k) is a submanifold of L(Rm, Rn) of codimension
(m−k)(n−k); this manifold is called the Stiefel manifold and plays an important role in the study of prin-
cipal ﬁber bundles. To show that St(m, n; k) is a submanifold, we will prove that every point A ∈St(m, n; k)
has an open neighborhood U in L(Rm, Rn) such that St(m, n; k) ∩U is a submanifold in L(Rm, Rn) of the
right codimension; since the diﬀerentiable structures on intersections given by two such U coincide (being
induced from the manifold structure of L(Rm, Rn)), the submanifold structure of St(m, n; k) is obtained by
collation (Exercise 3.2-6). Let A ∈St(m, n; k) and choose bases of Rm, Rn such that
A =
a
b
c
d

with a an invertible k × k matrix. The set
U =
 
x
y
z
v
  x is an invertible k × k matrix

is open in L(Rn, Rn). An element of U has rank k iﬀv −zx−1y = 0. Indeed

I
0
−zx−1
I


3.5 Submersions, Immersions, and Transversality
175
is invertible and

I
0
−zx−1
I
 x
y
z
v

=
x
y
0
v −zx−1y

,
so
rank

x
y
z
v

= rank

x
y
0
v −zx−1y

equals k iﬀv −zx−1y = 0. Deﬁne f : U →L(Rm−k, Rn−k) by
f

x
y
z
v

= v −zx−1y.
The preceding remark shows that f −1(0) = St(m, n; k) ∩U and thus if f is a submersion, f −1(0) is a
submanifold of L(Rm, Rn) of codimension equal to
dim L(Rm−k, Rn−k) = (m −k)(n −k).
To see that f is a submersion, note that for x, y, z ﬁxed, the map v →v −zx−1y is a diﬀeomorphism of
L(Rm−k, Rn−k) to itself.
C. Orthogonal Group.
Let O(n) be the set of elements Q of L(Rn, Rn) that are orthogonal, that is,
QQT = Identity. We shall prove that O(n) is a compact submanifold of dimension n(n−1)/2. This manifold
is called the orthogonal group of Rn; the group operations (composition of linear operators and inversion)
being smooth in L(Rn, Rn) are therefore smooth in O(n), that is, O(n) is an example of a Lie group. To
show that O(n) is a submanifold, let sym(n) denote the vector space of symmetric linear operators S of
Rn, that is, ST = S; its dimension equals n(n + 1)/2. The map f : L(Rn, Rn) →sym(n), f(Q) = QQT is
smooth and has derivative
TQf(A) = AQT + QAT = AQ−1 + QAT
at Q ∈O(n). This linear map from L(Rn, Rn) to sym(n) is onto since for any S ∈sym(n),
TQf(SQ/2) = S.
Therefore, by Theorem 3.5.4, f −1 (Identity) = O(n) is a closed submanifold of L(Rn, Rn) of dimension equal
to n2 −n(n + 1)/2 = n(n −1)/2. Finally, O(n) is compact since it lies on the unit sphere of L(Rn, Rn).
D. Orthogonal Stiefel Manifold.
Let k ≤n and
Fk,n = OSt(n, n; k) = { orthonormal k-tuples of vectors in Rn }.
We shall prove that OSt(n, n; k) is a compact submanifold of O(n) of dimension nk −k(k +1)/2; it is called
the orthogonal Stiefel manifold. Any n-tuple of orthonormal vectors in Rn is obtained from the standard
basis e1, . . . , en of Rn by an orthogonal transformation. Since any k-tuple of orthonormal vectors can be
completed via the Gram–Schmidt procedure to an orthonormal basis, the set OSt(n, n; k) equals f −1(0),
where f : O(n) →O(n −k) is given by letting f(Q) = Q′, where
Q′ = the (n −k) × (n −k) matrix obtained from Q by removing its
ﬁrst k rows and columns.
Since TQf(A) = A′ is onto, it follows that f is a submersion. Therefore, f −1(0) is a closed submanifold of
O(n) of dimension equal to
n(n −1)
2
−(n −k)(n −k −1)
2
= nk −k(k + 1)
2
.
♦

176
3. Manifolds and Vector Bundles
Immersions.
Now we look at maps whose derivatives are one-to-one.
3.5.6 Deﬁnition.
A Cr map f : M →N, r ≥1, is called an immersion at m if Tmf is injective with
closed split range in Tf(m)N. If f is an immersion at each m, we just say f is an immersion.
3.5.7 Theorem (Immersion Theorem).
For a Cr map f : M →N, where r ≥1, the following are
equivalent:
(i)
f is an immersion at m;
(ii)
there are charts (U, ϕ) and (V, ψ) with m ∈U, f(U) ⊂V , ϕ : U →U ′, ψ : V →U ′ ×V ′ and ϕ(m) = 0
such that fϕψ : U ′ →U ′ × V ′ is the inclusion u →(u, 0);
(iii)
there is a neighborhood U of m such that f(U) is a submanifold in N and f restricted to U is a
diﬀeomorphism of U onto f(U).
Proof.
The equivalence of (i) and (ii) is guaranteed by the local immersion theorem 2.5.12. Assuming (ii),
choose U and V given by that theorem to conclude that f(U) is a submanifold in V . But V is open in N
and hence f(U) is a submanifold in N proving (iii). The converse is a direct application of the deﬁnition of
a submanifold.
■
It should be noted that the theorem does not imply that f(M) is a submanifold in N. For example
f : S1 →R2, given in polar coordinates by r = cos 2θ, is easily seen to be an immersion (by computing Tf
using the curve c(θ) = cos(2θ) on S1 but f(S1) is not a submanifold of R2: any neighborhood of 0 in R2
intersects f(S1) in a set with “corners” which is not diﬀeomorphic to an open interval. In such cases we say
f is an immersion with self-intersections. See Figure 3.5.2.
S1
f
y
x
r = cos 2θ
R2
Figure 3.5.2. Images of immersions need not be submanifolds
In the preceding example f is not injective. But even if f is an injective immersion, f(M) need not be
a submanifold of N, as the following example shows. Let f be a curve whose image is as shown in Figure
3.5.3. Again the problem is at the origin: any neighborhood of zero does not have the relative topology given
by N.
Embeddings.
If f : M →N is an injective immersion, f(M) is called an immersed submanifold of
N.
3.5.8 Deﬁnition.
An immersion f : M →N that is a homeomorphism onto f(M) with the relative
topology induced from N is called an embedding.
Thus, if f : M →N is an embedding, then f(M) is a submanifold of N.
The following is an important situation in which an immersion is guaranteed to be an embedding; the
proof is a straightforward application of the deﬁnition of relative topology.

3.5 Submersions, Immersions, and Transversality
177
f
y
x
r = cos 2θ
R2
3π/4
7π/4
Figure 3.5.3. Images of injective immersions need not be submanifolds
3.5.9 Theorem (Embedding Theorem).
An injective immersion which is an open or closed map onto its
image is an embedding.
The condition “f : M →N is closed” is implied by “f is proper,” that is, each sequence xn ∈M with f(xn)
convergent to y N has a convergent subsequence xn(i) in M such that f(xn(i)) converges to y. Indeed, if this
hypothesis holds, and A is a closed subset of M, then f(A) is shown to be closed in N in the following way.
Let xn ∈A, and suppose f(xn) = yn converges to y ∈N. Then there is a subsequence {zm} of {xn}, such
that zm →x. Since A = cl(A), x ∈A and by continuity of f, y = f(x) ∈f(A); that is, f(A) is closed. If N is
inﬁnite dimensional, this hypothesis is assured by the condition “the inverse image of every compact set in
N is compact in M.” This is clear since in the preceding hypothesis one can choose a compact neighborhood
V of the limit of f(xn) in N so that for n large enough, all xn belong to the compact neighborhood f −1(V )
in M. The reader should note that while both hypotheses in the proposition are necessary, properness of f
is only suﬃcient. An injective nonproper immersion whose image is a submanifold is, for example, the map
f : ]0, ∞[ →R2 given by
f(t) =

t cos 1
t , t sin 1
t

.
This is an open map onto its image so Theorem 3.5.9 applies; the submanifold f(]0, ∞[) is a spiral around
the origin.
Transversality.
This is an important notion that applies to both maps and submanifolds.
3.5.10 Deﬁnition.
A Cr map f : M →N, r ≥1, is said to be transversal to the submanifold P of N
(denoted f ⋔P) if either f −1(P) = ∅, or if for every m ∈f −1(P),
T1.
(Tmf)(TmM) + Tf(m)P = Tf(m)N and
T2.
the inverse image (Tmf)−1(Tf(m)P) of Tf(m)P splits in TmM.
The ﬁrst condition T1 is purely algebraic; no splitting assumptions are made on (Tmf)(TmM), nor need
the sum be direct. If M is a Hilbert manifold, or if M is ﬁnite dimensional, then the splitting condition T2
in the deﬁnition is automatically satisﬁed.
3.5.11 Examples.
A.
If each point of P is a regular value of f, then f ⋔P since, in this case, (Tmf)(TmM) = Tf(m)N.
B.
Assume that M and N are ﬁnite-dimensional manifolds with dim(P)+dim(M) < dim(N). Then f ⋔P
implies f(M) ∩P = ∅. This is seen by a dimension count: if there were a point m ∈f −1(P) ∩M, then
dim(N) = dim((Tmf)(TmM) + Tf(m)P) ≤dim(M) + dim(P) < dim(N),
which is absurd.

178
3. Manifolds and Vector Bundles
C.
Let M = R2, N = R3, P = the (x, y) plane in R3, a ∈R and deﬁne fa : M →N, by fa(x, y) =
(x, y, x2 + y2 + a). Then f ⋔P if a ̸= 0; see Figure 3.5.4. This example also shows intuitively that if a map
is not transversal to a submanifold it can be perturbed very slightly to a transversal map; for a discussion
of this phenomenon we refer to the Supplement 3.6B.
♦
(0,0,0)
(0,0,a)
(0,0,a)
a > 0
a = 0
a < 0
image of fu
x
x
x
y
y
Figure 3.5.4. These manifolds are nontransverse to the xy plane at a = 0.
3.5.12 Theorem (Transversal Mapping Theorem).
Let f : M →N be a C∞map and P a submanifold
of N. If f ⋔P, then f −1(P) is a submanifold of M and
Tm(f −1(P)) = (Tmf)−1(Tf(m)P)
for all m ∈f −1(P). If P has ﬁnite codimension in N, then codim(f −1(P)) = codim(P).
Proof.
Let (V, ψ) be a chart at f(m0) ∈P in N with the submanifold property for P; let
ψ(V ) = V1 × V2 ⊂F1 ⊕F2,
ψ(V ∩P) = V1 × {0},
ψ(f(m0)) = (0, 0)
and denote by p2 : V1 × V2 →V2 the canonical projection. Let (U, ϕ) be a chart at m0 in M, such that
ϕ(m0) = 0, ϕ : U →ϕ(U) ⊂E and f(U) ⊂V . For m ∈U ∩f −1(P),
Tm(p2 ◦ψ ◦f|U) = p2 ◦Tf(m)ψ ◦Tmf
and
Tm(ψ ◦f)(TmM) + F1 = F1 ⊕F2
(by transversality of f on P). Hence Tm(p2 ◦ψ ◦f|U) : TmU = TmM →F2 is onto. Its kernel is
(Tmf)−1(Tf(m)P) since ker p2 = F1 and
(Tf(m)ψ)−1(F1) = Tf(m)P,
and thus it is split in TmM. In other words, 0 is a regular value of p2 ◦ψ ◦f|U : U →F2 and thus
(p2 ◦ψ ◦f|U)−1(0) = f −1(P ∩V )
is a submanifold of U, and hence of M whose tangent space at m ∈U equals ker(Tm(p2 ◦ψ ◦f|U)) =
(Tmf)−1(Tf(m)P) by the submersion theorem 3.5.4. Thus f −1(P ∩V ) is a submanifold of M for any chart
domain V with the submanifold property; that is, f −1(P) is a submanifold of M. If P has ﬁnite codimension
then F2 is ﬁnite dimensional and thus again by the submersion theorem,
codim(f −1(P)) = codim f −1(P ∩V ) = dim(F2) = codim(P).
■

3.5 Submersions, Immersions, and Transversality
179
Notice that this theorem reduces to the submersion theorem if P is a point.
3.5.13 Corollary.
Suppose that M1 and M2 are submanifolds of M, m ∈M1 ∩M2, TmM1 + TmM2 =
TmM, and that TmM1∩TmM2 splits in TmM for all m ∈M1∩M2; this condition is denoted M1 ⋔M2 and we
say M1 and M2 are transversal. Then M1∩M2 is a submanifold of M and Tm(M1∩M2) = TmM1∩TmM2.
M1 and M2 are said to intersect cleanly when this conclusion holds. (Transversality thus implies clean
intersection.) If both M1 and M2 have ﬁnite codimension in M, then codim(M1 ∩M2) = codim(M1) +
codim(M2).
Proof.
The inclusion i1 : M1 →M, satisﬁes i1 ⋔M2, and i−1
1 (M2) = M1 ∩M2. Now apply the previous
theorem.
■
3.5.14 Examples.
A.
In R3, the unit sphere M1 = { (x, y, z) | x2 + y2 + z2 = 1 } intersects the cylinder M2 = { (x, y, z) |
x2 + y2 = a } transversally if 0 < a ̸= 1; M1 ∩M2 = ∅if a > 1 and M1 ∩M2 is the union of two circles if
0 < a < 1 (Figure 3.5.5).
0 < a < 1
a = 1
a > 1
M1
M2
Figure 3.5.5. A sphere intersects a cylinder transversally except at the critical value a = 1
B.
The twisted ribbon M1 in Figure 3.5.6 does not meet M2, the xy plane, in a manifold, so M1 is not
transversal to M2.
C.
Let M be the xy-plane in R3 and N be the graph of f(x, y) = (xy)2. Even though TN ∩TM has
constant dimension (equal to 2), N ∩M is not a manifold (Figure 3.5.7).
♦
Subimmersions.
There is one more notion connected with geometric ways to state the implicit function
theorem that generalizes submersions in a diﬀerent way than transversality. Roughly speaking, instead of
requiring that a map f : M →N have onto tangent map at each point, one asks that its rank be constant.
3.5.15 Deﬁnition.
A Cr map f : M →N, r ≥1 is called a subimmersion if for each point m ∈M
there is an open neighborhood U of m, a manifold P, a submersion s : U →P, and an immersion j : P →N
such that f|U = j ◦s.
Note that submersions and immersions are subimmersions. The order submersion followed by immersion
in this deﬁnition is important, because the opposite order would yield nothing. Indeed, if f : M →N is
any C∞mapping, then we can write f = p2 ◦j, where j : M →M × N, is given by j(m) = (m, f(m)) and

180
3. Manifolds and Vector Bundles
M1 ⊃ M2
⊃
M1
M2
Figure 3.5.6. The twisted ribbon
Figure 3.5.7. Constancy of dimension of TM ∩TN does not imply smoothness of M ∩N
p2 : M × N →N the canonical projection. Clearly j is an immersion and p2 a submersion, so any mapping
can be written as an immersion followed by a submersion.
The following will connect the notion of submersion to “constant rank.”
3.5.16 Proposition.
(i)
A C∞map f : M →N is a subimmersion iﬀfor every m ∈M there is a chart (U, ϕ) at m, where
ϕ : U →V1 × U2 ⊂F1 ⊕E2,
ϕ(m) = (0, 0),
and a chart (V, ψ) at f(m) where
f(U) ⊂V,
ψ : V →V1 × V2 ⊂F1 ⊕F2,
ψ(f(m)) = (0, 0)
such that fϕψ(x, y) = (x, 0).
(ii)
If M or N are ﬁnite dimensional, f is a subimmersion iﬀthe rank of the linear map Tmf : TmM →
Tf(m)N is constant for m in each connected component of M.
Proof.
(i) follows from Theorem 3.5.2, Theorem 3.5.7(ii) and the composite mapping theorem; alterna-
tively, one can use Theorem 2.5.15. If M or N are ﬁnite dimensional, then necessarily rank(Tmf) is ﬁnite

3.5 Submersions, Immersions, and Transversality
181
and thus by (i) the local representative Tmf has constant rank in a chart at m; that is, the rank of Tmf
is constant on connected components of M, thus proving (ii). The converse follows by Theorem 2.5.15 and
(i).
■
3.5.17 Theorem (Subimmersion Theorem).
Suppose f : M →N is C∞, n0 ∈N and f is a subim-
mersion in an open neighborhood of f −1(n0). (If M or N are ﬁnite dimensional this is equivalent to Tmf
having constant rank in a neighborhood of each m ∈f −1(n0).) Then f −1(n0) is a submanifold of M with
Tmf −1(n0) = ker(Tmf).
Proof.
If f −1(n0) = ∅there is nothing to prove. If m ∈f −1(n0) ﬁnd charts (U, ϕ) at m and (V, ψ) at
f(m) = n0 given by Proposition 3.5.16(i). Since ϕ(U ∩f −1(n0)) = f −1
ϕψ(0) = {0} × U2 we see that (U, ϕ) has
the submanifold property for f −1(n0). In addition, if u ∈U2, then
T(0,u)(f −1
ϕψ(0)) = TuU2 = E2 = ker(T(0,u)fϕψ),
which is the local version of the second statement.
■
Notice that
codim(f −1(n0)) = rank(Tmf)
for m ∈f −1(n0)
if rank(Tmf) is ﬁnite. The subimmersion theorem reduces to Theorem 3.5.4 when f is a submersion. The
immersion part of the subimmersion f implies a version of Theorem 3.5.7(iii).
3.5.18 Theorem (Fibration Theorem).
The following are equivalent for a C∞map f : M →N:
(i)
the map f is a subimmersion (if M or N are ﬁnite dimensional, this is equivalent to the rank of Tmf
being locally constant);
(ii)
for each m ∈M there is a neighborhood U of m, a neighborhood V of f(m), and a submanifold Z of M
with m ∈Z such that f(U) is a submanifold of N and f induces a diﬀeomorphism of f −1(V ) ∩Z ∩U
onto f(U) ∩V ;
(iii)
ker Tf is a subbundle of TM (called the tangent bundle to the ﬁbers) and for each m ∈M, the
image of Tmf is closed and splits in Tf(m)N.
If one of these hold and if f is open (or closed) onto its image, then f(M) is a submanifold of N.
Proof.
To show that (i) implies (ii), choose for U and V the chart domains given by Proposition 3.5.16(i)
and let Z = ϕ−1(V1 × {0}). Then
ψ(f(U) ∩V ) = fϕψ(V1 × U2) = V1 × {0},
that is, f(U) is a submanifold of N. In addition, the local expression of f : f −1(V ) ∩Z ∩U →f(U) ∩V
is (x, 0) →(x, 0), thus proving that so restricted, f is a diﬀeomorphism. Reading this argument backward
shows that (ii) implies (i).
We have
Tϕ(ker Tf ∩TU) = V1 × U2 × {0} × E2,
since fϕψ(x, y) = (x, 0), thus showing that (TU, Tϕ) has the subbundle property for ker Tf. The same local
expression shows that (Tmf)(TmM) is closed and splits in Tf(m)M and thus (i) implies (iii). The reverse is
proved along the same lines.
If f is open (closed) onto its image, then f(U) ∩V [resp., int(f(cl(U))) ∩V ] can serve as a chart domain
for f(M) with the relative topology induced from N. Thus f(M) is a submanifold of N.
■
The relationship between transversality and subimmersivity is given by the following.

182
3. Manifolds and Vector Bundles
3.5.19 Proposition.
Let f : M →N be smooth, P a submanifold of N, and assume that f ⋔P. Then
there is an open neighborhood W of P in N such that f|f −1(W) : f −1(W) →W is a subimmersion.
Proof.
Let m ∈f −1(P) and write Tm(f −1(P)) = ker(Tmf) ⊕Cm so that Tmf : Cm →TnP is an
isomorphism, where n = f(m). As in the proof of Theorem 3.5.12, this situation can be locally straightened
out, so we can assume that M ⊂E1 ×E2, where P is open in E1 and E1 = ker Tmf ⊕C for a complementary
space C. The map f restricted to C is a local immersion, so projection to C followed by the restriction of
f to C writes f as the composition of a submersion followed by an immersion. We leave it to the reader to
expand the details of this argument.
■
In some applications, the closedness of f follows from properness of f; see the discussion following Theorem
3.5.9.
If M or N is ﬁnite dimensional, then f being a subimmersion is equivalent to ker Tf being a subbundle
of TM. Indeed, range(Tmf) = TmM/ ker(Tmf) and thus dim(range(Tmf)) = codim(ker(Tmf)) = constant
and f is hence a subimmersion by Proposition 3.5.16(ii). Proposition 3.5.19 is an inﬁnite dimensional version
of this.
We have already encountered subimmersions in the study of vector bundles. Namely, the condition in
Proposition 3.4.18(i) (which insures that for a vector bundle map f over the identity ker f and range f are
subbundles) is nothing other than f being a subimmersion.
Quotients.
We conclude this section with a study of quotient manifolds.
3.5.20 Deﬁnition.
An equivalence relation R on a manifold M is called regular if the quotient space
M/R carries a manifold structure such that the canonical projection π : M →M/R is a submersion. If R
is a regular equivalence relation, then M/R is called the quotient manifold of M by R.
Since submersions are open mappings, π and hence the regular equivalence relations R are open.
Quotient manifolds are characterized by their eﬀect on mappings.
3.5.21 Proposition.
Let R be a regular equivalent relation on M.
(i)
A map f : M/R →N is Cr, r ≥1 iﬀf ◦π : M →N is Cr.
(ii)
Any Cr map g : M →N compatible with R, that is, xRy implies g(x) = g(y), deﬁnes a unique Cr
map ˆg : M/R →N such that ˆg ◦π = g.
(iii)
The manifold structure of M/R is unique.
Proof.
(i)
If f is Cr, then so is f ◦π by the composite mapping theorem. Conversely, let f ◦π be Cr.
Since π is a submersion it can be locally expressed as a projection and thus there exist charts (U, ϕ) at
m ∈M and (V, ψ) at π(m) ∈M/R such that
ϕ(U) = U1 × U2 ⊂E1 ⊕E2,
ψ(V ) = U2 ⊂E2,
and
πϕψ(x, y) = y.
Hence if (W, χ) is a chart at (f ◦π)(m) in N satisfying (f ◦π)(U) ⊂W, then fψχ = (f ◦π)ϕχ|{0} × U2 and
thus fψχ is Cr.
(ii)
The mapping ˆg is uniquely determined by ˆg ◦π = g. It is Cr by (i) .
(iii) Let (M/R)1 and (M/R)2 be two manifold structures on M/R having π as a submersion. Apply (ii) for
(M/R)1 with N = (M/R)2 and g = π to get a unique C∞map h : (M/R)1 →(M/R)2 such that h ◦π = π.
Since π is surjective, h = identity. Interchanging the roles of the indices 1 and 2, shows that the identity
mapping induces a C∞map of (M/R)2 to (M/R)1. Thus, the identity induces a diﬀeomorphism.
■
3.5.22 Corollary.
Let M and N be manifolds, R and Q regular equivalence relations on M and N,
respectively, and f : M →N a Cr map, r ≥1, compatible with R and Q; that is, if xRy then f(x)Qf(y).
Then f induces a unique Cr map ϕ : M/R →N/Q and the diagram

3.5 Submersions, Immersions, and Transversality
183
TM
TN
T(M/R)
T(N/Q)
Tf
Tφ
TπM
TπN
✲
✲
❄
❄
commutes.
Proof.
The map ϕ is uniquely determined by πN ◦f = ϕ ◦πM. Since πN ◦f is Cr, ϕ is Cr by Proposition
3.5.21. The diagram is obtained by applying the chain rule to πN ◦f = ϕ ◦πM.
■
The manifold M/R might not be Hausdorﬀ. By Proposition 1.4.10 it is Hausdorﬀiﬀthe graph of R is
closed in M × M; R is open since it is regular. For an example of a non-Hausdorﬀquotient manifold see
Exercise 3.5-8.
There is, in fact, a bijective correspondence between surjective submersions and quotient manifolds. More
precisely, we have the following.
3.5.23 Proposition.
Let f : M →N be a submersion and let R be the equivalence relation deﬁned by f;
that is, xRy iﬀf(x) = f(y). Then R is regular, M/R is diﬀeomorphic to f(M), and f(M) is open in N.
Proof.
As f is a submersion, it is an open mapping, so f(M) is open in N. Moreover, since f is open,
so is the equivalence R and thus f induces a homeomorphism of M/R onto f(M) (see the comments
following Deﬁnition 1.4.9). Put the diﬀerentiable structure on M/R that makes the homeomorphism into a
diﬀeomorphism. Then M/R is a manifold and the projection is clearly a submersion, since f is.
■
This construction provides a number of examples of quotient manifolds.
3.5.24 Examples.
A. The base space of any vector bundle is a quotient manifold. Take the submersion to be the vector
bundle projection.
B. The circle S1 is a quotient manifold of R deﬁned by the submersion θ →eiθ; we can then write
S1 = R/2πZ, including the diﬀerentiable structure.
C. The Grassmannian Gk(E) is a quotient manifold in the following way. Deﬁne the set D by D =
{ (x1, . . . , xk) | xi ∈E, x1, . . . , xk are linearly dependent }. Since D is open in the product E × · · · × E
(k times), one can deﬁne the map π : D →Gk(E) by π(x1, . . . , xk) = span{x1, . . . , xk}. Using the
charts described in Example 3.1.8G, one ﬁnds that π is a submersion. In particular, the projective
spaces RPn and CPn are quotient manifolds.
D. The M¨obius band as explained in Example 3.4.10C is a quotient manifold.
E. Quotient bundles are quotient manifolds (see Proposition 3.4.17).
♦
We close with an important characterization of regular equivalence relations due to Godement, as presented
by Serre [1965].
3.5.25 Theorem.
An equivalence relation R on a manifold M is regular iﬀ
(i)
graph(R) is a submanifold of M × M, and
(ii)
p1 : graph(R) →M, p1(x, y) = x is a submersion.

184
3. Manifolds and Vector Bundles
Proof.
First assume that R is regular. Since π : M →M/R is a submersion, so is the product π × π :
M × M →(M/R) × (M/R) so that graph(R) = (π × π)−1(∆M/R), where the set
∆M/R = { ([x], [x]) | [x] ∈M/R }
is the diagonal of M/R×M/R, is a submanifold of M ×M (Theorem 3.5.4). This proves (i). To verify (ii), let
(x, y) ∈graph(R) and vx ∈TxM. Since π is a submersion and π(x) = π(y), there exists vy ∈TyM such that
Tyπ(vy) = Txπ(vx); that is, (vx, vy) ∈T(x, y)(graph(R)) by Theorem 3.5.4. But then T(x, y)p1(vx, vy) = vx,
showing that p1 is a submersion.
To prove the converse, we note that the equivalence relation is open, that is, that π−1(π(U)) is an open
subset of M whenever U is open in M. Indeed
π−1(π(U)) = p1((M × U) ∩graph(R))
which is open since p1 is an open map being a submersion by (ii). Second, the diﬀeomorphism s : (x, y) →
(y, x) of graph(R) shows that p1 is a submersion iﬀp2 : graph(R) →M, p2(x, y) = y is a submersion since
p2 = p1 ◦s. The rest of the proof consists of two major steps: a reduction to a local problem and the solution
of the local problem.
■
Step 1.
If M = 
i Ui, where Ui are open subsets of M such that Ri = R∩(Ui×Ui) is a regular equivalence
relation in Ui, then R is regular.
Openness of R implies openness of Ri and of U ∗
i = π−1(π(Ui)). Let us ﬁrst show that R∗
i = R∩(U ∗
i ×U ∗
i )
is regular on U ∗
i . Let πi : Ui →Ui/Ri and π∗
i : U ∗
i →U ∗
i /R∗
i denote the canonical projections. We prove
that the existence of a manifold structure on Ui/Ri and submersivity of πi imply that U ∗
i /R∗
i has a manifold
structure and that π∗
i is a submersion. For this purpose let λi : Ui/Ri →U ∗
i /R∗
i be the bijective map induced
by the inclusion ji : Ui →U ∗
i and endow U ∗
i /R∗
i with the manifold structure making λi into a diﬀeomorphism.
Thus π∗
i is a submersion iﬀρi = λ−1
i
◦π∗
i : U ∗
i →Ui/Ri is a submersion. Since λi ◦πi = π∗
i ◦ji, it follows
that ρi|Ui = πi is a submersion and therefore the composition (ρi|Ui)◦p2 : (U ∗
i ×Ui)∩graph(R) →Ui/Ri is
a submersion. The relations (ρi|Ui)◦p2 = ρi ◦p1 show that ρi ◦p1 is a submersion and since p1 is a surjective
submersion this implies that ρi is a submersion (see Exercise 3.5-6(iv)).
Thus, in the statement of Step 1, we can assume that all open sets Ui are such that Ui = π−1(π(Ui)).
Let Rij be the equivalence relation induced by R on Ui ∩Uj. Since Ui ∩Uj/Rij is open in both Ui/Ri and
Uj/Rj, it follows that it has two manifold structures. Since πi and πj are submersions, they will remain
submersions when restricted to Ui ∩Uj. Therefore Rij is regular and by Proposition 3.5.21(iii) the manifold
structures on Ui ∩Uj/Rij induced by the equivalence relations Ui/Ri and Uj/Rj coincide. Therefore there
is a unique manifold structure on M/R such that Ui/Ri are open submanifolds; this structure is obtained
by collation (see Exercise 3.2-6). The projection π is a submersion since πi = π|Ui is a submersion for all i.
Step 2.
For each m ∈M there is an open neighborhood U of m such that R ∩(U × U) = RU is regular.
The main technical work is contained in the following.
3.5.26 Lemma.
For each m ∈M there is an open neighborhood U of M, a submanifold S of U and a
smooth map s : U →S such that [u] ∩S = {s(u)}; S is called a local slice of R.
Let us assume the lemma and use it to prove Step 2. The inclusion of S into U is a right inverse of s and
thus s is a submersion. Now deﬁne ϕ : S →U/RU by ϕ(u) = [u]. By the lemma, ϕ is a bijective map. Put
the manifold structure on U/RU making ϕ into a diﬀeomorphism. The relation ϕ ◦s = π|U shows that π|U
is submersive and thus RU is regular.
Proof of Lemma 3.5.26.
In the entire proof, m ∈M is ﬁxed. Deﬁne the space F by F = { v ∈TmM |
(0, v) ∈T(m,m)(graph(R)) }, then {0}×F = ker T(m,m)p1 and thus by hypothesis (ii) in the theorem, {0}×F
splits in T(m,m)(graph(R)). The latter splits in TmM × TmM by hypothesis (i) and thus {0} × F splits in
TmM ×TmM. Since {0}×F is a closed subspace of {0}×TmM, it follows that F splits in TmM (see Exercise
2.1-7). Let G be a closed complement of F in TmM and choose locally a submanifold P of M, m ∈P, such

3.5 Submersions, Immersions, and Transversality
185
that TmP = G. Deﬁne the set Q by Q = (M × P) ∩graph(R). Since Q = p−1
2 (P) and p2 : graph(R) →M
is a submersion, Q is a submanifold of graph(R).
We claim that T(m,m)p1 : T(m,m)Q →TmM is an isomorphism. Since T(m,m)Q = (T(m,m)p2)−1(TmP), it
follows that
ker(T(m,m)p1|T(m,m)Q) = ker T(m,m)p1 ∩(T(m,m)p2)−1(TmP)
= ({0} × F) ∩(TmM × G)
= {0} × (F ∩G) = {(0, 0)},
that is, T(m,m)p1|T(m,m)Q is injective. Now let u ∈TmM and choose v ∈TmM such that (u, v) ∈
T(m,m)(graph(R)). If v = v1 + v2, v1 ∈F, v2 ∈G, then
(u, v2) = (u, v) −(0, v1) ∈T(m,m)(graph(R))
+ ({0} × F) ⊂T(m,m)(graph(R))
and T(m,m)p2(u, v2) = v2 ∈TmP, that is, (u, v2) ∈(T(m,m)p2)−1(TmP) = T(m,m)Q. Then T(m,m)p1(u, v2) =
u and hence T(m,m)p1|T(m,m)Q is onto.
Thus p1 : Q →M is a local diﬀeomorphism at (m, m), that is, there are open neighborhoods U1 and U2
of m, U1 ⊂U2 such that p1 : Q ∩(U1 × U2) →U1 is a diﬀeomorphism. Let σ be the inverse of p1 on U1.
Since σ is of the form σ(x) = (x, s(x)), this deﬁnes a smooth map s : U1 →P. Note that if x ∈U1 ∩P, then
(x, x) and (x, s(x)) are two points in Q ∩(U1 × U2) with the same image in U1 and hence are equal. This
shows that s(x) = x for x ∈U1 ∩P.
Set U = { x ∈U1 | s(x) ∈U1 ∩P } and let S = U ∩P. Since s is smooth and U1 ∩P is open in P it
follows that U is open in U1 hence in M. Also, m ∈U since m ∈U1 ∩P and so m = s(m). Let us show
that s(U) ⊂S, that is, that if x ∈U, then s(x) ∈U and s(x) ∈P. The last relation is obvious from the
deﬁnition of U. To show that s(x) ∈U is equivalent to proving that s(x) ∈U1, which is clear, and that
s(s(x)) ∈U1 ∩P. However, since s(s(x)) = s(x), because s(x) ∈P, it follows from x ∈U that s(x) ∈U1 ∩P.
Thus we have found an open neighborhood U of m, a submanifold S of U, and a smooth map s : U →S
which is the identity in U ∩S.
Finally, we show that s(x) is the only element of S equivalent to x ∈U. But this is clear since there is
exactly one point in (U × S) ∩graph(R), namely (x, s(x)) mapped by p1 into x, since p1|(U × S) ∩graph(R)
is a diﬀeomorphism m.
■
The above proof shows that in condition (ii) of the theorem, p1 can be replaced by p2. Also recall that
M/R is HausdorﬀiﬀR is closed.
Supplement 3.5A
Lagrange Multipliers
Let M be a smooth manifold and i : N →M a submanifold of M, i denoting the inclusion mapping. If
f : M →R, we want to determine necessary and suﬃcient conditions for n ∈N to be a critical point of
f|N, the restriction of f to N. Since f|N = f ◦i, the chain rule gives Tn(f|N) = Tnf ◦Tni; thus n ∈N is
a critical point of f|N iﬀTnf|TnN = 0. This condition takes a simple form if N happens to be the inverse
image of a point under submersion.
3.5.27 Theorem (Lagrange Multiplier Theorem).
Let g : M →P be a smooth submersion, p ∈P, N =
g−1(p) and let f : M →R be Cr, r ≥1. A point n ∈N is a critical point of f|N if there exists λ ∈T ∗
p P,
called a Lagrange multiplier, such that Tnf = λ ◦Tng.

186
3. Manifolds and Vector Bundles
Proof.
First assume such a λ exists. Since TnN = ker Tng,
(λ ◦Tng ◦Tni)(vn) = λ(Tng(vn)) = 0
for all vn ∈TnN;
that is, 0 = (λ ◦Tng)|TnN = Tnf|TnN.
Conversely, assume Tnf|TnN = 0. By the local normal form for submersions, there is a chart (U, ϕ) at n,
ϕ : U →U1 × V1 ⊂E × F such that ϕ(U ∩N) = {0} × V1 satisfying ϕ(n) = (0, 0), and a chart (V, ψ) at p,
ψ : V →U1 ⊂E where g(U) ⊂V , ψ(p) = 0, and such that
gϕψ(x, y) = (ψ ◦g ◦ϕ−1)(x, y) = x
for all (x, y) ∈U1 × V1. If fϕ = f ◦ϕ−1 : U1 × V1 →R, we have for all v ∈F, D2fϕ(0, 0) · v = 0 since
Tnf|TnN = 0. Thus, letting µ = D1fϕ(0, 0) ∈E∗, u ∈E and v ∈F, we get
Dfϕ(0, 0) · (u, v) = µ(u) = (µ ◦Dgϕψ)(0, 0) · (u, v);
that is,
Dfϕ(0, 0) = (µ ◦Dgϕψ)(0, 0).
To pull this local calculation back to M and P, let λ = µ ◦Tpψ ∈T ∗
p P, so composing the foregoing relation
with Tnϕ on the right we get Tnf = λ ◦Tng.
■
3.5.28 Corollary.
Let g : M →P be transversal to the submanifold W of P, N = g−1(W), and let
f : M →R be Cr, r ≥1. Let Eg(n) be a closed complement to Tg(n)W in Tg(n)P so Tg(n)P = Tg(n)W ⊕Eg(n)
and let π : Tg(n)P →Eg(n) be the projection. A point n ∈N is a critical point of f|N iﬀthere exists λ ∈E∗
g(n)
called a Lagrange multiplier such that Tnf = λ ◦π ◦Tng.
Proof.
By Theorem 3.5.12, there is a chart (U, ϕ) at n, with ϕ(U) = U1×U2 ⊂E1×E2, ϕ(U ∩N) = {0}×
U2, and ϕ(n) = (0, 0), and a chart (V, ψ) at g(n) satisfying ψ(V ) = U1 ×V1 ⊂F1 ×F, ψ(V ∩W) = {0}×V1,
ψ(g(n)) = (0, 0), and g(U) ⊂V , such that the local representative satisﬁes
gϕψ(x, y) = (ψ ◦g ◦ϕ−1)(x, y) = (x, η(x, y))
for all (x, y) ∈U1×V1. Let ρ : E1×F →E1 be the canonical projection. By the Lagrange multiplier theorem
applied to the composition ρ ◦gϕψ : U1 × U2 →U1, (0, 0) ∈U1 × U2 is a critical point of f|{0} × U2 iﬀthere
is a point µ ∈E∗
1 such that Dfϕ(0, 0) = µ ◦ρ ◦Dgϕψ(0, 0). Composing this relation on the right with Tnϕ
and letting λ = µ ◦Tg(n)ψ and
π = (Tg(n)ψ)−1|Eg(n) ◦ρ ◦Tg(n)ψ : Tg(n)P →Eg(n),
we get the required identity Tnf = λ ◦π ◦Tng.
■
If P is a Banach space F, then Theorem 3.5.27 can be formulated in the following way.
3.5.29 Corollary.
Let F be a Banach space, g : M →F a smooth submersion, N = g−1(0), and f : M →
R be Cr, r ≥1. The point n ∈N is a critical point of f|N iﬀthere exists λ ∈F∗, called a Lagrange
multiplier, such that n is a critical point of f −λ ◦g.
Notes
1. λ depends not just on f|N but also on how f is extended oﬀN.
2. This form of the Lagrange multiplier theorem is extensively used in the calculus of variations to study
critical points of functions with constraints; cf. Caratheodory [1965].

3.5 Submersions, Immersions, and Transversality
187
3. We leave it to the reader to generalize Corollary 3.5.28 in the same spirit.
4. There are generalizations to f : M →Rk, which we invite the reader to formulate.
The name Lagrange multiplier is commonly used in conjunction with the previous corollary in Euclidean
spaces. Let U be an open set in Rn, F = Rp, g = (g1, . . . , gp) : U →Rp a submersion and f : U →R smooth.
Then x ∈N = g−1(0) is a critical point of f|N, iﬀthere exists
λ =
p

i=1
λiei ∈(Rp)∗,
where e1, . . . , ep is the standard dual basis in Rp, such that n is a critical point of
f −λ ◦g = f −
p

i=1
λigi.
In calculus, the real numbers λi are referred to as Lagrange multipliers. Thus, to ﬁnd a critical point
x = (x1, . . . , xm) ∈N ⊂Rm of f|N one solves the system of m + p equations
∂f
∂xj (x) −
p

i=1
λi
∂gi
∂xj (x) = 0,
j = 1, . . . , m
gi(x) = 0,
i = 1, . . . , p
for the m + p unknowns x1, . . . , xm, λ1, . . . , λp.
For example, let N = S2 ⊂R3 and f : R3 →R; f(x, y, z) = z. Then f|S2 is the height function on the
sphere and we would expect (0, 0, ±1) to be the only critical points of f|S2; note that f itself has no critical
points. The method of Lagrange multipliers, with g(x, y, z) = x2 + y2 + z2 −1, gives
0 −2xλ = 0,
0 −2yλ = 0,
1 −2zλ = 0,
and
x2 + y2 + z2 = 1.
The only solutions are λ = ±1/2, x = 0, y = 0, z = ±1, and indeed these correspond to the maximum and
minimum points for f on S2. See an elementary text such as Marsden and Tromba [1996] for additional
examples. For more advanced applications, see Luenberger [1969].
The reader will recall from advanced calculus that maximum and minimum tests for a critical point can be
given in terms of the Hessian, that is, matrix of second derivatives. For constrained problems there is a similar
test involving bordered Hessians. Bordered Hessians are simply the Hessians of h = f −λg + c(λ −λ0)2
in (x, λ)-space. Then the Hessian test for maxima and minima apply; a maximum or minimum of h clearly
implies the same for f on a level set of g. See Marsden and Tromba [1996] (pp. 224–30) for an elementary
treatment and applications.
Exercises
⋄3.5-1.
(i)
Show that the set SL(n, R) of elements of L(Rn, Rn) with determinant 1 is a closed submanifold
of dimension n2 −1; SL(n, R) is called the special linear group. Generalize to the complex case.
(ii)
Show that O(n) has two connected components. The component of the identity SO(n) is called the
special orthogonal group.
(iii)
Let U(n) = { U ∈L(Cn, Cn) | UU ∗= Identity } be the unitary group. Show that U(n) is a non-compact
submanifold of dimension n2 of L(Cn, Cn) and O(2n).

188
3. Manifolds and Vector Bundles
(iv)
Show that the special unitary group SU(n) = U(n)∩SL(n, C) is a compact n2−1 dimensional manifold.
(v)
Deﬁne
J =

0
I
−I
0

∈L(R2n, R2n),
where I is the identity of Rn. Show that Sp(2n, R) = { Q ∈L(R2n,
R2n) | QJQT = J } is a compact submanifold of dimension 2n2 +n; it is called the symplectic group.
⋄3.5-2.
Deﬁne USt(n, n; k) and Sp St(2n, 2n; 2k) analogous to the deﬁnition of OSt(n, n; k) in Example
3.5.5D. Show that they are compact manifolds and compute their dimensions.
⋄3.5-3.
(i)
Let P ⊂O(3) be deﬁned by
P = { Q ∈O(3) | det Q = +1, Q = QT }\{I}.
Show that P is a two-dimensional compact submanifold of O(3).
(ii)
Deﬁne f : RP2 →O(3), f(ℓ) = the rotation through π about the line ℓ. Show that f is a diﬀeomorphism
of RP2 onto P.
⋄3.5-4.
(i)
If N is a submanifold of dimension n in an m-manifold M, show that for each x ∈N there
is an open neighborhood U ⊂M with x ∈U and a submersion f : U ⊂M →Rm−n, such that
N ∩U = f −1(0).
(ii)
Show that RP1 is a submanifold of RP2, which is not the level set of any submersion of RP2 into RP1;
in fact, there are no such submersions.
Hint: RP1 is one-sided in RP2.
⋄3.5-5.
(i)
Show that if f : M →N is a subimmersion, g : N →P an immersion and h : Z →M a
submersion, then g ◦f ◦h is a subimmersion.
(ii)
Show that if fi : Mi →Ni, i = 1, 2 are immersions (submersions, subimmersions), then so is f1 × f2 :
M1 × M2 →N1 × N2.
(iii)
Show that the composition of two immersions (submersions) is again an immersion (submersion). Show
that this fails for subimmersions.
(iv)
Let f : M →N and g : N →P be Cr, r ≥1. If g ◦f is an immersion, show that f is an immersion.
If g ◦f is a submersion and if f is onto, show that g is a submersion.
(v)
Show that if f is an immersion (resp., embedding, submersion, subimmersion) then so is Tf.
⋄3.5-6.
(i)
Let M be a manifold, R a regular equivalence relation and S another equivalence relation
implied by R; that is, graph R ⊂graph S. Denote by S/R the equivalence relation induced by S on
M/R. Show that S is regular iﬀS/R is and in this case establish a diﬀeomorphism (M/R)/(S/R) →
M/S.
(ii)
Let Mi, i = 1, 2 be manifolds and Ri be regular equivalences on Mi. Denote by R the equivalence on
M1 × M2 deﬁned by R1 × R2. Show that M/R is diﬀeomorphic to (M1/R1) × (M2/R2).
⋄3.5-7 (The line with two origins).
Let M be the quotient topological space obtained by starting with
(R × {0}) ∩(R × {1}) and identifying (t, 0) with (t, 1) for t ̸= 0. Show that this is a one-dimensional
non-Hausdorﬀmanifold. Find an immersion R →M.
⋄3.5-8.
Let f : M →N be C∞and denote by h : TM →f ∗(TN) the vector bundle map over the identity
uniquely deﬁned by the pull-back. Prove the following:

3.5 Submersions, Immersions, and Transversality
189
(i)
f is an immersion iﬀ0 →TM
h→f ∗(TN) is ﬁber split exact;
(ii)
f is a submersion iﬀTM
h→f ∗(TN) →0 is ﬁber split exact;
(iii)
f is a subimmersion iﬀker(h) and range(h) are subbundles.
⋄3.5-9.
Let A be a real nonsingular symmetric n × n matrix and c a nonzero real number. Show that the
quadratic surface { x ∈Rn | ⟨Ax, x⟩= c } is an (n −1)-submanifold of Rn.
⋄3.5-10 (Steiner’s Roman Surface).
Let f : S2 →R4 be deﬁned by
f(x, y, z) = (yz, xz, xy, x2 + 2y2 + 3z2).
(i)
Show that f(p) = f(q) if and only if p = ±q.
(ii)
Show that f induces an immersion f ′ : RP2 →R4.
(iii)
Let g : RP2 →R3 be the ﬁrst three components of f ′. Show that g is a “topological” immersion and
try to draw the surface g(RP2) (see Spivak [1979] for the solution).
⋄3.5-11 (Covering maps).
Let f : M →N be smooth and M compact, dim(M) = dim(N) < ∞. If n is a
regular value of f, show that f −1(n) is a ﬁnite set {m1, . . . , mk} and that there exists an open neighborhood
V of n in N and disjoint open neighborhoods U1, . . . , Uk of m1, . . . , mk such that f −1(V ) = U1 ∪· · · ∪Uk,
and f|Uk : Ui →V , i = 1, . . . , k are all diﬀeomorphisms. Show k is constant if M is connected and f is a
submersion.
⋄3.5-12.
Let f : M →N and g : N →P be smooth maps, such that g ⋔V where V is a submanifold of P.
Show that f ⋔g−1(V ) iﬀg ◦f ⋔V .
⋄3.5-13.
Show that an injective immersion f : M →N is an embedding iﬀf(M) is a closed submanifold
of an open submanifold of N. Show that if f : M →N is an embedding, f is a diﬀeomorphism of M onto
f(M).
Hint: See Exercise 2.5-12.
⋄3.5-14.
Show that the map p : St(n, n; k) = Gk(Rn) deﬁned by p(A) = range A is a surjective submersion.
⋄3.5-15.
Show that f : RPn × RPm →RPmn+m+n given by
(x, y) →[x0y0, x0y1, . . . , xiyj, . . . , xnym]
is an embedding. (This embedding is used in algebraic geometry to deﬁne the product of quasiprojective
varieties; it is called the Segre embedding.)
⋄3.5-16.
Show that
{ (x, y) ∈RPn × RPm | n ≤m,

i=0,...,n
xiyi = 0 }
is an (m + n −1)-manifold. It is usually called a Milnor manifold.
⋄3.5-17 (Fiber product of manifolds).
Let f : M →P and g : N →P be C∞mappings such that (f, g) :
M × N →P × P is transversal to the diagonal of P × P. Show that the set deﬁned by M ×P N =
{ (m, n) ∈M × N | f(m) = g(n) } is a submanifold of M × N. If M and N are ﬁnite dimensional, show that
codim(M ×P N) = dim P.
⋄3.5-18.
(i)
Let H be a Hilbert space and GL(H) the group of all isomorphisms A : H →H that are
continuous. As we saw earlier, GL(H) is open in L(H, H) and multiplication and inversion are C∞
maps, so GL(H) is a Lie group. Show that O(H) ⊂GL(H) deﬁned by O(H) = { A ∈GL(H) |
⟨Ax, Ay⟩= ⟨x, y⟩for all x, y ∈H } is a smooth submanifold and hence also a Lie group.

190
3. Manifolds and Vector Bundles
(ii)
Show that the tangent space at the identity of GL(H) (the Lie algebra) consists of all bounded skew
adjoint operators, as follows. Let S(H) = { A ∈L(H, H) | A∗= A }, where A∗is the adjoint of A.
Deﬁne f : GL(H) →S(H), by f(A) = A∗A. Show f is C∞, f −1(I) = O(H), and
Df(A) · B = B∗A + A∗B.
Show that f is a submersion, and
ker Df(A) = { B ∈L(H, H) | B∗A + A∗B = 0 },
which splits; a complement is the space { T ∈L(H, H) | T ∗A = A∗T } since any U splits as
U = 1
2(U −A∗−1U ∗A) + 1
2(U + A∗−1U ∗A).
⋄3.5-19.
(i)
If f : M →N is a smooth map of ﬁnite-dimensional manifolds and m ∈M, show that there
is an open neighborhood U of m such that rank(Txf) ≥rank(Tmf) for all x ∈U.
Hint: Use the local expression of Tmf as a Jacobian matrix.
(ii)
Let M be a ﬁnite-dimensional connected manifold and f : M →M a smooth map satisfying f ◦f = f.
Show that f(M) is a closed connected submanifold of M. What is its dimension?
Hint: Show f is a closed map. For m ∈f(M) show that
range(Tmf) = ker(Identity −Tmf)
and thus
rank(Tmf) + rank(Identity −Tmf) = dim M.
Both ranks can only increase in a neighborhood of m by (i), so rank(Tmf) is locally constant on f(M).
Thus there is a neighborhood U of f(M) such that the rank of f on U is bigger than or equal to the
rank of f on f(M). Use rank(AB) ≤rank A and the fact that f ◦f = f to show that the rank of f
on U is smaller than or equal to the rank of f in f(M). Therefore rank of f on U is constant. Apply
Theorem 3.5.18(iii).
⋄3.5-20.
(i)
Let α, β : E →R be continuous linear maps on a Banach space E such that ker α = ker β.
Show that α and β are proportional.
Hint: Split E = ker α ⊕R.
(ii)
Let f, g : M →R be smooth functions with 0 a regular value of both f and g and N = f −1(0) = g−1(0).
Show that for all x ∈N, df(x) = λ(x) dg(x) for a smooth function λ : N →R.
⋄3.5-21.
Let f : M →N be a smooth map, P ⊂N a submanifold, and assume f ⋔P. Use Deﬁnition
3.5.10 and Exercise 3.4-10 to show the vector bundle isomorphism ν(f −1(P)) ∼= f ∗(ν(P)).
Hint: Look at Tf|f −1(P) and compute the kernel of the induced map TM|f −1(P) →ν(P). Obtain a
vector bundle map ν(f −1(P)) →ν(P) which is an isomorphism on each ﬁber. Then invoke the universal
property of the pull–back of vector bundles; see Exercise 3.4-13.
⋄3.5-22.
(i)
Recall (Exercise 3.2-1) that Sn with antipodal points identiﬁed is diﬀeomorphic to RPn.
Conclude that any closed hemisphere of Sn with antipodal points on the great circle identiﬁed is also
diﬀeomorphic to RPn.
(ii)
Let Bn be the closed unit ball in Rn. Map Bn to the upper hemisphere of Sn by mapping x →
(x, (1 −∥x∥2)1/2). Show that this map is a diﬀeomorphism of an open neighborhood of Bn to an open
neighborhood of the upper hemisphere Sn
+ = { x ∈Sn | xn+1 ≥0 }, mapping Bn homeomorphically
to Sn
+ and homeomorphically to the great circle { x ∈Sn | xn+1 = 0 }. Use (i) to show that Bn with
antipodal points on the boundary identiﬁed is diﬀeomorphic to RPn.

3.5 Submersions, Immersions, and Transversality
191
(iii)
Show that SO(3) is diﬀeomorphic to RP3; the diﬀeomorphism is induced by the map sending the closed
unit ball B3 in R3 to SO(3) via (x, y, z) →(the rotation about (x, y, z) by the right hand rule in the
plane perpendicular to (x, y, z) through the angle π(x2 + y2 + z2)1/2).
⋄3.5-23.
(i) Show that Sn × R embeds in Rn+1.
Hint: The image is a “fat” sphere.
(ii) Describe explicitly in terms of trigonometric functions the embedding of T2 into R3.
(iii) Show that Sa(1) × · · · × Sa(k), where a(1) + · · · a(k) = n embeds in Rn+1.
Hint: Show that its product with R embeds in Rn+1 by (i).
⋄3.5-24.
Let f : M →M be an involution without ﬁxed points, that is, f ◦f = identity and f(m) ̸= m for
all m. Let R be the equivalence relation determined by f, that is, m1Rm2 iﬀf(m1) = f(m2).
(i)
Show R is a regular equivalence relation.
(ii)
Show that the diﬀerentiable structure of M/R is uniquely determined by the property: the projection
π : M →M/R is a local diﬀeomorphism.
⋄3.5-25 (Connected sum of manifolds).
Let M and N to be two Hausdorﬀmanifolds modeled on the same
Banach space E. Let m ∈M, n ∈N and let (U0, ϕ0) be a chart at m and let (V0, ψ0) be a chart at n such
that ϕ0(m) = ψ0(n) = 0 and ϕ0(U), ψ0(V ) contain the closed unit ball in E. Thus, if B denotes the open
unit ball in E, ϕ0(U)\B and ψ0(V )\B are nonempty. If A and B are atlases of M and N respectively, let
Am, Bn be the induced atlases on M\{m} and N\{n} respectively. Deﬁne
σ : B\{0} →B\{0}
by σ

∥x∥, x
∥x∥

=

1 −∥x∥, x
∥x∥

and observe that σ2 = identity. Let W be the disjoint union of M\{m} with N\{n} and deﬁne an equivalence
relation R in W by
v1Rv2 iﬀ(w1 = w2) or
(w1 ∈M\{m}, ϕ0(w1) ∈B\{0} and w2 ∈N\{n},
ψ0(w2) ∈B\{0} and ϕ0(w1) = (σ ◦ψ0)(w2)) or
(same condition with w1 and w2 interchanged).
(i)
Show that R is an equivalence relation on W.
(ii)
Show R is regular.
(iii)
If π : W →W/R denotes the projection, show that for any open set O in the atlas of W, π : O →π(O)
is a diﬀeomorphism.
(iv)
Show that
{ (π(U), ϕ ◦(π|U)−1), (π(V ), ψ ◦(π|V )−1) | (U, ϕ) ∈Am, (V, ψ) ∈Bn }
is an atlas deﬁning the diﬀerentiable structure of W/R.
(v)
W/R is denoted by M#N. Draw T2#T2 and identify T2#RP2 and RP2#RP2.
(vi)
Prove that
M#(N#P) ≈(M#N)#P,
M#N ≈N#M,
M#SE ≈M,
where M, N, and P are all modeled on E, SE is the unit sphere in E, and ≈denotes “diﬀeomorphic.”

192
3. Manifolds and Vector Bundles
(vii)
Compute Rn#Rn# · · · #Rn (k times) for all positive integers n and k and show that it embeds in Rn.
⋄3.5-26.
(i) Let a > 0 and deﬁne
χa : R →R
by χa(x) = exp

−x2
a2 −x2

,
if x ∈]−a, a[ and χa(x) = 0 if x ∈
R\]−a, a[. Show that this is a C∞function and satisﬁes the
inequalities 0 ≤χa(x) ≤1, |χ′
a(x)| < 1 for all x ∈R, and χa(0) = 1.
(ii)
Fix a > 0 and λ ∈E∗, where E is a Banach space whose norm is of class Cr away from the origin and
r ≥1. Write E = ker λ ⊕R; this is always possible since any closed ﬁnite codimensional space splits
(see §2.2). Deﬁne, for any t ∈R, fλ,a,t : E →E by fλ,a,t(u, x) = (u, x + tχa(∥u∥)) where u ∈ker λ and
x ∈R. Show that fλ,a,t satisﬁes fλ,a,t(0, 0) = (0, 1) and fλ,a,t|(E\ cl(Ba(0))) = identity.
Hint: Show that fλ,a,t is a bijective local diﬀeomorphism.
(iii)
Let M be a Cr Hausdorﬀmanifold modeled on a Banach space E whose norm is Cr on E\{0}, r ≥1.
Assume dim M ≥2. Let C be a closed set in M and assume that M\C is connected. Let {p1, . . . , pk},
{q1, . . . , qk} be two ﬁnite subsets of M\C. Show that there exists a Cr diﬀeomorphism ϕ : M →M
such that ϕ(pi) = qi, i = 1, . . . , k and ϕ|C = identity. Show that if k = 1, the result holds even if
dim M = 1.
Hint: For k = 1, deﬁne an equivalence relation on M\C : m ∼n iﬀthere is a diﬀeomorphism
ψ : M →M homotopic to the identity such that ϕ(m) = n and ψ|C = identity. Show that the
equivalence classes are open in M\C in the following way. Let ϕ : U →E be a chart at m, ϕ(m) = 0,
U ⊂M\C, and let n ∈U, n ̸= m. Use the Hahn–Banach theorem to show that there is λ ∈E∗such
that ϕ can be modiﬁed to satisfy ϕ(m) = (0, 0), ϕ(n) = (0, 1), where E = ker λ ⊕R. Use (ii) to ﬁnd
a diﬀeomorphism h : U →U homotopic to the identity on U, satisfying h(m) = n and h|(U\A) =
identity, where A is a closed neighborhood of n. Then f : M →M which equals h on U and the
identity on M\U establishes m ∼n. For general k proceed by induction, using the connectedness of
M\C\{q1, . . . , qk−1} and ﬁnding by the case k = 1 a diﬀeomorphism g homotopic to the identity on
M sending h(pk) to qk and keeping C ∪{q1, . . . , qk} ﬁxed; h : M →M is the diﬀeomorphism given by
induction which keeps C ﬁxed and sends pi to qi for r = 1, . . . , k −1. Then f = g ◦h is the desired
diﬀeomorphism.
3.6
The Sard and Smale Theorems
This section is devoted to the classical Sard theorem and its inﬁnite-dimensional generalization due to Smale
[1965]. We ﬁrst develop a few properties of sets of measure zero in Rn.
Sets of Measure Zero.
A subset A ⊂Rm is said to have measure zero if, for every ε > 0, there is a
countable covering of A by open sets Ui, such that the sum of the volumes of Ui is less than ε. Clearly a
countable union of sets of measure zero has measure zero.
3.6.1 Lemma.
Let U ⊂Rm be open and A ⊂U be of measure zero. If f : U →Rm is a C1 map, then
f(A) has measure zero.
Proof.
Let A be contained in a countable union of relatively compact sets Cn. If we show that f(A ∩Cn)
has measure zero, then f(A) has measure zero since it will be a countable union of sets of measure zero. But
Cn is relatively compact and thus there exists M > 0 such that ∥Df(x)∥≤M for all x ∈Cn. By the mean
value theorem, the image of a cube of edge length d is contained in a cube of edge length d√mM.
■

3.6 The Sard and Smale Theorems
193
3.6.2 Lemma (Fubini Lemma).
Let A be a countable union of compact sets in Rn, ﬁx an integer r satis-
fying 1 ≤r ≤n −1 and assume that Ac = A ∩({c} × Rn−r) has measure zero in Rn−r for all c ∈Rr. Then
A has measure zero.
Proof.
By induction we reduce to the case r = n −1. It is enough to work with one element of the union,
so we may assume A itself is compact and hence there exists and interval [a, b] such that A ⊂[a, b] × Rn−1.
Since Ac is compact and has measure zero for each c ∈[a, b], there is a ﬁnite number of closed cubes
Kc,1, . . . , Kc,N(c) in Rn−1 the sum of whose volumes is less than ε and such that {c} × Kc,i cover Ac,
i = 1, . . . , N(c). Find a closed interval Ic with c in its interior such that Ic × Kc,i ⊂Ac × Rn−1. Thus the
family
{ Ic × Kc,i | i = 1, . . . , N(c), c ∈[a, b] }
covers A ∩([a, b] × Rn−1) = A. Since { int(Ic) | c ∈[a, b] } covers [a, b], we can choose a ﬁnite subcovering
Ic(1), . . . , Ic(M). Now ﬁnd another covering Jc(1), . . . , Jc(K) such that each Jc(i) is contained in some Ic(j)
and such that the sum of the lengths of all Jc(i) is less than 2(b −a). Consequently { Jc(j) × Kc(j),i | j =
1, . . . , K, i = 1, . . . , Nc(j) } cover A and the sum of their volumes is less than 2(b −a)ε.
■
Sard Theorem.
Let us recall the following notations from §3.5. If M and N are C1 manifolds and
f : M →N is a C1 map, a point x ∈M is a regular point of f if Txf is surjective, otherwise x is a critical
point of f. If C ⊂M is the set of critical points of f, then f(C) ⊂N is the set of critical values of f
and N\f(C) is the set of regular values of f, which is denoted by Rf or R(f). In addition, for A ⊂M
we deﬁne Rf|A by Rf|A = N\f(A ∩C). In particular, if U ⊂M is open, Rf|U = R(f|U).
3.6.3 Theorem (Sard’s Theorem in Rn).
Let U ⊂Rm be open and f : U →Rn be of class Ck, where
k > max(0, m −n). Then the set of critical values of f has measure zero in Rn.
Note that if m ≤n, then f is only required to be at least C1.
Proof.
(Complete only for k = ∞) Denote by
C = { x ∈U | rank Df(x) < n }
the set of critical points of f. We shall show that f(C) has measure zero in Rn. If m = 0, then Rm is one
point and the theorem is trivially true. Suppose inductively the theorem holds for m −1.
Let
Ci = { x ∈U | Djf(x) = 0 for j = 1, . . . , i },
and write C as the following union of disjoint sets:
C = (C\C1) ∪(C1\C2) ∪· · · ∪(Ck−1\Ck) ∪Ck.
The proof that f(C) has measure zero is divided in three steps.
1. f(Ck) has measure zero.
2. f(C\C1) has measure zero.
3. f(Cs\Cs+1) has measure zero, where 1 ≤s ≤k −1.

194
3. Manifolds and Vector Bundles
Proof of Step 1.
Since k ≥1, kn ≥n + k −1. But k ≥m −n + 1, so that kn ≥m.
Let K ⊂U be a closed cube with edges parallel to the coordinate axes. We will show that f(Ck ∩K)
has measure zero. Since Ck can be covered by countably many such cubes, this will prove that f(Ck) has
measure zero. By Taylor’s theorem, the compactness of K, and the deﬁnition of Ck, we have
f(y) = f(x) + R(x, y)
where ∥R(x, y)∥≤M∥y −x∥k+1
(3.6.1)
for x ∈Ck ∩K and y ∈K. Here M is a constant depending only on Dkf and K. Let e be the edge
length of K. Choose an integer ℓ, subdivide K into ℓm cubes with edge e/ℓ, and choose any cube K′ of this
subdivision which intersects Ck. For x ∈Ck ∩K′ and y ∈K′, we have ∥x −y∥≤√m(e/ℓ). By equation
(3.6.1), f(K′) ⊂L where L is the cube of edge Nℓk−1 with center f(x); N = 2M((m)1/2ℓ)k+1. The volume
of L is N nℓ−n(k+1). There are at most ℓm such cubes; hence, f(Ck ∩K) is contained in a union of cubes
whose total volume V satisﬁes
V ≤N nℓm−n(k+1).
Since m ≤kn, m −n(k + 1) < 0, so V →0 as ℓ→∞, and thus f(Ck ∩K) has measure zero.
Proof of Step 2.
Write
C\C1 = { x ∈U | 1 ≤rank Df(x) < n } = K1 ∪· · · ∪Kn−1,
where
Kq = { x ∈U | rank Df(x) = q }
and it suﬃces to show that f(Kq) has measure zero for q = 1, . . . , n −1. Since Kq is empty for q > m, we
may assume q ≤m. As before it will suﬃce to show that each point Kq has a neighborhood V such that
f(V ∩Kq) has measure zero.
Choose x0 ∈Kq. By the local representation theorem 2.5.14 we may assume that x0 has a neighborhood
V = V1 × V2, where V1 ⊂Rq and V2 ⊂Rm−q are open balls, such that for t ∈V1 and x ∈V2, f(t, x) =
(t, η(t, x)). Hence η : V1 × V2 →Rn−q is a Ck map. For t ∈V1 deﬁne ηt : V2 →Rn−q by ηt(x) = η(t, x) for
x ∈V2. Then for every t ∈V1,
Kq ∩({t} × V2) = {t} × { x ∈V2 | Dηt(x) = 0 }.
This is because, for (t, x) ∈V1 × V2, Df(t, x) is given by the matrix
Df(t, x) =

Iq
0
∗
Dηt(x)

.
Hence rank Df(t, x) = q iﬀDηt(x) = 0.
Now ηt is Ck and k ≥m−n = (m−q)−(n−q). Since q ≥1, by induction we ﬁnd that the critical values
of ηt, and in particular ηt({ x ∈V2 | Dηt(x) = 0 }), has measure zero for each t ∈V2. By Fubini’s lemma,
f(Kq ∩V ) has measure zero. Since Kq is covered by countably many such V , this shows that f(Kq) has
measure zero.
Proof of Step 3.
To show f(Cs\Cs+1) has measure zero, it suﬃces to show that every x ∈Cs\Cs+1 has
a neighborhood V such that f(Cs ∩V ) has measure zero; then since Cs\Cs+1 is covered by countably many
such neighborhoods V , it follows that f(Cs\Cs+1) has measure zero.
Choose x0 ∈Cs\Cs+1. All the partial derivatives of f at x0 of order less than or equal to s are zero, but
some partial derivative of order s + 1 is not zero. Hence we may assume that D1w(x0) ̸= 0 and w(x0) = 0,
where D1 is the partial derivative with respect to x1 and that w has the form
w(x) = Di(1) · · · Di(s)f(x).

3.6 The Sard and Smale Theorems
195
Deﬁne h : U →Rm by
h(x) = (w(x), x2, . . . , xm),
where x = (x1, x2, . . . , xm) ∈U ⊂Rm. Clearly h is Ck−s and Dh(x0) is nonsingular; hence there is an
open neighborhood V of x0 and an open set W ⊂Rm such that h : V →W is a Ck−s diﬀeomorphism. Let
A = Cs ∩V , A′ = h(A) and g = h−1. We would like to consider the function f ◦g and then arrange things
such that we can apply the inductive hypothesis to it. If k = ∞, there is no trouble. But if k < ∞, then f ◦g
is only Ck−s and the inductive hypothesis would not apply anymore. However, all we are really interested in
is that some Ck function F : W →Rn exists such that F(x) = (f ◦g)(x) for all x ∈A′ and DF(x) = 0 for
all x ∈A′. The existence of such a function is guaranteed by the Kneser–Glaeser rough composition theorem
(Abraham and Robbin [1967]). For k = ∞, we take F = f ◦g. In any case, deﬁne the open set W0 ⊂Rm−1
by
W0 = { (x2, . . . , xm) ∈Rm−1 | (0, x2, . . . , xn) ∈W }
and F0 : W0 →Rm by
F0(x2, . . . , xm) = F(0, x2, . . . , xm)
Let S = { (x2, . . . , xm) ∈W0 | DF0(x2, . . . , xm) = 0 }.
By the induction hypothesis, F0(S) has measure zero. But A′ = h(Cs ∩V ) ⊂0 × S since for x ∈A′,
DF(x) = 0 and since for x ∈Cs ∩V ,
h(x) = (w(x), x2, . . . , xm) = (0, x2, . . . , xm)
because w is an sth derivative of f. Hence
f(Cs ∩V ) = F(h(Cs ∩V )) ⊂F(0 × S) = F0(S),
and so f(Cs ∩V ) has measure zero. As Cs\Cs+1 is covered by countably many such V , the sets f(Cs\Cs+1)
have measure zero (s = 1, . . . , k −1).
■
The smoothness assumption k ≥1 + max(0, m −n) cannot be weakened as the following counterexample
shows.
3.6.4 Example (Devil’s Staircase Phenomenon).
The Cantor set C is deﬁned by the following construc-
tion. Remove the open interval ]−1/3, 2/3[ from the closed interval [0, 1]. Then remove the middle thirds
]1/9, 2/9[ and ]7/9, 8/9[ from the closed intervals [0, 1/3] and [2/3, 1] respectively and continue this process
of removing the middle third of each remaining closed interval indeﬁnitely. The set C is the remaining set.
Since we have removed a (countable) union of open intervals, C is closed. The total length of the removed
intervals equals (1/3) 
n≥0(2/3)n = 1 and thus C has measure zero in [0, 1]. On the other hand each point
of C is approached arbitrarily closely by a sequence of endpoints of the intervals removed, that is, each
point of C is an accumulation point of [0, 1]\C. Each open subinterval of [0, 1] has points in common with at
least one of the deleted intervals which means that the union of all these deleted intervals is dense in [0, 1].
Therefore C is nowhere dense. Expand each number x in [0, 1] in a ternary expansion 0.a1a2 . . . that is,
x = 
n≥0 3−nan, where an = 0, 1, or 2. Then it is easy to see that C consists of all numbers whose ternary
expansion involves only 0 and 2. (The number 1 equals 0.222 . . . .) Thus C is in bijective correspondence
with all sequences valued in a two-point set, that is, the cardinality of C is that of the continuum; that is,
C is uncountable.
We shall construct a C1 function f : R2 →R which is not C2 and which contains [0, 2] among its
critical values. Since the measure of this set equals 2, this contradicts the conclusion of Sard’s theorem.
Note, however, that there is no contradiction with the statement of Sard’s theorem since f is only C1. We
start the construction by noting that the set C + C = { x + y | x, y ∈C } equals [0, 2]. The reader can

196
3. Manifolds and Vector Bundles
easily be convinced of this fact by expanding every number in [0, 2] in a ternary expansion and solving
the resulting undetermined system of inﬁnitely many equations. (The number 2 equals 1.222 . . . .) Assume
that we have constructed a C1-function g : R →R which contains C among its critical values. The function
f(x, y) = g(x)+g(y) is C1, and if c1, c2 ∈C, then there are critical points x1, x2 ∈[0, 1] such that g(xi) = ci,
i = 1, 2; that is, (x1, x2) is a critical point of f and its critical value is c1 + c2. Since C + C = [0, 2], the set
of critical values of f contains [0, 2].
We proceed to the construction of a function g : R →R containing C in its set of critical points. At the
kth step in the construction of C, we delete 2k−1 open intervals, each of length 3−k. On these 2k−1 intervals,
construct (smooth) congruent bump functions of height 2−k and area = (const.) 2−k3−k (Figure 3.6.1).
0
1
1/9
1/9
1/4
1/4
k = 2
Figure 3.6.1. The construction of congruent bump functions
These deﬁne a smooth function hk; let gk(x) be the integral from −∞to x of hk, so g′
k = hk and gk is
smooth. At each endpoint of the intervals, hk vanishes, that is, the ﬁnite set of endpoints occurring in the
k-th step of the construction of C is among the critical points of gk. It is easy to see that h = 
k≥1 hk is
a uniformly convergent Cauchy series and that g = 
k≥1 gk is pointwise Cauchy; note that gk is monotone
and
gk(1) −gk(0) = (const. ) 3−k.
Therefore, g deﬁnes a C1 function with g′ = h. The reader can convince themselves that h has arbitrarily
steep slopes so that g is not C2. The above example was given by Grinberg [1985]. Other examples of this
sort are due to Whitney [1935] and Kaufman [1979].
We proceed to the global version of Sard’s theorem on ﬁnite-dimensional manifolds. Recall that a subset of
a topological space is residual if it is the intersection of countably many open dense sets. The Baire category
theorem 1.7.3 asserts that a residual subset of a a locally compact space or of a complete pseudometric
space is dense. A topological space is called Lindel¨of if every open covering has a countable subcovering.
In particular, second countable topological spaces are Lindel¨of. (See Lemma 1.1.6.)
3.6.5 Theorem (Sard’s Theorem for Manifolds).
Let M and N be ﬁnite-dimensional Ck manifolds, dim(M) =
m, dim(N) = n, and f : M →N a Ck mapping, k ≥1. Assume M is Lindel¨of and k > max(0, m −n).
Then Rf is residual and hence dense in N.
Proof.
Denote by C the set of critical points of f. We will show that every x ∈M has a neighborhood Z
such that Rf| cl(Z) is open and dense. Then, since M is Lindel¨of we can ﬁnd a countable cover {Zi} of X
with Rf| cl(Zi) open and dense. Since Rf = 
i Rf| cl(Zi), it will follow that Rf is residual.
Choose x ∈M. We want a neighborhood Z of x with Rf| cl(Z) open and dense. By taking local charts
we may assume that M is an open subset of Rm and N = Rn. Choose an open neighborhood Z of x such
that cl(Z) is compact. Then
C = { x ∈M | rank Df(x) < n }
is closed, so cl(Z) ∩C is compact, and hence f(cl(Z) ∩C) is compact. But f(cl(Z) ∩C) is a subset of the
set of critical values of f and hence, by Sard’s theorem in Rn, has measure zero. A closed set of measure
zero is nowhere dense; hence Rf| cl(Z) = Rn\f(cl(Z) ∩C) is open and dense.
■

3.6 The Sard and Smale Theorems
197
We leave it to the reader to show that the concept of measure zero makes sense on an n-manifold and to
deduce that the set of critical values of f has measure zero in N.
Inﬁnite Dimensional Case.
To consider the inﬁnite-dimensional version of Sard’s theorem, we ﬁrst
analyze the regular points of a map.
3.6.6 Lemma.
The set SL(E, F) of linear continuous split surjective maps is open in L(E, F).
Proof.
Choose A ∈SL(E, F), write E = F ⊕K where K is the kernel of A, and deﬁne A′ : E →F × K
by A′(e) = (A(e), p(e)) where p : E = F ⊕K →K is the projection. By the closed graph theorem, p is
continuous; hence A′ ∈GL(E, F × K). Consider the map T : L(E, F × K) →L(E, F) given by
T(B) = π ◦B ∈L(E, F × K),
where π : F × K →F is the projection. Then T is linear, continuous (∥π ◦B∥≤∥π∥∥B∥), and surjective;
hence, by the open mapping theorem, T is an open mapping. Since GL(E, F × K) is open in L(E, F × K), it
follows that T(GL(E, F × K)) is open in L(E, F). But A = T(A′) and T(GL(E, F × K)) ⊂SL(E, F). This
shows that SL(E, F) is open.
■
3.6.7 Proposition.
Let f : M →N be a C1 mapping of manifolds. Then the set of regular points is open
in M. Consequently the set of critical points of f is closed in M.
Proof.
It suﬃces to prove the proposition locally. Thus, if E, F are the model spaces for M and N,
respectively, and x ∈U ⊂E is a regular point of f, then Df(x) ∈SL(E, F). Since Df : U →L(E, F) is
continuous, (Df)−1(SL(E, F)) is open in U by Lemma 3.6.6.
■
3.6.8 Corollary.
Let f : M →N be C1 and P a submanifold of N. The set { m ∈M | f is transversal to
P at m } is open in M.
Proof.
Assume f is transversal to P at m ∈M. Choose a submanifold chart (V, ϕ) at f(m) ∈P,
ϕ : V →F1 × F2, ϕ(V ∩P) = F1 × {0}. Hence if π : F1 × F2 →F2 is the canonical projection, V ∩P =
ϕ−1(F1 × {0}) = (π ◦ϕ)−1{0}. Clearly, π ◦ϕ : V ∩P →F2 is a submersion so that by Theorem 3.5.4,
ker Tf(m)(π ◦ϕ) = Tf(m)P. Thus f is transversal to P at the point f(m) iﬀ
Tf(p)N = ker Tf(m)(π ◦ϕ) + Tf(p)P
and
(Tmf)−1(Tf(m)P) = ker Tm(π ◦ϕ ◦f)
splits in TmM. Since ϕ ◦π is a submersion this is equivalent to π ◦ϕ ◦f being submersive at m ∈M (see
Exercise 2.2-5). From Proposition 3.6.7, the set where π ◦ϕ ◦f is submersive is open in U, hence in M,
where U is a chart domain such that f(U) ⊂V .
■
3.6.9 Example.
If M and N are Banach manifolds, the Sard theorem is false without further assumptions.
The following counterexample is, so far as we know, due to Bonic, Douady, and Kupka. Let
E = { x = (x1, x2, . . . ) | xi ∈R, ∥x∥2 =

j≥1
xj
j
2
< ∞},
which is a Hilbert space with respect to the usual algebraic operations on components and the inner product
⟨x, y⟩= 
j≥1 xjyj/j2. Consider the map f : E →R given by
f(x) =

j≥1
−2x3
j + 3x2
j
2j
,

198
3. Manifolds and Vector Bundles
which is deﬁned since x ∈E implies |xi| < c for some c > 0 and thus

−2x3
j + 3x2
j
2j
 ≤2c3j3 + 3c2j2
2j
< c′j3
2j ;
that is, the series f(x) is majorized by the convergent series c′ 
j≥1 j3/2j. We have
Df(x) · v =

j≥1
6(−x2
j + xj)vj
2j
;
that is, f is C1. In fact f is C∞. Moreover, Df(x) = 0 iﬀall coeﬃcients of vj are zero, that is, iﬀxj = 0 or
xj = 1. Hence the set of critical points is { x ∈E | xj = 0 or 1 } so that the set of critical values is
{ f(x) | xj = 0 or xj = 1 } =



∞

j=1
xj
sj

xj = 0 or xj = 1


= [0, 1].
But clearly [0, 1] has measure one.
♦
Sard’s theorem holds, however, if enough restrictions are imposed on f. The generalization we consider is
due to Smale [1965]. The class of linear maps allowed are Fredholm operators which have splitting properties
similar to those in the Fredholm alternative theorem.
3.6.10 Deﬁnition.
Let E and F be Banach spaces and A ∈L(E, F). Then A is called a Fredholm
operator if :
(i) A is double splitting; that is, both the kernel and the image of A are closed and have closed complement;
(ii) the kernel of A is ﬁnite dimensional;
(iii) the range of A has ﬁnite codimension.
In this case, if n = dim(ker A) and p = codim(range (A)), index (A) := n −p is the index of A. If M and
N are C1 manifolds and f : M →N is a C1 map, we say f is a Fredholm map if for every x ∈M, Txf
is a Fredholm operator.
Condition (i) follows from (ii) and (iii); see Exercises 2.2-8 and 2.2-14. A map g between topological spaces
is called locally closed if every point in the domain of deﬁnition of g has an open neighborhood U such
that g| cl (U) is a closed map (i.e., maps closed sets to closed sets).
3.6.11 Lemma.
A Fredholm map is locally closed.
Proof.
By the local representative theorem we may suppose our Fredholm map has the form f(e, x) =
(e, η(e, x)), for e ∈D1, and x ∈D2, where f : D1 × D2 →E × Rp and D1 ⊂E, D2 ⊂Rn are open
unit balls. Let U1 and U2 be open balls with cl(U1) ⊂D1 and cl(U2) ⊂D2. Let U = U1 × U2 so that
cl(U) = cl(U1) × cl(U2). Then f| cl(U) is closed. To see this, suppose A ⊂cl(U) is closed; to show f(A) is
closed, choose a sequence {(ei, yi)} such that (ei, yi) →(e, y) as i →∞and (ei, yi) ∈f(A), say (ei, yi) =
f(ei, xi), where (ei, xi) ∈A. Since xi ∈cl(U2) and cl(U2) is compact, we may assume xi →x ∈cl(U2). Then
(ei, xi) →(e, x). Since A is closed, (e, x) ∈A, and f(e, x) = (e, y), so (e, y) ∈f(A). Thus f(A) is closed.
■
3.6.12 Theorem (The Smale–Sard Theorem).
Let M and N be Ck manifolds with M Lindel¨of and as-
sume that f : M →N is a Ck Fredholm map, k ≥1. Suppose that k > index (Txf) for every x ∈M. Then
Rf is a residual subset of N.

3.6 The Sard and Smale Theorems
199
Proof.
It suﬃces to show that every x0 ∈M has a neighborhood Z such that R(f|Z) is open and dense
in N.
Choose z ∈M. We shall construct a neighborhood Z of z so that R(f|Z) is open and dense. By the
local representation theorem we may choose charts (U, α) at z and (V, β) at f(z) such that α(U) ⊂E × Rn,
β(V ) ⊂E × Rp and the local representative fαβ = β ◦f ◦α−1 of f has the form fαβ(e, x) = (e, η(e, x)) for
(e, x) ∈α(U). (Here x ∈Rn, e ∈E, and η : α(U) →Rp.) The index of Tzf is n −p and so k > max(0, n −p)
by hypothesis.
We now show that R(f|U) is dense in N. Indeed it suﬃces to show that R(fαβ) is dense in E × Rp. For
e ∈E, (e, x) ∈α(U), deﬁne ηe(x) = η(e, x). Then for each e, ηe is a Ck map deﬁned on an open set of Rn.
By Sard’s theorem, R(ηe) is dense in Rn for each e ∈E. But for (e, x) ∈α(U) ⊂E × Rn, we have
Dfαβ(e, x) =

I
0
∗
Dηe(x)

so Dfαβ(e, x) is surjective iﬀDηe(x) is surjective. Thus for e ∈E
{e} × R(ηe) = R(fαβ) ∩({e} × Rp)
and so R(fαβ) intersects every plane {e} × Rp in a dense set and is, therefore, dense in E × Rp, by Lemma
3.6.2. Thus R(f|U) is dense as claimed.
By Lemma 3.6.11 we can choose an open neighborhood Z of z such that cl(Z) ⊂U and f| cl(Z) is closed.
By Proposition 3.6.7 the set C of critical points of f is closed in M. Hence, f(cl(Z) ∩C) is closed in N and
so R(f| cl(Z)) = N\f(cl(Z) ∩C) is open in N. Since R(f|U) ⊂R(f| cl(Z)), this latter set is also dense.
We have shown that every point z ∈N has an open neighborhood Z such that R(f| cl(Z)) is open
and dense in N. Repeating the argument of Theorem 3.6.5 shows that Rf is residual (recall that M is
Lindel¨of).
■
Sard’s theorem deals with the genericity of the surjectivity of the derivative of a map. We now address
the dual question of genericity of the injectivity of the derivative of a map.
3.6.13 Lemma.
The set IL(E, F) of linear continuous split injective maps is open in L(E, F).
Proof.
Let A ∈IL(E, F). Then A(E) is closed and F = A(E) ⊕G for G a closed subspace of F. The map
Γ : E × G →F; deﬁned by Γ(e, g) = A(e) + g is clearly linear, bijective, and continuous, so by Banach’s
isomorphism theorem Γ ∈GL(E × G, F). The map P : L(E × G, F) →L(E, F) given by P(B) = B|E
is linear, continuous, and onto, so by the open mapping theorem it is also open. Moreover P(Γ) = A and
P(GL(E × G, F)) ⊂IL(E, F) for if B ∈GL(E × G, F) then F = B(E) ⊕B(G) where both B(E) and B(G)
are closed in F. Thus A has an open neighborhood P(GL(E × G, F)) contained in IL(E, F).
■
3.6.14 Proposition.
Let f : M →N be a C1-map of manifolds. The set
P = { x ∈M | f is an immersion at x }
is open in M.
Proof.
It suﬃces to prove the proposition locally. If E and F are the models of M and N respectively and
if f : U →E is immersive at x ∈U ⊂E, then Df(x) ∈IL(E, F). By Lemma 3.6.13, (Df)−1(IL(E, F)) is
open in U since Df : U →L(E, F) is continuous.
■
The analog of the openness statements in Propositions 3.6.7 and 3.6.14 for subimmersions follows from
Deﬁnition 3.5.15. Indeed, if f : M →N is a C1 map which is a subimmersion at x ∈M, then there is an
open neighborhood U of x, a manifold P, a submersion s : U →P, and an immersion j : P →N such that
f|U = j ◦s. But this says that f is subimmersive at every point of U. Thus we have the following.

200
3. Manifolds and Vector Bundles
3.6.15 Proposition.
Let f : M →N be a C1-map of manifolds. Then the set
P = { x ∈M | f is a subimmersion at x }
is open in M.
If M or N are ﬁnite dimensional then P = { x ∈M | rank Txf is locally constant } by Proposition 3.5.16.
Lower semicontinuity of the rank (i.e., each point x ∈M admits an open neighborhood of U such that
rank Tyf ≥rank Txf for all y ∈U; see Exercise 2.5-9(i)) implies that P is dense. Indeed, if V is any open
subset of M, by lower semicontinuity { x ∈V | rank Txf is maximal } is open in V and obviously contained
in P. Thus we have proved the following.
3.6.16 Proposition.
Let f : M →N be a C1-map of manifolds where at least one of M or N are ﬁnite
dimensional. Then the set
P = { x ∈M | f is a subimmersion at x }
is dense in M.
3.6.17 Corollary.
Let f : M →N be a C1 injective map of manifolds and let dim(M) = m. Then the set
P = { x ∈M | f is immersive at x } is open and dense in M. In particular, if dim(N) = n, then m ≤n.
Proof.
By Propositions 3.6.15 and 3.6.16, it suﬃces to show that if f : M →N is a C1-injective map
which is subimmersive at x, then it is immersive at x. Indeed, if f|U = j◦s where U is an open neighborhood
of x on which j is injective, then the submersion s must also be injective. Since submersions are locally onto,
this implies that s is a diﬀeomorphism in a neighborhood of x, that is, f restricted to a suﬃciently small
neighborhood of x is an immersion.
■
There is a second proof of this corollary that is independent of Proposition 3.6.16. It relies ultimately on
the existence and uniqueness of integral curves of C1 vector ﬁelds. This material will be treated in Chapter
4, but we include this proof here for completeness.
Alternative Proof of Corollary 3.6.17.
(D. Burghelea.) It suﬃces to work in a local chart V . We shall
use induction on k to show that
cl(Ui(1),...,i(k)) ⊃V,
where Ui(1),...,i(k) is the set of x ∈V such that
Txf

∂
∂xi(1)

, . . . , Txf

∂
∂xi(k)

are linearly independent.
The case k = n gives then the statement of the theorem. Note that by the preceding proposition Ui(1),...,i(k)
is open in V .
The statement is obvious for k = 1 since if it fails Txf would vanish on an open subset of V and thus
f would be constant on V , contradicting the injectivity of f. Assume inductively that the statement for k
holds; that is, Ui(1),...,i(k) is open in V and cl(Ui(1),...,i(k)) ⊃V . Deﬁne
U ′
i(k+1) =

x ∈Ui(1),...,i(k)
 Txf

∂
∂xi(k+1)

̸= 0

and notice that it is open in Ui(1),...,i(k) and thus in V . It is also dense in Ui(1),...,i(k) (by the case k = 1) and
hence in V by induction. Deﬁne the following subset of Ui(1),...,i(k+1)
U ′
i(1),...,i(k+1) =

x ∈U ′
i(k+1)
 Txf

∂
∂xi(1)

, . . . , Txf

∂
∂xi(k+1)

are linearly independent } .

3.6 The Sard and Smale Theorems
201
We prove that U ′
i(1),...,i(k+1) is dense in U ′
i(k+1), which then shows that cl(Ui(1),...,i(k+1)) ⊃V . If this were
not the case, there would exist an open set W ⊂U ′
i(k+1) such that
a1(x)Txf

∂
∂xi(1)

+ · · · + ak(x)Txf

∂
∂xi(k)

+ Txf

∂
∂xi(k+1)

= 0
for some C1-functions a1, . . . , ak nowhere zero on W. Let c : ]−ε, ε[ →W be an integral curve of the vector
ﬁeld
a1
∂
∂xi(1) + · · · + ak
∂
∂xi(k) +
∂
∂xi(k+1) .
Then (f ◦c)′(t) = Tc(t)f(c′(t)) = 0, so f ◦c is constant on ]−ε, ε[ contradicting injectivity of f.
■
There is no analogous result for surjective maps known to us; an example of a surjective function R →R
which has zero derivative on an open set is given in Figure 3.6.2. However surjectivity of f can be replaced
by a topological condition which then yields a result similar to the one in Corollary 3.6.17.
0
x
y
Figure 3.6.2. A surjective function with a zero derivative on an open set
3.6.18 Corollary.
Let f : M →N be a C1-map of manifolds where dim(N) = n. If f is an open map,
then the set { x ∈M | f is a submersion at x } is dense in M. In particular, if dim(M) = m, then m ≥n.
Proof.
It suﬃces to prove that if f is a C1-open map which is subimmersive at x, then it is submersive
at x. This follows from the relation f|U = j ◦s and the openness of f and s, for then j is necessarily open
and hence a diﬀeomorphism by Theorem 3.5.7(iii).
■
Supplement 3.6A
An Application of Sard’s Theorem to Fluid Mechanics
The Navier–Stokes equations governing homogeneous incompressible ﬂow in a region Ωin R3 for a velocity
ﬁeld u are
∂u
∂t + (u · ∇)u −ν∆u = −∇p + f
in Ω
(3.6.2)
div u = 0
(3.6.3)

202
3. Manifolds and Vector Bundles
where u is parallel to ∂Ω(so ﬂuid does not escape) and
u = ϕ
on ∂Ω.
(3.6.4)
Here, f is a given external forcing function assumed divergence free, p is the pressure (unknown), ϕ is a
given boundary condition and ν is the viscosity. Stationary solutions are deﬁned by setting ∂u/∂t = 0.
Given f, ϕ and ν the set of possible stationary solutions u is denoted S(f, ϕ, ν). A theorem of Foias and
Temam [1977] states (amongst other things) that there is an open dense set O in the Banach space of all
(f, ϕ)’s such that S(f, ϕ, ν) is ﬁnite for each (f, ϕ) ∈O.
We refer the reader to the cited paper for the precise (Sobolev) spaces needed for f, ϕ, u, and rather give
the essential idea behind the proof. Let E be the space of possible u’s (of class H2, div u = 0 and u parallel
to ∂Ω), F the product of the space H of (L2) divergence free vector ﬁelds with the space of vector ﬁelds on
∂Ω(of class Hexc:3.2−27). We can rewrite the equation
(u · ∇)u −ν∆u = −∇p + f
(3.6.5)
as
νAu + B(u) = f
(3.6.6)
where Au = −PH∆u, PH being the orthogonal projection to H (this is a special instance of the Hodge
decomposition; see §7.5 for details) and B(u) = PH((u · ∇)u). The orthogonal projection operator really
encodes the pressure term. Eﬀectively, p is solved for by taking the divergence of (3.6.4) to give ∆p in terms
of u and the normal component of (3.6.4) gives the normal derivative of p. The resulting Neuman problem
is solved, thereby eliminating p from the problem. Deﬁne the map
Φν : E →F
by
Φν(u) = (νAu + B(u), u|∂Ω).
One shows that Φν is a C∞map by using the fact that A is a bounded linear operator and B is obtained
from a continuous bilinear operator; theorems about Sobolev spaces are also required here. Moreover, elliptic
theory shows that the derivative of Φν is a Fredholm operator, so Φν is a Fredholm map. In fact, from self
adjointness of A and DB(u), one sees that Φν has index zero.
The Sard–Smale theorem shows that the set of regular values of Φν forms a residual set Oν. It is easy to see
that Oν = O is independent of ν. Now since Φν has index zero, at a regular point, DΦν is an isomorphism,
so Φν is a local diﬀeomorphism. Thus we conclude that S(f, ϕ, ν) is discrete and that O is open (Foias and
Temam [1977] give a direct proof of openness of O rather than using the implicit function theorem). One
knows, also from elliptic theory that S(f, ϕ, ν) is compact, so being discrete, it is ﬁnite.
One can also prove a similar generic ﬁniteness result for an open dense set of boundaries ∂Ωusing a
transversality analogue of the Smale–Sard theorem (see Supplement 3.6B), as was pointed out by A. J.
Tromba. We leave the precise formulation as a project for the reader.
Supplement 3.6B
The Parametric Transversality Theorem
3.6.19 Theorem (Density of Transversal Intersection).
Let P, M, N be Ck manifolds, S ⊂N a subman-
ifold (not necessarily closed) and F : P × M →N a Ck map, k ≥1. Assume
(i)
M is ﬁnite dimensional (dim M = m) and that S has ﬁnite codimension q in N.

3.6 The Sard and Smale Theorems
203
(ii)
P × M is Lindel¨of.
(iii)
k > max(0, n −q).
(iv)
F ⋔S.
Then ⋔(F, S) := { p ∈P | Fp : M →N is transversal to S at all points of S } is residual in P.
The idea is this. Since F ⋔S, F −1(S) ⊂P × M is a submanifold. The projection π : F −1(S) →P has the
property that a value of π is a regular value iﬀFp is transverse to S. We then apply Sard’s theorem to π.
A main application is this: consider a family of perturbations f : ]−1, 1[ × M →N of a given map
f0 : M →N, where f(0, x) = f0(x). Suppose f ⋔S. Then there exist t’s arbitrarily close to zero such that
ft ⋔S; that is, slight perturbations of f0 are transversal to S.
For the proof we need two lemmas.
3.6.20 Lemma.
Let E and F be Banach spaces, dim F = n, pr1 : E × F →E the projection onto the ﬁrst
factor, and G ⊂E × F a closed subspace of codimension q. Denote by p the restriction of pr1 to G. Then p
is a Fredholm operator of index n −q.
Proof.
Let
H = G + ({0} × F)
and
K = G ∩({0} × F).
Since F is ﬁnite dimensional and G is closed, it follows that H is closed in E × F (see Exercise 2.2-
13(ii)). Moreover, H has ﬁnite codimension since it contains the ﬁnite-codimensional subspace G. Therefore
H is split (see Exercise 2.2-14) and thus there exists a ﬁnite-dimensional subspace S ⊂E × {0} such that
E×F = H⊕S. Since K ⊂F, choose closed subspaces G0 ⊂G and F0 ⊂{0}×F such that G = G0⊕K and
{0}×F = K⊕F0. Thus H = G0⊕K⊕F0 and E×F = G0⊕K⊕F0⊕S. Note that pr1|G0⊕S : G0⊕S →E is
an isomorphism, K = ker p, and pr1(S) is a ﬁnite-dimensional complement to p(G) in F. Thus p is a Fredholm
operator and its index equals dim(K) −dim(S) = dim(K ⊕F0) −dim(S ⊕F0). Since K ⊕F0 = {0} × F and
F0 ⊕S is a complement to G in E × F (having therefore dimension q by hypothesis), the index of p equals
n −q.
■
3.6.21 Lemma.
In the hypothesis of Theorem 3.6.19, let V = F −1(S). Let π′ : P × M →P be the
projection onto the ﬁrst factor and let π = π′|V . Then π is a Ck Fredholm map of constant index n −q.
Proof.
By Theorem 3.6.19(iv), V is a Ck submanifold of P × M so that π is a Ck map. The map
T(p,m)π : T(p,m)V →TpP is Fredholm of index n −q by Lemma 3.6.20: E is the model of P, F the model of
M, and G the model of V .
■
Proof of Theorem 3.6.19.
We shall prove below that p is a regular value of π if and only if Fp ⋔S. If
this is shown, since π : V →P is a Ck Fredholm map of index n −q by Lemma 3.6.21, the codimension of
V in E × F equals the codimension of S in N which is q, k > max(0, n −q), and V is Lindel¨of as a closed
subspace of the Lindel¨of space P × M, the Smale–Sard theorem 3.6.12 implies that ⋔(F, S) is residual in
P.
By deﬁnition, (iv) is equivalent to the following statement:
(a)
For every (p, m) ∈P × M satisfying F(p, m) ∈S, T(m,p)F(TpP × TmM) + TF (p,m)S = TF (p,m)N and
(T(m,p)F)−1(TF (p,m)S) splits in TpP × TmM.
Since M is ﬁnite dimensional, the map m ∈M →F(p, m) ∈N for ﬁxed p ∈P is transversal to S if and
only if
(b)
for every m ∈M satisfying F(p, m) ∈S, TmFp(TmM) + TF (p,m)S = TF (p,m)S.
Since π is a Fredholm map, the kernel of Tπ at any point splits being ﬁnite dimensional (see Exercise 2.2-14).
Therefore p is a regular value of π if and only if

204
3. Manifolds and Vector Bundles
(c)
for every m ∈M satisfying F(p, m) ∈S and every v ∈TpP, there exists u ∈TmM such that
T(m,p)F(v, u) ∈TF (p,m)S.
We prove the equivalence of (b) and (c). First assume (c), take m ∈M, p ∈P such that F(p, m) ∈S and
let w ∈TF (p,m)S. By (a) there exists v ∈TpP, u1 ∈TmM, z ∈TF (p,m)S such that T(m,p)F(v, u1) + z = w.
By (c) there exists u2 ∈TmM such that T(m,p)F(v, u2) ∈TF (p,m)S. Therefore,
w = T(m,p)F(v, u1) −T(m,p)F(v, u2) + T(m,p)F(v, u2) + z
= T(m,p)F(0, u1 −u2) + T(m,p)F(v, u2) + z
= T(m,p)F(0, u) + z′ ∈TmFp(TmM) + TF (p,m)S,
where u = u1 −u2 and z′ = T(m,p)F(v, u2) + z ∈TF (p,m)S. Thus (b) holds.
Conversely, let (b) hold, take p ∈P, m ∈M such that F(p, m) ∈S and let v ∈TpP. Pick u1 ∈TmM,
z1 ∈TF (p,m)S and deﬁne w = T(m,p)F(v, u1) + z1. By (b), there exist u2 ∈TmM and z2 ∈TF (p,m)S such
that w = TmFp(u2) + z2. Subtract these two relations to get
0 = T(m,p)F(v, u1) −TmFp(u2) + z1 −z2 = T(m,p)F(v, u1 −u2) + z1 −z2,
that is, T(m,p)F(v, u1 −u2) = z2 −z1 ∈TF (m,p)S and therefore (c) holds.
■
There are many other very useful theorems about genericity of transversal intersection. We refer the reader
to Golubitsky and Guillemin [1974] and Hirsch [1976] for the ﬁnite dimensional results and to Abraham and
Robbin [1967] for the inﬁnite dimensional case and the situation when P is a manifold of maps.
Exercises
⋄3.6-1.
Construct a C∞function f : R →R whose set of critical points equals [0, 1]. This shows that the
set of regular points is not dense in general.
⋄3.6-2.
Construct a C∞function f : R →R which has each rational number as a critical value.
Hint: Since Q is countable, write it as a sequence { qn | n = 0, 1, . . . }. Construct on the closed interval
[n, n + 1] a C∞function which is zero near n and n + 1 and equal to qn on an open interval. Deﬁne f to
equal fn on [n, n + 1].
⋄3.6-3.
Show that if m < n there is no C1 map of an open set of Rm onto an open set of Rn.
⋄3.6-4.
A manifold M is called Ck-simply connected, if it is connected and if every Ck map f : S1 →M
is Ck-homotopic to a constant, that is, there exist a Ck-map H : ]−ε, 1 + ε[ × S1 →M such that for all
s ∈S1, H(0, s) = f(s) and H(1, s) = m0, where m0 ∈M.
(i)
Show that the sphere Sn, n ≥2, is Ck-simply connected for any k ≥1.
Hint: By Sard, there exists a point x ∈Sn\f(S1). Then use the stereographic projection deﬁned by
x.
(ii)
Show that Sn, n ≥2, is C0-simply connected.
Hint: Approximate the continuous map g : S1 →Sn by a C1-map f : S1 →Sn. Show that one can
choose f to be homotopic to g.
(iii)
Show that S1 is not simply connected.
⋄3.6-5.
Let M and N be submanifolds of Rn. Show that the set { x ∈Rn | M intersects N +x transversally }
is dense in Rn. Find an example when it is not open.

3.6 The Sard and Smale Theorems
205
⋄3.6-6.
Let f : Rn →R be C2 and consider for each a ∈Rn the map fa(x) = f(x) + a · x. Prove that the
set
{ a ∈Rn | the matrix [∂2fa(x0)/∂xi∂xj] is nonsingular
for every critical point x0 of fa }
is a dense set in Rn which is a countable intersection of open sets.
Hint: Use Supplement 3.6B; when is the map (a, x) →∇f(x) + a transversal to {0}?
⋄3.6-7.
Let M be a C2 manifold and f : M →R a C2 map. A critical point m0 of f is called non-
degenerate, if in a local chart (U, ϕ) at m0, ϕ(m0) = 0, ϕ : U →E, the bilinear continuous map D2(f ◦
ϕ)−1(0) : E × E →R is strongly non-degenerate, that is, it induces an isomorphism of E with E∗.
(i)
Show that the notion of non-degeneracy is chart independent. Functions all of whose critical points
are nondegenerate are called Morse functions.
(ii)
Assume M is a C2 submanifold of Rn and f : M →R is a C2 function. For a ∈Rn deﬁne fa : M →R
by fa(x) = f(x) + a · x. Show that the set { a ∈Rn | fa is a Morse function } is a dense subset of Rn
which is a countable intersection of open sets. Show that if M is compact, this set is open in Rn.
Hint: Show ﬁrst that if dim M = m and (x1, . . . , xn) are the coordinates of a point x ∈M in Rn,
there is a neighborhood of x in Rn such that m of these coordinates deﬁne a chart on M. Cover
M with countably many such neighborhoods. In such a neighborhood U, consider the function g :
U ⊂Rn →R deﬁned by g(x) = f(x) + am+1xm+1 + · · · + anxn. Apply Exercise 3.6-6 to the map
f ′
a(x) = g(x) + a1x1 + · · · + amxm, a′ = (a1, . . . , am) and look at the set S = { a ∈Rn | fa is not
Morse on U }. Consider S ∩(Rm × {am+1, . . . , an}) and apply Lemma 3.6.2.
(iii)
Assume M is a C2-submanifold of Rn. Show that there is a linear map α : Rn →R such that α|M is
a Morse function.
(iv)
Show that the “height functions” on Sn and Tn are Morse functions.
⋄3.6-8.
Let E and F be Banach spaces. A linear map T : E →F is called compact if it maps bounded sets
into relatively compact sets.
(i)
Show that a compact map is continuous.
(ii)
Show that the set K(E, F) of compact linear operators from E to F is a closed subspace of L(E, F).
(iii)
If G is another Banach space, show that L(F, G)◦K(E, F) ⊂K(E, G), and that K(E, F)◦L(G, E) ⊂
K(G, F).
(iv)
Show that if T ∈K(E, F), then T ∗∈K(F∗, E∗).
⋄3.6-9 (F. Riesz).
Show that if K ∈K(E, F) where E and F are Banach spaces and a is a scalar (real or
complex), then T = Identity +aK is a Fredholm operator.
Hint: It suﬃces to prove the result for a = −1. Show ker T is a locally compact space by proving that
K(D) = D, where D is the open unit ball in ker T. To prove that T(E) is closed and ﬁnite dimensional show
that
dim(E/T(E)) = dim(E/T(E))∗= dim(ker T ∗)
= dim(ker(Identity −K∗)) < ∞
and use Exercise 2.2-8.

206
3. Manifolds and Vector Bundles
⋄3.6-10.
Show that there exist Fredholm operators of any index.
Hint: Consider the shifts
(x1, x2, . . . ) →(0, . . . , 0, x1, x2)
and
(x1, x2 . . . ) →(xn, xn+1, . . . )
in ℓ2(R).
⋄3.6-11.
Show that if T ∈L(E, F) is a Fredholm operator, then T ∗∈L(F∗, E∗) is a Fredholm operator
and index (T ∗) = −index(T).
⋄3.6-12.
(i)
Let E, F, G be Banach spaces and T ∈L(E, F). Assume that there are S, S′ ∈L(F, E) such
that S ◦T−Identity ∈K(E, E) and T ◦S′−Identity ∈K(F, F). Show that T is Fredholm.
Hint: Use Exercise 3.6-9.
(ii)
Use (i) to prove that T ∈L(E, F) is Fredholm if and only if there exists an operator S ∈L(F, E) such
that (S ◦T−Identity) and (T ◦S−Identity) have ﬁnite dimensional range.
Hint: If T is Fredholm, write E = ker T ⊕F0, F = T(E) ⊕F0 and show that T0 = T|E0 : E0 →T(E)
is a Banach space isomorphism. Deﬁne S ∈L(F, E) by S|T(E) = T −1
0
, S|F0 = 0.
(iii)
Show that if T ∈L(E, F), K ∈K(E, F) then T + K is Fredholm.
(iv)
Show that if T ∈L(E, F), S ∈L(F, G) are Fredholm, then so is S ◦T and that index(S ◦T) =
index(S) + index(T).
⋄3.6-13.
Let E, F be Banach spaces.
(i)
Show that the set Fredq(E, F) = { T ∈L(E, F) | T is Fredholm, index(T) = q } is open in L(E, F).
Hint: Write E = ker T ⊕E0, F = T(E) ⊕F0 and deﬁne ˜T : E ⊕F0 →F ⊕ker T by ˜T(z ⊕x, y) =
(T(x) ⊕y, z), for x ∈E0, z ∈ker T, y ∈F0. Show that ˜T ∈GL(E ⊕F0, F ⊕ker T). Deﬁne ρ :
L(E ⊕F0, F ⊕ker T) →L(E, F) by ρ(S) = π ◦S ◦i, where π : F ⊕ker T →F is the projection and
i : e ∈E →(e, 0) ∈E ⊕F0 is the inclusion. Show that ρ is a continuous linear surjective map and
hence open. Prove
ρ(GL(E ⊕F0, F ⊕ker T) ⊂Fredq(E, F),
ρ( ˜T) = T.
(ii)
Conclude from (i) that the index map from Fred(E, F) to Z is constant on each connected component
of Fred(E, F) = { T ∈L(E, F) | T is Fredholm }. Show that if E = F = ℓ2(R) and T(t)(x1, x2, . . . ) =
(0, tx2, x3, . . . ) then index(T(t)) equals 1, but dim(ker(T(t))) and dim(ℓ2(R)/T(t)(ℓ2(R))) jump at
t = 0.
(iii)
(Homotopy invariance of the index.) Show that if ϕ : [0, 1] →Fred(E,
F) is continuous, then
index(ϕ(0)) = index(ϕ(1)).
Hint: Let
a = sup{ t ∈[0, 1] | s < t implies index(f(s)) = index(f(0)) }.
By (i) we can ﬁnd ε > 0 such that |b −a| < ε implies index(f(b)) = index(f(a)). Let b = a −ε/2 and
thus index(f(0)) = index(f(b)) = index(f(a)). Show by contradiction that a = 1.
(iv)
If T ∈Fred(E, F), K ∈K(E, F), show that index(T + K) = index(T).
Hint: T + K(E, F) is connected; use (ii).

3.6 The Sard and Smale Theorems
207
(v)
(The Fredholm alternative.) Let K ∈K(E, F) and a ̸= 0. Show that the equation K(e) = ae has only
the trivial solution iﬀfor any v ∈E, there exists u ∈E such that K(u) = au + v.
Hint: K −a(Identity) is injective iﬀ(1/a)K −(Identity) is injective. By (iv) this happens iﬀ(1/a)K −
(Identity) is onto.
⋄3.6-14.
Using Exercise 3.5-2, show that the map π : SL(Rm, Rk) × IL(Rk, Rn) →St(m, n; k), where
k ≤min(m, n), deﬁned by π(A, B) = B ◦A, is a smooth locally trivial ﬁber bundle with typical ﬁber
GL(Rk).
⋄3.6-15.
(i)
Let M and N be smooth ﬁnite-dimensional manifolds and let f : M →N be a C1 bijective
immersion. Show that f is a C1 diﬀeomorphism.
Hint: If dim M < dim N, then f(M) has measure zero in N, so f could not be bijective.
(ii)
Formulate an inﬁnite-dimensional version of (i).

Page 209
4
Vector Fields and Dynamical Systems
This chapter studies vector ﬁelds and the dynamical systems they determine. The ensuing chapters will
study the related topics of tensors and diﬀerential forms. A basic operation introduced in this chapter is
the Lie derivative of a function or a vector ﬁeld. It is introduced in two diﬀerent ways, algebraically as a
type of directional derivative and dynamically as a rate of change along a ﬂow. The Lie derivative formula
asserts the equivalence of these two deﬁnitions. The Lie derivative is a basic operation used extensively in
diﬀerential geometry, general relativity, Hamiltonian mechanics, and continuum mechanics.
4.1
Vector Fields and Flows
This section introduces vector ﬁelds and the ﬂows they determine. This topic puts together and globalizes
two basic ideas we learn in undergraduate calculus: the study of vector ﬁelds on the one hand and diﬀerential
equations on the other.
4.1.1 Deﬁnition.
Let M be a manifold. A vector ﬁeld on M is a section of the tangent bundle TM of
M. The set of all Cr vector ﬁelds on M is denoted by Xr(M) and the C∞vector ﬁelds by X∞(M) or X(M).
Thus, a vector ﬁeld X on a manifold M is a mapping X : M →TM such that X(m) ∈TmM for all
m ∈M. In other words, a vector ﬁeld assigns to each point of M a vector based (i.e., bound) at that point.
4.1.2 Example.
Consider the force ﬁeld determined by Newton’s law of gravitation. Here the manifold is
R3 minus the origin and the vector ﬁeld is
F(x, y, x) = −mMG
r3
r,
where m is the mass of a test body, M is the mass of the central body, G is the constant of gravitation, r
is the vector from the origin to (x, y, z), and r = (x2 + y2 + z2)1/2; see Figure 4.1.1.
♦
The study of dynamical systems, also called ﬂows, may be motivated as follows. Consider a physical
system that is capable of assuming various “states” described by points in a set S. For example, S might
be R3 × R3 and a state might be the position and momentum (q, p) of a particle. As time passes, the state
evolves. If the state is s0 ∈S at time λ and this changes to s at a later time t, we set
Ft,λ(s0) = s

210
4. Vector Fields and Dynamical Systems
Figure 4.1.1. The gravitational vector ﬁeld
and call Ft,λ the evolution operator; it maps a state at time λ to what the state would be at time t; that
is, after time t −λ has elapsed. “Determinism” is expressed by the law
Fτ,t ◦Ft,λ = Fτ,λ,
Ft,t = identity,
sometimes called the Chapman–Kolmogorov law.
The evolution laws are called time independent when Ft,λ depends only on t −λ; that is,
Ft,λ = Fs,µ
if
t −λ = s −µ.
Setting Ft = Ft,0, the preceding law becomes the group property:
Ft ◦Fτ = Ft+τ,
F0 = identity .
We call such an Ft a ﬂow and Ft,λ a time-dependent ﬂow, or as before, an evolution operator. If the
system is nonreversible, that is, deﬁned only for t ≥λ, we speak of a semi-ﬂow.
It is usually not Ft,λ that is given, but rather the laws of motion. In other words, diﬀerential equations
are given that we must solve to ﬁnd the ﬂow. These equations of motion have the form
ds
dt = X(s),
s(0) = s0
where X is a (possibly time-dependent) vector ﬁeld on S.
4.1.3 Example.
The motion of a particle of mass m under the inﬂuence of the gravitational force ﬁeld in
Example 4.1.2 is determined by Newton’s second law:
md2r
dt2 = F;
that is, by the ordinary diﬀerentatial equations
md2x
dt2 = −mMGx
r3
;
md2y
dt2 = −mMGy
r3
;
md2z
dt2 = −mMGz
r3
.

4.1 Vector Fields and Flows
211
Letting q = (x, y, z) denote the position and p = m(dr/dt) the momentum, these equations become
dq
dt = p
m;
dp
dt = F(q).
The phase space here is the manifold (R3\{0}) × R3, that is, the cotangent manifold of R3\{0}. The right-
hand side of the preceding equations deﬁne a vector ﬁeld on this six-dimensional manifold by
X(q, p) =

(q, p),
 p
m, F(q)

.
In courses on mechanics or diﬀerential equations, it is shown how to integrate these equations explicitly,
producing trajectories, which are planar conic sections. These trajectories comprise the ﬂow of the vector
ﬁeld.
♦
Let us now turn to the elaboration of these ideas when a vector ﬁeld X is given on a manifold M. If
M = U is an open subset of a Banach space E, then a vector ﬁeld on U is a map X : U →U × E of the
form X(x) = (x, V (x)). We call V the principal part of X. However, having a separate notation for the
principal part turns out to be an unnecessary burden. By abuse of notation, in linear spaces we shall write a
vector ﬁeld simply as a map X : U →E and shall mean the vector ﬁeld x 
→(x, X(x)). When it is necessary
to be careful with the distinction, we shall be.
If M is a manifold and ϕ : U ⊂M →V ⊂E is a local coordinate chart for M, then a vector ﬁeld X on M
induces a vector ﬁeld X on E called the local representative of X by the formula X(x) = Tϕ·X(ϕ−1(x)).
If E = Rn we can identify the principal part of the vector ﬁeld X with an n-component vector function
(X1(x), . . . , Xn(x)). Thus we sometimes just say “the vector ﬁeld X whose local representative is (Xi) =
(X1, . . . , Xn).”
Recall that a curve c at a point m of a manifold M is a C1-map from an open interval I of R into M
such that 0 ∈I and c(0) = m. For such a curve we may assign a tangent vector at each point c(t), t ∈I, by
c′(t) = Ttc(1).
4.1.4 Deﬁnition.
Let M be a manifold and X ∈X(M). An integral curve of X at m ∈M is a curve c
at m such that c′(t) = X(c(t)) for each t ∈I.
In case M = U ⊂E, a curve c(t) is an integral curve of X : U →E when
c′(t) = X(c(t)),
where c′ = dc/dt. If X is a vector ﬁeld on a manifold M and X denotes the principal part of its local
representative in a chart ϕ, a curve c on M is an integral curve of X when
dc
dt (t) = X(c(t)),
where c = ϕ◦c is the local representative of the curve c. If M is an n-manifold and the local representatives
of X and c are (X1, . . . , Xn) and (c1, . . . , cn) respectively, then c is an integral curve of X when the following
system of ordinary diﬀerential equations is satisﬁed
dc1
dt (t)
=
X1(c1(t), . . . , cn(t));
...
...
dcn
dt (t)
=
Xn(c1(t), . . . , cn(t)).
The reader should chase through the deﬁnitions to verify this assertion.
These equations are autonomous, corresponding to the fact that X is time independent. If X were time
dependent, time t would appear explicitly on the right-hand side. As we saw in Example 4.1.3, the preceding
system of equations includes equations of higher order (by their usual reduction to ﬁrst-order systems) and
the Hamilton equations of motion as special cases.

212
4. Vector Fields and Dynamical Systems
4.1.5 Theorem (Local Existence, Uniqueness, and Smoothness).
Let E be a Banach space, U ⊂E be
open, and suppose X : U ⊂E →E is of class Ck, k ≥1. Then
1. For each x0 ∈U, there is a curve c : I →U at x0 such that c′(t) = X(c(t)) for all t ∈I.
2. Any two such curves are equal on the intersection of their domains.
3. There is a neighborhood U0 of the point x0 ∈U, a real number a > 0, and a Ck mapping F : U0×I →E,
where I is the open interval ]−a, a[, such that the curve cu : I →E, deﬁned by cu(t) = F(u, t) is a
curve at u ∈E satisfying the diﬀerential equations c′
u(t) = X(cu(t)) for all t ∈I.
4.1.6 Lemma.
Let E be a Banach space, U ⊂E an open set, and X : U ⊂E →E a Lipschitz map; that
is, there is a constant K > 0 such that
∥X(x) −X(y)∥≤K∥x −y∥
for all x, y ∈U. Let x0 ∈U and suppose the closed ball of radius b,
Bb(x0) = { x ∈E | ∥x −x0∥≤b }
lies in U, and ∥X(x)∥≤M for all x ∈Bb(x0). Let t0 ∈R and let α = min(1/K, b/M). Then there is a
unique C1 curve x(t), t ∈[t0 −α, t0 + α] such that x(t) ∈Bb(x0) and
x′(t) = X(x(t)),
x(t0) = x0.
Proof.
The conditions x′(t) = X(x(t)), x(t0) = x0 are equivalent to the integral equation
x(t) = x0 +
 t
t0
X(x(s)) ds
Put x0(t) = x0 and deﬁne inductively
xn+1(t) = x0 +
 t
t0
X(xn(s)) ds
Clearly xn(t) ∈Bb(x0) for all n and t ∈[t0 −α, t0 + α] by deﬁnition of α. We also ﬁnd by induction that
∥xn+1(t) −xn(t)∥≤
MKn
(n + 1)! |t −t0|n+1.
Thus xn(t) converges uniformly to a continuous curve x(t). Clearly x(t) satisﬁes the integral equation and
thus is the solution we sought.
For uniqueness, let y(t) be another solution. By induction we ﬁnd that ∥xn(t) −y(t)∥≤MKn|t −
t0|n+1/(n + 1)!; thus, letting n →∞gives x(t) = y(t).
■
The same argument holds if X depends explicitly on t or on a parameter ρ, is jointly continuous in (t, ρ, x),
and is Lipschitz in x uniformly in t and ρ. Since xn(t) is continuous in (x0, t0, ρ) so is x(t), being a uniform
limit of continuous functions; thus the integral curve is jointly continuous in (x0, t0, ρ).
4.1.7 Proposition (Gronwall’s Inequality).
Let f, g : [a, b[ →R be continuous and nonnegative. Suppose
that for all t satisfying a ≤t < b,
f(t) ≤A +
 t
a
f(s) g(s) ds,
for a constant A ≥0.
Then
f(t) ≤A exp
 t
a
g(s) ds

for all t ∈[a, b[.

4.1 Vector Fields and Flows
213
Proof.
First suppose A > 0. Let
h(t) = A +
 t
a
f(s) g(s) ds;
thus h(t) > 0. Then h′(t) = f(t)g(t) ≤h(t)g(t). Thus h′(t)/h(t) ≤g(t). Integration gives
h(t) ≤A exp
 t
a
g(s) ds

.
This gives the result for A > 0. If A = 0, then we get the result by replacing A by ε > 0 for every ε > 0;
thus h and hence f is zero.
■
4.1.8 Lemma.
Let X be as in Lemma 4.1.6. Let Ft(x0) denote the solution (= integral curve) of x′(t) =
X(x(t)), x(0) = x0. Then there is a neighborhood V of x0 and a number ε > 0 such that for every y ∈V
there is a unique integral curve x(t) = Ft(y) satisfying x′(t) = X(x(t)) for all t ∈[−ε, ε], and x(0) = y.
Moreover,
∥Ft(x) −Ft(y)∥≤eK|t|∥x −y∥.
Proof.
Choose V = Bb/2(x0) and ε = min(l/K, b/2M). Fix an arbitrary y ∈V . Then Bb/2(y) ⊂Bb(x0)
and hence ∥X(z)∥≤M for all z ∈Bb/2(y). By Theorem 4.1.5 with x0 replaced by y, b by b/2, and t0 by 0,
there exists an integral curve x(t) of x′(t) = X(x(t)) for t ∈[−ε, ε] and satisfying x(0) = y. This proves the
ﬁrst part. For the second, let f(t) = ∥Ft(x) −Ft(y)∥. Clearly
f(t) =

 t
0
[X(Fs(x)) −X(Fs(y))] ds + x −y
 ≤∥x −y∥+ K
 t
0
f(s) ds,
so the result follows from Gronwall’s inequality.
■
This result shows that Ft(x) depends in a continuous, indeed Lipschitz, manner on the initial condition
x and is jointly continuous in (t, x). Again, the same result holds if X depends explicitly on t and on a
parameter ρ is jointly continuous in (t, ρ, x), and is Lipschitz in x uniformly in t and ρ; (Ft,λ)ρ(x) is the
unique integral curve x(t) satisfying x′(t) = X(x(t), t, ρ) and x(λ) = x. By the remark following Lemma
4.1.6, (Ft,λ)ρ(x) is jointly continuous in the variables (λ, t, ρ, x), and is Lipschitz in x, uniformly in (λ, t, ρ).
The next result shows that Ft is Ck if X is, and completes the proof of Theorem 4.1.5. For the next lemma,
recall that a C1-function is locally Lipschitz.
4.1.9 Lemma.
Let X in Lemma 4.1.6 be of class Ck, l ≤k ≤∞, and let Ft(x) be deﬁned as before. Then
locally in (t, x), Ft(x) is of class Ck in x and is Ck+1 in the t-variable.
Proof.
We deﬁne ψ(t, x) ∈L(E, E), the set of continuous linear maps of E to E, to be the solution of the
“linearized” or “ﬁrst variation” equations:
d
dtψ(t, x) = DX(Ft(x)) ◦ψ(t, x),
with ψ(0, x) = identity,
where DX(y) : E →E is the derivative of X taken at the point y. Since the vector ﬁeld ψ 
→DX(Ft(x))◦ψ
on L(E, E) (depending explicitly on t and on the parameter x) is Lipschitz in ψ, uniformly in (t, x) in a
neighborhood of every (t0, x0), by the remark following Lemma 4.1.8 it follows that ψ(t, x) is continuous in
(t, x) (using the norm topology on L(E, E)).

214
4. Vector Fields and Dynamical Systems
We claim that DFt(x) = ψ(t, x). To show this, ﬁx t, set θ(s, h) = Fs(x + h) −Fs(x), and write
θ(t, h) −ψ(t, x) · h =
 t
0
{X(Fs(x + h)) −X(Fs(x))} ds
−
 t
0
[DX(Fs(x)) ◦ψ(s, x)] · h ds
=
 t
0
DX(Fs(x)) · [θ(s, h) −ψ(s, x) · h] ds
+
 t
0
{X(Fs(x + h)) −X(Fs(x))
−DX(Fs(x)) · [Fs(x + h) −Fs(x)]} ds.
Since X is of class C1, given ε > 0, there is a δ > 0 such that ∥h∥< δ implies the second term is dominated
in norm by
 t
0
ε∥Fs(x + h) −Fs(x)∥ds,
which is, in turn, smaller than Aε∥h∥for a positive constant A by Lemma 4.1.8. By Gronwall’s inequality
we obtain ∥θ(t, h) −ψ(t, x) · h∥≤(constant) ε∥h∥. It follows that DFt(x) · h = ψ(t, x) · h. Thus both partial
derivatives of Ft(x) exist and are continuous; therefore Ft(x) is of class C1.
We prove Ft(x) is Ck by induction on k. Begin with the equation deﬁning Ft :
d
dtFt(x) = X(Ft(x))
so
d
dt
d
dtFt(x) = DX(Ft(x)) · X(Ft(x))
and
d
dtDFt(x) = DX(Ft(x)) · DFt(x).
Since the right-hand sides are Ck−1, so are the solutions by induction. Thus F itself is Ck.
■
Again there is an analogous result for the evolution operator (Ft,λ)ρ(x) for a time-dependent vector ﬁeld
X(x, t, ρ), which depends on extra parameters ρ in a Banach space P. If X is Ck, then (Ft,λ)ρ(x) is Ck in all
variables and is Ck+1 in t and λ. The variable ρ can be easily dealt with by suspending X to a new vector
ﬁeld obtained by appending the trivial diﬀerential equation ρ′ = 0; this deﬁnes a vector ﬁeld on E × P and
Theorem 4.1.5 may be applied to it. The ﬂow on E × P is just Ft(x, ρ) = (F ρ
t (x), ρ).
For another more “modern” proof of Theorem 4.1.5 see Supplement 4.1C. That alternative proof has a
technical advantage: it works easily for other types of diﬀerentiability assumptions on X or on Ft, such as
H¨older or Sobolev diﬀerentiability; this result is due to Ebin and Marsden [1970].
The mapping F gives a locally unique integral curve cu for each u ∈U0, and for each t ∈I, Ft =
F|(U0 × {t}) maps U0 to some other set. It is convenient to think of each point u being allowed to “ﬂow
for time t” along the integral curve cu (see Figure 4.1.2 and our opening motivation). This is a picture of
a U0 “ﬂowing,” and the system (U0, a, F) is a local ﬂow of X, or ﬂow box. The analogous situation on a
manifold is given by the following.
4.1.10 Deﬁnition.
Let M be a manifold and X a Cr vector ﬁeld on M, r ≥1. A ﬂow box of X at m ∈M
is a triple (U0, a, F), where

4.1 Vector Fields and Flows
215
U0
Ft (U0)
Figure 4.1.2. Picturing a ﬂow
(i)
U0 ⊂M is open, m ∈U0, and a ∈R, where a > 0 or a = +∞;
(ii)
F : U0 × Ia →M is of class Cr, where Ia = ]−a, a[;
(iii)
for each u ∈U0, cu : Ia →M deﬁned by cu(t) = F(u, t) is an integral curve of X at the point u;
(iv)
if Ft : U0 →M is deﬁned by Ft(u) = F(u, t), then for t ∈Ia, Ft(U0) is open, and Ft is a Cr
diﬀeomorphism onto its image.
Before proving the existence of a ﬂow box, it is convenient ﬁrst to establish the following, which concerns
uniqueness.
4.1.11 Proposition (Global Uniqueness).
Suppose c1 and c2 are two integral curves of X at m ∈M.
Then c1 = c2 on the intersection of their domains.
Proof.
This does not follow at once from Theorem 4.1.5 for c1 and c2 may lie in diﬀerent charts. (Indeed,
if the manifold is not Hausdorﬀ, Exercise 4.1-13 shows that this proposition is false.) Suppose c1 : I1 →M
and c2 : I2 →M. Let I = I1 ∩I2, and let K = { t ∈I | c1(t) = c2(t) }; K is closed since M is Hausdorﬀ. We
will now show that K is open. From Theorem 4.1.5, K contains some neighborhood of 0. For t ∈K consider
ct
1 and ct
2, where ct(s) = c(t + s). Then ct
1 and ct
2 are integral curves at c1(t) = c2(t). Again, by Theorem
4.1.5 they agree on some neighborhood of 0. Thus some neigborhood of t lies in K, and so K is open. Since
I is connnected, K = I.
■
4.1.12 Proposition.
Suppose (U0, a, F) is a triple satisfying (i), (ii), and (iii) of Deﬁnition 4.1.10. Then
for t, s and t + s ∈Ia,
Ft+s = Ft ◦Fs = Fs ◦Ft
and
F0 is the identity map,
whenever the compositions above are deﬁned. Moreover, if Ut = Ft(U0) and Ut ∩U0 ̸= ∅, then Ft|U−t ∩U0 :
U−t ∩U0 →U0 ∩Ut is a diﬀeomorphism and its inverse is F−t|U0 ∩Ut.
Proof.
Ft+s(u) = cu(t + s), where cu is the integral curve deﬁned by F at u. But d(t) = Ft(Fs(u)) =
Ft(cu(s)) is the integral curve through cu(s) and f(t) = cu(t+s) is also an integral curve at cu(s). Hence by
global uniqueness Proposition 4.1.11 we have Ft(Fs(u)) = cu(t + s) = Ft+s(u). To show that Ft+s = Fs ◦Ft,
observe that Ft+s = Fs+t = Fs ◦Ft. Since cu(t) is a curve at u, cu(0) = u, so F0 is the identity. Finally, the
last statement is a consequence of Ft ◦F−t = F−t ◦Ft = identity. Note, however, that Ft(U0) ∩U0 = ∅can
occur.
■

216
4. Vector Fields and Dynamical Systems
4.1.13 Proposition (Existence and Uniqueness of Flow Boxes).
Let X be a Cr vector ﬁeld on a manifold M. For each m ∈M there is a ﬂow box of X at m. Suppose
(U0, a, F), (U ′
0, a′, F ′) are two ﬂow boxes at m ∈M. Then F and F ′ are equal on (U0 ∩U ′
0) × (Ia ∩Ia′).
Proof.
(Uniqueness). Again we emphasize that this does not follow at once from Theorem 4.1.5, since
U0 and U ′
0 need not be chart domains. However, for each point u ∈U0 ∩U ′
0 we have F|{u}×I = F ′|{u}×I,
where I = Ia ∩Ia′. This follows from Proposition 4.1.11 and Deﬁnition 4.1.10(iii). Hence F = F ′ on the set
(U0 ∩U ′
0) × I.
(Existence). Let (U, ϕ) be a chart in M with m ∈U. It is enough to establish the result in ϕ(U) by means
of the local representation. Thus let (U ′
0, a, F ′) be a ﬂow box of X, the local representative of X, at ϕ(m)
as given by Theorem 4.1.5, with
U ′
0 ⊂U ′ = ϕ(U)
and
F ′(U ′
0 × Ia) ⊂U ′,
U0 = ϕ−1(U ′
0)
and let
F : U0 × Ia →M;
(u, t) 
→ϕ−1(F ′(ϕ(u), t)).
Since F is continuous, there is a b ∈]0, a[ ⊂R and V0 ⊂U0 open, with m ∈V0, such that F(V0 × Ib) ⊂U0.
We contend that (V0, b, F) is a ﬂow box at m (where F is understood as the restriction of F to V0×Ib). Parts
(i) and (ii) of Deﬁnition 4.1.10 follow by construction and (iii) is a consequence of the remarks following
Deﬁnition 4.1.4 on the local representation. To prove (iv), note that for t ∈Ib, Ft has a Cr inverse, namely,
F−t as Vt ∩U0 = Vt. It follows that Ft(V0) is open. And, since Ft and F−t are both of class Cr, Ft is a Cr
diﬀeomorphism.
■
As usual, there is an analogous result for time- (or parameter-) dependent vector ﬁelds. The following
result shows that near a point m satisfying X(m) ̸= 0, the ﬂow can be transformed by a change of variables
so that the integral curves become straight lines.
4.1.14 Theorem (Straightening Out Theorem).
Let X be a vector ﬁeld on a manifold M and suppose at
m ∈M, X(m) ̸= 0. Then there is a local chart (U, ϕ) with m ∈U such that
(i)
ϕ(U) = V × I ⊂G × R = E, V ⊂G, open, and I = ]−a, a[ ⊂R, a > 0;
(ii)
ϕ−1|{v} × I : I →M is an integral curve of X at ϕ−1(v, 0), for all v ∈V ;
(iii)
the local representative X has the form X(y, t) = (y, t; 0, 1).
Proof.
Since the result is local, by taking any initial coordinate chart, it suﬃces to prove the result in E.
We can arrange things so that we are working near 0 ∈E and X(0) = (0, 1) ∈E = G ⊕R where G is a
complement to the span of X(0). Letting (U0, b, F) be a ﬂow box for X at 0 where U0 = V0 × ]−ε, ε[ and V0
is open in G, deﬁne
f0 : V0 × Ib →E
by
f0(y, t) = Ft(y, 0).
But
Df0(0, 0) = Identity
since
∂Ft(0, 0)
∂t

t=0
= X(0) = (0, 1)
and
F0 = Identity.
By the inverse mapping theorem there are open neighborhoods V × Ia ⊂V0 × Ib and U = f0(V × Ia)
of (0, 0) such that f = f0|V × Ia : V × Ia →U is a diﬀeomorphism. Then f −1 : U →V × Ia can serve

4.1 Vector Fields and Flows
217
as chart for (i). Notice that c = f|{y} × I : I →U is the integral curve of X through (y, 0) for all
y ∈V , thus proving (ii). Finally, the expression of the vector ﬁeld X in this local chart given by f −1 is
Df −1(y, t) · X(f(y, t)) = Df −1(c(t)) · c′(t) = (f −1 ◦c)′(t) = (0, 1), since (f −1 ◦c)(t) = (y, t), thus proving
(iii).
■
In §4.3 we shall see that singular points, where the vector ﬁeld vanishes, are of great interest in dynamics.
The straightening out theorem does not claim anything about these points. Instead, one needs to appeal to
more sophisticated normal form theorems; see Guckenheimer and Holmes [1983].
Now we turn our attention from local ﬂows to global considerations. These ideas center on considering
the ﬂow of a vector ﬁeld as a whole, extended as far as possible in the t-variable.
4.1.15 Deﬁnition.
Given a manifold M and a vector ﬁeld X on M, let DX ⊂M × R be the set of
(m, t) ∈M × R such that there is an integral curve c : I →M of X at m with t ∈I. The vector ﬁeld X is
complete if DX = M ×R. A point m ∈M is called σ-complete, where σ = +, −, or ±, if DX ∩({m}×R)
contains all (m, t) for t > 0, < 0, or t ∈R, respectively. Let T +(m) (resp., T −(m)) denote the sup (resp.,
inf ) of the times of existence of the integral curves through m; T +(m) (resp., T −(m)) is called the positive
(resp., negative) lifetime of m.
Thus, X is complete iﬀeach integral curve can be extended so that its domain becomes ]−∞, ∞[; that is,
T +(m) = ∞and T −(m) = −∞for all m ∈M.
4.1.16 Examples.
A. For M = R2, let X be the constant vector ﬁeld, whose principal part is (0, 1). Then X is complete
since the integral curve of X through (x, y) is t 
→(x, y + t).
B. On M = R2\{0}, the same vector ﬁeld is not complete since the integral curve of X through (0, −1)
cannot be extended beyond t = 1; in fact as t →1 this integral curve tends to the point (0, 0). Thus
T +(0, −1) = 1, while T −(0, −1) = −∞.
C. On R consider the vector ﬁeld X(x) = 1 + x2. This is not complete since the integral curve c with
c(0) = 0 is c (t) = tan−1 t and thus it cannot be continuously extended beyond −π/2 and π/2; that is,
T ±(0) = ±π/2.
♦
4.1.17 Proposition.
Let M be a manifold and X ∈Xr(M), r ≥1. Then
(i)
DX ⊃M × {0};
(ii)
DX is open in M × R;
(iii)
there is a unique Cr mapping FX : DX →M such that the mapping t 
→FX(m, t) is an integral curve
at m for all m ∈M;
(iv)
for (m, t) ∈DX, (FX(m, t), s) ∈DX iﬀ(m, t + s) ∈DX; in this case
FX(m, t + s) = FX(FX(m, t), s).
Proof.
Parts (i) and (ii) follow from the ﬂow box existence theorem. In (iii), we get a unique map FX :
DX →M by the global uniqueness and local existence of integral curves: (m, t) ∈DX when the integral
curve m(s) through m exists for s ∈[0, t]. We set FX(m, t) = m(t). To show FX is Cr, note that in a
neighborhood of a ﬁxed m0 and for small t, it is Cr by local smoothness. To show FX is globally Cr, ﬁrst
note that (iv) holds by global uniqueness. Then in a neighborhood of the compact set { m(s) | s ∈[0, t] }
we can write FX as a composition of ﬁnitely many Cr maps by taking short enough time steps so the local
ﬂows are smooth.
■

218
4. Vector Fields and Dynamical Systems
4.1.18 Deﬁnition.
Let M be a manifold and X ∈Xr(M), r ≥1. Then the mapping FX is called the
integral of X, and the curve t 
→FX(m, t) is called the maximal integral curve of X at m. In case X
is complete, FX is called the ﬂow of X.
Thus, if X is complete with ﬂow F, then the set { Ft | t ∈R } is a group of diﬀeomorphisms on M,
sometimes called a one-parameter group of diﬀeomorphisms. Since Fn = (F1)n (the nth power), the
notation F t is sometimes convenient and is used where we use Ft. For incomplete ﬂows, (iv) says that
Ft ◦Fs = Ft+s wherever it is deﬁned. Note that Ft(m) is deﬁned for t ∈]T −(m), T +(m)[. The reader should
write out similar deﬁnitions for the time-dependent case and note that the lifetimes depend on the starting
time t0.
4.1.19 Proposition.
Let X be Cr, where r ≥1. Let c(t) be a maximal integral curve of X such that for
every ﬁnite open interval ]a, b[ in the domain ]T −(c(0)), T +(c(0))[ of c, c(]a, b[) lies in a compact subset of
M. Then c is deﬁned for all t ∈R.
Proof.
It suﬃces to show that a ∈I, b ∈I, where I is the interval of deﬁnition of c. Let tn ∈]a, b[,
tn →b. By compactness we can assume some subsequence c(tn(k)) converges, say, to a point x in M. Since
the domain of the ﬂow is open, it contains a neighborhood of (x, 0). Thus, there are ε > 0 and τ > 0 such
that integral curves starting at points (such as c(tn(k)) for large k) closer than ε to x persist for a time longer
than τ. This serves to extend c to a time greater than b, so b ∈I since c is maximal. Similarly, a ∈I.
■
The support of a vector ﬁeld X deﬁned on a manifold M is deﬁned to be the closure of the set { m ∈
M | X(m) ̸= 0 }.
4.1.20 Corollary.
A Cr vector ﬁeld with compact support on a manifold M is complete. In particular, a
Cr vector ﬁeld on a compact manifold is complete.
Completeness corresponds to well-deﬁned dynamics persisting eternally. In some circumstances (shock
waves in ﬂuids and solids, singularities in general relativity, etc.) one has to live with incompleteness or
overcome it in some other way. Because of its importance we give two additional criteria. In the ﬁrst result
we use the notation X[f] = df · X for the derivative of f in the direction X. Here f : E →R and df stands
for the derivative map. In standard coordinates on Rn,
df(x) =
 ∂f
∂x1 , . . . , ∂f
∂xn

and
X[f] =
n
	
i=1
Xi ∂f
∂xi .
4.1.21 Proposition.
Suppose X is a Ck vector ﬁeld on the Banach space E, k ≥1, and f : E →R is
a C1 proper map; that is, if {xn} is any sequence in E such that f(xn) →a, then there is a convergent
subseqence {xn(i)}. Suppose there are constants K, L ≥0 such that
|X[f](m)| ≤K|f(m)| + L
for all m ∈E.
Then the ﬂow of X is complete.
Proof.
From the chain rule we have (∂/∂t)f(Ft(m)) = X[f](Ft(m)), so that
f(Ft(m)) −f(m) =
 t
0
X[f](Fτ(m)) dτ
Applying the hypothesis and Gronwall’s inequality we see that |f(Ft(m))| is bounded and hence relatively
compact on any ﬁnite t-interval, so as f is proper, a repetition of the argument in the proof of Proposition
4.1.19 applies.
■
Note that the same result holds if we replace “properness” by “inverse images of compact sets are bounded”
and assume X has a uniform existence time on each bounded set. This version is useful in some inﬁnite
dimensional examples.

4.1 Vector Fields and Flows
219
4.1.22 Proposition.
Let X be a Cr vector ﬁeld on the Banach space E, r ≥1. Let σ be any integral curve
of X. Assume ∥X(σ(t))∥is bounded on ﬁnite t-intervals. Then σ(t) exists for all t ∈R.
Proof.
Suppose ∥X(σ(t))∥< A for t ∈]a, b[ and let tn →b. For tn < tm we have
∥σ(tn) −σ(tm)∥≤
 tm
tn
∥σ′(t)∥dt =
 tm
tn
∥X(σ(t))∥dt ≤A|tm −tn|.
Hence σ(tn) is a Cauchy sequence and therefore, converges. Now argue as in Proposition 4.1.19.
■
4.1.23 Examples.
A.
Let X be a Cr vector ﬁeld, r ≥1, on the manifold M admitting a ﬁrst integral, that is, a function
f : M →R such that X[f] = 0. If all level sets f −1(r), r ∈R are compact, X is complete. Indeed, each
integral curve lies on a level set of f so that the result follows by Proposition 4.1.19.
B.
Newton’s equations for a moving particle of mass m in a potential ﬁeld in Rn are given by ¨q(t) =
−(1/m)∇V (q(t)), for V : Rn →R a smooth function. We shall prove that if there are constants a, b ∈R,
b ≥0 such that (1/m)V (q) ≥a −b∥q∥2, then every solution exists for all time. To show this, rewrite the
second order equations as a ﬁrst order system ˙q = (1/m)p, ˙p = −∇V (q) and note that the energy E(q, p) =
(1/2m)∥p∥2 + V (q) is a ﬁrst integral. Thus, for any solution (q(t), p(t)) we have β = E(q(t), p(t)) =
E(q(0), p(0)) ≥V (q(0)). We can assume β > V (q(0)), that is, p(0) ̸= 0, for if p(t) ≡0, then the conclusion
is trivially satisifed; thus there exists a t0 for which p(t0) ̸= 0 and by time translation we can assume that
t0 = 0. Thus we have
∥q(t)∥≤∥q(t) −q(0)∥+ ∥q(0)∥≤∥q(0)∥+
 t
0
∥˙q(s)∥ds
= ∥q(0)∥+
 t
0

2

β −1
mV (q(s))

ds
≤∥q(0)∥+
 t
0

2(β −a + b∥q(s)∥2) ds
or in diﬀerential form
d
dt∥q(t)∥≤

2(β −a + b∥q(t)∥2)
whence
t ≤
 ∥q(t)∥
∥q(0)∥
du

2(β −a + bu2)
(4.1.1)
Now let r(t) be the solution of the diﬀerential equation
d2r(t)
dt2
= −d
dr(a −br2)(t) = 2br(t),
which, as a second order equation with constant coeﬃcients, has solutions for all time for any initial condi-
tions. Choose
r(0) = ∥q(0)∥,
[ ˙r(0)]2 = 2(β −a + b∥q(0)∥2)
and let r(t) be the corresponding solution. Since
d
dt
1
2 ˙r(t)2 + a −br(t)2

= 0,

220
4. Vector Fields and Dynamical Systems
it follows that (1/2) ˙r(t)2 + a −br(t)2 = (1/2) ˙r(0)2 + a −br(0)2 = β, that is,
dr(t)
dt
=

2(β −a + br(t)2)
whence
t =
 r(t)
∥q(0)∥
du

2(β −α + βu2
(4.1.2)
Comparing the two expressions (4.1.1) and (4.1.2) and taking into account that the integrand is > 0, it
follows that for any ﬁnite time interval for which q(t) is deﬁned, we have ∥q(t)∥≤r(t), that is, q(t) remains
in a compact set for ﬁnite t-intervals. But then ˙q(t) also lies in a compact set since
∥˙q(t)∥≤2(β −a + b∥q(s)∥2).
Thus by Proposition 4.1.19, the solution curve (q(t), p(t)) is deﬁned for any t ≥0. However, since (q(−t), p(−t))
is the value at t of the integral curve with initial conditions (−q(0), −p(0)), it follows that the solution also
exists for all t ≤0. (This example will be generalized in §8.1 to any Lagrangian system on a complete Rie-
mannian manifold whose energy function is kinetic energy of the metric plus a potential, with the potential
obeying an inequality of the sort here).
The following counterexample shows that the condition V (q) ≥a−b∥q∥2 cannot be relaxed much further.
Take n = 1 and
V (q) = −1
8ε2q2+(4/ε),
ε > 0.
Then the equation ¨q = ε(ε + 2)q1+(4/ε)/4 has the solution q(t) = 1/(t −1)ε/2, which cannot be extended
beyond t = 1.
C.
Let E be a Banach space. Suppose
A(x) = A · x + B(x),
where A is a bounded linear operator of E to E and B is sublinear; that is, B : E →E is Cr with r ≥1 and
satisﬁes ∥B(x)∥≤K∥x∥+L for constants K and L. We shall show that X is complete by using Proposition
4.1.22. (In Rn, Proposition 4.1.21 can also be used with f(x) = ∥x∥2.) Let x(t) be an integral curve of X
on the bounded interval [0, T]. Then
x(t) = x(0) +
 t
0
(A · x(s) + B(x(s))) ds
Hence
∥x(t)∥≤∥x(0)∥
 t
0
(∥A∥+ K)∥x(s)∥ds + Lt.
By Gronwall’s inequality,
∥x(t)∥≤(LT + ∥x(0)∥)e(∥A∥+K)t.
Hence x(t) and so X(x(t)) remain bounded on bounded t-intervals.
♦
4.1.24 Proposition.
Let X be a Cr vector ﬁeld on the manifold M, r ≥1, m0 ∈M, and T +(m0)(T −(m0))
the positive (negative) lifetime of m0. Then for each ε > 0, there exists a neighborhood V of m0 such that
for all m ∈V , T +(m) > T +(m0) −ε (respectively, T −(m0) < T −(m0) + ε). [One says T +(m0) is a lower
semi-continuous function of m.]

4.1 Vector Fields and Flows
221
Proof.
Cover the segment { Ft(m0) | t ∈[0, T +(m0) −ε] } with a ﬁnite number of neighborhoods
U0, . . . , Un, each in a chart domain and such that ϕi(Ui) is diﬀeomorphic to the open ball Bb(i)/2(0) in
E given in the proof of Lemma 4.1.8, where ϕi is the chart map. Let mi ∈Ui be such that ϕi(mi) = 0
and t(i) such that Ft(i)(m0) = mi, i = 0, . . . , n, t(0) = 0, t(n) = T +(m0) −ε. By Lemma 4.1.8 the time of
existence of all integral curves starting in Ui is uniformly at least α(i) > 0. Pick points pi ∈Ui ∩Ui+1 and
let s(i) be such that
Fs(i)(m0) = pi, i = 0, . . . , n −1,
s(0) = 0,
p0 = m0,
s(i) < s(i + 1),
s(i + 1) −t(i) < α(i),
t(i + 1) −s(i + 1) < α(i + 1),
s(i + 1) −s(i) < min(α(i), α(i + 1));
see Figure 4.1.3.
mn 
pn 
m0 
m1 
m2 
p1 
p2 
U0
U1
U2
Un
Un−1
Figure 4.1.3. A chain of charts
Let W1 = U0 ∩U1. Since s(2) −s(1) < α(1) and any integral curve starting in W1 ⊂U1 exists for time
at least α(1), the domain of Fs(2)−s(1) includes W1 and hence Fs(2)−s(1)(W1) makes sense. Deﬁne the open
set W2 = Fs(2)−s(1)(W1) ∩U1 ∩U2 and use s(3) −s(2) < α(2), W2 ⊂U2 to conclude that the domain of
Fs(3)−s(2) contains U2. Deﬁne the open set W3 = Fs(3)−s(2)(W2) ∩U2 ∩U3 and inductively deﬁne
Wi = Fs(i)−s(i−1)(Wi −1) ∩Ui−1 ∩Ui,
i = 1, . . . , n,
which are open sets. Since s(1) < α(0) and W1 ⊂U0, the domain of F−s(1) includes W1 and thus V1 =
F−s(1)(W1) ∩U0 is an open neighborhood of m0. Since s(2) −s(1) < α(1) and W2 ⊂U1, the domain of
F−s(2)+s(1) contains W2 and so F−s(2)+s(1)(W2) ⊂W1 makes sense. Therefore
F−s(2)(W2) = F−s(1)(F−s(2)+s(1)(W2)) ⊂F−s(1)(W1)
exists and is an open neighborhood of m0. Put V2 = F−s(2)(W2)∩U0. Now proceed inductively to show that
F−s(i)(Wi) ⊂F−s(i−1)(Wi−1) makes sense and is an open neighborhood of m0, i = 1, 2, . . . , n; see Figure
4.1.4. Let Vi = F−s(i)(Wi) ∩U0, i = 1, . . . , n, open neighborhoods containing m0. Any integral curve c(t)
starting in Vn exists thus for time at least s(n) and Fs(n)(Vn) ⊂Wn ⊂Un. Now consider the integral curve
starting at c(s(n)) whose time of existence is at least α(n). By uniqueness, c(t) can be smoothly extended
to an integral curve which exists for time at least s(n) + α(n) > tn = T +(m0) −ε.
■
The same result and proof hold for time dependent vector ﬁelds depending on a parameter.
4.1.25 Corollary.
Let Xt be a Cr time-dependent vector ﬁeld on M, r ≥1, and let m0 be an equilibrium
of Xt, that is, Xt(m0) = 0 for all t. Then for any T there exists a neighborhood V of m0 such that any
m ∈V has integral curve existing for time t ∈[−T, T].
Proof.
Since T +(m0) = +∞, T −(m0) = −∞, the previous proposition gives the result.
■

222
4. Vector Fields and Dynamical Systems
U0
U1
U2
m2
p2
W2
m1
p1
V2
V1
W1
m0
F−s(2)+s(1)(W2)
Figure 4.1.4. Semicontinuity of lifetimes
Supplement 4.1A
Product Formulas
A result of some importance in both theoretical and numerical work concerns writing a ﬂow in terms of
iterates of a known mapping. Let X ∈X(M) with ﬂow Ft (maximally extended). Let Kε(x) be a given map
deﬁned in some open set of [0, ∞[ × M containing {0} × M and taking values in M, and assume that
(i)
K0(x) = x and
(ii)
Kε(x) is C1 in ε with derivative continuous in (ε, x).
We call K the algorithm.
4.1.26 Theorem.
Let X be a Cr vector ﬁeld, r ≥1. Assume that the algorithm Kε(x) is consistent
with X in the sense that
X(x) = ∂
∂εKε(x)

ε=0
Then, if (t, x) is in the domain of Ft(x), (Kt/n)n(x) is deﬁned for n suﬃciently large and converges to Ft(x)
as n →∞. Conversely, if (Kt/n)n(x) is deﬁned and converges for 0 ≤t ≤T, then (T, x) is in the domain
of F and the limit is Ft(x).
In the following proof the notation O(x), x ∈R is used for any continuous function in a neighborhood
of the origin such that O(x)/x is bounded. Recall from §2.1 that o(x) denotes a continuous function in a
neighborhood of the origin satisfying limx→0 o(x)/x = 0.
Proof.
First, we prove that convergence holds locally. We begin by showing that for any x0, the iterates
(Kt/n)n(x0) are deﬁned if t is suﬃciently small. Indeed, on a neighborhood of x0, Kε(x) = x + O(ε), so if
(Kt/j)j(x) is deﬁned for x in a neighborhood of x0, for j = 1, . . . , n −1, then
(Kt/n)n(x) −x = ((Kt/n)nx −(Kt/n)n−1x) + ((Kt/n)n−1 −(Kt/n)n−2x)
+ · · · + (Kt/n(x) −x)
= O(t/n) + · · · + O(t/n) = O(t).
This is small, independent of n for t suﬃciently small; so, inductively, (Kt/n)n(x) is deﬁned and remains in
a neighborhood of x0 for x near x0.

4.1 Vector Fields and Flows
223
Let β be a local Lipschitz constant for X so that ∥Ft(x) −Ft(y)∥≤eβ|t|∥x −y∥. Now write
Ft(x) −(Kt/n)n(x) = (Ft/n)n(x) −(Kt/n)n(x)
= (Ft/n)n−1Ft/n(x) −(Ft/n)n−1Kt/n(x)
+(Ft/n)n−2Ft/n(y1) −(Ft/n)n−2Kt/n(y1)
+ · · · + (Ft/n)n−kFt/n(yk−1) −(Ft/n)n−kKt/n(Yk−1)
+ · · · + Ft/n(yn−1) −Kt/n(yn−1)
where yk = (Kt/n)k(x). Thus
∥Ft(x) −(Kt/n)n(x)∥≤
n
	
k=1
eβ|t|(n−k)/n∥Ft/n(tk−1) −Kt/n(yk−1)∥
≤neβ|t|o(t/n) →0
as
n →∞,
since Fε(y) −Kε(y) = o(ε) by the consistency hypothesis.
Now suppose Ft(x) is deﬁned for 0 ≤t ≤T. We shall show (Kt/n)n(x) converges to Ft(x). By the foregoing
proof and compactness, if N is large enough, Ft/N = limn→∞(Kt/nN)n uniformly on a neighborhood of the
curve t 
→Ft(x). Thus, for 0 ≤t ≤T,
Ft(x) = (Ft/N)N(x) = lim
n→∞(Kt/nN)N(x).
By uniformity in t,
FT (x) = lim
j→∞(KT/j)j(x).
Conversely, let (Kt/n)n(x) converge to a curve c(t), 0 ≤t ≤T. Let S = { t | Ft(x) is deﬁned and
c(t) = Ft(x) }. From the local result, S is a nonempty open set. Let t(k) ∈S, t(k) →t. Thus Ft(k)(x)
converges to c(t), so by local existence theory, Ft(x) is deﬁned, and by continuity, Ft(x) = c(t). Hence
S = [0, T] and the proof is complete.
■
4.1.27 Corollary.
Let X, Y ∈X(M) with ﬂows Ft and Gt. Let St be the ﬂow of X + Y . Then for x ∈M,
St(x) = lim
n→∞(Ft/n ◦Gt/n)n(x).
The left-hand side is deﬁned iﬀthe right-hand side is. This follows from Theorem 4.1.26 by setting
Kε(x) = (Fε ◦Gε)(x). For example, for n×n matrices A and B, Corollary 4.1.27 yields the classical formula
e(A+B) = lim
n→∞(eA/neB/n)n.
To see this, deﬁne for any n × n matrix C a vector ﬁeld XC ∈X(Rn) by XC(x) = Cx. Since XC is linear in
C and has ﬂow Ft(x) = etCx, the formula follows from Corollary 4.1.27 by letting t = 1.
The topic of this supplement will continue in Supplement 4.2A. The foregoing proofs were inspired by
Nelson [1969] and Chorin, Hughes, McCracken, and Marsden [1978].
Supplement 4.1B

224
4. Vector Fields and Dynamical Systems
Invariant Sets
If X is a smooth vector ﬁeld on a manifold M and N ⊂M is a submanifold, the ﬂow of X will leave N
invariant (as a set) iﬀX is tangent to N. If N is not a submanifold (e.g., N is an open subset together with
a non-smooth boundary) the situation is not so simple; however, for this there is a nice criterion going back
to Nagumo [1942]. Our proof follows Brezis [1970].
4.1.28 Theorem.
Let X be a locally Lipschitz vector ﬁeld on an open set U ⊂E, where E is a Banach
space. Let G ⊂U be relatively closed and set d(x, G) = inf{ ∥x −y∥| y ∈G }. The following are equivalent:
(i)
limh↓0(d(x + hX(x), G)/h) = 0 locally uniformly in x ∈G (or pointwise if E = Rn);
(ii)
if x(t) is the integral curve of X starting in G, then x(t) ∈G for all t ≥0 in the domain of x(·).
Note that x(t) need not lie in G for t ≤0; so G is only + invariant. (We remark that if X is only continuous
the theorem fails.) We give the proof assuming E = Rn for simplicity.
Proof.
Assume (ii) holds. Setting x(t) = Ft(x), where Ft is the ﬂow of X and x ∈G, for small h we get
d(x + hX(x), G) ≤∥x(h) −x −hX(x)∥= |h|

x(h) −x
h
−X(x)
 ,
from which (i) follows.
Now assume (i). It suﬃces to show x(t) ∈G for small t. Near x = x(0) ∈G, say on a ball of radius r, we
have
∥X(x1) −X(x2)∥≤K∥x1 −x2∥
and
∥Ft(x1) −Ft(x2)∥≤eKt∥x1 −x2∥.
We can assume ∥Ft(x) −x∥< r/2. Set ϕ(t) = d(Ft(x), G) and note that ϕ(0) = 0, so that for small t,
ϕ(t) < r/2. Since G is relatively closed, and E = Rn, d(Ft(x), G) = ∥Ft(x) −yt∥for some yt ∈G. (In the
general Banach space case an approximation argument is needed here.) Thus, ∥yt −x∥< r. For small h,
∥Fh(yt) −x∥< r, so that
ϕ(t + h) = inf
z∈G ∥Ft+h(x) −z∥
≤inf
z∈G{∥Ft+h(x) −Fh(yt)∥+ ∥Fh(yt) −yt −hX(yt)∥
+∥yt + hX(yt) −z∥}
= ∥Ft+h(x) −Fh(yt)∥+ ∥Fh(yt) −yt −hX(yt)∥
+d(yt + hX(yt), G)
≤eKh∥yt −Ft(x)∥+ ∥Fh(yt) −yt −hX(yt)∥
+d(yt + hX(yt), G)
or
ϕ(t + h) −ϕ(t)
h
≤
eKh −1
h

ϕ(t) +

Fh(yt) −yt
h
−X(yt)

+ 1
hd(yt + hX(yt), G).

4.1 Vector Fields and Flows
225
Hence
lim sup
h↓0
ϕ(t + h) −ϕ(t)
h
≤Kϕ(t).
As in Gronwall’s inequality, we may conclude that
ϕ(t) ≤eKtϕ(0),
so ϕ(t) = 0.
■
4.1.29 Example.
Let X be a C∞vector ﬁeld on Rn, let g : Rn →R be smooth, and let λ ∈R be a
regular value for g, so g−1(λ) is a submanifold; see Figure 4.1.5.
Let G = g−1(]−∞, λ]) and suppose that on g−1(λ),
⟨X, grad g⟩≤0.
g > λ
g < λ
X(x)
g = λ
x
∇g
Figure 4.1.5. The set G = g−1(] −∞, λ[) is invariant if X does not point strictly outwards at ∂G
Then G is + invariant under Ft as may be seen by using Theorem 4.1.28. This result has been generalized
to the case where ∂G might not be smooth by Bony [1969]. See also Redheﬀer [1972] and Martin [1973].
Related references are Yorke [1967], Hartman [1972], and Crandall [1972].
♦
Supplement 4.1C
A second Proof of the Existence and Uniqueness of Flow Boxes
We now give an alternative “modern” proof of Theorem 4.1.5 and Proposition 4.1.13, namely, if X ∈Xk(M),
k ≥1, then for each m ∈M there exists a unique Ck ﬂow box at m. The basic idea is due to Robbin [1968]
although similar alternative proofs were simultaneously discovered by Abraham and Pugh [unpublished] and
Marsden [1968b, p. 368]. The present exposition follows Robbin [1968] and Ebin and Marsden [1970].

226
4. Vector Fields and Dynamical Systems
Step 1
Existence and uniqueness of integral curves for C1 vector ﬁelds.
Proof.
Working in a local chart, we may assume that X : Dr(0) →E, where Dr(0) is the open disk at
the origin of radius r in the Banach space E. Let U = Dr/2(0), I = [−1, 1] and deﬁne
Φ : R × C1
0(I, U) →C0(I, E)
by
Φ(s, γ)(t) = dγ
dt (t) −sX(γ(t)),
where Ci(I, E) is the Banach space of Ci-maps of I into E, endowed with the ∥· ∥i-norm (see Supplement
2.4B),
Ci
0(I, E) = { f ∈Ci(I, E) | f(0) = 0 }
is a closed subspace of Ci(I, E) and
Ci
0(I, U) = { f ∈Ci
0(I, E) | f(I) ⊂U }
is open in Ci
0(I, E). We ﬁrst show that Φ is a C1-map.
The map d/dt : C1
0(I, E) →C0(I, E) is clearly linear and is continuous since ∥d/dt∥≤1. Moreover, if
dγ/dt = 0 on I, then γ is constant and since γ(0) = 0, it follows γ = 0; that is, d/dt is injective. Given
δ ∈C0(I, E),
γ(t) =
 t
0
δ(s) ds
deﬁnes an element of Ci
0(I, E) with dγ/dt = δ, that is, d/dt is a Banach space isomorphism from C1
0(I, E)
to C0(I, E).
From these remarks and the Ωlemma 2.4.18, it follows that Φ is a C1-map. Moreover, DγΦ(0, 0) = d/dt
is an isommorphism of C1
0(I, E) with C0(I, E). Since Φ(0, 0) = 0, by the implicit function theorem there is
an ε > 0 such that Φ(ε, γ) = 0 has a unique solution γε(t) in C1
0(I, U). The unique integral curve sought is
γ(t) = γε(t/ε), −ε ≤t ≤ε.
■
The same argument also works in the time-dependent case. It also shows that γ varies continuously with
X.
Step 2.
The local ﬂow of a Ck vector ﬁeld X is Ck.
Proof.
First, suppose k = 1. Modify the deﬁnition of Φ in Step 1 by setting Ψ : R × U × C1
0(I, U) →
C0(I, E),
Ψ(s, x, γ)(t) = γ′(t) −sX(x + γ(t)).
As in Step 1, Ψ is a C1-map and DγΨ(0, 0, 0) is an isomorphism, so Ψ(ε, x, γ) = 0 can be locally solved for
γ giving a map
Hε : U →C1
0(I, U),
ε > 0.
The local ﬂow is F(x, t) = x + Hε(x)(t/ε), as in Step 1. By Proposition 2.4.17 (diﬀerentiability of the
evaluation map), F is C1. Moreover, if v ∈E, we have DFt(x) · v = v + (DHε(x) · v)(t/ε), so that the mixed
partial derivative
d
dtDFt(x) · v = 1
ε(DHε(x) · v)
 t
ε


4.1 Vector Fields and Flows
227
exists and is jointly continuous in (t, x). By Exercise 2.4-7, D(dFt(x)/dt) exists and equals (d/dt)(DFt(x)).
Next we prove the result for k ≥2. Consider the Banach space F = Ck−1(cl(U), E) and the map
ωX : F →F; η 
→X ◦η. This map is C1 by the Ωlemma (remarks following Lemma 2.4.18). Regarding
ωX as a vector ﬁeld on F, it has a unique C1 integral curve ηt with η0 = identity, by Step 1. This integral
curve is the local ﬂow of X and is Ck−1 since it lies in F. Since k ≥2, ηt is at least C1 and so one sees that
Dηt = ut satisﬁes dut/dt = DX(ηt) · ut, so by Step 1 again, ut lies in Ck−1. Hence ηt is Ck.
The following is a useful alternative argument for proving the result for k = 1 from that for k ≥2. For
k = 1, let Xn →X in C1, where Xn are C2. By the above, the ﬂows of Xn are C2 and by Step 1, converge
uniformly that is, in C0, to the ﬂow of X. From the equations for Dηtn, we likewise see that Dηtn converges
uniformly to the solution of dut/dt = DX(ηt) · ut, u0 = identity. It follows by elementary analysis (see
Exercise 2.4-10 or Marsden and Hoﬀman [1993, p. 109]) that ηt is C1 and Dηt = ut.
■
This proof works with minor modiﬁcations on manifolds with vector ﬁelds and ﬂows of Sobolev class Hs
or Holder class Ck+α; see Ebin and Marsden [1970] and Bourguignon and Brezis [1974]. In fact the foregoing
proof works in any function spaces for which the Ωlemma can be proved. Abstract axioms guaranteeing
this are given in Palais [1968].
Exercises
⋄4.1-1.
Find an explicit formula for the ﬂow Ft : R2 →R2 of the harmonic oscillator equation ¨x + ω2x = 0,
ω ∈R a constant.
⋄4.1-2.
Show that if (U0, a, F) is a ﬂow box for X, then (U0, a, F−) is a ﬂow box for −X, where F−(u, t) =
F(u, −t) and (−X)(m) = −(X(m)).
⋄4.1-3.
Show that the integral curves of a Cr vector ﬁeld X on an n-manifold can be deﬁned locally in the
neighborhood of a point where X is nonzero by n equations ψi(m, t) = ci = constant, i = 1, . . . , n in the
n + 1 unknowns (m, t). Such a system of equations is called a local complete system of integrals.
Hint: Use the straightening-out theorem.
⋄4.1-4.
Prove the following generalization of Gronwall’s inequality. Supppose v(t) ≥0 satisﬁes
v(t) ≤C +

 t
0
p(s) v(s) ds
 ,
where C ≥0 and p ∈L1. Then
v(t) ≤C exp
 t
0
|p(s)| ds

.
Use this to generalize Example 4.1.23C to allow A to be a time-dependent matrix.
⋄4.1-5.
Let Ft = etX be the ﬂow of a linear vector ﬁeld X on E. Show that the solution of the equation
˙x = X(x) + f(x)
with initial conditions x0 satisﬁes the variation of constants formula
x(t) = etxx0 +
 t
0
e(t−s)Xf(x(s)) ds
⋄4.1-6.
Let F(m, t) be a C∞mapping of M × R to M such that Ft+s = Ft ◦Fs and F0 = identity (where
Ft(m) = F(m, t)). Show that there is a unique C∞vector ﬁeld X whose ﬂow is F.

228
4. Vector Fields and Dynamical Systems
⋄4.1-7.
Let σ(t) be an integral curve of a vector ﬁeld X and let g : M →R. Let τ(t) satisfy τ ′(t) =
g(σ(τ(t))). Then show t 
→σ(τ(t)) is an integral curve of gX. Show by example that even if X is complete,
gX need not be.
⋄4.1-8.
(i)
(Gradient Flows.) Let f : Rn →R be C1 and let X = (∂f/∂x1, . . . , ∂f/∂xn) be the gradient of f.
Let F be the ﬂow of X. Show that f(Ft(x) ≥f(Fs(x)) if t ≥s.
(ii)
Use (i) to ﬁnd a vector ﬁeld X on Rn such that X(0) = 0, X′(0) = 0, yet 0 is globally attracting; that
is, every integral curve converges to 0 as t →∞. This exercise continues in Exercise 4.3-11.
⋄4.1-9.
Let c be a locally Lipschitz increasing function, c(t) > 0 for t ≥0 and assume that the diﬀerential
equation r′(t) = c(r(t)) has the solution with r(0) = r0 ≥0 existing for time t ∈[0, T]. Conclude that
r(t) ≥0 for t ∈[0, T]. Prove the following comparison lemmas.
(i)
If h(t) is a continuous function on [0, T], h(t) ≥0, satisfying h′(t) ≤c(h(t)) on [0, T], h(0) = r0, then
show that h(t) ≤r(t).
Hint: Prove that
 h(t)
r0
dx
c(x) ≤t =
 r(t)
r0
dx
c(x)
and use strict positivity of the integrand.
(ii)
Generalize (i) to the case h(0) ≤r0.
Hint: The function h(t) = h(t) + r0 −h(0) ≤h(t) satisﬁes the hypotheses in (i).
(iii)
If f(t) is a continuous function on [0, T], f(t) ≥0, satisfying
f(t) ≤r0 +
 1
0
c(f(s)) ds
on [0, T], then show that f(t) ≤r(t).
Hint:
h(t) = r0 +
 1
0
c(f(s)) ds ≥f(t)
satisﬁes the hypothesis in (i) since h′(t) = c(f(t)) ≤c(h(t)).
(iv)
If in addition
 ∞
0
dx
c(x) = +∞
show that the solution f(t) ≥0 exists for all t ≥0.
(v)
If h(t) is only continuous on [0, T] and
h(t) ≤r0 +
 t
0
c(h(s)) ds,
show that h(t) ≤r(t) on [0, T].
Hint: Approximate h(t) by a C1-function g(t) and show that g(t) satisﬁes the same inequality as h(t).

4.1 Vector Fields and Flows
229
⋄4.1-10.
(i)
Let X = y2∂/∂x and Y = x2∂/∂y. Show that X and Y are complete on R2 but X + Y is not.
Hint: Note that x3 −y3 = constant and consider an integral curve with x(0) = y(0).
(ii)
Prove the following theorem:
Let H be a Hilbert space and X and Y be locally Lipschitz vector ﬁelds that satisfy the following:
(a)
X and Y are bounded and Lipschitz on bounded sets;
(b)
there is a constant β ≥0 such that
⟨Y (x), x⟩≤β∥x∥2
for all x ∈H;
(c)
there is a locally Lipschitz monotone increasing function c(t) > 0, t ≥0, such that
 ∞
0
dx
c(x) = +∞
and if x(t) is an integral curve of X,
d
dt∥x(t)∥≤c(∥x(t)∥).
Then X, Y and X + Y are positively complete.
Note:
One may assume ∥X(x0)∥≤c(∥x0∥) in (c) instead of (d/dt)∥x(t)∥≤c(∥x(t)∥).
Hint: Find a diﬀerential inequality for (1/2)(d/dt)∥u(t)∥2, where u(t) is an integral curve of
X + Y and then use Exercise 4.1-9iii.
⋄4.1-11.
Prove the following result on the convergence of ﬂows:
Let Xα be locally Lipschitz vector ﬁelds on M for α in some topological space. Suppose the Lipschitz constants
of Xα are locally bounded as α →α(0) and Xα →Xα(0) locally uniformly. Let c(t) be an integral curve
of Xα(0), 0 ≤t ≤T and ε > 0. Then the integral curves cα(t) of Xα with cα(0) = c(0) are deﬁned for
the interval t ∈[0, T −ε] for α suﬃciently close to α(0) and cα(t) →c(t) uniformly in t ∈[0, T −ε] as
α →α(0). If the ﬂows are complete F α
t →Ft locally uniformly. (The vector ﬁelds may be time dependent if
the estimates are locally t-uniform.)
Hint: Show that
∥cα(t) −c(t)∥≤k
 t
0
∥cα(τ) −c(τ)∥dτ
+
 t
0
∥Xα(c(τ)) −Xα(0)(c(τ))∥dτ
and conclude from Gronwall’s inequality that cα(t) →c(t) for α →α(0) since the second term →0. This
estimate shows that cα(t) exists as long as c(t) does on any compact subinterval of [0, T[.
⋄4.1-12.
Prove that the Cr ﬂow of a Cr+1 vector ﬁeld is a C1 function of the vector ﬁeld by utilizing
Supplement 4.1C. (Caution. It is known that the Ck ﬂow of a Ck vector ﬁeld cannot be a C1 function of
the vector ﬁeld; see Ebin and Marsden [1970] for the explanation and further references).
⋄4.1-13 (Nonunique integral curves on non-Hausdorﬀmanifolds).
Let M be the line with two origins (see
Exercise 3.5-8) and consider the vector ﬁeld X : M →TM which is deﬁned by X([x, i]) = x, i = 1, 2; here
[x, i] denotes a point of the quotient manifold M. Show that through every point other than [0, 0] and [0, 1],
there are exactly two integral curves of X. Show that X is complete.
Hint: The two distinct integral curves pass respectively through [0, 0] and [0, 1].

230
4. Vector Fields and Dynamical Systems
⋄4.1-14.
Give another proof of Theorem 4.1.5 using Exercise 2.5-10.
⋄4.1-15.
Give examples of vector ﬁelds satisfying the following conditions:
(i)
on R and S1 with no critical points; generalize to Rn and Tn;
(ii)
on S1 with exactly k critical points; generalize to Tn;
(iii)
on R2 and RP2 with exactly one critical point and all other orbits closed;
(iv)
on the M¨obius band with no critical points and such that the only integral curve intersecting the zero
section is the zero section itself;
(v)
on S2 with precisely two critical points and one closed orbit;
(vi)
on S2 with precisely one critical point and no closed orbit;
(vii)
on S2 with no critical points on a great circle and nowhere tangent to it; show that any such vector
ﬁeld has its integral curves intersecting this great circle at most once;
(viii)
on T2 with no critical points, all orbits closed and winding exactly k times around T2.
⋄4.1-16.
Let π : M →N be a surjective submersion. A vector ﬁeld X ∈X(M) is called π-vertical if
Tπ ◦X = 0. If K is the Klein bottle, show that π : K →S1 given by π([a, b]) = e2πia is a surjective
submersion; see Figure 4.1.6. Prove that K is a non trivial S1-bundle.
✲
✲
✻
❄
❄
✲
K
π
S1
Figure 4.1.6. The Klein bottle as an S1-bundle
Hint: If it were trivial, there would exist a nowhere zero vertical vector ﬁeld on K. In Figure 4.1.6, this
means that arrows go up on the left and down on the right hand side. Follow a path from left to right and
argue by the intermediate value theorem that the vector ﬁeld must vanish somewhere.
4.2
Vector Fields as Diﬀerential Operators
In the previous section vector ﬁelds were studied from the point of view of dynamics; that is in terms of the
ﬂows they generate. Before continuing the development of dynamics, we shall treat some of the algebraic
aspects of vector ﬁelds. The speciﬁc goal of the section is the development of the Lie derivative of functions
and vector ﬁelds and its relationship with ﬂows. One important feature is the behavior of the constructions
under mappings. The operations should be as natural or covariant as possible when subjected to a mapping.
We begin with a discussion of the action of mappings on functions and vector ﬁelds. First, recall some
notation. Let Cr(M, F) denote the space of Cr maps f : M →F, where F is a Banach space, and let Xr(M)
denote the space of Cr vector ﬁelds on M. Both are vector spaces with the obvious operations of addition
and scalar multiplication. For brevity we write
F(M) = C∞(M, R),
Fr(M) = Cr(M, R)
and
X(M) = X∞(M).

4.2 Vector Fields as Diﬀerential Operators
231
Note that Fr(M) has an algebra structure; that is, for f, g ∈Fr(M) the product fg deﬁned by (fg)(m) =
f(m)g(m) obeys the usual algebraic properties of a product such as fg = gf and f(g + h) = fg + fh.
4.2.1 Deﬁnition.
(i)
Let ϕ : M →N be a Cr mapping of manifolds and f ∈Fr(N). Deﬁne the pull-back of f by ϕ by
ϕ∗f = f ◦ϕ ∈Fr(M).
(ii)
If f is a Cr diﬀeomorphism and X ∈Xr(M), the push-forward of X by ϕ is deﬁned by
ϕ∗X = Tϕ ◦X ◦ϕ−1 ∈Xr(N).
Consider local charts (U, χ), χ : U →U ′ ⊂E on M and (V, ψ), ψ : V →V ′ ⊂F on N, and let
(Tχ ◦X ◦χ−1)(u) = (u, X(u)), where X : U ′ →E is the local representative of X. Then from the chain rule
and the deﬁnition of push–forward, the local representative of ϕ∗X is
(Tψ ◦(ϕ∗X) ◦ψ−1)(v) = (v, D(ψ ◦ϕ ◦χ−1)(u) · X(u)),
where v = (ψ ◦ϕ ◦χ−1)(u). The diﬀerent point of evaluation on each side of the equation corresponds to
the necessity of having ϕ−1 in the deﬁnition. If M and N are ﬁnite dimensional, xi are local coordinates on
M and yj local coordinates on N, the preceding formula gives the components of ϕ∗X by
(ϕ∗X)j(y) = ∂ϕj
∂xi (x) Xi(x)
where y = ϕ(x).
We can interchange “pull-back” and “push-forward” by changing ϕ to ϕ−1, that is, deﬁning ϕ∗(resp. ϕ∗)
by ϕ∗= (ϕ−1)∗(resp. ϕ∗= (ϕ−1)∗). Thus the push-forward of a function f on M is ϕ∗f = f ◦ϕ−1 and
the pull-back of a vector ﬁeld Y on N is ϕ∗Y = (Tϕ)−1 ◦Y ◦ϕ (Figure 4.2.1). Notice that ϕ must be a
diﬀeomorphism in order that the pull-back and push-forward operations make sense, the only exception being
pull-back of functions. Thus vector ﬁelds can only be pulled back and pushed forward by diﬀeomorphisms.
However, even when ϕ is not a diﬀeomorphism we can talk about ϕ-related vector ﬁelds as follows.
4.2.2 Deﬁnition.
Let ϕ : M →N be a Cr mapping of manifolds. The vector ﬁelds X ∈Xr−1(M) and
Y ∈Xr−1(N) are called ϕ-related, denoted X ∼ϕ Y , if Tϕ ◦X = Y ◦ϕ.
Note that if ϕ is diﬀeomorphism and X and Y are ϕ-related, then Y = ϕ∗X. In general however, X can
be ϕ-related to more than one vector ﬁeld on N. ϕ-relatedness means that the following diagram commutes:
TM
TN
M
N
Tϕ
ϕ
X
Y
✲
✲
✻
✻
4.2.3 Proposition.
(i) Pull-back and push-forward are linear maps, and
ϕ∗(fg) = (ϕ∗f)(ϕ∗g),
ϕ∗(fg) = (ϕ∗f)(ϕ∗g).

232
4. Vector Fields and Dynamical Systems
ϕ∗ = push forward
M
N
ϕ
objects defined on M
objects defined on N
Figure 4.2.1. Push–forward and pull–back
(ii)
If Xi ∼ϕ Yi, i = 1, 2, and a, b ∈R, then aX1 + bX2 ∼ϕ aY1 + bY2.
(iii)
For ϕ : M →N and ψ : N →P, we have
(ψ ◦ϕ)∗= ϕ∗◦ψ∗
and
(ψ ◦ϕ)∗= ψ∗◦ϕ∗.
(iv)
If X ∈X(M), Y ∈X(N), Z ∈X(P), X ∼ϕ Y , and Y ∼ψ Z, then X ∼ψ◦ϕ Z.
In this proposition it is understood that all maps are diﬀeomorphims with the exception of the pull-back
of functions and the relatedness of vector ﬁelds.
Proof.
(i)
This consists of straightforward veriﬁcations. For example, if Xi ∼ϕ Yi, i = 1, 2, then Tϕ ◦
(aX1 + bX2) = aTϕ ◦X1 + bTϕ ◦X2 = aY1 ◦ϕ + bY2 ◦ϕ, that is, aX1 + bX2 ∼ϕ aY1 + bY2.
(ii)
These relations on functions are simple consequences of the deﬁnition, and the ones on X(P) and X(M)
are proved in the following way using the chain rule:
T(ψ ◦ϕ) ◦X = Tψ ◦Tϕ ◦X = Tψ ◦Y ◦ϕ = Z ◦ψ ◦ϕ.
■
In this development we can replace F(M) by Cr(M, F) with little change; that is, we can replace real-
valued functions by F-valued functions.
The behavior of ﬂows under these operations is as follows:
4.2.4 Proposition.
Let ϕ : M →N be a Cr-mapping of manifolds, X ∈Xr(M) and Y ∈Xr(N). Let
F X
t
and F Y
t
denote the ﬂows of X and Y respectively. Then X ∼ϕ Y iﬀϕ ◦F X
t
= F Y
t ◦ϕ. In particular,
if ϕ is a diﬀeomorphism, then the equality Y = ϕ∗X holds iﬀthe ﬂow of Y is ϕ ◦F X
t
◦ϕ−1. In particular,
(F X
s )∗X = X.

4.2 Vector Fields as Diﬀerential Operators
233
Proof.
Taking the time derivative of the relation (ϕ◦F X
t )(m) = (F Y
t ◦ϕ)(m), for m ∈M, using the chain
rule and deﬁnition of the ﬂow, we get
Tϕ
∂F X
t (m)
∂t

= ∂F Y
y
∂t (ϕ(m)),
that is,
(Tϕ ◦X ◦F X
t )(m) = (Y ◦F Y
t ◦ϕ)(m) = (Y ◦ϕ ◦F X
t )(m),
which is equivalent to Tϕ ◦X = Y ◦ϕ. Conversely, if this relation is satisﬁed, let c(t) = F X
t (m) denote the
integral curve of X through m ∈M. Then
d(ϕ ◦c)(t)
dt
= Tϕ
dc(t)
dt

= Tϕ(X(c(t))) = Y ((ϕ ◦c)(t))
says that ϕ ◦c is the integral curve of Y through ϕ(c(0)) = ϕ(m). By uniqueness of integral curves, we get
(ϕ ◦F X
t )(m) = (ϕ ◦c)(t) = F Y
t (ϕ(m)). The last statement is obtained by taking ϕ = F X
s
for ﬁxed s.
■
We call ϕ◦Ft◦ϕ−1 the push-forward of Ft by ϕ since it is the natural way to construct a diﬀeomorphism
on N out of one on M. See Figure 4.2.2. Thus, Proposition 4.2.4 says that the ﬂow of the push-forward of
a vector ﬁeld is the push-forward of its ﬂow.
Next we deﬁne how vector ﬁelds operate on functions. This is done by means of the directional derivative.
Let f : M →R, so Tf : TM →T R = R × R. Recall that a tangent vector to R at a base point λ ∈R is a
pair (λ, µ), the number µ being the principal part. Thus we can write Tf acting on a vector v ∈TmM in
the form
Tf · v = (f(m), df(m) · v).
M
N
conjugation
c = integral 
curve of X
        = integral 
curve of ϕ∗X
ϕ∗X
X
ϕ
Ft
ϕ ◦c
ϕ ◦Ft ◦ϕ−1
Figure 4.2.2. Pushing forward vector ﬁelds and integral curves
This deﬁnes, for each m ∈M, the element df(m) ∈T ∗
mM. Thus df is a section of T ∗M, a covector ﬁeld,
or one-form.
4.2.5 Deﬁnition.
The covector ﬁeld df : M →T ∗M deﬁned this way is called the diﬀerential of f.
For F-valued functions, f : M →F, where F is a Banach space, a similar deﬁnition gives df(m) ∈
L(TmM, F) and we speak of df as an F-valued one-form.
Clearly if f is Cr, then df is Cr−1. Let us now work out df in local charts for f ∈F(M). If ϕ : U ⊂
M →V ⊂E is a local chart for M, then the local representative of f is the map f : V →R deﬁned by
f = f ◦ϕ−1. The local representative of Tf is the tangent map for local manifolds:
Tf(x, v) = (f(x), Df(x) · v).

234
4. Vector Fields and Dynamical Systems
Thus, the local representative of df is the derivative of the local representative of f. In particular, if M is
ﬁnite dimensional and local coordinates are denoted (x1, . . . , xn), then the local components of df are
(df)i = ∂f
∂xi
The introduction of df leads to the following.
4.2.6 Deﬁnition.
Let f ∈Fr(M) and X ∈Xr−1(M), r ≥1. Deﬁne the directional or Lie derivative
of f along X by
£Xf(m) ≡X[f](m) = df(m) · X(m),
for any m ∈M. Denote by X[f] = df(X) the map m ∈M 
→X[f](m) ∈R. If f is F-valued, the same
deﬁnition is used, but now X[f] is F-valued.
The local representative of X[f] in a chart is given by the function x 
→Df(x) · X(x), where f and X are
the local representatives of f and X. In particular, if M is ﬁnite dimensional then we have
X[f] ≡£Xf =
n
	
i=1
∂f
∂xi Xi.
Evidently if f is Cr and X is Cr−1 then X[f] is Cr−1.
From the chain rule, d(f ◦ϕ) = df ◦Tϕ, where ϕ : N →M is a Cr map of manifolds, r ≥1. For
real–valued functions, Leibniz’ rule gives
d(fg) = fdg + gdf.
(If f is F-valued, g is G-valued and B : F × G →H is a continuous bilinear map of Banach spaces, this
generalizes to d(B(f, g)) = B(df, g) + B(f, dg).)
4.2.7 Proposition.
(i)
Suppose ϕ : M →N is a diﬀeomorphism. Then £X is natural with respect to push-forward by ϕ.
That is, for each f ∈F(M),
£ϕ∗X(ϕ∗f) = ϕ∗£Xf;
in other words, the following diagram commutes:
F(M)
F(N)
F(M)
F(N)
ϕ∗
ϕ∗
£X
£ϕ∗X
✲
✲
❄
❄
(ii)
£X is natural with respect to restrictions. That is, for U open in M and f ∈F(M), £X|U(f|U) =
(£Xf)|U; or if |U : F(M) →F(U) denotes restriction to U, the following diagram commutes:

4.2 Vector Fields as Diﬀerential Operators
235
F(M)
F(U)
F(M)
F(U)
|U
|U
£X
£X|U
✲
✲
❄
❄
Proof.
For (i), if n ∈N then
£ϕ∗X(ϕ∗f)(n) = d(f ◦ϕ−1) · (ϕ∗X)(n)
= d(f ◦ϕ−1)(n) · (Tϕ ◦X ◦ϕ−1)(n)
= df(ϕ−1(n)) · (X ◦ϕ−1)(n) = ϕ∗(£Xf)(n).
(ii) follows from d(f|U) = (df)|U, which itself is clear from the deﬁnition of d.
■
This proposition is readily generalized to F-valued Cr functions.
Since ϕ∗= (ϕ−1)∗, the Lie derivative is also natural with respect to pull-back by ϕ. This has a general-
ization to ϕ-related vector ﬁelds as follows.
4.2.8 Proposition.
Let ϕ : M →N be a Cr map, X ∈Xr−1(M) and Y ∈Xr−1(N). If X ∼ϕ Y , then
£X(ϕ∗f) = ϕ∗£Y f
for all f ∈Cr(N, F); that is, the following diagram commutes:
Cr(N, F)
Cr(M, F)
Cr−1(N, F)
Cr−1(M, F)
ϕ∗
ϕ∗
CY
CX
✲
✲
❄
❄
Proof.
For m ∈M,
£X(ϕ∗f)(m) = d(f ◦ϕ)(m) · X(m) = df(ϕ(m)) · (Tmϕ(X(m)))
= df(ϕ(m)) · Y (ϕ(m)) = df(Y )(ϕ(m)) = (ϕ∗£Y f)(m).
■
Next we show that £X satisﬁes the Leibniz rule.
4.2.9 Proposition.
(i)
The mapping £X : Cr(M, F) →Cr−1(M, F) is a derivation. That is £X is R-linear and for f ∈
Cr(M, F), g ∈Cr(M, G) and B : F × G →H a bilinear map
£X(B(f, g)) = B(£Xf, g) + B(f, £Xg).
In particular, for real-valued functions, £X(fg) = g£Xf + f£Xg.

236
4. Vector Fields and Dynamical Systems
(ii)
If c is a constant function, £Xc = 0.
Proof.
Part (i) follows from the Leibniz rule for d and the deﬁnition £Xf. Part (ii) results from the
deﬁnition.
■
The connection between £Xf and the ﬂow of X is as follows.
4.2.10 Theorem (Lie Derivative Formula for Functions).
Suppose f ∈Cr(M, F), X ∈Xr−1(M), and X
has a ﬂow Ft. Then
d
dtF ∗
t f = F ∗
t £Xf
Proof.
By the chain rule, the deﬁnition of the diﬀerential of a function and the ﬂow of a vector ﬁeld,
d
dt(F ∗
t f)(m) = d
dt(f ◦Ft)(m) = df(Ft(m)) · dFt(m)
dt
= df(Ft(m)) · X(Ft(m)) = df(X)(Ft(m))
= (£Xf)(Ft(m)) = (F ∗
t £Xf)(m).
■
As an application of the Lie derivative formula, we consider the problem of solving a partial diﬀerential
equation on Rn+1 of the form
∂f
∂t (x, t) =
n
	
i=1
Xi(x) ∂f
∂xi (x, t)
(P)
with initial condition f(x, 0) = g(x) for given smooth functions Xi(x), i = 1, . . . , n, g(x) and a scalar
unknown f(x, t).
4.2.11 Proposition.
Suppose X = (X1, . . . , Xn) has a complete ﬂow Ft. Then f(x, t) = g(Ft(x)) is a
solution of the foregoing problem (P). (See Exercise 4.2-3 for uniqueness.)
Proof.
∂f
∂t = d
dtF ∗
t g = F ∗
t £Xg = £X(F ∗
t g) = X[f].
■
Thus, one can solve this scalar equation by computing the orbits of X and pushing (or “dragging along”)
the graph of g by the ﬂow of X; see Figure 4.2.3. These trajectories of X are called characteristics of (P).
(As we shall see below, the vector ﬁeld X in (P) can be time dependent.)
4.2.12 Example.
Solve the partial diﬀerential equation
∂f
∂t = (x + y)
∂f
∂x −∂f
∂y

,
with initial condition f(x, y, 0) = x2 + y2.
♦
Solution.
The vector ﬁeld X(x, y) = (x + y, −x −y) has a complete ﬂow Ft(x, y) = ((x + y)t + x, −(x +
y)t + y), so that the solution of the previous partial diﬀerential equation is given by
f(x, y, t) = 2(x + y)2t2 + x2 + y2 + 2(x2 −y2)t.
♦

4.2 Vector Fields as Diﬀerential Operators
237
level curves of
level circles of 
orbits of X
g
g ◦Ft
Figure 4.2.3. Solving a PDE using characteristics.
Now we turn to the question of using the Lie derivative to characterize vector ﬁelds. We will prove that
any derivation on functions uniquely deﬁnes a vector ﬁeld. Because of this, derivations can be (and often
are) used to deﬁne vector ﬁelds. (See the introduction to §3.3.) In the proof we shall need to localize things
in a smooth way, hence the following lemma of general utility is proved ﬁrst.
4.2.13 Lemma.
Let E be a Cr Banach space, that is, one whose norm is Cr on E\{0}, r ≥1. Let U1 be
an open ball of radius r1 about x0 and U2 an open ball of radius r2, r1 < r2. Then there is a Cr function
h : E →R such that h is one on U1 and zero outside U2.
We call h a bump function. Later we will prove more generally that on a manifold M, if U1 and U2 are
two open sets with cl(U1) ⊂U2, there is an h ∈Fr(M) such that h is one on U1 and is zero outside U2.
Proof.
By a scaling and translation, we can assume that U1 and U2 are balls of radii 1 and 3 and centered
at the origin. Let θ : R →R be given by
θ(x) = exp

−1
1 −|x|2

if |x| < 1
and set
θ(x) = 0,
if |x| ≥1.
(See the remarks following Theorem 2.4.15.) Now set
θ1(s) =
 s
−∞
θ(t) dt
 ∞
−∞
θ(t) dt
so θ1 is a C∞function and is 0 if s < −1, and 1 if s > 1. Let θ2(s) = θ1(2 −s), so θ2 is a C∞function that
is 1 if s < 1 and 0 if s > 3. Finally, let h(x) = θ2(∥x∥).
■
The norm on a real Hilbert space is C∞away from the origin. The order of diﬀerentiability of the norms
of some concrete Banach spaces is also known; see Bonic and Frampton [1966], Yamamuro [1974], and
Supplement 5.5B.
4.2.14 Corollary.
Let M be a Cr manifold modeled on a Cr Banach space. If αm ∈T ∗
mM, then there is
an f ∈Fr(M) such that df(m) = αm.
Proof.
If M = E, so TmE ∼= E, let f(x) = αm(x), a linear function on E. Then df is constant and equals
αm.
The general case can be reduced to E using a local chart and a bump function as follows. Let ϕ : U →
U ′ ⊂E be a local chart at m with ϕ(m) = 0 and such that U ′ contains the ball of radius 3. Let ˜αm be the

238
4. Vector Fields and Dynamical Systems
local representative of αm and let h be a bump function, 1 on the ball of radius 1 and zero outside the ball
of radius 2. let f(x) = ˜αm(x) and let
f =

(hf) ◦ϕ,
on U
0,
on M\U.
It is easily veriﬁed that f is Cr and df(m) = αm.
■
4.2.15 Proposition.
(i)
Let M be a Cr manifold modeled on a Cr Banach space. The collection of operators £X for X ∈Xr(M),
deﬁned on Cr(M, F) and taking values in Cr−1(M, F) forms a real vector space and an Fr(M)-module
with (f£X)(g) = f(£Xg), and is isomorphic to Xr(M) as a real vector space and as an Fr(M)-module.
In particular, £X = 0 iﬀX = 0; and £fX = f£X.
(ii)
Let M be any Cr manifold. If £Xf = 0 for all f ∈Cr(U, F), for all open subsets U of M, then X = 0.
Proof.
(i)
Consider the map σ : X 
→£X. It is obviously R and Fr(M) linear; that is,
£X1+fX2 = £X1 + f£X2.
To show that it is one–to–one, we must show that £X = 0 implies X = 0. But if £Xf(m) = 0, then
df(m) · X(m) = 0 for all f. Hence, αm(X(m)) = 0 for all αm ∈T ∗
mM by Corollary 4.2.14. Thus
X(m) = 0 by the Hahn–Banach theorem.
(ii)
This has an identical proof with the only exception that one works in a local chart, so it is not necessary
to extend a linear functional to the entire manifold M as in Corollary 4.2.14. Thus the condition on
the diﬀerentiability of the norm of the model space of M can be dropped.
■
4.2.16 Theorem (Derivation Theorem).
(i)
If M is ﬁnite dimensional and C∞, the collection of all
derivations on F(M) is a real vector space isomorphic to X(M). In particular, for each derivation θ
there is a unique X ∈X(M) such that θ = £X.
(ii)
Let M be a C∞manifold modeled on a C∞Banach space E, that is, E has a C∞norm away from
the origin. The collection of all (R-linear) derivations on C∞(M, F) (for all Banach spaces F) forms
a real vector space isomorphic to X(M).
Proof.
We prove (ii) ﬁrst. Let θ be a derivation. We wish to construct X such that θ = £X. First of
all, note that θ is a local operator; that is, if h ∈C∞(M, F) vanishes on a neighborhood V of m, then
θ(h)(m) = 0. Indeed, let g be a bump function equal to one on a neighborhood of m and zero outside V .
Thus h = (1 −g)h and so
θ(h)(m) = θ(1 −g)(m) · h(m) + θ(h)(m)(1 −g(m)) = 0.
(4.2.1)
If U is an open set in M, and f ∈C∞(U, F) deﬁne (θ|U)(f)(m) = θ(gf)(m), where g is a bump function
equal to one on a neighborhood of m and zero outside U. By the previous remark, (θ|U)(f)(m) is independent
of g, so θ|U is well deﬁned. For convenience we write θ = θ|U.
Let (U, ϕ) be a chart on M, m ∈U, and f ∈C∞(M, F) where ϕ : U →U ′ ⊂E; we can write, for x ∈U ′
and a = ϕ(m),
(ϕ∗f)(x) = (ϕ∗f)(a) +
 1
0
∂
∂t(ϕ∗f)[a + t(x −a)] dt
= (ϕ∗f)(a) +
 1
0
D(ϕ∗f)[a + t(x −a)] · (x −a) dt

4.2 Vector Fields as Diﬀerential Operators
239
This formula holds in some neighborhood ϕ(V ) of a. Hence for u ∈V we have
f(u) = f(m) + g(u) · (ϕ(u) −a),
(4.2.2)
where g ∈C∞(V, L(E, F)) is given by
g(u) =
 1
0
D(ϕ∗f)[a + t(ϕ(u) −a)]dt.
Applying θ to equation (4.2.2) at u = m gives
θf(m) = g(m) · (θϕ)(m) = D(ϕ∗f)(a) · (θϕ)(m).
(4.2.3)
Since θ was given globally, the right hand side of equation (4.2.3) is independent of the chart. Now deﬁne
X on U by its local representative
Xϕ(x) = (x, θ(ϕ)(u)),
where x = ϕ(u) ∈U ′. It follows that X|U is independent of the chart ϕ and hence X ∈X(M). Then, for
f ∈C∞(M, F), the local representative of £Xf is
D(f ◦ϕ−1)(x) · Xϕ(x) = D(f ◦ϕ−1)(x) · (θϕ)(u) = θf(u).
Hence £X = θ. Finally, uniqueness follows from Proposition 4.2.15.
The vector derivative property was used only in establishing equations (4.2.1) and (4.2.3). Thus, if M is
ﬁnite dimensional and θ is a derivation on F(M), we have as before
f(u) = f(m) + g(u) · (ϕ(u) −a) = f(m) +
n
	
i=1
(ϕi(u) −ai)gi(u),
where gi ∈F(V ) and
gi(m) = ∂(ϕ∗f)(u)
∂Xi

u=a
,
a = (a1, . . . , an).
Hence equation (4.2.3) becomes
θf(m) =
n
	
i=1
gi(m) θ(ϕi)(m) =
n
	
i=1
∂
∂xi (ϕ∗f)(a) θ(ϕi)(m)
and this is again independent of the chart. Now deﬁne X on U by its local representative
(x, θ(ϕ1)(u), . . . , θ(ϕn)(u))
and proceed as before.
■
Remark.
There is a diﬃculty with this proof for Cr manifolds and derivations mapping Cr to Cr−1.
Indeed in equation (4.2.2), g is only Cr−1 if f is Cr, so θ need not be deﬁned on g. Thus, one has to regard
θ as deﬁned on Cr−1-functions and taking values in Cr−2-functions. Therefore θ(ϕ) is only Cr−1 and so the
vector ﬁeld it deﬁnes is also only Cr−2. Then the above proof shows that £X and θ coincide on Cr-functions
on M. In Supplement 4.2D we will prove that £X and θ are in fact equal on Cr−1-functions, but the proof
requires a diﬀerent argument.
♦

240
4. Vector Fields and Dynamical Systems
For ﬁnite-dimensional manifolds, the preceding theorem provides a local basis for vector ﬁelds. If (U, ϕ),
ϕ : U →V ⊂Rn is a chart on M deﬁning the coordinate functions xi : U →R, deﬁne n derivations ∂/∂xi
on F(U) by
∂f
∂xi = ∂(f ◦ϕ−1)
∂xi
◦ϕ.
These derivations are linearly independent with coeﬃcients in F(U), for if
n
	
i=1
f i ∂
∂xi = 0, then
 n
	
i=1
f i ∂
∂xi

(xj) = f j = 0 for all j = 1, . . . , n,
since (∂/∂xi)xj = δj
i . By Theorem 4.2.16, (∂/∂xi) can be identiﬁed with vector ﬁelds on U. Moreover, if
X ∈X(M) has components X1, . . . , Xn in the chart ϕ, then
£Xf = X[f] =
n
	
i=1
Xi ∂f
∂xi =
 n
	
i=1
Xi ∂
∂xi

f,
i.e.,
X =
n
	
i=1
Xi ∂
∂xi.
Thus the vector ﬁelds (∂/∂xi), i = 1, . . . , n form a local basis for the vector ﬁelds on M. It should be
mentioned however that a global basis of X(M), that is, n vector ﬁelds, X1, . . . , Xn ∈X(M) that are
linearly independent over F(M) and span X(M), does not exist in general. Manifolds that do admit such
a global basis for X(M) are called parallelizable. It is straightforward to show that a ﬁnite-dimensional
manifold is parallelizable iﬀits tangent bundle is trivial. For example, it is shown in diﬀerential topology
that S3 is parallelizable but S2 is not (see Supplement 7.5A).
This completes the discussion of the Lie derivative on functions. Turning to the Lie derivative on vector
ﬁelds, let us begin with the following.
4.2.17 Proposition.
If X and Y are Cr vector ﬁelds on M, then
[£X, £Y ] = £X ◦£Y −£Y ◦£X
is a derivation mapping Cr+1(M, F) to Cr−1(M, F).
Proof.
More generally, let θ1 and θ2 be two derivations mapping Cr+1 to Cr and Cr to Cr−1. Clearly
[θ1, θ2] = θ1 ◦θ2 −θ2 ◦θ1 is linear and maps Cr+1 to Cr−1. Also, if f ∈Cr+1(M, F), g ∈Cr+1(M, G), and
B ∈L(F, G; H), then
[θ1, θ2] (B(f, g)) = (θ1 ◦θ2)(B(f, g)) −(θ2 ◦θ1)(B(f, g))
= θ1{B(θ2(f), g) + B(f, θ2(g))} −θ2{B(θ1(f), g)
+ B(f, θ1(g))}
= B(θ1(θ2(f)), g) + B(θ2(f), θ1(g)) + B(θ1(f), θ2(g))
+ B(f, θ1(θ2(g))) −B(θ2(θ1(f)), g) −B(θ1(f), θ2(g))
−B(θ2(f), θ1(g)) −B(f, θ2(θ1(g)))
= B([θ1, θ2] (f), g) + B(f, [θ1, θ2] (g)).
■
Because of Theorem 4.2.16 the following deﬁnition can be given.
4.2.18 Deﬁnition.
Let M be a manifold modeled on a C∞Banach space and X, Y ∈X∞(M). Then
[X, Y ] is the unique vector ﬁeld such that £[X,Y ] = [£X, £Y ]. This vector ﬁeld is also denoted £XY and is
called the Lie derivative of Y with respect to X, or the Jacobi–Lie bracket of X and Y .

4.2 Vector Fields as Diﬀerential Operators
241
Even though this deﬁnition is useful for Hilbert manifolds (in particular for ﬁnite-dimensional manifolds),
it excludes consideration of Cr vector ﬁelds on Banach manifolds modeled on nonsmooth Banach spaces,
such as Lp function spaces for p not even. We shall, however, establish an equivalent deﬁnition, which makes
sense on any Banach manifold and works for Cr vector ﬁelds. This alternative deﬁnition is based on the
following result.
4.2.19 Theorem (Lie Derivative Formula for Vector Fields).
Let M be as in Deﬁnition 4.2.18, X, Y ∈
X(M), and let X have (local) ﬂow Ft. Then
d
dt(F ∗
t Y ) = F ∗
t (£XY )
(at those points where Ft is deﬁned).
Proof.
If t = 0 this formula becomes
d
dt

t=0
F ∗
t Y = £XY.
(4.2.4)
Assuming equation (4.2.4) for the moment,
d
dt(F ∗
t Y ) = d
ds

s=0
F ∗
t+sY = F ∗
t
d
ds

s=0
F ∗
s Y = F ∗
t £XY.
Thus the formula in the theorem is equivalent to equation (4.2.4), which is proved in the following way. Both
sides of equation (4.2.4) are clearly vector derivations. In view of Theorem 4.2.16, it suﬃces then to prove
that both sides are equal when acting on an arbitrary function f ∈C∞(M, F). Now
d
dt

t=0
(F ∗
t Y )[f](m) = d
dt

t=0
{£F ∗
t Y [F ∗
t (F ∗
−tf)]}(m)
= d
dt

t=0
F ∗
t (Y [F ∗
−tf])(m),
by Proposition 4.2.7(i). Using Theorem 4.2.10 and Leibniz’ rule, this becomes
X[Y [f]](m) −Y [X[f]](m) = [X, Y ][f](m).
■
Since the formula for £XY in equation (4.2.4) does not use the fact that the norm of E is C∞away from
the origin, we can state the following deﬁnition of the Lie derivative on any Banach manifold M.
4.2.20 Deﬁnition (Dynamic Deﬁnition of Jacobi–Lie bracket).
If X, Y ∈Xr(M), r ≥1 and X has ﬂow
Ft, the Cr−1 vector ﬁeld £XY = [X, Y ] on M deﬁned by
[X, Y ] = d
dt

t=0
(F ∗
t Y )
is called the Lie derivative of Y with respect to X, or the Lie bracket of X and Y .
Theorem 4.2.19 then shows that this deﬁnition agrees with the earlier one, Deﬁnition 4.2.18:
4.2.21 Proposition.
Let X, Y ∈Xr(M), r ≥1. Then [X, Y ] = £XY is the unique Cr−1 vector ﬁeld on
M satisfying
[X, Y ][f] = X[Y [f]] −Y [X[f]]
for all f ∈Cr+1(U, F), where U is open in M.

242
4. Vector Fields and Dynamical Systems
The derivation approach suggests that if X, Y ∈Xr(M) then [X, Y ] might only be Cr−2, since [X, Y ]
maps Cr+1 functions to Cr−1 functions, and diﬀerentiates them twice. However Deﬁnition 4.2.20 (and the
local expression equation (4.2.6) below) show that [X, Y ] is in fact Cr−1.
4.2.22 Proposition.
The bracket [X, Y ] on X(M), together with the real vector space structure X(M),
form a Lie algebra. That is,
(i)
[ , ] is R bilinear;
(ii)
[X, X] = 0 for all X ∈X(M);
(iii)
[X, [Y, Z]] + [Y, [Z, X]] + [Z, [X, Y ]] = 0 for all X, Y, Z ∈X(M) (Jacobi identity).
The proof is straightforward, applying the brackets in question to an arbitrary function. Unlike X(M),
the space Xr(M) is not a Lie algebra since [X, Y ] ∈Xr−1(M) for X, Y ∈Xr(M). (i) and (ii) imply that
[X, Y ] = −[Y, X], since [X + Y, X + Y ] = 0 = [X, X] + [X, Y ] + [Y, X] + [Y, Y ]. We can describe (iii) by
writing £X as a Lie bracket derivation:
£X[Y, Z] = [£XY, Z] + [Y, £XZ].
Strictly speaking we should be careful using the same symbol £X for both deﬁnitions of £Xf and £XY .
However, the meaning is generally clear from the context. The analog of Proposition 4.2.7 on the vector ﬁeld
level is the following.
4.2.23 Proposition.
(i)
Let ϕ : M →N be a diﬀeomorphism and X ∈X(M). Then £X : X(M) →
X(M) is natural with respect to push-forward by ϕ. That is,
£ϕ∗Xϕ∗Y = ϕ∗£XY,
i.e., [ϕ∗X, ϕ∗Y ] = ϕ∗[X, Y ], i.e., the following diagram commutes:
X(M)
X(N)
X(M)
X(N)
ϕ∗
ϕ∗
£X
£ϕ∗X
✲
✲
❄
❄
(ii)
£X is natural with respect to restrictions. That is, for U ⊂M open, [X|U, Y |U] = [X, Y ]|U; or
the following diagram commutes:
X(M)
X(U)
X(M)
X(U)
|U
|U
£X
£X|U
✲
✲
❄
❄
Proof.
For (i), let f ∈F(V ), V be open in N, and ϕ(m) = n ∈V . By Proposition 4.2.7(i), for any
Z ∈X(M)
((ϕ∗Z)[f])(n) = Z[f ◦ϕ](m),

4.2 Vector Fields as Diﬀerential Operators
243
so we get from Proposition 4.2.21
(ϕ∗[X, Y ])[f](n) = [X, Y ][f ◦ϕ](m)
= X[Y [f ◦ϕ]](m) −Y [X[f ◦ϕ]](m)
= X[(ϕ∗Y )[f] ◦ϕ](m) −Y [(ϕ∗X)[f] ◦ϕ](m)
= (ϕ∗X)[(ϕ∗Y )[f]](n) −(ϕ∗Y )[(ϕ∗X)[f]](n)
= [ϕ∗X, ϕ∗Y ][f](n).
Thus, ϕ∗[X, Y ] = [ϕ∗X, ϕ∗Y ] by Proposition 4.2.15(ii). (ii) follows from the fact that d(f|U) = df|U.
■
Let us compute the local expression for [X, Y ]. Let ϕ : U →V ⊂E be a chart on M and let the local
representatives of X and Y be X and Y respectively, so X, Y : V →E. By Proposition 4.2.23, the local
representative of [X, Y ] is [X, Y ]. Thus,
[X, Y ][f](x) = X[Y [f]](x) −Y [X[f]](x)
= D(Y [f])(x) · X(x) −D(X[f])(x) · Y (x).
Now Y [f](x) = Df(x) · Y (x) and its derivative may be computed by the product rule. The terms involving
the second derivative of f cancel by symmetry of D2f(x) and so we are left with
Df(x) · {DY (x) · X(x) −DX(x) · Y (x)}.
Thus the local representative of [X, Y ] is
[X, Y ] = DY · X −DX · Y.
(4.2.5)
If M is n-dimensional and the chart ϕ gives local coordinates (x1, . . . , xn) then this calculation gives the
components of [X, Y ] as
[X, Y ]j =
n
	
i=1
Xi ∂Y j
∂xi −Y i ∂Xj
∂xi
(4.2.6)
that is, [X, Y ] = (X · ∇)Y −(Y · ∇)X.
Part (i) of Proposition 4.2.23 has an important generalization to ϕ-related vector ﬁelds. For this, however,
we need ﬁrst the following preparatory proposition.
4.2.24 Proposition.
Let ϕ : M →N be a Cr map of Cr manifolds, X ∈Xr−1(M), and X′ ∈Xr−1(N).
Then X ∼ϕ X′ iﬀ(X′[f]) ◦ϕ = X[f ◦ϕ] for all f ∈F1(V ), where V is open in N.
Proof.
By deﬁnition, ((X′[f]) ◦ϕ)(m) = df(ϕ(m)) · X′(ϕ(m)). By the chain rule,
X[f ◦ϕ](m) = d(f ◦ϕ)(m) · X(m) = df(ϕ(m)) · Tmϕ(X(m)).
If X ∼ϕ X′, then Tϕ ◦X = X′ ◦ϕ and we have the desired equality. Conversely, if X[f ◦ϕ] = (X′[f]) ◦ϕ
for all f ∈F1(V ), and all V open in N, choosing V to be a chart domain and f the pull-back to V of linear
functionals on the model space of N, we conclude that αn ·(X′ ◦ϕ)(m) = αn ·(Tϕ◦X)(m), where n = ϕ(m),
for all αn ∈T ∗
nN. Using the Hahn–Banach theorem, we deduce that (X′ ◦ϕ)(m) = (Tϕ ◦X)(m), for all
m ∈M.
■
It is to be noted that under diﬀerentiability assumptions on the norm on the model space of N (as in
Theorem 4.2.16), the condition “for all f ∈F1(V ) and all V ⊂N” can be replaced by “for all f ∈F1(N)”
by using bump functions. This holds in particular for Hilbert (and hence for ﬁnite-dimensional) manifolds.

244
4. Vector Fields and Dynamical Systems
4.2.25 Proposition.
Let ϕ : M →N be a Cr map of manifolds, X, Y ∈Xr−1(M), and X′, Y ′ ∈Xr−1(N).
If X ∼ϕ X′ and Y ∼ϕ Y ′, then [X, Y ] ∼ϕ [X′, Y ′].
Proof.
By Proposition 4.2.24 it suﬃces to show that ([X′, Y ′][f]) ◦ϕ = [X, Y ][f ◦ϕ] for all f ∈F1(V ),
where V is open in N. We have
([X′, Y ′][f]) ◦ϕ = X′[Y ′[f]] ◦ϕ −Y ′[X′[f]] ◦ϕ
= X[(Y ′[f]) ◦ϕ] −Y [(X′[f]) ◦ϕ]
= X[Y [f ◦ϕ]] −Y [X[f ◦ϕ]]
= [X, Y ][f ◦ϕ].
■
The analog of Proposition 4.2.9 is the following.
4.2.26 Proposition.
For every X ∈X(M), the operator £X is a derivation on (F(M), X(M)). That is,
£X is R-linear and £X(fY ) = (£Xf)Y + f(£XY ).
Proof.
For g ∈C∞(U, E), where U is open in M, we have
[X, fY ][g] = £X(£fY g) −£fY £Xg
= £X(f£Y g) −f£Y £Xg
= (£Xf)£Y g + f£X£Y g −f£Y £Xg,
so
[X, fY ] = (£Xf) Y + f[X, Y ] by Proposition 4.2.15(ii).
■
Commutation of vector ﬁelds is characterized by their ﬂows in the following way.
4.2.27 Proposition.
Let X, Y ∈Xr(M), r ≥1, and let Ft, Gt denote their ﬂows. The following are
equivalent.
(i)
[X, Y ] = 0;
(ii)
F ∗
t Y = Y ;
(iii)
G∗
t X = X;
(iv)
Ft ◦Gs = Gs ◦Ft.
(In (ii)–(iv), equality is understood, as usual, where the expressions are deﬁned.)
Proof.
Ft ◦Gs = Gs ◦Ft iﬀGs = Ft ◦Gs ◦F −1
t
, which by Proposition 4.2.4 is equivalent to Y = F ∗
t Y ;
that is, (iv) is equivalent to (ii). Similarly (iv) is equivalent to (iii). If F ∗
t Y = Y , then
[X, Y ] = d
dt

t=0
F ∗
t Y = 0.
Conversely, if [X, Y ] = £XY = 0, then
d
dtF ∗
t Y = d
ds

s=0
F ∗
t+sY = F ∗
t [X, Y ] = 0
so that F ∗
t Y is constant in t. For t = 0, however, its value is Y , so that F ∗
t Y = Y and we have thus showed
that (i) and (ii) are equivalent. Similarly (i) and (iii) are equivalent.
■

4.2 Vector Fields as Diﬀerential Operators
245
Just as in Theorem 4.2.10, the formula for the Lie derivative involving the ﬂow can be used to solve special
types of ﬁrst-order linear n × n systems of partial diﬀerential equations. Consider the ﬁrst-order system:
∂Y i
∂t (x, t) =
n
	
j=1

Xj(x)∂Y i
∂xj (x, t) −Y j(x, t)∂Xi(x)
∂xj

(Pn)
with initial conditions Y i(x, 0) = gi(x) for given functions Xi(x), gi(x) and scalar unknowns Y i(x, t),
i = 1, . . . , n, where x = (x1, . . . , xn).
4.2.28 Proposition.
Suppose X = (X1, . . . , Xn) has a complete ﬂow Ft. Then letting Y = (Y 1, . . . , Y n)
and G = (g1, . . . , gn), Y = F ∗
t G is a solution of the foregoing problem (Pn). (See Exercise 4.2-3 for unique-
ness.)
Proof.
∂Y
∂t = d
dtF ∗
t G = F ∗
t [X, G] = [F ∗
t X, F ∗
t G] = [X, Y ]
since F ∗
t X = X and Y = F ∗
t G. The expression in the problem (Pn) is by equation (4.2.6) the ith component
of [X, Y ].
■
4.2.29 Example.
Solve the system of partial diﬀerential equations:
∂Y 1
∂t
= (x + y)∂Y 1
∂x −(x + y)∂Y 1
∂y −Y 1 −Y 2,
∂Y 2
∂t
= (x + y)∂Y 2
∂x −(x + y)∂Y 2
∂y + Y 1 + Y 2
with initial conditions Y 1(x, y, 0) = x, Y 2(x, y, 0) = y2. The vector ﬁeld X(x, y) = (x + y, −x −y) has the
complete ﬂow Ft(x, y) = ((x + y)t + x, −(x + y)t + y), so that the solution is given by Y (x, y, t) = F ∗
t (x, y2);
that is,
Y 1(x, y, t) = ((x + y)t + x)(1 −t) −t[y −(x + y)t]2
Y 2(x, y, t) = t((x + y)t + x) + (t + 1)[y −(x + y)t]2.
♦
In later chapters we will need a ﬂow type formula for the Lie derivative of a time-dependent vector ﬁeld, In
§4.1 we discussed the existence and uniqueness of solutions of a time-dependent vector ﬁeld. Let us formalize
and recall the basic facts.
4.2.30 Deﬁnition.
A Cr time-dependent vector ﬁeld is a Cr map X : R × M →TM such that
X(t, m) ∈TmM for all (t, m) ∈R × M; that is, Xt ∈Xr(M), where Xt(m) = X(t, m). The time-
dependent ﬂow or evolution operator Ft,s of X is deﬁned by the requirement that t 
→Ft,s(m) be the
integral curve of X starting at m at time t = s; that is,
d
dtFt,s(m) = X(t, Ft,s(m))
and
Fs,s(m) = m.
By uniqueness of integral curves we have Ft,s ◦Fs,r = Ft,r (replacing the ﬂow property Ft+s = Ft ◦Fs),
and Ft,t = identity. It is customary to write Ft = Ft,0. If X is time independent, Ft,s = Ft−s. In general
F ∗
t Xt ̸= Xt. However, the basic Lie derivative formulae still hold.
4.2.31 Theorem.
Let Xt ∈Xr(M), r ≥1 for each t and suppose X(t, m) is continuous in (t, m). Then
Ft,s is of class Cr and for f ∈Cr+1(M, F), and Y ∈Xr(M), we have
(i)
d
dtF ∗
t,sf = F ∗
t,s(£Xtf), and

246
4. Vector Fields and Dynamical Systems
(ii) d
dtF ∗
t,sY = F ∗
t,s([Xt, Y ]) = F ∗
t,s(£XtY ).
Proof.
That Ft,s is Cr was proved in §4.1. The proof of (i) is a repeat of Theorem 4.2.10:
d
dt(F ∗
t,sf)(m) = d
dt(f ◦Ft,s)(m)
= df(Ft,s(m))dFt,s(m)
dt
= df(Ft,s(m)) · Xt(Ft,s(m))
= (£Xtf)(Ft,s(m))
= F ∗
t,s(£Xtf)(m).
For vector ﬁelds, note that by Proposition 4.2.7(i),
(F ∗
t,sY )[f] = F ∗
t,s(Y [F ∗
t,sf])
(4.2.7)
since Fs,t = F −1
t,s . The result (ii) will be shown to follow from (i), equation (4.2.7), and the next lemma.
4.2.32 Lemma.
The following identity holds:
d
dtF ∗
s,tf = −Xt[F ∗
s,tf].
Proof.
Diﬀerentiating Fs,t ◦Ft,s = identity in t, we get the backward diﬀerential equation:
d
dtFs,t = −TFs,t ◦X
Thus
d
dtF ∗
s,tf(m) = −df(Fs,t(m)) · TFs,t(Xt(m))
= −dF(f ◦Fs,t) · Xt(m) = −Xt[f ◦Fs,t](m).
▼
Thus from equation (4.2.7) and (i),
d
dt(F ∗
t,sY )[f] = F ∗
t,s(Xt[Y [F ∗
t,sf]]) −F ∗
t,s(Y [Xt[F ∗
t,sf]]),
By Proposition 4.2.21 and equation (4.2.7), this equals (F ∗
t,s[Xt, Y ])[f].
■
If f and Y are time dependent, then (i) and (ii) read
d
dtF ∗
t,sf = F ∗
t,s
∂f
∂t + £Xtf

(4.2.8)
and
d
dtF ∗
t,sY = F ∗
t,s
∂Y
∂t + [Xt, Yt]

.
(4.2.9)
Unlike the corresponding formula for time-independent vector ﬁelds, we generally have
F ∗
t,s(£Xtf) ̸= £Xt(F ∗
t,sf)
and
F ∗
t,s(£XtY ) ̸= £F ∗
t,sXtXt(F ∗
t,sY ).

4.2 Vector Fields as Diﬀerential Operators
247
Time-dependent vector ﬁelds on M can be made into time-independent ones on a bigger manifold. Let
t ∈X(R×M) denote the vector ﬁeld which is deﬁned by t(s, m) = ((s, 1), 0m) ∈T(s,m)(R×M) ∼= TsR×TmM.
Let the suspension of X be the vector ﬁeld X′ ∈X(R × M) where X′(t, m) = ((t, 1), X(t, m)) and observe
that X′ = t + X. Since b : I →M is an integral curve of X at m iﬀb′(t) = X(t, b(t)) and b(0) = m, a curve
c : I →R × M is an integral curve of X′ at (0, m) iﬀc(t) = (t, b(t)). Indeed, if c(t) = (a(t), b(t)) then c(t)
is an integral curve of X′ iﬀc′(t) = (a′(t), b′(t)) = X′(c(t)); that is a′(t) = 1 and b′(t) = X(a(t), b(t)). Since
a(0) = 0, we get a(t) = t. These observations are summarized in the following (see Figure 4.2.4).
m
R
M
integral curve of X′
integral curve of X
Figure 4.2.4. Suspension of a vector ﬁeld
4.2.33 Proposition.
Let X be a Cr-time-dependent vector ﬁeld on M with evolution operator Ft,s. The
ﬂow Ft of the suspension X′ ∈Xr(R × M) is given by Ft(s, m) = (t + s, Ft+s,s(m)).
Proof.
In the preceding notations, b(t) = Ft,0(m), c(t) = Ft(0, m) = (t, Ft,0(m)), and so the statement is
proved for s = 0. In general, note that Ft(s, m) = Ft+s(0, F0,s(m)) since t 
→Ft+s(0, F0,s(m)) is the integral
curve of X′, which at t = 0 passes through
Fs(0, F0,s(m)) = (s, (Fs,0 ◦F0,s)(m)) = (s, m).
Thus
Ft(s, m) = Ft+s(0, F0,s(m))
= (t + s, (Ft+s,0 ◦F0,s)(m))
= (t + s, Ft+s,s(m)).
■
Supplement 4.2A
Product formulas for the Lie bracket
This box is a continuation of Supplement 4.1A and gives the ﬂow of the Lie bracket [X, Y ] in terms of the
ﬂows of the vector ﬁelds X, Y ∈X(M).

248
4. Vector Fields and Dynamical Systems
4.2.34 Proposition.
Let X, Y ∈X(M) have ﬂows Ft and Gt. If Bt denotes the ﬂow of [X, Y ], then for
x ∈M,
Bt(x) = lim
n→∞

G−√
t/n ◦F−√
t/n ◦G√
t/n ◦F√
t/n
n
(x),
t ≥0.
Proof.
Let
Kε(x) =

G−√ε ◦F−√ε ◦G√ε ◦F√ε

(x),
ε ≥0.
The claimed formula follows from Proposition 4.1.24 if we show that
∂
∂εKε(x)

ε=0
= [X, Y ](x)
for all x ∈M. This in turn is equivalent to
∂
∂εK∗
ε f

ε=0
= [X, Y ](x)
for any f ∈F(M). By the Lie derivative formula,
∂
∂εK∗
ε f =
1
2√ε

F ∗√ε£X

G∗√εF ∗
−√εG∗
−√εf

+ F ∗√εG∗√ε£Y

F ∗
−√εG∗
−√εf

−F ∗√εG∗√εF ∗
−√ε£X

G∗
−√εf

−F ∗√εG∗√εF ∗
−√εG∗
−√ε£Y (f)

.
By the chain rule, the limit of this as ε ↓0 is half the ∂/∂√ε-derivative of the parenthesis at ε = 0. Again
by the Lie derivative formula, this equals a sum of 16 terms, which reduces to the expression [X, Y ][f].
■
For example, for n × n matricess A and B, Proposition 4.2.34 yields the classical formula
e[A,B] = lim
n→∞

e−A/√ne−B/√neA/√neB/√nn
,
where the commutator is given by [A, B] = AB −BA. To see this, deﬁne for any n × n matrix C a vector
ﬁeld XC ∈X(Rn) by XC(x) = Cx. Thus XC has ﬂow Ft(x) = etCx. Note that XC is linear in C and satisﬁes
[XA, XB] = −X[A,B] as is easily veriﬁed. Thus the ﬂow of [XB, XA] is et[A,B] and the formula now follows
from Propositon 4.2.34.
The results of Corollary 4.1.27 and Proposition 4.2.34 had their historical origins in Lie group theory, where
they are known by the name of exponential formulas. The converse of Corollary 4.1.25, namely expressing
etAetB as an exponential of some matrix for suﬃciently small t is the famous Baker–Campbell–Hausdorﬀ
formula (see e.g., Varadarajan [1974, Section 2.15]). The formulas in Corollary 4.1.25 and Proposition 4.2.34
have certain generalizations to unbounded operators and are called Trotter product formulas after Trotter
[1958]. See Chorin et. al. The results of Corollary 4.1.27 and Proposition 4.2.34 had their historical origins in
Lie group theory, where they are known by the name of exponential formulas. The converse of Corollary
4.1.25, namely expressing etAetB as an exponential of some matrix for suﬃciently small t is the famous
Baker–Campbell–Hausdorﬀformula (see e.g., Varadarajan [1974, Section 2.15]). The formulas in Corollary
4.1.25 and Proposition 4.2.34 have certain generalizations to unbounded operators and are called Trotter
product formulas after Trotter [1958]. See Chorin, Hughes, McCracken, and Marsden [1978] for further
information.

4.2 Vector Fields as Diﬀerential Operators
249
Supplement 4.2B
The Method of Characteristics
The method used to solve problem (P) also enables one to solve ﬁrst-order quasi-linear partial diﬀerential
equations in Rn. Unlike Proposition 4.2.11, the solution will be implicit, not explicit. The equation under
consideration in Rn is
n
	
i=1
Xi(x1, . . . , xn, f) ∂f
∂xi = Y (x1, . . . , xn, f),
(Q)
where f = f(x1, . . . , xn) is the unknown function and Xi, Y , i = 1, . . . , n are Cr real-valued functions on
Rn+1, r ≥1. As initial condition one takes an (n −1)-dimensional submanifold Γ in Rn+1 that is nowhere
tangent to the vector ﬁeld
n
	
i=1
Xi ∂
∂xi + Y ∂
∂f
called the characteristic vector ﬁeld of (Q). Thus, if Γ is given parametrically by
xi = xi(t1, . . . , tn−1), i = 1, . . . , n
and
f = f(t1, . . . , tn−1),
this requirement means that the matrix


X1
· · ·
Xn
Y
∂x1
∂t1
· · ·
∂xn
∂t1
∂f
∂t1
...
...
...
∂x1
∂tn−1
· · ·
∂xn
∂tn−1
∂f
∂tn−1


has rank n. It is customary to require that the determinant obtained by deleting the last column be ̸=
0, for then, as we shall see, the implicit function theorem gives the solution. The function f is found
as follows. Consider Ft, the ﬂow of the vector ﬁeld 
i=1,...,n Xi∂/∂xi + Y ∂/∂f in Rn+1 and let S be
the manifold obtained by sweeping out Γ by Ft. That is, S = { Ft(Γ) | t ∈R }. The condition that

i=1,...,n Xi∂/∂xi+Y ∂/∂f never be tangent to Γ insures that the manifold Γ is “dragged along” by the ﬂow
Ft to produce a manifold of dimension n. If S is described by f = f(x1, . . . , xn) then f is the solution of the
partial diﬀerential equation. Indeed, the tangent space to S contains the vector 
i=1,...,n Xi∂/∂xi +Y ∂/∂f;
that is, this vector is perpendicular to the normal (∂f/∂x1, . . . ∂f/∂xn, −1) to the surface f = f(x1, . . . , xn)
and thus (Q) is satisﬁed.
We work parametrically and write the components of Ft as
xi = xi(t1, . . . , tn−1, t), i = 1, . . . , n
and
f = f(t1, . . . , tn−1, t).
Assuming that
0 ̸=

X1
· · ·
Xn
∂x1
∂t1
· · ·
∂xn
∂t1
...
· · ·
...
∂x1
∂tn−1
∂xn
∂tn−1

=

∂x1
∂t
· · ·
∂xn
∂t
∂x1
∂t1
· · ·
∂xn
∂t1
...
· · ·
...
∂x1
∂tn−1
∂xn
∂tn−1


250
4. Vector Fields and Dynamical Systems
one can locally invert to give t = (x1, . . . , xn), ti = ti(x1, . . . , xn), i = 1, . . . , n−1. Substitution into f yields
f = f(x1, . . . , xn).
The fundamental assumption in this construction is that the vector ﬁeld 
i=1,...,n Xi∂/∂xi + Y ∂/∂f is
never tangent to the (n−1)-manifold Γ. The method breaks down if one uses manifolds Γ, which are tangent
to this vector ﬁeld at some point. The reason is that at such a point, no complete information about the
derivative of f in a complementary (n −1)-dimensional subspace to the characteristic is known.
4.2.35 Example.
Consider the equation in R2 given by
∂f
∂x + f ∂f
∂y = 3
with initial condition Γ = { (x, y, f) | x = s, y = (1/2)s2 −s, f = s }. On this one-manifold

1
f
∂x
∂s
∂y
∂s

=

1
2
1
s −1
 = 1 ̸= 0
so that the vector ﬁeld ∂/∂x+f∂/∂y +3∂/∂f is never tangent to Γ. Its ﬂow is Ft(x, y, f) = (t+x, (3/2)t2 +
ft + y, 3t + f) so that the manifold swept out by Γ along Ft is given by x(t, s) = t + s, y(t, s) = (3/2)t2 +
st + (1/2)s2 −s, f(t, s) = 3t + s. Eliminating t, s we get
f(x, y) = x −1 ±

1 −2x2 + 4x + 4y.
The solution is deﬁned only for 1 −2x2 + 4x + 4y ≥0.
♦
Another interesting phenomenon occurs when S can no longer be described in terms of the graph of f;
for example, S “folds over.” This corresponds to the formation of shock waves. Further information can be
found in Chorin and Marsden [1993], Lax [1973], Guillemin and Sternberg [1977], John [1975], and Smoller
[1983].
Supplement 4.2C
Automorphisms of Function Algebras
The property of ﬂows corresponding to the derivation property of vector ﬁelds is that they are algebra
preserving
F ∗
t (fg) = (F ∗
t f)(F ∗
t g).
In fact it is obvious that every diﬀeomorphism induces an algebra automorphism of F(M). The following
theorem shows the converse. (We note that there is an analogous result of Mackey [1962] for measurable
functions and measurable automorphisms.)
4.2.36 Theorem.
Let M be a paracompact second–countable ﬁnite dimensinal manifold. Let α : F(M) →
F(M) be an invertible linear mapping that satisﬁes α(fg) = α(f)α(g) for all f, g ∈F(M). Then there is a
unique C∞diﬀeomorphism ϕ : M →M such that α(f) = f ◦ϕ.
Remarks.

4.2 Vector Fields as Diﬀerential Operators
251
A. There is a similar theorem for paracompact second–countable Banach manifolds; here we assume
that there are invertible linear maps αF : C∞(M, F) →C∞(M, F) for each Banach space F such
that for any bilinear continuous map B : F × G →H we have αH(B(f, g)) = B(αF (f), αG(g))
for f ∈C∞(M, F) and g ∈C∞(M, G). The conclusion is the same: there is a C∞diﬀeomorphism
ϕ : M →M such that αF (f) = f ◦ϕ for all F and all f ∈C∞(M, G). Alternative to assuming this for
all F, one can take F = R and assume that M is modelled on a Banach space that has a norm that
is C∞away from the origin. We shall make some additional remarks on the inﬁnite-dimensional case
in the course of the proof.
B. Some of the ideas about partitions of unity are needed in the proof. Although the present proof is
self–contained, the reader may wish to consult §5.6 simultaneously.
C. In Chapter 5 we shall see that ﬁnite-dimensional paracompact manifolds are metrizable, so by Theorem
1.6.14 they are automatically second countable.
♦
Proof of uniqueness.
We shall ﬁrst construct a C∞function χ : M →R which takes on the values 1
and 0 at two given points m1, m2 ∈M, m1 ̸= m2. Choose a chart (U, ϕ) at m1, such that m2 ̸∈U and such
that ϕ(U) is a ball of radius r1 about the origin in E, ϕ(m1) = 0. Let V ⊂U by the inverse image by ϕ of
the ball of radius r2 < r1 and let θ : E →R be a C∞-bump function as in Lemma 4.2.13. Then the function
χ : M →R given by
χ =

θ ◦ϕ,
on U;
0,
on M\U.
is clearly C∞and χ(m1) = 1, χ(m2) = 0.
Now assume that ϕ∗f = ψ∗f for all f ∈F(M) for two diﬀerent diﬀeomorphisms ϕ, ψ of M. Then there
is a point m ∈M such that ϕ(m) ̸= ψ(m) and thus we can ﬁnd χ ∈F(M) such that (χ ◦ϕ)(m) = 1,
(χ ◦ψ)(m) = 0 contradicting ϕ∗χ = ψ∗χ. Hence ϕ = ψ.
■
The proof of existence is based on the following key lemma.
4.2.37 Lemma.
Let M be a (ﬁnite-dimensional) paracompact second countable manifold and β : F(M) →
R be a nonzero algebra homomorphism. Then there is a unique point m ∈M such that β(f) = f(m).
Proof.
(Following suggestions of H. Bercovici.) Uniqueness is clear, as before, since for m1 ̸= m2 there
exists a bump function f ∈F(M) satisfying f(m1) = 0, f(m2) = 1.
To show existence, note ﬁrst that β(1) = 1. Indeed β(1) = β(12) = β(1)β(1) so that either β(1) = 0 or
β(1) = 1. But β(1) = 0 would imply β is identically zero since β(f) = β(1 · f) = β(1) · β(f), contrary to our
hypotheses. Therefore we must have β(1) = 1 and thus β(c) = c for c ∈R. For m ∈M, let
Ann(m) = { f ∈F(M) | f(m) = 0 }.
Second, we claim that it is enough to show that there is an m ∈M such that ker β = { f ∈F(M) | β(f) =
0 } = Ann(m). Clearly, if β(f) = f(m) for some m, then ker β = Ann(m). Conversely, if this holds for
some m ∈M and f ̸∈ker β, let c = β(f) and note that f −c ∈ker β = Ann(m), so f(m) = c and thus
β(f) = f(m) for all f ∈F(M).
To prove that ker β = Ann(m) for some m ∈M, note that both are ideals in F(M); that is, if f ∈ker β,
(resp., Ann(m)), and g ∈F(M), then fg ∈ker β (resp., Ann(m)). Moreover, both of them are maximal
ideals; that is, if I is another ideal of F(M), with I ̸= F(M), and ker β ⊂I, (resp., Ann(m) ⊂I) then
necessarily ker β = I (resp. Ann(m) = I). For ker β this is seen in the following way: since R is a ﬁeld, it has
no ideals except 0 and itself; but β(I) is an ideal in R, so β(I) = 0, that is, I = ker β, or β(I) = R = β(F(M)).

252
4. Vector Fields and Dynamical Systems
If β(I) = R, then for every f ∈F(M) there exists g ∈I such that f −g ∈ker β ⊂I and hence f ∈g +I ⊂I;
that is, I = F(M). Similarly, the ideal Ann(m) is maximal since the quotient F(M)/Ann(m) is isomorphic
to R.
Assume that ker β ̸= Ann(m) for every m ∈M. By maximality, neither set can be included in the other,
and hence for every m ∈M there is a relatively compact open neighborhood Um of m and fm ∈ker β
such that fm|Um > 0. Let Vm be an open neighborhood of the closure, cl(Um). Since M is paracompact,
we can assume that { Vm | m ∈M } is locally ﬁnite. Since M is second countable, M can be covered by
{ Vm(j) | j ∈N }. Let fj = fm(j) and let χj be bump functions which are equal to 1 on cl(Um(j)) and
vanishing in M\Vm(j). If we have the inequality
an <
1
n2 sup{ χn(m)f 2n(m) | m ∈M },
then the function
f =
	
n≥1
anχnf 2
n
is C∞(since the sum is ﬁnite in a neighborhood of every point), f > 0 on M, and the series deﬁning f is
uniformly convergent, being majorized by 
n≥1 n−2. If we can show that β can be taken inside the sum,
then β(f) = 0. This construction then produces f ∈ker β, f > 0 and hence 1 = (1/f)f ∈ker β; that is,
ker β = F(M), contradicting the hypothesis β ̸= 0.
To show that β can be taken inside the series, it suﬃces to prove the following “g-estimate”: for any
g ∈F(M),
|β(g)| ≤sup{ |g(m)| | m ∈M }.
Once this is done, then

N
	
m=1
β(anχnf 2
n) −β(f)
 =
β
 N
	
m=1
anχnf 2
n −f

≤sup

N
	
m=1
anχnf 2
n −f
 →0
as n →∞by uniform convergence and boundedness of all functions involved. Thus β(f) = 
n≥1 β(anχnf 2
n).
To prove the g-estimate, let λ > sup{ |g(m)| | m ∈M } so that λ ± g ̸= 0 on M; that is, λ ± g are both
invertible functions on M. Since β is an algebra homomorphism, 0 ̸= β(λ ± g) = λ ± β(g). Thus ±β(g) ̸= λ
for all λ > sup{ |g(m)| | m ∈M }. Hence we get the estimate
|β(g)| ≤sup{ |g(m)| | m ∈M }.
■
Remark.
For inﬁnite-dimensional manifolds, the proof of the lemma is almost identical, with the following
changes: we work with β : C∞(M, F) →F, absolute values are replaced by norms, second countability is
in the hypothesis, and the neighborhoods Vm are chosen in such a way that fm|Vm is a bounded function
(which is possible by continuity of fm).
♦
Proof of existence in Theorem 4.2.36.
For each m ∈M, deﬁne the algebra homomorphism βm :
F(M) →R by βm(f) = α(f)(m). Since α is invertible, α(1) ̸= 0 and since α(1) = α(12) = α(1)α(1),

4.2 Vector Fields as Diﬀerential Operators
253
we have α(1) = 1. Thus βm ̸= 0 for all m ∈M. By Lemma 4.2.37 there exists a unique point, which we
call ϕ(m) ∈M, such that βm(f) = f(ϕ(m)) = (ϕ∗f)(m). This deﬁnes a map ϕ : M →M such that
α(f) = ϕ∗f for all f ∈F(M). Since α is an automorphism, ϕ is bijective and since α(f) = ϕ∗f ∈F(M),
α−1(f) = ϕ∗f ∈F(M) for all f ∈F(M), both ϕ, ϕ−1 are C∞(take for f any coordinate function multiplied
by a bump function to show that in every chart the local representatives of ϕ, ϕ−1 are C∞).
■
The proof of existence in the inﬁnite-dimensional case proceeds in a similar way.
Supplement 4.2D
Derivations on Cr Functions
This supplement investigates to what extent vector ﬁelds and tangent vectors are characterized by their
derivation properties on functions, if the underlying manifold is ﬁnite dimensional and of a ﬁnite diﬀer-
entiability class. We start by studying vector ﬁelds. Recall from Proposition 4.2.9 that a derivation θ is
an R-linear map from Fk+1(M) to Fk(M) satisfying the Leibniz rule, that is, θ(fg) = fθ(g) + gθ(f) for
f, g ∈Fk+1(M), if the diﬀerentiability class of M is at least k + 1.
4.2.38 Theorem (A. Blass).
Let M be a Ck+2 ﬁnite-dimensional manifold, where k ≥0. The collection
of all derivations θ from Fk+1(M) to Fk(M) is isomorphic to Xk(M) as a real vector space.
Proof.
By the remark following Theorem 4.2.16, there is a unique Ck vector ﬁeld X with the property
that θ|Fk+2(M) = £X|Fk+2(M). Thus, all we have to do is show that θ and £X agree on Ck+1 functions.
Replacing θ with θ −£X, we can assume that θ annihilates all Ck+2 functions and we want to show that it
also annihilates all Ck+1 functions. As in the proof of Theorem 4.2.16, it suﬃces to work in a chart, so we
can assume without loss of generality that M = Rn.
Let f be a Ck+1 function and ﬁx p ∈Rn. We need to prove that (θf)(p) = 0. For simplicity, we will
show this for p = 0, the proof for general p following by centering the following arguments at p instead
of 0. Replacing f by the diﬀerence between f and its Taylor polynomial of order k + 1 about 0, we can
assume f(0) = 0, and the ﬁrst k + 1 derivatives vanish at 0, since θ evaluated at the origin annihilates any
polynomial. We shall prove that f = g + h, where g and h are two Ck+1 functions, satisfying g|U = 0 and
h|V = 0, where U, V are open sets such that 0 ∈cl(U)  cl(V ). Then, since θ is a local operator, θg|U = 0
and θh|V = 0, whence by continuity θg|cl(U) = 0 and θh|cl(V ) = 0. Hence (θf)(0) = (θg)(0) + (θh)(0) = 0
and the theorem will be proved.
4.2.39 Lemma.
Let ϕ : Sn−1 ⊂Rn →R be a C∞function and denote by π : Rn\{0} →Sn−1, π(x) =
x/∥x∥the radial projection. Then for any positive integer r,
Dr(ϕ ◦π)(x) = (ψ ◦π)(x)
∥x∥r
for some C∞function ψ : Sn−1 →Lr
s(Rn; R). In particular Dk(ϕ ◦π)(x) = O(∥x∥−r) as ∥x∥→0.
Proof.
For r = 0 choose ϕ = ψ. For r = 1, note that
Dπ(x) · v = −
1
∥x∥2 D∥· ∥(x) · v +
v
∥x∥,
and so
D(ϕ ◦π)(x) · v =
1
∥x∥Dϕ(π(x))

I −
1
∥x∥D∥· ∥(x)

· v.

254
4. Vector Fields and Dynamical Systems
But the mapping ℓ′(x) = (1/∥x∥)D∥·∥(x) satisﬁes ℓ′(tx) = ℓ′(x) for all t > 0 so that it is uniquely determined
by ℓ= ℓ′|Sn−1. Hence
D(ϕ ◦π)(x) =
1
∥x∥(ψ ◦π)(x),
where ψ(y) = Dϕ(y) · (I −ℓ(y)), y ∈Sn−1. Now proceed by induction.
▼
Returning to the proof of the theorem, let f be as before, that is, of class Ck+1 and Dif(0) = 0,
0 ≤i ≤k + 1, and let ϕ, π be as in the lemma. From Taylor’s formula with remainder, we see that
Dif(x) = o(∥x∥k+1−i), 0 ≤i ≤k + 1, as x →0. Hence by the product rule and the lemma,
Di(f · (ϕ ◦π))(x) =
	
j+ℓ=i
o(∥x∥k+1−j)O(∥x∥−ℓ) = o(∥x∥k+1−i)
so that Di(f · (ϕ ◦π)), 0 ≤i ≤k + 1, can be continuously extended to 0, by making them vanish at 0.
Therefore f · (g ◦π) is Ck+1 for all Rn.
Now choose the C∞function ϕ in the lemma to be zero on an open set O1 and equal to 1 on an open set
O2 of Sn−1, O1 ∩O2 = ∅. Then the continuous extension g of f · (ϕ ◦π) to Rn is zero on U = π−1(O1) and
agrees with f on V = π−1(O2). Let h = f −g and thus f is the sum of two Ck+1 functions, each of which
vanishes in an open set having 0 in its closure. This completes the proof.
■
We do not know of an example of a derivation not given by a vector ﬁeld on a C1-manifold.
In inﬁnite dimensions, the proof would require the norm of the model space to be C∞away from the origin
and the function ψ in the lemma bounded with all derivatives bounded on the unit sphere. Unfortunately,
this does not seem feasible under realistic hypotheses.
The foregoing proof is related to the method of “blowing-up” a singularity; see for example Takens
[1974] and Buchner, Marsden, and Schecter [1983a]. There are also diﬃculties with this method in inﬁnite
dimensions in other problems, such as the Morse lemma (see Golubitsky and Marsden [1983] and Buchner,
Marsden, and Schecter [1983b]).
4.2.40 Corollary.
Let M be a Ck+1 ﬁnite-dimensional manifold. Then the only derivative from Fk+1(M)
to Fk(M), where l ≤k < ∞, is zero.
Proof.
By the theorem, such a derivation is given by a Ck−1 vector ﬁeld X. If X ̸= 0, then for some
f ∈Fk+1(M), X[f] is only Ck−1 but not Ck.
■
Next, we turn to the study of the relationship between tangent vectors and germ derivations. On Fk(M)
consider the following equivalence relation: f ∼m g iﬀf and g agree on some neighborhood of m ∈M.
Equivalence classes of the relation ∼m are called germs at m; they form a vector space denoted by Fk
m(M).
The diﬀerential d on functions clearly induces an R-linear map, denoted by dm on Fk
m(M) by dmf = df(m),
where we understand f on the left hand side as a germ. It is straightforward to see that dm : Fk
m(M) →T ∗
mM
is R-linear and satisﬁes the Leibniz rule. We say that an R-linear map θm : Fk
m(M) →E, where E is a
Banach space, is a germ derivation if θm satisﬁes the Leibniz rule. Thus, dm is a T ∗
mM-valued germ
derivation.
Any tangent vector vm ∈TmM deﬁnes an R-valued germ derivation by vm[f] = ⟨df(m), vm⟩. Conversely,
localizing the statement and proof of Theorem 4.2.16(i) at m, we see that on a C∞ﬁnite-dimensional
manifold, any R-valued germ derivation at m deﬁnes a unique tangent vector, that is, TmM is isomorphic
to the vector space of R-valued germ derivations on Fm(M). The purpose of the rest of this supplement is
to show that this result is false if M is a Ck-manifold. This is in sharp contrast to Theorem 4.2.38.
4.2.41 Theorem ( Newns and Walker [1956]).
Let M be a ﬁnite dimensional Ck manifold, l ≤k < ∞.
Then there are R-valued germ derivations on Fk
m(M) which are not tangent vectors. In fact, the vector space
of all R-valued germ derivations on Fk
m(M) is card(R)-dimensional, where card(R) is the cardinality of the
continuum.

4.2 Vector Fields as Diﬀerential Operators
255
For the proof, we start with algebraic characterizations of TmM and the vector space of all germ deriva-
tions.
4.2.42 Lemma.
Let
Fk
m,0(M) = { f ∈Fk
m(M) | df(m) = 0 }.
Then
Fk
m(M)/Fk
m,0(M) is isomorphic to T ∗
mM.
Therefore, since M is ﬁnite dimensional
(Fk
m(M)/Fk
m,0(M))∗is isomorphic to TmM.
Proof.
The isomorphism of Fk
m(M)/Fk
m,0(M) with T ∗
mM is given by class of (f) 
→df(m); this is a direct
consequence of Corollary 4.2.14.
▼
4.2.43 Lemma.
Let Fk
m,d(M) = span{1, fg ⊥f, g ∈Fk
m(M), f(m) = g(m) = 0}. Then the space of
R-linear germ derivations on Fk
m(M) is isomorphic to (Fk
m(M)/Fk
m,d(M))∗.
Proof.
Clearly, if θm is a germ derivation θm(1) = 0 and θm(fg) = 0 for any f, g ∈Fk
m(M) with
f(m) = g(m) = 0, so that θm deﬁnes a linear functional on Fk
m(M) which vanishes on the space Fk
m,d(M).
Conversely, if λ is a linear functional on Fk
m(M) vanishing on Fk
m,d(M), then λ is a germ derivation, for if
f, g ∈Fk
m(M), we have
fg = (f −f(m))(g −g(m)) + f(m)g + g(m)f −f(m)g(m)
so that
λ(fg) = f(m)λ(g) + g(m)λ(f),
that is, the Leibniz rule holds.
▼
4.2.44 Lemma.
All germs in Fk
m,d(M) have k + 1 derivatives at m (even though M is only of class Ck).
Proof.
Since any element of Fk
m,d(M) is of the form a + bfg, f, g ∈Fk
m(M), f(m) = g(m) = 0, a, b ∈R,
it suﬃces to prove the statement for fg. Passing to local charts, we have by the Leibniz rule
Dk(fg) = (Dkf)g + f(Dkg) + ϕ,
for
ϕ =
k−1
	
i=1
(Dif)(Dk−ig).
Clearly ϕ is C1, since the highest order derivative in the expression of ϕ is k −1 and f, g are Ck. Moreover,
since Dkf is continuous and g(m) = 0, using the deﬁnition of the derivative it follows that D[(Dkf)g](m) =
(Dkf)(m)(Dg)(m). Therefore, fg has k + 1 derivatives at m.
▼
Proof of Theorem 4.2.41.
We clearly have
Fk
m,d(M) ⊂Fk
m,0(M).
Choose a chart (x1, . . . , xn) at m, xi(m) = 0, and consider the functions |xi|k+ε, 0 < ε < 1. These functions
are clearly in Fk
m,0(M), but are not in Fk
m,d(M) by Lemma 4.2.44, since they cannot be diﬀerentiated k + 1

256
4. Vector Fields and Dynamical Systems
times at m. Therefore, Fk
m,d(M) is strictly contained in Fk
m,0(M) and thus TmM is a strict subspace of the
vector space of germ diﬀerentations on Fk
m(M) by Lemmas 4.2.42 and 4.2.43.
The functions |xi|k+ε, 0 < ε < 1 are linearly independent in Fk
mM modulo Fk
m,d(M), because only a
trivial linear combination of such functions has derivatives of order k + 1 at m. Therefore, the dimension of
Fk
m(M)/Fk
m,d(M) is at least card(R). Since card(Fk
m(M)) = card(R), it follows that dim(Fk
m(M)/Fk
m,d(M)) =
card(R). Consequently, its dual, which by Lemma 4.2.43 coincides with the vector space of germ-derivations
at m, also has dimension card(R).
■
Exercises
⋄4.2-1.
(i)
On R2, let X(x, y) = (x, y; y, −x). Find the ﬂow of X.
(ii)
Solve the following for f(t, x, y):
∂f
∂t = y ∂f
∂x −x∂f
∂y
if f(0, x, y) = y sin x.
⋄4.2-2.
(i)
Let X and Y be vector ﬁelds on M with complete ﬂows Ft and Gt, respectively. If [X, Y ] = 0,
show that X + Y has ﬂow Ht = Ft ◦Gt. Is this true if X and Y are time dependent?
(ii)
Show that if [X, Y ] = 0 for all Y ∈X(M), then X = 0.
Hint: From the local formula conclude ﬁrst that X is constant; then take for Y linear vector ﬁelds
and apply the Hahn–Banach theorem. In inﬁnite dimensions, assume the conditions hold locally or
that the model spaces are C∞.
⋄4.2-3.
Show that, under suitable hypotheses, that the solution f(x, t) = g(Ft(x)) of problem (P) given in
Proposition 4.2.11 is unique.
Hint: Consider the function
E(t) =

Rn |f1(x, t) −f2(x, t)|2 dx
where f1 and f2 are two solutions. Show that dE/dt ≤αE for a suitable constant α and conclude by
Gronwall’s inequality that E = 0. The “suitable hypotheses” are conditions that enable integration by parts
to be performed in the computation of dE/dt.
Adapt this proof to get uniqueness of the solution in Proposition 4.2.28.
⋄4.2-4.
Let X, Y ∈X(M) have ﬂows Ft and Gt, respectively. Show that
[X, Y ] = d
dt
d
ds

t,s=0
(F−t ◦Gs ◦Ft).
Hint: The ﬂow of F ∗
t Y is s 
→F−t ◦Gs ◦Ft.
⋄4.2-5.
Show that SO(n) is parallelizable. See Exercise 3.5-19 for a proof that SO(n) is a manifold.
Hint: SO(n) is a group.
⋄4.2-6.
Solve the following system of partial diﬀerential equations.
∂Y 1
∂t
= (x + y)∂Y 1
∂x + (4x −2y)∂Y 1
∂y −Y 1 −Y 2,
∂Y 2
∂t
= (x + y)∂Y 2
∂x + (4x −2y)∂Y 2
∂y −4Y 1 + 2Y 2,

4.3 An Introduction to Dynamical Systems
257
with initial conditions Y 1(x, y, 0) = x + y, Y 2(x, y, 0) = x2.
Hint: The ﬂow of the vector ﬁeld (x + y, 4x −2y) is
(x, y) 
→
1
5(x −y)e−3t + 1
5(4x + y)e2t, −4
5(x −y)e−3t + 1
5(4x + y)e2t

.
⋄4.2-7.
Consider the following equation for f(x, t) in divergence form:
∂f
∂t + ∂
∂x(H(f)) = 0
where H is a given function of f. Show that the characteristics are given by ˙x = −H′(f). What does the
transversality condition discussed in Supplement 4.2B become in this case?
⋄4.2-8.
Let M and N be manifolds with N modeled on a Banach space which has a Ck norm away from
the origin. Show that a given mapping ϕ : M →N is Ck iﬀf ◦ϕ : M →R is Ck for all f ∈Fk(N).
⋄4.2-9.
Develop a product formula like that in Supplement 4.1A for the ﬂow of X + Y for time-dependent
vector ﬁelds.
Hint: You will have to consider time-ordered products.
⋄4.2-10 ( Newns and Walker [1956]).
In the terminology of Supplement 4.2D, consider a C0-manifold mod-
eled on Rn. Show that any germ derivation is identically zero.
Hint: Write any f ∈F0
m(M), f = f(m) + (f −f(m))1/3(f −f(m))exc:2.3−27 and apply the derivation.
⋄4.2-11 (More on the Lie bracket as a “commutator”).
Let M be a manifold, m ∈M, v ∈TmM. Recall
that TmM is a submanifold of T(TM) and that Tv(TmM) is canonically isomorphic to TmM. Also recall
from Exercise 3.3-2 that on T(TM) there is a canonical involution sM : T(TM) →T(TM) satisfying
sM ◦sM = identity on T(TM), TτM ◦sM = τT M, and τT M ◦sM = TτM, where τM : TM →M and
τT M : T(TM) →TM are the canonical tangent bundle projections. Let X, Y ∈X(M) and denote by
TX, TY : TM →T(TM) their tangent maps. Prove the following formulae for the Lie bracket:
[X, Y ](m) = sM(TmY (X(m))) −TmX(Y (m))
= TmY (X(m)) −sM(TmX(Y (m))),
where the right hand sides, belonging to TX(m)(TmM) and TY (m)(TmM) respectively, are thought of as
elements of TmM.
Hint: Show that TmτM of the right hand sides is zero which proves that the right hand sides are not just
elements of TX(m)(TM) and TY (m)(TM) respectively, but of the indicated spaces. Then pass to a local
chart.
4.3
An Introduction to Dynamical Systems
We have seen quite a bit of theoretical development concerning the interplay between the two aspects of
vector ﬁelds, namely as diﬀerential operators and as ordinary diﬀerential equations. It is appropriate now
to look a little more closely at geometric aspects of ﬂows.
Much of the work in this section holds for inﬁnite-dimensional as well as ﬁnite-dimensional manifolds.
The reader who knows or is willing to learn some spectral theory from functional analysis can make the
generalization.
This section is intended to link up the theory of this book with courses in ordinary diﬀerential equations
that the reader may have taken. The section will be most beneﬁcial if it is read with such a course in mind.
We begin by introducing some of the most basic terminology regarding the stability of ﬁxed points.

258
4. Vector Fields and Dynamical Systems
4.3.1 Deﬁnition.
Let X be a C1 vector ﬁeld on an n-manifold M. A point m is called a critical point
(also called a singular point or an equilibirum point) of X if X(m) = 0. The linearization of X at a
critical point m is the linear map
X′(m) : TmM →TmM
deﬁned by
X′(x) · v = d
dt(TFt(m) · v)

t=0
where Ft is the ﬂow of X. The eigenvalues (points in the spectrum) of X′(m) are called characteristic
exponents of X at m.
Some remarks will clarify this deﬁnition. Ft leaves m ﬁxed: Ft(m) = m, since c(t) ≡m is the unique
integral curve through m. Conversely, it is obvious that if Ft(m) = m for all t, then m is a critical point.
Thus TmFt is a linear map of TmM to itself and so its t-derivative at 0, producing another linear map of
TmM to itself, makes sense.
4.3.2 Proposition.
Let m be a critical point of X and let (U, ϕ) be a chart on M with ϕ(m) = x0 ∈Rn.
Let x = (x1, . . . , xn) denote coordinates in Rn and Xi(x1, . . . , xn), i = 1, . . . , n, the components of the local
representative of X. Then the matrix of X′(m) in these coordinates is
∂Xi
∂xj

x=x0
.
Proof.
This follows from the equations
Xi(Ft(x)) = d
dtF i
t (x)
after diﬀerentiating in x and setting x = x0, t = 0.
■
The name “characteristic exponent” arises as follows. We have the linear diﬀerential equation
d
dtTmFt = X′(x) ◦TmFt
and so
TmFt = etX′(m).
Here the exponential is deﬁned, for example, by a power series. The actual computation of these exponentials
is learned in diﬀerential equations courses, using the Jordan canonical form. (See Hirsch and Smale [1974],
for instance.) In particular, if µ1, . . . , µn are the characterisitc exponents of X at m, the eigenvalues of TmFt
are
etµ1, . . . , etµn.
The characteristic exponents will be related to the following notion of stability of a critical point.
4.3.3 Deﬁnition.
Let m be a critical point of X. Then
(i)
m is stable (or Liapunov stable) if for any neighborhood U of m, there is a neighborhood V of m
such that if m′ ∈V , then m′ is + complete and Ft(m′) ∈U for all t ≥0. (See Figure 4.3.1(a).)

4.3 An Introduction to Dynamical Systems
259
(ii)
m is asymptotically stable if there is a neighborhood V of m such that if m′ ∈V , then m is +
complete, Ft(V ) ⊂Fs(V ) if t > s and
lim
t→+∞Ft(V ) = {m},
that is, for any neighborhood U of m, there is a T such that Ft(V ) ⊂U if t ≥T. (See Figure 4.3.1(b).)
It is obvious that asymptotic stability implies stability. The harmonic oscillator ¨x = −x giving a ﬂow in
the plane shows that stability need not imply asymptotic stability (Figure 4.3.1(c)).
4.3.4 Theorem (Liapunov’s Stability Criterion).
Suppose X is C1 and m is a critical point of X. Assume
the spectrum of X′(m) is strictly in the left half plane. (In ﬁnite dimensions, the characteristic exponents
of m have negative real parts.) Then m is asymptotically stable. (In a similar way, if Re(µi) > 0, m is
asymptotically unstable, that is, asymptotically stable as t →−∞.)
m
V
m0
U
m
m0
V
x
y
(a)  Stable
(b)  Asymptotically stable
(c)  Harmonic oscillator
Figure 4.3.1. Stability of equilibria
The proof we give requires some spectral theory that we shall now review. For the ﬁnite dimensional case,
consult the exercises. This proof in fact can be adapted to work for many partial diﬀerential equations (see
Marsden and Hughes [1983, Chapters 6, 7, and p. 483]).
Let T : E →E be a bounded linear operator on a Banach space E and let σ(T) denote its spectrum; that
is,
σ(T) = { λ ∈C | T −λI is not invertible on the complexiﬁcation of E }.
Then σ(T) is non-empty, is compact, and for λ ∈σ(T), |λ| ≤∥T∥. Let r(T) denote its spectral radius,
deﬁned by r(T) = sup{ |λ| | λ ∈σ(T) }.
4.3.5 Theorem (Spectral Radius Formula).
r(t) = lim
n→∞∥T n∥1/n.
The proof is analogous to the formula for the radius of convergence of a power series and can be supplied
without diﬃculty; cf. Rudin [1973, p. 355]. The following lemma is also not diﬃcult and is proved in Rudin
[1973] and Dunford and Schwartz [1963].
4.3.6 Theorem (Spectral Mapping Theorem).
Let
f(z) =
∞
	
n=0
anzn
be an entire function and deﬁne
f(T) =
∞
	
n=0
anT n.
Then σ(f(T)) = f(σ(T)).

260
4. Vector Fields and Dynamical Systems
4.3.7 Lemma.
Let T : E →E be a bounded linear operator on a Banach space E. Let r be any number
greater than r(T), the spectral radius of T. Then there is a norm | · | on E equivalent to the original norm
such that |T| ≤r.
Proof.
From the spectral radius formula, we get supn≥0(∥T n∥/rn) < ∞, so if we deﬁne
|x| = sup
n≥0
∥T n(x)∥
rn
,
then | | is a norm and
∥x∥≤|x| ≤

sup
n≥0
∥T n∥
rn

∥x∥.
Hence
|T(x)| = sup
n≥0
∥T n+1(x)∥
rn
= r sup
n≥0
∥T n+1(x)∥
rn+1
≤r|x|.
■
4.3.8 Lemma.
Let A : E →E be a bounded operator on E and let r > σ(A) (i.e., if λ ∈σ(A), Re(λ) > r).
Then there is an equivalent norm | · | on E such that for t ≥0, |etA| ≤ert.
Proof.
Using Theorem 4.3.6, ert is ≥spectral radius of etA; that is, ert ≥limn→∞∥entA∥1/n. Set
|x| =
sup
n≥0,t≥0
∥entA(x)∥
ernt
and proceed as in Lemma 4.3.7.
■
There is an analogous lemma if r < σ(A), giving |etA| ≥ert.
4.3.9 Lemma.
Let T : E →E be a bounded linear operator. Let σ(T) ⊂{ z | Re(z) < 0 } (resp.,
σ(T) ⊂{ z | Re(z) > 0 }). Then the origin is an attracting (resp., repelling) ﬁxed point for the ﬂow ϕt = etT
of T.
Proof.
If σ(T) ⊂{ z | Re(z) < 0 }, there is an r < 0 with σ(T) < r, as σ(T) is compact. Thus by Lemma
4.3.8, |etA| ≤ert →0 as t →+∞.
■
Proof of Liapunov’s Stability Criterion Theorem 4.3.4.
Without
loss of generality, we can assume that M is a Banach space E and that m = 0. As above, renorm E and ﬁnd
ε > 0 such that ∥etA∥≤e−εt, where A = X′(0).
From the local existence theory, there is an r-ball about 0 for which the time of existence is uniform if
the initial condition x0 lies in this ball. Let
R(x) = X(x) −DX(0) · x.
Find r2 ≤r such that ∥x∥≤r2 implies ∥R(x)∥≤α∥x∥, where α = ε/2.
Let D be the open r2/2 ball about 0. We shall show that if x0 ∈D, then the integral curve starting at x0
remains in D and →0 exponentially as t →+∞. This will prove the result. Let x(t) be the integral curve
of X starting at x0. Suppose x(t) remains in D for 0 ≤t < T. The equation
x(t) = x0 +
 t
0
X(x(s)) ds = x0 +
 t
0
[Ax(s) + R(x(s))] ds

4.3 An Introduction to Dynamical Systems
261
gives, by the variation of constants formula (Exercise 4.1-5),
x(t) = etAx0 +
 t
0
e(t−s)AR(x(s)) ds,
and so
∥x(t)∥≤e−tε∥x0∥+ α
 t
0
e−(t−s)ε∥x(s)∥ds.
Letting f(t) = etε∥x(t)∥, the previous inequality becomes
f(t) ≤∥x0∥+ α
 1
0
f(s) ds,
and so, by Gronwall’s inequality, f(t) ≤∥x0∥eαt. Thus
∥x(t)∥≤∥x0∥e(α−ε)t = ∥x0∥e−εt/2.
Hence x(t) ∈D, 0 ≤t < T, so as in Proposition 4.1.19, x(t) may be indeﬁnitely extended in t and the
foregoing estimate holds.
■
One can also show that if M is ﬁnite dimensional and m is a stable equilibrium, then no eigenvalue of X′(m)
has strictly positive real part; see Hirsch and Smale [1974, pp. 187–190] and the remarks below on invariant
manifolds. See Hille and Phillips [1957], and Curtain and Pritchard [1977] for the inﬁnite dimensional linear
case.
Another method of proving stability is to use Liapunov functions.
4.3.10 Deﬁnition.
Let X ∈Xr(M), r ≥1, and let m be an equilibrium solution for X, that is, X(m) = 0.
A Liapunov function for X at m is a continuous function L : U →R deﬁned on a neighborhood U of m,
diﬀerentiable on U\{m}, and satisfying the following conditions:
(i)
L(m) = 0 and L(m′) > 0 if m′ ̸= m;
(ii)
X[L] ≤0 on U\{m};
(iii)
there is a connected chart ϕ : V →E where m ∈V ⊂U, ϕ(m) = 0, and an ε > 0 satisfying
Bε(0) = { x ∈E | ∥x∥≤ε } ⊂ϕ(V ), such that for all 0 < ε′ ≤ε,
inf{ L(ϕ−1(x)) | ∥x∥= ε′ } > 0.
The Liapunov function L is said to be strict, if (ii) is replaced by (ii)′ X[L] < 0 in U\{m}.
Conditions (i) and (iii) are called the potential well hypothesis. In ﬁnite dimensions, (iii) follows
automatically from compactness of the sphere of radius ε′ and (i). By the Lie derivative formula, condition
(ii) is equivalent to the statement: L is decreasing along integral curves of X.
4.3.11 Theorem.
Let X ∈Xr(M), r ≥1, and m be an equilibrium of X. If there exists a Liapunov
function for X at m, then m is stable.
Proof.
Since the statement is local, we can assume M is a Banach space E and m = 0. By Lemma 4.1.8,
there is a neighborhood U of 0 in E such that all solutions starting in U exist for time t ∈[−δ, δ], with δ
depending only on X and U, but not on the solution. Now ﬁx ε > 0 as in (iii) such that the open ball Dε(0)
is included in U. Let ρ(ε) > 0 be the minimum value of L on the sphere of radius ε, and deﬁne the open
set U ′ = { x ∈Dε(0) | L(x) < ρ(ε) }. By (i), U ′ ̸= ∅, 0 ∈U ′, and by (ii), no solution starting in U ′ can
meet the sphere of radius ε (since L is decreasing on integral curves of X). Thus all solutions starting in
U ′ never leave Dε(0) ⊂U and therefore by uniformity of time of existence, these solutions can be extended
indeﬁnitely in steps of δ time units. This shows 0 is stable.
■

262
4. Vector Fields and Dynamical Systems
Note that if E is ﬁnite dimensional, the proof can be done without appeal to Lemma 4.1.8: since the closed
ε-ball is compact, solutions starting in U ′ exist for all time by Proposition 4.1.19.
4.3.12 Theorem.
Let X ∈Xr(M), r ≥1, m be an equilibrium of X, and L a strict Liapunov function
for X at m. Then m is asymptotically stable if any one of the following conditions hold:
(i)
M is ﬁnite dimensional;
(ii)
solutions starting near m stay in a compact set (i.e., trajectories are precompact);
(iii)
in a chart ϕ : V →E satisfying (iii) in Deﬁnition 4.3.10 the following inequality is valid for some
constant a > 0
X[L](x) ≤−a∥X(x)∥.
Proof.
We can assume M = E, and m = 0. By Theorem 4.3.11, 0 is stable, so if tn is an increasing
sequence, tn →∞, and x(t) is an integral curve of X starting in U ′ (see the proof of Theorem 4.3.11), the
sequence {x(tn)} in E has a convergent subsequence in cases (i) and (ii). Let us show that under hypothesis
(iii), {x(tn)} is Cauchy, so by completeness of E it is convergent. For t > s, the inequality
L(x(t)) −L(x(s)) =
 t
s
X[L](x(λ)) dλ ≤−a
 t
s
∥X(x(λ))∥< 0,
implies that
L(x(s)) −L(x(t)) ≥a
 t
s
∥X(x(λ))∥dλ
≥a

 t
s
X(x(λ)) dλ

= a∥x(t) −x(s)∥,
which together with the continuity of λ 
→L(x(λ)) shows that {x(tn)} is a Cauchy sequence. Thus, in all
three cases, there is a sequence tn →+∞such that x(tn) →x0 ∈Dε(0), Dε(0) being given in the proof
of Theorem 4.3.11. We shall prove that x0 = 0. Since L(x(t)) is a strictly decreasing function of t by (ii)′,
L(x(t)) > L(x0) for all t > 0. If x0 ̸= 0, let c(t) be the solution of X starting at x0, so that L(c(t)) < L(x0),
again since t 
→L(x(t)) is strictly decreasing. Thus, for any solution ˜c(t) starting close to x0, L(˜c(t)) < L(x0)
by continuity of L. Now take ˜c(0) = x(tn) for n large to get the contradiction L(x(tn+t)) < L(x0). Therefore
x0 = 0 is the only limit point of { x(t) | t ≥0 } if x(0) ∈U ′, that is, 0 is asymptotically stable.
■
The method of Theorem 4.3.12 can be used to detect the instability of equilibrium solutions.
4.3.13 Theorem.
Let m be an equilibrium point of X ∈Xr(M), r ≥1. Assume there is a continuous
function L : U →M deﬁned in a neighborhood of U of m, which is diﬀerentiable on U\{m}, and satisfyies
L(m) = 0, X[L] ≥a > 0 (respectively, ≤a < 0) on U\{m}. If there exists a sequence mk →m such that
L(mk) > 0 (respectively, < 0), then m is unstable.
Proof.
We need to show that there is a neighborhood W of m such that for any neighborhood V of m,
V ⊂U, there is a point mV whose integral curve leaves W. Since m is an equilibrium, by Corollary 4.1.25,
there is a neighborhood W1 ⊂U of m such that each integral curve starting in W1 exists for time at least
1/a. Let W = { m ∈W1 | L(m) < 1/2 }. We can assume M = E, and m = 0. Let cn(t) denote the integral
curve of X with initial condition mn ∈W. Then
L(cn(t)) −L(mn) =
 t
0
X[L](cn(λ)) dλ ≥at

4.3 An Introduction to Dynamical Systems
263
so that
L(cn(1/a)) ≥1 + L(mn) > 1,
that is, cn(1/a) ̸∈W. Thus all integral curves starting at the points mn ∈W leave W after time at most
1/a. Since mn →0, the origin is unstable.
■
Note that if M is ﬁnite dimensional, the condition X[L] ≥a > 0 can be replaced by the condition
X[L] > 0; this follows, as usual, by local compactness of M.
4.3.14 Examples.
A.
The vector ﬁeld
X(x, y) = (−y −x5) ∂
∂x + (x −2y3) ∂
∂y ∈X(R2)
has the origin as an isolated equilibrium. The characteristic exponents of X at (0, 0) are ±i and so Liapunov’s
Stability Criterion (Theorem 4.3.4) does not give any information regarding the stability of the origin. If
we suspect that (0, 0) is asymptotically stable, we can try searching for a Liapunov function of the form
L(x, y) = ax2 + by2, so we need to determine the coeﬃcients a, b, ̸= 0 in such a way that X[L] < 0. We have
X[L] = 2ax(−y −x5) + 2by(x −2y3) = 2xy(b −a) −2ax6 −4by4,
so that choosing a = b = 1, we get X[L] = −2(x6 + 2y4) which is strictly negative if (x, y) ̸= (0, 0). Thus
the origin is asymptotically stable by Theorem 4.3.12.
B.
Consider the vector ﬁeld
X(x, y) = (−y + x5) ∂
∂x + (x + 2y3) ∂
∂y
with the origin as an isolated critical point and characteristic exponents ±i. Again Liapunov’s Stability
Criterion cannot be applied, so that we search for a function L(x, y) = ax2 + by2, a, b ̸= 0 in such a way
that X[L] has a deﬁnite sign. As above we get
X[L] = 2ax(−y + x5) + 2by(x + 2y3) = 2xy(b −a) + 2ax6 + 4by4,
so that choosing a = b = 1, it follows that X[L] = 2(x6 +y4) > 0 if (x, y) ̸= (0, 0). Thus, by Theorem 4.3.13,
the origin is unstable.
These two examples show that if the spectrum of X lies on the imaginary axis, the stability nature of the
equilibrium is determined by the nonlinear terms.
C.
Consider Newton’s equations in R3, ¨q = −(1/m)∇V (q) written as a ﬁrst order system ¨q = v, ¨v =
−(1/m)∇V (q) and so deﬁne a vector ﬁeld X on R3 × R3. Let (q0, v0) be an equilibrium of this system, so
that v0 = 0 and ∇V (q0) = 0. In Example 4.1.23B we saw that the total energy
E(q, v) = 1
2m∥v∥2 + V (q)
is conserved, so we try to use E to construct a Liapunov function L. Since L(q0, 0) = 0, deﬁne
L(q, v) = E(q, v) −E(q0, 0) = 1
2m∥v∥2 + V (q −V (q0),
which satisﬁes X[L] = 0 by conservation of energy. If V (q) > V (q0) for q ̸= q0, then L is a Liapunov
function. Thus we have proved
Lagrange’s Stability Theorem: an equilibrium point (q0, 0) of Newton’s equations for a particle of mass
m, moving under the inﬂuence of a potential V , which has a local absolute minimum at q0, is stable.

264
4. Vector Fields and Dynamical Systems
D.
Let E be a Banach space and L : E →R be C2 in a neighborhood of 0. If DL(0) = 0 and there is a
constant c > 0 such that D2L(0)(e, e) > c∥e∥2 for all e, then 0 lies in a potential well for L (i.e., (ii) and
(iii) of Deﬁnition 4.3.10 hold). Indeed, by Taylor’s theorem 2.4.15,
L(h) −L(0) = 1
2D2L(0)(h, h) + o(h2) ≥c∥h∥2
2
+ o(h2).
Thus, if δ > 0 is such that for all ∥h∥< δ, |o(h2)| ≤c∥h∥2/4, then L(h) −L(0) > c∥h∥2/4, that is,
inf
∥h∥=ε[L(h) −L(0)] ≥cε
4
for ε < δ.
♦
In many basic inﬁnite dimensional examples, some technical sharpening of the preceding ideas is necessary
for them to be applicable. We refer the reader to LaSalle [1976], Marsden and Hughes [1983, Section 6.6],
Hale, Magalhaes and Oliva [1984], and Holm, Marsden, Ratiu, and Weinstein [1985] for more information.
Next we turn to cases where the equilibirum need not be stable.
A critical point is called hyperbolic or elementary if none of its characteristic exponents has zero real
part. A generalization of Liapunov’s theorem called the Hartman–Grobman theorem shows that near
a hyperbolic critical point the ﬂow looks like that of its linearization. (See Hartman [1973, Chapter 9]
and Nelson [1969, Chapter 3], for proofs and discussions.) In the plane, the possible hyperbolic ﬂows near
a critical point are summarized in the table below and shown in Figure 4.3.2. (Remember that for real
systems, the characteristic exponents occur in conjugate pairs.)
Eigenvalues
Real Jordan
Name
Part of
form
Fig. 4.3.2
λ1 < 0 < λ2
λ1 < λ2 < 0
λ1 = λ2 < 0

λ1
0
0
λ2

saddle
stable focus
stable node
(a)
(b)
(c)
λ1 = λ2 < 0

λ1
0
1
λ2

stable improper
node
(d)
λ1 = a + ib, a < 0
λ2 = a −ib, b ̸= 0

a
−b
b
a

stable spiral
sink
(e)
λ1 = ib, λ2 = −ib,
b ̸= 0

0
−b
b
0

center
(f)
In cases 1 to 5, all arrows in the phase portraits are reversed and “stable” is replaced by “unstable,” if
the signs of λ1, λ2, are changed. In the original coordinate system (x1, x2) all phase portraits in Figure 4.3.2
are rotated and sheared.
To understand the higher dimensional case, a little more spectral theory is required.
4.3.15 Lemma.
Suppose σ(T) = σ1∪σ2 where d(σ1, σ2) > 0. Then there are unique T-invariant subspaces
E1 and E2 such that E = E1 ⊕E2, σ(Ti) = σi, where Ti = T|Ei; Ei is called the generalized eigenspace
of σi.
The basic idea of the proof is this: let γj be a closed curve with σj in its interior and σk, k ̸= j, in its
exterior; then
Tj =
1
2πi

γj
dz
zI −T .

4.3 An Introduction to Dynamical Systems
265
(a)
(b)
(c)
(d)
(e)
(f)
Figure 4.3.2. Phase portraits for two dimensional equilibria
Note that the eigenspace of an eigenvalue λ is not always the same as the generalized eigenspace of λ. In
the ﬁnite dimensional case, the generalized eigenspace of T is the subspace corresponding to all the Jordan
blocks containing λ in the Jordan canonical form.
4.3.16 Lemma.
Let T, σ1, and σ2 be as in Lemma 4.3.15; assume
d(exp(σ1), exp(σ2)) > 0.
Then for the operator exp(tT), the generalized eigenspace of exp(tTi) is Ei.
Proof.
Write, according to Lemma 4.3.15, E = E1 ⊕E2. Thus
etT (e1, e2) =
∞
	
n=0
tnT n
n! (e1, e2) =
∞
	
n=0
tnT n
n! e1, tnT n
n! e2

=
 ∞
	
n=0
tnT n
n! e1,
∞
	
n=0
tnT n
n! e2

= (etT1e1, etT2e2).
From this the result follows easily.
■
Now we discuss the generic nonlinear case; that is, let m be a hyperbolic equilibrium of the vector ﬁeld
X and let Ft be its ﬂow. Deﬁne the inset of m by
In(m) = { m′ ∈M | Ft(m′) →m as t →+∞}
and similarly, the outset is deﬁned by
Out(m) = { m′ ∈M | Ft(m′) →m as t →−∞}.
In the case of a linear system, ˙x = Ax, where A has no eigenvalue on the imaginary axis (so the origin is
a hyperbolic critical point), In(0) is the generalized eigenspace of the eigenvalues with negative real parts,
while Out(0) is the generalized eigenspace corresponding to the eigenvalues with positive real parts. Clearly,
these are complementary subspaces. The dimension of the linear subspace In(0) is called the stability index
of the critical point. The Hartman–Grobman linearization theorem states that the phase portrait of
X near m is topologically conjugate to the phase portrait of the linear system ˙x = Ax, near the origin,
where A = X′(m), the linearized vector ﬁeld at m. This means there is a homeomorphism of the two
domains, preserving the oriented trajectories of the respective ﬂows. Thus in this nonlinear hyperbolic case,
the inset and outset are C0 submanifolds. Another important theorem of dynamical systems theory, the

266
4. Vector Fields and Dynamical Systems
In(m0)
Out(m0)
Figure 4.3.3. Insets and outsets
stable manifold theorem (Smale [1967]) says that in addition, these are smooth, injectively immersed
submanifolds, intersecting transversally at the critical point m. See Figure 4.3.3 for an illustration showing
part of the inset and outset near the critical point.
It follows from these important results that there are (up to topological conjugacy) only a few essentially
diﬀerent phase portraits, near hyperbolic critical points. These are classiﬁed by the dimension of their insets,
called the stability index, which is denoted by S(X, m) for m an equilibrium, as in the linear case.
The word index comes up in this context with another meaning. If M is ﬁnite dimensional and m is a
critical point of a vector ﬁeld X, the topological index of m is +1 if the number of eigenvalues (counting
multiplicities) with negative real part is even and is −1 if it is odd. Let this index be denoted I(X, m), so
that I(X, m) = (−1)S(X,m). The Poincar´e–Hopf index theorem states that if M is compact and X
only has (isolated) hyperbolic critical points, then
	
m is a critical
point of X
I(X, m) = χ(M)
where χ(M) is the Euler–Poincar´e characteristic of M. For isolated nonhyperbolic critical points the index
is also deﬁned but requires degree theory for its deﬁnition—a kind of generalized winding number; see §7.5
or Guillemin and Pollack [1974, p. 133].
We now illustrate these basic concepts about critical points with some classical applications.
4.3.17 Examples.
A.
The simple pendulum with linear damping is deﬁned by the second-order equation
¨x + c ˙x + k sin x = 0
(c > 0).
This is equivalent to the following dynamical system whose phase portrait is shown in Figure 4.3.4:
˙x = v,
˙v = −cv −k sin x.
The stable focus at the origin represents the motionless, hanging pendulum. The saddle point at (kπ, 0)
corresponds to the motionless bob, balanced at the top of its swing.

4.3 An Introduction to Dynamical Systems
267
σ
π
-π
Figure 4.3.4. The pendulum with linear damping
B.
Another classical equation models the buckling column (see Stoker [1950, Chapter 3, Section 10]):
m¨x + c ˙x + a1x + a3x3 = 0
(a1 < 0, a3, c > 0),
or equivalently, the planar dynamical system
˙x = v,
˙v = −cv
m −a1x
m −a3x3
m
with the phase portrait shown in Figure 4.3.5. This has two stable foci on the horizontal axis, denoted m1
and m2, corresponding to the column buckling (due to a heavy weight on the top) to either side. The saddle
at the origin corresponds to the unstable equilibrium of the straight, unbuckled column.
m2
m1
x
υ
Figure 4.3.5. Phase portrait of the buckling column
Note that in this phase portrait, some initial conditions tend toward one stable focus, while some tend
toward the other. The two tendencies are divided by the curve, In(0, 0), the inset of the saddle at the origin.

268
4. Vector Fields and Dynamical Systems
Figure 4.3.6. Basins of attraction of ¨x + ˙x −x + x3 = 0
This is called the separatrix, as it separates the domain into the two disjoint open sets, In(m0) and In(m1).
The stable foci are called attractors, and their insets are called their basins. See Figure 4.3.6 for the special
case ¨x+ ˙x−x+x3 = 0. This is a special case of a general theory, which is increasingly important in dynamical
systems applications. The attractors are regarded as the principal features of the phase portrait; the size of
their basins measures the probability of observing the attractor, and the separatrices help ﬁnd them.
♦
Another basic ingredient in the qualitative theory is the notion of a closed orbit, also called a limit
cycle.
4.3.18 Deﬁnition.
An orbit γ(t) for a vector ﬁeld X is called closed when γ(t) is not a ﬁxed point and
there is a τ > 0 such that γ(t + τ) = γ(t) for all t. The inset of γ, In(γ), is the set of points m ∈M such
that Ft(m) →γ as t →+∞(i.e., the distance between Ft(m) and the (compact) set { γ(t) | 0 ≤t ≤τ }
tends to zero as t →∞). Likewise, the outset, Out(γ), is the set of points tending to γ as t →−∞.
4.3.19 Example.
One of the earliest occurrences of an attractive closed orbit in an important application
is found in Baron Rayleigh’s model for the violin string (see Rayleigh [1887, Volume 1, Section 68a]),
¨u + k1 ˙u + k3 ˙u3 + ω2u = 0,
k1 < 0 < k3,
or equivalently,
˙u = v,
˙v = −k1v −k3v3 −ω2u,
with the phase portrait shown in Figure 4.3.7.
This phase portrait has an unstable focus at the origin, with an attractive closed orbit around it. That is,
the closed orbit γ is a limiting set for every point in its basin (or inset) In(γ), which is an open set of the
domain. In fact the entire plane (excepting the origin) comprises the basin of this closed orbit. Thus every
trajectory tends asymptotically to the limit cycle γ and winds around closer and closer to it. Meanwhile this
closed orbit is a periodic function of time, in the sense of Deﬁnition 4.3.18. Thus the eventual (asymptotic)
behavior of every trajectory (other than the unstable constant trajectory at the origin) is periodic; it is an
oscillation.
This picture thus models the sustained oscillation of the violin string, under the inﬂuence of the moving
bow. Related systems occur in electrical engineering under the name van der Pol equation. (See Hirsch and
Smale [1974, Chapter 10] for a discussion.)
♦

4.3 An Introduction to Dynamical Systems
269
Figure 4.3.7. Rayleigh equation
We now proceed toward the analog of Liapunov’s theorem for the stability of closed orbits. To do this we
need to introduce Poincar´e maps and characteristic multipliers.
4.3.20 Deﬁnition.
Let X be a Cr vector ﬁeld on a manifold M, r ≥1. A local transversal section
of X at m ∈M is a submanifold S ⊂M of codimension one with m ∈S and for all s ∈S, X(s) is not
contained in TsS.
Let X be a Cr vector ﬁeld on a manifold M with Cr ﬂow F : DX ⊂M × R →M, γ a closed orbit of X
with period τ, and S a local transversal section of X at m ∈γ. A Poincar´e map of γ is a Cr mapping
Θ : W0 →W1 where:
PM1.
W0, W1 ⊂S are open neighborhoods of m ∈S, and Θ is a Cr diﬀeomorphism;
PM2.
there is a Cr function δ : W0 →R such that for all s ∈W0, (s, τ −δ(s)) ∈DX, and
Θ(s) = F(s, τ −δ(s)); and ﬁnally,
PM3.
if t ∈[0, τ −δ(s)], then F(s, t) ̸∈W0 (see Figure 4.3.8).
4.3.21 Theorem (Existence and Uniqueness of Poincar´e Maps).
(i)
If X is a Cr vector ﬁeld on M, and γ is a closed orbit of X, then there exists a Poincar´e map of γ.
(ii)
If Θ : W0 →W1 is a Poincar´e map of γ (in a local transversal section S at m ∈γ) and Θ′ also (in S′
at m′ ∈γ), then Θ and Θ′ are locally conjugate. That is, there are open neighborhoods W2 of m ∈S,
W ′
2 of m′ ∈S′, and a Cr-diﬀeomorphism H : W2 →W ′
2, such that
W2 ⊂W0 ∩W1,
W ′
2 ⊂W ′
0 ∩W ′
1
and the following diagram commutes:
Θ−1(W2) ∩W2
W2 ∩Θ(W2)
W ′
2
S′
Θ
Θ
H
H
✲
✲
❄
❄

270
4. Vector Fields and Dynamical Systems
Figure 4.3.8. Poincar´e maps
Proof.
(i)
At any point m ∈γ we have X(m) ̸= 0, so there exists a ﬂow box chart (U, ϕ) at m with
ϕ(U) = V ×I ⊂Rn−1×R. Then S = ϕ−1(V ×{0}) is a local transversal section at m. If F : DX ⊂M×R →M
is the integral of X, DX is open, so we may suppose U × [−τ, τ] ⊂DX, where τ is the period of γ. As
Fτ(m) = m ∈M and Fτ is a homeomorphism, U0 = F −1
τ
(U) ∩U is an open neighborhood of m ∈M with
Fτ(U0) ⊂U. Let W0 = S ∩U0 and W2 = Fτ(W0). Then W2 is a local transversal section at m ∈M and
Fτ : W0 →W2 is a diﬀeomorphism (see Figure 4.3.9).
S
U
U0
W0
W2
γ
Figure 4.3.9. Coordinates adapted to a periodic orbit
If U2 = Fτ(U0), then we may regard U0 and U2 as open submanifolds of the vector bundle V × R (by
identiﬁcation using ϕ) and then Fτ : U0 →U2 is a Cr diﬀeomorphism mapping ﬁbers into ﬁbers, as ϕ
identiﬁes orbits with ﬁbers, and Fτ preserves orbits. Thus W2 is a section of an open subbundle. More
precisely, if π : V × I →V and ρ : V × I →I are the projection maps, then the composite mapping is Cr
and
W0
F τ
→W2
ϕ→V × I
π→V
ϕ−1
→S
has a tangent that is an isomorphism at each point, and so by the inverse mapping theorem, it is a Cr
diﬀeomorphism onto an open submanifold. Let W1 be its image, and Θ the composite mapping.
We now show that Θ : W0 →W1 is a Poincar´e map. Obviously PM1 is satisﬁed. For PM2, we identify
U and V × I by means of ϕ to simplify notations. Then π : W2 →W1 is a diﬀeomorphism, and its inverse

4.3 An Introduction to Dynamical Systems
271
(π|W2)−1 : W1 →W2 ⊂W1 × R is a section corresponding to a smooth function σ : W1 →R. In fact, σ is
deﬁned implicitly by
Fτ(w0) = (π ◦Fτ(w0), ρ ◦Fτ(w0)) = (π ◦Fτ(w0), σ ◦πFτ(w0))
or ρ ◦Fτ(w0) = σ ◦πFτ(w0). Now let δ : W0 →R be given by w0 
→σ ◦Ft(w0) which is Cr. Then we have
Fτ−δ(w0)(w0) = (F−δ(w0) ◦Fτ)
= (π ◦Fτ(w0), ρ ◦Fτ(w0) −δ(w0))
= (π ◦Fτ(w0), 0)
= Θ(w0).
Finally, PM3 is obvious since (U, ϕ) is a ﬂow box.
(ii) The proof is burdensome because of the notational complexity in the deﬁnition of local conjugacy, so we
will be satisﬁed to prove uniqueness under additional simplifying hypotheses that lead to global conjugacy
(identiﬁed by italics). The general case will be left to the reader.
We consider ﬁrst the special case m = m′. Choose a ﬂow box chart (U, ϕ) at m, and assume S ∪S′ ⊂U,
and that S and S′ intersect each orbit arc in U at most once, and that they intersect exactly the same sets of
orbits. (These three conditions may always be obtained by shrinking S and S′.) Then let W2 = S, W ′
2 = S′,
and H : W2 →W ′
2 the bijection given by the orbits in U. As in (i), this is seen to be a Cr diﬀeomorphism,
and H ◦Θ = Θ′ ◦H.
Finally, suppose m ̸= m′. Then Fa(m) = m′ for some a ∈]0, τ[, and as DX is open there is a neighborhood
U of m such that U × {a} ⊂DX. Then Fa(U ∩S) = S′′ is a local transversal section of X at m′ ∈γ, and
H = Fa eﬀects a conjugacy between Θ and Θ′′ = Fa ◦Θ ◦F −1
a
on S′′. By the preceding paragraph, Θ′′ and
Θ′ are locally conjugate, but conjugacy is an equivalence relation. This completes the argument.
■
If γ is a closed orbit of X ∈X(M) and m ∈γ, the behavior of nearby orbits is given by a Poincar´e map Θ
on a local transversal section S at m. Clearly TmΘ ∈L(TmS, TmS) is a linear approximation to Θ at m. By
uniqueness of Θ up to local conjugacy, Tm′Θ′ is similar to TmΘ, for any other Poincar´e map Θ′ on a local
transversal section at m′ ∈γ. Therefore, the spectrum of TmΘ is independent of m ∈γ and the particular
section S at m.
4.3.22 Deﬁnition.
If γ is a closed orbit of X ∈X(M), the characteristic multipliers of X at γ are
the points in the spectrum of TmΘ, for any Poincar´e map Θ at any m ∈γ.
Another linear approximation to the ﬂow near γ is given by TmFτ ∈L(TmM, TmM) if m ∈γ and τ
is the period of γ. Note that F ∗
τ (X(m)) = X(m), so TmFτ always has an eigenvalue 1 corresponding to
the eigenvector X(m). The (n −1) remaining eigenvalues (if dim(M) = n) are in fact the characteristic
multipliers of X at γ.
4.3.23 Proposition.
If γ is a closed orbit of X ∈X(M) of period τ and cγ is the set of characteristic
multipliers of X at γ, then cγ ∪{1} is the spectrum of TmFτ, for any m ∈γ.
Proof.
We can work in a chart modeled on E and assume m = 0. Let V be the span of X(m) so
E = TmM ⊕V . Write the ﬂow Ft(x, y) = (F 1
t (x, y), F 2
t (x, y)). By deﬁnition, we have
D1F 1
t (m) = TmΘ
and
D2F 2
τ (m) · X(m) = X(m).
Thus the matrix of TmFτ is of the form

TmΘ
0
A
1

where A = D1F 2
τ (m). From this it follows that the spectrum of TmFτ is {1} ∪cγ.
■

272
4. Vector Fields and Dynamical Systems
If the characteristic exponents of an equilibrium point lie (strictly) in the left half-plane, we know from
Liapunov’s theorem that the equilibrium is stable. For closed orbits we introduce stability by means of the
following deﬁnition.
4.3.24 Deﬁnition.
Let X be a vector ﬁeld on a manifold M and γ a closed orbit of X. An orbit Ft(m0)
is said to wind toward γ if m0 is + complete and for any local transversal section S to X at m ∈γ there
is a t(0) such that Ft(0)(m0) ∈S and successive applications of the Poincar´e map yield a sequence of points
that converges to m. If the closed orbit γ has a neighborhood U such that for any m0 ∈U, the orbit through
m0 winds towards γ, then γ is called asymptotically stable.
In other words, orbits starting “close” to γ, “converge” to γ; see Figure 4.3.10.
m0
Figure 4.3.10. Stable periodic orbit
4.3.25 Proposition.
If γ is an asymptotically stable periodic orbit of the vector ﬁeld X and m0 ∈U, the
neighborhood given in Deﬁnition 4.3.24, then for any neighborhood V of γ, there exists t0 > 0 such that for
all t ≥t0, Ft(m) ∈V .
Proof.
Deﬁne mk = Θk(m0), where Θ is a Poincar´e map for a local transversal section at m to γ containing
m0. Let t(n) be the “return time” of n, that is, t(n) is deﬁned by Ft(n)(n) ∈S. If τ denotes the period of γ
and τk = t(mk), then since mk →m, it follows that τk →τ since t(n) is a smooth function of n by Theorem
4.3.21. Let M be an upper bound for the set { |τk| | k ∈N }. By smoothness of the ﬂow, Fs(mk) →Fs(m)
as k →∞, uniformly in s ∈[0, M]. Now write for any t > 0, Ft(m0) = FT (t)(mk(t)), for T(t) ∈[0, M] and
observe that k(t) →∞as t →∞. Therefore, if W is any neighborhood of FT (t)(m0) contained in V , since
Ft(m0) = FT (t)(mk(t)) converges to FT (t)(m) as t →∞it follows that there exists t0 > 0 such that for all
t ≥t0, Ft(m0) ∈W ⊂V .
■
4.3.26 Theorem (Liapunov Stability Theorem for Closed Orbits).
Let γ be a closed orbit of X ∈X(M)
and let the characteristic multipliers of γ lie strictly inside the unit circle. Then γ is asymptotically stable.
The proof relies on the following lemma.
4.3.27 Lemma.
Let T : E →E be a bounded linear operator. Let σ(T) lie strictly inside the unit circle.
Then limn→∞T ne = 0 for all e ∈E.
Proof.
By Lemma 4.3.7 and compactness of σ(T), there is a norm | | on E equivalent to the original norm
on E such that |T| ≤r < 1. Therefore |T ne| ≤rn|e| →0 as n →∞.
▼
4.3.28 Lemma.
Let f : S →S be a smooth map on a manifold S with f(s) = s for some s. Let the
spectrum of Tsf lie strictly inside the unit circle. Then there is a neighborhood U of s such that if s′ ∈U,
f(s′) ∈U and f n(s′) →s as n →∞, where f n = f ◦f ◦· · · ◦f (n times).
Proof.
We can assume that S is a Banach space E and that s = 0. As above, renorm E and ﬁnd 0 < r < 1
such that |T| ≤r, where T = Df(0). Let ε > 0 be such that r + ε < 1. Choose a neighborhood V of 0 such
that for all x ∈V
|f(x) −Tx| ≤ε|x|

4.3 An Introduction to Dynamical Systems
273
which is possible since f is smooth. Therefore,
|f(x)| ≤|Tx| + ε|x| ≤(r + ε)|x|.
Now, choose δ > 0 such that the ball U of radius δ at 0 lies in V . Then the above inequality implies
|f n(x)| ≤(r + ε)n|x| for all x ∈U which shows that f n(x) ∈U and f n(x) →0.
▼
Proof of Theorem 4.3.26.
The previous lemma applied to f = Θ, a Poincar´e map in a transversal slice
S to γ at m, implies that there is an open neighborhood V of m in S such that the orbit through every point
of V winds toward γ. Thus, the orbit through every point of U = { Ft(m) | t ≥0 } ⊃γ winds toward γ. U
is a neighborhood of γ since by the straightening out theorem 4.1.14, each point of γ has a neighborhood
contained in { Ft(Θ(U)) | t > −ε, ε > 0 }.
■
4.3.29 Deﬁnition.
If X ∈X(M) and γ is a closed orbit of X, γ is called hyperbolic if none of the
characteristic multipliers of X at γ has modulus 1.
Hyperbolic closed orbits are isolated (see Abraham and Robbin [1967, Chapter 5]). The local qualitative
behavior near an hyperbolic closed orbit, γ, may be visualized with the aid of the Poincar´e map, Θ : W0 ⊂
S →W1 ⊂S, as shown in Figure 4.3.8. The qualitiative behavior of this map, under iterations, determines
the asymptotic behavior of the trajectories near γ. Let m ∈γ be the base point of the section, and s ∈S.
Then In(γ), the inset of γ, intersects S in the inset of m under the iterations of Θ. That is, s ∈In(γ) if the
trajectory Ft(s) winds towards γ, and this is equivalent to saying that Θk(s) tends to m as k →+∞.
The inset and outset of m ∈S are classiﬁed by linear algebra, as there is an analogue of the linearization
theorem for maps at hyperbolic critical points. The linearization theorem for maps says that there is a
C0 coordinate chart on S, in which the local representative of Θ is a linear map. Recall that in the hyperbolic
case, the spectrum of this linear isomorphism avoids the unit circle. The eigenvalues inside the unit circle
determine the generalized eigenspace of contraction that is, the inset of m ∈S under the iterates of Θ. The
eigenvalues outside the unit circle similarly determine the outset of m ∈S. Although this argument provides
only local C0 submanifolds, the global stable manifold theorem improves this: the inset and outset of a
ﬁxed point of a diﬀeomorphism are smooth, injectively immersed submanifolds meeting transversally at m.
Returning to closed orbits, the inset and outset of γ ⊂M may be visualized by choosing a section Sm at
every point m ∈γ. The inset and outset of γ in M intersect each section Sm in submanifolds of Sm, meeting
transversally at m ∈γ. In fact, In(γ) is a cylinder over γ, that is, a bundle of injectively immersed disks. So,
likewise, is Out(γ). And these two cylinders intersect transversally in γ, as shown in Figure 4.3.11. These
bundles need not be trivial.
Figure 4.3.11. Insets and outsets for periodic orbits
Another argument is sometimes used to study the inset and outset of a closed orbit, in place of the
Poincar´e section technique described before, and is originally due to Smale [1967]. The ﬂow Ft leaves the
closed orbit invariant. A special coordinate chart may be found in a neighborhood of γ. The neighborhood

274
4. Vector Fields and Dynamical Systems
is a disk bundle over γ, and the ﬂow Ft, is a bundle map. On each ﬁber, Ft is a linear map of the form
ZteRt, where Zt is a constant, and R is a linear map. Thus, if s = (m, x) is a point in the chart, the local
representative of Ft is given by the expression
Ft(m, x) = (mt, ZteRt · x)
called the Floquet normal form. This is the linearization theorem for closed orbits. A related result,
the Floquet theorem, eliminates the dependence of Zt on t, by making a further (time-dependent) change
of coordinates (see Hartman [1973, Chapter 4, Section 6], or Abraham and Robbin [1967]). Finally, linear
algebra applied to the linear map R in the exponent of the Floquet normal form, establishes the C0 structure
of the inset and outset of γ.
To get an overall picture of a dynamical system in which all critical elements (critical points and closed
orbits) are hyperbolic, we try to draw or visualize the insets and outsets of each. Those with open insets are
attractors, and their open insets are their basins. The domain is divided into basins by the separatrices,
which includes the insets of all the nonattractive (saddle-type) critical elements (and possible other, more
complicated limit sets, called chaotic attractors, not described here.)
We conclude with an example of suﬃcient complexity, which has been at the center of dynamical system
theory for over a century.
4.3.30 Example.
The simple pendulum equation may be “simpliﬁed” by approximating sin x by two
terms of its MacLaurin expansion. The resulting system is a model for a nonlinear spring with linear
damping,
˙x = v,
˙v = −cv −kx + k
3x3.
Adding a periodic forcing term, we have
˙x = v,
˙v = −cv −kx + k
3x4 + F cos ωt.
This time-dependent system in the plane is transformed into an autonomous system in a solid ring by adding
an angular variable proportional to the time, θ = ωt. Thus,
˙x = v,
˙x = −cv −kx + k
3x3 + F cos θ,
˙θ = ω
Although this was introduced by Baron Rayleigh to study the resonance of tuning forks, piano strings, and
so on, in his classic 1877 book, Theory of Sound , this system is generally named the Duﬃng equation
after Duﬃng who obtained the ﬁrst important results in 1908 (see Stoker [1950] for additional information).
♦
Depending on the values of the three parameters (c, k, F) various phase portraits are obtained. One of
these is shown in Figure 4.3.12, adapted from the experiments of Hayashi [1964]. There are three closed
orbits: two attracting, one of saddle type. The inset of the saddle is a cylinder topologically, but the whole
cylinder revolves around the saddle-type closed orbit. This cylinder is the separatrix between the two basins.
For other parameter values the dynamics can be chaotic (see for example, Holmes [1979a, 1979b] and Ueda
[1980]).
For further information on dynamical systems, see, for example, Guckenheimer and Holmes [1983].
Exercises
⋄4.3-1.
(i)
Let E →M be a vector bundle and m ∈M an element of the zero section. Show that TmE
is isomorphic to TmM ⊕Em in a natural, chart independent way.

4.3 An Introduction to Dynamical Systems
275
Figure 4.3.12. Phase portrait for the nonlinear spring with linear damping and forcing.
(ii)
If ξ : M →E is a section of E, and ξ(m) = 0, deﬁne ξ′(m) : TmM →Em to be the projection of Tmξ
to Em. Write out ξ′(m) relative to coordinates.
(iii)
Show that if X is a vector ﬁeld, then X′(m) deﬁned this way coincides with Deﬁnition 4.3.1.
⋄4.3-2.
Prove that the equation ¨θ + 2k ˙θ −q sin θ = 0 (q > 0, k > 0) has a saddle point at θ = 0, ˙θ = 0.
⋄4.3-3.
Consider the diﬀerential equations ˙r = ar3 −br, ˙θ = 1 using polar coordinates in the plane.
(i)
Determine those a, b for which this system has an attractive periodic orbit.
(ii)
Calculate the eigenvalues of this system at the origin for various a, b.
⋄4.3-4.
Let X ∈X(M), ϕ : M →N be a diﬀeomorphism, and Y = ϕ∗X. Show that
(i)
m ∈M is a critical point of X iﬀϕ(m) is a critical point of Y and the characteristic exponents are
the same for each;
(ii)
γ ⊂M is a closed orbit of X iﬀϕ(γ) is a closed orbit of Y and their characteristic multipliers are the
same.
⋄4.3-5.
The energy for a symmetric heavy top is
H(θ, pθ) =
1
2I sin2 θ
 
p2
ψ(b −cos θ)2 + p2
θ sin2 θ
!
+
p2
ψ
J Mgℓcos θ
where I, J > 0, b, pψ, and Mgℓ> 0 are constants. The dynamics of the top is described by the diﬀerential
equations ˙θ = ∂H/∂pθ, ˙pθ = −∂H/∂θ.
(i)
Show that θ = 0, pθ = 0 is a saddle point if
0 < pψ < 2(MgℓI)1/2
(a slow top).
(ii)
Verify that cos θ = 1 −γ sech2((βγ)1/2/2), where γ = 2 −b2/β and β = 2Mgℓ/I describe both the
outset and inset of this saddle point. (This is called a homoclinic orbit.)
(iii)
Is θ = 0, pθ = 0 stable if pψ > (MgℓI)1/2?
Hint: Use the fact that H is constant along the trajectories.

276
4. Vector Fields and Dynamical Systems
⋄4.3-6.
Let A ∈L(Rn, Rn) and suppose that a < Re(λi) < b, for all eigenvalues λi, i = 1, . . . , n of A. Show
that Rn admits an inner product ⟨⟨, ⟩⟩with associated norm ||| · ||| such that
a|||x|||2 ≤⟨⟨Ax, x⟩⟩≤b|||x|||2.
Prove this by following the outline below.
(i)
If A is diagonalizable over C, then ﬁnd a basis in Rn in which the matrix of A has either the entries
on the diagonal, the real eigenvalues of A, or 2 × 2 blocks of the form

aj
−bj
bj
aj

,
for λj = aj + ibj, if bj ̸= 0
Choose the inner product ⟨⟨, ⟩⟩on Rn such that the one and two-dimensional invariant subspaces of
A deﬁned by this block-matrix are mutually orthogonal; pick the standard R2-basis in the associated
two-dimensional spaces.
(ii)
If A is not diagonalizable, then pass to the real Jordan form. There are two kinds of Jordan kj × kj
blocks:


λj
0
0
· · ·
0
0
1
λj
0
· · ·
0
0
0
1
λj
· · ·
0
0
· · ·
· · ·
· · ·
0
· · ·
· · ·
1
λj


,
if λj ∈R, or


∆j
0
0
· · ·
0
0
I2
∆j
0
· · ·
0
0
0
I2
∆j
· · ·
0
0
· · ·
· · ·
· · ·
0
· · ·
· · ·
I2
∆j


where
∆j =
aj
−bj
bj
aj

,
I2 =
1
0
0
1

,
if λj = aj+ibj, aj, bj ∈R, bj ̸= 0. For the ﬁrst kind of block, choose the basis e′
1, . . . , e′
k(j) of eigenvectors
of the diagonal part, which we call D. Then, for ε > 0 small, put eε
r = e′
r/er−1, r = 1, . . . , k(j) and
deﬁne ⟨, ⟩ε on the subspace span{eε
1, . . . , eε
k(j)} ⊂Rn to be the Euclidean inner product given by this
basis. Compute the marix of A in this basis and show that
⟨Ax, x⟩ε
⟨x, x⟩ε
→Dx · x
∥x∥2 ,
as
ε →0.
Conclude that for ε small the statement holds for the ﬁrst kind of block. do the same for the second
kind of block.

4.3 An Introduction to Dynamical Systems
277
⋄4.3-7.
Let A ∈L(Rn, Rn). Show that the following are equivalent.
(i)
All eigenvalues of A have strictly negative real part (the origin is called a sink in this case).
(ii)
For any norm | · | on Rn, there exist constants k > 0 and ε > 0 such that for all t ≥0, |etA| ≤ke−tε.
(iii)
There is a norm ||| · ||| on Rn and a constant δ > 0 such that for all t ≥0, |||etA||| ≤e−tδ.
Hint: (ii) ⇒(i) by using the real Jordan form: if every solution of ˙x = Ax tends to zero as t →+∞,
then every eigenvalue of A has strictly negative real part. For (i) ⇒(iii) use Exercise 4.3-5 and observe
that if x(t) is a solution of ˙x = Ax, then we have
d
dt|||x(t)||| = ⟨⟨x(t), Ax(t)⟩⟩
|||x(t)|||
,
so that we get the following inequality: at ≤log |||x(t)|||/ log |||x(0)||| ≤bt, where a = min{ Re(λi) |
i = 1, . . . , n }, and b = max{ Re(λi) | i = 1, . . . , n }. Then let −ε = b.
Prove a similar theorem if all eigenvalues of A have strictly positive real part; the origin is then called
a source.
⋄4.3-8.
Give a proof of Theorem 4.3.4 in the ﬁnite dimensional case without using the variation of constants
formula (Exercise 4.1-5) and using Exercise 4.3-6.
Hint: If A = X′(0) locally show
lim
x→0
⟨⟨X(x) −Ax, x⟩⟩
|||x|||2
= 0.
Since ⟨⟨Ax, x⟩⟩≤−ε|||x|||2, ε = max Re{ λi | i = 1, . . . , n, λi eigenvalues of A }, there exists δ > 0 such that
if |||x||| ≤δ, then ⟨⟨X(x), x⟩⟩≤−C|||x|||2, for some C > 0. Show that if x(t) is a solution curve in the
closed δ-ball, t ∈[0, T], then
d|||x(t)|||
dt
≤−C|||x(t)|||.
Conclude |||x(t)||| ≤δ for all t ∈[0, T] and thus by compactness of the δ-ball, x(t) exists for all t ≥0.
Finally, show that |||x(t)||| ≤e−tε|||x(0)|||.
⋄4.3-9.
An equilibrium point m of a vector ﬁeld X ∈X(M) is called a sink, if there is a δ > 0 such that
all points in the spectrum of X′(m) have real part < −δ.
(i)
Show that in a neighborhood of a sink there is no other equilibrium of X.
(ii)
If M = Rn and X is a linear vector ﬁeld, Exercise 4.3-7 shows that provided limt→∞m(t) = 0 for
every integral curve m(t) of X, then the eigenvalues of X have all strictly negative real part. Show
that this statement is false for general vector ﬁelds by ﬁnding an example of a non-linear vector ﬁeld X
on Rn whose integral curves tend to zero as t →∞, but is such that X′(0) has at least one eigenvalue
with zero real part.
Hint : See Exercise 4.3-3.
⋄4.3-10 (Hyperbolic Flows).
An operator A ∈L(Rn, Rn) is called hyperbolic if no eigenvalue of A has
zero real part. The linear ﬂow x 
→etAx is then called a hyperbolic ﬂow.
(i)
Let A be hyperbolic. Show that there is a direct sum decomposition Rn = Es ⊕Eu, A(Es) ⊂Es,
A(Eu) ⊂Eu, such that the origin is a sink on Es and a source on Eu; Es and Eu are called the stable
and unstable subspaces of Rn. Show that the decomposition is unique.
Hint: Es is the sum of all subspaces deﬁned by the real Jordan form for which the real part of the
eigenvalues is negative. For uniqueness, if Rn = E′s ⊕E′u and v ∈E′s, then v = x + y, x ∈Es, y ∈Eu
with etAv →0 as t →∞, so that etAx →0, etAy →0 as t →∞. But since the origin is a source on
E′u, ∥etAy∥≥etε∥y∥for some ε > 0 by the analogue of Exercise 4.3-7(ii).

278
4. Vector Fields and Dynamical Systems
(ii)
Show that A is hyperbolic iﬀfor each x ̸= 0, ∥etAx∥→∞as t →±∞.
(iii)
Conclude that hyperbolic ﬂows have no periodic orbits.
⋄4.3-11 (Gradient ﬂows; continuation of Exercise 4.1-8).
Let f : Rn →R be C1 and let X = (∂f/∂x1, . . . , ∂f/∂xn).
Show that at regular points of f, the integral curves of X cross the level surfaces of f orthogonally and that
every singular point of f is an equilibrium of X. Show that isolated maxima of f are asymptotically stable.
Hint: If x0 is the isolated maximum of f, then f(x0) −f(x) is a strict Liapunov function. Draw the level
sets of f and the integral curves of X on the same diagram in R2, when f is deﬁned by f(x1, x2) =
(x1 −1)2 + (x2 −2)2(x2 −3)2.
⋄4.3-12.
Consider ¨u + ˙u + u3 = 0. Show that solutions converge to zero like C/
√
t as t →∞by considering
H(u, ˙u) = (u + ˙u)2 + u3 + u4.
⋄4.3-13.
Use the method of Liapunov functions to study the stability of the origin for the following vector
ﬁelds:
(i)
X(x, y) = −(3y + x3)(∂/∂x) + (2x −5y3)(∂/∂y) (asymptotically stable);
(ii)
X(x, y) = −xy4(∂/∂x) + x6y(∂/∂y) (stable; look for L of the form x4 + ay6);
(iii)
X(x, y) = (xy −x3 + y)(∂/∂x) + (x4 −x2y + x3)(∂/∂y) (stable; look for L of the form ax4 + by2);
(iv)
X(x, y) = (y + x7)(∂/∂x) + (y9 −x)(∂/∂y) (unstable);
(v)
X(x, y, z) = 3y(z + 1)(∂/∂x) + x(z + 1)(∂/∂y) + yz(∂/∂z) (stable);
(vi)
X(x, y, z) = (−x5 + 5x6 + 2y3 + xz2 + xyz)(∂/∂x)
+ (−y −2z + 3x6 + 4yz + xz + xy2)(∂/∂y)
+ (2y −z −2x8 −y2 + xz2 + xy3)(∂/∂z)
(asymptotically stable; use L(x, y, z) = (1/2)x2 + 5(y2 + z2)).
⋄4.3-14.
Consider the following vector ﬁeld on Rn+1;
X(s, x) = (asN + f(s) + g(s, x), Ax + F(x) + h(s, x))
where s ∈R, x ∈Rn, f(0) = · · · = f (N)(0) = 0, g(s, x), has all derivatives of order ≤2 zero at the origin,
and F(x), h(s, x) vanish together with their ﬁrst derivative at the origin. Assume the n × n matrix A has all
eigenvalues distinct with strictly negative real part. Prove the following theorem of Liapunov: if N is even
or N is odd and a > 0, then the origin is unstable; if N is odd and a < 0, the origin is asymptotically stable.
Hint: for N even, use L(s, x) = s −a∥x∥2/2 and for N odd, L(s, x) = (s2 −a∥x∥2)/2; show that in both
cases the sign of X[L] near the origin is given by the sign of a.
⋄4.3-15.
Let E be a Banach space and A : R →L(E, E) a continuous map. Let Ft,s denote the evolution
operator of the time-dependent vector ﬁeld X(t, x) = A(t)x on E.
(i)
Show that Ft,s ∈GL(E).
(ii)
Show that ∥Ft,s∥≤e(t−s)α, where α = supλ∈[s,t] ∥A(λ)∥. Conclude that the vector ﬁeld X(t, x) is
complete.
Hint: Use Gronwall’s inequality and the time dependent version of Proposition 4.1.22.
Next assume that A is periodic with period T, that is, A(t + T) = A(t) for all t ∈R.

4.4 Frobenius’ Theorem and Foliations
279
(iii)
Show that Ft+T,s+T = Ft,s for any t, s ∈R.
Hint: Show that t 
→Ft+T,s+T (x) satisﬁes the diﬀerential equation ˙x = A(t)x.
(iv)
Deﬁne the monodromy operator by M(t) = Ft+T,t. Show that if A is independent of t, then M(t) =
eT A is also independent of t. Show that M(s) = Ft,s ◦M(t) ◦Fs,t for any continuous A : R →L(E, E).
Conclude that all solutions of ˙x = A(t)x are of period T if and only if there is a t0 such that M(t0) =
identity. Show that the eigenvalues of M(t) are independent of t.
(v)
(Floquet). Show that each real eigenvalue λ of M(t0) determines a solution, denoted c(t; λ, t0) of
˙x = A(t)x satisfying c(t + T; λ, t0) = λc(t; λ, t0), and also each complex eigenvalue λ = a + ib, of
M(t0), where a, b ∈R, determines a pair of solutions denoted cr(t; λ, t0) and ci(t; λ, t0) satisfying

cr(t + T; λ, t0)
ci(t + T; λ, t0)

=

a
−b
b
a
 
cr(t; λ, t0)
ci(t; λ, t0)

.
Hint: Let c(t; λ, t0) denote the solution of ˙x = A(t)x with the initial condition c(t0; λ, t0) = e, where
e is an eigenvector of M(t0) corresponding to λ; if λ is complex, work on the complexiﬁcation of E.
Then show that c(t + T; λ, t0) −λc(t; λ, t0) satisﬁes the same diﬀerential equation and its value at t0
is zero since c(t0 + T; λ, t0) = M(t0)c(t0; λ, t0) = λc(t0; λ, t0).)
(vi)
(Floquet). Show that there is a nontrivial periodic solution of period T of ˙x = A(t)x if and only if 1
is an eigenvalue of M(t0) for some t0 ∈R.
Hint: If c(t) is such a periodic solution, then c(t0) = c(t0 + T) = M(t0)c(t0).
(vii)
(Liapunov). Let P : R →GL(E) be a C1 function which is periodic with period T. Show that
the change of variable y = P(t)x transforms the equation ˙x = A(t)x into the equation ˙y = B(t)y,
where B(t) = (P ′(t) + P(t)A(t))P(t)−1. If N(t) is the monodromy operator of ˙y = B(t)y, show that
N(t) = P(t)M(t)P(t)−1.
⋄4.3-16.
(i)
(Liapunov). Let E be a ﬁnite dimensional complex vector space and let A : R →L(E, E)
be a continuous function which is periodic with period T. Let M(s) be the monodromy operator of
the equation ˙x = A(t)x and let B ∈L(E, E) be such that M(s) = eT B (see Exercise 4.1-15). Deﬁne
P(t) = etBFs,t and put y(t) = P(t)x(t). Use (vii) in the previous exercise to show that y(t) satisﬁes
˙y = By. Prove that P(t) is a periodic C1-function with period T.
Hint: Use (iii) of the previous exercise and eT B = M(s) = Fs+T,s. Thus, for complex ﬁnite dimensional
vector spaces, the equation ˙x = A(t)x, where A(t + T) = A(t), can be transformed via y(t) = P(t)x(t)
into the constant coeﬃcient linear equation ˙y = By.
(ii)
Since the general solution of ˙y = By is a linear combination of vectors exp(tλi)tℓ(i)ui, where λ1, . . . , λm
are the distinct eigenvalues of B, ui ∈E, and 1 ≤ℓ(i) ≤multiplicity of λi, conclude that the general
solution of ˙x = A(t)x is a linear combination of vectors exp(tλi)tℓ(i)P(t)−1ui where P(t + T) = P(t).
Show that the eigenvalues of M(s) = eT B are exp(Tλi). Show that Re(λi) < 0 (> 0) for all i = 1, . . . , m
if and only if all the solutions of ˙x = A(t)x converge to the origin as t →+∞(−∞), that is, if and
only if the origin is asympotically stable (unstable).
4.4
Frobenius’ Theorem and Foliations
The main pillars supporting diﬀerential topology and calculus on manifolds are the implicit function theorem,
the existence theorem for ordinary diﬀerential equations, and Frobenius’ theorem, which we discuss brieﬂy
here. First some deﬁnitions.

280
4. Vector Fields and Dynamical Systems
4.4.1 Deﬁnition.
Let M be a manifold and let E ⊂TM be a subbundle of its tangent bundle; that is, E
is a distribution (or a plane ﬁeld) on M.
(i)
We say E is involutive if for any two vector ﬁelds X and Y deﬁned on open sets of M and which
take values in E, [X, Y ] takes values in E as well.
(ii)
We say E is integrable if for any m ∈M there is a (local) submanifold N ⊂M, called a (local)
integral manifold of E at m containing m, whose tangent bundle is exactly E restricted to N.
The situation is shown in Figure 4.4.1.
M0
Em0
N
Figure 4.4.1. Local integrable manifolds
4.4.2 Examples.
A.
Any subbundle E of TM with one dimensional ﬁbers is involutive; E is also integrable, which is seen
in the following way. Using local bundle charts for TM at m ∈M with the subbundle property for E, ﬁnd
in an open neighborhood of m, and a vector ﬁeld that never vanishes and has values in E. Its local integral
curves through m have as their tangent bundles E restricted to these curves. If the vector ﬁeld can be found
globally and has no zeros, then through any point of the manifold there is exactly one maximal integral
curve of the vector ﬁeld, and this integral curve never reduces to a point.
B.
Let f : M →N be a submersion and consider the bundle ker Tf ⊂TM. This bundle is involutive
since for any X, Y ∈X(M) which take values in ker Tf, we have Tf([X, Y ]) = 0 by Proposition 4.2.25. The
bundle is integrable since for any m ∈M the restriction of ker Tf to the submanifold f −1(f(m)) coincides
with the tangent bundle of this submanifold (see §3.5).
C.
Let Tn be the n-dimensional torus, n ≥2. Let 1 ≤k ≤n and consider E = { (v1, . . . , vn) ∈TTn |
vk+1 = · · · = vn = 0 }. This distribution is involutive and integrable; the integral manifold through
(t1, . . . , tn) is Tk × (tk+1, . . . , tn).
D.
E = TM is involutive and integrable; the integral submanifold through any point is M itself.

4.4 Frobenius’ Theorem and Foliations
281
E.
An example of a noninvolutive distribution is as follows. Let M = SO(3), the rotation group (see
Exercise 3.5-19). The tangent space at I = identity consists of the 3 × 3 skew symmetric matrices. Let
EI =







A ∈TI SO(3)

A =


0
0
−q
0
0
p
q
−p
0

for some p, q ∈R







a two dimensional subspace. For Q ∈SO(3), let
EQ = { B ∈TQ SO(3) | Q−1B ∈EI }.
Then E = { EQ | Q ∈SO(3) } is a distribution but is not involutive. In fact, one computes that the two
vector ﬁelds with p = 1, q = 0 and p = 0, q = 1 have a bracket that does not lie in E. Further insight into
this example is gained after one studies Lie groups (a supplementary chapter).
F.
Let E be a distribution on M. Suppose that a collection E of smooth sections of E spans E in the sense
that for each section X of E there are vector ﬁelds X1, . . . , Xk in E and smooth functions a1, . . . , ak on M
such that X = aiXi. Suppose E is closed under bracketing; that is, if X and Y have values in E, so does
[X, Y ]. We claim that E is involutive.
To prove this assertion, let X and Y be sections of E and write X = aiXi and Y = bjYj, where ai and bj
are smooth functions on M and Xi and Yj belong to E. We calculate
[X, Y ] = BjYj −AiXi + aibj[Xi, Yj],
where
Bj = aiXi[bj]
and
Ai = bjYj[ai].
Thus [X, Y ] is a section of E, so E is involutive.
♦
Frobenius’ theorem asserts that the two conditions in Deﬁnition 4.4.1 are equivalent.
4.4.3 Theorem (The Local Frobenius Theorem).
A subbundle E of TM is involutive if and only if it is
integrable.
Proof.
Suppose E is integrable. Let X and Y be sections of E and let N be a local integral manifold
through m ∈M. At points of N, X and Y are tangent to N, so deﬁne restricted vector ﬁelds X|N, Y |N on
N. By Proposition 4.2.25 (on ϕ-relatedness of brackets) applied to the inclusion map, we have
[X|N, Y |N] = [X, Y ]|N.
Since N is a manifold, [X|N, Y |N] is a vector ﬁeld on N, so [X, Y ] is tangent to N and hence in E.
Conversely, suppose that E is involutive. By choosing a vector bundle chart, one is reduced to this local
situation: E is a model space for the ﬁbers of E, F is a complementary space, and U × V ⊂E × F is an
open neighborhood of (0, 0), so U × V is a local model for M. We have a map f : U × V →L(E, F) such
that the ﬁber of E over (x, y) is
E(x,y) = { (u, f(x, y) · u) | u ∈E } ⊂E × F,
and we can assume we are working near (0, 0) and f(0, 0) = 0. Let us express involutivity of E in terms of
f.
For ﬁxed u ∈E, let Xu(x, y) = (u, f(x, y) · u). Using the local formula for the Lie bracket (see formula
(4.2.5)) one ﬁnds that
[Xu1, Xu2](x, y) = (0, Df(x, y) · (u1, f(x, y) · u1) · u2
−Df(x, y) · (u2, f(x, y) · u2) · u1).
(4.4.1)

282
4. Vector Fields and Dynamical Systems
By the involution assumption, this lies in E(x,y). Since the ﬁrst component vanishes, the local description of
E(x,y) above shows that the second must as well; that is, we get the following identity:
Df(x, y) · (u1, f(x, y) · u1) · u2 = Df(x, y) · (u2, f(x, y) · u2) · u1.
(4.4.1’)
Consider the time-dependent vector ﬁelds
Xt(x, y) = (0, f(tx, y) · x)
and
Xt,u(x, y) = (u, f(tx, y) · tu),
so that by the local formula for the Jacobi–Lie bracket,
[Xt, Xt,u](x, y) = (0, tD2f(tx, y) · (f(tx, y) · x) · u
−tDf(tx, y) · (u, f(tx, y) · u) · x −f(tx, y) · u)
= (0, −tD1f(tx, y) · x · u −f(tx, y) · u),
(4.4.2)
where the last equality follows from (4.4.1′). But ∂Xt,u/∂t equals the negative of the right hand side of
equation (4.4.2), that is,
[Xt, Xt,u] + ∂Xt,u
∂t
= 0,
which by Theorem 4.2.31 is equivalent to
d
dtF ∗
t Xt,u = 0,
(4.4.3)
where Ft = Ft,0 and Ft,s is the evolution operator of the time dependent vector ﬁeld Xt. Since Xt(0, 0) = 0,
it follows that Ft is deﬁned for 0 ≤t ≤1 by Corollary 4.1.25.
Since F0 is the identity, relation (4.4.3) implies that
F ∗
t Xt,u = X0,u,
i.e.,
TF1 ◦X0,u = X1,u ◦F1.
(4.4.4)
Let N = F1(E × {0}), a submanifold of E × F, the model space of M. If (x, y) = F1(e, 0), the tangent space
at (x, y) to N equals
T(x,y)N = { T(e,0)F1(u, 0)) | u ∈E } = { T(e,0)F1(X0,u(e, 0)) | u ∈E }
= { X1,u(F1(e, 0)) | u ∈E }
(by (4.4.4))
= { (u, f(x, y) · u) | u ∈E } = E(x,y).
■
The method of using the time-one map of a time-dependent ﬂow to provide the appropriate coordinate
change is useful in a number of situations and is called the method of Lie transforms. An abstract version
of this method is given later in Example 5.4.7; we shall use this method again in Chapter 6 to prove the
Poincar´e lemma and in Chapter 8 to prove the Darboux theorem.
Note: The method of Lie transforms is also used in singularity theory and bifurcation theory (see Golubit-
sky and Schaeﬀer [1985]). For a proof of the Morse lemma using this method, see Proposition 5.5.8, which
is based on Palais [1969] and Golubitsky and Marsden [1983]. For a proof of the Frobenius theorem from
the implicit function theorem using manifolds of maps in the spirit of Supplement 4.1C, see Penot [1970].
See Exercise 4.4-6 for another proof of the Frobenius theorem in ﬁnite dimensions.
The Frobenius theorem is intimately connected to the global concept of foliations. Roughly speaking, the
integral manifolds N can be glued together to form a “nicely stacked” family of submanifolds ﬁlling out M
(see Figure 4.4.1 or Example 4.4.2A).

4.4 Frobenius’ Theorem and Foliations
283
4.4.4 Deﬁnition.
Let M be a manifold and Φ = {£α}α∈A a partition of M into disjoint connected sets
called leaves. The partition Φ is called a foliation if each point of M has a chart (U, ϕ), ϕ : U →
U ′ × V ′ ⊂E ⊕F such that for each £α the connected components (U ∩£α)β of U ∩£α are given by
ϕ((U ∩£α)β) = U ′ × {cβ
α}, where cβ
α ∈F are constants f or each α ∈A and β. Such charts are called
foliated (or distinguished) by Φ. The dimension (respectively, codimension) of the foliation Φ is
the dimension of E (resp., F). See Figure 4.4.2.
y
x
ϕ (x,y)
U
Figure 4.4.2. Chart for a foliation
Note that each leaf £α is a connected immersed submanifold. In general, this immersion is not an em-
bedding; that is, the induced topology on £α from M does not necessarily coincide with the topology of
£α (the leaf £α may accumulate on itself, for example). A diﬀerentiable structure on £α is induced by the
foliated charts in the following manner. If (U, ϕ), ϕ : U →U ′ × V ′ ⊂E ⊕F is a foliated chart on M, and
χ : E ⊕F →F is the canonical projection, then χ ◦ϕ restricted to (U ∩£α)β deﬁnes a chart on £α.
4.4.5 Examples.
A.
The trivial foliation of a connected manifold M has only one leaf, M itself. It has codimension zero.
If M is ﬁnite dimensional, both M and the leaf have the same dimension. Conversely, on a ﬁnite-dimensional
connected manifold M, a foliation of dimension equal to dim(M) is the trivial foliation.
B.
The discrete foliation of a manifold M is the only zero-dimensional foliation; its leaves are all points
of M. If M is ﬁnite dimensional, the dimension of M is the codimension of this foliation.
C.
A vector ﬁeld X that never vanishes on M determines a foliation; its leaves are the maximal integral
curves of the vector ﬁeld X. The fact that this is a foliation is the straightening out theorem (see §4.1).
D.
Let f : M →N be a submersion. It deﬁnes a foliation on M (of codimension equal to dim(N) if
dim(N) is ﬁnite) by the collection of all connected components of f −1(n) when n varies throughout N. The
fact that this is a foliation is given by Theorem 3.5.4. In particular, we see that E ⊕F is foliated by the
family {E × {f}}f∈F .
E.
In the preceding example, let M = R3, N = R, and f(x1, x2, x3) = ϕ(r2) exp(x3), where ϕ : R →R is
a C∞function satisfying ϕ(0) = 0, ϕ(1) = 0, and ϕ′(s) < 0 for s > 0, and where r2 = (x1)2 + (x2)2. Since
df(x1, x2, x3) = exp(x3)[2ϕ′(r2)x1dx1 + 2ϕ′(r2)x2dx2 + ϕ(r2)dx3]
and ϕ(r2) is a strictly decreasing function of r2, f is submersion, so its level sets deﬁne a codimension one
foliation on R3. Since the only zero of ϕ(r2) occurs for r = 1, f −1(0) equals the cylinder { (x1, x2, x3) |
(x1)2 + (x2)2 = 1 }. Since ϕ(r2) is a positive function for r ∈[0, 1[, it follows that if c > 0, then f −1(c) =
{ (x1, x2, log(c/ϕ(r2)) | 0 ≤(x1)2 +(x2)2 < 1 }, which is diﬀeomorphic to the open unit ball in (x1, x2)-space
via the projection (x1, x2, log(c/ϕ(r2)) 
→(x1, x2). Note that the leaves f −1(c), c > 0, are asymptotically

284
4. Vector Fields and Dynamical Systems
tangent to the cylinder f −1(0). Finally, since ϕ(r2) < 0 if r > 1, for c < 0 the leaves given by f −1(c) =
{ (x1, x2, log(c/ϕ(r2)) | (x1)2 + (x2)2 > 1 } are diﬀeomorphic to the plane minus the closed unit disk, that
is, they are diﬀeomorphic to cylinders. As before, note that the cylinders f −1(c) are symptotically tangent
to f −1(0); see Figure 4.4.3.
f _1(c),  c > 0
f _1(c),  c < 0
f = 0
Figure 4.4.3. A change in the topology of level sets
F.
(The Reeb Foliation on the Solid Torus and the Klein Bottle; Reeb [1952]). We claim that in the
previous example, the leaves are in some sense translation invariant. The cylinder f −1(0) is invariant; if c ̸= 0,
invariance is in the sense f −1(c) + (0, 0, log t) = f −1(tc), for any t > 0. Consider the part of the foliation
within the solid cylinder (x1)2 + (x2)2 ≤1 and form the solid torus from this cylinder: identify (a1, a2, 0)
with (b1, b2, 1) iﬀai = bi, i = 1, 2. The foliation of the solid torus so obtained is called the orientable
Reeb foliation. Out of the cylinder one can form the Klein bottle (see Figure 1.4.2) by considering the
equivalence relation which identiﬁes (a1, a2, 0) with (b1, b2, 1) iﬀa1 = b1, a2 = −b2. In this way one obtains
the nonorientable Reeb foliation. (This terminology regarding orientability will be explained in §6.5.)
G.
(The Reeb Foliation on S3; Reeb [1952]). Two orientable Reeb foliations on the solid torus determine
a foliation on S3 in the following way. The sphere S3 is the union of two solid tori which are identiﬁed
along their common boundary, the torus T2, by the diﬀeomorphism taking meridians of one to parallels of
the other and vice-versa. This foliation is called the Reeb foliation of
S3; it has one leaf diﬀeomorphic
to the torus T2 and all its other leaves are diﬀeomorphic to R2 and accumulate on the torus. Below we
describe, pictorially, the decomposition of S3 in two solid tori. Remove the north pole, (1, 0, 0, 0), of S3 and
stereographically project the rest of S3 onto R3. In the plane (x2, x4) draw two equal circles centered on
the x2-axis at the points a and b, where −a = b. Rotating about the x4-axis yields the solid torus in R3.
Now draw all of the circles in the (x2, x4) plane minus the two discs, centered on the x4-axis and passing
through a and b. Each such circle yields two connected arcs joining the two discs. In addition, consider
the two portions of the x2-axis: the line joining the two discs and the two rays going oﬀfrom each disk
separately. (See Figure 4.4.4.) Now rotate this ﬁgure about the x4-axis. All arcs joining the disks generate
smooth surfaces diﬀeomorphic to R2 and each such surface meets the solid torus along a parallel. Only the
two rays emanating from the disks generate a surface diﬀeomorphic to the cylinder. Now add the north

4.4 Frobenius’ Theorem and Foliations
285
pole back to S3 and pull back the whole structure via stereographic projection from R3 to S3: the cylinder
becomes a torus and all surfaces diﬀeomorphic to R2 intersect this torus in meridians. Thus S3 is the union
of two solid tori glued along their common boundary by identifying parallels of one with meridians of the
other and vice-versa.
♦
a
b
x4
x2
Figure 4.4.4. Construction for the Reeb foliation.
4.4.6 Proposition.
Let M be a manifold and Φ = {£α}α∈A be a foliation on M. The set
T(M, Φ) =
)
α∈A
)
m∈£α
Tm£α
is a subbundle of TM called the tangent bundle to the foliation. The quotient bundle, denoted ν(Φ) =
TM/T(M, Φ), is called the normal bundle to the foliation Φ. Elements of T(M, Φ) are called vectors
tangent to the foliation Φ.
Proof.
Let (U, ϕ), ϕ : U →U ′ × V ′ →E ⊕F be a foliated chart. Since Tuϕ(Tu£α) = E × {0} for every
u ∈U ∩£α, we have
Tϕ(TU ∩T(M, Φ)) = (U ′ × V ′) × (E × {0}).
Thus, the standard tangent bundle charts induced by foliated charts of M have the subbundle property and
naturally induce vector bundle charts by mapping vm ∈Tm(M, Φ) to (ϕ(m), Tmϕ(vm)) ∈(U ′ × V ′) × (E ×
{0}).
■
4.4.7 Theorem (The Global Frobenius Theorem).
Let E be a subbundle of TM. The following are equiv-
alent:
(i)
There exists a foliation Φ on M such that E = T(M, Φ).
(ii)
E is integrable.
(iii)
E is involutive.

286
4. Vector Fields and Dynamical Systems
Proof.
The equivalence of (ii) and (iii) was proved in Theorem 4.4.3. Let (i) hold. Working with a foliated
chart, E is integrable by Proposition 4.4.6, the integral submanifolds being the leaves of Φ. Thus (ii) holds.
Finally, we need to show that (ii) implies (i). Consider on M the family of (local) integral manifolds of
E, each equipped with its own submanifold topology. It is straightforward to verify that the family of
ﬁnite intersections of open subsets of these local integral submanifolds deﬁnes a topology on M, ﬁner in
general than the original one. Let {£α}α∈A be its connected components. Then, denoting by (£α ∩U)β the
connected components of £α ∩U in U, we have by deﬁnition E|(U ∩£α)β = (E restricted to (U ∩£α)β)
equals T((U ∩£α)β). Let (τ −1(U), ψ), U ⊂M be a vector bundle chart of TM with the subbundle property
for E, and let ϕ : U →U1 be the induced chart on the base. This means, shrinking U if necessary, that
ϕ : U →U ′ × V ′ ⊂E ⊕F and
ψ(τ −1(U) ∩E) = (U ′ × V ′) × (E × {0}).
Thus, ϕ((U ∩£α)β) = U ′ × {cβ
α} and so M is foliated by the family Φ = {£α}α∈A. Because E|(U ∩£α)β =
T((U ∩£α)β), we also have T(M, Φ) = E.
■
There is an important global topological condition that integrable subbundles must satisfy that was
discovered by Bott [1970]. The result, called the Bott Vanishing Theorem, can be found, along with
related results, by readers with background in algebraic topology, in Lawson [1977].
The leaves of a foliation are characterized by the following property.
4.4.8 Proposition.
Let Φ be a foliation on M. Then x and y are in the same leaf if and only if x and y
lie on the same integral curve of a vector ﬁeld X deﬁned on an open set in M and which is tangent to the
foliation Φ.
Proof.
Let X be a vector ﬁeld on M with values in T(M, Φ) and assume that x and y lie on the same
integral curve of X. Let £ denote the leaf of Φ containing x. Since X is tangent to the foliation, X|£ is a
vector ﬁeld on £ and thus any integral curve of X starting in £ stays in £. Since y is on such an integral
curve, it follows that y ∈£.
Conversely, let x, y ∈£ and let c(t) be a smooth non-intersecting curve in £ such that c(0) = x, c(1) = y,
c′(t) ̸= 0. (This can always be done on a connected manifold by showing that the set of points that can be
so joined is open and closed.) Thus c : [0, 1] →£ is an immersion, and hence by compactness of [0, 1], c is
an embedding. Using Deﬁnition 4.4.4, there is a neighborhood of the curve c in M which is diﬀeomorphic
to a neighborhood of [0, 1] × {0} × {0} in R × F × G for Banach spaces F and G such that the leaves of the
foliation have the local representation R × F × {w}, for ﬁxed w ∈G, and the image of the curve c has the
local representation [0, 1] × {0} × {0}. Thus we can ﬁnd a vector ﬁeld X which is deﬁned by c′(t) along c
and extends oﬀc to be constant in this local representation.
■
Let R denote the following equivalence relation in a manifold M with a given folation Φ : xRy if x, y
belong to the same leaf of Φ. The previous proposition shows that R is an open equivalence relation. It is
of interest to know whether M/R is a manifold. Foliations for which R is a regular equivalence relation are
called regular foliations. (See §3.5 for a discussion of regular equivalence relations.) The following is a
useful criterion.
4.4.9 Proposition.
Let Φ be a foliation on a manifold M and R the equivalence relation in M determined
by Φ. R is regular iﬀfor every m ∈M there exists a local submanifold Σm of M such that Σm intersects
every leaf in at most one point (or nowhere) and TmΣm ⊕Tm(M, Φ) = TmM. (Sometimes Σm is called a
slice or a local cross-section for the foliation.)
Proof.
Assume that R is regular and let π : M →M/R be the canonical projection. For Σm choose the
submanifold using the following construction. Since π is a submersion, in appropriate charts (U, ϕ), (V, ψ),
where ϕ : U →U ′ × V ′ and ψ : V →V ′, the local representative of π, πϕψ : U ′ × V ′ →V ′, is the projection
onto the second factor, and every leaf π−1(v) ⊂U, v ∈V , is represented in these charts as U ′ × {v′} where
v′ = ψ(v). Thus if Σm = ψ−1({0} × V ′), we see that Σm satisﬁes the two required conditions.

4.4 Frobenius’ Theorem and Foliations
287
Conversely, assume that each point m ∈M admits a slice Σm. Working with a foliated chart, we are
reduced to the following situation: let U, V be open balls centered at the origin in Banach spaces E and F,
respectively, let Σ be a submanifold of U × V , (0, 0) ∈Σ, such that T(0,0)Σ = F, and Σ ∩(U × {v}) is at
most one point for all v ∈V . If p2 : E ⊕F →F is the second projection, since p2|Σ has tangent map at
(0, 0) equal to the identity, it follows that for V small enough, p2|Σ : Σ →V is a diﬀeomorphism. Shrinking
Σ and V if necessary we can assume that Σ ∩(U ×{v}) is exactly one point. Let q : V →Σ be the inverse of
p2 and deﬁne the smooth map s : U × V →Σ by s(u, v) = q(v). Then Σ ∩(U × {v}) = {q(v)}, thus showing
that Σ is a slice in the sense of Lemma 3.5.26. Pulling everything back to M by the foliated chart, the prior
argument shows that for each point m ∈M there is an open neighborhood U, a submanifold Σm of U, and
a smooth map s : U →Σm such that £u ∩Σm = {s(u)}, where £u is the leaf containing u ∈U. By the
argument following Lemma 3.5.26, the equivalence relation R is locally regular, that is, RU = R ∩(U × U)
is regular. If U ′ = π−1(π(U)) where π : M →M/R is the projection, the argument at the end of Step 1 in
the proof of Theorem 3.5.25 shows that R is regular. Thus, all that remains to be proved is that U can be
chosen to equal U ′. But this is clear by deﬁning s′ : U ′ →Σm by s′(u′) = s(u), where u ∈U  £u′, £u′
being the leaf containing u′; smoothness of s′ follows from smoothness of s by composing it locally with the
ﬂow of a vector ﬁeld given by Proposition 4.4.8.
■
To get a feeling for the foregoing condition we will study the linear ﬂow on the torus.
4.4.10 Example.
On the two-torus T2 consider the global ﬂow F : R×T2 →T2 deﬁned by F(t, (s1, s2)) =
(s1e2πit, s2e2πiαt) for a ﬁxed number α ∈[0, 1[. By Example 4.4.5C this deﬁnes a foliation on T2. If α ∈Q,
notice that every integral curve is closed and that all integral curves have the same period. The condition of
the previous theorem is easily veriﬁed and we conclude that in this case the equivalence relation R is regular;
T2/R = S1. If α is irrational, however, the situation is completely diﬀerent. Let ϕ(t) = (e2πit, e2πiαt) denote
the integral curve through (1, 1). The following argument shows that cl (ϕ(R)) = T2; that is, ϕ(R) is dense
in T2. Let p = (e2πix, e2πiy) ∈T2; then for all m ∈Z,
ϕ(x + m) −p = (0, e2πiαx(e2πimα −e2πiz))
where y = αx + z. It suﬃces to show that C = { e2πimα ∈S1 | m ∈Z } is dense in S1 because then there
is a sequence mk ∈Z such that exp(2πimkα) converges to e2πiz. Hence, ϕ(x + mk) converges to p. If for
each k ∈Z+ we divide S1 into k arcs of length 2π/k, then, because { e2πimα ∈S1 | m = 1, 2, . . . , k + 1 } are
distinct for some 1 ≤nk < mk ≤k + 1, exp(2πimkα) and exp(2πinkα) belong to the same arc. Therefore,
| exp(2πimkα) −exp(2πinkα)| < 2π
k ,
which implies | exp(2πiqkα) −1| < 2π/k, where qk = mk −nk. Because
)
j∈Z+
{ e2πiαs ∈S1 | s ∈[jqk, (j + 1)qk] } = S1,
every arc of length less than 2π/k contains some exp(2πijqk), which proves cl(C) = S1. Thus any submanifold
Σmm ∈T2 not coinciding with the integral curve through m will have to intersect ϕ(R) inﬁnitely many
times; the condition in the previous theorem is violated and so R is not regular.
♦
Remark.
Novikov [1965] has shown that the Reeb foliation is in some sense typical. A foliation Φ on M
is said to be transversally orientable if TM = T(M, Φ) ⊕E, where E is an orientable subbundle of TM
(see Exercise 6.5-14 for the deﬁnition). A foliation on a three dimensional manifold M is said to have a
Reeb component if it has a compact leaf diﬀeomorphic to T2 or K and if the foliation within this torus
or Klein bottle is diﬀeomorphic to the orientable or non-orientable Reeb foliation in the solid torus or the

288
4. Vector Fields and Dynamical Systems
solid Klein bottle. Novikov has proved the following remarkable result. Let Φ be a transversally orientable
C2 codimension one foliation of a compact three dimensional manifold M. If π1(M) is ﬁnite, then Φ has a
Reeb component, which may or may not be orientable. If π2(M) ̸= 0 (with no hypotheses on π1(M)) and Φ
has no Reeb components, then all the leaves of Φ are compact with ﬁnite fundamental group. We refer the
reader to Camacho and Neto [1985] for a proof of this result and to this reference and Lawson [1977] for a
study of foliations in general.
♦
Even though foliations encompass “nice” partitions of a manifold into submanifolds, there are important
situations when foliations are inappropriate because they are not regular or the leaves jump in dimension
from point to point. Consider, for example, R2 as a union of concentric circles centered at the origin. As
this example suggests, one would like to relax the condition that M/R be a manifold, provided that M/R
turns out to be a union of manifolds that ﬁt “nicely” together. Stratiﬁcations, another concept allowing us
to “stack” manifolds, turn out to be the natural tool to describe the topology of orbit spaces of compact
Lie group actions or non-compact Lie group actions admitting a slice (see, for instance, Bredon [1972],
Burghelea, Albu, and Ratiu [1975], Fischer [1970], and Bourguigon [1975]). We shall limit ourselves to the
deﬁnition in the ﬁnite-dimensional case and some simple remarks.
4.4.11 Deﬁnition.
Let M be a locally compact topological space. A stratiﬁcation of M is a partition of
M into manifolds {Ma}a∈A called strata, satisfying the following conditions:
S1.
Ma are manifolds of constant dimension; they are submanifolds of M if M is itself a manifold.
S2.
The family {M α
a } of connected components of all the Ma is a locally ﬁnite partition of M;
that is, for every m ∈M, there exists an open neighborhood U of m in M intersecting only
ﬁnitely many M β
b .
S3.
If M α
a ∩cl(M β
b ) ̸= ∅for (a, α) ̸= (b, β), then M α
a ⊂M β
b and dim(Ma) < dim(Mb).
S4.
cl(Ma)\Ma is a disjoint union of strata of dimension strictly less than dim(Ma).
From the deﬁnition it follows that if M α
a ∩cl(M β
b ) ̸= ∅and if m ∈M α
a ⊂cl(M β
b ) has an open neighborhood
U in the topology of M α
a such that U ⊂M α
a ∩cl(M β
b ), then necessarily M α
a ⊂M β
b and thus dim(Ma) <
dim(Mb). To see this, it is enough to note that the given hypothesis makes M α
a ∩cl(M β
b ) open in M α
a . Since
it is also closed (by deﬁnition of the relative topology) and M α
a is connected, it must equal M α
a itself, whence
M α
a ⊂cl(M β
b ) and by S3, M α
a ⊂M β
b and dim(Ma) < dim(Mb).
For nonregular equivalence relations R, M/R is often a stratiﬁed space. The intuitive idea is that it is often
possible to group together equivalence classes of the same dimension, and this grouping is parametrized by
a manifold, which will be a stratum in M/R. A simple example is R2 partitioned by circles (the equivalence
classes for R). The circles of positive radius are parametrized by the interval ]0, ∞[. Thus M/R is the
stratiﬁed set [0, ∞[ consisting of the two strata {0} and ]0, ∞[.
Exercises
⋄4.4-1.
Let M be an n- manifold such that TM = E1 ⊕· · · ⊕Ep, where Ei, i = 1, . . . , p is an involutive
subbundle of TM. Show that there are subspaces Ei ⊂Rn, i = 1, . . . , p such that Rn = E1 ⊕. . . ⊕Ep and
local charts ϕ : U ⊂M →V ⊂Rn, such that Tϕ maps each ﬁber of Ei onto Ei.
⋄4.4-2.
In R4 consider the family of surfaces given by x2 + y2 + z2 −t2 = const. Show that these surfaces
deﬁne a stratiﬁcation. What part of R4 should be thrown out to obtain a regular foliation?
⋄4.4-3.
Let f : M →N be a C∞map and Φ a foliation on N. The map f is said to be transversal to Φ,
denoted f ⋔Φ, if for every m ∈M,
Tmf(TmM) + Tf(m)(N, Φ) = Tf(m)N
and
(Tmf)−1(Tf(m)(N, Φ))

4.4 Frobenius’ Theorem and Foliations
289
splits in TmM. Show that if {£α}α∈A are the leaves of Φ, the connected components of f −1(£α) are leaves
of a foliation (denoted by f ∗(Φ)) on M, and if Φ has ﬁnite codimension in N, then so does the foliation
f ∗(Φ) on M and the two codimensions coincide.
⋄4.4-4 (Bourbaki [1971]).
Let M be a manifold and denote by M ′ the manifold with underlying set M but
with a diﬀerent diﬀerentiable structure. Show that the collection of connected components of M ′ deﬁnes a
foliation of M iﬀfor every m ∈M, there exists an open set U in M, m ∈U, a manifold N, and a submersion
ρ : U →N such that the submanifold ρ−1(n) of U is open in M ′ for all n ∈N.
Hint: For the “if” part use Lemma 3.3.5 and for the “only if” part use Exercise 3.2-6 to deﬁne a manifold
structure on the leaves; the charts of the second structure are (U ∩£α)β →U ′.
⋄4.4-5.
On the manifold SO(3), consider the partition £A = { QA | Q is an arbitrary rotation about the
z-axis in R3 }, A ∈SO(3). Show that Φ = { £A | A ∈SO(3) } is a regular foliation and that the quotient
manifold SO(3)/R is diﬀeomorphic to S2.
⋄4.4-6 (Hirsch and Weinstein).
Give another proof of the Frobenius theorem as follows:
Step 1. Prove it for the Abelian case in which all sections of E satisfy [X, Y ] = 0 by choosing a local basis
X1, . . . , Xk of sections and successively ﬂowing out by the commuting ﬂows of X1, . . . , Xk.
Step 2 Given a k-dimensional plane ﬁeld, locally write it as a “graph” over Rk. Choose k commuting
vector ﬁelds on Rk and lift them to the plane ﬁeld. If E is involutive, the bracket of two of them lies in
E and, moreover, since the bracket “pushes down” to Rk (by “relatedness”), it is zero. (This is actually
demonstrated in formula (4.4.1).) Now use Step 1.

Page 291
5
Tensors
In the previous chapter we studied vector ﬁelds and functions on manifolds. In this chapter these objects are
generalized to tensor ﬁelds, which are sections of vector bundles built out of the tangent bundle. This study
is continued in the next chapter when we discuss diﬀerential forms, which are tensors with special symmetry
properties. One of the objectives of this chapter is to extend the pull-back and Lie derivative operations
from functions and vector ﬁelds to tensor ﬁelds.
5.1
Tensors on Linear Spaces
Preparatory to putting tensors on manifolds, we ﬁrst study them on vector spaces. This subject is an
extension of linear algebra sometimes called “multilinear algebra.” Ultimately our constructions will be
done on each ﬁber of the tangent bundle, producing a new vector bundle.
As in Chapter 2, E, F, . . . denote Banach spaces and Lk(E1, . . . , Ek; F) denotes the vector space of con-
tinuous k-multilinear maps of E1 × · · · × Ek to F. The special case L(E, R) is denoted E∗, the dual space
of E. If E is ﬁnite dimensional and {e1, . . . , en} is an ordered basis of E, there is a unique ordered basis of
E∗, the dual basis {e1, . . . , en}, such that

ej, ei

= δj
i where δj
i = 1 if j = i and 0 otherwise. Furthermore,
for each v ∈E,
v =
n

i=1

ei, v

ei
and
α =
n

i=1
⟨α, ei⟩ei,
for each α ∈E∗, where ⟨, ⟩denotes the pairing between E and E∗. Employing the summation convention
whereby summation is implied when an index is repeated on upper and lower levels, these expressions become
v =

ei, v

ei
and
α = ⟨α, ei⟩ei.
As in Supplement 2.4C, if E is inﬁnite dimensional, by E∗we will mean another Banach space weakly
paired to E; it need not be the full functional analytic dual of E. In particular, E∗∗will always be chosen
to be E. With these conventions, tensors are deﬁned as follows.
5.1.1 Deﬁnition.
For a vector space E we put
T r
s (E) = Lr+s(E∗, . . . , E∗, E, . . . , E; R)

292
5. Tensors
(r copies of E∗and s copies of E). Elements of T r
s (E) are called tensors on E, contravariant of order
r and covariant of order s; or simply, of type (r, s).
Given t1 ∈T r1
s1 (E) and t2 ∈T r2
s2 (e), the tensor product of t1 and t2 is the tensor t1 ⊗t2 ∈T r1+r2
s1+s2 (E)
deﬁned by
(t1 ⊗t2)(β1, . . . , βr1, γ1, . . . , γr2, f1, . . . , fs1, g1, . . . , gs2)
= t1(β1, . . . , βr1, f1, . . . , fs1)t2(γ1, . . . , γr2, g1, . . . , gs2)
where βj, γj ∈E∗and fj, gj ∈E.
Replacing R by a space F gives T r
s (E; F), the F-valued tensors of type (r, s). The tensor product now
requires a bilinear form on the value space for its deﬁnition. For R-valued tensors, ⊗is associative, bilinear
and continuous; it is not commutative. We also have the special cases
T 1
0 (E) = E, T 0
1 (E) = E∗, T 0
2 (E) = L(E; E∗), and T 1
1 (E) = L(E; E)
and make the convention that T 0
0 (E; F) = F.
5.1.2 Proposition.
Let E be an n dimensional vector space. If {e1, . . . , en} is a basis of E and {e1, . . . , en}
is the dual basis, then
{ ei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs | i1, . . . , ir, j1, . . . , js = 1, . . . , n }
is a basis of T r
s (E) and thus dim(T r
s (E)) = nr+s.
Proof.
We must show that the elements
ei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs
of T r
s (E) are linearly independent and span T r
s (E). Suppose that a ﬁnite sum vanishes:
ti1...ir
j1...jsei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs = 0.
Apply this to (ek1, . . . , ekr, eℓ1, . . . , eℓs) to get tk1...kr
ℓ1...ℓs = 0. Next, check that for t ∈T r
s (E) we have
t = t(ei1, . . . , eir, ej1, . . . , ejs)ei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs.
■
The coeﬃcients
ti1...ir
j1...js = t(ei1, . . . , eir, ej1, . . . , ejs)
and called the components of t relative to the basis {e1, . . . , en}.
5.1.3 Examples.
A.
If t is a (0, 2)-tensor on E then t has components tij = t(ei, ej), an n × n matrix. This is the usual way
of associating a bilinear form with a matrix. For instance, in R2 the bilinear form
t(x, y) = Ax1y1 + Bx1y2 + Cx2y1 + Dx2y2
(where x = (x1, x2) and y = (y1, y2)) is associated to the 2 × 2 matrix

A
B
C
D

.

5.1 Tensors on Linear Spaces
293
B.
If t is a (0, 2)-tensor on E, it makes sense to say that t is symmetric; that is, t(ei, ej) = t(ej, ei). This
is equivalent to saying that the matrix [tij] is symmetric. Symmetric (0, 2)–tensors t can be recovered from
their quadratic form
Q(e) = t(e, e)
by
t (e1, e2) = 1
4 [Q (e1 + e2) −Q (e1 −e2)] ,
the polarization identity. If E = R2 and t has the matrix

A
B
B
C

.
then Q(x) = Ax2
1 + 2Bx1x2 + Cx2
2. Symmetric (0, 2)-tensors are thus closely related to quadratic forms and
arise, for example, in mechanics as moment of inertia tensors and stress tensors.
C.
In general, a symmetric (r, 0)-tensor is deﬁned by the condition
t(α1, . . . , αr) = t(ασ(1), . . . , ασ(r))
for all permutations σ of {1, . . . , r}, and all elements α1, . . . , αr ∈E∗. One may associate to t a homogeneous
polynomial of degree r, P(α) = t(α, . . . , α) and as in the case r = 2, P and t determine each other. A similar
deﬁnition holds for (0, s)-tensors. It is clear that a tensor is symmetric iﬀall its components in an arbitrary
basis are symmetric.
D.
An inner product ⟨, ⟩on E is a symmetric (0, 2)-tensor. Its matrix has components gij = ⟨ei, ej⟩. Thus
gij is symmetric and positive deﬁnite. The components of the inverse matrix are written gij.
E.
The space Lk(E1, . . . , Ek; F) is isometric to Lk(Eσ(1), . . . , Eσ(k); F) for any permutation σ of {1, . . . , k},
the isometry being given by A →A′, where
A′(eσ(1), . . . , eσ(k)) = A(e1, . . . , ek).
Thus if t ∈T r
s (E; F), the tensor t can be regarded in C(r + s, s) (the number of ways r + s objects chosen s
at a time) ways as an (r + s)-multilinear F-valued map. For example, if t ∈T 2
1 (E), the standard way is to
regard it as a 3-linear map t : E∗× E∗× E →R. There are two more ways to interpret this map, however,
namely as E∗× E × E∗→R and as E × E∗× E∗→R. In ﬁnite dimensions, where one writes the tensors
in components, this distinction is important and is reﬂected in the index positions. Thus the three diﬀerent
tensors described above are written
tij
k ei ⊗ej ⊗ek,
tijkei ⊗ek ⊗ej,
tij
k ek ⊗ei ⊗ej.
F.
In classical mechanics one encounters the notion of a dyadic (cf. Goldstein [1980]). A dyadic is the
formal sum of a ﬁnite number of dyads, a dyad being a pair of vectors e1, e2 ∈R3 written in a speciﬁc order
in the form e1e2. The action of a dyad on a pair of vectors, called the double dot product of two dyads is
deﬁned by
e1e2 : u1u2 = (e1 · u1)(e2 · u2),
where · stands for the usual dot product in R3. In this way dyads and dyadics are nothing but (0, 2)-tensors
on R3; that is, e1e2 = e1 ⊗e2 ∈T 0
2 (R3), by identifying (R3)∗with R3.
G.
Higher order tensors arise in elasticity and Riemannian geometry. In elasticity, the stress tensor is a
symmetric 2-tensor and the elasticity tensor is a fourth-order tensor (see Marsden and Hughes [1983]). In
Riemannian geometry the metric tensor is a symmetric 2-tensor and the curvature tensor is a fourth-order
tensor.
♦

294
5. Tensors
Interior Product.
The interior product of a vector v ∈E (resp., a form β ∈E∗) with a tensor
t ∈T r
s (E; F) is the (r, s−1) (resp., (r−1, s)) type F-valued tensor deﬁned by
(ivt)(β1, . . . , βr, v1, . . . , vs−1) = t(β1, . . . , βr, v, v1, . . . , vs−1)
(iβt)(β1, . . . , βr−1, v1, . . . , vs) = t(β, β1, . . . , βr−1, v1, . . . , vs).
Clearly, iv : T r
s (E; F) →T r
s−1(E; F) and iβ : T r
s (E; F) →T r−1
s
(E; F) are linear continuous maps, as are
v →iv and β →iβ. If F = R and dim(E) = n, these operations take the following form in components. If
ek (resp., ek) denotes the kth basis (resp., dual basis) element of E, we have
iek(ei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs) = δj1
k ei1 ⊗· · · ⊗eir ⊗ej2 ⊗· · · ⊗ejs,
iek(ei1 ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs) = δk
i1eis ⊗· · · ⊗eir ⊗ej1 ⊗· · · ⊗ejs.
By Proposition 5.1.2 these formulas and linearity enable us to compute any interior product.
Contractions.
Let dim(E) = n. The contraction of the kth contravariant with the ℓth covariant index,
or for short, the (k, ℓ)-contraction, is the family of linear maps Ck
ℓ: T r
s (E; F) →T r−1
s−1 (E) deﬁned for any
pair of natural numbers r, s ≥1 by
Ck
ℓ(T i1...is
j1...jrei1 ⊗· · · ⊗eis ⊗ej1 ⊗· · · ⊗ejr)
= ti1...ik−1pik+1...is
j1...jℓ−1pjℓ+1...jrei1 ⊗· · · ⊗ˆeik ⊗· · · ⊗eis ⊗ej1 ⊗· · · ⊗ˆejℓ⊗· · · ⊗ejr,
where {e1, . . . , en} is a basis of E, {e1, . . . , en} is the dual basis in E∗, and ˆ over a vector or covector means
that it is omitted. It is straightforward to verify that Ck
ℓso deﬁned is independent of the basis. This is
essentially the same computation that is needed to show that the trace of a linear transformation of E to
itself is intrinsic.
If E is inﬁnite dimensional, contraction is not deﬁned for arbitrary tensors. One introduces the so-called
contraction class tensors, analogous to the trace class operators, deﬁnes contraction as above in terms of
a Banach space basis and its dual, and shows that the contraction class condition implies that the deﬁnition
is basis independent. We shall not dwell upon these technicalities, refer to Rudin [1973] for a brief discussion
of trace class operators, and invite the reader to model the concept of contraction class along these lines. For
example, if E∗= E = ℓ2(R), and ei = ei equals the sequence with 1 in the ith place and zero everywhere
else, then
t =
∞

n=0
2−nen ⊗en ∈T 1
1 (E)
and
C1
1(t) =
∞

n=0
2−n = 2.
Kronecker Delta.
The Kronecker delta is the tensor δ ∈T 1
1 (E) deﬁned by δ(α, e) = ⟨α, e⟩. If E is ﬁnite
dimensional, δ corresponds to the identity I ∈L(E; E) under the canonical isomorphism T 1
1 (E) ∼= L(E; E).
Relative to any basis, the components of δ are the usual Kronecker symbols δi
j, that is, δ = δi
jei ⊗ej.
Associated Tensors.
Suppose E is a ﬁnite-dimensional real inner product space with a basis {e1, . . . , en}
and corresponding dual basis {e1, . . . , en} in E∗. Using the inner product, with matrix denoted by [gij], so
gij = ⟨⟨ei, ej⟩⟩, we get the isomorphism
♭: E →E∗given by x →⟨⟨x, ·⟩⟩,
and its inverse ♯: E∗→E.
The matrix of ♭is [gij]; that is,
(x♭)i = gijxj
and of ♯is [gij]; that is,
(α♯)i = gijαj,

5.1 Tensors on Linear Spaces
295
where xj and αj are the components of e and α, respectively. We call ♭the index lowering operator and
♯the index raising operator.
These operators can be applied to tensors to produce new ones. For example if t is a tensor of type (0, 2)
we can deﬁne an associated tensor t′ of type (1, 1) by
t′(e, α) = t(e, α♯).
The components are
(t′)j
i = gjktik
(as usual, sum on k).
In the classical literature one writes tj
i for gjktik, and this is indeed a convenient notation in calculations.
However, contrary to the impression one may get from the classical theory of Cartesian tensors, t and t′ are
diﬀerent tensors.
5.1.4 Examples.
Let E be a ﬁnite-dimensional real vector space with basis {e1, . . . , en} and dual basis {e1, . . . , en}.
A.
If t ∈T 2
1 (E) and x = xiei, then
ixt = xpiep(tkℓ
j ek ⊗eℓ⊗ej) = xptkℓ
j iep(ek ⊗eℓ⊗ej)
= xptkℓ
j δj
pek ⊗eℓ= xptkℓ
p ek ⊗eℓ.
Thus, the components of ixt are xptkℓ
p . The interior product of the same tensor with α = αpep takes the
form
iαt = αptkℓ
j iep(ek ⊗eℓ⊗ej) = αptkℓ
j δp
keℓ⊗ej = αptpℓ
j eℓ⊗ej.
B.
If t ∈T 2
3 (E), the (2, 1)-contraction is given by
C2
1(tij
kℓmei ⊗ej ⊗ek ⊗eℓ⊗em) = tij
jℓmei ⊗eℓ⊗em.
C.
An important particular example of contraction is the trace of a (1, 1)-tensor. Namely, if t ∈T 1
1 (E),
then trace(t) = C1
1(t) = ti
i, where t = ti
jei ⊗ej.
D.
The components of the tensor associated to g by raising the second index are gjkgik = gjkgki = δj
i .
E.
Let
t ∈T 3
2 (E),
t = tijk
ℓmei ⊗ej ⊗ek ⊗eℓ⊗em.
Then t has quite a few associated tensors, depending on which index is lowered or raised. For example
tijkm
ℓ
= gmptijk
ℓp ,
tim
jkℓ= gjagkbgmctiab
ℓc
tkℓm
ij
= giagjbgℓcgmdtabk
cd
tjℓ
ikm = giagkbgℓctajb
cm
and so on.

296
5. Tensors
F.
The positioning of the indices in the components of associated tensors is important. For example, if
t ∈T 02(E), we saw earlier that tj
i = gjktik. However, tj
i = gijtki, which is in general diﬀerent from tj
i when
t is not symmetric. For example, if E = R3 with gij = δij and the nine components of t in the standard
basis are t12 = 1, t21 = −1, tij = 0 for all other pairs i, j, then tij = tij, tji = tji, so that t12 = t12 = 1 while
t21 = t21 = −1.
G.
The trace of a (2, 0)-tensor is deﬁned to be the trace of the associated (1, 1) tensor; that is, if t =
tijei ⊗ej, then
trace(t) = ti
i = giktik.
The question naturally arises whether we get the same answer by lowering the ﬁrst index instead of the
second, that is, if we consider ti
i. By symmetry of gij we have ti
i = gkitik = tk
k, so that the deﬁnition of the
trace is independent of which index is lowered. Similarly, if
t ∈T 0
2 (E),
trace(t) = ti
i = giktik = tk
k.
In particular trace(g) = gi
i = gik
ik = dim(E).
♦
The Dual of a Linear Transformation.
If ϕ ∈L(E, F), the transpose or dual of ϕ, denoted ϕ∗∈
L(F∗, E∗) is deﬁned by ⟨ϕ∗(β), e⟩= ⟨β, ϕ(e)⟩, where β ∈F∗and e ∈E.
Let us analyze the matrices of ϕ and ϕ∗. As customary in linear algebra, vectors in a given basis are
represented by a column whose entries are the components of the vector. Let ϕ ∈L(E, F) and let {e1, . . . , en}
and {f1, . . . , fm} be ordered bases of E and F respectively. Put ϕ(ei) = Aa
i fa. (We use a diﬀerent dummy
index for the F-index to avoid confusion.) This deﬁnes the matrix of ϕ; A = [Aa
i ]. Thus, for v = viei ∈E the
components of ϕ(v) are given by ϕ(v)a = Aa
i vi. Hence, thinking of v and ϕ(v) as column vectors, this formula
shows that ϕ(v) is computed by multiplying v on the left by A, the matrix of ϕ, as in elementary linear
algebra. Thus, the upper index is the row index, while the lower index is the column index. Consequently,
ϕ(ei) represents the ith column of the matrix of ϕ. Let us now investigate the matrix of ϕ∗∈L(F∗, E∗).
In the dual ordered bases, ⟨ϕ∗(f a), ei⟩= ⟨f a, ϕ(ei)⟩=

f a, Ab
ifb

= Ab
iδa
b = Aa
i , that is, ϕ∗(f a) = Aa
i ei
and thus ϕ∗(f a) is the ath row of A. Consequently the matrix of ϕ∗is the transpose of the matrix of ϕ.
If β = βaf a ∈F∗then ϕ∗(β) = βaϕ∗(f a) = βaAa
i ei, which says that the ith component of ϕ∗(β) equals
ϕ∗(β)i = βaAa
i . Thinking of elements in the dual as rows whose entries are their components in the dual
basis, this shows that ϕ∗(β) is computed by multiplying β on the right by A, the matrix of ϕ, again in
agreement with linear algebra.
Push-forward and Pull-back.
Now we turn to the eﬀect of linear transformations on tensors. We start
with an induced map that acts “forward” like ϕ.
5.1.5 Deﬁnition.
If ϕ ∈L(E, F) is an isomorphism, deﬁne the push-forward of ϕ, T rsϕ = ϕ∗∈
L(T rs(E), T rs(F)) by
ϕ∗t(β1, . . . , βr, f1, . . . , fs) = t(ϕ∗(β1), . . . , ϕ∗(βr), ϕ−1(f1), . . . , ϕ−1(fs)),
where t ∈T rs(E), β1, . . . , βr ∈F∗, and f1, . . . , fs ∈F.
We leave the veriﬁcation that ϕ∗is continuous to the reader. Note that T 01ϕ = (ϕ−1)∗, which maps
“forward” like ϕ. If E and F are ﬁnite dimensional, then T 10(E) = E, T 10(F) = F and we identify ϕ with
T 10ϕ. The next proposition asserts that the push-forward operation is compatible with compositions and
the tensor product.
5.1.6 Proposition.
Let ϕ : E →F and ψ : F →G be isomorphisms. Then
(i)
(ψ ◦ϕ)∗= ψ∗◦ϕ∗;
(ii)
if i : E →E is the identity, then so is i∗: T rs(E) →T rs(E);

5.1 Tensors on Linear Spaces
297
(iii)
ϕ∗: T rs(E) →T rs(F) is an isomorphism, and (ϕ∗)−1 = (ϕ−1)∗;
(iv)
If t1 ∈T r1s1(E) and t2 ∈T r2s1(E), then ϕ∗(t1 ⊗t2) = ϕ∗(t1) ⊗ϕ∗(t2).
Proof.
For (i),
ψ∗(ϕ∗t)(γ1, . . . , γr, g1, . . . , gs)
= ϕ∗t(ψ∗(γ1), . . . , ψ∗(γr), ψ−1(g1), . . . , ψ−1(gs))
= t(ϕ∗ψ∗(γ1), . . . , ϕ∗ψ∗(γr), ϕ−1ψ−1(g1), . . . , ϕ−1ψ−1(gs))
= t((ψ ◦ϕ)∗(γ1), . . . , (ψ ◦ϕ)∗(γr), (ψ ◦ϕ)−1(g1), . . . , (ψ ◦ϕ)−1(gs))
= (ψ ◦ϕ)∗t(γ1, . . . , γr, g1, . . . , gs),
where γ1, . . . , γr ∈G∗, g1, . . . , gs ∈G, and t ∈T rs(E). We have used the fact that the transposes and
inverses satisfy (ψ ◦ϕ)∗= ϕ∗◦ψ∗and (ψ ◦ϕ)−1 = ϕ−1 ◦ψ−1, which the reader can easily check. Part (ii)
is an immediate consequence of the deﬁnition and the fact that i∗= i and i−1 = i. Finally, for (iii) we have
ϕ∗◦(ϕ−1)∗= i∗, the identity on T rs(F), by (i) and (ii). Similarly, (ϕ−1)∗◦ϕ∗= i∗the identity on T rs(E).
Hence (iii) follows. Finally (iv) is a straightforward consequence of the deﬁnitions.
■
Since (ϕ−1)∗maps “backward” it is called the pull-back of ϕ and is denoted ϕ∗. The next proposition
gives a connection with component notation.
5.1.7 Proposition.
Let ϕ ∈L(E, F) be an isomorphism of ﬁnite dimensional vector spaces. Let [Aa
i ]
denote the matrix of ϕ in the ordered bases {e1, . . . , en} of E and {f1, . . . , fn} of F, that is, ϕ(ei) = Aa
i fa.
Denote by [Bi
a] the matrix of ϕ−1, that is, ϕ−1(fa) = Bi
aei. Then [Bi
a] is the inverse matrix of [Aa
i ] in the
sense that Bi
aAa
j = δi
j. Let
t ∈T r
s(E)
with components
ti1...ir
j1...js
relative to
{e1, . . . , en}
and
q ∈T r
s(F)
with components
qa1...ar
b1...bs
relative to
{f1, . . . , fn}.
Then the components of ϕ∗t relative to {f1, . . . , fn} and of ϕ∗q relative to {e1, . . . , en} are given respectively
by
(ϕ∗t)a1...ar
b1...bs = Aa1
i1 . . . Aar
ir ti1...ir
j1...jsBj1
b1 . . . Bjs
bs
(ϕ∗q)i1...ir
j1...js = Bi1
a1 . . . Bir
arqa1...ar
b1...bs Ab1
j1 . . . Abs
js.
Proof.
We have
ei = ϕ−1(ϕ(ei)) = ϕ−1(Aa
i fa) = Aa
i ϕ−1(fa) = Aa
i Bj
aej,
whence Bj
aAa
i = δj
i for all i, j. Similarly, one shows that Ab
iBi
a = δb
a, so that [Aa
i ]−1 = [Bj
a]. We have
(ϕ∗t)a1...ar
b1...bs = (ϕ∗t)(f a1, . . . , f ar, fb1, . . . , fbs)
= t(ϕ∗(f a1), . . . , ϕ∗(f ar), ϕ−1(fb1), ϕ−1(fbs))
= t(Aa1
i1 ei1, . . . , Aar
ir eir, Bj1
b1ej1, . . . , Bjs
bseis)
= Aa1
i1 . . . Aar
ir ti1...ir
j1...jsbj1
b1 . . . bjs
bs.
To prove the second relation, we need the matrix of (ϕ−1)∗∈L(E∗, F∗). We have

(ϕ−1)∗(ei), fa

=

ei, ϕ−1(fa)

=

ei, Bk
aek

= Bi
a
so that (ϕ−1)∗(ei) = Bi
af a. Now proceed as in the previous case.
■

298
5. Tensors
Note that the matrix of (ϕ−1)∗∈L(E∗, F∗) is the transpose of the inverse of the matrix of ϕ.
The assumption that ϕ be an isomorphism for ϕ∗to exist is quite restrictive but clearly cannot be
weakened. However, one might ask if instead of “push-forward,” the “pull-back” operation is considered,
this restrictive assumption can be dropped. This is possible when working with covariant tensors, even when
ϕ ∈L(E, F) is arbitrary.
5.1.8 Deﬁnition.
If ϕ ∈L(E, F) (not necessarily an isomorphism), deﬁne the pull-back ϕ∗∈L(T 0s(F), T 0s(E))
by
ϕ∗t(e1, . . . , es) = t(ϕ(e1), . . . , ϕ(es)),
where t ∈T 0s(F) and e1, . . . , es ∈E.
Likewise, one can push forward tensors in T r
0 (E) even if ϕ is not an isomorphism.
The next proposition asserts that ϕ∗is compatible with compositions and the tensor product. Its proof
is almost identical to that of proposition 5.1.6 and is left as an exercise for the reader.
5.1.9 Proposition.
Let ϕ ∈L(E; F) and ψ ∈L(F; G).
(i)
(ψ ◦ϕ)∗= ϕ∗◦ψ∗.
(ii)
If i : E →E is the identity, then so is i∗∈L(T 0
s (E), T 0
s (E)).
(iii)
If ϕ is an isomorphism, then so is ϕ∗and
ϕ∗= (ϕ−1)∗.
(iv)
If t1 ∈T 0
s1(F) and t2 ∈T 0
s2(F), then
ϕ∗(t1 ⊗t2) = (ϕ∗t1) ⊗(ϕ∗t2).
Finally, the components of ϕ∗t are given by the following.
5.1.10 Proposition.
Let E and F be ﬁnite-dimensional vector spaces and ϕ ∈L(E, F). For ordered bases
{e1, . . . , en} of E and {f1, . . . , fm} of F, suppose that ϕ(ei) = Aa
i fa, and let t ∈T 0
s (F) have components
tb1...bs. Then the components of ϕ∗t relative to {e1, . . . , en} are given by
(ϕ∗t)j1...js = tb1...bsAb1
j1 . . . Abs
js.
Proof.
(ϕ∗t)j1...js = (ϕ∗t)(ej1, . . . , ejs) = t(ϕ(ej1), . . . , ϕ(ejs))
= t(Ab1
j1fb1, . . . , Abs
jsfbs) = t(fb1, . . . , fbs)Ab1
j1 . . . Abs
js
= tb1...bsAb1
j1 . . . Abs
js
■
5.1.11 Examples.
A.
On R2 with the standard basis {e1, e2}, let t ∈T 2
0 (R2) be given by t = e1⊗e1+2e1⊗e2−e2⊗e1+3e2⊗e2
and let ϕ ∈L(R2, R2) have the matrix
A =

2
1
1
1

.

5.1 Tensors on Linear Spaces
299
Then ϕ is clearly an isomorphism, since A has an inverse matrix given by
B =

1
−1
−1
2

.
According to Proposition 5.1.7, the components of T = ϕ∗t relative to the standard basis of R2 are given by
T ij = Bi
aBj
btab,
with
B1
1 = 1, B2
1 = B1
2 = −1, and B2
2 = 2
so that
T 12 = B1
1B2
1t11 + B1
1B2
2t12 + B1
2B2
1t21 + B1
2B2
2t22
= 1 · (−1) · 1 + 1 · 2 · 2 + (−1) · (−1) · (−1) + (−1) · 2 · 3 = −4,
T 21 = B2
1B1
1t11 + B2
1B1
2t12 + B2
2B1
1t21 + B2
2B1
2t22
= (−1) · 1 · 1 + (−1) · (−1) · 2 + 2 · 1 · (−1) + 2 · (−1) · 3 = −7,
T 11 = B1
1B1
1t11 + B1
1B1
2t12 + B1
2B1
1t21 + B1
2B1
2t22
= 1 · 1 · 1 + 1 · (−1) · 2 + (−1) · 1 · (−1) + (−1) · (−1) · 3 = 3,
T 22 = B2
1B2
1t11 + B2
1B2
2t12 + B2
2B2
1t21 + B2
2B2
2t22
= (−1) · (−1) · 1 + (−1) · 2 · 2 + 2 · (−1) · (−1) + 2 · 2 · 3 = 11.
Thus, ϕ∗t = 3e1 ⊗e1 −4e1 ⊗e2 −7e2 ⊗e1 + 11e2 ⊗e2.
B.
Let t = e1 ⊗e2 −2e2 ⊗e2 ∈T 1
1 (R2) and consider the same map ϕ ∈L(R2, R2) as in part (a) above. We
could compute the components of ϕ∗t relative to the standard basis of R2 using the formula in Proposition
5.1.7 as before. An alternative way to proceed directly using Proposition 5.1.6(iv), that is, the fact that ϕ∗
is compatible with tensor products. Thus
ϕ∗t = ϕ∗(e1 ⊗e2 −2e2 ⊗e2) = ϕ(e1) ⊗ϕ∗(e2) −2ϕ(e2) ⊗ϕ∗(e2).
But ϕ(e1) = 2e1 + e2, ϕ(e2) = e1 + e2, and ϕ∗(e2) = −e1 + 2e2, so that
ϕ∗t = (2e1 + e2) ⊗(−e1 + 2e2) −2(e1 + e2) ⊗(−e1 + 2e2)
= e2 ⊗e1 −2e2 ⊗e2.
C.
Let e1, e2 be the standard basis of R2 and e1, e2 be the dual basis, as usual. Let t = −2e1 ⊗e2 ∈T 0
2 (R2)
and ϕ ∈L(R3, R2) be given by the matrix
A =

0
1
2
0
−1
1

.
We will compute ϕ∗t ∈T 0
2 (R3) by using the fact that ϕ∗is compatible with tensor products and that the
matrix of ϕ∗∈L(R2, R3) is the transpose of A . Recall that ϕ∗(ei) is the ith row, since matrices act on
the right on covectors. Let f 1, f 2, f 3 denote the standard dual basis of R3. Then ϕ∗(e1) = f 1 + 2f 3 and
ϕ∗(e2) = −f 2 + f 3, so that
ϕ∗(t) = −2ϕ∗(e1) ⊗ϕ∗(e2) = −2(f 1 + 2f 3) ⊗(−f 2 + f 3)
= 2f 1 ⊗f 2 −2f 1 ⊗f 3 + 4f 3 ⊗f 2 −4f 3 ⊗f 3.
♦

300
5. Tensors
Exercises
⋄5.1-1.
Compute the interior product of the tensor
t = e1 ⊗e1 ⊗e2 + 3e2 ⊗e2 ⊗e1
with e = −e1 + 2e2 and α = 2e1 + e2. What are the (1, 1) and (2, 1) contractions of t?
⋄5.1-2.
Compute all associated tensors of t = e1 ⊗e2 ⊗e2 + 2e2 ⊗e1 ⊗e2 −e2 ⊗e2 ⊗e1 with respect to the
standard metric of R2.
⋄5.1-3.
Let t = 2e1 ⊗e1 −e2 ⊗e1 + 3e1 ⊗e2 and ϕ ∈L(R2, R2), ψ ∈L(R3, R2) be given by the matrices

2
1
−1
1

,

0
1
−1
1
0
2

.
Compute: trace(t), ϕ∗t, ψ∗t, trace(ϕ∗t), trace(ψ∗t), ϕ∗t, and all associated tensors of t, ϕ∗t, ψ∗t, and ϕ∗t
with respect to the corresponding standard inner products in R2 and R3.
⋄5.1-4.
Let dim(E) = n and dim(F) = m. Show that T r
s (E; F) is an mnr+s-dimensional real vector space
by exhibiting a basis.
5.2
Tensor Bundles and Tensor Fields
We now extend the tensor algebra to local vector bundles, and then to vector bundles. For U ⊂E (open)
recall that U ×F is a local vector bundle. Then U ×T r
s (F) is also a local vector bundle in view of Proposition
5.1.2. Suppose ϕ : U × F →U ′ × F′ is a local vector bundle mapping and is an isomorphism on each ﬁber;
that is ϕu = ϕ|{u} × F ∈L(F, F′) is an isomorphism. Also, let ϕ0 denote the restriction of ϕ to the zero
section. Then ϕ induces a mapping of the local tensor bundles as follows.
5.2.1 Deﬁnition.
If ϕ : U × F →U ′ × F′ is a local vector bundle mapping such that for each u ∈U, ϕu
is an isomorphism, let ϕ∗: U × T r
s (F) →U ′ × T r
s (F′) be deﬁned by
ϕ∗(u, t) = (ϕ0(u), (ϕu)∗t),
where t ∈T r
s (F).
Before proceeding, we shall pause and recall some useful facts concerning linear isomorphisms from Lem-
mas 2.5.4 and 2.5.5.
5.2.2 Proposition.
Let GL(E, F) denote the set of linear isomorphisms from E to F. Then GL(E, F) ⊂
L(E, F) is open.
5.2.3 Proposition.
Deﬁne the maps
A : L(E, F) →L(F∗, E∗);
ϕ →ϕ∗
and
I : GL(E, F) →GL(F, E);
ϕ →ϕ−1.
Then A and I are of class C∞and
DI−1(ϕ) · ψ = −ϕ−1 ◦ψ ◦ϕ−1.
Smoothness of A is clear since it is linear.

5.2 Tensor Bundles and Tensor Fields
301
5.2.4 Proposition.
If ϕ : U × F →U ′ × F′ is a local vector bundle map and ϕu is an isomorphism for
all u ∈U, then ϕ∗: U × T r
s (F) →U ′ × T r
s (F′) is a local vector bundle map and (ϕu)∗= (ϕ∗)u is an
isomorphism for all u ∈U. Moreover, if ϕ is a local vector bundle isomorphism then so is ϕ∗.
Proof.
That ϕ∗is an isomorphism on ﬁbers follows from Proposition 5.1.6(iii) and the last assertion
follows from the former. By Deﬁnition 5.2.1 we need only establish that (ϕu)∗= (ϕ∗)u is of class C∞. Now
ϕu is a smooth function of u, and, by Proposition 5.2.3 ϕ∗
u and ϕ−1
u
are smooth functions of u. The map
(ϕu)∗is a Cartesian product of r factors ϕ∗
u and s factors ϕ−1
u , so is smooth. Hence, from the product rule,
(ϕu)∗is smooth.
■
This smoothness can be veriﬁed also for ﬁnite-dimensional bundles by using the standard bases in the
tensor spaces as local bundle charts and proving that the components of ϕ∗t are C∞functions.
We have the following commutative diagram, which says that ϕ∗preserves ﬁbers:
U × T r
s (F)
U ′ × T r
s (F′)
U
U ′
ϕ∗
ϕ0
π
π′
✲
✲
❄
❄
Tensor Bundles.
With the above preliminaries out of the way, we can now deﬁne tensor bundles.
5.2.5 Deﬁnition.
Let π : E →B be a vector bundle with Eb = π−1(b) denoting the ﬁber over the point
b ∈B. Deﬁne
T r
s (E) =

b∈B
T r
s (Eb)
and πr
s : T r
s (E) →B by πr
s(e) = b where e ∈T r
s (Eb). Furthermore, for a given subset A of B, we deﬁne
T r
s (E)|A =

b∈A
T r
s (Eb).
If π′ : E′ →B′ is another vector bundle and (ϕ, ϕ0) : E →E′ is a vector bundle mapping with ϕb = ϕ|Eb
an isomorphism for all b ∈B, let ϕ∗: T r
s (E) →T r
s (E′) be deﬁned by ϕ∗|T r
s (Eb) = (ϕb)∗.
Now suppose that (E|U, ϕ) is an admissible local bundle chart of π, where U ⊂B is an open set. Then
the mapping ϕ∗|[T r
s (E)|U] is obviously a bijection onto a local bundle, and thus is a local bundle chart.
Further, (ϕ∗)b = (ϕb)∗is a linear isomorphism, so this chart preserves the linear structure of each ﬁber. We
shall call such a chart a natural chart of T r
s (E).
5.2.6 Theorem.
If π : E →B is a vector bundle, then the set of all natural charts of πr
s : T r
s (E) →B is
a vector bundle atlas.
Proof.
Condition VB1 is obvious. For VB2, suppose we have two overlapping natural charts, ϕ∗and ψ∗.
For simplicity, let them have the same domain. Then α = ψ ◦ϕ−1 is a local vector bundle isomorphism, and
by Proposition 5.1.6, ψ∗◦(ϕ∗)−1 = α∗, is a local vector bundle isomorphism by Proposition 5.2.4.
■
This atlas of natural charts called the natural atlas of πr
s, generates a vector bundle structure, and it is
easily seen that the resulting vector bundle is Hausdorﬀ, and all ﬁbers are isomorphic Banachable spaces.
Hereafter, T r
s (E) will denote all of this structure.

302
5. Tensors
5.2.7 Proposition.
If f : E →E′ is a vector bundle map that is an isomorphism on each ﬁber, then
f∗: T r
s (E) →T r
s (E′) is also a vector bundle map that is an isomorphism on each ﬁber.
Proof.
Let (U, ϕ) be an admissible vector bundle chart of E, and let (V, ψ) be one of E′ so that f(U) ⊂V
and fϕψ = ψ ◦f ◦ϕ−1 is a local vector bundle mapping. Then using the natural atlas, we see that
(f∗)ϕ∗,ψ∗= (fϕψ)∗.
■
5.2.8 Proposition.
Let f : E →E′ and g : E′ →E′′ be vector bundle maps that are isomorphisms on
each ﬁber. Then so is g ◦f, and
(i)
(g ◦f)∗= g∗◦f∗;
(ii)
if i : E →E is the identity, then i∗: T r
s (E) →T r
s (E) is the identity;
(iii)
if f : E →E′ is a vector bundle isomorphism, then so if f∗and (f∗)−1 = (f −1)∗.
Proof.
For (i) we examine representatives of (g ◦f)∗and g∗◦f∗. These representatives are the same in
view of Proposition 5.1.6. Part (ii) is clear from the deﬁnition, and (iii) follows from (i) and (ii) by the same
method as in Proposition 5.1.6.
■
We now specialize to the case where π : E →B is the tangent vector bundle of a manifold.
5.2.9 Deﬁnition.
Let M be a manifold and τM : TM →M its tangent bundle. We call T r
s (M) = T r
s (TM)
the vector bundle of tensors contravariant order r and covariant order s, or simply of type (r, s).
We identify T 1
0 (M) with TM and call T 0
1 (M) the cotangent bundle of M also denoted by τ ∗
M : T ∗M →M.
The zero section of T r
s (M) is identiﬁed with M.
Tensor Fields.
Recall that a section of a vector bundle assigns to each base point b a vector in the
ﬁber over b and the addition and scalar multiplication of sections takes place within each ﬁber. In the
case of T r
s (M) these vectors are called tensors. The C∞sections of π : E →B were denoted Γ∞(π), or
Γ∞(E). Recall that F(M) denotes the set of mappings from M into R that are of class C∞(the standard
local manifold structure being used on R) together with its structure as a ring; namely, f + g, cf, fg for
f, g ∈F(M), c ∈R are deﬁned by
(f + g)(x) = f(x) + g(x),
(cf)(x) = c(f(x)),
and
(fg)(x) = f(x)g(x).
Finally, recall that a vector ﬁeld on M is an element of X(M) = Γ∞(TM).
5.2.10 Deﬁnition.
A tensor ﬁeld of type (r, s) on a manifold M is a C∞section of T r
s (M). We
denote by T r
s (M) the set Γ∞(T r
s (M)) together with its (inﬁnite-dimensional) real vector space structure. A
covector ﬁeld or diﬀerential one-form is an element of X∗(M) = T 0
1 (M).
If f ∈F(M) and t ∈T r
s (M), let ft : M →T r
s (M) be deﬁned by m →f(m)t(m). If Xi ∈X(M),
i = 1, . . . , s, αj ∈X∗(M), j = 1, . . . , r, and t′ ∈T r′
s′ (M) deﬁne
t(α1, . . . , αr, X1, . . . , Xs) : M →R
by
m →t(m)(α1(m), . . . , Xs(m))
and
t ⊗t′ : M →T r+r′
s+s′ (M)
by
m →t(m) ⊗t′(m).
5.2.11 Proposition.
With f, t, Xi, αj, and t′ as in Deﬁnition 5.2.10,
ft ∈T r
s (M),
t(α1, . . . , Xs) ∈F(M),
and
t ⊗t′ ∈T r+r′
s+s′ .
Proof.
The diﬀerentiability is evident in each case from the product rule in local representation.
■
For the tangent bundle TM, a natural chart is obtained by taking Tϕ, where ϕ is an admissible chart of
M. This in turn induces a chart (Tϕ)∗on T r
s M. We shall call these the natural charts of T r
s M.

5.2 Tensor Bundles and Tensor Fields
303
Coordinate Representation of Tensor Fields.
Recall that ∂/∂xi = (Tϕ)−1(ei), for ϕ : U →U ′ ⊂Rn
a chart on M, is a basis of X(U). The vector ﬁeld ∂/∂xi corresponds to the derivation f →∂f/∂xi. Since
dxi(∂/∂xj) = ∂xi/∂xj = δi
j, we see that dxi is the dual basis of ∂/∂xi at every point of U, that is, that
dxi = ϕ∗(ei), where {e1, . . . , en} is the dual basis to {e1, . . . , en}. Let
ti1...ir
j1...js = t

dxi1, . . . , dxir,
∂
∂xj1 , . . . ,
∂
∂xjs
	
∈F(U).
Applying Proposition 5.1.6(iv) at every point yields the coordinate expression of an (r, s)-tensor ﬁeld:
t


U = ti1...ir
j1...js
∂
∂xi1 ⊗· · · ⊗
∂
∂xir ⊗dxj1 ⊗· · · ⊗dxjs.
To discuss the behavior of these components relative to a change of coordinates, assume that Xi : U →R,
i = 1, . . . , n is a diﬀerent coordinate system. We can write ∂/∂xi = aj
i∂/∂Xj, since both are bases of X(U).
Applying both sides to Xk yields aj
i = ∂Xj/∂xi that is, (∂/∂xi) = (∂Xj/∂xi)(∂/∂Xj). Thus the dxi, as
dual basis change with the inverse of the Jacobian matrix [∂Xj/∂xi]; that is, dxi = (∂xi/∂Xj)dXj. Writing
t in both coordinate systems and isolating equal terms gives the following change of coordinate formula for
the components:
T k1...kr
ℓ1...ℓs = ∂Xk1
∂xi1 · · · ∂Xkr
∂xir
∂xj1
∂Xℓ1 · · · ∂xjs
∂Xℓs ti1...ir
j1...js
This formula is known as the tensoriality criterion: A set of nr+s functions ti1...ir
j1...js deﬁned for each
coordinate system on the open set U of M locally deﬁne an (r, s)-tensor ﬁeld iﬀchanges of coordinates have
the aforementioned eﬀect on them. This statement is clear since at every point it assures that the nr+s
functions are the components of an (r, s)-tensor in TuU and conversely.
The algebraic operations on tensors, such as contraction, inner products and traces, all carry over ﬁberwise
to tensor ﬁelds. For example, if δm ∈T 1
1 (TmM) is the Kronecker delta, then δ : M →T 1
1 (M); m →δm
is obviously C∞, and δ ∈T 1
1 (M) is called the Kronecker delta. Similarly, a tensor ﬁeld of type (0, s) or
(r, 0) is called symmetric, if it is symmetric at every point.
Metric Tensors.
A basic example of a symmetric covariant tensor ﬁeld is the following.
5.2.12 Deﬁnition.
A weak pseudo-Riemannian metric on a manifold M is deﬁned to be a tensor ﬁeld
g ∈T 0
2 (M) that is symmetric and weakly nondegenerate, that is, such that at each m ∈M, g(m)(vm, wm) = 0
for all wm ∈TmM implies vm = 0. A strong pseudo-Riemannian metric is a 2-tensor ﬁeld that, in
addition is strongly nondegenerate for all m ∈M; that is, the map vm →g(m)(vm, ·) is an isomorphism
of TmM onto T ∗
mM. A weak (resp., strong) pseudo-Riemannian metric is called weak (resp., strong)
Riemannian if in addition g(m)(vm, vm) > 0 for all vm ∈TmM, vm ̸= 0.
It is not hard to show that strong Riemannian manifold is necessarily modeled on a Hilbertizable space;
that is, the model space has an equivalent norm arising from an inner product. For ﬁnite-dimensional
manifolds weak and strong metrics coincide: indeed TmM and T ∗
mM have the same dimension and so a
one-to-one map of TmM to T ∗
mM is an isomorphism. It is possible to have weak metrics on a Banach or
Hilbert manifold that are not strong. For example, the L2 inner product on M = C0([0, 1], R) is a weak
metric that is not strong. For a similar Hilbert space example, see Exercise 5.2-3.
Any Hilbert space is a Riemannian manifold with a constant metric equal to the inner product. A sym-
metric bilinear (weakly) nondegenerate two-form on any Banach space provides an example of a (weak)
pseudo-Riemannian constant metric. A pseudo-Riemannian manifold used in the theory of special relativity
is R4 with the Minkowski pseudo-Riemannian metric
g(x)(v, w) = v1w1 + v2w2 + v3w3 −v4w4,
where x, v, w ∈R4.

304
5. Tensors
Raising and Lowering Indices.
As in the algebraic context of §5.1, pseudo-Riemannian metrics (and
for that matter any strongly nondegenerate bilinear tensor) can be used to deﬁne associated tensors. Thus
the maps ♯, ♭become vector bundle isomorphisms over the identity ♭: TM →T ∗M, ♯: T ∗M →TM; ♯is
the inverse of ♭, where v♭
m = g(m)(vm, ·). In particular, they induce isomorphisms of the spaces of sections
♭: X(M) →X∗(M), ♯: X∗(M) →X(M). In ﬁnite dimensions this is the operation of raising and lowering
indices. Thus formulas like the ones in Example 5.1.4E should be read pointwise in this context.
Gradients.
There is a particular index raising operation that requires special attention.
5.2.13 Deﬁnition.
Let M be a pseudo-Riemannian n-manifold with metric g. For f ∈F(M), the vector
ﬁeld deﬁned by grad f = (df)♯∈X(M) is called the gradient of f.
To ﬁnd the expression of grad f in local coordinates, we write
gij = g
 ∂
∂xi , ∂
∂xj
	
,
X = Xi ∂
∂xi ,
and
Y = Y i ∂
∂xi ,
so we have

X♭, Y

= g(X, Y ) = XiY jg
 ∂
∂xi , ∂
∂xj
	
= XiY jgij;
that is, X♭= Xigijdxj. If α ∈X∗(M) has the coordinate expression α = αidxi, we have α♯= αigij∂/∂xj
where [gij] is the inverse of the matrix [gij]. Thus for α = df, the local expression of the gradient is
grad f = gij ∂f
∂xj
∂
∂xi ;
that is,
(grad f)i = gij ∂f
∂xj .
If M = Rn with standard Euclidean metric gij = δij, this formula becomes
grad f = ∂f
∂xi
∂
∂xi ;
that is,
grad f =
 ∂f
∂x1 , . . . , ∂f
∂xn
	
,
the familiar expression of the gradient from vector calculus.
Push-forward and Pull-back of Tensor Fields.
Now we turn to the eﬀect of mappings and diﬀeo-
morphisms on tensor ﬁelds.
5.2.14 Deﬁnition.
If ϕ : M →N is a diﬀeomorphism and t ∈T r
s (M), let ϕ∗t = (Tϕ)∗◦t ◦ϕ−1, be the
push-forward of t by ϕ. If t ∈T r
s (N), the pull-back of t by ϕ is given by ϕ∗t = (ϕ−1)∗t.
5.2.15 Proposition.
If ϕ : M →N is a diﬀeomorphism, and t ∈T r
s (M), then
(i)
ϕ∗t ∈T r
s (N);
(ii)
ϕ∗: T r
s (M) →T r
s (N) is a linear isomorphism;
(iii)
(ϕ ◦ψ)∗= ϕ∗◦ψ∗; and
(iv)
ϕ∗(t ⊗t′) = ϕ∗t ⊗ϕ∗t′, where t ∈T r
s (M) and t′ ∈T r
s (M).
Proof.
(i) The diﬀerentiability is evident from the composite mapping theorem, together with Proposition
5.2.4. The other three statements are proved ﬁberwise, where they are consequences of Proposition 5.1.6.
■
As in the algebraic context, the pull-back of covariant tensors is deﬁned even for maps that are not
diﬀeomorphisms. Globalizing Deﬁnition 5.1.8 we get the following.

5.2 Tensor Bundles and Tensor Fields
305
5.2.16 Deﬁnition.
If ϕ : M →N and t ∈T 0
s (N), then ϕ∗t, the pull-back of t by ϕ, is deﬁned by
(ϕ∗t)(m)(v1, . . . , vs) = t(ϕ(m))(Tmϕ(v1), . . . , Tmϕ(vs))
for m ∈M, v1, . . . , vs ∈TmM.
The next proposition is similar to Proposition 5.2.15 and is proved by globalizing the proof of Proposition
5.1.9.
5.2.17 Proposition.
If ϕ : M →N is C∞and t ∈T 0
s (N), then
(i)
ϕ∗∈T 0
s (M);
(ii)
ϕ∗: T 0
s (N) →T 0
s (M) is a linear map;
(iii)
(ψ ◦ϕ)∗= ϕ∗◦ψ∗for ψ : N →P;
(iv)
if ϕ is a diﬀeomorphism them ϕ∗is an isomorphism with inverse ϕ∗; and
(v)
t1 ∈T 0
s1(N), t2 ∈T 0
s2(N), then ϕ∗(t1 ⊗t2) = (ϕ∗t1) ⊗(ϕ∗t2).
For ﬁnite-dimensional manifolds the coordinate expressions of the pull-back and push-forward can be read
directly from Propositions 5.1.7 and 5.1.10, taking into account that Tϕ is given locally by the Jacobian
matrix. This yields the following.
5.2.18 Proposition.
Let M and N be ﬁnite-dimensional manifolds, ϕ : M →N a Cr map and denote
by yj = ϕj(x1, . . . , xm) the local expression of ϕ relative to charts where m = dim(M) and j = 1, . . . , n =
dim(N).
(i) If t ∈T r
s (M) and ϕ is a diﬀeomorphism, the coordinates of the push-forward ϕ∗t are
(ϕ∗t)i1...ir
j1...js =
 ∂yi1
∂xk1 ◦ϕ−1
	
· · ·
 ∂yir
∂xkr ◦ϕ−1
	 ∂xℓ1
∂yj1 . . . ∂xℓs
∂yjs tk1...kr
ℓ1...ℓs ◦ϕ−1.
If t ∈T 0
s (N) and ϕ is a diﬀeomorphism, the coordinates of the pull-back ϕ∗t are
(ϕ∗t)i1...ir
j1...js =
∂xi1
∂yℓ1 ◦ϕ
	
. . .
∂xir
∂yℓr ◦ϕ
	 ∂yk1
∂xj1 · · · ∂yks
∂xjs tℓ1...ℓr
k1...ks ◦ϕ.
(ii) If t ∈T 0
s (N) and ϕ : M →N is arbitrary, the coordinates of the pull-back ϕ∗t are
(ϕ∗t)j1...js = ∂yk1
∂xj1 · · · ∂yks
∂xjs tk1...ks ◦ϕ.
Notice the similarity between the formulas for coordinate change and pull-back. The situation is similar
to the passive and active interpretation of similarity transformations PAP−1 in linear algebra. Of course it
is important not to confuse the two.
5.2.19 Examples.
A.
Let ϕ : R2 →R2 be deﬁned by ϕ(x, y) = (x + 2y, y) and let
t = 3x
 ∂
∂x
	
⊗dy +
 ∂
∂y
	
⊗dy ∈T 1
1

R2
.
The matrix of ϕ∗on vector ﬁelds is
∂ϕi
∂xj

=

1
2
0
1


306
5. Tensors
and on forms is
 ∂xi
∂ϕj

=

1
2
0
1
−1
=

1
−2
0
1

.
In other words,
ϕ∗
 ∂
∂x
	
= ∂
∂x,
ϕ∗
 ∂
∂y
	
= 2 ∂
∂x + ∂
∂y .
ϕ∗(dx) = dx −2 dy,
ϕ∗(dy) = dy.
Noting that ϕ−1(x, y) = (x −2y, y), we get
ϕ∗t = 3(x −2y)ϕ∗
 ∂
∂x
	
⊗ϕ∗(dy) + ϕ∗
 ∂
∂y
	
⊗ϕ∗(dy)
= 3(x −2y) ∂
∂x ⊗dy +

2 ∂
∂x + ∂
∂y
	
⊗dy
= (3x −6y + 2) ∂
∂x ⊗dy + ∂
∂y ⊗dy.
B.
With the same mapping and tensor, we compute ϕ∗t. Since
ϕ∗
 ∂
∂x
	
= ∂
∂x,
ϕ∗
 ∂
∂y
	
= −2 ∂
∂x + ∂
∂y .
ϕ∗(dx) = dx + 2 dy,
ϕ∗(dy) = dy,
we have
ϕ∗t = 3(x + 2y)ϕ∗
 ∂
∂x
	
⊗ϕ∗(dy) + ϕ∗
 ∂
∂y
	
⊗ϕ∗(dy)
= 3(x + 3y) ∂
∂x ⊗dy +

−2 ∂
∂x + ∂
∂y
	
⊗dy
= (3x + 6y −2) ∂
∂x ⊗dy + ∂
∂y ⊗dy.
C.
Let ϕ : R3 →R2, ϕ(x, y, z) = (2x + z, xyz) and t = (u + 2v)du ⊗du + (u)2du ⊗dv ∈T 0
2 (R2). Since
ϕ∗(du) = 2dx + dz
and
ϕ∗(dv) = yzdx + xzdy + xydz,
we have
ϕ∗t = (2x + z + 2xyz)(2dx + dz) ⊗(2 dx + dz)
+ (2x + z)2(2 dx + dz) ⊗(yz dx + xz dy + xy dz)
= 2[4x + 2z + 4xyz + (2x + z)2yz] dx ⊗dx + 2(2x + z)2xz dx ⊗dy
+ 2[2x + z + 2xyz + (2x + z)2xy] dx ⊗dz
+ [4x + 2z + 4xyz + yz(2x + z)2]dz ⊗dx
+ xz(2x + z)2 dz ⊗dy + [2x + z + 2xyz + xy(2x + z)2]dz ⊗dz.

5.2 Tensor Bundles and Tensor Fields
307
D.
If ϕ : M →N represents the deformation of an elastic body and g is a Riemannian metric on N, then
C = ϕ∗g is called the Cauchy–Green tensor; in coordinates
Cij = ∂ϕα
∂xi
∂ϕβ
∂xj gαβ ◦ϕ.
Thus, C measures how ϕ deforms lengths and angles.
♦
Alternative Approach to Tensor Fields.
Suppose that F(M) and X(M) have been deﬁned. With the
“scalar multiplication” (f, X) →fX deﬁned in Deﬁnition 5.2.10, X(M) becomes an F(M)-module. That is,
X(M) is essentially a vector space over F(M), but the “scalars” F(M) form only a commutative ring with
identity, rather than a ﬁeld. Deﬁne
LF(M)(X(M), F(M)) = X ∗(M)
the F(M)-linear mappings on X(M), and similarly
Tr
s(M) = Lr+s
F(M)(X ∗(M), . . . , X(M); F(M))
the F(M)-multilinear mappings. From Deﬁnition 5.2.10, we have a natural mapping T r
s (M) →Tr
s(M) which
is F(M)-linear.
5.2.20 Proposition.
Let M be a ﬁnite-dimensional manifold or be modeled on a Banach space with norm
C∞away from the origin. Then T r
s (M) is isomorphic to Tr
s(M) regarded as F(M)-modules and as real
vector spaces. In particular, X∗(M) is isomorphic to X ∗(M).
Proof.
Consider the map T r
s (M) →Tr
s(M) given by
ℓ(α1, . . . , αr, X1, . . . , Xs)(m) = ℓ(m)(α1(m), . . . , Xs(m)).
This map is clearly F(M)-linear. To show it is an isomorphism, given such a multilinear map ℓ, deﬁne t by
t (m)

α1 (m) , . . . , Xs (m)

= ℓ

α1, . . . , Xs

(m) .
To show that t is well-deﬁned we ﬁrst show that, for each v0 ∈TmM, there is an X ∈X(M) such that
X(m) = v0, and similarly for dual vectors. Let (U, ϕ) be a chart at m and let Tmϕ(v0) = (ϕ(m), v′
0). Deﬁne
Y ∈X(U ′) by Y (u) = (u′, v′
0) on a neighborhood V1 of ϕ(m), where w = ϕ(n). Extend Y to U ′ so Y is zero
outside V2, where cl(V1) ⊂V2, cl(V2) ⊂U ′, by means of a bump function. Deﬁne X by Xϕ = Y on U, and
X = 0 outside U. Then X(m) = v0. The construction is similar for dual vectors.
As in Theorem 4.2.16, F(M)-linearity of ℓshows that the deﬁnition of t(m) is independent of how the
vectors v0 (and corresponding dual vectors) are extended to ﬁelds. The tensor ﬁeld t(m) so deﬁned is C∞;
indeed, using the chart ϕ, the local representative of t is C∞by Supplement 3.4A, since ℓinduces a C∞
map M × T r
s (M) →R (by the composite function theorem), which is (r + s)-linear at every m ∈M. If M
is ﬁnite dimensional this last step of the proof can be simpliﬁed as follows. In the chart ϕ with coordinates
(x1, . . . , xn),
t = ti1...ir
j1...js
∂
∂xi1 ⊗· · · ⊗∂
∂ir ⊗dxj1 ⊗· · · ⊗dxjs
and all components of t are C∞by hypothesis.
■
The preceding proposition can be clearly generalized to the Ck situation. One can also get around the use
of a smooth norm on the model space if one assumes that the multilinear maps are localizable, that is, are
deﬁned on X∗(U) × · · · × X(U) with values in F(U) for any open set U in a way compatible with restriction
to U. We shall take this point of view in the next section.

308
5. Tensors
The direct sum T (M) of the T r
s (M), including T 0
0 (M) = F(M), is a real vector space with ⊗-product,
called the tensor algebra of M, and if ϕ : M →M is a diﬀeomorphism, ϕ∗: T (M) →T (N) is an algebra
isomorphism.
The construction of T (M) and the properties discussed in this section can be generalized to vector bundle
valued (r, s)-tensors (resp. tensor ﬁelds), that is, elements (resp. sections) of
L(T ∗M ⊕· · · ⊕T ∗M ⊕TM ⊕· · · ⊕TM, E),
the vector bundle of vector bundle maps from T ∗M ⊕· · · ⊕TM (with r factors of T ∗M and s factors of
TM) to the vector bundle E, which cover the identity map of the base M.
Exercises
⋄5.2-1.
Let ϕ : R2\{ (0, y) | y ∈R } →R2\{ (x, x) | x ∈R } be deﬁned by ϕ(x, y) = (x3 + y, y) and let
t = x ∂
∂x ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dy.
Show that ϕ is a diﬀeomorphism and compute ϕ∗t, ϕ∗t. Endow R2 with the standard Riemannian metric.
Compute the associated tensors of t, ϕ∗t, and ϕ∗t as well as their (1, 1) and (1, 2) contractions. What is the
trace of the interior product of t with ∂/∂x + x∂/∂y?
⋄5.2-2.
Let ϕ : R2 →R3, ϕ(x, y) = (y, x, y + x2) be the deformation of an elastic shell. Compute the
Cauchy–Green tensor and its trace.
⋄5.2-3.
Let H be the set of real sequences {an}n=1,2,... such that
∥an∥2 =

n≥1
n2a2
n < ∞.
Show that H is a Hilbert space. Show that
g (a, b) =

n≥1
anbn
is a weak Riemannian metric on H that is not a strong metric.
⋄5.2-4.
Let (M, g) be a Riemannian manifold and let N ⊂M be a submanifold. Deﬁne
νg(N) = { v ∈TnM | g(n)(v, u) = 0 for allu ∈TnN and all n ∈N }.
Show that νg(N) is a sub-bundle of TM|N isomorphic to both the normal and conormal bundles ν(N) and
µ(N) deﬁned in Exercises 3.4-10 and 3.4-11.
5.3
The Lie Derivative: Algebraic Approach
This section extends the Lie derivative £X from vector ﬁelds and functions to the full tensor algebra. We
shall do so in two ways. This section does this algebraically and in the next section, it is done in terms of
the ﬂow of X. The two approaches will be shown to be equivalent.

5.3 The Lie Derivative: Algebraic Approach
309
Diﬀerential Operators.
We shall demand certain properties of £X such as: if t is a tensor ﬁeld of type
(r, s), so is £Xt, and £X should be a derivation for tensor products and contractions. First of all, how should
£X be deﬁned on covector ﬁelds? If Y is a vector ﬁeld and α is a covector ﬁeld, then the contraction α · Y
is a function, so £X(α · Y ) and £XY are already deﬁned. (See §4.2.) However, if we require the derivation
property for contractions, namely
£X(α · Y ) = (£Xα) · Y + α · (£XY ),
then this forces us to deﬁne £Xα by
(£Xα) · Y = £X(α · Y ) −α · (£XY )
for all vector ﬁelds Y . Since this deﬁnes an F(M)-linear map, £Xα is a well-deﬁned covector ﬁeld. The
extension to general tensors now proceeds inductively in the same spirit.
5.3.1 Deﬁnition.
A diﬀerential operator on the full tensor algebra T (M) of a manifold M is a col-
lection {Dr
s(U)} of maps of T r
s (U) into itself for each r and s ≥0 and each open set U ⊂M, any of which
we denote merely D(the r, s and U are to be inferred from the context), such that
D01.
D is a tensor derivation, or D commutes with contractions, that is, D is R-linear and
if
t ∈T r
s (M),
α1, . . . , αr ∈X∗(M),
and
X1, . . . , Xs ∈X(M),
then
D(t(α1, . . . , αr, X1, . . . , Xs))
= (Dt) (α1, . . . , αr, X1, . . . , Xs)
+
r

j=1
t(α1, . . . , Dαj, . . . , αr, X1, . . . , Xs)
+
s

k=1
t (α1, . . . , αr, X1, . . . , DXk, . . . , Xs) .
D02.
D is local, or is natural with respect to restrictions. That is, for U ⊂V ⊂M open sets,
and t ∈T r
s (V )
(Dt)|U = D(t|U) ∈T r
s (U)
that is, the following diagram commutes
T r
s (V )
T r
s (U)
T r
s (V )
T r
s (U)
|U
|U
D
D
✲
✲
❄
❄
We do not demand that D be natural with respect to push-forward by diﬀeomorphisms. Indeed, several
important diﬀerential operators, such as the covariant derivative, are not natural with respect to diﬀeomor-
phisms, although the Lie derivative is, as we shall see.

310
5. Tensors
5.3.2 Theorem.
Suppose for each open set U ⊂M we have maps
EU : F(U) →F(U)
and
FU : X(U) →X(U),
which are (R-linear) tensor derivations and natural with respect to restrictions. That is
(i)
EU(f ⊗g) = (EUf) ⊗g + f ⊗EUg for f, g ∈F(U);
(ii)
for f ∈F(M), EU(f|U) = (EMf)|U;
(iii)
FU(f ⊗X) = (EUf) ⊗X + f ⊗FUX for f ∈F(U), and X ∈X(U);
(iv)
for X ∈X(M), FUf(X|U) = (FMX)|U.
Then there is a unique diﬀerential operator D on T (M) that coincides with EU on F(U) and with FU on
X(U).
Proof.
Since D must be a tensor derivation, deﬁne D on X∗(U) by the formula
(Dα) · X = D(α · X) −α · (DX) = EU(α · X) −α · FUX
for all X ∈X(U). By properties (i) and (iii), Dα is F(M)-linear and thus by the remark following Proposition
5.2.20, D so deﬁned on X∗(U) has values in X∗(U). Note also that
D(f ⊗α) = (Ef) ⊗α + f ⊗(Dα)
for any α ∈X∗(U), f ∈F(U). This shows that D exists and is unique on X∗(U) (by the Hahn–Banach
theorem). Deﬁne DU on T r
s (U) by requiring D01 to hold:
(DUt)(α1, . . . , αr, X1, . . . , Xs) = EU(t(α1, . . . , αr, X1, . . . , Xs))
−
r

j=1
t(α1, . . . , Dαj, . . . , αr, X1, . . . , Xs)
−
s

k=1
t(α1, . . . αr, X1, . . . , FUXk, . . . , Xs).
From (i), (iii), and D01 for DU on X∗(U), it follows that DUt is an F(M)-multilinear map, that is that
DUt ∈T r
s (U) (see the comment following Proposition 5.2.20). The deﬁnition of DU on T r
s (U) uniquely
determines DU from the property D01. Finally, if V is any open subset of U, by (ii) and (iv) it follows that
DV (t|V ) = (DUt) |V.
This enables us to deﬁne D on F(M) by (Dt)(m) = (DUt)(m), where U is any open subset of M containing
m. Since DU is unique, so is D, and so D02 is satisﬁed by the construction of D.
■
5.3.3 Corollary.
We have
(i)
D(t1 ⊗t2) = Dt1 ⊗t2 + t1 ⊗Dt2, and
(ii)
Dδ = 0, where δ is Kronecker’s delta.
Proof.
(i)
is a direct application of D01. For (ii) let α ∈X∗(U) and X ∈X(U) where U is an arbitrary
chart domain. Then
(Dδ)(α, X) = D(δ(α, X)) −δ(Dα, X) −δ(α, DX)
= D(α · X) −Dα · X −α · DX = 0.
Again the Hahn–Banach theorem assures that Dδ = 0 on U, and thus by D02, Dδ = 0.
■

5.3 The Lie Derivative: Algebraic Approach
311
The Lie Derivative.
Taking EU and FU to be £X|U we see that the hypotheses of Theorem 5.3.2 are
satisﬁed. Hence we can deﬁne a diﬀerential operator as follows.
5.3.4 Deﬁnition.
If X ∈X(M), we let £X be the unique diﬀerential operator on T (M), called the Lie
derivative with respect to X, such that £X coincides with £X as given on F(M) and X(M) (see Deﬁ-
nitions 4.2.6 and 4.2.20).
5.3.5 Proposition.
Let ϕ : M →N be a diﬀeomorphism and X a vector ﬁeld on M. Then £X is natural
with respect to push-forward by ϕ; that is,
£ϕ∗Xϕ∗t = ϕ∗£Xt
for T r
s (M),
or the following diagram commutes:
T r
s (M)
T r
s (N)
T r
s (M)
T r
s (N)
ϕ∗
ϕ∗
£X
£ϕ∗X
✲
✲
❄
❄
Proof.
For an open set U ⊂M deﬁne
D : T r
s (U) →T r
s (U)
by
Dt = ϕ∗£ϕ∗X|U(ϕ∗f),
where we use the same symbol ϕ for ϕ|U. By naturality on F(U) and X(U), D coincides with £X|U on F(U)
and X(U). Next, we show that D is a diﬀerential operator. For D01, we use the fact that
ϕ∗(t(α1, . . . , αr, X1, . . . , Xs)) = (ϕ∗t)(ϕ∗α1, . . . , ϕ∗αr, ϕ∗X1, . . . , ϕ∗Xs),
which follows from the deﬁnitions. Then for X, X1, . . . , Xs ∈X(U) and α1, . . . , αr ∈X∗(U),
D(t(α1 , . . . , αr, X1, . . . , Xs)) = ϕ∗£ϕ∗X(ϕ∗(t(α1, . . . , αr, X1, . . . , Xs)))
= ϕ∗£ϕ∗X((ϕ∗t)(ϕ∗α1, . . . , ϕ∗αr, ϕ∗X1, . . . , ϕ∗Xs))
= ϕ∗[(£ϕ∗Xϕ∗t)(ϕ∗α1, . . . , ϕ∗αr, ϕ∗X1, . . . , ϕ∗Xs))
+
r

j=1
(ϕ∗t)(ϕ∗α1, . . . , £ϕ∗Xϕ∗αj, . . . , ϕ∗αr, ϕ∗X1, . . . , ϕ∗Xs)
+
s

k=1
(ϕ∗t)(ϕ∗α1, . . . , ϕ∗αr, ϕ∗X1, . . . , £ϕ∗Xϕ∗Xk, . . . , ϕ∗Xs)],
by D01 for £X. Since ϕ∗= (ϕ−1)∗by Deﬁnition 5.2.14, this becomes
(Dt)(α1, . . . αr, X1, . . . , Xs) +
r

j=1
(α1, . . . , Dαj, . . . , αr, X1, . . . , Xs)
+
s

k=1
t(α1, . . . , αr, X1, . . . , DXk, . . . , Xs).
For D02, let t ∈T r
s (M) and write
Dt|U = [(ϕ∗)−1£ϕ∗Xϕ∗t]|U = (ϕ∗)−1[£ϕ∗Xϕ∗t]|U
= (ϕ∗)−1£ϕ∗X|Uϕ∗t|U
(by D02 for £X)
= D(t|U).

312
5. Tensors
The result now follows by Theorem 5.3.2.
■
Using the same reasoning, a diﬀerential operator that is natural with respect to diﬀeomorphisms on
functions and vector ﬁelds is natural on all tensors.
Local Formula for the Lie Derivative.
Let us now compute the local formula for £Xt where t is a
tensor ﬁeld of type (r, s). Let ϕ : U ⊂M →V ⊂E be a local chart and let X′ and t′ be the principal parts
of the local representatives, ϕ∗X and ϕ∗t respectively. Thus X′ : V →E and t′ : V →T r
s (E). Recall from
§4.2 that the local formulas for the Lie derivatives of functions and vector ﬁelds are:
(£Xf)′(x) = Df ′(x) · X′(x)
(5.3.1)
where f ′ is the local representative of f and
(£XY )′(x) = DY ′(x) · X′(x) −DX′(x) · Y ′(x).
(5.3.2)
In ﬁnite dimensions, these become
£Xf = Xi ∂f
∂xi
(5.3.1’)
and
[X, Y ]i = Xj ∂Y i
∂xj −Y j ∂Xi
∂xj .
(5.3.2’)
Let us ﬁrst ﬁnd the local expression for £Xα where α is a one-form. By Proposition 5.3.5, the local
representative of £Xα is
ϕ∗(£Xα) = £ϕ∗Xϕ∗α,
which we write as £X′α′ where X′ and α′ are the principal parts of the local representatives, so X′ : V →E
and α′ : V →E∗. Let v ∈E be ﬁxed and regarded as a constant vector ﬁeld. Then as £X is a tensor
derivation,
£X′(α′ · v) = (£X′α′) · v + α′(£X′v).
By equations (5.3.1) and (5.3.2) this becomes
D(α′ · v) · X′ = (£X′α′) · v −α′ · (DX′ · v).
Thus,
(£X′α′) · v = (Dα′ · X′) · v + α′ · (DX′ · v).
In the expression (Dα′ ·X′)·v, Dα′ ·X′ means the derivative of α′ in the direction X′; the resulting element
of E∗is then applied to v. Thus we can write
£X′α′ = Dα′ · X′ + α′ · DX′.
(5.3.3)
In ﬁnite dimensions, the corresponding coordinate expression is
(£Xα)ivi = ∂αi
∂xj Xjvi + αj
∂Xj
∂xi vi;
that is,
(£Xα)i = Xj ∂αi
∂xj + αj
∂Xj
∂xi .
(5.3.3’)

5.3 The Lie Derivative: Algebraic Approach
313
Now let t be of type (r, s), so t′ : V →L(E∗, . . . , E∗, E, . . . , E; R). Let α1, . . . , αr be (constant) elements
of E∗and v1, . . . , vs (constant) elements of E. Then again by the derivation property,
£X′[t′(α1, . . . , αr, v1, . . . , vs)] = (£X′t′)(α1, . . . , αr, v1, . . . , vs)
+
r

i=1
t′(α1, . . . , £X′αi, . . . , αr, v1, . . . , vs)
+
s

j=1
t′(α1, . . . , αr, v1, . . . , £X′vj, . . . , vs).
Using the local formulas (5.3.1)–(5.3.3) for the Lie derivatives of functions, vector ﬁelds, and one-forms, we
get
(Dt′ · X′) · (α1, . . . , αr, v1, . . . , vs)
= (£X′t′)(α1, . . . , αr, v1, . . . , vs)
+
r

i=1
t′(α1, . . . , αi · DX′, . . . , αr, v1, . . . , vs)
+
s

j=1
t′(α1, . . . , αr, v1, . . . , −DX′ · vj, . . . , vs).
Therefore,
(£X′t′)(α1, . . . , αr, v1, . . . , vs)
= (Dt′ · X′)(α1, . . . , αr, v1, . . . , vs)
−
r

i=1
t′(α1, . . . , αi · DX′, . . . , αr, v1, . . . , vs)
+
s

j=1
t′(α1, . . . , αr, v1, . . . , DX′ · vj, . . . , vs).
In components, this reads
(£Xt)i1...ir
j1...js = Xk ∂
∂xk ti1...ir
js...js −∂Xi1
∂xℓtℓi2...ir
j1...js −(all upper indices)
+ ∂Xm
∂xj1 ti1...ir
mj2...js + (all lower indices)
(5.3.4)
We deduced the component formulas for £Xt in the case of a ﬁnite-dimensional manifold as corollaries
of the general Banach manifold formulas. Because of their importance, we shall deduce them again in a
diﬀerent manner, without appealing to Proposition 5.3.5. Let
t = ti1...ir
j1...js
∂
∂xi1 ⊗· · · ⊗
∂
∂xir ⊗dxj1 · · · ⊗dxjs ∈T r
s (U),
where U is a chart domain on M. If X = Xk∂/∂xk, the tensor derivation property can be used to compute
£Xt. For this we recall that
£X(ti1...ir
j1...js) = Xj ∂ti1...ir
j1...js
∂xk

314
5. Tensors
and that
£X
∂
∂xk =

X,
∂
∂xk

= −∂Xi
∂xk
∂
∂xi
by the general formula for the bracket components. The formula for £X(dxk) is found in the following way.
The relation δk
i = dxk(∂/∂xi) implies by D01 that
0 = £X

dxk
 ∂
∂xi
		
= (£X(dxk))
 ∂
∂xi
	
+ dxk

X, ∂
∂xi
	
= (£X(dxk))
 ∂
∂xi
	
+ dxk

−∂Xℓ
∂xi
∂
∂xℓ
	
.
Thus,
(£X(dxk))
 ∂
∂xi
	
= dxk
∂Xℓ
∂xi
∂
∂xℓ
	
= ∂Xk
∂xi ,
so
£X(dxk) =
∂Xk
∂xi
	
dxi.
Now one simply applies D01 and collects terms to get the same local formula for £Xt found in equation
(5.3.4). Note especially that
£ ∂
∂xi
 ∂
∂xj
	
= 0
and
£ ∂
∂xi (dxj) = 0,
for all i, j.
5.3.6 Examples.
A.
Compute £Xt, where
t = x ∂
∂y ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dy
and
X = ∂
∂x + x ∂
∂y .
Solution
Method 1. Note that
(i)
£Xt = £∂/∂x+x∂/∂yt = £∂/∂xt + £∂/∂yt
(ii)
£∂/∂xt = £∂/∂x

x ∂
∂y ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dy

= £∂/∂x

x ∂
∂y ⊗dx ⊗dy
	
+ £∂/∂x

y ∂
∂y ⊗dy ⊗dy
	
= ∂
∂y ⊗dx ⊗dy + 0.
Now note
£x∂/∂y
∂
∂y = 0,
£x∂/∂y
∂
∂x = −£∂/∂x

x ∂
∂y
	
= −

1 · ∂
∂y + x · 0

= −∂
∂y ,
£x∂/∂ydx = 0,
and
£x∂/∂ydy = dx.
Thus,

5.3 The Lie Derivative: Algebraic Approach
315
(iii)
£x∂/∂yt = £x∂/∂y

x ∂
∂y ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dy

=

0 + 0 + 0 + x ∂
∂y ⊗dx ⊗dx
	
+

x ∂
∂y ⊗dy ⊗dy + 0 + y ∂
∂y ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dx
	
.
Thus, substituting (ii) and (iii) into (i), we ﬁnd
£Xt = ∂
∂y ⊗dx ⊗dy + x ∂
∂y ⊗dx ⊗dx + x ∂
∂y ⊗dy ⊗dy
+y ∂
∂y ⊗dx ⊗dy + y ∂
∂y ⊗dy ⊗dx
= (y + 1) ∂
∂y ⊗dx ⊗dy + x ∂
∂y ⊗dx ⊗dx + x ∂
∂y ⊗dy ⊗dy
+y ∂
∂y ⊗dy ⊗dx.
Method 2. Using component notation, t is a tensor of type (1, 2) whose nonzero components are t2
12 = x
and t2
22 = y. The components of X are X1 = 1 and X2 = x. Thus, by the component formula (5.3.4),
(£Xt)i
jk = Xk ∂
∂xk ti
jk −tℓ
jk
∂Xi
∂xℓ+ ti
mk
∂Xm
∂xj + ti
jp
∂Xp
∂xk .
The nonzero components are
(£Xt)2
12 = 1 −0 + y + 0 = 1 + y;
(£Xt)2
22 = x −0 + 0 + 0 = x;
(£Xt)2
11 = 0 −0 + 0 + x = x;
(£Xt)2
21 = 0 −0 + 0 + y = y,
and hence
£Xt = (y + 1) ∂
∂y ⊗dx ⊗dy + x ∂
∂y ⊗dx ⊗dx
+ x ∂
∂y ⊗dy ⊗dy + y ∂
∂y ⊗dy ⊗dx.
The two methods thus give the same answer. It is useful to understand both methods since they both occur
in the literature, and depending on the circumstances, one may be easier to apply than the other.
B.
In Riemannian geometry, vector ﬁelds X satisfying £Xg = 0 are called Killing vector ﬁelds; their
geometric signiﬁcance will become clear in the next section. For now, let us compute the system of equations
that the components of a Killing vector ﬁeld must satisfy. If X = Xi∂/∂xi, and g = gijdxi ⊗dxj, then
£Xg = (£Xgij)dxi ⊗dxj + gij(£Xdxi) ⊗dxj + gijdxi ⊗(£Xdxj)
= Xk ∂gij
∂xk dxi ⊗dxj + gij
∂Xi
∂xk dxk ⊗dxj + gijdxi ⊗∂Xj
∂xk dxk
=

Xk ∂gij
∂xk + gkj
∂Xk
∂xi + gik
∂Xk
∂xj

dxi ⊗dxj.

316
5. Tensors
Note that £Xg is still a symmetric (0, 2)-tensor, as it must be. Hence X is a Killing vector ﬁeld iﬀits
components satisfy the following system of n partial diﬀerential equations, called Killing’s equations
Xk ∂gij
∂xk + gkj
∂Xk
∂xi + gik
∂Xk
∂xj = 0.
C.
In the theory of elasticity, if u represents the displacement vector ﬁeld, the expression £ug is called
the strain tensor. As we shall see in the next section, this is related to the Cauchy–Green tensor C = ϕ∗g
by linearization of the deformation ϕ.
D.
Let us show that £X does not necessarily commute with the formation of associated tensors; for
example, that (£Xt)ij ̸= (£Xτ)ij, where t = ti
j∂/∂xi ⊗dxj ∈T 1
1 (M) and τ = tijdxi ⊗dxj ∈T 0
2 (M) is the
associated tensor with components tij = gijtk
j . We have from equation (5.3.4)
(£Xt)i
j = Xk ∂ti
j
∂kk −tk
j
∂Xi
∂xk + ti
k
∂Xk
∂xj ,
and so
(£Xt)ijgiℓ

Xk ∂tℓ
j
∂xk −tk
j
∂Xℓ
∂xk + tℓ
k
∂Xk
∂xj

.
But also from equation (5.3.4)
(£Xτ)ij = Xk ∂tij
∂xk + tℓj
∂Xℓ
∂xi + tik
∂Xk
∂xj
= Xk ∂
∂xk (giℓtℓ
j) + gℓktk
j
∂Xℓ
∂xi + giℓtℓ
k
∂Xk
∂xj
= Xk ∂giℓ
∂xk tℓ
j + Xkgiℓ
∂tℓ
j
∂xk + gℓktk
j
∂Xℓ
∂xi + giℓtℓ
k
∂Xk
∂xj .
Thus, to have equality it is necessary and suﬃcient that
Xk ∂giℓ
∂xk tℓ
j + gℓktk
j
∂Xℓ
∂xi + giℓtk
j
∂Xℓ
∂xk = 0
for all pairs of indices (i, j), which is a nontrivial system of n2 linear partial diﬀerential equations for gij. If
X is a Killing vector ﬁeld, then
gℓk
∂Xℓ
∂xi giℓ
∂Xℓ
∂xk = −Xℓ∂gik
∂xℓ,
which substituted in the preceding equation, gives zero. The converse statement is proved along the same
lines. In other words, a necessary and suﬃcient condition that £X commute with the formation of associated
tensors is that X be a Killing vector ﬁeld for the pseudo-Riemannian metric g.
♦
As usual, the development of £X extends from tensor ﬁelds to F-valued tensor ﬁelds.

5.4 The Lie Derivative: Dynamic Approach
317
Exercises
⋄5.3-1.
Let
t = xy ∂
∂x ⊗dx + y ∂
∂y ⊗dx + ∂
∂x ⊗dy ∈T 1
1

R2
.
Deﬁne the map ϕ as follows: ϕ : { (x, y) | y > 0 } →{ (x, y) | x > 0, x2 < y } and ϕ(x, y) = (yex, y2e2x + y).
Show that ϕ is a diﬀeomorphism and compute trace(t), ϕ∗t, ϕ∗t, £Xt, £Xϕ∗t, and Lϕ∗Xt, for X = y∂/∂x+
x2∂/∂y.
⋄5.3-2.
Verify explicitly that £X(t♭) ̸= (£Xt)♭where ♭denotes the associated tensor with both indices
lowered, for X and t in Exercise 5.3-1.
⋄5.3-3.
Compute the coordinate expressions for the Killing equations in R3 in rectangular, cylindrical, and
spherical coordinates. What are the Killing vector ﬁelds in Rn?
⋄5.3-4.
Let (M, g) be a ﬁnite dimensional pseudo-Riemannian manifold, and g♯the tensor g with both
indices raised. Let X ∈X(M). Calculate (£Xg♯)♭−£Xg in coordinates.
⋄5.3-5.
If (M, g) is a ﬁnite-dimensional pseudo-Riemannian manifold and f ∈F(M), X ∈X(M), calculate
£X(∇f) −∇(£Xf).
⋄5.3-6.
(i)
Let t ∈T 1
1 (M). Show that there is a unique tensor ﬁeld Nt ∈T 1
2 (M), skew–symmetric in its
covariant indices, such that
£t·Xt −t · £Xt = Nt · X
for all X ∈X(M), where the dots mean contractions, that is (t · X)i = ti
jXj, (t · s)i
j = ti
ksk
j , where
t, s ∈T 1
1 (M), and Nt · X = N i
jkXk, where Nt = N i
jk∂/∂xi ⊗dxj ⊗dxk. Nt is called the Nijenhuis
tensor. Generalize to the inﬁnite-dimensional case.
Hint: Show that N i
jk = tℓ
kti
j,ℓ−tℓ
jti
k,ℓ+ ti
ℓtℓ
k,j −ti
ℓtℓ
j,k.
(ii)
Show that Nt = 0 iﬀ
[t · X, t · Y ] −t · [t · X, Y ] = t · [X, t · Y ] −t2 · [X, Y ]
for all X, Y ∈X(M), where t2 ∈T 1
1 (M) is the tensor ﬁeld obtained by the composition t ◦t, when t
is thought of as a map t : X(M) →X(M).
5.4
The Lie Derivative: Dynamic Approach
We now turn to the dynamic interpretation of the Lie derivative. In §4.2 it was shown that £X acting on
an element of F(M) or X(M), respectively, is the time derivative at zero of that element of F(M) or X(M)
Lie dragged along by the ﬂow of X. The same situation holds for general tensor ﬁelds. Given t ∈T r
s (M)
and X ∈X(M), we get a curve through t(m) in the ﬁber over m by using the ﬂow of X. The derivative of
this curve is the Lie derivative.
5.4.1 Theorem (Lie Derivative Theorem).
Consider the vector ﬁeld X ∈Xk(M), the tensor ﬁeld t ∈
T r
s (M) both of class Ck, k ≥1 and Fλ be the ﬂow of X. Then on the domain of the ﬂow (see Figure 5.4.1),
we have
d
dλF ∗
λt = F ∗
λ£Xt.

318
5. Tensors
integral curve of X
t(m)
Fλ
∗t(mλ)
t(mλ)
X(mλ)
m
mλ=Fλ(m)
Figure 5.4.1. The Lie derivative
Proof.
It suﬃces to show that
d
dλ




λ=0
F ∗
λt = £Xt.
Indeed, if this is proved then
d
dλF ∗
λt =
d
dµ




µ=0
F ∗
µ+λt =
d
dµ




µ=0
F ∗
λF ∗
µt = F ∗
λ£Xt.
Deﬁne θX : T (M) →T (M) by
θX(t)(m) =
d
dλ




λ=0
(F ∗
λt)(m).
Note that θX(t) is a smooth tensor ﬁeld of the same type as t, by smoothness of t and Fλ. (We suppress
the notational clutter of restricting to the domain of the ﬂow.) Let us apply Theorem 5.3.2. Clearly θX
is R-linear and is natural with respect to restrictions. It is a tensor derivation from the product rule for
derivatives and the relation
(ϕ∗t)(ϕ∗α1, . . . , ϕ∗αr, ϕ∗X1, . . . , ϕ∗Xs) = ϕ∗(t(α1, . . . , αr, X1, . . . , Xs))
for ϕ a diﬀeomorphism. Hence θX is a diﬀerential operator. It remains to show that θX coincides with £X
on F(M) and X(M). For f ∈F(M), and X ∈X(M), we have
θXf =
d
dλ




λ=0
F ∗
λf = £Xf
and
θXY =
d
dλ




λ=0
F ∗
λY = [X, Y ]
by Theorems 4.2.10 and 4.2.19, respectively. By Theorem 5.3.2 and Deﬁnition 5.3.4, θXt = £Xt for all
t ∈T (M).
■
This theorem can also be veriﬁed in ﬁnite dimensions by a straightforward coordinate computation. See
Exercise 5.4-1.
The identity in this theorem relating ﬂows and Lie derivatives is so basic, some authors like to take it as
the deﬁnition of the Lie derivative (see Exercise 5.4-3).
5.4.2 Corollary.
If t ∈T (M), £Xt = 0 iﬀt is constant along the ﬂow of X. That is, t = F ∗
λt.
As an application of Theorem 5.4.1, let us generalize the naturality of £X with respect to diﬀeomorphisms.
As remarked in §5.2, the pull-back of covariant tensor ﬁelds makes sense even when the mapping is not a

5.4 The Lie Derivative: Dynamic Approach
319
diﬀeomorphism. It is thus natural to ask whether there is some analogue of Proposition 5.3.5 for pull-backs
with no invertibility assumption on the mapping ϕ. Of course, the best one can hope for, since vector ﬁelds
can be operated upon only by diﬀeomorphisms, is to replace the pair X, ϕ∗X be a pair of ϕ-related vector
ﬁelds.
5.4.3 Proposition.
Let ϕ : M →N be C∞, X ∈X(M), Y ∈X(N), X ∼ϕ Y , and t ∈T 0
s (N). Then
ϕ∗(£Y t) = £Xϕ∗t.
Proof.
Recall from Proposition 4.2.4 that X ∼ϕ Y iﬀGλ ◦ϕ = ϕ ◦Fλ, where Fλ and Gλ are the ﬂows of
X and Y , respectively. Thus by Theorem 5.4.1,
£X(ϕ∗t) =
d
dλ




λ=0
F ∗
λϕ∗t =
d
dλ




λ=0
(ϕ ◦Fλ)∗t
=
d
dλ




λ=0
(Gλ ◦ϕ)∗t =
d
dλ




λ=0
ϕ∗G∗
λt
= ϕ∗d
dλ




λ=0
G∗
λt = ϕ∗(£Y t).
■
As with functions and vector ﬁelds, the Lie derivative can be generalized to include time-dependent vector
ﬁelds.
5.4.4 Theorem (First Time-dependent Lie Derivative Theorem).
Let Xλ ∈Xk(M), k ≥1, for λ ∈R
and suppose that X(λ, m) is continuous in (λ, m). Letting Fλ,µ be the evolution operator for Xλ, we have
d
dλF ∗
λ,µt = F ∗
λ,µ(£Xλt)
where t ∈T r
s (M) is of class Ck.
Warning.
It is not generally true for time-dependent vector ﬁelds that the right hand-side in the preceding
display equals
£XλF ∗
λ,µt.
Proof.
As in Theorem 5.4.1, it is enough to prove the formula at λ = µ where Fλ,λ = identity, for then
d
dλF ∗
λ,µt = d
dρ




ρ=λ
(Fρ,λ ◦Fλ,µ)∗t = F ∗
λ,µ
d
dρ




ρ=λ
F ∗
ρ,λt
= F ∗
λ,µ£Xλt.
As in Theorem 5.4.1,
θXλt =
d
dλ




λ=µ
F ∗
λ,µt
is a diﬀerential operator that coincides with £Xλ on F(M) and on X(M) by Theorem 4.2.31. Thus by
Theorem 5.3.2, θXλ = £Xλ on all tensors.
■
Let us generalize the relationship between Lie derivatives and ﬂows one more step. Call a smooth map
t : R×M →T r
s (M) satisfying tλ(m) = t(λ, m) ∈(TmM)r
s a time-dependent tensor ﬁeld. Theorem 5.4.4
generalizes to this context as follows.

320
5. Tensors
5.4.5 Theorem (Second Time-dependent Lie Derivative Theorem).
Let tλ be a Ck time-dependent ten-
sor, and Xλ be as in Theorem 5.4.4, k ≥1, and denote by Fλ,µ the evolution operator of Xλ. Then
d
dλF ∗
λ,µtλ = F ∗
λ,µ
∂tλ
∂λ + £Xλtλ
	
Proof.
By the product rule for derivatives and Theorem 5.4.4 we get
d
dλ




λ=σ
F ∗
λ,µtλ =
d
dλ




λ=σ
F ∗
λ,µtσ + F ∗
σ,µ
dtλ
dλ




λ=σ
= F ∗
σ,µ(£Xσtσ) + F ∗
σ,µ
dtλ
dλ




λ=σ
.
■
5.4.6 Examples.
A. If g is a pseudo-Riemannian metric on M, the Killing equations are £Xg = 0 (see Example 5.3.6B).
By Corollary 5.4.2 this says that F ∗
λg = g, where Fλ is the ﬂow of X, that is that the ﬂow of X consists
of isometries.
B. In elasticity, the vanishing of the strain tensor means, by Example A, that the body moves as a rigid
body.
♦
We close this section with an important technique based on the dynamic approach to the Lie derivative,
called the Lie transform method. It has been used already in the proof of the Frobenius theorem (§4.4)
and we shall see it again in Chapters 6 and 9. The method is also used in the theory of normal forms (cf.
Takens [1974], Guckenheimer and Holmes [1983], and Golubitsky and Schaeﬀer [1985]).
5.4.7 Example (The Lie Transform Method).
Let two tensor ﬁelds t0 and t1 be given on a smooth man-
ifold M. We say they are locally equivalent at m0 ∈M if there is a diﬀeomorphism ϕ of a neighborhood
of m0 to itself, such that ϕ∗t1 = t0. One way to show that t0 and t1 are equivalent is to join them with a
curve t(λ) satisfying t(0) = t0, t(1) = t1 and to seek a curve of local diﬀeomorphisms ϕλ such that ϕ0 =
identity and
ϕ∗
λt(λ) = t0,
λ ∈[0, 1].
If this is done, ϕ = ϕ1 is the desired diﬀeomorphism. A way to ﬁnd the curve of diﬀeomorphisms ϕλ satisfying
the relation above is to solve the equation
£Xλt(λ) + d
dλt(λ) = 0
for Xλ. If this is possible, let ϕλ = Fλ,0, where Fλ,µ is the evolution operator of the time-dependent vector
ﬁeld Xλ. Then by Theorem 5.4.5 we have
d
dλϕ∗
λt(λ) = ϕ∗
λ

£Xλt(λ) + d
dλt(λ)
	
= 0
so that ϕ∗
λt(λ) = ϕ∗
0(0) = t0. If we choose Xλ so Xλ(m0) = 0, then ϕλ exists for a time ≥1 by Corollary
4.1.25 and ϕλ(m0) = m0.
One often takes t(λ) = (1−λ)t0 +λt1. Also, in applications this method is not always used in exactly this
way since the algebraic equation for Xλ might be hard to solve. We shall see this happen in the proof of the
Poincar´e lemma 6.4.14. The reader should now also look back at the Frobenius theorem 4.4.7 and recognize
the spirit of the Lie transform method in its proof.
♦

5.4 The Lie Derivative: Dynamic Approach
321
We shall next prove a version of the classical Morse lemma in inﬁnite dimensions using the method of Lie
transforms. The proof below is due to Golubitsky and Marsden [1983]; see Palais [1969] and Tromba [1976]
for the original proofs; Palais’ proof is similar in spirit to the one we give.
5.4.8 Lemma (The Morse–Palais–Tromba Lemma).
Let E be a Banach space and ⟨, ⟩a weakly nonde-
generate, continuous, symmetric bilinear form on E. Let h : U →R be Ck, k ≥3, where U is open in E,
and let u0 ∈U satisfy h(u0) = 0, Dh(u0) = 0. Let B = D2h(u0) : E × E →R. Assume that there is a linear
isomorphism T : E →E such that B(u, v) = ⟨Tu, v⟩for all u, v ∈E and that h has a Ck−1 gradient
⟨∇h(y), u⟩= Dh(y) · u.
Then there is a local Ck−2 diﬀeomorphism ϕ of E with ϕ(u0) = u0, Dϕ(u0) = I, and
h(ϕ(x)) = 1
2B(x −u0, x −u0).
Proof.
Symmetry of B implies that T is self-adjoint relative to ⟨, ⟩. Let
f(y) =
1
2
	
B (y −u0, y −u0) ,
h1 = h, and hλ = f + λp, where
p(y) = h(y) −
1
2
	
B (y −u0, y −u0)
is Ck and satisﬁes p(u0) = 0, Dp(u0) = 0, and D2p(u0) = 0. We apply the Lie transform method to hλ.
Thus we have to solve the following equation for a Ck−2 vector ﬁeld Xλ
£Xλhλ + dhλ
dλ = 0,
Xλ(u0) = 0.
(5.4.1)
Then ϕ∗
1h = f, where ϕλ = Fλ,0, for Fλ,µ the evolution operator of Xλ, and hence ϕ = ϕ1 is a Ck−2
diﬀeomorphism of a neighborhood of u0 satisfying ϕ1(u0) = u0. If we can prove that Dϕ1(u0) = I, ϕ1 = ϕ
will be the desired diﬀeomorphism.
To solve equation (5.4.1), diﬀerentiate Dp(x) · e = ⟨∇p(x), e⟩with respect to x and use the symmetry of
the second derivative to conclude that D∇p(x) is symmetric relative to ⟨, ⟩. Therefore,
Dp(x) · e = ⟨∇p(x), e⟩=
 1
0
D∇p(u0 + τ(x −u0)) · (x −u0)dτ, e

= ⟨T(x −u0), R(x) · e⟩
(5.4.2)
where R : U →L(E, E) is the Ck−2 map given by
R(x) = T −1
 1
0
Dp(u0 + τ(x −u0)) · (x −u0) dτ
which satisﬁes R(u0) = 0. Thus p(y) has the expression
p(y) =
 1
0
Dp(u0 + τ(y −u0)) · (y −u0)dτ = −⟨T(y −u0), X(y)⟩
where X : U →E is the Ck−2 vector ﬁeld given by
X(y) = −
 1
0
τR(u0 + τ(y −u0)) · (y −u0) dτ

322
5. Tensors
which satisﬁes X(u0) = 0 and DX(u0) = I. Therefore
(£Xλhλ)(y) = Dhλ(y) · Xλ(y) = B(y −u0, Xλ(y)) + λDp(y) · Xλ(y)
= ⟨T(y −u0), (I + λR(y)) · Xλ(y)⟩
by (equation 5.4.2)
so that the equation (5.4.1) becomes,
⟨T(y −u0), (I + λR(y)) · Xλ(y)⟩= ⟨T(y −u0), X(y)⟩.
Since R(u0) = 0, there exists a neighborhood of u0, such that the norm of λR(y) is < 1 for all λ ∈[0, 1]. Thus
for y in this neighborhood, I + λR(y) can be inverted and we can take Xλ(y) = (I + λR(y))−1X(y) which
is a Ck−2 vector ﬁeld deﬁned for all λ ∈[0, 1] and which satisﬁes Xλ(u0) = 0, DXλ(u0) = 0. Diﬀerentiating
the relation (d/dλ)ϕλ(u) = Xλ(ϕλ(u)) in u at u0 and using ϕλ(u0) = u0 yields
d
dλDϕλ (u0) = DXλ (ϕλ (u0)) ◦Dϕλ (u0) = DXλ (u0) ◦Dϕλ (u0) = 0,
that is Dϕλ(u0) is constant in λ ∈[0, 1]. Since it equals I at λ = 0, it follows that Dϕλ(u0) = I.
■
5.4.9 Lemma (The Classical Morse Lemma).
Let h : U →R be Ck, k ≥3, U open in Rn, and let u ∈U
be a nondegenerate critical point of h, that is h(u) = 0, Dh(u) = 0 and the symmetric bilinear form D2h(u)
on Rn is nondegenerate. Then there is a local Ck−2 diﬀeomorphism ψ of Rn ﬁxing u such that
h (ψ(x)) = 1
2

x1 −u12 + · · · +

0x −un−i2 −

xn−i+1 −un−i+12
−· · · −(xn −un)2
.
Proof.
In Lemma 5.4.8, take ⟨, ⟩to be the dot-product in Rn to ﬁnd a local Ck−2 diﬀeomorphism on Rn
ﬁxing u0 such that
h(ϕ(x)) = (1/2)D2h(u)(x −u, x −u).
Next, apply the Gram–Schmidt procedure to ﬁnd a basis of Rn in which the matrix of D2h(u) is diagonal
with entries ±1 (see Proposition 6.2.9 for a review of the proof of the existence of such a basis). If i is the
number of −1’s (the index), let ϕ be the composition of ψ with the linear isomorphism determined by the
change of an arbitrary basis of Rn to the one above.
■
Exercises
⋄5.4-1.
Verify Theorem 5.4.1 by a coordinate computation as follows. Let Fλ(x) = (y1(λ, x), . . . , yn(λ, x))
so that ∂yi/∂λ = Xi(y) and ∂yi/∂xj satisfy the variational equation
∂
∂λ
∂yi
∂xj = ∂Xi
∂xk
∂yk
∂xj .
Then write
(F ∗
λt)a1...ar
b1...bs = ∂xa1
∂yi1 · · · ∂xar
∂yir
∂yj1
∂xb1 · · · ∂yjs
∂xbs ti1...ir
j1...js.
Diﬀerentiate this in λ at λ = 0 and obtain the coordinate expression (5.3.4) of Section 5.3 for £Xt.
⋄5.4-2.
Carry out the proof outlined in Exercise 5.4-1 for time-dependent vector ﬁelds.
⋄5.4-3.
Starting with Theorem 5.4.1 as the deﬁnition of £Xt, check that £X satisﬁes DO1, DO2 and the
properties (i)–(iv) of Theorem 5.3.2.

5.5 Partitions of Unity
323
⋄5.4-4.
Let C be a contraction operator mapping T r
s (M) to T r−1
s−1 (M). Use both Theorem 5.4.1 and DO1
to show that £X(Ct) = C(£Xt).
⋄5.4-5.
Extend Theorem 5.4.1 to F-valued tensors.
⋄5.4-6.
Let f(y) = (1/2)y2 −y3 + y5. Use the Lie transform method to show that there is a local diﬀeo-
morphism ϕ, deﬁned in a neighborhood of 0 ∈R such that (f ◦ϕ)(x) = x2/2.
⋄5.4-7.
Let E = ℓ2(R), let
⟨x, y⟩=
∞

n=1
1
nxnyn
and
h(x) = 1
2
∞

n=1
1
nx2
n = 1
3
∞

n=1
x3
n.
Show that h vanishes on (0, 0, . . . , 3/2n, 0, . . . ) which →0 as n →∞, so the conclusion of the Morse lemma
fails. What hypothesis in Lemma 5.4.8 fails?
⋄5.4-8 ( Buchner, Marsden, and Schecter [1983b]).
In the notation of Exercise 2.4-15, show that f has a
sequence of critical points approaching 0, so the Morse lemma fails. (The only missing hypothesis is that
∇h is C1.)
5.5
Partitions of Unity
A partition of unity is a technical device that is often used to piece smooth local tensor ﬁelds together to
form a smooth global tensor ﬁeld. Partitions of unity will be useful for studying integration; in this section
they are used to study when a manifold admits a Riemannian metric.
5.5.1 Deﬁnition.
If t is a tensor ﬁeld on a manifold M, the carrier of t is the set of m ∈M for which
t(m) ̸= 0, and is denoted carr(t). The support of t, denoted supp(t), is the closure of carr(t). We say t has
compact support if supp(t) is compact in M. An open set U ⊂M is called a Cr carrier if there exists
an f ∈Fr(M), such that f ≥0 and U = carr(f). A collection of subsets {Cα} of a manifold M (or, more
generally, a topological space) is called locally ﬁnite if for each m ∈M, there is a neighborhood U of m
such that U ∩Cα = ∅except for ﬁnitely many indices α.
5.5.2 Deﬁnition.
A partition of unity on a manifold M is a collection {(Ui, gi)}, where
(i)
{Ui} is a locally ﬁnite open covering of M;
(ii)
gi ∈F(M), gi(m) ≥0 for all m ∈M, and supp(gi) ⊂Ui for all i;
(iii)
for each m ∈M, Σigi(m) = 1. (By (i), this is a ﬁnite sum.)
If A = {(Vα, ϕα)} is an atlas on M, a partition of unity subordinate to A is a partition of unity
{(Ui, gi)} such that each open set Ui is a subset of a chart domain Vα(i). If any atlas A has a subordinate
partition of unity, we say M admits partitions of unity.
Occasionally one works with Ck partitions of unity. They are deﬁned in the same way except gi are only
required to be Ck rather than C∞.
5.5.3 Theorem (Patching Construction).
Let M be a manifold with an atlas A = {(Vα, ϕα)} where ϕα :
Vα →V ′
α ⊂E is a chart. Let tα be a Ck tensor ﬁeld, k ≥1, of ﬁxed type (r, s) deﬁned on V ′
α for each α,
and assume that there exists a partition of unity {(Ui, gi)} subordinate to A. Let t be deﬁned by
t(m) =

i
giϕ∗
α(i)tα(i)(m),
a ﬁnite sum at each m ∈M. Then t is a Ck tensor ﬁeld of type (r, s) on M.

324
5. Tensors
Proof.
Since {Ui} is locally ﬁnite, the sum at every point is a ﬁnite sum, and thus t(m) is a type (r, s)
tensor for every m ∈M. Also, t is Ck since the local representative of t in the chart (Vα(i), ϕα(i)) is
Σj(gi ◦ϕ−1
α(j))tα(j), the summation taken over all indices j such that Vα(i) ∩Vα(j) ̸= ∅; by local ﬁniteness
the number of these j is ﬁnite.
■
Clearly this construction is not unique; it depends on the choices of the indices α(i) such that Ui ⊂Vα(i)
and on the functions gi. As we shall see later, under suitable hypotheses, one can always construct partitions
of unity; again the construction is not unique. The same construction (and proof) can be used to patch
together local sections of a vector bundle into a global section when the base is a manifold admitting
partitions of unity subordinate to any open covering.
To discuss the existence of partitions of unity and consequences thereof, we need some topological pre-
liminaries.
5.5.4 Deﬁnition.
Let S be a topological space. A covering {Uα} of S is called a reﬁnement of a covering
{Vi} if for every Uα there is a Vi such that Uα ⊂Vi. A topological space is called paracompact if every
open covering of S has a locally ﬁnite reﬁnement of open sets, and S is Hausdorﬀ.
5.5.5 Proposition.
Second-countable, locally compact Hausdorﬀspaces are paracompact.
Proof.
By second countability and local compactness of S, there exists a sequence O1, . . . , On, . . . of open
sets with cl(On) compact and 
n∈N On = S. Let Vn = O1 ∪· · · ∪On, n = 1, 2, . . . and put U1 = V1. Since
{Vn} is an open covering of S and cl(U1) is compact,
cl(U1) ⊂Vi1 ∪· · · ∪Vir.
Put
U2 = Vi1 ∪· · · ∪Vir;
then cl(U2) is compact. Proceed inductively to show that S is the countable union of open sets Un such that
cl(Un) is compact and cl(Un) ⊂Un+1. If Wα is a covering of S by open sets, and Kn = cl(Un)\Un−1, then
we can cover Kn by a ﬁnite number of open sets, each of which is contained in some Wα ∩Un+1, and is
disjoint from cl(Un−2). The union of such collections yields the desired reﬁnement of {Wα}.
■
Another class of paracompact spaces are the metrizable spaces (see Lemma 5.5.15 in Supplement 5.5A).
In particular, Banach spaces are paracompact.
5.5.6 Proposition.
Every paracompact space is normal.
Proof.
We ﬁrst show that if A is closed and u ∈S\A, there are disjoint neighborhoods of u and A
(regularity). For each v ∈A, let Uu, Vv be disjoint neighborhoods of u and v. Let Wα be a locally ﬁnite
reﬁnement of the covering { Vv, S\A | v ∈A }, and V =  Wα, the union over those α with Wα ∩A ̸= ∅. A
neighborhood U0 of u meets a ﬁnite number of Wα. Let U denote the intersection of U0 and the corresponding
Uu. Then V and U are the required neighborhoods. The case for two closed sets proceeds somewhat similarly,
so we leave the details for the reader.
■
Later we shall give general theorems on the existence of partitions of unity. However, there is a simple
case that is commonly used, so we present it ﬁrst.
5.5.7 Theorem.
Let M be a second-countable (Hausdorﬀ) n-manifold. Then M admits partitions of
unity.
Proof.
The proof of Proposition 5.5.5 shows the following. Let M be an n-manifold and {Wα} be an open
covering. Then there is a locally ﬁnite reﬁnement consisting of charts (Vi, ϕi) such that ϕi(Vi) is the disk
of radius 3, and such that ϕ−1
i (D1(0)) cover M, where D1(0) is the unit disk, centered at the origin in

5.5 Partitions of Unity
325
the model space. Now let A be an atlas on M and let {(Vi, ϕi)} be a locally ﬁnite reﬁnement with these
properties. From Lemma 4.2.13, there is a nonzero function hi ∈F(M) whose support lies in Vi and hj ≥0.
Let
gi(u) =
hi(u)
Σihi(u)
(the sum is ﬁnite). These are the required functions.
■
If {Vα} is an open covering of M, we can always ﬁnd an atlas A = {(Ui, ϕi)} such that {Ui} is a reﬁnement
of {Vα} since the atlases generate the topology. Thus, if M admits partitions of unity, we can ﬁnd partitions
of unity subordinate to any open covering.
The case of C0-partitions of unity diﬀers drastically from the smooth case. Since we are primarily interested
in this latter case, we summarize the topological situation, without giving the proofs.
1.
If S is a Hausdorﬀspace, the following are equivalent:
(i)
S is normal.
(ii)
(Urysohn’s lemma.) For any two closed nonempty disjoint sets A, B there is a continuous function
f : S →[0, 1] such that f(A) = 0 and f(B) = 1.
(iii)
(Tietze extension theorem.) For any closed set A ⊂S and continuous function g : A →[a, b],
there is a continuous extension G : S →[a, b] of g.
2.
A Hausdorﬀspace is paracompact iﬀit admits a C0 partition of unity subordinate to any open covering.
It is clear that if {(Ui, gi)} is a continuous partition of unity subordinate to the given open covering
{Vα}, then by deﬁnition {Ui} is an open locally ﬁnite reﬁnement. The converse—the existence of partitions
of unity—is the hard part; the proof of this and of the equivalences of (i), (ii), and (iii) can be found for
instance in Kelley [1975] and Choquet [1969, Section 6]. These results are important for the rich supply of
continuous functions they provide. We shall not use these topological theorems in the rest of the book, but
we do want their smooth versions on manifolds.
Note that if M is a manifold admitting partitions of unity subordinate to any open covering, then M is
paracompact, and thus normal by Proposition 5.5.6. This already enables us to generalize (ii) and (iii) to
the smooth (or Ck) situation.
5.5.8 Proposition.
Let M be a manifold admitting smooth (or Ck) partitions of unity. If A and B are
closed disjoint sets then, there exists a smooth (or Ck) function f : M →[0, 1] such that f(A) = 0 and
f(B) = 1.
Proof.
As we saw, the condition on M implies that M is normal and thus there is an atlas {(Uα, ϕα)} such
that Uα ∩A ̸= ∅implies Uα ∩B = ∅. Let {(Vi, gi)} be a subordinate Ck partition on unity and f = Σgi,
where the sum is over those i for which Vi ∩B ̸= ∅. Then f is Ck, is one on B, and zero on A.
■
5.5.9 Theorem (Smooth Tietze Extension Theorem).
Let M be a manifold admitting partitions of unity,
and let π : E →M be a vector bundle with base M. Suppose σ : A →E is a Ck section deﬁned on the closed
set A (i.e., every point a ∈A has a neighborhood Ua and a Ck section σa : Ua →E extending σ). Then σ
can be extended to a Ck global section Σ : M →E. In particular, if g : A →F is a Ck function deﬁned on
the closed set A, where F is a Banach space, then there is a Ck extension G : M →F; if g is bounded by a
constant R, that is, ∥g(a)∥≤R for all a ∈A, then so is G.
Proof.
Consider the open covering { Uα, M\A | a ∈A } of M, with Uα given by the deﬁnition of smooth-
ness on the closed set A. Let {(Ui, gi)} be a Ck partition of unity subordinate to this open covering and
deﬁne σi : Ui →E, by σi = σa|Ui for all Ui and σi ≡0 on all Ui disjoint from Ua, a ∈A. Then giσi : Ui →E

326
5. Tensors
is a Ck section on Ui and since supp(giσi) ⊂supp(gi) ⊂Ui, it can be extended in a Ck manner to M by
putting it equal to zero on M\Ui. Thus giσi : M →E is a Ck-section of π : E →M and hence Σ = Σigiσi
is a Ck section; note that the sum is ﬁnite in a neighborhood of every point m ∈M. Finally, if a ∈A
Σ(a) =

i
gi(a)σi(a) =

i
gi(a)

σ(a) = σ(a),
that is, Σ|A = σ.
The second part of the theorem is a particular case of the one just proved by considering the trivial bundle
M × F →M and the section σ deﬁned by σ(m) = (m, g(m)). The boundedness statement follows from the
given construction, since all the gi have values in [0, 1].
■
Before discussing general questions on the existence of partitions of unity on Banach manifolds, we discuss
the existence of Riemannian metrics. Recall that a Riemannian metric on a Hausdorﬀmanifold M is a
tensor ﬁeld g ∈T 0
2 (M) such that for all m ∈M, g(m) is symmetric and positive deﬁnite. Our goal is
to ﬁnd topological conditions on an n-manifold that are necessary and suﬃcient to ensure the existence
of Riemannian metrics. The proof of the necessary conditions will be simpliﬁed by ﬁrst showing that any
Riemannian manifold is a metric space. For this, deﬁne for m, n ∈M,
d(m, n) = inf{ ℓ(γ) | γ : [0, 1] →M is a continuous piecewise
C1 curve with γ(0) = m, γ(1) = n }.
Here ℓ(γ) is the length of the curve γ, deﬁned by
ℓ(γ) =
 1
0
∥˙γ(t)∥dt,
where ˙γ(t) = dγ/dt is the tangent vector at γ(t) to the curve γ and
∥˙γ∥= [gγ(t)(˙γ(t), ˙γ(t))]1/2
is its length.
5.5.10 Proposition.
d is a metric on each connected component of M whose metric topology is the original
topology of M. If d is a complete metric, M is called a complete Riemannian manifold.
Proof.
Clearly d(m, m) = 0, d(m, n) = d(n, m), and
d(m, p) ≤d(m, n) + d(n, p),
by using the deﬁnition. Next we will verify that d(m, n) > 0 whenever m ̸= n.
Let m ∈U ⊂M where (U, ϕ) is a chart for M and suppose ϕ(U) = U ′ ⊂E. Then for any u ∈U,
g(u)(v, v)1/2, deﬁned for v ∈TuM, is a norm on TuM. This is equivalent to the norm on E, under the
linear isomorphism Tmϕ. Thus, if g′ is the local expression for g, then g′(u′) deﬁnes an inner product on E,
yielding equivalent norms for all u′ ∈U ′. Using continuity of g and choosing U ′ to be an open disk in E, we
can conclude that the norms g′(u′)1/2 and g′(m)1/2, where m′ = ϕ(m) satisfy:
ag′ (m′)1/2 ≤g′ (u′)1/2 ≤bg′ (m′)1/2

5.5 Partitions of Unity
327
for all u′ ∈U ′, where a and b are positive constants. Thus, if η : [0, 1] →U ′ is a continuous piecewise C1
curve, then
ℓ(η) =
 1
0
g′(η(t))( ˙η(t), ˙η(t))1/2dt
≥a
 1
0
g′(m′)( ˙η(t), ˙η(t))1/2dt
≥ag′(m′)
 1
0
˙η(t)dt,
 1
0
˙η(t)dt
	1/2
≥ag′(m′)(η(1) −η(0), η(1) −η(0))1/2.
Here we have used the following property of the Bochner integral:

 b
a
f(t) dt
 ≤
 b
a
∥f(t)∥dt,
valid for any norm on E (see the remarks following Deﬁnition 2.2.7).
Now let γ : [0, 1] →M be a continuous piecewise C1 curve, γ(0) = m, γ(1) = n, m ∈U, where (U, ϕ),
ϕ : U →U ′ ⊂E a chart of M, ϕ(m) = 0. If γ lies entirely in U, then ϕ ◦γ = η lies entirely in U ′ and the
previous estimate gives
ℓ(γ) ≥ag′(m′)(n′, n′)1/2 ≥ar,
where r is the radius of the disk U ′ in E about the origin and, n′ = ϕ(n). If γ is not entirely contained in
U, then let r be the radius of a disk about the origin and let c ∈]0, 1[ be the smallest number for which
γ(c) ∩ϕ−1({ x ∈E | ∥x∥= r }) ̸= ∅. Then
ℓ(γ) ≥ℓ(γ|[0, c]) ≥ag(m′)((ϕ ◦γ)(c), (ϕ ◦γ)(c))1/2 ≥ar.
Thus, we conclude d(m, n) ≥ar > 0.
The equivalence of the original topology of M and of the metric topology deﬁned by d is clear if one
notices that they are equivalent in every chart domain U, which in turn is implied by their equivalence in
ϕ(U).
■
Notice that the preceding proposition holds in inﬁnite dimensions.
5.5.11 Proposition.
A connected Hausdorﬀn-manifold admits a Riemannian metric if and only if it is
second countable. Hence for Hausdorﬀn-manifolds (not necessarily connected) paracompactness and metriz-
ability are equivalent.
Proof.
If M is second countable, it admits partitions of unity by Theorem 5.5.7. Then the patching
construction (Theorem 5.5.3) gives a Riemannian metric on M by choosing in every chart the standard
inner product in Rn.
Conversely, assume M is Riemannian. By Proposition 5.5.10 it is a metric space, which is locally compact
and ﬁrst countable, being locally homeomorphic to Rn. By Theorem 1.6.14, it is second countable.
■
The main theorem on the existence of partitions of unity in the general case is as follows.
5.5.12 Theorem.
Any second-countable or paracompact manifold modeled on a separable Banach space
with a Ck norm away from the origin admits Ck partitions of unity. In particular paracompact (or second
countable) manifolds modeled on separable Hilbert spaces admit C∞partitions of unity.
5.5.13 Corollary.
Paracompact (or second countable) Hausdorﬀmanifolds modeled on separable real
Hilbert spaces admit Riemannian metrics.

328
5. Tensors
Theorem 5.5.12 will be proved in Supplements 5.5A and 5.5B.
There are Hausdorﬀnonparacompact n-manifolds. These manifolds are necessarily nonmetrizable and
do not admit partitions of unity. The standard example of a one-dimensional nonparacompact Hausdorﬀ
manifold is the “long line.” In dimensions 2 and 3 such manifolds are constructed from the Pr¨ufer manifolds.
Since nonparacompact manifolds occur rarely in applications, we refer the reader to Spivak [1979, Volume
1, Appendix A] for the aforementioned examples.
Partitions of unity are an important technical tool in many proofs. We illustrate this with the sample
theorem below which combines diﬀerential topological ideas of §3.5, the local and global existence and
uniqueness theorem for solutions of vector ﬁelds, and partitions of unity. More applications of this sort can
be found in the exercises.
5.5.14 Theorem (Ehresmann Fibration Theorem).
A proper submersion f : M →N of ﬁnite dimen-
sional manifolds with M paracompact is a locally trivial ﬁbration, that is, for any p ∈N there exists an open
neighborhood V of u in N and a diﬀeomorphism ϕ : V × f −1(p) →f −1(V ) such that f(ϕ(x, u)) = x for all
x ∈V and all u ∈f −1(p).
Proof.
Since the statement is local we can replace M, N by chart domains and, in particular, we can
assume that N = Rn and p = 0 ∈Rn. We claim that there are smooth vector ﬁelds X1, . . . , Xn on M such
that Xi is f-related to ∂/∂xi ∈X(Rn). Indeed, around any point in M such vector ﬁelds are easy to obtain
using the implicit function theorem (see Theorem 3.5.2). Cover M with such charts, choose a partition of
unity subordinate to this covering, and patch these vector ﬁelds by means of this partition of unity to obtain
X1, . . . , Xn, f-related to ∂/∂x1, . . . , ∂/∂xn, respectively.
Let F k
t(k) denote the ﬂow of Xk with time variable t(k), k = 1, . . . , n and let t = (t(1), . . . , t(n)) ∈Rn. If
∥t∥< C, then the integral curves of each Xk starting in f −1({ u ∈Rn | ∥u∥≤C }) stay in f −1{ v ∈Rn |
∥v∥≤2C }, since by Proposition 4.2.4
(f ◦F k
t(k))(y) = (f 1(y), . . . , f k(y) + t(k), . . . , f n(y)).
(5.5.1)
Therefore, since f is proper, Proposition 4.1.19 implies that the vector ﬁelds X1, . . . , Xn are complete.
Finally, let ϕ : Rn × f −1(0) →M be given by
ϕ(t(1), . . . , t(n), u) = (F 1
t(1) ◦· · · ◦F n
t(n))(u)
and note that ϕ is smooth (see Proposition 4.1.17). The map ϕ−1 : M →Rn × f −1(0) given by
ϕ−1(m) = (f(m), (F n
−t(n) ◦· · · ◦F 1
−t(1))(m))
is smooth and is easily checked to be the inverse of ϕ. Finally, (f ◦ϕ)(t, u) = t by equation (5.5.1) since
f(u) = 0.
■
Supplement 5.5A
Partitions of Unity: Reduction to the Local Case
We begin with some topological preliminaries. Let S be a paracompact space. If {Uβ} is an open covering
of S, it can be reﬁned to a locally ﬁnite covering {Wβ}. The ﬁrst lemma below will show that we can shrink
this covering further to get another one, {Vα} such that cl(Vα) ⊂Wα with the same indexing set.
A technical device used in the proof is the concept of a well-ordered set. An ordered set A in which
any two elements can be compared is called well-ordered if every subset has a smallest element (see the
introduction to Chapter 1).

5.5 Partitions of Unity
329
5.5.15 Lemma (Shrinking Lemma).
Let S be a normal space and let {Wα}α∈A be a locally ﬁnite open
covering of S. Then there is a locally ﬁnite open reﬁnement {Vα}α∈A (with the same indexing set) such that
cl(Vα) ⊂Wα.
Proof.
Well-order the indexing set A and call its smallest element α(0). The set C0 deﬁned as C0 =
S\ 
α>α(0) Wα is closed, so by normality there exists an open set Vα(0) such that C0 ⊂cl(Vα(0)) ⊂Wα(0).
If Vγ is deﬁned for all γ < α, put
Cα = S\{(

γ<α
Vγ) ∪(

γ>α
Wγ)}
and by normality ﬁnd Vα such that Cα ⊂cl(Vα) ⊂Wα. The collection {Vα}α∈A is the desired locally ﬁnite
reﬁnement of {Wα}α∈A, provided we can show that it covers S. Given s ∈S, by local ﬁniteness of the
covering {Wα}α∈A, s belongs to only a ﬁnite collection of them, say W1, W2, . . . , Wn, corresponding to the
elements α1, . . . , αn of the index set. If β denotes the maximum of the elements α1, . . . , αn, then s ̸∈Wγ for
all γ > β, so that if in addition s ̸∈Vγ for all γ < β, then s ∈Cβ ⊂Vβ, that is, s ∈Vβ.
■
5.5.16 Lemma (A. H. Stone).
Every pseudometric space is paracompact.
Proof.
Let {Uα}α∈A be an open covering of the pseudometric space S with distance function d. Put
Un,α = { x ∈Uα | d(x, S\Uα) ≥1/2n }.
By the triangle inequality, we have the inequality
d(Un,α, S\Un+1,α) ≥1
2n −
1
2n+1 =
1
2n+1 .
Well-order the indexing set A and let Vn,α = Un,α\ 
β<α Un+1,β. If γ, δ ∈A, we have Vn,γ ⊂S\Un+1,δ, if
γ < δ, and Vn,δ ⊂S\Un+1,γ if δ < γ. But in both cases we have d(Vn,γ, Vn,δ) ≥1/2n+1. Deﬁne
Wn,α = { s ∈S | d(s, Vn,α) < 1/2n+3 },
and observe that d(Wn,α, Wn,β) ≥1/2n+2. Thus for a ﬁxed n, every point s ∈S has a neighborhood
intersecting at most one member of the family { Wn,α | α ∈A }. Hence { Wn,α | n ∈N, α ∈A } is a locally
ﬁnite open reﬁnement of {Uα}.
■
Let us now turn to the question of the existence of partitions of unity subordinate to any open covering.
5.5.17 Proposition (R. Palais).
Let M be a paracompact manifold modeled on the Banach space E. The
following are equivalent:
(i)
M admits Ck partitions of unity;
(ii)
any open covering of M admits a locally ﬁnite reﬁnement by Ck carriers;
(iii)
for any open sets O1, O2 such that cl(O1) ⊂O2, there exists a Ck carrier V such that O1 ⊂V ⊂O2;
(iv)
every chart domain of M admits Ck partitions of unity subordinate to any open covering;
(v)
E admits Ck partitions of unity subordinate to any open covering of E.
Proof.
(i) ⇒(ii).
If {(Ui, gi)} is a Ck-partition of unity subordinate to an open covering, then clearly
carr gi forms a locally ﬁnite reﬁnement of the covering by Ck carriers.
(ii) ⇒(iii).
Let {Vα}α∈A be a locally ﬁnite reﬁnement of the open covering {O2, S\cl(O1)} by Ck carriers
and denote by fα ∈Fk(M), the function for which carr fα = Vα. Let
B = { α ∈A | Vα ⊂O2 }.

330
5. Tensors
Put V = 
β∈B Vβ, f = Σβ∈Bfβ and notice that O1 ⊂V ⊂O2, carr(f) = V .
(iii) ⇒(iv). Let U be any chart domain of M. Then U is diﬀeomorphic to an open set in E which is a metric
space, so is paracompact by Stone’s theorem (Lemma 5.5.16). Let {Uα} be an arbitrary open covering of U
and {Vβ} be a locally ﬁnite reﬁnement. By the shrinking lemma we may assume that cl(Vβ) ⊂U. Again by
the shrinking lemma, reﬁne further to a locally ﬁnite covering {Wβ} such that cl(Wβ) ⊂Vβ. But by (iii)
there exists a Ck-carrier Oβ such that Wβ ⊂Oβ ⊂Vβ, and so {Oβ} is a locally ﬁnite reﬁnement of {Uα} by
Ck-carriers, whose corresponding functions we denote by fβ. Thus f = Σβfβ is a Ck map and {(Vβ, fβ/f)}
is a Ck partition of unity subordinate to {Uα}.
(iv) ⇒(v). Consider now any open covering {Uα}α∈A of E and let (U, ϕ) be an arbitrary chart of M. Reﬁne
ﬁrst the covering of E by taking the intersections of all its elements with all translates of ϕ(U). Since E is
paracompact, reﬁne again to a locally ﬁnite open covering {Vβ}. The inverse images by translations and ϕ
of these open sets are subsets of U, hence chart domains, and thus by (iv) they admit partitions of unity
subordinate to any covering. Thus every Vβ admits a Ck partition of unity subordinate to any open covering,
for example to { Vβ ∩Uα | α ∈A }; call it {gβ
i }. Then g = Σi,βgβ
i is a Ck map and the double-indexed set
of functions gβ
i /g forms a Ck partition of unity of E.
(v) ⇒(iv).
If E admits Ck partitions of unity subordinate to any open covering, then so does every open
subset by the (already proved) implication (i) ⇒(ii) applied to M = E, which is paracompact by Theorem
5.5.16. Thus if (U, ϕ) is a chart on M, U admits partitions of unity, since ϕ(U) does.
Finally, we show (iv) implies (i) . Choosing a locally ﬁnite atlas, this proof repeats the one given in the last
part of (iv) ⇒(v).
■
As an application of this proposition we get the following.
5.5.18 Proposition.
Every paracompact n-manifold admits C∞-partition of unity.
Proof.
By Proposition 5.5.17(ii) and (v) it suﬃces to show that every open set in Rn is a C∞carrier. Any
open set U is a countable union of open disks Di. By Lemma 4.2.13, Di = carr (fi), for some C∞function
fi : Rn →R. Put
Mi = sup{ ∥Dkfi(x)∥| x ∈Rn, k ≤i }
and let
f =
∞

i=1
fi
2iMi
.
By Exercise 2.4-10, f is a C∞function for which carr(f) = U clearly holds.
■
In particular, second-countable n-manifolds admit partitions of unity, recovering Theorem 5.5.7.
Supplement 5.5B
Partitions of Unity: The Local Case
Proposition 5.5.17 reduces the problem of the existence of partitions of unity to the local one, namely
ﬁnding partitions of unity in Banach spaces. This problem has been studied by Bonic and Frampton [1966]
for separable Banach spaces.

5.5 Partitions of Unity
331
5.5.19 Proposition ( Bonic and Frampton [1966]).
Let E be a separable Banach space. The following are
equivalent.
(i)
Any open set of E is a Ck carrier.
(ii)
E admits Ck partitions of unity subordinate to any open covering of E.
(iii)
There exists a bounded nonempty Ck carrier in E.
Proof.
By Proposition 5.5.17, (i) and (ii) are equivalent since E is paracompact by Lemma 5.5.16. It
remains to be shown that (iii) implies (i), since clearly (ii) implies (iii).
This proceeds in several steps. First, we show that any neighborhood contains a Ck carrier. Let U be any
open set and let carr(f) ⊂Dr(0) be the bounded carrier given by (iii), f ∈Ck(E), f ≥0. Let e ∈U, ﬁx
e0 ∈carr(f), and choose ε > 0 such that Dε(e) ⊂U. Deﬁne g ∈Ck(E), g ≥0 by
g(v) = f(K(v −e) + e0),
K > 0,
where K remains to be determined from the condition that carr(g) ⊂Dε(e). An easy computation shows
that if K > (r + ∥e0∥)/ε, this inclusion is veriﬁed. Since e ∈carr(g), carr(g) is an open neighborhood of e.
Second, we show that any open set can be covered by a countable locally ﬁnite family of Ck carriers.
By the ﬁrst step, the open set U can be covered by a family of Ck carriers. By Lindel¨of’s lemma 1.1.6,
U = 
n Vn where Vn is a Ck carrier, the union being over the positive integers. We need to ﬁnd a reﬁnement
of this covering by Ck carriers. Let fn ∈Ck(E) be such that carr fn = Vn. Deﬁne
Un = { e ∈E | fn(e) > 0, fi(e) < 1/n for all i < n }.
Clearly U1 = V1 and inductively
Un = Vn ∩

i<n
f −1
i
(]−∞, 1/n[)

.
By the composite mapping theorem, the inverse image of a Ck carrier is a Ck carrier, so that f −1
i
(]−∞, 1/n[)
is a Ck carrier, since ]∞, 1/n[ is a Ck carrier in R (see the proof of Proposition 5.5.18). Finite intersections
of Ck carriers is a Ck carrier (just take the product of the functions in question) so that Un is also a Ck
carrier. Clearly Un ⊂Vn. We shall prove that {Un} is a locally ﬁnite open covering of U. Let e ∈U. If e ∈Vn
for all n, then clearly e ∈U1 = V1. If not, then there exists a smallest n, say N, such that e ∈VN. Then
fi(e) = 0 for i < N and thus
e ∈UN = { e ∈E | fN(e) > 0, fi(e) < 1/N for all i < N }.
Thus, the sets Un cover U. This open covering is also locally ﬁnite for if e ∈Vn and N is such that f(e) > 1/N,
then the neighborhood { u ∈U | fn(e) > 1/N } has empty intersections with all Um for m > N.
Third we show that the open set U is a Ck-carrier. By the second step, U = 
n Un, with Un a locally
ﬁnite open covering of U by Ck carriers. Then f = Σnfn is Ck, f(e) ≥0 for all e ∈E and carr(f) = U.
■
The separability assumption was used only in showing that (iii) implies (i). There is no general theorem
known to us for nonseparable Banach spaces. Also, it is not known in general whether Banach spaces admit
bounded Ck carriers, for k ≥1. However, we have the following.
5.5.20 Proposition.
If the Banach space E has a norm Ck away from its origin, k ≥1, then E has
bounded Ck-carriers.
Proof.
By Corollary 4.2.14 there exists ϕ : R →R, C∞with compact support and equal to one in a
neighborhood of the origin. If ∥· ∥: E\{0} →R is Ck, k ≥1, then ϕ ◦∥· ∥: E\{0} →R is a nonzero map
which is Ck, has bounded support ∥· ∥−1(supp ϕ), and can be extended in a Ck manner to E.
■

332
5. Tensors
Theorem 5.5.12 now follows from Propositions 5.5.20, 5.5.19, and 5.5.17.
The situation with regard to Banach subspaces and submanifolds is clariﬁed in the following proposition,
whose proof is an immediate consequence of Propositions 5.5.19 and 5.5.17.
5.5.21 Proposition.
(i)
If E is a Banach space admitting Ck partitions of unity then so does any closed subspace,
(ii)
If a manifold admits Ck partitions of unity subordinate to any open covering, then so does any sub-
manifold.
We shall not develop this discussion of partitions of unity on Banach manifolds any further, but we shall
end by quoting a few theorems that show how intimately connected partitions of unity are with the topology
of the model space. By Propositions 5.5.19 and 5.5.20, for separable Banach spaces one is interested whether
the norm is Ck away from the origin. Restrepo [1964] has shown that a separable Banach space has a C1
norm away from the origin if and only if its dual is separable. Bonic and Reis [1966] and Sundaresan [1967]
have shown that if the norms on E and E∗are diﬀerentiable on E\{0} and E∗\{0}, respectively, then E is
reﬂexive, for E a real Banach space (not necessarily separable). Moreover, E is a Hilbert space if and only if
the norms on E and E∗are twice diﬀerentiable away from the origin. This result has been strengthened by
Leonard and Sunderesan [1973], who show that a real Banach space is isometric to a Hilbert space if and
only if the norm is C2 away from the origin and the second derivative of e →∥e∥2/2 is bounded by 1 on
the unit sphere; see Rao [1972] for a related result. Palais [1965b] has shown that any paracompact Banach
manifold admits Lipschitz partitions of unity.
Because of the importance of the diﬀerentiability class of the norm in Banach spaces there has been
considerable work in the direction of determining the exact diﬀerentiability class of concrete function spaces.
Thus Bonic and Frampton [1966] have shown that the canonical norms on the spaces Lp(R), ℓp(R), p ≥1,
p < ∞are C∞away from the origin if p is even, Cp−1 with D(∥· ∥p−1) Lipschitz, if p is odd, and C[p]
with D[p](∥· ∥p) H¨older continuous of order p −[p], if p is not an integer. The space c0 of sequences of real
numbers convergent to zero has an equivalent norm that is C∞away from the origin, a result due to Kuiper.
Using this result, Frampton and Tromba [1972] show that the Λ-spaces (closures of C∞in the H¨older norm)
admit a C∞norm away from the origin. The standard norm on the Banach space of continuous real valued
functions on [0, 1] is nowhere diﬀerentiable. Moreover, since C0([0, 1], R) is separable with nonseparable dual,
it is impossible to ﬁnd an equivalent norm that is diﬀerentiable away from the origin. To our knowledge it
is still an open problem whether C0([0, 1], R) admits C∞partitions of unity for k ≥1.
Finally, the only results known to us for nonseparable Hilbert spaces are those of Wells [1971, 1973], who
has proved that nonseparable Hilbert space admits C2 partitions of unity. The techniques used in the proof,
however, do not seem to indicate a general way to approach this problem.
Supplement 5.5C
Simple Connectivity of Fiber Bundles
The goal of this supplement is to discuss the homotopy lifting property for locally trivial continuous ﬁber
bundles over a paracompact base. This theorem is shown to imply an important criterion on the simple
connectedness of the total space of ﬁber bundles with paracompact base.
5.5.22 Theorem (Homotopy Lifting Theorem).
Let π : E →B be a locally trivial C0 ﬁber bundle and
let M be a paracompact topological space. If h : [0, 1] × M →B is a continuous homotopy and f : M →E
is any continuous map satisfying π ◦f = h(0, ·), there exists a continuous homotopy H : [0, 1] × M →E

5.5 Partitions of Unity
333
satisfying π ◦H = h and H(0, ·) = f. If in addition, h ﬁxes some point m ∈M, that is h(t, m) is constant
for t in a segment ∆of [0, 1], then H(t, m) is also constant for t ∈∆.
Remark.
The property in the statement of the theorem is called the homotopy lifting property. A
Hurewicz ﬁbration is a continuous surjective map π : E →B satisfying the homotopy lifting property
relative to any topological space M. Thus the theorem above says that a locally trivial C0 ﬁber bundle is a
Hurewicz ﬁbration relative to paracompact spaces.
♦
See Steenrod [1957] and Huebsch [1955] for the proof.
5.5.23 Corollary.
Let π : E →B be a C0 locally trivial ﬁber bundle. If the base B and the ﬁber F are
simply connected, then E is simply connected.
Proof.
Let c : [0, 1] →E be a loop, c(0) = c(1) = e0. Then d = π ◦c is a loop in B based at π(e0) = b0.
Since B is simply connected there is a homotopy h : [0, 1] × [0, 1] →B such that h(0, t) = d(t), h(1, t) = b0
for all t ∈[0, 1], and h(s, 0) = h(s, 1) = b0 for all s ∈[0, 1]. By the homotopy lifting theorem there is a
homotopy H : [0, 1] × [0, 1] →E such that π ◦H = h, H(0, ·) = c, and
H(s, 0) = H(0, 0) = c(0) = e0,
H(s, 1) = c(1) = e0.
Since (π ◦H)(1, t) = h(1, t) = b0, it follows that t →H(1, t) is a path in π−1(b0) starting at H(1, 0) = e0 and
ending also at H(1, 1) = e0. Since π−1(b0) is simply connected, there is a homotopy k : [1, 2]×[0, 1] →π−1(b0)
such that
k(1, t) = H(1, t),
k(2, t) = e0
for all t ∈[0, 1] and
k(s, 0) = k(s, 1) = e0
for all s ∈[1, 2]. Deﬁne the continuous homotopy K : [0, 2] × [0, 1] →E by
K(s, t) =

H(s, t),
if s ∈[0, 1];
k(s, t),
if s ∈[1, 2],
and note that
K(0, t) = H(0, t) = c(t),
K(2, t) = k(2, t) = e0
for any t ∈[0, 1], and K(s, 1) = e0 for any s ∈[0, 2]. Thus, c is contractible to e0 and E is therefore simply
connected.
■
Exercises
⋄5.5-1 (Whitney).
Show that any closed set F in Rn is the inverse image of 0 by a C∞real-valued positive
function on Rn. Generalize this to any n-manifold.
Hint: Cover Rn\F with a sequence of open disks Dn and choose for each n a smooth function χn ≥0,
satisfying χn|Dn > 0, with the absolute value of χn and all its derivatives ≤2n. Set χ = Σn≥0χn.
⋄5.5-2.
In a paracompact topological space, an open subset need not be paracompact. Prove the following.

334
5. Tensors
(i)
If every open subset of a paracompact space is paracompact, then any subspace is paracompact.
(ii)
Every open submanifold of a paracompact manifold is paracompact.
Hint: Use chart domains to conclude metrizability.
⋄5.5-3.
Let π : E →M be a vector bundle, E′ ⊂E a subbundle and assume M admits Ck partitions of
unity subordinate to any open covering. Show that E′ splits in E, that is, there exists a subbundle E′′ such
that E = E′′ ⊕E′′.
Hint: The result is trivial for local bundles. Construct for every element of a locally ﬁnite covering {Ui} a
vector bundle map fi whose kernel is the complement of E′|Ui. For {(Ui, gi)} a Ck partition of unity, put
f = Σigifi and show that E = E′ ⊕ker f.
⋄5.5-4.
Let π : E →M be a vector bundle over the base M that admits Ck partitions of unity and with
the ﬁbers of E modeled on a Hilbert space. Show that E admits a Ck bundle metric, that is, a Ck map
g : M →T 0
2 (E) that is symmetric, strongly nondegenerate, and positive deﬁnite at every point m ∈M.
⋄5.5-5.
Let E →M be a line bundle over the manifold M admitting Ck partitions of unity sub-ordinate
to any open covering. Show that E × E is trivial
Hint: E × E = L(E∗, E) and construct a local base that can be extended.
⋄5.5-6.
Assume M admits Ck partitions of unity. Show that any submanifold of M diﬀeomorphic to S1 is
the integral curve of a Ck vector ﬁeld on M.
⋄5.5-7.
Let M be a connected paracompact manifold. Show that there exists a C∞proper mapping f :
M →Rk.
Hint: M is second countable, being Riemannian. Show the statement for k = 1, where f = Σi≥1iϕi, and
{ϕi} is a countable partition of unity.
⋄5.5-8.
Let M be a connected paracompact n-manifold and X ∈X(M). Show that there exist h ∈
F(M), h > 0 such that Y = hX is complete.
Hint: With f as in Exercise 5.5-7 put h = exp{−(X[f])2} so that |Y [f]| ≤1. Hence (f ◦c)(]a, b[) is bounded
for any integral curve c of Y and ]a, b[ in the domain of c.
⋄5.5-9.
Let M be a paracompact, non-compact manifold.
(i)
Show that there exists a locally ﬁnite sequence of open sets { Ui | i ∈Z } such that Ui ∩Ui+1 ̸= ∅
unless j = i −1, i, i + 1, and each Ui is a chart domain diﬀeomorphic (by the chart map ϕi) with the
open unit ball in the model space of M. See Figure 5.5.1.
Hint: Let V be a locally ﬁnite open cover of M with chart domains diﬀeomorphic by their chart maps
to the open unit ball such that no ﬁnite subcover of V covers M, and no two elements of V include
each other. Let U0, U1 be distinct elements of V, U0 ∩U1 ̸= ∅. Let U−1 ∈V be such that U−1 ∩U0 ̸= ∅;
U−1 ∩U1 = ∅; such a U−1 exists by local ﬁniteness of V. Now use induction.
Figure 5.5.1. A chart chain
(ii)
Use (i) to show that there exists an embedding of R in M as a closed manifold.

5.5 Partitions of Unity
335
Hint: Let c0 be a smooth curve in U0 diﬀeomorphic by ϕ0 to ]−1, 1[ connecting a point in U−1 ∩U0
to a point in U0 ∩U1. Next, extend c0 ∩U1 smoothly to a curve c1, diﬀeomorphic by ϕ1 to ]0, 2[ ending
inside U1 ∩U2; show that c1 ∩U0 extends the curve c0 ∩U1 inside U0 ∩U1. Now use induction.
(iii)
Show that on each non-compact paracompact manifold admitting partitions of unity there exists a
non-complete vector ﬁeld.
Hint: Embed R in M by (ii) and on R consider the vector ﬁeld ˙x = x2. Extend it to M via partitions
of unity.
⋄5.5-10.
Show that every compact n-manifold embeds in some Rk for k big enough in the following way. If
{(Ui, ϕi)}i=1,...,N is a ﬁnite atlas with ϕi(Ui) the ball of radius 2 in Rn, let χ ∈C∞(Rn), χ = 1 on the ball
of radius 1 and χ = 0 outside the ball of radius 2. Put fi = (χ ◦ϕi) · ϕi : M →Rn, where fi = 0 outside Ui.
Show that fi is C∞and that ψ : M →RNn × RN, deﬁned by
ψ(m) = (f1(m), . . . , fN(m), χ(ϕ1(m)), . . . , χ(ϕN(m)))
is an embedding.
⋄5.5-11.
Let g be a Riemannian metric on M.
(i)
Show that if N is a submanifold, its g-normal bundle νg(N) = { v ∈TnM | n ∈N, v ⊥TnN } is a
subbundle of TM.
(ii)
Show that TM|N = νg(N) ⊕TN.
(iii)
If h is another Riemannian metric on M, show that νg(N) is a vector bundle isomorphic to νh(N).
⋄5.5-12.
Show that if f : M →N is a proper surjective submersion with M paracompact and N connected,
then it is a locally trivial ﬁber bundle.
Hint: To show that all ﬁbers are diﬀeomorphic, connect a ﬁxed point of N with any other point by a smooth
path and cover the path with the neighborhoods in N given by Theorem 5.5.14.

Page 337
6
Diﬀerential Forms
Diﬀerential k-forms are tensor ﬁelds of type (0, k) that are completely antisymmetric. Such tensor ﬁelds arise
in many applications in physics, engineering, and mathematics. A hint at why this is so is the fact that the
classical operations of grad, div, and curl and the theorems of Green, Gauss, and Stokes can all be expressed
concisely in terms of diﬀerential forms and an operator on diﬀerential forms to be studied in this chapter,
the exterior derivative d. However, identities like ∇× (∇f) = 0 and ∇· (∇× X) = 0 are elegantly phrased
as the single identity d2 = 0. However, the examples of Hamiltonian mechanics and Maxwell’s equations
(see Chapter 8) show that their applicability goes well beyond this.
The goal of the chapter is to develop the calculus of diﬀerential forms, due largely to Cartan [1945]. The
exterior derivative operator d plays a central role; its properties and the expression of the Lie derivative in
terms of it will be developed.
6.1
Exterior Algebra
We begin with the exterior algebra of a vector space and extend this ﬁberwise to a vector bundle. As with
tensor ﬁelds, the most important case is the tangent bundle of a manifold, which is considered in the next
section.
We ﬁrst recall a few facts about the permutation group on k elements; some of these facts have already been
discussed in §2.2. Proofs of the results that we cite are obtainable from virtually any elementary algebra book.
The permutation group on k elements, denoted Sk, consists of all bijections σ : {1, . . . , k} →{1, . . . , k}
usually given in the form of a table

1
· · ·
k
σ(1)
· · ·
σ(k)

,
together with the structure of a group under composition of maps. Clearly, Sk has order k!. Letting {−1, 1}
have its natural multiplicative group structure, there is a homomorphism denoted sign : Sk →{−1, 1}; that
is, for σ, τ ∈Sk, sign(σ ◦τ) = (sign σ)(sign τ). A permutation σ is called even when sign σ = +1 and odd
when sign σ = −1. This homomorphism can be described as follows. A transposition is a permutation that
swaps two elements of {1, . . . , k}, leaving the remainder ﬁxed. An even (odd) permutation can be written as
the product of an even (odd) number of transpositions. The expression of σ as a product of transpositions
is not unique, but the number of transpositions is always even or odd corresponding to σ being even or odd.

338
6. Diﬀerential Forms
If E and F are Banach spaces, an element of T 0
k (E, F) = Lk(E; F); that is, a k-multilinear continuous
mapping of E × · · · × E →F is called skew symmetric when
t(e1, . . . , ek) = (sign σ) t(eσ(1), . . . , eσ(k))
for all e1, . . . , ek ∈E and σ ∈Sk. This is equivalent to saying that t(e1, . . . , ek) changes sign when any two
of e1, . . . , ek are swapped. The subspace of skew symmetric elements of Lk(E; F) is denoted Lk
a(E; F) (the
subscript a stands for “alternating”). Some additional shorthand will be useful. Namely, let 0(E, F) = F,
1(E, F) = L(E, F) and in general, k(E, F) = Lk
a(E; F), be the vector space of skew symmetric F-valued
multilinear maps or exterior F-valued k-forms on E. If F = R, we write 0(E) = R, 1(E) = E∗and
k(E) = Lk
a(E; R); elements of k(E) are called exterior k-forms. Some authors write k(E∗) where we
write k(E).
To form elements of k(E, F) from elements of T 0
k (E; F), we can skew-symmetrize the latter. For example,
if t ∈T 0
2 (E), the two tensor At deﬁned by
(At) (e1, e2) = 1
2 [t (e1, e2) −t (e2, e1)]
is skew symmetric and if t is already skew, At coincides with t. More generally, we make the following
deﬁnition.
6.1.1 Deﬁnition.
The alternation mapping A : T 0
k (E, F) →T 0
k (E, F) (for notational simplicity we do
not index the A with E, F or k) is deﬁned by
At(e1, . . . , ek) = 1
k!

σ∈Sk
(sign σ) t(eσ(1), . . . , eσ(k)),
where the sum is over all k! elements of Sk.
6.1.2 Proposition.
A is a linear mapping onto k(E, F), A| k(E, F) is the identity, and A ◦A = A.
Proof.
Linearity of A is clear from the deﬁnition. If t ∈k(E, F), then
At(e1, . . . , ek) = 1
k!

σ∈Sk
(sign σ) t(eσ(1), . . . , eσ(k))
= 1
k!

σ∈Sk
t(e1, . . . , ek) = t(e1, . . . , ek)
since Sk has order k!. This proves the ﬁrst two assertions, and the last follows from them.
■
From A = A ◦A, it follows that ∥A∥≤∥A∥2, and so, as A ̸= 0, ∥A∥≥1. From the deﬁnition of A, we
see ∥A∥≤1; thus ∥A∥= 1. In particular, A is continuous.
6.1.3 Deﬁnition.
If α ∈T 0
k (E) and β ∈T 0
l (E), deﬁne their wedge product α ∧β ∈k+l(E) by
α ∧β = (k + l)!
k!l!
A(α ⊗β).
For F-valued forms, we can also deﬁne ∧, where ⊗is taken with respect to a given bilinear form B ∈
L(F1, F2; F3). Since A and ⊗are continuous, so is ∧. There are several possible conventions for deﬁning
the wedge product ∧. The one here conforms to Spivak [1979], and Bourbaki [1971] but not to Kobayashi
and Nomizu [1963] or Guillemin and Pollack [1974]. See Exercise 6.1-7 for the possible conventions. Our
deﬁnition of α ∧β is the one that eliminates the largest number of constants encountered later.

6.1 Exterior Algebra
339
A (k, l)-shuﬄe is a permutation σ of {1, 2, . . . , k + l} such that
σ(1) < · · · < σ(k)
and
σ(k + 1) < · · · < σ(k + l).
The reason for the name “shuﬄes” is that these are the kind of permutations made when a deck of k + l
cards is shuﬄed, with k cards held in one hand and l in the other.
The reader should prove that for α a k-form and β an l-form, we have
(α ∧β)(e1, . . . , ek+l)
=

(sign σ)α(eσ(1), . . . , eσ(k))β(eσ(k+1), . . . , eσ(k+l))
(6.1.1)
where the sum is over all (k, l) shuﬄes σ. Formula (6.1.1) is a convenient way to compute wedge products,
as we see in the following examples.
6.1.4 Examples.
A.
If α is a two-form and β is a one-form, then
(α ∧β)(e1, e2, e3) = α(e1, e2)β(e3) −α(e1, e3)β(e2) + α(e2, e3)β(e1)
Indeed the only (2, 1) shuﬄes in S3 are

1
2
3
1
2
3

,

1
2
3
1
3
2

,
and

1
2
3
2
3
1

,
of which only the second one has sign −1.
B.
If α and β are one-forms, then
(α ∧β)(e1, e2) = α(e1)β(e2) −α(e2)β(e1)
since S2 consists of two (1, 1) shuﬄes.
♦
6.1.5 Proposition.
For α ∈T 0
k (E), β ∈T 0
l (E), and γ ∈T 0
m(E), we have
(i) α ∧β = Aα ∧β = α ∧Aβ;
(ii) ∧is bilinear;
(iii) α ∧β = (−1)klβ ∧α;
(iv) α ∧(β ∧γ) = (α ∧β) ∧γ = (k + l + m)!
k!l!m!
A(α ⊗β ⊗γ).
Proof.
For (i), ﬁrst note that if σ ∈Sk and we deﬁne
σt (e1, . . . , ek) = t

eσ(1), . . . , eσ(k)

,
then A(σt) = (sign σ)At, because
A(σt)(e1, . . . , ek) = 1
k!

ρ∈Sk
(sign ρ) t(eρσ(1), . . . , eρσ(k))
= 1
k!

ρ∈Sk
(sign σ)(sign ρσ) t(eρσ(1), . . . , eρσ(k))
= (sign σ)At(e1, . . . , ek)

340
6. Diﬀerential Forms
since ρ →ρσ is a bijection. Therefore, since
At = 1
k!

σ∈Sk
(sign σ)σt,
we get
A(Aα ⊗β) = A

1
k!

τ∈Sk
(sign τ)(τα ⊗β)
	
= 1
k!

τ∈Sk
(sign τ)A(τα ⊗β)
(by linearity of A)
= 1
k!

τ∈Sk
(sign τ ′)Aτ ′(α ⊗β),
where τ ′ ∈Sk+l is deﬁned by
τ ′(1, . . . , k, . . . , k + l) = (τ(1), . . . , τ(k), k + 1, . . . , k + l),
so sign τ = sign τ ′ and τα ⊗β = τ ′(α ⊗β). Thus the preceding expression for A(Aα ⊗β) becomes
1
k!

τ∈Sk
(sign τ ′)(sign τ ′)A(α ⊗β) = A(α ⊗β) 1
k!

τ∈Sk
1 = A(α ⊗β).
Thus, A(Aα ⊗β) = A(α ⊗β) which is equivalent to (Aα) ∧β = α ∧β. The other equality in (i) is similar.
(ii) is clear since ⊗is bilinear and A is linear.
For (iii), let σ0 ∈Sk+l be given by
σ0 (1, . . . , k + l) = (k + 1, . . . ., k + l, 1, . . . , k) .
Then
(α ⊗β) (e1, . . . , ek+l) = (β ⊗α)

eσ0(1), . . . , eσ0(k+l)

.
Hence, by the proof of (i), A(α ⊗β) = (sign σ0)A(β ⊗α). But sign σ0 = (−1)kl. Finally, for (iv),
α ∧(β ∧γ) = (k + l + m)!
k!(l + m)! A(α ⊗(β ∧γ))
= (k + l + m)!
k!(l + m)!
(l + m)!
l!m!
A(α ⊗A(β ⊗γ))
= (k + l + m)!
k!l!m!
A(α ⊗β ⊗γ)
since A(α ⊗Aβ) = A(α ⊗β), which was proved in (i), and by associativity of ⊗. We calculate (α ∧β) ∧γ
in the same way.
■
Conclusions (i)–(iii) hold (with identical proofs) for F-valued forms when the wedge product is taken with
respect to a given bilinear mapping B. Associativity can also be generalized under suitable assumptions on
the bilinear mappings, such as requiring F to be an associative algebra under B. Because of associativity,
α ∧β ∧γ can be written with no ambiguity.

6.1 Exterior Algebra
341
6.1.6 Examples.
A.
If αi, i = 1, . . . , k are one-forms, then

α1 ∧· · · ∧αk
(e1, . . . , ek) =

σ
(sign σ) α1 
eα(1)

· · · αk 
eα(k)

= det

αi (ej)

.
Indeed, repeated application of Proposition 6.1.5(iv) gives
γ1 ∧· · · ∧γk = (d1 + · · · + dk)!
d1! · · · dk!
A(γ1 ⊗· · · ⊗γk),
(6.1.2)
where γi is a di-form on E. In particular, if αi is a one form, equation 6.1.2 gives
α1 ∧· · · ∧αk = k!A(α1 ⊗· · · ⊗αk),
(6.1.2’)
which yields the stated formula after using the deﬁnition of A. If e1, . . . , en and e1, . . . , en are dual bases,
observe that as a special case,

e1 ∧· · · ∧ek
(e1, . . . , ek) = 1.
B.
If at least one or α or β is of even degree, then Proposition 6.1.5(iii) says that α ∧β = β ∧α. If both
are of odd degree, then α ∧β = −β ∧α. Thus, if α is a one-form, then α ∧α = 0. But if α is a two-form,
then in general α ∧α ̸= 0. For example, if α = e1 ∧e2 + e3 ∧e4 ∈2 
R4
where e1, e2, e3, e4 is the standard
dual basis of R4, then α ∧α = 2e1 ∧e2 ∧e3 ∧e4 ̸= 0.
C.
The properties listed in Proposition 6.1.5 make the computations of wedge products similar to poly-
nomial multiplication, care being taken with commutativity. For example, if α1, . . . , α5 are one forms on
R5,
α = 2α1 ∧α3 + α2 ∧α3 −3α3 ∧α4 ∈2 
R5
and
β = −α1 ∧α2 ∧α5 + 2α1 ∧α3 ∧α4 ∈3 
R5
,
then the wedge product α ∧β is computed using the bilinearity and commutation properties of ∧:
α ∧β = −2(α1 ∧α3) ∧(α1 ∧α2 ∧α5) −(α2 ∧α3) ∧(α1 ∧α2 ∧α5)
+ 3(α3 ∧α4) ∧(α1 ∧α2 ∧α5) + 4(α1 ∧α3) ∧(α1 ∧α3 ∧α4)
+ 2(α2 ∧α3) ∧(α1 ∧α3 ∧α4) −6(α3 ∧α4) ∧(α1 ∧α3 ∧α4)
= 3α3 ∧α4 ∧α1 ∧α2 ∧α5 = 3α1 ∧α2 ∧α3 ∧α4 ∧α5.
♦
To express the wedge product in coordinate notation, suppose E is ﬁnite dimensional with basis e1, . . . , en.
The components of t ∈T 0
k (E) are the real numbers
ti1···ik = t(ei1, . . . , eik),
1 ≤i1, . . . , ik ≤n.
(6.1.3)

342
6. Diﬀerential Forms
For t ∈k (E), equation (6.1.3) is antisymmetric in its indices i1, . . . , ik. For example, t ∈2(E) yields tij,
a skew symmetric n × n matrix. From Deﬁnition 6.1.1 of the alternation mapping and equation 6.1.3, we
have
(At)i1...ik = 1
k!

σ∈Sk
(sign σ)tσ(i1)···σ(ik);
that is, At antisymmetrizes the components of t. For example, if t ∈T 0
2 (E), then
(At)ij = tij −tji
2
.
If α ∈k(E) and β ∈l(E), then equations (6.1.1) and (6.1.3) yield
(α ∧β)i1···ik+l =

(sign σ)ασ(i1)...σ(ik)βσ(ik+1)...σ(ik+l)
where the sum is over all the (k, l)-shuﬄes in Sk+l.
6.1.7 Deﬁnition.
The direct sum of the spaces k(E) (i = 0, 1, 2, . . . ) together with its structure of real
vector space and multiplication induced by ∧, is called the exterior algebra of E, or the Grassmann
algebra of E. It is denoted by (E).
Thus (E) is a graded associative algebra, that is, an algebra in which every element has a degree (a
k-form has degree k), and the degree map is additive on products (by Proposition 6.1.2 and Deﬁnition 6.1.3).
Elements of (E) may be written as ﬁnite sums of increasing degree exactly as one writes a polynomial as
a sum of monomials. Thus if a, b, c ∈R, α ∈1(E) and β ∈2(E) then a + bα + cβ makes sense in (E).
The one-form α can be understood as an element of 1(E) and also of (E), where α is identiﬁed with
0 + α + 0 + 0 + · · · .
6.1.8 Proposition.
Suppose E is ﬁnite dimensional and n = dim E. Then for k > n, k (E) = {0},
while for 0 < k ≤n, k (E) has dimension n!/(n −k)!k!. The exterior algebra over E has dimension 2n. If
{e1, . . . , en} is an (ordered) basis of E and {e1, . . . , en} its dual basis, a basis of k (E) is

ei1 ∧· · · ∧eik | 1 ≤i1 < ik < · · · < ik ≤n

.
(6.1.4)
Proof.
First we show that the indicated wedge products span k(E). If α ∈k(E), then from Proposition
5.1.2,
α = α(ei1, . . . , eik)ei1 ⊗· · · ⊗eik,
where the summation convention indicates that this should be summed over all choices of i1, . . . , ik between
1 and n. If the linear operator A s applied to this sum and equation (6.1.2) is used, we get
α = Aα = α(ei1, . . . , eik)A(ei1 ⊗· · · ⊗eik)
= α(ei1, . . . , eik) 1
k!ei1 ∧· · · ∧eik.
The sum still runs over all choices of the i1, . . . , ik and we want only distinct, ordered ones. However, since
α is skew symmetric, the coeﬃcient in α is 0 if i1, . . . , ik are not distinct. If they are distinct and σ ∈Sk,
then
α(ei1, . . . , eik)ei1 ∧· · · ∧eik = α(eσ(i1), . . . , eσ(ik))eσ(i1) ∧· · · ∧eσ(ik),
since both α and the wedge product change by a factor of sign σ. Since there are k! of these rearrangements,
we are left with
α =

i1<···<ik
α(ei1, . . . , eik)ei1 ∧· · · ∧eik.

6.1 Exterior Algebra
343
This shows that equation (6.1.4) spans k(E).
Secondly, we show that the elements in equation (6.1.4) are linearly independent. Suppose that

i1<···<ik
αi1,...,ikei1 ∧· · · ∧eik = 0.
For ﬁxed i′
1, . . . , i′
k, let j′
k+1, . . . , j′
n denote the complementary set of indices, j′
k+1 < · · · < j′
n. Then

i1<···<ik
αi1···ikei1 ∧· · · ∧eik ∧ej′
k+1 ∧· · · ∧ej′
n = 0.
However, this reduces to
αi′
1···i′
ke1 ∧· · · ∧en = 0.
But e1 ∧· · ·∧en ̸= 0, as (e1 ∧· · ·∧en)(e1, . . . , en) = 1 by Example 6.1.6A. Hence the coeﬃcients are zero.
■
6.1.9 Corollary.
If dim E = n, then dim n(E) = 1. If {α1, . . . , αn} is a basis for E∗, then α1 ∧· · · ∧αn
spans n(E).
Proof.
This follows from Proposition 6.1.8.
■
6.1.10 Corollary.
Let α1, . . . , αk ∈E∗. Then α1, . . . , αk are linearly dependent iﬀα1 ∧· · · ∧αn spans
n(E).
Proof.
If α1, . . . , αk are linearly dependent, then
αi =

j̸=1
cjαj
for some i. Since α ∧α = 0, for α a one-form, we see that α1 ∧· · · ∧αk = 0. Conversely, if α1 ∧· · · ∧αk = 0,
then by Corollary 6.1.9, α1, . . . , αk is not a basis for span {α1, . . . , αk}. Therefore k > dim(span{α1, . . . , αk})
and so α1, . . . , αk are linearly dependent.
■
6.1.11 Corollary.
Let θ ∈1(E) and α ∈k(E). Then θ ∧α = 0 iﬀthere exists β ∈k−1(E) such that
α = θ ∧β.
Proof.
Clearly, if α = θ ∧β, then θ ∧α = 0. Conversely, assume θ ∧α = 0, θ ̸= 0 and choose a basis
{ei}i∈I of E such that for some k ∈I, ek = θ. If

i1<···<ik
αi1...ikei1 ∧· · · ∧eik = 0.
From θ ∧α = 0 it follows that all summands not involving ek are zero. Now factor ek out of the remaining
terms and call the resulting (k −1)-form β.
■
6.1.12 Examples.
A.
Let E = R2, {e1, e2} be the standard basis of R2 and {e1, e2} the dual basis. Any element ω of 1(R2)
can be written uniquely as ω = ω1e1 + ω2e2, and any element ω of (R2) can be written uniquely as
ω = ω12e1 ∧e2.

344
6. Diﬀerential Forms
B.
Let E = R3, {e1, e2, e3} be the standard basis, and {e1, e2, e3} the dual basis. Any element ω ∈1(R3)
can be written uniquely as
ω = ω1e1 + ω2e2 + ω3e3.
Similarly, any elements η ∈2(R3) and ξ ∈3(R3) can be uniquely written as
η = η12e1 ∧e2 + η13e1 ∧e3 + η23e2 ∧e3
and
ξ = ξ123e1 ∧e2 ∧e3.
C.
Since R3, 1 
R3
, and 2 
R3
all have the same dimension, they are isomorphic. An isomorphism
R3 ∼=
1 
R3
=

R3∗is the standard one associated to a given basis: ei →ei, i = 1, 2, 3. An isomorphism
of 1 
R3
with 2 
R3
is determined by
e1 →e2 ∧e3,
e2 →e3 ∧e1,
and
e3 →e1 ∧e2.
This isomorphism is usually denoted by ∗: 1 
R3
→2 
R3
; we shall study this map in general in the
next section under the name Hodge star operator.
The standard isomorphism of R3 with 1(R3) = (R3)∗is given by the index lowering action ♭of the
standard metric on R3; that is, ♭(ei) = ei. Then ∗◦♭: R3 →2(R3) has the following property:

∗◦♭
(e × f) = ♭(e) ∧♭(f)
(6.1.5)
for all v, w ∈R3, where × denotes the usual cross-product of vectors; that is,
v × w =

v2w3 −v3w2
e1 +

v3w1 −v1w3
e2 +

v1w2 −v2w1
e3.
The relation (6.1.5) follows from the deﬁnitions and the fact that if α = α1e1 + α2e2 + α3e3 and β =
β1e1 + β2e2 + β3e3, then
α ∧β = (α2β3 −α3β2) e2 ∧e3
+ (α3β1 −α1β3) e3 ∧e1 + (α1β2 −α2β1) e1 ∧e2.
♦
Exercises
⋄6.1-1.
Compute α∧α, α∧β, β∧β, and β∧α∧β for α = 2e1∧e3−e2∧e3 ∈2 
R3
and β = −e1+e2−2e3
where {e1, e2, e3} is a basis of

R3∗.
⋄6.1-2.
If k! is omitted in the deﬁnition of A in Deﬁnition 6.1.1, show that ∧fails to be associative.
⋄6.1-3.
Let v1, . . . , vk be linearly dependent vectors. Show that for each α ∈r (E), we have α (v1, . . . , vk) =
0.
⋄6.1-4.
Let E be ﬁnite dimensional. Show that k (E∗) is isomorphic to
k(E)
∗
.
Hint: Deﬁne ϕ :
k(E)
∗
→k (E∗) by
ϕ (σ)

α1, . . . , αk
= σ

α1 ∧· · · ∧αk
and construct its inverse using the basis in Proposition 6.1.8.

6.2 Determinants, Volumes, and the Hodge Star Operator
345
⋄6.1-5.
Let {e1, . . . , en} be a basis of E with dual basis {e1, . . . , en} and let {f1, . . . , fm} be a basis of F.
Show the following:
(i) every β ∈k(E, F) can be uniquely written as β = Σ1≤i≤mβifi for βi ∈k(E), where
(γf) (v1, . . . , vk) = γ (v1, . . . , vk) f ∈F
for v1, . . . , vk ∈E, f ∈F, and γ ∈k (E);
(ii) { (ei1 ∧· · · ∧eik)fj | i1 < · · · < ik } is a basis of k (E, F) and thus dim
k (E, F)

=
mn!
(n −k)!k!;
(iii) dim((E, F)) = m2n;
(iv) if B ∈L(R, F; F), where B(t, f) = tf and ∧is the wedge product deﬁned by B, regarded as a map
∧: 1 (E) × k (E, F) →k+1 (E, F) show that
α ∧β =

1≤i≤m
(α ∧βi) fi.
If E = R3, F = R2,
α = e1 ∧e2 −2e1 ∧e3, and
β =

e1 ∧e3
f1 + 2

e2 ∧e3
f2 −

e1 ∧e2
f3,
compute α ∧β.
⋄6.1-6.
Let {e1, . . . , ek} and {f1, . . . , fk} be linearly independent sets of vectors. Show that they span the
same k-dimensional subspace iﬀ
f1 ∧· · · ∧fk = ae1 ∧· · · ∧ek,
where a ̸= 0. (Give a deﬁnition of f1 ∧· · · ∧fk as part of your answer.) Show that in fact
a = det ϕ,
where ϕ : span{e1, . . . , ek} →span{f1, ..., fk}
is determined by ϕ(ei) = fi, i = 1, . . . , k. Use this to relate k with Gk in Example 3.1.8G.
⋄6.1-7 (P. Chernoﬀand J. Robbin).
Let ∧′ be another wedge product on forms that is associative and
satisﬁes α ∧′ β = c(k, l)α ∧β, where α is a k-form and β is an one-form, c(k, l) is a scalar, and forms of
degree zero act as scalars.
(i) Prove the “cocycle identity” c(k, l)c(k + l, m) = c(k, l + m)c(l, m).
(ii) Deﬁne ψ(l) inductively by ψ(0) = ψ(1) = 1 and ψ(l + 1) = c(1, l)ψ(l). Show that c(k, l) = ψ(k +
l)/ψ(k)ψ(l). Deduce that c(k, l) = c(l, k); that is, ∧′ satisﬁes α ∧′ β = (−1)kl β ∧′ α automatically.
(iii) Show that c given in (ii) yields an associative wedge product. (ψ(k) = 1/k! converts our wedge product
convention to that of Kobayashi and Nomizu [1963]).
6.2
Determinants, Volumes, and the Hodge Star Operator
According to linear algebra, the determinant of an n × n matrix is a skew-symmetric function of its rows or
columns. Thus, if x1, . . . , xn ∈Rn, and we deﬁne ω by
ω (x1, . . . , xn) = det [x1, . . . , xn]

346
6. Diﬀerential Forms
where [x1, . . . , xn] denotes the n × n matrix whose columns are x1, . . . , xn, then ω is an element of n(Rn).
We also recall from linear algebra that det[x1, . . . , xn] is the oriented volume of the parallelepiped P spanned
by x1, . . . , xn (Figure 6.2.1) and that if xi has components xj
i, the determinant is given by
det[x1, . . . , xn] =

σ∈Sn
(sign σ)x1
σ(1) · · · xn
σ(s).
x1
x3
x2
P
Figure 6.2.1. Volume(P) = det[x1, x2, x3]
In this section determinants and volumes are approached from the point of view of exterior algebra.
Throughout this section E is assumed to be a ﬁnite-dimensional vector space and we denote its dimension
by dim E = n.
If ϕ : R3 →R3 is a linear transformation, it is shown in linear algebra that det ϕ is the oriented volume
of the image of the unit cube under ϕ (see Figure 6.2.2). In fact det ϕ is a measure of how ϕ changes
e3
e1
e2
ϕ(e3)
ϕ(e1)
ϕ(e2)
ϕ(P)
ϕ
Figure 6.2.2. Image of a cube under a linear map
volumes. In advanced calculus, this fact is the basis for introducing the Jacobian determinant in the change
of variables formula for multiple integrals. This background will lead the exposition to the development of
the Jacobian determinant of a mapping of manifolds.
Deﬁnition of the Determinant.
Recall that the pull-back ϕ∗α of α ∈T 0
k (F) by ϕ ∈L(E, F) is the
element of T 0
k (E) deﬁned by
(ϕ∗α) (e1, . . . , ek) = α (ϕ (e1) , . . . , ϕ (ek)) .
If ϕ ∈GL(E, F), then ϕ∗= (ϕ−1)∗denotes the push-forward. The following proposition is a consequence of
the deﬁnitions and Proposition 5.1.9. (The same results hold for Banach space valued forms.)

6.2 Determinants, Volumes, and the Hodge Star Operator
347
6.2.1 Proposition.
Let ϕ ∈L(E, F) and ψ ∈L(F, G)
(i) ϕ∗: T 0
k (F) →T 0
k (E) is linear, and ϕ∗((F)) ⊂k(E).
(ii) (ψ ◦ϕ)∗= ϕ∗◦ψ∗.
(iii) If ϕ is the identity, so is ϕ∗.
(iv) If ϕ ∈GL(E, F), then ϕ∗∈GL

T 0
k (F) , T 0
k (F)

,

ϕ−1∗= ϕ∗, and (ϕ∗)−1 =

ϕ−1
∗; if ψ ∈
GL (F, G), then (ψ ◦ϕ)∗= ψ∗◦ϕ∗.
(v) If α ∈k (F) and β ∈l (F), then ϕ∗(α ∧β) = ϕ∗α ∧ϕ∗β.
For example, if
β = βa1...akf a1 ∧· · · ∧f ak ∈k (F)
(sum over a1 < · · · < ak)
and ϕ ∈L(E, F) is given by the matrix [Aa
i ], that is, relative to ordered bases {e1, . . . ., en} of E and
{f1, . . . , fm} of F, one has ϕ(ei) = Aa
i fa, then
(ϕ∗β) = βa1···akϕ∗(f a1) ∧· · · ∧ϕ∗(f ak)
(sum over a1 < · · · < ak)
= βa1···akAa1
j1 ej1 ∧· · · ∧Aak
jk ejk
= βa1···akAa1
j1 · · · Aak
jk ej ∧· · · ∧ejk
= k!βa1···akAa1
j1 · · · Aak
jk ej1 ∧· · · ∧ejk, j1 < · · · < jk.
Recall that ϕ∗: n (E) →n (E) is a linear mapping and n (E) is one-dimensional. Thus, if ω0 is a
basis and ω = cω0, then ϕ∗ω = cϕ∗ω0 = bω for some constant b, clearly unique.
6.2.2 Deﬁnition.
Let dim(E) = n and ϕ ∈L(E, E). The unique constant det ϕ, such that ϕ∗: n(E) →
n(E) satisﬁes
ϕ∗ω = (det ϕ)ω
for all ω ∈n(E) is called the determinant of ϕ.
The deﬁnition shows that the determinant does not depend on the choice of basis of E, nor does it
depend on a norm on E. To compute det ϕ, choose a basis {e1, . . . , en} of E with dual basis {e1, . . . , en}.
Let ϕ ∈L(E, E) have the matrix [Aj
i]; that is, ϕ(ei) = Σ1≤j≤nAj
iej. By Example 6.1.6A,
ϕ∗(e1 ∧· · · ∧en)(e1, . . . , en) = (e1 ∧· · · ∧en)(ϕ(e1), . . . , ϕ(en))
= det[ej(ϕ(ei))] = det[Aj
i].
Since (e1 ∧· · · ∧en)(e1, . . . , en) = 1 we get det ϕ = det[Aj
i], the classical expression of the determinant of a
matrix with x1, . . . , xn as columns, where xi has components Aj
i. Thus the deﬁnition of the determinant in
Deﬁnition 6.2.2 coincides with the classical one.
Properties of the Determinant.
From properties of pull-back, we deduce corresponding properties of
the determinant, all of which are well known from linear algebra.
6.2.3 Proposition.
Let ϕ, ψ ∈L(E, E). Then
(i) det(ϕ ◦ψ) = (det ϕ)(det ψ);
(ii) if ϕ is the identity, det ϕ = 1;
(iii) ϕ is an isomorphism iﬀdet ϕ ̸= 0, and in this case det(ϕ−1) = (det ϕ)−1.

348
6. Diﬀerential Forms
Proof.
To prove (i), note ﬁrst that (ϕ ◦ψ)∗ω = det(ϕ ◦ψ)ω; but (ϕ ◦ψ)∗ω = (ψ∗◦ϕ∗)ω. Hence,
(ϕ ◦ψ)∗ω = ψ∗(det ϕ)ω = (det ψ)(det ϕ)ω
so (i) follows. Part (ii) follows at once from the deﬁnition. For (iii), suppose ϕ is an isomorphism with inverse
ϕ−1. Therefore, by (i) and (ii),
1 = det(ϕ ◦ϕ−1) = (det ϕ)(det ϕ−1),
and, in particular, det ϕ ̸= 0. Conversely, if ϕ is not an isomorphism there is an e1 ̸= 0 satisfying ϕ(e1) = 0.
Extend to a basis {e1, e2, . . . , en}. Then for all n-forms ω, we have
(ϕ∗ω) (e1, . . . , en) = ω (0, ϕ (e2) , . . . , ϕ (en)) = 0.
Hence, det ϕ = 0.
■
In Chapter 2 we saw that if E and F are ﬁnite dimensional, one convenient norm giving the topology of
L(E, F) is the operator norm:
∥ϕ∥= sup{∥ϕ(e)∥| ∥e∥= 1} = sup
∥ϕ(e)∥
∥e∥
|e ̸= 0

where ∥e∥is a norm on E. (See §2.2.) Hence, for any e ∈E,
∥ϕ(e)∥≤∥ϕ∥∥e∥.
6.2.4 Proposition.
The map det : L(E, E) →R is continuous.
Proof.
This is clear from the component formula for the determinant, but let us also give a coordinate
free proof. Note that
∥ω∥= sup{ |ω(e1, . . . , en)| | ∥e1∥= · · · = ∥en∥= 1 }
= sup{ |ω(e1, . . . , en)|/∥e1∥· · · ∥en∥| e1, . . . , en ̸= 0 }
is a norm on n (E) and |ω(e1, . . . , en)| ≤∥ω∥∥e1∥· · · ∥en∥. Then, for ϕ, ψ ∈L(E, E),
| det ϕ −det ψ| ∥ω∥
= ∥ϕ∗ω −ψ∗ω∥
= sup{ |ω(ϕ(e1), . . . , ϕ(en)) −ω(ψ(e1), . . . , ψ(en))| | ∥e1∥= · · ·
= ∥en∥= 1 }
≤sup{ |ω(ϕ(e1) −ψ(e1), ϕ(e2), . . . , ϕ(en))| + · · ·
+ |ω(ψ(e1), ψ(e2), . . . , ϕ(en) −ψ(en))| | ∥e1∥= · · · = ∥en∥= 1 }
≤∥ω∥∥ϕ −ψ∥{∥ϕ∥n−1 + ∥ϕ∥n−2∥ψ∥+ · · · + ∥ψ∥n−1}
≤∥ω∥∥ϕ −ψ∥(∥ϕ∥+ ∥ψ∥)n−1.
Consequently,
| det ϕ −det ψ| ≤∥ϕ −ψ∥(∥ϕ∥+ ∥ψ∥)n−1
from which the result follows.
■
In Chapter 2 we saw that the set of isomorphisms of E to F form an open subset of L(E, F). Using the
determinant, we can give an alternate proof in the ﬁnite-dimensional case.

6.2 Determinants, Volumes, and the Hodge Star Operator
349
6.2.5 Proposition.
Suppose that E and F are ﬁnite-dimensional and let GL(E, F) denote those ϕ ∈
L(E, F) that are isomorphisms. Then GL(E, F) is an open subset of L(E, F).
Proof.
If GL(E, F) = ∅, the conclusion is true. Otherwise, there is an isomorphism ψ ∈GL(E, F). A map
ϕ in L(E, F) is an isomorphism if and only if ψ−1 ◦ϕ is also. This happens precisely when det(ψ−1 ◦ϕ) ̸= 0.
Therefore, GL(E, F) is the inverse image of R\{0} under the map taking ϕ to det (ψ−1 ◦ϕ). Since this is
continuous and R\{0} is open, GL(E, F) is also open.
■
Orientation.
The basis elements of n (E) enable us to deﬁne orientation or “handedness” of a vector
space.
6.2.6 Deﬁnition.
The nonzero elements of the one-dimensional space n(E) are called volume ele-
ments. If ω1 and ω2 are volume elements, we say ω1 and ω2 are equivalent iﬀthere is a c > 0 such
that ω1 = cω2. An equivalence class [ω] of volume elements on E is called an orientation on E. An ori-
ented vector space (E, [ω]) is a vector space E together with an orientation [ω] on E; [−ω] is called the
reverse orientation. A basis {e1, . . . , en} of the oriented vector space (E, [ω]) is called positively (resp.,
negatively) oriented, if ω(e1, . . . , en) > 0 (resp., < 0).
The last statement is independent of the representative of the orientation [ω], for if ω′ ∈[ω], then ω′ = cω
for some c > 0, and thus ω′(e1, . . . , en) and ω(e1, . . . , en) have the same sign. Also note that a vector
space E has exactly two orientations: one given by selecting an arbitrary dual basis {e1, . . . , en} and taking
[e1 ∧· · · ∧en]; the other is its reverse orientation.
This deﬁnition of orientation is related to the concept of orientation from calculus as follows. In R3, a
right-handed coordinate system like the one in Figure 6.2.1 is by convention positively oriented, as are all
other right-handed systems. On the other hand, any left-handed coordinate system, obtained for example
from the one in Figure 6.2.1 by interchanging x1 and x2, is by convention negatively oriented. Thus one would
call a positive orientation in R3 the set of all right-handed coordinate systems. The key to the abstraction of
this construction for any vector space lies in the observation that the determinant of the change of ordered
basis of two right-handed systems in R3 is always strictly positive. Thus, if E is an n-dimensional vector
space, deﬁne an equivalence relation on the set of ordered bases in the following way: two bases {e1, . . . , en}
and {e′
1, . . . , e′
n} are equivalent iﬀdet ϕ > 0, where ϕ ∈GL(E) is given by ϕ(ei) = e′
i, i = 1, . . . , n. We
can relate n-forms to the bases by associating to a basis {e1, . . . , en} and its dual basis {e1, . . . , en} the
n-form ω = e1 ∧· · · ∧en. The following proposition shows that this association gives an identiﬁcation of the
corresponding equivalence classes.
6.2.7 Proposition.
An orientation in a vector space is uniquely determined by an equivalence class of
ordered bases.
Proof.
If [ω] is an orientation of E there exists a basis {e1, . . . , en} such that ω(e1, . . . , en) ̸= 0 since
ω ̸= 0 in n(E). Changing the sign of e1 if necessary, we can ﬁnd a basis that is positively oriented. Let
{e′
1, . . . , e′
n} be an equivalent basis and ϕ ∈GL(E), deﬁned by ϕ(ei) = e′
i, i = 1, . . . , n be the change of
basis isomorphism. Then if ω′ ∈[ω], there exists c > 0 such that ω′ = cω, so we get
ω′(e′
1, . . . , e′
n) = cω(ϕ(e1), . . . , ϕ(en)) = c(ϕ∗ω)(e1, . . . , en)
= c(det ϕ)ω(e1, . . . , en) > 0.
That is, [ω] uniquely determines the equivalence class of {e1, . . . , en}.
Conversely, let {e1, . . . , en} be a basis of E and let ω = e1∧· · ·∧en, where {e1, . . . , en} is the dual basis. As
before, ω′(e′
1, . . . , e′
n) > 0 for any ω′ ∈[ω] and {e′
1, . . . , e′
n} equivalent to {e1, . . . , en} ; thus, the equivalence
class of the ordered basis {e1, . . . , en} uniquely determines the orientation [ω].
■

350
6. Diﬀerential Forms
Volume Elements in Inner Product Spaces.
An important point is that to get a particular volume
element on E requires additional structure, although the determinant does not. The idea is based on the fact
that in R3 the volume of the parallelepiped P = P(x1, x2, x3) spanned by three positively oriented vectors
x1, x2, and x3 can be expressed independent of any basis as
Vol(P) = (det[⟨xi, xj⟩])1/2,
where [⟨xi, xj⟩] denotes the symmetric 3×3 matrix whose entries are ⟨xi, xj⟩. If x1, x2, and x3 are negatively
oriented, det[⟨xi, xj⟩] < 0 and so the formula has to be modiﬁed to
Vol(P) = (| det[⟨xi, xj⟩]|)1/2.
(6.2.1)
Densities.
The above argument suggests that besides the volumes, there are quantities involving absolute
values of volume elements that are also important. This leads to the notion of densities.
6.2.8 Deﬁnition.
Let α be a real number. A continuous mapping ρ : E × · · · × E →R (n factors of E for
E an n-dimensional vector space) is called an α-density if
ρ (ϕ (v1) , . . . , ϕ (vn)) = | det ϕ|αρ (v1, . . . , vn) ,
for all v1, . . . , vn ∈E and all ϕ ∈L(E, E). Let |  |α(E) denote the α-densities on E. With α = 1, 1-densities
on E are simply called densities and |  |1(E) is denoted by |  |(E).
The determinant of ϕ in this deﬁnition is taken with respect to any volume element of E. As we saw
in Deﬁnition 6.2.2, this is independent of the choice of the volume element. Note that |  |α(E) is one-
dimensional. Indeed, if ρ1 and ρ2 ∈|  |α(E), ρ1 ̸= 0, and {e1, . . . , en} is a basis of E, then ρ2(e1, . . . , en) =
aρ1(e1, . . . , en), for some constant a ∈R. If v1, . . . , vn ∈E, let vi = ϕ(ei), deﬁning ϕ ∈L(E, E). Then
ρ2(v1, . . . , vn) = | det ϕ|αρ2(e1, . . . , en)
= a| det ϕ|αρ1(e1, . . . , en) = aρ1(v1, . . . , vn);
that is, ρ2 = aρ1.
Alpha-densities can be constructed from volume elements as follows. If ω ∈n(E), deﬁne |ω|α ∈|  |α(E)
by
|ω|α (e1, . . . , en) = |ω (e1, . . . , en) |α
where e1, . . . , en ∈E. This association deﬁnes an isomorphism of n(E) with |  |α(E). Thus one often uses
the notation |ω|α for α-densities.
Volume Elements in Inner Product Spaces.
We shall construct canonical volume elements (and
hence α-densities) for vector spaces carrying a bilinear symmetric nondegenerate covariant two-tensor, and
in particular for inner product spaces. First we recall a fact from linear algebra.
6.2.9 Proposition.
Let E be an n-dimensional vector space and g = ⟨, ⟩∈T 0
2 (E) be symmetric and of
rank r; that is, the map e ∈E →g(e, ·) ∈E∗has r-dimensional range. Then there is an ordered basis
{e1, . . . , en} of E with dual basis {e1, . . . , en} such that
g =
r

i=1
ciei ⊗ei,

6.2 Determinants, Volumes, and the Hodge Star Operator
351
where ci = ±1 and r ≤n, or equivalently, the matrix of g is


c1
0
0
· · ·
0
0
· · ·
0
0
c2
0
· · ·
0
0
· · ·
0
0
0
c3
· · ·
0
0
· · ·
0
...
...
...
...
...
...
...
0
0
0
. . .
cr
0
· · ·
0
0
0
0
· · ·
0
0
· · ·
0
...
...
...
...
...
...
...
0
0
0
· · ·
0
0
· · ·
0


.
This basis {e1, . . . , en} is called a g-orthonormal basis. Moreover, the number of basis vectors for which
g(ei, ei) = 1 (resp., g(ei, ei) = −1) is unique and equals the maximal dimension of any subspace on which g
is positive (resp., negative) deﬁnite. The number s = the number of +1’s minus the number of −1’s is called
the signature of g. The number of −1’s is called the index of g and is denoted Ind(g).
Proof (Gram–Schmidt argument).
Since g is symmetric, the following polarization identity holds:
g(e, f) = 1
4g(e + f, e + f) −g(e −f, e −f).
Thus if g ̸= 0, there is an e1 ∈E such that g(e1, e1) ̸= 0. Rescaling, we can assume c1 = g(e1, e1) = ±1.
Let E1 be the span of e1 and E2 = { e ∈E | g(e1, e) = 0 }. Clearly E1 ∩E2 = {0}. Also, if z ∈E, then
z −c1g(z, e1)e1 ∈E2 so that E = E1 + E2 and thus E = E1 ⊕E2. Now if g ̸= 0 on E2, there is an e2 ∈E2
such that g(e2, e2) = c2 = ±1. Continue inductively to complete the proof.
For the second part, in the basis {e1, . . . , en} just found, let
E1 = span { ei | g (ei, ei) = 1 } ,
E2 = span { ei | g (ei, ei) = −1 }
and
ker g = { e | g (e, e′) = 0 for all e′ ∈E } .
Note that ker g = span{ ei | g(ei, ei) = 0 } and thus E = E1 ⊕E2 ⊕ker g. Let F be any subspace of E on
which g is positive deﬁnite. Then clearly F ∩ker g = {0}. We also have E2 ∩F = {0} since any v ∈E2 ∩F,
v ̸= 0, must simultaneously satisfy g(v, v) > 0 and g(v, v) < 0. Thus F∩(E2 ⊕ker g) = {0} and consequently
dim F ≤dim E1. A similar argument shows that dim E2 is the maximal dimension of any subspace of E
on which g is negative deﬁnite.
■
Note that the number of ones in the diagonal representation of g is (r+s)/2 and the number of minus-ones
is Ind(g) = (r −s)/2. Nondegeneracy of g means that r = n. In this case e ∈E may be written
e =

i=1,...,n
g (e, ei)
ci
ei,
where ci = g(ei, ei) = ±1 and {ei} is a g-orthonormal basis. For g a positive deﬁnite inner product, r = n
and Ind(g) = 0; for g a Lorentz inner product r = n and Ind(g) = 1.
6.2.10 Proposition.
Let E be an n-dimensional vector space and g ∈T 0
2 (E) be nondegenerate and sym-
metric.
(i) If [ω] is an orientation of E there exists a unique volume element µ = µ(g) ∈[ω], called the g-volume,
such that µ(e1, . . . , en) = 1 for all positively oriented g-orthonormal bases {e1, . . . , en} of E. In fact,
if {e1, . . . , en} is the dual basis, then µ = e1 ∧· · · ∧en. More generally, if {f1, . . . , fn} is a positively
oriented basis with dual basis {f 1, . . . , f n}, then
µ = | det [g (fi, fj)] |1/2f 1 ∧· · · ∧f n.

352
6. Diﬀerential Forms
(ii) There is a unique α-density |µ|α, called the g-α-density, with the property that
|µ|α(e1, . . . , en) = 1
for all g-orthonormal bases {e1, . . . , en} of E. If {e1, . . . , en} is the dual basis, then |µ|α = |e1∧· · ·∧en|α.
More generally, if v1, . . . , vn ∈E are positively oriented, then
|µ|α (v1, . . . , vn) = | det [g (vi, vj)] |a/2.
Proof.
First we establish a relation between the determinants of the following three matrices: [g(ei, ej)] =
diag(c1, . . . , cn) (see Proposition 6.2.9), [g(fi, fj)] for an arbitrary basis {f1, . . . , fn}, and the matrix repre-
sentation of ϕ ∈GL(E) where ϕ(ei) = fi = Aj
iej. By Proposition 6.2.9, we have
g (fi, fj) =
 n

p=1
cpep ⊗ep
	

Ak
i ek, Al
jel

= cpδp
kδp
l Ak
i Al
j = cpAp
i Ap
j
(sum on p).
Thus,
det[g(fi, fj)] = (det ϕ)2 det[g(ei, ej)].
(6.2.2)
By Proposition 6.2.9, | det[g(ei, ej)]| = 1.
(i) Clearly if {e1, . . . , en} is positively oriented and g-orthonormal, then µ(e1, . . . , en) = 1 uniquely de-
termines µ ∈[ω] by multilinearity. Suppose that {f1, . . . , fn} is another positively oriented g-orthonormal
basis. If ϕ ∈GL(E) where ϕ(ei) = fi, i = 1, . . . , n, then by equation (6.2.2) and Proposition 6.2.9, it follows
that | det ϕ| = 1 . But
0 < µ(f1, . . . , fn) = (ϕ∗µ)(e1, . . . , en) = det ϕ,
so that det ϕ = 1. The second statement in (i) follows from the third.
For the third statement of (i), note that by equation (6.2.2)
µ(f1, . . . , fn) = det ϕ = | det[g(fi, fj)]|1/2.
(ii) follows from (i) and the remarks following Deﬁnition 6.2.8.
■
A covariant symmetric nondegenerate two-tensor g on E induces one on k(E) for every k = 1, . . . , n in
the following way. Let
α = αi1···ikei1 ∧· · · ∧eik
and
β = βi1···ikei1 ∧· · · ∧eik ∈k(E),
(sum over i1 < · · · < ik) and let
βi1···ik = gi1j1 · · · gikjkβi1···jk
(sum over all ji, . . . , jk) be the components of the associated contravariant k-tensor, where [gkj] denotes the
inverse of the matrix with entries gij = g(ei, ej). Then put
g(k)(α, β) =

i1<···<ik
αi1···ikβi1···ik.
(6.2.3)
If there is no danger of confusion, we will write ⟨α, β⟩= g(k)(α, β). We now show that this deﬁnition does
not depend on the basis. If {f1, . . . , fn} is another ordered basis of E, let
α = α′
ai···akf a1 ∧· · · ∧f ak
and
β = β′
a1···akf a1 ∧· · · ∧f ak.

6.2 Determinants, Volumes, and the Hodge Star Operator
353
The the identity map on E has matrix representation relative to the bases {e1, . . . , en} and {f1, . . . , fn}
given by ei = Aa
i fa. If B = A−1 we have by Proposition 5.1.7,
α′
a1···akβ′a1···ak = αi1···ikBi1
a1 · · · Bik
akAa1
j1 · · · Aak
jk βj1···jk
= αa1···akδi1
j1 · · · δik
jkβi1···jk = αi1···ikβj1···jk.
So deﬁned, g(k) is clearly bilinear. It is also symmetric since
βi1···ikαi1···ik = gi1j1 · · · gikjkβj1···jkgi1l1 . . . giklkαl1···lk
= δl1
j1 · · · δlk
jkαl1···lkβj1···jk = αj1···jkβj1···jk,
where [gij] = [gij]−1, and gij = g(ei, ej). Notice that g(k) is also nondegenerate since if g(k)(α, β) = 0 for all
β ∈k(E), choosing for β all elements of a basis, show that αi1···ik = 0, that is, that α = 0. The following
has thus been proved.
6.2.11 Proposition.
A nondegenerate symmetric covariant two-tensor g = ⟨, ⟩on the ﬁnite-dimensional
vector space E induces a similar tensor on k(E) for all k = 1, . . . , n. Moreover, if {e1, . . . , en} is a g-
orthonormal basis of E in which
g =
n

i=1
ciei ⊗ei,
ci = ±1,
then the basis
{ ei1 ∧· · · ∧eik | i1 < · · · < ik }
is orthonormal with respect to g(k) = ⟨, ⟩, and
⟨ei1 ∧· · · ∧eik, ei1 ∧· · · ∧eik⟩= ci1 · · · cik (= ±1).
(6.2.4)
Hodge Star Operator.
This operator will be introduced with the aid of the g-volume µ on E.
6.2.12 Proposition.
Let E be an oriented n-dimensional vector space and g = ⟨, ⟩∈T 0
2 (E) a given
symmetric and nondegenerate tensor. Let µ be the corresponding volume element of E. Then there is a
unique isomorphism ∗: k(E) →n−k(E) satisfying
α ∧∗β = ⟨α, β⟩µ
for α, β ∈k(E).
(6.2.5)
If {e1, . . . , en} is a positively oriented g-orthonormal basis of E and {e1, . . . , en} is its dual basis, then
∗(eσ(1) ∧· · · ∧eσ(k)) = cσ(1) . . . cσ(k) sign(σ)(eσ(k+1) ∧· · · ∧eσ(n))
(6.2.6)
where σ(1) < · · · < σ(k) and σ(k + 1) < · · · < σ(n).
Proof.
First uniqueness is proved. Let ∗satisfy equation (6.2.5) and let β = eσ(1) ∧· · · ∧eσ(k) and α be
one of the g-orthonormal basis vectors
ei1 ∧· · · ∧eik of k(E),
i1 < · · · < ik.
By equation (6.2.5), α ∧∗β = 0 unless (i1, . . . , ik) = (σ(1), . . . , σ(k)). Thus,
∗β = aeσ(k+1) ∧· · · ∧eσ(n)
for a constant a. But then β ∧∗β = a sign(σ)µ and by equation (6.2.4), ⟨β, β⟩= cσ(1) . . . cσ(k). Hence
a = cσ(1) . . . cσ(k) sign(σ) and so ∗must satisfy equation (6.2.6). Thus ∗is unique.
Deﬁne ∗by equation (6.2.6), recalling that eσ(1)∧· · ·∧eσ(k) for σ(1) < · · · < σ(k) forms a g(k)-orthonormal
basis of k(E). As before, equation (6.2.5) is then veriﬁed using this basis. Clearly ∗deﬁned by equation
(6.2.6) is an isomorphism, as it maps the g-orthonormal basis of k(E) to that of n−k(E).
■

354
6. Diﬀerential Forms
6.2.13 Proposition.
Let E be an oriented n-dimensional vector space, g = ⟨, ⟩∈T 0
2 (E) symmetric and
nondegenerate of signature s, and µ the associated g-volume of E. The Hodge star operator satisﬁes the
following properties for α, β ∈k(E):
α ∧∗β = β ∧∗α = ⟨α, β⟩µ,
(6.2.7)
∗1 = µ, ∗µ = (−1)Ind(g),
(6.2.8)
∗∗α = (−1)Ind(g)(−1)k(n−k)α,
(6.2.9)
⟨α, β⟩= (−1)Ind(g)⟨∗α, ∗β⟩.
(6.2.10)
Proof.
Equation (6.2.7) follows from equation (6.2.5) by symmetry of ⟨α, β⟩. Equations (6.2.8) follow
directly from equation (6.2.6), with k = 0, n, respectively, and σ = identity (note that c1 . . . cn = (−1)Ind(g)).
To verify equation (6.2.9), it suﬃces to take α = eσ(1) ∧· · · ∧eσ(k). By equation (6.2.6),
∗(eσ(k+1) ∧· · · ∧eσ(n)) = beσ(1) ∧· · · ∧eσ(k)
for a constant b. To ﬁnd b use equation (6.2.5) with α = β = eσ(k+1) ∧· · · ∧eσ(n) to give (see equation
(6.2.4))
beσ(k+1) ∧· · · ∧eσ(n) ∧eσ(1) ∧· · · ∧eσ(k) = cσ(k+1) . . . cσ(n)µ.
Hence b = cσ(k+1) . . . cσ(n)(−1)k(n−k) sign(σ). Thus, equation (6.2.6) implies
∗∗(eσ(1) ∧· · · ∧eσ(n)) = cσ(1) . . . cσ(k)(sign(σ)) ∗(eσ(k+1) ∧· · · ∧eσ(n))
= cσ(1) . . . cσ(k)cσ(k+1) . . . cσ(n)(sign(σ))2
(−1)k(n−k)eσ(1) ∧· · · ∧eσ(k)
= (−1)Ind(g)(−1)k(n−k)eσ(1) ∧· · · ∧eσ(k).
Finally for equation (6.2.10), we use equations (6.2.7) and (6.2.9) to give
⟨∗α, ∗β⟩µ = ∗α ∧∗∗β = (−1)Ind(g)(−1)k(n−k) ∗α ∧β
= (−1)Ind(g)β ∧∗α = (−1)Ind(g)⟨α, β⟩µ.
■
6.2.14 Examples.
A.
The Hodge operator on 1(R3) where R3 has the standard metric and dual basis is given from equation
(6.2.6) by ∗e1 = e2 ∧e3, ∗e2 = −e1 ∧e3, and ∗e3 = e1 ∧e2. (This is the isomorphism considered in Example
6.1.12B.)
B.
Using equation (6.2.5), we compute ∗in an arbitrary oriented basis. Write
∗(ei1 ∧· · · ∧eik) = ci1···jk
jk+1···jnejk+1 ∧· · · ∧ejn
(sum over jk+1 < · · · < jn) and apply equation (6.2.5) with
β = ei1 ∧· · · ∧eik
and
α = ej1 ∧· · · ∧ejk
where {j1, . . . , jk} is a complementary set of indices to {jk+1, . . . , jn}. One gets
ci1···ik
jk+1···jn = gi1j1 · · · gikjk| det[gij]|1/2 sign

1 · · · n
j1 · · · jn

.

6.2 Determinants, Volumes, and the Hodge Star Operator
355
Hence
∗(ei1 ∧· · · ∧eik)
(6.2.11)
= | det[gij]|1/2 
sign

1 · · · n
j1 · · · jn

gi1j1 · · · gikjkejk+1 ∧· · · ∧ejn,
where the sum is over all (k, n −k) shuﬄes

1 · · · n
j1 · · · jn

.
C.
In particular, if k = 1, equation (6.2.11) yields
∗ei = | det([gij])|1/2
n

j=1
(−1)j−1gije1 ∧· · · ∧ˆej ∧· · · ∧en
(6.2.12)
since sign(j1, j2, . . . , jn) = (−1)j−1, for j2 < · · · < jn, j1 = j, and where ˆej means that ej is deleted.
D.
From B we can compute the components of ∗α, where α ∈k(E), relative to any oriented basis: write
α = αi1···ikei1 ∧· · · ∧eik (sum over i1 < · · · < ik) and apply equation (6.2.11) to give
(∗α) = | det[gij]|1/2 
sign

1 · · · n
j1 · · · jn

αi1···ikgi1j1 · · · gikjkejk+1 ∧· · · ∧ejn.
Hence
(∗α)jk+1···jn = | det[gij]|1/2 
αi1···ikgi1j1 · · · gikjk sign

1 · · · n
j1 · · · jn

(6.2.13)
for jk+1 < · · · < jn and where the sum is over all complementary indices j1 < · · · < jk.
E.
Consider R4 with the Lorentz inner product, which in the standard basis {e1, e2, e3, e4} of R4 has the
matrix


1
0
0
0
0
1
0
0
0
0
1
0
0
0
0
−1

.
Let {e1, e2, e3, e4} be the dual basis. The Hodge operator on 1(R4) is given by
∗e1 = e2 ∧e3 ∧e4,
∗e2 = −e1 ∧e3 ∧e4,
∗e3 = e1 ∧e2 ∧e4,
∗e4 = e1 ∧e2 ∧e3,
and on 2(R4) by
∗(e1 ∧e2) = e3 ∧e4,
∗(e1 ∧e3) = −e2 ∧e4,
∗(e2 ∧e3) = e1 ∧e4
∗(e1 ∧e4) = −e2 ∧e3,
∗(e2 ∧e4) = e1 ∧e3,
∗(e3 ∧e4) = −e1 ∧e2.
If R4 had been endowed with the usual Euclidean inner product, the formulas for ∗e4, ∗(e1∧e4), ∗(e2∧e4),
and ∗(e3 ∧e4) would have opposite signs. The Hodge ∗operator on 3(R4) follows from the formulas on
1(R4) and the fact that for β ∈1(R4), ∗∗β = β (from formula (6.2.9)). Thus we obtain
∗(e2 ∧e3 ∧e4) = e1,
∗(e1 ∧e3 ∧e4) = −e2,
∗(e1 ∧e2 ∧e4) = e3,
∗(e1 ∧e2 ∧e3) = e4.

356
6. Diﬀerential Forms
F.
If β is a one form and v1, v2, . . . , vn is a positively oriented orthonormal basis, then
(∗β) (v2, . . . , vn) = β (v1) .
This follows from equation (6.2.5) taking α = v1, the ﬁrst element in the dual basis and using the
orthonormality of v1, . . . , vn.
♦
Exercises
⋄6.2-1.
Let {e1, e2, e3} be the standard dual basis of R3 and
α = e1 ∧e2 −2e2 ∧e3 ∈2(R3),
β = 3e1 −e2 + 2e3 ∈1(R3),
and ϕ ∈L

R2, R3
have the matrix


1
0
0
−1
2
1


Compute ϕ∗α. With the aid of the standard metrics in R2 and R3, compute ∗α, ∗β, ∗(ϕ∗α), and ∗(ϕ∗β).
do you get any equalities? Explain.
⋄6.2-2.
A map ϕ ∈L(E, F), where (E, ω), (F, µ) are oriented vector spaces with chosen volume elements,
is called volume preserving if ϕ∗µ = ω. Show that if E and F have the same (ﬁnite) dimension, then ϕ
is an isomorphism.
⋄6.2-3.
A map ϕ ∈L(E, F), where (E, [µ]) and (F, [ω]) are oriented vector spaces, is called orientation
preserving if ϕ∗µ ∈[ω]. If dim E = dim F, and ϕ is orientation preserving, show that ϕ is an isomorphism.
Given an example for F = E = R3 of an orientation-preserving but not volume-preserving map.
⋄6.2-4.
Let E and F be n-dimensional real vector spaces with nondegenerate symmetric two-tensors, g ∈
T 0
2 (E) and h ∈T 0
2 (F). Then ϕ ∈L(E, F) is called an isometry if h(ϕ(e), ϕ(e′)) = g(e, e′) for all e, e′ ∈E.
(i) Show that an isometry is an isomorphism.
(ii) Consider on E and F the g- and h-volumes µ(g) and µ(h). Show that if ϕ is an orientation-preserving
isometry, then ϕ∗commutes with the Hodge star operator, that is, the following diagram commutes:
k(F)
n−k(F)
k(E)
n−k(E)
∗
∗
ϕ∗
ϕ∗
✲
✲
❄
❄
If ϕ is orientation reversing, show that ∗(ϕ∗α) = −ϕ∗(∗α) for α ∈k(F).
⋄6.2-5.
Let g be an inner product and {f1, f2, f3} be a positively oriented basis of R3. Denote by ♭and #
the index lowering and raising actions deﬁned by g.
(i) Show that for any vectors u, v ∈R3
[∗(u♭∧v♭)]# = sign
1 2 3
i j k

| det[g(fa, fb)]|1/2uivjgklfl.

6.3 Diﬀerential Forms
357
(ii) Show that if g is the standard dot-product in R3 the formula in (i) reduces to the cross-product of u
and v.
(iii) Generalize (i) to deﬁne the cross-product of n −1 vectors u1, . . . , un−1 in an oriented n-dimensional
inner product space (E, g), and ﬁnd its coordinate expression.
⋄6.2-6.
Let E be an n-dimensional oriented vector space and let g ∈T 0
2 (E) be symmetric and non-
degenerate of signature s. Using the g-volume, deﬁne the Hodge star operator ∗: k(E; F) →n−k(E; F),
where F is another ﬁnite-dimension vector space by
∗α = (∗αi)fi,
where αi ∈k(E), {f1, . . . , fm} is a basis of F and α = αifi. Show the following.
(i) The deﬁnition is independent of the basis of F.
(ii) ∗∗= (−1)(n−s)/2+k(n−k) on k(E; F).
(iii) If h ∈T 0
2 (F) and if we let h′(f, α) = (∗ai)h(f, fi), then ∗h′(f, α) = h′(f, ∗α).
(iv) If ∧is the wedge product in (E; F) with respect to a given bilinear form on F, then for α, β ∈
k(E; F),
(∗α) ∧β = (∗β) ∧α
and
α ∧(∗β) = β ∧(∗α).
(v) Show how g and h induce a symmetric nondegenerate covariant two-tensor on k(E; F) and ﬁnd
formulas analogous to equations (6.2.7)–(6.2.10).
⋄6.2-7.
Prove the following identities in R3 using the Hodge star operator:
∥u × v∥2 = ∥u∥2∥v∥2 −(u · v)2
and
u × (v × w) = (u · w)v −(u · v)w.
⋄6.2-8.
(i) Prove the following identity for the Hodge star operator:
⟨∗α, β⟩= ⟨α ∧β, µ⟩,
where α ∈k(E) and β ∈n−k(E).
(ii) Prove the basic properties of ∗using (i) as the deﬁnition.
⋄6.2-9.
Let E be an oriented vector space and S ⊂T 0
2 (E) be the set of nondegenerate symmetric two–
tensors of a ﬁxed signature s.
(i) Show that S is open.
(ii) Show that the map vol : g →µ(g) assigning to each g ∈S its g-volume element is diﬀerentiable and
has derivative at g given by h →(trace h)µ(g)/2.
6.3
Diﬀerential Forms
The exterior algebra will now be extended from vector spaces to vector bundles and in particular to the
tangent bundle.

358
6. Diﬀerential Forms
Exterior Forms on Local Vector Bundles.
First of all, we need to consider the action of local bundle
maps. As in Chapter 3, U × F denotes a local vector bundle, where U is open in a Banach space E and F is
a Banach space. From U × F, we construct the local vector bundle U × k(F). Now we want to piece these
local objects together into a global one.
6.3.1 Deﬁnition.
Let ϕ : U × F →U ′ × F′ be a local vector bundle map that is an isomorphism on each
ﬁber. Then deﬁne ϕ∗: U × k(F) →U ′ × k(F′) by (u, ω) →(ϕ0(u), ϕu∗ω), where ϕu is the second factor
of ϕ (an isomorphism for each u).
6.3.2 Deﬁnition.
If ϕ : U × F →U ′ × F′ is a local vector bundle map that is an isomorphism on each
ﬁber, then so is ϕ∗. Moreover, if ϕ is a local vector bundle isomorphism, so is ϕ∗.
Proof.
This is a special case of Proposition 5.2.4.
■
The Exterior Algebra of a Vector Bundle.
Given a vector bundle, we can form the exterior algebra
ﬁberwise.
6.3.3 Deﬁnition.
Suppose π : E →B is a vector bundle. Deﬁne
k(E)|A = 
b∈A
k(Eb)
where A is a subset of B and Eb = π−1(b) is the ﬁber over b ∈B. Let k(E)|B = k(E) and deﬁne
k(π) : k(E) →B by k(π)(t) = b if t ∈k(Eb).
6.3.4 Theorem.
Assume {E|Ui, ϕi} is a vector bundle atlas for the vector bundle π, where ϕi : E|Ui →
U ′
i × F′
i. Then {k(E)|Ui, ϕi∗} is a vector bundle atlas of k(π) : k(E) →B, where ϕi∗: k(E)|Ui →
U ′
i × k(F′) is deﬁned by ϕi∗|Eb = (ϕi|Eb)∗.
Proof.
We must verify VB1 and VB2 in Deﬁnition 3.4.4 of a vector bundle. Condition VB1 is clear; for
VB2 let ϕi, ϕj be two charts for π, so that ϕi ◦ϕ−1
j
is a local vector bundle isomorphism on its domain.
But then, ϕi∗◦ϕ−1
j∗= (ϕi ◦ϕ−1
j )∗, which is a local vector bundle isomorphism by Deﬁnition 6.3.2.
■
Because of this theorem, the vector bundle structure of π : E →B induces naturally a vector bundle
structure on k(E) →B.
Diﬀerential Forms on Manifolds.
We now specialize to the important case when π : E →B is the
tangent bundle. If τM : TM →M is the tangent bundle of a manifold M, let
k(M) = k(TM)
and
k
M = k(τM),
so k
M : k(M) →M is the vector bundle of exterior k forms on the tangent spaces of M. Also, let
Ω0(M) = F(M), Ω1(M) = T 0
1 (M), and Ωk(M) = Γ∞(k
M), k = 2, 3, . . . .
6.3.5 Proposition.
Regarding T 0
k (M) as an F(M) module, Ωk(M) is an F(M) submodule; that is, Ωk(M)
is a subspace of T 0
k (M) and if f ∈F(M) and α ∈Ωk(M), then fα ∈Ωk(M).
Proof.
If α1, α2 ∈Ωk(M) and f ∈F(M), then we must show fα1 + α2 ∈Ωk(M). This follows from the
fact that for each m ∈M, the exterior algebra on TmM is a vector space.
■
6.3.6 Proposition.
If α ∈Ωk(M) and β ∈Ωl(M), k, l = 0, 1, . . . , deﬁne α ∧β : M →k+l(M) by
(α ∧β)(m) = α(m) ∧β(m).
Then α ∧β ∈Ωk+l(M), and ∧is bilinear and associative.

6.3 Diﬀerential Forms
359
Proof.
First, ∧is bilinear and associative since it is true pointwise. To show α∧β is of class C∞, consider
the local representative of α ∧β in natural charts. This is a map of the form (α ∧β)ϕ = B ◦(αϕ × βϕ), with
αϕ, βϕ ∈C∞and B = ∧, which is bilinear and continuous. Thus (α ∧β)ϕ is C∞by the Leibniz rule.
■
6.3.7 Deﬁnition.
Let Ω(M) denote the direct sum of the spaces Ωk(M), k = 0, 1, . . . , together with its
structure as an (inﬁnite-dimensional) real vector space and with the multiplication ∧extended componentwise
to Ω(M). (If dim M = n < ∞, the direct sum need only be taken for k = 0, 1, . . . , n.) We call Ω(M) the
algebra of exterior diﬀerential forms on M. Elements of Ωk(M) are called k-forms. In particular,
elements of X∗(M) are called one-forms.
Note that we generally regard Ω(M) as a real vector space rather than an F(M) module (as with T (M)).
The reason is that F(M) = Ω0(M) is included in the direct sum, and f ∧α = f ⊗α = fα.
6.3.8 Examples.
A.
A one-form θ on a manifold M assigns to each m ∈M a linear functional on TmM.
B.
A two-form ω on a manifold assigns to each m ∈M a skew symmetric bilinear map
ωm : TmM × TmM →R.
C.
For an n-manifold M, a tensor ﬁeld t ∈T r
s (M) has the local expression
t(u) = ti1···ir
j1···js(u) ∂
∂xi1 ⊗· · · ⊗
∂
∂xir ⊗dxj1 ⊗· · · ⊗dxjs,
where u ∈U, (U, ϕ) is a local chart on M, and
ti1···ir
j1···js(u) = t

dxi1, · · · , dxir,
∂
∂xj1 , · · · ,
∂
∂xjs

(u).
The proof of Proposition 6.1.8 gives the local expression for ω ∈k(M), namely
ω(u) = ωi1···ik(u)dxi1 ∧· · · ∧dxik,
i1 < · · · < ik,
where
ωi1···ik(u) = ω
 ∂
∂xi1 , · · · ,
∂
∂xik

(u).
D.
In Ω(M), the addition of forms of diﬀerent degree is “purely formal” as in the case M = E. Thus, for
example, if M is a two-manifold (a surface) and (x, y) are local coordinates on U ⊂M, a typical element of
Ω(M) has the local expression f + g dx + h dy + k dx ∧dy, for f, g, h, k ∈F(U).
E.
As in §6.1, we have an isomorphism of vector bundles ∗: 1(R3) →2(R3) given by
dx1 →dx2 ∧dx3,
dx2 →dx3 ∧dx1,
dx3 →dx1 ∧dx2.
On the other hand, the index lowering action given by the standard Riemannian metric on R3 deﬁnes a
vector bundle isomorphism ♭: T(R3) →T ∗(R3) = 1(R3). These two isomorphisms applied pointwise deﬁne
maps
∗: X∗(R3) →Ω2,
α →∗α

360
6. Diﬀerential Forms
and
♭: X(R3) →X∗(R3),
X →X♭.
Then Example 6.1.12C implies
∗[(X × Y )♭] = X♭∧Y ♭
for any vector ﬁelds X, Y ∈X(R3) where X × Y denotes the usual cross–product of vector ﬁelds on R3 from
calculus. That is,
X × Y =

X2Y 3 −X3Y 2 ∂
∂x1 +

X3Y 1 −X1Y 3 ∂
∂x2
+

X1Y 2 −X2Y 1 ∂
∂x3
where X = Xi ∂
∂xi and Y = Y i ∂
∂xi , i = 1, 2, 3.
F.
The wedge product is taken in Ω(M) in the same way as in the algebraic case. For example, if M = R3,
α = dx1 −x1dx2 ∈Ω1(M) and β = x2dx1 ∧dx3 −dx2 ∧dx3, then
α ∧β = (dx1 −x1dx2) ∧(x2dx1 ∧dx3 −dx2 ∧dx3)
= 0 −x1x2dx2 ∧dx1 ∧dx3 −dx1 ∧dx2 ∧dx3 + 0
= (x1x2 −1)dx1 ∧dx2 ∧dx3.
♦
Pull-back and Push-forward of Forms.
We can now extend the pull-back and push-forward operations
from the context of vector spaces and linear maps to that of manifolds and nonlinear maps.
6.3.9 Deﬁnition.
Suppose F : M →N is a C∞mapping of manifolds. For ω ∈Ωk(N), deﬁne F ∗ω :
M →k(M) by F ∗ω(m) = (TmF)∗◦ω ◦F(m); that is,
(F ∗ω)m(v1, . . . , vk) = ωF (m)(TmF · v1, . . . , TmF · vk),
where v1, . . . , vk ∈TmM; for g ∈Ω0(N), F ∗g = g ◦F. We say F ∗ω is the pull-back of ω by F. (See Figure
6.3.1.)
6.3.10 Proposition.
Let F : M →N and G : N →W be C∞mappings of manifolds. Then
(i) F ∗: Ωk(N) →Ωk(M);
(ii) (G ◦F)∗= F ∗◦G∗;
(iii) if H : M →M is the identity, then H∗: Ωk(M) →Ωk(M) is the identity;
(iv) if F is a diﬀeomorphism, then F ∗is an isomorphism and
(F ∗)−1 =

F −1∗;
(v) F ∗(α ∧β) = F ∗α ∧F ∗β for α ∈Ωk(N) and β ∈Ωl(N).
Proof.
Choose charts (U, ϕ), (V, ψ) of M and N so that F(U) ⊂V . Then the local representative Fϕψ =
ψ ◦F ◦ϕ−1 is of class C∞, as is ωψ = (Tψ)∗◦ω ◦ψ−1. The local representative of F ∗ω is
(F ∗ω)ϕ(u) = (Tϕ)∗◦F ∗ω ◦ϕ−1(u) = (TuFϕψ)∗◦ωψ ◦Fϕψ(u)
which is of class C∞by the composite mapping theorem.
For (ii), note that it holds for the local representatives; (iii) follows from the deﬁnition; (iv) follows in the
usual way from (ii) and (iii); and (v) follows from the corresponding pointwise result.
■

6.3 Diﬀerential Forms
361
F*ω
F*
F
ω
F(m)
N
M
m
Figure 6.3.1. Pulling back forms
Vector Bundle Valued Forms (Optional).
We close this section with a few optional remarks about
vector-bundle-valued forms. As before, the idea is to globalize vector-valued exterior forms.
6.3.11 Deﬁnition.
Let π : ˆE →B, ρ : ˆF →B be vector bundles over the same base. Deﬁne
k( ˆE; ˆF) = L
k( ˆE), ˆF

,
the vector bundle with base B of vector bundle homomorphisms over the identity from k( ˆE) to ˆF. If
ˆE = TB, k(TB; ˆF) is denoted by k(B; ˆF) and is called the vector bundle of F-valued k-forms on M.
If ˆF = B × F, we denote it by k(B, F) and call its elements vector-valued k-forms on M. The spaces
of sections of these bundles are denoted respectively by Ωk( ˆE; ˆF), Ωk(B; ˆF) and Ωk(B; F). Finally, Ω( ˆE; ˆF)
(resp., Ω(B; ˆF), Ω(B, F)) denotes the direct sum of Ωk( ˆE; ˆF), k = 1, 2, . . . , n, together with its structure of
an inﬁnite-dimensional real vector space and F(B)-module.
Thus, α ∈Ωk( ˆE; ˆF) is a smooth assignment to the points b of B of skew symmetric k-linear maps
αb : ˆEb×· · ·× ˆEb →ˆFb. In particular, if all manifolds and bundles are ﬁnite dimensional, then α ∈Ωk(M, Rp)
may be uniquely written in the form α = Σi=1,...,pαiej, where α1, . . . , αp ∈Ωk(M), and {e1, . . . , ep} is the
standard basis of Rp. Thus α ∈Ωk(E, Rp) is written in local coordinates as
(α1
i1···ikdxi1 ∧· · · ∧dxik, . . . , αp
i1···ikdxi1 ∧· · · ∧dxik)
for i1 < · · · < ik. Proposition 6.3.10(i)–(iv) and its proof have straightforward generalizations to vector-
bundle-valued forms on M. The wedge product requires additional structure to be deﬁned, namely a smooth
assignment b →gb of a symmetric bilinear map gb : ˆFb × ˆFb →ˆFb for each b ∈B. With this structure,
Proposition 6.3.10(v) also carries over.
Exercises
⋄6.3-1.
Show that for a vector bundle π : E →B, k(E) is a (smooth) subbundle of T 0
k (E). Generalize to
vector-bundle-valued tensors and forms.
⋄6.3-2.
Let ϕ : R3 →R2 be given by ϕ(x, y, z) = (x2, yz). For
α = v2du + dv ∈Ω1 
R2
and
β = uvdu ∧dv ∈Ω2 
R2
,
compute α ∧β, ϕ∗α, ϕ∗β, and ϕ∗(α ∧β).

362
6. Diﬀerential Forms
⋄6.3-3 (E. Cartan’s lemma).
Let M be an n-manifold and suppose that α1, . . . , αk ∈Ω1(M), k ≤n, are
pointwise linearly independent. Show that β1, . . . , βk ∈Ω1(M) satisfy Σ1≤i≤kαi ∧βi = 0 iﬀthere exist C∞
functions aj
i ∈F(M) satisfying aj
i = ai
j such that βj = aj
iβi.
Hint: Work in a local chart and show ﬁrst that αi can be chosen to be dxi; the symmetry of the matrix
[aj
i] follows from antisymmetry of ∧and the given condition.
⋄6.3-4.
A (strong) bundle metric g on a vector bundle π : E →B is a smooth section of L2
s(E; R)
such that g(b) is an inner product on Eb for every b ∈B which is (strongly) nondegenerate, that is,
eb ∈Eb →g(b)(eb, ·) ∈E∗
b is an isomorphism of Banach spaces.
(i) Show that the model of the ﬁber of E is a Hilbertizable space.
(ii) If F ⊂E is a subbundle of E, show that F ⊥= 
b∈B F ⊥
b is a subbundle of E, where we deﬁne
F ⊥
b = { eb ∈Eb | g(b) (eb, fb) = 0 for all fb ∈Fb } .
(iii) Show that E = F ⊕F ⊥.
⋄6.3-5.
Assume the vector bundle π : E →B has a strong bundle metric.
(i) If σ : B →E is a smooth nowhere vanishing section of E, let Fb = span{σ(b)}, F = 
b∈B Fb. Show
that F is a subbundle of E which is isomorphic to the trivial bundle E1
B = R × B. Conclude from
Exercise 6.3-4 that E1 ⊕(E1)⊥= E.
(ii) Show that a manifold M is parallelizable if and only if TM is isomorphic to a trivial bundle.
(iii) Assume that M is a strong Riemannian manifold, admits a nowhere vanishing vector ﬁeld and that
TM ⊕E1
M is isomorphic to a trivial bundle. Let N be another manifold of dimension ≥1 such that
TN ⊕ˆE1
N is trivial. Show that M × N is parallelizable.
Hint: Use (i) and pull everything back to M × N by the two projections.
(iv) Show that if dim N = 0, the conclusion of (ii) is false.
Hint: It is know that the only odd dimensional spheres with trivial tangent bundle are S1, S3 and
S7. Show that TS2n−1 has a nowhere vanishing vector ﬁeld.
(v) Show that Sa(1) × · · · × Sa(n) is parallelizable provided that a(i) ≥1, i = 1, . . . , n and at least one a(i)
is odd.
Hint: Use (iii) and Exercise 3.4-3.
6.4
The Exterior Derivative, Interior Product, and Lie
Derivative
The purpose of this section is to extend the diﬀerential of functions to a map
d : Ωk(M) →Ωk+1(M)
deﬁned for any k. This operator turns out to have marvelous algebraic properties. After studying these we
shall show how d is related to the basic operations of div, grad and curl on R3. Then we develop formulas
for the Lie derivative.

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
363
The Exterior Derivative.
We ﬁrst develop the exterior derivative d for ﬁnite-dimensional manifolds.
The inﬁnite-dimensional case is discussed in Supplement 6.4A.
6.4.1 Theorem.
Let M be an n-dimensional manifold. There is a unique family of mappings dk(U) :
Ωk(U) →Ωk+1(U) (k = 0, 1, 2, . . . , n and U is open in M) which were merely denote by d, called the
exterior derivative on M, such that
(i) d is a ∧-antiderivation. That is, d is R linear and for α ∈Ωk(U) and β ∈Ωl(U),
d(α ∧β) = dα ∧β + (−1)kα ∧dβ
(product rule);
(ii) If f ∈F(U), then df is as deﬁned in Deﬁnition 4.2.5;
(iii) d2 = d ◦d = 0, (i.e., dk+1(U) ◦dk(U) = 0);
(iv) d is natural with respect to restrictions; that is, if U ⊂V ⊂M are open and α ∈Ωk(V ), then
d(α|U) = (dα)|U,
that is, or the following diagram commutes:
Ωk(V )
Ωk(U)
Ωk+1(V )
Ωk+1(U)
|U
|U
d
d
✲
✲
❄
❄
As usual, condition (iv) means that d is a local operator.
Proof.
We ﬁrst establish uniqueness. Let (U, ϕ) be a chart, where ϕ(u) =

x1, . . . , xn
, and let
α = αi1···ikdxi1 ∧· · · ∧dxik ∈Ωk(U),
i1 < · · · < ik.
If k = 0, by (ii), the local formula dα =

∂α/∂xi
dxi applied to the coordinate functions xi, i = 1, . . . , n
shows that the diﬀerential of xi is the one-form dxi. From (iii), d(dxi) = 0, so by (i)
d

dxi1 ∧· · · ∧dxik
= 0.
Thus, again by (i),
dα = ∂αi1···ik
∂xi
dxi ∧dxi1 ∧· · · ∧dxik,
(sum over i1 < · · · < ik),
(6.4.1)
and so d is uniquely deﬁned on U by properties (i)–(iii), and by (iv) on any open subset of M.
For existence, deﬁne on every chart (U, ϕ) the operator d by formula (6.4.1). Then (ii) is trivially veriﬁed
as is R-linearity. If
β = βj1···jldxj1 ∧· · · ∧dxjl ∈Ωl(U),

364
6. Diﬀerential Forms
then
d(α ∧β) = d

αi1···ikβj1···jldxi1 ∧· · · ∧dxik ∧dxj1 ∧· · · dxjl
=
∂αi1···ik
∂xi
βj1···jl + αi1···ik
∂βj1···jl
∂xi

dxi ∧dxi1 ∧· · · ∧dxik
∧dxj1 ∧· · · ∧dxjl
= ∂αi1···ik
∂xi
dxi ∧dxi1 ∧· · · ∧dxik ∧βj1...jldxj1 ∧· · · ∧dxjl
+ (−1)kαi1···ikdxi1 ∧· · · ∧dxik ∧∂βj1···jl
∂xi
dxi ∧dxj1 ∧· · · ∧dxjl
= dα ∧β + (−1)kα ∧dβ.
and (i) is veriﬁed. For (iii), the symmetry of the second partial derivatives shows that
d(dα) = ∂2αi1···ik
∂xi∂xj dxi ∧dxj ∧dxj1 ∧· · · ∧dxik = 0,
i1 < · · · < ik.
Thus, in every chart (U, ϕ), equation (6.4.1) deﬁnes the operator d satisfying (i)–(iii). It remains to be shown
that these local d’s deﬁne an operator d on any open set and (iv) holds. To do this, it is suﬃcient to show
that this deﬁnition is chart independent. Let d′ be the operator given by equation (6.4.1) on a chart (U ′, ϕ′),
where U ′ ∩U ̸= ∅. Since d′ also satisﬁes (i)–(iii), and local uniqueness has already been proved, d′α = dα
on U ∩U ′. The theorem thus follows.
■
6.4.2 Corollary.
Let ω ∈Ωk(U), where U ⊂E is open. Then
dω(u) (v0, . . . , vk) =
k

i=0
(−1)i Dω(u) · vi (v0, . . . , ˆvi, . . . , vk)
(6.4.2)
where ˆvi denotes that vi is deleted. Also, we denote elements (u, v) of TU merely by v for brevity. (Note that
Dω(u) · v ∈Lk
a(E, R) since ω : U →Lk
a(E, R).)
Proof.
Since we are in the ﬁnite dimensional case, we can proceed with a coordinate computation. (An
alternative is to check out that d deﬁned by equation (6.4.2) satisﬁes (i) to (iv). Checking (i) and (iii) is
straightforward but lengthy.) Indeed, if the local coordinates of u are

x1, . . . , xn
,
ω(u) = ωi1···ik(u)dxi1 ∧· · · ∧dxik
(sum over i1 < · · · < ik), then
Dω(u) · vi = ∂ωi1···ik
∂xj
vj
i dxi1 ∧· · · ∧dxik
(where the sum is over all j and i1 < · · · < ik). From equation (6.4.1),
dω (v0, . . . , vk) = ∂ωi1 . . .ik
∂xj
dxj ∧dxi1 ∧· · · ∧dxik (v0, . . . , vk)
= ∂ωi1 . . .ik
∂xj
(sign σ)vσ(j)
0
vσ(i1)
1
· · · vσ(ik)
k
(6.4.3)
(where the sum is over all i1 < · · · < ik, j, and σ’s satisfying σ(j) < σ(i1) < · · · < σ(ik)). The right hand
side of equation (6.4.2) is
(−1)i ∂ωi1···ik
∂xj
vj
i (sign η) vη(i1)
0
· · · ˆvi
η(ij) · · · vη(ik)
k
(6.4.4)

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
365
(where the sum is over all i1 < · · · < ik, j, i, and η’s with η(i1) < · · · < η(ik)). Writing σ as a product of
a permutation moving j to a designated position and a permutation η, we see that equations (6.4.3) and
(6.4.4) coincide.
■
6.4.3 Examples.
A.
On R2, let α = f(x, y)dx + g(x, y)dy. Then dα = df ∧dx + fd(dx) + dg ∧dy + gd(dy) by linearity
and the product rule. Since d2 = 0,
dα = df ∧dx + dg ∧dy
=
∂f
∂xdx + ∂f
∂y dy

∧dx +
∂g
∂xdx + ∂g
∂y dy

∧dy.
Since dx ∧dx = 0 and dy ∧dy = 0, this becomes
dα = ∂f
∂y dy ∧dx + ∂g
∂xdx ∧dy =
∂g
∂x −∂f
∂y

dx ∧dy.
B.
On R3, let f(x, y, z) be given. Then
df = ∂f
∂xdx + ∂f
∂y dy + ∂f
∂z dz,
so the components of df are those of grad f. That is, (grad f)♭= df, where ♭is the index lowering operator
deﬁned by the standard metric of R3 (see §5.1).
C.
On R3, let F♭= F1(x, y, z)dx + F2(x, y, z)dy + F3(x, y, z)dz. Computing as in Example A yields
dF♭=
∂F2
∂x −∂F1
∂y

dx ∧dy −
∂F1
∂z −∂F3
∂x

dx ∧dz
+
∂F3
∂y −∂F2
∂z

dy ∧dz.
Thus associated to each vector ﬁeld G = G1i+G2j+G3k on R3 is the one-form G♭and to this the two-form
∗

G♭
by
∗

G♭
= G3dx ∧dy −G2dx ∧dz + G1dy ∧dz,
where ∗is the Hodge operator (see §6.2); it is clear the dF♭= ∗(curl F)♭.
D.
The divergence is obtained from d by
d∗F♭= (div F)dx ∧dy ∧dz;
that is,
∗d∗F♭= div F.
Thus associating to a vector ﬁeld F on R3 the one-form F♭and the two-form d∗F♭, gives rise to the operators
curl F and div F. From dF♭= ∗(curl F)♭it is apparent that
ddF♭= 0 = d∗(curl F)♭= (div curl F)dx ∧dy ∧dz.
That is, d2 = 0 gives the well-known vector identity div curl F = 0. Likewise, ddf = 0 becomes d(grad f)♭=
0; that is, ∗(curl grad f)♭= 0. So here d2 = 0 becomes the identity curl grad f = 0.
♦
We summarize the relationship between the operators in vector calculus and diﬀerential forms in the table
at the end of this section.

366
6. Diﬀerential Forms
Mappings and the Exterior Derivative.
We will now consider the eﬀect of mappings on the exterior
derivative operator d. Recall that Ω(M) is the direct sum of all the Ωk(M).
6.4.4 Theorem.
Let F : M →N be of class C1. Then F ∗: Ω(N) →Ω(M) is a homomorphism of
diﬀerential algebras; that is,
(i) F ∗(ψ ∧ω) = F ∗ψ ∧F ∗ω, and
(ii) d is natural with respect to mappings; that is,
F ∗(dω) = d (F ∗ω) ,
that is, the following diagram commutes:
Ωk (M)
Ωk (N)
Ωk+1 (M)
Ωk+1 (N)
F ∗
F ∗
d
d
✛
✛
❄
❄
Proof.
Part (i) was established in Proposition 6.3.10. For (ii), we shall show that if m ∈M, then there
is a neighborhood U of m ∈M such that d(F ∗ω|U) = (F ∗dω)|U, which is suﬃcient, as F ∗and d are both
natural with respect to restriction. Let (V, ϕ) be a local chart at F(m) and U a neighborhood of m ∈M
with F(U) ⊂V . Then for ω ∈Ωk (V ), we can write
ω = ωi1···ikdxi1 ∧· · · ∧dxik
(sum over i1 < · · · < ik)
and so dω = ∂i0ωi1···ikdxi0 ∧dxi1 ∧· · · ∧dxik, where ∂i0 = ∂/∂xi0 (sum over i0 and i1 < · · · < ik) and by (i)
F ∗ω|U = (F ∗ωi1···ik) F ∗dxi1 ∧· · · ∧F ∗dxik.
If ψ ∈Ω0(N) then d(F ∗ψ) = F ∗dψ by the composite mapping theorem, so by (i) and d ◦d = 0, we get
d(F ∗ω|U) = F ∗(dωi1···ik) ∧F ∗dxi1 ∧· · · ∧F ∗dxik = F ∗(dω)|U.
■
6.4.5 Corollary.
The operator d is natural with respect to push-forward by diﬀeomorphisms. That is, if
F : M →N is a diﬀerent diﬀeomorphism, then F∗dω = dF∗ω, or the following diagram commutes:
Ωk(M)
Ωk(N)
Ωk+1(M)
Ωk+1(N)
F∗
F∗
d
d
✲
✲
❄
❄
Proof.
Since F∗=

F −1∗, the result follows from Theorem 6.4.4(ii).
■

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
367
6.4.6 Corollary.
Let X ∈X(M). Then d is natural with respect to £X. That is, for ω ∈Ωk (M) we have
£Xω ∈Ωk (M) and
d£Xω = £Xdω,
that is, the following diagram commutes:
Ωk(M)
Ωk(M)
Ωk+1(M)
Ωk+1(M)
£X
£X
d
d
✲
✲
❄
❄
Proof.
Let Ft be the (local) ﬂow of X. Then we know that
£Xω (m) = d
dt (F ∗
t ω) (m)

t=0
.
Since F ∗
t ω ∈Ωk (M), it follows that £Xω ∈Ωk (M). Now we have F ∗
t dω = d (F ∗
t ω). Then, since d is
R-linear, it commutes with d/dt and so taking the derivative of this relation at t = 0, we get £Xdω =
d£Xdω.
■
Interior Products.
In Chapter 5, contractions of general tensor ﬁelds were studied. For diﬀerential forms,
contractions play a special role.
6.4.7 Deﬁnition.
Let M be a manifold, X ∈X (M), and ω ∈Ωk+1 (M). Then deﬁne iXω ∈T 0
k (M) by
iXω(X1, . . . , Xk) = ω(X, X1, . . . , Xk).
if ω ∈Ω0 (M), we put iXω = 0. We call iXω the interior product or contraction of X and ω. (Sometimes
X
ω is written for iXω.)
6.4.8 Theorem.
We have iX : Ωk(M) →Ωk−1(M), k = 1, . . . , n, and if α ∈Ωk(M), β ∈Ωl(M), and
f ∈Ω0(M), then
(i) iX is a ∧-antiderivation; that is iX is R-linear and we have the identity iX(α ∧β) = (iXα) ∧β +
(−1)k α ∧(iXβ);
(ii) ifXα = fiXα;
(iii) iXdf = £Xf;
(iv) £X(α ∧β) = £Xα ∧β + α ∧£Xβ;
(v) £Xα = iXdα + diXα;
(vi) £fXα = f£Xα + df ∧iXα.
Proof.
That iXα ∈Ωk−1 (M) follows from the deﬁnitions. For (i), R-linearity is clear. For the second part
of (i), write
iX(α ∧β)(X2, X3, . . . , Xk+l) = (α ∧β)(X, X2, . . . , Xk+l)

368
6. Diﬀerential Forms
and
iXα ∧β + (−1)kα ∧iXβ = (k + l −1)!
(k −1)!l! A (iXα ⊗β)
+ (−1)k (k + l −1)!
k!(l −1)! A(α ⊗iXβ).
Now write out the deﬁnition of A in terms of permutations from Deﬁnition 6.1.1. The sum over all permu-
tations in the last term can be replaced by the sum over σσ0, where σ0 is the permutation
(2, 3, . . . , k + 1, 1, k + 2, . . . k + l) →(1, 2, 3, . . . , k + l),
whose sign is (−1)k. Hence (i) follows. For (ii), we note that α is F(M)-multilinear, and (iii) is just the
deﬁnition of £Xf.
Part (iv) follows from the fact that £X is a tensor derivation and commutes with the alternation operator
A. (It also follows from the formula for £X in terms of ﬂows.) For (v) we proceed by induction on k. First
note that for k = 0, (iv) reduces to (iii). Now assume that (v) holds for k. Then a (k + 1)-form may be
written as  dfi ∧ωi, where ωi is a k form, in some neighborhood of m ∈M. But
£X (df ∧ω) = £Xdf ∧ω + df ∧£Xω
by (iv), so
iXd(df ∧ω) + diX(df ∧ω)
= −iX(df ∧dω) + d(iXdf ∧ω −df ∧iXω)
= −iXdf ∧dω + df ∧iXdω + diXdf ∧ω
+ iXdf ∧dω + df ∧diXω
= df ∧£Xω + d£Xf ∧ω
by the inductive assumption and (iii). Since d£Xf = £Xdf, the result follows.
Finally, for (vi) we have
£fXα = ifXdα + difXα = fiXdα + d (fiXα)
(6.4.5)
= fiXdα + df ∧iXα + fdiXα = f£Xα + df ∧iXα.
■
Note that proofs of (i), (ii) and (iii) are valid without change on Banach manifolds. Formula (v)
£Xα = iXdα + diXα
(6.4.6)
(a “magic” formula of Cartan) is particularly useful. It can be used in the following way.
6.4.9 Examples.
A.
If α is a k-form such that dα = 0 and X is a vector ﬁeld such that diXα = 0, then F ∗
t α = α, where Ft
is the ﬂow of X. Indeed,
d
dtF ∗
t α = F ∗
t £Xα = F ∗
t (iXdα + d(iXα)) = 0.
so F ∗
t α is constant in t. Since F0 = identity, F ∗
t α = α for all t.

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
369
B.
Let M = R3, suppose div X = 0, and let α = dx ∧dy ∧dz. Thus dα = 0. Also,
iXα = iX(dx ∧dy ∧dz) = X1dy ∧dz −X2dx ∧dz + X3dx ∧dy = ∗X♭.
so diXα = d∗X♭= ∗(div X) = 0. Thus by Example A,
F ∗
t (dx ∧dy ∧dz) = dx ∧dy ∧dz.
As we shall see in the next section in a more general context, this means that the ﬂow of X is volume
preserving. Of course this can be proved directly as well by diﬀerentiating the determinant of the Jacobian
matrix of Ft in t (see, for example, Chorin and Marsden [1993]). For related applications to ﬂuid mechanics,
see §8.2.
♦
Mappings and the Interior Product.
The behavior of contractions under mappings is given by the
following proposition. (The statement and proof also hold for Banach manifolds.)
6.4.10 Proposition.
Let M and N be manifolds and F : M →N a C1 mapping. If ω ∈Ωk(N), X ∈
X(N), Y ∈X(M), and Y is F-related to X, then
iY F ∗ω = F ∗iXω.
In particular, if F is a diﬀeomorphisms, then
iF ∗XF ∗ω = F ∗iXω.
That is, interior products are natural with respect to diﬀeomorphisms and the following diagram commutes:
Ωk(N)
Ωk(M)
Ωk−1(N)
Ωk−1(M)
F ∗
F ∗
iX
iF ∗X
✲
✲
❄
❄
Similarly for Y ∈X (M) we have the following commutative diagram:
Ωk(M)
Ωk(N)
Ωk−1(M)
Ωk−1(N)
F∗
F∗
iY
iF∗Y
✲
✲
❄
❄
Proof.
Let v1, . . . , vk−1 ∈Tm(M) and n = F(m). Then
iY F ∗ω(m) · (v1, . . . , vk−1) = F ∗ω(m) · (Y (m), v1, . . . , vk−1)
= ω(n) · ((TF ◦Y )(m), TF(v1), . . . , TF(vk−1))
= ω(n)((X ◦F)(m), TF(v1), . . . , TF(vk−1))
= iXω(n) · (TF(v1), . . . , TF(vk−1))
= F ∗iXω(m) · (v1, . . . , vk−1).
■

370
6. Diﬀerential Forms
The Lie Derivative and the Exterior Derivative.
The next proposition expresses d in terms of the
Lie derivatives (see Palais [1954]).
6.4.11 Proposition.
Let Xi ∈X (M), i = 0, . . . , k, and ω ∈Ωk (M). Then we have
(i)
(£X0ω)(X1, . . . , Xk)
= £X0(ω(X1, . . . , Xk)) −
k

i=1
ω(X1, . . . , £X0Xi, . . . , Xk)
and
(ii)
dω(X0, X1, . . . , Xk)
=
k

l=0
(−1)l£Xl(ω(X0, . . . , ˆ
Xl, . . . , Xk))
+

0≤i<j≤k
(−1)i+jω(£Xi(Xj), X0, . . . , ˆ
Xi, . . . , ˆ
Xj, . . . , Xk)
where ˆ
Xi denotes that Xi is deleted.
Proof.
Part (i) is condition DO1 in Deﬁnition 5.3.1. For (ii) we proceed by induction. For k = 0, it is
merely dω (X0) = £X0ω. Assume the formula for k −1. Then if ω ∈Ωk (M) we have, by Cartan’s formula
(6.4.6) and (i)
dω(X0, X1, . . . , Xk)
= (iX0dω)(X1, . . . , Xk)
= (£X0ω)(X1, . . . , Xk) −(d(iX0ω))(X1, · · · , Xk)
= £X0(ω(X1, . . . , Xk)) −
k

l=1
ω(X1, . . . , £X0Xl, . . . , Xk)
−(diX0ω)(X1, . . . , Xk)
But iX0ω ∈Ωk−1(M) and we may apply the induction assumption. This gives, after a permutation
(d(iX0ω))(X1, . . . , Xk)
=
k

l=1
(−1)l−1£Xl(ω(X0, X1, . . . , ˆ
Xl, . . . , Xj))
−

1≤i<j≤k
(−1)i+jω(£XiXj, X0, X1, . . . , ˆ
Xi, . . . , ˆ
Xj, . . . , Xk).
Substituting this into the foregoing yields the result.
■
Note that the proof of (i) and the ﬁrst formula in the next corollary holds as well for inﬁnite-dimensional
manifolds.
6.4.12 Corollary.
Let X, Y ∈X(M). Then
[£X, iY ] = i[X,Y ]
and
[£X, £Y ] = £[X,Y ]
In particular, iX ◦£X = £X ◦iX.

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
371
Proof.
It is suﬃcient to check the ﬁrst formula on any k-form ω ∈Ωk(U) and any X1, . . . , Xk−1 ∈X(U)
for any open set U of M. Proposition 6.4.11(i) gives
(iY £Xω)(X1, . . . , Xk−1)
= (£Xω)(Y, X1, . . . , Xk−1)
= £X(ω(Y, X1, . . . , Xk−1))
−
k−1

l=1
ω(Y, X1, . . . [X, Xl], . . . , Xk−1) −ω([X, Y ], X1, . . . , Xk−1)
= £X((iY ω)(X1, . . . , Xk−1))
−
k−1

l=1
(iY ω)(X1, . . . , [X, Xl], . . . , Xk−1) −

i[X,Y ]ω

(X1, . . . , Xk−1)
= (£XiY ω)(X1, . . . Xk−1) −(i[X,Y ]ω)(X1, . . . , Xk−1).
One proves [£X, £Y ] = £[X,Y ] using the ﬁrst relation and Cartan’s formula (6.4.6).
■
Supplement 6.4A
The Exterior derivative on Inﬁnite-dimensional Manifolds
Now we discus the exterior derivative on inﬁnite-dimensional manifolds. Theorem 6.4.1 is rather awkward,
primarily because we cannot, without a lot of technicalities, pass from, for example, one-forms to two-forms
by linear combinations of decomposable two-forms, that is, two-forms of the type α ∧β. However, there is
a simpler alternative available.
1. Adopt the formula in Proposition 6.4.11(ii) as the deﬁnition of d on any open subset of M. Note that
at ﬁrst it is deﬁned as a multilinear function on vector ﬁelds and note that £X is already deﬁned.
2. In charts, the equation of Proposition 6.4.11(ii) reduces to the local formula (6.4.2). This or a direct
computation shows that d : Ωk(M) →Ωk+1(M) is well deﬁned, depending only on the point values of
the vector ﬁelds.
3. One checks the basic properties of d. This can be done in two ways: directly, using the local formula,
or using the deﬁnition and the following lemma, easily deducible from the Hahn–Banach theorem: if
a k-form ω is zero on any set of k vector ﬁelds X1, . . . , Xk ∈X(U) for all open sets U in M, then
ω = 0. This second method is slightly faster if one ﬁrst proves formula (6.4.6), which in turn implies
Corollary 6.4.12.

372
6. Diﬀerential Forms
Proof of formula (6.4.6).
Let α be a k-form and X1, . . . , Xk be a set of k vector ﬁelds deﬁned on some
open subset of M. Writing X0 = X, we have
(iXdα + diXα)(X1, . . . , Xk)
= dα(X, X1, . . . , Xk) + d(iXα)(X1, . . . , Xk)
=
k

l=0
(−1)l£Xl(α(X0, . . . , ˆ
Xl, . . . , Xk))
+

0≤i<j≤k
(−1)i+jα(£XiXj, X0, . . . , ˆ
Xi, . . . , ˆ
Xj, . . . , Xk)
+
k

l=1
(−1)l−1£Xl(α(X0, X1, . . . , ˆ
Xl, . . . , Xk))
−

1≤i<j≤k
(−1)i+jα(£X0Xj, X0, X1, . . . , ˆ
Xi, . . . , ˆ
Xj, . . . , Xk)
= £X0(α(X1, . . . , Xk)) +
k

j=1
(−1)jα(£X0Xj, X1, . . . , ˆ
Xj, . . . , Xk)
= (£Xα)(X1, . . . , Xk)
(by Proposition 6.4.11(ii)).
■
This and corollary 6.4.12 will allow us to give a proof of the inﬁnite-dimensional version of Corollary 6.4.6
:
£X ◦d = d ◦£X
For functions f this formula is proved as follows. By Proposition 6.4.11(ii),
(£Xdf)(Y ) = £X(df(Y )) −df([X, Y ]) = X[Y [f]] −[X, Y ][f]
= Y [X[f]] = d(X[f])(Y ) = (d£Xf)(Y ).
Inductively, assume the formula holds for (k−1)-forms. Then for any k-form α and any vector ﬁeld Y deﬁned
an open subset of M, d£XiY α = £XdiY α. Thus by Corollary 6.4.12,
iY d£Xα = £Y £Xα −diY £Xα
= £X£Y α −£[X,Y ]α + di[X,Y ]α −d£XiY α
= £X£Y α −£XdiY α −i[X,Y ]dα
= £XiY dα −i[X,Y ]dα
= iY £Xdα.
Hence d ◦£X = £X ◦d.
Next, the remaining properties of d are checked in the following way. R-linearity and Theorem 6.4.1(iv)
are immediate consequences of the deﬁnition. For Theorem 6.4.1(ii), note that
df(X) = iXdf = £Xf −diXf = £Xf = X[f].
To show that d2 = 0, ﬁrst observe that
iX ◦d ◦d = £X ◦d −d ◦iX ◦d
= d ◦£X −d ◦£X + d ◦d ◦iX
= d ◦d ◦iX,

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
373
so that for any k-form α and any vector ﬁelds X1, . . . , Xk+2, we have
(ddα)(X1, . . . , Xk+2) = iXk+2 . . . iX1ddα = iXk+2 · · · iX2ddiX1α
= · · · = iXk+2ddiXk+1 . . . iX1α
= iXk+2ddiXk+1(α(X1, . . . , Xk))
= 0.
The antiderivation property of d is proved by induction using equation (6.4.6) and the antiderivation property
for the interior products. Finally, the formula F ∗◦d = d ◦F ∗for a map F follows by deﬁnition and the
properties
F ∗(£Xω) = £X(F ∗ω),
(F ∗ω)(X1, . . . , Xk) = F ∗(ω(X′
1, . . . , X′
k)),
F ∗[X, Y ] = [X′, Y ′]
if Xi ∼F X′, i = 1, . . . , k, X ∼F X′, and Y ∼F Y ′. Thus, with the preceding procedure, d is deﬁned on
Banach manifolds and satisﬁes all the key properties that it does in the ﬁnite-dimensional case. These key
properties are summarized at the end of this section.
Vector Valued Forms.
For vector-valued forms, we adopt, as in the preceding supplement, Palais’ for-
mula from Proposition 6.4.11(ii) as the deﬁnition of d on an open subset of M. Note again that this deﬁnition
uses the fact that £X is deﬁned for vector-valued tensors, and again one has to prove that the local formula
in Corollary 6.4.2 holds. Then all properties in the table at the end of this section are veriﬁed in the same
manner as previously.
For vector-valued forms we have an additional formula on Ωk(M; F)
d ◦A = A ◦d
for any A ∈L(F, F ′). If F is ﬁnite dimensional, the deﬁnition and properties of d become quite obvious;
one notices that if
ω =
n

j=1
ωjfj ∈Ωk(M; F),
where ωj ∈Ωk(M) and f1, . . . , fn is a basis of F, then dω is given by
dω =
n

j=1
dωjfj
and this formula can be taken as the deﬁnition of d in this case. This method does not work for vector-bundle
valued forms. Additional structure on the bundle is required to be able to lift £X.
Closed and Exact Forms and the Poincar´e Lemma.
The Poincar´e lemma is a generalization and
uniﬁcation of two well-known facts in vector calculus:
1. if curl F = 0,then locally F = ∇f;
2. if div F = 0, then locally F = curl G.
6.4.13 Deﬁnition.
We call ω ∈Ωk(M) closed if dω = 0, and exact if there is an α ∈Ωk−1(M) such
that ω = dα.

374
6. Diﬀerential Forms
6.4.14 Theorem.
The following hold:
(i) Every exact form is closed.
(ii) Poincar´e Lemma.
If ω is closed, then for each m ∈M, there is a neighborhood U for which
ω|U ∈Ωk(U) is exact.
Proof.
Part (i) is clear since d ◦d = 0. Using a local chart it is suﬃcient to consider the case ω ∈Ωk(U),
where U ⊂E is a disk about 0 ∈E, to prove (ii). On U we construct an R-linear mapping H : Ωk(U) →
Ωk−1(U) such that d ◦H + H ◦d is the identity on Ωk(U). This will give the result, for dω = 0 implies
d(Hω) = ω. For e1, . . . , ek ∈E, deﬁne
Hω(u)(e1, . . . , ek−1) =
 1
0
tk−1ω(tu)(u, e1, . . . , ek−1)dt.
By Corollary 6.4.2,
dHω(u) · (e1, . . . , ek) =
k

i=1
(−1)i+1DHω(u) · ei(e1, . . . , ˆei, . . . , ek)
=
k

i=1
(−1)i+1
 1
0
tk−1ω(tu)(ei, e1, . . . , ˆei, . . . , ek)dt
+
k

i=1
(−1)i+1
 1
0
tkDω(tu) · ei(u, e1, . . . , ˆei, . . . , ek)dt.
(The interchange of D and the integral is permissible, as ω is smooth and bounded as a function of t ∈[0, 1].)
However, we also have, by Corollary 6.4.2,
Hdω(u) · (e1, . . . , ek) =
 t
0
tkdω(tu)(u, e1, . . . , ek)dt
=
 t
0
tkDω(tu) · u(e1, . . . , ek)dt
+
k

i=1
(−1)i
 1
0
tkDω(tu) · ei(u, e1, . . . , ˆei, . . . , ek)dt.
Hence
[dHω(u) + HDω(u)](e1, . . . , ek) =
 1
0
ktk−1ω(tu) · (e1, . . . , ek)dt
+
 1
0
tkDω(tu) · u(e1, . . . , ek)dt
=
 1
0
d
dt[tkω(tu) · (e1, . . . , ek)]dt
= ω(u) · (e1, . . . , ek).
■
There is another proof of the Poncar´e lemma based on the Lie transform method 5.4.7. It will help the
reader master the proof of Darboux’ Theorem in §8.1 and is similar in spirit to the proof of Frobenius’
Theorem 4.4.3.

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
375
Alternative Proof of the Poincar´e Lemma.
Again let U be a ball about 0 in E. Let, for t > 0,
Ft(u) = tu. Thus, Ft is a diﬀeomorphism and, starting at t = 1, is generated by the time-dependent vector
ﬁeld
Xt(u) = u
t ;
that is, F1(u) = u and dFt(u)/dt = Xt(Ft(u)). Therefore, since ω is closed, Cartan’s magic formula gives
d
dtF ∗
t ω = F ∗
t £Xtω = d(F ∗
t iXtω).
For 0 < t0 ≤1, we get
ω −F ∗
t0ω = d
 1
t0
F ∗
t iXtω dt.
Letting t0 →0, we get ω = dβ, where
β =
 1
0
F ∗
t iXtω dt.
Explicitly,
βu(e1, . . . , ek−1) =
 1
0
tk−1ωtu(u, e1, . . . , ek−1) dt.
(Note that this formula for β agrees with that in the previous proof.)
■
Cohomology.
It is not true that closed forms are always exact (for example, on R2\{(0, 0)} or on a
sphere—see Exercise 6.4-4). In fact, the quotient groups of closed forms by exact forms (called the deRham
cohomology groups of M) are important algebraic objects attached to a manifold; they are discussed
further in §7.6. Below we shall prove that on smoothly contractible manifolds, closed forms are always exact.
6.4.15 Deﬁnition.
Let t ≥1. Two Cr maps f, g : M →N are said to be (properly) Cr-homotopic, if
there exists an ϵ > 0 and a Cr (proper) mapping F : ]−ϵ, 1 + ϵ[ × M →N such that F(0, m) = f(m), and
F(1, m) = g(m) for all m ∈M. The manifold M is called Cr-contractible if there exists a point m0 ∈M
and Cr-homotopy F of the constant map m →m0 with the identity map of M; F is called a Cr-contraction
of M to m0
The following theorem represents a veriﬁcation of the homotopy axiom for the deRham cohomology.
6.4.16 Theorem.
Let f, g : M →N be two (properly) Cr-homotopic maps and α ∈Ωk(N) a closed
k-form (with compact support) on N. Then g∗α −f ∗α ∈Ωk(M) is an exact k-form on M (with compact
support).
The proof is based on the following.
6.4.17 Lemma (Deformation Lemma).
For a Cr-manifold M, let the Cr mapping
it : M →]−ϵ, 1 + ϵ[ × M
be given by it(m) = (t, m). Deﬁne
H : Ωk+1(]−ϵ, 1 + ϵ[ × M) →Ωk(M)
by
Hα =
 1
0
i∗
s(i∂/∂tα)ds.
Then d ◦H + H ◦d = i∗
1 −i∗
0 .

376
6. Diﬀerential Forms
Proof.
Since the ﬂow of the vector ﬁeld ∂/∂t ∈X(]−ϵ, 1 + ϵ[ × M) is given by Fλ(s, m) = (s + λ, m), that
is, is+λ = Fλ ◦is, for any form β ∈Ωl(]−ϵ, 1 + ϵ[ × M) we get
i∗
s£∂/∂tβ = i∗
s
d
dλ

λ=0
F ∗
λβ =
d
dλ

λ=0
i∗
sF ∗
λβ =
d
dλ

λ=0
i∗
s+λβ = d
dsi∗
sβ.
Therefore, since the integrand in the formula for H is smooth, d and the integral sign commute, so that by
Cartan’s formula (6.4.6) and the above formula we get
d(Hα) + H(dα) =
 1
0
i∗
s(di∂/∂t + i∂/∂td)α ds =
 1
0
i∗
s£∂/∂tα ds
=
 1
0
d
dsi∗
sα ds = i∗
1α −i∗
0α.
■
Proof of Theorem 6.4.16.
Deﬁne G = H ◦F ∗, where H is given in the deformation lemma 6.4.17 and
F is the (proper) homotopy between f and g. Since F ∗commutes with d we get d ◦G + G ◦d = g∗−f ∗,
so that if the form α ∈Ωk(N) is closed (and has compact support), (g∗−f ∗)(α) = d(Gα) (and Gα has
compact support).
■
6.4.18 Lemma (Poincar´e Lemma for Contractible Manifolds).
Any closed form on a smoothly contractible manifold is exact.
Proof.
Apply the previous theorem with g = identity on M and f(m) = m0.
■
The naturality of the exterior derivative has been investigated by Palais [1959]. He proves the following
result. Let M be a connected paracompact n-manifold and assume that A : Ωp(M) →Ωq(M) is a linear
operator commuting with pull-back, that is, A ◦ϕ∗= ϕ∗◦A for any diﬀeomorphism ϕ : M →M. Then
A =





0,
if 0 ≤p ≤n, 0 < q < n, q ̸= p, p + 1;
a(Identity),
if 0 < q = p ≤n;
bd,
if 0 ≤p ≤n −1, q = p + 1,
for some real constants a, b. If M is compact, then in addition we have
A =















0,
if q = 0, 0 < p < n;
c(Identity),
if p = q = 0;
0,
if q = 0, p = n, M is non-orientable or orientable
and reversible;
d
 
M,
if q = 0, p = n, M is orientable and non-reversible,
for some real constants c, d. (Orientability and reversibility will be deﬁned in the next section whereas
integration will be the subject of Chapter 7.)
Supplement 6.4B
Diﬀerential Ideals and Pfaﬃan Systems
This box discusses a reformation of the Frobenius theorem in terms of diﬀerential ideals in the spirit of E.
Cartan. Recall that a subbundle E ⊂TM is called involutive if for all pairs (X, Y ) of local sections of E

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
377
deﬁned on some open subset of M, the bracket [X, Y ] is also a local section of E. The subbundle E is called
integrable if at every point m ∈M there is a local submanifold N of M such that TmN = Em. Frobenius’
theorem states that E is integrable iﬀit is involutive (see §4.4).
Before starting the general theory let us show by a simple example how forms and involutive subbundles
are interconnected. Let ω ∈Ω2(M) and assume that Eω = { v ∈TM | ivω = 0 } is a subbundle of TM. If
X and Y are two sections of Eω then
i[X,Y ]ω = £XiY ω −iY £Xω = −iY diXω −iY iXdω = iXiY dω.
For any subbundle E, the k-annihilator of E is deﬁned by
E0(k) =

α ∈k
m(M)

α(m)(v1, . . . , vk) = 0
for all v1, . . . , vk ∈Em, m ∈M

.
This is a subbundle of the bundle k(M) of k-forms. Denote by Γ(U, E) the C∞sections of E over the open
set U of M and notice that
I(E) = ⊕0≤k<∞
(M, E0(k))
is an ideal of ω(M); that is, if ω1, ω2, ∈I(E) and ρ ∈Ω(M), then ω1 + ω2 ∈I(E) and ρ ∧ω1 ∈I(E).
6.4.19 Proposition.
The subbundle E of TM is involutive if for all open subsets U of M and all ω ∈
Γ(U, E0(1)), we have dω ∈Γ(U, E0(2)). If E is involutive, then ω ∈Γ(U, E0(k)) implies dω ∈Γ(U, E0(k +
1)).
Proof.
For any α ∈Γ(U, E0(1)) and X, Y ∈Γ(U, E), Proposition 6.4.11(ii) yields
dω(X, Y ) = X[α(Y )] −Y [α(X)] −α([X, Y ]) = −α([X, Y ]).
Thus, E is involutive iﬀdα(X, Y ) = 0; that is, dα ∈Γ(U, E0(2)).
■
The Frobenius theorem in terms of diﬀerential forms takes the following form.
6.4.20 Corollary.
The subbundle E ⊂TM is integrable if, for all open subsets U of M, ω ∈Γ(U, E0(1))
implies dω ∈Γ(U, E0(2)).
The following considerations are strictly ﬁnite dimensional. They can be generalized to inﬁnite-dimensional
manifolds under suitable splitting assumptions. We restrict ourselves to the ﬁnite-dimensional situation due
to their importance in applications and for simplicity of presentation.
6.4.21 Deﬁnition.
Let M be an n-manifold and I ⊂Ω(M) be an ideal. We say that I is locally gener-
ated by n −k independent one-forms, if every point of M has a neighborhood U and n −k pointwise
linearly independent one-forms ω1, . . . , ωn−k ∈Ω1(U) such that:
(i) if ω ∈I, then ω|U = n−k
i=1 Θi ∧ωi for some Θi ∈Ω(M);
(ii) if ω ∈Ω(M) and M is covered by open sets U such that for each U in this cover, ω|U = n−k
i=1 Θi ∧ωi
for some Θi ∈Ω(M), then ω ∈I.
The ideal I ⊂ω(M) is called a diﬀerential ideal if dI ⊂I.
Finitely generated ideals of Ω(M) are characterized by being of the form I(E). More precisely, we have
the following.
6.4.22 Proposition.
Let I be an ideal of ω(M) and let n = dim(M). the ideal I is locally generated by
n −k linearly independent one-forms iﬀthere exists a subbundle E ⊂TM with k-dimensional ﬁber such
that I = I(E). Moreover, the bundle E is uniquely determined by I.

378
6. Diﬀerential Forms
Proof.
If E has k-dimensional ﬁber, let Xn−l+1, . . . , Xn be a local basis of Γ(U, E). Complete this to a
basis of X(U) and let ωi ∈Ω1(U) be the dual basis. Then clearly ω1, . . . , xn−k are linearly independent and
locally generate I(E).
Conversely, let ω1, . . . , ωn−k generate I over U and deﬁne
Em = { v ∈TmM | ωi(m)(v) = 0, 1, . . . , n −k }.
Em is clearly independent of the generators of I over U so that E = ∩m∈MEm is a subbundle of TM.
It is straightforward to check that I = I(E). Finally, E is unique since E ̸= E′ implies I(E) ̸= I(E′) by
construction.
■
Diﬀerent ideals are characterized among ﬁnitely generated ones by the following.
6.4.23 Proposition.
Let I be an ideal of Ω(M) locally generated by n −k linearly independent forms
ω1, . . . , ωw−k ∈Ω1(U), n = dim(M), and let ω1 ∧· · · ∧ωw−k = ω ∈Ωn−k(U). Then the following are
equivalent:
(i) I is a diﬀerential ideal;
(ii) dω = n−k
j=1 ωij ∧ωj for some ωij ∈Ωl(U) and for every U, as in the hypothesis;
(iii) dωi ∧ω = 0 for all open sets U, as in the hypothesis;
(iv) there exists Θ ∈Ω1(U) such that dω = Θ ∧ω for all open sets U, as in the hypothesis.
Proof.
That conditions (i) and (ii) are equivalent and (ii) implies (iv) follows from the deﬁnitions. Con-
dition (iv) means that
n−k

i=1
(−1)idωi ∧ω1 ∧· · · ∧ˆωi ∧· · · ∧ωn−k = Θ ∧ω1 ∧· · · ∧ωn−k,
so that multiplying by ωi we get (iii). Finally, we show that (iii) implies (ii). Let ω1, . . . , ωn ∈Ω1(U) be a
basis that ω1, . . . , ωn−k generates for I over U. Then
dωi =

j<l
αijlωj ∧ωl,
where αijl ∈F(U).
But
0 = dωi ∧ω =

n−k<j<l
αijlωj ∧ωl ∧ω1 ∧· · · ∧ωn−k
and thus αijl = 0 for n −k < j < l. Hence
dωi =
n−k

j=1

−
n

l=j+1
αijlωl

∧ωj.
■
Assembling the preceding results, we get the following version of the Frobenius theorem.
6.4.24 Theorem.
Let M be an n-manifold and E ⊂TM be a subbundle with k-dimensional ﬁber, and
I(E) the associated ideal. The following are equivalent:
(i) E is integrable;

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
379
(ii) E is involutive;
(iii) I(E) is a diﬀerential ideal locally generated by n −k linearly independent one-forms ω1, . . . , ωn−k ∈
Ω1(U);
(iv) for every point of M there exists an open set U and ω1, . . . , ωn−k ∈Ω1(U) generating I(E) such that
dωi =
n−k

j=1
ωij ∧ωj
for some ωij ∈Ω1(U);
(v) same as (iv) but where the ωi satisfy:
dωi ∧ω1 ∧· · · ∧ωn−k = 0;
(vi) same as (iv) but with the condition on ωi being: there exists Θ ∈Ω1(U) such that dω = Θ ∧ω, where
ω = ω1 ∧· · · ∧ωn−k.
6.4.25 Examples.
A.
In classical texts (such as Cartan [1945] and Flanders [1963]), a system of equations
ω1 = 0, . . . , ωn−k = 0
where ωi ∈Ω1(U) and U ⊂Rn
is called Pfaﬃan system. A solution to this system is a k-dimensional submanifold N of U given by
xi = xi(u1, . . . , uk) such that if one substitutes these values of xi in the system, the result is identically zero.
Geometrically, this means that ω1, . . . , ωn−k annihilate TN. Thus, ﬁnding solutions of the Pfaﬃan system
reverts to ﬁnding integral manifolds of the subbundle
E = { v ∈TU | ω(v) = 0, i = 1, . . . , n −k }
for which Frobenius’ theorem is applicable; thus we must have
dωi ∧ω1 ∧· · · ∧ωn−k = 0.
This condition is equivalent to the existence of smooth functions aij, bj on U such that
ωi =
n−k

j=1
aijdbj.
To see this, recall that by the Frobenius theorem there are local coordinates b1, . . . , bn on U such that the
integral of E are given by b1 = constant, so that dbi, i = 1, . . . , n −k annihilate the tangent spaces to
these submanifolds. Thus the ideal I generated by db1, . . . , dbn−k; that is, ωi = 
j=1,...,n−k aijdbj for some
smooth functions aij on U.
B.
Let us analyze the case of one Pfaﬃan equation in R2. Let
ω = P(x, y)dx + Q(x, y)dy ∈Ω1(R2)
using standard (x, y) coordinates. We seek a solution to ω = 0. This is equivalent to dy/dx = −P(x, y)/Q(x, y),
so existence and uniqueness of solutions for ordinary diﬀerential equations assures the local existence of a
function f(x, y) such that f(x, y) = constant give the integral curves y(x). In other words, f(x, y) = con-
stant is an integral manifold of ω = 0. The same result could have been obtained by means of the Frobenius
theorem. Since dω ∧ω ∈Ω3(R2), we get dω ∧ω = 0, so integral manifolds exist and are unique. In texts on
diﬀerential equations, this problem is often solved with the aid of integrating factors. More precisely, if ω

380
6. Diﬀerential Forms
is not (locally) exact, can a function f and function g, called an integrating factor, be found, such that
gω = df? The answer is “yes” by Theorem 6.4.24(iii) for choosing f as above, E = ker df locally. Thus, g
is found by solving the partial diﬀerential equation,
∂(gP)
∂y
= ∂(gQ)
∂x
.
This always has a solution and the connection between g and f is given by
g = 1
P
∂f
∂x = 1
Q
∂f
∂y ,
f(x, y) = constant being the solution of ω = 0.
C.
Let us analyze a Pfaﬃan equation ω = 0 in Rn. As in Example B, we would like to be able to write
gω = df with df ̸= 0 on U ⊂Rr, for then f(x1, . . . , xn) = constant gives the (n −1)-dimensional integral
manifolds; that is, the bundle deﬁned by ω integrable. Conversely, if the bundle deﬁned by ω is integrable,
then by Example B, gω = df. Integrability is (by the Frobenius theorem) equivalent to dω ∧ω = 0, which,
as we have seen in Example B, is always veriﬁed for n = 2. For n ≥3, however, this is a genuine condition.
If n = 3, let
ω = P(x, y, z)dx + Q(x, y, z)dy + R(x, y, z)dz.
Then
dω ∧ω =
%
(P ∂R
∂y −∂Q
∂z )
+ Q(∂P
∂z −∂R
∂x ) + R(∂Q
∂x −∂P
∂y )
&
dx ∧dy ∧dz;
thus, ω = 0 is integrable iﬀthe term in the square brackets vanishes.
D.
The Frobenius’ theorem is often used in overdetermined systems of partial diﬀerential equations to
answer the question of existence and uniqueness of solutions. Consider for instance the following system of
Mayer [1872] in Rp+q = {(x1, . . . , xp, y1, . . . , yq)}:
dyα
dxi = Aα
i (x1, . . . , xp, y1, . . . , yq),
i = 1, . . . , p, α = 1, . . . , q.
We ask whether there is a solution y = f(x, c) for any choice of initial conditions c such that f(0, c) = c.
The system is equivalent to the following Pfaﬃan system:
ωα = dyα −Aα
i dxi = 0.
Since the existence of a solution is equivalent to the existence of p-dimensional integral manifolds, Frobe-
nius’ theorem asserts that the existence and uniqueness is equivalent to
dωα =

β=1,...,q
ωαβ ∧ωβ
for some one-forms ωαβ. A straightforward computation shows that
dωα = Cα
jkdxj ∧dxk + ∂Aα
i
∂yβ dxi ∧ωβ,

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
381
where
Cα
jk = ∂Aα
j
∂xk −∂Aα
k
∂xj + ∂Aα
∂yβ Aβ
k −∂Aα
k
∂yβ Aβ
j .
Since dx1, . . . , dxp, ω1, . . . , ωq are a basis of Ω1(Rp+q), we see that
dωα =

β=1,...,q
ωαβ ∧ωb
for some one-forms ωαβ iﬀCα
jk = 0.
Thus the Mayer system is integrable iﬀCα
jk = 0.
♦
In §8.4 and §8.5 we shall give some applications of Frobenius’ theorem to problems in constraints and
control theory. Many of these applications may alternatively be understood in terms of Pfaﬃan systems;
see, for example, Hermann [1977] (Chapter 18).
VECTOR CALCULUS AND DIFFERENTIAL FORMS
1. Sharp and Flat (Using standard coordinates in R3)
(a) v♭= v1dx + v2dy + v3dz = one-form corresponding to the vector v = v1e1 + v2e2 + v3e3
(b) α# = α1e1 + α2e2 + α3e3 = vector corresponding to the one-form α = α1dx + α2dy + α3dz
2. Hodge Star Operator (equation (6.2.6)),
(a) ∗1 = dx ∧dy ∧dz
(b) ∗dx = dy ∧dz, ∗(dx ∧dz) = −dy, ∗(dx ∧dy) = dz
(c) ∗(dy ∧dz) = dx, ∗(dx ∧dz) = −dy, ∗(dx ∧dy) = dz
(d) ∗(dx ∧dy ∧dz) = 1
3. Cross Product and Dot Product
(a) v × w =

∗

v♭∧w♭#
(b) (v · w)dx ∧dy ∧dz = v♭∧∗

w♭
4. Gradient
∇f = grad f = (df)#
5. Divergence
∇· F = div F = ∗d

∗F♭
6. Curl
∇× F = curl F =
'
∗

dF♭(#

382
6. Diﬀerential Forms
IDENTITIES FOR VECTOR FIELDS AND FORMS
1. Vector ﬁelds on M with the bracket [X, Y ] form a Lie algebra; that is, [X, Y ] is real bilinear, skew
symmetric, and Jacobi’s identity holds:
[[X, Y ], Z] + [[Z, X], Y ] + [[Y, Z], X] = 0.
Locally,
[X, Y ] = DY · X −DX · Y
and on functions, [X, Y ][f] = X[Y [f]] −Y [X[f]].
2. For diﬀeomorphisms ϕ, ψ, we have
ϕ∗[X, Y ] = [ϕ∗X, ψ∗Y ]
and
(ϕ ◦ψ)∗X = ϕ∗ψ∗X.
3. The forms on a manifold are a real associative algebra with ∧as multiplication. Furthermore,
α ∧β = (−1)klβ ∧α
for k- and l-forms α and β, respectively.
4. For maps, ϕ, ψ, we have
ϕ∗(α ∧β) = ϕ∗α ∧ϕ∗β,
(ϕ ◦ψ)∗α = ψ∗ϕ∗α.
5. d is a real linear map on forms and
ddα = 0,
d(α ∧β) = dα ∧β + (−1)kα ∧dβ
for α a k-form.
6. For α a k-form and X0, . . . , Xk vector ﬁelds:
dα(X0, . . . , Xk)
=
k

i=0
(−1)iXi[α(X0, . . . , ˆ
Xi, . . . , Xk)]
+

0≤i<j≤k
(−1)i+jα([Xi, Xj], X0, . . . , ˆ
Xi, . . . , ˆ
Xj, . . . , Xk).
If M is ﬁnite dimensional and α = αi1...ikdxi1 ∧· · · ∧. . . dxik, i1 < · · · < ik, then
(dω)j1...jk+1 =
k

p=1
(−1)p−1
∂
∂xjk αj1...jp−1jp+1...jk+1
+ (−1)k
∂
∂xjk+1 αj1...jk,
for j1 < · · · < jk+1.
Locally,
dω(x)(v0, . . . , vk) =
k

i=0
(−1)iDω(x) · vi(v0, . . . , ˆvi, . . . , vk)

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
383
7. For a map ϕ, ϕ∗dα = dϕ∗α.
8. (Poincar´e lemma.) If dα = 0, then α is locally exact; that is, there is a neighborhood U about each
point on which α = dβ for some form β deﬁned on U. The same result holds globally on a contractible
manifold.
9. iXα is real bilinear in X, α and for h : M →R, ihXα = hiXα = iXhα. Also iXiXα = 0, and
iX(α ∧β) = iXα ∧β + (−1)kα ∧iXβ
for α a k-form.
10. For a diﬀeomorphism ϕ, we have
ϕ∗iXα = iϕ∗Xϕ∗α;
if f : M →N is a mapping and Y is f-related to X, then
iY f ∗α = f ∗iXα.
11. £Xα is real bilinear in X, α and
£X(α ∧β) = £Xα ∧β + α ∧£Xβ.
12. (Cartan’s Magic Formula.) £Xα = diXα + iXdα.
13. For a diﬀeomorphism ϕ,
ϕ∗£Xα = £ϕ∗Xϕ∗α;
if f : M →N is a mapping and Y is f-related to X, then
£Y f ∗α = f ∗£Xα.
14.
(£Xα)(X1, . . . , Xk) = X[α(X1, . . . , Xk)]
−
k

i=1
α(X1, . . . , [X, Xi], . . . , Xk).
Locally,
(£Xα)x · (v1, . . . , vk) = DαX · X(x) · (v1, . . . , vk)
+
n

k=1
αx(v1, . . . , DXx · vi, . . . , vk).
15. The following identities hold:
(a) £fXα = f£Xα + df ∧iXα.
(b) £[X,Y ]α = £X£Y α −£Y £Xα.
(c) i[X,Y ]α = £XiY α −iY £Xα.
(d) £Xdα = d£Xα.
(e) £XiXα = iX£Xα.

384
6. Diﬀerential Forms
16. If M is a ﬁnite dimensional manifold, X = Xl∂/∂xl and
α = αi1...ikdxi1 ∧· · · ∧dxik,
i1 < · · · < ik,
the following local formulas hold:
dα = ∂αi1...ik
∂xl
dxl ∧dxi1 ∧· · · ∧dxik,
iXα = Xlαli2...ikdxi2 ∧· · · ∧dxik,
£Xα = Xl ∂αi1...ik
∂xl
dxi1 ∧· · · ∧dxik
+αi1i2...ik
∂Xi1
∂xl dxl ∧dxi2 ∧· · · ∧dxik
+αi2i2...ik
∂Xi2
∂xl dxi1 ∧dxl ∧dxi3 ∧· · · ∧dxik + . . .
Exercises
⋄6.4-1.
Compute the exterior derivative of the following diﬀerential forms on R3:
α = x3dx + y3dx ∧dy + xyzdx ∧dz;
β = 3dxdx ∧dy + 9 cos(xy)dx ∧dy ∧dz.
⋄6.4-2.
Using Examples 6.4.3 and the properties of d and ∗, prove the following formulas in R3 for f, g :
R3 →R and F, G ∈X(R3):
(i) grad(fg) = (grad g)f + f(grad g).
(ii) curl (fF) = (grad f) × F + f(grad F).
(iii) div (fF) = grad(f) · F + f div F.
(iv) div (F × G) = G · curl F −F · curl G.
(v) £F G = (F · ∇)G −(G · ∇)F = F div G −G div F −curl(F × G).
(vi) curl(F × G) = (div G)F −(div F)G + (G · ∇)F −(F · ∇)G.
(vii) curl(div F) = grad(div F) −∆F, where
(∆F)i = ∂2F i
∂x2 + ∂2F i
∂y2 + ∂2F i
∂z2
is the usual Laplacian.
(viii) ∇(F · F) = 2(F · ∇)F + 2F × curl F.
⋄6.4-3.
Let ϕ : S1 × R+ →R2 be the polar coordinate mapping deﬁned by ϕ(θ, r) = (r cos θ, r sin θ).
Compute ϕ∗(dx ∧dy) from the deﬁnitions and verify that it equals d(ϕ∗x) ∧d(ϕ∗y).
⋄6.4-4.
On S1 ﬁnd a closed one-form α that is not exact.
Hint: On R2\{0} consider α = (ydx −xdy)/(x2 + y2).
⋄6.4-5.
Show that the following properties uniquely characterize iX on ﬁnite-dimensional manifolds

6.4 The Exterior Derivative, Interior Product, & Lie Derivative
385
(i) iX : Ωk(M) →Ωk−1(M) is a ∧antiderivation;
(ii) iXf = 0 for f ∈F(M);
(iii) iXω = ω(X) for ω ∈Ω1(M);
(iv) iX is natural with respect to restrictions.
Use these properties to show that i[X,Y ] = £XiY −iY £X. Finally, show iX ◦iX = 0.
⋄6.4-6.
Show that a derivation mapping Ωk(M) to Ωk+1(M) for all k ≥0 is zero (note that d and iX are
antiderivations).
⋄6.4-7.
Let s : T 2M →T 2M be the canonical involution of the second tangent bundle (see Exercise 3.4-4).
(i) If X is a vector ﬁeld on M, show that s ◦TX is a vector ﬁeld on TM.
(ii) If Ft is the ﬂow on X, prove that TFt is a ﬂow on TM generated by s ◦TX.
(iii) If µ is a one-form on M, µ′ : TM →R is the corresponding function, and w ∈T 2M, then show that
dµ′(sw) = dµ(τT M(w), TτM(w)) + dµ′(w).
⋄6.4-8.
Prove the following relative Poincar´e lemma. Let ω be a closed k-form on a manifold M and let
N ⊂M be a closed submanifold. Assume that the pull-back of ω to N is zero. Then there is a (k −1)-form
α on a neighborhood N such that dα = ω and α vanishes on N. If ω vanishes on N, then α can be chosen
so that all its ﬁrst partial derivatives vanish on M.
Hint: Let ϕt be a homotopy of a neighborhood of N to N and construct an H operator as in the Poncar´e
lemma using ϕt.
⋄6.4-9 (Angular variables).
Let S1 denote the circle identiﬁed as S1 = R/(2π) = { x ∈C | |z| = 1 }. Let
γ : R →S1; x →eix be the exponential map. Show that γ induces a isomorphism TS1 = S1 × R. Let M be
a manifold and let ω be an “angular variable,” that is a smooth map ω : M →S1. Deﬁne dω, a one-form
on M by taking the R-projection of Tω. Show that (i) if ω : M →S1, then ddω = 0; and (ii) if f : M →N
is smooth, then f ∗(dω) = d(f ∗ω), where f ∗ω = ω ◦f.
⋄6.4-10.
Prove the identity
£XiY −£Y iX −i[X,Y ] = [d, iX ◦iY ].
⋄6.4-11.
(i) Let X = (X1, X2, 0) be a vector ﬁeld deﬁned on the plane S = { (x, y, 0) | x, y ∈R } in R3.
Show that there exists Y ∈X(R3) such that X = curl Y on S.
Hint: Let
Y (x, y, z) = (zX2(x, y), −zX1(x, y), 0).
(ii) Let S be a closed surface on R3 and X ∈X(S). Show that there exists Y ∈X(R3) such that X = curl
Y on S.
Hint: By Theorem 5.5.9 extend X to ˜X ∈X(R3) and put ω = ∗˜X♭. Locally ﬁnd α such that dα = ω
by (i). Use a partition of unity (ϕi) to write ω =  ϕiω and let dαi = ϕiω, α =  αi.
(iii) Generalize this to forms on a closed submanifold of a manifold admitting Ck-partitions of unity.

386
6. Diﬀerential Forms
⋄6.4-12.
Let M be a manifold and α ∈Ωk(M). If τM : TM →M denotes the tangent bundle projection,
let α′ = τ ∗α ∈Ωk(TM). A k-form Γ on TM for which there is an α ∈Ωk(m) such that α′ = Γ is called
basic. A vector ﬁeld x ∈X(TM) is said to be vertical if TτM ◦X = 0. Show that Γ ∈Ωk(TM) is basic if
and only if iXΓ = 0, and £XΓ = 0 for any vertical vector ﬁeld χ on TM. Conclude that if Γ is closed it is
basic if and only if iXΓ = 0 for every vertical vector ﬁeld X on TM.
Hint: Since X and the zero vector ﬁeld on M are τM-related, if Γ is vertical, the two identities follow.
Conversely, if Ft is the ﬂow of X, then F ∗
t Γ = Γ. Deﬁne α ∈Ωk(TM) by
α(m)(v1, . . . , vk) = Γ(u)(V1, . . . , Vk),
where τ(u) = m, TmτM(Vi) = vi, i = 1, . . . , k. Show that this deﬁnition is independent of the choices of
u, V1, . . . , Vk in the following way. Let τ(u′) = m, TmτM(V ′
i ) = vi, i = 1, . . . , k, w = u −u′. Consider
the local ﬂow Ft in a vector bundle chart of TM containing TmM which occurs only in the ﬁbers and
which on TmM itself is translation by tw. The vector ﬁeld it generates is vertical so that T ∗
t Γ = Γ and
F1(u) = u′. Let Tu′F1(V ′
i ) = V ′′
i
∈Tu(TM) and show Tuτ(V ′′
i ) = vi since τ ◦ϕt = τ; thatis, V ′′
i −Vi is
a vertical vector. Now use the fact that V ′′
i −Vi contracts with Γ to give zero to prove inductively that
Γ(u)(Vi, . . . , Vk) = Γ(u′)(V ′
i , . . . , V ′
k).
⋄6.4-13.
Show that on R4, the ideal generated by
ω1 = x2dx1 + x3dx4,
ω2 = x3dx2 + x2dx3
is a diﬀerential ideal. Find its integral manifolds.
6.5
Orientation, Volume Elements and the Codiﬀerential
Orientation and Volume Manifolds.
This section globalizes the setting of §6.2 from linear spaces to
manifolds. All manifolds in this section are ﬁnite dimensional.1
6.5.1 Deﬁnition.
A volume form on an n-manifold M is an n-form µ ∈Ωn(M) such that µ(m) ̸= 0
for all m ∈M; M is called orientable if there exists some volume form on M. The pair (M, µ) is called a
volume manifold.
Thus, µ assigns an orientation, as deﬁned in equation (6.2.5), to each ﬁber of TM. For example, R3 has
the same standard volume form µ = dx ∧dy ∧dz.
6.5.2 Proposition.
Let M be an n-manifold.
(i) M is orientable iﬀthere is an element µ ∈Ωn(M) such that every other ν ∈Ωn(M) may be written
ν = fµ for some f ∈F(M).
(ii) If M is orientable then it has an atlas {(Ui, ϕi)}, where ϕi : Ui →U ′
i ⊂Rn, such that the Jaco-
bian determinant of the overlap maps is positive (the Jacobian determinant is the determinant of the
derivative, a linear map from Rn into Rn). The converse is true if M is paracompact.
Proof.
For (i) assume ﬁrst that M is orientable, with a volume form µ. Let ν be any other element of
Ωn(M). Now each ﬁber of n(M) is one-dimensional, so we may deﬁne a map f : M →R by
ν′(m) = f(m)µ′(m)
where µ(m) = µ′(m)dx1 ∧· · · ∧dxn
and similarly for ν′. Since, ν′(m) ̸= 0 for all m ∈M, F(m) = ν′(m)/µ′(m) is of class C∞. Conversely, if
Ωn(M) is generated by ν, then ν′(m) ̸= 0 for all m ∈M since each ﬁber is one-dimensional.
1For inﬁnite-dimensional analogues of orientability, see Elworthy and Tromba [1970b].

6.5 Orientation, Volume Elements and the Codiﬀerential
387
To prove (ii), let {(Ui, ϕi)} be an atlas with ϕi(Ui) = U ′
i ⊂Rn. We may assume that all U ′
i are connected
by taking restrictions if necessary. Now ϕ∗
i µ = fidx1 ∧· · · ∧dxn = fiµ0, where µ0 is the standard volume
form on Rn. By means of a reﬂection if necessary, we may assume that fi(u′) > 0 (fi ̸= 0 since ν is a volume
form). However, a continuous real-valued function on a connected space that is nowhere zero is always > 0
or always < 0. Hence, for overlap maps we have
(ϕi ◦ϕ−1
j )∗dx1 ∧· · · ∧dxn = ϕi∗◦ϕj∗dx1 ∧· · · ∧dxn
=
fi
fj ◦ϕj ◦ϕ−1
i
dx1 ∧· · · ∧dxn.
But
ψ∗(u)(α1 ∧· · · ∧αn) = Dψ(u)∗· α1 ∧Dψ(u)∗· α2 ∧· · · ∧Dψ(u)∗· αn.
where Dψ(u)∗· α1(e) = α1(Dψ(u) · e). Hence, by the deﬁnition of determinant,
det(D(ϕj ◦ϕ−1
i )) =
fi(u)
fj[(ϕj ◦ϕ−1
i )(u)] > 0.
(We leave as an exercise the fact that the canonical isomorphism L(E, E) ≈L(E∗, E∗) used before does not
aﬀect determinants.)
For the converse of (ii), suppose {(Vα, πα)} is an atlas with the given property, and let {(Ui, ϕi, gi)} a
subordinate partition of unity. Let
µi = ϕ∗
i (dx1 ∧· · · ∧dxn) ∈Ωn(Ui)
and let ˜µi(m) = gi(m)µi(m) if m ∈Ui and ˜µi = 0 if ̸∈Ui. Since supp(gi) ⊂Ui, we have ˜µi ∈Ωn(M). Let
µ = 
i ˜µi. Since this sum is ﬁnite in some neighborhood point, it is clear from local representatives that
µ ∈Ωn(M). To show that µ is a volume form on M, notice that on Ui ∩Uj ̸= ∅we have
µj = ϕ∗
j(dx1 ∧· · · ∧dxn) = ϕ∗
i (ϕj ◦ϕ−1
i )∗(dx1 ∧· · · ∧dxn)
= [det D(ϕj ◦ϕ−1
i ) ◦ϕi] ◦ϕ∗
i (dx1 ∧· · · ∧dxn)
= [det D(ϕj ◦ϕ−1
i ) ◦ϕi]µi = ajiµi
where aji ∈F(Ui ∩Uj), aji > 0 and there is no implied sum. By local ﬁniteness of the covering {Ui}, a
given point m ∈M belongs only to a ﬁnite number of open sets, say Ui0, Ui1, . . . , UiN . Thus,
µ(M) =
N

k=0
µik(m) =
) N

k=1
(1 + aiki0(m))
*
µi0(m) ̸= 0
since µi0(m) ̸= 0 and each aiki0(m) > 0. It follows that µ(m) ̸= 0 for each m ∈M.
■
Thus, if (M, µ) is a volume manifold we get a map from Ωn(M) to F(M); namely, for each ν ∈Ωn(M),
there is a unique f ∈F(M) such that ν = fµ.
6.5.3 Deﬁnition.
Let M be an orientable manifold. Two volume forms µ1 and µ2 on M are called equiv-
alent if there is an f ∈F(M) with f(m) > 0 for all m ∈M such that µ1 = fµ2. (This is clearly an
equivalence relation.) An orientation of M is an equivalence class [µ] of volume forms on M. An ori-
ented manifold (M, [µ]), is an orientable manifold M together with an orientation [µ] on M.
If [µ] is an orientation of M, then [−µ], (which is clearly another orientation) is called the reverse
orientation.
The next proposition tells us when [µ] and [−µ] are the only two orientations.

388
6. Diﬀerential Forms
6.5.4 Proposition.
Let M be an orientable manifold. Then M is connected iﬀM has exactly two orien-
tations.
Proof.
Suppose M is connected, and µ, ν are two volume forms with ν = fµ. Since M is connected, and
f(m) ̸= 0 for all m ∈M, f(m) > 0 for all m or else f(m) < 0 for all m. Thus ν is equivalent to µ or −µ.
Conversely, if M is not connected, let U (not equal to either ∅or M), be a subset that is both open and
closed. If ν is a volume form on M, deﬁne ν by letting ν(m) = ν(m) if m ∈U and ν(m) = −ν(m) if m ̸∈U.
Obviously, χ is a volume form on M, and ν ̸∈[ν] ∪[−ν].
■
A simple example of a nonorientable manifold is the M¨obius band (see Figure 6.5.1 and Exercise 6.5-12),
For other examples, see Exercises 6.5-11 and 6.5-13.
Figure 6.5.1.
6.5.5 Proposition.
The equivalence relation in Deﬁnition 6.5.3 is natural with respect to mappings and
diﬀeomorphisms. That is, if f : M →N is of class C∞, µN and νN are equivalent volume forms on N, and
f ∗(µN) is a volume form on M, then f ∗(νN) is an equivalent volume form. If f is a diﬀeomorphism and
µM and νM are equivalent volume forms on M, then f∗(µM) and f∗(νM) are equivalent volume forms on
N.
Proof.
This follows from the fact that f ∗(gω) = (g ◦f)f ∗ω, which implies f ∗(gω) = (g ◦f −1)f ∗ω when
f is a diﬀeomorphism.
■
6.5.6 Deﬁnition.
Let M be an orientable manifold with orientation [µ]. A chart (U, ϕ) with ϕ(U) = U ′ ⊂
Rn is called positively oriented if ϕ∗(µ|U) is equivalent to the standard volume form dx1 ∧· · · ∧dxn ∈
Ωn(U ′).
From Proposition 6.5.5 we see that this deﬁnition does not depend on the choice of the representative from
[µ].
If M is orientable, we can ﬁnd an atlas in which every chart has positive orientation by choosing an atlas
of connected charts and, if a chart has negative orientation, by composing it with a reﬂection. Thus, in
Proposition 6.5.2(ii) the atlas consists of positively oriented charts.
Orientable Double Covering.
If M is not orientable, there is an orientable manifold ˜
M and a two-to-
one C∞surjective local diﬀeomorphism π : ˜
M →M. The manifold ˜
M is called the orientable double
covering and is useful for reducing certain facts to the orientable case. The double covering is constructed
as follows. Let
˜
M = { (m, [µm]) | m ∈M, [µm] an orientation of TmM }.
Deﬁne a chart at (m, [µm]) in the following way. Fix an orientation [ω] of Rn and an orientation reversing
isomorphism A of Rn, for example, the isomorphism given by A(e1) = −e1, A(ei) = ei, i = 2, . . . , n where

6.5 Orientation, Volume Elements and the Codiﬀerential
389
[ei, . . . , en] is the standard basis of Rn. If ϕ : U →U ′ ⊂Rn is a chart of M at m, setting
U ± = { (u, [µu]) | u ∈U, [ϕ∗(µu)] = [±ω] },
and deﬁning ϕ± →U ′ by
ϕ+(u, [µu]) = ϕ(u),
ϕ−(u, [µu]) = (A ◦ϕ)(u),
we get charts (U ±, ϕ±) of ˜
M. It is straightforward to check that the family {(U ±, ϕ±)} constructed in this
way forms an atlas, thus making ˜
M into a diﬀerentiable n-manifold. Deﬁne π : ˜
M →M by π(m, [µm]) = m.
In local charts, π is the identity mapping, so that π is a surjective local diﬀeomorphism. Moreover
π−1(m) = {(m, [µm]), (m, [−µm])},
so that π is a twofold covering of M. Finally, ˜
M is orientable, since the atlas formed by the charts (U ±, ϕ±)
is orientable. A natural orientation on M is induced on the tangent space to ˜
M at the point (m, [µm]) by
[(Tmπ)∗µm].
6.5.7 Proposition.
Let m be a connected n-manifold. Then ˜
M is connected iﬀM is nonorientable. In
fact, M is orientable iﬀ˜
M consists of two disjoint copies of M, one with the given orientation, the other
with the reverse orientation.
Proof.
The if part of the second statement is a reformulation of Proposition 6.5.4 and it also proves that if
˜
M is connected, then M is nonorientable. Conversely if M is a connected manifold and if ˜
M is disconnected,
let C be a connected component of ˜
M. Then since π is a local diﬀeomorphism, π(C) is open in M. We shall
prove that π(C) is closed. Indeed, if m ∈cl(π(C)), let ˜m1, ˜m2 ∈˜
M be such that π( ˜m1) = π( ˜m2) = m.
If there exists neighborhoods ˜U1, ˜U2, of ˜m1, ˜m2 such that ˜U1 ∩C = ∅and ˜U ∩C = ∅, then shrinking ˜U1
and ˜U2 if necessary, the open neighborhoods π( ˜U1) and π( ˜U2) of m have empty intersection with π(C),
contradicting the fact that m ∈cl(π(C)). Thus at least one of ˜m1, ˜m2 is in cl(C) = C; that is, m ∈π(C) and
hence π(C) is closed. Since M is connected, π(C) = M. But π is double covering of M so that ˜
M can have
at most two components, each of them being diﬀeomorphic to M. Hence M is orientable, the orientation
being induced from one of the connected components via π.
■
Conditions for Orientability.
Another criterion of orientability is the following.
6.5.8 Proposition.
Suppose M is an orientable n-manifold and V is a submanifold of codimension k with
trivial normal bundle. That is, there are C∞maps Ni : V →TM, i = 1, . . . , k such that Ni(v) ∈Tv(M),
and Ni(v) span a subspace Wv, such that TvM = TvV ⊕Wv for all v ∈V . Then V is orientable.
Proof.
Let µ be a volume form on M. Consider the restriction µ|V : V →Γn(M). Let us ﬁrst note
that µ|Γ is a smooth mapping of manifolds. This follows by using charts with the submanifold property,
where the local representation is a restriction to a subspace. Now deﬁne µ0 : V →Γn−k(V ) as follows. For
X1, . . . , Xn−k ∈X(V ), put
µ0(v)(X1(v), . . . , Xn−k(v)) = µ(v)(N1(v), . . . , Nk(v), X1(v), . . . , Xn−k(v)).
It is clear that µ0(v) ̸= 0 for all v. It remains only to show that µ0 is smooth, but this follows from the fact
that µ|V is smooth.
■
If g is a Riemannian metric, then g♭: TM →T ∗M denotes the index-lowering operator and we write
g# = (g♭)−1. For f ∈F(M),
grad f = g#(df)
is called the gradient of f. Thus, grad f ∈X(M). In local coordinates, if [gij] = [g(∂/∂xi, ∂/∂xj)] and [gij]
is the inverse matrix, then
(grad f)i = gij ∂f
∂xj .
(6.5.1)

390
6. Diﬀerential Forms
6.5.9 Corollary.
Suppose M is an orientable paracompact manifold, H ∈F(M) and c ∈R is a regular
value of H. Then V = H−1(c) is an orientable submanifold of M of codimension one, if it is nonempty.
Proof.
Suppose c is a regular value of H and H−1(c) = V ̸= ∅. Then N(v) ̸∈TvV for v ∈V , because
FvV is the kernel of
dH(v)[N(v)] = g(N, N)(v) > 0
as dH(v) ̸= 0 by hypothesis. Then Proposition 6.5.8 applies, and so V is orientable.
■
Thus if we interpret V as the “energy surface,” we see that it is an oriented submanifold for “almost all”
energy values by Sard’s theorem.
Orientation Preserving Maps.
The notion of orientation preserving maps between oriented manifolds
can now be deﬁned.
6.5.10 Deﬁnition.
Let M and N be two orientable n-manifolds with volume forms µM and µN, re-
spectively. Then we call a C∞map f : M →N volume preserving (with respect to µM and µN) if
f ∗µN = µM, orientation preserving if f ∗(µN) ∈[µM], and orientation reversing if f ∗(µN) ∈[−µM].
An orientable manifold admitting (respectively, not admitting) an orientation reversing diﬀeomorphism is
called reversible (respectively, non-reversible).
From Proposition 6.5.5, [f ∗µN] depends only on [µN]. Thus the ﬁrst part of the deﬁnition explicitly
depends on µM and µN, while the last four parts depend only on the orientations [µM] and [µN]. Furthermore,
we see from Proposition 6.5.5 that if f is volume preserving with respect to µM and µN, then f is volume
preserving with respect to hµM and gµN iﬀh = g ◦f. It is also clear that if f is volume preserving with
respect to µM and µN, then f is orientation preserving with respect to [µM] and [µN].
6.5.11 Proposition.
Let M and N be n-manifolds with volume forms µM and µN, respectively. Suppose
f : M →N is of class C∞. Then f ∗(µN) is a volume form iﬀf is a local diﬀeomorphism; that is, for each
m ∈M, there is a neighborhood V of m such that f|V : V →f(V ) is a diﬀeomorphism. If M is connected,
then f is a local diﬀeomorphism iﬀf is orientation preserving or orientation reversing.
Proof.
If f is a local diﬀeomorphism, then clearly F ∗(µN)(m) ̸= 0, by Proposition 6.2.3(ii). Conversely,
if f ∗(µM) is a volume form, then the determinant of the derivative of the local representative is not zero,
and hence the derivative is an isomorphism. The result then follows by the inverse function theorem. The
second statement follows at once from the ﬁrst and Proposition 6.5.4.
■
Jacobian Determinant.
Next we consider the global analog of the determinant.
6.5.12 Deﬁnition.
Suppose M and N are n-manifolds with volume forms µM and µN, respectively. If f :
M →N is of class C∞, the unique C∞function J(µM, µN)f ∈F(M) such that f ∗µN = (J(µM, µN)f)µM
is called the Jacobian determinant of f (with respect to µM and µN). If f : M →M we write Jµf =
J(µ, µ)f.
Note that J(µM, µN)f(m) = det(Tmf), the determinant being taken with respect to the volume forms
µM(m) on TmM and µN(f(m)) on Tf(m)N. The basic properties of determinants that were developed in
§6.2 also hold in the global case, as follows. First, we have the following consequences of Proposition 6.5.11.
6.5.13 Proposition.
The Ck map f : M →N, k ≥1, is a local Ck diﬀeomorphism iﬀJ(µM, µN)f(m) ̸=
0 for all m ∈M.
Second, we have consequences of the deﬁnition and properties of pull-back.
6.5.14 Proposition.
Let (M, µ) be a volume manifold.
(i) If f : M →M and g : M →M are of class Ck, k ≥1, then
Jµ(f ◦g) = [(Jµf) ◦g][Jµg].

6.5 Orientation, Volume Elements and the Codiﬀerential
391
(ii) If h : M →M is the identity, then Jµh = 1.
(iii) If f : M →M is a diﬀeomorphism, then
Jµ(f −1) =
1
[(Jµf) ◦f −1].
Proof.
For (i),
Jµ(f ◦g)µ = (f ◦g)∗µ = g∗f ∗µ = g∗(Jµf)µ
= ((Jµf) ◦g)g∗µ = ((Jµf) ◦g)(Jµg)µ.
Part (ii) follows since h∗is the identity. For (iii) we have
Jµ(f ◦f −1) = 1 = ((Jµf) ◦f −1)(Jµf −1).
■
6.5.15 Proposition.
Let (M, [µM]) and (N, [µN]) be oriented manifolds and f : M →N be a map of
class Ck, k ≥1. Then f is orientation preserving iﬀJ(µM, µN)f(m) > 0 for all m ∈M, and orientation
reversing if J(µM, µN)f(m) < 0 for all m ∈M. Also, f is volume preserving with respect to µM and µN iﬀ
J(µM, µN)f = 1.
This proposition follows from the deﬁnitions. Note that the ﬁrst two assertions depend only on the
orientations [µM] and [µN], since
J(hµM, gµN)f =
g ◦f
h

J(µM, µN)f,
which the reader can easily check. Here g ∈F(N), h ∈F(M), g(n) ̸= 0, and h(m) ̸= 0 for all n ∈N,
m ∈M.
Divergence.
We have seen that in R3 the divergence of a vector ﬁeld is expressible in terms of the standard
volume element µ = dx ∧dy ∧dz by the use of the metric in R3 (see Example 6.4.3D). There is, however, a
second characterization of the divergence that does not require a metric but only a volume form µ, namely
£F µ = (div F)µ,
as a simple computation shows. This can now be generalized.
6.5.16 Deﬁnition.
Let (M, µ) be a volume manifold; that is, M is an orientable manifold with a volume
form µ. Let X be a vector ﬁeld on M. The unique function divµ X ∈X(M), such that
£Xµ = (divµ X)µ
is called the divergence of X. We say X is incompressible or divergence free (with respect to µ) if
divµ X = 0.
6.5.17 Proposition.
Let (M, µ) be a volume manifold and X a vector ﬁeld on M.
(i) If f ∈F(M) and f(m) ̸= 0 for all m ∈M, then
divfµ X = divµ X + £Xf
f
.

392
6. Diﬀerential Forms
(ii) For g ∈F(M), divµ gX = g divµ X + £Xg.
Proof.
Since £X is a derivation,
£X(fµ) = (£Xf)µ + f£Xµ.
As fµ is a volume form,
(divfµ X)(fµ) = (£Xf)µ + f(divµ X)µ.
Then (i) follows. For (ii),
£gXµ = g£Xµ + dg ∧iXµ,
and from the antiderivation property of iX,
dg ∧vXµ = −iX(dg ∧µ) + iXdg ∧µ.
But dg ∧µ ∈Ωn+1(M), and hence dg ∧µ = 0. Also, iXdg = £Xg, so
£gXµ = g£Xµ + (£Xg)µ.
The result follows from this.
■
6.5.18 Proposition.
Let (M, µ) be a volume manifold and X a vector ﬁeld on M. Then X is incompress-
ible (with respect to µ) iﬀthe ﬂow of X is volume preserving; that is, the local diﬀeomorphism Ft : U →V
is volume preserving with respect to µ|U and µ|V .
Proof.
Since X is incompressible, £Xµ = 0, and so µ is constant along the ﬂow of X; µ(m) = (F ∗
t µ)(m).
Thus Ft is volume preserving. Conversely, if (F ∗
t µ)(m) = µ(m), then £Xµ = 0.
■
6.5.19 Corollary.
Let (M, µ) be a volume manifold and X a vector ﬁeld with ﬂow Ft on M. Then X is
incompressible iﬀJµFt = 1 for all t ∈R.
One-Densities.
The above developments regarding the Jacobian and divergence can also be carried out
for one-densities. If |µM|, |µN| are one-densities and f : M →N is C∞, we shall write
f ∗|µN| = J(|µM|, |µN|, f)|µM|,
where the pull back is deﬁned as for forms. Then Propositions 6.5.13 and 6.5.14 go through for one-densities.
The Lie derivative of a one-density is deﬁned by
£X|µ| = d
dt

t=0
F ∗
t |µ|
and one deﬁnes the divergence of X with respect to |µ| as in Deﬁnition 6.5.16. Then it is easy to check that
Proposition 6.5.17–Corollary 6.5.19 have analogues for one-densities.
Riemannian Volume Forms.
We shall now globalize the concepts pertaining to Riemannian volume
forms and densities, as well as the Hodge star operator discussed in §6.2.
6.5.20 Proposition.
Let (M, g) be a pseudo-Riemannian manifold of signature s; that is, g(m) has sig-
nature s for all m ∈M.
(i) If M is orientable, then there exists a unique volume element µ = µ(g) on M, called the g-volume (or
pseudo-Riemannian volume of g), such that µ equals one on all positively oriented orthonormal
bases on the tangent spaces to M. If X1, . . . , Xn is such a basis in an open set U of M and if ζ1, . . . , ζn
is the dual basis, then µ = ζ1 ∧· · · ∧ζn. More generally, if v1, . . . , vn ∈TxM are positively oriented,
then
µ(x)(v1, . . . , vn) = | det[g(x)(vi, vj)]|1/2.

6.5 Orientation, Volume Elements and the Codiﬀerential
393
(ii) For every α ∈R there exists a unique α-density |µ|α, called the g-α-density (or the pseudo-
Riemannian α-density of g), such that |µ|α equals 1 on all orthonormal bases of the tangent
spaces to M. If Xi, . . . , Xn is such as a basis in an open set U of M with dual basis ζ1, . . . , ζn, then
|µ|α = |ζ1 ∧· · · ∧ζn|α. More generally, if v1, . . . , vn ∈TxM, then
|µ|α(x)(v1, . . . , vn) = | det[g(x)(vi, vj)]|α/2.
This is a consequence of Proposition 6.2.10 and the fact that µ and |µ|α are smooth. Also note that in an
oriented chart (x1, . . . , xn) on M, we have
µ = | det[gij]|1/2dx1 ∧· · · ∧dxn.
As in the vector space situation, g induces a pseudo-Riemannian metric on Γk(M) by
⟨α, β⟩x = αi1...ikβi1...ik,
(6.5.2)
where the sum is over i1 < · · · < ik and where, α, β ∈k(M)x and βi1...ik are the components of the
associated contravariant tensor to β. As in Proposition 6.2.11, if X1, . . . Xn is an orthonormal basis in
U ⊂M with dual basis ζ1, . . . ζn, then the elements ζi1 ∧· · · ∧ζik, where i1 < · · · < ik form an orthonormal
basis of Γk(U).
The Hodge Star Operator.
On an orientable pseudo-Riemannian manifold with pseudo-Riemannian
volume form µ, the Hodge operator is deﬁned pointwise by
∗: Ωk(M) →Ωn−k(M),
(∗α)(x) = ∗α(x);
that is, α∧∗β = ⟨α, β⟩µ for α, β ∈Ωk(M). The properties in Propositions 6.2.12 and 6.2.13 carry over since
they hold pointwise. One can check that if α is Cr then so is ∗α.
The Codiﬀerential.
The exterior derivative and the Hodge star operator enable us to introduce the
following linear operator δ. (The reason for the strange-looking factor (−1) in the deﬁnition is so a later
integration by parts formula, proved in Corollary 7.2.13, will come out simple.)
6.5.21 Deﬁnition.
The codiﬀerential δ : Ωk+1(M) →Ωk(M) is deﬁned by δ(Ω0(M)) = 0 and on k + 1
forms β by
δβ = (−1)nk+1+Ind(g)∗d∗β.
Notice that since d2 = 0 and ∗∗is a multiple of the identity, δ2 = 0.
For example, in R3, let α = ady ∧dz −bdx ∧dz + cdx ∧dy. Then
∗α = adx + bdy + cdz,
so
d∗α = (bx −ay)dx ∧dy + (cx −az)dx ∧dz + (cy −bz)dy ∧dz
and
∗d∗α = (bx −ay)dz −(cc −az)dy + (cy −bz)dx.
Thus, as nk + 1 + Ind (g) = 4 is even,
dα = (cγ −bz)dx + (az −cx)dy + (bx −ay)dz.

394
6. Diﬀerential Forms
The formula for δβ in coordinates is given by
(δβ)i1...ik =
1
k + 1| det[gij]|−1/2gi1r1 . . . gikrk
× ∂
∂xl
k+1

p=1
(−1)pgr1j1 · · · grp−1jp̸=1gljrgrpip̸=1βj1...jk̸=1| det[gij]|1/2
	
or as a contravariant tensor
(δβ)r1...rk =
1
k + 1| det[gij]|−1/2
× ∂
∂xl
k=1

p=1
(−1)pβr1...rp−1lrp...rk| det[gij]|1/2
	
,
where
β = βr1...rkrk+1dxr1 ∧· · · ∧dxrk+1,
(sum over r1 < · · · < rk+1) is the usual coordinate expression for β. The coordinate formula is messy to
prove directly. However it follows fairly readily from integration by parts in local coordinates and that fact
that δ is the adjoint of d, a fact that will be proved in Chapter 7 (see Corollary 7.2.13 and Exercise 7.5-7).
We now express the divergence of a vector ﬁeld X ∈X(M) in terms of δ. We deﬁne the divergence
divg(X) with respect to a pseudo-Riemannian metric g to be the divergence of X with respect to the
pseudo-Riemannian volume µ = µ(g); that is, £Xµ = divg(X)µ. To compute the divergence, we prepare a
lemma.
6.5.22 Lemma.
iXµ = ∗X♭.
Proof.
Let v2, . . . , vn ∈TxM be orthonormal and orthogonal to X(n). From Proposition 6.2.10, we have
iXµ(v2, . . . , vn) = µ(X(x), v2, . . . , vn)
=
+
g(X(x), X(x)).
On the other hand, we claim that
∗X♭=
+
g(X(x), X(x)) v♭
2 ∧· · · ∧v♭
n
Indeed, this may be veriﬁed using the deﬁnition in Proposition 6.2.12 with x a 1-form and β = X♭. Using
this formula for ∗X♭, we get
∗X♭(x)(v2, . . . , vn) =
+
g(X(x), X(n))
= iXµ(v2, . . . , vn).
Equality on such v2, . . . , vn implies equality, as is readily seen.
■
This may be seen in coordinates using the formula (6.2.12) of §6.2.
6.5.23 Proposition.
Let g be a pseudo-Riemannian metric on the orientable n-manifold M. Then
divg(X) = −δX♭
(6.5.3)
In (positively oriented) local coordinates
divg(X) = | det[gij]|−1/2 ∂
∂xk

| det[gij]|1/2Xk
(6.5.4)

6.5 Orientation, Volume Elements and the Codiﬀerential
395
Proof.
Let
£Xµ = diXµ = d∗X♭
by the lemma. But then
(divg X)µ = −∗δX♭= −(δX♭)∗1
by the deﬁnition of δ and the formula for ∗∗. Since ∗1 = µ, we get equation (6.5.3). To prove formula (6.5.4),
write µ = | det[gij]|1/2dx1 ∧· · · ∧dxn and compute £Xµ = diXµ in these coordinates. We have
iXµ = det[gij]1/2Xk(−1)kdx1 ∧· · · ∧dxk ∧· · · ∧dxn
and so
diXµ =
 ∂
∂xk | det[gij]|1/2Xk

dx1 ∧· · · ∧dxn.
= 1
2
1
| det[gij]|1/2

| det[gij]|∂/∂xkXk

µ.
■
6.5.24 Deﬁnition.
The Laplace–Beltrami operator on functions on a orientable pseudo-Riemannian
manifold is deﬁned by ∇2 = div ◦grad.
Thus, in a positively oriented chart, equation (6.5.4) gives
∇2f = | det gij|−1/2 ∂
∂xk

glk| det gij|1/2 ∂f
∂xl

.
(6.5.5)
Exercises
⋄6.5-1.
Let f : Rn →Rn be a diﬀeomorphism with positive Jacobian and f(0) = 0. Prove that there is a
continuous curve ft of diﬀeomorphisms joining f to the identity.
Hint: First join f to Df(0) by gt(x) = f(tx)/t.
⋄6.5-2.
If t is a tensor density of M, that is, t = t′ ⊗µ, where µ is a volume form, show that
£Xt = (£Xt′) ⊗µ + (divµ X)t′ ⊗µ.
⋄6.5-3.
A map A : E →E is said to be derived from a variational principle if there is a function L : E →R
such that
dL(x)˙v = ⟨A(x), v⟩,
where ⟨, ⟩is an inner product on E. Prove Vainberg’s theorem: A comes from a variational principle if and
only if DA(x) is a symmetric linear operator. do this by applying the Poincar´e lemma to the one-form
α(x)˙v = ⟨A(x), v⟩(see Marsden and Hughes [1983]).
⋄6.5-4.
Show in three diﬀerent ways that the sphere Sn is orientable by using Proposition 6.5.2 and the
two charts given in Figure 3.1.2, by constructing an explicit n-form, and by using Corollary 6.5.9.
⋄6.5-5.
Use formula (6.5.5) to show that in polar coordinates (r, θ) in R2,
∇2f = ∂2f
∂r2 + 1
r2 + ∂2f
∂θ2 + 1
r
∂f
∂r
and that in spherical coordinates (ρ, θ, φ) in R3,
∇2f = ∂
∂µ

(1 −µ2)∂f
∂µ

+
1
1 −µ2
∂2f
∂θ2 + ρ∂2f
∂ρ2
where µ = cos φ.

396
6. Diﬀerential Forms
⋄6.5-6.
Let (M, µ) be a volume manifold. Prove the identity
divµ[X, Y ] = X[divµ Y ] −Y [divµ X].
⋄6.5-7.
Let f : M →N be a diﬀeomorphism of connected oriented manifolds with boundary. Assuming
that Tmf : TmM →Tf(m)N is orientation preserving for some m ∈Int(M), show that J(f) > 0 on M; that
is, f is orientation preserving.
⋄6.5-8.
Let g be a pseudo-Riemannian metric on M and deﬁne gλ = λg for λ > 0. Let ∗λ be the Hodge-star
operator deﬁned by gλ and set ∗1 = ∗. Show that if λ ∈Ωk(M), then
∗λα = λ(n/2)−k ∗α.
⋄6.5-9.
In R3 equipped with the standard Euclidean metric, show that for any vector ﬁeld F and any
function f we have: div F = −δF ♭, curl F = (δ ∗F ♭)#, and grad f = −(∗δ ∗f)#.
⋄6.5-10.
Show that if M and N are orientable, then so is M × N.
⋄6.5-11.
(i) Let σ : M →M be an involution of M, that is, σ ◦σ = identity, and assume that the
equivalence relation deﬁned by σ is regular, that is, there exists a surjective submersion π : M →N
such that π−1(n) = {m, σ(m)}, where π(m) = n. Let
Ω±(M) = { α ∈Ω(M) | σ∗α = ±α }
be the ±1 eigenspaces of σ∗. Show that π∗: Ω(N) →Ω+(M) is an isomorphism.
Hint: To show that range π∗= Ω+(M), note that π ◦σ = π implies range(π∗) ⊂Ω+(M). For the
converse conclusion, note that Tmπ is an isomorphism, so a form at π(m) uniquely determines a form
at m. Show that this resulting form is smooth by working in a chart on M diﬀeomorphic to a chart
on N.
(ii) Show that RPn is orientable if n is odd and is not orientable if n is even.
Hint: In (i) take M = Sn ⊂Rn+1, σ(x) = x, and N = RPn. Let ω be a volume element on Sn
induced by a volume element of Rn+1. Show that σ∗ω = (−1)n+1ω. Now apply (i) to orient RPn for
n odd. If n is even, let ν be an n-form on RPn; then π∗ν = fω. Show that f(x) = −f(−x) so f must
vanish at a point of Sn.
⋄6.5-12.
In Example 3.4.10C, the M¨obius band M was deﬁned as the quotient of R2 by the equivalence
relation (x, y) ∼(x + k, (−1)ky) for any k ∈Z.
(i) Show that this equivalence relation is regular. Show that M is a non-compact, connected, two-manifold.
(ii) Deﬁne the map σ : R2 →R2 by σ(x, y) = (x + 1, −y). Show that π ◦σ = σ, where σ : R2 →M, is the
canonical projection. If ν ∈Ω2(M) deﬁne f ∈F(R2) by π∗ν = fω, where ω is an area form on R2.
Show that f(x + 1, −y) = −f(x, y).
(iii) Conclude that f must vanish at a point of R2, and that this implies M is not orientable.
⋄6.5-13.
The Klein bottle K is deﬁned as the quotient of R2 by the equivalence relation deﬁned by
(x, y) ∼(x + n, (−1)ny + m)
for any n, m ∈Z.
(i) Show that this equivalence relation is regular. Show that K is a compact, connected, smooth, two-
manifold.
(ii) Use Exercise 6.5-12(ii), (iii) to show that K is non-orientable.

6.5 Orientation, Volume Elements and the Codiﬀerential
397
⋄6.5-14 (Orientation in vector bundles).
Let π : E →B be a vector bundle with ﬁnite dimensional ﬁber
modeled on a vector space E, and assume B is connected. The vector bundle is said to be orientable if the
line bundle L = E∗∧· · · ∧E∗(dim(E) times) has a global nowhere vanishing section. An orientation of
E is an equivalence class of global nowhere vanishing sections of L under the equivalence relation: σ1 ∼σ2
iﬀthere exists f ∈F(B), f > 0 such that σ2 = fσ1.
(i) Prove that E is orientable iﬀL is a trivial line bundle. Show that E admits exactly two orientations.
Show that an orientation [σ] of E induces an orientation in each ﬁber of E.
(ii) Show that a manifold M is orientable iﬀits tangent bundle is an oriented vector bundle.
(iii) Let E, F be vector bundles over the same base. Show that if two of E, F, and E ⊕F are orientable,
so is the third.
(iv) Let E, F be vector bundles (over possibly diﬀerent bases). Show that E × F is orientable if and only
if E and F are both orientable. Conclude that if M, N are ﬁnite dimensional manifolds, then M × N
is orientable if and only if M and N are both orientable.
(v) Show that E ⊕E∗is an orientable vector bundle if E is any vector bundle.
Hint: Consider the section
Ω(x)((e1, α1), (e2, α2)) = ⟨α2, e1⟩−⟨α1, e2⟩
of (E ⊕E∗) ∧(E ⊕E∗).
(vi) Choose an orientation of the vector space E and assume B admits partitions of unity. Show that the
vector bundle atlas all of whose change of coordinate maps have positive determinant relative to the
orientation of E, when restricted to the ﬁber.
Hint: If E is oriented and ψ : π−1(U) →U ′ × E is a vector bundle chart with U ′ open in the
model space of B, and U is connected in B, deﬁne φ : π−1(U) →U ′ × F by φ(e) = ψ(e) if the
linear map ψb : π−1(b) →F is orientation preserving and φ(e) = (α ◦ψ)(e), where α : F →F is an
orientation reversing isomorphism of F, if ψb is orientation reversing. For the converse, choose a volume
form ω on F and deﬁne on a vector bundle chart (V, φ) of E, with U connected in B, π−1(U) = V ,
ω(U) : U →L|U by
ω(U)(b)(e1, . . . , er) = ω(φ0(b))(φb(e1), . . . , φb(er)),
where r = dim F, b ∈B, ei ∈π−1(b), i = 1, . . . , r, and φ0 : U →U ′ is the induced chart on B. Show
that if b ∈U1 ∩U2, then
ω(U1)(b) = detω

φ1
b ◦(φ2
b)−1
ω(U2)
where (π−1(Ui), φi) are vector bundle charts, Ui connected, i = 1, 2. Next, glue the ω(U)’s together
using a partition of unity.
(vii) Use (iv) to show that if E and F are oriented, then there exists a vector bundle atlas on E such that all
φb : π−1(b) →F are orientation preserving isomorphisms. Such an atlas is called positively oriented.
(viii) Let E, F, B be ﬁnite dimensional, E oriented by σ and B oriented by ω. Show that π∗ω ∧σ is a
volume form on E. Conclude that an orientation of B and an orientation of F uniquely determine an
orientation of E as a manifold. This orientation is called the local product orientation.

398
6. Diﬀerential Forms
(ix) Show that any vector bundle π : E →B with ﬁnite dimensional ﬁber has an oriented double cover
˜π : ˜E →˜B, where
˜B = { (b, [µb]) | b ∈B, [µb] is an orientation of π−1(b) },
p : ˜B →B is the map p(b, [µb]) = b, and ˜E = p∗E. Find the vector bundle charts of ˜E and show
that the ﬁber at (b, [µb]) is oriented by [˜p∗(µb)], where ˜p : ˜E →E is the mapping induced by p on the
pull-back bundle ˜E. If E = TB, what is ˜E?
⋄6.5-15.
Let M be a compact manifold and M the space of Riemannian metrics on M. Let T be a space of
tensor ﬁelds on M of a ﬁxed type. A mapping Φ : M →T is called covariant if for every diﬀeomorphism
φ : M →M, we have Φ(φ∗g) = φ∗Φ(g).
(i) Show that covariant maps satisfy the identity
DΦ(g) · £Xg = £XΦ(g)
for every vector ﬁeld X. (Assume Φ is diﬀerentiable and M, T are given suitable Banach space topolo-
gies.)
(ii) Show that if M is oriented, then the map g →µ(g), the volume element of g, is covariant. Is the
identity in (i) anything interesting?
⋄6.5-16.
Let X be a vector ﬁeld density on the oriented n-manifold M; that is, X = F ⊗µ, where F is a
vector ﬁeld and µ is a density. Use Exercise 6.5-2 to deﬁne div X and to show it makes intrinsic sense.
⋄6.5-17.
Show that an orientable line bundle over a base admitting partitions of unity is trivial.
Hint: Since the bundle is orientable there exist local charts which when restricted to each ﬁber give positive
functions. Regard these as local sections and then glue.
⋄6.5-18.
Let π : E →S1 be a vector bundle with n-dimensional ﬁber. If E is orientable show that it is
isomorphic to a trivial bundle over S1. Show that if ρ : F →S1 is a non-orientable vector bundle with n-
dimensional ﬁber and if E is non-orientable, then E and F are isomorphic. Conclude that there are exactly
two isomorphic classes of vector bundles with n-dimensional ﬁber over S1. Construct a representative for
the class corresponding to the non-orientable case.
Hint: Construct a non-orientable vector bundle like the M¨obius band: the equivalence relation has a factor
(−1)2n−1 if the dimension of the ﬁber is 2n −1 or 2n. To prove non-orientability, proceed as in Exercise
6.5-12.
⋄6.5-19.
Let {e1, . . . , en+1} be the standard bases of Rn+1 and
Ωn+1 = e1 ∧· · · ∧en+1
be the induced volume form. On Sn deﬁne ωn ∈Ωn(Sn) by
ωn(s)(v1, . . . , vn) = Ωn+1(s, v1, . . . , vn)
for s ∈Sn, v1, . . . , vn ∈TsSn.
(i) Use Proposition 6.5.8 to show that ωn is a volume form on Sn; ωn is called the standard volume
form on Sn.
(ii) Let f : R+ × Rn+1\{0} be given by f(t, s) = ts, where R+ is deﬁned to be the set { t ∈R | t > 0 }.
Show that if R+ is oriented by dt, Sn by ωn, and Rn+1 by Ωn+1, then (Jf)(t, s) = tn. Conclude that
f is orientation preserving.

Page 399
7
Integration on Manifolds
The integral of an n-form on an n-manifold is deﬁned by piecing together integrals over sets in Rn using
a partition of unity subordinate to an atlas. The change of variables theorem guarantees that the integral
is well deﬁned, independent of the choice of atlas and partition of unity. Two basic theorems of integral
calculus, the change of variables theorem and Stokes’ theorem, are discussed in detail along with some
applications.
7.1
The Deﬁnition of the Integral
The aim of this section is to deﬁne the integral of an n-form on an oriented n-manifold M and prove a few
of its basic properties. We begin with a summary of the basic results in Rn.
Integration on Rn.
Suppose f : Rn →R is continuous and has compact support. Then

f dx1 . . . dxn is
deﬁned to be the Riemann integral over any rectangle containing the support of f.
7.1.1 Deﬁnition.
Let U ⊂Rn be open and ω ∈Ωn(U) have compact support. If, relative to the standard
basis of Rn,
ω(x) = 1
n!ωi1...in(x)dxi1 ∧· · · ∧dxin = ω1...n(x)dx1 ∧· · · ∧dxn,
where the components of ω are given by
ωi1...in(x) = ω(x)(ei1, . . . , ein),
then we deﬁne

U
ω =

Rn ω1...n(x)dx1 · · · dxn.

400
7. Integration on Manifolds
Recall that if ζ is any integrable function and f : Rn →Rn is any diﬀeomorphism, the change of
variables theorem states that ζ ◦f is integrable and

Rn ζ(x1, . . . , xn)dx1 · · · dxn
=

Rn |JΩf(x1, . . . , xn)|(ζ ◦f)(x1, . . . , xn)dx1 · · · dxn,
(7.1.1)
where Ω= dx1 ∧· · · ∧dxn is the standard volume form on Rn and JΩf is the Jacobian determinant of f
relative to Ω. This change of variables theorem can be rephrased in terms of pull backs in the following form.
7.1.2 Theorem (Change of Variables in Rn).
Let U and V be open subsets of Rn and suppose f : U →V
is an orientation-preserving diﬀeomorphism. If ω ∈Ωn(V ) has compact support, then f ∗ω ∈Ωn(U) has
compact support as well and

U
f ∗ω =

V
ω
(7.1.2)
Proof.
If ω = ω1...ndx1 ∧· · · ∧dxn, then f ∗ω = (ω1...n ◦f)(JΩf)Ω, where the n-form Ω= dx1 ∧· · · ∧dxn
is the standard volume form on Rn. As discussed in §6.5, JΩf > 0. Since f is a diﬀeomorphism, the support
of f ∗ω is f −1(supp ω), which is compact. Then from equation (7.1.1),

U
f ∗ω =

Rn(ω1...n ◦f)(JΩf)dx1 · · · dxn
=

Rn ω1...ndx1 · · · dxn =

V
ω.
■
Integration on a Manifold.
Suppose that (U, ϕ) is a chart on a manifold M and ω ∈Ωn(M) has
compact support. If supp(ω) ⊂U, we may form ω|U, which has the same support. Then ϕ∗(ω|U) has
compact support, so we may state the following.
7.1.3 Deﬁnition.
Let M be an orientable n-manifold with orientation [Ω]. Suppose ω ∈Ωn(M) has
compact support C ⊂U, where (U, ϕ) is a positively oriented chart. Then we deﬁne

(ϕ)
ω =

ϕ∗(ω|U).
7.1.4 Proposition.
Suppose ω ∈Ωn(M) has compact support C ⊂U ∩V , where (U, ϕ), and (V, ψ) are
two positively oriented charts on the oriented manifold M. Then

(ϕ)
ω =

(ψ)
ω.
Proof.
By Theorem 7.1.2,

ϕ∗(ω|U) =
 
ψ ◦ϕ−1
∗ϕ∗(ω|U).
Hence

ϕ∗(ω|U) =

ψ∗(ω|U). (Recall that for diﬀeomorphisms, we have f∗= (f −1)∗and (f ◦g)∗=
f∗◦g∗.)
■

7.1 The Deﬁnition of the Integral
401
Thus, we may deﬁne

U ω =

(ϕ) ω, where (U, ϕ) is any positively oriented chart containing the compact
support of ω. More generally, we can deﬁne

M ω where ω has compact support not necessarily lying in a
single chart as follows.
7.1.5 Deﬁnition.
Let M be an oriented manifold and A an atlas of positively oriented charts. Let P =
{(Uα, ϕα, gα)} be a partition of unity subordinate to A. Deﬁne ωα = gαω (so ωα has compact support in
some Ui) and let

P
ω =

α

ωα.
(7.1.3)
7.1.6 Proposition.
(i) The sum (7.1.3) contains only a ﬁnite number of nonzero terms.
(ii) For any other atlas of positively oriented charts and subordinate partition of unity Q we have

P
ω =

Q
ω.
The common value is denoted

M ω, and is called the integral of ω ∈Ωn(M).
Proof.
For any m ∈M, there is a neighborhood U such that only a ﬁnite number of gα are nonzero on U.
By compactness of supp ω, a ﬁnite number of such neighborhoods cover the support of ω. Hence only a ﬁnite
number of gα are nonzero on the union of these U. For (ii), let P = {(Uα, ϕα, gα)} and Q = {(Vβ, ψβ, hβ)}
be two partitions of unity with positively oriented charts. Then the functions {gαhβ} satisfy gαhβ(m) = 0
except for a ﬁnite number of indices (α, β), and ΣαΣβgαhβ(m) = 1, for all m ∈M. Since Σβhβ = 1, we get

P
ω =

α

gαω =

β

α

hβgαω =

α

β

gαhβω =

Q
ω.
■
Global Change of Variables.
This result can now be formulated very elegantly as follows.
7.1.7 Theorem (Change of Variables Theorem).
Suppose M and N are oriented n-manifolds and f :
M →N is an orientation-preserving diﬀeomorphism. If ω ∈Ωn(N) has compact support, then f ∗ω has
compact support and

N
ω =

M
f ∗ω.
(7.1.4)
Proof.
First, note that
supp(f ∗ω) = f −1(supp(ω)),
which is compact. To prove equation (7.1.4), let {(Ui, ϕi)} be an atlas of positively oriented charts of M and
let P = {gi} be a subordinate partition of unity. Then {(f(Ui), ϕi ◦f −1)} is an atlas of positively oriented
charts of N and Q = {gi ◦f −1} is a partition of unity subordinate to the covering {f(Ui)}. By Proposition
7.1.6,

M
f ∗ω =

i

M
gif ∗ω =

i

Rn ϕi∗(gif ∗ω)
=

i

Rn ϕi∗(f −1)∗(gi ◦f −1)ω
=

i

Rn(ϕi ◦f −1)∗(gi ◦f −1)ω
=

N
ω.
■

402
7. Integration on Manifolds
This result is summarized by the following commutative diagram:
Ωn(M)
Ωn(N)
R

M

N
f∗
✲
❅
❅
❅
❅
❘




✠
✛
f ∗
7.1.8 Deﬁnition.
Let (M, µ) be a volume manifold. Suppose f ∈F(M) and f has compact support. Then
we call

M fµ the integral of f with respect to µ.
The reader can check that since the Riemann integral is R-linear, so is the integral just deﬁned.
Measures (Optional).
The next theorem will show that the integral deﬁned by equation (7.1.4) can be
obtained in a unique way from a measure on M. (The reader unfamiliar with measure theory can ﬁnd the
necessary background in Royden [1968]; this result will not be essential for future sections.) The integral we
have described can clearly be extended to all continuous functions with compact support. Then we have the
following.
7.1.9 Theorem (Riesz Representation Theorem).
Let (M, µ) be a volume manifold. Let β denote the col-
lection of Borel sets of M, the σ-algebra generated by the open (or closed, or compact) subsets of M. Then
there is a unique measure mµ on β such that for every continuous function of compact support

M
f dmµ =

M
fµ.
(7.1.5)
Proof.
Existence of such a measure mµ is proved in books on measure theory, for example Royden [1968].
For uniqueness, it is enough to consider bounded open sets (by the Hahn extension theorem). Thus, let U be
open in M, and let CU be its characteristic function. We construct a sequence of C∞functions of compact
support ϕn such that ϕn ↓CU, pointwise. Hence from the monotone convergence theorem,

ϕnµ =

ϕn dmµ →

CU dmµ = mµ(U).
Thus, mµ is unique.
■
The space Lp(M, µ), p ∈R, consists of all measurable functions f such that |f|p is integrable. For p ≥1,
the norm
∥f∥p =

|f|pdmµ
1/p
makes Lp(M, µ) into a Banach space (functions that diﬀer only on a set of measure zero are identiﬁed).
The use of these spaces in studying objects on M itself is discussed in §7.4. The next propositions give
an indication of some of the ideas. If F : M →N is a measurable mapping and mM is a measure on
M, then F∗mM is the measure on N deﬁned by F∗mM(A) = mM(F −1(A)). If F is bijective, we set
F ∗(mN) = (F −1)∗mN. If f : M →R is an integrable function, then fmM is the measure on M deﬁned by
(fmM)(A) =

A
fdmM
for every measurable set A in M.

7.1 The Deﬁnition of the Integral
403
7.1.10 Proposition.
Suppose M and N are orientable n-manifolds with volume forms µM and µN and
corresponding measures mM and mN. Let F be an orientation preserving C1 diﬀeomorphism of M onto N.
Then
F ∗mN =

J(µM,µN)F

mM.
(7.1.6)
Proof.
Let f be any C∞function with compact support on M. By Theorem 7.1.7,

N
f dmN =

N
f µN =

M
F ∗(fµN) =

M
(f ◦F)

J(µM,µN)F

µM
=

M
(f ◦F)

J(µM,µN)F

dmM.
As in the proof of Theorem 7.1.9, this relation holds for f chosen to be the characteristic function of F(A).
That is,
mN(F(A)) =

A

J(µM,µN)F

dmM.
■
Jacobians and Divergence.
In preparation for the next result, we notice that on a volume manifold
(M, µ), the ﬂow Ft of any vector ﬁeld X is orientation preserving for each t ∈R (regard this as a statement
on the domain of the ﬂow, if the vector ﬁeld is not complete). Indeed, since Ft is a diﬀeomorphism, Jµ(Ft)
is nowhere zero; since it is continuous in t and equals one at t = 0, it is positive for all t.
7.1.11 Proposition.
Let M be an orientable manifold with volume form µ and corresponding measure
mµ. Let X be a (possibly time-dependent) C1 vector ﬁeld on M with ﬂow Ft. The following are equivalent
(if the ﬂow of X is not complete, the statements involving it are understood to hold on its domain):
(i) divµ X = 0;
(ii) JµFt = 1 for all t ∈R;
(iii) Ft∗mµ = mµ for all t ∈R;
(iv) F ∗
t µ = µ for all t ∈R;
(v)

M fdmµ =

M(f ◦Ft)dmµ for all f ∈L1(M, µ) and all t ∈R.
Proof.
Statement (i) is equivalent to (ii) by Corollary 6.5.19. Statement (ii) is equivalent to (iii) by
equation (7.1.6) and to (iv) by deﬁnition. We shall prove that (ii) is equivalent to (v). If JµFt = 1 for all
t ∈R and f is continuous with compact support, then

M
(f ◦Ft)µ =

M
(f ◦Ft)(F ∗
t µ) =

M
F ∗
t (fµ) =

M
fµ.
Hence, by uniqueness in Theorem 7.1.9, we have

M f dmµ =

M(f ◦Ft)dmµ for all integrable f, and so (ii)
implies (v). Conversely, if

M
(f ◦Ft)dmµ =

M
f dmµ
then taking f to be continuous with compact support, we see that

M
(f ◦Ft)µ =

M
fµ =

M
F ∗
t (fµ) =

M
(f ◦Ft)F ∗
t µ
=

M
(f ◦Ft)(JµFt)µ.
Thus, for every integrable f,

M
(f ◦Ft)dmµ =

M
(f ◦Ft)(JµFt)dmµ.
Hence JµFt = 1, and so (v) implies (ii).
■

404
7. Integration on Manifolds
Transport Theorem.
The following result is central to continuum mechanics (see Example 7.1.13 below
and §8.2 for applications).
7.1.12 Theorem (Transport Theorem).
Let (M, µ) be a volume manifold and X a vector ﬁeld on M with
ﬂow Ft. For f ∈F(M × R) and letting ft(m) = f(m, t), we have
d
dt

Ft(U)
ftµ =

Ft(U)
∂f
∂t + divµ(ftX)

µ
(7.1.7)
for any open set U in M.
Proof.
By the ﬂow characterization of Lie derivatives and Proposition 6.5.17, we have
d
dtF ∗
t (ftµ) = F ∗
t
∂f
∂t µ

+ F ∗
t £X(ftµ)
= F ∗
t
∂f
∂t µ

+ F ∗
t [(£Xft)µ + ft(divµ X)µ]
= F ∗
t
	∂f
∂t + divµ(ftX)

µ

.
Thus, by the change of variables formula,
d
dt

Ft(U)
ftµ = d
dt

U
F ∗
t (ftµ) =

U
F ∗
t
	∂f
∂t + divµ(ftX)

µ

=

Ft(U)
∂f
∂t + divµ(ftX)

µ.
■
7.1.13 Example.
Let ρ(x, t) be the density of an ideal ﬂuid moving in a compact region of R3 with smooth
boundary. One of the basic assumptions of ﬂuid dynamics is conservation of mass: the mass of the ﬂuid
in the open set U remains unchanged during the motion described by a ﬂow Ft. This means that
d
dt

Ft(U)
ρ(x, t) d3x = 0
(7.1.8)
for all open sets U. By the transport theorem, equation (7.1.8) is equivalent to the equation of continuity
∂ρ
∂t + div(ρu) = 0,
(7.1.9)
here u represents the velocity of the ﬂuid particles. We shall return to this example in §8.2.
♦
Recurrence.
As another application of Proposition 7.1.11, we prove the following.
7.1.14 Theorem (Poincar´e Recurrence Theorem).
Let (M, µ) be a volume manifold, mµ the correspond-
ing measure, and X a time-independent divergence-free vector ﬁeld with ﬂow Ft. Suppose A is a measurable
set in M such that mµ(A) < ∞, Ft(x) exists for all t ∈R if x ∈A, and Ft(A) ⊂A. Then for each measurable
subset B of A and T ≥0, there exists S ≥T such that B ∩FS(B) ̸= ∅. Therefore, a trajectory starting in
B returns inﬁnitely often to B.
Proof.
By Proposition 7.1.11, the sets B, FT (B), F2T (B), . . . all have the same ﬁnite measure. Since
mµ(A) < ∞, they cannot all be disjoint, so there exist integers k > l > 0 satisfying
FkT (B) ∩FlT (B) ̸= ∅.
Since FkT = (FT )k (as X is time-independent), we get
F(k−l)T (B) ∩B ̸= ∅.
■

7.1 The Deﬁnition of the Integral
405
The Poincar´e recurrence theorem is one of the forerunners of ergodic theory, a topic that will be discussed
brieﬂy in §7.4. A related result is the following.
7.1.15 Theorem (Schwarzschild Capture Theorem).
Let (M, µ) be a volume manifold, X a time-independent
divergence-free vector ﬁeld with ﬂow Ft, and A a measurable subset of M with ﬁnite measure. Assume that
for every x ∈A, the trajectory t →Ft(x) exists for all t ∈R. Then for almost all x ∈A (relative to mµ)
the following are equivalent:
(i) Ft(x) ∈A for all t ≥0;
(ii) Ft(x) ∈A for all t ≤0.
Proof.
Let A1 = 
t≥0 Ft(A) be the set of points in A which have their future trajectory completely in A.
Similarly, consider A2 = 
t≤0 Ft(A). By Proposition 7.1.11, for any τ ≥0,
µ(A1) = µ(F−τ(A1)) = µ


t≥−τ
Fτ(A)


which shows, by letting τ →∞, that
µ(A1) = µ

t∈R
Ft(A)

= µ(A1 ∩A2).
Reasoning similarly for A2, we get µ(A1) = µ(A1 ∩A2) = µ(A2), so that
µ(A1\(A1 ∩A2)) = µ(A2\(A1 ∩A2)) = 0.
Let
S = (A1(A1 ∩A2)) ∪(A2(A1 ∩A2));
then mµ(S) = 0 and S ⊂A. Moreover, we have A1S = A1∩A2 = A2S, which proves the desired equivalence.
■
So far only integration on orientable manifolds has been discussed. A similar procedure can be carried
out to deﬁne the integral of a one-density (see §6.5) on any manifold, orientable or not. The only changes
needed in the foregoing deﬁnitions and propositions are to replace the Jacobians with their absolute values
and to use the deﬁnition of divergence with respect to a given density as discussed in §6.5. All deﬁnitions
and propositions go through with these modiﬁcations.
Vector Valued Forms.
If F is a ﬁnite-dimensional vector space, F-valued one-forms and one-densities
can also be integrated in the following way. If ω = l
i=1 ωifi, where f1, . . . , fn is an ordered basis of F, then
we set

M
ω =
l

i=1

M
ωi

fi ∈F.
It is easy to see that this deﬁnition is independent of the chosen basis of F and that all the basic properties
of the integral remain unchanged. On the other hand, the integral of vector-bundle-valued n-forms on M
is not deﬁned unless additional special structures (such as triviality of the bundle) are used. In particular,
integration of vector or general tensor ﬁelds is not deﬁned.

406
7. Integration on Manifolds
Exercises
⋄7.1-1.
Let M be an n-manifold and µ a volume form on M. If X is a vector ﬁeld on M with ﬂow Ft show
that
d
dt(Jµ(Ft)) = Jµ(Ft)(divµ X ◦Ft).
Hint: Compute (d/dt)F ∗
t µ using the Lie derivative formula.
⋄7.1-2.
Prove the following generalization of the transport theorem
d
dt

Ft(V )
ωt =

Ft(V )
∂ωt
∂t + £Xωt

,
where ωt is a time–dependent k-form on M and V is a k-dimensional submanifold of M.
⋄7.1-3.
(i) Let ϕ : S1 →S1 be the map deﬁned by ϕ(eiθ) = e2iθ, where θ ∈[0, 2π]. Let, by abuse of notion,
dθ denote the standard volume of S1. Show that the following identity holds:

S1 ϕ∗(dθ) = 2

S1 dθ.
(ii) Let ϕ : M →N be a smooth surjective map. Then ϕ called a k-fold covering map if every n ∈N
has an open neighborhood V such that ϕ−1(V ) = U1 ∪· · · ∪Uk, are disjoint open sets each of which
is diﬀeomorphic by ϕ to V . Generalize (i) in the following way. If ω ∈Ωn(N) is a volume form, show
that

M
ϕ∗ω = k

N
ω.
⋄7.1-4.
Deﬁne the integration of Banach space valued n-forms on an n-manifold M. Show that if the Banach
space is Rl, you recover the coordinate deﬁnition given at the end of this section. If E, F are Banach spaces
and A ∈L(E, F), deﬁne A∗∈L(Ω(M, E), Ω(M, F)) by (A∗α)(m) = A(α(m)). Show that

M

◦A∗= A ◦

M

on Ωn(M, E).
⋄7.1-5.
Let M and N be oriented manifolds and endow M × N with the product orientation. Let pM :
M ×N →M and pN : M ×N →N be the projections. If α ∈Ωdim M(M) and β ∈Ωdim N(N) have compact
support show that
α × β := (pM
∗α) ∧(pN
∗β)
has compact support and is a (dim M + dim N)-form on M × N. Prove Fubini’s Theorem

M×N
α × β =

M
α
 
N
β

.
⋄7.1-6 (Fiber Integral).
Let ϕ : M →N be a surjective submersion, where dim M = m and dim N = n.
The map ϕ is said to be orientable if there exists η ∈Ωp(M), where p = m −n, such that for each y ∈N,
jy∗η is a volume form on ϕ−1(y), where jy : ϕ−1(y) →M is the inclusion. An orientation of ϕ is an
equivalence class of p-forms under the relation: η1 ∼η2 iﬀthere exists f ∈F(M), f > 0 such that η2 = fη1.
(i) If ϕ : M →N is a vector bundle, show that orientability of ϕ is equivalent to orientability of the
vector bundle as deﬁned in Exercise 6.5-13.

7.1 The Deﬁnition of the Integral
407
(ii) If ϕ is oriented by η and N by ω, show that ϕ∗ω ∧η is a volume form on M. The orientation on
M deﬁned by this volume is called the local product orientation of M (compare with Exercise
6.5-13(vi)).
(iii) Let
Ωk
ϕ(M) := { α ∈Ωk(M) | ϕ−1(K) ∩supp(α) is compact,
for any compact set K ⊂N },
the ﬁber-compactly supported k-forms on M. Show that Ωk
ϕ(M) is an F(M)-submodule of Ωk(M),
and is invariant under the interior product, exterior diﬀerential, and Lie derivative.
(iv) If α ∈Ωk+p
ϕ
(M), k ≥0 and y ∈N, deﬁne a p-form αy on ϕ−1(y), with values in T ∗
y N ∧· · · ∧T ∗
y N (k
times) by
[αy(x)(u1, . . . , up)](Txϕ(v1), . . . , Txϕ(vk))
= α(x)(v1, . . . , vk, u1, . . . , up),
where ϕ(x) = y, x ∈M, v1, . . . , vk ∈TxM, and u1, . . . , up ∈ker(Txϕ) = Tx(ϕ−1(y)). Assume ϕ is
oriented. Deﬁne the ﬁber integral

ﬁb
: Ωk+p
ϕ
(M) →Ωk(N)
by

ﬁb
α

(x) =

ϕ−1(y)
αy,
if
ϕ(x) = y;
the right-hand side is understood as the integral of a vector-valued p-form on the oriented p-manifold
ϕ−1(y).
(a) Prove that

ﬁb α is a smooth k-form on N.
Hint: Use charts in which ϕ is a projection and apply the theorem of smoothness of the integral
with respect to parameters.
(b) Show that if ϕ : M →N is a locally trivial ﬁber bundle with N paracompact,

ﬁb is surjective.
(v) Let β ∈Ωl(N) have compact support and let α ∈Ωk+p
ϕ
(M). Show that ϕ∗β ∧α ∈Ωk+l+p
ϕ
(M) and
that

ﬁb
(ϕ∗β ∧α) = β ∧

ﬁb
α.
Hint: Let E = T ∗
y N ∧· · · ∧T ∗
y N (k times) and let F be the wedge product l + k times. Deﬁne
A ∈L(E, F) by A(γ) = β(y) ∧γ and show that (ϕ∗β ∧α)y = A∗(αy) using the notation of Exercise
7.1-4. Then apply

ﬁb to this identity and use Exercise 7.1-4.
(vi) Assume N is paracompact and oriented, ϕ is oriented, and endow M with the local product orientation.
Prove the following iterated integration (Fubini-type) formula

M
=

N
◦

ﬁb
by following the three steps below.

408
7. Integration on Manifolds
Step 1: Using a partition of unity, reduce to the case M = N × P where ϕ : M →N is the projection
and M, N, P are Euclidean spaces.
Step 2: Use (v) and Exercise 7.1-5 to show that for β ∈Ωn(N) and γ ∈Ωp(P) with compact support,

N

ﬁb
(β × γ) =

M
(β × γ)
Step 3: Since M, N, and P are ranges of coordinate patches, show that any ω ∈Ωm(M) with compact
support is of the form β × γ.
(vii) Let ϕ : M →N and ϕ′ : M ′ →N ′ be oriented surjective submersions and let f : M →M ′, and
f0 : N →N ′ be smooth maps satisfying f0 ◦ϕ = ϕ′ ◦f. Show that

ﬁb ◦f ∗= f ∗
0 ◦
 ′
ﬁb, where
 ′
ﬁb
denotes the ﬁber integral of ϕ′.
(viii) Let ϕ : M →N be an oriented surjective submersion and assume X ∈X(M) and Y ∈X(N) are
ϕ-related. Prove that

ﬁb
◦iX = iY ◦

ﬁb
,

ﬁb
◦d = d ◦

ﬁb
,

ﬁb
◦£X = £Y ◦

ﬁb
.
(For more information on the ﬁber integral see Bourbaki [1971] and Greub et al..)
⋄7.1-7.
Let ϕ : M →N be a smooth orientation preserving map, where M and N are volume manifolds
of dimension m and n respectively. For α ∈Ωk(M) with compact support, deﬁne the linear functional
ϕ∗α : Ωm−k →R by
(ϕ∗α)(β) =

M
ϕ∗β ∧α
for all β ∈Ωm−k(N); that is, ϕ∗α is a distributional k-form on N. If m < k, set ϕ∗α = 0. If there is a
γ ∈Ωn−m+k(N) satisfying
(ϕ∗α)(β) =

M
β ∧γ,
identify ϕ∗α with γ and say ϕ∗α is of form-type. Prove the following statements.
(i) If ϕ is a diﬀeomorphism, then ϕ∗α is the usual push-forward.
(ii) If α is a volume form, this deﬁnition corresponds to that for the push-forward of measures.
(iii) If ϕ is an oriented surjective submersion, show that ϕ∗α =

ﬁb α, as deﬁned in Exercise 7.1-6(iv).
Hint: Prove the identity

M
ϕ∗β ∧α =

N

β ∧

ﬁb
α

using Exercise 7.1-6(v) and (vi).
⋄7.1-8.
Let (M, µ) be a paracompact n-dimensional volume manifold.
(i) If (N, ν) is another paracompact n-dimensional volume manifold and f : M →N is an orientation
reversing diﬀeomorphism, show that

N ω = −

M f ∗ω for any ω ∈Ωn(N) with compact support.
Hint: Use the proof of Theorem 7.1.12.

7.1 The Deﬁnition of the Integral
409
(ii) If η ∈Ωn(M) has compact support and −M denotes the manifold M endowed with the orientation
[−µ], show that

−M
η = −

M
η.
Hint: If A = {(Ui, ϕi)} is an oriented atlas for (M, [µ]), then
−A = {(Ui, ϕi ◦ψi)},
ψi(x1, . . . , xn) = (−x1, x2, . . . , xn)
is an oriented atlas for (M, [−µ]).
⋄7.1-9.
Let ωn be the standard volume form on Sn. Show that

Sn ωn = 2m+1πm
(2m −1)!!,
if n = 2m, m ≥1
and

Sn ωn = 2πm+1
m!
,
if n = 2m + 1, m ≥0
using the following steps.
(i) Let M ⊂Rn+1 be the annulus

x ∈Rn+1 | 0 < a < ∥x∥< b < ∞

and let f : ]a, b[ × Sn →A be the diﬀeomorphism f(t, s) = ts. Use Exercise 6.5-19(ii) to show that for
x ∈Rn+1,
f ∗
e−∥x∥2Ωn+1

= tne−t2(dt × ωn)
where Ωn+1 = e1 ∧· · ·∧en+1 for {e1, . . . , en+1} the standard basis of Rn+1, and where dt×ωn denotes
the product volume form on ]a, b[ × Sn.
(ii) Deduce the equality

Rn+1 e−∥x∥2Ωn+1 =
 b
a
tne−t2dt

Sn ωn.
(iii) Let a ↓0 and b ↑∞to deduce the equality
 ∞
0
tnd−t2dt

Sn ωn =
 +∞
−∞
e−u2du
n+1
.
Prove that
 ∞
−∞
e−u2du = √π,
 ∞
0
t2me−t2dt = (2m −1)!!√π
2m+1
,
and
 ∞
0
t2m+1e−t2 = m!
2 ,
to deduce the required formula for

Sn ωn.

410
7. Integration on Manifolds
7.2
Stokes’ Theorem
Stokes’ theorem states that if α is an (n −1)-form on an orientable n-manifold M, then the integral of
dα over M equals the integral of α over ∂M, the boundary of M. As we shall see in the next section, the
classical theorems of Gauss, Green, and Stokes are special cases of this result. Before stating Stokes’ theorem
formally, we need to discuss manifolds with boundary and their orientations.
7.2.1 Deﬁnition.
Let E be a Banach space and λ ∈E∗. Let
Eλ = { x ∈E | λ(x) ≥0 },
called a half-space of E, and let U ⊂Eλ be an open set (in the topology induced on Eλ from E). Call
Int U = U ∩{ x ∈E | λ(x) > 0 } the interior of U and ∂U = U ∩ker λ the boundary of U. If E = Rn and
λ is the projection on the jth factor, then Eλ is denoted by Rn
j and is called positive jth half-space. Rn
n
is also denoted by Rn
+.
We have U = Int U ∪∂U, Int U is open in U, ∂U is closed in U (not in E), and ∂U ∩Int U = ∅. The
situation is shown in Figure 7.2.1. Note that ∂U is not the topological boundary of U in E, but it is the
topological boundary of U intersected with that of Eλ. This inconsistent use of the notation ∂U is temporary.
xn
∂U
int U
Rn
+
Figure 7.2.1. Open sets in a half-space
A manifold with boundary will be obtained by piecing together sets of the type shown in the ﬁgure. To
carry this out, we need a notion of local smoothness to be used for overlap maps of charts.
7.2.2 Deﬁnition.
Let E and F be Banach spaces, λ ∈E∗, µ ∈F∗, U be an open set in Eλ, and V be an
open set in Fµ. A map f : U →V is called smooth if for each point x ∈U there are open neighborhoods
U1 of x in E and V1 of f(x) in F and a smooth map f1 : U1 →V1 such that f|U ∩U1 = f1|U ∩U1. We
deﬁne Df(x) = Df1(x). The map f is a diﬀeomorphism if there is a smooth map g : V →U which is an
inverse of f. (In this case Df(x) is an isomorphism of E with F.)
We must prove that this deﬁnition of Df is independent of the choice of f1, that is, we have to show
that if ϕ : W →E is a smooth map with W open in E such that ϕ|(W ∩Eλ) = 0, then Dϕ(x) = 0 for all
x ∈W ∩Eλ. If x ∈Int(W ∩Eλ), this fact is obvious. If x ∈∂(W ∩Eλ), choose a sequence xn ∈Int(W ∩Eλ)
such that xn →x; but then 0 = Dϕ(xn) →Dϕ(x) and hence Dϕ(x) = 0, which proves our claim.
7.2.3 Lemma.
Let U ⊂Eλ be open, ϕ : U →Fµ be a smooth map, and assume that for some x0 ∈Int U,
ϕ(x0) ∈∂Fµ. Then
Dϕ(x0)(E) ⊂∂Fµ = ker µ.
Proof.
The quotient F/ ker µ is isomorphic to R, so that ﬁxing f with µ(f) > 0, the element [f] ∈F/ ker µ
forms a basis. Therefore [f] determines the isomorphism Tf : F/ ker µ →R given by Tf([y]) = t, where t ∈R

7.2 Stokes’ Theorem
411
is the unique number for which t[f] = [y]. This isomorphism in turn deﬁnes the isomorphism
Sf : ker µ ⊕R →F
given by Sf(y, t) = y + tf which induces diﬀeomorphisms (in the sense of Deﬁnition 7.2.2) of ker µ × [0, ∞[
with Fµ and of ker µ × ]−∞, 0] with { y ∈F | µ(y) ≤0 }. Denote by p : F →R the linear map given by S−1
f
followed by the projection ker µ ⊕R →R, so that y ∈Fµ (respectively, ker µ, { y ∈F | µ(y) ≤0 }) if and
only if p(y) ≥0 (respectively, = 0, ≤0).
Notice that the relation
ϕ(x0 + tx) = ϕ(x0) + Dϕ(x0) · tx + o(tx),
where limt→0 o(tx)/t = 0, together with the hypothesis (p ◦ϕ)(x) ≥0 for all x ∈U, implies that
0 ≤(p ◦ϕ)(x0 + tx) = 0 + (p ◦Dϕ)(x0) · tx + p(o(tx)),
whence for t > 0
0 ≤(p ◦Dϕ)(x0) · x + p
o(tx)
t

.
Letting t →0, we get (p ◦Dϕ)(x0) · x ≥0 for all x ∈E. Similarly, for t < 0 and letting t →0, we get
(p ◦Dϕ)(x0) · x ≤0 for all x ∈E. The conclusion is
(Dϕ)(x0)(E) ⊂ker µ.
■
Intuitively, this says that if ϕ preserves the condition λ(x) ≥0 and maps an interior point to the boundary,
then the derivative must be zero in the normal direction. The reader may also wish to prove Lemma 7.2.3
from the implicit mapping theorem. Now we carry this idea one step further.
7.2.4 Lemma.
Let U be open in Eλ, V be open in Fµ, and f : U →V be a diﬀeomorphism. Then f
restricts to diﬀeomorphisms Int f : Int U →Int V and ∂f : ∂U →∂V.
Proof.
Assume ﬁrst that ∂U = ∅, that is, that U ∩ker λ = ∅. We shall show that ∂V = ∅and hence we
take Int f = f. If ∂V ̸= ∅, there exists x ∈U such that f(x) ∈∂V and hence by deﬁnition of smoothness
there are open neighborhoods U1 ⊂U and V1 ⊂F, such that x ∈U1 and f(x) ∈V1, and smooth maps
f1 : U1 →V1, g1 : V1 →U1 such that
f|U1 = f1,
g1|V ∩V1 = f −1|V ∩V1.
Let xn ∈U1, xn →x, yn ∈V1\∂V , and yn = f(xn). We have
Df(x) ◦Dg1(f(x)) =
lim
yn→f(x)(Df(g1(yn)) ◦Dg1(yn))
=
lim
yn→f(x) D(f ◦g1)(yn) = IdF
and similarly
Dg1(f(x)) ◦Df(x) = IdE
so that Df(x)−1 exists and equals Dg1(f(x)). But by Lemma 7.2.3, Df(x)(E) ⊂ker µ, which is impossible,
Df(x) being an isomorphism.
Assume that ∂U ̸= ∅. If we assume ∂V = ∅, then, working with f −1 instead of f, the above argument
leads to a contradiction. Hence ∂V ̸= ∅. Let x ∈Int U so that x has a neighborhood U1 ⊂U, U1 ∩∂U = ∅,
and hence ∂U1 = ∅. Thus, by the preceding argument, ∂f(U1) = ∅, and f(U1) is open in V \∂V . This
shows that f(Int U) ⊂Int V . Similarly, working with f −1, we conclude that f(Int U) ⊃Int V and hence
f : Int U →Int V is a diﬀeomorphism. But then f(∂U) = ∂V and f|∂U : ∂U →∂V is a diﬀeomorphism as
well.
■

412
7. Integration on Manifolds
Now we are ready to deﬁne a manifold with boundary.
7.2.5 Deﬁnition.
A manifold with boundary is a set M together with an atlas of charts with
boundary on M; charts with boundary are pairs (U, ϕ) where U ⊂M and ϕ(U) ⊂Eλ for some λ ∈E∗
and an atlas on M is a family of charts with boundary satisfying MA1 and MA2 of Deﬁnition 3.1.1, with
smoothness of overlap maps ϕji understood in the sense of Deﬁnition 7.2.2. See Figure 7.2.2. If E = Rn, M
is called an n-manifold with boundary.
Deﬁne
Int M =

U
ϕ−1(Int(ϕ(U)))
and
∂M =

U
ϕ−1(∂(ϕ(U)))
called, respectively, the interior and boundary of M.
The deﬁnition of Int M and ∂M makes sense in view of Lemma 7.2.4. Note that
1. Int M is a manifold (with atlas obtained from (U, ϕ) by replacing ϕ(U) ⊂Eλ by the set Int ϕ(U) ⊂E);
2. ∂M is a manifold (with atlas obtained from (U, ϕ) by replacing ϕ(U) ⊂Eλ by ∂ϕ(U) ⊂∂E = ker λ);
3. ∂M is the topological boundary of Int M in M (although Int M is not the topological interior of M).
Summarizing, we have proved the following.
7.2.6 Proposition.
If M is a manifold with boundary, then its interior Int M and its boundary ∂M are
smooth manifolds without boundary. Moreover, if f : M →N is a diﬀeomorphism, N being another manifold
with boundary, then f induces, by restriction, two diﬀeomorphisms
Int f : Int M →Int N
and
∂f : ∂M →∂N.
If n = dim M, then dim(Int M) = n and dim(∂M) = n −1.
xn
xn
x
Rn_1
Rn_1
ϕi
ϕj
ϕji
Figure 7.2.2. Boundary charts
To integrate a diﬀerential n-form over an n-manifold M, M must be oriented. If Int M is oriented, we
want to choose an orientation on ∂M compatible with it. In the classical Stokes theorem for surfaces, it is
crucial that the boundary curve be oriented, as in Figure 7.2.3.
The tangent bundle to a manifold with boundary is deﬁned in the same way as for manifolds without
boundary. Recall that any tangent vector in TxM has the form [dc(t)/dt]|t=τ, where c : [a, b] →M is a
C1 curve, a < b, and τ ∈[a, b]. If x ∈∂M, we consider curves c : [a, b] →M such that c(b) = x. If
ϕ : U →U ′ ⊂Eλ is a chart at m, then [d(ϕ ◦c)(t)/dt]|t=b in general points out of U ′, as in Figure 7.2.4.

7.2 Stokes’ Theorem
413
Figure 7.2.3. Orientation for surfaces
Therefore, TxM is isomorphic to the model space E of M even if x ∈∂M (see Figure 7.2.5). It is because
of this result that tangent vectors are derivatives of C1-curves deﬁned on closed intervals. Had we deﬁned
tangent vectors as derivatives of C1-curves deﬁned on open intervals, TyM for y ∈∂M would be isomorphic
to ker λ and not to E. In Figure 7.2.4, E = Rn, λ is the projection onto the n-th factor, and c(t) is deﬁned
on a closed interval whereas the C1-curve d(t) is deﬁned on an open interval.
∂M
M
y
Ty∂M
x
TxM
Figure 7.2.4. Tangent spaces at the boundary.
Having deﬁned the tangent bundle, all of our previous constructions including tensor ﬁelds and exterior
forms as well as operations on them such as the Lie derivative, interior product, and exterior derivative carry
over directly to manifolds with boundary. One word of caution though: the fundamental relation between
Lie derivatives and ﬂows still holds if one is careful to take into account that a vector ﬁeld on M has integral
curves which could run into the boundary in ﬁnite time and with ﬁnite velocity. (If the vector ﬁeld is tangent
to ∂M, this will not happen.)
−∂
∂xn
ϕ
ϕ(U)
nx = (0, . . . , 0, −1)
Rn−1
Figure 7.2.5. Oriented boundary charts

414
7. Integration on Manifolds
Next, we turn to the problem of orientation. As for manifolds without boundary a volume form on an
n-manifold with boundary M is a nowhere vanishing n-form on M. Fix an orientation on Rn. Then a chart
(U, ϕ) is called positively oriented if Tuϕ : TuM →Rn is orientation preserving for all u ∈U. If M is
paracompact this latter condition is equivalent to orientability of M (the proof is as in Proposition 6.5.2).
Therefore, for paracompact manifolds, an orientation on M is just a smooth choice of orientations of all the
tangent spaces, “smooth” meaning that for all the charts of a certain atlas, called the oriented charts, the
maps D(ϕj ◦ϕ−1
i )(x) : Rn →Rn are orientation preserving.
The reader may wonder why for ﬁnite dimensional manifolds we did not choose a “standard” half-space,
like xn ≥0 to deﬁne the charts at the boundary. Had we done that, the very deﬁnition of an oriented
chart would be in jeopardy. For example, consider M = [0, 1] and agree that all charts must have range in
R+ = { x ∈R | x ≥0 }. Then an example of an orientation reversing chart at x = 1 is ϕ(x) = 1 −x; in fact,
every chart at x = 1 would be orientation reversing. However, if we admit any half-space of R, so charts can
be also in R−= {x ∈R | x ≤0}, then a positively oriented chart at 1 is ϕ(x) = x −1. See Figure 7.2.6.
R+
R_
x
x
x
1 – x
x
x – 1
0
1
0
0
Figure 7.2.6. Boundary charts for [0, 1]
Once oriented charts and atlases are deﬁned, the theory of integration for oriented paracompact manifolds
with boundary proceeds as in §7.1.
Finally we deﬁne the boundary orientation of ∂M. At every x ∈∂M, the linear space Tx(∂M) has
codimension one in TxM so that there are (in a chart on M intersecting ∂M) exactly two kinds of vectors
not in ker λ: those for which their representatives v satisfy λ(v) > 0 or λ(v) < 0, that is, the inward and
outward pointing vectors. By Lemma 7.2.4, a change of chart does not aﬀect the property of a vector being
outward or inward (see Figure 7.2.4). If dim M = n, these considerations enable us to deﬁne the induced
orientation of ∂M in the following way.
7.2.7 Deﬁnition.
Let M be an oriented n-manifold with boundary, x ∈∂M and ϕ : U →Rn
λ a positively
oriented chart, where λ ∈(Rn)∗. A basis {v1, . . . , vn−1} of Tx(∂M) is called positively oriented if

(Txϕ)−1(n), v1, . . . , vn−1

is positively oriented in the orientation of M, where n is any outward pointing vector to Rn
λ at ϕ(x).
For example, we could choose for n the outward pointing vector to Rn
λ and perpendicular to ker λ. If
λ : Rn →R is the projection on the n-th factor, then (Txϕ)−1(n) = −∂/∂xn and the situation is illustrated
in Figure 7.2.5.
7.2.8 Theorem (Stokes’ Theorem).
Let M be an oriented smooth paracompact n-manifold with boundary
and α ∈Ωn−1(M) have compact support. Let i : ∂M →M be the inclusion map so that i∗α ∈Ωn−1(∂M).
Then

∂M
i∗α =

M
dα
(7.2.1a)
or for short,

∂M
α =

M
dα
(7.2.1b)

7.2 Stokes’ Theorem
415
If ∂M = ∅, the left hand side of equation (7.2.1a) or (7.2.1b) is set equal to zero.
Proof.
Since integration was constructed with partitions of unity subordinate to an atlas and both sides
of the equation to be proved are linear in α, we may assume without loss of generality that α is a form on
U ⊂Rn
+ with compact support. Write
α =
n

i=1
(−1)i−1αidx1 ∧· · · ∧(dxi)ˆ∧· · · ∧dxn,
(7.2.2)
where ˆ above a term means that it is deleted. Then
dα =
n

i=1
∂αi
∂xi dx1 ∧· · · ∧dxn,
(7.2.3)
and thus

U
dα =
n

i=1

Rn
∂αi
∂xi dx1 · · · dxn.
(7.2.4)
There are two cases: ∂U = ∅and ∂U ̸= ∅. If ∂U = ∅, we have

∂U α = 0. The integration of the ith term
in the sum occurring in equation (7.2.4) is

Rn−1

R
∂αi
∂xi dxi

dx1 · · · (dxi)ˆ· · · dxn
(no sum)
(7.2.5)
and
 +∞
−∞(∂αi/∂xi)dx = 0 since αi has a compact support. Thus, the expression in equation (7.2.4) is zero
as desired.
If ∂U ̸= ∅, then we can do the same trick for each term except the last, which is, by the fundamental
theorem of calculus,

Rn−1
 ∞
0
∂αn
∂xn dxn

dx1 · · · dxn−1
= −

Rn−1 αn(x1, . . . , xn−1, 0)dx1 · · · dxn−1.
(7.2.6)
since αn has compact support. Thus,

U
dα = −

Rn−1 αn(x1, . . . , xn−1, 0)dx1 · · · dxn−1
(7.2.7)
On the other hand,

∂U
α =

∂Rn
+
α =

∂Rn
+
(−1)n−1αn(x1, . . . , xn−1, 0)dx1 ∧· · · ∧dxn−1.
(7.2.8)
But Rn−1 = ∂Rn
+ and the usual orientation on Rn−1 is not the boundary orientation. The outward unit
normal is −en = (0, . . . , 0, −1) and hence the boundary orientation has the sign of the ordered basis
{−en, e1, . . . , en−1}, which is (−1)n. Thus equation (7.2.8) becomes

∂U
α =

∂Rn
+
(−1)n−1αn(x1, . . . , xn−1, 0)dx1 ∧· · · ∧dxn−1
= (−1)2n−1

Rn−1 αn(x1, . . . , xn−1, 0)dx1 · · · dxn−1.
(7.2.9)
Since (−1)2n−1 = −1, combining equations (7.2.7) and (7.2.9), we get the desired result.
■

416
7. Integration on Manifolds
This basic theorem reduces to the usual theorems of Green, Stokes, and Gauss in R2 and R3, as we shall
see in the next section. For forms with less smoothness or without compact support, the best results are
somewhat subtle. See Gaﬀney [1954], Morrey [1966], Yau [1976], Karp [1981] and the remarks at the end of
Supplement 7.2B.
Next we draw some important consequences from Stokes’ theorem.
7.2.9 Theorem (Gauss’ Theorem).
Let M be an oriented paracompact n-manifold with boundary and X
a vector ﬁeld on M with compact support. Let µ be a volume form on M. Then

M
(div X)µ =

∂M
iXµ.
(7.2.10)
Proof.
Recall that
(div X)µ = £Xµ = diXµ + iXdµ = diXµ.
The result is thus a consequence of Stokes’ theorem.
■
If M carries a Riemannian metric, there is a unique outward–pointing unit normal n∂M along ∂M, and
M and ∂M carry corresponding uniquely determined volume forms µM and µ∂M. Then Gauss’ theorem
reads as follows.
7.2.10 Corollary.

M
(div X) dµM =

∂M
⟨⟨X, n∂M⟩⟩dµ∂M,
where ⟨⟨X, n∂M⟩⟩is the inner product of X and n∂M is the outward unit normal.
Proof.
Let µ∂M denote the volume element on ∂M induced by the Riemannian volume element µM ∈
Ωn(M); that is, for any positively oriented basis v1, . . . , vn−1 ∈Tx(∂M), and charts chosen so that n∂M =
−∂/∂xn at the point x,
µ∂M(x)(v1, . . . , vn−1) = µM(x)

−∂
∂xn , v1, . . . , vn−1

.
Since
(iXµM)(x)(v1, . . . , vn−1) = µM(x)

Xi(x)vi + Xn(x) ∂
∂xn , v1, . . . , vn−1

= Xn(x)µ∂M(x)(v1, . . . , vn−1)
and Xn = −⟨⟨X, n∂M⟩⟩, the corollary follows by Gauss’ theorem.
■
7.2.11 Corollary.
If X is divergence-free on a compact boundaryless manifold with a volume element µ,
then X as an operator is skew-symmetric; that is, for f and g ∈F(M),

M
X[f]gµ = −

M
fX[g]µ.
Proof.
Since X is divergence free, £X(hµ) = (£Xh)µ for any h ∈F(M). Thus,
X[f]gµ + fX[g]µ = £X(fg)µ = £X(fgµ).
Integration and the use of Stokes’ theorem gives the result.
■

7.2 Stokes’ Theorem
417
7.2.12 Corollary.
If M is compact without boundary X ∈X(M), α ∈Ωk(M), and β ∈Ωn−k(M), then

M
£Xα ∧β = −

M
α ∧£Xβ.
Proof.
Since α ∧β ∈Ωn(M), the formula follows by integrating both sides of the relation diX(α ∧β) =
£X(α ∧β) = £Xα ∧β + α ∧£Xβ and using Stokes’ theorem.
■
7.2.13 Corollary.
If M is a compact orientable, boundaryless n-dimensional pseudo-Riemannian manifold
with a metric g of index Ind(g), then d and δ are adjoints, that is,

M
⟨dα, β⟩µ =

M
dα ∧∗β =

M
α ∧∗δβ =

M
⟨α, δβ⟩µ
for α ∈Ωk(M) and β ∈Ωk+1(M).
Proof.
Recall from Deﬁnition 6.5.21 that
δβ = (−1)nk+1+Ind(g) ∗d ∗β,
so that
dα ∧∗β −α ∧∗δβ = dα ∧∗β + (−1)nk+Ind(g)α ∧∗∗d ∗β
= dα ∧∗β + (−1)nk+Ind(g)+k(n−k)+Ind(g)α ∧d∗β
= dα ∧∗β + (−1)kα ∧d ∗β
= d(α ∧∗β)
since k2 + k is an even number for any integer k. Integrating both sides of the equation and using Stokes’
theorem gives the result.
■
The same identity

⟨dα, β⟩µ =

M
⟨α, δβ⟩µ
holds for noncompact manifolds, possibly with boundary, provided either α or β has compact support in
Int(M).
Supplement 7.2A
Stokes’ Theorem for Nonorientable Manifolds
Let M be a nonorientable paracompact n-manifold with a smooth boundary ∂M and inclusion map i :
∂M →M. We would like to give meaning to the formula

M
dρ =

∂M
i∗ρ.
in Stokes’ theorem. Clearly, both sides makes sense if dρ and i∗(ρ) are deﬁned in such a way that they are
densities on M and ∂M, respectively. Here d should be some operator analogous to the exterior diﬀerential,

418
7. Integration on Manifolds
and ρ should be a section of some bundle over M analogous to n−1(M). Denote the as yet unknown bundle
analogous to k(M) by k
t (M) and its space of sections Ωk
τ(M). Then we desire an operator d : Ωk
τ(M) →
Ωk+1
τ
(M), k = 0, . . . , n, and desire n
τ (M) to be isomorphic to |  |(M).
To guess what k
τ(M) might be, let us ﬁrst discuss n
τ (M). The key diﬀerence between an n-form ω and
a density ρ is their transformation property under a linear map A : TmM →TmM as follows:
ω(m)(A(v1), . . . , A(vn)) = (det A) ω(m)(v1, . . . , vn)
ρ(m)(A(v1), . . . , A(vn)) = | det A| ρ(m)(v1, . . . , vn)
for m ∈M and v1, . . . , vn ∈TmM. If v1, . . . , vn is a basis, then det(A) > 0 if A preserves the orientation
given by v1, . . . , vn and det(A) < 0 if A reverses this orientation. Thus ρ can be thought of as an object
behaving like an n-form at every m ∈M once an orientation of TmM is given; that is, ρ should be thought
of as an n-form with values in some line bundle (a bundle with one-dimensional ﬁbers) associated with the
concept of orientation. This deﬁnition would then generalize to any k; k
τ(M) will be line-bundle-valued
k-forms on M. We shall now construct this line bundle.
At every point of M there are two orientations. Using them, we construct the oriented double covering

M →M (see Proposition 6.5.7). Since 
M is not a line bundle, some other construction is in order. At every
m ∈M, a line is desired such that the positive half-line should correspond to one orientation of TmM and
the negative half-line to the other. The fact that must be taken into account is that multiplication by a
negative number switches these two half-lines. To incorporate this idea, identify (m, [µ], a) with (m, [−µ], −a)
where m ∈M, a ∈R, and [µ] is an orientation of TmM. Thus, deﬁne the orientation line bundle
σ(M) = { (m, [µ], a) | m ∈M, a ∈R, and [µ] is an orientation of TmM) }/∼where ∼is the equivalence
relation (m, [µ], a) ∼(m, [−µ], −a). Denote by ⟨m, [µ], a⟩the elements of σ(M). It can be checked that the
map π : σ(M) →M deﬁned by π(⟨m, [µ], a⟩) = m is a line bundle with bundle charts given by
ψ : π−1(U) →ϕ(U) × R,
ψ(⟨m, [µ], a⟩) = (ϕ(m), ϵa),
where ϕ : U →Rn is a chart for M at m, and ϵ = +1 if Tmϕ : (TmM, [µ]) →(Rn, [ω]) is orientation
preserving and −1 if it is orientation reversing, [ω] being a ﬁxed orientation of Rn. The change of chart map
of the line bundle σ(M) is given by
(x, a) ∈U ′ × R ⊂Rn × R
→

(ϕj ◦ϕi)−1(x), sign(det D(ϕj ◦ϕ−1
i )(x))

∈U ′ × R.
If M is paracompact, then σ(M) is an orientable vector bundle (see Exercise 6.5-14). If in addition M is
also connected, then M is orientable if and only if σ(M) is trivial line bundle; the proof is similar to that of
Proposition 6.5.7.
7.2.14 Deﬁnition.
A twisted k-form on M is a σ(M)-valued k-form on M. The bundle of twisted
k-forms is denoted by k
τ(M) and sections of this bundle are denoted Ωk
τ(M) or Γ∞(k
τ(M)).
Locally, a section ρ ∈Ωk
τ(M) can be written as ρ = αξ where α ∈Ωk(U) and ξ is an orientation of U
regarded as a locally constant section of σ(M) over U. The operators
d : Ωk
τ(M) →Ωk+1
τ
(M) and
iX : Ωk
τ(M) →Ωk−1
τ
(M), where X ∈X(M),
are deﬁned to be the unique operators such that if ρ = αξ in the neighborhood U, then dρ = (dα)ξ and
iXρ = (iXα)ξ. One has £X = iX ◦d + d ◦iX. Note that if M is orientable, k
τ(M) coincides with k(M).
Next we show that the line bundles | (M)| and n
τ (M) are isomorphic. If λ ∈| (M)|m and v1, . . . , vn ∈
TmM, deﬁne
ϕ(λ) : TmM × · · · × TmM →σ(M)m

7.2 Stokes’ Theorem
419
by setting
Φ(λ)(v1, . . . , vn) = ⟨m, [σ(v1, . . . , vn)], λ(v1, . . . , vn)⟩,
if {v1, . . . , vn} is a basis of TmM, and setting it equal to 0, if {v1, . . . , vn} are linearly dependent, where
[σ(v1, . . . , vn)] denotes the orientation of TmM given by the ordered basis {v1, . . . , vn}. Φ(λ) is skew sym-
metric and homogeneous with respect to scalar multiplication since if {v1, . . . , vn} is a basis and a ∈R, we
have
Φ(λ)(v2, v1, v3, . . . , vn) = ⟨m, [σ(v2, v1, v3, . . . , vn)], λ(v2, v1, v3, . . . , vn)⟩
= ⟨m, [−σ(v1, v2, . . . , vn)], λ(v1, . . . , vn)⟩
= ⟨m, [σ(v1, . . . , vn)], −λ(v1, . . . , vn)⟩
= −Φ(λ)(v1, . . . , vn)
and
Φ(λ)(av1, v2, . . . , vn) = ⟨m, [σ(av1, v2, . . . , vn)], λ(av1, . . . , vn)⟩
= ⟨m, [(sign a)σ(v1, . . . , vn)], |a|λ(v1, . . . , vn)⟩
= ⟨m, [σ(v1, . . . , vn)], aλ(v1, . . . , vn)⟩
= aΦ(λ)(v1, . . . , vn).
The proof of additivity is more complicated. Let v1, v′
1, v2, . . . , vn ∈TmM. If both {v1, . . . , vn} and {v′
1, v2, . . . , vn}
are linearly dependent, then so are {v1+v′
1, v2, . . . , vn} and the additivity property of Φ(λ) is trivially veriﬁed.
So assume that {v1, . . . , vn} is a basis of TmM and write v′
1 = a1v1 + · · · + anvn. Therefore
λ(v′
1, v2, . . . , vn) = |a1|λ(v1, . . . , vn), and
λ(v1 + v′
1, v2, . . . , vn) = |1 + a1|λ(v1, . . . , vn).
Moreover, if
(i) a1 > 0, then
[σ(v1, . . . , vn)] = [σ(v′
1, v2, . . . , vn)] = [σ(v1 + v′
1, v2, . . . , vn)];
(ii) a1 = 0, then
[σ(v1, . . . , vn)] = [σ(v1 + v′
1, v2, . . . , vn)]
and
Φ(λ)(v′
1, v2, . . . , vn) = 0;
(iii) −1 < a1 < 0, then
[σ(v1, . . . , vn)] = [−σ(v′
1, v2, . . . , vn)] = [σ(v1 + v′
1, v2, . . . , vn)];
(iv) a1 = −1, then
[σ(v1, . . . , vn)] = [−σ(v′
1, v2, . . . , vn)]
and
Φ(λ)(v1 + v′
1, v2, . . . , vn) = 0;

420
7. Integration on Manifolds
(v) a1 < −1, then
[σ(v1, . . . , vn)] = [−σ(v′
1, v2, . . . , vn)] = [−σ(v1 + v′
1, v2, . . . , vn)].
Additivity is now checked in all ﬁve cases separately. For example, in case (iii) we have
Φ(λ)(v1 + v′
1, v2, . . . , vn) = ⟨m, [σ(v1 + v′
1, v2, . . . , vn)], λ(v1 + v′
1, . . . , vn)⟩
= ⟨m, [σ(v1, . . . , vn)], (1 + a1)λ(v1, . . . , vn)⟩
= ⟨m, [σ(v1, . . . , vn)], λ(v1, . . . , vn)⟩
+⟨m, [−σ(v′
1, v2, . . . , vn)], −|a1|λ(v1, . . . , vn)]
= Φ(λ)(v1, . . . , vn) + Φ(λ)(v′
1, v2, . . . , vn).
Thus Φ has values in n
τ (M). The map Φ is clearly linear and injective and thus is an isomorphism of
| (M)| with n
τ (M). Denote also by Φ the induced isomorphism of |Ω(M)| with Ωn
τ (M).
The integral of ρ ∈Ωn
τ (M) is deﬁned to be the integral of the density Φ−1(ρ) over M. In local coordinates
the expression for Φ is
Φ(a|dx1 ∧· · · ∧dxn|) = (a dx1 ∧· · · ∧dxn)ξn
0 ,
where ξn
0 is the basis element of the space sections of σ(U) given by ξn
0 (u)(v1, . . . , vn) = ⟨u, [σ(v1, . . . , vn)],
sign(det(vi
j))⟩, where (vi
j) are the components of the vector vj in the coordinates (x1, . . . , xn) of U. Therefore
Φ−1((a dx1 ∧· · · ∧dxn)ξ) = aξ
ξn
0
|dx1 ∧· · · ∧dxn|
and

U
(a dx1 ∧· · · ∧dxn)bξn
0 =

U
ab|dx1 ∧· · · ∧dxn|
for any smooth functions a, b : U →R.
Finally, for the formulation of Stokes’ Theorem, if i : ∂M →M is the inclusion and ρ ∈Ωn−1
τ
(M), the
induced twisted (n −1)-form i∗ρ on ∂M is deﬁned by setting
(i∗ρ)(m)(v1, . . . , vn−1) = ⟨m, [sign[µn]σ(−∂/∂xn, v1, . . . , vn−1)],
ρ′(m)(v1, . . . , vn−1)⟩,
if v1, . . . , vn−1 are linearly independent and setting it equal to zero, if v1, . . . , vn−1 are linearly dependent,
where (x1, . . . , xn) is a coordinate system at m with ∂M described by xn = 0 and
ρ(m)(v1, . . . , vn−1) = ⟨m, sign[µm], ρ′(m)(v1, . . . , vn−1)⟩
with ρ′(m) skew symmetric; moreover sign[µm] = +1 (respectively, −1) if [µm] and [σ(−∂/∂xn, v1, . . . , vn−1)]
deﬁne the same (respectively, opposite) orientation of TmM. If M = U, where U is open in Rn
+ and ρ =
α aξ0 ∈Ωn−1
τ
(U), then
i∗ρ = (−1)ni∗(aα)ξn−1
0
.
In particular, if
ζ =
n

i=1
ζidx1 ∧· · · ∧(dxi)ˆ∧· · · ∧dxn,

7.2 Stokes’ Theorem
421
we have
(i∗ρ)(x1, . . . , xn−1) = (−1)na(x1, . . . , xn−1, 0)(−1)n−1αn(x1, . . . , xn−1, 0)
dx1 ∧· · · ∧(dxi)ˆ∧· · · ∧dxnξn−1
0
= −a(x1, . . . , xn−1, 0)αn(x1, . . . , x−1, 0)
dx1 ∧· · · ∧(dxi)ˆ∧· · · ∧dxnξn−1
0
.
With this observation, the proof of Stokes’ theorem 7.2.8 gives the following.
7.2.15 Theorem (Nonorientable Stokes’ Theorem).
Let M be a paracompact nonorientable n-manifold
with smooth boundary ∂M and ρ ∈Ωn−1
τ
(M), a twisted (n −1)-form with compact support. Then

M
dρ =

∂M
i∗ρ.
The same statement holds for vector-valued twisted (n −1)-forms and all corollaries go through replacing
everywhere (n −1)-forms with twisted (n −1)-forms. For example, we have the following.
7.2.16 Theorem (Nonorientable Gauss Theorem).
Let M be a nonorientable Riemannian n-manifold with
associated density µM. Then for X ∈X(M) with compact support

M
div(X)µM =

∂M
(X · n)µ∂M
where n is the outward unit normal of ∂M, µ∂M is the induced Riemannian density of ∂M and £XµM =
(div X)µM.
For a concrete situation in R3 involving these ideas, see Exercise 7.3-9.
Supplement 7.2B
Stokes’ Theorem on Manifolds with Piecewise Smooth Boundary
The statement of Stokes’ theorem we have given does not apply when M is, say a cube or a cone, since
these sets do not have a smooth boundary. If the singular portion of the boundary (the four vertices and
12 edges in case of the cube, the vertex and the base circle in case of the cone), is of Lebesgue measure
zero (within the boundary) it should not contribue to the boundary integral and we can hope that Stokes’
theorem still holds. This supplement discusses such a version of Stokes’ theorem inspired by Holmann and
Rummler [1972]. (See Lang [1972] for an alternative approach.)
First we shall give the deﬁnition of a manifold with piecewise smooth boundary. A glance at the deﬁnition
of a manifold with boundary makes it clear that one could deﬁne a manifold with corners, by choosing
charts that make regions near the boundary diﬀeomorphic to open subsets of a ﬁnite intersection of positive
closed half-spaces. Unfortunately, singular points on the boundary—such as the vertex of a cone—need not
be of this type. Thus, instead of trying to classify the singular points up to diﬀeomorphism and then make a
formal intrinsic deﬁnition, it is simpler to consider manifolds already embedded in a bigger manifold. Then
we can impose a condition on the boundary to insure the validity of Stokes’ theorem.

422
7. Integration on Manifolds
7.2.17 Deﬁnition.
Deﬁnition Let U ⊂Rn−1 be open and f : U →R be continuous. A point p on the
graph of f, Γf = { (x, f(x)) | x ∈U }, is called regular if there is an open neighborhood V of p such that
V ∩Γf is an (n−1) dimensional smooth submanifold of V . Let ρf denote the set of regular points. Any point
in σf = Γf\ρf is called singular. The mapping f is called piecewise smooth if ρf is Lebesgue measurable,
π(σf) has measure zero in U (where π : U × R →U is the projection) and f|π(σf) is locally H¨older; that is,
for each compact set K ⊂π(σf) there are constants c(K) > 0, 0 < α(K) ≤1 such that
|f(x) −f(y)| ≤c(K)∥x −y∥α(K)
for all x, y ∈K.
Note that ρf is open in Γf and that Int(Γ−
f ) ∪ρf, where
Γ−
f = { (x, y) ∈U × R | y ≤f(x) },
is a manifold with boundary ρf. Thus ρf has positive orientation induced from the standard orientation
of Rn. This will be called the positive orientation of Γf. We are now ready to deﬁne manifolds with
piecewise smooth boundary.
7.2.18 Deﬁnition.
Let M be an n-manifold. A closed subset N of M is said to be a manifold with
piecewise smooth boundary if for every p ∈N there exists a chart (U, ϕ) of M at p, ϕ(U) = U ′ × U ′′ ⊂
Rn−1 × R, and a piecewise smooth mapping f : U ′ →R such that
ϕ(bd(N) ∩U) = Γf ∩ϕ(U)
and ϕ(N ∩U) = Γ−
f ∩ϕ(U). See Figure 7.2.7.
σn = singular points
ρn = regular points
M
U
N
U ′′
U ′
ϕ
Γf ∩ϕ(U)
Γ−
f ∩ϕ(U)
Figure 7.2.7. Singular boundary charts
It is readily veriﬁed that the condition on N is chart independent, using the fact that the composition of
a piecewise smooth map with a diﬀeomorphism is still piecewise smooth. Thus, regular and singular points
of bd(N) make intrinsic sense and are deﬁned in terms of an arbitrary chart satisfying the conditions of the
preceding deﬁnition. Let ρN and σN denote the regular and singular part of the boundary bd(N) of N in
M.
To formulate Stokes’ theorem, we deﬁne

N η, for η an n-form (respectively, density) on M with compact
support. This is done as usual via a partition of unity; ρN and σN play no role since they have Lebesgue
measure zero in every chart: ρN because it is an (n −1)-manifold and σN by deﬁnition.
It is not so simple to deﬁne

bd(N) ζ for ζ ∈Ωn−1(M) (respectively, a density). First a lemma is needed.

7.2 Stokes’ Theorem
423
7.2.19 Lemma.
Let ζ ∈Ωn−1(U × R), where U is open in Rn−1, supp(ζ) is compact and f : U →R is a
piecewise smooth mapping. Then there is a smooth bounded function a : ρf →R, such that i∗ζ = aλ where
i : ρf →U × R is the inclusion and λ ∈Ωn−1(ρf) is the boundary volume form induced by the canonical
volume form of U × R ⊂Rn on Int(Γ−
f ) ∪ρf.
Proof.
The existence of the function a on ρf follows since Ωn−1(ρf) is one-dimensional with a basis element
λ. We prove that a is bounded. Let p ∈ρf and v1, . . . , vn−1 ∈Tp(ρf) be an orthonormal basis with respect
to the Riemannian metric on ρf induced from the standard metric of Rn, and denote by n the outward unit
normal. Then
a(p) = a(p)(dx1 ∧· · · ∧dxn)(p)(n, v1, . . . , vn−1)
= a(p)λ(p)(v1, . . . , vn−1) = ζ(p)(v1, . . . , vn−1).
Let
vi = vj
i
∂
∂xj

p
.
Since
∂
∂x1

p
, . . . ,
∂
∂xn

p
and
n, v1, . . . , vn−1
are orthonormal bases of Tp(U × R), we must have |vj
i | ≤1 for all i, j. Hence if
ζ =
n

i=1
ζidx1 ∧· · · ∧(dxi)ˆ∧· · · ∧dxn,
then
|a(p)| = |ζ(p)(v1, . . . , vn−1)|
=

n

i=1
ζi(p)

σ∈Sn−1
(−1)i(sign σ)vσ(1)
1
· · · vσ(n−1)
n−1

=
n

i=1
|ζi(p)|(n −1)!
which is bounded, since ζ has compact support.
▼
In view of this lemma and the fact that σf has measure zero, we can deﬁne

Γf
ζ =

ρf
i∗ζ =

ρf
aλ.
Now we can deﬁne, via a partition of unity, the integral of η ∈Ωn−1(M) (or a twisted (n −1)-form) by

bd(N)
η =

ρN
η.
7.2.20 Theorem (Piecewise Smooth Stokes Theorem).
Let M be a paracompact n-manifold and N a
closed submanifold of M with piecewise smooth boundary. If
(i) M is orientable and ω ∈Ωn−1(M) has compact support, or

424
7. Integration on Manifolds
(ii) M is nonorientable and ω ∈Ωn−1
τ
(M) is a twisted (n −1)-form (see the preceding supplement) which
has compact support, then

N
dω =

bd(N)
ω.
The proof of this theorem reduces via a partition of unity to the local case. Thus it suﬃces to prove that if
U is open in Rn−1, ω ∈Ωn−1(U × R) has compact support, and f : U →R is a piecewise smooth mapping,
then

Γ−
f
dω =

Γf
ω.
(7.2.11)
The left-hand side of equation (7.2.11) is to be understood as the integral over the compact measurable set
Γ−
f ∩supp(ω). For the proof of (7.2.11) we use three lemmas.
7.2.21 Lemma.
Equation (7.2.11) holds if ω vanishes in a neighborhood of σf in U × R.
Proof.
Let V be an open neighborhood of σf in U × R on which ω vanishes and let W be another open
neighborhood of σf (which is closed in V ) such that cl(W)∩(U ×R) ⊂V . The set O = (U ×R)\ cl(W) is open
and since it is disjoint from σf, Γ−
f ⊂O is an n-dimensional submanifold of O with bd(Γ−
f ∩O) = Γf ∩O.
Since
supp(dω) ∩Γ−
f ⊂Γ−
f ∩O
and
supp(ω) ∩Γf ⊂Γf ∩O,
by the usual Stokes theorem, we have

Γf
dω =

Γ−
f ∩O
dω =

Γf∩O
ω =

Γf
ω.
■
The purpose of the next two lemmas is to construct approximations to dω and ω if ω does not vanish
near σf. For this we need translates of bump functions with control on their derivatives.
7.2.22 Lemma.
Let C be a box (rectangular parallelepiped) in Rn of edge lengths 2li and let D be the box
with the same center as C but of edge lengths 4li/3. There exists a C∞function ϕ : Rn →[0, 1] which is 1
on Rn\C, 0 on D and |∂ϕ/∂xi| ≤A/li, for a constant A independent of li.
Proof.
Assume we have found such a function ϕ : R →[0, 1] for n = 1. Then ψ(x1, . . . , xn) = ϕ(x1) . . . ϕ(xn)
is the desired function.
The function ϕ is found in the following way. Let a = 2l/3, ϵ = l/3 and choose an integer N such that
2/N < ϵ. Let h : R →[0, 1] be a bump function that is equal to 1 for |t| < 1/2 and that vanishes for |t| > 1.
Then f : R →[0, 1], deﬁned by f(t) = 1 −h(t) is a C∞function vanishing for |t| < 1/2 and equal to 1 for
|t| > 1. Let fn(t) = f(nt) for all positive integers n and note that
|f ′
n(t)| = n|f ′(nt)| ≤Cn.
Deﬁne the C∞function
ϕ(t) =

fN

t −z
2N

,
where the product is taken over integers z such that |z| < 2Na + 1. Note that if |t| < a + 1/4N and z ∈Z
is chosen such that |t −z/2N| < 1/4N, then
fN

t −z
2N

= 0
and
|z| ≤2N|t| + 1
2 < 2Na + 1,

7.2 Stokes’ Theorem
425
so that ϕ(t) = 0 . Similarly if
|t| > a + 2
N
and
|z| < 2Na + 1,
then
t −z
2N
 ≥|t| −|z|
2N > 1
N
so that ϕ(t) = 1.
Finally, let |t0 −a| < 2/N and let z0 ∈Z be such that |t0 −z0/2N| < 1/N. All factors fN(t0 −z/2N) are
one in a neighborhood of t0, unless |t0 −z/2N| ≤1/N. In that case we have the inequality
|z −z0| ≤|z −2Nt0| + |2Nt0 −z0| ≤3.
Hence at most seven factors in the product are not identically 1 in a neighborhood of t0. Hence
|ϕ′(t0)| ≤7CN = A
ϵ .
■
7.2.23 Lemma.
Let K be a compact subset of σf, the singular set of f. For every ϵ > 0 there is a
neighborhood Uϵ of K in U × R and a C∞function ϕϵ : U × R →[0, 1], which vanishes on a neighborhood
of K in Uϵ, is one on the complement of Uϵ, and is such that
(i) vol(Uϵ)
	
sup
x∈Rn

∂ϕϵ(x)
∂xi


≤ϵ,
i = 1, . . . , n, and
(ii) vol(Uϵ) ≤ϵ and q(Uϵ ∩ρf) ≤ϵ, where q is the measure on ρf associated with the volume form
λ ∈Ωn−1(ρf), and vol(Uϵ) is the Lebesgue measure of Uϵ in Rn.
Proof.
Partition Rn−1 by closed cubes D of edge length 4l/3, l ≤1. At most 2n such cubes can meet at a
vertex. The set π(K), where π : U × R →U is the projection, can be covered by ﬁnitely many open cubes
C of edge length 2l, each one of these cubes containing a cube D and having the same center as C. Since
π(K) and K have measure zero, choose l so small that for given δ > 0,
(i) the (n −1)-dimensional volume of 
i=1,...,L Ci is smaller than or equal to δ; and
(ii) q

π−1 
i=1,...,L Ci

∩ρf

≤δ.
Since f is locally H¨older and π(K) is compact, there exist constants 0 < α ≤1 and k > 0 such that
|f(x) −f(y)| ≤k∥x −y∥α
for x, y ∈π(K). We can assume k ≥1 without loss of generality. In each of the sets π−1(Ci) = Ci × R,
choose a box Pi with base Ci and height (2kl)1/α such that π(K) is covered by parallelipeds P ′
i with the
same center as Pi and edge lengths equal to two-thirds of the edge lengths of Pi.
Let V = 
i=1,...,L Pi. Then π(V ) = 
i=1,...,L Ci and since at most 2n of the Pi intersect
vol(V ) = 2kl2n vol(π(V )) ≤2n+1klδ ≤2n+1kδ
and
q(V ∩ρf) ≤δ.

426
7. Integration on Manifolds
By the previous lemma, for each Pi there is a C∞function ϕi : U × R →[0, 1] that vanishes on P ′
i, is equal
to 1 on the complement of Pi, and
sup
x∈Rn

∂ϕi
∂xj
 ≤A
l .
Let ϕ = Πi=1,...,Lϕi. Clearly ϕ : U × R →[0, 1] is C∞, vanishes in a neighborhood of K and equals one in
the complement of V . But at most 2n of the Pi can intersect, so that

∂ϕ
∂xj
 =

L

i=1
∂ϕi
∂xj

k̸=i
ϕk

≤2n A
l ,
j = 1, . . . , n.
Hence
vol(V )
	
sup
x∈Rn

∂ϕ
∂xj


≤2n+1klδ2n A
l = 22n+1kδA.
Now let δ = min{ϵ, ϵ/22n+1kA}, ϕϵ = ϕ, and Uϵ = V.
■
Proof of Equation (7.2.11).
Let
ω =
n

i=1
ωidx1 ∧· · · ∧(dx1)ˆ∧· · · ∧dxn,
dω = b dx1 ∧· · · ∧dxn,
and i∗ω = aλ. Then ωi, b, and a are continuous and bounded on U × R and ρf respectively; that is,
|ωi(x)| ≤M, |b(x)| ≤N for x ∈U × R and |a(y)| ≤N for y ∈ρf, where M, N > 0 are constants. Let Uϵ
and ϕϵ be given by the previous lemma applied to supp(ω) ∩σf. But ϕϵω vanishes in a neighborhood of σf
and Lemma 7.2.21 is applicable; that is

Γ−
f
d(ϕϵω) =

Γf
ϕϵω.
(7.2.12)
We have


Γf
ω −

Γf
ϕϵω
 ≤


ρf
a(1 −ϕϵ)λ
 ≤Nq(Uϵ ∩ρf) ≤Nϵ
and


Γ−
f
dω −

Γ−
f
d(ϕϵω)
 ≤


Γ−
f
(dω −ϕϵdω)
 +


Γ−
f
dϕϵ ∧ω

≤


Γ−
f
b(1 −ϕϵ)dx1 ∧· · · ∧dxn
 +
n

i=1

Γ−
f
|ωi|

∂ϕϵ
∂xi
 dx1 ∧· · · ∧dxn
≤N vol(Uϵ) + M
 n

i=1
sup
x∈R

∂ϕϵ(x)
∂xi

 
vol(Uϵ) ≤Nϵ + Mnϵ.
(7.2.13)
From equations (7.2.12) and (7.2.13) we get


Γ−
f
dω −

Γf
ω
 ≤(2N + nM)ϵ
for all ϵ > 0, which proves the equality.
■

7.2 Stokes’ Theorem
427
In analysis it can be useful to have hypotheses on the smoothness of ω as well as on the boundary that
are as weak as possible. Our proofs show that ω need only be C1. An eﬀective strategy for sharper results is
to approximate ω by smooth forms ωk so that both sides of Stokes’ theorem converge as k →∞. A useful
class of forms for which this works are those in Sobolev spaces, function spaces encountered in the study of
partial diﬀerential equations. The H¨older nature of the boundary of N in Stokes’ theorem is exactly what is
needed to make this approximation process work. The key ingredients are approximation properties in M
(which are obtained from those in Rn) and the Calder´on extension theorem to reduce approximations in
N to those in Rn. (Proofs of these facts may be found in Stein [1970], Marsden [1973], and Adams [1975].)
Supplement 7.2C
Stokes’ Theorem on Chains
In algebraic topology it is of interest to integrate forms over images of simplexes. This box adapts Stokes’
theorem to this case. The result could be obtained as a corollary of the piecewise smooth Stokes Theorem,
but we shall give a self-contained and independent proof.
7.2.24 Deﬁnition.
The standard p-simplex is the closed set
∆p =
!
x ∈Rp
 0 ≤xi ≤1,
p

i=1
xi ≤1
"
.
The vertices of ∆p are the p + 1 points
v0 = (0, . . . , 0), v1 = (1, 0, . . . , 0), . . . , vp = (0, . . . , 0, 1).
Opposite to each vi there is the ith face Φp−1,i : ∆p−1 →∆p given by (see Figure 7.2.8):
Φp−1,0(y1, . . . , yp−1) =

1 −
p−1

i=1
yi, y1, . . . , yp−1

,
if i = 0
and
Φp−1,i(y1, . . . , yp−1) = (y1, . . . , yi−1, 0, yi, . . . , yp−1),
if i ̸= 0.
A Ck-singular p-simplex on a Cr-manifold M, 1 ≤k ≤r, is a Ck-map s : U →M, where U is an
open neighborhood of ∆p in Rp. The points s(v0), . . . , s(vp) are the vertices of the singular p-simplex s and
the map s ◦Φp−1,i : V →M, for V an open neighborhood of ∆p−1 in Rp−1 and Φp−1,i extended by the same
formula from ∆p−1 to V , is called the ith face of the singular p-simplex s. A Ck-singular p-chain on M
is a ﬁnite formal linear combination with real coeﬃcients of Ck-singular p-simplexes. The boundary of a
singular p-simplex s is the singular (p −1)-chain ∂s deﬁned by
∂s =
p

i=0
(−1)is ◦Φp−1,i
and that of a singular p-chain is obtained by extending ∂from the simplexes by linearity to chains. It is
straightforward to verify that ∂◦∂= 0 using the relation
Φp−1,j ◦Φp−2,j = Φp−2,i−1 ◦Φp−2,i−1

428
7. Integration on Manifolds
for j < i.
If s : U →M, ∆p ⊂U, is a singular p-simplex, ω ∈Ωp(M), and
s∗ω = adx1 ∧· · · ∧dxp ∈Ωp(U),
the integral of ω over s is deﬁned by

s
ω

∆p
a dx1 · · · dxp,
where the integral on the right is the usual integral in Rp. The integral of ω over a p-chain is obtained
by linear extension.
v2
∆    2
Φ   (∆  )  
    11     1
Φ   (∆  )  
    12     1
Φ   (∆  )  
    10     1
v0
v1
Figure 7.2.8. Integrating over chains
7.2.25 Theorem (Stokes’ Theorem on Chains).
If c is any singular p-chain and ω ∈Ωp−1(M), then

c
dω =

∂c
ω.
Proof.
By linearity it suﬃces to prove the formula if c = s, a singular p-simplex. If
s∗ω =
p

j=1
(−1)j−1ωjdx1 ∧· · · ∧(dxj)ˆ∧· · · ∧dxp,
then
d(s∗ω) =
p−1

j=1
∂ωj
∂xj dx1 ∧· · · ∧dxp
and denoting the coordinates in a neighborhood V of ∆p−1 by (y1, . . . , yp−1) = y, we get
Φ∗
p−1,0s∗ω(y) =
p

j=1
ωj

1 −
p−1

i=1
yi, y1, . . . , yp−1

dy1 ∧· · · ∧dyp−1,
if i = 0 and
Φ∗
p−1,is∗ω(y) = (−1)i−1ωi(y1, . . . , yi−1, 0, yi, . . . , yp−1) dy1 ∧· · · ∧dyp−1,

7.2 Stokes’ Theorem
429
if i ̸= 0. Thus, the formula in the statement becomes
p

j=1

∆p
∂ωj(x)
∂xj
dx1 · · · dxp
=
p

j=1

∆p−1

ωj

1 −
p−1

i=1
yi, y1, . . . yp−1

(7.2.14)
−ωj(y1, . . . , yj−1, 0, yj, . . . , yp−1)
 
dy1 · · · dyp−1.
By Fubini’s theorem, each summand on the left hand side of equation (7.2.14) equals

∆p
∂ωj(x)
∂xj
dx1 · · · dxp
=

∆p−1
 1−
k̸=j xk
0
∂ωj
∂xj dxj

dx1 · · · (dxj)∧· · · dxp
=

∆p−1

ωj

x1, . . . , xj−1, 1 −

k̸=j
xk, xj+1, . . . , xp


−ωj(x1, . . . , xj−1, 0, xj+1, . . . , xp)
 
dx1 · · · (dxj)∧· · · dxp.
Break up this integral as a diﬀerence of two terms. In the ﬁrst term perform the change of variables
(y1, . . . , yp−1) →

x2, . . . , xj−1, 1 −

k̸=j
xk, xj+1, . . . , xp


which has Jacobian equal to (−1)j, use the change of variables formula from calculus in the multiple integral
involving the absolute value of the Jacobian, and note that x1 = 1 −Σi=1,...,p−1yi. In the second term
perform the change of variables
(y1, . . . , yp−1) →(x1, . . . , xj−1, xj+1, . . . , xp)
which has Jacobian equal to one. Then we get

∆p
∂ωj(x)
∂xj
dx1 . . . dxp
=

∆p−1

ωj

1 −
p−1

i=1
yi, y1, . . . , yp−1

−ωj(y1, . . . , yj−1, 0, yj, . . . , yp−1)
 
dy1 . . . dyp−1
and formula (7.2.14) is thus proved for each corresponding summand.
■
Instead of singular p-chains one can consider inﬁnite singular p-chains deﬁned as inﬁnite formal sums
with real coeﬃcients 
i∈I aiSi such that for each i ∈I the family of sets { si(∆p) | ai ̸= 0 } is locally

430
7. Integration on Manifolds
ﬁnite, that is, each m ∈M has a neighborhood intersecting only ﬁnitely many (or no) sets of this family.
On compact manifolds only ﬁnitely many coeﬃcients in an inﬁnite singular p-chain are non-zero and thus
inﬁnite singular p-chains are singular p-chains. The statement and the proof of Stokes’ theorem on chains
remain unchanged if c is an inﬁnite p-chain and ω ∈Ωπ−1(M) has compact support.
Exercises
⋄7.2-1.
Let M and N be oriented n-manifolds with boundary and f : M →N an orientation-preserving
diﬀeomorphism. Show that the change of variables formula and Stokes’ theorem imply that f ∗◦d = d ◦f ∗.
⋄7.2-2.
Let M be a compact orientable boundaryless n-manifold and α ∈Ωn−1(M). Show that dα vanishes
at some point.
⋄7.2-3.
Let M be a compact (n + 1)-dimensional manifold with boundary, f : ∂M →N a smooth map and
ω ∈Ωn(N) where dω = 0. Show that if f extends to M, then

∂M f ∗ω = 0.
⋄7.2-4.
Let (M, µ) be a volume manifold with ∂M = ∅.
(i) Show that the divergence of a vector ﬁeld X is uniquely determined by the condition

M
f(div X)µ = −

M
(£Xf)µ
for any f with compact support.
(ii) What does the equation in (i) become if M is compact with boundary?
(iii) X(x, y, z) = (y, −x, 0) deﬁnes a vector ﬁeld on S2. Calculate div X.
⋄7.2-5.
Let M be a paracompact manifold with boundary. Show that there is a positive smooth function
f : M →[0, ∞[ with 0 a regular value, such that ∂M = f −1(0).
Hint: First do it locally and then patch the local functions together with a partition of unity.
⋄7.2-6.
Let M be a boundaryless manifold and f : M →R a C∞mapping having a regular value a. Show
that f −1([a, ∞[) is a manifold with boundary f −1(a).
⋄7.2-7.
Let f : M →N be a C∞mapping, ∂M ̸= ∅, ∂N ̸= ∅, and let P ⊂N be a submanifold of N.
Assume that f ⋔P, (f|∂M) ⋔P and that in addition one of the following conditions hold.
(i) P is boundaryless and P ⊂Int N; or
(ii) ∂P ̸= ∅and ∂P ⊂∂N; or
(iii) ∂P ̸= ∅, f ⋔∂P, and (f|∂M) ⋔∂P.
Show that f −1(P) is a submanifold of M whose boundary equals
∂f −1(P) = f −1(P) ∩∂M,
in case (i), and ∂f −1(P) = f −1(∂P) in cases (ii) and (iii). If all manifolds are ﬁnite dimensional, show that
dim M −dim f −1(P) = dim N −dim P.
Formulate and prove the statement replacing this equality between dimensions for inﬁnite dimensional
manifolds.
Hint: At the boundary, work with a boundary chart using the technique in the proof of Theorem 3.5.12.

7.2 Stokes’ Theorem
431
⋄7.2-8.
Without some kind of transversality conditions on f|∂M for f : M →N a smooth map, even if
f ⋔P, where P is a submanifold of N (like the ones in the previous exercise), f −1(P) is in general not a
submanifold. For example, let M = R2
+, N = R, P = {0} and f(x, y) = y + χ(x) for a smooth function
χ : R →R . Show that f is a smooth surjective submersion. Find the conditions under which f|∂M has 0
as a regular value. Construct a smooth function χ for which these conditions are violated and f −1(0) is not
a manifold.
Hint: Take for χ a smooth function which has inﬁnitely many zeros converging to zero.
⋄7.2-9.
(i) Show that if M is a boundaryless manifold, there is a connected manifold N with M = ∂N.
Hint: Think of semi-inﬁnite cylinders.
(ii) Construct an example for (i) in which M is compact but N cannot be chosen to be compact.
Hint: Assume dim M = 0.
⋄7.2-10.
Let M be a manifold, X a smooth vector ﬁeld on M with ﬂow Ft and α ∈Ωk(M). We call α an
invariant k-form of X when £Xα = 0. Prove the following.
Poincar´e–Cartan Theorem.
α is an invariant k-form of X iﬀfor all oriented compact k-manifolds with
boundary (V, ∂V ) and C∞mappings ϕ : V →M, such that the domain of Ft contains ϕ(V ), 0 ≤t ≤T, we
have

V
(Ft ◦ϕ)∗α =

V
ϕ∗α.
Hint: For the converse show that the equality between integrals implies (Ft ◦ϕ)∗α = ϕ∗α; then diﬀerentiate
relative to t.
⋄7.2-11.
Let X be a vector ﬁeld on a manifold M and α, β invariant forms of X. (See Exercise 7.2-10.)
Prove the following.
(i) iXα is an invariant form of X.
(ii) dα is an invariant form of X.
(iii) £Xγ is closed iﬀdγ is an invariant form, for any γ ∈Ωk(M).
(iv) α ∧β is an invariant form of X.
(v) Let AX denote the invariant forms of X. Then AX is a ∧subalgebra of Ω(M), which is closed under
d and iX.
⋄7.2-12.
Let X be a vector ﬁeld on a manifold M with ﬂow Ft and α ∈Ωk(M). Then α is called a relatively
invariant k-form of X if £Xα is closed. Prove the following
Poincar´e–Cartan Theorem.
α is a relatively invariant (k −1)-form of X iﬀfor all oriented compact
k-manifolds with boundary (V, ∂V ) and C∞maps ϕ : V →M such that the domain of Ft contains ϕ(V ) for
0 ≤t ≤T, we have

∂V
(Ft ◦ϕ ◦i)∗α =

∂V
(ϕ ◦i)∗α.
where i : ∂V →V is the inclusion map.
⋄7.2-13.
If X ∈X(M), let AX be the set of all invariant forms of X, RX the set of all relatively invariant
forms of X, C the set of all closed forms in Ω(M), and E the set of all exact forms in Ω(M). Show that
(i) AX ⊂RX, E ⊂C ⊂RX, AX is a diﬀerential subalgebra of Ω(M), but RX is only a real vector
subspace.

432
7. Integration on Manifolds
(ii) 0 →AX
i→Ω(M)
£X
→Ω(M)
π→Ω(M)/ Im(£X) →0 is exact.
(iii) 0 →C
i→RX
d→AX
π→AX/E ∩AX →0 is exact.
(iv) d(AX) ⊂AX and iX(AX) ⊂AX.
⋄7.2-14 (Smale–Sard Theorem for manifolds with boundary).
Let M and N be Ck manifolds, where M is
Lindel¨of, having a boundary ∂M, and N is boundaryless. Let f : M →N be a Ck Fredholm map and let
∂f = f|∂M. If k > max(0, index(Txf)) for every x ∈M, show that Rf ∩R∂f is residual in N.
⋄7.2-15 (The Boundaryless Double).
Let M be a manifold with boundary. Show that the topological space
obtained by identifying the points of ∂M in the disjoint union of M with itself is a boundaryless manifold
in which M embeds, called the boundaryless double of M.
Hint: Glue together the two boundary charts.
⋄7.2-16.
Let M be a manifold with ∂M ̸= ∅. Assume M admits partitions of unity. Show that ∂M is
orientable and hence by Exercise 6.5-17, the algebraic normal bundle
ν(∂M) = (TM|∂M)/T(∂M)
is trivial.
Hint: Use proposition 6.5.8. Locally n(m) = ∂/∂xn for m ∈∂M; glue these together.
⋄7.2-17 (Collars).
Let M be a manifold with boundary. A collar for M is a diﬀeomorphism of ∂M × [0, 1[
onto an open neighborhood of ∂M in M that is the identity on ∂M.
(i) Show that a manifold with boundary and admitting partitions of unity has a collar.
Hint: Via a partition of unity, construct a vector ﬁeld on M that points inward when restricted to
∂M. Then look at the integral curves starting on ∂M to deﬁne the collar.
(ii) Let ϕ1 : ∂M × [0, 1[ →M, i = 0, 1 be two collars. Show that ϕ0 and ϕ1 are isotopic, that is, there is
a smooth map H : ]−ϵ, 1 + ϵ[ × ∂M × [0, 1[ →M such that
H(0, m, t) = ϕ0(m, t),
H(1, m, t) = ϕ1(m, t)
for all (m, t) ∈∂M × [0, 1[ and that H(s, ·, ·) is an embedding for all s ∈]−ϵ, 1 + ϵ[.1
Hint: Let Ui be the image of ϕi, an open set in M containing ∂M. Let Xi = ϕ∗
i (0, ∂/∂t) and look at
the ﬂow of (1 −s)X0 + sX1 on U0 ∩U1.
(iii) Let N be a submanifold of M such that ∂N = N ∩∂M and TnN is not a subset of Tn(∂M) for all
n ∈∂N. Show that ∂M has a collar which restricts to a collar of ∂N in N.
⋄7.2-18.
Let M and N be manifolds with boundary and let ϕ : ∂M →∂N be a diﬀeomorphism. Form
the topological space M ∪ϕ N which is the quotient of the disjoint union of M with N by the equivalence
relation which identiﬁes m with ϕ(m). Let V be the image of ∂M and ∂N in M ∪ϕ N.
(i) Use collars to construct a homeomorphism of a neighborhood U of V with the space ]−1, 1[ × V which
maps V pointwise to V × {0} and which maps V ∩M and V ∩N diﬀeomorphically onto V × ]0, 1[ and
V × ]−1, 0[, respectively. Construct a diﬀerentiable structure out of those on M, N, and U.
The “uniqueness theorem of glueing” states that the diﬀerentiable structures on the space M ∪ϕ N
obtained in (i) by making various choices are all diﬀeomorphic. The rest of this exercise uses this fact.
1It can be shown that ϕ0 and ϕ1 are diﬀeotopic using Thom’s theorem of embedding of isotopies into diﬀeotopies. This
then provides the basis of glueing manifolds together along their boundaries; see Hirsch [1976, Chapter 8], for proofs and the
preamble to the next exercise for a discussion.

7.2 Stokes’ Theorem
433
(ii) Two compact boundaryless manifolds M1, M2 are called cobordant if there is a compact manifold
with boundary N, called the cobordism, such that ∂N equals the disjoint union of M1 with M2. Show
that “cobordism” is an equivalence relation.
Hint: For transitivity, glue the manifolds along one common component of their boundaries.
(iii) Show that the operation of disjoint union induces the structure of an abelian group on the set of
cobordism classes in which each element has order two.
Hint: The zero element is the class of any compact manifold which is the boundary of another compact
manifold.
(iv) Show that the operation of taking products of manifolds induces a multiplicative law on the set of
cobordism classes, thus making this set N a ring.
(v) Repeat parts (ii) and (iii) for oriented manifolds obtaining a graded ring, that is,
[M, µ] · [N, ν] = (−1)dim M+dim N[N, ν] · [M, µ],
the graded ring of oriented cobordism classes O. Are the elements of O still of order two relative to
addition?
(vi) Denote by Nn, On, the cobordism classes of a given dimension. Show that N0 = Z/2Z, O0 = Z,
N1 = O1 = 0.
(vii) Assume M and N are boundaryless manifolds, M compact, and P a boundaryless submanifold of N.
Assume f, g : M →N are smoothly homotopic maps such that f ⋔P and g ⋔P. Show that f −1(P)
and g−1(P) are cobordant.
Hint: Choose a smooth homotopy H transverse to P. What is ∂H−1(P)?
⋄7.2-19.
(i) Let χ be a vector ﬁeld density on a ﬁnite dimensional manifold M, that is, χ = X ⊗ρ for
X ∈X(M) and ρ ∈|Ω(M)|. Recall from Exercise 6.5-16 that the density div χ, deﬁned to be (divρ X)ρ,
is independent of the representation of χ as X ⊗ρ. Show that for any f ∈F(M), Y ∈X(M), and any
diﬀeomorphism ϕ : M →M we have
ϕ∗(div χ) = div(∗χ),
£Y (div χ) = div(£Y χ),
and
div(fχ) = df · χ + f div χ.
(ii) If M is paracompact and Riemannian, phrase Gauss’ theorem for vector ﬁeld densities.
(iii) Let α ∈Ωk−1(M) and τ be a tensor density of type (k, 0) which is completely antisymmetric. Let α · τ
denote the contraction of α with the ﬁrst k −1 indices of the tensor part of τ producing a vector ﬁeld
density. Deﬁne the contravariant exterior derivative ∂τ by requiring the following relation for all
α ∈Ωk−1(M) :
div(α · τ) = dα · τ + α · ∂τ,
where dα · τ and α · ∂τ means contraction on all indices. Show that if τ = t ⊗ρ, where locally
t = ti1...ik
∂
∂xi1 ∧· · · ∧
∂
∂xik ,
and
ρ = |dx1 ∧· · · ∧dxn|,
then the local expression of ∂t is
∂τ =
∂
∂xj (ti1...ik−1j) ∂
∂xi1 ∧· · · ∧
∂
∂xik−1 ⊗|dx1 ∧· · · ∧dxn|.
Show that ∂2 = 0.

434
7. Integration on Manifolds
(iv) Prove the following properties of ∂:
∂(τ ∧σ) = ∂τ ∧σ + (−1)kτ ∧∂σ,
and
£X∂τ = ∂£Xτ,
ϕ∗∂τ = ∂ϕ∗τ
where τ is a (k, 0)-tensor density, σ is a (l, 0)-tensor density, X ∈X(M), and ϕ : M →M is a
diﬀeomorphism. Show that if χ is a vector ﬁeld density, ∂χ = div χ.
(v) Let jXτ = X ∧τ for X ∈X(M). Show that iXα · τ = α · jXτ for any α ∈Ωk+1(M), X ∈X(M)
and τ is a completely antisymmetric (k, 0)-tensor density. Prove the analog of Cartan’s formula:
£X = jX ◦∂+ ∂◦jX.
Hint: Integrate the deﬁning relation in (iii) for a any form with support in Int M and extend the
formula by continuity to ∂M.
(vi) Formulate and prove a global formula for ∂τ(α1, . . . , αk−1), τ a (k, 0)-tensor density, analogous to
Palais’ formula (Proposition 6.4.11(ii)).
⋄7.2-20 (Pr¨ufer Manifold).
Let Rd denote the set R with the discrete topology; it is thus a zero dimensional
manifold. Let P = (R2
+ × Rd)/R, where R2
+ = { (x, y) | y ≥0 } and R is the equivalence relation: (x, y, a)
R(x′, y′, a′) iﬀ[(y = y′ > 0 and a + xy = a′ + x′y′) or (y = y′ = 0 and a = a′, x = x′)]. Show that P is a
Hausdorﬀtwo-dimensional manifold, ∂P ̸= ∅, and ∂P is a disjoint union of uncountably many copies of R.
Show that P is not paracompact.
⋄7.2-21.
In the notation of Supplement 7.2C, verify that ∂◦∂= 0.
7.3
The Classical Theorems of Green, Gauss, and Stokes
This section obtains these three classical theorems as a consequence of Stokes’ theorem for diﬀerential forms.
We begin with Green’s theorem, which relates a line integral along a closed piecewise smooth curve C in
the plane R2 to a double integral over the region D enclosed by C. (Piecewise smooth means that the curve
C has only ﬁnitely many corners.) Recall from advanced calculus that the line integral of a one-form
ω = P dx + Q dy along a curve C parameterized by γ : [a, b] →R2 is deﬁned by

C
ω =
 a
b
{P(γ1(t), γ2(t))γ′
1(t) + Q(γ1(t), γ2(t))γ′
2(t)}dt;
that is

C
ω =
 b
a
γ∗ω.
7.3.1 Theorem (Green’s Theorem).
Let D be a closed bounded region in R2 bounded by a closed positively
oriented piecewise smooth curve C. (Positively oriented means the region D is on your left as you traverse
the curve in the positive direction.) Suppose P : D →R and Q : D →R are C1. Then

C
P dx + Q dy =

D
∂Q
∂x −∂P
∂y

dx dy.

7.3 The Classical Theorems of Green, Gauss, and Stokes
435
Proof.
We assume the boundary C = ∂D is smooth. (The piecewise smooth case follows from the gener-
alization of Stokes’ theorem outlined in Supplement 7.2B).
Let
ω = P(x, y)dx + Q(x, y)dy ∈Ω1(D).
Since
dω =
∂Q
∂x −∂P
∂y

dx ∧dy
and the measure associated with the volume dx∧dy on R2 is the usual Lebesgue measure dx dy, the formula
of the theorem is a restatement of Stokes’ theorem for this case.
■
This theorem may be phrased in terms of the divergence and the outward unit normal. If C is given
parametrically by t →(x(t), y(t)), then the outward unit normal is
n =
(y′(t), −x′(t))
%
x′(t)2 + y′(t)2
(7.3.1)
and the inﬁnitesimal arc-length (the volume element of C) is
ds =
%
x′(t)2 + y′(t)2d.
(See Figure 7.3.1.) If
X = P ∂
∂x + Q ∂
∂y ∈X(D),
recall that
div X = ∗d ∗X♭= ∂P
∂x + ∂Q
∂y .
7.3.2 Corollary.
Let D be a region in R2 bounded by a closed piecewise smooth curve C. If X ∈X(D),
then

C
(X · n)ds =

D
(div X)dx dy.
where

C f ds denotes the line integral of the function f over the positively oriented curve C and X·n is the
dot product.
Proof.
Using formula (7.3.1) for n, we have

C
(X · n)ds =
 b
a
[P(x(t)y(t))y′(t) −Q(x(t), y(t))x′(t)]dt
=

C
P dy −Q dx
(7.3.2)
by the deﬁnition of the line integral. By Theorem 7.3.1, equation (7.3.2) equals

D
∂P
∂x + ∂Q
∂y

dx dy =

D
(div X)dx dy.
■

436
7. Integration on Manifolds
D
C
n
Figure 7.3.1. Green’s Theorem
Taking P(x, y) = x and Q(x, y) = y in Green’s theorem, we get the following.
7.3.3 Corollary.
Let D be a region in R2 bounded by a closed piecewise smooth curve C. The area of D
is given by
area(D) = 1
2

C
x dy −y dx.
The classical Stokes theorem for surfaces relates the line integral of a vector ﬁeld around a simple closed
curve C in R3 to an integral over a surface S for which C = ∂S. Recall from advanced calculus that the
line integral of a vector ﬁeld X in R3 over the curve σ : [a, b] →R3 is deﬁned by

σ
X · ds =
 b
a
X(σ(t)) · σ′(t)dt.
(7.3.3)
The surface integral of a compactly supported two-form ω in R3 is deﬁned to be the integral of the pull-
back of ω to the oriented surface. If S is an oriented surface, n is called the outward unit normal at
x ∈S if n is perpendicular to TxS and {n, e1, e2} is a positively oriented basis of R3 whenever {e1, e2} is a
positively oriented basis of TxS. Thus S is orientable iﬀthe normal bundle to S, which has one-dimensional
ﬁber, is trivial. Also, the area element ν of S is given by Proposition 6.5.8. That is,
ν(x)(v1, v2) = µ(x)(n, v1, v2),
(7.3.4)
where v1, v2 ∈TxS, and µ = dx ∧dy ∧dz. We want to express

S ω in a form familiar from vector calculus.
Let ω = P dy ∧dz + Q dz ∧dx + R dx ∧dy so that ω = ∗X♭, where
X = P ∂
∂x + Q ∂
∂y + R ∂
∂z .
Recall that α ∧∗β = ⟨α, β⟩µ so that letting α = n♭, and β = X♭, we get
n♭∧∗X♭= (X · n)µ.
Applying both sides to (n, v1, v2) and using equation (7.3.2) gives
(n♭∧∗X♭)(n, v1, v2) = (X · n)ν(v1, v2)
(7.3.5)
(the base point x is suppressed). The left side of (7.3.5) is ∗X♭(v1, v2) since n♭is one on n and zero on v1
and v2. Thus (7.3.5) becomes
∗X♭= (X · n)ν.
(7.3.6)

7.3 The Classical Theorems of Green, Gauss, and Stokes
437
Therefore,

S
ω =

S
(X · n)dS =

S
X · dS,
where dS, the measure on S deﬁned by ν, is identiﬁed with a surface integral familiar from vector calculus.
A physical interpretation of

S(X · n)dS may be useful. Think of X as the velocity ﬁeld of a ﬂuid, so X is
pointing in the direction in which the ﬂuid is moving across the surface S and X · n measures the volume of
ﬂuid passing through a unit square of the tangent plane to S in unit time. Hence the integral

S(X · n)dS is
the net quantity of ﬂuid ﬂowing across the surface per unit time, that is, the rate of ﬂuid ﬂow. Accordingly,
this integral is also called the ﬂux of X across the surface.
7.3.4 Theorem (Classical Stokes Theorem).
Let S be an oriented compact surface in R3 and X a C1
vector ﬁeld deﬁned on S and its boundary. Then

S
(curl X) · n dS =

∂S
X · ds.
where n is the outward unit normal to S (Figure 7.3.2).
Proof.
First extend X via a bump function to all of R3 so that the extended X still has compact support.
By deﬁnition,

∂S X · ds =

∂S X♭where ♭denotes the index lowering action deﬁned by the standard metric
in R3. But dX♭= ∗(curl X)♭(see Example 6.4.3C) so that by equations (7.3.3), (7.3.6), and Stokes’ theorem,

∂S
X · ds =

S
dX♭=

S
∗(curl X)♭=

S
(curl X · n)dS.
■
S
n
X
Figure 7.3.2. Stokes’ Theorem
7.3.5 Examples.
A.
The historical origins of Stokes’ formula, are connected with Faraday’s law, which is discussed in
Chapter 8 and example B below. In ﬂuid dynamics, Stokes’ formula is useful in the development of Kelvin’s
circulation theorem, to be discussed in §8.2. Here we concentrate on a physical interpretation of the curl
operator. Suppose X represents the velocity vector ﬁeld of a ﬂuid. Let us apply Stokes’ theorem to a disk
Dr of radius r at a point P ∈R3 (Figure 7.3.3). We get

∂Dr
X · ds =

∂Dr
(curl X) · nds = (curl X · n)(Q)πr2,

438
7. Integration on Manifolds
the last equality coming from the mean value theorem for integrals; here Q ∈Dr is some point given by the
mean value theorem and πr2 is the area of Dr. Thus
((curl X) · n)(P) = lim
r→0
1
πr2

∂Dr
X · ds.
(7.3.7)
The number

C X · ds is called the circulation
of X around the closed curve C. It represents the net
amount of turning of the ﬂuid in a counterclockwise direction around C.
r
Dr
P
n
Figure 7.3.3. Curl is the circulation per unit area
Formula (7.3.7) gives the following physical interpretation for curl X, namely: (curl X)·n is the circulation
of X per unit area on a surface perpendicular to n. The magnitude of (curl X)·n is clearly maximized when
n = (curl X)/∥curl X∥. The vector curl X is called the vorticity vector.
B.
One of Maxwell’s equations of electromagnetic theory states that if E(x, y, z, t) and H(x, y, z) represent
the electric and magnetic ﬁelds at time t, then
∇× E = −∂H
∂t ,
where ∇× E is computed by holding t ﬁxed, and ∂H/∂t is computed by holding x, y, and z constant. Let
us use Stokes’ theorem to determine what this means physically. Assume S is a surface to which Stokes’
theorem applies. Then

∂S
E · ds =

S
(∇× E) · dS = −

S
dH
∂t · dS = −∂
∂t

S
H · dS.
(The last equality may be justiﬁed if H is C1.) Thus we obtain

∂S
E · ds = −∂
∂t

S
H · dS.
(7.3.8)
Equality (7.3.8) is known as Faraday’s law. The quantity

∂S E · ds represents the “voltage” around ∂S,
and if ∂S were a wire, a current would ﬂow in proportion to this voltage. Also

S H · dS is called the ﬂux
of H, or the magnetic ﬂux. Thus, Faraday’s law says that the voltage around a loop equals the negative of
the rate of change of magnetic ﬂux through the loop.
C.
Let X ∈X(R3). Since R3 is contractible, the Poincar´e lemma shows that curl X = 0 iﬀX = grad f
for some function f ∈F(R3). This in turn is equivalent (by Stokes’ theorem) to either of the following: (i)
for any oriented simple closed curve C,

C X · ds = 0, or (ii) for any oriented simple curves C1, C2 with the
same end points,

C1
X · ds =

C2
X · ds.

7.3 The Classical Theorems of Green, Gauss, and Stokes
439
The function f can be found in the following way:
f(x, y, z) =
 x
0
X1(t, 0, 0)dt +
 y
0
X2(x, t, 0)dt +
 z
0
X3(x, y, t)dt.
(7.3.9)
Thus, for example, if
X = y ∂
∂x + (z cos(yz) + x) ∂
∂y + y cos(yz) ∂
∂z ,
then curl X = 0 and so X = grad f, for some f. Using the formula (7.3.9), one ﬁnds
f(x, y, z) = xy + sin yz.
(7.3.10)
D.
The same arguments apply in R2 using Green’s theorem in place of Stokes’ theorem. Namely, if
X = X1 ∂
∂x + X2 ∂
∂y ∈X(R2)
and
∂X2
∂x = ∂X1
∂y ,
then X = grad f, for some f ∈F(R2) and conversely.
E.
The following statement is again a reformulation of the Poincar´e lemma: let X ∈X(R3), then div X = 0
iﬀX = curl Y for some Y ∈X(R3).
♦
7.3.6 Theorem (Classical Gauss Theorem).
Let Ωbe a compact set with nonempty interior in R3 bounded
by a surface S that is piecewise smooth. If X is a C1 vector ﬁeld on Ω∪S, then

Ω
(div X)dV =

S
(X · n)dS,
(7.3.11)
where dV denotes the standard volume element (Lebesgue measure) in R3 (Figure 7.3.4).
n
X
S = ∂Ω
Figure 7.3.4. Gauss’ Theorem
Proof.
Either use Corollary 7.2.10 or argue as in Theorem 7.3.4. By equation (7.3.6),

S
(X · n)dS =

S
∗X♭.

440
7. Integration on Manifolds
By Stokes’ theorem, this equals

Ω
d ∗X♭=

Ω
(div X)dV.
since d ∗X♭= (div X)dx ∧dy ∧dz.
■
7.3.7 Example.
We shall use the preceding theorem to prove Gauss’ law

∂Ω
r · n
r3 ds =
!
4π,
if 0 ∈Ω;
0,
if 0 /∈Ω,
(7.3.12)
where Ωis a compact set in R3 with nonempty interior, ∂Ωis the surface bounding Ω, which is assumed to
be piecewise smooth, n is the outward unit normal, 0 /∈∂Ω, and where
r = (x2 + y2 + z2)1/2,
r = (x, y, z).
If 0 /∈Ω, apply Theorem 7.3.6 and the fact that div(r/r3) = 0 to get the result. If 0 ∈Ω, surround 0
inside Ωby a ball Dϵ of radius ϵ (Figure 7.3.5). Since the orientation of ∂Dϵ induced from Ω\Dϵ is the
opposite of that induced from Dϵ (namely it is given by the inward unit normal), Gauss’ theorem gives

∂Ω
r · n
r3 dS +

∂Dϵ
r · n
r3 dS =

∂(Ω\Dϵ)
r · n
r3 dS = 0
(7.3.13)
since 0 /∈∂Ω\Dϵ and thus on Ω\Dϵ, we have div(r/r3) = 0. But on ∂Dϵ, r = ϵ and n = −r/ϵ, so that

∂Dϵ
r · n
r3 dS = −

∂Dϵ
ϵ2
ϵ4 dS = −1
ϵ2 4πϵ2 = −4π,
since

∂Dϵ
dS = 4πϵ2,
the area of the sphere of radius ϵ.
♦
n
0
ε
n
∂Ω
∂Dr
Figure 7.3.5. ??????????????

7.3 The Classical Theorems of Green, Gauss, and Stokes
441
In electrostatics Gauss’ law (7.3.12) is used in the following way. The potential due to a point charge q
at 0 ∈R3 is given by q/(4πr), where r = (x2 + y2 + z2)1/2. The corresponding electric ﬁeld is deﬁned to be
minus the gradient of this potential; that is,
E =
qr
4πr3 .
Thus Gauss’ law states that the total electric ﬂux

∂ΩE · n dS equals q if 0 ∈Ωand equals zero, if 0 /∈Ω.
A continuous charge distribution in Ωdescribed by a charge density ρ is related to E by ρ = div E. By
Gauss’ theorem the electric ﬂux

∂Ω
E · n dS =

Ω
ρ dV,
which represents the total charge inside Ω. Thus, the relationship div E = ρ may be phrased as follows. The
ﬂux out of a surface of an electric ﬁeld equals the total charge inside the surface.
Exercises
⋄7.3-1.
Use Green’s theorem to show that
(i) The area of the ellipse x2/a2 + y2/b2 = 1 is πab.
(ii) The area of the hypocycloid x = a cos3 θ, y = b sin3 θ is 3πa2/8.
(iii) The area of one loop of the four-leaved rose r = 3 sin 2θ is 9π/8.
⋄7.3-2.
Why does Green’s theorem fail in the unit disk for
−y
dx
(x2 + y2) +
xdy
(x2 + y2)?
⋄7.3-3.
For an oriented surface S and a ﬁxed vector a, show that
2

S
a · n dS =

∂S
(a × r) · dS.
⋄7.3-4.
Let the components of the vector ﬁeld X ∈X(R3) be homogeneous of degree one; that is,
X satisﬁes Xi(tx, ty, tz) = tXi(x, y, z), i = 1, 2, 3. Show that if curl X = 0, then X = grad f, where
f = (xX1 + yX2 + zX3)/2.
⋄7.3-5.
Let S be the surface of a region Ωin R3. Show that
volume(Ω) = 1
3

S
r · ndS.
Give an intuitive argument why this should be so.
Hint: Think of cones.
⋄7.3-6.
Let S be a closed (i.e., compact boundaryless) oriented surface in R3.
(i) Show in two ways that

S(curl X) · n dS = 0.
(ii) Let X = X(S) and f ∈F(S). Make sense of and show that

S
(grad f)X · dS = −

S
(f curl X)dS
where grad, curl, and div are taken in R3.

442
7. Integration on Manifolds
⋄7.3-7.
Let X and Y be smooth vector ﬁelds on an open set D ⊂R3, with ∂D smooth, and cl(D) compact.
Show that

D
Y · curl X dV =

D
X · curl Y dV +

∂D
(X × Y) · n dS.
where n is the outward unit normal to ∂D and dS the induced surface measure on ∂D.
Hint: Show that
Y · curl X −X · curl Y = div(X × Y).
⋄7.3-8.
If C is a closed curve bounding a surface S show that

C
f(grad g) · ds =

S
(grad f × grad g) · n dS = −

C
g(grad f) · ds
where f and g are C2 functions.
⋄7.3-9 (A. Lenard).
Faraday’s law relates the line integral of the electric ﬁeld around a loop C to the
surface integral of the rate of change of the magnetic ﬁeld over a surface S with boundary C. Regarding
the equation ∇× E = −∂H/∂t as the basic equation, Faraday’s law is a consequence of Stokes’ theorem,
as we have seen in Example 7.3.5B. Suppose we are given electric and magnetic ﬁelds in space that satisfy
the equation ∇× E = −∂H/∂t. Suppose C is the boundary of the M¨obius band shown in Figure 6.5.1.
Since the M¨obius band cannot be oriented, Stokes’ theorem does not apply. What becomes of Faraday’s
law? Resolve the issue in two ways: (i) by using the results of Supplement 7.2A or a direct reformulation of
Stokes’ theorem for nonorientable surfaces, and (ii) realizing C as the boundary of an orientable surface. If
∂H/∂t is arbitrary, in general does a current ﬂow around C or not?
7.4
Induced Flows on Function Spaces and Ergodicity
This section requires some results from functional analysis. Speciﬁcally we shall require a knowledge of
Stone’s theorem and self-adjoint operators. The required results may be found in Supplements 7.4A and
7.4B at the end of this section.
Flows on manifolds induce ﬂows on tangent bundles, tensor bundles, and spaces of tensor ﬁelds by means
of push-forward. In this section we shall be concerned mainly with the induced ﬂow on the space of functions.
This induced ﬂow is sometimes called the Liouville ﬂow.
Let M be a manifold and µ a volume element on M; that is, (M, µ) is a volume manifold. If Ft is a
(volume-preserving) ﬂow on M, then Ft induces a linear one-parameter group (of isometries) on the Hilbert
space H = L2(Mµ) by
Ut(f) = f ◦F−t.
The association of Ut with Ft replaces a nonlinear ﬁnite-dimensional problem with a linear inﬁnite-dimensional
one.
There have been several theorems that relate properties of Ft and Ut. The best known of these is the
result of Koopman [1931], which shows that Ut has one as a simple eigenvalue for all t if and only if Ft is
ergodic. (If there are no other eigenvalues, then Ft is called weakly mixing.) A few basic results on ergodic
theory are given below. We refer the reader to the excellent texts of Halmos [1956], Arnol’d and Avez [1967],
and Bowen [1975] for more information.
We shall ﬁrst present a result of Povzner [1966], which relates the completeness of the ﬂow of a divergence-
free vector ﬁeld X to the skew-adjointness of X as an operator. (The hypothesis of divergence free is removed
in Exercises 7.4-1–7.4-3.) We begin with a lemma due to Ed Nelson.

7.4 Induced Flows on Function Spaces and Ergodicity
443
7.4.1 Lemma.
Let A be an (unbounded) self-adjoint operator on a complex Hilbert space H. Let D0 ⊂
D(A) (the domain of A) be a dense linear subspace of H and suppose Ut = eitA (the unitary one-parameter
group generated by A) leaves D0 invariant. Then A0 := (A restricted to D0) is essentially self-adjoint; that
is, the closure of A0 is A.
Proof.
Let A denote the closure of A0. Since A is closed and extends A0, A extends A. We need to prove
that A extends A.
For λ > 0, λ−iA is surjective with a bounded inverse. First of all, we prove that λ−iA0 has dense range.
If not, there is a v ∈H such that
⟨v, λx −iA0x⟩= 0
for all x ∈D0.
In particular, since D0 is Ut-invariant,
d
dt⟨v, Utx⟩= ⟨v, iAUtx⟩= λ⟨v, Utx⟩
so
⟨v, Utx⟩= eλt⟨v, x⟩.
Since D0 is dense, this holds for all x ∈H. Thus, ∥Ut∥= 1 and λ > 0 imply v = 0. Therefore (λ −iA0)−1
makes sense and (λ −iA)−1 is its closure. It follows from Supplement 7.4A that A is the closure of A0 (see
Corollary 7.4.15 and the remarks following it).
■
7.4.2 Proposition.
Let X be a C∞divergence-free vector ﬁeld on (M, µ) with a complete ﬂow Ft. Then
iX is an essentially self-adjoint operator on C∞
c
= C∞functions with compact support in the complex
Hilbert space L2(M, µ).
Proof.
Let Utf = f ◦F−t be the unitary one-parameter group induced from Ft. A straightforward conver-
gence argument shows that Utf is continuous in t in L2(M, µ). In Lemma 7.4.1, choose D0 = C∞functions
with compact support. This is clearly invariant under Ut. If f ∈D0, then
d
dtUtf

t=0
= d
dtf ◦F−t

t=0
= −df · X,
so the generator of Ut is an extension of −X (as a diﬀerential operator) on D0. The corresponding essentially
self–adjoint operator is therefore iX.
■
Now we prove the converse of Proposition 7.4.2. That is, if iX is essentially self-adjoint, then X has an
almost everywhere complete ﬂow. This then gives a functional-analytic characterization of completeness.
7.4.3 Theorem.
Let M be a manifold with a volume element µ and X be a C∞divergence-free vector
ﬁeld on M. Suppose that, as an operator on L2(M, µ), iX is essentially self-adjoint on the C∞functions
with compact support. Then, except possibly for a set of points x of measure zero, the ﬂow Ft(x) of X is
deﬁned for all t ∈R.
We shall actually prove that, if the defect index of iX is zero in the upper half-plane (i.e., if (iX +i)(C∞
c )
is dense in L2), then the ﬂow is deﬁned, except for a set of measure zero, for all t > 0. Similarly, if the defect
index of iX is zero in the lower half-plane, the ﬂow is essentially complete for t < 0. The converses of these
more general results can be established along the lines of the proof of Lemma 7.4.1.
Proof (E. Nelson—private communication).
Suppose that there is a set E of ﬁnite positive measure such
that if x ∈E, Ft(x) fails to be deﬁned for t suﬃciently large. Let ET be the set of x ∈E for which Ft(x)
is undeﬁned for t ≥T. Since E = 
T ≥1 ET , some ET has positive measure. Replacing E by ET , we may
assume that all points of E “move to inﬁnity” in a time ≤T.

444
7. Integration on Manifolds
If f is any function on M, we adopt the convention that f(Ft(x)) = 0 if Ft(x) is undeﬁned. For any x ∈M,
and t < −T, Ft(x) must be either in the complement of E or undeﬁned; otherwise it would be a point of
E that did not move to inﬁnity in time T. Hence χE(Ft(x)) = 0 for t < −T, where χE is the characteristic
function of E. We now deﬁne a function on M by
g(x) =
 ∞
−∞
e−τχE(Fτ(x))dτ.
Note that the integral converges because the integrand vanishes for t < −T. In fact, we have
0 ≤g(x) ≤
 ∞
−T
e−τdτ = eT .
Moreover, g is in L2. Indeed, because Ft is measure-preserving, where deﬁned, denoting by ∥· ∥2 the L2
norm, we have ∥χE ◦Fτ∥2 ≤∥χE∥2, so that
∥g∥2 ≤
 ∞
−T
e−τ∥χE ◦Fτ∥2dτ ≤∥χE∥2eT .
The function g is nonzero because E has positive measure.
Fix a point x ∈M. Then Ft(x) is deﬁned for t suﬃciently small. It is easy to see that in this case
Fτ(Ft(x)) and Fτ+t(x) are deﬁned or undeﬁned together, and in the former case they are equal. Hence we
have χE(Fτ(Ft(x)) = χE(Fτ+t(x)) for t suﬃciently small. Therefore, for
g(Ft(x)) =
 ∞
−∞
e−τχE(Fτ+t(x))dτ =
 ∞
−∞
et−τχE(Fτ(x))dτ = etg(x).
Now if ϕ is C∞with compact support, we have

g(x)X[ϕ](x)dµ = lim
t→0

g(x)ϕ(Ft(x)) −ϕ(x)
t
dµ
= lim
t→0
 g(F−t(x)) −g(x)
t
ϕ(x)dµ
= lim
t→0
 e−t −1
t
g(x)ϕ(x)dµ = −

g(x)ϕ(x)dµ.
These equalities are justiﬁed because on the support of ϕ the ﬂow Ft exists for suﬃciently small t and is
measure-preserving. Thus g is orthogonal to the range of X + 1, and therefore the defect index of iX in the
upper half-plane is nonzero.
The case of completeness for t < 0 is similar.
■
Methods of functional analysis applied to L2(M, µ) can, as we have seen, be used to obtain theorems
relevant to ﬂows on M. Related to this is a measure-theoretic analogue of the fact that any automorphism of
the algebra F(M) is induced by a diﬀeomorphism of M (see Supplement 4.2C). This result, due to Mackey
[1962], states that if Ut is a linear isometry on L2(M, µ), which is multiplicative (i.e., Ut(fg) = (Utf)(Utg),
where deﬁned), then Ut is induced by some measure preserving ﬂow Ft on M. This may be used to give
another proof of Theorem 7.4.3.
An important notion for statistical mechanics is that of ergodicity; this is intended to capture the idea
that a ﬂow may be random or chaotic. In dealing with the motion of molecules, the founders of statistical
mechanics, particularly Boltzmann and Gibbs, made such hypotheses at the outset. One of the earliest
precise deﬁnitions of randomness of a dynamical system was minimality: the orbit of almost every point is
dense. In order to prove useful theorems, von Neumann and Birkhoﬀin the early 1930s required the strong
assumption of ergodicity, deﬁned as follows.

7.4 Induced Flows on Function Spaces and Ergodicity
445
7.4.4 Deﬁnition.
Let S be a measure space and Ft a (measurable) ﬂow on S. We call Ft ergodic if the
only invariant measurable sets are ∅and all of S.
Here, invariant means Ft(A) = A for all t ∈R and we agree to write A = B if A and B diﬀer by a set
of measure zero. (It is not diﬃcult to see that ergodicity implies minimality if we are on a second countable
Borel space.)
A function f : S →R will be called a constant of the motion if f ◦Ft = f a.e. (almost everywhere)
for each t ∈R.
7.4.5 Proposition.
A ﬂow Ft on S is ergodic iﬀthe only constants of the motion are constant a.e.
Proof.
If Ft is ergodic and f is a constant of the motion, the two sets
{ x ∈S | f(x) ≥a }
and { x ∈S | f(x) ≤a } are invariant, so f must be constant a.e. The converse follows by taking f to be a
characteristic function.
■
The ﬁrst major step in ergodic theory was taken by von Neumann [1932], who proved the mean ergodic
theorem which remains as one of the most important basic theorems. The setting is in Hilbert space, but
we shall see how it applies to ﬂows of vector ﬁelds in Corollary 7.4.7.
7.4.6 Theorem (Mean Ergodic Theorem).
Let H be a real or complex Hilbert space and Ut : H →H a
strongly continuous one-parameter unitary group (i.e., Ut is unitary for each t, is a ﬂow on H and for each
x ∈H, the map t →Utx is continuous).
Let the closed subspace H0 be deﬁned by
H0 = { x ∈H | Utx = x for all t ∈R }
and let P be the orthogonal projection onto H0. Then for any x ∈H,
lim
t→∞

1
t
 t
0
Usx ds −Px
 = 0.
The point av(x) = Px so deﬁned is called the time average of x.
Proof (Riesz [1944]).
We must show that
lim
t→∞

1
t
 t
0
Usx ds −Px
 = 0.
If Px = x, this means x ∈H0, so Us(x) = x; the result is clearly true in this case. We can therefore suppose
that Px = 0 by considering the decomposition x = Px + (x −Px). Note that
{ Uty −y | y ∈H, t ∈R }⊥= H0
where ⊥denotes the orthogonal complement. This is an easy veriﬁcation using unitarity of Ut and U −1
t
=
U−t. It follows that ker P is the closure of the space spanned by elements of the form Usy −y. Indeed
ker P = H⊥
0 , and if A is any set in H, and B = A⊥, then B⊥is the closure of the span of A. Therefore, for
any ϵ > 0, there exists t1, . . . , tn and x1, . . . , xn such that

x −
n

j=1
(Utjxj −xj)

< ϵ.

446
7. Integration on Manifolds
It follows from this, again using unitarity of Ut, that it is enough to prove our assertion for x of the form
Uτy −y. Thus we must establish
lim
t→∞
1
t
 t
0
Us(Uτy −y)ds = 0.
For t > τ we may estimate this integral as follows:

1
t
 t
0
(UsUτy −Usy)ds
 =
−1
t
 τ
0
Us(y)ds + 1
t
 t+τ
0
Us(y)ds

≤1
t
 τ
0
∥y∥ds + 1
t
 t+τ
0
∥y∥ds
= 2τ∥y∥
t
→0 as t →∞.
■
To apply Theorem 7.4.6 to a measure-preserving ﬂow Ft on S, we consider the unitary one-parameter
group Ut(f) = f ◦Ft on L2(S, µ). We only require a minimal amount of continuity on Ft here, namely, we
assume that if s →t, Fs(x) ∈Ft(x) for a.e. x ∈S. We shall also assume µ(S) < ∞for convenience. Under
these hypotheses, Ut is a strongly continuous unitary one–parameter group. The veriﬁcation can be done
with the aid of the dominated convergence theorem.
7.4.7 Corollary.
In the hypotheses above Ft is ergodic if and only if for each f ∈L2(S) its time average
av(f)(x) =
lim
t→±∞
1
t
 t
0
(f ◦Fs)(x)ds
(the limit being in the L2-mean) is constant a.e. In this case the time average av(f) necessarily equals the
space average

S fdµ/µ(S) a.e.
Proof.
Ergodicity of Ft is equivalent, by Proposition 7.4.5, to dim H0 = 1, where H0 is the closed subspace
of L2(S) given in Theorem 7.4.6. If dim H0 = 1,
P(f) =

S
fdµ
µ(S)
so the equality of av(f) with P(f) a.e. is a consequence of Theorem 7.4.6. Conversely if any f ∈L2(S) has
a.e. constant time average av(f) then taking f to be a constant of motion, it follows that f = av(f) is
constant a.e. Therefore, dim H0 = 1.
■
Thus, if Ft is ergodic, the time average of a function is constant a.e. and equals its space average. A
reﬁnement of this is the individual ergodic theorem of Birkhoﬀ[1931], in which one obtains convergence
almost everywhere. Also, if µ(S) = ∞but f ∈L1(S) ∩L2(S), one still concludes a.e. convergence of the
time average. (If f is only L2, mean convergence to zero is still assured by Proposition 7.4.5.)
Modern work in dynamical systems, following the ideas in §4.3, has shown that for many interesting ﬂows
arising in the physical sciences, the motion can be “chaotic” on large regions of phase space without being
ergodic. Much current research is focused on trying to prove analogues of the ergodic theorems for such cases.
(See, for instance, Guckenheimer and Holmes [1983], Eckmann and Ruelle [1985], and references therein.)
A particularly important example of an ergodic ﬂow is the irrational ﬂow on the torus.
7.4.8 Deﬁnition.
The ﬂow Ft : Tn →Tn given by Ft([ϕ]) = [ϕ + νt], for ν ∈Rn is called the quasiperi-
odic or linear ﬂow on Tn determined by ν. The quasiperiodic ﬂow is called irrational if the components
(ν1, . . . , νn) of ν are linearly independent over Z (or, equivalently, over Q), that is, k · ν = 0 for k ∈Zn
implies k = 0.

7.4 Induced Flows on Function Spaces and Ergodicity
447
7.4.9 Proposition.
The linear ﬂow Ft on Tn determined by ν ∈Rn is ergodic if and only if it is irrational.
Proof.
Assume the ﬂow is irrational and let f ∈L2(Tn) be a constant of the motion. Expand f([ϕ]) and
(f ◦Ft)([ϕ]) in Fourier series:
f([ϕ]) =

k∈Zn
akeik·ϕ
and
(f ◦Ft)([ϕ]) =

k∈Zn
bk(t)eik·ϕ
where the convergence is in L2 and the Fourier coeﬃcients are given by
ak =

T n eik·ϕf([ϕ])dϕ
bk(t) =

T n eik·ϕf([ϕ + νt])dϕ
=

T n eik·(ϕ−νt)f([ϕ])dϕ = eik·νtak.
(The measure dϕ is chosen such that the total volume of Tn equals one.) Since f is a constant of the motion,
ak = bk(t) for all k ∈Zn and all t ∈R which implies that ek·νt = 1 for all k ∈Zn, t ∈R. Thus k · ν = 0
which by hypothesis forces k = 0. Consequently all ak = 0 with the exception of a0 and thus f = a0 a.e.
Conversely, assume Ft is ergodic and that k · ν = 0 for some k ∈Zn\{0}. Then the set A = { [ψ] ∈Tn |
k · ψ = 0 } is closed and hence measurable and invariant under Ft. But clearly A ̸= ∅and A ̸= Tn which
shows that Ft is not ergodic.
■
7.4.10 Corollary.
Let Ft be an irrational ﬂow on Tn determined by ν. Then every trajectory of Ft is
uniformly distributed on Tn, that is, for any measurable set A in Tn,
lim
t→±∞
measure A(t)
t
= measure A
where
A(t) = { s ∈[0, t] | Fs([ψ]) ∈A }
and the measure of Tn is assumed to be equal to one.
Proof.
Let χA be the characteristic function of A. Then
av(χA)([ψ]) =
lim
t→±∞
1
t
 t
0
χA(Fs([ψ]))ds
=
lim
t→±∞
1
t (measure A(t))
=

T n(χA([ψ]))dϕ
= measure A
by Corollary 7.4.7 and Proposition 7.4.9.
■
7.4.11 Corollary.
Every trajectory of a quasiperiodic ﬂow Ft on Tn is dense if and only if the ﬂow is
irrational.
Proof.
By translation of the initial condition it is easily seen that every trajectory is dense on Tn if and
only if the trajectory through [0] is dense. Assume ﬁrst that the ﬂow is irrational. If { Ft([0]) | t ∈R } is

448
7. Integration on Manifolds
not dense in Tn then there is an open set U in Tn not containing any point of this trajectory. Thus, in the
notation of Corollary 7.4.10, U(t) = ∅. This contradicts 7.4.10 since the measure of U is strictly positive.
Conversely, assume that the trajectory through [0] is dense and let f be a continuous constant of the
motion for Ft. This implies that f is a constant. Since continuous functions are dense in L2, this in turn
implies that any L2-constant of the motion is constant a.e. By Proposition 7.4.5, Ft is ergodic and by
Proposition 7.4.9, Ft is irrational.
■
Supplement 7.4A
Unbounded and Self Adjoint Operators.2
In many applications involving diﬀerential equations, the operators one meets are not deﬁned on the whole
Banach space E and are not continuous. Thus we are led to consider a linear transformation A : DA ⊂E →E
where DA is a linear subspace of E (the domain of A). If DA is dense in E, we say A is densely deﬁned.
We speak of A as an operator and this shall mean linear operator unless otherwise speciﬁed.
Even though A is not usually continuous, it might have the important property of being closed. We say
A is closed if its graph ΓA
ΓA = { (x, Ax) ∈E × E | x ∈DA }
is a closed subset of E × E. This is equivalent to
(xn ∈DA, xn →x ∈E and Axn →y ∈E)
implies (x ∈DA and Ax = y).
An operator A (with domain DA) is called closable if cl(ΓA), the closure of the graph of A, is the graph
of an operator, say, A. We call A the closure of A. It is easy to see that A is closable iﬀ{(xn ∈DA, xn →0
and Axn →y) implies y = 0}. Clearly A is a closed operator that is an extension of A; that is, DA ⊃DA
and A = A on DA. One writes this as A ⊃A.
The closed graph theorem from §2.2 asserts that an everywhere deﬁned closed operator is bounded.
However, if an operator is only densely deﬁned, “closed” is weaker than “bounded.” If A is a closed operator,
the map x →(x, Ax) is an isomorphism between DA and the closed subspace ΓA. Hence if we set
|||x|||2 = ∥x∥2 + ∥Ax∥2,
DA becomes a Banach space. We call the norm ||| · ||| on DA the graph norm.
Let A be an operator on a real or complex Hilbert space H with dense domain DA. The adjoint of A is
the operator A∗with domain DA∗, deﬁned as follows:
DA∗= { y ∈H | there is a z ∈H such that
⟨Ax, y⟩= ⟨x, z⟩for all x ∈DA }
and
A∗: DA∗→H,
y →z.
From the fact that DA is dense, we see that A∗is indeed well deﬁned (there is at most one such z for any
y ∈H). It is easy to see that if A ⊃B then B∗⊃A∗.
2This supplement was written in collaboration with P. Chernoﬀ.

7.4 Induced Flows on Function Spaces and Ergodicity
449
If A is everywhere deﬁned and bounded, it follows from the Riesz representation theorem (Supplement
2.2A) that A∗is everywhere deﬁned; moreover it is not hard to see that, in this case, ∥A∗∥= ∥A∥.
An operator A is symmetric (Hermitian in the complex case) if A∗⊃A; that is, ⟨Ax, y⟩= ⟨x, Ay⟩
for all x, y ∈DA. If A∗= A (this includes the condition DA∗= DA), then A is called self-adjoint. An
everywhere deﬁned symmetric operator is bounded (from the closed graph theorem) and so is self-adjoint.
It is also easy to see that a self-adjoint operator is closed.
One must be aware that, for technical reasons, it is the notion of self-adjoint rather than symmetric,
which is important in applications. Correspondingly, verifying self-adjointness is often diﬃcult while verifying
symmetry is usually trivial.
Sometimes it is useful to have another concept at hand, that of essential self-adjointness. First, it is easy
to check that any symmetric operator A is closable. The closure A is easily seen to be symmetric. One says
that A is essentially self-adjoint when its closure A is self-adjoint.
Let A be a self-adjoint operator. A dense subspace C ⊂H is said to be a core of A if C ⊂DA and the
closure of A restricted to C is again A. Thus if C is a core of A one can recover A just be knowing A on C.
We now give a number of propositions concerning the foregoing concepts, which are useful in applications.
Most of this is classical work of von Neumann. We begin with the following.
7.4.12 Proposition.
Let A be a closed symmetric operator of a complex Hilbert space H. If A is self-
adjoint then A + λI is surjective for every complex number λ with Im λ ̸= 0 (I is the identity operator).
Conversely, if A is symmetric and A −iI and A + iI are both surjective then A is self-adjoint.
Proof.
Let A be self-adjoint and λ = α + iβ, β ̸= 0. For x ∈DA we have
∥(A + λ)x∥2 = ∥(A + α)x∥2 + iβ⟨x, Ax⟩−iβ⟨Ax, x⟩+ β2∥x∥2
= ∥(A + α)x∥2 + β2∥x∥2 ≥β2∥x∥2,
where A + λ means A + λI. Thus we have the inequality
∥(A + λ)x∥≥| Im λ| ∥x∥
(7.4.1)
Since A is closed, it follows from equation (7.4.1) that the range of A+λ is a closed set for Im λ ̸= 0. Indeed,
let yn = (A + λ)xn →y. By the inequality (7.4.1),
∥xn −xm∥≤∥yn −ym∥
| Im λ|
so xn converges to, say x. Also Axn converges to y −λx; thus x ∈DA and y −λx = Ax as A is closed.
Now suppose y is orthogonal to the range of A + λI. Thus
⟨Ax + λx, y⟩= 0 for all x ∈DA,
or
⟨Ax, y⟩= −⟨x, λy⟩.
By deﬁnition, y ∈DA∗and A∗y = −¯λy; since A = A∗, y ∈DA, and Ay = −¯λy, we obtain (A + λI)y = 0.
Thus the range of A + λI is all of H.
Conversely, suppose A + i and A −i are onto. Let y ∈DA∗. Thus for all x ∈DA,
⟨(A + i)x, y⟩= ⟨x, (A∗−i)y⟩= ⟨x, (A −i)z⟩
for some z ∈DA since A −i is onto. Thus,
⟨(A + i)x, y⟩= ⟨(A + i)x, z⟩
and it follows that y = z. This proves that DA∗⊂DA and so DA = DA∗. The result follows.
■

450
7. Integration on Manifolds
If A is self-adjoint then for Im λ ̸= 0, λI −A is onto and from equation (7.4.1) is one-to-one. Thus
(λI −A)−1 : H →H exists, is bounded, and we have
∥(λI −A)−1∥≤
1
| Im λ|
(7.4.2)
This operator (λI −A)−1 is called the resolvent of A. Notice that even though A is an unbounded operator,
the resolvent is bounded. The same argument used to prove Proposition 7.4.12 shows the following.
7.4.13 Proposition.
A symmetric operator A is essentially self-adjoint iﬀthe ranges of A+iI and A−iI
are dense.
If A is a (closed) symmetric operator then the ranges of A + iI and A −iI are (closed) subspaces. The
dimensions of their orthogonal complements are called the deﬁciency indices of A. Thus, Propositions
(7.4.12) and (7.4.13) can be restated as: a closed symmetric operator (resp., a symmetric operator) is self-
adjoint (resp., essentially self-adjoint) iﬀit has deﬁciency indices (0, 0).
If A is a closed symmetric operator then from equation (7.4.1), A + iI is one-to-one and we can consider
the inverse (A + iI)−1, deﬁned on the range of A + iI. One calls
(A −iI)(A + iI)−1
the Cayley transform of A. It is always isometric, as is easy to check. Thus A is self–adjoint iﬀits Cayley
transform is unitary.
Let us return to the graph of an operator A for a moment. The adjoint can be described entirely in terms
of its graph and this is often convenient. Deﬁne an isometry J : H ⊕H →H ⊕H by J(x, y) = (−y, x); note
that J2 = −I.
7.4.14 Proposition.
Let A be densely deﬁned. Then (ΓA)⊥= J(ΓA∗) and −ΓA∗= J(ΓA)⊥. In particular,
A∗is closed, and if A is closed, then
H ⊕H = ΓA ⊕J(ΓA∗),
where H ⊕H carries the usual inner product:
⟨(x1, x2), (y1, y2)⟩= ⟨x1, y1⟩+ ⟨x2, y2⟩.
Proof.
Let (z, y) ∈J(ΓA∗), so y ∈DA∗and z = −A∗y. Let x ∈DA. We have
⟨(x, Ax), (−A∗y, y)⟩= ⟨x, −A∗y⟩+ ⟨Ax, y⟩= 0,
and so J(ΓA∗) ⊂Γ⊥
A.
Conversely if (z, y) ∈(ΓA)⊥, then ⟨x, z⟩+ ⟨Ax, y⟩= 0 for all x ∈DA. Thus by deﬁnition, y ∈DA∗and
z = −A∗y. This proves the opposite inclusion.
■
Thus if A is a closed operator, the statement H ⊕H = ΓA ⊕J(ΓA∗) means that given e, f ∈H, the
equations
x −A∗y = e
and
Ax + y = f
have exactly one solution (x, y). If A is densely deﬁned and symmetric, then its closure A satisﬁes A ⊂A∗
since A∗is closed. There are other important consequences of Proposition 7.4.14 as well.
7.4.15 Corollary.
For A densely deﬁned and closeable, we have
(i) A = A∗∗, and
(ii) A∗= A∗.

7.4 Induced Flows on Function Spaces and Ergodicity
451
Proof.
(i) Note that
ΓA∗∗= −J{(ΓA∗)⊥} = −(J(ΓA∗))⊥
since J is an isometry. But
−(J(ΓA∗))⊥= −(J2Γ⊥
A)⊥= Γ⊥⊥
A
= cl(ΓA) = ΓA.
(ii) follows since Γ⊥
A = cl(Γ⊥
A).
■
Suppose A : DA ⊂H →H is one-to-one. Then we get an operator A−1 deﬁned on the range of A. In
terms of graphs:
ΓA−1 = K(ΓA),
where K(x, y) = (y, x); note that K2 = I, K is an isometry and KJ = −JK. It follows for example that if
A is self-adjoint, so is A−1, since
Γ(A−1)∗= −J(Γ⊥
A−1) = −J(KΓ⊥
A) = KJΓ⊥
A = KΓ(A∗) = ΓA∗−1.
Next we consider possible self-adjoint extensions of a symmetric operator.
7.4.16 Proposition.
Let A be a symmetric densely deﬁned operator on H and A its closure. The following
are equivalent:
(i) A is essentially self-adjoint.
(ii) A∗is self-adjoint.
(iii) A∗∗⊃A∗.
(iv) A has exactly one self-adjoint extension.
(v) A = A∗.
Proof.
By deﬁnition, (i) means A∗= A. But we know A∗= A∗and A = A∗∗by Corollary 7.4.15. Thus
(i), (ii), (v) are equivalent. These imply (iii). Also (iii) implies (ii) since A ⊂A ⊂A∗⊂A∗∗= A and so
A∗= A∗∗. To prove (iv) is implied let Y be any self-adjoint extension of A. Since Y is closed, Y ⊃A. But
A = A∗so Y extends the self-adjoint operator A∗; that is, Y ⊃A. Taking adjoints, A∗= A ⊃Y ∗= Y so
Y = A.
To prove that (iv) implies the others is a bit more complicated. We shall in fact give a more general result
in Proposition 7.4.18 below. First we need some notation. Let
D+ = range(A + iI)⊥⊂H
and
D−= range(A −iI)⊥⊂H
called the positive and negative defect spaces. Using the argument in Proposition 7.4.12 it is easy to
check that
D+ = { x ∈DA∗| A∗x = ix }
and
D−= { x ∈DA∗| A∗x = −ix }.
■
7.4.17 Lemma.
Using the graph norm on DA∗, we have the orthogonal direct sum
DA∗= DA ⊕D+ ⊕D−.

452
7. Integration on Manifolds
Proof.
Since D+, D−are closed in H they are closed in DA∗. Also DA ⊂DA∗is closed since A∗is an
extension of A and hence of A. It is easy to see that the indicated spaces are orthogonal. For example let
x ∈DA and y ∈D−. Then using the inner product
⟨⟨x, y⟩⟩= ⟨x, y⟩+ ⟨A∗x, A∗y⟩
gives
⟨⟨x, y⟩⟩= ⟨x, y⟩+ ⟨A∗x, −iy⟩= ⟨x, y⟩−i⟨A∗x, y⟩.
Since x ∈DA = DA∗, by Proposition 7.4.16(v), we get
⟨⟨x, y⟩⟩= ⟨x, y⟩−i⟨x, A∗y⟩= ⟨x, y⟩−⟨x, y⟩= 0.
To see that DA∗= DA ⊕D+ ⊕D−it suﬃces to show that the orthogonal complement of DA ⊕D+ ⊕D−
is zero. Let u ∈(DA ⊕D+ ⊕D−)⊥, so
⟨⟨u, x⟩⟩= ⟨⟨u, y⟩⟩= ⟨⟨u, z⟩⟩= 0
for all x ∈DA, y ∈D+, z ∈D−. From ⟨⟨u, x⟩⟩= 0 we get
⟨u, x⟩+ ⟨A∗u, A∗x⟩= 0
that is, or A∗u ∈DA∗and A∗A∗u = −u. It follows that (I −iA∗)u ∈D+. But from ⟨⟨u, y⟩⟩= 0 we have
⟨(I −iA∗)u, y⟩= 0 and so (I −iA∗)u = 0. Hence u ∈D−. Taking z = u gives u = 0.
■
7.4.18 Proposition.
The self-adjoint extensions of a symmetric densely deﬁned operator A (if any) are
obtained as follows. Let T : D+ →D−be an isometry mapping D+ onto D−and let ΓT ⊂D+ ⊕D−be its
graph. Then the restriction of A∗to DA ⊕ΓT is a self-adjoint extension of A.
Thus, A has self-adjoint extensions iﬀits defect indices (dim D+, dim D−) are equal and these extensions
are in one-to-one correspondence with all isometries of D+ onto D−. Assuming this result for a moment, we
give the following.
Completion of Proof of Proposition 7.4.16.
If there is only one self-adjoint extension it follows from
proposition 7.4.18 that D+ = D−= {0} so by proposition 7.4.13, A is essentially self-adjoint.
■
Proof of Proposition 7.4.18.
Let B be a self-adjoint extension of A. Then A∗= A∗⊃B so B is the
restriction of A∗to some subspace containing DA. We want to show that these subspaces are of the form
DA ⊕ΓT as stated.
Suppose ﬁrst that T : D+ →D−is an isometry onto and let A be the restriction of A∗to DA ⊕ΓT . First
of all, one proves that A is symmetric: that is, for u, x ∈DA and v, y ∈D+ that
⟨Ax + A∗y + A∗Ty, u + v + Tv⟩= ⟨x + y + Ty, Au + A∗v + A∗Tv⟩.
This is a straightforward computation using the deﬁnitions.
To show that A is self-adjoint, we show that DA∗⊂DA. If this does not hold there exists a nonzero
z ∈DA∗such that either A∗z = iz or A∗z = −iz. This follows from Lemma 7.4.17 applied to the operator
A. (Observe that A is a closed operator—this easily follows.) Now A ⊃A so A∗⊃A∗. Thus z ∈D+ or
z ∈D−. Suppose z ∈D+. Then z + Tz ∈DA so as ⟨⟨DA, z⟩⟩= 0, where ⟨⟨, ⟩⟩denotes the inner product
relative to A,
0 = ⟨⟨z + Tz, z⟩⟩= ⟨⟨z, z⟩⟩+ ⟨⟨Tz, z⟩⟩= 2⟨z, z⟩,
since Tz ∈D−. Hence z = 0. In a similar way one sees that if z ∈D−then z = 0. Hence A is self-adjoint.
We will leave the details of the converse to the reader (they are similar to the foregoing). The idea is this:
if A is restriction of A∗to a subspace DA ⊕V for V ⊂D+ ⊕D−and A is symmetric, then V is the graph
of a map T : W ⊂D+ →D−and ⟨Tu, Tv⟩= ⟨u, v⟩, for a subspace W ⊂D+. Then self-adjointness of A
implies that in fact W = D+ and T is onto.
■

7.4 Induced Flows on Function Spaces and Ergodicity
453
A convenient test for establishing the equality of the deﬁciency indices is to show that T commutes with
a conjugation U; that is, an antilinear isometry U : H →H satisfying U 2 = I; antilinear means that
U(αx) = ¯αUx
for complex scalars α and
U(x + y) = Ux + Uy
for x, y ∈H. It is easy to see that U is the isometry required from D+ to D−(use D+ = range(A + iI)⊥).
As a corollary, we obtain an important classical result of von Neumann: Let H be L2 of a measure space and
let A be a (closed) symmetric operator that is real in the sense that it commutes with complex conjugation.
Then A admits self-adjoint extensions. (Another suﬃcient condition of a diﬀerent nature, due to Friedrichs,
is given below.) This result applies to many quantum mechanical operators. However, one is also interested
in essential self-adjointness, so that the self-adjoint extension will be unique. Methods for proving this for
speciﬁc operators in quantum mechanics are given in Kato [1951, 1976] and Reed and Simon [1974]. For
corresponding questions in elasticity, see Marsden and Hughes [1983]. We now give some additional results
that illustrate methods for handling self-adjoint operators.
7.4.19 Proposition.
Let A be a self-adjoint and B a bounded self-adjoint operator. Then A + B (with
domain DA) is self-adjoint. If A is essentially self-adjoint on DA then so is A + B.
Proof.
A + B is certainly symmetric on DA. Let y ∈D(A+B)∗so that for all x ∈DA,
⟨(A + B)x, y⟩= ⟨x, (A + B)∗y⟩.
The left side is
⟨Ax, y⟩+ ⟨Bx, y⟩= ⟨Ax, y⟩+ ⟨x, By⟩
since B is everywhere deﬁned. Thus
⟨Ax, y⟩= ⟨x, (A + B)∗y −By⟩.
Hence y ∈DA∗= DA and
Ay = A∗y = (A + B)∗y −By.
Hence y ∈DA+B = DA.
Let A be the closure of A. For the second part, it suﬃces to show that the closure of A+B equals A+B.
But if x ∈DA there is a sequence xn ∈DA such that xn →x, and Axn →Ax. Then Bxn →Bx as B is
bounded so x belongs to the domain of the closure of A + B.
■
In general, the sum of two self-adjoint operators need not be self-adjoint. (See Nelson [1959] and Chernoﬀ
[1974] for this and related examples.)
7.4.20 Proposition.
Let A be a symmetric operator. If the range of A is all of H then A is self-adjoint.
Proof.
We ﬁrst observe that A is one-to-one. Indeed let Ax = 0. Then for any y ∈DA,
0 = ⟨Ax, y⟩= ⟨x, Ay⟩.
But A is onto and so x = 0. Thus A admits an everywhere deﬁned inverse A−1, which is therefore self-adjoint.
Hence A is self-adjoint (we proved earlier than the inverse of a self-adjoint operator is self-adjoint).
■
We shall use these results to prove a theorem that typiﬁes the kind of techniques one uses.

454
7. Integration on Manifolds
7.4.21 Proposition.
Let A be a symmetric operator on H and suppose A ≤0; that is ⟨Ax, x⟩≤0 for
x ∈DA. Suppose I −A has dense range. Then A is essentially self-adjoint.
Proof.
Note that
⟨(I −A)u, u⟩= ⟨u, u⟩−⟨Au, u⟩≥∥u∥2
and so by the Schwarz inequality we have
∥(I −A)u∥≥∥u∥.
It follows that the closure of I −A which equals I −A has closed range, which by hypothesis must be all of
H. By Proposition 7.4.19 I −A is self-djoint, so by Proposition 7.4.20 A is self-adjoint.
■
7.4.22 Corollary.
If A is self-adjoint and A ≤0, then for any λ > 0, λ −A is onto, (λ −A)−1 exists and
∥(λ −A)−1∥≤1
λ.
(7.4.3)
Proof.
As before, we have
⟨(λ −A)u, u⟩≥λ∥u∥2,
which yields
∥(λ −A)u∥≥λ∥u∥.
As A is closed, this implies that the range of λ−A is closed. If we can show it is dense, the result will follow.
Suppose y is orthogonal to the range
⟨(λ −A)u, y⟩= 0
for all u ∈DA.
This means that (λ −A)∗y = 0, or since A is self-adjoint, y ∈DA. Making the choice u = y gives
0 = ⟨(λ −A)y, y⟩≥λ∥y∥2,
so y = 0.
■
Note that an operator A has dense range iﬀA∗is one-to-one; that is, A∗w = 0 implies w = 0.
For a given symmetric operator A, we considered the general problem of self-adjoint extensions of A
and classiﬁed these in terms of the defect spaces. Now, under diﬀerent hypotheses, we construct a special
self-adjoint extension (even though A need not be essentially self-adjoint). This result is useful in many
applications, including quantum mechanics.
A symmetric operator A on H is called lower semi-bounded if there is a constant c ∈R such that
⟨Ax, x⟩≥c∥x∥2 for all x ∈DA. Upper semi-bounded is deﬁned similarly. If A is either upper or lower
semi-bounded then A is called semi-bounded. Observe that if A is positive or negative then A is semi-
bounded.
As an example, let A = −∇2+V where ∇2 is the Laplacian and let V be a real valued continuous function
and bounded below, say V (x) ≥α. Let H = L2(Rn, C) and DA the C∞functions with compact support.
Then −∇2 is positive, so
⟨Af, f⟩= ⟨−∇2f, f⟩+ ⟨V f, f⟩≥α⟨f, f⟩,
and thus A is semi-bounded.
We already know that this operator is real so has self-adjoint extensions by von Neumann’s theorem.
However, the self-adjoint extension constructed below (called the Friedrichs extension) is “natural.”
Thus the actual construction is as important as the statement.

7.4 Induced Flows on Function Spaces and Ergodicity
455
7.4.23 Theorem.
A semi-bounded symmetric (densely deﬁned) operator admits a self-adjoint extension.
Proof.
After multiplying by −1 if necessary and replacing A by A+(1−α)I we can suppose ⟨Ax, x⟩≥∥x∥2.
Consider the inner product on DA given by ⟨⟨x, y⟩⟩= ⟨Ax, y⟩. (Using symmetry of A and the preceding
inequality one easily checks that this is an inner product.)
Let H1 be the completion of DA in this inner product. Since the H1-norm is stronger than the H-norm,
we have H1 ⊂H (i.e., the injection DA ⊂H extends uniquely to the completion).
Now let H−1 be the dual of H1. We have an injection of H into H−1 deﬁned as follows: if y is ﬁxed and
x →⟨x, y⟩is a linear functional on H, it is also continuous on H1 since
|⟨x, y⟩| ≤∥x∥∥y∥≤|||x||| ||y||,
where ||| · ||| is the norm of H1. Thus H1 ⊂H ⊂H−1.
Now the inner product on H1 deﬁnes an isomorphism B : H1 →H−1. Let C be the operator with domain
DC = { x ∈H1 | B(x) ∈H }, and Cx = Bx for x ∈DC. Thus C is an extension of A. This will be the
extension we sought. We shall prove that C is self-adjoint. By deﬁnition, C is surjective; in fact C : DC →H
is a linear isomorphism. Thus by Proposition 7.4.20 it suﬃces to show that C is symmetric. Indeed for
x, y ∈DC we have, by deﬁnition,
⟨Cx, y⟩= ⟨⟨x, y⟩⟩= ⟨⟨y, x⟩⟩= ⟨Cy, x⟩= ⟨x, Cy⟩.
■
The self-adjoint extension C can be alternatively described as follows. Let H1 be as before and let C be the
restriction of A∗to DA∗∩H1. We leave the veriﬁcation as an exercise.
Supplement 7.4B
Stone’s Theorem3
Here we give a self-contained proof of Stone’s theorem for unbounded self-adjoint operators A on a complex
Hilbert space H. This guarantees that the one-parameter group eitA of unitary operators exists. In fact,
there is a one-to-one correspondence between self-adjoint operators and continuous one-parameter unitary
groups. A continuous one-parameter unitary group is a homomorphism t →Ut from R to the group
of unitary operators on H, such that for each x ∈H the map t →Utx is continuous. The inﬁnitesimal
generator A of Ut is deﬁned by
iAx = d
dtUtx

t=0
= lim
h→0
Uh(x) −x
h
,
its domain D consisting of those x for which the indicated limit exists. We insert the factor i for convenience;
iA is often called the generator.
7.4.24 Theorem (Stone’s Theorem).
Let Ut be a continuous one-parameter unitary group. Then the gen-
erator A of Ut is self-adjoint. (In particular, by Supplement 7.4A, it is closed and densely deﬁned.) Con-
versely, let A be a given self-adjoint operator. Then there exists a unique one-parameter unitary group Ut
whose generator is A.
3This supplement was written in collaboration with P. Chernoﬀ.

456
7. Integration on Manifolds
Before we begin the proof, let us note that if A is a bounded self-adjoint operator then one can form the
series
Ut = eitA = I + itA + 1
2!(itA)2 + 1
3!(itA)3 + . . .
which converges in the operator norm. It is straightforward to verify that Ut is a continuous one-parameter
unitary group and that A is its generator. Because of this, one often writes eitA for the unitary group whose
generator is A even if A is unbounded. (In the context of the so-called “operational calculus” for self-adjoint
operators, one can show that eitA really is the result of applying the function eit(·) to A; however, we shall
not go into these matters here.)
Proof of Stone’s Theorem (ﬁrst half).
Let Ut be a given continuous unitary group. In a series of lem-
mas, we shall show that the generator A of Ut is self-adjoint.
■
7.4.25 Lemma.
The domain D of A is invariant under each Ut, and moreover AUtx = UtAx for each
x ∈D.
Proof.
Suppose x ∈D. Then
1
h(UhUtx −Utx) = Ut
 1
h(Uhx −h)

.
which converges to Ut(iAx) = iUtAx as h →0. The lemma follows by the deﬁnition of A.
■
7.4.26 Corollary.
The operator A is closed.
Proof.
If x ∈D then, by Lemma 7.4.25
d
dtUtx = iAUtx = iUtAx.
Hence,
Utx = x + i
 t
0
UτAx dτ.
(7.4.4)
Now suppose that xn ∈D, xn →x, and Axn →y. Then we have, by equation (7.4.4),
Utx = lim
n→∞Utxn = lim
n→∞
&
xn + i
 t
0
UτAxndτ
'
.
Thus,
Utx = x + i
 t
0
Uτy dτ.
(7.4.5)
(Here we have taken the limit under the integral sign because the convergence is uniform; indeed
∥UτAxn −Uτy∥= ∥Axn −y∥→0
independent of τ ∈[0, t].) Then, by equation (7.4.5),
d
dtUtx

t=0
= iy.
Hence x ∈D and y = Ax. Thus A is closed.
■

7.4 Induced Flows on Function Spaces and Ergodicity
457
7.4.27 Lemma.
A is densely deﬁned.
Proof.
Let x ∈H, and let ϕ be a C∞function with compact support on R. Deﬁne
xϕ =
 ∞
−∞
ϕ(t)Utx dt.
We shall show that xϕ is in D, and that x = limn→∞xϕn for a suitable sequence {ϕn}. To take the latter
point ﬁrst, let ϕn(t) be nonnegative, zero outside the interval [0, 1/n], and such that ϕn(t) has integral 1. By
continuity, if ϵ > 0 is given, one can ﬁnd N so large that ∥Utx −x∥< ϵ if |t| < 1/N. Suppose that n > N.
Then
∥xϕn −x∥=


 ∞
−∞
ϕn(t)(Utx −x)dt

 =


 1/n
0
ϕn(t)(Utx −x)dt


≤
 1/n
0
ϕn(t)∥Utx −x∥dt ≤ϵ
 1/n
0
ϕn(t)dt = ϵ.
Finally, we show that xϕ ∈D; moreover, we shall show that iAxϕ = −xϕ. Indeed,
−
 t
0
Uτxϕ′dτ =
 t
0
Uτdτ
 ∞
−∞
ϕ′(σ)Uσdσ
= −
 ∞
−∞
dσ · ϕ′(σ) ·
 t
0
Uτ+σx dτ
= −
 ∞
−∞
dσ · ϕ′(σ) ·
 σ+t
σ
Uτx dτ.
Integrating by parts and using the fact that ϕ has compact support, we get
−
 t
0
Uτxϕ′dτ =
 ∞
−∞
(Uσ+tx −Uσx)ϕ(σ)dσ = (Ut −I)
 ∞
−∞
Uσxϕ(σ)dσ.
That is,
−
 t
0
Uτxϕ′dτ = Utxϕ −xϕ.
from which the assertion follows.
■
Thus far we have made no signiﬁcant use of the unitarity of Ut. We shall now do so.
7.4.28 Lemma.
A is symmetric.
Proof.
Take x, y ∈D. Then we have
⟨Ax, y⟩= 1
i
d
dt⟨Utx, y⟩

t=0
= 1
i
d
dt⟨x, U ∗
t y⟩

t=0
= 1
i
d
dt⟨x, U−ty⟩

t=0
= −1
i
d
dt⟨x, Uty⟩

t=0
= −1
i ⟨x, iAy⟩= ⟨x, Ay⟩.
■

458
7. Integration on Manifolds
To complete the proof that A is self-adjoint, let y ∈D∗and x ∈D. By Lemmas 7.4.25, and 7.4.28,
⟨Uty, x⟩= ⟨y, U−tx⟩= ⟨y, x⟩+
(
y, i
 −t
0
UτAx dτ
)
= ⟨y, x⟩−i
 −t
0
⟨y, UτAx⟩dτ = ⟨y, x⟩−i
 −t
0
⟨y, AUτx⟩dτ
= ⟨y, x⟩−i
 −t
0
⟨U−τA∗y, x⟩dτ = ⟨y, x⟩+ i
 −t
0
⟨UτA∗y, x⟩dτ
=
(
y + i
 t
0
UτA∗y dτ, x
)
.
Because D is dense, it follows that
Uty = y + i
 t
0
UτA∗y dτ.
Hence, diﬀerentiating, we see that y ∈D and A∗y = Ay. Thus A = A∗.
Proof of Stone’s theorem (second half).
We are now given a self-adjoint operator A. We shall construct
a continuous unitary group Ut whose generator is A.
7.4.29 Lemma.
If λ > 0, then I + λA2 : DA2 →H is bijective,
(I + λA2)−1 : H →DA2
is bounded by 1, and DA2, the domain of A2, is dense.
Proof.
If A is self-adjoint, so is
√
λA. It is therefore enough to establish the lemma for λ = 1. First we
establish surjectivity.
By Proposition 7.4.14 and Lemma 7.4.26, if z ∈H is given there exists a unique solution (x, y) to the
equations
x −Ay = 0,
Ax + y = z.
From the ﬁrst equation, x = Ay. The second equation then yields A2y + y = z, so I + A2 is surjective.
For x ∈DA2, note that
⟨(I + A2)x, x⟩≥∥x∥2,
so
∥(I + A2)x∥≥∥x∥.
Thus I + A2 is one-to-one and ∥(I + A2)−1∥≤1. Now suppose that u is orthogonal to DA2. We can ﬁnd a
v such that u = v + A2v. Then
0 = ⟨u, v⟩= ⟨v + A2v, v⟩= ∥v∥2 + ∥Av∥2,
whence v = 0 and therefore u = 0. Consequently DA2 is dense in H.
■
For λ > 0, deﬁne an operator Aλ by Aλ = A(I + λA2)−1. Note that Aλ is deﬁned on all of H because if
x ∈H then (I + λA2)−1x ∈DA2 ⊂D, so A(I + λA2)−1x makes sense.
7.4.30 Lemma.
Aλ is a bounded self-adjoint operator. Also Aλ and Aµ commute for all λ, µ > 0.

7.4 Induced Flows on Function Spaces and Ergodicity
459
Proof.
Pick x ∈H. Then by Lemma 7.4.29
λ∥Aλx∥2 = ⟨λA(I + λA2)−1x, A(I + λA2)−1x⟩
= ⟨λA2(I + λA2)−1x, (I + λA2)−1x⟩
≤⟨(I + λA2)(I + λA2)−1x, (I + λA2)−1x⟩
≤∥(I + λA2)−1x∥2
≤∥x∥2,
so ∥Aλ∥≤1/
√
λ, and thus Aλ is bounded.
We now show that Aλ is self-adjoint. First we shall show that if x ∈D, then
Aλx = (I + λA2)−1Ax.
Indeed, if x ∈D we have Aλx ∈DA2 by Lemma 7.4.29, so
(I + λA2)Aλx = (I + λA2)A(I + λA2)−1x
= A(I + λA2)(I + λA2)−1x
= Ax.
Now suppose x ∈D and y is arbitrary. Then
⟨Aλx, y⟩= ⟨(I + λA2)−1Ax, y⟩
= ⟨(I + λA2)−1Ax, (I + λA2)(I + λA2)−1y⟩
= ⟨Ax, (I + λA2)−1y⟩= ⟨x, Aλy⟩.
Because D is dense and Aλ bounded, this relation must hold for all x ∈H. Hence Aλ is self-adjoint. The
proof that AλAµ = AµAλ is a calculation that we leave to the reader.
■
Since Aλ is bounded, we can form the continuous one-parameter unitary groups U λ
t = eitAλ, λ > 0 using
power series or the results of §4.1. Since Aλ and Aµ commute, it follows that U λ
s and U µ
t commute for every
s and t.
7.4.31 Lemma.
If x ∈D then limλ→0 Aλx = Ax.
Proof.
If x ∈D we have
Aλx −Ax = (I + λA2)−1Ax −Ax = −λA2(I + λA2)−1Ax.
It is therefore enough to show that for every y ∈H, λA2(I + λA2)−1y →0. From the inequality
∥(I + λA2)y∥2 ≥∥λA2y∥2,
valid for λ ≥0, we see that ∥λA2(I + λA2)−1∥≤1. Thus it is even enough to show the preceding equality
for all y in some dense subspace of H. Suppose y ∈DA2, which is dense by Lemma 7.4.29. Then
∥λA2(I + λA2)−1y∥= λ∥(I + λA2)−1A2y∥≤λ∥A2y∥,
which indeed goes to zero with λ.
■
7.4.32 Lemma.
For each x ∈H, limλ→0 U λ
t x exists. If we call the limit Utx, then {Ut} is a continuous
one-parameter unitary group.

460
7. Integration on Manifolds
Proof.
We have
U λ
t x −U µ
t x =
 t
0
d
dτ (U λ
τ U µ
t−τ)x dτ
=
 t
0
*
iAλU λ
τ U µ
t−τx −U λ
τ iAuU µ
t−τx
+
dτ
= i
 t
0
U λ
τ U µ
t−τ(Aλx −Aµx)dτ,
whence
∥U λ
t x −U µ
t x∥≤|t| ∥Aλx −Aµx∥.
(7.4.6)
Now suppose that x ∈D. Then by Lemma 7.4.31, Aλx →Ax, so that
∥Aλx −Aµx∥→0
as
λ, µ →0.
Because of equation (7.4.6) it follows that {U λ
t ξ}λ>0 is uniformly Cauchy as λ →0 on every compact t-
interval. It follows that limλ→0 U λ
t x = Utx exists and is a continuous function of t. Moreover, since D is
dense and all of the U λ
t have norm 1, an easy approximation argument shows that the preceding conclusion
holds even if x /∈D.
It is obvious that each Ut is a linear operator. Furthermore,
⟨Utx, Uty⟩= lim
λ→0⟨U λ
t x, U λ
t y⟩= lim
λ→0⟨x, y⟩= ⟨x, y⟩
so Ut is isometric. Trivially, U0 = I. Finally,
⟨UsUt, x, y⟩= lim
λ→0⟨U λ
s Ut, x, y⟩= lim
λ→0⟨Utx, U λ
−sy⟩
= lim
λ→0⟨U λ
t x, U λ
−sy⟩= lim
λ→0⟨U λ
s+tx, y⟩= ⟨Us+tx, y⟩,
so UsUt = Us+t.
Thus, Us has an inverse, namely U−s, and so Us is unitary.
■
7.4.33 Lemma.
If x ∈D, then
lim
t→0
Utx −x
t
= iAx.
Proof.
We have
U λ
t x −x = i
 t
0
U λ
τ Aλx dτ.
(7.4.7)
Now
U λ
τ Aλx −UτAx = U λ
τ (Aλx −Ax) + U λ
τ Ax −UτAx →0
uniformly for τ ∈[0, t] as λ →0. Thus letting λ →0 in equation (??), we get
Utx −x = i
 t
0
UτAx dτ
(7.4.8)
for all x ∈D. The lemma follows directly from equation (7.4.8).
■

7.4 Induced Flows on Function Spaces and Ergodicity
461
7.4.34 Lemma.
If
lim
t→0
Utx −x
t
= iw
exists, then x ∈D.
Proof.
It suﬃces to show that x ∈D∗, the domain of A∗, since D = D∗. Let y ∈D∗. Then by Lemma
7.4.33,
⟨x, iAy⟩= lim
t→0
(
x, U−ty −y
−t
)
= −lim
t→0
(Utx −x
t
, y
)
= −⟨iw, y⟩.
Therefore, ⟨x, Ay⟩= ⟨w, y⟩. Thus x ∈D∗and so as A is self-adjoint, x ∈D.
■
Let us ﬁnally prove uniqueness. Let c(t) be a diﬀerentiable curve in H such that c(t) ∈D and c′(t) =
iA(c(t)). We claim that c(t) = Utc(0). Indeed consider, h(t) = U−tc(t). Then
∥h(t + τ) −h(t)∥= ∥U−t−τc(t + τ) −U−t−τUtc(t)∥
= ∥c(t + τ) −Uτc(t)∥
= ∥(c(t + τ) −c(t)) −(Uτc(t) −c(t))∥.
Hence
h(t + τ) −h(t)
τ
→0
as τ →0, so h is constant. But h(t) = h(0) means c(t) = Utc(0).
■
From the proof of Stone’s theorem, one can deduce the following Laplace transform expression for the
resolvent, which we give for the sake of completeness.
7.4.35 Corollary.
Let Re λ > 0. Then for all x ∈H,
(λ −iA)−1x =
 ∞
0
e−λtUtxdt.
Proof.
The foregoing is formally an identity if one thinks of Ut as eitA. Indeed, if A is bounded then it
follows just by manipulation of the power series: One has e−λteitA = e−t(λ−iA), as one can see by expanding
both sides. Next note that
 R
0
e−t(λ−iA)xdt = (λ −iA)−1 ,
x −e−R(λ−iA)x
-
,
as is seen by integrating the series term by term. Letting R →∞, one gets the result.
Now for arbitrary A we know that Utx = limµ→0 U µ
t x, uniformly on bounded intervals. It follows that
 ∞
0
e−λtUtx dt = lim
µ→0
 ∞
0
e−λtU µ
t x dt = lim
µ→0(λ −iAµ)−1x.
It remains to show that this limit is (λ −iA)−1x. Now
(λ −iA)−1x −(λ −iAµ)−1x = (λ −iAµ)−1[(λ −iAµ)(λ −iA)−1x −x].

462
7. Integration on Manifolds
But (λ −iA)−1x ∈D (see Proposition 7.4.12), so by Lemma 7.4.31,
(λ −iAµ)(λ −iA)−1x →(λ −iA)(λ −iA)−1x = x as µ →0.
Because ∥(λ −iAµ)−1∥≤| Re λ|−1 it follows that
∥(λ −iA)−1x −(λ −iAµ)−1x∥→0.
■
In closing, we mention that many of the results proved have generalizations to continuous one-parameter
groups or semi-groups of linear operators in Banach spaces (or on locally convex spaces). The central result,
due to Hille and Yosida, characterizes generators of semi-groups. Our proof of Stone’s theorem is based on
methods that can be used in the more general context. Expositions of this more general context are found
in, for example, Kato [1976] and Marsden and Hughes [1983, Chapter 6].
Exercises
(Exercises 7.4-1–7.4-3 form a unit.)
⋄7.4-1.
Given a manifold M, show that the space of half-densities on M carries a natural inner product.
Let its completion be denoted H(M), which is called the intrinsic Hilbert space of M. If µ is a density
on M, deﬁne a bijection of L2(M, µ) with H(M) by f →f√µ. Show that it is an isometry.
⋄7.4-2.
If Ft is the (local) ﬂow of a smooth vector ﬁeld X, show that Ft induces a ﬂow of isometries on
H(M). (Make no assumption that X is divergence-free.) Show that the generator iX′ = £X of the induced
ﬂow on H(M) is
iX′(f√µ) =

X[f] + 1
2(divµ X)f
 √µ
and check directly that X′ is a symmetric operator on the space of half-densities with compact support.
⋄7.4-3.
Prove that Ft is complete a.e. if and only if X′ is essentially self-adjoint.
⋄7.4-4.
Consider the ﬂow in R2 associated with a reﬂecting particle: for t > 0, set
Ft(q, p) = q + tp
if q > 0, q + tp > 0
and
Ft(q, p) = −q −tp
if q > 0, q + tp < 0
and set
Ft(−q, p) = −Ft(q, p)
and
F−t = F −1
t
.
What is the generator of the induced unitary ﬂow? Is it essentially self-adjoint on the C∞functions with
compact support away from the line q = 0?
⋄7.4-5.
Let M be an oriented Riemannian manifold and L2(k(M)) the space of L2 k-forms with inner
product ⟨α, β⟩=

α∧∗β. If X is a Killing ﬁeld on M with a complete ﬂow Ft, show that i£X is a self-adjoint
operator on L2(k(M)).

7.5 Introduction to Hodge–deRham Theory
463
7.5
Introduction to Hodge–deRham Theory
Recall that a k-form α is called closed if dα = 0 and exact if α = dβ for some k −1 form β. Since d2 = 0,
every exact form is closed, but the converse need not hold. Let
Hk(M) =
ker dk
range dk−1 ,
(where dk denotes the exterior derivative on k-forms), and call it the k-th deRham cohomology group of
M. (The group structure here is that if a real vector space.) The celebrated deRham theorem states that
for a ﬁnite-dimensional compact manifold, these groups are isomorphic to the singular cohomology groups
(with real coeﬃcients) deﬁned in algebraic topology; the isomorphism is given by integration. For proofs,
see Singer and Thorpe [1976] or Warner [1983]. The original books of Hodge [1952] and deRham [1955]
(translated as deRham [1984]) remain excellent sources of information as well. A special but important case
of the deRham theorem is proved in Supplement 7.5B.
The scope of this section is to informally discuss the Hodge decomposition theory based on diﬀerential
operators and to explain how it is related to the deRham cohomology groups. In addition, some topological
applications of the theory are given, such as the Brouwer ﬁxed-point theorem, and the degree of a map
is deﬁned. In the sequel, M will denote a compact oriented Riemannian manifold, and δ the codiﬀerential
operator. At ﬁrst we assume M has no boundary. Later we will discuss the case in which M has a boundary.
7.5.1 Deﬁnition.
The Laplace–deRham operator
∆: Ωk(M) →Ωk(M)
is deﬁned by
∆= dδ + δd.
A form for which ∆α = 0 is called harmonic. Let
Hk =

α ∈Ωk(M) | ∆α = 0

denote the vector space of harmonic k-forms.
If f ∈H0(M), then
∆f = dδf + δdf = δdf = −div grad f,
so ∆f = −∇2f, where ∇2 is the Laplace–Beltrami operator. This minus sign can be a source of confusion
and one has to be careful.
Recall that the L2-inner product in Ωk(M) is deﬁned by
⟨α, β⟩=

M
α ∧∗β
and that d and δ are adjoints with respect to this inner product. That is, ⟨dα, β⟩= ⟨α, δβ⟩for all α ∈
Ωk−1(M), β ∈Ωk(M). Thus it follows that for α, β ∈Ωk(M), we have
⟨∆α, β⟩= ⟨dδα, β⟩+ ⟨δdα, β⟩= ⟨δα, δβ⟩+ ⟨dα, dβ⟩
= ⟨α, dδβ⟩+ ⟨α, δdβ⟩= ⟨α, ∆β⟩,
and thus ∆is symmetric. This computation also shows that ⟨∆α, α⟩≥0 for all α ∈Ωk(M).
7.5.2 Proposition.
Let M be a compact boundaryless oriented Riemannian manifold and α ∈Ωk(M).
Then ∆α = 0 iﬀδα = 0 and dα = 0.

464
7. Integration on Manifolds
Proof.
It is obvious from the expression
∆α = dδα + δdα
that if dα = 0 and δα = 0, then ∆α = 0. Conversely, the previous computation shows that
0 = ⟨∆α, α⟩= ⟨dα, dα⟩+ ⟨δα, δα⟩,
so the result follows.
■
7.5.3 Theorem (The Hodge Decomposition Theorem).
Let M be a compact, boundaryless, oriented, Rie-
mannian manifold and let ω ∈Ωk(M). Then there is an α ∈Ωk−1(M), β ∈Ωk+1(M), and γ ∈Ωk(M) such
that
ω = dα + δβ + γ,
where ∆(γ) = 0. Furthermore, dα, δβ, and γ are mutually L2 orthogonal and so are uniquely determined.
That is,
Ωk(M) = dΩk−1(M) ⊕δΩk+1(M) ⊕Hk.
(7.5.1)
We can easily check that the spaces in the Hodge decomposition are orthogonal. For example, dΩk−1(M)
and δΩk+1(M) are orthogonal since
⟨dα, δβ⟩= ⟨ddα, β⟩= 0,
δ being the adjoint of d and d2 = 0.
The basic idea behind the proof of the Hodge theorem can be abstracted as follows. We consider a linear
operator T on a Hilbert space E and assume that T 2 = 0. In our case T = d and E is the space of L2 forms.
(We ignore the fact that T is only densely deﬁned.) Let T ∗be the adjoint of T. Let
H = { x ∈E | Tx = 0 and T ∗x = 0 } .
We assert that
E = cl(range T) ⊕cl(range T ∗) ⊕H
(7.5.2)
which, apart from technical points on understanding the closures, is the essential content of the Hodge
decomposition. To prove equation (7.5.2), note that the ranges of T and T ∗are orthogonal because
⟨Tx, T ∗y⟩= ⟨Tx2, y⟩= 0.
If C denotes the orthogonal complement of cl(range T) ⊕cl(range T ∗), then H ⊂C. If x ∈C then ⟨Ty, x⟩= 0
for all y implies T ∗x = 0. Similarly, Tx = 0, so C ⊂H and hence C = H.
The complete proof of the Hodge theorem requires elliptic estimates and may be found in Morrey [1966].
For more elementary expositions, consult Flanders [1963] and Warner [1983].
7.5.4 Corollary.
Let Hk denote the space of harmonic k-forms. Then the vector spaces Hk and Hk (=
ker dk/ range dk−1) are isomorphic.
Proof.
Map Hk →ker dk by inclusion and then to Hk by projection. We need to show that this map is
an isomorphism. Suppose γ ∈Hk and [γ] = 0 where [γ] ∈Hk is the class of γ. But [γ] = 0 means that γ is
exact; γ = dβ. But since δγ = 0, γ is orthogonal to dβ; that is, γ is orthogonal to itself, so γ = 0. Thus the
map γ →[γ] is one-to-one. Next let [ω] ∈Hk. We can, by the Hodge theorem, decompose ω = dα + δβ + γ,
where γ ∈Hk. Since dω = 0, dδβ = 0, so 0 = ⟨β, dδβ⟩= ⟨δβ, δβ⟩, so δβ = 0. Thus, ω = dα + γ and hence
[ω] = [γ], so the map γ →[γ] is onto.
■

7.5 Introduction to Hodge–deRham Theory
465
The space Hk ∼= Hk is ﬁnite dimensional. Again the proof relies on elliptic theory (the kernel of an elliptic
operator on a compact manifold is ﬁnite dimensional).
The Hodge theorem plays a fundamental role in incompressible hydrodynamics, as we shall see in §8.2.
It allows the introduction of the pressure for a given ﬂuid state. It has applications to many other areas
of mathematical physics and engineering as well; see for example, Fischer and Marsden [1979] and Wyatt,
Chua, and Oster [1978].
Below we shall state a generalization of the Hodge theorem for some decomposition theorems for general
elliptic operators (rather than the special case of the Laplacian). However, we ﬁrst pause to discuss what
happens if a boundary is present. This theory was worked out by Kodaira [1949], Duﬀand Spencer [1952],
and Morrey [1966, Chapter 7]. Diﬀerentiability across the boundary is very delicate, but important. Some
of the best results in this regard are due to Morrey.
Note that d and δ may not be adjoints in this case, because boundary terms arise when we integrate by
parts (see Exercise 7.5-5). Hence we must impose certain boundary conditions. Let α ∈Ωk(M). Then α is
called parallel or tangent to ∂M if the normal part, deﬁned by
nα = i∗(∗α)
is zero where i : ∂M →M is the inclusion map. Analogously, α is perpendicular or normal to ∂M if its
tangent part, deﬁned by
tα = i∗(α)
is zero.
Let X be a vector ﬁeld on M. Using the metric, we know when X is tangent or perpendicular to ∂M.
Now X corresponds to the one–form X♭and also to the (n−1)-form iXµ = ∗X♭(µ denotes the Riemannian
volume form). One checks that X is tangent to ∂M if and only if X♭is tangent to ∂M iﬀiXµ is normal to
∂M. Similarly X is normal to ∂M iﬀiXµ is tangent to ∂M. Set
Ωk
t (M) = { α ∈Ωk(M) | α is tangent to ∂M },
Ωk
n(M) = { α ∈Ωk(M) | α is perpendicular to ∂M }, and
Hk(M) = { α ∈Ωk(M) | dα = 0, δα = 0 }.
The condition that dα = 0 and δα = 0 is, in general, stronger than ∆α = 0 when M has a boundary. One
calls elements of Hk harmonic ﬁelds, after Kodaira [1949].
7.5.5 Theorem (Hodge Theorem for Manifolds with Boundary).
Let M be a compact oriented Rieman-
nian manifold with boundary. The following decomposition holds:
Ωk(M) = dΩk−1
t
(M) ⊕δΩk+1
n
(M) ⊕Hk.
One can easily check from the following formula (obtained from Stokes’ theorem):
⟨dα, β⟩= ⟨α, δβ⟩+

∂M
α ∧∗β
(see Exercise 7.5-5), that the summands in this decomposition are orthogonal.
Two other closely related decompositions of interest are
(i) Ωk(M) = dΩk−1(M) ⊕Dk
t where Dk
t = { α ∈Ωk
t (M) | δα = 0 } are the co-closed k-forms tangent
to ∂M and, dually
(ii) Ωk(M) = δ(Ωk+1(M)) ⊕Ck
n where Ck
n are the closed k-forms normal to ∂M.

466
7. Integration on Manifolds
To put the Hodge theorem in a general context, we give a brief discussion of diﬀerential operators and
their symbols. (See Palais [1965a], Wells [1980], and Marsden and Hughes [1983] for more information and
additional details on proofs.) Let E and F be vector bundles of M and let C∞(E) denote the C∞sections of
E. Assume M is Riemannian and that the ﬁbers of E and F have inner products. A kth order diﬀerential
operator is a linear map D : C∞(E) →C∞(F) such that, if f ∈C∞(E) and f vanishes to kth order
at x ∈M, then D(f)(x) = 0. It is not diﬃcult to see that vanishing to kth order makes intrinsic sense
independent of charts and that D is a kth order diﬀerential operator iﬀin local charts D has the form
D(f) =

0≤|j|≤k
αj
∂|j|f
∂xj1 . . . ∂xjs ,
where j = (j1, . . . , js) is a multi-index and αj is a C∞matrix-valued function of x (the matrix corresponding
to linear maps of E to F).
The operator D has an adjoint operator D∗given in charts (with the standard Euclidean inner product
on ﬁbers) by
D∗(h) =

0≤|j|≤k
(−1)|j| 1
ρ
∂|j|
∂xj1 . . . ∂xjs (ραt
jh),
where ρ dx1 ∧· · · ∧dxn is the volume element on M and αt
j is the transpose of aj. The crucial property of
D∗is
⟨g, D∗h⟩= ⟨D g, h⟩,
where ⟨, ⟩denotes the L2 inner product, g ∈C∞
c (E), and h ∈C∞
c (F). That is, g and h are C∞sections
with compact support. For example, we have the diﬀerential operators
d : C∞(Λk) →C∞(Λk+1)
(ﬁrst order)
δ : C∞(Λk) →C∞(Λk−1)
(ﬁrst order)
∆: C∞(Λk) →C∞(Λk)
(second order)
where d∗= δ, δ∗= d, and ∆∗= ∆. The symbol of D assigns to each ξ ∈T ∗
xM, a linear map σ(ξ) : Ex →Fx
deﬁned by
σ(ξ)(e) = D
 1
k!(g −g(x))kf

(x),
where g ∈C∞(M, R), dg(x) = ξ, and f ∈C∞(E), f(x) = e. By writing this out in coordinates one sees
that σ(ξ) so deﬁned is independent of g and f and is a homogeneous polynomial expression in ξ of degree
k obtained by substituting each ξj in place of ∂/∂xj in the highest order terms. For example, if
D(f) =

αij
∂2f
∂xi∂xj + (lower order terms),
then
σ(ξ) =

αijξiξj
(αij is for each i, j a map of Ex to Fx). For real-valued functions, the classical deﬁnition of an elliptic
operator is that the foregoing quadratic form be deﬁnite. This can be generalized as follows: D is called
elliptic if σ(ξ) is an isomorphism for each ξ = 0. To see that ∆: C∞(k) →C∞(k) is elliptic one uses
the following facts:
1. The symbol of d is σ(ξ) = ξ ∧.
2. The symbol of δ is σ(ξ) = iξ#.

7.5 Introduction to Hodge–deRham Theory
467
3. The symbol is multiplicative: σ(ξ)(D1 ◦D2) = σ(ξ)(D1) ◦σ(ξ)(D2).
From these, it follows by a straightforward calculation that the symbol of ∆is given by σ(ξ)α = ∥ξ∥2α, so
∆is elliptic. (Compute
ξ ∧(iξ#α) + iξ#(ξ ∧α)
applied to (v1, . . . , vk), noting that all but one term cancel.)
7.5.6 Theorem (Elliptic Splitting Theorem—Fredholm Alternative).
Let D be an elliptic operator as above.
Then
C∞(F) = D(C∞(E)) ⊕ker(D∗)
Indeed this holds if it is merely assumed that either D or D∗has injective symbol.
The proof of this leans on elliptic estimates that are not discussed here. As in the Hodge theorem, the
idea is that the L2 orthogonal complement of range D is ker(D)∗. This yields an L2 splitting and we get a
C∞splitting via elliptic estimates. The splitting in case D (resp., D∗) has injective symbol relies on the fact
that then D∗D (resp., D D∗) is elliptic.
For example, the equation D u = f is soluble iﬀf is orthogonal to ker(D∗). More speciﬁcally, ∆u = f is
soluble if f is orthogonal to the constants; that is,

fdµ = 0.
The Hodge theorem is derived from the elliptic splitting theorem as follows. Since ∆is elliptic and
symmetric
C∞(k(M)) = range(∆) ⊕ker(∆) = range(∆) ⊕H
Now write a k-form ω as
ω = ∆ρ + γ = dδρ + δdρ + γ,
so to get Theorem 7.5.3, we can choose α = δρ and β = dρ.
Supplement 7.5A
Introduction to Degree Theory
One of the purposes of degree theory is to provide algebraic measures of the number of solutions of nonlinear
equations. Its development rests on Stokes’ theorem. It beautifully links calculus on manifolds with ideas on
diﬀerential and algebraic topology.
All manifolds in this section are assumed to be ﬁnite dimensional, paracompact and Lindel¨of. We begin
with an extendability result.
7.5.7 Proposition.
Let V and N be orientable manifolds, dim(V ) = n+1 and dim(N) = n. If f : ∂V →N
is a smooth proper map that extends to a smooth map of V to N, then for every ω ∈Ωn(N) with compact
support,

∂V
f ∗ω = 0.
Proof.
Let F : V →N be a smooth extension of f. Then by Stokes’ theorem

∂V
f ∗ω =

∂V
F ∗ω =

V
dF ∗ω =

V
F ∗dω = 0.
since dω = 0.
■

468
7. Integration on Manifolds
This proposition will be applied to the case V = [0, 1] × M. For this purpose let us recall the product
orientation (see Exercise 6.5-14). If N and M are orientable manifolds (at most one of which has a boundary),
then N ×M is a manifold (with boundary), which is orientable in the following way. Let π1 : N ×M →N and
π2 : N × M →M be the canonical projections and [ω], [η] orientations on N and M respectively. Then the
orientation of N × M is deﬁned to be [π∗
1ω ∧π∗
1η]. Alternatively, if v1, . . . , vn ∈TxN and w1, . . . , wm ∈TyM
are positively oriented bases in the respective tangent spaces, then
(v1, 0), . . . , (vn, 0), (0, w1), . . . , (0, wm) ∈T(x,y)(N × M)
is deﬁned to be a positively oriented basis in their product. Thus, for [0, 1]×M, a natural orientation will be
given at every point (t, x) ∈[0, 1] × M by (1, 0), (0, v1), . . . , (0, vm), where v1, . . . , vm ∈TxM is a positively
oriented basis.
The boundary orientation of [0, 1] × M is determined according to Deﬁnition 7.2.7 Since
∂([0, 1] × M) = ({0} × M) ∪({1} × M),
every element of this union is oriented by the orientation of M. On the other hand, this union is oriented by
the boundary orientation of [0, 1] × M. Since the outward normal at (1, x) is (1, 0), we see that a positively
oriented basis of T(1,x)({1} × M) is given by
(0, v1), . . . , (0, vm)
for v1, . . . , vm ∈TxM,
a positively oriented basis. However, since the outward normal at (0, x) is (−1, 0), a positively oriented
basis of T(0,x)({0} × M) must consist of elements (0, w1), . . . , (0, wm) such that (−1, 0), (0, w1), . . . , (0, wm)
is positively oriented in [0, 1] × M, that is, deﬁnes the same orientation as
(1, 0), (0, v1), . . . , (0, vm),
for v1, . . . , vm ∈TxM
a positively oriented basis. This means that w1, . . . , wm ∈TxM is negatively oriented (see Figure 7.5.1).
Thus the oriented manifold ∂([0, 1] × M) is the disjoint union of {0} × M, where M is negatively oriented,
with f{1} × M, where M is positively oriented.
(1, 0)
,
v1
v2
(1, 0)
(0, v2)
(0 v1)
(-1, 0)
(0, v1)
(0, v1)
(0, v2)
Figure 7.5.1. Orientation on spheres
7.5.8 Deﬁnition.
Two smooth mappings f, g : M →N, are called Cr-homotopic if there is a Cr-map
F : [0, 1] × M →N such that
F(0, m) = f(m)
and
F(1, m) = g(m),
for all m ∈M. The homotopy F is called proper if F is a proper map; in this case f and g are said to be
properly Cr-homotopic maps.

7.5 Introduction to Hodge–deRham Theory
469
Note that if f and g are properly homotopic then necessarily f and g are proper as restrictions of a proper
map to the closed sets {0} × M and {1} × M, respectively.
7.5.9 Proposition.
Let M and N be orientable n-manifolds, with M boundaryless, let ω ∈Ωn(N) have
compact support, and suppose f, g : M →N are properly smooth homotopic maps. Then

M
f ∗ω =

M
g∗ω.
Proof.
There are two ways to do this.
Method 1.
Let F : [0, 1] × M →N be the proper homotopy between f and g. By the remarks preceding
Deﬁnition 7.5.8, we have

{0}×M
f ∗ω = −

M
f ∗ω
and

{1}×M
g∗ω =

M
g∗ω,
so that

M
g∗ω −

M
f ∗ω =

∂([0,1]×M)
(F|∂([0, 1] × M))∗ω = 0
by Proposition 7.5.7.
Method 2.
By Theorem 6.4.16, f ∗ω −g∗ω = dη for some η ∈Ωn−1(M) which has compact support since
the homotopy between f and g is a proper map. Then by Stokes’ theorem

M
f ∗ω −

M
g∗ω =

M
dη = 0.
■
Remark.
Properness of f and g does not suﬃce in the hypothesis of Proposition 7.5.9. For example, if
M = N = R, ω = adx with α ≥0 a C∞function satisfying supp(a) ⊂]−∞, 0[, then f(x) = x and g(x) = x2
are smoothly but not properly homotopic via F(t, x) = (1−t)x+tx2 and
 +∞
−∞f ∗ω > 0, while
 +∞
−∞g∗ω = 0
since g∗ω = 0.
♦
7.5.10 Theorem (Degree Theorem).
Let
M
and
N
be
oriented
n-mani-
folds, N connected, M boundaryless, and f : M →N a smooth proper map. Then there is an integer
deg(f) constant on the proper homotopy class of f, called the degree of f such that for any η ∈Ωn(N)
with compact support,

M
f ∗η = deg(f)

N
η.
(7.5.3)
If x ∈M is a regular point of f, let sign(Txf) be 1 or −1 depending on whether the isomorphism Txf :
TxM →Tf(x)N preserves or reverses orientation. The integer deg(f) is given by
deg(f) =

x∈f −1(y)
sign(Txf).
(7.5.4)
where y is an arbitrary regular value of f; if y /∈f(M) the right hand side is by convention equal to zero.

470
7. Integration on Manifolds
Proof.
By Proposition 7.5.9,

M f ∗η depends only on the proper homotropy class of f (and on η). By
Sard’s theorem, there is a regular value y of f. There are two possibilities: either Rf = N\f(M) or not. If
Rf = N\f(M), then Txf is never onto for all x ∈M. For any v1, . . . , vn ∈TxM,
(f ∗η)(x)(v1, . . . , vn) = η(f(x))(Txf(v1), . . . , Txf(vn)) = 0,
since Txf(v1), . . . , Txf(vn) are linearly dependent. Thus deg(f) exists and equals zero.
Assume Rf ∩f(M) ̸= ∅and let y ∈Rf ∩f(M). Since M and N have the same dimension, f −1(y) is a
zero-dimensional submanifold of M, hence discrete. Properness of f implies that f −1(y) is also compact, that
is, f −1(y) = {x1, . . . , xk+l}, where Txif is orientation preserving for i = 1, . . . , k and orientation reversing
for i = k + 1, . . . , k + l. The inverse function theorem implies that there are open neighborhoods Ui of xi
and V of y such that
f −1(V ) = U1 ∪· · · ∪Uk+l,
Ui ∩Uj = ∅
and if f|Ui : Ui →V is a diﬀeomorphism. If supp(η) ⊂V , then by the change of variables formula

M
f ∗η =
k+l

i=1

Ui
f ∗η = (k −l)

V
η = (k −l)

N
η
(7.5.5)
and so the theorem is proved for supp(η) ⊂V .
To deal with a general η proceed in the following way. For the open neighborhood V of η, consider the
collection of open subsets of N,
S = { ϕ(V ) | ϕ is a diﬀeomorphism properly homotopic to the identity }.
We shall prove that S covers N. Let n ∈N; we will show that there is a diﬀeomorphism ϕ properly homotopic
to the identity such that ϕ(n) = y. Let c : [0, 1] →N be a smooth curve with c(0) = n and c(1) = y. As
in Theorem 5.5.9, use a partition of unity to extend c′(t) to a smooth vector ﬁeld X ∈X(N) such that X
vanishes outside a compact neighborhood of c([0, 1]). The ﬂow Ft of X is complete by Corollary 4.1.20 and
is the identity outside the above compact neighborhood of c([0, 1]). Thus the restriction F : [0, 1] × N →N
is proper. Then ϕ = F1 is a proper diﬀeomorphism properly homotopic to the identity on N and ϕ(n) =
F1(n) = c(1) = y.
Since S covers N, choose a partition of unity {(Vα, hα)} subordinate to S and let ηα = hαη; thus,
supp(η) ⊂Vα ⊂ϕα(V ) for some ϕα. Since all ϕα are orientation preserving, the change of variables formula
and equation (7.5.5) give
(k −l)

N
η = (k −l)

α

Vα
ηα = (k −l)

α

V
ϕ∗
αηα =

α

M
f ∗ϕ∗
αηα.
Since ϕα is properly homotopic to the identity and f is proper, it follows that ϕα ◦f is properly homotopic
to f. Thus by Proposition 7.5.9,

M
(ϕα ◦f)∗ηα =

M
f ∗ηα
and therefore,
(k −l)

N
η =

α

M
f ∗ηα =

M
f ∗η.
■
Notice that by construction, if deg(f) ̸= 0, then f is onto, so f(x) = y is solvable for x given y.

7.5 Introduction to Hodge–deRham Theory
471
7.5.11 Corollary.
Let V and N be orientable manifolds with dim(V ) = n + 1, and dim(N) = n. If
f : ∂V →N extends to V , then deg(f) = 0.
This is a reformulation of Proposition 7.5.7. Similarly, Proposition 7.5.9 is equivalent to the following.
7.5.12 Corollary.
Let M, N be orientable n-manifolds, N connected, M boundaryless, and let f, g : M →
N be smooth properly homotopic maps. Then deg (f) = deg(g).
This corollary is useful in three important applications. The ﬁrst concerns vector ﬁelds on spheres.
7.5.13 Theorem (Hairy Ball Theorem).
Every vector ﬁeld on an even dimensional sphere has a critical
point.
Proof.
Let S2n be embedded as the unit sphere in R2n+1 and X ∈X(S2n). Then X deﬁnes a map
f : S2n →R2n+1 with components f(x) = (f 1(x), . . . , f 2n+1(x)) satisfying
f 1(x)x1 + · · · + f 2n+1(x)x2n+1 = 0.
Here f i(x) are the components of X in R2n+1.
Assume that X has no critical point. Replacing f by f/∥f∥, we can assume that f : S2n →S2n. The map
F : [0, 1] × S2n →S2n,
F(t, x) = (cos πt)x + (sin πt)f(x)
is a smooth proper homotopy between F(0, x) = x and F(1, x) = −x. That is, the identity Id is homotopic
to the antipodal map A : S2n →S2n, A(x) = −x. Thus by Corollary 7.5.12, deg A = 1. However, since the
Jacobian of A is −1 (this is the place where we use evenness of the dimension of the sphere), A is orientation
reversing and thus by the Degree theorem 7.5.10, deg(A) = −1, which is a contradiction.
■
The second application is to prove the existence of ﬁxed points for maps of the unit ball to itself.
7.5.14 Theorem (Brouwer’s Fixed-Point Theorem).
A smooth mapping of the closed unit ball of Rn into
itself has a ﬁxed point.
Proof.
Let B denote the closed unit ball in Rn and let Sn−1 = ∂B be its boundary, the unit sphere. If
f : B →B has no ﬁxed point, deﬁne g(x) ∈Sn−1 to be the intersection of the line starting at f(x) and going
through x with Sn−1. The map g : B →Sn−1 so deﬁned is smooth and for x ∈Sn−1, g(x) = x. If n = 1
this already gives a contradiction, since g must map B = [−1, 1] onto {−1, 1} = S0, which is disconnected.
For n ≥2, deﬁne a smooth proper homotopy F : [0, 1] × Sn−1 →Sn−1 by F(t, x) = g(tx). Thus F is a
homotopy between the constant map c : Sn−1 →Sn−1, c(x) = g(0) and the identity of Sn−1. But c∗ω = 0
for any ω ∈Ωn−1(Sn−1), so that by Theorem 7.5.10, deg c = 0. On the other hand, by Corollary 7.5.12,
deg(c) = 1, which is false.
■
The Brouwer ﬁxed point theorem is valid for continuous mappings and is proved in the following way. If f
has no ﬁxed points, then by compactness there exists a positive constant K > 0 such that ∥f(x) −x∥> K
for all x ∈B. Let ϵ < min(K, 2) and choose δ > 0 such that 2δ/(1 + δ) < ϵ; that is, δ < ϵ/(2 −ϵ).
By the Weierstrass approximation theorem (see, for example, Marsden and Hoﬀman [1993]) there exists a
polynomial mapping q : Rn →Rn such that ∥f(x) −q(x)∥< δ for all x ∈B. The image q(B) lies inside the
closed ball centered at 0 of radius 1 + δ, so that p ≡q/(1 + δ) : B →B and
∥f(x) −p(x)∥≤

f(x) −f(x)
1 + δ

 +


f(x)
1 + δ −q(x)
1 + δ

 ≤
2δ
1 + δ < ϵ
for all x ∈B. Since p is smooth by Theorem 7.5.14, it has a ﬁxed point, say x0 ∈B. Then
0 < K < ∥f(x0) −x0∥≤∥f(x0) −p(x0)∥+ ∥p(x0) −x0∥≤ϵ,
which contradicts the choice ϵ < K.

472
7. Integration on Manifolds
Brouwer’s ﬁxed point theorem is false in an open ball, for the open ball is diﬀeomorphic to Rn and
translation provides a counterexample.
The proof we have given is not “constructive.” For example, it is not clear how to base a numerical search
on this proof, nor is it obvious that the ﬁxed point we have found varies continuously with f. For these
aspects, see Chow, Mallet-Paret, and Yorke [1978].
A third application of Corollary 7.5.12 is a topological proof of the fundamental theorem of algebra.
7.5.15 Theorem (The Fundamental Theorem of Algebra).
Any polynomial p : C →C of degree n > 0
has a root.
Proof.
Assume without loss of generality that p(z) = zn + an−1zn−1 + · · · + a0, where ai ∈C, and regard
p as a smooth map from R2 to R2. If p has no root, then we can deﬁne the smooth map f(z) = p(z)/|p(z)|
whose restriction to S1 we denote by g : S1 →S1.
Let R > 0 and deﬁne for t ∈[0, 1] and z ∈S1,
pt(z) = (Rz)n + t
*
an−1(Rz)n−1 + · · · + a0
+
.
Since
pt
(z)
(Rz)n = 1 + t
	
an−1(Rz)−1 + · · · +
a0
(Rz)−n

and the coeﬃcient of t converges to zero as R →∞, we conclude that for suﬃciently large R, none of the
pt has zeros on S1. Thus,
F : [0, 1] × S1 →S1
deﬁned by
F(t, z) = pt(z)
|pt(z)|
is a smooth proper homotopy of dn(z) = zn with g(Rz), which in turn is properly homotopic to g(z).
On the other hand, G : [0, 1] × S1 →S1 deﬁned by G(t, z) = f(tz) is a proper homotopy of the constant
mapping c : S1 →S1, c(z) = f(0) with g. Thus dn is properly homotopic to a constant map and hence
deg dn = 0 by Corollary 7.5.12. However, if S1 is parameterized by arc length θ, 0 ≤θ ≤2π, then dn maps
the segment 0 ≤θ ≤2π/n onto the segment 0 ≤θ ≤2π since dn has the eﬀect eiθ →einθ. If ω denotes the
corresponding volume form on S1, the change of variables formula thus gives

S1 d∗
nω = n

S1 ω = 2πn,
that is,
deg dn = n,
which for n ̸= 0 is a contradiction.
■
The fundamental theorem of algebra shows that any polynomial p : C →C of degree n can be written as
p(z) = c(z −z1)k1 · · · (z −zm)km,
where z1, . . . , zm are the distinct roots of p, k1, . . . , km are their multiplicities, k1 + · · · + km = n, and c ∈C
is the coeﬃcient of zn in p(z). The fundamental theorem of algebra can be reﬁned to take into account
multiplicities of roots in the following way.
7.5.16 Proposition.
Let D be a compact subset of C with open interior and smooth boundary ∂D. Assume
that the polynomial p : C →C has no zeros on ∂D. Then the total number of zeros of p which lie in the
interior of D, counting multiplicities, equals the degree of the map p/|p| : ∂D →S1.
Proof.
Let z1, . . . , zm be the roots of p in the interior of D with multiplicities k(1), . . . , k(m). Around each
zi construct an open disk Di centered at zi, Di ⊂D, such that
∂D ∩∂Di = ∅
and
∂Di ∩∂Dj = ∅,

7.5 Introduction to Hodge–deRham Theory
473
for all i ̸= j. Then
V = D\(D1 ∪· · · ∪Dm)
is a smooth compact two-dimensional manifold whose boundary is ∂D ∪∂D1 ∪. . . ∂Dm. The boundary
orientation of ∂Di induced by V is opposite to the usual boundary orientation of ∂Di as the boundary of
the disk Di; see Figure 7.5.2. Since p/|p| is deﬁned on all of V , Corollary 7.5.11 implies that the degree of
p/|p| : ∂V →S1 is zero. But the degree of a map deﬁned on a disjoint union of manifolds is the sum of the
individual degrees and thus the degree of p/|p| on ∂D equals the sum of the degrees of p/|p| on all ∂Dj. The
proposition is therefore proved if we show that the degree of p/|p| on ∂Di is the multiplicity k(i) of the root
zi.
D
D1
D3
D2
z1
z3
z2
Figure 7.5.2. Relating degree with numbers of zeros
Let
r(z) = c
m

j=1,j̸=i
(z −zj)k(j),
so
p(z) = (z −zi)k(i)r(z)
and the only zero of p(z) in the disk Di is zi. Then ϕ : z ∈S1 →zi+Riz ∈∂Di, where Ri is the radius of Di,
is a diﬀeomorphism and therefore the degree of p/|p| : ∂Di →S1 equals the degree of (p◦ϕ)/|p◦ϕ| : S1 →S1.
The homotopy H : [0, 1] × S1 →S1 of zk(i) arg(r(zi)) with (p ◦ϕ)/|p ◦ϕ| given by
H(t, z) = zk(i)r(zi + tRiz)
|r(zi + tRiz)|
is proper and smooth, since zi + tRiz ∈Di for all z ∈S1, t ∈[0, 1]. Thus in ∂Di we have
deg p
|p| = deg p ◦ϕ
|p ◦ϕ| = deg zk(i) = k(i).
■
A variant of the fundamental theorem of algebra is the following.
7.5.17 Proposition.
Let U be an open subset of Rn and f : U →Rn be a C1 proper map. Assume there
is a closed subset K ⊂U such that for all x ∈U\K, the Jacobian J(f)(x) does not change sign and is not
identically equal to zero. Then f is surjective.
Proof.
The map f cannot be constant since the Jacobian J(f)(x) is not identically zero for all x ∈U\K.
For the same reason, f has a regular value y ∈f(U\K), for if all values in f(U\K) are singular, J(f) will
vanish on U\K. If y ∈f(U\K) is a regular value of f then sign(Txf) does not change for all x ∈f −1(y) so
by the degree theorem 7.5.10, deg(f) ̸= 0, which then implies that f is onto.
■

474
7. Integration on Manifolds
The orientation preserving character of proper diﬀeomorphisms is characterized in terms of the degree as
follows.
7.5.18 Proposition.
Let M and N be oriented boundaryless connected manifolds and f : M →N a
proper local diﬀeomorphism. Then deg f = 1, if and only if f is an orientation preserving diﬀeomorphism.
Proof.
If f is an orientation preserving diﬀeomorphism, then deg(f) = 1 by Theorem 7.5.10. Conversely,
let f be a proper local diﬀeomorphism with deg f = 1. Deﬁne
U± = { m ∈M | sign Tmf = ±1 } .
Since f is a local diﬀeomorphism, U± are open in M. Connectedness of M and
M = U+ ∪U−,
U+ ∩U−= ∅
imply that M = U+ or M = U−. Let us show that U−= ∅. Since deg(f) = 1, f is onto and hence if n ∈N,
f −1(n) ̸= ∅is a discrete submanifold of M. Properness of f implies that
f −1(n) = {m(1), . . . , m(k)}.
Since f is a local diﬀeomorphism of a neighborhood Ui of m(i) onto a neighborhood V of n, sign Tm(i)f is
the same for all i = 1, . . . , k (for otherwise J(f) must vanish somewhere). Thus deg(f) = ±k according to
whether Tm(i)f preserves or reverses orientation. Since deg(f) = 1, this implies U−= ∅and k = 1, that is,
f is injective. Thus f is a bijective local diﬀeomorphism, that is, a diﬀeomorphism.
■
Supplement 7.5B
Zero and n-Dimensional Cohomology
Here we compute H0(M) and Hn(M) for a connected n-manifold M. Recall that the cohomology groups
are deﬁned by
Hk(M) = ker(d)k/ range(dk−1),
where dk : Ωk(M) →Ωk+1(M) is the exterior diﬀerential. If Ωk
c(M) denotes the k-forms with compact sup-
port, then dk : Ωk
c(M) →Ωk+1
c
(M) and one forms in the same manner Hk
c (M), the compactly supported
cohomology groups of M.
Thus,
H0(M) = { f ∈F(M) | df = 0 } ∼= R
since any locally constant function on a connected space is constant. If M were not connected, then H0(M) =
Rc, where c is the number of connected components of M. By the Poincar´e lemma, if M is contractible,
then Hq(M) = 0 for q ̸= 0.
The rest of this supplement is devoted to the proof and applications of the following special case of
deRham’s theorem.
7.5.19 Theorem.
Let M be a boundaryless connected n-manifold.
(i) If M is orientable, then Hn
c (M) ∼= R, the isomorphism being given by integration: [ω] →

M ω. In
particular ω ∈Ωn
c (M) is exact iﬀ

M ω = 0.

7.5 Introduction to Hodge–deRham Theory
475
(ii) If M is nonorientable, then Hn
c (M) = 0.
(iii) If M is non-compact, orientable or not, then Hn(M) = 0.
Before starting the actual proof, let us discuss (i). The integration mapping

M : Ωn(M) →R is linear
and onto. To see that it is onto, let ω be an n-form with support in a chart in which the local expression is
ω = fdx1 ∧· · ·∧dxn with f a bump function. Then

M ω =

Rn f(x)dx > 0. Since we can multiply ω by any
scalar, the integration map is onto. Any ω with nonzero integral cannot be exact by Stokes’ theorem. This last
remark also shows that integration induces a mapping, which we shall still call integration,

M : Hn
c (M) →R,
which is linear and onto. Thus, in order to show that it is an isomorphism as (i) states, it is necessary and
suﬃcient to prove it is injective, that is, to show that if

M ω = 0 for ω ∈Ωn(M), then ω is exact. The proof
of this will be done in the following lemmas.
7.5.20 Lemma.
Theorem 7.5.19 holds for M = S1.
Proof.
Let p : R →S1 be given by p(t) = eit and ω ∈Ω1(S1). Then p∗ω = f dt for f ∈F(R) a 2π-periodic
function. Let F be an antiderivative of f. Since
0 =

S1
ω =
 t+2π
t
f(s)ds = F(t + 2π) −F(t)
for all t ∈R, we conclude that F is also 2π-periodic, so it induces a unique map G ∈F(S1), determined by
p∗G = F. Hence p∗ω = dF = p∗dG implies ω = dG since p is a surjective submersion.
■
7.5.21 Lemma.
Theorem 7.5.19 holds for M = Sn, n > 1.
Proof.
This will be done by induction on n, the case n = 1 being the previous lemma. Write Sn = N ∪S,
where N = { x ∈Sn | xn+1 ≥0 } is the closed northern hemisphere and S = { x ∈Sn | xn+1 ≤0 } the
closed southern hemisphere. Then N ∩S = Sn−1 is oriented in two diﬀerent ways as the boundary of N
and S, respectively. Let
ON =

x ∈Sn | xn+1 > −ϵ

,
OS =

x ∈Sn | xn+1 < ϵ

be open contractible neighborhoods of N and S, respectively. Thus by the Poincar´e lemma, there exist
αN ∈Ωn−1(ON), αS ∈Ωn−1(OS) such that dαN = ω on ON, dαS = ω on OS. Hence by hypothesis and
Stokes’ theorem,
0 =

Sn ω =

N
ω +

S
ω =

N
dαN +

S
dαS =

∂N
i∗αN +

∂S
i∗αS
=

Sn−1 i∗αN −

Sn−1 i∗αS
=

Sn−1 i∗(αN −αS)
where i : Sn−1 →Sn is the inclusion of Sn−1 as the equator of Sn; the minus sign appears on the second
integral because the orientations of Sn−1 and ∂S are opposite. By induction, i∗(αN −αS) ∈Ωn−1(Sn−1) is
exact.
Let O = ON ∩OS and note that the map r : O →Sn−1, sending each x ∈S to r(x) ∈Sn−1, the intersection
of the meridian through x with the equator Sn−1, is smooth. Then r ◦i is the identity on Sn−1. Also, i ◦r is
homotopic to the identity of O, the homotopy being given by sliding x ∈O along the meridian to r(x). Since
d(αN −αS) = ω −ω = 0 on O, by Theorem 6.4.16 we conclude that (αN −αS) −r∗i∗(αN −αS) is exact
on O. But we just showed that i∗(αN −αS) ∈Ωn−1(Sn−1) is exact, and hence r∗i∗(αN −αS) ∈Ωn−1(O)
is also exact. Hence αN −αS ∈Ωn−1(O) is exact. Thus, there exists β ∈Ωn−2(O) such that αN −αS = dβ

476
7. Integration on Manifolds
on O. Now use a bump function to extend β to a form γ ∈Ωn−2(Sn) so that on O, β = γ, and γ = 0 on
Sn\V , where V is an open set such that cl(U) ⊂V . Then
λ(x) =
!
αN(x),
if x ∈N,
αS(x) + dγ,
if x ∈S
is by construction C∞and dλ = ω.
■
7.5.22 Lemma.
A compactly supported n-form ω ∈Ωn(Rn) is the exterior derivative of a compactly
supported (n −1)-form on Rn iﬀ

Rn ω = 0.
Proof.
Let σ : Sn →Rn be the stereographic projection from the north pole (0, . . . , 1) ∈Sn onto Rn and
assume without loss of generality that (0, . . . , 1) /∈σ−1 (supp ω). By the previous lemma, σ∗ω = dα, for
some α ∈Ωn−1(Sn) since
0 =

Rn ω =

S
σ∗ω
by the change of variables formula. But σ∗ω = dα is zero in a contractible neighborhood U of the north
pole, so that by the Poincar´e lemma, α = dβ on U, where β ∈Ωn−2(U). Now extend β to an (n −2)-form
γ ∈Ωn−2(Sn) such that β = γ on U and γ = 0 outside a neighborhood of cl(U). But then σ∗(α −dγ) is
compactly supported in Rn and dσ∗(α −dγ) = σ∗dα = ω.
■
7.5.23 Lemma.
Let M be a boundaryless connected n-manifold. Then Hn
c (M) is at most one-dimensional.
Proof.
Let (U0, ϕ0) be a chart on M such that ϕ0(U0) is the open unit ball B in Rn. Let ω ∈Ωn
c (M),
satisfying supp(ω) ⊂U1, be the pull–back of a form fdx1∧· · ·∧dxn ∈Ωn(B) where f ≥0 and

Rn f(x)dx = 1.
To prove the lemma, it is suﬃcient to show that for every η ∈Ωn
c (M) there exists a number c ∈R such that
η −cω = dζ for some ζ ∈Ωn−1
c
(M).
First assume η ∈Ωn−1
c
(M) has supp(η) entirely contained in a chart (U, ϕ) and let U0, U1, . . . , Uk be a
ﬁnite covering of a curve starting in U0 and ending on Uk = U such that Ui ∩Ui+1 = ∅. Let αi ∈Ωn
c (Ui),
i = 1, . . . , k −1 be non-negative n-forms such that
supp(αi) ⊂Ui,
supp(αi) ∩Ui+1 ̸= ∅,
and

Rn ϕi∗(αi) = 1.
Let α0 = ω and αk = η. But then

Rn ϕi∗(αi−1) ̸= 0,
i = 1, . . . , k
by the change-of-variables formula, so that with ci = −1/

Rn ϕi∗(αi−1) we have

Rn ϕi∗(αiciαi−1) = 0. Thus
by the previous lemma ϕi∗(αi −ciαi−1) is the diﬀerential of an (n −1)-form supported in B. That is, there
exists βi ∈Ωn−1
c
(M), βi vanishing outside Ui such that
αi −ciαi−1 = dβi,
i = 1, . . . , k.
Put c = ck · · · c1 and
β = βk + (ckβk−1) + (ckck−1βk−2) + · · · + (ck−1 · · · c2β1) ∈Ωn−1(M).
Then
η −cω = αk −cα0 = αk −ckαk−1 + ck(αk−1 −ck−1αk−2) + . . .
+ (ck · · · c2)(α1 −c1α0)
= dβk + ckdβk−1 + · · · + (ck · · · c2)dβ1 = dβ.

7.5 Introduction to Hodge–deRham Theory
477
Let η ∈Ωn
c (M) be arbitrary and { χi | i = 1, . . . , k } a partition of unity subordinate to the given atlas
{ (Ui, ϕi) | i = 1, . . . , k }. Then χiη is compactly supported in Ui and hence there exist constants ci and
forms αi ∈Ωn−1
c
(M) such that χiη −ciω = dαi. If
c =
k

i=1
ci
and
α =
k

i=1
αi ∈Ωn−1
c
(M),
then
η −cω =
k

i=1
(χiη −ciω) =
k

i=1
dαi = dα.
■
Proof of Theorem 7.5.19.
(i) By the preceding lemma, Hn
c (M) is zero- or one-dimensional. We have
seen that

M : Hn
c (M) →R is linear and onto so that necessarily Hn
c (M) is one-dimensional; that is,

M ω = 0 iﬀω is exact.
(ii) Let 
M be the oriented double covering of M and π : 
M →M the canonical projection. Deﬁne π# :
Hn(M) →Hn(
M) by π#[α] = [π∗α]. We shall ﬁrst prove that π# is the zero map. Let {Ui} be an open
covering of M by chart domains and {χi} a subordinate partition of unity. Let π−1(Ui) = U 1
i ∪U 2
i . Then
{ U j
i | j = 1, 2 } is an open covering of 
M by chart domains and the maps ψj
i = χi ◦π/2 : U j
i →R, j = 1, 2,
form a subordinate partition of unity on M. Let α ∈Ωn
c (M). Then


M
π∗α =

i,j

U j
i
ψ1
i π∗α =
k

i=1

U 1
i
ψ1
i π∗α +

U 2
i
ψ2
i π∗α

= 0,
each term vanishing since their push–forwards by the coordinate maps coincide on Rn and U 1
i and U 2
i have
opposite orientations. By (i), we conclude that π∗α = dβ for some β ∈Ωn−1(
M); that is, π#[α] = [π∗α] = [0]
for all [α] ∈Hn
c (M).
We shall now prove that π# is injective, which will show that Hn
c (M) = 0. Let α ∈Ωn
c (M) be such that
π∗α = dβ for some β ∈Ωn−1c(
M) and let r : 
M →
M be the diﬀeomorphism associating to (m, [ω]) ∈
M
the point (m, [−ω]) ∈
M. Then clearly π ◦r = π so that
d(r∗β) = r∗(dβ) = r∗π∗α = (π ◦r)∗α = π∗α = dβ.
Deﬁne ˜γ ∈Ωn−1
c
(M) by setting ˜γ = (1/2)(β + r∗β) and note that r∗˜γ = ˜γ and
d˜γ = dβ + dr∗β
2
= dβ = π∗α.
But ˜γ projects to a well-deﬁned form γ ∈Ωn−1
c
(M) such that π∗γ = ˜γ, since r∗˜γ = ˜γ. Thus π∗α = d˜γ =
dπ∗γ = π∗dγ, which implies that α = dγ, since π is a surjective submersion.
(iii) Assume ﬁrst that ω ∈Ωn
c (M) has its support contained in a relatively compact chart domain U1 of M.
Then out of a ﬁnite open relatively compact covering of cl(U1) by chart domains, pick a relatively compact
chart domain U2 which does not intersect supp(ω). Working with cl(U2)\U1, ﬁnd a relatively compact chart
domain U3 such that
U1 ∩U3 = ∅,
U2 ∩U3 ̸= ∅,
U3 ∩(M\(U1 ∩U2)) ̸= ∅.
Proceed inductively to ﬁnd a sequence {Un} of relatively compact chart domains such that
Un ∩Un+1 ̸= ∅,
Un ∩Un−1 ̸= ∅,
Un ∩Um = ∅

478
7. Integration on Manifolds
U1
U2
U3
U4
supp(ω)
supp(ω1)
supp(ω2)
supp(ω3)
Figure 7.5.3. A chain of open sets
for all m ̸= n −1, n, n + 1, and such that supp(ω) ⊂U1, U2 ∩supp(ω) = ∅. Since M is not compact, this
sequence can be chosen to be inﬁnite; see Figure 7.5.3.
Now choose in each Un ∩Un+1 an n-form ωn with compact support such that

U1
ω =

U1
ω1 =

U2
ω2 = · · · =

Un
ωn = · · · .
Since Hn
c (Un) = R by (i), Un being orientable, ωn−1 and ωn deﬁne the same cohomology class, that is, there
is ηn ∈Ωn−1c(Un) such that ωn−1 = ωn + dηn. If we let ω0 = ω, we get recursively
ω = dη1 + ω1 = d(η1 + η2) + ω2 = · · · = d
 n

i=1
ηi

+ ωn = · · · .
We claim that ω = d(
n≥1 ηn), where the sum is ﬁnite since any point of the manifold belongs to at
most two Un’s. Thus, if p ∈
n≥1 Un, let p ∈Un so that
d(Σn≥1ηn)(p) = dηn−1(p) + dηn(p) + dηn+1(p)
= dηn−1(p) + ωn−1(p) −ωn+1(p)
= dηn−1(p) + ωn−1(p) −ωn+2(p) −dηn+2(p)
with the convention η0 = 0. Since Un ∩Un+2 = ∅and supp ωn+2, supp ηn+2 ⊂Un+2, it follows that the last
two terms vanish. Thus,
d


n≥1
ηn

(p) = dηn−1(p) + ωn−1(p).
If n = 1, this proves the desired equality. If n ≥2, then
d


n≥1
ηn

(p) = dηn−1(p) + ωn−1(p) = ωn−2(p)
and Un ∩Un−2 = ∅implies that d(
n≥1 ηn) = 0. Since also ω(p) = 0 in this case, the desired equality
holds again. Finally, if p /∈
n≥1 Un, then both sides of the equality are zero and we showed that ω is exact,
ω = d(
n≥1 ηn), with supp(
n≥1 ηn) ⊂
n≥1 Un.
Now if ω ∈Ωn(M), let {(Ui, gi)} be a partition of unity subordinate to a locally ﬁnite atlas of M
whose chart domains are relatively compact. Thus supp(giω) ⊂Ui and by what we just proved, giω = dηi,

7.5 Introduction to Hodge–deRham Theory
479
with supp(ηi) contained in the union of the chain of open sets {U i
n}, U i
1 = Ui, as described above. Reﬁne
each such chain, such that all its elements are one of the Uj’s. Since at most two of the U i
n intersect for
each ﬁxed i, it follows that the sum Σiηi is locally ﬁnite and therefore h = 
i ηi ∈Ωn−1(M). Finally,
ω = 
i giω = 
i dηi = dη, thus showing that ω is exact and hence Hn(M) = 0.
■
One can use this result as an alternative method to introduce the degree of a proper map f : M →N
between oriented n-manifolds; that is, that integer deg(f) such that

M
f ∗η = deg(f)

N
η
for any η ∈Ωn
c (N). Indeed, since the isomorphism Hn
c (N) ∼= R is given by [η] →

N η, the linear map
[η] →

M f ∗η of Hn
c (N) to R must be some real multiple of this isomorphism:

M
f ∗η = deg(f)

N
η
for all η ∈Ωn
c (N) and some real deg(f).
To prove that deg(f) is an integer in this context and that the formula (7.5.3) for deg(f) is independent
of the regular value y, note that if y is any regular value of f and x ∈f −1(y), then there exist compact
neighborhoods V of y and U of x such that f|U : U →V is a diﬀeomorphism. Since f −1(y) is compact and
discrete, it must be ﬁnite, say f −1(y) = {x1, . . . , xk}. This shows that f −1(V ) = U1 ∪· · · ∪Uk with all Ui
disjoint and the sum in the degree formula is ﬁnite. Shrink V if necessary to lie in a chart domain. Now
choose η ∈Ωn
c (N) satisfying supp(η) ⊂V . Then

M
f ∗η =

xi∈f −1(y)

Ui
f ∗η =




xi∈f −1(y)
sign(Txif)




N
η
by the change of variables formula in Rn, so the claim follows.
Degree theory can be extended to inﬁnite dimensions as well and has important applications to partial
diﬀerential equations and bifurcations. This theory is similar in spirit to the above and was developed by
Leray and Schauder in the 1930s. See Chow and Hale [1982], Nirenberg [1974], and Elworthy and Tromba
[1970b] for modern accounts.
Exercises
⋄7.5-1 (Poincar´e duality).
Show that ∗induces an isomorphism ∗: Hk →Hn−k and Hk
c →Hn−k
c
.
⋄7.5-2.
(For students knowing some algebraic topology.) Develop some basic properties of deRham coho-
mology groups such as homotopy invariance, exact sequences, Mayer–Vietoris sequences and excision. Use
this to compute the cohomology of some standard simple spaces (tori, spheres, projective spaces).
⋄7.5-3.
(i) Show that any smooth vector ﬁeld X on a compact Riemannian manifold (M, g) can be
written uniquely as
X = Y + grad p
where Y has zero divergence (and is parallel to ∂M if M has boundary).
(ii) Show directly that the equation
∆p = −div X,
(grad p) · n = X · n
is formally soluble using the ideas of the Fredholm alternative.

480
7. Integration on Manifolds
⋄7.5-4.
Show that any symmetric two-tensor h on a compact Riemannian manifold (M, g) can be uniquely
decomposed in the form
h = £Xg + k.
where δk = 0, δ being the divergence of g, deﬁned by δk = (£(·)g)∗k, where (£(·)g)∗is the adjoint of the
operator X →£Xg. (See Berger and Ebin [1969] and Cantor [1981] for more information.)
⋄7.5-5.
Let α ∈Ωk−1(M), β ∈Ωk(M), where M is a compact oriented Riemannian manifold with boundary.
Show that
(i)
⟨dα, β⟩−⟨α, δβ⟩=

∂M
α ∧∗β.
Hint: Show that ∗δβ = (−1)kd ∗β and use Stokes theorem or Corollary 7.2.13.
(ii)
⟨dδα, β⟩−⟨δα, δβ⟩=

∂M
δα ∧∗β
⟨dα, dβ⟩−⟨α, δdβ⟩=

∂M
α ∧∗dβ
(iii) (Green’s formula)
⟨∆α, β⟩−⟨α, ∆β⟩=

∂M
(δα ∧∗β −dβ ∧∗α + α ∧∗dβ −β ∧∗dα).
Hint: Show ﬁrst that
⟨∆α, β⟩−⟨dα, dβ⟩−⟨δα, δβ⟩=

∂M
(δα ∧∗β −β ∧∗dα).
⋄7.5-6.
(For students knowing algebraic topology.) Deﬁne relative cohomology groups and relate them to
the Hodge decomposition for manifolds with boundary.
⋄7.5-7.
Prove the local formulas
(δα)i1···ik =
1
k + 1| det[grs]|−1/2gi1r1···ikrk
∂
∂xl
k+1

p=1
(−1)pgr1j1 · · · grp−1jp−1gljpgrpjp+1 · · ·
grkjk+1βj1···jk+1| det[grs]|1/2
(δα)r1···rk =
1
k + 1| det[gij]|−1/2 ∂
∂xl
(
k+1

p=1
(−1)pαr1···rp−1lrp···rk| det[gij]|1/2)
where i1 < · · · < ik and α ∈Ωk+1(M) according to the following guidelines. First prove the second formula.
Work in a chart (U, ϕ) with ϕ(U) = B3(0) = open ball of radius 3, and prove the formula on ϕ−1(B1(0)).
For this, choose a function χ on Rn with supp(χ) ⊂B3(0) and χ|B1(0) ≡1. Then extend χϕ∗α to Rn,
denote it by α′ and consider the set B4(0).
(i) Show from Exercise 7.5-5(i) that ⟨dβ, α′⟩= ⟨β, δα′⟩for any β ∈Ωk+1(B4(0)).

7.5 Introduction to Hodge–deRham Theory
481
(ii) In the explicit expression for ⟨dβ, α′⟩, perform an integration by parts and justify it.
(iii) Find the expression for δα′ by comparing ⟨β, ∆α′⟩with the expression found in (ii) and argue that it
must hold on ϕ−1(B1(0)).
⋄7.5-8.
Let ϕ : M →M be a diﬀeomorphism of an oriented Riemannian manifold (M, g) and let δg denote
the codiﬀerential corresponding to the metric g and ⟨, ⟩g the inner product on Ωk(M) corresponding to the
metric g. Show that
(i) ⟨α, β⟩g = ⟨ϕ∗α, ϕ∗β⟩ϕ∗g for α, β ∈Ωk(M) and
(ii) δϕ∗g(ϕ∗α) = ϕ∗(δgα) for α ∈Ωk(M).
Hint: Use the fact that d and δ are adjoints.
⋄7.5-9.
(i) Let c1 and c2 be two diﬀerentiably homotopic curves and ω ∈Ω1(M) a closed one-form. Show
that

c1
ω =

c2
ω.
(ii) Let M be simply connected. Show that H1(M) = 0.
Hint: For m0 ∈M, let c be a curve from m0 to m ∈M. Then f(m) =

c ω is well deﬁned by (i) and
df = ω.
(iii) Show that H1(S1) ̸= 0 by exhibiting a closed one-form that is not exact.
⋄7.5-10.
The Hopf degree theorem states that f and g : M n →Sn are homotopic iﬀthey have the same
degree. By consulting references if necessary, prove this theorem in the context of Supplements 7.5A and B.
Hint: Consult Guillemin and Pollack [1974] and Hirsch [1976].
⋄7.5-11.
What does the degree of a map have to do with Exercise 7.2-4 on integration over the ﬁber? Give
some examples and a discussion.
⋄7.5-12.
Show that the equations
z13 + sin(|z|2)z7 + 3z4 + 2 = 0
z8 + cos(|z|2)z5 + 5 log(|z|2)z4 + 53 = 0
have a root.
⋄7.5-13.
Let f : M →N where M and N are compact orientable boundaryless manifolds and N is
contractible. Show that deg(f) = 0. Conclude that the only contractible compact manifold (orientable or
not) is the one-point space.
Hint: Show that the oriented double covering of a contractible non-orientable manifold is contractible.
⋄7.5-14.
Show that every smooth map f : Sn →Tn, n > 1 has degree zero. Conclude that Sn and Tn are
not diﬀeomorphic if n > 1.
Hint: Show that f is homotopic to a constant map.

Page 483
8
Applications
This chapter presents some applications of manifold theory and tensor analysis to physics and engineering.
Our selection is a of limited scope and depth, with the intention of providing an introduction to the tech-
niques. There are many other applications of the ideas of this book as well. We list below a few selected
references for further reading in the same spirit.
1. Arnol’d [1982], Abraham and Marsden [1978], Chernoﬀand Marsden [1974], Weinstein [1977], Marsden
[1981], Marsden [1992], and Marsden and Ratiu [1999] for Hamiltonian mechanics.
2. Marsden and Hughes [1983] for elasticity theory.
3. Flanders [1963], von Westenholz [1981], and Bloch, Ballieul, Crouch and Marsden [2001] for applications
to control theory.
4. Hermann [1980], Knowles [1981], and Schutz [1980] for diverse applications.
5. Bleecker [1981] for Yang–Mills theory.
6. Misner, Thorne, and Wheeler [1973] and Hawking and Ellis [1973] for general relativity.
8.1
Hamiltonian Mechanics
Newton’s Second Law.
Our starting point is Newton’s second law in R3, which states that a particle
which has mass m > 0, and is moving in a given potential ﬁeld V (x) where x ∈R3, moves along a curve
x(t) satisfying the equation of motion m¨x = −grad V (x). If we introduce the momentum p = m ˙x and the
energy
H(x, p) =
1
2m∥p∥2 + V (x),
then the equation ˙x = p/m and Newton’s law become Hamilton’s equations:
˙xi = ∂H
∂pi
,
˙pi = −∂H
∂xi ,
i = 1, 2, 3.

484
8. Applications
To study this system of ﬁrst-order equations for given H, we introduce the matrix
J =

0
I
−I
0

,
where I is the 3 × 3 identity; note that the equations become
˙ξ = J grad H(ξ)
where ξ = (x, p). In complex notation, setting z = x + ip, they may be written as
˙z = −2i∂H
∂¯z .
Suppose we make a change of coordinates, w = f(ξ), where f : R6 →R6 is smooth. If ξ(t) satisﬁes
Hamilton’s equations, the equations satisﬁed by w(t) are
˙w = A ˙ξ = AJ gradξ H(ξ) = AJA∗gradw H(ξ(w)),
where Ai
j = (∂wi/∂ξj) is the Jacobian matrix of f, A∗is the transpose of A and ξ(w) denotes the inverse
function of f. The equations for w will be Hamiltonian with energy K(w) = H(ξ(w)) if AJA∗= J. A
transformation satisfying this condition is called canonical or symplectic. One of the things we do in this
chapter is to give a coordinate free treatment of this and related concepts.
The space R3 × R3 of the ξ’s is called the phase space. For a system of N particles one uses R3N × R3N.
However, many fundamental physical systems have a phase space that is a manifold rather than Euclidean
space, so doing mechanics solely in the context of Euclidean space is too constraining. For example, the
phase space for the motion of a rigid body about a ﬁxed point is the tangent bundle of the group SO(3) of
3 × 3 orthogonal matrices with determinant +1. This manifold is diﬀeomorphic to RP3 and is topologically
nontrivial. To generalize the notion of a Hamiltonian system to the context of manifolds, we ﬁrst need
to geometrize the symplectic matrix J. In inﬁnite dimensions a few technical points need attention before
proceeding.
Weak and Strong Metrics and Symplectic Forms.
Let E be a Banach space and B : E × E →R
a continuous bilinear mapping. Then B induces a continuous map B♭: E →E∗, e →B♭(e) deﬁned by
B♭(e) · f = B(e, f). We call B weakly nondegenerate if B♭is injective, that is, B(e, f) = 0 for all f ∈E
implies e = 0. We call B nondegenerate or strongly nondegenerate if B♭is an isomorphism. By the
open mapping theorem, it follows that B is nondegenerate iﬀB is weakly nondegenerate and B♭is onto.
If E is ﬁnite dimensional there is no diﬀerence between strong and weak nondegeneracy. However, if inﬁnite
dimensions the distinction is important to bear in mind, and the issue does come up in basic examples, as
we shall see in Supplement 8.1A.
Let M be a Banach manifold. By a weak Riemannian structure we mean a smooth assignment
g : x →⟨, ⟩x = g(x) of a weakly nondegenerate inner product (not necessarily complete) to each tangent
space TxM. Here smooth means that in a local chart U ⊂E, the mapping g : x →⟨, ⟩x ∈L2(E, E; R)
is smooth, where L2(E, E; R) denotes the Banach space of bilinear maps of E × E to R. Equivalently,
smooth means g is smooth as a section of the vector bundle L2(TM, TM; R) whose ﬁber at x ∈M is
L2(TxM, TxM; R). By a Riemannian manifold we mean a weak Riemannian manifold in which ⟨, ⟩x is
nondegenerate. Equivalently, the topology of ⟨, ⟩x is complete on TxM, so that the model space E must be
isomorphic to a Hilbert space.
For example the L2 inner product
⟨f, g⟩=
 1
0
f(x)g(x)dx
on E = C0([0, 1], R)
is a weak Riemannian metric on E but is not a Riemannian metric.

8.1 Hamiltonian Mechanics
485
8.1.1 Deﬁnition.
Let P be a manifold modeled on a Banach space E. By a symplectic form we mean
a two-form ω on P such that
(i) ω is closed, that is, dω = 0;
(ii) for each z ∈P, ωz : TzP × TzP →R is weakly nondegenerate.
If ωz in (ii) is nondegenerate, we speak of a strong symplectic form. If (ii) is dropped we refer to ω as a
presymplectic form. (For the moment the reader may wish to assume P is ﬁnite dimensional, in which
case the weak–strong distinction vanishes.)
The Darboux Theorem.
Our proof of this basic theorem follows Moser [1965] and Weinstein [1969].
8.1.2 Theorem (The Darboux Theorem).
Let ω be a strong symplectic form on the Banach manifold P.
Then for each x ∈P there is a local coordinate chart about x in which ω is constant.
Proof.
The proof proceeds by the Lie transform method Theorem 5.4.7. We can assume P = E and
x = 0 ∈E. Let ω1 be the constant form equaling ω0 = ω(0). Let Ω= ω1 −ω and ωt = ω + tΩ, for 0 ≤t ≤1.
For each t, ωt(0) = ω(0) is nondegenerate. Hence by openness of the set of linear isomorphisms of E to
E∗, there is a neighborhood of 0 on which ωt is nondegenerate for all 0 ≤t ≤1. We can assume that
this neighborhood is a ball. Thus by the Poincar´e lemma, Ω= dα for some one-form α. We can suppose
α(0) = 0. Deﬁne a smooth vector ﬁeld Xt by
iXtωt = −α,
which is possible since ωt is strongly non-degenerate. Since Xt(0) = 0, by Corollary 4.1.25, there is a
suﬃciently small ball on which the integral curves of Xt will be deﬁned for time at least one. Let Ft be the
ﬂow of Xt starting at F0 = identity. By the Lie derivative formula for time-dependent vector ﬁelds (Theorem
5.4.4) we have
d
dt(F ∗
t ωt) = F ∗
t (£Xt −ωt) + F ∗
t
d
dtωt
= F ∗
t diXtωt + F ∗
t Ω= F ∗
t (d(−α) + Ω) = 0.
Therefore, F ∗
t ω1 = F ∗
0 ω0 = ω, so F1 provides the chart transforming ω to the constant form ω1.
■
We note without proof that such a result is not true for Riemannian structures unless they are ﬂat. Also,
the analogue of Darboux theorem is known to be not valid for weak symplectic forms. (For the example, see
Abraham and Marsden [1978], Exercise 3.2-8 and for conditions under which it is valid, see Marsden [1981]
and Bambusi [1999].)
8.1.3 Corollary.
If P is ﬁnite dimensional and ω is a symplectic form, then
(i) P is even dimensional, say dim P = 2n;
(ii) locally about each point there are coordinates x1, . . . , xn, y1, . . . , yn such that
ω =
n

i=1
dxi ∧dyi.
Such coordinates are called canonical.
Proof.
By elementary linear algebra, any skew symmetric bilinear form that is nondegenerate has the
canonical form

0
I
−I
0

,
where I is the n × n identity. (This is proved by the same method as Proposition 6.2.9.) This is the matrix
version of (ii) pointwise on P. The result now follows from Darboux theorem.
■

486
8. Applications
As a bilinear form, ω is given in canonical coordinates by
ω((x1, y1), (x2, y2)) = ⟨y2, x1⟩−⟨y1, x2⟩.
In complex notation with z = x + iy it reads
ω(z1, z2) = −Im⟨z1, z2⟩.
This form for canonical coordinates extends to inﬁnite dimensions (see Cook [1966], Chernoﬀand Marsden
[1974], and Abraham and Marsden [1978, Section 3.1] for details).
Canonical Symplectic Forms.
Of course in practice, symplectic forms do not come out of the blue, but
must be constructed. The following constructions are basic results in this direction.
8.1.4 Deﬁnition.
Let Q be a manifold modeled on a Banach space E. Let T ∗Q be its cotangent bundle,
and π : T ∗Q →Q the projection. Deﬁne the canonical one-form θ on T ∗Q by
θ(α)w = α · Tπ(w),
where α ∈T ∗
q Q and w ∈Tα(T ∗Q). The canonical two-form is deﬁned by ω = −dθ.
In a chart U ⊂E, the formula for θ becomes
θ(x, α) · (e, β) = α(e),
where (x, α) ∈U × E∗and (e, β) ∈E × E∗. If Q is ﬁnite dimensional, this formula may be written
θ = pidqi,
where q1, . . . , qn, p1, . . . , pn are coordinates for T ∗Q and the summation convention is enforced. Using the
local formula for d from formula (6) in the table of identities in §6.4,
ω(x, α)((e1, α1), (e2, α2)) = α2(e1) −α1(e2),
or, in the ﬁnite-dimensional case,
ω = dqi ∧dpi.
In the inﬁnite-dimensional case one can check that ω is weakly nondegenerate and is strongly nondegenerate
iﬀE is reﬂexive.
If ⟨, ⟩x is a weak Riemannian (or pseudo-Riemannian) metric on Q, the smooth vector bundle map
ϕ = g♭: TQ →T ∗Q
deﬁned by ϕ(vx)·wx = ⟨vx, wx⟩x, x ∈Q, is injective on ﬁbers. If ⟨, ⟩is a strong Riemannian metric, then ϕ is
a vector bundle isomorphism of TQ onto T ∗Q. In any case, set Ω= ϕ∗ω where ω is the canonical two–form
on T ∗Q. Clearly Ωis exact since Ω= −dΘ where Θ = ϕ∗θ.
In the ﬁnite-dimensional case, the formulas for Θ and Ωbecome
Θ = gij ˙qjdqi,
and
Ω= gijdqi ∧d ˙qj + ∂gij
∂qk ˙qjdqi ∧dqk,
where q1, . . . , qn, ˙q1, . . . , ˙qn are coordinates for TQ. This follows by substituting pi = gij ˙qj into ω = dqi∧dpi.

8.1 Hamiltonian Mechanics
487
In the inﬁnite-dimensional case, if ⟨, ⟩is a weak metric, then ω is a weak symplectic form locally given by
Θ(w, e)(e1, e2) = −⟨e, e1⟩x,
and
Ω(x, e)((e1, e2), (e3, e4)) = Dx⟨e, e1⟩xe3 −Dx⟨e, e3⟩xe1
+ ⟨e4, e1⟩x −⟨e2, e3⟩x,
where Dx denotes the derivative with respect to x. One can also check that if ⟨, ⟩x is a strong metric and Q
is modeled on a reﬂexive space, then Ωis a strong symplectic form.
Symplectic Maps.
Naturally, since we have the notion of a symplectic manifold, we should consider the
mappings that preserve this structure.
8.1.5 Deﬁnition.
Let (P, ω) be a symplectic manifold. A (smooth) map f : P →P is called canonical
or symplectic when f ∗ω = ω.
It follows that f ∗(ω ∧· · · ∧ω) = ω ∧· · · ∧ω (k times). If P is 2n-dimensional, then µ = ω ∧· · · ∧ω (n
times) is nowhere vanishing, so is a volume form; for instance by a computation one ﬁnds µ to be a multiple
of the standard Euclidean volume in canonical coordinates. In particular, note that symplectic manifolds
are orientable. We call µ the phase volume or the Liouville form. Thus a symplectic map preserves
the phase volume, and so is necessarily a local diﬀeomorphism. A map f : P1 →P2 between symplectic
manifolds (P1, ω1) and (P2, ω2) is called symplectic if f ∗ω2 = ω1. As above, if P1 and P2 have the same
dimension, then f is a local diﬀeomorphism and preserves the phase volume.
Cotangent Lifts.
We now discuss symplectic maps induced by maps on the base space of a cotangent
bundle.
8.1.6 Proposition.
Let f : Q1 →Q2 be a diﬀeomorphism; deﬁne the cotangent lift of f by
T ∗f : T ∗Q2 →T ∗Q1;
T ∗f(αq) · v = αq · Tf(v),
where q ∈Q2, αq ∈T ∗
q Q2 and v ∈Tf −1(q)Q1; that is, T ∗f is the pointwise adjoint of Tf. Then T ∗f is
symplectic and in fact (T ∗f)∗θ1 = θ2 where θi is the canonical one-form on Qi, i = 1, 2.
Proof.
Let πi : T ∗Qi →Qi be the cotangent bundle projection, i = 1, 2. For w in the tangent space to
T ∗Q2 at αq, we have
(T ∗f)∗θ1(αq)(w) = θ1(T ∗f(αq))(TT ∗f · w)
= T ∗f(αq) · (Tπ1 · TT ∗f · w)
= T ∗f(αq) · (T(π1 ◦T ∗f) · w)
= αq · (T(f ◦π1 ◦T ∗f) · w
= αq · (Tπ2 · w)
= θ2(αq) · w
since, by construction, f ◦π1 ◦T ∗f = π2.
■
In coordinates, if we write f(q1, . . . , qn) = (Q1, . . . , Qn), then T ∗f has the eﬀect
(q1, . . . , qn, p1, . . . , pn) →(Q1, . . . , Qn, P1, . . . , Pn),
where
pj = ∂Qi
∂qj Pi

488
8. Applications
(evaluated at the corresponding points). That this transformation is always canonical and in fact preserves
the canonical one-form may be veriﬁed directly:
PidQi = Pi
∂Qi
∂qk dqk = pkdqk.
Sometimes one refers to canonical transformations of this type as “point transformations” since they arise
from general diﬀeomorphisms of Q1 to Q2. Notice that lifts of diﬀeomorphisms satisfy
f ◦π2 = π1 ◦T ∗f;
that is, the following diagram commutes:
T ∗Q2
T ∗Q1
Q2
Q1
T ∗f
f
π2
π1
✲
✲
❄
❄
Notice also that
T ∗(f ◦g) = T ∗g ◦T ∗f
and compare with
T(f ◦g) = Tf ◦Tg.
8.1.7 Corollary.
If Q1 and Q2 are Riemannian (or pseudo-Riemannian) manifolds and f : Q1 →Q2 is
an isometry, then Tf : TQ1 →TQ2 is symplectic, and in fact (Tf)∗Θ2 = Θ1.
Proof.
This follows from the identity
Tf = g2
# ◦(T ∗f)−1 ◦g1
♭.
All maps in this composition are symplectic and thus Tf is as well.
■
Hamilton’s Equations.
So far no mention has been made of Hamilton’s equations. Now we are ready to
consider them.
8.1.8 Deﬁnition.
Let (P, ω) be a symplectic manifold. A vector ﬁeld X : P →TP is called Hamiltonian
if there is a C1 function H : P →R such that
iXω = dH.
We say X is locally Hamiltonian if iXω is closed.
We write X = XH because usually in examples one is given H and then one constructs the Hamiltonian
vector ﬁeld XH. If ω is only weakly nondegenerate, then given a smooth function H : P →R, XH need not
exist on all of P. Rather than being a pathology, this is quite essential in inﬁnite dimensions, for the vector
ﬁelds then correspond to partial diﬀerential equations and are only densely deﬁned. The condition
iXHω = dH
is equivalent to
ωz(XH(z), v) = dH(z) · v,

8.1 Hamiltonian Mechanics
489
for z ∈P and v ∈TzP. Let us express this condition in canonical coordinates (q1, . . . , qn, p1, . . . , pn) on a
2n-dimensional symplectic manifold P, that is, when ω = dqi ∧dpi. If X = Ai∂/∂qi + Bi∂/∂pi, then
iXHω = iXH(dqi ∧dqi) = (iXHdqi)dpi −(iXHdpi)dqi = (Aidpi −Bidqi).
This equals
dH = ∂H
∂qi dqi + ∂H
∂pi
dqi
iﬀ
Ai = ∂H
∂pi
and
Bi = −∂H
∂qi ,
that is,
XH =
n

i=1
∂H
∂pi
∂
∂qi −∂H
∂qi
∂
∂pi

.
If
J =

0
I
−I
0

,
where I is the n × n identity matrix, the formula for XH can be expressed as
XH =
∂H
∂pi
, −∂H
∂qi

= J grad H.
More intrinsically, one can write XH = ω#dH, so one sometimes says that XH is the symplectic gradient
of H. Note that the formula XH = J grad H is a little misleading in this respect, since no metric structure
is actually needed and it is really the diﬀerential and not the gradient that is essential.
From the local expression for XH we see that (qi(t), pi(t)) is an integral curve of XH iﬀHamilton’s
equations hold;
˙qi = ∂H
∂pi
,
˙pi = −∂H
∂qi .
Properties of Hamiltonian systems.
The proofs of the following properties are a bit more technical
for densely deﬁned vector ﬁelds, so for purposes of these theorems, we work with C∞vector ﬁelds.
8.1.9 Theorem.
Let XH be a Hamiltonian vector ﬁeld on the (weak) symplectic manifold (P, ω) and let
Ft be the ﬂow of XH. Then
(i) Ft is symplectic, that is, F ∗
t ω = ω, and
(ii) energy is conserved, that is, H ◦Ft = Ft.
Proof.
(i) Since F0 = identity, it suﬃces to show that (d/dt)F ∗
t ω = 0. But by the basic connection
between Lie derivatives and ﬂows (§5.4 and §6.4):
d
dtF ∗
t ω(x) = F ∗
t (£XHω)(x)
= F ∗
t (diXHω)(x) + F ∗
t (iXHdω)(x).
The ﬁrst term is zero because it is d2H = 0 and the second is zero because ω is closed.

490
8. Applications
(ii) By the chain rule,
d
dt(H ◦Ft)(x) = dH(Ft(x)) · XH(Ft(x))
= ω(Ft(x))(XH(Ft(x)), XH(Ft(x))).
But this is zero in view of the skew symmetry of ω.
■
A corollary of (i) in ﬁnite dimensions is Liouville’s theorem: Ft preserves the phase volume. This is seen
directly in canonical coordinates by observing that XH is divergence-free.
Poisson Brackets.
Deﬁne for any functions f, g : U →R, U open in P, their Poisson bracket by
{f, g} = ω(Xf, Xg).
Since
£Xf g = iXf dg
= iXf iXgω
= ω(Xg, Xf) = −ω(Xf, Xg) = −£Xgf,
we see that
{f, g} = £Xgf = −£Xf g.
If ϕ : P1 →P2, is a diﬀeomorphism where (P1, ω1) and (P2, ω2) are symplectic manifolds, then by the
property ϕ∗(£Xα) = £ϕ∗Xϕ∗α of pull–back, we have
ϕ∗{f, g} = ϕ∗(£Xf g) = £ϕ∗Xf ϕ∗g,
and
{ϕ∗f, ϕ∗g} = £Xϕ∗f ϕ∗g.
Thus ϕ preserves the Poisson bracket of any two functions deﬁned on some open set of P2 iﬀϕ∗Xf = Xϕ∗f
for all C∞functions f : U →R where U is open in P2. This says that ϕ preserves the Poisson bracket iﬀ
it preserves Hamilton’s equations. We have
iXϕ∗f ω = d(ϕ∗f) = ϕ∗(df) = ϕ∗iXf ω = iϕ∗Xf ϕ∗ω,
so that by the (weak) nondegeneracy of ω and the fact that any v ∈TzP equals some Xh(z) for a C∞
function h deﬁned in a neighborhood of z, we conclude that ϕ is symplectic iﬀϕ∗Xf = Xϕ∗f for all C∞
functions f : U →R, where U is open in P2. We have thus proved the following.
8.1.10 Proposition.
Let (P1, ω1) and (P2, ω2) be symplectic manifolds and ϕ : P1 →P2 a diﬀeomorphism.
The following are equivalent:
(i) ϕ is symplectic.
(ii) ϕ preserves the Poisson bracket of any two locally deﬁned functions.
(iii) ϕ∗Xf = Xϕ∗f for any local f : U →R, where U is open in P2 (i.e., ϕ locally preserves Hamilton’s
equations).
Conservation of energy is generalized in the following way.

8.1 Hamiltonian Mechanics
491
8.1.11 Corollary.
(i) Let XH be a Hamiltonian vector ﬁeld on the (weak) symplectic manifold (P, ω)
with (local) ﬂow Ft. Then for any C∞function f : U →R, U open in P, we have
d
dt(f ◦Ft) = {f, H} ◦Ft = {f ◦Ft, H}.
(ii) The curve c(t) satisﬁes Hamilton’s equations deﬁned by H if and only if
d
dtf(c(t)) = {f, H}(c(t))
for any C∞function f : U →R, where U is open in P.
Proof.
(i) We compute as follows:
d
dt(f ◦Ft) = d
dtF ∗
t f = F ∗
t £XHf = F ∗
t {f, H} = {F ∗
t f, H}
by the formula for Lie derivatives and the previous proposition.
(ii) Since df(c(t))/dt = df(c(t)) · (dc/dt) and
{f, H}(c(t)) = (£XHf)(c(t)) = df(c(t)) · XH(c(t)),
the equation in the statement of the proposition holds iﬀc′(t) = XH(c(t)) by the Hahn–Banach
theorem and Corollary 4.2.14.
■
One writes ˙f = {f, H} to stand for the equation in (ii). This equation is called the equation of motion
in Poisson bracket formulation.
Two functions f, g : P →R are said to be in involution or to Poisson commute if {f, g} = 0. Any
function Poisson commuting with the Hamiltonian of a mechanical system is, by Corollary 8.1.11, necessarily
constant along on the ﬂow of the Hamiltonian vector ﬁeld. This is why such functions are called constants
of the motion. A classical theorem of Liouville states that in a mechanical system with a 2n-dimensional
phase space admitting k constants of the motion in involution and independent almost everywhere (i.e.,
the diﬀerentials are independent on an open dense set) one can reduce the dimension of the phase space
to 2(n −k). In particular, if k = n, the equations of motion can be “explicitly” integrated. In fact, under
certain additional hypotheses, the trajectories of the mechanical system are straight lines on high-dimensional
cylinders or tori. If the motion takes place on tori, the explicit integration of the equations of motion goes
under the name of ﬁnding action-angle variables. See Arnol’d [1982], and Abraham and Marsden [1978,
pp. 392–400] for details and Exercise 8.1-4 for an example. In inﬁnite-dimensional systems the situation is
considerably more complicated. A famous example is the Korteweg–deVries (KdV) equation; for this example
we also refer to Abraham and Marsden [1978, pp. 462–72] and references therein. The following supplement
gives some elementary but still interesting examples of inﬁnite-dimensional Hamiltonian systems.
Supplement 8.1A
Two Inﬁnite-Dimensional Examples
8.1.12 Example (The Wave Equation as a Hamiltonian System).
The wave equation for a function u(x, t),
where x ∈Rn and t ∈R is given by
d2u
dt2 = ∇2u + m2u,
(where m ≥0 is a constant),

492
8. Applications
with u and ˙u = ∂u/∂t given at t = 0. The energy is
H(u, ˙u) = 1
2

| ˙u|2dx +

∥∇u∥2dx

.
We deﬁne H on pairs (u, ˙u) of ﬁnite energy by setting
P = H1(Rn) × L2(Rn),
where H1 consists of functions in L2 whose ﬁrst (distributional) derivatives are also in L2. (The Sobolev
spaces Hs deﬁned this way are Hilbert spaces that arise in many problems involving partial diﬀerential
equations. We only treat them informally here.) Let D = H2 × H1 and deﬁne XH : D →P by
XH(u, ˙u) = ( ˙u, ∇2u + m2u).
Let the symplectic form be associated with the L2 metric as in the discussion following Deﬁnition 8.1.4,
namely
ω((u, ˙u), (v, ˙v)) =

vu dx −

˙uv dx.
It is now an easy veriﬁcation using integration by parts, to show that XH, ω and H are in the proper
relation, so in this sense the wave equation is Hamiltonian. That the wave equation has a ﬂow on P follows
from (the real form of) Stone’s theorem (see Supplement 7.4A and ?).
♦
8.1.13 Example (The Schr¨odinger Equation).
Let P = H a complex Hilbert space with ω = −2 Im⟨, ⟩.
Let Hop be a self-adjoint operator with domain D and let
XH(ϕ) = iHop · ϕ
and
H(ϕ) = ⟨Hopϕ, ϕ⟩,
ϕ ∈D.
Again it is easy to check that ω, XH and H are in the correct relation. Thus, XH is Hamiltonian. Note that
ψ(t) is an integral curve of XH if
1
i
dψ
dt = Hopψ,
which is the abstract Schr¨odinger equation of quantum mechanics. That XH has a ﬂow is a special case
of Stone’s theorem. We know from general principles that the ﬂow eitHop will be symplectic. The additional
structure needed for unitarity is exactly complex linearity.
♦
Turning our attention to geodesics and to Lagrangian systems, let M be a (weak) Riemannian manifold
with metric ⟨, ⟩x on the tangent space TxM. The spray S : TM →T 2M of the metric ⟨, ⟩x is the vector
ﬁeld on TM deﬁned locally by S(x, v) = ((x, v), (v, γ(x, v))), for (x, v) ∈TxM, where γ is deﬁned by
⟨γ(x, v), w⟩x ≡1
2Dx⟨v, v⟩x · ω −Dx⟨v, w⟩x · v
(8.1.1)
and Dx, ⟨v, v⟩x · w means the derivative of ⟨v, v)x with respect to x in the direction of w. If M is ﬁnite
dimensional, the Christoﬀel symbols are deﬁned by putting γi(x, v) = −Γi
jk(x)vjvk. Equation (8.1.1) is
equivalent to
−Γi
jkvjvkwi = 1
2
∂gij
∂xk vivjwk −∂gij
∂xk viwjvk;

8.1 Hamiltonian Mechanics
493
that is,
Γi
jk = 1
2ghi
∂ghk
∂xj + ∂gjh
∂xk −∂gjk
∂xh

.
The veriﬁcation that S is well-deﬁned independent of the charts is not too diﬃcult. Notice that γ is quadratic
in v. We will show below that S is the Hamiltonian vector ﬁeld on TM associated with the kinetic energy
⟨v, v⟩/2. The projection of the integral curves of S to M are called geodesics. Their local equations are
thus
¨x = γ(x, ˙x),
which in the ﬁnite-dimensional case becomes
¨xi + Γi
jk ˙xj ˙xk = 0,
i = 1, . . . , n.
The deﬁnition of γ in equation (8.1.1) makes sense in the inﬁnite as well as the ﬁnite-dimensional case,
whereas the coordinate deﬁnition of Γi
jk makes sense only in ﬁnite dimensions. This provides a way to deal
with geodesics in inﬁnite-dimensional spaces.
Let t →(x(t), v(t)) be an integral curve of S. That is,
˙x(t) = v(t)
and
˙v(t) = γ(x(t), v(t)).
(8.1.2)
As we remarked, these will shortly be shown to be Hamilton’s equations of motion in the absence of a
potential. To include a potential, let V : M →R be given. At each x, we have the diﬀerential of V ,
dV (x) ∈T ∗
xM, and we deﬁne grad V (x) by
⟨grad V (x), w⟩x = dV (x) · w.
(8.1.3)
(In inﬁnite dimensions, it is an extra assumption that grad V exists, since the map TxM →T ∗
xM induced
by the metric is not necessarily bijective.)
The equations of motion in the potential ﬁeld V are given by
˙x(t) = v(t);
˙v(t) = γ(x(t), v(t)) −grad V (x(t))).
(8.1.4)
The total energy, kinetic plus potential, is given by
H(vx) = 1
2∥vx∥2 + V (x).
The vector ﬁeld XH determined by H relative to the symplectic structure on TM induced by the metric,
is given by equation (8.1.4). This will be part of a more general derivation of Lagrange’s equations given
below.
Supplement 8.1B
Geodesics
Readers familiar with Riemannian geometry can reconcile the present approach to geodesics based on
Hamiltonian mechanics to the standard one in the following way. Deﬁne the covariant derivative ∇:
X(M) × X(M) →X(M) locally by
(∇XY )(x) = γx(X(x), Y (x)) + DY (x) · X(x),

494
8. Applications
where X(x) and Y (x) are the local representatives of X and Y in the model space E of M and γx : E×E →E
denotes the symmetric bilinear continuous mapping deﬁned by polarization of the quadratic form γ(x, v).
In ﬁnite dimensions, if E = Rn, then γ(x, v) is an Rn-valued quadratic form on Rn determined by the
Christoﬀel symbols Γi
jk. The deﬁning relation for ∇XY becomes
∇XY = XjY kΓi
jk
∂
∂xi + Xj ∂Y k
∂xj
∂
∂xk ,
where locally
X = Xi ∂
∂xi
and
Y = Y k ∂
∂xk .
It is a straightforward exercise to show that the foregoing deﬁnition of ∇XY is chart independent and that
∇satisﬁes the following conditions deﬁning an aﬃne connection:
(i) ∇is R-bilinear,
(ii) for f : M →R smooth,
∇fXY = f∇XY
and
∇XfY = f∇xY + X[f]Y,
(iii) (∇XY −∇Y X)(x) = DY (x) · X(x) −DX(x) · Y (x) = [X, Y ](x),
by the local formula for the Jacobi–Lie bracket of two vector ﬁelds. (The equivalence of sprays and aﬃne
connections was introduced by ?.)
If c(t) is a curve in M and X ∈X(M), the covariant derivative of X along c is deﬁned by
DX
dt
= ∇cX,
where c is a vector ﬁeld coinciding with ˙c(t) at the points c(t). Locally, using the chain rule, this becomes
DX
dt (c(t)) = −γc(t)(X(c(t)), X(c(t))) + d
dtX(c(t)),
which also shows that the deﬁnition of DX/dt depends only on c(t) and not on how ˙c is extended to a vector
ﬁeld. In ﬁnite dimensions, the coordinate form of the preceding equation is
DX
dt
i
= Γi
jk(c(t))Xj(c(t))˙ck(t) + d
dtXi(c(t)),
where ˙c(t) denotes the tangent vector to the curve at c(t).
The vector ﬁeld X is called autoparallel or is parallel-transported along c if DX/dt = 0. Thus ˙c is
autoparallel along c iﬀin any coordinate system we have
¨c(t) −γc(t)(˙c(t), ˙c(t)) = 0
or, in ﬁnite dimensions
¨ci(t) + Γi
jk(c(t))˙cj(t)˙ck(t) = 0.
That is, ˙c is autoparallel along c iﬀc is a geodesic.
There is feedback between Hamiltonian systems and Riemannian geometry. For example, conservation of
energy for geodesics is a direct consequence of their Hamiltonian character but can also be checked directly.
Moreover, the fact that the ﬂow of the geodesic spray on TM consists of canonical transformations is also
useful in geometry, for example, in the study of closed geodesics (cf. Klingenberg [1978]). On the other hand,
Riemannian geometry provides tools and concepts (such as parallel transport and curvature) that are useful
in studying Hamiltonian systems.

8.1 Hamiltonian Mechanics
495
Lagrangian Mechanics.
We now generalize the idea of motion in a potential to that of a Lagrangian
system; these are, however, still special types of Hamiltonian systems. We begin with a manifold M and a
given function L : TM →R called the Lagrangian. In case of motion in a potential, take
L(vx) = 1
2⟨vx, vx⟩−V (x),
which diﬀers from the energy in that −V is used rather than +V.
The Lagrangian L deﬁnes a map called the ﬁber derivative, FL : TM →T ∗M as follows: let v, w ∈TxM,
and set
FL(v) · w ≡d
dtL(v + tw)

t=0
.
That is, FL(v)·w is the derivative of L along the ﬁber in direction w. In the case of L(vx) = (1/2)⟨vx, vx⟩x −
V (x), we see that FL(vx) · wx = ⟨vx, wx⟩x, so we recover the usual map g♭: TM →T ∗M associated with
the bilinear form ⟨, ⟩x.
Since T ∗M carries a canonical symplectic form ω, we can use FL to obtain a closed two-form ωL on TM :
ωL = (FL)∗ω.
A local coordinate computation yields the following local formula for ωL : if M is modeled on a linear space
E, so locally TM looks like U × E where U ⊂E is open, then ωL(u, e) for (u, e) ∈U × E is the skew
symmetric bilinear form on E × E given by
ωL(u, e) · ((e1, e2), (f1, f2))
= D1(D2L(u, e) · e1) · f1 −D1(D2L(u, e) · f1) · e1
+ D2(D2L(u, e) · e1) · f2 −D2(D2L(u, e) · f1) · e2,
(8.1.5)
where D1 and D2 denote the indicated partial derivatives of L. In ﬁnite dimensions this reads
ωL =
∂2L
∂˙qi∂qj dqi ∧dqj +
∂2L
∂˙qi∂˙qj dqi ∧dqi,
where (qi, ˙qj) are the standard local coordinates on TQ.
The two form ωL is (weakly) nondegenerate if D2D2L(u, e) is (weakly) nondegenerate; in this case L is
called (weakly) nondegenerate. In the case of motion in a potential, nondegeneracy of ωL amounts to
nondegeneracy of the metric ⟨, ⟩x. The action of L is deﬁned by A : TM →R, A(v) = FL(v) · v, and the
energy of L is E = A −L. In charts,
E(u, e) = D2L(u, e) · e −L(u, e),
and in ﬁnite dimensions, E is given by the expression
E(q, ˙q) = ∂L
∂qi ˙qi −L(q, ˙q).
Given L, we say that a vector ﬁeld Z on TM is a Lagrangian vector ﬁeld or a Lagrangian system
for L if the Lagrangian condition holds:
ωL(v)(Z(v), w) = dE(v) · w
(8.1.6)
for all v ∈TqM and w ∈Tv(TM). Here dE denotes the diﬀerential of E. We shall see that for motion in a
potential, this leads to the same equations of motion as we found before.
If ωL were a weak symplectic form there would exist at most one such Z, which would be the Hamiltonian
vector ﬁeld for the Hamiltonian E. The dynamics is obtained by ﬁnding the integral curves of Z; that is, the
curves t →v(t) ∈TM satisfying (dv/dt)(t) = Z(v(t)). From the Lagrangian condition it is easy to check
that energy is conserved (even though L may be degenerate).

496
8. Applications
8.1.14 Proposition.
Let Z be a Lagrangian vector ﬁeld for L and let v(t) ∈TM be an integral curve of
Z. Then E(v(t)) is constant in t.
Proof.
By the chain rule,
d
dtE(v(t)) = dE(v(t)) · v′(t)
= dE(v(t)) · Z(v(t)) −ωL(v(t))(Z(v(t)), Z(v(t))) = 0
by skew symmetry of ωL.
■
We now generalize our previous local expression for the spray of a metric, and the equations of motion in
the presence of a potential. In the general case the equations are called Lagrange’s equations.
8.1.15 Proposition.
Let Z be a Lagrangian system for L and suppose Z is a second-order equation (i.e.,
in a chart U × E for TM, Z(u, e) = (u, e, e, Z2(u, e)) for some map Z2 : U × E →E). Then in the chart
U × E, an integral curve (u(t), v(t)) ∈U × E of Z satisﬁes Lagrange’s equations: that is,
du
dt (t) = v(t),
d
dt(D2L(u(t), v(t)) · w = D1L(u(t), v(t)) · w
(8.1.7)
for all w ∈E. If D2D2L, or equivalently ωL, is weakly nondegenerate, then Z is automatically second order.
In case of motion in a potential, equation (8.1.7) reduces to the equations (8.1.4).
Proof.
From the deﬁnition of the energy E we have locally
DE(u, e) · (f1, f2) = D1(D2L(u, e) · e) · f1
+ D2(D2L(u, e) · e) · f2 −D1L(u, e) · f1
(a term D2L(u, e) · f2 has canceled). Locally we may write
Z(u, e) = (u, e, Y1(u, e), Y2(u, e)).
Using formula (8.1.5) for ωL, the condition on Z may be written
D1(D2L(u, e) · Y1(u, e)) · f1 −D1(D2L(u, e) · f1) · Y1(u, e)
+ D2(D2L(u, e) · Y1(u, e)) · f2 −D2(D2L(u, e) · f1) · Y2(u, e)
= D1(D2L(u, e) · e) · f1 −D1L(u, e) · f1
+ D2(D2L(u, e) · e) · f2.
(8.1.8)
Thus if ωL is a weak symplectic form, then D2D2L(u, e) is weakly nondegenerate, so setting f1 = 0 we get
Y1(u, e) = e, that is, Z is a second-order equation. In any case, if we assume that Z is second order, then
condition (8.1.8) becomes
D1L(u, e) · f1 = D1(D2L(u, e) · f1) · e + D2(D2L(u, e) · f1) · Y2(u, e)
for all f1 ∈E. If (u(t), v(t)) is an integral curve of Z and using dots to denote time diﬀerentiation, then
˙u = v and ¨u = Y2(u, ˙u), so
D1L(u, ˙u) · f1 = D1(D2L(u, ˙u) · f1) · ˙u + D2(D2L(u, ˙u) · f1) · ¨u
= d
dtD2L(u, ˙u) · f1
by the chain rule.
■

8.1 Hamiltonian Mechanics
497
The condition of being second order is intrinsic; Z is second order iﬀTτM ◦Z = identity, where τM :
TM →M is the projection. See Exercise 8.1-4.
In ﬁnite dimensions Lagrange’s equations (8.1.7) take the form
dqi
dt = ˙qi,
and
d
dt( ∂L
∂qi ) = ∂L
∂qi ,
i = 1, . . . , n.
8.1.16 Proposition.
Assume ϕ : Q →Q is a diﬀeomorphism which leaves a weakly nondegenerate La-
grangian L invariant, that is, L ◦Tϕ = L. Then c(t) is an integral curve of the Lagrangian vector ﬁeld Z if
and only if Tϕ ◦c is also an integral curve.
Proof.
Invariance of L under ϕ implies FL ◦Tϕ = T ∗ϕ−1 ◦FL so that
(Tϕ)∗ωL = (FL ◦Tϕ)∗ω = (T ∗ϕ−1 ◦FL)∗ω = (FL)∗(T ∗ϕ−1)∗ω
= (FL)∗ω = ωL
by Proposition 8.1.6. We also have for any v ∈TQ,
A(Tϕ(v)) = FL(Tϕ(v)) · Tϕ(v) = FL(v)
and thus relation (8.1.6) implies
dE = (Tϕ)∗dE = (Tϕ)∗iZωL = i(T ϕ)∗Z(Tϕ)∗ωL = i(Tϕ)∗ZωL.
Weak nondegeneracy of L yields then (Tϕ)∗Z = Z which by Proposition 4.2.4 is equivalent to the
statement in the proposition.
■
8.1.17 Example (Geodesics on the Poincar´e Upper Half Plane).
Let
Q =
	
(x, y) ∈R2 | y > 0

so that TQ = Q × R2. Deﬁne the Poincar´e metric g on Q by
g(x, y)((u1, u2), (v1, v2)) = u1v1 + u2v2
y2
and consider the Lagrangian
L(x, y, v1, v2) = (v1)2 + (v2)2
y2
deﬁned by g. L is nondegenerate and thus by Proposition 8.1.15, the Lagrangian vector ﬁeld Z deﬁned by L
is a second order equation. By local existence and uniqueness of integral curves, for every point (x0, y0) ∈Q
and every vector (v1
0, v2
0) ∈T(x,y)Q, there is a unique geodesic γ(t) satisfying γ(0) = (x0, y0), γ′(0) = (v1
0, v2
0).
We shall determine the geodesics of g by taking advantage of invariance properties of L.
Note that the reﬂection r : (x, y) ∈Q →(−x, y) ∈Q leaves L invariant. Furthermore, consider the
homographies h(z) = (az + b)/(cz + d) for a, b, c, d ∈R satisfying ad −bc = 1, where z = x + iy. Since
Im[h(z)] = Im

z
(cz + d)2

,
it follows that h(Q) = Q and since Tzh(v) = v/(cz + d)2, where v = v1 + iv2, it follows that h leaves L
invariant. Therefore, by Proposition ??, γ is a geodesic if and only if r ◦γ and h ◦γ are. In particular, if
γ(0) = (0, y0), γ′(0) = (0, u0), then
(r ◦γ)(0) = (0, y0)
and
(r ◦γ)′(0) = (0, u0),

498
8. Applications
that is, γ = r ◦γ and thus γ is the semiaxis y > 0, x = 0. Since for any q0 ∈Q and tangent vector v0 to
Q at q0 there exists a homography h such that h(iy0) = q0, and the tangent of h at iy0 in the direction iu0
is v0, it follows that the geodesics of g are images by h of the semiaxis { (0, y) | y > 0 }. If c = 0 or d = 0,
this image equals the ray { (b/d, y) | y > 0 } or the ray { (a/c, y) | y > 0 }. If both c ̸= 0, d ̸= 0, then the
image equals the arc of the circle centered at ((ad + bc)/2cd, 0) of radius 1/(2cd). Thus the geodesics of the
Poincar´e upper half plane are either rays parallel to the y-axis or arcs of circles centered on the x-axis. (See
Figure 8.1.1.) The Poincar´e upper half-plane is a model of the Lobatchevski geometry. Two geodesics in Q
are called parallel if they do not intersect in Q. Given either a ray parallel to Oy or a semicircle centered
on Ox and a point not on this geodesic, there are inﬁnitely many semicircles passing through this point and
not intersecting the geodesics, that is, through a point not on a geodesic there are inﬁnitely many geodesics
parallel to it.
♦
y
x
Figure 8.1.1. Geodesics in the Poincar´e upper half plane.
We close with a result for Lagrangian systems generalizing Example 4.1.23B.
8.1.18 Deﬁnition.
A C2 function V0 : [0, ∞] →R is called positively complete if it is decreasing and
for any e > supi≥0{V0(t)}, satisﬁes
 ∞
x
[e −V0(t)]−1/2dt = +∞,
where x ≥0.
The last condition is independent of e. Examples of positively complete functions are −tα, −t[log(1+t)]α,
−t log(1 + t)[ log(log(1 + t) + 1)]α, etc.
8.1.19 Theorem ( ?).
Let Q be a complete weak Riemannian manifold, V : Q →R be a C2 function and
let Z be the Lagrangian vector ﬁeld for
L(v) = 1
2∥v∥2 −V (τ(v)),
where τ : TQ →Q is the tangent bundle projection. Suppose there is a positively complete function v0 and
a point q′ ∈Q such that V (q) ≥V0(d(q, q′)) for all q ∈Q. Then Z is complete.
Proof.
Let c(t) be an integral curve of Z and let q(t) = (τ ◦c)(t) be its projection in Q. Let q0 = q(0) and
consider the diﬀerential equation on R
f ′′(t) = −dV0
df (f(t))
(8.1.9)
with initial conditions f(0) = d(q′, q0), f ′(0) =

2(β −V0(f(0))), where
β = E(c(t)) = E(c(0)) ≥V (q0).

8.1 Hamiltonian Mechanics
499
We can assume β > V (q0), for if β = V (q0), then ˙q(0) = 0; now if ˙q(t) = 0, the conclusion is trivially
satisﬁed, so we need to work under the assumption that there exists a t0 for which ˙q(t0) ̸= 0; by time
translation we can assume t0 = 0.
We show that the solution f(t) of equation (8.1.9) is deﬁned for all t ≥0. Multiplying both sides of
equation (8.1.9) by f ′(t) and integrating yields
1
2f ′(t)2 = β −V0(f(t)),
that is,
t(s) =
 s
d(q′,q0)
[2(β −V0(u))]−1/2du.
By hypothesis, the integral on the right diverges and hence t(s) →+∞as s →+∞. This shows that f(t)
exists for all t ≥0.
For t ≥0, conservation of energy and the estimate on the potential V imply
d(q(t), q′) ≤d(q(t), q0) + d(q0, q′) ≤d(q′, q0) +
 t
0
∥˙q(s)∥ds
= d(q′, q0) +
 t
0
[2(β −V0(q(s))]1/2ds
≤d(q′, q0) +
 t
0
[2(β −V0(d(q(s)), q′))]1/2ds.
Since
f(t) = d(q′, q0) +
 1
0
[2(β −V0(f(s))]1/2ds,
it follows that d(q(t), q′) ≤f(t); see Exercise 4.1-9(v) or the reasoning in Example 4.1.23B plus an approx-
imation of d(q(t), q′) by C1 functions. Hence if Q is ﬁnite dimensional, q(t) remains in a compact set for
ﬁnite t-intervals, t ≥0. Therefore c(t) does as well, V (q(t)) being bounded below on such a ﬁnite t-interval.
Proposition 4.1.19 implies that c(t) exists for all t ≥0. The proof in inﬁnite dimensions is done in Supple-
ment 8.1C. If Ft is the local ﬂow of Z, from τ(F−t(v)) = τ(Ft(−v)) (reversibility), it follows that c(t) exists
also for all t ≤0 and so the theorem is proved.
■
Supplement 8.1C
Completeness of Lagrangian Vector Fields on Hilbert Manifolds
This supplement provides the proof of Theorem ?? for inﬁnite dimensional Riemannian manifolds. We start
Thm. 8.1.19?
with a few facts of general interest.
Let (Q, g) be a Riemannian manifold and τ : TQ →Q the tangent bundle projection. For v ∈TqQ, the
subspace
Vv = ker Tvτ = Tv(TqQ) ⊂Tv(TQ)
is called the vertical subspace of Tv(TQ). The local expression of the covariant derivative ∇deﬁned by
g in Supplement 8.1B shows that ∇Y X depends only on the point values of Y and thus it deﬁnes a linear
map
(∇X)(q) : v ∈TqQ →(∇Y X)(q) ∈TqQ,

500
8. Applications
where Y ∈X(Q) is any vector ﬁeld satisfying Y (q) = v. Let jv : TqQ →Tv(TqQ) = Vv denote the
isomorphism identifying the tangent space to a linear space with the linear space itself and consider the map
jv ◦(∇X)(q) : TqQ →Vv. Deﬁne the horizontal map hv : TqQ →Tv(TQ) by
hv = TqX −jv ◦(∇X)(q)
where v ∈TqQ and X ∈X(Q) satisﬁes X(q) = v. Locally, if E is the model of Q, hv has the expression
hv : (x, u) ∈U × E →(x, v, u −γx(u, v)) ∈U × E × E × E.
This shows that hv is a linear continuous injective map with split image. The image of hv is called the
horizontal subspace of Tv(TQ) and is denoted by Hv. It is straightforward to check that Tv(TQ) = Vv⊕Hv
and that
Tvτ|Hv : Hv →TqQ,
jv : TqQ →Vv
are Banach space isomorphisms. Declaring them to be isometries and Hv perpendicular to Vv gives a metric
gT on TQ. We have proved that if (Q, q) is a (weak) Riemannian manifold, then g induces a metric gT on
TQ1. The following result is taken from Ebin [1970].
8.1.20 Proposition.
If (Q, g) is a complete (weak) Riemannian manifold then so is (TQ, gT ).
Proof.
Let {vn} be a Cauchy sequence in TQ and let qn = τ(vn). Since τ is distance decreasing it follows
that {qn} is a Cauchy sequence in Q and therefore convergent to q ∈Q by completeness of Q. If E is the
model of Q, E is a Hilbert space, again by completeness of Q. Let (U, ϕ) be a chart at q and assume that U is
a closed ball in the metric deﬁned by g of radius 3ϵ. Also, assume that TvTϕ : Tv(TM) ∈E×E is an isometry
for all v →TqQ which implies that for ϵ small enough there is a C > 0 such that ∥TTϕ(w)∥≤C∥w∥for all
w ∈TTU. This means that all curves in TU are stretched by Tϕ by a factor of C. Let V ⊂U be the closed
ball of radius ϵ centered at q and let n,m be large enough so the distance between vn and vm is smaller
than ϵ and vn, vm ∈TV. If γ is a path from vn to vm of length < 2ϵ, then τ ◦γ is a path from qn to qm of
length < 2ϵ and therefore τ ◦γ ⊂U, which in turn implies that γ ⊂TU. Moreover, Tϕ ◦γ has length < 2Cϵ
and therefore the distance between Tϕ(vn) and Tϕ(vm) in E is at most 2Cϵ. This shows that {Tϕ(vn)} is
a Cauchy sequence in E and hence convergent. Since Tϕ is a diﬀeomorphism, {vn} is convergent.
■
In general, completeness of a vector ﬁeld on M implies completeness of the ﬁrst variation equation on
TM.
Proof of Theorem 8.1.19 in inﬁnite dimensions.
Let c : ]a, b[ →TQ be a maximal integral curve of
Z. We shall prove that limt↑b c(t) exists in TQ which implies, by local existence and uniqueness, that c can
be continued beyond b, that is, that b = +∞. One argues similarly for a. We have shown that q(t) = (τ ◦c)(t)
is bounded on ﬁnite t-intervals. Since V (q(t)) is bounded on such a ﬁnite t-interval, it follows that ˙q(t) = c(t)
is bounded in the metric deﬁned by gT on TQ. By the mean value inequality it follows that if tn ↑b, then
{q(tn)} is a Cauchy sequence and therefore convergent since Q is complete.
Next we show by the same argument that if tn ↑b, then {c(tn)} is Cauchy, that is, we will show that ˙c(t)
is bounded on bounded t-intervals. Write ˙c(t) = Z(c(t)) = S(c(t)) + V (c(t)), where S is the spray of g and
represents the horizontal part of Z and V is the vertical part of Z. Since V (c(t)) depends only on q(t) and
since q(t) extends continuously to q(b), it follows that ∥V (c(t))∥is bounded as t ↑b. Since
∥S(c(t))∥= ∥c(t)∥
and
∥˙c(t)∥2 = ∥S(c(t))∥2 + ∥V (c(t))∥2
by the deﬁnition of the metric gT , it follows that ∥˙c(t)∥remains bounded on ﬁnite t-intervals. Therefore
{c(tn)} is Cauchy and Proposition 8.1.20 implies that c(t) can be continuously extended to c(b).
■
1Sometimes this metric is called the Sasaki metric.

8.1 Hamiltonian Mechanics
501
Remark.
Note that completeness of Q, an estimate on the potential V , and conservation of the energy
E, replaces “compactness” in Proposition 4.1.19 with “boundedness.”
♦
Exercises
⋄8.1-1.
Let (M, ω) be a symplectic manifold with ω = dθ and f : M →M a local diﬀeomorphism. Prove
that f is a symplectic iﬀfor every compact oriented two-manifold B with boundary, B ⊂M, we have

∂B
θ =

f(∂B)
θ.
⋄8.1-2 (J. Moser).
Use the method of proof of Darboux theorem to prove that if M is a compact manifold,
µ and ν are two volume forms with the same orientation, and

µ =

ν,
then there is a diﬀeomorphism f : M →M such that f ∗ν = µ.
Hint: Use the Lie transform method. Since

µ =

ν,
µ −ν = dα
(see Supplement 7.5B); put νt = tν + (1 −t)µ and deﬁne Xt by letting the interior product of Xt with νt be
α. Let ϕt be the ﬂow of Xt and set f = ϕ1.
⋄8.1-3.
On T ∗R3, consider the periodic three-dimensional Toda lattice Hamiltonian,
H(q, p) = 1
2∥p∥2 + eq1−q2 + eq2−q3 + eq3−q1.
(i) Write down Hamilton’s equations.
(ii) Show that
f1(q, p) = p1 + p2 + p3, f2 = H, and
f3(q, p) = 1
3(p3
1 + p3
2 + p3
3) + p1(exp(q1 −q2) + exp(q3 −q1))
+ p2(exp(q1 −q2) + exp(q2 −q3))
+ p3(exp(q1 −q2) + exp(q2 −q3))
are in involution and are independent everywhere.
(iii) Prove the same thing for
g1 = f1,
g2(q, p) = exp(q1 −q2) + exp(q2 −q3) + exp(q3 −q1),
and
g3(q, p) = p1p2p3 −p1 exp(q2 −q3) −p2 exp(q3 −q1)
−p3 exp(q1 −q2).

502
8. Applications
(iv) Can you establish (iii) without explicitly computing the Poisson brackets?
Hint: Express g1, g2, g3 as polynomials of f1, f2, f3.
⋄8.1-4.
A second-order equation on a manifold M is a vector ﬁeld X on TM such that TτM ◦X = IdT M .
Show that
(i) X is a second-order equation iﬀfor all integral curves c of X in TM we have (τM ◦c)′ = c. One calls
τM ◦c a base integral curve.
(ii) X is a second-order equation iﬀin every chart the local representative of X has the form (u, e) →
(u, e, e, V (u, e)).
(iii) If M is ﬁnite dimensional and X is a second-order equation, then the base integral curves satisfy
d2x(t)
dt2
= V (x(t), ˙x(t)),
where (x, ˙x) denotes standard coordinates on TM.
⋄8.1-5 (Noether theorem).
Prove the following result for Lagrangian systems.
Theorem.
Let Z be a Lagrangian vector ﬁeld for L : TM →R and suppose Z is a second-order equation.
Let Φt be a one-parameter group of diﬀeomorphisms of M generated by the vector ﬁeld Y : M →TM. Suppose
that for each real number t, L◦TΦt = L. Then the function P(Y ) : TM →R, deﬁned by P(Y )(v) = FL(v)·Y
is constant along integral curves of Z .
⋄8.1-6.
Use Exercise 8.1-5 to show conservation of linear (resp., angular) momentum for the motion of a
particle in R3 moving in a potential that has a translation (resp., rotational) symmetry.
⋄8.1-7.
Consider R2n+2 with coordinates (q1, . . . , qn, E, p1, . . . , pn, t) and deﬁne the symplectic form
ω = dqi ∧dpi + dE ∧dt.
Consider the function P(q, p, E, t) = H(q, p, t) −E. Show that the vector ﬁeld
X = ˙qi ∂
∂qi + ˙pi
∂
∂pi
+ ˙E ∂
∂t + ˙t ∂
∂E
deﬁned by iXω = dP reproduces familiar equations for ˙q, ˙p, ˙t and ˙E.
⋄8.1-8.
Show that the wave equation (see Supplement 8.1A) may be derived as a Lagrangian system.
⋄8.1-9.
Refer to Example 8.1.13 on the Schr¨odinger equation. Let A and B be self adjoint operators on H
and let fA : H →R be given by fA(ψ) = ⟨ψ, Aψ⟩(the expectation value of A in the state ψ). Show that
Poisson brackets and commutators are related by
fi[A,B] = {fA, fB}.
⋄8.1-10.
Show that the geodesic ﬂow of a compact Riemannian manifold is complete. (Warning: Compact
pseudo-Riemannian manifolds need not be complete; see ? and Marsden [1973].)
⋄8.1-11.
Show that any isometry of a weak pseudo-Riemannian manifold maps geodesics to geodesics. (A
map ϕ : Q →Q is called an isometry if ϕ∗g = g, where g is the weak pseudo-Riemannian metric on Q.)
⋄8.1-12.
Let (Q, g) be a weak Riemannian manifold.
(i) If Ft is the ﬂow of the spray of g show that τ(Ft(sv)) = τ(Fst(v)), where τ : TQ →Q is the projection.

8.2 Fluid Mechanics
503
(ii) Let U be any bounded set in TqQ. Show that there is an ϵ > 0 such that for any v ∈U, the integral
curve of the spray with initial condition v exists for a time ≥ϵ.
Hint: Let V ⊂U be an open neighborhood of v such that all integral curves starting in V exist for
time ≥δ. Find R > 0 such that R−1U ⊂V and use (i).
⋄8.1-13.
A weak pseudo-Riemannian manifold (Q, g) is called homogeneous if for any x, y ∈Q there is an
isometry ϕ such that ϕ(x) = y. Show that homogeneous weak Riemannian manifolds are complete by using
Exercises 8.1-11 and 8.1-12.
Hint: Put the initial condition v in a ball B and choose ϵ as in Exercise 8.1-12(ii). Let v(t) be the integral
curve of S through v and let q(t) be the corresponding geodesic. The geodesic starting at q(ϵ) in the direction
v(ϵ), is ϕ applied to the geodesic through q = τ(v) in the direction Tϕ−1(v)(ϵ); ϕ is the isometry sending q
to q(ϵ). The latter geodesic lies in the ball B, so it exists for time ≥ϵ.
8.2
Fluid Mechanics
We present a few of the basic ideas concerning the motion of an ideal ﬂuid from the point of view of manifolds
and diﬀerential forms. This is usually done in the context of Euclidean space using vector calculus. For the
latter approach and additional details, the reader should consult one of the standard texts on the subject
such as Batchelor [1967], Chorin and Marsden [1993], or Gurtin [1981]. The use of manifolds and diﬀerential
forms can give additional geometric insight.
The present section is for expository reasons somewhat superﬁcial and is intended only to indicate how to
use diﬀerential forms and Lie derivatives in ﬂuid mechanics. Once the basics are understood, more sophisti-
cated questions can be asked, such as: in what sense is ﬂuid mechanics an inﬁnite-dimensional Hamiltonian
system? For the answer, see Arnol’d [1982], Abraham and Marsden [1978], Marsden and Weinstein [1983],
and ?. For analogous topics in elasticity, see Marsden and Hughes [1983], and for plasmas, see §8.4 and
Marsden and Weinstein [1982].
Let M be a compact, oriented ﬁnite-dimensional Riemannian n-manifold, possibly with boundary. Let the
Riemannian volume form be denoted µ ∈Ωn(M), and the corresponding volume element dµ. Usually M
is a bounded region with smooth boundary in two- or three-dimensional Euclidean space, oriented by the
standard basis, and with the standard Euclidean volume form and inner product.
Imagine M to be ﬁlled with ﬂuid and the ﬂuid to be in motion. Our object is to describe this motion. Let
x ∈M be a point in M and consider the particle of ﬂuid moving through x at time t = 0. For example, we
can imagine a particle of dust suspended in the ﬂuid; this particle traverses a trajectory which we denote
ϕt(x) = ϕ(x, t). Let u(x, t) denote the velocity of the particle of ﬂuid moving through x at time t. Thus, for
each ﬁxed time, u is a vector ﬁeld on M. See Figure 8.2.1. We call u the velocity ﬁeld of the ﬂuid. Thus
the relationship between u and ϕt is
dϕt(x)
dt
= u(ϕt(x), t);
that is, u is a time-dependent vector ﬁeld with evolution operator ϕt in the same sense as was used in §4.1.
For each time t, we shall assume that the ﬂuid has a well-deﬁned mass density and we write ρt(x) = ρ(x, t).
Thus if W is any subregion of M, we assume that the mass of ﬂuid in W at time t is given by
m(W, t) =

W
ρt dµ.
Our derivation of the equations is based on three basic principles, which we shall treat in turn:
1. Mass is neither created nor destroyed.
2. (Newton’s second law) The rate of change of momentum of a portion of the ﬂuid equals the force
applied to it.

504
8. Applications
3. Energy is neither created nor destroyed.
M
x
ϕt(x)
u(ϕt(x),t)
trajectory of
fluid particle
moving through
x at time t=t
Figure 8.2.1. The trajectory of a ﬂuid particle
1. Conservation of mass.
This principle says that the total mass of the ﬂuid, which at time t = 0
occupied a nice region W, remains unchanged after time t; that is,

ϕt(W )
ρt dµ =

W
ρ0 dµ.
(We call a region W “nice” when it is an open subset of M with smooth enough boundary to allow us to use
Stokes’ theorem.) Let us recall how to use the transport theorem 7.1.12 to derive the continuity equation.
Using the change-of-variables formula, conservation of mass may be rewritten as

W
ϕ∗
t (ρtµ) =

W
ρ0µ
for any nice region W in M, which is equivalent to
ϕ∗
t (ρtµ) = ρ0µ,
or
(ϕ∗
t ρt)J(ϕt) = ρ0,
where J(ϕt) is the Jacobian of ϕt. This in turn is equivalent to
0 = d
dtϕ∗
t (ρt, µ) = ϕ∗
t

£u(ρt, µ) + ∂ρ
∂t µ

= ϕ∗
t

u[ρt] + ρt div u + ∂ρ
∂t

µ

= ϕ∗
t

div(ρtu) + ∂ρ
∂t

µ

by the Lie derivative formula and Proposition 6.5.17. Thus
∂ρ
∂t + div(ρtu) = 0
is the diﬀerential form of the law of conservation of mass, also known as the continuity equation.
Because of shock waves that could be present, ρ and u may not be smooth enough to justify the steps
leading to the diﬀerential form of this law; the integral form will then be the one to use. Also note that the
Riemannian metric has as yet played no role; only the volume element of M was needed.

8.2 Fluid Mechanics
505
2. Balance of momentum.
Newton’s second law asserts that the rate of change of momentum of a
portion of the ﬂuid equals the total force applied to it. To see how to apply this principle on a general
manifold, let us discuss the situation M ⊂R3 ﬁrst. Here we follow the standard vector calculus conventions
and write the velocity ﬁelds in boldface type. The momentum of a portion of the ﬂuid at time t that at time
t = 0 occupied the region W is

ϕt(W )
ρu dµ.
Here and in what follows the integral is R3-valued, so we apply all theorems on integration componentwise.
For any continuum, forces acting on a piece of material are of two types. First there are forces of stress,
whereby the piece of material is acted on by forces across its surface by the rest of the continuum. Second,
there are external, or body forces, such as gravity or a magnetic ﬁeld, which exert a force per unit volume
on the continuum. The clear formulation of surface stress forces in a continuum is usually attributed to
Cauchy. We shall assume that the body forces are given by a given force density b, that is, the total body
forces acting on W are

W ρb dµ. In continuum mechanics the forces of stress are assumed to be of the form

∂W σ(x, t) · n da, where da is the induced volume element on the boundary, n is the outward unit normal,
and σ(x, t) is a time-dependent contravariant symmetric two-tensor, called the Cauchy stress tensor. The
contraction σ(t, x)·n is understood in the following way: if σ has components σij and n has components nk,
then σ ·n is a vector with components (σ ·n)i = gjkσijnk, where g is the metric (in our case gjk = δjk). The
vector σ ·n, called the Cauchy traction vector, measures the force of contact (per unit area orthogonal to
n) between two parts of the continuum. (A theorem of Cauchy states that if one postulates the existence of
a continuous Cauchy traction vector ﬁeld T(x, t, n) satisfying balance of momentum, then it must be of the
form σ · n, for a two-tensor, σ; moreover if balance of moment of momentum holds, σ must be symmetric.
See Chorin and Marsden [1993], Gurtin [1981], or Marsden and Hughes [1983] for details.) Balance of
momentum is said to hold when
d
dt

ϕt(W )
ρu dµ =

ϕt(W )
ρb dµ +

∂ϕt(W )
σ · n da
for any nice region W in M = R3. If div σ denotes the vector with components (div(σ1i), div(σ2i), div(σ3i)),
then by Gauss’ theorem

∂ϕt(W )
σ · n da =

ϕt(W )
(div σ)dµ.
By the change-of-variables formula and Lie derivative formula, we get
d
dt

ϕt(W )
ρuidµ =

W
d
dtϕ∗
t (ρuidµ)
=

ϕt(W )
∂(ρui)
∂t
+ (£uρ)ui + ρ£uui + ρui div u

dµ,
so that the balance of momentum is equivalent to
∂ρ
∂t ui + ρ∂ui
∂t + (dρ · u)ui + ρ£uui + ρui div u = ρbi + (div σ)i.
But dρ·u+ρ div u = div(ρu) and by conservation of mass, ∂ρ/∂t+div(ρu) = 0. Also, £uui = (∂ui/∂xj)uj =
(u · ∇)ui, so we get
∂u
∂t + (u · ∇)u = b + 1
ρ div σ,

506
8. Applications
which represents the basic equations of motion. Here the quantity ∂u/∂t +(u · ∇)u is usually called the
material derivative and is denoted by Du/dt. These equations are for any continuum, be it elastic or
ﬂuid.
An ideal ﬂuid is by deﬁnition a ﬂuid whose Cauchy stress tensor σ is given in terms of a function p(x, t)
called the pressure, by σij = −pgij. In this case, balance of momentum in diﬀerential form becomes the
Euler equations for an ideal ﬂuid:
∂u
∂t + (u · ∇)u = b −1
ρ grad p.
The assumption on the stress σ in an ideal ﬂuid means that if S is any ﬂuid surface in M with outward unit
normal n, then the force of stress per unit area exerted across a surface element S at x with normal n at
time t is −p(x, t)n (see Figure 8.2.2).
n
force across S
is  –pn
S
Figure 8.2.2. The stress in an ideal ﬂuid is given by the pressure
Let us return to the context of a Riemannian manifold M. First, it is not clear what the vector-valued
integrals should mean. But even if we could make sense out of this, using, say parallel transport, there is
a more serious problem with the integral form of balance of momentum as stated. Namely, if one changes
coordinates, then balance of momentum does not look the same. One says that the integral form of balance
of momentum is not covariant. Therefore we shall concentrate on the diﬀerential form and from now on we
shall deal only with ideal ﬂuids. (For a detailed discussion of how to formulate the basic integral balance
laws of continuum mechanics covariantly, see Marsden and Hughes [1983]. A genuine diﬃculty with shock
wave theory is that the notion of weak solution is not a coordinate independent concept.)
Rewrite Euler’s equations in R3 with indices down; that is, take the ﬂat of these equations. Then the i-th
equation, i = 1, 2, 3 is
∂ui
∂t + u1
∂ui
∂x1 + u2
∂ui
∂x2 + u3
∂ui
∂x3 = bi −1
ρ
∂p
∂xi .
We seek an invariant meaning for the sum of the last three terms on the left-hand side. For ﬁxed i this
expression is
uj
∂ui
∂xj = uj
∂ui
∂xj + uj
∂uj
∂xi −uj
∂uj
∂xi = (£uub)i −
1
2d∥u∥2

i
.

8.2 Fluid Mechanics
507
That is, Euler’s equations can be written in the invariant form
∂u♭
∂t + £uu♭−1
2d(u♭(u)) = −1
ρdp + b♭.
We postulate this equation as the balance of momentum in M for an ideal ﬂuid. The reader familiar with
Riemannian connections (see Supplement 8.1B) can prove that this form is equivalent to the form
∂u
∂t + ∇uu = −1
ρ grad p + b
by showing that
£uu♭= (∇uu)♭+ 1
2d(u♭(u)).
where ∇uu is the covariant derivative of u along itself, with ∇the Riemannian connection given by g.
The boundary conditions that should be imposed come from the physical signiﬁcance of ideal ﬂuid: namely,
no friction should exist between the ﬂuid and ∂M; that is, u is tangent to ∂M at points of ∂M. Summarizing,
the equations of motion of an ideal ﬂuid on a compact Riemannian manifold M with smooth boundary ∂M
and outward unit normal n are
∂u♭
∂t + £uu♭−1
2d(u♭(u)) = −1
ρdp + b♭
and
∂ρ
∂t + div(ρu) = 0.
We also have the boundary conditions
u∥∂M,
that is,
u · n = on ∂M;
and initial conditions
u(x, 0) = u0(x)
given on M.
We shall assume b = 0 from now on for simplicity.
3. Conservation of energy.
A basic problem of ideal ﬂuid dynamics is to solve the initial-boundary-
value problem. The unknowns are u, ρ, and p, that is, n + 2 scalar unknowns. We have, however, only n + 1
equations. Thus one might suspect that to specify the ﬂuid motion, one more equation is needed. This is in
fact true and the law of conservation of energy will supply the necessary extra equation in ﬂuid mechanics.
(The situation is similar for general continua; see Marsden and Hughes [1983].)
For a ﬂuid moving in M with velocity ﬁeld u, the kinetic energy of the ﬂuid is
Ekinetic = 1
2

M
ρ∥u∥2dµ
where ∥u∥2 = ⟨u, u⟩is the square length of the vector function u. We assume that the total energy of the
ﬂuid can be written
Etotal = Ekinetic + Einternal,
where Einternal is the energy that relates to energy we cannot “see” on a macroscopic scale and derives from
sources such as intermolecular potentials and molecular vibrations. If energy is pumped into the ﬂuid or if
we allow the ﬂuid to do work, Etotal will change. We describe two particular examples of energy equations
that are useful.

508
8. Applications
A.
Assume that Einternal = constant. Then we ought to have Ekinetic as a constant of the motion; that is,
d
dt(1
2

M
ρ∥u∥2dµ) = 0.
To deal with this equation it is convenient to use the following.
8.2.1 Theorem (Transport Theorem with Mass Density).
Let f be a time-dependent smooth function on
Can’t break.
M. Then if W is any (nice) open set in M,
d
dt

ϕt(W )
ρf dµ =

ϕt(W )
ρDf
dt dµ,
where Df/dt = ∂f/∂t + £uf.
Proof.
By the change of variables formula, the Lie derivative formula, div(ρu) = u[ρ] + ρ div(u), and
conservation of mass, we have
d
dt

ϕt(W )
ρf dµ = d
dt

W
ϕ∗
t (ρfµ) =

W
ϕ∗
t
∂(ρf)
∂t
µ + £u(ρfµ)

=

ϕt(W )
∂ρ
∂t fµ + ρ∂f
∂t µ + u[ρ]fµ + ρ(£uf)µ + ρ£uµ

=

ϕt(W )
∂ρ
∂t + u[ρ] + ρ div u

fµ + ρ
∂f
∂t + £uf

µ

=

ϕt(W )

f
∂ρ
∂t + div(ρu)

+ ρ
∂f
∂t + £uf

µ
=

ϕt(W )
ρ
∂f
∂t + £uf

µ.
■
Making use of
£u

∥u∥2
= £u

u♭(u)

=

£uu♭
(u) = d

u♭(u)

(u),
the transport lemma, and Euler’s equations, we get
0 = d
dt
1
2

M
ρ∥u∥2dµ

= 1
2

M
ρ
∂∥u∥2
∂t
+ £u∥u∥2

dµ
=

M
ρ∂u♭
∂t · u dµ + 1
2

M
(£uu♭) · u dµ
=

M
ρ∂u♭
∂t · u dµ +

M
ρ(£uu♭) · u dµ −1
2

M
ρd(u♭(u)) · u dµ
= −

M
dp · u dµ =

M
{(div u)pµ −£u(pµ)} (by the Leibniz rule for £u)
=

M
{(div u)pµ −d(iupµ)} =

M
(div u)pµ.
The last equality is obtained by Stokes’ theorem and the boundary conditions 0 = (u · n)da = iuµ. If we
imagine this to hold for the same ﬂuid in all conceivable motions, we are forced to postulate one of the
additional equations
div u = 0
or
p = 0.

8.2 Fluid Mechanics
509
The case div u = 0 is that of an incompressible ﬂuid. Thus in this case the Euler equations are
∂u♭
∂t + £uu♭−1
2d∥u∥2 = −1
ρdp
∂ρ
∂t + div(ρu) = 0
div u = 0
with the boundary condition iuµ = 0 on ∂M and initial condition u(x, 0) = u0(x). The case p = 0 is also
possible but is less interesting.
For a homogeneous incompressible ﬂuid, with constant density ρ, Euler’s equations can be reformulated
in terms of the Hodge decomposition theorem (see §7.5). Nonhomogeneous incompressible ﬂow requires a
weighted Hodge decomposition (see Marsden [1976]). Recall that any one–form α can be written in a unique
way as α = dβ + γ, where δγ = 0. Deﬁne the linear operator
P : Ω1(M) →
	
γ ∈Ω1(M) | δγ = 0

by
P(α) = γ.
We are now in a position to reformulate Euler’s equations. Let Ω1
δ=0 be the set of C∞one-forms γ with
δγ = 0 and γ tangent to ∂M; that is, ∗γ|∂M = 0. Let T : Ω1
δ=0 →Ω1
δ=0 be deﬁned by
T(u♭) = P(£uu♭).
Thus Euler’s equations can be written as ∂u♭/∂t + T(u♭) = 0, which is in the “standard form” for an
evolution equation. Note that T is nonlinear. Another important feature of T is that it is nonlocal; this is
because P(α)(x) depends on the values of a on all of M and not merely those in the neighborhood of x ∈M.
♦
B.
We postulate an internal energy over the region W to be of the form
Einternal =

W
ρw dµ,
where the function w is the internal energy density per unit mass.
We assume that energy is balanced in the sense that the rate of change of energy in a region equals the
work done on it:
d
dt

ϕt(W )
1
2∥u∥2dµ +

ϕt(W )
ρw dµ

= −

∂ϕt(W )
pu · n da.
By the transport theorem and arguing as in our previous results, this reduces to
0 =

ϕt(W )

p div u + ρDw
dt

dµ.
Since W is arbitrary,
p div u + ρDw
dt = 0.
Now assume that w depends on the ﬂuid motion through the density; that is, the internal energy depends
only on how much the ﬂuid is compressed. Such a ﬂuid is called ideal isentropic or barotropic. The
preceding identity then becomes
0 = p div u + ρ
∂w
∂t + dw · u

= p div u + ρ∂w
∂ρ
∂ρ
∂t + ρ∂w
∂ρ dρ · u
= p div u + ρ∂w
∂ρ (−ρ div u)

510
8. Applications
using the equation of continuity. Since this is an identity and we are not restricting div u, we get
p = ρ2w′(ρ).
If p is a given function of ρ note that w = −

p d(1/ρ). In addition, dp/ρ = d(w + p/ρ). This follows from
p = ρ2w′ by a straightforward calculation in which p and w are regarded as functions of ρ. The quantity
w + p/ρ = w + ρw′ is called the enthalpy and is often denoted h.
Thus Euler’s equations for compressible ideal isentropic ﬂow are
∂u♭
∂t + £uu♭−1
2d(u♭(u)) + dp
ρ = 0,
∂ρ
∂t + div(ρu) = 0,
u(x, 0) = u0(x) on M
and
u · n = 0 on ∂M.
where p = ρ2w′(ρ) is a function of ρ, called an equation of state, which depends on the particular ﬂuid.
It is known that these equations lead to a well-posed initial value problem (i.e., there is a local existence
and uniqueness theorem) only if p′(ρ) > 0. This agrees with the common experience that increasing the
surrounding pressure on a volume of ﬂuid causes a decrease in occupied volume and hence an increase in
density. Many gases can often be viewed as satisfying our hypotheses, with p = Aργ where A and γ are
constants and γ ≥1.
♦
Cases A and B above are rather opposite. For instance, if ρ = ρ0 is a constant for an incompressible ﬂuid,
then clearly p cannot be an invertible function of ρ. However, the case ρ = constant may be regarded as a
limiting case p′(ρ) →∞. In Case B, p is an explicit function of ρ. In Case A, p is implicitly determined by
the condition div u = 0. Finally, notice that in neither Case A or B is the possibility of a loss of total energy
due to friction taken into account. This leads to the subject of viscous ﬂuids, not dealt with here.
Given a ﬂuid ﬂow with velocity ﬁeld u(x, t), a streamline at a ﬁxed time t is an integral curve of u; that
is, if x(s) is a streamline parameterized by s at the instant t, then x(s) satisﬁes
dx
ds = u(x(s), t),
t ﬁxed.
On the other hand, a trajectory is the curve traced out by a particle as time progresses, as explained at
the beginning of this section; that is, is a solution of the diﬀerential equation
dx
dt = u(x(t), t)
with given initial conditions. If u is independent of t (i.e., ∂u/∂t = 0), then, streamlines and trajectories
coincide. In this case, the ﬂow is called stationary or steady. This condition means that the “shape” of
the ﬂuid ﬂow is not changing. Even if each particle is moving under the ﬂow, the global conﬁguration of the
ﬂuid does not change. The following criteria for steady solutions for homogeneous incompressible ﬂow is a
direct consequence of Euler’s equations, written in the form ∂u♭/∂t + P(£uu♭) = 0, where P is the Hodge
projection to the co-closed 1-forms.
8.2.2 Proposition.
Let ut be a solution to the Euler equations for homogeneous incompressible ﬂow on a
compact manifold M and ϕt its ﬂow. The following are equivalent:
(i) ut is a steady ﬂow (i.e., (∂u/∂t) = 0).
(ii) ϕt is a one-parameter group: ϕt+s = ϕt ◦ϕs.
(iii) £u0u♭
0 is an exact 1-form.

8.2 Fluid Mechanics
511
(iv) iu0du♭
0 is and exact 1-form.
It follows from (iv) that if u0 is a harmonic vector ﬁeld; that is, u0 satisﬁes δu♭
0 = 0 and du♭
0 = 0, then
it yields a stationary ﬂow. Also, it is known that there are other steady ﬂows. For example, on a closed
two-disk, with polar coordinates (r, θ), u = f(r)(∂/∂θ) is the velocity ﬁeld of a steady ﬂow because
(u · ∇)u = −∇p,
where p(r, θ) =
 r
0
f 2(s)s ds.
Clearly such a u need not be harmonic.
We saw that for compressible ideal isentropic ﬂow, the total energy

M
∥u∥2
2
+ ρw

dµ
is conserved. We can reﬁne this a little for stationary ﬂows as follows.
8.2.3 Theorem (Bernoulli’s Theorem).
For stationary compressible ideal isentropic ﬂow, with p a func-
tion of ρ,
1
2∥u∥2 +
 dp
ρ = 1
2∥u∥2 + w + p
ρ
is constant along streamlines where the enthalpy

dp/ρ = w + p/ρ denotes a potential for the one form
dp/ρ. The same holds for stationary homogeneous (ρ = constant in space = ρ0) incompressible ﬂow with

dp/ρ replaced by p/ρ0. If body forces deriving from a potential U are present, that is, b♭= −dU, then the
conserved quantity is
1
2∥u∥2 +
 dp
ρ = 1
2∥u∥2 + w + p
ρ + U.
Proof.
Since £u(u♭) · u = d(u♭(u)) · u, for stationary ideal compressible or incompressible homogeneous
ﬂows we have
0 = ∂u♭
∂t · u = −(£uu♭) · u + 1
2d(u♭) · u −dp
ρ · u
= −1
2(d∥u∥2) · u −1
ρdp · u,
so that
1
2∥u∥2 +
 dp
ρ

x(s2)
x(s1)
=
 s2
s1
d
1
2∥u∥2 +
 dp
ρ · u

· x′(s)ds
=
 s2
s1
∂u♭
∂s · u(x(s))ds = 0
since x′(s) = u(x(s)).
■
The two-form ω = du♭is called vorticity, which, in R3 can be identiﬁed with curl u. Our assumptions so
far have precluded any tangential forces and thus any mechanism for starting or stopping rotation. Hence,
intuitively, we might expect rotation to be conserved. Since rotation is intimately related to the vorticity,
we can expect the vorticity to be involved. We shall now prove that this is so.
Let C be a simple closed contour in the ﬂuid at t = 0 and let Ct be the contour carried along the ﬂow. In
other words, Ct = ϕt(C) where ϕt is the ﬂuid ﬂow map. (See Figure 8.2.3.) The circulation around Ct is
deﬁned to be the integral
ΓCt =

C1
u♭,

512
8. Applications
C
M
Ct 
Figure 8.2.3. A loop advected by the ﬂow
8.2.4 Theorem (Kelvin Circulation Theorem).
Let M be a manifold and l ⊂M a smooth closed loop,
that is, a compact one-manifold. Let ut solve the Euler equations on M for ideal isentropic compressible or
homogeneous incompressible ﬂow and l(t) be the image of l at time t when each particle moves under the
ﬂow ϕt of ut; that is, l(t) = ϕt(l). Then the circulation is constant in time; that is,
d
dt

l(t)
u♭
t = 0
Proof.
Let ϕt be the ﬂow of ut. Then l(t) = ϕt(l), and so changing variables,
d
dt

ϕt(l)
u♭
t =

l

ϕ∗
t (£uu♭) + ϕ∗
t
∂u♭
∂t

.
However, £uu♭+ ∂u♭/∂t is exact from the equations of motion and the integral of an exact form over a
closed loop is zero.
■
We now use Stokes’ theorem, which will bring in the vorticity. If Σ is a surface (a two-dimensional
submanifold of M) whose boundary is a closed contour C, then Stokes’ theorem yields
ΓC =

C
u♭=

Σ
du♭=

Σ
ω.
See Figure 8.2.4.
n
Σ
C
Figure 8.2.4. A surface and contour for Helmholtz’ theorem
Thus, as a corollary of the circulation theorem, we can conclude:
8.2.5 Theorem (Helmholtz’ Theorem).
Under the hypotheses of Theorem 8.2.4, the ﬂux of vorticity across
a surface moving with the ﬂuid is constant in time.

8.2 Fluid Mechanics
513
We shall now show that ω and η = ω/ρ are Lie propagated by the ﬂow.
8.2.6 Proposition.
For isentropic or homogeneous incompressible ﬂow, we have
(i)
∂ω
∂t + £uω = 0
and
∂η
∂t + £uη −η div u = 0
called the vorticity–stream equation and
(ii)
ϕ∗
t ω = ω0
and
ϕ∗
t ηt = J(ϕt)η0
where ηt(x) = η(x, t) and J(ϕt) is the Jacobian of ϕt.
Proof.
Applying d to Euler’s equations for the two types of ﬂuids we get the vorticity equation:
∂ω
∂t + £uω = 0.
Thus
∂η
∂t + £uη = 1
ρ
∂ω
∂t + £uω

−ω
p2
∂ρ
∂t + dρ · u

= η
ρ
∂ρ
∂t + dρ · u + ρ div u

+ η div u = η div u
by conservation of mass.
From ∂ω/∂t + £uω = 0 it follows that (∂/∂t)(ϕ∗
t ωt) = 0, so ϕ∗
t ωt = ω0. Since ϕ∗
t ρt = ρ0/J(ϕt) we also
get ϕ∗
t ηt = J(ϕt)η0.
■
In three dimensions we can associate to η the vector ﬁeld ζ = ∗η (or equivalently iζµ = η). Thus
ζ = curl u/ρ, if M is embedded in R3.
8.2.7 Corollary.
If dim M = 3, then ζ is transported as a vector by ϕt; that is,
ζt = ϕt∗ζ0
or
ζt(ϕt(x)) = Txϕt(ζt(x)).
Proof.
ϕ∗
t ηt = J(ϕt)η0 by Proposition 8.2.6, so
ϕ∗
t iζtµ = J(ϕt)iζ0µ.
But
ϕ∗
t iζtµ = iϕ∗
t ζtϕ∗
t µ = iϕ∗
t ζtJ(ϕt)µ
Thus iϕ∗
t ζtu = iζ0µ, which gives ϕ∗
t ζt = ζ0.
■
Notice that the vorticity as a two-form is Lie transported by the ﬂow but as a vector ﬁeld it is vorticity/ρ,
which is Lie transported. Here is another instance where distinguishing between forms and vector ﬁelds
makes an important diﬀerence.
The ﬂow ϕt of a ﬂuid plays the role of a conﬁguration variable and the velocity ﬁeld u plays the role of the
corresponding velocity variable. In fact, to understand ﬂuid mechanics as a Hamiltonian system in the sense
of §8.1, a ﬁrst step is to set up its phase space using the set of all diﬀeomorphisms ϕ : M →M (volume
preserving for incompressible ﬂow) as the conﬁguration space. The references noted at the beginning of this
section carry out this program (see also Exercise 8.2-9 and §8.4).

514
8. Applications
Exercises
⋄8.2-1.
In classical texts on ﬂuid mechanics, the identity
(u · ∇)u = 1
2∇(u · u) + (∇× u) × u
is often used. To what identity does this correspond in this section?
⋄8.2-2.
A ﬂow is called potential ﬂow if u♭= dϕ for a function ϕ. For (not necessarily stationary)
homogeneous incompressible or isentropic ﬂow prove Bernoulli’s law in the form
∂ϕ
∂t + 1
2∥u∥2 +
 dp
ρ = constant on a streamline.
⋄8.2-3.
Complex variables texts “show” that the gradient of ϕ(r, θ) = (r + 1/r) cos θ describes stationary
ideal incompressible ﬂow around a cylinder in the plane. Verify this in the context of this section.
⋄8.2-4.
Translate Proposition 8.2.2 into vector analysis notation in R3 and give a direct proof.
⋄8.2-5.
Let dim M = 3, and assume the vorticity ω has a one-dimensional kernel.
(i) Using Frobenius’ theorem, show that this distribution is integrable.
(ii) Identify the one-dimensional leaves with integral curves of ζ (see Corollary 8.2.7)—these are called
vortex lines.
(iii) Show that vortex lines are propagated by the ﬂow.
⋄8.2-6.
Assume dim M = 3. A vortex tube T is a closed oriented two-manifold in M that is a union
of vortex lines. The strength of the vortex tube is the ﬂux of vorticity across a surface Σ inside T whose
boundary lies on T and is transverse to the vortex lines. Show that vortex tubes are propagated by the ﬂow
and have a strength that is constant in time.
⋄8.2-7.
Let f : R3 →R be a linear function and g : S2 →R be its restriction to the unit sphere. Show that
dg gives a stationary solution of Euler’s equations for ﬂow on the two-sphere.
⋄8.2-8.
Stream Functions
(i) For incompressible ﬂow in R2, show that there is a function ψ such that u1 = ∂ψ/∂y and u2 = −∂ψ/∂x.
One calls ϕ the stream function (as in Batchelor [1967]).
(ii) Show that if we let ∗ψ = ψ dx ∧dy be the associated two form, then u♭= δ∗ψ.
(iii) Show that u is a Hamiltonian vector ﬁeld (see §8.1) with energy ψ directly in R2 and then for arbitrary
two-dimensional Riemannian manifolds M.
(iv) do stream functions exist for arbitrary ﬂuid ﬂow on T2? On S2?
(v) Show that the vorticity is ω = ∆∗ψ.
⋄8.2-9 (Clebsch Variables; Clebsch [1859]).
Let F be the space of functions on a compact manifold M with
the dual space F∗, taken to be densities on M; the pairing between f ∈F and ρ ∈F∗is ⟨f, ρ⟩=

M fρ.
(i) On the symplectic manifold F ×F∗×F ×F∗with variables (α, λ, µ, ρ), show that Hamilton’s equations
for a given Hamiltonian H are
˙α = δH
δλ ,
˙µ = δH
δρ ,
˙λ = −δH
δα ,
˙ρ = −δH
δµ ,
where δH/δλ is the functional derivative of H deﬁned by
δH
δλ , ˙λ

= DH(λ) · ˙λ.

8.3 Electromagnetism
515
(ii) In the ideal isentropic compressible ﬂuid equations, set M = ρu♭, the momentum density, where
dx denotes the Riemannian volume form on M. Identify the density σ(x)dx ∈F∗with the function
σ(x) ∈F and write M = −(ρdµ+λdα)dx. For momentum densities of this form show that Hamilton’s
equations written in the variables (α, λ, µ, ρ) imply Euler’s equation and the equation of continuity.
8.3
Electromagnetism
Classical electromagnetism is governed by Maxwell’s ﬁeld equations. The form of these equations depends on
the physical units chosen, and changing these units introduces factors like 4π, c = the speed of light, ϵ0 = the
dielectric constant and µ0 = the magnetic permeability. The discussion in this section assumes that ϵ0, µ0
are constant; the choice of units is such that the equations take the simplest form; thus c = ϵ0 = µ0 = 1
and factors 4π disappear. We also do not consider Maxwell’s equations in a material, where one has to
distinguish E from D, and B from H.
Let E, B, and J be time dependent C1-vector ﬁelds on R3 and ρ : R3 × R →R a scalar. These are said to
satisfy Maxwell’s equations with charge density ρ and current density J when the following hold:
div E = ρ
(Gauss’s law)
(8.3.1)
div B = 0
(no magnetic sources)
(8.3.2)
curl E + ∂B
∂t = 0
(Faraday’s law of induction)
(8.3.3)
curl B −∂E
∂t = J
(Amp`ere’s law)
(8.3.4)
E is called the electric ﬁeld and B the magnetic ﬁeld.
The quantity

Ωρ dV = Q is called the charge of the set Ω⊂R3. By Gauss’ theorem, equation (8.3.1) is
equivalent to

∂Ω
E · n dS =

Ω
ρ dV = Q
(8.3.5)
for any (nice) open set Ω⊂R3; that is, the electric ﬂux out of a closed surface equals the total charge inside
the surface. This generalizes Gauss’ law for a point charge discussed in §7.3. By the same reasoning, equation
(8.3.2) is equivalent to

∂Ω
B · n dS = 0.
(8.3.6)
That is, the magnetic ﬂux out of any closed surface is zero. In other words there are no magnetic sources
inside any closed surface.
By Stokes’ theorem, equation (8.3.3) is equivalent to

∂S
E · ds =

S
(curl E) · n dS = −∂
∂t

S
B · n dS
(8.3.7)
for any closed loop ∂S bounding a surface S. The quantity

∂S E·ds is called the voltage around ∂S. Thus,
Faraday’s law of induction equation (8.3.3), says that the voltage around a loop equals the negative of the
rate of change of the magnetic ﬂux through the loop.
Finally, again by the classical Stokes’ theorem, equation (8.3.4) is equivalent to

∂S
B · ds =

S
(curl B) · n dS = ∂
∂t

S
E · n dS +

S
J · n dS.
(8.3.8)

516
8. Applications
Since

S J · n dS has the physical interpretation of current, Amp`ere’s law states that if E is constant in
time, then the magnetic potential diﬀerence

∂S B · ds around a loop equals the current through the loop. In
general, if E varies in time, Amp`ere’s law states that the magnetic potential diﬀerence around a loop equals
the total current in the loop plus the rate of change of electric ﬂux through the loop.
We now show how to express Maxwell’s equations in terms of diﬀerential forms. Let M = R4 = {(x, y, z, t)}
with the Lorentz metric g on R4 having diagonal form (1, 1, 1, −1) in standard coordinates (x, y, z, t).
8.3.1 Proposition.
There is a unique two-form F on R4, called the Faraday two-form such that
E♭= −i∂/∂tF;
(8.3.9)
B♭= −i∂/∂t ∗F.
(8.3.10)
(Here the ♭is associated with the Euclidean metric in R3 and the ∗is associated with the Lorentzian metric
in R4.)
Proof.
If
F = Fxydx ∧dy + Fzxdz ∧dx + Fyzdy ∧dz
+ Fxtdx ∧dt + Fytdy ∧dt + Fztdz ∧dt,
then (see Example 6.2.14E),
∗F = Fxydz ∧dt + Fzxdy ∧dt + Fyzdx ∧dt
−Fxtdy ∧dz −Fytdz ∧dx −Fztdx ∧dy
and so
−i∂/∂tF = Fxtdx + Fytdy + Fztdz
and
−i∂/∂t ∗F = Fxydz + Fzxdy + Fyzdx.
Thus, F is uniquely determined by equations (8.3.9) and (8.3.10), namely
F = E1dx ∧dt + E2dy ∧dt + E3dz ∧dt
+ B3dx ∧dy + B2dz ∧dx + B1dy ∧dz.
■
We started with E and B and used them to construct F, but one can also take F as the primitive object
and construct E and B from it using equations (8.3.9) and (8.3.10). Both points of view are useful.
Similarly, out of ρ and J we can form the source one-form j = −ρ dt + J1dx + J2dy + J3dz; that is, j
is uniquely determined by the equations −i∂/∂tj = ρ and i∂/∂t ∗j = ∗J♭; in the last relation, J is regarded
as being deﬁned on R4.
8.3.2 Proposition.
Maxwell’s equations (8.3.1)–(8.3.4) are equivalent to the equations
dF = 0
and
δF = j
on the manifold R4 endowed with the Lorentz metric.

8.3 Electromagnetism
517
Proof.
A straightforward computation shows that
dF =

curl E + ∂B
∂t

x
dy ∧dz ∧dt +

curl E + ∂B
∂t

y
dz ∧dx ∧dt
+

curl E + ∂B
∂t

z
dx ∧dy ∧dt + (div B)dx ∧dy ∧dz.
Thus dF = 0 is equivalent to equations (8.3.2) and (8.3.3).
Since the index of the Lorentz metric is 1, we have δ = ∗d∗. Thus,
δF = ∗d ∗F = ∗d

−E1dy ∧dz −E2dz ∧dx −E3dx ∧dy
+ B1dx ∧dt + B2dy ∧dt + B3dz ∧dt

= ∗

−(div E)dx ∧dy ∧dz +

curl B −∂B
∂t

x
dy ∧dz ∧dt +
+

curl B −∂E
∂t

y
dz ∧dx ∧dt +

curl B −∂E
∂t

z
dx ∧dy ∧dt

=

curl B −∂E
∂t

x
dx +

curl B −∂E
∂t

y
dy
+

curl B −∂E
∂t

z
dz −(div E) dt.
Thus δF = j iﬀequations (8.3.1) and (8.3.4) hold.
■
As a skew matrix, we can represent F as follows
F =


0
B3
−B2
E1
−B3
0
B1
E2
B2
−B1
0
E3
−E1
−E2
−E3
0

.
Recall from §6.5 and Exercise 7.5-7, the formula
(δF)i = | det[glj]|−1/2(F ik| det[glj]|1/2),k
Since | det[gkl]| = 1, Maxwell’s equations can be written in terms of the Faraday two-form F in components
as
Fij,k + Fjk,i + Fki,j = 0
(8.3.11)
and
F ik
,k = −ji,
(8.3.12)
where Fij,k = ∂Fij/∂xk, etc. Since δ2 = 0, we obtain
0 = δ2F = δj = ∗d ∗j = ∗d(−ρ dx ∧dy ∧dz + (∗J♭) ∧dt)
= ∗
∂ρ
∂t + div J

dx ∧dy ∧dz ∧dt

= ∂ρ
∂t + div J;
that is, ∂ρ/∂t + div J = 0, which is the continuity equation (see §8.2). Its integral form is, by Gauss’
theorem,
dQ
dt = d
dt

Ω
ρ dV =

∂Ω
J · n dS

518
8. Applications
for any bounded open set Ω. Thus the continuity equation says that the ﬂux of the current density out of a
closed surface equals the rate of change of the total charge inside the surface.
Next we show that Maxwell’s equations are Lorentz invariant, that is, are special-relativistic. The Lorentz
group £ is by deﬁnition the orthogonal group with respect to the Lorentz metric g, that is,
£ =
	
A ∈GL(R4) | g(Ax, Ay) = g(x, y) for all x, y ∈R4 
.
Lorentz invariance means that F satisﬁes Maxwell’s equations with j iﬀA∗F satisﬁes them with A∗F,
for any A ∈£. But due to Proposition 8.3.1 this is clear since pull-back commutes with d and orthogonal
transformations commute with the Hodge operator (see Exercise 6.2-4) and thus they commute with δ.
As a 4 × 4 matrix, the Lorentz transformation A acts on F by F →A∗F = AFAT . Let us see that the
action of A ∈£ mixes up E’s and B’s. (This is the source of statements like: “A moving observer sees an
electric ﬁeld partly converted to a magnetic ﬁeld.”)
Proposition 8.3.1 deﬁnes E and B intrinsically in terms of F. Thus, if one performs a Lorentz transfor-
mation A on F, the new resulting electric and magnetic ﬁelds E′ and B′ with respect to the Lorentz unit
normal A∗(∂/∂t) to the image A(R3 × 0) in R4 are given by
(E′)♭= −iA∗∂/∂tA∗F,
(B′)♭= −iA∗∂/∂tA∗F.
For a Lorentz transformation of the form
x′ =
x −vt
√
1 −v2 ,
y′ = y,
z′ = z,
t′ =
t −vx
√
1 −v2
(the special-relativistic analogue of an observer moving uniformly along the x-axis with velocity v) we get
E′ =

E′, E2 −vB3
√
1 −v2 , E3 + vB2
√
1 −v2

and
B′ =

B′, B2 −vE3
√
1 −v2 , B3 + vE2
√
1 −v2

.
We leave the veriﬁcation to the reader.
By the way we have set things up, note that Maxwell’s equations make sense on any Lorentz manifold;
that is, a four-dimensional manifold with a pseudo-Riemannian metric of signature (+, +, +, −).
Maxwell’s vacuum equations (i.e., j = 0) will now be shown to be conformally invariant on any
Lorentz manifold (M, g). A diﬀeomorphism ϕ : (M, g) →(M, g) is said to be conformal if ϕ∗g = f 2g for a
nowhere vanishing function f. (See Fulton, Rohrlich, and Witten [1962] for a review of conformal invariance
in physics and the original literature references.)
8.3.3 Proposition.
Let F ∈Ω2(M) where (M, g) is a Lorentz manifold, satisfy dF = 0 and δF = j. Let
ϕ be a conformal diﬀeomorphism. Then ϕ∗F satisﬁes
dϕ∗F = 0
and
δϕ∗F = f 2ϕ∗j.
Hence Maxwell’s vacuum equations (with j = 0) are conformally invariant; that is, if F satisﬁes them, so
does ϕ∗F.
Proof.
Since ϕ∗commutes with d, dF = 0 implies dϕ∗F = 0. The second equation implies ϕ∗δF = ϕ∗j.
By Exercise 7.5-8, we have δϕ∗gϕ∗β = ϕ∗δβ. Hence δF = j implies δϕ∗gϕ∗F = ϕ∗j = δf 2gϕ∗F since ϕ is
conformal. The local formula for δF, namely
(δF)i = | det[gks]|−1/2gir
∂
∂xl (graglbFab| det[gks]|−1/2)

8.3 Electromagnetism
519
shows that when one replaces g by f 2g, we get
δf 2gϕ∗F = f −2ϕ∗F,
and so
δϕ∗F = f 2ϕ∗j.
■
Let us now discuss the energy equation for the electromagnetic ﬁeld. Introduce the energy density of
the ﬁeld
1
2E = (E · E + B · B)
and the Poynting energy-ﬂux vector
S = E × B.
Poynting’s theorem states that
−∂E
∂t = div S + E · J.
This is a straightforward computation using equations (8.3.3) and (8.3.4). We shall extend this result to R4
and, at the same time, shall rephrase it in the framework of forms.
Introduce the stress–energy–momentum tensor (or the Maxwell stress tensor) T by
T ij = F ikF j
k −1
4gijFpqF pq
(8.3.13)
(or intrinsically,
T = F · F −1
4⟨F, F⟩g,
where F · F denotes a single contraction of F with itself). A straightforward computation shows that the
divergence of T equals
T ij
,j = F ik
,j F j
k + F ikF j
k,j −1
2F ,i
pqF pq
where F ,i
pq = (∂Fpq/∂xk)gik. Taking into account δF = j written in the form (8.3.12), it follows that
T il
,l = F ikjk.
(8.3.14)
For i = 4, the relation (8.3.14) becomes Poynting’s theorem.2 It is clear that T is a symmetric 2-tensor. As
a symmetric matrix,
T =

σ
E × B
(E × B)T
E

,
2Poynting’s theorem can also be understood in terms of a Hamiltonian formulation; see Example 8.4.2 below. The Poynting
energy-ﬂux vector is the Noether conserved quantity for the action of the diﬀeomorphism group of R3 on T ∗A, where A is
the space of vector potentials A deﬁned in the following paragraph, and Poynting’s theorem is just conservation of momentum
(Noether’s theorem). We shall not dwell upon these aspects and refer the interested reader to Abraham and Marsden [1978]
and Marsden and Ratiu [1999].

520
8. Applications
where σ is the stress tensor and E is the energy density. The symmetric 3 × 3 matrix σ has the following
components
σ11 = 1
2[−(E1)2 −(B1)2 + (E2)2 + (B2)3 + (E3)2 + (B3)2]
σ22 = 1
2[(E1)2 + (B1)2 −(E2)2 −(B2)2 + (E3)3 + (B3)2]
σ33 = 1
2[(E1)2 + (B1)2 + (E2)2 + (B2)2 −(E3)2 −(B3)2]
σ12 = E1E2 + B1B2
σ13 = E1E3 + B1B3
σ23 = E2E3 + B2B3.
We close this section with a discussion of Maxwell’s equations in terms of vector potentials. We ﬁrst do
this directly in terms of E and B. Since div B = 0, if B is smooth on all of R3, there exists a vector ﬁeld
A, called the vector potential, such that B = curl A, by the Poincar´e lemma. This vector ﬁeld A is not
unique and one could also use A′ = A + grad f for some (possibly time–dependent) function f : R3 →R.
This freedom in the choice of A is called gauge freedom. For any such choice of A we have by equation
(8.3.3)
0 = curl E + ∂B
∂t = curl E + ∂
∂t curl A = curl

E + ∂A
∂t

,
so that again by the Poincar´e lemma there exists a (time-dependent) function ϕ : R3 →R such that
E + ∂A
∂t = −grad ϕ.
(8.3.15)
Recall that the Laplace–Beltrami operator on functions is deﬁned by ∇2f = div(grad f). On vector ﬁelds in
R3 this operator may be deﬁned componentwise. Then it is easy to check that
curl(curl A) = grad(div A) −∇2A.
Using this identity, (8.3.15), and B = curl A in (8.3.4), we get
J = curl B −∂E
∂t = curl(curl A) −∂
∂t

−∂A
∂t −grad ϕ

= grad(div A) −∇2A + ∂2A
∂t2 + ∂
∂t(grad ϕ),
and thus
∇2A −∂2A
∂t2 = −J + grad

div A + ∂ϕ
∂t

.
(8.3.16)
From equation (8.3.1) we obtain as before
ρ = div E = div

−∂A
∂t −grad ϕ

= −∇2ϕ −∂
∂t(div A),
that is,
∇2ϕ = −ρ −∂
∂t(div A),
or subtracting ∂2ϕ/∂t2 from both sides,
∇2ϕ −∂2ϕ
∂t2 = −ρ −+ ∂
∂t

div A + ∂ϕ
∂t

.
(8.3.17)

8.3 Electromagnetism
521
It is apparent that equations (8.3.16) and (8.3.17) can be considerably simpliﬁed if one could choose, using
the gauge freedom, the vector potential A and the function ϕ such that
div A + ∂ϕ
∂t = 0.
Assume one has chosen A0, ϕ0 and one seeks a function f such that A = A0 + grad f and ϕ = ϕ0 −∂f/∂t
satisfy div A + ∂ϕ/∂t = 0. This becomes, in terms of f,
0 = div(A0 + grad f) + ∂
∂t

ϕ0 −∂f
∂t

= div A0 + ∂ϕ0
∂t + ∇2f −∂2f
∂t2 ;
that is,
∇2f −∂2f
∂t2 = −

div A0 + ∂ϕ0
∂t

.
(8.3.18)
This equation is the classical inhomogeneous wave equation. The homogeneous wave equation (right-
hand side equals zero) has solutions
f(t, x, y, z) = ψ(x −t)
for any function ψ. This solution propagates the graph of ψ like a wave—hence the name wave equation.
Now we we can draw some conclusions regarding Maxwell’s equations. In terms of the vector potential A
and the function ϕ, equations (8.3.1) and (8.3.4) become
∇2ϕ −∂2ϕ
∂t2 = −ρ,
∇2A −∂2A
∂t2 = −J,
(8.3.19)
which again are inhomogeneous wave equations. Conversely, if A and ϕ satisfy the foregoing equations and
div A + ∂ϕ/∂t = 0, then E = −grad ϕ −∂A/∂t and B = curl A satisfy Maxwell’s equations.
Thus in R4, this procedure reduces the study of Maxwell’s equations to the wave equation, and hence
solutions of Maxwell’s equations can be expected to be wavelike.
We now repeat the foregoing constructions on R4 using diﬀerential forms. Since dF = 0, on R4 we can
write F = dG for a one-form G. Note that F is unchanged if we replace G by G + df. This again is the
gauge freedom. Substituting F = dG into δF = j gives δdG = j. Since ∆= dδ + δd is the Laplace–deRham
operator in R4, we get
∆G = j −dδG.
(8.3.20)
Suppose we try to choose G so that δG = 0 (a gauge condition). To do this, given an initial G0, we can let
G = G0 + df and demand that
0 = δG = δG0 + δdf = δG0 + ∆f
so f must satisfy ∆f = −δG0. Thus, if the gauge condition
∆f = −δG0
(8.3.21)
holds, then Maxwell’s equations become
∆G = j.
(8.3.22)
Equation (8.3.21) is equivalent to (8.3.18) and (8.3.22) to (8.3.19) by choosing G = A♭+ ϕ dt (where ♭is
Euclidean in R3).

522
8. Applications
Exercises
⋄8.3-1.
Assume that the Faraday two-form F depends only on t −x.
(i) Show that dF = 0 is then equivalent to B3 = E2, B2 = −E3, B1 = 0.
(ii) Show that δF = 0 is then equivalent to B3 = E2, B2 = −E3, E1 = 0. These solutions of Maxwell’s
equations are called plane electromagnetic waves; they are determined only by E2, E3 or B2, B3,
respectively.
⋄8.3-2.
Let u = ∂/∂t. Show that the Faraday two-form F ∈Ω2(R4) is given in terms of E and B ∈X(R4)
by F = u♭∧E♭−∗(u♭∧B♭).
⋄8.3-3.
Show that the Poynting vector satisﬁes
S♭= ∗(B♭∧E♭∧u♭)
where u = ∂/∂t and E, B ∈X(R4).
⋄8.3-4.
Let (M, g) be a Lorentzian four-manifold and u ∈X(M) a timelike unit vector ﬁeld on M; that is,
g(u, u) = −1.
(i) Show that any α ∈Ω2(M) can be written in the form
α = (iuα) ∧u♭−∗((iu ∗α) ∧u♭).
(ii) Show that if iuα = 0, where α ∈Ω2(M) (“α is orthogonal to u”), then ∗α is decomposable, that is,
∗α is the wedge product of two one-forms. Prove that α is also locally decomposable.
Hint: Use the Darboux theorem.
⋄8.3-5.
The ﬁeld of a stationary point charge is given by
E =
er
4πr3 ,
B = 0,
where r is the vector xi + yj + zk in R3 and r is its length. Use this and a Lorentz transformation to show
that the electromagnetic ﬁeld produced by a charge e moving along the x-axis with velocity v is
E = e
4π
(1 −v2)r
[x2 + (1 −v2)(y2 + z2)]exc:3.2−27
and, using spherical coordinates with the x-axis as the polar axis,
Br = 0,
Bθ = 0,
Bϕ =
e(1 −v2)v sin θ
4πr2(1 −v2 sin2 θ)exc:3.2−27
(the magnetic ﬁeld lines are thus circles centered on the polar axis and lying in planes perpendicular to it).
⋄8.3-6 ( Misner, Thorne, and Wheeler [1973]).
The following is the Faraday two-form for the ﬁeld of an
electric dipole of magnitude p1 oscillating up and down parallel to the z-axis.
F = Re

p1eiωr−iωt

2 cos θ
 1
r2 −iω
r2

dr ∧dt
+ sin θ
 1
r3 −iω
r2 −ω2
r

rdθ ∧dt
+ sin θ

−iω
r2 −ω2
r

dr ∧r dθ

.
Verify that dF = 0 and δF = 0, except at the origin.

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
523
£?
⋄8.3-7.
Let the Lagrangian for electromagnetic theory be
£ = |F|2 = −1
2FijFklgikgjl
−det g.
Check that ∂£/∂gij is the stress–energy–momentum tensor T ij (see Hawking and Ellis [1973, Section 3.3]).
8.4
The Lie–Poisson Bracket in Continuum Mechanics and
Plasma Physics
This section studies the equations of motion for some Hamiltonian systems in Poisson bracket formation. As
opposed to §8.1, the emphasis is placed here on the Poisson bracket rather than on the underlying symplectic
structure. This naturally leads to a generalization of Hamiltonian mechanics to systems whose phase space
is a “Poisson manifold.” We do not intend to develop here the theory of Poisson manifolds but only to
illustrate it with the most important example, the Lie–Poisson bracket. See Marsden and Ratiu [1999] for
further details.
If (P, ω) is a (weak) symplectic manifold, H : P →R a smooth Hamiltonian with Hamiltonian vector ﬁeld
XH ∈X(P) whose ﬂow is denoted by ϕt, recall from Corollary 8.1.11 that
dϕt
dt (p) = XH(ϕt(p))
(8.4.1)
is equivalent to
d
dt(F ◦ϕt) = {F ◦ϕt, H ◦ϕt}
(8.4.2)
for any smooth locally deﬁned function f : U →R, where U is open in P. In (8.4.2), { , } denotes the Poisson
bracket deﬁned by ω, that is,
{F, G} = ω(XF , XG) = XG[F] = −XF [G].
(8.4.3)
Finally, recall that the Poisson bracket is an antisymmetric bilinear operation on F(P) which satisﬁes the
Jacobi identity
{{F, G}, H} + {{G, H}, F} + {{H, F}, G} = 0,
(8.4.4)
that is, (F(P), { , }) is a Lie algebra. In addition, the multiplicative ring structure and the Lie algebra
structure of F(P) are connected by the Leibniz rule
{FG, H} = F{G, H} + G{F, H},
(8.4.5)
that is, { , } is a derivation in each argument. These observations naturally lead to the following generalization
of the concept of symplectic manifolds.
8.4.1 Deﬁnition.
A smooth manifold P is called a Poisson manifold if F(P), the ring of functions on
P, admits a Lie algebra structure which is a derivation in each argument. The bracket operation on F(P)
is called a Poisson bracket and is usually denoted by { , }.
From the remarks above, we see that any (weak) symplectic manifold is a Poisson manifold. One of the
purposes of this section is to show that there are physically important Poisson manifolds which are not
symplectic. But even in the symplectic context it is sometimes easier to compute the Poisson bracket than
the symplectic form, as the following example shows.

524
8. Applications
Fix title
8.4.2 Example (Maxwell’s Vacuum Equations as an Inﬁnite Dimensional Hamiltonian System).
We shall
indicate how the dynamical pair of Maxwell’s vacuum equations (8.3.3) and (8.3.4) of the previous section
with current J = 0 are a Hamiltonian system.
As the conﬁguration space for Maxwell’s equations, we take the space A of vector potentials. (In more
general situations, one should replace A by the set of connections on a principal bundle over conﬁguration
space.) The corresponding phase space is then the cotangent bundle T ∗A with the canonical symplectic
structure. Elements of T ∗A may be identiﬁed with pairs (A, Y) where Y is a vector ﬁeld density on R3. (We
do not distinguish Y and Y d3x.) The pairing between A’s and Y’s is given by integration, so the canonical
symplectic structure ω on T ∗A is
ω((A1, Y1), (A2, Y2)) =

R3(Y2 · A1 −Y1 · A2)d3x,
(8.4.6)
with associated Poisson bracket
{F, G}(A, Y) =

R3
 δF
δA · ∂G
δY −δF
δY · δG
δA

d3x,
(8.4.7)
where δF/δA is the vector ﬁeld deﬁned by
DAF(A, Y) · A′ =
 δF
δA · A′d3x.
with the vector ﬁeld δF/δY deﬁned similarly. With the Hamiltonian
H(A, Y) = 1
2

∥Y∥2d3x + 1
2∥curl A∥2d3x,
(8.4.8)
Hamilton’s equations are easily computed to be
∂Y
∂t = −curl curl A
and
∂A
∂t = Y.
(8.4.9)
If we write B for curl A and E for −Y, the Hamiltonian becomes the ﬁeld energy
1
2

∥E∥2d3x + 1
2∥B∥3d3x.
(8.4.10)
Equation (8.4.9) implies Maxwell’s equations
∂E
∂t = curl B
and
∂B
∂t = −curl E,
(8.4.11)
and the Poisson bracket of two functions F(A, E), G(A, E) is
{F, G}(A, E) = −

R3
 δF
δA · δG
δE −δG
δA · δF
δE

d3x.
(8.4.12)
We can express this Poisson bracket in terms of E and B = curl A. To do this, we consider functions
˜F : V × X(R3) →R, where
V =
	
curl Z | Z ∈X(R3)

.
We pair V with itself relative to the L2-inner product. This is a weakly non-degenerate pairing since by the
Hodge–Helmholtz decomposition

R3 curl Z1 · curl Z2 d3x = 0

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
525
for all Z2 ∈X(R3) implies that curl Z1 = ∇f, whence
∆f = div ∇f = div curl Z1 = 0,
and so, f = constant by Liouville’s theorem. Therefore curl Z1 = ∇f = 0, as was to be shown.
We compute δF/δA in terms of the functional derivative of an arbitrary extension ˆF of ˜F to X(R3), where
F(A, E) = ˜F(B, E), for B = curl A. Let L be the linear map L(A) = curl A so that
F = ˜F ◦(L × Identity) = ˆF ◦(L × Identity).
By the chain rule, we have for any δA ∈X(R3),

R3
δF
δA · δAd3x = DF(A) · δA = (D ˆF(B) ◦DL(A)) · δA
=

R3
δ ˆF
δB · curl δA d3x =

R3 curl δ ˆF
δB · δAd3x,
since DL(A) = L and

R3 X · curl Yd3x =

R3 Y · curl X d3x. Therefore
δF
δA = curl δ ˜F
δB.
(8.4.13)
This formula seems to depend on the extension ˆF of ˜F. However, this is not the case. More precisely, let
K : X(R3) × X(R3) →R be such that K|(V × X(R)) ≡0. We claim that if B ∈V, then δK/δB is a gradient.
Granting this statement, this shows that equation (8.4.13) is independent of the extension, since any two
extensions of ˜F coincide on V × X(R3) and since curl ◦grad = 0. To prove the claim, note that for any
Z ∈X(R3),
0 = DK(B) · curl Z =

R3
δK
δB · curl Z d3x =

R3 curl δK
δB · Z d3x
whence curl δK/δB = 0, that is, δK/δB is a gradient. Thus, equation(8.4.13) implies
δF
δA = curl δ ˜F
δB,
(8.4.14)
where on the right-hand side δ ˜F/δB is understood as the functional derivative relative to B of an arbitrary
extension of ˜F to X(R3). Since δ ˜F/δE = δF/δE, the Poisson bracket (8.4.12) becomes
{ ˜F, ˜G}(B, E) =

R3

δ ˜F
δE · curl δ ˜G
δB −δ ˜G
δE · curl δ ˜F
δB

d3x
(8.4.15)
This bracket was found by Born and Infeld [1935] by a diﬀerent method.
Using the Hamiltonian
H(B, E) = 1
2

R3(∥B∥2 + ∥E∥2)d3x,
(8.4.16)
equations (8.4.11) are equivalent to the Poisson bracket equations
˙˜F = { ˜F, ˜H}.
(8.4.17)

526
8. Applications
Indeed, since δ ˜H/δE = E, curl(δ ˜H/δB) = curl B, we have
{ ˜F, ˜H} =

R3

δ ˜F
δE · curl B −E · curl δ ˜F
δB

d3x
=

R3

δ ˜F
δE · curl B −E · curl δ ˜F
δB

d3x
Moreover,
˜F = D ˜F(B) · ˙B + D ˜F(E) · ˙E
=

R3

δ′ ˜F
δB · ˙B + δ ˜F
δE · ˙E

d3x
=

R3

δ ˜F
δB · ˙B + δ ˜F
δE · ˙E

d3x,
where δ′ ˜F/δB denotes the functional derivative of ˜F relative to B in V, that is,
D ˜F(B) · δB =

R3
δ′ ˜F
δB · δB d3x.
(8.4.18)
The last equality in the formula for ˙˜F is proved in the following way. Recall that δ ˜F/δB is the functional
derivative of an arbitrary extension of ˜F computed at B, that is,
D ˜F(B) · Z =
 δ ˜F
δB · Z d3x
for any Z ∈X(R3);
therefore since δB is a curl, this implies δ′ ˜F/δB and δ ˜F/δB diﬀer by a gradient which is L2-orthogonal to
˙B, since ˙B is divergence free (again by the Helmholtz–Hodge decomposition). Therefore equation (8.4.11)
holds if and only if equation (8.4.17) does.
♦
The Lie–Poisson bracket.
We next turn to the most important example of a Poisson manifold which is
not symplectic. Let g denote a Lie algebra that is, a vector space with a pairing [ξ, η] of elements of g that
is bilinear, antisymmetric and satisﬁes Jacobi’s identity. Let g∗denote its “dual”, that is, a vector space
weakly paired with g via ⟨, ⟩: g∗× g →R. If g is ﬁnite dimensional, we take this pairing to be the usual
action of forms on vectors.
8.4.3 Deﬁnition.
For F, G : g∗→R, deﬁne the (±) Lie–Poisson brackets by
{F, G}±(µ) = ±

µ,
δF
δµ , δG
δµ

(8.4.19)
where µ ∈g∗and δF/δµ, δG/δµ ∈g are the functional derivatives of F and G, that is, DF(µ) · δµ =
⟨δµ, δF/δµ⟩.
If g is ﬁnite dimensional with a basis ξi, and the structure constants are deﬁned by
[ξi, ξj] = ck
ijξk,
the Lie–Poisson bracket is
{F, G} = ±µj
ici
jk
δF
δµj
δG
δµk
.

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
527
8.4.4 Theorem (Lie–Poisson Theorem).
The dual space g∗with the (±) Lie–Poisson bracket is a Poisson
manifold.
Proof.
Clearly { , }± is bilinear and skew symmetric. To show { , }± is a derivation in each argument, we
show that
δ(FG)
δµ
= F(µ)δG
δµ + G(µ)δF
δµ .
(8.4.20)
To prove (8.4.20), let δµ ∈g∗be arbitrary. Then

δµ, δ(FG)
δµ

= D(FG)(µ) · δµ
= F(µ)DG(µ) · δµ + G(µ)DF(µ) · δµ
=

δµ, F(µ)δG
δµ + G(µ)δF
δµ

.
Finally, we prove the Jacobi identity. We start by computing the derivative of the map µ ∈g∗→δF/δµ ∈g.
We have for every λ, ν ∈g∗
D

ν, δF
δµ

(µ) · λ = D(DF(·) · ν)(µ) · λ = D2F(µ)(ν, λ),
that is,
D
δF
δµ

(µ) · λ = D2F(µ)(λ, ·).
(8.4.21)
Therefore the derivative of µ →
δF
δµ , δG
δµ

is
D
δF
δµ , δG
δµ

(µ) · ν =

D2F(µ)(ν, ·), δG
δµ

+
δF
δµ , D2G(µ)(ν, ·)

(8.4.22)
where D2F(µ)(ν, ·) ∈L(g∗, R) is assumed to be represented via ⟨, ⟩by an element of g. Therefore by (8.4.19)
and (8.4.22)

ν, δ
δµ{F, G}

= D{F, G}(µ) · ν
=

ν,
δF
δµ , δG
δµ

+

µ,

D2F(µ)(ν, ·), δG
δµ

+

µ,
δF
δµ , D2G(µ)(ν, ·)

=

ν,
δF
δµ , δG
δµ

−

ad
δG
δµ
∗
µ, D2F(µ)(ν, ·)

+

ad
δF
δµ
∗
µ, D2G(µ)(ν, ·)

,
where ad(ξ) : g →g is the linear map ad(ξ) · η = [ξ, η] and ad(ξ)∗: g∗→g∗is its dual deﬁned by
⟨ad(ξ)∗µ, η⟩= ⟨µ, [ξ, ν]⟩,
η ∈g, µ ∈g∗.

528
8. Applications
Therefore,

ν, δ
δν {F, G}

=

ν,
δF
δµ , δG
δµ

−

ν, D2F(µ)

ad
δG
δµ
∗
µ, ·

+

ν, D2G(µ)

ad
δF
δµ
∗
µ, ·

δ
δν {F, G} =
δF
δµ , δG
δµ

−D2F(µ)

ad
δG
δµ
∗
µ, ·

+ D2G(µ)

ad
δF
δµ
∗
µ, ·

,
(8.4.23)
which in turn implies
{{F, G}, (µ)H} =

µ,
 δ
δµ{F, G}, δH
δµ

=

µ,
δF
δµ , δG
δµ

, δH
δµ

+ D2F(µ)

ad
δG
δµ
∗
µ, ad
δH
δµ
∗
µ

−D2G(µ)

ad
δF
δµ
∗
µ, ad
δH
δµ
∗
µ

,
The two cyclic permutations in F, G, H added to the above formula sum up to zero: all six terms involving
second derivatives cancel and the three ﬁrst terms add up to zero by the Jacobi identity for the bracket of
g.
■
8.4.5 Example (The Free Rigid Body).
The equations of motion of the free rigid body described by an
observer ﬁxed on the moving body are given by Euler’s equation
˙Π = Π × ω,
(8.4.24)
where Π, ω ∈R3, Πi = Ii ωi, i = 1, 2, 3, I = (I1, I2, I3) are the principal moments of inertia, the coordinate
system in the body is chosen so that the axes are the principal axes, ω is the angular velocity in the body,
and Π is the angular momentum in the body. It is straightforward to check that the kinetic energy
H(Π) = 1
2Π · ω
(8.4.25)
is a conserved quantity for equation (8.4.24).
We shall prove below that (8.4.24) are Hamilton’s equations with Hamiltonian (8.4.25) relative to a (−)
Lie–Poisson structure on R3.
The vector space R3 is in fact a Lie algebra with respect to the bracket operation given by the cross
product, that is, [x, y] = x × y. (This is the structure that it inherits from the rotation group.) We pair R3
with itself using the usual dot-product, that is, ⟨x, y⟩= x · y. Therefore, if F : R3 →R, δF/δΠ = ∇F(Π).
Thus, the (−) Lie–Poisson bracket is given via equation (8.4.19) by the triple product
{F, G}(Π) = −Π · (∇F(Π) × ∇G(Π)).
(8.4.26)
Since δH/δΠ = ω, we see that for any F : R3 →R,
d
dt(F(Π)) = DF(Π) · ˙Π = ˙Π · ∇F(Π) = −Π · (∇F(Π) × ω)
= ∇F(Π) · (Π × ω)
so that ˙F = {F, H} for any F : R3 →R is equivalent to Euler’s equations of motion (8.4.24).
The following result, due to Pauli [1953], Martin [1959], Arnol’d [1966], ? summarizes the situation.

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
529
8.4.6 Proposition.
Euler’s equations (8.4.24) for a free rigid body are a Hamiltonian system in R3 relative
to the (−) Lie Poisson bracket (8.4.24) and Hamiltonian function (8.4.25).
♦
8.4.7 Example (Ideal Incompressible Homogeneous Fluid Flow).
In §8.2 we have shown that the equa-
tions of motion for an ideal incompressible homogeneous ﬂuid in a region Ω⊂R3 with smooth boundary
∂Ωare given by Euler’s equations of motion
∂v
∂t + (v · ∇)v = −∇p
(8.4.27a)
div v = 0
(8.4.27b)
v(t, x) ∈Tx(∂Ω) for x ∈∂Ω
(8.4.27c)
with initial condition v(0, x) = v0(x), a given vector ﬁeld on Ω. Here v(t, x) is the Eulerian or spatial
velocity, a time dependent vector ﬁeld on Ω. The pressure p is a function of v and is uniquely determined
by v (up to a constant) by the Neumann problem (take div and the dot product with n of the ﬁrst equation
in (8.4.27))
∆p = −div((v · ∇)v)
(8.4.28a)
∂p
∂n = ∇p · n = −((v · ∇)v) · n on ∂Ω,
(8.4.28b)
where n is the outward unit normal to ∂Ω. The kinetic energy
H(v) = 1
2

Ω
∥v∥2d3x
(8.4.29)
has been shown in §8.2 to be a conserved quantity for (8.4.27). We shall prove below that the ﬁrst equation
in (8.4.27) is Hamiltonian relative to a (+) Lie–Poisson bracket with Hamiltonian function given by (8.4.29).
Consider the Lie algebra Xdiv(Ω) of divergence free vector ﬁelds on Ωtangent to ∂Ωwith bracket given
by minus the bracket of vector ﬁelds, that is, for u, v ∈Xdiv(Ω) deﬁne
[u, v] = (v · ∇)u −(u · ∇)v.
(8.4.30)
(The reason for this strange choice comes from the fact that the usual Lie bracket for vector ﬁelds is the
right Lie algebra bracket of the diﬀeomorphism group of Ω.) Now pair Xdiv(Ω) with itself via the L2-pairing.
As in Example 8.4.2, using the Hodge–Helmholtz decomposition, it follows that this pairing is weakly non-
degenerate. In particular
δH
δv = v.
(8.4.31)
The (+) Lie–Poisson bracket on Xdiv(Ω) is
{F, G}(v) =

Ω
v ·
δG
δv · ∇
 δF
δv −
δF
δv · ∇
 δG
δv

d3x.
(8.4.32)
Therefore, for any Xdiv(Ω) →R, we have
d
dt(F(v)) = DF(v) · ˙v =

Ω
δF
δv · ˙vd3x
=

Ω
v ·

(v · ∇)δF
δv −
δF
δv · ∇

v

d3x
=

Ω
v ·

(v · ∇)δF
δv

d3x −

Ω
∂F
∂v · ∇
1
2∥v∥2

d3x.

530
8. Applications
To handle the ﬁrst integral, observe that if
f, g : Ω→R
then
div(fgv) = f div(gv) + gv · ∇f,
so that by Stokes’ theorem and v · n = 0, div v = 0, we get

Ω
gv · ∇fd3x =

∂Ω
fg v · n dS −

Ω
f div(g v)d3x
= −

Ω
fv · ∇g d3x.
Applying the above relation to g = vi, f = δF/δvi, and summing over i = 1, 2, 3 we get

Ω
v ·

(v · ∇)δF
δv

d3x = −

Ω
δF
δv · ((v · ∇)v)d3x
so that ˙F = {F, H} reads

Ω
δF
δv · ˙v d3x = −

Ω
δF
δv ·

(v · ∇)v + 1
2∇∥v∥2

d3x
(8.4.33)
for any F : Xdiv(Ω) →R. One would like to conclude from here that the coeﬃcients of δF/δv on both sides
of equation (8.4.33) are equal. This conclusion, however, is incorrect, since
(v · ∇)v + 1
2∇∥v∥2
is not divergence free. Thus, applying the Hodge–Helmholtz decomposition, write
(v · ∇)v + 1
2∇∥v∥2 = X −∇f
(8.4.34)
where X ∈Xdiv(Ω) and f is determined by
∆

f + 1
2∥v∥2

= −div((v · ∇)v), and
∂
∂n

f + 1
2∥v∥2

= −((v · ∇) · v) · n
which coincides with equation (8.4.28), that is,
f + 1
2∥v∥2 = p + constant.
(8.4.35)
Moreover, since

Ω
δF
δv · ∇fd3x =

∂Ω
f ∂F
∂v · n dS −

Ω
f div δF
δv d3x = 0
we have from equations (8.4.33), (8.4.34), (8.4.35)
˙∂v
∂t = −X = −(v · ∇)v = ∇p
which is the ﬁrst equation in equation (8.4.27). We have thus proved the following result (see Arnol’d [1966],
Marsden and Weinstein [1983]).

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
531
8.4.8 Proposition.
Euler’s equations (8.4.27) are a Hamiltonian system on Xdiv(Ω) relative to the (+)
Lie–Poisson bracket (8.4.32) and Hamiltonian function given by (8.4.29).
♦
8.4.9 Example (The Poisson–Vlasov Equation).
We consider a collisionless plasma consisting (for nota-
tional simplicity) of only one species of particles with charge q and mass m moving in Euclidean space R3
with positions x and velocities v. Let f(x, v, t) be the plasma density in the plasma space at time t. In the
Coulomb or electrostatic case in which there is no magnetic ﬁeld, the motion of the plasma is described by
the Poisson–Vlasov equations which are the (collisionless) Boltzmann equations for the density function f
and the Poisson equation for the scalar potential ϕf:
∂f
∂t + v · ∂f
∂x −q
m
∂ϕf
∂x · ∂f
∂v = 0
(8.4.36)
∆ϕf = −q

f(x, v)d3v = ρf,
(8.4.37)
where ∂/∂x and ∂/∂v denote the gradients in R3 relative to the x and v variables, ρf is the charge density
in physical space, and ∆is the Laplacian. Equation (8.4.36) can be written in “Hamiltonian” form
∂f
∂t + {f, H} = 0,
(8.4.38)
where { , } is the canonical Poisson bracket on phase space, namely,
{f, g} = ∂f
∂x · ∂g
∂p −∂f
∂p · ∂f
∂x = 1
m
∂f
∂x · ∂g
∂v −∂f
∂v · ∂g
∂x

,
(8.4.39)
where p = mv and
H = Hf = m∥v∥2 + qϕf
is the single particle energy, called the self–consistent Hamiltonian. Indeed,
{Hf, f} = 1
m
∂Hf
∂x · ∂f
∂v −∂Hf
∂v · ∂f
∂x

= 1
m

q ∂ϕf
∂x · ∂f
∂v −mv · ∂f
∂x

= q
m
∂ϕf
∂x · ∂f
∂v −v · ∂f
∂x = ∂f
∂t
according to equation (8.4.36). There is another very useful way to think of the evolution of f. If F(f) is
any functional of the density function f and f evolves according to the Poisson–Vlasov equations (8.4.36)
(or (8.4.38) equivalently) then F evolves in time by
˙F = {F, H}+
where { , }+ is a (+) Lie–Poisson bracket (to be deﬁned) of functionals and H is the total energy. Let us
state this more precisely. Let
V =
	
f ∈Ck(R6) | f →0 as ∥x∥→∞, ∥v∥→∞

with the L2-pairing ⟨, ⟩: V × V →R;
⟨f, g⟩=

f(x, v)g(x, v)d3xd3v.

532
8. Applications
If F : V →R is diﬀerentiable at f ∈V , the functional δF/δf is, by deﬁnition, the unique element δF/δf ∈V
such that
DF(f) · g =
δF
δf , g

=
 δF
δf (x, v)g(x, v) d3x d3v.
The vector space V is a Lie algebra relative to the canonical Poisson bracket (8.4.39) on R6. For two
functionals F, G : V →R their (+) Lie–Poisson bracket {F, G}+ : V →R is then given by
{F, G}+(x, v) =

f(x, v)
δF
δf , δG
δf

(x, v) d3x d3v,
where { , } is the canonical bracket (8.4.39). For any f, g, h ∈V we have the formula

f{g, h} d3x d3v =

g{h, f} d3x d3v.
(8.4.40)
Indeed by integration by parts, we get

f{g, h} d3x d3v = 1
m

f ∂g
∂x · ∂h
∂v d3x d3v −1
m

f ∂h
∂x · ∂g
∂v d3x d3v
= −1
m
 ∂f
∂x · g ∂h
∂v d3x d3v + 1
m

g ∂f
∂v · ∂h
∂xg d3x d3v
= 1
m

g
∂h
∂x · ∂f
∂v −∂f
∂x · ∂h
∂v

d3x d3v
=

g{h, f} d3x d3v.
We have the following results of Iw´inski and Turski [1976], ? and Morrison [1980].
8.4.10 Proposition.
Densities f ∈V evolve according to the Poisson–Vlasov equation (8.4.38) if and only
if any diﬀerentiable function F : V →R having functional derivative δF/δf evolves by the (+) Lie–Poisson
equation
˙F(f) = {F, H}+(f)
(8.4.41)
with the Hamiltonian H : V →R equal to the total energy
H(f) = 1
2

m∥v∥2f(x, v) d3x d3v +
 1
2ϕf(x) d3x.
Proof.
First we compute δH/δf using the deﬁnition
DH(f) · δf =
 δH
δf δf.
Note that the ﬁrst term of H(f) is linear in f and the second term is
1
2

ϕfρf d3x = 1
2

∥∇ϕf∥2 d3x
since ∆ϕf = −ρf. Using the chain rule and integration by parts, we get
Break
over-
ﬂow?

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
533
DH(f) · δf = 1
2

m∥v∥2δf d3x d3v +

(∇ϕf)(D(∇ϕf))δf d3x
= 1
2

m∥v∥2δf d3x d3v −

ϕfD(∆ϕf))δf d3x
= 1
2

m∥v∥2δf d3x d3v +

ϕf

D

q

f d3v

(f)δf d3x
= 1
2

m∥v∥2δf d3x d3v +

ϕfqδf d3v.
Therefore,
δH
δf = 1
2m∥v∥2 + qϕf = Hf.
We have
˙F(f) = DF(f) · ˙f =
 δH
δf
˙f d3x d3v
and
 δF
δf {Hf, f} d3x d3v =
 δF
δf
δH
δf , f

d3x d3v
=

f
δF
δf , δH
δf

d3x d3v = {F, H}+(f).
by (8.4.40). Thus (8.4.41), for any F having functional derivatives, is equivalent to (8.4.38).
■
♦
8.4.11 Example (The Maxwell–Vlasov Equations).
We consider a plasma consisting of particles with
charge q1 and mass m moving in Euclidean space R3 with positions x and velocities v. For simplicity we
consider only one species of particle; the general case is similar. Let f(x, v, t) be the plasma density at time
t, E(x, t) and B(x, t) be the electric and magnetic ﬁelds. The Maxwell–Vlasov equations are:
∂f
∂t + v · ∂f
∂x + q
m

E + v × B
c

· ∂f
∂˙v = 0,
(8.4.42a)
1
c
∂B
∂t = −curl E,
(8.4.42b)
1
c
∂E
∂t = curl B −q
c

vf(x, v, t) d3v,
(8.4.42c)
together with the non evolutionary equations
div E = ρf, where ρf = q

f(x, v, t) d3v,
(8.4.43a)
div B = 0.
(8.4.43b)
Letting c →∞leads to the Poisson–Vlasov equation (8.4.36)
∂f
∂t + v · ∂f
∂x −q
m
∂ϕf
∂x · ∂f
∂v = 0,

534
8. Applications
where ∆ϕf = −ρf. In what follows we shall set q = m = c = 1. The Hamiltonian for the Maxwell–Vlasov
system is
H(f, E, B) =
 1
2∥v∥2f(x, v, t) dx dv +
 1
2[∥E(x, t)∥2 + ∥B(x, t)∥2] d3x.
(8.4.44)
Let V = { curl Z | Z ∈X(R3) }. We have the following result of Iw´inski and Turski [1976], Morrison [1980],
and Marsden and Weinstein [1982]
8.4.12 Theorem.
(i) The manifold F(R6) × X(R3) × V is a Poisson manifold relative to the bracket
{F, G}(f, E, B) =

f
δF
δf , δG
δf

d3x d3v
+
 δG
δB · curl δG
δB −δG
δE · curl δF
δB

d3x
+
 δF
δE · ∂f
∂v
δG
δf −δG
δE · ∂f
∂v
δF
δf

d3xd3v
+

fB ·
 ∂
∂v
δF
δf × ∂
∂v
δG
δf

d3x d3v.
(8.4.45)
(ii) The equations of motion (8.4.42) are equivalent to
˙F = {F, H}
(8.4.46)
where F is any locally deﬁned function with functional derivatives and { , } is given by 8.4.44.
Proof.
Part (i) follows from general considerations on reduction (see Marsden and Weinstein [1982]). The
direct veriﬁcation is laborious but straightforward, if one recognizes that the ﬁrst two terms are the Poisson
bracket for the Poisson–Vlasov equation and the Born–Infeld bracket respectively.
(ii) Since
δH
δf = 1
2∥v∥2,
δH
δE = E,
and
curl δH
δB = curl B,
we have, by equation (8.4.40) and integration by parts in the fourth integral,
{F, H} =

f
δF
δf , 1
2∥v∥2

d3x d3v +
 δF
δB · curl B −E · curl δF
δB

d3x
+
 δF
δE · ∂f
∂v
1
2∥v∥2 −E · ∂f
∂v
δF
δE

d3x d3v
+

fB
 ∂
∂v
δF
δf × ∂
∂v
1
2∥v∥2

d3x d3v
=
 δF
δf
1
2∥v∥2, f

−F · δf
δv −divv(v × fB)

d3x d3v
+
 δF
δE ·

curl B +
 ∂f
∂v
1
2∥v∥2d3v

d3x −

E · δF
δB curl d3x
where divv denotes the divergence only with respect to the v-variable. Since
1
2∥v∥2, f

= −v · ∂f
∂x,
divv(v × fB) = ∂f
∂v · (v × B),
 ∂f
∂v
1
2∥v∥2d3x = −

vfd3x,

8.4 The Lie–Poisson Bracket in Continuum Mechanics and Plasmas
535
and

E · curl δF
δBd3x =
 δF
δB · curl E d3x,
we get
{F, H} =
 δF
δf

−v · ∂f
∂x −(E + v × B) · ∂f
∂v

d3x d3v
+
 δF
δE ·

curl B −

vf(x, v, t)d3v

d3v
−
 δF
δB · curl E

d3x,
(8.4.47)
and since
˙F =
 δF
δf · ˙f d3x d3v +
 δF
δE · ˙E d3x +
 δ′F
δB · ˙B d3x
taking into account that δF/δB, δ′F/δB diﬀer by a gradient (by equation (8.4.15)) which is L2-orthogonal
to V (of which both curl E and B are a member), it follows from equation (8.4.47) that the equations
(8.4.42)–(8.4.43) (with q = c = m = 1) are equivalent to (8.4.46).
■
♦
Exercises
⋄8.4-1.
Find the symplectic form equivalent to the Born–Infeld bracket (8.4.16) on V × X(R3).
⋄8.4-2.
Show that the Hamiltonian vector ﬁeld XH ∈X(g∗) relative to the (±) Lie–Poisson bracket is given
by XH(µ) = ∓ad(δH/δµ)∗µ.
⋄8.4-3 (?).
Let V = { f : R →R | f is C∞, lim|x|→∞f(x) = 0 }.
(i) Show that the prescription
{F, G}(f) =
 +∞
−∞
δF
δf
d
dx
δG
δf dx
deﬁnes a Poisson bracket on V for appropriate functions F and G (be careful about what hypotheses
you put on F and G).
(ii) Show that the Hamiltonian vector ﬁeld of H : V →R is given by
XH(f) = d
dx
δH
δf .
(iii) Let H(f ′) =
 +∞
−∞(f 3 + (1/2)f 2
x)dx. Show that the diﬀerential equation for XH is the Korteweg–
deVries equation:
ft −6ffx + fxxx = 0.

536
8. Applications
⋄8.4-4 ( ?).
Let g be a Lie algebra and ϵ ∈g∗be ﬁxed. Show that the prescription
{F, G}ϵ(µ) =

ϵ,
δF
δµ , δG
δµ

deﬁnes a Poisson bracket on g∗.
Hint: Look at the formulas in the proof of Theorem 8.4.4.
⋄8.4-5.
(i) (Pauli [1953], ?). Let P be a ﬁnite dimensional Poisson manifold satisfying the following
condition: If f{F, G} = 0 for any locally deﬁned F implies G = constant. Show that there exists an
open dense set U in P such that the Poisson bracket restricted to U comes from a symplectic form on
U.
Hint: Deﬁne B : T ∗P × T ∗P →R by B(dF, dG) = {F, G}. Show ﬁrst that
U = { p ∈P | Bp(α, β) = 0 for all α ∈T ∗
p P implies βp = 0 }
is open and dense in P. Then show that B can be inverted at points in U.
(ii) Show that, in general, U ̸= P by the following example. On R2 deﬁne
{F, G}(x, y) = y
∂F
∂x
∂G
∂y −∂F
∂y
∂G
∂x

Show that U in (i) is R2\{Ox-axis}. Show that on U, the symplectic form generating the above Poisson
bracket is dx ∧dy/y.
8.5
Constraints and Control
The applications in this ﬁnal section all involve the Frobenius theorem. Each example is necessarily treated
brieﬂy, but hopefully in enough detail so the interested reader can pursue the subject further by utilizing
the given references.
Constaints.
We start with the subject of holonomic constraints in Hamiltonian systems. A Hamiltonian
system as discussed in §8.1 can have a condition imposed that limits the available points in phase space. Such
a condition is a constraint. For example, a ball tethered to a string of unit length in R3 may be considered
to be constrained only to move on the unit sphere S2 (or possibly interior to the sphere if the string is
collapsible). If the phase space is T ∗Q and the constraints are all derivable from constraints imposed only on
the conﬁguration space (the q’s), the constraints are called holonomic. For example, if there is one constraint
f(q) = 0 for f : Q →R, the constraints on T ∗Q can be simply obtained by diﬀerentiation: df = 0 on T ∗Q. If
the phase space is TQ, then the constraints are holonomic iﬀthe constraints on the velocities are saying that
the velocities are tangent to some constraint manifold of the positions. A constraint then can be thought of
in terms of velocities as a subset E ⊂TM. If it is a subbundle, this constraint is thus holonomic iﬀit is
integrable in the sense of Frobenius’ theorem.
Constraints that are not holonomic, are naturally called nonholonomic constraints. Holonomic constraints
can be dealt with in the sense that one understands how to modify the equations of motion when the
constraints are imposed, by adding forces of constraint, such as centrifugal force. See, for example Goldstein
[1980, Chapter 1], and Abraham and Marsden [1978, Section 3.7]. We shall limit ourselves to the discussion
of two examples of nonholonomic constraints. See for an extensive discussion and background.
A classical example of a nonholonomic system is a disk rolling without slipping on a plane. The disk of
radius a is constrained to move without slipping on the (x, y)-plane. Let us ﬁx a point P on the disk and
call θ the angle between the radius at P and the contact point Q of the disk with the plane, as in Figure
8.5.1. Let (x, y, a) denote the coordinates of the center of the disk. Finally, if θ denotes the angle between

8.5 Constraints and Control
537
the tangent line to the disk at Q and the x-axis, the position of the disk in space is completely determined
by (x, y, θ, ϕ). These variables form elements of our conﬁguration space M = R2 × S1 × S1. The condition
that there is no slipping at Q means that the velocity at Q is zero; that is,
dx
dt + adθ
dt cos ϕ = 0,
dy
dt + adθ
dt sin ϕ = 0
(total velocity = velocity of center plus the velocity due to rotation by angular velocity dθ/dt).
ϕ
P
Q
x
z
y
θ(x,y,a)
Figure 8.5.1. A rolling disk
These constraints may be written in terms of diﬀerential forms as ω1 = 0, ω2 = 0, where
ω1 = dx + a cos ϕdθ
and
ω2 = dy + a sin ϕ dθ.
We compute that
ω = ω1 ∧ω2 = dx ∧dy + a cos ϕ dθ ∧dy + a sin ϕ dx ∧dθ,
dω1 = −a sin ϕ dϕ ∧dθ,
dω2 = a cos ϕ dϕ ∧dθ,
dω1 ∧ω = −a sin ϕ dϕ ∧dθ ∧dx ∧dy,
dω2 ∧ω = a cos ϕ dϕ ∧dθ ∧dx ∧dy.
These do not vanish identically. Thus, according to Corollary 6.4.20, this system is not integrable and hence
these constraints are nonholonomic.
A second example of constraints is due to Nelson [1967]. Consider the motion of a car and denote by (x, y)
the coordinates of the center of the front axle, ϕ the angle formed by the moving direction of the car with
the horizontal, and θ the angle formed by the front wheels with the car (Figure 8.5.2).
The conﬁguration space of the car is R2 × T2, parameterized by (x, y, ϕ, θ). We shall prove that the
constraints imposed on this motion are nonholonomic. Call the vector ﬁeld X = ∂/∂θ steer. We want to
compute a vector ﬁeld Y corresponding to drive. Let the car be at the conﬁguration point (x, y, ϕ, θ) and
assume that it moves a small distance h in the direction of the front wheels. Notice that the car moves
forward and simultaneously turns. Then the next conﬁguration is
(x + h cos(ϕ + θ) + o(h), y + h sin(ϕ + θ) + o(h), ϕ + h sin θ + o(h), θ).
Thus the “drive” vector ﬁeld is
Y = cos(ϕ + θ) ∂
∂x + sin(ϕ + θ) ∂
∂y + sin θ ∂
∂ϕ.

538
8. Applications
y
x
θ
ϕ
(x, y)
Figure 8.5.2. Automobile maneuvers
A direct computation shows that the vector ﬁeld wriggle,
W = [X, Y ] = −sin(ϕ + θ) ∂
∂x + cos(ϕ + θ) ∂
∂y + cos θ ∂
∂ϕ,
and slide,
S = [W, Y ] = −sin ϕ ∂
∂x + cos ϕ ∂
∂y ,
satisfy
[X, W] = −Y,
[S, X] = 0,
[S, Y ] = sin θ cos ϕ ∂
∂x + sin θ sin ϕ ∂
∂y ,
and
[S, W] = cos θ cos ϕ ∂
∂x + cos θ sin ϕ ∂
∂y .
Deﬁne the vector ﬁelds Z1 and Z2 by
Z1 = [S, Y ] = −W + (cos θ)S + cos θ ∂
∂ϕ,
Z2 = [S, W] = Y −(sin θ)S −sin θ ∂
∂ϕ.
A straightforward calculation shows that
[X, Z1] = Z2,
[X, Z2] −Z1,
[S, Z1] = 0,
[S, Z2] = 0,
[Z1, Z2] = 0,
that is, {X, Z1, Z2, S} span a four dimensional Lie algebra g with one dimensional center spanned by S. In
addition, its derived Lie algebra [g, g] ⊂g, equals span {Z1, Z2} and is therefore abelian and two dimensional.
Thus g has no nontrivial non-abelian Lie subalgebras.
In particular the subbundle of T(R2 × T2) spanned by X and Y is not involutive and thus not integrable.
By the Frobenius theorem, the ﬁeld of two-dimensional planes spanned by X and Y is not tangent to a
family of two-dimensional integral surfaces. Thus the motion of the car, subjected only to the constraints of
“steer” and “drive” is nonholonomic. On the other hand, the motion of the car subjected to the constraints
of “steer”, “drive” and “wriggle” is holonomic. Moreover, since the Lie algebra generated by these three
vector ﬁelds is abelian, the motion of the car with these constraints can be described by applying these three
vector ﬁelds in any order.

8.5 Constraints and Control
539
Control.
Next we turn our attention to some elementary aspects of control theory. We shall restrict our
attention to a simple version of a local controllability theorem. For extensions and many additional results,
we recommend consulting the book of and a few of the important papers and notes such as ? [?, ?], Sussmann
[1977], Hermann and Krener [1977], Russell [1979], Hermann [1980], and Ball, Marsden, and Slemrod [1982]
and references therein.
Consider a system of diﬀerential equations of the form
˙w(t) = X(w(t)) + p(t)Y (w(t))
(8.5.1)
on a time interval [0, T] with initial conditions w(0) = w0 where w takes values in a Banach manifold M, X
and Y are smooth vector ﬁelds on M and p : [0, T] →R is a prescribed function called a control.
The existence theory for diﬀerential equations guarantees that equation (8.5.1) has a ﬂow that depends
smoothly on w0 and on p lying in a suitable Banach space Z of maps of [0, T] to R, such as the space of C1
maps. Let the ﬂow of (8.5.1) be denoted
Ft(w0, p) = w(t, p, w0).
(8.5.2)
We consider the curve w(t, 0, w0) = w0(t); that is, an integral curve of the vector ﬁeld X. We say that (8.5.1)
is locally controllable (at time T) if there is a neighborhood U of w0(T) such that for any point h ∈U,
there is a p ∈Z such that w(T; p, w0) = h. In other words, we can alter the endpoint of w0(t) in a locally
arbitrary way by altering p (Figure ??).
U
h
w0(T)
w0
p ̸= 0
p = 0
Figure 8.5.3. Controllability
To obtain a condition under which local controllability can be guaranteed, we ﬁx T and w0 and consider
the map
P : Z →M;
p →w(T, p, w0).
(8.5.3)
The strategy is to apply the inverse function theorem to P. The derivative of Ft(w0, p) with respect to p in
the direction ρ ∈Z is denoted
DpFt(w0, 0) · ρ = Ltρ ∈TFt(w0,0)M.
Diﬀerentiating
d
dtw(t, p) = X(w(t, p)) + p(t)Y (w(t, p))
with respect to p at p = 0, we ﬁnd that in T 2M
d
dtLtρ = X(w0(t)) · Ltρ + (ρY (w0(t)))vertical lift.
(8.5.4)
To simplify matters, let us assume M = E is a Banach space and that X is a linear operator, so equation
(8.5.4) becomes
d
dtLtρ = X · Ltρ + ρY (w0(t)).
(8.5.5)

540
8. Applications
Equation (8.5.5) has the following solution given by the variation of constants formula
LT ρ =
 T
0
e(T −s)Xρ(s)Y (esXw0)ds
(8.5.6)
since w0(t) = etXw0 for linear equations.
8.5.1 Proposition.
If the linear map LT : Z →E given by equation (8.5.6) is surjective, then equation
(8.5.1) is locally controllable (at time T).
Proof.
This follows from the “local onto” form of the implicit function theorem (see Theorem 2.5.9)
applied to the map P. Solutions exist for time T for small p since they do for p = 0; see Corollary 4.1.25.
■
8.5.2 Corollary.
Suppose E = Rn and Y is linear as well. If
dim span {Y (w0), [X, Y ](w0), [X, [X, Y ]](w0), . . . } = n,
then equation (8.5.1) is locally controllable.
Proof.
We have the Baker–Campbell–Hausdorﬀformula
e−sXY esX = Y + s[X, Y ] + s2
2 [X, [X, Y ]] + · · · ,
obtained by expanding esX = I + sX + (s2/2)X2 + · · · and gathering terms. Substitution into equation
(8.5.6) shows that LT is surjective.
■
For the case of nonlinear vector ﬁelds and the system equation (8.5.1) on ﬁnite-dimensional manifolds,
controllability hinges on the dimension of the space obtained by replacing the foregoing commutator brackets
by Lie brackets of vector ﬁelds, n being the dimension of M. This is related to what are usually called Chow’s
theorem in control theory (see Chow [1947]).
To see that some condition involving brackets is necessary, suppose that the span of X and Y forms an
involutive distribution of TM. Then by the Frobenius theorem, w0 lies in a unique maximal two-dimensional
leaf £(w0) of the corresponding foliation. But then the solution of equation (8.5.1) can never leave £(w0), no
matter how p is chosen. Hence in such a situation, equation (8.5.1) would not be locally controllable; rather,
one would only be able to move in a two-dimensional subspace. If repeated bracketing with X increases the
dimension of vectors obtained then the attainable states increase in dimension accordingly.
Exercises
⋄8.5-1.
Check that the system in Figure 8.5.1 is nonholonomic by verifying that there are two vector ﬁelds
X, Y on M spanning the subset E of TM deﬁned by the constraints
˙x = a ˙θ cos ϕ = 0
and
˙y + a ˙θ sin ϕ = 0
such that [X, Y ] is not in E; that is, use Frobenius’ theorem directly rather than using Pfaﬃan systems.
⋄8.5-2.
Justify the names wriggle and slide for the vector ﬁelds W and S in the example of Figure 8.5.2
using the product formula in Exercise 4.2-4. Use these formulas to explain the following statement of Nelson
[1967, p. 35]: “the Lie product of “steer” and “drive” is equal to “slide” and “rotate” (= ∂/∂ϕ) on θ = 0
and generates a ﬂow which is the simultaneous action of sliding and rotating. This motion is just what is
needed to get out of a tight parking spot.”
⋄8.5-3.
The word holonomy arises not only in mechanical constraints as explained in this section but also in
the theory of connections (Kobayashi and Nomizu [1963, Volume II, Sections 7 and 8]). What is the relation
between the two uses, if any?

8.5 Constraints and Control
541
⋄8.5-4.
In linear control theory equation (8.5.1) is replaced by
˙w(t) = X · w(t) +
N

i=1
pi(t)Yi,
where X is a linear vector ﬁeld on Rn and Yi are constant vectors. By using the methods used to prove
Proposition 8.5.1, rediscover for yourself the Kalman criterion for local controllability, namely, the set
	
XkYi | k = 0, 1, . . . , n −1, i = 1, . . . , N

spans Rn.

542
8. Applications

Page 543
References
Abraham, R. [1963] Lectures of Smale on Diﬀerential Topology. Notes, Columbia University.
Abraham, R. and J. Marsden [1978] Foundations of Mechanics. Second Edition, Addison-Wesley, Reading Mass.
Abraham, R. and J. Robbin [1967] Transversal Mappings and Flows. Addison-Wesley, Reading Mass.
Adams, R. A. [1975] Sobolev Spaces. Academic Press, New York.
Arnol’d, V. I. [1966] Sur la geometrie diﬀerentielle des groupes de Lie de dimenson inﬁnie et ses applications a
L’hydrodynamique des ﬂuids parfaits. Ann. Inst. Fourier. Grenoble. 16, 319–361.
Arnol’d, V. I. [1982] Mathematical Methods of Classical Mechanics.
Springer Graduate Texts in Mathematics 60,
Second Edition, Springer-Verlag, New York.
Arnol’d, V. I. and A. Avez [1967] Theorie ergodique des systemes dynamiques. Gauthier-Villars, Paris (English ed.,
Addison-Wesley, Reading, Mass., 1968).
Ball, J. M. and J. E. Marsden [1984] Quasiconvexity at the boundary, positivity of the second variation and elastic
stability. Arch. Rat. Mech. An. 86, 251–277.
Ball, J. M., J. E. Marsden, and M. Slemrod [1982] Controllability for distributed bilinear systems. SIAM J. Control
and Optim. 20, 575–597.
Bambusi, D. [1999], On the Darboux theorem for weak symplectic manifolds, Proc. Amer. Math. Soc., 127, 3383–
3391.
Banach, S. [1932] Th´eorie des ´Operations Lin´eaires. Warsaw. Reprinted by Chelsea Publishing Co., New York, 1955.
Batchelor, G. K. [1967] An Introduction to Fluid Dynamics. Cambridge Univ. Press, Cambridge, England.
Bates, L. M. [1990] An extension of Lagrange multipliers. Appl. Analysis 36, 265–268.
Berger, M. and D. Ebin [1969] Some decompositions of the space of symmetric tensors on a Riemannian manifold.
J. Diﬀ. Geom 3, 379–392.
Birkhoﬀ, G. D. [1931] Proof of the ergodic theorem. Proc. Nat. Acad. Sci. 17, 656–660.
Birkhoﬀ, G. D. [1935] Integration of functions with values in a Banach space. Trans. Am. Math. Soc. 38, 357–378.

544
References
Bleecker, D. [1981] Gauge Theory and Variational Principles. Global Analysis: Pure and Applied 1, Addison-Wesley,
Reading, Mass.
Bloch, A.M., J. Ballieul, P. Crouch and J. E. Marsden [2001], Nonholonomic Mechanics and Control, Springer-Verlag.;
(to appear).
Bochner, S. [1933] Integration von Functionen, deren Werte die Elemente eines Vektorraumes sind. Fund. Math. 20,
262–270.
Bolza, O. [1904] Lectures on the Calculus of Variations. Chicago University Press. Reprinted by Chelsea, 1973.
Bonic, R. and F. Reis [1966] A characterization of Hilbert space. Acad. Bras. de Cien. 38, 239–241.
Bonic, R. and J. Frampton [1966] Smooth functions on Banach manifolds. J. Math. Mech. 16, 877–898.
Bony, J. M. [1969] Principe du maximum, inegalit´e de Harnack et unicit´e du probl´em`e de Cauchy pour les operateurs
elliptiques d´egener´es. Ann. Inst. Fourier Grenoble 19, 277–304.
Born, M. and L. Infeld [1935] On the quantization of the new ﬁeld theory. Proc. Roy. Soc. A 150, 141–162.
Bott, R. [1970] On a topological obstruction to integrability. Proc. Symp. Pure Math. 16, 127–131.
Bourbaki, N. [1971] Vari´et´es diﬀerentielles et analytiqes. Fascicule de r´esultats 33, Hermann.
Bourguignon, J. P. [1975] Une stratiﬁcation de l’espace des structures riemanniennes. Comp. Math. 30, 1–41.
Bourguignon, J. P. and H. Brezis [1974] Remarks on the Euler equation. J. Funct. An. 15, 341–363.
Bowen, R. [1975] Equilibrium States and the Ergrodic Theory of Anosov Diﬀeomorphisms. Springer Lect. Notes in
Math. 470, Springer-Verlag.
Bredon, G. E. [1972] Introduction to Compact Transformation Groups. Academic Press, New York.
Brezis, H. [1970] On Characterization of Flow Invariant Sets. Comm. Pure Appl. Math. 23, 261–263.
Brockett, R. W. [1970] Finite Dimensional Linear Systems. Wiley, New York.
Brockett, R. W. [1983] A Geometrical Framework for Nonlinear Control and Estimation. CBMS Conference Series,
SIAM. et al.
Buchner, M., J. Marsden, and S. Schecter [1983a] Applications of the blowing-up construction and algebraic geometry
to bifurcation problems. J. Diﬀ. Eqs. 48, 404–433.
Buchner, M., J. Marsden, and S. Schecter [1983b] Examples for the inﬁnite dimensional Morse Lemma. SIAM J.
Math An. 14, 1045–1055.
Burghelea, D., A. Albu, and T. Ratiu [1975] Compact Lie Group Actions (in Romanian). Monograﬁi Matematice 5,
Universitatea Timisoara.
Burke, W. L. [1980] Spacetime, Geometry, Cosmology. University Science Books, Mill Valley, Ca.
Camacho, A. and A. L. Neto [1985] Geometric Theory of Foliations. Birkh¨auser, Boston, Basel, Stuttgart.
Cantor, M. [1981] Elliptic operators and the decomposition of tensor ﬁelds. Bull. Am. Math. Soc. 5, 235–262.
Caratheodory, C. [1909] Untersuchungen ¨uber die Grundlagen der Thermodynamik. Math. Ann. 67, 355–386.
Caratheodory, C. [1965] Calculus of Variation and Partial Diﬀerential Equations. Holden-Day, San Francisco.
Cartan, E. [1945] Les systemes diﬀerentiels exterieurs et leur applications geometriques. Hermann, Paris.
Chen, F. F. [1974] Introduction to Plasma Physics. Plenum.

References
545
Chernoﬀ, P. [1974] Product Formulas, Nonlinear Semigroups and Addition of Unbounded Operators. Memoirs of Am.
Math. Soc. 140.
Chernoﬀ, P. and J. Marsden [1974] Properties of Inﬁnite Dimensional Hamiltonian Systems. Springer Lect. Notes in
Math. 425.
Chevalley, C. [1946] Theory of Lie groups. Princeton University Press, Princeton, N.J.
Choquet, G. [1969] Lectures on Analysis. 3 vols, Addison-Wesley, Reading, Mass.
Choquet-Bruhat, Y., C. DeWitt-Morette, and M. Dillard-Blieck [1982] Analysis, Manifolds, and Physics. Rev. ed.
North-Holland, Amsterdam.
Chorin, A. and J. Marsden [1993] A Mathematical Introduction to Fluid Mechanics. Third Edition, Springer Verlag.
Chorin, A., T. J. R. Hughes, M. F. McCracken, and J. Marsden [1978] Product formulas and numerical algorithms.
Comm. Pure Appl. Math. 31, 205–256.
Chow, S. N. and J. K. Hale [1982] Methods of Bifucation Theory. Springer, New York.
Chow, S. N., J. Mallet-Paret, and J. Yorke [1978] Finding zeros of maps: hompotopy methods that are constuctive
with probability one. Math. Comp. 32, 887–899.
Chow, W. L. [1947] ¨Uber Systeme von linearen partiellen Diﬀerentialgleichungen. Math. Ann. 117, 89–105.
Clebsch, A. [1859] ¨Uber die Integration der hydrodynamischen Gleichungen. J. Reine. Angew. Math. 56, 1–10.
Clemmow and Daugherty [1969] Electrodynamics of Particles and Plasmas. Addison Wesley.
Cook, J. M. [1966] Complex Hilbertian structures on stable linear dynamical systems. J. Math. Mech. 16, 339–349.
Craioveanu, M. and T. Ratiu [1976] Elements of Local Analysis. Vol. 1, 2 (in Romanian), Monograﬁi Mathematice
6, 7, Universitatea Timisoara.
Crandall, M. G. [1972] A generalization of Peano’s existence theorem and ﬂow invariance. Proc. Amer. Math. Soc.
36, 151–155.
Curtain, R. F. and A. J. Pritchard [1977] Functional Analysis in Modern Applied Mathematics. Mathematics in
Science and Engineering, 132. Academic Press.
Davidson, R. C. [1972] Methods in Nonlinear Plasma Theory. Academic Press.
de Rham, G. [1955] Vari´et´es diﬀ´erentiables. Formes, courants, formes harmoniques. Hermann, Paris.
Rham, G. [1984] Diﬀerentiable Manifolds: Forms, Currents, Harmonic Forms. Grundlehren der Math. Wis-
senschaften. 266, Springer-Verlag, New York.
Dirac, P. A. M. [1964] Lectures on Quantum Mechanics. Belfer Graduate School of Sci., Monograph Series 2, Yeshiva
University.
Donaldson, S. K. [1983] An application of gauge theory to four-dimensional topology. J. Diﬀ. Geom. 18, 279–315.
Duﬀ, G. and D. Spencer [1952] Harmonic tensors on Riemannian manifolds with boundary. Ann. Math. 56, 128–156.
Duﬃng, G. [1918] Erzwungene Schwingungen bei ver¨anderlichen Eigenfrequenz. Vieweg u. Sohn, Braunschweig.
Dunford, N. and Schwartz, J. T. [1963] Linear operators. Part II: Spectral theory. Self adjoint operators in Hilbert
space. Interscience Publishers John Wiley & Sons New York-London.
Dzyaloshinskii, I. E. and G. E. Volovick [1980] Poisson Brackets in Condensed Matter Physics. Ann. of Phys. 125,
67–97.
Ebin, D. [1970] On completeness of Hamiltonian vector ﬁelds. Proc. Am. Math. Soc. 26, 632–634.

546
References
Ebin, D. and J. Marsden [1970] Groups of diﬀeomorphisms and the motion of an incompressible ﬂuid. Ann. Math.
92, 102–163.
Eckmann, J.-P. and D. Ruelle [1985], Ergodic theory of chaos and strange attractors, Rev. Modern Phys., 57, 617–656,
Addendum, p. 1115.
Eells, J. [1958] On the geometry of function spaces. Symposium de Topologia Algebrica, Mexico UNAM, Mexico City,
303–307.
Elliasson, H. [1967] Geometry of manifolds of maps. J. Diﬀ. Geom. 1, 169–194.
Elworthy, D. and A. Tromba [1970a] Diﬀerential structures and Fredholm maps on Banach manifolds. Proc. Symp.
Pure Math. 15, 45–94.
Elworthy, D. and A. Tromba [1970b] Degree theory on Banach manifolds. Proc. Symp. Pure Math. 18, 86–94.
Fischer, A. [1970] A theory of superspace. Relativity, M. Carmelli et al. (Eds), Plenum, New York.
Fischer, A. and J. Marsden [1975] Deformations of the scalar curvature. Duke Math. J. 42, 519–547.
Fischer, A. and J. Marsden [1979] Topics in the dynamics of general relativity. Isolated Gravitating Systems in General
Relativity, J. Ehlers (ed.), Italian Physical Society, North-Holland, Amsterdam, 322–395.
Flanders, H. [1963] Diﬀerential Forms. Academic Press, New York.
Foias, C. and Temam, R. [1977] Structure of the set of stationary solutions of the Navier-Stokes equations. Comm.
Pure Appl. Math. 30, 149–164.
Fraenkel, L. E. [1978] Formulae for high derivatives of composite functions. Math. Proc. Camb. Phil. Soc. 83, 159–165.
Freed, D. S.; Uhlenbeck, K. K. [1984] Instantons and four-manifolds. Mathematical Sciences Research Institute
Publications, 1. Springer-Verlag.
Friedman, A. [1969] Partial diﬀerential equations. Holt, Rinehart and Winston.
Frampton, J. and A. Tromba [1972] On the classiﬁcation of spaces of H¨older continuous functions. J. Funct. An. 10,
336–345.
Fulton, T., F. Rohrlich, and L. Witten [1962] Conformal invariance in physics. Rev. Mod. Phys. 34, 442–457.
Gaﬀney, M. P. [1954] A special Stokes’s theorem for complete Riemannian manifolds. Ann. Math. 60, 140–145.
Gardener, C. S., J. M. Greene, M. D. Kruskal and R. M. Muira [1974] Korteweg–deVries Equation and Generaliza-
tions. VI. Methods for Exact Solution. Comm. Pure Appl. Math. 27, 97–133.
Glaeser, G. [1958] ´Etude de quelques alg`ebres Tayloriennes. J. Anal. Math. 11, 1–118.
Goldstein, H. [1980] Classical Mechanics. 2nd ed. Addison-Wesley, Reading, Mass.
Golubitsky, M. and J. Marsden [1983] The Morse lemma in inﬁnite dimensions via singularity theory. SIAM. J. Math.
An. 14, 1037–1044.
Golubitsky, M. and V. Guillemin [1974] Stable Mappings and their Singularities.
Graduate Texts in Mathematics
14, Springer-Verlag, New York.
Golubitsky, M. and D. Schaeﬀer [1985] Singularities and Groups in Bifurcation Theory I. Springer-Verlag, New York.
Graves, L. [1950] Some mapping theorems. Duke Math. J. 17, 111–114.
Grauert, H. [1958] On Levi’s problem and the imbedding of real-analytic manifolds. Am. J. of. Math. 68, 460–472.
Greub, W., S. Halperin, and R. Vanstone [1972] Connections, Curvature, and Cohomology. Vol. I: De Rham Coho-
mology of Manifolds and Vector Bundles. Pure and Applied Mathematics, 47-I. Academic Press.

References
547
Greub, W., S. Halperin, and R. Vanstone [1973] Connections, Curvature, and Cohomology. Vol. II: Lie Groups,
Principal Bundles, and Characteristic Classes. Pure and Applied Mathematics, 47-II. Academic Press.
Greub, W., S. Halperin, and R. Vanstone [1976] Connections, Curvature, and Cohomology. Volume III: Cohomology
of Principal Bundles and Homogeneous Spaces. Pure and Applied Mathematics, 47-III. Academic Press.
Grinberg, E.L. [1985] On the smoothness hypothesis in Sard’s theorem. Amer. Math. Monthly 92, 733–734.
Guckenheimer, J. and P. Holmes [1983] Nonlinear Oscillations, Dynamical Systems and Bifurcations of Vector Fields.
Springer App. Math. Sci. 43, Springer-Verlag.
Guillemin, V. and A Pollack [1974] Diﬀerential Topology. Prentice-Hall, Englewood Cliﬀs, N.J.
Guillemin, V. and S. Sternberg [1977] Geometric Asymptotics. American Math. Soc. Surv. 14.
Guillemin, V. and S. Sternberg [1984] Symplectic Techniques in Physics. Cambridge University Press.
Gurtin, M. [1981] An Introduction to Continuum Mechanics. Academic Press, New York.
Hale, J. K. [1969] Ordinary Diﬀerential Equations. Wiley-Interscience, New York.
Hale, J. K., L. T. Magalh˜aes, L. T. and Oliva, W. M. An introduction to inﬁnite-dimensional dynamical systems—
geometric theory. Applied Math. Sciences, 47, Springer-Verlag.
Halmos, P. R. [1956] Lectures on Ergodic Theory. Chelsea, New York.
Hamilton, R. [1982] The inverse function theorem of Nash and Moser. Bull. Am. Math. Soc. 7, 65–222.
Hartman, P. [1972] On invariant sets and on a theorem of Wazewski. Proc. Am. Math. Soc. 32, 511–520.
Hartman, P. [1973] Ordinary Diﬀerential Equations. 2nd ed. Reprinted by Birkh¨auser, Boston.
Hawking, S. and G. F. R. Ellis [1973] The Large Scale Structure of Space-Time. Cambridge Univ.Press, Cambridge,
England.
Hayashi, C. [1964] Nonlinear Oscillations in Physical Systems. McGraw-Hill, New York.
Hermann, R. [1973] Geometry, Physics, and Systems. Marcel Dekker, New York.
Hermann, R. [1977] Diﬀerential Geometry and the Calculus of Variations. 2nd ed. Math. Sci. Press, Brookline, Mass.
Hermann, R. [1980] Cartanian Geometry, Nonlinear Waves, and Control Theory. Part B, Math. Sci. Press, Brookline,
Mass.
Hermann, R. and A. J. Krener [1977] Nonlinear conrollability and observability. IEEE Trans. on Auto. Control. 22,
728–740.
Hildebrandt, T. H. and L. M. Graves [1927] Implicit functions and their diﬀerentials in general analysis. Trans. Am.
Math. Soc. 29, 127–53.
Hille, E. and R. S. Phillips [1957] Functional Analysis and Semi-groups. Am. Math. Soc. Colloq. Publ., Vol. XXXI.
Corrected printing, 1974.
Hilton, P. J. and S. Wylie. [1960] Homology Theory: An Introduction to Algebraic Topology. Cambridge Univ. Press,
New York.
Hirsch, M. W. [1976] Diﬀerential Topology. Graduate Texts in Mathematics 33, Springer-Verlag. New York.
Hirsch, M. W.; Pugh, C. C. Stable manifolds and hyperbolic sets. Proc. Sympos. Pure Math., 14, 133–163.
Hirsch, M. W. and S. Smale [1974] Diﬀerential Equations, Dynamical Systems, and Linear Algebra. Academic Press,
New York.

548
References
Hodge, V. W. D. [1952] Theory and Applications of Harmonic Integrals. 2nd ed. Cambridge University Press. Cam-
bridge. England.
Holm, D. D. J. E. Marsden, T. Ratiu and A. Weinstein [1985] Nonlinear Stability of Fluid and Plasma Equilibria.
Physics Reports 123, 1–116
Holmann, H. and H. Rummler [1972] Alternierende Diﬀerentialformen. BI–Wissenschaftsverlag. Z¨urich.
Holmes, P. [1979a] A nonlinear oscillator with a strange attractor. Phil. Trans. Roy. Soc. London.
Holmes, P. [1979b] Averaging and chaotic motions in forced oscillations. SIAM J. on Appl. Math. 38, 68–80, and 40,
167–168.
Hopf, V. H. [1931] ¨Uber die Abbildungen der Dreidimensionalen Sph¨are auf die Kugelf¨ache. Math. Annalen. 104,
637–665.
Huebsch, W. [1955] On the covering homotopy theorem. Annals. Math. 61, 555–563.
Hughes, T. J. R. and J. Marsden [1977] Some Applications of Geometry in Continuum Mechanics. Reports on Math.
Phys. 12, 35–44.
Husemoller, D. [1966] Fibre Bundles. 3nd ed., 1994. Graduate Texts in Mathematics 20, Springer-Verlag, New York.
Ichiraku, Shigeo [1985 A note on global implicit function theorems. IEEE Trans. Circuits and Systems 32, 503–505
Irwin, M. C. [1980] Smooth Dynamical Systems. Academic Press.
Iw´inski, Z. R. and K. A. Turski [1976] Canonical theories of systems interacting electromagnetically. Letters in Applied
and Engineering Sciences 4, 179–191
John, F. [1975] Partial Diﬀerential Equations. 2nd ed. Applied Mathematical Sciences 1. Springer-Verlag, New York.
Karp, L. [1981] On Stokes’ theorem for non-compact manifolds. Proc. Am. Math. Soc. 82, 487–490.
Kaufman, R. [1979] A singular map of a cube onto a square. J. Diﬀerential Geom. 14, 593–594.
Kato, T. [1951] Fundamental properties of Hamiltonian operators of Schr¨odinger type, Trans. Amer. Math. Soc., 70,
195–211.
Kato, T. [1976] Perturbation Theory for Linear Operators, Springer-Verlag, Second Edition, Grundlehren der Math-
ematischen Wissenschaften, Reprinted as a Springer Classic, 1995.
Kaufman, A. N. and P. J. Morrison [1982] Algebraic Structure of the Plasma Quasilinear Equations. Phys. Lett. 88,
405–406
Kaufmann, R. [1979] A singular map of a cube onto a square. J. Diﬀ. Equations 14, 593–594.
Kelley, J. [1975] General Topology. Graduate Texts in Mathematics 27, Springer-Verlag, New York.
Klingenberg, W. [1978] Lectures on Closed Geodesics. Grundlehren der Math. Wissenschaften 230, Springer-Verlag,
New York.
Knowles, G. [1981] An Introduction to Applied Optimal Control. Academic Press, New York.
Kobayashi, S. and K. Nomizu [1963] Foundations of Diﬀerential Geometry. Wiley, New York.
Kodaira, K. [1949] Harmonic ﬁelds in Riemannian manifolds. Ann. of Math. 50, 587–665.
Koopman, B. O. [1931] Hamiltonian systems and transformations in Hilbert space. Proc. Nat. Acad. Sci. 17, 315–318.
Lang, S. [1999] Fundamentals of Diﬀerential Geometry. Graduate Texts in Mathematics, 191. Springer-Verlag, New
York.

References
549
LaSalle, J. P. [1976] The stability of dynamical systems. Regional Conf. Series in Appl. Math.. Soc. for Ind. and Appl.
Math.
Lawson, H. B. [1977] The Qualitative Theory of Foliations. American Mathematical Society CBMS Series 27.
Lax, P. D. [1973] Hyperbolic Systems of Conservative Laws and the Mathematical Theory of Shock Waves. SIAM,
CBMS Series 11.
Leonard, E. and K. Sunderesan [1973] A note on smooth Banach spaces. J. Math. Anal. Appl. 43, 450–454.
Lewis, D., J. E. Marsden and T. Ratiu [1986] The Hamiltonian Structure for Dynamic Free Boundary Problems.
Physica 18D, 391–404.
Lindenstrauss, J. and L. Tzafriri [1971] On the complemented subspace problem. Israel J. Math. 9, 263–269.
Loomis, L. and S. Sternberg [1968] Advanced Calculus. Addison-Wesley, Reading Mass.
Luenberger, D. G. [1969] Optimization by Vector Space Methods. John Wiley, New York.
Mackey, G. W. [1963] Mathematical Foundations of Quantum Mechanics. Addison-Wesley, Reading. Mass.
Mackey, G. W. [1962] Point realizations of transformation groups. Illinois J. Math. 6, 327–335.
Marcinkiewicz, J. and A. Zygmund [1936] On the diﬀerentiability of functions and summability of trigonometric
series. Fund. Math. 26, 1–43.
Marsden, J. E. [1968a] Generalized Hamiltonian mechanics. Arch. Rat. Mech. An. 28, 326–362.
Marsden, J. E. [1968b] Hamiltonian one parameter groups. Arch. Rat. Mech. An. 28, 362–396.
Marsden, J. E. [1972] Darboux’s theorem fails for weak symplectic forms. Proc. Am. Math. Soc. 32, 590–592.
Marsden, J. E. [1973] A proof of the Cald´eron extension theorem. Can. Math. Bull. 16, 133–136.
Marsden, J. E. [1974] Applications of Global Analysis in Mathematical Physics. Publish or Perish, Waltham, Mass.
Marsden, J. E. [1976] Well-posedness of equations of non-homogeneous perfect ﬂuid. Comm. PDE 1, 215–230.
Marsden, J. E. [1981] Lectures on Geometric Methods in Mathematical Physics. CBMS 37, SIAM, Philadelphia.
Marsden, J. E. [1992], Lectures on Mechanics, Cambridge University Press, London Math. Soc. Lecture Note Ser.
174.
Marsden, J. E. and M. J. Hoﬀman [1993] Elementary Classical Analysis. Second Edition, W.H. Freeman, San Fran-
cisco.
Marsden, J. E. and T. Hughes [1976] A Short Course in Fluid Mechanics. Publish or Perish.
Marsden, J. E. and T. J. R. Hughes [1983] Mathematical Foundations of Elasticity. Prentice Hall, reprinted by Dover
Publications, N.Y., 1994.
Marsden, J. E. and T. S. Ratiu [1999] Introduction to Mechanics and Symmetry. Texts in Applied Mathematics 17,
Springer-Verlag, 1994. Second Edition, 1999.
Marsden, J. E., T. Ratiu and A. Weinstein [1982] Semidirect products and reduction in mechanics. Trans. Am. Math.
Soc. 281, 147–177.
Marsden, J. E. and A. Tromba [1996] Vector Calculus. Fourth Edition, W.H. Freeman, San Francisco.
Marsden, J. E. and A. Weinstein [1974] Reduction of symplectic manifolds with symmetry. Rep. Math. Phys. 5,
121–130.

550
References
Marsden, J. E. and A. Weinstein [1982] The Hamiltonian structure of the Maxwell–Vlasov equations. Physica D 4,
394–406.
Marsden, J. E. and A. Weinstein [1983] Coadjoint orbits, vortices and Clebsch variables for incompressible ﬂuids.
Physica D 7, 305–323.
Marsden, J. E. and J. Scheurle [1987] The construction and smoothness of invariant manifolds by the deformation
method. SIAM J. Math. An. (to appear).
Martin, J. L. [1959] Generalized Classical Dynamics and the “Classical Analogue” of a Fermi Oscillation. Proc. Roy.
Soc, A251, 536.
Martin, R. H. [1973] Diﬀerential equations on closed subsets of a Banch space. Trans. Am. Math. Soc. 179, 339–414.
Massey, W. S. [1991] A Basic Course in Algebraic Topology. Graduate Texts in Mathematics, 127. Springer-Verlag,
New York, 1991.
Mayer, A. [1872] ¨Uber unbeschr¨ankt integrable Systeme von linearen Diﬀerential-Gleichungen. Math. Ann. 5, 448–
470.
Mazur, S. and S. Ulam. [1932] Sur les transformations isometriques d’espaces vectoriels, normes. C. R. Acad. Sci.,
Paris 194, 946–948.
Milnor, J. [1956] On manifolds homeomorphic to the 7-sphere. Ann. Math. 64, 399–405.
Milnor, J. [1965] Topology from the Diﬀerential Viewpoint. University of Virginia Press, Charlottesville, Va.
Misner, C., K. Thorne, and J. A. Wheeler [1973] Gravitation. W.H. Freeman, San Francisco.
Morrey, C. B. [1966] Multiple Integrals in the Calculus of Variations. Springer-Verlag, New York.
Morrison, P. J. [1980] The Maxwell–Vlasov Equations as a Continuous Hamiltonian System. Phys. Lett. 80A, 383–
386.
Morrison, P. J. and J. M. Greene [1980] Noncanonical Hamiltonian Density formulation of Hydrodynamics and Ideal
Magnetohydrodyanics. Phys. Rev. Lett. 45, 790–794.
Moser, J. [1965] On the volume elements on a manifold. Trans. Am. Math. Soc. 120, 286–294.
Nagumo, M. [1942] ¨Uber die Lage der Integralkurven gew¨ohnlicher Diﬀerential-Gleichungen. Proc. Phys. Math. Soc.
Jap. 24, 551–559.
Nelson, E. [1959] Analytic vectors. Ann. Math. 70, 572–615.
Nelson, E. [1967] Tensor Analysis. Princeton University Press, Princeton, N.J.
Nelson, E. [1969] Topics in Dynamics I: Flows. Princeton University Press, Princeton, N.J.
Newns, W. F. and A. G. Walker [1956] Tangent planes to a diﬀerentiable manifold. J. London Math. Soc. 31, 400–407.
Nirenberg, L. [1974] Topics in Nonlinear Analysis. Courant Institute Lecture Notes.
Novikov, S. P. [1965] Topology of Foliations. Trans. Moscow Math. Soc., 268–304.
Oster, G. F. and A. S. Perelson [1973] Systems, circuits and thermodynamics. Israel J. Chem. 11, 445–478, and
Arch. Rat. Mech. An. 55, 230–274, and 57, 31–98.
Palais, R. [1954] Deﬁnition of the exterior derivative in terms of the Lie derivative. Proc. Am. Math. Soc. 5, 902–908.
Palais, R. [1959] Natural operations on diﬀerential forms. Trans. Amer. Math. Soc. 92, 125–141.
Palais, R. [1963] Morse theory on Hilbert manifolds. Topology 2, 299–340.

References
551
Palais, R. [1965a] Seminar on the the Atiyah–Singer Index Theorem. Princeton University Press, Princeton, N.J.
Palais, R. [1965b] Lectures on the Diﬀerential Topology of Inﬁnite Dimensional Manifolds. Notes by S. Greenﬁeld,
Brandeis University.
Palais, R. [1968] Foundations of Global Nonlinear Analysis. Addison-Wesley, Reading, Mass.
Palais, R. [1969] The Morse lemma on Banach spaces. Bull .Am. Math. Soc. 75, 968–971.
Pauli, W. [1953] On the Hamiltonian Structure of Non–local Field Theories. Il Nuovo Cimento X, 648–667.
Pavel, N. H. [1984] Diﬀerential Equations, Flow Invariance and Applications. Research Notes in Mathematics, Pit-
man, Boston-London.
Penot, J.-P. [1970] Sur le th´eor`eme de Frobenius. Bull. Math. Soc. France 98, 47–80.
Pﬂuger, A. [1957] Theorie der Riemannschen Fl¨achen. Grundlehren der Math. Wissenshaften 89, Springer-Verlag,
New York.
Povzner, A. [1966] A global existence theorem for a nonlinear system and the defect index of a linear operator. Transl.
Am. Math. Soc. 51, 189–199.
Rao, M. M. [1972] Notes on characterizing Hilbert space by smoothness and smoothness of Orlicz spaces. J. Math.
Anal. Appl. 37, 228–234.
Rayleigh, B. [1887] The Theory of Sound. 2 vols., (1945 ed.), Dover, New York.
Reeb, G. [1952] Sur certains propriet´es topologiques des vari´et´es feuillet´ees. Actual. Sci. Ind. 1183. Hermann, Paris.
Redheﬀer, R. M. [1972] The theorems of Bony and Brezis on ﬂow-invariant sets. Am. Math. Monthly 79, 740–747.
Reed, M. and B. Simon [1974] Methods on Modern Mathematical Physics. Vol. 1: Functional Analysis. Vol. 2: Self-
adjointness and Fourier Analysis, Academic Press, New York.
Restrepo, G. [1964] Diﬀerentiable norms in Banach spaces. Bull. Am. Math. Soc. 70, 413–414.
Riesz, F. [1944] Sur la th´eorie ergodique. Comm. Math. Helv. 17, 221–239.
Riesz, F. and Sz.-Nagy, B. [1952] Functional analysis. Second Edition, 1953, translated from the French edition by
Leo F. Boron, Ungar. Reprinted by Dover Publications, Inc., 1990.
Robbin, J. [1968] On the existence theorem for diﬀerential equations. Proc. Am. Math. Soc. 19, 1005–1006.
Roth, E. H. [1986] Various Aspects of Degree Theory in Banach Spaces. AMS Surveys and Monographs 23.
Royden, H. [1968] Real Analysis. 2nd ed., Macmillan, New York.
Rudin, W. [1966] Real and Complex Analysis. McGraw-Hill, New York.
Rudin, W. [1973] Functional Analysis. McGraw-Hill, New York.
Rudin, W. [1976] Principles of Mathematical Analysis. 3rd ed., McGraw-Hill, New York.
Russell, D. [1979] Mathematics of Finite Dimensional Control Systems, Theory and Design. Marcel Dekker, New
York.
Sard, A. [1942] The measure of the critical values of diﬀerentiable maps. Bull. Am. Math. Soc. 48, 883–890.
Sasaki, S. [1958] On the diﬀerential geometry of tangent bundles of Riemannian manifolds. Tohuku Math. J. 10,
338–354.
Schutz, B. [1980] Geometrical Methods of Mathematical Physics. Cambridge University Press, Cambridge, England.

552
References
Schwartz, J. T. [1967] Nonlinear Functional Analysis. Gordon and Breach, New York.
Serre, J. P. [1965] Lie Algebras and Lie Groups. W. A. Benjamin, Inc., Reading, Mass.
Sims, B. T. [1976] Fundamentals of Topology. Macmillan, NY.
Singer, I. and J. Thorpe [1976] Lecture Notes on Elementary Topology and Geometry. Undergraduate Texts in
Mathematics, Springer-Verlag, New York.
Smale, S. [1964] Morse theory and a nonlinear generalization of the Dirichlet problem. Ann. Math. 80, 382–396.
Smale, S. [1967] Diﬀerentiable dynamical systems. Bull. Am. Math. Soc. 73, 747–817.
Smale, S. [1965] An inﬁnite-dimensional version of Sard’s theorem. Amer. J. Math. 87, 861–866.
Smoller, J. [1983] Mathematical Theory of Shock Waves and Reaction Diﬀusion Equations. Grundlehren der Math.
Wissenschaﬀen 258, Springer-Verlag, New York.
Sobolev, S. S. [1939] On the theory of hyperbolic partial diﬀerential equations. Mat. Sb. 5, 71–99.
Sommerfeld, A. [1964] Thermodynamics and Statistical Mechanics. Lectures on Theoretical Physics 5. Academic
Press, New York.
Souriau, J. M. [1970] Structure des Systemes Dynamiques. Dunod, Paris
Spivak, M. [1979] Diﬀerential Geometry. 1–5. Publish or Perish, Waltham, Mass.
Steenrod, N. [1957] The Topology of Fibre Bundles. Princeton University Press. Reprinted 1999.
Stein, E. [1970] Singular Integrals and Diﬀerentiability Properties of Functions. Princeton Univ. Press, Princeton,
N.J.
Sternberg, S. [1983] Lectures on Diﬀerential Geometry. 2nd ed., Chelsea, New York.
Sternberg, S. [1969] Celestial Mechanics. 1,2. Addison-Wesley, Reading, Mass.
Stoker, J. J. [1950] Nonlinear Vibrations. Wiley, New York.
Stone, M. [1932a] Linear transformations in Hilbert space. Am. Math. Soc. Colloq. Publ. 15.
Stone, M. [1932b] On one-parameter unitary groups in Hilbert space. Ann. of. Math. 33, 643–648.
Sundaresan, K. [1967] Smooth Banach spaces. Math. Ann. 173, 191–199.
Sussmann, H. J. [1975] A generalization of the closed subgroup theorem to quotients of arbitrary manifolds. J. Diﬀ.
Geom. 10, 151–166.
Sussmann, H. J. [1977] Existence and uniqueness of minimal realizations of nonlinear systems. Math. Systems Theory
10, 263–284.
Takens, F. [1974] Singularities of vector ﬁelds. Publ. Math. IHES. 43, 47–100.
Tromba, A. J. [1976] Almost-Riemannian structures on Banach manifolds: the Morse lemma and the Darboux
theorem. Canad. J. Math. 28, 640–652.
Trotter, H. F. [1958] Approximation of semi-groups of operators. Paciﬁc. J. Math. 8, 887–919.
Tuan, V. T. and D. D. Ang [1979] A representation theorem for diﬀerentiable functions. Proc. Am. Math. Soc. 75,
343–350.
Ueda, Y. [1980] Explosion of strange attractors exhibited by Duﬃng’s equation. Ann. N.Y. Acad. Sci. 357, 422–434.
Varadarajan, V. S. [1974] Lie Groups, Lie Algebras, and Their Representations. Graduate Texts in Math. 102,
Springer-Verlag, New York.

References
553
Veech, W. A. [1971] Short proof of Sobczyk’s theorem. Proc. Amer. Math. Soc. 28, 627–628.
von Neumann, J. [1932] Zur Operatorenmethode in der klassischen Mechanik Ann. Math. 33, 587–648, 789.
von Westenholz, C. [1981] Diﬀerential Forms in Mathematical Physics. North-Holland, Amsterdam.
Warner, F. [1983] Foundations of Diﬀerentiable Manifolds and Lie Groups. Graduate Texts in Math. 94, Springer-
Verlag, New York (Corrected Reprint of the 1971 Edition).
Weinstein, A. [1969] Symplectic structures on Banach manifolds. Bull. Am. Math. Soc. 75, 804–807.
Weinstein, A. [1977] Lectures on Symplectic Manifolds. CBMS Conference Series 29, American Mathematical Society.
Wells, J. C. [1971] C1-partitions of unity on non-separable Hilbert space. Bull. Am. Math. Soc. 77, 804–807.
Wells, J. C. [1973] Diﬀerentiable functions on Banach spaces with Lipschitz derivatives. J. Diﬀ. Geometry 8, 135–152.
Wells, R. [1980] Diﬀerential Analysis on Complex Manifolds. 2nd ed., Graduate Texts in Math. 65, Springer-Verlag,
New York.
Whitney, H. [1935] A function not constant on a connected set of critical points. Duke Math. J. 1, 514–517.
Whitney, H. [1943a] Diﬀerentiability of the remainder term in Taylor’s formula. Duke Math. J. 10, 153–158.
Whitney, H. [1943b] Diﬀerentiable even functions. Duke Math. J. 10, 159–160.
Whitney, H. [1944] The self intersections of a smooth n-manifold in 2n-space. Ann. of. Math. 45, 220–246.
Wu, F. and C. A. Desoer [1972] Global inverse function theorem. IEEE Trans. CT. 19, 199–201.
Wyatt, F., L. O. Chua, and G. F. Oster [1978] Nonlinear n-port decomposition via the Laplace operator. IEEE
Trans. Circuits Systems 25, 741–754.
Yamamuro, S. [1974] Diﬀerential Calculus in Topological Linear Spaces. Springer Lecture Notes 374.
Yau, S. T. [1976] Some function theoretic properties of complete Riemannian manifolds and their applications to
geometry. Indiana Math J. 25, 659–670.
Yorke, J. A. [1967] Invariance for ordinary diﬀerential equations. Math. Syst. Theory. 1, 353–372.

This is page 265
Printer: Opaque this
9
An Introduction to Lie Groups
To prepare for the next chapters, we present some basic facts about Lie
groups. Alternative expositions and additional details can be obtained from
Abraham and Marsden [1978], Olver [1986], and Sattinger and Weaver
[1986]. In particular, in this book we shall require only elementary facts
about the general theory and a knowledge of a few of the more basic groups,
such as the rotation and Euclidean groups.
Here are how some of the basic groups occur in mechanics:
Linear and Angular Momentum.
These arise as conserved quantities
associated with the groups of translations and rotations in space.
Rigid Body.
Consider a free rigid body rotating about its center of mass,
taken to be the origin. “Free” means that there are no external forces, and
“rigid” means that the distance between any two points of the body is
unchanged during the motion. Consider a point X of the body at time
t = 0, and denote its position at time t by f(X, t). Rigidity of the body
and the assumption of a smooth motion imply that f(X, t) = A(t)X, where
A(t) is a proper rotation, that is, A(t) ∈SO(3), the proper rotation group
of R3, the 3 × 3 orthogonal matrices with determinant 1. The set SO(3)
will be shown to be a three-dimensional Lie group, and since it describes
any possible position of the body, it serves as the conﬁguration space. The
group SO(3) also plays a dual role of a symmetry group, since the same
physical motion is described if we rotate our coordinate axes. Used as a
symmetry group, SO(3) leads to conservation of angular momentum.

266
9. An Introduction to Lie Groups
Heavy Top.
Consider a rigid body moving with a ﬁxed point but un-
der the inﬂuence of gravity. This problem still has a conﬁguration space
SO(3), but the symmetry group is only the circle group S1, consisting of
rotations about the direction of gravity. One says that gravity has broken
the symmetry from SO(3) to S1. This time, “eliminating” the S1 symme-
try “mysteriously” leads one to the larger Euclidean group SE(3) of rigid
motion of R3. This is a manifestation of the general theory of semidirect
products (see the Introduction, where we showed that the heavy top equa-
tions are Lie–Poisson for SE(3), and Marsden, Ratiu, and Weinstein [1984a,
1984b]).
Incompressible Fluids.
Let Ωbe a region in R3 that is ﬁlled with
a moving incompressible
ﬂuid and is free of external forces. Denote by
η(X, t) the trajectory of a ﬂuid particle that at time t = 0 is at X ∈Ω.
For ﬁxed t the map ηt deﬁned by ηt(X) = η(X, t) is a diﬀeomorphism of
Ω. In fact, since the ﬂuid is incompressible, we have ηt ∈Diffvol(Ω), the
group of volume-preserving diﬀeomorphisms of Ω. Thus, the conﬁguration
space for the problem is the inﬁnite-dimensional Lie group Diffvol(Ω). Using
Diffvol(Ω) as a symmetry group leads to Kelvin’s circulation theorem as a
conservation law. See Marsden and Weinstein [1983].
Compressible Fluids.
In this case the conﬁguration space is the whole
diﬀeomorphism group Diff(Ω). The symmetry group consists of density-
preserving diﬀeomorphisms Diffρ(Ω). The density plays a role similar to
that of gravity in the heavy top and again leads to semidirect products, as
does the next example.
Magnetohydrodynamics (MHD).
This example is that of a com-
pressible ﬂuid consisting of charged particles with the dominant electro-
magnetic force being the magnetic ﬁeld produced by the particles them-
selves (possibly together with an external ﬁeld). The conﬁguration space
remains Diff(Ω), but the ﬂuid motion is coupled with the magnetic ﬁeld
(regarded as a two-form on Ω).
Maxwell–Vlasov Equations.
Let f(x, v, t) denote the density function
of a collisionless plasma. The function f evolves in time by means of a
time-dependent canonical transformation on R6, that is, (x, v)-space. In
other words, the evolution of f can be described by ft = η∗
t f0, where
f0 is the initial value of f, ft its value at time t, and ηt is a canonical
transformation. Thus, Diffcan(R6), the group of canonical transformations,
plays an important role.
Maxwell’s Equations
Maxwell’s equations for electrodynamics are in-
variant under gauge transformations that transform the magnetic (or 4)
potential by A →A + ∇ϕ. This gauge group is an inﬁnite-dimensional Lie
group. The conserved quantity associated with the gauge symmetry in this
case is the charge.

9.1 Basic Deﬁnitions and Properties
267
9.1
Basic Deﬁnitions and Properties
Deﬁnition 9.1.1.
A Lie group is a (Banach) manifold G that has a
group structure consistent with its manifold structure in the sense that
group multiplication
µ : G × G →G,
(g, h) →gh,
is a C∞map.
The maps Lg : G →G, h →gh, and Rh : G →G, g →gh, are called the
left and right translation maps. Note that
Lg1 ◦Lg2 = Lg1g2
and
Rh1 ◦Rh2 = Rh2h1.
If e ∈G denotes the identity element, then Le = Id = Re, and so
(Lg)−1 = Lg−1
and
(Rh)−1 = Rh−1.
Thus, Lg and Rh are diﬀeomorphisms for each g and h. Notice that
Lg ◦Rh = Rh ◦Lg,
that is, left and right translation commute. By the chain rule,
TghLg−1 ◦ThLg = Th(Lg−1 ◦Lg) = Id .
Thus, ThLg is invertible. Likewise, TgRh is an isomorphism.
We now show that the inversion map I : G →G; g →g−1 is C∞.
Indeed, consider solving
µ(g, h) = e
for h as a function of g. The partial derivative with respect to h is just ThLg,
which is an isomorphism. Thus, the solution g−1 is a smooth function of g
by the implicit function theorem.
Lie groups can be ﬁnite- or inﬁnite-dimensional. For a ﬁrst reading of
this section, the reader may wish to assume that G is ﬁnite-dimensional.1
Examples
(a)
Any Banach space V is an Abelian Lie group with group operations
µ : V × V →V,
µ(x, y) = x + y,
and
I : V →V,
I(x) = −x.
The identity is just the zero vector. We call such a Lie group a vector
group.
♦
1We caution that some interesting inﬁnite-dimensional groups (such as groups of
diﬀeomorphisms) are not Banach–Lie groups in the (naive) sense just given.

268
9. An Introduction to Lie Groups
(b)
The group of linear isomorphisms of Rn to Rn is a Lie group of
dimension n2, called the general linear group and denoted by GL(n, R).
It is a smooth manifold, since it is an open subset of the vector space
L(Rn, Rn) of all linear maps of Rn to Rn. Indeed, GL(n, R) is the inverse
image of R\{0} under the continuous map A →det A of L(Rn, Rn) to R.
For A, B ∈GL(n, R), the group operation is composition,
µ : GL(n, R) × GL(n, R) →GL(n, R)
given by
(A, B) →A ◦B,
and the inversion map is
I : GL(n, R) →GL(n, R)
deﬁned by
I(A) = A−1.
Group multiplication is the restriction of the continuous bilinear map
(A, B) ∈L(Rn, Rn) × L(Rn, Rn) →A ◦B ∈L(Rn, Rn).
Thus, µ is C∞, and so GL(n, R) is a Lie group.
The group identity element e is the identity map on Rn. If we choose a
basis in Rn, we can represent each A ∈GL(n, R) by an invertible n × n
matrix. The group operation is then matrix multiplication µ(A, B) = AB,
and I(A) = A−1 is matrix inversion. The identity element e is the n ×
n identity matrix. The group operations are obviously smooth, since the
formulas for the product and inverse of matrices are smooth (rational)
functions of the matrix components.
♦
(c)
In the same way, one sees that for a Banach space V , the group
GL(V, V ) of invertible elements of L(V, V ) is a Banach–Lie group. For the
proof that this is open in L(V, V ), see Abraham, Marsden, and Ratiu [1988].
Further examples are given in the next section.
♦
Charts.
Given any local chart on G, one can construct an entire atlas on
the Lie group G by use of left (or right) translations. Suppose, for example,
that (U, ϕ) is a chart about e ∈G, and that ϕ : U →V . Deﬁne a chart
(Ug, ϕg) about g ∈G by letting
Ug = Lg(U) = { Lgh | h ∈U }
and deﬁning
ϕg = ϕ ◦Lg−1 : Ug →V, h →ϕ(g−1h).
The set of charts {(Ug, ϕg)} forms an atlas, provided that one can show
that the transition maps
ϕg1 ◦ϕ−1
g2 = ϕ ◦Lg−1
1
g2 ◦ϕ−1 : ϕg2(Ug1 ∩Ug2) →ϕg1(Ug1 ∩Ug2)

9.1 Basic Deﬁnitions and Properties
269
are diﬀeomorphisms (between open sets in a Banach space). But this follows
from the smoothness of group multiplication and inversion.
Invariant Vector Fields.
A vector ﬁeld X on G is called left invariant
if for every g ∈G we have L∗
gX = X, that is, if
(ThLg)X(h) = X(gh)
for every h ∈G. We have the commutative diagram in Figure 9.1.1 and
illustrate the geometry in Figure 9.1.2.
TG
TG
G
G
TLg
Lg
X
X
✲
✲
✻
✻
Figure 9.1.1. The commutative diagram for a left-invariant vector ﬁeld.
h
gh
X(h)
X(gh)
ThLg
Figure 9.1.2. A left-invariant vector ﬁeld.
Let XL(G) denote the set of left-invariant vector ﬁelds on G. If g ∈G
and X, Y ∈XL(G), then
L∗
g[X, Y ] = [L∗
gX, L∗
gY ] = [X, Y ],
so [X, Y ] ∈XL(G). Therefore, XL(G) is a Lie subalgebra of X(G), the set
of all vector ﬁelds on G.
For each ξ ∈TeG, we deﬁne a vector ﬁeld Xξ on G by letting
Xξ(g) = TeLg(ξ).

270
9. An Introduction to Lie Groups
Then
Xξ(gh) = TeLgh(ξ) = Te(Lg ◦Lh)(ξ)
= ThLg(TeLh(ξ)) = ThLg(Xξ(h)),
which shows that Xξ is left invariant. The linear maps
ζ1 : XL(G) →TeG,
X →X(e)
and
ζ2 : TeG →XL(G),
ξ →Xξ
satisfy ζ1 ◦ζ2 = idTeG and ζ2 ◦ζ1 = idXL(G). Therefore, XL(G) and TeG
are isomorphic as vector spaces.
The Lie Algebra of a Lie Group.
Deﬁne the Lie bracket in TeG by
[ξ, η] := [Xξ, Xη](e),
where ξ, η ∈TeG and where [Xξ, Xη] is the Jacobi–Lie bracket of vector
ﬁelds. This clearly makes TeG into a Lie algebra. (Lie algebras were deﬁned
in the Introduction.) We say that this deﬁnes a bracket in TeG via left
extension. Note that by construction,
[Xξ, Xη] = X[ξ,η]
for all ξ, η ∈TeG.
Deﬁnition 9.1.2.
The vector space TeG with this Lie algebra structure
is called the Lie algebra of G and is denoted by g.
Deﬁning the set XR(G) of right-invariant vector ﬁelds on G in the
analogous way, we get a vector space isomorphism ξ →Yξ, where Yξ(g) =
(TeRg)(ξ), between TeG = g and XR(G). In this way, each ξ ∈g deﬁnes an
element Yξ ∈XR(G), and also an element Xξ ∈XL(G). We will prove that
a relation between Xξ and Yξ is given by
I∗Xξ = −Yξ,
(9.1.1)
where I : G →G is the inversion map: I(g) = g−1. Since I is a dif-
feomorphism, (9.1.1) shows that I∗: XL(G) →XR(G) is a vector space
isomorphism. To prove (9.1.1) notice ﬁrst that for u ∈TgG and v ∈ThG,
the derivative of the multiplication map has the expression
T(g,h)µ(u, v) = ThLg(v) + TgRh(u).
(9.1.2)
In addition, diﬀerentiating the map g →µ(g, I(g)) = e gives
T(g,g−1)µ(u, TgI(u)) = 0

9.1 Basic Deﬁnitions and Properties
271
for all u ∈TgG. This and (9.1.2) yield
TgI(u) = −(TeRg−1 ◦TgLg−1)(u),
(9.1.3)
for all u ∈TgG. Consequently, if ξ ∈g, and g ∈G, we have
(I∗Xξ)(g) = (TI ◦Xξ ◦I−1)(g) = Tg−1I(Xξ(g−1))
= −(TeRg ◦Tg−1Lg)(Xξ(g−1))
(by (9.1.3))
= −TeRg(ξ) = −Yξ(g)
(since Xξ(g−1) = TeLg−1(ξ))
and (9.1.1) is proved. Hence for ξ, η ∈g,
−Y[ξ,η] = I∗X[ξ,η] = I∗[Xξ, Xη] = [I∗Xξ, I∗Xη]
= [−Yξ, −Yη] = [Yξ, Yη],
so that
−[Yξ, Yη](e) = Y[ξ,η](e) = [ξ, η] = [Xξ, Xη](e).
Therefore, the Lie algebra bracket [ , ]R in g deﬁned by right extension
of elements in g,
[ξ, η]R := [Yξ, Yη](e),
is the negative of the one deﬁned by left extension, that is,
[ξ, η]R := −[ξ, η].
Examples
(a)
For a vector group V , TeV ∼= V ; it is easy to see that the left-invariant
vector ﬁeld deﬁned by u ∈TeV is the constant vector ﬁeld Xu(v) = u for
all v ∈V . Therefore, the Lie algebra of a vector group V is V itself, with
the trivial bracket [v, w] = 0 for all v, w ∈V . We say that the Lie algebra
is Abelian in this case.
♦
(b)
The Lie algebra of GL(n, R) is L(Rn, Rn), also denoted by gl(n),
the vector space of all linear transformations of Rn, with the commutator
bracket
[A, B] = AB −BA.
To see this, we recall that GL(n, R) is open in L(Rn, Rn), and so the Lie
algebra, as a vector space, is L(Rn, Rn). To compute the bracket, note that
for any ξ ∈L(Rn, Rn),
Xξ : GL(n, R) →L(Rn, Rn)
given by A →Aξ is a left-invariant vector ﬁeld on GL(n, R) because for
every B ∈GL(n, R), the map
LB : GL(n, R) →GL(n, R)

272
9. An Introduction to Lie Groups
deﬁned by LB(A) = BA is a linear mapping, and hence
Xξ(LBA) = BAξ = TALBXξ(A).
Therefore, by the local formula
[X, Y ](x) = DY (x) · X(x) −DX(x) · Y (x),
we get
[ξ, η] = [Xξ, Xη](I) = DXη(I) · Xξ(I) −DXξ(I) · Xη(I).
But Xη(A) = Aη is linear in A, so DXη(I) · B = Bη. Hence
DXη(I) · Xξ(I) = ξη,
and similarly
DXξ(I) · Xη(I) = ηξ.
Thus, L(Rn, Rn) has the bracket
[ξ, η] = ξη −ηξ.
(9.1.4)
♦
(c)
We can also establish (9.1.4) by a coordinate calculation. Choosing a
basis in Rn, each A ∈GL(n, R) is speciﬁed by its components Ai
j such that
(Av)i = Ai
jvj (sum on j). Thus, a vector ﬁeld X on GL(n, R) has the form
X(A) = 
i,j Ci
j(A)(∂/∂Ai
j). It is checked to be left invariant, provided
that there is a matrix (ξi
j) such that for all A,
X(A) =

i,j,k
Ai
kξk
j
∂
∂Ai
j
.
If Y (A) = 
i,j,k Ai
kηk
j (∂/∂Ai
j) is another left-invariant vector ﬁeld, we
have
(XY )[f] =

Ai
kξk
j
∂
∂Ai
j

Al
mηm
p
∂f
∂Alp

=

Ai
kξk
j δl
iδj
mηm
p
∂f
∂Alp
+ (second derivatives)
=

Ai
kξk
j ηj
m
∂f
∂Ai
j
+ (second derivatives),
where we have used ∂As
m/∂Ak
j = δk
s δj
m. Therefore, the bracket is the left-
invariant vector ﬁeld [X, Y ] given by
[X, Y ][f] = (XY −Y X)[f] =

Ai
k(ξk
j ηj
m −ηk
j ξj
m) ∂f
∂Aim
.
This shows that the vector ﬁeld bracket is the usual commutator bracket
of n × n matrices, as before.
♦

9.1 Basic Deﬁnitions and Properties
273
One-Parameter Subgroups and the Exponential Map.
If Xξ is the
left-invariant vector ﬁeld corresponding to ξ ∈g, there is a unique integral
curve γξ : R →G of Xξ starting at e, γξ(0) = e and γ′
ξ(t) = Xξ(γξ(t)). We
claim that
γξ(s + t) = γξ(s)γξ(t),
which means that γξ(t) is a smooth one-parameter subgroup. Indeed,
as functions of t, both sides equal γξ(s) at t = 0 and both satisfy the
diﬀerential equation σ′(t) = Xξ(σ(t)) by left invariance of Xξ, so they are
equal. Left invariance or γξ(t + s) = γξ(t)γξ(s) also shows that γξ(t) is
deﬁned for all t ∈R.
Deﬁnition 9.1.3.
The exponential map exp : g →G is deﬁned by
exp(ξ) = γξ(1).
We claim that
exp(sξ) = γξ(s).
Indeed, for ﬁxed s ∈R, the curve t →γξ(ts), which at t = 0 passes through
e, satisﬁes the diﬀerential equation
d
dtγξ(ts) = sXξ(γξ(ts)) = Xsξ(γξ(ts)).
Since γsξ(t) satisﬁes the same diﬀerential equation and passes through e at
t = 0, it follows that γsξ(t) = γξ(ts). Putting t = 1 yields exp(sξ) = γξ(s).
Hence the exponential mapping maps the line sξ in g onto the one-
parameter subgroup γξ(s) of G, which is tangent to ξ at e. It follows from
left invariance that the ﬂow F ξ
t of Xξ satisﬁes F ξ
t (g) = gF ξ
t (e) = gγξ(t), so
F ξ
t (g) = g exp(tξ) = Rexp tξg.
Let γ(t) be a smooth one-parameter subgroup of G, so γ(0) = e in partic-
ular. We claim that γ = γξ, where ξ = γ′(0). Indeed, taking the derivative
at s = 0 in the relation γ(t + s) = γ(t)γ(s) gives
dγ(t)
dt
= d
ds

s=0
Lγ(t)γ(s) = TeLγ(t)γ′(0) = Xξ(γ(t)),
so that γ = γξ, since both equal e at t = 0. In other words, all smooth
one-parameter subgroups of G are of the form exp tξ for some ξ ∈g. Since
everything proved above for Xξ can be repeated for Yξ, it follows that the
exponential map is the same for the left and right Lie algebras of a Lie
group.
From smoothness of the group operations and smoothness of the solu-
tions of diﬀerential equations with respect to initial conditions, it follows

274
9. An Introduction to Lie Groups
that exp is a C∞map. Diﬀerentiating the identity exp(sξ) = γξ(s) with
respect to s at s = 0 shows that T0 exp = idg. Therefore, by the inverse
function theorem, exp is a local diﬀeomorphism from a neighborhood of
zero in g onto a neighborhood of e in G. In other words, the exponential
map deﬁnes a local chart for G at e; in ﬁnite dimensions, the coordinates
associated to this chart are called the canonical coordinates of G. By
left translation, this chart provides an atlas for G. (For typical inﬁnite-
dimensional groups like diﬀeomorphism groups, exp is not locally onto a
neighborhood of the identity. It is also not true that the exponential map
is a local diﬀeomorphism at any ξ ̸= 0, even for ﬁnite-dimensional Lie
groups.)
It turns out that the exponential map characterizes not only the smooth
one-parameter subgroups of G, but the continuous ones as well, as given
in the next proposition (see Varadarajan [1974] for the proof).
Proposition 9.1.4.
Let γ : R →G be a continuous one-parameter sub-
group of G. Then γ is automatically smooth, and hence γ(t) = exp tξ, for
some ξ ∈g.
Examples
(a)
Let G = V be a vector group, that is, V is a vector space and the
group operation is vector addition. Then g = V and exp : V →V is the
identity mapping.
♦
(b)
Let G = GL(n, R); so g = L(Rn, Rn). For every A ∈L(Rn, Rn), the
mapping γA : R →GL(n, R) deﬁned by
t →
∞

i=0
ti
i! Ai
is a one-parameter subgroup, because γA(0) = I and
γ′
A(t) =
∞

i=0
ti−1
(i −1)!Ai = γA(t)A.
Therefore, the exponential mapping is given by
exp : L(Rn, Rn) →GL(n, Rn),
A →γA(1) =
∞

i=0
Ai
i! .
As is customary, we will write
eA =
∞

i=0
Ai
i! .
We sometimes write expG : g →G when there is more than one group
involved.
♦

9.1 Basic Deﬁnitions and Properties
275
(c)
Let G1 and G2 be Lie groups with Lie algebras g1 and g2. Then
G1 × G2 is a Lie group with Lie algebra g1 × g2, and the exponential map
is given by
exp : g1 × g2 →G1 × G2,
(ξ1, ξ2) →(exp1(ξ1), exp2(ξ2)).
♦
Computing Brackets.
Here is a computationally useful formula for the
bracket. One follows these three steps:
1. Calculate the inner automorphisms
Ig : G →G, where Ig(h) = ghg−1.
2. Diﬀerentiate Ig(h) with respect to h at h = e to produce the adjoint
operators
Adg : g →g;
Adg η = TeIg · η.
Note that (see Figure 9.1.3)
Adg η = Tg−1Lg · TeRg−1 · η.
3. Diﬀerentiate Adg η with respect to g at e in the direction ξ to get
[ξ, η], that is,
Teϕη · ξ = [ξ, η],
(9.1.5)
where ϕη(g) = Adg η.
Adg
TeLg
e
g
TgRg
–1
Figure 9.1.3. The adjoint mapping is the linearization of conjugation.
Proposition 9.1.5.
Formula (9.1.5) is valid.

276
9. An Introduction to Lie Groups
Proof.
Denote by ϕt(g) = g exp tξ = Rexp tξ g the ﬂow of Xξ. Then
[ξ, η] = [Xξ, Xη](e) = d
dtTϕt(e)ϕ−1
t
· Xη(ϕt(e))

t=0
= d
dtTexp tξ Rexp(−tξ) Xη(exp tξ)

t=0
= d
dtTexp tξ Rexp(−tξ) TeLexp tξ η

t=0
= d
dtTe(Lexp tξ ◦Rexp(−tξ))η

t=0
= d
dt Adexp tξ η

t=0
,
which is (9.1.5).
■
Another way of expressing (9.1.5) is
[ξ, η] = d
dt
d
dsg(t)h(s)g(t)−1

s=0,t=0
,
(9.1.6)
where g(t) and h(s) are curves in G with g(0) = e, h(0) = e, and where
g′(0) = ξ and h′(0) = η.
Example.
Consider the group GL(n, R). Formula (9.1.4) also follows
from (9.1.5). Here, IAB = ABA−1, and so
AdA η = AηA−1.
Diﬀerentiating this with respect to A at A = Identity in the direction ξ
gives
[ξ, η] = ξη −ηξ.
♦
Group Homomorphisms.
Some simple facts about Lie group homo-
morphisms will prove useful.
Proposition 9.1.6.
Let G and H be Lie groups with Lie algebras g and
h. Let f : G →H be a smooth homomorphism of Lie groups, that is,
f(gh) = f(g)f(h), for all g, h ∈G. Then Tef : g →h is a Lie algebra
homomorphism, that is, (Tef)[ξ, η] = [Tef(ξ), Tef(η)], for all ξ, η ∈g. In
addition,
f ◦expG = expH ◦Tef.

9.1 Basic Deﬁnitions and Properties
277
Proof.
Since f is a group homomorphism, f ◦Lg = Lf(g) ◦f. Thus,
Tf ◦TLg = TLf(g) ◦Tf, from which it follows that
XTef(ξ)(f(g)) = Tgf(Xξ(g)),
that is, Xξ and XTef(ξ) are f-related. It follows that the vector ﬁelds
[Xξ, Xη] and [XTef(ξ), XTef(η)] are also f-related for all ξ, η ∈g (see Abra-
ham, Marsden, and Ratiu [1988, Section 4.2]). Hence
Tef([ξ, η]) = (Tf ◦[Xξ, Xη])(e)
(where e = eG)
= [XTef(ξ), XTef(η)](¯e)
(where ¯e = eH = f(e))
= [Tef(ξ), Tef(η)].
Thus, Tef is a Lie algebra homomorphism.
Fixing ξ ∈g, note that α : t →f(expG(tξ)) and β : t →expH(tTef(ξ))
are one-parameter subgroups of H. Moreover, α′(0) = Tef(ξ) = β′(0), and
so α = β. In particular, f(expG(ξ)) = expH(Tef(ξ)), for all ξ ∈g.
■
Example.
Proposition 9.1.6 applied to the determinant map gives the
identity
det(exp A) = exp(trace A)
for A ∈GL(n, R).
♦
Corollary 9.1.7.
Assume that f1, f2 : G →H are homomorphisms of
Lie groups and that G is connected. If Tef1 = Tef2, then f1 = f2.
This follows from Proposition 9.1.6, since a connected Lie group G is
generated by a neighborhood of the identity element. This latter fact may
be proved following these steps:
1. Show that any open subgroup of a Lie group is closed (since its com-
plement is a union of sets homeomorphic to it).
2. Show that a subgroup of a Lie group is open if and only if it contains
a neighborhood of the identity element.
3. Conclude that a Lie group is connected if and only if it is generated
by arbitrarily small neighborhoods of the identity element.
From Proposition 9.1.6 and the fact that the inner automorphisms are
group homomorphisms, we get the following corollary.
Corollary 9.1.8.
(i) exp(Adg ξ) = g(exp ξ)g−1, for every ξ ∈g and g ∈G; and
(ii) Adg[ξ, η] = [Adg ξ, Adg η].

278
9. An Introduction to Lie Groups
More Automatic Smoothness Results.
There are some interesting
results related in spirit to Proposition 9.1.4 and the preceding discussions.
A striking example of this is the following:
Theorem 9.1.9.
Any continuous homomorphism of ﬁnite-dimensional
Lie groups is smooth.
There is a remarkable consequence of this theorem. If G is a topological
group (that is, the multiplication and inversion maps are continuous), one
could, in principle, have more than one diﬀerentiable manifold structure
making G into two nonisomorphic Lie groups (i.e., the manifold structures
are not diﬀeomorphic) but both inducing the same topological structure.
This phenomenon of “exotic structures” occurs for general manifolds. How-
ever, in view of the theorem above, this cannot happen in the case of Lie
groups. Indeed, since the identity map is a homeomorphism, it must be
a diﬀeomorphism. Thus, a topological group that is locally Euclidean (i.e.,
there is an open neighborhood of the identity homeomorphic to an open ball
in Rn) admits at most one smooth manifold structure relative to which it
is a Lie group.
The existence part of this statement is Hilbert’s famous ﬁfth problem:
Show that a locally Euclidean topological group admits a smooth (actually
analytic) structure making it into a Lie group. The solution of this problem
was achieved by Gleason and, independently, by Montgomery and Zippin
in 1952; see Kaplansky [1971] for an excellent account of this proof.
Abelian Lie Groups.
Since any two elements of an Abelian Lie group
G commute, it follows that all adjoint operators Adg, g ∈G, equal the
identity. Therefore, by equation (9.1.5), the Lie algebra g is Abelian; that
is, [ξ, η] = 0 for all ξ, η ∈g.
Examples
(a)
Any ﬁnite-dimensional vector space, thought of as an Abelian group
under addition, is an Abelian Lie group. The same is true in inﬁnite di-
mensions for any Banach space. The exponential map is the identity.
♦
(b)
The unit circle in the complex plane S1 = { z ∈C | |z| = 1 } is
an Abelian Lie group under multiplication. The tangent space TeS1 is the
imaginary axis, and we identify R with TeS1 by t →2πit. With this iden-
tiﬁcation, the exponential map exp : R →S1 is given by exp(t) = e2πit.
Note that exp−1(1) = Z.
♦
(c)
The n-dimensional torus Tn = S1 × · · · × S1 (n times) is an Abelian
Lie group. The exponential map exp : Rn →Tn is given by
exp(t1, . . . , tn) = (e2πit1, . . . , e2πitn).

9.1 Basic Deﬁnitions and Properties
279
Since S1 = R/Z , it follows that
Tn = R/Zn,
the projection Rn →Tn being given by exp above.
♦
If G is a connected Lie group whose Lie algebra g is Abelian, the Lie
group homomorphism g ∈G →Adg ∈GL(g) has induced Lie algebra
homomorphism ξ ∈g →adξ ∈gl(g) the constant map equal to zero.
Therefore, by Corollary 9.1.7, Adg = identity on G, for any g ∈G. Apply
Corollary 9.1.7 again, this time to the conjugation by g on G (whose induced
Lie algebra homomorphism is Adg), to conclude that it equals the identity
map on G. Thus, g commutes with all elements of G; since g was arbitrary,
we conclude that G is Abelian. We summarize these observations in the
following proposition.
Proposition 9.1.10.
If G is an Abelian Lie group, its Lie algebra g is
also Abelian. Conversely, if G is connected and g is Abelian, then G is
Abelian.
The main structure theorem for Abelian Lie groups is the following,
whose proof can be found in Varadarajan [1974] or Knapp [1996].
Theorem 9.1.11.
Every connected Abelian n-dimensional Lie group G
is isomorphic to a cylinder, that is, to Tk × Rn−k for some k = 1, . . . , n.
Lie Subgroups.
It is natural to synthesize the subgroup and submani-
fold concepts.
Deﬁnition 9.1.12.
A Lie subgroup H of a Lie group G is a subgroup
of G that is also an injectively immersed submanifold of G. If H is a sub-
manifold of G, then H is called a regular Lie subgroup.
For example, the one-parameter subgroups of the torus T2 that wind
densely on the torus are Lie subgroups that are not regular.
The Lie algebras g and h of G and a Lie subgroup H, respectively, are
related in the following way:
Proposition 9.1.13.
Let H be a Lie subgroup of G. Then h is a Lie
subalgebra of g. Moreover,
h = { ξ ∈g | exp tξ ∈H for all t ∈R }.
Proof.
The ﬁrst statement is a consequence of Proposition 9.1.6, which
also shows that exp tξ ∈H, for all ξ ∈h and t ∈R. Conversely, if exp tξ ∈
H, for all t ∈R, we have,
d
dt exp tξ

t=0
∈h,
since H is a Lie subgroup; but this equals ξ by deﬁnition of the exponential
map.
■

280
9. An Introduction to Lie Groups
The following is a powerful theorem often used to ﬁnd Lie subgroups.
Theorem 9.1.14.
If H is a closed subgroup of a Lie group G, then H
is a regular Lie subgroup. Conversely, if H is a regular Lie subgroup of G,
then H is closed.
The proof of this theorem may be found in Abraham and Marsden [1978],
Adams [1969], Varadarajan [1974], or Knapp [1996].
We remind the reader that the Lie algebras appropriate to ﬂuid dynamics
and plasma physics are inﬁnite-dimensional. Nevertheless, there is still,
with the appropriate technical conditions, a correspondence between Lie
groups and Lie algebras analogous to the preceding theorems. The reader
should be warned, however, that these theorems do not naively generalize
to the inﬁnite-dimensional situation, and to prove them for special cases,
specialized analytical theorems may be required.
The next result is sometimes called “Lie’s third fundamental theorem.”
Theorem 9.1.15.
Let G be a Lie group with Lie algebra g, and let h be
a Lie subalgebra of g. Then there exists a unique connected Lie subgroup H
of G whose Lie algebra is h.
The proof may be found in Knapp [1996] or Varadarajan [1974].
Quotients.
If H is a closed subgroup of G, we denote by G/H, the set
of left cosets, that is, the collection { gH | g ∈G }. Let π : G →G/H be
the projection g →gH.
Theorem 9.1.16.
There is a unique manifold structure on G/H such
that the projection π : G →G/H is a smooth surjective submersion. (Recall
from Chapter 4 that a smooth map is called a submersion when its derivative
is surjective.)
Again the proof may be found in Abraham and Marsden [1978], Knapp
[1996], or Varadarajan [1974].
The Maurer–Cartan Equations.
We close this section with a proof
of the Maurer–Cartan structure equations on a Lie group G. Deﬁne
λ, ρ ∈Ω1(G; g), the space of g-valued one-forms on G, by
λ(ug) = TgLg−1(ug),
ρ(ug) = TgRg−1(ug).
Thus, λ and ρ are Lie-algebra-valued one-forms on G that are deﬁned by
left and right translation to the identity, respectively. Deﬁne the two-form
[λ, λ] by
[λ, λ](u, v) = [λ(u), λ(v)],
and similarly for [ρ, ρ].

9.1 Basic Deﬁnitions and Properties
281
Theorem 9.1.17 (Maurer–Cartan Structure Equations).
dλ + [λ, λ] = 0,
dρ −[ρ, ρ] = 0.
Proof.
We use identity 6 from the table in §4.4. Let X, Y ∈X(G) and
let ξ = TgLg−1(X(g)) and η = TgLg−1(Y (g)) for ﬁxed g ∈G. Thus,
(dλ)(Xξ, Xη) = Xξ[λ(Xη)] −Xη[λ(Xξ)] −λ([Xξ, Xη]).
Since λ(Xη)(h) = ThLh−1(Xη(h)) = η is constant, the ﬁrst term vanishes.
Similarly, the second term vanishes. The third term equals
λ([Xξ, Xη]) = λ(X[ξ,η]) = [ξ, η],
and hence
(dλ)(Xξ, Xη) = −[ξ, η].
Therefore,
(dλ + [λ, λ]) (Xξ, Xη) = −[ξ, η] + [λ, λ](Xξ, Xη)
= −[ξ, η] + [λ(Xξ), λ(Xη)]
= −[ξ, η] + [ξ, η] = 0.
This proves that
(dλ + [λ, λ]) (X, Y )(g) = 0.
Since g ∈G was arbitrary as well as X and Y , it follows that dλ+[λ, λ] = 0.
The second relation is proved in the same way but working with the
right-invariant vector ﬁelds Yξ, Yη. The sign in front of the second term
changes, since [Yξ, Yη] = Y−[ξ,η].
■
Remark.
If α is a (0, k)-tensor with values in a Banach space E1, and β
is a (0, l)-tensor with values in a Banach space E2, and if B : E1 × E2 →
E3 is a bilinear map, then replacing multiplication in (4.2.1) by B, the
same formula deﬁnes an E3-valued (0, k + l)-tensor on M. Therefore, using
Deﬁnitions 4.2.2–4.2.4, if
α ∈Ωk(M, E1)
and
β ∈Ωl(M, E2),
then
(k + l)!
k!l!

A(α ⊗β) ∈Ωk+l(M, E3).
We shall call this expression the wedge product associated to B and
denote it either by α ∧B β or B∧(α, β).

282
9. An Introduction to Lie Groups
In particular, if E1 = E2 = E3 = g and B = [ , ] is the Lie algebra
bracket, then for α, β ∈Ω1(M; g), we have
[α, β]∧(u, v) = [α(u), β(v)] −[α(v), β(u)] = −[β, α]∧(u, v)
for any vectors u, v tangent to M. Thus, alternatively, one can write the
structure equations as
dλ + 1
2[λ, λ]∧= 0,
dρ −1
2[ρ, ρ]∧= 0.
♦
Haar measure.
One can characterize Lebesgue measure up to a multi-
plicative constant on Rn by its invariance under translations. Similarly, on
a locally compact group there is a unique (up to a nonzero multiplicative
constant) left-invariant measure, called Haar measure. For Lie groups
the existence of such measures is especially simple.
Proposition 9.1.18.
Let G be a Lie group. Then there is a volume form
µ, unique up to nonzero multiplicative constants, that is left invariant. If
G is compact, µ is right invariant as well.
Proof.
Pick any n-form µe on TeG that is nonzero and deﬁne an n-form
on TgG by
µg(v1, . . . , vn) = µe · (TLg−1v1, . . . , TLg−1 · vn).
Then µg is left invariant and smooth. For n = dim G, µe is unique up to a
scalar factor, so µg is as well.
Fix g0 ∈G and consider R∗
g0µ = cµ for a constant c. If G is compact,
this relationship may be integrated, and by the change of variables formula
we deduce that c = 1. Hence, µ is also right invariant.
■
Exercises
⋄9.1-1.
Verify Adg[ξ, η] = [Adg ξ, Adg η] directly for GL(n).
⋄9.1-2.
Let G be a Lie group with group operations µ : G × G →G and
I : G →G. Show that the tangent bundle TG is also a Lie group, called
the tangent group of G with group operations Tµ : TG×TG →TG, TI :
TG →TG.
⋄9.1-3 (Deﬁning a Lie group by a chart at the identity).
Let G be a group
and suppose that ϕ : U →V is a one-to-one map from a subset U of G
containing the identity element to an open subset V in a Banach space (or
Banach manifold). The following conditions are necessary and suﬃcient for
ϕ to be a chart in a Hausdorﬀ–Banach–Lie group structure on G:

9.2 Some Classical Lie Groups
283
(a) The set W = { (x, y) ∈V × V | ϕ−1(y) ∈U } is open in V × V , and
the map (x, y) ∈W →ϕ(ϕ−1(x)ϕ−1(y)) ∈V is smooth.
(b) For every g ∈G, the set Vg = ϕ(gUg−1 ∩U) is open in V and the
map x ∈Vg →ϕ(gϕ−1(x)g−1) ∈V is smooth.
⋄9.1-4 (The Heisenberg group).
Let (Z, Ω) be a symplectic vector space
and deﬁne on H := Z × S1 the following operation:
(u, exp iφ)(v, exp iψ) =

u + v, exp i[φ + ψ + ℏ−1Ω(u, v)]

.
(a) Verify that this operation gives H the structure of a noncommutative
Lie group.
(b) Show that the Lie algebra of H is given by h = Z×R with the bracket
operation2
[(u, φ), (v, ψ)] = (0, 2ℏ−1Ω(u, v)).
(c) Show that [h, [h, h]] = 0, that is, h is nilpotent, and that R lies in the
center of the algebra (i.e., [h, R] = 0); one says that h is a central
extension of Z.
9.2
Some Classical Lie Groups
The Real General Linear Group GL(n, R).
In the previous section we
showed that GL(n, R) is a Lie group, that it is an open subset of the vector
space of all linear maps of Rn into itself, and that its Lie algebra is gl(n, R)
with the commutator bracket. Since it is open in L(Rn, Rn) = gl(n, R), the
group GL(n, R) is not compact. The determinant function det : GL(n, R) →
R is smooth and maps GL(n, R) onto the two components of R\{0}. Thus,
GL(n, R) is not connected.
Deﬁne
GL+(n, R) = { A ∈GL(n, R) | det(A) > 0 }
and note that it is an open (and hence closed) subgroup of GL(n, R). If
GL−(n, R) = { A ∈GL(n, R) | det(A) < 0 },
the map A ∈GL+(n, R) →I0A ∈GL−(n, R), where I0 is the diagonal
matrix all of whose entries are 1 except the (1, 1)-entry, which is −1, is a
diﬀeomorphism. We will show below that GL+(n, R) is connected, which
2This formula for the bracket, when applied to the space Z = R2n of the usual p’s
and q’s , shows that this algebra is the same as that encountered in elementary quan-
tum mechanics via the Heisenberg commutation relations. Hence the name “Heisenberg
group.”

284
9. An Introduction to Lie Groups
will prove that GL+(n, R) is the connected component of the identity in
GL(n, R) and that GL(n, R) has exactly two connected components.
To prove this we need a theorem from linear algebra called the polar de-
composition theorem. To formulate it, recall that a matrix R ∈GL(n, R) is
orthogonal if RRT = RT R = I. A matrix S ∈gl(n, R) is called symmet-
ric if ST = S. A symmetric matrix S is called positive deﬁnite, denoted
by S > 0, if
⟨Sv, v⟩> 0
for all v ∈Rn, v ̸= 0. Note that S > 0 implies that S is invertible.
Proposition 9.2.1 (Real Polar Decomposition Theorem).
For any A ∈
GL(n, R) there exists a unique orthogonal matrix R and positive deﬁnite
matrices S1, S2, such that
A = RS1 = S2R.
(9.2.1)
Proof.
Recall ﬁrst that any positive deﬁnite symmetric matrix has a
unique square root: If λ1, . . . , λn > 0 are the eigenvalues of AT A, diagonal-
ize AT A by writing
AT A = B diag(λ1, . . . , λn)B−1,
and then deﬁne
√
AT A = B diag(
	
λ1, . . . ,
	
λn)B−1.
Let S1 =
√
AT A, which is positive deﬁnite and symmetric. Deﬁne R =
AS−1
1
and note that
RT R = S−1
1 AT AS−1
1
= I,
since S2
1 = AT A by deﬁnition. Since both A and S1 are invertible, it follows
that R is invertible and hence RT = R−1, so R is an orthogonal matrix.
Let us prove uniqueness of the decomposition. If A = RS1 = ˜R ˜S1, then
AT A = S1RT ˜R ˜S1 = ˜S2
1.
However, the square root of a positive deﬁnite matrix is unique, so S1 = ˜S1,
whence also ˜R = R.
Now deﬁne S2 =
√
AAT , and as before, we conclude that A = S2R′
for some orthogonal matrix R′. We prove now that R′ = R. Indeed, A =
S2R′ = (R′(R′)T )S2R′ = R′((R′)T S2R′) and (R′)T S2R′ > 0. By unique-
ness of the prior polar decomposition, we conclude that R′ = R and
(R′)T S2R′ = S1.
■

9.2 Some Classical Lie Groups
285
Now we will use the real polar decomposition theorem to prove that
GL+(n, R) is connected. Let A ∈GL+(n, R) and decompose it as A = SR,
with S positive deﬁnite and R an orthogonal matrix whose determinant is
1. We will prove later that the collection of all orthogonal matrices having
determinant equal to 1 is a connected Lie group. Thus there is a continuous
path R(t) of orthogonal matrices having determinant 1 such that R(0) = I
and R(1) = R. Next, deﬁne the continuous path of symmetric matrices
S(t) = I + t(S −I) and note that S(0) = I and S(1) = S. Moreover,
⟨S(t)v, v⟩= ⟨[I + t(S −I)]v, v⟩
= ∥v∥2 + t⟨Sv, v⟩−t∥v∥2
= (1 −t)∥v∥2 + t⟨Sv, v⟩> 0,
for all t ∈[0, 1], since ⟨Sv, v⟩> 0 by hypothesis. Thus S(t) is a continuous
path of positive deﬁnite matrices connecting I to S. We conclude that
A(t) := S(t)R(t) is a continuous path of matrices whose determinant is
strictly positive connecting A(0) = S(0)R(0) = I to A(1) = S(1)R(1) =
SR = A. Thus, we have proved the following:
Proposition 9.2.2.
The group GL(n, R) is a noncompact disconnected
n2-dimensional Lie group whose Lie algebra gl(n, R) consists of all n × n
matrices with the bracket
[A, B] = AB −BA.
The connected component of the identity is GL+(n, R), and GL(n, R) has
two components.
The Real Special Linear Group SL(n, R).
Let det : L(Rn, Rn) →R
be the determinant map and recall that
GL(n, R) = { A ∈L(Rn, Rn) | det A ̸= 0 },
so GL(n, R) is open in L(Rn, Rn). Notice that R\{0} is a group under
multiplication and that
det : GL(n, R) →R\{0}
is a Lie group homomorphism because
det(AB) = (det A)(det B).
Lemma 9.2.3.
The map det : GL(n, R) →R\{0} is C∞, and its deriva-
tive is given by D detA ·B = (det A) trace(A−1B).
Proof.
The smoothness of det is clear from its formula in terms of matrix
elements. Using the identity
det(A + λB) = (det A) det(I + λA−1B),

286
9. An Introduction to Lie Groups
it suﬃces to prove
d
dλ det(I + λC)

λ=0
= trace C.
This follows from the identity for the characteristic polynomial
det(I + λC) = 1 + λ trace C + · · · + λn det C.
■
Deﬁne the real special linear group SL(n, R) by
SL(n, R) = { A ∈GL(n, R) | det A = 1 } = det−1(1).
(9.2.2)
From Proposition 9.1.14 it follows that SL(n, R) is a closed Lie subgroup
of GL(n, R). However, this method invokes a rather subtle result to prove
something that is in reality straightforward. To see this, note that it follows
from Lemma 9.2.3 that det : GL(n, R) →R is a submersion, so SL(n, R) =
det−1(1) is a smooth closed submanifold and hence a closed Lie subgroup.
The tangent space to SL(n, R) at A ∈SL(n, R) therefore consists of all
matrices B such that trace(A−1B) = 0. In particular, the tangent space at
the identity consists of the matrices with trace zero. We have seen that the
Lie algebra of GL(n, R) is L(Rn, Rn) = gl(n, R) with the Lie bracket given
by [A, B] = AB −BA. It follows that the Lie algebra sl(n, R) of SL(n, R)
consists of the set of n × n matrices having trace zero, with the bracket
[A, B] = AB −BA.
Since trace(B) = 0 imposes one condition on B, it follows that
dim[sl(n, R)] = n2 −1.
In dealing with classical Lie groups it is useful to introduce the following
inner product on gl(n, R):
⟨A, B⟩= trace(ABT ).
(9.2.3)
Note that
∥A∥2 =
n

i,j=1
a2
ij,
(9.2.4)
which shows that this norm on gl(n, R) coincides with the Euclidean norm
on Rn2.

9.2 Some Classical Lie Groups
287
We shall use this norm to show that SL(n, R) is not compact. Indeed, all
matrices of the form





1
0
. . .
t
0
1
. . .
0
...
...
...
...
0
0
. . .
1





are elements of SL(n, R) whose norm equals
√
n + t2 for any t ∈R. Thus,
SL(n, R) is not a bounded subset of gl(n, R) and hence is not compact.
Finally, let us prove that SL(n, R) is connected. As before, we shall use
the real polar decomposition theorem and the fact, to be proved later,
that the set of all orthogonal matrices having determinant equal to 1 is a
connected Lie group. If A ∈SL(n, R), decompose it as A = SR, where R
is an orthogonal matrix having determinant 1 and S is a positive deﬁnite
matrix having determinant 1. Since S is symmetric, it can be diagonalized,
that is, S = B diag(λ1, . . . , λn)B−1 for some orthogonal matrix B and
λ1, . . . , λn > 0. Deﬁne the continuous path
S(t) = B diag

(1 −t) + tλ1, . . . , (1 −t) + tλn−1, 1/
n−1

i=1
((1 −t) + tλi)

B−1
for t ∈[0, 1] and note that by construction, det S(t) = 1; S(t) is symmetric;
S(t) is positive deﬁnite, since each entry (1 −t) + tλi > 0 for t ∈[0, 1];
and S(0) = I, S(1) = S. Now let R(t) be a continuous path of orthogonal
matrices of determinant 1 such that R(0) = I and R(1) = R. Therefore,
A(t) = S(t)R(t) is a continuous path in SL(n, R) satisfying A(0) = I and
A(1) = SR = A, thereby showing that SL(n, R) is connected.
Proposition 9.2.4.
The Lie group SL(n, R) is a noncompact connected
(n2 −1)-dimensional Lie group whose Lie algebra sl(n, R) consists of the
n×n matrices with trace zero (or linear maps of Rn to Rn with trace zero)
with the bracket
[A, B] = AB −BA.
The Orthogonal Group O(n).
On Rn we use the standard inner prod-
uct
⟨x, y⟩=
n

i=1
xiyi,
where x = (x1, . . . , xn) ∈Rn and y = (y1, . . . , yn) ∈Rn. Recall that a
linear map A ∈L(Rn, Rn) is orthogonal if
⟨Ax, Ay⟩= ⟨x, y⟩
(9.2.5)
for all x, y ∈R. In terms of the norm ∥x∥= ⟨x, x⟩1/2, one sees from the
polarization identity that A is orthogonal iﬀ∥Ax∥= ∥x∥, for all x ∈Rn,

288
9. An Introduction to Lie Groups
or in terms of the transpose AT , which is deﬁned by ⟨Ax, y⟩=

x, AT y

,
we see that A is orthogonal iﬀAAT = I.
Let O(n) denote the orthogonal elements of L(Rn, Rn). For A ∈O(n),
we see that
1 = det(AAT ) = (det A)(det AT ) = (det A)2;
hence det A = ±1, and so A ∈GL(n, R). Furthermore, if A, B ∈O(n), then
⟨ABx, ABy⟩= ⟨Bx, By⟩= ⟨x, y⟩,
and so AB ∈O(n). Letting x′ = A−1x and y′ = A−1y, we see that
⟨x, y⟩= ⟨Ax′, Ay′⟩= ⟨x′, y′⟩,
that is,
⟨x, y⟩=

A−1x, A−1y

;
hence A−1 ∈O(n).
Let S(n) denote the vector space of symmetric linear maps of Rn to itself,
and let ψ : GL(n, R) →S(n) be deﬁned by ψ(A) = AAT . We claim that I
is a regular value of ψ. Indeed, if A ∈ψ−1(I) = O(n), the derivative of ψ
is
Dψ(A) · B = ABT + BAT ,
which is onto (to hit C, take B = CA/2). Thus, ψ−1(I) = O(n) is a closed
Lie subgroup of GL(n, R), called the orthogonal group. The group O(n)
is also bounded in L(Rn, Rn): The norm of A ∈O(n) is
∥A∥=

trace(AT A)
1/2 = (trace I)1/2 = √n.
Therefore, O(n) is compact. We shall see in §9.3 that O(n) is not connected,
but has two connected components, one where det = +1 and the other
where det = −1.
The Lie algebra o(n) of O(n) is ker Dψ(I), namely, the skew-symmetric
linear maps with the usual commutator bracket [A, B] = AB −BA. The
space of skew-symmetric n×n matrices has dimension equal to the number
of entries above the diagonal, namely, n(n −1)/2. Thus,
dim[O(n)] = 1
2n(n −1).
The special orthogonal group is deﬁned as
SO(n) = O(n) ∩SL(n, R),
that is,
SO(n) = { A ∈O(n) | det A = +1 }.
(9.2.6)

9.2 Some Classical Lie Groups
289
Since SO(n) is the kernel of det : O(n) →{−1, 1}, that is, SO(n) =
det−1(1), it is an open and closed Lie subgroup of O(n), hence is com-
pact. We shall prove in §9.3 that SO(n) is the connected component of
O(n) containing the identity I, and so has the same Lie algebra as O(n).
We summarize:
Proposition 9.2.5.
The Lie group O(n) is a compact Lie group of di-
mension n(n −1)/2. Its Lie algebra o(n) is the space of skew-symmetric
n × n matrices with bracket [A, B] = AB −BA. The connected compo-
nent of the identity in O(n) is the compact Lie group SO(n), which has
the same Lie algebra so(n) = o(n). The Lie group O(n) has two connected
components.
Rotations in the Plane SO(2).
We parametrize
S1 = { x ∈R2 | ∥x∥= 1 }
by the polar angle θ, 0 ≤θ < 2π. For each θ ∈[0, 2π], let
Aθ =

cos θ
−sin θ
sin θ
cos θ

,
using the standard basis of R2. Then Aθ ∈SO(2) represents a counter-
clockwise rotation through the angle θ. Conversely, if
A =

a1
a2
a3
a4

is orthogonal, the relations
a2
1 + a2
2 = 1,
a2
3 + a2
4 = 1,
a1a3 + a2a4 = 0,
det A = a1a4 −a2a3 = 1
show that A = Aθ for some θ. Thus, SO(2) can be identiﬁed with S1, that
is, with rotations in the plane.
Rotations in Space SO(3).
The Lie algebra so(3) of SO(3) may be
identiﬁed with R3 as follows. We deﬁne the vector space isomorphism ˆ :
R3 →so(3), called the hat map, by
v = (v1, v2, v3) →ˆv =


0
−v3
v2
v3
0
−v1
−v2
v1
0

.
(9.2.7)
Note that the identity
ˆvw = v × w

290
9. An Introduction to Lie Groups
characterizes this isomorphism. We get
(ˆuˆv −ˆvˆu) w = ˆu(v × w) −ˆv(u × w)
= u × (v × w) −v × (u × w)
= (u × v) × w = (u × v)ˆ· w.
Thus, if we put the cross product on R3, ˆ becomes a Lie algebra isomor-
phism, and so we can identify so(3) with R3 carrying the cross product as
Lie bracket.
We also note that the standard dot product may be written
v · w = 1
2 trace
ˆvT ˆw

= −1
2 trace (ˆv ˆw) .
Theorem 9.2.6 (Euler’s Theorem).
Every element A ∈SO(3), A ̸= I,
is a rotation through an angle θ about an axis w.
To prove this, we use the following lemma:
Lemma 9.2.7.
Every A ∈SO(3) has an eigenvalue equal to 1.
Proof.
The eigenvalues of A are given by roots of the third-degree poly-
nomial det(A −λI) = 0. Roots occur in conjugate pairs, so at least one is
real. If λ is a real root and x is a nonzero real eigenvector, then Ax = λx,
so
∥Ax∥2 = ∥x∥2
and
∥Ax∥2 = |λ|2 ∥x∥2
imply λ = ±1. If all three roots are real, they are (1, 1, 1) or (1, −1, −1),
since det A = 1. If there is one real and two complex conjugate roots, they
are (1, ω, ¯ω), since det A = 1. In any case, one real root must be +1.
■
Proof of Theorem 9.2.6.
By Lemma 9.2.7, the matrix A has an eigen-
vector w with eigenvalue 1, say Aw = w. The line spanned by w is also
invariant under A. Let P be the plane perpendicular to w; that is,
P = { y | ⟨w, y⟩= 0 } .
Since A is orthogonal, A(P) = P. Let e1, e2 be an orthogonal basis in P.
Then relative to (w, e1, e2), A has the matrix
A =


1
0
0
0
a1
a2
0
a3
a4

.
Since

a1
a2
a3
a4

lies in SO(2), A is a rotation about the axis w by some angle.
■

9.2 Some Classical Lie Groups
291
Corollary 9.2.8.
Any A ∈SO(3) can be written in some orthonormal
basis as the matrix
A =


1
0
0
0
cos θ
−sin θ
0
sin θ
cos θ

.
The inﬁnitesimal version of Euler’s theorem is the following:
Proposition 9.2.9.
Identifying the Lie algebra so(3) of SO(3) with the
Lie algebra R3, exp(t ˆw) is a rotation about w by the angle t∥w∥, where
w ∈R3.
Proof.
To simplify the computation, we pick an orthonormal basis {e1, e2,
e3} of R3, with e1 = w/∥w∥. Relative to this basis, ˆw has the matrix
ˆw = ∥w∥


0
0
0
0
0
−1
0
1
0

.
Let
c(t) =


1
0
0
0
cos t∥w∥
−sin t∥w∥
0
sin t∥w∥
cos t∥w∥

.
Then
c′(t) =


0
0
0
0
−∥w∥sin t∥w∥
−∥w∥cos t∥w∥
0
∥w∥cos t∥w∥
−∥w∥sin t∥w∥


= c(t) ˆw = TILc(t)( ˆw) = Xˆw(c(t)),
where Xˆw is the left-invariant vector ﬁeld corresponding to ˆw. Therefore,
c(t) is an integral curve of Xˆw; but exp(t ˆw) is also an integral curve of Xˆw.
Since both agree at t = 0, exp(t ˆw) = c(t), for all t ∈R. But the matrix
deﬁnition of c(t) expresses it as a rotation by an angle t∥w∥about the
axis w.
■
Despite Euler’s theorem, it might be good to recall now that SO(3) can-
not be written as S2 × S1; see Exercise 1.2-4.
Amplifying on Proposition 9.2.9, we give the following explicit formula
for exp ξ, where ξ ∈so(3), which is called Rodrigues’ formula:
exp[ˆv] = I + sin ∥v∥
∥v∥
ˆv + 1
2


sin

∥v∥
2

∥v∥
2


2
ˆv2.
(9.2.8)
This formula was given by Rodrigues in 1840; see also Exercise 1 in Hel-
gason [1978, p. 249] and see Altmann [1986] for some interesting history of
this formula.

292
9. An Introduction to Lie Groups
Proof of Rodrigues’ Formula.
By (9.2.7),
ˆv2w = v × (v × w) = ⟨v, w⟩v −∥v∥2w.
(9.2.9)
Consequently, we have the recurrence relations
ˆv3 = −∥v∥2ˆv,
ˆv4 = −∥v∥2ˆv2,
ˆv5 = ∥v∥4ˆv,
ˆv6 = ∥v∥4ˆv2, . . . .
Splitting the exponential series in odd and even powers,
exp[ˆv] = I +

I −∥v∥2
3!
+ ∥v∥4
5!
−· · · + (−1)n+1
∥v∥2n
(2n + 1)! + · · ·

ˆv
+
 1
2! −∥v∥2
4!
+ ∥v∥4
6!
+ · · · + (−1)n−1 ∥v∥n−2
(2n)!
+ · · ·

ˆv2
= I + sin ∥v∥
∥v∥
ˆv + 1 −cos ∥v∥
∥v∥2
ˆv2,
(9.2.10)
and so the result follows from the identity 2 sin2(∥v∥/2) = 1 −cos ∥v∥.
■
The following alternative expression, equivalent to (9.2.8), is often useful.
Set n = v/∥v∥, so that ∥n∥= 1. From (9.2.9) and (9.2.10) we obtain
exp[ˆv] = I + (sin ∥v∥)ˆn + (1 −cos ∥v∥)[n ⊗n −I].
(9.2.11)
Here, n ⊗n is the matrix whose entries are ninj, or as a bilinear form,
(n ⊗n)(α, β) = n(α)n(β). Therefore, we obtain a rotation about the unit
vector n = v/∥v∥of magnitude ∥v∥.
The results (9.2.8) and (9.2.11) are useful in computational solid me-
chanics, along with their quaternionic counterparts. We shall return to this
point below in connection with SU(2); see Whittaker [1927] and Simo and
Fox [1989] for more information.
We next give a topological property of SO(3).
Proposition 9.2.10.
The rotation group SO(3) is diﬀeomorphic to the
real projective space RP3.
Proof.
To see this, map the unit ball D in R3 to SO(3) by sending
(x, y, z) to the rotation about (x, y, z) through the angle π
	
x2 + y2 + z2
(and (0, 0, 0) to the identity). This mapping is clearly smooth and surjec-
tive. Its restriction to the interior of D is injective. On the boundary of D,
this mapping is 2 to 1, so it induces a smooth bijective map from D, with
antipodal points on the boundary identiﬁed, to SO(3). It is a straightfor-
ward exercise to show that the inverse of this map is also smooth. Thus,
SO(3) is diﬀeomorphic with D, with antipodal points on the boundary
identiﬁed.
However, the mapping
(x, y, z) →(x, y, z,
	
1 −x2 −y2 −z2)

9.2 Some Classical Lie Groups
293
is a diﬀeomorphism between D, with antipodal points on the boundary
identiﬁed, and the upper unit hemisphere of S3 with antipodal points on
the equator identiﬁed. The latter space is clearly diﬀeomorphic to the unit
sphere S3 with antipodal points identiﬁed, which coincides with the space
of lines in R4 through the origin, that is, with RP3.
■
The Real Symplectic Group Sp(2n, R).
Let
J =

0
I
−I
0

.
Recall that A ∈L(R2n, R2n) is symplectic if AT JA = J. Let Sp(2n, R) be
the set of 2n×2n symplectic matrices. Taking determinants of the condition
AT JA = J gives
1 = det J = (det AT ) · (det AJ) · (det A) = (det A)2.
Hence,
det A = ±1,
and so A ∈GL(2n, R). Furthermore, if A, B ∈Sp(2n, R), then
(AB)T J(AB) = BT AT JAB = J.
Hence, AB ∈Sp(2n, R), and if AT JA = J, then
JA = (AT )−1J = (A−1)T J,
so
J =

A−1T JA−1,
or
A−1 ∈Sp(2n, R).
Thus, Sp(2n, R) is a group. If
A =

a
b
c
d

∈GL(2n, R),
then (see Exercise 2.3-2)
A ∈Sp(2n, R) iﬀ

aT c and bT d are symmetric and
aT d −cT b = 1.
(9.2.12)
Deﬁne ψ : GL(2n, R) →so(2n) by ψ(A) = AT JA. Let us show that J is
a regular value of ψ. Indeed, if A ∈ψ−1(J) = Sp(2n, R), the derivative of
ψ is
Dψ(A) · B = BT JA + AT JB.
Now, if C ∈so(2n), let
B = −1
2AJC.

294
9. An Introduction to Lie Groups
We verify, using the identity AT J = JA−1, that Dψ(A) · B = C. Indeed,
BT JA + AT JB = BT (A−1)T J + JA−1B
= (A−1B)T J + J(A−1B)
= (−1
2JC)T J + J(−1
2JC)
= −1
2CT JT J −1
2J2C
= −1
2CJ2 −1
2J2C = C,
since JT = −J and J2 = −I. Thus Sp(2n, R) = ψ−1(J) is a closed smooth
submanifold of GL(2n, R) whose Lie algebra is
ker Dψ(J) =

B ∈L

R2n, R2n
| BT J + JB = 0

.
The Lie group Sp(2n, R) is called the symplectic group, and its Lie
algebra
sp(2n, R) =

A ∈L

R2n, R2n
| AT J + JA = 0

the symplectic algebra. Moreover, if
A =

a
b
c
d

∈sl(2n, R),
then
A ∈sp(2n, R) iﬀd = −aT , c = cT , and b = bT .
(9.2.13)
The dimension of sp(2n, R) can be readily calculated to be 2n2 + n.
Using (9.2.12), it follows that all matrices of the form

I
0
tI
I

are symplectic. However, the norm of such a matrix is equal to
√
2n + t2n,
which is unbounded if t ∈R. Therefore, Sp(2n, R) is not a bounded subset
of gl(2n, R) and hence is not compact. We next summarize what we have
found.
Proposition 9.2.11.
The symplectic group
Sp(2n, R) := { A ∈GL(2n, R) | AT JA = J }
is a noncompact, connected Lie group of dimension 2n2 +n. Its Lie algebra
sp(2n, R) consists of the 2n×2n matrices A satisfying AT J+JA = 0, where
J =
 0
I
−I
0

with I the n × n identity matrix.

9.2 Some Classical Lie Groups
295
We shall indicate in §9.3 how one proves that Sp(2n, R) is connected.
We are ready to prove that symplectic linear maps have determinant 1,
a fact that we promised in Chapter 2.
Lemma 9.2.12.
If A ∈Sp(n, R), then det A = 1.
Proof.
Since AT JA = J and det J = 1, it follows that (det A)2 = 1.
Unfortunately, this still leaves open the possibility that det A = −1. To
eliminate it, we proceed in the following way.
Deﬁne the symplectic form Ωon R2n by Ω(u, v) = uT Jv, that is, relative
to the chosen basis of R2n, the matrix of Ωis J. As we saw in Chapter 5, the
standard volume form µ on R2n is given, up to a factor, by µ = Ω∧Ω∧· · ·∧Ω,
or, equivalently,
µ(v1, . . . , v2n) = det (Ω(vi, vj)) .
By the deﬁnition of the determinant of a linear map, (det A)µ = A∗µ, we
get
(det A)µ (v1, . . . , v2n) = (A∗µ) (v1, . . . , v2n)
= µ (Av1, . . . , Av2n) = det (Ω(Avi, Avj))
= det (Ω(vi, vj))
= µ (v1, . . . , v2n) ,
since A ∈Sp(2n, R), which is equivalent to Ω(Au, Av) = Ω(u, v) for all
u, v ∈R2n. Taking v1, . . . , v2n to be the standard basis of R2n, we conclude
that det A = 1.
■
Proposition 9.2.13 (Symplectic Eigenvalue Theorem).
If λ0 ∈C is an
eigenvalue of A ∈Sp(2n, R) of multiplicity k, then 1/λ0, λ0, and 1/λ0
are eigenvalues of A of the same multiplicity k. Moreover, if ±1 occur as
eigenvalues, their multiplicities are even.
Proof.
Since A is a real matrix, if λ0 is an eigenvalue of A of multiplicity
k, so is λ0 by elementary algebra.
Let us show that 1/λ0 is also an eigenvalue of A. If p(λ) = det(A −λI)
is the characteristic polynomial of A, since
JAJ−1 =

A−1T ,

296
9. An Introduction to Lie Groups
det J = 1, J−1 = −J = JT , and det A = 1 (by Lemma 9.2.11), we get
p(λ) = det(A −λI) = det

J(A −λI)J−1
= det(JAJ−1 −λI) = det

A−1 −λI
T 
= det(A−1 −λI) = det

A−1(I −λA)

= det(I −λA) = det
 
λ
 1
λI −A
!!
= λ2n det
 1
λI −A
!
= λ2n(−1)2n det
 
A −1
λI
!
= λ2np
 1
λ
!
.
(9.2.14)
Since 0 is not an eigenvalue of A, it follows that p(λ) = 0 iﬀp (1/λ) = 0,
and hence, λ0 is an eigenvalue of A iﬀ1/λ0 is an eigenvalue of A.
Now assume that λ0 has multiplicity k, that is,
p(λ) = (λ −λ0)kq(λ)
for some polynomial q(λ) of degree 2n −k satisfying q(λ0) ̸= 0. Since
p(λ) = λ2np(1/λ), we conclude that
p(λ) = p
 1
λ

λ2n = (λ −λ0)kq(λ) = (λλ0)k
 1
λ0
−1
λ
!k
q(λ).
However,
λk
0
λ2n−k q(λ)
is a polynomial in 1/λ, since the degree of q(λ) is 2n −k, k ≤2n. Thus
1/λ0 is a root of p(λ) having multiplicity l ≥k. Reversing the roles of λ0
and 1/λ0, we similarly conclude that k ≥l, and hence it follows that k = l.
Finally, note that λ0 = 1/λ0 iﬀλ0 = ±1. Thus, since all eigenvalues of
A occur in pairs whose product is 1 and the size of A is 2n × 2n, it follows
that the total number of times +1 and −1 occur as eigenvalues is even.
However, since det A = 1 by Lemma 9.2.12, we conclude that −1 occurs an
even number of times as an eigenvalue of A (if it occurs at all). Therefore,
the multiplicity of 1 as an eigenvalue of A, if it occurs, is also even.
■
Figure 9.2.1 illustrates the possible conﬁgurations of the eigenvalues of
A ∈Sp(4, R).
Next, we study the eigenvalues of matrices in sp(2n, R). The following
theorem is useful in the stability analysis of relative equilibria. If A ∈

9.2 Some Classical Lie Groups
297
x
y
x
y
x
y
x
y
x
y
x
y
x
y
complex saddle
saddle center
real saddle
generic center
degenerate saddle
identity
degenerate center
(2) (2)
(4)
(2)
(2)
Figure 9.2.1. Symplectic eigenvalue theorem on R4.
sp(2n, R), then AT J + JA = 0, so that if p(λ) = det(A −λI) is the charac-
teristic polynomial of A, we have
p(λ) = det(A −λI) = det(J(A −λI)J)
= det(JAJ + λI)
= det(−AT J2 + λI)
= det(AT + λI) = det(A + λI)
= p(−λ).
In particular, notice that trace(A) = 0. Proceeding as before and using this
identity, we conclude the following:
Proposition 9.2.14 (Inﬁnitesimally Symplectic Eigenvalues).
If λ0 ∈C
is an eigenvalue of A ∈sp(2n, R) of multiplicity k, then −λ0, λ0, and −λ0
are eigenvalues of A of the same multiplicity k. Moreover, if 0 is an eigen-
value, it has even multiplicity.
Figure 9.2.2 shows the possible inﬁnitesimally symplectic eigenvalue con-
ﬁgurations for A ∈sp(4, R).

298
9. An Introduction to Lie Groups
x
y
x
y
x
y
x
y
x
y
x
y
x
y
complex saddle
saddle center
real saddle
generic center
degenerate saddle
identity
degenerate center
(2)
(2)
(4)
(2)
(2)
Figure 9.2.2. Inﬁnitesimally symplectic eigenvalue theorem on R4.
The Symplectic Group and Mechanics.
Consider a particle of mass
m moving in a potential V (q), where q = (q1, q2, q3) ∈R3. Newton’s second
law states that the particle moves along a curve q(t) in R3 in such a way
that m¨q = −grad V (q). Introduce the momentum pi = m ˙qi, i = 1, 2, 3,
and the energy
H(q, p) =
1
2m
3

i=1
p2
i + V (q).
Then
∂H
∂qi = ∂V
∂qi = −m¨qi = −˙pi,
and
∂H
∂pi
= 1
mpi = ˙qi,
and hence Newton’s law F = ma is equivalent to Hamilton’s equations
˙qi = ∂H
∂pi
,
˙pi = −∂H
∂qi ,
i = 1, 2, 3.

9.2 Some Classical Lie Groups
299
Writing z = (q, p),
J · grad H(z) =

0
I
−I
0



∂H
∂q
∂H
∂p

= ( ˙q, ˙p) = ˙z,
so Hamilton’s equations read ˙z = J · grad H(z). Now let
f : R3 × R3 →R3 × R3
and write w = f(z). If z(t) satisﬁes Hamilton’s equations
˙z = J · grad H(z),
then w(t) = f(z(t)) satisﬁes
˙w = AT ˙z, where AT = [∂wi/∂zj] is the
Jacobian matrix of f. By the chain rule,
˙w = AT J gradz H(z) = AT JA gradw H(z(w)).
Thus, the equations for w(t) have the form of Hamilton’s equations with
energy K(w) = H(z(w)) if and only if AT JA = J, that is, iﬀA is symplec-
tic. A nonlinear transformation f is canonical iﬀits Jacobian matrix is
symplectic.
As a special case, consider a linear map A ∈Sp(2n, R) and let w = Az.
Suppose H is quadratic, that is, of the form H(z) = ⟨z, Bz⟩/2, where B is
a symmetric 2n × 2n matrix. Then
grad H(z) · δz = 1
2 ⟨δz, Bz⟩+ ⟨z, Bδz⟩
= 1
2(⟨δz, Bz⟩+ ⟨Bz, δz⟩) = ⟨δz, Bz⟩,
so grad H(z) = Bz and thus the equations of motion become the linear
equations ˙z = JBz. Now
˙w = A ˙z = AJBz = J(AT )−1Bz = J(AT )−1BA−1Az = JB′w,
where B′ = (AT )−1BA−1 is symmetric. For the new Hamiltonian we get
H′(w) = 1
2

w, (AT )−1BA−1w

= 1
2

A−1w, BA−1w

= H(A−1w) = H(z).
Thus, Sp(2n, R) is the linear invariance group of classical mechanics.
The Complex General Linear Group GL(n, C).
Many important Lie
groups involve complex matrices. As in the real case,
GL(n, C) = { n × n invertible complex matrices }

300
9. An Introduction to Lie Groups
is an open set in L(Cn, Cn) = { n×n complex matrices }. Clearly, GL(n, C)
is a group under matrix multiplication. Therefore, GL(n, C) is a Lie group
and has the Lie algebra gl(n, C) = { n×n complex matrices } = L(Cn, Cn).
Hence GL(n, C) has complex dimension n2, that is, real dimension 2n2.
We shall prove below that GL(n, C) is connected (contrast this with
the fact that GL(n, R) has two components). As in the real case, we will
need a polar decomposition theorem to do this. A matrix U ∈GL(n, C)
is unitary if UU † = U †U = I, where U † := U
T. A matrix P ∈gl(n, C)
is called Hermitian if P † = P. A Hermitian matrix P is called positive
deﬁnite, denoted by P > 0, if ⟨Pz, z⟩> 0 for all z ∈Cn, z ̸= 0, where
⟨, ⟩denotes the inner product on Cn. Note that P > 0 implies that P is
invertible.
Proposition 9.2.15 (Complex Polar Decomposition).
For any matrix
A ∈GL(n, C), there exists a unique unitary matrix U and positive deﬁnite
Hermitian matrices P1, P2 such that
A = UP1 = P2U.
The proof is identical to that of Proposition 9.2.1 with the obvious
changes. The only additional property needed is the fact that the eigenval-
ues of a Hermitian matrix are real. As in the proof of the real case, one
needs to use the connectedness of the space of unitary matrices (proved in
§9.3) to conclude the following:
Proposition 9.2.16.
The group GL(n, C) is a complex noncompact con-
nected Lie group of complex dimension n2 and real dimension 2n2. Its Lie
algebra gl(n, C) consists of all n×n complex matrices with the commutator
bracket.
On gl(n, C), the inner product is deﬁned by
⟨A, B⟩= trace(AB†).
The Complex Special Linear Group.
This group is deﬁned by
SL(n, C) := { A ∈GL(n, C) | det A = 1 }
and is treated as in the real case. In the proof of its connectedness one uses
the complex polar decomposition theorem and the fact that any Hermitian
matrix can be diagonalized by conjugating it with an appropriate unitary
matrix.
Proposition 9.2.17.
The group SL(n, C) is a complex noncompact Lie
group of complex dimension n2 −1 and real dimension 2(n2 −1). Its Lie
algebra sl(n, C) consists of all n×n complex matrices of trace zero with the
commutator bracket.

9.2 Some Classical Lie Groups
301
The Unitary Group U(n).
Recall that Cn has the Hermitian inner
product
⟨x, y⟩=
n

i=0
xi¯yi,
where x =

x1, . . . , xn
∈Cn, y =

y1, . . . , yn
∈Cn, and ¯yi denotes the
complex conjugate. Let
U(n) = { A ∈GL(n, C) | ⟨Ax, Ay⟩= ⟨x, y⟩} .
The orthogonality condition ⟨Ax, Ay⟩= ⟨x, y⟩is equivalent to AA† =
A†A = I, where A† = ¯AT , that is, ⟨Ax, y⟩=

x, A†y

. From | det A| = 1,
we see that det maps U(n) into the unit circle S1 = { z ∈C | |z| = 1 }. As
is to be expected by now, U(n) is a closed Lie subgroup of GL(n, C) with
Lie algebra
u(n) = { A ∈L(Cn, Cn) | ⟨Ax, y⟩= −⟨x, Ay⟩}
= { A ∈gl(n, C) | A† = −A };
the proof parallels that for O(n). The elements of u(n) are called skew-
Hermitian matrices. Since the norm of A ∈U(n) is
∥A∥=

trace(A†A)
1/2 = (trace I)1/2 = √n,
it follows that U(n) is closed and bounded, hence compact, in GL(n, C).
From the deﬁnition of u(n) it immediately follows that the real dimension
of U(n) is n2. Thus, even though the entries of the elements of U(n) are
complex, U(n) is a real Lie group.
In the special case n = 1, a complex linear map ϕ : C →C is multiplica-
tion by some complex number z, and ϕ is an isometry if and only if |z| = 1.
In this way the group U(1) is identiﬁed with the unit circle S1.
The special unitary group
SU(n) = { A ∈U(n) | det A = 1 } = U(n) ∩SL(n, C)
is a closed Lie subgroup of U(n) with Lie algebra
su(n) = { A ∈L(Cn, Cn) | ⟨Ax, y⟩= −⟨x, Ay⟩and trace A = 0 }.
Hence, SU(n) is compact and has (real) dimension n2 −1.
We shall prove later that both U(n) and SU(n) are connected.
Proposition 9.2.18.
The group U(n) is a compact real Lie subgroup of
GL(n, C) of (real) dimension n2. Its Lie algebra u(n) consists of the space
of skew-Hermitian n × n matrices with the commutator bracket. SU(n) is
a closed real Lie subgroup of U(n) of dimension n2 −1 whose Lie algebra
su(n) consists of all trace zero skew-Hermitian n × n matrices.
In the Internet supplement to this chapter, we shall show that
Sp(2n, R) ∩O(2n, R) = U(n).
We shall also discuss some beautiful generalizations of this fact.

302
9. An Introduction to Lie Groups
The Group SU(2).
This group warrants special attention, since it ap-
pears in many physical applications such as the Cayley–Klein parameters
for the free rigid body and in the construction of the (nonabelian) gauge
group for the Yang–Mills equations in elementary particle physics.
From the general formula for the dimension of SU(n) it follows that
dim SU(2) = 3. The group SU(2) is diﬀeomorphic to the three-sphere S3 =
{ x ∈R4 | ∥x∥= 1 }, with the diﬀeomorphism given by
x = (x0, x1, x2, x3) ∈S3 ⊂R4 →

x0 −ix3
−x2 −ix1
x2 −ix1
x0 + ix3

∈SU(2).
(9.2.15)
Therefore, SU(2) is connected and simply connected.
By Euler’s Theorem 9.2.6 every element of SO(3) diﬀerent from the iden-
tity is determined by a vector v, which we can choose to be a unit vector,
and an angle of rotation θ about the axis v. The trouble is, the pair (v, θ)
and (−v, −θ) represent the same rotation and there is no consistent way
to continuously choose one of these pairs, valid for the entire group SO(3).
Such a choice is called, in physics, a choice of spin. This immediately sug-
gests the existence of a double cover of SO(3) that, hopefully, should also
be a Lie group. We will show below that SU(2) fulﬁlls these requirements.
This is based on the following construction.
Let σ1, σ2, σ3 be the Pauli spin matrices, deﬁned by
σ1 =

0
1
1
0

,
σ2 =

0
−i
i
0

,
and
σ3 =

1
0
0
−1

,
and let σ = (σ1, σ2, σ3). Then one checks that
[σ1, σ2] = 2iσ3 (plus cyclic permutations),
from which one ﬁnds that the map
x →˜x = 1
2ix · σ = 1
2
$
−ix3
−ix1 −x2
−ix1 + x2
ix3
%
,
where x·σ = x1σ1 +x2σ2 +x3σ3, is a Lie algebra isomorphism between R3
and the 2×2 skew-Hermitian traceless matrices (the Lie algebra of SU(2));
that is, [˜x, ˜y] = (x × y)˜. Note that
−det(x · σ) = ∥x∥2, and trace (˜x˜y) = −1
2x · y.
Deﬁne the Lie group homomorphism π : SU(2) →GL(3, R) by
(π(A)x) · σ = A(x · σ)A† = A(x · σ)A−1.
(9.2.16)

9.2 Some Classical Lie Groups
303
A straightforward computation, using the expression (9.2.15), shows that
ker π = {±I}. Therefore, π(A) = π(B) if and only if A = ±B. Since
∥π(A)x∥2 = −det((π(A)x) · σ)
= −det(A(x · σ)A−1)
= −det(x · σ) = ∥x∥2,
it follows that
π(SU(2)) ⊂O(3).
But π(SU(2)) is connected, being the continuous image of a connected
space, and so
π(SU(2)) ⊂SO(3).
Let us show that π : SU(2) →SO(3) is a local diﬀeomorphism. Indeed, if
˜α ∈su(2), then
(Teπ(˜α)x) · σ = (x · σ)˜α† + ˜α(x · σ)
= [˜α, x · σ] = 2i[˜α, ˜x]
= 2i(˜α × x)˜= (˜α × x) · σ
= (ˆαx) · σ,
that is, Teπ(˜α) = ˆα. Thus,
Teπ : su(2) −→so(3)
is a Lie algebra isomorphism and hence is a local diﬀeomorphism in a
neighborhood of the identity. Since π is a Lie group homomorphism, it is
a local diﬀeomorphism around every point.
In particular, π(SU(2)) is open and hence closed (its complement is a
union of open cosets in SO(3)). Since it is nonempty and SO(3) is connected,
we have π(SU(2)) = SO(3). Therefore,
π : SU(2) →SO(3)
is a 2 to 1 surjective submersion. Summarizing, we have the commutative
diagram in Figure 9.2.3.
Proposition 9.2.19.
The Lie group SU(2) is the simply connected 2 to
1 covering group of SO(3).
Quaternions.
The division ring H (or, by abuse of language, the non-
commutative ﬁeld) of quaternions is generated over the reals by three ele-
ments i, j, k with the relations
i2 = j2 = k2 = −1,
ij = −ji = k,
jk = −kj = i,
ki = −ik = j.

304
9. An Introduction to Lie Groups
S3
SU(2)
RP3
SO(3)
≈
≈
2 : 1
2 : 1
✲
✲
❄
❄
Figure 9.2.3. The link between SU(2) and SO(3).
Quaternionic multiplication is performed in the usual manner (like polyno-
mial multiplication) taking the above relations into account. If a ∈H, we
write
a = (as, av) = as + a1
vi + a2
vj + a3
vk
for the scalar and vectorial part of the quaternion, where as, a1
v, a2
v,
a3
v ∈R. Quaternions having zero scalar part are also called pure quater-
nions. With this notation, quaternionic multiplication has the expression
ab = (asbs −av · bv, asbv + bsav + av × bv) .
In addition, every quaternion a = (as, av) has a conjugate a := (as, −av),
that is, the real numbers are ﬁxed by the conjugation and i = −i, j = −j,
and k = −k. Note that ab = ba. Every quaternion a ̸= 0 has an inverse
given by a−1 = a/|a|2, where
|a|2 := aa = aa = a2
s + ∥av∥2.
In particular, the unit quaternions, which, as a set, equal the unit sphere
S3 in R4, form a group under quaternionic multiplication.
Proposition 9.2.20.
The unit quaternions S3 = { a ∈H | |a| = 1 } form
a Lie group isomorphic to SU(2) via the isomorphism (9.2.15).
Proof.
We already noted that (9.2.15) is a diﬀeomorphism of S3 with
SU(2), so all that remains to be shown is that it is a group homomorphism,
which is a straightforward computation.
■
Since the Lie algebra of S3 is the tangent space at 1, it follows that it
is isomorphic to the pure quaternions R3. We begin by determining the
adjoint action of S3 on its Lie algebra.
If a ∈S3 and bv is a pure quaternion, the derivative of the conjugation
is given by
Ada bv = abva−1 = abv
a
|a|2 =
1
|a|2 (−av · bv, asbv + av × bv)(as, −av)
=
1
|a|2

0, 2as(av × bv) + 2(av · bv)av + (a2
s −∥av∥2)bv

.

9.2 Some Classical Lie Groups
305
Therefore, if a(t) = (1, tav), we have a(0) = 1, a′(0) = av, so that the Lie
bracket on the pure quaternions R3 is given by
[av, bv] = d
dt

t=0
Ada(t) bv
= d
dt

t=0
1
1 + t2∥av∥2 (2t(av × bv) + 2t2(av · bv)av
+

1 −t2∥av∥2)bv

= 2av × bv.
Thus, the Lie algebra of S3 is R3 relative to the Lie bracket given by twice
the cross product of vectors.
The derivative of the Lie group isomorphism (9.2.15) is given by
x ∈R3 →

−ix3
−ix1 −x2
−ix1 + x2
ix3

= 2˜x ∈su(2),
and is thus a Lie algebra isomorphism from R3 with twice the cross product
as bracket to su(2), or equivalently to (R3, ×).
Let us return to the commutative diagram in Figure 9.2.3 and determine
explicitly the 2 to 1 surjective map S3 →SO(3) that associates to a quater-
nion a ∈S3 ⊂H the rotation matrix A ∈SO(3). To compute this map, let
a ∈S3 and associate to it the matrix
U =

as −ia3
v
−a2
v −ia1
v
a2
v −ia1
v
as + ia3
v

,
where a = (as, av) = (as, a1
v, a2
v, a3
v). By (9.2.16), the rotation matrix is
given by A = π(U), namely,
(Ax) · σ = (π(U)x) · σ = U(x · σ)U †
=

as −ia3
v
−a2
v −ia1
v
a2
v −ia1
v
as + ia3
v
 
x3
x1 −ix2
x1 + ix2
−x3

×

as + ia3
v
a2
v + ia1
v
−a2
v + ia1
v
as −ia3
v

=

a2
s + (a1
v)2 −(a2
v)2 −(a3
v)2
x1 + 2(a1
va2
v −asa3
v)x2
+2(asa2
v + a1
va3
v)x3
σ1
+

2

a1
va2
v + asa3
v

x1 +

a2
s −(a1
v)2 + (a2
v)2 −(a3
v)2
x2
+2

a2
va3
v −asa1
v

x3
σ2
+

2

a1
va3
v −asa2
v

x1 + 2

asa1
v + a2
va3
v

x2
+

a2
s −(a1
v)2 −(a2
v)2 + (a3
v)2
x3
σ3.

306
9. An Introduction to Lie Groups
Thus, taking into account that a2
s + (a1
v)2 + (a2
v)2 + (a3
v)2 = 1, we get the
expression of the matrix A as


2a2
s + 2(a1
v)2 −1
2(−asa3
v + a1
va2
v)
2(asa2
v + a1
va3
v)
2(asa3
v + a1
va2
v)
2a2
s + 2(a2
v)2 −1
2(−asa1
v + a2
va3
v)
2(−asa1
v + a2
va3
v)
2(asa1
v + a2
va3
v)
2a2
s + (a3
v)2 −1


= (2a2
s −1)I + 2asˆav + 2av ⊗av,
(9.2.17)
where av ⊗av is the symmetric matrix whose (i, j) entry equals ai
vaj
v. The
map
a ∈S3 →(2a2
s −1)I + 2asˆav + 2av ⊗av
is called the Euler–Rodrigues parametrization. It has the advantage,
as opposed to the Euler angles parametrization, which has a coordinate
singularity, of being global. This is of crucial importance in computational
mechanics (see, for example, Marsden and Wendlandt [1997]).
Finally, let us rewrite Rodrigues’ formula (9.2.8) in terms of unit quater-
nions. Let
a = (as, av) =

cos ω
2 ,

sin ω
2

n

,
where ω > 0 is an angle and n is a unit vector. Since ˆn2 = n ⊗n −I, from
(9.2.8) we get
exp(ωn) = I + (sin ω)ˆn + 2

sin2 ω
2

(n ⊗n −I)
=

1 −2 sin2 ω
2

I + 2 cos ω
2 sin ω
2 ˆn + 2

sin2 ω
2

n ⊗n
=

2a2
s −1

I + 2asˆav + 2av ⊗av.
This expression then produces a rotation associated to each unit quaternion
a. In addition, using this parametrization, in 1840 Rodrigues found a beau-
tiful way of expressing the product of two rotations exp(ω1n1) · exp(ω2n2)
in terms of the given data. In fact, this was an early exploration of the
spin group! We refer to Whittaker [1927, Section 7], Altmann [1986], Enos
[1993], Lewis and Simo [1995], and references therein for further informa-
tion.
SU(2) Conjugacy Classes and the Hopf Fibration.
We next deter-
mine all conjugacy classes of S3 ∼= SU(2). If a ∈S3, then a−1 = a, and a
straightforward computation gives
aba−1 = (bs, 2(av · bv)av + 2as(av × bv) + (2a2
s −1)bv)
for any b ∈S3. If bs = ±1, that is, bv = 0, then the above formula shows
that aba−1 = b for all a ∈S3, that is, the classes of I and −I, where
I = (1, 0), each consist of one element, and the center of SU(2) ∼= S3 is
{±I}.

9.2 Some Classical Lie Groups
307
In what follows, assume that bs ̸= ±1, or, equivalently, that bv ̸= 0, and
ﬁx this b ∈S3 throughout the following discussion. We shall prove that
given x ∈R3 with ∥x∥= ∥bv∥, we can ﬁnd a ∈S3 such that
2(av · bv)av + 2as(av × bv) + (2a2
s −1)bv = x.
(9.2.18)
If x = cbv for some c ̸= 0, then the choice av = 0 and 2a2
s = 1 + c satisﬁes
(9.2.18). Now assume that x and bv are not collinear. Take the dot product
of (9.2.18) with bv and get
2(av · bv)2 + 2a2
s∥bv∥2 = ∥bv∥2 + x · bv.
If ∥bv∥2 + x · bv = 0, since bv ̸= 0, it follows that av · bv = 0 and as = 0.
Returning to (9.2.18) it follows that −bv = x, which is excluded. Therefore,
x · bv + ∥bv∥2 ̸= 0, and searching for av ∈R3 such that av · bv = 0, it
follows that
a2
s = x · bv + ∥bv∥2
2∥bv∥2
̸= 0.
Now take the cross product of (9.2.18) with bv and recall that we assumed
av · bv = 0 to get
2as∥bv∥2av = bv × x,
whence
av =
bv × x
2as∥bv∥2 ,
which is allowed, since bv ̸= 0 and as ̸= 0. Note that a = (as, av) just
determined satisﬁes av · bv = 0 and
|a|2 = a2
s + ∥av∥2 = 1,
since ∥x∥= ∥bv∥.
Proposition 9.2.21.
The conjugacy classes of S3 ∼= SU(2) are the two-
spheres

bv ∈R3 | ∥bv∥2 = 1 −b2
s

for each bs ∈[−1, 1], which degenerate to the north and south poles (±1, 0, 0, 0)
comprising the center of SU(2).
The above proof shows that any unit quaternion is conjugate in S3 to a
quaternion of the form as + a3
vk, as, a3
v ∈R, which in terms of matrices
and the isomorphism (9.2.15) says that any SU(2) matrix is conjugate to a
diagonal matrix.
The conjugacy class of k is the unit sphere S2, and the orbit map
π : S3 →S2,
π(a) = aka,
is the Hopf ﬁbration.

308
9. An Introduction to Lie Groups
The subgroup
H =

as + a3
vk ∈S3 | as, a3
v ∈R

⊂S3
is a closed, one-dimensional Abelian Lie subgroup of S3 isomorphic via
(9.2.15) to the set of diagonal matrices in SU(2) and is hence the circle S1.
Note that the isotropy of k in S3 consists of H, as an easy computation
using (9.2.18) shows. Therefore, since the orbit of k is diﬀeomorphic to
S3/H, it follows that the ﬁbers of the Hopf ﬁbration equal the left cosets
aH for a ∈S3.
Finally, we shall give an expression of the Hopf ﬁbration in terms of
complex variables. In the representation (9.2.15), set
w1 = x2 + ix1,
w2 = x0 + ix3,
and note that if
a = (x0, x1, x2, x3) ∈S3 ⊂H,
then aka corresponds to

x0 −ix3
−x2 −ix1
x2 −ix1
x0 + ix3
 
−i
0
0
i
 
x0 + ix3
x2 + ix1
−x2 + ix1
x0 −ix3

=

−i

|x0 + ix3|2 −|x2 + ix1|2
−2i

x2 + ix1
(x0 −ix3)
−2i(x2 −ix1)(x0 + ix3)
i

|x0 + ix3|2 −|x2 + ix1|2

.
Thus, if we consider the diﬀeomorphisms
(x0, x1, x2, x3) ∈S3 ⊂H →

x0 −ix3
−x2 −ix1
x2 −ix1
x0 + ix3

∈SU(2)
→

−i(x2 + ix1), −i(x0 + ix3)

∈S3 ⊂C2,
the above orbit map, that is, the Hopf ﬁbration, becomes
(w1, w2) ∈S3 →

2w1w2, |w2|2 −|w1|2
∈S2.
Exercises
⋄9.2-1.
Describe the set of matrices in SO(3) that are also symmetric.
⋄9.2-2.
If A ∈Sp(2n, R), show that AT ∈Sp(2n, R) as well.
⋄9.2-3.
Show that sp(2n, R) is isomorphic, as a Lie algebra, to the space
of homogeneous quadratic functions on R2n under the Poisson bracket.
⋄9.2-4.
A map f : Rn →Rn preserving the distance between any two
points, that is, ∥f(x) −f(y)∥= ∥x −y∥for all x, y ∈Rn, is called an
isometry. Show that f is an isometry preserving the origin if and only if
f ∈O(n).

9.3 Actions of Lie Groups
309
9.3
Actions of Lie Groups
In this section we develop some basic facts about actions of Lie groups on
manifolds. One of our main applications later will be the description of
Hamiltonian systems with symmetry groups.
Basic Deﬁnitions.
We begin with the deﬁnition of the action of a Lie
group G on a manifold M.
Deﬁnition 9.3.1.
Let M be a manifold and let G be a Lie group. A (left)
action of a Lie group G on M is a smooth mapping Φ : G×M →M such
that:
(i) Φ(e, x) = x for all x ∈M; and
(ii) Φ(g, Φ(h, x)) = Φ(gh, x) for all g, h ∈G and x ∈M.
A right action is a map Ψ : M × G →M that satisﬁes Ψ(x, e) = x and
Ψ(Ψ(x, g), h) = Ψ(x, gh). We sometimes use the notation g ·x = Φ(g, x) for
left actions, and x·g = Ψ(x, g) for right actions. In the inﬁnite-dimensional
case there are important situations where care with the smoothness is
needed. For the formal development we assume that we are in the Banach–
Lie group context.
For every g ∈G let Φg : M →M be given by x →Φ(g, x). Then (i)
becomes Φe = idM, while (ii) becomes Φgh = Φg ◦Φh. Deﬁnition 9.3.1
can now be rephrased by saying that the map g →Φg is a homomorphism
of G into Diﬀ(M), the group of diﬀeomorphisms of M. In the special but
important case where M is a Banach space V and each Φg : V →V is
a continuous linear transformation, the action Φ of G on V is called a
representation of G on V .
Examples
(a)
SO(3) acts on R3 by (A, x) →Ax. This action leaves the two-sphere
S2 invariant, so the same formula deﬁnes an action of SO(3) on S2.
♦
(b)
GL(n, R) acts on Rn by (A, x) →Ax.
♦
(c)
Let X be a complete vector ﬁeld on M, that is, one for which the
ﬂow Ft of X is deﬁned for all t ∈R. Then Ft : M →M deﬁnes an action
of R on M.
♦
Orbits and Isotropy.
If Φ is an action of G on M and x ∈M, the orbit
of x is deﬁned by
Orb(x) = { Φg(x) | g ∈G } ⊂M.

310
9. An Introduction to Lie Groups
In ﬁnite dimensions one can show that Orb(x) is an immersed submanifold
of M (Abraham and Marsden [1978, p. 265]). For x ∈M, the isotropy (or
stabilizer or symmetry) group of Φ at x is given by
Gx := { g ∈G | Φg(x) = x } ⊂G.
Since the map Φx : G →M deﬁned by Φx(g) = Φ(g, x) is continuous,
Gx = (Φx)−1(x) is a closed subgroup and hence a Lie subgroup of G.
The manifold structure of Orb(x) is deﬁned by requiring the bijective map
[g] ∈G/Gx →g · x ∈Orb(x) to be a diﬀeomorphism. That G/Gx is a
smooth manifold follows from Proposition 9.3.2, which is discussed below.
An action is said to be:
1. transitive if there is only one orbit or, equivalently, if for every x, y ∈
M there is a g ∈G such that g · x = y;
2. eﬀective (or faithful) if Φg = idM implies g = e; that is, g →Φg is
one-to-one; and
3. free if it has no ﬁxed points, that is, Φg(x) = x implies g = e or,
equivalently, if for each x ∈M, g →Φg(x) is one-to-one. Note that
an action is free iﬀGx = {e}, for all x ∈M and that every free action
is faithful.
Examples
(a) Left translation.
Lg : G →G, h →gh, deﬁnes a transitive and free
action of G on itself. Note that right multiplication Rg : G →G, h →hg,
does not deﬁne a left action because Rgh = Rh ◦Rg, so that g →Rg is
an antihomomorphism. However, g →Rg does deﬁne a right action, while
g →Rg−1 deﬁnes a left action of G on itself.
♦
(b)
g →Ig = Rg−1 ◦Lg. The map Ig : G →G given by h →ghg−1
is the inner automorphism associated with g. Orbits of this action are
called conjugacy classes or, in the case of matrix groups, similarity
classes.
♦
(c) Adjoint Action.
Diﬀerentiating conjugation at e, we get the ad-
joint representation of G on g:
Adg := TeIg : TeG = g →TeG = g.
Explicitly, the adjoint action of G on g is given by
Ad : G × g →g,
Adg(ξ) = Te(Rg−1 ◦Lg)ξ.
For example, for SO(3) we have IA(B) = ABA−1, so diﬀerentiating with
respect to B at B = identity gives AdA ˆv = AˆvA−1. However,
(AdA ˆv)(w) = Aˆv(A−1w) = A(v × A−1w) = Av × w,

9.3 Actions of Lie Groups
311
so
(AdA ˆv) = (Av)ˆ.
Identifying so(3) ∼= R3, we get AdA v = Av.
♦
(d) Coadjoint Action.
The coadjoint action of G on g∗, the dual of
the Lie algebra g of G, is deﬁned as follows. Let Ad∗
g : g∗→g∗be the dual
of Adg, deﬁned by

Ad∗
g α, ξ

= ⟨α, Adg ξ⟩
for α ∈g∗and ξ ∈g. Then the map
Φ∗: G × g∗→g∗
given by
(g, α) →Ad∗
g−1 α
is the coadjoint action of G on g∗. The corresponding coadjoint repre-
sentation of G on g∗is denoted by
Ad∗: G →GL(g∗, g∗),
Ad∗
g−1 =

Te(Rg ◦Lg−1)
∗.
We will avoid the introduction of yet another ∗by writing (Adg−1)∗or
simply Ad∗
g−1, where ∗denotes the usual linear-algebraic dual, rather than
Ad∗(g), in which ∗is simply part of the name of the function Ad∗. Any
representation of G on a vector space V similarly induces a contragredient
representation of G on V ∗.
♦
Quotient (Orbit) Spaces.
An action of Φ of G on a manifold M deﬁnes
an equivalence relation on M by the relation of belonging to the same orbit;
explicitly, for x, y ∈M, we write x ∼y if there exists a g ∈G such that
g·x = y, that is, if y ∈Orb(x) (and hence x ∈Orb(y)). We let M/G be the
set of these equivalence classes, that is, the set of orbits, sometimes called
the orbit space. Let
π : M →M/G,
x →Orb(x),
and give M/G the quotient topology by deﬁning U ⊂M/G to be open
if and only if π−1(U) is open in M. To guarantee that the orbit space
M/G has a smooth manifold structure, further conditions on the action
are required.
An action Φ : G × M →M is called proper if the mapping
˜Φ : G × M →M × M,
deﬁned by
˜Φ(g, x) = (x, Φ(g, x)),
is proper. In ﬁnite dimensions this means that if K ⊂M × M is compact,
then ˜Φ−1(K) is compact. In general, this means that if {xn} is a convergent
sequence in M and Φgn(xn) converges in M, then {gn} has a convergent

312
9. An Introduction to Lie Groups
subsequence in G. For instance, if G is compact, this condition is auto-
matically satisﬁed. Orbits of proper Lie group actions are closed and hence
embedded submanifolds. The next proposition gives a useful suﬃcient con-
dition for M/G to be a smooth manifold.
Proposition 9.3.2.
If Φ : G × M →M is a proper and free action, then
M/G is a smooth manifold and π : M →M/G is a smooth submersion.
For the proof, see Proposition 4.2.23 in Abraham and Marsden [1978].
(In inﬁnite dimensions one uses these ideas, but additional technicalities
often arise; see Ebin [1970] and Isenberg and Marsden [1982].) The idea
of the chart construction for M/G is based on the following observation.
If x ∈M, then there is an isomorphism ϕx of Tπ(x)(M/G) with the quo-
tient space TxM/Tx Orb(x). Moreover, if y = Φg(x), then TxΦg induces an
isomorphism
ψx,y : TxM/Tx Orb(x) →TyM/Ty Orb(y)
satisfying ϕy ◦ψx,y = ϕx.
Examples
(a)
G = R acts on M = R by translations; explicitly,
Φ : G × M →M,
Φ(s, x) = x + s.
Then for x ∈R, Orb(x) = R. Hence M/G is a single point, and the action
is transitive, proper, and free.
♦
(b)
G = SO(3), M = R3 (∼= so(3)∗). Consider the action for x ∈R3 and
A ∈SO(3) given by ΦAx = Ax. Then
Orb(x) = { y ∈R3 | ∥y∥= ∥x∥} = a sphere of radius ∥x∥.
Hence M/G ∼= R+. The set
R+ = { r ∈R | r ≥0 }
is not a manifold because it includes the endpoint r = 0. Indeed, the action
is not free, since it has the ﬁxed point 0 ∈R3.
♦
(c)
Let G be Abelian. Then Adg = idg, Ad∗
g−1 = idg∗, and the adjoint
and coadjoint orbits of ξ ∈g and α ∈g∗, respectively, are the one-point
sets {ξ} and {α}.
♦
We will see later that coadjoint orbits can be natural phase spaces for
some mechanical systems like the rigid body; in particular, they are always
even-dimensional.

9.3 Actions of Lie Groups
313
Inﬁnitesimal Generators.
Next we turn to the inﬁnitesimal description
of an action, which will be a crucial concept for mechanics.
Deﬁnition 9.3.3.
Suppose Φ : G × M →M is an action. For ξ ∈g, the
map Φξ : R × M →M, deﬁned by
Φξ(t, x) = Φ(exp tξ, x),
is an R-action on M. In other words, Φexp tξ : M →M is a ﬂow on M.
The corresponding vector ﬁeld on M, given by
ξM(x) := d
dt

t=0
Φexp tξ(x),
is called the inﬁnitesimal generator of the action corresponding to ξ.
Proposition 9.3.4.
The tangent space at x to an orbit Orb(x0) is
Tx Orb(x0) = { ξM(x) | ξ ∈g } ,
where Orb(x0) is endowed with the manifold structure making G/Gx0 →
Orb(x0) into a diﬀeomorphism.
The idea is as follows: Let σξ(t) be a curve in G with σξ(0) = e that is
tangent to ξ at t = 0. Then the map Φx,ξ(t) = Φσξ(t)(x) is a smooth curve
in Orb(x0) with Φx,ξ(0) = x. Hence by the chain rule (see also Lemma
9.3.7 below),
d
dt

t=0
Φx,ξ(t) = d
dt

t=0
Φσξ(t)(x) = ξM(x)
is a tangent vector at x to Orb(x0). Furthermore, each tangent vector is
obtained in this way, since tangent vectors are equivalence classes of such
curves.
The Lie algebra of the isotropy group Gx, x ∈M, called the isotropy
(or stabilizer, or symmetry) algebra at x, equals, by Proposition 9.1.13,
gx = { ξ ∈g | ξM(x) = 0 }.
Examples
(a)
The inﬁnitesimal generators for the adjoint action are computed as
follows. Let
Ad : G × g →g,
Adg(η) = Te(Rg−1 ◦Lg)(η).
For ξ ∈g, we compute the corresponding inﬁnitesimal generator ξg. By
deﬁnition,
ξg(η) =
 d
dt
!
t=0
Adexp tξ(η).

314
9. An Introduction to Lie Groups
By (9.1.5), this equals [ξ, η]. Thus, for the adjoint action,
ξg = adξ,
i. e. ,
ξg(η) = [ξ, η].
(9.3.1)
This operation deserves a special name. We deﬁne the ad operator
adξ : g →g by η →[ξ, η]. Thus,
ξg = adξ .
♦
(b)
We illustrate (a) for the group SO(3) as follows. Let A(t) = exp(tC),
where C ∈so(3); then A(0) = I and A′(0) = C. Thus, with B ∈so(3),
d
dt

t=0
(Adexp tC B) = d
dt

t=0
(exp(tC)B(exp(tC))−1)
= d
dt

t=0
(A(t)BA(t)−1)
= A′(0)BA−1(0) + A(0)BA−1′(0).
Diﬀerentiating A(t)A−1(t) = I, we obtain
d
dt(A−1(t)) = −A−1(t)A′(t)A−1(t),
so that
A−1′(0) = −A′(0) = −C.
Then the preceding equation becomes
d
dt

t=0
(Adexp tC B) = CB −BC = [C, B],
as expected.
♦
(c)
Let Ad∗: G × g∗→g∗be the coadjoint action (g, α) →Ad∗
g−1 α. If
ξ ∈g, we compute for α ∈g∗and η ∈g
⟨ξg∗(α), η⟩=
& d
dt

t=0
Ad∗
exp(−tξ)(α), η
'
= d
dt

t=0
(
Ad∗
exp(−tξ)(α), η
)
= d
dt

t=0

α, Adexp(−tξ) η

=
&
α, d
dt

t=0
Adexp(−tξ) η
'
= ⟨α, −[ξ, η]⟩= −⟨α, adξ(η)⟩= −

ad∗
ξ(α), η

.
Hence
ξg∗= −ad∗
ξ,
or
ξg∗(α) = −⟨α, [ξ, ·]⟩.
(9.3.2)
♦

9.3 Actions of Lie Groups
315
(d)
Identifying so(3) ∼= (R3, ×) and so(3)∗∼= R3∗, using the pairing given
by the standard Euclidean inner product, (9.3.2) reads
ξso(3)∗(l) = −l · (ξ × ·),
for l ∈so(3)∗and ξ ∈so(3). For η ∈so(3), we have

ξso(3)∗(l), η

= −l · (ξ × η) = −(l × ξ) · η = −⟨l × ξ, η⟩,
so that
ξR3(l) = −l × ξ = ξ × l.
As expected, ξR3(l) ∈Tl Orb(l) is tangent to Orb(l) (see Figure 9.3.1).
Allowing ξ to vary in so(3) ∼= R3, one obtains all of Tl Orb(l), consistent
with Proposition 9.3.4.
♦
ξ
ξ × l
l
Figure 9.3.1. ξR3(l) is tangent to Orb(l).
Equivariance.
A map between two spaces is equivariant when it respects
group actions on these spaces. We state this more precisely:
Deﬁnition 9.3.5.
Let M and N be manifolds and let G be a Lie group
that acts on M by Φg : M →M, and on N by Ψg : N →N. A smooth
map f : M →N is called equivariant with respect to these actions if for
all g ∈G,
f ◦Φg = Ψg ◦f,
(9.3.3)
that is, if the diagram in Figure 9.3.2 commutes.
Setting g = exp(tξ) and diﬀerentiating (9.3.3) with respect to t at t = 0
gives Tf ◦ξM = ξN ◦f. In other words, ξM and ξN are f-related. In
particular, if f is an equivariant diﬀeomorphism, then f ∗ξN = ξM.
Also note that if M/G and N/G are both smooth manifolds with the
canonical projections smooth submersions, an equivariant map f : M →N
induces a smooth map fG : M/G →N/G.

316
9. An Introduction to Lie Groups
M
N
M
N
f
f
Φg
Ψg
✲
✲
❄
❄
Figure 9.3.2. Commutative diagram for equivariance.
Averaging.
A useful device for constructing invariant objects is by av-
eraging. For example, let G be a compact group acting on a manifold M
and let α be a diﬀerential form on M. Then we form
α =
*
G
Φ∗
gα dµ(g),
where µ is Haar measure on G. One checks that α is invariant. One can do
the same with other tensors, such as Riemannian metrics on M, to obtain
invariant ones.
Brackets of Generators.
Now we come to an important formula re-
lating the Jacobi–Lie bracket of two inﬁnitesimal generators with the Lie
algebra bracket.
Proposition 9.3.6.
Let the Lie group G act on the left on the manifold
M. Then the inﬁnitesimal generator map ξ →ξM of the Lie algebra g
of G into the Lie algebra X(M) of vector ﬁelds of M is a Lie algebra
antihomomorphism; that is,
(aξ + bη)M = aξM + bηM
and
[ξM, ηM] = −[ξ, η]M
for all ξ, η ∈g and a, b ∈R.
To prove this, we use the following lemma:
Lemma 9.3.7.
(i) Let c(t) be a curve in G, c(0) = e, c′(0) = ξ ∈g.
Then
ξM(x) = d
dt

t=0
Φc(t)(x).
(ii) For every g ∈G,
(Adg ξ)M = Φ∗
g−1ξM.
Proof.
(i) Let Φx : G →M be the map Φx(g) = Φ(g, x). Since
Φx is smooth, the deﬁnition of the inﬁnitesimal generator says that
TeΦx(ξ) = ξM(x). Thus, (i) follows by the chain rule.

9.3 Actions of Lie Groups
317
(ii) We have
(Adg ξ)M(x) = d
dt

t=0
Φ(exp(t Adg ξ), x)
= d
dt

t=0
Φ(g(exp tξ)g−1, x) (by Corollary 9.1.8)
= d
dt

t=0
(Φg ◦Φexp tξ ◦Φg−1(x))
= TΦ−1
g
(x)Φg

ξM

Φg−1(x)

=

Φ∗
g−1ξM

(x).
■
Proof of Proposition 9.3.6.
Linearity follows, since ξM(x) = TeΦx(ξ).
To prove the second relation, put g = exp tη in (ii) of the lemma to get
(Adexp tη ξ)M = Φ∗
exp(−tη)ξM.
But Φexp(−tη) is the ﬂow of −ηM, so diﬀerentiating at t = 0 the right-hand
side gives [ξM, ηM]. The derivative of the left-hand side at t = 0 equals
[η, ξ]M by the preceding Example (a).
■
In view of this proposition one deﬁnes a left Lie algebra action of a
manifold M as a Lie algebra antihomomorphism ξ ∈g →ξM ∈X(M),
such that the mapping (ξ, x) ∈g × M →ξM(x) ∈TM is smooth.
Let Φ : G × G →G denote the action of G on itself by left translation:
Φ(g, h) = Lgh. For ξ ∈g, let Yξ be the corresponding right-invariant vector
ﬁeld on G. Then
ξG(g) = Yξ(g) = TeRg(ξ),
and similarly, the inﬁnitesimal generator of right translation is the left-
invariant vector ﬁeld g →TeLg(ξ).
Derivatives of Curves.
It is convenient to have formulas for the deriva-
tives of curves associated with the adjoint and coadjoint actions. For ex-
ample, let g(t) be a (smooth) curve in G and η(t) a (smooth) curve in g.
Let the action be denoted by concatenation:
g(t)η(t) = Adg(t) η(t).
Proposition 9.3.8.
The following holds:
d
dtg(t)η(t) = g(t)
+
[ξ(t), η(t)] + dη
dt
,
,
(9.3.4)
where
ξ(t) = g(t)−1 ˙g(t) := Tg(t)L−1
g(t)
dg
dt ∈g.

318
9. An Introduction to Lie Groups
Proof.
We have
d
dt

t=t0
Adg(t) η(t) = d
dt

t=t0

g(t0)[g(t0)−1g(t)]η(t)

= g(t0) d
dt

t=t0

[g(t0)−1g(t)]η(t)

,
where the ﬁrst g(t0) denotes the Ad-action, which is linear. Now, g(t0)−1g(t)
is a curve through the identity at t = t0 with tangent vector ξ(t0), so the
above becomes
g(t0)
+
[ξ(t0), η(t0)] + dη(t0)
dt
,
.
■
Similarly, for the coadjoint action we write
g(t)µ(t) = Ad∗
g(t)−1 µ(t),
and then, as above, one proves that
d
dt[g(t)µ(t)] = g(t)
+
−ad∗
ξ(t) µ(t) + dµ
dt
,
,
which we could write, extending our concatenation notation to Lie algebra
actions as well,
d
dt[g(t)µ(t)] = g(t)
+
ξ(t)µ(t) + dµ
dt
,
,
(9.3.5)
where ξ(t) = g(t)−1 ˙g(t). For right actions, these become
d
dt[η(t)g(t)] =
+
η(t)ζ(t) + dη
dt
,
g(t)
(9.3.6)
and
d
dt[µ(t)g(t)] =
+
µ(t)ζ(t) + dµ
dt
,
g(t),
(9.3.7)
where ζ(t) = ˙g(t)g(t)−1,
η(t)g(t) = Adg(t)−1 η(t),
and
η(t)ζ(t) = −[ζ(t), η(t)],
and where
µ(t)g(t) = Ad∗
g(t) µ(t)
and
µ(t)ζ(t) = ad∗
ζ(t) µ(t).

9.3 Actions of Lie Groups
319
Connectivity of Some Classical Groups.
First we state two facts
about homogeneous spaces:
1. If H is a closed normal subgroup of the Lie group G (that is, if
h ∈H and g ∈G, then ghg−1 ∈H), then the quotient G/H is
a Lie group and the natural projection π : G →G/H is a smooth
group homomorphism. (This follows from Proposition 9.3.2; see also
Theorem 2.9.6 in Varadarajan [1974, p. 80].) Moreover, if H and
G/H are connected, then G is connected. Similarly, if H and G/H
are simply connected, then G is simply connected.
2. Let G, M be ﬁnite-dimensional and second countable and let Φ :
G×M →M be a transitive action of G on M, and for x ∈M, let Gx
be the isotropy subgroup of x. Then the map gGx →Φg(x) is a dif-
feomorphism of G/Gx onto M. (This follows from Proposition 9.3.2;
see also Theorem 2.9.4 in Varadarajan [1974, p. 77].)
The action
Φ : GL(n, R) × Rn →Rn,
Φ(A, x) = Ax,
restricted to O(n)×Sn−1 induces a transitive action. The isotropy subgroup
of O(n) at en ∈Sn−1 is O(n −1). Clearly, O(n −1) is a closed subgroup
of O(n) by embedding any A ∈O(n −1) as
˜A =

A
0
0
1

∈O(n),
and the elements of O(n−1) leave en ﬁxed. On the other hand, if A ∈O(n)
and Aen = en, then A ∈O(n −1). It follows from fact 2 above that the
map
O(n)/ O(n −1) →Sn−1,
A · O(n −1) →Aen,
is a diﬀeomorphism. By a similar argument, there is a diﬀeomorphism
Sn−1 ∼= SO(n)/ SO(n −1).
The natural action of GL(n, C) on Cn similarly induces a diﬀeomorphism
of S2n−1 ⊂R2n with the homogeneous space U(n)/ U(n−1). Moreover, we
get S2n−1 ∼= SU(n)/ SU(n −1). In particular, since SU(1) consists only of
the 1 × 1 identity matrix, S3 is diﬀeomorphic with SU(2), a fact already
proved at the end of §9.2.
Proposition 9.3.9.
Each of the Lie groups SO(n), SU(n), and U(n) is
connected for n ≥1, and O(n) has two components. The group SU(n) is
simply connected.

320
9. An Introduction to Lie Groups
Proof.
The groups SO(1) and SU(1) are connected, since both consist
only of the 1 × 1 identity matrix, and U(1) is connected, since
U(1) = { z ∈C | |z| = 1 } = S1.
That SO(n), SU(n), and U(n) are connected for all n now follows from
fact 1 above, using induction on n and the representation of the spheres as
homogeneous spaces. Since every matrix A in O(n) has determinant ±1,
the orthogonal group can be written as the union of two nonempty disjoint
connected open subsets as follows:
O(n) = SO(n) ∪A · SO(n),
where A = diag(−1, 1, 1, . . . , 1). Thus, O(n) has two components.
■
Here is a general strategy for proving the connectivity of the classical
groups; see, for example Knapp [1996, p 72]. This works, in particular,
for Sp(2n, R) (and the groups Sp(2n, C), SP∗(2n) discussed in the Internet
supplement). Let G be a subgroup of GL(n, R) (resp. GL(n, C)) deﬁned
as the zero set of a collection of real-valued polynomials in the (real and
imaginary parts) of the matrix entries. Assume also that G is closed under
taking adjoints (see Exercise 9.2-2 for the case of Sp(2n, R)). Let K =
G ∩O(n) (resp. U(n)) and let p be the set of Hermitian matrices in g. The
polar decomposition says that
(k, ξ) ∈K × p →k exp(ξ) ∈G
is a homeomorphism. It follows that since ξ lies in a connected space, G is
connected iﬀK is connected. For Sp(2m, R) our results above show that
U(m) is connected, so Sp(2m, R) is connected.
Examples
(a) Isometry groups.
Let E be a ﬁnite-dimensional vector space with
a bilinear form ⟨, ⟩. Let G be the group of isometries of E, that is, F is
an isomorphism of E onto E and ⟨Fe, Fe′⟩= ⟨e, e′⟩, for all e and e′ ∈E.
Then G is a subgroup and a closed submanifold of GL(E). The Lie algebra
of G is
{ K ∈L(E) | ⟨Ke, e′⟩+ ⟨e, Ke′⟩= 0 for all e, e′ ∈E }.
♦
(b) Lorentz group.
If ⟨, ⟩denotes the Minkowski metric on R4, that is,
⟨x, y⟩=
3

i=1
xiyi −x4y4,

9.3 Actions of Lie Groups
321
then the group of linear isometries is called the Lorentz group L. The
dimension of L is six, and L has four connected components. If
S =

I3
0
0
−1

∈GL(4, R),
then
L = { A ∈GL(4, R) | AT SA = S },
and so the Lie algebra of L is
l = { A ∈L(R4, R4) | SA + AT S = 0 }.
The identity component of L is
{ A ∈L | det A > 0 and A44 > 0 } = L+
↑;
L and L+
↑are not compact.
♦
(c) Galilean group.
Consider the (closed) subgroup G of GL(5, R) that
consists of matrices with the following block structure:
{R, v, a, τ} :=


R
v
a
0
1
τ
0
0
1

,
where R ∈SO(3), v, a ∈R3, and τ ∈R. This group is called the Galilean
group. Its Lie algebra is a subalgebra of L(R5, R5) given by the set of
matrices of the form
{ω, u, α, θ} :=


ˆω
u
α
0
0
θ
0
0
0

,
where ω, u, α ∈R3 and θ ∈R. Obviously the Galilean group acts naturally
on R5; moreover, it acts naturally on R4, embedded as the following G-
invariant subset of R5:

x
t

→


x
t
1

,
where x ∈R3 and t ∈R. Concretely, the action of {R, v, a, τ} on (x, t) is
given by
(x, t) →(Rx + tv + a, t + τ).
Thus, the Galilean group gives a change of frame of reference (not aﬀecting
the “absolute time” variable) by rotations (R), space translations (a), time
translations (τ), and going to a moving frame, or boosts (v).
♦

322
9. An Introduction to Lie Groups
(d) Unitary Group of Hilbert Space.
Another basic example of an
inﬁnite-dimensional group is the unitary group U(H) of a complex Hilbert
space H. If G is a Lie group and ρ : G →U(H) is a group homomorphism,
we call ρ a unitary representation. In other words, ρ is an action of G
on H by unitary maps.
As with the diﬀeomorphism group, questions of smoothness regarding
U(H) need to be dealt with carefully, and in this book we shall give only
a brief indication of what is involved. The reason for care is, for one thing,
that one ultimately is dealing with PDEs rather than ODEs and the hy-
potheses made must be such that PDEs are not excluded. For example,
for a unitary representation one assumes that for each ψ, ϕ ∈H, the map
g →⟨ψ, ρ(g)ϕ⟩of G to C is continuous. In particular, for G = R one has the
notion of a continuous one-parameter group U(t) so that U(0) = identity
and
U(t + s) = U(t) ◦U(s).
Stone’s theorem says that in an appropriate sense we can write U(t) =
etA, where A is an (unbounded) skew-adjoint operator deﬁned on a dense
domain D(A) ⊂H. See, for example, Abraham, Marsden, and Ratiu [1988,
Section 7.4B] for the proof. Conversely each skew-adjoint operator deﬁnes
a one-parameter subgroup. Thus, Stone’s theorem gives precise meaning
to the statement that the Lie algebra u(H) of U(H) consists of the skew-
adjoint operators. The Lie bracket is the commutator, as long as one is
careful with domains.
If ρ is a unitary representation of a ﬁnite-dimensional Lie group G on
H, then ρ(exp(tξ)) is a one-parameter subgroup of U(H), so Stone’s the-
orem guarantees that there is a map ξ →A(ξ) associating a skew-adjoint
operator A(ξ) to each ξ ∈g. Formally, we have
[A(ξ), A(η)] = A[ξ, η].
Results like this are aided by a theorem of Nelson [1959] guaranteeing a
dense subspace DG ⊂H such that
(i) A(ξ) is well-deﬁned on DG,
(ii) A(ξ) maps DG to DG, and
(iii) for ψ ∈DG, [exp tA(ξ)]ψ is C∞in t with derivative at t = 0 given by
A(ξ)ψ.
This space is called an essential G-smooth part of H, and on DG the
above commutator relation and the linearity
A(αξ + βη) = αA(ξ) + βA(η)
become literally true. Moreover, we lose little by using DG, since A(ξ) is
uniquely determined by what it is on DG.

9.3 Actions of Lie Groups
323
We identify U(1) with the unit circle in C, and each such complex number
determines an element of U(H) by multiplication. Thus, we regard U(1) ⊂
U(H). As such, it is a normal subgroup (in fact, elements of U(1) commute
with elements of U(H)), so the quotient is a group, called the projective
unitary group of H. We write it as U(PH) = U(H)/ U(1). We write
elements of U(PH) as [U] regarded as an equivalence class of U ∈U(H).
The group U(PH) acts on projective Hilbert space PH = H/C, as in §5.3,
by [U][ϕ] = [Uϕ].
One-parameter subgroups of U(PH) are of the form [U(t)] for a one-
parameter subgroup U(t) of U(H). This is a particularly simple case of the
general problem considered by Bargmann and Wigner of lifting projective
representations, a topic we return to later. In any case, this means that we
can identify the Lie algebra as u(PH) = u(H)/iR, where we identify the
two skew-adjoint operators A and A + λi, for λ real.
A
projective representation of a group G is a homomorphism τ :
G →U(PH); we require continuity of g ∈G →|⟨ψ, τ(g)ϕ⟩| ∈C, which
is well-deﬁned for [ψ], [ϕ] ∈PH. There is an analogue of Nelson’s theorem
that guarantees an essential G-smooth part PDG of PH with properties
like those of DG.
♦
Miscellany.
We conclude this section with a variety of remarks.
1. Coadjoint Isotropy.
The ﬁrst remark concerns coadjoint orbit isotro-
py groups. The main result here is the following theorem, due to Duﬂo and
Vergne [1969]. We give a proof following Rais [1972] in the Internet sup-
plement.
Theorem 9.3.10 (Duﬂo and Vergne).
Letg be a ﬁnite-dimensional Lie
algebra with dual g∗and let r = min { dim gµ | µ ∈g∗}. The set { µ ∈g∗|
dim gµ = r } is open and dense in g∗. If dim gµ = r, then gµ is Abelian.
A simple example is the rotation group SO(3) in which the coadjoint
isotropy at each nonzero point is the Abelian group S1, whereas at the
origin it is the nonabelian group SO(3).
2. More on Inﬁnite-Dimensional Groups.
We can use a slight rein-
terpretation of the formulae in this section to calculate the Lie algebra
structure of some inﬁnite-dimensional groups. Here we will treat this topic
only formally, that is, we assume that the spaces involved are manifolds and
do not specify the function-space topologies. For the formal calculations,
these structures are not needed, but the reader should be aware that there
is a mathematical gap here. (See Ebin and Marsden [1970] and Adams,
Ratiu, and Schmid [1986a, 1986b] for more information.)
Given a manifold M, let Diﬀ(M) denote the group of all diﬀeomorphisms
of M. The group operation is composition. The Lie algebra of Diﬀ(M), as
a vector space, consists of vector ﬁelds on M; indeed, the ﬂow of a vector

324
9. An Introduction to Lie Groups
ﬁeld is a curve in Diﬀ(M), and its tangent vector at t = 0 is the given
vector ﬁeld.
To determine the Lie algebra bracket, we consider the action of an arbi-
trary Lie group G on M. Such an action of G on M may be regarded as
a homomorphism Φ : G →Diﬀ(M). By Proposition 9.1.5, its derivative at
the identity TeΦ should be a Lie algebra homomorphism. From the deﬁni-
tion of inﬁnitesimal generator, we see that TeΦ·ξ = ξM. Thus, Proposition
9.1.5 suggests that
[ξM, ηM]Lie bracket = [ξ, η]M.
However, by Proposition 9.3.6, [ξ, η]M = −[ξM, ηM]. Thus,
[ξM, ηM]Lie bracket = −[ξM, ηM].
This suggests that the Lie algebra bracket on X(M) is minus the Jacobi–Lie
bracket.
Another way to arrive at the same conclusion is to use the method of
computing brackets in the table in §9.1. To do this, we ﬁrst compute, ac-
cording to step 1, the inner automorphism to be
Iη(ϕ) = η ◦ϕ ◦η−1.
By step 2, we diﬀerentiate with respect to ϕ to compute the Ad map.
Letting X be the time derivative at t = 0 of a curve ϕt in Diﬀ(M) with
ϕ0 = Identity, we have
Adη(X) = (TeIη)(X) = TeIη
 d
dt

t=0
ϕt

= d
dt

t=0
Iη(ϕt)
= d
dt

t=0
(η ◦ϕt ◦η−1) = Tη ◦X ◦η−1 = η∗X.
Hence Adη(X) = η∗X. Thus, the adjoint action of Diﬀ(M) on its Lie
algebra is just the push-forward operation on vector ﬁelds. Finally, as in
step 3, we compute the bracket by diﬀerentiating Adη(X) with respect to
η. But by the Lie derivative characterization of brackets and the fact that
push-forward is the inverse of pull-back, we arrive at the same conclusion.
In summary, either method suggests that
The Lie algebra bracket on Diﬀ(M) is minus the Jacobi–Lie
bracket of vector ﬁelds.
One can also say that the Jacobi–Lie bracket gives the right (as opposed
to left) Lie algebra structure on Diﬀ(M).
If one restricts to the group of volume-preserving (or symplectic) diﬀeo-
morphisms, then the Lie bracket is again minus the Jacobi–Lie bracket on
the space of divergence-free (or locally Hamiltonian) vector ﬁelds.

9.3 Actions of Lie Groups
325
Here are three examples of actions of Diﬀ(M). Firstly, Diﬀ(M) acts on M
by evaluation: The action Φ : Diﬀ(M)×M →M is given by Φ(ϕ, x) = ϕ(x).
Secondly, the calculations we did for Adη show that the adjoint action of
Diﬀ(M) on its Lie algebra is given by push-forward. Thirdly, if we identify
the dual space X(M)∗with one-form densities by means of integration, then
the change-of-variables formula shows that the coadjoint action is given by
push-forward of one-form densities.
3. Equivariant Darboux Theorem.
In Chapter 5 we studied the Dar-
boux theorem. It is natural to ask the sense in which this theorem holds in
the presence of a group action. That is, suppose that one has a Lie group
G (say compact) acting symplectically on a symplectic manifold (P, Ω)
and that, for example, the group action leaves a point x0 ∈P ﬁxed (one
can consider the more general case of an invariant manifold). We ask to
what extent one can put the symplectic form into a canonical form in an
equivariant way?
This question is best broken up into two parts. The ﬁrst is whether or not
one can ﬁnd a local equivariant representation in which the symplectic form
is constant. This is true and can be proved by establishing an equivariant
diﬀeomorphism between the manifold and its tangent space at x0 carrying
the constant symplectic form, which is just Ωevaluated at Tx0P. This
is done by checking that Moser’s proof given in Chapter 5 can be made
equivariant at each stage (see Exercise 9.3-5).
A more subtle question is that of putting the symplectic form into a
canonical form equivariantly. For this, one needs ﬁrst to understand the
equivariant classiﬁcation of normal forms for symplectic structures. This
was done in Dellnitz and Melbourne [1993]. For the related question of
classifying equivariant normal forms for linear Hamiltonian systems, see
Williamson [1936], Melbourne and Dellnitz [1993], and H¨ormander [1995].
Exercises
⋄9.3-1.
Let a Lie group G act linearly on a vector space V . Deﬁne a group
structure on G × V by
(g1, v1) · (g2, v2) = (g1g2, g1v2 + v1).
Show that this makes G × V into a Lie group—it is called the semidirect
product and is denoted by G ⓈV . Determine its Lie algebra g ⓈV .
⋄9.3-2.
(a) Show that the Euclidean group E(3) can be written as O(3) ⓈR3 in
the sense of the preceding exercise.

326
9. An Introduction to Lie Groups
(b) Show that E(3) is isomorphic to the group of 4 × 4 matrices of the
form

A
b
0
1

,
where A ∈O(3) and b ∈R3.
⋄9.3-3.
Show that the Galilean group may be written as a semidirect prod-
uct G = (SO(3) ⓈR3) ⓈR4. Compute explicitly the inverse of a group
element, and the adjoint and the coadjoint actions.
⋄9.3-4.
If G is a Lie group, show that TG is isomorphic (as a Lie group)
with G Ⓢg (see Exercise 9.1-2).
⋄9.3-5.
In the relative Darboux theorem of Exercise 5.1-5, assume that a
compact Lie group G acts on P, that S is a G-invariant submanifold, and
that both Ω0 and Ω1 are G-invariant. Conclude that the diﬀeomorphism
ϕ : U −→ϕ(U) can be chosen to commute with the G-action and that V ,
ϕ(U) can be chosen to be a G-invariant.
⋄9.3-6.
Verify, using standard vector notation, the four “derivative of
curves” formulas for SO(3).
⋄9.3-7.
Use the complex polar decomposition theorem (Theorem 9.2.15)
and simple connectedness of SU(n) to show that SL(n, C) is also simply
connected.
⋄9.3-8.
Show that SL(2, C) is the simply connected covering group of the
identity component L†
↑of the Lorentz group.

