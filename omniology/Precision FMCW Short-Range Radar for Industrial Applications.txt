
Precision FMCW
Short-Range Radar for 
Industrial Applications


Precision FMCW
Short-Range Radar for 
Industrial Applications
Boris A. Atayants
Viacheslav M. Davydochkin
Victor V. Ezerskiy
Valery S. Parshin
Sergey M. Smolskiy
artechhouse.com

Library of Congress Cataloging-in-Publication Data
A catalog record for this book is available from the U.S. Library of Congress.
British Library Cataloguing in Publication Data
A catalog record for this book is available from the British Library.
ISBN 13: 978-1-60807-738-0
Manuscript created under the supervision of Dr.Sci. Professor Victor V. Ezerskiy and Dr.Sci. 
Professor Sergey M. Smolskiy
English translation by Sergey M. Smolskiy
© 2014 Artech House
685 Canton Street
Norwood, MA 02062
All rights reserved. Printed and bound in the United States of America. No part of this book 
may be reproduced or utilized in any form or by any means, electronic or mechanical, including 
­photocopying, recording, or by any information storage and retrieval system, without permission 
in writing from the publisher.
All terms mentioned in this book that are known to be trademarks or service marks have been 
appropriately capitalized. Artech House cannot attest to the accuracy of this information. Use of 
a term in this book should not be regarded as affecting the validity of any trademark or service 
mark.
10 9 8 7 6 5 4 3 2 1

To Ryazan State Radio Engineering University, which recently celebrated its  
60th anniversary, and JSC Contact-1, which recently celebrated its 20th anniversary 


vii
Contents
Preface
xv
Introduction
xvii
 chapter 1 
Counting Method of Estimation of Difference Frequency
1
1.1  Introduction
1
1.2  Main Calculation Relations
1
1.3  The Traditional Counting Method of Range Measurement
5
1.4  Sources of Range Measurement Errors by the FMCW Range-Finder
7
1.5  Adaptive Control of Frequency Modulation Parameters
8
1.6  Truncation Error of Range Measurement at Adaptive  
Frequency Modulation
13
1.6.1  The Fixed Measuring Time Interval
13
1.6.2  The Measuring Time Interval Multiple to the Modulation  
Half-Period
16
1.6.3  Calculation of the Range Result Correction
20
1.7  The Range Determination Error Caused by the Inaccuracy of 
Modulation Adaptation
23
1.8  Noise Influence on the Accuracy of the Range Determination Using the  
Additive Counting Method
25
1.9  Conclusions
31
References
31
 chapter 2 
Weighting Method for the Difference Frequency Averaging
33
2.1  Introduction 
33
2.2  The Truncation Error of the Weighting Method of Difference  
Frequency Averaging
36
2.3  Truncation Error Minimization at the Weighting Average  
Method of Difference Frequency by Optimization of  
Weighting Function Parameters
45
2.4  Truncation Error Minimization of the Weighting Averaging  
Method of the Difference Frequency by  
Optimization of the FM Parameters
50
2.4.1  Application of Additional Slow-Frequency Modulation
50
2.4.2  Optimization of the FM Sweep
53

viii	
Contents
2.4.3  Combined Optimization
55
2.4.4  The Combined Procedure of Error Minimization
56
2.5  Noise Influence on the Error of the Weighting Method of Difference 
Frequency Averaging
56
2.5.1  The Measurement Error for the Weighting Function in the 
Form of the Trigonometric Series
58
2.5.2  The Measurement Error for the Kaiser-Bessel  
Weighting Function
62
2.6  Conclusions
64
References
64
 chapter 3 
Estimation of the Difference Frequency by the Position of the 
Spectrum Maximum
67
3.1  Introduction
67
3.2  Algorithms of Difference Frequency Estimation
68
3.3  Estimation of the Difference Frequency on the Basis of the Maximum 
Position of the Spectral Density of Difference Frequency Signal
71
3.3.1  Analytical Estimation of the Truncation Error of 
Range Measurement
71
3.3.2  The Truncation Error of the Difference Frequency Estimation 
at the Weighting Functions of Dolph-Chebyshev and Kaiser-Bessel74
3.3.3  Minimization of the Measurement Error on the Basis of the FM 
Parameter Optimization
77
3.3.4  Error Minimization on the Basis of Optimization of Weighting 
Function Parameters
80
3.3.5  Minimization of the Truncation Error Using Adaptable 
Weighting Functions
86
3.3.6  Algorithms of Frequency Estimation Using Adaptable 
Weighting Functions
86
3.4  Average Weighted Estimation of the Difference Frequency
88
3.4.1  The Truncation Error of the Average Weighted Estimation
88
3.5  Systematic Inaccuracy of Frequency Estimation for the Algorithm with 
Correction Coefficients
91
3.6  Influence of Noise Interference on the Error of  
Range Measurement
92
3.6.1  Statistical Characteristics of Estimation of the Spectral Density 
of DFS and Noise Sum
92
3.6.2  Influence of Noise on Accuracy of the Central  
Frequency Estimation
94
3.7  Conclusions
103
References
104

Contents	
ix
 chapter 4 
The Maximal Likelihood Method for Range Estimation According to the 
Difference Frequency Signal
107
4.1  Introduction
107
4.2  Range Estimation Based on the Difference Frequency Signal
108
4.3  Peculiarities of Delay Time Estimation Using the Maximal 
Likelihood Method
113
4.4  Main Factors Affecting the Measurement Error of Time Delay
116
4.5  Estimation of the Phase Characteristic of FMCW RF
121
4.6  Simulation of the Range Estimation Algorithm
130
4.6.1  Simulation Results at a Known Phase Characteristic 
131
4.6.2  Simulation Results at the Unknown Phase Characteristic: 
The Approach to Practical Estimation of the  
Phase Characteristic
131
4.6.3  Reduction of the Noise Influence on the Accuracy of the 
Phase Characteristic Estimation
134
4.7  Conclusions 
135
References
136
 chapter 5 
Effects of FM Nonlinearity
137
5.1  Introduction
137
5.2  The Mathematical Model of the Modulation Characteristic 
137
5.3  Effects of FM Nonlinearity for the Counting Method of 
Frequency Measurement
141
5.3.1  The Quadratic Modulation Characteristic
142
5.3.2  The Oscillating Modulation Characteristic
144
5.3.3  The Quadratic Modulation Characteristics with the 
Oscillating Component 
147
5.4  Effects of FM Nonlinearity for the Weighting Method of Difference 
Frequency Averaging
147
5.5  Connection of the Correction Coefficient with Nonlinearity 
Parameters of the MC
151
5.5.1  Quadratic Nonlinearity of Modulation Characteristics
151
5.5.2  Oscillating Nonlinearity of the Modulation Characteristic
151
5.5.3  Quadratic and Oscillating Nonlinearity of the 
Modulation Characteristic
152
5.6  Estimation of the Correction Coefficient According to the Operating  
Difference-Frequency Signal 
153
5.6.1  The Algorithm Sequence
153
5.6.2  Simulation Conditions
154
5.7  Compensation of Modulation Characteristic Nonlinearity
155

x	
Contents
5.8  Consideration of Modulation Characteristic Nonlinearity at  
Range Calculation
160
5.8.1  Estimation of Extreme Period Parts
161
5.8.2  Approximation of the Time Function of Signal Periods 
162
5.9  Conclusions
164
References
165
 chapter 6 
Analysis of the Range Measurement Error at the Interference Presence 
167
6.1  Introduction 
167
6.2  The Error Caused by the Single Spurious Signal of the  
Difference Frequency
170
6.2.1  Error Estimation According to DFS Spectrum  
Maximum Position
170
6.2.2  Error Estimation at Signal Processing in the  
Time Domain
172
6.3  The Error Caused by the Influence of Spurious Reflectors in the 
Antenna-Waveguide Path and in the Operating Zone  
of the FMCW Range-Finder
174
6.3.1  Influence of the Frequency-Independent Spurious Reflectors in 
the AWP and in the Operating Zone of the FMCW RF
174
6.3.2  Influence of the Spurious Reflection of the Pulse Character
177
6.4  The Error Caused by the Signal Reflection from the Corner Formed 
by the Reservoir Vertical Wall and the Liquid Surface
181
6.5  Influence of the Edge Modes Caused by the Restricted Sizes of the 
Probing Object 
184
6.6  Influence of Reflected Waves on the Measurement Error of the  
FM Range-Finder 
187
6.6.1  Influence of Echo Signals on the Operating Mode of the 
SHF Oscillator
187
6.6.2  Influence of the Wave Reflected from the Useful Reflector 
on the Range Measurement Error 
188
6.6.3  Simultaneous Influence of Waves Reflected from the Useful 
and Spurious Reflectors on the Range Measurement Error 
190
6.7  Influence of Combination Components in the Mixer of the FMCW RF 
on the Measurement Error 
192
6.7.1  Virtual Reflectors 
192
6.7.2  Influence of Virtual Clutter on the Range Estimation Error
193
6.8  Conclusions
194
References
195
 chapter 7 
Reduction of the Measurement Error at Interference Presence Using  
Adaptable Weighting Functions
197
7.1  Introduction
197
7.2  Estimation of the Interference Situation 
198

Contents	
xi
7.3  Error Minimization of Frequency and Amplitude Estimation of the 
Weak Signal on the Background of Resolvable Single Interference
204
7.3.1  Introduction 
204
7.3.2  Minimization of the Range Measurement Error for Weakly 
Reflecting Liquids 
204
7.3.3  Action Sequence at the Level Measurement of the Weakly 
Reflecting Material Near an Antenna
206
7.3.4  Range Measurement on the Background of Strong Reflection 
from the Reservoir Bottom 
210
7.4  Error Reduction of Difference Frequency Estimation of the Signal 
Received on the Background of Nonresolvable Interference
210
7.4.1  The Situations Most Often Met in Practice 
210
7.4.2  The Method of Error Decrease
211
7.4.3  The Algorithm of Estimation Error Reduction: The Sequence 
of Actions to Decrease the Range Estimation Errors
216
7.5  Error Decrease Caused by the Virtual Reflector 
217
7.5.1  Action Sequence for the Influence Reduction of the  
Virtual Reflector
218
7.5.2  Measures Providing a Decrease of the Error Caused by an 
Echo Signal
220
7.6  Conclusions
221
References
222
 chapter 8 
Parametrical Methods and Algorithms for Increasing the  
Measurement Accuracy at the Interference Presence 
223
8.1  Introduction 
223
8.2  Cancellation of Spurious Reflections 
223
8.2.1  Using the Complex Spectral Density for Cancellation
226
8.2.2  Using Spectral Power Density for Cancellation
228
8.3  Reduction of Spurious Reflector Influence on the Accuracy of the 
Range Estimation by the Maximal Likelihood Method 
232
8.3.1  The Tracking Range Measuring System 
232
8.3.2  Main Stages of the Tracking Procedure After the  
Local Extreme
236
8.3.3  Tracking Modes
237
8.3.4  Influence of the Phase Characteristic Estimation Error on the 
Operation of the Tracking Measurer 
239
8.3.5  Determination of the Conditions at which the Tracking  
Loss Occurs
240
8.3.6  Range Measurement at the Presence of the Spurious Reflectors 
of Small Intensity
242
8.4  Frequency Measurement Using Methods of the Parametric  
Spectral Analysis 
244
8.4.1  The Algorithm of the Frequency Measurement on the Basis 
of Eigenvector Analysis in the Noise Subspace 
244

xii	
Contents
8.4.2  The Frequency Measurement Algorithm by the Prony Method 
of Least Squares 
247
8.5  Range Prediction on the Basis of Consideration of the Movement Speed
250
8.5.1  Uniform Velocity of the Useful Reflector Movement 
250
8.5.2  The Nonuniform Velocity of the Useful Reflector Movement
253
8.6  Conclusions
255
References
256
 chapter 9 
Testing of Precision Measuring Systems of FM Short-Range Radar and  
Areas of Its Practical Application
257
9.1  Introduction
257
9.2  Equipment and Approach for the Experimental Estimation  
of the FM RF Characteristics
257
9.2.1  Synthesis of Radar Reflectors for Precision Measurements
259
9.2.2  The Test Bench for the Measurement of the FM RF Parameters  264
9.2.3  The Procedure of Carrying Out Measurements 
266
9.3  Experimental Reduction of the Error Caused by Virtual Interference
266
9.3.1  The Waveguide-Measuring Test Bench
266
9.3.2  Experimental Research of the Possibility of Reducing 
Virtual Interference Influence 
267
9.3.3  Influence of Radiated Power Level on the Distance Estimation 
Error Caused by Virtual Interference Influence 
269
9.4  Results of the Experimental Reduction of the Distance Measurement 
Error by the Control of the Adaptable Weighted  
Function Parameters 
269
9.5  Testing Results of the Parametric Algorithms of the Distance 
Measurement in the Measuring Test Bench
272
9.5.1  Algorithms Based on the Methods of Parametric  
Spectral Analysis
272
9.5.2  The Algorithm Based on the Maximal Likelihood Method
274
9.5.3  Testing of the Tracking Distance Meter
275
9.5.4  Testing Results of the Algorithm “Prediction”
275
9.6  Areas of Practical Application of the FMCW Radar 
277
9.6.1  Radio Altimeters for Small and Medium Attitudes
278
9.6.2  Radio Proximity Fuses
279
9.6.3  Navigation Radar
279
9.6.4  Transport Radar
280
9.6.5  Level-Meters
281
9.6.6  Ice and Snow Blanket Thickness Meters
281
9.6.7  FM Geo-Radar
282
9.6.8  Atmosphere Sensing Radar 
283
9.6.9  Range Finders for Geodesic Research
283
9.6.10  Birds’ Observation Radar 
283
9.6.11  Small Displacement Meters 
284

Contents	
xiii
9.6.12  Guarding Systems
284
9.6.13  Robotic Navigation and Mapping Systems
285
9.7 Conclusions
286
References
286
Conclusion 
289
Appendix: Weighting Functions for Harmonic Analysis and  
Adjacent Problems
291
List of Acronyms
315
About the Authors
317
Index
321


xv
Preface
The idea for this book came about as the result of years of experience in the 
investigation, development, and production of one class of radar systems: radar 
level-meters. Our research began at the Ryazan plant TEPLOPRIBOR (located 
in the center of Russia) in cooperation with the scientists of the Ryazan Radio 
Engineering Institute and the Institute of Telemechanics and Automatics of Soviet 
Academy of Sciences during the 1970s and 1980s. The following contributors 
have participated in this development: B. V. Lunkin, A. S. Sovlukov, A. I. Kiyashev, 
A. G. Miasnikov, F. Z. Rosenfeld, B. V. Kagalenko, B. A. Atayants, V. M. Izrailson, 
M. P. Marfin, and many others. During the past fifteen years, this research has 
been continued by the authors at the company JSC Contact-1 in the development, 
modernization, and serial production of the level-meter’s family of BARS-3XX. 
In this engineering field, intensive investigations have been carried out in different 
countries around the world into creating devices that permit continuous checking 
and measuring of the filling level of various technological reservoirs automatically 
and with high accuracy and reliability. Besides this narrow but useful applica-
tion area of radar technology, there are a whole series of industrial applications 
of short-range systems with similar requirements in terms of their functionality 
and cost-effectiveness. All these applications can be successfully implemented us-
ing frequency-modulated continuous wave (FMCW) radar. In our opinion, a new 
direction has been taken in traditional short-range radar technology for different 
applications (including military): precision FMCW radar technology that is ori-
ented to the development, creation, and production of this new class of promising, 
short-range systems.
Many worldwide manufacturers of these devices have achieved rather highly 
desirable results. However, market pressures including speed to market rarely allow 
developers to disclose in detail the operation principles of new devices and algo-
rithms of signal processing with high accuracy and operation reliability. Therefore, 
we should note that in many cases classical methods of radio signal generation and 
processing are built into the operation of these devices, but with some modifications 
characterizing the peculiarities of these applications. Of course, the application of 
new approaches to radio signal generation and processing for short-range measur-
ing radar systems brings forth new results, which is why we decided to present our 
own theoretical and practical results along with the information available in patent 
and engineering publications with the hope that this book will help further innova-
tion in the field of short-range precision radar technology.
We sincerely appreciate the team at JSC Contact-1 for their understanding, 
help, perpetual supply of new problems to tackle and the subsequent practical, 
interesting ­discussions of the results and their applications in new developments. 

xvi	
Preface
It is impossible to mention all our colleagues promoting our research, but we espe-
cially note I. V. Baranov, V. A. Bolonin, V. S. Gusev, S. V. Miroshin, D. Y. Nagorny, 
and V. A. Pronin, whose contributions were most significant. 
Discussions of some of our dissertations from seminars at the Radio Control 
and Communication Department at the Ryazan State Radio Engineering University, 
which form the basis of this book, were promoted to improve the presentation of 
materials and results. Significant contributions to these discussions were made by 
Professor S. N. Kirillov, the head of Radio Engineering Radio Control and Com-
munication Department, Professor V. I. Koshelev, the head of Radio Engineering 
Systems Department, and Professor Y. N. Parshin, the head of Radio Engineering 
Devices Department. 
We express much gratitude to the head of Radio Engineering Systems of 
­National Research University, Moscow Power Engineering Institute, Professor A. I. 
Perov, for the time-consuming work of reviewing as well as for providing useful 
feedback and advice. 
We especially appreciate recommendations and very valuable comments made 
by the anonymous reviewer at Artech House Publishers for his attention and 
desire to improve our material.
B. Atayants, V. Davydochkin, V. Ezerskiy, and V. Parshin express their admira­
tion, sincere respect, and gratitude to their colleague S. M. Smolskiy, who worked 
on the translation of the text into English.
We are also grateful to all interested readers for remarks and suggestions 
­regarding this book’s contents; comments can be sent to Artech House Publishers 
or to the Russian company CONTACT-1 (e-mail: market@kontakt-1.ru). 

xvii
Introduction
The frequency range-finder (FRF) using a continuous wave transmitted signal with 
frequency modulation (FM) (these systems are called FMCW short-range radar) 
has, for many years, been successfully applied as the altimeter for small attitudes 
in military and civil airplanes and as the navigation radar in the navy for survey 
of port water areas, for watercraft arrival to the port under conditions of bad 
visuibility, and for a craft’s docking to an enbankment wall. Radio proximity fuses 
(the last mile radar) are typical directions of the FRF application. The intensive 
development of various branches of industry in the beginning and wide distribu-
tions of automatic control systems for industrial and revolutionary processes in 
the elements’ base led to a wide application of short-range radar devices in the 
industry at the end of the 1960s [1–3]. We can attribute to them the devices for 
precision measurement of very small ranges (from parts of a meter to several tens 
of meters): 
Various measuring systems of the filling level of technological reservoirs 
• 
(level meters);
Systems for the precision positioning of complicated technological equip-
• 
ment (precision machines up to portal cranes);
Measuring systems for small displacements and vibrations of particles of 
• 
­different machines and mechanisms;
Range-finders for geodesic measurements;
• 
Ice thickness measuring systems;
• 
Systems for range and velocity determination to warn of collisions and for 
• 
anti-accident parking;
Radar for atmosphere sensing;
• 
Radar for bird observations;
• 
Various guarding systems.
• 
Despite such wide application areas, all these devices can be unified by a general 
approach to methods of required characteristics achievement and typical features. 
Fundamentals for the technically competent development of such systems were es-
tablished in previous decades within the development of various military applica-
tions [3–13]. Therefore, in many cases one must provide continuous noncontact 
process tracking (tracking for trajectory, range, and often velocity of its variations). 
A part of these tasks can be successfully solved by radio wave methods [1]. How-
ever, the entire spectrum of practical applications can be realized only by radar 
technology systems. In most cases, the frequency-modulated (FM) range-finder that 
uses the continuous wave (CW) transmitted signal with FM can successfully solve 
these tasks. We will be oriented in this direction and will only consider such FMCW 
radar devices.

xviii	
Introduction
The Swedish company SAAB and the Dutch company Enraf-Nonius [2, 14, 
15] were pioneers in industrial application of FMCW radars, which used them for 
measurement of the filling level of different technological reservoirs. In 1975, SAAB 
placed in operation its first level meter. Up to the mid-1990s, this company pro-
duced more than 15,000 level meters. In 1976, the German company Krohne [15] 
created its first level meter. In the same year in Russia, the Ryazan plant Teplopribor 
developed level meters for tankers. The first level meters did not have high accuracy 
of measurements; their errors were units and even tens of centimeters. Only in the 
early 1990s was the measurement accuracy of 1 cm achieved [2]. The Russian level 
meter LUCH-2, which was developed and prepared for mass production with the 
participation of Dr. B. A. Atayants at Teplopribor, had an accuracy of 2 cm. How-
ever, the accuracy of 1 to 2 cm is not enough in many cases to solve the problems 
of industry. To increase the measurement accuracy, the much higher level of SHF 
engineering development and application of modern equipment and methods of 
digital signal processing were necessary. Increasing the accuracy from 1 cm to 1 mm 
took almost 10 more years. 
Industry requirements in measuring short-range radar are vast. The large in-
dustrial and economic effects occur not only because of the exclusion of the usual 
manual methods of measurements and data processing, but also owing to high reli-
ability, accuracy, operating speed, and simplicity of implementation of such range-
finders into automated control systems for production. 
It should be noted that the wide application of the FMCW radar for purely civil 
purposes, which does not relate to military applications, leads to the necessity of 
renaming the most popular terms. So, in the traditional radar technology, the object 
of radar observation is usually referred to as a target. In our case we call this object 
the useful reflector (UR), emphasizing that there are other spurious reflectors (SRs), 
which cause trouble for measuring problems. 
At present, the development of devices offered by various companies mainly 
finds its voice in the patent publications and scientific and engineering literature. We 
note the most interesting publications [14–52]. Among the published results, the 
most important ones determining the main stages of FMCW range-finder develop-
ment for industrial application are [14, 17, 18, 23] based on the weighting method 
of estimation of the difference frequency (DF); investigations [16, 19] offering the 
additional slow phase modulation of the FM signal; publications [17, 21, 22, 25, 
28, 40] using the delay line as the reference (standard) channel; research [15, 37, 
43, 49] using the calibration mode of operation for measurement and of nonlinear-
ity compensation of the modulation characteristics (MC) of the transmitter on the 
basis of the stepped frequency modulation of the CW signal [the accepted abbrevia-
tion of this mode is frequency stepped continuous wave (FSCW)]; the suggestions of 
[48, 49] using the digital synthesis of the transmitter frequency in the FSCW mode; 
and publications [33, 35, 43–46] studying features of functioning of the FMCW 
radar under the conditions of the SR presence on the basis of different variations 
of the maximal likelihood method (MLM) or methods of high resolution (for ex-
ample, the MUSIC method [43]). 
Books on FMCW radar theory were published in the 1960s and 1970s that 
mainly dealt with military systems. Besides the publications mentioned above, we 
include [50, 51]. The most important and well known is the book by A. S. Vinitsky [3]. 

Introduction	
xix
However, unfortunately, in spite of the definite achievements, in these books the mod-
ern methods of signal generation and processing taking into consideration the revolu-
tionary changes in the element base for the past several decades are not described. At 
the end of the 1980s, [52] was published. The theoretical fundamentals and structure 
principles of radio engineering short-range systems for detection and measurement 
are considered in this book on a serious level as well as the realized features of sys-
tems intended for measurement of transport vehicles’ movement parameters and for 
guarding radio engineering systems. We also note the research in [53, 54]. 
We also found research dedicated to FMCW radar systems, a Russian school-
book for technical universities [55], in which the fundamentals of FMCW are de-
scribed on a modern level, but very laconically. In the last serious investigation, we 
consider [56], a book published by Artech House Publishers and then translated 
into Russian. The theoretical fundamentals of received signal processing and trans-
mitters on the basis of the autodyne operation principle (the autodyne is also called 
a self-oscillating mixer (SOM)] are described in conformity with short-range radar 
measuring systems for small ranges. The review of several aspects of the current 
status of the small range’s precision measurement problems in the industry is con-
tained in [57, 58]. 
Taking into consideration the above-mentioned sources, it is clear that there is 
a need to understand the latest achievements and to pull together the volumes of 
uncoordinated information available in worldwide publications and obtained by 
different authors during practical work on these new devices. 
The specific characters of FMCW radar in industrial systems for small-range 
measurement consist of the following:
A range of measured ranges are from parts of a meter to 30–50 meters for 
• 
the required measurement accuracy up to 1 mm and even up to parts of a 
millimeter.  
In many cases, measurements are performed in complicated interference situ-
• 
ations, often in closed volumes in the presence of spurious reflectors (SRs) of 
various types. A great number of rereflections from these elements is observed. 
If the material under inspection does not have a large value of dielectric con-
stant and weakly absorbs the radio signal at level measurement, the reflection 
from the reservoir’s bottom is also observed. However, all SRs (their param-
eters) in the RF operating zone can be revealed and estimated in advance. 
The radio signal reception is provided on the background of noises arising in 
• 
the first stages of SHF units and due to transmitter phase noises. 
Nonlinearity of the transmitter MC has a strong effect on the measurement 
• 
­result. 
Measurements should be provided under the conditions of a great parameter 
• 
variation of environment (temperature, moisture, pressure) and for varia-
tions of environment parameters in the operating zone, under conditions 
of the typical increased dust level of radio wave propagation mediums, the 
presence of steam, and the moisture condensate and dust sediment on the 
antenna. 
A limited volume of samples of the difference frequency signal (DFS) is 
• 
available for processing. Therefore, for very small measuring ranges, only 

xx	
Introduction
­several periods of the signal (three to four periods and less) can be processed 
for analysis.  
The achievement of high measurement accuracy requires a rather compli-
• 
cated algorithm of signal processing. Nevertheless, a result must be obtained 
in short order of technological process dynamics or information perception 
by a person (i.e., on a real-time scale).
Developing algorithms must be practically realizable on the available ele-
• 
ment base when measuring the economic efficiency condition of a device’s 
application. 
The theoretical analysis of FMCW operation can be traditionally provided on 
the basis of two methods: a spectral method and the simplified method based on 
DFS processing in the time domain [3, 13, 53–57], which more often consists of the 
analysis of positions and a number of points of signal intersection with zero level. 
We will call this method temporal. It exists in the literature in different variants. In 
this book we use both methods of DFS processing, taking into consideration the 
advantages of the modern theory of the digital signal processing (DSP) to reach the 
best results.
It is known that both methods have a permanent error [3, 10, 13] called the 
quantization interval (QI) [51], caused by the periodicity of the frequency modula-
tion law. In many cases this error is inadmissibly large; therefore, one must take 
measures for its decrease. We can achieve this goal by different methods consisting 
of definite additional actions on radiated and received signals [3, 10]. We call these 
the methods of QI smoothing (MQIS). These methods allow the achievement of a 
high accuracy of range measurement; however, each has particular limitations on 
the minimally achieved measurement error, and not all methods permit the possibil-
ity of digital implementation of processing.
The issue of extremely achieved measurement accuracy, which can be obtained 
on the basis of optimal processing methods; in particular, the method of maximal 
likelihood, is very interesting and important. This issue is also considered in this 
book.
The problems of analysis of range measurement errors are caused by interfer-
ence influence in the form of noises, interference created by the SR in the RF oper-
ating zone, by the parasitic amplitude modulation (PAM), and by the nonlinearity 
of transmitter MC. 
In examining all these problems, we take into consideration that much informa-
tion on application areas of the short-range FMCW radar, on construction principles 
of structural schemes, and on the general theory of signal generation and processing 
are already stated in detail in the above-mentioned literature sources. Therefore, we 
do not address these general questions or give the specific information on themes, 
which, in our opinion, are the most significant, key themes at implementation of 
practical measurement systems. 
Chapter 1 is devoted to the research of the classical counting method of differ-
ence frequency estimation. It is shown that this method still does not exhaust all 
possibilities. The adaptive method of the FM parameter control is offered, which al-
lows a QI reduction up to the practically accepted values. Two variants of counting 
method implementation are considered and the algorithm of measurement results 

Introduction	
xxi
correction is proposed allowing a sharp reduction of the error level. The noise influ-
ence is examined on both variants of implementation and advantages of the offered 
variant is proved. 
An investigation of characteristics of the weighting method for difference fre-
quency estimation is described in Chapter 2. The exact expressions for the trun-
cation error of range measurement for two weighting function (WF) families are 
given. The possibility for minimization of the measurement error using the optimi-
zation of WF and FM parameters and appropriate algorithms are developed. The 
noise influence on the offered algorithms is studied. 
The analysis of the spectral method for DFS processing is provided in Chapter 3.  
The approximate analytical expressions are obtained, which allow calculation with 
high accuracy of the truncation error of measurement at estimation of the differ-
ence frequency according to position of spectral density (SD) maximum at arbitrary 
WF. The obtained equations are specified for two promising WFs. The possibility 
of minimizing measurement error using optimization of WF and FM parameters 
is shown and the appropriate algorithms are developed. The measurement error 
minimization algorithms on SD maximum are suggested with the help of AWF and 
it is shown that they have an essential benefit compared with traditional WFs in 
truncation error level and in noise component, which is especially manifested at the 
measurement of small ranges. The possibilities of range determination on the basis 
of weighting average estimation of the difference frequency and using correction 
coefficients are considered. The estimation of noise influence on these algorithms is 
provided and their comparison is performed with the help of numerical modeling. 
Chapter 4 is devoted to the analysis of practical application of MLM for esti-
mation of the measured range. Equations for the limiting measurement accuracy 
are obtained and two-stage estimation procedure is offered, permitting to facilitate 
the search of the global extremum of the signal function. Factors affecting the range 
­error estimation using MLM are analyzed and procedures are developed, which 
­allow for the achievement of the maximal error reduction. 
The influence of MC nonlinearity on the range measurement accuracy using the 
counting method and the method of weight averaging of the difference frequency 
are discussed. The MC mathematical model and approach for determination of its 
parameters according to really measured characteristics are offered. It is shown that 
the high accuracy of approximation can be achieved. The analysis of MC nonlinear-
ity influence on MEDS is provided based on the DFS processing in the time domain. 
Three algorithms for reduction of the error caused by MC nonlinearity are offered. 
This is the correction of the measurement result, compensating nonlinearity at the 
expense of the predistortion introduction into modulating voltage and taking into 
consideration the nonlinearity at the range calculation. All these algorithms assume 
the urgent measurement of nonlinearity parameters according to real operating 
DFS. The quantitative estimation of the benefit providing by each of these algo-
rithms is performed.
Chapter 6 discusses the analysis of the range measurement error caused by the 
interference presence. The interference types and its physical sense are considered. 
For each interference type, the theoretical examination is provided with quantita-
tive estimation of interference level and revelation of the main characteristics effect-
ing on error level. 

xxii	
Introduction
The methods for error reduction caused by the interference presence are ­described 
in Chapter 7, specifically the problem of interference detection and estimation of 
interference situation in the RF operation zone. Methods and algorithms are sug-
gested, which allow for the reduction of a difference frequency estimation using the 
adaptable WF. The possibility decreases the error caused by the virtual reflector. 
Parametric methods and algorithms of range measurement accuracy growth at 
presence of interference are discussed in Chapter 8. The possibilities of MC compen-
sation, MLM modification to provide its operation for SR presence, and methods 
of parametric spectral analysis (PSA) are described. The algorithm of measurement 
error reduction is offered, using the idea of result prediction in those places where 
the error is too large. 
Chapter 9 describes the conditions, equipment, and approach of experimental 
estimation of FMCW characteristics under the conditions of industrial enterprise. 
Constructions of standard reflectors providing achievement of required measure-
ment accuracy are offered. The measuring complex is described, which was certi-
fied as the measuring instrument allowing provision of range measurement error 
estimation with required reliability. The results of experimental research of the 
above-­considered methods and algorithms, part of which is implemented in serially 
produced level meters of the BARS series, are discussed. All experimental results 
coincide well with results obtained theoretically and using the modeling. 
The adaptable WF for the spectrum analysis is considered in the Appendix. 
Requirements for AWF are formulated, analytical expressions are obtained, and 
sets of coefficients for some AWF are given that present the most interest. Spectral 
properties of AWF are considered and optimization methods for its properties are 
offered. 
A brief review of possible practical applications of FMCW radars in industry 
and scientific researches is also provided.
References
[1]	
Victorov, V. A., B. V. Lunkin, and A. S. Sovlukov, Radio Wave Measurements of Techno-
logical Process Parameters, Moscow, Russia: Energoizdat Publ., 1989. [In Russian.]
[2]	
Johanngeorg, O., “Radar Application in Level Measurement, Distance Measurement 
and Nondestructive Material Testing,” Proc. of 27th European Microwave Conference, 
­September 8–12, 1997, pp. 1113–1121.
[3]	
Vinitskiy, A. S., Essay on Radar Fundamentals for Continuous-Wave Radiation, Moscow, 
Russia: Sovetskoe Radio Publ., 1961. [In Russian.]
[4]	
Rytov, S. N., “Modulated Oscillations and Waves,” Trudy FIAN, Vol. II, No. 1, 1940. [In 
Russian.]
[5]	
Gonorovskiy, I. S., Frequency Modulation and Its Application, Moscow, Russia: Sviazizdat 
Publ., 1948. [In Russian.]
[6]	
Luck, D. G., Frequency Modulated Radar, New York: McGraw-Hill, 1949.
[7]	
Kharkevich, A. A., Spectra and Analysis, 4th ed., Moscow, Russia: Fizmatgiz Publ., 1962. 
[In Russian.]
[8]	
Bogomolov, A. F., Radar Fundamentals, Moscow, Russia: Sovetskoe Radio Publ., 1954.
[9]	
Calmus, G., J. Kacheris, and G. Dropkin, “The Frequency-Modulated Altimeter with Non-
Discrete Reading,” Issues of Radar Technology, No. 3, 1954. [In Russian.]

Introduction	
xxiii
[10]	 Abd-El Ismail, M., A Study of the Double Modulated F.M. Radar, Zurich: Verlag Leemann, 
1955. 
[11]	 Astafiev, G. P., V. S. Shebshaevich, and Y. A. Yurkov, Radio Navigation Devices and Sys-
tems, Moscow, Russia: Sovetskoe Radio Publ., 1958. [In Russian.]
[12]	 Skolnik, M., Introduction to Radar Systems, New York: McGraw-Hill, 1962.
[13]	 Kogan, I. M., Short-Range Radar Technology (Theoretical Bases), Moscow, Russia: Sovets-
koe radio Publ., 1973. [In Russian.]
[14]	 Swedish Patent No. 381745, INT.CL. G01S 9/24. “Satt och anerdning for avstandsmatning 
med frekvens-modulerade kontinuerliga mikrovagor,” K. O. Edvardson, No. 7315649-9. 
Filed November 20, 1973; published December 15, 1975.
[15]	 Brumbi, D., “Measuring Process and Storage Tank Level with Radar Technology,” Records 
of the IEEE 1995 Intl. Radar Conference, Alexandria, VA, 1995, pp. 256–260.
[16]	 Schilz, W., R. Jacobson, and B. Schiek, “Mikrowellen Entfernungsmebsystem mit ±2,5 mm 
Genauigkeit,” Mikrowellen Magazine, No. 2, 1976, pp. 102–107.
[17]	 U.S. Patent 4044355, Int. CI. G01S 9/24, “Measurement of contents of tanks etc. with 
microwave radiations,” K. O. Edvardsson. Filed February 13, 1976. Date of patent, August 
23, 1977.
[18]	 Edvardson, K. O., “An FMCW Radar for Accurate Level Measurements,” 9th Eur. Micro-
wave Conference, Brighton, U.K., September 17–19, 1979, pp. 712–715.
[19]	 Imada, H., and Y. Kawata, “New Measuring Method for a Microwave Range Meter,” 
Kobe Steel Eng. Repts., Vol. 30, No. 4, 1980, pp. 79–82.
[20]	 Marfin, V. P., V. I. Kuznetsov, and F. Z. Rosenfeld, “SHF Level-Meter,” Pribory i sistemy 
upravlenia, No. 11, 1979, pp. 28–29. [In Russian.]
[21]	 Kagalenro, B. V., V. P. Marfin, and V. P. Meshcheriakov, “Frequency Range Finder of High 
Accuracy,” Izmeritelnaya technika, No. 11, 1981, p. 68. [In Russian.]
[22]	 Authors certificate 1123387 (USSR), INT.CL. G01S 13/34, “Radio Range Finder,” B. V. 
Kagalenko and V. P. Meshcheriakov, Bull. No. 41, published July 10, 1984.
[23]	 Authors Application 30-1591 (Japan), INT.CL. G01S 13/34, “Approach to Distance Mea-
surement with the Aid of Frequency-Modulated Signal and the Radar Station with Fre-
quency Modulation,” Izobretenia stran mira, No. 15, 1985, p. 29. [In Japanese.]
[24]	 Authors Application 60-1592 (Japan), MLI G01S 13/34, “Method for Distance Measure-
ment with the Help of the Radar Station with Double Frequency Modulation,” (Izobrete-
nia stran mira, No. 15, 1985, p. 29. [In Japanese.]
[25]	 Authors certificate 1141354 (USSR), INT.CL. G01S 13/08. “Frequency-modulated radio 
range finder,” B. V. Kagalenko and V. P. Meshcheriakov. Bull. No. 7. Filed March 5, 1983; 
published February 2, 1985. 
[26]	 Marfin, V. P., et al., “Radio Wave Non-Contact Level-Meter of Higher Accuracy,” Izmer-
itelnaya technika, No. 6, 1986, pp. 46–48. [In Russian.]
[27]	 Author certificate 1230423 (USSR), INT.CL. G01S 13/34, 13/08. “Radio Range-Finder 
with Frequency Modulation,” B. V. Kagalenro and V. P. Meshcheriakov. Bull. No. 17. Filed 
August 13, 1984; published July 5, 1986. 
[28]	 U.S. Patent 4737791. Int. CI. G01S 13.08. “Radar Tank Gauge,” B. R. Jean, et al. Filed 
February 19, 1986; date of patent April 12, 1988.
[29]	 Author certificate 1642250 (USSR), INT.CL. G01F 23/28. “Non-Contact Radio Wave 
Method for Level Measurement of Media Surface,” B. V. Lunkin, D. V. Khablov, and 
A. I. Kanarev. No. 4678472/10. Bull. No. 14. Filed April 14, 1989; published April 15, 
1991. 
[30]	 Author certificate 1700379 (USSR), INT.CL. G01F 23/28. “Non-Contact Radio Wave 
Method of Level Measurement and Device for Its Implementation,” D. V. Khablov. No. 
4773382/10, 4773381/10. Bull. No. 47. Filed December 24, 1989; published December 23, 
1991. 

xxiv	
Introduction
[31]	 U.S. Patent 5070730, Int. CI. G01F 23/28. “Device for Level Gauging with Microwave,” 
K. O. Edvardsson. No. 613574. Filed March 27, 1990; date of patent December 10, 
1991.
[32]	 U.S. Patent 5136299, Int. CI. G01S 13/08. “Device of Radar Level Gauge,” K. O. 
­Edvardsson. No. 687914. Filed January 11, 1990; date of patent August 4, 1992.
[33]	 Woods, G. S., D. L. Maskell, and M. V. Mahoney, “A High Accuracy Microwave Ranging 
System for Industrial Applications,” IEEE Transactions on Instrumentation and Measure-
ment, Vol. 42, No. 4, August 1993.
[34]	 U.S. Patent 5321408, Int. CI. G01S 13/08. “Microwave Apparatus and Method for ullage 
Measurement of Agitated Fluids by Spectral Averaging,” B. R. Jean and G. L. Warren. No. 
999680. Filed December 31, 1992; date of patent June 14, 1994.
[35]	 Bialkovski, M. E., and S. S. Stuchly, “A Study into a Microwave Liquid Level Gauging Sys-
tem Incorporating a Surface Waveguide as the Transmission Medium,” Singapore ICCS’94. 
Conference Proceedings, Vol. 3, 1994, p. 939.
[36]	 Stuchly, S., et al., “Microwave Level Gauging System,” 10th International Microwave Con-
ference MIKON-94, Vol. 2, Poland, 1994, p. 530.
[37]	 Stolle, R., H. Heuermann, and B. Schiek, “Novel Algorithms for FMCW Range Finding 
with Microwaves,” Microwave Systems Conference IEEE NTC’95, 1995, p. 129.
[38]	 U.S. Patent 5387918, Int. CI. G01S 13/32. “Method and an Arrangement for Measuring 
Distances Using the Reflected Beam Principle,” W. Wiesbeck, J. Kehrbeck, and E. Heidrich. 
No. 956882. Filed April 15, 1992; date of patent February 7, 1995.
[39]	 U.S. Patent 5406842, Int. CI. G01F 23/28. “Method and Apparatus for Material Level 
Measurement Using Stepped Frequency Microwave Signals,” J. W. Locke. No. 132981. 
Filed October 7, 1993; date of patent April 18, 1995.
[40]	 Vossiek, M., et al., “Novel FMCW Radar System Concept with Adaptive Compensation of 
Phase Errors,” 26th EuMC, Prague, Czech Republic, 1996, p. 135.
[41]	 Stolle, R., and B. Schiek, “Precision Ranging by Phase Processing of Scalar Homodyne 
FMCW Raw Data,” 26th EuMC, Prague, Czech Republic, 1996, p. 143.
[42]	 Chengge, Z., et al., “A Method for Target Estimation of Level Radar,” International Con-
ference of Radar Proceedings (ICR’96), Beijing, China, 1996, pp. 270–273.
[43]	 U.S. Patent 5504490, Int. CI. G01S 13/08. “Radar Method and Device for the Measure-
ment of Distance,” J. -C. Brendle, P. Cornic, and P. Crenn. No. 414594. Filed March 31, 
1995; date of patent April 2, 1996.
[44]	 U.S. Patent 5546088, Int. CI. G01S 13/18. “High-Precision Radar Range Finder,” G. 
­Trummer and R. Korber. No. 317680. Filed October 5, 1994; date of patent August 13, 
1996.
[45]	 Weib, M., and R. Knochel, “Novel Methods of Measuring Impurity Levels in Liquid Tanks,” 
IEEE MTT-S International Microwave Symposium Digest, Vol. 3, 1997, pp. 1651–1654.
[46]	 Weib, M., and R. Knochel, “A Highly Accurate Multi-Target Microwave Ranging System 
for Measuring Liquid Levels in Tanks,” IEEE MTT-S International Microwave Symposium 
Digest, Vol. 3, 1997, pp. 1103–1112.
[47]	 Kielb, J. A., and M. O. Pulkrabek, “Application of a 25 GHz FMCW Radar for Industrial 
Control and Process Level Measurement,” IEEE MTT-S International Microwave Sympo-
sium Digest, Vol. 1, 1999, pp. 281–284.
[48]	 Patent 2126145 (Russian Federation), INT.CL. G01F 23/284. “Level-Meter,” S. A. 
­Liberman, et al., No. 97114261/28. Bull. No. 4. Filed August 20, 1997; published October 
2, 1999.
[49]	 Bruimbi, D., “Low Power FMCW Radar System for Level Gauging,” 2000 IEEE MTT-S 
International Microwave Symposium Digest, Vol. 3, 2000, pp. 1559–1562.
[50]	 Zhukovskiy, A. P., E. I. Onoprienko, and V. I. Chizhov, Theoretical Fundamentals of Radio 
Altimetry, Moscow, Russia: Sovetskoe Radio Publ., 1979. [In Russian.]

Introduction	
xxv
[51]	 Finkelstein, M. I., Fundamentals of Radar, 2nd ed., Moscow, Russia: Radio i Sviaz Publ., 
1983. [In Russian.]
[52]	 Sheluhin, O. I., Short-Range Radio Systems, Moscow, Russia: Radio i Sviaz Publ., 1989.
[53]	 Skolnik, M., Introduction to Radar Systems, 3rd ed., New York: McGraw-Hill, 1981. 
[54]	 Brumbi, D., Fundamentals of Radar Technology for Level Gauging, 3rd rev., Duisburg: 
Krohne Messtechnik, 1999.
[55]	 Bakulev, P. A., Radar Systems, Moscow, Russia: Radiotekhnika Publ., 2004. [In Russian.]
[56]	 Komarov, I. V., and S. M. Smolskiy, Fundamentals of Short-Range FMCW Radar, ­Norwood, 
MA: Artech House, 2003.
[57]	 Atayants, B. A., et al., “Precision Industrial Systems of FMCW Short-Range Radar Tech-
nology: Truncation Measurement Error and Its Minimization,” Uspekhi sovremennoi 
­radioelektroniki, No. 2, 2008, pp. 3–23. [In Russian.]
[58]	 Atayants, B. A., et al., “Noise Problem and Non-Linearity of Transmitter Modulation 
Characteristic in Precision Industrial Short-Range FMCW Radar Systems,” Uspekhi sovre-
mennoi radioelektroniki, No. 3, 2008, pp. 3–29. [In Russian.]


1
c h a p t e r  1
Counting Method of Estimation of 
Difference Frequency 
1.1  Introduction
The measurement of a range with the help of a radar operating with a continuous 
frequency modulation (FM) signal can be implemented in different ways [1–6]. 
One of the many possible ways is by using a range-finder, allowing the provision 
of theoretical examination and obtaining the calculations necessary for working 
with upcoming sections of this book, as shown in Figure 1.1. The generator of the 
transmitted SHF signal excites a transmitting antenna and simultaneously forms 
a local oscillator signal for the mixer of a receiving section. The interaction of the 
transmitted (local oscillator) and reflecting signals happens in the mixer, and at its 
output a useful signal is formed at which frequency is connected with the measured 
range. The difference-frequency signal (DFS) is amplified and goes to a frequency 
meter and to a range meter. A modulator serves to provide the FM of the transmit-
ted signal. In the structure of a radar-measuring system, the frequency measurement 
of the limited sample of the continuous sinusoidal DFS is the main measuring op-
eration in the frequency-modulated continuous wave (FMCW). 
The simplicity and physical transparence of all stages of useful signal processing 
and, at first glance, well-studied methods for the frequency measurement ensure a 
high reliability of the counting method.
Let us examine carefully the traditional methods used at the signal generation 
and processing in the FMCW range-finder (RF) and in the analysis of its operation. 
The aim of this examination is to reveal those factors that are not important for 
rough (traditional) measurements but take on special significance when we have a 
need for high accuracy.
1.2  Main Calculation Relations
Let us examine DFS processing, drawing attention to only the key aspects that we 
will use later in the book. 
In the circuit of Figure 1.1, some monotonous periodic function 
mod
mod
( )
2
( )
t
f
t
ω
π
=
 with the period Tmod, for instance, sinusoidal or saw-tooth, 
is usually used for modulation. The radian frequency of an emitted signal varies 
within 
1
2
2
2
f
f
π
ω
π
£
£
 according to the law:
	
0
mod
0
mod
( )
2
( )
( )
2 [
( )]
t
f t
t
f
f
t
ω
π
ω
ω
π
=
=
+
=
+
	
(1.1)

2	
Counting Method of Estimation of Difference Frequency 
where 
0
0
2 f
ω
π
=
 is the carrying (central) frequency of the transmitted signal and 
fmod(t) is the time function reflecting the law of frequency variation in time. Then 
the FM sweep of the radian frequency is:
	
2
1
2
1
2 (
)
2
f
f
F
ω
ω
ω
π
π
D
=
-
=
-
=
D 	
(1.2)
Here 
2
1
F
f
f
D
=
-
 is the difference of extreme frequencies of the FM sweep. As a 
modulating function, the following functions are most often used [1, 3, 6, 7]:
Saw-tooth modulation with zero reverse trace:
• 
	
mod
mod
mod
mod
mod
( )
(
)/
,
(
1)
;
f
t
F t
iT
T
iT
t
i
T
= D
-
£
£
+
	
(1.3)
Symmetric triangular:
• 
	
mod
mod
mod
mod
mod
mod
mod
mod
mod
2
(
)/
for
0.5(2
1)
( )
2
[(
1)
]/
for
0.5(2
1)
(
1)
F t
iT
T
iT
t
i
T
f
t
F i
T
t
T
i
T
t
i
T
D
-
£
£
+
ì
= í D
+
-
+
£
£
+
î
	
(1.4)
Sinusoidal:
• 
	
mod
mod
( )
0.5
sin (2 (
1)/
)
f
t
F
i
T
π
=
D
+
	
(1.5)
where i = 0, 1, …
After delay time tdel caused by wave propagation time to the object under 
­investigation and back, the reflected signal passes to the mixer together with the 
small part of the radiated signal power. The DFS on the mixer output is:
	
dif
dif
dif
( )
cos
( )
u
t
A
t
ϕ
=
	
(1.6)
where Adif and jdif(t) are the DFS amplitude and the relative DFS instantaneous 
phase. The instantaneous phase of the DFS according to (1.1) is equal:
	
del
del
dif
s
0 del
mod
s
( )
( )
( )
t
t
t t
t t
t
t dt
t
t dt
ϕ
ω
ϕ
ω
ω
ϕ
-
-
=
+
=
+
+
ò
ò
	
(1.7) 
Figure 1.1  Block diagram of the simplest frequency-modulated range-finder.

1.2  Main Calculation Relations	
3
where js = jrf + jpp, jrf is some phase of the complex reflection factor from the object, 
and jpp is the additional phase shift arising in the circuit of preliminary processing.
Figure 1.2(a) shows diagrams of radiated signal frequency f(t) variations 
(solid curve) for symmetric triangle modulation and received delayed signal fre-
quency frec(t) (dotted curve) in time. The time function of the difference frequency 
DFS
rec
| ( )
( )|
F
f t
f
t
=
-
 is presented in Figure 1.2(b) and the appropriate DFS is pre-
sented in Figure 1.2(c). The difference frequency is constant (at the fixed object and 
the radar) during larger part of the modulation period, and the frequency sharply 
changes in the short intervals with width ±tdel/2 near intersect points of plots in Fig-
ure 1.2, which is repeated every half of the period modulation. These narrow time 
intervals between signal extremes are called zones of inversion [1]. 
Usually in the short-range radar, the condition tdel << Tmod is satisfied. In this 
case, the inversion zone duration in Figure 1.2 becomes negligibly small for analy-
sis. As a result, DFS represents the burst of sine oscillations with duration equal 
approximately to Tmod/2 with a carrier frequency proportional to the measuring 
range and with phase jumps in the inversion zone [1].
Because the function w(t) in (1.7) changes slowly, the integration result can be 
approximately written in accordance with the mean value theorem [8] as:
	
dif
0 del
mod
del
del
s
( )
(
0.5
)
t
t
t
t
t
ϕ
ω
ω
ϕ
=
+
-
+
	
(1.8)
(a)
(c)
(b)
Figure 1.2  Graphs of (a) the radiated signal (solid curve), received (dotted curve) signal, (b) DFS, 
and (c) the output signal of the mixer.

4	
Counting Method of Estimation of Difference Frequency 
Thus, the law of the DFS phase variation under these assumptions coincides 
approximately with the law of frequency variation of the transmitted signal, except 
within the inversion zones. Difference is observed only in inversion zones. 
Neglecting in (1.8) by insignificant delay tdel/2, we examine the plot of the 
phase jdif(t) (1.8) and the appropriate DFS shown in Figure 1.3(a, b) for the case: 
symmetric linear triangular modulation (1.4), fixed range to the target, and, for 
distinctness, for js = 0.
The horizontal lines in Figure 1.3(a) correspond to the phase values:
	
dif
(
0.5) ,
0,1,2
n
n
ϕ
π
=
+
=
…	
(1.9)
The instantaneous DFS value at these phase values becomes zero. Therefore, 
these points of the graph are called DFS zeros [2]. They are concerned to distinc-
tive DFS points. The time moment, where the instantaneous DFS value achieves the 
extreme values, is another type of typical points. Distinctive points of one type are 
time-shifted by the DFS half-period. 
The DFS from the mixer output passes to the frequency meter. Traditionally, 
the frequency measurement is provided by means of counting of DFS zero number 
during some time interval. The value obtained is the basis of range calculation. 
The instantaneous value of the difference frequency is [1, 5]:
	
dif
del
del
1
( )
( )
( )
2
2
DFS
d
t
d
t
F
t
t
f t
dt
dt
ϕ
ω
π
π
=
=
=
¢
	
(1.10)
where the upper stroke designates, as usual, the first time derivative. 
The frequency meter determines its average value FR, which is proportional to 
the R range, over some time interval. Due to modulation periodicity, the average 
interval is equal to the half-period of modulation. For this, synchronization pulses 
Figure 1.3  Graphical representation of (a) the phase and (b) DFS. 

1.3  The Traditional Counting Method of Range Measurement	
5
from a modulator specified margins of the modulation period pass to the frequency 
meter and a range calculator in Figure 1.1.
In this case, at the symmetric triangular modulation law (1.4) with consideration 
of (1.10) we can write the value of the average value of difference frequency as: 
	
min
mod
min
/2
del
del
2
1
mod
mod
2
( )
(
)
T
t
T
R
t
t
t
F
f t dt
T
ω
ω
π
+
=
=
-
¢
ò
	
(1.11)
where tmin is any current moment of the signal frequency equality to the value w1. 
This equation remains true at other FM laws as well [1]. Thus, for the chosen mea-
surement method, the average DFS frequency value is connected linearly with tdel 
and in the first approximation does not depend upon the modulation law. 
Taking into account that tdel = 2R/c, where R is the measuring range and c is 
the propagation speed of the electromagnetic wave in the medium, we find out the 
formula for the range:
	
mod
4
R
cT
F
R
F
=
D
	
(1.12)
Thus, the measuring range is proportional to the modulation period, the light 
speed, and the difference frequency, and it is inversely proportional to the quadru-
plicate range of the FM sweep. 
1.3  The Traditional Counting Method of Range Measurement
The product TmodFR in the numerator of (1.12) factually corresponds to the number 
of DFS periods, which are stacked in the modulation period. If we use the counting 
method [1, 4] to measure the difference frequency, then we obtain in the numerator 
of (1.12) the integer number NDFS of the DFS periods:
	
DFS
mod
Int(
)
R
N
T
F
=
	
(1.13)
where Int(×) is the operation of calculation of the integer part of a number and 
(1.12) takes a form:
	
DFS
4
cN
R
F
=
D
	
(1.14)
The calculation result according to (1.14) changes discretely, and the QI dR is:
	
4
R
c
F
δ
=
D 	
(1.15)
The practical number of zeros NDFS falling into the average interval depends 
not only upon FR but upon the product w0tdel, which is included in (1.7) and deter-
mines a position of the lower point of phase plot in Figure 1.3(a):
	
jmin = w0tdel + j	
It is easy to show that the true number of DFS zeros between two adjacent 
phase extremes is determined by the following equation [9]: 

6	
Counting Method of Estimation of Difference Frequency 
	
ϕ
ϕ
λ
π
λ
π
ϕ
ϕ
λ
δ
π
λ
π
æ
ö
æ
ö
+
-
+
-
=
-
ç
÷
ç
÷
è
ø
è
ø
æ
ö
æ
ö
+
+
-
+
-
=
-
ç
÷
ç
÷
è
ø
è
ø
2
1
1
1
4
4
0.5
0.5
Int
Int
4
4
0.5
0.5
Int
Int
s
s
s
s
R
R
R
N
R
R
R
	
(1.16)
where l2 and l1 are, respectively, a wavelength of the carrier oscillation on the 
upper and lower frequencies on the FM sweep. Figure 1.4 shows functions of the 
number of zeros NDFS (thick curve) and N (thin curve) versus the normalized range 
R/dR for f0 = 10 GHz and DF = 1 GHz drawn according to (1.13) and (1.16), 
­respectively.
As the distance varies continuously over intervals of ED, the number of zeros 
jumps from NDFS to NDFS + 1. The period of such variation is a quarter-wavelength 
of the carrier oscillation. 
From the formula (1.12), we can obtain one more equivalent equation: 
	
2
c
R
ω
DF
=
D
	
(1.17)
Figure 1.4  The function of the number of DFS zeros versus the normalized range.

1.4  Sources of Range Measurement Errors by the FMCW Range-Finder	
7
where 
mod R
T
F
π
DF =
 is the DFS phase shift in radians on the appropriate modula-
tion branch. Sometimes, this equation can be useful for an understanding of the 
processes that occurred. 
1.4  Sources of Range Measurement Errors by the FMCW Range-Finder 
In accordance with formula (1.12) and assuming the independence of included 
items, the relative variance of the total error of range measurement error 
2
R
σ  can be 
written as [5, 10]:
	
mod
2
2
2
2
2
sp
R
R
F
T
F
σ
σ
σ
σ
σ
D
=
+
+
+
	
(1.18)
where 
2
sp
σ , 
mod
2
T
σ
, 
2
F
σD , 
2
R
F
σ
 are, accordingly, the relative variances of propagation 
speed of the electromagnetic wave, of the modulation period, of the FM sweep and 
of the estimated difference frequency.
Usually, at rough measurements, the propagation speed of the electromagnetic 
wave in the medium is assumed to be constant and independent upon external con-
ditions. However, when we discuss the high-precision measurements, we must take 
into consideration its variation at the change of pressure and temperature [11, 12]. 
These variations have a systematic character, and they can be easily taken into 
account by introducing compensating corrections at the calculation performance. 
Therefore, in this book we assume that the propagation speed of the electromag-
netic wave in the medium is the constant quantity and then 
2
sp
0
σ
=
.
The formation error of the required modulation period Tmod can be easily made 
small enough and, therefore, we shall not consider it. 
The third component 
2
F
σD  is connected with the maintenance of the unchanged 
value of the FM sweep of the transmitter. This is a rather complicated scientific and 
engineering problem. The modern FMCW oscillators are based on the principle of 
the varactor FM sweep [13, 14]. The nonlinearity of the MC is principally peculiar 
to such oscillators. Therefore, it is difficult to accurately settle the required FM 
sweep for the analog way of providing modulation. Often, it is not required at all 
because the device calibration is usually provided. Nevertheless, at the environment 
temperature variation (or for other external factors), the MC nonlinearity changes 
that leads to a variation of the FM sweep. These MC variations cannot be consid-
ered exactly because they may have the hysteresis character and are individual for 
each radar’s measuring system. Due to this reason, in RF for increase accuracy, it is 
necessary to examine the influence of the instability of the FM sweep. 
In a number of cases, the stabilization problems of the modulation period and 
the FM sweep of the transmitter happen to be interrelated. For example, it takes 
place at the range calculation performance according to the equation equivalent to 
(1.12): 
	
2
R
f
cF
R
K
=
	
(1.19)
where Kf = 2DF/Tmod is a slope of transmitter frequency’s variation, which is main-
tained unchanged. 

8	
Counting Method of Estimation of Difference Frequency 
The fourth error component 
2
R
F
σ
, which is determined by the accuracy of the 
difference frequency measurement, is the most important for our tasks. To achieve 
high accuracy, we must use different MQIS. 
Frequency measurement time (time of analysis) can be different. The least time 
of analysis is equal to a half-period of modulation. Therefore, the inversion zone is 
omitted from consideration and we discuss the frequency measurement of the radio 
pulse. An increase of analysis time due to any reason leads to the fact that we should 
measure the average frequency of the phase-shift keyed radio signal. It leads to an 
increase in additional errors.
The restricted sample volume, according to which the frequency estimate is 
provided, as we often discuss the range measurement commensurable with the QI 
value, is the significant peculiarity of these measurements, which hampers obtaining 
high accuracy. For small ranges, only four to six DFS periods and less can be formed 
during the one modulation period. Under these conditions, we may achieve high 
accuracy of frequency measurement only in the case when, during the analysis time 
interval, the measuring frequency does not change. In the FMCW range-finder, this 
means that the one of the reasons of the difference frequency measurement error is 
nonlinearity of the SHF frequency variation of the transmitter. The MC nonlinear-
ity or the influence of the SHF signal reflected from a target upon the FMCW oscil-
lator [15]* can be a source of this error component.
The noise of the first stages of the receiver, the phase noise of the transmitter, 
and the interference presence in the received signal are evident and well-known rea-
sons for an increase in measurement error. The SRs located in the operation zone of 
the FMCW RF are these interference sources.
The PAM of DFS increases because of the nonideality of frequency responses of 
the SHF oscillator and main units of the SHF path and is one more error source. 
Even for ideal conditions of DFS generation and processing, the measurement 
error occurs peculiar to each MQIS, which is called the truncation error [6]. Later 
we will discuss problems of minimization of this component of the range measure-
ment error. 
1.5  Adaptive Control of Frequency Modulation Parameters 
Periodicity of the modulation law of the transmitted FM signal leads to the fact that 
the DFS takes a form of the phase-shift keyed oscillation, in which at the boundar-
ies of the modulation half-period, the phase jumps happen (Figure 1.2). The value 
of this jump depends upon the measuring range and when the last varies, the value 
periodically changes within the limits from 0° to 180° with a length period equal to a 
half-wavelength of the carrier oscillation. Such a DFS property forces the limitation of 
the difference frequency measurement time by the only one half-period of modulation 
Tmeas = Tmod/2. Moreover, this property does not permit to provide the narrowband 
DFS filtering, which is necessary to improve the signal/noise ratio (SNR). At large 
values of the phase jump, the narrowband filtering leads to DFS PAM with a decrease 
*  Sometimes this influence can be taken into account in the form of the “autodyne” effect, which is typical for 
the self-oscillating mixers.

1.5  Adaptive Control of Frequency Modulation Parameters	
9
of the DFS amplitude in the inversion zone down to zero (at the phase jump by 180°), 
and, as a result, the total SNR decreases in these time intervals. 
It is possible to eliminate this phenomenon providing optimization (adaptation) 
of the FMCW RF signal’s generation and processing. Therefore, it is necessary to con-
trol the frequency modulation parameters in such a manner to provide the absence 
of the DFS phase jumps when using the periodic FM. Accordingly, the DFS takes the 
form of the continuous sine signal. As a result, we can increase the DFS processing 
interval by reducing the QI of the DFS period counting down to accepted value. 
To ensure optimal control by the modulating voltage, it is necessary at first to 
formulate the optimality criterion. We assume as such a criterion the absence of 
DFS phase jumps using the periodic FM. In accordance with (1.8), the DFS phase 
on the receiver output can be written as: 
	
dif
0 del
mod
del
s
( )
( )
t
t
t
ϕ
ω
ω
ϕ
=
+
+
	
(1.20)
At the formulation of the condition of the DFS phase jump absence, it is neces-
sary to take into consideration the property of such a signal, which is that its plot is 
symmetric with respect to a center of the inversion zone (Figure 1.2). The absence 
of the DFS phase jump corresponds to the equality of the DFS time derivatives cal-
culated in the near vicinity from right and left of the inversion zone:
	
mod
mod
dif
dif
0
0
2
2
( )
( )
,
0,1,2
T
T
t n
t n
du
t
du
t
n
dt
dt
=
-
=
+
=
=
…	
(1.21)
Phase jump absence at changing the sign of the function’s wmod(t) derivative on 
the boundaries of modulation half-periods corresponds to the DFS extreme pres-
ence in these points. Hence, the integer number of the DFS half-periods should be 
stacked in the modulation half-period. At the variation of the range R, this can be 
performed by only changing appropriately the carrier frequency w0 and the fre-
quency deviation Dw.
In particular, we can control by the moment of the current modulation half-
period’s finishing so that this moment would coincide with the one from the DFS 
extremes [16]. In connection with the fact that many DFS extremes can be on the 
modulation half-period, it is necessary to put additional limitations, for instance, on 
the minimal value Dfmin of the transmitter. To limit the FM sweep, we may control 
boundary frequencies at frequency f(t) variations of the transmitted signal with the 
help of standard lower and upper frequencies: wst1 = 2pFst1 and  wst2 = 2pFst2 speci-
fied by some simple way. For example, for this we can use dielectric resonators (DR) 
tuned on these frequencies. Then DFmin = Fst2 – Fst1. We can interrupt the modula-
tion half-period only in the moment of DFS extreme appearance after achievement 
of one of specified values [17] by the frequency of the transmitted signal. The logic 
function Vcon(t) of modulation voltage control has, in this case, a form:
	
st2
con
st1
0
for
0.5(2
1)
and
( )
( )
1
for
and
( )
R
R
t
j
NT
f t
F
V
t
t
jNT
f t
F
£
-
£
ì
= í
£
³
î
	
(1.22)

10	
Counting Method of Estimation of Difference Frequency 
where j = 1, 2, 3, … is a number of the current modulation period, TR = 1/FR. As a 
result of the above-mentioned procedure performance, phase jumps in the DFS will 
be eliminated, which takes a form of the continuous sinusoid. This process can be 
conditionally called the DFS phase joining. 
The function on DFS phase variations, the DFS plot in the mode of the phase 
joining, and the logic function Vcon of the modulation control voltage versus time 
for limitation of the FM sweep of the transmitter are shown in Figure 1.5.
In the mode of the DFS phase joining, the modulation period Tmod and the 
FM sweep Dw cease to be constants and depend upon the measurement range. 
These functions are included in the calculation formula (1.9) for the range. The 
smooth decrease of the range leads to a smooth increase of Tmod from the minimal 
range 2Tmin to the maximal 2Tmin + TR [17–20]. Accordingly, the FM sweep of the 
transmitter increases. Then, at the range where the modulation half-period dura-
tion achieves the maximal value, the jump returns in the modulation period to its 
minimum because of transition of the phase joining point to the adjacent DSF ex-
treme located in the time interval Tmin. Exactly in the same manner the FM sweep 
decreases by a jump. The smooth increase of the range gives birth to the inverse 
process. 
At the nonlinear MC of the transmitter, it is necessary to stabilize the average 
slope of its frequency variation [21]. For this we need, besides a limitation of the 
FM sweep by the value DFmin, to stabilize the operating time interval Tmin, during 
which the transmitter frequency is inside of this range.
Figure 1.5  (a) DFS phase, (b) DFS itself, and (c) the control function for limitation of the FM 
sweep.

We can ensure the stability of the average slope of frequency variations of the 
transmitted signal in the interval between standard frequencies by the time interval 
Tmin adjustment between moments t1 and t2, corresponding to equality of the in-
stantaneous phase to DFS values wst1tdel and wst2tdel. Therefore, discrete regulation 
is provided. The measurement of the duration Tmin is carried out during one modula-
tion period, and its comparison with the standard meaning Tst and the appropriate 
variation of modulating voltage is provided at the end of this measuring half-period. 
The obtained amplitude value remains constant during the entire next period until 
the new correction performance. It can be written in an analytical form as: 
	
(
)
1
1
amp
st
min
mod
mod 1
j
j
j
U
U
K
T
T
-
-
é
ù
=
+
-
ê
ú
ë
û	
(1.23)
where the index j corresponds to the number of the current period, and Kamp is a 
coefficient defining the sensitivity of the modulating voltage amplitude to the devia-
tion of operating time interval duration from the specified value. With this adjust-
ment, the value Tst factually gives the lower boundary of Tmod.
Therefore, the range calculation is performed according to the formula:
	
per
,
per
f,st
meas
meas
2
2
R st
st
cN
T N
R
K
T
T
δ
=
=
	
(1.24)
where Kf,st = DFmin/Tst; and Nper is a number of DFS periods calculated during mea-
suring time interval Tmeas, requirements of which are given as: 
	
min
/(4
)
Rst
c
F
δ
=
D
	
We can find the function of the modulation period versus a range caused by the 
described adaptation. Transferring the time origin in the point corresponding to the 
equality of the instantaneous phase of the radiated signal and the value wst1tdel in Figure 
1.5(a), we can obtain the function of the relative modulation period Q = Tmod/(2Tst) 
versus a range according to the ratio of similar triangle sides with the same name:
	
st2
st1
4
4
1
Int
Int
R
R
R
R
δ
λ
λ
é
ù
æ
ö
æ
ö
Q =
+
-
ê
ú
ç
÷
ç
÷
è
ø
è
ø
ë
û
	
(1.25)
This function has a complex character. It reflects the above-mentioned fact [1] 
that in the time interval Tmod a number of DFS half-periods NDFS or (NDFS + 1) 
can be stacked. Therefore, the modulation period depends not only upon both the 
required normalized range and the ratio of the range and wavelengths correspond-
ing to lower and upper standard frequencies. Figure 1.6 shows the function of the 
normalized modulation period Q versus relative range R/dR drawn in accordance 
with (1.25) at Fst1 = 10 GHz, Fst2 = 10.5 GHz. These frequencies are used next for 
all calculations and simulation of signals and for their processing if we do not spe-
cially fix the other values. 
A modulation period’s duration continuously changes at range variation. We 
can observe fast and slow variations of the plot. Fast variations are caused by the 
sharp transposition of moments of phase “joining” at range variation by a quarter-
wavelength in a point on the range scale corresponding to the DFS half-period  
1.5  Adaptive Control of Frequency Modulation Parameters	
11

12	
Counting Method of Estimation of Difference Frequency 
number variation from NDFS to NDFS + 1 and vice versa. Slow variations are con-
nected with smooth variation of the difference frequency.
If the modulation is performed so that the linear time-variation of the transmitted 
signal frequency is provided, the above-mentioned variations of the modulation period 
and the FM sweep do not adversely affect to calculation results. They are included in 
(1.9) in the form of ratio representing the slope of FM sweep of the transmitter. 
We can manage without automatic regulation of the duration Tmin if perform-
ing the simple account of its current value at the range calculation. For this one 
can use (1.24), where we must substitute the current value of Kf,op instead of the 
constant value Kf,st:
	
min
f,op
min
F
K
T
D
=
	
(1.26)
The components from which the range measurement error is formed for the 
counting method are: 
The truncation error peculiar to the method under ideal conditions;
• 
Inaccuracy of 
• 
udif(t) phase joining;
Noise presence;
• 
MC nonlinearity of the SHF oscillator; 
• 
Accuracy of the position’s determination of frequency marks;
• 
Regulation accuracy of the reference time interval;
• 
Temperature variations of resonance frequencies of DR.
• 
The influence of the last three reasons is evident and does not present a scientific 
interest. That is why the analysis of the first three components of the measurement 
error only will be conducted next. 
Figure 1.6  The function of the normalized modulation period versus the relative range.

1.6  Truncation Error of Range Measurement at Adaptive Frequency Modulation	
13
1.6  Truncation Error of Range Measurement at the Adaptive 
Frequency Modulation
Let us consider a variant of the optimal modulation control in accordance with 
(1.22) for the stabilization of the time interval duration Tmin. The truncation error 
in this case is caused by two reasons: the discreteness of DFS period number count-
ing and the pulling of signal udif(t) period in each point of phase joining. The result 
of their influence on the truncation error depends upon the way of the difference 
frequency measurement [21]. In this case we may use two methods:
The DFS period number is calculated during the some fixed time interval.
• 
The DFS period number is calculated during the time interval, which is mul-
• 
tiply to the modulation period (in the specific case during the one modulation 
half-period).
1.6.1  The Fixed Measuring Time Interval
Taking into account that the minimal value of the modulation period is 2Tst, we 
designate as Nmeas the ratio of the following time intervals:
	
meas
meas
st
2
T
N
T
=
	
(1.27)
If phase joining is performed ideally, the DFS period number calculated dur-
ing time Tmeas is equal to the following value rounded to the integer value Nper = 
Int[FRTmeas + 0.5].
The pulling period of the signal udif(t) in each phase joining point leads to an 
increase in the error caused by the fact that after modulation voltage’s transition 
from the forward path to the inverse path (and vice versa), the difference frequency 
passes through zero and one period by the delay value tdel of the delayed signal is 
prolonged [17]. This is shown in a deliberately distorted scale in Figure 1.7.
We can write the modulation period duration at the range variation in the fol-
lowing form taking into consideration pulling in the points of phase joining:
	
st
st
mod
del
st2
st1
2
4
4
1
Int
Int
2
R
T
R
R
T
t
R
δ
λ
λ
é
ù
æ
ö
æ
ö
=
+
-
+
ê
ú
ç
÷
ç
÷
è
ø
è
ø
ë
û
	
(1.28)
As a result of pulling in the interval Tmeas, the number of counted periods TR 
will be less. We can determine the total number of counted periods during one 
modulation period 
mod
T
N
 from Figure 1.7:
	
mod
mod
del
st2
st1
4
4
2
(0,5
)
1
Int
Int
T
R
R
R
N
F
T
t
λ
λ
æ
ö
æ
ö
=
-
=
+
-
ç
÷
ç
÷
è
ø
è
ø	
(1.29)
During Tmeas, the number of DFS periods 
mod
T
N
 can be calculated by ­rounding:
	
ç
÷
meas
meas
T
meas
per
T
mod
N
T
N
N
Int
0.5
T
æ
ö
=
=
+
è
ø
	
(1.30)

14	
Counting Method of Estimation of Difference Frequency 
Now we can estimate the difference frequency FR = Nper/Tmeas, substitute it in 
(1.13), and, having normalized parameters to QI, obtain the normalized truncation 
error versus the normalized range:
	
(
)
mod
meas
min st
st
meas
Int
0.5
1/
/ 2
T
R
N
x
x
F
T N
R
x
N
δ
ì
ü
ï
ï
+
í
ý
+
D
D
ï
ï
î
þ
=
-
	
(1.31)
where x = R/dRst is the normalized range. 
The general view of this function at Nmeas = 50 is shown in Figure 1.8(a) for 
2DFminTst = 2,500,000 and in Figure 1.8(b) for 2DFminTst = 5,000,000.
The error in a complicated manner depends upon the number of processed 
periods Nmeas, the product 2DFminTst, and the magnitude of the FM sweep influ-
encing 
mod
T
N
 and dRst. In a used plot scale, fast error variations caused by counting 
discreteness run into the complete band, in which the width is defined by the value 
of Nmeas. An increase of the product 2DFminTst leads to a reduction of the maxi-
mal truncation measurement error at a large range. Nevertheless, it is impossible 
to increase infinitely 2DFminTst because of the physical possibilities of used SHF 
oscillators and due to restrictions of the measurement interval duration caused by 
system dynamics. Therefore, it is expedient to fix Tmeas on an acceptable level and 
to perform such a choice of FM sweep and a number of processed periods Nmeas, 
which ensures the required measurement error.
Figure 1.7  Pulling of a DFS period in the points of phase joining.

Figure 1.9 shows plots of the function of the relative measurement truncation error 
function versus the normalized range for Tmeas = 1 second at DFmin = 500 MHz and for 
two values of Nmeas = 50 [Figure 1.9(a)] and Nmeas = 200 [Figure 1.9(b)].
An increase of the FM sweep up to DFmin = 1,000 MHz leads to a decrease of 
QI modulus dRst and, hence, to a widening of the variation range of relative range 
at unchanged of its physical meaning (Figure 1.10). Therefore, the modulus of the 
measurement error decreases with increasing DFmin.
With increasing Nmeas the value of the normalized truncation error decreases, 
but its variation range increases in the actual range. 
To reduce the truncation error, it is expedient to increase a number of pro-
cessed periods up to the maximal frequency deviation and to decrease a number of 
Figure 1.8  The relative truncation error at Nmeas = 50 for (a) 2DFminTst = 2,500,000 and (b) 2DFmin 
Tst = 5,000,000.
1.6  Truncation Error of Range Measurement at Adaptive Frequency Modulation	
15

16	
Counting Method of Estimation of Difference Frequency 
processed modulation periods owing to reduction of Nmeas and with increasing of 
duration Tst. If these measures will be in vain, it is expedient to use the correction 
of the range calculation results, which is considered next.
1.6.2  The Measuring Time Interval Multiple to the Modulation Half-Period 
Now we shall consider the DFS phase joining, when the integer number of the 
difference frequency half-periods is stacked  during the modulation half-period be-
tween joining moments [21]. To estimate the difference frequency, it is enough to 
measure the duration of the measuring time interval and to count the number of 
the DFS zeros in this interval. The number of modulation periods Nmod is the fixed 
value. The measuring time interval in this case is variable:
	
meas
mod
mod
T
N
T
=
	
(1.32)
Figure 1.9  The relative truncation error for DFmin = 500 MHz, Tmeas = 1 second: (a) Nmeas = 50, and 
(b) Nmeas = 200.

The minimal duration of the measuring interval can be equal to one modulation 
half-period. Therefore, in (1.32) Nmod = 0.5. Evidently, the Nmod variation step is 
equal to 0.5.
The measurement of the measuring interval duration can be performed using 
the count of the pulse number with the standard stabilized frequency (or with the 
period Dt). Hence, the counting discreteness error arises, which is determined by 
the value of the standard frequency. The range estimation result with consideration 
of the counting discreteness error Dt and the influence of DFS period pulling upon 
the truncation error can be written taking into account that, at the determination 
of difference frequency, the integer number of the DFS half-periods is stacked in the 
interval 0.5Tmod – tdel:
	
mod
mod
st
mod
mod
(
2
)
2
(
)
R
del
f
cF N
T
t
R
K
T
N
t
-
=
+ D

	
(1.33)
Figure 1.10  The relative truncation error for DFmin = 1,000 MHz, Tmeas = 1 second: (a) Nmeas = 50, 
and (b) Nmeas = 200.
1.6  Truncation Error of Range Measurement at Adaptive Frequency Modulation	
17

18	
Counting Method of Estimation of Difference Frequency 
Assuming as before that 2tdel << Tmod and choosing the counting frequency so 
that Dt << Tmod and presenting the fraction in (1.33) as the Taylor series with ac-
count of two items, we can write the approximated expression for range estimation 
neglecting by the item of the second smallness order:
	
st
mod
mod
mod
[1
2 /
/(
)]
2
R
f
cF
t T
t T
N
R
K
-
- D
»

	
(1.34)
The counting discreteness error is the quantization noise with the error variance 
of the time interval measurement [22]:
	
2
2
(
)
12
T
t
σ
D
=
	
(1.35)
From there we obtain the relative variance of truncation error of range mea-
surement caused by the counting discreteness: 
	
count
st
mod mod2 3
R
R
x t
N
T
σ
δ
D
=
	
(1.36)
Plots of this function for two values of Ncount = Tst/Dt at Nmod = 0.5 are ­presented 
in Figure 1.11.
Due to the discrete character of Tmod variation at the variation of range ac-
cording to (1.28), plots also have discrete character. However, the value of discrete 
variations is many times less than the error magnitude and therefore it cannot be 
distinguishable in Figure 1.11 in this scale. An increase of Ncount leads to variance 
reduction for range measurement.
Figure 1.11  The function of the truncation error variance versus the relative range.

The stable component of the measurement truncation error caused by the DFS 
period pulling and, being its mathematical expectation, can be transfer to the form 
after transformations:
	
2
min mod
R
Rst
x
F
T
δ
D
-
= D
	
(1.37)
This function is shown in Figure 1.12 for the same two values of the product 
2DFminTmod as in Figures 1.8 and 1.9.
At the range variation, Tmod periodically changes in accordance with (1.28) and 
Figure 1.6. This leads to the periodic discrete plot’s break; however, these breaks 
are insignificant compared with the total value of errors and they cannot be seen 
in Figure 1.12 in the chosen scale. A comparison of plots shown in Figures 1.8 and 
1.10 with plots in Figures 1.11 and 1.12 shows that the second variant of the DFS 
frequency determination in the phase joining method allows an essential reduction 
of truncation errors and a decrease in the measurement discreteness. It is clearly 
shown in Figure 1.13.
Here we see the gray plot, which is the best in Figure 1.9(b), and lines are 
drawn corresponding to the relative mathematical expectation of the error at the 
same parameter value (solid curve) and a zone of three MSDs (dotted curve) for 
the method of the DFS frequency estimation according to one modulation half-
period. These plots correspond to 2DFminTst = 5,000,000 and Ncount = 40,000. 
The widths of the zone of three MSDs can be easily compressed using increasing 
of Ncount and Nmod. 
Figure 1.12  Mathematical expectation of the truncation error of the range measurement.
1.6  Truncation Error of Range Measurement at Adaptive Frequency Modulation	
19

20	
Counting Method of Estimation of Difference Frequency 
1.6.3  Calculation of the Range Result Correction
The correction of the range calculation result can be performed on the basis of 
consideration of error systematic character of measurement caused by the DFS pe-
riod pulling. For the first method of difference frequency estimation, the correction 
anticipates the performance of the following stages:
Stage 1:
• 
 We count the number of the DFS periods Nper and the number of 
modulation periods K = Int(Tmeas/Tmod) during the measuring time interval 
Tmeas.
Stage 2:
• 
 According to the measurement of the DFS period number during the 
measurement interval, range calculation is provided on formula (1.24).
Stage 3:
• 
 The delay time estimation is performed
	
del
2R
t
c
=


	
(1.38)
Stage 4:
• 
 The new range value is calculated with consideration of this estima-
tion and the number of modulation periods:
	
st
per
meas
del
2
(
2
)
f
cN
R
K
T
t
K
=
¢
-


	
(1.39)
Stage 5:
• 
 Stages 3 and 4 are repeated until the required calculation accuracy 
will be achieved. 
A sign for this process stoppage can be the reduction of the difference between 
the newly calculated result and the previous result, which is less than the specified 
value. The correction is performed by a calculation way according to one DFS 
measurement. 
The content of the first and third stages is changed for the second approach of 
the difference frequency estimation. At the first stage, the duration of the measuring 
interval is measured and the number of the DFS half-periods is determined during 
the interval. At the third stage, we substitute into (1.39) the measured value of Tmeas 
and assume that K = Nmod.
Figure 1.13  Comparison of truncation errors of range measurement with the help of two ways of 
the DFS frequency estimation.

Let us estimate of this process convergence. Using (1.39), we obtain for the first 
approach of frequency estimation the new value of the measurement error 
( )
corr
n
R
D
, 
which has on the nth step of the result correction with the account that st
del
T
t

:
	
(
1)
(
1)
del
del
( )
( )
del
del
corr
(
1)
meas
meas
del
2
2
2
n
n
n
n
n
t
t
t
t
R
R
R
R
R
T
T
t
-
-
-
-
-
D
=
-
=
»
-



	
(1.40)
where (
1)
del
n
t
-  is estimation of delay time calculated at the previous correction stage 
according to formula (1.38). Taking into consideration (1.39) and consequently 
using (1.40) for recording measurement errors on the previous correction stages, 
we obtain: 
	
( )
corr
meas
min st
st
st
2
n
n
R
R
Kx
R
R
N
F
T
δ
δ
D
D
æ
ö
=
ç
÷
è
ø
D
	
(1.41)
where DR/dRst is the initial relative error determined by (1.31).
For the second approach of frequency estimation, all relations remain true, but 
in (1.40) and (1.41) we should substitute K = Nmeas = Nmod and Tmeas = NmodTmod. 
As a result, mathematical expectation of the corrected normalized measurement 
error will be connected by the following equation with the initial value of this 
quantity:
	
( )
corr
min mod
st
st
n
n
R
R
x
R
R
F
T
δ
δ
D
D
æ
ö
=
ç
÷
è
ø
D
	
(1.42)
The expressions in square brackets in (1.41) and (1.42) are much less than 1. 
Therefore, at increasing n, the corrected error tends to zero. 
Let us estimate the convergence speed of this procedure. We obtain the measure-
ment error achieved on the first stage of such correction procedure. From (1.42) we 
may express the corrected (on the first stage) relative measurement error 
(1)
corr
st
/ R
R
δ
D
 
for the first approach of frequency measurement through the initial relative error 
DR/dRst determined by (1.31):
	
(1)
corr
st
st
min st
2
R
R
R
R
Kx
F
T
δ
δ
D
D
=
D
	
(1.43)
For the second approach, it is necessary to obtain the mathematical expectation 
of measurement error and its variance. Taking into consideration that (1.43) rep-
resents the linear transformation of the random quantity, we obtain the following 
formula for the relative mathematical expectation of the corrected measurement 
error: 
	
(1)
corr
st
st
min mod
R
R
R
R
x
F
T
δ
δ
D
D
=
D
	
(1.44)
where DR/dRst is determined by (1.31). The relative variance of the corrected trun-
cation error can be obtained by taking into account (1.35) and (1.36):
1.6  Truncation Error of Range Measurement at Adaptive Frequency Modulation	
21

22	
Counting Method of Estimation of Difference Frequency 
	
2
count
2
st
min
mod mod2 3
R
R
x T
F
N
T
σ
δ
D
=
D
	
(1.45)
The calculations according to (1.44) and (1.45) for F1 = 10 GHz and DFmin = 
500 MHz lead to plots shown in Figures 1.14 and 1.15. 
Plot discreteness, which is calculated according to (1.44), is essentially less after 
correction of calculation results. Therefore, the correction for lesser values of Nmeas 
is more effective.
Figure 1.14  The truncation error of the first approach of frequency measurement after the correc-
tion of calculation results.
Figure 1.15  Mathematical expectation of the corrected relative truncation error for the second 
approach of frequency measurement.

1.7  The Range Determination Error	
23
Equation (1.45) leads to a smoother variation of the plot at closed magnitudes 
of the corrected error. A comparison of Figures 1.14, 1.11, and 1.13 shows that 
correction of calculation results allows a reduction of the measurement error by 
three orders at the first correction step. Therefore, further repeating the correction 
procedure is not required. 
The calculation result of relative variance according to (1.45) for the second ap-
proach of frequency measurement is presented in Figure 1.16 at Ncount = 20,000 and 
Nmod = 1. A comparison of this figure with Figure 1.10 shows that the calculation 
result’s correction essentially decreases the random component of the measurement 
error. The increase of Nmod leads to a proportional decrease of relative variance.
1.7  The Range Determination Error Caused by the Inaccuracy of 
Modulation Adaptation
If the DFS extreme moment is determined with the error Dt, the phase joining in-
accuracy increases the signal udif(t) by the appropriate value of Dj (Figure 1.17) 
[17–20]. Therefore, the delay or advance in phase is possible in the joining point. 
The joining error increases the device of the DFS extreme determination. The DFS 
Figure 1.16  Relative MSD for the second approach of the frequency measurement.
Figure 1.17  DFS phase-joining errors.

24	
Counting Method of Estimation of Difference Frequency 
phase shifts increasing the process of preliminary processing can be reasons of join-
ing inaccuracies. 
Moreover, the circuit itself of extreme determination inserts the above- 
mentioned inaccuracy due to its own errors and noise presence. Using the evident 
relation Dt = DjTR/(2p), we can estimate the measurement error by duration reduc-
tion or increasing of one of the DFS periods TR in the time interval Tmod/2:
	
mod
eq
mod
mod
2
0.5
2
4
R
R
R
R
tT
T T
T
T
T
t
T
t
D
=
+
=
- D
- D 	
(1.46)
Repeating the considerations, similar to the derivation of formula (1.34), we 
obtain the equation for the relative error of range determination at presence of the 
phase joining error using the first approach for frequency measurement:
	
mod
mod
meas
st
meas
min st
1
Int
0.5
1
2
/
2
T
R
T
R
N
x
N
x
N
x
F
T N
ϕ π
δ
ì
ü
ï
ï
D
ï
ï
=
+
-
í
ý
+ D
ï
ï
+
D
ï
ï
î
þ
	
(1.47)
The phase-joining error in the second approach of measurement affects only the 
systematic component, which can be obtained in a similar manner as for (1.37):
	
2
st
min mod
R
R
x
F
T
ϕ
δ
π
D
-
D
=
-
D
	
(1.48)
From the obtained equation, it follows that owing to the joining error, the 
DC component arises in the discrete error, in which value is proportional to the 
phase shift and essentially exceeds the values of the above-mentioned components. 
Thus, the phase shift value of the tenth parts of a half-period becomes the range 
measurement error in the tenth parts of the QI, while the relative truncation error 
is of the hundredth parts. Such a ratio of errors applies the strict requirements on 
phase-frequency characteristic (PFC) of the passing path of udif(t) and the accuracy 
of extreme determination.
The phase shift arising in the stage of the preliminary DFS processing can be 
measured in advance in the form of the phase shift function versus the range Dj(R). 
We call this function the phase characteristic (PC). A knowledge of PFC allows a 
discussion of the possibility of range calculation result correction according to the 
following algorithm. 
The Algorithm of the Correction of the Range Calculation Results
The following are the steps of the algorithm of the correction of the range calcula-
tion results:
Step 1:
• 
 At measurement performance, at first, the range estimation R is cal-
culated without taking into account the phase shift.
Step 2:
• 
 According to (1.38), del
t
 is calculated.

1.8  Noise Influence on the Accuracy of the Range Determination	
25
Step 3:
• 
 According to the measured phase function versus the frequency (i.e., 
the range), the determination of the current value of the phase shift 
( )
s R
ϕ
  is 
performed.
Step 4:
• 
 The obtained phase value is used for the calculation of the joining 
moment shift in time:
	
s
st
min del
( )
2
R T
t
F
t
ϕ
π
D =
D


	
(1.49)
Step 5:
• 
 The result correction is performed:
	
(
)
st
meas
del
per
2
2
2
f
cN
R
K
T
t
K
tK
=
¢
-
- D


	
(1.50)
When necessary, steps 2 to 5 are repeated until the required calculation ­accuracy 
will not be achieved. The convergence of this procedure follows from the conver-
gence of the previous one. 
1.8  Noise Influence on the Accuracy of the Range Determination Using 
the Additive Counting Method
We mentioned earlier that the DFS processing obtained after mixing is considered. 
Therefore, we use the normal white noise x(t) as the noise model on the mixer out-
put, which has zero mathematical expectation and the energy spectrum G(w) = N0. 
Before estimation of noise influence on measurement accuracy, it is necessary 
to agree with the signal processing procedure, which permits the realization of the 
above-mentioned algorithm of the modulation control with the DFS phase joining. 
Usually at the first stage of processing, the filtering (using the narrowband track-
ing filter) of the additive mixture of the signal u(t) with the normal white noise is 
performed:
	
( )
( )
( )
s t
u t
t
ξ
=
+
	
(1.51)
Then, for the DFS zero determination, the amplification with limitation is per-
formed. The moments of the front intersection of the obtained, almost rectangular 
pulses with a zero level are taken as DFS zero positions. 
To determine the DS extreme position, the differentiation of the signal and 
noise mixture on the output of the narrowband tracking filter and amplification 
with limitation is performed. The moments of intersection of rectangular pulse 
fronts with the zero level are taken as DFS extreme positions. 
As a result of such processing, the characteristics of input noise will change. 
Furthermore, we assume that the frequency response of the narrowband tracking 
filter tuned on the signal frequency wR approaches to the Gaussian curve [23]:
	
2
2
(
)
( )
exp
2
R
H
ω
ω
ω
β
é
ù
-
=
-
ê
ú
ë
û
	
(1.52)

26	
Counting Method of Estimation of Difference Frequency 
where the parameter b is connected with the filter bandwidth: 
/
f
β
β
π
=
. After 
­narrowband filtering, the noise remains normal [23] with the correlation function 
	
0
2 2
( )
exp( 0.25
)cos(
)
2
R
N
Bς
β
τ
β τ
ω τ
π
=
-
	
(1.53)
and with the energy spectrum
	
ω
ω
ω
ω
ω
β
β
ì
ü
é
ù
é
ù
-
+
ï
ï
=
-
+
-
ê
ú
ê
ú
í
ý
ê
ú
ê
ú
ï
ï
ë
û
ë
û
î
þ
2
2
0
2
2
(
)
(
)
( )
exp
exp
2
R
R
N
G
	
(1.54)
From (1.53) at t = 0, we may obtain the equation for the noise variance on the 
output of the narrowband tracking filter:
	
0
(0)
2
N
Bς
β
π
=
	
(1.55)
As a result of differentiation of the obtained narrowband process, it remains as 
before the normal with zero mathematical expectation and the correlation function 
determined by the equation [23]:
	
( ) ( )
(
)
( )
( 1)
( )
k
l
k
k l
B
Bς
ς
ς
τ
τ
+
= -
	
(1.56)
From here we have:
	
0
2
2
2
4 2
2 2
2
2
2
2
2
2
4
( )
(
2
0.5
)
(2
)
4
4
exp( 0.25
)cos
arctan
4
2
R
R
R
R
R
N
Bς
β
τ
β
ω
τ β
τω β
π
τω β
τ β
τω
ω
β
τ β
¢
=
+
-
+
é
ù
æ
ö
-
+
ê
ú
ç
÷
+
-
è
ø
ê
ú
ë
û
´
	
(1.57) 
Substituting t = 0 into (1.57), we obtain the noise variance on the output of 
differentiation unit:
	
2
2
(0)
(0)(
0.5
)
R
B
B
ς
ς
ω
β
¢
=
+
	
(1.58)
The noise influence on the range measurement error using the method of the 
DFS phase joining is manifested in the form of two effects. The first one is increas-
ing the DFS period counting error. This effect is studied in the literature in detail, 
for instance, [24], and the error increasing, which is expressed in variation of the 
number of counted zeros of the signal and noise mixture, is connected with the SNR 
and with the duration of the signal processing interval. At a rather large SNR (more 
than 30 to 40 dB) typical for the case under consideration, this error component 
becomes negligible compared with the truncation error. 
The second effect is concerned with the error in determination the DFS extreme 
appearance moment, which leads to the error of the DFS phase joining. The influ-
ence of the phase-joining error on the measurement error was considered earlier. 

Therefore, it is enough to analyze the error characteristics of the joining moment 
determination. 
The displacement Dti of the intersect moment of the DFS signal/noise sum de-
rivative of zero level with respect to the intersection moment ti of this level with 
only one DFS derivative is obtained from the following equation: 
	
del
0 del
del
i
+
+ D
+
=
( )
sin
(
)
0
i
m
i
t
t t
U
t
t
t
ω
ω
ω
ξ
¢
¢
é
ù
ë
û
	
(1.59)
where Um is the DFS amplitude and ti can be found from the equation 
[
]
0 del
del
sin
( )
0
i
t
t t
ω
ω
+
= . The moments ti are repeated with the period of the DFS, 
but we are interested by not its modulus but its displacement characteristics. 
Assuming that the noise level is small compared with Um, we can change the 
function sinx by the power Taylor series in each point ti, saving in it one item and 
considering that the FM is provided according to the linear law, which we obtain 
after the simple transformations:
	
ξ
π
¢
D
=
2
2
2
st
i
m
T
t
U x
	
(1.60)
From (1.60) it is clear that the distribution law of the probability density for the 
displacement moment of the DFS phase joining is normal with zero mathematical 
expectation and with the following correlation function: 
	
4
2
2
2
4 2
2 2
2
4
4
2
2
2
2
2
2
4
(0)
( )
(
2
0.5
)
(2
)
2
4
exp( 0.25
)cos
arctan
4
2
st
t
R
R
m
R
R
R
B
T
B
U x
ξ
τ
β
ω
τ β
τω β
π
τω β
τ β
τω
ω
β
τ β
D
=
+
-
+
ì
ü
é
ù
ï
ï
´
-
+
í
ý
ê
ú
+
-
ï
ï
ë
û
î
þ
	
(1.61)
From this at t = 0, we obtain the displacement variance of the DFS phase-
joining moment:
	
2
2
2
st
2
1
2 /(
)
2(
)
t
x
T
q x
π
σ
π
D
+
=
	
(1.62)
where 2
2
m /[2
(0)]
q
U
Bξ
=
. Now we find the variance of the appropriate phase error:
	
2
2
1,
2
2
2
2
x
q x
ϕ
π
σ
π
D
+
=
	
(1.63)
We note that the very weak influence of the range variation on the phase shift 
MSD is observed. That is why the effect of SNR has the most significant sense. 
Therefore, it is important to know whether the existence area of Dj exceeds the 
value of ±p/2. In the case, if this exceeding is observed, the jump of the DFS phase-
joining moment occurs to the adjacent extreme (i.e., the zero number changes in 
the modulation period). Let us obtain from the condition 
1,
3
/2
ϕ
σ
π
D
£
 the range 
1.8  Noise Influence on the Accuracy of the Range Determination	
27

28	
Counting Method of Estimation of Difference Frequency 
of boundary values of q, at which this event does not yet arise in the range from 
st
R
δ
 to ¥:
	
2
3 2
2
1
1.727
1.35
q
x
π
π
³
+
=
…
	
(1.64)
Hence, one can state with confidence that if the SNR exceeds 5 dB, the jump of 
the DFS phase-joining moment is not observed. We are interested with much higher 
values of q; therefore, we do not take into account the phenomenon of the DFS 
phase-joining jump to the adjacent extreme. 
In connection with the fact that in each separate period the additional DFS ze-
ros do not increase, the variation of the total number of zeros occurs only owing to 
the boundary displacement of the last modulation period with respect to the mea-
surement interval boundary at the displacement of the joining moment under the 
noise influence. Therefore, the number of zeros fallen into this interval varies and so 
we cannot use the formula (1.47) directly. Now we must take into account the total 
phase shift, which changes the DFS number of periods stacked in the remainder of 
measurement interval. 
Starting from this, (1.47) can be rewritten in the form:
	
mod
meas
st
meas
min st
T
1
Int
0.5
1
2
2
R
R
N
x
x
N
x
F
T N
ϕ
δ
π
S
ì
ü
ï
ï
D
ï
ï
=
-
+
-
í
ý
ï
ï
+
D
ï
ï
î
þ
	
(1.65)
where jS is the total phase shift of the right boundary of the last modulation period 
in the measuring interval owing to the phase error on the boundary of each modula-
tion half-period, that is,
	
2
1
K
i
i
ϕ
ϕ
S
=
=
D
å
	
(1.66)
It is clear from [24] that the distribution law of jS remains normal with zero 
mathematical expectation and with the following variance:
	
2
2
2
1
1
l
k
K
K
lk
l
k
R
φ
φ
ϕ
σ
σ
σ
S
D
D
=
=
= åå
	
(1.67)
where 
lφ
σD  and 
k
φ
σD  are the MSD of the DFS phase joining error in time moments 
lTst and kTst, respectively, and Rlk is the correlation coefficient between the values 
of the phase-joining error in these time moments.
Now we can write:
	
2
2
2
mod
2
2
1
(
2)
1
1
(0.5
)
2
K
k
K
x
B
kT
K
x q
ξ
ϕ
π
σ
π
S
¢
=
é
ù
+
=
+
ê
ú
ê
ú
ë
û
å
	
(1.68)
where 
( )
( )/
(0)
B
B
B
ξ
ξ
ξ
τ
τ
¢
¢
¢
=
.

At the determination of the range measurement error variance for the first 
approach of frequency estimation, it is necessary to take into consideration that, 
in accordance with (1.65), the nonlinear transformation of the normally distrib-
uted random variable jS with the variance determined by the formula (1.68) is 
provided. Nonlinearity is specified by the function Int(*) having the view of the 
stepwise line at jS increasing. In this case, the variation of measured range as a 
result of the joining error under noise influence happens only after the sum in 
(1.65) will exceed the value multiple to p. In the interval between these moments, 
there are no variations of measurement results. Taking into consideration that 
the mathematical expectation of the total phase deviation (1.65) is equal to zero, 
we can determine the relative variance of measurement results 
2
1
/
st
R
R
σ
δ
D
 on the 
basis of the first ­approach of the frequency measurement by means of summa-
tion of discrete values of calculation deviations according to (1.65) with weights 
equal to the probability of sum (1.65) falling in the appropriate interval of the 
phase shift values:
	
{
}
max
min
2
2
1
2
2
meas
1
[(
1) ]
(
)
st
L
R
L
R
L
F L
F L
N
σ
π
π
δ
=
+
-
å
	
(1.69)
where 
{
}
min
0
0
Int
3
/
Int{
}
L
ϕ
ϕ
σ
π
ϕ
D
=
-
-
; 
mod
meas
0
min st
T
0.5
1
2
N
x
x
F
T N
ϕ =
+
+
D
; 
Lmax = Int{j0 + 3sDj/p} – Int{j0} + 1; ( )
F ·  is the integral function of the normal dis-
tribution law of probabilities and 
2
ϕ
σD  is ­defined by (1.68).
As we see, in this case, a variance of measurement error depends in the compli-
cated manner upon Nmeas, that is, upon measurement interval duration. Therefore, 
to estimate the quality of the processing algorithm, the formula (1.69) is unsuitable. 
For this purpose, we use the result of error averaging over some range interval. The 
value of averaging interval can be chosen equal to ED because the variation of the 
DFS zero number happens with the range variation with exactly this step. We write 
the equation in a discrete form for calculations on the PC, where we consider in an 
explicit form the function of the error versus the range:
	
2
1
aver,
1
laver
1
2
2
0
(
)
1
(
)
R
R
N
i
ki
R
k
Rst
Rst
R
R
R
N
σ
σ
δ
δ
-
D
=
=
å
	
(1.70)
where 
aver,
0.5(2
1)
i
Rst
R
i
δ
=
+
, i = 1, 2, …, 
st
(
/
)
ki
R
R
R
i
k N
δ
=
+
, and NR is a number 
of considered points of range in the segment with the length DRst.
At the second approach of frequency estimation after carrying out (1.64), ad-
ditional DFS zeros do not exist in the measuring interval under noise influence. The 
measurement error is caused by a variation of the processing interval duration hap-
pening due to the random variation of the phase-joining moments. In accordance 
with (1.34), we can write the relative variance 
2
2
st
2
/
R
R
σ
δ
D
 of the range measurement 
error on the basis of the second approach of frequency measurement as:
1.8  Noise Influence on the Accuracy of the Range Determination	
29

30	
Counting Method of Estimation of Difference Frequency 
	
mod
2
2
2
2
st
2
mod
st
mod
mod
mod
1
1
2 /(
)
1
1
(0.5
)
(
)
2
N
R
R
k
T
x
B
kT
N
qT
N
ξ
π
σ
δ
π
=
é
ù
+
é
ù
ë
û
=
+
¢
ê
ú
ê
ú
ë
û
å
	
(1.71)
where Tmod is defined by (1.28).
The analysis of (1.68) and (1.71) shows that at range variation the measure-
ment error slightly changes. The calculation results on (1.70) for the errors (1.69) 
and (1.71) are shown in Figure 1.18 in the form of the logarithm of the relative 
MSD of the measurement error versus the measured range at q = 40 dB. Therefore, 
for the second approach, two plots are drawn at Nmod = 0.5 (estimation for one 
period) and Nmod = 50. For the first approach of frequency estimation, the plot cor-
responds to Nmod = 50.
We see that for this approach the error does not practically change at range 
variation. At the second approach the error variation takes place at range varia-
tion, but it is insignificant and we may neglect it. The function of the measurement 
error versus the noise level is more interesting for us. Therefore, it is expedient to 
compare two approaches of frequency estimation. 
Figure 1.19 shows plots of the logarithm function of the relative MSD of the range 
measurement versus the SNR drawn according to (1.70), taking into account (1.69) and 
(1.71) for the above-mentioned processing parameters and 2DFminTst = 5,000,000.
We see that the plot for the first approach of the difference frequency measure-
ment at some SNR intersects the plot corresponding to the second approach for one 
modulation half-period. Hence, the second approach of the frequency estimation 
using the mode of the DFS phase-joining is more effective. A prolongation of the 
measuring interval at the expense of the number increase of the processed modula-
tion half-periods leads to an essential decrease of the measurement error. 
Figure 1.18  The function of the logarithm of the relative MSD of the measurement error versus the 
normalized range. 

1.9  Conclusions	
31
1.9  Conclusions
We investigated the known counting method of the difference frequency estimation 
for the adaptive control of modulation parameters, which eliminates DFS phase 
jumps and allows increasing the averaging interval at the estimation of the differ-
ence frequency. Conditions were determined that ensure the mode of phase joining, 
and a control algorithm of modulation parameters was suggested, which will pro-
vide stability of the average slope of increasing FM. 
An approach for difference frequency estimation was offered, which is possible 
in the phase-joining mode only, based on counting the DFS period number during 
a fixed modulation period number and on the duration estimation of the obtained 
measuring time interval. The truncation error of range measurement was analyzed 
and it was shown that the approach presented provides an error approximately two 
times less compared with the known method. 
A calculation result correction procedure was offered, allowing at the first cor-
rection step a decrease of the measurement error by 1,000 times. 
It was shown that the phase-joining error caused by the phase shift in stages 
of preliminary DFS analog processing leads to an appearance of the constant bias 
of readings and a correction procedure for the above-mentioned component of the 
measurement error was offered. 
We showed that our approach to difference frequency estimation allows obtain-
ing acceptable values of measurement errors even for an essential noise level due to 
long accumulation by using the phase-joining mode.
References
[1]	
Vinitskiy, A. S., Essay on Radar Fundamentals for Continuous-Wave Radiation, Moscow, 
Russia: Sovetskoe Radio Publ., 1961. [In Russian.]
[2]	
Kogan, I. M., Short-Range Radar Technology (Theoretical Bases), Moscow, Russia: Sovets-
koe radio Publ., 1973. [In Russian.]
Figure 1.19  The function of logarithm of the relative MSD of the measurement error versus the SNR.

32	
Counting Method of Estimation of Difference Frequency 
[3]	
Brumbi, D., Fundamentals of Radar Technology for Level Gauging, 3rd rev., Duisburg: 
Krohne Messtechnik, 1999.
[4]	
Bakulev, P. A., Radar Systems, Moscow, Russia: Radiotekhnika Publ., 2004. [In Russian.]
[5]	
Komarov, I. V., and S. M. Smolskiy, Fundamentals of Short-Range FMCW Radar, Nor-
wood, MA: Artech House, 2003.
[6]	
Atayants, B. A., et al., “Precision Industrial Systems of FMCW Short-Range Radar Tech-
nology: Truncation Measurement Error and Its Minimization,” Uspekhi sovremennoi ra-
dioelektroniki, No. 2, 2008, pp. 3–23. [In Russian.]
[7]	
Skolnik, M., Introduction to Radar Systems, 3rd ed., New York: McGraw-Hill, 1981. 
[8]	
Korn, G., and T. Korn, Mathematical Handbook for Scientists and Engineers, New York: 
McGraw-Hill, 1961.
[9]	
Zhukovskiy, A. P., E. I. Onoprienko, and V. I. Chizhov, Theoretical Fundamentals of Radio 
Altimetry, Moscow, Russia: Sovetskoe Radio Publ., 1979. [In Russian.]
[10]	 Sokolinskiy, V. S., and V. G. Sheinkman, Frequency and Phase Modulators and Manipula-
tors, Moscow, Russia: Radio i Sviaz Publ., 1983. [In Russian.]
[11]	 Imada, H., and Y. Kawata, “New Measuring Method for a Microwave Range Meter,” 
Kobe Steel Eng. Repts., Vol. 30, No. 4, 1980, pp. 79–82.
[12]	 U.S. Patent 5070730, Int. CI. G01F 23/28. “Device for Level Gauging with Microwave,” 
K. O. Edvardsson. No. 613574. Filed March 27, 1990; date of patent December 10, 1991.
[13]	 Weib, M., and R. Knochel, “A Highly Accurate Multi-Target Microwave Ranging System 
for Measuring Liquid Levels in Tanks,” IEEE MTT-S International Microwave Symposium 
Digest, Vol. 3, 1997, pp. 1103–1112.
[14]	 Patent 2126145 (Russian Federation), INT.CL. G01F 23/284. “Level-Meter,” S. A. Liber-
man, et al., No. 97114261/28. Bull. No. 4. Filed August 20, 1997; published October 2, 
1999.
[15]	 Atayants, B. A., et al., “Noise Problem and Non-Linearity of Transmitter Modulation 
Characteristic in Precision Industrial Short-Range FMCW Radar Systems,” Uspekhi sovre-
mennoi radioelektroniki, No. 3, 2008, p. 3–29. [In Russian.]
[16]	 Patent No. 2159923 (Russian Federation). INT. CL. G01F 23/284. “Radar Level-Meter,” 
B. A. Atayants, V. V. Ezerskiy, and A. I. Smutov. No. 99104759/28. Bull. No. 33. Filed 
March 4, 1999; published November 27, 2000. 
[17]	 Atayants, B. A., et al., “Adaptive Frequency-Modulated Level-Meter,” Radar Technology, 
Navigation and Communication: Proceedings of VI Intern. Conf., Voronezh, Vol. 3. 2000, 
pp. 1686–1696. [In Russian.]
[18]	 Atayants, B. A., et al., “Non-Contact Radio Wave Distance Sensor of Higher Accuracy and 
Stability,” Sensors and Information Transducers for Systems of Measurement, Checking 
and Control: Proceeding of XIII Conf., Gurzuf, 2001, pp. 246–247. [In Russian.]
[19]	 Ezerskiy, V. V., B. V. Kagalenko, and V. A. Bolonin, “Adaptive Frequency-Modulated Level 
Meter: An Analysis of Measurement Error Components,” Sensors and Systems, No. 7, 
2002, p. 44. [In Russian.]
[20]	 Patent No. 2151408 (Russian Federation). INT. CL. G01S 13/34. “Radar Range Finder,” 
B. F. Atayants, et al. Bull. No. 17. Published June 20, 2000. 
[21]	 Ezerskiy, V. V., “An Analysis of a Truncation Error of a Range Finder with Adaptive Fre-
quency Modulation for Short-Range Radar,” Vestnik RGRTA, Ryazan. No. 15, 2004, 
pp. 40–45. [In Russian.]
[22]	 Brillinger, D. R., Time Series: Data Analysis and Theory, New York: Holt, Rinehart and 
Winston, 1975.
[23]	 Levin, B. R., Theoretical Fundamentals of Statistical Radio Engineering, in three volumes. 
2nd ed., Moscow, Russia: Sovetskoe Radio Publ., 1974. [In Russian.]
[24]	 Tikhonov, V. I., and V. N. Kharisov, Statistical Analysis and Synthesis of Radio Engineering 
Devices and Systems, Moscow, Russia: Radio i Sviaz Publ., 1991. [In Russian.]

33
Weighting Method for the Difference 
Frequency Averaging
2.1  Introduction
The application of the weighting method for the difference frequency averaging for 
the QI smoothing of the FMCW RF was offered for the first time in [1–3]. In gen-
eral, the weighted estimation of the DFS is performed in accordance with [3] as:
	
an
DFS
0
( )
( )
T
S
t F
t dt
α
= ò
	
(2.1)
where Tan is the interval of frequency analysis and a(t) ³ 0 is the weighting function 
(WF) satisfying the following normalization condition:
	
an
an
0
( )
1
T
t dt
T
α
=
ò
	
(2.2)
Taking (1.10) into account, we may rewrite (2.1) as:
	
an
del
0
( ) ( )
T
S
t
t f t dt
α
=
¢
ò
	
(2.3)
For the usual symmetric triangle modulation function (1.4) with the period Tmod, 
one chooses Tan = Tmod/2 and WF has a period Tmod/2. Substituting these param-
eters in (2.3) and taking into account the normalization condition, we obtain:
	
mod
2
del
del
WF
0
( ) ( )
2
T
S
t
t f t dt
t
FK
α
=
=
D
¢
ò
	
(2.4)
where 
mod/2
WF
mod
0
1
( ) ( )
2
T
K
t f t dt
FT
α
=
¢
D
ò
 is the constant coefficient depending on 
the WF shape and the FM function. At the linear FM, KWF = 1 with an account of 
the normalization condition (2.2). Therefore, the measuring range is determined 
by the following equation:
	
WF
/
R
R
S K
δ
=
	
(2.5)
c h a p t e r  2

34	
Weighting Method for the Difference Frequency Averaging
At the practical implementation of the weighting method, the estimation of S

 for 
(2.5) can be obtained approximately by means of numerical calculation of the inte-
gral (2.1) according to the rectangular formula [4]:
	
DFS
1
( )
( )
N
i
i
i
i
S
t F
t
α
=
=
D
å

	
(2.6)
where ti are interpolation nodes, N is the number of interpolation modes, and Di is 
its step. 
If the interpolation step in (2.6) that we assume equals half of the instantaneous 
value of DFS period Di = 0.5TDFSi(ti) = 1/[2FDFS(ti)], that is, to choose the physically 
existed DFS zeros as interpolation points, we obtain the calculation equation:
	
1
( )
N
i
i
S
t
α
=
= å

	
(2.7)
where ti is the position of the ith zero of the DFS and N is the number of the DFS 
zeros in the modulation half-period.
In such a way, at the final counting, the different weight can be attributed to 
different DFS zeros. To eliminate the discreteness error, the weighting coefficients 
closed to zero are attributed to zeros, which are located inside the analysis interval 
in the immediate vicinity to boundaries. As far as zeros will move off from analysis 
interval boundaries, the increase of the weighting coefficient value occurs. In this 
case, at the range variation, the zero, which appears again in the analysis interval 
(or disappears from the analysis interval), does not lead to discrete variation by one 
of the accumulated results. The smooth zero elimination from the boundaries of the 
analysis interval leads to a smooth variation of the measurement result. 
The mentioned procedure is illustrated in Figure 2.1, where the plots of the 
DFS phase variations [Figure 2.1(a)], the DFS itself [Figure 2.1(b)], and the WF a(t) 
[Figure 2.1(c)] are shown. 
The specific position of zeros and their number in accordance with (1.9) is given 
by the following equation [see Figure 2.1(a)]:
	
0 del
del
1
( )
0.5
(
);
1,2,
,
i
s
t
t t
i
I
i
N
ω
ω
ϕ
π
π
+
+
=
+
+
=
…
	
(2.8)
where w0 = 2pf0, w(t) = 2p(f), I1 = Int(2f0tdel – 0.5), and f0 is the carrier frequency 
of the signal. 
Equation (2.7) allows a rather simple implementation of the weighting smooth 
method. Therefore, it is necessary to take into account the following factors:
The range calculation according to (2.5) is possible only at the exact knowl-
1.	
edge of the FM sweep of the SHF oscillator.
It is necessary to carry out good preliminary filtering for the exact determi-
2.	
nation of the DFS zero position used in (2.7), which is possible at the phase 
jump absence only. 

2.1  Introduction	
35
These considerations lead to the necessity of an additional operation performance, 
which was suggested earlier regarding the monitoring of the boundary frequencies of 
the analysis interval and the ensuring of the DFS phase continuity (phase joining). 
The sources of measurement errors in the method of smooth weighting (besides 
the instability of the FM sweep that is common for all methods) are:
The estimation of 
• 
S
 according to approximated (2.7), that is, the truncation 
error;
The difference of the real frequency modulation law from the specified law 
• 
owing to the MC nonlinearity;
The error estimation of moments 
• 
ti of the difference signal transition through 
zero due to the noise presence;
The determination error of the WF samples 
• 
ai(ti).
Figure 2.1  Illustration of the weighting averaging method for the difference frequency.

36	
Weighting Method for the Difference Frequency Averaging
2.2  The Truncation Error of the Weighting Method of Difference 
Frequency Averaging
Let us consider the first component, which factually is the error of numerical calcu-
lation of the integral (2.1). 
The analysis of the truncation error for which we provide the WF class is wide 
enough. We have mentioned that from heuristic considerations WF should be 
symmetric with respect to the middle of the analysis interval and reduce its ends 
practically up to zero. Therefore, we examine the WF family [4], allowing its repre-
sentation in the form of the trigonometric Fourier series:
	
mod
0
( )
cos(4
/
)
K
W
m
m
t
K
A
mt T
α
π
=
=
å
	
(2.9)
where 
mod / 2
mod
mod
0
2
( )cos(4
/
)
/
T
m
A
t
mt T
dt T
α
π
=
ò
, m = 0, 1, 2, …, K, and KW is a nor-
malizing multiplier, which is KW = 1/A0 in accordance with (2.2). 
Following the normalization of (2.9), it is necessary to perform the condition of 
equality to the zero WF value coefficients on boundaries of the analysis interval:
	
0
0
K
m
m
A
=
=
å
	
(2.10)
Now we substitute (2.10) into (2.7):
	
mod
0
1
cos(4
/
)
K
N
W
m
i
m
i
S
K
A
mt T
π
=
=
=
å
å

	
(2.11) 
This equation can be reduced to the more convenient form if the internal series 
would be represented on the basis of known equation [5]:
	
1
sin(
)
cos[
2(
1) ]
cos[
(
1) ] sin
N
m
Ny
x
m
y
x
n
y
y
=
+
-
=
+
-
å
	
(2.12)
With this purpose, we provide the argument transformation of the cosine function 
in (2.11) to the table from (2.12) using the normalized time [3]: tnorm,i = 2ti/Tmod. 
Assuming that the FM is performed in accordance with the linear law (1.4), we can 
transform (2.8) on the increasing part of the frequency variation as:
	
0
1
mod
4
/
8
0.5
i
s
t
f R c
FR
i
I
T
c
ϕ
π
+ D
+
=
+ +
	
(2.13)
From here we obtain the equation for the normalized DFS zeros:
	
norm,
(
/ )
i
s
t
i
ε
ϕ π η
=
-
-
	
(2.14)

2.2  The Truncation Error of the Weighting Method of Difference Frequency Averaging	
37
where e = r – Int(r); r = (4f0R/c – 0.5) is reduced by 0.5 the number of quarter-
wavelengths of the carrying oscillation with the frequency f0 stacked in the range to 
be measured, 1/h = R/dR = xR = M + c is the range to be measured normalized to the 
QI value, and M = Int(R/dR) and c = R/dR – M are, respectively, the integer and frac-
tion parts of the number of discreteness error stacked in the range to be measured.
Now we may write, separating the item corresponding to m = 0:
	
1
sin(
)
cos
2 1
1
sin(
)
K
s
W
m
m
N m
S
N
K
A
m
N
m
ϕ
π
η
π
η
ε
π
π
η
=
ì
ü
é
ù
æ
ö
=
+
-
-
+
-
í
ý
ç
÷
ê
ú
è
ø
ë
û
î
þ
å

	
(2.15)
Then, having not missed the consideration generality, we assume that js = 0. For 
further calculation, the relation between variables e and c determining the DFS 
zero number N during the half-period of modulation, and, hence, the upper limit 
of summing in (2.7), (2.9), and (2.15), has the essential significance. It is known 
[6] that the number of the DFS zeros on the half-period of modulation is N = M or 
N = M + 1. From the definition of the normalized time in (2.14), it follows that in 
the time interval [0, Tmod/2] the condition tnorm,i < 1 is performed. Hence, for the 
zero with a maximal number i = N, the equation is true:
	
1
1
N
N
M
M
ε
ε
χ
χ
-
+
+
£
£
+
+
	
(2.16)
If the inequality 1 - e ³ c is performed, for carrying out the right part of inequality 
(2.16) it is enough that N = M. Otherwise, that is, at the performance of inequality 1 - 
e < c, we obtain N = M + 1. The variation of the relation between variables 1 - e and c 
at the range variation and, accordingly, the variation of N are shown in Figure 2.2.
Taking into consideration the above-mentioned and the reduction formulas [5], 
we obtain from (2.15) for both cases under investigation the following relations 
between variables 1 - e and c:
	
1
1
2
1
[
]
1
1
[
]
1
K
W
m
m
K
W
m
m
M
K
A G m
for
S
M
K
A G m
for
η
ε
χ
η
ε
χ
=
=
ì
ü
-
-
³
ï
ï
ï
ï
= í
ý
ï
ï
+
+
-
£
ï
ï
î
þ
å
å

	
(2.17)
where 
1
1
sin[
(1
)]
[ ]
[ , , ]
cos[
(1
2
)]
sin(
)
z
G z
G z
z
z
π
χ
χ ε
π
ε
χ
π
-
=
=
-
-
2
2
sin[
(1
)]
[ ]
[ , , ]
cos[
(2
2
)]
sin(
)
z
G z
G z
z
z
π
χ
χ ε
π
ε
χ
π
-
=
=
-
-
In the formula (2.17), the functions G1[*] and G2[*] are the functions of three 
arguments. However, in many cases, dependence upon the first argument is deter-
minative. Therefore, to reduce writing , the other two arguments will be taken into 
account in an explicit form only in cases when it is necessary for the specific situation. 
From (2.5) and (2.14), it follows that the exact value is 
/
R
R
S
x
R
M
δ
χ
=
=
=
+

. That 

38	
Weighting Method for the Difference Frequency Averaging
is why, summing and subtracting in each line of (2.17) the quantity c, we obtain the 
equation for the error DS:
	
1
1
2
1
[
]
for
1
1
[
]
for
1
K
W
m
m
S
K
W
m
m
K
A G m
K
A G m
χ
η
ε
χ
χ
η
ε
χ
=
=
ì
-
-
-
³
ï
ï
D = í
ï +
+
-
<
ïî
å
å
	
(2.18)
The obtained formulas allow a calculation of the truncation error of range 
measurement using WF of the arbitrary type (2.9).
Many functions are known to satisfy requirements (2.2) and (2.10). For in-
stance, a great number of functions are used at spectral analysis [7–10] for the 
reduction of the sidelobe levels. We examine in detail the family of functions:
	
mod
( )
[1
cos(4
/
)]n
W
t
K
t T
α
π
=
-
	
(2.19)
where KW is the normalizing multiplier and n = 1, 2, ….
The plots of these functions for some n are presented in Figure 2.3. In [3] the 
similar WF for the case n = 1 is examined, as well as the exact function of the 
­measurement error versus the measuring range. We obtain similar relations for 
the measurement error estimation at arbitrary n.
Figure 2.2  Dependence of the DFS zero number versus the normalized range.

2.2  The Truncation Error of the Weighting Method of Difference Frequency Averaging	
39
Let us determine the value of normalizing coefficient KW. Using the known 
trigonometric relation and the expansion of the sine function of even power into a 
series [5], we may represent the WF (2.19) as:
	
1
2
2
0
( )
2
( 1) 2
( 1)
cos[(
) ]
n
j
n
n
j
n
W
n
n
j
K
C
n
j
C
α ν
ν
-
-
=
ì
ü
ï
ï
=
-
-
-
+
í
ý
ï
ï
î
þ
å
	
(2.20)
where 
mod
4
/t T
ν
π
=
 and 
q
p
C  is a binomial coefficient [5].
Now we can find from (2.2):
	
2
2 /
n
n
W
n
K
C
=
	
(2.21)
Taking into account (2.21) and (2.15), we can rewrite (2.18) as:
	
1
1
2
0
2
1
2
2
0
2
2( 1)
( 1)
[(
1) ]
for
1
2( 1)
( 1)
[(
) ]
1
for
1
n
j
n
j
n
j
n
n
Sn
n
j
j
n
j
n
n
C
G
n
C
C
G
n
j
C
η
χ
ε
χ
η
χ
ε
χ
=
=
-
=
ì
-
-
-
ï
ï-
-
-
³
ïï
D
= í
ï
-
-
-
ï
ï -
+
-
<
ïî
å
å
	
(2.22)
where the index n in the error DSn designation corresponds to an exponent in (2.19).
Let us perform the quantitative estimation of the above-mentioned errors at 
various ranges. The character of their variation principally differs from cases of 
very small ranges (less than 4dR) and of all others. 
The plots of measurement errors DS1, DS2, and DS4 are presented in Figure 2.4.
Figure 2.3  Weighting functions.

40	
Weighting Method for the Difference Frequency Averaging
From the presented plots, we see that for the examined WFs the error is a 
periodic damping function of the range. As well, at small ranges, the monotonic 
decrease of the total error level is observed for increasing range. Exactly zero errors 
are observed on those ranges, when the DFS zeros as the interpolation points are 
located symmetrically with respect to a center of the analysis interval. In this posi-
tion, the error of the numerical calculation of the integral (2.1) on the left WF slope 
is equal in value and opposite in sign to the similar error arising on the right slope 
and their mutual compensation happens.  
In the point at which the envelope is equal to zero, the interpolation point 
position is symmetrical with respect to the analysis interval center and the end 
points coincide with the interval boundaries. We call these points the envelope 
Figure 2.4  (a–c) Functions of the relative measurement error versus the normalized range.

2.2  The Truncation Error of the Weighting Method of Difference Frequency Averaging	
41
nodes (ENs). At the transfer through each such range point, the DFS zero number 
increases by one, that is, the increase of interpolation points’ number is provided 
at the numerical calculation of the integral in  (2.1). Therefore, there is a reduction 
of the calculation error. The quantitative values of the error, the speed of its damp-
ing with increasing range, and the range point, from which the second periodicity 
begins to be manifested, depend upon the exponent n.
The plots of functions of measurement errors versus the range for various WFs 
in the form presented in Figures 2.4 and 2.5 are inconvenient. It is expedient to use 
some generalized quantity related to the total error level. For example, it can be the 
envelope of these plots. However, it is difficult to determine it. 
Earlier for this purpose, the integral characteristic (1.70) was introduced equal 
to the MSD calculated over the range interval. In conformity with the given case, 
(1.70) can be rewritten as:
	
2
2
2
,
1
(
)
(
)/
L
M k
S
S
k
M
R
L
σD
=
= D
=
D
å
	
(2.23)
where L = dR/D, D is a step in range within the limits of the one discrete averaging 
segment in range [MdR, (M + 1)dR]; and RM,k = MdR + (k – 1)D is the kth range 
reading within the limits of the specified Mth segment of averaging. 
Figure 2.5 shows error plots calculated according to (2.23) using (2.22). 
The general view of plots and quantitative relations between truncation errors 
corresponding to different WFs strongly depend upon the function type and the 
range. The smooth decrease of the total error level is observed at the increasing 
range R. For a small range, the error values corresponding to WFs with the large 
value of n exceed the errors obtained for small values of n; however, its speed of 
reduction is more. 
When the range increases, the picture changes. At large ranges, a smaller error 
and a higher damping speed correspond to higher values of n, while the truncation 
error level essentially decreases when the range increases. 
Figure 2.5  The function of normalized MSD versus the relative range.

42	
Weighting Method for the Difference Frequency Averaging
One more WF is interesting; it has only one shape parameter, allowing the WF 
shape to change to a great extent. This is the Kaiser-Bessel (KB) WF [8], which has 
the following analytical record in the closed form:
	
2
0
mod
mod
mod
0
2
I
1
( )
,
[
/4,
/4]
I [
]
t
a
T
t
t
T
T
a
π
α
π
é
ù
æ
ö
ê
ú
- ç
÷
ê
ú
è
ø
ë
û
=
Î -
	
(2.24)
where I0[*] is the modified Bessel function of the first kind [5] and a is a parameter 
specifying the function shape. In such a view, this function is used during the spec-
tral analysis and it is normalized to 1. In our case, it is necessary that the WF would 
satisfy the normalization condition (2.2). Using the equation I0(x) = J0(jx), where 
J0[*] is the Bessel function of the first kind, which is known as the integral [11]:
	
(
)
2
2
0
0
sin
y
J
y
x
dx
y
-
=
ò
	
(2.25)
and presenting:
	
sin
2
jy
jy
e
e
y
-
-
=
	
(2.26)
we can obtain the formula for the WF KB with the required normalization:
	
2
0
mod
2
2
( )
I
1
a
a
a
t
t
a
T
e
e
π
π
π
α
π
-
é
ù
æ
ö
ê
ú
=
- ç
÷
ê
ú
è
ø
-
ë
û
	
(2.27)
Taking into account that the real values a > 1 can be written with high accuracy 
as:
	
2
0
mod
mod
mod
2
( )
2
I
1
,
[
/4,
/4]
a
t
t
ae
a
t
T
T
T
π
α
π
π
-
é
ù
æ
ö
ê
ú
=
-
Î -
ç
÷
ê
ú
è
ø
ë
û
	
(2.28)
such a WF is suitable by the fact that only one parameter a changes its shape in wide 
limits. However, it does not have the second WF property of decreasing to zero on 
boundaries of the interval Tmod, although the difference from zero is very small and 
decreases with the a parameter increasing.
A change of the WF shape (2.28) at the variation of the a parameter is shown 
in Figure 2.6.
Substituting (2.28) into (2.7), we obtain [12]:
	
2
0
mod
1
2
2
1
N
i
a
i
t
S
ae
I
a
T
π
π
π
-
=
é
ù
æ
ö
ê
ú
=
- ç
÷
ê
ú
è
ø
ë
û
å

	
(2.29)

2.2  The Truncation Error of the Weighting Method of Difference Frequency Averaging	
43
2.2  The Truncation Error of the Weighting Method of Difference Frequency Averaging	
43
Using in (2.29) the normalized time (2.14), we obtain:
	
2
2
0
1
2
I
1
(
1
)
N
a
i
S
ae
a
i
π
π
π
ε
η
-
=
é
ù
=
-
-
+
ê
ú
ë
û
å

	
(2.30)
Taking into account that N = M for e ³ c or N = M + 1 for e < c, we can write:
	
2
2
0
1
1
2
2
0
1
I
1
(
1
)
for
2
I
1
(
1
)
for
M
i
a
M
i
a
i
S
ae
a
i
π
π
ε η
ε
χ
π
π
ε
η
ε
χ
=
-
+
=
ì
é
ù
-
-
+
³
ï
ê
ú
ë
û
ï
=
í
ï
é
ù
-
-
+
<
ï
ê
ú
ë
û
î
å
å

	
(2.31)
In a similar manner as in (2.18), we obtain equations for the error DS taking 
into account that the exact value of S
M
χ
=
+

:
	
2
2
0
1
1
2
2
0
1
1
(
1
)
for
2
1
(
1
)
for
M
i
a
S
M
i
I
a
i
M
ae
I
a
i
π
π
ε
η
ε
χ
χ
π
π
ε
η
ε
χ
=
-
+
=
ì
é
ù
-
-
+
³
ï
ê
ú
ë
û
ï
D = -
-
+
í
ï
é
ù
-
-
+
<
ï
ê
ú
ë
û
î
å
å
	
(2.32)
The results of the error calculation in accordance with (2.32) for three parameter 
values a = 2, 4, 6 are presented in Figure 2.7. As we see, similar to Figure 2.4, the 
error is the periodic damping function of the range. Two types of periodicity are 
Figure 2.6  The WF KB profile at variation of the a parameter. 

44	
Weighting Method for the Difference Frequency Averaging
observed. The first one has a period equal to a half-wavelength of the carrier oscilla-
tion. The second one has the alternating period. The variation of the second period 
is stronger, manifested with the a parameter increasing. The error decreases very 
quickly, with the range increasing except for small ranges when M(R) < 3…4, and 
the error may be largely inadmissible. The quantitative values of the error and its 
damping speed at the increased range depend upon the value of the WF a parameter. 
Based on these figures, it is rather difficult to compare WFs with different values of 
the parameter a.
Figure 2.8 shows average functions, in accordance with (2.23), of the normalized 
error versus the normalized range for four values of the parameter a = 2, 4, 6, and 8.
Figure 2.7  The functions of the instantaneous normalized error versus the normalized range.

From Figure 2.8, we see that in all plots two regions can be distinguished: the 
initial part in which the error sharply changes and the part in which the averaged 
error is not practically changed at the range variation. It is clear that at the range 
variation one can find such a value of the parameter a, at which the minimum of the 
average error for a given range is achieved. This is the minimal value of the error 
that can be designated in Figure 2.8 to draw the tangent to these plots in the points 
of inflection.
2.3  Truncation Error Minimization at the Weighting Average  
Method of Difference Frequency by Optimization of 
Weighting Function Parameters 
Equation (2.23) permits the formulation of the problem of the parametric optimiza-
tion of WF a(t) in (2.9), consisting in the selection of coefficients Am with the pur-
pose of minimization of the truncation measurement error [13]. The function of the 
measurement error’s MSD (2.23) versus the range is the complex function, which 
quickly decreases while the range increases. Therefore, it is expedient to provide the 
local coefficient optimization trying to minimize the error within the limits of some 
of the averaging parts in the range. 
It was suggested earlier to calculate MSD on the range parts equal to the value 
of one QI, that is, within the limits
	
( )
[
( )
1]
R
R
M R
R
M R
δ
δ
<
<
+
	
(2.33)
For each such a part, we can determine the set of coefficients corresponding to 
the minimum of the error’s average square. For the optimization of the coefficients 
Am, we can obtain the system of linear equation:
	
2(
)
0,
1,2,
S
m
d
M
m
K
dA
D
=
=
… 	
(2.34)
Figure 2.8  The function of the normalized averaged error versus the normalized range.
2.3  Truncation Error Minimization: Weighting Function Parameters	
45

46	
Weighting Method for the Difference Frequency Averaging
Substituting (2.18) into (2.34), we reduce the equation system with respect to the 
unknown values of the coefficients Am to the standard form:
	
,
1
(
)
(
),
1,2,
K
m i m
i
m
A d
M
D M
i
K
=
=
=
∑
… 	
(2.35)
where 
m
W
m
A
K
A
=
 are the normalized values of Fourier series coefficients for WF:
	
,
1
,
2
,
1
1
1
1
1
2
2
1
2
2
1
1
(
)
( ,
,
);
(
)
( ,
);
[
( )]
[
( )]
for
1
( )
( )
( ,
, )
;
[
( )]
[
( )]
for
1
( )
( )
( )
[
( )]
for
1
( )
( )
( , )
[1
( )]
[
( )]
for
1
( )
( )
L
L
i m
M k
i
M k
R
R
k
k
d
M
F i m R
D M
F i R
G i
R G m R
R
R
F i m R
G i
R G m R
R
R
R G i
R
R
R
F i R
R G i
R
R
R
δ
δ
η
η
ε
χ
η
η
ε
χ
χ
η
ε
χ
χ
η
ε
χ
=
=
=
=
-
³
ì
= í
-
<
î
-
³
ì
= í
-
-
<
å
å
î
Here we note in an explicit form the function of the main parameters versus 
range [c(R), e(R), h(r)]. The obtained equation system allows the calculation of the 
WF optimal parameter sets on each Mth part for the given value of K, that is, to 
provide the local WF optimization of the specified view.
The calculation results of optimal coefficients according to (2.35) for several 
values of K are shown in Table 2.1.
We should note that at a small range the values of optimal coefficients strongly 
differ from the initial coefficients for used WFs. With the range increasing, the 
optimal coefficients tend to these initial values, which can be seen from the plots 
presented in Figures 2.9, that is, the known WFs give the best results only for the 
measurement of large ranges. 
The variation of the shape of the optimal WFs (2.9) at a variation of measured 
range is shown in Figure 2.9(a) for K = 1 and in Figure 2.9(b) for K = 4.
We can note that on small ranges WF has the smoother form. This is caused by 
the fact that on small ranges the small number of zeros forms during the analysis in-
terval due to the displacement of extreme zeros for the much larger value. Therefore, 
WF should not sharply change stating from the condition of error minimization. 
Table 2.1  Optimal WF Coefficients
K
A
R/dR
2.5
4.5
6.5
8.5
10.5
12.5
14.5
1
A1
–0.88
–0.966
–0.984
–0.991
–0.994
–0.996
–0.997
2
A1
–0.957
–1.257
–1.298
–1.313
–1.32
–1.324
–1.326
A2
0.0365
0.259
0.298
0.313
0.32
0.324
0.326
4
A1
–0.94
–1.366
–1.514
–1.55
–1.568
–1.577
–1.583
A2
0.0298
0.402
0.636
0.7
0.736
0.755
0.767
A3
–0.009
–0.036
–0.132
–0.169
–0.189
–0.2
–0.207
A4
–0.007
0.00008
0.0096
0.0163
0.0201
0.0225
0.024

However, as well, the discreteness error smoothing is less effective and the measure-
ment error on small ranges is increased. 
Range increasing leads to a decrease in the maximal deviation of extreme ze-
ros with respect to analysis interval boundaries and, hence, to the assumption of 
sharper WF variation providing a better suppression of the discreteness error. More 
complicated WFs have a larger range of shape variation and, therefore, allow for 
the achievement of the less measurement error.  
Figure 2.10 shows functions of normalized MSD of measurement result versus 
the relative range obtained at the application of WF optimal parameters. The opti-
mization of parameters allows essentially a decrease in the measurement error com-
pared with Figure 2.5. In addition, the effect is larger for more series numbers used 
for WF representation, that is, for a more complicated WF shape. With increasing 
range, the error is essentially decreased. 
Figure 2.9  Profiles of optimal WFs: (a) K = 1 and (b) K = 4.
2.3  Truncation Error Minimization: Weighting Function Parameters	
47

48	
Weighting Method for the Difference Frequency Averaging
For comparison, Figure 2.10 shows the plot corresponding to the WF of 
­Blackman-Harris (BH 92 dB). We can note that it touches one point of the plot cor-
responding to n = 3, that is, this WF is optimal for the one fixed part. At other ranges, 
the error achieved with the help of the Blackman-Harris WF exceeds the optimal 
values of parameters. As well, for smaller ranges, the error is sharply increased while 
for larger ranges it at first smoothly increases and then remains almost unchanged. 
Let us examine the problem of the parameter a optimization of the WF KB 
(2.28) allowing the provision of the minimum of averaged error determined accord-
ing to (2.23) using (2.32). For the optimization of the coefficient a, we can obtain 
an equation similar to (2.34):
	
2(
)
0
S M
a
¶D
=
¶
	
(2.36)
Substituting (2.32) into (2.23), we obtain from (2.36):
	
2
2
0
1
1
2
2
0
1
2
2
2
2
1
1
2
1
(
1
)
(1
)
1
(
1
)
1
(
1
)
1
(
1
)
0
L
N
a
k
k
k
k
k
i
N
k
k
i
N
k
k
k
k
i
M
ae
I
a
i
a
I
a
i
a
i
I
a
i
π
χ
π
π
ε
η
π
π
ε
η
π
ε
η
π
ε
η
-
=
=
=
=
ì
ü
ï
ï
é
ù
-
-
+
-
-
+
í
ý
ë
û
ï
ï
î
þ
é
ù
-
-
-
+
ê
ú
ë
û
´
üï
é
ù
+
-
-
+
-
-
+
=
ý
ê
ú
ë
ûïþ
ü
ý
þ
å
å
å
å
	
(2.37)
where N = Mk for ek ³ ck and N = Mk + 1 for ek < ck. 
Equation (2.37) is nonlinear and has no analytical solution. Therefore, optimi-
zation was performed in the programming medium MATLAB with the help of the 
function of the multidimensional “fminseach” for several intervals of ranges. As a 
result, the function of optimal values of the shape parameter a of WF KB versus the 
Figure 2.10  The function of normalized MSD versus relative range for optimal coefficients. 

2.3  Truncation Error Minimization at the Weighting Average Method of DF by WF. Parameters	
49
average range corresponding to the middle of the averaging interval was obtained. 
It turns out that this function can be approximated by a straight line having the 
empirical expression for the optimal value of the WF shape parameter:
	
1,067(
0.5)
0.6061
opt
a
M
=
+
-
	
(2.38)
The profiles of the optimal WF KB are shown in Figure 2.11.
The function of the normalized averaged truncation error versus the normalized 
range for WF KB obtained according to (2.23) using optimal values of the param-
eter aopt in (2.38) is presented in Figure 2.12 by the solid curve.
We see that it is practically tangent to earlier drawn plots designated by dot-
ted curves and corresponding to specific values of the parameter a (a = 2, 4, 6, 8). 
The measured range increase leads to an error decrease. If the normalized range is 
more than 12, the quantization noise begins to proclaim itself caused by the finite 
accuracy of computer calculations. 
Comparing Figures 2.10 and 2.12, we may notice that the WF KB with optimal 
parameters allows us to obtain the lesser measurement error than the WF in (2.9) 
at the same ranges. It can be explained by the fact that the range of WF KB shape 
variation at the changing of the shape parameter a is much larger than for the WF 
Figure 2.11  Profiles of the optimal WF KB.
Figure 2.12  The function of the normalized averaged truncation error versus the normalized range 
for the WF KB.

50	
Weighting Method for the Difference Frequency Averaging
in (2.9) for a small number of items. The results of the previous section allow the 
assumption that at the increase of the WF item number in (2.9), we can approach 
the average error, ensuring it to the error obtained using WF KB. Nevertheless, the 
application of the WF KB is much more convenient as it requires optimization of 
the only one WF shape parameter, and for the WF in (2.9) the number of such pa-
rameters sharply increases with the item number increasing. 
For a practical application, the sets of optimal coefficients calculated in advance 
for each part of the range should be saved in the memory of the calculating device 
of the FMCW RF and be extracted as far as the measured range will change. 
At the first measurement after the RF switching on, it is expedient to use sets 
of coefficients corresponding to the least range, at which the error does not exceed 
some admissible limit. In this case, the measurement error at all other ranges will 
be enough to determine the number of the current discrete parts of averaging. Ac-
cording to this result, the value on normalized range is determined and the number 
of the averaging part M = Int(R/dR) can be determined. After that, based on Table 
2.1 for the WF in (2.9) or on the formula (2.34) for the WF KB, the optimal values 
of parameters are determined and new measurement is executed. 
In most cases for the WF in (2.9), we are limited by the small set of optimal coef-
ficients for small ranges (up to M £ 7). At other ranges typical for this set, it is neces-
sary to use coefficients corresponding to the largest range from the considered ones.  
As well, the truncation measurement error for large ranges remains about constant 
corresponding to the last considered set of optimal coefficients.  
2.4  Truncation Error Minimization of the Weighting Averaging 
Method of the Difference Frequency by Optimization of the 
FM Parameters
The analysis of functions of the instantaneous measurement error versus the nor-
malized range shown in Figures 2.3 and 2.4 for the WF in (2.9) allows the sugges-
tion of algorithms for the FM parameter optimization, which reduces the truncation 
error [14]. These algorithms consider the periodicity of the truncation error at the 
range variation and the modulation parameter influence on the EN error position 
on the axis of normalized range.  
The almost periodic character of the function of instantaneous truncation error 
allows the assumption that by controlling by the carrier frequency similar to the 
­approach offered in [15, 16] and investigated in detail and averaging the measure-
ment results, we can reduce the measurement error almost to a zero level.
The EN presence on the plot of the instantaneous error versus the normalized 
range allows getting the point corresponding to the specific normalized range in the 
nearest EN by controlling the FM sweep. Evidently, joining these two approaches, 
we can combine their positive properties. 
2.4.1  Application of Additional Slow-Frequency Modulation
The instantaneous truncation error presented in Figure 2.4 shows that the trunca-
tion error has a period of fast oscillations in range equal to a half-wavelength of the 

2.4  Truncation Error Minimization: Optimization of the FM Parameters	
51
carrier signal. The same conclusion follows from the formula (2.8) representing the 
equation for DFS zero determination. From this equation, we see that the period 
of error variation in phase is p. Varying the phase F in the limits [0, p] at a fixed 
range and averaging the obtained results, we may minimize the average value of the 
range measurement error. We can vary the DFS phase using additional slow FM of 
the carrier frequency w0 by the value of Dwslow. From this, it follows that at a fixed 
range we may obtain one period of error variation by varying the frequency of the 
carrier signal in such a manner to perform the condition:
	
slow del
t
ω
π
D
=
	
(2.39)
or the similar condition:
	
slow
F
Fη
D
= D
	
(2.40)
Let us estimate the extremely possible benefit in the value of the truncation error, 
when we use the additional slow modulation. For estimation, we use the numeri-
cal approach. For this, we calculate the truncation error obtained using algebraic 
WFs with the assumption that we know the exact measuring range. Of course, 
this is a practically unrealistic case, but it allows the estimation of the extreme 
possibilities of the method. To calculate the error, we use the formula (2.22). At 
each fixed range, using (2.40), we obtain the value of an additional slow FM 
sweep. After that, we change the carrier frequency in the range from f0 to f0 + 
DFslow with the fixed step DFslow/Naver (where Naver is the number of the average 
measurements) and calculate on each frequency the measurement truncation er-
ror. Then, after the selection of all frequencies in the specific frequency range, we 
average the results. The resulting function of such measurements in each fixed 
range point versus the measuring range is oscillation. The character of these oscil-
lations reminds the oscillating character of the truncation error shown in Figures 
2.4. Therefore, we present the calculation results on the basis of the mentioned 
approach in the form of logarithm of normalized averaged (over the range) within 
the limits of the one QI in accordance with (2.23) and Figure 2.13. These plots are 
obtained under condition when in the mentioned frequency range of slow tuning 
of the carrier frequency, 100 points were used. 
We see from these plots that this optimization method allows the determination 
of the less essential errors than the optimization of the WF shape. With the mea-
suring range increasing, the error decreases. If the number of averaging points in-
creases, the error also decreases. More complicated WFs ensure less error. However, 
there is a limit of error reduction caused by computer digit capacity, which is seen 
from the plot corresponding to n = 4. In this plot the segment is demonstrated be-
ginning from the normalized range R/dR = 5.5, when the error is almost unchanged. 
Therefore, there is a limit for the number of averaging points, which depends upon 
microprocessor digit capacity used for implementation of this method. 
In practice, the measuring range is unknown before measurement performance. 
Therefore, it is expedient to make this optimization algorithm an iterative one with 
frequent repetition of measurements and specification DFslow according to (2.40) at 
the each iteration.

52	
Weighting Method for the Difference Frequency Averaging
Step 1:
• 
 The first measurement of the range is provided without additional FM 
for determination of the zero approximation 
(0)
η
 and calculation of 
(0)
slow
F
D
 
according to (2.40). 
Step 2:
• 
 N measurements of the range are provided at discrete variation of the 
carrier frequency from the one measurement to another in the range from f0 to 
( )
0
slow
n
f
F
+ D
 with the step 
( )
slow/
t
F
N
D
 and the following approximation is found:
	
( )
( )
1
1
1
1
N
n
n
i
i
N
η
η
=
=
å


	
(2.41)
where ( )
n
iη
 is the estimation of quantity h for the ith measurement. 
Step 3:
• 
 The calculation of the new value of the slow FM sweep 
(
1)
slow
n
F
+
D
 is 
performed according to (2.40). 
Step 4:
• 
 Steps 2 and 3 are repeated until the reduction of the modulus of dif-
ference between the new obtained value ( )
n
η
 and its previous value (
1)
n
η
-

 will 
be lesser than that specified in the advance value Dh:
	
(
1)
( )
n
n
η
η
η
-
-
£ D


	
(2.42)
The value of the provided error depends upon the given advance value of Dh and 
the quantity of averaging points N. Calculations show that by decreasing Dh and in-
creasing N, we may achieve the limiting measurement error shown in Figure 2.13. 
A number of iterations necessary for achievement of condition (2.42) strongly 
depend upon the measuring range, the WF shape, the given value Dh, and the num-
ber of averaging points N and varies from 4 to 5 to 50 to 60. In other words, the 
total number of measurements will vary from 4N to 60N. 
The function of the FM sweep value of additional slow FM normalized to the 
FM sweep value of fast FM versus the normalized measuring range is shown in Fig-
Figure 2.13  The function of the logarithm of the extreme averaged normalized error versus the 
normalized range.

ure 2.14. The plot view does not depend upon the WF shape. Therefore, for small 
ranges, the FM sweep value of additional slow FM achieves 50% from the main 
FM sweep of fast modulation.
The described method for error reduction requires significant additional re-
sources in the FM sweep and the measurement time. 
2.4.2  Optimization of the FM Sweep
This method of optimization takes into account invariability of position on the 
axis of the EN normalized range with the zero measurement error at invariability 
of WF parameters. At the same time, the position of the point corresponding to the 
measured range depends upon the value dR; that is, upon the value of FM sweep 
DF. Therefore, in each point of the normalized range axis, we can displace this point 
along this axis to the one of the nearest EN (Figures 2.4 and 2.5) by varying DF. 
Therefore, we should take into consideration that the position of the first EN on the 
normalized range axis depends on the parameter n as follows: 
	
nodes
1
R
R
n
δ
=
+ 	
(2.43)
The procedure of optimization of the FM sweep supposes the multiple repeat of mea-
surements with correcting of the FM sweep DF in accordance with measured range, 
that is, it is iterative and with the account of (2.43), it consists of the following steps:
Step 1:
• 
 The measurement of the range 
(0)
meas
R
 is performed at some initial value 
DF(0) to obtain zero approximation η
δ
=
(0)
(0)
(0)
meas
/
R
R R
 and to determine on the 
normalized range axis the exact position of the nearest EN, which is located 
on the left of the current normalized point 
	
(0)
meas
(0)
exact
1
max
1;Int
R
R
R
n
η
δ
ì
ü
é
ù
ï
ï
=
+
ê
ú
í
ý
ê
ú
ï
ï
ë
û
î
þ

	
(2.44)
Figure 2.14  The function of the normalized FM sweep of slow FM versus the normalized range. 
2.4  Truncation Error Minimization: Optimization of the FM Parameters	
53

54	
Weighting Method for the Difference Frequency Averaging
Step 2:
• 
 The value of the FM sweep is corrected
	
(
1)
(
1)
( )
Rexact
n
n
n
R
F
F
η
η
-
-
D
D
=


	
(2.45)
Step 3:
• 
 Using the obtained value DF(n), we perform a new range measurement 
for the calculation of the next approximation ( )
n
R
η
.
Step 4:
• 
 Steps 2 and 3 are repeated until condition (2.42) is performed. 
From (2.43) and (2.45), it follows that if the measuring normalized range is less 
than n + 1, the nearest EN on the normalized range axis turns out to be on the right of 
the current point. Therefore, to displace the current point in EN, we need to increase 
the FM sweep compared with the initial value. Otherwise, the FM sweep should be 
reduced. The maximal degree of the FM sweep increase corresponds to the minimal 
measuring range. If we assume that the minimal measuring range is such that there 
is the only one zero in the beating signal, which corresponds to the normalized range 
equal to 2, the FM sweep increase will achieve (
1)/ 2
n +
 for the minimal range. If 
normalized range grows from the minimal to (n + 1), the smooth decrease of required 
FM sweep occurs to the initial value corresponding to the normalized range (n + 1). 
At the further increase of the normalized range, the character of the dependence be-
comes more complicated, being determined by the second parameter in (2.44).
The calculation results for the range measurement error in accordance with 
(2.22), which are used in the mentioned algorithm, are shown in Figure 2.15. 
These results are obtained for the initial FM sweep at 500 MHz. The view of plots 
strongly depends upon the WF type and the specified limit in the condition (2.38). 
Figure 2.15  The function of the normalized error logarithm versus the normalized range at optimi-
zation of the frequency FM sweep.

The reduction of this value to 10-15 leads to the fact that all plots, beginning from 
some range, are connected to each other. Plots essentially differ only for normal-
ized ranges, which are less than n + 1. In this case, the smaller error corresponds 
to the larger n, but this is achieved by the essential increase of the required FM 
sweep. In the comparison of Figures 2.15 and 2.16, the function of required FM 
sweep versus the normalized range is presented for different WFs.
The number of iterations required for achievement the given error depends upon 
the value Dh, the measuring range, and the WF shape, and at the variation of these 
parameters it can be changed from 2 to 3 to 100 to 150. It is clear that restricted 
frequency resource of the SHF module leads to a limitation of the minimal range for 
WF with large values of n. This method of FM sweep optimization does not require 
application of the complicate WFs. For this algorithm, the required number of mea-
surements to achieve the given condition is equal to number of iterations. 
2.4.3  Combined Optimization
Let us examine how we can combine the above-mentioned minimization methods 
to save their positive properties and to reduce of required iteration number. The 
method of error averaging with the help of additional slow modulation allows ob-
taining the smaller error compared with optimization of the FM sweep and we may 
expect that it is less sensitive to the noise effect. However, this method requires the 
performance of a greater number of measurements. 
Figure 2.16  The function of the FM sweep required for minimization of the measurement error 
versus the normalized range at various WFs. 
2.4  Truncation Error Minimization: Optimization of the FM Parameters	
55

56	
Weighting Method for the Difference Frequency Averaging
2.4.4  The Combined Procedure of Error Minimization
The following combined procedure is used to minimize error:
Step 1:
• 
 The optimization of the FM sweep of fast FM is provided, which 
ensures the displacement of the current operating point in the point corre-
sponding to the nearest node. 
Step 2:
• 
 Using the obtained value of the FM sweep, the preliminary range 
measurement is executed. 
Step 3:
• 
 According to the measured range, with the application of (2.40), we 
determine the required value of the FM sweep of slow FM.
Step 4:
• 
 Using the obtained values of the FM sweep of fast and slow FM, we 
provide one cycle of slow tuning of the carrier frequency with the measure-
ment result averaging for a more precise specification of the range measured 
at the first step. 
The results of truncation error calculation according to formula (2.22) obtained 
with the help of the combined algorithm are shown in Figure 2.17. We see that 
theoretically such the combined algorithm allows the essential reduction of the 
truncation error at measurement. In addition, the dependence of achieved level of 
measurement error upon the WF shape is kept. 
2.5  Noise Influence on the Error of the Weighting Method of 
Difference Frequency Averaging
Let us estimate the additive noise effect on results of range measurement with the 
help of the weighting method of QI smoothing according to formulas (2.5) and 
Figure 2.17  The function of the normalized error logarithm versus the normalized range using the 
combined optimization.

2.5  Noise Influence on Difference Frequency Averaging	
57
(2.7). Due to the noise affect, time moments ti are displaced by the value Dti of the 
true meaning. Then, for the estimation of S

 assuming that the noise level is small 
compared with the signal [13], we may write:
	
1
1
(
)
[ ( )
( )
]
N
N
i
i
i
i
i
i
i
S
t
t
t
t
t
α
α
α
=
=
=
+ D
»
+
D
¢
å
å

	
(2.46)
The second item can be presented as the measurement error caused by the noise 
DS,noise:
	
,noise
1
1
( )
(
)
N
N
i
i
i
S
i
i
S
t
t
t
S
α
α
=
=
=
+
D
=
+ D
¢
å
å

	
(2.47)
The moment displacement Dti of intersection by the sum of DFS derivative and 
the noise DU of the zero level was found in Chapter 1 in the form of the formula 
(1.60). Using the similar transformations to the sum of DFS and noise, we obtain:
	
mod /(2
)
i
U
m
R
t
T
U x
π
D
= D
	
(2.48)
Now the noisy component of the measurement error can be presented as:
	
,noise
mod
1
( )
/(2
)
N
S
i
Ui
m
R
i
T
α t
U x
π
=
D
=
D
¢
å
	
(2.49)
We assume that noise on the filter output is normally distributed with the zero 
mean value and the variance 
2
noise
σ
. From (2.48) and (2.49), it follows that the dis-
tribution law of the noise component of the measurement error remains normal. 
Let us find the mathematical expectation mS,noise and the variance 
2
,noise
,noise
S
S
D
σ
=
 
of the noise component of the measurement error. It is clear that:
	
,noise
,noise
[
]
0
S
S
m
E
=
D
= 	
(2.50)
where E[*] means the calculation of the mathematical expectation. So we can write:
	
2
mod
2
S,noise
,noise
2
2
1
2
mod
2
1
1
2
mod
1
1
( )
4
( )
( )
(2
)
( )
( ) (
)
2
N
i
S
m
i
N
N
i
i
j
j
m
i
j
N
N
i
j
i
j
m
i
j
T
D
E
E
t
U
T
E
t
U
t
U
U
T
t
t B t
t
U
η
α
π
η
α
α
π
η
α
α
π
=
=
=
=
=
ì
ü
é
ù
ï
ï
é
ù
=
D
=
¢
ê
ú
í
ý
ë
û
ê
ú
ï
ï
ë
û
î
þ
ì
ü
é
ù
ï
ï
ê
ú
=
D
D
¢
¢
í
ý
ê
ú
ï
ï
ë
û
î
þ
ì
ü
æ
ö ï
ï
=
-
¢
¢
í
ý
ç
÷
è
ø ï
ï
î
þ
å
åå
åå
	
(2.51)
where B(ti – tj) are samples of the covariance function of the noise [17].
The variance of the noise error component is determined by WF type and the 
covariance noise function. Let us examine its influence for WF (2.9) and (2.28).

58	
Weighting Method for the Difference Frequency Averaging
2.5.1  The Measurement Error for the Weighting Function in the Form of the 
Trigonometric Series 
The derivative of the weighting function (2.9) is:
	
mod
mod
1
4
4
( )
sin
K
W
m
m
mt
t
K
mA
T
T
π
π
α
=
æ
ö
= -
¢
ç
÷
è
ø
å
	
(2.52)
Then, from (2.51), taking into account (2.14) and (2.52), we obtain:
	
[
]
2
mod
,noise
1
1
1
1
2
(
)
2
sin[2
(
)]sin 2
(
1
)
N
N
W
S
m
i
j
K
K
m
k
m
k
K
T
i
j
D
B
U
mnA A
m i
j
k
j
η
η
π
η
ε
π η
ε
=
=
=
=
ì
-
æ
ö ï
é
ù
=
í
ç
÷
ê
ú
è
ø
ë
û
ïî
üï
´
- +
-
+
ý
ïþ
åå
å å
	
(2.53)
Let us consider the noise influence on an example of typical frequency responses 
of filters. In [18] the covariance functions of the process at the output of the single 
oscillating circuit, the ideal filter and the multistage resonance amplifier at input 
impact of the white normal noise. Using the above designations, we give here the 
covariance function of the output process for the multistage amplifier only:
	
2
2
16
2(
)
mod
[2
(
)]
( 1)i j
i j
n
B
T
i
j
e
πη
η
σ
-
-
-
-
= -
	
(2.54)
where 
2
0
n
N
f
σ
=
D  is a noise variance at filter output, Df = 2/Tmod is the filter pass-
band matched with duration of processing signal, and i and j are the numbers of 
the appropriate DFS zeros.
As a result, the variance DS,noise can be presented in the form:
	
[
]
[
]
2
2 |
|
,noise
/
1
1
1
1
( 1)
sin 2
(
1
) sin 2
(
1
)
K
K
i j
i j
S
s n i
k
K
K
m
k
m
k
D
e
q
mkA A
m i
k
j
η
η
π
η
ε
π η
ε
-
-
-
=
=
=
=
=
-
´
-
+
-
+
åå
å å
	
(2.55)
where qs/n = E/N is SNR.
Let us analyze the noise effect. Determining in accordance with (2.20) the coef-
ficients Am and Ak in (2.55) for different n, we draw the plots of MSD of the noise 
error component versus the relative range.
The calculations show that the MSD sS,noise at small ranges has the complicated 
oscillating character and its total level decreases when the range increases. The oscil-
lating character can be explained by the presence of points in the WF plot, in which 
the derivative is equal to zero. These are two points on the boundary of the appropri-
ate time interval and one point in the center of the interval. The appropriate item of 
(2.47) vanishes in these points. At the small range, there are few items in (2.47) and, 
therefore, their contribution to the total sum is high. So, at a range equal to the one 
QI, there is the only one item and its number will be periodically 1 to 2 and vice versa 
(in general case from M to M + 1), with the range increasing up to the value equal to 

two QI. ­Accordingly, when only one DFS zero, moving at a range variation inside the 
modulation period, falls in the point with zero derivative, the error variance becomes 
zero. During the range interval equal to one discreteness error, such an event arises 
several times.
The number of such events is equal to the integer part of a ration of the discrete-
ness error value and the wavelength of the carrier oscillation. Between these points, the 
derivative achieves maximum and, accordingly, the variance is also maximal. As far as 
the range grows, the contribution of these items in the total sum of (2.47) will decrease 
and, hence, the amplitude of MSD oscillations of the noise error decreases. As a result, 
at a large range the plot of the MSD versus range is degenerated into the continuous 
line, which smoothly falls at a range increase individually for different WFs.  
The reduction of the total MSD level with range increasing can be explained by 
the effect of the result accumulation with the signal zero number increasing and, 
hence, a number of noncorrelated noisy data occur. The more the power of the 
function (2.19), the more frequently the range will lead to an essential decrease of 
MSD oscillations and the larger the total error level.
The most intensive variation occurs for more complicate WFs. The variation 
of the noise level does not change the character of plots and their ratio but changes 
the modulus of error values.
At small ranges (R/dR < 2…6), the noise correlation practically does not mani-
fest itself on the MSD value and on the character of the range dependence. With the 
measuring range increasing, the zero number in the modulation period increases 
and the time interval between them decreases. In addition, the noise correlation 
becomes manifested, which can be expressed in the fact that the noise component 
of the error decreases. The specific value of range, at which the noise correlation be-
comes manifested, depends on the WF shape. The more complicated the WF shape, 
the more frequently will the range lead to this effect manifestation. 
For convenience of quantitative comparison of error components correspond-
ing to different WFs, following (2.23), we use the averaged MSD, which with des-
ignations of the formula (2.23) takes the form:
	
2
,noise
,noise
,
,noise
1
1
(
)
(
)
(
)
L
S
S
M K
S
k
D
M
M
D
R
L
σ
=
=
=
å
	
(2.56)
Figure 2.18 shows the function 
,noise
,noise
(
)
(
)
S
S
M
D
M
σ
=
 versus the normalized 
range for initial values of WF parameters at the noise level -40 dB for the noncorrelated 
noise (solid lines) and for a filter in the form of multistage (dotted lines) for n = 1, 2, 4.
From Figure 2.18, we can make the conclusion that with an n increase, that is, the 
complication of the weighting function shape leads to an increase of the noise compo-
nent of the error caused by the noncorrelated noise. The application of filtering gives 
the expected result in the form of reduction of the noise component of the error. The 
more this reduction, the larger the measuring range because, when the range grows, 
the number of accumulated values increases. The noise affects very strongly the more 
complicated WFs. For these functions, the filtering ensures less benefit. 
The functions of the logarithm of the average MSD of measuring error’s noise 
component versus the normalized range are shown in Figure 2.19. We see that the 
more effective filtering is observed for more complicated WFs (for larger n). 
2.5  Noise Influence on Difference Frequency Averaging	
59

60	
Weighting Method for the Difference Frequency Averaging
A comparison of Figures 2.19 and 2.6 shows that the noise component of the 
measurement error is commensurable with the truncation error on small ranges and 
significantly exceeds it on large ranges.  
The total error D(M) is of interest, which can be determined as:
	
2
2
,noise
(
)
(
)
(
)
S
S
M
M
D
M
D
= D
+
	
(2.57)
The variation character of these quantities at range variation strongly depends 
upon the noise level and is determined by the fact that the component of the mea-
surement error has more significance. 
Figure 2.20 shows plots of the function of the average total error’s MSD 
2(
)
M
σD =
D
 for the multistage amplifier, where D2(M) is calculated according to 
(2.61) at the noise level -40 dB and -80 dB. 
Figure 2.19  The function of the logarithm of the noise component’s averaged MSD of the 
­measurement error for the multistage amplifier.
Figure 2.18  The function of logarithm of the average MSD of the noise component of the measure-
ment error versus the normalized range: the dotted line indicates multistage amplifier and the solid 
line indicates noncorrelated noise. 

Figure 2.20  The function of the normalized total error’s MSD versus the normalized range for the multistage amplifier: (a) the noise -40 dB and (b) the 
noise -80 dB.
2.5  Noise Influence on Difference Frequency Averaging	
61

62	
Weighting Method for the Difference Frequency Averaging
These plots clearly show that the main contribution to the total measurement 
error on small ranges (R/dR < 4) is introduced by the truncation error, while at large 
ranges it is introduced by the noise component. The more complicated the WF 
shape, the stronger the noise influence.
2.5.2  The Measurement Error for the Kaiser-Bessel Weighting Function
According to [12], the derivative of the Kaiser-Bessel WF in (2.27) is:
	
2 2
1
2
2
8
2
( )
1
,
[
/2,
/2]
2
1
a
a e
t
t
α t
I
a
t
T
T
T
t
T
T
π
π
π
-
é
ù
-
æ
ö
=
-
Î -
¢
ê
ú
ç
÷
è
ø
ê
ú
ë
û
æ
ö
- ç
÷
è
ø
	
(2.58)
Using the previous designations, we obtain:
	
(
)(
)
2
2 4
2
norm,
norm,
,noise
2
2
2
1
1
norm,
norm,
norm,
norm,
2
2
1
norm,
norm,
1
norm,
norm,
norm,
norm,
(2
1)(2
1)
4
I
2
I
2
(
)
N
N
a
i
j
S
m
i
j
i
i
j
j
i
i
j
j
i
j
t
t
a e
D
U
t
t
t
t
a t
t
a t
t
B t
t
π
η
π
π
π
-
=
=
ì
-
-
ï
=
í
ï
-
-
î
ì
ïí
ïî
é
ù
é
ù
´
-
-
-
ê
ú
ê
ú
ë
û
ë
û
åå
	
(2.59)
Now for the mentioned filter in the form of the multistage amplifier, we substitute 
into (2.59) the corresponding correlation function (2.54) and obtain the variance 
of the noise error for three above-mentioned filters: 
	
(
)(
)
}
2
2
2 4
2
norm,
norm,
,noise
2
2
/
1
1
norm,
norm,
norm,
norm,
2
2
16
(
)
1
norm,
norm,
1
norm,
norm,
(2
1)(2
1)
I
2
I
2
N
N
a
i
j
S
s n
i
j
i
i
j
j
i j
i
i
j
j
t
t
a e
D
q
t
t
t
t
a t
t
a t
t
e
π
πη
π η
π
π
-
=
=
-
-
ì
-
-
ï
=
í
ï
-
-
î
é
ù
é
ù
´
-
-
ê
ú
ê
ú
ë
û
ë
û
åå
	
(2.60)
Figure 2.21  The function of logarithm of the noise component’s average MSD of the measurement 
error versus the normalized range: the dotted line indicates the multistage amplifier and the solid line 
indicates the noncorrelated noise. 

The calculation results performed according to (2.60) for three values of the pa-
rameter a = 2, 4, 6 for KB WF (2.28) show that the character of error behavior at 
the variation of the range and the WF form remains the same, that is, we observe a 
decrease in error oscillation while the range increases and a delay of the oscillation 
amplitude process for more complicated forms of WF. 
A quantitative comparison of the mentioned error components was performed 
according to plots of MSD values averaged on the formula (2.56) in the range 
interval equal to one discrete error. The calculation results are presented in Figure 
2.21 by the solid line for the error component caused by the white noise and by the 
dotted line for the noise error at the filter output.  
For the KB WF under consideration as well as for the WF (2.19), we can observe 
the significant reduction of the noise error component at range increase caused by 
result accumulation owing to increase of the DFS zero number. Such reduction for 
more complicated WF has less value. 
Figure 2.22 shows the function of normalized MSD of the total error versus the 
normalized range calculated according to (2.57) for two values of SNR qs/n = 40 
dB and qs/n = 80 dB at three values of the WF shape parameters a = 2, 4, 6. We see 
that the noise level reduction leads to a sharp decrease of the total error for more 
 
Figure 2.22  The function of logarithm of the total error normalized MSD versus the normalized 
range for the multistage amplifier: (a) noise –40 dB and (b) noise –80 dB.
2.5  Noise Influence on Difference Frequency Averaging	
63

64	
Weighting Method for the Difference Frequency Averaging
complicated WF shapes. However, this decrease is limited by some value, which is 
individual for each WF.
2.6  Conclusions
The effectiveness of the weighting averaging method depends to a great extent upon 
the type of WF used. However, at any WF, we observe the measurement error reduc-
tion with measuring range increasing. Therefore, one can formulate and solve the 
problem of optimization of the weighting function shape to achieve the minimum 
of the truncation error.
The error achieved by the means of optimization of the WF shape decreases 
while the measuring range increases and it is difficult to achieve a small error on 
very small ranges.
The oscillating character of the truncation error variation at a range change 
with two types of periodicity allows the performance of error optimization using a 
variation of FM parameters separately or in combination. 
The degree of truncation error reduction in this case is significantly higher com-
pared with the WF shape variation; therefore, the level of the error achieved weakly 
depends upon the measuring range. Nevertheless, such an essential benefit can be 
achieved owing to the significant increase of the frequency resource at FM and the 
increase of processing time. 
An analysis of noise influence on the range measurement error using the weight-
ing MEDS shows that the character of MSD dependence upon the range is also 
oscillating with two types of periodicity; however, when the range increases, the 
oscillation amplitude sharply decreases. 
The general view of such plots strongly depends upon WF type and the filter 
type used in stages of preliminary analog DFS processing. In general, we can con-
sider that the level of the measurement noise error component does not exceed 
values satisfying the practical needs of the industry at the noise level not more than 
-40 to -45 dB with respect to the DFS level.
References
[1]	 Edvardson, K. O., Satt och anerdning for avstandsmatning med frekvens-modulerade kon-
tinuerliga mikrovagor, Patent No. 381745, Sweden, INT.CL. G01S 9/24, No. 7315649-9, 
filed November 20, 1973, published December 15, 1975.
[2]	 Edvardson, K. O., Measurement of Contents of Tanks etc. with Microwave Radiations, U.S. 
Patent 4044355, Int. CI, G01S 9/24, filed February 13, 1976, issued August 23, 1977.
[3]	 Approach to Distance Measurement with the Aid of Frequency-Modulated Signal and the 
Radar Station with Frequency Modulation, Authors Application 30-1591, Japan, Int. CI., 
G01S 13/34, Izobretenia stran mira, No. 15, p. 291985.
[4]	 Ezerskiy, V. V., “Measurement Procedure of a Distance Gauge Based on a Frequency-
­Modulated Range Finder with Weighted Smoothing of the Digitization Error,” Measure-
ment Techniques, Vol. 46, No. 2003, pp. 841–846.
[5]	 Korn, G., and T. Korn, Mathematical Handbook for Scientists and Engineers, New York: 
McGraw Hill Book Company, 1961.

2.6  Conclusions	
65
[6]	 Vinitskiy, A. S., Essay on Radar Fundamentals for Continuous-Wave Radiation (in Rus-
sian), Moscow, Sovetskoe Radio Publ., 1961, p. 495.
[7]	 Marple, S. L., Jr., Digital Spectral Analysis with Applications, Englewood Cliffs, NJ: 
­Prentice-Hall, 1987.
[8]	 Harris, F. J., “On the Use of Windows for Harmonic Analysis with the Discrete Fourier 
Transform,” IEEE Trans. Audio Electroacoust., Vol. AU-25, 1978, pp. 51–83.
[9]	 Dvorkovich, A. V., “New Calculation Method of Effective Window Functions Used at 
Harmonic Analysis with the Help of DFT” (in Russian), Digital Signal Processing, No. 2, 
2001, pp. 49–54.
[10]	 Dvorkovich, A. V., “Once More about One Method for Effective Window Function Calcu-
lation at Harmonic Analysis with the Help of DFT” (in Russian), Digital Signal Processing, 
No. 3, 2001, pp. 13–18.
[11]	 Gradstein, I. S., and I. M. Ryzhik, Tables of Integrals, Sums, Series and Products, A. Jeffrey 
and D. Zwillinger (eds.), New York: Academic Press, 1965.
[12]	 Ezerskiy, V. V., and I. V. Baranov, “Analysis of the Truncation Error of the Distance Sensor 
on the Basis of FMCW Range Finder with Weighting Smoothing of the Discrete Error” (in 
Russian), Vestnik RGRTA, Ryazan, RGRTA, No. 11, 2003, p. 61.
[13]	 Ezerskiy, V. V., and I. V. Baranov, “Optimization of Weighting Methods of Smoothing the 
Discreteness Error of Distance Sensors Based on a Frequency Rangefinder” (in Russian), 
Measurement Techniques, Vol. 47, No. 12, 2004, pp. 1160–1167.
[14]	 Baranov, I. V., and V. V. Ezerskiy, “Optimization of Modulation Parameters in Short-Range 
Radar Technology at Weighting Averaging of Difference Frequency” (in Russian), Vestnik 
RGRTU, Ryazan, No. 2 (28), 2009, pp. 30–37.
[15]	 Kagalenko, B. V., and V. P. Meshcheriakov, Frequency-Modulated Radio Range Finder, 
Authors Certificate 1141354 (USSR), Int. Ci., G01S 13/08, Bull. No. 7, filed May 3, 1983, 
published February 23, 1985.
[16]	 Marfin, V. P., A. I. Kiyashev, F. Z. Rosenfeld, et al., “Radio Wave Non-Contact Level-Meter 
of Higher Accuracy” (in Russian), Izmeritelnaya Technika, No. 6, 1986, pp. 46–48.
[17]	 Levin, B. R., Theoretical Fundamentals of Statistical Radio Engineering, 2nd Edition (in 
Russian), Moscow: Sovetskoe Radio Publ., 1974, p. 552.


67
c h a p t e r  3
Estimation of the Difference Frequency by 
the Position of the Spectrum Maximum
3.1  Introduction
The estimation of the difference frequency in the spectral (frequency) domain 
­assumes obligatory application of methods and devices for digital signal process-
ing (DSP) after preliminary analog processing of the difference frequency signal. 
Actually, under the conditions of short-range radar technology, this is a problem of 
frequency estimation of the pure sine signal according to the short sample [1] and 
further calculation of the range by (1.12). Therefore, going forward, we will con-
duct the analysis of frequency estimation accuracy and convert it (when necessary) 
in the range so as not to distract the reader.
The frequency of continuous sinusoid, from which this sample is cut out using 
some WF [2, 3], is understood as the true value of the DFS sample frequency. DFS 
processing in the spectral domain is performed on the basis of the Fourier transfor-
mation. In the classical variant [2–12], the complex spectrum (CS) ( )
S n

 is calcu-
lated with the help of the discrete Fourier transformation (DFT): 
	
1
dif
0
( )
( ) ( )exp(
2
/ ),
0,1,
,
1
K
k
S n
u
k w k
j
nk K
n
K
π
-
=
=
-
=
-
å

…
	
(3.1)
where w(k) is the WF ensuring a reduction of the sidelobes (SL) of the spectrum.
For calculation speed-up, the fast Fourier transformation (FFT) is usually used 
[2, 4, 7, 9, 10], which places a limitation on a number of processed samples. The 
spectrum calculated in such a manner is discrete due to the fact that calculation 
according to (3.1) supposes the periodic prolongation of the signal. Therefore, the 
frequency estimation on the basis of this spectrum as well as processing in the 
time domain leads to QI [11], which, as before, is determined according to (1.15). 
Hence, the issue about the measuring range error reduction is, as usual, relevant. 
The various algorithms of the spectrum processing can be used for this purpose. The 
issue about the limit achievable measurement error, which is determined under ideal 
conditions by the error only, which is peculiar to the used measurement method 
(i.e., by the truncation error), is practically important. 
The weighted DS samples obtained in the same points of the time axis inside 
of each repetition period of the FM law on ascending or descending parts with the 
step Tdis, determined according to the sampling theorem, are exposed to process-
ing according to (3.1). To implement this method, we do not need the continuous 
smooth variation of the transmitted signal frequency. It is enough to provide the 

68	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
transmitted signal radiation at some frequency values fixed in advance. Neverthe-
less, the requirement of linearity of frequency variation remains. As a result, they 
come to the method of stepped frequency modulation of the continuous signal 
(FSCW) [12–19]:
	
mod
dis
ω
1
( )
1(
)
K
k
t
t
kT
ω
δ
=
=
-
å
	
(3.2)
where 1(t) is a unit step function [20] and dw is the minimal step of the FM sweep.
It is clear that the FM sweep in this case is:
	
K ω
ω
δ
D
=
	
(3.3)
Such a mode of the FMCW RF operation agrees well with the peculiarities 
of digital frequency synthesizers [21, 22], which allow us to obtain the stepped 
frequency variation with the constant step dw. Therefore, we can ask the question 
about the optimization of FM parameters to achieve the minimal measurement 
­error. It is clear that in the measurement process we can change the carrier fre-
quency F0 and the frequency deviation DF at keeping the linear character of the FM 
sweep. These methods are known [15, 23, 24].
The application of the WF at the spectrum calculation proposes an answer to 
the question about its best parameters. In the literature [2, 3, 25], at finding the 
optimal WFs, the following factors are determinants: the minimum of the SL level, 
the minimum of the main lobe width, and the minimum of the estimation error of 
power spectral density. In our case, the range measurement error should be the main 
factor at some restrictions on the WF characteristics. 
The reception of DFS is provided on the background of noise and different 
types of interference under the influence of destabilizing factors. In this chapter, we 
are limited by the consideration of the noise influence only. The analysis of other 
distortion effects will be discussed in later chapters. 
To take into account the noise influence on the frequency (range) estimation 
error in the spectral domain, we need information about the main statistical char-
acteristics of the DFS spectrum received on the background of stationary noise. 
First, the distribution laws of the spectral components (SC) and the correlation 
links between them can be attributed to them. The determination of the statisti-
cal characteristics of the random process spectra allows us in some cases to obtain 
analytical equations for noise components of the DFS frequency estimation error in 
the spectral domain. The statistical characteristics of estimations of the stationary 
random processes are examined completely enough [26, 27]. The statistical charac-
teristics of the estimation of the power spectral density (PSD) of the sum of the DFS 
and the white normal noise have obviously not been investigated enough.
3.2  Algorithms of Difference Frequency Estimation
Smoothing QI is possible with the help of methods allowing the provision of the 
spectrum average frequency estimation with the minimal possible error. 

3.2  Algorithms of Difference Frequency Estimation	
69
The most frequently that one can consider the frequency corresponding to the 
maximum of the spectral amplitude density (SAD) of the DFS as the frequency 
estimation is: 
	
{
}
(
)
max
( )
R
S
S
ω
ω
ω
=


	
(3.4)
In [28] it is shown that the algorithm (3.4) is the estimation of maximal likeli-
hood at evaluation of signal frequency with the unknown initial phase. Practically, 
it is possible to realize the algorithm (3.4) using different procedures.
The variants of this algorithm realization were:
An increase of spectrum description detail using zero padding in the process-
1.	
ing array [2, 6]. Using K0 zero padding (in accordance with terminology of 
[9], from the outside) to the initial array from K DFS samples, we can pro-
vide any required discreteness of the spectrum. Therefore, the expression for 
the DFS changes as:
	
1
dif
0
0
0
( )
( ) ( )exp[
2
/(
)],
0,1,
(
)
1
K
k
S n
u
k w k
j
nk K
K
n
K
K
π
-
=
=
-
+
=
+
-
å

…
	
(3.5)
It is unnecessary to physically use zero padding in the array for calcula-
tion according to this formula (i.e., we need not to increase the memory 
capacity of computing device). Only the denominator in the exponent and 
a number of possible values of the variable n will change. In the case of the 
fast Fourier transformation (FFT) application, the zero padding in the DFS 
array is strictly necessary.
Usually these calculations are performed in two stages. At the first stage, 
the FFT with the initial number K of DFS samples is calculated and the po-
sition of the SAD maximum nmax is obtained. At the second stage, only in 
the vicinity of the obtained maximum is the calculation of SAD according 
to (3.5) performed with the accepted discreteness value, which is specified 
by the choice of the appropriate value K0 and the search of the maximum 
according to (3.1). The range calculation is executed according to (1.14), 
where instead of NDFS, the obtained value max
n
 is substituted.
The application of the discrete-time Fourier transformation [2, 3] and the 
2.	
maximum search of the continuous periodic in the frequency spectrum are 
performed with the help of one-dimensional optimization methods [29]. 
At the limit, we can introduce the continuous variable x Î [0, 1] instead 
of the ratio n/(K + K0) and to transfer to discrete-time [2] or to integral-
discrete [3] Fourier transformation (IDFT):
	
1
dif
0
( )
( ) ( )exp(
2
), 0
1
K
k
S x
u
k w k
j
xk
x
π
-
=
=
-
£
£
å

	
(3.6)
Here it is possible, smoothly varying x, to use any numerical method of 
the extreme search [29] to determine the maximum of the function

70	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
	
max
max
max ( )
(
)
(
)
x X S x
S x
S x
Î
=
= 
	
(3.7)
After that, the value max
n
xK
=

 is obtained, which is substituted in (1.14) 
instead of NDFS for the range calculation.
The search of spectrum maximum on the basis of spline-interpolation of 
3.	
the DFS spectrum is performed. The algorithm on the basis of spline inter-
polation of the signal spectrum is used for DFS spectrum calculation using 
FFT with small number of adding zero samples (it is enough to increase the 
­period length by two to four times). To determine the frequency with the 
specified truncation error, the spline interpolation of SAD (or PSD) is used 
within the limits of its main lobe. After interpolation, we obtain additional 
spectral components following through the interval dw¢, and then the algo-
rithm (3.4) is used for estimation of signal frequency.
The application of correcting coefficients [30, 31] is performed. The algo-
4.	
rithm with usage of correction, in which the following quantity [30, 31] is 
accepted as the DFS frequency estimation, is:
	
max
0
(
1
)
R
n
p K
K
ω
ω
D
=
-
+
+

	
(3.8)
where nmax is a number of the maximal SC SAD or PSD and p is a correc-
tion considering the difference between the SC intensities calculated on the 
adjacent frequencies.
If the DFS frequency does not coincide with the central frequency of DFT 
filter, the SC intensity changes due to the palisade effect [3], which is used for the 
correction of the frequency estimation. In [30, 31], some different corrections 
are offered. The most suitable correction is calculated by the formula [30]:
	
,
max
,
max
,
,
max
,
max
(
1)
(
1)
(
1)
(
1)
a m
a m
a m
a m
a m
z
n
z
n
p
z
n
z
n
-
-
+
=
Y
-
+                  +
	
(3.9)
where za,m(nmax – 1) and za,m(nmax + 1) are, respectively, intensities of the SC 
SAD A(w) and the PSD G(w) from the left and from the right from the maxi-
mum and Y is a multiplier depending on the number of added zero samples. 
The initial values of multipliers are accepted as equal: Ya = (k + k0)/K and 
Ym = (k + k0)/(2K). The corrected values of Ya and Ym at the calculation are 
determined by the method of successive approximations when using them 
as a criterion of range measurement error minimum. A number of adding 
zero samples are not very large for this algorithm; it is enough to increase 
the initial number of samples by two to four times. The advantage of this 
algorithm is its undoubted simplicity. 
Besides the described algorithms giving the point frequency estimation, 
sometimes they use estimations based on the property of the spectrum sym-
metry. The most interesting one is caused by two algorithms: the application of 
average-weighted estimation of the carrier frequency [32–34] and the estima-
tion of the spectrum median [35]. Both of these algorithms suppose preliminary 
calculation of the spectrum using the FFT with an increase of the DFS period by 
two to four times owing to the zero addition.

3.3  Estimation of the Difference Frequency 	
71
The formula for average-weighted frequency estimation can be written as:
	
upp
low
upp
low
2
dif
1
2
dif
1
( )exp(
2
/ )
( )exp(
2
/ )
n
K
i n
l
R
n
K
i n
l
i
u
k
j
li K
n
u
k
j
li K
π
π
=
=
=
=
-
=
-
å
å
å å

	
(3.10)
where nlow and nupp are, respectively, the lower and upper boundaries of numbers of 
the processed SC, and therefore, nlow £ nmax £ nupp. After that, the range calculation is 
provided according to (1.14). The finding of a number nmax of the maximal SC precedes 
to the application (3.10) for signal frequency estimation. Then the choice of nlow and 
nupp is provided, which determine the summation limits and are located symmetrically 
with respect to SC nmax. The number of SC (specified by the range of their numbers 
nupp – nlow) is chosen from the condition of the minimization of the frequency estima-
tion error and it should be not less than a value covered by the main spectrum lobe. 
As a rule, this quantity in two to four times exceeds the width of the main lobe. 
The estimation of the spectrum median nx is carried out using the sliding half-
gates. This algorithm can be written analytically as [35]:
	
upp
low
2
2
( )
( )
x
x
n
n
n n
n n
S n
S n
=
=
=
å
å


	
(3.11)
where nlow and nupp are, respectively, the lower and upper boundaries of current 
numbers of processed SC.
The procedure of frequency estimation by the algorithm (3.11) supposes two 
half-gates sliding along the frequency axis. The number of SC nx, at which the equal-
ity (3.11) performance is achieved, is identified with the signal frequency. Reducing 
the error caused by the discrete character of calculating spectrum and the practical 
implementation of this algorithm supposes an application of spline interpolation 
of the signal spectrum within the limits of its main lobe. The width of half-gates 
should be chosen equally, that is, nx – nlow = nupp – nx.
Let us consider in detail some of these algorithms. The degree in minuteness will 
be defined by the level of attention to specific algorithm in known publications, the 
personal interest of authors, obtained results, and the value of achievable measure-
ment error.
3.3  Estimation of the Difference Frequency on the Basis of the 
Maximum Position of the Spectral Density of the Difference 
Frequency Signal 
3.3.1  Analytical Estimation of the Truncation Error of Range Measurement
The estimation of the difference frequency 
2
R
R
F
ω
π
=


 on the position of the DFS 
SAD maximum (3.4) is the most natural. The spurious SC from the area w < 0, SC 
caused by interference and noise, and frequency-dependent circuits of the device for 
preliminary analog DFS processing influence the frequency estimation. There is no 

72	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
analytical solution of this problem, which adequately reflects the frequency estima-
tion error at any amplitude and phase relations between parameters of the signal 
and interference. Estimations obtained by means of numerical simulation on the PC 
show that the position of the SAD modulus maximum in general does not coincide 
with the frequency of the beating signal [1, 36]. If noise, interference, and distortions 
of the signal are absent, the error is caused by influence of SC from the area w < 0.
In accordance with definition (3.4), it is necessary to solve the following equa-
tion for frequency estimation: 
	
2
2
1
( )
( )
0
N
i
i
d
d
S x
S x
dx
dx
=
=
=
å


	
(3.12)
where 
0.5
0.5
( )
( ) ( )exp(
2
/ )
T
i
i
T
S x
w t u t
j
xt T dt
π
-
=
-
ò

 is the complex spectral density (CSD) of 
the ith component of the weighted sample of the DFS ui(t) obtained over the time 
interval [–0.5 T to 0.5 T], w(t) is WF symmetric with respect to the middle of signal 
sample (from the shift theorem [10], it follows that results obtained for symmetric 
time interval will be true for the nonsymmetric time interval with an account of the 
phase variation), and xi = 0.5wiT/p and x = 0.5wT/p are the normalized frequency 
of the ith DFS component and the normalized current frequency, respectively.
We assume that Si(xi) corresponds to the signal, which frequency xi is required 
to determine. Now we substitute the detailed record of (3.12) as:
	
1
1
2
(
)
(
)
1
1
(
)
(
)
0
i
i
N
N
j
j
i
i
i
i
i
i
d
e
S x
x
e
S x
x
dx
F -F
- F +F
=
=
-
+
+
=
å
å
	
(3.13)
where 
1
(
) (
)
i
j
i
i
e
S x
x
F -F
-
 and 
1
(
) (
)
i
j
i
i
e
S x
x
- F +F
+
 are spectrum items from areas w < 0 
and w > 0: (x + xi), (x – xi), and Fi = w0tdel,i + js. 
The exact solutions of (3.13) can be obtained only for some specific cases. For 
obtaining the approximated solutions, we use the widely used solution method for 
transcendent equations by approximation them in the vicinity of the analyzing point 
xl by the Taylor formula. The application of the nth power of expansion allows us 
to represent (3.13) approximately by the algebraic equation of the n - l power.
The quadratic and cubic approximation of the function S(x) in the vicinity of 
the point x1 gives, respectively, the first xmax1 and the second xmax2 approximated 
solutions permitting us to estimate errors D1(x1) and D2(x1):
	
{
} {
}
¢¢
2
2
1
1
max1
1
1
1
(
)
( )
( )
x
x
x
S x
S x
D
=
-
» -


	
(3.14)
	
{
}
{
}
{
} {
}
{
}
2
2
2
1
1
1
2
1
max2
1
2
2
2
1
1
(
)
2
(
)
(
)
(
)
1
1
(
)
(
)
S x
S x
S x
x
x
x
S x
S x
ì
ü
¢¢¢
ï
ï
¢¢
¢
ï
ï
ï
ï
D
=
-
»
-
-
í
ý
¢¢¢
é
ù
ï
ï
¢¢
ê
ú
ï
ï
ê
ú
ï
ï
ë
û
î
þ





	
(3.15)

3.3  Estimation of the Difference Frequency	
73
where {
}
( )
2
1
(
)
n
S x

 is a value of the nth derivative of the spectrum modulus square on 
frequency x = x1. In the literature, we can meet the simpler solution of (3.14), which 
is true at a high signal/interference ratio. 
Figure 3.1 shows functions of the estimation error of signal frequency (1.6) 
determined according to the approximate equation (3.15) (dotted line). This error 
is caused by the influence of the SL of periodic spectrum prolongation of this signal 
located in the area w < 0. In addition, the uniform weighting function is used. In the 
same figure, the frequency estimation error D(x1) = xmax – x1 is shown by the solid 
line, which is obtained from numerical solution of (3.12).
A comparison of the obtained results shows that (3.15) allows determination 
the difference frequency estimation error caused by the spurious SC with the error 
accepted for practical application only in the case when in the area of the main lobe 
the spurious SC is essentially less than the useful item (in the discussed example this 
is the frequency area of the main lobe interaction with the SL of SC from the area 
w < 0: x1 ³ 0.7). According to (3.14), the error is determined with the larger mistake 
(not shown in the figure). However, at a low level of the spurious SC, this simple 
expression gives the accepted results. 
Let us correct the mentioned solutions so that to get the satisfactory result at 
arbitrary amplitude relation of useful and spurious SC for the equation of not more 
than the second power. As a result of the comparative analysis of various solutions 
in different situations, we may translate the approximate estimations of the solution 
in (2.13) to the form: 
	
1
1
1
1
1
1
1
1
1
1
{Re[ (
)]} {Re[ (
)]}
{Im[ (
)]} {Im[ (
)]}
(
)
{Re[ (
)]} {Re[ (
)]}
{Im[ (
)]} {Im[ (
)]}
S x
S x
S x
S x
x
S x
S x
S x
S x
×
+
×
¢
¢
D
» -
×
+
×
¢¢
¢¢








	
(3.16)
	
2
1
1
1
(
)
(
)
x
x KD
D
» D
	
(3.17)
where 
2
1
1
2
1
1
(
)
2(
)
1
1
(
)
(
)
pS x
x
K
pS x
x
D
ì
ü
D
ï
ï
»
-
-
í
ý
D
ï
ï
î
þ
Figure 3.1  Plots of the frequency estimation error defined by the approximated equation (3.15) 
(dotted line) and by numerical solution of (2.12) (solid line).

74	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
	
1
1
1
1
1
(3)
(3)
1
1
1
1
{Re[ (
)]} {Re[ (
)]}
{Im[ (
)]} {Im[ (
)]}
(
)
{Re[ (
)]} {Re[ (
)]}
{Im[ (
)]} {Im[ (
)]}
S x
S x
S x
S x
pS x
S x
S x
S x
S x
×
+
×
¢
¢
=
×
+
×








	
At superposition of spectrum lobes of the same amplitude, (3.20) gives the 
mistake in determination of the estimation error up to 10% at the frequencies x1 
and x2 difference, which is less than permissible. The reduction of the spurious SC 
amplitude in the area of the main lobe of estimating spectrum leads to a decrease 
of errors according to (3.16), (3.17), (3.14), and (3.15). If the ratio of useful SC to 
the spurious is one more than 10, the values of errors do not exceed 0.4%. In this 
case, neglecting items of a higher smallness order, we can essentially simplify (3.19). 
As a result, we obtain:
	
WF
max
WF
WF
2cos(2 )
(
)
/
(
)
[
(0)
cos(2 )
(
)]
R
R
R
R
S
x
R
x
x
S
S
x
δ
-
F
¢
D
=
-
»
+
F
¢¢
¢¢
	
(3.18)
where xmax is a position of the SD of the DFS maximum and SWF(x) is the WF 
spectrum. 
We also note that for any WFs and any ranges the sequence of frequencies with 
zero estimation error is determined by (3.14) to (3.17) without mistakes. In Figure 
3.1, these are points of the curves’ intersection with the x-axis.
3.3.2  The Truncation Error of the Difference Frequency Estimation at the 
Weighting Functions of Dolph-Chebyshev and Kaiser-Bessel
Let us consider the Dolph-Chebyshev (DC) WF and the Kaiser-Bessel (KB) WF [3] 
as having the undoubtedly practical and theoretical interest due to properties of 
their spectra. In our problem, the interest of the mentioned WFs is connected with 
the fact that their shape and the shape of their SAD (determined by a shape of the 
main lobe and the level of SLs) can be varied by one parameter, which allows eas-
ily enough the connection of the SAD shape variation with the general rules of the 
truncation error of range measurement. We determine the influence of SAD WF 
shape upon the frequency estimation error excluding the influence of dicretization 
frequency. Therefore, we use equations for WF and their CSD for the processing of 
continuous signals, which have a more compact form. 
On the basis of results [37], we obtain the normalized expression for CSD of 
DC in the form of the segment of the sine signal weighted by DC WF:
	
(
)
(
)
2
2
2
DC
2
2
2
exp(
)
( )
ch ln
1
(
)
exp(
2 ) ch ln
1
(
)
j
S
x
Q
Q
x
Q
j
Q
Q
x
π
π
D
S
ì
F
=
+
-
-
í
î
ü
+
-
F
+
-
-
ý
þ

	
(3.19)
where Q–1 is SL level of SAD items, xD = x – x1, xS = x + x1. For DC WF, (3.18) 
leads to:
	
2
3
2
2
2
1
2
cos(2 )sh
sh
cos(2 ) (
)sh
ch
R
R
b L Z
Z
Z
L
L
b
Z
Z
b Z
Z
δ
π
D
-
F
»
é
ù
+
F
+
-
ë
û
	
(3.20)

3.3  Estimation of the Difference Frequency	
75
where 
(
)
2
ln
1
L
Q
Q
=
+
-
; Q–1 is the SL of the SD; 
2
2
Z
L
b
=
-
; b = pxR.
Now we write the envelopes of fast-error oscillations (3.20) as: 
	
(
)
1
2
3
2
2
2
max
1
( 1)
2
sh
sh
( 1)
sh
ch
n
n
R
R
bLZ
Z
Z
L
L
b
Z
Z
b Z
Z
δ
π
+
D
-
æ
ö
»
ç
÷
è
ø
é
ù
+ -
+
-
ë
û
	
(3.21)
From here we have the approximate relation for envelope of slow oscillation: 
	
2
2
max,max
(
/
)
2
sh
R
R
bL
L b
L
δ
π
é
ù
D
» ±
-
ë
û 	
(3.22)
The functions (3.20) through (3.22) are drawn in Figure 3.2.
We see that the function has a double periodicity. There are fast oscillations 
with the period equal to a quarter of the carrier oscillation wavelength, and the 
slow envelope with nodes, in which the range measurement error is equal to zero. 
Slow oscillations are connected with the presence of SAD SLs. The EN arises under 
condition that at range variation side lobes of SAD in the area w > 0 coincides with 
the extreme location of the main SAD lobe from the area w > 0. From (3.16), we 
obtain the equation for ranges corresponding to the ENs: 
	
2
2
2
,
/
/
R ex
ex
R
x
R
N
L
δ
π
=
+
=
	
(3.23)
where N = 1,2,3,... is EN, index ex designates the exact value. From (3.24) it follows 
that the EN position on the axis of normalized range depends upon the SL number 
N and the WF parameter Q and displaces towards increasing at their growth. 
Figure 3.3 shows the function of position xRT on the normalized range axis of 
first six ENs versus Q. The numbers at the curves correspond to the EN number.
The CSD of the DFS in the form of the sine signal segment with the KB WF with 
consideration of introduced designations can be written as [3]: 
	
2
2
2
2
KB
2
2
2
2
exp(
) sh
sh
( )
exp(
2 )
sh(
)
j
x
x
S
x
j
·
x
x
πα
π α
π α
πα
π
α
π
α
D
S
D
S
æ
ö
´
F
-
-
=
+
-
F
ç
÷
ç
÷
-
-
è
ø
	
(3.24)
Figure 3.2  The function of the normalized measurement error versus normalized range for DC WF 
at Q = 30 dB.

76	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
where a is a parameter determining the main lobe width and the SL level.  
We should note that the limit case of KB WF at a = 0 corresponds to the uni-
form WF, which is widely used in theoretical analysis and practical applications. 
Thus, KB WF gives possibility to analyze the influence of the sidelobe level (SLL) of 
the spectrum from the maximal (-13.6 dB) to any low values.
Taking (3.24) into consideration, from (3.18) after transformations, we obtain 
the following equation for the instantaneous normalized truncation error for range 
measurement with the KB WF:
	
3
3
2
1
2 cos(2 )
sh
ch
cos(2 )[
]
R
R
b
US
S
S
S
S
U
b V
δ
π
D
-
F
=
-
+
F
+
	
(3.25)
where S = pa; a is a parameter defining the main lobe width and SLL; 
2
2
Y
S
b
=
-
; 
3
(sh
ch )
U
Y
Y
Y Y
=
-
; 
2
5
[(
3)sh
3 ch ]
V
Y
Y
Y
Y Y
=
+
-
.
From (3.25), we obtain envelopes of fast error oscillations:
	
1
3
3
2
max
1
( 1)
2
sh
ch
( 1)
(
)
n
n
R
R
bUS
S
S
S
S U
b V
δ
π
+
D
-
æ
ö
=                                                        , n = 1;2
ç
÷
è
ø
-
+ -
+
	
(3.26)
From here we obtain the approximated equation for slow oscillation envelope:
	
3
2
2
max,max
(
/
)
4
exp(
)/[ (
1)(
)]
R
R
b S
S
S
b
S
δ
π
D
» ±
-
-
-
	
(3.27)
Functions (3.25) through (3.27) for a = 1 are presented in Figure 3.4. From 
Figures 3.2 and 3.4, we see that for different WFs the character of functions remains 
unchanged. The EN position on the range axis in this case is determined by the 
following equation: 
	
(
)
2
2
2
2
tg
ex
ex
b
S
b
S
-
=
-
	
(3.28)
Having designated 
2
2
ex
k
b
S
π
=
-
, we get the first roots of (3.28):
	
1
2
3
4
5
6
1.43029666;
2.45902403;
3.47088972;
4.47740858;
5.48153665;
6.48438713.
k
k
k
k
k
k
=
=
=
ü
ý
=
=
=
þ
	
(3.29)
Figure 3.3  The function of range points positions with zero measurement error versus the root 
number and Q for DC WF.

3.3  Estimation of the Difference Frequency	
77
For KB WF the EN position on the normalized range axis depends also upon 
the root number of equation (3.28) and the WF parameter a. With a number and 
the parameter a increasing, EN displaces toward the large range because at that 
time the spectrum main lobe increases.
Figure 3.5 shows the function of the first six ENs positions xRm on the normal-
ized range axis versus a. The numbers at each curve correspond to the EN number. 
Comparing Figures 3.3 and 3.5, we can make a conclusion that both KB WFs have 
similar characteristics of these functions. 
3.3.3  Minimization of the Measurement Error on the Basis of the FM 
Parameter Optimization
Application of Additional Slow FM 
This method is based on the dependence of the instantaneous measurement error (3.20) 
and (3.25) upon the DFS phase. Varying the phase F1 within the limits [0, p] at fixed 
range and averaging the obtained results, it is possible to minimize the average value 
of the distant measurement error. We can change the DFS phase at the expense of ad-
ditional slow FM of the carrier frequency w0 [24]. To provide the required phase shift 
by p, the range of additional FM sweep should depend upon the measuring range:
	
slow
R
F
F x
D
= D
	
(3.30)
Figure 3.4  The function of the normalized measurement error versus normalized range for KB WF 
at a = 1.
Figure 3.5  Plots of functions of range point position with zero error versus the point number and 
a for KB WF.

78	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
Before measurement performance the measuring range is unknown; therefore, 
this optimization method is in essence the iteration method with a multiple repeat of 
measurements and further specification of DFslow according to (3.30) at each iteration. 
Therefore, the first measurement is carried out without additional FM to obtain zero 
approximation (0)
R
x
 and to calculate 
(0)
slow
F
D
 according to (3.30). Then the cyclic repeat 
of the average procedure occurs by means of multiple range measurements with differ-
ent carrying frequencies, which change discretely in the range from w0 to w0 + 2pDFslow 
with the fixed step DFslow/Naver (where Naver is a number of averaged measurements), 
and by means of result average. This procedure repeats up to reduction of modulus 
of difference between new obtained value ( )
n
R
x
 and its previous value (
1)
n
R
x
-

 below the 
value Dx specified in advance:
	
( )
(
1)
n
n
x
R
R
x
x
-
-
£ D


	
(3.31)
The described method of error reduction requires significant additional resources 
in the FM sweep and in measurement time. 
The results of such averaging performed with the help of (3.20) and (3.25), are 
shown, respectively, in Figure 3.2 for a = 1 and in Figure 3.4 for Q = 30 by thick 
solid curve in the form of the function of the normalized range measurement error 
DR/dR versus the relative range. We see that the nonsymmetry of the fast oscillation 
envelope does not allow the reduction of the measurement error up to zero. For 
DC and KB WFs, the error decreases by eight to 10 times on small ranges. With the 
range increasing, the benefit increases. 
Optimization of the FM Sweep 
This approach takes into account the invariance of EN position on the axis of 
normalized range xR,ex at invariance of WF parameters. At the same time, position 
of the point xR corresponding the measuring range depends on dR, that is, on DF. 
Therefore, at each range, varying DF, one can displace xR toward to one of the near-
est EN xR,ex with the zero measurement error.
The following is the procedure of adaptive optimization:
Step 1:
• 
 The range measurement is carried out at maximal possible value of 
DF(0) to obtain zero approximation (0)
R
x
 and to determine the number of the 
nearest EN for DC WF:
	
2
(0)
2
2
Int
/
R
N
x
L π
=
-

(
)
	
(3.32)
and the number of the solution root ik

 of (3.28) for KB WF, which is the nearest 
from below the value
	
(
)
2
(0)
2
R
k
x
α
=
-

	
(3.33)
Step 2:
• 
 The normalized value of range for EN xRT according to (3.23) for DC 
WF and according to the formula 
2
2
,
R ex
i
x
k
α
=
+

 for the KB WF. 

3.3  Estimation of the Difference Frequency	
79
Step 3:
• 
 The value of the FM sweep is corrected as
	
(
1)
( )
(
1)
,
/
n
n
n
R ex
R
F
F
x
x
-
-
D
= D

	
(3.34)
Step 4:
• 
 Using the obtained value of DF(n), we provide measurement of the next 
approximation for normalized range ( )
n
R
x
.
Step 5:
• 
 Steps 3 and 4 are repeated until the performance of condition 
(3.31).
For convergence of the iteration process, it is necessary to use EN with a num-
ber not less than 2, which is connected with the rather large measurement error 
level at small xR.
The results of optimization are shown in Figure 3.6 for DC WF and in Figure­ 
3.7 for KB WF by thin solid lines. The average level of the achievable error is 
­defined by the value Dx. In Figures 3.6 and 3.7 we see plots for Dx = 10–14.
The achieved error level is equal to 10-9 for the KB WF with a = 1 and 10-17.5 
for the DC WF with Q = 30 dB. The fact that the average measurement error level 
achieved by optimization of the FM sweep does not depend on the range is practi-
cally important. 
Figure 3.6  The measurement error at optimal values of the FM sweep for the DC WF.
Figure 3.7  The measurement error at optimal values of the FM sweep for the KB WF.

80	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
The Combined Method of the FM Parameter Optimization 
This method combines the above-mentioned approaches. At first, carrying out opti-
mization of the FM sweep obtaining DFopt is required. Then for this optimal value, 
the average results of several measurements are provided for the smooth additional 
slow variation of w0 by the value defined by (3.30), where the obtained values 
of DFopt and 
( )
n
R
x
 are used. The results obtained at calculations according to this 
­approach are shown in Figures 3.6 and 3.7 by the thick solid line. 
We see that the total measurement error level at averaging using the additional 
slow FM decreases additionally approximately by the order for the KB WF and by 
two orders for the DC WF. 
3.3.4  Error Minimization on the Basis of Optimization of Weighting Function 
Parameters
This method of optimization is based on the dependence of the SAD WF extreme 
position upon its parameters. 
The possible approaches to optimization and some restrictions are:
Parameter variation of the weighting function leads to displacement of SD 
1.	
SL extremes. Figure 3.8 shows the variation of the SAD DC WF shape as 
an ­example. In the logarithm scale signal, SAD items with a normalized fre-
quency of three bins and two values of Q are represented. The SAD item in 
the positive frequency area with the ratio Q = 20 dB is drawn with a thin solid 
line. The SA item on the negative frequency area is drawn with a dotted line. 
It is theoretically possible to see a coincidence of the extremum, at first, of 
the fifth lobe of the item from the area w < 0 with the maximum of the main 
lobe from the area w > 0. For this, it is necessary that Q = 20 dB (thick solid 
and dotted lines).
In the general case, thanks to EN displacement along the normalized range 
axis at variation of WF parameters, its optimization is possible. For considered 
DC and KB WFs, equations linked parameters of the optimal WF with the mea-
Figure 3.8  Variation of SD DC WF shape at SLL variation Q.

3.3  Estimation of the Difference Frequency	
81
suring range are specified by (3.23) and (3.28). The optimization procedure in 
this case should be iterative. Just after switching on FMCW RF, the measure-
ment should be begun with such WF parameters, at which, on the minimal 
measuring range, the overlap of the main SAD lobes SWF(xD) and SWF(xS) does 
not happen. These values can be obtained according to formulas:
	
(
)
2
2
2
min
min
min
min
min
1
1 /(2
),
(2
)
R
Q
B
B
x
k
α
=
+
=
-
	
where 
2
min
min
exp
(2
)
1
R
B
x
π
é
ù
=
-
ê
ú
ë
û, 
2
2
min
min
1
(2
)
R
x
k
α
=
-
; k1 is the 
value of the first root in (3.20).
The sequence of actions at the range measurement using the WF param-
eter optimization is:
Step 1:
• 
 Samples of measuring DFS are recorded in the computing device 
memory and according to them for given Qmin or amin the SAD is calculated, 
the position of the spectrum modulus maximum is obtained, the measuring 
range and zero approximation for (0)
R
x
 are calculated.
Step 2:
• 
 Then, according to (3.23) and (3.28), the number N  of SL of SWF(xS) 
is determined, which overlaps with the main lobe of SWF(xD) for DC WF is 
the value of the root ik

 for KB WF.
Step 3:
• 
 DC WF parameters are specified:
	
( )
( ) 2
( )
[(
)
1]/[2
],
1,2
n
n
n
Q
B
B
n
=
+
=



…	
	
where 
(
)
2
(
1)
exp
2
n
n
R
π
-
( )
2
B
x
N
é
ù
=
-
ê
ú
ë
û



or for the KB WF
	
(
)
2
(
1)
( )
2
2
;
1,2
n
n
i
R
x
k
n
α
-
=
-
=



…	
Step 4:
• 
 According to the recorded samples (in memory), the nth approxima-
tion ( )
n
R
x
 is calculated at specified WF parameter values.
Step 5:
• 
 Steps 2 to 4 are repeated until the (3.31) performance.
In each iteration cycle, it is necessary to count completely all WF samples, 
which are used at SAD calculation. For this the computing device must have 
enough performance. 
Calculations performed on the basis of such approach are shown in 
Figures 3.9 and 3.10 by thin solid lines. We see that in this case the re-
sults obtained for the DC WF are better than for the KB WF. The difference 
achieves approximately six to seven orders. With the range increasing, the 
error sharply decreases. 
It is clear that the considered method for the WF parameter optimization 
may be added by the results averaging for additional slow FM. Appropriate 
results are presented in Figures 3.9 and 3.10 by thick solid lines. The benefit 
achieves approximately two orders.

82	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
There are limitations on practical implementation of measurement error opti-
2.	
mization of WF parameters at each measuring range. It is seen from Figure 3.8 
that the described coincidence of the fifth SL extremum of the SAD item from 
the area w < 0 with the maximum of the main lobe for the area w > 0 led to 
essential SLL and the main-lobe width variations. The sharp reduction of the 
nearest SL width and practically unchanged position and widths of far lobes 
are peculiarities of the signal’s SAD processed by both the DC WF and KB 
WF. This feature is intensified at the discrete signal processing. Therefore, the 
greater number of signal samples, the more sensitive is the situation to varia-
tion of the nearest SL level. Taking into consideration that general regulations 
are true both for the DC WF and for the KB WF, we describe here the CSD of 
the discrete signal for DC WF only:
–16
–18
–22
–262
3
4
5
6
7
–24
–20
Figure 3.9  The measurement error at optimal values of the a parameter for DC WF.
Figure 3.10  The measurement error at optimal values of the a parameter for KB WF.

3.3  Estimation of the Difference Frequency	
83
	
p
p
D
S
ì
é
ù
æ
ö
F ï
=
-
í
ê
ú
ç
÷
-
è
ø
ï
ë
û
î
ü
é
ù
æ
ö ï
+
-
F
-
ý
ê
ú
ç
÷
-
è
ø ï
ë
ûþ
DC
0
0
0
0
0
0
0
exp(
)
ach
.
.
( ,
,
)
ch (
1) ach ch
cos
1
ach
.
.
exp(
2 ) ch (
1) ach ch
cos
1
j
Q
x
S
x Q M
M
Q
M
M
Q
x
j
M
M
M
	
(3.35)
The positions of its extremums are:
	
0
max
0
0
0
ach
(
,
,
)
arccos
cos
ch
1
1
M
N
Q
x
N Q M
M
M
π
π
é
ù
×
æ
ö
æ
ö
=
ç
÷
ç
÷
ê
ú
è
ø
è
ø
-
-
ë
û
	
(3.36)
From here, the required value of 

Q for error minimization is:
	
( )
0
0
0
ch (
1) ach
cos
cos 2
1
n
R
N
Q
M
x
M
M
π
π
ì
ü
é
ù
×
ï
ï
æ
ö
æ
ö
=
-
×
í
ý
ç
÷
ç
÷
ê
ú
è
ø
è
ø
-
ï
ï
ë
û
î
þ


	
(3.37)
Figure 3.11 shows by the dotted and solid lines, respectively, the positions 
of extremums of the thirteenth and fourteenth SL of the SAD item in the area 
of w < 0 for these SLs coincident with the main lobe by means of Q specifica-
tion. Thick lines correspond to high discretization frequency, at which 1,024 
samples are obtained on the signal duration. Therefore, the signal frequency 
is significantly less than the Nyquist frequency and the redundant discretiza-
tion frequency is used. Thin lines correspond to the low discretization fre-
quency, at which 32 samples are obtained on the signal duration. Therefore, 
the signal frequency is commensurable with the Nyquist frequency. 
An increase of the relative signal frequency leads to the fact that because 
of the mentioned features of the signals’ SAD with the DC WF and KB WF, 
the error minimization in the considered form becomes impossible at any 
high discretization frequency. 
We must take into consideration than among popular WFs there are no 
such WFs, which properties can be easily varied. Therefore, for error mini-
mization by WF parameter variations, we can formulate a task of creation of 
specific WFs free from this shortcoming. 
Figure 3.11  Extremum positions of the thirteenth and fourteenth SL of the SAD item in the nega-
tive frequency area at variation Q for two values of discretization frequencies.

84	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
We can try to overcome the mentioned limitations by the simplified method 
3.	
of the WF parameter optimization sacrificing by the minimal measurement 
error and refusing from WF parameter correction in each current point of 
the range. Let us consider the possibility to use of the method described in 
Chapter 2 minimizing the average square of the measurement error calcu-
lated on range segment equaled to QI by means of WF parameter optimiza-
tion. The criterion function can be written in the form [38–42]:
	
[
]
2
2
aver,
1
(
, )
(
, )
min
R
K
L
Li
R
R
p
i
R
p
R R
p
K
σ
=
=
D
Þ
å
	
(3.38)
where KR = dR/D is a number of calculation points on the one range segment; D 
is a step in range (in this case D £ l 0/4); RLi = (L – 1)dR + (i – 1)D is the ith cur-
rent measuring range within the Lth segment; p is the WF parameter, according 
to which minimization is provided (p = Q for the DC WF and p = a for the 
KB WF); Raver,L is the range corresponding to the middle of the Lth segment. 
The calculation results according to (3.38), without optimization for the uni-
form WF, DC WF, and KB WF with parameters, respectively, Q = 30 dB and a = 1, 
are presented in Figure 3.12.
The error function character versus range is completely defined by variation 
of SLL WF SD. It is seen that for the DC WF having the constant SLL of SD, the 
measurement error remains approximately constant beginning from some range. 
For uniform WF and KB WF, the monotonic decrease of measurement error occurs 
for range increasing. 
The search of optimal parameter values according to (3.41) from each WF was 
provided by the numerical method with the help of “fminbnd” program from the 
MATLAB 6.5 package. After the calculation of optimal parameter values with the 
Figure 3.12  The function of logarithm of the normalized average square of the measurement error 
versus normalized range for DC WF with Q = 30 dB and KB WF with a = 1.

3.3  Estimation of the Difference Frequency	
85
help of the method of linear regression [43, 44], the empirical relation was obtained 
connecting these parameters with the average relative range. For the DC WF and 
KB WF, respectively, these relations are:
	
aver
27.392
22.31719 dB
R
Q
x
=
-
	
(3.39)
	
aver
(1.0073
0.8257)
R
x
α
π
=
-
	
(3.40)
As a result, only two coefficients for each WF should be saved in the memory 
of the FMCW RF computing device at its manufacture. At first measurement after 
each activation of FMCW RF, the WF parameters are used corresponding to mini-
mal range. All optimization is provided by calculation manner. For this signal, sam-
ples are recorded into online memory and calculation of the initial range estimation 
is provided according to them. Then, according to this range, measured with an 
error, the number of the range segment is determined with the unchanged value of 
WF parameters and the choice of the needed parameter value is performed. Now, 
basing DFS samples recorded into the online memory, the new range calculation is 
provided using this parameter value. 
Calculation results of the average measurement error according to (3.38) using 
(3.20) and (3.25) and the optimal parameter values (3.39) and (3.40) remaining 
unchanged on chosen range segments are presented in Figure 3.13. The measure-
ment error for KB WF is shown by a thin solid line, and the measurement error for 
DC WF is shown by a thick solid line. For comparison, calculation results without 
optimization with the uniform WF are shown by a chain line. 
At such optimization, it is also required to recount WF samples. However, this 
should be done much more seldomly, only at the transfer from one range segment to 
another. As a result, the necessity in the iterative process disappears. Therefore, this 
method requires minimum time expenses on parameter optimization and provides 
rather good results. 
Figure 3.13  The function of logarithm of normalized averaged square of the measurement error 
versus normalized range for optimal parameters of DC WF and KB WF.

86	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
3.3.5  Minimization of the Truncation Error Using Adaptable Weighting 
Functions
In the Appendix, we show that the problem of elimination of the range measurement 
error can be solved if there is WF, which shape can be specified by varying param-
eters in such a manner that at the signal frequency the spurious SAD item would be 
equal to zero together with the specified number of its derivatives. WFs obtained 
under these conditions are called adaptable WF (AWF). Important feature of AWF is 
a possibility of specifying of SAD N zeros at normalized frequencies b1, b2,...,bN.
For effectiveness analysis of the mentioned AWFs in (A.13) and (A.14), we con-
sider the earlier discussed problem of minimization of the DFS frequency estimation 
error on the background of the spurious SC from the frequency area w < 0.
As earlier, we assume that before the measurement performance, the estimat-
ing range is unknown. Due to this, the process of determination of WF necessary 
parameters is iterative with multiple repeating of calculations and specifying of fre-
quency values of given zeros b of AWF at each iteration. This procedure is repeated 
until the performance of the condition (3.31). In each iteration cycle, it is necessary 
to recalculate completely all AWF samples used at the SD calculation. 
For original estimations, one can use different known effective WFs of WFs 
with optimal parameters, which are presented in the Appendix. Then we use AWFs, 
whose properties are adapted at range variation. 
3.3.6  Algorithms of Frequency Estimation Using Adaptable Weighting 
Functions 
The algorithm 1 is the simplest with constant values of a number varying SAD zeros 
N of AWF, and it is the same as analyzed in Section 3.3. However, the procedures 
of analytical determination of the frequency corresponding to theoretical absence 
of the truncation error are excluded in it.  
The algorithm 2 realizes possibility of independent control of WF parameters 
for minimization both the truncation error of frequency estimation and the error. 
From Figure A.9 we see the opportunity of the ENB limitation increasing both at N 
increase and with the increase of estimating frequency ( )
( )
( )
( )
2
3
1
2
n
n
n
n
N
b
b
b
x
=
=
=
=

…
, 
if one from the SD varying zeros, for instance, with number 1, is defined from the 
condition of the ENB minimum obtaining, b1 = bn,min.
Step 1:
• 
 Samples of extracted DFS are recorded in the memory of calculation 
device and according to them, if the optimal WFs of the Appendix are used, 
for chosen N1 and 
…
1
1
2
,
,
N
b b
b  the estimating frequency and zero approxima-
tion for (0)
1x
 are calculated.  
Step 2:
• 
 The total order of AWF SD varying zeros N + 1, which is greater 
by one than the zero order N, minimizing the spurious SD item and its de-
rivative. The value of (0)
(0)
(0)
(0)
2
3
1
1
2
N
b
b
b
x
+
=
=
=
=

…
 is specified. We accept the 
value of one of the SD varying zeros b1 = bn,min in accordance with (A.25) 
or (A.26) using, respectively, AWF ws(mo,b1,b2...bN) or wc(mo,b1,b2...bN). 
According to the recorded signal samples, we calculate the next and n – th 
approximation at specified WF parameters.
Step 3:
• 
 Step 2 is repeated until performance of (3.31).

3.3  Estimation of the Difference Frequency	
87
The theoretical error of frequency estimation using AWF at noise absence is 
equal to zero; therefore, to estimate the achievable error reduction, we consider 
simulation results of offered process of DFS frequency estimation on the back-
ground of the white normal noise.
Numerical simulation was carried out in the MATLAB medium. Taking into 
consideration that the estimation of the small normalized DFS frequencies (less than 
10) has the most interest, the discretization interval in presented examples accepts 
that DFS contained 32 samples. 
The calculation results obtained according to this approach using AWF in 
(A.12) with three varying zeros N + 1 = 3 are shown in Figure 3.14 by the solid 
curves:
	
(
)
[
]
3
1
1
( )
1
( 1)
( ,
)cos (2
0.5
)
n
s
sn
n
w m
C
b b
n m
M
=
=
+
-
+
å
	
(3.41)
where M = p/M0
	
2
1
1
1
2
2
1
2sin3
cos(2
)
cos(2
) cos(2
)
cos(2
)
( ,
)
sin4
2sin (
)
2sin (
)
s
M
M
b M
M
bM
C
b b
M
b M
bM
-
-
é
ù
=
ê
ú
ë
û
	
	
2
1
2
2
2
1
1
sin3
cos(4
)
cos(2
) cos(4
)
cos(2
)
( ,
1)
cos2
sin5
2sin (
)
2sin (
)
s
M
M
b M
M
bM
C
b b
M
M
b M
bM
-
-
é
ù
=
ê
ú
ë
û
	
1
3
1
2
1
2
2
1
sin
cos(6
)
cos(2
)
( ,
)
2cos2
cos3
sin5
2sin (
)
cos(6
)
cos(2
)
2sin (
)
s
M
M
b M
C
b b
M
M
M
b M
M
bM
bM
-
=
-
é
ù
´ ê
ú
ë
û
Figure 3.14  The logarithm of normalized MSD truncation error of frequency estimation of the 
signal weighted by DC WF and AWF ws = (m0,b,3,32) and ws = (m0,b,4,32): 1 indicated q = 20 dB, 
2 indicated q = 60 dB, 3 indicated q = 100 dB, and 4 indicated without noise.

88	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
In this example, the frequency of one of the zeros b1 = bn,min is defined by condi-
tion of ENB minimization:
	
(
)
(
)
(
)
(
)
(
)
(
)
4
4
4
2
2
2
2
2
2
2
2
2
2
,min
4
4
4
2
2
2
2
2
2
2
2
2
25
1
64
2
9
3
25
1
16
2
1
3
n
b
b
b
b
b
b
b
-
+
-
+
-
=
-
+
-
+
-
	
(3.42)
The frequencies of two other zeros b2 = b3 = b on signal frequency x1 = 0.5b 
minimize of the spurious SC from the area w < 0 and its first derivative. 
For comparison, the results of frequency estimation using DC WF with optimal 
values of the shape parameters are presented in Figure 3.14 by the dotted line.
The dependence of zero frequency ensuring the minimum of ENB (3.42) versus 
signal frequency is shown in Figure 3.15.
The last algorithm provides the minimal error for estimation on the noise back-
ground, which confirms obtained theoretical results of the comparative ENB analy-
sis of various AWF (see the Appendix).
Obtained results of numerical experiments show that in contrast to DC WF 
with the optimal shape parameter, which provides the least truncation error from 
all traditional WFs and for which at estimations of short signal sample (containing 
one to two periods of the signal) the main contribution in the error level is intro-
duced by the truncation error, at using of AWF the truncation error component is 
practically absent, and the component caused by the noise, is 1.15 to 2 times less 
than at the DC WF application.
3.4  Average Weighted Estimation of the Difference Frequency
3.4.1  The Truncation Error of the Average Weighted Estimation
In connection with the fact that the estimation (3.10) is based on the analysis of the 
SD shape, all of these notes concerning the SD shape distortions in areas w > 0 and 
w < 0 especially strongly manifested at small ranges.
Figure 3.15  The function of AWF zero frequency ensuring ENB minimization versus signal  
frequency. 

3.4  Average Weighted Estimation of the Difference Frequency	
89
Having transformed the numerator of (3.10), we obtain the truncation error of 
frequency measurement [40, 45–47]:
	
(
) (
)
(
)
upp
upp
low
low
2
2
S
n
n
R
n
R
n
n
n n
n n
j
S j
ω
ω
ω
ω
ω
=
=
D
=
-
å
å


	
(3.43)
where (
)
n
S jω

 is a value of the complex DFS spectrum at discrete frequency wn and 
nlow and nupp are the lower and upper numbers of processed discrete frequencies. 
For future analysis of the measurement error it is necessary to consider the structure 
of (3.43). We assume that the analysis is performed under conditions listed in designa-
tions (3.12). Then the numerator (3.43) can be presented in the form of three items:
	
2
1
2
1
WF
2
2
n
R
R
n n
n
x
n
x
A
S
K
K
π
π
=
-
-
æ
ö
é
ù
=
ç
÷
ê
ú
è
ø
ë
û
å

	
2
1
2
2
WF
2
2
n
R
R
n n
n
x
n
x
A
S
K
K
π
π
=
-
+
æ
ö
é
ù
=
ç
÷
ê
ú
è
ø
ë
û
å

	
π
π
π
=
ì
ü
-
+
-
æ
ö
æ
ö
æ
ö
=
-
F
ç
÷
ç
÷
ç
÷
í
ý
è
ø
è
ø
è
ø
î
þ
å


2
1
3
WF
WF
2
2
2
2
Re
exp(
2 )
n
R
R
R
n n
n
x
n
x
n
x
A
S
S
j
K
K
K
	
(3.44) 
where Re{*} designates the calculation of the real part of the complex number. 
The denominator Den in the formula (3.43) has a view:
	
π
π
π
π
=
é
-
+
æ
ö
æ
ö
ê
=
+
ç
÷
ç
÷
è
ø
è
ø
êë
ù
ì
ü
+
-
æ
ö
æ
ö
+
-
F
ç
÷
ç
÷
í
ýú
è
ø
è
ø
î
þû
å




2
1
2
2
WF
WF
WF
WF
2
2
2
2
2Re
exp(
2 )
n
R
R
n n
R
R
n
x
n
x
Den
S
S
K
K
n
x
n
x
S
S
j
K
K
	
(3.45)
Analysis of these formulas allows some conclusions about the function character 
of the frequency estimation error on spectrum center of gravity versus WR, that is, 
the measuring range. The denominator of (3.43) represents the signal energy con-
centrated in the processed frequency range [wlow , wupp]. We shall consider ranges, 
at which there is no overlapping of main lobes of the spectral density. Under these 
conditions, at correct choice of boundaries of the processed frequency range, the de-
nominator Den does not practically depend on wR and the WF shape. The first item 
A1 of the numerator (3.43), due to symmetry of the WF spectrum, is equal to zero or 
very small at calculation according with the formula for the discrete spectrum. The 
third item A3 in integrand contains the phase multiplier exp(–j2F) and therefore, 
fast oscillations at a range variation with a period equal to a quarter of a wavelength 
of the carrying oscillation and with the phase defined by the phase of radio wave 
reflection coefficient. Moreover, it contains the product of the main lobe of the WF 
spectrum located on the half-axis w > 0 and SL of this spectrum from the half-axis 
w < 0. At the range variation, these spectra move with respect to each other. There-
fore, the result of this multiplication defining the amplitude of fast oscillations varies 
with periodicity of SL of the WF spectrum and smoothly changes at variation of SL. 
The second item A2 is the processing result in the same frequency range of the square 

90	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
of the SL spectrum located on the half-axis w < 0, therefore, in most of the cases it is 
significantly less than the third item. Thus, the measurement error is mainly defined 
by the third item A3 and strongly depends upon used WF as exactly it depends on 
the SL level influencing on the oscillation amplitude of the measurement error. 
Obtained formulas are true for arbitrary WF. As was shown in [5], all types of 
WFs can be represented using M orthogonal basis functions with periods multiple 
to the interval Tmod/2. In this case, the discrete spectrum of WF, which is necessary 
to use in (3.44) and (3.45), has a form [3, 5, 8]:
	
0
WF
1
1
( )
2
( 1)
2
2
2
M
m
m
m
n
n
m
S
n
a
a
D
K
K
n
m
D
K
π
π
π
=
ì
-
é
ù
é
ù
=
+
-
í
ê
ú
ê
ú
ë
û
ë
û
î
ü
+
é
ù
+
ý
ê
ú
ë
ûþ
å

D
	
(3.46)
where ( )
exp[ (
1) /2]{[sin(
/2)]/[sin( /2)]}
D z
j K
z
Kz
z
=
-
 is the normalized Dirichlet core 
[2, 5] and the coefficients am corresponds to the condition 
0
1
M
m
m
a
=
=
å
.
Figure 3.16 shows ratios of items A2 and A3 from (3.44) to denominator (3.45) 
for the uniform WF versus the relative range R/dR for F0 = 10 GHz and DF0 = 1,000 
MHz. The plots fully confirm the above-mentioned analysis of item properties of 
the measurement error. We see that A3 >> A2 and this inequality becomes more sen-
sible with range increasing. The item A1 in this figure is not shown even because in 
a used scale it is not noticeable practically. Thus, the range measurement error with 
the help of the average-weighted estimation (3.10) is mainly defined by the third 
item of the numerator in (3.43).
From Figure 3.16, we clearly see that the plot for A3 oscillates around the zero 
error value with two typical periodicities. As for SAD maximum, there are two 
types of points with the zero truncation error. The period of the first sequence is 
approximately l 0 /4, and the period of the second being the envelope period of the 
instantaneous error is related to periodicity of SL SAD WF. The measurement error 
smoothly decreases with range increasing. 
Figure 3.16  Functions of truncation error components of (3.46) versus the normalized range.

3.5  Systematic Inaccuracy of Frequency Estimation	
91
In the range points corresponding to nodes of the envelope A3 the exact error 
value is determined by a sum of two items (A2 + A3). Therefore, from these two 
points the value A2 has the determining influence on the value of the minimal pos-
sible error. Calculations show that these conclusions are valid as well for other 
WFs; therefore, the mentioned inequalities become stronger because the SLs of their 
spectra are much less than for the uniform WF. 
The total plots view of instantaneous measurement error versus the relative 
range reminds us of the same properties of plots obtained earlier for frequency 
estimation according to spectrum maximum. Therefore, we may expect the appli-
cability of all ­optimization methods for average weighted estimation. Nevertheless, 
there is an essential difference consisting in the fact that in points corresponding 
to zero value of A3 item envelope; the error is not equal to zero even theoretically, 
although its value can be very small. In addition, we may note that for optimization 
of the FM sweep and WF parameters in each point of the range scale it is required 
knowledge of theoretical dependence of these points’ positions with minimal mea-
surement ­error on the scale of normalized range. These formulas do not allow us to 
obtain these functions in an explicit form.
Calculations show that above-mentioned methods of measurement error minimi-
zation lead to the same results, but the level of the achievable minimal error for aver-
age weighted estimation is higher than for estimation according to SD maximum. 
3.5  Systematic Inaccuracy of Frequency Estimation for the Algorithm 
with Correction Coefficients
The reason of systematic inaccuracy appearance for the algorithm using correction 
coefficients is the same as at application the algorithm (3.4), which estimates the DFS 
frequency based on SAD maximum minus the SL influence of DFS spectrum calcu-
lated for w < 0. Figure 3.17 shows the typical dependence of the normalized instan-
taneous error versus the normalized range obtained with the help of simulation.
Figure 3.17  The function of the normalized instantaneous error versus the normalized range for the 
algorithm using correction coefficients.

92	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
The carrier frequency and the FM sweep at simulation were accordingly 10 GHz 
and 500 MHz. We see from the plot that the normalized instantaneous error has the 
double periodicity and oscillates around the zero error. One can observe fast oscilla-
tions with a period equal approximately to a quarter of the transmitter wavelength. 
The period of the envelope of fast oscillations is determined by the frequency diversity 
of DFT filters. With an increasing in the added zero sample number, the period of the 
envelope of fast oscillations decreases. The plot in Figure 3.17 is obtained at an increase 
of two times the DFS realization duration owing to the addition of zero samples. 
Functions of normalized systematic inaccuracy 
relative
aver 2
T h
σ
π
=
 versus 
the relative frequency are presented in Figure 3.18 (haver is the average error square 
obtained in the interval of signal frequency variation corresponding to the one pe-
riod of the envelope of fast oscillations). The Blackman WF [3] was used as WF. 
Functions 2 to 4 correspond to a range measurement at an artificial increase of 
the signal period by two, four, or eight times. The function 1 is obtained without 
addition of zero samples. All functions are found out beginning from the relative 
frequency equal to 1. It follows from Figure 3.20 that the most expedient process is 
to increase the signal period by two to four times. A further period increase does not 
lead to noticeable error reduction. Functions presented in Figure 3.20 are obtained 
using SAD. Application of SPD leads to the similar results. 
3.6  Influence of Noise Interference on the Error of Range 
Measurement
3.6.1  Statistical Characteristics of Estimation of the Spectral Density of DFS 
and Noise Sum
In general, the problem of SC CSD distribution finding for a sum of DFS (or a signal 
with unknown parameter) uDFS(t) and the stationary random signal x(t) (1.51) can 
be reduced to obtaining of distribution after linear inertial conversion. Obtaining 
Figure 3.18  The function of normalizes MSD versus the relative frequency for the algorithm using 
correction coefficients.

3.6  Influence of Noise Interference on the Error of Range Measurement	
93
CPD estimation distribution can be reduced to the same problem with the only 
difference being that following distribution being obtained after linear inertial con-
version, it is necessary to take into account the nonlinear conversion (obtaining 
the modulus square of the random variable, that is, the estimation of the ith SPD 
sample). In general, this problem of obtaining distributions after linear and nonlin-
ear conversions is solved [32].
We assume that the average value and the signal variance are finite. This condi-
tion is always satisfied in practice. Then, due to linear inertial Fourier conversion 
and because of the central limit theorem [32], the SC distribution of the real and 
imaginary spectrum parts will asymptotically converge to the normal independently 
upon the distribution of x(t).
We write for clearness the estimation of the nth sample of SPD as
	
( )
( )
{
}
2
2
(
)
Re
Im
i
i
i
F
S
S
T
ω
ω
ω
é
ù
é
ù
=
+
ë
û
ë
û





	
(3.47)
where Re(z) and Im(z) are real and imaginary parts of the Fourier transform from 
the sum of DFS and a noise. 
It can be noted that a problem of finding the distribution of ( )
i
G ω

 at the 
normal character of real and imaginary spectrum parts is reduced to a problem 
of obtaining the distribution of the modulus square of a two-dimensional vector, 
which projections are normal and, in general, correlated random variables having 
different mean values and variances. 
In some publications (for instance, in [32]) devoted to research of probability 
models of radio signals, the modulus distribution of the two-dimensional vector with 
the normal correlated components having the different mean values and variances 
was received. Working out it in detail for SPD estimation, after not complicated 
transformations, we can obtain the one-dimensional distribution of the estimation 
(3.47) for normal distribution of real and imaginary spectrum parts. Complexity of 
this distribution practically excludes a possibility to work with it in general. 
It is advisable to perform an approximation of this distribution by simpler one. 
For approximation, we calculated positions of image points on the Pirson plane 
[48]. Calculation results show that image points corresponding to initial distribu-
tion lay on the line corresponding to the g distribution. 
In the case when the observation interval is large enough, the distribution of 
the random variable  
	
(
)
(
)
2
1
(
)
i
u
i
i
F
S
j
S
j
T
ξ
ω
ω
ω
=
+


	
(3.48)
in assumption that at large enough observation time the real and imaginary spec-
trum parts are not correlated [27, 49], and their variances are equal, can be pre-
sented in the form [50]:
	
( )
(
)
(
)
(
)
(
)
(
)
2
i
0
j
2
j
1
exp
I
u
i
u
i
i
i
x
S
x S
W x
G
G
G
ω
ω
ω
ω
ω
é
ù
é
ù
+
ê
ú
ê
ú
=
-
ê
ú
ê
ú
ë
û
ë
û


	
(3.49)
where I0(z) is the Bessel function of zero order of imaginary argument and G(wi) is 
noise PSD on the ith frequency.

94	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
Mathematical expectation of SPD estimation and its variance can be defined in 
the form [50]
	
(
)
{
}
(
)
(
)
2
j
i
u
i
i
M F
S
G
ω
ω
ω
=
+

	
(3.50)
	
(
)
{
}
(
)
(
)
(
)
2
2
j
i
i
u
i
i
D F
G
S
G
ω
ω
ω
ω
é
ù
=
+
ë
û

	
(3.51)
If there is no a signal, that is, uDFS(t) = 0, the distribution (3.49) is transferred 
to exponential with the distribution parameter G(wi).
Distribution of SAD probabilities 
(
)
j
u
i
S
ω

 obeys the Rice distribution [32]
	
( )
(
)
(
)
(
)
(
)
(
)
2
2
i
0
j
2
j
2
exp
I
u
i
u
i
i
i
x
S
x S
x
W x
G
G
G
ω
ω
ω
ω
ω
é
ù
é
ù
+
ê
ú
ê
ú
=
-
ê
ú
ê
ú
ë
û
ë
û


	
(3.52)
that follows from its definition (in this case, asymptotic independence of real and 
imaginary spectrum parts and equality of their variances). Moments of distribution 
(3.52) can be found in [32]. Please remember that at rather a large SNR, the distri-
bution (3.52) can be approximated by the normal distribution [32].
SC of the sum of signal with unknown parameter and the white normal noise, as 
it was shown in [50], we can consider as statistically independent random variables. 
3.6.2  Influence of Noise on Accuracy of the Central Frequency Estimation
Let us assume that the additive mixture of DFS and the noisy interference (1.51) 
applies to the input of a calculating device. The interference x(t) is the stationary 
random process (SRP) with zero mean and SPD G(w). After the analog-digital con-
version and WF application, we obtain a realization of the process (1.51) presented 
in the discrete form:
	
( )
( ) ( )
( ) ( ),
1,
l
l
l
l
l
s t
u t w t
t
w t
l
K
ξ
=
+
=
	
(3.53)
Calculating the spectra of signals in (3.53), we obtain a random function of 
frequency, SAD ( )
A ω

, or an estimation of the SPD ( )
F ω

, which are used for DFS 
frequency estimation. Calculation of frequency estimation errors caused by the 
noisy interference leads to essential difficulties caused, in the general case, by non-
Gaussian SC distribution and their statistical dependence. 
Calculation of Frequency Estimation Variance for the Algorithm Using the Addition 
of Zero Samples 
For algorithm (3.5) with addition of zero samples, we determine the estimation 
variance using their multidimensional distribution of probabilities w(z1,z2,....) of 
random variables ( )
i
A ω

 or ( )
i
F ω

. The probability Pm that maximal SC will be at 
the frequency wm, 
1,
2
m
m m
=
 is determined by the integral [32]:
	
(
)
1
2
1
2
1
2
0
0
0
.....
,....
...
m
m
x
x
m
m
m
m
m
m
P
dx
w x
x
dx
dx
¥
= ò
ò
ò
	
(3.54)

3.6  Influence of Noise Interference on the Error of Range Measurement	
95
Assuming that the frequency interval, in which the maximal SC is searched, if 
wide enough, we suppose that 
	
2
1
1
m
m
m m
P
=
=
å
	
(3.55)
At the performance of condition (3.55), as a result of calculation of (3.54), we 
can obtain some discrete law of probability distribution, where each event zm (de-
termination of a number of maximal SC) will correspond its own probability Pm. 
In this case, we can calculate the frequency estimation variance as:
	
(
)
(
)
2
2
1
m m
R
m
m
m
m m
D
z
M z
P
ω
=
=
é
ù
=
-
ë
û
å

	
(3.56)
Because at the addition of zero samples SC turns out the correlated (corre-
lation coefficient is proportional of DFT filter overlapping), the calculation ac-
cording to (3.54) can only be executed by numerical methods and only when the 
multidimensional SC distribution is approximated by the normal law (i.e., at large 
SNR). Taking into consideration the calculation of labor intensiveness, it is more 
expedient to use the PC modeling for determination of estimation variance. 
Influence in Noise on Accuracy of DFS Central Frequency Estimation in the Spectral 
Domain Using Correction Coefficients 
The generation of estimation with the help of correction coefficients, according to 
(3.8), anticipates calculation of the ratio of the sum and difference of random vari-
ables, estimations of ( )
A ω

 or ( )
F ω

. Estimation of signal (1.51) SD is
	
( )
(
)
( )
(
)
(
)
2
j
2Re
u
u
F
S
G
S
j
S
j
ξ
ω
ω
ω
ω
ω
=
+
+


	
(3.57)
where 
( )
G ω

 is estimation of noise SPD and Su(jw) and Sx(jw), respectively, were 
estimations of CSD of a signal and a noise. Therefore, the frequency estimation ob-
tained using the algorithm (3.8) will be shifted. It will be shifted as well when using 
SAD. The quantitative measure of estimation shift, by definition, is the following 
quantity [32]
	
{
}
sh
R
R
M ω
ω
D
=
-

	
(3.58)
where wR is the true value of estimating quantity and M is a symbol of mathemati-
cal expectation. 
To find out the variance and the frequency estimation shift, it is necessary to de-
termine the distribution law of correction (3.9) or its moments. The non-Gaussian 
character of spectra ( )
A ω

 and ( )
F ω

, calculating on arbitrarily frequencies wi and 
determining according to (3.49) and (3.52), practically eliminates obtaining the 
exact distribution of correction and exact expression for its moments. Therefore, 
we use the approximate method. 
Let us define spectra of a signal and a noise after WF application. The signal spec-
trum Ss(jw) in this case can be easily calculated using the following relations [3]:

96	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
	
(
)
( ) ( )
(
)
0
WF
1
1
( )
2
T
j t
u
S j
u t w t e
dt
T
S jv S
j
v dv
T
ω
ω
ω
π
-
¥
-¥
=
é
ù
=
-
ë
û
ò
ò
	
(3.59)
where w(jw) is the WF spectrum. The SPD of a noise G¢(w) after WF application 
will be defined by the known relation [3]:
	
( )
( )
(
)
2
WF
2
T
T
G
G
S
j
d
π
π
ω
ω
ω
ω
π
-
=
¢
ò
	
(3.60)
that is, a noise has arbitrary SPD. 
We assume that the SNR for SC with numbers n – 1 and n + 1 (the maximal 
SC is in the frequency with a number n) is large enough (the value of qs/n > 40 dB). 
Let us find the shift and a variance of frequency estimation for SAD and SPD. We 
note that the addition of zero samples leads to the appearance of correlation links 
between SC estimations. However, at two times the SC period increase, estimations 
of SPD (and SAD) noise on the left and on the right from the maximal SC remain 
noncorrelated because the frequency response of DFT filters with numbers l and l 
+ 2 do not overlap. 
Using relations for mathematical expectations and a variance of distribution 
in (3.52) [32] of DFS SAD, we expand (3.9) into a multidimensional Taylor series 
with respect to the point in which random parameters take values equal to their 
mathematical expectations. As a result, after transformations [51, 52], we obtain 
the following formula for the determination of the shift Dsh,a of the frequency esti-
mation caused by the influence of noisy interference
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
2
3
4
1
2
,
1
2
3
4
1
2
1
1
2
2
1
3
2
4
3
4
3
1
2
3
4
4
4
4
a
sh a
n
n
C
C
C
C
C
C
a
C
C
C
C
C
C
G
G
C
C
C
C
C
C
a
C
C
C
C
ω
ω
-
+
+
-
-
Y
-
Y
D
=
-
+
+
+
+
ì
ü
é
ù
é
ù
¢
¢
+
-
-
+
-
ï
ï
ê
ú
ê
ú
ï
ï
ë
û
ë
û
+
Y
í
ý
+
+
+
ï
ï
ï
ï
î
þ
	
(3.61)
where 
(
)
1
1
u
n
C
S
ω -
=
; 
(
)
2
1
u
n
C
S
ω +
=
; 
(
)
(
)
1
3
1
4
n
u
n
G
C
S
ω
ω
-
-
¢
=
; 
(
)
(
)
1
4
1
4
n
u
n
G
C
S
ω
ω
+
+
¢
=
. 
The equation for frequency estimation variance determination can be presented 
for the amplitude spectrum as: 
	
{
}
{
}
(
)
(
)
(
)
(
)
(
)
4
1
2
3
4
2
2
1
1
2
2
2
2
4
1
3
4
3
8
4
4
a
a
n
n
a
D
D p
C
C
C
C
G
G
C
C
C
C
C
C
ω
ω
ω
+
-
=
=
+
+
+
é
ù
æ
ö
æ
ö
¢
¢
´
+
-
+
+
-
Y
ç
÷
ç
÷
ê
ú
è
ø
è
ø
ë
û

	
(3.62)

3.6  Influence of Noise Interference on the Error of Range Measurement	
97
After the determination of first two moments, we can select for the correction 
pa the approximated distribution for it. The interval of the random variable pa, as 
follows from (3.9), is in the limits –ya £ pa £ ya. Therefore, it is expedient to ap-
proximate the quantity pa by generalized beta-distribution [53]
	
( )
(
)
( ) ( )
1
1
1
1
2
2
2
a
x
a
x
a
W x
a
a
γ
η
γ
η
λ
η
-
-
G
+
+ Y
+ Y
æ
ö
æ
ö
=
-
ç
÷
ç
÷
è
ø
è
ø
Y
G
G
Y
Y
	
(3.63)
where G(*) is the gamma function [20], and parameters g and h are determined 
according to [54, 55] taking into account limits of random quantity variation pa 
using equations:
	
{
}
{
}
{
}
(
)
{
}
{
}
{
}
{
}
2
2
2
;
2
2
a
a
a
a
a
a
a
a
a
a
a
a
M p
M p
M p
D p
D p
M p
M p
η
γ
é
ù
é
ù
Y -
Y -
Y
ë
û ë
û
=
Y
=
Y -
	
(3.64)
where 
= D
+
y
{
}
1
2
,
1
2
a
sh a
a
C
C
M p
C
C
-
+
 
By obtaining the frequency estimation shift and variance using SPD, we expand 
the function (3.9) in the multidimensional Taylor series with respect to the point, in 
which random parameters take values equal in its mathematical expectations, using 
distribution moments (3.49). As a result of transformations, we obtain for estima-
tion shift that (index m notes the power spectrum)
	
(
)
(
)
(
)
(
)
{
} (
)
(
)
{
}
1
2
3
4
3
1
2
3
4
1
2
3
4
1
2
1
3
1
2
4
1
1
2
2
m
m
sh
n
n
m
b
b
b
b
b
b
b
b
b
b
b
b
b
b
b
b
D G
b
b
D G
b
b
ω
ω
-
+
-
+
-
y
y
D
=
+
+
+
+
+
+
+
-
é
ù
´
+
-
+
-
y
ë
û
+


	
(3.65)
and its variance
	
(
) (
)
(
)
(
)
{
} (
)
(
)
{
}
4
1
2
3
4
2
2
1
3
1
2
4
1
4
m
n
n
D
b
b
b
b
b
b
D G
b
b
D G
ω
ω
ω
-
+
=
+
+
+
é
ù
´
+
+
+
ë
û



	
(3.66)
where 
(
)
2
1
1
u
n
b
S
ω -
=
; 
(
)
2
2
1
u
n
b
S
ω +
=
; 
(
)
3
1
n
b
G ω -
=
¢
; 
(
)
4
1
n
b
G ω +
=
¢
.
The distribution of the random quantity pm as a quantity pa is expedient to ap-
proximate by the generalized beta-distribution with parameters g and n, which are 
defined according (3.64) through a variance (3.66) and mathematical expectation 
of the correction coefficient, which can be presented as: 
	
{
}
(
)
(
)
1
2
1
2
m
sh
m
b
b
M p
b
b
-
= D
+
y
+
	
(3.67)

98	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
Formulas obtained for determination of the frequency estimation shift and the 
variance are approximate. First, to obtain the numerical characteristics, we used 
the expansion in the Taylor series. Second, at the calculations, we did not take into 
consideration the shift of noise SPD estimation G(w).
To check the obtained formulas, we conducted the result comparison for the 
calculation of the frequency estimation shift and estimation variance with results 
of numerical modeling of the range measurement process using the algorithm (3.8). 
The calculations and simulation were conducted for relative frequencies TwR/2p > 3. 
With numerical modeling we used signal SAD and calculations were performed 
according to (3.61) through (3.65). The period of the signal was increased by two 
times using the addition of zero samples. Simulation was carried out under the 
condition that the FM sweep is equal to 500 MHz and the useful signal is received 
on the background of the white normal noise. The sample volume L for the per-
formance of modeling was L = 10,000. The estimations of the mean value of the 
measuring frequency and MSD were determined according to known formulas and 
after were reduced to the range. Besides, we calculated estimations of asymmetry 1
β

 
and excess 2
β

 coefficients.
Figure 3.19 shows typical functions of the range estimation MSD versus SNR.
Functions are obtained on the relative frequency TwR/2p = 10. The solid line 
corresponds to modeling results, and the dotted line corresponds to the calculation 
results according to the above-mentioned formulas. It follows from the calculation 
results that MSD that is more than one order exceeds the estimation shift. Hence, 
we can practically neglect the estimation shift caused by a noise. The value of 
MSD does not practically change with variation of signal frequency. The artificial 
increase of the signal period more than two times does not change the MSD value. 
The calculation results for asymmetry and excess coefficients showed that at SNR, 
which is more than 20 dB, we have: 1
 2
0,
 3
β
 β
»
 »

, that is, the correction distribu-
tions are symmetrical with regard to its mathematical expectations and can be ap-
proximated by the normal distribution.­ The application­ of the Kolmogorov fitting 
Figure 3.19  The function of range estimation MSD versus SNR.

3.6  Influence of Noise Interference on the Error of Range Measurement	
99
criterion showed that both the beta distribution and the normal distribution are a 
good approximation of the correction distribution with the same confidence level. 
The character of MSD function, asymmetry, and excess coefficients do not practi-
cally change when using the power spectrum for frequency estimation. 
Influence of Noise on the Average-Weighted Estimation of DFS Frequency
As in the previous case, we shall make the decision about the frequency of the S(t) 
signal filling based on one signal y(t) realization according to the algorithm (3.10). 
It is impossible to find out the exact distribution for frequency estimation obtained 
in accordance with (3.10) or its moments. Nevertheless, the preliminary conclusion 
about estimation behavior can be made. It follows from (3.10) that the DFS fre-
quency estimation will be shifted due to influence of the noisy interference, because 
it is the weighted ratio of SPD of the signal and noise sum. Besides, we may expect 
that noisy interference will affect with the more influence than algorithms using 
the search of maximal SC. It can be explained by the fact that the denominator of 
(3.10) is a random variable. 
Let us define the approximate distribution of the frequency estimation. Because 
earlier it was assumed that the noise x(t) is SRP with the normal probability density, 
the zero mean value, and the spectral density N(w), the estimations of SC spectrum 
will be either noncorrelated (for the white noise) or weakly correlated for the col-
ored noise [as O(1/K)].
We assume that SCs of DFS are calculated on the multiple frequencies wi = 2pi /K, 
that is, the additional zero samples are not used for determination of average-
weighted estimation. Their application will lead to the appearance of correlation 
links between SCs, which, in essence, will lead to an impossibility of finding out the 
distribution law for frequency estimation. We rewrite (3.10) as:
	
(
)
(
)
2
2
1
1
2
2
n
n
R
i
i
i
i n
i n
F j
F j
ω
ω
ω
ω
=
=
= å
å

	
(3.68)
where (
)
(
)
(
)
2
1
u
i
i
F
S
j
S
j
K
ξ
ω
ω
ω
=
+
 is an SPD estimation of the signal s(t) weighted by 
WF and calculated using discrete or fast Fourier transform on frequencies wi = 2pi /K.
It is rather difficult to use the distribution (3.49) for obtaining the distribution 
of the random quantity wR, applying approaches based on the functional transfor-
mations of random quantities. We approximate (3.49) by the more suitable distri-
bution using the method of moments [48]. Having calculated the asymmetry and 
excess coefficients, we can be sure that image points corresponding to distribution 
(3.49) lay in the Pirson plate on the line corresponding to the gamma distribution. 
Using the mean value and a variance of the distribution (3.49), we determine pa-
rameters a and b gamma distributions:
	
(
)
{
}
(
)
{
}
(
)
{
}
(
)
{
}
2
,
n
n
n
n
n
n
M
F
D F
D F
M F
α
ω
ω
β
ω
ω
=
=
	
(3.69)
The index n indicates that parameters an and bn are related with the gamma dis-
tribution, which was used for distribution of quantity F(wn) on the nth frequency. 

100	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
A quality of the distribution (3.49) approximation w1(x) by the gamma distri-
bution w2(x) is estimated by the relation
	
( )
( )
1
2
0
0
max
Z
Z
d
W
x dx
W
x dx
=
-
ò
ò
	
(3.70)
Calculations show that at the variation of the integration limit in all inter-
vals of the W1(x) definition, the quantity d does not exceed the value 0.01 at 
2
(
)
(
)
20
u
n
n
S
j
G
ω
ω
>
¢
 dB and quickly decreases with the ratio 
2
(
)
(
)
u
n
n
S
j
G
ω
ω
¢
 
increasing.
Because the estimation of the frequency 
R
ω  is a sum of dependent quantities 
	
(
)
(
)
(
)
2
2
2
Rn
n
n
n
n
i n
F j
F
F j
ω
ω
ω
ω
ω
¹
é
ù
ê
ú
=
+
ê
ú
ë
û
å

, 
1
2
,
n
n n
=
	
(3.71)
for the determination of statistical characteristics of estimation 
R
ω , it is necessary 
to find out the joint distribution of quantities 
Rn
ω
. Such distribution was obtained 
in [56] and it is called a generalized Dirichlet distribution. Nevertheless, relations 
obtained in [56] are complicated and practically unsuitable for calculations. 
To obtain the simpler calculation formulas allowing the discovery of the mean 
value and a variance of the frequency estimation 
R
ω , we must take into consideration 
the following circumstance. The DFS frequency is measured, as a rule, at a large 
enough SNR. However, already at the ratio, 
2
(
)
(
)
20
u
n
n
S
j
G
ω
ω
>
¢
 dB 
2
(
)
n
n
G
β
ω
»
¢
. 
In the case when the delta-correlated noise is acting in the system, distribution laws 
of all quantities included in (3.71) can be approximated by the gamma distribution 
with the same parameters bn.Therefore, the joint distribution of 
Rn
ω
 (
1
2
,
n
n n
=
) will 
be transformed to the usual Dirichlet distribution [54].
Using the equation for moments of the Dirichlet distribution, we can determine 
equations for the mean value and the variance of the random quantity 
R
ω  (index l 
notes lower number and h is high number of processed frequency):
	
{
}
R
R
M ω
ω
=

	
{
}
1              1
h
1
h
1
h
1
h
h
1
h
1
h
1
1
1
2
1
2
2
(
...
(
...
) (
...
1)
2
(
...
) (
...
1)
h
n
n
n
n
n
l
n
n
n
n
n
n n
n
n
i
n
n
n
n
n
i n n n
i n
D
α α
α
α
α  )
ω
ω
α
α
α
α
α α
α
α
α
α
+
=
=
=
¹
+
+
+
-
=
+
+
+
+
+
ü
ï
-
ý
+
+
+
+
+
ï
þ
ü
ï
ý
ï
þ
å
å å

	
(3.72)
	
	
(3.73)
To check the obtained formulas, the calculation results comparison is performed 
according to these formulas of the frequency estimation shift and the estimation 
variance with results of numerical modeling of the range measurement process with 
the help of the algorithm (3.8). Calculations and modeling were conducted for dif-
ferent relative frequencies. Modeling was carried out under the condition that the 
FM sweep is 500 MHz and DFS is received on the background of the white normal 
noise. The sample volume L at modeling was L = 10,000. Estimations of the mean 

3.6  Influence of Noise Interference on the Error of Range Measurement	
101
value of measuring frequency and MSD were determined according to known for-
mulas and then were reduced into the range. Similar results are obtained for differ-
ent frequency values.
Results are presented in Figure 3.20 for the relative frequency TwR/2p > 10. 
Results of modeling are presented by the dotted line and the solid line shows the 
similar function calculated using (3.73).
The coincidence of modeling results with the theoretical ones can be considered 
to be good. However, as the Dirichlet distribution, which approximates the true 
distribution of the frequency MSD, the estimation shift caused by noisy interfer-
ence cannot be determined with this approach. At the simulation of the estimation 
shift, we determined that the quantity Dsh is one order greater than MSD calculated 
according to (3.73).
Influence of Noise on the DFS Frequency Estimation with the Help of Sliding  
Half-Strobes
It is impossible to determine a variance of frequency estimation for the algorithm 
(3.11). It can be proved simply enough that if the signal frequency is estimated, 
which is received on the background of the white noise, then the estimation will be 
unbiased. Having rewritten (3.11) in the form: 
	
{
}
{
}
H
B
2
2
(
)
(
)
2Re
(
)
(
)
(
)
(
)
2Re
(
)
(
)
x
x
n
u
i
i
u
i
i
i n
n
u
i
i
u
i
i
i n
S
j
G
S
j
S
S
j
G
S
j
S
ξ
ξ
ω
ω
ω
ω
ω
ω
ω
ω
=
=
+
+
¢
=
+
+
¢
å
å


	
(3.74)
and obtaining the mathematical expectation of left and right parts, we find: 
	
(
)
{
}
{
}
B
H
2
2
u
u
x
x
n
n
i
i
i n
i n
S j
S j
ω
ω
=
=
=
å
å
)
(
	
(3.75)
Figure 3.20  The function of normalized MSD versus SNR at TwR/2p = 10. 

102	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
that is, the estimation will be unbiased. The shift will appear at the estimation of 
signal frequency, which is received on the background of the colored noise. The last 
statement is valid for all considered algorithms. 
Simulation of Algorithms of DFS Frequency Estimation
This simulation represents the practical interest for the estimation of noise immunity 
of all these algorithms of frequency measurement under similar conditions. With 
this aim, the measurement process simulation was performed at rather large relative 
frequencies (wRT/2p = 10), that is, for the case when the noisy error component is the 
main one. At calculation of MSD, we used the sample average value, which allows 
the elimination of the residual spectrum SL influence on the modeling results. At 
drawn plots presented in Figure 3.21, the DS frequency is recalculated into range. 
Results are obtained at an FM sweep of 500 MHz a and carrier frequency of 
10 GHz. Function 1 corresponds to application of the algorithm providing the 
search of the maximal spectral component including based on the spline interpola-
tion and the algorithm performing the median estimation. Function 3 is obtained 
using the Blackman WF for these algorithms. Function 2 corresponds to applica-
tion of the algorithm on the basis of correction coefficients without WF usage. 
Functions 4 and 5 correspond to average-weighted estimation application using 
the Blackman WF (function 5) and without this application. The analysis of func-
tions shown in Figure 3.21 allows the statement that the algorithm (3.6), which 
provides the search of maximal SC, the modification of the algorithm (3.6) on the 
basis of spline interpolation, and the median frequency estimation have practically 
the same noise immunity. At simulation, the difference in MSD did not exceed 1% 
to 3% at the sample volume of 104 realizations. The MSD for the algorithm with 
correction coefficients is 1.25 times more compared with the mentioned algorithms. 
The application of the Blackman WF increases the MSD for all algorithms about 
1.85 times. The average-weighted estimation has the least noise immunity. It loses 
to all mentioned algorithms on the MSD about 2.25 times without the Blackman 
Figure 3.21  Mean-square deviation of range estimation versus SNR.

3.7  Conclusions	
103
WF ­application. The explanation of this fact is rather simple: for the estimation 
formation,­ the ratio of two random quantities is used, that is, the noisy interference 
acts on the nominator and on the denominator of (3.10); therefore, the noise is 
picked up in the frequency range that is wide enough. Similarly, we can explain the 
loss in noise immunity for the algorithm using correction coefficients. The applica-
tion of the Blackman WF increases MSD of the frequency estimation. 
3.7  Conclusions
Possible algorithms of difference frequency estimation in the spectral domain are 
considered to be the means of the maximum search of the spectral amplitude den-
sity with the help of a two-step procedure of rough estimation on the basis of FFT 
and specification is considered to be the means of the following algorithms:
Addition of zero samples into the initial DFS sample array;
1.	
Application of IDFT; 
2.	
Spline interpolation of the spectrum;
3.	
Calculation of correcting coefficients.
4.	
In some cases, one uses algorithms for spectrum symmetry estimation on the 
basis of average-weighting estimation or determination of the spectrum median.  
For frequency estimation according to the maximum of spectral amplitude den-
sity calculated using the arbitrary WF, the approximated equations are obtained, 
which allow error estimation of the normalized frequency. The limits of these equa-
tion applications are analyzed. These formulas are specified for DC WF and KB WF, 
which allow us to easily change the shape and the spectrum sidelobe level by means 
of variation of one parameter. 
The detailed analysis of the instantaneous truncation error for normalized fre-
quency measurement versus the range is performed and it is shown that indepen-
dently on the WF type the measurement error has a periodic oscillating character. 
There are fast oscillations with the period equal to a quarter-wavelength of the 
carrying oscillation inscribed into the slow envelope with clearly expressed nodes 
corresponding to the zero error value. The period of slow oscillations depends on 
the periodicity of sidelobes of the WF spectrum. 
The obtained formulas allow the statement of the problem of range measure-
ment error minimization to be the means of FM parameter optimization (the FM 
sweep and the carrier frequency) and WF parameters. Optimization algorithms are 
iterative with gradual specification of parameters until the error will decrease to 
the accepted level. The limited achievable error at optimization of the carrier fre-
quency and WF parameters has the very minimal measuring ranges. For the range 
increase, the error gradually decreases. The optimization of the FM sweep allows 
the ­approximately the same error level practically at any ranges. 
We offer the algorithm of the WF parameter optimization, which allows the 
elimination of the iteration procedure at some acceptable increase of the achievable 
error level of range measurement.

104	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
The possibility of measurement error minimization is considered by means of 
adaptable WFs allowing changing the spectrum form in such a manner that ­spurious 
items on the useful signal frequency would be equal to zero. Two iterative algo-
rithms for AWF parameters control are offered: the first algorithm, which is sim-
plest but it provides much less values of measurement error compared with the 
optimization of the DC WF parameters, especially for small measuring frequencies; 
and the second algorithm, which simultaneously provides minimization of measure-
ment error provides ENB minimization. 
The analysis of the measurement error of normalized frequency is perfomed on the 
basis of average-weighted estimation. The general form of the instantaneous measure-
ment error coincides with the variant of maximum estimation of the spectral density. 
One can also apply the iteration procedures of the FM parameter optimization 
and the simplified procedure of WF parameter optimization. 
The function of the instantaneous measurement error versus range has another 
character for the algorithm of normalized frequency estimation using correction co-
efficients. Here there are also two types of periodicity; however, the slow component 
is not an envelope but has an additive character. With measuring range increasing, 
we observe the gradual level decrease of the slow and fast oscillating components. 
This algorithm can be expediently used when adding zero samples to DFS samples 
to increase the period of the processing signal approximately two to four times.
Using modeling, we conducted an investigation of the noisy interference 
­influence on the range measurement error by different algorithms. It is shown that 
frequency estimation based on the amplitude spectral density maximum has the 
less sensitivity compared with the average-weighted estimation providing approxi-
mately the 2.25 times less measurement error. 
References
[1]	 Marple, S. L., Jr., Digital Spectral Analysis with Applications, Englewood Cliffs, NJ: 
­Prentice-Hall, 1987. 
[2]	 Harris F. J. “On Use of Windows for Harmonic Analysis with the DiscreteFourier Trans-
form.” IEEE Trans. Audio Electroacoust, Vol. AU-25, 1978, pp. 51–83.
[3]	 Dvorkovich, A. V. “New Calculation Method of Effective Window Functions Used at Har-
monic Analysis with the Help of DFT,” Digital Signal Processing, No. 2, 2001, pp. 49–54. 
[In Russian]
[4]	 Dvorkovich, A. V. “Once More About One Method for Effective Window Function Cal-
culation at Harmonic Analysis with the Help of DFT,” Digital Signal Processing, No. 3, 
2001, pp. 13–18. [In Russian]
[5]	 Sergienko, A. B., Digital Signal Processing. Sankt-Peterburg: Piter Publ., 2003, 604 p. [In 
Russian]
[6]	 Khanyan, G. S. “Analytical Investigation and Estimation of Errors Involved in the Problem 
of Measuring the Parameters of a Harmonic Signal Using the Fourier Transform Method,” 
Measurement Techniques, Vol. 48, No. 8, 2005, pp. 723–735.
[7]	 Vinitskiy, A. S. Essay on Radar Fundamentals for Continuous-Wave Radiation, Moscow: 
Sovetskoe Radio Publ., 1961, 495 p. [In Russian]
[8]	 Woods, G. S., D. L. Maskell, M. V. Mahoney, “A High Accuracy Microwave Ranging 
System for Industrial Applications,” IEEE Transactions on Instrumentation and Measure-
ment. Vol. 42, No. 4, August 1993

3.7  Conclusions	
105
[9]	 Bialkovski, M. E., S. S. Stuchly, “A Study Into a Microwave Liquid Level Gauging System 
Incorporating a Surface Waveguide as the Transmission Medium,” Singapore ICCS’94, 
Conference Proceedings, Vol. 3, 1994, p. 939.
[10]	 Patent 5504490 (USA), INT. CL. G01 S 13/08. “Radar Method and Device for the Mea-
surement of Distance,” J. C. Brendle, P. Cornic, P. Crenn. No. 414594. Filed March 31, 
1995; date of patent April 2, 1996
[11]	 Patent 5546088 (USA), INT. CL. G01 S 13/18. “High-Precision Radar Range Finder,” G. 
Trummer, R. Korber. No. 317680. Filed October 5, 1994; date of patent August 13, 1996.
[12]	 Weib, M., Knochel R. “Novel Methods of Measuring Impurity Levels in Liquid Tanks,” 
IEEE MTT-S International Microwave Symposium Digest, Vol. 3, 1997, pp. 1651–1654.
[13]	 Weib, M., and R. Knochel, “A Highly Accurate Multi-Target Microwave Ranging System 
for Measuring Liquid Levels in Tanks,” IEEE MTT-S International Microwave Symposium 
Digest, Vol. 3, 1997, pp. 1103–1112.
[14]	 Patent 2126145 (Russian Federation), INT.CL.. G01 F 23/284. “Level-meter,” S. A. Liber-
man, V. L. Kostromin, S. A. Novikov, A. V. Liberman, Yu.G. Nevhepurenko, G. V. Alexin 
No. 97114261/28. Bull. No. 4. Filed August 20, 1997; published February 10, 1999. 
[15]	 Zhukovskiy, A. P., E. I. Onoprienko, V. I. Chizhov, Theoretical Fundamentals of Radio 
Altimetry, under ed., of A. P. Zhukovskiy, Moscow: Sovetskoe Radio Publ., 1979, 320 p. 
[In Russian]
[16]	 Korn, G., and T. Korn, Mathematical Handbook for Scientists and Engineers New York: 
­Toronto: London: Mcgraw Hill Book Company, 1961.
[17]	 Atayants, B. A., V. M. Davydochkin, V. V. Ezerskiy, D. Ya. Nagorny, “FMCW Radio Range 
Finder with Adaptive Digital Generation of the Transmitted Signal,” Proceedings of Rus-
sian NTORES Named after A.S. Popov. Series: Digital Signal Processing and Its Applica-
tion. 6th Intern. Conf. No VI – 2, Moscow, 2004, pp. 26–28. [In Russian]
[18]	 Kagalenro, B. V., V. P. Marfin,  and V. P. Meshcheriakov, “Frequency Range Finder of High 
Accuracy,” Izmeritelnaya Technika, No. 11, 1981, p. 68. [In Russian.]
[19]	 Marfin, V. P., A. I. Kiyashev, F. Z. Rosenfeld,  V. M. Israilson, B. A. Atayants, B. V. Kaga-
lenko, and V. P. Mashcheriakov, “Radio Wave Non-Contact Level-Meter of Higher Accu-
racy,” Izmeritelnaya Technika, No. 6, 1986, pp.  46–48. [In Russian.]
[20]	 Kirillov, S. N., M. Yu, Sokolov, and D. N. Stukalov, “Optimal Weighting Processing at 
Spectral Analysis of Signals,” Radiotekhnika, No. 6, 1996, pp. 36–38. [In Russian.]
[21]	 Brillinger, D. R., Time Series: Data Analysis and Theory, New York: Chicago: San Fran-
cisco: Atlanta: Dallas: Montreal:  Toronto:  London: Sydney: Holt, Rinehart and Winston, 
Inc., 1975.
[22]	 Jenkins, G. M., and D. G. Watts, Spectral Analysis and Its Applications, San Francisco: 
Cambridge: London: Amsterdam: Holden-Day, 1969.
[23]	 Tikhonov, V. I., Optimal Reception of Signals, Moscow: Radio i Sviaz Publ., 1983, 320 pp. 
[In Russian.]
[24]	 Yarkho, T. A., “Determination of Peak Position of the Spectral Component at Fast Fourier 
Transform,” Radiotekhnika Publ., Kharkov, No. 90, 1989, pp. 6–11. [In Russian.]
[25]	 Koshelev, V. I., and V. N. Gorkin, “Accuracy Increase of Central Frequency Estimation of 
the Narrow-Band Process in FFT Processor,” Izvestia VUZov, Radio Electronics, Vol. 47, 
No. 1, 2004, pp. 67–73. [In Russian.]
[26]	 Levin, B. R., Theoretical Fundamentals of Statistical Radio Engineering, In three volumes. 
2nd edition. Moscow: Sovetskoe Radio Publ., 1974, 552 pp. [In Russian.]
[27]	 Zander, F. V., “Algorithms for the Optimum Estimation of the Parameters of a Radio Signal 
in a Measurement Time of Less Than a Period and a Nonmultiple of a Period in Which the 
Result Is Tied to the Beginning of the Measurement Interval,” Measurement Techniques, 
Vol. 46, No. 2, 2003, pp. 172–176.
[28]	 Stolle, R., H. Heuermann, and B. Schiek, “Novel Algorithms for FMCW Range Finding 
with Microwaves,” Microwave Systems Conference IEEE NTC’95, 1995, p. 129.

106	
Estimation of the Difference Frequency by the Position of the Spectrum Maximum
[29]	 Sokolov, I. F., and D. E. Vakman, “Optimal Linear In-Phase Antennas with Continu-
ous Current Distribution,” Radiotekhnika and Elektronika, No. 1, 1958, pp. 46–55. [In 
­Russian.]
[30]	 Ezerskiy, V. V., and  I. V. Baranov, “Optimization of Weighting Methods of Smoothing the 
Discreteness Error of Distance Sensors Based on a Frequency Range Finder,” Measurement 
Techniques, Vol. 47, No. 12, 2004, pp. 1160–1167.
[31]	 Patent No 2234717 (Russian Federation), INT.CL.. G01 S 13/34. “Method of Distance 
Measurement,”  B. A. Atayants, V. M. Davydochkin, V. V. Ezerskiy, and D. Ya. Nagorny. 
No. 2003105993/09. Bull. No. 23. Filed 04.March 4, 2003; published August 20, 2004. 
[32]	 Davydochkin, V. M., and V. V. Ezerskiy, “Minimization of Distance Measurement Error 
at Digital Signal Processing in Short-Range Radar Technology,” Digital Signal Processing, 
No. 3, 2005, pp. 22–27. [In Russian.]
[33]	 Ezerskiy, V. V., and V. M. Davidochkin, “Optimization of the Spectral Processing of the 
Signal of a Precision Distance Sensor Based on a Frequency Range Finder,” Measurement 
Techniques, Vol. 48, No. 2, 2005, pp. 133–140.
[34]	 Ezerskiy, V. V., V. S. Parshin, I. V. Baranov, V. S. Gusev, and A. A. Bagdagiulyan, “Com-
parative Noise Immunity Analysis of Algorithms for Distance Measurement in FMCW 
Range Finder in the Spectral Domain,” Vestnik RGRTA, Ryazan, No. 14, 2004, pp. 43–48. 
[In Russian.]
[35]	 Parshin, V. S., and V. V. Ezerskiy, “Estimation of Average Frequency of Radio Pulse Filling, 
Which is Received on the Background of the Normal Noise,” Nauchny vestnik MGTUFA, 
Series Radio Physics and Radio Engineering, No. 87 (5), 2005.
[36]	 Hahn, G. J., and S. S. Shapiro, Statistical Models in Engineering, New York: London: 
­Sydney: John Wiley & Sons, Inc., 1967.
[37]	 Parshin, V. S. “Estimation of Pulse Interference Influence on Stationary Signal Recognition 
in the Spectral Domain,” Radio Elektronika, Vol. 42, No. 3, 1999, pp. 73–79. [In Rus-
sian.]
[38]	 Parshin, V. S., and V. S. Gusev, “The Effect of Noise on the Accuracy of the Estimate of the 
Center Frequency of the Spectrum of a Narrow-Band Signal,” Measurement Techniques, 
Vol. 48, No. 7, 2005, pp. 711–717. 
[39]	 Atayants, B. A., V. V. Ezerskiy, and A. F. Karpov, “Research of Generalized Probability 
Model of the Radio Signal,” Izvestia VUZov of USSR, Radio Elektronika, Vol. 31, No. 4, 
1988, pp. 43–49. [In Russian.]
[40]	 Wilkes, S., Mathematical Statistics, Moscow: Nauka Publ., 1967, 632 pp. [In Russian.] 
[41]	 Atayants, B. A., V. V. Ezersky, and A. F. Karpov, “Distribution of Normalized Power 
of the Signal,” Radiotekhnika i Elektronika, Vol. 28, No. 9, 1983, pp. 1864–1868. [In 
Russian.]

107
c h a p t e r  4
The Maximal Likelihood Method for 
Range Estimation According to the 
Difference Frequency Signal
4.1  Introduction
The determination of the potential accuracy of range estimation at DFS reception 
on the noise background and determination of the algorithm structure of optimal 
processing is undoubtedly of practical interest. 
The potential accuracy of delay estimation is provided using for the optimal 
processing a direct reflected signal without any preliminary transformation. For 
this, the synthesis of the estimation algorithm for interesting parameters (delay 
time or the range linear connected with the first) is required on SHF. Nevertheless, 
processing of the SHF signal is limited by possibilities of practical implementation. 
Exactly because of this reason, this chapter is devoted to estimation of a potential 
accuracy of delay time estimation after preliminary transformation, that is, the 
­potential accuracy of delay time estimation in DFS. We assume, as we did earlier, 
that the one-sided spectral density of the noise after a mixer is equal to N0. 
From (1.6), it follows that information about range is contained in DFS fre-
quency and in its initial phase. Evidently, the range estimation using the algorithm 
(3.4) and its modifications does not allow realization in full measure of the FMCW 
RF possibilities because in this case we do not use information contained in the 
signal phase. However, the phase approach for range estimation also allows the 
­application of only part of the information contained in the signal. 
The modern component base providing the high-stable FMCW RF character-
istics (at first, the carrier frequency and the FM sweep stability) allows the realiza-
tion in practice of the optimal DFS processing algorithms, and the performance of 
modern processors allows calculation results in the real-time scale. 
Many publications are presently devoted to the synthesis of optimal algorithms 
of radio signal parameter estimation [1–3]. In these and another publications, many 
general problems are solved, which arise at the estimation of different parameters 
of the radio signal, including the delay time and the frequency.
We determine the potential accuracy of range measurement (linearly connected 
with the delay or the beating frequency) in DFS using the results of [1], the bound-
aries of the maximal likelihood method application, taking into account the DFS 
phase at range estimation, are determined, and the restrictions on its practical 
­application are defined. 

108	
The Maximal Likelihood Method for Range Estimation
4.2  Range Estimation Based on the Difference Frequency Signal 
At the estimation of some parameter z [1–3], the most complete information about 
its possible values is given by a posteriori probability density, which can be written 
as: 
	
ps
pr
( )
( ) ( )
W   z
gW   z
z
=
L
	
(4.1)
where g is a normalizing multiplier, which is independent on the parameter z, Wpr(z) 
is a priori density of the parameter z, and L(z) is the likelihood function (LF) at dis-
crete processing of received signal. At continuous processing, the likelihood func-
tional F(z) [1–3] should be substituted in (4.1) instead of L(z). One can substitute 
instead of LF or the likelihood functional in (4.1) the functions of likelihood ratio 
functions (LRF), taking into consideration that the normalizing coefficient g will be 
changed at that point. We assume that its value, which corresponds to the maxi-
mum of Wps(z), is the estimation of parameter z.
A priori distribution of the estimating parameter z (in our case, it is the range 
to the reflected surface) is unknown. It is reasonably to assume that a priori dis-
tribution density of the estimating parameter z obeys the uniform distribution. 
Then it follows from (4.1) that in this case a posteriori distribution in the vicinity 
of estimation z coincides with LF or LRF [1–3]. The estimation according to the 
maximum of a posteriori probability in this case is transformed to the estimation 
of maximum likelihood, which is determined for the parameter z as the position of 
global maximum of LF or LRF. As MLM estimation does not depend on one-to-one 
nonlinear signal transformation [5], we shall use the logarithm of likelihood func-
tion (LLF) or the logarithm of likelihood ratio likelihood (LLRF) for calculation 
simplification.
It is known [1–3] that the MLM at the estimation of radio signal parameters 
has a series of advantages. We may note its unbiasedness as the most essential 
­advantages for unlimited increase of SNR. Moreover, it is proved [1–3] that if 
there is an effective estimation, then the exact MLM estimation is ­effective. 
Let us consider the estimation of delay time tdel by the maximal likelihood 
method using DFS obtained during the only half-period, that is, during the time 
interval (0, Tmod/2). We suppose for simplicity that we provide the continuous pro-
cessing of DFS. 
Taking into account designations of (1.6), LLF ln F (Adif, tdel, js) can be pre-
sented in the form [1–3]:
	
mod/2
2
dif
del
ref
0
0
1
ln [
,
,
]
{ ( )
( )}
T
s
F A
t
y t
S
t
dt
N
ϕ
= -
-
ò
	
(4.2)
where Sref(t) = S[t, Adif, ref, tdel,ref, js,ref] is the reference signal, Adif,ref, tdel,ref, js,ref 
are parameters of the reference signal, N0 is the one-sided spectral density on the 
white noise, y(t) is the additive mixture of DFS and the white normal noise, and js 
is the signal phase.
Let us determine the limited accuracy of delay time tdel and the DFS phase js 
estimation when using MLM, that is, the algorithm (4.2) assuming that the DFS 

4.2  Range Estimation Based on the Difference Frequency Signal 	
109
amplitude is known. For the accuracy estimation of the DFS parameter determination 
[1], we use the signal function (SF) calculated for relative frequencies wTmod/2 >> 1.
	
mod
mod
/2
del
dif
del
ref
0
0
/2
dif
0 del
mod
del
0
0
dif
0 del,ref
mod
del,ref
s,ref
2
(
,
)
( ,
,
,
)
( )
2
cos[
( )
]
cos[
( )
]
T
s
s
s
T
q t
S t A
t
S
t dt
N
A
t
t t
N
A
t
t t
dt
ϕ
ϕ
ω
ω
ω
ω
ϕ
=
=
+
´
+
+
ò
ò
	
(4.3)
As MLM is asymptotically effective, it is enough to obtain the lower boundary 
of the error variance. Let us find these boundaries for the case of delay time estima-
tion assuming that the phase js is known, and then we obtain the lower boundaries 
for mutual estimations of delay time tdel and the phase js of the signal.
The lower variance boundary of delay time at known phase js is defined from 
the known equation [1]
	
del
del,ref
2
del
2
del
1
(
)
t
s
t
t
D
d q t
dt
=
= - é
ù
ê
ú
ê
ú
ë
û
	
(4.4)
Having found the variance estimation of delay time tdel and taking into consid-
eration that R = ctdel/2, the lower boundary of variance estimation of the R
 range 
can be presented as
	
(
)
2
0
2
2
0
0
( )
2
4
/3
N
c
D R
E
ω
ωω
ω
³
+ D
+ D

	
(4.5)
where E is the signal energy defined in the time interval (0,Tmod/2), that is, 
2
mod
dif
/4
E
A
T
=
.
For modern FMCW RF the carrier frequency exceeds approximately by the 
­order of its FM sweep. Therefore, the first item in the denominator of (4.5) is 
more by two to four orders than the second and third items. As a result, the lower 
boundary of the range variance estimation at a priori known initial phase can be 
presented as: 
	
2
0
2
0
( )
2
4
N
c
D R
E
ω
³

	
(4.6)
In other words, the lower boundary of the range variance estimation at fully 
known signal phase decreases proportionally to a square of carrier frequency.
At the unknown signal phase js, the problem of delay time estimation is re-
duced to the problem of the global functional (4.2) maximum obtaining, that is, to 
the problem of joint estimation of tdel and js. Determining derivatives 
	
del,ref,
,ref
2
del
del
(
)
[
,
]
s
s
s
ij
s
t
q t
J
t
ϕ
ϕ
ϕ
é
ù
¶
= ê
ú
¶
¶
ë
û
	
(4.7)

110	
The Maximal Likelihood Method for Range Estimation
and forming the correlation matrix of estimations [1], variance 
( )
D R  and 
(
)
s
D ϕ  at 
the mutual estimation of the range R and the phase js(tdel) of the signal (i.e., at mutual 
estimation of the delay time tdel and the phase js(tdel)) can be presented in the form:
	
N
c2
0
2
3
( )
2
D R
E
ω
³
D

	
(4.8)
	
(
)
2
2
2
0
0
0
0
0
2
2
12
/3
12
(
)
2
2
s
N
N
D
E
E
ω
ωω
ω
ω
ϕ
ω
ω
+ D
+ D
³
»
D
D

	
(4.9)
From (4.9), it follows that the variance of phase estimation increases with the 
carrier frequency increasing. 
From a comparison of (4.6) and (4.9), the evident result follows: the lower 
boundary of the range variance estimation can be essentially decreased using a 
priori information about the signal phase. Therefore, the benefit B is
	
2
2
0
12
/
B
ω
ω
=
D
	
(4.10)
As an example, we can indicate that for FMCW RF with carrier frequency 
f0 = 1010 Hz and the carrier FM sweep 5 ´ 108 ¸ 1 ´ 109 Hz, the reduction of vari-
ance estimation is, accordingly, 4,800 ¸ 1,200. The estimation variance of the range 
can be decreased for increase of FM sweep of the carrier frequency as it will lead 
to increase of DFS signal period in the time interval (0,Tmod/2) that allows accurate 
DFS frequency measurement in accordance with (4.8). However, the possibilities of 
decreasing the range variance estimation by increasing the FM sweep are essentially 
limited by engineering reasons.
A significant decrease of estimation variance of the delay tdel at using the MLM 
taking into account the signal phase is explained by peculiarities of DFS SF. Figure 4.1 
shows the vertical SF section (line 3) for DFS FMCW RF depending on the relative 
Figure 4.1  Vertical section of SF depending on the relative range.

4.2  Range Estimation Based on the Difference Frequency Signal 	
111
range R – Rx, where R is the true range, Rx is the current range (i.e., the delay tdel 
is recalculated into the range in accordance with tdel = 2R/c). At the creation of the 
figure, amplitudes and phases of the reference signals are assumed to be equal. 
From Figure 4.1 we see that SF is the oscillating function with the period equaled 
to l/2, that is, the oscillation period is equal to a half of the carrying oscillation 
­wavelength. We would like to note that such form of SF is typical for linear-frequency 
modulated signal [1], and the qualitative analysis of this SF is performed in [4]. The 
presence of narrow SF maxima (4.3) defines the benefit at estimation of time delay 
taking into account the signal phase, which acts at the FMCW RF output. 
For comparison, Figure 4.1 shows SFs for estimation of signal frequency with 
unknown initial phase with the help of algorithms searching the maximal SC (line 
1) and calculated using equations obtained in (line 2) at estimation of frequency w 
of the narrowband signal, which can be presented as:
	
del
dif
0
mod
2
( )
cos
( )
t
S t
A
t
ξ  t
T
ω
ϕ
é D
ù
=
+
+
ê
ú
ë
û
	
(4.11)
The main maximum width of such SFs exceeds considerably the width of the 
main SF maximum in (4.2). We must note that for the signals in (4.11) the benefit 
in variance of the frequency estimation [1] is a value equal to 4 taking into consid-
eration the initial signal phase at signal observing in the time interval (0, T).
The normalized correlation coefficient rcor between estimations of time delay 
tdel and the phase js determined in accordance with [1] is:
	
(
)
del
del
0
cor
1 2
2
2
0
0
(
)
/2
1
2
/3
s
s
t
M t
r
D
Dϕ
ϕ
ω
ω
ω
ωω
ω
+ D
=
= -
» -
+
D
+ D
	
(4.12)
Such a value causes the fact that variance decrease of the range estimation at 
carrier frequency increase of the transmitter accompanies by proportional increase 
of the DFS phase estimation variance, which follows from (4.5) and (4.9).
From (4.7), accounting for (4.8), (4.9), and (4.12), one can determine the vari-
ance of initial DFS phase estimation jinit, which can be defined as jinit = w0tdel + js:
	
0
init
(
)
4
2
N
D
E
ϕ
=

	
(4.13)
which coincides with the known result [1] for the variance of the initial phase 
­estimation at mutual estimation of frequency and initial phase of the radio pulse. 
Lower boundaries of DFS frequency and phase estimation variances are ob-
tained for the case of continuous time. In [1], the lower boundaries of estimation 
variances are obtained in the case of discrete time and it is shown that at transfer to 
discrete time we can neglect of accuracy loss at enough discretization frequency. 
The obtained formulas for the variance of time delay estimations are checked 
with the help of computer modeling. Simulation results practically coincided with 
calculation results for the variances in accordance with (4.5) and (4.8) both for es-
timation of DFS frequency with the unknown initial phase and using the algorithm 
realizing the MLM at the a priori known DFS phase. 

112	
The Maximal Likelihood Method for Range Estimation
Because in modern FMCW RFs the DFS frequency estimation is often per-
formed in the spectral domain, the determination of the algorithm structure real-
izing MLM in the spectral domain causes the practical interest. We assume that we 
use FFT for spectrum calculation. Frequencies, at which the spectrum is calculated, 
are determined as wi = 2pi/(KTdis), i = 0,1…(K – 1)/2. Taking into account that 
distribution of real and imaginary parts of the Fourier CS is normal [5] and SC cal-
culated at frequencies wi for the white normal noise are noncorrelated, LLF in the 
spectral domain can be presented in the following form:
	
[
]
{
}
(
1)/2
2
dif
del
ref
0
1
2
ref
1
ln
(
,
,
)
Re( (
))
Re(
(
))
[Im( (
))
Im(
(
))]
K
s
s
i
i
i
i
i
x
F A
t
y j
S
j
N
y j
S
j
ϕ
ω
ω
ω
ω
ω
-
=
= -
-
+
-
D
å
	
(4.14)
where Sref(jw) = S(jwi, Adif,ref, tdel,ref, js,ref(tdel)) is the DFT of the reference signal, 
y(jwi) is DFT of the sum of DFS and the white normal noise, and Dwx = 2p /(KDt). 
The SF shape for (4.14) corresponds to Figure 4.1 (curve 3).
Properties of LLF in the spectral domain are the same with its properties in 
the time domain at reception of the signal on the background of the white normal 
noise. This is clear because the CS of the white normal noise obeys the normal dis-
tribution. As for the time domain, we can use LLRF for delay estimation, which in 
the spectral domain has the following form: 
	
(
1)/2
dif
del
ref
0
1
ref
ref
2
ln [
,
,
]
Re[ (
)]Re[
(
)]
1
Im[ (
)]Im[
(
)]
(
)
2
K
s
s
i
i
i
i
i
i
x
l A
t
y j
S
j
N
y j
S
j
G
ϕ
ω
ω
ω
ω
ω
ω
-
=
=
üýþ
ü
+
-
D
ýþ
å
üýþ
	
(4.15)
where 
	
Gref(wi) = |S(wi, Adif,ref, tdel,ref, js,ref)|2
Sometimes, one neglects (4.15) by the item Gref[wi]/2. At the DFS frequency 
measurement for small normalized ranges, such neglect leads to noticeable addi-
tional systematic inaccuracy. The application of LLRF in the time domain leads to 
exactly the same inaccuracy:
	
2
dis
del
ref
ref
0
1
2
1
ln (
,
,
)
( )
( )
( )
2
K
c
i
i
i
i
l A
t
y t S
t
S
t
N
ϕ
=
é
ù
=
-
ê
ú
ë
û
å
	
(4.16)
when neglecting by the second item in the square brackets. 
Figure 4.2 shows the estimation error of delay time recalculated into the range 
error versus range obtained for neglect the item Gref[wi]/2 in (4.15) and 2
ref( )/2
S
t
 in 
(4.16) defined in the form:
	
|
|
x
R
R
R
D
=
-
	
(4.17)
where Rx and R are, respectively, measured and true ranges.

4.3  Peculiarities of Delay Time Estimation Using the Maximal Likelihood Method	
113
This plot is obtained for no-interference situation with the help of modeling. The 
FM sweep is 500 MHz, and the carrier frequency is 10 GHz. From the figure we see 
the presence of a noticeable systematic error, which monotonically decreases (albeit 
slowly) with the range increasing or (that is the same) with the DFS increasing. For 
example, we can note that the MSD of the range measurement result caused by the 
noise n(t) influence and calculated at qs/n = 70 dB is 0.75 × 10–3 mm. The only ad-
vantage of the (4.15) and (4.16) application compared with (4.2) is the independence 
of the error |DR| upon the amplitude difference of received and reference signals. In 
practice, amplitudes of DFS and the reference signal may be significantly different 
due to the nonideal operation of automatic gain control. Essential reduction of the 
influence of amplitude difference upon the error of MLN parameter estimation can be 
implemented by the application of the following invariant transformation:
	
2
1
K
i
i
i
i
z
z
z
=
=
å
	
(4.18)
where zi are samples of DFS and reference signals and iz  are corresponding modified 
samples. 
Simulation results show that the variance of range estimation using transforma-
tion (4.18) increases approximately by 2%, 5%, and 10% compared with the variance 
determined according to (4.5) at the ratios q = 70 dB, 60 dB, and 50 dB, ­respectively. 
Such an increase of estimation variance may be accepted as insignificant. 
4.3  Peculiarities of Delay Time Estimation Using the Maximal 
Likelihood Method
The fast oscillating character of LLF determines the peculiarities of its application. 
To find the estimation of the unknown parameter tdel, it is necessary to determine 
the global maximum of LLF. From this, two features are noted:
Figure 4.2  The plot of measuring systematic inaccuracy versus range.

114	
The Maximal Likelihood Method for Range Estimation
At the unknown phase 
1.	
js, we should estimate two parameters for evaluating 
the delay time. At first, using MLM, we estimate js and then this estimation 
s
ϕ  is substituted to the likelihood equation:
	
del
del,ref
dif
del
del
ln (
,
,
)
0
c
t
t
F A
t
t
ϕ
=
¶
=
¶

	
(4.19)
The value of the tdel estimation will be a solution of (4.19). The Rao-
Cramer boundaries for the variance of delay time estimation in this case 
are determined in accordance with (4.8). Taking into consideration that 
the beating frequency wbeat and the range are connected by the linear func-
tion (1.12), it is easy to find out the Rao-Cramer boundary for variance 
of frequency estimation in the form 
2
0
beat
mod
12
2
(
)
2
N
D
E
T
ω
æ
ö
=
ç
÷
è
ø . This formula 
coincides with the Rao-Cramer boundary for the variance of radio pulse fre-
quency estimation with unknown initial phase [1], when that frequency, on 
which the maximal SC is, can be accepted as the radio pulse frequency value. 
We wish to obtain the variance of the range estimation determined by (4.5). 
Such an estimation variance can be obtained when knowing the signal phase 
only. Therefore, to obtain the range estimation with less variance than that 
defined by (4.8), we should to take measures for obtaining the estimation 
s
ϕ  
with less variance. 
Even for the known phase 
2.	
js, obtaining of the LLF global maximum in the 
delay range that is large enough leads to anomalous errors. One of these 
reasons is the iterative process of global irregularity search for the multi-
extreme function does not guarantee its obtaining with unitary probability. 
The next reason of anomalous error arising is the noise influence, under which 
the LLF maxima change. As a result, the anomalous errors arise caused by errone-
ous acceptance of one of the local LLF maximums as the global maximum. The 
value Dan of anomalous errors can be determined as:
	
D
=
=
an
/2,
1,2,3
m
m
λ
…	
(4.20)
where m is a number of the local maximum, which was accepted as the global 
counted with respect to the true global maximum, and l is the wavelength of the 
carrying signal.
To find out the probability of anomalous errors caused by noise influence, it is 
necessary to determine the probability of the event that under the noise n(t) action, 
the value of the LLF local maximum Lm will exceed the value of the global maxi-
mum L0, that is, to determine the probability of the event Pm(Lm > L0).
Let us present the LLF in (4.2) for the relative frequencies (wTm/2) >> 1 in the 
form:
	
mod/2
dif
del
del
del
0
0
2
ln [
,
,
]
( ) ( ,
)
(
)
( )
T
s
s
n
l A
t
y t S t t
dt
q t
q t
N
ϕ
=
=
+
ò
	
(4.21)
where qs(tdel) and qn(t) are, respectively, signal and noise functions [1]. 

4.3  Peculiarities of Delay Time Estimation Using the Maximal Likelihood Method	
115
Let the phases of received and reference signals be equal. From (4.21), it follows 
that the value of the global maximum of the function qs(tdel) is equal to qs/n = 2E/N0, 
the average value and the variance of the noise function qn(t) are equal, respectively, 
to zero and 2E/N0. The distribution law w(x) of the function qn(tdel) is considered 
to be normal with the mentioned average value and the variance. The probability 
of the fact that the maximum with a number m exceeds the global maximum can 
be determined as G. The values Lm and L0 will be random variables with the defini-
tion domain in the interval (–¥, ¥) due to noise influence. Therefore, to define the 
probability Pm(Lm > L0), it is necessary to average the probability P(Lm > L0) over 
all possible values of L0. As a result, the probability Pm(Lm > L0), that is, the prob-
ability of the fact that the maximum value with a number m will exceed the global 
maximum value, is determined as
	
1
2
1
0
/
/
2
/
1
/
0
/
1
exp
(
) /2
2
1
exp
(
) /2
2
1
(1
/
)
1
2
2
m
s n
s n
m
s n
s n
x
m
s n
P
x
L
q
q
x
L
q
dx dx
q
q
L
L
q
π
π
¥
-¥
¥
é
ù
=
-
-
ë
û
ì
ü
ï
ï
é
ù
´
-
-
í
ý
ë
û
ï
ï
î
þ
ì
ü
é
ù
-
ï
ï
»
- F ê
ú
í
ý
ê
ú
ï
ï
ë
û
î
þ
ò
ò
	
(4.22)
where Lm is the value of LLF maximum with a number m corresponding to the 
delay tdel,m and defining through the DFS SF envelope
	
0
del
del,
del,0
del,
(2 /
)sin[
(
)/2]/[
(
)/2]
m
m
m
L
E N
t
t
t
t
ω
ω
=
D
-
D
-
	
(4.23)
where tdel,0 is delay time corresponding to the LLF global maximum.  
Figure 4.3 shows functions of the probability logarithm of anomalous er-
ror arising versus the signal/noise qs/n for Lm = 1 and Lm = 2. It follows from 
­Figure 4.3 that real achieved values of qs/n of the probability of an anomalous 
error arising are sensible enough due to noise influence. At qs/n » 60 dB, the prob-
ability P1 » 10-4, and the error value is l/2. For accurate range measurement, 
such a probability of anomalous error arising is inadmissible. The application of 
iterative algorithms for a global extreme search leads to anomalous error mul-
tiple to l/2.
To eliminate the anomalous errors in [3], the two-stage procedure of range esti-
mation is offered. In conformity with FMCW RF, this procedure ensuring elimina-
tion of anomalous errors has been modified as follows:
Stage 1:
• 
 It is necessary to perform the preliminary estimation of tdel using 
the algorithm (3.4) providing estimation falling into the vicinity of the LLF 
global maximum. The measurement error at the first stage recalculated into 
range should not exceed l/4, that is, the following obvious condition should 
be satisfied

116	
The Maximal Likelihood Method for Range Estimation
	
-
<
-
<
/ 4
/ 4
R
R
λ
λ

	
(4.24)
	
where R is the range estimation obtained on the basis of the algorithm 
(3.4).
Stage 2:
• 
 The specification of the estimation using MLM is carried out. There-
fore, the search is performed in the range interval satisfying the condition 
(4.24). Naturally, we may ensure the potential accuracy in the case only when 
phases, carrying frequencies, and FM sweeps of both signals (DFS and the ref-
erence signal) are equal. In this case, the LLF global maximum for the SNR 
qs/n ® ¥ will coincide with the true range and will be located symmetrically 
inside the interval (4.24). 
The two-stage procedure of range estimation leads to simpler MLM program 
realization as it allows refusal from methods of multiparameter optimization at the 
search of the global extremum. The search of the global maximum, which is located 
inside the interval (4.24), can be performed by methods of single-parameter optimi-
zation at preliminarily measured phase of the reference signal. 
4.4  Main Factors Affecting the Measurement Error of Time Delay
Obtaining of delay time estimation with the variance defining in accordance with 
(4.8), that is, for known phase js, is limited by a set of reasons. Let us list the 
main factors, which lead to additional errors at the application of MLM. We can 
note first the inaccuracy of DFS signal determination, instabilities of the carrier 
frequency, the FM sweep, and PAM. We mentioned earlier that the difference in 
amplitudes of DFS and the reference signal does not lead to noticeable increase of 
the measurement error at application of invariant transformation (4.18).
Figure 4.3  Plots of the probability logarithm of anomalous error arising as function of SNR for the 
first (A1) and the second (A2) local maxima.

4.4  Main Factors Affecting the Measurement Error of Time Delay	
117
Algorithms of frequency estimation using the power spectrum of the signal do 
not take into account information containing in the DFS phase. However, we see 
from (1.6) that the unknown parameter, which should be defined, contains both 
in the frequency and in its phase. It follows from (1.6) that DFS phase is not the 
random variable. It is unknown variable as the DFS frequency. Successful MLM 
implementation with the known DFS phase allows not only decrease the estimation 
variance but decrease the FMCW RF transmitter power, which follows from (4.5) 
as SNR 2E/N0 is included in this equation. 
The DFS phase shift arising in the path of preliminary analog processing 
­depends on frequency and, accordingly, on the delay time of the reflected signal. 
Therefore, the formula (1.8) should be rewritten in the form:
	
dif
0 del
mod
del
del
rf
pp
del
( )
(
0.5
)
(
)
t
t
t
t
t
t
ϕ
ω
ω
ϕ
ϕ
=
+
-
+
+
	
(4.25)
where jpp(tdel) is a phase characteristics (PC) of the circuit of preliminary process-
ing. We introduce js = jrf + jpp.
To estimate the PC definition inaccuracy influence, in accordance with (4.3), 
we calculate SF. After integration and transformations, neglecting by items with 
doubled frequency, we determine that SF is:
	
del
del,ref
del
0
del
del,ref
0
del
del,ref
,ref
sin
(
)/2
2
(
)
(
)/2
cos (
)(
)
s
s
s
t
t
E
q t
N
t
t
t
t
ω
ω
ω
ω
ϕ
ϕ
D
-
=
D
-
´
+ D
-
+
-
é
ù
ë
û
	
(4.26)
where tdel,ref and js,ref are relatively true values of delay time tdel and js,ref.
Calculating the derivative 
del
del,ref
del
del
(
)
s
t
t
q t
t
=
¶
¶
and assuming that the item sin z/z 
influences insignificantly on the SF extremums position, we see that the measuring 
error DRj due to inaccurate determination of DFS phase can be presented as: 
	
,ref
0
[
]/[4 (1
/
)]
s
s
Rϕ
λ ϕ
ϕ
π
ω ω
D
=
-
+ D
	
(4.27)
where js and js,ref are in radians and l is the wavelength corresponding to the car-
rier frequency of the SHF oscillator. 
It follows from (4.27) that the difference in values of DFS phase js and the 
reference signal js,ref leads to significant increase of the error. For example, we 
may note that the value Dj = js – js,ref equal to 100 leads to the error of 0.406 mm 
for the transmitter wavelength of 3 cm. The maximal error value for Dj = 180° 
­approached l /4, which is evidently unacceptable. The maximal error value l /4 
in this case is caused by the fact that two-stage procedure of range estimation is 
used. The delay interval, within which we are searching the specified value of tdel 
at the second stage, is located so that two adjacent LLF (4.2) maxima fall to their 
boundaries due to the phase difference (equal to Dj = 180°) between DFS and the 
reference signal. The accurate value of measuring range corresponds in this case to 
the LLF minimum between these adjacent maxima. 

118	
The Maximal Likelihood Method for Range Estimation
The influence of the frequency deviation 
0f
δ  of the master oscillator from the 
rating value, as it follows from (1.6), leads to variation of initial signal phase and, 
hence, to variation of js for each value of tdel. Substituting the phase variation 
dj due to frequency deviation 
0f
δ  as 
0
0
2
2
/
f
f
R c
ϕ
δ
π
δ
=
, calculating the derivative 
del
del,ref
del
del
(
)
s
t
t
q t
t
=
¶
¶
, and finding SF (4.26) extremums, we present the range measure-
ment error DRf caused by inequality of the transmitter carrier frequency and the 
frequency of the reference signal, in the following form:
	
0
0
/(1
/ )
f
f
R
R
f f
δ
D
=
+ D
	
(4.28)
When obtaining (4.28), as for (4.27), we assumed that the item of sin z/z type 
influences insignificantly of SF extremum offset. 
The error DRf depends proportionally upon the measuring range. Assuming 
that the long-term instability 
0f
δ  of the carrier frequency of the modern FMCW 
RF is not worse than 10–6 (which follows from technical specifications for modern 
master crystal oscillators), it follows from (4.28) that for f0 = 10 GHz DRf is ap-
proximately 0.03 mm for the range of 30 m from RF.
Figure 4.4 shows functions of measured range errors determined in accordance 
with (4.28) for the transmitter carrier frequency 10 GHz and the FM sweep 500 
MHz versus measuring range. 
Curve 1 corresponds to increasing of the measuring range from 1 m to 30 m at 
the difference of DFS frequency and the frequency of the reference signal by –1 × 
104 Hz. Curve 2 corresponds to the situation when at achievement of the range of 
30 m the DS frequency increases with respect to the rating frequency by 2 × 104 Hz 
and the decrease of measuring range occurs. Curve 3 corresponds to the case when 
with an increase of measuring range from 1 m to 30 m, the DFS frequency varies 
Figure 4.4  Functions of the range measurement error versus the range for DFS frequency deviation 
from the carrier frequency of the beating signal.

4.4  Main Factors Affecting the Measurement Error of Time Delay	
119
in accordance with the linear law (from f0 to f0 + 
0
0 f
f δ ). Curve 4 corresponds to 
the situation when at a decrease of the measuring range from 30m to 1m, the DFS 
frequency decreases linearly from f0 to 
0
0
0 f
f
f δ
-
. 
From Figure 4.4 it follows that the error value DRf at carrier frequency varia-
tions within these limits cannot exceed values restricted by curves 1 and 2. The 
maximal range measurement error is achieved in the case when 
0f
δ  takes the maxi-
mal value and does not change during the measurement process. 
Functions similar to those presented in Figure 4.4 have a place at the difference 
of the FM sweep Df and the FM sweep used at generation of the reference signal, 
which can be presented as 
0
ref
f
f
f
fδ
D
= D + D
. Having obtained SF extremums for 
these case and having performed the necessary transformations, we can present the 
error DRDf caused by the difference of Df and Dfref as:
	
0
0
/(
)
f
f
R
f
R f
f
δ
D
D
= D
+ D 	
(4.29)
At these FM parameters and the long-range frequency instability 
0f
δ  is equal 
to 10–6, the error DRDf does not exceed 0.15 × 10–3 mm at the range of 30 m. The 
calculation according to (4.29) and the simulation results completely coincide. We 
can neglect such an error value of DRDf.
The PAM influence analysis will be carried out on the example of PAM pre-
sented in the form jrf
	
[
]
dif
0 del
mod
del
rf
( )
cos(
)
cos
( )
y t
t A
t
t t
ω
ω
ϕ
=
W
+
+
	
(4.30)
where 0 £ W £ Wmax, Wmax £ p/Tmod.
In this case, due to the PAM influence, the DFS envelope is the monotonous func-
tion. Varying W, we may change the PAM deepness m, which can be defined as:
	
dif,max
dif,min
dif,max
(
)/
A
A
A
µ =
-
	
(4.31)
where Adif,min, Adif,max are, respectively, the minimal and maximal values of the 
DFS envelope with account of PAM, which can be easily determined according to 
practical DFS. 
At W = 0, DFS is not modulated on the amplitude (m = 0), and for W = Wmax 
the PAM deepness is maximal (m = 1). The choice of PAM in the form (4.30) is 
­explained by the fact that such PAM can be met in practice and, moreover, according 
to the simulation results, which causes the essential error at the MLM application. 
PAM presence reduces the problem of range R estimation to the problem of 
estimation of unknown radio signal envelope. PAM influence on the range measure-
ment error depending on the PAM deepness m defined in accordance with (4.31) is 
presented in Figure 4.5 (curve 1). The plot is obtained with the help of modeling. 
The carrier frequency and the FM sweep were, respectively, 10 GHz and 500 MHz. 
We used the rectangular envelope of the reference signal in (4.2) or the rectangular 
envelope spectrum in (4.14). 
We see that influence of PAM on DFS leads to noticeable increase of the total 
error, which is calculated as:
	
2
total
D
h
σ
=
+
	
(4.32)

120	
The Maximal Likelihood Method for Range Estimation
where D is the variance of range estimation, 2
2
meas
1
(
) /
n
n
h
R
R
n
=
=
-
å
 is the systematic 
error caused by PAM, and n is the number of counted points in the range interval, 
which is specified within the limits from 0.9 m to 1.8 m (relative frequencies were 
varied from 3 to 6).
From this figure we see that already at small PAM level the measurement ­error 
is mainly defined by not noise interference (at simulation, we assumed that q = 
70 dB), but by the systematic error caused by the difference of the reference signal 
shape and DFS. The range measurement error at m = 0 corresponds to potentially 
possible at the MLM using, which can be defined by (4.5). With the range increas-
ing, the value h decreases monotonically. For example, we may note that h becomes 
equal to the variance D for relative frequencies on the order of 60 to 70. 
One can decrease the PAM influence by two methods.  
Method 1:
• 
 One may use the adaptive procedures allowing the estimation of 
some coefficients describing the DFS shape, which is a subject to PAM. As 
a result, we can substitute into LLF the reference signal, for which the enve­
lope is closed to the DFS envelope. The serious computation expenses and 
difficulties related to the fact that DFS frequency varies within rather wide 
limits (from hundreds of hertz to tens of kilohertz, depending on the measur-
ing range) is a disadvantage of this method.
Method 2:
• 
 To minimize the influence of the shape difference of the reference 
signal and DFS, we use WF w(t). We can write LLF as:
	
dif
del
/2
2
dif
del
0
0
ln (
,
,
)
1
[ ( )
( )
( ,
,
,
)
( )]
m
s
T
s
F A
t
y t  w t
S t A
t
 w t
dt
N
ϕ
ϕ
=
-
-
ò
	
(4.33)
Figure 4.5  PAM influence on the total error of range estimation.

4.5  Estimation of the Phase Characteristic of FMCW RF	
121
The multiplication of the reference signal with rectangular envelope and DFS with 
PAM by the same WF allows the reduction of the envelope shape difference. We use the 
following relative criterion as a measure of difference of the reference signal and DFS:
	
[
]
mod
mod
/2
/2
2
2
2
2
0
0
0
( )
( )
( )
( )
/
( )
T
T
s
w   t
t S t
S t
dt
S t dt
σ
=
P
-
ò
ò
	
(4.34)
where Ss(t) is DFS with rectangular envelope, S(t) is the reference signal, and Õ(t) is a 
function describing the PAM shape. We can be sure that WF multiplication by DFS 
with PAM and by the reference signal decreases 
2
0
σ , that is, decreases the difference 
degree of DFS with PAM and the reference signal by an order for m values from 0.2 
to 1. Such a reduction of the signal difference degree is fully sufficient to reduce the 
average square of the systematic error of range measurement caused by PAM until 
the value, which is two orders less than the MSD, is caused by the noise interfer-
ence. Figure 4.5 (curve 2) shows the behavior of sfull as a function of PAM deepness 
obtained for the ratio qs/n = 70 dB and for the application of the Blackman WF. The 
behavior of curve 2 is defined by the noise interference only. PAM influence is negli-
gible small. The last statement is true for relative frequencies beginning from 3 to 5. 
Nevertheless, the elimination of PAM influence with the help of WF acting on results 
of frequency estimation leads to an increase of the noise interference influence. The 
MSD increase caused by application of the Blackman window is about 1.54.
4.5  Estimation of the Phase Characteristic of FMCW RF
The analysis of errors performed above allows the statement that for MLM practi-
cal application it is necessary to have information about the PC of FMCW RF. The 
only way to determine the PC is to calculate it according to DFS. The DFS initial 
phase can be presented in the following form using (4.25):
	
init
0 del
rf
pp
del
0 del
del
(
)
(
)
s
t
t
t
t
ϕ
ω
ϕ
ϕ
ω
ϕ
=
+
+
=
+
	
(4.35)
It follows from (4.35) that for the determination of PC of FMCW RF js(tdel), 
we should calculate the estimation of the delay time tdel and the initial phase and 
execute appropriate calculations.
The estimation of the maximal likelihood of the initial phase of radio pulses 
with unknown frequency is obtained in [1] in the form:
	
init
0
0
arctan
( )sin
/
( )cos
T
T
y t
tdt
y t
tdt
ϕ
ω
ω
é
ù
= -
ê
ú
ê
ú
ë
û
ò
ò



	
(4.36)
where y(t) is a sum of DFS and noise interference.
To estimate the initial phase, it is necessary to estimate the signal frequency and 
then to execute calculations in accordance with (4.36). In (4.36), sine and cosine 
Fourier transformations are included and calculated on the frequency ω, which is 
an estimation of the radio pulse-filling frequency by the MLM method with the 
unknown initial phase of the signal. The following relation based on the transfor-
mation in (3.6) is the discrete analog of (4.36):

122	
The Maximal Likelihood Method for Range Estimation
	
1
1
init
0
0
arctan
( )sin2
( )cos2
K
k
l
l
y l
xl
y l
xl
ϕ
π
π
-
-
=
=
é
ù
= -
ê
ú
ê
ú
ë
û
å
å

	
(4.37)
The DFS frequency is designated in (4.36) and (4.37) as an argument of the 
initial phase. As the DFS frequency is connected linearly with the range and delay 
time tdel, we understand below tdel to be an argument of PC.
We should note that using the program atan 2, which is included into the pro-
gramming medium MATLAB, the definition domain of the initial phase estimation 
calculated in accordance with (4.36) and (4.37) is within the limits –p ¸ p. This has 
essential importance as, in contrast to the signal of type (4.11), which the initial phase 
does not change at frequency variation, the initial phase of DFS changes with DFS 
frequency variation, that is, with the range R variation to the reflected surface. 
To estimate the maximal likelihood of the initial phase of the radio pulse with 
known frequency, we can use also (4.36) and (4.37) with replacement of estimation 
ω to the known frequency w. 
For a practical determination of PC js(tdel), it is necessary to change the range 
R with some step D in the full range. For each range R we shall determine the 
initial DFS phase and to measure the delay time tdel. Because PC is defined as 
del
init
del
0 del
(
)
(
)
s t
t
t
ϕ
ϕ
ω
=
-




, we present w0tdel as 2 2 /
R
π
λ

 and shall determine the in-
teger number m of wavelengths corresponding to the range 2R. Let us introduce the 
designation 
del
0 del
(
)
2
m t
t
m
ϕ
ω
π
=
-


. The index m designates that the phase 
0 del
t
ω 
 is 
within the limits 0 ¸ 2p, that is, it is the main phase value taking into account the 
fact that for its determination at range R, the integer number of wavelengths is elim-
inated. If we omit the integer part of 
0 del
2
t
m
ω
π
-

, the definition domain of 
del
(
)
m t
ϕ

 
will be within the limits of 0 ¸ 2p. At the calculation of 
del
(
)
m t
ϕ

, we shall leave it 
unchanged if the 
del
(
)
m t
ϕ

 value is defined within the limits 0 ¸ p. If 
del
(
)
m t
ϕ
π
>

, then 
del
(
)
m t
ϕ

 will be defined as 
del
1
del
(
)
(
)
2
m
m
t
t
ϕ
ϕ
π
=
-


, where 1
del
(
)
m t
ϕ


 has the definition 
domain p ¸ 2p. As a result, PC 
del
(
)
s t
ϕ 
 can be calculated as:
	
del
init
del
del
(
)
(
)
(
)
s
m
t
t
t
ϕ
ϕ
ϕ
=
-



	
(4.38)
where the functions 
init
del
(
)
t
ϕ¢

 and 
del
(
)
m t
ϕ

 have definition domains –p ¸ p.
At the PC calculation in accordance with (4.38), the ambiguity arises at PC 
estimation (caused by outburst appearance with value about 360°). The reasons of 
outburst appearance are the following.
In the case of the value of the estimated PC js(tdel) = 0, the reason of outburst 
appearance is the influence of DFS spectrum’s SLs on frequencies w < 0 upon the 
DFS phase. This influence leads to the fact that the saw-toothed function jinit(tdel) 
of delay time (i.e., of the range) will be modulated on amplitude, that is, adjacent 
maximal and minimal values of the function js(tdel) will have different values. The 
phase shift jm(tdel) will have another modulation law as jinit(tdel) and jm(tdel) are 
calculated according to different formulas [jinit(tdel) in accordance with (4.36) or 
(4.37) and jm(tdel) through the measured delay time tdel using the algorithm (3.4)]. 
As a result, at the initial phase jinit(tdel) » 180°, the phase jm(tdel) can be equal to 
jm(tdel) » –180°. The outburst value is equal to 360°. To eliminate outbursts, it 
is necessary to compare two adjacent values of calculated PC. If their difference 
is equal, about 360°, it is necessary to eliminate outbursts according to equation 

4.5  Estimation of the Phase Characteristic of FMCW RF	
123
360
ϕ
ϕ
D
= D
+
°
¢
, where ϕ
D ¢ is the outburst value. If the PC estimation begins from 
the outburst appearance, instead of the value js(tdel) equal to 0° we will obtain the 
value js(tdel) equal to 360°. It has no significance in order to generate the reference 
signal since trigonometric functions are periodic functions with the period 360°. 
With relative frequency increasing greater than 4 to 5, outbursts caused by DFS 
sidelobes, which are generated on the negative frequencies, will disappear. In the 
case when js(tdel) ¹ 0 PC outbursts are caused by the function jm(tdel), on the con-
trary to the function jinit(tdel) does not depend upon the DFS initial phase. Outburst 
appearances can be easily explained by plots presented in Figure 4.6.
Plots correspond to the case when we estimate 
del
(
)
90
s t
ϕ
=
°

. At the drawing of 
the plots, the delay time is recounted into the range. Functions jinit(tdel) and jm(tdel) 
are designated in Figure 4.6 by the numbers 1 and 2. Because js(tdel) ¹ 0, plots 1 
and 2 are displaced with respect to each other. The resulting PC js(tdel) calculated 
according to (4.38) is designated by the number 3. We see from this figure that due 
to displacement of functions jinit(tdel) and 
del
(
)
m t
ϕ

, the PC can be ambiguously esti-
mated. The PC js(tdel) estimation can take two values: +90° and –270°.
Starting with this, it is enough to eliminate simply the ambiguity in PC estima-
tion. For this it is enough to monitor its adjacent values and to modify the estima-
tion 
del
(
)
s t
ϕ 
 as follows. Let us designate the estimation 
del
(
)
s t
ϕ 
 calculated according 
to (4.38) as 
del
(
)
s t
ϕ¢ 
. The estimation 
(
)
s
n
R
ϕ

 can be formed by the following evident 
way recounting the delay time into the range: 
	
1
1
1
1
(
)
360
if
(
)
(
)
and
(
)
(
)
(
)
(
)
360
if
(
)
(
)
and
(
)
(
)
s
n
s
n
s
n
s
n
s
n
s
n
s
n
s
n
s
n
s
n
s
n
R
R
R
R
R
R
R
R
R
R
R
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
-
-
-
-
ì
+
°
>
¢
¢
¢
ï
-
> D
¢
ï
= í
+
°
<
¢
¢
¢
ï
ï
-
< D
¢
î











	
(4.39)
Figure 4.6  Plots of phase characteristics: 1 is the DFS initial phase, 2 is the function jm(ctdel/2), 
and 3 is the PC calculated using the DFS initial phase and the function jm(ctdel/2).

124	
The Maximal Likelihood Method for Range Estimation
where Dj is some threshold of comparison and n and n – 1 are the numbers of PC 
measurements displaced in the range with the step D.
Because the outburst value at PC estimation is equal about 360°, the choice of 
Dj value in noise absence is arbitrary in the general case: Dj may lie about within 
the limits of 10° < Dj < 350°. The main point is that Dj value is less than the out-
burst value. As the outburst value does not practically depend upon the step D, then 
Dj does not practically depend upon the D value.
Figure 4.7 shows the PC estimation obtained according to (4.38) and (4.39). At 
simulation PC is specified by the following equation: 
	
4
init
final
(
)
360{sin[ (
)/2
]} ,
1,2,3
s
n
R
n
R
R
n
ϕ
π
=
D +
=
…	
(4.40)
where Rinit = 0.3 m and Rfinal = 30 m are the initial and final values of the range to 
the reflecting surface and D is the displacement step of the reflecting surface (it is 
­accepted as 3 mm at simulation). The carrying FMCW RF frequency is 10 GHz, 
and the carrier FM sweep is 500 MHz. 
The characteristic 1 corresponds to the FMCW RF FC specified according to 
(4.40). The curve corresponds to the PC 
( )
s R
ϕ

 calculated according to (4.38). It is 
seen that the PC 
( )
s R
ϕ

 is ambiguously defined due to the outburst presence. The out-
burst value is about 360°. Curve 2 corresponds to modified PC 
( )
s R
ϕ

 according to 
(4.39). Obtaining the functions, we assumed that jrf = 30°; therefore, the function 
( )
s R
ϕ

 is raised a bit by 30°. At the beginning of curve 2, we can see oscillations of 
the PC estimation caused by the influence of the DFS spectrum SLs located at w < 0. 
The application of (4.39) allows for the elimination of PC definition ambiguity, that 
is, obtaining curve 2 as a result of the calculation presented in Figure 4.7. 
The estimation of PC values at DFS reception on the background of the noisy 
interference has specific features. At the small ratio q, the application of (4.39) does 
not avoid the sharp PC variation by 360°. It is caused by the fact that in a noninter-
ference situation (a very large ratio of signal to noise), the PC 
( )
s R
ϕ
  changes by 360° 
Figure 4.7  Typical plots of phase characteristics with estimation results correction and without 
correction. 

4.5  Estimation of the Phase Characteristic of FMCW RF	
125
(or by a close enough value) at two adjacent calculations. The presence of noisy 
interference leads to the fact that there is a nonzero probability that the PC js(tdel) 
variation by 360° will happen during several adjacent calculations. Therefore, the 
separate PC variations will be less than the Dj value. The condition (4.39) will not 
be carried out; therefore, the PC will be displaced by 360°. This PC position can be 
stable. The PC will return to the initial position when the PC variation by 360° will 
again occur during several adjacent calculations. The PD definition ambiguity elimi-
nation can be provided by supplementing (4.39) by the following condition.
	
if 
1
1
1
(
)
(
)
,
then
(
)
(
)
s
n
s
n
s
n
s
n
R
R
R
R
ϕ
ϕ
ϕ
ϕ
ϕ
-
-
-
> D
=




	
(4.41)
where Dj1 is some comparison threshold. The condition (4.41) limits the PC out-
burst values owing to the noise influence. 
The values of comparison thresholds Dj in (4.39) and Dj1 in (4.41) should be 
selected in general by some optimal way, for instance, using the MSD minimiza-
tion criterion caused by noise influence. However, the strict selection of optimal 
values of Dj and Dj1 will meet the essential difficulties of mathematical character. 
Therefore, the values of Dj and Dj1 are selected empirically on the basis of both 
the statistical simulation results and signal processing obtained using the industri-
ally manufactured FMCW RF Bars-351. As a result of multiple inspections, the 
comparison threshold value Dj is selected equal to 250° and the value Dj1 = 120°. 
The supplement of condition (4.39) by the condition (4.41) is expedient at low 
ratios q. Beginning from the ratio q = 60 dB, it is enough to limit by (4.39). We 
should note that the program unwrap, which is in the MATLAB software medium 
and is intended for elimination of PC outbursts, showed at small q worse results 
than the above-suggested procedure. The typical results of PC estimation with the 
help of the above-described procedure (plot 1) and the program unwrap (plot 2) are 
presented in Figure 4.8. We see from Figure 4.8 that for the application of unwrap 
Figure 4.8  Plots of phase characteristic estimation using the unwrap program and the considered 
modified estimation.

126	
The Maximal Likelihood Method for Range Estimation
program the jump is observed in the plot of PC estimation versus the range. Func-
tions are obtained for q = 45 dB. Before the jump, two plots are fully coincided. 
We note that the estimation variance 
init( )
R
ϕ

 is essentially less than the estima-
tion variance 
( )
s R
ϕ

 by the value equal to 
2
2
0
12
/
ω
ω
D
 that follows from (4.9) and 
(4.13). It can be easily explained because 
( )
s R
ϕ
  is determined with range estimation. 
For f0 = 1010 Hz and the carrier FM sweep Df = 5 × 108 Hz, the estimation vari-
ance of the initial phase is less than the estimation variance of 
( )
s R
ϕ

 by the value 
1.2 × 103.
Besides the noisy interference influence, the truncation error caused by the 
spectrum SLs’ influence (located at w < 0) upon the main lobe calculated at w > 0 
leads to errors at PC determination. This was already mentioned at the analysis of  
Figure 4.7.
The total truncation error of 
( )
s R
ϕ

 estimation according to (4.35) is determined 
by the truncation error DFn(R) at the definition of the 
( )
s R
ϕ

 initial phase and the 
truncation error DFn(R) of estimation of the phase addition 
02 /
R c
ω

.
At the determination of the truncation error 
init( )
R
ϕ

, we first consider the case 
in which the DFS frequency is known. Using (4.36) and assuming that the DFS 
frequency wR is equal to the reference frequency of quadratic channels, we provide 
the simple trigonometric transformations and integration supposing that the noisy 
interference is absent, we can represent the truncation error DFn(R) of  calculation 
of the initial phase jinit(R) in the following form:
	
init,true
1
0
1
0
( )
(2 / )
[ 2sin( /2)sin( 2
/ )]/
sin[
2 /
(2 / )]
arctan [2cos( /2)sin(2
/ )]/
cos[
2 /
(2 / )]
n
s
s
R
R c
z
R c
z
R c
R c
z
R c
z
R c
R c
ϕ
ω
ω
ϕ
ω
ω
ϕ
DF
=
-
- D
-
+
-
D
+
+
	
(4.42)
where jinit,true (2R/c) is the true initial phase, z = 2R(w0 + Dw)/c + js(2R/c), and 
z1 = 4DwR/c.
The maximal error value DFnmax(R), that is, the envelope of the function DFn(R) 
in degrees, is defined as:
	
max( )
180 /(2
)
n
R
c
R
ω π
DF
=
     °
D
	
(4.43)
Figure 4.9 shows the function of instantaneous error of DFS initial phase de-
termination versus the relative frequency at known DFS frequency and its envelope 
calculated in accordance with (4.42) and (4.43).
Simulation results are completely correlated with plots presented in Figure­ 4.9. 
At simulation, the true range was substituted in formulas determining the PC 
estimation. 
We see that the truncation error of DFS initial phase determination has oscillat-
ing character. The period of high-frequency oscillations is l/4. The PC js(R) does 
not affect the error DFn(R). Its influence manifests itself in the value of initial phase 
of high-frequency oscillations. The envelope of the instantaneous error determines 
the maximal error of initial phase estimation. 

4.5  Estimation of the Phase Characteristic of FMCW RF	
127
To determine the truncation error of initial phase estimation at the unknown 
DFS frequency, we assume that the reference frequency in the quadratic channels is 
different from DFS frequency. Performing transformations according to (4.36), we 
determine that at an unknown DFS frequency the truncation error can be presented 
in the form:
	
init,true
1
1
1
1
1
1
2
( )
sin
sin
sin
sin
arctan
sin
cos
sin
cos
nn
R
R
c
z
z
z
z
z
z
c
c
c
c
z
z
z
z
z
z
z
z
z
c
c
c
c
z
z
z
ϕ
æ
ö
DF
»
ç
÷
è
ø
- +
+
æ
ö
æ
ö
æ
ö
æ
ö
Q -
+ Q
ç
÷
ç
÷
ç
÷
ç
÷
è
ø
è
ø
è
ø
è
ø
-
-
+
-
+
+
æ
ö
æ
ö
æ
ö
æ
ö
Q +
+ Q
ç
÷
ç
÷
ç
÷
ç
÷
è
ø
è
ø
è
ø
è
ø
-
+
	
(4.44)
where z = DwDR/2; z1 = 2DwR; Q = w02R/c + js (2R/c), DR is the truncation error at 
range measurement. When determining (4.44), we supposed the only assumption, 
that DR/R is negligibly small.
The function obtained according to (4.44) is shown by a thin dotted line in 
Figure 4.10. The appropriate DFS simulation was performed with this aim using 
the algorithm (3.4) and the range was estimated and the error DR was determined, 
which was substituted in (4.44). Simulation results and calculations according to 
(4.44) practically completely correlate.
The behavior of truncation errors of initial phase estimations for known and 
unknown DFS frequency has a different character. First, the high-frequency oscil-
lation estimation scope for an unknown frequency is about three times more than 
the high-frequency oscillation estimation scope for DFS phase with a known sig-
nal frequency. Second, there are no clearly expressed nodes, which are observed 
Figure 4.9  The plot of truncation error of initial phase estimation versus the relative range for 
known DFS frequency and its envelope.

128	
The Maximal Likelihood Method for Range Estimation
in ­Figure 4.9, in the plot of the truncation error of initial phase estimation with 
­unknown frequency. The period of high-frequency oscillations is l/4 as before.
The maximal error value (the high-frequency oscillation envelope of initial 
phase estimation) is defined by the following equation (in degrees):
	
max( )
3(180 )/(2
)
nn
R
                    R
π ω
DF
»
°
D
	
(4.45)
This function is shown in Figure 4.10 by the thick dotted line. The minimal 
value of the truncation error of the DFS initial phase determination for an unknown 
frequency can be determined according to (4.43) and it is shown in Figure 4.10 by 
the thick solid line.
From Figure 4.10 we see that the truncation error of initial phase estimation 
monotonically decreases with the relative range increase. At an unknown signal fre-
quency, the truncation error of initial phase determination on relative range equal 
to 5 is the value of about 10°. 
The characteristics presented in Figures 4.9 and 4.10 were obtained without us-
ing WF. Having not described the bulky mathematical transformations, we indicate 
that WF application, in particular, the Blackman WF, allows for the reduction of the 
truncation error of the DFS initial phase estimation by about the order. 
Now we compare the truncation error of initial phase determination and the 
error of PC determination 
( )
s t
ϕ  .
Figure 4.11 shows the characteristic corresponding to the truncation error 
DFs(R) of PC estimation 
( )
s R
ϕ

 versus the relative range. To obtain this curve at 
discrete range variation with the step 0.0001 m, we simulated DFS on the basis of 
the algorithm (3.6) and estimated the range, and then, on the basis of this approach, 
we determined the PC and calculated the error according to the formula:  
	
init
0
,true
( )
[
( )
2
/ ]
( )
s
s
R
R
R c
R
ϕ
ω
ϕ
DF
=
-
-


	
(4.46)
Figure 4.10  Plots of the truncation errors of initial phase determination versus the relative range at 
unknown DFS frequency.

4.5  Estimation of the Phase Characteristic of FMCW RF	
129
where js,true(R) is the true PC. Simulation was performed at the carrier frequency 
10 GHz and for the FM sweep at 500 MHz.
From Figure 4.11 it can be seen that the truncation error of the PC estimation 
significantly exceeds the error of initial phase estimation. Taking into consideration 
that the 1-mm range measurement error gives inaccuracy in the PC determination 
by 24°, which is caused by the item 
02 /r c
ω
  that is used for PC estimation, we can 
make a conclusion that the error of range estimation has the main contribution in 
the PC estimation error. Evidently, it is impossible to use PC with such a truncation 
error for generation of the algorithm’s reference signal on the basis of MLM. To 
decrease the truncation error, we use the Blackman WF. Simulation results obtained 
using the Blackman WF are presented in Figure 4.12. 
Figure 4.11  The plot of the truncation error of PC determination of FMCW RF without WF. 
Figure 4.12  The plot of the truncation error of FMCW RF PC determination using WF.

130	
The Maximal Likelihood Method for Range Estimation
Taking into account the results of Chapter 3, we may notice that the trunca-
tion error of PC determination decreases practically proportionally to the reduction 
of the range determination error, at which the value of DFs(R) decreases quickly 
enough. From Figure 4.12 we see that for the relative range equal to 5, the value 
truncation error of PC determination is equal to about 8°. For the relative range 
equal to 10, this error is equal to about 3°. Taking into consideration that the PC 
determination error by 10° leads to a range measurement error of 0.406 mm, we 
may recommend executing the PC estimation with the Blackman WF beginning 
from relative ranges equal to 8 to 10. Such relative frequencies correspond to a 
measuring range of 1.2 to 1.5 m (for a FM sweep of 1 GHz). 
It is necessary to note that the application of methods described in Chapter 3 
­allows reduction of the PC error on lesser ranges until the accepted level. Because 
the error of PC determination essentially depends upon range determination error, 
then the above-mentioned conclusion about frequency estimation is true for PC es-
timation. Namely, for relative frequencies larger than 4 to 5, the main contribution 
(for ratio q = 70 dB and less) into the total error (4.32) is made by the noisy interfer-
ence. To evaluate the range estimation accuracy, which is used for PC estimation, 
we use (4.28). After transformations, neglecting the second order of smallness, we 
obtain that in the first approximation the PC estimation error dj is connected with 
range estimation error dR as dj = 720° dR/l. In the future, we use the PC estimation 
obtained using the WF for generation of the reference signal phase of the frequency 
estimation algorithm on the basis of the MLM. 
In [1–4], it is shown that in the general case maximal likelihood estimates have 
distributions, which differ from the normal one. Nevertheless, the conditional dis-
tributions of estimation error (i.e., for fixed value of estimating parameter) will ap-
proach asymptotically to the normal one with an increase in qs/n [1]. It follows from 
(4.36) and (4.37) that PC estimation is obtained using algorithms, which realize the 
MLM. Therefore, we shall assume that the distribution 
del
(
)
c t
ϕ
 is normal with the 
mean value jc(tdel). 
4.6  Simulation of the Range Estimation Algorithm
The aim of simulation is an estimation of the realistic benefit in accuracy of range 
measurement using MLM with the known DFS phase. The error analysis performed 
above showed that two reasons mainly contribute to the resulting error. The first 
one is the difference of PC used in the reference signal from its true value. The 
second one is the difference of carrier frequency of the transmitter from its rated 
value. At the simulation performance, we assume that the carrier frequency w of 
the FMCW RF is not equal to the frequency wref of the reference signal. The differ-
ence of frequencies w and wref will lead to offset of range estimation, which can be 
considered at the analysis of simulation results. 
Determining the PC according to the above-described approach assumes the 
estimations of the DFS initial phase and delay time in the whole measuring range 
interval with the step D. At each fixed value of the range, the single measurement 
of the DFS phase is carried out for each value. The application of such a PC in the 
­reference signal, as we already mentioned, does not lead to decrease of estimation 

4.6  Simulation of the Range Estimation Algorithm	
131
variance compared with algorithms, which do not take into account the signal 
phase. To determine the PC estimation with a lesser variance, the averaging opera-
tion is necessary either over a DFS ensemble or inside some small range interval. The 
last requires the reflecting surface displacement with respect to the FMCW RF.
4.6.1  Simulation Results at a Known Phase Characteristic
Now let us find out the range measurement errors depending on the relative range 
for the case when reference signal parameters correspond to DFS to delay accuracy. 
Figure 4.13 shows functions of the relative error logarithm versus the relative range 
obtained using simulation. The two-stage procedure was simulated described in 
Section 4.3. At the first stage, we used the Blackman weighting function. The useful 
reflector was moved with the 1-mm step. The relative MSD was calculated in the 
15-cm range interval. Results were obtained for three values of SNR (20 dB, 60 dB, 
and 100 dB).
The comparison with Figures 3.24 and 3.25 allows the statement that MLM 
permits essentially decreasing the noise influence on the range estimation result.
4.6.2  Simulation Results at the Unknown Phase Characteristic: The Approach 
to Practical Estimation of the Phase Characteristic
We assume that the PC of the FMCW RF and dielectric properties of the reservoir 
contents determining the phase jrf are unknown. The PC of FMCW RF will be 
determined at its mounting on the object. Here some explanations are necessary. 
After the FMCW RF mounting on the object, as a rule, we have no information 
about the reflecting surface condition (at the discharge, the loading is performed, 
or the reflecting surface is fixed). The results of range measurement with the help of 
the algorithm (3.4) can serve as the criterion of reflecting surface condition. At the 
fixed position of reflecting surface with respect to the FMCW RF, the PC estimation 
determined over the ensemble DFS realizations can be displaced as PC estimation 
has an oscillating character depending on the range. The displacement of the PC 
Figure 4.13  The function of relative MSD for MLM versus the relative range for three SNRs.

132	
The Maximal Likelihood Method for Range Estimation
estimation will lead to the additional error of range measurement. The average 
values of PC estimations obtained at different ranges from FMCW RF over DS 
ensembles should be approximate (using software) by some deterministic function 
(at autonomous operation of the device) with the purpose of the reference signal PC 
generation for the MLM. 
Therefore, the following procedure of PC estimation obtained with a lesser 
variance seems to be more suitable. Let us carry out PC averaging inside the range 
interval that is small enough. We designate the PC estimation js(R) as: 
	
( )
( )
( )
s
s
s
R
R
R
ϕ
ϕ
ϕ
=
+ D

	
(4.47)
where Djs(R) is the estimation span with respect to PC mean value, that is, with 
respect to js(R). The variance of the random variable Djs(R) with a zero mean 
value is equal to the estimation variance js(R) and it can be determined by (4.9). 
To obtain a PC estimation with a lesser variance, we average 
( )
( )
( )
s
s
s
r
r
r
ϕ
ϕ
ϕ
=
+ D

 
in accordance to the equation:
	
1
1
1
1
1
1
(
)
(
)
(
)
(
)
N n
N n
N n
s
n
s
i
s
i
s
i
i
n
i
n
i
n
R
R
R
R
N
N
N
ϕ
ϕ
ϕ
ϕ
+
+
+
= +
= +
= +
=
=
+
D
å
å
å


                      

                      
	
(4.48) 
where N = Rint/D; Rint is the range interval in which PC averaging is performed, 
D is the range increment to reflecting surface at each measurement, and 
i
R  is the ith 
range estimation on the ith DFS obtained with the help of the algorithm (3.4). For 
checking the level displacement, we need to use the algorithm of range measure-
ment on the basis of (3.4).
Averaging in accordance with (4.48) corresponds to PC averaging inside the slid-
ing rectangular window. At such averaging, the PC estimation variance will decrease 
by N times. However, the PC displacement ej arises, which can be defined as: 
	
2
1
int
( )
( )
( )
( )
( )
/
R
s
s
s
s
R
R
R
R
R
R dR R
ϕ
ε
ϕ
ϕ
ϕ
ϕ
=
-
=
- ò
	
(4.49)
where R1 and R2 are the initial and final values of the Rint interval, which leads to 
displacement of the range estimation due to PC difference of the reference signal 
and DFS. The value of ej displacement depends on Rint and on the behavior of the 
function js(R) inside the interval Rint. For a practically important case when the 
FMCW RF PC is the linear function of range
	
( )
s R
kR
b
ϕ
=
+
	
(4.50)
where coefficients k and b are unknown, the PC displacement will be determined 
as: 
	
2
1
[
(
)
(
)]/2
s
s
R
R
ϕ
ε
ϕ
ϕ
=
-
	
(4.51)
For simultaneous reduction of displacement ej and PC estimation variance, it 
is necessary to take into consideration that the displacement ej decreases at Rint 

4.6  Simulation of the Range Estimation Algorithm	
133
­reduction, and the variance of PC estimation at fixed D increases. It is very difficult 
to determine analytically the optimal value of Rint at simultaneous minimization 
both displacement and estimation variance. Nevertheless, it is evident that the in-
terval length Rint should be multiple of l/2. Such a choice of Rint allows minimiza-
tion the displacement error caused by oscillating character of the function of PC 
estimation versus range.
Now we determine of achieved estimation using simulation. We require that 
the displacement error due to PC estimation displacement would be essentially 
less than the displacement DRw due to carrier frequency instability of the trans-
mitter determined according to (4.28). We shall assume that FMCW RF PC is 
the linear function of the range (4.50), where k = 4p/Rmax (Rmax is the maximal 
measuring range). The coefficient b can be considered as zero since the estimation 
displacement DRj does not depend upon it. The choice of Rint is caused by the 
variation speed of the reflected surface. We select Rint = 15 mm. The displacement 
calculation according to (4.51) with a recount to the range will lead to displace-
ment DRj = 0.0075 mm at PC averaging in accordance with (4.48). The value 
of DRj depends only upon Rint at PC approximation by the linear function. The 
range variation speed to the reflecting surface can be accepted as 1 m/min. We 
assumed at simulation that the transmitter frequency drift of FMCW RF is maxi-
mal: 10 kHz. To minimize the truncation error caused by PAM, the Blackman 
WF is used. 
The simulation results are presented in Figure 4.14 in the form of the total mea-
surement error calculated according to (4.27) versus the measuring range. 
Curve 1 corresponds to the range estimation error when using the algorithm 
(3.4), and other curves correspond to the MLM with the PC averaging inside 
the sliding window according to (4.49) for N equal, respectively, to 10, 20, and 
100. With an increase of the range from FMCW RF, the reduction of the benefit 
in measurement accuracy is observed compared to the algorithm (3.4). This can 
be explained by the fact that at the calculation of the total error we took into 
account the range estimation displacement caused by the frequency difference of 
DFS and the reference signal (i.e., the phase difference of DFS and the reference 
signal).
The choice of N at averaging is determined by processor operating speed, which 
realizes the necessary calculation operations for MLM implementation. For the 
range variation speed to the reflecting surface for N, equal, respectively, to 10, 20, 
and 100, it is necessary to have the processor performing calculations necessary 
for a practical MLM implementation during approximately 0.7, 0.14, and 0.07 
second.
The reduction of the total error when using the MLM with an account of the 
PC, as it follows from Figure 4.13, depends on the measured range. If for the 30-m 
range the error reduction (depending on N) is two to three times larger, then for the 
5-m range the benefit in accuracy is from 3 to 7. Besides error reduction caused by 
the noisy interference, the MLM essentially allows a decrease in the measurement 
error of small range measurement. Because of narrow LLF maxima, its component 
with the doubled frequency does not influence as strongly as SL the DFS spectrum 
for w < 0.

134	
The Maximal Likelihood Method for Range Estimation
4.6.3  Reduction of the Noise Influence on the Accuracy of the Phase 
Characteristic Estimation
The benefit in accuracy at using the MLM taking into account the signal phase 
compared with the algorithm (3.4) can be increased owing to the reduction of the 
total error component in (4.32) caused by noise influence and displacement of PC 
estimation caused by PC averaging inside the sliding window. For this, it is neces-
sary to carry out the FMCW RF PC estimation on the special measuring bench, 
which is desirable in the anechoic box. For each fixed range Ri in the whole range 
of measuring ranges with some step eR, it is necessary to perform PC estimation 
over N DFS realization and then to average in accordance with
	
1
(
)
(
)/
N
s
i
s
i
i
R
R
N
ϕ
ϕ
=
= å

	
(4.52)
It is clear that the variance of average PC 
(
)
s
i
R
ϕ
 will be N times less than the 
variance 
(
)
s
i
R
ϕ
.
At the next stage, it is necessary to approximate the discrete sequence 
(
),
1,2
s
i
R
i
ϕ
=
… by the continuous function js(Ri) using the known methods of 
­approximation. The similar approximation can be carried out simply enough 
­because range finders have described PC as the function that is closed to linear. 
Figure 4.14  Plots of total error functions of the range measurement by the MLM with PC 
­averaging.

4.7  Conclusions	
135
The range, at which the value of js is defined, must be selected from the condi-
tion of minimization of spectrum SLs’ influence for negative frequencies upon the 
result of PC calculation.
4.7  Conclusions
Relations allowing for the determination the potential accuracy of the range esti-
mation at DFS processing on the background, the white normal noise as a function 
from SNR, the frequency of the carrying oscillation, and its FM sweep are given. 
The MLM application at an a priori known phase of DFS allows the reduction of 
the variance of range estimation by about three orders compared with algorithms, 
which do not take the signal phase into consideration.
The main components of the error affecting the range estimation error by the 
MLM method are determined. It is shown that, in the first place, PAM can be at-
tributed to the DFS phase estimation error, differences in the carrying oscillation 
of DFS, and the reference signal. The calculation expressions are given, allowing 
the determination of the range calculation error as a function of these factors. It 
is shown that the error caused by PAM can be eliminated with the help of the WF 
application. However, the WF application leads to an increase of the variance of 
range estimation. 
The equation is obtained allowing the determination of the appearance prob-
ability of anomalous errors multiple to the half-wavelength of the carrying oscilla­
tion depending on SNR at the search of the global maximum of the likelihood 
function in the wide range. 
The two-stage procedure of the range estimation by the maximal likelihood 
method is offered, which permits refusal from the global maximum search in the 
wide a priori range interval. In the first stage, the preliminary range estimation is 
determined on the basis of the algorithm searching the maximal spectral component 
of DFS. In the second stage, the global extremum of the likelihood function is deter-
mined in the narrow range equal to the wavelength of carrying SHF signal, which 
allows practically complete elimination in the upshot of the anomalous measure-
ment errors and a decrease in the computation expenses.  
The approach of determination of the phase-frequency characteristic of FMCW 
RF on the basis of DFS obtained during calibration on the measuring bench is 
discussed. The simple and effective method of outburst elimination at DFS phase 
estimation is offered based on the comparison of calculated PC values for two ad-
jacent calculations.
Relations are obtained allowing determination of the truncation errors of DFS 
phase estimation at known and unknown signal frequency. It is shown that the 
main component of the truncation error of DFS phase estimation is defined by the 
truncation error of the range estimation. 
The Rao-Cramer boundary is defined for the variance of DFS phase estimation. 
The equation for determination of the correlation coefficient between DFS phase 
estimation and the delay time is obtained.
The procedure is described allowing MLM realization at an unknown FMCW 
RF PC and offering averaging application of calculated values of PC estimation  

136	
The Maximal Likelihood Method for Range Estimation
inside the window sliding on the range axis. Such a procedure requires RF 
­displacement. 
It is shown that the total error of the range error, which takes into account the 
estimation variance and the truncation error, depends on the measuring range with 
consideration of frequency instability of carrying oscillation and PAM. To reduce 
the total error, it is necessary to increase frequency stability of carrying oscillation. 
The analysis of the signal frequency estimation algorithm presented by the short 
realization is performed. The received signal having the unknown frequency and 
initial phase is compared with the set of reference signals, which are calculated on 
different frequencies and for different initial phases. We assumed that realizations 
of the received signal have a different scale parameter. With the help of simulation, 
it is shown that MSD frequency estimations decrease the minimum by two times 
compared with known algorithms of frequency estimation of the signal presented 
by short realization. The offered algorithm permits to provide the measurement 
not only of frequency but the initial signal phase as well, in contrast to the known 
algorithms. 
References
[1]	
Tikhonov, V. I., Optimal Reception of Signals, Moscow, Russia: Radio i Sviaz Publ., 1983. 
[In Russian.]
[2]	
Sosulin, Y. G., Stochastic Signal Detection and Estimation Theory, Moscow: Sovetskoe 
Radio Publ., 1978, 320 pp. [In Russian.]
[3]	
Kulikov, E. I., and A. P. Trifonov, Signal Parameter Estimation against Interference Back-
ground, Moscow: Sovetskoe Radio Publ., 1978, 296 pp. [In Russian.]
[4]	
Berezin, L. V., and V. A. Veitsel, Theory and Design of Radio Systems, Moscow: Sovetskoe 
Radio Publ., 1977, 448 pp. [In Russian.]
[5]	
Jenkins, G. M., and D. G. Watts, Spectral Analysis and Its Applications, San ­Francisco, 
­Cambridge, London, Amsterdam: Holden-Day, 1969.

137
c h a p t e r  5
Effects of FM Nonlinearity
5.1  Introduction
In frequency-modulated range-finding, one of the significant factors influencing the 
main error of range measurement is linearity on the modulation characteristics of 
the SHF transmitter. At present, the methods of the MC linearity provision with 
the help of digital frequency synthesis using the phase-locked loop (PLL) system 
are known [1]. The synthesis usually performs on a comparatively low carrier fre-
quency and, after that, frequency multiplication to the required value and the am-
plification of the obtained signal is performed. These methods allow us to obtain 
good linearity and a wide FM sweep of the oscillator; however, their implementa-
tion is relatively expensive and complicated. Therefore, the problem of required 
accuracy ensuring the range measurement by simpler and cheaper methods at MC 
nonlinearity is worth investigating. 
To solve this problem, it is necessary to develop a model of oscillator MC, to 
investigate the influence of MC nonlinearity on results of range measurement, and 
to offer methods allowing for the reduction of the error.
5.2  The Mathematical Model of the Modulation Characteristic
In this case, we are speaking about the model w(umod) representing external charac-
teristics of the FMCW oscillator influencing range measurement ­accuracy.
In most cases, the voltage-controlled oscillator (VCO) is used as the source of 
FMCW oscillations. The varactor (or varicap) is most frequently used as the control 
element for FM sweep. Its properties are exactly defined as the practical character 
of frequency variation, which depends upon the linearity of w(umod).
The linearity of the FM sweep of the SHF oscillator is one of the main condi-
tions for the achievement of the high accuracy of range measurement. To estimate 
the MC linearity degree, the analytical MC record in the form of some equation 
selected with the help of approximation methods is more suitable. For a more com-
plete account of peculiarities of the MC form in our problems, we write the func-
tion of the cyclic frequency versus voltage as: 
	
2
0
mod
mod
init,
mod
1
sin[
(
)]
M
MC
n
n
n
n
f
f
K
u
au
b
d u
U
=
=
+
+
+
+
å
	
(5.1)

138	
Effects of FM Nonlinearity
where KMC and a define the linear and quadratic component, bn, dn, and Uinit,n 
­define, respectively, the oscillation amplitude, their frequency on the voltage axis, 
and the initial bias of each sine items, and M is a quantity of considering harmonics. 
We assume the linear variation of the voltage umod in time in this formula:
	
mod
u
u
K t
=
	
(5.2)
Therefore, the maximal voltage value at symmetric triangle modulation law 
(1.4) is
	
mod
mod/2
u
U
K T
=
	
(5.3)
This maximal value is defined starting from the specified FM sweep DF by 
means of a numerical solution of the nonlinear equation (for one oscillating 
­component):
	
{
}
mod
init
mod
init
sin[ (
)]
sin(
)
MC
K
U
b
d U
U
dU
F
+
+
-
= D 	
(5.4)
for the given MC parameters KMC, b, d, Uinit and the specified range DF of FM 
sweep at FMCW.
To find out all MC parameters in (5.1) based on the experimental data obtained 
in the table form containing the set of N pairs of appropriate numbers umod, fi, i = 
1,2…, N, we may apply the method of sequential extraction of separate elements 
described in [2] and developed in [3, 4]. The first three items can be defined on the 
basis of quadratic regression by means of approximation according to the least-
squares method [5].
Figure 5.1 shows (dotted line) one of the MCs of the industrially manufactured 
oscillator.
The solid line of quadratic regression obtained in the software medium 
­MATLAB 6.5 with the help of typical subprograms polyfit and polyval, which 
calculate, respectively, regression coefficients and the regression equation, is pre-
sented in the plot. After subtraction of the experimentally taken regression line 
data from the set on the basis of the obtained estimation values of the first three 
items in (5.1), we arrive to the remainder of the oscillating part in the form of the 
number set umod,i, Di:
	
2
0
mod
mod, ,
1,2,...
i
i
u
j
f
f
K u
au
i
N
D =
-
-
-
=

	
(5.5)
shown in Figure 5.2 by a dotted line.
Because there may be several harmonics in (5.1), we may apply the approach 
considered in [2], when the sequential extraction of each spectral component is 
performed.
Taking into account that in this case we are discussing not a time function but 
the function depending upon the modulating voltage, the method of super-­resolution 
of signals offered in [2] can be described in the following form. It is required to 
­estimate parameters of harmonics, which contain Di (amplitude bn, frequency dn, 
and phase jn = dnUinit,n) according to measurements obtained with the error. 

5.2  The Mathematical Model of the Modulation Characteristic	
139
For the solution of this problem, one often calculates the square of metric range 
C2 between the measured values of Di and the model fosc of oscillating component 
with proposed (sorted) parameters
	
2
2
osc,
1
(
)
M
i
i
i
C
f
=
=
D -
å
	
(5.6)
Figure 5.1  Modulation characteristics of the industrially manufactured oscillator with the quadratic 
regression line.
Figure 5.2  Plots of MC oscillation component with the shown approximate line versus voltage at 
M = 1.

140	
Effects of FM Nonlinearity
The method reduces to the performance of two stages. 
Stage 1:
• 
 The determination of the spectral line coordinates is provided even 
in the case when they cannot be resolved. This stage consists of two steps:
Step 1:
• 
 The peak is searched with maximal amplitude. The parameters of this 
peak are conferred to relatively parameters of the next spectral line. 
Step 2:
• 
 The difference is calculated between process values on the previous 
m-1th iteration and values of the next extracted spectral line:
	
,
,
1
osc(
,
,
)
i m
i m
n
n
n
f
b
d
ϕ
-
D
= D
-
	
(5.7)
Steps 1 and 2 are repeated until the amplitudes of the extracted peaks would be 
less than the chosen threshold. 
Stage 2:
• 
 The successive specification of all spectral line coordinates is carried 
out. The stage realizes the estimate performance by the least-squares method 
at searching of parameters. 
The parameters of spectral peaks are specified at the beginning and at subtract-
ing, at which all signals are obtained from the previous step of the initial signal with 
optimized parameters. The specification of spectral peak parameters is performed 
until the difference between newly obtained parameters from the previous stage 
would become less of the value required in advance. 
At each step of the second stage, it is expedient to apply the procedure of one-
dimensional minimization instead of the three-dimensional one referred to as the 
method of nonlinear least squares in [6].
As a result, we can reduce the procedure of multidimensional numerical mini-
mization to the procedure of one-dimensional minimization on the frequency dn. 
After finding the minimum, we can calculate the required parameters bn, jn, and 
Uinit,n:
	
2
2
n
cn
sn
b
b
b
=
+
	
(5.8)
	
arctan(
/
)
n
sn
cn
b
b
ϕ
=
	
(5.9)
	
init,
/
n
n
n
U
d
ϕ
=
	
(5.10)
The results of the offered algorithm application for MC approximation pre-
sented in Figure 5.1 for M equal to, respectively, 1, 2, 3, and 4 show that, as M 
grows, the approximation error decreases. 
The results of the MC parameter determination according to this approach for 
the series of industrially manufactured oscillators allows the conclusion that the 
range of possible values of MC parameters is: Ku =  (40…100) MHz/V, a = (-3 … 
-0.5) MHz/V2, b = (0…100) MHz, and d = (0, 1, … 5) rad/V. The parameter Uinit 
usually lies within the MC limits, but it does not influence later results. The consid-
ered example proves great possibilities of the model in (5.1) in the description of 
different types of MCs.

5.3  Effects of FM Nonlinearity for the Counting Method of Frequency Measurement	
141
5.3  Effects of FM Nonlinearity for the Counting Method of Frequency 
Measurement
MC nonlinearity leads to the nonproportional variation of the averaged value of 
the difference frequency FR,aver at variation of the measuring range. As was shown 
earlier, using the method of DFS phase joining, range variation causes variation of 
the modulation period and, hence, the modulating voltage amplitude, which leads 
to variation of the average MC slope. Because range calculation in FMCW RF is 
carried out under the assumption that this slope is constant, the measurement er-
ror arises. The presence of the stepwise slope’s variation in moments of DFS phase 
joining point jump to the next extremum and the smooth variation between these 
moments is the general property of such measurement. Stepwise variation defines 
the maximal slope’s variation, which accordingly causes the maximal measurement 
error [7]. To estimate the maximal variation value of FR,aver, we use (5.1) with the 
minimal set of nonlinear parameters with M = 1.
We assume for concreteness that the triangle symmetric modulating voltage 
is used. To determine the value of stepwise variation of the averaged slope, it is 
enough to consider one half-period of modulation. The law of modulating voltage 
variation is assumed to be linear:
	
mod
,
[0,
/2]
DC
u
u
U
K t t
T
=
+
Î
	
(5.11)
where UDC is the dc component and Ku is the slope of voltage increase.
We write the time function of the transmitter frequency substituting (5.11) into 
(5.1) as:
	
2
2 2
0
init
( )
2
sin[ (
)]
MC
DC
MC
u
u
DC
u
DC
DC
u
f t
f
K
U
K
K t
aU
aK t
aU
K t
b
d U
U
K t
=
+
+
+
+
+
+
-
+
	
(5.12)
Using the formula (1.10), we obtain the equation for difference frequency:
	
( )
{
2
cos[ (
]}
DFS
del
DC
init
u
F
t
t
A
Bt
C
d U
U
K t
=
+
+
-
+
	
(5.13)
where A = KDCKu + 2aUDCKu, 
2
u
B
aK
=
, and C = bdKu.
Now we calculate the averaged difference frequency for the modulation half-
period according to (1.11):
	
,aver
mod
init
mod
mod
init
2
{0.5
0.25
sin[ (
0.5
)]/
sin[ (
)]/
mod}
R
del
DC
u
DC
F
t
A
BT
b
d U
U
K T
T
b
d U
U
T
=
+
+
-
+
-
-
	
(5.14)
In the moment of the phase joining point, the half-period Tmod /2 changes by the 
jump on the value TR/2 to an increase from its minimal value Tst to the maximal 
Tst + TR /2 with measuring range increasing or vice versa to a decrease from the 
mentioned maximal value to Tst at the range reduction. Let us find the maximal 
variation of the averaged value of difference frequency DFR,aver and the jump of 
measuring range DR for specific cases. 

142	
Effects of FM Nonlinearity
5.3.1  The Quadratic Modulation Characteristic
Substituting b = 0 into (5.12) and the values of time moments t = 0 and t = Tst, 
we obtain the quadratic equation determining the modulating voltage amplitude 
­according to given frequency FM sweep DFmin:
	
2
DC
mod
min
mod
(
2
)
0
MC
aU
K
aU
U
F
+
+
- D
=
	
(5.15)
where Umod = TstKu is the value of modulation voltage and DFmin = TstKf is the value 
of the FM sweep forming during time Tst. We obtain the solution of this equation 
taking into account that Umod > 0:
	
mod
DC
2
DC
min
(
/2
)
(
/2
)
/
MC
MC
U
K
a
U
K
a
U
F
a
= -
+
+
+
+ D
	
(5.16)
The above-mentioned values of practical MC parameters are such that the first 
item under the square root is several orders more than the second one. Using the 
expansion into the Maclaurin series [5] for the square root and limiting by first 
two series items, we obtain the approximate equation:
	
mod
min
DC
/
2
)
MC
U
F
(K
aU
» D
+
	
(5.17)
From (5.17) at DTmod = TR /2, we obtain the value of stepwise increment of dif-
ference frequency:
	
2
del
0.5
R
u
R
F
aK T t
D
=
	
(5.18)
Now taking into consideration (1.25), after simple transformations we obtain 
the equation for the maximal value of the relative error of range measurement 
caused by the quadratic MC character: 
	
2
max,
min
DC
/
/(
2
)
quad
R
MC
R
a F
K
aU
δ st
D
=
D
+
	
(5.19)
At fixed MC parameters and the modulation law, the value of this component 
of the error does not depend on range and is defined only by the specified FM 
sweep, MC parameters a and KMC, and the value of UDC. The increase of the FM 
sweep leads to proportional increase of the relative error. The quadratic coefficient 
a is the algebraic quantity; therefore, its influence is ambiguous. Nevertheless, it 
cannot change in arbitrary limits; its value should not be such, at which the nega-
tive slopes will arise in the MC [8], and it must be the increasing function. We may 
consider as such the extreme value from below for a, at which there is an MC 
­extremum on the half-period boundary (i.e., at t = Tst). Therefore, the MC deriva-
tive becomes equal to zero:
	
mod
MC
DC
mod
( )/
2 (
)
0
u U
df u du
K
a U
U
=
=
+
+
=
	
(5.20)

5.3  Effects of FM Nonlinearity for the Counting Method of Frequency Measurement	
143
In this case the lower boundary for the quadratic coefficient is:
	
st
DC
mod
DC
0.5
/(
)
0.5
/(
)
MC
U
MC
a
K
K T
U
K
U
U
³ -
+
= -
+
	
(5.21)
In the connection that in the denominator of (5.19), the first item is much more 
than the second one, the influence of UDC variation is much more than the second, 
and the UDC variation on the error is insignificant. Due to this reason, the function 
of the measurement error versus a variation is mainly defined by the numerator 
of (5.18) and is practically linear. Figure 5.3 shows typical plots of the relative 
­error function of range measurement versus the quadratic coefficient for KMC = 
50 MHz/V at three values of UDC = 2 V, 4 V, and 6 V.
If one expresses from (5.19) the absolute value of the measurement error taking 
into account the mentioned fact, it turns out that the modulus of error quadratic 
component does not depend upon the FM sweep and is defined by MC parameters 
only: 
	
2
max,quad
MC
0.25
/
R
ac K
D
=
	
(5.22)
From here we see that variation of MC slope effects significantly on the error 
value. At the slope increase, the error sharply decreases. This fact allows us to put 
limitations on the parameters of the nonlinear MC according to the given maximal 
permissible measurement error. 
Figure 5.3  Plots of the function of the normalized measurement error versus the quadratic coef-
ficient for KMC = 50 MHz/V.

144	
Effects of FM Nonlinearity
5.3.2  The Oscillating Modulation Characteristic
The equation for determination of the modulating voltage amplitude can be found 
out in a similar manner as in (5.15) substituting in (5.12) a = 0 and values of time 
moments t = 0 and t = Tst:
	
MC
mod
DC
init
mod
DC
init
min
sin[ (
)]
sin[ (
)]
0
K
U
b
d U
U
U
b
d U
U
F
+
-
+
-
-
- D
=
	
(5.23)
This transcendent equation can be solved by a numerical way only. However, 
as for the quadratic case, we may put on limitations on MC parameters, at which 
we cannot meet decaying parts:
	
MC
DC
init
( )/
cos[ (
)]
0
df u du
K
bd
d U
U
u
=
+
-
+
³ 	
(5.24)
The worst case will be when the function cos(*) in this equation becomes equal 
to -1. From this we obtain the limit expression for MC parameters:
	
MC
bd
K
£
	
(5.25)
Assuming in (5.14) that a = 0, we obtain the value of stepwise variation of 
­averages difference frequency at transition of the phase joining point by the value 
of DTmod = TR /2:
	
DC
init
st
del
DC
init
DC
init
st
st
DC
init
2
{[ (
/2)]
(
0.5
)
2
sin[ (
)]}
{sin[ (
)]
sin[ (
)]}
del
R
u
u
R
st
R
u
t
b
F
d U
U
K T
K T
T
T
t
b
d U
U
d U
U
K T
T
d U
U
D
=
-
+
+
+
-
-
-
-
+
-
-
	
(5.26)
From here we obtain after transformations:
	
{
sin[
/
]
sin[
]
(1
)sin
}
R
Y
mod
Y
min
st
mod
Y
xb
F
K
D
dU
K
F
T
D
dU
K
D
D
=
+
D
-
+
-
-
	
(5.27)
where D = d(UDC – Uinit), KY = R/(R + dRst).
Now we can write the value of stepwise variation of measuring range:
	
max,osc
mod
Rst
min
mod
{
sin[
/
]
sin(
)
(1
)sin
}
Y
Y
Y
R
xb
K
D
dU
K
F
D
dU
K
D
δ
D
=
+
D
-
+
-
-
	
(5.28)
As we see from these equations, the measurement error depends rather compli-
cate upon the range, modulation parameters, and position of the operating point on 
the MC. The strongest influence is upon the character of the error function versus 
the range that the parameter d has. 

5.3  Effects of FM Nonlinearity for the Counting Method of Frequency Measurement	
145
For the quantitative estimation of possible error values, we transform (5.28) 
for limit values of the measured range. At small ranges when R ® dRst, substitut-
ing R = dRst in (5.28) and transforming the sum of two trigonometric functions, we 
obtain:
	
max,osc
st
DC
init
mod
mod
min
sin[ (
)][cos(
)
1]
Rst
R
R
R
b
d U
U
U
dU
F
δ
δ
=
D
=
-
+
-
D
	
(5.29)
At large ranges for R ® ¥, we can use a change of variables x = KY/(1 – KY), 
which follows from designations in (5.27), and from the L’Hospital rule to over-
come uncertainty, we obtain from (5.28) the maximal value of the relative oscillat-
ing error:
	
{
}
max,osc
2
mod
mod
mod
min
(
)
1sin[arctan(
)
]
sin
Rst
R
R
b
dU
dU
D
dU
D
F
δ
®¥
D
=
+
-
-
-
D
	
(5.30)
From (5.29) and (5.30), the conclusion is offered that by changing voltages UDC 
and Umod, we can minimize errors right up to zeroing. Nevertheless, this is not so 
as these voltages are included in (5.23) defining the value of DFmin inside the time 
interval Tst. Due to the fact that DFmin is fixed with the help of any external circuits, 
it is impossible to arbitrarily change simultaneously UDC and Umod. At variation of 
UDC from (5.23), we obtain the rigidly connected value of Umod.
Let us find maximal possible values of stepwise variations of measurement 
results. 
The maximal values of the error modulus can be found by sorting out the worst 
combinations of limit values of trigonometric functions included in (5.29) at a small 
range (R = dRst):
	
st
max,osc
st
min
2 /
R
R
R
R
b
F
δ
δ
=
D
£
D
	
(5.31)
and at a large range (R ® ¥):
	
2
max,osc
st
mod
min
1
(
)
1
R
R
R
b
dU
F
δ
®¥
é
ù
D
£
+
+
D
ë
û
	
(5.32)
These formulas allow the estimation of possible error values according to 
known MC parameters. 
It follows from these expressions that an increase of the FM sweep gives a seri-
ous positive effect at small ranges only. It is well seen in Figure 5.4, where the solid 
line shows the calculation results of the relative error function versus the FM sweep 
according to the accurate formula (5.29) for R/dRst = 1 and the dotted line shows 
the same results obtained according to (5.31).
Accurate calculation results strongly oscillate at the variation of the FM sweep; 
however, the modulus of the accurate error value does not exceed the approximated 
value determined according to (5.31) at any values of parameters. Both equations 
show the essential error variation at the changing of the frequency FM sweep.

146	
Effects of FM Nonlinearity
There is a multiplier in (5.32) for large ranges, whose value depends upon the 
product dUmod. This value is mainly proportional to the frequency FM sweep; 
therefore, it partially compensates the denominator influence of this formula. The 
degree of compensation depends on d. The effect of Umod is weak at small d only 
and, therefore, the measurement error decreases for large ranges with increasing of 
the FM sweep as it is shown in Figure 5.5 drawn for d = 0.3 rad/V.
Increasing d leads to a strengthening of the Umod effect and, hence, to a decrease 
of the FM sweep influence on the error. It can be seen in Figure 5.6, where functions 
similar to Figure 5.5 but at d = 5 rad/V are shown. Because dUmod can be much 
more than 1, at a large range and for large d, the error very weakly depends upon 
the FM sweep and aspires to the value:
	
max,osc
st
MC
min
/
/
/
R
R
R
bd K
b
F
δ
®¥
D
£
+
D
	
(5.33)
Figure 5.4  Plots of the function of normalized measurement error versus the frequency FM sweep 
for d = 5 rad/V, b = 1 MHz, Uinit = 0V, UDC = 5V, and DR/dRst = 1.
Figure 5.5  Plots of the function of the relative measurement error versus the frequency FM sweep 
for d = 0.3 rad/V, b = 1 MHz, Uinit = 0V, UDC = 5V, and DR/dRst = 200.

5.4  Effects of FM Nonlinearity	
147
that is, it is mainly defined by the MC parameters only because the second item is 
significantly less than the first one. Thus, in Figure 5.6, the variation of maximal 
error does not exceed of units of percent from its absolute value. 
5.3.3  The Quadratic Modulation Characteristics with the Oscillating 
Component 
This is the most general case. The performed analysis allows the recording in this 
case for the total measurement error as a sum of two considered components. In 
practice, the limit error value is more interesting. We can write it combining (5.22) 
and (5.33):
	
2
max
st
MC
min
MC
/
/
R
R
R
bd K
a
F
K
δ
®¥
D
£
+
D
	
(5.34)
Therefore, the presence of quadratic component leads simply to a displacement 
of the oscillating component plot upward or downward in accordance with a sign 
of quadratic item. All conclusions concerning the error behavior at the variation of 
modulation parameters and the MC remain true. 
5.4  Effects of FM Nonlinearity for the Weighting Method of Difference 
Frequency Averaging
The estimation of MC nonlinearity influence on the range measurement error is car-
ried out with the help of computer simulation at different types of MC nonlinearity. 
In the simplest case of a quadratic MC, the calculations show that for different WF 
the general view of error plots versus range is approximately the same and it looks 
like the curves presented in Figures 2.4.
Figure 5.7 shows the typical function of the relative error versus normalized 
range for algebraic WF at n = 1 and a = –2 MHz/V2. 
Figure 5.6  Plots of the function of the relative measurement error versus the frequency FM sweep 
for d = 5 rad/V, b = 1 MHz, Uinit = 0V, UDC = 5V, and DR/dR = 200.

148	
Effects of FM Nonlinearity
Quadratic nonlinearity leads to the fact that nodal points are eliminated from 
the error plots and the total error level increases, and therefore, the more n (the 
more complicated shape of the algebraic WF), the stronger the nonlinearity in-
fluence. The total function character remains the same (i.e., slow and fast error 
oscillations are observed). The fast oscillation period, as usual, is equal to a quarter-
wavelength of the carrying oscillation. The amplitude of these oscillations decreases 
monotonically with increasing range. Slow oscillations are expressed as weaker and 
for a significant nonlinearity increase they have disappeared. 
Figure 5.8 shows the function of the normalized error sD averaged according 
to (2.23) versus the normalized range at different coefficients of the quadratic non-
linearity for n = 1.
The increase of quadratic nonlinearity degree leads to increase of the total error 
level. The specific form of such plots is strongly varied at changing of the WF form. 
The strongest variations are observed for more complicated WF. 
Figure 5.7  Plots of the function of the normalized measurement error versus normalized range for 
n = 1 and a = 2 MHz/V2.
Figure 5.8  Plots of the function of the normalized average error at different coefficients of quadratic 
nonlinearity for n = 1.

Let us consider the influence of the oscillating process of the nonlinear MC for 
the simplest case: the presence of one harmonic only. The analysis of the formula 
(5.1) shows that MC slope variation in this case is defined by the product bd. There-
fore, the maximal slope is Smax = KMC + bd, and minimal slope is Smin = KMC – bd. 
Calculations show that the character of the error function versus range depends on 
WF shape and MC parameters d, b, and Uinit. The analysis of calculation results 
allows the following conclusions: 
As usual, two types of periodicity are observed to be connected with the 
• 
wavelength of the carrying oscillation and with QI value.
The linear trend rises, which has the slope value and the slope sign dependent 
• 
in a complicated manner upon the product bd and the initial phase of oscil-
lating component dUinit.
At the variation of initial phase, the trend slope varies within the limits from 
• 
some minimal negative value to the positive maximal value. 
Figure 5.9 shows typical functions of the relative range measurement error ver-
sus normalized range for n = 1, d = 1 rad/V, and b = 10 MHz and two extreme 
values of Uinit defining the extreme value of the linear trend.
If trend parameters are known, we can consider them at the range calculation. 
The functions of measurement error with eliminated trend remind the plot shown 
in Figure 5.7.
The linear trend slope depends on the MC parameters. The functions of slope 
versus Uinitd at different parameters b and d obtained with the help of simulation 
are presented in Figure 5.10. 
The dependence on the initial phase Uinitd has a sine shape. Functions versus b 
and d parameters are more complicated. The linear trend from the error plot can be 
Figure 5.9  Plots of the function of normalized range measurement versus normalized range for  
n = 1, d = 1 rad/V, b = 10 MHz, and two values of Uinit. 
5.4  Effects of FM Nonlinearity	
149

150	
Effects of FM Nonlinearity
easily eliminated by variation of the coefficient KWF , whose value depends upon the 
parameters of the MC oscillating component and the WF form.
After trend elimination, it turns out that the error oscillating component MSD 
depends weakly upon the MC nonlinearity parameters. It is well seen from plots 
presented in Figure 5.11.
Thus, the obtained results allow the conclusion about the possibility of result 
corrections of range measurement according to the known MC nonlinearity pa-
rameters. To solve this problem, it is necessary to determine the functional connec-
tion between MC nonlinearity parameters and the coefficient KWF , included in the 
calculation formula (2.5) for the correction of measurement results. Moreover, it is 
necessary to have the possibility of defining MC nonlinearity parameters according 
to the operating DFS to carry out the urgent correction of results.
Figure 5.10  Plots of slope coefficient of the linear trend versus initial phase of MC oscillating 
­component.
Figure 5.11  Plots of range measurement MSD versus amplitude of the MC oscillating component 
for dUinit = 1 and R/dR = 6.

5.5  Connection of the Correction Coefficient with Nonlinearity Parameters of the MC 	
151
5.5  Connection of the Correction Coefficient with Nonlinearity 
Parameters of the MC 
To obtain a connection of the coefficient KWF with nonlinearity parameters, it is 
necessary to calculate the integral from (2.4) having substituted in it the expression 
for WF in (2.9) and the equation for difference frequency in (1.10). We consider 
separately the case of quadratic MC nonlinearity and the oscillating nonlinearity.
5.5.1  Quadratic Nonlinearity of Modulation Characteristics
Taking into consideration (5.1), at the quadratic MC nonlinearity, the difference 
frequency from (1.10) is defined by the equation:
	
(
)
2
DFS
del
( )
2
U
U
F
t
t
kk
ak t
=
+
	
(5.35)
Then 
	
(
)
/2
2
del
MC
mod
0
0
1
2
cos 4
2
mod
T
K
W
m
U
U
m
S
K
t
A
m
K
k
ak t dt
T
π
=
æ
ö
=
+
ç
÷
è
ø
å
ò
	
(5.36)
After transformations and changing the variables, we obtain: 
	
mod
MC
del
0
0
2
2
mod
W
del
2
0
0
cos(2
)
4
cos (2
)
(2 )
K
W
U
m
m
k
m
U
m
T
S
K K
k t
A
mx dx
T
K
t
ak
A
x
x
mx dx
π
π
π
π
=
=
=
+
å
ò
å
ò
	
(5.37)
where x = 2p t/Tmod.
Using the table integral from [9], we obtain: 
	
2
2
mod
mod
MC
del
0
W del
0
2
W
U
U
T
S
T
K K
k t
A
K
t
ak A
=
+
	
(5.38)
Taking into account that kUTmod/2 = Umod, we can write:
	
(
)
2
del
mod
MC
del
mod
2
2
S
t
U
K
U
a
t
F
=
+
=
D 	
(5.39)
Thus, we see that at the quadratic MC nonlinearity the coefficient KW = 1, 
which coincides with simulation results described in the previous section. 
5.5.2  Oscillating Nonlinearity of the Modulation Characteristic
Taking into account (5.1), at the oscillating MC nonlinearity, the difference 
­frequency from (1.10) is defined by the equation:
	
de
MC
init
( )
{
cos[ (
)]}
DFS
l
U
U
U
F
t
t
K
k
bdk
d k t
U
=
+
+
	
(5.40)

152	
Effects of FM Nonlinearity
From here 
	
mod/2
W
del
MC
init
MO
0
0
2
2
cos 2
{
cos[ (
)]}
T
K
m
U
U
U
m
t
S
K
t
A
m
K
k
bdk
d k t
U
dt
T
π
=
æ
ö
=
+
+
ç
÷
è
ø
å
ò
Д
	 (5.41) 
After transformations and changing the variables, we obtain: 
	
mod
mod
W
MC
del
0
W del
init
init
0
0
0
[cos(
) cos(2
)cos(
)
sin(
) cos(2
)sin(
)
]
U
U
K
m
m
T
S
T
K
K
k t
A
K
t
bdk
A
dU
mx
vx dx
dU
mx
vx dx
π
π
π
=
=
+
´
-
å
ò
ò
	 (5.42)
where v = dkUTmod/(2p) and x is defined as in (5.37).
As a result of integration and simple transformations, we obtain: 
	
W
mod del
MC
0
init
mod
mod
2
2
mod
0
2
{sin[ (
)]
sin(
)}
(
)
(2
)
init
K
m
m
S
K U
t
K
A
bd
d U
U
dU
dU
A
dU
m
π
=
=
+
+
-
´
-
üïý
ïþ
üïý
ïþ
å
	
(5.43)
where Umod is the amplitude of saw-tooth voltage defined according to (5.4).
Taking into account (2.4), from (5.43) we can obtain that
	
mod
WF
MC
0
init
mod
mod
init
2
2
mod
0
{sin[ (
)]
sin(
)}
(
)
(2
)
W
K
m
m
K U
K
K
A
bd
d U
U
F
dU
dU
A
dU
m
π
=
=
+
+
D
-
´
-
üïý
ïþ
üïý
ïþ
å
	
(5.44)
In this case the coefficient KWF depends in a complex manner upon parameters 
of oscillating MC components and WF parameters. Calculations of this coefficient 
according to (5.44) with the parameters of the MC nonlinearity, which were used at 
simulation of DFS processing in Section 5.3, allows the construction of plots, as shown 
in Figure 5.10. This confirms the correctness of the obtained formulas and ­allows a 
conclusion about the practical possibility of the coefficient correction KWF included in 
(2.5) for measuring the range at the known parameters of the MC nonlinearity.
5.5.3  Quadratic and Oscillating Nonlinearity of the Modulation Characteristic
Repeating computations used at derivation of (5.39) and (5.44), we may obtain the 
following equation: 
	
W
mod
WF
0
MC
mod
mod
0
init
mod
init
2
2
mod
(
)
{sin[ (
)]
sin(
)}
(
)
(2
)
K
m
m
K U
K
A K
aU
F
A dU
bd
d U
U
dU
dU
m
π
=
=
+
D
+
+
-
-
ü
ïý
ïþ
ü
ïý
ïþ
å
	
(5.45)

5.6  Estimation of the Correction Coefficient	
153
From this we can see that in this case all parameters of the MC nonlinearity 
influence the value of KWF.
5.6  Estimation of the Correction Coefficient According to the 
Operating Difference-Frequency Signal
The time function of the difference frequency at presence in MC of quadratic and 
one oscillation component has a view:
	
{
}
2
DFS
del
MC
init
2
cos[ (
)]
U
U
U
U
F
t
K
k
ak t
bdk
d k t
U
=
+
+
+
	
(5.46)
This formula looks like (5.1) on its structure. The difference is that the qua-
dratic component is absent and the multiplication tdel defined by the measuring 
range is present. Therefore, we suggest using the algorithm of the MC parameter 
determination according to the measured time function of the difference frequency 
on the basis of the method described in Section 5.1. 
5.6.1  The Algorithm Sequence
The algorithm sequence is the following:
Step 1:
• 
 According to the measured DFS, the function of the difference fre-
quency period TDFS versus time is determined.
Step 2:
• 
 The translation of the period into the difference frequency FDFS = 
1/TDFS is provided.
Step 3:
• 
 According to the found function, on the basis of linear regression, 
with the help of the approximation on the least-square method [5], the param-
eters of the linear trend (dc component fDC and the slope coefficient kf) are 
obtained.
Step 4:
• 
 The parameters of linear and quadratic MC components are deter-
mined with the help of equating the appropriate items in (5.47) to the found 
parameters of the linear trend 
	
MC
DC
del
/(
)
U
K
f
t
k
=
	
(5.47)
	
2
del
/ 2
f
U
a
k
t
k
=
(
)	
(5.48)
Step 5:
• 
 The linear trend is subtracted from the obtained time function of the 
difference frequency.
Step 6:
• 
 The frequency F, the oscillation amplitude DFosc, and the phase j are 
determined from the obtained oscillating component of time function of dif-
ference frequency using the method described in Section 5.1.
Step 7:
• 
 MC oscillating component parameters are obtained according to the 
determined parameters:

154	
Effects of FM Nonlinearity
	
2
/ U
d
F k
π
=
	
(5.49)
	
osc
del
/(
)
U
b
F
dk t
= D
	
(5.50)
	
= ϕ +
p
init
(
0.5 )/
U
d	
(5.51)
The unknown parameter tdel is included in these formulas. Therefore, similar 
calculations can be performed only at the calibration of the device for range known 
in advance and use these parameters for the correction coefficient KWF included in 
(2.5).
However, a possibility to estimate the MC nonlinearity parameters and their 
consideration in the operating mode has a practical interest at each range measure-
ment. In this case the measuring range and, hence, tdel, is unknown. It is expedient 
to determine such a formula for the estimation of KWF, in which tdel is absent. The 
value of the FM sweep DF is included in the denominator of (5.45). Using (5.1), we 
connect the FM sweep with nonlinearity parameters:
	
2
MC
mod
mod
mod
init,
init,
1
{sin[
(
)]
sin(
)}
M
n
n
n
n
n
n
F
K
U
aU
b
d U
U
d U
=
D
=
+
+
+
-
å
	
(5.52)
Substituting this equation into (5.45) and using estimations (5.47) to (5.51) as 
the parameters of the MC nonlinearity, we can obtain the following formula for 
KWF, which in our case of the quadratic and one MC oscillating component has the 
view:
	
W
0
osc
2
2
0
WF
osc
(2
)
2
[sin(
)
sin ]
(2
)
(
)
2
[sin(
)
sin ]
N
m
n
f
m
n
f
A
K
F A
f
k
F F
F
F
m
K
F f
k
F
F
ϕ
ϕ
π
ϕ
ϕ
=
ì
ü
ï
ï
+
+
D
+
-
í
ý
-
ï
ï
î
þ
=
+
+
D
+
-
å
	
(5.53)
where 
mod/2
F
FT
=
, osc
osc
mod/2
f
f
T
=
, 
2
mod
(
/2)
f
f
k
k T
=
, 
osc
osc
mod/2
F
F
T
D
= D
 are nor-
malized estimations. This expression can be used for the correction of the results at 
each range measurement. 
The effectiveness of such a correction was checked with the help of simulation. 
Figure 5.12 shows the functions of the logarithm of averages error square ­versus 
normalized range for hypothetical case of completely known MC nonlinearity 
­parameters, that is, obtained using the accurate value of KWF, calculated according 
to (5.46), and the noncorrected results. 
5.6.2  Simulation Conditions
The simulation conditions are the following:
The MC nonlinearity parameters 
1.	
KMC = 70 MHz/V; a = 2 MHz/V2, b = 2 
MHz, d = 2 rad/V, Uinit = 3 V;
WF (2.19) for 
2.	
n = 1, 2, and 4;
MC parameter estimation and calculation of 
3.	
KWF according to (5.53) were 
provided at each measurement.

5.7  Compensation of Modulation Characteristic Nonlinearity	
155
We see that for each WF there is a minimal range beginning from when it is 
expedient to provide a correction. At a large range, the error decreases from units 
to tens of units depending on the WF type and the achieved error corresponds to 
the requirement for this equipment.
5.7  Compensation of Modulation Characteristic Nonlinearity
Let us show a possibility for adaptive linearization of the MC of the SHF oscilla-
tor for FMCW RF on the basis of parameter analysis of received signals [10] and 
determine the quantitative estimation of linearization quality. This can be done by 
relying on the fact that we are discussing the measurement of small ranges, when 
the signal delay tdel is a negligible quantity compared with the modulation period 
Tmod. Using (1.8), we can write the difference signal phase jdif(t) at the output of 
the FMCW RF mixer in the form:
	
dif
0 del
del
( )
2
2
( )
t
f t
f t t
ϕ
π
π
=
+
	
(5.54)
Thus, there is the function of frequency variation of the oscillator in the phase of 
the difference signal. Therefore, analyzing the difference signal, we can reveal devia-
tions of the practical function of the frequency variation from the required function. 
After that, we can calculate the correcting voltage ucorr(t) according to this deviation, 
which changes in such a manner to compensate unwanted variations and to provide 
correction of modulating voltage umod(t), adding the correcting value to this.
Let us present the MC of the oscillator as a sum of linear fl(u) and nonlinear 
fnl(u) parts:
	
nl
MC
nl
( )
( )
( )
( )
l
f u
f u
f
u
K
u
f
u
=
+
=
+
	
(5.55)
According to this, the modulating voltage can be presented as:
	
mod
corr
corr
( )
( )
( )
( )
l
u
u
t
u t
u
t
K t
u
t
=
+
=
+
	
(5.56)
Figure 5.12  Plots of the logarithm of the average error square versus normalized range. The dotted 
line is the noncorrected error, and the solid line is the corrected error.

156	
Effects of FM Nonlinearity
where Ku = 2Umod/Tmod is the slope of linear part increase of the modulating volt-
age and Umod is the amplitude of modulating voltage.
Equation (5.55) can be rewritten in the form [10–12] taking into consideration 
(5.56):
	
[
]
MC corr
nl
nl
corr
MC
( )
( )
( )
( )
( )
( )
l
f u
K
u
t
f
u
f
u u
t
K
u t
=
+
+
+
¢
	
(5.57)
In this equation the nonlinear MC part is presented in the form of first expan-
sion items in a series in vicinity the point u(t). To change the frequency linearly, it 
is necessary that the expression in the square brackets of (5.57) would be equal to 
zero. From this we obtain:
	
corr
nl
MC
nl
( )
( )/
( )
u
t
f
u K
f
u
= -
+ ¢
	
(5.58)
Taking (1.10) into account, we can present the instantaneous period of the 
­difference signal TDFS(t) using the similar expansion in a series as:
	
[
]
[
]
DFS
DFS
nl
del
,
DFS
2
del
del
1
1
( )
( )
( )
( )
1
( )
( )
( )
( )
l
nl
l
l
l
T
t
F
t
f t
f
t t
f
t
T
T
t
f t t
f t
t
=
=
+
¢
¢
¢
»
-
=
+ D
¢
¢
DFS
	
(5.59)
where TDFS,l is the period of DFS caused by the linear MC part, DTDFS(t) is the DFS 
variation caused by the nonlinearity of the modulation characteristics.
Using (5.55) and (5.56), we can rewrite (5.59) as:
	
nl
DFS
2
2
2
MC
del
del
MC
1
1
( )
u
u
df
T
t
dt
K
K t
K
K t
=
-
	
(5.60)
From (5.59) and (5.60), we can obtain:
	
nl
2
2
nl
DFS
del
MC
( )
( )
u
df
f
t
T
t K
K t
dt =
= -D
¢
	
(5.61)
From this we have:
	
2
2
nl
del
DFS
MC
0
( )
( )
t
u
f
t
K
K t
T
t dt
= -
D
ò
	
(5.62)
We should note the voltage derivative of the nonlinear MC part is included in 
(5.57), and the time derivative is included in (5.61). Replacing approximately the 
modulation voltage derivative by the constant quantity equal to the average slope 
Ku, we obtain:
	
2
nl
del
DFS
MC
( )
( )
u
f
t
K
K t
T
t
= -
D
¢
	
(5.63)
Having substituted (5.61) and (5.63) in (5.57), we obtain:
	
2
MC
del
DFS
0
corr
MC
del
DFS
( )
( )
1
( )
t
u
u
K
K t
T
t dt
u
t
K
K t
T
t
D
=
-
D
ò
	
(5.64)

5.7  Compensation of Modulation Characteristic Nonlinearity	
157
It follows from this equation that to form the correcting voltage it is necessary 
to know the wanted averaged MC slope, the average slope of modulating voltage 
increase, and the measuring range. The necessity of the current range consideration 
complicates this procedure; however, we can eliminate it if introducing the nor-
malized value of irregularity of the difference frequency period h(t), which can be 
rewritten from (5.58) and (5.59) as:
	
DFS
DFS,
MC
del
DFS
( )
( )/
( )
l
u
t
T
t T
K
K t
T
t
η
= D
=
D
	
(5.65)
In this case, (5.64) can be simplified:
	
0
corr
( )
( )
1
( )
t
u
K
t dt
u
t
t
η
η
=
-
ò
	
(5.66)
The quantity h(t) is less than 1 and for small values of irregularity we can neglect 
the second item in the denominator of (5.66). These equations are approximate due 
to accepted assumptions. Due to this reason, it is impossible to compensate the MC 
nonlinearity by the one-pass calculation of ucorr(t).
The procedure of modulating voltage formation is recurrent and is performed 
by several iterations. During an irregularity decrease of the difference signal peri-
ods, the accuracy of (5.66) increases. Therefore, the minimum search of the follow-
ing functional is provided:
	
max[ ( )]
S
t
η
=
	
(5.67)
at the limitations DF = const, Tmod = const and for formation of modulating voltage 
as:
	
mod,
corr,
( )
( )
( )
k
l
k
u
t
u t
au
t
=
+
	
(5.68)
where ul(t) = UDC + Kut, ucorr,k(t) = ucorr,(k–1)(t) + Ducorr,k(t) is the correcting voltage­ 
obtained at the kth iteration, ucorr,(k–1)(t) is the correcting voltage obtained at k – 1 – 
th iteration, Ducorr,k(t) is an increment of the correcting voltage calculated according 
to (5.66) on the kth stage, and a = 0…1 is the smallness parameter. 
The practical implementation of this procedure assumes microprocessor ap-
plication in the processing equipment and has some peculiarities. In particular, at 
the experimental determination of the function TDFS(t), the discrete function TDFS,i 
is determined by the measurement of current time intervals between adjacent DFS 
zeroes Tzero,i:
	
DFS,
zero,
zero,
1
i
i
i
T
T
T
-
=
-
	
(5.69)
is the duration of the ith instantaneous DFS period.
Owing to the fact that the DFS frequency is changing continuously, discrete 
samples TDFS,i represent some average quantity. Therefore, these samples and, 
hence, samples of correcting voltage ucorr,i are reasonable to correlate with the cor-
rection moments Tcorr,i located in the middle of the appropriate interval between 
two zeroes:

158	
Effects of FM Nonlinearity
	
corr,
zero,
zero,
1
[
]/2
i
i
i
T
T
T
-
=
+
	
(5.70)
Here Tcorr,i is a time moment, at which calculation of the correcting voltage is 
performed. 
It is advisable to provide the modulation in such a manner that beyond the 
limits of time interval interesting for us that we call the analysis interval Tan the 
two DFS zeros minimum would be formed. It is necessary for the fact that ­beyond 
the limits of the analysis interval the one correction point at least will be formed 
reliably from each side. Therefore, the FM sweep of the SHF oscillator becomes 
more than the required FM sweep DF; however, we suppose that inside the analy-
sis interval the FM sweep is provided by the value DF. At the origin of time 
reckoning, we attach to the beginning of this interval, which can be done using 
frequency marks formed with the help of dielectric resonators [13]. As a result, 
the discrete function (5.69) contains N DFS zeros:
	
4
int
4
FR
N
c
D
æ
ö
=
+
ç
÷
è
ø
	
(5.71)
At the maximal range, N can achieve the values of 200 to 300.
For each new kth iteration, the position of ith correction point Tcorr,k,i on the 
time axis may differ from the ith point Tcorr,k–1,i obtained on the previous (k – 1), 
the iteration as the modulation voltage variation occurs. Therefore, beginning from 
the second iteration, it is necessary to provide translation of the correcting voltage 
from points of the previous step to points of the current step using the interpolation 
and extrapolation formulas:
The total correcting voltage can be obtained by summation in new time points 
of correction Tcorr,k,i of old and new values:
	
corr,
corr, ,
corr,(
1)
corr,(
1),
corr,
corr, ,
(
)
(
)
(
)
k
k i
k
k
i
k
k i
u
T
u
T
u
T
-
-
=
+ D

	
(5.72)
where Ducorr,k(Tcorr,k,i) is the correcting voltage on kth iteration calculated accord-
ing (5.66), which can be written in the discrete form:
	
DFS,
1
corr,
1
N
u
i
i
i
i
i
K
T
u
η
η
=
D
=
-
å
	
(5.73)
where hi = (TDFS,i – TDFS,aver)/TDFS,aver and 
,
DFS,
1
/
N
DFS aver
i
i
T
T
N
=
= å
.
After similar translation at each iteration, it is necessary to provide variation 
of correcting voltage in such a manner to remain the boundary tuning frequencies 
of SHF oscillator. These values of modulating voltage should remain unchanged 
in extreme points of the modulation interval. Variation is provided with the help 
of elimination of the constant value ucorr,k(0) from the correcting voltage, which is 
equal to the value and further multiplication of the voltage [calculated according to 
(5.68)] by the correcting coefficient:

5.7  Compensation of Modulation Characteristic Nonlinearity	
159
	
corr
span
span
corr,
span
/[
(
)]
k
K
U
U
u
T
=
+
	
(5.74)
Here Uspan is the span of the linear part of modulation voltage in time interval 
Tspan. 
The formation of the transmitted signal is already provided according to the 
new modulation voltage. Therefore, the generation of this voltage is carried out by 
the digital approach using a digital-analog converter on the basis of interpolation 
formulas. 
The correction process may be not driven to obtain the accurate minimum of 
(5.67). It can be interrupted at the irregularity reduction of difference signal periods 
to the accepted value, which is defined by a sensitivity level to the residual non­
linearity of the chosen method of DFS processing. The iteration process of modulat-
ing voltage calculation can be presented as the following algorithm. 
The Correction Algorithm
The correction algorithm is as follows:
Step 1:
• 
 The linear modulating voltage is formed on the basis of (5.3). The 
modulating voltage amplitude is chosen in such a manner to form two zeros 
at each of side beyond the limits of time interval of DFS analysis Tan. Then 
the correcting voltage is equal to zero.
Step 2:
• 
 Based on the received signal, zeros Tzero,i of DFS are determined.
Step 3:
• 
 Correction points are calculated according to (5.70) and DFS periods 
based on (5.69).
Step 4:
• 
 Increments of correcting voltage are calculated according to (5.73).
Step 5:
• 
 Using the interpolation and extrapolation formulas, the translation 
of the earlier calculated correcting voltage to the new correction points is 
performed. 
Step 6:
• 
 The correction of modulating voltage is provided to keep the un-
changed FM sweep using the correction coefficient (5.74).
Step 7:
• 
 The maximal absolute value of relative irregularity hmax is determined 
and is compared with the threshold value hthr. If hmax > hthr , the return to 
Step 2 is performed, and repeat of all steps until the reverse relation would 
be ensured. 
As time goes by, MC nonlinearity can change, for instance, due to the variation 
of the environment. That is why it is expedient to perform regularly the new correc-
tion of nonlinearity using the current results of range measurement. Nevertheless, 
such a correction should be performed in the case only when there are a sufficient 
number of discrete points (not less than 10) in the estimating function TDFS(t). It is 
advisable that this procedure would be possible at any measured range inside the 
operating range of FMCW RF. With this purpose, it is necessary to choose the FM 
sweep in such a manner that at the least range during the modulation period, the 
necessary number of periods of DFS would be realized. 
The effectiveness of such compensation and opportunities of its practical 
­application was checked with the help of simulation of the range measurement 

160	
Effects of FM Nonlinearity
process with achieved irregularity levels and of comparison with results obtained 
without compensation for the same values of MC nonlinearity parameters. Simula-
tion was performed at KMC = 70 MHz/V for three WFs, which were used earlier. 
The calculation of the compensating voltage was provided at the same range and 
samples of this voltage were stored. Then range measurement was simulated in the 
range from 4 to 23 discrete errors with the 1-mm step. At that simulation, gen-
eration of modulating voltage and, relatively, DFS was carried out using obtained 
samples of the correcting voltage. As a result of simulation, it is determined that for 
purely quadratic nonlinearity it is inexpedient to perform compensation because, 
as a result of this, instead of the smooth nonlinearity, the chaotic nonlinearity of 
the correcting voltage arises with some small level with the large frequency leading 
to an error increase.
In the worst case of the quadratic and oscillating nonlinearity presence, the 
benefit about two orders remains when using compensation, as we see from Figure 
5.13. Therefore, there is a relative range, which is individual for different WFs, and 
if the range is less, the benefit will not be ensured. 
A two-times increase of the FM sweep leads to a reduction of the total error 
level by four times. 
Thus, the performed calculations prove the high effectiveness of the suggested 
algorithm of MC nonlinearity compensation.
5.8  Consideration of Modulation Characteristic Nonlinearity at Range 
Calculation
The consideration of the MC nonlinearity at calculation of range is possible by 
a means of measurement of appearance moments of DFS typical points inside of 
the modulation period. For this purpose, the additional formation of two pulse 
Figure 5.13  Plots of the logarithm of rms error versus the normalized range for nonlinearity com-
pensation (round marks) and without compensation (cross-shaped marks) for b = 10 MHz and a = 
2 MHz/V2.

5.8  Consideration of MC Nonlinearity at Range Calculation	
161
signals (frequency marks) were provided in coinciding moments of the transmit-
ted signal frequency with the lower Fst1 and upper Fst2 reference frequencies and 
measurement of its appropriate position tst1 and tst1. Reference frequencies can be 
specified, for instance, with the help of high-Q dielectric resonators [13]. Control by 
modulating voltage is provided in such a manner to form one typical point beyond 
the analysis interval, which is equal to Tan = tst2 – tst1. Two variants of processing 
these measurement results are possible [11, 12].
5.8.1  Estimation of Extreme Period Parts
The first variant of the MC nonlinearity consideration at range calculation can be 
suggested based on the method described in [14], where range is calculated accord-
ing to the formula:
	
(
)
2
c
R
k
x
F
=
+
D
	
(5.75)
where k is a number of integer DFS periods inside the analysis interval and x is an 
additional amendment that is a reminder of the DFS half-period.
In contrast to [14], a sum of the integer number of DFS half-periods and the 
additional amendment will be calculated as [11, 12]:
	
cal,
WF
an
0
2
2
k
j
j
t
k
x
α
K
T
π
=
æ
ö
+
=
ç
÷
è
ø
å
	
(5.76)
where tcal,j = (j + 1 – x1)Taver is calculated at the jth moment of DFS typical point ap-
pearance with the averaged period Taver counting from the beginning of the analysis 
interval, 
an
aver
1
2
T
T
k
x
x
=
-
+
 is the average DFS period, Tan = tst2 – tst1 is the duration 
of the analysis interval, x1 and x2 are normalized positions of extreme points of the 
analysis interval with respect to left boundaries of the appropriate DFS half-periods, 
and KWF is the constant coefficient depending on the type of weighting function. 
Let us designate through t0, t1, …, tN and tN+1 the measured positions of typi-
cal points assuming that tst1 is located between t0 and t1, and tst2 is between tN and 
tN+1. Using these designations, the normalized positions of the boundary points x1 
and x2 can be calculated according to the values of tst1 and tst2 in different ways: 
Linear extrapolation with the application of two typical point positions 
1.	
nearest to the lower and upper frequency marks used in [15];
Linear interpolation with the application of two typical point positions, 
2.	
between which the upper and lower marks are located;
Quadratic interpolation with the application of three typical point positions, 
3.	
between which the upper and lower marks are located;
Cubic spline interpolation.
4.	
A comparison of these variants was carried out using numerical simulation. The 
FM sweep of 500 MHz and KMC = 70 MHz/V are used for simulation. Typical plots 
are presented in Figure 5.14. 

162	
Effects of FM Nonlinearity
We can note that for all variants of phase amendment calculation the absolute 
error level decreases at range grows. The worst results are achieved at application of 
the linear extrapolation of these amendments. The total error level ensured by each 
variant of phase amendment calculation may be changed by the order at the varia-
tion of nonlinearity parameters. The cubic spline interpolation method is strongly 
sensitive to nonlinearity parameters; however, it ensures on average the best result. 
The variant of quadratic interpolation has the less sensitivity and the linear inter-
polation has insignificant yields. 
In the most cases, WF shape complication leads to error decrease. The degree of 
decrease oscillates from two to three to 10 to 15 times depending on the variant of 
phase amendment calculation and the sign of the parameter of quadratic nonlinear-
ity. Most improvement is achieved at the spline interpolation and the positive values 
of the quadratic nonlinearity parameter. 
Thus, the considered approach allows the consideration of the MC nonlinear-
ity without the essential complication of FMCW RF structure at range calculation 
based on measurement results of DFS typical points position inside the modulation 
period. 
5.8.2  Approximation of the Time Function of Signal Periods
In this variant, we consider that at fixed measured range and any external condi-
tions the transmitter is tuned on the same frequency value Dfm [11, 12] during time-
keeping within any adjacent typical points of the beating signal. It can be explained 
by the fact that DFS phase increment DF is equal to p at transition from the one 
typical point to another (adjacent), that is, through one half-period, and for transi-
tion through m half-periods:
	
del
1 del
2
2
m
f t
m f t
m
π
π
π
DF =
D
=
D
=
	
(5.77)
Figure 5.14  The plot of the logarithm of normalized rms error versus normalized range for different 
variants of calculation of phase amendments for b = 1 MHz, a = –1.5 MHz/V2, and for various WFs 
(solid curve n= 4, dotted curve n= 1).

5.8  Consideration of MC Nonlinearity at Range Calculation	
163
From this we obtain the calculation formulas for the measuring range:
	
4
m
vm
R
f
=
D
	
(5.78)
where v is the speed of electromagnetic wave propagation under monitored 
­surface.
To calculate Dfm based on DFS, we can use the approximation of the time func-
tion of the transmitted signal by some function. The solution in the final form that 
we may obtain if we use the polynomial of n order is used for F(t) approximation:
	
0
n
i
i
i
F
a t
=
= å
	
(5.79)
where n + 1 is a number of typical DFS points inside the modulation period used at 
the calculation and ai are constant coefficients. 
Using the measurement results of the function of appearance moments ti of 
typical DFS points versus time and time positions tst1 and tst2 of two pulse signals 
obtained in the coincidence moments of reference and radiated frequencies, we can 
form the system of three linear equations with respect to n + 1th unknown coef-
ficients ai, the frequency of appearance of the first typical point F1 of DFS, and the 
FM sweep Df1 between two adjacent typical DFS points. 
In the matrix form this system has the form:
	
1
1
2
2
3
3
0
0
1
1
1
2
0
1
3
2
1
st1
1
st2
B
2
1
0
1
0
1
1
0
1
1
0
0
1
1
0
1
1
0
0
1
0
0
1
n
n
n
n
m
m
n
m
m
n
m
m
n
n
n
m
m
n
n
H
st
n
n
st
t
t
F
m
t
t
f
m
t
t
a
a
m
t
t
a
m
t
t
a
F
t
t
a
F
t
t
-
-
-
-
-
-
-
-
D
-
-
-
-
-
-
´
=
-
-
-
…
…
…
…
…
…
…
…
…
…
	
(5.80)
where m1,m2,…mn are numbers of typical points used at calculation. 
From this system we have:
	
1,2 st1
,2 st2
1
n
n
A
F
A
F
f
-
+
D
=
D
	
(5.81)
where D is the determinant of the coefficient matrix (5.80) and Ai,j is appropriate 
algebraic complement. 
To form the equation system and to find the FM sweep Df1, any typical points 
from the measurement can be used. With measuring range increasing, beginning 
from minimal amount possible, a number of typical points increase continu-
ously from the minimal value equal to 2. If, therefore, we consider in (5.80) all 
typical points, the equation system dimension also increases continuously. It is clear 

164	
Effects of FM Nonlinearity
that the range measurement accuracy should increase as well. Nevertheless, simula-
tion results show that the quadratic matrix included in (5.80) with the increasing 
dimension becomes ill-conditioned. Therefore, it is advisable to limit the dimension 
of this matrix by the value, at which this property is not noticeable. The simulation 
shows that the number of considered successively located typical points, at which 
the reliable solution of (5.80) is still possible, is equal to 14. This corresponds to the 
matrix dimension equal to 16. At a further range, increasing the matrix dimension 
is expedient to remaining unchanged. 
Figure 5.15 shows the function of the logarithm of the normalized MSD versus 
the normalized range at the matrix dimension, which does not exceed 14, obtained by 
simulation of the measurement process based on solution the equation system (5.80). 
At the simulation we used the FM sweep of 500 MHz. Therefore, we assumed the 
following nonlinearity parameters: KMC = 70 MHz/V, b = 10 MHz, d = 1 rad/V, and 
Uinit = 0 V. The value of a was varied. The system solution in (5.103) is provided with 
the help of the standard function within the MATLAB system. We see that with the 
range increasing, the error decreases monotonically at any nonlinearity parameters. 
In a practical realization, the matrix dimension can be limited by the value 10 to 
accelerate calculations. The error level, which can be achieved reliably, corresponds 
to the requirements typical for devices of this type. 
5.9  Conclusions
The offered MC model and the method of its parameter determination according 
to experimental signals allow a performance of the analysis of the MC nonlinearity 
influence on the range measurement results. 
On the basis of this model, formulas are obtained for estimation of the maximal 
error of the range measurement by means of the counting measurement method 
Figure 5.15  Functions of the logarithm of normalized rms error versus normalized range at the 
matrix dimension not exceeding 14.

5.9  Conclusions	
165
caused by MC nonlinearity. It is shown that the FM sweep has a serious effect on 
small ranges only. At the measuring range, increasing the error level is determined 
completely by the MC parameters. 
Three variants of the error level reduction are offered and are caused by the 
MC nonlinearity influence. All variants are based on the analysis of nonlinearity 
degree on instantaneous periods of operating DFS and they perform directly during 
the measurement. 
The compensation of nonlinearity influence by means of variation of the scal-
ing coefficient consists of the determination of the MC nonlinearity parameters, 
calculation of the coefficient, and computation of the range using this coefficient. 
Such a calculation can be carried out sufficiently through some time intervals, dur-
ing which the nonlinearity degree does not change essentially, for example, at each 
FMCW RF activation or at a significant change of environment temperature be-
cause the nonlinearity degree changes at temperature variation. 
The method of the MC nonlinearity compensation according to estimation of ir-
regularity degree of DFS periods allows a reliable reduction of the range measurement 
error up to the accepted value. It consists of the determination of predistortions intro-
duced in the modulating voltage, storing these predistortions in the device memory, 
and the performance of measurement, taking into account these values. The periodic-
ity of the compensating voltage upgrade is the same as in the previous point. 
The consideration of the MC nonlinearity based on the position of the 
­extreme or all typical points at the range calculation should be carried out for each 
­measurement. 
References
[1]	 Levin, O. A., V. N. Malinovskiy, and S. K. Romanov, Frequency Synthesizers with the Sys-
tem of Pulse PLL, Moscow: Radio i Sviaz Publ., 1989, 232 pp. [in Russian.]
[2]	 Sventkovskiy, R. A., “Super-Resolution of Signals: Possibilities, Restrictions, Non-
Autoregression­ Approach,” Radiotekhnika i Electronika, Vol. 43, No. 3, 1998, 
pp. 288–292. [in Russian.]
[3]	 Baranov, I. V., and V. V. Ezerskiy, “Digital Spectral Analysis of the Polyharmonic Signal,” 
Proceedings of 10th Intern. Conf. “Digital Signal Processing and Its Applications” (DSPA-
2008), 2008, pp. 500–502. [in Russian.]
[4]	 Baranov, I. V., V. V. Ezerskiy, and A. Y. Kaminskii, “Measurement of the Thickness of Ice 
by Means of a Frequency-Modulated Radiometer,” Measurement Techniques, Vol. 51, No. 
7, 2008, pp. 726–733.
[5]	 Korn, G., and T. Korn, Mathematical Handbook for Scientists and Engineers, New York, 
Toronto, London: McGraw Hill Book Company, 1961.
[6]	 HYPERLINK “http://link.springer.com/search?facet-author=%22S.+A.+Labutin%22” Labutin,­ 
S. A., HYPERLINK “http://link.springer.com/search?facet-author=%22M.+V.+​Pugin%22” 
Pugin, M. V. HYPERLINK http://link.springer.com/article/10.1007/BF02503928” Noise Im-
munity and Speed of Frequency Measurements of Short Harmonic Signals, ­Measurement Tech-
niques, Vol. 41, No. 9, 1998, pp. 837–841.
[7]	 Ezerskiy, V. V., B. V. Kagalenko, and V. A. Bolonin, “Adaptive Frequency-Modulated Level 
Meter. An Analysis of Measurement Error Components,” Sensors and Systems, No. 7, 
2002, p. 44. [in Russian.]

166	
Effects of FM Nonlinearity
[8]	 Vinitskiy, A. S., Essay on Radar Fundamentals for Continuous-Wave Radiation, Moscow: 
Sovetskoe Radio Publ., 1961, 495 pp. [in Russian.] 
[9]	 Gradstein, I. S., and I. M. Ryzhik, Tables of Integrals, Sums, Series and Products, New 
York: Academic Press, 1965.
[10]	 Ezerskiy, V. V., I. V. Bolonin, and I. V. Baranov, “The Algorithm of Modulation Character-
istic Non-Linearity Compensation for FMCW Range Finders,” Vestnik RGRTA, ­Ryazan, 
No. 10, 2002, pp. 38–42. [in Russian.] 
[11]	 Patent 2234716 (Russian Federation), INT. CL. G01 S 13/34. Method of Transmitted 
FMCW Signal Generation for the Range Finder with Periodic Frequency Modulation. / 
B. A. Atayants, I. V. Baranov, V. A. Bolonin, V. M. Davydochkin, V. V. Ezerskiy, B. V. 
Kagalenko, V. A. Pronin. No 2003105992/09; Filed 04.03.2003; Published 20.08.2004, 
Bull. 23.
[12]	 Atayants, B. A., V. V. Ezerskiy, V. A. Bolonin, I. V. Baranov, V. M. Davydochkin, and 
V. A. Pronin, “Influence of Modulation Characteristic Non-Linearity of the Transmitter 
on Distance Measurement in Short-Range Radar,” Information-Measurement and Control 
Systems, Vol. 1, No. 2–3, 2003, pp. 50–56.
[13]	 Ezerskiy, V. V., “Problems of Optimization of Modulation Voltage Control for FMCW 
Range Finder,” Vestnik RGRTA, No. 12, 2003, pp. 44–49. [in Russian.] 
[14]	 Marfin, V. P., V. I. Kuznetsov, and F. Z. Rosenfeld, “SHF Level-Meter,” Pribory i Sistemy 
Upravlenia, No. 11, 1979, pp. 28–29. [in Russian.] 
[15]	 Komarov, I. V., and S. M. Smolskiy, Fundamentals of Short-Range FMCW Radar. ­Norwood, 
MA: Artech House Publishers, 2003, 289 pp.

167
c h a p t e r  6
Analysis of the Range Measurement Error 
at the Interference Presence
6.1  Introduction
We will consider as clutter any signal distorting the results of useful signal process-
ing, which carries information about range to the UR, which must be measured. 
The influence of clutter signals formed by spurious reflections (SR) of any kind is 
the significant factor restricting the accuracy of range measurement. The reasons for 
these signals’ appearance may be the presence of physical SRs in the operation zone 
of the FMCW RF as well as other factors. When the FMCW RF is used as a level-
meter, the typical SRs are reflections from the construction elements, its sidewalls, 
the bottom, and multiple reflections between the surface of transmitted liquid in 
the reservoir and its roof. Hence, a variety of electric physical properties of target 
materials, constructive reservoir implementation, and measuring ranges lead to the 
fact that the useful signal amplitude can be both larger and smaller than amplitudes 
of numerous interferences. A significant excess of clutter amplitude over useful sig-
nal amplitude is observed at the probe on the nondeep layer of radio-transparent 
and weakly reflecting liquid on the background of interference from the reservoir 
bottom. 
For example, Figure 6.1 shows the amplitude spectrum of DFS obtained at 
the level measuring of the strongly reflecting plane surface (metal, water) for the 
level-meter mounted on the reservoir with the plane metal roof. In this case, the 
normalized frequency of the useful DFS component is 35. From this spectrum, we 
see that useful SC is rounded by various SCs with different frequencies, which have 
amplitudes both lesser and larger than the useful SC amplitude. Moreover, all SCs 
are saturated by items not resolved in frequency. The presented signal spectrum 
gives a presentation about the complexity of the problem of ensuring the low error 
of the range estimation. 
We note that restricted reservoir sizes lead to two additional specific compo-
nents of the error. At large vertically standing reservoirs, the mounting places of 
industrial automation devices usually locate near the vertical wall of the reservoir. 
In this case, the intensive interference arises due to waves radiated and received by 
the antenna in the direction of the angle formed by the vertical reservoir wall and 
the liquid surface. The second SCs are caused by edge modes due to the restricted 
sizes of the probing surface. Difference frequencies of both SCs practically coincide 
and cannot be resolved with the difference frequency of the useful signal. Difference 
frequencies of these interferences vary synchronously with the difference frequency 
of the useful signal. 

168	
Analysis of the Range Measurement Error at the Interference Presence
At insufficiently deep isolation of transmitting and receiving channels, the echo 
signal may create the frequency-dependent influence on the operating mode of the 
probe signal oscillator to cause the parasitic frequency modulation and, as a conse-
quence, the measurement error. This influence should be connected with peculiari-
ties of probing oscillator construction for elimination or reduction of the mentioned 
component of the measurement error down to accepted level. 
One of the significant sources of the error is the transmitted signal reflection 
from numerous irregularities of the antenna-waveguide path (AWP). Constructive 
features of AWP are unavoidable due to necessity of its hermetic encapsulation. The 
reflection from AWP constructive elements always exists due to the impossibility 
of matching provision in the wide frequency band, and it creates interference with 
rather stable parameters. Nevertheless, after a time, the material of the probing me-
dium and the water condensate deposits on the antenna and on AWP encapsulation 
elements, which usually leads to degradation of the matching level achieved earlier 
and to the appearance of new various combinational interference in the FMCW 
RF mixer. 
The appearance of resonant reflections is possible in AWP caused by excitation 
of high types of waves and leading to a rise in clutter of the pulse character in DFS. 
The need for AWP encapsulation predetermines preferable application of wave-
guide paths with circular waveguides of variable sections, which often are subject 
to an increase of higher types of waves at parameter variations of encapsulating 
dielectric inserts due to deposition of evaporation products during operation. 
For example, Figure 6.2 shows the DFS plot obtained from the level-meter, in 
which the dew appears on the encapsulated dielectric insert.
From this figure we see that useful DFS component (sinusoidal with high fre-
quency) is received on the background of pulse and quasi-sinusoidal (slowly chang-
ing) interference due to reflections from AWP elements and is distorted by PAM, 
which usually accompanies the generated FMCW signal. PAM may appear as well 
due to frequency-dependent reflections from both the useful product and SR. In the 
latter case, functions characterizing PAM will be different for various objects. 
Figure 6.1  A typical DFS spectrum for a level-meter mounted on a reservoir with a plane metal 
roof.

6.1  Introduction	
169
A variety of elements used in construction of a reservoir create a variety of scat-
tered electromagnetic waves (EMW) and DFS components. Mathematical models 
of scattered EMW are obtained with a sufficient degree of conformity to real EMWs 
for some simple geometrical shapes only (for example, a sphere, a disk, or a dipole). 
At the same time, many regularities of the SR influence can be adequately described 
under assumption of delay time tdel,i independence upon the transmitted signal fre-
quency. Such assumption allows application for analysis the signal model in the 
form of a sum of useful and spurious components with PAM: 
	
res
us
del,us
us
del,
1
( )cos[ ( )
( )]
( )cos[ ( )
( )]
( )
M
i
i
i
i
u
U
t
t t
t
U t
t t
t
t
ω
ϕ
ω
ϕ
ξ
=
=
-
+
-
+
å
	
(6.1)
where M is the interference number created by SR with mentioned properties, the 
index “us” is the useful reflector, Ui(t) is the function characterizing PAM of the 
appropriate partial DFS, and x(t) is the white normal noise. 
In particular, the time function of amplitude Ui(t) of the ith SC can be described 
in the form of a pulse with arbitrary duration Tp arising in the moment tp, Ui(t) ¹ 0 
for tp £ t £ tp + Tp and Ui(t) = 0 for t < tp, t > tp + Tp. In this case the carrier fre-
quency of radio pulse Ui(t) cos [w(t)tdel,i – ji(t)] is defined by electrical range to the 
ith source of reflection, and a phase is defined by frequency-dependent of the reflec-
tion coefficient. 
This list does not cover all types of clutter, which affect the FMCW RF error; 
however, it shows the necessity of a DFS processing method search, which has suf-
ficient resolving capability and allows estimation of potential opportunities of both 
traditional and original methods of difference frequency estimation. 
The spectrum of any signal has a variety of damping SLs in the frequency 
domain. They superimpose on the main lobe of UR spectrum, distort its shape 
and maximum position, and, under definite conditions, may completely mask it. 
Figure 6.2  DFS with pulse and quasi-sinusoidal interference caused by a reflection from AWP  
elements.

170	
Analysis of the Range Measurement Error at the Interference Presence
Therefore, any method of frequency estimation leads to an increase in additional 
­measurement error, in which the value decreases and the range increases between 
UR and SR under the condition of a small SL influence. 
At DFS processing in the time domain due to the influence of spurious signal, 
there is inevitably an increase in DFS zero displacement and even the appearance 
of new ones. As a result, the range measurement error increases, in which the value 
depends upon the SR level and the range between UR and SR. 
In all cases it is important to estimate the degree of range measurement accu-
racy decrease caused by interference influence and to formulate requirements to the 
admissible SR level. 
Later we consider the normal probe of the object with the plane surface, for 
which the main radar equation [1] takes the extremely simple form:
	
2
2
2
2
rec
rec
|
|
/(4
)
P
P
G
R
η
η λ
π
S
S
=
G
	
(6.2)
where Prec is a power of the received signal, PS is a power of the transmitted signal, 
Γ  is the reflection coefficient of EMW from the material of probing surface, G is the 
antenna gain (we assume that in transmitting and receiving modes these coefficients 
are equal), hrec, hS are the efficiency of receiving and transmitting AWP, and l is the 
wavelength of the carrying oscillation. 
6.2  The Error Caused by the Single Spurious Signal of the Difference 
Frequency
6.2.1  Error Estimation According to the DFS Spectrum Maximum Position
Let us consider the range measurement error according to the difference signal fre-
quency weighted with the help of the WF w(t). Taking into consideration that all 
WF types, including those that are not expressed via elementary functions, can be 
represented or approximated by AWF, we perform analysis using AWF and general 
equations (A.15) to (A.18) for the SD, keeping the generally accepted names of the 
approximating functions. 
Now we consider an effect of one spurious item on the range estimation error, 
neglecting by both a noise and the other interference. In the future, depending on 
signal/interference ratio (SIR), we use those pairs of (3.14) and (3.15) or (3.16) and 
(3.17), which ensure negligible errors of accuracy determination, for theoretical 
calculations of range measurement errors. 
Figure 6.3 shows the results of the error calculation of the range estimation by 
a range finder with the 1,000-MHz FM sweep, the carrier frequency at 5 GHz, and 
the application of WF (2.19) with n = 1 for two values of SIR. 
The functions of the current measurement error DR versus the range difference 
R1 – R2 between UR and SR for qs/i = 20 dB and qs/i = 30 dB, respectively, are shown 
in Figure 6.3 by solid thin and bold lines. We see that in the SR vicinity there is an 
increased error zone (IEZ) symmetric with respect to its position. The IEZ width 
is connected with the width of the SD main lobe of used WF. The oscillating plot 
character is similar to Figure 3.2; however, the period of fast and slow oscillations 
is now twice more. The period of fast oscillations is equal to half of the average 

6.2  The Error Caused by the Single Spurious Signal of the Difference Frequency	
171
wavelength of the radiated signal, and the position of the zero error values depends 
upon the phase difference of reflection coefficients from UR and SR. The period 
of slow oscillations, which is independent on UR and SR properties, is connected 
with the periodicity of WF SL used at the DFS spectral analysis. At the high level 
of the SIR, the reduction of interference level does not lead to a proportional error 
decrease. If we assume that cos[w0(t2 – t1) – (j2 – j1)] = ±1, then, based on (3.14), 
(3.15), (3.16), and (3.17), we obtain the envelopes of fast error oscillation (EE), 
which are shown by dotted thin and bold lines, respectively, in Figure 6.3. These 
curves correspond to functions of the current measurement error. We mainly show 
the EE functions in the figures. 
To illustrate the EE shape variation at the WF changing and FM sweep, 
Figure 6.4 shows the calculation results of logarithm of the envelope modulus of 
the normalized measurement error log|DxEE| versus the range difference R1 – R2 
between the target and clutter using the Blackman WF (solid bold lines) and the 
Hamming WF (dotted lines) for qs/i = 10 dB and the FM sweep Df = 500 MHz.
The functions of EE DREE and log|DxEE| have two main lobes caused by the 
interaction of signal SPD main lobes and clutter SPD, and a sequence of SL. In the 
point of range equality to the UR and SR, that is, for R1 – R2 = 0, the measurement 
error is equal to zero. At the unchanged SIR, the positions of the maxima of main 
Figure 6.3  Plots of the measuring error versus the range between UR and SR using the  
WF (2.19) with n = 1. 
Figure 6.4  Plots of the envelope modulus logarithm of the normalized error versus the range dif-
ference between UR and SR using the Blackman WF (solid bold lines) and the Hamming WF (dotted 
lines) for Df = 500 MHz and the Hamming WF for Df = 1,000 MHz (solid thin lines).

172	
Analysis of the Range Measurement Error at the Interference Presence
lobes, its level, and a width of main lobes as well as the EE SLL are connected with 
the width of the main lobe and of the EE SLL of the used WF. It is important to note 
that a decrease in the EE main lobe maxima is possible owing to a narrowing of the 
SD main lobe of used WF; however, at that EE, SLL usually grows. It is seen from 
a comparison of Figures 6.4 and 6.5.
In the range area corresponding to interaction of main lobes of signal and clut-
ter spectra, the EE are nonsymmetrical with respect to an abscissa axis. EE asym-
metry clearly becomes apparent for small SIR, which is demonstrated by Figure 6.5 
for qs/i = 0.4455 dB, Df = 1000 MHz and for using of the uniform WF (solid curves) 
and the Blackman WF (dotted curves).
With qs/i increasing, the asymmetry degree decreases (compare Figures 6.3 and 
6.5) and for qs/i >> 1 EE becomes practically symmetric with respect to the abscissa 
axis, and the maximal error decreases practically proportional to qs/i. The increase 
of the FM sweep leads to an inverse proportional decrease of the maximal error 
and the width of both EE main and EE SL. The EE shape remains unchanged, and 
the function scale changes proportional to variation of FM sweep. Nevertheless, 
the shape of the instantaneous range measurement error function changes because 
in addition, a number of error oscillations in intervals between the EN change 
­inversely proportionally. 
6.2.2  Error Estimation at Signal Processing in the Time Domain
Let us consider the SR influence on the method of weighting average of difference 
frequency. At that, we take into account results of investigations of SR influence 
on the counting method of difference frequency estimation performed in [2]. This 
publication shows that the SR located near the UR creates a displacement of the 
DFS zero positions. The SR located far from the UR causes in some cases the in-
crease of additional false zeros. The appearance of such zeros causes a large error 
and therefore it is not interesting from practical and theoretical points of view. In 
these cases, it is necessary to take additional measures on DFS filtering with the 
Figure 6.5  Plots of EE versus range difference between UR and SR for qs/i = 0.4455 dB, Df = 1,000 
MHz at the uniform WF (solid curve) and the Blackman WF (dotted curve).

6.2  The Error Caused by the Single Spurious Signal of the Difference Frequency	
173
purpose of decreasing the interference influence on measurement results. Therefore, 
we will only consider the situation in which interference leads to a displacement of 
the zero position. 
The measurement error, as in Chapter 2, caused by influence of DFS zero dis-
placement can be presented by (2.46). To use this equation in this case, it is neces-
sary to determine the DFS zero displacement under interference action. Assuming 
that SIR is rather large, zero displacement is small, and expanding in the Taylor 
series the instantaneous value of the signal us(t) and interference uint(t) in the DFS 
zero point ti, we can write the equation for the zero displacement Dti determina-
tion:
	
int
int
( )
( )
( )
0
s
i
i
i
i
i
u t
t
u
t
u
t
t
′
′
∆
+
+
∆
= 	
(6.3) 
The solution of (6.3) is
	
int
int
( )
( )
( )
i
i
s
i
i
u
t
t
u t
u
t
−
∆
=
′
′
+
	
(6.4)
For instantaneous values of the signal and interference, we can write:
	
0 del,
del,
int
int
0 del,int
del,int
int
( )
cos[
( )
]
( )
cos[
( )
]
s
s
s
s
s
u t
A
t
t t
u
t
A
t
t t
ω
ω
ϕ
ω
ω
ϕ
=
+
+
=
+
+
	
(6.5)
where As, js, and tdel,s are, respectively, DFS amplitude, initial phase, and delay 
time caused by the UR; Aint, jint, and tdel,int are, respectively, DFS amplitude, initial 
phase, and delay time caused by the SR. 
Calculating the derivatives of (6.5) and substituting them into (6.4), we obtain 
after transformations:
	
int
s/i del,
del,int
int
cos
( )
( ){
sin
( )
sin
( )}
i
i
s
s
i
i
t
t
t q
t
t
t
t
ψ
ω
ψ
ψ
D
=
+
¢
	
(6.6)
where ys(ti) = w0tdel,s + w(ti)tdel,s + js; yint(ti) = w0tdel,int + w(ti)tdel,int + jint; qs/i =  
As/Aint.
Future calculations are possible for specific WFs. We consider the WF in (2.9). 
Assuming that the FMCW is carried out under the symmetric triangle law, we ob-
tain an equation for the normalized interference component of the range measure-
ment error DS,int:
	
S,int
norm,
norm,
1
1
2
sin(2
)
K
N
W
m
i
i
m
i
K
mA
mt
t
π
π
=
=
D
= -
D
å
å
	
(6.7)
where 
int
norm,
norm,
s/i del,s
s
norm,
del,int
int
norm,
cos
(
)
2
{
sin
(
)
sin
(
)}
i
i
i
i
t
t
F q t
t
t
t
ψ
π
ψ
ψ
∆
=
∆
+
;
yint(tnorm,i) = tdel,int(w0 + Dwtnorm,i) + jint, and ys(tnorm,i) = tdel,s(w0 + Dwtnorm,i) + js.
Calculations according to this formula at a relative range to interference equal 
to 10dR, qs/i = 20 dB, 10-GHz carrier frequency, and 2-GHz FM sweep are repre-
sented in Figure 6.6 by the solid bold curve. 

174	
Analysis of the Range Measurement Error at the Interference Presence
For comparison, the normalized error at DFS processing in the spectral domain 
obtained under the same conditions is presented in this figure by a thin curve. It 
follows from Figure 6.6 that using two similar WFs for DFS processing on spectral 
and time domains, the shape of the normalized errors has the same character, but 
there are quantitative differences. At DFS processing in the spectral domain, the EE 
main lobe maximum is 10% higher and its width on the zero level is greater, but at 
that EE, the SLL is lower. 
Both methods of the DFS processing acceptable for practice levels of the inter-
ference error, which can be neglected, are achieved at SIR of 40 to 45 dB.
6.3  The Error Caused by the Influence of Spurious Reflectors in the 
Antenna-Waveguide Path and in the Operating Zone of the FMCW 
Range-Finder
6.3.1  Influence of the Frequency-Independent Spurious Reflectors in the AWP 
and in the Operating Zone of the FMCW RF
Let us analyze the influence of reflection from the single frequency-independent 
irregularity in the AWP and from the SR located in the FMCW RF operating zone 
assuming that amplitude of any DFS item is proportional to the SHF signal at the 
AWP input. Taking into consideration that the FMCW RF waveguide path length 
usually does not exceed some tens of centimeters, we can think that losses in it do 
not influence the SIR. In this case, we obtain that the amplitude of the DFS item 
created by an irregularity in the AWP is proportional to the reflection coefficient 
modulus 
AWP
|
|
Γ
 from the AWP irregularity:
	
AWP
s1
AWP
inc
|
|
U
G
P
=
Γ
	
(6.8)
where Gs1 is a coefficient of proportionality and Pinc is the power of incident elec-
tromagnetic wave in the AWP.
Figure 6.6  The plot of the normalized interference error versus the relative range to the UR for 
n = 1.

6.3  Error Caused by the Influence of Spurious Reflectors	
175
On the basis of (6.1), we determine the amplitude of the DFS item from the 
useful reflector Us:
	
2
2
s
s1
AWP
rec
s1
AWP
rec
ant
(1 |
| )
|
|
(1 |
| )
4
U
G
P
G G
P
R
λ
η
η
π
S
S
=
-
G
=
G
-
G



	
(6.9)
where Rant is range from the antenna phase center to the UR. Taking into consid-
eration that AWP is performed in a rather well-matched way, we can think that 
2
AWP
rec
inc
(1 |
| )
P
P
η
ηS
S
-
G
»

. Then SIR qs/i,ant can be written as: 
	
s/i,ant
ant
AWP
|
|
4
|
|
G
q
R
λ
π
Γ
=
Γ


	
(6.10)
Values of 
AWP
|
|
Γ
 of the industrially manufactured FMCW RFs are 0.05 to 0.1. 
Evidently, the maximal possible value of s/i,ant
AWP
|
| |
|
q
≈Γ
Γ


 will be, when on the 
minimal possible range (restricted by antenna size), the whole useful reflected signal 
received by the antenna. Values of |
|
Γ  are varied most frequently within the limits 
0.17 to 1. Depending on the achievable AWP matching level and the reflection level 
from the UR, the maximal value of qs/i,ant can be from 4.6 dB to 26 dB. However, 
at the necessity of the level measurement of weakly reflected liquids, for instance, 
cryogenic, qs/i,ant can be significantly less than 0 dB at all ranges beginning from the 
antenna aperture with the encapsulated radome. 
A proportional decrease of qs/i,ant with the range increasing to the UR leads to 
the fact that beginning from some range, qs/i,ant << 1 at the input of the circuit for 
analogous signal processing. Because of this, in spite of the fact that with range 
increasing the useful signal and clutter are easily resolved, it is necessary to take 
clutter influence into consideration at the analysis of any of the methods used in 
DFS processing. 
It is known that the problem of detection of resolving weak signals of the SD SL 
background of the strong signal is easily implemented using the WF w(t) [3]. In the 
case under consideration, there are some peculiarities. In particular, at the loading-
level measurement in reservoirs, the function of echo-signal values versus the range 
defined by (6.2) significantly differs from the function of echo-signal values in tra-
ditional radar technology. That is why widely used WFs can be nonoptimal in the 
velocity Cs of the SD SL decrease, because redundant Cs inevitably increases the 
range measurement error at interference present. 
Figure 6.7 shows calculated functions of the normalized EE for range mea-
surement versus normalized range to probing plane surface at presence of single 
irregularity located in antenna aperture. The relative AWP length is assumed to 
be equal to 4; the antenna phase center coincides with its aperture; the reflection 
coefficient modulus from irregularity is equal to 0.2, and from the probing surface 
it is equal to 1. The SIR at the coincidence of the probing surface with antenna 
aperture is equal to 5. In calculations we used the AWF in (A.13) and (A.14) with 
N = 2. The varied zeros for two AWFs in (A.13) and one AWF in (A.14) are equal, 
respectively, to (b1 = 2.014044, b2 = 2.628), (b1 = 2.06438, b2 = 2.06438), and (b1 = 
1.15122228, b2 = ¥). The EE SLL decrease speeds are equal, and that, respec-
tively, 6 dB/oct is denoted by a dotted curve, 18 dB/oct is denoted by a solid thin 
curve, and 12 dB/oct is denoted by a solid bold curve.

176	
Analysis of the Range Measurement Error at the Interference Presence
From Figure 6.7 we see the nondamping (with the range) EE character at the 
WF application with Cs = 6 dB/oct with the lowest first SL of the EE function. When 
using the WF with Cs = 18 dB/oct, the EE oscillations have fast damping but the first 
SL is commensurable in amplitude with the main lobe. Such a large level of the first 
SL is caused by the fact that at Cs = 18 dB/oct the tendency of the decrease in the EE 
maximum Fenv,max up to 1.25 leads to the necessity of essentially narrowing the WF 
SD main lobe, due to which the first SD SL is sharply increased and, hence, the first 
EE SL. The application of the WF with Cs = 12 dB/oct provides a damping character 
of the EE oscillations at a relatively small initial level. 
At the application of the WF with Cs = 6 dB/oct, the nondamping (with the range) 
character of this EE component caused by the reflection from the irregularity located 
in the AWP is reported on the range estimation error near the SR located far from 
the antenna in the measurement region. Calculation error functions under conditions 
similar to those shown in Figure 6.7 and with the same designations are shown in 
Figure 6.8 but, at present, of the SR in the measurement region at relative range 20. 
The SIR on the SR qs/i at the range equality to the UR and the SR is equal to 10.
We see from Figure 6.8 that the nondamping oscillations of the range estima-
tion error introduce the most additional error in the measurement result. At the 
Figure 6.7  Plots of the envelope of the normalized range estimation error caused by reflection from 
irregularity in the antenna aperture.
Figure 6.8  Plots of envelopes of the normalized range estimation error caused by a reflection from 
the irregularity in the antenna aperture and from the spurious reflector in the measurement region.

6.3  Error Caused by the Influence of Spurious Reflectors	
177
application of the WF with Cs = 12 dB/oct and with Cs = 18 dB/oct, the additional 
error is significantly less. 
A choice of fixed WF parameters is usually made starting from the compromise 
between the width of the EE main lobe, the level of the maximal error, and the EE 
SLL. It should be noted that the AWF family in (A.14) in many problems of the 
range estimation to the plane surface can ensure the noticeable advantage in the 
resulting error due to possibility of obtaining an EE maximum that is not large 
with medium SD sidelobes increasing and, accordingly, EE SLL. At the probing of 
objects, for which the received signal power is inversely proportional to the fourth 
order of the range [1], the advantage is ensured by the WF with Cs = 18 dB/oct. Such 
WFs are obtained from the AWF family in (A.13) by specification of one of the zeros 
on infinite relative frequency. In general, the probing object geometry and damping 
factor of the EMW in the space influence upon dependence of received signal power 
versus range. In this connection, a choice of the AWF family in (A.13) or (A.14) 
and specification of Cs in the real situation must be made on the basis of the speed 
analysis of the decrease of the received signal power. 
6.3.2  Influence of the Spurious Reflection of the Pulse Character
In this case, it is not the nature of the increase in pulse interference that is interesting 
but the influence of the pulse parameters on the range measurement error; there-
fore, we use for analysis the pulse interference approximation, which allows us to 
obtain SAD analytical equations. We use the product of the sinusoidal function and 
the AWF as the signal mathematical model. Therefore, the pulse radio signal can 
be presented as:
	
s/i
0
dev
wg
dev wg
wg
an
p
11
1
p
p
p
1
p
p
p
cos (
)
2
( )
( )
1
(
,
)cos 2
0.5
at
p
at
,
N
sn
N
n
t
q
t
T
t
t
u t
C
b
b
n
t
t
t
T
T
t
t
t
t
T
ω
ω
τ
ω
τ
ϕ
π
=



−
+
−
×











−




=
+
−
≤
≤
+
















≤
>
+


∑
…
0
	 (6.11)
where wdev = Dw /2 is the frequency deviation. 
The signal CSD in (6.11) looks like this:
	
p
p
wg
wg
p
2
s/i
2
11
1
2
2
1
2
+
11
1
2
2
1
1
( )
2
sinc(
) 1+
(
)cos
sinc( x ) 1+
(
)cos
T
j
t
N
j
sn
N
n
N
j
sn
N
n
T
S x
e
q
x
e
x
C
b
b
n
x
n
x
e
C
b
b
n
x
n
ϕ
ϕ
π
π
π
π
æ
ö
- W
+
ç
÷
è
ø
-
-
-
=
-
+
+
=
=
é
ù
ì
æ
ö
ï
+
ê
ú
í
ç
÷
-
è
ø
ê
ú
ïî
ë
û
ü
é
ù
æ
ö ï
ê
úý
ç
÷
-
è
ø
ê
úï
ë
ûþ
å
å
…
…
´
	
(6.12)

178	
Analysis of the Range Measurement Error at the Interference Presence
where jWG = (w 0 – wdev)tWG – jWG,irr(t) + WWG(tp + Tp/2)}, tp is a moment of pulse 
start with duration Tp, x– = (x – xWG)/Qoff, x+ = (x + xWG)/Qoff, xWG = WWGTan /2p is 
the normalized range to irregularity in the waveguide, Qoff = Tan/Tp is the off-duty fac-
tor of the pulse signal, Tan is the duration of the analysis interval (a half-modulation  
period at triangle law), sinc(px) = sin(px)/px, tWG and jWG,ref(t) is the delay of the 
transmitted wave at propagation in the waveguide to irregularity and back and the 
phase of reflected wave in the waveguide, respectively, Wdif = 2wdevtWG /Tan is the dif-
ference frequency of the signal with the pulse envelope, and b11,…b1N are specified 
AWF zeros, which approximate the envelope of the radio pulse signal.
We should pay attention to some SR peculiarities of the pulse character and 
its CSD, which are illustrated by (6.11) and (6.12). Because the duration Tp of the 
pulse character interference is essentially less than the FM period, and the SAD 
main lobe is significantly wider than useful signal SAD and is in conjunction with 
the fact that AWP length does not usually exceed some tens of centimeters, the 
modulus maximum of pulse interference SAD is the most used, located very close 
to zero frequency. Therefore, the AWP length has a significant effect on the SAD 
amplitude of the pulse interference due to the interaction of the SAD items from the 
areas w > 0 and w < 0. This influence is illustrated by Figure 6.9, in which the CSD 
modulus in (6.7) is shown with Qoff = 20 when using for the mathematical model 
of the pulse radio signal in (6.6) for N = 2 and b11 = b12 = 2. The SD modulus of 
radio pulses are shown by the solid, dotted, and chain curves obtained in the AWP 
with the relative electric length to irregularity created the pulse interference equal 
to, respectively, 1.3827, 1.395, and 1.40741.
We see from Figure 6.9 more than tenfold variation of the SAD maximum of the 
radio pulse at variation of normalized range (position) to irregularity by 0.02471 
(these irregularity positions are selected according to the influence maximum). The 
maximum of the SAD pulse is located on zero frequency if the doubled relative elec-
tric range is less than that resolving for the pulse of specified duration and shape. 
However, there are narrow zones of range to irregularity, when CSD items for w > 
0 and w < 0 are antiphase and the CAD extreme is formed on zero frequency for 
a positive second derivative. The same figure shows by a thin solid curve the SAD 
of a radio pulse created by irregularity in AWP with relative electric length to ir-
regularity equal to 40. The interaction of CSD items from areas w > 0 and w < 0 is 
weakened and the maximal value of SAD modulus is stable.
Figure 6.9  SAD of the radio pulse signal.

6.3  Error Caused by the Influence of Spurious Reflectors	
179
Let us consider the influence of the radio pulse (6.11) on the range estimation 
error.
We note that with the increasing moment of pulse interference defined by the 
coincidence of the generated frequency of the FM oscillator with resonant fre-
quency of AWP irregularity, the inside of the analysis interval Tan can be arbitrary. 
Therefore, due to the multiplication of DFS and the pulse interference sum with the 
smoothing WF, the interference influence on processing result will be maximal if 
the pulse interference arises in the area of the WF maximum; that is, in the center 
of the Tan interval. Therefore, we give the calculation results assuming that the mo-
ment of pulse interference arising is in the center of Tan interval.
Figure 6.10  Pulse interference and resulting DFS: (a) before WF processing and (b) after WF 
­processing.
Figure 6.11  SAD on pulse interference (curve 1), of useful DFS item (curve 2) and of the resulting 
signal (curve 3).

180	
Analysis of the Range Measurement Error at the Interference Presence
The resulting signal is processed by the AWF in (A.13), which is optimal on the 
EE SLL with Fenv,max = 1.25 and b1 = 2.014044, b2 = 2.628. SIR defined according 
to the amplitude values of the signal and interference is equal to qs/i = –6 dB. The 
normalized range to the useful reflector is 20, and the normalized range to spurious 
irregularity in AWP is 1. The duration of the interference pulse is Tp = 0.1Tan. The 
bell shape of the pulse is specified by (6.11) with N = 2 and 11
28/3
b
=
, b12 = ¥.
SAD of interference and useful DFS items and SAD of the resulting signal, 
shown in Figure 6.10, are presented in Figure 6.11.
DFS processing by the weighting function at the narrow pulse does not practi-
cally influence on its shape and, accordingly, does not influence SAD. The SAD 
shape of the useful item can be widely varied by the WF parameter changing.
Using (3.17) and (6.12) for the above-mentioned conditions, we calculate the 
measurement error function versus range to the UR and its envelopes at the 1-GHz 
FM range and the 10-GHz carrier frequency. These functions are presented in Fig-
ure 6.12.
As before, the plot character contains fast and slow oscillations. The period of 
fast oscillations is equal to half of the average wavelength of the radiated signal, 
and the position of the zero error values depends on the phase difference of reflec-
tion coefficients from useful and spurious objects. The period of slow oscillations is 
connected with pulse interference SAD SL periodicity and it caused by its duration 
and shape. The position of the envelope maximum, which is defined mainly by the 
maximum position of the first derivative of the pulse SAD, is connected with the 
duration and shape of the pulse interference. The application of the AWF in (A.13) 
Figure 6.12  Plots of the measurement error and its envelopes versus range to UR. 
Figure 6.13  Plots of the maximal error values versus the pulse duration.

6.4  Error Caused by Signal Reflection	
181
with N = 2 and 11
28/3
b
=
, b12 = ¥, which has an SLL less than –58 dB, for pulse 
shape approximation, defines the low WF SLL not shown in the plot.
We examine the relatively low error level even for low qs/i = –6 dB and the very 
wide main lobe of the error. Both factors are caused by the wide main lobe of spurious 
item’s SAD. In turn, the width of the SAD main lobe of the spurious item is connected 
with the pulse duration and shape. Pulse duration influence on the frequency estima-
tion error is illustrated in Figure 6.13, in which the functions of maximal error values 
DxEE,max are shown at the DFS processing by the Blackman WF (solid line), by the 
above-mentioned AWF in (A.13) optimal on the EE SLL with FEE,max = 1.25 and b1 = 
2.014044, b2 = 2.628 (dotted line) and by the uniform WF (dashed-dotted line).
A strong influence of the pulse interference shape on the value and shape of enve-
lope can be seen from a comparison of Figures 6.12 and 6.14. Figure 6.14 shows the 
EE for the above-mentioned conditions but at the effect of the rectangular pulse. Error 
envelopes for the application of the Blackman WF for the DFS processing (dotted line) 
and the AWF in (A.13) with b1 = 1.1512, b2 = ¥ (solid line) are presented in this fig-
ure. At the influence of the rectangular pulse, the EE character becomes nondamping 
with the lesser width of the main lobe. Independently on WF used for DFS processing, 
the EE function character is saved, but the scale of error axis strongly changes. The 
reduction of the main lobe width by 2.6 times for the AWF in (A.13) with fixed zeros 
compared with the Blackman WF leads to an error decrease by 6.6 times.
These figures show that some tasks of the precision range estimation on the 
background of the pulse interference can be solved with the error, which does not 
exceed the specified value, by an efficient WF choice. 
6.4  The Error Caused by the Signal Reflection from the Corner Formed 
by the Reservoir Vertical Wall and the Liquid Surface
Let us consider the error component, which arises due to waves radiated and re-
ceived by an antenna in the direction of the corner formed by the reservoir vertical 
wall and the liquid surface. In this case, the UR and SR are not usually resolved in 
the range. In connection with the fact that the UR and SR represent different parts 
of the same liquid, the SIR can decrease to 1.
Usually at mounting, the level meter is located in such a manner that the direc-
tional pattern (DP) axis of an antenna would be oriented on normal to the probing 
plane liquid surface. We assume that the reservoir base radius exceeds by many times 
Figure 6.14  Envelopes of the normalized error of range estimation caused by the pulse 
­interference.

182	
Analysis of the Range Measurement Error at the Interference Presence
the range from the place of the FMCW RF mounting to the wall. We may consider that 
the interference is created by the waves’ reflection from the two-sided corner formed 
by the vertical wall tangent to the reservoir wall and the liquid surface. Assuming also 
that all ranges allow the application of the geometrical optic approximation for the 
determination of amplitude-phase relations of useful and spurious signals, we obtain 
that the amplitude of the useful signal is defined by the range to the liquid surface 
and the reflection coefficient from the probing liquid at the normal wave incidence on 
it. The spurious signal amplitude is defined by the range to the corner formed by the 
reservoir vertical wall and the liquid surface, by the antenna DP in the direction of 
the corner, and by orientation of the vector of electrical field intensity with regard to 
the incidence plane and the wave reflection coefficient at inclined incidence. The main 
peculiarity of the EMW reflection from the two-sided corner consists of the cross-
polarized reflected electromagnetic field [4] if the vector of electrical field intensity of 
the incident wave inc
E

 is nonperpendicular or nonparallel to the edge of the two-sided 
corner. In the case if the vector of the linear-polarized field inc
E

 is oriented under angle 
p /4 to the edge of two-sided corner, the reflected field is orthogonally polarized with 
regard to the incident wave field and is not received by the transmit-receive antenna. 
As a result, the interference amplitude will be zero. In a similar way, we may eliminate 
the interference signal using the field with circular polarization. In general, under the 
above-mentioned conditions, the SIR may take values from close to 1 to ¥.
At first, we analyze the case when the SIR is close to 1; that is, when the vector 
inc
E

 is oriented in parallel to the edge of two-sided corner. The error function char-
acter versus range to the liquid surface is defined by the range difference between 
the UR and SR 
2
2
r
R
h
R
∆=
+
−
 and the antenna DP shape. In these equations, h 
is range from the phase center of the FMCW RF to the vertical wall of the reservoir 
and R is the range from the antenna phase center to the liquid surface. Hence, DFS 
without account of the noise 
	
dif
0
ref
del,int
s
2
2
ref
del,int
del
s
2
2
2
ref
( )|
(0)| cos[ ( )
]
|
( )|
( )
cos[ ( )(
)
]
|
(0)|
(0)
u
U t
t t
F
R
t t
t
F
R
h
ω
ϕ
ω
ϕ
=
G
-
G
Q
Q
+
+ D
-
G
+
üïý
ïþ
üïý
ïþ



	
(6.13) 
where F(Q) is a characteristic of antenna directivity, 
ref
|
( )|
Γ
Θ

 is reflection coefficient 
from the probing surface for the wave incidence angle equal to Q, 
ref
|
(0)|
Γ
 is the 
reflection coefficient from the probing surface for wave incidence angle equal to 
zero, Dtdel = 2Dr/c. In the considered case of the vector inc
E

 orientation in parallel to 
the edge of a two-sided corner,
	
ref
ref
|
( )| |
(0)| 1
Γ
Θ
Γ
≈


	
(6.14)
Because the WF influence on the range estimation error was considered in 
­Section 6.2, we do not focus attention on the peculiarities of error variation at the 
WF variation and in all cases we use the AWF with a normalized half-width of the 
SAD main lobe b1 = 2.
Figure 6.15 shows in absolute units the measurement errors as a function of 
range to liquid surface R during M RF mounting, relatively, at range h = 0.4 m and 

h = 2 m from the wall using an antenna with the DP width 150 on level -3 dB for 
a 10-GHz carrier frequency. The solid curves correspond to the FM sweep at FM 
Df = 1 GHz, and dotted curves to Df = 500 MHz.
We see from Figure 6.15 that the measurement error has an oscillating charac-
ter with narrow parts with the high measurement error, on which the measurement 
result is underestimated, and with more wide parts with the much lesser error, on 
which the measurement result is overestimated. A comparison of figures shows 
that the number and relative portion of parts with the high error do not practically 
depend upon the FM sweep and is determined by range to the reservoir wall. The 
FMCW RF approach to the reservoir wall allows error reduction, especially in 
wide parts with the overestimated measurement result. Moreover, in this case the 
last outermost part with high error approaches to the FMCW RF, and then the er-
ror monotonically decreases to zero. At that, at the near range from the wall in the 
parts with the overestimated measurement result, the measurement error does not 
practically depend upon the FM sweep. At these parts, the error functions corre-
sponding to Df = 1000 MHz and Df = 500 MHz are indistinguishable in Figure 6.15. 
In the zones of high error, its value is practically proportional to the FM sweep. 
One can eliminate the interference signal using orthogonally polarized waves 
reflected from the corner. The reduction of interference amplitude to 5 to 10 times 
is practically possible in such a way. As a result, the measurement error essentially 
decreases. The functions of the measurement errors versus the range to the liquid 
surface for the above-mentioned conditions are presented in Figure 6.16 but for the 
interference signal elimination by 14 dB.
As a result, the measurement error level is not only essentially decreased but the 
type of its range dependence is changed. Distribution of parts with overestimated 
and underestimated measurement results becomes practically uniform, and at the 
small range from the wall (0.4 m and less), the dependence of the measurement error 
on the FM sweep practically disappears. At the FMCW RF mounting for the range 
Figure 6.15  Plots of the measurement error by the range-finder, which is mounted at the range 
(a) 0.4 m and (b) 2 m from the reservoir wall. 
6.4  Error Caused by Signal Reflection	
183

184	
Analysis of the Range Measurement Error at the Interference Presence
2 m from the wall in the initial part of the error function, its value strongly depends 
upon the FM sweep and with the range increasing to the liquid, the amplitude er-
ror values for Df = 1000 MHz and Df = 500 MHz become practically equal. Figure 
6.16(a) shows by the thin line the function of measurement error by the FMCW 
RF, in which the antenna is mounted almost right against the reservoir wall. The 
antenna with DP width 15° on the level of –3 dB with the aperture radius 0.075 m 
used earlier is mounted at range h = 0.08 m from the reservoir wall. The insignifi-
cant error increase is seen only at the near range.
These results are evidently true for the range-finder mounted near the smooth 
reservoir wall in the absence of the SR in the form of wall irregularities. Under such 
conditions, the radical method of error decrease is an extremely close antenna loca-
tion near the reservoir wall. 
6.5  Influence of the Edge Modes Caused by the Restricted Sizes of the 
Probing Object
The representation of DFS from the probing object in the form of the first item of (6.1) 
assumes that this object is an infinite plane reflector. Nevertheless, in reality the prob-
ing object has always been the restricted sizes, which can lead to measurement errors. 
Let us suppose that the plain reflector is mounted at a range R1 perpendicular 
to the direction to the FMCW RF (Figure 6.17). We need to estimate the influence 
of reflector configuration. We assume that the angular reflector’s sizes with regard to 
the point of FMCW RF antenna location are small, and linear sizes exceed the wave-
length many times. In this case, we can neglect by the function of the reflection coeffi-
cient versus the incident angle, and to determine of complex amplitude of the reflected 
field (in arbitrary point A), we may use the scalar Kirchhoff approximation [5]:
	
0
2
0
ampl
0
2
s
( )
cos( ,
)
2
s
j kr
s
jk
e
U
U
F
n r
ds
r
π
-
=
Q
ò
 


	
(6.15)
Figure 6.16  Plots of the measurement error by the range-finder mounted from the reservoir wall at 
range: (a) 0.4 m and 0.08 m and (b) 2 m.

6.5  Influence of the Edge Modes Caused by the Restricted Sizes of the Probing Object	
185
where F(Q) is the characteristic of antenna directivity and 
0
U  is the complex ampli-
tude of the wave falling to the reflector, k = 2p/l. Other designations are clear from 
Figure 6.17.
Equation (6.15) can be presented by asymptotic expansion 
	
1
1
2
1
2
2
1
ampl
0
2
1
1
1
2
1
2
2
1
2
0
2
2
1
0
1
1
(0)
1
(0)
2
(0)
2
1
1
( )
1
( )
4
( )
2
m
N
j kR
m
j kR
m
m
m
N
j kr
m
j kr
m
m
R
e
d
U
U F
e
F
R
F
j k
dr
R
R              e
r
d
U
F
e
F
d
F
j k
r
dr
r
π
ϕ
π
−
−
=
−
−
=








=
+
⋅
−
























−
Θ
+
⋅
Θ






Θ








∑
∑
∫



	
(6.16)
where 
2
2
1
( )
r
R
ρ
ϕ
=
+
, r(j) is the reflector configuration. 
At kR1 >> 1, it is possible to limit by the first items of a series and then
	
1
2
2
2
0
1
ampl
0
2
1
0
(0)
( )
2
4
j kR
j kr
U e
F
R
e
U
U
F
d
R
r
π
ϕ
π
−
−


=
−
Θ






∫



	
(6.17)
The item 
1
2
0
1
(0)
2
j kR
U e
F
R
−

 corresponds to the complex amplitude of the field re-
flected by the infinite plane reflector and its electrodynamical range coincides with 
the geometric one. Thus, the reflected field represents by the field sum from the 
infinite plane reflector and the interference caused by finite reflector sizes:
	
2
2
1
int
0
2
0
( )
4
j kr
R
e
U
U
F
d
r
π
ϕ
π
−
=
Θ
∫


	
(6.18)
Figure 6.17  The calculation of the field reflected by the plane reflector of finite sizes.

186	
Analysis of the Range Measurement Error at the Interference Presence
The complex amplitude of interference field can be normalized to the complex 
amplitude of the infinite reflector U∞
 :
	
0
2
2
int
2 (
)
1
int,norm
2
0
1
( )
2
(0)
j k r r
R
U
F
U
e
d
F
U
r
π
ϕ
π
−
−
∞
Θ
=
=
∫



	
(6.19)
In general, the interference field distribution depends on the shape, the range 
to the reflector, and frequency, and the measurement error depends on the dis-
tribution of the field intensity, the sizes of the used antennas, and the methods 
of signal processing. It is impossible to obtain the general analytical solution for 
the error under the conditions described above. We prove the significance of the 
above-mentioned type of interference on the range estimation error in an example 
of a circular disk with the radius h, which is probed from the axial FMCW RF 
direction, in which the axis of the axis-symmetric antenna DP is oriented on the 
disk center. We assume that the measuring range and disk sizes are so large that the 
field distribution in vicinity of axis within the sizes of the used antenna is constant. 
In this case, the equation for a normalized complex amplitude of the interference 
field takes the simplest view:
	
1
2
2 (
)
1
int,norm
2
( )
(0)
j k r R
R
F
U
e
F
r
−
−
Θ
=

	
(6.20)
The interference field is created by the toroidal wave from the reflector edge. 
It is reasonable to assume that the complex amplitude of interference at antenna 
output 
norm
ant,int
U
 will be proportional to the antenna DP in the direction to the 
reflector edge: 
	
1
norm
2
2
2 (
)
1
ant,int
2
2
( )
(0)
j k r R
R
F
U
e
F
r
−
−
Θ
=

	
(6.21)
Hence, the DFS without account of the noise is: 
	
dif
0
2
2
1
del,int
del,int
del
2
2
2
1
( )
( )
cos[ ( )
]
cos[ ( )(
)
]
(0)
u
U t
R
F
t t
t t
t
F
R
h
ω
ϕ
ω
ϕ
=
ì
ü
Q
ï
ï
´
-
+
+ D
-
í
ý
+
ï
ï
î
þ
	
(6.22)
where Dtdel = 2Dr/c, 
2
2
1
1
r
R
h
R
∆=
+
−
.
Equation (6.22) for the DFS obtained when illuminating the circular disk with 
the radius h under the above-mentioned simplifications coincides in its structure 
with (6.13), from which it follows that in this case the range estimation error to the 
circular disk coincides with the range estimation error to the half-infinite probing 
object restricted by the vertical wall at the range h from the RF antenna and, as it 
follows from Figure 6.15, can achieve significant value. Looking ahead, we note 
that the theoretical and experimental functions of the range measurement error to 
the circular disk are discussed in Chapter 9. 

6.6  Influence of Reflected Waves on the Measurement Error of the FM Range-Finder	
187
6.6  Influence of Reflected Waves on the Measurement Error of the FM 
Range-Finder
6.6.1  Influence of Echo Signals on the Operating Mode of the SHF Oscillator
It is known that load mismatching of the directing system (DS) causes reflected 
waves, which lead to a variation of the operating mode of FM oscillator and to 
distortions of the FM law [6]. Therefore, the presence of reflected echo waves both 
from the target and from spurious reflectors must lead to error increase of range 
measurement by the FMCW RF. 
We consider the general case [7], when the FM oscillator is connected to the trans-
mitting antenna of DS containing isolation devices (isolators, buffer amplifiers, and 
so forth) with the finite deepness of the suppression D of echo waves. The frequency­ 
of generated oscillations can be determined from the phase balance condition [6, 8]:
	
2
osc,s
in,
1
Im
0
M
i
i
Y
Y
η
=
æ
ö
+
=
ç
÷
è
ø
å


	
(6.23)
where 
2
2
osc,s
res
res
res
[1
(
)
/(
)]
Y
G
j
Q
ω
ω
ωω
=
+
−

 is the conductance of loaded oscillat-
ing system with connected active and modulating elements without influence of 
echo waves, Gres is the equivalent conductance of the parallel oscillating circuit of 
the resonance frequency, Q is the Q-factor, wres is the resonance frequency, h2 = 
Yin/Gres << 1 is the load turn-on ratio in the circuit, M is the total number of 
reflectors, in which echo waves arrive to the input of the transmitting antenna, 
in,
ch
in,
in,
(1
)/(
)
i
i
i
Y
Y
=
−Γ
Γ



, Ych is the characteristic conductance of the transmission 
line connected to the oscillator output, and 
in,i
Γ
 is the reflection coefficient for each 
reflected ith wave on the load input. Then we suppose that i = 1 corresponds to the 
UR, and all others are spurious; therefore, SR may be absent. 
We assume that in the FM process the resonant circuit frequency should change 
according to the specified law wres(t), and owing to the influence of the echo waves, 
the frequency changes according to another law
	
res
res
1
( )
( )
( )
( )
( )
M
i
i
t
t
t
t
t
ω
ω
δω
ω
δω
=
=
+
=
+
∑
	
(6.24)
The phase balance condition (6.23) can be rewritten as
	
Y
t
 D
η
τω
ϕ
+
G
+
=
2
2
res
res
res
2
ch
1
[
( )
( )]/[ ( )
( )]
2
sin[
( )
]/
    0
M
i
i
i
QG
t
t
t
t
ω
ω
ω
ω
=
-
å
	
(6.25)
Taking into consideration that D >> 1 and for 
in,
|
|
1
i
G
<<

 the condition dw(t) << 
wres(t) will be satisfied, we obtain the equation for the FM law distortion:
	
res
res
1
( )
( )
sin[
( )
]
M
i
i
i
i
t
t A
t
δω
ω
τ ω
ϕ
=
=
G
+
å
	
(6.26)
where A = Ychh2/GresQD is a coefficient depending only upon properties of  
the ­transmitting-receiving module (TRM). Usually, values of A of the industrially  

188	
Analysis of the Range Measurement Error at the Interference Presence
­manufactured TRM for the FMCW RF do not exceed 0.0005. The modulation law 
(6.26) error is a sum of periodic functions of two variables: time and range.
We note that an essential difference between propagation time ti in (6.26) and 
delay time tdel in (6.1) caused the necessity in a different letter designation of, at 
first glance, the same variables. The range variation between SHF oscillator and the 
directional coupler (DC) of the local oscillator signal leads to ti variation, but does 
not manifest itself on the tdel value.
Because the ratio of the received and radiated power is included into the equa-
tion for the reflection coefficient, evidently the influence on the oscillator frequency 
of the conditions of radio-wave propagation, the sizes and the shape of probing 
objects, and their electrical-physical parameters takes place. We consider next the 
most widespread cases of object probing (represented by the plane or by a set of 
point reflectors) in the free space and reflectors in the directing system. 
We assume that gain of the antenna does not depend upon frequency within the 
limits of modulation range. Then it follows from [1] that at the normal probing of 
the plane reflector
	
mat,
ant
free,
/4 ( )
i
i
i
c
G
t R
ω
G = G
	
(6.27)
Gant is the antenna gain, Gmat,i is modulus of the reflection coefficient from the ma-
terial, and Rfree,i is range to probing surface.
At the probing of the plane reflector
	
2
2
ant
free,
( , )
/
4 ( )
i
i
cG
F
t R
ξ ς
σ π
ω
G =
	
(6.28)
s is the effective scattering area of the point reflector, F(x,V) is the normalized 
­antenna DP characteristic, and x,V are angular coordinates of the reflector in polar 
coordinates with a center in the antenna phase center and the polar axis coinciding 
with the DP axis. 
At reflector probing in the directing system [9]
	
0 exp{
[ ( )]2
[ ( )2
]}
i
i
i
i
i
t
L
j
L
α ω
β ω
ϕ
Γ = Γ
−
−
+
	
(6.29)
Gi0 is the modulus of reflection coefficient from probing object in DS, Li is the object 
longitudinal coordinate, and b(w) and a(w) are frequency-dependent coefficients of 
phase and damping, respectively.
6.6.2  Influence of the Wave Reflected from the Useful Reflector on the Range 
Measurement Error 
To calculate the range R, we use (1.17). In this case, at signal processing, the range 
measurement error arises due to the fact that the used value of the FM range Dw 
does not coincide with the instantaneous value Dwinst differing from the specified 
one due to the distortion presence in (6.26):
	
inst
mod
(
/2)
(0)
T
ω
ω
δω
δω
D
= D
+
-
	
(6.30)
where dw(Tmod/2), dw(0) is the oscillator frequency deviation from the specified 
outermost point of the analysis interval.

6.6  Influence of Reflected Waves on the Measurement Error of the FM Range-Finder	
189
Based on (6.30), (6.26), and (1.17), the normalized error is 
	
int
int
int,T
int
0
int
int,0
int
0
int
0
1
sin[
(
)
]
sin(
)
R
R
R
R
A
δ
δ
ω
τ
ω
ω
ϕ
τ
ω
ϕ
ω
D
=
ì
ü
æ
D
ö
´
+
G
+ D
+
- G
+
í
ý
ç
÷
è
ø
î
þ
	
(6.31)
where Gint,T, Gint,0 are defined by (6.27) through (6.29) on the frequencies w0 + Dw 
and w0, respectively. 
Taking into consideration that (w0 + 0.5Dw)tint = 4pRint/laver , where laver is 
the wavelength of the carrying oscillation corresponding to the average frequency 
of the FM sweep and 0.5Dwtint = 4pRint/dR for two types of reflectors on the free 
space, we obtain the relative measurement error
	
ant
int
aver
cos 4
sin
2
R
R
R
G
A
R
R
V
π
ϕ
π
δ
π
λ
δ
∆




=
+








	
(6.32)
where V = Gint,0 for the plane reflector and 
2( , )
/ /
V
F
R
ξ ς
σ π
=
 for the point 
­reflector. 
Similarly, for the reflector located in the DS at the range L, we have:
	
int,0
int
2
int
0
1
sin 4
4
sin 4
exp(
2 )
L
R
R
L
L
A B
k
L
L
π
ϕ
δ
δ
λ
π
ϕ
α
λ
D
æ
ö
= G
+
ç
÷
è
ø
é
êë
ù
æ
ö
-
+
-
ú
ç
÷
è
ø û
	
(6.33)
where k = Dw/w0; B = (k + 1)exp(– ak2Lg ); l2 and l1 are wavelengths of carrying 
oscillation corresponding to the upper w0 + Dw and lower w0 frequencies of the 
range. 
Figure 6.18 shows the relative measurement error function versus the relative 
range R/dR or L/dR for the three mentioned variants of reflection at Gant = 21 dB, 
A = 0.0003, k = 0.1, Gint,0 = 0.2, g = 1, laver = 0.03 m, DF = 1 GHz, s = 0.01 m2, 
F(x,V) = 1 and a = 0.2 dB/m.
In all cases, the measurement error function versus the measured range has an 
oscillating character with double periodicity. Therefore, a plane reflector probing 
the maximal value does not depend on the range [Figure 6.18(a)]. At the point ob-
ject probing [Figure 6.18(b)], the maximal error values are inversely proportional 
to the range. At the object probing in the DS [Figure 6.18(c)], the maximal values of 
the oscillating error with the range increasing at first increases to the value
	
int,0
0
(
1)/(
2
)
L
R
R
A B
k
e
δ
α
δ
∆
≈Γ
+
	
(6.34)
at the range L » 1/2a0 and then decreases monotonically. Figure 6.18(c) shows the 
part with decreasing error amplitude, which is located beyond the right boundary 
of the plot, due to the smallness of the damping factor a0.

190	
Analysis of the Range Measurement Error at the Interference Presence
6.6.3  Simultaneous Influence of Waves Reflected from the Useful and 
Spurious Reflectors on the Range Measurement Error
In the situation when at the reflector probing located in the free space at the range 
Rint there is a single irregularity in the AWP at the range Rant from the oscillator, 
which is extremely important. It is caused by insufficient good matching of ­separate 
Figure 6.18  Plots of the normalized measurement error versus the relative range: (a) the plane 
reflector, (b) the point reflector, and (c) the reflector in the DS.

6.6  Influence of Reflected Waves on the Measurement Error of the FM Range-Finder	
191
units (for instance, the encapsulation device in the AWP). We can write from (6.26) 
the resulting relative error as: 
	
ant
int
int
int
aver
int
AWP
ant
ant
0
AWP
aver
cos 4
sin
2
2
exp(
2 )cos 4
sin
2
R
R
R
R
R
G
A
R
R
V
R
A
R
R
L
k
π
ϕ
π
δ
π
λ
δ
α
π
φ
π
δ
λ
δ
D
æ
ö
æ
ö
=
+
ç
÷
ç
÷
è
ø
è
ø
G
æ
ö
æ
ö
-
-
+
ç
÷
ç
÷
è
ø
è
ø
	
(6.35)
where GAWP and jAWP are, respectively, the modulus and phase of the reflection coef­
ficient from irregularity in the AWP, V = Gmat for the plane reflector, 
int
/ /
V
R
σ π
=
 
for the point reflector, and V = 2pGint,0xintexp(–a02Rint)/k for DS. 
The error is defined by two items. The second item in (6.35) defines the fast 
oscillating error component, and the first item defines the direct current of the error 
depending on the UR position and the reflection coefficient phase.
At the variation of the UR position and for unchanged Rant, the oscillating compo-
nent is summed with the linear-changed component generated by the SR, by the second 
item in (6.35). The tilt angle tangent of the linear-changed component is defined by 
the modulus GAWP and phase jAWP of the reflection coefficient from irregularity in the 
AWP, its coordinates, and inverse proportion to the coefficient k = Dw/w0. The varia-
tion of the irregularity coordinate Rant in the AWP causes a slope variation of the linear 
measurement error in the sector 
int
AWP
0
ant
arctan
exp(
2
)
k
R
R
R
π
α
δ
Γ


±
−




. This is shown 
in Figure 6.19, where the function of the total normalized measurement error versus 
the relative range to the UR at the specified parameters and for two SR positions in the 
AWP corresponding to boundaries of the mentioned sector. At the range increase, this 
error component may exceed the error caused by all other factors. 
For the fixed SR parameters in the AWP, the item of the measurement error 
caused by these reflectors is stable as well. Therefore, this component can be taken 
into account at device calibration. The instability of the SR parameters, for ex-
ample, under the influence of temperature or dust and moisture settling, leads to 
error variation. 
Figure 6.19  Plots of limited values of the normalized measurement error versus the relative range 
to the reflector in the free space at the SR presence in the AWP.

192	
Analysis of the Range Measurement Error at the Interference Presence
6.7  Influence of Combination Components in the Mixer of the FMCW 
RF on the Measurement Error 
6.7.1  Virtual Reflectors
Substantively existing varied clutter creates new interference due to the inevitable 
increase in combination components in the FMCW RF mixer [10, 11], in which the 
amplitude is connected with both the amplitude of spurious signals and the ampli-
tude of the useful signal. 
In general, the large number of waves reflected from AWP irregularities and the 
constructive elements of the reservoir and multiple-reflected waves are applied to 
the mixer input of the FMCW RF receiver. Nevertheless, the amplitude of multiple-
reflected waves decreases quickly with the increase of the number of consecutive re-
flections; therefore, we can usually neglect them. In this case, we can assume that the 
probing object is radiated by the generated wave and by accompanying flow of waves 
(AFW) containing items arising owing to single reflections from AWP irregularities. 
The local oscillator signal may contain a series of items arising due to reflections 
between the mismatched mixer input (on the local oscillator side) and the output of the 
circuit of local oscillator signal extraction. These items created interference as well. 
As a result of interaction of input signals, at the mixer output, the signal is 
formed containing an item with a multiplier cos([tsw(t) – js]) carrying information 
about range to the probing surface, and a variety of items An,intcos[(ts ± ntint)w(t)] 
of a significant amplitude with delays, which are more and less than the delay of 
informational item. 
Low-frequency components cos([tsw(t) – js]) and cos[(ts ± ntint)w(t)] usually 
cannot be resolved, as tint is usually less than the resolving capacity of the FMCW 
RF. These items are extracted in the form of an unresolved sum Ascos[tsw(t) – js] + 
An,intcos[(ts ± ntint)w(t)]. Therefore, low-frequency components An,intcos[(ts ± ntint)
w(t)] are spurious, which can be considered as the appearance of additional virtual 
clutter [10], in which the number essentially exceeds the number of irregularities in 
the AWP and in the nearest vicinity of the antenna. Accepting such a consideration, 
we may assume that the probing object is covered by a variety of closely located 
virtual reflectors, the number of which depends not only upon a number of irregu-
larities in AWP but also upon the mixer structure. 
We can note that virtual clutter, in which the delay is proportional to 2tint, 
passes without suppression to the output of the balanced mixer even at ideal sym-
metry (currents of both arms of the balanced mixer are summed in-phase), while 
virtual interference, in which the delay is proportional to tint and 3tint, is completely 
suppressed. This important result tells us that we cannot completely eliminate the 
measurement error caused by virtual interference.
Virtual reflectors surround the SR from two sides and the AFW creates ad-
ditional interference, in which the frequency is more than the frequency of the 
informational item. Thus, in the frequency band exceeding the frequency of in-
formational item, the combination interference and the interference caused by the 
AFW are formed.
Amplitudes and phases of virtual interference depend upon the amplitudes of the 
signal and interference and, hence, upon the measured range. Even for unchanged 
reflections from the AWP irregularities and stable parameters of generated signal, the 

6.7  Influence of Combination Components in the Mixer of the FMCW RF	
193
SIR for virtual interference depends on the signal amplitude and measured range, and 
therefore the degree of this dependence is defined by the power level of the radiated 
signal. 
Virtual clutter leads to the appearance of interference with thermal-dependent 
amplitude and phase. The dependence of this interference upon temperature arises 
due to the temperature function of volt-ampere characteristic of the nonlinear ele-
ment. The degree of this function is defined by the ratio of received signal power 
and the signal of the local oscillator. The mixer operation at the commensurable 
powers of the signal and the local oscillator leads to a strong temperature depen-
dence of the error [11].
Virtual reflectors situated near the useful reflector distort its spectrum and, as a 
consequence, lead to measurement errors. 
6.7.2  Influence of Virtual Clutter on the Range Estimation Error
The results presented in Chapter 3 are applicable to error analysis created by virtual 
interference. It follows from these results that if there is a single irregularity in the 
AWP, the function of frequency estimation error versus irregularity position has an 
oscillating character with fast oscillations, in which the period is connected with the 
average wavelength of the radiated signal, and slow oscillations, in which the view 
is defined by the used WF. 
The difference is manifested in the fact that oscillating plot is displaced from a 
zero level by a constant, which is defined by the range between the SR and virtual 
reflectors and by the ratio of amplitude and phase of considered signals. 
Figure 6.20 shows the function of the normalized measurement error versus the 
range between the virtual reflector and the UR equal to the range from the mixer to 
the single irregularity in the AWP. 
Figure 6.20  The plot of the normalized measurement error versus the normalized range between 
the virtual reflector and the UR. 

194	
Analysis of the Range Measurement Error at the Interference Presence
The signal amplitude from the virtual reflector was –10 dB from the amplitude 
of the useful signal. At the DFS processing, the DC WF was used with the parameter 
Q = 30 dB.
The periodic character of the plot at the range variation is kept; however, there 
is the constant displacement of the plot equal to the truncation measurement error 
corresponding to the analyzed range to the UR. 
At the unchanged reflection from the antenna, the measurement error compo-
nent caused by virtual clutter can be taken into account at calibration. The necessity 
of its elimination arises at the variation of reflection conditions and at the variation 
on the useful signal power and the signal caused by the virtual reflector. 
6.8  Conclusions
In the range-finders of the industrial application, the ratios between levels of the 
signal, interference, and noise are such that the main contribution into the measure-
ment error is made by interference, which may be created by the device itself and 
be received from the measurement region. Therefore, the error levels in the most 
practical situations exceed the admissible value, and it is impossible to eliminate 
interference in the general case. 
We gave a list of the most typical interference acting on the FMCW RF when 
using it as a level-meter. In most practical applications, the level-meters operate un-
der the conditions of the combined interference influence, and their negative effect 
on the measurement error is intensified by the presence of the larger number of the 
combination interference. We can achieve the combination interference level reduc-
tion due to the selection of the mixer operation mode.
The analysis of the measurement error function versus the single SR influence 
showed that the measurement error as a function of the range difference between 
the UR and the SR has an oscillating character (as the truncation error) but with 
doubled periods of fast and slow oscillations. Fast oscillations are limited by two 
envelopes, which form the slow oscillations. The analogy of the error behavior 
caused by interference and the truncation error allows the adaptation of minimiza-
tion algorithms of the truncation error to minimize the measurement error caused 
by interference. However, we should preliminarily estimate the possibility of its ap-
plication according to the results of interference situation analysis. 
The plot of the measurement error is symmetric with regard to the point cor-
responding to the zero range difference between the UR and the SR. The EE plot 
has two main lobes and the sequence of the SL. The SLL of the measurement error 
is practically proportional by the SIR and the SD SLL of the used WF. At the large 
SIR, the amplitude of main lobes is proportional to this SIR and depends upon the 
width of the WF SD main lobe as well. Narrowing of the SD main lobe of the used 
WF allows reduction and main lobe amplitudes of the measurement error function, 
but, at that, the SLL increases for the measurement error, which can lead to increase 
of resulting error under the influence of the combined interference. Therefore, the 
WF parameter choice is expedient to provide starting from an analysis of the inter-
ference situation. 

6.8  Conclusions	
195
The function of the measurement error versus the range difference between 
the UR and the SR shows that at ranges between the UR and the SR, less than 0.3 
from the QI value the error values limited by envelopes do not depend upon the 
FM range and the type of the used WF and are defined by the SIR only. The range 
increase between the UR and the SR more than QI leads to the situation that maxi-
mal error values become strongly dependent upon the FM range and the type of the 
WF used. In these cases, the expansion of the FM range leads to an error decrease 
due to the action of most of the interference.
The reduction of the interference error component due to a significant expan-
sion of the FM range is confronted not only with engineering difficulties, but also 
with problems of electromagnetic compatibility. Within this framework, the search 
for signal processing methods that allow error reduction is necessary.
References
[1]	 Cherenkova, E. L., and O. V. Chernushov, Radio Wave Propagation, Moscow: Radio i 
Sviaz Publ., 1984, 272 pp. [In Russian.]
[2]	 Levin, O. A., and S. K. Romanov, Frequency Synthesizers with the System of Pulse PLL, 
Moscow, Russia: Radio i Sviaz Publ., 1989. [In Russian.]
[3]	 Parshin, V. S., “Estimation of Pulse Interference Influence on Stationary Signal Recognition 
in the Spectral Domain,” Radio Elektronika, Vol. 42, No. 3, 1999, pp. 73–79. [In Russian.]
[4]	 Kobak, V. O., Radar Reflectors, Moscow: Sovetskoe Radio Publ., 1975, 248 pp. [In Russian.]
[5]	 Born, M., and E. Wolf, Principles of Optics. 4th edition. Oxford, London, Edinburgh, New 
York, Paris, Frankfurt: Pergamon Press, 1968.
[6]	 Dvorkovich, A. V., “Once More About One Method for Effective Window Function Cal-
culation at Harmonic Analysis with the Help of DFT,” Digital Signal Processing, No. 3, 
2001, pp. 13–18. [In Russian.]
[7]	 Davydochkin, V. M., and V. V. Ezerskiy, “Influence of Reflected Waves upon the Distance 
Measurement Error by FMCW Range Finder,” Vestnik RGRTA, Ryazan, No. 17, 2005, 
pp. 32–39. [In Russian.]
[8]	 Ezerskiy, V. V., I. V. Bolonin, and I. V. Baranov, “The Algorithm of Modulation Character-
istic Non-Linearity Compensation for FMCW Range Finders,” Vestnik RGRTA, Ryazan, 
No. 10, 2002, pp. 38–42. [In Russian.]
[9]	 Goldshtein, L. D., and N. V. Zernov, Electromagnetic Fields and Waves. 2nd edition. 
­Moscow: Sovetskoe Radio Publ., 1971, 664 pp. [In Russian.]
[10]	 Atayants, B. A., V. M. Davydochkin, and V. V. Ezerskiy, “Consideration of Antenna Mis-
matching Effects in FMCW Radio Range Finders,” Antennas, No. 12(79), 2003, pp. 23–27. 
[In Russian.]
[11]	 Davydochkin, V. M., “Virtual Interference Influence on the Error of Difference Frequency 
Estimation in FMCW Range Finder,” Vestnik RGRTU, Ryazan, No. 20, 2007, pp. 47–54. 
[In Russian.]


197
C h a p t e r  7
Reduction of the Measurement Error at 
Interference Presence Using Adaptable 
Weighting Functions
7.1  Introduction
An important feature of the FMCW RF of industrial application is an absence of 
intentional masking or withdrawing interference. The location and properties of the 
most interference can be defined in advance before the operation mode starts and 
therefore we can provide learning or make predictions according to the engineering 
specifications of those objects on which an FMCW RF is mounted.
A priori information about the interference situation in the FMCW RF operat-
ing zone is often used to decrease the range estimation error to the useful reflec-
tor. Before measurement performance during FMCW RF mounting on a specific 
object, one can perform estimation of amplitude and frequency of interference 
and record them in the memory of the FMCW RF computing device. In many 
cases, the necessary data can be obtained only on the basis of mathematical models 
of signals and interference adequate to relevant situations. It is clear that accurate 
determination of interference parameters would permit complete elimination of 
the range estimation error to the useful object. Nevertheless, accurate estimation 
is practically unrealizable and, moreover, interference parameters are unstable and 
often do not completely correspond to the mathematical model in the form of the 
finite sum of sinusoidal components (6.1). Therefore, the possibility of decreasing 
errors significantly depends on the interference situation. 
In any case at a range-finder operation under interference conditions, we need 
to answer to the following questions:
Is there an interference influence and how much is it?
1.	
How do we determine the displacement value caused by interference?
2.	
How do we make corrections of range indication by the value of the calcu-
3.	
lated error?
In addition, it is important that the answer to the first question allows the use of 
a sign of correct orientation of FMCW RF position during its mounting.
Practice shows that, depending on the SR source, the SIR can be changed in 
wide limits. For instance, at the FMCW RF using the liquid level measurement near 
the reservoir bottom, the value qs/i (depending on dielectric properties of the mate-
rial) can be significantly less than 1. For the reflection intensity from the reservoir 

198	
Reduction of the Measurement Error at Interference Presence
construction elements, its sidewall is such that qs/i > 0 dB. At the range measurement 
in the loaded reservoir, reflections take place between the reservoir roof, the level-
meter case, and the reflecting surface, in this case, qs/i > 6 to 20 dB.
The SR presence leads to the appearance of two additional components of mea-
surement errors:
The frequency of the beating signal will be defined with the error, whose 
1.	
value, as shown in Chapter 6, is defined by the degree of the mutual influence 
of the main lobes and sidelobes of useful and interference signal spectra.
The spurious signal can be accepted as the useful signal, which leads to 
2.	
anomalous measurement errors. 
Therefore, at the range measurement on the SR background, it is necessary to 
solve two problems:
The problem of choice from the SC’s assembly of this component, which is 
1.	
calculated according to the signal (6.1) and corresponds to the useful signal;
The problem of the DFS influence on the useful signal minimization corre-
2.	
sponding to the SR.
Both problems can be solved in general by means of minimization of some goal 
function F{S(t),SM(t)}, where SM(t) is some model signal. For minimization of the 
function F{S(t),SM(t)} for all 3M parameters (delay time, phases, and amplitudes of 
M DFS components), it is necessary to use methods of multiparameter optimiza-
tion, which require large computing expenses and do not allow us to obtain an 
unambiguous solution. Therefore, in this chapter and Chapters 8 and 9, we con-
sider the methods and algorithms of the SR influence minimization in various situ-
ations and on the basis of different approaches. Therefore, it is advisable to divide 
these methods into two groups. 
To the first group we attribute methods with a classical approach to problem 
solving based on the reduction of the measurement error by control of the WF 
shape with the purpose of decreasing the SR spectrum and SL influence on the use-
ful signal or at the analysis of such influence for a different WF shape, and introduc-
ing the correcting amendment. These methods will be discussed in this chapter.
In the second group we include methods that are connected (in varying degrees) 
with the construction of the model and with the application of parameter control of 
this model for the estimation of the measured range including a situation when the 
useful and spurious signal are not resolved. We call these methods parametric and 
they will be described in Chapter 8. 
7.2  Estimation of the Interference Situation
The application of software methods to decrease the measurement error requires an 
analysis of the interference situation in the FMCW RF operating zone. Therefore, 
it is required to detect the useful DFS on the SR background. The task becomes 
complicated by the fact that useful DFS and DFS generated by SR are identical in 

7.2  Estimation of the Interference Situation	
199
their structure and differ by amplitude and frequency only. In the situation when the 
useful DFS exceeds the signal from the SR in amplitude, the task of detection has no 
problems, but everything becomes complicated in the situation when the useful DFS 
becomes less than the signal from the SR. We can solve the task of detection of use-
ful DFS of the background of SL of SAD of the spurious reflection at its resolution 
and the account of a priori information about all the SR positions. Moreover, the 
account of such information is necessary for some algorithms decreasing interference 
influence. Thus, the problem of FMCW RF learning under conditions when the use-
ful reflector is absent in the operating zone is important. Therefore, it is necessary 
to determine a number of SRs to estimate their location in the FMCW RF operating 
zone and SIR qs/i for each of them. This will allow the determination of IEZ bound-
aries and the selection of the most suitable method of DFS processing, permitting 
the minimization of the range estimation error. Obviously, for the FMCW RF, such 
a problem can be solved in the simplest manner in the spectral domain.  
At the SR detection in the learning mode, it is necessary to solve the following 
tasks:
Because the SR detection is carried out on the background of noisy interfer-
1.	
ence, it is necessary to minimize the probability of acceptation instead of the 
noise overshoots (i.e., minimizes the probability of false alarm). 
To eliminate possibility of the SL spectra acceptation of adjacent reflectors 
2.	
as the spurious reflector. 
To estimate the frequency corresponding to each SR position. 
3.	
To estimate the SC amplitude for each SR. 
4.	
SR detection is advisable to perform the classical method used at detection 
in the spectral domain of separate harmonic components presenting in the signal 
specified on the finite time interval. Such a task is successfully solved with the help 
of the WF [1], when the standard procedure of a weak signal detection is used on 
the background of the strong signal. 
It is usually necessary to achieve the accepted measurement accuracy that the 
FMCW RF noise level is essentially less than a level of the weak useful signal. The 
applied WF should have the minimal SAD SLL at the specified width of the main 
lobe and at the specified SL decreased speed (optimal WFs). At the detection of the 
near located weakly reflected object on the background of strong spurious signal, 
the useful SAD item with the frequency x1 is significantly less than the spurious item 
with frequency x2 and is distorted mainly by the SL of two spurious SAD items S2 
with frequencies x2 and -x2 (for w > 0 and w < 0), and the influence of the item 
S1 with the frequency -x1 from the area w < 0 is insignificant. It is known that a 
choice of large values of WF Cs at the specified width of the main lobe leads to an 
inevitable increase of SL of each SAD item closed to the main lobe. In this situation, 
the increase of SL leads to a larger distortion of the main lobe of the SAD useful 
item. Therefore, to solve the problem, we should select the WF with a minimal 
value of Cs, at which the possibility to obtain the minimum SLL is ensured at the 
specified width of the mail lobe. 
One SR, which is always present in the short-range FMCW RF, is the reflection 
from the AWP elements. Under the conditions of a long effect of environment with 

200	
Reduction of the Measurement Error at Interference Presence
high contents of dust and moisture on AWP elements, the reflection coefficient of 
EMW from them due to deposits can increase to the value approaching unity. From 
(6.2), we can determine that for the most frequently used antennas with the gain 
about 20 dB, the SIR can decrease to -40 dB already at ranges between the antenna 
and the probing object corresponding to 3 and more in the frequency domain (at 
the FM sweep more than 500 MHz). Because the larger value of SIR simplifies sig-
nal detection, in the examples we shall use the value equal to -40 dB. 
The specification of SLL and the width of the WF main lobe for the first estima-
tion of ranges to UR and SR are defined by the ratio of SD item levels corresponding 
to probing objects and the range difference to UR and SR. For example, for the DC 
WF, the SLL Q-1 and a half-width of the main lobe on the zero level x0 are con-
nected by the relation: 
	
(
)
2
2
2
0
0.25
ln
1
x
Q
Q
π
=
+
+
-
	
(7.1)
Evidently, to detect the SR with the rough estimation of its parameters on the 
background of strong interference, the relative SLL of the used WF should be essen-
tially less than the minimal possible SIR with an account of coherent SL summation 
for w > 0 and w < 0. In the considered case, the SLL must be essentially less than 
–46 dB. The restriction of Q is defined by the above-mentioned minimal possible 
range between the positions of SR and UR limiting the width of the WF main lobe. 
For the DC WF with x0 = 0.625 . . . 0.69 (x1 – x2) for any x1 theoretically signals are 
already absolutely resolved at x1 – x2 ³ 4 with a minimal value of SAD dip between 
signal frequencies x1 and x2 more than 6 dB lower than the SAD item level of the 
weak signal. 
At the application of the optimal WF obtained on the basis of AWF (see the 
Appendix), taking into consideration of above-mentioned recommendations in the 
problem under consideration, we should use the WF with Cs = 6 dB/oct. From 
the Appendix, it follows that at the specified value of the AWF main lobe width, an 
increase of N allows for the SL reduction. The limit is the DC WF SLL. However, 
the AWF with Cs = 6 dB/oct at the minimal possible N for the specified Q essentially 
exceeding 46 dB loses to the DC WF in SLL only by 3 to 6 dB. Therefore, to solve 
the SR detection problem with roughly estimating its parameters on the background 
of strong interference, we may use the AWF beginning from N = 2 at the same value 
of the main lobe width as for the DC WF b1 = 0.625 . . . 0.69 (x1 – x2).
For example, Figure 7.1 shows the resulting signal SAD by solid bold lines 
relatively using the DC WF and the AWF with Cs = 6 dB/oct. The amplitude of the 
useful signal item with the relative frequency x1 = 7 is 40 dB less than amplitude of 
the spurious signal with the relative frequency x2 = 3. The SAD of the useful signal 
item with w > 0 is shown by the solid thin line. In the scale that is shown, the SLs 
of the spurious SAD item with the frequency x1 = -7 from the area w < 0 are not 
seen. The spurious SAD items for w > 0 and w < 0 from the spurious signal item are 
shown by the dotted and chain lines, respectively. Both WFs have the same width of 
the main lobe on the zero level equal to 5.5. The SLL of the DC WF SAD is –67.67 
dB, and the SLL of the AWF SAD with Cs = 6 dB/oct, N = 2, b1 = 2.75, and b2 = 
4.2111 is –61.7 dB.

7.2  Estimation of the Interference Situation	
201
We see from Figure 7.1 that both WFs ensure the extraction of the weak sig-
nal on the background of strong interference; therefore, the WF parameter choice 
shown provides a significant excess of SAD of the weak DFS item over the SL of 
the strong item. The application of the algorithm (3.4) in the range of the relative 
frequencies 6 to 8 after the UR detection leads to the normalized relative range 
errors weakly reflecting the UR equal to 0.136 using the DC WF and 0.2078 using 
the AWF with N = 2 and Cs = 6 dB/oct.
The SR detection in the FMCW RF operating zone has peculiarities. We con-
sider the case when the SR location is a priori unknown. We analyze the situation 
when there is a possibility of obtaining the DFS SAD at the UR absence or at its 
location in the very far point of the operating volume. It is clear that in this case the 
items from all SRs will be present in the resulting SAD, including reflections from 
the AWP. 
Figure 7.1  (a, b) The modulus of resulting signal SD and the modulus of its items with the respective 
frequency x1 = 7 and x2 = 3. 

202	
Reduction of the Measurement Error at Interference Presence
We assume that the SRs, for which the ratio qi/n,i = Gint(wi)/N0 is large enough 
(qi/n,i > 30 – 40dB), are detected with Probability 1, and that probabilities of the 
false alarm are equal to zero. This case corresponds to the situation in which the SR 
amplitude is commensurable with the amplitude of the useful signal. 
For the SR detection of small intensity in the learning mode, it is necessary to 
provide acceptable detection characteristics and to eliminate the possibility of accept-
ing the SD sidelobes of the reflection from the AWP as the SR. For this purpose, we 
may use the optimal detector [2] with some modifications. Using the distribution law 
(3.49) and assuming that the distribution of the SD estimation of the white noise is 
exponential with the parameter N0, we obtain the likelihood ratio for the ith SC:
	
(
)
0
0
0
exp[
(
)/
]
(
)
(
)/
i
i
i
i
G
N I
G
G
N
ω
ω
ω
L =
-

	
(7.2)
where (
)
i
G ω

 is the estimation of the DFS SC G(wi) on the ith frequency.
Because the functions I0 (z) and z are monotonic, after taking the logarithm 
of (7.2), we may obtain the decisive rule:  
	
(
)
i
G
h
ω
>
<

	
(7.3)
where h is the comparison threshold selecting from the Neyman-Pearson criterion 
[3]: 
	
h = h0N0/qi/n,i	
(7.4)
h0 = ln(1/F)/qi/n,i is the normalized threshold being the solution of the equation 
0
1( )
h W x dx
F
¥
=
ò
, W1(x) is the distribution law of noise PSD, and F is the probability 
of false alarm. 
To eliminate the possibility of mistaken acceptance of the SL reflection from the 
AWP as the SR, it is advisable to determine the SLL hSLL of the PSD of the reflection 
from the AWP according to the calculated spectrum and the used WF. Then we may 
determine the SCs, which in the electric range interval from the minimal to maximal 
correspond to the simultaneous performance of (7.3) and:
	
SLL
(
)
i
G
h
ω
³

	
(7.5)
All determined SCs can be considered as SRs. 
To calculate the quality performance for detection, we may recommend multi-
plying the SC of the white noise and the SC of the DFS by the nonrandom variable 
Gint(wi) (i.e., by the average value of the SR SD estimation). As a result of such a 
functional transformation, the exponential SC distribution of the PSD estimation of 
the white noise, and the distribution (3.56), we rewrite respectively in the form: 
	
(
)
1
i/n,
i/n,
2
i/n,
i/n,
0
i/n,
( )
exp(
),
( )
exp[
(
1)]
2
i
i
i
i
i
W x
q
q
x
W x
q
q
x
I
q
x
=
-
=
-
+
	
(7.6)
The calculated probabilities of the true detection D depending on the qi/n,i at 
different values of F are presented in Figure 7.2. From the curves of this figure, 

7.2  Estimation of the Interference Situation	
203
we may make a conclusion that the SR is detected with the probability practically 
equal to 1 at the probability of false alarm F = 10-10 in the case in which its intensity 
exceeds the noise level by not less than 18 dB.
The probabilities of false alarm, at which the functions in Figure 7.2 are calcu-
lated, correspond to the SR detection at each of frequencies, where the DFS spectrum 
is computed. The resulting probability of false alarm Ffa for frequencies wi where 
1 £ i £ I and I is the number of frequencies at which SR detection occurs is determined 
as: Ffa = 1 – (1 – F)I. For F = 10-12 at the DFS representation in the time domain by 
1,024 samples, the variable Ffa = 5.12 × 10–12 is the case when all SCs are used for SR 
­detection. It is clear that we cannot consider such a probability of false alarm. 
In the specific case of the FMCW RF application as a level-meter for liquid 
products, approaching the reflected surface level to the reservoir bottom leads to 
the fact that the SIR becomes less than 1. For instance, for some types of mineral 
oil, the intensity of the reflection from the bottom becomes more than the intensity 
of the useful signal at the range of 2 m to 3 m from the bottom (for carrying the 
signal frequency of 10 GHz). Nevertheless, this circumstance does not introduce 
significant peculiarities in the DFS frequency measurement in the case when spectra 
are nonresolvable in frequency. The electrical range to the bottom is always more 
than the true range, which allows simply enough to identify the reflection source as 
the maximal SC of the useful DFS spectrum is always located on a frequency less 
than the maximal SC of the DFS spectrum corresponding to the reflection from the 
bottom. Challenges with DFS frequency measurement arise in the case when the 
spectra of useful and interference signals are not resolvable. 
After the SR detection, we need to determine the IEZ value. In the case when 
one SC detection threshold exceeds the IEZ boundary (see Chapter 6), we may 
choose (with recalculation into the range) in the size Rint,i ± 9dR, where Rint,i is the 
range to the ith SR calculated according to the SC frequency estimation satisfying 
(7.3) and (7.5). In the case when several adjacent SCs satisfy the conditions (7.3) 
and (7.5), IEZ size will be determined by the frequency range, on which there are 
detected SCs increased in each side by the value 9dR.
Figure 7.2  Detection characteristics of the SR.

204	
Reduction of the Measurement Error at Interference Presence
In the operating mode of the range measurement to the UR at the SR presence, 
the signal from which exceeds the UR level, its detection is provided on the basis of 
the same algorithms (7.3) and (7.5), but beyond IEZ only. 
7.3  Error Minimization of Frequency and Amplitude Estimation of the 
Weak Signal on the Background of Resolvable Single Interference 
7.3.1  Introduction
Interference properties (see Chapter 6) can significantly differ, but it is most impor-
tant to estimate the range to probing the surface, the resolving of interference, and 
the probing object and to determine which algorithm ensures less error in the spe-
cific case. Therefore, independently on the interference type, we consider the possi-
bility of decreasing the error caused by the resolvable interference at difference fre-
quency estimation according to the spectrum maximum supposing that the main EE 
SD lobe exceeds the SLL of interference. At the estimation of the DFS, useful item 
parameters on the background of single interference two items remain in (6.1).
In the case of the FMCW RF application as the level-meter for weakly reflecting 
liquids, the amplitude of the useful signal can be essentially less than the amplitude 
on the interference created by encapsulation inserts in an antenna or by the reservoir 
bottom. In such a case, it is advisable to analyze the possibility of the range estimation 
error reduction both to the UR and to the SR. On the basis of range estimation results 
to the SR and the amplitude-phase parameters of spurious SC, the correction of the 
measured range to the UR is possible as well as the estimation of the device’s state, for 
instance, estimation of antenna dirtying degree [4]. The approximate SR position in 
the AWP can be estimated at the calibration stage or during the device’s learning. 
The range to the reservoir bottom and the relative estimation of this range may 
change due to reservoir deformation owing to temperature variation, pressure vari-
ation inside the reservoir, mechanical influence of the material to the reservoir walls, 
and other factors. In addition, the dielectric permeability of the probing product 
can be changed as well as the electrical range to the reservoir bottom.
In any case, due to the interference of a large level, before the range measure-
ment to the UR, the above-mentioned problem of the DFS SC detection correspond-
ing to the useful and spurious SAD items with rough estimation of their parameters 
should be solved. As a result, the useful and spurious SAD items with the maximal 
SCs 1
S

 and 2
S

 on the frequencies 1
x  and 2
x  will be detected.
7.3.2  Minimization of the Range Measurement Error for Weakly Reflecting 
Liquids
This task arises at the interference presence of the large level from the encapsulating 
insert in the AWP. We assume that the approximate SR position in the AWP is known. 
From the operation conditions of the reservoir, the loading liquid and the maximal 
level of its loading are usually known. From these conditions, the necessary height 
of the FMCW RF mounting is determined to ensure resolution in the frequency of 
DFS items caused by the reflection from the AWP and from the liquid surface at the 
maximal possible loading of the reservoir. The minimal possible measuring range, 

7.3  Error Minimization of the Weak Signal	
205
­the reflection coefficient of EMW from the liquid surface, and, hence, on the basis of 
(6.2), the minimal possible SIR, become known as well. Therefore, each item in (6.1) 
plays the part of deterministic interference at the parameter estimation of the other 
DFS item. Then the error is due to the noise and the SL of three DFS SCs, from which 
one ­spurious item is located at w > 0 and two items in the area w < 0. 
We suppose that the detection problem of DFS SC and parameter estimation is 
solved in advance and, as a result, the spurious and useful SAD items with maximal 
SCs (0)
1
S

 and (0)
2
S

 on frequencies (0)
1
x
 and (0)
2
x
 are detected.
Let us determine the possibility of error reduction for the normalized range x1 
and x2 estimation by the algorithm, which is similar to that analyzed in Chapter 
3: the minimization algorithm for the truncation error. We assume that the DFS 
contains two items, one with the normalized frequency x1 = 3 and the unitary 
amplitude, and the other one with an amplitude lesser by 40 dB, corresponding to 
the UR with a normalized frequency x2 = 10.
The process of the necessary WF parameter determination is iterative with a mul-
tiple repeat of calculations and specification of values b1, b2, …, bn on each iteration 
to decrease the absolute value of difference between newly received values ( )
1
n
x
 and 
( )
2
n
x
, and previous values 
1
(
)
1
n
x
-

 and 
(
1)
2
n
x
-

 lower than specified in the advance value 
( )
(
1)
1
1
1
n
n
x
x
x
-
-
£ D


 and 
( )
(
1)
2
2
2
n
n
x
x
x
-
-
£ D


. In general, Dx1 and Dx2 may be different.
The frequency estimations of all SAD parameters of the model (6.1) displace 
due to its mutual influence. To minimize the frequency estimation error of any 
items, the applied AWF should ensure obtaining zero SAD with an order of not less 
than 2 on four frequencies corresponding to the difference of the estimated posi-
tions of the SAD item maxima. Therefore, all SAD items should be resolvable in 
frequency. In the considered example, this algorithm gives a zero error component 
caused by the mutual influence of the UR and SR SAD items at any x1, but for 
(0)
(0)
(0)
1
2
1
6.5
x
x
x
D
=
-
³



.
Figure 7.3 shows the SAD of the useful DFS item with the frequency x1 = 10 identi-
fied by the thin solid line, the SAD of the resulting DFS with the frequency of spurious 
item x2 = 3 identified by the solid bold line using the AWF with Cs = 6 dB/oct, N = 8 
and b1 = b2 = 6, b3 = b4 = 7, b5 = b6 = 13, and b7 = b8 = 20, and the SAD difference 
(multiplied by 1,000) of the resulting and useful signals identified by the dotted line. 
Figure 7.3  The SAD of the useful signal with the relative frequency xl = 10 (thin solid line), the 
resulting signal with interference on the frequency x2 = 2 (bold solid line) and multiplied by 1,000 
modulus of SAD difference of resulting and useful signals (dotted line).

206	
Reduction of the Measurement Error at Interference Presence
It follows from Figure 7.3 that at x1 – x2 = 7 the AWF with the mentioned 
parameters ensures the accurate frequency and amplitude estimation of the weak 
signal on the background of strong interference due to the distortion absence by the 
interference SAD item on this frequency. 
7.3.3  Action Sequence at the Level Measurement of the Weakly Reflecting 
Material Near an Antenna
The action sequence is the following:
Step 1:
• 
 According to the signal samples recorded in the memory, we calculate 
the SAD for the chosen AWF and determine the maximum positions of the 
spectrum modulus, the zero approximation for (0)
1
x
 and (0)
2
x
, and the ratio of 
intensities of the DFS items.
Step 2:
• 
 The zero approximations for 
(0)
(0)
(0)
1
1
2
x
x
x
D
=
-



, 
(0)
(0)
2
1
2
x
x
D
=


, 
(0)
(0)
3
2
2
x
x
D
=


, and 
(0)
(0)
(0)
4
2
1
x
x
x
D
=
+



 are calculated.
Step 3:
• 
 The values of 
(0)
(0)
(0)
1
2
1
b
b
x
=
= D
, 
(0)
(0)
(0)
3
4
2
b
b
x
=
= D
, 
(0)
(0)
(0)
5
6
3
b
b
x
=
= D
, 
and (0)
(0)
(0)
7
8
4
b
b
x
=
= D
 are specified.
Step 4:
• 
 According to the signal samples recorded in the memory, we calculate 
the next and nth approximations ( )
n
ix
 at the specified AWF parameter values 
(
1)
(
1)
(
1)
1
(
1)/2
n
n
n
i
i
i
b
b
x
-
-
-
+
+
=
= D
.
Step 5:
• 
 Steps 2 to 4 are repeated before the performance of the condition 
( )
(
1)
1
1
n
n
x
x
x
-
-
£ D


 and 
-
£ D
( )
(
1)
2
2
n
n
x
x
x
-


.
Step 6:
• 
 Amplitudes and phases of each item are estimated. 
If N = 8, all SAD items can be resolved in frequency and in four frequencies 
corresponding to the difference of the estimated positions of the SAD item maxima, 
and this ensured obtaining the SAD zero with an order of not less than 2. In this 
case, the algorithm shown theoretically allows without noise obtaining the zero 
error for 2 £ x1 £ 4 and x1 – x2 ³ 6. If x1 > 4, and then the algorithm ensures error 
minimization at x1 – x2 > 6.5.
However, there are a variety of problems when it is required to estimate the 
range to the weakly reflecting object located essentially closer to the antenna. In 
this case, it is necessary to neglect the weak SAD item influence from the area w < 0 
with the coordinate -x1 upon the error estimation of the weak SD item from the 
area w > 0 with the coordinate x1 to increase the zero order of the SD item with the 
coordinate x2 in the area x = x1. In the Appendix it is shown that an increase of a 
number of items N of the AWF at the specified values b1 < N – 1 and b1 – b2 > 1 
can lead to an SL increase in the interval [b1,b2] and relatively to an increase of the 
estimation error. This is especially true with a difference frequency estimation of 
the DFS weak item on the background of a strong item near a resolution boundary 
in the range. In this case, it is important to decrease the error at minimal N or to 
determine N at an admissible error level in the range interval from the minimal pos-
sible to 
(0)
(0)
(0)
1
1
2
6.5
x
x
x
D
=
-
³



, when we can use the above-mentioned algorithm of 
accurate frequency estimation. Then we consider only the task of determining N in 
the interval 
(0)
(0)
(0)
1
1
2
x
x
x
£ D
=
-
£



4
7.

Varying N, we determine the admissible error level of the normalized range 
estimation of x1 and x2 according to the DFS, one item with fixed normalized 
frequency x2 = 3 and unitary amplitude corresponding to the reflection from the 
antenna, and the other item with amplitude by 40 dB less corresponding to the SR 
with normalized frequency varying from x1 = 7 to x1 = 10.5.
Taking into account the coincidence shown earlier of theoretical results with 
numerical experiments in the task under consideration, we give the simulation 
results only. Among the known WFs, the KB WF is the best for the resolution of 
two signals and for parameter estimation of signal items at an increase of x1. There-
fore, we give for comparison the calculation results using the AWF and KB WF on 
the basis of developed iterative procedures ensuring the error minimum. The results 
obtained in accordance with an approach similar to the above-mentioned one for 
the AWF with different N from 3 to 8 and a different distribution of specified zeros 
are shown in Figure 7.4. 
Figure 7.4  Plots of the normalized MSD logarithm of the estimation DFS error weighted by 
the KB WF and AWF: (a) 
-
-
+






1
2
1
2
1
2
(
,
,
)
s
w
x
x
x
x
x
x
 with N = 3 and (b) 
-
-
-






1
2
1
2
1
2
(
,
,
,
s
w
x
x
x
x
x
x
x 
-
+
+








1
2
2
2
1
2
1
2
,2
,2
,
,
)
x
x
x
x
x
x
x
x
 with N = 8.
7.3  Error Minimization of the Weak Signal	
207

208	
Reduction of the Measurement Error at Interference Presence
The application of the AWF with a minimal number of varied parameters N = 3 
[Figure 7.4(a)] provides an advantage on the level of the frequency estimation error 
of the DFS items over the KB WF achieving several orders only near the signal 
resolution boundary x2 – x1 < 6. The increase of frequency of the weak item leads 
to practically the same results of the DFS item frequency estimation for both WFs. 
The increase of the AWD-varying parameter number N [Figure 7.4(b)] allows some 
more reduction of the estimate error. From a comparison of Figure 7.4, we see that 
the frequency estimation error of the weak signal near the resolution boundary (x2 – 
x1 » 4.5) decreases by more than three orders with the number increasing the varied 
parameters of N from three to eight. We note that in accordance with the above-
mentioned notes the AWF zero order in the frequency area 1
2
3
4
1
2
b
b
b
b
x
x
=
=
=
=
-

  
was increased to 4 owing to the elimination of the varied zeros on the frequency 
1
2x  to obtain Figure 7.4(b). At a reliable signal resolution (x2 – x1 » 7), the benefit 
with an increase of a varied parameter number decreases to 1.5 orders.
The noise presence in the signal does not exclude the possibility of adaptive 
reduction of estimation errors both for the KB WF and AWF. However, the differ-
ence of the minimal achievable levels of error decreases near the boundary of signal 
resolution and for reliable signal resolution x1 – x2 > 6. Therefore (depending on 
the noise level), results are varied for the AWF application with a different number 
of varied parameters (Figure 7.5). For a relatively high noise level (qs/i = 20 dB for 
a weak signal item), the AWF advantage is demonstrated with small (N = 3) num-
ber of varied parameters (Figure 7.5), forming about 100 times near the boundary 
of signal resolution, which decreases to 1 at the frequency difference of the signal 
items x2 – x1 » 5 and slowly increases to 1.25 at a further increase of the difference 
frequency to 7. Under these conditions, the AWF with a number of varied param-
eters equal to 8 has an advantage over the KB WF only near the resolution bound-
ary x2 – x1 £ 4.5 (figure is not shown).
Such a function of the resulting error is caused by prevailing influence of trun-
cation component at a small frequency difference and by prevailing the noise com-
ponent at a large frequency difference. At a noise level reduction up to –60 dB with 
Figure 7.5  Plots of the normalized MSD logarithm of the estimation error of the difference frequen-
cies of the DFS weighted by the KB WF and AWF 
-
-
+

 
 

2
1
2
1
2
1
(
,
,
)
s
w
x
x x
x x
x  with N = 3: q = 20 dB.

regard to a weak DFS item, the AWF advantage begins to increase, especially near 
the boundary of signal resolution. 
At the amplitude estimation of signal items, the application of the AWF even with 
a small item number N = 3 allows the reduction of the truncation component of the 
error up to 6 orders near the resolution boundary compared to the KB WF [Figure 
7.6(a)]. The growth of the number of items increases the AWF advantage. The rela-
Figure 7.6  Plots of the normalized MSD logarithm of amplitude item estimation of the DFS 
weighted by the KB WF and AWF 
2
1
2
1
2
1
(
,
,
)
s
w
x
x x
x x
x
-
-
+

 
 
  with N = 3: (a) without noise and 
(b) with a noise of 20 dB.
7.3  Error Minimization of the Weak Signal	
209

210	
Reduction of the Measurement Error at Interference Presence
tively high noise level (qs/i = 20 dB with regard to the weak DFS item) decreases the 
AWQF advantage from 10 times near the resolution boundary to 1 at the frequency 
difference of DFS items x2 – x1 » 5, which then slowly increases about to 1.1 for a 
further increase of the difference frequency of the DFS items to 7 [Figure 7.6(b)].
7.3.4  Range Measurement on the Background of Strong Reflection from a 
Reservoir Bottom
It follows from the results of Chapter 6 that at range measurement to the surface of 
the weakly reflecting radio transparent liquid on the background of strong reflec-
tion from a reservoir bottom, the WF ensuring Cs = 12 dB/oct is the best option. 
It is caused by significant reduction of the SAD item SL with frequencies -x2 and 
-x1 from the area w < 0. In this case, algorithm simplification is possible for sig-
nal parameter estimation and reduction of varied parameter number due to the 
natural decrease of the SLL of spectrum items on the frequencies w < 0 for x1 >> 1 
and x2 >> 1. As an example, we may give parameters of the optimal WF with Cs = 
12 dB/oct, N = 2, b1 = 2.75, and b2 = 3.37145. For the maximal SAD SLL equal to 
–60.7 dB, this WF on the relative frequency ensures about -98 dB. 
Because in this case we may neglect the spectrum items for w < 0, the estimation 
of the signal component frequency can be carried out by algorithms (considered in 
Chapter 3) of minimization of the truncation error of the range estimation on the 
noise background. The difference consists in the determination of the specified AWF 
parameter (0)
(0)
(0)
2
1
N
b
x
x
=
-


 and its further specifications ( )
( )
( )
2
1
n
n
n
N
b
x
x
=
-


.
If the maximum SLL of WF is commensurable with the SLL of the WF on 
the difference of relative frequencies 2½x2 – x1½, we cannot completely neglect the 
spectrum items in the negative frequency area. If, at that, the relative range essen-
tially exceeds 1, then the previous algorithm of error decrease due to the SL of 
one SD item is added by the procedure of the SD SL item suppression for w < 0 
determined according to the initial estimation considered above. In this case, fre-
quency increase of signal items provides additional reduction of estimation errors 
practically to the level of the truncation error analyzed in Chapter 3. Therefore, it 
is enough to have three varied AWF parameters, two of which ( )
( )
( )
( )
1
2
2
1
n
n
n
n
b
b
x
x
=
=
-


 , 
and the third of which 
( )
( )
( )
( )
( )
1
1
2
3
2
1
1
2
(
)
n
n
n
n
n
b
x
x
x
x
A
A
A
»
+
+
-
+




 for x1 ³ x2 or 
( )
( )
( )
( )
( )
2
1
2
3
2
1
1
2
(
)
n
n
n
n
n
b
x
x
x
x
A
A
A
»
+
+
-
+




 for x2 > x1.
7.4  Error Reduction of Difference Frequency Estimation of the Signal 
Received on the Background of Nonresolvable Interference
7.4.1  The Situations Most Often Met in Practice
The situations most often met in practice are the following:
Consideration of synchronous range variation to the SR and to the UR is 
1.	
typical for the FMCW RF application for level measurement on objects 
within the oil-chemical industry in the case of the FMCW RF mounting near 
a reservoir wall, which was analyzed in Chapter 6.

7.4  Error Reduction of Difference Frequency Estimation	
211
Widespread application of the industrial FMCW RF is the level measurement 
2.	
in takeoff lines or directing tubes of pontons, which play the role of mul-
timode waveguides for the FMCW RF. In this case, waves of higher modes 
influence the range estimation error due to different phase velocities. As in 
the previous example, connections between useful signal delays and mani-
fold interference can be determined with a small error. However, phases and 
amplitudes of higher modes depend on whether the condition of the internal 
surface of tubes are unstable.  
Fixed positions of interference can be estimated and recorded into the FMCW 
3.	
RF memory at the stage of learning. However, interference parameters do 
not remain constant during the operation process and therefore we should 
take into account their instability. 
7.4.2  The Method of Error Decrease
The unambiguous connection of ranges to the UR and SR and the interference 
amplitude and shapes of WF SAD with the range estimation error to the useful 
object at range measurement according to SAD maximum are determined by (3.16) 
and (3.17), considered in Chapter 3. This connection gives the possibility of formu-
lating the inverse problem according to the specified set of WF parameters, of which 
the SAD is known, and according to the estimated ranges corresponding to this set 
of WF parameters to determine the range to the useful object. In such a formula-
tion, (3.16) and (3.17) give a system of nonlinear equations, for which an analytical 
solution cannot be possible in the closed form.
To reduce errors, we note that the dependence of (3.16) and (3.17) versus the 
range to the UR and SR has an oscillating character and passes through the sequence 
of points in which the estimation error is absent. 
Figure 7.7 illustrates the theoretical functions of the range estimation error and 
the error envelopes versus measured range. The signal is weighted by the uniform 
Figure 7.7  Envelope curves and range estimation errors. 

212	
Reduction of the Measurement Error at Interference Presence
WF (curve 1) and the Blackman WF (curve 2). The functions of error envelopes are 
curves 3 and 4, respectively. In Figure 7.7, the normalized range to the SR is equal 
to 10 and qs/i = 14 dB. 
At high SIR (qs/i ³ 14 to 20 dB), the positions of points of accurate range esti-
mation do not depend practically upon the WF SAD shape. Between these points, 
the error value is defined by the range difference between the UR and SR, the ratio 
of their amplitude and properties of the used WF. Narrowing of the WF SAD main 
lobe allows the error reduction caused by a nonresolvable object (in range) but at 
the expense of an error increase caused by the distant SR. 
Differences in range estimation according to the signal processed by the WF 
with a different width of the main lobe are a sign of interference influence on the 
range estimation. The application of this sign allows us to obtain the equation for 
the result correction of the range estimation from (3.16) and (3.17).
The variation of the WF SAD shape leads to the variation of the estimation 
result xest1(*) and Dxest2(*) by the value 
	
est
1
2
1
2
s/i
est1
1
2
1
s/i
est
1
2
1
2
s/i
(
,
,
,
,
,
)
(
,
,
,
,
,
)
(
,
,
,
,
,
)
m
m
m
m
x
x x
b
b
q
x
x x
b
b
q
x
x x
b
b
q
+
D
=
-
…
…
…
	
(7.7)
where b1, . . . ,bm and bm + 1, . . . ,b2m are sets of specified normalized ranges in the 
AWF, xest1(*) and xest2(*) are the results of the range estimation to the useful object, 
respectively, with the first and second sets of the AWF parameters, and x1 and x2 are 
the ranges to the UR and SR, respectively. The recommendations for choosing the 
AWF parameter set are given next. 
Thanks to an adequately stable position of points in which the estimation error 
is absent (on the level of qs/i ³ 14 to 20 dB), the range error variation is proportional 
to the EE variation. 
Hence, using range estimation variation with different WFs and a priori infor-
mation about interference position and theoretical functions of the EE variation, 
we can obtain an approximate value of the correcting amendment of the range 
estimation
	
corr
1
2
1
2
1
2
s/i
est
1
2
1
2
s/i
1
2
1
2
s/i
(
,
,
,
,
,
,
)
(
,
,
,
,
)
(
,
,
,
,
)
m
m
m
x
x x
x x
b
b
q
x
x x
b
b
q
K x x
b
b
q
D
= D
´


…
…


…
	
(7.8)
where 
	
2est,th
1
2
1
2
s/i
1
2
1
2
s/i
1est,th
1
2
1
s/i
2est,th
1
2
1
2
s/i
(
,
,
,
,
)
(
,
,
,
,
)
(
,
,
,
,
)
(
,
,
,
,
)
m
m
m
m
m
m
x
x x
b
b
q
K x x
b
b
q
x
x x
b
b
q
x
x x
b
b
q
+
+
D
= D D
- D


…


…




…
…
is 
the 
correction 
coefficient 
and 
1est,th
1
2
1
s/i
(
,
,
,
,
)
m
x
x x
b
b
q
D


…
 
and 
2est,th
1
2
1
2
s/i
(
,
,
,
,
)
m
m
x
x x
b
b
q
+
D


…
 are the theoretical EE of the range estimation 
with the first and second sets of the AWF parameters calculated using estimations. 
The EE asymmetry of positive and negative values leads to the necessity of enve-
lope choice depending on a sign of estimation difference. To simplify the algorithm, 
we may sacrifice an achievable minimum of the resulting error and assume that the 
denominator of the correcting coefficient is equal to the average value of envelope 
difference modulus 

	
{
}
est,th
1est,th+
1
2
1
s/i
2est,th+
1
2
1
2
s/i
1est,th
1
2
1
s/i
2est,th
1
2
1
2
s/i
0.5
(
,
,
,
,
,
)
(
,
,
,
,
,
)
(
,
,
,
,
,
)
(
,
,
,
,
,
)
m
m
m
m
m
m
x
x
x x
b
b
q
x
x x
b
b
q
x
x x
b
b
q
x
x x
b
b
q
+
-
-
+
D
=
D
- D
+ D
- D




…
…




…
…
	 (7.9)
where 
1est,th+(*)
x
D
, 
2est,th+(*)
x
D
, 
1est,th (*)
x
-
D
, and 
2est,th (*)
x
-
D
 are the positive and 
negative values of the theoretical EE functions. Therefore, we write the approxi-
mate value of correcting coefficient as: 
	
2est,th
1
2
1
2
s/i
est,th
(
,
,
,
,
,
)
m
m
x
x x
b
b
q
K
x
+
D
=
D


…
	
(7.10)
The resulting error and estimation of normalized range will be defined, respec-
tively, by the following equations:
	
1
2
1
2
1
2
s/i
est
1
2
1
s/i
corr
1
2
1
2
1
2
s/i
(
,
,
,
,
,
,
,
)
(
,
,
,
,
,
)
(
,
,
,
,
,
,
,
)
m
m
m
x
x x
x x
b
b
q
x
x x
b
b
q
x
x x
x x
b
b
q
S
D
= D
- D


…
…


…
	
(7.11)
	
1
est
1
2
1
2
s/i
corr
1
2
1
2
1
2
s/i
(
,
,
,
,
,
)
(
,
,
,
,
,
,
,
)
m
m
m
x
x
x x
b
b
q
x
x x
x x
b
b
q
+
=
- D



…
…
	
(7.12)
The possibility of an error decrease is illustrated in Figure 7.7 by curve 5 for 
qs/i = 14 dB and by curve 1 in Figure 7.8 for qs/i = 34 dB, in which the functions of 
the corrected estimation errors are presented in the assumption of the fixed range 
to interference knowledge performed at the learning stage. 
The typical feature of the range estimation result correction is the progressive 
error decrease with qs/i increasing, which is seen from the comparison of Figures 7.7 
and 7.8, in which curve 2 corresponds to the noncorrected range estimation error. 
Figure 7.8  The plots of the noncorrected range estimation error according to the signal weighted 
by the uniform WF (curve 2) and corrected estimation (curve 1) for qs/i = 34 dB.
7.4  Error Reduction of Difference Frequency Estimation	
213

214	
Reduction of the Measurement Error at Interference Presence
This method of correction at the noise presence cannot fully eliminate the inter-
ference influence on the range estimation error due to the solution instability in the 
vicinity of the range coincidence point to the UR and SR, when range estimations 
do not necessarily depend on the WF shape. Moreover, the range estimation dif-
fers from the exact value. Therefore, as mentioned earlier, the possibility of error 
decrease significantly depends on the following interference situations: 
Situation 1:
• 
 Liquid level variation in the reservoir accompanies the synchro-
nous variation of ranges to the UR and SR and the difference range measure-
ment error for them is insignificant. If neglecting the antenna PC distortions, 
the range estimation difference to the UR and SR will be determined by the 
evident equation
	
2
1
1
(
)
2(
)
L
L
x
x
x
x
x
D
»
+ D
+ D
	
(7.13)
where xL and DxL are the normalized range from an antenna to the reservoir wall 
and the error of its determination. 
In this case, the error of the correcting amendment determination is insignifi-
cant and is defined by the range estimation error to the reservoir wall DxL (a small 
value as xL can be measured with a standard application) and the range estimation 
error to the UR Dx1. If we do not take into account the antenna DP, the resulting 
error in the scale used in Figures 7.7 and 7.8 is indistinguishable with the error 
obtained in the assumption of a known range to the SR. 
Situation 2:
• 
 The error of correcting amendment determination is also insig-
nificant due to a practically deterministic connection of delays of the main 
and higher modes.
Situation 3:
• 
 Under interference influence, the ranges 
1
x  and 
2
x  are deter-
mined with the error and it results in the estimation error K
 appearance. 
Figure 7.9 shows the estimation K function versus the range to the UR x1 
with an ­account of the error of its determination for x2 = 10 and qs/i = 14 dB 
(solid line) and for qs/i = 34 dB (dotted line).
We see that that the error of the correcting amendment determination increases 
at the approach of the UR and SR and therefore it has a sharply oscillating char-
acter. As a result, the range error to the UR is not specified at the effect of the 
interference closed in range. In the x1 area less than 10.52, the narrow error 
overshoots are observed in Figure 7.10 corresponding to overshoots in the plot of 
the correction coefficient in Figure 7.9. Significant range specification begins for 
x1 – x2 ³ 0.55.
The essential error of the correcting amendment determination defines the limi-
tations on the application area of the method of correction results by the range dif-
ference to the UR and SR Dx ³ 0.5 for qs/i £ 26 dB. At qs/i > 32 dB, the limitations 
on the application area of the correction method are taken away. Looking ahead, 
we note that if we introduce limitations on K, the correction of range estimation 
results can also be used at a large interference level. The application of correction 

for experimental data processing (Chapter 9) gives positive results for qs/i = 14 dB. 
In this case, anomalous large errors of the corrected estimation are limited inside 
the range Dx £ 0.5 by the level of noncorrected estimation. The correction coef-
ficient should be limited on the level of 2.5 to 4.
From theoretical results, it follows that due to low sensitivity to errors of SIR 
determination under conditions, which are adequate for the first and second situa-
tions, the range estimation error reduction can ensure the following algorithm. 
Figure 7.9  Plots of the correction coefficient estimation versus the range to a useful object x1 with 
an account of the error of its determination for x2 = 10 for qs/i = 14 dB (solid line) and for qs/i = 34 
dB (dotted line).
Figure 7.10  Plots of the noncorrected range estimation error according to the signal weighted 
by the uniform WF (line 1) and the corrected estimation using the exact value of K (line 2) and the 
estimation of 

k (line 3) for qs/i = 14 dB.
7.4  Error Reduction of Difference Frequency Estimation	
215

216	
Reduction of the Measurement Error at Interference Presence
7.4.3  The Algorithm of Estimation Error Reduction: The Sequence of Actions 
to Decrease the Range Estimation Errors 
The following are the steps to decrease the range estimation errors:
Step 1:
• 
 Estimation of the normalized range xest(x1,x2,b1, . . . ,bm) according 
to the spectrum maximum with the first set of AWF parameters. 
Step 2:
• 
 Estimation of the normalized range xest(x1,x2,bm + 1, . . . ,b2m) accord-
ing to the spectrum maximum with the second set of AWF parameters.
Step 3:
• 
 Determination of range estimation difference Dxest(x1,x2,b1, . . . ,b2m,qs/i) = 
xest(x1,x2,b1, . . . ,bm,qs/i) – xest2(x1,x2,bm + 1, . . . ,b2m,qs/i).
Step 4:
• 
 Determination of the correcting multiplier 
1
2
1
2
(
,
,
,
,
,   )
m     s/i
K x x
b
b
q


…
 
­according to envelopes of the theoretical error functions for used WFs.  
Step 5:
• 
 Determination of the correcting amendment (7.8) on the results of 
steps 3 and 4. 
Step 6:
• 
 Calculation of the corrected range (7.12).
The actual correction method is based on the estimation result variation. Because 
the estimation range difference is included in the denominator of the correcting mul-
tiplier, it is clear that the WFs should be chosen from the condition of maximal dif-
ferences of two range estimations for any nonresolvable values of x1 and x2 for the 
maximal differences in the shape of the WF SAD main lobe. It follows from the AWF 
properties that for specified N and the given width of the WF SD main lobe on the 
zero level, the differences in SAD shape are defined by the width of the main lobe on 
any level that is not equal to zero. It follows from here that the WFs should be maxi-
mally differed by a specified speed of the SL decrease Cs and, hence, by the distribu-
Figure 7.11  Plots of the logarithm modulus of the AWF SD: 1 denotes ws(t,4,4,4,4,4,4) and 2 
­denotes ws(t,4,¥,¥,¥,¥,¥).

7.5  Error Decrease Caused by the Virtual Reflector	
217
tion of the specified AWF. Figure 7.11 shows the modulus of the SAD ­logarithms of 
two AWFs with N = 6 satisfying this condition. For one measurement, the positions 
of six varied AWF zeros are specified on normalized frequency 4 and for the second 
measurement, the position of one varied zero is specified on frequency 4 and the 
position of five other zeros is specified on an infinite frequency. Therefore, for a given 
N = 6 and for the specified width of the main SAD lobe on the zero level equal to 8, 
the differences in the main lobe SAD shapes are maximal. 
For a situation with fixed interference position, the application of a specific 
algorithm is possible at a difference of the normalized range to the UR and SR 
x1 – x2 ³ 0.5.
Thus, the variation of range indications at the frequency calculation according 
to the similar recorded data array with different WFs provides answers to the fol-
lowing questions: 
How is the interference influenced?
1.	
How do we estimate the displacement value caused by interference? 
2.	
How do we correct the range estimation of the FMCW RF position on the 
3.	
value of the calculated error? 
How do we use a sign of range estimation variation for the correct orienta-
4.	
tion of the FMCW RF position at its mounting? 
The answers to the first and fourth questions can be obtained at qs/i ³ 6 dB, and the 
answers to the second and third questions can be obtained at qs/i ³ 14 dB.
7.5  Error Decrease Caused by the Virtual Reflector
We can eliminate the increased error caused by the virtual reflector with the help 
of the method described in Chapter 3, adaptive control of modulation parameters 
and WF, which neutralizes influence of the virtual reflector. Its validity follows from 
Figure 6.3, in which we see the presence of envelope nodes of fast error oscillations 
at a range variation between the UR and the virtual reflector. We may significantly 
decrease the influence of the virtual reflector at any values of parameters we super-
pose its position on the axis of the normalized range between reflectors with the 
position of the envelope node of fast error oscillations. 
Using the results of Chapter 3, for this case the measurement error will be equal 
to zero under the condition of the coincidence of SL spectrum maxima WF
us
(
2)
S
xS
, 
WF
v
(
2)
S
xD
, and WF
v
(
2)
S
xS
 with extremes of the main lobe of spectrum 
D
WF(
2)
S
x
:
	
max
WF
us
(
2)
0
R
x
x
d S
x
dx
S
=
=
	
(7.14)
	
max
WF
v
(
2)
0
R
x
x
d S
x
dx
D
=
=
	
(7.15)
	
max
WF
v
(
2)
0
R
x
x
d S
x
dx
S
=
=
	
(7.16)

218	
Reduction of the Measurement Error at Interference Presence
where the indexes “us” and “v” correspond to the useful and virtual reflectors and 
xD = x – xR and xS = x + xR.
Further analysis is possible in conformity with the specific WF. We consider the 
DC WF. In this case, (7.14) through (7.16) lead to the conditions:
	
2
2
2
2
int
1
(
)
L
x
N
π
π
-
=
	
(7.17)
	
2
2
2
2
int
ant
2
[0.5 (
)]
L
x
x
N
π
π
-
-
=
	
(7.18)
	
2
2
2
2
int
ant
3
[0.5 (2
)]
L
x
x
N
π
π
-
-
=
	
(7.19)
where xant is the normalized range from a mixer to an antenna, N1, N2, and N3 are, 
respectively, the numbers of the SL spectra WF
int
(
2)
S
xS
, WF
v
(
2)
S
xD
, and WF
v
(
2)
S
xS
 
coinciding with the main lobe of the spectrum WF
us
(
2)
S
xD
.
We may achieve simultaneous performance of these conditions with the help 
of control by the FM sweep and by WF parameters. There are three conditions 
but only two varying parameters. In this case, we may use the compromise solu-
tion allowing the performance of two of these conditions and agreement with the 
value of the additional measurement error arising due to a violation of the third 
condition. Therefore, for the optimization of the above-mentioned parameters, we 
choose the most affecting spectra WF
us
(
2)
S
xS
 and WF
v
(
2)
S
xD
; that is, conditions 
(7.17) and (7.18). Solving this equation system, we obtain relations for the optimal 
values of ED:
	
(
) (
)
2
2
2
2
opt
ant
PR
1
2
1
4
2
R
R
R
N
N
δ
=
-
-
	
(7.20)
and the coefficient L:
	
2
2
opt
PR
R opt
1
(0.5
)
L
R
N
π
δ
=
-
	
(7.21)
connected with the DC WF parameter Q by the equation given in the designations 
of (3.23).
The values of the ranges to the UR RPR and to an antenna Rant and the SL 
spectrum numbers N1 and N2 are included in (7.20) and (7.21). Because at range 
measurement Rant is the only known value, the measurement procedure should be 
iterative with the estimation of unknown values and with the calculation of neces-
sary parameters at each step.
It is clear that for the KB WF the similar formulas may be obtained. However, 
instead of an SL number, the number of a root corresponding to the error envelope 
node of (3.28) will appear in them. 
7.5.1  Action Sequence for the Influence Reduction of the Virtual Reflector
The following steps comprise the action sequence for the influence reduction of the 
virtual reflector [5]:
Step 1:
• 
 DFS samples measurement and recording in the memory are carried 
out in a modulation half-period at the initial value of the FM sweep DF.

7.5  Error Decrease Caused by the Virtual Reflector	
219
Step 2:
• 
 Using the initial value of the WF parameter according to a DFS spec-
trum maximum by the methods described in Chapter 3, the zero estimation 
of range to the useful reflector 
(0)
PR
R
 is determined.
Step 3:
• 
 The estimation of SL numbers of spurious spectra 
1
N  and 
2
N  is 
calculated: 
	
2
2
1
PR
R
int
(
)
(
)
N
R
L
δ
π
é
ù
=
-
ê
ú
ë
û


	
2
2
2
ant
R
int
(
)
(
)
N
R
L
δ
π
é
ù
=
-
ê
ú
ë
û

Step 4:
• 
 The zero approximation of the optimal QI value 
(0)
opt
R
δ
 is calcu-
lated in (7.20) and zero approximation of the optimal value of the FM sweep 
(0)
opt
F
D
 is:
	
(
)
δ
D
=
(0)
(0)
opt
opt
4 R
F
c
	
(7.22)
Step 5:
• 
 According to (7.21), the zero approximation of the coefficient (0)
opt
L
 
and the DC WF parameter are obtained:
	
(
)
(
)
2
(0)
(0)
(0)
opt
opt
opt
1
2
Q
B
B
é
ù
=
+
ê
ú
ë
û
	
(7.23)
where 
(
)
(0)
(0)
opt
opt
exp
B
L
π
=
.
Step 6:
• 
 A new measurement and the DFS sample recording with obtained 
value of the FM sweep are performed. 
Step 7:
• 
 Using the current value of the WF parameter according to the DFS 
­spectrum maximum, the current range estimation to the UR 
( )
PR
i
R
 is obtained.
Step 8:
• 
 The current ith approximation of the optimal QI value ( )
opt
i
R
δ
 is calcu-
lated in (7.20) and from (7.22) the ith approximation of the optimal value of 
the FM sweep 
( )
opt
i
F
D
 is calculated.
Step 9:
• 
 According to (7.21), the current ith approximation (0)
opt
L
 is calculated 
and in (7.23) we obtain the current ith approximation of the DC WF param-
eter 
( )
opt
i
Q
.
Step 10:
• 
 Steps 6 through 9 are repeated until the new obtained value or the 
normalized range 
( )
( )
PR
opt
i
i
R
R
δ

 will not satisfy the condition (3.31).
The simulation results of the above-mentioned procedure of influence minimization 
of virtual reflector on the range measurement results are presented in Figure 7.12. 
At simulation, the ratio of signal amplitudes from the virtual reflector and from 
the UR was 0.3 and the normalized range to the antenna was xant = 4.
The MSD of the measurement error obtained without the optimization proce-
dure of the DFS generation and processing is presented in Figure 7.12 by a solid 
bold line, and the MSD of the measurement error obtained with using of offered 
optimization procedure is shown by solid thin line, and MSD with the result averag-
ing at an additional slow FM with obtained optimal values of frequency deviation 
and the WF parameter is presented by a dotted line. The increase of the range to 

220	
Reduction of the Measurement Error at Interference Presence
the UR from the possible minimum does not change the first plot, and therefore, 
two others smoothly decrease and aspire to some steady-state values. We see the 
advantage of an optimization procedure providing a measurement error decrease 
from units to hundreds of times. Averaging the results with the help of additional 
slow FM allows the reduction of the measurement error by 7 to 100 times.
Thus, the proposed method and algorithm of DFS generation and processing 
optimization allow an essential decrease of the measurement error in conditions 
leading to the property variation of the virtual reflector. However, they require pro-
viding a large volume of calculations and having the possibility of the FM sweep 
control and the carrier frequency (i.e., they need the large computing and frequency 
resources of the FMCW RF). 
7.5.2  Measures Providing a Decrease of the Error Caused by an Echo Signal
The following are measures that provide a decrease in the error caused by an echo 
signal:
Method 1:
• 
 The most evident method of a measurement error decrease con-
sists of an increase of suppression deepness of echo waves penetrating to the 
output of the FM oscillator at the expense of the number and quality increase 
of isolating devices, application of multiplication circuits, and frequency syn-
thesis with PLL systems.
Method 2:
• 
 This method allows a reduction of the error component caused by 
a reflection from the AWP encapsulating device. From (6.28), (6.29) and Fig-
ure 6.6, it follows that a decrease of this error is possible at the choice Rant = 
2ndR, n = 1, 2, … In this case, the boundaries of the FM sweep display equally 
­under the effect of echo waves and the error does not arise. This variant can 
be ­applied for a length choice of uniform parts of the AWP.
Figure 7.12  Plots of the normalized MSD logarithm of the measurement error versus the normal-
ized range at the frequency estimation according to the spectrum maximum for the DC WF. 

7.6  Conclusions	
221
Method 3:
• 
 This method allows the reduction of the total range measurement 
error. It takes into consideration the peculiarity of the SHF path construction 
for the FMCW RF TRM, in which the local oscillator signal is obtained by 
means of extraction of the transmitter power part by a directional coupler. 
In this case, the time of signal propagation in (6.6) and (6.10) can be repre-
sented in the form of three items:
	
ti = ti(OSC-DC) + ti(DC-A) + ti,free
where ti(OSC-DC) is the time of signal propagation on the SHF path portion between 
the FMCW oscillator and directional coupler, ti(DC-ANT) is the time of signal propa-
gation between the DC and an antenna, and ti,free is the time of signal propagation 
in the free space.
At an unchanged electrical range from the DC to the probing object, the mea-
surement error changes at the variation of the line of electrical length between the 
FMCW oscillator and the DC (i.e., ti(OSC-DC)).
We can decrease the error if in each point of the measured range we provide two 
measurements corresponding to the variation of a line of electrical length between 
the oscillator and the DC by means of the controllable phase shifter by a quarter of 
an average wavelength 
aver 4
λ
, and to average the results of these measurements. 
Therefore, the measurement error for all components of (6.35) is:
	
ç
÷
ant
aver
s
aver
cos 4
cos
sin
2
2
8
R
R
R
R
G
AV
R
R
λ
π
ϕ
π
π
δ
π
λ
δ
δ
D
æ
ö
æ
ö
æ
ö
=
+
ç
÷
ç
÷
è
ø
è
ø
è
ø
	
(7.24)
An error decrease will happen about 
aver
16 R
δ
πλ
 times. At the above-­ 
mentioned FMCW RF parameters, it is about 26.7 times, which is equivalent to 
increase the SHF oscillator isolation with the other part of the FMCW RF by about 
28.5 dB.
The obtained results allow the determination of the required TRM and AWP 
parameters starting from the admissible measurement.
7.6  Conclusions
For an effective struggle against spurious reflections, it is necessary to provide an 
interference situation analysis in the operating zone of the RF. Therefore, the pre-
liminarily learning of the device allows the determination of the IEZ boundaries. 
In the SR number, reflections from AWP irregularities and from the reservoir 
bottom typical for systems of level measurement and interference caused by reflec-
tions from reservoir walls by higher modes in directing systems and the finite UR 
sizes are included. 
In the resolution zone of the UR and SR, one can essentially decrease the mea-
surement error selecting AWF parameters in such a manner that the sidelobe of the 
SR spectra will be equal to zero. The algorithm of the WF shape control is iterative 
with the multiple performance of estimation down to an error decrease less than 
the specified value. 

222	
Reduction of the Measurement Error at Interference Presence
In the case when the UR and SR resolution cannot be implemented, the correc-
tion of range estimation according to the results of two consecutive measurements 
with the WF having significantly different shapes of the main SAD lobe at an equal 
width on the zero level. 
The optimal choice of FM, WF parameters, the constructive implementation 
of TRM, and AWP allow error reduction caused by the virtual reflector and echo 
signal to the levels accepted in practice. 
The control of line of electrical length between the oscillator and the DC 
decreases by 26 times the measurement error caused by the effect of the reflected 
signal on the SHF oscillator. 
References
[1]	
Harris, F. J., “On Use of Windows for Harmonic Analysis with the Discrete Fourier Trans-
form,” IEEE Trans. Audio Electroacoust., Vol. AU-25, 1978, pp. 51–83.
[2]	
Sosulin, Yu. G., Stochastic Signal Detection and Estimation Theory, Moscow: Sovetskoe 
Radio Publ., 1978, 320 pp. [in Russian.]
[3]	
Levin, B. R., Theoretical Fundamentals of Statistical Radio Engineering. In three volumes. 
2nd edition. Moscow: Sovetskoe Radio Publ., 1974, 552 pp. [in Russian.]
[4]	
Atayants, B. A., V. M. Davydochkin, and V. V. Ezerskiy, “Consideration of Antenna Mis-
matching Effects in FMCW Radio Range Finders,” Antennas, No. 12(79), 2003, pp. 23–27. 
[in Russian.]
[5]	
Ezerskiy, V. V., “Minimisation of Influence of a Virtual Reflector in a Frequency Range 
Finder,” Vestnik RGRTU, Ryazan, No. 18, 2006, pp. 35–39. [in Russia.]

223
c h a p t e r  8
Parametrical Methods and Algorithms for 
Increasing the Measurement Accuracy at 
the Interference Presence
8.1  Introduction
Traditional methods for reduction of interference influence were considered based 
on the optimization of the WF shape used and allowed by a serious decrease of the 
measurement error in the signal resolution area. Much interest has been generated 
by an investigation of the error reduction possibility on the interference background 
not only under the conditions of the UR and SR resolution but also in the areas 
where they cannot be resolved. In this case, the problem statement is possible when 
we want to reduce IEZ sizes and decrease the measurement error in this zone up to 
the accepted level in practice.
One of the directions allowing the reduction of the SR influence is the well-
known approach consisting of the estimation of interference signal parameters and 
in the generation of the cancellation signal on its basis. Therefore, the definition of 
requirements to the estimation accuracy of such a signal and the definition of the 
limitations on this method of application are important.
To minimize the SR influence, it is advisable to consider the possibilities of the 
MLM application.
In many cases, to increase the resolving capability of the spectral analysis, we 
recommend using algorithms of the frequency determination based on parametric 
methods of spectral estimation [1] (the Prony method and the method based on the 
analysis of eigenvectors). That is why it is desirable to investigate the features of this 
method’s application as well the reduction of the SR influence.
Besides the purely measuring methods in the case of clearly expressed local SRs, 
it is possible to use an approach that considers the peculiarities of a purely indus-
trial FMCW RF application. It is based on the estimation of the UR displacement 
speed before it enters into the IEZ. We may consider the prediction result with an 
account of the performed estimation of the UR displacement speed as the range 
estimation. These tasks are considered in this chapter.
8.2  Cancellation of Spurious Reflections
One of the methods allowing a reduction of the DFS interference component influ-
ence on measurement results is the cancellation of signals caused by the SRs. The 
reduction of the SR influence by means of its cancellation is the most clear ­engineering 

224	
Parametrical Methods and Algorithms
solution. Nevertheless, in the known publications, the issues that concern SR can-
cellation were not practically investigated. Reference [2] is the only exception, but 
the cancellation mode not thoroughly studied. The recommendations regarding 
practical application of this mode are absent; there is no information concerning 
the estimation of the benefit in the accuracy and conditions at which a practical 
implementation of the SR cancellation mode are not formulated.
We assume that the range to SR is known. The cancellation mode can be used 
for the range to the SR measurement in free space. We are limited by the specific 
case of the FMCW RF application as level-meters for the estimation of closed reser-
voir filling. This assumption supposes the cancellation application in the case when 
the SR is not shut by the layer of the reservoir’s content during the measurement 
process. However, the UR can be located in the immediate vicinity from the SR, 
which will lead to additional errors as well. Figure 8.1 shows the error function for 
measurement by the algorithm (3.4) for this case at the SIR 6 dB and 20 dB (the 
carrier frequency and the FM sweep are, respectively, 10 GHz and 500 MHz). The 
SR is situated on a range of 3 m from the FMCW RF. When the reservoir’s contents 
level fall below the construction element, which is the SR source, the mutual influ-
ence of the UR and SR spectra leads to additional errors.
The sign for cancellation mode activation is the performance of the following 
condition: the measured range R from the FMCW RF to the measured level in the 
reservoir should be more than the range to the SR. If SR is situated on the range RSR 
and its maximal spectral SC does not exceed the maximal SC of the useful signal, 
for the measured range R > RSR or R < RSR, the following conditions are always 
satisfied: 
SR
R
R
>

 or 
SR
R
R
<

 (here R is the range estimation and R is its true value). 
This statement is true at the application of the algorithm (3.4) and other algorithms 
of the frequency estimation (i.e., the range) considered in Chapter 3. The cancel-
lation of interference signals can be performed either in the time domain or in the 
spectral domain. For cancellation in the time domain, it is necessary to estimate 
the frequency, the initial phase, and the amplitude of the each interference signal 
and then to generate the signal that is out of phase to the interference. Moreover, 
60
40
20
0
−20
−40
−60
−802.8
3
3.2
3.4
3.6
3.8
4
R,mm
R,m
qs/i=6 dB
qs/i=20 dB
Figure 8.1  Functions of the measurement error versus the range.

8.2  Cancellation of Spurious Reflections	
225
for good cancellation, it is necessary to estimate the PAM level. Because the mutual 
influence of the UR and SR on the signal shape estimation of the cancellation signal 
parameters should be performed by calculating the DFS spectrum, the interference 
cancellation itself is advisable to be performed in the spectral domain. In this case, 
saving the SR spectra, we can provide cancellation without the estimation of the 
SR parameters.
The procedure of learning consisting of the following should precede the proce-
dure of interference signal cancellation in the spectral domain:
Step 1:
• 
 For an empty reservoir, it is necessary to obtain the DFS spectrum
	
tr
bot
,SR
1
(
)
(
)
(
)
L
l
l
S
j
S
j
S
j
ω
ω
ω
=
=
+ å
	
(8.1)
where Sbot(jw) is the spectrum of the signal reflected from the bottom and 
Sl,SR(jw) is the signal spectrum corresponding to the lth SR.
Step 2:
• 
 It is necessary to detect the main lobes of spectra 
,SR(
),
1,
lS
j
l
L
ω
=
. The 
main point here is the probability minimization of confusing the SL of the 
spectrum Sbot(jw) with the main lobes of the signal spectra corresponding to 
the SRs. Therefore, to detect the SRs, we need to use the calculation of the 
signal spectrum obtained for the empty reservoir using WF (i.e., to use the 
standard procedure of detection of the weak signals on the background of 
the strong signals in the spectral domain, which was mentioned in Chapter 7).
Step 3:
• 
 After detection of the SR spectra, we can determine the boundaries of 
the frequency range w low,l – w high,l of each lth SR corresponding to the width 
of the main lobe of the used WF.
Step 4: 
• 
In frequency ranges  w low,l – w high,l and 
1,
l
L
=
, the samples of the 
SR spectra are saved, which will be used for interference cancellation at the 
FMCW RF operation. 
As a result of the cancellation, the DFS spectrum can be presented as
	
comp
PR
,int
,SR
1
1
(
)
(
)
(
)
(
)
L
L
l
l
l
l
S
j
S
j
S
j
S
j
ω
ω
ω
ω
=
=
=
+
-
å
å
	
(8.2)
where SPR(jw) and Sl,int(jw) are the spectra of signals reflected from the UR, the 
range to which they are measured, and from lth interference calculated according 
to DFS.
At the FMCW RF operation, amplitudes and initial phases of signals corre-
sponding to the SRs may change. The reason for this is the possible deposition on 
SRs of liquid and solid substances contained in the environment. Moreover, due 
to the deformation of temperature expansion of constructive elements the range 
from the FMCW RF to the SR source may be changed. As a result, the complete 
cancellation will not occur and the following noncompensated remainder of the SR 
spectrum will arise:
	
D
=
-
¹
,int
,SR
1
1
(
)
(
)
(
)
0
L
L
l
l
l
l
j
S
j
S
j
ω
ω
ω
=
=
¢
å
å
	
(8.3)

226	
Parametrical Methods and Algorithms
where 
,int(
)
lS
jω
¢
 is the spectrum lth SR taking into account variations caused by op-
eration conditions of the FMCW RF. This remainder will lead to an increase of the 
range measurement error to the SR due to the influence of the main lobe and the SL 
of the spectrum D(jw) upon the useful signal spectrum.
Furthermore, in this section we estimate the possibility of the SR cancellation 
using both DFS CSD [3] and its PSD.
8.2.1  Using the Complex Spectral Density for Cancellation
For estimation of the cancellation quality, the numerical simulation was carried out 
for the procedure of the material reservoir’s level measurement using CSD for can-
cellation. At simulation, we assumed that there is one SR located at the range of 3 
m. At analysis, the SIR was equal to qs/i = 6 dB and the SNR and interference/noise 
ratio after cancellation were, respectively, 70 dB and 64 dB. The spectrum of com-
pensating signal was obtained at the learning stage. The carrying signal frequency 
and the FM sweep are 10 GHz and 500 MHz. To decrease the influence of the DFS 
spectrum SLs, we used the Blackman WF.
To estimate the cancellation quality, the rms criterion was used as reduced to 
the range interval equal to the wavelength of the carrying oscillation:
	
0.5
2
comp
1
1
(
)
/
m
i
i
i
R
R
m
σ
λ
=
é
ù
=
-
ê
ú
ê
ú
ë
û
å

	
(8.4)
where R
 and R are, respectively, the range estimation and its true value and m is a 
number of calculating points in the range interval l.
Figure 8.2 shows the function of the error log scomp for the equality of the 
compensating spectrum and the spectrum of the corresponding RS (curve 1). At 
calculation it was assumed that m = 10. Curves are obtained for averaging on 500 
DFS realizations.
logσcomp
−1
−1.5
−2
−2.5
−3
2
2.5
3
3.5
4
R,m
φ=π/18
φ=π/9
Figure 8.2  Functions of the range measurement error using the complex spectrum for the SR 
cancellation.

8.2  Cancellation of Spurious Reflections	
227
As we see, the SR influence is completely eliminated. The increase of the mea-
surement error at a range more than 3 m is caused by the noise influence obtaining 
the compensating spectrum. It follows from Figure 8.2 that the measurement error 
will be defined mainly by the noise interference at the equality of the parameters 
of compensating and interference signals. Other curves in Figure 8.2 are obtained 
at the cancellation absence (curve 2) and for the difference in phases Dj of com-
pensating and interference signals by 10° and 20°. We see from Figure 8.2 that this 
misphasing leads to a significant increase of the measurement error. The influence 
of the SL of the DFS spectrum is noticeable: the error caused by them at moving the 
UR away from the SR aspires to the error value defined by the noise interference.
Instantaneous functions of the measurement error without cancellation and 
for the difference in phases Dj of interference and compensating signals of 20° are 
presented in Figure 8.3. The qs/i ratio is 6 dB.
We see that difference in phases between compensatory and compensating sig-
nals by 20° leads to an error increase of about up to 30 mm.
These figures show that for the achievement of small measurement errors at 
CSD, using it is necessary to provide the phase equality of compensating and inter-
ference signals. In practice, this means that the learning mode should be ensured 
at each discharge (or loading) of the reservoir. However, at a high-specific-density 
product, the signal phase, which reflects from the SR, will change in time because 
the thickness of the deposition layer on the SR will be changed as well.
The plots presented allow the determination of the error increase as well at 
cancellation caused by the range variation from the FMCW RF case to the reflector 
owing to, for example, temperature variation. At a wavelength of 3 cm, the varia-
tion of this range by 1 mm is equivalent to the phase variation of the compensating 
signal by 24°. We note that the frequency difference of the DFS compensating signal 
and DFS caused by the SR may influence this case on the measurement error.
Figure 8.3  Plots of instantaneous error of the range measurement when using the complex spec-
trum for cancellation.

228	
Parametrical Methods and Algorithms
Taking the above-mentioned factors into consideration, we can conclude that 
the cancellation at CSD does not allow a performance of the sufficient measurement 
accuracy. The main limitation at using CSD for cancellation is the inaccurate deter-
mination of the CSD phase (or its variation during the FMCW RF operation).
8.2.2  Using Spectral Power Density for Cancellation
At first, we consider the possibility of using the DFS SPD for the SR cancellation 
presented in the classical form. We are limited by the case when there is the only 
one SR. Let us represent the SPD of a sum of two signals (the useful signal and the 
signal corresponding to SR) in the form:
	
2
2
2
PR
SR
mod
mod
PR
SR
var
mod
2
2
(
)
(
)
(
)
2
(
)
(
)
(
,
,
)
S j
S
j
S
j
T
T
S
j
S
j
t
T
ω
ω
ω
ω
ω
ω
ϕ
=
+
+
F
D D
	
(8.5)
where F(w var , Dt, Dj) = cos(wvar Dt + Dj), w var are values of a varied carrier fre-
quency, Dt = tdel – tdel,SR, Dj = j1 (tdel) – j2 (tdel,SR), and j1(tdel) and j2(tdel,SR) are 
values of DFS phases on beating frequencies corresponding to delays tdel of the use-
ful signal and tdel,SR of the signal from SR.
As a result of cancellation, assuming that SSR (jw) = Str (jw), we see that the 
spectrum 
w
2
comp(
)
S
j
 of the compensated signal is equal:
	
2
2
comp
PR
mod
PR
SR
var
mod
2
(
)
(
)
2
(
)
(
)
(
,
,
)
S
j
S
j
T
S
j
S
j
t
T
ω
ω
ω
ω
ω
ϕ
=
+
F
D D
	
(8.6)
The second item in (8.6) is the mutual spectrum of the useful signal and the 
signal corresponding to the SR. We note again that the mutual spectrum depends 
upon the phases of these signals.
It follows from (8.6) that the SR influence on the measurement result will be 
eliminated only in cases when
	
var
(
,
,
)
0
t
ω
ϕ
F
D D
= 	
(8.7)
This condition is satisfied if
	
w0 (tdel – tdel,SR) + j1 (tdel) – j2 (tdel,SR) = (0.5 + k) p, k = 0,1,2,….
Equation (8.6) can be laid as a basis of the cancellation algorithm of SR influ-
ence on measurement results. For this, varying the carrier frequency within some 
limits, it is necessary to achieve the condition performance in (8.7). The FM sweep 
at the performing measurement on each value w min £ w var £ w max (w min, w max are 
limits of carrier frequency variation) should remain unchanged.
To estimate the cancellation quality, we may use the functional
	
2
1
var
comp
0
[ (
,
,
)]
(
)
A
t
S
j
d
ω
ϕ
ω
ω
¥
F
D D
= ò
	
(8.8)

8.2  Cancellation of Spurious Reflections	
229
Calculations show that A1[F(wvar , Dt, Dj)] has an oscillating character be-
cause the value [F(wvar , Dt, Dj)] during the varying process changes within the 
limits –1 ¸ +1. To compensate the SR, it is necessary to determine the frequencies 
w1 and w2, at which the adjacent maximal Amax and minimal Amin values of the 
function (8.8). The vicinities of the average frequency values correspond to Amax 
and Amin, that is, wopt = (w1 + w2)/2 correspond to those wopt, at which the follow-
ing equality is performed:
	
PR
SR
opt
mod
2
(
)
(
)
(
,
,
)
0
S
j
S
j
t
T
ω
ω
ω
ϕ
F
D D
» 	
(8.9)
Therefore, the SR influence will be compensated, which follows from (8.6). 
At a practical implementation of the cancellation mode with the help of tun-
ing the transmitter carrier frequency, it is convenient to represent the SPD of the 
compensated signal through the SAD of the DFS and the compensating signal. We 
write the modified spectrum ½Scomp,m(jw)½2 obtained as a result of cancellation in 
the form:
	
{
}
2
2
comp,m
PR
SR
tr
(
)
(
)
(
)
(
)
S
j
S
j
S
j
S
j
ω
ω
ω
ω
=
+
-
	
(8.10)
After transformations, we obtain that it will be determined as:
	
}
}
2
2
2
2
comp,m
PR
SR
tr
2
2
1 2
SR
var
PR
SR
var
(
)
(
)
(
)
(
)
2
(
)
(
)
(
)
2
(
)
(
)
(
,
,
)
2
(
)
(
)
(
,
,
)
tr
PR
SR
PR
S
j
S
j
S
j
S
j
S
j
S
j
S
j
S
j
S
j
t
S
j
S
j
t
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ϕ
ω
ω
ω
ϕ
=
+
+
-
+
+
F
D D
ùû
ùû
+
F
D D
	
(8.11)
The maximal values of the functional
	
2
2
var
comp,m
0
[ (
,
,
)]
(
)
A
t
S
j
d
ω
ϕ
ω
ω
¥
F
D D
= ò
	
(8.12)
as it follows from (8.11), correspond to the condition F(wvar , Dt, Dj) = 1. In this 
case, the SR cancellation occurs. As well, it follows from (8.11) that the complete SR 
cancellation will take place when spectra ½SSR(jw)½ and ½Str(jw)½ will be equal.
It is much more economical to determine the maximums of the functional 
A2[F(wvar , Dt, Dj)] than the transitions of the functional A1[F(wvar , Dt, Dj)] through 
the line equal to 
2
comp
0
(
)
S
j
d
ω
ω
¥
ò
. The range Df of the transmitter carrier frequency 
varying depends on the delay difference Dtdel = tdel – tdel,SR and the values of phases 
j1(tdel) and j2(tdel,SR). This range, which is necessary for the cancellation of the SR 
influence, is easy to determine if we take into consideration that varying should be 
provided by the phase variation of the function F(wvar , Dt, Dj) not less than by p. 
Carrying out the transformation of the function F(wvar , Dt, Dj), we obtain:
	
Df = c/2Dl	
(8.13)

230	
Parametrical Methods and Algorithms
where Dl is the range between the SR and UR, at which the complete SR cancel-
lation takes place. From this, we see that it is impossible to ensure the complete 
interference cancellation in the whole range by this approach. We can only speak 
about the decrease of the IEZ.
At the IEZ value Dl equal to 2 cm, the range of varying is Df » 7.5 GHz. It is im-
possible to provide such a variation of the carrier frequency in the centimeter range. 
With Dl increasing, that is, with the IEZ increasing up to 20 cm and 40 cm, the 
value Df decreases relatively to 1,500 MHz and 750 MHz, which can be provided 
in practice as these values are comparable with the FM sweep value of the modern 
FMCW RF of the centimeter range.
Figure 8.4 shows the error behavior log svar of the range measurement calcu-
lated with the help of (8.4) at an equality of the SR and compensating signal ampli-
tudes. At simulation, the SIR was 6 dB, and the SNR is 70 dB. The FM sweep was 
500 MHz, and the frequency of carrying oscillation was ±750 MHz. The function 
shown in Figure 8.4 was obtained by averaging for 500 DFS realizations.
A comparison with Figure 8.3 allows the assertion that the IEZ essentially 
­decreased. The simulation showed that the phase difference of compensating and 
interference signals does not influence the IEZ sizes. Its sizes are defined by the 
range of the transmitter carrier frequency variation.
The error behavior log svar has a practical interest in the case of the amplitude 
difference of the compensating signal and the signal corresponding to the SR. The 
behavior of the error log svar is shown in Figure 8.5 for the difference of these 
amplitudes. The conditions of the simulation performance remain the same as for 
Figure 8.4.
The differences in amplitudes of compensating and interference signals lead 
to a deterioration of cancellation quality (i.e., to the IEZ and measurement error 
increase). 
Figure 8.6 shows the instantaneous error of range measurement at the equality 
of amplitudes of interference and compensating signals and for different amplitudes 
obtained under the above-mentioned conditions. We see that the IEZ is significantly 
Figure 8.4  The plot of measurement error using the SPD for the SR cancellation. 

8.2  Cancellation of Spurious Reflections	
231
less than when using the algorithm (3.4). However, at differences of amplitudes of 
interference and compensating signals, the IEZ increases. We have already noted that 
compensating signals are obtained at the learning stage. Therefore, the difference in 
amplitudes of compensating and interference signals can be reduced to a small value. 
We would also like to note that, in spite of this difference, the measurement error 
decreases about four to eight times compared to the algorithm (2.4).
The conclusion, which can be made from the analysis of Figures 8.5 and 8.6, 
is that the cancellation of interference signals can be implemented in practice only 
by using SPD and varying the transmitter carrier frequency. The zone, when the 
increased measurement error is observed, depends on the variation range and is 
determined by (8.13). If we choose the maximal value of the variation range of 
−0.5
−1
−1.5
−2
−2.5
−32
2.5
3
3.5
4
R,m
Figure 8.5  Plots of functions of measurement error using the SAD for the SR cancellation and at the 
inequality of the interference amplitude (ASR) and the compensating signal (Acomp).
Figure 8.6  Instantaneous range measurement errors. Curve 1 corresponds to the equality of ampli-
tudes of compensating and interference signals. Curves 2 and 3 correspond to amplitude difference 
equal to 10% and 20%.

232	
Parametrical Methods and Algorithms
±750 MHz, the increased error is observed at a range 20 cm from the SR (at the 
equality of amplitudes of compensating and interference signals and for the FM 
sweep of 500 MHz). Compared to the application of the algorithm (3.4), the IEZ 
width decreases about five to six times. At range more than 20 cm from the SR, the 
measurement error is defined by the noise influence only and the accuracy of finding 
the extremes of the function A2[F(wvar , Dt, Dj)].
8.3  Reduction of Spurious Reflector Influence on the Accuracy of the 
Range Estimation by the Maximal Likelihood Method
The DFS LLF is an oscillating function with a period of likelihood Tlike = l /2c. 
The envelope of this function coincides (with accuracy to the constant multiplier) 
with the spectrum shape of the single pulse with the duration Tmod /2. At the DFS 
frequency estimation with the help of the MLM, when the signal is received on 
the background of the noise interference, the variance of frequency estimation will 
coincide with the lower variance boundary defined by the Rao-Cramer inequality. 
Therefore, an investigation of the application possibility for the DSF frequency es-
timations received on the SR background of algorithms constructed on the basis of 
the LF has a practical interest. The fast oscillating LF view allows the assumption 
that the displacement of its extremes under the SR influence will be significantly 
less than the displacement of the LF envelope extreme, that is, at the DFS frequency 
measurement according to the position of its spectrum maximum.
8.3.1  The Tracking Range Measuring System
Before the material presentation, in this section we change the designation of some 
variables. Here we designate as t, by the letters t for the LF argument, tdel for the 
delay time corresponding to the useful signal, and tdel,SR for the delay time corre-
sponding to SR.
Limiting the case of a single SR, we can write the modified function of likeli-
hood lnlm(t) as:
	
mod/2
del,ref
ref
0 del,ref
ref
del,ref
0
mod
0
del,ref
2
2
0 del,ref
ref
del,ref
ref
mod
2
1
ln
( )
2 ( )
cos
(
)
2
cos
(
)
T
m
t
l
y t A
N
T
t
A
dt
T
ωτ
τ
ω τ
ϕ
τ
ωτ
ω τ
ϕ
τ
ì
D
é
ù
=
+
+
í
ê
ú
ë
û
î
ü
D
é
ù
-
+
+
ý
ê
ú
ë
ûþ
ò
	
(8.14)
where 
del
dif
0 del
s
del
mod
del,int
SR
0 del,SR
s
del,SR
mod
2
( )
cos
(
)
2
cos
(
)
( )
t
y t
A
T
t
A
t
T
ωτ
ω τ
ϕ τ
ωτ
ω τ
ϕ τ
ξ
é
D
ù
=
+
+
ê
ú
ë
û
D
é
ù
+
+
+
+
ê
ú
ë
û
 
where Aref; tdel,SR; jref tdel,SR are the amplitude, delay time, and phase of the refer-
ence signal.

8.3  Reduction of Spurious Reflector Influence	
233
The function
	
mod/2
del
del
dif
0 del
s
del
0
mod
0
del,SR
SR
0 del,SR
del,SR
mod
del,ref
ref
0 del,ref
ref
del,ref
mod
2
2
(
)
cos
(
)
2
cos
(
)
2
cos
(
)
T
m
t
q
A
N
T
t
A
T
t
A
dt
T
ωτ
τ
ω τ
ϕ τ
ωτ
ω τ
ϕ τ
ωτ
ω τ
ϕ
τ
é
D
ù
=
+
+
ê
ú
ë
û
D
é
ù
+
+
+
ê
ú
ë
û
D
é
ù
´
+
+
ê
ú
ë
û
ò
ì
í
î
ü
ý
þ
	
(8.15)
will fully define the time delay measurement error at the SR presence with accuracy 
to the integral value 
mod
del,ref
ref
del,ref
/2
del,ref
2
2
0 del,ref
ref
del,ref
ref
0
mod
0
[
,
(
)]
2
1
cos
(
)
T
A
t
A
dt
N
T
τ
ϕ
τ
ωτ
ω τ
ϕ
τ
D
æ
ö
=
+
+
ç
÷
è
ø
ò
Calculating the integral in (8.14) and neglecting items with the doubled 
­frequency, we obtain: 
	
del
dif
del
SR
del
del
del,ref
mod
dif
ref
0
1
1
0
del
del,ref
del,SR
del,ref
SR
ref
0
2
2
del,SR
del,ref
(
)
(
)
(
)
sin[
(
) 2]
cos[ (
,
,
)]
2
(
) 2
sin[
(
) 2]
cos[ (
,
,
)]
(
) 2
m
q
q
q
T
A
A
t
N
A
A
t
τ
τ
τ
ω τ
τ
ω
ϕ
ω τ
τ
ω τ
τ
ω
ϕ
ω τ
τ
=
+
ì
D
-
=
F
D
D
í
D
-
î
ü
D
-
+
F
D
D
ý
D
-
þ
	
(8.16)
where Dt1 = tdel – tdel,ref; Dj1 = js(tdel) – js(tdel,ref); Dt2 = tdel,SR – tdel,ref; Dj2 = 
js(tdel,SR) – js(tdel,ref).
We consider the functions qdif(tdel) and qSR(tdel,int) as SF, respectively, for the 
useful signal and for the signal corresponding to the SR. 
The function qm(tdel) shape is defined by the sum of two oscillations with the 
same frequencies and, in general, with different initial phases and amplitudes with 
envelopes defined by the multiplier of type sin z/z.
To determine the accuracy of the time delay estimation, we first determine the 
deviation Dt (tdel) of the function qm (tdel) extremes arising under the SR influence at 
a different qs/i ratio and different values of phases js(tdel), js(tdel,SR), and js(tdel,ref). 
A variation of the high-frequency oscillation phase of the function qdif(tdel) under 
the influence of the same oscillations of the function qSR(tdel) is the reason for the 
deviation Dt(tdel) appearance. The oscillation qSR(tdel) phase will also change under 
influence of oscillations qdif(tdel), but this variation will not lead to a measurement 
error increase.
It is necessary to note that the deviation of the function qm(tdel) extremes takes 
place under the effect of the SF component on a doubled difference frequency. 
Nevertheless, this deviation has a second smallness order compared to Dt(tdel) and, 
therefore, we can neglect them. 
Calculating the partial derivative ¶qm /¶tdel and carrying out the necessary 
transformations, we can determine the deviations of the function qm(tdel) maxima 

234	
Parametrical Methods and Algorithms
(including the main) according to the following formula under the SR effect for 
ASR £ Adif [4]: 
	
dif
1
2
del
dif
1
2
0
sin[
]
(
)sin[
]
1
(
)
arctan
cos[
]
(
)cos[
]
x
x
x
A
z
A
z
A
z
A
z
τ
τ τ
τ
τ
ω
ì
ü
+
D
=
-
í
ý
+
î
þ
	
(8.17)
where 
del,SR
SR
del,SR
sin[
(
) 2]
(
)
(
) 2
x
x
x
A
A
ω τ
τ
τ
ω τ
τ
D
-
=
D
-
 is the value of the SF envelope qSR(tdel) at 
the range 
2
x
x
R
c
τ
=
 from the SR; z1 = w0tdel + js(tdel) – js(tdel,ref); z2 = w0tdel,SR + 
js(tdel,SR) – js(tdel,ref).
When obtaining (8.17), we assumed that the displacement Dt(tx) is small and 
therefore, it is accepted that 
del
del
sin[
(
)/2]
1
(
)/2
ω τ
τ
ω τ
τ
D
-
=
D
-
.
At the range difference Rx between the reflecting surface and the SR equal  
to ml /4 (m is an integer number), and for the perfomance of the condition 
js(tdel) = js(tdel,SR) = j(t), the range measurement error (displacement of the extreme 
positions Dt) is defined by the noise interference only. The SR has no influence. It can 
be explained by the fact that high-frequency oscillations of functions qdif(tdel) and 
qSR(tdel) are summed either with the same phases or with phases that differ by 180°. 
The condition ASR £ Adif is a guarantee that the required range (delay) corresponds 
to one of the maxima of the function qm(tdel). An error increase is observed in the 
case when the range rx is not a multiple to the value ml/4.
The functions of the displacement Dt of the function qm(tdel), which is recalcu-
lated into the range at the ratios qs/i = 2, 6, 20 dB, for the FM sweep of 500 MHz 
and the carrier frequency of 10 GHz calculated according to (8.17), are presented 
in Figure 8.10 (Rx = R – RSR). 
We see that the presented functions have a fast oscillating character (the oscil-
lation period is l /2) with envelopes defined by the spectrum shape of the single 
pulse, which corresponds to the LLF character. A comparison of Figure 8.7 with the 
figures presented in Chapter 6 and with the results of calculations on (8.24) shows 
that the maximal DFS frequency measurement error is essentially about 82 times 
Figure 8.7  Plots of extreme displacement function qm(tdel) versus the range between the UR and 
SR for different SIR for the FM sweep of 500 MHz.

8.3  Reduction of Spurious Reflector Influence	
235
less than when using the algorithm (3.4) for the DFS frequency estimation. Calcula-
tions according to (8.17) show that the phase difference of js(tdel) and js(tdel,ref) 
leads to the displacement of extreme positions qm(tdel); that is, to the measurement 
truncation error, which is defined by (4.27). The phase value js(tdel,ref) does not 
influence the value of the truncation error and its effect consists of the initial phase 
variation of the fast oscillating component of functions in Figure 8.10, and hence, 
the oscillation envelope does not change. 
Figure 8.8 shows the the functions of the displacement Dt of qm(tdel) extremes 
recalculated into the range for the FM sweep DF = 1 GHz at ratios qs/i = 2, 6, 
20 dB. 
We see that compared with Figure 8.7 the maximal value of the displacement 
Dt remains practically the same. The IEZ decreases proportionally to increase the 
carrier FM sweep.
The variation of the carrier frequency, as it follows from (8.17), leads to an 
inverse proportional variation of extreme displacement qm(tdel) at an ­unchanged 
value of the FM sweep. To decrease this displacement, it is necessary to increase 
the carrier frequency of the FMCW RF transmitter. We should note once more that 
functions, which are presented in Figures 8.7 and 8.8, are calculated according to 
(8.17). Simulation results completely coincide with calculation data and therefore, 
we did not discuss them. 
The main maximum of the function qm(tdel) at ASR = 0 coincides with the main 
maximum of the LF (4.2) and corresponds to the estimating delay time tdel. The SR 
influence leads to an envelope qm(tdel) variation as the functions qdif(tdel) and qSR(t) 
have different amplitudes, phases, and envelopes. Summation of functions qdif(tdel) 
and qSR(t) with different amplitudes, phases, and envelopes leads to variations of 
function qm(tdel) maxima. As a result, the main maximum of qm(tdel) will not cor-
respond to a true delay. 
In other words, in spite of insignificant displacements of maxima positions 
­under the influence of the SR the maximum corresponding to the measuring range 
will not be global. The largest variation of this maximum value will be observed at 
the spectra overlapping the useful signal and the SR. 
Figure 8.8  Plots of extreme displacement qm(tdel) versus the range between the UR and SR for 
­different SIR at the FM sweep of 1 GHz.

236	
Parametrical Methods and Algorithms
Figure 8.9 shows the functions of the range measurement error using the 
main maximum of the function (8.16) at the SR presence obtained with the 
help of simulation. The behavior of 
(
)/2
del
m
R
n
nτ
λ
D
=
-
, that is, the value of 
del
carr(
)/2
del
m
T
n
nτ
τ
D
=
-
 recalculated into the range (numbers nm and 
del
nτ  corre-
spond to numbers of the main extreme Zt corresponding to the delay tdel, and 
Tcarr is the period of carrying oscillation) is shown in this figure at different ranges 
Rx from the SR to UR. Functions are obtained at the performance of equalities 
js(tdel) =  js(tdel,ref) = js(tdel,SR) = 0. 
Figure 8.9 allows a qualitative estimation of the range measurement error using 
the main maximum of the function qm(tdel). We see that in spite of small displace-
ments, which follow from (8.17), it is impossible in general to use the function 
qm(tdel) for the accurate measurement at presence of the SR if providing measure-
ments on the basis of a global maximum search. The second conclusion from Figure 
8.9 is that anomalous range measurement errors according to the position of the 
main maximum take place for large Rx from SR, especially at small qs/i. Therefore, 
for accurate range measurement, it is necessary to realize the tracking procedure for 
the local extreme Zt corresponding to the estimating delay [4].
8.3.2  Main Stages of the Tracking Procedure After the Local Extreme
The following are the main stages:
Stage 1:
• 
 It is necessary to determine those range intervals, within which the 
SR influence is significant, that is, to determine the IEZ boundaries in the 
whole delay interval (tdelÎtdel,min,tdel,max).
Stage 2:
• 
 The measurement of the delay time in the range intervals, for which 
the SR influence is insignificant, can be provided with the help of algorithms 
identifying the position of the maximal SC with the DFS frequency or using 
for this purpose the algorithm realizing the MLM.
Stage 3:
• 
 In entering the IEZ, it is necessary to form the delay interval DTdel, 
within which is the maximum Zt , using the previous measured value tdel 
Figure 8.9  Plots of the range measurement error according to the position of the main maximum 
of the function qm(t) versus the range between the SR and UR.

8.3  Reduction of Spurious Reflector Influence	
237
obtained with the help of the algorithm (3.4). On the inside of the IEZ, the 
delay interval DTdel is forming on the basis of the previous measurement of 
the time delay by the tracking measurer. 
Stage 4:
• 
 To eliminate the error connected with the phase difference of the 
reference signal and the DFS, according to the PFC, we need to estimate the 
DFS phase value for the range corresponding to the IEZ boundary using 
the approach described in Chapter 4. 
Stage 5:
• 
 It is necessary to ensure the displacement of the delay interval Zt , 
which corresponds to the measured range. 
Stage 6:
• 
 The measurement of the time delay is carried out according to the 
position of the maximum, which falls in the delay interval DTdel.
For a practical implementation of the tracking measurer, it is necessary to define 
its main parameter, the width of the delay interval DTdel. The probabilities of the 
anomalous error appearance (as before, we understand the “jump” to the adjacent 
maximum as an anomalous error) and the tracking loss (we understand the tracking 
after one maximum of the function qm(tdel) corresponding to the SR as the track-
ing loss) will depend upon DTdel. It is clear that DTdel should not exceed the value 
l/2c. This condition ensures against appearance of anomalous errors as the condi-
tion DTdel < l /2c eliminates falling in the interval DTdel of two adjacent maxima. In 
the future, this exact value will be accepted at simulation and at the processing of 
experiment data. 
Tracking after the useful extreme of the function qm(tdel) at the measurement of 
the range to the SR has peculiarities that do not permit using the known methods 
[5, 6] based on the application of time discriminators and phase-locked-loop sys-
tems. It can be explained by the fact that although the speed of the range to the UR 
variation in the moments of discharge and loading of the reservoir is rather stable, 
the speed vector sign is arbitrary. In general, with the same probability in any time 
moment, the increment of the range to the UR variation may be positive, negative, 
or equal to zero. 
8.3.3  Tracking Modes
The following are the tracking nodes:
The generation of the initial 
1.	
tdel,init and final tdel,final values of the interval 
DTdel on the basis of the previous estimation tdel, that is, values tdel,init and 
tdel,final will be defined as 
	
del,int
del,(
1)
/4
n
c
τ
τ
λ
-
=
-

	
(8.18)
	
del,final
del,(
1)
/4
n
c
τ
τ
λ
-
=
+

	
(8.19)
We do not meet anomalous errors in the case if the fall of the maxima of the 
function qm(tdel) (adjacent to Zt) in the interval tdel,final – tdel,init = l /2c is elimi-
nated. It can be achieved at the performance of the evident condition: 

238	
Parametrical Methods and Algorithms
	
del,(
1)
del,(
1)
del,
del,(
1)
1
/2
/2
n
n
n
n
n
n
c
c
τ
τ
λ
τ
τ
τ
τ
λ
-
+ D
-
<
+ D
<
+ D
+
-
-
-
	
(8.20)
where Dtn–1 and Dtn are the errors of the previous and future measurements. 
Recounting the delay into the range, we obtain from (8.20): 
	
1
/4
/4
n
n
R
R
R
λ
λ
-
-
< D
+ D
- D
<
	
(8.21)
where DR is the variation of the range to the reflecting surface for two consequent 
measurements; DRn and DRn–1 are measurement errors of the tracking measurer.
It follows from (8.21) that the following condition should be satisfied:
	
1
/4
n
n
R
R
R
λ
-
D
+ D
- D
<
	
(8.22)
At a decrease of the qs/i ratio, the errors Dtn–1 and Dtn increase, which leads to 
the necessity of a DR reduction. The function of an admissible DR value versus the 
SIR qs/i for w 0 = 10 GHz calculated using (8.17) and (8.22) is shown in Figure 8.10 
(curve 1). Function 1 tends to DR = 7.5 mm (curve 2) with qs/i increasing. We can 
see from Figure 8.10 that at qs/i = 2 dB the admissible value of the measuring range 
increment is equal to about 3 mm from one measurement to another. For a smaller 
SR intensity corresponding to qs/i, the increase of DR is possible.
The variation of the FM sweep does not practically lead to curve 1 variation. 
However, the reduction of the carrier frequency allows for an increase of DR. Figure 
8.10 shows the function of DR versus the SIR qs/i for a carrier frequency of 5 GHz 
(curve 3), which tends asymptotically to DR = 0.015 m (curve 4) with qs/i increas-
ing. Nevertheless, an increase of DR achievable at a carrier ­frequency reduction is 
accompanied by a proportional increase of Dt(tx), which follows from (8.17). 
Figure 8.10  Plots of admissible level increment versus the SIR. 

8.3  Reduction of Spurious Reflector Influence	
239
We can increase the admissible value of DR assuming the information applica-
tion about range increment to the reflecting surface, for which it is necessary to 
store data obtained at a previous measurement. Restricting storing the results of 
(n – 2)-th and (n – 1)-th measurements, we can write on the analogy of (8.28):
	
2
1
/4
2
/4
n
n
n
R
R
R
λ
λ
-
-
-
< D
+ D
- D
<
	
(8.23)
This is equivalent to 
	
2
1
n
n
n
R
R
R
λ
-
-
D
+ D
- D
<
2
/4	
(8.24)
Hence, the sum of errors at measurement with numbers n, n + 1, n + 2 should 
not exceed l /4. The calculations performed according to (8.17) and (8.24) and the 
simulation results allow the statement that at uniform UR motion the condition 
(8.24) is satisfied beginning at qs/i » 0 dB. Therefore, the value DR will be equal to 
about l /5.
8.3.4  Influence of the Phase Characteristic Estimation Error on the Operation 
of the Tracking Measurer
The measurement results of the delay time with the help of the tracking measurer 
will be accompanied by the additional error d r connected with an inaccuracy of 
the PFC estimation. Entering into the IEZ, this error will be defined in accordance 
with (4.27) as: 
	
int
del,init
del,init
[ (
)
(
)] [4 (1+
/ )]
R
δ
λ ϕ τ
ϕ τ
π
ω ω
=
-
D

	
(8.25)
where 
del,init
(
)
ϕ τ

 and j(tdel,init) are the estimation and the true value, respectively, of 
the PFC at the input of the IEZ. 
At the output from the IEZ, this error is equal to: 
	
ﬁnal
del,init
del,init
[ (
)
(
)] [4 (1 +
/ )]
R
δ
λ ϕ τ
ϕ τ
π
ω ω
=
-
D

	
(8.26)
where j(tdel,final) is the true PFC value at the output of the IEZ.
The value d rinit is defined by the PFC estimation error caused by the noisy 
­interference and the mutual influence of the SL of the UR and SR spectra. The value 
d rfinal is defined by the difference of the signal phase values at the beginning and end 
of the IEZ, the noisy interference, and the SL of the UR and SR spectra. Its value 
can be decreased by an approximation of the DFS phase within the IEZ limits by 
the linear function: 
	
del
del,init
del
del,init
del,ﬁnal
del,init
del,init
del,ﬁnal
(
)
[ (
)
(
]
(
)
τ
τ
ϕ τ
ϕ τ
ϕ τ
ϕ τ
τ
τ
-
=
-
+
-







	
(8.27)
A choice of this linear function is explained as follows. The phase varia-
tion within the IEZ, as the practice shows, is 20° to 30°; that is, the additional 
­measurement error does not exceed 0.8 to 1.2 mm. Therefore, it is quite inexpedient 
to use it for the approximation of the more complicated function. 

240	
Parametrical Methods and Algorithms
8.3.5  Determination of the Conditions at which the Tracking Loss Occurs 
The function qm(tdel), as already mentioned, can be considered as a sum of two SF 
functions, qdif(tdel) and qSR(tdel). The shapes of envelopes Fdif(tdel) and FSR(tdel) of 
these fast oscillating functions are the same and are defined by the multipliers of 
type sin z/z. In points where envelopes have zero values, phases of oscillations in the 
interval equal to l /4 change by p.
The envelope Fenvel(tdel) square of the function qm(tdel) can be presented in the 
form: 
	
2
2
dif
1
SR
2
envel
2
2
dif
SR
1
2
SR
dif
( )
( )exp(
)
( )exp(
)
( )
( )
2
( )
( )cos(
)
F
F
j
F
j
F
F
F
F
τ
τ
ωτ
τ
ω
τ
τ
τ
τ
=
-
+ F
+
-
+ F
=
+
+
F - F
	
(8.28)
where F1 = wtdel + js(tdel) – js(tdel,ref) and F2 = wtdel,SR + js(tdel,SR) – js(tdel,ref).
The reason for a tracking loss can be explained most clearly at performance of 
two conditions: phase equality to zero: js(tdel) = js(tdel) = js(tdel,SR,ref) = 0 and for 
a discrete variation of the range between the SR and the reflecting surface by the 
value ml /4 (m is odd). For this case, the envelope square is: 
	
2
2
2
del
del
del
SR
envel
dif
(
)
(
)
(
)
F
F
F
τ
τ
τ
=
+
	
(8.29)
therefore, the zero values of Fenvel(tdel) correspond to points, in which Fdif(tdel) = 
FSR(tdel). In the points Fenvel(tdel) = 0, the variation of the oscillation phase happens 
by p. For approaching the UR to the SR (we assume for distinctness that the UR ap-
proaches to the SR from the left), the SL of the function qSR(tdel) affects at first the 
extreme displacement of the function qdif(tdel). The value of the main maximum Zt 
significantly exceeds the maxima of qm(tdel) caused by the SR effect. By overlapping 
the main lobes of the functions qdif(tdel) and qSR(tdel), which takes place for their 
approach by the value Dt < 1/2Dw, the decrease of both the useful maximum and 
the maximum corresponding to the reflection from the SR occurs as high-frequency 
oscillations will be summed with phases differs by p. Tracking loss happens when 
those points τ¢ are in the vicinity of which (in the interval l /4c) the phase variation 
of high-frequency oscillations by p occurs in the delay interval DTdel. In this point 
envel( )
0
F
τ
=
¢
 and in its vicinity, the maxima of the function qm(tdel) take minimal 
values. To the left of the point τ¢, the maxima positions of functions qm(tdel) and 
qDFS(tdel) coincide. From the right side, they coincide with maxima positions of the 
function qm(tdel). The last statement is true when the condition Adif < ASR is carried 
out. Thus, when the UR passes the point τ¢, the maximum of the function qm(tdel) 
coinciding with the maximum of the function qSR(tdel) falls inevitably in the interval 
DTdel. At a further UR moving (to the right of the point τ¢) and at the performance 
of the condition Adif < ASR, the measurer will track after a fixed maximum of the 
function qm(tdel); that is, tracking loss will occur. It is explained by the fact that 
initial tdel,init and final tdel,final values of the interval DTdel will be formed on the 
­basis of range measurement to the fixed maximum. In general, we can determine the 
range Rtr,1 to the SR, at which the tracking loss occurs, from the equation:
	
DFS
SR
SR
SR
sin[
(
)/2]/[
(
)/2]
A
A
ω τ
τ
ω τ
τ
<
D
-
D
-
	
(8.30)

8.3  Reduction of Spurious Reflector Influence	
241
In other words, tracking loss happens when the maximal envelope value of the 
function qs(tdel) becomes less than the envelope of the function qint(tdel). Expanding 
sinz into the Taylor series, being limited by two series items and presenting a delay 
through range, we can find the solution of (8.30) in the following form:
	
(
)
tr,l
s/i
6 1
/
R
q
c
ω
é
ù
³
-
D
ë
û
	
(8.31)
Functions showing the connection of the range Rtr,1 with qs/i are presented in 
Figure 8.11. At simulation, q is 70 dB.
The upper plots for the FM sweeps of 10 GHz and 500 MHz obtained by simu-
lation correspond to the first tracking mode, and the lower plots correspond to the 
second mode, that is, with account of reflector motion speed. From Figure 8.11 we 
can conclude that the calculation results according to (8.31) coincide satisfactorily 
with simulation results. 
The main conclusion from the presented functions is that tracking loss occurs 
under the condition qs/i < 0; however, tracking after a locked extreme (at the IEZ 
boundary) of the function qm(tdel) can be provided in some cases at qs/i < 0. This 
statement requires explanation. Preliminary targeting for the tracking algorithm is 
provided using the algorithm (3.4). If qs/i < 0, then, with the help of this algorithm, 
the frequency variation will occur corresponding to the range to the SR. In the spe-
cific case of the FMCW RF as a level-meter, when the SR with qs/i < 0 corresponds 
to the reflections from the reservoir bottom, and the range to the bottom, as a rule, 
is known, the seemingly measured range to the SR will be more than a range to the 
reservoir bottom. It occurs due to an increased signal delay in the layer located over 
the bottom. This is a sign for the SR selection with qs/i < 0. 
Calculated functions rather accurately coincide with simulation results. The 
functions presented in Figure 8.11 correspond to the tracking mode, at which the 
range increment estimation is provided according to two previous measurements. 
Figure 8.11  Plots of the range to the SR, at which tracking loss occurs, versus the SIR.

242	
Parametrical Methods and Algorithms
In the case when tracking is arranged without consideration of the range increment 
estimation, the tracking loss occurs at some larger range from SR. If DR = 0.003 m, 
Rtr,1 increases about 0.02 m. For DR = 0.005 m, Rtr,1 increases by 0.03 m. Calcula-
tions are presented for l = 3 cm.
8.3.6  Range Measurement at the Presence of the Spurious Reflectors of 
Small Intensity
The MLM application for range estimation, as already mentioned, leads to the 
­necessity of using a two-stage procedure: the first stage is the preliminary estimation 
ˆR of the range with the help of the algorithm (3.4) ensuring the fall in the vicinity of 
the main LLF maximum, and the second stage is the specification of the estimation 
provided, that is, the position of the main LLF maximum is searched. SRs lead to an 
error increase of the range measurement by the algorithm (3.4), which is illustrated 
in figures in Chapter 6. Therefore, the maximum not corresponding to measured 
range will fall in the range interval 
/4
/4
R
R
λ
λ
-
<
-
<

. The MLM application in this 
case leads to anomalous errors, which value is multiplied to l/2.
Let us call such SR the SR of small intensity, which leads to the error DR of the 
range estimation R, which is less than l/4 using the algorithm (3.4). In this case, 
the LLF extreme corresponding to a measured range with a probability practically 
equal to 1 will be located in the range interval 
/4
/4
R
R
λ
λ
-
<
-
<

. Therefore, a 
possibility is opened to decrease the measurement errors using the MLM with the 
known DFS phase not resorting to the tracking algorithm. Calculations according 
to (8.17) confirmed by simulation results show that SRs of small intensity are such 
SRs, for which the range measurement error by the algorithm (3.4) does not exceed 
l/4. Such SRs lead to a lesser error of the range estimation when using the algorithm 
(3.4) than the value l/4, which ensures falling in the interval 
/4
/4
R
R
λ
λ
-
<
-
<

 of 
the LLF extreme corresponding to the required range. The displacement of the LLF 
global extreme under the influence of the SR of small intensity, according to (8.17), 
does not exceed a tenth of a millimeter. 
Figure 8.12 shows instantaneous error estimations as a function of the range 
at the presence of the SR of small intensity obtained with the simulation help (the 
carrier frequency of 10 GHz and the FM sweep of 500 MHz). The SR with the 
­ratio qs/i = 30 dB is located at a range of 3.5 m. Function 1 corresponds to the range 
measurement with the help of the algorithm (3.4), and function 2 corresponds to 
the range measurement of the algorithm on MLM basis. 
At the application of the tracking algorithm for the range measurement, the 
maximal error decreases about 82 times compared with the algorithm (3.4). In con-
trast to the tracking algorithm, the direct application of the MLM with a known 
phase for the range measurement for the SR of small intensity does not require 
limitations on the UR movement speed. 
There is practical interest in estimating the possibilities of the MLM applica-
tion with the known signal phase for the measurement of small ranges. In this case, 
the spectrum formed at w < 0 represents the specific interference, which is impos-
sible to eradicate. The simulation results performed under the conditions that the 
carrier frequency of the transmitter is 10 GHz and the FM sweep is 500 MHz are 

8.3  Reduction of Spurious Reflector Influence	
243
presented in Figure 8.13. The dotted line corresponds to the measurement using 
the algorithm (3.4), and the solid line corresponds to the range measurement on 
the MLM basis. The Blackman WF is used in the algorithm (3.4). If the error of the 
preliminary range estimation exceeds l /4, which in this case is observed at a range 
of 0.41 m, then the maximum adjacent to the global one falls into the range interval 
/4
/4
R
R
λ
λ
-
<
-
<

, which leads to anomalous errors. 
With the range increasing (an increase of relative frequency), the error of its 
preliminary estimation decreases down to a value lesser than l /4, which allows the 
MLM application and thereby significantly decreases the range estimation error. 
The application of the MLM with the known phase supposes that the PHC of the 
FMCW RF is known. Its estimation can be provided according to the procedure 
described in Chapter 4. Calculations according to (8.17) confirmed by simulation 
results show that the truncation error of a small range measurement decreases by 
82 times compared to the application of the algorithm (3.4).
Figure 8.12  Plots of the range measurement error at a presence of the SR of small intensity.
Figure 8.13  Error plots at the measurement of small ranges using the MLM. 

244	
Parametrical Methods and Algorithms
8.4  Frequency Measurement Using Methods of the Parametric 
Spectral Analysis 
8.4.1  The Algorithm of the Frequency Measurement on the Basis of 
Eigenvector Analysis in the Noise Subspace
Spectral estimation based on the analysis of eigenvectors in the noise subspace is 
concerned with methods of parametric spectral analysis (PSA) allowing the best-
resolution characteristics and a frequency estimation of narrowband signals [1]. 
Algorithms of the Pisarenko harmonic expansion (PHE), multiple signal classifica-
tion (MUSIC), and the eigenvector algorithm (EV) can be concerned with these 
methods. The significant disadvantage of the PHE algorithm in contrast to the MU-
SIC and EV algorithms is mentioned in [1] for accuracy degradation of frequency 
estimation at reduction of analyzing the sequence duration.
The idea of MUSIC and EV methods consists of the fact that p – L eigenvectors 
of the noise subspace vL=1,…, vp of the covariance matrix or modified covariance 
matrix of data from p complete eigenvectors and L main vectors will be orthogonal 
to vectors of sine signals [1]. Orthogonality property leads to the fact that the linear 
combination
	
2
H
1
( )
p
k
k
k L
a e
v
ω
= +
å
	
(8.32)
where e(w) is a vector of the complex sine (the symbol H means a sign of the com-
plex conjugation of matrix elements and its further transposition) will be equal to 
zero if the vector e(w), 
1,
i
N
=
 is one of the vectors of the sine signals. 
For the EV and MUSIC methods, we assume the spectrum estimation to be
	
EV
2
H
1
1
( )
( )
p
k
k
k L
P
a e
v
ω
ω
= +
=
å
	
(8.33)
The difference of the MUSIC and EV methods consists of the fact that in the EV 
method coefficients ak are considered equal to the value inverse to the eigenvalue of 
kth eigenvalue of lk, that is, ak = 1/lk. In the MUSIC method, all coefficients ak = 1. 
Therefore, the EV method begets a lesser number of spurious spectral peaks (SSP) 
caused by the effect of noise interference, and their intensity is significantly less than 
in the MUSIC method. It is typical for the EV method that in its spectrum the SSPs 
are absent, which can exceed (in amplitude) the spectral peaks of sine components 
that are present in the DFS. Therefore, to solve a problem of the DFS frequency 
estimation, which is received on the SR background, the EV method is preferable 
because its application allows the practical elimination of the anomalous measure-
ment errors. 
Nevertheless, the EV method has a disadvantage typical of all PSA methods. 
These methods were developed for the determination of a number of narrowband 
signals and for its frequency estimation in the case that the FFT and DFT algorithms 
do not allow sufficient resolution. It is necessary to note that the main task at the 
PSA methods application is the resolution of the narrowband components. The 

8.4  Frequency Measurement Using Methods of the Parametric Spectral Analysis 	
245
frequency estimation of these components is the secondary task. The low stability 
of spectral estimation, of which we understand the inaccurate representation of the 
power of sine components of the signal, is a fee for the increase of the resolution­ 
­capability of the spectral estimation. This leads to the fact that in the pseudo-spectrum 
(8.33) the component with a larger intensity can be represented by the SC with the 
lesser intensity. In other words, inaccurate representation of the power of separate 
signal components is demonstrated already on the level of more or less. For the DFS 
frequency estimation for signals received on the SR background, this circumstance 
has essential importance since the sign disappeared, for which it is possible to pro-
vide a selection of useful and spurious signals.
Publications [7,8] are devoted to a choice of the matrix order m and the model 
order p, which are used to calculate eigenvectors. It is recommended to use the 
modified covariance matrix or the covariance matrix of data [1] for the calculation 
of eigenvectors. The first one allows us to ensure a higher resolution (by about 15% 
to 20%). The dimension of the modified matrix is chosen starting from the sample 
number of the signal and it should be in the range m = 2p ¸ K/2. To ensure the more 
accurate range measurement at the SR presence, it is necessary that m is chosen 
to be equal or closed to its maximal possible value. As to the choice of the model 
order p, investigations [7,8] showed that the measurement error weakly depends 
upon the model order already for p ³ (2–4)L. A further increase of the model order 
is inexpedient. 
Addition of zero samples at calculations leads to increase the DFS frequency 
estimation accuracy.
However, recommendations described in [7,8] are formulated for the resolu-
tion of the sine components. The DFS of the FMCW RF has the above-mentioned 
specificity, the presence of PAM, which leads to peculiarities at the application of 
the EV method in the frequency range finding. 
In [9], the author uses the EV method for range estimation at the SR intensity, 
exceeding the intensity of the useful signal, which is typical at measurement of the 
weakly absorbed material level near the reservoir bottom. As the range to the bot-
tom is known, the SC selection of the EV spectrum corresponding to the reflection 
from the bottom does not cause difficulties. In this case, when there is a useful signal 
and one SR is caused by reflections from the bottom, it is necessary to calculate the 
ranges
	
min,max
min,max,EV /4
R
cf
K
f
=
D


	
(8.34)
where min,max,EV
f

 are the values on the minimal and maximal frequencies, at which 
the SCs of the EV pseudo-spectrum are situated, expressed through the parts of the 
p number.
As the range estimation to reflecting surface, we need to accept the value of 
min
R
 
(i.e., the estimation corresponding to the minimal range). Another variant of the 
SR selection is possible. It is necessary to determine the frequency interval DW, in 
which the SCs of the EV pseudo-spectrum, which correspond to the reflection from 
the bottom, are formed. SCs corresponding to the useful signal should be searched 
in the frequency range excluding the interval DW.

246	
Parametrical Methods and Algorithms
Figure 8.14 shows plots of instantaneous errors of range measurement with 
the help of the algorithm based on EV method using the covariance matrix of data 
(plot 1) and using the algorithm (3.4) (plot 2) obtained with the help of modula-
tion. Both plots show the distant measurement error versus the material level to 
the reservoir bottom xr
R
R
=
- . Results are obtained for the FMCW RF with the 
carrier frequency of 10 GHz and the FM sweep of 500 MHz, and the SNR is equal 
to 70 dB. At the simulation, in the first approximation, the dielectric properties of 
reservoir contents are taken into consideration, and the range to the bottom is equal 
to 15 m. At the material level movement from 14 m to 15 m, the seeming range 
to the bottom was varied from 15.5 m to 15 m; therefore, the q ratio varied from 
-3.5 dB to -4.2 dB. The DFS sample’s number was 256, the model order p = 8. At 
the calculation of the EV spectrum, the signal period is increased artificially by 64 
times. We did not use the SCs of the EV spectrum located far (more than 15 m) from 
the FMCW RF. The presented plots are obtained at the PAM absence. At the range 
estimation with the help of the algorithm (2.4), the Blackman WF was used. We 
see from Figure 8.14 that the algorithm of range estimation on the basis of the EV 
method allows an essential decrease in the measurement error caused by reflections 
from the bottom and the reduction of the IEZ. The increased error is observed only 
at a range of 15 to 20 cm from the bottom; that is, at such a range where the SCs 
of the EV pseudo-spectrum are stopping to resolve. The algorithm (3.4) shows the 
increased error at an essentially larger range from the bottom. At the spectra resolu-
tion in the Fourier basis, the measurement error is sufficiently small, and at absence 
of resolution the error sharply increases. To obtain curve 2, the algorithm (3.4) is 
modified: two maximal SCs (corresponding to the useful signal and the SR) were 
searched and that SC, which is located close to the FMCW RF, was accepted as the 
useful one. At the performance of the simulation, the inspection of the spectrum SL 
was provided. Those SCs, for which the intensity exceeds the intensity of the largest 
spectrum SL to the left of the maximal SC corresponding to SR, are accepted as the 
useful SCs. However, the specific DFS distortions are not considered in [9].
Figure 8.14  Plots of the instantaneous error of range measurement as a function of reflector 
­removal from the reservoir bottom at using of the covariance data matrix.

8.4  Frequency Measurement Using Methods of the Parametric Spectral Analysis 	
247
The PAM influence upon the application effectiveness of the range measure-
ment on the basis of the EV method causes practical interest. Figure 8.15 shows 
the function of the PAM deepness influence m, according to (4.31), on the range 
measurement error. Plots are calculated in accordance to (8.4). Curve 1 corresponds 
to the application of the algorithm (3.4). The simulation performance conditions 
are the same as for Figure 8.14. We clearly see that the PAM leads to an increase 
of measurement error. The error increase is observed at a significant range from 
the reservoir bottom. However, the benefit in accuracy is significant at the PAM 
influence on the measurement results. At the UR exit from the IEZ, it is necessary 
to transfer to the measurement on the basis of the algorithm (3.4), which is not 
sensible to the PAM.
The functions presented in Figures 8.14 and 8.15 give us reason to state that 
the algorithm of the range estimation on the basis of the EV method allows error 
reduction and the IEZ size in the very unfavorable situation when qs/i < 0. However, 
the increased computational expenses are the fee for the measurement accuracy 
increase.
8.4.2  The Frequency Measurement Algorithm by the Prony Method of 
Least Squares
The interest in the Prony method is caused because its application allows us to 
obtain a resolution close to the resolution of the EV method with much less compu-
tational expenses. The sense of the Prony method is described in [1].
We use the signal model in the form of a sum of p complex exponents: 
	
1
1
x[ ]
p
n
k k
k
n
h z -
=
= å
	
(8.35)
where hk = Ak exp(jqk) is a complex amplitude, zk = exp[(ak + j2p fk)Dt] is the complex 
exponent, Ak and ak are the amplitude and damping coefficient of the kth complex 
Figure 8.15  Plots of the function of the relative measurement error MSD versus the PAM deepness 
using the data matrix. 

248	
Parametrical Methods and Algorithms
component, fk and qk are the frequency and the initial phase of the kth sinusoid, Dt 
is the sample interval in seconds, and x[n] and n = 1,2,3,… are complex samples of 
the signal. Model parameters are selected in such a manner to fit the model to data 
samples with maximal accuracy.
At the DFS frequency measurement, the samples’ number K exceeds that mini-
mal number, which is necessary to fit the model from the p complex exponents (we 
call this p the model order). For this case, the specific method was developed, which 
in the literature [1] is called the Prony method of least squares.
The practical implementation of the frequency estimation algorithm on the 
basis of the Prony method meets definite complexities. To achieve the maximal 
resolution of the useful signal corresponding to the SR, it is necessary to define the 
optimal model order p and the DFS samples’ number. It should be noted that the 
optimization procedure of the p value and the DFS samples’ number K is absent. 
Therefore, we give the recommendation [10], which was obtained during the simu-
lation and experimental investigations.
The model order should be defined starting from the condition p » K/4. At 
an increase of the model order to this value, we can observe the essential reduc-
tion of the range measurement error. A choice of the model order in the range 
p = K/4 ¸ K/3 leads also to an accuracy increase; however, the benefit is not 
significant, and beginning from p > K/3, the measurement accuracy begins to 
decrease. The reason for the measurement error increase at small values of the 
model order p with respect to sample number K is connected with the fact that 
the coefficients am can be calculated insufficiently accurately because the equation 
systems are strongly overdetermined. At relatively large model orders, the error 
increase is caused by the fact that the above-mentioned equation systems become 
ill-conditioned.
Recommendations on a choice on the DFS sample number can be reduced to 
the following. Their number should not exceed the value 2KK (KK is the DFS sample 
number determined in accordance with the Kotelnikov theorem). A sample number 
increase more than 2KK leads to an error increase for the calculation of coefficients 
am. It is necessary to attract attention to the fact that the DFS sample number 
according to Kotelnikov depends on the range to the reflector. Therefore, it is dif-
ficult in practice to choose the optimal model order, which leads to the fact that 
the measurement error becomes a function of the range. The choice of the model 
order from the condition p = K/4 ¸ K/3 leads to a spurious SC appearance in the 
Prony spectrum. Because of the instability of SC amplitudes, the minimal SC will 
not necessarily correspond to the useful signal.
It is hypothesized in [11] to use the following procedure for the elimination 
of acceptation of the spurious SC for the spectral peak of the useful signal. Let it 
be necessary to provide the range measurement on NP DFS realizations using the 
maximal SCs of the Prony spectrum and to determine the NP values of the measured 
range according to (8.35). From the NP values of the measured range, it is neces-
sary to reject NM maximal and NM minimal values. The remaining values of the 
measured range are averaged. The method eliminated reliably anomalous errors; 
therefore, the average operation decreases the estimation variance. The two-stage 
procedure of the range estimation facilitates the reduction of an appearance prob-
ability of anomalous errors:

8.4  Frequency Measurement Using Methods of the Parametric Spectral Analysis 	
249
Stage 1:
• 
 The range estimation is searched with the help of the algorithm (3.4), 
which allows the reduction of those range intervals, in which the maximal SC 
of the Prony spectrum is searched.
Stage 2:
• 
 The above-mentioned procedure of the anomalous error elimination 
using the DFS NP realizations is used.
The typical function of the instantaneous range measurement error is shown in 
Figure 8.16 when using the Prony least square method obtained under the follow-
ing conditions. The SR is located at a range of 5.5 m, the ratio of qs/i dB, q = 70 dB, 
a DFS sample number of K = 64, and the model order of p = 34. The carrier fre-
quency and its FM sweep were, respectively, 10 GHz and 500 MHz. To obtain the 
plot at each specific range, 10 measurements to the reflector were provided, and 
two minimal and two maximal were rejected. Other values of the measured range 
were averaged. 
We see from Figure 8.16 that the application of the range measurement algo-
rithm on the basis of the Prony method allows an essential reduction on both the 
measurement error and the IEZ size compared with the algorithm (3.4). The careful 
analysis of Figure 8.16 allows the determination that the error begins to insignifi-
cantly increase from the range of less than 0.4 m to the SR. At a larger removal from 
the SR, the measurement error does not exceed the boundaries of ±1 mm. A sharp 
error increase begins from the range Rx equal to about 0.23 m only. Nevertheless, 
the maximal error value, as simulation data show, does not exceed 4 to 5 cm. 
We note that the above-mentioned plots were obtained at the PAM absence. Let 
us monitor how the PAM affects the error. Figure 8.17 shows the functions of the 
range measurement MSD versus the PAM deepness at the application of the Prony 
least squares method. Functions are obtained under the same condition as in Figure 
8.16. 
As well as at the application of the EV method, the PAM presence leads to a 
resolution degradation and to errors of the frequency determination, at which the 
maximal SC is situated. It follows from Figure 8.17 that the range measurement 
Figure 8.16  Plots on the instantaneous error of range measurement when using the Prony least 
squares method. 

250	
Parametrical Methods and Algorithms
algorithm on the basis on the Prony method is much more sensible to the PAM than 
the measurement algorithm on the basis of the EV method. 
The presented results allow the statement that the frequency estimation algo-
rithms on the basis of the PSA methods permit a decrease in the measurement er-
ror by about the order compared with the algorithm (3.4). The IEZ size decreases 
significantly as well, but these methods are sensible to the DFS distortions caused 
by the PAM. The PAM presence leads to a noticeable benefit decrease in measure-
ment accuracy. 
8.5  Range Prediction on the Basis of Consideration of the 
Movement Speed
Let us consider the variant of the FMCW RF application for the range measurement 
to the UR under the conditions when a sign of the speed vector movement is known. 
In conformity to industrial systems, this corresponds to the case when signals corre-
sponding to the approach or removal modes of the useful reflector [12] are applied 
to the FMCW RF from the automatic control system. 
We shall then assume that the UR movement speed is described by some mono-
tonic function and that the locations of all SRs are known as well. Outside the IEZ 
the range measurement is provided using the algorithm (3.4) through the same time 
intervals. We consider two situations possible in practice. 
8.5.1  Uniform Velocity of the Useful Reflector Movement
The velocity of reflector movement will be estimated in some range interval DR 
before reflector input in the IEZ. The range prediction in the IEZ will be provided 
in accordance with the formula:
	
1
vel meas
i
i
R
R
V
t
-
=
+



	
(8.36)
Figure 8.17  Plots of the relative MSD function of range measurement versus the PAM deepness at 
the application of the Prony least squares method. 

8.5  Range Prediction on the Basis of Consideration of the Movement Speed	
251
where 
i
R  and 
1
i
R -

 are, respectively, the current and previous values of measured 
range, 
vel
V
 is an estimation of the reflector movement velocity, and tmeas is the time 
interval between two consecutive measurements. 
If tmeas is fixed (not random), it is clear that the measurement error will be 
­defined by the error of the velocity Vvel estimation. The estimation of velocity at two 
consequence measurements with numbers i – 1 and i can be defined as:
	
vel,
1
meas
(
)/
i
i
i
V
R
R
t
-
=
-



	
(8.37)
where 
1
i
R -

 and 
i
R  are the estimations of the range to the reflector for two consecu-
tive measurements. The accuracy of velocity estimation is defined by two factors 
acting independently: noisy interference and the level of sidelobes of the DFS spec-
trum, that is,
	
vel,
ni,i
tr,er
i
V
V
V
V
δ
δ
=
+
+

	
(8.38)
where dVni,i is an error caused by noisy interference and dVtr,er is a truncation error 
caused by the DFS SL influence.
The average value of the random variable 
vel,i
V
 can be defined taking into con-
sideration that the range measurement estimation using the algorithm (3.4) is not 
asymptotically shifted:
	
vel,i
vel
tr,er,(
1)
tr,er,
{
}
i
i
M V
V
V
V
δ
δ
-
=
+
-

	
(8.39)
The variance of 
ni
V
 can be defined as taking into account that the estimation is 
formed at two consecutive independent measurements:
	
2
2 2
vel,
0
meas
(
)
3
/
(2
)
i
DV
N c
E
t
ω
é
ù
=
D
ë
û

	
(8.40)
which follows from (4.8).
The errors dVn,i and dVtr,er can be decreased averaging Vvel,i in the range inter-
val Rinit < Dl < Rfinal, that is, determining the average value of velocity as 
	
vel
init
ﬁnal
vel,
1
(
,
,
)
/
L
i
i
V
l R
R
V
L
=
D
= å

	
(8.41)
where L is a number of measured values Vvel,i in the range interval Dl before the 
reflector input in the IEZ.
The averaged estimation of velocity in (8.41) is designated as a function of three 
parameters: Dl,Rinit,Rfinal. The sequence of values 
vel,i
V
 as a function of i will have 
the oscillating character repeating the same character of the measurement error by 
the algorithm (3.4) with accuracy up to the phase and the span of high-frequency 
oscillations, which follows from (8.37). It is evident that the velocity estimation 
error will be minimal in the case if the integer period number of high-frequency 
oscillations is in the interval Dl. The maximal error of velocity estimation will be 
when in the interval Dl there is the integer period number plus the high-frequency 
oscillation half-period and the beginning of the interval Dl will be located in the 
point corresponding to a maximum of a high-frequency oscillation envelope. 

252	
Parametrical Methods and Algorithms
Simulation results of the range estimation procedure at the uniform reflector 
movement (estimations of velocity are provided with the step at 3 mm) are pre-
sented in Figure 8.18.
The experiment was carried out in such a manner: SR is located at a range of 
5 m; the FM sweep is 500 MHz; and the frequency of carrying oscillation is 10 GHz. 
We used the Blackman WF. Before the range of 4.092 m (at this range there is a first 
node of the high-frequency oscillation envelope) and at a range of more than 6.3 m, 
the measurement was conducted with the help of the algorithm (3.4). In the range 
interval of 4.092 to 6.3 m, the range prediction is provided on the basis of consid-
eration of the reflector movement velocity (curves 1 to 4) according to (8.36). The 
velocity estimation is performed, respectively, for ranges designated by the letters 
A, B, C, and D in Figure 8.18. Then, the loop centers of the high-frequency oscil-
lation envelope of the error function, the very unfavorable variant was chosen (a 
number of high-frequency oscillation periods is equal to the integer number plus 
a half-period). Simulation is conducted at a noisy interference absence and qs/i = 2 
dB. It is clearly seen from the figure that the algorithm of velocity account allows 
an essential reduction of the range measurement error. For example, we can note 
that at the mentioned q and the same other condition, the error achieves 18 cm. 
However, this error depends on the interval Dl. In the very unfavorable case when 
the interval Dl is chosen from the center of the first loop (point D), the measurement 
error achieves 27 mm. With Dl increasing, the error decreases rapidly.
Simulation results allow the determination that for the provision of a small 
­error of the range prediction, the velocity estimation should be carried out starting 
from the range equal to about 1.75 m to the SR (for the very unfavorable case). At 
an FM sweep DF variation, the view of the plot presented in Figure 8.18 will notice-
ably change, but conclusions concerning the interval Dl choice remain the same with 
the account of DF variation. For a carrier FM sweep of 1 GHz in the very unfavor-
able case, to achieve a small error, the velocity account should be done from the 
range twice less than at the FM sweep of 500 MHz.
Figure 8.18  Plots of the instantaneous range measurement error at the uniform velocity of reflector 
movement. 

8.5  Range Prediction on the Basis of Consideration of the Movement Speed	
253
It should be noted that at the velocity estimation from the range, at which there 
is a node of a high-frequency oscillation envelope, the velocity estimation error 
decreases owing to reduction of dVn,inter,i. As an example, we may show that at a 
­velocity estimation, beginning from the second node before the SR, the error of 
range prediction does not exceed 1 mm and part of a millimeter for the velocity 
­account beginning from the range, at which there is a third envelope node. The vari-
ance of a range prediction in the range interval, where the prediction is performed 
with an account of the velocity estimation, is determined as according to (4.8): 
	
2
vel
2
s/n
2.25
(
)
L(
)
c
D R
q
ω
=
D

	
(8.42)
which is confirmed by the simulation results.
The plots presented in Figure 8.18 are obtained using the Blackman WF and for 
the FM sweep of 500 MHz. The application of another WF leads to a plot varia-
tion. The increase of the FM sweep allows a proportional reduction of the range 
to the reflector beginning from which it is necessary to take into consideration the 
velocity of its movement. 
8.5.2  The Nonuniform Velocity of the Useful Reflector Movement 
For practice, this is the most interesting case because by using the FMCW RF as a 
level-meter, the performance of the pumping equipment can depend both upon the 
reservoir loading degree and the properties of contents. We assume that the reflector 
movement velocity can be described by an exponential function with an unknown 
damping decrement a; that is,
	
init
( )
( )exp(
)
V R
V
R
R
α
=
-
	
(8.43)
where Vinit(R) in an initial value of reflector velocity at range R from FMCW RF 
to SR.
It is necessary to note that the function choice (8.43) described the velocity 
variation and the choice of the damping decrement a (chosen to ensure the veloc-
ity variation by 20% at range variation by 2 m) has to a great extent an arbitrary 
character. Nevertheless, the simulation performed under the above-mentioned as-
sumptions allows us to obtain an answer about the behavior of the range prediction 
error under conditions when the approximated function has an oscillating character 
caused by the influence of the spectra SL of the interference and the useful signal.
As usual, we assume that the outside IEZ measurements are conducted using 
the algorithm (3.4).
It is possible to decrease the error accumulation at the prediction in the case if 
we can determine some function describing the velocity variation as a function of 
the number of measurement n. At input in the IEZ, we form the range estimation on 
the basis of the found function assuming as usual that tmeas is not random. It seems 
simple to determine the approximation of this unknown function (in general) in the 
form of a polynomial of the order Kp:

254	
Parametrical Methods and Algorithms
	
1
( ),
1,2,
..
P
K
n
i
i
V
b n
n
N
=
=
=
å
…
	
(8.44)
where the sequence of polynomial coefficients is chosen by the least squared method, 
that is, the following function is minimized: 
	
2
1
( )
(
)
N
n
n
n
Q b
V
V
=
=
-
å

	
(8.45)
Simulation results are presented in Figure 8.19. 
Simulation conditions are the same. The only difference is that simulation is 
carried out at the SNR of 70 dB. In the whole range interval including the IEZ, we 
used the algorithm (3.4). At its basis, according to (8.44), the velocity is estimated 
at each nth measurement. In the IEZ, the calculated value in accordance with the 
found function 
( )
V
f n
=
 described the UR velocity variation versus range is ac-
cepted as the range estimation (i.e., the nonlinear function of velocity versus range 
is considered). At simulation, the function (8.43) is approximated by the polyno-
mial of the second order. 
The simulation showed that only the value of the range interval at the input in 
the IEZ, in which the determination of 
( )
V
f n
=
 occurs, influences noticeably on the 
prediction error. The prediction error depends very little on where the determina-
tion 
( )
V
f n
=
 occurs: from the node or the loop of envelope. Curve 1 corresponds 
to the estimation 
( )
V
f n
=
 beginning from point D (see Figure 8.18). Curve 2 is the 
estimation of 
( )
V
f n
=
 provided from the range at which there is a ninth node of 
the oscillation envelope of the error curve (i.e., from a range of about 1.9 m from 
the IEZ). We see from Figure 8.19 that the prediction error is high enough. The 
application of the described procedure allows its reduction compared to using the 
algorithm (3.4) only by three to six times. However, it is necessary to note that 
the SIR increase leads to a proportional decrease of the range prediction error. In the 
Figure 8.19  Plots of instantaneous measurement error for the nonlinear velocity variation. 

8.6  Conclusions 	
255
case when the UR velocity is uniform, the prediction error decreases to the values 
of the order in units of millimeters. 
8.6  Conclusions 
The investigation of different methods allowing reduction of the range measure-
ment error at SR presence permits us to determine the following. SR cancellation is 
most effective at an offered frequency variation of the FMCW RF-carrying oscilla-
tion. In this case, the application of the cancellation mode allows a decrease in the 
IEZ approximately by the order at the frequency varying of the carrying oscillation 
within the limits commensurable with the FM sweep of the oscillator frequency, 
which is quite feasible in practice. 
The tracking algorithm allows the reduction of the range measurement error 
by 82 times compared with algorithms using a spectrum in the Fourier basis. It is 
proved that the admissible velocity of the reflector movement depends on the SIR. 
At qs/i = 2 dB, the reflector movement from one measurement to another should not 
exceed l /8 and may be increased to the value l /4 at the decrease of the SIR. The 
range to the SR is determined with an intensity exceeding the useful signal intensity 
at which the tracking loss happens. This range is equal to about 1.5dR at qs/i = –4.5 
dB.
The feasibility study of the range estimation algorithm application is performed 
based on the eigenvector analysis in the noise subspace for the range measurement to 
the content level in reservoirs. It is shown that the PAM significantly affects the accu-
racy characteristics of such an algorithm of range estimation. Depending on the PAM 
deepness, the range measurement error can be reduced approximately by the order. 
The algorithm of range estimation is offered based on the application of an-
other PSA method, the Prony method. Depending on the PAM deepness, the range 
measurement error can be reduced approximately by the order as well. It is shown 
that the range estimation algorithm on the basis of the Prony method is more sensi-
tive to the PAM influence. We note that the PSA methods do not allow adequate 
elimination of the SR effect.
The investigation of the range estimation algorithm at the SR presence is pro-
vided based on the estimation of the velocity of the reflector movement. It is proved 
that the velocity estimation accuracy depends upon the range interval at which it is 
estimated. At the UR movement, the velocity estimation should be provided begin-
ning from the range of about 10dR to the SR. The reduction of the range measure-
ment error in this case is equal to approximately two orders. At the nonuniform 
SR movement, the range measurement error essentially increased. At other equal 
conditions, it reduces by about three to six times. 
Our experience of working with FMCW range-finders leads us to the conclu-
sion that there is not a universal solution that permits minimizing the SR influence 
in all practical situations. The conditions of the FMCW RF functioning, especially 
for range measurement to liquid media, may vary. We must choose this method 
for the SR influence minimization taking into consideration the peculiarities of the 
device application, computing resources of the FMCW RF processor, and require-
ments for its accuracy.

256	
Parametrical Methods and Algorithms
References
[1]	 Marple, S. L., Jr., Digital Spectral Analysis with Applications, Englewood Cliffs, NJ: 
­Prentice-Hall, 1987.
[2]	 Imada H., and Y. Kawata, “New Measuring Method for a Microwave Range Meter,” Kobe 
Steel Eng. Repts., Vol. 30. No. 4, 1980, pp. 79–82.
[3]	 Parshin, V.S.; V. M. Davydochkin, V. S. Gusev, “Compensation of Spurious Reflections’ 
Influence on Distance Measurement Accuracy by FMCW Range Finder,” Digital Signal 
Processing and Its Application. – Proceedings of RNTORES Named after A.S. Popov. 
No. 5, Moscow, Vol. 1, 2003, pp. 261–263. [In Russian.]
[4]	 Parshin, V. S. “Tracking Frequency Meter of the Beating Signal of the Radio Range Finder 
with Frequency Modulation of Radiated Signal,” Digital Signal Processing and Its Applica-
tion. – Proceedings of RNTORES Named after A. S. Popov. No. 10, Moscow, Vol. 1, 2008, 
pp. 395–398. [In Russian.]
[5]	 Patent 2410650 (Russian Federation), INT.CL. G01F 23/284, G01S13/34. “Method of 
Material Level Measurement in a Reservoir,” B. A. Atayants, V. S. Parshin, V. V. Ezerskiy. 
Bull. No 3. Filed November 1, 2008; published January 27, 2011.
[6]	 Lindsey, V., Synchronization Systems in Communication and Control, Moscow: Sovetskoe 
Radio Publ., 1978, 600 p. [In Russian.]
[7]	 Kavex, M., A. J. Barabell, “The Statistical Performance of the MUSIC and the Minimum-
Norm Algorithms for Resolving Plane Waves in Noise,” IEEE Trans. Acoust. Speech Signal 
Process, Vol. ASSP-34, April 1986, pp 331–341.
[8]	 Wang H., M. Kavex, “Performance of Narrowband Signal-Subspace Processing,” Proceed-
ings of the 1098 IEEE International Conference on Acoustics, Speech, and Signal Process-
ing, Tokyo, Japan, April 1986, pp. 589–592.
[9]	 Wax, M., T. Kailath, “Detection of Signals by Information Theoretic Criteria,” IEEE Trans. 
Acoust. Speech Signal Process, Vol. ASSP-33, April 1985, pp 387–392.
[10]	 Parshin, V. S., A. A. Bagdagiulyan, “Distance Measurement to Material Level in a Reser-
voir at Presence of Spurious Reflections Exceeding the Useful Signal in Intensity,” Digi-
tal Signal Processing and Its Application. – Proceedings of RNTORES Named after A.S. 
Popov. No. 8, Moscow, Vol. 1, 2006, pp. 306–308. [In Russian.]
[11]	 Parshin, V.S.; V. V. Ezerskiy, “Application of Algorithms of Parametric Spectral Analy-
sis at Distance Measurement with the Help of Radar Range Finders with the Frequency-
­Modulated Signal,” Digital Signal Processing and Its Application. – Proceedings of 
RNTORES named after A.S. Popov. No. 7, Moscow, Vol. 1, 2005, pp. 234–238. [In 
­Russian.]
[12]	 Patent 2399888 (Russian Federation), INT.CL. G01F 23/284, G01S13/34. “Method of 
Material Level Measurement in a Reservoir,” B. A. Atayants, V. S. Parshin, V. V. Ezerskiy, 
S. V. Miroshin. Bull. No. 26. Filed January 26, 2009; published September 20, 2010.

257
c h a p t e r  9
Testing of Precision Measuring Systems 
of FM Short-Range Radar and Areas of 
Its Practical Application 
9.1  Introduction
Development, testing, calibration, attestation, and verification of FM RF are ful-
filled with the help of exemplary installations or test benches, in which the standard 
reflector can be mounted at a specified distance from the FM RF with a specific 
accuracy. It was shown in Chapter 6 that sizes and shape of the reflector affect the 
measurement accuracy. As an example, Figures 9.1(a, b) show the calculated (lines 
1 and 2) and experimental (line 3) dependence of the distance measurement error to 
the disk with a diameter of 530 mm as a function of measuring distance when using 
the antenna with an aperture diameter of 50 mm (lines 1 and 3) and 145 mm (line 
2) in FM RF. The frequency tuning range at FM is 1 GHz with a central frequency 
of 9.8 GHz. We see here a good correspondence of theoretical and experimental 
results. 
It follows from Figure 9.1 that, using of the disk as the standard reflector, the 
measurement error is inadmissible largely for any practical tasks and, moreover, 
this error essentially depends upon the width of the antenna DP used in the FM RF. 
In this context it is necessary to estimate the possibility of radar reflector develop-
ment that provides acceptable accuracy.
In addition, we consider in this chapter the possible application areas of the 
FM RF in industry and in scientific research. Naturally, it is impossible to cover 
all application areas with a high degree of detail. Nevertheless, we note that the 
above-mentioned material has a rather general character and can be used in many 
practical problems, which have been detailed in the Introduction. 
9.2  Equipment and Approaches for the Experimental Estimation of 
FM RF Characteristics 
For reliable measurements of FM RF characteristics, which have a small error, the 
plane infinite radar reflector (RR) is the ideal standard. However, it is practically 
impossible to realize the conditions under which RR can be considered to be infi-
nite. From Figure 9.1, we see that when using the circular disk as a standard RR, 
at the distance reduction the error decreases to a low level, when the RR angular­ 

258	
Testing of Precision Measuring Systems of FM Short-Range Radar
size becomes commensurable and more than the width of the FM RF antenna  
DP on the zero level (i.e., when the RR edge is not radiated by the probing wave). 
­Using such an approach to solve the error reduction and for the variety of practical 
problems that occur with RF antennas, the RR diameter should be commensurable 
with the length of the FM RF operating zone, which is practically unrealizable. In the 
context of meteorological FM RF support, the choice of RR geometry is important, as 
the configuration must be such that at minimal possible sizes it can provide a correspon-
dence of measured geometric and electro­dynamic distances. Taking into consideration 
that for high measurement accuracy in the FM RF the wideband signals are used, the 
standard RR also must operate in the wide-frequency range. The information presented 
here shows the importance of standard RR development with specific ­properties. 
The issue of SR reduction to the necessary level in the FM RF operating zone is 
no less important than the creation (if necessary) of the interference situation with 
specific features. These conditions can be satisfied most completely in that provid-
ing measurements in an anechoic chamber has a necessary level of the SR reduction, 
in which the standard RR can be located with difference characteristics emulating 
both the UR and SR. The general requirements for which the anechoic chamber 
0.5
1
1.5
2
2.5
3
3.5
4
0.5
1.5
2
2.5
3
3.5
1
Figure 9.1  The plot of the distance (to the disk) measurement error versus the measuring distance: 
(a) calculated results and (b) experimental results.

9.2  Equipment and Approach for the Experimental Estimation of FM RF Characteristics	
259
must be satisfied are described in [1]. Due to the specifics of the FM RF operation, 
these requirements may be corrected. 
9.2.1  Synthesis of Radar Reflectors for Precision Measurements
The plane RR is mounted at a distance R1 perpendicular to the direction on the 
one-position FM RF (Figure 6.18). Let us choose an RR configuration so that the 
reflected field in the specified frequency range and in the specified space area would 
differ as low as possible from the field reflected by the plane infinite reflecting sur-
face. One can formulate several equivalent criteria of RR optimality. In particular, 
we state the problem of RR creation, which, at specified sizes and a given length 
of the operating zone, provides in the operating zone a minimum of the complex 
amplitude of the interference field (a minimal SLL of a complex amplitude modulus 
of the interference field depending on frequency). 
In this sense, we may consider the frequency dependence of a complex amplitude of 
the RR interference field (frequency response) as optimal and creating RR as optimal.
As we consider the problem of the minimization of RR sizes, we may assume 
that its angular sizes with regard to the point of the FM RF antenna location are 
small and that linear sizes often exceed the wavelength. In such a case, to determine 
the reflected field, we can use the scalar Kirchhoff approximation (6.15).
Equation (6.18) allows the application of known methods of antenna synthesis 
for RR synthesis. To determine the RR geometry, we can use the classical method 
of antenna synthesis called the Dolph-Chebyshev method [2].
Let us fulfill the RR in such a manner that its edge coincides with the circles of 
a radius r1, r2,…, rN (Figure 9.2) in sectors F1, F2, …, FN. 
Then the normalized complex amplitude of the interference field (6.19) is de-
fined by the following sum: 
	
0
int
[(
l)
]
int,norm
1
N
jk i
v d
i
i
U
U
C e
U
λ
-
-
+
¥
=
=
= å



	
(9.1)
where 
2
1
2
( )
(0) 2
i
i
i
i
R
F
C
F
r
θ
π
F
=
, 2
2
2
1
i
i
r
R
ρ
=
+
; d ³ 0; vl 0 is the radius variation value of the 
RR edge, and l 0 is the wavelength of the carrying oscillation on the average fre-
quency of the tuning range. Please note that the sector numeration happens in the 
order of a radius increase of the RR edge. 
Figure 9.2  The determination of the planar RR shape.

260	
Testing of Precision Measuring Systems of FM Short-Range Radar
Omitting further transformations, which are similar to [2], we give the equation 
for the amplitude-frequency response (AFR) of the interference field of the optimal 
RR. Its AFR is represented by the Chebyshev polynomial  
	
1
0
int,norm
2
1
0
2
1
2
1
1
1
1
( )
2
(cos
/2)
coskv 2
M
i
i
M
M
i
U
k
C T
kv
T
T
λ
λ
α
α
-
-
-
-
=
é
ù
æ
ö
æ
ö
=
=
×
ç
÷
ç
÷
ê
ú
è
ø
è
ø
ë
û
å
	
(9.2)
where M = N/2.
The parameter a at a known number of sectors defines the frequency range 
0
cos(
/ )
vf f
π
α
£
 and the deepness of the interference field decrease Q = T2M–1(1/a). 
If a number N of RR sectors, the value v, the frequency range, and the deepness 
of the interference field suppression are specified, coefficients Ci determining the RR 
geometry will be [3]:
	
2
1
2
1
1
(2
1)
1
(
2)!
( 1)
2
(1/ )
(
)!(
1)!(
)!
M
M
i
M
M
M
C
T
i
i
M
µ
µ
µ
µ
α
α
µ
µ
µ
-
-
-
=
-
+
-
æ
ö
=
-
ç
÷
è
ø
-
+ -
-
å
	
(9.3)
where i = 1, 2,¼M;  M = 0.5N.
For an RR with an odd number of sectors:
	
2
2
1
1
1
(
1)!
( 1)
(1/ )
(
)!(
)!(
)!
M
M
i
M
M
M
C
T
i
i
M
µ
µ
µ
µ
α
α
µ
µ
µ
-
-
=
+
-
æ
ö
=
-
ç
÷
è
ø
-
+
-
å
	
(9.4)
where i = 1, 2,¼M;  M = 0.5(N – 1).
Deepness and the range of interference field of the optimal RR are unambigu-
ously connected by the equation
	
(
)
(
)
1
1
1
1
2
2
1
1
1
1
2
N
N
Q
Q
Q
Q
α
-
-
ì
ü
ï
ï
=
+
-
+
-
-
í
ý
ï
ï
î
þ
	
(9.5)
and the number of RR sectors is defined by the specified values of a and Q: 
	
arch
1
arch 1/
Q
N
α
=
+ 	
For simplification of further formulas, we designate the maximum and mini-
mum frequencies of the tuning range, respectively, as fmax = faver + Df and fmin = 
faver – Df, where Df = DF/2, faver is average frequency of the tuning range. Then 
cos[pn(1 + Df/faver)] = –a, cos[pn(1 – Df/faver)] = +a. Summing term by term these 
equalities, we obtain cospn × cospnDf/faver = 0.
In this equation, the constant n should be such that the equality fulfils any 
values of Df/faver; hence, n = 0.5, 1.5, 2.5, …; that is, the step value of RR sector is 
equal to the odd number of Fresnel zones on the average frequency of the tuning 
range. There will be a minimal RR size in case n = 0.5 on the central frequency of 
the tuning range. 

As dl is not included in the AFR equations, it can be any value. However, at 
growth of d, the sizes of RR increase.
Using the above-mentioned approach, we can design RRs with a very different 
AFR for the suppression of the interference field. For instance, to realize the maxi-
mally plane characteristic, the coefficients Ci defining the RR configuration should 
be distributed according to the binomial law. 
An RR with a smooth edge presents challenges as well. The RR’s shape and 
sizes can be obtained if the number N of the RR sectors is increased without limit 
and the step value nl0 is decreased in such a manner that a maximal RR size pmax 
would be constant. Therefore, the equations for AFR in some cases will be simpli-
fied and then the AFR of the optimal RR takes a form:
	
(
)
2
2
2
int,norm
aver
1
( )
ln
1
2
f
U
f
ch
Q
Q
b
Q
f
π
æ
ö
=
+
-
- ç
÷
è
ø
	
(9.6)
where 
max
1
0
2
/2
0.5
b
R
ρ
λ
=
 is the maximal RR size at f = faver normalized to the 
diameter of the first Fresnel zone.
The RR configuration realizing the following function of the complex ampli-
tude of the interference field  
	
aver
2
int,norm
aver
aver
( )
sin 2
2
f
j
bf
f
f
U
f
e
b
b
f
f
π
π
π
-
æ
ö
æ
ö
=
ç
÷
ç
÷
è
ø
è
ø
	
(9.7) 
is defined by the equation
	
2
1
2
( )
const
R
d
F
dr
r
ϕ
Q
=
	
(9.8)
We note that the RR created according to the specified error of the FM RF in 
which the antenna with a wide DP is used provides an error reduction compared to 
the antenna with less DP width. In this context, it is recommended to define the RR 
shape for the omnidirectional antenna. Then, for a kr >> 1 equation for the RR con-
figuration with AFR for suppression of the interference field, (9.7) becomes:
	
0
1
4
R
b
ϕ
λ
ρ
π
=
	
(9.9)
The RR configuration in (9.9) is presented in Figure 9.3. For clarity, the first 
and second Fresnel zones (circles 1 and 2) are shown by a dotted line and a chain 
line, respectively. 
A nonsymmetric RR shape leads to a nonsymmetric distribution of the inter-
ference field around the pointing direction to the RR center and to the function of 
the measurement error upon the mutual orientation FM RF and RR around the 
antenna axis. To decrease the nonsymmetry degree of the interference field distribu-
tion according to presented approach, we can make symmetric multilobe RRs. 
It is evident that we can rewrite (6.19) as a sum:
	
1
o
2
2 (
)
1
int,norm
2
1
1
( )
2
(0)
i
i
N
i
j k r r
i
R
F
U
e
d
F
r
θ
ϕ
π
+
F
-
-
=
F
=
å ò

	
(9.10)
9.2  Equipment and Approach for the Experimental Estimation of FM RF Characteristics	
261

262	
Testing of Precision Measuring Systems of FM Short-Range Radar
where 
p
+
= F
- F
=
å
1
1(
)
2
N
i
i
i
.The results of (9.1) through (9.9) are applicable to each 
item of this sum. Moreover, the expressions presented are invariant to the direction 
on the angular coordinate counting. It follows from this that this approach can 
be applied for multilobe, in particular, symmetric doubled-lobe RRs (Figure 9.4). 
Therefore, (9.9) must be shown as: 
	
0
1
0
1
0
1
0
1
4
,
0
4
2
4(
)
,
4
2
4(
)
3
,
4
2
4(2
)
3
,
2
4
2
R
b
R
b
R
b
R
b
ϕ
λ
π
ϕ
π
π
ϕ
λ
π
ϕ
π
π
ρ
ϕ
π
λ
π
ϕ
π
π
π
ϕ
λ
π
ϕ
π
π
ì
£
<
ï
ï
ï
-
£
<
ïï
= í
-
ï
£
<
ï
ï
-
ï
£
<
ïî
	
(9.11)
It follows from (9.7) that for deep reduction of interference level caused by the 
restricted RR size, its size should be not less than two Fresnel zones at a maximum 
distance from the antenna for f = faver. 
The distance measurement error to the reflector has an oscillating character. 
Figure 9.5 shows the calculated error functions versus distance between RR and an 
FM RF antenna, where the bold line denotes the RR with configuration (9.11) and 
maximal value r = 750 mm and the thin line denotes the disk with a radius of 750 
mm. In the FM RF with a tuning range of 1 GHz and a central frequency of 9.8 
GHz, the antenna with an aperture diameter of 50 mm is used.
Figure 9.3  RR configuration.

We see from Figure 9.5 that the RR application with the configuration (9.11) 
provides a reduction of the maximal level of the measurement error to about 
2.5 mm; that is, by more than 20 times compared with the equidimensional disk. 
At rmax growth, further error reduction is possible. 
For optimal RRs with the function of the interference field amplitude versus 
the frequency and distance in (9.6), the distance measurement error Drerr is defined 
by given value of Q in (3.22). Therefore, for the required suppression deepness of 
the interference field corresponding to the given distance measurement error, the 
maximal RR size normalized to the diameter of the first Fresnel zone on average 
frequency and for the maximal distance will be: 
	
2
2 ln
1
b
Q
Q
π
é
ù
=
+
-
ë
û	
(9.12)
Figure 9.4  Configuration of double-lobe RRs.
Figure 9.5  Distance measurement error to the RR. 
9.2  Equipment and Approach for the Experimental Estimation of FM RF Characteristics	
263

264	
Testing of Precision Measuring Systems of FM Short-Range Radar
This function is shown in Figure 9.6.
From the curve presented, we see that for a specified operating zone, the signifi-
cant increase of suppression deepness of the interference field by the optimal RR 
requires an insignificant increase of its geometrical sizes.
9.2.2  The Test Bench for the Measurement of the FM RF Parameters
The main constructive signs of a few test benches described in publications are gen-
eralized, but at the same time the above-mentioned approach for the RR calculation 
used at development of the measuring test bench at the company CONTACT-1 allows 
essential improvement in the main parameters of the test bench (to decrease the error) 
and widen functional possibilities (to create a specified interference situation) [3, 4].
The measuring test bench MTB-1 (Figure 9.7) is mounted in a room with geo-
metrical sizes 17 × 8 × 3 m and is called the measuring room (MR). Therefore, the 
length of the MR operating area is 16 m. All elements of the MR construction po-
tentially capable of creating intensive nonresolvable interference at movement of the 
standard RR in any point of the operating zone are closed by an absorbing material 
with a reflection coefficient of –30 dB in the specific wavelength range. The general 
view of the test bench is shown in Figure 9.8. In contrast to known test benches, here 
Figure 9.6  Plot of the normalized maximal size of the optimal RR versus the suppression deepness 
of the interference field. 
Figure 9.7  General view of the test bench (the numerical designations are explained in the text).

the standard RR 3 smoothly moves with respect to the FM RF mounted on a special 
rigid mounting post 1, allowing an accurate positioning of the FM RF. Movement is 
provided with the help of a lightweight but rigid trolley 7 moving along the direct-
ing tubes 4 and supplied by the fixing facility in arbitrary point 3 of the distance. All 
constructive elements of the trolley are covered by absorbing material.
The weakly reflected post is located on the trolley, which is a support for the 
standard reflector 3 mounting. The possibility of changing RR is anticipated, emu-
lating different reflecting properties of the target or measuring level. The position of 
the standard RR is adjusted in three planes. The possibility of mounting in the MR 
the additional RR is anticipated for the creation of an interference situation with 
specified properties emulating different reflecting properties of interference. 
To determine the electrical distance to the RR, the standard scale 5 with a con-
stant of 1 mm is attached to one of the directing tubes. The scale is stretched by 
weight 6 suspended on the tape measure attached to the trolley. Distance reading is 
provided with the help of the Vernier scale 7 located on the trolley. This setup allows 
for position adjusting of the standard RR with regard to adjusting the plane with an 
error of not more than 0.2 mm.
Special measures are used to eliminate mirror reflection from the ceiling and the 
floor of the MR. For this purpose, shields are suspended on the ceiling from absorb-
ing material. To eliminate the reflection from the elements of the trolley construc-
tion, the shield from the absorbing material is attached to the front of the trolley.
A practically achieved reduction of the background reflection level can be in-
directly estimated on the basis of distribution of the distance measurement error 
along the MR. The error distribution measured with the help of the level-meter with 
the frequency tuning range of 0.5 GHz is presented in Figure 9.8. Error distribution 
without shielding of lower beam is presented by the thin line and shielding of the 
lower beam (mirror reflection from the floor) is presented by the bold line. 
We see that the background reflection is rather large and nonuniformly distrib-
uted in the distance. Therefore, it must be taken into account at measuring error 
estimation and for the FM RF calibration. 
Figure 9.8  Error distribution for the distance measurement along the MR. 
9.2  Equipment and Approach for the Experimental Estimation of FM RF Characteristics	
265

266	
Testing of Precision Measuring Systems of FM Short-Range Radar
9.2.3  The Procedure of Carrying Out Measurements
During testing of an industrially manufactured FM RF, all metrological measure-
ments are provided according to the procedure defined by an appropriate standard. 
The main error is defined by the results of distance measurement in five uniformly 
distributed fixed points of the operating distance range. However, this procedure 
does not take into consideration the presence of an additional spurious background 
reflection typical for radio-wave measuring devices. It is shown in Chapter 6 that 
at the SR presence located at a fixed distance from the UR, the plot corresponding 
to the true distance error is displaced by the value determined by the ratio of the 
UR and SR parameters. From this the conclusion follows that for unbiased and 
reliable determination of the main measurement error, it is necessary in each of the 
above-mentioned distance points to provide the measurement of the error function 
versus the distance with the step D that does not exceed that of the octant part of 
the wavelength of the carrying UHF oscillation during no less than one ED. We can 
reliably determine the true measurement error of the FM RF according to the oscil-
lation span of this plot. 
To fulfill such measurements on the measuring test bench, it is necessary to have 
equipment that allows us to fix the measured distance and measurement result. In 
this context, it is advisable to use a personal computer (PC) with special software. 
All results mentioned later for the specific samples of the FM RF are obtained 
according to the above-mentioned procedure and using the appropriate software 
packages, which allowed us to fix all necessary variables in the computer memory. 
9.3  Experimental Reduction of the Error Caused by Virtual Interference
The influence of practically existing interference signal components on the fre-
quency estimation error in radar systems is investigated in detail in many publi-
cations [5–8]. At the same time, the influence of virtual interference has not been 
analyzed enough. Therefore, researching the practical error level caused by the in-
fluence of virtual interference and about the possibility of reducing these errors is 
appropriate.
9.3.1  The Waveguide-Measuring Test Bench
To eliminate the influence of the additional spurious background reflection typical 
for radio-wave devices, experimental research was conducted on the waveguide-
measuring test bench with a serial sample of a level-meter (type BARS 351), in the 
transmitter of which an attenuator was added to reduce the radiated power. The 
block diagram of the measuring test bench is shown in Figure 9.9. 
The level-meter is connected with a PC with special software for distance es-
timation according to the spectrum maximum of the weighted DFS. The DFS is 
formed at the wave reflection from the standard waveguide load. 
The pin (in Figure 9.9, irregularity) with adjustable depth of immersion is em-
bedded in the waveguide through the nonradiated slot in the wide wall. The im-
mersion depth of the pin into the waveguide is calibrated on the level of reflection 

9.3  Experimental Reduction of the Error Caused by Virtual Interference	
267
coefficient modulus G. The slot length in the waveguide is 800 mm, which allows 
us to vary the normalized pin position along the waveguide axis within the limits of 
3.6 at a frequency tuning range from 9.55 to 10.05 GHz.
9.3.2  Experimental Research on the Possibility of Reducing Virtual 
Interference Influence 
Figure 9.10 shows the normalized measurement results of the distance estimation 
error versus the pin position along waveguide axis. The presented function is ob-
tained for G = 0.1, qs/n = 60 dB.
The function of the normalized error of distance estimation to irregularity prac-
tically coincides with the theoretical error function versus the distance difference 
between UR and SR (3.21).
Figure 9.11 shows the normalized distance estimations versus a reflection co-
efficient modulus from the pin at two fixed normalized pin positions along the 
waveguide axis:
x
• 
1 = b1 = b2 = 2.544 (bold line) when a given AWF zero coincides with a 
normalized interference position;
x
• 
1 = 1.02, b1 = b2 = 2.544 (thin line) when a given AWF zero does not coin-
cide with a normalized interference position. 
Figure 9.9  Block diagram of the measuring test bench.
Figure 9.10  Plot of the normalized error of frequency measurement versus the normalized distance 
to irregularity in the AWP.

268	
Testing of Precision Measuring Systems of FM Short-Range Radar
In both cases, the estimation error is practically proportional to the reflection 
coefficient modulus; however, the coincidence of a given AWF zero with a normal-
ized irregularity position in the AWP allows the reduction of the distance measure-
ment error caused by a combination interference from 7.2 to 19.5 times (depending 
on the reflection coefficient value) compared with the case of a normalized irregu-
larity position specification x1 » 0.4 · b1 corresponding to the EE maximum for a 
chosen fixed AWF zero position. 
The presented results confirm the results of numerical experiments and theoreti-
cal results. From this, it follows that the procedure of a distance estimation error 
reduction on the background of nonresolvable virtual interference, including the 
coordinated choice of constructive AWP solutions and algorithms of the difference 
Figure 9.11  Plot of the normalized error of frequency measurement versus the reflection coefficient 
modulus from irregularity in the AWP. 
Figure 9.12  Plot of the normalized error of distance measurement versus the relative irregularity 
position in the AWP at a radiated power of 20 mW.

9.4  Results of Experimental Reduction of the Distance Measurement Error	
269
signal processing allows an essential reduction of the measurement error under 
conditions leading to property variations of virtual interference. 
9.3.3  Influence of Radiated Power Level on the Distance Estimation Error 
Caused by Virtual Interference Influence
For precision systems of the FM short-range radar, the question about the opti-
mal radiated power level at which the measurement error becomes minimal, is  
important. 
The estimation of theoretical result fidelity is inspected in comparison with 
the experiment results. Experimental functions of instantaneous values of the rela-
tive error of distance Dx estimation versus the relative irregularity position in the 
AWP similar to theoretical functions (Chapter 6) are presented in Figures 9.12 
and 9.13.
It follows from Chapter 6 that the measurement error component caused by 
virtual interference and the accompanied wave flow significantly depends upon 
probing signal power and decreases with its reduction, which is confirmed by com-
parison of experimental results presented in Figures 9.12 and 9.13. As we can see, 
that admissible reduction degree of radiated power level is defined by the SNR and 
at probing, for instance, of the plane surface, the optimal level of radiated power 
is 1 to 2 mW. 
9.4  Results of the Experimental Reduction of the Distance 
Measurement Error by the Control of the Adaptable Weighted 
Function Parameters
In Section 7.4, the rather simple procedure of measurement error reduction on the 
background of nonresolvable interference is described. Nevertheless, the presence 
of unstable zones of frequency estimation defined at the theoretical analysis of ap-
proach to the error reduction necessitates experimental research to determine the 
Figure 9.13  Plot of the normalized error of distance measurement versus the relative irregularity 
position in the AWP at a radiated power of 2 mW.

270	
Testing of Precision Measuring Systems of FM Short-Range Radar
correspondence of practical achievement results to theoretical ones. As mentioned 
earlier, experimental investigations are fulfilled at a waveguide test bench as de-
scribed in Section 9.2. Due to the fact that instability of distance estimations is 
manifested mainly in the situation of fixed interference position approaching the 
UR and SR, this situation should be investigated experimentally. In this context, the 
difference in experiment fulfillment consists of the fact that the interference signal 
formed by irregularity in the AWP (in this case, the pin) is located at such a fixed 
distance that does not take into account the rereflections between the device input 
and formed irregularity. The useful signal is obtained from the moveable short-
circuit piston. Electrodynamic distance to spurious irregularity is estimated at the 
moveable piston replacement by a matched load. 
The experimental results presented next are obtained at an interference ampli-
tude of about 0.2 from useful signal amplitude reflected by the moveable piston. In 
the experiment, qs/n = 60 dB.
Figure 9.14 shows the normalized functions of the distance estimation error 
versus the normalized distance between the short-circuit piston and the pin using 
the Blackman WF, and Figure 9.15 shows the normalized functions of the distance 
estimation error versus the normalized distance between the short-circuit piston 
and the pin using the uniform WF. 
Figure 9.16 shows the normalized functions of the estimation error of the cor-
rected distance using the developed approach of the estimation correction with 
restriction of the correcting coefficient value in the possible instability zone of the 
frequency estimation (see Chapter 7). 
We see from these figures the good qualitative coincidence of experimental and 
theoretical results that are described in Section 7.4. 
The results of the developed approach application to real signals were com-
pared with the results of the distance estimation during processing of the same array 
Figure 9.14  Plot of the measurement error versus the normalized mutual distance between the pin 
and the piston using the Blackman weighted window. 

9.4  Results of Experimental Reduction of the Distance Measurement Error	
271
of recorded signals by known high-resolution methods, from which the EV method 
[9] shows the best results. The experimental function of the measuring error versus 
normalized distance is presented in Figure 9.17 for the EV method.  
A comparison of Figures 9.16 and 9.17 shows that the developed approach at 
a small interference level does not yield to the EV method in the distance measure-
ment error, but essentially gains in computing expenses and in error value, when 
interference and signals are resolvable. 
Figure 9.16  Plot of the error function of the corrected estimation versus the normalized mutual 
distance between the pin and the piston.
Figure 9.15  Plot of the measurement error versus normalized mutual distance between the pin and 
the piston using the uniform weighting window. 

272	
Testing of Precision Measuring Systems of FM Short-Range Radar
9.5  Testing Results of the Parametric Algorithms of the Distance 
Measurement in the Measuring Test Bench
Experimental data discussed next are obtained using FM RF BARS 351 produced 
by the Ryazan instrumentation company JSC Contact-1. The testing of algorithms 
for frequency estimation based on PSA methods was fulfilled at the DFS processing 
recorded on the measuring test bench equipment for a frequency tuning range of 
FM RF at 500 MHz. Plots show the distance measurement error using the MLM 
algorithm, the tracking algorithm, and the algorithm “Prediction” are obtained ac-
cording to the measurement results using the FM RF. The carrying frequency tuning 
range is 1 GHz.
9.5.1  Algorithms Based on the Methods of Parametric Spectral Analysis
Figure 9.18 shows by a solid line the results of algorithm testing based on the EV 
method. The SIR is equal to -6 dB. Calculations are fulfilled also with the help of 
the above-described two-step procedure. During function obtaining, we chose the 
following parameters: a dimension of the modified covariance matrix is m = 80, the 
model order is p = 8, a number of adding zero samples in the DFS is equal to 63K; 
the SR emulating the reservoir bottom is located at a distance of 15 m; and the UR 
moves with a step of 3 mm. Distance calculation is provided with the help of (8.34). 
As the useful SC of the EV pseudo-­spectrum, we accept the SC that is located nearer 
to the FM RF. 
For comparison, Figure 9.18 shows by a dotted line the distance measurement 
results when using the algorithm (3.4). A comparative analysis of two plots in 
Figure 9.18 allows the statement that the application of the distance measurement 
algorithm on the basis on the EV method essentially decreases the error. However, 
experimental results coincide well enough with the simulation results (Figure 8.14). 
Not having given the error plot for the EV method in a larger scale, we may note 
Figure 9.17  The function of the measurement error using the EV method. 

9.5  Testing Results of Parametric Algorithms of Distance Measurement	
273
that the increased measurement error (2 ÷ 4 mm and more) is observed at a consid-
erable distance from the SR. 
The results of testing the algorithm based on the Prony least square method are 
presented in Figure 9.19. At this testing, we chose the following parameters: the 
model order is p = 44, a number of DFS samples is 128, and the qs/i = 6 dB. The UR 
moves with a step of 3 mm with regard to the SR.  
The conditions of test conducting did not allow taking several DFS realizations 
at each distance. Therefore, to decrease the anomalous errors caused by false SCs 
Figure 9.18  Plot of the instantaneous measurement error versus the reflecting surface distance to 
the reservoir bottom when using the EV algorithm. 
Figure 9.19  Plots of the instantaneous measurement error as a function of the distance between 
the reflecting surface and interference when using the algorithm on the basis of the Prony least 
square method. 

274	
Testing of Precision Measuring Systems of FM Short-Range Radar
of the Prony spectrum, we used the following procedure. The SC corresponding 
to the measured distance was searched in the distance interval Rmin < Rx < Rmax 
(here Rx is the distance obtained using (3.4), the values of Rmin
 = 0.95 Rx, and 
Rmax = 1.05 Rx).
The comparison with the distance measurement error confirmed by the algo-
rithm (3.4) produces the statement that the Prony least square method provides an 
essential error decrease compared with the algorithm (3.4). 
9.5.2  The Algorithm Based on the Maximal Likelihood Method
It was shown in Chapter 4 that to realize the algorithm providing the MLM, it is 
necessary to define the PFC of the FM RF. Figure 9.20 shows the typical PFC calcu-
lated for the DFS according to the approach described in Chapter 4. The irregularity 
of PFC behavior is explained by the presence of the SR with small intensity, which is 
caused by the features of the measuring room and rereflections of various types.
The PFC of one sample of the FM RF is presented in Figure 9.21. We should 
note that the PFCs of other samples of FM RFs are similar and differences consist 
only in the various slope of the PFC and its displacement by some value DF. 
The PFC approximation by some function does not present complexity. PFC 
approximation by the straight segment is shown in Figure 9.21, for which the least 
square method is used. The distant measurement error using the MLM can serve as 
the correction criterion of the PFC approximation. The PFC approximation mis-
take will lead unavoidably to a truncation measurement error appearance. 
The distance measurement error for the MR with the MLM application is 
shown by a solid line in Figure 9.21. At measurement fulfillment, the RR moved 
discretely with a step of 20 cm. For comparison, the measurement error, which is 
ensured by the algorithm (3.4), is presented by a dotted line in this figure.  
The increased measurement error at the application (3.4) is caused by the same 
reasons, which cause overshoots in the PFC estimation by reflections from con-
structive MR elements and rereflections of different types. The application of the 
Figure 9.20  Phase characteristics of the FM RF. 

9.5  Testing Results of Parametric Algorithms of Distance Measurement	
275
algorithm on an MLM basis allows an essential reduction of the measurement error 
at the presentation of rereflections of small intensity. The irregularity of the error 
plot for the MLM is mainly explained by the inaccuracy of the UR setting. Careful 
analysis of the error plot for the MLM concludes that, at a distance of more than 
13 m, a small truncation error appears. The reason for this is obvious; the small 
error at the PFC approximation by the straight segment is at a distance of more 
than 13 m. 
9.5.3  Testing of the Tracking Distance Meter
Tests of the tracking distance meter were fulfilled on the measuring test bench at the 
discrete movement of the trolley with the UR. The SR is mounted motionless above 
the UR in the antenna DP of the FM RF. The mechanism of the SR attachment al-
lowed intensity changing by means of variation of its angular position. It permitted 
changing the SIR. Typical results, which are ensured by the tracking distance meter, 
are shown in Figure 9.22. The results presented here were obtained under the fol-
lowing conditions: qs/i = 2 dB and the SR were located at a distance of 5.8 m. At 
testing fulfillment, the UR moved with respect to the SR with a step of 3 mm; the 
frequency tuning range was 1 GHz. 
At the IEZ boundary the estimation of the PFC F(Rbound) is provided, which is 
used in the tracking algorithm.
It follows from Figure 9.22 that the tracking meter allows a sharp reduction 
of the distance measurement error. The obtained results completely coincide with 
simulation results: the measurement error decreases by 82 times compared with the 
algorithm (3.4) or with other algorithms, which do not use information about the 
DFS phase.
9.5.4  Testing Results of the Algorithm “Prediction”
Testing of the algorithm “Prediction” was provided in a similar manner but the UR 
movement was fulfilled smoothly.  
Figure 9.21  Instantaneous distance measurement errors using the MLM.

276	
Testing of Precision Measuring Systems of FM Short-Range Radar
The emulation of discharge or loading modes was fulfilled with different veloci-
ties and for different values of a distant part before the entrance to the IEZ, where 
movement velocity estimation was provided. The linear movement model with con-
stant velocity was used in the processing algorithm. Testing results were represented 
in the form of plots of reading the difference of the algorithm “Prediction” and the 
algorithm (3.4). The SR inside the IEZ was absent in these tests. Therefore, the mea-
surement result by the algorithm (3.4) was considered to be standard and the result 
obtained by the prediction was compared with it. Examples of similar plots are 
shown in Figures 9.23 and 9.24. At each plot, the specific reading difference inside 
the IEZ is presented. 
At the exit from the IEZ, a reading jump is observed when the transition from 
the algorithm “Prediction” to the algorithm (3.4) happens to increase due to error 
accumulation because of the noncoincidence of the true and estimated velocities of 
the reflector movement. 
Figure 9.22  Testing results of the tracking meter. 
Figure 9.23  Emulation of discharge at the reflector movement velocity of 10 mm/s.

9.6  Areas of Practical Application of the FMCW Radar	
277
The analysis of these results shows that in a practical application the success of 
the “Prediction” algorithm operation will be defined by the uniformity of the level 
variation velocity before the entrance in the IEZ and inside the IEZ. 
9.6  Areas of Practical Application of the FMCW Radar
The areas of the practical application of the FMCW radar are rather wide [10]  due 
to the following circumstances particular to these devices:
The possibility of measuring small and ultra small distances to the reflected 
• 
object;
The possibility of distancing measurements of the radial velocity determined 
• 
according to the Doppler frequency shift;
High accuracy of distance and radial velocity measurement;
• 
The possibility of measuring the angular coordinates of the target using a 
• 
scanning antenna pattern;
The possibility of measuring ultra small distance increments to the reflected 
• 
object due to high sensitivity to the distance variation;
The possibility of achieving a high resolving capacity to the distance;
• 
Signal processing after the mixer in the low-frequency region from hundreds 
• 
of hertz to hundreds of kilohertz;
A relatively small level of radiated power;
• 
Small dimensions, weight, and consumed power.
• 
Due to these features, a huge number of companies around the world develop 
and manufacture FM range-finders, which are used in the very manifold areas 
of practical applications. Next we describe briefly only the general properties of 
those applications where developers use the previously mentioned algorithms and 
Figure 9.24  Emulation of loading at the reflector movement velocity of 10 mm/s.

278	
Testing of Precision Measuring Systems of FM Short-Range Radar
­methods with significant results. We do not recommend specific device types and 
names of companies based on two reasons: 
It is impossible to list all the companies in the world that deal with such 
• 
products and we do not want to promote some companies while ignoring 
others;
Part of the application is confidential and this information cannot be ­described 
• 
in literature.
In some cases, it is necessary to ensure the highest accuracy of measurements 
for a practical application. In other cases, accuracy may not be as important a 
­requirement as keeping to a minimal cost, which is related directly to the FM 
range value. Application of the above-described theory allows a successful solution 
to these problems. We hope that for the considered theoretical problems having 
enough common characteristics will help experts in dealing with particular areas of 
practical application and improving their devices in the future.
Let us describe the most distributed applications. We only discuss those prob-
lems that are well known to us from the literature. Modern equipment development 
is progressing at such a rapid pace that it is reasonable to expect exclusively new 
problems that are not yet known.
9.6.1  Radio Altimeters for Small and Medium Attitudes
This is the most traditional application of the FMCW radar and, at present, radio 
altimeters and vertical velocity meters find wide application in civil and military 
aviation and space apparatus [11–13]. In such devices, the FM signal is radiated 
in a vertical direction from the flying vehicle (FV) downwards to the direction of 
the surface, of which the distance is necessary to measure. The reflected signal is 
received on board the FV and is accordingly processed to obtain information on the 
variations in its attitude and speed.
Such an FMCW provides the following solutions:
Safe pilotage of airplanes and helicopters at all stages of flight up to a blind 
• 
landing under complicated meteorological conditions;
Ensuring automatic control of space apparatus when landing on a planet 
• 
surface and for the safe attachment of various FVs; 
Automatic control of flight attitude of automatic unmanned objects;
• 
Height measurement for various industrial applications.
• 
It is evident that in each of these issues there are individual requirements for 
measurement accuracy, operation speed, and other features.
Accuracy and reliability of measurement depend on the character of the radi-
ated surface. As a rule, the best results can be obtained for a flat surface. The surface 
irregularity presence (for example, hills or forests) leads to errors. The surface may 
contain various constructions, for instance, high buildings, towers of electric trans-
mission lines, hills, and mountings, which also distort the measurement results. The 
correct results are obtained only at a horizontal flight or at a small deviation from this 

9.6  Areas of Practical Application of the FMCW Radar	
279
situation. Otherwise, especially for flat surfaces, the reflected signal can pass and not 
be received by the antenna. At a relatively high flight attitude, these errors are ines-
sential. The requirements to measurement accuracy increase for the FV landing fulfill-
ment, but in this case, the surface, as a rule, has a uniform character and a flat profile 
(the landing ground of the airdrome). At helicopter landings in places not prepared 
in advance, it is important that the surface is approximately the same level directly 
under the wheels. Therefore, in such applications, it is not desired to integrally check 
the surface, obtaining the same averaged result, but it is important to check in more 
detail the fulfilling measurements in three points with the help of three devices or by 
fulfilling the surface scanning by the antenna pattern.
9.6.2  Radio Proximity Fuses
These devices have a purely military application and are intended for activation of 
an explosive particle for the object intended for destruction falling into the antenna 
pattern. Activation is made for a minimal distance from the proximity fuse to the 
object under destruction (airplane or missile) [14]. Such radars are often referred 
to as the last-mile radar, when the guidance ground-based systems for the missile 
are switched off and the internal missile radar activates, which controls the move-
ment on the last stage. Initially, such radars were used to activate the artillery shell 
used in the flaks and for bombing. The antenna pattern shape of the proximity fuse 
must, as a rule, coincide with the fragments’ scattering cone after shell explosion. 
In some cases, besides the distance measurement, we need to measure the radial 
velocity of mutual approach. Such problems can be fulfilled ideally by the FMCW 
radar. Proximity fuses should be maximally simple and cheap but should have high 
reliability. Their requirements for measurement accuracy are not high, but the mea-
surements should be conducted with high operation speed and reliability. More 
detailed characteristics of similar devices are device-specific and are not described 
in many publications.
9.6.3  Navigation Radar
Navigation FMCW radars can be used as navigation radars with the range of action 
up to several kilometers [15]. The FMCW radar may be used with great effective-
ness for small distances of tens and hundreds of meters, where there are problems 
of surveying the sea and river water areas under conditions of bad visibility in terms 
of distance measurement and the relative velocity of any objects in the port. The 
important problem is the distance to the wall measurement at the docking of large 
crafts or at their passage through lock chambers. Besides navigation of large crafts, 
yacht and small craft navigation under bad visibility conditions is also needed [16] 
and for this purpose there is a large class of compact FMCW radars.
Navigation radars are wideband devices with FM that allow object resolution 
with sizes not less than 1m. A frequency range in the area of 10 GHz is used, and 
radiation levels do not exceed the radiation of a typical mobile cellular phone; 
therefore, the activity radius is approximately 20 nautical miles. 
In all problems of navigation, we must measure not only the distance to the 
obstacle but also the velocities of the mutual approach. 

280	
Testing of Precision Measuring Systems of FM Short-Range Radar
9.6.4  Transport Radar
In this category of FMCW radars we have two groups. The first group consists of 
radar for monitoring the situation on roads and for control of transport traffic [17, 
18]. Such a radar is mounted on one side of the highway or over it. The action range 
is some tens of meters. This system determines the number of passing cars and, used 
the obtained results, calculates the number of passed cars during the time unit, their 
mean speed, and so forth. 
A number of radars are contained in the second group, which ensures the fol-
lowing [18]:
Safe movement of a transport vehicle on highways;
• 
Effective braking in case of accident situation detection when approaching 
• 
another vehicle;
Facilitation of maneuvering and parking;
• 
Monitoring of an adjacent strap;
• 
Movement in blocks following the car ahead and automatic stop and start that 
• 
can only be controlled by a button pressed by the driver.
There are radars that perform only one of the above-mentioned tasks or per-
form several at once. For these tasks, the frequency ranges of 24 GHz and 77 GHz 
are most often used with a probing FM signal. To achieve the required resolution 
for distance, a range of the frequency tuning of 1.5 to 2 GHz is used. Devices op-
erating in the band of 24 GHz are cheaper. In the 77-GHz band, more advanced 
devices are distributed that are called adaptive cruise control (ACC).
Ensuring safe movement is done by providing obstacle detection, distance mea-
surement, and the velocities of an obstacle’s approach and its angular position. To 
determine the angular position, the radar must provide scanning of the antenna 
pattern. It is necessary to ensure that the space surveyed around the car is within 
the limits of 360°. For this to occur, several radars are mounted on the car, each of 
which only solves part of the problem, and therefore the minimal radar set consists 
of four devices with FM [19]. 
The front radar has a needle-shaped pattern with a width of several angular 
degrees with the activity radius in a distance of up to 300 to 400 m and with a mini-
mal distance of 20 to 30 cm. The antenna pattern of this radar continuously scans 
the space in front and provides obstacle detection, its distance measurement, and 
approach velocity. According to this data, when collision danger is determined, the 
warning signal is generated, and, if necessary, the braking system is activated. 
The back radar has also a needle-shaped antenna pattern and fulfills the same 
tasks as the front radar. Moreover, it has an additional task arising during parking 
and during the subsequent backing-up movement when the radar is checking the 
circular zone just around the car. At this point, we need to check distances from 20 
to 30 cm to 2 to 3 m. 
Two side radars check zones on the car’s sides with a dimension of approximately 
10 m and the width, which depends on the car construction, changes from 10° to 
20°. The direction of the antenna patterns of these radars is chosen to check the blind 
zones that are not available to the driver due to the car’s constructive features. 

9.6  Areas of Practical Application of the FMCW Radar	
281
Antennas of these radars have minimal sizes and can be easily mounted onto the 
necessary places of the car body. 
9.6.5  Level-Meters
Devices allowing the measurement of the filling level of various loaded reservoirs, 
bunkers, and tankers are referred to as level-meters. The technological and commer-
cial account of various substances can be performed with their help. Radar level-
meters are essential parts of checking the measuring equipment of many industrial 
enterprises in different fields, such as oil extraction, transportation, and the process-
ing, manufacturing, and storage of different types of liquid, viscous, and free-flowing 
substances at a high pressure and in a wide temperature range [20]. As a rule, such a 
device is mounted on the reservoir cap over the specially produced hatch or already 
anticipated reservoir construction. The radar antenna is directed into the hatch. If 
there is high temperature or redundant pressure inside the reservoir, then the attach-
ment to the reservoir is implemented and arranged through sealing arrangements. 
The width of the antenna pattern is usually within the limits of 10° to 12°. The 
pattern is oriented strictly vertically with respect to the surface of reservoir con-
tents. The FMCW radar measures the distance from its flange, which at calibration 
is accepted as an origin, to the surface of the product. Because the distance from the 
reservoir bottom to the FMCW radar’s flange is known, we can easily calculate the 
material level according to the results of the distance measurement to the surface. 
The distance measurement error is a very important index for level-meters. As a 
rule, the absolute error value, depending on level-meter application and on the specific 
place of its mounting, is changed from several millimeters to even tens of millimeters. 
Hundreds of companies around the world deal with production of such devices. 
They use various frequency ranges: 5 to 6 GHz, 9 to 11 GHz, 24 to 27 GHz, 76 to 
77 GHz, and 96 to 98 GHz. Bands of frequency tuning can change from 500 MHz 
to 2 to 3 GHz.
As it was shown earlier, such parameters allow ensuring the above-mentioned 
requirements to a level measurement error in an ideal condition of interference ab-
sence. However, in reality, there is a great number of various spurious reflections in 
the reservoir. The approaches that we discuss allow the achievement of the required 
error in a different interference situation or ensure the required error with a lesser 
value of the frequency tuning range, which in turn allows a reduction in the com-
plexity and the cost of the equipment.  
9.6.6  Ice and Snow Blanket Thickness Meters
Such devices are usually referred to as ice-meters [21] and are used for the following 
purposes:
Construction of winter ice routes and arranging ice airdromes in the regions 
• 
of extreme North, Siberia, Alaska, northern regions of Canada and Europe, 
and temporary ice bridges over freezing rivers;
Systems for ice frosting and other ice constructions;
• 

282	
Testing of Precision Measuring Systems of FM Short-Range Radar
Monitoring of ice blanket thickness near a hydro power station’s dams;
• 
Fulfillment of rescue missions on ice;
• 
Monitoring of ice obstructions and investigation of ice profiles;
• 
Safety and quality improvement for fishing;
• 
Estimation of the fresh ice resource throughout the world;
• 
Estimation of snow quantity in specific regions and forecast of possible situ-
• 
ation at snow melting.
All these situations need urgent, reliable, noncontact, and continuous mea-
surement of ice thickness and determination of environmental character under 
the ice from ground-based transport vehicles (car, all-terrain vehicles, auto-sledge, 
tractor), from a helicopter or airplane in the manual pedestrian mode [22, 23]. 
Moreover, in such investigations, it is necessary to report on the previous mea-
surements and to have a series of other user functions that increase reliability 
and work comfort. Independently from ice-meter movement at the ice thickness 
measurement, the transmission of the FMCW signal is provided strictly vertically 
in the direction of the ice surface. At the reflected signal spectrum, processing the 
detection of maxima corresponding to the reflection from the upper and lower ice 
edges is performed and, according to the difference of its delay in time, we can 
calculate the ice thickness. Furthermore, the relation of signal amplitudes reflected 
from the upper and lower ice edges allows the determination of the environment 
character under the ice. In a similar manner, one can measure the snow layer.  
The limits for ice thickness measurement are from 5 cm, which is the point at 
which a person can walk on pond ice, to values of several meters of ice thickness 
measurement in ponds. The range of frequencies used does not exceed 10 GHz. The 
higher frequencies are strongly damped in the ice, and the lower frequencies lead to 
large antenna sizes. The frequency tuning range is defined by the required resolution 
capability at the smallest ice thickness value and achieves a value of 2 to 3 GHz.
9.6.7  FM Geo-Radar
Range finders with FMCW signals can be successfully used as geo-radars. These 
devices are intended to perform the following tasks [24]:
Searching for promising archeology reliquiae and remainders;
• 
Preliminary investigation of the fundamental construction design of motor 
• 
and railway roads, airplane runways, various large buildings, and other con-
struction;
Performing danger diagnostics in the mining industry in the form of second-
• 
ary destruction and landslides;
Localizing underground cellars, galleries, tunnels, and so forth; 
• 
Localizing pipe lines and walls and searching for voids, underground water, 
• 
and water holes;
Mine searching in military systems.
• 
As a rule, such devices can find irregularities under the ground located at a 
depth of 40 to 50 m. The band of frequencies used does not exceed 1.5 GHz. The 

9.6  Areas of Practical Application of the FMCW Radar	
283
FMCW signal is radiated under the ground by the transmitting antenna. The signal 
reflected from the irregularity is received by the receiving antenna and after amplifi-
cation and conversion is exposed by spectral transformation. The processing result 
is extracted to the display. The geo-radar is moved on the ground by a trolley and 
an underground profile is formed on the display, which can be used for determining 
the irregular bedding place, its sizes, and its approximate shape. 
9.6.8  Atmosphere Sensing Radar 
The radio signal of the S-band has the capability of reflecting well from any irregu-
larity of the atmosphere dielectric permittivity caused by atmosphere turbulence, 
pollution of various air layers by large and small particles, presence of water steam, 
and small water drops [25, 26]. This reflection represents a combination of coher-
ent reflection from small spatial variations in the index of refraction caused by air 
turbulence and Rayleigh’s reflections from insects, birds, dust, and other forma-
tions in which the size is much less than the wavelength of the carrying oscillation. 
Depending on the application conditions, Rayleigh’s reflection from insects can be 
the interference source during observation of the clear sky and as the useful fac-
tor during the observation of layers of transparent air. Because of excellent spatial 
and temporal resolution, the FMCW radar is able to resolve insects as well and to 
separate the discrete reflection from particles and from distributed clear air. In this 
radar, two antennas are usually used to increase sensitivity for the observation of 
atmosphere conditions. One antenna radiates an FMCW signal vertically upwards 
and the other antenna is used for the reception of the reflected signal. 
9.6.9  Range Finders for Geodesic Research
At measurement fulfillment in the triangulation network, it is necessary to mount 
passive reflectors in appropriate points, for example, V-shaped, and to conduct dis-
tance measurements with the required accuracy with the help of the FMCW radar 
[14].
Another example of FMCW radar application in such tasks for observing gla-
cier behavior and possible avalanche snow blankets in mountains. For this purpose, 
angular reflectors are thrown down to the surface from a helicopter or airplane. 
On the slope or the top of an adjacent mountain, the FMCW radar is mounted, 
which continuously measures the distance to angular reflectors and transmits the 
measurement results in automatic mode through a radio line, which results in a 
pattern of movement dynamics of the monitoring surface. 
In a similar manner, one may monitor the displacement of a high building’s 
walls and towers under the influence of various natural phenomena. 
All such measurements can be provided in any type of weather, even with a 
complete absence of visibility. 
9.6.10  Birds’ Observation Radar 
Similar FMCW radars can be used for the prevention of bird collisions with airplanes 
at the airport and on the flight route, the prevention of bird strikes into the blades 

284	
Testing of Precision Measuring Systems of FM Short-Range Radar
of wind power plants, and for observing bird migration for biological analysis and 
investigations of habitat [27, 28]. At present, such radars provide continuous 24-hour 
monitoring in a three-dimensional mode. For this, S-band and X-band frequencies 
with the possibility of Doppler processing are used. To avoid collisions at airports, 
FMCW radars are used with an activity radius of 4 to 8 km and resolution on a dis-
tance of 2 m, which have horizontal and vertical channels. They allow the separation 
of bird types and operation in an automatic mode. Usually, a flock or a single-bird 
position is determined, and the direction of the movement, velocity, and movement 
trajectory are tracked , recorded, and archived; this information can also be obtained 
by consumers via a radio channel or through the Internet. Information from bird 
observation radar can be used by planning experts and consultants as a part of eco-
logical planning when constructing a wind power plant. The operators of the wind 
power plant can better understand the impact of the birds’ movement on the wind 
power plant and determine when to stop the wind engines if necessary or to activate 
the means to frighten birds away. 
9.6.11  Small Displacement Meters 
Such devices are used at the vibration measurement for various machine and 
mechanism parts. They allow measurement by a noncontact manner of vibration 
parameters under conditions of significant variation of an operation mode, high 
temperature, and pressure and in an aggressive environment [14]. 
The most sensitive method of vibration measurement is the application of phase 
methods. Nevertheless, it is very difficult to measure the UHF oscillation phase 
directly. At the same time, as was shown in Chapter 1, when using the FMCW 
radar, information about the phase angle w0td is contained in the low-frequency 
difference frequency signal at the mixer output. This essentially simplifies measure-
ments. At distance variations to the vibrating element by a half-wavelength of the 
radiated signal, the DS phase varies by 360°. If the wavelength is 8 mm, then the 
phase variation by 1° corresponds approximately to 10 micrometers of distance 
variation. 
9.6.12  Guarding Systems
FMCW radars find wide applications in various guarding systems that monitor the 
perimeter of guarded territory or the whole area inside a perimeter for military or 
civil purposes [29]. The FMCW radars are very suitable for the creation of guarding 
systems due to small sizes and weight, simplicity in selecting moving targets on the 
background of fixed objects, the possibility of determining coordinates of moving 
objects, and small radiated power. 
There is a wide variety of such guarding systems, such as portable, mobile,  
and stationary variants. They detect moved or fixed objects in the monitored zone and 
generate an audio alarm signal and the signal is then transmitted via a radio channel.
As a rule, guarding radars have high-resolution capability and can operate in an 
autonomous mode or in the structure of the complicated guarding system. They have 
an opportunity to classify targets and make their images on the map in the form of 

9.6  Areas of Practical Application of the FMCW Radar	
285
a separate symbol for a visible presentation of the current situation. We can meet 
combinations with another sensor, for instance, thermal imagers or video cameras. 
The distance of target detection changes from hundreds of meters to several 
tens of kilometers depending on the radar characteristics and type of the target. The 
error of distance measurement is from 2 to 10 meters and for velocity it is from 0.3 
km/hour to 1.5 km/hour. The radiated power is several hundreds of milliwatts. The 
X frequency band is usually used. To increase functioning reliability and protection 
from interference, the mode of the continuous change of the carrying frequency is 
used. Therefore, we can use several tens of such frequencies by randomly choosing 
the current frequency.
All measurements are linked to the specific coordinates due to the embedded 
GPS module and the compass. 
9.6.13  Robotic Navigation and Mapping Systems
Transport vehicles carrying important loads and fulfilling nonstandard tasks are 
often used for robotic systems moving on the Earth surface (usual everyday and 
industrial robots, specific and research robotic systems) through air (piloted and 
unmanned flying vehicles, military airplanes, robotic missiles), and in outer space. 
The reference information for these robotic vehicles can be produced by specific 
radio beacons, guidance systems, and mapping sets, including those recorded in 
a digital form in specialized processors and memory devices. Frequency ranges of 
actual navigation robotic radars can be chosen in the bands of 9.4 GHz (see pulse 
radar), 77 GHz, and 94 GHz (millimeter-wave FMCW radars of surface and avia-
tion types). Robotic autonomous navigation systems are often intended on opera-
tion from units of meters to hundreds of meters in range. 
Depending upon the specific application of the robotic systems, their actual 
navigation is fulfilled on the basis of GPS, local landscapes (evident reference 
points), and clear parts of actual maps. Therefore, the issue of verification of out-
of-date maps and finding new ones is important when using robotic systems. Many 
interesting publications (for example, [30]) have recently been devoted to this issue. 
The application of robotic autonomous navigation with the help of FMCW radar 
mounted on the robot together with other sensors (visible light and lasers) is sig-
nificant. Such radars frequently allow the improvement of mapping and navigation 
observation performance and the improvement of tracking the robot location. 
Therefore, ground-based systems and aviation-based and space-based sys-
tems are essentially different from the point of view of the required resolution in 
the range and angular position, because the navigation error in several meters for 
ground-based systems (for instance, for standard transport vehicles on the ground) 
can be absolutely unacceptable compared to the quickly-moving aviation-based and 
space-based systems, for which the resolution can be much less strict. 
FMCW radars are indispensable components of robotic vehicles allowing the 
detection of landscape parts that are enclosed and invisible to optical and laser 
systems. In such systems, the operation distance of robotic ground-based devices 
is from part of a meter to several hundreds of meters, and aviation-based systems 
require a range of several kilometers.

286	
Testing of Precision Measuring Systems of FM Short-Range Radar
9.7  Conclusions
The problems of reliability ensuring correct estimation error of the FM RF have 
been considered. The synthesis procedure of the standard RR with minimal sizes is 
offered for precision measurements. It was shown that it is necessary to use reflec-
tors of a special shape. The results of research of size influence and the reflector 
shape on the measurement error show that minimal reflector sizes, which allow the 
correspondence of an electrodynamical distance to a specified geometrical distance 
(at the admissible error of this correspondence), should exceed two Fresnel zones 
at a maximal distance from the FM RF. For the most practical problems presented, 
recommendations permit creating rather easily realizable test benches.
A test bench for the measurement FM RF parameters was developed, manufac-
tured, and certified as the measuring means. The test bench has large universality 
and provides the possibility of emulating various practical situations. Testing results 
on this test bench were presented that confirm the suitability of the methods used. 
The approach to measurement fulfillment was developed taking into consider-
ation the SR presence, which distorts results. Experimental investigations of many 
of the above-mentioned algorithms have been fulfilled and good coincidence with 
the results of the theoretical research and numerical simulation has been obtained. 
Possible application areas for the FMCW radar were briefly described.
References
[1]	 Emerson, S., “Improved Construction of Anechoic Chamber,” TIIER, No. 8, 1965, 
pp. 1227–1229. [In Russian.]
[2]	 Markov, G. T., and D. M. Sazonov, Antennas, Moscow: Energia Publ., 1975.
[3]	 Patent 2207676 (Russian Federation), INT.CL. H01Q 15/14. “Plane Radar Reflector,” 
V. M. Davydochkin. No. 2002111035/09. Bull. No. 18. Filed April 24, 2002; published 
June 27, 2003.
[4]	 Patent 2298770 (Russian Federation), G01S 13/14. “Work-Bench for Adjustment and 
­Testing of Radar Level-Meters,” B. A. Atayants, V. M. Davydochkin, V. A. Bolonin, V. V. 
Ezerskiy, Yu. V. Masalov, S. A. Markin, and D. Ya Nagorny; published May 10, 2007.
[5]	 Parshin, V. S., V. M. Davydochkin, V. S. Gusev, “Compensation of Spurious Reflections’ 
Influence on Distance Measurement Accuracy by FMCW Range Finder,” Digital Signal 
Processing and Its Application. – Proceedings of RNTORES Named after A.S. Popov. 
No. 5, Moscow, Vol. 1, 2003, pp. 261–263. [In Russian.]
[6]	 Parshin, V. S., “Tracking Frequency Meter of the Beating Signal of the Radio Range Finder 
with Frequency Modulation of Radiated Signal,” Digital Signal Processing and Its Applica-
tion. – Proceedings of RNTORES Named after A.S. Popov. No. 10, Moscow, Vol. 1, 2008, 
pp. 395–398. [In Russian.]
[7]	 Patent 2410650 (Russian Federation), INT.CL. G01F 23/284, G01S13/34. “Method of 
Material Level Measurement in a Reservoir,” B. A. Atayants, V. S. Parshin, V. V. Ezerskiy. 
Bull. No 3. Filed November 1, 2008; published January 27, 2011.
[8]	 Parshin, V. S., and A. A. Bagdagiulyan, “Distance Measurement to Material Level in a 
Reservoir at Presence of Spurious Reflections Exceeding the Useful Signal in Intensity,” 
Digital Signal Processing and Its Application. – Proceedings of RNTORES Named after 
A.S. Popov. No. 8, Moscow, 2006, Vol. 1, pp. 306–308. [In Russian.]

9.7  Conclusions	
287
[9]	 Parshin, V. S., and V. V. Ezerskiy, “Application of Algorithms of Parametric Spec-
tral Analysis at Distance Measurement with the Help of Radar Range Finders with the 
­Frequency-Modulated Signal,” Digital Signal Processing and Its Application. – ­Proceedings 
of RNTORES Named after A.S. Popov. No. 7, Moscow, 2005, Vol. 1, pp. 234–238. 
[In Russian.]
[10]	 Johanngeorg, O., “Radar Application in Level Measurement, Distance Measurement and 
Nondestructive Material Testing,” Proc. of 27-th European Microwave Conference, Sep-
tember 8–12, 1997, pp. 1113–1121.
[11]	 Patent 4456911 USA, INT. CI. G01S 13/88, G01S 13/00, G01S 13/04, G01S 13/34. “Fre-
quency Modulated Continuos Wave Altimeter,” C. F. Augustine. US 06/198,600; Filed Oct. 
20, 1980; date of patent June 26, 1984.
[12]	 http://www.barnardmicrosystems.com/ME4%20files/download/DSTO-TR-1939_PR.pdf.
[13]	 Patent 4456911 USA, IPS8 Class AG01S130FI. “High integrity radio altimeter,” W. 
­Devensky. No. 20090289834. Filed Jct. 20, 1980; date of patent November 26, 2009.
[14]	 Komarov, I. V., S. M. Smolskiy, Fundamentals of Short-Range FMCW Radar, Norwood, 
MA: Artech House Publishers, 2003, 289 p.
[15]	 http://www.simrad-yachting.com/en-US/Products/NSS-Touchscreen-Navigation/NSS12-
Navigation-Pack-en-us.aspx.
[16]	 Navico Broadband Radar BR24. Installation Manual.
[17]	 Moldovan, E., S. Tatu, T. Gaman, R. Wu K. Bosilio, “New 94-GHz Six-Port Collision-
Avoidance Radar Sensor,” IEEE Trans. on MTT, Vol. 52, No. 3, 2004, p. 751.
[18]	 Gresham, I. et al., “SHF-Wideband Radar Sensor for Short-Rang Vehicle Applications,” 
IEEE Tran. On MTT, Vol 52, No. 9, 2004, pp. 2105–2122.
[19]	 R. Kulke, C. Gunner, S. Holzwarth, J. Kassner, A. Lauer, M. Rittweger, P. Uhlig, P. Weigand, 
“24 GHz Radar Sensor Integrates Patch Antenna and Frontend Module in Single Multi-
layer LTCC Substrate,” EMPS 2005, June 12–15, Brugge, Belgium.
[20]	 Weib, M., and R. Knochel, “A highly Accurate Multi-Target Microwave Ranging System 
for Measuring Liquid Levels in Tanks,” IEEE MTT-S International Microwave Symposium 
Digest, Vol. 3, 1997, pp. 1103–1112.
[21]	 Baranov, I. V., V. V. Ezerskiy, A. Yu. Kaminskii, “Measurement of the Thickness of Ice by 
Means of a Frequency-Modulated Radiometer,” Measurement Techniques, Vol. 51, No. 7, 
2008, pp.726–733.
[22]	 Yankielun, N., W. Rosenthal, and R. Davis, “Alpine Snow Depth Measurements from 
Aerial FMCW Radar,” Cold Reg. Sci. and Tech., Vol. 40, No. 1–2, 2004, pp. 123–134.
[23]	 Marshall, H. P., and G. Koh, “FMCW Radars for Snow Research,” Cold Regions Science 
and Technology, Vol. 52, 2008, pp. 118–131.
[24]	 http://www.ks-analysis.de/groundpenetratingradar/contact.htm.
[25]	 http://keycom.co.jp/eproducts/pbr/pbr72/page.html – meteo-radar.
[26]	 Ince, T., “FMCW Radar Performance for Atmospheric Measurements,” Radioengineering, 
Vol. 19, No. 1, 2010, pp. 129–135.
[27]	 http://www.robinradar.com.
[28]	 http://www.airporttech.tc.faa.gov/Safety/Downloads/TC-13-3.pdf.
[29]	 http://www.army-technology.com/contractors/navigation/at-communication/pressat- 
fmcw-radar-solutions.html.
[30]	 Adams, M., J. Mullane, E. Jose, and Vo Ba-Ngu, Robotic Navigation and Mapping with 
Radar, Artech House. 2012. ISBN 978-1-60807-482-2.


289
Conclusion
The materials considered in this book are closely connected with the practical 
implementation of different devices of short-range FM radar technology. Specific 
practical needs have encouraged the authors to perform detailed investigations of 
possibilities to achieve high accuracy in distance measurement under ideal condi-
tions and also with various destabilizing factors.  
It is absolutely clear to us that under ideal conditions we can achieve an error 
of distance measurement that is small enough with the help of any MQIS. In some 
cases, it can be achieved by WF selection or by adaptive variations of its parameters 
at distance changing. This is most complicated for measurements of very small dis-
tances equaled by parts and units of ED values. Good results can be achieved here 
by means of optimization of FM parameters. It is expedient to adaptively change the 
frequency-tuning range of the UHF oscillator in such a manner that the integer num-
ber of DFS periods keeps within one modulation period at the symmetric triangle 
FM law. In this case, DFS takes a form of continuous sine without phase jumps. We 
can obtain excellent results at any MQIS for such DFS. Supplementing this mode by 
the smooth DFS phase variation due to slow FM with averaging of the measurement 
results, we can reduce the measurement error by about an order. Unfortunately, we 
must pay for the achieved result by increasing the necessary frequency resource of 
the SHF oscillator and by increasing the processing time. As a whole, we may note 
that, at present, the substantively achieved measurement accuracy satisfies the practi-
cal needs of the industry. 
Nevertheless, such results can be obtained for ideal linear FM only. The dif­
ference between the MC shape of the SHF oscillator and that of the linear one 
strongly degrades the distance measurement accuracy. In some cases, we may get 
good accuracy even at nonlinear MC. This can be achieved by means of the predis-
tortion introduction in the modulating voltage for the comparison of nonlinearity, 
the correction of calculation results according to the known parameters of MC 
nonlinearity, or by an account of this nonlinearity at the distance calculation. The 
most radical struggle against MC nonlinearity is the application of digital frequency 
synthesizers at the generation of the carrying FM signal. 
The most significant factor reducing the accuracy of distance measurements is 
the presence of noise and spurious signals. 
Methods for noise struggle are well known and were almost not considered in 
this book. Exclusion is the method of maximal likelihood allowing a significant de-
crease in the variance of the noise component of the distance measurement error. 
The problem of how to achieve high measurement accuracy in the presence of 
spurious signals is most important. In practical applications, there are many reasons 
for the rise of these signals. First, they have an effect on the measurement accuracy 
owing to both the DFS shape distortion or its spectrum and the influence on the reso-
nance system of the oscillator and the rise of combination ­frequencies in the mixer. 

290	
Conclusion
Accordingly, there are many methods that struggle. Methods of controllable varia-
tion of WF shape and the application of increasing changes as a result of the mea-
surement for the correction of this result are promising. Positive results ensure the 
compensation of spurious signals or its position account at measurement fulfillment 
in combination with the most appropriate method of processing, the application of 
methods for image identification. In some cases, the application of the maximum 
likelihood method or its various modifications allows the achievement of good re-
sults. For example, as it is shown in this book, in the increased error zone near the 
spurious reflector, tracking of one of the lobes of the signal function is possible. 
This tracking corresponds to the factual value of the measured parameter, which 
ensures essential reduction of the measurement error. In most cases, it is impossible 
to completely solve a problem of elimination of the spurious signal effect by the same 
method. The combined means are necessary when different methods or their combi-
nations are used at the different measurement and DFS processing stages.
It is possible that some companies use the above-mentioned methods or their 
modifications under various much-hyped promotional names and even obtain pat-
ents on them. We cannot guess what is concealed under these names, but we our-
selves analyzed the claims and synthesized suitable algorithms. Frequently, these 
algorithms are heuristic and sometimes follow strict or approximate theoretical 
analysis. We appreciate if any readers recognize their own algorithms in some of 
our solutions and clarify their theoretical possibilities. In any of these situations, 
when we were aware of publications in Russia or in any other country, we made 
reference to the relevant publications. 
Many of methods and algorithms described in our book are defended by 
­patents on inventions and realized in serially manufactured level-meters of the 
BARS ­series. 
We realize that we have not described and solved all possible problems. Our 
task was to designate the most manifest and significant from them and to prove that 
one may develop practically realizable methods that produce ­acceptable results. We 
perfectly understand that there are a variety of problems, especially in the field of 
interference struggle, reduction of sensitivity to variations of external conditions, a 
decrease in consuming power, improvement of constructive-­technological indices, 
and cost reduction of these devices. 
We appreciate feedback from all interested readers about this book and we 
hope that our work has helped solve practical or theoretical problems or encour-
aged readers to use new nonstandard solutions. 

291
A p p e n d i x
Weighting Functions for Harmonic 
Analysis and Adjacent Problems
Weighting functions (WFs) are not specific instruments of spectral analysis. They are 
widely used for many problems and are solved using general mathematical methods. 
The development of WFs allow digital signal processing to reduce the signal 
frequency and amplitude estimation errors on noise and interference background, 
as well as development of WFs with a minimal SLL of the SD at a specified width 
of the SD main lobe and specified decrease speed of SLL of SD is promising both 
for the application in the FMCW RF of the high precision for measurements and 
for the solution of other problems. 
We call the WFs that changing their parameters to obtain the required spectral 
properties adaptable WFs (AWFs). Some AWF properties and methods for obtain-
ing them are described in [1, 2].
A.1  Analytical Expressions for AWFs
The problem of measurement error elimination of frequencies and amplitudes of 
signal items on the background of resolvable interference can be solved if there is 
a WF whose shape is specified by varied parameters in such a manner that on the 
frequency of each signal item, the SD of other parameters (i.e., spurious items) will 
be equal to zero, along with the given number of its derivatives. For this, it is neces-
sary that there is a nontrivial solution of the equation system:
	
1
1
1
1
,
,
1
,
,
(
1)
1
(
1)
,
,
( ,
,
,
)
0
( ,
,
,
)
0
.........................................
( ,
,
,
)
0
N
N
N
N x b
b
N
x b
b
N
N
N
x b
b
S x b
b
d S x b
b
dx
d
S x b
b
dx
=
=
-
-
=
ì
=
ï
ï
=
ïïí
ï
ï
ï
=
ïî
…
…
…
…
…
…
	
(A.1)
where ( )
( ) ( ) exp(
2
)
S x
w t u t
j
xt dt
π
¥
-¥
=
-
ò

 is the SD of a sum of harmonic signal and 
interference segments 
1
( )
cos[ ( )
]
( )
s
N
i
i
i
u t
U
t
t
φ
η
=
+ F
+
å
 obtained in the time interval 
with duration T and weighted WF w(t) symmetric with regard to the time interval 
center and limited in duration by this interval, x = wT(2p)–1 and t = tabs /T are the 
normalized signal frequency and the normalized time, Ui and Fi are the amplitude 

292	
Weighting Functions for Harmonic Analysis and Adjacent Problems
and the DC of the phase of the ith signal item, h(t) is a noise, and bi is a normalized 
frequency on which the SD or its derivative is equal to zero. 
At the consideration of the signal spectrum weighted by the discrete WF, we 
­assume that the transformation from an analog to a digital form is performed with-
out quantization errors and discretization is equidistant. In such a statement, we 
may speak about truncation errors; that is, about errors peculiar only to the algo-
rithm itself of the Fourier transform of the discrete signal. 
Because the signal spectrum shape at accepted assumptions coincides with the 
WF spectrum shape, it is enough to obtain a solution for the specified frequencies 
of the WF spectrum. Discretized WFs can be obtained from the continuous WF by 
using the gating property of the delta function d(t). Therefore, we obtain M0 equi-
distant samples of appropriate WFs with the discretization interval Td = T/M0 in 
the interval T.
There is a possibility of truncating error elimination that we consider with func-
tions of a type:
	
0
0
0
1
0
1
1
0,5
1 0,5
( ,
,
,
)
1
(
,
)cos(2
)
[
(
0.5)
]
N
N
sn
N
n
M
d
m
M
w t b
b
M
C
b
b
nt
t
m
T
π
δ
=
= -
é
ù
=
+
ê
ú
ê
ú
ë
û
´
-
-
å
å
…
…
	
(A.2)
	
π
π
δ
=
= -
ì
ü
ï
ï
=
+
+
í
ý
ï
ï
î
þ
´
-
-
å
å
…
…
0
0
0
1
0
1
1
0,5
1 0,5
1
( ,
,
,
)
cos(
)
(
,
)cos[ (2
1) ]
[
(
0.5)
]
N
N
cn
N
n
M
d
m
M
w t b
b
M
t
C
b
b
n
t
K
t
m
T
	
(A.3)
with unknown coefficients Csn(b1,…bN, M0) and Ccn(b1,…bN, M0).
The Fourier transformation of functions (A.2) and (A.3) is expedient to 
­represent in the form infinitely differentiable products of two multipliers with the 
same coefficients:
	
1
0
2
1
0
1
sin(
)
( ,
,
)
sin(
)
2cos(
) sin (
)
1
(
,
,
)cos(
) cos(2
)
cos(2
)
s
N
N
sn
N
n
x
S x b
b
M
Mx
nM
Mx
C
b
b
M
n
nM
Mx
π
π
=
=
ì
ü
×
ï
ï
´
+
í
ý
-
ï
ï
î
þ
å
…
…
	
(A.4)
	
1
0
1
0
1
cos(
)cos(
)
sin(0.5
)
( ,
,
)
0.5
cos(
)
cos(2
)
sin[
(
0.5)]
(
,
,
)cos(
) cos[
(2
1)]
cos(2
)
c
N
N
cn
N
n
x
Mx
M
S x b
b
M K
M
mx
M n
C
b
b
M
n
M
n
Mx
π
π
=
ì
-
=
í
-
î
ü
+
ï
+
ý
+
-
ïþ
å
…
…
	
(A.5)
where M = p /M0.
Omitting unwieldy transformations, we give solutions in the general case of the 
unlimited system (A.1).

A.1  Analytical Expressions for AWFs	
293
At N ³ 2 solutions of the system (A.1) with regard to coefficients, respectively, 
Csn(b1,…bN, M0) and Ccn(b1,…bN, M0), are:
	
+
=
=
¹
é
ù
-
-
=
×
ê
ú
ë
û
-
´
-
Õ
Õ
…
1
1
0
2
1
1
( 1)
cos(2
)
cos(2
)
(
,
,
,
)
cos(
)
2sin (
)
[1
cos(2
)]
cos(2
)
cos(2
)
N
n
i
sn
N
i
i
N
k
k n
nM
b M
C
b
b
M
nM
b M
kM
nM
kM
	
(A.6)
	
1
1
0
1
1
( 1)
sin(0.5
)
(
,
,
,
)
sin[(
0.5)
]
cos[(2
1)
]
cos(2
)
cos(
)
cos(
)
[cos(
)
cos[(2
1)
]]
cos[(2
1)
]
cos[(2
1)
]
n
cn
N
N
i
i
i
N
k
k n
M
C
b
b
M
n
M
n
M
b M
M
b M
M
k
M
n
M
k
M
+
=
=
¹
-
=
+
ì
ü
+
-
´
í
ý
-
î
þ
-
+
´
+
-
+
Õ
Õ
…
	
(A.7)
Then
	
1
0
1
0
1
( ,
,
,
)
1
(
,
,
)cos(2
)
N
s
N
sn
N
n
w m b
b
M
C
b
b
M
nmM
=
=
+ å
…
…
	
(A.8) 
	
1
0
1
0
1
( ,
,
,
)
1
cos(
)
(
,
,
,
)cos[(2
1)
]
c
N
N
cn
N
n
w m b
b
M
mM
C
b
b
M
n
mM
K
=
ì
ü
ï
ï
=
×
+
+
í
ý
ï
ï
î
þ
å
…
…
	
(A.9)
for 
+
×
-
=
=
1
0
2
1
sin
(
1) sin
(
1)
1 
( ,
)
cos
sin
s
M b
M b
N
C
b M
M
Mb
, 
and 
1
0
( ,
)
c
C
b M
=
sin(0.5
) cos(3
)
cos(2
)
sin(1.5
) cos(
)
cos(2
)
M
M
Mb
M
M
Mb
-
-
.
In problems of simultaneous estimation of signal frequency and amplitude, the 
equation for a normalized multiplier is determined from the condition of equality 
to 1 of the normalized WF SD on zero frequency:
	
π
=
-
=
ì
ü
+
ï
ï
´
+
í
ý
-
+
-
ï
ï
î
þ
å
…
0
1
2
0
1
2
sin(0.5
)
cos(
)sin[
(
0.5)]
(
,
,
,
,
)
cos(
)
1
cos[
(2
1)]
1
N
cn
N
n
K
M
M
n
M n
C
b b
b
M
M
M
n
	
(A.10)
When the WF is obtained, we assume that signal weighting with regard to the 
sample center is symmetric. Nevertheless, the signal processing is constructed in 
such a manner that in the memory of the computing device, the initial number is 
conferred to the first sample of the signal [3]. In this case, to keep symmetry with 
regard to the center of signal sample, AWF samples should be displaced and written 
in the form: 

294	
Weighting Functions for Harmonic Analysis and Adjacent Problems
	
=
=
+
-
+
å
…
…
1
0
1
0
1
( ,
,
,
)
1
( 1)
(
,
,
)cos[2 (
0.5)
]
s
N
N
n
sn
N
n
w m b
b
M
C
b
b
M
n m
M
	
(A.11) 
	
1
0
1
0
1
1
( ,
,
,
)
sin[(
0.5)
]
( 1)
(
,
,
)sin[(2
1)(
0.5)
]
c
N
N
n
cn
N
n
w m b
b
M
K
m
M
C
b
b
M
n
m
M
=
=
´
+
üï
+
-
+
+
ý
ïþ
üïý
ïþ
å
…
…
	
(A.12)
Equations for continuous AWFs can be obtained from (A.8), (A.9), (A.11), and 
(A.12) at M0 ® ¥. Omitting the number of samples M0 in the designations, we give 
equations for continuous AWF and their SD:
	
1
1
1
( ,
,
)
1
(
,
)cos(2
)
N
s
N
sn
N
n
w t b
b
C
b
b
nt
π
=
=
+ å
…
…
	
(A.13)
	
1
1
1
1
( ,
,
)
cos(
)
(
,
)cos[ (2
1) ]
N
c
N
cn
N
n
w t b
b
t
C
b
b
n
t
K
π
π
=
ì
ü
ï
ï
=
+
+
í
ý
ï
ï
î
þ
å
…
…
	
(A.14)
	
1
1
1
( ,
,
)
1
(
,
)cos
cos(2
)
N
s
N
sn
N
n
w t b
b
C
b
b
n
nt
π
π
=
=
+ å
…
…
	
(A.15) 
	
w t b
b
t
C
b
b
n
n
t
í
ý
1
1
1
1
( ,
,
)
sin
(
,
)cos
sin[ (2
1) ]
N
c
N
cn
N
n
K
π
π
π
=
ì
ü
ï
ï
=
+
+
ï
ï
î
þ
å
…
…
	
(A.16)
	
p
p
p
=
ì
ü
ï
ï
=
×
+
í
ý
-
ï
ï
î
þ
å
…
…
2
1
1
2
2
1
sin(
)
( ,
,
)
1
(
,
)cos(
)
N
s
N
sn
N
n
x
x
S x b
b
C
b
b
n
x
x
n
	
(A.17)
	
p
p
p
=
-
ì
=
× í
-
î
ü
+
ï
+
ý
-
+
ïþ
å
…
…
1
2
1
2
2
1
cos(
)
0.5
( ,
,
)
0.25
0.5
(
,
)cos(
)
(
0.5)
c
N
N
cn
N
n
x
S x b
b
K
x
n
C
b
b
n
x
n
	
(A.18) 
with coefficients
	
2
2
1
1
2
2
2
1
1
i
(
,
)
( 1)
1
N
N
n
sn
N
k
i
k n
k
n
C
b
b
k
n
b
+
=
=
¹
æ
ö
= -
×
×
-
ç
÷
-
è
ø
Õ
Õ
…
	
(A.19) 
	
1
2
2
1
2
2
2
1
1
i
( 1)
(
,
)
1
2
1
(
)
(
)
0.25
N
N
n
cn
N
k
i
k n
k
k
n
n
C
b
b
n
k
k
n
n
b
+
=
=
¹
æ
ö
-
+
+
=
-
ç
÷
+
+
-
+
-
è
ø
Õ
Õ
…
	
(A.20) 
for N = 1, 
2
1
2
1
( )
1
s
C
b
b
æ
ö
=
-
ç
÷
è
ø
, and 
2
1
2
1
2.25
( )
3
0.25
c
b
C
b
b
æ
ö
-
=
ç
÷
-
è
ø
.

A.2  Spectral Properties of AWF in DSP Problems	
295
A.2  Spectral Properties of AWF in DSP Problems
Taking into consideration that the obtained AWFs are rather new, we analyze some 
spectral properties of AWFs, which influence to the utmost the possibility of trun-
cation error reduction when using algorithms similar to the above-mentioned ones 
and allow us to obtain the AWFs with optimal parameters. 
We note that the positions of the AWF SD zeros are defined by zero positions of 
two multipliers. Zero positions defined by multipliers sin (px)/sin (Mx) or cos (px)/
cos (Mx), respectively, for the SD (A.4) and (A.17) or (A.5) and (A.18) are periodic 
and do not depend on positions of specified zeros b1, b2, …, bN determined by the 
second multiplier. Therefore, for brevity, we call the zero positions of the first mul-
tipliers stationary, and zero positions of second multipliers variable:
For the AWF with 
1.	
N variable zeros besides stationary M0 – 1 – N zeros, we 
can provide a formation of the SD zero values on N specified zeros b1, b2, …, 
bN. The coincidence of SD m zeros on one frequency leads to the formation 
on this frequency of zeros of m – 1 derivatives. In the problem of measure-
ment of the difference frequency of the beating signal, this property allows 
us to ensure deep interference suppression on the signal frequency. 
The possibility of specifying the SD zeros on any frequencies is illustrated in 
Figure A.1 with the AWF SD in (A.4) for N = 6 and M0 = 32 and given zeros of the 
third order on two relative frequencies.
The application of the AWF in (A.11) and (A.12) for the DSP allows the elim-
2.	
ination of the sample number influence on the results of the signal ­parameter 
estimation. The WF discretization effect on its spectrum is illustrated by 
Figure A.2 for N = 6 and the specified frequency b = 6.
Figure A.1  The AWF SD in the area of the SL with given zeros of the third order on two relative 
frequencies: 7 and 11 for the solid curve, and 7 and 13 for the dotted curve.

296	
Weighting Functions for Harmonic Analysis and Adjacent Problems
The dotted curve corresponds to the AWF in (A.11), ws(m,6,6,6,6,6,6,32), for 
the analysis of discrete signals containing 32 samples, for which the envelope is 
defined with an account of the signal sample number. The solid curve corresponds 
to AWF in (A.13) for ws(t,6,6,6,6,6,6) with the envelope obtained at M0 ® ¥, but 
applied for the DSP containing 32 samples. We see that the DSP by the WF, for 
which the envelope does not change in accordance with the sample number, leads to 
spectrum distortions in the SL area. It is clear that for known WFs, the differences 
in the SD at the analysis of discrete and analog signals are manifested in a similar 
manner. In problems of signal parameter estimation, these variations restrict the 
minimal achievable level of the truncation error due to the displacement of specified 
zero positions on the frequency axis and the reduction of their order. 
The level of the SD SL unambiguously depends upon the distribution (in fre-
3.	
quency) of the variable SD zero values and their order. An interval increase 
between frequencies of adjacent zeros defining the SL width in this interval 
leads to SD SLL increase in this interval and influences on the adjacent SL 
level. This property is illustrated by Figure A.3, where the SD for the WF in 
(A.14) for ws(t;1,8; 2.39115; 3.27592; 4.29842) (denoted by a thin line) is 
presented and the minimal possible SLL for this WF is obtained for the main 
lobe width on the zero level of 3.6.
The frequency increase of one of the variable zeros from 3.27592 to 3.5 led to a 
level reduction of all lobe with great frequencies (bold line), to increase all SLs with 
lesser frequencies and to increase the width of the main lobe on any level of all SLs 
different from zero (not presented in the figure). The frequency decrease of one of the 
variable zeros leads to the opposite effect. The unambiguous connection of the AWF 
SD SLL variation with direction of specified zero frequency variation allows the cre-
ation of simple algorithms of the WF obtained with specified spectral properties.
It may be shown that most of the traditional WFs is the specific case of ob-
4.	
tained AWF for fixed values of its parameters. This statement is easily illustrated 
Figure A.2  The area of the AWF SD zero formation at the DSP.

A.2  Spectral Properties of AWF in DSP Problems	
297
on a series of widely used WFs. The substitution of the SD zero values bi of any 
known WF presented by the trigonometric series in expression for ws(t,b1,b2,…, 
bN) leads to an accurate SD coincidence on a frequency and to an accurate coin-
cidence between a known WF and AWF, and, vice versa, the application of coef-
ficients at appropriate items of the series allows obtaining the frequency values 
bi. For instance, for the popular Blackman WF of the type ws(t,b1,b2) with the 
coefficients a1 = 0.5/0.42 and a2 = 0.08/0.42, it is easy to obtain from (A.17) that 
1
28/3
b =
 and b2 = ¥.
Specifying a number of variable parameters for AWF ws(m,b1,b2,…, bN, M) equal 
to half of the sample number, and for wc(m,b1,b2,…, bN, M) N = 0.5 M0 – 1 and speci-
fying zero positions bi coinciding with zero positions of the DC WF ­spectrum [4],
	
1
0
0
0
0
arch
2
1
arccos
ch
cos
1
2
2
i
i
M
Q
i
b
x
M
M
π
π
-
é
ù
æ
ö
æ
-
ö
ê
ú
=
=
ç
÷
ç
÷
è
ø
è
ø
-
-
ê
ú
ë
û
	
(A.21) 
we obtain AWF spectra, which completely coincide with the DC WF spectrum. 
Here Q is an excess of the spectrum main lobe level over the SLL. In Figure A.4 this 
coincidence is illustrated by the DC WF spectrum difference
	
π
ì
ü
é
ù
æ
ö
æ
ö
ï
ï
=
×
-
×
×
í
ý
ê
ú
ç
÷
ç
÷
è
ø
è
ø
-
ï
ï
ë
û
î
þ
0
0
0
1
ach
( )
ch (
1) ach ch
cos
1
Q
x
ST x
M
Q
M
M
	
(A.22) 
for Q = 103 and AWF spectrum, for which the values of bi are assumed to be equal 
to x0i with rounding in 13 to 15 signs. The difference of the AWF and DC spectra, 
which does not exceed 5.10–15, is defined only by rounding errors. Hence, both WFs 
obtained from the AWF in such a manner are optimal on the SLL of their spectra (this 
criterion was suggested by S. L. Dolph), although the forms do not coincide with each 
other and do not coincide with the Dolph solution [5].
Figure A.3  The area of sidelobes of the AWF SD. 

298	
Weighting Functions for Harmonic Analysis and Adjacent Problems
Describing property allows the AWF application for the WF approximation, 
which is not expressed by elementary functions, and results in existence limitations 
to its application. It is known that the DC WF optimality in the energy value in 
specified frequency band defines this WF attraction. If it is necessary to synthesize 
the filters with adjustable bandwidth, we use the KB WF approximation [3]. The 
possibility of obtaining the WF with required spectral properties on the basis of 
AWF by specification of variable SD zero positions allows the creation of the WF, 
which cannot be used less successfully in these problems. In particular, to obtain the 
WF, by approximating the KB WF, it is enough to specify adjustable AWF SD zero 
positions 
2
2
ib
i
α
=
-
, where a is the KB WF parameter. A comparison of spectral 
Figure A.5  Logarithms of the AWF SD and KB WF SD modulus for a = 2.82 and the Harris WF SD 
modulus logarithm for a = 3. 
Figure A.4  The plot of the DC SD and the AWF difference at coinciding with the SD zero distribution.

A.3  SLL Minimization	
299
properties of such AWF, KB WF, and WF [3] is presented in Figure A.5. The bold 
curve corresponds to AWF SD modulus logarithm, the thin curve corresponds to 
the KB WF, and the dotted line corresponds to the J. Harris WF [3]. In a detailed 
consideration of the AWF SD and KB WF SD, a somewhat lesser width of the AWF 
SD main lobe on a zero frequency draws attention as well at a somewhat lesser level 
of the first SLs than for the KB WF. The Harris WF [3] already loses noticeably both 
to the KB WF and the AWF in the width of the SD main lobe on the zero level at a 
reduced scale at about 10 dB on the SD SLL. 
On the whole, the AWF approximates KB WF essentially better than the known 
WF [3]. As well, there are no limitations on the specified parameter a and, hence, 
on the SD SLL. Therefore, the approximation accuracy increases with N increasing 
and for N = M0 /2 AWF exactly coincides with KB WF. 
At the traditional definition of the asymptotic speed of the SLL decrease 
5.	
20log lim
(2 )/ ( )
s
x
C
S
x S x
®¥
=
 in the decibel per octave applied to the AWF of 
(A.13), (A.15), (A.14), and (A.16), we note that the AWF of the family 
ws(t,b1,b2,…, bN) Css = (6 + 12N¥), and wc(t,b1,b2,…, bN) Csc = (12 + 12N¥), 
where N¥ is the zero number specified on an infinite frequency. Thereby, 
these families mutually supplement each other in the asymptotic speed of the 
SD SLL decrease. 
A.3  SLL Minimization
To date, a variety WFs have been suggested and investigated; therefore, we compare 
our WF with those WFs that have been adopted as the best for important param-
eters. We mainly focus on DC, KB, Blackman, and Blackman-Harris WFs [3], as 
well as WFs developed recently [6–9]. 
The unambiguous connection of the AWF SD shape with specified zero positions 
allows on the basis of the AWF to obtain the WFs with spectral properties optimal on 
known and new criteria. We show the possibility of obtaining the WF according to the 
SLL minimum criterion at a specified width of the main lobe and the given speed of 
the SLL decrease, which is similar to a Dolph criterion but with the added requirement 
of the SD SL decrease with the frequency increasing. We assume that the following pa-
rameters are specified: the width of the SD main lobe on the zero level DF0, the speed 
of the SD SLL decrease Cs, and the number of WF items N. We need to define variable 
zero positions bi of the AWF SD in such a manner that the SLL would be minimal. 
At bi £ N + 1, the value of one of the variable zeros is defined by a specified width 
of the SD main lobe. In the future, for distinctness, we attribute the number 1 to the 
minimal value bi = DF0/2. Taking into consideration that the number N¥ is defined by 
a given Cs, the number of the variable AWF zero positions will be Nvar = N – (1 + N¥). 
Then, for SLL SD minimization, the objective function can be written in the form: 
	
(
)
var
0
2
3
2
3
max
,
,
,
min
i
N
F
b
N
S x b
b
b
D
£
£
Þ
…
	
(A.23) 
Therefore, from all variables bi , not more than two may accept values bi ³ N + 1.

300	
Weighting Functions for Harmonic Analysis and Adjacent Problems
To solve this problem we can use DC WF SD, for which limiting the values of 
the ratio of the main lobe width and the SLL are defined by the fundamental prop-
erty of the Chebyshev polynomial, as a standard in the width of the SD main lobe, 
in SLL, and in the initial distribution law of the SD zeros. To search optimal values 
of variable zero positions bi, we can use standard software of the multidimension 
optimization. The unambiguous connection of the SLL with values of the zero posi-
tions bi described above by property 3 essentially simplifies the search of optimal 
values of bi.
For an effectiveness comparison of known WFs and WFs with the suggested 
method of the optimal value bi, search the main spectral properties of the obtained 
WFs, DC WF, and some known WFs [6–9], which are the best on the ratio of the 
width of the SD main lobe and SLL and are presented in Table A.1. At the calcula-
tion of optimal AWF parameters on the basis of the AWF in (A.13) and (A.14), the 
values of DF0 and Cs coinciding with DF0 of the known WFs are considered to be 
initial. Fn for the DC WF are calculated for M = 32.
The frequencies bi of the optimal WFs obtained are shown in Table A.2.
It follows from Table A.1 that the SD SLL of the presented optimal WFs are 4.5 
to 14.89 dB less than the SD SLL of the best known WFs. In addition, the optimal 
WFs have a lesser equivalent noise band Fn and a lesser width on the level minus 
6 dB (DF6). To illustrate the advantages of optimal WFs, Figure A.6 shows the loga-
rithms of the SD modulus of the known (dotted line) and optimal (solid line) WF 
corresponding to lines 1 and 2 from Table A.1. It follows from the AWF spectral 
properties that with an increase of the necessary values of Cs, the advantages of the 
­optimal WFs (according to suggested criterion) increase. 
The typical SD view of the optimal WFs according to the above-mentioned 
criterion is constant SD SLL in the interval on a normalized frequency x £ N and 
decreasing SD SLL with the speed Cs for large x (Figure A.7, solid bold line and 
Table A.1  Comparison of Spectral Properties of Optimal WFs and the Best WFs
WF
Fn
SLL, dB
DFb
Algebraic WFs [8] Cs = (11 - 6) dB/oct
1.5344
-48.7
2.04
AWF 1. Cs = 12 dB/oct
1.5323
-54.0
2.0375
AWF 2. Cs = 6 dB/oct
1.5042
-56.77
1.9998
DC WF for DF0 = 4.797745
1.5073
-58.001
1.9833
WF [6], Cs = 6 dB/oct
1.7772
-68.72
2.3653
AWF 3. Cs = 6 dB/oct
1.7341
-76.044
2.304
DC WF for DF0 = 6.232644
1.7325
-77.914
2.2841
WF [7] Cs = 18 dB/oct
2.0339
-91.1
2.7058
AWF 4. Cs = 18 dB/oct
2.018
-95.656
2.6801
DC WF for DF0 = 8.0
1.9677
-102.27
2.6053
WF [7] Cs = 18 dB/oct
2.6704
-168.0
3.5503
AWF 5. Cs = 18 dB/oct
2.6471
-180.26
3.5133
AWF 6. Cs = 6 dB/oct
2.6292
-182.89
3.4895
DC WF for DF0 = 13.99936
2.5587
-184.49
3.4768
WF (К4Ч3), [9]
1.6932
-65.465
2.2234
AWF 7. Cs = 6 dB/oct
1.6705
-71.396
2.22
DC WF for DF0 = 5.84
1.6745
-72.482
2.2062
WF (
4
3,5
ˆE ´
), [9]
1.8007
-74.952
2.4255
AWF 8. Cs = 6 dB/oct
1.7973
-83.149
2.3876
DC WF for DF0 = 6.7
1.7985
-84.369
2.3735

A.3  SLL Minimization	
301
dotted line, respectively, for N = 9 and 3, and Cs = 30 dB/oct). In the specific case, 
the specification of Cs = 0 leads to the coincidence of AWF SD and DC WF SD (solid 
thin curve in Figure A.7), for which zero positions are given by (A.21).
We note two regularities in the WF SD property that are optimal according to the 
suggested criterion. At first, the SD SLL decreases at an increase of the item number 
of the optimal WFs and asymptotically aspires to the SSL of the DC WF SD. Then the 
width of the SD main lobe on any level different from zero decreases with an ­increase 
of the item number of the optimal WF and asymptotically aspires to the width of the 
SD main lobe of the DC WF, although at small N the function is not monotonic for 
all cases. Therefore, the significant disadvantage DC WF is a nondamping SD SLL 
and, accordingly, the presence of d functions at the end of the time interval in the 
optimal WFs (according to the above-mentioned criterion) is eliminated. Figure A.8 
shows a view of optimal WFs corresponding to the SD of Figure A.7.
Figure A.6  Logarithms of the SD modulus of the algebraic WF [10] and AWF SD.
Table A.2  Frequencies bi of Optimal WFs
Number of AWF
Type of AWF
1
wc(t; 2.3988727; 2.83204; 3.544289; 4.4047608; 5.346507; 6.34103; 7.39)
2
ws(t; 2.3988727; 2.79835; 3.46185; 4.26824; 5.1512; 6.078; 7.0321; 8.0048; 
8.9924)
3
ws(t; 3.1163222; 3.437; 4.0043; 4.7365; 5.5887; 6.808)
4
ws(t; 4; 4.27458; 4.77735; 5.447; 6.23285; 7.1074; ¥)
5
ws(t; 6.99968093; 7.147699; 7.434949; 7.846253; 8.363483; 8.968546; 
9.645222; 10.379934; 11.161824; 11.98258; 12.83627; 13.719615; 
14.633785; 15.59468; 17.04902; ¥)
6
ws(t; 6.99968093; 7.14364; 7.42322; 7.824; 8.3286; 8.9196; 9.5812; 
10.3001; 11.0656; 11.8692; 12.7045; 13.5673; 14.4558; 15.3762; 16.439; 
27.405)
7
ws(t; 2.92; 3.252978; 3.833244; 4.567715; 5.39413; 6.27688; 7.19651; 
8.14425; 9.1416)
8
ws(t; 3.35; 3.643958; 4.170447; 4.854965; 5.641272; 6.49436; 7.395305; 
8.34178; 9.466)

302	
Weighting Functions for Harmonic Analysis and Adjacent Problems
The suggested method of the WF parameter calculation is applicable for dis-
cretized WF as well. Therefore, it is recommended to use the WF parameters for 
continuous signals as initial data because zero positions of its SD are close enough 
to the required zero positions of the WF SD for discrete signals. As a result of 
optimization of discretized WFs containing, respectively, 16 and 32 samples, the 
improvement of the SD SLL achieves 1 dB and 0.2 dB compared to the initial zero 
distribution of the WF SD for continuous signals. 
The details of variable parameters bi of optimal WFs with a minimal SLL at 
the specified width of the main lobe and the specified speed of SLL reduction are 
presented in Tables A.3 through A.7. 
0.2
0
0.4
0.6
0.8
t
w(t)
2.0
1.5
1.0
0.5
0
Figure A.8  Shapes of optimal WFs.
Figure A.7  Logarithms of the SD modulus of optimal WFs.

A.3  SLL Minimization	
303
Table A.3  WF ws(t,b1,b2,…bN) Css = 6 dB/oct, N¥ = 0
Number of Parameters
Frequency bi
SLL, dB
DF6
2
1.4; 2.0632
-27.09
1.485922
3
1.4; 2.054043; 2.964663
-27.33723
1.483112
4
1.4; 2.044424; 2.939971; 3.928099
-27.63714
1.47939
2
1.6; 2.208305
-32.97952
1.605812
3
1.6; 2.182227; 3.032195
-33.36247
1.603638
4
1.6; 2.178836; 3.023188; 3.973943
-33.48996
1.602056
2
1.8; 2.404129 
-38.26729
1.716504
3
1.8; 2.32694; 3.1405 
-39.20138
1.714046
4
1.8; 2.321622; 3.114431; 4.024624
-39.387
1.712335
2
2; 2.6491486 
-43.18756
1.818843
3
2; 2.487429; 3.299383 
-44.7345
1.817976
4
2; 2.475827; 3.22575; 4.11802
-45.13832
1.815275
2
2.25; 3.04927
-49.421
1.936779
3
2.25; 2.7035993; 3.572
-51.26484
1.940396
4
2.25; 2.682512; 3.39257; 4.30566
-52.02798
1.937086
2
2.5; 3.722585
-56.68243
2.05184
3
2.5; 2.926706; 3.937952 
-57.63658
2.054632
4
2.5; 2.899511; 3.579703; 4.56725
-58.6678
2.052087
3
3; 3.352432; 5.32897 
-71.48284
2.263773
4
3; 3.348071; 3.97259; 5.410485
-71.66952
2.263569
3
3.5; 4.0431151; 6.7356365 
-83.77358
2.44219
4
3.5; 3.800474; 4.367091; 7.052055
-85.40866
2.45274
4
4; 4.280334; 5.089298; 8.71832
-98.17392
2.624308
4
4.5; 4.858; 6.093; 10.661
-110.9039
2.779906
Table A.4  WF wc (t,b1,b2,…bN), Csc = 12 dB/oct, N¥ = 0
Number of Parameters
Frequency bi
SLL, dB
DF6
3
1.4; 2.157665; 3.1993
-24.1852
1.52652
4
1.4; 2.12117; 3.10649; 4.20172
-25.1503
1.5138298
2
1.6; 2.3355
-28.30025
1.6731
3
1.6; 2.2818; 3.266
-29.68614
1.65569
4
1.6; 2.251815; 3.18716; 4.24754
-30.6118
1.624943
2
1.8; 2.45137
-34.11852
1.7843
3
1.8; 2.414494; 3.339252 
-35.247
1.77066
4
1.8; 2.39115; 3.27592; 4.29842
-36.11872
1.7591
2
2; 2.2573142 
-40.24508
1.881611
3
2; 2.554267; 3.418303 
-40.92898
1.873954
4
2; 2.537702; 3.372022; 4.353988
-41.657
1.864682
2
2.25; 2.754878 
-47.96589
1.990550
3
2.25; 2.737052; 3.524075
-48.28685
1.98942
4
2.25; 2.72918; 3.50134; 4.42942
-48.7074
1.984466
2
2.5; 3.030926 
-54.30191
2.095928
3
2.5; 2.930105; 3.650287 
-55.86316
2.09357
4
2.5; 2.92807; 3.63957; 4.51068
-55.9594
2.092906
2
3; 3.88623 
-67.81512
2.288039
3
3; 3.376487; 4.17828 
-69.18546
2.294054
4
3; 3.35398; 3.97416; 4.80736
-70.2846
2.29116
2
3.5; 4.643565 
-77.21836
2.41346
3
3.5; 3.826103; 5.17453 
-82.7938
2.47636
4
3.5; 3.811632; 4.384485; 5.42966
-83.5472
2.47686
3
4; 4.47028; 6.3214 
-95.412
2.636806
4
4; 4.27086; 4.77531; 6.67625
-97.3896
2.648014

304	
Weighting Functions for Harmonic Analysis and Adjacent Problems
Table A.6  WF wc(t,b1,b2,…bN), Csc = 24 dB/oct, N¥ = 1
Number of Parameters
Frequency bi
SLL, dB
DF6
3
1.4; 2.51857636; 1,000
-16.9138
1.629985
4
1.4; 2.349729; 3.623464; 1,000
-19.56942
1.594117
2
1.6; 1,000
-16.40066
1.84633
3
1.6; 2.620621; 1,000
-21.5749
1.77929
4
1.6; 2.46645; 3.687565, 1,000
-24.3922
1.7383038
2
1.8; 1,000
-20.99572
1.9811186
3
1.8; 2.7312594; 1,000
-26.24906
1.911007
4
1.8; 2.5922535; 3.75856; 1,000
-29.19132
1.867258
2
2; 1,000
-25.71544
2.095355
3
2; 2.849307
-31.00025
2.027671
4
2; 2.725822; 3.835922; 1,000
-34.0162
1.983531
2
2.25; 1,000 
-32.12221
2.213265
3
2.25; 3.0056083; 1,000
-37.12994
2.155634
4
2.25; 2.90197; 3.94075; 1,000
-40.14062
2.1140783
(continued)
Table A.5  WF ws(t,b1,b2,…bN) Css = 18 dB/oct, N¥ = 1
Number of Parameters
Frequency bi 
SLL, dB
DF6
2
1.4; 500
-15.20208
1.64042
3
1.4; 2.378089; 500
-19.4416
1.592094
4
1.4; 2.55973; 3.418061; 500
-21.65974
1.56301
2
1.6; 500
-20.278706
1.781389
3
1.6; 2.483348; 500
-24.493452
1.731378
4
1.6; 2.376282; 3.483558; 500
-26.776783
1.700032
2
1.8; 500
-25.638713
1.89916
3
1.8; 2.5968291; 500
-29.624189
1.85343
4
1.8; 2.505462; 3.555842; 500
-31.904634
1.822282
2
2; 500
-31.4675
1.996829
3
2; 2.7171887; 500
-34.9113
1.960934
4
2; 2.642124; 3.634295; 500
-37.0854
1.932324
2
2.25; 500
-39.814995
2.095535
3
2.25; 2.875389; 500
-41.85402
2.078174
4
2.25; 2.821662; 3.74006; 500
-43.7389
2.055044
2
2.5; 500
-48.342296
2.173559
3
2.5; 3.04; 500
-49.3226
2.179454
4
2.5; 3.009041; 3.853131; 500
-50.6284
2.165708
2
3; 500
-56.9301
2.28542
3
3; 3.469736; 500
-64.18742
2.355122
4
3; 3.400932; 4.095591; 500
-65.49388
2.353546
3
3.5; 4.240822; 500
-77.85908
2.518302
4
3.5; 3.843033; 4.539741; 500
-79.70314
2.5236434
4
4; 4.305338; 5.376281; 500
-93.32656
2.684405
4
4.5; 4.9137103; 6.42218; 500
-106.38509
2.8294814

A.3  SLL Minimization	
305
Table A.6  WF wc(t,b1,b2,…bN), Csc = 24 dB/oct, N¥ = 1 (Continued)
Number of Parameters
Frequency bi
SLL, dB
DF6
2
2.5; 1,000
-39.29543
2.308321
3
2.5; 3.1697628, 1,000
-43.56692
2.266916
4
2.5; 3.086543; 4.05357; 1,000
-46.4269
2.23089
3
3; 3.5141762; 1,000
-57.84979
2.449435
4
3; 3.474819; 4.298605; 1,000
-59.72495
2.431274
2
3.5; 1,000
-65.83734
2.5407214
3
3.5; 3.9223575; 1,000
-73.58677
2.59654
4
3.5; 3.88054; 4.56127; 1,000
-74.4692
2.596088
3
4; 4.641538; 1,000
-87.44663
2.737481
4
4; 4.322109; 4.968644; 1,000
-89.2459
2.744135
3
4.5; 5.37128; 1,000
-98.46473
2.842198
4
4.5; 4.78899; 5.7069; 1,000
-103.2239
2.886153
Table A.7  WF ws(t,b1,b2,…bN), Css = 30 dB/oct, N¥ = 2
Number of Parameters
Frequency bi
SLL, dB
DF6
4
1.4; 2.650662; 1,000; 1,000
-14.8566
1.6612243
5
1.4; 2.439512; 3.817512; 1,000; 1,000
-17.7969
1.620938
3
1.6; 1,000; 1,000
-13.55621
1.896219
4
1.6; 2.7495447; 1,000; 1,000
-19.23075
1.819364
5
1.6; 2.55289; 3.88014; 1,000; 1,000 
-22.3852
1.7716876
3
1.8; 1,000; 1,000
-17.63677
2.0452462
4
1.8; 2.857214; 1,000; 1,000
-23.57575
1.959752
5
1.8; 2.675487; 3.949685; 1,000; 1,000
-26.92525
1.906844
3
2; 1,000; 1,000
-21.80682
2.173834
4
2; 2.9726; 1,000; 1,000
-27.94963
2.084725
5
2; 2.806054; 4.02569; 1,000; 1,000
-31.46477
2.028914
3
2.25; 1,000; 1,000
-27.25528
2.308986
4
2.25; 3.1261684; 1,000; 1,000
-33.52656
2.222467
5
2.25; 2.978801; 4.129057; 1,000; 1,000
-37.19111
2.16619
3
2.5; 1,000; 1,000
-32.10006
2.41987
4
2.5; 3.28844433; 1,000; 1,000
-39.29666
2.342876
5
2.5; 3.160425; 4.240829; 1,000; 1,000
-43.02518
2.28924
3
3; 1,000; 1,000 
-46.74125
2.585523
4
3; 3.632704; 1,000; 1,000
-51.723
2.542026
5
3; 3.544303; 4.485683; 1,000; 1,000
-55.20301
2.50112
4
3.5; 3.993331; 1,000; 1,000
-65.9912
2.697789
5
3.5; 3.947912; 4.752225; 1,000; 1,000
-68.3842
2.676619
3
4; 1,000; 1,000
-74.3238
2.7777544
4
4; 4.3846225; 1,000; 1,000
-82.60318
2.823123
5
4; 4.36399; 5.03168 1,000; 1,000
-83.0788
2.823103

306	
Weighting Functions for Harmonic Analysis and Adjacent Problems
If necessary, we can calculate numerical values of coefficients Csn and Ccn of 
the optimal WF according to the formulas (A.19) and (A.20) using the above-
­mentioned bi.
A.4  Minimization of AWF Equivalent Noise Band
All AWFs at noise absence theoretically provide obtaining zero error for the frequency 
estimation of a resolvable signal; therefore, for the question about a choice of AWF 
type and a number of variable parameters, it is necessary to consider starting from 
the possibility of a frequency estimation error minimization caused by the noise. It is 
known that at a noise presence the equivalent noise band (ENB) of the WF influences 
used on the frequency estimation variance. This ENB is defined as [3]:
	
2
0.5
0.5
2
1
2
1
2
0.5
0.5
[ ( ,
,
,
)]
( ,
,
,
)
n
N
N
F
w t b b
b
dt
w t b b
b
dt
-
-
é
ù
=
ê
ú
ê
ú
ë
û
ò
ò
…
…
	
(A.24) 
	
0
0
2
1
1
2
0
1
2
1
2
0
0
[ ( ,
,
,
,
)]
[ ( ,
,
,
,
)]
M
M
n
N
N
F
M
w m b b
b
w m b b
b
-
-
é
ù
=
ê
ú
ê
ú
ë
û
å
å
…
…
	
(A.25) 
respectively, for continuous and discrete WF. 
Using these definition and taking into account (A.11) and (A.12), the analytic 
ENB expressions for the AWF in (A.11) and (A.15) and (A.12) and (A.16), we may 
reduce, respectively, to the forms: 
	
2
1
1
1
1
[
(
,
,
)]
2
N
nS
sn
N
n
F
C
b
b
=
=
+ å
…
	
(A.26) 
	
2
1
2
1
2
1
1
1
[
(
,
,
)]
8
cos(
)
1
(
,
,
)
2
1
N
cn
N
n
nC
N
cn
N
n
C
b
b
F
n
C
b
b
n
π
π
=
=
+
=
é
ù
+
ê
ú
+
ê
ú
ë
û
å
å
…
…
	
(A.27) 
Figure A.9 shows the ENB functions versus the positions of the specified zeros 
for the AWF ws(t,b1,b2,...bN) and wc(t,b1,b2,...bN) for the equality of all bn = b. In 
these two functions we see a clearly expressed ENB minimum and a small value 
Fn,min in the minima at b = bn,min. The value Fn,min monotonically increases when N 
increases. The specification bspec < bn,min leads to a fast increase of the ENB ­owing 
to an increase of the first SL forming in the frequency interval [bspec, N + 1]. At 
bspec > bn,min, the slow ENB increase is mainly caused by an increase of the main 
lobe width. At the same number of variable parameters, Fn,S < Fn,C.
It follows from obtained equations and plots that for any frequency x > 1.5 
there is the value of N, at which Fn is minimal. 
Let us consider the possibility of simultaneous minimization of estimation 
­errors caused by interference and a noise. We assume that for minimization of the 
estimation error caused by interference, it is necessary to specify N – Nn variable 
AWF parameters. We also suppose that for a specified additional number Nn, there 

A.4  Minimization of AWF Equivalent Noise Band	
307
are such values of variable parameters, at which the ENB value is Fn½N < Fn½N – Nn. 
In the specific case of the one additional variable parameter bn,min, the problem of 
determination of b minimizing ENB Fn,min for specified number of variable param-
eters N has an analytical solution. For the ENB of the AWF ws(t,bnSmin,b2,...bN):
	
(
)
(
)
(
)
(
)
2
2
2
4
2
2
2
2
2
2
1
, min
2
2
2
2
2
2
2
2
2
1
N
sn
N
n
n S
N
sn
N
n
A n
b
n
b
n
b
A n
b
n
b
n
=
=
-
-
=
-
-
å
å
…
…
	
(A.28) 
where 
2
1
1
2
2
1
(
,
)
( 1)
N
n
sn
N
k
k n
k
A
b
b
k
n
+
=
¹
= -
-
Õ
…
.
For the AWF wc(t,bnCmin,b2,...bN), respectively:
	
2
min
(1
)
0.25
(1
)
(1
)
n
n
n n
nC
n
n
n
n
D
G
C F
b
C
G
H F
+
-
=
+
+
-
+
	
(A.29) 
where 
2 2
1
N
n
n
n
n
D
B L
=
= å
; 
2
2
2
1
0,25
N
n
cn
i
i
n
n
B
A
b
=
æ
ö
+
=
-
ç
÷
-
è
ø
Õ
;
1
2
1
2
2
1
( 1)
(
,
)
2
1
(
)
(
)
N
n
cn
N
k
k n
k
k
A
b
b
n
k
k
n
n
+
=
¹
-
+
=
+
+
-
+
Õ
…
; Ln = n2 + n; 
1
cos
2
1
N
n
n
n
n
G
B
n
π
=
=
+
å
 ;
2
1
N
n
n
n
n
C
B L
=
= å
;
 
1
cos
2
1
N
n
n
n
n
n
F
B
L
n
π
=
=
+
å
;
 
2
1
N
n
n
n
H
B
=
= å
Figure A.9  The function of the ENB of the AWF ws(t,b,N) (bold lines) and wc(t,b,N) (thin lines) 
versus the position of a specified spectrum zero. 

308	
Weighting Functions for Harmonic Analysis and Adjacent Problems
In these expressions it was assumed that the AWF parameter, which earlier had 
the index 1 (i.e., b1), is varied for the ENB minimization and the index n,min is 
­accepted for it.
At the specification of one from the variable parameters according to the ENB 
minimum, its value is defined by equations:
	
2
2
2
2
2
min
2
2
2
1
min
1
1
1
1
2
N
N
nS
sn
i
i
n
nS
n
n
F
A
b
n
=
=
æ
ö
æ
ö
=
+
-
-
ç
÷
ç
÷
è
ø
è
ø
å
Õ
	
(A.30) 
	
π
π
=
=
=
=
æ
ö
æ
ö
+
+
+
-
-
ç
÷
ç
÷
-
-
è
ø
è
ø
=
é
ù
æ
ö
æ
ö
+
+
+
-
-
ê
ú
ç
÷
ç
÷
+
-
-
è
ø
ê
ú
è
ø
ë
û
å
Õ
å
Õ
2
2
2
2
2
2
2
2
2
1
n
min
n
min
2
2
2
2
2
2
1
n
min
1
1
1
0,25
0,25
8
cos(
)
1
1
1
2
1
0,25
0,25
N
N
cn
i
i
n
C
C
N
N
cn
i
i
n
C
n
n
n
n
A
b
b
F
n
n
n
n
n
A
n
b
b
	 (A.31)
where bn is defined in (A.29).
Figure A.10 shows functions of minimal ENB versus b, for AWF 
ws(t,bnSmin,b2,...bN) at equality of one parameter bn,min and all other parameters 
b2 = b3 = ... = bN = b.
Calculations show that at a simultaneous error minimization caused by interference 
and a noise, we may reduce more than 1.5 times of the component caused by a noise. 
In some cases, it is preferable to use the WF with an increased speed of the 
spectrum SLL reduction. From the earlier considered AWF properties, this speed 
increase is performed by the specification of the necessary zero number on infi-
nite frequency or on a half discretization frequency, respectively, at the analysis of 
continuous or discrete signals. Broadening the main lobe and level increase of the 
nearer SL of the spectrum and, hence, increase of ENB are the cost of using zeros to 
increase the reduction speed of SLL. The ENB minimization is possible in this case 
as well; however, minimal ENB levels essentially increase. 
Figure A.10  The function of the minimal ENB of AWF ws(t,b,N) versus the position of the specified 
spectrum zero.

A.5  Minimization of Frequency Estimation Error	
309
We must take into account that at specification of some roots bn ® ¥, items 
including these roots become equal to 1. The above-described analytical equations 
can be used for the AWF with an increased speed of the SLL reduction. 
A.5  Minimization of Frequency Estimation Error
For an unbiased WF choice in the detection problems with the simultaneous es-
timation of the range (frequency), we connect the main lobe width and the WF 
SD SLL with the signal frequency estimation error on the background of a single 
interference. For this, we introduce two additional parameters in the known system 
of parameters characterizing spectral WF properties [6, 9]. The first one is the rela-
tive error of the frequency estimation FEE. We define the value FEE as the ratio of 
the envelope of the current error when using the analyzing WF DxEE(b1,b2,...bN) 
to the maxima value of the frequency estimation error when using the uniform WF 
Dxmax(b1 = 1,b2 = 2,...bN = N) and qs/i >> 1:
	
EE
1
2
EE
max
1
2
(
,
,
)
(
1,
2,
)
N
N
x
b b
b
F
x
b
b
b
N
D
= D
=
=
=
…
…
	
(A.32) 
The second parameter is the maximal relative error of the frequency estimation 
FEEmax. We define FEEmax as the ratio of the maximal envelope value of the current 
error of the frequency estimation when using the analyzing WF to the maximal 
value of the frequency estimation error when using the uniform WF and qs/i >> 1: 
	
max
1
2
EEmax
max
1
2
(
,
,
)
(
1,
2,
)
N
N
x
b b
b
F
x
b
b
b
N
D
= D
=
=
=
…
…
	
(A.33) 
Figure A.11 shows the functions FEE when using the uniform weighting func-
tion (solid bold line) and the AWF ws(t) = 1–(1 – 1/b2)cos(2pt) with one variable 
parameter N = 1 for b = 2.2 (dotted line) and for b = (¥) (solid thin line).
We note some typical features of the function FEE for different WFs. It has two 
symmetric main lobes caused by the interaction of the main lobes of the signal’s SD 
and the interference’s SD and SL sequence. 
SLL FEE is connected with the SLL of the used WF SD and in the frequency area, 
where the normalized width of the SD SL is equal to 1, and is proportional to SD 
Figure A.11  Plots of the envelope of the relative measurement error versus the current range when 
using the uniform WF and AWF with different values of the SD main lobe width 2b. 

310	
Weighting Functions for Harmonic Analysis and Adjacent Problems
SLL. For such WFs, the decrease speed of the SLL FEE (which we designate as CF) 
is equal to the decreased speed of the SD SLL Cs. For the WF with the variable SL 
width (for instance, DC WF and KB WF), proportionality is disturbed but in the 
definitional domain of Cs, we have CF » Cs.
The function FEE allows the estimation of the IEZ size on a specified level. Simi-
lar to traditional definitions of spectrum parameters, it is advisable to define the 
main lobe width FEE on a zero level and on a specified level, which, in particular, 
may coincide with the SL level of the function FEE. The last parameter allows a real 
estimation of the IEZ size. For traditional WFs, the first parameter (the main lobe 
width FEE on zero level) is defined by the frequency difference of the maxima of the 
main lobe and the first SL. For AWF, the main lobe width FEE on the zero level can 
be specified by the zero position of the SD first derivative. 
The maximal relative error of the frequency estimation FEEmax increases with 
growth of the main lobe width of WF SD, but at this SLL, FEE decreases.
It follows from this definition that for any WF FEE is a function of the range dif-
ference between the UR and SR, and FEEmax is a function of the range difference by 
the number characterizing a loss in the measurement error, when using any WF com-
pared with a used uniform WF. According to this sign, FEEmax is similar to the widely 
used parameter Fn, the ENB. We note that Fn and FEEmax are unambiguously con-
nected to each other due to their unambiguous connection with WF ­parameters. 
The presence of the SL FEEmax can be adversely affected on the measurement 
results if there are several SRs in the probing space. 
The unambiguous connection FEE with the shape of the AWF SD, the irregular-
ity of the SL FEE, and its level dependence on the frequencies of the specified zeros 
allow the assumption that at such a selection of specified AWF zero frequencies, the 
SLL FEE will be minimal. 
To search the necessary zero distribution, we formulate the WF optimality crite-
ria. We assume that such a WF is optimal on the SLL FEE, which has a minimal SL 
level of the function of the relative error of frequency estimation at a specified maxi-
mum level of the frequency estimation relative error FEEmax and the specified SLL 
decrease the speed of the function of the frequency estimation error CF = Cs. In other 
words, an equivalent criterion such as the WF is optimal, which at a specified SLL 
decreased speed of the relative error function for frequency estimation and at a speci-
fied SLL of this function it provides the minimal value of the maximal relative error 
of frequency estimation FEEmax. We can formulate the following equivalent criterion: 
such a WF will be optimal on FEEmax, which at a specified width of main spectrum 
lobe and a specified decreased SL speed CF = Cs provides a minimum SLL FEE.
Taking into consideration that CF = Cs and, hence, it is defined by the view of 
used AWF and the number of specified zeros on infinite frequency N¥, the number 
of variable AWF zero positions when using the first and second criteria will be 
Nvar = N – N¥, and when using the third criterion, it will be Nvar = N – (1 + N¥). 
Then, for SLL FEE minimization when using the last criterion, the objective function 
can be written as: 
	
var
1
EE
2
1
1
max
( ,
,
,
)
min
10
N
x b
F
x b
b
b
b
N
³
Þ
£
£
…
	
(A.34)

A.5  Minimization of Frequency Estimation Error	
311
The functions of the minimal SL level FEE versus FEEmax for any specific AWF 
coincide at optimization according to all three criteria, which is caused by its equiv-
alence. Nevertheless, at optimization according to the last criterion, the number of 
variable parameters is less by one according to first two criteria, which significantly 
reduces the time expenses of a search of the necessary zero distribution. 
The values FEEmax, SLL FEE, and IEZ of optimal WFs obtained by us according 
to the offered approach for N = 6 and Cs = 6 dB/oct are presented in Table A.8. 
By obtaining these results, we did not take into account items from the frequency 
area x < 0. Practically, this situation is possible only for x >> 1 for a WF with Cs ¹ 
0. For a WF with WF c Cs = 0 (DC WF) due to the nondamping SL from the fre-
quency area x < 0, only the theoretical estimations of FEEmax, SLL FEE, and IEZ 
are possible.
Line 20 of Table A.8 corresponds to the boundary of values b1, b2, b3, at which 
the AWF optimization is possible according to the criteria offered. To obtain the 
AWF with a lesser SLL FEE, we need to increase N.
To compare the effectiveness of the known and offered WFs, Figure A.12 shows 
logarithms of functions FEE versus signal frequency at a fixed interference frequency 
of 10 and for signal processing by three WFs. 
The solid bold line corresponds to an optimal WF on FEEmax, which has an IEZ 
on the SL level FEE -38.773718 dB equal to 5.2. The dotted line corresponds to 
the WF with N = 2, b1 = 2, b2 = 5.16353246, which has FEEmax coinciding with the 
previous -1.35, and the IEZ on the same level of -38.773718 dB is 8. The bold dot-
ted line is for the Blackman WF 1
  2
28/3,
b
  b
=
  = ¥, which has an IEZ on the level 
Table A.8  WF wsN(t,b1,b2,…bN) Cs = 6 dB/oct, N¥ = 3
N
Frequencies b1
FEE max
SLL FEE, dB
IEZ
1
1.10363; 1.9634756; 2.6927854
1.0
-11.113341
2.566581
2
1.15; 1.9789563; 2.7092358
1.012501
-11.882937
2.645502
3
1.25; 2.0141513; 2.74710129
1.03931
-13.594666
2.816267
4
1.4; 2.0712165; 2.8099343
1.078821
-16.284956
3.073758
5
1.6; 2.1540838; 2.9045467
1.12958
-20.075839
3.418789
6
1.8; 2.2426; 3.01056
1.177608
-24.066848
3.763904
7
2; 2.333534; 3.126187
1.2225
-28.213420
4.105807
8
2.25; 2.3242544; 3.3119933
1.262522
-31.749849
4.408618
9
2.5; 2.5; 3.54939
1.319770
-36.669657
4.853110
10
2.75; 2.75; 3.913199
1.383134
-42.280005
5.366718
11
3; 3; 4.4269384
1.443876
-48.075619
5.879149
12
3.25; 3.4371126; 5.4825578
1.521717
-56.592380
6.556808
13
3.5; 3.9609817; 6.5190642
1.587437
-64.176026
7.166845
14
3.75; 4.3739306; 7.3095371
1.632825
-69.619660
7.603479
15
4; 4.6523975; 7.916533
1.664815
-73.569385
7.918859
16
4.25; 4.6978354; 8.1266794
1.681526
-75.339694
8.103814
17
4.5; 4.5195775; 8.1535615
1.686078
-75.704378
8.165823
18
4.75; 4.75; 6.5925594
1.687513
-72.720134
8.212658
19
5; 5; 5.671635
1.687534
-71.442070
8.239690
20
5.1982811; 5.1982811; 5.1982811
1.687427
-71.202871
8.246364

312	
Weighting Functions for Harmonic Analysis and Adjacent Problems
of -38.773718 dB equal to 5.8 and besides FEEmax is essentially more than -1.53. 
However, SLL FEE here is equal to -40.3659333 dB.
A comparison of plots clearly illustrates the advantages of the WF optimal in 
the frequency estimation error. 
Among the known WFs, the DC WF (without consideration of the SL from the 
frequency area x < 0) has the least SLL FEE at any values of FEEmax. The KB WF 
yields to the DC WF in the SLL FEE from 12 dB for FEEmax to 15.2 dB for FEEmax = 
1.9. Optimal WFs presented in Table A.8 in the SLL FEE exceed all known WFs 
[3, 6, 7–10] by 1.5 to 18.4 dB. We should emphasize especially that the WFs optimal 
on a frequency estimation error have an advantage even over one SAD item for the 
DC WF. Already for N = 3, the advantage in the SLL FEE at the admissible FEEmax 
is 3 dB for the optimal WF presented in the last lines of Table A.8. Moreover, they 
have damping sidelobes. 
From spectral AWF properties, it follows that for an increase in N, the achiev-
able SLL minimum FEE at a specified FEEmax decreases and, hence, the advantages 
of the optimal (according to the offered criterion) WFs in the problems of the signal 
frequency estimation increase. 
The presented results are evidence of the noticeable advantage of the WFs opti-
mal on FEEmax in the problems of the radio pulse frequency estimation and related 
problems, for example, such as estimating target angular coordinates for scanning 
antennas.
A.6  Conclusions
AWF properties allow the minimization of the truncation error particular to the Fou-
rier transformation during harmonic analysis of the multifrequency signal. These prop-
erties permit obtaining the WFs met to different criteria (both known and new), for 
instance, allowing the creation of the WFs with an extremely low SD SLL at a speci-
fied width of the main lobe and a specified decreased speed of the SD SLL or allowing 
the WF creation with an extremely low level of the frequency estimation error. 
We can say with confidence that the advantages of the AWFs and the WFs over 
traditional WFs allow a significant improvement of signal processing. 
Figure A.12  Plots of FEE, logarithm modulus optimal according to FEEmax, and WF with b1 = 2, b2 = 
5.16353246, and the Blackman WF.

A.6  Conclusions	
313
References
[1]	 Davydochkin, V. M., and S. V. Davydochkina, “New Calculation Method for Effective 
Weighting Functions for a Spectral Analysis,” Proceedings of XII Intern. Conf. Radar 
Technology, Navigation and Communication, Voronezh, Vol. 3, 2006, pp. 1662–1668. 
[In Russian.]
[2]	 Davydochkin, V. M., and S. V. Davydochkina, “Weighting Functions for Digital Adap-
tive Harmonic Analysis of a Signal,” Radiotekhnika, Vol. 9, No. 144, 2009, pp. 11–20. 
[In Russian.]
[3]	 Harris, F. J., “On Use of Windows for Harmonic Analysis with the Discrete Fourier Trans-
form,” IEEE Transactions on Audio Electroacoustics, Vol. AU-25, 1978, pp. 51–83.
[4]	 Voskresenskiy, D. I., et al., Antennas and SHF Devices: Calculation and Design of An-
tenna Arrays and Their Radiated Elements, Moscow, Russia: Sovetskoe Radio Publ., 1972. 
[In Russian.]
[5]	 Dolph, C. L., “A Current Distribution for Broadside Arrays Which Optimizes the Relation-
ship Between Beam Width and Sidelobe Level,” Proc. IRE, No. 6, 1946, pp. 335–348.
[6]	 Dvorkovich, A. V., “New Calculation Method of Effective Window Functions Used at Har-
monic Analysis with the Help of DFT,” Digital Signal Processing, No. 2, 2001, pp. 49–54. 
[In Russian.]
[7]	 Dvorkovich, A. V., “Once More About One Method for Effective Window Function Cal-
culation at Harmonic Analysis with the Help of DFT,” Digital Signal Processing, No. 3, 
2001, pp. 13–18. [In Russian.]
[8]	 Kirillov, S. N., M. Y. Sokolov, and D. N. Stukalov, “Optimal Weighting Processing at Spec-
tral Analysis of Signals,” Radiotekhnika, No. 6, 1996, pp. 36–38. [In Russian.]
[9]	 Kravchenko, V. F., Lectures on Atomar Function Theory and Some Applications, Moscow, 
Russia: Radiotekhnika Publ., 2003. [In Russian.]
[10]	 Kharkevich, A. A., Spectra and Analysis, 4th ed., Moscow, Russia: Fizmatgiz Publ., 1962. 
[In Russian.]


315
List of Acronyms
AFW	
accompanying flow of waves 
AWF	
adaptable weighting function 
AWP	
antenna-waveguide path 
BH	
Blackman-Harris
CS	
complex spectrum
CSD	
complex spectral density 
CW	
continuous wave 
DC	
Dolph-Chebyshev, directional coupler
DC WF	
Dolph-Chebyshev weighting function
DF	
difference frequency 
DFS	
difference-frequency signal 
DFT	
discrete Fourier transformation
DP	
directional pattern
DR	
dielectric resonator 
DS	
directing system 
DSP	
digital signal processing 
ED	
error of discreteness 
EE	
error envelope
EMW	
electromagnetic wave
EN	
envelope nodes 
ENB	
equivalent noise bandwidth
FM	
frequency modulation 
FMCW RF	
frequency-modulated continuous-wave range-finder
FSCW	
frequency stepped continuous wave
FT	
Fourier transformation
FFT	
fast Fourier transformation 
IEZ	
increased error zone
IDFT	
integral-discrete Fourier transformation
KB	
Kaiser-Bessel
KB WF	
Kaiser-Bessel weighting function
LF	
likelihood function 
LLF	
logarithm of likelihood function 
LLRF	
logarithm of likelihood ratio function 
LRF	
likelihood ratio function 
MC	
modulation characteristic 
MLM	
maximal likelihood method
MQIS	
methods of QI smoothing 
MR	
measuring room
MSD	
mean square deviation
MTB	
measuring test bench 
PAM	
parasitic amplitude modulation

316	
List of Acronyms
PC	
phase characteristic, personal computer
PFC	
phase-frequency characteristic
PLL	
phase-locked loop
PR	
passive reflector
PSD	
power spectral density
RF	
range-finder 
RR	
radar reflector
QI	
quantization interval 
SAD	
spectral amplitude density
SC	
spectral component
SD	
spectral density 
SF	
signal function
SIR	
signal/interference ratio
SL	
sidelobe 
SLL	
sidelobe level
SNR	
signal/noise ratio
SOM	
self-oscillation mixer 
SPD	
spectral power density
SR	
spurious reflector 
SRP	
stationary random process 
SSP	
spurious spectral peaks
TRM	
transmitting-receiving module
UR	
useful reflector
WF	
weighting function 

317
About the Authors
Boris A. Atayants was born in 1940 in Makhachkala, Russia. 
He graduated from the Radio Engineering Faculty of Ryazan 
Radio Engineering University and worked in the Radio Con-
trol and Communication department until 1984, where he 
taught the lecture courses Radio-Relay Communication and 
Radio Control of Space Apparatuses. He was the executor 
responsible for performing several R&D projects carried out 
by USSR Government Order. He worked as a member of Sci-
entific Council of USSR Academy of Sciences on ultrahigh-band radar technology.
From 1984 he worked in the instrumentation industry. He is one of the found-
ers of the first radar level-meters in the Soviet Union (the series LUCH). 
In 1991 he helped establish the innovative scientific-industrial company 
­Contact-1. From February 1992 he worked as the general director–chief designer 
of this enterprise, which was awarded “best enterprise of the industrial branch” in 
accordance with All-Russia and regional competitions in 2002–2012.
Boris A. Atayants has a Ph.D. in engineering. His list of scientific publica-
tions includes more than 200 published papers, one book, and more than 50 
patents.
He was awarded the rank of Best Manager of Russia and was decorated with 
the gold medal “The Premium of Peter the Great,” and in 2012 he became the pre-
mium laureate, which was named after V.F. Utkin, in science and technology. He 
has been awarded diplomas at both the federal and regional levels. 
Viacheslav M. Davydochkin was born in 1947 in the 
Shiringushi settlement  in Russia. He graduated from sec-
ondary school in 1964 and entered Rayzan Radio Engineer-
ing University (RREU). After graduation from RREU with a 
concentration in radio electronic devices he worked in the Ra-
dio Electronic Devices department as an engineer, an assistant-
professor, a junior researcher, and a senior researcher. In 2001 
he joined the JSC Contact-1, where he works as the chief of the 
antenna-feeder devices’ sector.
Vacheslav M. Davydochkin combines practical industrial activity with scientific 
research in the field of digital radar signal processing, development of methods and 
algorithms for accuracy and noise-immunity increase for range measurement by 
short-range FM radars. In 2008 he defended his Ph.D. thesis on radio engineer-
ing including TV systems and devices and radar and radio navigation technology. 
He is the author of more that 100 scientific publications, including 40 patents and 
one book.

318	
About the Authors
Victor V. Ezerskiy was born in 1947 in Berlin, Germany, 
into the family of an Soviet Army officer. In 1966 he gradu-
ated with honors from Ryazan Polytechnical College. In 1972 
he graduated from Ryazan Radio Engineering University 
with honors in the concentration radio electronic devices. He 
worked as an R&D engineer in the Theoretical Fundamentals 
of Electrical Engineering department, and in 1975 he joined 
the Radio Electronic Devices department. In 1979 he began 
his Ph.D. and after graduation in 1983 he defended his Ph.D. 
thesis on radar and ­radio navigation technologies devoted to 
the theory of polarization sign application for recognition of radar objects. From 
1983 he worked as an assistant professor and associate professor in the Theoretical 
Fundamentals of Electrical Engineering ­department. From 1991 he worked as an 
associate-professor in the Radio Control and Communication department where he 
did research in the field of ultrahighband radar technology. In 1997 he combined his 
academic work at the university with practical and research activity at Contact-1 
in the field of precision range measurement in short-range FM radar technology. In 
2006 he defended his Dr. Sci. thesis in the specialty of radar and radio navigation 
technologies. Since 2007 he has worked as a professor in the Radio Control and 
Communication department of Ryazan State Radio Engineering University and as 
the leading researcher at Contact-1. In 2013 he was made a full professor. 
Victor V. Ezerskiy performs scientific research in the fields of digital radar signal 
processing, development of methods and algorithms of accuracy, and noise-immunity 
increase for range measurement in short-range FM radar technology. He is the au-
thor of 130 publications including one book and 27 patents.
He is a member of editorial board of several scientific journals.
Victor V. Ezerskiy has the title of Honorary Worker of Higher Professional 
Education. In 2012 he was awarded the Ryazan Region Premium in Science and 
Technology, which was named after the academician V. F. Utkin.
Valery S. Parshin was born in 1947 in the Kaliningrad re-
gion of Russia. In 1969 he graduated from the Ryazan Poly-
technical College with a concentration in radio apparatuses. 
For three years he worked as a technician in industry. In 1975 
he graduated from the Ryazan Radio Engineering University, 
concentrating in radio electronic systems. He worked as an 
engineer and an assistant professor in the Radio Electronic 
Devices department. From 1980 to 1983 he studied for his 
Ph.D. In 1984 he defended his Ph.D. thesis in the area of ra-
dar and radio navigation technologies. The title of the Ph.D. 
thesis was “Recognition of Pulse Random Interference.” He then worked as a senior 
researcher and assistant professor. In 1990 he was an associate professor in the 
Radio Control and Communication department of Ryazan State Radio Engineering 
University. In 2004 he combined his scientific and academic work at the university 
with practical and research work in industry at Contact-1 as a leading specialist. 
In November 2013 he defended his Dr.Sci. thesis titled “Methods and Algorithms 

﻿	
319
of Recognition and Parameter Estimation of Random Processes at Presence­ of 
­Disturbing Factors.”
Valery S. Parshin performs scientific research in the field of digital signal pro-
cessing for radio systems in the frequency domain. The area of his scientific interests 
is the recognition of random signals and their parameter estimation at presence of 
disturbing factors and FM range measurement. He is the author of more than 130 
scientific publications including one book and he holds 15 patents. 
Sergey M. Smolskiy was born in 1946 in Moscow, Russia. 
In 1964 he graduated from secondary school with a medal 
and entered Moscow Power Engineering Institute (Technical 
University) (MPEI). He graduated in 1970 from the Radio 
Engineering­ Faculty of MPEI with a concentration in radio 
physics and electronics and was recommended to a Ph.D. 
course. During his Ph.D. studies at MPEI he received a schol-
arship named after Lenin and in 1974 defended his Ph.D. the-
sis on the theory of high-frequency transistor oscillators. After 
finishing the Ph.D. course he worked at the Radio Transmit-
ter ­Department of MPEI as a senior researcher, the head of 
research lab, and the head of research division. Later he moved to the position of 
MPEI deputy vice-rector for research and the position of MPEI vice-rector on inter-
national relations. In 1993 he defended his doctor of sciences thesis on radar and ra-
dio navigation systems. In 1994 he became a full professor and in 1995 was elected 
as a head of the radio receiver department. Since 2006 he has worked as a professor 
in this department, as well as also being the deputy director of the MPEI Institute of 
Radio Engineering and Electronics.
During this time he worked on a series of significant scientific and applied 
problems. In particular, he participated in the development of the theory of au-
tonomous and synchronized transistor self-oscillation systems and the develop-
ment of methods of mathematical modeling  and effective algorithms for analysis 
of self-­oscillating systems. He actively developed the theory and implementation 
of autodyne (self-oscillating mixers) systems for the short- range radar, and has 
done research in the field of medical electronics, radio monitoring systems, self-
similar processes in telecommunications, and investigations of chaotic oscilla-
tions and signals. Professor S. M. Smolskiy is a recognized expert in these and 
other areas.
S. M. Smolskiy holds the academic degree of doctor of engineering sciences. 
He was elected as the academician of several Russian and international academies: 
­International Academy of Electrical Sciences, International Academy of Informati-
zation, and International Academy of Higher Educational Institutions. He is a mem-
ber of IEEE and has been made honorary doctor of three foreign universities.
S. M. Smolskiy is actively and fruitfully working in the scientific areas he helped 
create: development of the theory and practical implementation of short-range ra-
dar systems and self-similar systems, improvement of radio monitoring and chaotic 
signal theory, and research in the field of medical instrumentation, electrodynamics, 
and quantum radiophysics.

320	
About the Authors
He is the author of more than 250 scientific publications including 12 books.
Under his scientific supervision two doctor of sciences theses and 11 Ph.D. the-
ses were prepared. He participates in conferences with reports and reviews along 
with lecture courses at foreign universities. Some of his pupils have become heads 
of departments in different Russian universities and in various companies.
Professor S. M. Smolskiy made significant contributions to the creation of All-
Russia and international conferences and symposiums on the theory and implemen-
tation of oscillating and radar systems.
He is a member of Popov Scientific-Engineering Association of Radio Engi-
neering, Electronic and Communication, and the head of the Radio Engineering 
Methods in Power Engineering Section. He is a scientific supervisor and a member 
of organizing committees for international scientific conferences.
He is the Honor Radio Engineer of Russia, and he was awarded the Gold Medal 
of Popov “for services in development of radio electronics and communication.” 
He is also the Honor Worker of Russian Higher Education, and he was awarded by 
Polish order, the Medal of Riazansky by theAcademy of Space Research.

321
Index
A
Accompanying ﬂ ow of waves (AFW), 192
Adaptable weighting functions (AWFs)
 
algorithms of frequency estimation with, 
86–88
 
analytical expressions for, 291–94
 
application with minimal varied 
parameters, 208
 
continuous, 294
 
deﬁ ned, 86
 
function of zero frequency, 88
 
irregularities, 270
 
minimization of equivalent noise band, 
306–9
 
minimization of truncation error, 86
 
at noise absence, 87
 
parameters, 212
 
SAD, 200–201
 
samples, 86
 
SD, 295, 296
 
SD logarithms, 298
 
SD SLL variation, 296
 
spectral properties, 291
 
spectral properties in DSP problems,  
295–99
 
varied parameters, 208
Antenna aperture, reﬂ ection from 
irregularity in, 176
Antenna-waveguide path (AWP)
 
dust and moisture on elements, 200
 
encapsulating insert in, 204
 
encapsulation device in, 191
 
family, 177
 
irregularities, 168, 174, 190–91, 192
 
length, 178
 
reﬂ ection from elements, 199
 
relative length, 175
 
resonant reﬂ ections and, 168
 
as signal mathematical model, 177
 
SR parameters in, 191
 
SRs in, 174–81
Atmosphere sensing radar, 283
Average difference frequency, for 
modulation half-period, 141
Average MSD
 
function of logarithm of noise 
component, 62
 
logarithm functions of, 59, 60
 
 
See also Mean square deviation (MSD)
Average weighted estimation
 
of difference frequency, 88–91
 
truncation error of, 88–91
Average-weighted frequency estimation, 71
B
BAR series, 290
Bessel function, 93
Best WFs, 300
Bird’s observation radar, 283–84
Blackman-Harris WF, 48
Blackman WF, 102, 128, 129, 181, 270
C
Cancellation
 
complex spectral density (CSD) for, 
226–28
 
interference signal, in spectral domain, 
225
 
mode activation, 224
 
spectral power density (SPD) for, 228–32
 
of spurious reﬂ ections, 223–32
Chebyshev polynomial, 260
Combined optimization
 
deﬁ ned, 55
 
measurements, 55
 
normalized error logarithm versus 
normalized range with, 56

322 
Index
Combined optimization (continued)
 
procedure of error minimization, 56
Complex spectral density (CSD)
 
for cancellation, 226–28
 
DC WF, 74
 
of DFS, 75
 
measurement errors at, 227
 
SC, 92
Complex spectrum (CS), 67–68
CONTACT-1, 264
Continuous AWFs, 294
Correction coefﬁ cients
 
algorithm sequence, 153–54
 
central frequency estimation using, 95–99
 
connection with nonlinearity parameters, 
151–53
 
estimation according to operating 
difference-frequency signal, 153–55
 
simulation conditions, 154–55
 
systematic inaccuracy of frequency 
estimation and, 91–92
Correlation coefﬁ cients, 111
D
Delay time estimation
 
with MLM, 113–16
 
obtaining, 116
Delta function, 292
Dielectric resonators (DR), 9
Difference frequency estimation
 
algorithms of, 68–71
 
for algorithm with correction coefﬁ cients, 
91–92
 
average weighted, 88–91
 
conclusions, 103–4
 
introduction to, 67–68
 
maximum position of spectral density of 
difference frequency signal, 71–88
 
minimization of measurement error,  
77–80
 
noise inﬂ uence on accuracy, 94–103
 
noise interference and, 92–103
 
by position of spectrum maximum,  
67–104
 
stimulation of algorithms, 102–3
 
systematic inaccuracy, 91–92
 
truncation error at WFs, 74–77
 
truncation error of range measurement, 
71–74
Difference frequency estimation error 
reduction
 
algorithm, 216–17
 
answers, 217
 
correcting amendment determination,  
214
 
correction coefﬁ cient estimation, 215
 
envelope curves and, 211
 
method of, 211–15
 
probability of, 213
 
sequence of actions, 216
 
situations, 210–11
Difference-frequency signal (DFS)
 
average, 5
 
central frequency estimation, noise and, 
95–99
 
CSD of, 75
 
deﬁ ned, 1
 
error components, 12
 
extreme appearance moment, 26
 
extreme positions, 25
 
frequency estimation error, 68
 
frequency measurement, 100
 
graph, 3, 4
 
half-periods, 11, 17
 
instantaneous, 2, 4
 
number of periods, 13–14
 
PAM, 8–9, 119–21
 
phase estimation, 111
 
phase joining, 10, 16
 
phase-joining errors, 23, 28
 
phase jump, 9
 
phase shift, 7, 117
 
phase variation, 4, 51
 
preliminary analog processing, 31
 
processing stages, 290
 
pulling period, 13–14
 
range estimation based on, 108–13
 
SAD maximum, 71
 
SCs of, 99, 203
 
SPD, 228
 
spectral density of, 92–103
 
spectrum calculation, 91
 
weighted sample of, 72

Index 
323
 
zero determination, 51
 
zero displacement, 173
 
zero padding in, 69
 
zeros, 5, 6, 29
Digital signal processing (DSP), 67–68
Directing system (DS)
 
deﬁ ned, 187
 
measurement error versus relative range 
in, 190
 
object probing in, 189
 
reﬂ ector probing in, 188
Directional coupler (DC), 188
Directional pattern, 181
Discrete Fourier transform (DFT), 67–68
Discretized WFs, 292
Displacement meters, small, 284
Distance measurement error
 
radiated power level inﬂ uence on, 269
 
results of experimental reduction of, 
269–72
 
to RR, 263
Distribution law, 115
Dolph-Chebyshev (DC) WF
 
CSD, 74
 
difference frequency estimation 
truncation error at, 74–77
 
FM sweep for, 79
 
measurement error at optimal values, 82
 
normalized measurement error versus  
normalized range, 75
 
normalized range, 84
 
normalized range for optimal parameters, 
85
 
parameters, 81
 
range point positions versus root number,  
76
 
SAD processed by, 82
 
variation of SD shape, 80
Dolph-Chebyshev method, 259
E
Echo signals, error caused by, 220–21
Edge modes, 184–86
Eigenvector algorithm (EV)
 
deﬁ ned, 244
 
disadvantage, 244
 
in frequency range ﬁ nding, 245
 
MUSIC method versus, 244
 
SC selection of spectrum, 245
 
spectrum estimation, 244
Electrodynamic distance, 270
Electromagnetic waves (EMWs)
 
mathematical models, 169
 
reﬂ ection coefﬁ cient of, 205
 
scattered, 169
Envelope nodes (ENs)
 
controlling FM sweep, 50
 
deﬁ ned, 40–41
 
error position, 50
Envelopes
 
measurement error and, 180
 
of normalized error of range estimation,  
181
 
of relative measurement error, 309
 
shape of, 240
Equivalent noise band (ENB)
 
AWF, minimization of, 306–9
 
deﬁ ned, 306
 
functions of, 306, 307, 308
Error envelope (EE), 171, 172
Experimental reduction
 
of error caused by virtual interference, 
266–69
 
waveguide-measuring test bench, 266–67
Extreme displacement function, 234, 235
F
Fast Fourier transform (FFT), 67–68, 69, 70
Fast oscillation, 148
FMCW radar
 
atmosphere sensing radar, 283
 
bird’s observation radar, 283–84
 
characteristics, xix–xx
 
for civil purposes, xviii
 
deﬁ ned, xvii
 
devices, 277
FM geo-radar, 282–83
 
guarding systems, 284–85
 
ice and snow blanket thickness meters, 
281–82
 
level-meters, 281
 
navigation radar, 279

324 
Index
FM geo-radar (continued)
 
practical application areas, 277–85
 
radio altimeters, 278–79
 
radio proximity fuses, 279
 
range ﬁ nders for geodesic research, 283
 
robotic navigation and mapping systems, 
285
 
small displacement meters, 284
 
theoretical analysis, xx
 
transport radar, 280–81
FM geo-radar, 282–83
FM nonlinearity
 
compensation of modulation 
characteristic nonlinearity, 155–60
 
conclusions, 164–65
 
connection of correction coefﬁ cient with 
nonlinearity parameters, 151–53
 
for counting method of frequency 
measurement, 141–47
 
effects of, 137–65
 
estimation of correction coefﬁ cient,  
153–55
 
introduction to, 137
 
modulation characteristic, mathematical 
model of, 137–40
 
oscillating modulation characteristic, 
144–47
 
quadratic modulation characteristic, 
142–43
 
quadratic modulation characteristic with 
oscillating component, 147
 
for weighting method of difference 
frequency averaging, 147
FM parameter optimization
 
combined, 55–56, 80
 
combined procedure of error 
minimization, 56
FM sweep, 53–55, 78–79
 
minimization of measurement error,  
77–80
 
slow-frequency modulation, 50–53
 
truncation error minimization by, 50–56
FM RF calibration, 265
FM sweep
 
for DC WF, 79
 
EN control, 50
 
frequency, 146, 147
 
function value, 52
 
for KB WF, 79
 
linearity of, 137
 
maximal degree of, 54
 
normalized, function of, 53
 
normalized error logarithm versus 
normalized range, 54
 
optimization of, 53–55, 78–79
 
of SHF oscillator, 158
Frequency estimation
 
for algorithm with correction coefﬁ cients, 
91–92
 
approaches, 20–22
 
average-weighted, 71
 
determination, 96–97
 
ﬁ rst approach, 20–21
 
noise inﬂ uence on accuracy, 94–103
 
noise inﬂ uence with sliding half-strobes, 
101–2
 
of SAD parameters, 205
 
second approach, 21–22, 29–30
 
shift, 97
 
stimulation of algorithms, 102–3
 
systematic inaccuracy, 91–92
 
unstable zones of, 269
 
variance calculation, 94–95
 
 
See also Difference frequency 
estimation
Frequency estimation error
 
minimization of, 68, 309–12
 
plots, 73
Frequency measurements
 
algorithm by eigenvector analysis in noise 
subspace, 244–47
 
algorithm by Prony method, 247–50
 
with methods of parametric spectral 
analysis, 244–50
Frequency-modulated continuous wave 
(FMCW). See FMCW radar
Frequency modulation (FM)
 
parameters, 8–12
 
in range measurement, 1
Frequency range-ﬁ nder (FRF), xvii
G
Geodesic research, range ﬁ nders for, 283

Index 
325
Geo-radar, FM, 282–83
Guarding systems, 284–85
H
Harris WF, 299
I
Ice and snow blanket thickness meters, 
281–82
Ideal linear FM results, 289
Increased error zone (IEZ)
 
carrier FM sweep and, 235
 
deﬁ ned, 170
 
phase characteristic (PC) estimation error 
and, 239
 
size reduction, 223
 
in SPD for cancellation, 230–31
 
UR exit from, 247
 
value determination, 203
Instantaneous error estimations, 242
Instantaneous measurement error, 91, 227
Instantaneous range measurement error, 
231, 246, 252, 254
Instantaneous truncation error, 103
Integral discrete Fourier transformation 
(IDFT), 69
Interference
 
estimation of, 198
 
property differences, 204
 
pulse, 179
 
SAD, 206
 
simultaneous error minimization, 308
 
virtual, 266–69
Interference ﬁ eld
 
complex amplitude, 186
 
creation by toroidal wave, 186
 
distribution, 186
K
Kaiser-Bessel WF
 
application of, 50
 
approximation, 298
 
deﬁ ned, 42
 
derivative of, 62
 
difference frequency estimation 
truncation error at, 74–77
 
error obtained using, 50
FM sweep for, 79
 
measurement error at optimal values, 82
 
measurement error for, 62–64
 
normalized measurement error versus 
normalized range, 77
 
normalized range for optimal parameters,  
85
 
optimal, 49
 
parameter values, 63
 
proﬁ le, 43
 
range of shape, 49
 
range point positions versus point 
number, 77
 
SAD processed by, 82
 
SD logarithms, 298
 
 
See also Weighting functions (WFs)
L
Level-meters, 266, 281, 290
Likelihood function (LF), 108
Likelihood ratio function (LRF), 108
Logarithm of likelihood function (LLF)
 
deﬁ ned, 108
 
fast oscillating character, 113
 
form, 108
 
global maximum determination, 113, 114
 
local maximums, 114
 
properties in spectral domain, 112
Logarithm of likelihood ratio function 
(LLRF), 108
LUCH-2, xviii
M
Maclaurin series, 142
Mapping systems, robotic, 285
Maximal likelihood method (MLM)
 
advantages of, 108
 
as asymptotically effective, 109
 
beneﬁ t of accuracy, 134
 
conclusions, 135–36
 
deﬁ ned, xviii
 
delay time estimation, 113–16
 
errors in application of, 116

326 
Index
Maximal likelihood method (MLM) 
(continued)
 
estimates, 130
 
factors affecting range error estimation 
and, xxi
 
function of relative MSD for, 131
 
measurement of small ranges with, 243
 
parametrical algorithm based on, 274–75
 
for range estimation, 107–36
 
simulation of range estimation algorithm, 
130–35
 
successful implementation, 117
 
total error reduction and, 133
Mean square deviation (MSD)
 
amplitude of oscillations, 59
 
average, 59, 62
 
calculation on range parts, 45
 
measurement error, 45–50
 
measurement error, virtual reﬂ ectors and, 
219–20
 
of noise error component, 58
 
normalized, 41, 47
 
normalized, number versus relative range 
for optimal coefﬁ cients, 48
 
range estimation, 98
 
range measurement, 150
 
total error, 61, 63
Measurement error reduction
 
conclusions, 221–22
 
correcting amendment determination,  
214
 
correction coefﬁ cient estimation, 215
 
of difference frequency estimation, 
210–17
 
envelope curves and, 211
 
estimation of interference situation and, 
198–204
 
introduction to, 197–98
 
probability of, 213
 
by virtual reﬂ ector, 217–21
 
weak signal, 204–10
Measurement errors
 
at CSD, 227
 
distance, 263
 
envelopes versus range to UR, 180
 
instantaneous, 91, 227
 
for Kaiser-Bessel WF, 62–64
 
minimization on basis of FM parameter 
optimization, 77–80
 
noise and, 57
 
noisy component of, 57
 
relative, functions of, 40
 
SR presence and, 198
 
time delay, 116–21
 
for WF in form of trigonometric series, 
58–62
 
See also Range measurement error
Methods of QI smoothing (MQIS), xx, 8, 
56–57
Mixers
 
combination components, in range 
measurement error, 192–94
 
low-frequency components, 192
Modiﬁ ed Bessel function, 42
Modulation characteristic nonlinearity
 
approximation of time function of signal 
periods, 162–64
 
compensation of, 155–60, 165
 
counting measurement method, 164–65
 
equation system, 163–64
 
error level reduction, 165
 
estimation of extreme period parts, 
161–62
 
matrix form, 163
 
nonproportional variation and, 141
 
parameters, 150, 151–53
 
at range calculation, 160–64
Modulation characteristics (MC)
 
averaged slope, 157
 
estimation of nonlinearity inﬂ uence, 147
 
of industrially manufactured oscillator,  
139
 
mathematical model of, 137–40
 
oscillating, 144–47
 
 
oscillating nonlinearity of, 151–52
 
oscillation component plot, 139
 
parameters, 138
 
performance of two stages, 140
 
quadratic, 142–43
 
quadratic, with oscillating component,  
147
 
quadratic and oscillating nonlinearity of, 
152–53
 
quadratic nonlinearity of, 151

Index 
327
 
slope coefﬁ cient, 150
 
spectral peak parameters, 140
Movement speed
 
nonuniform velocity, 253–55
 
range prediction based on, 250–55
 
uniform velocity, 250–53
Multidimensional numerical minimization, 
140
Multiple signal classiﬁ cation (MUSIC)
 
deﬁ ned, 244
 
EV method versus, 244
 
as high resolution method, xviii
 
spectrum estimation, 244
N
Navigation radar, 279
Navigation systems, robotic, 285
Noise
 
covariance function of, 57
 
error of range measurement, 92–103
 
error of weighting method, 56–64
 
on ﬁ lter output, 57
 
inﬂ uence on accuracy of central frequency 
estimation, 94–103
 
inﬂ uence on accuracy of DFS central 
frequency estimation, 95–99
 
inﬂ uence on average-weighted estimation, 
99–101
 
inﬂ uence on DFS frequency estimation, 
101–2
 
measurement error caused by, 57
 
in reducing accuracy of distance 
measurements, 289
 
simultaneous error minimization, 308
 
WF shape and, 62
Noise effect
 
additive, estimation of, 56–57
 
time moments and, 57
Noise error
 
MSD of, 58
 
variance of, 57
Nonuniform velocity
 
error accumulation, 253
 
instantaneous range measurement error,   
254
 
range predication based on, 253–55
 
simulation conditions, 254
 
of useful reﬂ ector movement, 253–55
O
Observation radar, bird, 283–84
Optimal RRs, 263, 264
Optimal WFs
 
best WFs comparison, 300
 
frequencies of, 301
 
KB proﬁ les, 49
 
logarithms of SD modulus of, 302
 
proﬁ les of, 47
 
shapes of, 302
 
variation of shape, 46
Optimization
 
combined, 55–56, 80
 
of FM sweep, 53–55, 78–79
 
minimization of measurement error,  
77–80
 
slow-frequency modulation, 50–53
 
truncation error minimization by, 50–56
 
of WF parameters, 80–85
Oscillating modulation characteristic
 
error value estimation, 145
 
parameters, 144
 
quantitative estimation, 145
 
stepwise variation of measuring range, 
144
Oscillating nonlinearity
 
of modulation characteristics, 151–52
 
quadratic nonlinearity and, 152–53
 
worst case of, 160
Oscillation, 148
P
Parametrical methods and algorithms
 
cancellation of spurious reﬂ ections, 
223–32
 
conclusions, 255
 
frequency measurement, 244–50
 
introduction to, 221
 
maximal likelihood method (MLM), 
274–75
 
parametric spectral analysis (PSA), 
272–74

328 
Index
“Prediction” algorithm, 275–77
 
range prediction, 250–55
 
reduction of spurious reﬂ ector inﬂ uence, 
232–43
 
testing of tracking distance meter, 275
 
testing results, 272–77
Parametric spectral analysis (PSA)
 
algorithms based on methods of, 272–74
 
deﬁ ned, 244
 
frequency measurement using, 244–50
Parasitic amplitude modulation (PAM)
 
decreasing inﬂ uence of, 120–212
 
deﬁ ned, xx
 
DFS phase estimation error and, 135
 
elimination with WF, 121
 
frequency-dependent reﬂ ections and, 168
 
inﬂ uence analysis, 119
 
inﬂ uence on DFS frequency estimation, 
119–21
 
inﬂ uence on total error of range 
estimation, 120
 
presence, 119
 
range measurement and, 247
Periodicity, 43–44
Phase characteristic (PC), 24, 123, 124
Phase characteristic (PC) estimation
 
ambiguity in, 123
 
at DFS reception, 124
 
displacement, 133
 
error inﬂ uence, 239
 
of FMCW RF, 121–30
 
maximum likelihood, 121
 
plots, 125
 
practical determination, 122
 
procedure, 132
 
reduction of noise inﬂ uence on accuracy 
of, 134–35
 
truncation error, 126, 129
 
variance, 126, 132
Phase-frequency characteristic (PFC)
 
approximation error, 275
 
calculations for DFS, 274
 
deﬁ ned, 24
 
estimation, 274
Phase multiplexer, 89
Pisarenko harmonic expansion (PHE), 244
Power spectral density (PSD)
 
deﬁ ned, 68
 
noise, 93
 
spline interpolation of, 70
Precision measurements
 
procedure for carrying out, 266
 
synthesis of radar reﬂ ectors for, 259–64
 
test bench, 264–65
Precision measuring system testing
 
conclusions, 286
 
distance measurement results, 272–77
 
equipment and approaches, 257–66
 
experimental reduction of distance 
measurement error, 269–72
 
experimental reduction of error, 266–69
 
introduction to, 257
 
practical application areas, 277–85
 
results of “Prediction” algorithm, 275–77
 
tracking distance meter, 275
“Prediction” algorithm
 
operation, 277
 
testing results of, 275–77
Prony method
 
deﬁ ned, 223
 
frequency measurement algorithm by, 
247–50
 
instantaneous error of range measure 
ment plots, 249
 
interest in, 247
 
MSD function of range measurement, 
250
PAM deepness at application of, 250
PSA-based algorithms and, 273
 
spectrum, 248
Pulling period, 13–14
Pulse interference, 179
Q
Quadratic coefﬁ cient, 143
Quadratic modulation characteristic
 
derivative, 142
 
with oscillating component, 147
 
parameters, 142
Quadratic nonlinearity
 
increase of degree, 148
 
of modulation characteristics, 151
 
nodal points and, 148

Index 
329
 
normalized average error, 148
 
oscillating nonlinearity and, 152–53
 
worst case of, 160
Quantization interval (QI), xx
R
Radar reﬂ ectors (RRs)
 
conﬁ guration illustration, 262
 
creation of, 259
 
deﬁ ned, 257
 
designing, 261
 
diameter, 258
 
distance measurement error to, 263
 
double-lobe, 263
 
electrical distance determination, 265
 
geometry determination, 259
 
nonsymmetric, 261
 
with odd number of sectors, 260
 
optimal, 260, 263, 264
 
restricted size, 262
 
shape deﬁ nition, 261
 
standard, 258
 
synthesis for precision measurements, 
259–64
Radio altimeters, 278–79
Radio proximity fuses, 279
Range determination error
 
algorithm of correction of range 
calculation, 24–25
 
from inaccuracy of modulation 
adaptation, 23–25
 
noise inﬂ uence, 25–31
 
relative MSD logarithm, 30
 
 
See also Range measurement
Range estimation
 
algorithm application, 255
 
algorithm at SR presence, 255
 
based on difference frequency signal,  
108–13
 
introduction to, 107
 
MLM for, 107–36
 
normalized error of, 181
 
PAM inﬂ uence on total error, 120
 
two-stage procedure, 135
Range estimation simulation
 
algorithm, 130–35
 
results at known phase characteristic, 131
 
results at unknown phase characteristic, 
131
Range-ﬁ nder
 
block diagram, 2
 
FMCW, 7–8
 
frequency-modulated, 2
 
for geodesic research, 283
 
under interference conditions, 197
 
measurement error by, 183, 184
Range measurement
 
analytical estimation of truncation error 
at, 71–74
 
frequency modulation (FM) in, 1
 
measurement performance and, 51
 
MSD, 150
 
noise interference inﬂ uence on error, 
92–103
 
parasitic amplitude modulation (PAM) 
and, 247
 
at presence of SRs of small intensity, 
242–43
 
range determination error, 23–31
 
on SR background, 198
 
total error functions of, 134
 
traditional counting method, 5–7
 
truncation error, 13–23
Range measurement error
 
analysis of, 167–95
 
caused by single spurious signal, 170–74
 
error envelope (EE), 171, 172
 
estimation at signal processing of time 
domain, 172–74
 
functions, 118
 
inﬂ uence of combination components in  
mixer, 192–94
 
inﬂ uence of edge modes, 184–86
 
inﬂ uence of reﬂ ected waves, 187–91
 
inﬂ uence of spurious reﬂ ectors, 174–81
 
inﬂ uence of virtual clutter, 193–94
 
instantaneous, 231, 246
 
introduction to, 167–70
 
minimization for weakly reﬂ ecting 
liquids, 204–6
 
plane reﬂ ector, 190
 
point reﬂ ector, 190
 
at presence of SR of small intensity, 243

330 
Index
Range measurement error (continued)
 
by range-ﬁ nder, 183, 184
 
reﬂ ector in DS, 190
 
by signal reﬂ ection from reservoir vertical 
wall, 181–84
 
sources, 7–8
 
wave reﬂ ected from useful reﬂ ector, 
188–90
Range prediction (movement speed)
 
nonuniform velocity, 253–55
 
overview of, 250
 
uniform velocity, 250–53
Rayleigh’s reﬂ ection, 283
Reﬂ ected waves
 
inﬂ uence on measurement error, 187–91
 
from useful reﬂ ector on range 
measurement error, 188–90
Reﬂ ector movement
 
nonuniform velocity, 253–55
 
uniform velocity, 250–53
Reﬂ ector sizes, 185
Robotic navigation and mapping systems, 
285
S
Scalar Kirchhoff approximation, 184
Self-oscillating mixer (SOM), xix
Sidelobe level (SLL)
 
AWF SD variation, 296
 
maximum of WF, 210
 
minimization, 299–306
SAD, 199
WF SD, 84
Sidelobes (SL)
 
of AWF SD, 297
 
reduction of, 67–68
SAD, 75
SD, 202, 296
Signal/interference ratio (SIR), 170, 175, 
193, 238
Signal/noise ratio (SNR), 8–9, 98
Sliding half-strobes, 101–2
Slope coefﬁ cient, 150
Slow FM, 77–78
Slow-frequency modulation, 50–53
Slow oscillation, 148
Small displacement meters, 284
Smooth weighting, 35
Spectral amplitude density (SAD)
 
adaptable weighting functions (AWFs), 
200–201
 
analytical equations, 177
 
DC WF processing, 82
 
deﬁ ned, 69
 
frequency estimation of parameters, 205
 
interference, 180, 206
 
KB WF processing, 82
 
minimal SLL, 199
 
modulus, 178
 
modulus maximum, 72
 
pulse interference, 179
 
pulse interference SL periodicity, 180
 
of radio pulse signal, 178
SC, 70
 
shape variation, 74
SLs, 75
 
spline interpolation of, 70
 
of useful signal, 205
 
WF shape, 212
Spectral components (SCs)
 
of DFS, 99
 
with different frequencies, 167
 
distribution laws of, 68
 
edge modes, 167
 
processed, 71
SAD, 70
 
selection of EV spectrum, 245
 
as SRs, 202
Spectral density (SD)
 
AWF, 295, 296
 
of DFS, 74, 92–103
 
position of, xxi
 
shape distortion, 88
 
sidelobes, 202
SL, 296
Spectral power density (SPD)
 
DFS, 228
 
estimation, 94
 
for SR cancellation, 228, 230
Spurious reﬂ ector reduction
 
introduction to, 232
 
phase characteristic (PC) estimation error, 
239

Index 
331
 
range measurement, 242–43
 
tracking loss conditions, 240–42
 
tracking modes, 237–39
 
tracking procedure after local extreme, 
236–37
 
tracking range measuring system, 232–36
 
 
See also Parametrical methods and 
algorithms
Spurious reﬂ ectors (SRs)
 
in accuracy of range measurement, 167
 
in antenna-waveguide path, 174–81
 
cancellation of, 223–32
 
CSD for cancellation, 226–28
 
decreasing spectrum, 198
 
deﬁ ned, xviii, 167
 
detection characteristics, 203
 
detection in FMCW RF operating zone,  
201
 
detection in learning mode, 199
 
determined SCs as, 202
 
DFS generated by, 198–99
 
envelope plots, 176
 
error caused by inﬂ uence of, 174–81
 
frequency-independent, 174
 
inﬂ uence on pulse character, 177–81
 
in operating zone, 174–81
 
parameters, 191
 
range measurement on background, 198
 
in reducing accuracy of distance 
measurements, 289
 
resolution zone, 221
 
of small intensity, 242–43
SPD for cancellation, 228–32
 
tracking loss and, 241
 
UR and, 194–95
 
virtual reﬂ ectors, 192
 
waves reﬂ ected from, 190–91
Stationary random process (SRP), 94
Systematic inaccuracy
 
of frequency estimation, 91–92
 
range versus, 113
T
Test bench
 
block diagram, 267
 
CONTACT-1, 264
 
illustrated, 264
 
for measurement of FM RF parameters, 
264–65
 
waveguide-measuring, 266–67
Time delay
 
estimation with MLM, 113–16
 
measurement error in, 116–21
Total error MSD, 61, 63
Tracking
 
after local extreme, 236–37
 
after useful extreme, 237
 
algorithm, 232–42, 255
 
algorithm application, 242
 
distance meter testing, 275
 
extreme displacement function and, 234, 
235
 
loss conditions, 240–42
 
main stages of procedure, 236–37
 
meter, testing results, 276
 
modes, 237–39
 
phase characteristic (PC) estimation error  
and, 239
 
range measurement system, 232–36
 
time delay estimation accuracy, 233
Transmitting-receiving module (TRM), 
187–88
Transport radar, 280–81
Truncation error
 
of average weighted estimation, 88–91
 
behavior, of initial phase estimations, 127
 
comparison, 20
 
corrected, relative variance, 21–22
 
correction stages, 20
 
deﬁ ned, 8
 
degree of reduction, 64
 
extreme averaged normalized, 52
 
ﬁ rst approach, 22
 
ﬁ xed measuring of time interval, 13–16
 
of FMCW RF PC determination, 129
 
functions of components, 90
 
of initial phase estimation, 127, 128
 
instantaneous, 103
 
mathematical expectation, 19, 22
 
minimization at weighting average 
method, 45–50
 
minimization by FM parameter 
optimization, 50–56

332 
Index
Truncation error (continued)
 
minimization with adaptable weighting 
functions, 86
 
noise inﬂ uence on, 56–64
 
PC determination, 129
 
PC estimation, 129
 
range measurement, 13–23
 
range result correction, 20–23
 
reducing, 15–16
 
relative measurement, 15
 
relative variance, 18
 
second approach, 23
 
stable component of measurement, 19
 
time interval multiple to modulation half-
period, 16–20
 
value beneﬁ t, 51
 
variance versus relative range, 18
 
of weighting method, 36–45
U
Uniform velocity
 
average estimation, 251
 
estimation, 253
 
formula, 250–51
 
instantaneous range measurement error, 
252
 
in range prediction, 250–53
 
simulation results, 252
Useful reﬂ ectors (URs)
 
deﬁ ned, xviii
 
exit from IEZ, 247
 
nonuniform velocity of, 253–54
 
resolution zone, 221
 
SR and, 194–95
 
waves reﬂ ected from, 188–90
 
waves reﬂ ected from, simultaneous 
inﬂ uence, 190–91
V
Virtual clutter
 
deﬁ ned, 193
 
inﬂ uence on range estimation error, 
193–94
Virtual interference
 
distance estimation error caused by, 269
 
experimental reduction of error caused 
by, 266–69
 
reducing inﬂ uence on, 267–69
Virtual reﬂ ectors
 
action sequence for inﬂ uence reduction,  
218–20
 
error decrease caused by, 217–21
 
measures, 220–21
 
MSD of measurement error and, 219–20
 
near useful reﬂ ector, 193
 
neutralization of, 217
 
ratio of signal amplitudes from, 219
 
surrounding SR, 192
Voltage-controlled oscillator (VCO), 137
W
Waveguide-measuring test bench, 266–67
Weak signal error minimization
 
action sequence, 206
 
interference properties and, 204
 
introduction to, 204–10
 
liquids, 204–6
 
material near antenna, 206–10
 
reservoir bottom, 210
 
 
See also Measurement error reduction
Weighting functions (WFs)
 
adaptable (AWFs), 86–88, 197–222, 
291–99
 
best, 300
 
Blackman, 102, 128, 129, 181, 243, 270
 
of Blackman-Harris, 48
 
change of shape, 42
 
deﬁ ned, 33
 
determination error of, 35
 
with different values, 44
 
discretized, 292
 
Dolph-Chebyshev (DC), 74–77
 
families, xxi
 
for harmonic analysis and adjacent 
problems, 291–312
 
Harris, 299
 
illustrated, 39
 
Kaiser-Bessel, 42, 43, 62–64, 74–77, 298
 
maximum SLL of, 210
 
measurement error in form of trigono 
metric series, 58–62
 
optimal, 46–47, 300

Index 
333
 
optimal coefﬁ cients, 46
 
optimization, 46
 
in PAM elimination, 121
 
range increasing and, 47
 
relative measurement error, 40
 
representation, 39
 
SAD shape, 212
 
shape control algorithm, 221
 
shape parameter, 49
 
shape versus noise inﬂ uence, 62
 
SLL SD, 84
 
small ranges, 46
 
spectral properties comparison, 300
 
at spectrum calculation, 68
 
use of, 291
Weighting method
 
application of, 33
 
conclusions, 64
 
dependence of DFS zero number, 38
 
for difference frequency averaging, 33–64
 
effects of FM nonlinearity for, 147–50
 
envelope nodes (ENs), 40–41
 
illustrated, 35
 
noise inﬂ uence on error, 56–64
 
truncation error, 36–45
 
truncation error minimization, 45–50
 
truncation error minimization by 
optimization, 50–56
WF parameter optimization
 
error minimization and, 80–85
 
simpliﬁ ed method of, 84
Z
Zero padding, 69
Zones of inversion, 3


