
Envelope Tracking Power Amplifiers 
for Wireless Communications

For a listing of recent titles in the  
Artech House Microwave Library, 
turn to the back of this book.

Envelope Tracking Power Amplifiers 
for Wireless Communications
Zhancang Wang

Library of Congress Cataloging-in-Publication Data
A catalog record for this book is available from the U.S. Library of Congress.
British Library Cataloguing in Publication Data
A catalog record for this book is available from the British Library.
ISBN-13: 978-1-60807-784-7
Cover design by Igor Valdman
© 2014 Artech House
All rights reserved. Printed and bound in the United States of America. No part 
of this book may be reproduced or utilized in any form or by any means, elec-
tronic or mechanical, including photocopying, recording, or by any information 
storage and retrieval system, without permission in writing from the publisher.
All terms mentioned in this book that are known to be trademarks or service 
marks have been appropriately capitalized. Artech House cannot attest to the 
accuracy of this information. Use of a term in this book should not be regarded 
as affecting the validity of any trademark or service mark.
10 9 8 7 6 5 4 3 2 1

v
Contents
Preface 
xi
Acknowledgments 
xv
 CHAPTER 1 
High-Efficiency Power Amplifier Architectures and Devices 
1
1.1  Efficiency Definitions for RF PA	
2
1.2  Characteristics of Modern Modulated Signals	
3
1.2.1  Crest Factor	
4
1.2.2  Probability Density Function	
4
1.2.3  Second Generation Signal 	
5
1.2.4  Third Generation Signal 	
6
1.2.5  Fourth Generation Signal 	
7
1.3  Architectures for High-Efficiency PA	
7
1.3.1  Switch Mode PA	
9
1.3.2  Waveform-Engineered PA	
22
1.3.3  Doherty	
26
1.3.4  LINC and Outphasing	
32
1.3.5  Envelope Elimination and Restoration	
34
1.3.6  Envelope Tracking	
35
1.4  Device Technologies for High-Efficiency PA	
37
1.4.1  GaAs HBT	
38
1.4.2  CMOS 	
39
1.4.3  Si-LDMOS	
42
1.4.4  GaN HEMT	
43
References	
46
 CHAPTER 2 
Envelope Tracking Power Amplifier Basics 
51
2.1  Introduction	
51
2.1.1  Motivation for ET	
51
2.1.2  ET Pyramid	
53
2.2  Principle of ET	
54
2.2.1   Signal Definition	
55

vi 
Contents
2.2.2  ET Efficiency	
56
2.2.3  Design Considerations	
56
2.3  Instantaneous Efficiency of PA	
57
2.3.1  Class-B Deduction	
58
2.3.2  ET Deduction	
61
2.3.3  Efficiency Degradation Factor	
63
2.4  Statistical Average Efficiency of ET	
65
2.4.1  Statistical Average Efficiency Definition	
66
2.4.2  Efficiency and Gain Trajectory for ET	
67
2.5  Bandwidth of ET	
72
2.5.1  Bandwidth of Envelope	
72
2.5.2  Video Bandwidth of ET	
74
2.6  Linearity of ET	
75
2.6.1  Two-Tone IMD	
76
2.6.2  Modulated Signal Linearity 	
76
2.7  Power Capacity for ET Scenarios	
81
2.7.1  ET for BTS	
82
2.7.2  ET for Mobile	
83
2.7.3  VSWR Immunity in ET	
84
2.8  Frequency Agility	
85
2.8.1  MMMB PA with ET	
85
2.8.2  ET PA Integration	
87
References	
87
 CHAPTER 3  
Envelope Generation and Alignment 
91
3.1  Envelope Generation	
92
3.1.1  Analog Generation	
92
3.1.2  Digital Generation	
95
3.1.3  MIPI eTrak Interface	
98
3.2  Envelope Detector Specifications	
100
3.2.1  Dynamic Range	
101
3.2.2  Modulation Bandwidth	
101
3.2.3  Slew Rate	
103
3.2.4  Conversion Gain	
105
3.2.5  Gain Ripple	
106
3.2.6  Temperature Variance	
106
3.2.7  Transfer Function	
107
3.2.8  Total Harmonic Distortion	
109
3.2.9  Response Delay	
110
3.3  Timing Alignment 	
111
3.3.1  Analog Alignment	
112
3.4  Offset Adjustment	
113
3.4.1  Principle of Operation	
113
3.4.2  Adaptive Adjustment	
114
References	
115

Contents 
vii
 CHAPTER 4  
Supply Modulator for Envelope Tracking 
117
4.1  Introduction	
117
4.1.1  Supply Modulator Requirements	
119
4.1.2  Mathematical Model for Efficiency	
121
4.2  Linear Supply Modulator	
123
4.2.1  Linear Voltage Regulator	
124
4.2.2  Class-AB/B	
125
4.2.3  Class-G/H	
130
4.2.4  Power DAC	
137
4.3  Discrete Supply Modulator	
140
4.3.1  Isolated SMPS	
141
4.3.2  Nonisolated SMPS	
141
4.3.3  Summary of SMPS for ET	
147
4.3.4  Multilevel Supply Modulator	
149
4.3.5  Multiphase Supply Modulator	
153
4.3.6  Output Filter for Discrete Modulator	
156
4.4  Hybrid Supply Modulator	
158
4.4.1  Serial Hybrid	
158
4.4.2  Parallel Hybrid	
161
4.4.3  AET Hybrid	
169
4.4.4  CCG Hybrid	
171
4.4.5  Power DAC Hybrid	
174
4.4.6  Parallel Hybrid with Multiswitcher	
175
4.4.7  Combined Hybrid	
179
4.4.8  Nested and Multinested	
181
References	
185
 CHAPTER 5 
Power Amplifier for Envelope Tracking 
191
5.1  RF PA Design Methodology	
192
5.1.1  Measurement Method	
192
5.1.2  Analytical Method	
193
5.1.3  EDA and Modeling Method	
193
5.2  Matching Network Design	
195
5.2.1  Introduction	
195
5.2.2  Matching Theory	
196
5.2.3  Multisection and Taper Matching	
201
5.2.4  Nonsynchronous Impedance Transformer	
205
5.3  Bias Network Design	
207
5.3.1  Classical Bias Network	
207
5.3.2  ET Feeding Line Bias Network	
209
5.4  Waveform-Engineered Matching	
210
5.4.1  Engineered Waveforms	
211
5.4.2  Harmonic Load-Pull	
212

viii 
Contents
5.4.3  Physical Implementation	
213
5.5  Class-P PA Design for ET 	
214
5.5.1  Waveform Engineered Class-P	
215
5.5.2  Physical Implementation	
217
5.5.3  Design for ET	
222
5.6  Driver Design for ET Lineup	
223
5.6.1  PAE Lineup	
224
5.6.2  Lineup Implementation	
225
References	
226
 CHAPTER 6  
Digital Front End Design for Envelope Tracking 
229
6.1  Digital Front End	
229
6.2  Crest Factor Reduction	
230
6.2.1  Threshold and Metrics	
234
6.2.2  Peak-Windowing CFR	
235
6.2.3  Noise-Shaping CFR	
237
6.2.4  Peak-Cancellation CFR	
239
6.2.5  Constrained Clipping CFR	
240
6.3  Envelope Shaping Function	
243
6.3.1  Introduction	
243
6.3.2  De-Trough for Efficiency	
244
6.3.3  De-Trough for Linearity	
248
6.3.4  Sweet-Spot Tracking	
250
6.3.5  Advanced Envelope Shaping	
251
6.3.6  Bandwidth Reduction Shaping	
252
6.3.7  Slew Rate Reduction Shaping	
254
6.4  Timing Alignment	
257
6.4.1  Timing Mismatch	
258
6.4.2  Timing Alignment	
258
6.5  Digital Predistortion	
261
6.5.1  Introduction	
262
6.5.2  DPD Forward Path	
264
6.5.3  Complex LUT DPD	
264
6.5.4  Memory Polynomial DPD	
267
6.5.5  Combined DPD	
268
6.5.6  DPD Feedback Path	
270
6.5.7  Indirect Learning DPD	
271
6.5.8  Direct Learning DPD	
273
6.6  Image and Carrier Suppression	
273
6.6.1  Quadrature Modulation Errors	
274
6.6.2  Quadrature Modulation Correction	
274
6.6.3  Adaptive QMC	
277
References	
278

Contents 
ix
 CHAPTER 7  
Experimental Methodologies and Measurements for Envelope Tracking 
283
7.1  Motivation and Introduction	
283
7.1.1  ET Test Considerations	
284
7.1.2  Modulated Signal Measurement	
284
7.1.3  Measurement Process	
286
7.2  Envelope Measurement	
292
7.2.1  Sinusoidal Signal Measurement	
293
7.2.2  Multitone Signal Measurement	
294
7.2.3  True Envelope Measurement	
295
7.3  Supply Modulator Measurements	
297
7.3.1  Measurement Setup	
297
7.3.2  Error Measurements	
300
7.3.3  Design Considerations for Measurement	
302
7.4  RF PA Measurements	
303
7.4.1  Nonlinear Vector Network Analysis	
305
7.4.2  Swept Load-Pull 	
306
7.4.3  Measurement for Memory Effects	
309
7.4.4  Measurements for ET Trajectory	
310
7.5  ET PA Measurements	
316
7.5.1  Test Bed Synchronization	
316
7.5.2  CW Versus Complex Stimulus Measurements	
317
7.5.3  Complex Measurements Setup	
319
7.5.4  Complex Characterization Techniques	
322
7.5.5  Power Measurements 	
323
7.5.6  Efficiency Measurements	
324
References	
327
About the Author 
331
Index 
333


xi
Preface
For the purpose of improving the energy efficiency of radio frequency (RF) power 
amplifiers (PA) for high peak-to-average-power-ratio (PAPR) signals, the use of 
traditional fixed direct current (DC) drain/collector supply is often inadequate. 
Therefore, supply modulation is promising for the enhancement and determination 
of the efficiency performance of PA in modern emerging wireless communications. 
The envelope tracking (ET) approach is one recommended power supply technique 
that maximizes the energy efficiency of the PA by keeping it in compression over 
the whole modulation cycle, instead of just at the peaks, by dynamically adjusting 
the supply voltage to the RF PA. 
The ET technique was ﬁrst developed in the 1930s to handle the excessive 
energy consumption of high-power amplitude modulation (AM) broadcast radio 
transmitters. Since constant amplitude frequency modulation (FM) techniques dis-
placed AM in the 1950s, ET became marginalized and irrelevant to engineering, 
where it languished as an academic curiosity. However, the increasing PAPR of 
modern signals with advanced digital modulation schemes such as 4G reinvigorate 
ET technique to achieve considerable energy saving in high-PAPR digital transmit-
ters. More commercial ET PAs have been developed for modern 4G wireless com-
munications and beyond. 
This book describes the principles of ET operation, signal generation and shap-
ing, design and implementation approaches, and application of ET techniques in 
the context of RF PAs. It explores the topic from the basic principles of ET tech-
niques through their application scenarios, including mobile terminal/user equip-
ment (UE) and infrastructure base station (BTS), envelope generations and supply 
modulator design with applications to RF PA, digital front end (DFE) algorithms 
for ET performance enhancement, and related measurement methodologies. In ad-
dition, the book also covers switch mode and waveform-engineered RF PA, their 
design techniques, and applications for the ET purpose.
This book can be used by graduate students, researchers, and design engineers 
in microwave and RF design areas. It is assumed that the readers have already ac-
quired a basic knowledge of RF and microwave circuit design. A solid background 
in RF PA design theory and basic wireless communication concepts is required. 
This book may also be used as a textbook for a graduate course on highly efficient 
RF power amplifier design and measurement.

xii 
�������
Preface
Chapter 1 is a comprehensive reminder of the latest concepts related to high-
efficiency PA in wireless communications, signal character introduction from 2G 
to 4G, state-of-the-art RF PA operation classes, advanced high-efficiency PA archi-
tectures, and introduction to semiconductor power device technologies along with 
their important features.
Chapter 2 is dedicated to introduction of ET basics under the framework of ET 
pyramid criteria. It explains the operation principle of ET techniques by deduction 
of a traditional class-B PA. It elaborates on the two most common efficiency con-
cepts, namely, instantaneous efficiency and statistical average efficiency, employed 
to indicate the efficiency without and with consideration of signal probability den-
sity function (PDF). Bandwidth and linearity metrics applied in ET technique are 
then discussed in detail. Chapter 2 also provides extensive ET details with various 
power levels along with their respective advantages and limitations. Subsequent-
ly, unique frequency agility of ET techniques used for multimode and multiband 
(MMMB) and integration are discussed.
Chapter 3 provides extensive details on envelope generation techniques and 
specifications. It starts with both digital and analog envelope generation techniques 
and their interface specifications to supply modulator such as MIPI eTrak. Ad-
equate details have been included for the specifications of RF envelope detector. It 
then covers timing and offset alignment methods to develop ET system, for enhanc-
ing the in-band modulation quality and out-of-band emissions for the ET system. 
Chapter 4 presents the requirements, theory, techniques, and principles behind 
using supply modulators in ET system. The issues related to the implementation 
of these techniques are discussed. It starts develop supply modulator content nar-
ratively by classification of topologies, from simple to complex, with linear and dis-
crete types as the basic elements. Linear modulator using linear voltage regulator, 
class-AB/B PA in both push-pull and totem-pole, class-G/H PA, and current steer-
ing power digital-to-analog converter (DAC) are explained and discussed. Howev-
er, the discrete modulator family starts from isolated and nonisolated switch mode 
power supply (SMPS) with the latter emphasized on topologies and output filter 
design. Multilevel and multiphase supply modulators with reduced output ripples 
for ET purpose are also presented and discussed. The last section is the kernel of 
this chapter and is dedicated to hybrid supply modulator for broadband and high 
efficiency ET applications.
Chapter 5 correspondingly continues and deals with the issues involved in the 
RF PA design for ET. There are multiple aspects that have been addressed to design 
an RF PA such as design methodology, matching network, and bias network de-
sign. All these have been discussed in detail in this chapter. Waveform engineering 
technique adopted in PA design for high efficiency has been elaborated and ex-
plained in detail. Finally, an exemplary class-P PA design catering to high-efficiency 
and high-power ET applications is presented.
Chapter 6 presents the theory of digital front-end (DFE) algorithms for ET 
enhancements including crest factor reduction (CFR), various envelope shaping 
functions, and timing alignment techniques. Thereafter, digital predistortion (DPD) 
techniques and quadrature modulation image and carrier suppressions are catego-
rized and explained in detail.

Preface 
xiii
Chapter 7 is dedicated to experimental methodologies and measurement ap-
proaches adopted in developing ET PA systems. It divides the contents by function-
ality, starting from envelope, supply modulator, and RF PA measurements. Subse-
quently, the measurement of the ET PA system is presented by utilizing complex 
stimulus measurement methods.


xv
Acknowledgments
I gratefully acknowledge the help and support received from mentors, friends, col-
leagues, and support staff, both past and present at Beijing University of Technol-
ogy, Agilent Open Lab Beijing, Microwave Journal, Beijing Embedded System Key 
Lab, and Amplifier Frontier Research Group. I am grateful to my great friends and 
family members; this book could not have been completed without their encourage-
ment and support.
In particular, I thank Samantha Ronan for her administrative support and the 
Artech House reviewers. In addition, I thank David Vye and Patrick Hindle for 
their inspirations and recommendations. I also thank Mike Krell and Juha Pen-
nanen on behalf of MIPI Alliance for their permission to use the MIPI eTrak speci-
fication in this book. I thank the IEEE for the courtesy to reproduce ﬁgures and 
illustration contents published in journals and conference papers. I acknowledge 
Agilent Open Lab Beijing for the experimental contribution to support related re-
search and Beijing University of Technology for access to the database of literature, 
which helped the completion of this work. 
Finally, I profoundly thank my spouse Chunxian and my lovely son Xiantian 
for their understanding and patience throughout the many evenings and weekends 
taken to prepare this book. I also thank my parents Zeling and Xiujie for their en-
couragement and valuable support in my professional years as a researcher.


1
C H A P T E R  1
High-Efficiency Power Amplifier 
Architectures and Devices
The function of a power amplifier (PA) is to convert direct current (DC) power 
to radio frequency (RF) power by amplifying a given input RF signal. Hence, RF 
PAs are employed to boost the power of an RF signal with a relatively low power. 
Thereafter, the amplified RF signal can be utilized for a variety of applications in 
wireless communications, especially driving the antenna of a transmitter. PAs are 
included in both mobile user equipment (UE) and base stations (BTSs) to amplify 
an RF signal for long-distance, on-the-air (OTA) transmission. Furthermore, it is 
used to manage the amplification of an RF signal as a desired transmit power level, 
depending on how far away the user is from a BTS scenario. RF PAs are required to 
support Global System for Mobile Communications (GSM) of 2G networks, Wide-
band Code Division Multiple Access (WCDMA) of 3G systems, and Long Term 
Evolution Advanced (LTE-A) of 4G, either independently or together in multimode 
and multiband (MMMB) application scenarios.
The power consumption of an RF PA and therefore efficiency is an important 
figure of merit to indicate system heat output in modern wireless communications 
because it compares total input power with total output power. The efficiency of 
an RF PA is generally defined as the ratio between desired transmitted radio power 
and total power from a supply. Unfortunately, a traditional fixed supply RF PA 
exhibits very low efficiency with high-PAPR signals to achieve higher data through-
put within limited spectrum resources. Consequently, extensive efforts have been 
made within the wireless industry for the means of enhancing efficiency. A little 
improvement in RF PA efficiency can make substantial profit available in a wireless 
system and cut the overall costs needed to operate the system. Therefore, pursuing 
high efficiency for RF PAs is driven by the strong energy-saving demand for the 
long-term evolution of wireless communication systems. 
For example, in wireless infrastructure industry, there is an increasingly ag-
gressive motivation to reduce operating expenditure (OPEX) in 4G required by 
operators. Around 10% to 30% of network OPEX is utilized on energy. Solutions 
for improved energy efficiency are strongly desired in the wideband LTE-A applica-
tions. Further, the RF PA usually takes the lion’s share, as a signal component, of 
power dissipation in a BTS.
As well, in portable mobile business, with higher-PAPR signals, manufacturers 
are concerned with the efficiency of RF PAs for new standards because design of 

2 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
a superior battery is a constant battle in the long term. Therefore, the proposed 
remedy is to save more energy from UE operation. With the higher power added 
efficiency (PAE) for RF PAs, it means that longer standby and talk time can eventu-
ally be provided to the subscribers.
��1.1  Efficiency Definitions for RF PA
With regard to the definition of efficiency, there are two definitions: drain/collec-
tor efficiency η and PAE. η is defined as the ratio of RF output power Pout to input 
direct current (DC) power PDC, as
	
η =
× 100%
out
DC
P
P
	
(1.1)
As shown in (1.1), the drain efficiency η is a measure of how much DC power 
is converted to RF power. The disadvantage with this metric is that it does not con-
sider the incident RF power that injects into an RF PA. In the case of a single-stage 
RF PA, the RF input power can be substantial because the gain is low. Therefore, 
drain/collector efficiency η is not a comprehensive metric of efficiency for RF PA. 
However, η is more useful when characterizing an RF PA for envelope tracking 
purposes due to the straightforward definition of efficiency between the PA and 
the supply modulator interface, which will be discussed in the following chapters.
Therefore, PAE is preferred for a more comprehensive understanding of overall 
efficiency. Although it is a measure of efficiency as well, it differs from ordinary 
drain/collector efficiency in that it takes all of the power input into consideration. 
With the same power budget, the PA with higher PAE ultimately indicates longer 
operation time, especially for mobile UE scenarios. However, in the PAE calcula-
tion, there is a PAE equation error difference while considering the various input 
power positions in the either numerator or denominator. From the literature [1], 
the conclusion that put input power term into numerator of the PAE equation is 
most meaningful to RF PA design, by avoiding greatly inflated PAE values under 
certain conditions. Therefore, the PAE concept used in this book is defined as:
	
η
−


=
×
=
×
−
×




1
100%
1
100%
out
in
DC
P
P
PAE
P
G
	
(1.2)
From (1.2), it can be interpreted as the efficiency to convert the DC supply 
power into the RF output power that is remained over after the direct contribution 
from the input RF power has been removed. It can also be rearranged in terms of 
drain/collector efficiency and RF power gain, and directly understood in a three-
dimensional (3-D) plot with independent variables as drain efficiency and power 
gain in a linear scale, as shown in Figure 1.1.

1.2  Characteristics of Modern Modulated Signals 
3
1.2  Characteristics of Modern Modulated Signals
With the growth of 4G data services, progressively more complex signal modulation 
schemes have been introduced to fulfill ever-increasing data and video capabilities. 
The general expectations of subscribers are focused on high transmission rates and 
flexibility of wireless communications. However, high-level system requirements 
are mainly determined by physical level limits. The RF PA of each wireless system 
indirectly defines available transmission limits. The evolution of wireless communi-
cation standards has resulted in increased bandwidth and PAPR, directly impacting 
RF PA designs.
In recent years, with surge in a data volume in wireless communication, emerg-
ing standards with a high data rate have come into use, such as WCDMA, high 
speed packet access (HSPA), and LTE-A. In these modulated signals, signal enve-
lopes are not constant. With time-varying envelopes, signals typically suffer from 
a manifest efficiency difference between average and peak power. It introduces the 
notion of peak-to-average power ratio (PAPR), which compares the peak modu-
lated output power to its long-term time average. It is ever-increasing with wire-
less standards evolution to make improved spectrum efficiency available by more 
complex modulation schemes. However, with high-PAPR signals, a fairly minor 
proportion of the DC power consumed by RF PAs is converted to radiate energy 
because efficiency of PA naturally peaks at the saturated output power and drops 
radically as input power is reduced or backed off. Furthermore, severe distortions 
would occur if excessive power levels of high-PAPR signals were pushed into PA. It 
imposes substantial operational constraints on the RF PAs on both efficiency and 
output power handling capability. Moreover, in multicarrier transmitters, such as 
WCDMA, HSPA, and LTE-A, the PAPR of the signal can be greater than those in 
single-carrier systems. Because PAPR has grown into a critical concern for modern 
RF PA design [2], understanding the characteristics of those modulated signals be-
comes a must before even beginning the PA design work.
Figure 1.1  Theoretical PAE as a function of power gain and drain/collector efficiency, which can be 
described as a slope with varying drain efficiency at fixed power gain and a cascade with low power 
gain at fixed drain/collector efficiency, respectively.

4 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
An RF PA used to amplify the modulated signal demands to maintain a high 
linearity characteristic with the aim that the output distortion assures compliance 
to a certain desired specification even at the peak power moment. Consequently, 
the PA catering to high linearity is degraded in efficiency apart from the maximum 
power moment. For example, during a time-averaging power time, the PA effi-
ciency is rather lower than in compression. Therefore, there is a challenging trade-
off between the efficiency and the linearity for high-PAPR scenarios. In fact, most 
spectrally efficient modulation types, such as QAM and OFDM, exhibit similar 
high-PAPR characteristics. The conclusions can thus be generalized to other modu-
lation schemes sharing certain important features. The salient characteristics of any 
modulated signal that contributes to efficiency degradation can be defined via the 
metrics described in the following sections.
1.2.1  Crest Factor
When measuring complexly modulated power, the shape of the signal must be un-
derstood. For signal profiles that have high PAPR, the term crest factor is denoted 
as
	
ξ =
peak
RMS
A
P
	
(1.3)
where Apeak and PRMS denote the peak amplitude of voltage and root mean squared 
(RMS) power of modulated signal, respectively. As a general rule, the energy con-
tent of higher-order harmonics grows along with the increases of the crest factor. 
Although the spectrum efficient modulation leads to a high crest factor, it causes 
interference with adjacent channels and in-band distortion, accounting for the rise 
of bit error rate as well.
Typically, PAPR is the main indicator of crest factor in logarithmic format for 
wireless communication as:
	
ξ
ξ
=
⋅
=
⋅
2
10
10
10 log (
)
20 log ( )
PAPR
	
(1.4)
Because calculating the absolute maximum value of a data signal is quite dif-
ficult, PAPR is easier determined by a statistical method. The measure of PAPR 
is performed through complementary cumulative distribution function (CCDF). 
It indicates the likelihood that the instantaneous modulated output power would 
be higher than a given value (e.g., the value at 0.01% CCDF), which is typically 
observed as the PAPR value of the modulated signals.
1.2.2  Probability Density Function
Probability density function (PDF) designates the likelihood of a specified instanta-
neous modulated output power level through a normalized histogram of the data 
based on the time domain. Technically the amplitude or power distribution of a 
quantized variable is presented in histogram versus the output amplitude or power 
bins. Because the digital modulation evolves with ever more complex schemes, the 

1.2  Characteristics of Modern Modulated Signals 
5
PAPR is ever larger, as shown in Figure 1.2, and the PDF moves toward a low-
power region in the histogram plot continuously. 
Efficiency drops quickly as output is backed off from the peak power so that 
the PA can operate in a more linear region to meet systematic linearity specifica-
tions. Amplitude-modulated signals such as 4G LTE-A have probability distribu-
tions weighted far away from maximum output power, hence resulting in ineffi-
cient operation at the time-average power level.
1.2.3  Second Generation Signal 
The second generation (2G) of wireless communication system is the Global System 
for Mobile Communications (GSM). As shown in Figure 1.2, the first commercial 
use of GSM systems took place in the 1990s. It adopted the Gaussian minimum 
shift keying (GMSK) modulation scheme and, hence, GSM’s physical layer was im-
plemented to work with feasible RF techniques at that time, which were vulnerable 
to signal variations. GMSK modulation employs continuous phase shifting that 
Figure 1.2  The technology development of RF PAs with the increased PAPR of a signal for wireless com-
munication standards evolution. Traditional RF PA does not increase the efficiency at the high average output 
power region for high PAPR signals with acceptable linearity. However, the advanced PA techniques according 
to the instantaneous output power levels have been developed for more efficient amplification.

6 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
leads to a virtually constant envelope. In other words, the constellation indicates a 
resistivity effect to nonlinear distortion whose trajectory never crosses the area rela-
tive close to zero corresponding to a zero value of PAPR. Therefore, the RF PA runs 
on constant envelope signal during one slot. It counteracts the impact of memory ef-
fects and major nonlinearities during the amplification process. Generally speaking, 
higher PAPR and wider bandwidth reduce available efficiency due to PA operating 
in inefficient back-off region. However, the 2G system is based on narrowband 
signals with constant envelope. As a result, total requirements are not critical as for 
later advanced systems that have to handle critical envelope variations.
The 2.5G wireless communication system emerged soon as the next step of evo-
lution of 2G, which was called Enhanced Data rates for Global Evolution (EDGE). 
It migrated from GMSK modulation to a more spectral effective 8-PSK modulation 
format. The amplitude modulation component of the 8-PSK modulation results in 
a more complex trajectory with an increasing PAPR up to around 3.2 dB, requiring 
higher linearity of RF PAs than GSM counterparts. This issue is particularly sig-
nificant during the multicarrier operation. In addition, linear operation on higher 
PAPR reduces the average output power of RF PAs, which causes lower PAE. The 
2.5G system performance ceilings had been touched and higher bit rates cannot 
be accomplished based on GSM criteria. Therefore, higher transmission rates and 
wider diversity of services required introduction of third generation (3G) wireless 
communication.
1.2.4  Third Generation Signal 
Although much effort was placed in the mid-1990s on 3G in the Universal Mo-
bile Telecommunications System (UMTS), the common commercial products only 
emerged around 2003. WCDMA of UMTS provides very efficient frequency uti-
lization of the spectra, and the code domain access method can provide another 
freedom from frequency. Therefore, the entire signal processing scheme is superior 
to its 2G/2.5G counterparts. It enables a wider spectrum for bit rates and available 
data services. In-phase (I) and quadrature-phase (Q) mapping had been employed 
with QPSK modulation. I-Q signals are spread to the required chip rate by the or-
thogonal channelization codes. QPSK signal trajectory presents significantly high 
PAPR, typically ranging from 3.5 to 9 dB, which contribute to PA nonlinearities and 
efficiency degradation. 
Further 3.5G evolution of UMTS had been concentrated on HSPA, which pro-
vided higher spectrum efficiency due to innovative modulation techniques such as 
16QAM for HSPA, 64QAM for HSPA+, and reduction radio frame lengths. The 
3.5G evolution can offer downlink speed rates up to 14 and 42 Mbps for HSDPA 
and HSDPA+, respectively. Driven by the demand for increased spectral efficiency, 
waveforms with varying amplitude and phase of HSPA have time-average power 
significantly lower than the peak envelope power. In other words, the PAPR of 
these waveforms can increase to more than 10 dB. Therefore, the instantaneous 
efficiency of the linear modes of RF PA operation degrades rapidly with reduced 
output power levels, resulting in overall low time-average efficiency.

1.3  Architectures for High-Efficiency PA 
7
1.2.5  Fourth Generation Signal 
The 3GPP Long Term Evolution (LTE) originated in 2004 and was focused on 
development of the Universal Terrestrial Radio Access (UTRA), known as 3.9G. 
The specification process kicked off in 2007 and was closed by the end of 2008. It 
guaranteed that the system was adequately stable for common commercial product 
implementation. The main goal of LTE is increasing transmission rates up to 100 
Mbps in the downlink and up to 50 Mbps in the uplink, four and three times that 
of the HSPA, respectively. Its evolution version is named as LTE-Advanced (LTE-
A), which is universally acknowledged as the 4G wireless communication system. 
Orthogonal frequency division multiplexing (OFDM) has been nominated for the 
downlink and supports data modulation schemes QPSK, 16QAM, or 64QAM. 
OFDM can offer very high transmission rates and spectral efficiency, but the mul-
tiplexed signal suffers on the highest PAPR with typical ranging from 8.5 to 13 
dB. However, the 4G system requires rather linear RF PAs for signal amplifica-
tion. Therefore, operation in deep back-off regions considerably reduces overall 
RF PA efficiency. Accordingly, advanced modulation technology increases power 
consumption and OPEX of whole communication system. Additionally, 4G LTE-A 
assumes to operate on an ultrabroad bandwidth up to 100 MHz with multiple car-
riers, which also escalates the requirements for practical RF PA technology.
1.3  Architectures for High-Efficiency PA
Although many efficiency enhancement schemes for RF PA are currently under re-
search, simply several architectures are the mainstreams to achieve high efficiency, 
in particular, for high-PAPR signals.
Switch-mode PA (SMPA), Doherty and its variants, out-phasing/LINC, enve-
lope elimination and restoration (EE&R), and envelope tracking (ET) are the five 
key players in the field of efficient operation. They all have pros and cons to com-
pete with each other as the high-efficiency RF PA candidate for the 4G system and 
beyond. A theoretical efficiency versus output power back-off is shown in Figure 
1.3.
In practice, efficient amplification of high-PAPR RF signals is elusive. Tradi-
tionally, RF PAs are designed to operate with a fixed DC supply voltage, drawing a 
specific amount of power from the supply. It is well known that efficient amplifica-
tion of constant amplitude signals is possible by biasing and driving the transistor 
so that it operates between saturation and cutoff regions. When the transistor oper-
ates in saturation, as shown in Figure 1.4, it conducts current with minimal voltage 
drop, hence minimizing power dissipation of the RF PA. In a cutoff region, the 
transistor conducts virtually no current, although the voltage across the terminals 
of the transistor during this time can be quite high. 
Ideally, the RF transistor operates as a switch, and so this breed of PAs, often 
called SMPA, ideally transfers power from the supply to the load with 100% ef-
ficiency. Note, however, that ideal efficiency implies that SMPAs must be driven 
hard so that maximum output power is delivered at all times; anything less would 
defeat the primary purpose of them. Consequently, SMPAs are generally used only 
with constant envelope signals.

8 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
Linear PAs such as class-A, AB, and B exhibit maximum efficiencies less than 
100%. Unlike switched-mode PAs, the input drive levels of linear PAs are kept 
below the point at which the transistor saturates. Low input drive produces low 
output power, while higher input drive produces higher output power. This ide-
ally linear correlation between the input drive level and the output power is the 
feature of linear PAs, but not true of SMPAs. However, the ability to linearly am-
plify amplitude-modulated signals comes at the price of efficiency. A linear RF PA 
must be designed to be capable of delivering maximum power on demand at low 
to moderate signal levels, so that it dissipates much power because its transistor 
sustains significant simultaneous current and voltage. It is interesting to note that 
Figure 1.3  Efficiency curves versus output power back-off for high-efficiency PAs. Doherty, LINC, 
EE&R, and ET are the four main high-efficiency RF PA architectures available.
Figure 1.4  RF PA transistor I-V characteristic curves and load line. Shaded parts are saturation and 
cutoff regions for switch-mode PA operations. (From: [74]. © 2003 Artech House. Reprinted with 
permission.)

1.3  Architectures for High-Efficiency PA 
9
traditional class-A, AB, and B mode PAs share the same basic topology and differ 
primarily in terms of conduction angle α, which is related to current bias Ibias and 
current swing Imag. The relationship between Ibias, Imag, and α is:
	
α π
=
⋅
⋅
cos(
)
bias
mag
I
I
	
(1.5)
Progressive improvements from the 50% maximum efficiency of the class-A 
PA can be attained by reducing Ibias from Imag (class-A, α = 1), to somewhere be-
tween Imag and zero (class-AB, 1 > α > 0.5), to zero (class-B,  α = 0.5), and finally, 
to a virtual negative bias (class-C, 0.5 > α > 0). Therefore, the AB, B, and C mode 
PAs are linear PAs whose maximum efficiencies are improved by employing lower 
current bias conditions, while class-B and class-C PAs have the added advantage 
of drawing zero current when no input is applied. At relatively low to moderate 
signal levels, the class AB-C PAs have the advantage of drawing less DC current 
and therefore less power from the supply, compared with class-A, which draws the 
twice the maximum output power regardless of the signal level. Whatever the case, 
an RF PA operating from a fixed DC supply achieves maximum efficiency only at 
maximum power output.
1.3.1  Switch Mode PA
Several types of high-efficiency topologies that efficiently amplify the RF input 
power to the desired output power level are presented in Figure 1.3. Actually, high-
peak-power efficiency becomes conscious via switch-mode PAs (SMPA), although 
with the obvious disadvantage introduced as the nonlinearity issue. Principally 
speaking, the amplitude-modulated RF signals require linear amplification and 
hence the SMPAs cannot be utilized alone with such signals. Typically, a lineariza-
tion scheme such as predistortion is a must when SMPA is considered as a highly 
efficient solution. However, in some other solutions, the nonlinear but high-efficient 
PAs can be used as a part of the linear transmitter chain such as Doherty, LINC, 
EE&R, and ET, which will be presented in later in this chapter.
Generally speaking, the classification of linear PA operation mode such as class-
A/B/C is associated with the bias condition of the device its own. It highly depends 
on how many degrees of each input signal swing conducted. Superior linearity but 
constrained efficiency performance can be achieved by a linear PA. Theoretically, 
a class-A PA can realize 50% maximum efficiency with inductive output coupling. 
Furthermore, class-AB mode makes a certain kind of sense by setting conduction 
angle as a midway between A and B modes. Although class-B PAs are subject to 
crossover distortion, the peak efficiency runs ideally as high as 78.5%. However, 
class-C PA can provide up to 90% high efficiency, but the high quality factor (Q 
factor) resonance tank circuits desired for its amplification process have constricted 
bandwidth of resonance for broadband operations. In addition, class-C resonance 
circuits for low frequencies are difficult to construct, which eventually restrict it to 
high-frequency applications. 
Although traditional linear PA classifications can disclose the tradeoff relation 
between linearity and efficiency with the emergence of recent SMPA classes, class 
designators can only indicate a new mode is invented. With the rapid development 

10 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
of advanced and compound semiconductor technologies, SMPAs ultimately have a 
pronounced advantage over the previous classes given that they have 100% theo-
retical efficiency. They are called switch mode because the RF power transistor is 
employed similar to a nonlinear switch as opposed to a linear current source as the 
traditionally mentioned classes A, B, AB, and C. Correspondingly, the term also 
results from the fact that the current/voltage waveforms are no longer a sinusoidal 
shape.
Under this condition, RF transistors can be modeled as a switch in two differ-
ent manners, as presented in Figures 1.5 and 1.6. Each model has its effect on the 
losses. In Figure 1.5, the losses happen during the instant that the transition occurs 
from off to on states once the capacitor is discharged. However, in Figure 1.6 the 
losses occur during the moment that the transition occurs from on to off states 
while the inductor is discharged. Both modes require either zero voltage across 
the switch just before the switch is turned on, which is referred to as zero voltage 
switching (ZVS) as shown in Figure 1.5, or zero current through the switch just be-
fore the switch is turned off, which is referred to as zero current switching (ZCS) as 
illustrated in Figure 1.6. Therefore, it is significant to handle both transition states 
carefully to reduce losses as much as possible.
For waveform-engineered SMPA, the addition of harmonic energy to the fun-
damental voltage and current waveforms can be an effective manner to shape a 
time domain waveform to achieve high-efficiency operation. It assumes that har-
monic voltage and current energy is available and can be either added or eliminated 
by presenting appropriate harmonic impedance at the drain/collector of the power 
transistor. Therefore, harmonic impedances can be used to generate specific combi-
nations of voltage and current waveform shapes that avoid overlap but still result 
in high output power at the fundamental frequency. The harmonic terminations 
can be implemented by short, open, and reactive load circuit at harmonics.
Figure 1.5  Zero voltage switching (ZVS) SMPA block diagram. In a ZVS SMPA, the condition is 
desirable to reduce power loss in the device by ensuring that the drain voltage is zero just before the 
turn-on period. (From: [3]. © 2006 Artech House. Reprinted with permission.)

1.3  Architectures for High-Efficiency PA 
11
1.3.1.1  Class-D and D−1 PA
The class-D PA notion originated from the company Harris semiconductor, who 
introduced the first drivers for class-D audio amplifiers in 1995, proclaiming ef-
ficiencies higher than 90%. 
Class-D mode is most often used in audio applications. Like classes E and F, 
the active devices in class-D PA are driven as switches instead of the linear mode. 
A square waveform with a frequency that is significantly higher than the highest 
frequency component of the input waveform drives the transistors between satura-
tion and cutoff. 
In class-D PA, the pulse width of input square waveform is variable. At the 
output of class-D PA, a lowpass filter (LPF) or bandpass filter (BPF) attenuates the 
switching frequency and its harmonics, leaving only the amplified version of the 
input waveform. With the power transistors in class-D operating in either cutoff 
or saturation, losses come primarily from their forward voltage drops. Therefore, 
class-D PA can achieve practical efficiency as high as 90%, with distortion levels ap-
proaching class-AB. However, a weakness of class-D concerns the challenging task 
of suppressing radiation and conducted interference from its switching harmonics. 
A typical class-D PA topology is the voltage mode class-D (VMCD), which is 
the only class that necessitates two transistors working with 180° outphased, as 
displayed in Figure 1.7. The load network has a series resonant circuitry to pass 
the current at the fundamental frequency to the load and to block all other cur-
rent components. Therefore, the voltage and current waveforms are a square and a 
sinusoidal waveform, respectively. For better illustration of fundamental principles 
of the class-D mode, the power field effect transistor (FET) can be replaced by 
Figure 1.6  Zero current switching (ZCS) SMPA block diagram. In a ZCS SMPA, the condition is 
desirable to reduce power loss in the device by ensuring that the drain current is zero just before the 
turn-off period. 

12 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
idealized switches. When the switch FET1 is off, only voltage is present over the 
transistor. When FET1 is on, current flows through it. Because there is no overlap-
ping in time between voltage and current, power is not dissipated and it can obtain 
100% theoretical efficiency. In practice, a transistor is not a perfect switch, refer-
ring to the load line in Figure 1.8, and the overlapping does limit efficiency from 
the ideal value in practical scenarios.
Actually, there is another derivative class complementary to class-D, known as 
class-D−1 or current mode class-D (CMCD). As its name indicates, class-D−1 circuit 
topology can be expressed as the inverse shaped current and voltage waveforms as 
shown in Figure 1.10 and circuitry as shown in Figure 1.9. The load network has 
a parallel resonance circuit with the load to pass the fundamental frequency and to 
short the odd harmonics. It allows the current to present square waveform and the 
voltage sinusoidal waveform as illustrated in Figure 1.10. Class-D−1 SMPA has an 
obvious advantage over its class-D counterpart because it can tune out the transis-
tor output capacitance that comes from grounding the source in both transistors 
and include it as a part of the resonant circuit. Therefore, it can still achieve high 
efficiency, but not 100% due to the knee voltage region. Likewise, the reliability 
of class-D PA is inferior to class-D−1 PA in that it may exceed the breakdown volt-
Figure 1.7  Voltage mode class-D SMPA with a series LC-resonant circuit requires two FET transis-
tors working in 180° outphased switch mode. (From: [3]. © 2006 Artech House. Reprinted with 
permission.)

1.3  Architectures for High-Efficiency PA 
13
Figure 1.8  Ideal waveforms of voltage/current and load lines for voltage mode class-D SMPA. 
(From: [3]. © 2006 Artech House. Reprinted with permission.)
Figure 1.9  Class-D−1 current mode SMPA block diagram. (From: [75]. © 2003 Artech House. Reprinted with 
permission.)

14 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
age for FET1 in Figure 1.7 because its source terminal is not grounded in VMCD 
topology.
One reason for degrading the efficiency from the theoretical value is the output 
capacitance of the transistor, which is significant at high frequency. Capacitance 
can be very large due to the required size and power level, especially for a high 
output power application. Typically, the susceptance of the output capacitance is 
very high for the high frequency and cannot be ignored. Correspondingly, another 
reason for not achieving the theoretical efficiency is that the transistors in class-D 
or –D–1 do not operate as ideal switches, which can be toggled between the “on” 
state and “off” state instantaneously. Within the finite turn-on and turn-off time, 
the overlapping between voltage and current can cause the transistor switching 
losses. This disadvantage will be easier addressed in the time-domain waveform 
analysis in the introduction to class-E PA next.
1.3.1.2  Class-E and E−1 PA
Class-E PA was invented in 1972 by Nathan O. Sokal and Alan D. Sokal. The prin-
ciple of class-E was first published in 1975 [7]. Based on the features of topologies, 
class-E PA utilizes LC tank circuits for matching, which is much like class-C PA. 
However, class-C PAs are commonly applied for low-frequency bands below 100 
MHz, while class-E PAs tend to be used for much higher RF frequencies. The differ-
ence between class-E and class-C PAs is the active device becoming a switch rather 
than operating in the linear portion of its transfer characteristic. The typical circuit 
Figure 1.10  Voltage/current waveform and load lines for class-D−1 current mode SMPA. (From: 
[75]. © 2003 Artech House. Reprinted with permission.)

1.3  Architectures for High-Efficiency PA 
15
topology of class-E PA is shown in Figure 1.11. The load network consists of se-
ries resonant circuit at the fundamental frequency and the fundamental load tuned 
slightly inductive. This inductive load reduces the slope of the voltage waveform 
before the switch turns on. The ideal voltage and current waveforms for class-E are 
shown in Figure 1.12. Class-E PA has two main advantages as soft switching effect 
to reduce the losses and simple matching circuitry compared to other switch modes. 
However, class-E has disadvantages in that the drain voltage has a high peak value 
due to charging the large output capacitance. Also, it is difficult to tune the output 
capacitance of the transistor, and to achieve the ZVS condition, all the current must 
go through the LC parallel combination of drain-source capacitance and output in-
ductance. Hence, class-E has limit tolerance for large transistor output capacitance 
Cds that degrades the maximum operating frequency performance. 
Class-E operation specifies a transient response that should occur between each 
radio frequency. This response is synthesized by the matching network and output 
capacitance Cout. Also, class-E PA operates in heavy gain compression and has 
high input drive power requirements, and is completely nonlinear in the sense that 
reduced input power does not linearly reduce output power. As input drive is re-
duced, the switch approximation begins to fail and the amplifier no longer exhibits 
class-E characteristics. Therefore, output amplitude control of class-E PA has been 
performed through the use of supply modulation techniques such as EE&R and ET.
In the conventional class-E introduced by Sokal [7], he applied ZVS and zero 
voltage slope switching conditions in order to ensure soft switching operation. 
However, the recently introduced class-E−1 PA topology [8], as illustrated in Figure 
1.13, utilizes ZCS and zero current slope switching conditions to obtain optimum 
PA operation. In the class-E−1 PA, the switching current and voltage waveforms 
are the inverse as those in the traditional class-E topology, as shown in Figure 
Figure 1.11  Class-E SMPA block diagram. A high-Q resonance formed by a serial L0||C0 tank pres-
ents an opening to all harmonic frequencies but is resonant at the fundamental switching frequency 
f0. The class-E harmonic open circuit must be placed at the load side of the output capacitance. 
(From: [3]. © 2006 Artech House. Reprinted with permission.)

16 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
1.14. Previously, class-E−1 and class-E PAs were classiﬁed respectively as “series-
L/parallel-tuned” and “shunt-C/series-tuned” in [5–9], and “voltage driven” and 
“current driven” in [10].
The advantage of the class-E−1 PA topology compared to the conventional class-
E is that it operates with approximately 20% lower peak switching voltage than 
the class-E topology. The peak switching voltage for nominal class-E operation is 
3.562 Vsm, while for the class-E−1 operation the value is 2.862 Vsm. This relaxes the 
breakdown voltage requirement on the power transistor. Second, the class-E−1 PA 
operates with lower inductance values than the class-E counterpart. The internal 
parasitic inductance of packaged devices can be absorbed by the series inductor 
in the class-E−1 topology [65, 66]. The lower inductance value requirement means 
that the series resistance of inductor is reduced and that the inductor has a higher 
self-resonance frequency. Furthermore, as discussed in [11], the class-E−1 PA offers 
better scope for optimization for high efficiency at higher output power levels, as 
well as higher peak output power when compared to optimal class-E designs. In ad-
dition, in [11] it was shown that class-E−1 is reasonably tolerant to the circuit com-
ponent value variations as well as switching frequency and duty cycle variations.
1.3.1.3  Class-F and Class-F−1 PA
Until now, several operation modes of high-efficiency SMPAs have been introduced. 
Similar to the SMPAs of classes-E and E−1, classes-F and F−1 also use a harmonic 
Figure 1.12  Voltages/current waveforms, and load lines for class-E SMPA. Though these waveforms 
are highly nonlinear and rich in harmonic content, the high-Q filter network maintains purely fun-
damental output power at the load. (From: [3]. © 2006 Artech House. Reprinted with permission.)

1.3  Architectures for High-Efficiency PA 
17
manipulation approach to shape current and voltage waveforms. The class-F PA 
was invented by V. J. Tyler, published in 1958 [67], and further investigated by D. 
M. Snider in 1967 [69] and F. H. Raab in 1996 [70], as a simple and feasible way 
to improve PA large-signal performances. An open circuit is presented at odd har-
monics while a short circuit is presented at even harmonics. Class-F and class-F−1 
PAs are suitable for high-power operation because they have higher output power 
capability than class-E PAs [12].
Class-F PA has the most complex matching circuit among all the classes be-
cause it requires at least three resonators to short out even harmonics and block 
odd harmonics. Typically, its matching network controls up to the fifth harmonics. 
Therefore, class-D can be considered as an ideal case for class-F, in which the cur-
rent is a sinusoidal waveform and the voltage is a square waveform. The circuit 
topology is shown in Figure 1.15. 
Class-F PAs resemble the class-E mode as well, but use a more complex load-
matching network. In part, this network improves the impedance match between 
the load and the switch. Moreover, it is designed to eliminate the even harmonics 
so that the switching signal is more nearly a square wave. It improves efficiency 
because the switch runs at saturation or cutoff for a longer period. 
In reality, the ideal waveforms of Figure 1.16 cannot be realized because infinite 
harmonic content and control would be required. An approximation of the square 
wave can be achieved using only up to fifth harmonic voltage content, where the re-
sulting shape depends on the relative magnitude of the fifth harmonic component. 
Figure 1.13  SMPA block diagram shows the ideal equivalent circuit of a class-E−1 PA with finite 
DC-feed inductance. It consists of an active device as an ideal switch, a series inductor (L), a parallel 
inductor (RFC), a shunt resonant circuit (Lp||Cp) tuned to the operating frequency, a compensation 
capacitor (C), and a load resistance (RL). 

18 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
Consideration of the fifth harmonic yields 94.8% theoretical efficiency and a 0.82-
dB increase in output power compared to class-B.
As in classes-D and E, class-F has a complementary circuit called class-F−1 
that blocks the even harmonics and shorts out the odd ones. The circuit topology 
Figure 1.14  Voltage/current waveforms and load lines for class-E−1 SMPA.
Figure 1.15  Class-F SMPA block diagram. (From: [75]. © 2003 Artech House. Reprinted with permission.)

1.3  Architectures for High-Efficiency PA 
19
is shown in Figure 1.17. It reverses the even and odd harmonic terminations to 
achieve current squaring and voltage peaking.
Class-F−1 operation can achieve high efficiency by giving the drain current a 
square waveform through the use of harmonic control. In class-F−1 PAs, a square 
Figure 1.16  Voltage/current waveforms, and load lines for class-F SMPA. The presence of only odd-
harmonic voltage is used to synthesize a square wave, and the even-harmonic current causes current 
peaking. (From: [75]. © 2003 Artech House. Reprinted with permission.)
Figure 1.17  Class-F−1 SMPA block diagram.

20 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
current waveform and a half-sine voltage waveform are generated by open circuits 
for even harmonics and by short circuits for odd harmonics.
Class-F−1 has similar waveform as the ones in class-D−1, but it gives high ef-
ficiency with lower peak voltage than class-E (see Figure 1.18). As compared to 
class-F, higher drain-source voltage peaks and lower current peaks are expected. 
Alternatively, class-F−1 needs lower drain supply voltage than any other classes 
for the same output power because the voltage waveform has a higher peak than 
the square waveform such as that of class-F PA. However, higher peak voltage is 
undesirable, requiring careful attention to drain-source breakdown. Lower current 
peaks reduce efficiency degradation when transistor conduct resistance increases. 
Due to low current, the dissipation is low when transistor conduct resistance is 
increased based on P = I2 * R [68], and theoretical fundamental load impedance is 
also higher. Higher fundamental load impedance results in lower transformation 
ratios and reduced matching circuit losses. With practical considerations, the knee 
voltage effect is a source of significant harmonic content. Consider a fundamental 
load and drive level that forces drain-source voltage below the knee voltage in each 
RF cycle. Hence, the typical half-sinusoid drain-source current waveform can be 
bifurcated, naturally generating large amounts of third harmonic drain current. 
This behavior proves even more beneficial for current-squaring class-F–1 than for 
its class-F counterpart because a large third harmonic component can be difficult to 
achieve at high fundamental frequencies. Finally, higher-frequency harmonic open 
circuits are more difficult to realize than lower-frequency harmonic terminations. 
Figure 1.18  Voltage/current waveforms and load lines for class-F−1 SMPA. The short circuit of odd 
order harmonics is used to synthesize a half-sine wave, and the open circuit of even order harmonics 
causes a square current waveform, as illustrated.

1.3  Architectures for High-Efficiency PA 
21
Therefore, when terminating only two harmonics for high-frequency applications, 
the class-F−1 PA is more practically feasible than the class-F PA because it requires 
an open circuit termination at the second harmonic rather than the third harmonic. 
Hence, all of these reasons are why class-F–1 PA is preferred for high-efficiency 
operations. 
1.3.1.4  Class-S PA
The class-S concept was the name of a design published by A. M. Sandman in 1982 
[18] and further developed in recent years for a high-efficiency, all-digital RF trans-
mitter concept with pulse modulation technologies involved. Currently, the RF PAs 
for BTSs and UEs offer only limited efficiency with QAM and OFDM signals, due 
to the high PAPR of these modulation formats and the high linearity requirements.
Traditionally, the method to overcome this problem is to use linearization tech-
niques like digital predistortion (DPD) that increase efficiency, but the fundamental 
problem remains and the PA operates most of the time in back-off region with 
average power.
Many organizations are investigating class-S switch-mode operations as an al-
ternative to conventional RF PAs. Theoretically, class-S can offer up to 100% effi-
ciency, which is a key enabler for very compact transceivers. The class-S design also 
offers multiband capabilities, together with metamaterial-based RF duplex filters 
and a frequency agile radio.
As shown in Figure 1.19, a typical class-S RF PA can contain a baseband sig-
nal source, bit modulator with pulse modulation, highly efficient SMPA (typically 
class-D or D−1), and a reconstruction bandpass filter (BPF) to restore the funda-
mental signal.
For the single/multiple bit modulator design, the modulation schemes were 
chosen from pulse width modulation (PWM) at the beginning [3, 4]. While con-
sidering the nonlinear and faster switching speed, sigma delta modulation (SDM) 
was proposed for class-S due to its noise shaping and inherently linear character. 
Meanwhile, in recent years, pulse density modulation (PDM) and pulse position 
modulation (PPM) schemes have also been investigated to eliminate the drawbacks 
of former schemes.
The class-S approach is based on the variable pulse duration switching signal, 
which results in an inability of operational with zero voltage or current switch-
ing condition. Furthermore, a single-bit, digital-modulated signal is considered as 
Figure 1.19  Class-S switch mode RF PA block diagram.

22 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
an aperiodic pulse train and filter reconstruction operation generates positive and 
negative waveforms. In other words, class-S operation is characterized by I-V tran-
sitions not only in the first quadrant but also in the third quadrant due to negative 
voltage and current waveforms. This phenomenon has been illustrated in [19].
Finally, the highly efficient reconstruction filter design is another bottleneck 
issue blocking class-S from common use. The class-S PA concept is a software-
deﬁned radio (SDR) solution. It can offer ﬂexibility, low design effort, low power 
consumption, and finally reduction of analog components.
1.3.2  Waveform-Engineered PA
Traditionally, RF PA design places much reliance on the accurate measurement of 
key nonlinear performance parameters such as output power, gain, efficiency, and 
linearity as a function of the fundamental load impedance. Basically, in such a black 
box approach, the aim is to find, by either trial and error or via a logical sequence 
of measurements, the harmonic load impedances with which the desired optimum 
performance can be achieved. Theoretically, the optimum performance will occur 
when appropriately engineered current and voltage waveforms are shaped. During 
the experimental investigation, the PA designer can effectively modify the current 
waveform by the choice of DC quiescent bias point and input drive level and the 
voltage waveform by the choice of fundamental load impedance. Therefore, such 
kinds of SMPA designs are engaged in the process of waveform engineering.
In all these switch-mode classes, there are some drawbacks for each one. Hence, 
one should find a compromise to achieve a balanced performance among efficiency, 
linearity, and bandwidth. Typically, waveform-engineered PA can provide such an 
option to trade off the figure of merits through a design process.
1.3.2.1  Class-J PA
Class-J PA has a fairly recent derivation, being principally promoted by Cripps in 
[3, 5]. It combines the advantages of classes-E and F−1. However, this class was in-
troduced in some literature with different names but with the same operation, such 
as high-frequency class-E in [13] or class-E/F in [15]. Cripps [3] suggested that the 
class-B PA designs are actually supposed to have capacitive harmonic terminations 
in which the output capacitance of power transistor own closely approximates a 
short circuit. Hence, the theory for the class-J mode of operation is developed based 
on such harmonic terminations and reactive load impedance (see Figure 1.20).
Class-J PA requires a slightly inductive load at the fundamental frequency and 
only a capacitive load at the second harmonic. The first requirement is similar to 
the one in class-E PA. However, class-J PA tries to make fast switching transitions 
during the on and off state, which reduces the losses and increases the efficiency, 
while in class-E the on-transition switching has fewer losses than the off-transition 
switching for a sinusoidal drive signal. However, class-F−1 requires an infinite num-
ber of resonators to achieve high efficiency. Most of the work is done by controlling 
up to the fifth order harmonics. On this point, class-J PA requires one resonator 
to control the second harmonic. As with any other class, class-J PA can be imple-
mented as either single-ended or push-pull architectures [71]. Several advantages of 
class-J PA can be recognized. First and most important, it can be seen as a decent 

1.3  Architectures for High-Efficiency PA 
23
candidate for high efficiency and wideband performance. In addition, it can be de-
signed beginning with any classic class of PA, such as class-A/AB/B.
As shown in Figure 1.21, to eliminate the negative second harmonic load, the 
voltage waveform should be moved by at least 45° with the complex fundamental 
and capacitive second harmonic loads. In this case, there is some overlap between 
the fundamental voltage and current waveform, but the half sinusoidal voltage and 
current waveforms can be maintained, which has become known as the class-J PA. 
Because of the overlap between the waveforms, the class-J PA dissipates power in-
ternally and reduces the power and efficiency, resulting in the same efficiency as the 
class-B RF PA [3, 15], with theoretical peak power efficiency as 78.5%.
1.3.2.2  Class-P PA
Class-P or saturated PA came right behind class-J in recent years and was invented 
by researchers from Pohang University of Science and Technology. In compari-
son with class-J PA, it takes full advantage of the nonlinear behavior of the out-
put capacitor to perform waveform engineering process to further boost the peak 
power efficiency with rather simple output matching network for fundamental and 
harmonics. However, class-P contains several subcategories according the different 
harmonic manipulation techniques [72].
As shown in Figure 1.22, class-P PAs utilizes the harmonic voltages generated 
by the nonlinear effect of output capacitance Cout for voltage waveform shaping. 
The nonlinear Cout represents all nonlinear capacitors of RF transistor output such 
as Cds and Cgd, which are modulated according to both Vds and Vgd. The harmonic 
voltages from Cout consist of a large second harmonic component with smaller 
Figure 1.20  Illustration of a simplified block diagram of class-J PA, which requires a slightly induc-
tive load at the fundamental frequency and only a capacitive load at the second harmonic. (From: 
[3]. © 2006 Artech House. Reprinted with permission.)

24 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
Figure 1.21  Illustration of an instantaneous voltage/current waveforms and load lines for class-J PA. 
(From: [3]. © 2006 Artech House. Reprinted with permission.)
Figure 1.22  Illustration of a simplified block diagram of class-P PA. The fundamental resistive load 
controls the amplitude and phase of self-generated harmonic currents. With the appropriate choice 
of the load, the desired voltage waveform can be generated by the harmonic load mainly of the 
nonlinear output capacitor. (From: [73]. © 2012 IEEE. Reprinted with permission.)

1.3  Architectures for High-Efficiency PA 
25
higher-order harmonics. Thus, the half-sinusoidal shaped voltage across the capaci-
tor can be generated easily using large harmonic loads [15–17].
Class-P PA has a quasi-rectangular/bifurcated current waveform and a quasi-
half-sinusoidal voltage waveform described in Figure 1.23, which are similar to the 
waveforms of class-F−1 PA. The voltage and current waveforms are shaped using 
the self-generated harmonic components [15]. Because the output capacitor in the 
transistor is highly nonlinear, the capacitor generates a large amount of second 
harmonic voltage with a few higher-order harmonics. Therefore, the self-generated 
harmonic voltage assists in forming the quasi-half-sinusoidal voltage. The harmon-
ic voltages can be large enough when the PA is driven by the large input power 
with a large fundamental load. Under such a drive condition, the current becomes 
the quasi-rectangular shape by the bifurcated current in the saturated operation. 
Therefore, the practical efficiency of the class-P PA can approach 90% [15–17].
By means of nonlinear output capacitors, a voltage waveform can be generated 
with the fundamental and a large second harmonic, as well as small higher-order 
harmonics. Meanwhile, only fundamental current is injected into the nonlinear ca-
pacitors. It indicates clearly that the nonlinear output capacitance Cout is the main 
source of the second harmonic voltage. The voltage across the capacitor is propor-
tional to the integral of the current through the Cout, the charge in the capacitor, 
scaled by the capacitance.
Figure 1.23  Illustrations of load lines for class-P PA with quasi-rectangular/bifurcated current and 
quasi-half-sinusoidal voltage waveforms. (From: [15]. © 2011 IEEE. Reprinted with permission.)

26 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
Table 1.1 summarizes the main pros and cons of the main nonlinear PAs with 
respect to classes E, F−1, J, and P when controlling harmonics up to the third order. 
It can be concluded that the class-J PA is a trade-off between class-E and class-F−1 
as well as easier to implement than class-F−1, which motivate the research to take 
class-J as a cornerstone of the design strategy for further performance enhancement 
to new classes of waveform engineered PAs, such as class-P.
1.3.3  Doherty
The basic principle of Doherty PA operation is based on load modulation, with 
which the load impedance varies according to the power level. The Doherty ar-
chitecture has in recent years been reborn and chosen as the mainstream high-effi-
ciency RF PA for wireless infrastructure since W. H. Doherty developed it in 1936 
[20]. It was called “new after 70 years” with several variants developed to meet 
ever-growing efficiency requirements for high-PAPR signal amplifications.
1.3.3.1  Even Doherty
Even or symmetrical Doherty is the classic topology, as shown in Figure 1.24. In 
even Doherty RF PA, the carrier to peak cell size ratio is 1:1. Therefore, the RF 
input signal is split by a 3-dB splitter or hybrid coupler into two paths with 90° 
phase difference. With a low-power input level, the peak amplifier cell is shut down, 
which results in a load impedance of 2 ⋅ Z0 for the carrier amplifier cell. While in-
creasing the input power level, both carrier cell and peak cell are turned on and the 
matching network and microstrip offset lines modulate the carrier cell load imped-
ance from 2 ⋅ Z0 to Z0 according to the output power levels. By adjusting both car-
rier and peak cell bias feeding line, the intention to compensate the package internal 
parasitics such as bonding wire inductance can be implemented to further improve 
the Doherty PA performance. 
After the amplifications of carrier and peak cells, the RF output signals are 
summed together by a Doherty combiner, which means that the peak cell output 
passes the output matching network and offset lines, and then makes an imped-
ance transformation of Z0 and a 90° phase change. After summing with the carrier 
cell output signal, it transforms the impedance again with 
⋅
0
2
2
Z  and another 90° 
phase change together as the final output.
As illustrated in Figure 1.25, besides the inherent first peak efficiency point 
of the peak cell, the efficiency curve will keep increasing during low-power mode 
Table 1.1  Performance Summary of SMPAs for Comparison
Item
Class-E
Class-F−1
Class-J
Class-P
Topology complexity
Low 
High 
Middle
Middle
Peak voltage
High
Low
Middle
Middle
Loss
Highest
Low
Middle–high
Lowest
Efficiency
Lowest
High
Middle–high 
High
Bandwidth
Wide
Narrow
Wide
Middle

1.3  Architectures for High-Efficiency PA 
27
with the peaking cell shut down. Therefore, the carrier cell can generate the second 
peak efficiency point at 6 dB or four times lower from maximum output power. 
With the high-efficiency region between the peak cell switch point and the first 
Figure 1.24  The principle and schematic diagram of the traditional even Doherty RF PA. Load 
modulation first turns on the carrier cell and then the peak cell when input power increase to a 
certain level.
Figure 1.25  The efficiency curve comparison between even Doherty and class-AB/B RF PAs. The 
former provides a second peak efficiency point at 6-dB back-off from peak power in theory.

28 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
peak efficiency point, even the Doherty RF PA can theoretically give high average 
efficiency results with the amplitude-modulated signal with around 6 dB PAPR by 
fitting the efficiency range to the probability density function of high-PAPR signals.
1.3.3.2  Uneven Doherty
Although even Doherty can provide high average efficiency operation, with the 
rapid development of emerging wireless communication standards, the PAPR of 
a signal is ever increasing and greater than 6 dB, which results in an average effi-
ciency degradation with such a signal. Therefore, uneven Doherty architecture has 
been proposed to move the second peak efficiency point left away from the first 
efficiency peak toward the low-power region to tolerate more than 6 dB back-off, 
as shown in Figure 1.26. 
There are many methods to make Doherty uneven, such as uneven splitting 
and amplifier cell sizing and uneven drain/collector voltage configurations. A typi-
cal uneven Doherty topology is the uneven splitting and sizing by 5 dB and 1:2, 
respectively, as shown in Figure 1.26. With this kind of structure, the second effi-
ciency peak moves to a 9-dB back-off position to tolerate signals with higher PAPR. 
However, the region between the two efficiency peaks will suffer from more severe 
efficiency drooping down issue. While further decreasing the power ratio between 
carrier and peak cells, it becomes possible to implement larger output power back-
off, which results in a severe efficiency drop-down effect between two efficiency 
peaks, as shown in Figure 1.27, with a ratio of 1:3 and 12 dB back-off.
Besides the efficiency drooping issue of uneven Doherty PA, it is also a bit more 
difficult to be linearized with predistortion due to early gain droops during back-
off, shown in Figure 1.28, and more complex memory effects.
Figure 1.26  The efficiency curve comparison among uneven Doherty, even Doherty, and class-
AB/B PAs.

1.3  Architectures for High-Efficiency PA 
29
1.3.3.3  Inverted Doherty
Compared to the conventional counterparts, inverted Doherty PA employs a differ-
ent load modulation, which inverts the load network configuration. In an inverted 
Doherty architecture, an appropriate matching network and a proper length of the 
offset line can be substituted for the quarter-wave line with arbitrary characteristic 
impedance, as shown in Figure 1.29. Therefore, the inverted Doherty PA has the 
Figure 1.27  The principle and schematic diagram of uneven Doherty PA with 9 dB back-off peak 
efficiency point.
Figure 1.28  Power gain drooping of an uneven Doherty compared to its even counterpart, which 
brings about potential linearization difficulties to predistortion.

30 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
advantage of a simple configuration without any additional complex circuitry but 
also potential wider operation bandwidth. It can be realized as a compact size be-
cause of reduced offset lines [21–23].
In comparison to an even Doherty, a quarter-wave line is located after the peak 
cell to transform a low-impedance output after the offset line to high impedance 
observed from the load junction. The phase difference between the two paths be-
cause of the additional quarter-wave line and offset lines α
θ
⋅
⋅
0
Z
 can be compen-
sated for using a quarter-wave line and additional offset line 
j
⋅
° +

0
(90
)
Z
 at the 
input of the carrier cell. The electrical length of the offset line 
j
⋅
° +

0
(90
)
Z
 comes 
to be (
)
φ
j
−

 to match the phases between carrier and peak paths.
The efficiency curve over power back-off is almost the same as with an even 
Doherty PA, as shown in Figure 1.25. However, by introducing a scaling factor α, 
(α > 1), the impedance of α · Z0 could be greater than Z0 to increase the peak cell 
off-state impedance (e.g., with α = 1.5 to have 75Ω impedance after peak cell). By 
this means, substantial efficiency and linearity improvements can be achieved over 
the traditional even Doherty [24]. Furthermore, it is evident that the phase differ-
ence between paths can be improved during peak cell turning on or high RF input 
driving conditions, which result in a broader bandwidth in Doherty load modula-
tion design over frequency.
Figure 1.29  The principle and schematic diagram of an inverted Doherty RF PA with inverse load 
network configuration.

1.3  Architectures for High-Efficiency PA 
31
1.3.3.4  Multistage Doherty
With ever-increasing PAPR of advanced modulated signals, the multistage Doherty 
RF PA concept emerged to provide multiple efficiency peaks over output power 
back-off range to alleviate the efficiency drop and fit to the signal PDF. Multistage 
Doherty is based on a subsequent switch on condition of several auxiliary peak cells 
for the sake of assuring a multiple Doherty region in a cascade configuration, which 
reduces the degradation of the average value due to the increase drop-down effect in 
Doherty efficiency, particularly when larger output power back-off is required [25]. 
As seen in Figure 1.30, the schematic of general multistage Doherty PA con-
sists of one carrier cell and N peak cells. The carrier cell and the first peak cell 
are designed to play the roles of main and auxiliary amplification as conventional 
Doherty architecture. Furthermore, when both the carrier and the first peak cells 
are saturated, the second peak cell will switch on to provide another efficiency 
peak. The rest (N − 2) peak cells can be done in the same manner as the initial 
iteration to provide another (N − 2) efficiency peaks for output power back-off 
tolerance, resulting in a theoretical efficiency over broad back-off range behavior, 
as shown in Figure 1.31.
The combination networks of multistage Doherty is one of the most important 
design considerations, which requires properly implementing the load modulation 
for all cascaded stages. The impedance of quarter-wave transmission line network 
at output is well studied [25–28]. However, this scheme suffers from practical dif-
ficulties to keep the proper driven level of all stages, which would introduce non-
linearity and serious memory effect issues on such a Doherty topology. Solutions 
such as optimized biasing and input level control could be adopted to alleviate this 
problem. In the meantime, other novel solutions for wideband and high-efficiency 
Figure 1.30  The principle and schematic of a multistage Doherty PA, which utilizes multiple peak 
cells to compensate efficiency drop-down effect by adding more peak efficiency points in theory.

32 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
multistage Doherty output combination network have been widely investigated 
and researched. 
1.3.4  LINC and Outphasing
The linear amplification using nonlinear components (LINC) technique was pro-
posed by Cox in 1974 [31] as a transmitter technology with efficiency and linear-
ity improvements. The configuration of the LINC transmitter is shown in Figure 
1.32(b), which utilizes two outphasing paths to amplify constant envelope signal in 
the saturation region of RF PA to achieve high efficiency, while the combination of 
the two paths cancels the distortions and restores a linear output amplitude modu-
lated signal.
In a traditional LINC transmitter system, there is a signal component separa-
tor (SCS) module to generate the baseband signals with a constant envelope but 
outphased in a digital signal processing (DSP) block. As shown in Figure 1.32(a), 
SCS can be expressed as:
	
α
j
⋅
⋅
=
+
=
⋅
⋅
( )
( )
1
max
( )
( )
( )
j
t
j
t
s t
s t
e t
r
e
e
	
(1.6)
	
α
j
⋅
−⋅
=
−
=
⋅
⋅
( )
( )
2
max
( )
( )
( )
j
t
j
t
s t
s t
e t
r
e
e
	
(1.7)
	
=
⋅
⋅
−
2
2
max
( )
( )
( )
1
e t
j s t
r
r t
	
(1.8)
where s1(t) and s2(t) represent the outphased signals containing the original input 
signal s(t) and e(t) denotes a quadrature signal, which can be amplified by SMPAs. 
After SCS processing, the encoded complex signals are converted into to ana-
log baseband signal by dual digital-to-analog converters (DDAC) and shifted into 
intermediate frequency (IF). In phase and quadrature phase (I-Q) frequency modu-
lator (FMOD) is employed later to upconvert the IF signals into RF. Then each of 
Figure 1.31  Theoretical efficiency behavior of multistage Doherty PA with one to two peak cells for 
illustration of efficiency drop-down compensation.

1.3  Architectures for High-Efficiency PA 
33
these two signals is fed to its own nonlinear RF PA cell, which is usually an SMPA 
cell that could be driven by the constant envelope outphased signals to achieve high 
efficiency. The SMPAs increase the power of each signal by an identical amount. 
After the individual amplification, the separate signals are fed to an ideal summing 
junction for recombination. The resulting output signal after the summing junction 
is an amplified version of the input signal without any added distortion in the ideal 
case. In other words, the LINC combiner restores the RF signal into amplitude 
modulated one with the two constant envelope inputs, in which the distortions on 
each SMPA cell can be canceled due to outphasing. The combiner design is also 
one of the most critical parts of the LINC transmitter to maintain high efficiency 
and linearity.
The theoretical efficiency of the LINC transmitter is 100% because the PAs used 
are highly efficient nonlinear amplifiers as well as the constant envelope nature of 
the phase-modulated signals. From the linearity point of view, the linearity perfor-
mance of LINC transmitter is dominated by the RF gain and phase match between 
the two amplified signals [32]. The generation of the two signals and the power 
combining after the amplifiers are also key issues in these types of transmitters.
The advantages of LINC are obvious. Due to using nonlinear high-efficiency 
RF PAs, theoretically high transmitter efficiency can be realized with this tech-
nique. However, the drawbacks stem from the matching between the two-branch 
topology and ultrawide phase signal bandwidth. The performance of the system 
depends on the effects of the necessary reactive compensation, which may have 
bandwidth restrictions. The design of the LINC modulator is critical because the 
linearity of the whole system depends on it. Sufficient gain and phase matching are 
therefore difficult to realize. 
Figure 1.32   (a) LINC concept and signal decomposition, and (b) block diagram of LINC transmit-
ter. (From: [74]. © 2003 Artech House. Reprinted with permission.)

34 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
Although this technology had demonstrated elegant efficiency with acceptable 
linearity for handset or terminal application scenarios, it is still challenging to ap-
ply it to a high-power design such as a base station with consideration of nonideal 
factors such as the branch mismatch, combiner loss, and RF PA cell mismatching.
1.3.5  Envelope Elimination and Restoration
Envelope elimination and restoration (EE&R) was first invented by Leonard R. 
Kahn in 1952 and further developed in later times. Therefore, EE&R is also called 
a Kahn transmitter. This technique has received a lot of attention recently, especially 
in the telecommunication area [29, 30].
The EE&R technique implements a linear PA by combining a nonlinear but 
highly efficient RF PA and an envelope supply modulator [33]. The configuration 
of the EE&R system is shown in Figure 1.33. The input signal contains both the 
amplitude and the phase information. The signal is split and envelope-detected in 
the envelope generation block so that the envelope paths are separate from the RF 
path and contain the constant envelope phase-modulated signal. A highly efficient 
RF PA amplifies the constant-envelope signal in the RF branch, which can only 
preserve the phase modulation information and transmit it to the output. However, 
the supply modulator provides an output that is proportional to the envelope of 
the input signal with minimum distortion but highly efficient. The resulting high-
power envelope signal is utilized to modulate the power supply of the RF PA. This 
modulation process restores the signal envelope and results in a high-power replica 
of the input signal being produced at the output.
Typically, the RF PA in the EE&R transmitter is always saturated and therefore 
operates at the maximum efficiency. If a high-efficiency SMPA is used as an RF PA 
cell, the efficiency of the RF PA can be ideally 100%. The supply modulator can be 
various topologies but all keep high efficiency, which will be discussed in Chapter 
4. It is therefore possible for an EE&R transmitter to have an average efficiency 
which is several times that of conventional transmitters. The linearity of EE&R 
transmitter does not depend on the linearity of the RF PA. There are two principal 
Figure 1.33  Block diagram of a classical EE&R/ Kahn transmitter with separated amplitude and 
phase modulation, which is also called a polar transmitter. (From: [3]. © 2006 Artech House. Re-
printed with permission.)

1.3  Architectures for High-Efficiency PA 
35
factors that affect the linearity of the EE&R transmitter: the linearity of the supply 
modulator and the differential delay between the amplitude and phase signal paths 
[33]. The amplitude modulation to phase modulation (AM-PM) conversion of the 
RF PA is another important potential source of distortion. If necessary, the linearity 
of the EE&R system can be further improved by techniques such as envelope feed-
back and phase lock, Cartesian feedback, or advanced predistortion schemes [34]. 
However, a significant disadvantage is that the challenging bandwidth and ef-
ficiency requirements of supply modulator at the moment render EE&R technique 
less attractive for broadband applications. However, they can be used in narrow-
band single-channel applications, and if the supply modulator could approach be-
ing 100% efficient, the EE&R technique would be typically better than the Doherty 
and LINC techniques for efficiency enhancement. 
1.3.6  Envelope Tracking
There are actually two main variants of variable supply PAs. The first of these is 
the EE&R transmitter as mentioned earlier, which exemplifies the use of constant 
amplitude SMPA with dynamically controlled supply voltage. The other is enve-
lope tracking (ET), which utilizes linear PAs whose low efficiency weakness dur-
ing relatively low power periods can be mitigated by adjusting the supply voltage 
accordingly.
Typically, an ET PA comprises a linear RF PA and a supply modulator for 
providing a modulated supply voltage as a dynamic supply to the PA. The key dif-
ference to EE&R transmitter is that the PA amplifies envelope modulated signal 
rather than constant envelope ones. 
The basic idea of the ET technique is to drive the linear RF PA in its high-effi-
ciency region regardless of the magnitude of the input signal. This is accomplished 
by detecting the envelope of the input signal and using it to modulate the supply 
voltage of the linear PA. In this sense, it is similar to the EE&R technique, but the 
difference comes in the ET technique not utilizing a limiter for the input RF sig-
nal. One of the advantages of ET is that the envelope supply does not have to be 
replicated as accurately as the EE&R technique because both amplitude and phase 
signal are amplified in the RF path as well. In general, when using a linear PA, good 
enhancements in efficiency can be achieved with ET technique. However, the ef-
ficiency of the supply modulator should be sufficiently high to achieve high overall 
efficiency of the ET system. High efficiency can be achieved by involving a switch-
mode power supply (SMPS) design, although there may be some severe bandwidth 
limitations for the supply modulator. There are usually DSP blocks that compare 
the timing error measurements of envelope and RF branches to perform delay align-
ment, crest factor reduction, envelope shaping functions, and finally predistortion 
to the ET PA. ET PAs are relatively easy to shift to other carrier frequencies, since 
it is only necessary to adjust the matching of the RF PA in a relatively simple way 
without any adjustments to the supply modulator. For the scenario of increased 
bandwidth, the ET PA has a significant challenge associated with maintaining high 
efficiency and accuracy of the supply modulator, which generates the time-varying 
power supply. ET system basic knowledge will be discussed in depth in Chapter 
2. However, one may ask about the pros and cons of ET compared to the EE&R 
technique. The advantages of ET to EE&R are summarized next [63, 64]:

36 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
••
ET requires lower sensitivity to the timing mismatch from the paths of the 
supply modulator and the RF PA than that of EE&R.
••
ET needs lower bandwidth requirement for the supply modulator in the 
sense that the overall system gets the signal information directly through the 
RF PA and not from the supply modulator. 
••
ET relaxes bandwidth requirements for circuits used in the RF paths. As the 
input of the RF PA is not limited so that it only needs the modulation band-
width. It makes ET more suitable for broadband applications. 
••
ET has higher gain at lower input power because the supply modulator keeps 
the RF PA more linear with specific envelope shaping functions which will be 
discussed in Chapter 6. 
••
ET has less impact to zero feedthrough signal to distort the transmitter out-
put because of applicable envelope shaping functions, which are not avail-
able for EE&R transmitters.
Based on the above reasons, ET becomes more and more attractive for high-
efficiency, broadband, and linear transmitters for modern communications such as 
the 4G system and beyond. However, there are also three major disadvantages of 
ET [63, 64]:
••
The ET technique requires the use of a high-efficiency supply modulator 
to increase the efficiency of the RF PA. Therefore, the efficiency problem is 
carried in a higher level into the supply modulator. Hence, to obtain highly 
efficient ET systems, a high-efficiency supply modulator is a must in the first 
place.
••
The efficiency of ET is smaller at low-inputs than at high-inputs because 
both envelope and RF path exhibit the same amplitude modulation shape. 
Low-input power region cannot be sufficiently compressed as EE&R for 
high efficiency.
••
The distortions developed in the supply modulator can be introduced to the 
RF PA in different forms and, therefore, it requires extra powerful lineariza-
tion methods to correct them. Linearity requirements force the use of new 
but more complex predistortion algorithms and high signal bandwidth re-
quires a higher degree of timing alignment precision.
Finally, although linearity and efficiency are mutually exclusive properties in 
traditional fixed DC supplied RF PAs, ET PAs can linearly amplify amplitude and 
phase-modulated signals with much higher efficiency. Both linear PAs and high-
efficiency SMPAs can benefit from ET with modern predistortion schemes. For ex-
ample, traditionally, linear PAs can accurately amplify high-PAPR signals but at the 
expense of efficiency. By designing a linear PA in conjunction with a variable supply 
voltage scheme, efficiency can be improved while maintaining linear amplification 
of high-PAPR signals. Also, efficient but nonlinear PAs can be potentially linearized 
by utilizing an intentionally shaped time-varying supply voltage in ET, which will 
be discussed in Chapters 2 and 6. 

1.4  Device Technologies for High-Efficiency PA 
37
1.4  Device Technologies for High-Efficiency PA
RF PAs are essential parts for both UE and BTS for wireless communications. They 
are one of the most expensive components in modern wireless equipment, and both 
their performance and cost are key drivers in radio design innovations. Efficiency, 
physical size, linearity, and reliability are among the major concerns. The RF power 
semiconductor technology for RF PA design is the key contributor for cost and 
capability optimization (see Figure 1.34). As price pressures becomes vicious with 
the emerging 4G service, novel and state-of-the-art techniques and semiconduc-
tor materials must be used to reduce the cost of PA while still maintaining high 
performance. 
Although a major research interest is the development of high-power density 
devices with wide bandgap materials such as silicon carbide (SiC) and gallium ni-
tride (GaN), large-scale RF power device production, especially for commercial 
purposes, is actually done using silicon (Si), gallium arsenide (GaAs), and related 
compounds.
Selecting RF power transistor semiconductor technology is an essential key to 
acquiring extraordinary performance for parameters such as linearity, bandwidth, 
efficiency, gain, and output power. Among all the candidates, GaAs heterojunction 
bipolar transistors (HBT) and Si-LDMOS are still the champions in the mobile UE 
Figure 1.34  RF PA and power semiconductor pedigree for wireless communications.

38 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
and BTS infrastructure markets, respectively. However, newer rivals such as CMOS 
and GaN HEMT technologies are emerging and drawing more attention, although 
the research and commercialization for these are still ongoing.
Devices such as GaAs HBTs and SiGe HBTs are employed for relatively low-
power applications. Also worthy of mention are CMOS PAs, which have been 
introduced in recent years because of attractive performance cost. There is a long-
standing dispute that silicon is superior to GaAs. The argument states that silicon 
is more mature and predictable and can be produced at lower cost, and integrating 
new functions on-chip is easier than with GaAs. 
However, these arguments are no longer true today for demanding applications. 
GaAs processes are mature. The cost disadvantages of GaAs have been overcome 
by volume, which drove down substrate prices enormously. In addition, GaAs has 
features that cannot always be matched by its silicon counterpart. However, larger 
chip sizes have serious drawbacks with the use of GaAs because the die is more 
expensive, and more importantly, it has an impact on the cost and dimension of the 
module and disabled the shrinkage way for future products.
For high-power and high-frequency applications such as BTS PAs, Si-LDMOS 
dominates the current market [44]. However, the power density of Si-LDMOS is 5 
to 10 times lower than its GaN HEMT competitor [45]. In addition, GaN HEMT 
has reached the commercialization phase recently, which can make the RF PA de-
signs highly efficient, more compact, easier to produce, and more reliable.
1.4.1  GaAs HBT
With decades of development as a mature commercial semiconductor technology, 
GaAs HBT has won the reputation as a higher-performance technology than either 
silicon CMOS or BJTs. It is true for discrete power transistors and especially for 
high-frequency integrated circuits such as microwave monolithic integrated circuits 
(MMICs). Although silicon LDMOS offers strong competition below 3 GHz for 
BTS infrastructure, GaAs has higher frequency and medium power space and easily 
outperforms Si-LDMOS in PAE and die size. However, GaAs has been recently fac-
ing competition from the rapidly developing GaN HMET technology.
The GaAs HBT principle is based on the idea of using different materials for 
the emitter, base, and collector in a bipolar transistor to achieve enhanced perfor-
mance. The term was proposed by Shokely in 1948 [36]. However, a practical HBT 
device was not available until the 1980s when the modern method of epitaxial 
crystal growth made production possible.
The HBT operating principle is the same as the silicon bipolar counterpart. 
Electrons move from the forward-biased emitter-base junction via a base region 
to a collector depletion region and then toward the collector contact, with a mini-
mum of recombination with holes. Reverse injection of holes from the base into 
the emitter is also minimized. Almost the entire emitter-base junction current is 
composed of electrons, independent on the relative doping densities on either side 
of the junction [36].
In contrast to conventional BJT, HBT bandgap difference between the emitter 
and the base material leads to higher common emitter gain. Base sheet resistance is 
lower than in ordinary BJTs, resulting in higher operating frequency [47]. In com-
parison with silicon BJT, HBT has a higher cutoff frequency (fT) and an early higher 

1.4  Device Technologies for High-Efficiency PA 
39
voltage, leading to higher output resistance, a lower base-emitter capacitance, a 
reduced base resistance, a higher breakdown voltage, and a reduction in capacitive 
coupling to the semi-insulating substrate.
Figure 1.35 is a simplified cross section of a typical HBT. The base and emitter 
have been formed by growing thin epitaxial layers and etching away the material 
to form a mesa structure. The base width can be very small and controlled by the 
thickness of the epitaxial layer, leading to high-speed transistors. To minimize the 
base resistance, the emitter is implemented as narrowly as possible, while the bar-
rier is created directly from the heterojunction. The current path is vertical so that 
the surface defects slightly affect the performance of the device. Furthermore, the 
use of a semi-insulating substrate and the higher electron mobility result in reduced 
parasitics.
However, because of the problems with defects at the interfaces, only NPN 
HBTs can be fabricated with acceptable device characteristics. The GaAs HBT pro-
cess often features backside vias to provide a low-inductance grounding connection 
from the top side of the die to the underlying ground plane. Unlike the HEMT 
device, an HBT technology requires only a single supply voltage. However, GaAs 
HBT processes are still relatively expensive compared to the CMOS process. In RF 
PA design, the main advantage of GaAs HBT with respect to HEMT devices is the 
higher linearity due to the base-emitter junction capacitance and its positive effect 
in reducing the intermodulation products [48].
1.4.2  CMOS 
Complementary metal oxide semiconductor (CMOS) field-effect transistors (FET) 
were invented in 1963 by Frank Wanlass at Fairchild Semiconductor. CMOS scal-
ing of the famous Moore’s law followed for over 50 years, and today billions of 
transistors on a single chip can be integrated. Moreover, CMOS has also become 
the cheapest semiconductor technology available today. The cost of SiGe technol-
ogy is roughly two to three times the cost of CMOS technology and the GaAs cost 
is about 5 to 10 times that of CMOS. CMOS technology is by far the dominant 
technology for digital integrated circuits and increasingly used in analog and RF 
circuits.
Figure 1.35  Illustration of a simplified cross-section of a typical GaAs HBT.

40 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
In recent years, GaAs HBT has been the most widely used technology for the 
production of RF PAs. However, CMOS technology is increasingly being consid-
ered as an alternative for implementing RF circuits including RF PAs. Superior RF 
performance can definitely be achieved with a dedicated RF technology such as 
GaAs and SiGe. However, the real strength of CMOS is the low cost and the inte-
gration possibility of digital signal processing to improve the performance of the 
RF front end. As already mentioned, CMOS in large volumes undoubtedly has a 
production cost advantage over other competing technologies.
Despite fundamental difference between the physics governing CMOS and 
GaAs HBTs, they can be employed in similar circuit architectures to achieve a given 
functionality. A parameter often reported when comparing transistors for RF appli-
cations is the cutoff frequency fT. The cutoff frequency is defined as the frequency 
in which the current gain of the transistor is extrapolated to fall to unity when 
the device is terminated with a small-signal short circuit. The cutoff frequency is a 
function of the bias current of a device.
In recent decades, CMOS gate lengths are shrunk and gate oxides have become 
much thinner. These advances are clearly the significantly increased fT and fmax of 
the silicon-based technologies to the point that their performance now rivals that 
of GaAs devices.
Modern CMOS technologies feature NMOS and PMOS transistors, on-chip 
RLC components, and up to greater than 10 interconnect metals layers. Unlike the 
GaAs HBT process, deep submicron CMOS technologies use a chemical polish-
ing to planarize the surface of the wafer at various manufacturing steps [38, 39]. 
The substrate in a CMOS technology is a semiconductor material with electrical 
conductivity that depends on the substrate doping level. In an epitaxial CMOS 
technology, a high-conductivity epitaxial layer is grown on top of the substrate. 
The GaAs substrate used in an HBT technology is semi-insulating, and hence, con-
ductivity is quite low compared to a silicon substrate.
Figure 1.36 shows a simplified schematic of an n-channel and p-channel metal 
oxide semiconductor field-effect transistor (MOSFET). For NMOS, the source and 
drain terminals are formed by heavily doped n-type diffusion regions. The third 
terminal, the gate, is usually a heavily doped polysilicon layer on the top of a thin 
silicon oxide grown above the substrate. The substrate forms a fourth terminal; for 
PMOS, the source and drain terminals are formed by heavily doped p-type diffu-
sion regions. The PMOS cell locates in a P-well, isolating from an n-type substrate.
If the voltage on the gate of an NMOS transistor increases, holes are pushed 
away from the surface of the substrate. If this process continues, the surface be-
comes depleted of holes and further increases beyond this voltage draws electrons 
from the source and drain regions to the region underlying the gate, creating an in-
version layer. This layer is a conductive channel in which current can flow between 
the drain and the source terminals. When a positive voltage is applied to the drain 
of an NMOS device, the charge accumulated in the channel becomes nonuniformly 
distributed across the channel, decreasing from the source to the drain, because the 
voltage available to invert the channel decreases as the drain is approached. As long 
as the conducting channel extends all the way to the drain, the transistor operates 
as a resistor whose values are a function of the gate-source voltage. Beyond a cer-
tain drain-source voltage, the inversion layer does not extend from source to drain, 
and the channel is said to be pinched off. Any increase beyond this point does not 

1.4  Device Technologies for High-Efficiency PA 
41
increase the channel charge and hence the current stays approximately constant. 
Further details on the physics of MOSFET transistors can be found in several semi-
conductor device physics references [37, 38].
Although some previous work has clearly demonstrated the potential of CMOS 
RF PA for 3G and 4G mobile applications, only a few commercial products can be 
found in this area due to more stringent specifications for performance. Most have 
been focused on Wi-Fi and Bluetooth applications. 
The CMOS PA clearly has lower PAE performance than most of GaAs HBT 
PAs at high-frequency bands. For a PA stage to achieve a given performance, the 
MOSFET output device required is almost always larger than its GaAs HBT coun-
terpart. This can be partly explained by the fact that the relation between the drain 
current and the gate-to-source voltage for an MOSFET device is at best a quadratic 
relation, degrading to a somewhat linear relationship for deep submicron devices, 
whereas the relation between the collector current and base-to-emitter voltage for 
an HBT is exponential. If the cutoff frequency of an HBT device is optimized for a 
given bias current, the transconductance is only a function of bias current and the 
device is sized to achieve the current density at which the device cutoff frequency is 
maximized. With the current state-of-the-art CMOS and GaAs HBT technologies, 
for a given bias current and transconductance, the optimized MOSFET device oc-
cupies an appreciably larger area compared to the optimized HBT device. 
However, another challenge of CMOS PA coming into general use is rugged-
ness, that is, its ability to survive under load mismatch while delivering rated out-
put power. Device breakdown voltage is of great importance in RF PA design. With 
the scaling of CMOS technologies to submicron dimensions, the breakdown volt-
age is scaled to relatively low voltages. This severely constrains the design of RF 
PAs, as the voltage on the drain of the output device in a PA can swing to more than 
twice the supply voltage. However, the device breakdown voltage is considerably 
larger in a GaAs HBT technology. The lower breakdown voltage of MOSFET de-
vices not only limits the supply voltage, but also results in reliability concerns such 
as long-term performance and the response to voltage surges in case of an antenna 
impedance mismatch.
Figure 1.36  Illustration of simplified schematic structure of a CMOS.

42 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
GaAs HBT process often feature backside vias to provide low inductance 
grounding connections for the circuit. However, in CMOS process, in which 
backside vias are typically not available, the grounding connections are provided 
through bonding wires to the package. The disadvantage of using bonding wires 
is their inductance, which is relatively large for RF applications. Hence, several 
bonding wires must often be used in parallel to reduce the parasitic inductance as-
sociated with the grounding connection. This can be essential to ensuring that the 
adequate gain, efficiency, and stability are achieved. The availability of the back-
side vias relaxes the circuit design trade-offs and can make an otherwise infeasible 
design possible. 
In spite of their drawbacks and difficulties, CMOS devices possess a number of 
advantages. They can be used to implement switches with very decent character-
istics, avoiding the turn-on and turn-off delays associated with the charge transfer 
in bipolar devices. This makes CMOS devices good candidates for implementation 
of switch-mode PAs. Because the relationship between the drain current and the 
gate overdrive voltage is at best quadratic, and more typically linear, for submicron 
CMOS technologies, MOSFET transistors generally exhibit more linear behavior 
compare to exponential bipolar devices. The lower output harmonic content result-
ing from the use of a MOSFET can relax the filtering requirements imposed on the 
subsequent stages.
1.4.3  Si-LDMOS
Silicon laterally double diffused MOSFET (Si-LDMOS) transistor is widely used 
in high-power PA below 3 GHz for infrastructures. For high-power wireless ap-
plications such as BTS, unlike the battle taking place in the mobile UE market, the 
situation is essentially reversed. Here the overwhelmingly dominate technology is 
Si-LDMOS with about 95% market share today. Si-LDMOS is an enhanced MOS-
FET structure especially suited for high-power applications. The main reasons are 
the maturated technology in terms of fabrication, the low cost, and the reliability of 
silicon, combined with good performance. The cross-sectional view of a Si-LDMOS 
is shown in Figure 1.37. 
In an Si-LDMOS, as in a MOSFET, there are two n+ regions for the source and 
the drain, respectively. The most noticeable difference as compared to a MOSFET 
is in the low doped and quite long n-drift region realized in the LDMOS, which 
enhances the depletion region. Si-LDMOS has low doped and long n-type drift 
regions, which enhances the depletion region and increases the breakdown volt-
age. However, the on-resistance is high, which increases the losses and degrades 
the RF performance [43]. Therefore, there is always a trade-off between RF output 
power and on-resistance. Short channel length is created by laterally diffused p-
type implantation, which increases the operating frequency. However, this feature 
increases the linearity since the electrons always transport in the saturation veloc-
ity. Applying a positive voltage to the gate, a conductive channel in the p-base re-
gion is created. The channel being very short, the device transistor always operates 
in the saturated velocity region, thus further improving device linearity [49, 50]. 
Electrons with saturation velocity at the channel move in the doped n-drift region 
to reach the drain.

1.4  Device Technologies for High-Efficiency PA 
43
As shown in Figure 1.37, the sinker principle is used to connect the source to 
the substrate backside, which reduces the source inductance; hence, the gain in-
creases. The sinker also makes the device integration much easier. The Si-LDMOS 
is especially useful at UHF and RF below 3 GHz, as the direct grounding of its 
source eliminates bonding wire inductance that produces negative feedback and 
reduces gain at high frequencies. 
1.4.4  GaN HEMT
While GaN has made inroads to many microwave PA applications such as military, 
GaN PAs for wireless communications have been the Holy Grail for quite some 
time. In recent years, there has been research touting the latest GaN PA that is going 
to nudge out Si-LDMOS. While there has been good market penetration of GaN 
PAs for 4G LTE-A applications, it still faces challenges in being broadly deployed in 
the telecommunication industry, in particular, for BTS applications.
The main reason for this is that, for the same output power, GaN HEMTs are 
smaller than conventional silicon or GaAs devices. The high-power density of these 
GaN devices enables the reduction of the total gate width required or the number 
of units cells connected in parallel. The reduced sizes also imply that the devices 
have higher input and output impedances, which makes matching network design 
relaxed.
The key desirable semiconductor material properties for high-power and high-
frequency transistors include large bandgap, high breakdown voltage, high electron 
velocity and mobility, high sheet charge density, and high thermal conductivity. Fig-
ure 1.38 shows these material properties for GaN and other competing semicon-
ductor materials. In this figure, the electron mobility listed under the column GaAs 
and GaN is for AlGaAs and GaN heterostructures.
The significance of these material parameters for the power and speed of de-
vice capabilities can be summarized as follows. The wide energy bandgap and high 
critical electric field enable high terminal voltage operation of the transistor. This 
is essential for high RF power generation [51–53]. The electron transport proper-
ties such as electron mobility and saturation velocity determine its high-frequency 
Figure 1.37  Si-LDMOS cross section illustrating key features, including topside gate and drain 
connections and a backside source. The Si-LDMOS transistor is a modified device of the MOSFET to 
enhance the high-power capability. (From: [76]. © 2003 Artech House. Reprinted with permission.)

44 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
characteristics. The high sheet charge density of two-dimensional electron gas (2-
DEG) in GaN HEMT is one of its peculiar useful properties for maintaining high 
current densities. Superior thermal conductivity is very essential for power transis-
tors to avoid performance degradation with increased channel temperature. More-
over, GaN devices can operate at much higher ambient temperature than silicon 
counterparts. Experiments have shown that a GaN transistor is amplifying well at 
an ambient temperature of 300°C while silicon transistors stop working at about 
140°C [53]. The relatively lower dielectric constant of wide bandgap semiconduc-
tors permits a solid-state device to be larger in area for a specified impedance level 
[52]. This, in turn, helps larger RF currents and power to be generated. The low 
dielectric constant also means low capacitive loading of a device [52], reducing 
the parasitic delay contributions to the total delay time [51] in GaN HEMT. These 
and other relationships between material properties, device figures of merit, and 
system-level advantages are summarized in Figure 1.39.
In general, the main disadvantage of wide bandgap semiconductors is their 
low-charge carrier mobility [51]. However, the mobility of both 4H-SiC and 2-DEG 
AlGaN/GaN heterostructures are adequate for fabrication of high performance 
transistors [52].
SiC MESFETs are also suited for high-temperature and high-voltage opera-
tion due to their natural properties. The fabrication technology of SiC MESFETs 
is more mature than GaN HEMTs but they lack heterojunction and hence the low 
electron mobility places limitation for high-frequency application despite their high 
saturation velocity. 
The recent advances in developing RF power transistors using wide bandgap 
GaN material demonstrates high output power, power density, efficiency, and lin-
earity at high frequencies because the technologies currently in use for RF PA design 
such as Si-LDMOS are reaching their limits [54]. The main constraint of Si-LDMOS 
is their operating frequency range, which is limited to about 4 GHz. However, since 
the invention of high electron mobility transistors (HEMT) in 1980, the processing 
Figure 1.38  Comparisons of GaN and other competing semiconductor material properties.

1.4  Device Technologies for High-Efficiency PA 
45
technology has progressed significantly. Until recently, the most promising of new 
device process technologies is GaN HEMTs with power densities up to 30 W/mm 
on SiC substrates [55] and 12 W/mm on silicon substrates [57]. Although much 
research is typically done on small-size devices and typical power densities are 2 to 
5 W/mm for larger devices, they indicate an improvement by factor of more than 
10 in power densities as compared to other material technologies based on GaAs 
or silicon.
The input and output impedances of GaN HEMT devices is also large due to 
their high power densities, which translates into simplifying the matching design of 
RF PAs for broadband and high-power applications. However, the technology of 
processing GaN HEMTs is still not sufficiently mature. Some issues such as drain 
current collapse, reliability, and appropriate packaging for thermal management 
remain to be solved consistently. Current collapse is the reduction of the drain cur-
rent due to trapping effects. This effect can be observed when operating under RF 
excitation. Therefore, devices with substantial current collapse would have reduced 
RF output power due to the reduced RF current and voltage swings. Furthermore, 
because the power density per chip is high for GaN HEMT devices, good ther-
mal management in conjunction with appropriate packaging technologies is also 
very important. The major obstacle in fabrication of GaN HEMTs is the lack of 
a suitable substrate, which is lattice-matched and thermally compatible material 
with GaN. Bulk GaN substrates are not commercially available, and hence, silicon 
Figure 1.39  Device and system-level performance advantages of using wide bandgap materials for power 
transistors.

46 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
carbide (SiC), sapphire (Al2O3), or silicon (Si) substrates are used instead, as shown 
in Figure 1.40.
The basic concept in an HEMT is the aligning of a wide and narrow band-
gap semiconductor adjacent to each other to form a heterojunction. Specifically, 
in GaN HEMTs, the carriers from a doped wide energy gap material (AlGaN) 
diffuse to the narrow bandgap material (GaN) where a dense 2-DEG is formed 
in the GaN side but close to the boundary with the AlGaN. The Fermi energy of 
this thin layer is above the conduction band, thereby making the channel highly 
conductive. The ratio of aluminum to gallium in AlGaN is typically 30% Al and 
70% Ga. The resulting the compound semiconductor has a higher-energy bandgap 
and different material properties from GaN. In a typical modulation-doped GaN 
HEMT structure, an intentionally doped AlGaN donor layer supplies electrons to 
the 2-DEG. The 2-DEG is formed at the GaN interface even if all the layers are 
grown without intentional doping [60]. However, the donor layer can also be a 
not intentionally doped AlGaN layer [61]. Comparing modulation-doped devices 
with undoped ones, the former exhibits improved DC performance but has reduced 
electron saturation velocity if the doping is too high [62]. This reduction in electron 
saturation velocity with high carrier supply doping degrades the RF performance 
of the device.
References
[1]	
Lucyszyn, S., “Power-Added Efficiency Errors with RF Power Amplifiers,” International 
Journal of Electronics, Vol. 82, No. 3, March 1997, pp. 303–312.
[2]	
Larson, L., P. Asbeck, and D. Kimball, “Next Generation Power Amplifiers for Wireless 
Communications-Squeezing More Bits Out of Fewer Joules,” IEEE Radio Frequency Inte-
grated Circuits Symposium, 2005, pp. 417–420.
[3]	
Cripps, S. C., RF Power Amplifiers for Wireless Communications, Norwood, MA: Artech 
House, 2006.
[4]	
Walker, J. L. B., Handbook of RF and Microwave Power Amplifiers, New York: Cambridge 
University Press, 2012.
Figure 1.40  Illustration of the simplified schematic structure of an AlGaN/GaN HEMT.

1.4  Device Technologies for High-Efficiency PA 
47
[5]	
Grebennikov, A., and N. O. Sokal, Switchmode RF Power Amplifiers, London, UK: 
Newnes, 2007.
[6]	
Kazimierczuk, M. K, RF Power Ampliﬁers, New York: Wiley, 2008.
[7]	
Sokal, N. O., and A. D. Sokal, “Class-E – A New Class of High-Efficiency Tuned Single-
Ended Switching Power Amplifiers,” IEEE Journal of Solid-State Circuits, Vol. SC-10, June 
1975, pp. 168–176.
[8]	
Mury, T., and V. F. Fusco, “Series-L/Parallel-Tuned Class-E Power Ampliﬁer Analysis,” 
Proc. 35th European Microwave Conf. (EuMC05), Paris, France, October 2005, pp. 
449–452.
[9]	
Wilkinson, A. J., and J. K. A. Everard, “Transmission-Line Load Network Topology for 
Class-E Power Ampliﬁers,” IEEE Transactions on Microwave Theory and Techniques, Vol. 
49, No. 6, June 2001, pp. 1202–1210.
[10]	
Brabetz, T., and V. F. Fusco, “Voltage-Driven Class-E Ampliﬁer and Applications,” Proc. 
IEE Microwave Antennas Propagation, Vol. 152, No. 5, October 2005, pp. 373–377.
[11]	
Mury, T., and V. F. Fusco, “Sensitivity Characteristics of Inverse Class-E Power Ampliﬁer,” 
IEEE Transactions on Circuits Syst. I, Reg. Papers, Vol. 54, No. 4, 2007, pp. 768–778.
[12]	
Raab, F. H., “Class-E, Class-C, and Class-F Power Amplifiers Based Upon a Finite Number 
of Harmonics,” IEEE Transactions on Microwave Theory and Techniques, Vol. 49, No. 8, 
August 2001, pp. 1462–1468.
[13]	
Colantonio, F., et al., “High Frequency Class-E Design Methodologies,” IEEE Conference 
in Gallium Arsenide and Other Semiconductor Application European Symposium, Paris, 
France, 2005, pp. 329–332.
[14]	
Kee, S., et al, “The Class-E/F Family of ZVS Switching Amplifiers,” IEEE Transactions on 
Microwave Theory and Techniques, Vol. 51, No. 6, June 2003, pp. 1677–1690.
[15]	
Kim, J., et al, “Saturated Power Amplifier Optimized for Efficiency Using Self-Generated 
Harmonic Current and Voltage,” IEEE Transactions on Microwave Theory and Tech-
niques, Vol. 59, No. 8, August 2011, pp. 2049–2058.
[16]	
Kim, B., J. Moon, and J. Kim, “Highly Efficient Saturated Power Amplifier Based on GaN 
- A Class-P Amplifier,” IEEE MTT-S Int. Microwave Symp. Dig., May 2010.
[17]	
Moon, J., J. Kim, and B. Kim, “Investigation of a Class-J Power Amplifier with a Nonlinear 
Cout for Optimized Operation,” IEEE Transactions on Microwave Theory and Techniques, 
Vol. 58, No. 11, November 2010, pp. 2800–2811.
[18]	
Sinclair, I. R., Audio and Hi-Fi Handbook, 3rd ed., New York: Newnes, 1998.
[19]	
Samulak, A., “System Analyses of Class-S Power Amplifier,” Ph.D. Dissertation, 2010.
[20]	
Doherty, W. H., “A New High Efficiency Power Amplifier for Modulated Waves,” Proc. 
IRE, Vol. 24, No. 9, September 1936, pp. 1163–1182.
[21]	
Zhu, X., J. Wang, and Z. Liao, “Efficiency-Enhanced Inverted Doherty Power Amplifier 
with Class-E Peaking Amplifier,” 2010 International Symposium on Signals Systems and 
Electronics (ISSSE), Vol. 2, 2010, pp. 1–3.
[22]	
Kim, M., et al., “The Efficiency Improvement of a Compact Inverted Doherty Amplifier 
Using Bias Line Adjustment,” Microwave Conference, APMC, 2007, pp. 1–4.
[23]	
Stengel, R. F., “High Efﬁciency Power Ampliﬁer Having Reduced Output Matching Net-
works for Use in Portable Devices,” U.S. Patent 6 262 629 B1, July 17, 2001.
[24]	
Krvavac E., et al., “Inverted Doherty Amplifier with Increased Off-State Impedance,” U.S. 
Patent 7 521 995 B1, April 21, 2009.
[25]	
Neo, W. C. E., et al., “A Mixed-Signal Approach Towards Linear and Efficient N-Way 
Doherty Amplifiers,” IEEE Transaction on Microwaves Theory and Techniques, Vol. 55, 
No. 5, May 2007, pp. 866–879.
[26]	
Srirattana, N., et al., “Analysis and Design of a High-Efficiency Multistage Doherty Power 
Amplifier for Wireless Communications,” IEEE Transactions on Microwave Theory and 
Techniques, Vol. 53, No. 3, March 2005, pp. 852–860.

48 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
[27]	
Pelk, M. J., et al., “A High-Efficiency 100-W GaN Three-Way Doherty Amplifier for Base-
Station Applications,” IEEE Transactions on Microwaves Theory and Techniques, Vol. 56, 
No. 7, July 2008, pp. 1582–1591.
[28]	
Raab, F. H., “Efficiency of Doherty RF Power-Amplifier Systems,” IEEE Transactions on 
Broadcasting, Vol.BC-33, No. 3, September 1987, pp. 77–83.
[29]	
Koch, M. J., and R. E. Fisher, “A High Efficiency 835 MHz Linear Power Amplifier for 
Digital Cellular Telephony,” IEEE Vehicular Technology Conference, Vol. 1, May 1989, 
pp. 17–18.
[30]	
Funk, G. D., and R. H. Johnston, “A Linearized 1 GHz Class-E Amplifier,” IEEE Transac-
tions on Circuits and Systems, Vol. 3, 1996, pp. 1355–1358.
[31]	
Cox, D. C., “Linear Amplification Using Non-Linear Components,” IEEE Transactions on 
Communications, Vol. COM-22, December 1974, pp. 1942–1945.
[32]	
Hetzel, S. A., A. Bateman, and J. P. McGeehan, “A LINC Transmitter,” Electronics Letters, 
Vol. 27, No. 10, May 1991, pp. 133–137.
[33]	
Raab, F. H., “Intermodulation Distortion in Kahn-Technique Transmitters,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 44, No. 12, December 1996, pp. 
2273–2278.
[34]	
Raab, F. H., and D. J. Rupp, “High-Efficiency Multimode HF/VHF Transmitter for Com-
munications and Jamming,” IEEE Military Communications Conference, Vol. 3, 1994, pp. 
880–884.
[35]	
Shirvani, A., and B. A. Wooley, Design and Control of RF Power Amplifiers, Boston, MA: 
Kluwer Academic Publishers, 2003.
[36]	
Houston, P. A., “High-Frequency Heterojunction Bipolar Transistor Device Design and 
Technology,” Electronics & Communication Eng. Journal, 2000, pp. 220–228.
[37]	
Pierret, R. F., Semiconductor Device Fundamentals, Reading, MA: Addison-Wesley, 1996.
[38]	
Plummer, J. D., M. D. Deal and P. B. Griffin, Silicon VLSI Technology: Fundamentals, Prac-
tice, and Modeling, Upper Saddle River, NJ: Prentice Hall, 2000.
[39]	
Steigerwald, J., S. Muraka and R. Gutmann, Chemical Mechanical Planarization of Micro-
electronic Materials, New York: John Wiley & Sons, 1997.
[40]	
Lee, T. H., The Design of CMOS Radio Frequency Integrated Circuits, Cambridge, U.K.: 
Cambridge University Press, 1998.
[41]	
Blalack, T., et al., “Experimental Results and Modeling of Noise Coupling in a Lightly 
Doped Substrate,” Int. Electron Devices Meeting. Tech. Digest, December 1996, pp. 
623–626.
[42]	
Xu, M., et al., “Measuring and Modeling the Effects of Substrate Noise on the LNA for 
a CMOS GPS Receiver,” IEEE Journal of Solid-State Circuits, Vol. 36, March 2001, pp. 
473–485.
[43]	
Syed, A., “Large Signal Physical Simulations of Si LD-MOS Transistor for RF Applica-
tion,” Ph.D. dissertation, Dept. of Physics, Linköping University, 2004.
[44]	
Weitzel, C., “Will GaAs Survive for Wireless PA’s?” Proceedings of CS-MANTECH, 2005, 
pp. 11–14.
[45]	
Grinder, D., et al., “Manufacturable GaN HEMT RF Power Technology for Wireless Infra-
structure Applications,” Proceedings of CS-MANTECH, 2004, pp. 1–2.
[46]	
Vetury, R., “Access Available via File Cabinet Subscription High Power, High Efficiency, Al-
GaN/GaN HEMT Technology for Wireless Base Station Applications,” 2005 IEEE MTT-S 
International Microwave Symposium Digest, 2005, pp. 1–4.
[47]	
Sze, S. M., Semiconductor Devices Physics and Technology, New York: John Wiley & 
Sons, 2001.
[48]	
Oki, A. K., et al., “Future Trends of HBT Technology for Commercial and Defense Ap-
plications,” IEEE MTT-S Symposium on Technologies for Wireless Applications Digest, 
February 1997, pp. 123–125.

1.4  Device Technologies for High-Efficiency PA 
49
[49]	
Vestling, L., et al., “A Novel High-Frequency High-Voltage Transistor Using an Extended 
Gate RESURF Technology,” IEEE International Symposium on Power Semiconductor De-
vices and IC’s, May 1997, pp. 45–48.
[50]	
Olsson, J., et al., “1 W/mm RF Power Density at 3.2 GHz for a Dual-Layer RESURF LD-
MOS Transistor,” IEEE Electron Device Letters, Vol. 23, No. 4, April 2002, pp. 206–208.
[51]	
Golio, J. M., et al., RF and Microwave Semiconductor Device Handbook, Boca Raton, FL: 
CRC Press, 2003. 
[52]	
Trew, R. J., “Wide Bandgap Semiconductor Transistors for Microwave Power Amplifiers,” 
IEEE Microwave Magazine, Vol. 1, March 2000, pp. 46–54. 
[53]	
Eastman, L. F., and U. K. Mishra, “The Toughest Transistor Yet,” IEEE Spectrum, Vol.18, 
No. 3, May 2002, pp. 28–33.
[54]	
Nagy, W., “Linearity Characteristics of Microwave-Power GaN HEMTs,” IEEE 
Transactions on Microwave Theory and Techniques, Vol. 51, No. 2, February 2003, pp. 
660–664. 
[55]	
Wu, Y. F., et al., “30-W/mm GaN HEMTs by Field Plate Optimization,” IEEE Electron 
Device Letters, Vol. 25, No. 3, March 2004, pp. 117–119. 
[56]	
Chu, K. K., et al., “9.4-W/mm Power Density AlGaN-GaN HEMTs on Free-Standing GaN 
Substrates,” IEEE Electron Device Letters, Vol. 25, No.9, September 2004, pp. 596–598. 
[58]	
Chini, A., et al., “12 W/mm Power Density AlGaN-GaN HEMTs on Sapphire Substrates,” 
Electronics Letters, Vol. 40, No. 3, January 2004, pp. 73–74. 
[59]	
Wakejima, A., et al., “370 W Output Power GaN-FET Amplifier for W-CDMA Cellular 
Base Stations,” Electronics Letters, Vol. 41, No.25, December 2005, pp. 1371–1373.
[60]	
Asbeck, P. M., et al., “Piezoelectric Charge Densities in AlGaN/GaN HFETs,” Electronics 
Letters, Vol. 33, No. 14, 1997, pp. 1230–1231. 
[61]	
Binari, S. C., et al., “Trapping Effects and Microwave Power Performance in AlGaN/GaN 
HEMTs,” IEEE Trans. Electron Devices, Vol. 48, No. 3, March 2001, pp. 465–470. 
[62]	
Marso, M., et al., “Influence of Carrier Supply Doping on the RF Properties of AlGaN/
GaN/SiC High-Electron-Mobility Transistors,” Phys. Stat. Sol. (c), Vol. 2, No. 7, 2005, pp. 
2611–2614.
[63]	
Bumman, K., M. Junghwan, and K. Ildu, “Efficiently Amplified,” IEEE Microwave 
Magazine, Vol. 11, No. 5, August 2010, pp. 87–100.
[64]	
Li, Y., “System and Circuits Investigation of Wideband RF Polar Transmitters Using Enve-
lope Tracking for Mobile WiMAX/WiBRO Applications,” Master of Science Thesis, Elec-
trical Engineering, Texas Tech University, Texas, 2009.
[65]	
Brabetz, T., and V. F. Fusco, “Voltage-Driven Class-E Amplifier and Applications,” IEEE 
Proc. Microwaves, Antennas and Propagation, Vol. 152, No. 5, October 2005, pp. 
373–377. 
[66]	
Mury, T., and V. F. Fusco, “Inverse Class-E Amplifier with Transmission-Line Harmonic 
Suppression,” IEEE Transactions on Circuits Systems I, Regular Papers, Vol. 54, No. 7, 
July 2007, pp. 1555–1561. 
[67]	
Tyler, V., “A New High-Efficiency High Power Amplifier,” Marconi Review, Vol. 21, Fall 
1958, pp. 96–109.
[68]	
Wei, C., et al., “Analysis and Experimental Waveform Study on Inverse Class Class-F Mode 
of Microwave Power FETs,” 2000 IEEE MTT-S International Microwave Symposium Di-
gest, Vol. 1, 2000, pp. 525–528.
[69]	
Snider, D. M., “A Theoretical Analysis and Experimental Confirmation of the Optimally 
Loaded and Overdriven RF Power Amplifiers,” IEEE Transactions on Electron Devices, 
Vol. 14, No. 6, June 1967, pp. 851–857.
[70]	
Raab, F. H., “Introduction to Class-F Power Amplifiers,” RF Design, Vol. 19, No. 5, May 
1996, pp. 79–84.
[71]	
Smith, R. M., et al., “A 40W Push-Pull Power Amplifier for High Efficiency, Decade Band-
width Applications at Microwave Frequencies,” IEEE MTT-S Int. Microw. Symp. Digest, 
2001, pp. 1–3.

50 
�������������������������������������������������������
High-Efficiency Power Amplifier Architectures and Devices
[72]	
Kim, J., et al., “A Novel Design Method of Highly Efﬁcient Saturated Power Ampliﬁer 
Based on Self-Generated Harmonic Currents,” IEEE European Microwave Conference 
(EuMC), September 2009, pp. 1–4.
[73]	
Moon, J., et al., “Highly Efficient Saturated Power Amplifier,” IEEE Microwave Magazine, 
Vol. 131, 2012, pp. 125–131.
[74]	
Zhang, X. J., L. E. Larson, and P. M. Asbeck, Design of Linear RF Outphasing Power 
Ampliﬁers, Norwood, MA: Artech House, 2003.
[75]	
Gilmore, R., and L. Besser, Practical RF Circuit Design for Modern Wireless Systems, Vol-
ume II: Active Circuits and Systems, Norwood, MA: Artech House, 2003.
[76]	
Pedro, J. C., and N. B. Carvalho, Intermodulation Distortion in Microwave and Wireless 
Circuits, Norwood, MA: Artech House, 2003.

51
C H A P T E R  2
Envelope Tracking Power Amplifier Basics
The ET PA achieves high efficiency for amplification of a signal with a high PAPR. 
Furthermore, it is relatively flexible for multimode multiband (MMMB) operations. 
Therefore, the ET technique is quite powerful for both infrastructure BTS and mo-
bile UE PAs. As the technique develops further, it has been widely engaged in PAs 
for next generation systems.
2.1  Introduction
The efficiency advantage of operating a PA in ET mode is commonly acknowl-
edged. The ET technique is designed to efficiently amplify a modulated signal with 
high PAPR through supply modulation following a shaped envelope of the modu-
lated signal. However, it provides additional beneficial system assistances, such as 
increased output power, enhanced operation into mismatched loads, and immunity 
to temperature variations. Compared to fixed DC supply counterparts, the perfor-
mance of an ET PA is not self-contained and involves comprehensively joint circuits 
in mutual acts to guarantee superior system performance.
In this chapter, a broad range of ET basic knowledge has been consolidated 
into an ET pyramid-oriented concept and has been well investigated, including ef-
ficiency, bandwidth, linearity, and power capacity notions. The introduction of the 
characteristics of ET PA both in theory and practice will provide profound knowl-
edge and understanding of the efﬁciency improvements of the overall ET system 
with respectable linearity performance.
2.1.1  Motivation for ET
With the surge of data services in emerging 4G and beyond, modern wireless com-
munication evolution has employed highly spectrum-efficient digital modulation 
schemes. However, they impose stringent linearity requirements on RF transmitters 
for BTS and mobile UE applications. In other words, a number of challenges for 
efficient PA implementation arise with the growing PAPR, broadband performance, 
and rigorous linearity requirements. As one of the most promising solutions, ET 
PA has evoked extensive concentration due to highly efficient operation over broad 
power range and its frequency agility to handle the band fragmentation in the 4G 
system and beyond.

52 
���������������������������������������
Envelope Tracking Power Amplifier Basics
As we know, advanced wireless communications demand higher data through-
puts. High modulation rates are achieved based on complex digital modulation 
schemes such as quadrature amplitude modulation (QAM) or orthogonal frequen-
cy division multiplexing (OFDM). However, this results in signals with ever-in-
creasing PAPR even more than 10 dB. Furthermore, these high-PAPR signals need 
to be backed off significantly from the peak power level of the RF PA, leading to 
poor average efficiency. ET is a well-known methodology in which the power sup-
ply voltage applied to the RF PA is constantly adjusted to guarantee its operation at 
peak efficiency over wide output power range because the RF PA can operate under 
compression at almost all power levels [1–3].
In contrast, the conventional fixed DC supply PA has a significant amount of 
power loss as heat dissipation. The ET technique cuts the amount of power dissi-
pated as heat by modulating the supply voltage to track the envelope of the signal, 
as presented in Figure 2.1.
Figure 2.1  Traditional fixed DC supplied RF PA compared to ET amplification. ET sets the PA supply 
voltage to align with the RF amplitude modulation to operate the PA near its maximum saturated 
efficiency, dramatically enhancing the time-varying efficiency of the PA and increasing linear peak 
output power as well.

2.1  Introduction 
53
2.1.2  ET Pyramid
Although ET is the most promising high-efficiency PA architecture for next genera-
tion wireless communications, it is not commonly deployed commercially either in 
BTS or UE PAs because the essential design factors are difficult to implement at one 
fell swoop. ET is struggling to make a decent trade-off among key figures of merit 
in the ET metric pyramid, as illustrated in Figure 2.2.
The pyramid indicates the philosophy of the ET system design. The pyramid 
consists of efficiency, linearity, broadband, and power-handling capability as four 
tenable vertexes. They reveal the difficulties of compromising into a balance point. 
Generally speaking, the metric vertexes provide stimulating design requirements 
for researchers and engineers to achieve commercial ET products for next genera-
tion wireless communication.
First, the efficiency difficulties are the most evident. It entails both a high-effi-
ciency envelope supply modulator (e.g., with more than 80% efficiency) and high 
peak efficiency RF PA design (e.g., harmonic-termination nonlinear mode PAs) to 
achieve overall highly efficient ET design together. For example, RF designers al-
low the utilization of nonlinear classes of PA to further push peak efficiency (e.g., 
with more than 85% peak efficiency). However, things will get worse before they 
get better. The trade-off battle between efficiency and linearity is becoming tougher 
even with modern linearization methods.
Second, the broadband vertex typically means high-power supply modulator 
bandwidth besides that of RF PA. As a rule of thumb, the supply modulator re-
quires at least three times the RF channel bandwidth to provide an acceptable 
linear amplification of envelope. 
Third, linearity and low noise requirements for ET system not only mean little 
RF PA decoupling but also all distortion and interference generated from envelope 
supply modulator. This should be prevented either into antenna via modulation or 
into receiver chain in frequency division duplex (FDD) application scenarios.
Finally, various power-handling capacities are strongly desired by different ET 
application circumstances. This determines the architecture of the ET system and 
the strategy to accommodate it into commercial products. It is well known that 
ET is promising for both efficiency and frequency agility in existing and emerging 
wireless standards, including UE, BTS, and broadcasting. Therefore, the power 
Figure 2.2  Envelope tracking merit pyramid with efficiency, broadband, linearity, and power as its 
four key vertexes for overall system performance and implementation trade-off for various applica-
tion scenarios. The vertexes are the key factors to the ET dilemma between theory and practice.

54 
���������������������������������������
Envelope Tracking Power Amplifier Basics
level ranges rather wide to cover from <1W to >1 kW. Because of this, there is no 
omnipotent ET design existing for the diverse power levels and scenarios. For ex-
ample, high power brings obstacles to implementing an agile power supply generat-
ing fairly high slew rate current and voltage and, of course, accompanied by thorny 
thermal issues. However, in UE applications, most PAs are directly connected to 
the antenna through an RF switch or filter network. It indicates that RF PA output 
power and efficiency are directly tied to the quality of the impedance matching 
between the output of the PA and the input of the antenna or the filter network  in 
front-end module.
Therefore, based on the ET pyramid analysis, it is not a solo play of RF/mi-
crowave technology any longer but a tough battle to key merit trade-offs involv-
ing factors such as new compound semiconductor technology, supply modulator 
design, and baseband algorithm and processing.
2.2  Principle of ET
To begin with, in traditional supply modulation PA architectures, the dominant 
cousins are EE&R and ET. Both topologies take advantage of the envelope to 
modulate the supply voltage for the RF PA to grow back-off efficiency. EE&R is 
typically referred as a polar transmitter based on the split of the phase modulation 
(PM) and the amplitude modulation (AM) into separate branches. However, the 
ET technique can be understood as a wise simplification of the EE&R technique. 
Rather than examine both the PM and AM information, only the AM information 
is extracted. Therefore, the RF PA operates in the linear region and its supply volt-
age alters according to the AM information. However, the supply voltage needs to 
be varied with adequate headroom to reduce distortion to the minimum possible 
amount. With the available headroom, carrying out an ET PA could be achieved 
without the tremendous effort as an EE&R counterpart because the ET timing 
matching is not as critical as that in EE&R. The block diagram and principle of an 
ET PA are presented in Figure 2.3. 
Figure 2.3  Block diagram of a classical envelope tracking power amplifier with analog envelope 
generation scheme and RF delay for branch timing alignment for principle illustration. The envelope 
path, supply modulator, and RF PA form a feedforward network. Together they form an ET PA with 
transfer characteristics that are different from the original RF PA alone. (From: [1]. © 2006 Artech 
House. Reprinted with permission.)

2.2  Principle of ET 
55
In contrast, the major weakness in ET in contrast to EE&R is its lower effi-
ciency due to PA operation in the linear region instead of the compression region 
in the former. Also, operating with enough headroom can reduce the power output 
capability of the ET PA. Finally, the gain of the ET PA reduces when the supply 
voltage decreases. However, similar but lower than the requirement for EE&R 
technique, the ET PA needs a dynamic supply modulator circuit with a modulation 
bandwidth times wider than the bandwidth of the RF signal. A spectral analysis 
proves that the bandwidth of the supply voltage waveform is at least three times 
more than that of the RF waveform. The high bandwidth requirement stems from 
the two main reasons that ET supply voltage is a function of RF magnitude and 
the clipping effect occurs due to the lower bounds imposed by an envelope shap-
ing functions. For broadband scenarios, the absence of an efficient dynamic supply 
modulator circuit is the main obstacle to ET implementation.
2.2.1   Signal Definition
With the intention of exploring ET principle in detail, the signal has to be defined 
first. Any baseband signal BB(t) can be expressed by its in-phase (I) and quadra-
ture-phase (Q) components, along with its amplitude or envelope E(t) and phase 
Φ(t) components, 
	
( )
( )
( )
( )
( )
j
⋅
=
+ ⋅
=
⋅
j
t
BB t
I t
j Q t
E t
e
	
(2.1)
The signal transmitted via the RF PA is the real component of the RF signal, 
presented as S(t), 
	
( )
( )
( )
{
}
( )
( )
{
}
j
ω
⋅
⋅
⋅
=
⋅Φ
=
⋅
⋅
Re
Re
c
j
t
j
t
S t
E t
t
E t
e
e
	
(2.2)
where 
ω
⋅
⋅
c
j
t
e
 denotes the carrier signal from local oscillator (LO) and the RF phase 
signal Φ(t) is expressed as
	
( )
( )
j
ω
⋅
⋅
Φ
=
⋅
.
c
j
t
j
t
t
e
e
	
(2.3)
At this point, E(t) is the envelope of the RF signal and can be interpreted as 
	
( )
( )
( )
( )
=
=
+
2
2
E t
BB t
I t
Q t
	
(2.4)
and the phase of the baseband signal is enclosed in
	
( )
( )
(
)
( )
( )
j


=
=




arg
arctan Q t
t
BB t
I t
	
(2.5)
Procedures of the ET operation are described with reference to Figure 2.3, 
where a modulated RF signal Sin(t) is injected into an RF PA. With the assumption 
that Sin(t) is narrowband, it can be expressed in terms of amplitude and phase com-
ponents taking the form

56 
���������������������������������������
Envelope Tracking Power Amplifier Basics
	
( )
( )
( )
{
}
( )
( )
(
)
j
ω
ω
j
⋅
⋅
⋅
=
⋅
⋅
=
⋅
⋅+
Re
cos
in
c
j
t
j
t
in
in
in
c
in
S
t
E
t
e
e
E
t
t
t
	
(2.6)
where Ein(t) denotes the envelope of Sin(t) and Φin(t) describes the phase character-
istics of Sin(t).
In addition to the main RF signal branch, envelope signal Ein(t) is spawned by 
an envelope generator, amplified via a highly efficient supply modulator, and finally 
applied as the RF PA supply bias voltage Vsm(t). The supply modulator is inherently 
a high-efficiency power amplifier with decent bandwidth requirements across enve-
lope frequencies. Because the generated envelope signal is time-varying, the supply 
bias is likewise time-varying.
2.2.2  ET Efficiency
Accordingly, the supply bias voltage is such that the RF PA is in a compression re-
gion, which brings about efficient amplification. Let us keep in mind again that the 
whole ET PA system maintains high efficiency only if both the supply modulator 
and RF PA are highly efficient. Assume that the DC power into the RF PA is the 
product of the average supply modulated voltage 
( )
sm
V
t  and average supply current 
( )
sm
I
t . Contrary to fixed DC supply RF PA operating at VDC, 
( )
sm
V
t  can be consider-
ably smaller than VDC, especially when the RF signal reveals a high PAPR. Because 
( )
( )
( )
,
sm
sm
sm
DC
I
t V
t
I
t V
⋅
<
⋅
 the ET PA is far more efficient under output power back-
off scenarios for the same reason. By virtue of this, it is particularly imperative for 
extended battery life in UE radios that function for substantial periods of time with 
decreased transmit power levels.
2.2.3  Design Considerations
To achieve respectable spectral linearity, it is vital that the PA can reliably duplicate 
the time-varying amplitude and phase characteristics of the RF input signal at its 
output. Denoting the output signal as
	
( )
( )
(
)
(
)
ω
j
j∆
=
⋅
⋅+
+
cos
out
out
c
in
S
t
E
t
t
	
(2.7)
The linearity requirements from system perspective determine that
	
( )
( )
=
out
sm
in
E
t
G
E
t 	
(2.8)
where Gsm is the gain or transfer function of the supply modulator system and 
Eout(t) denotes the envelope of output RF signal. The output phase equals to the 
sum of input phase jin and a phase offset j∆, which indicates the phase error be-
tween input and output signals, excluding the amplitude and timing variances.
To eliminate spectral distortion to the minimum possible amount, several 
design considerations must be well thought out, including the bandwidth of the 

2.3  Instantaneous Efficiency of PA 
57
envelope supply modulator, timing mismatch, AM-AM and AM-PM distortions in 
the RF PA, and finally, developing the appropriate transfer function between Vsm(t) 
and Ein(t) to fulfill (2.8).
The consequence of timing mismatch on spectral distortion for an ideal RF PA 
considerably raises spectral intermodulation distortions (IMD) and error vector 
magnitude (EVM), leading degraded adjacent channel power ratios (ACPR) and 
digital modulation quality, respectively. It is important to acknowledge that the 
nonlinearity mechanism is merely one aspect of related impacts, and consequently, 
it is expected that timing mismatch desires to be significantly less than the several 
nanoseconds level. Even though it is conceivable to utilize the delay compensations 
in theory (e.g., delay line in either digital and analog manners), physical dimen-
sion and complexity constraints make the opportunity unattractive in the main RF 
branch to counteract the error. The timing alignment topic will be further discussed 
in Chapter 6.
Therefore, constructing the appropriate ET supply signal Vsm(t) is critical for 
spectral distortion reduction and EVM enhancement. Assuming that the transfer 
function Gsm is a function of both Vsm(t) and Ein(t), several linearization methods 
are promising, such as AM-AM linearization by predistorting Ein(t) to yield Vsm(t) 
directly, polar and Cartesian feedback mechanism, feedforward linearization, or, 
briefly, a combination of these. Whatever the case may be, the amount of lineariza-
tion is highly dependent on the RF PA design. Considering them as independent 
system modules is not wise for optimum ET performance. The RF PA and linear-
ization design considerations for ET will be further discussed in Chapters 5 and 6, 
respectively.
2.3  Instantaneous Efficiency of PA
The instantaneous efficiency of a RF PA is defined as a function of the instanta-
neous input and output power and the class of operation. In this book, the expres-
sion of instantaneous efficiency is denoted as 
	
η =
out
sm
P
P
	
(2.9)
where Pout is the RF output power and Psm is the total DC output power of the 
supply modulator assumed, which is a function of the envelope. Depending on the 
operation class of the RF PA, the instantaneous efficiency is proportional to the 
output power. In hands-on RF PA designs, the instantaneous efficiency typically 
reaches a maximum value at the moment that the gain is compressed by about 3 dB.
General supply modulation is discussed with an emphasis on ET system per-
formance and figure of merits, in which a fundamentally linear class-B PA is used 
as a friendly guide for ET understanding. Requirements, architecture, and typical 
nonidealities of ET will be discussed to provide context for the following ET key 
aspect discussion.

58 
���������������������������������������
Envelope Tracking Power Amplifier Basics
2.3.1  Class-B Deduction
For the sake of comprehensive illustration, a breakdown of traditional class-B RF 
PA serves as a guide to present the instantaneous efficiency concept of ET. Actu-
ally, a fixed DC supply class-B RF PA can be presumed as an ET class-B PA with a 
supply modulator providing constant and stable voltage ideally with the following 
relationship:
	
≡
sm
DC
V
V
	
(2.10)
As a result, a conventional class-B PA block diagram can be presented as in 
Figure 2.4, where the input and output terminals are permanently 50Ω-matched. 
The DC biasing is provided to the gate and drain through bias tees, embodied in 
Figure 2.4 by an independent DC blocking capacitor and an RF choke inductor. 
Chokes used here are supposed to be ideal so that currents Ig and Ism do not fluctu-
ate at the RF frequencies. Furthermore, Figure 2.5 demonstrates the DC operation 
of an ideal field-effect transistor (FET), generally referred to as the I-V curves. 
Configured by Vg to obtain Vsm = VDC and Idq = 0, a DC bias is applied to the FET 
as the quiescent bias point (Q-point). As is well known, the class-B operation has 
zero DC bias because the FET is biased at the cutoff condition. Consequently, the 
FET merely conducts as soon as the input signal is greater than the gate-source 
threshold voltage. For this reason, there is zero output and no power being con-
sumed at zero input scenarios. It means that the actual Q-point of a class-B PA is 
on the Vds part of the load line, as shown in Figure 2.5 with a gray point. Increas-
ing Vgs beyond a minimum value Vpinch causes linearly increased Ids. However, with 
the above certain maximum value of Vgs, the channel is saturated and Ids cannot 
increase any further, converging to a constant value Imax. Here Vk denotes the knee 
Figure 2.4  Generalized class-B RF PA circuitry under envelope tracking operation. Classical class-B 
is just a special application scenario by setting Vsm as a constant DC supply voltage. In this way, fixed 
supplied class-B serves as a preface for the envelope tracking principle. (From: [33]. © 2002 Artech 
House. Reprinted with permission.)

2.3  Instantaneous Efficiency of PA 
59
voltage below which maximum current Imax cannot be achieved. The Q-point is set 
by both of the voltages Vsm and Vg, resulting in the quiescent current Idq = 0. The 
RF input signal varies Vgs around its DC offset value of Vg, causing subsequent 
variation in Ids. 
Supposing pure resistive load impedance RL at the output port, the current 
variation will bring about linearly correlated drain-source voltage and current. The 
I-V load line has a slope equal to the inverse of RL.
The class-B PA has the evident advantage over its class-A PA counterpart in 
that no current drifts via the FET the minute it is in the quiescent state, so con-
sequently little power is dissipated in the FET because there is no existing signal. 
It is unlike the class-A PA, which requires substantial gate bias in the manner of 
dissipating a large amount of heat even without the input signal being injected. Ac-
cordingly, the global power conversion efficiency of the class-B PA is superior to 
that of the equivalent class-A with efficiency reaching as high as 78.5% in theory.
Ideally speaking, class-B operation has conventionally been accomplished by 
the use of conduction angle reduction. It decreases the quiescent current to less 
than the class-A mode as mentioned above, preventing conduction through the cur-
rent source for a certain segment of the RF period under single-tone stimulation. 
Hence, the conduction angle α is defined as the span of time in radians when the 
transistor is conducting current during each RF cycle. Traditional conduction angle 
reduction in class-B operation requires that a short circuit to the current source at 
harmonic impedances. A harmonic short circuit leads the harmonic voltage to be 
zero, causing fundamental-frequency sinusoidal drain voltage waveforms, whereas 
allowing the drain current waveform to be a half-rectified sine wave, comprising 
a DC component and fundamental and even harmonic energy. Drain voltage and 
current waveforms are presented in Figure 2.6, where the conduction angle α is the 
Figure 2.5  I-V curves for a FET PA with a class-B bias point. The load line indicates the operation 
region and its slope relationship equals to the inverse of load resistive load impedance. There is zero 
output and no power being consumed at zero input for class-B configuration.

60 
���������������������������������������
Envelope Tracking Power Amplifier Basics
portion of the RF cycle during which the current Ids is allowed to flow through, 
achieved by reducing the value of Idq relative to Imax. Subsequently, class-B bias 
requires a conduction angle equal to π.
The instantaneous drain efficiency of a theoretical RF PA can be calculated 
based on drain waveforms, expressed as
	
η
⋅
=
⋅
=
⋅
100%
out
ds
ds
sm
sm
sm
P
V
I
P
V
I
	
(2.11)
The efficiency of the ideal class-B mode could be calculated using (2.11) and 
come close to the half-rectified sine wave drain current as a function of α. The DC 
component Ids_DC of Ids can be deduced to
	
α
α
α
j
j
α
π
α
α
α
α
π
−




=
⋅
⋅
−
⋅








⋅


−








⋅
−
⋅








=
⋅
⋅


−




∫
2
max
_
2
max
1
cos
cos
2
2
1
cos 2
2 sin
cos
2
2
2
1
cos 2
ds
DC
I
I
d
I
	
(2.12)
The harmonic components Ids_n of Ids could be denoted as

	
	
(
)
α
α
α
j
j
j
α
π
−




=
⋅
⋅
−
⋅
⋅










−




∫
2
max
_
2
1
cos
cos
cos
2
1
cos 2
ds
n
I
I
n
d
	
(2.13)
With (2.13), the fundamental frequency component Ids_0 of Ids, of major promi-
nence for the power and efficiency relationship, could be shortened as
Figure 2.6  Class-B PA drain voltage and current waveforms under a dual Y-axis plot to illustrate the 
instantaneous dissipated power cut down due to the reduced conduction angle. The drain current 
becomes as a half-rectified sine wave to reduce overlapping regions as a result of the conduction 
angle control.

2.3  Instantaneous Efficiency of PA 
61
	
α
α
α
π
−
=
⋅
⋅


−




max
_0
sin
2
1
cos 2
ds
I
I
	
(2.14)
Finally, with regard of class-B operation the DC component Ids_DC of Ids is 
Imax/π as soon as the fundamental frequency component Ids_0 of Ids is Imax/2, as 
when
	
=
max
_0
2
ds
I
I
	
(2.15)
Then
	
π
=
max
_
ds
DC
I
I
	
(2.16)
Therefore, the output power is equal to the class-A case while DC power is cut 
by a factor of π/2, causing an ideal class-B efficiency of π/4, or 78.5%.
	
π
η
−
⋅
=
=
≈
⋅
⋅
_0
c
_ max
_
78.5%
2
4
ds
ds
lass AB
ds
ds
DC
V
I
V
I
	
(2.17)
However, this growth in efficiency is at the expense of gain loss. To keep un-
changed maximum output power, twice the gate bias swing, an increase of in 6-dB 
input power is mandatory. For that reason, when compared to the class-A mode, 
the gain under ideal class-B mode is 6 dB less than that in the class-A mode at peak 
output power.
2.3.2  ET Deduction
When neglecting peripheral circuitry power dissipation, the instantaneous ET PA 
efﬁciency ηET is determined by both the RF PA efﬁciency, ηPA, and the envelope 
supply modulator efﬁciency, ηenv. The relationship between them can be defined as 
	
η
η
η
=
⋅
ET
PA
env 	
(2.18)
Consequently, for ET, nothing is more important than to design a highly effi-
cient supply modulator with a wide bandwidth and decent linearity, which will be 
further discussed in Chapter 4. Based on (2.11) and (2.17), in the fixed DC supply 
class-B PA scenarios, assume an ideal supply modulator with 100% efficiency to be
	
η
= 100%
env
	
(2.19)
Then the instantaneous drain efficiency of the class-B PA under ET operation is
	
π
η
η
−
=
=
=
⋅
_
4
out
rf
sm
k
ET
PA
sm
sm
P
V
V
P
V
	
(2.20)

62 
���������������������������������������
Envelope Tracking Power Amplifier Basics
where the fundamental RF signal output power Pout_rf could be deduced as
	
=
⋅
⋅
_
1
2
out
rf
fund
fund
P
V
I
	
(2.21)
According to (2.16), total DC input power from supply modulator Psm can be 
expressed as
	
π
=
⋅
rf
sm
sm
I
P
V
	
(2.22)
Based on (2.14), the RF fundamental output current Ifund can be expressed as
	
= 2
rf
fund
I
I
	
(2.23)
Consequently, the RF fundamental output voltage Vfund can be calculated as
	
=
⋅
=
⋅2
rf
fund
L
fund
L
I
V
R
I
R
	
(2.24)
Finally, the dynamic ET supply voltage Vsm can be calculated as 
	
=
+
=
+
⋅2
L
sm
k
fund
k
rf
R
V
V
V
V
I
	
(2.25)
where RL is the PA load resistance, Irf is the RF dynamic current, and Vk is the 
minimum voltage swing of the RF transistor, which is the value defined as the knee 
voltage of the transistor, indicating the threshold before shutting down.
From an output power perspective, the ideal case for an ET PA with class-B 
bias, the envelope supply modulator provides the ideal dynamic supply with unlim-
ited bandwidth to the RF PA. However, for a constant drain supply class-B RF PA, 
the efficiency fluctuates with output power, as defined here:
	
_
_
max
max_
max
4
out
rf
out
rf
k
PA
sm
rf
k
P
P
V
V
P
P
V
V
π
η
−
=
=
⋅
⋅
+
	
(2.26)
where Pout_rf is the average RF output power, Psm is the total DC input power, 
Pmax_rf is the maximum output power, Vmax is the maximum voltage swing of RF 
transistor, and Vk is the knee voltage of the RF transistor. The efficiency rolls off 
from its peak value in a square root manner with output power. With backing off 
by 6 dB on output power, for instance, PA efficiency reduces from the peak to nearly 
half, which causes dramatic degradation, as shown in Figure 2.7.

2.3  Instantaneous Efficiency of PA 
63
2.3.3  Efficiency Degradation Factor
Conversely, from (2.20), the efficiency under ET is no longer correlated with output 
power, which is a significant enhancement for efficiency in power back-off regions. 
Figure 2.7 plots the efficiency comparison between a constant drain supply class-B 
PA and an ideal ET PA versus normalized output power. In the ideal ET case, the RF 
PA efficiency degrades only with the knee voltage Vk. In other words, the efficiency 
of RF PA can be maintained within a rather wide power range under ET operation. 
Efficiency rolls off only due to RF transistor’s intrinsic knee voltage [12, 13].
From (2.20), it is observed that the smaller value of Vk/Vsm, the more efficiency 
RF PA can achieve if at all possible. Therefore, an efficiency degradation factor can 
be defined as ρd
	
k
on
d
sm
load
V
R
V
R
ρ =
≈
	
(2.27)
where Rload can be approximated as the PA fundamental load resistance [12] and 
Ron is the intrinsic “on” resistance of transistor. In the ET mode, Vsm varies con-
tinuously with the input RF envelope. When the knee voltage Vk is higher and 
approaching to maximum Vsm with various transistors, ρd will increase so as to 
decrease the efficiency of the RF PA, compared to the ideal case with zero knee 
voltage, and the efficiency of the ET PA decreases with Pout_rf due to knee voltage, 
as shown in Figure 2.7.
	
_
1
1
4 1
4
4
1
on
d
load
load
on
ET
class B
on
d
load
on
load
R
R
R
R
R
R
R
R
ρ
π
π
π
η
ρ
−
−
−
−
=
⋅
≈
⋅
=
⋅
+
+
+
	
(2.28)
Figure 2.7  Comparison of efficiency versus output power between class-B PA and that with ideal 
ET operation. It illustrates that the ET PA efficiency is independent of output power but degrades 
with the knee voltage.

64 
���������������������������������������
Envelope Tracking Power Amplifier Basics
Equation (2.28) and Figure 2.8 illustrate a crucial factor in designing an en-
velope supply modulator for the corresponding RF transistors. Assume the knee 
voltage Vk reduces from the maximum Vsm, theoretically, the efficiency of PA under 
class-B is decreased as partial of that in the ideal case with zero knee voltage. Then 
the efficiency of the ET PA decreases with Pout_rf due to knee voltage. While using 
a RF transistor with higher Vk, the dynamic range of the supply modulator has 
to be extended to preserve the high efficiency of RF PA under ET operation [13]. 
Namely, for a RF transistor with a fixed Ron value, the higher the Rload, the higher 
the efficiency can be presented. Growing the dynamic drain voltage swing of the 
RF transistor is accommodating in picking larger Rload. To further emphasize the 
significance of vital aspects of supply modulator design, the design issues will be 
illustrated in great detail in Chapter 4.
Figure 2.9 indicates the voltage and current waveforms and load lines of a 
class-B PA and the scenarios under ET. The black solid lines represent the occasion 
of maximum linear output power Pout_max, and the gray solid lines denote the case 
with output power Pout_rf that is one-quarter of Pout_max, alternatively, 6 dB backed 
off.
For a class-B PA, Idc decreases as Pout_rf decreases, but Vsm is fixed. Its efficiency 
decreases much slower than that of the class-A PA because of the decreased Idc, 
which is proportional to the square root of Pout_rf. For the class-B PA under ET, Vsm 
is modulated by the envelope and Idc is inevitably manipulated by the class-B bias. 
As a result, its efficiency is constant for the entire output power range [6], under 
the hypothesis of an ideal supply modulator being utilized.
	
_
_
max
max_
max_
max
1
1
4
4
1
1
k
out
rf
out
rf
d
class B
k
rf
rf
d
V
P
P
V
V
P
P
V
ρ
π
π
η
ρ
−
−
−
=
⋅
⋅
=
⋅
⋅
+
+
	
(2.29)
Figure 2.8  The increase of efficiency degradation factor causes decrease of the efficiency of class-B 
PA under an ideal ET operation. The efficiency degradation factor is determined by the ratio between 
knee voltage of RF transistor and drain supply voltage.

2.4  Statistical Average Efficiency of ET 
65
Equations (2.28) and (2.29) represents the efficiencies of the class-B PA and 
that under ET according to Pout_rf. Clearly, ET eliminates the efficiency correlation 
to output power, making it independent of the output power variances. The class-B 
mode under ET has the maximum efficiency of around 78.5% for all output power 
range by tracking peak efficiency trajectory. 
2.4  Statistical Average Efficiency of ET
The statistics of typical high-PAPR signals are such that an ET PA typically spends 
most of its time operating with relatively low supply voltage, with only occasional 
high-voltage excursions on high-power peaks. It is reasonable to optimize the PA 
matching to achieve the optimum efficiency with the target-PAPR signals rather 
than simply designing for best efficiency at peak power and maximum supply volt-
age, as would be the case for a fixed-supply PA. Designers can alter the PA matching 
Figure 2.9  The voltage and current waveforms and load lines of a class-B PA and that under ET operation 
with full output power and 6-dB back-off scenarios. It explains the load line trajectory by various output power 
levels.

66 
���������������������������������������
Envelope Tracking Power Amplifier Basics
to increase efficiency around the peak of the probability density function (PDF), 
even if this necessitates a slight compromise in the peak power efficiency.
2.4.1  Statistical Average Efficiency Definition
Statistical average efficiency is a noble indicator for average power consumption in 
most of wireless communication systems with time-varying envelopes. If the enve-
lope probability density function pdf(E) is identified, where E is the RF envelope 
amplitude information, the statistical average efficiency can be well defined as
	
( )
( )
( )
η
=
out
in
P
E
E
P
E 	
(2.30)
where 
( )
out
P
E  is the average output RF power, which can be calculated as
	
( )
( )
max
0
E
out
out
P
P
E
pdf E
dE
=
⋅
⋅
∫
	
(2.31)
and 
( )
in
P E  is the total statistical average input power, which can be considered as
	
( )
( )
=
⋅
⋅
∫
max
0
E
in
in
P
P
E
pdf E
dE 	
(2.32)
The PDF of the envelope is a measure of the comparative counts corresponding 
to different envelope levels. Motivated by the strong demand for increased spectral 
efficiency, waveforms with varying amplitude and phase such as WCDMA and 
LTE-A have time-average power significantly lower than the peak envelope power. 
The PAPR of these waveforms ranges from 3 dB to more than 10 dB. For example, 
the QAM signals have PDFs with PAPR fluctuating from 3 to 6 dB [14]. Also the 
OFDM signal have Rayleigh PDFs [15] with typical PAPR ranging from 7 to 13 
dB, as revealed in Figure 2.10. For this reason, the efficiency of the class-B mode of 
operation termed formerly is reduced rapidly with backed-off output power, lead-
ing to shrunken time-average efficiency. 
As presented in Figure 2.10, theoretical curves in gray represents typical class-B 
PA efficiency and gain behavior with decreasing output power along with the enve-
lope PDFs for high-PAPR signals. It is obvious that the highest-probability output 
power levels emerge with rather low efficiency, and that output power back-off is 
not making a mountain out of a molehill about the issue. It is the truth without a 
doubt that it becomes more and more noticeable especially in 4G and beyond. High 
PAPR signals such as LTE-A have a PDF weighted far away from maximum output 
power, leading to inefficient operation at the time-averaging power level.
Nevertheless, the statistics of typical high-PAPR signals are such that an ET PA 
typically devotes most of its time operating with comparatively low-supply volt-
age, with only occasional high-voltage excursions on high power peaks. Hence, it 
makes sense to improve the PA efficiency trajectory matching to the PDF of high 
PAPR signals to realize top efficiency. Based on the PDF of the RF signal, the statis-

2.4  Statistical Average Efficiency of ET 
67
tical average drain efficiency can also be calculated as a function RF output power 
[16, 17] as 
	
(
)
(
)
(
)
(
)
(
)
_max
_max
0
0
out
out
P
out
out
out
out
P
out
sm
out
sm
out
out
pdf P
P
dP
P
pdf P
V
P
I
P
dP
η
⋅
⋅
=
⋅
⋅
⋅
∫
∫
	
(2.33)
where Vsm(Pout) and Ism(Pout) are the supply-modulated output voltage and current, 
which are the functions of the RF output power Pout, and pdf(Pout) is the PDF of the 
output power. In Figure 2.10, the optimal Vsm curves coincide with the theoretical 
envelope given by 
	
_
sm
opt
L
out
V
R
P
=
⋅
	
(2.34)
where RL is the load resistance of the RF PA, so a linear transformation of the base-
band envelope signal is optimum as the envelope shaping function for efficiency 
enhancement.
2.4.2  Efficiency and Gain Trajectory for ET
The principle behind ET is to operate the PA in compression region as frequently as 
possible. This technique takes advantage of the statistic that both the point of peak 
efficiency and the point of peak output power vary as the supply voltage goes up and 
down. To exemplify this point, Figure 2.11 displays drain efficiency trajectory as a 
function of output power for a group of supply voltage values. The trend observed 
is that the output power of peak efficiency increases with a rise of supply voltages, 
but keeps a constant high efficiency across a wide output power range to tolerate 
Figure 2.10  Typical PA efficiency and gain behavior over output power compared to PDFs for typi-
cal high PAPR signals such as QAM and OFDM. It illustrates the notion of statistical average efficiency 
for PAs. (From: [31]. © 2003 Artech House. Reprinted with permission.)

68 
���������������������������������������
Envelope Tracking Power Amplifier Basics
back-offs for PDF distribution. For that reason, the straightforward impression of 
ET is to map instantaneous output power to an optimal supply voltage value. In this 
manner, the PA devotes on the edge of compression region most of the time. The 
theoretical efficiency using ET for a particular PA is presented in Figure 2.11 as a 
dashed thick black trace. As illustrated, the effective drain efficiency is substantially 
superior to the actual drain efficiency while via fixed DC supply voltage.
Although the class-B PA theory and designs described in prior sections provide 
significant improvement on PA peak efficiency by operation in compressed region, 
peak efficiencies of class-B are not sufficiently high to reach higher overall ET ef-
ficiency. Therefore, with the development of modern linearization technologies, 
nonlinear switch-mode PAs are employed to boost the peak efficiency of PA to ac-
complish much higher statistical average efficiency under the ET mode, although it 
correspondingly suffers from more challenging distortion correction requirements 
for linearization methods. For instance, Figure 2.11 displays ET PA performance 
over instantaneous output power along with the PDF for an LTE uplink (UL) test 
signal with a typical 6.5-dB PAPR. The right-most efficiency curve in the trajecto-
ries in Figure 2.11 shows the drain efficiency for a switch-mode class-F−1 PA based 
on a 48-V GaN HEMT transistor at 940 MHz. The PA has over 80% drain ef-
ficiency near the saturated output power, but efficiency falls rapidly during output 
power back-off. The time-averaging power of the 6.5-dB PAPR LTE UL signal is 
produced with less than 45% drain efficiency.
However, the trajectories of Figure 2.11 indicate the PA behavior at varying 
drain supply voltage levels, indicating that the average power level of 36 dBm can 
be produced with about 85% drain efficiency if drain voltage is reduced to only 
35V. Supply modulation techniques aim to continuously vary drain supply voltage 
Figure 2.11  Influence of signal statistics on time-averaging efficiency of an ET PA by introducing 
comparison of PDF histogram and ET efficiency trajectory over various supply voltage levels.

2.4  Statistical Average Efficiency of ET 
69
for peak efficiency trajectory by means of maintaining efficient saturated PA opera-
tion over a wide range of output power levels, as shown by the dashed black line 
in Figure 2.11.
While ET promises considerable efficiency improvements, one must be aware 
that there are many trade-offs involved with ET PA design. Actually, optimizing 
for one performance metric requires trade-offs of other metric vertexes in the ET 
pyramid. As a result, the design process of choosing the optimal supply voltage lev-
els for a given output power is a highly iterative task. Utilize the original envelope 
shape for ET is not the finish line, but a solid start point to trade off ET key metric 
vertexes for specific application scenarios. Envelope shaping is the road to achieve 
the compromised performance.
At this moment, the PA supply rail under ET is a set of controlled parameters 
and the goal is to vary the PA supply dynamically to enhance performance for ei-
ther efficiency or linearity. Then back to the theme in this section: to maximize the 
statistical average efficiency with envelope shaping functions, request to operate 
the PA supply with a high degree of compression, as displayed in Figure 2.12, in 
which the supply voltage for a specified output power is nominated to guarantee 
that the PA operates in the compression region with the maximum efficiency ob-
tained and, correspondingly, across as wide a range as possible of the output power 
range.
By plotting the curve of peak efficiency shaping with a gain curve, a virtually 
constant gain compression across the ET gain trajectory is observed by means of 
adjusting the supply modulator output voltage by polynomial fitting function or 
look-up table (LUT) methods. However, based on the optimized efficiency trajec-
tory, a simple supply-voltage LUT can be created as well with the purpose that it 
maps output power to a drain efficiency optimized supply voltage value, as pre-
sented by a solid line with rectangle markers in Figure 2.12. Remember that there 
is a bottom bound retained on the lowest supply voltage provided. The trunca-
tion occurs owing to the lower bounds imposed in the LUT. The value of lower 
bound depends on the knee voltage of RF transistor and envelope shaping trade-off 
among ET pyramid vertexes. This boundary has an envelope bandwidth reduction 
effect, which will be discussed in Chapter 6. The imposed lowest supply bound 
implementation is usually termed as de-trough. By linking the supply modulator 
output voltage points, a continuous supply curve versus output power is obtained 
for the maximum efficiency strategy. It can be observed that for low-power modes, 
supply modulator output voltage plateaus at a constant low-supply voltage as wide 
power range as possible to realize sufficient compressions during low-power levels. 
Alternatively, at the lowest-power levels, the PA still needs to operate linearly to 
guarantee a statistically high linearity. Unfortunately, the peak efficiency envelope 
shaping scheme is achieved at the expense of absolute gain degradations. It is un-
derstandable that several decibels of gain loss occur overall by compressing most 
of the power levels. Typically, compared to the gain of a fixed-supply RF PA, the 
gain degradation of peak efficiency ET strategy can range from 2 to 5 dB depending 
on the system requirements and the linearization methods employed. Taking ev-
erything into account, this kind of gain degradation effect by maximum efficiency 
envelope shaping would require input power compensation from a prior driver 
amplifier. As a result, the linearity margin for a prior driver stage under this scheme 
should be cautiously considered.

70 
���������������������������������������
Envelope Tracking Power Amplifier Basics
Above and beyond trade-off with gain and power capacity, maximum efficien-
cy envelope shaping results in both linearity and linearization difficulties. Although 
the notion of modulating the supply voltage to maximize drain efficiency is correct 
in theory, it is demanding to execute in practice. A consequence of changing supply 
voltage as a function of output power is that the gain of ET PA would dynamically 
fluctuate as supply voltage alters, increasing the AM-AM distortions accordingly. 
This effect can be mitigated by employing a reduced range of supply voltage levels 
or by removing the supply from the true output RF envelope by certain voltage 
offsets. It leads to a design trade-off between efficiency and AM-AM distortions. 
Even though traditional predistortion algorithms can be applied to the baseband 
waveform to correct additional distortion introduced by ET, substantial AM-AM 
distortion at the PA output can be observed because the gain of PA are fluctuating 
along with fast-changing supply. Although the input is linearly amplified, which 
highlights the challenges to implementing an advanced predistortion algorithm to 
tolerate rapid and time-varying gain variations and AM-AM distortions. However, 
for low-power UE applications, this kind of advanced linearization scheme is not 
cost-effective in any way with regard to the benefits brought through efficiency 
enhancement by ET. Therefore, another linearity-oriented strategy for envelope 
shaping will be discussed in the following section.
To understand this statistical average efficiency concept, Figure 2.13 illustrates 
the PDF for a UE test case using LTE 16QAM FDD uplink SC-FDMA waveform 
with an average RF power of 25 dBm, with PAPR at 6.5 dB. A Motorola MRF9742 
Figure 2.12  Efficiency and gain trajectories versus output power across various supply voltages 
for maximum efficiency ET strategy. The envelope shaping function is tailored for maximum ef-
ficiency operation and the gain curve indicates difficulty for linearization under superior efficiency 
performance.

2.4  Statistical Average Efficiency of ET 
71
BJT is selected as an exemplary RF PA transistor matched to an 850-MHz band. 
By moving the waveform to a specific average output power, the efficiency of the 
PA with the particular modulated signal can be estimated as presented in Table 2.1.
The statistical calculation gives efficiency as a random variable and assumes 
that the efficiency-versus-output-power measurements are static; for example, they 
do not vary in the time base. Although the calculation in (2.33) delivers a respect-
able estimate of efficiency, the actual efficiency can differ to some degree over time 
base due to memory effects in the RF PA and gain variation owning to temperature 
changes. Figure 2.13 illustrates the simulated efficiency for fixed DC supply as well 
as the expected efficiency under ET conditions supposing an ideal supply modula-
tor is employed. Note that the theoretical and simulated efficiency are very close 
and only start to depart at higher output powers. The scattering effect observed 
can most likely be attributed to memory effects within the PA under ET operation. 
From this exemplary instance, we can conclude that ET can theoretically achieve 
around 6% and 0.9% improvement on the time-averaging efficiency and EVM, 
respectively, over a wide range of output power with a classical BJT device.
Figure 2.13  Typical efficiency scattering plots for fixed-supply PA and that under ET operation com-
pared with the histogram of PDF for an LTE UL waveform. The statistical average efficiency benefits 
to fixed DC supply counterpart are directly illustrated.
Table 2.1  Summary of Exemplary Class-B and ET 
Mode Performance with LTE UL Signal
PA Type
Output Power 
(dBm)
Average 
Efficiency (%)
EVM  
RMS (%)
ET
24.95
25.95
2.85
Class-B
24.97
19.88
3.73

72 
���������������������������������������
Envelope Tracking Power Amplifier Basics
2.5  Bandwidth of ET
The ET technique is considered as the ideal solution for multimode multiband 
(MMMB) PAs because it is frequency-agile and is suitable for broadband applica-
tions. By virtue of the band-splitting of the RF and envelope signal, the MMMB PA 
can be controlled by the supply modulator and the bandwidth then just needs to 
cover the RF band without any other constraints. 
Nevertheless, one noteworthy design challenge of ET is the high bandwidths 
required for both RF PA and the envelope supply modulator, even though band-
widths are distributed on RF and DC-to-intermediate-frequency bands, respective-
ly, which will be discussed in detail in Chapters 4 and 5. Therefore, in this section, 
we concentrate on envelope bandwidth and video bandwidth (VBW) for ET. The 
bandwidth required for the envelope waveform is usually far greater than that of 
the RF signal. To investigate this phenomenon, the LTE UL stimulus signal pre-
sented in Figure 2.11 is again utilized for subsequent exploration. 
Figure 2.14 demonstrates that the ET supply bias voltage and current wave-
forms over time base for the corresponding LTE UL signal. An amplitude spectral 
breakdown indicates that the bandwidth of the envelope waveform is at least three 
times more than that of the RF signal waveform. The high bandwidth requirement 
is due to that ET supply voltage is a function of RF envelope amplitude.
2.5.1  Bandwidth of Envelope
Unlike EE&R schemes, the amplitude and phase signals are not completely sepa-
rated in ET because it keeps both the amplitude and phase information in the main 
RF signal branch rather than in the pure phase signal. For that reason, ET demands 
a lower supply modulator bandwidth and alleviated accurate timing alignment re-
quirements between the envelope and RF branches. Nonetheless, it does not mean 
Figure 2.14  ET supply bias voltage and current waveform in time domain with an LTE UL signal. It 
contains rather wide frequency components in envelope, which brings about severe challenges on 
supply modulator bandwidth design.

2.5  Bandwidth of ET 
73
that the phase signal bandwidth of envelope for a high-performance ET operation 
can be totally ignored. From (2.5), the phase of the baseband signal is enclosed in
	
( )
( )
( )
( )
arctan
.
Q t
j
I t
j
t
BB t
e
e
j


⋅




Φ
=
=
	
(2.35)
The necessary bandwidth of phase signal ΦBB(t) is far wider than that of base-
band signal BB(t) as displayed in Figure 2.15.
The bandwidth requirement of the phase signal imposes practical challenges 
and limits the classical EE&R transmitter to narrow bandwidth scenarios [9, 10]. 
However, the RF signal bandwidth in ET systems is identical to the baseband signal 
bandwidth, which is much narrower than the phase signal bandwidth as in EE&R 
systems. In addition, because ET preserves the amplitude information in the RF 
signal branch, it demands a lower bandwidth for the envelope supply modulator 
and minor precise timing alignment between the envelope and RF branches [11].
In ET mode, envelope signal bandwidth is the determining factor for supply 
modulator performance. Figure 2.16 presents the spectra of the LTE UL envelope 
signal, which is typically far greater than the RF signal bandwidth. It leads to the 
rule of thumb that the bandwidth of the envelope supply modulator is at least 
three times of that of the RF signal bandwidth, depending on the characteristics 
of the specific modulated signal profile. However, from the angle of signal en-
ergy distribution, the nonlinear transformation from and to the envelope signal 
would expand the envelope signal bandwidth to infinity. However, the lion’s share 
of the envelope energy is concentrated from DC to several kilohertz. For example, 
more than 85% of the energy of an LTE envelope waveform is contained in a 
few kilohertz range and 99% of the energy is concentrated within the signal RF 
bandwidth. The characteristic of the envelope signal energy distribution infers that 
Figure 2.15  The spectra of a complex base band and its phase signals in an LTE UL application il-
lustrates that the bandwidth requirements of phase signal is much higher than baseband signal itself. 
It indicates the ET has more relaxed timing alignment requirements than EE&R because both phase 
and amplitude information are contained in the RF path in ET.

74 
���������������������������������������
Envelope Tracking Power Amplifier Basics
a split-band concept supply modulator [18, 19] can reach a high efficiency over 
a wide bandwidth. The key points of split-band envelope supply processing are 
that most of the envelope power distribution is at low-frequency components and 
narrow low-frequency band envelope processing can be more efficient. However, 
high-frequency components take a minor portion of power share but demand to 
be processed linearly over wideband for ultra-low distortions. As a result, the split-
band envelope supply modulator is composed of a wideband but relatively low ef-
ficiency high-frequency (HF) circuitry path and a high-efficiency narrowband and 
low-frequency (LF) circuitry path, where the overall efficiency is a combination of 
the two-path efﬁciencies, as
	
_
_
_
1
1
out
sm
sm
split
in
sm
HF
LF
P
P
η
β
β
η
η
=
=
−
+
	
(2.36)
where the overall average efﬁciency 
_
sm
split
η
 is defined as the ratio of envelope supply 
modulator output power 
_
out
sm
P
 and its input DC power 
_
in
sm
P
, which is dependent 
on the LF path efﬁciency 
LF
η
 and the HF path efficiency 
HF
η
 along with the power-
split ratio β, which is defined as the ratio of the signal power from the LF path to 
the total signal power [18].
2.5.2  Video Bandwidth of ET
Broad bandwidth requirements of RF PAs from emerging technologies are not 
only determined by challenges of the RF operational bandwidth to cover multiple 
wireless communication frequency bands for MMMB equipment, but also by the 
enhancements of video bandwidth (VBW) of RF PAs. VBW is a measure of instan-
taneous modulation bandwidth, which stems from TV broadcasting times, defined 
as the bandwidth crossing from DC to the first parallel resonance of the bias feeding 
Figure 2.16  The spectra of a complex baseband and its envelope signals in an LTE UL application 
illustrates that the supply modulator bandwidth is at least three times that of the RF channel band-
width in ET in order to guarantee linearity of the supply dynamic.

2.6  Linearity of ET 
75
line when the group delay turns out to be too nonlinear to maintain acceptable 
signal quality. In RF PA design, the third-order intermodulation distortion (IMD3) 
flatness or ripple is involved to define the measure of the VBW. A two-tone continu-
ous wave (CW) signal at a nominal in-band frequency can be plotted for varying 
carrier spacing. The VBW can be obtained by checking the IMD3 drop level as 
the carrier spacing increase to some specific values (e.g., 3 dB), as shown in Figure 
2.17. However, VBW under ET is defined by envelope supply modulator band-
width because the large capacitor for supply bias feeding line parallel resonance is 
removed to receive dynamic envelope shape supply feeding. Based on prior analysis 
of envelope bandwidth requirement, the envelope supply modulator bandwidth or 
modulation bandwidth should be at least three times that of the RF channel band-
width to guarantee amplitude and phase distortion tolerance for overall ET system 
performance. 
The system trade-off associated with using the above-mentioned envelope shap-
ing to linearize the PA is a small loss of efficiency for a substantial improvement in 
linearity. The choice of the envelope shaping function also has a strong influence 
on the bandwidth requirement of the envelope path. A smooth transition between 
the linear and compressed regions results in a mitigant bandwidth requirement for 
the supply modulator with a modest loss around 1% to 2% in overall system ef-
ficiency. The envelope shaping function and envelope slew rate reduction design for 
ET will be further discussed in Chapter 6.
2.6  Linearity of ET
Unlike fixed DC supplied RF PA with great effort spent trading off factors to achieve 
adequate linearity at peak power, for an ET PA, the linearity in the compressed re-
gion is no longer a self-contained PA parameter. The PA still must be linear in the 
low-power, low-voltage region. At higher powers, however, there is no AM linearity 
constraint so that the PA can be designed for optimum ET efficiency without regard 
to AM linearity. However, the envelope shaping function can provide another free-
dom to design for linearity for ET. 
Figure 2.17  The video bandwidth is defined by two-tone IMD3 sweeping with various carrier spac-
ing. It is provided by supply modulator in ET PA and plays a role as a key figure of merit to trade off 
bandwidth and linearity in an ET pyramid.

76 
���������������������������������������
Envelope Tracking Power Amplifier Basics
2.6.1  Two-Tone IMD
For high-PAPR signals such as QAM and OFDM, dramatically ever-changing enve-
lope levels give rise to AM-AM and AM-PM effects and further cause intermodula-
tion distortions in the output signals. For instance, consider a nonlinear transfer 
function
	
2
3
1
2
3
n
out
in
in
in
n
in
V
a
V
a
V
a
V
a
V
=
⋅
+
⋅
+
⋅
+
+
⋅

	
(2.37)
where Vin and Vout are the system input and output voltage signals in a general 
system with an nth-order nonlinearity. a1 ~ an are the gain terms for each order. If 
Vin is a single tone with a constant amplitude, the harmonics of each order will be 
generated by the system according to the transfer function. Being out of band, these 
harmonics are easily filtered to obtain single-tone output signal. For that reason, 
there is no intermodulation distortion for a single-tone constant-envelope signal in 
a nonlinear system.
Nevertheless, a signal with an arbitral time-varying envelope can also be equiv-
alent as a multitone signal. For example, an input signal with a time-varying, sin-
gle-frequency sinusoidal envelope, Ein(t) = A · cos(ωm · t), can be written as
	
( )
( )
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
2
cos
cos
cos
cos
cos
2
cos
cos
2
in
in
c
in
c
c
in
c
in
V
t
E
t
t
A
t
A
t
t
A
t
t
t
ω
ω
ω
ω
ω
ω
ω
ω
ω
=
⋅
⋅
=
⋅
⋅
⋅
=
⋅
−
⋅+
+
⋅
=
⋅
⋅+
⋅
⋅
	
(2.38)
where A is the envelope maximum amplitude, ωm is the varying modulating signal 
frequency, and ωc is the carrier frequency. In consequence, it is equivalent as the 
sum of two constant-amplitude signal tones that locate at frequency ω1 = ωc – ωm 
and ω2 = ωc + ωm. The other pair of tones locates at (2 · ω1 – ω2) and (2 · ω2 – ω1), 
respectively, which are spurious signals falling within the passband and can distort 
the fundamental frequencies ω1 and ω2.
2.6.2  Modulated Signal Linearity 
As soon as the input signal type is changed to a digitally modulated signal (e.g., 
QAM or OFDM, although any time-varying envelope can be decomposed as a 
multitone signal as analyzed above), it is neither straightforward nor is it easy to 
predict the behavior when it is injected into the RF PA. Therefore, for modern wire-
less communications, error vector magnitude (EVM) and adjacent channel power 
ratio (ACPR) are two major linearity specifications introduced to mainly address 
the in-band modulation quality of transmitter and define the transmitter out-of-
band emission levels.
First, EVM is a measure of the difference between the desired and transmitted 
I-Q trajectory at each symbol time, which provides valuable insights into digitally 
modulated communication system being defined, as shown in (2.39) and Figure 
2.18.

2.6  Linearity of ET 
77
	
[ ]
( )
( )
=
+
2
2
err
err
EVM n
I
n
Q
n
	
(2.39)
where n is the measurement at the symbol time, Ierr is the difference between refer-
ence I data and measured I data, Qerr is the difference between reference Q data and 
measured Q data, and the root mean squared (RMS) average of individual EVMs is 
calculated over a period of frames.
Second, ACPR is referred to as the ratio of power centered on an adjacent 
channel relative to that in the desired main signal channel, and is illustrated in 
Figure 2.19. It relates to spectral regrowth observation and serves as an important 
figure of merit on RF PA linearity, particularly for nonconstant amplitude modula-
tion schemes defined as 
Figure 2.18  The definition of error vector magnitude (EVM) is illustrated in an I-Q vector plot. EVM 
is a key figure of merit for modulation quality, indicating in-band distortion levels. It can be decom-
posed as Ierr and Qerr in digital modulation schemes. (From: [31]. © 2003 Artech House. Reprinted 
with permission.)
Figure 2.19  The definition of adjacent channel power ratio (ACPR) is illustrated in a spectrum plot 
to indicate out-of-band interference to the adjacent channel. It is an important metric for RF PA lin-
earity with digitally modulated signals.

78 
���������������������������������������
Envelope Tracking Power Amplifier Basics
	
adj
des
P
ACPR
P
=
	
(2.40)
where adj
P  is the adjacent channel power and 
des
P
 is the desired main channel power.
Modern communication systems operate with high PAPR over wide band-
width. Linearity requirements force operation in a low efficient but highly linear 
back-off region. That is why it is critical to introduce ET to enhance efficiency per-
formance. When designing a fixed DC supply linear PA, a great deal of attention 
must be paid to achieving adequate linearity characteristics at maximum output 
power. However, for ET PA, it becomes much more complex to capture and miti-
gate the distortion with modulated signals.
In an ET system, AM-AM and AM-PM distortions along with other key PA 
metrics such as power and efficiency are profoundly influenced by the mapping 
between instantaneous RF envelope and varying supply voltage. However, with the 
proper mapping, the ET PA system achieves low AM-AM distortion despite operat-
ing under compression regions over most of the envelope cycles, as shown in Figure 
2.20. From this point, it is apparent that ET can actually be used to linearize a PA, 
with reduced ACPR and EVM values.
The ET trade-off associated with the envelope shaping function to linearize the 
RF PA is a wise strategy with a small loss of efficiency for a substantial improve-
ment in linearity. The choice of shaping function also has a positive effect on the 
Figure 2.20  Efficiency and gain trajectories versus output power across various supply voltages 
for optimized linearity ET strategy. The envelope shaping function is tailored for maximum linearity 
operation and the gain curve indicates a linearizable character for linearization under a compromised 
efficiency enhancement scheme.

2.6  Linearity of ET 
79
bandwidth requirement of the supply modulator. A smooth transition between the 
linear and compressed regions leads to a lower bandwidth requirement at expense 
of modest efficiency loss. When designing a fixed-supply linear PA, a great deal of 
attention must be concentrated on archiving adequate linearity characteristics at 
peak output power. 
There are actually several factors that influence the linearity of ET PA, such 
as the architectures, biasing, and RF matching. Hence, it needs a well-considered 
method to realize the optimized trade-off between efficiency and linearity. It is dif-
ferent for an ET PA because the linearity under ET in the compressed region is no 
longer a self-contained PA factor. The RF PA still has to be linear in the low-power 
region. Then again at higher powers, the AM linearity restriction is relaxed and the 
PA can be designed for the optimum ET efficiency without much considerations 
to AM linearity. Contrasting AM distortion, PM distortion is not directly manipu-
lated by the envelope shaping function. However, it is observed that many PAs in 
fact demonstrate mitigant PM distortion while operating in the ET mode, resulting 
in the self-linearization phenomenon, which promises to drive harder into com-
pression regions at signal peaks than with a fixed DC supply counterpart, tolerat-
ing increased output power for specified linearity. Figure 2.21 presents the ACLR 
and EVM performance comparison on an RF PA between operations in fixed DC 
supply and under ET modes. In this illustration, the PA output power for the same 
ACLR is several decibels higher in ET than that under a fixed DC supply mode. 
From this point, it is apparent that ET can actually be used to linearize a PA, pro-
viding EVM and ACPR improvements. 
One more counterintuitive characteristic of ET PAs is its tolerance to antenna 
mismatch. It is obvious that the load impedance presented to the PA is poorly con-
trolled owing to reflections from nearby devices, which lead to the PA operating 
into typical load mismatches as high as 3:1 voltage standing-wave ratio (VSWR). 
Conventional PAs struggle with increased distortion under load mismatch because 
an earlier transition from linear to compressed mode happens, causing signal clip-
ping and a resultant increase in EVM. However, the ET PA is constantly operating 
Figure 2.21  ACPR and EVM benefits gained from ET PA compared to its fixed-supply counterpart. 
The linearity under ET is no longer a self-contained PA factor. The self-linearization phenomenon can 
be observed due to the removal of AM distortion restriction and mitigated PM distortion.

80 
���������������������������������������
Envelope Tracking Power Amplifier Basics
in compression regions; accordingly, it does not undergo the same deterioration. 
Even with temperature variations, self-linearization can be observed, which is put 
under high VSWR conditions leading to considerably enhanced EVM and ACPR 
performance compared with the same PA operated in fixed-supply mode. Usually, 
the experimental implementation to obtain valuable ET operations information 
utilizes a setting that sweeps supply voltage as well as input power can consistently 
forecast the performance of ET PAs. Accumulating significantly more data than 
fixed-supply measurements validates that the performance of an ET PA is not self-
contained because a suitable ET experimental bench for characterization not only 
allows ET designers to optimize the efficiency under ET mode, but also quantifies 
other valuable data about an ET system to know its behaviors, such as increased 
output power, improved operation into mismatched loads, and insensitivity to tem-
perature variations.
AM-AM and AM-PM measurements are not only used for PA device-level 
characterization, but also are used to directly validate PA performance utilizing the 
well-defined envelope shaping function. Such measurements also can be employed 
to identify sources of nonlinearity. By defining appropriate envelope shaping func-
tion, the gain response of ET can be linearized without the demand of predistortion 
algorithm, leading to a uniform AM-AM response all the way up to peak power. 
The AM-PM characteristics are also relatively well behaved, resulting in rather low 
distortion under the ET mode, as shown in Figures 2.22 and 2.23.
For example, with higher-bandwidth waveforms, PA memory effects can turn 
out to be substantial. This is because PA output parameters such as efficiency, AM-
AM, and AM-PM distortion. In PA with memory, the output at any time does not 
depend only on the input signal value at that particular instant. The output at a 
given time can depend not only on the present input value, but also on previous 
output and input values. Memory effects are embodied in the RF PA characteriza-
tion as an expending and scattering of the AM-AM and AM-PM characteristics, 
which can stem from electrical time constants in input and output bias circuits, 
Figure 2.22  Typical AM-AM distortion characteristic under ET operation. With proper envelope 
shaping function, a uniform AM-AM response can be observed across a wide power range, although 
certain memory effects are identified by the scattering of data points at low power regions.

2.7  Power Capacity for ET Scenarios 
81
thermal time constants associated with local die heating, or particular semiconduc-
tor process charge storage effects. 
The adaptive predistortion (PD) linearization method can be employed to fur-
ther improve the linearity of the ET PA. The PD method utilizes the transfer func-
tion of an ET PA system to compensate the distortions that it can produce over the 
signal. Before the signal is injected into the PA, it is predistorted with the inverse 
transfer function, compensating those undesired effects produced by the PA. Then 
it has potential to correct the distortion from bandwidth, AM-AM, AM-PM, and 
even the memory effect in the PA. More details for linearization approaches will be 
discussed in Chapter 6.
Besides the transmitter side linearity issue, receiver band noise from ET can be 
another potential impact to wireless communication systems. ET transmitters gen-
erate receiver band noise that degrades receiver signal quality, resulting in a deterio-
rated receiver sensitivity and noise figure. Especially with the rollout of multicarrier 
configurations, the receive band is getting closer, causing more noise and interfer-
ence from transmitter side coupling and radiating them into receivers. The main 
contributors to receiver band noise in ET are interference and distortions generated 
from RF PA, interbranch timing mismatch, envelope supply modulated RF distor-
tion, noise from a supply modulator, and noise sources from related upconversion 
chains. By means of isolation of one source from another with filters and shielding, 
interference cancellation, predistortion, and receiver signal extraction techniques, 
the receiver band noise can be mitigated to a certain degree for ET PA system.
2.7  Power Capacity for ET Scenarios
ET research began with the high-power RF PAs but today includes low-power UE 
PAs. Consequently, power capacity varies in a wide range of applications and makes 
trade-offs among ET pyramid vertexes, system requirements, and engineering 
Figure 2.23  Typical AM-PM distortion characteristics under ET operation. With proper envelope 
shaping function, AM-PM distortion is relatively well alleviated, resulting in fairly low distortion under 
ET mode, although certain memory effects are identified at low power by observing the scattering 
of data points.

82 
���������������������������������������
Envelope Tracking Power Amplifier Basics
implementation considerations. For example, an RF PA design using a small-signal 
conjugate match aims to extract maximum gain from a device. However, in large-
signal PA design the goal is to extract maximum power at the expense of gain. Ac-
cordingly, the load impedance is designed to achieve maximum voltage and current 
excursion on the same load line, resulting in maximum output power. Therefore, 
here is a clear ET orientation for different application scenarios according to the 
power-handling capacity. Along with different power handling levels, the ET PA 
applications scenarios can be listed as shown in Table 2.2.
Based on Table 2.2, typical BTS and UE applications are selected for the fol-
lowing discussion about high and low power-handling capacity scenarios for ET, 
respectively.
2.7.1  ET for BTS
In wireless infrastructure markets, from 10% to 30% of network operational ex-
penditure (OPEX) is utilized on energy. Solutions for improved energy efficiency are 
strongly desired in wideband 4G LTE-A applications. Further, the RF PA usually 
takes the lion’s share, as a signal component, of power dissipation in a BTS. The 
efficiency of RF PA is rather low in the emerging LTE-A networks with traditional 
PA architectures. Consequently, extensive efforts are made within the infrastruc-
ture industry for the means of enhancing efficiency (e.g., Doherty and ET). A little 
improvement in PA efficiency can make substantial profit available in a wireless 
system and cut the overall costs needed to operate the system. However, the effi-
ciency of the RF PA is rather low when more complex digital modulation schemes 
become involved. Although Doherty has taken the lead in boosting PA efficiency 
and has become the mainstream, it has limited efficiency enhancement in case of 
substantial output power back-off scenarios. However, an increasing number of 
mobile broadband networks have been deployed around the world to increase both 
coverage and capacity. With the radio networks typically accounting for around 
80% of the total electricity consumed by a network operator, the growth in energy 
Table 2.2  ET PA Application Scenarios in Wireless Communication Systems
Average Pout 
Grade
Applications
Advantages
Standards
<1W
Mobile phones, tablet, 
WLAN, Femto BTS, PDAs
Extend battery life and 
energy saving, tolerance to 
mismatching
GSM,WCDMA, CDMA2000, 
TD-SCDMA, HSPA, LTE/
LTE-A, WiFi, WiMax, UWB, 
DVB
1W–10W
Pico, micro BTS, back-
haul, indoor RRU
Reduce operators’ OPEX 
on electric bill, simple 
heat-sink design, alleviated 
thermal issue, equipment 
miniaturization
WCDMA, CDMA2000, TD-
SCDMA, HSPA, LTE/LTE-A
>10W
Micro, macro BTS, broad-
cast stations, military 
communications
Reduce operators’ OPEX 
on electric bill, simple 
heat-sink design, alleviated 
thermal issue, equipment 
miniaturization
MC-GSM,WCDMA, 
CDMA2000, TD-SCDMA, 
HSPA, LTE/LTE-A, super 
WiFi, WiMax, UWB, DVB, 
TV broadcast

2.7  Power Capacity for ET Scenarios 
83
usage, coupled with constantly rising energy prices, is driving up operational costs 
for network operators and resulting in an increased environmental influence at the 
same time. Existing modern BTS is fairly power-inefficient due to the use of linear 
RF PAs, which normally account for half of the total power used by a BTS.
Another increasingly important demand is the need to support a wider range of 
frequency bands and multimode operation. It is strongly desired to take advantage 
of the same RF PA design to meet the emerging needs of operators worldwide. Ex-
isting efficiency enhancement techniques such as Doherty RF PA aided by predis-
tortion, being inherently narrowband, cannot satisfy this requirement. Therefore, 
the frequency agility of ET becomes rather attractive and enters the scope of an 
MMMB BTS concept.
Numerous researchers have studied ET PAs for BTS [21–25]. ET is rapidly 
gaining attention among commercial PA vendors. The study of ET for BTS has 
been going on for over a decade not only to increase efficiency, but also to reduce 
cooling requirements due to energy dissipated as heat. Because the ET PA is based 
on the mutual operation of a supply modulator and an RF PA, its two parts should 
be considered as an integrated whole, optimized for overall performance. From 
Figure 2.24, typical power and heat distribution in a BTS PA with and without ET 
are compared. Dramatic total power and heat reduction can be achieved, and junc-
tion temperatures for RF devices are dramatically reduced as well, which greatly 
reduces the size of heat-sink designs.
2.7.2  ET for Mobile
Within the past decade, ET for BTS has proven itself to be an effective means of 
increasing efficiency of RF PA and reducing cooling requirements due to wasted 
energy dissipated as heat. As wireless standards have continued to evolve to 4G 
and beyond, mobile UE manufacturers are looking to leverage ET for these same 
benefits as well. Although ET promises considerable power savings and extended 
Figure 2.24  Typical power and heat distribution in an ET PA compared to a fixed DC supplied class-B PA with 
modern predistortion schemes. The total power and heat reduced are substantial enough to bring tremen-
dous cost saving for operational cost and miniaturization of equipment.

84 
���������������������������������������
Envelope Tracking Power Amplifier Basics
battery life over conventional fixed DC power supplies, it does propose significant 
challenges to PA design and test. 
A sound rule of thumb in 3G mobile generation is that 1% of RF PA efficiency 
improvement translates to almost 35 mAh of lithium polymer battery capacity. 
In other words, a 1% efficiency boosting translates to approximately 50 mm2 of 
recoverable footprint area in current ubiquitous UE form factor [28]. As the UE 
form factor has largely stabilized due to ergonomic form-factor limitations, the 
efficiency driven footprint reductions convert into other features, increased bat-
tery size, or both. Obviously, each successive UE generation considerably increases 
power consumption. Until recently, with the emergence of 4G and beyond, the RF 
PA significantly drives the UE power consumption curve. Per se, the RF PA has 
been an important goal for efficiency improvements. 
In a traditional system, the PA is provided constant average power for the dura-
tion of the envelope. UEs typically use GaAs PAs with an output capability in the 
27- to 29-dBm (500 mW) range, which averages approximately 40% efficiency by 
modern 3G standards. However, in an ET system, the PA is provided with power 
that closely tracks the envelope. The amount of ET power is dynamic and depends 
on the makeup of the envelope shaping function. Less power for the same result 
equates to the increased system efficiency. ET for UE is expected to reduce wasted 
energy from PA by more than 50%, cutting heat dissipation and extending battery 
life. It can swing the DC supply over the 0.5-V to 4.5-V range delivering the best 
possible efficiency and linearity. ET is ideal for UE applications because no com-
plex, power-hungry DSP is needed for a digital predistortion (DPD) scheme. ET 
can be optimized for either best efficiency or best linearity conditions that do not 
occur at the same supply voltage. From the efficiency aspect, besides increased bat-
tery life, ET supports low-voltage batteries, which enables RF PAs to operate more 
effectively off low voltages. At the same time, the operating temperature of PA is 
reduced with ET. It provides solid thermal relief by reducing PA junction tempera-
ture increase across broad range of high-power operation.
Furthermore, ET can bring about an approximately 2- to 4-dB peak power 
increase for UE PA, which can enhance rapid data uploads with up to three times 
faster speed and increased capacity for high-speed data applications. Therefore, 
from a system perspective, ET not only significantly improves data coverage but 
also increases network capacity by increasing peak 3G and 4G transmit power to 
enable significant coverage and speed benefits in a typical cell. Another important 
benefit of ET for UE is that it reduces problems with antenna by significantly re-
ducing antenna mismatch problems commonly experienced in modern UEs. 
2.7.3  VSWR Immunity in ET
In point of fact, the UE RF PA topology constantly evolves to keep pace with the 
high-efficiency requirements. Traditionally, high-performance UE PA designs take 
quadrature balanced designs. It is carried out for several generations, mainly be-
cause it compromises the demand for efficiency against the need for voltage standing 
wave ratio (VSWR) tolerance. Note that most UE PAs are typically directly con-
nected to the terminal antenna through a switch or filter network, which means that 
the efficiency is directly correlated to the quality of the impedance match between 
the PA output and the input of the front-end module. It indicates that a superior 

2.8  Frequency Agility 
85
impedance matching yields superior efficiency. However, the environment of mobile 
antennas is regularly and dynamically changing, leading to impedance variations. A 
tremendous number of both static and dynamic variables, including antenna mate-
rial, location, and proximity or orientation to the human body, are impacting the 
obvious impedance variation. Mismatch of load impedance is measured by VSWR. 
Conventionally, PAs have been designed to meet high VSWR requirements to deal 
with the unpredictable environment with sufficient design margins.
Unfortunately, the quadrature balanced architecture is not a sufficiently ef-
ficient candidate. Therefore, once the VSWR requirement is relaxed, single-ended 
architecture is preferred for UE PA because of its higher efficiency compared to the 
former balanced counterparts. However, single-ended solution gains efficiency at 
the expense of limited VSWR tolerance. It works with passive impedance matching 
schemes as long as the VSWR range can be guaranteed through design. Therefore, 
ET can facilitate the single-ended design to a fare-thee-well at this point.
With more and more attention concentrated on ET, a dramatic shift to the ET 
PA design approach is emerging. ET PA is another weapon for combating the chal-
lenges of power saving in single-ended UE designs. The ET solution relies heavily 
on the solid harmonization of supply modulator and RF PA. In an ET system, the 
amount of energy provided to the PA dynamically changes as the content to be 
transmitted changes. Instead of dissipating significant amounts of energy in the PA, 
the PA is only provided with the energy that it will pass directly to the antenna. ET 
helps deal with high VSWR resulting from the antenna detuning common in hand-
sets. Poorly matched and greatly detuned antennas can produce VSWR values as 
much as 20:1. Most traditional PAs cannot handle such a range even with variable 
tuning networks. High VSWR leads to a greatly increased EVM, which results in 
lower speeds or dropped calls. However, ET PAs can deliver consistent saturated 
operation, keeping the EVM low even with higher VSWR. Therefore, ET can play 
the role of savior from the single-ended solution from the VSWR tolerance battle.
2.8  Frequency Agility
The intrinsic frequency agility nature of ET enables us to solve the frequency band 
fragmentation issue in LTE-A and beyond. Usually, it is desirable for a single PA 
designed for one band to be used across multiple frequency bands while increasing 
performance and still meeting system specifications.
The request to simultaneously support different systems in UE, such as GSM, 
WCDMA, HSPA, LTE, or LTE-A while supporting the increasing number of fre-
quency bands, has consequently resulted in significant growth in RF system com-
plexity. At the same time, battery life continues to be a major issue with UEs and 
will worsen with greater data consumption and always-on connectivity.
2.8.1  MMMB PA with ET
The traditional approach to facing these challenges has been to use a number of 
separate PAs within the UE RF system, each covering a fairly narrow band and 
optimized for peak efficiency for that band and the system being supported. This 
works well when only a few frequency bands are required, but quickly becomes 

86 
���������������������������������������
Envelope Tracking Power Amplifier Basics
very complex for MMMB UEs for global bands, with RF switching and thorny 
thermal issues all making a compact, cost-effective solution extremely difficult to 
achieve.
MMMB PAs enable worldwide global roaming for UEs. It has become a criti-
cal issue. In ET, the RF signal and envelope supply own a band-splitting character, 
which results in the band fragmentation merely laying on requirements to RF chan-
nel without any other restrictions. As well, the ET PA has another major advan-
tage for MMMB operation because multimode (MM) and multiband (MB) can 
be handled separately. Namely, the MM operation is provided through the MM 
supply modulator [26, 27], whereas the MB operation is handled separately by the 
PA without considering the MM operation. For enhanced efficiency in a back-off 
region, the use of a RF PA with a tunable load is the most popular approach when 
using a UE PA without a supply modulator. A RF PA with a tunable load can be 
combined with a supply modulator to achieve great improvement in efficiency over 
the entire back-off power region. Also, the reconfiguration capability by using tun-
able components (e.g., varactor) can make a single RF PA design matching to adapt 
to various frequency bands of UE, as shown in Figure 2.25.
As shown in Figure 2.25, for existing 2G to 4G evolutions, it is possible to use 
reconfigurable MMMB ET PA to cover 16 frequency bands for single UE PA to 
cover as follows:
••
2G GSM operation in 850-, 900-, 1,800-, and 1,900-MHz bands;
••
3G operation in the 850-, 900-, 1,800-, 1,900-, and 2,100-MHz bands;
Figure 2.25  An examplary reconfigurable MMMB ET PA design with a single-power transistor to cover 
typical 16 LTE UL bands for UEs. By RF switching and tuning with a varactor, the PA can be configured into 
the target band. ET helps to boost the efficiency over a wide band of such an MMMB PA and makes it more 
promising for common use.

2.8  Frequency Agility 
87
••
3.9G FDD-LTE in the 700-, 800-, 850-, 900-, 1,700-, 1,800-, 1,900-, 2,100-, 
and 2,600-MHz bands;
••
3.9G TDD-LTE in the 2,300-, 2,600-, and 2,700-MHz bands.
2.8.2  ET PA Integration
ET focuses on alleviating the RF PA impact power consumption. Obviously, each 
degree of power saving sophistication comes with increasing costs in both footprint 
and component BOM costs. These are cost trade-offs available to RF designers in 
their never-ending quest to balance the brutal challenges for power saving. There-
fore, integration is a trend for ET technique development as well.
RF PAs based on GaAs HBT show decent performance not only in terms of 
efficiency but also linearity owing to their high breakdown voltage and low knee 
voltage characteristics. Many studies on ET PAs for UEs have been done using such 
HBTs. However, the supply modulator for ET is generally implemented at a CMOS 
foundry. Therefore, the GaAs HBT PA is in conjunction with a CMOS supply 
modulator on the PCB or package, composing a hybrid structure. Recently, many 
researchers have turned their attention to the development of CMOS-based linear 
PAs, which can be cointegrated with the supply modulator on the same die for a 
one-chip ET solution, which thus reduces the size and cost of the UE PA. However, 
it is not an easy task to substitute the GaAs HBT PA with a CMOS PA. CMOS 
has several disadvantages compared with GaAs HBTs. The three major problems 
are the low breakdown voltage, lack of support of ground via, and high substrate 
loss. Numerous research efforts have been dedicated to solve these problems, and 
recently, highly linear CMOS PAs have emerged in the market because CMOS PAs 
are much less expensive than their typical GaAs counterparts. They work well in 
GSM and Wi-Fi applications, but their compression characteristics make them less 
desirable in 3G and LTE-A applications. Fortunately, ET can enable and further 
enhance the use of CMOS PAs in UEs [29, 30]. ET can eliminate this weakness, 
however, making CMOS PAs a respectable design choice. This benefit potentially 
can lower overall PA costs and provide a gateway opportunity for single-die CMOS 
integration of the PA and the ET circuitry. With advanced design techniques, fur-
ther performance improvements may be possible by replacing the GaAs HBT PAs. 
References
[1]	
Cripps, S. C., RF Power Amplifiers for Wireless Communications, Norwood, MA: Artech 
House, 2006.
[2]	
Kim, I., et al., “High-Efficiency Hybrid EER Transmitter Using Optimized Power Ampli-
fier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 56, No. 11, 2008, pp. 
2582–2593.
[3]	
Jeong, J., et al., “Modeling and Design of RF Amplifiers for Envelope Tracking WCDMA 
Base-Station Applications,” IEEE Transactions on Microwave Theory and Techniques, 
Vol. 57, No. 9, 2009, pp. 2148–2159.
[4]	
Staudinger, J., et al., “800 MHz Power Amplifier Using Envelope Following Technique,” 
Proc. IEEE Radio and Wireless Conf., August 1999, pp. 301–304. 

88 
���������������������������������������
Envelope Tracking Power Amplifier Basics
[5]	
David, K. S., and W. J. McFarland, “An IC for Linearizing RF Power Amplifiers Using En-
velope Elimination and Restoration,” IEEE Solid-State Circuits, Vol. 33, No. 12, Decem-
ber 1998, pp. 2252–2258.
[6]	
Kim, B., et al., “Push the Envelope: Design Concepts for Envelope-Tracking Power Ampli-
fiers,” IEEE Microwave Magazine, Vol. 14, No. 3, April 2013, pp. 68–81.
[7]	
Kim, I., et al., “High Efficiency Hybrid EER Transmitter Using Optimized Power Ampli-
fier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 56, No. 11, Novem-
ber 2008, pp. 2582–2593.
[8]	
Raab, F. H., “Envelope Elimination and Restoration System Requirements,” Proc. RF 
Technology Expo ’88, Anaheim, CA, February 1988, pp. 499–512.
[9]	
Sowlati, T., et al., “Quad-Band GSM/GPRS/EDGE Polar Loop Transmitter,” IEEE J. Solid-
State Circuits, Vol. 39, No. 12, December 2004, pp. 2179–2189.
[10]	
Hietala, A.W., “A Quad-Band 8PSK/GMSK Polar Transceiver,” IEEE RFIC Symp. Dig., 
Long Beach, CA, 2005, pp. 9–12.
[11]	
Wang, F., et al., “Design of Wide-Bandwidth Envelope-Tracking Power Ampliﬁers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 4, April 2005, pp. 1244–1255.
[12]	
Jeong, J., et al., “Modeling and Design of RF Ampliﬁers for Envelope Tracking WCDMA 
Base-Station Applications,” IEEE Transactions on Microwave Theory and Techniques, 
Vol. 57, No. 9, September 2009, pp. 2148–2159.
[13]	
Hsia, C., D. Kimball, and P. M. Asbeck, “Effect of Maximum Power Supply Voltage on 
Envelope Tracking Power Ampliﬁers Using GaN HEMTS,” IEEE RWS Symp. Dig., Janu-
ary 2011, pp. 1–4.
[14]	
Sundstrom, L., “The Effect of Quantization in a Digital Signal Component Separator for 
LINC Transmitters,” IEEE Transactions on Vehicular Technology, Vol. 45, No. 2, May 
1996, pp. 346–352.
[15]	
Nee, R. V., and R. Prasad, OFDM for Wireless Multimedia Communications, Norwood, 
MA: Artech House, 2000.
[16]	
Hanington, G., et al., “High Efficiency Power Amplifier Using Dynamic Power-Supply 
Voltage for CDMA Applications,” IEEE Transactions on Microwave Theory and Tech-
niques, Vol. 47, No. 8, August 1999, pp. 1471–1476.
[17]	
Groe, J. B., and L. E. Larson, CDMA Mobile Radio Design, Norwood, MA: Artech House, 
2000.
[18]	
Raab, F.H., “Split-Band Modulator for Kahn-Technique Transmitters,” 2004 IEEE MTT-S 
International Microwave Symposium Digest, Vol. 2, 2004, pp. 887–890.
[19]	
Draxler,P., et al., “High Efficiency Envelope Tracking LDMOS Power Amplifier for W-
CDMA,” IEEE MTT-S International Microwave Symptoms Digest, June 2006, pp. 
1534–1537.
[20]	
Hoversten, J. Z., M. N. Popovic, and D. Maksimovic, “Power Amplifier to Envelope Mod-
ulator Interconnects for Envelope Tracking Transmitters,” Intellectual property disclosure, 
University of Colorado at Boulder, Boulder, CO, April 2009.
[21]	
Jeong, J., et al., “High-Efficiency WCDMA Envelope Tracking Base Station Amplifier Im-
plemented with GaAs HVHBTs,” IEEE Journal of Solid-State Circuits, Vol. 44, No. 10, 
October 2009, pp. 2629–2639.
[22]	
Aitto-oja, T., “High Efficiency Envelope Tracking Supply Voltage Modulator for High 
Power Base Station Amplifier Applications,” 2010 IEEE MTT-S International Microwave 
Symposium Digest (MTT), 2010, pp. 668–671.
[23]	
Kimball, D. F., et al., “High-Efficiency Envelope Tracking W-CDMA Base Station Amplifier 
Using GaN HFETs,” IEEE Transactions on Microwave Theory and Techniques, Vol. 54, 
No. 11, November 2006, pp. 3848–3856.
[24]	
Wang, F., “An Improved Power-Added Efficiency 19-dBm Hybrid Envelope Elimination 
and Restoration Power Amplifier for 802.11g WLAN Applications,” IEEE Transactions 
on Microwave Theory and Techniques, Vol. 54, No. 12, December 2006, pp. 4086–4099.

2.8  Frequency Agility 
89
[25]	
Kim, I., et al., “High Efficiency Hybrid EER Transmitter Using Optimized Power Ampli-
fier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 56, No. 11, Novem-
ber 2008, pp. 2582–2593.
[26]	
Choi, J., et al., “A New Power Management IC Architecture for Envelope Tracking Power 
Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, No. 7, July 
2011, pp. 1796–1802.
[27]	
Kang, D., et al., “A Multimode/Multiband Power Amplifier with a Boosted Supply Modu-
lator,” IEEE Transactions on Microwave Theory and Techniques, Vol. 58, No. 10, October 
2010, pp. 2598–2608.
[28]	
Hubbard, M., “Taming the Smartphone Power Consumption Vicious Cycle,” Microwave 
Journal, November 2012, pp. 92–96. 
[29]	
Park, B., et al., “A 31.5%, 26 dBm LTE CMOS Power Amplifier with Harmonic Control,” 
Proc. 42th European Microwave Conference, Amsterdam, the Netherlands, October 29–
November 1, 2012, pp. 1–4. 
[30]	
Kang, D., et al., “A 34% PAE, 26-dBm Output Power Envelope-Tracking CMOS Power 
Ampliﬁer for 10-MHz BW LTE Applications,” IEEE MTT-S International Microwave 
Symp. Digest, Montreal, Canada, June 17–22, 2012, pp. 1–3.
[31]	
Zhang, X. J., L. E. Larson, and P. M. Asbeck, Design of Linear RF Outphasing Power 
Ampliﬁers, Norwood, MA: Artech House, 2003.
[32]	
Wang, F., et al., “An Improved Power-Added Efficiency 19-dBm Hybrid Envelope Elimina-
tion and Restoration Power Amplifier for 802.11 g WLAN Applications,” IEEE Transac-
tions on Microwave Theory and Techniques, Vol. 54, No. 12, 2006, pp. 4086–4099.
[33]	
Cripps, S. C., Advanced Techniques in RF Power Ampliﬁer Design, Norwood, MA: Artech 
House, 2002.


91
C H A P T E R  3 
Envelope Generation and Alignment
One of the critical aspects of ET PA design is first to strip the RF carrier off to reveal 
the envelope and then transfer it with appropriate scaling to the supply bias of RF 
PA in a real-time manner, as shown in Figure 3.1. In other words, it requires gener-
ating an envelope signal utilized as a reference input for the ET supply modulator. 
In turn, the supply modulator uses the envelope signal to modulate a supply of an 
RF PA for efficiency enhancement. Actually, there are several schemes available to 
generate an envelope for purposes of ET, meeting the ever-increasing challenges of 
envelope generation and timing alignment for advanced modulated signals such as 
4G LTE-A.
As discussed in Chapter 2, for LTE-A signals, the modulation bandwidth of en-
velope required by ET is at least three times wider than the RF signal bandwidth to 
guarantee efficiency and linearity trade-offs. Therefore, deep insights of envelope 
signal generation and characteristics are significant to tailor the supply modulator 
design specification to achieve overall optimized ET system performance.
The most appropriate envelope generator for a particular application is mainly 
determined by the modulation standard and its characteristics. For example, 3G 
WCDMA standards work with frequency division duplex continuous transmission 
and have a constant modulation bandwidth of 5 MHz and a code division multiple 
accesses method. Envelope generators are designed toward these signal character-
istics because they track quickly enough to acquire the actual envelope voltage. 4G 
LTE-A standard can vary in modulation bandwidth. An exemplary signal with low-
modulation bandwidth is LTE-A with one resource block (RB). It has a modulation 
bandwidth of 200 kHz to be tracked. Accordingly, a 100-RB signal has a 20-MHz 
bandwidth to be tracked. Depending on the various modulation bandwidths, a 
bandwidth-maximized or tunable envelope generator to cover all scenarios would 
be preferred. 
Another well-known difficulty of ET technology implementation is the require-
ment for rigid timing alignment and offset adjustment between the dynamic supply 
voltage and the RF signal to be amplified. In other words, there is a demand for 
the envelope of the supply modulator delivered to the RF PA to align with the en-
velope of the amplified output signal. The misalignments may cause a reduction in 
overall efficiency of the ET PA and increased distortion of the output signal, which 
are unacceptable to system specifications such as EVM and ACPR. These teething 
troubles also raise extra challenges for the linearization schemes, such as predistor-

92 
���������������������������������
Envelope Generation and Alignment
tion, associated with the RF PA linearity performance, which is discussed further 
in Chapter 6.
3.1  Envelope Generation
Envelope generation is generally defined in this book as the means of extracting the 
envelope of a modulated signal. There are two main methods to realize the envelope 
generation. One is utilizing the RF envelope detector analog circuitry. The other is 
digitizing the waveform of the signal and performing a mathematical fit to deter-
mine the exact envelope values in base band processing. 
3.1.1  Analog Generation
As shown in Figure 3.2, this kind of envelope detector is called a linear envelope de-
tector because the output is proportional to the input envelope. An envelope detec-
tor is a fast-responding detector capable of following the envelope of a modulated 
RF carrier, in contrast to other detectors that give the peak, average, or RMS volt-
age. It is essentially just a half-wave rectifier that charges a capacitor to a voltage 
equal to the peak voltage of the incoming envelope waveform S(t). The purpose of 
capacitor C is to remove any radio frequency components of the signal at the diode 
output. The capacitor value is well defined so that it does not affect the envelope 
signal. When the input RF amplitude increases, the capacitor voltage is increased 
via the rectifying diode D. When the RF amplitude falls, the capacitor voltage is 
reduced by being discharged by a bleed resistor, R. The leakage path can also enable 
the capacitor to discharge, but this may be provided by the following circuit into 
which the envelope detector is connected. The obvious advantage of this analog 
envelope detector is its simplicity and low cost. Unfortunately, it does suffer from 
some practical problems. For example, the diodes used may introduce appreciable 
levels of harmonic distortion unless modulation levels are kept low. As a result, 
these detectors cannot provide a high-quality signal as its digital counterpart does. 
Subsequently, the RC filter determines the averaging or holding time. The selection 
Figure 3.1  Buildup of a modulated RF signal and its envelopes. The absolute values of upper and 
lower envelope signals are limited by envelope peak values. The carrier signal upconverts the base-
band signal into an RF frequency.

3.1  Envelope Generation 
93
of the holding time configures the diode detector for its particular application. For 
ET application, a relatively small RC time constant is required so that the output 
voltage tracks the envelope nicely. The envelope output voltage is proportional to 
the envelope of the input signal. However, relatively small dynamic range of the 
diode detector is another physical performance limitation. 
Although it is not as accurate and well controlled as its digital counterpart, its 
low complexity, low power dissipation, and low-cost advantages draw much at-
tention for applications of cost-sensitive scenarios. Likewise, it is capable to realize 
a “self-contained” ET system in one single RF module without considerable assis-
tance by digital signal processing. Finally, a diode envelope detector must preserve 
the envelope frequencies greater than three times that of the RF channel signal 
bandwidth and filter out the carrier, which ensures that the carrier does not intro-
duce an error in the envelope generation process.
Although a typical RF envelope detector is a fast-responding detector capable 
of following the envelope of a modulated RF carrier, it requires capturing an en-
velope in a nanosecond transition time during a transmission slot. Normally, the 
transmit power level has to be adjusted to a proper level before entering the enve-
lope detector block to guarantee that it operates in the linear region, as illustrated 
in Figure 3.2. As well, the diode detector is typically utilized with a relatively long 
holding time when compared to the carrier frequency and a relatively short holding 
time with respect to the envelope frequency. In this manner, a diode detector is ca-
pable to play a role of envelope tracker [1–3]. The RF detector circuit mainly relies 
on the behavior of the diode. It allows current through the time when the input is 
higher than the capacitor voltage, hence “topping up” the capacitor voltage to the 
peak level but blocking any current from flowing back out through the diode when 
the input voltage is below the capacitor voltage. Unfortunately, all real diodes are 
nonlinear. The current that they pass varies with the applied voltage. As a result, 
the demodulated output is slightly distorted in a way that depends on the I-V char-
acteristic of the diode. Accordingly, this type of diode envelope detector is not any 
good if the recovered waveform is required as an accurate representation of the 
original modulating waveform. The circuit also suffers from the problems known 
as ripple and negative peak clipping. These effects are illustrated in Figure 3.3. The 
ripple effect happens because the capacitor will be discharged a small amount in 
Figure 3.2  The simplified RF envelope detector circuitry operates as typical analog envelope generator, 
including tunable attenuation for RF signal scaling, RF envelope detector, and soft-limiting the envelope 
shaping circuit.

94 
���������������������������������
Envelope Generation and Alignment
between successive peaks of the input RF signal. The illustration shows what hap-
pens in the worst possible situation in which the modulating signal is a high-PAPR 
signal whose frequency is not much lower than the carrier frequency. Similar but 
less severe problems can arise with other modulated signals.
Consider what happens when there is a carrier frequency fc and an RF envelope 
detector is used whose time constant τ = R · C. The time between successive peaks 
of the carrier can be expressed as
	
1
c
T
f
=
	
(3.1)
Each peak may charge the capacitor to some voltage Vpeak, which is propor-
tional to the modulated amplitude of the RF signal. Between each peak and the 
next, the capacitor voltage will therefore be discharged to 
	
T
peak
peak
V
V
e
τ
−
=
⋅
′
	
(3.2)
Provided that T << τ, which is approximately the same as 
	
(
)
1
peak
peak
V
V
T τ
≈
⋅
−
′
	
(3.3)
the peak-to-peak size of the ripple ∆V will therefore be 
	
(
)
(
)
peak
peak
c
V
V
T
V
f
τ
τ
∆
≈
⋅
=
⋅
	
(3.4)
A sudden and dramatic reduction in the amplitude of the input signal means 
that the capacitor charge is not being topped up by each cycle peak. The capacitor 
voltage therefore falls exponentially until it reaches the new, smaller peak value. To 
assess this effect, consider what happens when the RF signal amplitude suddenly 
Figure 3.3  Illustration of an RF envelope detector output with ripple and negative peak clipping 
effect.

3.1  Envelope Generation 
95
reduces from Vpeak to a much smaller value. The capacitor voltage then declines 
according to 
	
t
drop
peak
V
V
e
τ
−
=
⋅
	
(3.5)
it produces the negative peak clipping effect where any swift reductions in the RF 
signal amplitude are rounded off and the output is distorted. Here the worst pos-
sible case of QAM modulation has been chosen. In practice, the modulating signal 
is normally restricted to a specific frequency range. This limits the maximum rate 
of fall of the RF signal amplitude. Negative peak clipping can be alleviated by ar-
ranging that the time constant of detector with τ << tenv, where 
	
1
env
env
t
f
=
	
(3.6)
and fenv is the highest modulation frequency used in a given situation. Hence, the 
above implies that negative peak clipping can be avoided by choosing a small value 
of τ. However, to minimize ripple, it is desirable to make t as large as possible. In 
practice, a value of τ chosen therefore should be 
	
τ


1
1
env
c
f
f 	
(3.7)
to minimize the signal distortions caused by these effects. This is clearly only pos-
sible if the modulation frequency fenv << fc. Envelope detectors only operate satis-
factorily when the inequality in (3.7) is truly ensured.
Although the output of envelope detector is proportional to RF envelope am-
plitude with sufficiently fast responding, it suffers from several drawbacks such 
as small input dynamic range, poor temperature stability without temperature 
compensation, and performance dependence on input signal waveform shape and 
PAPR. Furthermore, the nonlinear response drawback loses accuracy at low input 
powers as the output response begins to fan out. As the input power is reduced, the 
spread of the output response increases along with the error. 
Finally, the ET technique is typically required to process with precise analog 
signals on its envelope path. Consequently, the circuits used to generate the enve-
lope and the supply voltage for RF PA can be sensitive to differences in component 
operating characteristics caused by, for example, manufacturing tolerances and 
differences in the operating environment such as ambient temperature. From this 
point, analog envelope generation may easily suffer from part-to-part variation in 
volume production.
3.1.2  Digital Generation
Based on understanding the drawbacks of analog envelope generation above, an 
envelope signal generated by such traditional analog methods is not sufficiently fast 
or accurate enough for the advanced RF modulated signal applications, especially 
with broadband and high-PAPR characteristics. Figure 3.4 shows the digital enve-
lope generation scheme required for ET purpose. The reference envelope voltages 
derived from the magnitude of the in-phase (I) and quadrature-phase (Q) signals us-
ing a look-up table (LUT) or equivalent signal transformation. Typically, the direct 

96 
���������������������������������
Envelope Generation and Alignment
Figure 3.4  Simplified block diagram of ET transmitter system to illustrate the digital envelope generation scheme.

3.1  Envelope Generation 
97
magnitude signal is not the most ideal to drive the supply of the PA and will need to 
be modified with envelope shaping functions. The contents of the LUT, or the signal 
transformation, can be varied for system optimization. 
In Figure 3.4, the amplitude of the envelope can be computed as the unsigned 
polar magnitude of the I-Q signals and is representative of the input signal ampli-
tude across the full range of signal powers. The envelope calculation is performed 
right between the crest factor reduction (CFR) block and the digital predistorter 
block. Digital predistortion (DPD) observation for ET PA comprises a feedback 
path from the output coupling to the DSP unit. The feedback path is typically 
adapted to convert the RF output signal back to the digital domain, also perform-
ing downconversion of the RF signal, thus facilitating calculation of the error mea-
sure and linearization.
For proper tracking purposes, the envelope reference signal requires a mini-
mum bandwidth at least five times that of the modulation rate considering IMD3 
DPD. For a typical ET sample rate of 153.6 Msps, a signal bandwidth of 20 MHz 
can be accommodated for LTE application. As a result, there is a demand for a 
method and system that generates fast envelope signals using digital I-Q signals to 
drive an envelope supply modulator.
The basic mathematical principle of envelope magnitude calculation is calcu-
lating the magnitude of the complex base band signal (BB(n) = I(n) + jQ(n)) with 
the envelope as
	
( )
( )
( )
2
2
E n
I n
Q n
=
+
	
(3.8)
where I(n) and Q(n) are the digitized real and imaginary parts of the complex 
signal. To implement this envelope magnitude function, there are several options 
from which to choose, such as polynomial approximations and the coordinate 
rotation digital computer (CORDIC) vectoring mode [4, 5]. Compared to other 
approaches, CORDIC is a clear winner because it does not need any hardware mul-
tiplier, which is especially attractive when multipliers are not available, for example, 
in a microcontroller. 
The concept of CORDIC was introduced in 1959 by Jack E. Volder as a hard-
ware-efficient algorithm to evaluate trigonometric functions [6]. The algorithm is 
dominated by bit shifts and additions and so was an ideal match for early-gener-
ation computing technology in which multiplication and division were expensive 
in terms of computation time and physical resources. Volder essentially presented 
iterative techniques for performing translations between Cartesian and polar coor-
dinate systems and a method for realizing a plane rotation via a series of arithmetic 
shifts and adds. The delay and hardware cost are comparable to division or square 
rooting implementation.
The basic idea of this algorithm is to use a series of fixed angles associated 
with the computing base data to approximate the angle needed or to say that the 
CORDIC algorithm is a numerical approximation algorithm for linear computing 
[7]. The biggest advantage of this algorithm is that only through simple shift and 
accumulation can it complete complex mathematical operations, and it takes up 
fewer resources with high precision and speed. A general block diagram of using 

98 
���������������������������������
Envelope Generation and Alignment
the CORDIC algorithm for envelope magnitude calculation is displayed in Figure 
3.5.
After the envelope magnitude calculation process is calculated in (3.8), the 
results from the CORDIC operation have to be corrected because of the inherent 
magnitude expansion in the circular mode. Postmultiplying the result I(n), Q(n) is 
the straightforward way to compensate for the scaling factor at the expense of the 
latency increase with one multiplication. This increases the latency and requires a 
lot of hardware. Many studies have dealt with this problem and suggest different 
methods to reduce the cost of the scaling [8–18].
3.1.3  MIPI eTrak Interface
The Mobile Industry Processor Interface (MIPI) Alliance, an international organi-
zation that develops interface specifications for mobile and mobile-influenced in-
dustries, announced a standard analog reference interface specification between the 
generator and supply modulator for ET as eTrak [19]. The eTrak is a multisource, 
vendor-independent interface that provides interoperability between envelope gen-
erator and ET supply modulator, enabling wide deployment of ET technology for 
UE purposes in the industry [20]. The eTrak is unique in that unlike other MIPI 
specifications, it provides a full analog interface rather than only a port physical 
layer (PHY). 
The eTrak specification offers a standardized interface in between the envelope 
generator and supply modulator so as to convey an analog representation of the 
desired power supply voltage to the later. The eTrak describes a high-speed analog 
differential interface used between envelope generator and supply modulator to 
support ET. Interface specification applies to cellular transmitter architectures in 
general but specifically for HSUPA and LTE transmitters supporting up to 20-MHz 
channel bandwidth [21–23]. Effort has been made to maintain flexibility where it 
does not trade off compatibility or cost, hence leaving design freedom for the enve-
lope generator and supply modulator manufacturers.
As shown in Figure 3.6, a typical exemplary supply modulator supports the 
eTrak analog differential front end interface for ET and a 1.8-V MIPI RF front-end 
(RFFE) digital control interface [20] to simplify integration with various RF plat-
forms. The eTrak also allow seamless transition between ET and average power 
tracking (APT) operating modes. At low transmission output power, the supply 
modulator can be transitioned to APT mode in which the linear part of supply 
Figure 3.5  Digital envelope magnitude calculation implementation structure based on CORDIC.

3.1  Envelope Generation 
99
modulator is placed into shutdown mode to improve system efficiency and only 
switch-mode power supply (SMPS) is enabled to supply various levels. Under the 
ET mode, the supply modulator provides ET supply voltage for the RF PA, maxi-
mizing total ET PA system efficiency. The supply modulator follows the differential 
envelope reference input signal delivered by the envelope generator via eTrak. The 
output is a single-ended dynamic power supply voltage to the RF PA. 
The eTrak interface utilizes differential signaling. VETP and VETN signals are 
the positive signal and negative signal, respectively. The supply modulator output 
single-ended voltage Vsm can be defined as
	
(
)
sm
offset
sm
REF
offset
sm
EIP
ETN
V
V
G
V
V
G
V
V
=
+
⋅
=
+
⋅
−
	
(3.9)
where Voffset is the supply modulator output voltage with VETP and VETN equal. 
VREF is the gain of the differential input voltage amplification by the supply modu-
lator. The reference voltage VREF is defined as the difference between VETP and 
VETN. The eTrak interface driver specification for envelope generator with two 
classes, 2VPP and 1.5VPP are summarized in Table 3.1.
From Table 3.1, the eTrak specification includes two interface voltage classes: 
the 2VPP interface class and 1.5VPP interface class. The 2VPP interface class tar-
gets transmitters and receivers with a supply voltage of at least 1.8V, whereas the 
1.5VPP interface class targets devices with a supply voltage of at least 1.2V. The 
common-mode voltage VCM of the 2VPP and 1.5VPP interfaces are defined as 0.9V 
and 0.6V, respectively. The reference voltage VREF of the 2VPP and 1.5VPP interface 
is defined in the range –1V < VREF < +1V and –0.75V < VREF < +0.75V, respectively.
Figure 3.6  Typical functional blocks of an ET PA system with envelope generator interfacing sup-
ply modulator. The transmit path generates three signals, the usual signal RF input and an envelope 
reference input voltage (VREF) transmitted over the eTrak interface from the envelope generator to 
the supply modulator. (From: [19]. © 2013 MIPI Alliance. Produced with permission. MIPI Alliance 
specifications are confidential and are available to members only.)

100 
���������������������������������
Envelope Generation and Alignment
From a technology implementation perspective, the total PCB interconnect and 
input capacitance for supply modulator with and without internal filtering should 
not exceed 15 and 20 pF either in an active state or an inactive state, respectively, 
which allows up to 5-cm interface length on the PCB between the generator and 
modulator. Also, the input total common mode and differential resistance of sup-
ply modulator should be more than 10 kΩ per supply modulator input impedance. 
Finally, the eTrak envelope generator interface driver specification is divided 
into four interface bandwidth classes, determined by the driver bandwidth in which 
the peak-to-peak amplitude ripple should not exceed 1-dB bandwidth (BW1dB). 
The BW1dB requirement is at least 90% of the nominal bandwidth of the modulat-
ed signal or occupied bandwidth (OBW) in 3GPP requirements. For example, for 
20-MHz LTE, the envelope generator output signal bandwidth should be greater 
than 18 MHz.
3.2  Envelope Detector Specifications
Unlike digital envelope generation, the analog generation approach involves analog 
and RF components inside. Therefore, the envelope detector performance is mainly 
to fall back on the performance of components in circuitry, which can be the short 
board to limit the overall analog envelope generation to compete with digital enve-
lope generation schemes. The performance of an envelope detector can be expressed 
by a variety of parameters as discussed next, again noting that the response should 
be linear with envelope voltage.
Table 3.1  Summary of the eTrak Envelope Generator Interface Driver Specification
Parameters
LTE20
LTE10
HSPA
APT
1-dB bandwidth
18 MHz
9 MHz
4.5 MHz
No limit
Number of LTE RB
100
50
25
No limit
Slew rate
35 V/us
20 V/us
10 V/us
No limit
VREF range for 2VPP/1.5VPP
±1/±0.75V
±1/±0.75V
±1/±0.75V
±1/±0.75V
Typical VCM voltage for 
2VPP/1.5VPP
900/600 mV
900/600 mV
900/600 mV
900/600 mV
Differential voltage accuracy
±2%
±2%
±2%
±2%
Third and fifth harmonic 
voltage
<3%
<3%
<3%
<3%
Differential load capacitance 
with or without external 
filtering
15 pF/20 pF
15 pF/20 pF
15 pF/20 pF
15 pF/20 pF
Maximum voltage for 
2VPP/1.5VPP
2.2/1.6V
2.2/1.6V
2.2/1.6V
2.2/1.6V
Minimum voltage for 
2VPP/1.5VPP
−0.4/−0.4V
−0.4/−0.4V
−0.4/−0.4V
−0.4/−0.4V
Source: [19]. 

3.2  Envelope Detector Specifications 
101
3.2.1  Dynamic Range
As shown in Figure 3.7, dynamic range (DR) is defined as the ratio between Pmax 
and Pmin. Pmax denotes the highest input power level that the detector can sense 
before unacceptable distortions occur in the conversion process. It is usually de-
termined by its compression characteristics. Also, Pmin denotes the minimum input 
power level the detector can accept, which is set by the noise floor level. Therefore, 
dynamic range is the ratio between the largest and smallest possible envelope volt-
ages or powers. The envelope detector must operate over a wide dynamic range for 
decent ET performance. Achieving the highest possible dynamic range is extremely 
important for precise envelope generation, which is one of the key factors in deter-
mining ET modulation performance.
Typically, the dynamic range is designed to have a predictable and accurate 
response over a certain input power range. For determining the dynamic range, a 
couple of different criteria can be used such as linear conformance error (ELC) and 
variation over temperature error (EVOT). Therefore, the specified dynamic range 
is the range over which the specified error metric is within a predefined window. 
Actually, there are several dynamic range improvement methods [3], which results 
in a very low part-to-part variation. Similar approaches imply that compensation 
for systematic imperfection could be beneficial. For example, it is meaningful to 
compensate with the typical ELC for 25°C of the envelope detector. It would cor-
rect for systematic bending at the lower and top ends of the curve. As a result, a 
significant improvement of the dynamic range can be achieved. With this method, 
a dynamic range improvement of 10 dB can be obtained [3]. Likewise, EVOT com-
pensation can also be done to move a larger portion of the error band within the 
±0.5 dB, for instance.
3.2.2  Modulation Bandwidth
For ET, the varying envelope is generated by amplitude modulation (AM) compo-
nent. Therefore, its envelope bandwidth or modulation bandwidth can be under-
stood by AM modulation bandwidth concept. AM is an analog modulation scheme 
where the amplitude of a fixed-frequency carrier signal is continuously modified 
to represent informative data. The carrier signal is generally a high-frequency sine 
wave used to carry the information on the envelope. It results in a double sideband 
Figure 3.7  Illustration of the notion of dynamic range of an RF envelope detector.

102 
���������������������������������
Envelope Generation and Alignment
signal, centered on the carrier frequency, with twice the bandwidth of the original 
signal.
Before starting to understand the complex modulated envelope, it is rather 
straightforward to use the simplest AM to depict the modulation bandwidth con-
cept here. As an example, an AM waveform with 50% modulation is shown in 
Figure 3.8 where 50% modulation means that the carrier amplitude varies by 50% 
above its unmodulated level.
An ideal carrier waveform contains a single frequency and occupies very little 
spectrum. When the carrier is amplitude modulated, sideband tones are created 
both above and below the carrier center frequency. It causes the signal to use up a 
greater portion of the frequency spectrum. The amount of half of the spacing be-
tween two tones is defined as the modulation bandwidth of the envelope. In other 
words, the bandwidth of envelope is a function of the frequencies contained in the 
modulated signal. For example, when a 2-GHz carrier is modulated by a 10-MHz 
single tone, sideband frequencies are created at 1.99 and 2.01 GHz. This AM signal 
requires 20 MHz of space in the spectrum. However, for the ET application, only 
one sideband signal is used for envelope extraction, so the modulation bandwidth 
for ET is 10 MHz.
Furthermore, modulation standards available nowadays have a wide variety 
of modulation bandwidths. 4G LTE-A, for instance, has modulation bandwidths 
varying from 200 kHz (1RB) up to 20 MHz (100RB). Whether the RF detector can 
Figure 3.8  Illustration of the amplitude modulation bandwidth notion in the time and frequency 
domains.

3.2  Envelope Detector Specifications 
103
track the envelope of these modulated RF signals mainly depends on its modulation 
bandwidth availability. Figure 3.9 depicts the frequency response of a typical enve-
lope detector. It shows the output as a function of a varying AM frequency where 
the output is normalized to 0 dB at a low modulation frequency.
The modulation bandwidth of an envelope detector is typically defined as the 
1-dB roll-off bandwidth for a specific input power level (e.g., 0 dBm). For example, 
it complies to the MIPI eTrak interface driver bandwidth in which the peak-to-peak 
amplitude ripple should not exceed 1 dB.
3.2.3  Slew Rate
The slew rate concept is commonly used to define the speed of envelope and ET 
supply. It is the rate of change in the output voltage caused by a step change on the 
input. It can be measured as a voltage change in a given time typically in unit as V/
µs.
Furthermore, let us expand the topic of the slew rate rationale to include the 
whole supply modulator level beyond the envelope detector component. The ET 
slew rate issues arise mainly from the internal circuitry within the supply modula-
tor with large signals. There are two main reasons for the limitations of modula-
tors. First, it stems from the frequency compensation function inside modulators. 
The capacitors used within the supply modulator to reduce the high-frequency 
response have a marked effect on the slew rate. Limiting the frequency response 
also limits the rate of change that can occur at the output, and hence it affects the 
overall supply modulator slew rate.
Second, it results from the high-power output driver stage limitations. Within 
the supply modulator, and particularly within the output driver stage, the low cur-
rent levels limit the rate at which change can occur. This limits the slew rate of the 
supply modulator. It is found that this is the area of the performance where rise 
and fall slew rates may be different. This results from the different manners that 
the modulator increases and decreases the output voltage. For example, the output 
stage may employ a form of complementary output structure. The slightly different 
Figure 3.9  Illustration of the modulation bandwidth of a typical wideband envelope detector for 
LTE-A applications.

104 
���������������������������������
Envelope Generation and Alignment
characteristics of each half would cause a small amount on difference between the 
rise and fall slew rate capabilities.
Considering these nonideal factors, if a supply modulator was operated above 
its own slew rate limit, signals would become distorted. A simple way to illustrate 
this phenomenon is to observe an example of a sine wave, as shown in Figure 3.10. 
The maximum rate of voltage change occurs at the zero crossing point. Thereafter, 
it is possible to calculate the slew rate baseline requirement for ET by finding the 
maximum frequency component and voltage of envelope that can be accommo-
dated for minimum distortions. Hence, a typical sine waveform with a frequency 
of fmax and peak voltage Vpeak volts requires a supply modulator with a slew rate 
Rslew as
	
max
2
slew
peak
R
f
V
π
=
⋅
⋅
⋅
	
(3.10)
with the unit of Rslew as volts per second. This is required to ensure the baseline slew 
rate requirement that occurs at the zero crossing point can be met for ET operation.
As can be seen in Figure 3.11, the supply modulator slewing distortion will 
result in the creation of a triangular-shaped waveform with sine wave stimulus to 
present reduced slew rate. If the signal frequency is increased, the supply modulator 
will be even less able to keep up the pace and therefore the amplitude of the output 
Figure 3.11  Illustration of ideal and slewed waveforms due to limited slew rate effect. Maximum 
rate of change of sine wave occurs at zero crossing point and supply modulator response slewing 
distortion.
Figure 3.10  Illustration of the slew rate concept with a step signal response. It indicates the large-
signal speed performance of a circuitry such as envelope generator and supply modulator.

3.2  Envelope Detector Specifications 
105
waveform will decrease and become limited by the component slew rate perfor-
mance. The slew rate may also not be linear over the whole range. For example, 
the envelope waveform may exhibit a faster rise for the first part of the change and 
then revert to the more expected slew rate. Therefore, different ET applications 
and device types have different slew rate requirements. For example, an envelope 
supply for RF PA in typical BTS application may have a slew rate of 2,000 V/µs or 
more. This means that when a large step change is placed on the input, the supply 
modulator would be able to provide an output 2,000V change in units of microsec-
onds. However, in mobile UE applications, for example, the maximum slew rate of 
the MIPI eTrak interface driver is 35 V/µs, as shown in Table 3.1.
Moreover, for the slew rate performance of supply modulator, besides the im-
pact factor from envelope generator, it is also highly dependent on the slew rate of 
active devices being used in modulator design. For example, there are fast opera-
tional amplifiers (OPAMP) capable to providing slew rates of more than 3,000 V/
µs, which can definitely enhance the overall modulator slew rate performance to 
ET system requirements. Also, different slew rates for positive and negative going 
transitions are possible because of the circuit configuration. For instance, a supply 
modulator has a complementary output to pull the signal up and down and this 
means the two sides of the circuit cannot be exactly the same. However, it is usually 
assumed that they have reasonably symmetrical performance levels.
3.2.4  Conversion Gain
Because an RF envelope detector is a frequency translating component, the gain 
from the input to the output is usually termed as conversion gain. Even though the 
frequency is different at the input and output of the envelope detector, presenting 
the conversion gain as a power ratio of input and output for the situation of a simi-
lar downconverting receiver comes to
	
_
_
env
env
out
RF
in
G
P
P
=
	
(3.11)
where Penv_out denotes the detected envelope power and PRF_in denotes RF input 
signal power, which operates at baseband envelope frequency and RF frequency, 
respectively.
As shown in Figure 3.12, the complexity is reduced to measure the input power 
PRF_in at one frequency and measure the output power Penv_out at another frequency. 
However, in many other scenarios, the conversion gain is expressed as ratio of the 
extracted envelope output root mean squared (RMS) voltage to the input RF signal 
RMS voltage with unit as V/V.
Figure 3.12  Illustration of the conversion gain of an RF envelope detector.

106 
���������������������������������
Envelope Generation and Alignment
3.2.5  Gain Ripple
Because gain is highly frequency-dependent, the gain ripple over operational band 
can depict how much the gain is dependent on frequency. The measurement of 
ripple is achieved by sweeping gain versus frequency. Typically, the gain versus 
frequency response of an envelope detector is desired to be as flat as possible with 
little ripple. Figure 3.13 shows an ideal gain response over frequency for an actual 
detector device. The gain response across the passband indicates that the gain is 
not flat but rather contains ripple to a certain extent. It reveals the gap between a 
maximum gain Gmax point and minimum gain Gmin point. Hence, the gain flatness 
∆GdB expressed in decibel units is then determined by
	
max
min
dB
G
G
G
∆
=
−
	
(3.12)
As shown in Figure 3.13, the gain ripple of detector depends on the bandwidth 
being examined, but it is usually below one-tenth of a decibel. Hence, if the mea-
surement instrument that is being used has the same or worse uncertainty as the 
flatness performance, then it is doubtful that the measurement result makes any 
practical sense. In other words, it may just reflect the uncertainty of the measure-
ment instrument and not the gain flatness of the envelope detector at all. Another 
point to mention is the frequency sweeping step used to determine the gain ripple. 
If the frequency increment is excessively large, the Gmax or Gmin point can be com-
pletely missed. It may result in a lower gain ripple result being measured that would 
pass the measurement specification. In that case, unfortunately a defect envelope 
detector might have possibly been utilized in ET PA with potential performance 
impact and variations, especially in volume production. In contrast, assuming that 
the frequency sweeping step of measurement is tremendously small, the risk of such 
a problem can be totally eliminated. However, smaller frequency sweeping steps 
require extra measurement time accordingly. 
3.2.6  Temperature Variance
For an RF envelope detector, in contrast to the linear conformance error ELC dis-
cussed in Section 3.2.1, the variation over temperature error EVOT purely measures 
the error due to temperature variation. The measured output voltage at a typical 
temperature 25°C is subtracted from the output voltage at another temperature 
for the same power level as shown in Figure 3.14. Subsequently, the difference is 
Figure 3.13  Illustration of gain ripple over the RF envelope detector operational bandwidth.

3.2  Envelope Detector Specifications 
107
translated into an input referred error by dividing it by a linear slope KSL at 25°C. 
Hence, the equation for variation over temperature is given by
	
( )
( )
(
)
(
)
(
)
=
−
°
°
25
25
VOT
out
out
SL
E
T
V
T
V
C
K
C 	
(3.13)
The EVOT shown in Figure 3.14 indicates EVOT = ±0.5 dB can be obtained in a 
linear dynamic range of around 30 dB, which is shown in the gray region.
3.2.7  Transfer Function
RF envelope detectors inherently and nonlinearly behave because of the diodes and 
transistors utilized. Although this character is undesirable in an ET PA, in envelope 
detectors, for example, the nonlinear behavior is intentionally designed into the 
device for the reason that soft-limiting envelope shaping is wanted in ET, as shown 
in Figure 3.2. A short derivation of voltage behavior in diode-based RF envelope 
detector can be presented here and will be useful in explanations throughout the 
rest of the discussion on envelope parameters. Hence, the definition of the current 
through a diode is
	
(
)
1
tot
V
s
I
I
e
γ
=
⋅
−
	
(3.14)
where Is is a constant saturation current, γ is a constant dependent on temperature 
and the design of the diode, and Vtot is the combined AC and DC voltage across the 
diode. If the voltage is generalized to contain both DC and AC components, then
	
0
tot
in
V
V
V
=
+
	
(3.15)
where V0 is a DC voltage and Vin is a small-signal AC voltage. Because Vin is a small 
signal, a Taylor series expansion can be used to rewrite (3.14) as
Figure 3.14  Illustration of the variation temperature error versus RF input power at extreme 
temperatures.

108 
���������������������������������
Envelope Generation and Alignment
	
(
)
2
2
0
2
1
1
2
tot
V
S
in
in
dI
d I
I
I
e
I
V
V
dV
dV
γ⋅
=
⋅
−
=
+
⋅
+
⋅
⋅
+ 	
(3.16)
It is usually easier to work in terms of voltages rather than currents because 
they are easier to measure. If both sides of the equation are multiplied by constant 
resistance, then, from Ohm’s law, 
	
2
3
0
1
2
3
out
in
in
in
V
V
V
V
γ
γ
γ
γ
=
+
⋅
+
⋅
+
⋅
+ 	
(3.17)
where γ0, γ1, γ2, γ3, …, are constants that have absorbed the coefficient values in 
(3.16). The term γ0 is a DC term describing the DC parameters of a diode. When 
working in the linear region, an envelope detector is described by the linear term γ1. 
However, the higher-order terms are used to describe nonlinear distortion found in 
an envelope detector. 
Therefore, the transfer function influences the detector linear conformance er-
ror ELC, which describes how close the transfer is to an ideal linear function. In 
other words, the envelope detector implements a linear detection function. To ob-
tain the ELC, the detector transfer function can be modeled as a linear function 
between input power in dBm and output voltage in dBV. Hence, the ideal linear 
transfer is modeled by two parameters as linear slope KSL and intercept PLin_int and 
is described by
	
(
)
_
_ int
out
SL
RF
in
Lin
V
K
P
P
=
⋅
−
	
(3.18)
where PLin_int denotes the linear intercept where the RF input power at Vout is 0 dBV 
(1V), Vout is the output voltage in dBV, KSL is the linear slope of the function in dB/
dB, and PRF_in is the input power level in dBm, as shown in Figure 3.15.
The ELC measurement can be determined by two steps. First, it is necessary to 
determine the optimum fitted ideal transfer at 25°C. The best fit can be determined 
by standard routines to obtain KSL and PLin_int. A careful selection of the fit range 
is important. The fit range should be within the normal range of operation of the 
device. It is to compare the actual data and the best fitted ideal transfer function 
to determine the difference between them. Because the linear conformance is speci-
fied as an input referred error, the output referred error is therefore divided by the 
KSL to obtain the input referred error. The ELC can be calculated by the following 
equation as
	
( )
( )
(
)
(
)
(
)
(
)
−
°
⋅
−
°
=
°
_
_ int
25
25
25
out
SL
RF
in
Lin
LC
SL
V
T
K
C
P
P
C
E
T
K
C
	
(3.19)
where Vov+(T) is the measured output voltage at temperature variable T, for an in-
put power level PRF_in. KSL (25°C) and PLin_int are the parameters of the best fitted 
ideal transfer for the actual transfer at 25°C.
Therefore, the temperature behavior of envelope detector on transfer functions 
can be obtained as shown in Figure 3.15. The specified temperature range of the 
envelope detector is typically from −40°C to 85°C. The envelope detector is, to a 

3.2  Envelope Detector Specifications 
109
certain extent, still functional outside these temperature limits. It shows the detec-
tor behavior for temperatures from −40°C up to 85°C with nominal value as 25°C. 
The exemplary envelope detector can be accurate within a dynamic range from −30 
dBm to +10 dBm. On the upper and lower ends, the curves deviate in a gradual 
manner, with the lowest temperature at the bottom side and the highest tempera-
ture at top side.
3.2.8  Total Harmonic Distortion
Harmonic distortion occurs once certain of intentional power of envelope detector 
is accidentally conveyed from a desired frequency to a higher frequency multiple 
of the fundamental frequency. It typically happens at higher power levels. A mea-
sure of such distortion is total harmonic distortion (THD). It is the relative power 
contained in all harmonics of an output signal expressed as a percentage of the 
fundamental signal power. It can be defined as follows:
	
(
)
(
)
(
) (
)
=
⋅
=
+
+
⋅

2
2
2
2
3
4
0
%
100%
100%
disto
fund
f
f
f
f
THD
P
P
V
V
V
V
	
(3.20)
where Vf2, Vf3, Vf4, … are the voltage amplitudes of the second, third, and fourth, 
… harmonics, respectively. Vf0 is the voltage amplitude of the desired fundamental 
frequency component. Pdisto is the total distortion power in watts, and Pfund is the 
Figure 3.15  Comparison of the actual RF envelope detector transfer function with an ideal linear 
transfer function.

110 
���������������������������������
Envelope Generation and Alignment
desired signal power in watts. However, THD can also be commonly expressed in 
terms of dBc as
	
(
)
(
)
10
10 log
disto
fund
THD dBc
P
P
=
⋅
	
(3.21)
Because THD (%) is defined as the square root of the total distortion power 
divided by the signal power, it needs to be transformed in terms of power before 
converting to a decibel form. THD measurement for an envelope detector can be 
stimulated with the AM signal and the harmonic order up to the fifth harmonic is 
sufficient for a practical evaluation purpose.
3.2.9  Response Delay
The response delay definition for an envelope detector is the time delay of the RF 
input signal to output envelope conversion on time basis.
As shown in Figure 3.16, there might be an obvious delay of the envelope 
detector propagating through the input signal source to the output. For wideband 
modulated signals, the delay is presented as group delay, which indicates that the 
signal defect caused by different frequencies having differing propagation delays. 
The distortion becomes obvious when signal components of diverse frequencies 
undergo different delays when they transmit through an envelope detector. Distor-
tions can be expressed in units of time. The largest difference in delay between a 
Figure 3.16  Illustration of envelope response delay of an RF envelope detector.

3.3  Timing Alignment  
111
reference of low frequency and the other frequencies tested is typically quoted as 
the group delay distortion. Therefore, the group delay of detector can be defined 
as the negative of the derivative of the phase response with respect to frequency. 
In formulas, H(j · ω) can be expressed as the frequency response function of the 
envelope detector,
	
( )
(
)
(
)
arg H j
j ω
ω
=
⋅
	
(3.22)
where ϕ(ω) denotes the phase response. Then the group delay t(ω) can be expressed 
as
	
( )
( )
d
d
τ ω
j ω
ω
= −
	
(3.23)
It is a function of the angular frequency ω and can be expressed as the time 
delay of the envelope of a sinusoid at the angular frequency ω. 
As shown in Figure 3.16, observing the waveform of input and output signals, 
the group delay can be measured by the time difference from the RF input enve-
lope peak to the output extracted envelope peak. By appropriately adjusting the 
timing delay of the RF signal and the envelope supply, ET PA performance can be 
improved, in particular with regard to linearity and efficiency.
3.3  Timing Alignment 
Although the efficiency of an ET PA can be increased by having the supply voltage 
signal provided to the PA track the instantaneous power being produced by the PA, 
the overall system performance is dependent on accurate delay compensation be-
tween the RF signal and the envelope supply provided. If the supply and the RF sig-
nal are not in phase, degradations such as EVM degradations, degraded efficiency, 
reduced output power, and increased unwanted out-of-band emissions may occur. 
Hence, it requires stringent timing alignment between the supply voltage and the RF 
output signal. ET PAs for wider bandwidth modulation systems may be especially 
more sensitive to such a timing misalignment. For example, in the case of an LTE 
signal having a 10-MHz channel bandwidth, the spectrum requirements cannot be 
met when the absolute delay mismatch between the modulated supply voltage and 
the RF signal is greater than 4 ns. Accordingly, there is a need for adaptive timing 
alignment technique for configuring and calibrating ET systems to minimize group 
delay misalignment between the envelope supply and the RF signal. According to 
Raab [17] and Su and McFarland [18], for small delay, the magnitude of the inter-
modulation distortion introduced by the timing mismatch for a two-tone signal is 
related to the bandwidth of the two-tone signal and the time mismatch. Therefore, 
accurate timing alignment between the ET supply waveform and the PA input signal 
is critical because any timing misalignment between the ET modulated supply and 
the PA output signal can result in memory effects that might be rather difficult to 
be linearized. More details about digital timing alignment techniques will be intro-
duced in Chapter 6.

112 
���������������������������������
Envelope Generation and Alignment
3.3.1  Analog Alignment
An envelope signal can be generated by an RF envelope detector as introduced in 
Section 3.2. The detector extracts the envelope of the modulated RF signal, and 
subsequently providing the envelope signal to a supply modulator to generate the 
supply voltage for the RF PA. In this approach, all processing is handled with ana-
log component. Therefore, digital timing alignment cannot be easily available and 
located right into the feed forward loop composed of envelope and RF signal paths. 
However, the circuits all have to be synchronized and compensated with one an-
other, which can be relatively difficult to achieve. Furthermore, this timing align-
ment can typically be performed with analog signal processing. 
Analog alignment scheme can be realized by using an RF delay line component 
to make the compensation between envelope and RF signal paths, which is an 
open loop delay compensation method. However, the group delay of the RF delay 
line component is fixed and it is difficult to find proper and precise delay values 
from off-the-shelf commercial components. Hence, the digital variable delay line 
(DVDL) can be employed to provide flexible but coarse delay line for ET alignment 
as shown in Figure 3.17.
The DVDL contains four types of components in an RF unit delay line: path 
selection switch pair, digital buffer, inverter, and variable gain amplifier (VGA) to 
compensate the insertion loss caused by all combinations of RF unit delay lines 
accordingly. Delay and insertion loss are the two key parameters for DVDL. To 
keep pure delay separate for timing alignment, the insertion loss should be well 
counteracted by the VGA in the ideal case. However, the RF VGA cannot complete 
the task due to limitation of gain compensation precision. It may require the base-
band digital VGA’s assistance to finish the compensation to obtain constant gain 
on transmitter signal chain.
The DVDL can be controlled by parallel control bits from the baseband con-
troller to tune the delay values. The delay step fully depends on the delay value of 
RF unit delay line τDL. The total delay value of DVDL can be changed with the 
index value i and expressed as 
	
(
)
2
1
,
0,1,2,
i
i
DL i
N
τ
τ
=
−
⋅
=

	
(3.24)
Figure 3.17  N-bit digital variable delay line schematic as coarse analog timing alignment scheme for ET PA.

3.4  Offset Adjustment 
113
Figure 3.18 displays an ideal 6-bit binary DVDL in Figure 3.17 transfer charac-
teristic with delay versus insertion loss. The insertion loss increases with the delay 
values. The RF VGA compensation results in regressed insertion loss character to 
compensate to some degree.
Besides the coarse timing alignment limitation of DVDL compared to digital 
counterpart, the circuits used to generate variable delay are sensitive to differences 
in component operating characteristics caused by, for example, manufacturing tol-
erances or differences such as ambient temperature in the operating environment. 
Therefore, at this point, an analog alignment scheme may easily suffer from part-
to-part variation.
3.4  Offset Adjustment
Besides timing alignment for the overall ET PA performance, an offset between the 
RF signal and the modulated supply voltage should also be kept as a proper value 
to trade off efficiency and signal quality, as shown in Figure 3.19. For example, it 
requires maintaining the offset as low as possible to attain high efficiency; however, 
with the offset as large as possible, it can improve the signal quality of ET PA at the 
expense of efficiency. Therefore, offset adjustment is another important consider-
ation for the ET PA alignment process. Performing the offset adjustment between 
an RF signal being amplified and an envelope supply voltage can be implemented 
as an adjustment of DC bias voltage to the PA and accordingly gain adjustment on 
either envelope and RF paths. 
3.4.1  Principle of Operation
One important step of offset adjustment is to minimize the error measurement, 
which can in particular be related to the digital modulation of the RF signal of a 
baseband signal that is upconverted to the RF signal. For example, the error mea-
surement can specifically be EVM and ACLR metrics. Consequently, the offset ad-
justment compares the EVM and ACLR as an error measurement of the RF signal 
at an input and an output of the PA, performing the offset adjustment by minimiz-
ing a difference between the error measurements of the RF input and output signals. 
Figure 3.18  Group delay values versus insertion loss with 6-bit digital control ranging from 0 to 
63 levels.

114 
���������������������������������
Envelope Generation and Alignment
For offset adjustment, the signal processing algorithm can be adapted to mini-
mize a difference of the error measurements between the RF input and output 
signals for adjusting the offset between the RF signal and the modulated supply 
voltage. Optimum offset between the RF signal and the supply voltage can be at-
tained when the difference in the error measurements is minimized. Once the values 
of the error measurements are similar, the offset is typically correctly adjusted and 
need not be modified. Conversely, if a significant difference is observed, the offset 
adjustment has to be modified. When different error measurements are utilized, it 
is possible to adjust the supply voltage offset and the timing delay offset indepen-
dently from one another.
3.4.2  Adaptive Adjustment
The signal processing can be adapted to adjust a voltage offset between an enve-
lope supply and RF signal. The digital signal processing (DSP) algorithms that are 
adapted to generate both the envelope and baseband signal are ideally suited for 
performing the offset adaptation, as the DSP block generates both the baseband 
signal that is provided as the RF input signal to the PA and the envelope signal that 
is provided as an input to the supply modulator. Hence, it has direct impact on the 
modulated supply voltage provided to the RF PA. Therefore, the DSP adjustment 
may set the offset adaptively between both signals in dependence of the feedback 
observation such that the error measurement is minimized. In such a manner, it is 
also possible to perform an adaptive PA adjustment to compensate for aging ef-
fects or temperature variations during operation of the ET arrangement in the long 
term. For performing the voltage offset compensation adaptively, the adjustment 
Figure 3.19  Illustration of offset between the envelope supply and RF PA output waveform.

3.4  Offset Adjustment 
115
can provide the RF input and output signals alternately to the DSP via the reuse of 
feedback path of DPD as shown in Figure 3.4. By switching between the RF input 
and output signals, only one feedback path is required for performing the com-
parison. It will be understood that as the switching can be performed much more 
rapidly than a possible drift of the voltage offset, the short delay introduced by the 
switching is not critical for the timing and offset alignment processes. Accordingly, 
the DSP function block can be adapted to compare the EVM and ACLR as an error 
measurement of the RF input and output signals. Typically, the EVM is a measure 
of in-band distortions and thus provides a good measure for both the offset and 
timing delay compensation of ET systems. The EVM is based on the difference of 
an ideal constellation point and an actual constellation point in the I-Q plane of 
a baseband signal through the feedback observations from both input and output 
capturing of RF PA. 
Finally, in the ET PA system, the output impedance of an RF PA is inconsis-
tent with the impedance of the output load due to time-varying supply voltages. 
Accordingly, it causes the degradation of PA efficiency. In particular, if the RF PA 
operates at a low output power level mode, the efficiency drops to the lowest ef-
ficiency direction. Consequently, ET voltage offset adjustment can be employed 
to improve the power efficiency obtained when the RF PA operates at low-power 
output scenarios to alleviate the load variation effects. 
References
[1]	
ADL5511, “DC to 6 GHz Envelope and Trupwr™ RMS Detector,” Data Sheet, ADI Inc., 
2012.
[2]	
HMC1021LP4E, “RMS Power Detector SMT, with Envelope Tracker, DC - 3.9 GHz,” 
Data Sheet, Hittite Microwave Corporation, 2012.
[3]	
LMH2121, “3GHz Fast Responding Linear Power Detector with 40dB Dynamic Range,” 
Data Sheet, Texas Instrument Corporation, 2013.
[4]	
David, M., K. Nadim, and R. Jeremie, “Digital Fast CORDIC for Envelope Tracking Gen-
eration,” U.S. Patent Application No. 20120121039 A1, May 17, 2012.
[5]	
Nadim, K., and K. F. Horlander, “Group Delay Calibration Method for Power Amplifier 
Envelope Tracking,” U.S. Patent Application, No. 20130034139 A1, February 7, 2013.
[6]	
Volder, J. E., “The CORDIC Trigonometric Computing Technique,” IRE Transactions on 
Electronic Computers, Vol. 3, September 1959, pp. 1–3.
[7]	
Cheng, Y., et al., “Efficient CORDIC Designs for Multi-Mode OFDM,” IEEE Interna-
tional Conference on Acoustics, Speech and Signal Processing (ICASSP ’06), May 2006, 
pp. 1036–1039.
[8]	
Timmermann, D., et al., “A New Addition Scheme and Fast Scaling Factor Compensation 
Methods for CORDIC Algorithms,” INTEGRATION, the VLSI Journal, Vol. 11, 1991, 
pp. 85–100.
[9]	
Moon, J., et al., “A Multimode/Multiband Envelope Tracking Transmitter with Broadband 
Saturated Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, 
No. 12, December 2011, pp. 3463–3473.
[10]	
Pedro, J. C., J. A. Garcia, and P. M. Cabral, “Nonlinear Distortion Analysis of Polar Trans-
mitters,” IEEE Transactions on Microwave Theory and Techniques, Vol. 55, No. 12, De-
cember 2007, pp. 2757–2765.

116 
���������������������������������
Envelope Generation and Alignment
[11]	
Wang, F., et al., “Design of Wide-Bandwidth Envelope-Tracking Power Amplifiers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 4, Apr, 2005, pp. 1244–1255.
[12]	
Hassan, M., et al., “A Wideband CMOS/GaAs HBT Envelope Tracking Power Amplifier 
for 4G LTE Mobile Terminal Applications,” IEEE Transactions on Microwave Theory and 
Techniques, Vol. 60, No. 5, May 2012, pp. 1321–1330.
[13]	
Choi, J., et al., “A Polar Transmitter with CMOS Programmable Hysteretic-Controlled 
Hybrid Switching Supply Modulator for Multistandard Applications,” IEEE Transactions 
on Microwave Theory and Techniques, Vol. 57, No. 7, July 2009, pp. 1675–1686.
[14]	
Kim, D., et al., “Optimization for Envelope Shaped Operation of Envelope Tracking Power 
Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, No. 7, July 
2011, pp. 1787–1795.
[15]	
Jeong, J., et al., “Wideband Envelope Tracking Power Amplifier with Reduced Bandwidth 
Power Supply Waveform,” IEEE MTT-S Int. Microwave Symp. Digest, Boston, MA, June 
2009, pp. 1381–1384.
[16]	
Jeong, J., “Envelope Tracking Power Amplifiers with Reduced Peak-to-Average Power Ra-
tio RF Input Signals,” IEEE Radio and Wireless Symposium (RWS), 2010, pp. 112–115.
[17]	
Raab, F. H., “Intermodulation Distortion in Kahn-Technique Transmitters,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 44, No. 12, December 1996, pp. 
2273–2278.
[18]	
Su, D., and W. McFarland, “An IC for Linearizing RF Power Ampliﬁers Using Envelope 
Elimination and Restoration,” IEEE Journal of Solid-State Circuits, Vol. 33, No. 12, De-
cember 1998, pp. 2252–2258.
[19]	
MIPI Alliance, Specification for Analog Reference Interface for Envelope Tracking 
(eTrakSM), Technical Specification, version 1.0, MIPI Alliance, Inc., April 9, 2013.
[20]	
MIPI Alliance, Specification for RF Front-End Control Interface, Technical Specification, 
version 1.10a, MIPI Alliance, Inc., April 16, 2012.
[21]	
3GPP TS 36.101, “LTE Evolved Universal Terrestrial Radio Access (E-UTRA); User Equip-
ment (UE) Radio Transmission and Reception, version 11.3.0, Release 11,” February 2013.
[22]	
3GPP TS 25.101,” Universal Mobile Telecommunications System (UMTS); User Equip-
ment (UE) Radio Transmission and Reception (FDD), version 11.4.0 Release 11,” February 
2013.
[23]	
3GPP TS 25.102, “Universal Mobile Telecommunication System (UMTS); User Equip-
ment (UE) Radio Transmission and Reception (TDD), version 11.3.0 Release 11,” October 
2012.

117
C H A P T E R  4 
Supply Modulator for Envelope Tracking
In practice, it is difficult to perform an efficient amplification of signals with high 
PAPR. The topic of interest in this book, RF PAs with variable supply voltage, 
represents a departure from the traditional paradigm of fixed DC supply voltage 
operation. For RF PAs, dynamically changing DC supply voltage offers the pos-
sibility of enhanced high-PAPR signal amplification while maintaining maximum 
efficiency. Even for highly linear RF PAs, adjusting the power supply can alleviate 
high power dissipation at low signal level conditions.
The overall efficiency of ET PA is to multiply the efficiency of the RF PA and 
that of the supply modulator. Efficient supply modulator is indicative of the overall 
efficiency of an ET PA design. Similar to the RF PA design, a supply modulator 
is designed to provide the maximum output power trade-off with efficiency and 
linearity. However, most of the time the offered modulator output is much less 
than the proposed maximum power output due to the high-PAPR characteristics of 
modulated signals. Therefore, designing a supply modulator that is power efficient 
over its power range and output voltage range is of great importance.
Modulating the DC supply voltage of an RF PA is the way to increase the 
overall efficiency of ET. Therefore, this chapter discusses design modulators for 
adjusting the output power of the RF PA by varying the supply voltage with the 
envelope shape, in particular, dynamic drain/collector bias voltage variation by 
envelope supply modulation devices. However, the solutions for a supply modula-
tor with high speed, high linearity, and high efficiency are quite difficult to find, 
especially with time-varying load impedance requirements combined. The purpose 
of this chapter is to focus on the architectures and principles of the supply modu-
lator designs, trading off with the ET pyramid mentioned in Chapter 2. Typically, 
as shown in Figure 4.1, ET supply modulators can be classified as continuous and 
discrete types. However, there are actually subcategories under linear and discrete 
types, either in standalone mode or a hybrid combination for optimal performance, 
and in relation to the above-mentioned challenges.
4.1  Introduction
Traditional DC-DC converters obtain a fixed output voltage over a range of load 
conditions from a fixed input voltage. However, the feedback loop has convention-

118 
��������������������������������������
Supply Modulator for Envelope Tracking
Figure 4.1  Representation of a pedigree of an ET supply modulator whose combination of different types of continuous and discrete modes can offer the best 
performance.

4.1  Introduction 
119
ally been designed to also be used to obtain a stable output voltage to vary the 
output voltage.
There are two basic types of supply modulators—linear and discrete—de-
scribed in this book with an additional envelope input port because traditionally 
developed PAs have mutually exclusive features. A linear modulator is only capable 
of low-noise, high-bandwidth operation but can have very low efficiency, especially 
for high voltage gain scenarios. However, discrete forms of delivery are modula-
tors that can have very high efficiency, typically >90%, but tend to be limited 
to relatively low bandwidths. Just as with ET PAs, there is a dichotomy between 
the two basic types of voltage converters. Linear voltage regulators are capable of 
high-speed, low-noise voltage conversion, but they suffer from low efficiency due 
to their resistive voltage regulation mechanism. Switching DC-DC converters for 
high-power conversion efficiency by minimizing resistive losses, but are required by 
the bandwidth of lowpass filters to suppress the switching noise limited.
However, hybrid supply modulators combine the advantages of both linear and 
discrete modulators so that both a high efficiency and a wide-bandwidth operation 
can be achieved. The hybrid modulator comprises a high efficiency but a low band-
width switching the DC-DC converter to process the low-frequency component of 
the envelope signal, while a high bandwidth, moderately efficient linear modulator 
for high-frequency components of the envelope also compensates for the switching 
noise of the switching DC-DC converter.
As we know, EE&R procedures do require high-performance supply modula-
tors that can operate efficiently with a frequency response often many times that of 
baseband modulation bandwidth and therefore require very efficient, high-band-
width supply modulators. However, unlike with the EE&R technique, it does not 
make high demands on ET modulator design because the time-averaged fluctua-
tions in the supply voltage occur over long periods of time relative to the baseband 
modulation frequency. 
4.1.1  Supply Modulator Requirements
The ET supply modulator is common for amplifying an envelope waveform, in 
particular:
••
With a given minimum and maximum output voltage level;
••
With gain and insertion phase over a certain bandwidth;
••
With specified maximum short-term and long-term slew rates;
••
Driving a time-varying load.
In relation to the supply modulator, several parameters meet the above specifi-
cations according to how to obtain high linearity, efficiency, speed, and minimum 
interference with the spectrum of the output signal of transmitter.
The efficiency and linearity requirements of supply modulators are confronted 
with the same problem as with RF PAs: realizable high-power devices produce 
large power capacity, limiting maximum speed. High-speed processes and off-the-
shelf parts are limited in voltage and power handling capability. For example, many 
components for 36-V maximum supply voltage rails require more headroom to 

120 
��������������������������������������
Supply Modulator for Envelope Tracking
preserve the linearity and dynamic range of a 30-V output voltage. Supply modu-
lator architecture can allow a DC offset to the output voltage range to be used to 
enable higher minimum voltage peaks at the expense of higher voltage. However, 
the maximum and minimum drain/collector voltages affect efficiency.
Bandwidth and frequency responses are small-signal characteristics for a purely 
linear operation. For example, inadequate bandwidth can be observed by increas-
ing the frequency of a very low-amplitude input sine wave and watching the output 
waveform decrease in amplitude as gain rolls off.
Conversely, slew rate is a feature of a large signal phenomenon. As an example, 
a fast voltage ramp into a low-impedance load may deplete the charge stored in 
supply modulator decoupling capacitors, causing the modulator supply voltage rail 
to dip. The resulting output signal distortion is the result of an insufficient slew rate 
capability. A wide variety of complex transistor circuit component problems can be 
responsible for this type of behavior.
Bandwidth requirement for a supply modulator cannot always be estimated 
by the complex modulation bandwidth. The idea that the supply modulator band-
width should be at least three times that of the modulation bandwidth does not 
always hold true. It is only valid for several modern high-PAPR signals such as 3G 
and 4G.
The high bandwidth requirement occurs for two main reasons. First, ET drain/
collector supply voltage is a function of the RF signal amplitude. Therefore, from 
the power spectral density (PSD) analysis, greater than 90% of the PSD of the enve-
lope signals is concentrated within the RF signal bandwidth. The higher-frequency 
component of the envelope signal has a significant content beyond this bandwidth. 
These kinds of complex modulation signals with amplitude passing through zero 
will have sharp amplitude nulls in the time domain; amplitude quickly descends to 
zero before instantly changing direction and increasing toward a peak. 
Second, the modulation bandwidth can be changed by the clipping effect of the 
lower bounds of envelope shaping function imposed. Although the envelope shap-
ing function in Chapter 6 applies a nonlinear transformation of these waveforms, 
changing its time-domain features for optimum ET PA performance, it also further 
complicates the problem of bandwidth requirements for a supply modulator be-
cause the waveform bandwidth can either be condensed or expanded depending 
on the construction of the envelope-shaping effect. Therefore, the required sup-
ply modulator bandwidth and dynamic range is not straightforward to predict, as 
the input signal depends on both the system configuration and modulation signal 
characteristics.
Also, the exposure to the modulator output at the PA drain/collector is driven 
by power connections known as the drain/collector resistance Rsm. Note that this 
is not directly to the PA load line or RF impedance and constant over the RF cycle 
through the RF choke. Drain/collector resistance Rsm varies with PA output power 
and efficiency as follows:
	
(
)
η
=
=
⋅
2
_
sm
sm
sm
sm
d
out
rf
R
V
I
V
P
	
(4.1)
The problem with a load variation of the frequency response is only one ex-
ample of the difficulty of completely specified supply modulator fidelity require-
ments. A certain degree of frequency response variation under low load is likely 

4.1  Introduction 
121
to provide an acceptable linear ET system. However, the quantitative amount of 
the allowable variation is signal-dependent; it also depends on the other imperfec-
tions simultaneously involved. Supply modulator bandwidth, slew rate, and output 
impedance required to reach the supply voltage Vsm with sufficient accuracy and 
linearity for the ET PA system is a function of the input signal, PA behavior, and 
envelope shaping function. Reduced supply modulator dynamic requirements can 
lead to an improved supply modulator efficiency, but also force an envelope shap-
ing effect, resulting in lower RF PA efficiency. Therefore, it is a compromise art to 
achieve overall optimum performance of ET.
The supply modulator should have very high dynamics, high efficiency, and 
low disturbance of the output spectrum of the transmitter. The supply modulator 
must have a high efficiency and therefore an SMPS would be the first solution. 
Nevertheless, a high bandwidth of supply modulator is required to follow the en-
velope reference input to ensure that minimum distortions during reproducing the 
envelope supply. The efficiency of a pure SMPS design is difficult when the switch-
ing frequency increases, which decreases the efficiency of the entire supply modula-
tor system as well. The second problem is that the output filter design of the SMPS 
could be very complicated because of very stringent requirements for the voltage 
ripple and spectral interference. Therefore, the output filter design is more difficult 
to use on SMPS modulator design for ET efficiency and bandwidth requirements.
4.1.2  Mathematical Model for Efficiency
To obtain the complete efficiency of modeling, a typical parallel hybrid modulator 
for the analysis is assumed here.
Figure 4.2 shows the equivalent circuit for a parallel hybrid supply modula-
tor. Strictly speaking, the time-varying current Isw tracks the average power of the 
envelope signals. However, the decomposed equivalent SMPS voltage waveform 
Isw · Rsm has a slowly varying amplitude of the waveform compared with the final 
output supply voltage Vsm. Therefore, the current Isw is adopted as constant in the 
time interval of interest. Then the efficiency of the supply modulator can be cal-
culated as a total system piecewise function. First, when the SMPS current Isw is 
greater than the desired output current Ism, the linear modulator sinks current to 
compensate for the error. Therefore, a piecewise function to modeling is used, as 
described here.
	
(
)
(
)
(
)
(
)
(
)
η

⋅
<
<

= 
⋅
+
⋅
−
<
<

2
0
sm
sm
sw
sm
sm
sw
sm
sm
sm
sm
sm
sw
DC
sm
sm
sw
sw
sm
sm
DC
sm
V
R
I
V
R
I
V
V
R
V
I
V
V
R
I
I
V
R
V
R
	 (4.2)
where the supply voltage Vsm from 0 to 1 range is normalized for the ET operation, 
the drain/collector resistance Rsm is normalized as 1 for load resistance, the SMPS 
current Isw is normalized constant current of SMPS part, which ranges from 0 to 
1, and the fixed DC supply voltage VDC is the normalized as 1 for simplicity. In the 
case of 0 < Ism < Isw, the instantaneous efficiency of the modulator can be repre-
sented by linear modulator part, when the supply current flow through the load Rsm 
is less than SMPS part can provide. However, in the state of Isw < Ism < VDC/Rsm, 

122 
��������������������������������������
Supply Modulator for Envelope Tracking
the linear modulator has to return the error current to the load to compensate the 
portion provided by the SMPS part.
Figure 4.3 shows the instantaneous efficiency curves as a function of the out-
put voltage for various normalized SMPS currents with Isw = 0.3, 0.5, and 0.7, 
as in (4.2) is determined. For each SMPS current value, two points of maximum 
efficiency of the linear modulator are observed with one at the maximum output 
voltage and the other peak at voltage where the total output current is equal to the 
SMPS current so that no current is provided by the linear modulator part. This ef-
ficiency curves are similar in shape to the efficiency characteristics of a Doherty PA 
Figure 4.2  A typical equivalent circuit diagram for the supply with an ideal modulator discrete unit 
modeled as a constant current source.
Figure 4.3  Instantaneous efficiency curves for different SMPS currents and probability density func-
tion of a typical modulated signal with a high PAPR.

4.2  Linear Supply Modulator 
123
in that the efficiency is reduced at output voltages intermediate between two peak 
points as well as at points of very low output voltages. Also shown in Figure 4.3 is 
the probability density function (PDF) of a typical high-PAPR signal. For optimal 
average efficiency of the switch current, Isw must follow the most probable output 
of the PDF given. For example, Isw = 0.5, the maximum average efficiency, because 
the instantaneous efficiency is maximized at the most probable output of the PDF 
histogram. In fact, feedback mechanism is used in the supply modulator in this 
modeling, tracking the local average output power via a current sense feedback 
loop. In other words, the parallel hybrid supply modulator itself adjusts its SMPS 
current Isw so that the average efficiency is optimized. In this way, the supply modu-
lator has high efficiency for signals with different PAPRs.
4.2  Linear Supply Modulator
Traditionally, the supply modulator is implemented in the form of a linear modula-
tor, as shown in Figure 4.4. Having a wide bandwidth and a small ripple, the linear 
topology reaches an excellent out-of-band spectral output. However, the energy 
efficiency of the linear modulator would be very low when the output excurses to 
a low voltage region at which the RF PA operates more frequently with high-PAPR 
signals. Therefore, it is not suitable for modern wireless communication signals that 
have high-PAPR characters.
In traditional electronics, a linear regulator is used to maintain a stable voltage. 
The resistance of the regulator varies the in accordance with the load, resulting in 
a constant output voltage. The linear regulator acts as a variable resistor, continu-
ously adjusting a voltage divider circuit, to maintain a constant output voltage. 
However, it continuously dissipates the difference between the input and output 
voltages waste heat. In contrast, a discrete SMPS modulator switches on and off to 
keep an average power level via active devices. 
As the regulated voltage of a linear modulator must always be lower than the 
input voltage, efficiency is limited. The input voltage has to be high enough to al-
ways allow the active device to drop some voltage. 
Figure 4.4  General representation of traditional linear supply modulator architectures.

124 
��������������������������������������
Supply Modulator for Envelope Tracking
Linear modulators may place the regulating device between the source and the 
regulated load as a series regulator or may place the regulating device in parallel 
with the load a shunt regulator. Simple linear modulators may only consist of a 
Zener diode and a series resistor. More complicated linear regulators have separate 
stages of the reference voltage, error amplifier, power pass element, and so forth.
4.2.1  Linear Voltage Regulator
The block diagram of a linear voltage regulator is shown in Figure 4.5. The output 
voltage Vsm is regulated primarily by the voltage drop across the transistor T1, 
which is controlled by an error amplifier A1. Assume that a reference voltage Vref 
is stable and is a known value. Moreover, the values of the resistors R1 and R2 can 
determine the relationship between the output voltage Vsm and the reference volt-
age Vref.
Traditional DC-DC voltage converters are to obtain a fixed output voltage 
over a range of load conditions from a fixed input voltage. However, the feedback 
loop, which has conventionally been designed to obtain a stable output voltage, 
can also be employed to vary the output voltage. As shown in Figure 4.5, the 
output voltage of the linear regulator with resistive voltage divider sampling and 
feedback is following as
	
1
2
1
sm
in
R
R
V
V
R
+
=
⋅
	
(4.3)
If the output voltage Vsm falls below the desired value in (4.3), the feedback 
voltage Vfb falls below the reference voltage Vref, thereby resulting in the output of 
the error amplifier A1 to strongly drive the transistor T1. The voltage drop across 
the transistor T1 is then reduced, thereby increasing output voltage accordingly. 
When the output voltage Vsm rises above the target value, the feedback signal Vfb 
rises above the reference voltage Vref to reduce the conduction of the transistor T1 
via the error amplifier A1, thus increasing the voltage drop across the transistor T1 
and, hence, causing reduction of the output voltage Vsm.
Figure 4.5  Block diagram of a typical linear voltage regulator.

4.2  Linear Supply Modulator 
125
The ancillary components in Figure 4.5 are in for, but not directly to, the op-
eration of the regulator related. In this case, the reference voltage Vref of a Zener 
diode is connected to the supply voltage via a current limiting resistor Rb. The com-
bination of a current sensing resistor Rs and a transistor T2 forms an overcurrent 
protection circuit for the transistor T1. The current sensing resistor Rs is chosen so 
that the transistor T2 will conduct from excessive current in transistor T1.
The bandwidth of the linear regulator is determined by the bandwidth of the 
closed loop operation of the circuit consisting of the transistor T1, the resistor R1, 
the resistor R2, and the error amplifier A1. Although there are parasitic elements 
to reduce the bandwidth, the practical bandwidth of the transistor T1 and the am-
plifier A1 can be relatively high, as the operation of the linear regulator does not 
require a lowpass filter to suppress switching noise as the SMPS does.
As mentioned above, linear regulators are not very efficient and become in-
creasingly less efficient as the difference between the output voltage and input volt-
age increases. In Figure 4.5, the transistor T1 acts substantially as a variable resistor 
so that the other losses are negligible in comparison with those of the transistor 
T1, and therefore the efficiency of a linear voltage regulator can be expressed ap-
proximately as
	
sm
in
V
V
η ≈
	
(4.4)
In ET application, the input signal of supply modulator is small signal, but the 
output voltage of the modulator should be a large signal with high power levels. 
Therefore, a gain for the power amplification function is required by the supply 
modulator. However, the conventional linear regulator cannot provide such a high 
gain over a specified wide bandwidth. Therefore, there is a strong demand for 
broadband capacity expands the possibilities of the linear voltage regulator to a 
linear PA in the range from DC to the maximum frequency component of envelope. 
For example, class-AB/B and class-G/H can be employed to increase the efficiency 
as well as to satisfy the envelope bandwidth requirement.
4.2.2  Class-AB/B
The linear modulator design can simply be lower-frequency PAs in the class-AB/B 
mode to use for wideband and linear scenarios. It must closely follow the envelope 
of the modulated signal with high bandwidth, but also keeps the peak power ef-
ficiency limits of linear PAs, which is theoretically 78.5%. Also, they are not so 
time-averaging efficient for high-PAPR signals such as WCDMA and LTE-A signals 
due to fast efficiency roll off with output power back-offs [15].
Basically, as we know, the class-AB mode is not really a separate class of its own 
but a compromise of class-A and class-B. In addition, when a PA is biased in class-
B, then the bias is further increased and there will be a class-AB mode. For output 
power under a certain level of both output device behavior is the class-A operation. 
At higher levels, one device can be turned off completely as the others provide more 
current. However, the distortion jumps up at this point as the class-AB mode be-
gins. Each device will conduct between 50% and 100% of the time, depending on 

126 
��������������������������������������
Supply Modulator for Envelope Tracking
the degree of excess bias and the output level as discussed in Chapter 2. Therefore, 
class-AB is less linear than either class-A or class-B. Its legitimate use is as a fallback 
mode to allow the class-A PAs to continue working appropriately when confronted 
with a low load impedance. The class-B mode is by far the most popular mode and 
probably most of the linear PAs are currently made by this mode.
4.2.2.1  Push-Pull
Class-AB/B linear supply modulators are usually arranged as a push-pull source 
or emitter follower so that they can both source and sink current and offer some-
what lower output resistance. The complementary output transistors work in the 
class-AB/B mode. They perform broadband and linear power amplification for an 
envelope signal, resulting in a number of advantages over single-ended counterparts 
such as ability to source and sink current, reduction of even harmonics, increased 
output power, and reduced effect of common lead inductance. Perhaps the most 
important disadvantages are the need for a differential input excitation and the 
fact that excellent symmetry both in the matching circuit and the active devices are 
inherently required.
Because a supply modulator requires several amperes of current and providing 
time-varying voltages, some kind of buffering is a must for the operational am-
plifier (OPAMP) gain stages such as power MOSFETs. Therefore, the protection 
of the MOSFETs while maintaining distortion and stability requirements must be 
prioritized during the design process. The choice of MOSFETs is completely de-
termined by current, voltage, and power dissipation requirements from different 
application scenarios. 
Assuming that a single supply rail is provided as a fixed DC voltage VDC and 
its load resistance as Rsm, the output power can be calculated as
	
2
_
out
sm
RMS
sm
P
V
R
=
	
(4.5)
where Vsm_RMS is the root mean squared value of the output voltages. For a sine 
wave as a stimulus, the relation between Vsm_RMS and the maximum output voltage 
amplitude Vampl is
	
_
2
sm
RMS
ampl
V
V
=
	
(4.6)
Therefore, ideally, assuming no voltage drop in the push-pull transistors, the 
output power can be expressed as
	
(
)
2
2
out
ampl
sm
P
V
R
=
⋅
	
(4.7)
as shown in Figure 4.6 of the balanced amplifier to a push-pull technique. The tra-
ditional push-pull is built with the in-phase input signal but complementary power 
transistors because the pair of complementary output devices is generally available 
in silicon power MOSFET technology. However, the efficiency of such a linear mod-
ulator depends on how the complementary transistors biased. For example, in the 
class-B mode, one transistor has a current flow only 180° of the sinusoid, in other 
words, taking up a half-period. The upper n-channel MOSFET (NMOS) amplifies 

4.2  Linear Supply Modulator 
127
the positive half-cycle of the input signal. The bottom p-channel MOSFET (PMOS) 
amplifies the negative half-wave of the input signal. Therefore, the theoretical ef-
ficiency can be defined as follows:
	
π
π
η
π
⋅
=
=
=
⋅
=
⋅
⋅


⋅
⋅

⋅


2
_ max
2
2
2
4
1
2
ampl
ampl
sm
out
sm
ampl
DC
DC
DC
DC
sm
V
V
V
P
R
V
P
V
V
V
R
	
(4.8)
where the maximum output voltage Vsm_max is twice the amplitude Vampl. Theo-
retically, the maximum efficiency is 78.5% occurring when Vsm_max = VDC. For the 
class-AB mode, every transistor has current flow more than 180° of the sinusoid. 
Therefore, the maximum efficiency is between 25% and 78.5%. However, the gain 
of push-pull pair is a unit that requires additional amplification in the state of the 
driver stages for envelope amplification (see Figure 4.7).
However, this type of linear amplifier suffers from crossover distortion because 
when the input signal is small, there is not enough voltage to turn on either MOS-
FET. In a supply modulator application, the distortion requirements are stringent 
because any distortion at the output of the modulator would have embodiments at 
Figure 4.6  A typical class-AB/B push-pull source follower pair.
Figure 4.7  Illustration of crossover distortion in push-pull source/emitter follower pair.

128 
��������������������������������������
Supply Modulator for Envelope Tracking
the RF PA output by the supply modulation effect. Careless design that binds each 
MOSFET gate together and connects the gates OPAMP driver output would suf-
fer from crossover distortion straightforward. Furthermore, the higher frequency, 
which leads to the obvious distortion, may be observed. Therefore, an approximate 
100Ω gate resistor should be always placed physically near the gate of MOSFET to 
reduce crossover distortion. This solution is possible because most of the OPAMP 
drivers used for ET application can handle significant output currents. Hence, the 
gate resistor, in fact, causes OPAMP to supply low values of the load current until 
the voltage drop across the resistor reaches the threshold voltage of the MOS-
FET. Therefore, there is then a smooth transition to the MOSFETs to supply the 
dominant current. The Rgn and Rgp resistors should be as low in value as practical. 
Choosing the right gate resistors guarantees that the maximum required control 
voltage to the gate coincides with current limit of OPAMP driver device. This helps 
ensure that the MOSFET gate will never be overridden. In addition, the 100Ω gate 
resistors prevent local stage oscillations. It is important that they be physically close 
to the gate of MOSFETs.
In addition, crossover distortion can be reduced by biasing the MOSFETs. The 
bias voltage needed to reduce the crossover distortion can be simplified by not 
turning on the output MOSFETs. Without bias and typical MOSFET threshold, it 
takes twice the voltage swing to transit through the crossover region. Any amount 
of bias reduces crossover distortion. Biasing the MOSFETs mean that they are both 
just on the point of conducting so that a small input signal will be able to turn 
on one or the other of MOSFETs. Without bias, if there is no signal, the current 
through the MOSFET is zero. With bias, there will be a small quiescent current 
flowing through.
The signal output of the MOSFET is supplied to the inverting input of a non-
inverting OPAMP driver as negative feedback, as shown in Figure 4.8. Therefore, 
the gain of the push-pull output stage is unit one. The closed loop gain of the linear 
modulator can be determined as
	
fb
g
PP
g
R
R
G
R
+
=
	
(4.9)
Figure 4.8  Representation of the linear modulator circuit of push-pull pair output stage in which 
crossover distortion is not a problem by building a gate-to-source resistance Rgn and Rgp.

4.2  Linear Supply Modulator 
129
By tuning the ratio between the feedback resistor Rfb and the inverting input 
terminal ground resistance Rg, the gain of the entire linear modulator can be set 
flexibly.
4.2.2.2  Totem-Pole
For some compound semiconductor such as GaN process, PMOS is hard to find for 
complementary output stage design. Therefore, there is no complementary power 
transistor pair available. Only NMOS transistors are available for above mentioned 
push-pull linear modulator design. Therefore, an alternative is to use a quasi-com-
plementary connection with fully NMOS design. Therefore, the output stage on 
a quasi-complementary design can be named as a totem-pole with NMOS pair. It 
consists of a 0° to 180° phase shifter at input for driving two identical n-channel 
active devices in an antiphase mode, as shown in Figure 4.9.
Typically, the totem-pole with quasi-complementary connection can be imple-
mented on the negative half-side with the NMOS for sink function. In this topol-
ogy, the gate bias for sink transistor requires careful selection so that the bias volt-
age corresponds to the maximum gate driving level required by the sink transistor 
T4. The gate resistance is to be kept low for the best bandwidth performance, 
with a value around 100Ω generally. In carrying out the quasi-complementary with 
class-AB/B biasing, the bias voltage is selected such that the transistor T4 is never 
turned on under quiescent conditions. The bias voltage under quiescent conditions 
should be sufficiently below the threshold of the transistor T4. Then the transistor 
T4 would be in the off state even at extreme temperatures.
In comparison with the push-pull counterpart, could totem-pole show identical 
distortion performance to push-pull by fine tuning, but the output voltage swing 
is limited under identical conditions. It is because that the output voltage swing of 
totem-pole is inherently limited by the required gate bias the with a two-NMOS 
source follower pair. This disadvantage of the quasi-complementary is higher satu-
ration voltage to the negative supply rail as two gate-source voltages are stacked 
between the rail and the output. Hence, it results in lower swing than the push-pull 
counterpart. However, a simple way to improve the output swing is to get a better 
saturation of the MOSFETs. This is done by executing the OPAMP driver power 
Figure 4.9  Representation of a class-B totem-pole linear modulator output stage with two identical 
NMOS transistors with an input phase shifter, which can either be a balun or a differential OPAMP.

130 
��������������������������������������
Supply Modulator for Envelope Tracking
supplies with several volt levels greater than the drain voltages of output MOS-
FETs. Output stage design can benefit from the driver OPAMP work on higher sup-
ply voltages than the power MOSFETs. This enhances the efficiency by improving 
the saturation of the output stage. Finally, the slew rate on the totem-pole is also 
usually lower than the push-pull counterpart.
Design criteria for the totem-pole are the same as in the push-pull topology. Be-
cause the ET modulator application could be exposed to load variations or shorts, 
some type of current limiting scheme is needed for output stage transistors. Simple 
current limiting facility is a small signal bipolar transistor sensing the voltage drop 
across a MOSFET source resistor. A diode in the collector circuit is necessary to 
avoid forward-biasing the collector-base junction of the current limit transistor 
on the side that does not provide current; otherwise, it would prematurely cut the 
output voltage swing. 
Careful design considerations to prevent thermal runaway are necessary for 
high-power ET supply modulator. Thermal runaway occurs when the temperature 
coefficient (TC) of bias source cannot match with the threshold voltage of power 
MOSFET. Power MOSFETs have a positive TC of the drain current relative to the 
gate-to-source voltage Vgs at its threshold, which means the drain current increase 
with temperature rise. This increased temperature further increases the current. 
Most power MOSFETs eventually have a negative TC of drain current versus gate 
bias, but it occurs at very high currents. This condition usually leads to destruction 
in linear circuit application. With a Vgs multiplier, it is a typical way to provide 
temperature-compensated biasing when the output MOSFETs have to be turned 
on [100]. The same MOSFET type or geometry used for the output devices should 
be used for the Vgs multiplier design. The Vgs multiplier circuit can be built with 
complementary push-pull or quasi-complementary totem-pole type either. The de-
sign of a Vgs multiplier can be reached only through empirical experimentation on a 
real working linear modulator. Finally, the output stage current can be set as low as 
possible to reduce transconductance and sensitivity to the biasing and is therefore 
easier to compensate for.
4.2.3  Class-G/H
In the traditional linear PA modes such as class-AB/B, the emphasis is mainly on lin-
ear quality and less regard is given to the amount of power loss. However, the mod-
ern high-PAPR signal has revealed their inefficiency shortcomings of traditional 
linear PA. As a result, further efficiency improvements to class-AB/B are extensively 
searched. Class-G/H mode operation is an inexpensive but effective way to increase 
the efficiency of linear supply modulators [16–19]. To deal with efficiency challenge 
from a high-PAPR signal, class-G/H amplifiers usually have two or more supply 
voltage levels because they can adapt power supply voltages to fit the required 
output power to some extent. The higher and lower supply voltages are defined by 
both the maximum output power required and the minimum supply voltage that 
the amplifiers can operate above a predefined threshold for THD performance.
The class-G PA concept was first introduced by Hitachi in 1976 with the aim 
of reducing the power loss of amplifiers, because high-PAPR signal amplification 
resides mostly at low-power levels. Therefore, its inner dissipation is much reduced 

4.2  Linear Supply Modulator 
131
by running from low-voltage supply rails for small outputs and switching to higher 
supply rails for larger signal excursions, as shown in Figure 4.10.
In contrast to class-G PAs, class-H PAs smoothly regulate the output voltage 
according to the requirements of the output signal. In contrast to a class-G PA, a 
class-H PA is not limited to two or three fixed but discrete supply voltages. It can 
create smooth transitions from the lowest permissible supply voltage to any other 
supply voltages available. The common class-H mechanism is a form of bootstrap-
ping. A class-H PA can therefore operate with a supply voltage closely matched 
to the actual output voltage. It minimizes the amount of energy that needs to be 
dissipated by reducing the difference between the supply voltage and the output 
voltage. However, the class-H mode is once more basically a class-B mode, but with 
a method for changing the dynamic single-supply rail, unlike class-G to switch to 
another supply level discretely for efficiency enhancement [19], as shown in Figure 
4.10. 
Actually, in ET applications, a supply modulator for 3G and 4G signal operates 
most of the time at the minimum permissible supply voltage. Power consumption 
in class-G/H modulators, and therefore the contribution of the linear modulator to 
total supply modulator system power consumption, is more or less determined by 
its THD threshold limited lower level of supply value. Because class-H is occasion-
ally used to describe class-G in some literature, class-G/H is used in this book to 
illustrate general cases.
The basic class-G/H PA with two supply rail voltages is shown in Figure 4.11. 
Current is drawn from the lower supply voltages ±α · VDC whenever possible. The 
signal should exceed lower supply voltage ±α · VDC and transistor T6 conducts 
Figure 4.10  Illustrations of the waveform characters of the class-G and class-H PA mode.

132 
��������������������������������������
Supply Modulator for Envelope Tracking
and diode D3 switches off, hence the output current is now fully drawn from the 
higher supply rails ±VDC, with power dissipation shared between transistor T3 and 
T6. The inner push-pull transistors T3 and T4 are generally in the class-B operation 
although class-AB/A are also possible if the output stage bias is correspondingly in-
creased. The outer devices operate efficiently in class-C mode because they conduct 
significantly less than 50% of the time. In principle, movements of the collector 
voltage of the inner device yet should not significantly affect the output voltage, but 
in practice class-G/H PA often has worse linearity than a class-B mode due to glitch 
issue resulting from charge storage in commutation diodes D3 and D6. However, 
when glitches occur, they do so at moderate power, well displaced from the cross-
over region and appearing relatively infrequently with real signals. An obvious 
extension of the class-G/H principle is to increase the number of supply voltages, 
but with a typical limit of three. Power dissipation is further reduced and efficiency 
increased as the average voltage from which the output current is drawn is kept 
closer to the minimum. For triple-supply pair class-G/H, the inner devices operate 
in class-AB/B as before, and the middle devices are in class-C mode. The outer most 
devices are in class-C mode but conduct for even less time. Typically, a triple-level 
class-G/H amplifier is made only in shunt mode, essentially because the cumulative 
Figure 4.11  Illustration of a typical class-G/H modulator output stage. When the output voltage ex-
ceeds the transition level, D3 or D4 turn off and power is drawn from the higher supply rails through 
the outer power devices.

4.2  Linear Supply Modulator 
133
voltage drops are too large in series mode and affect the efficiency performance. 
Furthermore, the additional complexity is significant because there are now six 
supply rails and at least six power devices, all of which must carry the full output 
current. It seems very unlikely that this further reduction in power consumption 
could ever be worthwhile considering the circuit complexity.
From the histogram plot in Figure 4.12, comparing the LTE envelope output 
from the linear modulator PDF and adjusting the α value to two-thirds can move 
the peak efficiency point to fit to the average envelope power and achieve the best 
efficiency. The quasi-linear scatter points are the traditional class-B mode efficiency 
versus output voltage back-off, whose efficiency is much lower at average volt-
age. With the intention to move peak efficiency point to tolerate more back-offs, 
α = 1/2 is set and the results are shown in gray scatter and a polynomial fitting 
curve. By doing this, the peak efficiency point is moved to a lower voltage region. 
While there is a peak efficiency drooping effect and deeper drop-down between 
two peak-efficiency points while tuning α value into smaller values because of 
various nonideal effects in practical components, backed-off peak efficiency points 
would droop to some extent while α values are lower, which would cause overall 
efficiency deviation from theoretical values.
Initially, the input signal amplitude is small enough so that it can be supported 
by the lower supply rail. However, at some time before the signal exceeds a certain 
threshold, the logic control signal changes indicate that the higher power supplies 
should be used.
Although the continuous mode class-G/H topology in Figure 4.11 offers sub-
stantial energy savings with high-PAPR signals, actually much additional circuitry 
must be added. Transistors used in such class-G/H amplifiers usually have very 
limited reverse base-emitter breakdown. Additional Schottky diodes must be used 
to ensure that the signal at the base of the transistor T6 and T8 does not damage 
these transistors. Such a topology does not make good use of the available power 
supply because it uses series devices for the class-G/H switching implementation. 
Figure 4.12  Illustration of the class-G/H instantaneous output voltage and efficiency compared to 
the class-B mode in which a piece of the LTE 20-MHz envelope is simulated.

134 
��������������������������������������
Supply Modulator for Envelope Tracking
By replacing the outer class-C devices with a pulse-mode switch, a simple and ef-
ficient outer circuit can be implemented as shown in Figure 4.13.
As shown in Figure 4.13, a method is illustrated for a discrete zero overhead 
class-G that would be able to select supply voltages dependent on the signal ampli-
tude but without the considerable overhead voltage requirements of the continu-
ous class-G/H scheme described above. The principal disadvantage of continuous 
class-G/H is that it controls two stacked BJT emitter-follower output stages, which 
requires having all output and supply rail transistors kept in the forward active 
state. The process technology such as BiCMOS can offer MOSFET devices used to 
switch between power supply rails while maintaining the inner BJT class-B topol-
ogy for the output stage. This technique uses a logical control signal for MOSFETs 
to switch and select between two power rails to supply the load current. The use 
of MOSFET devices offers several advantages. First, the main peak load current 
in the steady state with no gate current can be supplied. The emergence of high 
injection and quasi-saturation effects of BJT reduces the beta and therefore the ef-
ficiency. Second, when BJT is used for a switch, great care must be taken to avoid 
the BJT being driven deep into saturation because of charge storage effects and a 
consequence of the minimum switching time. The goal is to minimize the amount 
of time spent on the higher power supplies to maximize the class-G/H efficiency.
Another closely related type is the shunt class-G/H amplifiers. The shunt class-
G/H supply rail switches using many different supply voltages connected to the 
output according to the required voltage level. In this way, the individual voltages 
are produced “outside” the supply modulator by highly efficient SMPSs. The tran-
sistors operate in semilinear mode so that the drain/collector voltage will smoothly 
track the envelope signal. Actually, a shunt class-G/H modulator consists of two 
or more parallel-connected class-B PAs with different supply voltages. Low-voltage 
segments of the amplified signal from the low-voltage components of the amplifier, 
which reduces the power loss and increases the efficiency. The average efficiency of 
a shunt class-G/H modulator depends on both the voltage-transition point and the 
amplitude distribution of the signal. Average efficiency for a number of signals with 
envelope modulation can be calculated. For typical PAPRs around 6 dB, average 
efficiency for two-rail shunt class-G/H modulator is in the range of 60% to 70%, 
in contrast to the 30% to 40% of a class-AB/B linear modulator.
Figure 4.13  Illustration of a typical two-supply rail class-G/H output stage with simple pulse-mode switch 
for outer devices. (From: [20]. © 2003 IEEE. Reprinted with permission.)

4.2  Linear Supply Modulator 
135
Figure 4.14 shows the principles, at low outputs just below level-N, that only 
transistor T2N and T2N–1 conduct to deliver power from the low-voltage power sup-
ply rails. When the signal is above a threshold selected bias level-N, transistor T2N–2 
and T2N–3 switch on to accordingly draw current from the high-voltage supply rails. 
The conduction periods of class B/C mode devices such as transistor T2 and T1 are 
variable, but are inherently less than 50%. Typically, the low-voltage section oper-
ates in the class-B mode to keep linearity but minimize power loss. Theoretically, 
the more supply rails used, the more powerful shunt is achieved to further reduce 
the average voltage drop between rail and output at the expense of circuit complex-
ity. However, the disadvantage of this shunt topology is evident. It is noisier due to 
switching operation in principle. Also, more external SMPSs would create a more 
complicated supply modulator system with an increasing number of supply rails.
In the simplified shunt class-G/H of Figure 4.14, transistors T1 and T2 com-
prise a high-power class-B/C component with operation of the full supply voltages 
±VDC. Transistors T3 and T4 comprise a low-power class-B/C component with op-
eration of the reduced supply voltages as ±α ·VDC. Signals whose peak amplitudes 
are smaller than the threshold voltage α ·VDC will be amplified exclusively from 
the low-power class-B component with supply rail as ±α ·VDC. Because the instan-
taneous efficiency of a class-B amplifier is proportional to the ratio of the output 
voltage to the supply voltage, the efficiency is higher by a factor 1/α than it would 
be if only the high supply rail class-B component were used for amplification. For 
signals of greater amplitude changed from the low-power component to the high-
power component when the instantaneous amplitude exceeds threshold voltage α 
Figure 4.14  Illustration of shunt class-G/H PA. Such shunt class-G/H arrangements are the commutating 
amplifier.

136 
��������������������������������������
Supply Modulator for Envelope Tracking
·VDC, the high amplitude segments of the signal waveform will be amplified with 
the efficiency of a conventional class-B/C amplifier as the full supply voltage ±VDC 
to be used. The segments with lower amplitude can theoretically be with an ef-
ficiency of 1/α times of that for a full-power class-B/C PA. Therefore, the average 
efficiency of a shunt class-G/H amplifier exceeds that of a class-B amplifier at all 
signal levels.
The instantaneous efficiency is the efficiency of the class-G/H amplifier for 
a given output voltage. The output voltage and supply voltage-transition ratio α 
can easily set the characteristics of instantaneous efficiency in a shunt class-G/H 
amplifier. However, most actual envelope signals include a plurality of different 
amplitudes. The average efficiency of a class-G/H amplifier therefore depends on 
both the voltage transitions and the nature of the envelope signal to be amplified. 
The signal amplitude statistical characteristics can be revealed in the probability 
density function of the signal. 
The shunt class-G/H amplifier in Figure 4.14 can be modeled as 2 · N indepen-
dently controllable current sources and sinks, but only one current source produc-
ing nonzero current at a particular time. Here a two-supply-rail modeling is illus-
trated as an exemplary class-G/H amplifier efficiency exploration. The class-G/H 
amplifier effectively reduces the supply voltage from ±VDC to the ±α ·VDC when the 
signal strength is lower than the threshold voltage α ·VDC. The theoretical instanta-
neous efficiency for a two-supply rail-pair class-G/H operation can be derived from 
(4.8) of class-B operation, but as a piecewise function therefore.
	
(
)
(
)
(
)
0
sm
DC
sm
DC
sm
sm
sm
DC
DC
sm
DC
V
V
V
V
V
V
V
V
V
V
α
α
η
α

⋅
<
<
⋅

= 
⋅
<
<

	
(4.10)
As shown in Figure 4.15, the instantaneous input power is reduced by a factor 
α, and the instantaneous efficiency is increased by a factor 1/α when the signal level 
is below the transition threshold voltage threshold α ·VDC.
Figure 4.15  Theoretical instantaneous efficiency curves for comparison between shunt class-G/H 
and class-B and the probability density function of a typical high-PAPR signal.

4.2  Linear Supply Modulator 
137
4.2.4  Power DAC
Figure 4.16(a) shows the voltage of an RF signal and an ET supply voltage over 
time. In contrast to the conventional fixed DC supply RF PA, the continuous ET 
provides various voltage changes with respect to the envelope of the RF signal. The 
difference between the supply and output is much smaller than that of the con-
ventional fixed DC supply counterpart and therefore exhibits a higher efficiency 
improvement with ET technology. However, in Figure 4.16(b), the ET power supply 
voltage can vary in discrete steps. Therefore, this type of discrete envelope form to 
construct supply modulator is named as a power digital-to-analog converter (DAC) 
in ET applications. One of most important power DACs is segmented current steer-
ing DAC topology, as shown in Figure 4.17. It shows an implementation of cur-
rent source array with a binary, a thermometer, or a combination of two decoding 
methods, with current cell units with unit current level as “I” here for illustration. 
The current source arrangement can be high-speed switching to supply and build 
time-varying output currents and voltages.
Figure 4.17(a) shows an (M + N)-bit segmented current steering array con-
structed from one fully-decoded M-bit thermometer decoding array and an N-bit 
binary decoding array. These path selection switches must be driven simultaneously 
from parallel latches in order to minimize the output glitch. Each independent cur-
rent source cell is generally “I” for current steering and the minimum voltage for 
binary part can be 2–N · I, while the output current is 2–N · I ~ (2(M+N) – 1) · I. In 
general, it needs (2M – 1) + N current source cells connected in parallel connected 
to current output terminal so as to achieve the required supply. Different demands 
for bias supply change, according to the envelope information and load, to the ap-
propriate output voltage levels.
As shown in Figure 4.17(b), it is also often desirable to utilize more than one 
fully decoded thermometer section to make up the total power DAC. Figure 4.17(b) 
also shows an (M + N)-bit DAC constructed from two fully-decoded thermometer 
DACs. As previously discussed, these current switches must be driven simultane-
ously from parallel latches to minimize the output glitch. 
The exemplary technical implementation uses two sections of segmentation 
as shown in Figure 4.18. This basic core is controlled by microprocessor with 
Figure 4.16  ET supply voltage versus time: (a) continuous ET supply and (b) power DAC output 
supply.

138 
��������������������������������������
Supply Modulator for Envelope Tracking
precalibrated envelope parameters. The control bits are (M + N), split into M and 
N after a synchronized (M + N) bit latched with the system synchronous clock. The 
following are the thermometer decoders to decompose the bits into more discrete 
ones for current switch control. Before sending to current switches, another (2M 
+ 2N − 2) bit synchronous latch is applied to synchronize the timing of final bit 
streams. After the control function of current switches on current source cells, the 
outputs are combined together to form a variable continuous output voltage supply 
via a summing node.
Figure 4.17  A typical power DAC implementation using current sources. (a) (M + N)-bit current 
output segmented DAC based on one thermometer DAC and one binary DAC. (b) (M + N)-bit cur-
rent output segmented DAC based on two thermometer DACs.
Figure 4.18  An (M + N)-bit control scheme for the two-section thermometer decoding segmented 
DAC in Figure 4.17(b).

4.2  Linear Supply Modulator 
139
Figure 4.19 is a schematic diagram of a power push-DAC. The push-DAC 
consists of a current mirror as bias circuit and a current source array. The current 
source array includes a bias circuit to generate the bias voltage Vbias, current source 
elements and switch control circuitry. The output of array is electrically connected 
to an RF PA supply voltage Vsm. The push-DAC is annotated to include a parasitic 
capacitance Csm and a resistor Rsm as loads, which are electrically connected in 
parallel at the output terminal.
Furthermore, the bias circuit includes a bias current source and a bias PMOS 
transistor. The bias current source is electrically connected between ground and a 
gate of the drain-gate-connected PMOS transistor, as shown in Figure 4.19. The 
bias current source can be configured to produce a bias current Ibias and providing 
the bias current through a channel of the bias PMOS transistor so that the gate of 
the bias PMOS transistor is biased to the bias voltage Vbias.
The current source array includes (2M − 1) + N switches and PMOS current 
source units. The PMOS current source transistors each include the bias voltage 
Vbias to the gate and whose drain terminal is electrically connected to the RF PA 
supply voltage Vsm, with source terminal connected to a DAC decoding switch. The 
DAC decoding switches further electrically connect to the fixed DC supply voltage 
VDC.
The current source array is configured to generate an output current in re-
sponse to a digital decoding input signal. For example, the switches can connect 
the DC supply voltage to the source terminals of PMOS current source transistors 
respectively, based on the values of digital decoding input. In addition, the PMOS 
current source transistors can have binary-weighted values so that the output 
Figure 4.19  An (M + N)-bit segmented current switch array with current mirror topology for power 
push DAC with thermometer and binary decoding.

140 
��������������������������������������
Supply Modulator for Envelope Tracking
currents from the drains of the PMOS current source transistors sum to generate 
an output current IDAC changing in relation to the digital decoding input signal. As 
shown in Figure 4.19, the bias voltage can be applied to the gates of the PMOS 
current-source transistors, which replicates the bias PMOS transistor so that the 
PMOS current source transistors produce output currents scaling with respect to 
the reference bias current Ibias.
As shown in Figure 4.19, the supply voltage waveform changes relatively 
smoothly in response to changes of digital decoding input to the push-DAC. Al-
though the push-DAC generates a digitized output current, changing in discrete 
steps in response to a digital input to the load capacitor and resistor. With the uti-
lization of load capacitor, an output lowpass filter (LPF) can be built and operated 
to the RF PA supply voltage, whereby a relatively smooth supply waveform can be 
obtained. The operation of the load capacitor involvement as the output LPF ele-
ment can reduce the effects of the quantization noise of ET power supply to the RF 
PA. As the load capacitor and resistor can prevent the RF PA supply from rapidly 
changing in response to changes in a digital input of the power DAC, in certain 
scenarios, a separate explicit filter cannot be included to filter the RF PA supply 
voltage.
4.3  Discrete Supply Modulator
In contrast to linear voltage regulators, traditional discrete modulators achieve volt-
age conversion with pulse modulation such as pulse frequency modulation (PFM) 
and pulse width modulation (PWM) for ET. By cyclic switching a pair of switches, 
the power supply can be periodically connected to the load. The output voltage 
is then dependent on the proportion of the switching cycle or duty cycle in which 
the load is connected to the source. The resulting square waveforms contain many 
harmonic frequencies to be filtered to produce a DC output. High efficiency can 
be achieved by driving the switching elements so as to conduct maximum current 
with a minimum voltage drop across them, avoiding simultaneous conduction of 
the switching elements.
Because a high efficiency of ET application is required, the use of discrete 
modulator such as a switch mode power supply (SMPS) is mandatory. Therefore, 
discrete supply modulator plays an important role in ET modulator design. How-
ever, a switching frequency must be at least five times greater than the requested 
bandwidth for ET applications to guarantee acceptable tracking. As we know, 
SMPS for ET is based on binary pulse waves generated from the time-varying enve-
lope. The switching frequency is the limiting factor in the bandwidth of the signal, 
following the rule that the efficiency of the switching power supply apparatus is 
inversely proportional to the switching frequency [32]. For this reason, it is not 
possible to achieve high-efficiency SMPS modulators for wide bandwidth signals 
such as WCDMA and LTE-A [32, 33] alone. The ET SMPS modulator can receive 
a PWM or PFM signal generated by the sensed envelope reference signal. The ef-
ficiency depends mainly on the switching frequency and the architecture of supply 
modulators.

4.3  Discrete Supply Modulator 
141
4.3.1  Isolated SMPS
There are two basic types of SMPS or DC-DC converters, which can be transformer 
coupled or DC coupled without transformer, as shown in Figure 4.20, with differ-
ent varieties of the SMPS family.
The transformer-coupled pluralities of SMPSs are called isolated DC-DC con-
verters. The electrical isolation between input and output is provided in isolated 
SMPSs. It can be very useful in cases in which different ground references are re-
quired. Isolated converters also facilitate higher fixed voltage conversion ratios 
than nonisolated counterparts because the transformer turns ratio can provide a 
significant initial voltage conversion factor. In comparison with nonisolated con-
verters, isolated converters due to the increased number of parts are more compli-
cated and expensive but less efficient. For the variable supply voltage applied to 
ET considered here, electrical isolation is typically unnecessary. In contrast, higher 
voltage conversion ratios can be an advantage, but the transformer turns ratio im-
poses a fixed conversion factor, which can be a disadvantage for ET applications. 
Therefore, the focus of supply modulator design in this book is concentrated on 
nonisolated converters.
4.3.2  Nonisolated SMPS
All nonisolated SMPS converters can be reduced to two basic topologies, direct or 
indirect converters, which both derive from the canonical switching cell shown in 
Figure 4.21. The lateral symmetry between terminal A and terminal B in Figure 
4.21 results in two distinct configurations. With C as the common terminal, it yields 
indirect topology as shown in Figure 4.21(b). However, with either terminal A or B 
as a common terminal, it results in the direct converter topology in Figure 4.21(c).
4.3.2.1  The Indirect Converter
The voltage conversion of indirect topology in Figure 4.21(b) can be explained 
qualitatively by examining the inductor voltage Vind and how it changes with the 
cycling of the switches. While the switch S1 is closed, the current I1 flows in the 
coil, and the polarity of voltage Vind is shown in Figure 4.21(b). When the switch 
S1 opens, the collapsing of inductor current reverses the polarity of voltage Vind. 
However, at the moment when the switch S1 is opened and the switch S2 closes, it 
Figure 4.20  Traditional SMPS architectures with (a) isolated versus (b) nonisolated SMPS.

142 
��������������������������������������
Supply Modulator for Envelope Tracking
discharges the inductor current. The voltage conversion ratio as a function of the 
switching duty cycle D can be derived by examining three conditions. When the 
switch S1 is closed all the time (D = 100%), the voltage V1 is zero all the time. When 
the switch S2 is closed all the time (D = 100%), the voltage V2 is zero all the time. 
When the switch S1 is open half of the time and closed half the time (D = 50%), 
assuming that S2 switches with the opposite phase, the average value of V1 is equal 
but opposite of the average value of V2. These conditions are satisfied by the follow-
ing relationship, assuming that the duty cycle D is defined with respect to the switch 
S1. The voltage conversion ratio of indirect converter can be depicted as
	
(
)
2
1
1
V
V
D
D
= −
−
	
(4.11)
In the above discussion, it has been assumed that the source is connected to 
voltage V1. However, connecting the source to voltage V2 instead is entirely equiva-
lent because of the circuit symmetry. Equation (4.11) shows that the indirect con-
verter produces an inverted output voltage V2 to a higher level than the input 
voltage V1 when the duty cycle D > 50%. However, the magnitude of the voltage 
V2 is less than that of the voltage V1 when the duty cycle is D < 50%. The indirect 
converter is therefore also known as the buck-boost converter.
The indirect converter is capable to produce the output voltages with magni-
tude smaller or larger than the input voltage. It may be advantageous in some ap-
plications, for example, in which only low supply voltages are available and both 
high and low output voltages are required. Therefore, indirect converters are very 
suitable for mobile UE ET applications with the requirements to boost voltages for 
RF PA supply from battery. For the ET application of interest in BTS applications, 
it is assumed that the available supply voltage is sufficiently high, and the output 
voltage only needs to be stepped down. In this case, a large part of the practical 
Figure 4.21   (a) The canonical switching cell for nonisolated SMPS converters, (b) indirect con-
verter topology, and (c) direct converter topology.

4.3  Discrete Supply Modulator 
143
range of the indirect converter is not utilized because the step-down function re-
quires the duty cycle D < 50%. In most cases, the inverted output voltage of the 
indirect converter circuit is an unneeded complication to be used. However, the 
direct converter, shown in Figure 4.21(c), is better suited for this BTS ET applica-
tion because the output is not inverted, and can be configured to step down the 
supply voltage, while maximizing the use of its full range of operation such as the 
full range of practical duty cycles.
4.3.2.2  The Direct Converter
As shown in Figure 4.21(c), after a similar reasoning as used in the description of 
the operation of the indirect converter, the direct converter can be understood by 
examining the relationship between inductor current and voltage and the switch 
duty cycle. It is assumed here that the voltage V1 represents source voltage and V2 
for the output voltage. When the switch S1 is closed, current I1 flows through the 
inductor to generate a voltage Vind at its terminals. When the switch S1 is opened, 
the polarity of the voltage Vind reverses to that shown in Figure 4.21(c) because at 
the same time switch S1 opens and the switch S2 is closed, voltage V2 is equal to the 
sum of the voltages as (V1 + Vind). In this case, with a source voltage equal to V1 and 
the load voltage equal to V2, the direct converter operates as a noninverting voltage 
step-up or boost converter. By swapping the connections of the source and the load, 
it results in the direct converter operating as the noninverting step-down or buck 
converter, which is commonly used in BTS ET applications.
With respect to the duty cycle D of the switch S1, the voltage conversion ratios 
can be derived by further analyzing three cases in which the switch S1 is closed 
all the time (D = 100%), the switch S1 is open the all the time (D = 0%), and the 
switch S1 is closed and the switch S2 is open half of the time (D = 50%).
When the switch S1 is closed and the switch S2 is open the all the time (D = 
100%), the voltage V1 corresponds to zero. When the switch S1 is open and the 
switch S2 is closed all the time (D = 0%), the voltage V2 is equal to voltage V1, 
and when the switch S1 and the switch S2 are opened and closed half the time (D 
= 50%), the average of the voltage V1 equals the average of V2 because the aver-
age voltage across the coil must equal to zero resulting from a DC short circuit. 
Assuming that the duty cycle is defined in terms of switch S1, these conditions can 
be satisfied by the following expression for the voltage conversion ratio of direct 
converters.
	
(
)
1
2
1
V
D V
=
−
⋅
	
(4.12)
Ideally, the circuit is lossless so that the current from the source is pulled fully 
to the load. When it is applied to (4.12), the following relationship between the 
currents as a current conversion ratio of the direct converter can be obtained.
	
(
)
2
1
1
I
D
I
=
−
⋅
	
(4.13)
As shown in Figure 4.22, a full DC-DC converter consists of more than just the 
switching circuit. Control signals are applied to the switches and the output volt-

144 
��������������������������������������
Supply Modulator for Envelope Tracking
age must be stabilized by the feedback control circuit, while the filters suppress the 
harmonics of the square voltage waveforms. 
The transient and steady state response of the buck converter can be analyzed 
based on Figure 4.23. The transient response depends primarily on the frequency 
response of the output filter as shown in Figure 4.22 and the change in voltage 
magnitude. The steady-state behavior of buck converter is substantially equivalent 
to the switching noise. It is dependent on the magnitude of the input voltage. The 
bandwidth and noise of the buck converter can be analyzed initially with a series 
inductor as a first-order output filter, as shown in Figure 4.23.
The buck converter shown in Figure 4.23 performs the voltage step down func-
tion because the load is connected to voltage V1 and the source is connected to volt-
age V2. Because the output filter must present high impedance at the switching fre-
quency of the buck converter provided, the transient response is limited primarily 
Figure 4.22  Block diagram of a nonisolated direct converter with drive, control, and filter circuits.
Figure 4.23  Illustration of the steady-state for a typical buck converter in ET applications.

4.3  Discrete Supply Modulator 
145
by the output filter. Because the switching speed is many times higher than the 
cutoff frequency of the R-L filter circuit with the load resistor and filter coil, the 
quasi-static approximation can be applied, which allows the transition to the pulse 
modulation waveform over the switch S1 to be replaced by a step changing the 
voltage ∆V. The transient response of the R-L filter circuit can be considered first-
order linear differential equation. The governing equation for current response via 
a series R-L filter circuit, with a step changing voltage ∆V is:
	
(
)
1
1
0
dI
dt
I
R L
V L
+
⋅
−∆
=
	
(4.14)
The resultant transient voltage waveform can be expressed as transient output 
voltage response of a series R-L filter circuit, stimulated by ∆V:
	
( )
( )
(
)
1
1
t
t
out
init
final
V
t
I
t
R
V
e
V
e
τ
τ
−
−
=
⋅
=
⋅
+
⋅
−
	
(4.15)
where τ is the definition of R-L time constant as τ ≡ L/R; ∆V can be defined as a 
relationship to Vfinal and Vinit as
	
final
init
V
V
V
∆
≡
−
	
(4.16)
The steady state output voltage ripple can be calculated by the evaluation of 
the inductor current from the pulse modulation waveform across the switch S1. 
Therefore, the steady state coil current can be expressed as
	
∆
⋅
⋅
=
⋅
∫
∫
1
0
0
I
D T
i
L
di
V dt 	
(4.17)
By solving (4.17) for ∆I1, the steady state voltage ripple can be written as
	
(
) (
)
(
)
1
1
sw
V
R L
D V
f
∆
=
⋅
⋅
	
(4.18)
Also for the same switching noise specification, operating a buck converter 
with a high switching speed corresponds to a higher cutoff frequency of the output 
filter. The increase in the switching frequency results in a size reduction of the filter 
components and an increase in the bandwidth of the buck converter. However, it 
also causes a proportionate increase in switch drive power. The drive power for 
simple buck converter can be expressed as:
	
2
2
drive
in
drv
sw
P
C
V
f
=
⋅
⋅
⋅
	
(4.19)
In (4.19), Cin is the input capacitance of each switching devices, which is as-
sumed to be identical for all switches, Vdrv is the magnitude of the square drive 
signal, and fsw is the switching frequency. 
For high-power switching devices, the switch devices are large and correspond-
ingly result in large input capacitances. While the energy needed to drive large 
switch devices with high switching speed is significant, the drive circuit must also 
be strengthened to be able to handle the high instantaneous currents to minimize 
the rise and fall time of square pulse modulation control signals. The instanta-

146 
��������������������������������������
Supply Modulator for Envelope Tracking
neous capacitor driving current for the rise time 1% of the switching period can be 
expressed as
	
_
100
drive
inst
in
drv
sw
I
C
V
f
=
⋅
⋅
⋅
	
(4.20)
As an illustrative example, assume that a typical switching MOSFET with 8-A 
maximum current and 2 nF input capacitance. The test needs to conduct 8-A at 
room temperature driven with a 10-V input signal. Using these values in (4.20) and 
assuming a 10-MHz switching frequency operation, it would be the driver circuit 
need to source and sink 20-A current simultaneously. Even the most rugged power 
MOSFET drivers are designed to source and sink on around 2A, so practical maxi-
mum switching frequencies for high-voltage and high-power buck converters are 
limited to several megahertz unless an additional external driver buffer is added.
4.3.2.3  SMPS Feedback Control
There are two types of feedback control widely used in SMPS. The first type is the 
well-known voltage control mode as shown in Figure 4.24. The function of the out-
put sampling/scaling resistors and the error amplifier A1 are the same as described 
in Section 4.2.1. In this case, an additional error amplifier A2 uses the output level 
of the error amplifier A1 as the threshold value at which to generate a PWM square 
wave output from a sawtooth voltage waveform Vramp.
The majority of commercially available SMPS output voltages are intended 
for fixed supply applications, but some have the possibility of varying the out-
put voltage with an external control signal. Figure 4.24 shows the voltage control 
mechanism as a variable resistor, but other methods, such as providing an external 
reference voltage in place of Vref, are also possible.
The second type of feedback is known as current control mode, which has a 
second current sense feedback loop in addition to the voltage sensing loop used in 
voltage-mode feedback. The current measurement loop monitors the current in the 
switch S1 and adjusts the duty cycle of the driving signal Vdrv so that they directly 
compensate for load changes.
The periodic clock synchronization signal CLK sets the SR flip-flop, caus-
ing Vdrv to go to its maximum value to drive the switch S1 into closed state. The 
Figure 4.24  Illustration of voltage mode feedback control of buck converter.

4.3  Discrete Supply Modulator 
147
negative voltage drop from the reverse current Is1 flowing through a second current 
sensing resistor causes the second comparator A2 to reset the SR flip-flop, resulting 
in voltage Vdrv to go to the minimum value, and the switch S1 is opened.
The voltage stabilizing action of the current-mode feedback control therefore 
operates on two different time scales. The voltage feedback loop operates on a 
longer time scale depending on the output filter response. For example, it is on the 
order of several switching periods. V1 Port is thus usually shunted with a filtering 
capacitor, as shown in Figure 4.25.
The current sensing loop operates at a much shorter period in the order of a 
fraction of a switching period. It is therefore able to respond to load transients. 
The drop in load resistance will lead to a corresponding increase in load current, 
thereby reducing voltage Vsen, causing the output voltage Vdif of the error amplifier 
A2 to go positive. It will trigger reset on the RS flip-flop to its low state, and thereby 
switch S1 to open. The effect of this current sensing feedback action causes a reduc-
tion in the duty cycle, and thus prevents the output voltage V1 dropping with the 
present instantaneous load resistance drop.
In the current-mode control, the switching duty cycle is controlled on a cycle 
by cycle basis, which enables a stable output voltage by feedback control loop even 
if there are fast load fluctuations. Note that current mode feedback results in a 
nonconstant switching frequency. Variable switching frequency has two potential 
advantages. First, assuming that the current mode feedback loop generates random 
switching frequencies, the effect of switching noise is less severe compared with the 
constant switching frequency because the noise power is distributed over a wider 
frequency range. Second, switch drive power can be decreased by deliberately re-
ducing the switching frequency of SMPS, resulting in a higher efficiency under a 
light load. However, using the same output filter at a lower switching frequency 
generally results in higher output noise.
4.3.3  Summary of SMPS for ET
The advantages and disadvantages of the four basic types of SMPS converters are 
summarized in Table 4.1. Whether a particular feature is an advantage obviously 
depends on the application, but certain aspects, such as a greater complexity, higher 
cost, and low efficiency, are always disadvantages [34, 35]. For BTS ET application, 
Figure 4.25  Current-mode feedback control of buck converter.

148 
��������������������������������������
Supply Modulator for Envelope Tracking
a dedicated buck converter without output voltage inversion and isolation is re-
quired. In contrast, the buck-boost converter for mobile UE ET application shows 
its potential benefit to boost battery voltage for RF PA supply. As shown in Table 
4.1, nonisolated converters best meet these requirements.
For the ET technique as described, it is not necessary that the SMPS converters 
have fast response time. Viable solutions to conventional SMPS are available and 
both the transient and steady state response of nonisolated converters have been 
studied and well understood. However, the EE&R system with high efficiency and 
high bandwidth supply modulator are mutually exclusive criteria for the conven-
tional SMPS.
Buck converter is especially suitable for the ET application because it is a linear 
relationship between the duty cycle and the output voltage when the input voltage 
is constant. As shown in Figure 4.23, however, this only applies when the buck 
converter operates in continuous conduction mode (CCM), which means the out-
put current is always positive and each off-switching of switch S1 is triggered by 
the on-switching of the switch S2. However, the duty cycle to the output voltage 
relationship is nonlinear when the converter operates in discontinuous conduction 
mode (DCM), which means that each off-switching of the switch S1 is due to a 
natural decrease of the output current to zero, while the switch S2 is not immedi-
ately switched on. Therefore, to successfully operate a buck converter, the open 
loop must be kept under the CCM operation.
Table 4.1  Comparison Summary of SMPS Converters 
Topology
Advantages
Disadvantages
Isolated SMPS 
Architecture
Direct/
Forward 
Converter
DC isolation
Voltage pre-scaling by transformer turns 
ratio
Selectable output polarity
Multiple outputs using tapped secondary
Expensive and lossy with transformer
Transformer parasitic inductance 
issues
Isolation complicates feedback
High switch stress
Indirect/
Flyback 
Converter
DC isolation
Voltage pre-scaling by transformer turns 
ratio
Selectable output polarity
Multiple outputs using tapped secondary
buck or boost operability
Expensive and lossy with transformer
Transformer parasitic inductance 
issues
Isolation complicates feedback
High switch stress
Non- 
isolated SMPS 
Architecture
Direct 
Converter
Relatively simple design
Fewer components result in higher 
efficiency
Dedicated buck/ boost operation
Non-inverting output
Lowest switch voltage stress
Buck/ boost operation depends on 
configuration of load & source
Non-inverting output
No isolation
Indirect 
Converter
Relatively simple design
Fewer components result in higher 
efficiency
Buck/ boost operability
Inverting output capability
Buck/boost operation reduces range of 
usable duty-cycles
Output voltage inversion
High switch stress because of output 
inversion
No isolation 

4.3  Discrete Supply Modulator 
149
The switching efficiency of nonisolated converters is directly related to the op-
erating frequency. Switching frequency can be translated in the duty cycle value 
associated. The efficiency is basically a relationship of the time of the supply in 
the off state, saving power, and still has enough power supplied for the load. Buck 
converter basically reduces the supply voltage in a conversion ratio directly propor-
tional to the duty cycle D while the boost converter generates a greater amplitude 
voltage than that supplied. Its proportion M(D) can be given by M(D) = 1/(1 – D). 
Finally, the buck-boost converter operates as a combination of the two previous 
converter and can produce negative voltages in the same proportion of the boost 
converter as M(D) = – D/(1 – D)
As a result of increasing the switching frequency decreases the efficiency of 
SMPS, and consequently, the supply efficiency of the ET system decreases as well 
[31]. Traditional SMPS power supplies are not an appropriate design option for ET 
wideband applications. They are not energy efficient for high-speed operation due 
to the high switching losses under a high bandwidth stimulus. It can be seen that 
the switching frequency must generally be 5 to 10 times higher than the tracking 
bandwidth so that when the available switching frequency is limited, the tracking 
bandwidth will be narrowed. Furthermore, the voltage ripple of the SMPS reduces 
the signal-to-noise ratio (SNR). A high-order output filter can improve the output 
voltage linearity [71], but the design is complicated, and the dynamic response 
may be sacrificed. Against SMPS, linear modulators can obtain an output voltage 
having an inherent high bandwidth and high linearity. However, the efficiency is 
relatively low. Therefore, to achieve both high efficiency and high linearity, it is 
better to combine an SMPS and a linear modulator to construct the hybrid supply 
modulator. 
A very good solution to the problem of high efficiency and high bandwidth 
supply modulator was proposed by Mathe et al. [37] in the form of a parallel 
hybrid supply modulator including a high bandwidth linear modulator operating 
in conjunction with a high-efficiency SMPS. The SMPS provides the major load 
power with its essential high efficiency and less efficient linear modulator is con-
cerned with the small remaining portion of the load power. The main function of 
the linear modulator is to improve the linearity of the output voltage.
For the ET application, because most of the power in the envelope of signals 
resides in and around the DC component of the lower end of the spectrum, the 
majority of the load can be handled by the effective SMPS part so that the overall 
high efficiency of the supply modulator can be maintained. The high-frequency 
part of the envelope spectrum as well as the switching harmonics of the SMPS can 
then be handled by the linear modulator. Because these components only represent 
a small fraction of the total envelope power, high overall efficiency can be pre-
served. Therefore, the hybrid supply modulator is a promising candidate for the 
ET scheme.
4.3.4  Multilevel Supply Modulator
The multilevel supply modulator concept is based on a multilevel switching utiliz-
ing different switching power supplies (see Figure 4.26); thereby, the increased effi-
ciency of the circuit corresponds to the number of voltage levels [38–40]. Multilevel 
topology is particularly suitable for ET supply modulator application because it 

150 
��������������������������������������
Supply Modulator for Envelope Tracking
can achieve lower output voltage ripple, high efficiency, and high bandwidth track-
ing, but it requires a plurality of input voltage sources and more complex control 
mechanisms. There are typically two possibilities to implement the multilevel con-
verter for ET application as multiplexed independent voltage sources and voltage 
cells stacked in series.
4.3.4.1  Multiplexed Independent Voltage Sources
As shown in Figure 4.27, a circuit for supplying multilevel modulator will be simple 
with various switches cascaded together with a level detector. The use of multiple 
switches together may introduce unwanted noise generated by the transients in each 
switch. The use of a plurality of switches increases the efficiency with restrictions on 
the number of switches. The more switches, the better efficiency because the closer 
the supply is to the signal, but it will lead to a very high number of switches to get 
high efficiency. The efficiency can be optimized on the characteristics of the signal 
and calculating the number of switches required for a particular type of signal. 
Figure 4.26  Illustration of multilevel supply voltage signal representation of discrete multilevel sup-
ply modulator. The multilevel rail switch is constructed with a high-speed voltage selector by choos-
ing proper voltage source to track and compared with envelope input signal to the threshold values.
Figure 4.27  General scheme of the multilevel supply modulator topology. A multilevel square 
waveform is ﬁltered to obtain the desired envelope.

4.3  Discrete Supply Modulator 
151
For high-PAPR signals, it takes steps from the very low voltages to the high peaks, 
increasing the complexity of the circuit to track the fast changing signals such as 
WCDMA and LTE-A.
Figure 4.27 shows a block diagram of the multilevel system consisting of an 
analog-to-digital converter (ADC) to acquire the envelope signal, a digital signal 
processing (DSP) processor to generate the necessary control signals for the multi-
ple-input topology as a high-speed voltage selector and a lowpass filter (LPF). Fig-
ure 4.27 shows how the system operates in an open-loop manner. This is possible 
because in ET techniques of varying output voltages that must be produced, but 
need not be very precisely shaped. In ET, there is a supply voltage that maximizes 
the RF PA efficiency, and the nearer the supply voltage to this value, the higher the 
efficiency will be, as long as the supply voltage is higher than a certain minimum 
value so that the corresponding RF PA operation is ensured. Thus, a small differ-
ence between the output and the desired supply voltage simply lowers the efficiency 
of the transmitter. However, to ensure the feasibility of the system, the load behav-
ior of the RF PA must be carefully analyzed and a timing alignment scheme should 
be realized by the closed-loop design in Chapter 6.
As shown in Figure 4.27, the input envelope reference signal should be repro-
duced by the ADC and sent to the analog multilevel converter by a control logic 
block, which consists of comparator logic. Each voltage level is activated if the ref-
erence signal is greater than a predetermined value for each voltage level as shown 
in Figure 4.28(a). Consequently, the output voltage of the multilevel converter will 
have discrete levels. The number of levels is dependent on the number of indepen-
dent voltage sources used. Each cell in the multilevel converter and each switch 
in the analog multiplexer will switch at the maximum frequency of the envelope 
reference signal. Still, the dynamics of the multilevel converter depend only on the 
speed of the diodes and MOSFETs used in the switches and cells.
As shown in Figure 4.28(a), the architecture offers all the voltages that are 
needed at its output and a switch network for an analog multiplexer to select any 
level when it is necessary. In the case where the switches are implemented with 
MOSFETs, it is necessary to place diodes in series to guarantee power flow to the 
load and to avoid potential short circuits via MOSFET parasitic diode.
Actually, Figure 4.28(a) shows the multiple input buck converter (MIBuck) 
topology first proposed in [41, 42]. Power MOSFET and Schottky diodes are used 
as the two switches, switching on and off alternately to produce a square voltage 
waveform to the input node of the output lowpass filter. The MIBuck topology 
has several advantages over other aforementioned SMPS topologies for ET ap-
plications. First, the multilevel square voltage waveform is easy to filter to obtain 
low output voltage ripple. Second, because smaller filter component values can be 
used in comparison with a conventional buck topology, the tracking bandwidth 
can be increased for multilevel topology. In addition, the voltage stresses across the 
switches are smaller to reduce switching losses, hence increasing the potential ef-
ficiency and switching frequencies. For example, greater than 90% efficiencies can 
be obtained when the MIBuck is handling the high power and the switching fre-
quency can be higher [41]. Although high-efficiency and low-output voltage ripple 
can be achieved with the MIBuck topology, to achieve a sufficiently high slew rate 
for challenging ET applications, the MIBuck converter is preferred to be combined 
with a linear modulator as the final output stage to form a serial hybrid topology.

152 
��������������������������������������
Supply Modulator for Envelope Tracking
Figure 4.28  (a) Multiple input buck (MIBuck) converter topology with an analog multiplexer with several 
input voltage sources selected each time they apply to the output. (b) Discrete envelope multilevel supply 
modulator with digital envelope form. (c) The voltage cells stacked in series with either two-level cell. (From: 
[45]. © 2013 IEEE. Reprinted with permission.)

4.3  Discrete Supply Modulator 
153
Figure 4.28(b) shows the circuit diagram of the N-level multilevel supply mod-
ulator with discrete envelope inputs. Power MOSFET switches are for the supply 
voltage switches. Reverse current flow is prevented by using Schottky diodes. The 
gates of the power switches are driven by digital inverters with floating supply rails, 
whose reference ground potential is determined by the output amplitude setting of 
supply modulator. The floating low-voltage configuration reduces the power dis-
sipation with driving the gates of the power switches for high-voltage applications. 
Another source of power loss in the discrete multilevel modulator is the diode volt-
age drop, which is an acceptable BTS application in which the supply voltages are 
as high as 28V or 48V. In this case, the inverter gate drivers are driven by digital 
isolators such as isolation barriers. The digital isolators can be driven by program-
mable delay units from DSP blocks. The programmable delay units can implement 
fine delay adjustment for timing alignments between the envelope and RF signal 
paths.
When an ET supply modulator employs a multistage converter, the output can 
be depicted by a step-shaped voltage, which can naturally provide the dominat-
ing load power meeting the bandwidth requirement. In addition, with the cor-
rect switching sequence, the acquisition of the step-shaped voltage can break the 
need of multiple-times higher switching frequency than the modulation bandwidth. 
Therefore, with the same switching frequency, this multilevel configuration is ca-
pable of a higher bandwidth than conventional SMPS power supplies.
4.3.4.2  Voltage Cells Stacked in Series
Another type of multilevel converter is utilizing the voltage cell stacked in series to 
make approximation of envelope in a low dissipative manner, as shown in Figure 
4.28(c). Its output is certain discrete voltage levels by stacking voltage cells. The 
main advantage is that the average switching frequency of those voltage cells is 
much smaller than the frequency of the envelope, depending on PDF of envelope. 
Therefore, it can achieve a high efficiency. Its output voltage can be calculated as a 
combination of the output voltage of the cells as
	
1
N
multilevel
i
Ci
i
V
a V
=
=
⋅
∑
	
(4.21)
where N is the total number of cells, VCi is the output voltage of the multilevel cells, 
and ai can take the values shown in Table 4.2.
Equation (4.21) is valid for design options with two-level cell as shown in 
Figure 4.28(c). However, there are differences in the possible ai values. In the case 
of two-level cell topology, it is possible to add voltages with the values only as +1 
and 0.
4.3.5  Multiphase Supply Modulator
Modern communication standards require the ET supply modulator supply to re-
produce very high current slew rates at relatively high outputs but these require-
ments exceed the capabilities of conventional SMPS. A multiphase buck converter 

154 
��������������������������������������
Supply Modulator for Envelope Tracking
can be used to achieve high-efficiency, large-signal bandwidth as well as high slew 
rate capabilities together with low output voltage ripple over the single-phase 
counterparts. The multiphase modulator concept introduces multiple parallel buck 
sources with digitally controlled process so that high-frequency and special control 
techniques can be implemented.
The multiphase modulator has advantages in terms of ripple reduction and 
ease of filter designs. A multiphase modulator can have current ripple reduction 
for all duty cycles [47]. Additionally, it has a plurality of discrete duty cycles from 
which the modulator shows complete ripple cancellation. Therefore, the smaller 
output capacitor can be used to improve the dynamic behavior of these modu-
lators. For an N-phase buck converter, although there is (N + 1) state variables 
and N switching operations are needed to carry out a minimum time transient, a 
typical multiphase buck converter can be considered as an equivalent single buck 
converter in which the equivalent inductance is a value of L/N which means the 
inductance value of each phase divided by the number of phases [48–50]. One of 
the exemplary solutions is a switching multiphase buck converter with a look-
up table, which varies the duty cycle and operating frequency to maintain soft 
switching under all operating conditions. It dynamically corrects timing to keep 
the phases uniformly distributed in time base. In the multiphase converter, ripple 
cancellation effect of multiphase leads to significantly reduction of the total induc-
tor current ripple and output voltage ripple. Reduced per-phase inductance values 
result in faster responses activated through higher inductor current slew rate and 
wider open-loop bandwidth.
It is therefore appropriate to view the multiphase converter as an N-bit power 
DAC. In principle, the control command of the N-bit DAC for how many phases 
are active can be given at any time. To equalize the phase currents and to minimize 
switching losses, a multiphase modulator takes the task of deciding which phases 
are active. In steady-state, the input control command is constant, and the steady-
state operation is exactly the same as in the conventional multiphase realization 
with per-phase switching frequency equal to the sampling rate fs. However, given 
that the output voltage is sampled at the rate of N · fs, the power DAC command 
is updated at the same rate. The discrete-time compensator can be designed using 
digital control techniques to achieve the system closed-loop bandwidth propor-
tional to N · fs rather than the per-phase switching frequency fs.
In a practical multiphase converter, the phases are not ideally matched. Mis-
matches among phases are due to tolerances and variations in power inductances, 
parasitic series resistances, MOSFET driver and power switch delays, and modula-
tor imperfections. As a result of the phase mismatches, the magnitudes of the total 
inductor current and the output voltage ripple can be significantly higher than 
in the ideal case. In addition, the steady-state output voltage ripple includes not 
only the harmonics of N · fs, but also the subharmonics at fs , 2 ·fs, … (N – 1) · fs. 
Table 4.2  ai Coefficient Values Description for Voltage Cells Stacked in Series
ai Values
Description
1
The input voltage of cell is connected directly to the load.
0
The input voltage of cell is not connected to the load, and zero voltage 
is applied.

4.3  Discrete Supply Modulator 
155
Note that the total output current ripple can be significantly larger than ideal. The 
output voltage ripple magnitude is higher than the theoretical case due to the noni-
dealities. Even more troublesome is the fact that the output voltage ripple contains 
fs harmonics, which are sensed by the wide-bandwidth controller, and can lead to 
system instability. This problem has been pointed out in [51], where it was con-
cluded that traditional analog control loops are practically limited to a bandwidth 
of less than fs/2.
In Figure 4.29, using the Kirchhoff law, the currents can always be expressed as
	
1
N
sum
smi
c
sm
i
I
I
I
I
=
=
=
+
∑
	
(4.22)
where the ideal ﬁlter assumption is considered to simplify the calculation. Being 
a fast transition, the output voltage is approximately linear, which makes the sec-
ond assumption acceptable. Therefore, the voltage during the transition can be 
expressed as
	
(
)
sm
init
V
V
V
t
t
=
+ ∆
∆
⋅	
(4.23)
where Vinit is the initial output voltage of buck converter before the transient starts, 
∆t is the duration of the transient, and ∆V is the voltage difference between the 
target and initial voltage.
For high output voltage slew rates, a minimum output filter capacitor is al-
lowed in multiphase modulator. For simplicity, here we take no output filter ca-
pacitance at all, as shown in Figure 4.29. The choice of the size of inductor in the 
modulator is restricted by the need to generate current slew rates at least equal to 
Figure 4.29  Illustration of a multiphase buck supply modulator with discrete pulse width modulation for ET 
applications. A plurality of phases, with a single master PWM with PWMs for each phase offset from the PWM 
master guarantees that the phases remain uniformly distributed in time in static and quasi-static operation.

156 
��������������������������������������
Supply Modulator for Envelope Tracking
the slew rate of the envelope signal at all times and on all output voltages. With ex-
cessive inductance, the modulator is not fast enough to slew the current. However, 
with an inadequate inductance, the multiphase modulator has a sufficient current 
slew rate to track the envelope signal at all voltages, but the result of current ripple 
and the switching frequency is unnecessarily high to degrade the efficiency. 
To adjust the switching period and timings to keep a soft switching under all 
the static and quasi-static operating conditions, the discrete PWM can be ramped 
at different rates in order to complete the switching period in the required time. 
Similar to conventional PWM control, when the PWM ramp exceeds the corre-
sponding threshold, the switching state is changed for the next interval. Additional 
intervals can be added to create the appropriate dead times during which the soft 
switching transitions occur. 
The ramp rate and threshold should be already pre-computed and stored in a 
look-up table (LUT). For a resistive load, the target output voltage uniquely deter-
mines the output current. However, a more complicated 2-D LUT with reference 
target Vsm and Ism as inputs for the switch timings and ramp increment would be 
needed in the case when the ET PA does not present a resistive load. 
In a multiphase modulator, the phases share current equally, and the phase 
ripple is proportional to the current that the phase carries; thus, the phase ripple 
decreases with the number of phases Nph. The number of switching events on the 
output is proportional to the number of phases, thus reducing the output current 
ripple, ∆Iout, as
	
2
1
out
ph
I
N
∆
∝
	
(4.24)
Depending on the duty cycle, the actual output ripple may be even lower due 
to ripple cancelation between the phases [53]. 
4.3.6  Output Filter for Discrete Modulator
As we know, the transient response of SMPS depends heavily on its output lowpass 
LC filter performance to meet output voltage ripple specifications. Also, it plays 
a major role in the dynamic model of the SMPS, which determines the feedback 
loop style. SMPS for ET must be able to change its output voltage sufficiently fast 
to track wideband envelope signals. Therefore, the output filter design may signifi-
cantly impact the performance of supply modulator.
The output filter for a SMPS usually operates in open loop with a constant load. 
However, for ET it is difficult to compromise among broadband tracking features, 
switching harmonic suppression, and a highly efficient operation. High bandwidth 
can be obtained by increasing the cutoff frequency, but the switching frequency 
must be further increased as well to obtain a sufficient damping of the switching 
harmonics. However, this adjustment, in turn, degrades efficiency of SMPS. There-
fore, the ultimate goal of the output filter design should allow the supply modula-
tor to track a wideband envelope with low distortion and high efficiency as pos-
sible. To achieve this target, several factors need to be considered as ﬁlter type and 
order, the ratio between switching and cutoff frequencies, and component values 
for implementation. Reproduction of maximum frequency component of envelope 
and maximization of SMPS slew rate are strongly desired.

4.3  Discrete Supply Modulator 
157
The typical available LPF topologies are, among others, Butterworth, Bessel-
Thomson, Legendre-Papoulis, Chebyshev, and Elliptic [59–61]. Although Cheby-
shev can deal with variable passband insertion losses and Elliptic is capable of a 
large rejection of certain frequencies, they cannot guarantee sufficient rejection for 
a wide range of frequencies of switching harmonics. Therefore, Chebyshev and 
Elliptic filters are not suitable types for SMPS in ET applications. However, the 
other three major families exhibit appropriate passband and stopband frequency 
response for ET. 
For each type of filter, the slope of the transfer function determines the stop-
band attenuation performance. For a given filter order, Butterworth filters have 
better stopband attenuation than a Bessel-Thomson, but worse than Legendre-
Papoulis. However, Bessel-Thomson exhibits superior behavior with respect to the 
group delay. A constant group delay in the passband ensures that all frequency 
components of the envelope out the same delay. A constant group delay in the 
passband can be easily compensated at system level and usually leads to lower 
distortion. If the group delay varies considerably in passband, the waveform of the 
output voltage suffers from significant distortion. Note that both group delay and 
attenuation at the switching frequency impact signal distortion. However, group 
delay directly distorts the envelope, while poor switching frequency attenuation 
normally causes spectral broadening and out-of-band noise. In summary, Bessel-
Thomson filters are the best candidates for the group delay ripple performance, 
but its stopband attenuation is the worst. Legendre-Papoulis filters have just the 
opposite characteristics, whereas others have Butterworth filter performances with 
which to close the Legendre-Papoulis filters, but are in a position that is halfway 
between two former types. Therefore, the comparison results of figure of merit of 
filter for ET application are summarized in Table 4.3.
As we see from Table 4.3, Bessel-Thomson, Butterworth, and Legendre-Papou-
lis LPFs are suitable as output filter of SMPS are used for ET. The proper design 
of these filters shows that Butterworth and Legendre-Papoulis filters have superior 
performance compared to Bessel-Thomson filter when reproducing band-limited 
envelopes. However, they exhibit overshoot when very fast transients appear in the 
envelope signal. From this point, Bessel-Thomson filters have better behavior due 
to their absence of overshoot when a voltage step must be reproduced, although the 
output voltage variation is slower.
There are also considerations for output filter implementations. In ET ap-
plications, the output spectrum of switches contains the envelope, the switching 
frequency and its harmonics. In this case, the envelope can be assumed as band-
limited [64]. The angular cutoff frequency wc of output filter should satisfy wenv_max 
≤ wc ≤ wsw, where wenv_max is the highest angular frequency component of envelope 
and wsw is the angular switching frequency, neglecting the effects of the components 
Table 4.3  Summary of SMPS Output Filter Topologies for ET
Filter Type
Stopband 
Attenuation
Group Delay 
Ripple
Envelope 
Reproduction
Overshoot 
Suppression 
Bessel-Thomson
Ordinary
Excellent
Good
Excellent
Butterworth
Good
Good
Excellent
Ordinary
Legendre-Papoulis
Excellent
Ordinary
Excellent
Ordinary

158 
��������������������������������������
Supply Modulator for Envelope Tracking
corresponding to the lower sideband near wsw. In this way, wenv_max can be repro-
duced with as low distortion as possible. However, this relationship can also pro-
vide sufficient attenuation at the switching frequency and harmonics. 
4.4  Hybrid Supply Modulator
From the state-of-the-art supply modulators’ topologies, the hybrid supply modula-
tor provides the best performance for the broadband dynamic signals for ET aim 
[65−67]. Hybrid supply modulator combines the advantage of broadband linear 
modulator and the high-efficiency switching modulator in many ways. Use of either 
a linear or SMPS modulator alone is unlikely to satisfy that the joint requirements 
of high efficiency, high bandwidth, and low noise at the same time. The linear 
modulator is wideband but has low efficiency providing power at higher frequen-
cies. The discrete modulator has high-efficiency narrowband that provides power at 
lower frequencies. Both together provide high efficiency and the needed bandwidth 
[68–70]. Therefore, using a linear modulator in connection with a SMPS could take 
advantage of both types of modulators while minimizing the disadvantages. This 
is exactly the approach taken in the hybrid supply modulator topologies here. The 
SMPS and linear modulator can be either voltage-controlled or current-controlled. 
They can be connected in parallel or in series to the output. Therefore, there are 
three kinds of combinations: serial hybrid, parallel hybrid, and combined hybrid.
4.4.1  Serial Hybrid
Serial hybrid topology can be simply understood as boosting supply modulator 
efficiency by means of tracking envelope’s envelope. A serial hybrid supply modu-
lator has combined the linear modulator with the SMPSs to boost up efficiency of 
the linear modulator while maintaining the linearity. In a serial hybrid topology, a 
multilevel/multiphase modulator supplies the linear modulator with discrete volt-
age levels that are as close as possible to the output voltage of the supply modulator. 
In this way, the power losses on the linear modulator are minimal, because they 
are directly proportional to the difference between its supply and output voltages. 
However, to guarantee correct operation of the linear modulator, the output voltage 
of the multilevel/multiphase modulator has to be higher than the output voltage of 
the linear modulator.
As shown in Figure 4.30, an SMPS and linear modulator in series can be com-
bined as a serial hybrid supply modulator. In this case, the bandwidth and slew 
rate can be obtained to meet the requirements, but because all output current flows 
through the linear modulator, there are always losses in it.
The multilevel/multiphase modulator operates in open loop with its maximum 
switching frequency equal to the maximum frequency component of the envelope 
rather than five to ten times higher. The serial hybrid supply modulator has a nar-
rower bandwidth for large signal, limited by the speed of the MOSFETs, and suf-
ficiently wideband for small signal, limited by the linear modulator. 
The multilevel/multiphase modulator has to supply the linear modulator and 
provides discrete voltage levels as close as possible to the output voltage of the en-
tire supply modulator to improve the overall efficiency. By modulating the power 

4.4  Hybrid Supply Modulator 
159
supply of the linear modulator, the efficiency is increased. The multilevel/multi-
phase operates in open loop and closely regulates the output voltage of the linear 
modulator. The main role of the multilevel/multiphase modulator is to manage the 
power supply to the linear modulator and to control of the output voltage of serial 
supply modulator.
The main advantages of the serial hybrid architecture are delivering high band-
width and linearity and significantly higher efficiency in comparison to a linear 
modulator fed by a fixed DC supply voltage. Also it provides negligible output 
voltage ripples, compared to a SMPS solution with a very low switching frequency. 
By using the serial hybrid architecture, it is possible to take advantage of all the 
excellent properties of the linear modulator such as high bandwidth and linearity 
and to achieve much higher efficiency compared with the fixed DC supplied linear 
modulator counterparts. In addition, the requirements for complex output filter 
configuration are avoided because most of the switching noise coming from the 
multilevel/multiphase switching part can be filtered by the linear modulator. Be-
cause of the linear modulator used as a postprocessing regulator, the output voltage 
ripple is never present. The main disadvantage of this architecture is that it takes 
two stages to obtain a high efficiency of the supply modulator. It is necessary that 
the efficiency of the two stages should be as high as possible. The efficiency of the 
linear modulator will depend on the regulating precision of the multilevel/multi-
phase modulator, and to obtain excellent precision for the supply voltage to linear 
modulator, the multilevel/multiphase modulator should operate at a sufficiently 
high switching frequency.
One excellent embodiment of the serial hybrid is shown in Figure 4.31 with a 
multilevel modulator connected a linear voltage regulator in series. The envelope 
reference signal is reproduced and sent to a multilevel modulator via an ADC and a 
Figure 4.30  Illustration of serial hybrid supply modulator for ET applications. The multilevel/multi-
phase SMPS converter supplies the linear modulator and the linear modulator regulates the desired 
envelope voltage.

160 
��������������������������������������
Supply Modulator for Envelope Tracking
comparator logic controller. Each voltage level is activated if the reference envelope 
signal is greater than a certain threshold value, which is different for each voltage 
level. Consequently, the output voltage of the multilevel modulator will have dis-
crete levels. The number of levels depends on the number of independent voltage 
sources used or the number of voltage cells implemented. Each switch in the mul-
tilevel modulator switches at the maximum frequency component of the envelope 
reference signal. The dynamics of the multilevel modulator depends only on the 
speed of the diodes and MOSFETs used in the switches and cells.
At the same time, the same reference envelope signal enters the second stage of 
a linear modulator via a delay line unit for synchronization. The linear modulator 
input reference has to be synchronized with the output voltage of the multilevel 
modulator to assure that the supply modulator system output voltage will always 
be lower than the output voltage of the multilevel modulator, and therefore, repro-
duced correctly. Due to the finite time to switch MOSFETs on and off, the output 
voltages of the multilevel modulator are delayed compared to the input envelope 
reference thus a delay line must be introduced to compensate for the delay be-
tween the supply voltage and input envelope reference for the linear modulator. 
To achieve a high bandwidth of the linear modulator, it is necessary to use a high 
bandwidth OPAMP in the feedback loop. Also, a power MOSFET with low para-
sitic capacitance between the gate and source can be used as a pass element of the 
linear modulator.
4.4.1.1  Discrete Stage Efficiency
In Figure 4.31, the losses in the multilevel modulator are due to the conduction 
and switching losses of MOSFETs and diodes in circuitry. Conduction losses de-
pend on the selection of switching devices, while the switching losses depend on 
Figure 4.31  Illustration of exemplary serial hybrid architecture with stacked cells multilevel modula-
tor in conjunction of a linear modulator for the ET applications.

4.4  Hybrid Supply Modulator 
161
the MOSFETs’ characteristics and supply voltage of the multilevel cell stacked in a 
voltage divider. Because of the increased number of multilevel cells and the higher 
conduction losses, consequently, a compromise between the conduction and switch-
ing losses has to be considered.
4.4.1.2  Linear Stage Efficiency 
Because the linear modulator is supplied from the multilevel modulator, its effi-
ciency varies and depends on the actual voltage level at its input and output. Note 
that the selection of voltages for multilevel modulator should be carried out and 
considered with the average efficiency. Average efficiency is calculated in terms of 
the distribution of the density of the probability of the envelope. By optimizing the 
voltage levels in this way, the average efficiency can be improved by comparing with 
the common and equidistant voltage levels.
However, two stages are required to produce the high bandwidth variable sup-
ply voltage with the disadvantages of a reduction in the modulator efficiency and 
an increase in circuitry complexity. The number of voltage levels of the modulator 
has to be determined in reference to several design considerations. First, the effi-
ciency of the linear modulator is the most important factor as the main advantage 
of the serial hybrid architecture is to reduce the losses in this stage. Second, overall 
efficiency of the serial hybrid supply modulator with more voltage levels implies 
better efficiency on the linear modulator but more power losses on the multilevel 
modulator as a result of more cells and voltage input sources. Third, because cir-
cuitry complexity and size increase with the number of voltage levels, the number 
should be optimized performance trade-off. Finally, as the number of voltage levels 
rise, parasitic components of the layout become critical at high frequencies, limit-
ing broadband applications.
4.4.1.3  Optimization for Number of Levels
To optimize the efficiency of the linear modulator, it is necessary to make a proper 
decision about the number of voltage levels, which should be generated by the mul-
tilevel modulator. As described in [74], with the information on the density of the 
probability of the envelope signal, it is possible to calculate the average efficiency 
of the serial hybrid modulator. Figure 4.32 shows the entire supply modulator ef-
ficiency when the various number of voltage levels are applied.
Although common sense dictates the need for a large number of voltage levels, 
it is necessary to make a compromise between the ideal efficiency and the feasible 
number of the desired multilevel modulator. The theoretical and experimental re-
sults in [75] show the number of voltage levels that should be applied is between 
three and six .The main reason for this is that in a higher number of voltage levels, 
the amount of parasitic components, switching losses, and noise would increase 
and lead to the deterioration of the quality of the output and overall efficiency.
4.4.2  Parallel Hybrid
Parallel combinations of linear and SMPS modulator can be a further option of hy-
brid modulator. Parallel hybrid modulator consists of a linear modulator to control 

162 
��������������������������������������
Supply Modulator for Envelope Tracking
an SMPS modulator stage via sensed envelope signal, as shown in Figure 4.33 with 
the linear modulator and SMPS stage in a loop. The feedback mechanism of a cur-
rent sensor circuit tries to minimize the current supplied or absorbed by the linear 
modulator. In this way, the SMPS part tracks the low frequency part of the envelope 
containing most of energy. In addition, the linear modulator provides the missing 
high-frequency current and corrects the switching noise accordingly.
Because SMPS alone fails to provide sufficiently high slew rate for ET applica-
tion, the increase in slew rate can be achieved by combining the use of the SMPS 
Figure 4.32  Serial hybrid supply modulator efficiencies versus number of voltage levels in multilevel 
supply modulator.
Figure 4.33  Illustration of parallel hybrid supply modulator for ET applications. The linear modula-
tor has the principal task to correct and aid the current generated by the SMPS to have the proper 
signal at the output of supply modulator. 

4.4  Hybrid Supply Modulator 
163
with a linear modulator stage in parallel, thus establishing a trade-off between slew 
rate and overall efficiency. This trade-off is based on the fact that the linear modu-
lator operates on the fast transients where the SMPS stage cannot behave properly. 
As previously mentioned, the main body of the envelope in many communication 
signals is placed in the lowermost part of the spectrum. Therefore, a highly efficient 
SMPS reproduces most of the power when placed at the lowest frequencies. Al-
though the linear modulator has relatively low efficiency, because it only processes 
a minor share of power, the overall efficiency can remain high. Although the con-
cept of parallel hybrid has been developed in many varieties, the high efficiency of 
SMPS still partly provides most of the current needed for the load.
4.4.2.1  Classical Parallel Hybrid 
A classical parallel hybrid supply modulator design uses a combination of linear 
amplifier and a buck switcher to produce high-frequency and low-frequency com-
ponents. The notion of split-band separates the desired signal into two frequency 
components, using analog/digital control of either the SMPS or linear modulator 
blocks. A simplified diagram of classical parallel hybrid supply modulator is shown 
in Figure 4.34. It has a master-slave architecture that employs a wideband linear 
class-AB/B amplifier and a high-efficiency buck switcher. For them to work to-
gether, a connection stage is needed, which can be obtained with a current sensing 
Figure 4.34  Illustration of classical parallel hybrid supply modulator circuit, which combines the 
high efficiency of a buck switcher with a wideband linear modulator in parallel. The linear modula-
tor is driven by the input envelope signal and the buck is controlled by the changes in the detector 
giving the voltage and current required by the RF PA.

164 
��������������������������������������
Supply Modulator for Envelope Tracking
stage and a hysteresis comparator that will control the buck switcher as required, 
as shown in Figure 4.34. 
The linear modulator is essentially the class-AB/B push-pull or totem-pole am-
plifier including a pull-down sink transistor to ground for a fast downward volt-
age swings. By properly adjusting the threshold of the hysteresis, only the highest 
peaks of envelope amplitude trigger the switcher output transitions. Therefore, 
the hysteresis comparator generates a pulse width and frequency modulated con-
trol signal for driving the buck switcher from the output of the linear amplifier. 
Frequently, wide pulses result in an increase of the buck switcher output voltage, 
replicating the underlying low-frequency components of the envelope on which the 
high-frequency peaks are superposed.
4.4.2.2  Parallel Hybrid Behaviors
For most of the current to the load through the buck switcher, the pulse width 
modulation (PWM) or pulse frequency modulation (PFM) with a high switching 
frequency that can be employed to deliver at five to ten times of the signal band-
width. This topology provides a very high efficiency, but the bandwidth of the linear 
modulator should cover the switching frequency to compensate for the ripple of the 
buck switcher. Depending on the implementation, the buck switcher can be efficient 
more than 90%, while the linear modulator is only 40% to 60% efficient. There-
fore, high-frequency content is produced is much less efficient than low-frequency 
content. Fortunately, greater than 90% of WCDMA and LTE-A envelope energy 
is concentrated within a signal bandwidth and can be reproduced by an efficient 
buck-switching regulator. Therefore, this topology is very suitable for the envelope 
signal of modern communications, with most power in the low-frequency range. In 
this configuration, the buck switcher opens and closes the MOFEST power switch, 
ramping the inductor current up and down in an effort to minimize the current that 
must be supplied by the linear modulator. The buck switcher is slow to respond to a 
narrow bandwidth in the order of several hundred kilohertz, and the linear modula-
tor has a very high bandwidth ranging up to even greater than 100 MHz. The buck 
generates the content of the signal within the useful bandwidth very efficiently, 
while the linear modulator contribution provides the difference between the desired 
output and the buck output. Hence, the more the bandwidth of buck switcher in-
creases, the less the low-efficiency linear modulator correction is required for the 
desired output waveform. However, a high-bandwidth buck switcher design also 
results in reduced switcher efficiency; the optimal design of a parallel hybrid supply 
modulator requires a careful examination of these compromises.
The class-AB/B linear amplifier operates as an independent voltage source 
throughout the feedback network, while the buck switcher operates as a dependent 
current source. By detecting the current polarity at the output of the linear ampli-
fier, the state of the buck switcher is changed through the hysteresis comparator. 
Thus, much of the current required to the RF PA is supplied by the efficient buck 
switcher and additional current is provided by the linear modulator. Because the re-
sidual current from the buck switcher can be sunk by the linear amplifier, the over-
all modulator can provide linear and efficient supply voltage and current to the RF 

4.4  Hybrid Supply Modulator 
165
PA. The buck switcher and the linear amplifier are coordinated by the use of a cur-
rent sense hysteretic control. The hysteresis controller can absorb and spread out 
in frequency the switching noise introduced in the buck switcher, and the noise can 
be further attenuated by a feedback loop filter within the linear amplifier so that 
the disturbances introduced by the buck switcher can be minimized at the output 
of the supply modulator. The parallel hybrid modulator itself can operate optimally 
for the signals with various PAPR. For the signal having a different bandwidth, the 
switching speed can be optimized by controlling the reference voltage of a hyster-
esis comparator. Thus, for the different signal standards with various bandwidths 
and PAPRs, the parallel hybrid topology is capable to efficiently provide power to 
the RF PA. Therefore, the capabilities of parallel hybrid depend on the efficiency of 
the buck and proportionally related to its switching frequency and the bandwidth 
of the linear amplifier.
Figure 4.34 shows the conventional parallel hybrid topology with RF PA model 
as a resistance load. This circuit has five parameters: supply voltage Vsm, load re-
sistance Rsm, current sense resistance Rsens, inductance Lout, and the width of the 
hysteresis hcomp. The system specifications will determine the values of the supply 
voltage Vsm and the load resistance Rsm. The sense resistance value Rsens is chosen 
much smaller than the load resistance Rsm. Therefore, the circuit designer can only 
determine the values of the inductance Lout and the width of the hysteresis band 
hcomp for performance optimization. 
If there is input for a signal, linear amplifier provides the current to the load 
resistance. The voltage across the sensing resistor terminals increases so that trig-
gers the comparator to switch on the power MOSFET. Then the inductor current 
gradually increases and the linear amplifier output current decreases. The voltage 
across the sense resistor will decrease until the comparator switches off the power 
MOSFET. Then the current in the inductor will gradually decrease and accordingly 
the linear amplifier output current will increase to make up the output current. 
These operations are repeated. The hysteresis band hcomp determines the interval 
between switch-on and switch-off points. The larger the hysteresis band, the lon-
ger the switching interval. Also, the larger the inductor, the longer the switching 
interval presents. Therefore, the switching frequency is inversely proportional to 
both the inductance Lout and the value of the hysteresis band hcomp. Therefore, a 
combination buck switcher with a linear amplifier allows an on-demand approach 
to the supply voltage that can be used to provide a meaningful reduction to both 
power and heat.
The choice of values for inductors buck switcher depends primarily on the 
envelope bandwidth and the power dissipated in the linear modulator. If the induc-
tance is large, the buck switcher cannot drive a large current at higher frequencies 
that require linear modulator to deliver the remaining energy, which leads to a 
higher power dissipation. However, a small value of inductance indeed increases 
the bandwidth, but it also increases the switching frequency, which in turn may 
decrease the efficiency by increasing the switching speed.
Theoretically, it is desirable to provide as much power as possible to the load 
resistance from the buck switcher. Setting a small inductor to increase the band-
width of the buck switcher will increase the switching frequency. Setting a smaller 

166 
��������������������������������������
Supply Modulator for Envelope Tracking
hysteresis band to increase the efficiency also increase the switching frequency. 
Therefore, to fix the switching frequency to the maximum value determined by 
both comparator and power MOSFET characteristics, a value of the product of 
the inductance and hysteresis band can be obtained as a constant value. In classic 
parallel hybrid circuit, because there is a trade-off between efficiency and band-
width, the optimum values of the inductance and hysteresis band should be well 
chosen. The efficiency of the parallel hybrid supply modulator is maximized when 
the average slope of the input envelope signal is equal to the output current slope 
of the buck switcher. With optimization of the circuit parameters, under sinusoid 
stimulus to keep duty cycle D constant for calculation, the optimum inductance 
can be given by
	
(
)
(
)
_
2
1
out
sw
DC
sm
sw
L
D V
R
V
t
=
⋅
−
⋅
⋅
∆
∆	
(4.25)
where cycle Vsw_DC is the DC component of switcher output voltage, Rsm is the load 
resistance, and 
sw
V
t
∆
∆ is the average output signal slope of switcher. Because all 
of the right terms can be obtained, the optimum inductance values can be estimated 
accordingly. In addition, under sinusoid stimulus, the switching frequency fsw can 
be given by 
	
(
) (
)
(
)
(
)
2
_
_
1
sm
sens
out
DC
comp
sw
RMS
sw
DC
f
R
L
V
h
D
D V
V
=
⋅
⋅
⋅
−
⋅
	
(4.26)
where Vsw_RMS is the root mean squared (RMS) voltage of the output signal of 
switcher. Because the terms on the right side except the hysteresis band hcomp are 
known, it can be concluded that the hysteresis band value hcomp is decided by the 
maximum switching frequency. 
The buck switcher designed can be very efficient at operations with a switching 
frequency of 1 to 5 MHz with an efficiency of more than 90%, mainly dependent 
on the switching transistor on resistance. The current generated under these condi-
tions will have a ripple of high voltage and then the linear amplifier will actively 
correct it so that it increases the losses in the supply modulator. In this case, the 
power loss in the linear amplifier is directly related to the difference between the 
DC power given by the buck switcher and the power used by the output signal.
The most important power loss problem stems from the nature of the buck 
switcher providing the majority of the energy at low frequencies and the linear am-
plifier providing the energy at high frequencies. If a fast signal requires higher than 
the power given by the buck switcher, it will be given by the linear amplifier. If the 
power from the buck switcher must exceed the required power, the linear amplifier 
has to sink the remaining power. Therefore, the main power losses are attributed 
to the linear amplifier.
Typically, for the parallel hybrid supply modulator, the buck switcher power 
dissipation consists of conduction losses, commutation loss, and driver loss. With 
typical high-PAPR signals, the efficiency of over the 90% level has been assigned 
to buck switcher because majority occurs at the low-frequency component. For the 
wider bandwidth signals, such as LTE-A, it is expected that the switcher power loss 
put significant effects on the overall efficiency because the low-frequency compo-
nent also increase with the signal bandwidth.

4.4  Hybrid Supply Modulator 
167
4.4.2.3  Dynamic Properties
The buck switcher provides high efficient current to the parallel hybrid supply mod-
ulator. It is controlled by the detection of the linear modulator output current and 
follows the average voltage of the envelope. 
The buck switcher is responsible for most of the current supplied to RF PA. It 
will try to track the average current of the envelope signal. The switching frequency 
determines the ability of tracking large changes in the signal; in other words, fast 
slew rate changes, and thus improves the overall system efficiency.
Regulating the voltage in the common SMPS is determined by the duty cycle of 
a digital signal with PFM and PWM or any other pulse source. The average voltage 
can be given by
	
( )
_
sw
av
sw
s
DC
V
V
t dt T
D V
=
=
⋅
∫
	
(4.27)
where D is the duty cycle and is determined by the time the pulse is active, Ts is the 
period of the pulse signal where 1/Ts equals the switching frequency fsw, and VDC is 
the fixed DC supply voltage. The integral equals the supply voltage times the duty 
cycle; in other words, the average voltage supplied is directly related to the duty 
cycle and the switching frequency. 
If duty cycle D is now considered to vary with time as D(t), the regulated volt-
age can follow a time-varying signal, in this case the envelope signal desired to 
amplify. Considering now the envelope signal as the dominant factor, the output 
voltage Vsw can be assumed to be composed by a DC component Vsw_DC and an AC 
component as Vsw_AC giving the new duty cycle as
	
( )
(
)
_
_
sw
DC
sw
AC
DC
D t
V
V
V
=
+
	
(4.28)
To determine the control of the switching frequency in the parallel hybrid sup-
ply modulator, a sense resistor Rsens is used. It determines the flow of current from 
the buck switcher, where the excess or lack of current has to be equaled to the 
envelope signal. Together with the hysteresis hcomp of the comparator used to detect 
this current variation, the inductance value Lout and the duty cycle in time D(t) will 
determine the switching frequency as given by (4.29) in [77] as 
	
( )
(
)
(
)
(
)
( )
( )
(
)
2
1
sw
sens
out
DC
comp
f
t
R
L
V
h
D t
D t
=
⋅
⋅
⋅
⋅
−
	
(4.29)
For a simple analysis, a simplified ideal model [78], shown in Figure 4.35, is 
used to express the functions of the linear amplifier and the buck switcher.
Figure 4.35  Illustration of model for parallel hybrid supply modulator circuit. (From: [11]. © 2006 
IEEE. Reprinted with permission.)

168 
��������������������������������������
Supply Modulator for Envelope Tracking
The current supplied to the RF PA will follow (4.30), which determines the 
power dissipation of supply modulator.
	
( )
( )
( )
( )
( )
( )
(
)
( )
sm
sm
sm
lin
sw
sw
sm
sens
sw
I
t
V
t
R
i
t
i
t
V
t
V
t
R
i
t
=
=
+
=
−
+
	
(4.30)
where ilin(t) is the current supplied by the linear amplifier at high-frequency com-
ponents. The load is assumed to be purely resistive, considering that most of the 
power consumed by an RF PA is mostly in its resistive part. For practical reasons, 
the calculation is also limited to the resistive load. 
In a general SMPS, the change to a low switching frequency induces a large 
ripple because the cutoff frequency of the output LC filter is fixed. The parallel 
hybrid replaces the capacitor with the class-AB/B linear amplifier having a reverse 
frequency response compared to the capacitor. That is, the output impedance of the 
linear amplifier is smaller at a lower frequency, and this allows the control of the 
switching frequency with acceptable output voltage ripple.
However, the current sense hysteresis control introduces delay in the buck 
switcher, which affects the output current response. Moreover, the response of a 
high-efficiency buck switcher is typically much slower than the signals of interest. 
The buck switcher itself introduces additional delay and causes nonideal effects 
in the hysteresis loop. Although the overall delay has no effect on the accuracy of 
output, because the output signal is conditioned by a linear modulator, the delay 
encountered with high-PAPR and broadband signals results in the linear modulator 
has to provide additional power to the output, thereby decreasing the efficiency.
4.4.2.4  Load Dependency and Nonlinearities
The buck switcher is the most affected as the average current is inversely propor-
tional to the load resistance of the circuit. It has to be considered that the current 
can be increased in a low-resistivity condition and reduced in a high load resistance. 
However, the linear modulator could be highly influenced the capacitance of the 
load.
To investigate how the load is shared between buck switcher and linear am-
plifier, it is helpful to examine the spectral energy distribution of the envelope. 
The power spectrum of the envelope for a typical WCDMA and LTE-A signal 
indicates that most of the power resides in the DC component and low-frequency 
end, around several hundreds of kilohertz of the spectrum. It is therefore logical to 
partition the load power on the spectral power distribution of the envelope signal 
as the majority of the load is handled efficiently by buck switcher, where the high-
frequency components can be treated by the linear amplifier without compromis-
ing overall efficiency.
The parallel hybrid supply modulator will see the RF PA as a varying load. 
This means that the drain/collector impedances of the RF PA would influence the 
current supplied by the supply modulator. The modulator load impedance varies 
in a wide range in response to the RF signal passing through the PA. By empirical 
knowledge, the drain/collector impedance will be low when it is active, so a typical 
range is assumed that they may vary from 1 to 100Ω. A more detailed discussion 
can be made via the ET PA measurements in Chapter 7.

4.4  Hybrid Supply Modulator 
169
The nonlinear responses of the parallel hybrid modulator can be described in 
the amplitude and phase distortion. The amplitude distortions can be produced 
by the nonlinear error of the linear modulator when correcting and tracking the 
envelope signal with limited slew rate and bandwidth. Similarly, the phase distor-
tion and group delay will depend on the ability of tracking the various frequency 
components of the envelope signal.
The conversion delay is the time to pass through the supply modulator. It main-
ly dependent on the linear amplifier as it goes straight from the input envelope 
via the linear amplifier to the load. However, the buck switcher also introduces 
propagation delays by power MOSFET, drivers, and the comparator, causing tim-
ing mismatch for parallel combination. The disadvantages of the classical parallel 
hybrid topology would become obvious if the buck switcher was pushed to operate 
at a high frequency, typically greater than 10 MHz; therefore, it will be much less 
efficient. Moreover, it is difficult to optimize the actual switching timing alignment 
with linear amplifier to maximize overall efficiency for broadband applications.
4.4.3  AET Hybrid
In addition to the classic parallel hybrid topology, there is a simpler variant tech-
nique referred to as auxiliary envelope tracking (AET) [88–91]. However, I suggest 
adding current sink transistor in the linear modulator part. Therefore, the AET 
mentioned here can be either push-pull or totem-pole linear amplifiers discussed 
above instead of a source follower for the sake of improving immunity for varying 
load conditions. The main feature of this technique is the separation of the DC and 
AC components of the tracking supply signal. It allows a very simple and low-cost 
modulator design that consists of a linear modulator, an RF broadband transformer 
or diplexer as combiner shown in Figure 4.36. Therefore, the focus of the AET is on 
the simple circuit and low-cost solution for ET applications.
The basic difference between the classic parallel hybrid topology and the AET 
is the mechanism for generating the modulated supply. In this mechanism, the gen-
eration of DC and AC supply components of the AET signal is initially separated. 
It can provide a useful improvement in the overall efficiency and enable a very 
simple design for the supply modulator. The distinguishing features are generating 
the tracking supply signal in an inexpensive and compact way.
In the AET system, the envelope signal is directly input to the linear modulator 
as shown in Figure 4.36, where some amplification is performed. The output of the 
linear modulator is the supply source of the AC component that is subsequently 
injected into the combiner. The DC component of the AET comes directly from an 
external DC power supply so that there is no need to consider any SMPS related 
compromises and challenges, especially the efficiency issue. The conjunction of 
both AC and DC supply components at the combiner results in the AET signal be-
ing able to bias the drain/collector of the RF PA. The reduced power consumption 
in AET system comes from the use of a small DC power supply value for generating 
the AC component in a linear modulator and a lower DC component with an ap-
proximate root mean squared (RMS) value of final output voltage. In comparison, 
in the classic parallel hybrid system, as shown in Figure 4.34, both DC and AC 
components of supply bias are generated as a single entity and are produced by a 
single fixed DC power supply. 

170 
��������������������������������������
Supply Modulator for Envelope Tracking
In the classic parallel hybrid topology, the power loss of supply modulator is 
critical. However, in the AET technique, supply modulator design requirement is 
alleviated by separating the AC component of the ET supply from the DC com-
ponent. The separately generated AC component is superimposed on a fixed RMS 
DC bias supplied to the drain/collector of RF PA. Because the AC component of 
the tracking power is much smaller than the DC component, the total power con-
sumption of the AC component will be relatively small. It can be seen that the ef-
ficiency of the AET PA system is less dependent on the supply modulator efficiency, 
compared with the classical parallel hybrid topology. In practice, the AET concept 
of separating the DC and AC components of the power supplied to the RF PA leads 
to the simple design of the supply modulator, consisting of only a linear modulator 
and an RF broadband transformer, as shown in Figure 4.37. 
As shown in Figure 4.37, the envelope signal is applied to the linear modulator. 
The output of this linear modulator is then connected to the primary side of the 
transformer RF for a 1:N voltage transformation. On the secondary winding, the 
output of the AET modulator is connected to the drain/collector of the RF PA with 
DC component combined from an external fixed DC supply.
The supply modulator for AET can be simply a linear class-AB/B push-pull 
amplifier. The class-AB/B push-pull configuration is selected to obtain a low output 
impedance in the envelope frequencies. For AET, the focus is on the integration of 
the linear modulator and the combiner. Because the AET is largely insensitive to 
distortion in the tracking supply quality at higher envelope frequencies that have 
low statistical occurrence, the RF transformer is very suitable for high-PAPR signal 
application scenarios.
The combiner can be a 1:N RF broadband transformer with N typically rang-
ing from 2 to 10. The transformer combiner is selected by its simple design and 
Figure 4.36  Illustrations of AET system building blocks with a combiner to sum the DC and AC 
supply components together.

4.4  Hybrid Supply Modulator 
171
versatility. In addition to the main ability to transform different levels of voltage 
and current in AC component circuits, the transformer also provides the electrical 
isolation between primary and secondary winding circuits for AC and DC com-
ponents insulation. This electrical isolation is necessary to ensure that the linear 
modulator cannot be affected by changes in the load impedance when connected to 
the drain/collector of RF PA. The transformer versatility of phasing connection also 
makes it easily connected to the desired circuit without complications to maintain 
the signal phase. Finally, the transformer has also provided an important advantage 
in the AET system in terms of efficiency. For a typical signal with PAPR in the range 
of 6 to 11 dB, the transformer can be designed to have a voltage transformation 
ratio of 1:2 so that the AC component of the supply voltage will have a ratio of 
1:2 between the primary and secondary windings. In this case, when the required 
supply voltage to the drain/collector of the RF PA is Vsm, then only the Vsm/2 out-
put voltage is to be produced by the linear modulator. Therefore, the requirement 
to produce the AC component of supply voltage from the linear modulator can be 
relaxed by the step-up transformer voltage transformation, while both primary and 
secondary windings are electrically isolated. Because the transformer should handle 
the wide bandwidth signal, a high permeability ferrite core should be selected for 
the transformer with broadband performance. The transformer can be designed 
with a bifilar or trifilar wound using two or three copper wires for broadband 
performance. 
4.4.4  CCG Hybrid
As a further variant of the parallel hybrid supply modulator, unlike the AET to 
separate the DC and AC component of the ET supply, a constant current genera-
Figure 4.37  Illustration of an AET supply modulator that consists of a linear modulator and an RF 
transformer combiner for electrical isolation, which is a significant advantage to ensure that the linear 
modulator circuit not affected by varying load phenomena in ET applications. (From: [90]. © 2011 
IEEE. Reprinted with permission.)

172 
��������������������������������������
Supply Modulator for Envelope Tracking
tor (CCG) hybrid can be chosen to separate voltage and current components for 
benefits.
The CCG hybrid replaces the buck switcher by a constant current generator 
as an aid to linear modulator to enhance overall efficiency [92]. In particular, it is 
possible to incorporate the current recycling techniques for power reuse within a 
supply modulator for efficiency enhancement. The CCG hybrid has been improved 
from the design of the parallel hybrid to solve the difficulties of the buck switcher 
for wideband applications. The concept is if the high-efficiency buck switcher can 
no longer follow most of the high slew rate load current in wideband scenarios, it 
can be replaced by a quasi-constant current generator. A linear modulator can also 
be employed to the source and sink of the error current to the load, thereby coor-
dinating with the CCG unit. To avoid the sinking current in linear part becoming 
a wasted power and an efficiency reduction factor, current recycling scheme can be 
employed so that the sinking current is recycled to the CCG unit and is utilized for 
RF PA amplification again.
A CCG hybrid consists of a linear voltage modulator and at least one CCG 
unit, which are configured to provide the supply to the RF PA. The CCG can pro-
vide the largest share or the average constant current required from RF PA. The lin-
ear modulator corrects the current to the target value by sourcing and sinking the 
residue current ignored by CCG. Additionally, there is a recycle circuit is placed be-
tween the linear modulator and the CCG for sinking current reutilization. The cur-
rent sunk by the linear modulator can be recycled as IREC and utilized as part of the 
current going to CCG. In this way, the CCG is capable to deliver constant current 
at a higher efficiency without the bandwidth requirements. It prevents the switcher 
delay compensation difficulties suffered in the classical parallel hybrid modulator. 
By virtue of this, all the possible rapid voltage changes, timing mismatch, and cou-
plings between different energy sources for the supply modulator can be avoided, 
which are regarded as major drawbacks in a classical parallel hybrid with a current 
sensor and buck switcher. However, the improvement of the efficiency is achieved 
in the CCG hybrid by connecting the negative supply of the linear modulator with 
a positive voltage, but this requires lower than the minimum output voltage of the 
supply modulator.
The linear modulator plays a more significant role to compensate for the dif-
ference between a CCG output current and the desired value. The linear modulator 
controls the supply voltage fed to the RF PA. The CCG will, in turn, feed the aver-
age constant current to the RF PA. Some of the high-frequency current required 
from RF PA originates from the linear modulator as a compensation of CCG out-
put. The current that CCG feeds to the RF PA can either be unvarying constant 
current or low-frequency current according to the envelope profile. The CCG must 
provide a suitable control mechanism, which follows the signal characteristic.
The typical feature of CCG hybrid is that recycling circuit receives the op-
erational redundant current in case that the power provided exceeds the power 
demanded by an RF PA. The recycling circuit can transfer the received sink cur-
rent from linear modulator to the CCG for reuse. The recycling circuit typically 
comprises a conductor circuitry through which the current to be recycled can be 
transferred for use in CCG. The conductor can be connected to a pole by which 

4.4  Hybrid Supply Modulator 
173
operational power is fed from the power source PSCCG to the CCG. In that case, 
the power from the PSCCG is reduced with the amount equal to the recycled cur-
rent IREC. Hence, the relationship between CCG output current ICCG and the PSCCG 
output current IPS can be expressed as
	
CCG
REC
PS
I
Const
I
I
≡
=
+
	
(4.31)
This arrangement reduces the power loss of the sinking transistor of the linear 
modulator and sinking current can be recycled back into the CCG. In CCG hybrid 
topology, the linear modulator is capable to provide sufficient bandwidth and cur-
rent output capability with a low output impedance. However, the output imped-
ance of the CCG is high on a wide frequency band. The CCG can be implemented 
by means of a chopper current source. In the case of high modulation frequencies, 
it is possible to provide series inductance at the output of CCG so that the induc-
tance can form a high impedance at high frequencies, as shown in Figure 4.38.
However, the disadvantages of the CCG hybrid are that there is a minimum 
value allowed for the envelope and it cannot be set too low; otherwise, the recy-
cling process is not convenient. The CCG unit is actually much more complicated 
than it seems due to the necessity to follow the signal average power in time involv-
ing very complex control mechanism. For a Si-LDMOS RF PA, it is possible to 
lower the drain voltage to almost zero under ET operation. Therefore, the recycling 
process may not be so efficient because it requires the recycling power source volt-
age to be lower than the minimum output voltage of the supply modulator [66].
Figure 4.38  Illustration of a constant current generator for a hybrid parallel with a current recycling 
scheme for supply modulator efficiency enhancement. (From: [66]. © 2012 IEEE. Reprinted with 
permission.)

174 
��������������������������������������
Supply Modulator for Envelope Tracking
4.4.5  Power DAC Hybrid
There is also another ideal variant of the parallel hybrid topology with an emphasis 
on improvements in the linear modulator part, which has replaced the continuous 
linear amplifier by a discrete push-pull power DAC (see Figure 4.39) [93]. 
The main difference to the classical parallel hybrid system is replacing the class-
AB/B amplifier with a linear push-pull power DAC that can be controlled more ac-
curately and keep the pace with the buck switcher to minimize the impact of timing 
misalignment between linear modulator and switcher part. Therefore, the advan-
tage of power DAC is that it eliminates the difficulties suffered from classic hybrid 
topology. As discussed earlier, a delay mismatch between the outputs of the buck 
switcher and class-AB/B amplifier can occur naturally and become severe with a 
wider modulation bandwidth. In addition, traditional techniques for compensation 
or further minimize the delay would increase design complexity and set extremely 
high-performance requirements for the key components used.
In power DAC hybrid topology, the power DAC module includes a push-DAC 
and a pull-DAC. The push-DAC is configured to increase the supply voltage, when 
the envelope rises and the pull-DAC is configured to reduce the supply voltage 
when the envelope falls. The DAC cells are designed with the same principle as 
discussed in Section 4.23. Therefore, the push-pull DAC hybrid system also in-
cludes a thermometer decoder is configured to receive the envelope signal in digital 
form and decode the envelope signal to generate a plurality of control signals to 
the push-pull DAC. As shown in Figure 4.19, the push-DAC includes a plurality 
of PMOS current sources. The majority of PMOS current source are arranged be-
tween the fixed DC supply voltage VDC and the RF PA power supply Vsm. Accord-
ingly, the pull-DAC comprises a plurality of NMOS current sink. The plurality of 
NMOS current sink is arranged between the RF PA power supply voltage Vsm and a 
low supply voltage VL. The gates of the plurality of PMOS and NMOS can be trig-
Figure 4.39  Illustration of push-pull power DAC hybrid supply modulator.

4.4  Hybrid Supply Modulator 
175
gered by control signals, respectively. Typically, a number of the plurality of PMOS 
and NMOS are selected to be each in range of 16 to 128 [93].
The push-pull DAC can convert the fixed DC voltage to the supply voltage at 
the highest frequency component rate of the envelope signal. The push-pull DAC 
can be flexibly controlled by using digital signals for special functions in ET such as 
filtering, envelope shaping function, and timing alignment. The use of a combina-
tion with a buck switcher and the push-pull DAC can improve the overall energy 
efficiency of the supply modulator for broadband applications. It also reduces the 
difficulties relative to classical parallel hybrid, which usually requires an analog 
current sensor, comparator, and analog delay element for output timing alignment 
between branches.
To assist in improving output noise of the push-pull DAC, a thermometer de-
coder can be used to convert the digital shaped binary coded envelope signal into a 
thermometer decoded signal. Converting the signal in this way can assist in reduc-
ing switching noise and glitches generated from the push-pull DAC, especially the 
scenario with most significant bit (MSB) changes. However, the more bits required 
the more complex the push-pull DAC becomes with full thermometer decoding 
manner. Therefore, for high-bit applications, the segmented push-pull DAC com-
bining both thermometer and binary decoding can make a decent trade-off be-
tween switching noise and circuitry complexity as shown in Figure 4.19. Note that 
binary decoding is typically arranged on least significant bits (LSB) to minimize the 
switching glitches impact of the overall push-pull DAC.
The push-DAC can increase Vsm when the envelope indicates that the output 
from the buck switcher should be increased. Similarly, the pull-DAC can decrease 
Vsm when the envelope indicates that the output from the buck switcher should be 
decreased.
The bandwidth performance of push-pull DAC with thermometer decoding 
control to create the peak and valleys of RF envelopes is lower than class-AB/B 
amplifier for wideband applications. Moreover, high-speed switching will also in-
crease the switching loss and thereafter decrease the efficiency of power DAC.
Finally, output filter for the push-pull DAC should be considered to minimize 
the linearity impact of quantization noise and harmonics of discrete step incre-
ments in voltage to the output of ET PA via supply modulation effect. For filter de-
sign considerations, it is beneficial to refer to the prior discussion in Section 4.3.5.
4.4.6  Parallel Hybrid with Multiswitcher
The multiswitcher hybrid technique was proposed for further increasing the effi-
ciency of the supply modulator while maintaining its broad bandwidth [63, 94–96]. 
The technique uses digital signal processing (DSP) control, analog hysteretic feed-
back, or a connection with both. Several high-efficiency buck switchers are coordi-
nated to provide the broadband envelope power to the RF PA. A wide bandwidth 
linear modulator will also be used at a low power to obtain preserved envelope 
accuracy. 
As discussed, the key problem of the classic parallel hybrid topology is that it 
is optimized only for average input slope value. Its efficiency falls when the aver-
age slope of the envelope reference signal is not equal to the output current slope 
of the buck switcher. The efficiency of the supply modulator drops when the slope 

176 
��������������������������������������
Supply Modulator for Envelope Tracking
of envelope is greater than the slope of output the buck switcher because the linear 
modulator has to offer all the output current. The efficiency of the conventional 
parallel hybrid also decreases when the envelope slope is smaller than the output 
slope of the buck switcher because the hysteresis is greater than the optimum value.
The output voltage of the multiswitcher modulator follows the input envelope 
reference signal with the aid of the linear modulator. The current is supplied to the 
drain/collector of the RF PA from both linear modulator and a plurality of switch-
ers. Some of the switchers can be controlled digitally using DSP according to the 
envelope waveform characteristics. The other switchers employ analog hysteresis 
control that triggers the switches on and off by a comparator sensing the output 
current of linear modulator. Those switchers with analog controls not only pro-
vide power to the RF PA but also correct any possible DC offset generated from 
the switchers with DSP controller. The linear modulator provides the difference 
between the desired output and the output current from the multiple switchers so 
that the overall error is minimized. 
The digitally controlled switchers provide fast response to the output of the 
supply modulator and minimize the high slew rate current required from the linear 
modulator. The overall efficiency of the supply modulator is improved because 
the power loss contribution is reduced from the linear modulator. A plurality of 
switchers can provide major power share of the envelope power to the RF PA and 
the remainder is provided by the linear modulator to ensure the stability and ac-
curacy. It can be observed that this results in increased efficiency because of better 
efficiency at lower input power. This is mainly due to the reduced current sunk by 
the linear modulator.
However, a multiswitcher parallel hybrid as shown in Figure 4.40 uses several 
buck switchers with a hysteresis comparator and DSP control. It can switch from 
single-phase to multiphase operation mode, depending on the envelope slope of 
the input. Suppose that the product of power inductance and a hysteresis band is 
a constant value for a given switching frequency; changing the ratio of the induc-
tance to the hysteresis band for multiphase will cause a slow-phase buck switcher 
with large inductance leading to a high efficiency but low bandwidth. However, a 
fast-phase buck switcher with small inductance has a low efficiency but high band-
width. Therefore, in multiswitcher topology, the buck switcher array senses the 
envelope slope and switches bucks accordingly so that it maintains high efficiency 
over a wide range of input envelope slopes. If the input envelope slope is small, only 
the slow-phase operates. If the envelope slope is too high, then the linear modulator 
delivers more power. Assume that the linear modulator output current exceeds the 
hysteresis threshold value, then both the slow-phase and fast-phase buck switchers 
will operate together.
To address the drawback of the traditional parallel hybrid efficiency degrada-
tion with increasing bandwidth and PAPR, a multiswitcher can be implemented 
with different values of inductance for the switcher to operate at the same output 
power level. The reduced time constant L/R improves the output current band-
width of the switcher to match the slew rate of envelope signal, thereby reducing 
the output current of the linear modulator. Either the DSP or analog control can be 
used for this scheme. However, it is generally more powerful for the DSP to com-
pensate for any possible delays in the analog components such as switcher driver 

4.4  Hybrid Supply Modulator 
177
propagation delay or L/R time constant. In addition, DSP offers a more efficient 
way for the switcher to control signals.
Another scenario for a multiswitcher hybrid is that the buck switcher array 
is replaced by a multilevel/multiphase converter such as MIBuck [62], which was 
discussed in Section 4.3.
As can be seen in Figure 4.41, the linear modulator is arranged in parallel with 
the load but does not control the MIBuck converter. Thus, both stages are indepen-
dent of each other. The other main difference and the important point of this topol-
ogy are the diodes in antiparallel placed between the load and the linear modulator 
as a combiner block. The baseband processing block generates the envelope as a 
reference input.
The essential idea is for the MIBuck and the linear modulator to try to give 
the same voltage to the load according to a common envelope reference input. 
However, the MIBuck has limited slew rate and bandwidth by its lowpass output 
Figure 4.40  Illustration of a multiswitcher hybrid supply modulator controlled by DSP, analog, or a conjunc-
tion of both. It multiplies the switchers in the parallel hybrid with different switching frequencies to improve 
the overall efficiency. This happens because different frequencies will improve the bandwidth of the switching 
stage to thereby reduce the output current from the linear modulator. 

178 
��������������������������������������
Supply Modulator for Envelope Tracking
filter compared to the linear modulator. The output filter is carried out by a power 
inductor and the load. Taking into account its inherent more limited speed, the 
envelope reference can be processed as a slew-rate-limited version as the input for 
MIBuck. The combiner is one of the most important devices in this scheme. It is 
made up of the antiparallel diodes to make a conjunction of the linear modula-
tor and MIBuck. The forward voltage of the diodes determines the error between 
linear modulator output voltage and the output of overall supply modulator. The 
low forward voltage drop over diodes guarantees the accuracy between the desired 
voltage and the actual output. For this reason, Schottky diodes are recommended 
for this application. The voltage drop and the dynamic characteristics of the diodes 
play an important role in the accuracy and efficiency. 
Figure 4.41  Illustration of a multiswitcher hybrid with an MIBuck converter. This is done because using dif-
ferent frequencies will improve the bandwidth of the switching stage, reducing the current sunk by the linear 
modulator and therefore reducing the power loss. (From: [62]. © 2012 IEEE. Reprinted with permission.)

4.4  Hybrid Supply Modulator 
179
4.4.7  Combined Hybrid
A combined hybrid supply modulator is an improved version of hybrid topology 
that combines the serial and parallel hybrid architectures to further enhance the ef-
ficiency of the entire supply modulator, as shown in Figure 4.42. It consists of two 
switching parts and a linear modulator. The first switcher and the linear modula-
tor are parallel-connected to each other to provide broadband and high-efficiency 
operation, while the second switcher is cascaded to feed the linear modulator with 
a bandwidth-reduced variable supply to further reduce power loss by the same 
principle of the previously mentioned serial hybrid topology.
Compared to hybrid parallel topology, the combined hybrid supply modulator 
reduces the power dissipation in the linear modulator through a reduced bandwidth 
envelope power to the linear modulator and thus improves the overall efficiency of 
the supply modulator [97]. Because the linear modulator provides a minor propor-
tion of the total output power to RF PA, the additional switcher, which provides a 
dynamically varying supply to the linear modulator, therefore can achieve a high-
efficiency operation for broadband and high-PAPR signals.
Figure 4.42 shows the simplified block diagram of the combined hybrid supply 
modulator. The SMPS1 switcher and the linear modulator operate in a typical par-
allel hybrid topology, while the SMPS2 switcher provides the reduced bandwidth 
dynamically varying envelope power to the linear modulator in serial hybrid mode 
to minimize the possible linear power loss. Typically, buck topology can be used for 
both SMPS1 and SMPS2, but for SMPS2 it can be replaced by a buck-boost con-
verter. The reduced bandwidth envelope technique offers an additional degree of 
Figure 4.42  Illustration of combined hybrid supply modulator incorporating parallel hybrid in con-
junction together with a serial hybrid.

180 
��������������������������������������
Supply Modulator for Envelope Tracking
freedom in the combined hybrid architecture to maximize the efficiency of SMPS2 
switcher. However, there is a compromise between the bandwidth reduction factor 
and the efficiency of SMPS2 to consider both bandwidth and switching loss. The 
algorithm to generate the reduced bandwidth envelope will be further discussed in 
Chapter 6. The theoretical efficiency curves compared to the output power of the 
combined hybrid and classical parallel hybrid architectures are shown in Figure 
4.43.
As shown in Figure 4.43, compared to a classical parallel hybrid, the introduc-
tion of SMPS2 switcher creates another peak efficiency point of combined hybrid 
to tolerate more output power back-off and reduce efficiency drop-down effect to 
keep high efficiency according to the PDF of the envelope. Hence, the combined hy-
brid architecture can maintain very high efficiency over a much wider power range. 
This increase in efficiency is more prominent for higher-PAPR signals, which are 
most widely used in modern communication systems. This is beneficial because in 
conventional parallel hybrid architecture the SMPS1 switcher provides the major-
ity of the average power and the linear modulator provides the rest of the energy. 
If the PAPR of the signal is increased, the portion of the load power supplied by 
the linear modulator current will increase as well because it provides the high-fre-
quency part of the power, which is increased, in turn, by the increase of the PAPR. 
Therefore, an efficient dynamic supply to linear modulator will definitely further 
improve the efficiency for high-PAPR signals. As shown in Figure 4.43, even for 
a high-PAPR signal, the probability density function (PDF) of an envelope moves 
toward the low output power region, causing more power dissipation in the lin-
ear modulator. However, the PDF of the envelope for the modern communication 
signal like LTE-A is asymmetric, leading to an increased power dissipation in the 
push device compared to the pull device in a push-pull output stage of the linear 
modulator. Furthermore, because the power loss in the push device in a push-pull 
Figure 4.43  Illustration of a theoretical modeled supply modulator efficiency comparison for com-
bined hybrid, classical parallel hybrid, and class-B amplifier with a typical high-PAPR envelope PDF 
versus output power.

4.4  Hybrid Supply Modulator 
181
is the most important factor for the overall loss of the linear modulator, but it can 
decrease when SMPS2 switcher is used. Therefore, assigning a dynamic supply 
modulator for the linear modulator can reduce the stress of the push device and 
further boost the efficiency of linear modulator. In addition, any switching noise 
from SMPS2 will be attenuated by the linear modulator due to its power supply 
rejection ratio (PSRR). 
4.4.8  Nested and Multinested
For a wideband operation of the parallel hybrid supply modulator, the switching 
frequency of the buck switcher should be very high, leading to deterioration of the 
efficiency of the switcher by switching losses. This switching operation efficiency 
may be too high to efficiently provide the power for a high-PAPR signal having a 
rather broad bandwidth. In addition, to compensate for the switching ripple cur-
rent, the bandwidth of the linear modulator must cover the switching frequency so 
that it consumes a large amount of DC power, a further deterioration in the overall 
efficiency.
For more on the benefits of the combined hybrid supply modulator for a 
higher-efficiency target, a further variant of it is the nested supply modulator pro-
posed by the author in [98]. A similar concept of a combined hybrid is shown 
in Figure 4.44, where the nested supply modulator combines the nested structure 
and controlled current source array technology to generate at least three points of 
Figure 4.44  Presentation of a nested supply modulator with controlled current source array, which 
can be seen as another variant of combined hybrid topology, but with continuous serial hybrid and 
multicurrent-source parallel hybrid in conjunction.

182 
��������������������������������������
Supply Modulator for Envelope Tracking
maximum efficiency of the supply modulator in theory. In this way, the modulator 
can tolerate more power back-offs in handling the PDF peak, which is always in 
motion toward a power region with increased PAPR and maintains a high average 
efficiency over a wide range of power. 
As we know, the efficiency of the supply modulator depends on its architecture 
and the nested linear modulator can create another peak efficiency point to avoid 
the efficiency degradation when the modulator output power is backing off for 
high-PAPR scenarios. However, with a similar “creating a peak efficiency point” 
principle applied to multiswitcher topology, a multiple element current source ar-
ray with different hysteresis and inductor values continue to increase the supply 
modulator efficiency by enhancing the capability to tracking high slew rate current.
The ratio between auxiliary supply and fixed DC supply VDC is defined as α, 
0 < α < 1, which decides the position of the second peak efficiency point of linear 
modulator besides the intrinsic one at peak output power, similar to the scenario of 
Figure 4.43. Figure 4.44 shows the nested supply modulator has a current source 
element (CSE) array with N elements: Ics1, Ics2, …, IcsN. In theory, the more CSEs 
in current source array, the better tolerance to higher PAPR for efficiency improve-
ment, although it may not be cost effective with too many CSEs in practice. CSEs 
are changing slowly to track the average current of the envelope signal, so they 
are assumed to be constant for the analysis below. An analysis of the theoretical 
efficiency of the nested hybrid is presented with three CSEs in array as a piecewise 
function of Vsm(t) with the mathematical model discussed in Section 4.1.2.
First, for the nested modulator output current 0 < Ism(t) < Ics1, ���������������
the nested lin-
ear modulator has to sink the current and then the efficiency ηenv(t) of the supply 
modulator is
	
( )
( )
1
sm
env
cs
I
t
t
I
η
=
	
(4.32)
Second, for Ics1 < Ism(t) < (Ics1 + Ics2), the nested modulator switches from a 
high-voltage supply VDC to a lower supply α · VDC for efficiency boosting due to 
low envelope-level amplification. At this time, the modulator efficiency is
	
( )
( )
( )
( )
( )
(
)
1
1
sm
sm
env
sm
cs
DC
sm
cs
V
t
I
t
t
V
t
I
V
I
t
I
η
α
⋅
=
⋅
+
⋅
⋅
−
	
(4.33)
Third, when Ism(t) keeps increasing and enters the range that (Ics1 + Ics2) < Ism(t) 
< (Ics1 +Ics2 + Ics3), more CSEs get involved in the supply modulator to generate 
more peak efficiency points to finally boost the average efficiency. Then the current 
source array will output the sum of CSEs and the modulator efficiency is
	
( )
( )
( )
( ) (
)
( )
(
)
1
2
1
2
sm
sm
env
sm
cs
cs
DC
sm
cs
cs
V
t
I
t
t
V
t
I
I
V
I
t
I
I
η
α
⋅
=
⋅
+
+
⋅
⋅
−
−
	
(4.34)

4.4  Hybrid Supply Modulator 
183
When Ism(t) is in the range in which all three CSEs are fully working and pro-
viding power to the PA, that is, (Ics1 +Ics2 + Ics3) < Ism(t)< 
,
DC
sm
V
R
α⋅
 the modulator 
efficiency is
	
( )
( )
( )
( ) (
)
( )
(
)
1
2
3
1
2
3
sm
sm
env
sm
cs
cs
cs
DC
sm
cs
cs
cs
V
t
I
t
t
V
t
I
I
I
V
I
t
I
I
I
η
α
⋅
=
⋅
+
+
+
⋅
⋅
−
−
−
	
(4.35)
When Ism(t) goes beyond that, all three CSEs are fully working, and the nested 
structure provides another power jump choice that supply voltage from α · VDC to 
VDC, that is, 
( )
,
DC
DC
sm
sm
sm
V
V
I
t
R
R
α⋅
<
<
; then the modulator efficiency is
	
( )
( )
( )
( ) (
)
( )
(
)
η
⋅
=
⋅
+
+
+
⋅
−
−
−
1
2
3
1
2
3
sm
sm
env
sm
cs
cs
cs
DC
sm
cs
cs
cs
V
t
I
t
t
V
t
I
I
I
V
I
t
I
I
I
	
(4.36)
Figure 4.45 shows the instantaneous efficiency curves as a function of the nor-
malized output voltage for various normalized currents of CSE in theory.
From the envelope PDF of a 20-MHz LTE signal, normalized value 0.55 is 
the average in distribution. To cover most power of the envelope, Ics1 is set to 0.2. 
However, efficiency drop-down effect due to serious back-off can be observed from 
the curve of the classical parallel hybrid in the absence of sufficient peak efficiency 
points. By means of nested linear modulation and controlled current source array, 
more peak points are created in theory to maintain high efficiency over the wide 
range of output power. The best efficiency improvement of nested supply modula-
tor can be 14.14% compared to the classical parallel hybrid in Table 4.4.
Figure 4.45  Theoretic instantaneous efficiency curves with various numbers of CSEs compared 
to the classical parallel hybrid supply modulator and a PDF of an LTE 64-QAM, 20-MHz envelope. 
(From: [98]. © 2012 IEEE. Reprinted with permission.)

184 
��������������������������������������
Supply Modulator for Envelope Tracking
Furthermore, multinested structures can be introduced and combined with 
long-term average power tracking as an additional input of the second-order nested 
structures. It means that besides tracking the instantaneous envelope signal, the 
slow changing of the average RF power envelope can also be tracked and modu-
lated as the supply power for the first-order nested modulator in both the linear 
modulator and controlled current source array [99].
As we will discuss in Chapter 6,����������������������������������������������
 the envelope shaping functions are not effec-
tive for the efficiency enhancement. However, the envelope current shaping can 
be effective for efficiency improvement of the supply modulator. Therefore, the 
controlled current source array in a nested supply modulator, with potential for 
efficiency optimized envelope current shaping, coordinates with envelope voltage 
shaping to further enhance the efficiency of supply modulator. 
By means of this scheme of combined fast and slow envelope tracking, the in-
stantaneous supply voltages to RF PA drain/collector are not only correlated with 
instantaneous envelope shape but also the average power of long-term RF levels. 
Therefore, the back-off efficiency boosting capability of envelope tracking is fur-
ther enhanced to the ultrawide dynamic range. It can be employed to realize highly 
efficient power amplification over a flexible power-saving mode in LTE-A applica-
tion scenarios.
Therefore, the most significant feature of a multinested supply modulator is to 
realize fast ET combined with slow average power tracking (APT) simultaneously. 
It further boosts the average efficiency of high-PAPR signal amplification with even 
average output power back-off scenarios as shown in Figure 4.46.
Table 4.4  Theoretical Efficiency Improvement Summary 
Architectures
Number of 
Efficiency Peaks 
Theoretical Efficiency 
Improvement
Classic parallel hybrid
2
0% (Reference)
Nested with one CSE
3
8.44%
Nested with two CSEs
4
12.19%
Nested with three CSEs
5
14.14%
Figure 4.46  Illustration of the RF PA efficiency compared to an average modulated output power 
back-off. Multinested solution provides more tolerance to average power back-off.

4.4  Hybrid Supply Modulator 
185
The slow mode APT is introduced to adjust average output power according 
to wireless traffic profile change as a slow way for ET to compensate the efficiency 
drop by adjusting overall supply voltages with the traffic profile shape. Therefore, 
besides tracking the instantaneous envelope signal, the changing of the average RF 
power envelope can also be tracked, which determines the dynamic range param-
eter in the RF transmitter system and create another dimensional capability for ET 
rather than only the conventional fast ET. By adding another dimension of enve-
lope tracking, the average back-off efficiency can be further enhanced.
References
[1]	
Krauss, H. L., C. W. Bostian, and R. H. Raab, Solid State Radio Engineering, New York: 
Wiley, 1980.
[2]	
Kahn, L. R., “Single Sideband Transmission by Envelope Elimination and Restoration,” 
Proc. IRE, Vol. 40, No. 7, July 1952, pp. 803–806.
[3]	
Raab, F. H., “Intermodulation Distortion in Kahn-Technique Transmitters,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 44, No. 12, December 1996, pp. 
2273–2278.
[4]	
Hanington, G., et al., “High-Efficiency Power Amplifier Using Dynamic Power-Supply 
Voltage for CDMA Applications,” IEEE Transactions on Microwave Theory and Tech-
niques, Vol. 47, No. 8, 1999, pp. 1471–1476.
[5]	
Anderson, D. R., and W. H. Cantrell, “High Efficiency High Level Modulator for Use in 
Dynamic Envelope Tracking CDMA Power Amplifiers,” IEEE MTT-S Digest, 2001, pp. 
1509–1512.
[6]	
Kimball, D., High Efficiency Power Amplifier Research, EER Technique, UC San Diego 
Center for Wireless Communications, March 18, 2003.
[7]	
Choi, J., et al., “Power Amplifiers and Transmitters for Next Generation Mobile Hand-
sets,” Journal of Semiconductor Technology and Science, Vol. 9, No. 4, December 2009, 
pp. 249–256.
[8]	
Marra, T., et al., “Envelope Tracking Efﬁciency Enhancement for CDMA Base-Station 
High Power Ampliﬁer,” IEEE PA Symp. Digest, Vol. 54, No. 11, September 2002, pp. 1–4.
[9]	
Jeong, J., et al., “High-Efﬁciency WCDMA Envelope Tracking Base-station Ampliﬁer Im-
plemented with GaAs HVHBTs,” IEEE Journal of Solid-State Circuits, Vol. 44, No. 10, 
October 2009, pp. 2629–2639.
[10]	
Wang, F., et al., “Design of Wide-Bandwidth Envelope-Tracking Power Ampliﬁers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 4, April 2005, pp. 1244–1255.
[11]	
Wang, F., et al., “An Improved Power-Added Efﬁciency 19-dBm Hybrid Envelope Elimi-
nation and Restoration Power Ampliﬁer for 802.11g WLAN Applications,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 54, No. 12, December 2006, pp. 
4086–4099.
[12]	
Kimball, D., et al., “High-Efﬁciency Envelope Tracking W-CDMA Base-Station Ampliﬁer 
using GAN HFETs,” IEEE Transactions on Microwave Theory and Techniques, Vol. 54, 
No. 11, November 2006, pp. 3848–3856.
[13]	
Reynaert, P., and M. S. J. Steyaert, “A 1.75-GHz Polar Modulated CMOS RF Power 
Ampliﬁer for GSM-EDGE,” IEEE Journal of Solid-State Circuits, Vol. 40, No. 12, Decem-
ber 2005, pp. 2598–2608.
[14]	
Wang, F., et al., “A Monolithic High-Efﬁciency 2.4-GHz 20-dBm SiGe BiCMOS Envelope 
Tracking OFDM Power Ampliﬁer,” IEEE Journal of Solid-State Circuits, Vol. 42, No. 6, 
June 2007, pp. 1271–1281.

186 
��������������������������������������
Supply Modulator for Envelope Tracking
[15]	
Choi, J., et al., “A 45/46/34% PAE Linear Polar Transmitter for EDGE/WCDMA/Mobile 
WiMax,” IEEE MTT-S Intl. Microwave Symposium Digest, Boston, MA, June 2009, pp. 
413–416.
[16]	
Feldman, L., “Class-G High-Efficiency Hi-Fi Amplifier,” Radio-Electronics, August 1976, 
pp. 47–49.
[17]	
Raab, F.H., “Average Efficiency of Class-G Power Amplifiers,” IEEE Transactions on Con-
sumer Electronics, Vol. 22, May 1986, pp. 145–150.
[18]	
Sampei, T., et al., “Highest Efficiency & Super Quality Audio Amplifier Using MOS-Power 
FETs in Class-G,” IEEE Transactions on Consumer Electronics, Vol. 24, August 1978, pp. 
300–303.
[19]	
Buitendijk, P., “A 40W Integrated Car Radio Audio Amplifier,” 1991 IEEE International 
Conference on Consumer Electronics, 1991, pp. 174–175.
[20]	
Maclean, K., et al., “A 610-mW Zero-Overhead Class-G Full-Rate ADSL CO Line Driver,” 
IEEE Journal of Solid-State Circuits, Vol. 38, No. 12, December 2003, pp. 2191–2200.
[21]	
Delano, C. L., “Efficient Narrow Band Amplification Using Linear Amplifier,” U.S. Patent 
Application Publication, No. 2008/0068074, March 20, 2008.
[22]	
Dempsey, D., and C. Gorman, “Digital-to-Analog Converter,” U.S. Patent 5,969,657, Oc-
tober 19, 1999.
[23]	
John, A. S., “An Inherently Monotonic 12 Bit DAC,” IEEE Journal of Solid State Circuits, 
Vol. SC-14, No. 6, December 1979, pp. 904–911.
[24]	
Kester, W., The Data Conversion Handbook, New York: Elsevier/Newnes, 2005.
[25]	
Lin, C. H., and K. Bult, “A 10-b, 500-MSample/s CMOS DAC in 0.6 mm2,” IEEE Journal 
of Solid-State Circuits, Vol. 33, December 1998, pp. 1948–1958. 
[26]	
Bosch, V. D., M. Steyaert, and W. Sansen, “An Accurate Statistical Yield Model for CMOS 
Current-Steering D/A Converters,” Analog Integrated Circuits Signal Processing, Vol. 29, 
2001, pp. 173–180. 
[27]	
Lakshmikumar, K. R., R. A. Hadaway, and M. A. Copeland, “Characterization and Model-
ing of Mismatch in MOS Transistors for Precision Analog Design,” IEEE Journal of Solid-
State Circuits, Vol. SC-21, June 1986, pp. 1057–1066. 
[28]	
Bastos, A., et al., “A 12-Bit Intrinsic Accuracy High-Speed CMOS DAC,” IEEE Journal of 
Solid-State Circuits, Vol. 33, No. 12, December 1998, pp. 1959–1969. 
[29]	
Tiilikainen, M. P., “A 14-Bit 1.8-V 20-mW 1-mm2 CMOS DAC,” IEEE Journal of Solid-
State Circuits, Vol. 36, No. 7, July 2001, pp. 1144–1147.
[30]	
Kassakian, J. G., M. F. Schlecht, and G. C. Verghese, Principles of Power Electronics, Read-
ing, MA: Addison-Wesley, 1991.
[31]	
Bumman, K., M. Junghwan, and K. Ildu, “Efficiently Amplified,” IEEE Microwave Maga-
zine, Vol. 11, No. 5, August 2010, pp. 87–100.
[32]	
Jakobsen, L. T., and M. A. E. Andersen, “Digitally Controlled Envelope Tracking Power 
Supply for an RF Power Amplifier,” INTELEC, Rome, October 2007, pp. 636–642. 
[33]	
Hanington, G., et al., “High-Efficiency Power Amplifier Using Dynamic Power-Supply 
Voltage for CDMA Applications,” IEEE Transactions on Microwave Theory and Tech-
niques, Vol. 47, No. 8, August 1999, pp. 1471–1476.
[34]	
Erickson, R. W., DC-DC Power Converters, New York: Wiley, 1999. 
[35]	
Floyd, T. L., Electronic Devices, 3rd ed., Upper Saddle River, NJ: Prentice Hall, 1991.
[36]	
Choi, J., et al., “A New Power Management IC Architecture for Envelope Tracking Power 
Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, No. 7, July 
2011, pp. 1796–1802.
[37]	
Mathe, L., et al., “Apparatus and Method for Efficiently Amplifying Wideband Envelope 
Signals,” U.S. Patent No. 6,300,826, October 9, 2001.
[38]	
Vasic, M., et al., “Multilevel Power Supply for High Efficiency RF Amplifiers,” IEEE 
Transactions on Power Electronics, Vol. 25, No. 4, April 2010, pp. 1078–1089. 

4.4  Hybrid Supply Modulator 
187
[39]	
Rodriguez, M., et al., “Multilevel Converter Envelope Tracking in RF Power Amplifiers,” 
IEEE ECCE, San Jose, CA, September 2009, pp. 503–510. 
[40]	
Rodrıguez, M., et al., “Multiple-Input BUCK Converter Optimized for Accurate Envelope 
Tracking in RF Power Amplifiers,” IEEE APEC, Palm Springs, CA, February 2010, pp. 
715–722.
[41]	
Liu Q., D. L. Zhang, and M. Y. Liu, “A Novel Control Method for Multilevel Converter 
Used in Envelope Tracking Power Supply,” 2012 7th International Power Electronics and 
Motion Control Conference (IPEMC), Vol. 4, 2012, pp. 3010–3014.
[42]	
Rodriguez, M., et al., “Fast Dynamic Response Multilevel Converter for Voltage Tracking 
Applications,” 13th European Conference on Power Electronics and Applications 2009 
(EPE ’09), 2009, pp. 1–10.
[43]	
Philip, A., et al.,” A Highly Efﬁcient 1.95-GHz, 18-W Asymmetric Multilevel Outphasing 
Transmitter for Wideband Applications,” IEEE MTT-S International Microwave Sympo-
sium, Baltimore, MD, 2011, pp. 1–4.
[44]	
Hur, J., et al. “LINC Transmitter with Improved Efficiency,” U.S. Patent Application Pub-
lication No. 2013/0210376, August 15, 2013.
[45]	
Xi, H., Q. Jin, and X. B. Ruan, “Feed-Forward Scheme Considering Bandwidth Limitation 
of Operational Ampliﬁers for Envelope Tracking Power Supply Using Series-Connected 
Composite Conﬁguration,” IEEE Transactions on Industrial Electronics, Vol. 60, No. 9, 
September 2013, pp. 3915–3926.
[46]	
Huang, H., J. Bao, and L. Zhang, “A MASH-Controlled Multilevel Power Converter for 
High-Efﬁciency RF Transmitters,” IEEE Transactions on Power Electronics, Vol. 26, No. 
4, April 2012, pp. 1205–1214.
[47]	
Chen, W., “High Efﬁciency, High Density, Poly Phase Converters for High Current Applica-
tions,” Application Note 77, Milpitas, CA, Linear Technology.
[48]	
Soto, A., et al., “Analysis of the Buck Converter For Scaling the Supply Voltage of Digital 
Circuits,” IEEE Transactions on Power Electronics, Vol. 22, No. 6, November 2007, pp. 
2432–2440.
[49]	
Soto, A., et al., “Power Supply for a Radio Transmitter with Modulated Supply Voltage,” 
Proc. IEEE Appl. Power Electron. Conference, 2004, pp. 392–398.
[50]	
Quintero, J., et al., “Impact of Linear-Nonlinear Control in Multiphase VRM Design,” 
IEEE Transactions on Power Electronics, Vol. 26, No. 7, July 2011, pp. 1826–1831.
[51]	
Qiu, Y., et al., “The Multi-Frequency Small-Signal Model for BUCK and Multiphase Inter-
leaving BUCK Converters,” IEEE Applied Power Electronics Conference and Exposition, 
2005, pp. 392–398.
[52]	
Zhang, X., et al., “Design and Implementation of a Wide-Bandwidth Digitally Controlled 
16-Phase Converter,” IEEE COMPEL Workshop, Rensselaer Polytechnic Institute, Troy, 
NY, July 2006, pp. 106–111.
[53]	
Zhou, X., et al., “Investigation of Candidate VRM Topologies for Future Microproces-
sors,” Applied Power Electronics Conference 1998 (APEC 1998), February 1998, pp. 
145–150.
[54]	
Vasić, M., et al., “Multilevel Power Supply for High Efﬁciency RF Ampliﬁers,” Proc. 24th 
IEEE APEC, Washington, D.C., February 2009, pp. 1233–1238.
[55]	
Sahu, B., and G. A. Rincón-Mora, “A High-Efficiency Linear RF Power Amplifier with a 
Power-Tracking Dynamically Adaptive Buck-Boost Supply,” IEEE Transactions on Micro-
wave Theory and Techniques, Vol. 52, No. 1, January 2004, pp. 112–120.
[56]	
Norris, M., and D. Maksimovic, “10 MHz Large Signal Bandwidth, 95% Efficient Power 
Supply for 3G-4G Cell Phone Base Stations,” IEEE Applied Power Electronics Conference 
and Exposition (APEC), February 2012, pp. 7–13.
[57]	
Rodrıguez, M., et al., “Mismatch-Error Shaping Based Digital Multiphase Modulator,” 
IEEE Transactions on Power Electronics, Vol. 27, No. 4, 2012, pp. 2055–2066. 
[58]	
Vasic, M., et al., “Multilevel Power Supply for High Efﬁciency RF Ampliﬁer,” Proc. 24th 
Annual IEEE Appl. Power Electron. Conference, February 2009, pp. 1233–1238.

188 
��������������������������������������
Supply Modulator for Envelope Tracking
[59]	
Schaumann, R., M. S. Ghausi, and K. R. Laker, Design of Analog Filters, Englewood Cliffs, 
NJ: Prentice-Hall, 1990.
[60]	
Kerwin, W. J. “Passive Signal Processing,” in Electrical Engineering Handbook, Boca Ra-
ton, FL: CRC Press, 1993.
[61]	
Jones, E. C., et al., “Filters and Attenuators,” in Electronics Engineers’ Handbook, New 
York: McGraw-Hill/IEEE Press, 1996.
[62]	
Miaja, P. F., et al., “A Linear Assisted DC/DC Converter for Envelope Tracking and Enve-
lope Elimination and Restoration Applications,” IEEE Transactions on Power Electronics, 
Vol. 27, No. 79, July 2012, pp. 3302–3309.
[63]	
Miaja, P. F., et al., “Enhancements of the Multiple Input Buck Converter Used for Enve-
lope Tracking Applications by Improved Output Filter Design and Multiphase Operation,” 
2012 IEEE Energy Conversion Congress and Exposition (ECCE), 2012, pp. 1841–1848. 
[64]	
Sebastian, J., et al., “Analysis and Design of the Output Filter for Buck Envelope 
Ampliﬁers,” IEEE Transactions on Power Electronics, Vol. 29, No. 1, January 2014, pp. 
213–233.
[65]	
Li, Y., “System and Circuits Investigation of Wideband RF Polar Transmitters Using Enve-
lope Tracking for Mobile WiMAX/WiBRO Applications,” Master of Science Thesis, Elec-
trical Engineering, Texas Tech University, Texas, 2009.
[66]	
Aitto-oja, T. M., “High Efficiency Envelope Tracking Supply Voltage Modulation for High 
Power Base Station Amplifier Applications,” IEEE MTT-S Intl. Microwave Symposium 
Digest, Anaheim, CA, May 2010, pp. 668–671. 
[67]	
Lopez, J., et al., “Design of Highly-Efficient Wideband RF Polar Transmitters Using the 
Envelope-Tracking Technique” IEEE Journal of Solid-State Circuits, Vol. 44, No. 9, Sep-
tember 2008, pp. 2276–2294.
[68]	
Anderson, D. R., and W. H. Cantrell, “High-Efficiency High-Level Modulator for Use in 
Dynamic Envelope Tracking CDMA RF Power Amplifiers,” IEEE MTT-S Intl. Microwave 
Symposium Digest, Phoenix, AZ, May 2001.
[69]	
Asbeck, P. M., et al., “High Efficiency WCDMA Envelope Tracking Base-Station Ampli-
fier Implemented with GaAs HVHBTs,” Proc. IEEE Compound Semiconductor Integrated 
Circuit Symposium, Monterey, CA, October 2008, pp. 1–4.
[70]	
Wang, F., et al., “Envelope Tracking Power Amplifier with Pre-Distortion Linearization for 
WLAN 802.11g,” IEEE MTT-S Intl. Microwave Symposium Digest, Vol. 3, Fort Worth, 
TX, June 2004, pp. 1543–1546.
[71]	
Hoyerby, M., and M. A. E. Andersen, “Envelope Tracking Power Supply with Fully Con-
trolled 4th Order Output Filter,” Proc. IEEE Appl. Power Electron. Conference, 2006, pp. 
993–1000.
[72]	
Marco, L., E. Alarcon, and D. Maksimovic, “Effects of Switching Power Converter Noni-
dealities in Envelope Elimination And Restoration Technique,” IEEE International Sym-
posium on Circuits and Systems (ISCAS 2006), May 2006, pp. 21–24.
[73]	
Hoyerby, M., and M. Andersen, “Ultrafast Tracking Power Supply with Fourth-Order Out-
put Filter and Fixed-Frequency Hysteretic Control,” IEEE Transactions on Power Elec-
tronics, Vol. 23, No. 5, 2008, pp. 2387–2398.
[74]	
Hoyerby, M., and M. Andersen, “Self-Oscillating Soft Switching Envelope Tracking Power 
Supply for Tetra2 Base Station,” 29th International Telecommunications Energy Confer-
ence 2007 (INTELEC 2007), 2007, pp. 53–60.
[75]	
Vasic, M., “Wide Bandwidth High Efficiency Power Converter for RF Amplifiers,” Ph.D. 
Thesis, Universidad Politcenica de Madrid, Spain, June 2010.
[76]	
Vasic, M., et al., “High Efficiency Power Amplifier Based on Envelope Elimination and Res-
toration Technique,” 2010 IEEE Energy Conversion Congress and Exposition (ECCE), 
2010, pp. 3833–3840.
[77]	
Kaneta, M., et al., “Architecture of Wideband High-Efficiency Envelope Tracking Power 
Amplifier for Base Station,” IEICE Technical Report, Osaka, 2009.

4.4  Hybrid Supply Modulator 
189
[78]	
Wang, F., et al., “An Improved Power-Added Efficiency 19-dBm Hybrid Envelope Elimina-
tion and Restoration Power Amplifier for 802.11.g WLAN Applications,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 54, No. 129, December 2006, pp. 
4086–4099.
[79]	
Salimi, A., R. Dehghani, and A. Nabavi, “A Wide Band Envelope Modulator for Envelope 
Tracking RF Power Amplifiers,” 2013 21st Iranian Conference on Electrical Engineering 
(ICEE), 2013, pp. 1–4.
[80]	
Li, D. X., et al., “RFPA Supply Modulator Using Wide-Bandwidth Linear Amplifier with 
a GaN HEMT Output Stage,” 2013 IEEE 14th Workshop on Control and Modeling for 
Power Electronics (COMPEL), 2013, pp. 1–6.
[81]	
Hsia, C., “Envelope Ampliﬁer Design for Wireless Base-Station Power Ampliﬁers,” Ph.D. 
dissertation, University of California, San Diego, 2010.
[82]	
Kim, D., and D. Kang, “Wideband Envelope Tracking Power Amplifier for LTE Applica-
tion,” IEEE Radio Frequency Integrated Circuits Symposium, 2012, pp. 275–278.
[83]	
Hoversten, J., “Efficient and Linear Microwave Transmitters for High Peak-to-Average 
Ratio Signals,” Ph.D. thesis, University of Colorado, May 2010.
[84]	
Stauth, J. T., and S. R. Sanders, “Optimum Bias Calculation for Parallel Hybrid Switching-
Linear Regulators,” Proc. 22th Annual IEEE Appl. Power Electron. Conference, February 
2007, pp. 569–574.
[85]	
Kimball, D., et al., “Wideband Precision Current Sensor,” U.S. Patent No. 6,661,217, De-
cember 2003.
[86]	
Kim, B., et al., “Envelope Tracking Technique for Multimode PA Operation,” Proceedings 
of the 39th European Microwave Conference, 2009, pp. 429–432.
[87]	
Jeong, J., et al., “Modeling and Design of RF Amplifiers for Envelope Tracking WCDMA 
Base-Station Applications,” IEEE Transactions on Microwave Theory and Techniques, 
Vol. 57, No. 9, September 2009, pp. 2148–2159.
[88]	
Yusoff, Z., et al., “High Linearity Auxiliary Envelope Tracking (AET) System Using GaN 
Class-J Power Amplifier,” IEEE Power Amplifier Symposium, Arizona, September 2010, 
pp. 1–2.
[89]	
Yusoff, Z., et al., “The Benefit of GaN Characteristics over LDMOS for Linearity Improve-
ment Using Drain Modulation in Power Amplifier System,” 2011 Workshop on Integrated 
Nonlinear Microwave and Millimetre4Wave Circuits (INMMIC), April 2011, pp. 1–4.
[90]	
Yusoff, Z., et al., “Linearity Improvement in RF Power Amplifier System Using Integrated 
Auxiliary Envelope Tracking System,” IEEE MTT International Microwave Symposium 
(IMS) Digest, June 2011, pp. 1–4.
[91]	
Yusoff, Z., “The Auxiliary Envelope Tracking RF Power Amplifier System,” Ph.D. thesis, 
Cardiff University, March 2012.
[92]	
Koukkari, E., and P. Kurttio, “Power Source and Method for Controlling Operational 
Power,” U.S. Patent No. 8,063,513, November 22, 2011.
[93]	
Balteanu, F. G., et al., “Apparatus and Methods for Envelope Tracking Systems,” U.S. Pat-
ent Application Publication No. 2013/0217345, August 22, 2013.
[94]	
Wang, Z. C., et al., “A Gan MOSFET Supply Modulator Compatible with Feed Forward 
Loop for Wideband Envelope Tracking Power Amplifier,” 2013 IEEE Topical Conference 
on Power Amplifiers for Wireless and Radio Applications (PAWR), 2013, pp. 40–42.
[95]	
Kanbe, A. et al., “New Architecture of Envelope Tracking Power Amplifier for Base Sta-
tion,” IEEE Asia Pacific Conference on Circuits and Systems, Macao, China, December 
2008, pp. 296–299.
[96]	
Hsia, C., et al., “Wideband High Efﬁciency Digitally-Assisted Envelope Ampliﬁer with 
Dual Switching Stages for Radio Base-Station Envelope Tracking Power Ampliﬁers,” IEEE 
MTT-S Intl. Microwave Symposium Digest, May 2010, pp. 672–675.
[97]	
Hassan, M., et al., “A Combined Series-Parallel Hybrid Envelope Ampliﬁer for Envelope 
Tracking Mobile Terminal RF Power Ampliﬁer Applications,” IEEE Journal of Solid-State 
Circuits, Vol. 47, No. 5, May 2012, pp. 1185–1198.

190 
��������������������������������������
Supply Modulator for Envelope Tracking
[98]	
Wang, Z. C., “A Supply Modulator with Nested Structure for Wideband Envelope Track-
ing Power Amplifier,” IEEE Topical Conference on RF Power Amplifiers for Radio and 
Wireless Applications, January 2012, pp. 1–4.
[99]	
Wang, Z. C., “Wide Dynamic Range Multi-Nested Envelope Tracking Power Amplifier for 
LTE Application,” IEEE International Wireless Symposium (IWS), April 2013, pp. 1–4.
[100]	 Steele, J., and D. Eddlemon, “Use High-Voltage Op Amps to Drive Power MOSFETs,” 
Electronic Design, 1993, pp. 51–55.

191
C H A P T E R  5
Power Amplifier for Envelope Tracking
In ET PA design, the link between the supply modulator and RF PA should be ex-
amined carefully to systematically maximize efficiency and linearity. We address the 
RF PA design for ET in this chapter. Unlike small signal amplifiers operating in the 
linear region, the RF PA operates in the large-signal regime, where the voltage and 
current pass through the entire active region of the transistor and sometimes fall 
into the cutoff and saturation regions. The strong nonlinearities of the RF PA result 
in the phenomenon of the intermodulation distortion, wherein the spectral content 
at integer multiples of the stimulus appears at both the input and output. The lin-
earity and efficiency performance of the RF PA are only established when these in-
dividual mixing products are handled properly. Furthermore, management of heat 
represents one of the major challenges for RF PA and ET design. Heat leads to im-
paired linearity, reduced effective power density, and power gain. In addition to the 
above effects on performance, reliability may be weakened and catastrophic failure 
may happen due to self-heating, especially under mismatch conditions usually oc-
curring in the mobile UE environment. Therefore, RF PA requires that the design be 
made in a predefined area of the Smith chart to identify optimal performance and 
termination impedances clearly. At RF frequencies, the wavelength of the excitation 
determines the size of the physical dimensions of the bias and matching network for 
RF PA design. The distributed-parameters environment coupled with the particu-
larly low impedance presents a challenge for the synthesis and design of the match-
ing networks. To ensure the optimum performance, considerably time-consuming 
experiments are needed to identify the optimal terminations to establish absolute 
performance. This is followed by a suitable design of the matching network repli-
cation of the required impedance terminations in the appropriate mixing product 
frequencies. This uncertainty means bias and matching network design for the RF 
PA includes several iterations and extensive trial and error.
Optimum operation of RF PA relies on the identification of the optimal imped-
ance terminations not only at the fundamental but also all relevant harmonics. 
Classical RF PA design methods are therefore often strongly reliant on empirical 
methods with proxy measurements to infer the actual operating state of the RF PA. 

192 
������������������������������������
Power Amplifier for Envelope Tracking
5.1  RF PA Design Methodology
RF PA design techniques are typically driven by the availability of measurement sys-
tems, the modeling approach, and the selection of the electronic design automation 
(EDA). The design methodologies are generally classified into three types. The first 
type is the measurement-based processes in which the RF transistor is characterized 
a priori for the relevant design parameters such as output power, efficiency, and 
power gain. The second type is based on analytical expressions, possibly supple-
mented with measured data or transistor data sheet parameters, to approximate 
the optimum impedance terminations. The third type is an EDA-based method to 
predict the behavior of the RF PA through the use of device large-signal models and 
measurement results.
5.1.1  Measurement Method
The load-pull measurement method of RF PA design enables optimum transistor 
terminating impedances to be systematically, accurately, and quickly identified 
without slow and uncertain trial and error associated with conventional processes. 
Generally speaking, the load-pull concept refers specifically to present a priori im-
pedance to a device under test (DUT) in a precisely controlled manner to extract the 
optimum performance of the DUT. Load-pull measurements will vary terminal im-
pedance, frequency, and bias to establish conditions for the optimum performance 
from the DUT. Load-pull is a measure of a device under actual large-signal opera-
tion. It may include measuring device performance versus input power, impedance, 
bias, temperature, and other factors. Because there is a direct device measuring, the 
data can be used with confidence in the conditions of the measurement.
In the first step in design process, the specified RF transistor is characterized to 
acquire the key parameters of the device such as the efficiency, output power, gain, 
and load-pull contours. The measured data produce the crucial basis of the PA de-
sign and are used to construct PA together with the matching and biasing circuits. 
The design process is complete when the measurement results successfully satisfy 
the specification. The main advantage of the measurement method is that it is high-
ly efficient and accurate for practical product design without the time-consuming 
development of large-signal modeling. However, it depends on the accuracy of the 
measuring system in the generation of the data. The load-pull measuring systems 
enable the detailed recording of key characteristics of transistors with high accu-
racy when the DUT is driven in realistic working conditions. It therefore enables 
first-pass RF PA design because the design is based on measurement data under 
required operating conditions.
In the load-pull-based design method, once the optimal performance of the 
transistor has been identified, the DUT can be removed so that the input and out-
put terminating impedance can be measured by a vector network analyzer (VNA) 
to replicate them by a correspondingly formed matching network. Therefore, load-
pull brings about a dramatic reduction in the design cycle time and postproduction 
tuning. This method has been widely used when large-signal models are not avail-
able and trustworthy. However, in general, conventional load-pull data typically 
cannot provide the magnitudes and phases of harmonics so that it cannot provide 
not enough information to reconstruct the terminal waveforms of the RF transistor 

5.1  RF PA Design Methodology 
193
if they are highly nonlinear under large signal conditions. Therefore, it is not suf-
ficient to be used independently as a complete device model, especially for switch 
mode RF PA designs.
5.1.2  Analytical Method
The second method is based on analytical expressions to approximate the optimal 
load impedance terminations such as the Cripps method [1],  possibly supplemented 
with measured data and transistor parameters from the data sheet. It identifies op-
timal load impedance, followed by the design of a prototype whose impedances 
replicate the identified optimal parameters by an analytical method. From the ana-
lytical design methods, the Cripps method is commonly used because it is intuitive 
and easy to use. It is a large-signal hybrid empirical-analytical formulation that pro-
duces the maximum output power and gain of a transistor by considering its break-
down voltage and saturation current. It is an ideal analytical condition because all 
parasitic effects such as output capacitance, bonding wire inductance, and package 
lead are eliminated. Therefore, it allows contours produced directly at the active 
die reference plane. Based on a combination of DC and RF data from the measure-
ments and data sheet, the Cripps method can provide reasonable results. After ex-
traction of contours and an associated large-signal load termination impedance, the 
optimum input termination impedance is obtained so that the matching networks 
can be designed. It produces similar results to measurement-based methods with the 
advantages of providing direct contours and requiring much lower capital expense.
5.1.3  EDA and Modeling Method
Because device characterization is a must for RF PA design, the ideal form of device 
data is a large-signal model. With such a model, the performance for various drive 
and impedance conditions can be analyzed so that advanced PA design can be ana-
lyzed and developed.
Much work has been devoted to large-signal modeling at RF and microwave 
frequencies in recent years. Although these analytical models may be operating 
precisely on certain areas of the device, they may fail in other areas because they are 
typically extrapolated from DC and small signal measurements; verification under 
actual large-signal operation is generally required. 
A second possibility is that the load-pull data for the RF PA design is used to 
validate the large-signal models. The load-pull data is measured during the actual 
device operation as reference data. The large-signal model can be compared to the 
load-pull data and may be adjusted as necessary to obtain an accurate analysis in 
the region of interest. At this point, the large-signal model can be used for more 
complex PA analysis.
Another possibility for formulating a large-signal model is to use a measure-
ment-based approach such as the polyharmonic distortion (PHD) model. This is 
based on measurements of the X-parameters, which are a superset of S-parameters 
for the nonlinear components and measured by using a nonlinear vector network 
analyzer (NVNA).
The third method is an EDA simulation-based RF PA design with precise large-
signal modeling technology. 

194 
������������������������������������
Power Amplifier for Envelope Tracking
Nonlinear behavior models do have some significant limitations. For example, 
they only work in the forward direction, may just take a single tone input, and 
cannot be taken into account for impedance mismatch to the device terminals. 
This results in unacceptable simulation errors when cascading nonlinear devices. 
Moreover, these behavioral models require several instruments and configurations 
to obtain the various performance parameters. To optimize the design process, the 
measurement-based nonlinear behavioral model would have to overcome the inac-
curacies. Due to the complexity, lead time, and cost of developing a large-signal 
model, an alternative measurement-based generalized nonlinear model is required 
to provide sufficient accuracy. 
S-parameters measure the complex amplitude and phase relationship between 
the small signals at the same frequency at different ports, but not for additional 
spectral components generated by the DUT at large signals. It ignores the interac-
tion between the different frequency signals to a device account that state time-
varying by large-signal stimuli. X-parameters include harmonics and intermodula-
tion frequency components, and the relationships between all these frequencies for 
a given drive amplitude and frequency. Therefore, the complete waveforms can be 
measured at the device terminals, even including highly compressed conditions.
Most high-power PAs have optimal performance far from 50 ohms. It is there-
fore necessary to acquire X-parameters over large areas of the Smith chart to guar-
antee that the resulting model is valid over the corresponding range of loads. The 
limitation is not with X-parameters or the PHD framework for simulating with 
X-parameters, but with the provision of a simple, rapid, automated measurement 
system and application to acquire the X-parameters over the entire complex load 
domain of interest (see Figure 5.1).
The load-pull X-parameter measurement can contain a complete sweep plan. 
Stimulus variables include impedance, input power, bias, and frequency. It can ex-
tend the applicability of the PHD model over a much wider range of validity for 
actual applications for many high-power PA designs. The method can be imple-
mented with three steps. First, the load-pull measures the X-parameter for each 
impedance setting with X-parameters added to the measured dataset. When the 
measurements are completed on all the impedances, the measured X-parameter can 
be stored into a single file. Second, the EDA nonlinear simulator then quickly reads 
Figure 5.1  Typical NVNA setup with source-pull and load-pull for X-parameters measurement. The 
increased demand for higher performance of the transistor devices requires them to be typically 
operated closer to compression region. Measuring devices in nonlinear region requires large-signal 
measurement system. For RF PA applications, large-signal measurement together with load-pull test 
beds is indispensable to get an accurate characterizing device under practical operating conditions. 
(From: [6]. © 2008 IEEE. Reprinted with permission.)

5.2  Matching Network Design 
195
the X-parameter file stored by the load measurements and creates a PHD model 
component associated with the file. Finally, this component can then be dragged 
and dropped directly into EDA environment to start a circuit schematic with form 
as a nonlinear device and the analysis can begin immediately.
This process is a significant simplification compared to previous design meth-
ods. It offers the simplicity of using load-pull and NVNA data directly for RF PA 
design, providing the capability to analyze complex circuits that require a large-
signal model. It not only allows characterizing a single device, but also applies to 
the modeling of a complete RF PA design independent of device technology. Extrac-
tion of complete load-dependent X-parameters at multiple harmonics can be much 
more efficient and reproducible than extracting a conventional standard transistor 
model with a tremendous number of parameters to be optimized and fitted to over-
all behaviors of PA. It is ideal for emerging RF PA technology prototyping before 
any detailed physics-based compact models and circuit-level models are available.
5.2  Matching Network Design
In RF PA design, one of the most essential purposes of the above design method-
ologies is to identify optimum load impedance. In other words, they must allow 
designers to manage and analyze nonlinearities to transform what is essentially an 
unsolvable nonlinear mathematical problem into a series of variable impedance 
measurements, followed by the use of well-understood linear network theory for 
matching network design. After identifying the optimal termination impedances at 
all relevant intermodulation products, the matching network replicates these con-
ditions using well-defined linear synthesis and physical implementation methods. 
Therefore, a complex nonlinear problem is transformed as mainly a problem of 
linear matching network synthesis.
5.2.1  Introduction
The matching network systematically matches the source and load impedance at 
the input and output of the transistor, allowing contours to be superimposed over 
a Smith chart that identifies optimum impedances subject to some criteria. To deal 
with the matching network design, a structured, often iterative process is followed 
to reveal optimal performance. The process begins by identifying the key param-
eters that should be optimized. In general, the contours of parameters are recorded 
in source and load impedance planes by source-pull and load-pull measurements, 
respectively. Typically, there are several existing criteria to weigh against each other 
to achieve the final design target. For example, in the load-matching network de-
sign, output power, gain, and PAE must be traded off against each other to establish 
the absolute performance.
Before going further, an essential point of matching networks must be made. It is 
commonly and erroneously assumed that Zsource and Zload represented by transistor 
terminating networks are conjugates of Zin and Zout, as shown in Figure 5.2. This 
is incorrect because the superposition relation becomes invalid under large-signal 
conditions. The terminating impedances presented are the conditions to obtain the 
prescribed performance while the transistor input and output impedance interacts 

196 
������������������������������������
Power Amplifier for Envelope Tracking
with all relevant intermodulation products. Only under small-signal conditions is 
the concept of maximum power transfer and termination conjugate meaningful. 
Accordingly, an outcome of this is that the mismatch invariance property of a loss-
free two-port network establishes that a perfect match at the input to a matching 
network does not produce a conjugate match relationship at its interface to the 
transistor, unless the matching network is lossless. These key points are important 
for understanding and designing matching network successfully.
For RF PA design, the matching network is required to make termination 
impedance at all relevant intermodulation products to provide the desired per-
formance identified by load-pull. The physical response of the matching network 
can be understood as a means to specifically manipulate the relative magnitude 
and phase of voltage and current at the transistor to realize a desired destination. 
The matching network impedance trajectory is not unique in that there are many 
responses available to generate specified impedance, with each response offering 
relative merit with respect to performance, physical size, and implementation cost. 
Generally speaking, the matching network design consists of the steps shown in 
Figure 5.3.
5.2.2  Matching Theory
The matching network is ideally lossless, and is usually designed so that the imped-
ance seen looking into the matching network is the optimum impedance obtained 
from load-pull measurements. Network synthesis is a typical method of designing 
matching filters to obtain the component values of the filter from a given rational 
function representing the desired transfer function. Matching network synthesis 
Figure 5.2  A generic matching network with input and output terminations defined as Zsource and 
Zload and RF transistor input and output impedances defined as Zin and Zout. By replicating the opti-
mum impedance terminations at all relevant intermodulation products, the performance exhibited 
by a transistor in load-pull will match that exhibited in the final RF PA design. (From: [11]. © 2003 
Artech House. Reprinted with permission.)

5.2  Matching Network Design 
197
consists of selecting a frequency response, transformation direction identification, 
and calculation of the number of sections for the required bandwidth and imped-
ance transformation ratio, producing the lumped-parameter constants of each L-
section cell. The L-section cell follows the procedure of physical synthesis at the 
circuit level, based on the lumped-parameter, distributed-parameter, or hybrid-pa-
rameter implementations.
Among the network synthesis methods, Butterworth synthesis is one of the 
commonly used responses as shown in Figure 5.4(a). It is based on optimal flat 
bandwidth for a given number of sections and the relative simplicity of the solution. 
There are typically three physical implementation methods as lumped-parameter, 
distributed-parameter, and hybrid-parameter implementations. Hybrid parameters 
present the most useful and flexible method to provide a reasonable compromise in 
performance, physical size, and ease of post-manufacture tuning for almost all RF 
PA application scenarios.
As the four Butterworth L-section prototypes are illustrated in Figure 5.4(d–g), 
they represent the basic matching network building blocks capable of synthesiz-
ing arbitrary impedance anywhere inside the Smith chart. Each L-section cell is 
distinguished by either a lowpass or highpass frequency response and the relative 
direction of the impedance transformation.
The lowpass impedance trajectory of Figure 5.4(d) meets matching require-
ments for the vast majority of the RF PA designs. For example, as a load-matching 
Figure 5.3  Design process of the matching network. It is an essential part of the RF PA design. It 
establishes the connection between the termination impedances identified by the load-pull and the 
target impedances that must be synthesized through the matching network.�

198 
������������������������������������
Power Amplifier for Envelope Tracking
network, two or three sections are typically cascaded together to generate a low 
impedance load line at the desired bandwidth. The source matching network can 
follow a similar topology. However, the interstage matching network is highpass 
Figure 5.4  (a–c) A multisection L-section matching network with overall impedance transformation ratio 
T. A lower Q value but larger bandwidth follows the increased number of L-sections. The four canonical But-
terworth L-section matching sections (d–g) based on frequency response and transformation. The solid dot 
on the real axis is the geometric mean between RH and RL, representing the characteristic impedance of the 
quarter-wave line matching these two impedances. With a unique impedance trajectory for each type of cell, 
it graphically illustrates distinct properties in achieving the performance requirements specified by the match-
ing network. (From: [11]. © 2003 Artech House. Reprinted with permission.)

5.2  Matching Network Design 
199
or hybrid as illustrated in Figure 5.4(f) because it provides a DC block, which is 
necessary for interstage matching to isolate each bias network.
The first step of Butterworth synthesis is to define the number of sections N 
required to achieve its target specifications. Because the impedance transformation 
ratio Tp of each L-section of Butterworth matching network is identical, the overall 
N-section impedance transformation ratio is 
N
p
T
T
=
. The impedance transforma-
tion ratio can be expressed as
	
N
p
in
out
T
T
R
R
=
=
	
(5.1) 
where Rin and Rout are the two impedances being matched in the N-section Butter-
worth network, as shown in Figure 5.4(a). The intermediate impedance transforma-
tion ratio as shown in Figure 5.4(b) can be defined as
	
p
H
L
T
R
R
=
	
(5.2)
where RH and RL are high and low impedances defined in Figure 5.4(d–g). The 
unique resolution of N is constrained by bandwidth, which requires identification 
of additional nonlinear equations with N and bandwidth. The solution of the non-
linear system can be carried out by analytical or graphical methods.
For typical narrowband RF PAs, the N-section Butterworth impedance match-
ing network in Figure 5.4(a) represents an optimum compromise in bandwidth, 
insertion loss, ripple, harmonic rejection, and ease of use. While other responses 
(for example, Chebyshev) offer advantages such as increased harmonic rejection, 
these come with disadvantages, like degraded group delay and physical implemen-
tation difficulty. The central merit of a Butterworth N-section matching network is 
the relative ease of synthesis and physical implementation. Because the Butterworth 
response is corresponding to geometric-mean matching, the whole synthesis and 
design process can be performed exclusively by simple analytical methods based 
on the Smith chart. Furthermore, the bandwidth over which impedance matching 
occurs is directly proportional to the number of sections, which can vary from one 
for a mobile UE PA interstage match, to six or more for an input prematch of the 
BTS PA.
For the Butterworth N-section matching network, N can be identified by aug-
menting (5.1) with an additional equation in impedance transformation ratio T 
and instantaneous bandwidth as
	
1
1
N
o
T
Q
+
−
≤
	
(5.3)
where Qo is the optimized matching network quality factor for instantaneous band-
width indication. It is derived from an empirically optimum proxy for instanta-
neous bandwidth. 
As shown in Figure 5.4(c), impedance displacement locus for construction of 
an N-section Butterworth distributed-parameter matching network with Qo = 2.0 
is presented. Therefore, a constant Q ellipsoid establishes an elegant duality be-
tween graphical solution of the Butterworth L-section cell and its analytical equiva-
lent given by (5.3). Instead of the analytical calculation of N, the graphical method 
indirectly identifies the number of sections geometrically by bounding the absolute 

200 
������������������������������������
Power Amplifier for Envelope Tracking
value of the instantaneous deviation of the impedance trajectory to lie between the 
specified Qo ellipsoid and the real axis for an N-section matching network. Typical-
ly, with Qo ≤ 2 of the Butterworth L-section, it is rendered to be well suited for an 
RF PA instantaneous bandwidth 4% to 5% of the operating frequency. However, 
for broadband RF PA considering third-order digital predistortion bandwidth, it 
may require Qo ≤ 1.5 to provide suitable performance to an instantaneous band-
width of 10% of operating frequency. 
After identifying Qo, the N-section impedance transformation ratio T can be 
obtained by matching network evaluation. Finally, the number of matching section 
N can be calculated from (5.3). From the standard definition of matching network 
Qo, L and C of the L-section Butterworth cell can be calculated as
	
ω
=
⋅
(
)
o
L
o
L
Q
R
	
(5.4)
	
ω
=
⋅
2
1 (
)
o
C
L 	
(5.5)
where RL are defined in Figure 5.4(b), Qo can be set to either 2.0 or 1.5, and ωo is 
the resonant radian frequency of the matching network.
Further L and C values of individual L-section cell can be synthesized for physi-
cal implementations in either lumped or distributed parameters, perhaps combin-
ing both as hybrid implementation. However, the analytical method transformed 
between real-valued impedances. Imaginary components and its effect evaluation 
can be performed by simply adding a series or shunt reactive element to the But-
terworth L-section.
Because there is a one-to-one mapping between each parameter of the lumped-
parameter matching network and its associated physics, physical implementation 
of the lumped-parameter Butterworth matching network follows directly from 
synthesis since both are expressed in terms of L and C, so no further rendering of 
network parameters is required. Each lumped element identified by the synthesis 
procedure is mapped directly into its corresponding element of physical implemen-
tation of Figure 5.4(a).
In wireless communications, an important consideration for lumped-element 
matching network implementation at RF frequencies is parasitic phenomena. Be-
cause the wavelength at RF frequencies is on the order of the physical dimensions 
of most passive components used for the physical implementation of the matching 
network, deliberate scrutiny must be attached to their parasitic resonances and 
losses, their physical orientation, and the physical environment. For example, the 
substrate and physical placement can induce magnetic field coupling to adjacent 
components. Resonance phenomena should also be deliberately exploited, such as 
series resonance of the capacitor as a DC block and parallel resonance of the induc-
tor as an RF choke or bias feed. At typical wireless bands spanning 700 MHz to 
2,700 MHz, although lumped-parameter matching networks have the advantage 
of physical compactness (especially inductance), they typically have higher losses 
than distributed-parameter networks of equivalent operating frequency and imped-
ance transformation. 
The physical implementation of the multisection distributed-parameter But-
terworth matching network is a subset of lumped-parameter synthesis, because 

5.2  Matching Network Design 
201
the characteristic impedance of the former is derived graphically from the lumped 
parameters. Physically implementing a single-stage distributed-parameter match-
ing network simply requires identification of the characteristic impedance of the 
quarter-wave transmission line matching two real-valued impedances RH and RL in 
Figure 5.4(b), expressed as
	
0
H
L
Z
R
R
=
⋅
	
(5.6)
The extension of (5.6) to match reactive elements is accomplished by augment-
ing the electrical length of the transmission line to provide the conjugate match, 
subject to the locus being bounded by the Qo = 2.0 ellipsoid. If the locus extends 
beyond this region, additional sections are required. This process can be extended 
to additional sections by simply calculating the characteristic impedance from each 
pair of intermediate real-axis impedances. Extension of the multisection matching 
network to matching reactive elements is treated the same as it is with the single-
section matching network.
At wireless communication bands, hybrid implementation of the matching net-
work is usually optimum because both lumped-parameter and distributed-param-
eter implementations exhibit mutually exclusive benefits spanning this frequency 
range. Hybrid implementation combines both for compact physical size, minimal 
parasitic effects, and the ﬂexibility and parasitic performance of distributed induc-
tance with ease of tuning and compact physical size of lumped capacitance. The 
unique ability of hybrid implementation will be exemplified in the following class-P 
RF PA design section.
5.2.3  Multisection and Taper Matching
As mentioned with the impedance transformer for matching network design, the 
vast majority of them can be classified as shown in Figure 5.5.
From this classification, there are two main categories known as synchro-
nous and nonsynchronous families. Each has pros and cons for matching network 
Figure 5.5  Classification of impedance transformer for matching network design.

202 
������������������������������������
Power Amplifier for Envelope Tracking
design. First, synchronous impedance transformer is easy for synthesis and is di-
vided into discrete and continuous subcategories, known as quarter-wave multisec-
tion and tapered lines. Impedance transformation ratio, bandwidth, insertion loss, 
harmonic rejection, and physical size are the most important factors establishing 
impedance transformation network performance. The secondary factors are out-
of-band response, especially for the stability, video bandwidth control, materials, 
and assembly costs. The number of sections is a variable fixed by the transforma-
tion ratio, bandwidth, and insertion loss. It is the primary factor in the total cost as 
size is directly proportional to the number of sections.
In a distributed-parameter matching network design, quarter-wave transform-
ers are widely used along with a transmission line with a characteristic impedance 
and length equal to λ/4. The characteristic impedance of the quarter-wave line Z0 is 
the geometric mean of Z1 and Z2, as shown in Figure 5.6, which is similar to (5.6) 
but considers reactance components.
A quarter-wave line with the characteristic impedance Z0 will match a trans-
mission line with characteristic impedance Z1 to a load Z2 so that all power will 
be delivered to the load. The key problem of a single quarter-wave line is its nar-
rowband response, which guarantees a perfect match only at the precise frequency 
of quarter-wavelength. However, the bandwidth can be increased by adding mul-
tiple quarter-wave sections. Therefore, quarter-wave transformers are commonly 
employed as multisection transformers with typical forms known as binomial and 
Chebyshev. For a multisection transformer, the basic principle is that in a multi-
section transformer with N sections, each segment has characteristic impedance 
slightly different from the adjacent ones. The reflection coefficient Γ(θ) can be ex-
pressed as a Fourier cosine series, which implies that any desired reflection co-
efficient response versus frequency can be synthesized theoretically by properly 
choosing enough sections, as the Fourier series can match any arbitrary function 
if enough terms are used. Therefore, the design philosophy used here is once a 
response of Γ(θ) and is chosen in form of a polynomial or a Fourier cosine series, 
the needed values of Γn can be obtained to complete the matching-network design.
5.2.3.1  Binomial Multisection
For a given number of sections N, the binomial matching transformer yields a flat 
response as close as possible to the design frequency, which can be achieved by set-
ting the first N − 1 derivatives of the reflection coefficient equal to zero at the center 
frequency f0. The reflection coefficient Γ(θ) is determined by the characteristic im-
pedance of the line and the load impedance, but the matching transformer has no 
electrical length, as shown in Figure 5.7.
Figure 5.6  Illustration of characteristic impedance of the quarter-wave line.

5.2  Matching Network Design 
203
5.2.3.2  Chebyshev Multisection
As shown in Figure 5.7, the Chebyshev multisection transformer optimizes band-
width at the expense of passband ripple, known as equal ripple. Therefore, the 
bandwidth of the Chebyshev multisection transformer is substantially better than 
that of the binomial multisection transformer if such ripple is tolerable.
The Chebyshev transformer can typically be used in applications in which 
physical constraints prevent use of the Butterworth implementation for either a 
given impedance transformation or bandwidth. For equivalent performance im-
pedance transformation or bandwidth, it is slightly smaller physically, although it 
is subject to increased manufacturing sensitivity. The Chebyshev multisection also 
suffers from degraded group delay compared to Butterworth and Klopfenstein re-
sponses. The Chebyshev transformer can be designed by matching the coefficients 
of the Chebyshev polynomial. Once the order of the Chebyshev polynomial is cho-
sen, the coefficients can be found accordingly.
5.2.3.3  Tapered-Line Matching
For broadband RF PA that requires matching bandwidth approaching a decade, 
optimum distributed-network continuously tapered lines can be employed. In 
Figure 5.7  A table of parameters for quarter-wave multisection and tapered-line impedance transformer for 
matching network design.

204 
������������������������������������
Power Amplifier for Envelope Tracking
comparison with multisection quarter-wave transformer, all multisection counter-
parts have involved a monotonic change in characteristic impedance, from Z1 to 
Z2 as shown in Figure 5.7. However, instead of having a stepped change in charac-
teristic impedance as a function position, continuous tapers can smoothly join the 
source and load impedances, which can be seen as a stepped multisection trans-
former as the number of sections increase to infinity, as shown in Figure 5.8.
A tapered impedance matching network is defined by two characteristics—its 
length L and its taper function Z0(z). Actually, there are an infinite number of 
possible functions of Z0(z). There are commonly three types used: the exponential 
taper, the triangular taper, and the Klopfenstein taper. Their properties and re-
sponse are illustrated in Figures 5.7 and 5.9, respectively. Recall the bandwidth of a 
multisection matching transformer increases with the number of sections. Similarly, 
the bandwidth of a tapered line will typically increase as the length L is increased.
Of the three tapered line responses, the Klopfenstein taper is considered to have 
optimum response in that the reflection coefficient is minimal over the passband. 
The Klopfenstein taper can be introduced primarily for expanded bandwidth RF 
PA with instantaneous frequency agility that is impossible with individual quarter-
wave sections or difficult with multisection transformers. Although the Klopfen-
stein taper impedance transformer performs with broadband properties, differ-
Figure 5.8  Illustration of the transformer line can be continuously tapered instead of discrete mul-
tiple sections to achieve broadband matching.
Figure 5.9  The load impedance (a) and reflection coefficient (b) characteristics for tapered line 
matching networks.

5.2  Matching Network Design 
205
ent frequencies are suitable for different taper lengths to maintain the superior 
response.
5.2.4  Nonsynchronous Impedance Transformer
In applications in which the quarter-wave impedance transformer is physically too 
long and some bandwidth can be sacrificed, the nonsynchronous transformer can 
be a good alternative. The generic nonsynchronous transformer can be described as 
shown in Figure 5.10 and (5.7).
	
θ
=
+
+
2
1
1
2
arctan
1
T
Z
Z
Z
Z
	
(5.7)
In this category, there are various types of transformers available for different 
application scenarios as shown in Figure 5.11. Therefore, they are very flexible to 
use for RF PA matching network design. 
As shown in Figure 5.11, microstrip line short sections and stubs, whose physi-
cal lengths are smaller than λ/4 at which they operate, are also incorporated as 
nonsynchronous transformer elements in this book. They are the most common 
components for approximate RF realization of lumped elements in microstrip filter 
structures. They can also be termed quasi-lumped elements because the approxi-
mate equivalent lumped circuit can be found in Figure 5.11. Therefore, they may 
also be regarded as lumped elements if their dimensions are even smaller than a 
typical λ/8.
Here a stub is a length of a straight transmission line that is short or open-
circuited at one end and connected to the circuit at the opposite end. A λ/4 stub 
left with an open end can be used as a notch filter to attenuate certain frequencies. 
The bandwidth of a λ/4 microstrip notch filter is about 20%. This λ/4 notch filter 
not only attenuates the design frequency, but it also attenuates the frequency band 
around the odd harmonics of the design frequency. Therefore, λ/4 microstrip stubs 
can be used for designing bias networks to supply DC to RF PA.
Radial stub is an open-circuit stub realized in a radial transmission line instead 
of a straight transmission line. It is a useful distributed-parameter element, primar-
ily for providing a clean broadband short circuit without spurious resonances, and 
is much broader than a simple open-circuit stub. It can achieve a wide stopband op-
eration and deep rejection through zero point generation. It is especially useful on 
bias lines at high frequencies. However, radial stubs are shorter than uniform stubs, 
Figure 5.10  Illustration of a generic nonsynchronous transformer for matching network.

206 
������������������������������������
Power Amplifier for Envelope Tracking
Figure 5.11  Typical nonsynchronous transformer types and equivalent lumped their element and microstrip line circuitry. 

5.3  Bias Network Design 
207
but they cannot be folded or bent. Therefore, they take up a lot of substrate area. 
Unfortunately, there is no simple equation to describe the radial stub adequately, 
and practical experiments work better than any formula. In the radial shunt or but-
terfly radial stub configuration, the added symmetry of multiple stubs can improve 
the bandwidth performance.
It is helpful to differentiate the two possible ways of realizing short stubs. One 
way is to use via at the end of the shunt line to connect to the ground. Then the 
short stub does not have any significant advantage compared to open stub. The 
open stub has open-end capacitance that is effectively making it longer than de-
sired; the short stub has via inductance that is effectively making it shorter than 
desired. Via can also have resistance, so it can lower the resonator Q value. The 
only advantage of short stub is than it can provide ground return if indeed desir-
ing one. However, if there is no requirement for ground return, it is typically more 
advantageous to use RF short such as a radial stub instead of DC short such as a 
ground via at the end of the line. 
5.3  Bias Network Design
A bias network is designed to combine both RF and low frequency ports. There 
should be no low-frequency path to the RF branch, but the DC input port must also 
appear as a RF open circuit at the junction to the through RF choke. 
The bias network plays a significant role in determining the operating state of 
RF PA, in particular the class of operation. In fixing the drain source or collector-
emitter current conduction angle, PA operation classes can be defined to establish 
power gain, linearity, efficiency, and saturated power. Because many critical RF PA 
specifications are either set directly or influenced indirectly by class of operation, 
an accurate control of the quiescent current over process, voltage, and temperature 
(PVT) is a key function of DC bias network. In addition to founding the quiescent 
state of the RF transistor, bias network affects PA linearity by memory effects due 
to parasitic. In addition, resonance phenomena that occur within the modulation 
bandwidth of the source signal will substantially impair its signal quality and there-
fore must be controlled by optimized video bandwidth. The bias network can also 
affect stability and be used for the establishment of optimal harmonic terminations 
for waveform-engineered PA design.
5.3.1  Classical Bias Network
The classical bias network is employed to isolate RF from DC supply to maintain 
stability at low frequencies. It defines the impedance at baseband and becomes 
more critical as the bandwidth of the signal increases. The bias network is typically 
designed with empirical methods. The bias network consists of two distinct parts, 
one driving the drain/collector and the other driving the gate/base as shown in 
Figure 5.12. The former is almost always passive while the latter may consist of an 
active network to compensate for PVT using feedback often referenced to factory 
calibration.
An RF bypass capacitor provides a high-quality short circuit, or sufficiently 
low reactance path to ground for the RF current components. On the output side, 

208 
������������������������������������
Power Amplifier for Envelope Tracking
there will be an intermediate biasing network which connects between the RF de-
coupling point and a local voltage supply in the form of a suitably large reservoir 
capacitor. On the input side, there is not such a requirement for a current reservoir, 
but for system interface purposes a bypass capacitor which appears as a near short-
circuit over the whole signal bandwidth is desirable. On the input side, to prevent 
oscillation, a series resistor is usually required between the separate RF and base-
band decoupling capacitors to “quench” the negative resistance due to the induc-
tive input termination [11]. The value of the series resistor has to be chosen such 
that stability conditions are met.
In its simplest form, the output bias network in Figure 5.12(b) could be simply 
a short length of wire or PCB trace, which shunts the RF bypass capacitor with 
the much larger reservoir capacitor. To minimize supply ripple for a high-power 
and wide-bandwidth application, typically a bank of capacitors with various val-
ues ranging from dozens of microfarads to nanofarads can be employed. With a 
Figure 5.12  Typical topologies of bias network for RF PA design. Resistor at gate/base improves 
stability, but is not desirable at the drain/collector because large impedance at baseband can result 
in drain/collector modulation or memory effects.

5.3  Bias Network Design 
209
multiple bypass network, the higher-frequency components of the device current 
can be supplied by lower value reservoir capacitors, which have a smaller physi-
cal size and thus a lower series inductance. Lower-frequency components require 
higher value reservoir capacitors, but a higher series inductance can be tolerated.
The Bessel-Thompson response is the phase response dual of the Butterworth 
maximally-ﬂat magnitude response, providing a maximally-ﬂat phase response, 
equivalent to a constant group delay. This property is attractive for use in wide-
band bias network synthesis where exceptionally high video bandwidth (VBW) is 
necessary to minimize linear distortion and its manifestation as intermodulation 
distortions and ACPR asymmetry. The standard reference for Bessel-Thompson 
bias network synthesis are [13, 14].
5.3.2  ET Feeding Line Bias Network
RF PA designs for the ET mode require nonstandard bias network design for band-
width [15]. Lots of PA bias tees implement the RF choke as a large-valued inductor, 
providing high impedance over a relatively broad bandwidth. However, such an in-
ductor has substantial impedance at the envelope bandwidth or VBW of ET, adding 
a voltage drop proportional to current slope. PAs for ET application therefore must 
use a narrowband RF choke. Such a choke could be implemented as a quarter-wave 
transmission line shorted at the drain supply side by a capacitor resonant at the 
fundamental frequency, as shown in Figure 5.13. At the transistor drain, the quar-
ter-wave transmission line acts to be open at the fundamental frequency and odd 
harmonics thereof, but presents negligible impedance at the envelope bandwidth.
A conventional bias tee likewise makes use of a bank of large shunt capacitors 
on the drain supply side to present low impedance at the envelope bandwidth, 
Figure 5.13  Envelope feeding line matching and RLC snubber for ET performance tradeoff.

210 
������������������������������������
Power Amplifier for Envelope Tracking
enhancing low-frequency stability. In an ET mode, the supply modulator would be 
enforced to drive the bias tee capacitance in parallel with the RF transistor, leading 
to high capacitor power losses, low supply modulator efficiency, and dramatically 
reduced modulator bandwidth. The large capacitance is removed in the ET ap-
plication. Remember that the supply modulator output impedance is ideally low 
over a bandwidth much larger than the envelope bandwidth, and thus presents low 
impedance to the RF transistor at low frequencies just as the bank of capacitors 
had previously. The stabilizing effect can be perceived when a PA operates under 
ET mode. With absence of the bias bypass capacitance, PA exhibits low-frequency 
oscillation when connected to a fixed DC drain supply, and nevertheless is stable 
when connected to a supply modulator output. The RF PA block diagram in Figure 
5.13 is demonstrated for the ET operation with careful considerations for supply 
feeding line design. Note that there is the quarter-wave line and fundamental fre-
quency resonant capacitor at the drain supply side of the line. However, in a case 
without the supply modulator present, additional shunt capacitance must be uti-
lized again for stability and to prevent the drain voltage from drooping or ringing 
once a current appears. Hence, in ET mode measurement, unlike the fixed supply 
test, the pulsed-RF measurement circuit is replaced with a supply modulator de-
vice, and all capacitors are removed from the drain supply network excluding the 
fundamental frequency resonant capacitor.
Unexpected increase in the RF PA transistor feeding line equivalent resistance 
happens while the envelope saturates at the smallest value permitted by the enve-
lope shaping function [15, 16]. The envelope shaping function would cause some 
kind of resistance variation in load impedance, which further results in envelope 
feeding line response changes. Therefore, an RLC-snubber circuit located on the 
end of the symmetrical feeding line could be employed to control the impedance 
of the feed line as presented in Figure 5.13. Inappropriate feeding line matching 
would lead to peaking effect on feeding line frequency response, which results in 
any residual envelope signal at those frequencies that give a rise to the noise floor 
in RF spectrum at the same frequency offset around the center frequency.
5.4  Waveform-Engineered Matching
A significant consequence of the large-signal operation of an RF transistor, defined 
as the load-line trajectory traversing from maximum current to maximum volt-
age, is substantial harmonic generation. Systematic and deliberate exploitation of 
this phenomenon is commonly referred to as waveform engineering, with well-
established theoretical methods in [18–20]. This section presents an abbreviated 
introduction of optimum harmonic termination theory followed by comprehensive 
treatment of optimum harmonic termination synthesis. The theory and practice of 
optimum harmonic terminations will be explored. With a time-domain treatment 
of RF PA, waveform engineering can be introduced to identify the optimal second 
and third harmonic termination for voltage and current waveform shaping, yield-
ing maximum PAE. Optimum harmonic termination design, easily implemented by 
frequency-domain methods, follows from the Fourier decomposition of a periodic 
signal to emulate a waveform exhibiting properties amenable to a desirable prop-
erty, such as high efficiency. Depending on the ratio of the PA operating frequency 

5.4  Waveform-Engineered Matching 
211
to the fT of the transistor, substantial improvements in efficiency can be realized by 
optimum second-harmonic termination, and to a lesser degree, optimum third-har-
monic termination. Similarly, substantial improvements in linearity can be realized 
by optimum envelope termination, a second-order mixing product, as it inﬂuences 
in-band linearity [21].
Modern RF PA design is forced to meet increasingly demanding system require-
ments and thus considerably more complex, high-efficiency modes of operation 
such as the black-box approach are becoming limited. This is because they require 
the systematic variation of many more parameters such as harmonic source and 
load impedances. Clearly, randomly optimizing so many variables becomes pro-
hibitive. The experimentally based design process could be made more efficient if 
coupled with waveform engineering. This is a good example of where RF wave-
form engineering can contribute significantly to both RF power transistor charac-
terization/development and RF PA design/optimization. The practical consequence 
of integrating RF waveform engineering with solutions that provide experimental 
engineering of the terminal impedances is that the engineering of the RF current 
and voltage waveforms can be experimentally monitored. Systematic experimental 
PA design investigations can now become waveform engineering driven, with the 
design goal finally becoming the realization of the theoretically derived optimum 
waveforms. 
5.4.1  Engineered Waveforms
Hence, waveform-engineered RF PA requires not only fundamental load-pull but 
also harmonic source-pull and load-pull. It highlights the fact that when investigat-
ing the behavior of a nonlinear DUT, impedance variation investigation should not 
be limited to the fundamental frequency alone. Note that, because there is a very 
strong interaction between all these parameters, it is essential during the process 
of waveform engineering via fundamental and harmonic impedance variation that 
the waveforms are continuously observed. It ensures that the load-pull variations 
are appropriately directed and thus minimizes the need to do systematic sweeps. If 
the stimulus signal is a CW signal, confining the problem to include spectral com-
ponents up to the third harmonic would provide for a band-limited RF waveform-
engineering compromise solution that is practical to realize. 
The coupling of the waveform measurement setup with impedance-controlling 
elements results into a typical waveform-engineering system. These systems are ca-
pable of measuring high-frequency waveforms in variable impedance environments 
at the terminals of the DUT. In principle, waveform engineering is the technique in 
which the current and voltage waveforms at the DUT’s terminals can be modified 
in a quantified manner to optimize the performance of the DUT. Through theo-
retical and experimental investigations, it has been established that the terminal 
current and voltage waveforms are the unifying link between transistor technol-
ogy, circuit design, and RF PA performance. Therefore, it is imperative to consider 
engineering of the waveform as fundamental force driving both the measurement 
and mathematical methods in the overall RF PA design process, that is, transistor 
optimization, circuit design, and system integration. The waveform-engineering 
technique can be applicable in the design evaluation loop of either power transistor 
technology or power amplifiers. This eliminates the black box design process and 

212 
������������������������������������
Power Amplifier for Envelope Tracking
allows for new intelligent design processes that are completely founded on theo-
retical waveform analysis. Alternatively, it can also indirectly support the amplifier 
investigation/evaluation loop by supporting the development or improving the ac-
curacy of nonlinear transistor models or by providing EDA accessible behavioral 
model parameter data sets.
In summary, from a nonlinear RF PA design perspective, the integration of RF 
waveform engineering capability, whether passive or active, with RF waveform 
measurement capability is essential. With such systems, the practical design of PAs 
achieved by directly employing the theoretically based waveform-engineering ap-
proach is now experimentally possible.
5.4.2  Harmonic Load-Pull
To the harmonically tuned PAs, the harmonic terminations play a key role in the 
design of switch mode RF PAs via waveform engineering. Device characterization 
for the optimal design of such high-efficiency RF PAs can be carried out using a 
harmonic load-pull system.
The terminal loading conditions at harmonic frequencies significantly affect 
RF PA performance. In principle, during the characterization and optimization of 
transistor devices, the harmonic power generated by the device needs to be fully 
reﬂected back at a given phase to realize the maximized efficiency. Theoretically, 
all the harmonic power can be reﬂected back; however, this is not possible in prac-
tical load-pull because of lossy transition between the tuner and the device. Dur-
ing the characterization of devices, it is a common practice to vary the phase and 
magnitude of the harmonic reﬂection coefficients while keeping the fundamental 
reﬂection coefficient constant to obtain optimal efficiency. The process of harmonic 
load-pull usually starts with fixed available source power and progressing to fixed 
load power. Final evaluation with harmonic load-pull is best done using fixed load 
power to minimize its inﬂuence on resolving maximum PAE.
The harmonic tuning methods can be compared primarily in two aspects, 
namely, the tuning isolation and the effective Smith chart coverage. An important 
factor of any load-pull device characterization system is the accuracy at which the 
impedance seen by the DUT at the fundamental frequency can be controlled. If 
the impedance changes cannot be kept constant for varying harmonic impedances, 
the measurement results obtained are invalid. Hence, when considering harmonic 
load-pull method for waveform engineering, it is vital to know the isolation across 
frequencies. The presence of substantial harmonic content under saturation, cou-
pled with a wideband power sensor, will affect the observed apparent PAE reported 
by load-pull versus PAE in the physical design that usually adopts a lowpass match-
ing network suppressing harmonics. 
The primary value of load-pull in management and analysis of nonlinearity is 
its singular ability to unambiguously and systematically resolve optimum harmonic 
terminations while simultaneously reconciling the effects such as relative phase of 
the transistor harmonics, internal parasitics, package, and external distributed ef-
fects. These effects work to induce a deviation from the ideal of the harmonic phase 
delivering optimum PAE and linearity. Almost all analysis of PAE improvement 
makes no distinction between the relative phases of the harmonics with respect to 
its fundamental. Harmonic load-pull is straightforward and powerful for empirical 

5.4  Waveform-Engineered Matching 
213
identification of the optimum harmonic termination. Thus, there may be a phase 
deviation from ideal even though the reference plane is set directly at the intrinsic 
active area of the transistor. The presence of internal matching, package delay, and 
external parasitics to the transistor effects will likewise diverge the harmonic phase 
from ideal. 
Harmonic load-pull and source-pull almost always occur following optimi-
zation at the fundamental and, like fundamental load-pull, requires iteration for 
convergence. Because the Fourier components of a signal are coupled in the sense 
that pre-optimum second-harmonic impedance termination may induce a small 
change in the optimum fundamental impedance termination, some iteration will 
be in general be necessary, especially in attempting to identify conditions for high 
PAE over 80%.
With harmonic load-pull for PAE and linearity enhancement in RF PA, the 
second-harmonic load-pull comes first. Though seldom necessary, the higher-order 
load-pull is treated brieﬂy. The second-harmonic load-pull for high PAE targets a 
high-reﬂectivity termination with respect to the fundamental impedance, although 
the effectiveness of harmonic termination depends more on the relative ratio of 
impedances at the fundamental and harmonics than the absolute value of the har-
monic termination impedance. The second-harmonic load-pull for optimum linear-
ity will generally target a high-reﬂectivity termination, although impedance states 
to the interior of the Smith chart can yield optimum linearity and should not be 
excluded from the exploration space. Second harmonic load-pull for signal-quality 
optimization will generally explore the entire Smith chart to ensure there are no 
optima in the interior. As with PAE optimization, it is often best to hold load power 
fixed or, alternatively, hold signal quality fixed and search for maximum power and 
PAE, as would be done when also identifying the optimum transistor size. Source-
pull is performed in a similar manner, although performance improvement will be 
more modest.
For the vast majority of applications, especially those where f0 ≈ 0.1fT, the 
second-harmonic load-pull provides virtually all PAE improvement possible, thus 
rendering the third-harmonic load-pull an optional second-order improvement. In 
those applications where f0 << 0.1fT or where maximum PAE is absolutely nec-
essary, the third-harmonic load-pull is warranted. The third-harmonic load-pull 
proceeds in an identical fashion to the second-harmonic load-pull, after optimum 
fundamental and second-harmonic terminations have been identified. Because in-
teraction exists between the harmonic components, essentially cross-modulation 
of each Fourier component, some iteration between fundamental and harmonic 
impedance optima is necessary. It is always recommended to visualize the inﬂuence 
of harmonic tuning and its effect on suppression or accentuation and the ﬂattening 
of the voltage or current waveform. The harmonics load-pull higher than the third 
order is only necessary in exceptional applications because there is a practical limi-
tation versus physical or mathematical limitation.
5.4.3  Physical Implementation
Optimally engineered waveforms are typically associated with SMPA classes as 
discussed in Chapter 1, whose underlying theoretical foundations are built on fre-
quency-domain physical implementation criteria. Optimum harmonic terminations 

214 
������������������������������������
Power Amplifier for Envelope Tracking
can be achieved straightforwardly by exploiting the isolation provided by the peri-
odic response of matching bias network over harmonics, which effectively decou-
ples the load impedance at the fundamental and harmonic impedance terminations. 
Decoupling also enables the ability to independently tune the impedance at the 
fundamental and harmonics, thereby providing an invaluable capability in empiri-
cal optimization of final performance. Alternatively, in those applications where a 
distributed-network feed cannot be used for bias, a lumped network can be added 
in parallel to the load network to synthesize optimum second harmonic impedance 
consisting of a shunt capacitor to ground resonant at the second harmonic. Isola-
tion from such a matching network and the fundamental frequency relies on high 
Q value, although some iteration may be necessary.
In exploiting the periodic response of the bias network, which presents an open 
circuit at the fundamental frequency, the drain sees the fundamental load imped-
ance provided by the matching network and a short-circuit at the second harmonic 
provided by the bias network. The bias network feed consists of a quarter-wave 
line terminated by a shunt capacitor to ground that is chosen to be series resonant 
somewhere between the fundamental and the second harmonic. In practice, isola-
tion is not complete, and mutual interaction exists between the load impedance 
provided by the matching network, the second harmonic of the matching network, 
and the second harmonic impedance of the bias network, thus requiring iteration 
with both simulation tools and with the physical implementation. This method can 
be extended to third-harmonic terminations using a similar approach.
With the criteria of optimum placement of the DC block and the bias feed, 
the bias feed has been placed at the low impedance node of the matching network 
to maximize the impedance ratio looking into the matching network and the bias 
network. The final result will ultimately depend on empirically moving the capaci-
tor on the transmission line as well as changing its value so as to obtain the desired 
frequency response at the fundamental and harmonics. Optimum harmonic imped-
ance termination design identifies results that are difficult in practice. No matching 
network is entirely decoupled between fundamental and harmonics, though match-
ing itself is seldom a limiting factor. Parasitic loss usually represents the limiting 
factor in synthesis of optimum harmonic terminations, which in practice will be 
bounded by a maximum gamma magnitude of length 0.95 to 0.98, depending on 
frequency, substrate quality, and passive component quality. 
A comprehensive theoretical and empirical framework of the optimum har-
monic termination has been built around the load-pull design method [22, 23]. It is 
possible for nearly cost-free and substantial improvements in peak PAE and linear-
ity by identifying the optimum harmonic terminating impedance at the load. With 
the notion of management versus analysis of nonlinearity, elementary theory can be 
used to locate a general area on the Smith chart for load-pull exploration, followed 
by extensive region-specific load-pull to identify the optimum performance and the 
impedances presenting such performance.
5.5  Class-P PA Design for ET 
Even with all the advantages of the reduced conduction angle linear RF PAs such 
as class-A/AB/B, the main problem of such PAs lies in the fact that it involves an 

5.5  Class-P PA Design for ET  
215
increase in the input RF signal with the reduction in the conduction angle if the 
peak current is to be maintained constant. As a consequence, the gains of such PAs 
get reduced, which limit the usefulness of these techniques in the design of PAs with 
devices possessing high gain. An alternative solution to enhance peak efficiency 
while overcoming the problems caused by harmonics present in the output of the 
PA is to provide drain current and voltage engineered shaping for achieving class-F, 
class-F−1, class-J, and class-P operation modes to obtain increased output power 
and peak drain efficiency for ET.
In all the discussed switch mode classes, there are some drawbacks for each 
one. Hence, one should find a compromise to achieve all the advantages of the 
classes. To maximize overall ET efficiency, high peak efficiency is desired for RF 
PA design. As discussed in Chapter 1, a design method of a class-P PA that can be 
realized by a simple harmonic termination topology and can deliver a high peak ef-
ficiency. However, this class was introduced in some of the literature with different 
names like saturated PA, but with the same operation.
In this design, the fundamental resistive load controls the amplitude and phase 
of self-generated harmonic currents. With the appropriate choice of the load, the 
desired voltage waveform can be generated by the harmonic load mainly of CDS 
fine-tuned by an additional load. Therefore, the added harmonic impedances have 
a high tolerance. The output capacitance creates a short-circuit at high-order har-
monic frequencies. In the saturated operation, the PA generates a large amount 
of the self-generated harmonic currents, which can be utilized for the waveform 
shaping. The harmonic voltages at the current source of the device depend on the 
harmonic impedances. The self-generated currents create the fundamental and har-
monic voltages as described in [27]. As a result, the current and voltage waveforms 
become quasi-rectangular and half-sinusoidal, respectively, similar to the class-F−1 
waveforms. These shaped waveforms minimize the overlap between the current 
and voltage waveforms, and efficiency of the PA is maximized.
5.5.1  Waveform Engineered Class-P
Waveform measurement and engineering systems are very useful in determining the 
appropriate matching impedance required at device ports to achieve the required 
performance. This performance is directly linked to the mode of operation (volt-
age and current waveforms) realized, which can be directly obtained. Through the 
independent control of bias and drive, one can engineer the shape of current wave-
forms, whereas the voltage waveforms can be engineered by varying the impedance 
through a load-pull system. Therefore, these systems can be utilized to achieve the 
target current and voltage waveforms obtained from theoretical analysis to reach 
the theoretically predicted performance. Once the desired performance is achieved, 
EDA tools can then be employed to design a suitable matching network. As an 
example, let us consider the first-pass design of a class-P high-efficiency PA based 
on GaN HEMT technology. Class-P is defined as a mode in which the voltage 
has harmonic components that make it behave asymptotically towards a half-wave 
rectified sine wave. This, in practice, can be usefully approximated by a suitably 
phased second-harmonic component. Therefore, a class-P PA can be realized by 
engineering the waveforms using appropriate fundamental and second-harmonic 
terminations, while the third- and higher-order harmonics shorted by the large 

216 
������������������������������������
Power Amplifier for Envelope Tracking
output Cds capacitance of the high-power GaN HEMT device. In this way, a higher 
fundamental component can significantly outweigh the loss in power implied by the 
reactive load. Consequently, class-P displays approximate bifurcated output current 
and half-wave rectified sinusoidal output voltage waveforms with a phase overlap 
between the two. The engineered waveforms achieved after systematic waveform 
optimization clearly demonstrate that the transistor can support the class-P mode 
of operation and, hence, deliver the expected RF output power along with very 
high power-added efficiency (PAE). In addition, once the targeted waveforms are 
achieved, the waveform-engineering system provides the desired input and output 
matching circuit impedances necessary at the fundamental frequency and second- 
and third-harmonic frequencies. Hence, all the information necessary is available 
to design an appropriate RF matching network and assemble the RF PA as shown 
in Figure 5.16. Once assembled and measured, the RF PA gives a measured perfor-
mance that is identical to that predicted, that is, a first-pass design success.
The class-P PA requires a slightly inductive load at the fundamental frequency 
and only capacitive load at the second harmonic. The first requirement is similar to 
that one in the class-E PA. However, class-P try to make fast switching transitions 
during the on and off state which reduces the losses and increases the efficiency, 
while in class-E the on transition switching has less losses than the off transition 
switching for sinusoidal drive signal. Also, class-F–1 requires an infinite number of 
resonators to achieve high efficiency, although most of the work is done by control-
ling up to the third harmonics. However, class-P can be realized by a simple har-
monic termination topology and deliver a high efficiency, requiring one resonator 
to control the second harmonic. In addition, it can be designed starting from any 
classic class of PA.
In the exemplary design, it shows that class-P PA can start from a class-AB PA 
at 900MHz band with a 48V 50W GaN HEMT transistor, fabricated on PCB with 
dielectric constant as 3.48, metal thickness 35 µm, substrate thickness 508 µm. The 
class-P PA design can be done in three steps as below.
5.5.1.1  Voltage Peaking
The first step is to use a class-AB/B PA design and intentionally block the sec-
ond harmonic as ZL(2 · f0) = ∞. The output power, power gain and efficiency will 
increase accordingly. This improvement in efficiency is because the PA transistor 
starts to act as a switch as the voltage waveform has higher second harmonic. Since 
waveforms are observed at package plane, some negative values may happen due to 
a parasitic effect or package and bonding wire modeling.
5.5.1.2  Fundamental Tuning Inductively
The next step is to tune the fundamental load to be slightly more inductive. Hence, 
higher efficiency can be achieved with the same power after the voltage peaking 
process. This fundamental tuning can give different shape for the drain current 
and reduces the dissipated power. The peaks in the drain current will not have the 
shape of the peaks in class-AB/B or the peaks resulting from the voltage peaking 
step because the load is inductive at the fundamental which makes the waveforms 
approach the ZVS condition. 

5.5  Class-P PA Design for ET  
217
5.5.1.3  Phase Adjustment
The final step is to adjust the relative phasing, (∠ Ids – ∠Vds)between the voltage 
and the current for the second harmonic by making the second harmonic load 
capacitive. However, the relative phasing is not purely capacitive for the second 
harmonic because the output capacitor for the transistor is not linear which de-
grades the desired +90° phase difference. The fundamental load impedance has a 
high positive phase, not exactly −90° phase because the real part is high compared 
to the inductive part.
In addition, two modifications are also required. The first is to reduce the gate 
bias voltage. This allows the current to have a low knee region and minimum volt-
age value during the on/off-state. The second modification is to increase the driving 
input power to achieve high efficiency with the maximum output power rating. 
The reduction in the losses is achieved at expense of the increasing drain peak volt-
age and the gain reduction compared to class-AB/B.
5.5.2  Physical Implementation
With the consideration of GaN HEMT features such as high breakdown voltage up 
to 250V, sufficient stress level to gain compression greater than 10 dB etc., investi-
gated in [28], it can be chosen as the candidate for ET operation in this exemplary 
design because of its ruggedness and reliability for high power applications. 
Various SMPAs for high efficiency had been reported in literature [11, 29], by 
utilizing harmonic tuning. However, to take maximum advantage of drain-source 
voltage under RF operation and obtain superior output power capability than 
class-E, a class-F–1 can be employed with a GaN HEMT transistor, which could 
provide the elegant area of safe operation (ASO) [29, 30]. However, considering 
the complex harmonic terminating matching network of class-F–1, class-P PA is 
selected for a simpler physical implementation.
Figure 5.14 shows the load impedance of 50-W GaN HEMT at 900 MHz. 
From the drain package plane, the load impedance was fully transformed to op-
timum impedance with matching and harmonic tuning circuits on the PCB. The 
slightly inductive fundamental load impedance is transformed to around optimum 
output power impedance (15.4 + j ·8.8) and optimum efficiency impedance (14.5 + 
j · 14.6) that can be obtained by load-pull measurement. After a trade-off between 
power handling and efficiency, the fundamental output impedance was designed 
as (8.4 + j · 10.7) at 900 MHz. The capacitive second-harmonic impedance is also 
transformed to low impedance but capacitive (13 – j · 41.8). The third-harmonic 
impedance is transformed into (0.7 + j · 1.2) as low impedance short to ground. 
Both the fourth- and fifth-order harmonic are all low impedance approaching to 
short to ground but capacitive from package plane matching. Successful harmonic 
termination does not require a precise short or open. Except on rare occasions, 
locating the harmonic termination within 10° of the optimum identified by the 
load-pull will yield adequate improvement while simultaneously enhancing PVT 
robustness.
The fundamental load and harmonic impedances induce both quasi half-sinu-
soidal voltage with an additional voltage peaking effect and quasi-rectangular cur-
rent shaping, as shown in Figure 5.15(a). Also, there is almost zero drain voltage 

218 
������������������������������������
Power Amplifier for Envelope Tracking
at the dip of the current, which means no lost power, whose waveforms look like 
class-F–1.
The load-line graph is shown in Figure 5.15(b), and it can be seen that the 
voltage has the minimum value during the on state, which reduces the losses. Com-
pared to the ASO line at the junction temperature of 200°, a sufficient margin can 
be observed by load line safely inside of the ASO region. Due to the packaged 
device used for design, the load lines were a little bit unlike the theoretical class-P 
with “looping character.” However, it is like a twist-looping character in terms of 
the internal parasitic in the package and bonding wires with a negative current 
peaking effect. It can provide better peaking and sinking effects by manipulations 
of the asymmetric current waveform engineering, which can further reduce the loss 
during low output power instances. ���������������������������������������������
In a practical design, compensation transmis-
sion lines for the parasitic of bonding wire inductance in series at a package plane 
can be considered. The microstrip compensation and matching network design can 
be designed and verified by large-signal model simulations at a package plane.
As shown in Figure 5.16, a hybrid-parameter matching network is chosen for 
physical implementation because it combines advantages of both lumped-parame-
ter and distributed-parameter methods. Synthesis of the hybrid-parameter match-
ing network exploits the unique ability of the Smith chart to simultaneously resolve 
lumped-parameter and distributed-parameter operations. In the most common 
Figure 5.14  The fundamental load-pull contours of the output power and PAE with the funda-
mental to fifth harmonic impedances. The second and third harmonic impedances that can provide 
the high efficiency are widely located so that the harmonic load impedances after Cds can be easily 
achieved for the class-P mode operation. 

5.5  Class-P PA Design for ET  
219
implementation, a series transmission line section is loaded by a shunt-lumped ca-
pacitance to replicate one or more lowpass L-section prototype sections of Figure 
5.4(a). Figure 5.16 demonstrates its distinct advantage of postfabrication ease of 
tuning by allowing real-time movement of shunt capacitance and rapid alteration 
of the characteristic impedance and electrical length of the transmission line. This 
tuning mechanism enables fine adjustments to be made to precisely replicate the 
target impedances obtained by the load-pull. Therefore, the primary effect of the 
hybrid-parameter implementation is a lumped capacitance shortening the transmis-
sion lines while providing the advantage of real-time tuning. This implementation 
is by far the most popular of modern PA implementations.
Another advantage of hybrid-parameter implementations is that the transmis-
sion line characteristic impedance of each section of the hybrid-parameter-matching 
network is a variable that is chosen from physical criteria of the matching network, 
such as the RF power transistor lead width. In contrast, with lumped-parameter 
Figure 5.15   (a) Time-domain current and voltage waveforms observed at package plane and (b) 
load lines of the class-P PA up to the third harmonic.

220 
������������������������������������
Power Amplifier for Envelope Tracking
Figure 5.16  Physical implementation of the hybrid-parameter matching network of the exemplary GaN HEMT class-P PA at 900 MHz, illustrating the soldering and 
moving chip capacitors for performance tuning.

5.5  Class-P PA Design for ET  
221
and distributed-parameter synthesis, the characteristic impedance of each transmis-
sion line section can be calculated from lumped-parameter constants L and C.
The class-P PA is designed with a printed circuit board with a dielectric con-
stant of 3.48, a 508-µm substrate thickness, and a 35-µm copper thickness. With a 
nominal 48-V drain voltage supply and biasing at a 660-mA quiescent current with 
gate bias voltage equal to −2.5V, the continuous wave (CW) excellent sweeping 
results with power at a center of 900 MHz. A 19.5-dB power gain can be observed. 
The 80% PAE can be obtained at 47 dBm with 5.5-dB gain compression, as shown 
in Figure 5.17.
In Figure 5.16, the design considers not only the nonlinear output capacitance 
of GaN HEMT transistor on harmonic control, but also the bonding wire induc-
tance in series, by which more precise trimming for harmonics can be considered 
and implemented. Typically, the matching-network insertion loss has a large and 
direct inﬂuence on PAE. Although a substantial effort is expended in extracting 
as much efficiency from the PA as possible, the use of low-quality passive com-
ponents, as reﬂected by a relatively larger capacitor and inductor ESR or a higher 
substrate loss tangent, can reduce or eliminate any gains achieved by either load-
pull optimization or harmonic termination optimization. The differential expense 
added by high-performance matching-network components is far lower than trying 
to achieve high efficiency through advanced architectures and expensive transistor 
technologies.
Besides CW characteristics including efficiency, linearization capability should 
be studied by means of memory effect and digital predistortion (DPD) linearizing 
results. Memory effects of the design could be observed by AM-AM and AM-PM 
scattering characters in Figure 5.18 with black circles. Vast scattering points or 
serious memory can be observed due to a nonlinear class-P switch mode operation. 
However, this kind of memory effect can be made to be linear and mitigated to a 
huge extent by DPD as shown in Figure 5.18 with gray dots. With an LTE 20-MHz 
signal clipped into 6.6 dB and being linearized with memory polynomial DPD, 
42% average efficiency can be achieved with an average 39-dBm output power 
Figure 5.17  Power-added efficiency and power gain versus fundamental output power of the ex-
emplary class-P RF PA.

222 
������������������������������������
Power Amplifier for Envelope Tracking
with an ACPR of −45 dBc after DPD, which demonstrates outstanding lineariza-
tion capability with superior efficiency performance with fixed 48-V DC supply.
5.5.3  Design for ET
Unlike the video bandwidth difficulty suffered from bias network design for a 
fixed DC supply PA [31], especially when modulation bandwidths extend into the 
megahertz region, the video bandwidth of ET PA is totally provided by the supply 
modulator. To apply the class-P RF PA in Figure 5.16 to an ET system, the first re-
quirement is the removal of banks of large capacitors in the drain supply network. 
However, the PA performance requires reoptimization by tuning the fundamental 
inside of the internal prematch circuits. The second-harmonic fine-tuning can be 
Figure 5.18  AM-AM and AM-PM response before and after DPD with a 20-MHz LTE signal at a 
39-dBm output power.

5.6  Driver Design for ET Lineup 
223
achieved by varying the position of C3 and C4 to change the length of the bias line 
on the input and output on-board matching circuits. Figure 5.16 shows the class-P 
RF PA test fixture and bias line adjustment setup.
However, under fixed DC supply conditions, power-sweeping measurement 
with various drain supply voltages can be employed to estimate the performance 
of the class-P PA for ET operation via both efficiency and gain trajectory as shown 
in Figure 5.19, whose supply voltage ranges from 20- to 50-V with a 2-V step. 
Because ET PA operates in compression over the majority of the envelope cycle, 
system linearity determined by the relationship between supply voltage and RF 
output power can be evaluated through the gain trajectory. Also, this ET trajectory 
can be used to select and verify the envelope shaping function effect to compromise 
efficiency and linearity.
Therefore, the class-P GaN HEMT PA operating on a 48-V high voltage is 
optimized for ET applications not only with high peak efficiency but also superior 
gain-efficiency trajectories compared to 28-V GaN HEMT and GaAs HBT coun-
terparts [32].
5.6  Driver Design for ET Lineup
With high-efficiency transistor technology such as GaN HEMT, the seriously com-
pressed power gain of single-stage ET cannot maintain the radio transmitter lineup 
PAE to be sufficiently improved. However, although the ET PA coupled only to a 
power stage improves efficiency by reducing the supply voltage in the power stage, 
the power consumption in the drive stage also significantly affects the overall ef-
ficiency at a low output power. In addition, the efficiency of the driver PA should 
be maximized by choosing the proper size of the driver depending on the gain and 
Figure 5.19  Gain-efficiency trajectory of exemplary GaN HEMT class-P PA.

224 
������������������������������������
Power Amplifier for Envelope Tracking
power level of the final-stage PA. For this purpose, multiple-stage PAs can be inves-
tigated. The ET lined up on both driver amplifiers and the final stage is capable of 
boosting the overall lineup of PAE. Consequently, the multistage ET PA lineup can 
provide more improvement in radio efficiency, resulting in more profits available in 
a wireless system by cutting overall costs to operate the system, especially for high 
output power BTS application scenarios. However, although it is highly desired to 
enhance the efficiency of the driver amplifier by ET, choosing the correct transistor 
with proper characters and designing with considerations are critical to making a 
good match between the ET driver and the final stage to maximize the performance 
of the lineup.
5.6.1  PAE Lineup
With regard to the PA lineup in Figure 5.20, the lineup PAE equation can be de-
duced as
	
1
100%
1
100%
out
in
DC
P
P
PAE
P
G
η
−


=
×
=
×
−
×




	
(5.8)
	
2
1
1
2
1
1
2
1
2
1
2
1
100%
100%
out
in
Line Up
DC
DC
P
P
G
G
PAE
G
G
G
P
P
η
η
−
−
⋅
−
=
×
=
×
⋅
+
+
	
(5.9)
According to the final stage design, the typical value of ET PA final stage can 
be assumed as constants, G2 = 11 dB, η2 = 62% for the final stage. Therefore, the 
contribution of efficiency and gain of driver amplifier to ET PA line up can be plot-
ted in Figure 5.21.
In high-power gain scenarios, for the single-stage PAE in Figure 5.21, there is 
a quasi-linear relationship between PAE and its drain efficiency, where the PAE 
Figure 5.20  ET PA lineup block diagram including supply modulator schematic.

5.6  Driver Design for ET Lineup 
225
would drop dramatically if the ET drain efficiency dropped. However, if a two-
stage lineup is applied, that relationship would be transformed into a constant 
between the lineup PAE and its drain efficiency in Figure 5.21, which means that 
the lineup PAE would remain high and tolerate more drain efficiency degradations. 
Also, due to the lineup gain increase, there is a minor PAE drop for a low-gain, 
final-stage case when a lineup is applied, compared to a single-stage ET PA, as 
shown in Figure 5.21. In conclusion, a lineup configuration for high efficiency ET 
PA is essential for practical applications and the ET driver amplifier design deserves 
more sophisticated design considerations.
5.6.2  Lineup Implementation
In traditional RF PA design, the lineup analysis delivers its associated performance 
requirements for each stage of PA when cascaded together. The precise quantita-
tive clarification of the requirements of each stage establishes the goals necessary 
in seeking optimum transistor performance and the associated impedance termi-
nations. The systematic approach of decomposition greatly simplifies the RF PA 
design and integration process by unambiguously identifying optimum transistor 
performance and how to replicate by appropriate methods of matching network 
design.
Three aspects are required to populate the lineup analysis. The first aspect pro-
vides an estimate of the nominal and extreme power and gain points of each stage, 
with terminal empirical values ultimately coming from the load-pull measurement. 
An estimate of the matching-network performance forms the basis of the second 
aspect, with insertion loss being the most significant metric. The final aspect is 
formation of a corner-model matrix to emulate PVT behavior of each stage, as well 
as design-rule stress and predicted manufacturing variation. A successful lineup 
analysis rarely terminates with one pass, generally requiring several iterations to 
identify the optimum distribution of gain and power for each stage. In multiple-
stage ET considerations, a lineup analysis should also be conducted to appraise 
Figure 5.21  Lineup PAE character plot versus driver amplifier power gain and its drain efficiency.

226 
������������������������������������
Power Amplifier for Envelope Tracking
the overall linearity of the RF PA and the associated linearity requirements of each 
stage. Because mixing products are complex, the linearity lineup is somewhat more 
challenging to carry out. 
References
[1]	
Cripps, S. C., “A Theory for the Prediction of GaAs FET Load-Pull Power Contours,” 1983 
IEEE MTT-S International Microwave Symposium Digest, 1983, pp. 221–223.
[2]	
Ghannouchi, F. M., and M. S. Hashmi, Load-Pull Techniques with Applications to Power 
Amplifier Design, New York: Springer, 2012.
[3]	
Verspecht, J., and D. E. Root, “Poly-Harmonic Distortion Modeling,” IEEE Microwave 
Theory and Techniques Microwave Magazine, June 2006, pp. 1–3.
[4]	
Verspecht, J., et al., “Multi-Tone, Multi-Port, and Dynamic Memory Enhancements to 
PHD Nonlinear Behavioral Models from Large-Signal Measurements and Simulations,” 
IEEE MTT-S Int. Microwave Symp. Dig., Honolulu, HI, June 2007, pp. 969–972.
[5]	
Verspecht, J., et al., “Extension of X-Parameters to Include Long-Term Dynamic Memory 
Effects,” IEEE MTT-S International Microwave Symposium Digest (MTT ’09), 2009, pp. 
741–744.
[6]	
Simpson, G., et al., “Load-Pull + NVNA = Enhanced X-Parameters for PA Designs with 
High Mismatch and Technology-Independent Large-Signal Device Models,” 72nd ARFTG 
Conference, December 9–12, 2008, pp. 88–91.
[7]	
http://www.agilent.com/find/nvna.
[8]	
Raghavan, A., N. Srirattana, and J. Laskar, Modeling and Design Techniques for RF Power 
Amplifiers, New York: Wiley, 2007.
[9]	
Schreurs, D., et al., RF Power Amplifier Behavioral Modeling, New York: Cambridge, 
2009.
[10]	
Gilmore, R., and L. Besser, Practical RF Circuit Design for Modern Wireless Systems, Vol-
ume II: Active Circuits and Systems, Norwood, MA: Artech House, 2003.
[11]	
Cripps, S. C., RF Power Amplifiers for Wireless Communications, Norwood, MA: Artech 
House, 2006.
[12]	
Kazimierczuk, M. K., RF Power Amplifiers, New York: Wiley, 2008.
[13]	
Matthaei, G. L., L. Young, and E. M. T. Jones, Microwave, Filters, Impedance-Matching 
Networks, and Coupling Structures, Dedham, MA: Artech House, 1980.
[14]	
Thomson, W. E., “Networks With Maximally Flat Delay,” Wireless Engineer, Vol. 29, Oc-
tober 1952, pp. 255–263.
[15]	
Jeong, J., et al., “High-Efficiency WCDMA Envelope Tracking Base Station Amplifier Im-
plemented with GaAs HVHBTs” IEEE Journal of Solid-State Circuits, Vol. 44, No. 10, 
October 2009, pp. 2629–2639.
[16]	
Aitto-oja, T. M., “High Efficiency Envelope Tracking Supply Voltage Modulator for High 
Power Base Station Amplifier Applications,” 2010 IEEE MTT-S International Microwave 
Symposium Digest (MTT), 2010, pp. 668–671.
[17]	
Colantonio, P., F. Giannini, and E. Limiti, High Efficiency RF and Microwave Solid State 
Power Amplifiers, New York: Wiley, 2009.
[18]	
Cripps, S. C., Advanced Techniques in RF Power Amplifier Design, Norwood, MA: Artech 
House, 2002.
[19]	
Bostian, D. K. C., and F. H. Raab, Solid-State Radio Engineering, New York: McGraw-
Hill, 1980.
[20]	
Maas, S. A., Analysis of Nonlinear Microwave Circuits, Norwood, MA: Artech House, 
1988.

5.6  Driver Design for ET Lineup 
227
[21]	
Sevic, J. F., and M. B. Steer, “A Novel Envelope Termination Method for ACPR Optimiza-
tion of RF and Microwave Power Amplifiers,” IEEE Transactions on Microwave Theory 
and Techniques Symposium Digest, 1998, pp. 1–3.
[22]	
Tasker, P. J., “Practical Waveform Engineering,” IEEE Microwave Magazine, Vol. 10, 
2009, pp. 65–76.
[23]	
Tasker, P. J., “RF Waveform Measurement and Engineering,” IEEE Compound Semicon-
ductor Integrated Circuit Symposium, 2009, pp. 1–4.
[24]	
Sheppard, R. P. S., and B. Pribble, “High Efficiency Amplifiers Using AlGaN/GaN HEMTs 
on SiC,” CS MANTECH Conference, 2006, pp. 1–3.
[25]	
Raab, F. H., “Class E, C, and F Power Amplifiers Based on a Finite Number of Harmon-
ics,” IEEE Transactions on Microwave Theory and Techniques, Vol. 49, No. 8, August 
2001, pp. 1462–1468.
[26]	
Kim, J., et al., “A Novel Design Method of Highly Efficient Saturated Power Amplifier 
based on Self-Generated Harmonic Currents,” IEEE European Microwave Conference 
(EuMC), September 2009, pp. 1–4.
[27]	
Colantonio, P., et al., “Multi Harmonic Manipulation for Highly Efficient Microwave 
Power Amplifiers,” Intl. J. RF Microwave Computer-Aided Engineering, Vol. 11, No. 6, 
2001, pp. 366–384.
[28]	
Inoue, K., et al., “Ruggedness and Reliability of GaN HEMT,” European Microwave Inte-
grated Circuits Conference (EuMIC), 2011, pp. 328–331. 
[29]	
Iwata, M., “First Pass Design of a High Power 145W, High Efficiency Class-J GaN Power 
Amplifier Using Waveform Engineering,” 2013 IEEE Topical Conference on Power Ampli-
fiers for Wireless and Radio Applications (PAWR), 2013, pp. 7–9.
[30]	
Matsunaga, K., et al., “A 72% PAE, 95-W, Single-Chip GaN FET S-Band Inverse Class-F 
Power Amplifier with a Harmonic Resonant Circuit,” IEEE MTT-S International Micro-
wave Symposium Digest, 2012, pp. 1–3.
[31]	
Lucyszyn, S., “Power-Added Efficiency Errors with RF Power Amplifiers,” International 
Journal of Electronics, Vol. 82, No. 3, March 1997, pp. 303–312.
[32]	
Wang, Z. C., et al., “Driver Amplifier Design Considerations for High Efficiency Envelope 
Tracking Power Amplifier Line-Up,” 2012 IEEE 13th Annual Wireless and Microwave 
Technology Conference (WAMICON), 2012, pp. 1–8.
[33]	
Son, J., et al., “Sequential Digital Predistortion for Two-Stage Envelope Tracking Power 
Amplifier,” IEEE Microwave and Wireless Components Letters, Vol. 23, 2013, pp. 
620–622.
[34]	
Kim, J., et al., “Envelope-Tracking Two-Stage Power Amplifier with Dual-Mode Supply 
Modulator for LTE Applications,” IEEE Transactions on Microwave Theory and Tech-
niques, Vol. 61, 2013, pp. 543–552.
[35]	
Daehyun, K., et al., “Envelope-Tracking Two-Stage Power Amplifiers,” Microwave 2011 
European Integrated Circuits Conference (EuMIC), 2011, pp. 644–647.


229
C H A P T E R  6 
Digital Front End Design for Envelope 
Tracking
The continuing rapid advances in digital signal processing (DSP) have led to the 
widespread use of digital techniques to displace analog systems. In merging differ-
ent air interface standards into a single equipment architecture, a software-defined 
radio (SDR) approach can be used to realize that a single hardware solution can 
provide a very flexible use of multiple frequency bands and multiple standards. The 
frequency bands can easily be changed by software without hardware modifica-
tion, giving network operators considerable flexibility. The SDR approach divides 
the transmitter front end into a dedicated and a common part. The dedicated part 
is an independent analog front end (AFE), made of RF PA and the antenna. This is 
necessary because the wide frequency range and the different performance classes 
must be supported. The common part typically comprises signal processing units, 
the converters, the frequency conversion circuitry, the clock generation, and the 
distribution unit. Nevertheless, it is useful to introduce the concept of the digital 
front end (DFE) here.
6.1  Digital Front End
The concept of DFE was introduced toward the end of the last century [1]. Modern 
transmitters commonly allow  the signal processing stages between the antenna and 
the base band DSP to be grouped at the front end of the transceiver. Historically, the 
term front end was applied to the very part of a transceiver mounted in the vicinity 
of the antenna. It provided a signal having an intermediate frequency (IF), which 
was conducted along a wire line from the back end. The backend may have been 
disposed apart from the antenna. Somewhat undermined in the current context, the 
term front end has been extended to the transmitter portion of a transceiver. The 
functionality of the front end is derived from the characteristics of the signals at its 
input and output. Some parts of the RF-related processing can be implemented in 
the analog domain and other parts in the digital domain. This leads to a differentia-
tion of AFE and DFE shown in Figure 6.1. Thus, the DFE is part of the front end. It 
performs front end functionalities digitally together with the ADC/DAC, bridging 
the analog RF on one side and IF digital processing on the other side.

230 
����������������������������������������������
Digital Front End Design for Envelope Tracking
The functionalities of a transmitter DFE are shown in Figure 6.1. Because 
the DFE should take as many tasks as possible from the AFE in a SDR, the DFE 
function blocks are very similar to the function of the front end in general. The 
downlink portion contains a single-rate channel filter, a digital upconverter (DUC), 
and a crest factor reduction (CFR) module for decreasing the PAPR of signal. For 
single-carrier configurations, DUC consists of several stages of interpolation filter-
ing and no mixer is needed. However, for multicarrier configurations, a mixing and 
combining stage is necessary to allocate an individual carrier to its relative position 
before further processing.
The boundary of digital and analog processing has stopped at the RF PA during 
SDR aggression. However, a real SDR solution can be achieved if the ET PA will 
eventually be defined digitally. At this point, SDR can offer a wide range of DFE 
solutions to enhance ET PAs. It can provide signal de-cresting, timing alignment, 
predistortion, and quadrature modulation calibration and ET-specific envelope 
generation and shaping that can be adapted to a wide range of tailor-made solu-
tions for ET, as shown in Figure 6.2.
As shown in Figure 6.2, the DFE functionality is developed mainly for signal 
character and quality aspects. Therefore, the modern ET DFE algorithms can be 
divided mainly into five categories. CFR and digital predistortion (DPD) can be 
performed digitally to optimize efficiency while meeting ACPR and EVM require-
ments. Envelope shaping is employed to modify signal characters to compromise 
various performance metrics and interactions among parts. The other group of 
algorithms is required to compensate the nonidealities of the system during imple-
mentations such as quadrature modulation error and timing mismatch.
6.2  Crest Factor Reduction
As we all know, the efficiency of an RF PA is a function of the transmitted signal. 
A high-PAPR signal imposes significant operating restrictions on the RF PA. To 
handle the signal peaks, it is backed off from its most efficient operating point. Gen-
erally, CFR can be realized by an output power compression through a higher input 
Figure 6.1  A typical modern digital transmitter with digital front end. It illustrates the digital front end archi-
tecture for transmit downlink for BTS application. The common zero intermediate frequency (IF) architecture 
is assumed.

6.2  Crest Factor Reduction 
231
driving power. However, this type of hard clipping would severely degrade EVM 
and ACPR due to serious distortions. Therefore, to increase the efficiency, CFR 
algorithms can be used in DFE to reduce the PAPR of signal before entering RF PA 
as shown in Figure 6.3. By this means, it allows additional gain at the output so as 
to operate closer to compression region of PA with less back-off for more efficient 
amplification as shown in Figure 6.4.
Besides CFR constraining the crest of the modulated signal into PA to make 
operation possible in the higher-efficiency region, the benefit of CFR algorithm to 
ET PA efficiency is also obvious. Because the modulation schemes at baseband are 
becoming more complex, the PAPR is becoming higher and moving toward the 
low-power region in the probability density function (PDF) plot. However, CFR 
is capable to move it toward the higher-power region slightly, avoiding RF PA 
suffering from too much back-off resulting in average efficiency degradations. In 
ET scenarios, CFR can make the PDF histogram shape more fit for the efficiency 
Figure 6.2  Category and functionality of digital algorithms for ET PA.
Figure 6.3  Illustrations of digital front end design blocks for the envelope tracking system.

232 
����������������������������������������������
Digital Front End Design for Envelope Tracking
trajectory of an RF PA transistor with various drain/collector voltages as shown in 
Figure 6.5.
As shown in Figure 6.5, about 6-dB movement of PDF peak toward the high-
power region can be observed. The probability of occurrence in the smaller back-
off region has increased significantly. Thereafter, the well-clipped modulated signal 
will better fit into the shape of ET PA trajectory to obtain higher average efficiency. 
Furthermore, in the ET PA system, the PDF versus supply modulator output volt-
age plot reveals the effects of CFR to supply modulator performance, as shown in 
Figure 6.6.
In Figure 6.6, the modulated signal without clipping will be distributed into 
the low-voltage region centered with ~13V. This response of PDF is much lower 
Figure 6.4   (a) Waveform clipping under CFR and (b) effects on RF PA transfer function charac-
teristic with CFR. CFR can improve the efficiency by increasing the average output power as well as 
helping to meet the ACPR and EVM requirements.

6.2  Crest Factor Reduction 
233
and narrower than the clipped ones. However, the clipped versions of the signal 
are approaching the average output voltage value of the supply modulator. From 
Figure 6.5  ET efficiency trajectories plotted in dashed line for the RF PA with supply voltage ranging from 
7V to 28V. The maximum CW output power can be normalized into 0 dBm to easily compare it with differ-
ent clipped PAPRs for the LTE 20-MHz signal ranging from 5.5 dB to no clipping scenario. (From: [1]. © 2012 
IEEE. Reprinted with permission.)
Figure 6.6  The PDF of various clipping ratio of the LTE 20-MHz signal versus ET supply modulator output 
voltage. (From: [1]. © 2012 IEEE. Reprinted with permission.)

234 
����������������������������������������������
Digital Front End Design for Envelope Tracking
the RF transistor perspective, a much flatter response of PDF over the operation 
voltages could provide much better linearity due to the P1dB point moving into a 
high-power level dynamically. In other words, the ET PA could provide more ef-
ficient power conversion with the same linearity metrics. With considerations of 
transistor cost, the supply modulator operation with the clipped signal will cover 
higher voltages with greater probability. This could draw out more power from the 
transistor than the lower-voltage operation ET PAs, during efficient amplification 
and make a trade-off with the linearity specifications. Therefore, CFR is capable to 
further optimize ET PA performance.
There are typically two types of CFR according the arrangement: baseband 
or digital IF. The key difference is whether there is a DUC placed before CFR. 
Baseband CFR can be achieved with better ACPR performance compared to the IF 
counterpart, but worse PAPR reduction effect because the peak regrowth phenom-
ena after DUC and other DSP blocks would weaken the final results. However, the 
digital IF CFR can prevent the peak regrowth problem by arranging CFR at last 
so that all the peaks regrowth can be reduced by CFR. However, digital IF CFRs 
often have worse ACPR and more complex digital filters design, especially when 
considering predistortion techniques to reserve extra bandwidth.
Therefore, various CFR techniques have been proposed such as constellation 
extension (ACE) [12, 13], selective mapping (SLM), partial transmit sequence 
(PTS), and tone reservation (TR) [11, 14]. These baseband CFRs often require 
additional processing at the receiver and interaction with the baseband processor 
to manipulate the modulated signal. Unfortunately, they suffer from significant 
implementation difficulties or specific requirements for certain standards, in other 
words, not for general purposes. Although many other methods exist that operate 
after the DUC, four of the methods are introduced in this chapter as peak win-
dowing (PW-CFR) [9], noise shaping (NS-CFR) [10], peak cancellation (PC-CFR) 
[17, 19–21], and constrained clipping (CC-CFR) [22–24]. The advantages of those 
methods are that they are general purpose. All of them can be seen as part of DFE 
of a transmitter.
6.2.1  Threshold and Metrics
The CFR threshold determines the maximum magnitude of the complex signal at 
the output of CFR block. Any peak that exceeds the threshold is a candidate for 
clipping. Therefore, CFR thresholds must be in accordance with its input data pre-
cision that is a function of both the target PAPR reduction and the magnitude vari-
ance of the complex signal. However, because the CFR reduces the average power, 
the PAPR of actual output is generally higher than the predetermined target value. 
The threshold is usually a run-time configurable parameter whose actual floating 
value is scaled and truncated for DSP implementation.
For the RF PA design, the key performance indicators of the CFR algorithms 
are clipping ratio, ACPR, and EVM deteriorations in DFE section. Clipping ratio is 
defined as the clipping threshold divided by the standard deviation of the signal. As 
a nonlinear operation, CFR obviously distorts the signal and the EVM and ACPR 
performance is reduced. EVM and ACPR degradation represent the CFR impact on 
in-band modulation quality and out-of-band linearity, depending on the type of the 

6.2  Crest Factor Reduction 
235
CFR. EVM degradation is caused by the clipping effect of CFR that can be spread 
to the samples adjacent to the sample to be clipped. However, there is always a 
trade-off relationship between EVM and ACPR in CFR processing.
As mentioned above, compared to the baseband CFR, implementations in the 
digital IF are somewhat less efficient. Although ACPR degradation can be allevi-
ated by a bandpass filtering after the CFR operation, a very high order of band-
pass is needed to achieve a relatively small improvement. Also, the peak regrowth 
caused by the filter can be a regenerated problem worsening the clipping ratio and 
the EVM performance again.
6.2.2  Peak-Windowing CFR
The conventional “hard” clipping method can be considered as a multiplication 
between the original signal x(n) and the scaling factor c(n). When an input signal 
has a magnitude greater than a threshold value A, it is scaled down to the threshold 
A, while the signal phase information is retained. Hence, the transfer function can 
be expressed as follows
	
1
,
( )
( )
( )
( ),where ( )
( )
( )
cfr
x n
A
x
n
c n
x n
c n
A x n
x n
A

≤
=
⋅
= 
>

	
(6.1)
A direct hard clipping process is simple, but it creates a rigid limit on the mag-
nitude of the signal with sharp corners in the time domain waveform to what 
spectral distortion can be observed as degraded ACPR. Hard clipping also causes 
time-domain distortion that directly increases the EVM. Because hard clipping 
would significantly increase the out-of-band emissions and in-band modulation 
error, more effective peak-windowing CFR (PW-CFR) has been proposed by mul-
tiplying large signal peaks with certain windowing functions [2–5], in which the 
signal is attenuated in the area of each peak. Instead of using a more sophisticated 
scaling method, PW-CFR simply multiplies large signal peaks above the threshold 
with a windowing function to smooth the sharp edges and provides good spectral 
properties to the output signal. Theoretically, any type of window functions can be 
used, but the spectral regrowth are quite different. Therefore, spectral emission is 
an important metric to select the proper processing window.
As shown in Figure 6.7, PW-CFR compares the magnitude of the input signal 
with the clipping threshold to calculate the clipping function c(n). Then it clips 
the delayed input signal with the smooth windowing scaling factor b(n). After the 
multiplication, the magnitude of the peak is below the desired threshold. With PW-
CFR, the filter coefficients remain the same for both single and multicarrier cases, 
but it can require a large filter. More specifically, the algorithm uses the windowed 
scaling factor b(n) to replace c(n) in the hard clipping method to substitute in (6.1) 
in such a way that
	
( )
1
(
),where ( )
( )
k
k
b n
a
w n
k
b n
c n
∞
=−∞
=
−
⋅
−
≤
∑
	
(6.2)

236 
����������������������������������������������
Digital Front End Design for Envelope Tracking
where w(n) is the window function, ak is a weighting coefficient, and b(n) must 
satisfy the inequality not greater than c(n).
In a practical system, the smooth clipping function can be implemented so that 
the clipping signal is smoothed by the feedforward and feedback signals [5]. b(n) 
can be formed by the combination of an FIR filter in a feedback structure. The 
feedback structure scales the incoming values, if necessary, to prevent overclipping 
[5]. 
PW-CFR could be the candidate for the most cost-effective solution to reduce 
PAPR, which consumes very few hardware resources. It once was widely used be-
cause it does not require side information or change in the receiver structure. It 
does not cause loss of data rate for encoding or reserving tones nor does it require 
extensive computation for iterative projection between the frequency and time do-
mains. Based on the notion of smooth attenuation of peaks to avoid sharp corners 
caused by direct hard clipping, PW-CFR produces much smaller out-of-band emis-
sions than hard clipping but with comparable complexity.
Available window function candidates are cosine, Hamming, Hann, Blackman, 
Blackman-Harris, Kaiser, and Gaussian. Typically, the narrower window, the high-
er the performance. However, as the multiplication in the time domain is the dual 
of convolution in the frequency domain, the spectral leakage of PW-CFR can be 
controlled by the length and the type of window used. A long window in the time 
domain results in better spectral performance, but at the expense of the increased 
EVM in that many signal samples are affected. Conversely, it results in a lower 
EVM but causes more spectral leakage for a shorter window.
Conventional PW-CFR treats each peak by a common symmetric window 
weighted with the height of peak above the clipping threshold, and the total win-
dow function is the superposition of the sequence of all peak windowing functions. 
However, an excessive damping may occur because of the convolutional summa-
tion at all time instances. Unfortunately, when successive peaks cluster together, 
neighboring peak windowing functions would overlap to cause an overdamping 
effect.
Figure 6.7  Illustration of peak windowing CFR block diagram. It is improved from hard clipping and serves 
as a kind of Cartesian clipping; hence, the in-phase and quadrature components are clipped independently. 
Post-CFR bandpass filtering can be applied to soften the spectral leakage caused by clipping. (From: [97]. © 
2009 IEEE. Reprinted with permission.)

6.2  Crest Factor Reduction 
237
6.2.3  Noise-Shaping CFR
While the PW-CFR method looks promising, it was found to have weaker perfor-
mance than noise-shaping method depicted in [10, 15, 16]. Noise-shaping CFR 
(NS-CFR) can provide greater PAPR reduction compared to the PW-CFR method 
with comparable ACPR and EVM degradations.
Compared with Cartesian clipping such as PW-CFR, polar clipping can clip the 
magnitude of the signal while preserving the phase. Although either method can be 
used to constrain the PAPR of the signal, it has been found that the polar clipping 
provides better results with respect to the distortions.
NS-CFR reduces the PAPR by subtracting a spectrally shaped clipping error, 
wherein the clipping error is the difference between the clipped signal and the origi-
nal one. A significant advantage of NS-CFR over the PW-CFR is that there is a bet-
ter control of the spectral properties of the output signal. The noise-shaping filter 
employed can remove most of the unwanted out-of-band distortions. Furthermore, 
the EVM versus clipping ratio performance is similar to that obtained for PW-
CFR. For these reasons, NS-CFR is the superior solution for high-PAPR signals, 
especially for multicarrier application scenarios, in the condition that the hardware 
resource is sufficient.
As shown in Figure 6.8(a), the first step in NS-CFR is to polar clip the magni-
tude of the complex signal. Polar clipping limits the magnitude to a threshold value 
while maintaining its phase. It compares the magnitude squared of the complex 
signal to the square of the threshold. When the result is smaller than the threshold 
squared, the original signal passes to the output. Otherwise, the output of polar 
clipping is a scaled version of the signal corrected to the threshold value. By select-
ing an appropriate threshold, the PAPR of the signal can be maintained at a desired 
level.
The output of the polar clipping is subtracted from the original signal to gener-
ate a clipping error signal, defined as clipping noise. Because the clipping process is 
not linear, the clipping noise tends to have a very broad spread spectrum. Keeping 
the spectral emission requirements of the system, the spectrum of the clipping noise 
can be limited by a noise-shaping filter (NSF) right in the same band. The NSF for 
a multicarrier multiband filtering is presented in Figure 6.8(b). Unfortunately, the 
ACPR improvement is obtained at the expense of a discounted clipping ratio and 
EVM degradations. The NSF process is to downconvert each band of interest to 
DC for a lowpass FIR filtering to confine the clipping noise to the same spectrum as 
the single carrier of interest. Then the filtered noise will convert back up to its cor-
responding carrier frequency. The sharp peaks of clipping noise can be smoothed 
by the NSF. The spectral clipping noise is directly related to the clipping threshold. 
Therefore, the clipping threshold determines the level of noise spectrum that com-
bines with systematic ACPR requirements to further determine the properties of 
NSF. Finally, the noise-shaped carrier signal can be summed together as output for 
multicarrier scenarios. Multichannel direct digital synthesizer (DDS) can be used 
to create the digital local oscillation (LO) waveforms necessary in the downconver-
sions and upconversions. 
After the NSF process, the spectrally shaped clipping noise is subtracted from 
an appropriately lagged version of the input signal to produce a signal with reduced 
PAPR. At last, a final polar clipping is typically used to remove any peak regrowth 

238 
����������������������������������������������
Digital Front End Design for Envelope Tracking
generated during NSF processing to ensure that the output PAPR is under control. 
This clipping design can be identical to the first polar clipping block, but it outputs 
the clipped signal directly rather than the clipping noise. However, the clipping 
improvement of the second polar clipping may not be sufficient as well as the effect 
of increasing the out-of-band spectral noise. Therefore, the NS-CFR iteration can 
be carried out but dependent on practical considerations and system requirements, 
as shown in Figure 6.8(a).
Figure 6.8  (a) Block diagram of the noise-shaping CFR method and (b) the noise-shaping filter for the N-
carrier multicarrier scenarios. (From: [16]. © 2007 IEEE. Reprinted with permission.)

6.2  Crest Factor Reduction 
239
6.2.4  Peak Cancellation CFR
In advanced multicarrier systems such as WCDMA and LTE-A, the PAPR of the 
multicarrier signal is commonly higher than the single carrier with an increasing 
carrier number and bandwidth. In this case, the implementation of NS-CFR would 
be not so cost-effective. Therefore, the peak cancellation (PC-CFR) method has 
been proposed for multicarrier systems [17–21]. The overall performance of PC-
CFR is superior to both PW-CFR and NS-CFR. In addition, it can be implemented 
more efficiently than NS-CFR, resulting in an overall resource and cost reduction.
The PC-CFR reduces the PAPR by subtracting spectrally shaped pulses from 
signal peaks over a threshold. The shaped pulses are designed to provide a spec-
trum that matches the input signal and therefore introduce negligible out-of-band 
distortions. The peaks to be cancelled are defined by a signal magnitude search 
process. Because the signals are complex, every shaped pulse must be rotated to 
match the phase of the corresponding signal peak. The peak magnitude of a given 
shaped pulse is equal to the difference between the peak magnitude and the clip-
ping threshold. It reduces the peak magnitudes of the signal to the threshold while 
maintaining the signal phase. Therefore, any identified peak is a candidate for the 
cancellation process.
There are two possibilities to detect peaks for cancellation, as shown in Figure 
6.9. First, it identifies a peak as any sample with a magnitude greater than that of 
neighboring samples. This method has the advantage of easy implementation and 
a fixed delay from the detection of the peak to the peak location. However, it suf-
fers the detection of many local peaks in a range above the threshold from limited 
hardware resources to handle all of them. Trying to cancel many closely spaced 
peaks at once may cause constructive interference that is shaped to generate peak 
regrowth. In addition, the assignment of the shaped pulse could be very difficult 
because a cluster of close peaks can consume all shaped pulse resources. There-
fore, an alternative peak detection method performs searches for the highest peak 
Figure 6.9  Illustrations of two methods for peak signal detection. Method 1 defines a peak as any 
sample that has a magnitude greater than its neighboring samples. Method 2 defines a peak by find-
ing the highest peak within an over-the-threshold region.

240 
����������������������������������������������
Digital Front End Design for Envelope Tracking
within a region exceeding the threshold. The advantage is that only one peak can 
be detected as a candidate from a cluster of close peaks to alleviate effects of peak 
regrowth and ease the allocation of shaped pulses. However, the drawback of this 
method is the variable delay from the peak location to the detection of the peak 
because the algorithm must wait for the signal to cross below the threshold before 
the declaration of the highest peak in the region. 
As shown in Figure 6.10, the PC-CFR is still rather similar to NS-CFR with 
regard to the noise-shaping process. The signal is clipped and then subtracted from 
the original to produce a clipping noise. Clipping noise is filtered so as to constrain 
its spectrum to that of the input signal. The spectrally shaped clipping noise is then 
subtracted from the original input signal to produce a clipped signal with minimum 
out-of-band distortions. While NS-CFR filters all samples of the clipping noise, 
PC-CFR only filters out the peak samples of the clipping noise. Treating the peak 
samples as discrete delta functions allows the convolution to be substituted by a 
simple scaling of the filter impulse response. It results in less signal distortion be-
cause the time-domain spread at the filter output is smaller than NS-CFR. Because 
the filtering of the signal peaks is implemented by a simple scaling of the filter im-
pulse response, the amount of computation is considerably reduced.
Figure 6.10 shows a block diagram of the PC-CFR algorithm. Peaks detected in 
the input signal are canceled to generate a clipped signal. The peak detection oper-
ates on the signal magnitude to produce a peak location indicator together with the 
magnitude and phase information for each peak. The difference between the peak 
amplitudes and the threshold is created by the scaling block and being combined 
with the phase information to scale the shaped pulse coefficients. The scaling and 
summation of a limited number of shaped pulses replaces the computationally in-
tensive convolution that is utilized in NS-CFR.
Each shaped pulse can only terminate one peak at a time so that the number of 
pulses determines the number of peaks that can be canceled. The peak allocation 
block controls the distribution of shaped pulses to peaks. When a peak is detected, 
the allocator assigns an available shaped pulse to cancel the peak. The final step 
of PC-CFR is to subtract the sum of shaped pulses from a delayed version of the 
input signal. If all shaped pulses were occupied by peaks, none of the further de-
tected peaks would be canceled. In this case, a plurality of iterations is necessary, as 
shown in Figure 6.10. Therefore, the basic principle behind PC-CFR is iteratively 
canceling the signal peaks by a series of shaped pulses. 
6.2.5  Constrained Clipping CFR
With the emerging of OFDM for wireless communications, its inherent high-PAPR 
nature brings about challenging tasks for CFR algorithms. Therefore, constrained 
clipping (CC-CFR) was proposed by G. T. Zhou et al. [22–24] as a technique es-
pecially developed for the OFDM system, exhibiting a considerable clipping ratio 
while being standards compliant. This algorithm offers key benefits to ensure never 
to violate the spectral mask, nor change the receiver side, and always satisfies the 
given EVM specification.
As shown in Figure 6.11, the CC-CFR accepts data at the input as OFDM 
symbols of length N carriers in the frequency domain. The first step is to upconvert 
the data by a DUC with a frequency-domain interpolation, in other words, zero 

6.2  Crest Factor Reduction 
241
padding. It involves performing CFR with a higher sampling frequency to cover 
the peak regrowth due to the DUC filtering process. However, a higher sampling 
Figure 6.10  Block diagram of peak cancellation CFR with iterations to find peaks above a threshold, 
which creates a clipped error waveform and band-limit clipped error, and then subtracts it from the 
original waveform. It employs nonlinear saturation around the peaks to reduce the PAPR. (From: [19]. 
© 2012 IEEE. Reprinted with permission.)

242 
����������������������������������������������
Digital Front End Design for Envelope Tracking
frequency spreads the nonlinear distortions over a wider bandwidth, which is in-
troduced by the subsequent blocks.
An inverse fast Fourier transform (IFFT) of length L times carrier number N is 
performed to produce representation of the OFDM symbol in time domain. Then 
polar clipping constrains the envelope of the time domain signal to within the 
specified bounds. Constraint is achieved by calculating the magnitude of the com-
plex samples. Wherein the sample exceeds the clipping threshold value, the mag-
nitude of the samples is equal to the threshold value while preserving the original 
sample phase. Polar clipping minimizes spectral regrowth with better performance 
than the Cartesian clipping method such as PW-CFR. However, polar clipping in-
troduces distortions in both constellation symbols and out-of-band spectral com-
ponents, deteriorating the EVM and the spectrum mask, respectively. To address 
those issues, CC-CFR arranges additional processing to correct distorted constella-
tion symbols restricting the out-of-band spectral energy accordingly and separately. 
To perform this kind of processing, the time-domain representation is converted 
back into the frequency domain using a fast Fourier transform (FFT) with each 
sample being analyzed. When the sample is associated with a constellation symbol, 
it will be classified as an in-band sample, compared to the ideal reference sample, 
and correct it if necessary. The purpose of the in-band processor is to ensure that 
the overall EVM does not exceed a predetermined limit. If the sample is classified 
as out-of-band sample, its magnitude will be constrained to the spectral mask. 
In spite of the CC-CFR requiring an optimal method of achieving the desired 
EVM, hardware resources and latency in practical implementation are less feasible. 
Instead, a reduced complexity variant with minimal resources can be used. Due 
to the statistical distribution of error introduced by polar clipping, the clipping 
ratio of the reduced complexity variant is almost identical to that of the original 
algorithm. For a simplified version of CC-CFR, if the calculated error power for a 
sample is below a specified EVM threshold value, it will simply output the polar 
clipped signal. Otherwise, the output signal will add a small corrective signal to 
decrease the EVM value into specification. This corrective signal has a magnitude 
value as an EVM threshold multiplied by the maximum constellation magnitude 
and a phase value equal to the phase of the original error signal. Finally, the cor-
rected frequency-domain representation of the symbol is again converted back into 
the time domain via an IFFT block.
Figure 6.11  Block diagram of constrained clipping method. (From: [22]. © 2007 IEEE. Reprinted with 
permission.)

6.3  Envelope Shaping Function 
243
6.3  Envelope Shaping Function
Besides envelope generation and timing alignment schemes, envelope shaping is 
even more important and challenging for comprehensive ET system designs. Unlike 
the traditional, fixed DC supplied RF PA, the envelope of ET PA is another vari-
able to connect the supply modulator and PA. Because the envelope power is the 
output of the supply modulator as well as the supply for RF PA, envelope shaping 
can affect the behaviors of both. Knowing how to take advantage of the envelope 
shaping for desired performance is the kernel of this section. The effects of the en-
velope shaping are significant for linearity and efficiency performance of the ET PA 
with given signal statistics. Different shaping functions can offer various trade-offs 
among metrics in the ET pyramid. The envelope shaping reduces the nonlinearity 
at a low supply voltage range so that the ET PA works more linearly than the one 
without envelope shaping. The nonlinear properties of the ET PA can be improved 
significantly with envelope shaping. Envelope shaping has a negligible degradation 
of PA efficiency in the low-voltage region and higher supply modulator efficiency 
resulting from the reduced PAPR of the shaped envelope.
6.3.1  Introduction
The envelope signal with a wider bandwidth and higher PAPR degrades both ef-
ficiency and linearity of a supply modulator. Hence, if not properly reinforced, it 
can introduce significant distortions in the RF output. Unlike EE&R techniques, in 
which the RF output amplitude is solely controlled by the supply waveform, ET al-
lows more freedom in the choice of supply waveform shape, because the RF output 
is inherently an amplified version of the RF input signal in ET. For example, ET 
systems have been demonstrated in which the supply voltage tracks the long-term 
average of the envelope or uses multilevel discrete supply voltage for PA. Therefore, 
envelope shaping becomes an important part to compromise the efficiency and 
linearity in ET, which describes the relationship between the power supply and RF 
power. With a choice of such shaped waveforms, it can be very flexible to compro-
mise the supply modulator and RF PA design for efficiency, linearity, and band-
width. For example, one of the key shaping functions is to remove near cross-zero 
region tracking voltage because PA tends to shut down while draining the voltage to 
zero. This is an undesirable phenomenon and can cause gain collapse and memory 
effects like unpredictable and noncorrectable distortions. The shaping function ap-
plied can avoid this by defining a proper operation region. The envelope shaping is 
a mapping relationship adaptation to input envelope reference signal for overall ET 
performance optimizations. The envelope-shaping parameters can be processed in 
the DFE for ET control. 
Once the shaping function is well defined, the efficiency and linearity can be 
identified and adapted directly for specific system requirements. The envelope 
shaping function is DSP in DFE to modulate the supply voltage in response to the 
envelope input reference signal. The shaping function attempts to maintain either 
constant gain for linearity or constant gain compression for maximum efficiency, 
depending on its application scenarios. For example, if an ET PA operates in mo-
bile UE, an energy-consuming digital predistortion (DPD) is generally not suit-
able to provide the required linearity improvements. Thus, a shaping function for 

244 
����������������������������������������������
Digital Front End Design for Envelope Tracking
linearity can be employed to simultaneously satisfy the requirements of linearity 
and efficiency with absence of DPD. However, various shaping functions can be 
designed and selected to reduce the nonlinearity at the expense of average efficiency 
to a degrading midway point.
6.3.2  De-Trough for Efficiency
Let us understand envelope shaping starting from the EE&R envelope-shaping 
character. The magnitude of the envelope signal increases linearly with the supply 
magnitude in EE&R, as shown in Figure 6.12. The supply modulator is a dynamic 
power supply, in which the supply varies as a function of the envelope to maintain 
the RF PA operating near saturation, but with a high-efficiency region. However, 
Figure 6.12  Envelope de-trough by applying a constant DC offset voltage for low envelope volt-
ages. (a) Transfer function and (b) time-domain waveform compared to EE&R.

6.3  Envelope Shaping Function 
245
the optimum slope can change in the vicinity of the minimum power region in ET, 
as an additional offset voltage. The offset voltage in the low power region is typi-
cally adjusted to be greater than the knee voltage of RF PA because when the sup-
ply voltage to PA is lower than the knee voltage, the nonlinear output capacitance 
will increase suddenly, and the PA exhibits strong nonlinear AM-AM and AM-PM 
distortions. The problem becomes more complex and critical when considering an 
SMPA design with harmonic terminations for ET purpose because output capaci-
tance is of crucial importance in the proper harmonic termination and varies with 
the drain/collector supply voltage. To solve this problem, several specific envelope 
shaping functions have been proposed in [24–29], which ensures the supply voltage 
is greater than the knee voltage. A shaped envelope input to the supply modulator 
can prevent the gain collapse and phase distortions of the RF PA at a low-power 
levels. Therefore, to prevent the collapse of gain and minimize sensitivity to timing 
mismatch in the ET PA, shaping functions used to avoid knee region operation are 
called de-trough [30–34]. Here de-trough means the removal of troughs in the enve-
lope signal, in other words, the close-to-zero region. A de-trough envelope signal is 
generated in the DFE and converted to analog using a DAC, after which a lowpass 
filter can be used to reject the images generated by the DAC. 
As shown in Figure 6.12, the shaping method with the signal has two different 
slopes with a constant offset voltage that is called hard de-trough. The constant off-
set voltage at a low input voltage range is adjusted to be greater than the knee volt-
age of PA. By operating above the knee region, the nonlinear gain and phase distor-
tion in PA can be avoided. To achieve a high efficiency, both PAs for the EE&R and 
ET techniques have been operated at a saturated state along the supply modulation 
signal. However, the ET PA has improved drain efficiency in comparison to the 
EE&R due to the reduced knee effect and nonlinear capacitance mismatch on the 
drain-source capacitor Cds. Consequently, the improvement of the PAE under ET 
mode can be achieved. The slope and the offset voltage of the supply for ET opera-
tion can be adjusted for the minimum distortions and high PAE in comparison with 
the conventional EE&R scheme.
As shown in Figure 6.12, the transfer function of hard de-trough can be ex-
pressed as
	
_ min
_ max
_
_ max
_ max
_ max
0
( )
( )
(
)
( )
,
( )
sm
env
env
env
shaped
sm
env
env
env
env
V
V
t
b V
V
t
V
V
V
t
V
t
b V
≤
≤
⋅

= 
⋅
>
⋅

	
(6.3)
where Venv_shaped(t) is the shaped supply voltage for the RF PA. b is the de-trough 
factor, given by b = Vsm_min/Vsm_max ≥ Vknee/Vsm_max. Venv(t) is the envelope input 
reference signal with maximum magnitude Venv_max. Vsm_min and Vsm_max are the 
maximum and minimum supply voltage for the PA, respectively. However, the de-
gree of de-trough in voltage is typically found experimentally.
The hard de-trough shaping process allows that the peak voltage region track-
ing the PA output envelope as close as possible, but stop tracking at a predetermined 
low-voltage region, right above knee voltage. It is reasonable because when the PA 
output power is small, modulating the supply does adversely affect too much in 
efficiency so that a constant DC offset voltage is applied as shown in Figure 6.12. 

246 
����������������������������������������������
Digital Front End Design for Envelope Tracking
In this case, with a lower DC offset voltage approaching to knee voltage, better 
overall efficiency can be achieved because the envelope of RF output signal can be 
instantaneously and closely tracked, reducing the wasted power from system level.
The hard de-trough shaping function clip envelope with sharp corner with 
transition point to avoid voltages lower than the knee voltage. This abrupt curve 
expands the bandwidth of the envelope signal and impacts the AM-AM character-
istic of the PA. However, there is a smoother way to shape the low-voltage region 
with envelope waveforms scaled instead of hard clipping as in Figure 6.13. This 
kind of de-trough is named as soft de-trough.
Because the voltage level of the soft de-trough should be tunable for optimiza-
tion for various PA conditions. A typical soft de-trough in (6.4) is used to shape 
the envelope to prevent gain collapse and phase distortions under the knee voltage 
region.
Figure 6.13  De-trough shaping function to avoid gain collapse of the RF PA at low supply voltages 
below the knee is made to baseband envelope in the vicinity of its zeros. In the output signal, the 
zero peaks have been warped. (a) Transfer function and (b) time-domain waveform compared to 
the EE&R.

6.3  Envelope Shaping Function 
247
	
_max
(
( )
)
_
_ max
_ max
( )
(
( )
)
env
env
V
t V
b
env
shaped
sm
env
env
V
t
V
V
t V
b e
−
=
⋅
+
⋅
	
(6.4)
where b is the de-trough factor the same as the definition in the hard de-trough.
A further advantage of soft de-trough is the narrowing of the spectrum [37] to 
relax the supply modulator bandwidth requirement and reduce the sensitivity to 
timing misalignment. Soft de-trough bootstraps the low-voltage levels with gradu-
ally increased values, which exhibits a reduced envelope bandwidth. It helps reduce 
high-frequency components of the envelope signal [35, 36] so that the high-fre-
quency component can be manipulated to within certain limited bandwidth when 
the power spectrums of the envelope before and after soft de-trough are observed. 
In addition, with soft de-trough, the PA under ET can operate at a higher drain-
source voltage in most of the input power range than that for the EE&R technique. 
Accordingly, the PA delivers a higher output power over the input range, increas-
ing the power gain. However, the sampling rate is a practical limiting factor for 
the de-trough function because the lower sampling rate affects the envelope signal 
accuracy.
Each de-trough trajectory presents a different trade-off between the RF PA ef-
ficiency and supply modulator dynamic requirements. For example, the lowest b 
value de-trough has a lower trough voltage and a sharper inflection point, present-
ing a challenge to the supply modulator, which must produce higher bandwidth 
voltage waveforms over a wider voltage dynamic range. In exchange for the more 
challenging supply modulator requirements, the RF PA operates in a high-efficien-
cy region over a larger dynamic range, increasing the average RF PA efficiency. 
By contrast, the largest b value de-trough requires less supply modulator dynamic 
capability, which indicates a more efficient supply modulator design is possible, at 
the expense of high-efficiency RF PA operation at reduced output power levels. It 
also brings integration difficulty because larger b values will cause more obvious 
drain resistance variations for the supply modulator design. Therefore, although 
envelope shaping improves the overall linearity and efficiency of the ET PA system, 
it potentially makes the supply modulator design very challenging with large b 
values as it results in a nonlinear and time-varying load to the supply modulator.
The variation in the equivalent load resistance is dramatic for the higher values 
of b that it would cause according the fluctuations of drain/collector efficiency of 
PA, with assumptions the RF output power Pout and RMS value Vsm_rms of the en-
velope supply are constant as
	
2
_
PA
sm
out
sm
rms
R
P
V
η
=
⋅
	
(6.5)
Although the supply voltage of the RF PA is shaped according to the function 
specified by (6.4), the drain/collector current of the RF PA is not shaped in the 
same way. Instead, the magnitude of the drain/collector current is approximately 
proportional to the square-root of the output power. Therefore, there is a nonlin-
ear relationship between the supply modulator output voltage and current, which 
makes the supply modulator output load appear as a variable resistor Rsm, which 
varies with the output voltage. 

248 
����������������������������������������������
Digital Front End Design for Envelope Tracking
6.3.3  De-Trough for Linearity
If efficiency optimized shaping is applied, potential severe output power reduction 
cannot be avoided. As the PAPR of the signal increases, the average supply volt-
age of the PA is reduced so that it spends most of the time at a low-supply voltage 
region, where the nonlinearity is significant. For better linearity and design for the 
linear AM-AM and AM-PM characteristics, envelope shaping can change the enve-
lope supply linearly. Therefore, to compensate the power reduction due to the knee 
voltage, a linear de-trough shaping function can be achieved by moving the transi-
tion point left ward to compromise linearity at expense of efficiency as shown in 
Figure 6.14. The shaped envelope of the drain/collector voltage can be expressed as
	
_
_ max
_ max
( )
((
)
)
( )
( )
env
shaped
sm
knee
env
env
knee
env
knee
V
t
V
V
V
V
t
V
k V
t
V
=
−
⋅
+
=
⋅
+
	
(6.6)
Figure 6.14  Linear amplification envelope shaping for maximum efficiency. (a) Transfer function 
and (b) time-domain waveform compared to EE&R. The gain of ET PA over a wide output power 
range exhibits better flatness.

6.3  Envelope Shaping Function 
249
where k is the slope of linear envelope shaping function. By using the knee voltage 
offset shaping function, the output power Pout of the PA is exactly proportional to 
the input power Pin
	
(
)
(
)
(
) (
)
2
2
_
( )
2
( )
2
out
env
shaped
knee
L
env
L
in
P
V
t
V
R
k V
t
R
P
=
−
⋅
=
⋅
⋅
∝
	
(6.7)
where RL is a load impedance of the PA, similar to that of the class-B PA. In this 
shaped operation, linearity is maintained and the drain efficiency is kept high.
The knee voltage of an RF PA can be obtained from its DC I-V curves and the 
offset voltage for linear de-trough shaping should be equal or greater than this 
value. Thus, the minimum output envelope voltage should be determined above 
the offset voltage accordingly. The optimum linear shaping curve presents gently 
tracking to the envelope of signal. When the offset voltage is moving higher, the 
efficiency of the supply modulator is increased because the PAPR of the shaped 
envelope is reduced. However, the modulator provides more than enough power 
for the RF PA, resulting in the efficiency of the RF PA side is reduced. Therefore, 
there are comprehensive considerations for offset selection to trade off efficiency 
and linearity. Typically, the offset point and slope of a linear shaping function are 
determined by experimental results.
Linear de-trough shaping defines an optimum offset voltage to the original 
envelope signal for linearity, but this does not change the envelope bandwidth be-
cause it is a linear scaling operation to reduce the PAPR of the envelope. When the 
knee voltage is constant over the entire operating range, the offset voltage is pre-
ferred to be equal to the knee voltage. Otherwise, the highest knee voltage across 
operating range can be used as the offset value to cover all scenarios to guarantee 
removing the supply voltage swing into the knee region. 
The linear de-trough in Figure 6.14 guarantees not only the high efficiency 
over a broad range of output power but also the wide dynamic range the same as 
the conventional fixed DC supply RF PA. Therefore, linear de-trough maintains 
high linearity and efficiency over the wide power range because it allows the linear 
operation of the highly efficient ET PA by preventing the operation in a dangerous 
under-knee voltage region.
Comparing the linear de-trough shaping with the hard de-trough shaping meth-
ods by clipping the low-level signals, linear de-trough presents less high-frequency 
power so that the bandwidth requirement of the supply modulator is alleviated. 
Because the gain of the RF PA decreases according to the supply voltage drops, lin-
ear de-trough shaping provides a higher supply voltage to the PA at the low power 
range. Therefore, it has the effects of increasing the gain in the low-power region 
and compensating for the AM-AM distortion.
The linear de-trough method exhibits much better linearity and a slightly low-
er efficiency than hard and soft de-trough counterparts. However, soft de-trough 
shaping addresses on variations in the knee voltage and optimum efficiency. There-
fore, it shows the intermediate characteristics between hard and linear de-trough 
shaping functions.

250 
����������������������������������������������
Digital Front End Design for Envelope Tracking
6.3.4  Sweet-Spot Tracking
An intermodulation distortion (IMD) sweet-spot effect due to the harmonic can-
cellation of the PA can occur as the PA is compressed slightly by the envelope 
supply voltage [38]. With the adoption of sweet-spot tracking for envelope track-
ing, the linearity can be further improved from linear de-trough shaping because 
it can effectively compensate for the AM-AM and AM-PM distortion with dedi-
cated PA IMD behavior information. Figure 6.15 illustrates typical third-order and 
fifth-order IMD trajectories of the RF PA with various supply voltages in two-tone 
analysis. Sweet spots locate at the minima of IMD curve and results from the can-
cellation of the harmonics [39–41]. In the ET PA, as supply voltage falls, the sweet 
spots also move to low power. Therefore, by adjusting the supply voltage according 
into sweet-spot mapping, the distortion in each power level can be minimized. The 
linearity of the ET PA can be significantly improved with this sweet-spot tracking 
shaping strategy.
In the ET PA, the linearity is dependent on the supply voltage, and Figure 6.15 
shows the typical curves IMD3 and IMD5 versus the supply voltage. By adjusting 
the supply voltage to follow sweet spots at each power level, the linearity of ET 
PA can always be maintained high. The sweet-spot tracking curve derives from 
the experimental IMD trajectory sweeping against output power with a two-tone 
signal at certain tone spacing at all supply voltage levels. Because the trend of the 
sweet-spot tracking can be very similar to linear de-trough shaping function with a 
specific offset voltage value, the sweet-spot tracking design can be started by (6.6).
Typically, when the minimum supply voltage Vsm_min decreases into a specific 
range, the EVM and ACPR of the ET PA both become better, which indicates that 
the IMDs of the PA, especially IMD3, are experiencing a sweet-spot region. In this 
case, once the Vsm_min decreases to an optimum value, the ET PA can achieve its 
Figure 6.15  Illustration of third-order and fifth-order IMDs of PA in two-tone analysis for sweet-spot 
tracking. When the supply voltage decreases in steps, the sweet spot also moves to lower power. 
With sweet-spot tracking envelope shaping, optimum linearity and output power can be obtained. 
The sweet-spot tracking improves the linearity and output power of the ET PA.

6.3  Envelope Shaping Function 
251
optimal EVM and ACPR. Once the Vsm_min  drops lower than the optimum value, 
the ET PA linearity worsens because the envelope transients start to shut down the 
RF PA. 
As shown in Figure 6.15, the IMD3 of the ET PA with the sweet-spot track-
ing is nearly constant and independent of the output power. However, the IMD3 
of the conventional fixed DC supplied PA is changed corresponding to the output 
power. In summary, the linearity of the ET PA is better than the conventional PA in 
the high-power range. However, the linearity of the ET PA is worse than conven-
tional ET PA in the low output range. Therefore, the ET PA can be driven to higher 
power, delivering high efficiency and acceptable linearity at the same time.
6.3.5  Advanced Envelope Shaping
The envelope shaping function applies a nonlinear transformation to the original 
envelope waveform, changing its time-domain properties to further complicate the 
issue. The waveform bandwidth can either be extended or compressed, depend-
ing on the type of envelope shaping. Therefore, the required supply modulator 
bandwidth and dynamic range is not straightforward to predict, as the input signal 
depends on both the system configuration and signal characteristics.
Suppose that we gradually change the shaping functions from linear de-trough, 
soft and hard de-trough, to the EE&R shape; the ET PA operates in a more deeply 
saturated region, boosting efficiency but worsening the linearity and power gain. 
Therefore, there are endless possibilities for the design of envelope shaping with 
the boundaries between linear-trough and EE&R shaping. It exhibits a huge space 
for envelope shaping to manipulate the overall ET PA performance. The advanced 
design of envelope shaping functions can be performed by carefully and optimally 
taking into account the metrics in ET pyramid from both RF PA and supply modu-
lator perspectives.
The advanced envelope-shaping design can either be expressed in more com-
plex forms in formulas such as Nujira-Wilson shaping and Nujira N = 6 shap-
ing [43, 44], or simply be used in a point-by-point shaping look-up-table (LUT) 
through experiments empirically. However, all of the de-trough shaping are in the 
region between specific linear de-trough and EE&R shaping.
	
(
)
(
)
_
_ min
_ min
( )
(
2)
1
(2
) cos(
( ) (
2) (2
) )
env
shaped
sm
env
sm
V
t
V
V
t
V
π π
π
π


=
⋅
−
⋅
−
⋅
⋅
−
⋅

	(6.8)
	
(
)
1
6
6
6
_
_ min
( )
( )
env
shaped
sm
env
V
t
V
V
t
=
+
	
(6.9)
where Vsm_min are the minimum levels of the supply voltages, which should be equal 
to or greater than knee voltage and Venv(t) is the unshaped input envelope voltage. 
Different shaping functions can provide various trade-offs between gain and aver-
age efficiency. In terms of linearity, the consequent different AM-AM curves with 
various shaping functions can be put together for comparison. When designing with 
the Nujira-Wilson function, an almost linear AM-AM response can be obtained 
because it is more approximate to the linear de-trough side, while the Nujira N = 6 
shaping is slightly nonlinear but represents the optimal trade-off between linearity 

252 
����������������������������������������������
Digital Front End Design for Envelope Tracking
and efficiency because it is more close to EE&R shaping side in comparison to 
Wilson shaping.
An ET PA design approach is based on the probability density function (PDF) 
of the actual modulated signal, in particular the compromise between linearity and 
efficiency. The PDF-conscious design approach in conjunction with the ET opera-
tion allows a significant increase in the average efficiency over a wide power range. 
Therefore, an advanced aspect of envelope shaping focuses on the ability to control 
efficiency and linearity trade-off process for ET in a PDF-conscious manner. A 
PDF-conscious ET PA can be realized by appropriately mapping the supply voltage 
to the instantaneous output power to produce a significant overall improvement. 
Such a design, along with the selection of a suitable envelope shaping function, de-
termines a significant increase in output power, linearity, and efficiency. When the 
input signals with different statistics are fed to the ET PA, the advanced envelope 
shaping should have a capability to adapt accordingly to maintain a constant high 
performance for various scenarios.
6.3.6  Bandwidth Reduction Shaping
To date, one of the most important issues of high efficiency achieved by the ET PA 
is in terms of the supply modulator. Typically, the envelope bandwidth is multiple 
times the bandwidth of the complex high-PAPR signal, whose bandwidth increases 
with modern air-standard evolutions. Therefore, one of the major challenges with 
regards to the supply modulator is the bandwidth of the envelope. With wider band-
width signals, the supply modulator becomes the design bottleneck, particularly be-
cause the envelope signal has a bandwidth at least three times wider than that of the 
RF signal [45]. However, due to the nonlinear transformation of modern complex 
signals to the envelope signal, the bandwidth of the envelope can be expanded by as 
much as a factor of 10 [46, 47], making the supply modulator design for wideband 
applications even more challenging. Also, as described in Chapter 4, an SMPS is 
commonly used to boost the efficiency of a supply modulator. In addition to the 
bandwidth and stringent spectral power requirements, higher switching frequency 
is required to suppress the output ripple sufficiently. However, this causes higher 
switching losses that significantly degrade the efficiency. Therefore, the conclusion 
is that either the supply modulator bandwidth has to be increased or the envelope 
bandwidth has to be reduced. Envelope shaping with reduced bandwidth is highly 
desired for wideband ET applications. The trade-off between the reduced efficiency 
improvement in the PA and efficiency enhancement in the supply modulator can 
be explored and balanced for the optimum system performance when considering 
reducing the bandwidth reduction.
Bandwidth reduction shaping is different from de-trough shaping: it reduces 
the bandwidth of the envelope signal for supply modulators to achieve higher per-
formance [29]. Bandwidth reduction means that there is no one-to-one relation-
ship between RF signal amplitude and PA supply any more. The envelope power 
waveform can be a slowly varying, reduced bandwidth signal, while the overall 
efficiency of the ET PA can remain high. High efficiency is maintained because 
the reduced bandwidth of envelope power waveform improves the efficiency of 
the supply modulator even though it degrades the efficiency of the RF PA. The 
disadvantages of this kind of shaping are lower efficiency and worse linearity than 

6.3  Envelope Shaping Function 
253
linear and soft de-trough shaping functions. However, the distortion caused by the 
bandwidth reduction can be compensated by an appropriate predistortion at the 
RF input signal. 
For bandwidth reduction shaping, filtering is not as straightforward as simply 
applying a lowpass filter because the high-supply voltage region is needed to main-
tain the high-power gain and linearity. Therefore, peak-tracking lowpass filtering 
can be implemented for a bandwidth reduction purpose [29]. The peak-tracking 
property is necessary while the lower minimum supply voltage is a trade-off be-
tween an increase in efficiency and reduced gain/linearity. The iterative filtering 
scheme of peak-tracking LPF is described in Figure 6.16. The principle of operation 
is to add a positive difference between the original polynomial computed envelope 
signal and its lowpass filtered version. For each iteration, the envelope peaks are 
closer to the desired level, thus creating a bandwidth reduced envelope for a given 
cutoff frequency. The result is a trade-off between number of filter iterations and 
the LPF cutoff frequency. The limiting factor for the number of filter iterations is 
the time delay into which it is translated when implementing the filter. LPF is, in 
turn, traded against the efficiency that is achievable in the supply modulator. It can 
conclude that the bandwidth reduction shaping requires much iteration.
However, the iterative peak-tracking filtering scheme requires a high-order LPF 
with wide and deep stopband suppression. Suppose that the slope of the LPF ap-
plied to the residual signal is not steep enough; the stopband components will 
add up, resulting in high-frequency component to propagate through to the supply 
Figure 6.16  Block diagram of the iterative peak-tracking LPF. (From: [51]. © 2009 IEEE. Reprinted with 
permission.)

254 
����������������������������������������������
Digital Front End Design for Envelope Tracking
modulator. It would cause linearity problems related to mismatches between sup-
ply voltage and RF signal. Furthermore, the phase response of the LPF design is 
significant because frequency-dependent delay will cause timing mismatch, causing 
undesired compression and nonlinearities. However, the reduced bandwidth enve-
lope power introduces distortions into the RF output as form of memory effects. 
This distortion can be compensated by an appropriate DPD linearization scheme.
In bandwidth reduction shaping, the effective bandwidth concept can be de-
fined as the frequency in which the power spectrum falls sufficiently low from the 
main lobe and the bandwidth of the envelope signal is approximately the main lobe 
bandwidth value. The reduced bandwidth envelope signal Vreduced(t) can be gener-
ated by lowpass filtering the original envelope signal under the constraint given by
	
( )
( )
reduced
env
V
t
V
t
≥
	
(6.10)
where Venv(t) is the envelope voltage required to achieve the target instantaneous 
output power. 
This condition ensures that the desired RF output power can be achieved by 
any suitable predistortion scheme. The reduction of the bandwidth can be made 
arbitrarily under this condition. However, the bandwidth of the main lobe can be 
usually selected as the target bandwidth after reduction so as to minimize the ef-
ficiency degradation on the RF PA side. Actually, it is desirable that the reduced 
bandwidth envelope Vreduced(t) closely tracks the original envelope in the high-pow-
er region in order not to degrade the efficiency of the RF PA. Therefore, as shown 
in Figure 6.16, the positive difference between the original and filtered signal is 
rectified and then added on the top of the filtered signal. Because the half-wave 
rectified signal as residue is rich in frequency content, it is filtered by another LPF2 
filter to achieve the target-reduced bandwidth. It should be noted that the reduced 
bandwidth signal tightly tracks the original signal at the crests and loosely follows 
at the troughs because the bandwidth of LPF1 is narrower than that of LPF2. A 
linear-phase, high-order FIR filter can be used for both LPF1 and LPF2, although 
any type of filter can be used as long as (6.10) can be met. The rectified residue 
signal is filtered and then added back to the filtered envelope signal. However, the 
resulting signal can still violate (6.10). Therefore, the above procedure can be iter-
ated until the residue signal is acceptably small. After a few iterations, the reduced 
bandwidth envelope signal can be successfully generated without violating (6.10).
6.3.7  Slew Rate Reduction Shaping
In the ET technique, high-PAPR signals limit the overall efficiency of the ET PA 
due to the high slew rate of the envelope signal. The supply modulator has to be 
designed to reach the maximum slew rate for the emerging high-PAPR signals. In 
this case, the supply modulator tracking dynamically the envelope with accuracy is 
therefore a very challenging circuit design. 
Compared to reduced bandwidth envelope shaping, to further mitigate the high 
slew rate requirements of supply modulators, slew rate reduction envelope shap-
ing can be used to reduce the bandwidth of the envelope much narrower than the 
main lobe of envelope spectrum to obtain a further relaxed waveform for low slew 
rate requirements. Therefore, instead of bandwidth reduction, slew rate reduction 

6.3  Envelope Shaping Function 
255
is mainly used to alleviate the challenging scenarios with ever-increasing PAPR of 
signals with advanced modulation scheme.
In bandwidth reduction shaping mentioned above, the slew rate at near-enve-
lope-peaks regions is not significantly reduced because it needs to maintain gain 
and linearity for the peaks. Therefore, bandwidth reduction shaping does not re-
duce the high slew rate at those regions to a sufficiently low level so that the modu-
lator must be capable of supplying a high slew rate near the peaks. The difficulty in 
designing a high slew rate monolithic linear modulator arises from the large input 
capacitance of its output stage for high-power applications. Thus, the challenge 
of supply modulator design is achieving a high slew rate without a high quiescent 
current. 
By applying the slew-rate-reduction-shaping technique [49], both the band-
width and accuracy requirements to track these envelopes are much smaller. By de-
fining the effective bandwidth as the frequency where the spectral power contains 
more than 90% of the whole spectral power excluding DC power, the effective 
bandwidth of the envelope signal can be estimated and further reduced. Because 
the main power of the typical high-PAPR signal is concentrated at DC and the main 
lobe, the power spectral density falls into a sufficient low level from the main lobe 
within the effective bandwidth rapidly.
To generate a slew-rate reduced envelope, the following requirements must be 
accomplished. First, the amplitude of the slower envelope has to be always higher 
than the RF signal envelope. It has to behave as an instantaneous upper bound of 
the true envelope, which is the same criteria as bandwidth reduction shaping in 
(6.10). Second, it has to be able to track the slew rate of the supply modulator. 
Finally, it has to be produced in real time manner. Therefore, the shaping basically 
consists in taking the sampled value of the envelope and to generate a shaped enve-
lope according to the present and predicted future values of the envelope.
In general, the main speed restriction in the ET PAs is the slew-rate require-
ments for the supply modulator, a parameter related to the maximum slope of the 
signal at the supply modulator output. This is the case of the supply modulator, 
whose bandwidth and slew rate limit the speed of the envelope supply. To illustrate 
this, let us consider a normalized envelope ranging from 0 to 1. The instantaneous 
and normalized slopes of envelope, Kenv(t) and Kenv_norm(n), at the supply modula-
tor output are then defined as
	
_ max
_ max
( )
(
( )
(
1))
( )
env
env
env
s
sm
env
s
sm
K
n
V
n
V
n
T
V
V
n
f
V
=
−
−
⋅
= ∆
⋅
⋅
	
(6.11)
	
_
_ max
( )
( ) (
)
( )
env
norm
env
s
sm
env
K
n
K
n
f
V
V
n
=
⋅
= ∆
	
(6.12)
where Venv(t) is the envelope sample, Ts and fs are the sampling period and sampling 
frequency, respectively, and Vsm_max is the maximum voltage value at the supply 
modulator output, that corresponds to the maximum desired transistor drain/col-
lector bias. If the slew rate of the supply modulator is Kslew, then 
	
( )
env
slew
K
n
K
≤
	
(6.13)

256 
����������������������������������������������
Digital Front End Design for Envelope Tracking
Therefore, to meet the slew-rate requirements of the supply modulator, it is nec-
essary to keep 
( )
env
V
n
∆
 bounded to restrict the normalized slope of the envelope. 
To do so, an algorithm aimed at generating a slew-rate-reduced envelope Vreduced(n) 
from the original envelope Venv(n) has been presented in [50]. According to this 
algorithm, ∆M is the maximum increment allowed to the slow envelope Vreduced(n) 
at each sampling time n; therefore, ∆M is the normalized slew rate (maximum slope 
of the envelope) and thus
	
_
( )
1
reduced
norm
M
K
n < ∆
<
	
(6.14)
Moreover, to generate the slow envelope Vreduced(n), the original envelope 
Venv(n) must analyze N samples in advance [51]. N is an integer that accomplishes 
N ≥ 1/∆M. Therefore, N is a slew-rate division factor to configure for various reduc-
tion schemes.
Figure 6.17(a) shows the original envelope and slew-rate reduced version of it 
in the time domain. Figure 6.17(b) illustrates that is considering different N values 
for the effective bandwidth and the efficiency of the supply modulator with slew-
rate reduction shaping. It shows that it is possible to find a compromise between 
the bandwidth and the slew-rate reduction ratio, which is necessary to cope with 
the specific supply modulator requirements, and the amount of drain/collector ef-
ficiency degradation suffered due to the use of a slower version of envelope. The 
parameter N related to the maximum allowed increment in the signal slope is swept 
to change the slew-rate and bandwidth reduction level. However, the drain/collec-
tor efficiency of the PA decays more or less linearly with the bandwidth reduction, 
while it presents a logarithmic behavior with the slew-rate reduction, as it was the-
oretically predicted in [50]. As a consequence, it is possible to find a trade-off solu-
tion to meet both slew-rate and bandwidth requirements of the supply modulator 
and still having a reasonably high overall efficiency of the ET system. Therefore, 
using reduced slew-rate and bandwidth versions of the envelope to perform ET is 
very useful to trade off both the PA drain/collector efficiency and supply modulator 
efficiency and the speed requirements of the supply modulator. 
Although the RF PA efficiency under the ET with a slower version of the enve-
lope is slightly worse than using the ET with the original envelope, but better than 
considering a fixed DC supply. Relaxing the slew-rate requirements of efficient 
supply modulators is of crucial important because this method is possible to extend 
the applicability bandwidth of supply modulators for ever-increasing bandwidth 
requirements in modern wireless communication scenarios.
The advantage of using the slower version of the envelope is relaxation of 
the supply modulator bandwidth and slew-rate requirements, and thus broadband 
modulation signals can meet the up-to-date technology of efficient DC-DC convert-
ers. Unfortunately, because the ET technique using a slower version of the original 
envelope introduces nonlinear distortion and memory effects, some powerful DPD 
techniques taking into account memory effects compensation are required.
Table 6.1 summarizes the functions for envelope shaping ET with their advan-
tages and disadvantages for comparison.

6.4  Timing Alignment 
257
6.4  Timing Alignment
In practice, there are some serious technical hurdles to overcome to realize an ET 
transmitter, especially for portable applications. One of the most significant issues 
Figure 6.17   (a, b) Envelope with slew rate reduction and its influence to effective bandwidth of 
envelope and efficiency of the supply modulator with various division factors. (From: [50]. © 2010 
IEEE. Reprinted with permission.)
Table 6.1  Summary of Envelope Shaping Functions
EE&R 
Shaping
Hard 
De-Trough
Soft 
De-Trough
Linear 
De-Trough
Sweet-Spot 
Tracking
Reduced 
Bandwidth
Reduced Slew 
Rate
Efficiency Excellent
Excellent
Excellent
Good
Good
Ordinary
Ordinary
Linearity Poor
Ordinary
Ordinary
Excellent
Excellent
Ordinary
Good
Bandwidth No change
Wider
Narrower
No change
Almost no 
change
Narrower
Narrower
Complexity Simple
Simple
Complex
Simple
Middle
Complex
Complex

258 
����������������������������������������������
Digital Front End Design for Envelope Tracking
for ET PA system is known to be sensitive to timing mismatch between the envelope 
and RF paths. The group delay of the two signal paths must be matched to mini-
mize PA distortion. Although an ET PA has lower sensitivity to timing mismatch 
between branches than EE&R, a precise synchronization will avoid undesired satu-
rated state to guarantee an acceptable ACPR and EVM performance for ET. To 
minimize distortion caused by the time-delay difference between the envelope and 
RF paths, the synchronization and timing alignment can be performed in digital 
domain by maximizing the amplitude and phase correlation between the input and 
downconverted output signals [54]. The importance of correct timing alignment 
between envelope power and RF paths will be discussed in this section.
In practice, a timing alignment algorithm should compensate both static delay 
and group delay in an ET PA system. Predistortion techniques can further reduce 
the group delay. Therefore, it mainly addresses on static delay for this section. 
Static delay stems from the fact that the time it takes a signal to pass the supply 
modulator is an instantaneous delay. The delay is influenced by the phase distor-
tions that the supply modulator can introduce to the signal.
6.4.1  Timing Mismatch
A delay misalignment between the supply voltage and RF output signal may result 
in spectrum and EVM degradation. The consequence of a timing mismatch on spec-
tral distortion for an ideal RF PA between supply voltage Vsm(t) and envelope volt-
age Ein(t) considerably raises spectral intermodulation distortions (IMD) and EVM, 
leading degraded ACPR and modulation quality, respectively. The IMD caused by 
the timing mismatch for two equal input tones has been derived in [55, 56]:
	
2
2
2
RF
IMD
B
π
τ
≈
⋅
⋅
⋅∆
	
(6.15)
where BRF is the bandwidth of the two-tone RF signal and ∆τ is the timing mis-
match between RF and envelope paths.
The influence to EVM from the path-timing mismatch is illustrated in Figure 
6.18, which expresses the theoretical and practical EVM with peak and root mean 
squared (RMS) scenarios.
It is important to acknowledge that the nonlinearity mechanism is merely one 
contribution to the overall RF PA performance, and consequently, it is expected 
that timing mismatch desires to be significantly less than the several nanoseconds 
level. Even though in theory it is conceivable to utilize the timing delay compensa-
tions (e.g., delay line in either digital and analog domains) in the main RF branch to 
equalize the variance, physical constraints make the opportunity of use standalone 
delay components unattractive for mobile terminal and small cell BTS scenarios. 
6.4.2  Timing Alignment
Timing alignment consists of the two separate functions: synchronization and de-
lay match. Synchronization function synchronizes the delay between envelope and 
RF path. Delay match function adds the delay to the RF path so that the envelope 
power path and RF path reach the RF-PA at the same time. 

6.4  Timing Alignment 
259
The first step of timing alignment is a precise estimation of delay between 
envelope power and RF signal paths. The corrective values of delay added to the 
RF path should be adaptively updated to maintain a real-time compensation. The 
delay value obtained from magnitude correlation between RF feedback signal and 
baseband I-Q is typically used for timing alignment. However, blind optimization 
of delay values alone is not adequate for timing alignment because it may result 
in degradation of the ET PA linearity. The absolute amount of differential delay 
between envelope power and RF signal cannot be directly measured, so the correct 
value is inferred by observing system performance metrics while delay is varied. In 
addition, because detection circuitry used to measure an output power at an output 
of the RF PA include offset errors and suffer from limited or low sensitivity with 
respect to delay mismatch, calibration techniques based on minimizing mismatch 
delay by determining an offset delay that provides maximum output power may 
not be repeatable or reliable.
Historically optimized timing alignment has been carried out manually using 
either maximum power to establish crude alignment or symmetry and best adjacent 
channel power measurements with the use of a nonmemory adaptive predistortion 
system. For example, one solution to the timing alignment problem is to monitor 
the amplifier output signal, with resulting timing related distortion, and then to 
adjust the timing of the dynamics or the timing of the signal to be amplified using 
an associated delay element to set an optimal timing for minimal distortion. To 
get the optimum delay for linearity, path delay adjustment is then swept through 
a reasonable range, searching for a minimum in ACPR. The delay sweep must be 
performed after ACPR observation becomes stable for each measurement iteration; 
otherwise, the ACPR minimum would difficult to identify due to more dominant 
nonlinear distortion. However, some advanced timing alignment scheme can be 
employed for commercial purpose, including estimating a distortion parameter in 
the RF PA output and determining a timing error in dependence on the estimated 
distortion parameter [58]. It does not require direct measurement of the amplifier 
output signal and therefore does not require any associated measurement circuitry.
Figure 6.18  Effect of timing mismatch on EVM for typical modulated signal. (From: [25]. © 2005 
IEEE. Reprinted with permission.)

260 
����������������������������������������������
Digital Front End Design for Envelope Tracking
Finally, it is critical that delay adjustment be performed before DPD correction 
[59]. If path delay error is present, DPD algorithms can provide some fine correc-
tion, as shown in Figure 6.3.
For timing alignment, the ability to control the delay between the RF feedback 
envelope and baseband I-Q envelope is crucial. The delay can be implemented ei-
ther in hardware by adding wait samples and skewing sample clocks or in software 
with DSP. Although it is possible to implement the delays in hardware, it requires 
the ET waveforms to be resampled to several hundreds of megahertz to specify a 
delay with subnanosecond resolution. Compared to resampling the waveform, the 
software implementation is more cost-effective. The delay algorithm uses the dis-
crete Fourier transform (DFT) time-shifting theorem, which states that delaying a 
periodic time-domain waveform by nd samples modifies its DFT representation by 
the factor 
( 2
/
)
d
j
k N n
e
π
−⋅⋅⋅
⋅, where k is the discrete frequency index. To delay x[n] by nd 
samples, it can perform the following three steps. First, take the N-point DFT of 
x[n] to get X[k], where 0 ≤ k ≤ N – 1. Then multiply X[k] by 
( 2
/
)
d
j
k N n
e
π
−⋅⋅⋅
⋅. Finally, 
take the inverse DFT of the resulting transform to obtain the delayed waveform.
As the block diagram of the proposed ET system shown in Figure 6.3, the enve-
lope signal amplitude is calculated from the complex baseband signal and amplified 
by the supply modulator, providing a dynamic supply voltage to the RF PA. Digital 
timing alignment can be realized in baseband to synchronize the ET supply and 
RF input signal precisely. Both integer delay and fractional delay can be utilized by 
the digital alignment system to adjust the envelope modulator output with the RF 
input signal at the RF PA. The integer delay can be set to account for delay differ-
ences between the supply modulator and the digital predistortion (DPD) path plus 
the analog transmit signal chain in steps of multiple of sampling time. Sampling 
time is the inverse of sampling rate. For example, an LTE 20-MHz RF envelope 
signal can be typically sampled with a rate as 153.6 Msps to cover adjacent channel 
and alternative channel predistortions. Hence, the step of integer timing alignment 
is around 8.2 ns accordingly. The fractional delay can be used to perform further 
fine timing alignment within fractions of sampling time.
Typically, delay adjustment action consists of the two separate functions as 
synchronization and delay match as shown in Figure 6.19. The delay between the 
signals is ���������������������������������������������������������������������������
searched using the specific function to find the AM signal shift. The func-
tion calculates the delay using the cross-covariance method. The delay accuracy 
in search function depends on the delay length, so timing alignment can be done 
step by step with several rounds of iterations. The first iteration gives the integer 
samples delay and the second one gives the fractional sample accuracy. ������������
To get frac-
tional sample accuracy to the synchronization, it can use the filtering to adjust the 
signals. The timing alignment is possible to do for both envelope and RF signals in 
both directions. 
Hence, in Figure 6.19, integer delay compensation function block calculates 
cross-covariance and gives integer samples delay. After integer sample delay match, 
fractional delay compensation calculates the fractional samples delay. It estimates 
covariance sequence between those signals. Delay can be calculated from the maxi-
mum covariance point.

6.5  Digital Predistortion 
261
6.5  Digital Predistortion
In general, any RF PA driven into nonlinear operation will generate amplitude and 
phase distortion. These effects are characterized by AM-AM conversion and AM-
to-PM conversion. These parameters represent variations in amplitude and phase 
transfer characteristics of an RF PA as it nears compression. Under these nonlinear 
conditions, an RF PA takes on a stepped-shape output spectrum response, with 
each step corresponding to a high order of distortion. The steps are known as 
spectral-regrowth sidebands or adjacent channel power (ACP). Spectral regrowth 
mainly impacts adjacent channel interference. Therefore, linearization can be used 
to eliminate the distortions as much as possible. Digital predistortion (DPD) is one 
of most cost-effective and powerful linearization schemes available in modern wire-
less communications. 
Nonlinear compensation is a method of DPD in which each sample of the 
baseband input signal is adjusted for magnitude and phase distortion based on 
the instantaneous power level of that sample. The amount of distortion is esti-
mated with a feedback system, and the compensation is usually implemented in 
DFE with DSP. The DPD of the RF PA is a relatively young technique, initiated 
in the early 1980s by A. A. M. Saleh and J. Salz [60]. Early contributions only 
consider nonlinear memoryless RF PAs so that PA design with memory-alleviated 
characteristic was popular at that time. However, with the evolution of broadband 
wireless communication standards, memory effects had to be taken into account. 
Therefore, Volterra series and variants based filters as models for predistorter have 
been extensively studied as shown in Figure 6.20. As the bandwidth of the signal 
increases, memory effects in the transmitter distort this simplified picture. Memory 
effects are attributed to filter group delays, the frequency response of matching 
networks, nonlinear capacitances of the transistors, and the response of the bias 
networks. The performance of DPD algorithms that do not take these memory ef-
fects into account is severely degraded as the bandwidth increases. Memory effect 
compensation is built on nonlinear compensation by taking into account several 
input signal samples at a time for improved performance. A significant amount of 
the nonlinear distortion in a typical PA is a function of the particular input signal 
Figure 6.19  Flow of timing alignment between the baseband main signal input and the feedback envelope 
signal. The integer delay compensation block calculates cross-covariance and gives integer samples delay. 
After the integer samples delay match, fractional delay compensation calculates the fractional samples delay. 
Fractional samples delay match is done using the FIR filter.

262 
����������������������������������������������
Digital Front End Design for Envelope Tracking
level. Therefore, the contents about DPD are categorized by two functionalities as 
forward and feedback path. By virtue of this division, explicit subgroups of pre-
distorter modeling and coefficient update schemes can be deduced accordingly as 
shown in Figure 6.20.
6.5.1  Introduction
The DPD acts on transmitted data to cancel the distortion in the PA by implement-
ing an inverse model of the RF PA. The concept is based on inserting a nonlinear 
function (the inverse function of the PA) between the input signal and the PA to 
produce a linear output. The DPD requires being adaptive because of variation 
in the PA nonlinearity with time, temperature, and different operating conditions. 
Another limitation of predistortion is the dependence of the transfer characteristics 
of PA on the frequency content of the signal or defined as changes of the amplitude 
and phase in distortion components due to past signal values, which is known as 
memory effects. The memory effect compensation is an important issue of the DPD 
algorithm in addition to the correction of PA nonlinearity especially when the signal 
bandwidth increases. The application of DPD in the baseband signal is an extended 
method of RF PA linearization to improve ACPR in those systems in which a vary-
ing envelope modulation scheme like OFDM is used.
As shown in Figure 6.21, the components ICFR, QCFR of the undistorted but 
clipped transmission signal pass the predistorter filter, which distorts the signal 
in such a way that after passing the nonlinear analog circuitry the signal appears 
linearly amplified. The predistorter has to be designed appropriately to achieve this 
linear amplification. The necessary knowledge comes from the modeling, which 
creates an accurate model of the nonlinear transmit circuitry. The analog feedback 
Figure 6.20  Phylogenetic tree of digital predistortion categorized by forward and feedback path structures.

6.5  Digital Predistortion 
263
path must obey stringent linearity requirements, as in the case of the Cartesian-
loop linearization scheme. Thus, in a predistortion system, the following four tasks 
have to be performed. 
First, it requires a modeling of the nonlinearity of transmitter in which the RF 
PA contributes the most. A model has to be found that is capable of describing the 
behavior of a composite of systems such as I-Q modulators, a preamplifier driver, 
and an RF PA final stage. However, the model needs to be reasonably low complex-
ity to use in practical implementations. As shown in Figure 6.20, Volterra series 
[63], Wiener [64], Hammerstein [65], and Saleh [66] models are all the popular 
as the nonlinear modeling techniques for RF PA. The Volterra model is the most 
powerful model and comprises a large class of nonlinear dynamic systems. Wiener 
and Hammerstein models are special cases of the Volterra series. However, they are 
too complex and difficult to be put into practical implementations. Saleh’s model 
is a simple static nonlinearity model with limited parameters which is not capable 
of handling dynamic nonlinearity or memory effects. Therefore, by truncating the 
terms of Volterra series, the memory polynomial obtained can be effective at linear-
izing wideband RF PAs, and has reasonable hardware and software computational 
requirements. Memory polynomial has become one of the most popular approach-
es for DPD. The other is the look-up-table (LUT) method, which contains points 
on the transfer function.
Second, after modeling the nonlinear RF PA of the models mentioned above, 
the next task is to design a predistorter filter that compensates the nonlinear and 
memory effects of the transmit path. In general, analytic solutions for the predis-
torter are not achievable. At a minimum, methods that provide an approximate 
solution for the predistorter needs to be found. Further, it would be desirable to 
provide solutions for the predistorter for a variety of RF PA models.
Third, it performs an adaptive identification of the RF PA model parameters. 
Once a candidate model is found, the model parameters have to be estimated. An 
adaptive identification algorithm, in its nature an online optimization method, can 
perform this task. Finally, the system has to be realized and tested in an experimen-
tal setup to verify the overall system performance. 
Figure 6.21  Illustration of adaptive DPD forward and feedback paths for functions.

264 
����������������������������������������������
Digital Front End Design for Envelope Tracking
6.5.2  DPD Forward Path
Two basic approaches for the DPD forward path are complex LUT and family 
members of Volterra series as shown in Figure 6.20. The first group contains the 
LUT-based complex algorithms. The complex LUT method contains points of the 
transfer function of AM-AM and AM-PM. The LUT is continually updated, based 
on measured RF PA output values, making these algorithms adaptive. This group 
of algorithms performs well as long as the PA nonlinearity is a function of the input 
magnitude and independent of the input phase.
The other group is the Volterra modeling of the RF PA. This type of algorithm 
attempts to continually measure the most significant Volterra coefficients and to 
correct accordingly. The correction can be done directly via multipliers or indirectly 
through a lookup table, where the LUT content is derived from the Volterra coef-
ficients. In the following section, the emphasis is put on truncated Volterra series 
as the memory polynomial. Memory polynomial represents a simplified transfer 
function with memory effects.
6.5.3  Complex LUT DPD
Because the DPD handles the complex envelope of the PA input and output RF 
signals, the complex LUT architecture depends on the way this complex envelope 
is treated to be predistorted. LUT-based predistorters may be classified by its LUT 
approach mainly as mapping LUT, polar LUT, and complex gain LUT.
6.5.3.1  Mapping LUT DPD
In mapping LUT DPD in Figure 6.22(b), the complex input signal is represented 
by its Cartesian I-Q components as ICFR and QCFR, which are the outputs for prior 
CFR block. By using a two-dimensional LUT, both input Cartesian components are 
mapped to a new constellation of Cartesian components as:
	
(
,
)
(
,
)
DPD
CFR
I
CFR
CFR
DPD
CFR
Q
CFR
CFR
I
I
f I
Q
Q
Q
f
I
Q
=
+
=
+
	
(6.16)
Thus, any distortion or error occurring in the conversion process can be can-
celled. This even includes misalignments and nonlinearities in the quadrature mod-
ulator. For the purpose of adaptation, the amplifier output signal is synchronously 
demodulated and compared with the input signal. Several results using mapping 
LUT DPD have been reported in [67–69]. The major drawback with the mapping 
predistorter is the size of the two-dimensional LUTs, which results in long adapta-
tion times.
6.5.3.2  Polar LUT DPD
Polar LUT DPD was first presented by Faulkner et al. in [70] and later has been 
improved and used by many other works. It uses two one-dimensional LUTs con-
taining magnitude gain and phase rotation, respectively. The principle is illustrated 

6.5  Digital Predistortion 
265
in Figure 6.22(c). Given in Cartesian components, the input signal amplitude, Rin, 
is used to point an address of the LUT containing an amplitude gain factor Rout = 
FR(Rin). Then this factor obtained from the table is used to multiply the original 
input signal amplitude for amplitude correction. The magnitude of the input signal 
is multiplied by the same gain factor and the result is used to address the second 
table containing the predistortion phase, Φout = FR(RΦ). Finally, phase rotation is 
performed by the amount obtained from the second table. This final step includes 
two additional look-ups to get specific values for the rotation matrix. Both tables 
are one-dimensional, so the access time and the memory requirements are reduced 
with respect to the previous mapping LUT DPD.
Because the adaptation process is based on polar coordinates, each iteration 
involves Cartesian-to-polar (C/P) conversion of the input signal and the detected 
output signal. All in all, this leads to a substantially larger computational load 
compared with the mapping LUT DPD. The adaptation scheme of the polar predis-
torter is a multiplicative predistorter in contrast to the mapping predistorter, which 
is additive. This means that the polar LUT DPD is not sensitive to the phase of the 
feedback signal, as is the case for the mapping LUT DPD. A phase adjustment cir-
cuit in the feedback path is therefore not necessary for stable operation. This tech-
nique gives a considerable reduction in table size compared with the mapping LUT 
Figure 6.22  Various LUT DPD types. (a) Complex LUT predistorter finds the inverse instantaneous gain and 
phase of the PA for the input signal. (b) Mapping LUT DPD, (c) polar LUT DPD, and (d) complex gain LUT 
DPD containing complex-valued gain factors given in Cartesian form. All LUT schemes need multiple LUTs for 
memory-capable DPD. (From: [94]. ©2002 Artech House. Reprinted with permission.)

266 
����������������������������������������������
Digital Front End Design for Envelope Tracking
scheme. However, because this solution assumes a phase-invariant characteristic, 
it depends heavily on the use of perfect quadrature modulators and demodulators. 
It requires quadrature modulation error corrections, which will be discussed later 
in this chapter.
6.5.3.3  Complex Gain LUT DPD
The major drawback of the mapping predistorter is the size of the two- dimen-
sional table, which results of long adaptation times. However, if we restrict the 
predistorter to correct for the nonlinearities of the amplifier alone, then a one-
dimensional table will do, as the amplifier characteristic is a function of the input 
amplitude only. That is, such a table would approximate the inverse function of the 
amplifier nonlinearity with a finite number of table entries.
Complex-gain LUT DPD was first presented by Cavers in [71]. Instead of hav-
ing two tables with amplitude gain and phase rotation, it has a LUT containing 
complex-valued gain factors given in Cartesian form. Therefore, this technique 
requires fewer operations to predistort the signal compared with the polar pre-
distorter. The complex gain LUT predistorter uses the power of the input signal 
2
CFR
CFR
R
I
j Q
=
+ ⋅
 to point a unique LUT containing the complex gains of a predis-
tortion function, GLUT(R). The complex gain GLUT(R) that results from the LUT 
addressing is used to predistort the input signal Vin = ICFR + j · QCFR by computing 
the complex product Vout = Vin · GLUT(R). With only one one-dimensional table, 
the complex gain predistortion reduces the complexity and adaptation time in com-
parison to mapping LUT DPD.
The adaptation scheme of the complex gain LUT DPD is a multiplicative pre-
distorter in contrast to the mapping LUT, which is additive. This means that the 
complex gain predistorter is not sensitive to the phase of the feedback signal, as is 
the case for the mapping predistorter. A phase adjustment circuit in the feedback 
path is therefore not necessary for stable operation. The LUT size affects linearly 
the speed of adaptation, so one way to increase the adaptation speed is to reduce 
the number of entries in LUT. However, the number of LUT entries determines how 
closely the predistorter is able to follow the inverse function of the RF PA distor-
tion as well as the maximal signal-to-noise ratio (SNR) available at the output of 
the RF PA.
Because this solution assumes a phase-invariant characteristic, it depends heav-
ily on the use of perfect quadrature modulators and demodulators. Such modula-
tors and demodulators are difficult and expensive to build. 
So far all the above LUTs have been assumed to have the phase and magnitude 
errors only depending on the current input magnitude and phase. What if this is 
not the case, with memory effect taken into consideration? Typically, once memory 
effects are intended to model, LUT DPD could compensate for it by simply adding 
a dimension to the LUT. This obviously increases the memory size significantly, 
but the amount of logic will not increase a lot. It does also affect the time for the 
algorithm to converge, because the LUT has significantly more entries. Interpola-
tion routines should be considered when implementing a multidimensional LUT. 
Therefore, a�������������������������������������������������������������������
s a general rule, LUT DPD can compensate for memory effects by add-
ing dimensions to the table, at the expense of memory size and convergence time.

6.5  Digital Predistortion 
267
In the LUT algorithm, there are mainly three different ways for compensating 
for memory effects. The first way is to add dimensions to the LUT, as indicated 
above. The more prior samples to consider, the more dimensions need to be added 
into the LUT, making the LUT very large. The second way is to use a “delta lookup 
table” as in the LUT DPD solution [72]. Finally, the Volterra predistorter training 
block can derive the inverse response of the PA by performing polynomial curve 
fitting on the PA input and output data in an LUT in a direct learning scheme as 
discussed in the next section.
6.5.4  Memory Polynomial DPD
As shown in Figure 6.20, the Wiener model can be seen as a significant simplifica-
tion of the Volterra model. The Wiener model consists of a linear filter followed by 
a memoryless nonlinearity. An LUT can be used to model the nonlinearity, and an 
FIR filter can be used to model the linear filter. The effectiveness of Wiener systems 
in modeling most RF power amplifiers is limited. The estimation of the model pa-
rameters is reasonably complicated, making it unattractive for real-time adaptation.
The Hammerstein model (again, a reduction of the Volterra model) consists of 
a memoryless nonlinearity followed by a linear filter. It is a simple memory non-
linear model, and it is easier to compute its model parameters than for a Wiener 
model. This model is also of limited effectiveness for modeling all different types 
of the RF PAs.
However, cascading a linear filter, a memoryless nonlinearity, and another 
linear filter forms a Wiener-Hammerstein model [73, 74]. This is a more general 
model than a Wiener or a Hammerstein model and covers a lot more terms from 
the Volterra series, enabling better modeling of the nonlinearity.
A commercially sustainable predistorter should be adept at handling a wide 
variety of nonlinear behaviors and might require different modeling schemes for 
different applications. Therefore, it requires an optimum trade-off between linear-
ization performance and complexity. The memory polynomial model constrains 
the Volterra series so that everything except the diagonal terms in the kernels is zero 
[75–78]. The memory polynomial model has been shown to be effective at linear-
izing wideband RF PA, and has reasonable hardware and software computational 
requirements. However, their real-time implementation has been restricted by the 
computational complexity associated with the filtering and adaptive mechanisms. 
As shown in Figure 6.23, the memory polynomial model for the predistorter can 
be described as
	
(
)
(
)
1
1
1
0
( )
k
Q
K
kq
k
q
z n
c
x n
q
x n
q
−
−
=
=
=
⋅
⋅
−
⋅
−
∑∑
	
(6.17)
where K is the nonlinearity order and Q represents the memory depth of the RF PA. 
The essence of the model is that the nonlinearity of the PA is modeled by a complex 
polynomial function of the signal amplitude |x|, which attempts to match the AM-
AM and AM-PM characteristics of the PA. Memory effects are modeled by the FIR-
type structure that is placed upon this. The model is a pure regression model; there 
is no explicit attempt at modeling the behavior of the transistor circuits in the PA.

268 
����������������������������������������������
Digital Front End Design for Envelope Tracking
To reduce the implementation complexity of the predistorter while maintaining 
acceptable performance, typically only the odd-order terms in the nonlinearity can 
be included in the model variant. This compromise reduces the complexity of the 
predistorter by approximately 40% at the expense of 3 to 5 dB spectral regrowth. 
A detailed investigation of the benefits of the even-order terms in the baseband 
model has been presented in [79].
6.5.5  Combined DPD
As shown in Table 6.2, in the complex LUT predistortion method, the memory 
effects that cause dynamic AM-AM and AM-PM are not considered. So here the 
main objective is not only to demonstrate the capability of memory polynomial 
DPD to overcome such disadvantages, but also to show that with applying this 
technique all the memory contents of PA modeled can be compensated, although in 
Figure 6.23  Memory polynomial predistorter model (a) and forward path design (b). The highest nonlinear-
ity order K is the number of FIR filters, and the memory depth order Q is the number of taps of each FIR filter. 
Each tap performs complex multiplication.

6.5  Digital Predistortion 
269
memory polynomial predistortion, the complexity of extracting the coefficients of 
predistortion function decreases the capability of linearization.
In practice, traditional fixed DC supplied RF PA can achieve high linearity with 
either complex LUT or memory polynomial DPD, but it may suffer from a serious 
distortion problem due to the dynamic drain/collector bias dependent nonlinear 
behavior of the ET PA. Therefore, for ET applications, the distortions because of 
memory effects become more severe.
While the idea of modulating the supply voltage to maximize PAE is good in 
theory, this is difficult to put into practice to guarantee linearity of ET PA system. 
A consequence of varying supply voltage as a function of output power is that the 
gain of PA will dynamically change as supply voltage is changed, thus increasing 
AM-AM distortion. This effect can be reduced by using a smaller range of ET sup-
ply levels, which leads to a design trade-off between PAE and AM-AM distortion. 
DPD algorithms can be applied to the baseband waveform to correct for additional 
distortion introduced by the ET.
Moreover, the desirable high frequency and efficiency of a promising com-
pound semiconductor technology for ET PA like GaN HEMTs are somewhat less 
attractive given that the devices often exhibit significant long-term memory effects 
due to trapping phenomena that adversely impacts linearity. Unfortunately, until 
recently, no unified approach existing to accurately characterize, model, and simu-
late long-term memory effects for broadband communication signals with them.
Therefore, various combinations of the above models can be combined to-
gether, each with its own pros and cons. The combined DPD is the combination 
of two techniques, complex LUT and memory polynomial DPD or any other com-
binations. By applying this technique, all the memory contents of the PA can be 
suppressed.
For example, the combined DPD can be employed for linearization at two lev-
els. Memoryless DPD is carried out to compensate for the expected gain variation 
of the RF PA over the envelope tracking trajectory. To further improve linearity, a 
second-level memory mitigation DPD is performed to compensate for a perturba-
tion to the instantaneous gain caused by deterministic memory effects using an 
algorithm described in [81, 82].
After memory-compensated digital predistortion, a linear gain and a flat phase 
can be achieved. In addition, the amount of scattering effect can be significantly re-
duced. The EVM and ACPR can be improved, respectively, achieved after memory 
DPD or meeting the WCDMA or LTE-A specifications.
Table 6.2  Comparison of Complex LUT and Memory Polynomial DPD
Complex LUT DPD
Memory Polynomial DPD
Low complexity
High complexity as it uses higher-order terms
Same solution for different PAs as long as 
error dependencies are same
Relatively difficult to address different RF PA 
types
Low cost and less hardware resource 
implementation possible
Requires high-performance hardware and more 
resources to implement
Slower convergence time
Faster convergence time
Memory effects and phase-dependent er-
rors require complex implementation
Relatively easier to address memory effects and 
phase-dependent errors

270 
����������������������������������������������
Digital Front End Design for Envelope Tracking
In addition to the timing misalignment discussed in Section 6.4, there are oth-
er sources of nonlinearity in the ET PA such as RF transistor transconductance 
nonlinearity and output capacitance variations with varying envelope voltage. To 
minimize the distortion caused by the RF PA, predistortion can be carried out in 
the digital domain. The predistorted input signal is created by the inverse function 
of the measured AM-AM and AM-PM characteristics of the overall system, such 
that the stringent linearity requirements imposed by the 3GPP can be fully satisfied.
After proper alignment of the desired modulated signal and the distorted out-
put signal, an LUT is generated based on the measured amplitude and phase versus 
the desired signal. Applying the intended signal through the inverse of the LUT 
generates a predistorted memoryless signal to the input of the RF PA. To generate 
a memory-compensated predistorted signal, an approach of successive approxima-
tion has been used in [83, 84]. A key point in such an approach is system repeat-
ability, a necessary condition to quantify and separate the memory effects due to 
randomness or noise and the true memory of the ET PA. The memory generated 
by the ET PA itself is inherent in the class of operation in the power amplifier and 
results for the dynamic behavior of the system and/or is induced by the supply 
modulator itself.
6.5.6  DPD Feedback Path
For the DPD feedback path (FB), the most important function is to provide align-
ment and parameter estimation for DPD coefficient adaptations so that the DPD 
adjusts the complex LUT or memory polynomial coefficients as the signal changes 
in real time. The objective of parameter estimation is to choose adaptation coeffi-
cients such that the PA output is as close to the DPD input signal as possible. How-
ever, because the concern is with spectral emissions improvement, the parameter 
estimation should choose the coefficients so that predistorter function most closely 
resembles the DPD input signal in some statistical sense. To separate the linear ef-
fect of the RF PA and the circuitry that drives it, parameter estimation is typically 
based on the aligned PA output signal. Therefore, the alignment process matches 
the amplitude, delay, and phase variations of PA output to DPD module output 
signal. The predistorter is then dedicated to only modeling the nonlinear effects for 
which it is intended.
There are several coefficient update algorithms available such as least square 
estimation (LSE), least mean squares (LMS), normalized LMS (NLMS), recursive 
least squares (RLS), and QR decomposition based RLS (QRD-RLS). Typically, the 
LSE method requires matrix inversion, large memory, and powerful processing ca-
pability. However, LMS can avoid such a matrix inversion operation. The advan-
tage of RLS methods is that they typically converge faster than LMS and NLMS so 
as to realize real-time coefficient adaptation. The memory requirement is also sig-
nificantly reduced compared to LSE method. However, they also suffer difficulties 
to handle numerical stability issues and operations on correlation matrix of input 
data, resulting in computationally expensive implementations. Finally, QRD-RLS 
is more robust and well suited for hardware implementation as well.
One other important thing is that the DPD attempts to add predistortion third-
order and fifth-order intermodulation products to the input signals that cancel out 

6.5  Digital Predistortion 
271
the third-order and fifth-order intermodulation products added by the PA. Thus, 
the bandwidth of the predistorted signal must be at least three times greater than 
the bandwidth of the input signals to be able to represent up to third-order inter-
modulation products. 
However, the concept of a Nyquist zone defines the frequency range of a signal 
that can be sampled by an ADC operating at a specific sampling rate. Typically, the 
dynamic performance of an ADC for DPD feedback observation is only suitable in 
the first and second Nyquist zones. Hence, a high Nyquist bandwidth is important 
criterion for ADCs used in DPD systems. Selections of feedback sampling rates 
and intermediate frequency (IF) of observation path should be considered for DPD 
feedback path implementations. To visualize what happens in sampling in the digi-
tal domain, the transparent “fan-fold” plane can be used to imagine how Nyquist 
zones work with signals as shown in Figure 6.24. Use the horizontal edge of the 
plane as the sampling frequency axis with DPD feedback ADC sampling rate as a 
reference and scale it so that the plane folds line up with integer multiples of one-
half of the sampling frequency fs. Each sheet of plane now represents a Nyquist 
zone.
As shown in Figure 6.24, the predistorted signals are fed into a DAC and then 
lowpass filtered at the Nyquist rate (half the feedback sample rate). The predis-
torted signal must have a sample rate of at least six times that of the original input 
signals. Thus, in simulations the input signals are interpolated by a factor of 6 be-
fore being fed into the predistorter. The sampling rate of transmitter DAC should 
be half of the feedback sampling rates and the IF of feedback path can be selected 
around the 3/4 sampling rate of DPD feedback ADC.
6.5.7  Indirect Learning DPD
The indirect learning DPD architecture was proposed by C. Eun and E. Powers [85] 
with two identical truncated Volterra models used for training in the feedback path 
and predistortion in the forward path. As shown Figure 6.25, the objective of the 
linearizer is to find a transformation of the signal z′(n) that in combination with the 
Figure 6.24  Illustrations of Nyquist zones for the DPD feedback path sampling rate and intermedi-
ate frequency selections.

272 
����������������������������������������������
Digital Front End Design for Envelope Tracking
nonlinear RF PA will result in an identity system that produces the signal of interest 
without distortion at the RF PA output y(n). The main challenge of this approach 
is to track and identify the time-varying characteristics of the RF PA. To address 
this task, a stochastic gradient adaptation mechanism is employed. The adaptation 
of the truncated Volterra system is a two-stage process. During initialization, the 
input and output signals of the PA are probed and the Volterra filter coefficients are 
adapted off-line using parameter estimation algorithms. This process is also known 
as initialization through indirect learning. Once the adaptive filter is initialized at 
an optimum stationary point, a stochastic adaptive mechanism is used to track 
the time-varying characteristics of the nonlinear PA. An indirect learning scheme 
requires two copies of predistorter to create an inverse model of the RF PA. The 
coefficients of forward-path predistorter are only updated after convergence. 
The two predistorted signals z′(n) and z(n) are compared to generate an error 
signal e(n). The polynomial coefficients are computed such that if e(n) = 0, then 
y(n)= x(n). The generated coefficients in the feedback path are used by the predis-
torter in the forward path until the next update by the training block. 
Initialization of the DPD linearizer is performed using optimum filtering, which 
is done as an off-line computation in DPD implementation. Adaptive filter coef-
ficient estimation can be considered a linear optimization task. Any of the common 
estimation methods such as LSE, LMS, NLMS, RLS, QRD-RLS, and others can be 
used. Note that while all of the above methods try to solve one optimization prob-
lem, that is, the linear parameter estimation, the stationary point obtained from 
using these methods might be quite different. This is mainly due to the fact that 
the error criterion for the approaches is different, causing a different profile for the 
error identification.
Figure 6.25  Block diagram of an indirect learning DPD. The outputs of the feedback and forward 
predistorters are compared. (From: [80]. © 2002 IEEE. Reprinted with permission.)

6.6  Image and Carrier Suppression 
273
6.5.8  Direct Learning DPD
Despite the decent linearization results that can be obtained by the indirect learn-
ing approach, the training predistorter in the feedback path and the translation 
method assume the commutative property for cascading nonlinear systems, which 
is not rigorous at all. Therefore, direct learning DPD was proposed as an alterna-
tive method for identifying and adapting the predistortion function. It permits an 
identification and later adaptation of the predistortion function that depends on the 
RF PA model such as the memory polynomial. The inverse of the nonlinear PA is 
adaptively tracked using a stochastic gradient method [86, 87].
As shown in Figure 6.26, direct learning DPD compares the inputs and outputs 
of the RF PA to generate update coefficients. After convergence, the output of RF 
PA should not contain distortions. The advantage of direct learning is that only 
one predistorter is used. The coefficients of forward path predistorter are updated 
only after convergence. Note that the output and input of the PA are compared. For 
example, a block of [z(n), y(n)] can be stored in an LUT. The predistorter training 
block is used to estimate coefficients to derive the inverse response of the PA by per-
forming polynomial curve fitting on the data in the LUT. It produces polynomial 
coefficients by solving the least squares problem. If the polynomial coefficients are 
stable after convergence, then y(n) = x(n). The generated coefficients in the feed-
back path will be used by the predistorter in the forward path until the next update 
by the parameter estimation block. The estimation error is an indication of how 
close the PA model is to the actual PA behaviors.
6.6  Image and Carrier Suppression
Quadrature modulation is a well-known and widely deployed technique used to 
conserve bandwidth for a given data rate. This is accomplished by modulating two 
orthogonal data streams onto a common carrier. A highly attractive method for 
modulating the carriers is through the use of an analog direct quadrature modula-
tor. These modulators can be wideband and require relatively slow speed DACs for 
a given bandwidth. If the phases and amplitudes of both branches of the modula-
tor are perfectly matched, then one of the sidebands is completely cancelled out. 
Figure 6.26  Block diagram of direct learning DPD. The output of the PA is compared with the input 
of the PA.

274 
����������������������������������������������
Digital Front End Design for Envelope Tracking
Likewise, if there is no DC bias feedthrough, then the carrier itself is completely 
cancelled out. However, in practice there will always be some amount of gain and 
phase imbalance along with a DC bias in analog quadrature modulators, and this 
can induce images and spurs in the transmitted spectrum if these fall outside of the 
occupied band. 
There are various factors and implementation imperfections that contribute to 
the degradation of the popular direct upconversion architecture with quadrature 
modulator (QM). Therefore, quadrature modulation correction (QMC) is needed. 
Spectral image and carrier feedthrough degrade EVM and spectrum mask require-
ments because there are nonidealities existing in practical implementations such as 
gain mismatch between I-Q channels, phase error due to the imperfection of the 
90° phase shifter, local oscillator (LO) leakage due to LO-RF feedthrough, and DC 
offsets in I-Q channels. All of the above degrade the modulation quality, but DPD 
contributes little to alleviate this kind of distortion and then QMC emerges.
The sensitivity of sideband suppression to quadrature modulation error (QME) 
is high. For example, it typically shows that to maintain a side-band suppression 
level of more than −50 dBc requires a gain imbalance of less than 0.1 dB and simul-
taneously a phase imbalance of less than 0.5°.
QMC circuitry can be included after the predistortion function which can be 
bypassed or selected as an option. When the QMC function is enabled, its param-
eters are estimated iteratively from sample captures that are interleaved with pre-
distortion correction estimation. 
6.6.1  Quadrature Modulation Errors
The block diagram of the I-Q modulator (FMOD) and QMC module is shown in 
Figure 6.27. The I-Q quadrature modulator has phase imbalance, gain imbalance, 
and DC-offset errors. With a careful layout design, the errors can be minimized, 
but they can never be completely nulled. The phase imbalance is caused mainly 
by the local oscillator and phase shifter, which does not produce exactly 90° of 
phase shift between the two channels, resulting in a rotation of the axes in the I-Q 
coordinates as shown in Figure 6.27(b). The gain imbalance is caused mainly by 
the mixers, which are not exactly balanced, resulting in a distortion of the signal, 
and transforms the circular constellation in the I-Q coordinates to elliptical ones, 
as shown as a black, dashed line in Figure 6.27(b). The sideband suppression is a 
function of both the gain and phase imbalance. The carrier suppression is a function 
of the DC offset between I-signal and Q-signal. This offset can be compensated by 
altering the DC offset of the input signals. The DC offset shifts all sample points the 
same amount in the same direction, as shown as a gray, solid line in Figure 6.27(b). 
Together these imbalances cause the bit-error rate of the connection to increase. 
6.6.2  Quadrature Modulation Correction
To compensate the quadrature modulation errors, a correction mechanism can be 
added so that the errors presented in Figure 6.27(b) are cancelled out. The typi-
cal quadrature modulation correction compensator topologies are shown in Figure 
6.28. 

6.6  Image and Carrier Suppression 
275
The compensator structure for the balanced QMC [90] is presented in Figure 
6.28(a). The transfer function of such a symmetrical QMC is 
	
( )
( )
out
in
V
t
C V t
B
=
⋅
+
	
(6.18)
where Vout(t) and Vin(t) are the output and input of balanced compensator and C is 
the I-Q quadrature correction coefficient as
	
(
)
cos( )
sin( )
sec( ) (
)
0
C
G
β
φ
β
φ
φ
α β
α
⋅
−
⋅


=
⋅Φ =
⋅
⋅


	
(6.19)
With the gain imbalance as
Figure 6.27  (a, b) Quadrature modulator and typical quadrature modulation errors on the constel-
lation such as gain and phase imbalance and DC offset. (From: [93]. © 2003 Artech House. Reprinted 
with permission.)

276 
����������������������������������������������
Digital Front End Design for Envelope Tracking
Figure 6.28  Illustration of schemes of quadrature error corrections: (a) balanced structure and (b) imbalanced structure. (From: [95]. © 2000 Artech House. Reprinted 
with permission.)

6.6  Image and Carrier Suppression 
277
	
1
0
0
1
G
α
β


= 


	
(6.20)
and the phase imbalance as
	
1
tan( )
0
sec( )
φ
φ
−


Φ = 


	
(6.21)
B is the DC offset correction coefficient as
	
1
2
a
B
a
−


= 

−

	
(6.22)
In a wideband transmitter, the frequency dependence of I-Q mismatches must 
be taken into account. The wideband correction system is similar to the compensa-
tors shown in Figure 6.28(a), except that the correction terms are replaced by FIR 
filters [90].
The imbalanced method for the QMC compensator in [88] is an improved 
version of the balanced method, as shown in Figure 4.28(b). The improvement sug-
gests that a more economical asymmetric form of compensator that results in lower 
computational load and faster convergence to be used. The balanced QMC archi-
tecture in Figure 6.28(a) requires four multipliers and four adders, while the imbal-
anced QMC in Figure 6.28(b) needs three multipliers and three adders. Moreover, 
a simplification is made and a division with α can be neglected in (6.20), as it 
has no substantial effect on the results and produces only a scale change of a few 
percentage points. Therefore, this further reduces the number of the multipliers to 
two. The adaptation algorithm itself has only to acquire four remaining imbalance 
compensation terms in (6.19) and (6.22). 
6.6.3  Adaptive QMC
An adaptive way of compensating the I-Q modulator errors can be realized for 
real-time QMC [92]. The QM and PA produces unwanted components on the radio 
frequencies and these components may affect the data transmission on both EVM 
and ACPR. The method adjusts the correction coefficients in a way that the adja-
cent channel power is minimized. There are two main ways to do this. One way is 
to use a particular training signal and the DSP processes the sampled information 
of this signal to cancel the changing nonlinearities. The second way is to sample the 
data and compensate the errors as the data is transmitted without a training signal. 
The method of adaptation is to reuse the DPD feedback network for real-time 
observation. The basic idea of adaptation is to have some samples of the data and 
some sort of estimation of the imbalances. A digital signal processor calculates 
the correction terms to compensate for the I-Q modulator errors. There are some 
algorithms used commonly when searching convergence of the correction terms. 
The choice of the adaptation algorithm leads to different convergence speeds and 

278 
����������������������������������������������
Digital Front End Design for Envelope Tracking
computational complexities in general. Five sets of updated values can be obtained 
from the DPD feedback path for α, β (gains for both channels), a1, a2 (DC offsets), 
and φ (phase imbalance between channels). Thus, five equations are obtained for 
five unknown variables at different time instants. When the impairment values are 
known, both channels are updated with new values measured.
References
[1]	
Wang, Z. C., et al., “Driver Amplifier Design Considerations for High Efficiency Envelope 
Tracking Power Amplifier Line-Up,” 2012 IEEE 13th Annual Wireless and Microwave 
Technology Conference (WAMICON), 2012, pp. 1–8.
[2]	
Pauli, M., and H. P. Kuchenbecker, “Minimization of the Intermodulation Distortion of a 
Nonlinearly Amplified OFDM Signal,” Wireless Personal Communications, 1997.
[3]	
Van Nee, R., and A. De Wild, “Reducing the Peak-to-Average Power Ratio of OFDM,” 48th 
IEEE Vehicular Technology Conference 1998 (VTC ’98), Vol. 3, 1998, pp. 2072–2076.
[4]	
Pauli, M., and H. P. Kuchenbecker, “On the Reduction of the Out-of-Band Radiation of 
OFDM-Signals,” Proc. IEEE Int. Conf. on Communications, Vol. 3, 1998, pp. 1304–1308.
[5]	
Vaananen, O., J. Vankka, and K. Halonen, “Simple Algorithm for Peak Windowing and Its 
Application in GSM, EDGE and WCDMA Systems,” Proc. of IEE Communications, Vol. 
152, June 3, 2005, pp. 357–362.
[6]	
Vaananen, O., “Digital Modulators with Crest Factor Reduction Techniques,” Ph.D. the-
sis, Helsinki University of Technology, Espoo, Finland, March 2006.
[7]	
Cha, S., et al., “A New PAPR Reduction Technique for OFDM Systems Using Advanced 
Peak Windowing Method,” IEEE Transactions on Consumer Electronics, Vol. 54, No. 2, 
May 2008, pp. 405–410.
[8]	
Kimball, D., et al., “High-Efficiency Envelope Tracking W-CDMA Base-Station Amplifier 
Using GAN HFETs,” IEEE Transactions on Microwave Theory and Techniques, Vol. 54, 
No. 11, November 2006, pp. 3848–3856.
[9]	
Vaananen, O., J. Vankka, and K. Halonen. “Effect of Clipping in Wideband CDMA System 
and Simple Algorithm for Peak Windowing,” World Wireless Congress, San Francisco, CA, 
2002, pp. 614–619.
[10]	
Lashkarian, N., H. Tarn, and C. Dick, “Crest Factor Reduction in Multi-Carrier WCDMA 
Transmitters,” IEEE 16th International Symposium on Personal, Indoor and Mobile Ra-
dio Communications 2005 (PIMRC 2005), Vol. 1, 2005, pp. 321–325.
[11]	
Han, S. H., and J. H. Lee, “An Overview of Peak-to-Average Power Ratio Reduction Tech-
niques for Multicarrier Transmission,” IEEE Wireless Communications, April 2005, pp. 
56–65.
[12]	
Krongold, B. S., and D. L. Jones, “PAR Reduction in OFDM Via Active Constellation 
Extension,” IEEE Transactions on Broadcasting, Vol. 49, No. 3, September 2003, pp. 
258–268.
[13]	
Saul, A., “Generalized Active Constellation Extension for Peak Reduction in OFDM Sys-
tems,” IEEE Intl. Conf. on Communications, Vol. 3, May 2005, pp. 1974–1979.
[14]	
Krongold, B. S., and D. L. Jones, “An Active Set Approach for OFDM PAR Reduction 
Via Tone Reservation,” IEEE Transactions on Signal Processing, Vol. 52, No. 2, February 
2004, pp. 495–509.
[15]	
Srivastava, G. K., and N. K. Tadkapalli, “Crest Factor Reduction for Carrier Aggregated 
OFDM Systems,” 2012 20th International Conference on Software, Telecommunications 
and Computer Networks (SoftCOM), 2012, pp. 1–6.
[16]	
Kim, W. J., et al., “Doherty Feed-Forward Amplifier Performance Using a Novel Crest Fac-
tor Reduction Technique,” IEEE Microwave and Wireless Components Letters, Vol. 17, 
2007, pp. 82–84.

6.6  Image and Carrier Suppression 
279
[17]	
Texas Instruments Incorporation, “GC1115 Crest Factor Reduction Processor,” Datasheet, 
2009.
[18]	
Optichron Inc., “OP5000 Crest Factor Reduction Processor,” Datasheet, 2008.
[19]	
Zeng, Z. B., D. Xie, and Y. Q. Huang, “A Crest Factor Reduction Method in Digital Pre-
distortion for Improvement of Power Efficiency,” 2012 International Conference on Com-
puter Science and Electronics Engineering (ICCSEE), Vol. 3, 2012, pp. 636–639.
[20]	
Liang, X., “Apparatus and Method for Generating a Multicarrier Communication Signal 
Having a Reduced Crest Factor,” U.S. Patent 8 259846 B2, July 30, 2008.
[21]	
Zigang, Y., “Method and System for Crest Factor Reduction,” U.S. Patent Publication 
20100246714 A1, September 30, 2010.
[22]	
Zhao, C. M., “Constrained Clipping for Crest Factor Reduction in Multiple-User OFDM,” 
2007 IEEE Radio and Wireless Symposium, 2007, pp. 341–344.
[23]	
Baxley, R. J., C. M. Zhao, and G. T. Zhou, “Constrained Clipping for Crest Factor Reduc-
tion in OFDM,” IEEE Transactions on Broadcasting, Vol. 52, 2006, pp. 570–575.
[24]	
Deumal, M., et al., “Constrained Clipping for Peak Power Reduction of Multicarrier Sys-
tems by Tone Reservation,” IEEE 65th Vehicular Technology Conference 2007 (VTC2007 
Spring), 2007, pp. 2195–2199.
[25]	
Wang, F., et al., “Design of Wide-Bandwidth Envelope-Tracking Power Amplifiers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 4, April 2005, pp. 1244–1255.
[26]	
Hassan, M., et al., “A Wideband CMOS/GaAs HBT Envelope Tracking Power Amplifier 
for 4G LTE Mobile Terminal Applications,” IEEE Transactions on Microwave Theory and 
Techniques, Vol. 60, No. 5, May 2012, pp. 1321–1330.
[27]	
Choi, J., et al., “A Polar Transmitter with CMOS Programmable Hysteretic-Controlled 
Hybrid Switching Supply Modulator for Multistandard Applications,” IEEE Transactions 
on Microwave Theory and Techniques, Vol. 57, No. 7, July 2009, pp. 1675–1686.
[28]	
Kim, D., et al., “Optimization for Envelope Shaped Operation of Envelope Tracking Power 
Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, No. 7, July 
2011, pp. 1787–1795.
[29]	
Jeong, J., et al., “Wideband Envelope Tracking Power Amplifier with Reduced Bandwidth 
Power Supply Waveform,” IEEE MTT-S Intl. Microwave Symp. Dig., Boston, MA, June 
2009, pp. 1381–1384.
[30]	
Wang, F., et al, “Design of Wide-Bandwidth Envelope-Tracking Power Amplifiers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 4, April 2005, pp. 1244–1255.
[31]	
Kimball, D., et al., “50% PAE WCDMA Base Station Amplifier Implemented with GaN 
HFETs,” IEEE Compound Semiconductor Integrated Circuit Symposium (CSIC ’05), 
2005, pp. 1–4. 
[32]	
Hsia, C., “Envelope Amplifier Design for Wireless Base-Station Power Amplifiers,” Ph.D. 
dissertation, University of California, San Diego, 2010.
[33]	
Yan, J. J., et al., “Design of a 4-W Envelope Tracking Power Amplifier with More Than 
One Octave Carrier Bandwidth,” IEEE Journal of Solid-State Circuits, Vol. 47, 2012, pp. 
2298–2308.
[34]	
Kimball, D., et al., “Efficient and Wideband Envelope Amplifiers for Envelope Tracking 
and Polar Transmitters,” 2013 IEEE Topical Conference on Power Amplifiers for Wireless 
and Radio Applications (PAWR), 2013, pp. 13–15.
[35]	
Kimball, D., et al., “High-Efficiency Envelope Tracking W-CDMA Base-Station Amplifier 
Using GAN HFETs,” IEEE Transactions on Microwave Theory and Techniques, Vol. 54, 
No. 11, November 2006, pp. 3848–3856.
[36]	
Wu, R. L., et al., “High-Efficiency Silicon-Based Envelope-Tracking Power Amplifier De-
sign With Envelope Shaping for Broadband Wireless Applications,” IEEE Journal of Solid-
State Circuits, Vol. 48, No. 9, 2013, pp. 2030–2040.

280 
����������������������������������������������
Digital Front End Design for Envelope Tracking
[37]	
Jeong, J., et al., “Envelope Tracking Power Amplifiers with Reduced Peak-to-Average 
Power Ratio RF Input Signals,” IEEE Radio and Wireless Symposium (RWS), 2010, pp. 
112–115. 
[38]	
Kim, D., et al., “Optimization for Envelope Shaped Operation of Envelope Tracking Power 
Amplifier,” IEEE Transactions on Microwave Theory and Techniques, Vol. 59, No. 7, July 
2011, pp. 1787–1795.
[39]	
Carvalho, N. B., and J. C. Pedro, “Large- and Small-Signal IMD Behavior of Microwave 
Power Amplifiers,” IEEE Transactions on Microwave Theory and Techniques, Vol. 47, 
No. 12, December 1999, pp. 2364–2374.
[40]	
Fager, C., et al., “A Comprehensive Analysis of IMD Behavior in RF CMOS Power Ampli-
fiers,” IEEE Journal of Solid-State Circuits, Vol. 39, No. 1, January 2004, pp. 24–34.
[41]	
Malaver, E., et al., “Characterizing the Linearity Sweet-Spot Evolution in FET Devices,” 
Proc. 11th GaAs Symp., Munich, Germany, October 2003, pp. 361–364.
[42]	
Pedro, J. C., J. A. Garcia, and P. M. Cabral, “Nonlinear Distortion Analysis of Polar Trans-
mitters,” IEEE Transactions on Microwave Theory and Techniques, Vol. 55, No. 12, De-
cember 2007, pp. 2757–2765.
[43]	
Giovannelli, N., et al., “Efficiency and Linearity Enhancements with Envelope Shaping 
Control in Wideband Envelope Tracking GaAs PA,” 2011 Workshop on Integrated Non-
linear Microwave and Millimetre-Wave Circuits (INMMIC), 2011, pp. 1–4.
[44]	
Cidronali, A., and G. Manes, “Efficiency and Linearity Enhancements with Envelope Shap-
ing Control in Dual-Band Envelope Tracking GaAs PA,” 2011 European Microwave Inte-
grated Circuits Conference (EuMIC), 2011, pp. 308–311.
[45]	
Cripps, S. C., RF Power Amplifiers for Wireless Communications, Norwood, MA: Artech 
House, 2006.
[46]	
Reynaert, P., and M. S. J. Steyaert, “A 1.75-GHz Polar Modulated CMOS RF Power Am-
plifier for GSM-EDGE,” IEEE Journal of Solid-State Circuits, Vol. 40, No. 12, December 
2005, pp. 2598–2608.
[47]	
Wang, F., et al., “An Improved Power-Added Efficiency 19-dBm Hybrid Envelope Elimi-
nation and Restoration Power Amplifier for 802.11g WLAN Application,” IEEE Trans-
actions on Microwave Theory and Techniques, Vol. 54, No. 12, December 2006, pp. 
4086–4099.
[48]	
Gilabert, P. L., et al., “Slew-Rate and Efficiency Trade-Off in Slow Envelope Tracking 
Power Amplifiers,” 2012 The 7th German Microwave Conference (GeMiC), 2012, pp. 
1–4.
[49]	
Montoro, G., et al., “Slew-Rate Limited Envelopes for Driving Envelope Tracking Ampli-
fiers,” IEEE Topical Conference on Power Amplifiers for Wireless and Radio Applications 
(PAWR), 2011, pp. 1–3.
[50]	
Montoro, G., et al., “A Method for Real-Time Generation of Slew-Rate Limited Envelopes 
in Envelope Tracking Transmitters,” IEEE Intl. Microwave Series on RF Front Ends for 
Soft. Defined and Cognitive Radio Solutions, Aveiro, Portugal, February 2010, pp. 1–4.
[51]	
Jeong, J., et al., “Wideband Envelope Tracking Power Amplifiers with Reduced Bandwidth 
Power Supply Waveform and Adaptive Digital Predistortion Techniques,” IEEE Transac-
tions on Microwave Theory and Techniques, Vol. 57, December 2009, pp. 3307–3314.
[52]	
Montoro, G., et al., “Digital Predistortion of Envelope Tracking Amplifiers Driven by Slew-
Rate Limited Envelopes,” 2011 IEEE MTT-S International Microwave Symposium Digest 
(MTT), 2011, pp. 1–4.
[53]	
Kim, B., et al., “Push the Envelope,” IEEE Microwave Magazine, May 2013, pp. 68–81.
[54]	
Wang, F., et al., “Design of Wide-Bandwidth Envelope-Tracking Power Amplifiers for 
OFDM Applications,” IEEE Transactions on Microwave Theory and Techniques, Vol. 53, 
No. 45, April 2005, pp. 1244–125.
[55]	
Su, D. K., and W. J. McFarland, “An IC for Linearizing RF Power Amplifiers Using Enve-
lope Elimination and Restoration,” IEEE Solid-State Circuits, Vol. 33, No. 12, December 
1998, pp. 2252–2258.

6.6  Image and Carrier Suppression 
281
[56]	
Raab, F. H., “Envelope Elimination and Restoration System Requirements,” Proc. RF 
Technology Expo ’88, Anaheim, CA, February 1988, pp. 499–512.
[57]	
Wang, F., et al., “An Improved Power-Added Efficiency 19-Dbm Hybrid Envelope Elimina-
tion and Restoration Power Amplifier for 802.11g WLAN Applications,” IEEE Transac-
tions on Microwave Theory and Techniques, Vol. 54, No. 12, 2006, pp. 4086–4099.
[58]	
Shaun, C., “Signal Alignment for Envelope Tracking System,” U.S. Patent 8514018 B2, 
August 2013.
[59]	
Nadim, K., et al., “Group Delay Calibration Method for Power Amplifier Envelope Track-
ing,” U.S. Patent Application 20130034139 A1, February 2013.
[60]	
Saleh, A. A. M., and J. Salz, “Adaptive Linearization of Power Amplifiers in Digital Radio 
Systems,” The Bell System Technical Journal, Vol. 62, No. 4, April 1983, pp. 1019–1033.
[61]	
Aschbacher, D. E., “Digital Predistortion of Microwave Power Amplifiers,” Ph.D. thesis, 
Vienna University of Technology, 2005.
[62]	
Pinal, P. L. G., “Multi Look-Up Table Digital Predistortion for RF Power Amplifier Linear-
ization,” Ph.D. thesis, Universitat Politecnica de Catalunya, December 2007.
[63]	
Wiener, N., Nonlinear Problems in Random Theory, New York: John Wiley, 1958.
[64]	
Schetzen, M., The Volterra and Wiener Theories of Nonlinear Systems, New York: John 
Wiley, 1980.
[65]	
Ljung, L., System Identification, Theory for the User, 2nd ed., Upper Saddle River, NJ: 
Prentice Hall, 1999.
[66]	
Saleh, A. A. M., “Frequency-Independent and Frequency-Dependent Nonlinear Models of 
TWT Amplifiers,” IEEE Transactions on Communications, Vol. COM-29, No. 11, No-
vember 1981, pp. 1715–1720.
[67]	
Nagata, Y., “Linear Amplification Technique for Digital Mobile Communications,” Pro-
ceedings of the 39th IEEE Vehicular Technology Conference, May 1989, pp. 159–164.
[68]	
Minowa, M., et al., “Backoff Improvement of an 800-MHz GaAs FET Amplifier Using an 
Adaptive Nonlinear Distortion Canceller,” Proceedings of the 40th IEEE Vehicular Tech-
nology Conference, May 1990, pp. 542–546.
[69]	
Mansell, A., and A. Bateman, “Practical Implementation Issues for Adaptive Predistortion 
Transmitter Linearisation,” IEE Colloquium on Linear RF Amplifiers and Transmitters, 
April 1994, pp. 1–7.
[70]	
Faulkner, M., and M. Johansson, “Adaptive Linearization Using Predistortion Experimen-
tal Results,” IEEE Transactions on Vehicular Technology, Vol. 43, No. 2, May 1994, pp. 
323–332.
[71]	
Cavers, J. K., “A Linearizing Predistorter with Fast Adaptation,” IEEE Transactions on 
Vehicular Technology, Vol. 39, No. 4, November 1990, pp. 374–382.
[72]	
Intersil, Inc., “Operation and Performance of the ISL5239 Predistortion Linearizer,” Ap-
plication Note AN1022, July 2002.
[73]	
Gilabert, P., G. Montoro, and E. Bertran, “On the Wiener and Hammerstein Models for 
Power Amplifier Predistortion,” Proceedings of the 2005 IEEE APMC, 2005, pp. 349–356. 
[74]	
Shah, A., and B. Jalali, “Adaptive Equalization for Broadband Predistortion Linearization 
of Optical Transmitters,” IEEE Proceedings on Optoelectronics, Vol. 152, No. 1, 2005, 
pp. 16–32.
[75]	
Kim, J., and K. Konstantinou, “Digital Predistortion of Wideband Signals Based on Power 
Amplifier Model with Memory,” Electronic Letters, Vol. 37, No. 23, 2001, pp. 1417–1418.
[76]	
Morgan, D., et al., “A Generalized Memory Polynomial Model for Digital Predistortion of 
RF Power Amplifiers,” IEEE Transactions on Signal Processing, Vol. 54, No. 10, 2006, pp. 
3852–3860.
[77]	
Ding, L., et al., “A Robust Digital Baseband Pre-Distorter Constructed Using Memory 
Polynomials,” IEEE Transactions on Communications, Vol. 52, No. 1, January 2004, pp. 
159–165.

282 
����������������������������������������������
Digital Front End Design for Envelope Tracking
[78]	
Ding, L., et al., “Effects of Even-Order Nonlinear Terms on Power Amplifier Modeling and 
Predistortion Linearization,” IEEE Transactions on Vehicular Technology, Vol. 53, No. 1, 
January 2004, pp. 156–162.
[79]	
Dallinger, R., et al., “Adaptive Pre-Distortion Techniques Based on Orthogonal Polynomi-
als,” 2010 Conference Record of the 44th Asilomar Conference on Signals, Systems and 
Computers (ASILOMAR), 2010, pp. 1945–1950. 
[80]	
Ding, L., et al., “Memory Polynomial Predistorter Based on the Indirect Learning Architec-
ture,” IEEE Global Telecommunications Conference, Taipei, Taiwan, Vol. 1, November 
2002, pp. 967–971.
[81]	
Draxler, P., et al., “Memory Effect Evaluation and Predistortion of Power Amplifiers,” 
Proc. IEEE MTT-S Intl. Microwave Symp., Long Beach, CA, June 2005, pp. 1549–1552.
[82]	
Shi, Z., et al., “Time Domain Delay Items Design for Memory Orthogonal Polynomial 
Predistorter,” 2012 IEEE 75th Vehicular Technology Conference (VTC Spring), 2012, pp. 
1–5.
[83]	
Zhang, J., S. B. He, and G. Lu, “Design of a Memory Polynomial Predistorter for Wide-
band Envelope Tracking Amplifiers,” Journal of Systems Engineering and Electronics, Vol. 
22, No. 2, 2011, pp. 193–199.
[84]	
Draxler, P., et al., “Quantifying Distortion of RF Power Amplifiers for Estimation of Pre-
distorter Performance,” 2008 IEEE MTT-S International Microwave Symposium Digest, 
June 2008, pp. 931–934.
[85]	
Eun, C., and E. Powers, “A New Volterra Predistorter Based on the Indirect Learning Ar-
chitecture,” IEEE Transactions on Signal Processing, Vol. 45, No. 1, January 1997, pp. 
223–227.
[86]	
Lashkarian, N., “FPGA Implementation of Digital Predistortion Linearizers for Wideband 
Power Amplifiers,” Proceeding of the SDR 04 Technical Conference and Product Exposi-
tion, 2004, pp. 1–6.
[87]	
Kim, J., and K. Konstantinou, “Digital Predistortion of Wideband Signals Based on Power 
Amplifier Model with Memory,” Electronic Letters, Vol. 37, No. 23, November 2001, pp. 
1417–1418.
[88]	
Cavers, J. K., and M. Liao, “Adaptive Compensation Methods for Imbalance and Offset 
Losses in Direct Conversion Transceivers,” IEEE Transactions on Vehicular Technology, 
Vol. 42, No. 4, November 1993, pp. 581–588.
[89]	
Vankka, J., Digital Synthesizers and Transmitters for Software Radio, New York: Springer, 
2005.
[90]	
Pun, K.P., J. E. Franca, and C. Azeredo-Leme, “Wideband Digital Correction of I and Q 
Mismatch in Quadrature Radio Receivers,” Proc. IEEE International Symposium on Cir-
cuits and Systems (ISCAS), May 2000, pp. 661–664.
[91]	
Faulkner, M., T. Mattsson, and W. Yates, “Automatic Adjustment of Quadrature Modula-
tors,” Electronic Letters, Vol. 27, No. 3, January 1991, pp. 214–216.
[92]	
Hilborn, D. S., S. P. Stapleton, and J. K. Cavers, “An Adaptive Direct Conversion Transmit-
ter,” IEEE Transactions on Vehicular Technology, Vol. 43, No. 2, May 1994, pp. 223–233.
[93]	
Zhang, X. J., L. E. Larson, and P. M. Asbeck, Design of Linear RF Outphasing Power Am-
plifiers, Norwood, MA: Artech House, 2003.
[94]	
Cripps, S. C. Advanced Techniques in RF Power Amplifier Design, Norwood, MA: Artech 
House, 2002.
[95]	
Kenington, P. B., High-Linearity RF Amplifier Design, Norwood, MA: Artech House, 
2000.
[96]	
Hentschel, T., M. Henker, and G. P. Fettweis, “The Digital Front End of Software Radio 
Terminals,” IEEE Personal Communications, Vol. 6, No. 4, August 1999, pp. 40–46.
[97]	
Chen, G. G., R. Ansari, and Y. W. Yao, “Improved Peak Windowing for PAPR Reduction 
in OFDM,” IEEE 69th Vehicular Technology Conference 2009 (VTC Spring 2009), 2009, 
pp. 1–5 

283
C H A P T E R  7 
Experimental Methodologies and 
Measurements for Envelope Tracking
Within the past decade, ET technology for wireless communication has established 
itself as an effective method of enhancing the efficiency of RF PA and reducing 
cooling demands caused by wasted energy dissipated as heat. Because the ET PA 
has become an emerging but critical subsystem in a modern wireless transmitter, 
it is significant to evaluate its key parameters such as power, bandwidth, linearity, 
and efficiency with proper experimental measurement methods to understand its 
real behavior and characteristics. As mentioned previously, ET PA is no longer a 
“self-contained” RF system, involving envelope generation and processing, supply 
modulator, and necessary linearization schemes. Therefore, in this chapter, the con-
tents are organized by classification of measurements for various function blocks. 
Finally, the methodologies of measurement for the whole ET PA with all functions 
integrated will be introduced for a clear picture of the test method from a systematic 
perspective. Hence, this chapter covers the fundamentals of ET PA measurements 
utilizing the data gathered from experiments to identify crucial ET parameters. 
Based on these parameters, several measurement setups are proposed and analyzed 
that can satisfy the challenging requirements of ET measurements.
7.1  Motivation and Introduction
ET boosts the efficiency of RF PAs by replacing the fixed DC supply by a dynamic 
supply voltage, which closely tracks the RF envelope shape. Although ET prom-
ises considerable power savings and superior thermal performance over traditional 
fixed DC power supplies, it not only challenges ET PA design but also brings about 
difficulties in measurement methodology. The ever-increasing complexities to PA 
characterization results from the fact that the PA device in the ET system is cur-
rently a three-port device, with the supply bias acting as a high bandwidth control 
input. It involves many sophisticated measurement techniques compared to conven-
tional fixed DC supply PAs to properly characterize and optimize the performance 
of an ET PA to achieve the full efficiency gains enabled by the ET technique. The 
measurement solution needs to address the most crucial measurement challenges 
and, based on measurements, makes it a rather compelling ET PA solution. There-

284 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
fore, the scope of this chapter is focusing on how to build a test bench where we can 
do most measurements necessary for an ET PA design.
7.1.1  ET Test Considerations
Substantial power is wasted when employing conventional fixed DC power sup-
plies, making ET capability crucial to the PAs for emerging 4G LTE-A and beyond. 
Although it promises to significantly enhance RF PA efficiency, transforming cur-
rent measurement and characterization setups to accommodate ET is a demanding 
and costly endeavor. The combination of power level, modulation signal, frequency, 
and stringent linearity requirements creates major measurement challenges in the 
following four aspects of the ET test system. First, for envelope generation and 
processing, the analog parts of envelope signal generation require an especially 
elaborate evaluation on its quality to guarantee the overall ET system performance. 
It should be considered as another important input different from traditional RF PA 
designs. Second, high-PAPR signal, high peak drain voltage, and current require-
ments demand new supply modulator measurements and careful attention to the 
supply-modulator-to-PA interface characterization from the modulator measure-
ment aspect. Third, complex stimulus measurements for RF PA should be enabled 
under the ET operation. Key parameters measured with modulated signals with 
dynamic supply are typically required for the ET evaluation to understand its true 
behavior. Finally, for linearization processing, linearity requirements force the use 
of novel and more complex correction algorithms and high signal bandwidth re-
quires a high degree of timing precision. Therefore, at the development stage, a 
solution that generates fully synchronous RF and envelope waveforms in the test 
bed is a must for ET PA measurement.
7.1.2  Modulated Signal Measurement
Modulated signal generation is an important procedure for ET measurement and 
sequential analysis. As is well understood, the characters of the modulated sig-
nal source can enable an ET designer to test physical-layer implementations with 
greater insight and confidence. Practically, there are several methods to generate 
a modulated signal for measurement purposes. Either home-baked bit-file down-
loading or commercial signal generation software works for ET test bed. However, 
the most significant point for selection is whether it can define and optimize test 
stimuli for RF PA, utilizing envelope waveforms based on the specific standard I-Q 
signal. Furthermore, the crucial timing alignment between envelope and I-Q must 
be achieved with picosecond resolution and real-time adaptive adjustments. Finally, 
the signal sequence can be typically utilized under a periodic playback during test-
ing, but with the data length requirement to be demodulated for EVM and modula-
tor error measurements.
As shown in Figure 7.1, the modulated signal source generation includes both 
RF signal and envelope generations, respectively, whose waveforms are all gener-
ated from the same base band I-Q waveform. However, in other practical envelope 
generation variants, the envelope signal can be derived from either the baseband 
I-Q signal, or the RF signal, produced by an RF envelope detector. In the envelope 
signal path, after envelope magnitude transformation via (3.8) and gain scaling by 

7.1  Motivation and Introduction 
285
the multiplier, the envelope shaping function is applied before the envelope wave-
form generation. Then the envelope waveform piece can be downloaded into an 
arbitrary waveform generator (AWG) directly. Finally, the output analog wave-
form of the envelope is injected into the supply modulator with specific electrical 
interface requirements (e.g., MIPI eTrak as discussed in Chapter 3). The digitally 
modulated RF signal is generated from baseband in the I-Q format via upconver-
sion to the RF band directly and serves as the other input of the ET PA system after 
optional CFR and predistortion processing. However, the maximum sampling rate 
may far exceed the typical sample rates, it happens if there is a predistortion linear-
ization scheme considered because the predistorted side bands require more band-
width from baseband processing. As mentioned above, the signals are repeating 
sequence of the samples. However, each piece signal can be configured with varying 
data rates to various settings because the signal such as the 4G LTE-A downlink 
can be highly reconfigurable for diverse application scenarios. On this point, com-
mercial signal generation software is more powerful to standardize measurement 
conditions as a set of several test models, with each to be employed for different 
conformance tests. Moreover, the sample number utilized in the measurement sig-
nal source should be sufficiently large to guarantee the similarity to true real-time 
modulated signals. For example, with a typical LTE downlink 20-MHz test signal, 
the sequence length of the waveform can be set to multiples of 30,720 samples, 
equal to approximately multiples of 10 ms or one frame. Also, the total sample 
points can be scaled by the oversampling ratio accordingly. Utilizing a larger overs-
ampling ratio results in a more completely filtered image, but also consumes more 
waveform storage memory of the instrument by increasing the number of points. 
So far, the signal generation for measurement is not totally finished because there 
is a requirement of real-time timing alignment for the envelope and RF signals, 
the precision order of alignment can be mandatory into in picosecond resolution. 
Consequently, the RF signal generator should be in charge of the full ET control 
including timing alignment with an optimum repeatability.
Because the time-averaging PA efficiency is a strong function of the PAPR, 
substantial work needs to be devoted to reducing the PAPR of modulated signals 
while maintaining acceptable linearity before the envelope generation processing, 
as shown in Figure 7.1. However, the CFR algorithm may result in obvious band-
limited distortion to the original baseband signal to cut peak amplitude levels. 
Figure 7.1  Illustration of a block diagram of modulated signal generation scheme for the ET system 
measurement with the ET PA equivalent as a three-port DUT.

286 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Degradation of linearity is expected with CFR processing, typically most evident 
in increased EVM. Hence, PAPR reduction needs to be compromised to keep ac-
ceptable linearity. The trade-off of linearity and CFR is needed to find a midway to 
maintain overall system performance. For example, the PAPR of an LTE 20-MHz 
downlink baseband signal has been typically clipped to 7 dB from the original 10 
dB to achieve a balanced figure of merits via a series of quid pro quos. A PAPR cut 
with little increase in ACPR and less than 5% increase in EVM can considered as 
acceptable because the decrease in PAPR usually allows increased average power 
and efficiency. In certain scenarios, a 2~3 dB reduction of PAPR can lead to reduced 
DC power consumption by 50% [1]. Because EVM at a certain PAPR varies de-
pending upon the CFR algorithm used (and its implementation), the impact of the 
CFR on EVM measurements should be negligible from transmitter linearity perfor-
mance. Additive EVM is thus defined as the difference between EVM measured at 
the transmitter output and EVM of the desired signal, which can be utilized to in-
dicate the modulation quality degradation caused by related ET system processing. 
The capability to reduce PAPR is strongly dependent upon the type of algorithms 
selected as discussed in Chapter 6. 
Typically, for a 20-MHz LTE-A waveform, the envelope waveform generated 
should have at least 60 MHz of bandwidth, as discussed in Chapter 2. Moreover, in 
cases where wideband predistortion is applied on the supply modulator, the band-
width requirements of the drain/collector supply voltage waveform are usually up 
to five times higher or more than the bandwidth of the actual RF channel signal. 
Unfortunately, it is not adequate that an AWG can provide such wide bandwidths, 
but it must also have excellent time resolution. Another challenge with the enve-
lope voltage is that the AWG cannot supply enough current to power an RF PA 
directly, and instrumental power supplies cannot offer the bandwidth required for 
ET. The solution to this problem is to drive the PA with a supply modulator that is 
driven by a DC supply and envelope signal from an AWG. 
Another important thing to know about the modulated signal source is the 
statistics such as power distribution histogram and complementary cumulative dis-
tribution function (CCDF). These will change by setting different digital modula-
tion options such as mapping type, multicarrier, and bandwidth, which may cause 
variations of PAPR. As a result, it is certainly helpful to be acquainted with how ET 
works with different modulated signals with different settings.
7.1.3  Measurement Process
As illustrated in Figure 7.2, in the RF PA branch of chart, the PA design consists 
of finding and implementing the optimum matching network for the PA device to 
maximize the average efficiency of ET PA for a specific modulated signal with a 
given PDF character. In addition, the interconnection between RF PA and supply 
modulator output has to be carefully considered to produce a wide and flat fre-
quency response that is typically at least three times of the RF signal bandwidth. 
Also, it requires low impedance within the operating bandwidth of the supply mod-
ulator to minimize the transmission loss. The quarter-wave line and the resonant ca-
pacitor of fundamental frequency are put at the drain/collector supply side. During 
measurements without the supply modulator present, an additional bank of shunt 
capacitors is employed for stability to keep the drain/collector voltage from sagging 

7.1  Motivation and Introduction 
287
or ringing, especially in process of DC-supplied RF pulse measurements. However, 
under the ET mode, the above DC-supplied measurement circuit can be replaced by 
a supply modulator, and all capacitors should be removed from the drain/collector 
bias network except for the resonant capacitor on the fundamental frequency. Fi-
nally, ET optimization can be performed at the system level with baseband process-
ing approaches incorporated into the system.
As shown in Figure 7.3, before all building blocks are available for whole sys-
tem integration, instruments can be employed to play the role of the part that is 
absent. In the ET test bed system, the AWG plays a role of a digital-to-analog 
Figure 7.2  illustration of ET PA design flow. It is an outline of the measurement process working from an ET 
PA design and test cycle.

288 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Figure 7.3  Typical experiment setup for ET PA characterization. The block diagram of the ET PA test system based on instruments is illustrated here.

7.1  Motivation and Introduction 
289
converter (DAC) in the typical envelope path that is required in practical ET imple-
mentation. Also, an RF signal generator is arranged into the RF path for main 
RF signal generation. The RF signal generator is utilized to emulate typical RF 
transmitter functionality but the power consumed by the generator is not taken 
into account when evaluating ET system efficiency. The RF signal generator is ca-
pable of controlling nonideal effects like quantization noise, finite sample rate, 
I-Q signal imbalance, and distortion, hence emulating and selecting the possible 
distortion sources. Especially in early phase of ET PA development, the test bed 
is free from nonideality in the measurement system without additional concerns. 
However, nonideal system effects can be added artificially into the test bed later to 
estimate absolute component performance requirements and impacts for a practi-
cal implementation.
The first step of the test bed is to build a rigidly synchronous RF and envelope 
waveform generation scheme. Hence, a specialized synchronization feature can be 
employed to lock the memory clocks and achieve very precise triggering between 
the two generators. Under a typical ET operation mode with a 20-MHz band-
width, timing misalignment more than 1 ns can lead to an obvious negative influ-
ence on the modulation quality of a transmitted signal with both ACPR and EVM 
affected. Hence, instrument synchronization is a crucial specification of an ET test 
setup because of the stringent synchronization requirements. In an ET test bed, 
instruments are interconnected through several sharing clocks and trigger-signal 
distribution lines. Timing alignment to this level can be realized by means of a pair 
of signal generators with a shared baseband reference clock as shown in Figure 
7.3. Typically, a 10-MHz reference clock is shared between the two signal sources, 
along with a trigger signal. The key to alignment is ensuring the signal generators 
are in a consistent trigger state when the waveform play-out activates. Currently, 
several commercial signal generation software tools are available to incorporate 
the ET option, providing a friendly manner to generate the RF and envelope signals 
required for measurements of the ET system. Furthermore, the control host of ET 
measurements can be implemented in a personal computer (PC). It can give access 
to envelope generation, timing alignment, shaping function management and hard-
ware control for both RF and envelope signals. The host downloads the RF and 
envelope waveform files directly to the RF signal generator and AWG respectively. 
Once waveforms are downloaded, the control of the host allows for dynamic tim-
ing alignment of RF and envelope signals between instruments giving typically a 
1-ps resolution, without the need to regenerate waveforms. Hence, it enables fine 
tuning of envelope timing by monitoring ACPR and EVM measurement at the out-
put of the ET PA. The second step of the test bed is the RF signal generator upcon-
verting the I-Q baseband signal to RF. A highly linear instrumental RF preamplifier 
with sufficiently high gain and peak output power capacity is inserted into the RF 
path right between the generator and RF PA. Although it may not be the choice 
for an embedded system, this setup is employed to avoid non-ET-related distor-
tion mechanisms. However, a variable-gain envelope preamplifier in the envelope 
path can be a flexible option designed with the highly linear operational amplifier 
(OPAMP) with more than 1-GHz gain-bandwidth product to preserve sufficient 
bandwidth right before the supply modulator. Additionally, the variable gain pre-
amplifier can also realize level shifting to accommodate supply modulator a proper 
input common mode voltage.

290 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Unfortunately, the ET measurement adds complexity to yet an already compli-
cated RF PA measurement system. The main challenge with the ET measurement is 
generating the modulated power supply, which can be required up to 2W to 300W 
with over 100-MHz modulation bandwidth for typical applications from UE to 
BTS, respectively. It is an uncommon specification for a supply modulator as dis-
cussed in Chapter 4. However, it is an important component to perform any ET PA 
measurement. It is difficult to be replaced by any instrument or to substitute mainly 
because its efficiency performance should be counted into the ET PA as a whole as 
well. These supply modulators take input as the RF envelope and a DC power and 
being supply utilized to control the drain/collector bias of an RF PA. The output 
is a high-power, envelope-shape-modulated waveform that powers the PA under 
test, as shown in Figure 7.3. It presents a typical RF PA test bed setup that has been 
expanded to support ET. In the test bed, a digitizing oscilloscope for capturing the 
envelope supply signals and a wideband current probe for measuring the transistor 
drain/collector current are employed for measurements. The overall measurement 
system is controlled by the PC host controller, that is, all the equipment are con-
nected to a PC through GPIB, USB, and LAN cables. Again, in such a complex 
multiple-instrument cooperated measurement system, the synchronization scheme 
is vital. More specifically, you must first determine which signal source is the timing 
master to supply the trigger signal and instrument clock reference. For example, a 
typical 10-MHz reference clock with a BNC cable connection on the rear panel of 
a generator is available for synchronization. Commonly, AWG or RF signal genera-
tor can serve as the timing master for synchronization among each other and other 
instruments. However, from the ET system perspective, synchronization between 
the envelope and RF signal paths must be very repeatable. Timing alignment re-
quirements mainly stem from the signal bandwidth. As discussed in Chapter 2, the 
linearity impact of uncompensated delay between the envelope and RF signal paths 
is proven to be dramatic. Therefore, timing and offset alignment between the two 
paths should be adjusted with resolution on the order of hundreds of picoseconds. 
By virtue of this alignment, any drift and jitter in the timing between the two paths 
are some multiples of that resolution. 
Additionally, there is a feedback observation path arranged from the RF PA 
output coupling to PC host, allowing the final output RF signal to be routed via a 
vector signal analyzer (VSA) for distortion analysis, timing alignment, and adaptive 
predistortion coefficient updates. It is significant to utilize such a feedback scheme 
for evaluating what happens on the RF signal path. For example, the time-varying 
linearity and for power changes can be observed and estimated in real time. How-
ever, great care must be taken to design the circuitry on the feedback path with 
high-linearity requirements. It should not introduce extra distortion/interference 
and behave as a totally transparent observer in the measurement system. Variable 
attenuators should be added between the attenuated PA output and signal analyzer 
input port to guarantee proper input power level for the optimum performance 
for both the spectrum analyzer and VSA because the excessive attenuation would 
lead to a rise of noise floor, reducing the signal-to-noise ratio (SNR) in the analyzer 
measurements. However, insufficient attenuation would overdrive the input ports 
of instruments and introduce distortions causing imprecise measurements as well. 
RF power measurements can be performed by a dual-channel power meter because 
accurate absolute power measurements are an essential part of RF PA power gain 

7.1  Motivation and Introduction 
291
and efficiency measurements. The power sensors enable power modulation mea-
surements with a high-speed interface of the dual-channel power meter and fit the 
needs for the ET PA device characterization.
Finally, a comprehensive measurement combined RF, baseband, and envelope 
analysis is usually desirable to view the whole picture of an ET PA system. VSA 
serves as a good assistant on these kind of measurements. Time-aligned envelope 
and RF modulation measurements provide the deepest understanding of ET system 
operation. A shared external trigger allows measurements from different instru-
ments to be combined. Distortion measurements can be made without regard to a 
specific technology. With the introduction of the VSA to the test bed, it is capable 
to deliver simultaneous envelope and RF analysis. It enables comprehensive charac-
terization and optimization for timing alignment and envelope shaping adjustment 
in a straightforward manner. It allows advanced modulated signal measurement 
features including stimulus and response functions with time, signal statistics, am-
plitude, and phase compensation analysis capability. Furthermore, the VSA can 
realize the ET PA measurements with AM-AM and AM-PM distortions, gain com-
pression, CCDF, EVM, and ACPR, which helps to obtain deeper insights into the 
overall performance of ET PAs. 
Synchronous baseband and envelope measurements can be performed by VSA 
via spectrum analyzer or oscilloscope used as measurement hardware. However, the 
measurement hardware selection depends on the requirements for dynamic range 
or bandwidth. A spectrum analyzer is suitable for a wide dynamic range measure-
ment, but with limited bandwidth performance and an oscilloscope is good at cap-
turing broadband signals but with limited dynamic range performance. Typically, 
oscilloscopes provide the measurement with high speed, ease of use, and envelope 
voltage and current measurements. GPIB or LAN cables can provide a high-speed 
data transfer path for postprocessing on the PC host. Combined with VSA soft-
ware, the high-speed digital oscilloscopes can serve as a powerful and integrated 
RF and baseband analysis tool. The same synchronization requirement should be 
put on the VSA measurement process as well. For instance, a 10-MHz reference 
clock signal is normally utilized to frequency lock multiple pieces of the instru-
ment in the test bed, forcing all to agree on a common definition of time, which is 
critical that the instrument generating and capturing a signal share this definition. 
Otherwise, the generator may stretch a 10-ms signal over 10.01 ms although the 
VSA captures for only 10.00 ms, missing a portion of the signal. The master clock 
instrument must have the ability to supply a 10-MHz reference or lock to an ex-
ternal reference. The 10-MHz reference is distributed to generators, upconverter, 
signal analyzers, oscilloscope, and VSA hardware while either the oscilloscope or 
spectrum analyzer is used to capture waveforms. 
ACPR and wideband spurious or emission signal measurements can be per-
formed by spectrum analyzer. ACPR is one of the most sensitive measurements 
for testing timing and offset misalignment during ET operations. An imbalance 
between the ACPR side band components of the main channel signal is evidence of 
a timing misalignment error. The EVM also needs to be measured before and after 
the ET PA via VSA. The spectrum analyzer rather than a digitized oscilloscope is 
preferred for these measurements with the best dynamic range performance. Fre-
quency sweeping analysis is needed to measure the impact on receiver band noise 
from the ET PA system.

292 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Because orthogonality must be maintained during the baseband processing for 
transmitting or receiving the I-Q signal, the amplitude response of the instruments 
must match exactly. Similarly, samples must be made at precisely the same time for 
both I and Q signals. Any variation in the instrumentation amplitude and phase 
would impact the ET PA response. Hence, it is important to consider characterizing 
the instrument test bed system thoroughly before beginning measurement work in 
the complex domain.
7.2  Envelope Measurement
The ET system is required to track the varying-envelope signal rather precisely. 
However, it is typically observed losing accuracy near the fast variation regions, 
which corresponds to the highest frequency components of the envelope signal. 
Hence, too much loss of high-frequency components due to the bandwidth limita-
tion of the envelope generator and supply modulator would directly cause degra-
dation in overall ET system efficiency and linearity. Therefore, it is significant to 
explore the methodology for envelope signal measurement before an ET system 
evaluation.
As shown in Figure 7.4, directly using a random envelope signal for mea-
surement purposes is not explicit for designers, especially mapping to traditional 
performance metrics built under single-tone and multitone scenarios as shown in 
Figure 7.5. Therefore, before starting an envelope measurement, sinusoidal, two-
tone envelope and pseudo-envelope can be built for measurements. An amplitude 
Figure 7.4  Envelope signal decomposition to illustrate the complexity and difficulty for direct mea-
surement and evaluation. (From: [2].) © 2003 Artech House. Reprinted with permission.)

7.2  Envelope Measurement 
293
modulation (AM) envelope is made up by two tones with one operating at the RF 
band and the other at the envelope band. The pseudo-envelope can be fabricated 
with more complex multitone signals. The pseudo-envelope can be extracted and 
injected into the envelope path when the several envelope band tones are upcon-
verted by one RF carrier tone and sending out in the RF path.
7.2.1  Sinusoidal Signal Measurement
Although a sinusoidal signal is the simplest form of signal available for supply 
modulator evaluation, it still needs to take care to choose proper resistive load value 
to avoid burning the modulator out. While the Fourier transform of a sinusoid is a 
single tone in the frequency domain, the measurements of basic metrics such as out-
put power level, power gain, spectrum, and harmonic distortions can be observed 
directly from the spectrum analyzer with this kind of stimulus.
With a sinusoidal signal, the harmonic distortion is no longer difficult and can 
be specified at a given output power level of the supply modulator. For instance, 
when the supply modulator operates at low-power levels, all of the desired power 
coming from a supply modulator should be enclosed in a single tone at the funda-
mental frequency. Furthermore, when the input power level is increased until dis-
tortions come into play, the output power would be observed at the second, third, 
and so forth harmonics, subtracted from the anticipated power at the fundamental 
frequency. It requires considerations to use a sine-wave pulse when the load resistor 
value is too low to avoid burning out. For example, an RF PA equivalent drain/col-
lector resistance is typically ranged from 4 to 100W. Then a measure of harmonic 
distortion can be presented with total harmonic distortion (THD) as discussed in 
Chapter 2.
Furthermore, frequency and power-sweeping measurements with a sinusoidal 
signal can be performed to obtain a comprehensive picture of frequency and power 
responses as shown Figure 7.4. Frequency sweeping can provide frequency response 
of the supply modulator. Although these kind of sweeping measurements look like 
the same function of a vector network analyzer (VNA), it is especially convenient 
Figure 7.5  Category of envelope measurement stimulus. (From: [16]. © 2006 Artech House. Re-
printed with permission.)

294 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
for large signal scenarios, which VNA is difficult to handle with calibrations and 
avoiding potential VNA damage. Likewise, power sweeping at a specific frequency 
point can provide insights to compression character of DUTs, which is significant 
for power devices such as a supply modulator. 
It may be doubtable that the sinusoidal signal is too simple to perform complex 
measurements in a digital modulation system evaluation by many people. How-
ever, it is not true for all scenarios. For example, the feedback path in the ET system 
for adaptive observation is a typical digital receiver. In measuring feedback path 
performance for I-Q signals, it becomes especially important to understand the 
phase and amplitude match of the observation path. How closely I and Q paths 
in a zero-intermediate-frequency (zero-IF) receiver reproduce the same signal is 
rather imperative for overall feedback path performance. Hence, one method to 
measure such a receiver would be to put a sinusoidal signal at RF frequency with 
offset to the local oscillator (LO) frequency to the input of feedback path. It will be 
converted to baseband as a single tone at both I and Q paths. These two tones can 
be sampled and compared for amplitude and phase. In I-Q digital receivers, they 
should have the same amplitude, but have a 90° phase shift between them. There-
fore, they can be depicted as a perfect circular shape in the idea case. The imbalance 
of I-Q can be observed as any distortion of the circular shape.
7.2.2  Multitone Signal Measurement
Although the sinusoidal signal measurement of the previous section pertains to 
the topic of harmonic distortion, it can only reveal part of the ET system picture. 
However, a true envelope signal can be equivalent to multiple tones with various 
frequencies and amplitudes squeezing as much information as possible into the 
channel bandwidth. Because it can be rather difficult to study a complex multitone 
signal directly, a two-tone AM signal can provide the simplest envelope signal used 
to measure the linearity of the ET PA. Practically, the output voltage would be dis-
torted near the zero crossing due to the infinite bandwidth of the two-tone signal.
As discussed in Chapter 3, the third order of the two terms of products (2ω1 – 
ω2) and (2ω2 – ω1) are very close to ω1 and ω2. These two terms cannot be filtered 
out and are commonly referred to as the intermodulation products (IMD). There is 
a common way to present IMD by an output power versus frequency plot as shown 
in Figure 7.6. The measurement requires an increase of the input power until the 
IMD3 powers are well above the noise floor at a specific output power level. Then 
decrease the measurement span and resolution bandwidth (RBW) of the spectrum 
analyzer being used to measure the IMD3 power, which has the effect of reducing 
the noise floor. Finally, the IP3 point can be given by
	
3
3
(
2)
fund
rd
IP
P
P
=
+
	
(7.1)
where Pfund and P3rd are the powers of the fundamental tones and IMD3 tones, 
respectively. Theoretically, the two fundamental input powers will always equal 
one another, and the two IMD3 will also always equal one another. However, if un-
even powers were observed, the possible root causes would be either an instrument 
calibration problem or supply modulator uneven frequency response and memory 
effect. For the former, an input power correction applied to one of the input tones 

7.2  Envelope Measurement 
295
will achieve equal power input tones. For the latter cause, it is a simple matter to 
measure both of the IMD3 tone output powers and both of the fundamental powers 
and utilize the worst-case power value. 
7.2.3  True Envelope Measurement
At the beginning of a true envelope test, a clear understanding of its characteristics 
such as power spectral density (PSD) and PAPR is essential to estimate ET PA per-
formance. For example, as illustrated in Figure 7.7, the envelope signal power dis-
tribution of the OFDM signal such as a 20-MHz LTE downlink takes major share 
of power within its RF signal bandwidth as 96%. This can be measured by a digitiz-
ing oscilloscope with the sampling rate fs set as 1.25 Gsps and measurement dura-
tion Td as 2 µs. Hence, the captured data size for PSD calculation can be deduced as 
	
1
s
T
f
∆
=
	
(7.2)
	
(
)
1
1
p
d
s
d
N
T
T
f
T
=
∆
+
=
⋅
+
	
(7.3)
where ∆T is the time step size for capturing and Np is the number of data points 
stored in memory. Then, with a fast Fourier transformation, the PSD plot of enve-
lope can be measured as Figure 7.7.
Therefore, the split-band type hybrid modulator for such an envelope can be 
employed with the SMPS part to provide high efficiency for low-frequency but 
Figure 7.6  Spectrum illustrations for the third-order intermodulation measurement; both funda-
mental power tones and both third-order power products are shown; additionally, the noise floor 
is indicated. The noise floor defines the absolute minimum power level that can be accurately mea-
sured. (From: [3]. © 2004 Artech House. Reprinted with permission.)

296 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
major share of envelope components, minimizing switching loss. Accordingly, the 
linear part needs to boost the bandwidth for high-frequency components but with 
lower efficiency and minor share. 
However, the PAPR of the envelope is typically much higher than the PAPR 
value of the RF signal, although the CFR is utilized to cut to some extent as shown 
in Figure 7.8. It indicates the challenge of supply modulator to maintain high ef-
ficiency for 40-MHz bandwidth and beyond with advanced modulation schemes.
Figure 7.7  Illustration of power spectral density of an exemplary 20-MHz LTE DL signal. It indicates 
that the in-band 20-MHz bandwidth takes up 96% power of the envelope signal.
Figure 7.8  Illustration of envelope PAPR, which is much larger than the main signal PAPR even after 
a CFR cutting the main signal PAPR from 11.6 to 6.9 dB for an exemplary 2 × 20 MHz dual-carrier 
LTE 64QAM signal.

7.3  Supply Modulator Measurements 
297
Finally, because the true envelope measurement can reveal the true behaviors 
of the ET PA, most designs of the ET PA are no longer based on continuous wave 
(CW) characterization only. The enormous spectrum broadening substantially in-
creases the demand for dynamic modulations measurements and analysis of ET 
PAs. However, an RF PA optimized in term of linearity and efficiency owing to a 
dynamic bias voltage technique applied to the supply bias port raise the challenge 
of measurement with complex signals. In terms of instrumentation, VSA has come 
to be a major tool for RF characterizations of PAs to extract system level criteria 
for efficiency and linearity. For example, RF time-domain envelopes at the input 
and output of ET PA can be measured through a calibrated VSA-based setup. Both 
in-band and out-of-band measurements for linearity can be implemented. First, 
an EVM measurement is related to the in-band linearity criterion for an ET PA. It 
does not require the acquisition of the complete spectrum. Second, it concerns the 
validation of ET PA system with timing alignment, distortion characterization, and 
so forth. More details will be further discussed in Section 7.5.
7.3  Supply Modulator Measurements
The supply modulator is mostly responsible for efficiently amplifying an envelope 
voltage waveform, but more specific requirements can be understood before mea-
surements start. First, a supply modulator should operate with a certain minimum 
and maximum output voltage level with considerations of factors such as the knee 
voltage of the RF PA and envelope shaping function. Second, with modern broad-
band modulated signals, the frequency response of a supply modulator should be-
have at a constant and flat gain and insertion phase over a specified bandwidth. 
Third, from a circuitry perspective, a supply modulator should give maximum 
short-term and long-term slew rates to guarantee the output supply fast and sharp 
enough to maintain the original shape of the envelope as much as possible. Fourth, 
the overall ET PA system is dynamically and dramatically changing with time, 
which requires a supply modulator to be capable to drive a time-varying load over 
the modulation bandwidth and keep up the performance requirements above.
7.3.1  Measurement Setup
Because the RF PA designs with ET operation require a nonstandard drain/collec-
tor bias network, a bank of large shunt capacitors on the supply bias side must 
be removed. However, it still requires the resonant capacitor for RF fundamental 
frequency, which is cooperating with the quarter-wave line at the supply bias side. 
Therefore, during the supply modulator measurement process, the resonant capaci-
tor should be considered as a load named as Cres in Figure 7.9.
To measure the frequency response and observe the time-domain waveform of 
the modulator output, direct connection to the final load tap should be prevented 
from damaging the instruments connected due to its high DC power. Hence, a 
broadband resistive coupler can be introduced to reduce the inputs for instruments 
into safe power levels. As shown in Figure 7.9, a typical and exemplary 40-dB 
coupling factor of the resistive coupler is inserted between Cres and a dummy load 
emulating the PA drain. This coupler forces the input impedance to be 50Ω, so 

298 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Figure 7.9  Illustration of ET supply modulator measurement setup with resistive and capacitive load to emulate drain/collector port characteristics.

7.3  Supply Modulator Measurements 
299
there is almost no reflection at this port. However, the resistive coupler does have 
some issues with losses and isolation due to the resistive nature. Because the isola-
tion is equal to the coupling, the directivity, which is equal to the isolation minus 
the coupling, is therefore 0 dB. However, the addition of other resistors allows the 
coupler network to be matched with 50Ω at all three ports. 
The resistor and capacitor (RC) in parallel are used as a dummy load to emu-
late the drain/collector equivalents of the RF PA during ET operation. The values 
of RC totally depend on the RF power transistor semiconductor technologies and 
output power levels by various application scenarios. Hence, an equivalent resistor 
typically ranges from around 1Ω to 100Ω and the equivalent values of capacitor 
range from 100 pF to 800 pF, including parasitic on PCB implementation. Typi-
cally, the supply modulator load is realized by such a dummy load rather than di-
rectly connecting to an RF PA drain with regards to reliability and easy-to-measure 
consideration.
The dummy load at modulator output can start from a design using an elec-
tronic load system to simulate loading on an RF PA drain. It is used as substitute 
for a conventional resistive load. The benefit of electronic load is that the current 
and load power could be read from the instrument directly, which is easy and 
straightforward to use at the beginning phase. As a counterpart to a current source, 
the electronic load is a current sink. When loading a current source with a specific 
resistor, one can set one determined load current by the connected load resistor. 
The characteristic of the electronic load is that the load current can be set and var-
ied in a defined range. The load current is regulated electronically. The electronic 
load consumes electric energy and in most cases transforms it into heat. Fans and 
heat sink elements are employed as coolers. Therefore, this kind of dummy load is 
suitable for a full power test for efficiency and output power capability.
For later optimization, especially large signal frequency response performance 
evaluation, another kind of dummy load is a bank of high-performance RF power 
resistors in parallel working as the dummy load for the supply modulator as shown 
in Figure 7.10. Decent broadband performance, less parasitic impact, and easy as-
sembly on PCB can be obtained by this kind of dummy load for supply modulator 
measurement. Theoretically, the total value can be defined as
	
total
R
R N
=
	
(7.4)
The main drawback of this kind of dummy load is not being suitable for a full 
power test, because it swallows all power from the supply modulator converting 
Figure 7.10  Supply modulator dummy loads with RF power resistors arranged in parallel for broad-
band performance and minimum parasitic effects. 

300 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
them all into heat. Theoretically, nothing is transformed into RF power at all. It 
creates a huge thermal burden on PCB and ambient circuitry, especially with other 
function blocks integrated on board. Therefore, this kind of dummy load is suitable 
for low and medium power supply modulator measurement for broadband and 
frequency response related performance.
7.3.2  Error Measurements
With the measurement setup as shown in Figure 7.9, the supply modulator can be 
tested using a modulated signal with a resistive load for accuracy and efficiency 
verification.
For the accuracy verification, the output envelope waveform is time-aligned 
and compared with the input to generate the error signal. Figure 7.11 displays an 
exemplary measured normalized power spectrum of input and output envelope 
and associated error signal. Besides the straightforward manner in Figure 7.11, the 
comparison results can be quantified with a well-known root mean square error 
(RMSE). It is defined as a frequently used measure of the difference between the 
input values and the actually observed output values. These individual differences 
can also be called residuals, and the RMSE serves to aggregate them into a single 
measure of predictive power.
Therefore, RMSE with respect to the estimated input variable Xin is defined as 
the square root of the mean squared error as
	
2
1(
( )
( ))
n
out
in
i
X
i
X
i
RMSE
n
=
−
= ∑
	
(7.5)
Figure 7.11  Illustration of spectrum analysis for accuracy. Envelope supply modulator output versus 
input signal spectrum and error signal are put together to indicate the error occurrence frequencies.

7.3  Supply Modulator Measurements 
301
where Xout is the observed values at output and Xin is the input values at index i. 
The calculated RMSE values are typically converted into units with decibels and 
can be used to distinguish the supply modulator accuracy performance in a module 
test phase for design validation as well as compare the individual modulator perfor-
mance to that of the benchmark designs.
Actually, nondimensional forms of the RMSE are meaningful because it usually 
intends to compare RMSE with different units. Therefore, normalized root mean 
square error (NRMSE) is introduced for this purpose. There are two approaches 
for NRMSE calculation by normalizing the RMSE either to the range of the ob-
served output data or to the mean of the output data, as shown here:
	
_ max
_ min
out
out
RMSE
NRMSE
X
X
=
−
	
(7.6)
	
out
RMSE
NRMSE
X
=
	
(7.7)
Hence, for a supply modulator measurement, the typical NRMSE is less than 
2%. Also, the RMS value of the envelope voltage can be calculated with the out-
put data as well, which is about (but not fixed to) half the value of the supply rail 
voltage.
Another significant test challenge of ET is the high bandwidth required for 
the power supply waveform. The bandwidth requirement for the envelope wave-
form is typically far greater than that of the RF signal waveform. To analyze this 
phenomenon, considering the ET drain supply voltage versus input power wave-
form is shown in Figure 7.12 with an exemplary 5-MHz LTE uplink signal. Figure 
7.12 shows the PAE optimized drain/collector supply waveform and the associated 
Figure 7.12  Illustration of ET drain supply voltage versus input power waveform.

302 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
power versus time line plot for the corresponding LTE signal. Furthermore, a spec-
tral analysis can indicate that the bandwidth of the supply voltage waveform is at 
least three times more than that of the RF signal waveform. The high bandwidth 
requirement stems from two main reasons. First, the ET drain/collector supply 
voltage is a function of RF signal magnitude. Therefore, from the PSD analysis, 
more than 90% of the spectral power of those envelope signals is concentrated 
within their RF signal bandwidth, and the higher-frequency portion of the enve-
lope signal has significant content beyond the in-phase or quadrature component 
bandwidth. Second, modulation bandwidth may be changed by the clipping effect 
resulting from the lower bounds imposed by the envelope shaping function. The 
envelope shaping function applies a nonlinear transformation to the original enve-
lope waveform, changing its time-domain characteristics and further complicating 
the issue. The waveform bandwidth may be either expanded or condensed depend-
ing upon the type of the envelope shaping function. Therefore, the required supply 
modulator bandwidth and dynamic performance is not straightforward to predict, 
as the input signal depends on both the system configuration and modulated signal 
characteristics.
7.3.3  Design Considerations for Measurement
First, a supply modulator faces a problem from which high-power devices for enve-
lope amplification suffer: limited dynamic range voltage. For example, many com-
ponents offer to 36-V maximum supply rails and require several volts of headroom 
to maintain linearity, incurring a 30-V output dynamic range voltage. A proper DC 
offset can be applied to the output voltage range to allow higher peak voltages at 
the expense of higher minimum voltage. The maximum and minimum drain/collec-
tor voltages available to the RF PA impact its efficiency.
Second, bandwidth and frequency response are small-signal measurements. 
They are only valid for linear and weak nonlinear operations. For example, inad-
equate bandwidth can be observed by increasing the frequency of a very low-am-
plitude input sine wave and monitoring the output waveform decrease in amplitude 
as gain rolls off at the coupled output terminal with the test bed setup as shown in 
Figure 7.9. However, the slew rate is a measurement of large-signal phenomena. 
Inadequate slew rate capability may result in distortions on output signal. A wide 
variety of complex component and circuit problems can be responsible for this type 
of behavior. Therefore, the speed of the supply modulator is often limited by slew 
rate as large-signal effects. Because slew rate can be described as the maximum 
speed at which a supply modulator can charge and discharge its load, to measure 
slew rate, the test bed can be configured similar to Figure 7.9 but make the stimulus 
replaced by square wave with a given initial frequency, with output amplitude into 
a range approaching to rail-to-rail to guarantee output serving as qualified large 
signal. It is meaningful to check whether there is a significant slewing on the output 
square waveform rail-to-rail transitions. Assume that the slope of transition less 
than infinity is difficult to observe, increase the square waveform frequency until 
the slope slewing region is clearly observed, but remember to maintain the output 
waveform rail-to-rail levels clear in each cycle or the square wave would be too 
fast to observe the slewing effect. Finally, select two points on the rising or falling 
slope and from these calculate the positive or negative slew rate. Typically, the slew 

7.4  RF PA Measurements 
303
rate of a supply modulator for the BTS purpose should be greater than 2,000 V/µs. 
However, it depends on the output voltage levels and applications scenarios. There-
fore, a lower-power application requires a relatively relaxed slew rate performance.
Third, typically 3 to 10 times of the complex modulation bandwidth for supply 
modulator bandwidth design is not always true for all type of modulated signals. 
Bandwidth and dynamic performance requirements for a supply modulator can-
not be estimated based on the bandwidth of the complex modulation. It should 
depend upon the structure of the modulation. For example, the rule is true for 
the complex modulation such as 3G and 4G signals with “through-zero” char-
acters. However, this rule of thumb is untrue for 2G GMSK modulation, which 
has constant amplitude, resulting in a 0-Hz modulation bandwidth. Hence, using 
the RF signal bandwidth to calculate supply modulator bandwidth requirement is 
empirical. Complex modulation signals with amplitude passing through zero will 
have sharp amplitude nulls in the time domain; amplitude quickly descends to zero 
before instantly changing direction and increasing toward a peak. Therefore, it is 
significant to clarify here that more than three times of the RF signal bandwidth 
requirement is suitable for “through-zero” modulation types. Fortunately, 3G and 
4G signals are typically this kind of modulations. 
Fourth, the dummy load RPA driven by the supply modulator at the RF PA 
drain supply terminal is referred to as the drain resistance. Carefully note that it is 
not correlated to the PA load line or any RF impedance and is constant over the RF 
cycle by virtue of the RF choke. RPA varies with PA output power and efficiency as 
follows:
	
2
(
)
PA
sm
sm
sm
out
R
V
I
V
P
η
=
=
⋅
	
(7.8)
Finally, high gain peaking at a specific frequency region is used to extend the 
useful bandwidth but needs trade-off with gain flatness requirements of a supply 
modulator. Many linear modulators in a hybrid supply modulator design inten-
tionally make use of gain peaking to extend bandwidth. However, a voltage gain 
is desired to maintain its flatness over the modulation bandwidth. Hence, proper 
feedback network tuning can attenuate the frequency response to flatten the gain 
peaking effect but has limited capability for expanding the bandwidth as the same 
time. A supply modulator can utilize the moderate feedback network tuning for 
bandwidth, trading the extended bandwidth associated with gain peaking off for 
gain flatness as shown in Figure 7.13.
All in all, the supply modulator bandwidth, slew rate, and output impedance 
required to reproduce the dynamic supply signal accurately enough to achieve sys-
tem linearity is a function of the input signal, RF PA behavior, and envelope shap-
ing function. Reduced supply modulator dynamic requirements lead to improved 
modulator efficiency, but also force an envelope shaping function, resulting in low-
er RF PA efficiency. 
7.4  RF PA Measurements
In an ET PA, the RF PA plays a role of a nonlinear combiner of RF input and supply 
modulator output. Therefore, the ET PA output signal is a strong function of both 

304 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
inputs. The gain, insertion phase, and drain current of the RF PA must be character-
ized over both dynamic supply voltages and RF input power sweeps.
Typically, the supply modulator design can be standalone from RF PA with 
equivalent resistive load to characterize and evaluate. However, for the RF PA de-
sign for ET requires multiple instruments support because RF PA is subjected from 
all ET-related factors, which cannot be characterized or designed independently for 
ET purpose. Furthermore, the purpose of RF PA measurement is to characterizing 
its basic performance and design for ET, including checking for memory effects and 
bandwidth, obtaining trajectory data for constant-gain or constant-gain-compres-
sion shaping functions [4, 5].
Practical RF PA design heavily counts on measurements to understand the ac-
tual operating conditions and behaviors. For instance, measurements to identify 
and verify the optimum impedance for certain load power and efficiency trade-off, 
swept power measurements at various drain/collector voltages would enable infer-
ence of the optimum efficiency trajectory for ET. Measurements associate con-
figuration types with maximum power and lower efficiency with optimum power 
loading, and maximum efficiency and lower power gain and output levels with 
optimum efficiency loading. It is meaningful to infer the actual operating condi-
tions boundaries between scenarios. These boundaries can be utilized to establish 
compromise conditions to enable optimum ET system performance. 
Therefore, load-pull measurement and analysis are powerful tools to provide 
intuitive graphical and methodical frequency-domain exploration of source and 
load impedance space, and understanding how those data concurrently act togeth-
er with each other over frequency, impedance, bias condition, and power levels. It 
can embody an infinite spanning space of voltage and current representing any RF 
PA operating conditions because the ratio of voltage to current is not unique for 
given impedance value. This spanning space is conveniently visualized as paramet-
ric contours demonstrating constant performance versus impedance. Superposition 
of selected parametric contours over impedance can exclusively identify specific 
impedance. Moreover, at intersection of contours, it delivers target performance 
where all anticipated target requirements can be met at the same time.
Figure 7.13  Measured small-signal frequency response for a supply modulator under varying DC 
loads. Excitation signal is a frequency sweeping signal. Flattening effect in small-signal frequency 
response can be observed for before and after feedback network tuning.

7.4  RF PA Measurements 
305
7.4.1  Nonlinear Vector Network Analysis
Conventionally, a vector network analyzer (VNA) exploits the properties of a lin-
ear or weakly nonlinear arbitrary N-port network utilizing scattering parameters 
(S-parameter) theory. It typically operates from 10 MHz to over 100 GHz. Hence, 
S-parameters are merely defined for small-signal linear systems. Before an S-param-
eter measurement, through the process of error correction or calibration, system-
atic error terms can be identified, being eliminated from the measurement data to 
return intrinsic S-parameter data of DUT de-embedded to an arbitrarily specified 
reference plane. However, an RF PA is a large-signal active device exhibiting severe 
nonlinear behavior. Hence, it indicates that there may not be a one-to-one relation-
ship between the input and output frequencies. Unfortunately, S-parameters would 
turn out to be invalid and cannot be employed to truly depict the PA behavior under 
such a scenario. Moreover, it imposes extensive and costly empirical-based iteration 
of design and measurements, adding considerable time and expense to investment. 
For that reason, traditional VNAs are incapable of accurately measuring large sig-
nal characteristics. Thanks to the emergence of a large-signal nonlinear vector net-
work analyzer (NVNA), it can make these RF PA measurements with a high level 
of accuracy [7–11]. The NVNA makes use of techniques based on multitones and 
modulated signal that are applied to an RF PA driven into its nonlinear region with 
large signals. The NVNA can measure the entire resulting multitone and IMDs at 
the fundamental and harmonics. Hence, NVNA technique is very different from the 
traditional PA characterization techniques developed.
Like VNA, the first step of NVNA measurement is calibration. It is a crucial 
factor in ensuring the accuracy and repeatability of any measurement. For NVNA 
calibration, besides the similar standard used for VNA vector calibration, there are 
still other two extra calibrations required as power calibration with a power meter 
and phase calibration with a comb generator as a harmonic phase reference. There 
are a number of complications of calibrating an RF PA design to be taken care of. 
For example, instrumental preamplifiers set to the test bed may compress or dam-
age the calibration standards, while attenuators used to improve power handling 
capability may result in a noisy calibration.
NVNA is powerful for RF PA measurement not only providing basic DC I-V 
curves and load lines to set the PA operating point, but also providing the behavior 
under various DC bias and RF conditions. For instance, it can measure the time 
varying drain voltage in conjunction with the time varying drain current. At each 
instance in time, the drain voltage and current can be compared to obtain their 
overlapping relationship. This feature gives tremendous help on designing wave-
form-engineered SMPA for high-efficiency applications.
Another highlight of NVNA is that the measured parameters of the PA can be 
imported into EDA software as a fully operational linear and nonlinear model for 
optimization, simulation, and design purposes. An example would be X-parame-
ters, a superset of S-parameters, which have been emerging and measured using 
Agilent’s NVNA. Therefore, they are the logical, mathematically correct extension 
of S-parameters into a nonlinear large-signal operating environment. The X-pa-
rameters fully describe the input and output frequency mapping of the RF PA thus 
completely describing the linear and nonlinear behavior. The resulting X-parameter 
models can be imported into the EDA simulator where it can be used to simulate 

306 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
actual linear and nonlinear behaviors. X-parameters are a measurement of a device 
under actual operating conditions that include large-signal operation [6, 7]. Fur-
thermore, X-parameters are able to capture some memory effects, in particular, the 
quasi-static memory effects caused by such things as bias and temperature modu-
lation at low frequencies. Here generated or measured X-parameters are charac-
terized over a range of static independent variable values, but used for design in 
circumstances where these values are allowed to vary slowly. This is accomplished 
by embedding the model port corresponding to the static parameter, such as bias, 
into a network that passes signals at a low frequency that will be generated by 
the component model in response to modulated input signals at the RF ports. As 
a result, memory effects are induced with respect to the RF ports. The model that 
describes this behavior is accurate, provided that the time variation of the voltage is 
sufficiently slow [14, 15]. X-parameters can build a foundation to work out models 
to predistort and mitigate memory effects accordingly.
7.4.2  Swept Load-Pull 
Load-pull measurements provide output power or power-added efficiency versus 
the load or source impedance. The data can be collected and combined into con-
stant performance contours on a Smith chart, indicating the impedance target for 
a matching structure. Likewise, load-pull plays a vital role in the efforts to develop 
the measurement-based black-box models. Identification of the optimum transistor 
technology is an important element of the RF PA design process for ET.
Load-pull method substantially reduces the sources of uncertainty and am-
biguity in achieving the first-pass design through rigid adherence to a systematic 
design method by straightforward treating of transistor nonlinearity and distrib-
uted network effects. Impedance termination replication yields a virtually identical 
representation of observed performance under load-pull with that observed in the 
physical implementation. Distributed effects are integrated by replication of the 
load-pull physical and electrical situation with that of the final physical implemen-
tation. Because load-pull directly treats nonlinear effects so that the observed target 
performance is precisely replicated in the physical implementation without a rigor-
ous understanding of transistor physics, a key benefit of the load-pull method is its 
exclusive focus on management of effects of nonlinearity versus analysis of nonlin-
earity. This distinction transforms what is essentially an intractable mathematical 
problem into a sequence of load-pull measurements, under a realistic stimulus, 
followed by linear matching network synthesis and design.
As shown in Figure 7.14, it depicts a schematic overview of the laboratory 
equipment setup that can be utilized in the RF PA characterization measurements 
with load-pull and source-pull. The attenuator is used to operate the rest of the in-
struments at the proper power levels. The isolator can be used to prevent reﬂections 
from propagating back to the driver PA and the signal generator. The overall load-
pull method of RF PA design consists of the canonical steps as shown in Figure 
7.15, wherein the  transistor-level design process begins with the fifth step of the 
procedure.
The swept load-pull notion represents the most common class of load-pull data 
acquisition, capable of identifying any concurrent combination of optima with full 
decoupling among available factors such as source power, load power, bias, and 

7.4  RF PA Measurements 
307
Figure 7.14  Illustration of a typical RF PA measurement with source-pull and load-pull setup.

308 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
frequency. It is the groundwork of advanced optimization methods. Various classes 
of load-pull can be nested, for example, swept power and swept drain/collector 
bias, to identify optimum linearity and efficiency trade-off conditions. Swept load-
pull is typically automated to enable unattended data collection that might other-
wise involve many hours of acquisition and processing.
Swept source power load-pull provides deep insight into RF PA behavior, the 
weakly nonlinear region to deep compression, at various terminating impedance 
states and bias conditions. When coupled with swept frequency and harmonic 
load-pull, it provides the most general picture of PA performance and the terminat-
ing impedances bestowing that performance. In addition to providing a multitude 
of data, including constant compression, constant gain, and constant signal quality, 
swept power load-pull is useful in analyzing advanced architectures, such as the ET 
PA, where swept power and efficiency are provided versus load impedance to assist 
in optimum envelope shaping function synthesis. An immediate benefit of swept 
power load-pull is the additional insight provided by decoupling available source 
power and load power from being held constant, revealing characteristics of each 
Figure 7.15  Illustrations of load-pull design and measurement method for RF PA.

7.4  RF PA Measurements 
309
parameter versus power. It enables rapid identification of maximum efficiency for 
fixed signal quality.
Swept bias can vary both voltage and current, though drain/collector current is 
the most common due to its direct effect on gain and signal quality [19, 20]. Cur-
rent is swept indirectly by varying the gate bias or base current, depending on the 
transistor technology. Swept drain/collector voltage is often used for ET trajectory 
analysis to evaluate RF PA performance versus voltage, particularly gain, power, 
and linearity. Load-pull with swept bias is typically preceded by fixed power load-
pull to identify a region where a preliminary target load-power and efficiency sta-
tionary point is been first located. With this target region, bias current is swept at 
each source and load impedance state for fixed load power to identify an optimum 
ACPR bias current. 
Identification of the source and load terminating impedances over frequency is 
the ultimate goal of load-pull. Following identification of the optimum bias condi-
tion and optimum source and load impedances, at a nominal frequency, the swept 
frequency load-pull enables unique resolution of the source and load impedance 
trajectories bestowing target performance. These trajectories are replicated by the 
matching network that ultimately replicates target performance. Swept frequency 
measurements are needed to evaluate interstage impedance matching at different 
operating points, while pulsed power measurements avoid thermal effects affecting 
device operation. Nonlinear analysis is needed to model the RF PA as a function of 
supply and bias voltages.
7.4.3  Measurement for Memory Effects
Before applying ET, it is useful to measure RF PA for memory effects. If an RF 
PA had memory effects, its output would not be just a function of its input at the 
current instant in time. It would also depend on what the input was previously. It 
can be seen as a kind of nonlinear frequency dependence. The origins of memory 
phenomena in the RF PAs are explained in the literature [6]. These memory effects 
may be caused by the behavior of the active devices, the bias network, dynamic self-
heating, and bias-line modulation with time-varying operating conditions. With 
the introduction of digitally modulated signals with wideband and a fast-changing 
envelope, the memory effects on the RF PA have to be considered. Specifically, the 
memory effects become important and critical for ET. Memory effects have become 
the main cause of difficulties in characterizing and linearizing the nonlinear behav-
ior of a high-PAPR signal excited PA over the full operating range of instantaneous 
power. It leads to the development of the DPD that incorporates compensation for 
the memory effects. 
Early measurement for memory effects is to perform a two-tone test in which 
the frequency spacing is swept between the input tones. Symptoms indicating an RF 
PA exhibiting memory are when the measured intermodulation distortion changes 
as a function of the frequency spacing between the two stimulus tones and its 
IMD3 upper and lower sidebands exhibit asymmetry. 
In Figure 7.16, the amplitudes of the lower and upper third-order intermodula-
tion distortion sidebands are not equal. Then the PA exhibits memory effects that 
appear when the frequency spacing between the two input signals is at 200 kHz. 
The RF PA should behave fairly well as long as the modulation bandwidth of the 

310 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
input signal is less than about 200 kHz. Memory effects are becoming significant 
for tone spacing greater than 200 kHz.
An alternative way of testing for memory effects is utilizing a complex stimu-
lus measurement via observing AM-AM and AM-PM distortion point scattering 
phenomena. Memory effects produce hysteretic AM-AM and AM-PM responses in 
response to modulated signals. The measurement setup will be introduced in Sec-
tion 7.5.2 and the stimulus can be either modulated signal or multitone signal. To 
simplify the case, two-tone signals can be employed for this measurement as well. 
Figure 7.17 shows a hysteresis in the AM-AM and AM-PM distortion curves with 
the input tone spacing set to 200 kHz and 20 MHz, respectively, which indicates 
that a serious memory effect appears on the latter scenario. 
In recent years, for a nonlinear RF PA operation exhibiting dynamic memory 
effects, a multi-envelope measurement can be performed by NVNA where the PA is 
stimulated with a pulsed signal [29, 30]. Envelope waveforms can be measured at 
the fundamental and harmonics frequencies. If the PA exhibited memory has these 
effects, then the envelopes from the PA output would have time-varying phenom-
ena, which can depict the envelope as flatly distorted. Harmonics are generated by 
the PA due to its intrinsic nonlinearities. Each fundamental and harmonic has a 
distinct envelope profile due to the dynamic memory effects in the PA. Short-term 
memory dynamics seen at the beginning of the pulse may be caused by bias network 
memory and long-term slopes in the envelope may be caused by thermal memory.
7.4.4  Measurements for ET Trajectory
ET trajectory can be developed during the RF PA design phase to evaluate po-
tential ET performance. Capture conditions are carefully designed to mimic the 
true ET operation and provide accurate modeling of linearity and efficiency over a 
wide dynamic range. ET trajectory analysis can accelerate ET PA characterization, 
Figure 7.16  Illustration of two-tone sweep test with asymmetrical intermodulation products, indi-
cating memory effects of RF PA.

7.4  RF PA Measurements 
311
providing deeper insights to compromise the linearity, efficiency, and output power 
benefits under ET mode. ET trajectory provides an explicit design target and knowl-
edge of ET to designers. Crucially, ET trajectory lets designers visualize how PAs 
behave under live ET supply modulation conditions, unlocking the optimum per-
formance and efficiency characteristics of a given RF PA. 
Prior to applying ET to an RF PA, it is significant to know how efficiency var-
ies with output power, with the drain/collector bias voltage swept as a parameter. 
Also, sweeping the supply voltage to know how gain and gain compression vary. 
ET trajectory measurement can be implemented by CW signal sweeping with vari-
ous supply bias and input power levels on the RF PA [31]. The measurement can 
be arranged for envelope shaping function information collection. Measurement 
points can be taken by independently sweeping drain/collector voltage and RF in-
put power Pin from specific operation ranges, respectively. For each combination of 
Figure 7.17  Illustration of the two-tone measurement for memory effects with digital sampling 
system for (a) AM-AM and (b) AM-PM distortions, indicating severe memory effect with 20-MHz 
tone spacing.

312 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
supply voltage, input power, together with Ism, where Ism is a function of both Vsm 
and Pin. The drain/collector impedance Zsupply can be calculated as
	
=
(
,
)
supply
sm
sm
sm
in
Z
V
I
V
P
	
(7.9)
In Figure 7.18, the visible Zsupply ranges from 4Ω to 100Ω. The maximum PAE 
trajectory is added to show the maximum PAE values for each constant output 
power curve. Note that the optimum PAE trajectory to some extent correlates with 
the Zsupply = 9Ω curve, which indicates a maximum efficiency trajectory for enve-
lope shaping function accordingly. As shown in Figure 7.19, in a typical ET sys-
tem, the supply voltage is adjusted dynamically to track the RF envelope at a high 
instantaneous power. Here the RF PA operates with high efficiency in compression 
region and its output characteristics are mostly determined by the instantaneous 
supply voltage. Conversely, when the instantaneous RF power is low, the supply 
voltage is held substantially constant at its lower limit value and the PA output 
characteristics are primarily determined by the instantaneous input power, which 
mainly operates in the linear region. There is a transition region between these 
two extremes in which both supply voltage and input power influence the output 
characteristics.
The envelope shaping function based on measurement can be designed as ei-
ther a maximum efficiency performance or a constant gain for optimum linearity 
performance. The former is typically a controlled gain compression over a trajec-
tory with a specific value (e.g., 3 dB). Then the drain/collector bias versus RF input 
power is to maintain constant compression as the envelope shaping function.
Figure 7.18  Exemplary contours of measured Zsupply, PAE, and output power, together with the 
maximum PAE trajectory. It is visualizing the result of the ET trajectory measurements via contours.

7.4  RF PA Measurements 
313
Data postprocessing can be employed to create trajectories of gain compres-
sion, efficiency, and phase and to allow rapid analysis to forecast the effects of 
different envelope shaping functions. The ET trajectory can be used to generate a 
wide variety of envelope shaping functions, for either optimum linearity or maxi-
mum efficiency. Moreover, it allows taking full advantage of ET PAs whether that is 
enhanced efficiency, increased output power, improved operation into mismatched 
loads, or insensitivity to temperature variations.
To further complicate the measurement process, ET applications generally em-
ploy a digital LUT to map instantaneous signal amplitude to supply voltage as the 
envelope shaping function as discussed in Chapters 2 and 6. The nonlinear envelope 
shaping function is applied to each sample of the signal amplitude before the DAC, 
and is specific to each design of RF PA. In some ET system designs, the stand-alone 
performance of ET PAs cannot be measured unless the envelope shaping function 
is first defined. This requires measurement of the fundamental characteristics of 
RF PA such as output power, efficiency, gain, and phase as trajectory over the full 
range of supply voltage and input power, as shown in Figure 7.20. In principle, this 
characterization can be carried out using a network analyzer together with a vari-
able DC supply. Unfortunately, the results are typically poor as a result of thermal 
effects, ranging errors, and drift in phase measurements. This method is also far 
too slow to allow load-pull techniques to be used. An alternative approach is to 
use a pulse characterization with automatic test platform controlled standard test 
equipment. This avoids the need for a high-bandwidth, low-impedance supply, and 
is sufficiently fast for load-pull to be viable, with the drawback that it is difficult to 
make accurate phase measurements. 
Figure 7.19  Performance metrics for traditional power amplifiers are well established, with ac-
companying test and measurement methodologies. However, introducing envelope tracking to PA 
systems makes characterization a challenge with these two different control inputs being tracked 
and measured.

314 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
For the Figure 7.19 with ET trajectory measurement, an RF pulse amplitude 
sweeping measurement can be performed with an automatic test platform. The 
RF CW pulse amplitude sweep measurement can be employed to obtain the ET 
trajectory and gain compression character of the ET PA, implemented as in Figure 
7.21 with an automatic test platform. This measurement method reflects RF PA 
behavior under pulsed operating conditions faster than the thermal time constant 
of the device. As the pulse becomes longer, heat builds up in the device, raising 
the junction temperature and reducing output power, gain, and efficiency. In this 
Figure 7.20  Supply voltages versus RF input power to maintain constant gain compression to ob-
tain envelope shaping table for different amount of gain compression.
Figure 7.21  RF CW pulse amplitude sweep test setup and principle with various drain/collector supply 
voltages.

7.4  RF PA Measurements 
315
measurement, the pulse can be set to be short enough that no degradation in tran-
sistor performance could be observed over the pulse duration. Therefore, dynam-
ics due to thermal loading, charge storage, and other PA memory effects [6] are 
isolated from static behavior, leading to a memoryless PA model. In this manner, 
ET system dynamics can be analyzed separately from RF PA dynamics. Also, the 
measurement conditions are critical to correctly evaluate the PA performance. The 
thermal conditions for pulsed RF with fixed drain/collector supply operation are 
meant to approximate conditions of ET operation. However, quiescent current is 
continually varying with supply voltage under ET operation, causing a different 
thermal load. Therefore, this characterization data will not predict absolute PA 
performance in ET mode, but will prove a useful tool in determining trends and 
evaluating sensitivity to distortion in the envelope supply and RF signal branches.
This characterization method can be employed to pulse both the RF input 
power and the DC supply voltage. By sweeping supply bias for each gain/efficiency 
trajectory measurement versus input power, this test brings about multiple trajec-
tory plot and estimation, close to a real ET system. This method requires equip-
ment capable of providing large voltage and current pulses. Output impedance of 
the DC power supply must be very low to maintain output voltage in the presence 
of large supply current when the RF pulse begins, which is slightly after the supply 
voltage pulse begins. 
In the exemplary trajectory test bed of Figure 7.21, a highly linear instrumental 
variable preamplifier can be used to provide sufficient power drive into DUT or 
RF PA. The stimulus is a train of RF pulse sweeping with linearly increasing am-
plitudes from −10 to 25 dBm, accompanying sufficient cooling intervals. The dura-
tion of cooling intervals depends on the duration of pulse length, leaving enough 
time margins for RF transistor to be cooled down. The supply voltages of each 
pulse change from 2V to 6.5V with an increment equal to 0.5V. This way, dynamic 
ET operation can be emulated to characterize the transistor and optimize it with 
a systematic perspective. In this measurement, self-heating applies a thermal load 
as though the PA is operating in steady state CW operation. When self-heating is 
turned off during cooling intervals, the PA will operate as though the device is at 
room temperature for next measurement cycle. Pulsed RF operation is close to zero 
self-heating performance, but still incurs the thermal load of quiescent bias current. 
This measurement is even closer to the zero self-heating case, as the quiescent cur-
rent is eliminated between pulses. Pulses close together will still cause a tempera-
ture rise, but not as significant as the pulsed-RF only or CW operation modes. The 
ET mode of operation falls between pulsed RF only and pulsed RF plus pulse DC 
supply operation, as some reduced quiescent current due to reduced supply voltage 
is present even when output power is low.
Note the significant performance change in measurement due to thermal ef-
fects. For example, when self-heating is considered the PA output power is limited 
at 100W, but in the absence of the thermal load, an additional 2~3 dB more output 
power is possible from the same PA design, along with an appreciable increase in 
low-voltage gain and efficiency. Clearly, the mode of operation during measure-
ments such as CW, pulsed, or true ET will have a dramatic impact on the RF PA 
performance. A very different performance should be expected from the same RF 
PA operated under CW and ET configurations.

316 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
7.5  ET PA Measurements
The ET PA measurement features are highly correlated to the modulated signal 
source operations and processing because the complex stimulus-response measure-
ments must compare the input and output, envelope, and RF signals. Likewise, 
other factors such as timing alignment, amplitude and phase compensation, AM-
AM and AM-PM measurements, EVM and DPD linearization schemes also deter-
mine that ET measurements are not RF-standalone. It can be somewhat different 
from the measurement methodology of traditional fixed DC supply PAs.
For the measurement demonstrated in this section, a class-AB GaAs HBT RF 
PA with nominal 5-V operating voltage is used as an example. The PA has the 
capability of handling PAPRs as high as 13 dB, operating at 2.6 GHz with a gain 
variation of 0.3 dB over a 100-MHz bandwidth. A 5-MHz LTE uplink signal is 
used as complex stimulus for illustration.
7.5.1  Test Bed Synchronization
For an RF PA to successfully implement an ET scheme, careful synchronization be-
tween the RF baseband waveform and the supply voltage is required. The RF signal 
generator and AWG must not only be synchronized, but the synchronization should 
also be repeatable, as shown in Figure 7.3. A typical ET test bed uses an RF signal 
generator and analyzer, a high-speed digital waveform generator for controlling 
the PA, and a supply modulator to power the RF PA. The major challenge from a 
measurement and characterization perspective is synchronizing the different instru-
ments necessary to perform ET. Most importantly, the RF signal generator and the 
baseband AWG must be synchronized with minimal jitter. Furthermore, it must be 
possible to skew the delay of the baseband envelope relative to the RF waveform 
with subnanosecond precision. Because maximizing the PAE of the PA occurs when 
optimal supply voltages Vsm are applied, poor synchronization between instruments 
would result in Vsm values that are either too high or too low for given output 
power levels. It is meaningful to consider what would happen if the Vsm waveform 
lags the RF signal. The supply modulator will not be able to supply enough power 
to the PA when the waveform is at peak power. As a result, the RF output would 
clip several decibels below the desired output power. Furthermore, assume that Vsm 
leads the RF ahead, the supply modulator will be supplying much more power than 
the RF PA requires, hence reducing instantaneous efficiency. ET PAs typically have 
to operate with an RF signal generator and Vsm synchronization jitter typically less 
than 1 ns, which requires the test setup to be considerably stringent on the order of 
100 ps. Tight synchronization is a mechanism for aligning sample clocks and start-
ing triggers such that all devices begin generating concurrently. For example, the 
AWG and RF signal generator are benchmarked with maximum synchronization 
jitter less than 50 picoseconds, and therefore meet this requirement.
Synchronizing the signal generators alone is only half of the challenge. The 
modulated Vsm and RF waveforms go through different paths before reaching the 
RF PA and therefore experience different delays. Thus, it is also important to pro-
grammatically delay or advance the Vsm waveform relative to the RF signal in order 
for the modulated power supply and RF signal to be aligned with a subnanosecond 
skew at the RF PA. A simple way to delay the Vsm signal relative to the RF signal 

7.5  ET PA Measurements 
317
by an integer multiple of the AWG samples is to insert wait cycles in the beginning 
of the signal generation script. To get more precise delay, the RF waveform can be 
shifted in RF signal generator using a digital filter. 
The most direct method of verifying synchronization of the Vsm and RF signals 
is with a high-bandwidth digitizing oscilloscope. For example, an RF signal genera-
tor and AWG can be connected to two channels of an oscilloscope. The RF signal 
generator generated a 5-MHz LTE FDD uplink waveform at 900 MHz. On the ini-
tial run, the two waveforms are roughly timing misaligned out of synchronization 
with one another. By utilizing the delay compensation schemes, both waveforms 
can be aligned through a combination of wait samples and subsample delays as 
shown in Figure 7.22. It shows the results with the Vsm waveform scaled so that it 
has a magnitude comparable to the RF waveform. Although a high-speed oscillo-
scope is useful for visually inspecting the alignment of the two waveforms at the in-
put of the ET PA, it does not measure the performance of the ET PA. As we learned 
about the importance of synchronization, Vsm and RF misalignment severely affects 
the linearity of the ET PA. For this reason, it is also possible to use ACPR and EVM 
measurements to evaluate the optimal alignment of the Vsm and the RF waveform. 
The amount of ACPR degradation is specific device but a significant improvement 
in measurement using a spectrum analyzer can be expected when the synchroniza-
tion is optimally calibrated.
7.5.2  CW Versus Complex Stimulus Measurements
Digital modulation sampling systems started to appear in the 1990s [21] and have 
become the main method for distortion measurements [21–23]. The measurement 
with digital sampling closely resembles the DPD-based transmitters [24, 25]. It 
Figure 7.22  Illustration of PAE optimized Vsm tracking RF. Illustration of both envelope RMS DC bias 
and dynamic ET modulator supply.

318 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
enables the complex stimulus measurements for more comprehensive and precise 
understanding of RF PA than a continuous wave (CW) stimulus. ET is a mecha-
nism to get further improvements in PA performance and efficiency by matching 
the operating point of the transistors in the PA to the RF signal amplitude. It uses 
a control signal derived from the magnitude of the “live” signal required. Hence, 
a constant envelope CW signal may not help much. The CW signal is a simple and 
straightforward way to characterize a narrowband RF PA. However, it is not suf-
ficiently comprehensive for a wideband signal, especially for an ET PA evaluation. 
CW signals are insufficient for measuring PA distortion for several reasons.
First, the response of a nonlinear PA depends on the signal, which excites it in a 
generally nonlinear and a nonlocal manner. Nonlocal means the response depends 
not only on the instantaneous values of the signal at each time, but also on the 
waveform of the signal over time. Specifically, values of the excitation at previous 
instants, that is, the history of the excitation, can affect the nonlinear response as 
well. Hence, complex signals look very different in time from CW signals, result-
ing in different distortions [26]. For example, the AM-PM error measured with 
CW and multitone stimulus can be quite different on the same RF PA under test as 
exemplified in Figure 7.23.
In Figure 7.23, AM-PM distortion measurements have been taken using a CW 
and multitone signals, respectively. It is clear that the CW measurement is not 
valid for the actual stimulus with multitone signals. When subjected to a multitone 
signal, the RF PA will start to show distortion at significantly lower input power 
levels than what is indicated by the CW measurement. There are even significant 
differences between the responses of a nonlinear PA for various modulated signal 
as stimulus. Hence, the ACPR measurement results of the same RF PA can be di-
verse when different modulation formats are employed, revealing a consequence 
of the fact.
Figure 7.23  Comparison of AM-PM distortion curves of a typical RF PA derived using single-tone 
CW and multitone signal.

7.5  ET PA Measurements 
319
Second, the nonlinear response of the PA also depends on the termination im-
pedances at all harmonic and intermodulation frequencies. A complex excitation 
will generate a much broader spectrum of response, and therefore the effects of 
these impedance terminations can be very different from a simple CW tone. This 
is true even independent of true memory effects at the device level [27, 28, 32]. 
Memory effects can make the results even more different. The low-frequency beat 
of a two-tone excitation at sufficiently small tone spacing can effectively modulate 
the bias of the PA, which causes excess distortion. Because there is modulation near 
DC that modulates bias, this effect can be also present in complex signals. Modu-
lating the bias in response to a complex signal also modulates the temperature of 
the RF PA, which makes its own contribution to the overall distortion. A CW tone, 
by contrast, excites the device faster than the local temperature can be modulated, 
so there is no information in this response to predict the temperature contribution, 
which is present in a more complex signal practically. 
Third, the statistics of the complex signal determine the probability and size 
of the peaks in amplitude over time. They may be large but may occur with small 
probability. The peaks can create much distortion and raise the temperature of the 
device, which then relaxes slowly but influences the waveform for a period related 
to the thermal relaxation times. These times involve the time constants related to 
the power transistor, the package, and the thermal coupling to other heat sources 
and sinks. These time scales can exist over a very broad range, overlapping much 
of the spectrum of the complex signal. However, the CW high-frequency signal 
will generally be above all thermal time constants. Hence, it will not excite these 
degrees of freedom that will be excited by the actual modulated signal.
Finally, complex waveforms can also affect the way in which an RF PA breaks 
down, because breakdown is dependent on history and thermals. Breakdown or 
even soft breakdown can be an additional source of distortion. Moreover, charge-
trapping phenomena can significantly affect devices such as GaN HEMTs. A com-
plex signal will have slow components that modulate the trap states, causing excess 
distortion and long history-dependent currents from the power transistor. That 
is, complex excitations couple the slow trap dynamics to the fast intrinsic device 
dynamics. Under CW conditions, however, the traps are essentially de-coupled in 
time from the large RF CW signal. This leaves us with the only viable approach, 
that is, to use real modulated waveforms and vary the envelope shaping function 
so as to allow all combinations of input power and supply voltage to be measured. 
Although this requires a supply modulator, it is very fast, allows accurate phase 
information to be gathered, and can also be used to characterize memory effects.
7.5.3  Complex Measurements Setup
This section defines the complex stimulus measurement procedure of an ET PA 
as shown in Figure 7.24. RF devices are lined up by an instrumental preamplifier 
stage and a final RF PA stage. The preamplifier stage works in a highly linear mode 
with a fixed DC supply voltage. The RF PA is the device under test where the drain/
collector voltage is changing accordingly to the modulation supply from supply 
modulator. For this setup, there can be two modes of operation:

320 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Figure 7.24  Hardware connections for the ET PA test bed for complex measurements.

7.5  ET PA Measurements 
321
••
Static mode: The drain/collector of the RF PA can be biased with fixed DC 
voltage coming from a power supply.
••
Dynamic mode: The drain/collector of the device can be connected to a sup-
ply modulator, which modulates the supply voltage according to the enve-
lope of RF signal to be amplified.
Because the dynamic mode requires a supply modulator and appropriate signal 
processing schemes to ensure that the right signals are fed with the correct time re-
lationships, the measurements described are only static ones, leaving dynamic mea-
surements to be performed after integration as part of system verification. Anyway, 
some measurements can be performed with different values of DC drain/collector 
voltage to ensure a correct behavior in different operation conditions. Moreover, 
since the preamplifier driver part is an optional aid to line-up for the proper input 
power level requirement for the final device under test, the measurement can only 
concentrate on the ET PA performances alone.
The hardware connection (illustrated in Figure 7.24) for measuring the stimu-
lus and response with two vector signals captures hardware and instruments such 
as spectrum analyzer or digitizing oscilloscope. As exemplified in Figure 7.24, the 
test bed is mainly based on an RF signal generator, a spectrum signal analyzer, a 
high-speed digital sampling oscilloscope, a current probe, a highly linear preampli-
fier, a controllable power supply, and a PC as a host controller. A high bandwidth 
Hall-effect sensor current probe can be employed to accurately monitor the drain/
collector current and calculate accurate instantaneous efficiency. It enables to mea-
sure the envelope current through an oscilloscope up to typical 100 MHz or more. 
As shown in Figure 7.24 (in the gray parts), first connect the source RF signal gen-
erator output to the input of the preamplifier and the RF PA lineup chain. An exter-
nal input coupler can be inserted before the RF PA input port to couple the stimulus 
signal for input vector signal observation. Then connect the RF signal generator 
source trigger output to the trigger input of stimulus vector signal measurement 
hardware. It also needs to cascade the response vector capture hardware with the 
stimulus one. Therefore, the trigger output for the stimulus channel should be con-
nected to the trigger input for the response channel. Also, synchronization among 
instruments is important for complex measurements. Hence, the synchronization 
reference clock, typically 10 MHz from the stimulus channel, needs to connect 
to the reference input on the response channel. Finally, connect the stimulus and 
response capture hardware to the computer per the measurement cycle for vector 
signal data processing
The measurement procedure has two steps. First, for the stimulus measure-
ment, connect the measurement hardware input to the stimulus attenuator out-
put and then start stimulus data capture and analysis. Second, for the response 
measurement, connect the measurement hardware input to the response channel 
attenuator output. Then start response data capture and correlating with stimulus 
data to give the final analysis results. Overall, the stimulus and response power 
overloading should be prevented by setting proper input level with margin to toler-
ate peak power levels of modulated signals. For alignment to occur correctly, the 
stimulus and response signals must be sufficiently correlated within the alignment 

322 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
window. If pulsed signals are employed, use triggering to ensure that the power-off 
portion of the pulse does not occur within the analysis period.
7.5.4  Complex Characterization Techniques
Vector signal analysis can provide a measurement of the input-output waveform re-
lationship of an ET PA stimulated with complex signals. Output power levels used 
may be large enough to cause distortion or compression of the ET PA output stages, 
and the vector signal measurement and analysis can characterize this distortion or 
compression with AM-AM and AM-PM curves, net EVM, and signal statistics. 
Precisely aligned input and output waveforms also need to be provided for use in 
other algorithms such as envelope shaping function and predistortion.
First, AM-AM and AM-PM distortion measurement results can present with 
an ideal linear performance line and a curve fit to the results to obtain a high-order 
polynomial function to quantify and model the distortion behaviors. How far from 
ideal the RF PA behaves as it approaches saturation can be examined in this man-
ner. In another format, the gain compression can be obtained with the same data 
set captured, emphasizing variations in gain over operation bandwidth. 
Second, probability density functions (PDFs) of the instantaneous power of 
each stimulus and response waveform sample can be obtained to know the statisti-
cal characters for the ET design. Occurrence and power relative to average power 
information can be analyzed or the stimulus and response power can be combined 
together to observe the overlay and compression during the ET operation process. 
Typically, an ET PA showing compression in the response measurement will have a 
more rapid roll-off in the right side of the response PDF graph than for the stimu-
lus PDF distribution. Also, the complementary cumulative distribution function 
(CCDF) of the instantaneous power of each stimulus and response waveforms can 
be extracted from the post-data analysis on a PC host controller. The ET PA show-
ing compression in the response measurement will have a more rapid roll-off in 
the right side of the response CCDF graph than for the stimulus CCDF graph. The 
probability that a peak will exceed a given threshold is characterized by the CCDF. 
In practice, peaks occurring with a probability of less than 10−4 have a negligible 
impact on system performance. PDF and CCDF curves are two useful methods to 
monitor the statistical distribution of power in the complex signal measurements. 
For example, it is meaningful to examine the PDF to assure that the stimulus and 
response signals have the expected distribution around their means. The headroom 
available in the specific ET PA design can be revealed by CCDF analysis.
Finally, to verify ET PA, an EVM evaluation in function of the RF input power 
can be carried out. EVM can be calculated between the baseband signal transmit-
ted and the one received from the feedback path. An average EVM can indicate 
the performance of the in-band modulation quality. Net EVM of ET PA can be de-
fined as the RMS sum of the vector difference between each aligned sample of the 
stimulus and response waveforms. Nonlinear distortion mechanisms do more than 
degrading ACPR as out-of-band performance. They also degrade the modulation 
on the signal, that is, they increase the EVM of the signal. How much the ET PA 
will increase an EVM as it passes through can be estimated by this measurement. 

7.5  ET PA Measurements 
323
7.5.5  Power Measurements 
During instantaneous power measurement under ET, the measurement of the drain/
collector current is complicated by the dynamic supply of ET required for the stable 
operation of the RF PA. The drain/collector bias circuit for ET measurement is 
shown in Figure 7.25. Ism would ideally be measured directly using a digitizing 
oscilloscope, but the addition of a wideband current probe and its parasitic induc-
tance may impact RF performance. Therefore, the current measurement can be 
made immediately before the RF PA bias network. Note that the low-frequency 
bias network termination is vital for stable operation of the RF PA and can be 
implemented by the quarter-wave transmission line and resonance capacitor Cres. 
Figure 7.25  Illustration of drain/collector bias circuit schematic for an ET PA power measurement.

324 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
When the envelope modulation starts and current is drawn into the RF transistor, 
some current will initially come from the capacitance Cres; thus, the measured cur-
rent Imeas does not equal Ism. This error is transient and swiftly dissipates provided 
the capacitance Cres is sufficiently low. The portion of the envelope shape supply 
being measured should not begin until the error is small. A proper multipole header 
can be utilized to connect the modulator supply output to the RF PA supply bias to 
minimize parasitic reactance between the two parts.
As shown in Figure 7.25, on the DC supply side of the current measurement, 
the fixed DC supply and wire inductance respond very slowly to the fast envelope 
change in measured current Imeas. Therefore, to keep the measured voltage at PA 
drain from fluctuating, a large value of capacitance Cb is required at the DC sup-
ply of supply modulator, implemented as a bank of capacitors of varying size to 
provide very low impedance over a broad frequency range. The values and com-
ponents used to implement Cres and Cb depend on PA operation frequency band, 
stability requirements, and Ism values. With the measured Vsm and Ism values, the 
key results of supply modulator output power can be calculated. It is significant 
because it plays the role of a bridge to further deduce key efficiency results of ET 
PA system. For example, the supply modulator efficiency and RF PA instantaneous 
efficiency can be obtained accordingly to calculate the overall ET PA efficiency 
instantaneously o r time averaging. 
7.5.6  Efficiency Measurements
The ET PA efficiency is the ratio of all power consumed to the average output power 
delivered. Therefore, supply modulator efficiency must be high to minimize the 
impact on system efficiency. Because overcoming measurement limitations under 
dynamic supply modulation conditions raises several difficulties in efficiency tests, 
accurately measuring the efficiency of an ET PA under dynamic supply modulation 
is one of the most challenging tasks faced by developers of the RF PAs. It requires 
generation of precisely timing-aligned envelope and RF signals; a high-bandwidth, 
high-current, low-impedance power supply modulator; high bandwidth sensing of 
instantaneous current and voltage supplied to the PA; and measurement of the 
instantaneous RF power at input and output of the RF PA. All of the data must be 
captured at more than 100 million samples per second and then correlated to calcu-
late the instantaneous efficiency of the RF PA. The key issue is that by varying the 
PA supply voltage in synchronism with the envelope signal to improve efficiency the 
fundamental output characteristics of PA such as power, efficiency, gain, and phase 
now depends on two control inputs as the RF input power and supply voltage. The 
power supply bandwidth required is typically greater than three times that of the 
RF signal bandwidth (e.g., up to 60 MHz for a 20-MHz LTE-A RF signal). 
As shown in Figure 7.26, a practical measurement setup can emulate trans-
ceiver signals by generating synchronized RF and envelope waveforms. A supply 
modulator is used to supply the PA under test and as part of ET PA system, ac-
counting for overall efficiency performance. A wideband high-precision current 
probe is used to capture instantaneous voltage and current, while the PA supply 
voltage is being dynamically modulated using real ET waveforms [34]. Measuring 
the instantaneous current allows in-depth analysis of the ET PA operating point 
and PAE. A wideband current probing can be placed right at the ET supply side by 

7.5  ET PA Measurements 
325
using a current sensor. Line impedances in an active probe system often use high 
impedances to minimize the associated current drain. Active probes usually present 
the lowest capacitive loading when probing. For instance, they can operate with an 
input capacitance of 1 pF or less.
Although the instantaneous voltage and current at the output of the supply 
modulator can be probed via a high-speed oscilloscope, as shown in Figure 7.26, 
introduced parasitics of the measurement system may cause the overall drain/col-
lector efficiency to drop to certain degree. Timing delay differences between in-
stantaneous voltage and current waveforms can be calibrated to permit accurate 
calculation of RF PA characteristics. Typical ET bench measurements have inde-
pendent variables for the RF input power and dynamic supply voltage where the 
output power is the measured dependent variable. To calculate the instantaneous 
efficiency, the instantaneous current being supplied by the supply modulator is a 
must. Using the same RF PA with the ET configuration, a Hall-effect current probe 
is connected to the interconnecting ET supply line to acquire the instantaneous 
collector current. Measurement points can be taken by independently sweeping 
instantaneous drain/collector voltage and current versus RF input power in accord-
ing operation range respectively. 
Figure 7.27 shows that an exemplary driving point collector impedance from 
the supply modulator over the input power is generally in the range of 5 to 100W, 
with a large variation at low input power levels, which indicates impedance in-
creases at low operating voltages. Figure 7.28 shows the instantaneous collector ef-
ficiency and the envelope PDF histogram versus the RF output power. Note that the 
majority of sample points of the envelope fall within the 40% collector efficiency 
range. It can be found that the collector impedance of the RF power amplifier is 
around 5Ω in the high collector bias range.
To verify the performance of the RF PA itself in the ET PA systems, the instan-
taneous voltage and current at output of the supply modulator can be probed using 
a high-speed digitizing oscilloscope, as shown in Figure 7.24, under conditions 
roughly comparable to those used for best efficiency. Note that timing delay differ-
ences between instantaneous voltage and current waveforms must be calibrated to 
permit accurate calculation of RF PA characteristics.
Figure 7.26  Illustration of measurement of instantaneous efficiency performance of the ET PA 
with an exemplary 5-V GaAs HBT-based linear RF PA operating at 900 MHz used for measurement 
demonstrations.

326 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
Figure 7.29 presents the measured RF PA instantaneous collector efficiency 
versus dynamic collector voltage with 6.5-V peak envelope tracking amplifier by 
the setup in Figure 7.24. The efficiency presented in Figure 7.29 shows around 
40% above 3.5V to 5V. The RF PA performance can be improved with higher 
dynamic voltage swings for higher voltage power devices. The efficiency can be sig-
nificantly improved with a higher-voltage RF PA design. Also, an increase in power 
gain can also be obtained with higher operating voltage, along with similar linear-
ity performance. The efficiency improvement for different voltage supply dynamic 
Figure 7.27  Measured driving point collector impedance (Vsm/Ism) as load for supply modulator, 
looking into the collector bias feeding line towards the RF PA collector. 
Figure 7.28  Instantaneous power added efficiency as measured by digital sampling oscilloscope 
over the output power with LTE UL PDF for the magnitude of the output power.

7.5  ET PA Measurements 
327
ranges proves that the effect of adjustment of load impedance of the RF PA with 
a higher dynamic range power supply in ET can increase the overall performance.
It is not easy to do an exact comparison of the same RF PA operating with 
the ET system and with a constant collector supply voltage. First, the power sup-
ply voltage efficiency in the constant collector supply configuration is never taken 
into account, making comparisons unequal. Second, the power loading in the ET 
system is distributed over more components and a larger area, reducing the ther-
mal loading of the system. However, true transistor collector efficiency boosting 
without modulator efficiency is a metric to measure the improvement for ET PAs. 
The equivalent root mean squared (RMS) DC voltage bias of modulator output en-
velope voltage can be introduced as the collector biases compare the efficiency and 
linearity between a fixed DC supply and ET scenarios, as shown in Figure 7.22. 
The envelope RMS DC bias in this work was 4V as shown in Figure 7.22. Compar-
ing this RMS and ET supply cases can give more meaningful results of efficiency 
and linearity improvement than using their nominal fixed DC bias 5.5V.
References
[1]	
Larson, L., D. Kimball, and P. Asbeck, “Linearity and Efficiency Enhancement Strategies 
for 4G Wireless Power Amplifier Designs,” IEEE Custom Integrated Circuits Conference 
2008 (CICC 2008), 2008, pp. 741–748. 
[2]	
Pedro, J. C., and N. B. Carvalho, Intermodulation Distortion in Microwave and Wireless 
Circuits, Norwood, MA: Artech House, 2003.� 
[3]	
Keith, B. S., Production Testing of RF and System-on-a-Chip Devices for Wireless Com-
munications, Norwood MA: Artech House, 2004.
[4]	
Nemati, H., et al., “Characterization of Switched Mode LDMOS and GaN Power Ampli-
fiers for Optimal Use in Polar Transmitter Architectures,” 2008 IEEE MTT-s Dig., June 
2008, pp. 1505–1508.
Figure 7.29  Illustration of PAE performance versus collector supply voltage and its distribution in 
an exemplary ET PA.

328 
�����������������������������������������������������������������
Experimental Methodologies and Measurements for Envelope Tracking
[5]	
Hoversten, J., et al., “Optimal-PAE Polar Split for Efficient and Linear Drain Modulated 
Power Amplifiers,” IEEE Topical Symposium on Power Amplifiers, January 2009, pp. 1–2. 
[6]	
Vuolevi, J., and T. Rahkonen, Distortion in RF Power Amplifiers, Norwood, MA: Artech 
House, 2003.
[7]	
Broeck, T., and J. Verspecht, “Calibrated Vectorial Nonlinear-Network Analyzers,” IEEE 
MTT-S, 1994, pp. 1069–1072. 
[8]	
Verspecht, J., “Large-Signal Network Analysis,” IEEE Microwave Magazine, Vol. 6, 2005, 
pp. 82–92. 
[9]	
Moer, W. V., and Y. Rolain, “A Large-Signal Network Analyzer: Why Is It Needed?” IEEE 
Microwave Magazine, 2006, pp. 46–62.
[10]	
Betts, L., “Nonlinear Vector Network Analyzer Applications,” Microwave Journal, March 
2009, pp. 78–92.
[11]	
Agilent Technologies, “PNA/PNA-X Series Microwave Network Analyzers,” Agilent Tech-
nologies Configuration Guide 5988-7989EN, 2011.
[12]	
Horn, J., et al., “Measurement-Based Large-Signal Simulation of Active Components from 
Automated Nonlinear Vector Network Analyzer Data Via X-Parameters,” Microwaves, 
Communications, Antennas and Electronic Systems (COMCAS 2008), 2008, pp. 1–6.
[13]	
Root, D. E., et al., “Broad-Band Poly-Harmonic Distortion (PHD) Behavioral Models from 
Fast Automated Simulations and Large-Signal Vectorial Network Measurements,” IEEE 
Transactions on Microwave Theory and Techniques, Vol. 53, No. 11, November 2005, pp. 
3656–3664.
[14]	
Verspecht, J., et al., “Extension of X-Parameters to Include Long-Term Dynamic Mem-
ory Effects,” IEEE MTT-S International Microwave Symposium Digest, June 2009, pp. 
741–744.
[15]	
Verspecht, J., J. Horn, and D. E. Root, “A Simplified Extension of X-Parameters to De-
scribe Memory Effects for Wideband Modulated Signals,” IEEE ARFTG Conference Pro-
ceedings, May 2010, pp. 1–3.
[16]	
Cripps, S. C., RF Power Amplifiers for Wireless Communications, 2nd ed., Norwood, MA: 
Artech House, 2006.
[17]	
Cripps, S. C. Advanced Techniques in RF Power Amplifier Design, Norwood, MA: Artech 
House, 2002.
[18]	
Simpson, G., et al., “Load-Pull + NVNA = Enhanced X- Parameters for PA Designs with 
High Mismatch and Technology-Independent Large-Signal Device Models,” 72nd ARFTG 
Conference, December 9–12, 2008, pp. 1–3.
[19]	
Maas, S. A., Analysis of Nonlinear Microwave Circuits, Norwood, MA: Artech House, 
1988.
[20]	
Sevic, J. F., and M. B. Steer, “A Novel Envelope Termination Method for ACPR Optimiza-
tion of RF and Microwave Power Amplifiers,” IEEE Transactions on Microwave Theory 
and Techniques Symposium Digest, Vol. 2, 1998, pp. 723–726.
[21]	
Heutmaker, M. S., J. R. Welch, and E. Wu, “Using Digital Modulation to Measure and 
Model RF Amplifier Distortion,” Applied Microwave & Wireless, Vol. 9, 1997, pp. 34–39.
[22]	
Boumaiza, S., and F. M. Ghannouchi, “Realistic Power-Amplifier Characterization with 
Application to Baseband Digital Predistortion for 3G Base Stations,” IEEE Transactions 
on Microwave Theory and Techniques, Vol. 50, 2002, pp. 3016–3021.
[23]	
Moulthrop, A., et al., “Baseband Time-Domain Waveform Measurement Method,” U.S. 
Patent 6,211,663, 2001.
[24]	
Berglund, B., M. Englund, and J. Lundstedt, “Third Design Release of Ericsson’s WCDMA 
Macro Radio Base Stations,” Ericsson Review, 2005, pp. 70–81.
[25]	
Davis, R., and R. Boyd, “Adaptive Predistortion Technique for Linearizing a Power Ampli-
fier for Digital Data Systems,” U.S. Patent 4,291,277, 1981.
[26]	
Andersen, O., P. Malmlöf, and D. Wisell, “Nonlinear Characterization of Multiple Carrier 
Power Amplifiers,” ARFTG 56 2000, Boulder, CO, 2000, pp. 151–158.

7.5  ET PA Measurements 
329
[27]	
Rohde & Schwarz, “Generation of Multi Carrier CW Signals with SMU200A,” Applica-
tion Note, Stockholm, 2005.
[28]	
Agilent, “89604A Distortion Test Suite,” Application Note, 5988-7812EN, 2010.
[29]	
Betts, L., “Nonlinear Vector Network Analyzer Applications,” Microwave Journal, March 
2009, pp. 78–92.
[30]	
Verspecht, J., et al., “Extension of X-Parameters to Include Long-Term Dynamic Memory 
Effects,” IEEE MTT-S International Microwave Symposium Digest (MTT ’09), 2009, pp. 
741–744.
[31]	
Nemati, H., et al., “Characterization of Switched Mode LDMOS and GaN Power Ampli-
fiers for Optimal Use in Polar Transmitter Architectures.” Microwave Symposium Digest, 
2008 IEEE MTT-S International, June 2008, pp. 1505–1508.
[32]	
Hoversten, J., and Z. Popovic, “System Considerations for Efficient and Linear Supply 
Modulated RF Transmitters,” IEEE 12th Workshop on Control and Modeling for Power 
Electronics (COMPEL), 2010, pp. 1–8.
[33]	
Kimball, D., et al., “High-Efficiency Envelope-Tracking W-CDMA Base-Station Amplifier 
Using GaN HFETs,” IEEE Transactions on Microwave Theory and Techniques, Vol. 54, 
No. 11, November 2006, pp. 848–856.
[34]	
Draxler, P., et al., “High Efficiency Envelope Tracking LDMOS Power Amplifier for W-
CDMA,” IEEE MTT-S International Microwave Symposium Digest, 2006, pp. 1534–1537.


331
About the Author
Zhancang Wang received a master’s degree in electronic engineering degree from 
Beijing University of Technology, China. He obtained both rich academic and in-
dustrial experience in the field of RF by working at Beijing Embedded System Key 
Lab, RDA Microelectronics, Datang Mobile Inc., Nokia (in both the network and 
mobile departments), and Microsoft as an RFIC engineer, a senior RF researcher, 
a research project manager, and a consultant for third-party research collabora-
tors (e.g., universities, institutes, companies) and hardware and electromechanical 
project leaders, respectively. His research interests are in the areas of RF technology 
research and prototyping, including RF transceiver architecture, linearization tech-
nology, digital front end algorithm, and broadband high-efficiency PA technologies, 
especially on envelope tracking PA development. He has been a member of the 
IEEE, the MIPI Alliance, the OpenET Alliance, a committee member for several in-
ternational conferences, and a member of the editorial board of Microwave Journal 
China. He has been the owner of the Amplifier Frontier Research Group, driving 
open discussions of cutting-edge amplifier technologies. His research activities have 
led to 17 papers and 6 pending patents on advanced RF PA technology. 


333
Index
A
Adaptive adjustment, 114–15
Adaptive predistortion (PD) linearization 
method, 81
Adaptive QMC, 277–78
Adjacent channel power ratios (ACPR), 57, 76
	
benefits comparison, 79
	
defined, 77
	
illustrated, 77
	
measurement, 291
Advanced envelope shaping, 251–52
AM-AM distortion, 78, 80, 322
AM-PM distortion, 78, 80, 81, 318, 322
Analog alignment, 112–13
Analog envelope generation
	
advantages of, 93
	
defined, 92
	
envelope capture, 93
	
ET technique, 95
	
output illustration, 94
	
RF circuitry, 93
Analog front end (AFE), 229
Analog-to-digital converter (ADC), 151
Auxiliary envelope tracking (AET) hybrid
	
combiner, 170–71
	
defined, 169
	
design requirement and, 170
	
envelope signal, 169
	
illustrated, 171
	
system building blocks, 170
	
See also Hybrid supply modulators
B
Bandwidth
	
amplitude, in time and frequency, 102
	
envelope, 72–74
	
envelope detector, 101–3
	
of ET, 72–75
	
linear voltage regulator, 125
	
push-pull DAC, 175
	
supply modulator, 120
	
video, 74–75
Bandwidth reduction shaping
	
defined, 252
	
de-trough shaping versus, 252
	
effective bandwidth concept, 254
	
filtering, 253
	
iterative peak-tracking filtering, 253–54
	
slew rate reduction shaping versus, 254–55
Base transceiver station (BTS)
	
ET for, 82–83
	
MMMB, 83
	
RF PAs, 37
Bessel-Thompson response, 209
Bias network
	
classical, 207–9
	
design, 207–10
	
ET feeding line, 209–10
	
output, 208
	
parts of, 207
	
RF PA, 323
	
role, 207
	
topologies, 208
Bias tee, 209
Binomial multisection, 202
Bipolar junction transistor (BJT) devices, 71
Buck converter, 144–45
	
current-mode feedback control, 147
	
multiphase, 153–54
	
multiple input (MIBuck), 151–52
	
uses for, 148
Butterworth synthesis, 197, 199

334 
Index
C
Chebyshev multisection, 203
Class-AB/B linear supply modulators
	
overview of, 125–26
	
push-pull, 126–29
	
totem-pole, 129–30
	
See also Linear supply modulators; Supply 
modulators
Class-A PA, 9
Class-B PA, 9
	
circuitry under envelope tracking operation, 
58
	
conduction angle reduction in, 59
	
drain voltage and current waveforms, 60
	
efficiency degradation factor and, 64
	
global power conversion efficiency, 59
	
instantaneous efficiency and, 58–61
	
Q-point, 58
Class-C PA, 9
Class-D-1 PA
	
current mode block diagram, 13
	
defined, 12
	
transistors in, 14
	
voltage/current waveform and load lines, 14
Class-D PA
	
defined, 11
	
ideal waveforms of voltage/current and load 
lines, 13
	
topology, 11–12
	
transistors in, 14
	
voltage mode, 11–12
Class-E-1 PA
	
advantage of, 16
	
block diagram, 17
	
defined, 15–16
	
voltage current waveforms and load lines, 
18
Class-E PA
	
advantages of, 15
	
block diagram, 15
	
defined, 14–15
	
transient response, 15
	
voltage current waveforms and load lines, 
16
Class-F-1 PA
	
block diagram, 19
	
defined, 18–19
	
efficiency, 19–20
	
in terminating two harmonics, 21
	
voltage current waveforms and load lines, 
20
Class-F PA
	
block diagram, 18
	
defined, 16–17
	
load-matching network, 17
	
matching circuit, 17
	
voltage current waveforms and load lines, 
19
Class-G/H linear supply modulator
	
characteristics of, 130–31
	
continuous mode, 133
	
defined, 130
	
instantaneous output voltage and efficiency, 
133
	
linearity, 132
	
shunt, 135
	
supply rail voltages, 131
	
two-supply rail, 134
	
waveform characteristics, 131
Classical bias network, 209–10
Classical parallel hybrid, 163–64
Class-J PA
	
advantages of, 22–23
	
block diagram, 23
	
defined, 22
	
inductive load requirement, 22
	
instantaneous voltage/current waveforms 
and load lines, 24
Class-P PA
	
AM-AM and AM-PM response, 222
	
block diagram, 24
	
CW characteristics, 221
	
defined, 23
	
design for ET, 222–23
	
for ET, 214–23
	
gain-efficiency trajectory, 223
	
hybrid-parameter matching network, 
218–21
	
hybrid-parameter matching network 
implementation, 220
	
load and harmonic impedances, 217–18
	
load-line graph, 218, 219
	
load lines, 25

Index 
335
	
load-pull contours, 218
	
physical implementation, 217–22
	
power-added efficiency, 221
	
power gain, 221
	
quasi-rectangular/bifurcated current 
waveform, 25
	
waveform-engineered, 215–17
Class-S PA
	
block diagram, 21
	
defined, 21
	
as SDR solution, 22
CMOS PA
	
advantages of, 42
	
challenges, 41–42
	
PAE performance, 41
Combined DPD, 267
Combined hybrid supply modulator
	
characteristics of, 179
	
defined, 179
	
efficiency, 180
	
illustrated, 179
	
push-pull, 180–81
	
theoretical model, 180
	
See also Hybrid supply modulators
Complementary cumulative distribution 
function (CCDF), 4, 286, 322
Complementary metal oxide semiconductor 
(CMOS)
	
GaAs HBT and, 40
	
NMOS transistors, 40
	
PMOS transistors, 40
	
schematic structure of, 41
	
technology, 39
	
See also CMOS PA
Complex gain LUT DPD, 266–67
Complex LUT DPD, 264–67
Complex measurements
	
characterization techniques, 322
	
CW versus, 317–19
	
hardware connections for test bed, 320
	
procedure steps, 321–22
	
setup, 319–22
Complex stimulus measurements, 317–19
Constant current generator (CCG) hybrid
	
components of, 172
	
defined, 171–72
	
disadvantages of, 173
	
illustrated, 173
	
improvement, 172
	
power loss of sinking transistor, 173
	
recycling circuit, 172
	
See also Hybrid supply modulators
Constrained clipping CFR (CC-CFR)
	
block diagram, 242
	
defined, 240
	
distorted constellation symbols and, 242
	
simplified version, 242
	
See also Crest factor reduction (CFR)
Conversion gain, 105
Coordinate rotation digital computer 
(CORDIC)
	
algorithm, 97–98
	
defined, 97
	
operation results, 98
Crest factor, 4
Crest factor reduction (CFR)
	
algorithm, 231
	
constrained clipping (CC-CFR), 240–42
	
defined, 230–31
	
envelope calculation and, 97
	
metrics, 234–35
	
noise-shaping (NS-CFR), 237–39
	
peak cancellation (PC-CFR), 239–40
	
peak-windowing (PW-CFR), 235–36
	
techniques, 234
	
thresholds, 234–35
	
types of, 234
	
waveform clipping under, 232
	
See also Digital front end (DFE)
Cripps method, 193
D
De-trough shaping
	
to avoid gain collapse, 246
	
bandwidth reduction shaping versus, 252
	
for efficiency, 244–47
	
hard shaping process, 245–46
	
illustrated, 244
	
for linearity, 248–49
	
soft process, 246–47
	
trajectory, 247
Device under test (DUT), 192

336 
Index
Digital envelope generation
	
block diagram of ET transmitter, 95, 96
	
CORDIC, 97–98
	
defined, 95
Digital front end (DFE)
	
concept introduction, 229
	
crest reduction factor (CFR), 230–42
	
design, 229–78
	
design blocks, 231
	
digital predistortion (DPD), 261–73
	
envelope shaping factor, 243–57
	
image and carrier suppression, 273–78
	
timing alignment, 257–61
Digital predistortion (DPD), 84, 97, 221
	
adaptive, forward and feedback paths, 263
	
algorithm performance, 261
	
combined, 268–70
	
complex LUT, 264–67
	
contents categorization, 262
	
direct learning, 273
	
feedback path (FB), 270–71
	
forward path, 264
	
indirect learning, 271–72
	
introduction to, 262–63
	
memory polynomial, 267–68
	
nonlinear compensation, 261
	
Nyquist zones for feedback path, 271
	
phylogenetic tree of, 262
Digital signal processor, 151
Direct converter
	
block diagram, 144
	
buck, 144–45, 147–48, 151–52
	
defined, 143
	
instantaneous capacitor, 145–46
	
steady state output voltage ripple, 145
	
transient and steady state response, 144
	
voltage conversion ratios, 143
Direct learning DPD, 273
Discrete supply modulators
	
defined, 119
	
isolated SMPS, 141
	
multilevel, 149–53
	
multiphase, 153–56
	
nonisolated SMPS, 141–47
	
output filter for, 156–58
	
overview of, 140
	
SMPS summary, 147–49
	
See also Supply modulators
Distributed-parameter matching network 
design, 202
Doherty PA
	
defined, 26
	
even Doherty, 26–28
	
as high-efficiency architecture, 7
	
inverted Doherty, 29–30
	
multistage Doherty, 31–32
	
principle of, 26
	
uneven Doherty, 28–29
Driver design
	
lineup implementation, 225–26
	
overview of, 223–24
	
PAE lineup, 224–25
Driving point collector impedance, 326
Dynamic range, envelope detector, 101
E
Efficiency degradation factor, 63–65
Efficiency measurements
	
driving point collector impedance, 326
	
instantaneous collector efficiency, 326
	
instantaneous PAE, 326
	
instantaneous voltage and current, 325
	
practical setup, 324
Engineered waveforms, 211–12
Envelope detector
	
conversion gain, 105
	
dynamic range, 101
	
gain ripple, 106
	
modulation bandwidth, 101–3
	
response delay, 110–11
	
slew rate, 103–5
	
specifications, 100–111
	
temperature variance, 106–7
	
total harmonic distortion (THD), 109–10
	
transfer function, 107–9
Envelope elimination and restoration (EE&R), 
7
	
defined, 34
	
disadvantage, 35
	
supply modulators and, 119
	
transmitter block diagram, 34
	
transmitter linearity, 34–35
Envelope generation

Index 
337
	
analog, 92–95
	
defined, 92
	
digital, 95–98
	
MIPI eTrak interface, 98–100
Envelope measurements
	
multitone signal, 294–95
	
overview of, 292–93
	
sinusoidal signal, 293–94
	
stimulus, 293
	
true envelope, 295–97
Envelope shaping functions
	
advanced, 251–52
	
bandwidth reduction shaping, 252–54
	
definition of, 243
	
de-trough for efficiency, 244–47
	
de-trough for linearity, 248–49
	
introduction to, 243–44
	
linear amplification, 248
	
slew rate reduction shaping, 254–57
	
summary of, 257
	
sweet-spot tracking, 250–51
	
See also Digital front end (DFE)
Envelope signal decomposition, 292
Envelope tracking (ET), 7
	
advantages of, 35–36
	
defined, 35
	
digital front end design for, 229–78
	
disadvantages of, 36
	
efficiency, 56
	
efficiency trajectories, 233
	
experimental methodologies and 
measurements, 283–327
	
idea of, 35
	
motivation for, 51–52
	
principle of, 54–57
	
pyramid, 53–54
	
research, 81–82
	
RF PA compared to, 52
	
signal definition and, 55–56
	
supply modulator for, 117–85
	
See also Envelope tracking PAs
Envelope tracking PAs
	
AM-AM distortion, 78, 80
	
amplification, 36
	
AM-PM distortion, 78, 80, 81
	
application scenarios in wireless 
communication systems, 82
	
bandwidth of, 72–75
	
basics, 51–87
	
block diagram, 54
	
for BTS, 82–83
	
with class-B bias, 62
	
class-P, 214–23
	
design, 191
	
design considerations, 56–57
	
design flow illustration, 287
	
digital algorithms, 231
	
efficiency and gain trajectory for, 67–71
	
experimental setup for characterization, 288
	
fixed-supply, efficiency scattering plots, 71
	
frequency agility, 85–87
	
instantaneous drain efficiency, 61–62
	
instantaneous efficiency of, 57–65
	
integration, 87
	
introduction to, 51–54
	
linearity of, 75–81
	
lineup block diagram, 224
	
MMMB, 85–87
	
for mobile, 83–84
	
modulated signal linearity, 76–81
	
offset adjustment, 113–15
	
power capacity, 81–85
	
RF PA role in, 303
	
statistical average efficiency, 65–71
	
supply bias voltage and current waveform, 
72
	
test system block diagram, 288
	
time-averaging efficiency of, 68
	
timing alignment, 111–13
	
two-tone IMD, 76
	
voltage and current waveforms and load 
lines, 65
	
VSWR immunity in, 84–85
Error measurements, 300–302
Error vector magnitude (EVM), 57
	
benefits comparison, 79
	
defined, 76
	
illustrated, 77
	
RMS average of, 77
ET feeding line bias network, 209–10
ET PA measurements
	
complex characterization techniques, 322
	
complex measurements setup, 319–22

338 
Index
ET PA measurements (continued)
	
CW versus complex stimulus measurements, 
317–19
	
efficiency measurements, 324–27
	
overview of, 316
	
power measurements, 323–24
	
test bed synchronization, 316–17
eTrak
	
defined, 98
	
differential signaling, 99
	
envelope generator summary, 100
	
interface driver specification, 100
ET trajectory measurement
	
analysis, 310–11
	
data postprocessing, 313
	
for design target, 311
	
digital LUT and, 313
	
envelope shaping function based on, 312
	
exemplary, 314, 315
	
implementation, 311–12
	
test bed, 315
Even Doherty
	
defined, 26
	
efficiency, 27–28
	
efficiency curve comparison, 27
	
principle of, 27
	
schematic diagram, 27
	
See also Doherty PA
Experimental methodologies and measurements
	
envelope measurement, 292–97
	
envelope tracking, 283–327
	
ET PA measurements, 316–27
	
ET test considerations, 284
	
measurement process, 286–92
	
modulated signal measurement, 284–86
	
motivation and introduction, 283–92
	
RF PA measurements, 303–15
	
supply modulator measurements, 297–303
F
Feedback control, SMPS, 146–47
Field-effect transistor (FET)
	
DC operation, 58
	
IV-curves for, 59
	
PA, with class-B bias point, 59
Fourth generation signal (4G), 7
Frequency agility, 85–87
G
GaAs HBT, 38–39, 87
GaAs PAs, 84
Gain
	
class-P PA, 223
	
class-P RF PA, 221
	
conversion, 105
	
power drooping, 29
	
ripple, 106
	
trajectory, 67–71
GaN HEMT, 217
	
fabrication obstacle, 45–46
	
input and output impedances, 45
	
output power, 43
	
schematic structure of, 46
	
sheet charge density, 44
	
technologies, 38
Gaussian minimum shift keying (GMSK), 5–6, 
303
Global System for Mobile Communications 
(GSM), 5
Group delay, 111, 113
H
Hammerstein model, 267
Hard de-trough, 245–46
Harmonic load-pull
	
defined, 212
	
occurrence of, 213
	
for PAE, 213
	
use of, 212–13
Harmonic tuning methods, 212
Heterojunction bipolar transistor (HBT), GaAs, 
38–39, 40, 87
High-efficiency PA
	
architectures for, 7–36
	
device technologies, 37–46
	
Doherty, 7, 26–32
	
overview of, 7–9
	
switch-mode (SMPA), 7, 9–22
	
waveform-engineered, 22–26
High electron mobility transistors (HEMT)
	
concept, 46
	
GaN, 38, 43–46, 217

Index 
339
	
technology progression, 44–45
	
See also GaN HEMT
High speed packet access (HSPA), 3
Hybrid supply modulators
	
AET hybrid, 169–71
	
CCG hybrid, 171–73
	
combined hybrid, 179–81
	
defined, 119, 158
	
EE&R procedures and, 119
	
nested and multinested, 181–85
	
parallel hybrid, 161–69
	
parallel hybrid with multiswitcher, 175–78
	
power DAC hybrid, 174–75
	
serial hybrid, 158–61
	
See also Supply modulators
I
Image and carrier suppression
	
adaptive QMC, 277–78
	
overview of, 273–74
	
quadrature modulation correction (QMC), 
274–77
	
quadrature modulation errors (QME), 274, 
275, 276
Indirect converter, 141–43
Indirect learning DPD
	
block diagram, 272
	
defined, 271–72
	
linearizer initialization, 272
Instantaneous efficiency
	
class-B deduction, 58–61
	
class-G/H amplifier, 136
	
defined, 57
	
efficiency degradation factor, 63–65
	
ET deduction, 61–63
	
performance, 325
Instantaneous power added efficiency, 326
Intermodulation distortions (IMD)
	
spectral, 57
	
sweet-spot effect, 250
	
two-tone, 76
Inverted Doherty
	
advantage of, 29–30
	
defined, 29
	
efficiency curve comparison, 30
	
principle of, 30
	
schematic diagram, 30
	
See also Doherty PA
Isolated SMPS, 141
Iterative peak-tracking filtering, 253–54
L
Least mean squares (LMS), 270
Least square estimation (LSE), 270
Linear amplification using nonlinear 
components (LINC)
	
advantages of, 33
	
concept and signal composition, 33
	
defined, 32
	
transmitter block diagram, 33
Linear de-trough shaping, 248–49
Linear envelope detector
	
advantages of, 93
	
defined, 92
	
envelope capture, 93
	
ET technique, 95
	
output illustration, 94
	
RF circuitry, 93
Linearity, 76–81
	
de-trough for, 248–49
	
envelope tracking PAs, 75–81
	
factors, 79
Linear PAs, 8
Linear supply modulators
	
class-AB/B, 125–30
	
class-G/H, 130–36
	
defined, 119
	
linear voltage regulator and, 124–25
	
power DAC, 137–40
	
representation, 123
	
See also Supply modulators
Linear voltage regulator
	
bandwidth, 125
	
block diagram, 124
	
defined, 124
Lineup PAE, 224–25
Load-pull measurement and analysis, 304
Load-pull measurements, 306–9
Load-pull setup, 307
Load-pull X parameter measurement, 194–95

340 
Index
Long Term Evolution (LTE), 7
	
complex baseband and envelope signals, 74
	
envelope, 73
Long Term Evolution Advanced (LTE-A), 1, 3
	
operation on ultrabroad bandwidth, 7
	
PDF, 66
Look-up table (LUT) methods, 69, 263
Lowpass filters (LPFs), 140
Lumped-element matching network, 200
LUT DPD
	
complex, 264–67
	
complex gain, 266–67
	
mapping, 264
	
memory polynomial DPD comparison, 269
	
polar, 264–66
	
types of, 265
M
Mapping LUT DPD, 264
Matching network
	
function of, 195
	
hybrid implementation of, 201
	
illustrated, 196
	
lossless, 196
	
lumped-element, 200
	
multisection L-section, 198
	
N-section Butterworth synthesis, 199
	
one-to-one mapping, 200
	
source, topology, 198–99
	
synthesis, 196–97
Matching network design, 196–201
	
binomial multisection, 202
	
Chebyshev multisection, 203
	
distributed-parameter, 202
	
introduction to, 195–96
	
matching theory, 196–201
	
multisection and taper matching, 201–5
	
nonsynchronous family, 201
	
nonsynchronous impedance transformer, 
205–7
	
process, 197
	
synchronous family, 202
	
tapered-line matching, 203–5
	
termination impedance, 196
Matching theory, 196–201 
Measurements
	
efficiency, 324–27
	
envelope, 292–97
	
ET PA, 316–27
	
modulated signal, 284–92
	
multitone signal, 294–95
	
power, 323–24
	
RF PA, 303–15
	
sinusoidal signal, 293–94
	
supply modulator, 297–303
	
true envelope, 295–97
Memory effects
	
alternative testing, 310
	
measurement, 309, 311
Memory polynomial DPD, 267–68, 269
Metal oxide semiconductor field-effect  
transistor (MOSFET), 40–41
	
biasing, 128
	
n-channel (NMOS), 126
	
p-channel (PMOS), 127
	
power switches, 151, 153
	
signal output, 128
MIBuck, 151–52
Mobile, ET for, 83–84
Mobile Industry Processor Interface (MIPI) 
eTrak interface, 98–100
Modulated signal measurement
	
ACPR and wideband spurious signal, 291
	
block diagram, 285
	
complexity, 290
	
comprehensive, 291
	
ET PA design flow, 287
	
feedback observation path, 290
	
orthogonality and, 292
	
overview of, 284–86
	
process, 286–92
	
synchronous baseband and envelope, 291
	
test bed, 289
Modulated signals
	
characteristics of, 3–7
	
crest factor, 4
	
fourth generation signal (4G), 7
	
probability density function (PDF), 4–5
	
RF PA amplification of, 4
	
second generation signal (2G), 5–6
	
third generation signal (3G), 6

Index 
341
Modulation bandwidth, 101–3
Multilevel supply modulator
	
concept, 149–50
	
multiplexed independent voltage sources, 
150–53
	
voltage cells stacked in series, 153
	
voltage signal representation, 150
Multimode multiband (MMMB) PAs, 72, 74
	
BTS, 83
	
with ET, 85–87
Multinested supply modulators, 184–85
Multiphase supply modulator
	
advantages of, 154
	
defined, 153–54
	
high output power slew rates, 155–56
	
illustrated, 155
	
as N-bit power DAC, 154
	
phases, 154, 156
	
ramp rate and threshold, 156
	
total output ripple, 155
Multiplexed independent voltage sources, 
150–53
Multistage Doherty
	
combination networks, 31–32
	
defined, 31
	
principle of, 31
	
schematic diagram, 31
	
theoretical efficiency behavior, 32
	
See also Doherty PA
Multiswitcher parallel hybrid
	
buck switchers, 176
	
defined, 175–76
	
illustrated, 177
	
with MIBuck converter, 177–78
	
output filter, 178
	
output voltage, 176
	
See also Hybrid supply modulators
	
Multitone signal measurement, 294–95
N
Nested supply modulators
	
CESs, 182–83
	
defined, 181
	
efficiency, 182
	
efficiency improvement, 183, 184
	
illustrated, 181
	
output current, 182
	
switching, 182
Noise-shaping CFR (NS-CFR)
	
block diagram, 238
	
defined, 237
	
dependency, 238
	
PAPR reduction, 237
	
polar clipping output, 237
Nonisolated SMPS
	
canonical switching cell for, 142
	
direct converter, 143–46
	
feedback control, 146–47
	
indirect converter, 141–43
	
switching efficiency, 149
	
topologies, 141
Nonlinear behavior models, 194
Nonlinear compensation, 261
Nonlinear vector network analyzer (NVNA), 
193, 194, 305–6
Nonsynchronous impedance transformer
	
defined, 205
	
illustrated, 205
	
types of, 206
Normalized LMS (NLMS), 270
Normalized root mean square error (NRMSE), 
301
O
Offset adjustment
	
adaptive, 114–15
	
defined, 113
	
illustrated, 114
	
principle of operation, 113–14
Ohm’s law, 108
Operational amplifier (OPAMP), 126, 289
Operational expenditure (OPEX), 82
Outphasing, 32–34
P
Parallel hybrid supply modulator, 161–62
	
behaviors, 164–66
	
buck switcher, 165–66, 167
	
circuit illustration, 167
	
classical, 163–64
	
conversion delay, 169
	
current sense hysteresis control, 167

342 
Index
Parallel hybrid supply modulator (continued)
	
defined, 161–62
	
dynamic properties, 167–68
	
illustrated, 162
	
load dependency and nonlinearities, 168–69
	
with multiswitcher, 175–78
	
nonlinear responses, 169
	
power loss problem, 166
	
RF PA as varying load, 168
	
switching frequency control, 167
	
See also Hybrid supply modulators
Partial transmit sequence (PTS), 234
Peak cancellation CFR (PC-CFR)
	
block diagram, 240, 241
	
defined, 239
	
PAPR reduction, 239
	
peak signal detection methods, 239–40
Peak-to-average power ratio (PAPR), 3
	
envelope, 296
	
high, RF signals, 7
	
measure of, 4
Peak-windowing CFR (PW-CFR)
	
block diagram, 236
	
defined, 235
	
functioning of, 235
	
in PAPR reduction, 236
	
window function candidates, 236
	
See also Crest factor reduction (CFR)
Phase adjustment, 217
PMOS transistors, 40, 139–40
Polar LUT DPD, 264–66
Polyharmonic distortion (PHD) model, 193
Power added efficiency (PAE)
	
class-P RF PA, 221
	
defined, 2
	
instantaneous, 326
	
lineup, 224–25
	
performance versus collector supply  
efficiency, 327
	
theoretical, 3
	
in understanding overall efficiency, 2
Power amplifiers (PA)
	
for envelope tracking, 191–226
	
function of, 1
	
high-efficiency, 7–36
	
linear, 8
	
RF, 1–3
Power DAC hybrid, 174–75
Power digital-to-analog converter (DAC)
	
(M + N) control bit scheme, 138, 139
	
bias PMOS, 139
	
defined, 137
	
implementation illustration, 138
Power measurements, 323–24
Power spectral density (PSD)
	
of LTE signal, 296
	
in true envelope measurement, 295
Probability density function (PDF), 4–5
	
clipping ratio, 233
	
of envelope, 66
	
of instantaneous power, 322
	
LTE-A, 66
	
of modulated signals, 122, 123
Process, voltage, and temperature (PVT), 207
Pulse frequency modulation (PFM), 140
Pulse position modulation (PPM), 21
Pulse width modulation (PWM), 21, 140, 164
Push-pull class-AB/B
	
crossover distortion, 127
	
defined, 126
Push-pull class-AB/B supply modulator
	
linear modulator circuit, 128
	
schematic diagram, 127
	
tuning ratio, 129
Push-pull DAC
	
bandwidth performance, 175
	
defined, 174
	
fixed DC voltage conversion, 175
	
illustrated, 174
	
noise output, 175
	
output filter, 175
Q
QR decomposition based RLS (QRD-RLS), 270
Quadrature modulation correction (QMC)
	
adaptive, 277–78
	
compensator structure for, 275
	
defined, 274
	
imbalanced method for, 277
	
need for, 274
Quadrature modulation errors (QME)
	
defined, 274
	
illustrated, 275

Index 
343
	
illustration of schemes for, 276
	
sideband suppression sensitivity to, 274
Quarter-wave line
	
characteristic impedance, 202
	
parameters, 203
R
Recursive least squares (RLS), 270
Reduction shaping
	
bandwidth, 252–54
	
slew rate, 254–57
Response delay
	
defined, 110
	
envelope detector, 110–11
	
group delay, 111
RF PA measurements
	
for ET trajectory, 310–15
	
memory effects, 309–10
	
nonlinear VNA, 305–6
	
overview of, 303–4
	
swept load-pull, 306–9
RF PAs
	
analytical method, 193
	
bias network, 323
	
bias network design, 207–10
	
defined, 1
	
design methodology, 192–95
	
driver design, 223–26
	
EDA and modeling method, 193–95
	
efficiency definitions for, 2
	
with fixed DC supply voltage, 7
	
instantaneous drain efficiency, 60
	
instantaneous efficiency of, 57–65
	
knee voltage, 249
	
linear, 8–9
	
load-pull measurement and analysis, 304
	
matching network design, 195–207
	
measurement method, 192–93
	
in modulated signal amplification, 4
	
optimum operation of, 191
	
power added efficiency (PAE), 2–3
	
power consumption, 1
	
practical design, 304
	
supply modulator design, 304
	
technology development of, 5
	
transmission limits, 3
	
in UE and BTS for wireless  
communications, 37
	
waveform-engineered matching, 210–14
Rigid timing alignment, 91
Root mean square error (RMSE), 300–301
S
Schottky diode, 151
Second generation signal (2G), 5–6
Selective mapping (SLM), 234
Serial hybrid supply modulator
	
advantages of, 159
	
defined, 158
	
discrete stage efficiency, 160–61
	
efficiencies versus number of voltage levels, 
162
	
exemplary, 160
	
illustrated, 159, 160
	
linear stage efficiency, 161
	
optimization for number of levels, 161
	
See also Hybrid supply modulators
Shunt class-G/H amplifiers
	
illustrated, 135
	
instantaneous efficiency, 136
	
supply rail switches, 134
SiC MESFETs, 44
Sigma delta modulation (SDM), 21
Signal-to-noise ratio (SNR), 149
Si-LDMOS, 42–43
Sinusoidal signal measurement, 293–94
Slew rate
	
concept illustration, 104
	
defined, 103
	
envelope detector, 103–5
	
ideal and skewed waveforms due to, 104
	
linearity, 104–5
	
performance summary, 105
Slew rate reduction shaping
	
application of, 255
	
bandwidth reduction shaping versus, 254–55
	
defined, 254
	
envelope generation, 255
	
envelope illustration, 257
	
requirements for, 256
Soft de-trough, 246–47
Software-defined radio (SDR), 22

